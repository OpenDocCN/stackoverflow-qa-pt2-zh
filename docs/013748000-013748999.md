# StackOverflow 问答 13748000-13748999

# php - 在注册表单上生成一个顺序的 user_id 提交

> ID：13748002
> 
> 赞同：0
> 
> 时间：2012-12-06T16:25:13.063
> 
> 标签：php, mysql, registration

我有一个注册表格供用户注册我的网站。所有详细信息都转到 mysql 数据库，例如名称等。

当信息记录在数据库中时，我希望在提交表单时创建一个连续的 user_id 并将其与数据库中的名称和年龄等其他详细信息一起存储。

我需要什么代码？抱歉，我是 php 新手。

我曾尝试使用这样的 cookie 脚本，但它不会创建 user_id。相反，数据库中的所有用户的 user_id 都为 0。

```
<?php
    $user_id_set = get_user_id();
    while ($user_id = mysql_fetch_array($user_id_set)) {
        $cookie1 = "{$user_id["id"]}";
        setcookie("ptb_registrations", $cookie1, time()+3600);  /* expire in 1 hour */

    }
    ?> 
```

这是我的完整代码：

```
<? ob_start(); ?>
<?php

// GET ACCOUNT INFORMATION FROM FORM AND ASSIGN VARIABLES

$first_name = $_POST['first_name'];
$last_name = $_POST['last_name'];
$email = $_POST['email'];
$display_name = $_POST['display_name'];
$date_of_birth = $_POST['date_of_birth'];
$contact_number = $_POST['contact_number'];
$station = $_POST['station'];
$hobbies = $_POST['hobbies'];
$age = $_POST['age'];
$password = $_POST['password'];
?>
<?php
/*
// ECHO ACCOUNT INFORMATION
echo "<strong> Account Information: </strong>";
echo "<br />";
echo First Name: ";
echo "<br />";
echo $first_name;
echo "<br />";
echo "<br />";
echo "Last Name: ";
echo "<br />";
echo $last_name;
echo "<br />";
echo "<br />";
echo "Email: ";
echo "<br />";
echo $email;
echo "<br />";
echo "<br />";
echo "Password: ";
echo "<br />";
echo $password;
echo "<br />";
echo "<br />";
echo "date_of_birth: ";
echo "<br />";
echo $date_of_birth;
echo "<br />";
echo "<br />";
echo "Contact_number: ";
echo "<br />";
echo $contact_number;
echo "<br />";
echo "<br />";
echo "display_name: ";
echo "<br />";
echo $display_name;
echo "<br />";
echo "<br />";
echo "station: ";
echo "<br />";
echo $station;
echo "<br />";
echo "<br />";
echo "hobbies: ";
echo "<br />";
echo $hobbies;
echo "<br />";
echo "<br />";
echo "age: ";
echo "<br />";
echo $age;
echo "<br />";
echo "<br />";
*/
?>

<?php
////// SEND TO DATABASE

/////////////////////////////////////////////////////////

// Database Constants
define("DB_SERVER", "");
define("DB_USER", "");
define("DB_PASS", "");
define("DB_NAME", "");

// 1\. Create a database connection
$connection = mysql_connect(DB_SERVER,DB_USER,DB_PASS);
if (!$connection) {
    die("Database connection failed: " . mysql_error());
}

// 2\. Select a database to use
$db_select = mysql_select_db(DB_NAME,$connection);
if (!$db_select) {
    die("Database selection failed: " . mysql_error());
}
//////////////////////////////////////////////////////////////
$query="INSERT INTO ptb_registrations (ID,
first_name,
last_name,
email,
display_name,
date_of_birth,
contact_number,
station,
hobbies,
age,
password

 )
VALUES('NULL',
'".$first_name."',
'".$last_name."',
'".$email."',
'".$display_name."',
'".$date_of_birth."',
'".$contact_number."',
'".$station."',
'".$hobbies."',
'".$age."',
'".$password."'
)";
mysql_query($query) or die ('Error updating database');
?>
<?php
function confirm_query($result_set) {
                if (!$result_set) {
                    die("Database query failed: " . mysql_error());
                }
        }
function get_user_id() {
    global $connection;
    global $email;
    $query = "SELECT *
                FROM ptb_registrations
                WHERE email = \"$email\"
                ";
        $user_id_set = mysql_query($query, $connection);
        confirm_query($user_id_set);
        return $user_id_set;
        }
?>
<?php
$user_id_set = get_user_id();
while ($user_id = mysql_fetch_array($user_id_set)) {
    $cookie1 = "{$user_id["id"]}";
    setcookie("ptb_registrations", $cookie1, time()+3600);  /* expire in 1 hour */

}
?>

<?php include ('send_email/reg_email.php'); ?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>PlaytimeBoys Registration</title>

    <link href="css/style.css" rel="stylesheet" type="text/css" />
    </head>
    <body>
    <div class="container">
      <h1>Thanks for Registering!</h1>
      <h2>Please check your email to confirm your account has been set-up.</h2>
      <p>&nbsp; </p>
      <p>&nbsp;</p>
      <p>&nbsp;</p>
</div>
</body>
</html>
<? ob_flush(); ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T16:47:03.847

您只需要更新您的数据库即可。您可以通过运行此查询将 user_id 修改为自动递增

```
ALTER TABLE `tablename` MODIFY `user_id` INT( 10 ) NOT NULL AUTO_INCREMENT 
```

并且当您将条目插入数据库时​​，然后将 user_id 指定为 null ，例如

```
INSERT INTO 'tablename' (user_id, name, address) VALUES (null, name_value, address_value) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T16:45:20.010

你不需要在 PHP 上处理这个。

最好在 MySQL 端进行。

因此，在您的用户表上，字段 user_id 必须使用属性 AUTO_INCREMENT 定义。

这样，插入此表时无需指定 user_id 参数。相反，user_id 将由数据库生成，作为整数，每次增加 1。

尝试这个：

```
CREATE TABLE Users (
    user_id int(11) NOT NULL auto_increment,
     first_name varchar(50),
     last_name varchar(50)
    PRIMARY KEY  (user_id)
) ENGINE=InnoDB 
```

# parsing - 解析数学表达式，这个方法的分类是什么？

> ID：13748005
> 
> 赞同：1
> 
> 时间：2012-12-06T16:25:21.620
> 
> 标签：parsing, math, expression

我已经为像这样的表达式编写了一个词法分析器和解析器`3-5*6*8`，它被编译为以下标记：

*   编号(3)
*   操作员（-）
*   数量(5)
*   操作员（*）
*   数量(6)
*   操作员（*）
*   号码(8)

然后解析器采用一种我认为是递归下降和反向优先攀登的组合的方法。它的工作原理大致如下：

```
parse(3-5*6*8)
add(parse(3), -parse(5*6*8))
add(3, -product(parse(5), parse(6), parse(8))
add(3, -product(5, 6, 8)) 
```

像这样，一个令牌序列被从最低优先级递归地解析到最高优先级。它还通过括号处理系统处理函数，但这超出了这个问题的范围。

**这种方法可以归类为任何已知的运算符优先级解析器方法还是这种新的*（奇怪的）*东西？**

我能想象的阻止我的方法被轻易分类的一件事是用于运算符的多操作数系统`sum`和`product`，但这是我的特定应用程序需要的，以简化实现。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T16:37:24.833

这听起来有点像[这里的 Dijkstra 的分流算法](http://en.wikipedia.org/wiki/Shunting-yard_algorithm)

# php - substr 不适用于 $item->getTitle

> ID：13748006
> 
> 赞同：0
> 
> 时间：2012-12-06T16:25:24.643
> 
> 标签：php, joomla, substr

我正在用 Joomla 建立一个网站，并正在使用 RokSprocket 来显示一些新闻。现在，有些标题太长了，所以我想在某个字符数后缩短它，但它不起作用。我是一个完全的 php 菜鸟，我很抱歉。

这是整个代码：

```
<li data-lists-item>
    <h4 class="sprocket-lists-title ">
        <?php if ($item->custom_can_have_link): ?><a href="<?php echo $item->getPrimaryLink()->getUrl(); ?>"><?php endif; ?>
            <?php  if(strlen($item->getTitle)>10)
       echo substr($item->getTitle,0,10) . ' ...';
    else
    echo $item->getTitle();?></a>
            <div class="date"><?php echo date('d.M. Y', strtotime($item->getDate()));?></div>
    </h4>

    <span class="sprocket-lists-item" data-lists-content>
        <span class="sprocket-padding">
            <?php if ($item->getPrimaryImage()) :?>
            <img src="<?php echo $item->getPrimaryImage()->getSource(); ?>" class="sprocket-lists-image" />
            <?php endif; ?>
            <?php echo $item->getText(); ?>
            <?php if ($item->getPrimaryLink()) : ?>
            <a href="<?php echo $item->getPrimaryLink()->getUrl(); ?>" class="readon"><span><?php rc_e('READ_MORE'); ?></span></a>
            <?php endif; ?>
        </span>
    </span>
</li> 
```

我希望这是非常明显的事情，我只是愚蠢。已经非常感谢了！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T16:27:35.967

`$item->getTitle`可能是一种方法而不是一种属性，所以试试：

```
$item->getTitle(); // <-- parenthesis 
```

改成：

```
 <?php  if(strlen($item->getTitle())>10)
   echo substr($item->getTitle(),0,10) . ' ...'; 
```

# objective-c - NSString 到 TimeInterval

> ID：13748007
> 
> 赞同：8
> 
> 时间：2012-12-06T16:25:30.573
> 
> 标签：objective-c, ios

我有一个 NSString，其格式`00:00:00.00`最初来自`[dateFormatter setDateFormat:@"HH:mm:ss.SS"];`

如何获取该字符串并将其转换为 TimeInterval？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-06T16:43:08.273

如果你 100% 绝对肯定这种格式永远不会改变，那么这里有一个使用Cocoa[中最有用的类之一的](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSScanner_Class/Reference/Reference.html)快速'n'dirty 解决方案：

```
- (NSTimeInterval)timeFromString:(NSString *)str
{
    NSScanner *scn = [NSScanner scannerWithString:str];

    int h, m, s, c;
    [scn scanInt:&h];
    [scn scanString:@":" intoString:NULL];
    [scn scanInt:&m];
    [scn scanString:@":" intoString:NULL];
    [scn scanInt:&s];
    [scn scanString:@"." intoString:NULL];
    [scn scanInt:&c];

    return h * 3600 + m * 60 + s + c / 100.0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T16:45:42.890

我想到了。比我想象的要简单得多：

```
 NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
    [dateFormatter setDateFormat:@"HH:mm:ss.SS"];
    [dateFormatter setTimeZone:[NSTimeZone timeZoneForSecondsFromGMT:0.0]];
    NSDate *currentDate = [dateFormatter dateFromString:finishTimeString];
    NSTimeInterval interval = [currentDate timeIntervalSince1970]; 
```

# python - PyQt：QDateComboBox setDate 使用字符串？

> ID：13748009
> 
> 赞同：1
> 
> 时间：2012-12-06T16:25:33.347
> 
> 标签：python, string, combobox, pyqt, date-formatting

如何使用有时也可以为空的字符串设置 QDateComboBox 的日期？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T19:04:42.230

假设您正在谈论[QDateEdit](https://qt-project.org/doc/qt-4.8/qdateedit.html)，您将需要从字符串创建一个[QDate](https://qt-project.org/doc/qt-4.8/qdate.html)对象，以便可以将其传递给[setDate](https://qt-project.org/doc/qt-4.8/qdatetimeedit.html#date-prop)函数。

QDate 类有一个静态[fromString](https://qt-project.org/doc/qt-4.8/qdate.html#fromString)函数，可以从字符串创建 QDate，但您必须知道字符串中日期的*格式*才能正常工作。

默认情况下，`QDate.fromString`假定日期将采用以下格式：

```
ddd MMM d yyyy (ShortDayName ShortMonthName ShortDayNumber LongYearNumber)
e.g. Thu Dec 6 2012 
```

但是，您可以`fromString`通过传递标准[DateFormat](https://qt-project.org/doc/qt-4.8/qt.html#DateFormat-enum)或自定义[格式字符串](https://qt-project.org/doc/qt-4.8/qdate.html#fromString-2)来指定格式作为第二个参数。

如果 QDate 无法解析日期字符串，则会返回无效的 QDate 对象（您可以使用 进行检查`date.isValid()`）。

一个空字符串将产生一个无效的日期对象，但如果你将一个传递给`QDateEdit.setDate`，它将被忽略（即日期不会改变）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T18:28:02.460

我想你说的是`QDateEdit`可以使用`setDate(QDate)`. `QDate`要从字符串创建 a ，请使用`QDate.fromString`. 请参阅[QT 3 QDateTime API](http://doc.qt.digia.com/3.3/qdatetime.html)或[QT 4 QDateTime API](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&ved=0CDEQFjAA&url=http://doc.qt.digia.com/qt/qdatetime.html&ei=p-LAUOPwDsSLiALLoYCYAw&usg=AFQjCNG26vUJEW7thHkO_5bMk7XtTIfDww)

# iphone - 我的 Objective C 代码中只需要一个版本吗？

> ID：13748011
> 
> 赞同：1
> 
> 时间：2012-12-06T16:25:43.207
> 
> 标签：iphone, objective-c, ios, cocoa, memory-management

由于某种原因我不能使用`arc`，所以在我下面的代码中..

**Foo.h**

```
@interface Foo : NSObject

@property (nonatomic, copy) NSString * string;

@end 
```

**Foo.m**

```
@implementation Foo

@synthesize string=_string;

- (void) bar {
    self.string = [NSString stringWithFormat:@"test1"];
    self.string = [NSString stringWithFormat:@"test2"];
}

-(void) dealloc
{
    [_string release];

    [super dealloc];
}
@end 
```

该`bar`方法可能并不总是被调用，或者它们可以被多次调用。

只需要一个`release`吗`dealloc`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T16:29:29.110

> 是否只需要 dealloc 中的一个版本？

是的。

说明：setter 方法释放分配给属性的旧对象并保留新对象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-06T16:31:48.103

是的，因为您使用的是属性，所以 setter 方法将负责释放内存分配。它将按如下方式分配内存：

```
-(void)setValue:(NSString *)strValue
{
   if(string)
   {
     [string release];
     string = nil;
   }
   string = [strValue copy];
} 
```

# jquery - jQuery 花式框

> ID：13748013
> 
> 赞同：0
> 
> 时间：2012-12-06T16:25:50.870
> 
> 标签：jquery, fancybox

我是在韩国学习网页设计的学生。
我有个问题。我在我的个人项目中使用了 fancybox。
这很棒！！但是，我有一个问题..

主页就是这样简单构建的

目录
Fancybox 图像 slide1
目录
Fancybox 图像 silde2

重要的是 slide1 和 slide2 不相关。
但是，当我单击 slide1 的小图像时，fancybox 会显示所有图像，包括 slide1 和 slide2 图像。
我只想在“Fancybox image slide1”中显示 slide1 图像。

请帮我！！我附上了简短的 HTML 源代码。谢谢！

```
<script>
$(document).ready(function() {
       $('.fancybox').fancybox();
});
</script>

<body>
   contents<br>
   <div class="fancybox_image_slide1">
   <a class="fancybox" rel="group" href="1_b.jpg"><img src="1_s.jpg"/></a>
   <a class="fancybox" rel="group" href="2_b.jpg" ><img src="2_s.jpg"/></a>
</div>
contents<br>   
<div class="fancybox_image_slide2" >
   <a class="fancybox" rel="group" href="3_b.jpg"><img src="3_s.jpg" /></a>
   <a class="fancybox" rel="group" href="4_b.jpg" ><img src="4_s.jpg"/></a>
</div>
</body> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T16:31:42.797

花式盒子使用 rel 属性来处理分组。确保每个组的 rel 属性都有匹配的值。

```
<script>
$(document).ready(function() {
    $('.fancybox').fancybox();
});
</script>

<body>
contents<br>
<div class="fancybox_image_slide1">
   <a class="fancybox" rel="slide1" href="1_b.jpg"><img src="1_s.jpg"/></a>
   <a class="fancybox" rel="slide1" href="2_b.jpg" ><img src="2_s.jpg"/></a>
</div>
contents<br>   
<div class="fancybox_image_slide2" >
   <a class="fancybox" rel="slide2" href="3_b.jpg"><img src="3_s.jpg" /></a>
   <a class="fancybox" rel="slide2" href="4_b.jpg" ><img src="4_s.jpg"/></a>
</div>
</body> 
```

# jsf-2 - jsf2 mojarra中的复合组件按钮操作问题

> ID：13748019
> 
> 赞同：0
> 
> 时间：2012-12-06T16:26:01.883
> 
> 标签：jsf-2, action, el, composite-component

尝试使用 jsf2.0 (Mojarra) 开发复合组件，该组件应根据 bean 的列表动态呈现命令按钮。我能够渲染按钮，但没有触发操作。有人可以帮我解决这个问题吗？

下面是代码

```
<composite:interface>
<composite:attribute name="buttonList" required="true"
type="java.util.List" />
<composite:attribute name="beanName" required="true"
    type="java.lang.Object" />
</composite:interface>
<composite:implementation>

<ui:repeat var="listItem" value="#{cc.attrs.buttonList}">
<h:commandButton value="#{listItem.buttonName}"
action="#{cc.attrs.beanName.listItem.buttonAction}">
</h:commandButton>
</ui:repeat>
</composite:implementation> 
```

这用作

```
<utils:buttonGroup buttonList="#{testButtonBean.buttonList}"
beanName="#{testButtonBean}" /> 
```

豆子看起来像

```
public class TestButtonBean {

public List<ButtonPOJO> buttonList = new ArrayList<ButtonPOJO>();
public List<ButtonPOJO> getButtonList() {
  return buttonList;
}   

public void setButtonList(List<ButtonPOJO> buttonList) {
this.buttonList = buttonList;
}

public void preProcess() {
if (null != buttonList && buttonList.size() == 0) {
ButtonPOJO ob1 = new ButtonPOJO("Continue", "next");
ButtonPOJO ob2 = new ButtonPOJO("Back", "prev");
buttonList.add(ob1);
buttonList.add(ob2);
}

}

public String next() {
return "page1";
}

public String prev() {
return "page2";
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T16:31:57.697

```
action="#{cc.attrs.beanName.listItem.buttonAction}" 
```

这个不对。这种语法基本上是在寻找一个属性`listItem`，`beanName`然后尝试对其调用文字操作`buttonAction()`。

`action="#{bean[methodName]}"`如果要将操作方法​​名称指定为来自另一个 bean 属性的字符串，则需要大括号表示法。

```
action="#{cc.attrs.beanName[listItem.buttonAction]}" 
```

* * *

**与具体问题无关**，如果上述解决方案仍然失败，则只能表示`value="#{cc.attrs.buttonList}"`在表单提交请求期间发生了不兼容的更改。您需要确保在回发期间准备的列表与在初始请求期间准备的列表完全相同。另请参阅[commandButton/commandLink/ajax action/listener method not invoked 或 input value not updated](https://stackoverflow.com/questions/2118656/hcommandlink-hcommandbutton-is-not-being-invoked/2120183#2120183)的第 4 点。

# python - 如何减少 python 程序的 CPU 和内存使用量？

> ID：13748022
> 
> 赞同：1
> 
> 时间：2012-12-06T16:26:13.393
> 
> 标签：python, performance, cpu-usage, raspberry-pi, cpu-speed

我有一个使用大量 CPU 资源的 python 程序。虽然它在我的普通 PC 上很好，但恐怕我的 Raspberry Pi 处理起来可能太多了。速度不是问题。我不在乎我的代码是否执行缓慢，因为我正在实现一个每隔几个小时才执行一次代码的实时系统，但是我的 CPU 需要释放，因为我还要同时运行其他进程。无论如何，我可以以执行速度为代价减少从 CPU 占用的资源吗？任何帮助将不胜感激，谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-06T16:43:09.867

虽然您确实可以修改您的程序并使其更加优化，但事实是所有程序通常都设计为尽可能多地占用 CPU，以便在尽可能短的时间内完成。

我看到了两种实现目标的方法：

1.  树莓派是 Linux 对吧？因此，只需降低运行脚本的 python 解释器的进程优先级。这将确保其他程序在需要时可以拥有 CPU

2.  在你的脚本中，每隔几毫秒就睡几毫秒......丑陋，但可以做到这一点

但选项一可能是要走的路。

# wpf - 如何使 DataGridTemplateColumn.HeaderTemplate 居中

> ID：13748024
> 
> 赞同：8
> 
> 时间：2012-12-06T16:26:14.193
> 
> 标签：wpf, xaml, datagrid

有什么线索吗？下面的代码不能正常工作...

谢谢！

```
 <DataGrid AutoGenerateColumns="False"  VerticalAlignment="Stretch" HorizontalAlignment="Stretch"  Name="dg1"   Grid.Row="0" >
     <DataGridTemplateColumn  Width="SizeToCells" IsReadOnly="True">
         <DataGridTemplateColumn.HeaderTemplate>
             <DataTemplate>
                 <Label HorizontalAlignment="Center" Content="First Name"></Label>
             </DataTemplate>
          </DataGridTemplateColumn.HeaderTemplate>
          <DataGridTemplateColumn.CellTemplate>
              <DataTemplate>
                 <Label Content="{Binding FirstName}" />
              </DataTemplate>
          </DataGridTemplateColumn.CellTemplate>
     </DataGridTemplateColumn> 
```

更新：

@ArsenMkrt 的解决方案很棒，但我面临一些奇怪的垂直线......

![在此处输入图像描述](../Images/95ee100e95a2377bfa2742e7d4bfd74f.png)

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-06T16:28:49.397

使用`HeaderStyle`代替`HeaderTemplate`

```
 <DataGridTemplateColumn.HeaderStyle>
        <Style TargetType="{x:Type DataGridColumnHeader}">
            <Setter Property="HorizontalAlignment" Value="Center"/>
        </Style>
    </DataGridTemplateColumn.HeaderStyle> 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-09-02T05:20:41.600

试试这个它适用于我将标题居中而没有任何问题。

```
<DataGridTemplateColumn.HeaderStyle>
    <Style TargetType="DataGridColumnHeader">
        <Setter Property="HorizontalContentAlignment" Value="Center"/>
    </Style>
</DataGridTemplateColumn.HeaderStyle> 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-02-05T22:19:53.473

不知道是否仍然有帮助，但这样做：

```
<DataGridTemplateColumn.HeaderStyle>
    <Style TargetType="{x:Type DataGridColumnHeader}">
        <Setter Property="HorizontalAlignment" Value="Stretch"/>
        <Setter Property="HorizontalContentAlignment" Value="Center"/>                            
    </Style>
</DataGridTemplateColumn.HeaderStyle> 
```

将标题居中而没有竖线问题

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-10-03T11:38:15.073

这里的所有答案都解决了问题，但主题与其他列标题不同。所以一点点改变对我来说就是诀窍。如果有人还在寻找它，那就是这里。

```
<DataGridTemplateColumn.HeaderStyle>
    <Style TargetType="DataGridColumnHeader">
        <Setter Property="HorizontalAlignment" Value="Stretch"/>
        <Setter Property="HorizontalContentAlignment" Value="Center"/>
        <Setter Property="Background" Value="Transparent"/>
    </Style>
</DataGridTemplateColumn.HeaderStyle> 
```

# shell - 将输出写入文件，并在 ksh 脚本中添加选项卡/文本

> ID：13748025
> 
> 赞同：0
> 
> 时间：2012-12-06T16:26:17.950
> 
> 标签：shell, unix, logging, scripting, ksh

我正在编写一个记录到文件的 KornShell (ksh) 脚本。我正在将我的一个命令 (scp) 的输出重定向到同一个文件，但如果可能的话，我想在日志文件中这些行的开头添加一个选项卡。

这可能吗？

编辑：另外我应该提到我重定向的文本来自stderr。我的线路目前看起来像这样：

```
scp -q ${wks}:${file_location} ${save_directory} >> ${script_log} 2>&1 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T17:07:50.227

注意：以下不适用于`ksh`（有关可能的解决方案，请参阅[此问题](https://unix.stackexchange.com/q/26566/16669)）。

* * *

你可能可以做类似的事情

```
my_command | sed 's/^/\t/' >> my.log 
```

这个想法是使用流编辑器`sed`以某种方式处理命令的输出。在这种情况下，将在每行的开头添加一个制表符。考虑：

```
$ echo -e 'Test\nfoobar' | sed 's/^/\t/'
    Test
    foobar 
```

我没有在 中对此进行过测试`ksh`，但快速的网络搜索表明它应该可以工作。

另请注意，某些命令可以同时写入`stdout`和`stderr`，不要忘记处理它。

**编辑：**针对问题中的评论和编辑，调整后的命令看起来像

```
scp -q ${wks}:${file_location} ${save_directory} 2>&1 | \
    sed 's/^/\t/' >> ${script_log} 
```

`stdout`或者，如果你想彻底摆脱，

```
scp -q ${wks}:${file_location} ${save_directory} 2>&1 >/dev/null | \
    sed 's/^/\t/' >> ${script_log} 
```

[此答案](https://stackoverflow.com/a/2342841/1258041)中描述了该技术。

# visual-studio-lightswitch - 来源：LightSwitch 添加查询中的下拉菜单为空

> ID：13748031
> 
> 赞同：1
> 
> 时间：2012-12-06T16:26:37.620
> 
> 标签：visual-studio-lightswitch

在解决方案资源管理器中，当我
1\. 右键单击​​特定数据源并单击添加查询或
2\. 右键单击​​并直接基于数据源打开查询

设计器屏幕正常显示，但右上角的 Source: 下拉菜单不仅是空的，而且除了标签“Source:”之外它是不可见的

（注意：如果我右键单击并打开基于派生查询的查询，则下拉菜单很好。）

但是，我发现如果我单击 Source: 右侧的正确位置（并且变化很大），下拉列表应该是：
1\. 行出现在设计器表面正下方的窗口中。
2 如果我选择派生查询，则下拉菜单恢复正常，表和任何派生查询都按应有的方式显示。
3\. 如果我选择表格本身，下拉菜单仍然不可见。

常见的症状似乎是，如果下拉菜单应该显示表格，它是不可见的。如果它应该显示派生查询，那很好。

这仅发生在 ApplicationData 中的某些表中。我知道问题并不总是存在，因为我之前已将派生查询添加到这些表中的至少一个。

WCF RIA 服务中的任何表都没有这个问题，这可能是也可能不是线索。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T02:14:57.013

我确实发现了问题：

我检查了所有表格的问题，只有两个，“工作”和“地段”。名字长度是个问题。

1.  我添加了一个名为 Dogs 的表，当我尝试向 Dogs 添加查询时，Source: 下拉列表不可见。
2.  我将名称更改为 MyDogs，一切正常。
3.  我在一个新创建的 LightSwitch 应用程序中复制了这种行为。
4.  我在两台单独的计算机上安装了 VS / LightSwitch 时复制了这种行为。
5.  这个 bug 肯定是从 VS 2012 版本开始引入的，因为我之前在 Jobs 中添加了查询。

# ruby-on-rails - 在正则表达式搜索中捕获两个子字符串？

> ID：13748033
> 
> 赞同：-1
> 
> 时间：2012-12-06T16:26:43.210
> 
> 标签：ruby-on-rails, ruby, regex

```
string  = "First Name: John Last Name: Doe"
string2 = "First Name: John Last Name: Doe de Sour"
regex   = (First Name|Last Name): ([A-Za-z]+) 
```

如何修改我的正则表达式以包含“de Sour”？如果我像这样添加一个空格：

```
regex   = (First Name|Last Name): ([A-Za-z ]+) 
```

然后它也会捕获“姓氏”。该字符串源自电子邮件的正文内容，因此我明确搜索名字和姓氏以获取“：”之后的内容非常重要。

预期收益：`["First Name", "John"], ["Last Name", "De Sour"]`

很重要，因为我将把它变成 Ruby 中的哈希。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-06T16:29:24.243

我建议将其转换为同时捕获名字和姓氏的单个正则表达式（在不同的捕获组中）。

```
regex = First Name: ([A-Za-z ]+) Last Name: ([A-Za-z ]+) 
```

您将在捕获组 1 中拥有名字，在捕获组 2 中拥有姓氏。由于已明确指出它们，因此不会与“名字”或“姓氏”混淆。

在行动中看到它：[http ://rubular.com/r/qfA68b8PO5](http://rubular.com/r/qfA68b8PO5)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T17:22:23.313

这会从示例字符串返回一个哈希：

```
string  = "First Name: John Last Name: Doe"
string2 = "First Name: John Last Name: Doe de Sour"

Hash[*string.scan(/(First) Name: (.+) (Last) Name: (.+)/).flatten]

=> { "First" => "John", "Last" => "Doe" }

Hash[*string2.scan(/(First) Name: (.+) (Last) Name: (.+)/).flatten]
=> {
    "First" => "John",
     "Last" => "Doe de Sour"
} 
```

这会从多个字符串返回一个哈希数组：

```
[string, string2].map{ |s| Hash[*s.scan(/(First) Name: (.+) (Last) Name: (.+)/).flatten] }
=> [
    [0] {
        "First" => "John",
         "Last" => "Doe"
    },
    [1] {
        "First" => "John",
         "Last" => "Doe de Sour"
    }
] 
```

# c# - 将十六进制字符串转换为颜色

> ID：13748038
> 
> 赞同：3
> 
> 时间：2012-12-06T16:26:50.157
> 
> 标签：c#, colors, hex

我在我的 QueryString 中传递了一个十六进制值。我想将其转换为一种颜色，以便在网格视图的单元格中使用 ForeColor。都试过了`System.Drawing.ColorTranslator.FromHtml()`，`System.Drawing.Color.FromArgb()`没有运气。

我的 QueryString 是 urlencoded 所以重要的部分看起来像：

```
QueryString...&color=%23AA4643 
```

以下是我尝试过的.FromArg：

```
string sColor = Request.QueryString["color"]; // sColor is now #AA4643
Int32 iColorInt = Convert.ToInt32(sColor,16); //Get error message - Could not find any recognizable digits
Color curveColor = System.Drawing.Color.FromArgb(iColorInt); //Never makes it here 
```

这是我尝试过的.FromHtml：

```
string sColor = Request.QueryString["color"]; 
System.Drawing.Color myColor = new System.Drawing.Color();
myColor = System.Drawing.ColorTranslator.FromHtml(sColor); 
```

在这种情况下，myColor 设置为 - myColor = "{Name=ffaa4643, ARGB=(255, 170, 70, 67)}"

但是当我去使用它时，我得到一个错误：

> 指数超出范围。必须是非负数且小于集合的大小。参数名称：索引

非常感谢任何和所有帮助

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-06T16:31:04.263

尝试这个：

```
string sColor = Request.QueryString["color"]; // sColor is now #AA4643
Int32 iColorInt = Convert.ToInt32(sColor.Substring(1),16); 
Color curveColor = System.Drawing.Color.FromArgb(iColorInt); 
```

# android - Android：获取共享偏好会使应用程序崩溃

> ID：13748040
> 
> 赞同：0
> 
> 时间：2012-12-06T16:27:03.957
> 
> 标签：android, android-emulator, sharedpreferences

我有以下扩展 ListActivity 的活动：

```
public class TweetActivity extends ListActivity {

    SharedPreferences settings = this.getSharedPreferences("NewsTweetSettings", 0);

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    ....
  }
} 
```

我设置 sharePreferences 的行总是导致应用程序在模拟器中崩溃，我找不到原因。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-06T16:40:28.640

在调用 onCreate() 超类实现之后使用 oncreate() 中的行。它可以帮助你

```
public class TweetActivity extends ListActivity {

    SharedPreferences settings;

    @Override
    public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    settings=this.getSharedPreferences("NewsTweetSettings", 0); 
    ....
  }
} 
```

原因是我们在行前没有任何价值'this'`super.onCreate(savedInstanceState);`

快乐编码

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-06T16:30:02.890

`this.getSharedPreferences("NewsTweetSettings", 0);`在你的`OnCreate`..like中调用这个方法

```
public class TweetActivity extends ListActivity {

    SharedPreferences settings;

    @Override
    public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    settings=this.getSharedPreferences("NewsTweetSettings", 0); 
    ....
  }
} 
```

# sql - PLS-00103 Oracle 存储过程错误

> ID：13748041
> 
> 赞同：1
> 
> 时间：2012-12-06T16:27:11.473
> 
> 标签：sql, oracle, stored-procedures, plsql

我是存储过程的新手。我正在尝试运行存储过程并收到这些错误：我收到 PLS-00103：在预期以下情况之一时遇到符号“SELECT”：开始函数杂注过程... PLS-00103：遇到符号“RETURN”时期待以下之一： * & = - + < / > at is mod remaining not rem then... 我尝试搜索导致这些错误的原因以及与此类似的示例，但结果还不够。关于为什么会发生这些错误的任何线索？这是代码：

```
CREATE OR REPLACE PROCEDURE LIST_ACTIONS_CHECK_ADD 
(
  LISTNAME IN VARCHAR2  
) AS 
BEGIN
 DECLARE CNT NUMBER;
 SELECT COUNT(LIST_NAME) INTO CNT FROM LISTS_MASTER WHERE LIST_NAME = LISTNAME;
IF (CNT > 0)
 RETURN 1
ELSE
 RETURN 0
END IF;
END LIST_ACTIONS_CHECK_ADD; 
```

新代码：

```
CREATE OR REPLACE PROCEDURE LIST_ACTIONS_CHECK_ADD 
(
  P_LISTNAME IN VARCHAR2  
) 
AS 
 L_CNT NUMBER;
BEGIN
 SELECT COUNT(LIST_NAME) 
   INTO L_CNT 
   FROM LISTS_MASTER 
  WHERE LIST_NAME = P_LISTNAME;
 IF (L_CNT > 0)
   RETURN 1;
 ELSE
   RETURN 0;
  END IF;
END LIST_ACTIONS_CHECK_ADD; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T16:34:39.607

存储过程声明的框架是

```
CREATE OR REPLACE PROCEDURE procedure_name( <<parameters>> ) 
AS
  <<variable declarations>>
BEGIN
  <<code>>
END procedure_name; 
```

在您发布的代码中，

1.  你把`BEGIN`变量声明之前
2.  你有一个无关紧要的`DECLARE`东西——只有在声明一个不涉及`CREATE`.
3.  您的`RETURN`陈述后缺少分号。
4.  过程不能返回值。如果你想返回 1 或 0，你可能需要一个函数，而不是一个过程。如果你需要一个过程，你可以声明一个`OUT`参数。
5.  你错过了`THEN`之后`IF`

听起来你想要类似的东西

```
CREATE OR REPLACE FUNCTION LIST_ACTIONS_CHECK_ADD 
(
  LISTNAME IN VARCHAR2  
) 
  RETURN NUMBER
AS 
 CNT NUMBER;
BEGIN
 SELECT COUNT(LIST_NAME) 
   INTO CNT 
   FROM LISTS_MASTER 
  WHERE LIST_NAME = LISTNAME;
 IF (CNT > 0)
 THEN
   RETURN 1;
 ELSE
   RETURN 0;
  END IF;
END LIST_ACTIONS_CHECK_ADD; 
```

请注意，作为一般事项，您通常最好使用某种命名约定来确保参数和局部变量不共享列的名称。试图弄清楚`LISTNAME`是参数还是列名以及两者之间的区别`LIST_NAME`通常`LISTNAME`会使未来的程序员感到困惑。就个人而言，我`p_`对参数使用`l_`前缀，对局部变量使用前缀。我还建议使用锚定类型——`lists_master.list_name%type`如果这是传入的内容

```
CREATE OR REPLACE FUNCTION LIST_ACTIONS_CHECK_ADD 
(
  P_LIST_NAME IN lists_master.list_name%type
) 
  RETURN NUMBER
AS 
 L_CNT NUMBER;
BEGIN
 SELECT COUNT(LIST_NAME) 
   INTO L_CNT 
   FROM LISTS_MASTER 
  WHERE LIST_NAME = P_LIST_NAME;
 IF (L_CNT > 0)
 THEN
   RETURN 1;
 ELSE
   RETURN 0;
  END IF;
END LIST_ACTIONS_CHECK_ADD; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-06T16:39:41.950

*   （更正＃1）您不能在过程中返回值；应删除 LIST_ACTIONS_CHECK_ADD 并将其声明为函数以返回 NUMBER
*   （更正＃2）您需要按如下方式移动CNT的声明（见下文）
*   （更正 #3）您需要在 return 语句中使用分号：
*   （更正 #4）在 IF (CNT > 0) 之后需要一个 THEN（见下文）：

```
DROP PROCEDURE LIST_ACTIONS_CHECK_ADD;
CREATE OR REPLACE FUNCTION LIST_ACTIONS_CHECK_ADD
(
   LISTNAME IN VARCHAR2  
) 

RETURN NUMBER AS 

  CNT NUMBER;
BEGIN
    SELECT COUNT(LIST_NAME) INTO CNT FROM LISTS_MASTER WHERE LIST_NAME = LISTNAME;
    IF (CNT > 0) THEN
       RETURN 1;
    ELSE
       RETURN 0;
    END IF;
END LIST_ACTIONS_CHECK_ADD; 
```

* * *

这可以从 SQLPLUS 执行为：

```
SET SERVEROUTPUT ON SIZE 100000;
DECLARE
    V_RESULT NUMBER;
BEGIN

    V_RESULT := LIST_ACTIONS_CHECK_ADD('X');
    DBMS_OUTPUT.PUT_LINE('RESULT: ' || V_RESULT);

END; 
```

# extjs - Adobe CQ5.5 如何创建多个CustomMultiField 以在单个组件中使用

> ID：13748042
> 
> 赞同：0
> 
> 时间：2012-12-06T16:27:13.027
> 
> 标签：extjs, aem

我有一个要求，要求我使用带有两个选项卡的单个对话框。每个选项卡都应该有一个 CustomMultiField（多组四个字段）。我对 EXT JS 一无所知。有人可以指出我正确的方向，在那里我可以找到有关上述要求的信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T14:41:27.520

我在没有明确理解 Ext JS 的情况下构建了自定义组件。要了解如何设置带有选项卡的对话框，请查看`page`. `/libs/foundation/component/page`您可以使用的所有 xytpes 的目录，例如 MultiField，都[在这里](http://dev.day.com/docs/en/cq/current/developing/widgets/xtypes.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T20:05:38.830

如果您需要一些行为类似的东西，但不一定是巨大的特定 ExtJS 组件或自定义 xtype，并且您不想挖掘数百个 Adob​​e“支持”页面，试图找到一些有用的文档。

您可以简单地使用`multifield`xtype 并编写 4 个纯 JS 侦听器，这可以满足您的需要。

# c# - 将项目添加和排序到单链表中

> ID：13748044
> 
> 赞同：0
> 
> 时间：2012-12-06T16:27:22.287
> 
> 标签：c#, class

我正在学习如何使用课程。我做了两节课，一节课是汽车清单。但是，我需要修改 add 函数，以便添加按价格排序的汽车。我遇到的问题是它会将最便宜的汽车送到开头，但会杀死列表的其余部分。这是我的添加代码...

```
public void add_car(the_cars new_car)
        {// Method to add cars to list
            if (count == 0)
            {// If this is the first car 
                first = new_car;
                last = new_car;
                count = 1;
            }
            else
            {// If it is not the first car
                if (new_car.getPrice() < first.getPrice())
                {// If price of new car is lower than first car
                    last = first;
                    first = new_car; // new car becomes first car
                }
                else
                {
                    while (new_car.getPrice() > last.getPrice() || last.next != null)
                    {
                        last.next = new_car; // Null value now equal to car
                        last = new_car;
                    }
                }

                count++; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T16:36:44.570

要将项目插入单链表，您需要：

1.  更改以前的节点`next`（或者`first`如果它是第一项）以指向新节点。
2.  `next`将新项目的更改为新项目`next`之前的项目。（你没有在你的代码中这样做。）

如果你有一个双向链表（看起来你没有），你还需要：

1.  将当前节点更改`previous`为指向您之前的节点。
2.  将下一个节点更改`previous`为指向您。

请注意，这些操作可能需要按照我在此处指定的顺序以外的顺序完成。

由于您还有一个`last`指针，因此您需要检查是否需要更新并更新它。

您遇到的另一个问题是您`last`用于在第一项之后添加任何内容。你……不想那样做。您需要遍历列表，这意味着创建一个新的局部变量来跟踪当前位置。实际上，您的代码基本上是在清除`last`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T16:50:03.847

您已正确识别案例：

1.  列表还是空的吗？
2.  是否应该在开头添加项目？
3.  如果不是：我们需要在哪个项目之后插入？

你实施了第一个案例好吧。

第二种情况是错误的：在开头插入意味着将第一个元素更改为`new_car`，但`new_car.Next`需要指向之前的第一个元素，否则会丢失链接。

第三种情况也是错误的：您需要走到列表的末尾，直到到达最后一个元素（然后是您需要插入的那个），或者直到找到一个其后继元素更大的元素价格并在那之后插入。

我可以这样设置条件的原因`while`是，如果`current != last`我可以确定存在 a `current.Next`，否则它就是`last`定义。我需要一个临时迭代元素的原因是，如果我修改`first`我会丢失列表的入口点。

如果没有测试过下面的代码，但它应该给你一个线索，如果它不起作用，单步调试会帮助你。

```
public void add_car(the_cars new_car)
{// Method to add cars to list
    if (count == 0)
    {// If this is the first car 
        first = new_car;
        last = new_car;
        count = 1;
    }
    else
    {// If it is not the first car
        if (new_car.getPrice() < first.getPrice())
        {// If price of new car is lower than first car
            new_car.Next = first; // Insert the first car as the first element
            first = new_car;
        }
        else
        {
            // Create temporary iteration element
            the_cars current = first;

            // Find the car
            while (current != last && new_car.getPrice() >= current.Next.getPrice())
                current = current.Next;

            // Insert after the given element
            new_car.Next = current.Next;
            current.Next = new_car;

            // Also you may need to update last to match the new end
            if (current == last)
                last = new_car;
        }

        count++;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-06T16:52:34.450

如果您想使用[LinkedList 类](http://msdn.microsoft.com/en-us/library/he2s3bh7.aspx)，这里有一个基于您的场景的示例实现：

```
class CarList : LinkedList<Car>
{
    public void AddCar(Car newCar)
    {
        if (this.Count == 0)
        {
            AddFirst(newCar);
        }
        else
        {
            var referenceCar = Find(this.OrderByDescending(i => i.Price).Where(i => newCar.Price > i.Price).FirstOrDefault());
            if (referenceCar == null)
            {
                AddBefore(First, newCar);

            }
            else
            {
                this.AddAfter(referenceCar, newCar);
            }
        }
    }
}

class Car
{
    public int Price { get; set; }
    public Car(int price)
    {
        Price = price;
    }
}

static void Main(string[] args)
{
    var list = new CarList();
    list.AddCar(new Car(20000));
    list.AddCar(new Car(10000));
    list.AddCar(new Car(15000));

    foreach (var item in list)
    {
        Console.WriteLine("Price {0}", item.Price);
    }
} 
```

# php - 测试页面未显示在 wordpress 安装中

> ID：13748050
> 
> 赞同：-2
> 
> 时间：2012-12-06T16:27:39.510
> 
> 标签：php, wordpress, .htaccess

我试图`localhost/wordpress/test.html`在我的 wordpress 安装中显示一个测试页面。

然而，即使页面存在于这个位置，wordpress 也只是显示`File Not Found Page`.

我该如何解决这个问题并让我`localhost/wordpress/test.html`出现？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T23:43:46.220

解决它。

这是 .htaccess 文件中的一个 wordpress 主题重定向

# xpath - xpath - 如何根据前面的文本选择复选框

> ID：13748051
> 
> 赞同：1
> 
> 时间：2012-12-06T16:27:43.887
> 
> 标签：xpath

我有文字说“角色”。之后有两个复选框。
我可以进入“角色”。
我怎样才能到达并单击检查复选框？

我正在尝试使用：

```
xpath=(//label[contains(text(),'Roles')]/div/span/input) 
```

但找不到。

我的 HTML 是：

```
<div class="control-group string required">
  <label class="string required control-label" for="survey_name">
  <abbr title="required">*</abbr> Name</label>
  <div class="controls">
    <input class="string required" id="survey_name" name="survey[name]" size="50" type="text" /></div>
  </div>
  <div class="control-group check_boxes required">
    <label class="check_boxes required control-label">
      <abbr title="required">*</abbr> Roles
    </label>
    <div class="controls">
      <span class="checkbox">
        <input class="check_boxes required" id="survey_role_ids_121" name="survey[role_ids][]" type="checkbox" value="121" />
      </span>
    </div>
  </div>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T16:42:42.117

is 不是标签的`div`子标签，is 是`following-sibling`. 因此，您需要的 XPath 表达式是

```
//label[contains(., "Roles")]/following-sibling::div/span/input 
```

# .net - 无法从程序集“mscorlib”加载类型“System.Runtime.CompilerServices.ExtensionAttribute”

> ID：13748055
> 
> 赞同：149
> 
> 时间：2012-12-06T16:27:59.717
> 
> 标签：.net

第一次启动我的网站时，我收到了这个错误

`Could not load type 'System.Runtime.CompilerServices.ExtensionAttribute' from assembly 'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'`

我究竟做错了什么？

我正在使用 .NET 4 并从 Visual Studio 启动该站点。

我最近唯一更改的是将 Simple Injector（通过 Nuget）添加到我的项目中。

这是堆栈跟踪

```
[TypeLoadException: Could not load type 'System.Runtime.CompilerServices.ExtensionAttribute' from assembly 'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.]
   System.ModuleHandle.ResolveType(RuntimeModule module, Int32 typeToken, IntPtr* typeInstArgs, Int32 typeInstCount, IntPtr* methodInstArgs, Int32 methodInstCount, ObjectHandleOnStack type) +0
   System.ModuleHandle.ResolveTypeHandleInternal(RuntimeModule module, Int32 typeToken, RuntimeTypeHandle[] typeInstantiationContext, RuntimeTypeHandle[] methodInstantiationContext) +180
   System.Reflection.RuntimeModule.ResolveType(Int32 metadataToken, Type[] genericTypeArguments, Type[] genericMethodArguments) +192
   System.Reflection.CustomAttribute.FilterCustomAttributeRecord(CustomAttributeRecord caRecord, MetadataImport scope, Assembly& lastAptcaOkAssembly, RuntimeModule decoratedModule, MetadataToken decoratedToken, RuntimeType attributeFilterType, Boolean mustBeInheritable, Object[] attributes, IList derivedAttributes, RuntimeType& attributeType, IRuntimeMethodInfo& ctor, Boolean& ctorHasParameters, Boolean& isVarArg) +115
   System.Reflection.CustomAttribute.GetCustomAttributes(RuntimeModule decoratedModule, Int32 decoratedMetadataToken, Int32 pcaCount, RuntimeType attributeFilterType, Boolean mustBeInheritable, IList derivedAttributes, Boolean isDecoratedTargetSecurityTransparent) +426
   System.Reflection.CustomAttribute.GetCustomAttributes(RuntimeAssembly assembly, RuntimeType caType) +103
   System.Reflection.RuntimeAssembly.GetCustomAttributes(Type attributeType, Boolean inherit) +64
   WebActivator.AssemblyExtensions.GetActivationAttributes(Assembly assembly) +132
   WebActivator.ActivationManager.RunActivationMethods() +216
   WebActivator.ActivationManager.RunPreStartMethods() +43
   WebActivator.ActivationManager.Run() +69

[InvalidOperationException: The pre-application start initialization method Run on type WebActivator.ActivationManager threw an exception with the following error message: Could not load type 'System.Runtime.CompilerServices.ExtensionAttribute' from assembly 'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'..]
   System.Web.Compilation.BuildManager.InvokePreStartInitMethods(ICollection`1 methods) +423
   System.Web.Compilation.BuildManager.CallPreStartInitMethods() +306
   System.Web.Hosting.HostingEnvironment.Initialize(ApplicationManager appManager, IApplicationHost appHost, IConfigMapPathFactory configMapPathFactory, HostingEnvironmentParameters hostingParameters, PolicyLevel policyLevel, Exception appDomainCreationException) +677

[HttpException (0x80004005): The pre-application start initialization method Run on type WebActivator.ActivationManager threw an exception with the following error message: Could not load type 'System.Runtime.CompilerServices.ExtensionAttribute' from assembly 'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'..]
   System.Web.HttpRuntime.FirstRequestInit(HttpContext context) +9090876
   System.Web.HttpRuntime.EnsureFirstRequestInit(HttpContext context) +97
   System.Web.HttpRuntime.ProcessRequestInternal(HttpWorkerRequest wr) +258 
```

所有视图的第一行都会突出显示，当您将鼠标悬停在它们上时，您会收到此错误

```
The pre-application start initialisation method Run on type WebActivator.ActivationManager threw an exception with the following error message Could not load type 'System.Runtime.CompilerServices.ExtensionAttribute' from assembly 'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'. 
```

* * *

## 回答 #1

> 赞同：265
> 
> 时间：2012-12-06T18:29:04.687

> 无法从程序集 mscorlib 加载类型“System.Runtime.CompilerServices.ExtensionAttribute”

是的，当您在 .NET 4.0 而不是 .NET 4.5 上执行代码时，这在技术上可能会出错。在 .NET 4.5 中，该属性已从 System.Core.dll 移至 mscorlib.dll。虽然这听起来像是一个应该 100% 兼容的框架版本中的一个相当讨厌的破坏性更改，但 [TypeForwardedTo] 属性应该使这种差异无法观察到。

正如墨菲所说，每一个像这样善意的改变都至少有一种没有人想到的失败模式。当使用 ILMerge 将多个程序集合并为一个并且该工具使用不正确时，这似乎出错了。描述这种破损[的一篇很好的反馈文章在这里](https://connect.microsoft.com/VisualStudio/feedback/details/726702/moving-system-runtime-compilerservices-extensionattribute-to-mscorlib-breaks-structuremap-scans-of-namespaces-containing-extensionmethods-and-possibly-other-ioc-scenarios)。它链接到描述错误的[博客文章。](http://www.mattwrock.com/post/2012/02/29/What-you-should-know-about-running-ILMerge-on-Net-45-Beta-assemblies-targeting-Net-40.aspx)这是一篇相当长的文章，但如果我正确解释它，那么错误的 ILMerge 命令行选项会导致此问题：

```
 /targetplatform:"v4,c:\windows\Microsoft.NET\Framework\v4.0.30319" 
```

这是不正确的。当您在构建程序的机器上安装 4.5 时，该目录中的程序集会从 4.0 更新到 4.5，并且不再适合目标 4.0。这些程序集真的不应该再存在了，而是出于兼容的原因而保留下来。正确的参考程序集是 4.0 参考程序集，存储在其他地方：

```
 /targetplatform:"v4,C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\.NETFramework\v4.0" 
```

所以可能的解决方法是在构建机器上回退到 4.0，在目标机器上安装 .NET 4.5 和真正的修复，从提供的源代码重建项目，修复 ILMerge 命令。

* * *

请注意，这种故障模式并非 ILMerge 独有，它只是一种非常常见的情况。在以 4.0 为目标的项目中将这些 4.5 程序集用作参考程序集的任何其他情况都可能以同样的方式失败。从其他问题来看，另一种常见的故障模式是在未使用有效 VS 许可证的情况下设置的构建服务器。并且忽略了多目标包是[免费下载](http://www.microsoft.com/en-us/download/details.aspx?id=42637)的。

使用 c:\program files (x86) 子目录中的参考程序集是一项艰巨的要求。从 .NET 4.0 开始，避免意外依赖于 4.01、4.02 和 4.03 版本中添加的类或方法已经很重要。但现在 4.5 发布绝对必不可少。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-11-26T20:56:57.190

我遇到了这个问题，除了它无法加载的类型是 System.Reflection.AssemblyMetadataAttribute。Web 应用程序是在安装了 .NET 4.5 的机器上构建的（在那里运行良好），以 4.0 作为目标框架，但是当它在仅安装 4.0 的 Web 服务器上运行时出现错误。然后我在安装了 4.5 的 Web 服务器上尝试了它，没有错误。所以，正如其他人所说，这完全是由于微软发布 4.5 的方式很糟糕，这基本上是对 4.0 版的升级（和覆盖）。System.Reflection 程序集引用了 4.0 (AssemblyMetadataAttribute) 中不存在的类型，因此如果您没有新的 System.Reflection.dll，它将失败。

您可以在目标 Web 服务器上安装 .NET 4.5，也可以在未安装 4.5 的机器上构建应用程序。远非理想的分辨率。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2014-02-12T19:36:02.973

我在一个站点（Kentico CMS）上遇到了同样的问题，从 4.5 开始开发，发现生产服务器只支持 4.0，尝试回到 4.0 的目标框架。编译此线程中的其他帖子（特别是将目标框架更改为 .Net 4 和 .Net 4.5 仍被引用）。我搜索了我的解决方案，发现少数 NuGet 包仍在使用具有 targetFramework="net45" 的库。

```
packages.config (before):
<?xml version="1.0" encoding="utf-8"?>
<packages>
  <package id="AutoMapper" version="3.1.0" targetFramework="net45" />
  <package id="EntityFramework" version="5.0.0" targetFramework="net45" />
  <package id="Microsoft.AspNet.WebApi.Client" version="5.0.0" targetFramework="net45" />
  <package id="Newtonsoft.Json" version="4.5.11" targetFramework="net45" />
</packages> 
```

我将项目目标框架改回 4.5，删除了所有 NuGet 库，回到 4.0 并重新添加了库（必须使用一些不依赖于 4.5 的先前版本）。

```
packages.config (after):
<?xml version="1.0" encoding="utf-8"?>
<packages>
  <package id="AutoMapper" version="3.1.1" targetFramework="net40" />
  <package id="EntityFramework" version="6.0.2" targetFramework="net40" />
  <package id="Microsoft.AspNet.WebApi.Client" version="4.0.30506.0" targetFramework="net40" />
  <package id="Microsoft.Net.Http" version="2.0.20710.0" targetFramework="net40" />
  <package id="Newtonsoft.Json" version="4.5.11" targetFramework="net40" />
</packages> 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-02-14T01:43:30.990

我今天刚遇到这个烦人的问题。我们使用 SmartAssembly 来打包/混淆我们的 .NET 程序集，但突然间最终产品无法在我们的测试系统上运行。我什至不认为我有.NET 4.5，但显然大约一个月前安装了它。

我卸载了 4.5 并重新安装了 4.0，现在一切都恢复正常了。在这件事上吹了一个下午并没有留下太多印象。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-11-26T12:18:27.170

我在尝试从 Firebird 数据库中读取数据时确实遇到了同样的问题。经过几个小时的搜索，我发现问题是由我在查询中犯的错误引起的。修复它使它完美地工作。它与框架的版本无关

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2014-06-04T16:45:02.030

我们遇到了这个问题，并将其追溯到我们用来帮助​​我们的谷歌地图视图的[Geocoding.net NuGet](https://www.nuget.org/packages/Geocoding.net/3.1.0)包（Geocoding.net 版本 3.1.0 发布于 2014 年 2 月 4 日）。

当您检查包文件或使用 Jet Brains 的 Dot Peek 应用程序查看它时，Geocoding dll 似乎是 .Net 4.0；但是，我的一位同事说它是使用 ilmerge 编译的，因此很可能与上面列出的 ilmerge 问题有关。

追踪它是一个漫长的过程。我们从 TFS 获取不同的变更集，直到我们将其缩小到添加了上述 NuGet 包的变更集。删除它后，我们能够部署到我们的 .NET 4 服务器。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-07-03T19:57:33.237

在我的情况下，从 .NET 4.5 降级到 .NET 4.0 项目在本地计算机上运行良好，但在发布后在服务器上失败。

结果发现目的地有一些旧程序集，它们仍在引用 .NET 4.5。

通过启用发布选项“在发布前删除所有现有文件”来修复它

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-10-19T12:55:26.037

就我而言，这是在 TeamCity 机器上错过的 Blend SDK。这导致错误是由于错误的组装解决方式导致的。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-08-17T02:04:11.747

只需添加此答案即可帮助 Google 节省我为到达这里所花费的时间。我在我的 .Net 4.0 项目中使用了 ILMerge，没有设置 /targetplatform 选项，假设它可以从我的主程序集中正确检测到。然后，我只收到了来自 Windows XP 又名 WinXP 用户的投诉。现在这很有意义，因为 XP 永远不会安装 > .Net 4.0，而大多数较新的操作系统会。因此，如果您的 XP 用户遇到问题，请参阅上面的修复程序。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-02-20T08:21:05.930

就我而言，我在使用 Microsoft.ReportViewer.WebForms 时遇到了问题。我从 web.config 的行中删除了 validate=true`add verb`并开始工作：

```
<system.web>
    <httpHandlers>
      <add verb="*" path="Reserved.ReportViewerWebControl.axd" type="Microsoft.Reporting.WebForms.HttpHandler, Microsoft.ReportViewer.WebForms, Version=10.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" /> 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-09-25T13:59:08.173

```
AppendTargetFrameworkToOutputPath false 
```

一个不同的边缘案例......

如果您使用该`AppendTargetFrameworkToOutputPath`属性并将其设置为 false，然后复制针对不同平台的多个程序集，您可能会收到此消息。基本上，框架依赖关系是冲突的。

使用`AppendTargetFrameworkToOutputPath true`（或只是删除）或确保所有输出模块都针对相同的框架。

# mysql - 如何关闭数据库的主要检查

> ID：13748061
> 
> 赞同：4
> 
> 时间：2012-12-06T16:28:10.463
> 
> 标签：mysql, duplicates, primary-key

如果有人想关闭外键检查，则使用语句“SET FOREIGN_KEY_CHECKS = 0”。是否有一个 MySQL 语句来关闭所有主键检查。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T16:34:54.860

您可以使用 禁用 MyISAM 表中的非唯一键`ALTER TABLE ... DISABLE KEYS`，但不能关闭主键和唯一键，除非您从表中删除它们。

# r - Data.table 为现有列赋值

> ID：13748064
> 
> 赞同：0
> 
> 时间：2012-12-06T16:28:20.247
> 
> 标签：r, data.table

我在 data.table 对象中执行一个明显简单的分配。

```
library(RODBC)
library(data.table)
library(ffbase)
library(plyr)
library(doBy)
library(reshape2)

ST_a = Sys.Date()-7
ST = paste("'",as.character(format(ST_a,"%d.%m.%Y")),"'",sep="")
rd_a = Sys.Date()- 41
rd = paste("'",as.character(format(rd_a,"%d.%m.%Y")),"'",sep="")

ch<-odbcConnect("db",uid="user",pwd="psw")

chunks <- c(seq.Date(from=rd_a, to=ST_a, by = 20),ST_a)

started.at <- proc.time()
Sys.sleep(1)

memory.limit(size=4095)

for (i in 1:(length(chunks)-1)){

start <- paste("'",as.character(format(chunks[i],"%d.%m.%Y")),"'",sep="")
end <- paste("'",as.character(format(chunks[i+1],"%d.%m.%Y")),"'",sep="")

query <- paste("Select * from DATA_LOCAL_V 
        where id='EHPFCMO' and timestamp>",rd," and reference_date>=",start," and reference_date<",end,sep="") 

EHPFC.ck <- data.table(sqlQuery(ch,query,stringsAsFactors=FALSE))

EHPFC.ck[,TIMESTAMP:=TIMESTAMP-60^2]
EHPFC.ck[, pod:=7]
EHPFC.ck[as.POSIXlt(EHPFC.ck$TIMESTAMP)$hour %in% c(20:23), pod:=23]
EHPFC.ck[as.POSIXlt(EHPFC.ck$TIMESTAMP)$hour %in% c(8:19), pod:=19]
EHPFC.ck[,day:=as.Date(trunc(TIMESTAMP))]
EHPFC.ck[,TIMESTAMP:=NULL]
EHPFC.ck <- EHPFC.ck[,mean(VALUE),by=list(ID,REFERENCE_DATE,day,pod)]
setnames(EHPFC.ck,"V1","price")

EHPFC.ck <- as.ffdf(EHPFC.ck)

if (i==1){
EHPFC <- EHPFC.ck
} else {
EHPFC <- ffdfappend(EHPFC,EHPFC.ck[,])
}
rm(EHPFC.ck)
gc()

}

EHPFC <- data.table(EHPFC[,])
EHPFC <- orderBy(~day+pod+REFERENCE_DATE, data=EHPFC)
a <- c(0,log(EHPFC[-1,price]/EHPFC[-nrow(EHPFC),price]))
EHPFC <- EHPFC[,RoR:=a] 
```

通过这样做，我收到以下错误消息：

```
error in `[.data.table`(EHPFC, , `:=`(RoR, a)) : 
  At an earlier point, this data.table has been copied by R. Avoid key<-, names<- and attr<- which in R currently (and oddly) all copy the whole data.table. Use set* syntax instead to avoid copying: setkey(), setnames() and setattr(). If this message doesn't help, please ask on datatable-help. 
```

对象 EHPFC 如下所示：

```
EHPFC
           ID REFERENCE_DATE        day pod    price RoR
 [1,] EHPFCMO     2012-10-27 2012-10-27   7 35.34625   0
 [2,] EHPFCMO     2012-10-28 2012-10-27   7 35.34625   0
 [3,] EHPFCMO     2012-10-29 2012-10-27   7 35.34625   0
 [4,] EHPFCMO     2012-10-30 2012-10-27   7 35.34625   0
 [5,] EHPFCMO     2012-10-31 2012-10-27   7 35.34625   0 
```

我有点困惑为什么会这样。

任何想法？提前致谢。

# php - 在 Symfony2 上创建一个多色选择框

> ID：13748066
> 
> 赞同：0
> 
> 时间：2012-12-06T16:28:28.433
> 
> 标签：php, css, symfony, drop-down-menu

我尝试创建以下字段：

```
<select name="test">
    <option value="1">a</option>
    <option value="2">b</option>
    <option value="3" style="font-weight: bold; color: red;">c *</option>
    <option value="4">d</option>
    <option value="5">e</option>
</select> 
```

这将创建一个 2 色选择框：

![在此处输入图像描述](../Images/85a0aeba052119f10d18e408f1eafc24.png)

但是在 Symfony2 中，我不知道如何将一个类应用于单个选项。

如果在我看来我这样做：

```
{{
    form_widget(myForm.test, {
        'attr': {
            'class': 'red',
        }
    }) 
}} 
```

或者，如果以我的形式，我这样做：

```
 $builder->add('test', 'choice', array(
            'required' => true,
            'choices' => array('a', 'b', 'c *', 'd', 'e'),
            'attr' => array('class' => 'red'),
    )); 
```

该属性存储在`<select>`标签中并应用于整个可选值。

# 编辑

我使用 jQuery 解决了这个问题：

1）在我看来，我说：

```
{{
    form_widget(myForm.test, {
        'attr': {
            'class': 'starred-select',
        }
    }) 
}} 
```

2）在我的javascripts中，我放了：

```
 $('.starred-select option').each(function() {
        if ($(this).text().substr(-2) == ' *') {
            $(this).addClass('red');
        }
    }); 
```

当然，我的价值观不能由一颗星来完成。

**如何将类应用于`<option>`Symfony2 中的标签？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T16:55:08.693

您必须覆盖小部件选择字段的呈现方式。

[表单主题](http://symfony.com/doc/current/cookbook/form/form_customization.html#form-theming)允许您自定义表单的每个部分。甚至可以覆盖[基本表单块。](http://symfony.com/doc/current/cookbook/form/form_customization.html#referencing-base-form-blocks-twig-specific)

最好的方法是从[form_div_layout.html.twig](https://github.com/symfony/symfony/blob/2.1/src/Symfony/Bridge/Twig/Resources/views/Form/form_div_layout.html.twig)复制默认块 （在您的情况下，您必须覆盖该`widget_choice_options`块）

您还可以在应用程序的[不同级别自定义块。](http://symfony.com/doc/current/cookbook/form/form_customization.html#form-theming-in-twig)更深入地查看[文档](http://symfony.com/doc/current/cookbook/form/form_customization.html#referencing-base-form-blocks-twig-specific)，其中包含完整解释的示例。

# php - 谷歌地图 api 和 php 集成问题

> ID：13748067
> 
> 赞同：1
> 
> 时间：2012-12-06T16:28:29.020
> 
> 标签：php, javascript, google-maps-api-3

我有一个显示良好的谷歌地图（谷歌地图 API v3 - 见下面的代码）。该代码最初被插入到主 index.php 中，如下所示：-

```
<script type="text/javascript">
code here....
</script> 
```

这可以作为内联代码正常工作，我也可以在 index.php 中使用将我的 PHP 代码中的变量插入到 Google Maps API 中。

随着代码的增长，我想分离出 Google Maps API javascript 并将其弹出到外部文件中以保持整洁。

我的第一个想法是像这样插入文件：

```
<script type="text/javscript" src="code/googlemaps.php"></script> 
```

现在这可以正常工作，但是一旦我尝试插入任何 PHP 代码，它就不会工作。我不太确定 PHP 服务器如何处理请求，但我想我希望将 js 文件交给 PHP 解析器并解析 PHP 代码，然后将带有解析 php 的 js 传递回浏览器.

该代码由

```
<body onload="initialize()"> 
```

在我的主要 index.php 中（我是 javascript 新手，所以请多多包涵）。

为了完整起见，这里是我使用的 js 代码：

```
 function initialize() {

    // Main Google Map view variables
    var mapOptions = {
        zoom: 6,
        center: new google.maps.LatLng(<?php echo $selected_lat . "," . $selected_lon; ?>),
        mapTypeId: google.maps.MapTypeId.ROADMAP,
        noClear: true,
        panControl: true,
        panControlOptions: {
            position: google.maps.ControlPosition.TOP_RIGHT
            },
        zoomControl: true,
        zoomControlOptions: {
            style: google.maps.ZoomControlStyle.LARGE,
            position: google.maps.ControlPosition.TOP_RIGHT
            },
        scaleControl: true,
        scaleControlOptions: {
            position: google.maps.ControlPosition.BOTTOM_RIGHT
            },
        streetViewControl: false
    };

    // Display Google Map
    var map = new google.maps.Map(document.getElementById("map_canvas"),
    mapOptions);

    //Display Select Airport Marker
    var marker = new google.maps.Marker({
        position: new google.maps.LatLng(<?php echo $selected_lat . "," . $selected_lon; ?>),
        map: map,
        title:"<?php echo  $airport_name[$selected_airport]; ?> Airport Reference Point\na new line\nanother line"
    });

    // google.maps.Circle variables
    var seRangeOptions = {
        center: new google.maps.LatLng(<?php echo $selected_lat . "," . $selected_lon; ?>),
        fillOpacity: 0.3,
        fillColor: "blue",
        map: map,
        radius: <?php echo seradius; ?>,
        strokeColor: "#000000",
        strokeOpacity: 0.0,
        strokeWeight: 0
    };

    // display Google Maps circle
    serangecircle = new google.maps.Circle(seRangeOptions);
} 
```

好的，问题解决了。这是我所做的，欢迎反馈，我还在学习:) 以下代码放入 JavaScript 文件：

```
<?php session_start(); ?>
<?php echo 'var lat = "'.json_encode($_SESSION['lat']).'";';?> 
```

这一切的执行顺序仍然有点模糊。我假设 PHP 解析 javascript 文件，插入 PHP 变量，然后将文件返回给浏览器？此外，任何像 Firebug 这样的实用程序都会让我看到它在实践中是如何工作的。

我还在 js 文件的顶部弹出了以下内容，这似乎也整理了源代码在浏览器中的显示方式：

```
<?php header('Content-type: text/javascript'); ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T16:54:22.840

问题可能是这一行：

```
 title:"<?php echo  $airport_name[$selected_airport]; ?> Airport Reference Point\na new line\nanother line" 
```

JavaScript 不接受换行符直接继续字符串，您必须使用`\n`，如果`title:"<?php echo $airport_name[$selected_airport]; ?> Airport Reference Point\na new line\nanother line"`返回多行字符串，那么它将破坏 JavaScript 代码。

尝试使用[str_replace()](http://php.net/str_replace)函数将所有新行替换为`\n`，以及添加[斜杠()](http://php.net/addslashes)，这样`"`也不会破坏 JavaScript 字符串

```
title:"<?php echo str_replace("\n", '\n', str_replace("\r",'', addslashes($airport_name[$selected_airport]))); ?> Airport Reference Point\na new line\nanother line" 
```

# utf-8 - gcc utf-8 字符串文字编译错误

> ID：13748068
> 
> 赞同：0
> 
> 时间：2012-12-06T16:28:37.007
> 
> 标签：utf-8, string-literals, gcc4.7

我在 Ubuntu 上使用 g++(GCC) 4.7.2。只是想弄清楚如何让“u8”字符串文字前缀进行编译。我认为它是在这个版本的 gcc 中“内置”的。

```
#include <iostream>
#include <string>
int 
main ()
{
  std::string example1 = u8"Abcd";
  std::cout << "Hello, world!\n";
  return 0;
} 
```

> > $ g++ -Wall -B/usr/lib/x86_64-linux-gnu/helloworld.cpp -o hello helloworld.cpp：在函数'int main()'中：helloworld.cpp:12:26：错误：'u8'是未在此范围内声明 helloworld.cpp:12:28: error: expected ',' or ';' 在字符串常量 helloworld.cpp:12:15 之前：警告：未使用的变量 'example1' [-Wunused-variable]

我使用“-B”选项，因为那是我的 crt1.o 和 crti.o 所在的位置。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T18:09:10.033

这是一个 c++11 特性，所以添加`-std=c++0x`到你的命令行。这对我来说适用于 g++ 4.6.3，在 4.7.2 上`-std=c++11`可能也适用

# registry - 如何找出不在 HKCR 中的文件关联

> ID：13748073
> 
> 赞同：1
> 
> 时间：2012-12-06T16:28:49.733
> 
> 标签：registry, windows-shell, file-association

## 语境

对于给定的文件扩展名，我需要找出文件关联的 ProgID(?)（例如.docx*的**Word.Document*）。我需要他 (a) 识别特定的关联软件（例如*Adob* ​​e与*Nuance*）并在他们打开文档之前进行相应处理，以及 (b) 使 Outlook 显示虚拟文件的正确图标（消息类）。***`IPM.Document.[ProgID]`***

 ***## 目前的解决方案

我只是在以下位置读出`(Default)`注册表项的条目`HKEY_CURRENT_ROOT\[extension]`

## 问题

在某些机器上，对于某些文件类型，`(Default)`HKCR 中的条目是***空***的。但是，Windows 资源管理器（shell）显示相应的图标，并且在打开文件时肯定有一个工作文件关联。

显然，我没有使用正确的方法来检索文件关联。是否有我遗漏的[ASSOCSTR可以传递给将返回此信息的](http://msdn.microsoft.com/en-us/library/windows/desktop/bb762475%28v=vs.85%29.aspx)[AssocQueryString](http://msdn.microsoft.com/en-us/library/windows/desktop/bb773471%28v=vs.85%29.aspx)，或者我忽略的 MSDN 上有关文件关联的任何其他调用或标准文档？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T04:07:56.193

自 Windows Vista（我认为）以来，用户可以通过密钥覆盖正常的 HKCR 文件关联系统

> HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\ *.extension* \UserChoice\

您需要检查此键的`ProgId`值并使用它（如果存在），并`HKCR\extension`仅将其视为默认后备。***

# android - Android OutOfMemory 异常 - 还有另一种方法可以满足我的需求吗？

> ID：13748074
> 
> 赞同：3
> 
> 时间：2012-12-06T16:28:51.207
> 
> 标签：android, out-of-memory, bitmapfactory, android-drawable

我的应用程序正在加载一个大图像（房屋平面图），然后在图像上绘制触摸反应对象（家具、灯具等）。我的应用程序包含一个基本图像文件，但对象来自我数据库中的坐标。

我已经在多次迭代中成功部署了该应用程序，但现在我需要使用更大的基本映像，并且在许多设备上`BitmapFactory`导致`OutOfMemory`异常（旧设备和新设备；任何小于 32MB 堆的东西似乎都崩溃了）。我已经阅读了关于 SO 的 157 OOM 问题，但恐怕他们似乎都指向的[链接](http://developer.android.com/training/displaying-bitmaps/index.html)对我没有帮助，因为分辨率/缩放对应用程序的功能至关重要。

我尝试在加载之前测试设备的可用内存，但结果充其量是参差不齐（一些设备，如 Galaxy S3 报告大量堆但仍然崩溃）。我也尝试过降低分辨率，但根据上述测试将图像缩小到安全尺寸时，图像变得无法使用。

有没有另一种方法可以在不使用位图的情况下实现这种设计？我需要：

*   加载大型基础图像
*   在基础图像上创建可点击的形状，保持它们相对于基础图像的位置/比例
*   *奖励*：在我的应用程序的 iOS 版本中，我可以进行 SVG 样式的文本缩放，因此小对象上的长标签将保留在对象内部，而不是在地图上运行（并且在图像缩放之前将不可见）。在 android 中复制它会让我成为一个快乐的代码猴子。

如果需要，我可以发布代码，但你们之前都看过（几乎所有代码都来自 SO）。

提前感谢您的阅读，以及您可以提供的任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T16:57:02.107

你有几个选择：

1.  正如评论所建议的那样，将您的大图像分解为图块，将这些图块加载到数组中，然后移动相机对象并仅加载需要绘制的图块。

2.  使您的图像变小并使用“android：scaletype”将其放大

3.  `Canvas`在运行时在对象上绘制直线和曲线。

4.  使用 OpenGL

适当的解决方案实际上取决于您希望它的外观。平铺需要更多的开发工作，但看起来会更好，请注意正确清理任何未绘制的瓷砖......

动态缩放会更容易，但你不能保证图像不会模糊。

在运行时在对象上绘图`Canvas`可以很好地工作 - 只需使用不同宽度的线条和圆形和矩形等。

使用 OpenGL 将有最陡峭的学习曲线，并且可能是矫枉过正。这取决于你的目的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T03:27:24.097

以下是一些选项：

1）使用瓷砖。使用磁贴并动态加载您的数据。老实说，这是最好的解决方案。使用此解决方案，您可以加载任意大的图像。

我已经成功地将这种方法用于无尽的画布，并且效果很好。您实际上只需要绘制用户直接可见的内容。瓷砖是一种丢弃不需要的碎片的方法。瓦片金字塔（您可以在其中对图像进行预下采样并创建更多瓦片），使您能够以干净快速的方式完成此操作。

2）使用本机代码。本机代码的内存限制与 Java 代码不同。您可以避免分配更多内存。

3) 使用 OpenGL。再说一次，OpenGL 的内存限制与 Java 代码不同。

4）将您的原始计划转换为 SVG 并使用像[这样](http://code.google.com/p/svg-android/)的 SVG 库。

5）使用“大堆”。我强烈反对这样做，因为我认为 largeHeap 很少是解决方案，通常有更清洁的方法来解决问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-24T07:42:14.207

如果图像是静态的，您可能希望使用这个不错的库：

[https://github.com/ManuelPeinado/ImageLayout](https://github.com/ManuelPeinado/ImageLayout)

如果库不支持图像的自动下采样，你应该自己做，以便为当前设备使用最好的图像（这样你就不会得到 OOM）。

对于 auto-sizing text ，您可能会对下一篇文章有​​所了解：

[适用于 Android 的自动调整 TextView](https://stackoverflow.com/questions/16017165/auto-fit-textview-for-android/17786051?noredirect=1#17786051)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-14T03:11:57.807

您可能想研究使用“大堆” [http://developer.android.com/reference/android/R.styleable.html#AndroidManifestApplication_largeHeap](http://developer.android.com/reference/android/R.styleable.html#AndroidManifestApplication_largeHeap)

# c - 如何将两个分数相加？

> ID：13748080
> 
> 赞同：4
> 
> 时间：2012-12-06T16:29:14.767
> 
> 标签：c, add, fractions

假设这些函数已经给出：

```
include <stdio.h>     /* printf                         */
include "fractions.h" /* struct FRACTION, add_fractions */

struct FRACTION make_fraction(int numerator, int denominator)
{
  struct FRACTION f;

  f.numerator = numerator;
  f.denominator = denominator;

  return f;
}

void test_fraction(int numerator1, int denominator1, 
                   int numerator2, int denominator2)
{
  struct FRACTION a = make_fraction(numerator1, denominator1);
  struct FRACTION b = make_fraction(numerator2, denominator2);

  struct FRACTION c = add_fractions(&a, &b);

  printf("%i/%i + %i/%i = %i/%i\n", a.numerator, a.denominator,
                                    b.numerator, b.denominator,
                                    c.numerator, c.denominator);
}

void testGCD(void)
{
  int m, n;

  m = 15; n = 18; /* GCD is 3 */
  printf("GCD of %i and %i is %i\n", m, n, GCD(m, n));
  printf("GCD of %i and %i is %i\n", n, m, GCD(n, m));

  m = 80; n = 20; /* GCD is 20 */
  printf("GCD of %i and %i is %i\n", m, n, GCD(m, n));
  printf("GCD of %i and %i is %i\n", n, m, GCD(n, m));

  m = 21; n = 47; /* GCD is 1 */
  printf("GCD of %i and %i is %i\n", m, n, GCD(m, n));
  printf("GCD of %i and %i is %i\n", n, m, GCD(n, m));

  m = 68; n = 153; /* GCD is 17 */
  printf("GCD of %i and %i is %i\n", m, n, GCD(m, n));
  printf("GCD of %i and %i is %i\n", n, m, GCD(n, m));
}

int main(void)
{
  testGCD();

  test_fraction(2, 3, 1, 6);
  test_fraction(1, 5, 4, 9);
  test_fraction(3, 7, 12, 21);
  test_fraction(5, 8, 3, 16);
  test_fraction(7, 8, 3, 12);
  test_fraction(0, 8, 3, 16);
  test_fraction(1, 1, 3, 16);
  test_fraction(5, 8, -3, 16);
  test_fraction(1, 5, -4, 9);
  test_fraction(-1, 5, -4, 9);

  return 0;
} 
```

我的任务是写`GCD()`and `add_fractions()`，这就是我写的：

```
include "fractions.h" 

struct FRACTION add_fractions(const struct FRACTION *a, const struct FRACTION *b)
{                                    
    struct FRACTION c ; /*result struct*/
   /* int GCD_a = GCD(a.numerator, a.denominator);  GCD of the fraction a*/ 
    /*int GCD_b = GCD(b.numerator, b.denominator);  GCD of the fraction b*/

    c.numerator = (a.numerator) + (b.numerator);
    c.denominator = a.denominator ;

    return c;
  /* struct FRACTION empty;*/
   /*return empty;*/
}

int GCD(int a, int b)
{
    /*Variables*/
    int remainder = 0; /*remainder*/
    int larger = a;    
    int smaller = b;

    remainder = larger % smaller;
    while (remainder != 0)
    {
      larger = smaller;
      smaller = remainder;
      remainder = larger % smaller;
    }

    return smaller;
} 
```

假设目前两个分母相等，为什么我不能用 Cygwin 运行它？我用这个命令编译

```
gcc -Wall -Wextra -ansi -pedantic -Wno-unused-parameters main.c fractions.c -o fractions.exe 
```

我有两个错误：（Cygwin 在我的电脑上是西班牙语，所以我不确定我要写的是准确的翻译）：

```
error: trying to put "numerator" in something which is not a struct 
```

（分母也一样）

问题是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-06T16:35:02.813

```
const struct FRACTION *a, const struct FRACTION *b 
```

所以`a`和`b`是指向常量的指针`struct FRACTION`。然后你写：

```
c.numerator = (a.numerator) + (b.numerator); 
```

您不使用 访问结构指针的成员`.`，但使用`->`，这应该是

```
c.numerator = a->numerator + b->numerator; 
```

附言 1：括号不是必须的，不要多加，会降低可读性。

附言 2：你的加法公式坏了，用

```
c.numerator = a->numerator * b->denominator + b->numerator * a->denominator;
c.denominator = a->denominator * b->denominator; 
```

反而。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T16:37:32.307

在您的函数中`add_fractions`，您已将`a`和声明`b`为*指向*`struct FRACTION`：

```
struct FRACTION add_fractions(const struct FRACTION *a, const struct FRACTION *b) 
```

因为`a`and`b`是*指针*，而不是结构，所以你不能写像`a.numerator`.

您需要*取消引用* `a`并且`b`在使用`.`运算符之前：

```
c.numerator = ((*a).numerator) + ((*b).numerator);
c.denominator = (*a).denominator ; 
```

或使用`->`组件选择运算符，这是做同样事情的简写方式：

```
c.numerator = (a->numerator) + (b->numerator);
c.denominator = a->denominator ; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-07-27T08:05:11.393

除了`user529758`你的加法算法应该是

```
 n1 * d2 + n2 * d1
= ------------------
       d1 * d2 
```

我认为需要强调乔纳森的观点，然后您需要将结果的分子和分母除以 ，`GCD`以将结果分数减少[到最低形式](http://statsfiddle.info/Calculator/ReducedFractions)。

例如，您可以实现一个新函数来进行归约：

```
struct FRACTION reduce_fraction(const struct FRACTION *frac)
{
    struct FRACTION reduced;
    int gcd = GCD(frac->numerator, frac->denominator);

    reduced.numerator = frac->numerator / gcd;
    reduced.denominator = frac->denominator / gcd;

    return reduced;
} 
```

您的`add_fraction`函数现在将如下所示：

```
struct FRACTION add_fractions(const struct FRACTION *a, const struct FRACTION *b)
{                                    
    struct FRACTION c;

    c.numerator = (a->numerator * b->denominator) + (b->numerator * a->denominator);
    c.denominator = a->denominator * b->denominator;
    return reduce_fraction(&c);
} 
```

此外，鉴于您已经完成了艰苦的工作来确定评论中的结果，而不是`printf`ing to `stdout`，为什么不`assert`这样做 - 这为自动化单元测试提供了基础：

```
#include <assert.h>
...
m = 15; n = 18;
assert(GCD(m, n) == 3);
assert(GCD(m, n) == GCD(n,m));

m = 80; n = 20;
assert(GCD(m, n) == 20);
assert(GCD(m, n) == GCD(n,m)); 
```

和 也`add_fractions`一样`reduce_fraction`:)

# actionscript-3 - DateField: selectedDate 显示小时为 24:00:00

> ID：13748085
> 
> 赞同：0
> 
> 时间：2012-12-06T16:29:42.870
> 
> 标签：actionscript-3, apache-flex

使用 DateField 组件， selectedDate.getHours 返回为 24:00:00。我希望它返回为 00:00:00。

是否有捷径可寻？

谢谢！

更新：

首先，我在模型中设置了一个变量，该变量等于 DateField 组件的 selectedDate：

```
model.generalInfo.endDate = endDate_df.selectedDate; 
```

然后我根据该值设置另一个变量并跟踪它：

```
param.todate = df.format( model.generalInfo.endDate.toString() ); 
```

这就是我看到的时间等于 24:00:00

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T21:00:47.430

你可以尝试类似的东西

```
 selectedDate.time = selectedDate.time - 24 * 60 * 60 * 60 * 1000 
```

作为 Date.time 表示自 1970 年以来的毫秒数或其他任何时间......你减去 24 小时......

如果它不适合您，您可以创建一个新函数或转换它的 getter，或者您可以创建一个新的 mxml 模块，将 DateField 作为超类，您可以覆盖 getHours 方法。有很多选择可以做到这一点..

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T22:46:43.113

看起来您正在使用 Flex [DateFormatter](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/mx/formatters/DateFormatter.html#format%28%29)来格式化`Date`对象。看看这个类的文档，它有一个[formatString](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/mx/formatters/DateFormatter.html#formatString)属性，你可以用它来控制如何输出日期（或者在这种情况下是时间）。

如果您提供`DateFormatter`包含“H”的格式字符串，则将使用数字范围 1-24 以 24 小时格式输出小时。如果格式字符串包含“J”，它将使用 0-23 范围以 24 小时格式输出小时。

要获得所需的输出，请在格式字符串中使用“JJ”，以及任何其他项目。例如输出小时、分钟、秒：

```
var someDate:Date = new Date(2012, 11, 5);
var df:DateFormatter = new DateFormatter();
df.formatString = "JJ:NN:SS";
var formatted:String = df.format(someDate); // 00:00:00 
```

此外，正如@Flextras 所提到的，您可以使用 Flash 本地化 API，它具有将日期/时间字符串转换为其区域设置使用的值的额外好处。这些是`DateTimeFormatter`类：

*   [fl.globalization.DateTimeFormatter](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/globalization/DateTimeFormatter.html)
*   [spark.formatters.DateTimeFormatter](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/spark/formatters/DateTimeFormatter.html) (Flex 4)

这些类将日期格式化为用户的语言环境（或您指定的语言环境），并`Date`以相同的方式格式化对象`DateFormatter`。

# excel - Excel VBA：可以删除验证但不能添加新验证

> ID：13748090
> 
> 赞同：3
> 
> 时间：2012-12-06T16:29:52.307
> 
> 标签：excel, validation, vba

我的代码如下

```
If Cells(Target.Row, 2) = "" And (Cells(Target.Row, 3) = "" Or Cells(Target.Row, 3) = "") Then
    Sheets("MySheet").Activate
    Cells(Target.Row, 3).Activate
    ActiveCell.Validation.Delete
    If (Cells(Target.Row, 2) = "Type A") Then
        ActiveCell.Validation.Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:=xlBetween, Formula1:="=AvailableVersions"
    ElseIf (Cells(Target.Row, 2) = "Type B") Then
        ActiveCell.Validation.Delete
    Else
        ActiveCell.Validation.Add Type:=xlValidateWholeNumber, AlertStyle:=xlValidAlertInformation, Formula1:="0", Formula2:="9999999"
    End If
End If 
```

所以每当我到达 ActiveCell.Validation.Add 时，我遇到的问题就会出现

```
Run Time Error '1004': Application-defined or object-defined error 
```

这不是一个非常有用的错误，而且数字和列表验证类型也会发生这种情况，所以我确信这不是列表本身的问题，它无论如何都具有工作簿级别的范围。它永远不会发生在我觉得奇怪的 ActiveCell.Validation.Delete 上？

我一直在谷歌试图找到一个解决方案，大多数人认为这是由于从一个按钮运行动态验证代码引起的，尽管激活调用，但我正在运行工作表更改事件而不是按钮按下所以我不要认为这是我的问题 - 有什么想法吗？我基本上浪费了一整天的时间！:(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T17:01:49.380

如果您不是从工作表事件中运行它，您的代码会很好。对我来说，当您尝试从事件过程中选择一个新单元格时会出现问题。我重写了您的代码在不选择其他单元格的情况下尝试执行的操作。

尝试这个：

```
If Cells(Target.Row, 2) = "" And (Cells(Target.Row, 3) = "" Or Cells(Target.Row, 3) = "") Then
    With Sheets("MySheet")
        .Cells(Target.Row, 3).Validation.Delete
        If (.Cells(Target.Row, 2) = "Type A") Then
            .Cells(Target.Row, 3).Validation.Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:=xlBetween, Formula1:="=AvailableVersions"
        ElseIf (.Cells(Target.Row, 2) = "Type B") Then
            .Cells(Target.Row, 3).Validation.Delete
        Else
            .Cells(Target.Row, 3).Validation.Add Type:=xlValidateWholeNumber, AlertStyle:=xlValidAlertInformation, Formula1:="0", Formula2:="9999999"
        End If
    End With
End If 
```

另一个可能的错误是如果`AvailableVersions`不是列表的有效定义名称。

# c# - Winform标签文本不显示

> ID：13748091
> 
> 赞同：4
> 
> 时间：2012-12-06T16:29:53.887
> 
> 标签：c#, winforms

我有以下代码：

```
Hide()
if(a > b)
{
label.Text = "a is greater than b";
Show();
Thread.Sleep(50000);
} 
```

我想要做的是在应用程序启动后立即隐藏 winform。如果 a>b 在任何时候，它将在标签中显示带有该消息的 winform 50 秒，然后再次隐藏。标签也设置为 autosize = true;

上面的代码有效，但标签没有显示任何文字？这也是使用线程睡眠显示winfor的正确方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-06T16:39:37.293

Thorsten 是对的，Sleep 正在冻结 UI 线程，因此 UI 不会刷新，但您也可以执行以下操作作为解决方法：

```
Hide()
if(a > b)
{
    label.Text = "a is greater than b";
    Show();
    Refresh();
    Thread.Sleep(5000);
} 
```

但最干净的解决方案当然是：

```
Hide()
if(a > b)
{
    label.Text = "a is greater than b";
    Show();
    Task.Factory
        .StartNew(() => Thread.Sleep(5000))
        .ContinueWith(() => Close(), TaskScheduler.FromCurrentSynchronizationContext());
} 
```

但不要忘记添加正确的 using 子句以使用任务并行库：

```
using System.Threading.Tasks; 
```

TPL 在 .NET 4 及更高版本中可用。更多信息在这里：http: [//msdn.microsoft.com/en-us/library/dd460717.aspx](http://msdn.microsoft.com/en-us/library/dd460717.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-06T16:43:40.413

如上所说，是因为sleep，UI还没来得及更新呢。

但是，您不必使用计时器。DoEvents() 给它一些时间来更新 UI。

尝试

```
 Hide();
if(a > b)
{
    label.Text = "a is greater than b";
    Show();
    System.Windows.Forms.Application.DoEvents();
    Thread.Sleep(50000);
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-06T16:31:44.977

这是因为`Thread.Sleep`导致应用程序暂停当前线程 - 这意味着在这 50 秒内表单上没有发生更新。

您需要做的是启动一个 50 秒后经过的计时器，并在计时器的代码中隐藏表单。

计时器可以是放置在窗体上的 Windows 窗体计时器组件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-06T16:39:47.617

避免在 UI 类中暂停线程。您想要的最后一件事是无响应的界面！

# php - 时间戳错误的时间

> ID：13748100
> 
> 赞同：1
> 
> 时间：2012-12-06T16:30:28.913
> 
> 标签：php, timestamp

这是我的问题

我的默认时区是`date_default_timezone_set('Europe/Madrid')`

```
actual time 2012-12-06 17:00:38
start time 2012-12-10 16:30:00

unix timestamp actual time 1354809638
unix timestamp start time 1350052200 
```

开始时间大于实际时间。但是“unix 时间戳实际时间”大于“unix 时间戳开始时间”。

我想知道为什么？

相关代码：

```
$to_unix_startTime = new DateTime($postField['startTime']);
$UnixStartTime = $to_unix_startTime->format('U'); 
```

$date = new DateTime(); $actualTime = $date->getTimestamp();

```
$start = new DateTime($postFields['startAuct']);
        $start->format('Y-m-d H:i:s').PHP_EOL;
        $start_tmstmp = date_timestamp_get($start);
        $date = new DateTime(); 
        $timestamp = $date->getTimestamp();
        if ($timestamp > $start_tmstmp) {
            echo $auctStatus = 1;
        } elseif ($timestamp < $start) {
            echo $auctStatus = 4;
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T17:11:24.527

`$postField['startTime']`格式错误。我怎么知道这个？您从开始日期 获得的时间戳`1350052200`表示日期`2012-10-12`（2012 年 10 月 12 日）而不是`2012-12-10`（2012 年 12 月 10 日）。

`$postField['startTime']`可能是格式`10/12/2012`（将被解析`DateTime`为美式日期），而它应该被格式化为`10-12-2012`（将被解析`DateTime`为欧式日期）。

因此，最后，检查日期的格式`$postField['startTime']`并确保它是欧洲风格的日期表示。

**[编辑]**比较：

```
$european = new DateTime( '10-12-2012' );
$american = new DateTime( '10/12/2012' );

echo $european->format( 'Y-m-d' ) . ' (' . $european->getTimestamp() . ')' . PHP_EOL;
echo $american->format( 'Y-m-d' ) . ' (' . $american->getTimestamp() . ')' . PHP_EOL; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T16:54:01.783

在获取时间戳之前无需格式化日期时间。

在这里检查我的代码：[https ://compilr.com/shadyyx/datetime/index.php](https://compilr.com/shadyyx/datetime/index.php)

如果链接有任何问题，这里是没有输出的代码：

```
<?php

date_default_timezone_set('Europe/Madrid');

$start = new DateTime('2012-12-10 16:30:00');
$actual = new DateTime('2012-12-06 17:00:38');

echo $start->format('d.m.Y H:i:s').PHP_EOL;
echo $actual->format('d.m.Y H:i:s').PHP_EOL;
echo PHP_EOL;

$start_tmstmp = $start->getTimestamp();
$act_tmstmp = $actual->getTimestamp();

echo $start_tmstmp.PHP_EOL;
echo $act_tmstmp.PHP_EOL;
echo PHP_EOL;

var_dump($start_tmstmp > $act_tmstmp); 
```

# ant - Ant：如何在不从 Main 调用路径的情况下获取 Java 路径？

> ID：13748101
> 
> 赞同：0
> 
> 时间：2012-12-06T16:30:29.317
> 
> 标签：ant

我正在做插件开发，但没有一个类有主。因此，如果没有硬编码到我的 java 目录的路径，我该怎么做呢？

我目前做这个黑客工作

```
<property name="jdk.home.1.6" value="C:/Program Files/Java/jdk1.6.0_22"/> 
```

并以此为基础。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T17:45:36.630

您在 ant 中有内置属性：[http](http://www.roseindia.net/tutorials/ant/findHomePath.shtml) ://www.roseindia.net/tutorials/ant/findHomePath.shtml 这意味着您可以使用：

```
<property name="jdk.home.1.6" value="${java.home}"/> 
```

HIH

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T16:31:46.947

你可以尝试使用`System.properties()`

`System.properties()`将返回有关当前 java 虚拟机配置的信息。

*   "file.separator" 分隔文件路径组件的字符。这是 UNIX 上的“/”和 Windows 上的“\”。
*   “java.class.path” 用于查找包含类文件的目录和 JAR 档案的路径。类路径的元素由 path.separator 属性中指定的平台特定字符分隔。
*   **“java.home” Java 运行时环境 (JRE) 的安装目录**
*   “java.vendor” JRE 供应商名称
*   “java.vendor.url” JRE 供应商 URL
*   "java.version" JRE 版本号
*   "line.separator" 操作系统用来分隔文本文件中的行的序列
*   "os.arch" 操作系统架构
*   "os.name" 操作系统名称
*   "os.version" 操作系统版本
*   "path.separator" java.class.path 中使用的路径分隔符
*   "user.dir" 用户工作目录
*   "user.home" 用户主目录
*   "user.name" 用户账户名

# python - Python 3.2，Tkinter 类声明，子类化时类未定义

> ID：13748106
> 
> 赞同：2
> 
> 时间：2012-12-06T16:30:41.317
> 
> 标签：python, class, user-interface, tkinter, declaration

我正在学习 python 并遇到了来自 tkinter 的类装饰器的问题。只要我从不尝试用 Frame 装饰，我就可以让 tkinter 工作。下面的代码没有给我任何错误，也没有窗口。无论出于何种原因，我定义的类永远不会被定义。下面是我的代码。下面是我根据关于 tkinter 的类似问题所做的测试。

```
>>> from tkinter import *
import tkinter
class Apples:
    def __init__(self, master):
        frame = Frame(master)
        frame.pack()
        self.button = Button(frame, text="Quit", fg="blue", command=frame.quit)
        self.button.pack(side=LEFT)
        self.hellos = Button(frame, text="Hello", command=self.say_hello)
        self.hellos.pack(side=LEFT)
    def say_hello(self):
        print("Hello World!")
root = Tk()
app = Apples(root)
root.mainloop() 
```

没有窗口出现。没有错误。所以我检查了类...

```
>>> test = Apples(root)
Traceback (most recent call last):
  File "<pyshell#54>", line 1, in <module>
    test = Apples(root)
NameError: name 'Apples' is not defined
>>> 
```

我发现了一个类似的问题[Creating buttons with Python GUI](https://stackoverflow.com/questions/13070065/creating-buttons-with-python-gui) 并尝试了来自 pythonMan 的代码。我仍然遇到相同的类声明问题。

```
>>> from tkinter import * 

class Application(Frame):
"""A GUI application with three button"""

def __init__(self,master):
    self.master = master
    self.create_widgets()

def create_widgets(self):
    #"""Create three buttons"""
    #Create first buttom
    btn1 = Button(self.master, text = "I do nothing")
    btn1.pack()

    #Create second button
    btn2 = Button(self.master, text = "T do nothing as well")
    btn2.pack()

    #Create third button
    btn3=Button(self.master, text = "I do nothing as well as well")
    btn3.pack()

root = Tk()
root.title("Lazy Button 2")
root.geometry("500x500")
app = Application(root)
root.mainloop()
>>> Application
Traceback (most recent call last):
  File "<pyshell#58>", line 1, in <module>
    Application
NameError: name 'Application' is not defined
>>> 
```

我可以认为某些东西没有正确声明，但没有产生语法错误。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-27T17:51:21.607

我认为您不需要“>>>”标志。

“从 Tkinter 导入 *”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T17:39:11.200

假设您的代码在问题的第二部分中正确复制，则您的类定义不正确。您`def __init__`的缩进级别与`class Application(Frame)`. 您的方法需要缩进才能成为类的一部分。

您问题第一部分中的代码对我来说很好。

# c# - 在 Windows Phone 上同步加载图像的更好方法？

> ID：13748107
> 
> 赞同：1
> 
> 时间：2012-12-06T16:30:45.253
> 
> 标签：c#, windows-phone-7, windows-phone

我是 C# Windows Phone 编程新手。

简而言之，我目前正在构建一个应用程序，它将：

加载`image A`

加载`image B`

然后加载`image C`

然后使用这 3 张图像进行一些后期处理。

`Content`我的图像 B 和图像 C 是在项目中构建的。图像 A 是从图库中选择或通过相机拍摄的，或者我们可以简单地假设图像 A 是从独立存储中加载的。

我遇到了一个我认为是由异步图像加载引起的问题。

这是我的代码：

```
...
// I intend to load the 3 pictures by calling the method: LoadImage(int id) and LoadCImage();

            else if (ListBox.SelectedIndex == 0)
            {
                Debug.WriteLine("Selected 0");
                PhotoProcessor pp = new PhotoProcessor();
                WriteableBitmap imageA = new WriteableBitmap(AImage);
                WriteableBitmap imageB = LoadImage(0);
                WriteableBitmap imageC = LoadCImage();
                WriteableBitmap mix = pp.Mix(pp.CalcAverageColour(0), imageA, imageB, imageC);
                resultPic.Source = mix;
            }
... 
```

和：

```
private WriteableBitmap LoadImage(int id)
        {
            //String uriString = "/Assets/img0.jpg";            
            //BitmapImage img = new BitmapImage(new Uri(uriString, UriKind.Relative));
            BitmapImage img = new BitmapImage();
            img.CreateOptions = BitmapCreateOptions.None;
            //img.SetSource(Application.GetResourceStream(new Uri("/Assets/facetemplate0.jpg", UriKind.Relative)).Stream);
            img.UriSource = new Uri("/Assets/img" + id + ".jpg", UriKind.Relative);

            //img.UriSource = new Uri(uriString, UriKind.Relative);
            return new WriteableBitmap(img);
        }

        private WriteableBitmap LoadCImage()
        {
            //BitmapImage img = new BitmapImage(new Uri("/Assets/imgC.jpg", UriKind.Relative));
            BitmapImage bmp = new BitmapImage();
            bmp.CreateOptions = BitmapCreateOptions.None;
            //img.SetSource(Application.GetResourceStream(new Uri("/Assets/imgC.jpg", UriKind.Relative)).Stream);
            bmp.UriSource = new Uri("/Assets/imgC.jpg", UriKind.Relative);
            return new WriteableBitmap(bmp);
        } 
```

现在我的问题是：

当我试图运行这段代码时，它会抛出一个空引用异常，这是因为函数`mix`无法加载图像 AB 和 C（加载这些图像是异步的）。

我想知道是否有办法让我顺序加载这些图像然后让我将它们传递给`mix`函数？

我试过的：

1.  通过查看[这篇很棒的博客文章](http://blogs.msdn.com/b/swick/archive/2011/04/07/image-tips-for-windows-phone-7.aspx)，我可以知道确实有一些方法可以同步加载图像，但是正如您在我的代码中看到的那样，我尝试`SetSource(stream)`像博客文章一样使用，但不幸的是我得到了相同的空引用例外。

2.  我也考虑过这种`EventHandler`方法，但是在这种情况下我认为这不是一个好主意。如果我实现`EventHandler`，它会是这样的（伪代码）：

    ```
    imageA_Opened()
    {
    LoadImageB += imageB_Opened();
    }

    imageB_Opened()
    {
     LoadImageC += imageC_Opened();
    }

    imageC_Opened()
    {
    PhotoProcessor pp = new PhotoProcessor();
    pp.Mix(averageColour, A, B, C);
    } 
    ```

我对吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-13T15:01:25.223

Servy 说你不应该用同步调用阻塞 UI 是正确的。

话虽如此，我在 WP7 应用程序中也有类似的要求。我使用“Async CTP”来添加编写类似同步函数的功能，这些函数会等到它完成后再进行下一次调用。我的 API 调用需要来自早期调用的数据才能正常运行。

我相信这已包含在 .NET 4.5 中并适用于 WP8。

[http://msdn.microsoft.com/en-ca/library/vstudio/hh191443.aspx](http://msdn.microsoft.com/en-ca/library/vstudio/hh191443.aspx)

这是我为我的应用程序提取数据而写的内容（注意“ **async** ”和“ **await** ”关键字）：

```
public async Task<bool> GetDefaultData()
{
    try
    {
        _cancellation = new CancellationTokenSource();

        UpdateProgress(DateTime.Now + ": Download Started.\n");
        List<string> data = await App._apiConnection.DoWorkAsync(_cancellation.Token, ApiInfo.GetBaseDataUriList());
        App._apiConnection.Done(data);

        UpdateProgress(DateTime.Now + ": Countries: " + App._context.Countries.Count() + "\n");
        UpdateProgress(DateTime.Now + ": Regions: " + App._context.Regions.Count() + "\n");
        UpdateProgress(DateTime.Now + ": Income Levels: " + App._context.IncomeLevels.Count() + "\n");
        UpdateProgress(DateTime.Now + ": Indicators: " + App._context.Indicators.Count() + "\n");

        data = await App._apiConnection.DoWorkAsync(_cancellation.Token, ApiInfo.GetCountryUriList("CA"));
        App._apiConnection.Done(data);
        UpdateProgress(DateTime.Now + ": CA Population: " + App._context.PopulationDatas.Count(c => c.Country.Iso2Code == "CA") + "\n");

        data = await App._apiConnection.DoWorkAsync(_cancellation.Token, ApiInfo.GetCountryUriList("US"));
        App._apiConnection.Done(data);
        UpdateProgress(DateTime.Now + ": US Population: " + App._context.PopulationDatas.Count(c => c.Country.Iso2Code == "US") + "\n");

        data = await App._apiConnection.DoWorkAsync(_cancellation.Token, ApiInfo.GetCountryUriList("CN"));
        App._apiConnection.Done(data);
        UpdateProgress(DateTime.Now + ": CN Population: " + App._context.PopulationDatas.Count(c => c.Country.Iso2Code == "CN") + "\n");

        return true;
    }
    catch (OperationCanceledException)
    {
        MessageBox.Show("Operation Cancelled");
        return false;

    }
    catch (Exception ex)
    {
        MessageBox.Show("getDefaultData Exception: " + ex.Message);

        return false;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T16:41:05.297

您不*应该*能够按顺序下载图像。是的，它肯定会更容易开发，但它不会那么有效，因为您会长时间阻塞处理器，从而冻结您的应用程序。

> 我也考虑过 EventHandler 方法，但是在这种情况下我认为这不是一个好主意。如果我实现 EventHandler，它会不会像（伪代码）：

是的，它将遵循您所描述的一般模式。这是解决这个问题的适当方法。

# database - SQLAlchemy、PostgreSQL 和 SQLite 有什么区别？

> ID：13748111
> 
> 赞同：5
> 
> 时间：2012-12-06T16:30:57.757
> 
> 标签：database, heroku, web

我不太了解这三者之间的区别，我在 SQLAlchemy 中看到了 SQLite 和 PostgreSQL——它们也是 SQLAlchemy 的一部分。请澄清这些数据库系统可能共享或不共享的差异和关系。

另外，我正在 Heroku 上构建我的应用程序 - Heroku 是否支持所有这三个？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-06T16:35:25.337

PostgreSQL 和 SQLite 是两个关系数据库，SQLAlchemy 是一个[ORM](https://stackoverflow.com/questions/1279613/what-is-an-orm-and-where-can-i-learn-more-about-it)，它为您提供了一组用于访问数据库中数据的工具。

> SQLAlchemy 是 Python SQL 工具包和对象关系映射器，它为应用程序开发人员提供了 SQL 的全部功能和灵活性。
> 
> 它提供了一整套众所周知的企业级持久性模式，专为高效和高性能的数据库访问而设计，适用于简单的 Python 领域语言。

所以基本上 SQLAlchemy 为您提供访问 SQL 数据库（如 PostgreSQL 和 SQLite Mysql 等）的工具，并以 Python 方式查询它们。

互联网上有这个很好的链接，可以找出[PostgreSQL 和 SQLite 之间的区别](http://www.google.co.uk/search?q=postgresql%20vs%20sqlite)。

先安装PostgreSQL；然后开始我会看一下 SQLAlchemy 网站上的[教程](http://docs.sqlalchemy.org/en/latest/orm/tutorial.html)，它解释了你需要开始的所有术语。 [SQLAlchemy 教程](http://docs.sqlalchemy.org/en/latest/orm/tutorial.html)

这些简单地解释了如何连接到数据库、设置 SQLAlchemy 以及如何将所有内容组合在一起。

它还教您如何创建表、使用炼金术代码以及如何查询数据集。

# java - HashMap返回NULL时如何处理异常

> ID：13748113
> 
> 赞同：1
> 
> 时间：2012-12-06T16:30:59.530
> 
> 标签：java, nullpointerexception, hashmap

我有一个方法如下；它进行一些计算，然后返回一个 HashMap。

```
public Map<Integer, Animal> method() {
     // do some computation
     returns hashMap;
    } 
```

1.）如果哈希映射返回`null`，我会得到一个空指针异常吗？如果是这样我应该把它当作

```
public Map<Integer, Animal> method() throws{ 
```

这样调用方法会处理它吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T16:36:44.617

当您获得一个对象时，检查它是否为空...如果不打算使用空值，您可以指定它可能会抛出一个`NullPointerException`仅用于文档的对象，因为它是一个`RunTimeException`并且所有内容都`RuntimeExceptions`可以在任何地方出现。

您还可以执行以下操作：

```
try{
    /* calculate */
}
catch(NullPointerException e){
    /* process exception */
} 
```

在发生事件时进行处理`NullPointerException`，因此您可以恢复操作或关闭资源或引发更具描述性的异常......

例如：

```
try{
    Type o = (Type) map.get(key);
    o.doSomething();
}
catch(NullPointerException e)
{
    throw new RuntimeException("Null values are not accepted!", e);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T16:34:02.803

不，它不会给出空指针异常，因为您只是在返回`HashMap`. 在对返回的任何操作之前调用方法时，`HashMap`请确保检查返回的值不为空。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-06T16:35:32.913

`NullPointerException`当您尝试`.`在`null`变量上使用时会发生A。例如：

```
String s = null;
char c = s.charAt(0); // Tries to access null, throws NPE 
```

另一个`NullPointerException`可能发生的地方是当您尝试拆箱`null`包装器时：

```
Integer integer = null;
int i = integer; // Tries to unbox null, throws NPE 
```

这些是您获得`NullPointerException`. 好吧，除非有人明确抛出一个：

```
throw new NullPointerException(); 
```

但你*永远*不应该那样做。`IllegalArgumentException`改为抛出一个。

话虽如此，`null`从方法返回不会产生`NullPointerException`. 但是，在返回时使用该*方法*`.`的结果可以：*`null`*

 *```
Map<Integer, Animal> map = method();
map.get(20); // Throws NPE if method() returns null 
```

要解决此问题，请使用`null`-check：

```
Map<Integer, Animal> map = method();
if (map != null)
    map.get(20); // Never throws NPE 
```

请注意，我们仍然可以将`map`其用作*参考*，但我们无法*访问*它，因为它是`null`. 这就是您似乎缺少的区别。

**编辑您的评论**

> 所以你建议我应该保持`method()`原样（没有异常处理）并从调用函数中检查它？

这是一种可能的选择。另一个是抛出一个异常以表明它`null`不应该是。

最大的问题是，是否*允许*`null`？如果是，则保持`method()`原样，并检查是否`null`像我上面所说的那样调用它。在您的 Javadoc 注释中指出此方法可能会返回`null`。

如果*不允许*return `null`，则在调用该方法时，要么创建`Map`要么抛出异常。您甚至可以仅在它是`null`（这称为[延迟初始化](http://en.wikipedia.org/wiki/Lazy_initialization)）时创建地图：

```
public Map<Integer, Animal> method() {
    if (hashMap == null)
        hashMap = new HashMap<Integer, Animal>();
    return hashMap;
} 
```

如果您`hashMap`是在其他地方创建的，那么在其他地方创建它之前不应调用此方法（称为[precondition](http://en.wikipedia.org/wiki/Precondition)），那么您应该抛出异常。对于违反前提条件，我通常使用`IllegalStateException`：

```
public Map<Integer, Animal> method() {
    if (hashMap == null)
        throw new IllegalStateException("Must call otherMethod() to initialize hashMap before calling this method.");
    return hashMap;
} 
```*

# symfony - Symfony 2.1：如何将参数传递给自定义表单字段类型

> ID：13748116
> 
> 赞同：4
> 
> 时间：2012-12-06T16:31:04.623
> 
> 标签：symfony, symfony-2.1

我正在构建一个从“EntityType”扩展的自定义表单字段类型。我总是想根据传递的选项返回元素的子集。

在我的类型中：

```
$builder->add('Categories','choice_category', array('code'=> 'CAT1', 'multiple'=> true))   ; 
```

我已将choice_category 声明为服务。工作正常！

```
 bt.form.type.category:
  class: My\MBundle\Form\Type\CategoryType
  tags:
      - { name: form.type, alias: choice_category } 
```

在 CategoryChoiceType.php

```
public function setDefaultOptions(OptionsResolverInterface $resolver)
{

    $resolver->setDefaults(
        array(
            'class'=> 'CmComunBundle:Comun\Nomenclador',
            'code'          => null,                
        )
    );
}

public function getParent()
{
    return 'entity';
} 
```

我正在考虑使用 query_builder 选项，但我不知道如何将代码选项传递给 setDefaultOptions 方法，我在这里无法访问 $options 数组。

```
public function setDefaultOptions(OptionsResolverInterface $resolver)
{
        $resolver->setDefaults(
        array(
            'class'=> 'CmComunBundle:Comun\Nomenclador',
            'code'          => null,
            'query_builder' => function(\Doctrine\ORM\EntityRepository $er) use ($options['code']) {
               return $er->createQueryBuilder('c')
                    ->where('c.parent_code = :code')
                    ->orderBy('c.name', 'ASC')
                    ->setParameter('code', $options['code']);;
            }
        )
    );
); 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-09T15:40:43.573

您几乎做对了，但是您需要使用以下特殊语法使“query_builder”依赖于另一个选项“code”：

```
use Symfony\Component\OptionsResolver\Options;

$resolver->setDefaults(array(
    'query_builder' => function (Options $options) {
        // return default value of the "query_builder" option
        // you can access $options['code'] here
    },
)); 
```

所以在你的具体例子中：

```
public function setDefaultOptions(OptionsResolverInterface $resolver)
{
    $resolver->setDefaults(array(
        'class' => 'CmComunBundle:Comun\Nomenclador',
        'code' => null,
        'query_builder' => function (Options $options) {
            return function(EntityRepository $er) use ($options) {
                return $er->createQueryBuilder('c')
                    ->where('c.parent_code = :code')
                    ->orderBy('c.name', 'ASC')
                    ->setParameter('code', $options['code']);;
            };
        },
    ));
} 
```

这也记录在[OptionsResolver README](https://github.com/symfony/symfony/blob/master/src/Symfony/Component/OptionsResolver/README.md)中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-06T17:37:48.813

您可以通过依赖注入将`code`值传递给`__construct`并将其存储以供以后在`setDefaultOptions`方法中使用。

```
class CategoryType{
    ...
    private $code;
    ...
    public function __construct($code){
        $this->code = $code
    }
    ...
    public function setDefaultOptions(OptionsResolverInterface $resolver){
        $code = $this->code;
        $resolver->setDefaults(
        array(
            'class'=> 'CmComunBundle:Comun\Nomenclador',
            'code'          => null,
            'query_builder' => function(\Doctrine\ORM\EntityRepository $er) use ($code) {
                return $er->createQueryBuilder('c')
                                ->where('c.parent_code = :code')
                                ->orderBy('c.name', 'ASC')
                                ->setParameter('code', $code);
            })
        );
    );
} 
```

并在您的配置中：

```
bt.form.type.category:
    class: My\MBundle\Form\Type\CategoryType
    tags:
        arguments:
                - some_code_value
        - { name: form.type, alias: choice_category } 
```

现在，我还没有尝试过，但感觉它应该以这种方式工作；）

希望这可以帮助！

# eclipse - 成功的 JUnit 覆盖测试不会在测试异常的方法上变为绿色

> ID：13748119
> 
> 赞同：5
> 
> 时间：2012-12-06T16:31:07.617
> 
> 标签：eclipse, junit, sts-springsourcetoolsuite

我有一个小型 JUnit 测试，期望抛出异常。该方法按预期抛出异常，但是当我在 Eclipse SpringSource ToolSuite 中运行“Coverage As”时，测试方法中的两行保持红色而不是变为绿色。这个测试通过了——没有问题。

mockPropertyReader 是一个空的 Properties 文件阅读器类。如果属性格式错误或不存在，我只是在测试异常。

我只是在想方法行应该突出显示为绿色。我喜欢很多绿色。

```
@Test(expected = PropertyNotFoundException.class)
public final void testGetMySQLNotFound() throws PropertyNotFoundException {
    subject.setSqlProps(mockPropertyReader);
    subject.getMySQL();
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-06T16:39:15.253

这是 Emma 的一个已知问题。

[http://www.eclemma.org/faq.html#trouble05](http://www.eclemma.org/faq.html#trouble05)

# javascript - 在 Rails 中创建自定义 JS 数组/哈希

> ID：13748122
> 
> 赞同：0
> 
> 时间：2012-12-06T16:31:12.623
> 
> 标签：javascript, ruby-on-rails, ruby, json

我需要创建一个数组/哈希，然后通过数据标签将 Rails 中的数组/哈希传递到 Javascript。

Javascript 需要像这样格式化：

`[{x: 1333065600000, title: 'Title', text: 'Text'}, {x: 1333065600000, title: 'Title', text: 'Text'}]`

我在 Rails 中创建了一个辅助方法来创建这种类型的语法：

```
def flags
  @flags = '['
  @model.flags.each do |f|
    @flags += "{ x: 1333065600000, title: '#{f.title}', text: '#{f.text}'},"
  end
  @flags += ']'
end 
```

然后将数据传递给 Javascript，如下所示：

`<%= content_tag 'div', '', id: 'container', data: {flags: flags} %>`

HTML 源代码看起来是正确的，但是 's 是经过编码的。尽管如此，div 显示没有任何错误，但也没有任何标志。将确切的结果直接输入到 Javascript 中会正确显示标志。

我知道数据标签是自动 JSON 编码的，所以我也尝试使用标准的 HTML 数据标签和嵌套在其中的 ERB 标签，但遇到了同样的问题。

有谁知道问题可能是什么？任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T16:44:32.650

这是编写帮助程序的一种更简洁的方法，它返回数组而不是人为的 JSON 字符串。

```
def flags
  @flags = []
  @model.flags.each do |f|
    @flags << { x: 1333065600000, title: f.title, text: f.text }
  end
  @flags
end 
```

我不确定您要完成什么，因为

```
<div data-flags="[{&quot;x&quot;:1333065600000,&quot;title&quot;:&quot;some title&quot;,&quot;text&quot;:&quot;some text&quot;}]" id="container"></div> 
```

是预期的输出。您需要先解码`data-flags`属性，然后再将其解析为 JSON 编码字符串。

如果由于某种原因你想要单引号而不是双引号，你可以这样做

```
content_tag 'div', '', id: 'container', data: { flags: raw(x.to_json.gsub(/\"/, "'")) } 
```

这将产生

```
<div data-flags="[{'x':1333065600000,'title':'some title','text':'some text'}]" id="container"></div> 
```

我认为这就是你所追求的。

# java - 为什么 java 多态在我的示例中不起作用

> ID：13748124
> 
> 赞同：6
> 
> 时间：2012-12-06T16:31:15.950
> 
> 标签：java, polymorphism, subclass, superclass

我有这 4 个 java 类：1

```
public class Rect {
    double width;
    double height;
    String color;

    public Rect( ) {
        width=0;
        height=0;
        color="transparent";      
    }

    public Rect( double w,double h) {
        width=w;
        height=h;
        color="transparent";
    }

    double area()
    {
        return  width*height;
    } 
} 
```

2

```
public class PRect extends Rect{
    double depth;

    public PRect(double w, double h ,double d) {
        width=w;
        height=h;
        depth=d;
    }

    double area()
    {
        return  width*height*depth;
    }     
} 
```

3

```
public class CRect extends Rect{ 
    String color;

    public CRect(double w, double h ,String c) {
        width=w;
        height=h;
        color=c;
    }

    double area()
    {
        return  width*height;
    }     
} 
```

4

```
public class test {

    public test() { }

    public static void main(String[] args) {  
        Rect r1=new Rect(2,3);
        System.out.println("area of r1="+r1.area());

        PRect pr1=new PRect(2,3,4);
        System.out.println("area of pr1="+pr1.area());

        CRect cr1=new CRect(2,3,"RED");
        System.out.println("area of cr1="+cr1.area()+"  color = "+cr1.color);

        System.out.println("\n POLY_MORPHISM ");
        Rect r2=new Rect(1,2);
        System.out.println("area of r2="+r2.area());

        Rect pr2=new PRect(1,2,4);
        System.out.println("area of pr2="+pr2.area());

        Rect cr2=new CRect(1,2,"Blue");
        System.out.println("area of cr2="+cr2.area()+"  color = "+cr2.color); 

    }
} 
```

***我得到了输出：***

```
r1=6.0的面积
pr1的面积=24.0
cr1=6.0 颜色的面积 = RED
POLY_MORPHISM
r2=2.0 的面积
pr2的面积=8.0
cr2的面积=2.0 颜色=透明***

```

**为什么将 cr2 视为 Rect（超类）并具有“透明”颜色而不是具有“蓝色”颜色的 CRect（子类）？**

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-06T16:34:48.653

这是使用可见字段的问题之一——你最终会使用它们......

您在和`color`中都有一个字段。字段*不是*多态的，因此当您使用 时，即使用在 中声明的字段，该字段始终*设置*为。`Rect``CRect`*`cr2.color``Rect`*`"transparent"`**

 **您的`CRect`类不应该*有*自己的`color`字段 - 它应该为超类构造函数提供颜色。一个矩形有两个不同的`color`字段是没有意义的——它当然可以有`borderColor`，`fillColor`而且——但这`color`太模棱两可了……

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T16:37:32.710

`super()`您应该在子类的构造函数中包含显式调用：

```
public CRect(double w, double h ,String c) {
    super(w, h);
    width=w;
    height=h;
    color=c;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-06T16:40:55.203

`cr2.area()`将调用`CRect.area()`但`cr2.color`将使用该字段`Rect.color`。您应该使用函数样式 getArea() 并拥有`CRect.getColor() { return color; }`以及`Rect.getColor() { return color; }`**

# qunit - 在 Qunit 中跳过测试

> ID：13748129
> 
> 赞同：12
> 
> 时间：2012-12-06T16:31:27.277
> 
> 标签：qunit, jshint

我刚刚找到[qHint](http://blog.gyoshev.net/2011/04/enforcing-coding-conventions-with-jshint-and-qunit/)，一种将 jsHint 测试集成到 Qunit 中的方法......但它在本地（我不是指本地主机）中不起作用，除非在 Firefox 中。

所以我想添加一个“警告”或“通知”，而不是测试失败，表明测试被跳过：

```
// do unit test if not local or local and running Firefox
t = QUnit.isLocal;
if (!t || (t && /Firefox/.test(navigator.userAgent))) {
    jsHintTest('JSHint core check', 'js/myplugin.js');
} else {
    test('JSHint core check (skipped)', function(){
        ok( true, 'check not done locally' );
    });
} 
```

我只是想让测试被跳过的情况更加明显，这可能吗？

* * *

更新：感谢 Odi 的回答！但我必须稍作修改才能使代码在 QUnit v1.11.0pre 中工作：

```
QUnit.testSkip = function( testName, callback ) {
    QUnit.test(testName + ' (SKIPPED)', function() {
        if (typeof callback === "function") {
            callback();
        }
        var li = document.getElementById(QUnit.config.current.id);
        QUnit.done(function() {
            li.style.background = '#FFFF99';
        });
    });
};
testSkip = QUnit.testSkip; 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-06T19:47:37.277

我有同样的要求，我只是定义了一种`test()`我称之为`testSkip()`.

此测试方法只是替换您的测试函数并将名称更改为`<test name> (SKIPPED)`. 之后，QUnit 认为测试通过了。

为了进一步表明这是一个跳过的测试，我`QUnit.done`为每个跳过的测试添加了一个回调函数，以将 HTML 输出中的测试颜色更改为黄色。这些回调在测试套件完成时执行。直接设置该值不起作用，因为 QUnit 在运行结束时应用了通过/失败测试的样式。

```
QUnit.testSkip = function() {
   QUnit.test(arguments[0] + ' (SKIPPED)', function() {
       QUnit.expect(0);//dont expect any tests
       var li = document.getElementById(QUnit.config.current.id);
       QUnit.done(function() {
           li.style.background = '#FFFF99';
       });
   });
};
testSkip = QUnit.testSkip; 
```

然后，您可以使用`testSkip()`而不是`test()`跳过的测试。

对于我的测试套件，结果如下所示： ![QUnit 中跳过的测试](../Images/9ceb5dd55f37ffe492923bbe9a40288a.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-05-18T18:12:13.603

对于任何可能对评论感到茫然的人来说，Mottie 对这个问题的评论指出[Qunit 现在有一个`skip()`功能](https://api.qunitjs.com/QUnit.skip/)。只需将任何调用替换`test()`为`skip()`跳过该测试即可。

# java - restlet 日志中的列是什么意思？

> ID：13748135
> 
> 赞同：0
> 
> 时间：2012-12-06T16:31:36.510
> 
> 标签：java, logging, restlet

当我运行 Restlet 应用程序时，我在访问服务器时会看到一条日志消息。这是一个小示例（我添加了几个换行符，其中日志消息没有它们）：

```
Dec 6, 2012 9:16:54 AM org.restlet.engine.log.LogFilter afterHandle
INFO: 2012-12-06    09:16:54    127.0.0.1   -   -   41020   POST
/act/login  -   200 32  85  2   
http://127.0.0.1:41020  Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.95 Safari/537.11    
http://127.0.0.1:41020/ 
```

现在很明显，我能够识别其中的一些列。

第一个说是什么生成了日志消息，`LogFilter.afterHandle`但是试图通过它是非常神秘的，让我无处可去。

记录线：

*   显然它正在使用 SLF4J（由文档确认） INFO 日志记录级别
*   一些时间戳。
*   接下来我们有请求者的 IP 地址（我通过从第二台机器访问我的服务器确认了这一点）。
*   **然后是两个破折号，我不知道它们是什么。**
*   接下来是端口（41020）
*   接下来是协议方法，在本例中是 POST。
*   接下来是被击中的资源。
*   **然后是另一个破折号，我不知道它的含义。**
*   下面是 HTTP 响应代码。在示例中，我们得到`200 OK`.
*   接下来是**另外三个我无法识别的数字。**

我搜索了 Restlet 的文档，浏览了代码，并做了很多 Google 的搜索，但我的搜索仍然没有结果。

有人可以就这些破折号和幻数的含义提供一些见解吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-10T08:42:41.317

这和 Restlet 的 LogService 有关，它默认依赖于 JULI（java.util.logging 机制）。

在此处查看更多信息：[https ://restlet.talend.com/documentation/user-guide/2.4/core/services/log](https://restlet.talend.com/documentation/user-guide/2.4/core/services/log)

# java - 从 Java 调用 PHP 函数

> ID：13748137
> 
> 赞同：2
> 
> 时间：2012-12-06T16:31:39.103
> 
> 标签：java, php, php-java-bridge

> **可能重复：**
> [从 java 调用 php 方法](https://stackoverflow.com/questions/614894/invoking-a-php-method-from-java)

以前从未遇到过这种情况，所以想了解/知道该怎么做？

**目标：**从Java调用php函数

假设 Java 代码如下所示

```
pulic class Testing 
{

String userid;
String pass;
String url;
public static void main (String[] args )
{
   String value1 = checker ( userid, pass, url );
   String value2 = dataGetter ( value1 )
}

public static String checker ( String userid, String pass, String url);
{
  // Code to get authenticated 
}

public static String dataGetter ( value1 );
} 
```

PHP代码看起来像这样

```
 <?php
    $url;
    $size;

    function dataGetter( value1, $size)
    {
     // code to get data from server
    }
 ?> 
```

这可能吗？如果是这样，有人可以解释一下部署将如何工作吗？即 java 被部署在 tomcat 和 php 上 apache 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T16:44:29.463

[通过命令行](http://php.net/manual/en/features.commandline.php)或 http 使用 java.net.URL调用 PHP 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T16:43:31.873

虽然它们不能直接通信，但您可以让它们以与客户端浏览器与服务器通信相同的方式进行通信，也就是说，使用 ajax 和 javascript。通过 jsp 或 php 生成一个页面（不管哪个），通过 ajax 加载一个 php 页面或一个 jsp 页面（或 servlet）。结果是您想要的任何一种情况，通过这种方式，您可以从中获取信息。

或者，您可以创建一个 Java 程序，该程序打开到 php 页面的连接，并在您不想使用浏览器时使用返回的内容。

当然，我假设您处于一种奇怪的情况，您不能简单地放弃一种技术来使用另一种技术，否则我强烈建议您使用该解决方案。但是，正如这些事情通常发生的那样，如果您在项目中走得太远而无法立即退出，那么这也对您有用。

# jquery - IOS HTML5 - UI 滑块

> ID：13748142
> 
> 赞同：0
> 
> 时间：2012-12-06T16:31:46.783
> 
> 标签：jquery, ios, css, html

谁能推荐一个我可以在 HTML5 IOS 应用程序中使用的简单 jquery UI 滑块？

我需要在叠加层中显示一个滑块，我可以在提交时接收百分比数据。

干杯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T16:43:46.913

试试[jQuery UI 滑块](http://jqueryui.com/slider/)。该页面包含可用于显示百分比的示例

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T17:54:47.067

如果这是针对 HTML5 iOS 应用程序 (webkit)，您可以使用：

```
<input type="range"> 
```

# r - Arules 包--Trio 错误

> ID：13748149
> 
> 赞同：0
> 
> 时间：2012-12-06T16:32:10.490
> 
> 标签：r, arules

我正在使用 4547 x 5415 的大型二进制数据矩阵进行关联规则挖掘。通常，每一行都是一个事务，每一列都是一个项目。每当我调用 arules 包时，它都会产生一些引用 trio 库的神秘错误消息。有没有人遇到过这种类型的错误？

```
i[1:10,1:10]
     101402 101403 101404 101405 101406 101411 101412 101413 101414 101415
 [1,]      0      0      0      1      0      0      1      0      0      0
 [2,]      0      1      0      0      0      0      1      0      0      0
 [3,]      0      0      0      0      0      0      1      0      0      0
 [4,]      0      0      0      1      0      0      0      0      0      1
 [5,]      0      0      0      1      0      0      0      0      0      1
 [6,]      0      1      0      0      0      1      0      0      0      0
 [7,]      0      0      0      0      0      0      1      0      0      0
 [8,]      0      0      1      0      0      0      0      0      0      1
 [9,]      0      0      0      0      0      1      0      0      0      0
[10,]      0      0      0      0      1      0      1      0      0      0

rules <- apriori(i, parameter=list(support=0.001, confidence=0.5))

    parameter specification:
     confidence minval smax arem  aval originalSupport support minlen maxlen target
            0.5    0.1    1 none FALSE            TRUE   0.001      1     10  rules
       ext
     FALSE

    algorithmic control:
     filter tree heap memopt load sort verbose
        0.1 TRUE TRUE  FALSE TRUE    2    TRUE

    apriori - find association rules with the apriori algorithm
    version 4.21 (2004.05.09)        (c) 1996-2004   Christian Borgelt
    set item appearances ...[0 item(s)] done [0.00s].
    set transactions ...[5415 item(s), 4547 transaction(s)] done [0.47s].
    sorting and recoding items ... [4908 item(s)] done [0.18s].
    creating transaction tree ... done [0.01s].
    **checking subsets of size 1 2Error in apriori(i, parameter = list(support = 0.001, confidence = 0.5)) : 
      internal error in trio library** 
```

可重现的例子：

```
y <- matrix(nrow=4547, ncol=5415)
y <- apply(y, c(1,2), function(x) sample(c(0,1),1))
rules <- apriori(y, parameter=list(support=0.001, confidence=0.5)) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-07-09T14:08:01.640

问题是arules 包中的错误处理存在错误。您的内存不足，当 apriori 代码尝试创建适当的错误消息时，它会创建对 printf 的无效调用，该调用由 trio 库在 Windows 下处理。所以简而言之，你应该得到一个内存不足的错误。

此问题将在 arules 版本 1.1-4 中得到解决。

为了避免内存不足，您需要增加支持和/或限制项目集中的项目数量（参数列表中的 maxlen）

-迈克尔

# ruby - 为什么 foo 不再是 nil - 或者函数中的函数

> ID：13748152
> 
> 赞同：11
> 
> 时间：2012-12-06T16:32:29.607
> 
> 标签：ruby

为什么在下面的代码片段中 foo 替换了它的定义？

```
def foo
  def foo
    1
  end
end 
```

* * *

第一次`foo`是零

```
foo
=> nil

foo.foo
=> 1 
```

现在，如果我`foo`再打电话：

```
foo
=> 1 
```

如您所见`foo`，不再是 nil 了。谁可以给我解释一下这个？谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-06T16:35:31.867

```
def foo
  p "about to redef foo"
  def foo
    1
  end
end 
```

```
foo
"about to redef foo"
=> nil
foo
=> 1 
```

此外，当您调用 时`foo.foo`，似乎您正在尝试访问内部`foo`方法，但它不起作用。您的`foo`方法实际上是在 上定义的`Object`，因此您实际上是在调用`1.foo`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T16:49:12.993

如果你想要这个效果，试试

```
def foo
  foo = proc {
    1
  }
end 
```

由于`def`方法不会创建新的`self`. 每个方法都绑定到`self`，`main`在本例中是一个 Object.new ，它为 ruby​​ 解释器加载的每个文件实例化。在一个类里面，`self`就是类，你得到实例方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-06T16:49:36.290

方法定义在读取时被解析，但在调用之前不会执行。当您执行第一个`foo`时，执行最外层`foo`，其定义`Object#foo`为

```
def foo
  1
end 
```

并`nil`作为定义该方法的操作的返回值返回。从此，当你调用 时`foo`，新定义`foo`的会被执行，返回

```
1 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-06T16:39:03.833

当你第一次调用`foo`它返回方法`foo`，当你再次调用`foo`它返回 1。阅读[闭包](http://en.wikipedia.org/wiki/Closure_%28computer_science%29)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-07T09:35:22.583

ruby 中的嵌套方法定义令人困惑。

它们实际上是重新定义！

发生的情况是这两个定义都适用于最外层的上下文。那就是两个定义都定义了相同的（！）方法 foo。虽然外部定义在读取文件时被解释，而内部定义仅在第一次调用外部方法时被解释。然后它将替换初始定义。

鉴于此代码

```
def foo
  def foo
    1
  end
end 
```

让我们来看看：

1.  加载文件时`foo`，使用 body 定义了一个全局方法`def foo; 1; end`。
2.  当您调用`foo()`此全局方法时，将执行并使用 body**重新定义全局方法** ，并返回，因为定义方法没有返回值。`foo``1``nil`

3.  当您调用`foo().foo()`全局方法并返回时，再次`1`执行全局方法，再次返回`1`。

令人困惑的是两件事，a）嵌套方法定义都适用于相同的外部范围，b）可以在任何对象上调用全局方法。

这是另一个示例来演示嵌套定义实际上是如何重新定义的。

```
class A
  def m(arg=nil)
    def m; 42; end if arg
    23
  end
end 
```

这就是发生的事情

```
a = A.new
a.m # => 23
a.m # => 23
a.m(:magic) # => 23
a.m # => 42
a.m # => 42 
```

如您所见，嵌套定义实际上是重新定义。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-09T17:39:44.283

就我个人而言，我一直认为它`def`在类上定义了 inner 很奇怪。我认为在单例上定义它更明智。例如等效于`def self.foo`，因为它是在实例级别而不是类级别调用的。

要么，要么它只能从它定义的方法中调用——尽管这可能没有那么有用，因为我们有 lambdas。

有一件事是肯定的，你几乎不会在实践中看到这一点。

# java - Java StringBuilder 在追加调用之间删除新行？

> ID：13748157
> 
> 赞同：2
> 
> 时间：2012-12-06T16:32:49.587
> 
> 标签：java, append, stringbuilder

是否可以将 Java`StringBuilder`类配置为在每次调用 append 之间附加一个新行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T16:35:01.663

我认为没有`StringBuilder`内置该功能。既然你不能只是扩展它，你可以尝试使用装饰器模式......

```
class NewlineStringBuilder {

    private StringBuilder delegate;

    public NewlineStringBuilder() {
        delegate = new StringBuilder();
    }

    public NewlineStringBuilder appendLine(String str) {
        delegate.append(str).append("\n");
        return this;
    }

    public String toString() {
        return delegate.toString();
    }
} 
```

或者，Java 可以支持这种简写，这很有用，因为装饰器不需要重新实现需要从装饰类中获得的所有方法，但是它更危险，因为原始资源完全未公开，因此需要权衡取舍必须称重：

```
StringBuilder message = new StringBuilder();
class AppendingStringBuilder {
    private final StringBuilder builder;
    AppendingStringBuilder(StringBuilder builder) {
        this.builder = builder;
    }
    public AppendingStringBuilder append(String str) {
        builder.append(str + "\n");
        return this;
    }
}
AppendingStringBuilder messageHelper;
// ... 
```

# c++ - QML ListView 计数为零，只有一些行可见

> ID：13748161
> 
> 赞同：1
> 
> 时间：2012-12-06T16:33:09.017
> 
> 标签：c++, qt, listview, symbian, qml

我创建了一个基于 QAbstractListModel 的 ListView 模型，类似于此[示例](http://doc.qt.digia.com/4.7-snapshot/declarative-modelviews-abstractitemmodel.html)。问题是我的 ListView 不显示所有行，而只显示那些最初可见的行。所以当我向下滚动（或轻弹）时，只有黑色空间。ListView 有 count == 0 但它应该有 count == 10，因为我添加了 10 个元素。

我的课程包含更新模型 rowCount 的必要方法

```
// needed as implementation of virtual method
int rowCount(const QModelIndex & parent) const {
    return standings.size();
}
int rowCount() {
    return standings.size();
}

void addStanding(const Standing &st) {
    beginInsertRows(QModelIndex(), rowCount(), rowCount());
    qDebug() << "row cnt: " << rowCount();
    standings << st;
    endInsertRows();
} 
```

我还更新了 ListView 模型

```
rootContext = (QDeclarativeContext*)(viewer->rootContext());
rootContext->setContextProperty("myModel", &sm); 
```

QML 代码

```
ListView {
            id: raceList
            objectName: "standingList"
            y: header.height
            width: parent.width
            height: parent.height - header.height
            clip: true
            model: myModel
            delegate: rowComp
        }
        Component {
            id: rowComp
            SessionRowDelegate { }
        } 
```

我还想提一下，这适用于静态模型。 **如何让 ListView 一直显示所有项目，而不仅仅是对用户可见？**

SessionRowDelegate

```
Rectangle {
  id: rowbg
  width: parent.width
  height: 34 * (1 + (parent.width - 360) * 0.002)

  // contains other elements with height not exceeding rowbg's height
  // ...
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-04-04T08:39:28.320

有点晚了（4 年！），但是在卡住了几天之后，我发现了与这个问题相关的一些东西！问题主要基于 ListView 处理模型的奇怪方式。

在我自己的模型中覆盖 rowCount 方法后，我遇到了您提到的确切问题。有趣的是，他们从来没有被叫过。ListView 实际上从不调用获取 rowCount，而是查询 cacheBuffer 大小的数量（在我的系统上默认为 512），这就是为什么它不会注意到项目是否超过 cacheBuffer 大小或它使用的默认值，它只注意到当它滚动到最后。

* * *

虽然这将阐明其他一些人的问题，但它不是您问题的解决方案。在您的情况下，如果项目不是那么多，我建议调整 ListView cacheBuffer 大小，并根据需要增加它。请记住，如果您的元素数量众多，则可能会造成巨大的性能损失。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-19T17:29:52.243

ListView 仅呈现当前可见的元素以及一些在滚动时预先呈现以显示的元素。出于性能原因，默认实现不会呈现所有这些。任何对列表大小的引用都应该引用模型对象而不是 ListView 本身。

# python - Django会话竞争条件？

> ID：13748166
> 
> 赞同：7
> 
> 时间：2012-12-06T16:33:23.693
> 
> 标签：python, django, multithreading, session, race-condition

**摘要：Django 会话中是否存在竞争条件，我该如何防止它？**

我对 Django 会话有一个有趣的问题，我认为这涉及由于同一用户的同时请求而导致的竞争条件。

它发生在一个同时上传多个文件的脚本中，正在本地主机上进行测试。我认为这使得来自同一用户的同时请求很可能（由于本地主机的响应时间低，由于文件上传导致的长请求）。不过，本地主机之外的正常请求仍然是可能的，只是可能性较小。

我正在发送几个我认为这样做的（文件发布）请求：

1.  Django 自动检索用户的会话*
2.  *需要一些时间的无关代码*
3.  获取`request.session['files']`（字典）
4.  将有关当前文件的数据附加到字典
5.  `request.session['files']`再次存储字典
6.  检查它是否确实已存储
7.  *更多不相关的代码需要时间*
8.  *Django 自动存储用户的会话*

此处 6\. 处的检查将表明信息确实已存储在会话中。但是，未来的请求表明有时它有，有时它没有。

我认为正在发生的是其中两个请求（A 和 B）同时发生。请求 A`request.session['files']`首先检索，然后 B 执行相同操作，更改并存储它。当 A 最终完成时，它会覆盖 B 的会话更改。

两个问题：

1.  这真的是正在发生的事情吗？django开发服务器是多线程的吗？在谷歌上，我正在寻找关于使其成为多线程的页面，这表明默认情况下它不是？否则，可能是什么问题？
2.  如果这种竞争条件是问题所在，解决它的最佳方法是什么？这是一个不便，但不是安全问题，所以如果机会可以显着减少，我已经很高兴了。

我认为在更改之前检索会话数据并在之后立即保存应该会显着降低机会。但是我还没有找到一种方法来解决这个问题`request.session`，只能使用`django.contrib.sessions.backends.db.SessionStore`. 但是我认为如果我以这种方式更改它，Django 只会`request.session`在请求结束时覆盖它。

所以我需要一个`request.session.reload()`and `request.session.commit()`，基本上。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-18T01:19:44.437

1.  是的，一个请求可以在另一个请求完成之前开始。您可以通过在视图的开头和结尾打印一些内容并同时启动一堆请求来检查这一点。

2.  实际上，会话在视图之前加载并在视图之后保存。您可以使用重新加载会话`request.session = engine.SessionStore(session_key)`并使用`request.session.save()`.

但是，重新加载会话会丢弃之前添加到会话中的任何数据（在视图中或之前）。在重新加载之前保存会破坏延迟加载的点。更好的方法是将文件作为新模型保存到数据库中。

*答案的本质是在讨论托马斯的答案，这是不完整的，所以我发布了完整的答案。*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-10T10:16:10.563

马克刚刚搞定，我只有一点点补充，就是如何加载该会话：

```
for key in session.keys():  # if you have potential removals
    del session[key]
session.update(session.load())
session.modified = False  # just making it clean 
```

第一行可选，仅当某些值可能同时从会话中删除时才需要它。

最后一行是可选的，如果您更新会话，那么它并不重要。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-06T16:49:18.480

那是真实的。您可以通过查看[`django.contrib.sessions.middleware.SessionMiddleware`](https://github.com/django/django/blob/master/django/contrib/sessions/middleware.py).

基本上，在点击您的视图（in ）`request.session`之前加载，并在离开您的视图（in ）后在会话后端（如果需要）中更新。`request`[`process_request`](https://github.com/django/django/blob/master/django/contrib/sessions/middleware.py#L9)`response`[`process_response`](https://github.com/django/django/blob/master/django/contrib/sessions/middleware.py#L14)

如果我的意思不清楚，您可能想查看[Middleware 的 django 文档](https://docs.djangoproject.com/en/dev/topics/http/middleware/?from=olddocs)。

* * *

解决问题的最佳方法将取决于您尝试使用该信息实现的目标。如果您提供该信息，我将更新我的答案！

# emacs - 唯一标识一个窗口

> ID：13748183
> 
> 赞同：1
> 
> 时间：2012-12-06T16:34:06.727
> 
> 标签：emacs

是否可以在 Emacs 中唯一标识一个窗口？

`window-number-mode`当向框架添加新窗口时，生成的 ID 会发生变化。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-07T04:11:45.190

您需要阅读 Elisp 手册中的 windows。窗口可以通过函数返回的对象来识别，例如`selected-window`, `next-window`,`get-buffer-window`等...

# ios - 验证 iOS 屏幕是否存在用户错误

> ID：13748184
> 
> 赞同：0
> 
> 时间：2012-12-06T16:34:06.943
> 
> 标签：ios, web-services, core-data, crash

我为 iPad 开发了一个 iOS 企业应用程序。当它启动时，它会连接到 Web 服务，获取一些数据，并将其存储在 Core Data 中。然后下一个屏幕使用这些数据并执行所需的操作，例如填充`UITextFields`、`drop downs`向用户显示 a`UIAlertView`等。基本上我使用数据、操作它并保存它。

考虑一下：我现在早上安装应用程序，我立即使用它，然后我单击 iPad 上的主页按钮并将其放置几个小时。然后我启动应用程序，它在崩溃并返回 iPad 主菜单之前显示黑屏。

为什么会这样崩溃？有任何想法吗？

如果您需要更多信息，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T16:39:03.867

您需要检查日志是否有错误。

将您的设备插入计算机并打开 Xcode/Organizer/Devices/Device Logs

# windows - 如何查找文件是否在 Windows 的文件系统缓存中？

> ID：13748186
> 
> 赞同：3
> 
> 时间：2012-12-06T16:34:16.223
> 
> 标签：windows, operating-system, filesystems

我猜`NTFS`（的文件系统`Windows`）有一些缓存。假设我有一个经常访问的文件（只读）。如何检查此文件是否在文件系统缓存中？我可以增加文件系统缓存大小吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-05-28T09:17:18.780

查看

[http://blogs.technet.com/b/askperf/archive/2010/08/13/introduction-to-the-new-sysinternals-tool-rammap.aspx](http://blogs.technet.com/b/askperf/archive/2010/08/13/introduction-to-the-new-sysinternals-tool-rammap.aspx)

您可以使用[RamMap](http://technet.microsoft.com/en-us/sysinternals/ff700229.aspx)，它将为您提供当前系统如何缓存文件的专用视图。

还要提一下，缓存不是基于文件，而是基于块/页。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T06:08:51.247

用户空间没有直接的方法来检测文件是否已被缓存（部分或全部）。在多线程/多处理环境中，一旦您收到此信息，它就会立即过时。

Windows 中的缓存没有“限制”可以调整（尽管我的数据是 Windows 7 和以前的版本）。缓存管理器只是使用内存管理器将数据放入内存并在需要回收物理内存时（例如，根据应用程序的要求）获得回调。内存管理器在文件缓存与进程的内存需求之间进行权衡。

# java - 需要帮助从数组中检索最大索引

> ID：13748189
> 
> 赞同：0
> 
> 时间：2012-12-06T16:34:30.813
> 
> 标签：java

我被卡住了......我的代码之前工作过，但现在它只是挂起。最重要的是，我似乎无法让我的`getHighest`和`getSmallest`方法返回正确的值。我不知道我是不是没有抓到什么东西。任何帮助都会很棒！

```
import java.util.Scanner;
import java.text.DecimalFormat;

public class Rainfall
{
  public static void main(String[] args)
  {
    final int MONTHS = 12;
    double[] rain = new double[MONTHS];
    initRain(rain);
    double total = totalRain(rain);
    double average = averageRain(rain, total);
    double most = mostRain(rain);
    double least = leastRain(rain);
    DecimalFormat digit = new DecimalFormat("#.0");
    System.out.println("The total rainfall of the year is " + digit.format(total));
    System.out.println("The average rainfall of the year is " + digit.format(average));
    System.out.println("The month with the highest amount of rain is " + most);
    System.out.println("The month with the lowest amount of rain is " + least);
  }
  public static void initRain(double[] array)
  {
    Scanner keyboard = new Scanner(System.in);
    for (int x = 0; x < array.length; x++)
    {  
      System.out.print("Enter Rainfall for month " + (x + 1) + ": ");
      array[x] = keyboard.nextDouble();
    }
  }
  public static double totalRain(double[] array)
  {
    double total = 0;
    for (int x = 0; x < 12; x++)
      total += array[x];
    return total;
  }
  public static double averageRain(double[] array, double total)
  {
    return total / array.length;
  }
  public static double mostRain(double[] array)
  {;
    double maximum = array[1];
    int value = 0;
    for (int i=0; i < 12; i = i++)
    {
      if (array[i] >= maximum)
        maximum = array[i];
        value = i;
      }
    return value;
  }
  public static double leastRain(double[] array)
  {
    double minimum = array[0];
    int value;
    for (int i=0; i < 12; i++)
    {
      if (array[i] <= minimum) 
        minimum = array[i];
        value = i;
      }
    return value;
  }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T16:54:05.480

您的程序因为这一行而挂起：

```
for (int i=0; i < 12; i = i++) 
```

问题是***在变量递增之前***`i++`返回的值，所以循环的递增步骤与写入相同。因此，变量永远不会达到循环的转义条件。`i` *`i=i``i`*

 *它应该是：

```
for (int i=0; i < 12; i++) 
```

稍微清理一下你的代码，可以改进很多。有很多简单的错误。

```
import java.util.Scanner;
import java.text.DecimalFormat;

public class Rainfall
{
  public static void main(String[] args)
  {
    final int MONTHS = 12;
    double[] rain = new double[MONTHS];
    initRain(rain);
    double total = totalRain(rain);
    double average = averageRain(rain, total);
    int most = mostRain(rain);
    int least = leastRain(rain);
    DecimalFormat digit = new DecimalFormat("#.0");
    System.out.println("The total rainfall of the year is " + digit.format(total));
    System.out.println("The average rainfall of the year is " + digit.format(average));
    System.out.println("The month with the highest amount of rain is " + (most + 1));
    System.out.println("The month with the lowest amount of rain is " + (least + 1));
  }
  public static void initRain(double[] array)
  {
    Scanner keyboard = new Scanner(System.in);
    for (int x = 0; x < array.length; x++)
    {
      System.out.print("Enter Rainfall for month " + (x + 1) + ": ");
      array[x] = keyboard.nextDouble();
    }
  }
  public static double totalRain(double[] array)
  {
    double total = 0;
    for (int x = 0; x < 12; x++)
      total += array[x];
    return total;
  }
  public static double averageRain(double[] array, double total)
  {
    return total / array.length;
  }
  public static int mostRain(double[] array)
  {
    double maximum = array[1];
    int value = 0;
    for (int i=0; i < 12; i++) {
      if (array[i] >= maximum) {
        maximum = array[i];
        value = i;
      }
    }
    return value;
  }
  public static int leastRain(double[] array)
  {
    double minimum = array[0];
    int value = 0;
    for (int i=0; i < 12; i++)
    {
      if (array[i] <= minimum) {
        minimum = array[i];
        value = i;
      }
    }
    return value;
  }
} 
```*

# perl - 如何将 Perl 调试器输出限制为我自己脚本中的行？

> ID：13748196
> 
> 赞同：3
> 
> 时间：2012-12-06T16:34:49.200
> 
> 标签：perl

我在非交互模式下运行调试器，并将输出写入文件。我想在执行时打印出我的 Perl 脚本的每一行，但只打印脚本本身中的行。我不想看到脚本调用的库代码（File::Basename、Exporter::import 等）。这似乎是一种应该很容易做到的事情，但是[perldebug](http://perldoc.perl.org/perldebug.html#Configurable-Options)的文档只讨论了限制转储结构的深度。我想要的有可能吗？如果有，怎么做？

请注意，我正在执行我的程序，如下所示：

```
PERLDB_OPTS="LineInfo=temp.txt NonStop=1 AutoTrace=1 frame=2" perl -dS myprog.pl arg0 arg1 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-06T17:57:01.107

默认情况下，[`Devel::DumpTrace`](http://search.cpan.org/perldoc?Devel::DumpTrace)不会进入系统模块，您可以对调试器将进入的模块进行精细控制（这并不容易，但有可能）。就像是

```
DUMPTRACE_FH=temp.txt perl -d:DumpTrace=quiet myprog.pl 
```

将类似于您显然正在尝试做的事情。

`Devel::DumpTrace`还在每一行上做更多的处理——找出变量值并将它们包含在输出中——所以它可能是矫枉过正并且运行速度比`perl -dS ...`

（Crikey，这是本周的两个插头！[）](https://stackoverflow.com/questions/13730315/unix-shells-x-option-in-perl/13730425#13730425)`Devel::DumpTrace`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T16:39:19.407

您是在谈论不想单步执行您自己程序之外的功能吗？为此，您想使用`n`而不是`s`.

来自`perldebug`：

```
 s [expr]    Single step.  Executes until the beginning of another
               statement, descending into subroutine calls.  If an
               expression is supplied that includes function calls, it too
               will be single‐stepped.

   n [expr]    Next.  Executes over subroutine calls, until the beginning
               of the next statement.  If an expression is supplied that
               includes function calls, those functions will be executed
               with stops before each statement. 
```

# android - 为什么我无法将 XML 布局文件连接到 Android 中的源代码？

> ID：13748199
> 
> 赞同：0
> 
> 时间：2012-12-06T16:35:00.853
> 
> 标签：android, xml, android-layout

我开始学习Android开发并且不能执行简单的事情。我有一个 activity_login.xml，它定义了几个小部件（TextViews、按钮等），我想以编程方式更改 textview 的大小。我正在尝试使用 R.id，但 Eclipse 看不到我的文本视图。这是我尝试过的。res/layout/activity_login.xml 文件中的 TextView：

```
<TextView
    android:id="@+id/login_text_view"
    android:layout_width="23"
    android:layout_height="wrap_content"
    android:layout_alignLeft="@+id/button_log"
    android:layout_alignParentTop="true"
    android:layout_alignRight="@+id/button_sign_up"
    android:layout_marginTop="34dp"
    /> 
```

在这里，我试图在我的`LoginActivity.java`：

```
final TextView loginTextView = (TextView) findViewById(R.id.login_text_view); 
```

问题 Eclipse`loginTextView`在 xml 文件中既看不到也看不到其他小部件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T16:40:12.173

在您的活动中，确保您将布局设置为`onCreate()`使用`setContentView(R.layout.activity_login)`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T16:41:31.487

在`onCreate()`

`setContentView(activity_login.xml)`

[如果您还没有去过那里，这个链接](http://developer.android.com/reference/android/app/Activity.html)是一个很好的起点。它描述了 Android 生命周期，并在开始时提供了指向其他 Android 资源的链接

# jsf - 如何为所有 UIInputs 注册一个（组件）SystemEventListener

> ID：13748202
> 
> 赞同：5
> 
> 时间：2012-12-06T16:35:07.500
> 
> 标签：jsf, annotations, faces-config, systemeventlistener

我正在尝试有一个`SystemEventListener`注册所有类型实例`UIInput`并对其`postValidate`-Events做出反应的自定义。根据我在网上找到的一个示例，我设法通过以下`HtmlInputText`方式注册它来运行它`faces-config.xml`：

```
<system-event-listener>
   <source-class>javax.faces.component.html.HtmlInputText</source-class>
   <system-event-class>javax.faces.event.PostValidateEvent</system-event-class>
   <system-event-listener-class>com.ourcompany.ourproduct.validators.inputPostValidationListener</system-event-listener-class>
 </system-event-listener> 
```

然后我尝试 1) 将其扩展为一般适用于 UIInputs 和 2) 使用`@ListenerFor`注释，但我似乎无法让其中任何一个工作。

对于 1) 我真的找不到任何示例或文档，所以我只是尝试通过 a) 定义多个源类标签或 b) 使用`javax.faces.component.UIInput`源类。都没有奏效。

2）我试过

```
@ListenerFor(systemEventClass = PostValidateEvent.class, sourceClass = UIInput.class) 
```

它既不适用于 UIInput 也不适用于 html.HtmlInputText。

现在，当我为所有其他类型的 HTML 输入复制相同的 XML 配置时，这可以解决问题，但它只会使 xml 变得混乱，而且对我来说似乎很烦人。

所以问题是：我通常对 @ListenerFor 注释做错了吗？对哪些源类可能存在限制，即为什么我不能使用更通用的 UIInput？有没有比重复 XML 更有效的方法来为所有这些不同的输入注册侦听器？最后：我宁愿实施`ComponentSystemEventListener`. 假设上述问题已解决，我只需更改`implements`-Statement 并`processEvent`相应地实现摘要，对吗？在这种情况下，这会一样工作还是registration/xml-config不同（例如，可能`<component-system-event-listener>`不仅仅是`<system-event-listener>`？

（并且作为事后说明：只是我，还是很难在网络上找到此类东西的任何重要示例？）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T16:48:06.423

`@ListenerFor`应该在`UIComponent`or实现上设置，而`Renderer`不是在独立`SystemEventListener`实现上设置。另见[javadoc](http://docs.oracle.com/javaee/6/api/javax/faces/event/ListenerFor.html)（重点是我的）：

> **默认实现必须支持将此注释附加到`UIComponent`或`Renderer`类。**在这两种情况下，此处描述的注释处理必须在 的任何变体的实现期间开始，`Application.createComponent()`并且必须在`UIComponent`实例从`createComponent()`. 注释处理必须根据语义上等效于以下的算法进行。
> 
> ...

为了拥有一个全局侦听器，而不是特定于`UIComponent`or `Renderer`，最好的办法是创建和注册一个`PhaseListener`将侦听器订阅到视图根的 a 。

```
public class PostValidateListener implements PhaseListener {

    @Override
    public PhaseId getPhaseId() {
        return PhaseId.PROCESS_VALIDATIONS;
    }

    @Override
    public void beforePhase(PhaseEvent event) {
        event.getFacesContext().getViewRoot()
            .subscribeToViewEvent(PostValidateEvent.class, new InputPostValidationListener()); // Capitalize class name?
    }

    @Override
    public void afterPhase(PhaseEvent event) {
        // NOOP.
    }

} 
```

要让它运行，请在 faces-config.xml 中按如下方式注册它：

```
<lifecycle>
    <phase-listener>com.example.PostValidateListener</phase-listener>
</lifecycle> 
```

你甚至可以让`InputPostValidationListener`自己成为一个`PhaseListener`.

```
public class InputPostValidationListener implements PhaseListener, SystemEventListener {

    @Override
    public void beforePhase(PhaseEvent event) {
        event.getFacesContext().getViewRoot().subscribeToViewEvent(PostValidateEvent.class, this);
    }

    // ...
} 
```

# java - 在 Java 中复制数据的更快方法？

> ID：13748205
> 
> 赞同：3
> 
> 时间：2012-12-06T16:35:13.413
> 
> 标签：java, performance, file-io, copy, bufferedinputstream

我的任务是从服务器复制数据。我正在使用`BufferedInputStream`和输出流来复制数据，并且我正在逐字节进行。即使它正在运行，但复制数据需要很长时间，因为其中一些数据是 100 的 MB，所以它肯定行不通。谁能建议我逐字节复制的任何替代方案，以便我的代码可以复制几百 MB 的文件。缓冲区为 2048。

这是我的代码的样子：

```
static void copyFiles(SmbFile[] files, String parent) throws IOException {

  SmbFileInputStream input = null;
  FileOutputStream output = null;
  BufferedInputStream buf_input = null;
  try {
    for (SmbFile f : files) {
      System.out.println("Working on files :" + f.getName());
      if (f.isDirectory()) {

        File folderToBeCreated = new File(parent+f.getName());
        if (!folderToBeCreated.exists()) {
          folderToBeCreated.mkdir();
          System.out.println("Folder name " + parent
                + f.getName() + "has been created");
        } else {
          System.out.println("exists");

        }

        copyFiles(f.listFiles(), parent +  f.getName());
      } else {

        input = (SmbFileInputStream) f.getInputStream();

        buf_input = new BufferedInputStream(input, BUFFER);

        File t = new File(parent + f.getName());
        if (!t.exists()) {
          t.createNewFile();
        }
        output = new FileOutputStream(t);

        int c;

        int count;
        byte data[] = new byte[BUFFER];

        while ((count = buf_input.read(data, 0, BUFFER)) != -1) {
          output.write(data, 0, count);
        }
      }
    }
  } catch (IOException e) {
    e.printStackTrace();

  } finally {
    if (input != null) {
      input.close();
    }
    if (output != null) {
      output.close();
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-06T16:39:43.903

这是[一篇精彩文章的链接，该文章](http://thomaswabner.wordpress.com/2007/10/09/fast-stream-copy-using-javanio-channels/)解释了如何使用`nio`通道来制作流的副本。它引入了一个帮助方法`ChannelTools.fastChannelCopy`，让您可以像这样复制流：

```
final InputStream input = new FileInputStream(inputFile);
final OutputStream output = new FileOutputStream(outputFile);
final ReadableByteChannel inputChannel = Channels.newChannel(input);
final WriteableByteChannel outputChannel = Channels.newChannel(output);
ChannelTools.fastChannelCopy(inputChannel, outputChannel);
inputChannel.close();
outputChannel.close() 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-06T16:39:18.113

好吧，因为您使用的是 a `BufferedInputStream`，所以您不是逐字节读取，而是缓冲区的大小。您可以尝试增加缓冲区大小。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-06T16:40:23.157

逐字节读/写肯定会很慢，即使实际读/写是由缓冲区大小的块完成的。加速它的一种方法是按块读取/写入。看看`read(byte[] b, int off, int len)`方法`BufferedInputStream`。然而，它可能不会给你足够的改进。

更好的是使用`nio`包（新IO）使用nio通道复制数据。查看[nio 文档](http://docs.oracle.com/javase/6/docs/api/java/nio/package-summary.html)以获取更多信息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-06T16:50:36.777

我建议使用`FileUtils`from `org.apache.commons.io`。它有足够的实用方法来执行文件操作。

[org.apache.commons.io.FileUtils API 在这里](http://commons.apache.org/io/api-release/index.html)

# c++ - Visual Studio 2012 Natvis 跳过 IndexListItems

> ID：13748209
> 
> 赞同：49
> 
> 时间：2012-12-06T16:35:30.720
> 
> 标签：c++, qt, visual-studio-2012

我正在为 Qt 类创建一个 natvis 文件，但遇到了问题。

为了可视化 QHash 对象，我创建了这两种类型：

```
<Type Name="QHashNode&lt;*,*&gt;">
    <DisplayString Condition="next->next == 0">{{ key={key} value={value} h={h}}}</DisplayString>
    <DisplayString>{{ key={key} value={value} h={h} withCollision }}</DisplayString>
    <Expand>
        <Item Name="NextNode">reinterpret_cast&lt;QHashNode&lt;$T1,$T2&gt; *&gt;(next)</Item>
    </Expand>
</Type>

<Type Name="QHash&lt;*,*&gt;">
    <DisplayString>{{ size={d->size} buckets={d->numBuckets} }}</DisplayString>
    <Expand>
        <IndexListItems>
            <Size>d->numBuckets</Size>
            <ValueNode Condition="reinterpret_cast&lt;QHashNode&lt;$T1,$T2&gt; *&gt;(d->buckets[$i]) != e">reinterpret_cast&lt;QHashNode&lt;$T1,$T2&gt; *&gt;(d->buckets[$i])</ValueNode>
        </IndexListItems>
    </Expand>
</Type> 
```

它非常有效，但由于 QHash 在内存中不是连续的，所以有很多无效条目。条件

```
reinterpret_cast&lt;QHashNode&lt;
$T1,$T2&gt; *&gt;(d->buckets[$i]) != e 
```

已经过滤掉了那些无效的，但它们仍然显示为`<Unable to display value>`.

有谁知道是否有办法完全跳过这些条目？

我从来没有真正使用过 autoexp.dat 文件，这是旧的方法，但是当查看安装了 Qt-plugin 的文件时，在我看来该语句

```
#switch ($e.next != 0) #case 1 (
    $e
) 
```

确实是这样，所以我希望在 natvis 文件中也有办法做到这一点？

如果有人感兴趣，我可以给你 natvis 文件，但到目前为止我只有 QString、QByteArray、QList、QVector、QMap 和（有问题的）QHash。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-24T03:25:00.243

根据[关于编写类型可视化器的 MSDN 页面](http://code.msdn.microsoft.com/windowsdesktop/Writing-type-visualizers-2eae77a2)，`<IndexListItems>`根据定义是连续的：

> **IndexListItems 扩展**
> 
> ArrayItems 假定数组元素在内存中连续布局。调试器通过简单地增加其指向当前元素的指针来获取下一个元素。为了支持需要对值节点操作索引的情况，可以使用索引列表项。这是一个使用 'IndexListItems' 节点的可视化工具： [....] ArrayItems 和 IndexListItems 之间的唯一区别是 'ValueNode' 需要对带有隐式 '$i' 参数的第 i 个元素的完整表达式。

另外，我可以向您[指出 Qt Labs VSTools 存储库](https://qt.gitorious.org/qt-labs/vstools)及其[文档](http://developer.qt.nokia.com/wiki/QtVSAddin)吗？特别是`tools/Qt4EEAddin/qt5.natvis`看起来很像我认为你想要写的东西？（或者它*实际上*是你在写什么？^_^）无论哪种方式，我认为你能做的最好的就是 in `qt5.natvis`，它有一个`<DisplayString>`空的特殊`QHashNodes`但不会试图在`QHash`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-19T06:15:15.457

在我看来，只是 html 标签。

将其替换为 '<' , '>'

更多信息，请参见[此处](https://stackoverflow.com/questions/9904051/is-there-c-function-that-replace-xml-special-character-with-their-escape-seque)

# c - 文本到 C 中的数组

> ID：13748214
> 
> 赞同：0
> 
> 时间：2012-12-06T16:35:32.523
> 
> 标签：c, xcode, arrays, text, scanf

我不明白如何在 C 中使用 fscanf 将文本文件中的数据放入数组中，并且还能够以 cli :S 的用户身份编辑文本文件（此处为完整新手..）我尝试使用谷歌搜索，但所有出现的论坛问题多于解决方案和 C++ 非示例。

任何帮助/示例将不胜感激:)

编辑：感谢您的快速回复，我似乎忘记提及我想使用二维数组，并且 txt 文件包含整数，每个后续元素之间有一个空格，每行都有一个新行！

编辑2：所以从我收集到的我必须使用：

1.  fscanf ("filename.txt", "rw")
2.  创建一个数组[i][j]
3.  i 和 j 的嵌套 for 循环
4.  如何将 fscanf 数据放入数组中？5.printf("%d\n", &array[i][j])

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T20:13:49.573

根据输入数据的格式，您可以执行类似的操作来读取每一行的值。

```
int data[MAX_X][MAX_Y];
FILE * fp = fopen("mydata.txt", "r");
int x, y, value;
// TODO: Initialize data array
while (3 == fscanf(fp, "%d %d %d\n", &x, &y, &value))
{
    if ((x >= MAX_X) || (y >= MAX_Y))
    {
        fprintf(stderr, "range error\n");
        break;
    }
    data[x][y] = value;
} 
```

许多细节取决于输入数据的格式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T16:51:28.257

将问题分成几部分：

1.  如何用 fscanf 读取一个数字
2.  如何移动到下一个号码
3.  如何遍历行

然后再单独问。

# jasper-reports - 将回车附加到详细信息行的末尾

> ID：13748217
> 
> 赞同：1
> 
> 时间：2012-12-06T16:35:42.437
> 
> 标签：jasper-reports, newline, carriage-return

我正在尝试将回车值 ( ***\n*** ) 附加到 Detail 行的末尾，并且在使其正常工作时遇到问题。

我在用于此的文本字段的*textField*表达式中放置了一个值***\n*** *，虽然它在运行报告时似乎“工作”，但当数据通过.csv*文件发送到另一个系统时，该值是被接收为***\n***而不是回车值。我现在可以看到为什么会发生这种情况，因为值被放置在文本字段的文本表达式字段中。

 ***考虑到上述情况，我遇到了一个帖子，证实了我刚才描述的内容，并说将其放在一个表达式中，我的问题是，如果不在文本表达式中，它应该放在模式表达式中吗？如果不存在，将回车值加载到详细信息行的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-06T14:59:40.537

在你的出口商上设置这个

```
JRCsvExporter.setParameter(JRCsvExporterParameter.RECORD_DELIMITER, "\r\n"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-28T17:39:02.347

见[http://community.jaspersoft.com/questions/531981/chang-csv-record-delimiter](http://community.jaspersoft.com/questions/531981/changing-csv-record-delimiter)

简短的回答，使用 <property name="net.sf.jasperreports.export.csv.record.delimiter" value=" "/>***

# php - MSSQL 存储过程有行，但 mssql_num_rows 返回 0

> ID：13748218
> 
> 赞同：1
> 
> 时间：2012-12-06T16:35:47.437
> 
> 标签：php, sql-server

我正在使用的一些 PHP 和 MSSQL 遇到了一个非常奇怪的问题。我正在使用存储过程来检索用户刚刚存储到数据库中的信息，以便他们可以打印出他们的条目记录。

最初，我在将标题详细信息显示在屏幕上时遇到问题，因此最终通过将 $skip_results 的布尔值设置为 true 来更改代码以使其正常工作。这意味着我必须在没有该设置的情况下第二次调用存储过程来获取相关的信息行。

这是我所做的：

```
//populate header with order information - this one uses true in the mssql_execute in order to return all the output variables
/* prepare the statement resource */
$confirmationstmt=mssql_init("stored-procedure-name", $link);

/* now bind the parameters to it */
mssql_bind($confirmationstmt, "@var1",  $var1,  SQLVARCHAR, FALSE);
mssql_bind($confirmationstmt, "@var2",  $var2,  SQLFLT8, TRUE);
mssql_bind($confirmationstmt, "@var3",    $var3,    SQLVARCHAR,    TRUE);
mssql_bind($confirmationstmt, "@var4",    $var4,    SQLVARCHAR,    TRUE);
mssql_bind($confirmationstmt, "@var5",    $var5,    SQLVARCHAR,    TRUE);
mssql_bind($confirmationstmt, "@var6",    $var6,    SQLVARCHAR,    TRUE);
mssql_bind($confirmationstmt, "@var7",    $var7,    SQLVARCHAR,    TRUE);
mssql_bind($confirmationstmt, "@var8",    $var8,    SQLINT4,    TRUE);
mssql_bind($confirmationstmt, "@var9", $var9, SQLVARCHAR, true);
mssql_bind($confirmationstmt, "@var10", $var10, SQLFLT8, true);
mssql_bind($confirmationstmt, "@var11", $var11, SQLFLT8, true);
mssql_bind($confirmationstmt, "@var12", $var12, SQLFLT8, true);
mssql_bind($confirmationstmt, "@var13", $var13, SQLFLT8, true);

// now execute the procedure
$confirmationresult = mssql_execute($confirmationstmt, true);

//populate header with order information - this one uses true in the mssql_execute in order to return all the output variables
/* prepare the statement resource */
$numlinesstmt=mssql_init("stored-procedure-name", $link);

/* now bind the parameters to it */
mssql_bind($numlinesstmt, "@var1",  $var1,  SQLVARCHAR, FALSE);
mssql_bind($numlinesstmt, "@var2",  $var2,  SQLFLT8, TRUE);
mssql_bind($numlinesstmt, "@var3",    $var3,    SQLVARCHAR,    TRUE);
mssql_bind($numlinesstmt, "@var4",    $var4,    SQLVARCHAR,    TRUE);
mssql_bind($numlinesstmt, "@var5",    $var5,    SQLVARCHAR,    TRUE);
mssql_bind($numlinesstmt, "@var6",    $var6,    SQLVARCHAR,    TRUE);
mssql_bind($numlinesstmt, "@var7",    $var7,    SQLVARCHAR,    TRUE);
mssql_bind($numlinesstmt, "@var8",    $var8,    SQLINT4,    TRUE);
mssql_bind($numlinesstmt, "@var9", $var9, SQLVARCHAR, true);
mssql_bind($numlinesstmt, "@var10", $var10, SQLFLT8, true);
mssql_bind($numlinesstmt, "@var11", $var11, SQLFLT8, true);
mssql_bind($numlinesstmt, "@var12", $var12, SQLFLT8, true);
mssql_bind($numlinesstmt, "@var13", $var13, SQLFLT8, true);

// now execute the procedure
$numlinesresult = mssql_execute($numlinesstmt);

$numlines = mssql_num_rows($numlinesresult); 
```

第一组 mssql_bind 语句中的变量都已正确填充，虽然您希望第二次调用会覆盖它们，但它们没有！当我第一次将这个“修复”应用到站点时，$numlines 变量被正确填充，这使我能够处理存储过程创建的 select 语句返回的所有行。然而，24 小时后，第二组停止工作，我从 mssql_num_rows($numlinesresult) 调用中得到一个 0。

谁能告诉我在这里做错了什么，因为我真的不应该两次调用存储过程，每次都以不同的方式来获取所有信息。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T16:58:45.183

存储过程包含`SET NOCOUNT ON`

# logging - 扭曲的日志级别开关

> ID：13748222
> 
> 赞同：4
> 
> 时间：2012-12-06T16:35:54.180
> 
> 标签：logging, twisted

Twisted 中是否有任何方法可以更改应该记录的消息的日志记录级别？

我在项目中使用三个级别：

```
log.msg('agent nr.1 has free slots', logging.DEBUG) # debug message
log.msg('agent nr.1 has free slots') # info message
log.err('agent nr.1 has free slots') # error message 
```

我以这种方式配置日志记录：

```
from twisted.python import log
from twisted.python.logfile import LogFile

logfile = LogFile("someFile.log", '/some/path/', rotateLength=1000, maxRotatedFiles=100)
application.setComponent(log.ILogObserver, log.FileLogObserver(logfile).emit) 
```

但我需要设置应该记录哪些消息（例如，只有信息和错误消息，没有调试）。怎么做？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-10T15:13:39.407

首先，您使用的 api 不存在。它没有在模块级别记录，但`log.msg`在[此处记录](http://twistedmatrix.com/documents/current/api/twisted.python.log.LogPublisher.html#msg)：传递给的所有非关键字参数`log.msg`都是消息的一部分，因此在这里您不是设置消息级别而是在消息中添加一个整数，顺便说一句，不鼓励这种形式。

```
log.msg('agent nr.1 has free slots', logging.DEBUG) # debug message 
```

其次，要回答您的问题，是的，您可以指示twisted 使用日志级别来确定应记录哪些消息，但这不是默认记录器的工作方式。幸运的是，个性化扭曲有点自然（如果你知道怎么做的话）。

你必须编写一个记录器观察者，例如你可以扩展 `twisted.python.log.FileLogObserver`，它处理一个 logLevel：

```
import logging
from twisted.python import log

class LevelFileLogObserver(log.FileLogObserver):

    def __init__(self, f, level=logging.INFO):
        log.FileLogObserver.__init__(self, f)
        self.logLevel = level

    def emit(self, eventDict):
        if eventDict['isError']:
            level = logging.ERROR
        elif 'level' in eventDict:
            level = eventDict['level']
        else:
            level = logging.INFO
        if level >= self.logLevel:
            log.FileLogObserver.emit(self, eventDict) 
```

那么你必须[注册它](http://twistedmatrix.com/documents/current/core/howto/logging.html#auto4)：

```
from twisted.python import logfile

f = logfile.LogFile("someFile.log", '/some/path/', rotateLength=1000,
                    maxRotatedFiles=100)
logger = LevelFileLogObserver(f, logging.DEBUG)
twisted.python.log.addObserver(logger.emit) 
```

如果你使用twistd，你可以通过`--logger`选项传递它：

```
# mylogger.py
# import LevelFileLogObserver
from twisted.python import logfile

f = logfile.LogFile("someFile.log", '/some/path/', rotateLength=1000,
                    maxRotatedFiles=100)
flobserver = LevelFileLogObserver(f)
observer = flobserver.emit

# twistd invocation
twistd --logger=mylogger.observer 
```

现在您可以使用您定义的新 api：

```
log.msg('the level of this message is INFO')
log.msg('the level of this message is INFO', level=logging.INFO)
log.msg('the level of this message is DEBUG', level=logging.DEBUG)
log.msg('the level of this message is ERROR', level=logging.ERROR)
log.err('the level of this message is ERROR') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-19T09:44:52.177

我研究了来自`mg.`其他来源的答案，并实现了一个小型库`tx-logging`。您将能够以常见的 Python 方式编写日志：

```
LOG = tx_logging.getLogger("some log name")
LOG.debug("some message") 
```

访问主页获取信息：[https](https://github.com/oblalex/tx-logging) ://github.com/oblalex/tx-logging 。希望这对将来的人有所帮助。

# c++ - CUDA 内核作为类的成员函数

> ID：13748231
> 
> 赞同：8
> 
> 时间：2012-12-06T16:36:26.287
> 
> 标签：c++, windows, cuda

我正在使用 CUDA 5.0 和 Compute Capability 2.1 卡。

问题很简单：内核可以成为类的一部分吗？例如：

```
class Foo
{
private:
 //...
public:
 __global__ void kernel();
};

__global__ void Foo::kernel()
{
 //implementation here
} 
```

如果不是，那么解决方案是创建一个作为类成员的包装函数并在内部调用内核？

如果是，那么它是否可以作为普通私有函数访问私有属性？

（我不只是尝试它，看看会发生什么，因为我的项目现在还有其他几个错误，而且我认为这是一个很好的参考问题。我很难找到将 CUDA 与 C++ 结合使用的参考。基本功能示例可以是找到但未找到结构化代码的策略。）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-06T17:00:57.213

让我暂时将 cuda 动态并行性排除在讨论之外（即假设计算能力为 3.0 或更高版本）。

请记住 __ global__ 用于将（仅）从主机调用（但在设备上执行）的 cuda 函数。如果您在设备上实例化此对象，它将不起作用。此外，为了使成员函数可以使用设备可访问的私有数据，必须在设备上实例化对象。

因此，您可以进行内核*调用*（即`mykernel<<<blocks,threads>>>(...);`嵌入到宿主对象成员函数中，但内核定义（即带有 __ global__ 装饰器的函数定义）通常会在源代码中的对象定义之前。如前所述，这样方法不能用于在设备上实例化的对象。它也无法访问对象中其他地方定义的普通私有数据。（可能会为确实创建的仅主机对象提出一个方案设备数据，使用全局内存中的指针，然后可以在设备上访问，但乍一看，这样的方案对我来说似乎很复杂）。

通常，设备可用的成员函数会在 __device__ 装饰器之前。在这种情况下，设备成员函数中的所有代码都在调用它的线程中执行。

[这个问题](https://stackoverflow.com/questions/13630817/cuda-version-not-working-while-serial-working/13652988#13652988)给出了一个 C++ 对象的示例（在我编辑的答案中），该对象具有可从主机和设备调用的成员函数，并在主机和设备对象之间进行适当的数据复制。

# android - 在 Android StackView 中允许或阻止滚动

> ID：13748239
> 
> 赞同：0
> 
> 时间：2012-12-06T16:36:49.000
> 
> 标签：android

我有一个 StackView 小部件，我可以将其设置为使用以下 xml 代码自动滚动项目：

```
<app-widget provider> ...
...
android:autoAdvanceViewId="@id/stack_view"
</app-widget provider> 
```

我知道如果我删除此行，它将禁用自动滚动。我想做的是利用我在将小部件添加到屏幕时设置的共享首选项，为用户提供启用或禁用自动滚动的选项。这可能吗？如果是这样，我将如何更改代码中的 app-widget 提供程序？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T16:58:38.617

不幸的是`AppWidgetProviderInfo`（由这个 XML 创建的对象）是相当静态的，并且只能在升级 APK 时更改。如果您想以动态方式实现此功能，您将需要使用小部件的定期更新机制从代码手动推进您的视图。

# java - 提取 PDF 注释/评论

> ID：13748242
> 
> 赞同：2
> 
> 时间：2012-12-06T16:37:01.887
> 
> 标签：java, python, pdf

我们有一个相当复杂的打印工作流程，其中控制是使用 Adob​​e Reader 或 Adob​​e Acrobat 为生成的 PDF 文档的草稿版本添加注释和注释。作为工作流程的一部分，应解析带有注释和注释的导入 PDF 文档，并且应将注释导入 CMS 系统（与 PDF 一起）。

问：是否有任何可靠的工具（首选 Python 或 Java）可以以干净可靠的方式将此类数据提取为 PDF 文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T17:16:29.277

这段代码应该可以完成这项工作。[Parse annotations from a pdf](https://stackoverflow.com/q/1106098/1699750)问题[的答案之一对](https://stackoverflow.com/a/12502560/1699750)让我编写下面的代码非常有帮助。它使用 poppler 库来解析注释。这是[annotations.pdf](https://dl.dropbox.com/u/25840964/stackoverflow/annotations.pdf)的链接。

**代码**

```
import poppler, os.path

path = 'file://%s' % os.path.realpath('annotations.pdf')
doc = poppler.document_new_from_file(path, None)
pages = [doc.get_page(i) for i in range(doc.get_n_pages())]

for page_no, page in enumerate(pages):
    items = [i.annot.get_contents() for i in page.get_annot_mapping()]
    items = [i for i in items if i]
    print "page: %s comments: %s " % (page_no + 1, items) 
```

**输出**

```
page: 1 comments: ['This is an annotation'] 
page: 2 comments: [' Please note ', ' Please note ', 'This is a comment in the text'] 
```

**安装**

在 Ubuntu 上安装如下。

```
apt-get install python-poppler 
```

# python - 读取和使用表中的数据

> ID：13748245
> 
> 赞同：-1
> 
> 时间：2012-12-06T16:37:06.277
> 
> 标签：python, math, tabular

我想读取 ASCII 表的内容，并对表不同列中的元素进行一些计算。我怎么做？

例如，该表有 1000 行，每行都有 X 和 Y。我应该怎么做才能为每个可能的行组合获取 XY？

在 Fortran 中，这类似于：

```
do i=1,1000
do j=1,1000
diff=x(i)-y(j)
enddo
enddo 
```

对python方式有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T16:42:49.223

这很简单，但是这个论坛是针对特定问题的；这意味着您应该尝试开始使用 Python，然后如果您遇到特定的问题，有人会很乐意帮助您。

由于您似乎有 Fortran 的背景，这里有一个为正在转向 Python 的 Fortran 程序员准备的博客：http: [//blogs.cae.tntech.edu/mwr/python-for-fortran-programmers/](http://blogs.cae.tntech.edu/mwr/python-for-fortran-programmers/)

此外，我强烈推荐 Rosetta Code，它展示了如何以各种语言执行各种任务的示例： [http ://rosettacode.org/wiki/Rosetta_Code](http://rosettacode.org/wiki/Rosetta_Code)

# python - Python 构建脚本

> ID：13748246
> 
> 赞同：2
> 
> 时间：2012-12-06T16:37:11.137
> 
> 标签：python, build

为 Python 项目创建构建脚本有哪些最佳实践？具体来说，不是用于构建 Python 库，而是用于构建 Python 应用程序（例如独立服务器应用程序或 Web 应用程序）。有哪些框架支持：

*   管理不同环境（开发、测试、产品等）的依赖关系
*   运行任务：启动、停止、测试、pydoc、pep8等。
*   准备使用 virtualenv 进行部署：创建一个包（tar.gz、rpm、egg 等）

我通常使用 setuputils/easy_install 来执行此操作——它有其局限性。但是，我读到一篇文章说应该使用 distutils/pip。如果这些更强大？还有其他选择吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T16:40:29.347

如果你正在寻找一个好的构建框架，基于 python 的[Scons](http://www.scons.org/)是一个很好的替代品。

# java - 从 Java Web 应用程序的内存中清除无效会话的简单方法

> ID：13748247
> 
> 赞同：2
> 
> 时间：2012-12-06T16:37:11.713
> 
> 标签：java, session, servlets, garbage-collection, httpsession

我知道`session.invalidate()`释放httpsession。但是当我监视容器内存时，它并没有下降。这是我正在观察的 -

*   登录（我的应用程序创建一个会话）
*   用户执行一些增加进程内存的活动。
*   登出。（注销控制器显式地使会话无效）
*   监控进程内存。它永远不会下来。

最初我认为，垃圾收集可能只有在达到低内存可用状态后才能工作。为了确认这一点，我使用 -Xmx 来减少内存。但仍然是同样的错误。事实上，当我使用单独的浏览器执行相同的活动时，我看到了 OOM 错误。

这里有什么遗漏吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T22:20:10.653

您可以尝试以下方法之一来分析问题：

1.  打印 GC 日志并查看是否发生了多少次 Young/Full GC 收集：

    > -XX:+UnlockDiagnosticVMOptions -XX:+LogVMOutput -XX:LogFile=jvm.log -XX:+HeapDumpOnOutOfMemoryError -Xloggc:bin/gc.log -XX:+PrintGCTimeStamps -XX:+PrintGCDetails -verbose:gc

2.  检查 Class Histograms 以查看您的类的实例是否正在被 Full GC 收集。比较 Full GC 之前/之后的实例数。使能够 ：

    > -XX:+PrintClassHistogramBeforeFullGC -XX:+PrintClassHistogramAfterFullGC

3.  拍摄直方图快照，再次查看是否正在收集类：

    > jmap -histo $pid

4.  查看该类是否包含 finalize() 方法，该方法将阻止在 GC 期间收集对象。

5.  正如 GargantuChet 建议的那样，收集 HeapDump 并查看哪些对象正在引用您的类实例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T16:42:23.050

它将一直存在于内存中，直到垃圾收集器运行并找到未引用的对象并清理它们。出于测试目的，您可以尝试使用`System.gc()`after显式调用 GC。`session.invalidate()`同样调用`System.gc()`不需要调用 GC，因为 jvm 将决定是否运行 GC。

# vb.net - 捕获访问数据库错误（FormatException）并返回自定义消息？

> ID：13748250
> 
> 赞同：0
> 
> 时间：2012-12-06T16:37:20.217
> 
> 标签：vb.net, excel, ms-access, error-handling, try-catch

我有一个需要整数的字段的访问数据库。我正在传递从 Excel 电子表格中检索到的一些数据，如果从单元格中检索到字符串，则调用函数的 Try/Catch 将遇到 FormatException。我想弄清楚的是是否有可能（并且总是）抛出一个自定义错误消息，该消息将显示包含无效数据的单元格地址。这是我所拥有的一些示例代码。

```
Public Class Main
Private cellAddress As String
Private Sub btn_Import(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnImport.Click
    Dim openFileDialog As New OpenFileDialog()
    openFileDialog.InitialDirectory = Environment.GetFolderPath(Environment.SpecialFolder.MyDocuments)
    openFileDialog.Filter = "Excel Files (*.xls)|*.xlsx|All files (*.*)|*.*"
    openFileDialog.RestoreDirectory = True
    If openFileDialog.ShowDialog() <> Windows.Forms.DialogResult.OK Then
        Return
    End If
    Try
        ImportWorksheet(New FileInfo(openFileDialog.FileName))
    Catch ex As FormatException
        MessageBox.Show("The data contained within cell " & cellAddress &  " is invalid.", "Error")
    End Try
End Sub

Private Sub ImportWorksheet(ByVal excelFile As FileInfo)
    Dim cnn As New OleDbConnection(My.Settings.cnn)
    Dim cmd As OleDbCommand = GetCommand("UpdateSite")
    Dim worksheet1 As ExcelWorksheet = package.Workbook.Worksheets(1)
    Using package As New ExcelPackage(excelFile)
        Using cmd.Connection
            cmd.Connection.Open()
            cmd.Parameters.Add("@MyData", OleDbType.Integer).Value = GetCellContents(worksheet1, "K8")
            cmd.ExecuteNonQuery()
        End Using
End Sub

Private Function GetCellContents(ByVal worksheet As ExcelWorksheet, ByVal address As String) As Object
    If worksheet.Cells(address).Value Is Nothing Then
        Return DBNull.Value
    Else
        cellAddress = address
        Return worksheet.Cells(address).Value
    End If
End Function
End Class 
```

不要认为我在这里遗漏了任何东西，我复制并粘贴并更改了代码以缩短并且不放弃任何不需要的信息。一旦代码到达 ExecuteNonQuery() 方法，错误就会冒出并说出我写的任何内容。如果可能的话，我想在发生这种情况时传递单元格地址，以便他们知道在哪里查找。

我能想到的唯一方法是添加一个类级别变量，并在每次获取值时将其设置为当前单元格。唯一的问题是，因为它只在 ExecuteNonQuery() 触发，并且我有多个参数，如果第一个添加的参数无效但下一个参数不是，那么每次将单元格设置为最后一个参数，我得到错误的结果。有没有办法从数据库中获取某种消息，具体告诉我哪个参数没有正确转换？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T17:31:54.530

没关系，我现在只是用这个......它有效，但如果你们能给我更好的东西，请做。

```
cmd.Parameters.Add("@MyData", OleDbType.Integer).Value = GetCellContents(worksheet2, "K8", "Int32")

 Private Function GetCellContents(ByVal worksheet As ExcelWorksheet, ByVal address As String, Optional ByVal type As String = Nothing) As Object
    If worksheet.Cells(address).Value Is Nothing Then
        Return DBNull.Value
    Else
        cellAddress = address
        Select Case type
            Case Is = "String"
                Return Convert.ToString(worksheet.Cells(address).Value)
            Case Is = "Int32"
                Return Convert.ToInt32(worksheet.Cells(address).Value)
            Case Is = "DateTime"
                Return Convert.ToDateTime(worksheet.Cells(address).Value)
            Case Else
                Return worksheet.Cells(address).Value
        End Select
    End If
End Function 
```

# jquery - 一个 div 中的按钮使其他 div 滚动到锚点

> ID：13748261
> 
> 赞同：0
> 
> 时间：2012-12-06T16:37:52.493
> 
> 标签：jquery, scroll, external, animated

我想知道如何使一个 div 中的按钮滚动到另一个 div 中的锚点。锚的结构如下所示：

```
<a id="organisational_change"></a> 
```

我拥有的 jQuery 是：

```
$(document).ready(function(){
var consultancyLinks=["organisational_change","organisational_development","executive_coaching","executive_team_development","corp_social_responsibility"];
$("#sidemenu_consultancy #sidemenu_consultancy_btn").each(function(){
$(this).css( 'cursor', 'pointer' );
});
    $("#sidemenu_consultancy #sidemenu_consultancy_btn").click(function(){
        $('html, body, #content_text').animate({scrollTop: $("#"+consultancyLinks[$(this).index()])},800);
        }); 
```

});

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T16:47:34.770

试试下面的代码

```
<div id="btn">
<button id="btn1"/>
</div>

<div id="ancr">
<a id="organisational_change"></a>
</div>

$(document).ready(function(){
$("#btn1").click(function(){
    $('body').animate({scrollTop:$("#organisational_change").scrollTop},800);
    }); 
```

});

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T16:43:12.223

好吧，你可以在没有任何 javascript 的情况下做到这一点：

```
<a id="organisational_change" href="#id_of_other_element"></a> 
```

否则，如果您想要动画，请执行以下操作：

```
$('a').click(function(e) {
    e.preventDefault();

    $('html, body').animate({scrollTop: $($(this).attr('href')).offset().top}, 800);
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-05-05T20:03:12.353

有这个确切的问题，现在我有一个适用于移动设备、平板电脑和台式机的解决方案。但它确实需要javascript。在这里，使用您的代码。相应调整。

```
<div id="btn">
<button id="btn1" onclick="ScrollDiv('organisational_change')/>
</div>

<div id="ancr">
<a id="organisational_change"></a>
</div>

 <script>
   function ScrollDiv(yourelement)
     {
      var myDiv         = document.getElementById('ancr');
      var myDivrect     = myDiv.getBoundingClientRect();
      var Card          = document.getElementById(yourelement);
      var Cardrect      = Card.getBoundingClientRect();
      var CardHeight    = Cardrect.height;
      var DivTopPadding = 25;
      var DivElementPad = 10;
      var Distance   = (DivTopPadding + ((CardHeight + DivElementPad ) * (CardIndex-1)) ;
      myDiv.scrollTo({
                      top: Distance,
                      left: 0,
                      behavior: 'smooth'
                    });
     }
 </script> 
```

# rest - 通过 SOAP 访问 REST 服务

> ID：13748262
> 
> 赞同：3
> 
> 时间：2012-12-06T16:37:52.990
> 
> 标签：rest, soap, reporting-services, reporting

我对 web 服务的经验很少，现在面临一个棘手的问题。我组织的供应商通过 REST 服务公开了一些数据（在初始 https 调用之后的 https 调用以检索在 n 次调用或 n 分钟后过期的令牌）。

组织中的大多数报告都是使用 SQL Reporting Services 完成的，我被要求帮助弥合 SSRS 和 REST 之间的差距。该组织可能还希望使用 SSIS 来检索一些数据。

我不相信我可以从这些技术中轻松调用 REST 服务，因此我正在考虑将对 REST 服务的调用包装在 .NET SOAP Web 服务中，我相信 SSRS 将能够应对。

从架构上看，这似乎是错误的，我敢肯定有一些陷阱在等着我，但这听起来像是一个合适的解决方案吗？（作为替代方案，我相信我也可以为 SSRS 编写自定义数据提供程序，但是当我开始使用 SSIS 时我会遇到同样的问题）

非常感谢，安德鲁

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T20:10:04.643

> 所以我正在考虑将对 REST 服务的调用包装在 .NET SOAP Web 服务中
> 
> ...
> 
> 从架构上看，这似乎是错误的，我敢肯定有一些陷阱在等着我，但这听起来像是一个合适的解决方案吗？

完全没有问题.. 没有禁止从另一种 Web 服务访问一种 Web 服务的架构限制.. 您可以以各种方式实现它，如果您不习惯直接从 SOAP 方法实现执行 HTTP 请求，您可以将 REST Web 服务通信包装在 Proxy 对象中，并对 SOAP 方法隐藏详细信息。

# asp.net - 我可以从 web.config 中读取所有连接字符串，而无需每个字符串的名称吗？ASP.net

> ID：13748266
> 
> 赞同：3
> 
> 时间：2012-12-06T16:38:44.520
> 
> 标签：asp.net, web-config, connection-string

我想以编程方式从 web.config 读取所有连接字符串，而不指定连接字符串的名称。并将该信息用于不同目的，例如在屏幕上打印出来。有可能吗？我该怎么做？

谢谢，

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-06T16:45:47.160

你显然没有尝试任何东西。这会做到

```
 foreach (var s in System.Web.Configuration.WebConfigurationManager.ConnectionStrings)
  {
        Response.Write(s);
  } 
```

哪里`ConnectionStrings`有收藏`ConnectionStringSettings`

```
foreach (System.Configuration.ConnectionStringSettings s in System.Web.Configuration.WebConfigurationManager.ConnectionStrings)
{
     Response.Write(s);
} 
```

# c# - 在异步任务中使用 HttpContext

> ID：13748267
> 
> 赞同：15
> 
> 时间：2012-12-06T16:38:51.223
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, asynchronous, async-await

我有以下 mvc 动作。

```
public async Task<JsonResult> DoSomeLongRunningOperation()
{
    return await Task.Run(() =>
    {
        //Do a lot of long running stuff
        //The underlying framework uses the HttpContext.Current.User.Identity.Name so the user is passed on the messagebus.
    }
} 
```

在任务中，HttpContext 为空。我们做了很多欺骗，但没有任何东西可以保证 HttpContext 在我们的新线程中始终可用。

是否有在异步任务中使用 HttpContext 的解决方案？

在我们的 IocContainer 中，我们注册了以下将用户名传递给框架的对象。

```
public class HttpContextUserIdentityName : ICredentials
{
    public string Name
    {
        get { return HttpContext.Current.User.Identity.Name; }
    }
} 
```

在持久化到数据库之前，很多地方都会调用此代码。

我们需要另一种方法来获取发起 web 请求的用户的用户名，或者解决 HttpContext 为空的问题。

因为持久化到数据库发生在任务中，所以在进入任务之前我无法访问 HttpContext。

我也想不出一种安全的方法来临时保留用户名，这样我就可以实现另一个 ICredentials 服务对象。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-06T17:46:30.620

您几乎从不想`Task.Run`在 ASP.NET 方法中使用。

我认为最干净的解决方案（但工作最多）是在您的其他层实现`async`-compatible 接口：

```
public async Task<JsonResult> DoSomeLongRunningOperation()
{
  //Do a lot of long running stuff
  var intermediateResult = await DoLongRunningStuff();
  return await DetermineFinalResult(intermediateResult);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-06T16:44:08.393

在启动新线程*之前*，您应该从当前上下文中获取所需的任何信息。在这种情况下，添加如下内容：

```
string username = HttpContext.Current.User.Username; 
```

之前`Task.Run`然后在另一个线程内部使用它。

`await`顺便说一句，就目前而言，这项任务没有理由。您可以直接返回任务而不将方法标记为`Async`.

如果您需要访问该`Response`对象，这可能会利用长时间运行的操作的结果，因此不能在您应该在*之后*这样`Task.Run`做（但请确保该任务已编辑）。如果您最终这样做，那么您将无法执行我在上一段中建议的操作。*`Task.Run``await`*

 ** * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-06T18:06:44.483

我会尝试将 HttpContext 的引用作为状态对象传递，因为这应该在堆栈上为执行工作的线程创建该对象的新实例。而不是使用 Task.Run，​​使用

```
return await Task.Factory.StartNew((ctx) => 
{
    var context = (HttpContext)ctx;
   //Do stuff
}, httpContextObject); 
```

Task.Run 和 Task.Factory.StartNew 立即返回，因此 asp.net 在处理请求的工作线程中的事件生命周期中继续运行，而您的线程正在对已释放的对象进行操作。*

# javascript - 动态更改脚本 src 客户端

> ID：13748269
> 
> 赞同：7
> 
> 时间：2012-12-06T16:38:52.943
> 
> 标签：javascript, javascript-events

我有一个 HTML 页面，其中包含：

*   带有 3 个选项的`<select>`下拉菜单，其中包含 JS 函数的 onchange 事件
*   一个带有脚本元素的 DIV 持有者：

这是代码：

```
<select onChange="getData(this.value);">
    <option value="-">Limba/Language</option>
    <option value="ro">Romana</option>
    <option value="en">Engleza</option>
</select>
<div id="output">
    <script id="widget" type="text/javascript" src="js1.js"></script>
</div> 
```

这是JS函数：

```
<script type="text/javascript">
function getData(title)
{
    switch(title)
    {
        case "ro":
            var s = document.createElement("script");
                s.type = "text/javascript";
                s.src = "js1.js";
                s.innerHTML = null;
                s.id = "widget";
                document.getElementById("output").innerHTML = s;
        break;
        case "en":
            var s = document.createElement("script");
                s.type = "text/javascript";
                s.src = "js2.js";
                s.innerHTML = null;
                s.id = "widget";
                document.getElementById("output").innerHTML = s;
        break;
        default:
        void(0);
    }
}
</script> 
```

当我选择选项 2 或 3 时，我在浏览器中得到以下输出：`[object HTMLScriptElement]`

我想要做的是根据下拉元素中选择的值切换脚本标签的 src 属性。我想在客户端做这个，最好没有任何外部库......

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-06T16:54:07.750

另一个解决方案很棒:) ...但是如果您仍然想通过 JavaScript 创建元素，则应该使用 appendChild 而不是 innerHTML ...

这就是你的 JavaScript 应该是什么:)

```
<script type="text/javascript">
function getData(title)
{
    switch(title)
    {
        case "ro":
            var s = document.createElement("script");
                s.type = "text/javascript";
                s.src = "js1.js";
                s.innerHTML = null;
                s.id = "widget";
                document.getElementById("output").innerHTML = "";
                document.getElementById("output").appendChild(s);
        break;
        case "en":
            var s = document.createElement("script");
                s.type = "text/javascript";
                s.src = "js2.js";
                s.innerHTML = null;
                s.id = "widget";
                document.getElementById("output").innerHTML = "";
                document.getElementById("output").appendChild(s);
        break;
        default:
        void(0);
    }
}
</script> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-06T16:56:38.640

```
function getData(title){
    document.getElementById("widget").src= (title == "ro" || title == "-") ? "js1.js" : "js2.js";
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-06T16:49:36.617

简单地做：

```
function getData(title) {
    switch(title) {
        case "ro":
            document.getElementById("output").innerHTML = '<script id="widget" type="text/javascript" src="js1.js" />';
            break;
        case "en":
            document.getElementById("output").innerHTML = '<script id="widget" type="text/javascript" src="js2.js" />';
            break;
        default:
            void(0);
    }
} 
```

# javascript - 带有数据表单的 Breezejs

> ID：13748275
> 
> 赞同：0
> 
> 时间：2012-12-06T16:39:04.660
> 
> 标签：javascript, html, breeze, dataform, devforce

我们正准备将我们的应用程序从 Silverlight 迁移到 HTML5/Javascript。在 Silverlight 中，我们使用的是 Devforce 和 Cocktail。

我们还严重依赖 Silverlight 的数据表单来编辑记录。我们创建了一个通用屏幕，它可以接收几乎我们的任何实体并使其字段可编辑。

Breeze 已经处理了我们代码的 Devforce 方面，但我们正在努力寻找数据表单的答案。我们不想仅仅为了编辑记录而创建一堆不同的屏幕。我们正在寻找一种方法来根据我们从 Breeze 收到的实体生成大部分视图。

有人这样做吗？有人有想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T17:50:10.830

为了获得**灵感**，您可以在 GitHub 上的 Breeze Samples 中探索尚未发布的[Breeze Inspector](https://github.com/IdeaBlade/Breeze/tree/master/Samples/Breeze.Inspector)。此应用程序动态创建 HTML“表单”，为每个属性选择控件并根据其自己的元数据进行布局。它使用了一些涉及 RequireJs 的“高级”技术。它是“按原样”提供的；请不要指望支持它。我认为它简单而聪明（从某种意义上说），并希望将其塑造成可发布的东西。

# c - c-fortran 互操作性 - 带指针的派生类型

> ID：13748276
> 
> 赞同：2
> 
> 时间：2012-12-06T16:39:03.910
> 
> 标签：c, interop, fortran, fortran-iso-c-binding

我有很长的 fortran 代码，必须从 python 中使用。我决定做 Fortran->C->Python 接口。

我遇到了一个问题：我在 Fortran 模块中派生了包含

```
double precision, allocatable 
```

键入为成员。

当尝试使用 ifort 编译时，我得到（使用 gfortran 类似的东西）：

```
Each component of a derived type with the BIND attribute shall be a nonpointer,         
nonallocatable data component with interoperable type and type parameters 
```

这实际上与 Intel 编译器文档和 Fortran 2003 标准一致：第 15.2.5 点。

有什么方法可以访问内部带有可分配或指针的 Fortran“类型”？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T18:17:11.613

并不真地。即使是全新的[TS 29113](ftp://ftp.nag.co.uk/sc22wg5/N1901-N1950/N1942.pdf) 也没有提供解决方案。它有，`TYPE(*)`但你必须知道，如何在 C 中解码结构。你可以通过逆向工程来做到这一点。

引用的 TS 中其实有一个结构体大小的宏。见`CFI_attribute_allocatable`。但是取消引用的问题仍然存在。提出了一个标准数组描述符，但一些编译器（尤其是 gfortran）尚不支持此 TS。

有可能的是，只需将指向结构的指针传递给通用函数，例如`qsort`. 然后你只使用一块内存，它恰好还包含一些指针或可分配描述符，但 C 不必知道它们。

另一种可能性是构造一个派生类型，它只包含`type(c_ptr)`，而不是 Fortran 指针并用于`c_loc()`填充它们。确保只有连续的数组。

# javascript - 无法将事件侦听器附加到 -Tag 的 onload事件

> ID：13748278
> 
> 赞同：2
> 
> 时间：2012-12-06T16:39:08.530
> 
> 标签：javascript, html, events

我想知道为什么我不能将事件侦听器附加到 html 图像的 onload 事件。

`<img id="imageID" onload="doSomething();">`完美运行，

但是如果我想添加一个监听器

```
document.getElementById('imageID').addEventListener('onload', function(e) {
     doSomething();
     }); 
```

或使用 jQuery

```
$("imageID").on("onload", function(){
doSomething();
}); 
```

该事件没有被捕获。如果我听一个简单的“点击”事件，它可以工作，但不能与“onload”事件一起工作。

谁能告诉我这种行为的原因？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-06T16:39:53.727

不要包含`"on"`在事件名称中。

```
 // no "on"------------v
document.getElementById('imageID').addEventListener('load', function(e) { 
```

* * *

```
 // no "on"----v
$("#imageID").on("load", function(){
// ^----need "#" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T16:41:54.473

这里有**两个**问题。

1.  [正如我讨厌懒惰所说](https://stackoverflow.com/a/13748296/157247)，你不会在事件名称中加上“on” 。

2.  如果您尝试**在页面上已经**存在的图像上挂钩加载事件，您将遇到竞争情况，有时不会看到该事件，因为它可以在它被放置的那一刻被“加载”到页面（如果相关图像在缓存中）。您必须在图像具有属性**之前**挂钩加载`src`，这通常意味着动态添加图像。您的 DOM0 处理程序 ( `onload="doSomething()"`) 可以工作，因为当图像添加到文档时它已经附加，但是稍后在页面上查找图像的任何内容（`getElementById`或 jQuery）都可能会错过它。

# c# - 快速替换大文件的第一行

> ID：13748282
> 
> 赞同：12
> 
> 时间：2012-12-06T16:39:26.390
> 
> 标签：c#, replace

我有许多要导入数据库的大型 csv 文件（每个 1-10 gb）。对于每个文件，我需要替换第一行，以便将标题格式化为列名。我目前的解决方案是：

```
using (var reader = new StreamReader(file))
{
    using (var writer = new StreamWriter(fixed))
    {
        var line = reader.ReadLine();
        var fixedLine = parseHeaders(line);
        writer.WriteLine(fixedLine);

        while ((line = reader.ReadLine()) != null)
            writer.WriteLine(line);
    }
} 
```

什么是只替换第 1 行而不遍历这些大文件的每一行的更快方法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-06T16:49:14.063

如果您可以保证它`fixedLine`的长度与 相同（或更少）`line`，则可以就地更新文件而不是复制它们。

如果没有，您可能会通过访问`.BaseStream`您的`StreamReader`and`StreamWriter`并执行大块复制（例如，使用 32K 字节缓冲区）来进行复制，从而获得一点性能改进，这至少可以消除检查每个字符以查看的时间如果它是一个行尾字符，就像现在发生的那样`reader.ReadLine()`。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-06T16:48:23.367

唯一可以显着加快速度的是您是否真的可以*替换*第一行。如果新的第一行不长于旧的 - 请仔细替换（如果需要，使用空格填充）第一行。

否则 - 您必须创建新文件并在第一行之后复制其余文件。您可以通过将缓冲区大小/显式复制调整为二进制/每个分配大小来优化复制，但这不会改变您需要复制整个文件的事实。

如果您打算将 CSV 数据放入 DB 中，还有一个技巧：如果顺序无关紧要，您可以从头开始读取一些行，将它们替换为新标题并将删除的行添加到文件末尾。

旁注：如果这是一次性操作，我只需复制文件并完成它......调试将数据插入到具有可能不同编码的文本文件中间的代码可能不值得努力。

# ruby-on-rails - 按创建天数分组_At

> ID：13748284
> 
> 赞同：7
> 
> 时间：2012-12-06T16:39:36.660
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我正在尝试循环发布由 created_at 每天分组的视频。

例如：

2012 年 12 月 5 日 - 视频 9 视频 8 视频 7

2012 年 12 月 4 日 - 视频 6 视频 5

2012 年 12 月 3 日 - 视频 4 视频 3 视频 2 视频 1

**视频控制器：**

```
 def index
    @title = 'Hip Hop Videos, Breaking News, Videos, And Funny Shxt | HOTDROPHIPHOP'
    @description = ''
    @videos = Video.all
    @days = Video.where(:created_at == Time.today )
  end 
```

**查看文件：**

```
<% @days.each do |day| %>

  <div class="video-date">December 4, 2012</div>

  <% @videos.each do |video| %>
  <% end %>

<% end %> 
```

我还需要让那个 div 也显示当天的日期。

我四处搜寻，找不到解决方案，并尝试了 group_by （这似乎是最干净的），但无法使其正常工作。我的 Rails 有点生疏，因为我已经好几个月没碰它了。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-06T17:24:28.317

你可以这样做：

```
@videos = Video.where(Video.arel_table[:created_at].gteq(some_date_value))
@video_days = @videos.group_by {|video| video.created_at.to_date } 
```

where`@video_days`将是`{some_date_value: [{video1}, {video2}, etc], next_date_value: [{video3}, {video4}, etc], etc...}`.

由于您`.to_date`在`created_at`现场呼叫，它将删除所有时间信息，有效地将所有内容按天分组。

您可以像这样循环遍历它：

```
<% @video_days.each do |day, videos| %>
  <%= day.strftime("some format") %>
  <% videos.each do |video| %>
    <%= #output videos how you see fit %>
  <% end %>
<% end %> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-07-25T21:48:57.857

最好的方法是使用 gem [Groupdate](https://github.com/ankane/groupdate)

例如 `User.group_by_day(:created_at).count`

允许您按天、周、小时订购

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-06T17:07:49.967

首先，从今天开始只调用视频然后运行所有视频是没有意义的。

我会这样尝试：

# 控制器

```
@videos = Video.all(:conditions => ["created_at >= ?", Date.today.at_beginning_of_month]) 
```

# 看法

```
<% Date.today.at_beginning_of_month.upto(Date.today).each do |date| %>
  <%= date %>: <%= @videos.select{|u| u.created_at == date }.title %>
<% end %> 
```

它应该为您提供一个视频列表，其中包含实际月份的“日期：视频标题”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-06T17:20:52.443

假设您使用的是 mysql 并且 video 具有属性 title 我发布以下代码以帮助您掌握逻辑（当然它需要重新分解）

**控制器**

```
@videos = {}
videos =  Video.order("DATE(created_at) DESC, title ASC").select("DATE(created_at) as created_at, title, id" )

videos.collect{|x| @videos[x.created_at.to_s] = @videos[x.created_at.to_s] ? @videos[x.created_at.to_s] << x.title : [x.title]  } 
```

**看法**

```
<% @videos.each do |posted_date, videos| %>
  <div class="video-date"><%= Date.parse(posted_date.to_s).strftime("%b %d, %Y") %> </div> 
  <%= videos.join(", ") %>
 <% end %> 
```

# c# - 在 OOP 中创建接口基础设施背后的理念是什么？

> ID：13748287
> 
> 赞同：1
> 
> 时间：2012-12-06T16:39:37.863
> 
> 标签：c#, java, oop, interface

我相信我们发明一些东西是出于某些原因：OOP 的出现是因为过程式编程不能满足我们的需求；接口也是如此，因为抽象等其他 OOP 特性不能满足我们的需求。

有很多关于接口是什么、可以**做**什么以及**如何使用它**的文章和指南，但是，我想知道创建接口背后的实际哲学是什么**？**为什么我们需要有接口？

 ***** * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T17:49:11.180

从概念上讲，接口是一个*契约*。这是一种说法，任何实现这个接口的东西都能够做*这些事情*。

不同的语言有不同的接口可以定义的东西，以及定义它们的不同方式，但这个概念仍然存在。

使用接口可以让您不必关心某些特定任务是*如何完成的；*它允许您确保*它*已完成。

通过允许实现不同，并允许代码只定义它所需要的最小子集，它允许您概括您的代码。

也许您想编写一个方法来在屏幕上写入一系列数字。您不想在任何（许多）其他常用数据结构上为数组、集合、树编写方法来执行此操作。您不需要*关心*您是在处理数组还是链表，您只需要某种获取项目序列的方法。接口允许您只定义所需的最小集合，比如说一个`getNextItem`方法，然后如果所有这些数据结构都实现了该方法和接口，它们可以使用一个通用方法。这比为您要使用的每种数据结构类型编写单独的方法要容易得多*。*（这不是接口的*唯一*用途，只是一个常见的用途。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-06T16:51:46.840

在 Java 中，类只能从一个类继承，但它们可以实现多个接口。接口类似于抽象类，但是如果一个类扩展了一个抽象类，那么该类就不能扩展任何其他类。接口解决了这个问题，你可以让一个类扩展一个抽象类并实现许多接口。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-06T17:50:32.000

我完全同意 susomena 的观点，但这并不是您在使用接口时获得的唯一好处。

例如。在我们当前的应用程序中，模拟在单元测试方面起着重要作用。单元测试的理念是，你真的应该只测试这个单元本身的代码。但是，有时还有其他依赖项，需要获取“被测单元”（SUT）。也许这个依赖还有其他的依赖等等。因此，您无需复杂地构建和配置依赖关系树，而是伪造这个特定的依赖关系。许多模拟框架需要使用类的接口设置，SUT 依赖于该接口。通常可以模拟具体类，但在我们的例子中，模拟具体类会导致单元测试的奇怪行为，因为构造函数调用。但是模拟接口没有，因为接口没有构造函数。

我个人选择抽象类实现的理念是构建分层类结构，其中需要抽象基类的一些默认行为。如果没有任何默认行为，则派生类应该继承，我看不出不选择接口而不是抽象类实现的任何要点。

这里还有另一个（不太好）的例子，说明如何选择一种技术而不是另一种技术。想象一下，你有很多动物课程，比如`Cat`和`Dog`。抽象类`Animal`可能会实现这个默认方法：

```
public abstract void Feed() 
{
    Console.WriteLine("Feeding with meat"); 
} 
```

没关系，如果你有很多动物，就可以吃肉。对于少数不喜欢肉的动物，您只需要重新实现`Feed()`.

但是，如果这些动物有点像美食家呢？要求是，每只动物都有自己喜欢的食物吗？我宁愿在那里选择一个接口，所以程序员被迫`Feed()`为每种单一类型的`IAnimal`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-06T18:13:14.597

IMO 描述接口的最佳文本是[Robert Martin 的 ISP](http://www.objectmentor.com/resources/articles/isp.pdf)。

接口的真正威力来自以下事实：（1）您可以将一个对象视为具有许多不同的类型（因为一个类可以实现不同的接口）以及（2）将来自不同层次树的对象视为具有相同的类型（因为不相关的类可以实现相同的接口）。

如果您有一个带有某种接口类型参数的方法（例如，Comparable），这意味着该方法可以接受实现该接口的任何对象“忽略”类（例如，字符串或整数，两个不相关的类）实现 Comparable）。

因此，接口是比抽象类更强大的抽象。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-08T13:50:05.573

接口被引入 OOP 是因为它在`the producer consumer paradigm`. 让我用一个例子来解释一下……
假设有一家供应商向所有大汽车公司供应轮胎。汽车公司被认为是**消费者**，轮胎供应商是**生产者**。现在消费者向生产商指示必须生产轮胎的各种规格（例如直径、轴距等）；生产商必须严格遵守所有这些规范。

让我们以此类比 OOP... 让我们开发一个应用程序来实现一个堆栈，您正在为此开发 UI；让我们假设您正在使用堆栈库（作为 .dll 或 .class）来实际实现堆栈。在这里， **您是消费者**，而实际**编写堆栈程序**的人是生产者。现在，您指定堆栈的各种规范，说明它应该具有**推送**元素和**弹出**元素的规定以及**窥视的规定**在当前堆栈指针处。您还可以通过指定返回类型和参数（函数的原型）来指定访问这些规定的接口，以便您知道如何在应用程序中使用它们。
实现这一点的最简单方法是创建一个接口并要求**生产者实现该接口**。这样，无论生产者使用什么逻辑（只要满足您的需求，您就不会为实现而烦恼），他**将实现具有精确返回类型和参数的 push、pop 和 peep 方法**。
换句话说，你让生产者严格遵守你的规范和通过让他实现你的接口来满足你的需求的方式。如果他不实现您的接口，您将不会接受任何供应商的堆栈；因为您无法确定它是否适合您的确切需求。

```
 class CStack implements StackInterface
 {//this class produced by the producer must have all three method implementation
  //interface defined by the consumer as per his needs
 bool push(int a){
    ...
 }
 int pop(){
   ....
 }
 int peep(){
   ...
 }
 } 
```****

# c++ - 错误：未在此范围内声明“BadDevice”

> ID：13748291
> 
> 赞同：1
> 
> 时间：2012-12-06T16:39:43.740
> 
> 标签：c++, xlib, xinput

知道为什么我会收到此错误吗？：

```
error: ‘BadDevice’ was not declared in this scope 
```

我已经包括：

```
#include <X11/Xlib.h> 
```

和

```
#include <X11/extensions/XInput2.h> 
```

在我的类头文件中。

我这样使用它：

```
 int ret = XIGrabDevice(display_, 2,  LinuxInputManager::getWindow(),
                            CurrentTime, None, GrabModeAsync,
                            GrabModeAsync, False, &eventMask_);
        if (ret == BadValue)
            std::cout << "bad value" << std::endl;
        else if (ret == BadDevice)
            std::cout << "BadDevice" << std::endl;
        if (ret == BadMatch)
            std::cout << "BadMatch" << std::endl;
        if (ret == BadWindow)
            std::cout << "BadWindow" << std::endl;

        if (ret) {
            std::cout << "not available 3" << std::endl;
        } 
```

干杯

贾勒特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T20:46:15.860

这就是你使用它的方式

```
int rc;
if ((rc = XIGrabDevice(dpy, 2,  win, CurrentTime, None, GrabModeAsync,
                       GrabModeAsync, False, &mask)) != GrabSuccess)
{
    fprintf(stderr, "Grab failed with %d\n", rc);
    return;
} 
```

或尝试（也尝试使用您的功能）

```
int rc;
if (!(rc = XIGrabDevice(dpy, 2,  win, CurrentTime, None, GrabModeAsync,
                       GrabModeAsync, False, &mask)))
{
    fprintf(stderr, "Grab failed with %d\n", rc);
    return;
} 
```

看来 BadValue、BadDevice、BadMatch... 都将是一个 int 值，并且它们可能未在头文件中定义，因此我会检查以确保它们存在于某处。因此，尝试计算 ret 变量。您的错误代码可能类似于 1、2、3、4 或者它们可能是 1 或 0。您必须自己定义错误代码。

这是其他人如何使用 XIGrabDevice 的示例程序：http: [//people.freedesktop.org/~whot/xi2-recipes/part5.c](http://people.freedesktop.org/~whot/xi2-recipes/part5.c)

# android - Android - 未添加 SQLite 整数主键

> ID：13748294
> 
> 赞同：-1
> 
> 时间：2012-12-06T16:39:49.980
> 
> 标签：android, sqlite, integer, primary-key, auto-increment

**编辑：** 我找到了解决方案。显然，如果我将“_id”作为 db.insert 中的 nullColumnHack

```
dbSave.insert(db.getTable(), "_id", values); 
```

然后它工作。谁能解释为什么？

我的应用程序中有一个数据库。文本字段工作得很好，我可以毫无问题地编写和检索它们。但是，我的 ID 列是“整数主键”并没有添加到数据库中。

这是我的 DBHelper onCreate

```
public void onCreate(SQLiteDatabase db) {
    String CREATE_PASS_TABLE = "CREATE TABLE " + TABLE_PASS + "("
            + KEY_ID + " INTEGER PRIMARY KEY, " + KEY_USE + " TEXT,"
            + KEY_PASS + " TEXT" + ")";
    db.execSQL(CREATE_PASS_TABLE);

} 
```

我将值添加到数据库的单独类：

```
private void saveToDB() {

    SQLiteDatabase dbSave = db.getWritableDatabase();

    ContentValues values = new ContentValues();

    values.put(db.getKeyUse(), edtUse.getText().toString());
    values.put(db.getKeyPass(), edtPassToSave.getText().toString());

    dbSave.insert(db.getTable(), null, values);
    dbSave.close();
    dialog.dismiss();
} 
```

这就是我检索记录的地方。

```
private List<Passwords> getPasswords() {
    List<Passwords> passwordList = new ArrayList<Passwords>();

    String selectQuery = "SELECT * FROM " + dbHelp.getTable();
    SQLiteDatabase db = dbHelp.getWritableDatabase();
    Cursor cursor = db.rawQuery(selectQuery, null);

    if (cursor.moveToFirst()) {
        do {
            Passwords password = new Passwords();

            Toast.makeText(getApplicationContext(), cursor.getString(0), Toast.LENGTH_SHORT).show();
            //password.setId(Integer.parseInt(cursor.getString(0)));
            password.setUse(cursor.getString(1));
            password.setPass(cursor.getString(2));

            passwordList.add(password);
        } while (cursor.moveToNext());
    }

    return passwordList;

} 
```

但是，当我尝试获取 ID 并将其解析为 int 时，我得到一个 nullPointerException。当我用 Toast 检查 ID 值时，每个都是空白的。发生了什么事，我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T17:06:13.580

如果您没有明确地为 ID 设置一个值，您可能应该将其设置为自动递增：

```
public void onCreate(SQLiteDatabase db) {
    String CREATE_PASS_TABLE = "CREATE TABLE " + TABLE_PASS + "("
        + KEY_ID + " INTEGER PRIMARY KEY NOT NULL AUTOINCREMENT, " + KEY_USE + " TEXT,"
        + KEY_PASS + " TEXT" + ")";
    db.execSQL(CREATE_PASS_TABLE);
} 
```

# javascript - Kinectic JS - 如何获得元素的缩放高度？

> ID：13748295
> 
> 赞同：0
> 
> 时间：2012-12-06T16:39:52.420
> 
> 标签：javascript, jquery, kineticjs

我试图在 KinecticJS 中获取元素的缩放高度/宽度，但 getHeight()/getWidth() 只返回原始高度和宽度，而不是缩放后的高度和宽度。有我缺少的功能吗？

在此先感谢，马特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T17:58:33.730

解决了它：

```
//Get scale...
var scale = target.getScale().x;
var height = target.getHeight(); var width = target.getWidth();

//Get scaled height by multiplying the scale by the width/height
var scaleWidth = scale*width; var scaleHeight = scale*height; 
```

# android - 从 SQLite 表中获取列表项的主键 ID -ANDROID

> ID：13748297
> 
> 赞同：-2
> 
> 时间：2012-12-06T16:39:53.557
> 
> 标签：android, sqlite

我是Android的初学者..你能告诉我吗

1.  我们如何从 SQLite 表中获取选定列表项的 primary_key_id ..（如果可能，请给我一个例子）。

2.  我们如何避免字符串数组中的冗余条目？提前致谢..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T17:58:34.363

问题 2 很简单：如果您使用的是 String[]，则必须查看整个数组以检查冗余条目。如果您想要一个不允许插入冗余条目的对象，请查看 java.util.* 中的类。从 HashMap 开始。

问题 2 更难。我不知道您是如何创建 SQLite 表的。SQLite 表有一个默认的“主键”列，别名为 ROWID、*ROWID*或 OID。表中的每一行都有这个键的唯一值。

如果您在创建表时没有使用 PRIMARY KEY 构造，那么这些别名就是您用来引用该列的名称。

如果您使用列名和 INTEGER PRIMARY KEY 指定列，则可以使用该列名来访问主键以及其他别名。

对于支持 ListView 的 SQLite 表，您应该使用

创建表人（_id INTEGER PRIMARY KEY，...

注意列名。为了正常工作，ListAdapter 需要一个包含 _id 作为列名之一的 Cursor。您不必在视图中使用 _id，但它必须在光标中。拥有它通常很有用，因为当用户单击 ListView 中的条目时，您可以找到相应的 Cursor 行并获取其数据。

_id 的值通常并不重要。如果您想了解 SQLite 如何分配它的所有详细信息，请参阅[此页面](http://www.sqlite.org/autoinc.html)。

# module - Silverstripe 图片库问题

> ID：13748299
> 
> 赞同：1
> 
> 时间：2012-12-06T16:40:08.283
> 
> 标签：module, content-management-system, image-gallery, silverstripe

我正在尝试为 Silverstripe 3.0.3 安装 image_gallery 模块。我已经安装了 dataobjectmanager 并运行了 dev/build。在我尝试创建图库页面之前，一切似乎都很好。我可以看到图片库页面的选项，但是当我选择它时，我收到一个小弹出窗口，提示内部服务器错误。

检查控制台后，我得到以下信息：

![标题信息](../Images/27f807acce001e61f420fa540ea53f9a.png)

我在本地工作，但似乎无法让它正常工作。

知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T03:25:24.550

真正要了解的是，In`SilverStripe 3`已`ComplexTableField`被替换为`GridField`并`DataObjectManager`基于`ComplexTableField`(http://goo.gl/fsFoz)。所以这就是它不再工作的原因。

总之，对于简单的图片库示例，您必须

1.  创建页面类型
2.  DataObject 保存图像
3.  在您在第 1 点创建的类型的管理面板中创建页面

[使用 Silverstripe 3 GridField](http://www.silverstriperesources.com/articles/using-the-silverstripe-3-gridfield/#)是 Image Gallery 的不错的教程链接，可帮助您入门。

和 [GridFieldBulkEditingTools](https://github.com/colymba/GridFieldBulkEditingTools)

希望它会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-29T13:05:11.490

Silverstripe 中不需要 DataObjectManager。我能够在页面模型中用最少的代码实现一个基本的画廊：

```
public static $many_many = array(
    'Galery' => 'Image'
); 
```

和

```
public function getCMSFields() {
    $fields->addFieldToTab('Root.Images', new UploadField('Galery'));
} 
```

请注意，虽然这将允许您将多个图像添加到页面，但它不允许您对它们进行排序。

# android - 获取椭圆形视图的颜色

> ID：13748303
> 
> 赞同：0
> 
> 时间：2012-12-06T16:40:11.767
> 
> 标签：android

在 android 中，我正在创建具有椭圆形和纯色的视图。现在我想动态获取和设置圆圈的颜色。但是 getBackground() 返回一个 GradientDrawable，它[没有](https://stackoverflow.com/questions/7925978/android-gradient-drawable-color-change)获取颜色的方法。有没有（简单的）方法可以做到这一点？

我更喜欢不使用画布，因为我正在处理很多都是视图的元素，这使它更容易。

xml:

```
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android"
    android:shape="oval">
    <solid
        android:color="#ffff3333"
        />
</shape> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T16:47:42.817

这是你想要的吗？尝试这个 ：

使用 getDrawingCache() 之类的方法获取位图并使用该位图，即 src 如下

```
Bitmap bitmap = src.copy(Bitmap.Config.ARGB_8888, true);
    for(int x = 0;x < bitmap.getWidth();x++)
        for(int y = 0;y < bitmap.getHeight();y++)
            int pixelColor = bitmap.getPixel(x, y); 
```

pixelColor 值将由图像的每个像素的颜色组成。

# python - 了解 Python 导入优先级

> ID：13748304
> 
> 赞同：2
> 
> 时间：2012-12-06T16:40:21.127
> 
> 标签：python, python-module

我需要澄清在同一个命名空间中共存时如何处理模块和类级别的导入。请参阅以下示例：

**作品：**

```
import datetime
print datetime.datetime.utcnow() 
```

**失败：**

```
from datetime import datetime
print datetime.datetime.utcnow() 
```

> 错误：AttributeError：类型对象“datetime.datetime”没有属性“datetime”

**作品：**

```
from datetime import datetime # Is this ignored?
import datetime
print datetime.datetime.utcnow() 
```

第三个例子到底发生了什么？第二个模块导入是否替换了特定于类的第一个导入？这是否意味着模块和类级别的导入不应该混合在同一个命名空间中？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-06T16:43:15.440

没有优先级是这样的。结果由`import`执行语句的顺序决定，如下所示。

如果您尝试将多个调用的内容`X`导入您的命名空间，则每个导入都会重新绑定`X`到它正在导入的任何内容。

因此，最后将是最后一个导入，就所涉及的名称`X`而言将有效。

这正是您的第三个示例中发生的情况：

```
from datetime import datetime # This isn't ignored, but the name is immediately rebound
                              # by the next line
import datetime               # Rebinds the name 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-06T16:43:29.647

一些支持 python 的 IDE 会给您解释，但是是的，您正在重新定义（覆盖、替换）第三个示例中的导入。文件中的每个名称都是不同的。如果您需要访问共享名称的模块和类，您需要使用类似`from datetime import datetime as dt`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-06T16:52:16.840

导入实际上只是一个分配：它在您当前的命名空间中设置一个名称。因此，在第三种情况下，您将名称设置`datetime`为与 datetime 类相同，然后立即将其重新分配给 datetime 模块。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-06T16:45:07.393

您的第一个示例导入`datetime`模块并`datetime`在表示它的本地命名空间中提供一个标签，然后调用属于该模块`utcnow()`的对象的方法。第二个将对象（不是模块）添加到带有标签的本地命名空间，但对象没有属性，所以你得到了异常。第三个示例将对象分配给命名空间中该名称的标签，然后将标签重新分配给模块。因此，忽略与这个问题无关的机制（基本上，如果模块尚不存在，则添加模块），您所拥有的相当于：`datetime``datetime``datetime.datetime``datetime``datetime``datetime``datetime.datetime``datetime``import``sys.modules`

```
datetime = sys.modules['datetime']
datetime.datetime.utcnow() 
```

然后

```
datetime = sys.modules['datetime'].datetime
datetime.datetime.utcnow() 
```

然后

```
datetime = sys.modules['datetime'].datetime
datetime = sys.modules['datetime']
datetime.datetime.utcnow() 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-06T16:46:20.323

没有理由这样做：

```
from datetime import datetime
print datetime.datetime.utcnow() 
```

另一方面，此代码将完全按照您的要求执行：

```
from datetime import datetime
print datetime.utcnow() 
```

# java - 使用序列化读取和写入 java 对象

> ID：13748307
> 
> 赞同：0
> 
> 时间：2012-12-06T16:40:25.747
> 
> 标签：java, serialization

现在写我有这个类，我希望能够使用序列化保存和打开：

```
public class Region implements Serializable
{
private final int      inputNumberOfColumnsAlongXAxis;
private final int      inputNumberOfColumnsAlongYAxis;
private double         inputDataScaleReductionOnXAxis;
private double         inputDataScaleReductionOnYAxis;

private int            numberOfColumnsAlongXAxis;
private int            numberOfColumnsAlongYAxis;
private int            cellsPerColumn;                // Z-Axis dimension
private float          inhibitionRadius;
private final float    percentMinimumOverlapScore;
private final float    minimumOverlapScore; 
```

我以前从未做过对象序列化，所以任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T16:43:55.557

您需要做的最简单的事情是为您的类添加一个私有静态字段，其名称为`serialVersionUID`. 例如：

```
private static final long serialVersionUID = 1L; 
```

默认的序列化机制使用它来匹配类名和格式。

然后，您可以将对象的实例写入 an`ObjectOutputStream`并从 an 中读取它们`ObjectInputStream`：

```
Region r = . . .;
ByteArrayOutputStream bos = new ByteArrayOutputStream();
ObjectOutputStream oos = new ObjectOutputStream(bos);
oos.writeObject(r);
oos.close();
ObjectInputStream ois = new ObjectInputStream(
    new ByteArrayInputStream(bos.getBytes()));
Region r2 = (Region) ois.readObject();
// voilà - a very expensive clone()! 
```

为了更好地控制您的对象序列化，您可以实现以下方法：

```
private void writeObject(java.io.ObjectOutputStream out)
     throws IOException
 private void readObject(java.io.ObjectInputStream in)
     throws IOException, ClassNotFoundException;
 private void readObjectNoData() 
     throws ObjectStreamException; 
```

然后，您可以完全控制对象的序列化。有关详细信息，请参阅[`Serializable`](http://docs.oracle.com/javase/6/docs/api/java/io/Serializable.html).

更新：严格来说，你不需要声明`serialVersionUID`；如果缺少，运行时环境会自动为您计算一个。但是，文档对此有话要说（在原文中强调）：

> 但是，*强烈建议*所有可序列化的类都显式声明 serialVersionUID 值，因为默认的 serialVersionUID 计算对可能因编译器实现而异的类细节高度敏感，因此可能会`InvalidClassException`在反序列化期间导致意外的 s。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T16:45:16.267

您不需要在那里做任何事情，因为所有 Region 属性都是原始类型，即可序列化。将你的类标记为 Serializable 已经可以解决问题了。

更新：对不起，我错过了，您需要添加`serialVersionUID`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-06T16:46:55.520

互联网上有大量关于如何在 Java 中进行对象序列化的文档和示例。`Serializable`通过实现接口，您走在了正确的轨道上。

要实际序列化该类，请查看[ObjectOutputStream](http://docs.oracle.com/javase/6/docs/api/java/io/ObjectOutputStream.html)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-06T16:48:27.967

查看此链接以获取示例代码：[http ://www.tutorialspoint.com/java/java_serialization.htm](http://www.tutorialspoint.com/java/java_serialization.htm)

考虑使用 jaxb 库（java 6 及更高版本的一部分），您可以序列化为 xml，为您提供依赖格式的人类可读的 java。

# java - 在 Matlab 中使用 weka java API 时如何创建字符串属性

> ID：13748312
> 
> 赞同：3
> 
> 时间：2012-12-06T16:40:35.153
> 
> 标签：java, matlab, weka

我想在 Matlab 中将 mat 数据写入 Weka 的 arff 文件。[尽管我了解有关 stackoverflow](https://stackoverflow.com/questions/6639802/creating-a-string-attribute-in-weka-java-api)的问题，但我不知道如何在使用 Weka API 时创建字符串属性。问题是如何在Matlab中实现以下内容：

```
FastVector attributes = new FastVector();
attributes.addElement(new Attribute("attr", (FastVector) null)); 
```

有谁知道如何在 Matlab 中执行上述操作？谢谢

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-24T12:50:22.863

连接matlab和java的时候语法有点奇怪，比如：

*   `new`关键字不存在。
*   对字符串使用单引号。

这归结为知道如何从 matlab 调用 java，这有很多例子：

[[1]](http://www.cs.yale.edu/homes/spielman/ECC/javaMatlab.html) [[2]](https://stackoverflow.com/questions/9520503/calling-java-from-matlab) [[3]](http://www-rohan.sdsu.edu/doc/matlab/techdoc/matlab_external/ch_java.html) [[4]](http://www.cs.virginia.edu/~whitehouse/matlab/JavaMatlab.html)

无论如何，对您而言，解决方案将类似于：

```
import weka.core.FastVector;
import weka.core.Attribute;

fv = FastVector();
attr = Attribute('attr',FastVector());
fv.addElement(attr); 
```

请注意，此代码尚未经过测试，因为我目前没有安装 WEKA。

# java - tomcat 7 访问映射驱动器

> ID：13748314
> 
> 赞同：0
> 
> 时间：2012-12-06T16:40:42.620
> 
> 标签：java, tomcat, zip, jcifs

我知道经常有人问类似的问题。但是解决方案对我不起作用。我确实尝试过 jcifs.jar（版本 1.3.17）。在这里，我发现它非常慢，并且由于某种原因有时会挂起。由于我足够绝望，我可以应付极其缓慢的（并以不可靠的方式祈祷）。但是现在我还有一个问题，我需要压缩网络驱动器上的一些内容。这不适用于 jcifs 或者我不知道如何。我的最佳解决方案是让 copy 调用一个 .bat 来进行复制（这不起作用，因为它找不到驱动器）。并调用 7za.exe 将其压缩（找不到驱动器）。示例代码：

```
public static int SevenZip(String source, String dest, ServletContext context) throws IOException, InterruptedException
{
    String zipFile = "\"" + context.getRealPath("") + "\\WEB-INF\\7za.exe\"";

    String zipInstruction = zipFile + " a " + dest + " " + source;
    Logger.getAnonymousLogger().info(zipInstruction);

    Process process = Runtime.getRuntime().exec(zipInstruction);
    StreamGobbler errorGobbler = new StreamGobbler(process.getErrorStream(), "ERR");
    StreamGobbler outputGobbler = new StreamGobbler(process.getInputStream(), "OUT");
    errorGobbler.start();
    outputGobbler.start();

    return process.waitFor();
} 
```

如果不作为 servlet 完成，该代码将起作用。忽略 StreamGobbler，它只从进程中获取错误和输出流。我在某处读到可以将tomcat设置为Windows身份验证，但我不明白在哪里以及如何。这会帮助我吗？如何？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T09:49:31.683

我找不到 jcifs 的替代品。结果不是最佳的，但似乎还可以。我不认为这是 jcif 更多网络的错，我对此没有影响。

# php - 在 PHP/SQL 查询中过滤价格范围的正确代码

> ID：13748315
> 
> 赞同：0
> 
> 时间：2012-12-06T16:40:42.707
> 
> 标签：php, mysql

真的希望有人可以帮助我。我正在构建一个 PHP / MySQL 搜索表单，希望它允许用户搜索我们的葡萄酒数据库并根据通过下拉菜单选择的价格范围过滤结果。

该表单可以很好地搜索并返回一个很好的准确结果列表。但它不会对结果进行价格过滤。

经过几天的搜索和试验，我已经将各种代码片段组合在一起以达到这一目标，但总的来说，PHP 对我来说仍然是一个谜。

这是我遇到的正确编码和语法。

我如何编码此处发布的 PHP 以正确集成价格范围过滤器？我怀疑我在 sql 查询中包含“pricerange”是离谱的。

*   MySQL 服务器版本：5.1.65-cll
*   价格列类型：小数（10,2）

任何帮助将不胜感激。请检查下面的代码块。

万分感谢！

## HTML

```
 <form  method="post" action="winesearch.php?go" id="searchform"> 
 <input  type="text" size="35" name="user-entry"/>
 <select name="pricerange" size="1" id="pricerange">
    <option value="">Price Range&nbsp;</option>
    <option value="1">$&nbsp;10 - $20</option>
    <option value="2">$&nbsp;21 - $30</option>
    <option value="3">$&nbsp;31 - $50</option>
    <option value="4">$&nbsp;51 - $75</option>
    <option value="5">$&nbsp;76 - $100</option>
    <option value="6">$101 - $200</option>
    <option value="7">$201 - Plus</option>
</select> 
<input  type="submit" name="submit" value="Wine Search"/> 
</form> 
```

## PHP

```
<?php

  if(isset($_POST['submit'])){
  if(isset($_GET['go'])){
  if(preg_match("/^[a-zA-Z0-9]+/", $_POST['user-entry'])){
  $cob=$_POST['user-entry'];
  $pricerange=$_POST['pricerange'];

  //connect to the database
  $db=mysql_connect  ("server", "user", "pass") or die (mysql_error());

  //-select the database to use
  $mydb=mysql_select_db("db_name");

  if($pricerange == 0) $pricerange = 1;

  switch ($pricerange) {
  case 1  :  $pricerange = " where Price BETWEEN 10.00 AND 20.00 ";  break; 
  case 2  :  $pricerange = " where Price BETWEEN 21.00 AND 30.00 ";  break;  
  case 3  :  $pricerange = " where Price BETWEEN 31.00 AND 50.00 ";  break;   
  case 4  :  $pricerange = " where Price BETWEEN 51.00 AND 75.00 ";  break;     
  case 5  :  $pricerange = " where Price BETWEEN 76.00 AND 100.00 ";  break;       
  case 6  :  $pricerange = " where Price BETWEEN 101.00 AND 200.00 ";  break;         
  case 7  :  $pricerange = " where Price > 200.00 ";  break;           
  }

  //-query the database table
  $sql="
    SELECT  ID, 
    CSPC, 
    Country,
    Producer,
    Wine,
    Year,
    Price 
    FROM winecellar WHERE 
    CSPC LIKE '%" . $cob .  "%' 
    OR 
    Country LIKE '%" . $cob ."%'
    OR 
    Producer LIKE '%" . $cob ."%'
    OR 
    Wine LIKE '%" . $cob ."%'
    OR 
    Year LIKE '%" . $cob ."%'
    OR 
    Price LIKE '%" . $pricerange ."%'
    ";

  //-run  the query against the mysql query function
  $result=mysql_query($sql);

  //-create  while loop and loop through result set
  while($row=mysql_fetch_array($result)){
    $CSPC=$row['CSPC'];
    $Country=$row['Country'];
    $Producer=$row['Producer'];
    $Wine=$row['Wine'];
    $Year=$row['Year']; 
    $Price=$row['Price'];
    $ID=$row['ID'];

    //-display the result of the array
echo  "<ul>\n";
echo  "<li>" . $CSPC . "</li>\n";
echo  "<li>" . $Country . "</li>\n";
echo  "<li>" . $Producer . "</li>\n";
echo  "<li>" . $Wine . "</li>\n";
echo  "<li>" . $Year . "</li>\n";
echo  "<li>" . "<a href=" . $Price .  ">" . "$" . $Price . "</a></li>\n";

echo  "</ul>";
  }
  }
  else{
  echo  "<p>Please enter a search query</p>";
  }
  }
  }
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T16:47:54.913

在将查询放在一起之前，您一直都在做。您不需要以下语句中的“位置”，因为您已经在下面构建的查询中拥有它。

```
switch ($pricerange) {
  case 1  :  $pricerange = " Price BETWEEN 10.00 AND 20.00 ";  break; 
  case 2  :  $pricerange = " Price BETWEEN 21.00 AND 30.00 ";  break;  
  case 3  :  $pricerange = " Price BETWEEN 31.00 AND 50.00 ";  break;   
  case 4  :  $pricerange = " Price BETWEEN 51.00 AND 75.00 ";  break;     
  case 5  :  $pricerange = " Price BETWEEN 76.00 AND 100.00 ";  break;       
  case 6  :  $pricerange = " Price BETWEEN 101.00 AND 200.00 ";  break;         
  case 6  :  $pricerange = " Price > 200.00 ";  break;           
}

OR 
Price LIKE '%" . $pricerange ."%' 
```

应该

```
OR ". $pricerange ." 
```

因为您已经在构建 between 语句。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T16:48:44.587

我会在运行之前回显您的 sql 查询，这样您就可以看到它的样子。但似乎价格范围部分的 SQL 部分是错误的。现在它看起来像这样：

```
OR Price LIKE '% where price BETWEEN 10.00 AND 20.00 %' 
```

我想你会希望它看起来像：

```
OR PRICE BETWEEN 10.00 AND 20.00 
```

你想让它成为“或”还是“和”？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-06T16:45:10.097

```
<?php

  if(isset($_POST['submit'])){
  if(isset($_GET['go'])){
   // improved the filter to support space and -
   // Also closed critical security breache (SQL-injection)
  if(preg_match("/^[a-zA-Z0-9 -]+$/", $_POST['user-entry'])){
  $cob=$_POST['user-entry'];
  $pricerange=$_POST['pricerange'];

  //connect to the database
  $db=mysql_connect  ("server", "user", "pass") or die (mysql_error());

  //-select the database to use
  $mydb=mysql_select_db("db_name");

  switch ($pricerange) {
  case 2  :  $pricerange = " AND Price BETWEEN 21.00 AND 30.00 ";  break;  
  case 3  :  $pricerange = " AND Price BETWEEN 31.00 AND 50.00 ";  break;   
  case 4  :  $pricerange = " AND Price BETWEEN 51.00 AND 75.00 ";  break;     
  case 5  :  $pricerange = " AND Price BETWEEN 76.00 AND 100.00 ";  break;       
  case 6  :  $pricerange = " AND Price BETWEEN 101.00 AND 200.00 ";  break;         
  case 7  :  $pricerange = " AND Price > 200.00 ";  break;
  default :  $pricerange = " AND Price BETWEEN 10.00 AND 20.00 "; // covers all other cases
  }

  //-query the database table
  $sql="
    SELECT  ID, 
    CSPC, 
    Country,
    Producer,
    Wine,
    Year,
    Price 
    FROM winecellar WHERE 
    (CSPC LIKE '%" . $cob .  "%' 
    OR 
    Country LIKE '%" . $cob ."%'
    OR 
    Producer LIKE '%" . $cob ."%'
    OR 
    Wine LIKE '%" . $cob ."%'
    OR 
    Year LIKE '%" . $cob ."%')
    " . $pricerange;

  //-run  the query against the mysql query function
  $result=mysql_query($sql);

  //-create  while loop and loop through result set
  while($row=mysql_fetch_array($result)){
    $CSPC=$row['CSPC'];
    $Country=$row['Country'];
    $Producer=$row['Producer'];
    $Wine=$row['Wine'];
    $Year=$row['Year']; 
    $Price=$row['Price'];
    $ID=$row['ID'];

    //-display the result of the array
echo  "<ul>\n";
echo  "<li>" . $CSPC . "</li>\n";
echo  "<li>" . $Country . "</li>\n";
echo  "<li>" . $Producer . "</li>\n";
echo  "<li>" . $Wine . "</li>\n";
echo  "<li>" . $Year . "</li>\n";
echo  "<li>" . "<a href=" . $Price .  ">" . "$" . $Price . "</a></li>\n";

echo  "</ul>";
  }
  }
  else{
  echo  "<p>Please enter a search query</p>";
  }
  }
  }
?> 
```

# php - 在 Zend Framework 中使用多个 ini 文件

> ID：13748318
> 
> 赞同：0
> 
> 时间：2012-12-06T16:41:00.683
> 
> 标签：php, zend-framework, configuration

启动应用程序时进入 index.php。

```
$application = new Zend_Application(
APPLICATION_ENV,
APPLICATION_PATH . '/configs/application.ini'
); 
```

有没有办法在初始化中使用多个“.ini”文件并且不执行任何引导操作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T17:50:50.143

我将此代码插入到我的 index.php 中，它似乎可以工作。

```
require_once 'Zend/Config/Ini.php';

$config = new Zend_Config_Ini (APPLICATION_PATH . '/configs/application.ini', APPLICATION_ENV, array ('allowModifications' => true));
$config->merge (new Zend_Config_Ini (APPLICATION_PATH . '/configs/channels.ini'));

$application = new Zend_Application(
        APPLICATION_ENV,
        $config
); 
```

# asp.net-mvc - MVC App 不再通过 Facebook 登录

> ID：13748327
> 
> 赞同：3
> 
> 时间：2012-12-06T16:41:29.237
> 
> 标签：asp.net-mvc, facebook

我一直在使用 Facebook 插件开发一个应用程序，以使 Facebook 用户能够登录，并且该应用程序可以访问个人资料图片等详细信息。

昨天该应用程序运行良好，我的开发继续正常进行。

今天早上我尝试登录以检查我已经走了多远，并遇到了访问令牌错误消息。

个别部分视图可以正常加载，但整个站点不会。在进一步调查中，我发现登录屏幕正在分配一个新的访问令牌，但是当站点尝试调出母版页时，该令牌为空。

我的登录如下：-

```
<html>
<head>
  <title>Log On</title>
</head>
<body>
  <div id="fb-root"></div>
  <script type="text/javascript">
    window.fbAsyncInit = function() {
      FB.init({
        appId      : '***app no***',
        status     : true, 
        cookie     : true,
        xfbml      : true,
        oauth      : true
      });

      FB.Event.subscribe('auth.login', function () {
        window.location.reload();
      });
    };

    (function(d){
       var js, id = 'facebook-jssdk'; if (d.getElementById(id)) {return;}
       js = d.createElement('script'); js.id = id; js.async = true;
       js.src = "//connect.facebook.net/en_US/all.js";
       d.getElementsByTagName('head')[0].appendChild(js);
     }(document));
  </script>
  <div class="fb-login-button" data-scope="email">
    Login with Facebook
  </div>
 </body>
 </html> 
```

这让我头疼。

返回的错误是 (OAuthException) 必须使用活动访问令牌来查询有关当前用户的信息。

希望这是有人找到解决方案的足够信息。

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T01:45:25.293

您尚未设置频道网址，即您的网站路径（可以是本地主机或服务器域）

```
<script type="text/javascript">
window.fbAsyncInit = function() {
  FB.init({
    appId      : '***app no***',
    channelUrl : '//WWW.YOUR_DOMAIN.COM/channel.html', // Channel File for x-domain communication
    status     : true, 
    cookie     : true,
    xfbml      : true,
    oauth      : true
  }); 
```

您还必须在 developer.facebook.com 中设置您的 url 路径，从那里获得您的 app-id .....

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-18T15:24:17.650

我知道这有点旧，但这可能对其他人有所帮助。最终找到了答案。在控制器中，我需要以下内容：-

```
var client = new FacebookClient(Session["FacebookToken"].ToString());    

dynamic me = client.Get("me"); 
```

这得到了一个活动令牌，允许我再次访问信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-12T14:29:52.177

好的，发现一些信息表明在 12 月初对 Facebook SDK 所做的更改将导致我的问题。根据给出的建议，我在我的项目中对 Facebook 参考进行了参考更新。这已从 Web.config 中删除了 facebookSettings 行，并且以下错误消息现在在警告框中出现了六次。

> 对“Facebook.IFacebookApplication”类型的引用声称它在“\packages\Facebook.6.1.4\lib\net40-client\Facebook.dll”中定义，但在 \packages\FacebookWeb.5.4.1.0\lib 中找不到\net40\Facebook.Web.dll

并在尝试运行程序时产生以下错误

> 异常详细信息：System.TypeLoadException：无法从程序集“Facebook，版本=6.0.10.0，文化=中性，PublicKeyToken=58cb4f2111d1e6de”加载类型“Facebook.FacebookApplication”。
> 
> ```
> Source Error: 
> 
> Line 12:     public class HomeController : Controller
> Line 13:     {
> Line 14:         FacebookWebContext FBWebContext = new FacebookWebContext();
> Line 15:         FacebookWebClient FBWebClient = new FacebookWebClient();
> Line 16: 
> ```

# vb.net - “dim x() as byte”是否等同于“dim x as byte()”？

> ID：13748332
> 
> 赞同：4
> 
> 时间：2012-12-06T16:41:46.383
> 
> 标签：vb.net

> **可能重复：**
> [Dim files() As String 和 Dim files As String() 之间有什么不同？](https://stackoverflow.com/questions/2242000/whats-different-between-dim-files-as-string-and-dim-files-as-string)

这两个陈述是等价的吗？它们的行为似乎相同，但产生的“x”有区别吗？

```
Dim x() As Byte
Dim x As Byte() 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-06T16:46:51.147

它们完全一样，如果你用反射器检查它们，你可以看到。它们都编译为相同的 IL。

另请参阅[此问题](https://stackoverflow.com/questions/2242000/vb-net-what-different-of-dim-files-as-string-and-dim-files-as-string?rq=1)，如果您更改`Byte`为`String`.

# grails-orm - 如何在 Grails 的 joinTable 中避免改进命名策略

> ID：13748336
> 
> 赞同：0
> 
> 时间：2012-12-06T16:41:53.807
> 
> 标签：grails-orm, grails-2.0

我有一个无法更改的旧数据库，并且我有这个设置

```
class Foo {

    static hasMany = [bars:Bar]

    static mapping = {
    version false

    columns {
        id column: "FooId"
        color column: "FooColor"

        bars joinTable: [name: "FooBar", key: 'FooId', column: 'BarId']
    }

    transient
    def getBarName(){
       ((Bar)this.bars.toArray()[0]).name
    }
 }

class Bar {

    static hasMany = [foos:Foo]

    static belongsTo = [Foo, Baz]

    static mapping = {
    version false

    columns {
        id column: "BarId"
        name column: "BarName"
    }
 } 
```

当我尝试访问控制器中的方法 getBarName() 时，Hibernate 会将反列名称转换为“bar_id”。是否有某种方法可以设置像 id 和 property 列的映射？

顺便说一句。如何正确实现 getBarName()？这不可能是正确的实现......

****编辑****
**----------------------------------------------------------- ------------------------------------**
显然我上面不清楚。问题是我已经有一个连接列，其形式为

```
-------------------
|RowId|FooId|BarId|
-------------------
|  1  | abc | 123 |
------------------- 
```

**Benoit 的**答案在这种情况下并不适用，因为我想避免为 joinTable 提供域对象。

****编辑 2* ***
**---------------------------------------------- ------------------------**
解决了。虽然不明白...但是在两个域类之间拆分连接表信息并且它可以工作...

```
class Foo {

    static hasMany = [bars:Bar]

    static mapping = {
    version false

    columns {
        id column: "FooId"
        color column: "FooColor"

        bars joinTable: [name: "FooBar", key: 'FooId']
    }

    transient
    def getBarName(){
       ((Bar)this.bars.toArray()[0]).name
    }
 }

class Bar {

static hasMany = [foos:Foo]

    static belongsTo = [Foo, Baz]

    static mapping = {
    version false

    columns {
        id column: "BarId"
        name column: "BarName"

        bars joinTable: [name: "FooBar", key: 'BarId']
    }
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T17:45:47.590

如文档[多对一/一对一映射和一对多映射中](http://grails.org/doc/latest/guide/GORM.html#ormdsl)所述：

> 使用双向一对多，您可以根据上一节中关于一对一关联的示例，通过更改关联多方的列名来更改所使用的外键列。但是，对于单向关联，需要在关联本身上指定外键。

你给出的例子是：

```
class Person {
String firstName
static hasMany = [addresses: Address]
static mapping = {
        table 'people'
        firstName column: 'First_Name'
        addresses column: 'Person_Address_Id'
    }
} 
```

# c - 如何在 C 中的函数中使用 realloc

> ID：13748338
> 
> 赞同：37
> 
> 时间：2012-12-06T16:42:02.453
> 
> 标签：c, arrays, malloc

以我在这里学到的知识为基础：[通过 C 中的函数操作动态数组](https://stackoverflow.com/questions/13746067/manipulating-dynamic-array-through-functions-in-c)。

```
void test(int data[])
{
    data[0] = 1;    
}    

int main(void)
{    
    int *data = malloc(4 * sizeof *data);

    test(data);

    return 0;
} 
```

这工作正常。但是，我也在尝试`realloc`在函数中使用。

```
void increase(int data[])
{
    data = realloc(data, 5 * sizeof *data);    
} 
```

这符合但程序在运行时崩溃。

**问题**

我应该如何在函数中使用 realloc？

我知道我应该将结果分配`realloc`给一个变量并检查它是否是`NULL`第一个。这只是一个简化的例子。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-12-06T16:43:29.013

您想修改`int*`（您的数组）的值，因此需要将指向它的指针传递给您的`increase`函数：

```
void increase(int** data)
{
    *data = realloc(*data, 5 * sizeof int);
} 
```

调用代码将如下所示：

```
int *data = malloc(4 * sizeof *data);
/* do stuff with data */
increase(&data);
/* more stuff */
free(data); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-06T16:54:50.703

请记住指针和数组之间的区别。
数组是堆栈中的一块内存，仅此而已。如果您有一个数组：

```
int arr[100]; 
```

那么 arr 是一个内存地址，&arr 也是一个内存地址，而且那个内存地址是不变的，不存储在任何位置。所以你不能说 arr=NULL，因为 arr 不是指向某个东西的变量。它只是一个符号地址：数组开始的地址。相反，指针有它自己的内存并且可以指向内存地址。

将 int[] 更改为 int* 就足够了。
此外，变量是通过副本传递的，因此您需要将 int** 传递给函数。

关于如何使用 realloc，所有的教学示例都包括：

1.  使用重新分配；
2.  检查它是否为NULL。在这种情况下使用perror并退出程序；
3.  如果它不为 NULL，则使用分配的内存；
4.  不再需要时释放内存。

所以这将是一个很好的例子：

```
int* chuck= (int*) realloc (NULL, 10*sizeof(int)); // Acts like malloc,
              // casting is optional but I'd suggest it for readability
assert(chuck);
for(unsigned int i=0; i<10; i++)
{
    chunk[i]=i*10;
    printf("%d",chunk[i]);
}
free(chunk); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2017-05-19T13:23:54.157

这两个代码都非常有问题，如果您使用相同的指针从 realloc 发送和接收，如果失败，您将失去稍后释放它的指针。

你应该做这样的事情：

{ ... ...

```
more = realloc(area , size);
if( more == NULL )
    free(area);
else
    area=more; 
```

……

}

# web - 从数据包中检索到的远程 IP 地址的准确性

> ID：13748341
> 
> 赞同：0
> 
> 时间：2012-12-06T16:42:07.127
> 
> 标签：web, http-headers, ip, packet

如果可以从我的 Apache2 服务器接收到的数据包中检索远程 IP（也许通过自定义插件），它是否总是能保证准确？或者这个值是否像引用标题一样容易被欺骗？

我的预期用例是对未经身份验证的 API 调用进行速率限制。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T16:44:07.343

它不可靠。不仅因为它可以被欺骗，还因为一个网络元素可以让你的服务器看到不同的 IP 地址。

例如，在公司中通过代理访问 Internet 是非常典型的。根据配置，从您的服务器的角度来看，所有不同的用户都来自同一个 IP 地址。

在任何情况下，您都可以在许多情况下使用过滤器。例如，当您检测到来自同一 IP 地址的登录请求过多时，显示验证码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T16:55:56.503

如果它是一个 TCP 数据包，那么它对于发送主机将是准确的。除非您控制了相关的路由器，否则 TCP 数据包中的 IP 不能被欺骗。对于欺骗的源数据包，只有最初的 SYN 数据包会返回，然后来自服务器的 SYN+ACK 响应将发送到欺骗地址，而不是伪造的地址 - 例如，您不能进行完整的 3 次握手，除非您可以控制来自目标机器的数据包路由。

另一方面，UDP 数据包可以很容易地被伪造，你不能相信任何关于它们的东西。

同样，即使是代理服务器和 NAT 网关之类的简单事物也可以掩盖数据包起源的“真实”IP。您将获得一个 IP，但它将是网关/代理的 IP，而不是原始机器的 IP。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-07T00:10:28.157

如果您打算对无效 API 调用进行速率限制，您可能需要考虑使用[spamhaus 之](http://www.spamhaus.org/)类的服务。他们列出了可能是机器人和探测器的 IP。还有其他公司和名单。但是，如果您的意图是识别“坏人”，则源 IP 不太可能是正确的。

# git - GIT_MERGE_AUTOEDIT=no 默认情况下

> ID：13748344
> 
> 赞同：6
> 
> 时间：2012-12-06T16:42:23.793
> 
> 标签：git, options

在我的 git (v 1.7.10.2) 中，我必须在终端中执行以下操作：

```
 GIT_MERGE_AUTOEDIT=no
 export GIT_MERGE_AUTOEDIT 
```

所以，每次我合并时，我都不会强制发布消息。

我应该把它放在哪里，所以默认情况下它会设置好，而且每次我在 MAC 中打开终端时都不必输入它？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-12-06T16:53:41.110

你可以把它放在：

```
.bash_profile 
```

打开终端

```
nano $HOME/.bash_profile 
```

并添加行

```
export GIT_MERGE_AUTOEDIT=no 
```

不要忘记打开一个新终端以使其正常工作。

# ios - NSManagedObjectContext insertObject - 字符串存储为空

> ID：13748349
> 
> 赞同：1
> 
> 时间：2012-12-06T16:42:31.880
> 
> 标签：ios, core-data, nsmanagedobject, nsmanagedobjectcontext

我想通过 insertObject 方法将先前创建的具有一些字符串属性的 NSManagedObject 插入到我的 NSManagedObjectContext 中。这似乎可以正常工作，但是当我再次重新加载保存的对象时，我的所有字符串属性都为空。

我创建了我的实体：

```
[[NSManagedObject alloc] initWithEntity:description 
         insertIntoManagedObjectContext:nil]; 
```

感谢任何建设性的反馈。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T10:04:57.163

不建议插入“以前创建的”托管对象，因为在创建期间插入它会更加健壮。

如果您想**复制**一个托管对象（即“再次插入”），在持久存储中有效地创建它的**两个实例**，您将必须创建一个新实例，然后复制所有属性。

**编辑：**

作为对反对票和继续讨论的回应，我必须强调*将对象插入上下文*然后在需要*时将其删除当然更合理。*这只是实现您想要的更直观和记录的方式。

我强烈建议不要在您的用例中创建无上下文的托管对象！

# c++ - RedHatLinux：是否可以以编程方式加载 libcert.so 共享对象？

> ID：13748351
> 
> 赞同：0
> 
> 时间：2012-12-06T16:42:41.283
> 
> 标签：c++, c, linux

早上好，RedHatLinux：是否可以通过编程方式加载 libcert.so 共享对象？在大多数 RedHat Linux 安装中，存在一个名为 libcert.so 的 TCP-IP 库，可以使用 yum install XXXX 进行安装 假设某软件公司希望独立构建 libcert.so 并将其与其他产品一起发布，则有必要以编程方式加载 libcert.so 然后检索指向 libcert 库的公共接口的函数指针？谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-06T16:47:05.270

是的，使用`dlopen`& `dlsym`。这是一个[如何](http://tldp.org/HOWTO/Program-Library-HOWTO/index.html)。

# jsf - JSF CDI（焊接）开始新的对话

> ID：13748356
> 
> 赞同：2
> 
> 时间：2012-12-06T16:42:46.797
> 
> 标签：jsf, cdi, codi

我只是想知道如何在 CDI 中开始新的对话。如果没有 cid 请求参数，容器似乎开始了一个新的对话，但在某些情况下，我想从我的控制器显式地开始一个新的对话。

示例：JSF 页面用于编辑会话范围控制器 bean 的实体保持。提交了一个 ajax 请求，调用控制器的方法，该方法触发一个事件，传递一个子实体，该子实体应在新对话中的不同控制器中编辑。我找不到该问题的解决方案。我已经研究了 Apache Myfaces CODI，但也找不到解决该问题的模式。

请帮我解决这个问题。

**[编辑]** 好的。也许我没有足够详细地描述问题。再试一次：如果我想访问具有不同（新）对话 ID 的“相同”对话范围控制器 bean 的新实例。这是如何运作的？您拥有的图像.. 可以说.. 一个 OrderControllerBean 来编辑一个 Order 实体。这个控制器有一个 JSF 操作方法，比如 public void createSubOrder()。这个方法应该创建一个新订单并用它做一些花哨的事情。之后，它应该被传递给具有不同对话 ID 的新 OrderControllerBean 实例。也许通过使用 CDI 事件。没关系。问题是：我的对话中已经存在 OrderControllerBean。它用于编辑当前订单。所以它不能用于创建和编辑我们刚刚创建的子订单。那么如何创建 OrderControllerBean 的新实例呢？也许这不是正确的方法。但到目前为止，如果不将浏览器发送到带有空白 cid 参数的新 url，我找不到另一个可能来创建新对话。但后来我无法在这些对话之间交换信息。如何将会话 1 中创建的非持久订单带到会话 2 中的同一控制器？我的问题只是关于对话的对话。如何将会话 1 中创建的非持久订单带到会话 2 中的同一控制器？我的问题只是关于对话的对话。如何将会话 1 中创建的非持久订单带到会话 2 中的同一控制器？我的问题只是关于对话的对话。

**[编辑]** 到目前为止，我阅读了整个文档以及随附的所有示例。根据这些陈述（http://docs.jboss.org/cdi/spec/1.0/html/contexts.html#conversationcontext），CDI 对话似乎与 JSF 密切相关。不幸的是，我找不到更深入技术细节的文档。由于没有其他方法可以像发送新请求一样获得新对话，因此有必要在视图层中直接保留有关新对话如何以及何时开始的逻辑。这绝对不是我能想象的最好的方式。我的下一个尝试是评估 Seam 3，因为我记得 Seam 2 中有一些 @Begin 和 @End 注释可以更好地控制对话。还有一些标签库可让您指定对话传播。我想知道为什么没有其他人对我有类似的问题。要么 CDI 目前对于复杂的项目还不是很普遍，要么我在理解事情应该如何工作时遇到了很大的问题。到目前为止，我找不到任何 CDI/CODI 示例，而不仅仅是一个简单的演示。如果有人有一个示例的链接，该示例显示了对话的高级使用，无论使用哪个便携式扩展，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-08T00:00:46.917

使用 CODI 可以自动开始 bean 的对话。只要您访问它。您可以同时进行多个对话。标准。CDI 对话更像是 CODI 的窗口范围。但即使在这里，CODI 也更好。

标准。CDI 对话需要#begin，但是当涉及到验证错误时，这是​​一个问题。在这种情况下，您会一遍又一遍地创建 bean。我放弃了标准的使用。两周后的 CDI 对话，因为在许多比一日演示更复杂的应用程序案例中，它们完全被破坏了。我发现[http://os890.blogspot.co.at/2011/04/slides-codi-conversations.html](http://os890.blogspot.co.at/2011/04/slides-codi-conversations.html)帮助我理解了为什么 CODI 团队做自己的 CDI 范围。

此外，您所描述的对于 CODI 来说也很容易。

**[编辑]：** 如果没有第二个 bean，您在“编辑”中添加的内容根本无法工作，但您永远不会获得新的窗口 ID。如果您只需要会话范围 bean 的新（/重新启动）实例，您可以使用：org.apache.myfaces.extensions.cdi.core.api.scope.conversation.Conversation#restart 您需要一个调用的第二个 bean比如controller#getXyz controller#restart（它本身调用Conversation#restart），然后是controller#setXyz。但是，您尝试做的事情听起来很肮脏。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-07T19:48:31.057

“触发事件”是什么意思？JSF、ajax、CDI 事件？
为什么要为您的子实体开始新的对话？
我认为您应该以某种方式从客户端请求子实体编辑页面而不附加 cid。使子实体的控制器获得新的瞬态会话。然后你可以用它的方法开始它`@PostConstruct`。AFAIK 你不能在同一个请求中开始新的（或重新开始）对话。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T18:13:01.490

```
 @Inject
   private Conversation conversation;

conversation.begin();
conversation.end(); 
```

很容易谷歌这个？究竟是什么问题？

# java - 如何让程序等待按钮按下

> ID：13748362
> 
> 赞同：0
> 
> 时间：2012-12-06T16:42:57.323
> 
> 标签：java, android, eclipse

我创建了一个 android 应用程序，我想暂停正在运行的代码并等待按下按钮。

例如，假设我有 3 个按钮，Button1 Button2 Button3。我想要做 ：

```
int a=0;
// do something
.. wait for button press..
if(button1 is pressed) a=1;
else if(button2 is pressed) a=2;
else if(button3 is pressed) a=3;
// continue 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T16:45:07.403

这不是 Android 应用程序开发的工作方式，也不是大多数现代 UI 框架上的应用程序开发（这里的“现代”是指“在过去 25 年中编写的”）。与大多数其他平台和 UI 框架一样，Android 的小部件框架是事件驱动的。请修改您的算法，以便能够通过`onClick()`各种按钮的方法进行处理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T16:47:39.063

以下是我将如何做到的：

首先，让您的活动实现 onClickListener

```
public class CustomButton extends Activity implements OnClickListener{ 
```

OnClickListener 有 1 个方法可以覆盖，

```
@Override
public void onClick(View v) {
    switch(v.getId()){
      case r.id.button1:
        a=1;
        break;
      case r.id.button2:
        a=2;
        break;
      case r.id.button3:
        a=3;
        break;
} 
```

请注意，r.id.button1 等是指您为布局文件中的按钮提供的 ID

# actionscript-3 - AS3 用 switch 语句替换 if 和 else if

> ID：13748364
> 
> 赞同：4
> 
> 时间：2012-12-06T16:42:59.247
> 
> 标签：actionscript-3, switch-statement

我正在尝试用*switch语句替换我的**if*和*else if*语句。

 *Ball 类来自一个外部动作脚本文件，女巫有一个变量，我在其中传递球半径（半径 = 30）。

**如何将 if 和 else if 语句转换为 switch 语句？**

编码：

```
private var ball:Ball;

private var left:Number = 0;
private var right:Number = stage.stageWidth;
private var top:Number = 0;
private var bottom:Number = stage.stageHeight;    

    if(ball.x >= right + ball.radius)
    {
        ball.x = left - ball.radius;
    }

    else if(ball.x <= left - ball.radius)
    {
        ball.x = right + ball.radius;
    }

    if(ball.y >= bottom + ball.radius)
    {
        ball.y = top - ball.radius;
    }

    else if(ball.y <= top - ball.radius)
    {
        ball.y = bottom + ball.radius;
    } 
```

**谢谢**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T17:02:53.230

这有一个小技巧 - 你在 case 而不是 switch 处评估不等式：

```
 switch(true) {
     case ball.x >= right + ball.radius:
         ball.x = left - ball.radius;
         break;
     case ball.x <= left - ball.radius:
         ball.x = right + ball.radius;
         break;
 }

switch(true){
     case (ball.y >= bottom + ball.radius):
         ball.y = top - ball.radius;
         break;
     case (ball.y <= top - ball.radius):
         ball.y = bottom + ball.radius;
         break;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T17:06:39.553

将 switch 语句视为美化的 IF。
基本上，您正在评估 switch 语句到 case 语句。
Switch 语句以自上而下的顺序进行评估，因此一旦找到匹配项，它将在该情况下的代码运行后脱离 switch。
另外，在您的情况下，您希望将 X 和 Y 分开

```
switch(true){
  case (ball.x >= right + ball.radius):
    ball.x = left - ball.radius;
    break;
  case (ball.x <= left - ball.radius):
    ball.x = right + ball.radius;
    break;
  default:
    // no match
}

switch(true){
  case (ball.y >= bottom + ball.radius):
    ball.y = top - ball.radius;
    break;
  case (ball.y <= top - ball.radius):
    ball.y = bottom + ball.radius;
    break;
  default:
    // no match
} 
```*

# java - System.getenv() 没有列出所有的环境变量

> ID：13748367
> 
> 赞同：6
> 
> 时间：2012-12-06T16:43:07.687
> 
> 标签：java, variables, system, environment

我注意到我的一些环境变量没有被 JVM 拾取。

在我的`.bash_profile`我定义了以下内容：

```
IO_HOME='some_value'
export IO_HOME 
```

并通过在 shell 中执行：

```
echo $IO_HOME 
```

我得到正确的结果。

但既没有`System.getProperties()`也没有`System.getenv()`显示这个变量被设置。我尝试了 Java 6 和 Java 7。

有什么我想念的吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-06T17:00:37.683

将环境导出到衍生进程非常稳定；如果`System.getenv()`不包含变量，那是因为它不在环境中。需要检查的几件事都与流程的启动方式有关：

*   您是否从导出变量的环境启动 java 进程？例如，如果它在您的 .bash_profile 中，并且您正在从菜单或桌面执行 java 程序，那么您必须在将其添加到 .bash_profile 后注销并登录才能看到该变量。

*   变量是否从流程的环境中显式删除？[ProcessBuilder](http://docs.oracle.com/javase/7/docs/api/java/lang/ProcessBuilder.html)允许这样做，大多数生成进程的 API 也是如此。

要尝试的一件事是在确保变量在该 shell 中导出之后，从命令行 shell 启动该过程。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-10-02T07:28:54.597

在 Windows 中，我最近看到一些疯狂的行为，即 IntelliJ`System.getenv()`在设置用户或系统环境变量后拒绝显示所有环境变量。诀窍是从 DOS 框启动 IntelliJ。对于 Windows 用户：也许重新启动（或注销/登录）将解决问题。

# safari - 使用border-radius时safari 6.0.2中的波纹css边框

> ID：13748373
> 
> 赞同：0
> 
> 时间：2012-12-06T16:43:17.483
> 
> 标签：safari, webkit, css

根据标题，我在 Safari 上遇到了一个非常奇怪的问题，不确定它是否是众所周知的问题，但我真的不知道如何研究有关它的其他线程。

我创建了一些 css 按钮，它们在 chrome、firefox 和另一个版本的 safari 上看起来很整洁，我在视网膜 macbook pro (6.0) 上测试过

这是按钮在最新浏览器上的外观：http: [//d.pr/i/cHzX](http://d.pr/i/cHzX)

但是，我的 macbook air 运行 safari 6.0.3，这就是 Safari 6.0.3 显示边界的方式：http: [//d.pr/i/fcfl](http://d.pr/i/fcfl)

有谁知道如何修复这种错误？

这是生成这些按钮的 css (sass)：

```
 .button{
      position:relative;
      z-index:1;
      display:block;
      width:175px;
      margin:0 15.5px;
      cursor:pointer;

      span{

        @include border-radius(9999em);
        display:block;
        width:175px;
        height:48px;
        line-height:48px;
        font-size:1.4em;
        font-weight:bold;
        color:#FFF;

        &:before{
          @include border-radius(9999em);

          margin-top:5px;
          content:'.';
          text-indent:-9999em;
          position:absolute;
          z-index:-1;
          top:0;
          left:0;
          width:177px;
        }
      }

      &:active{
        outline:none;
        top:4px;

        span{
          &:before{
            top:-4px;
          }
        }

      }

      &:focus{
        outline:none;
      }
    }

    .orange-button span{
      @include background(linear-gradient(#FDAC26, #FB6336));
      border:1px solid #6B2B10;
      text-shadow:0 1px 0 #6B2B10;

      &:before{
        background:#AF431D;
        color:#AF431D;
        border-bottom:1px solid #6B2B10;
      }
    }

    .green-button span{
      @include background(linear-gradient(#7EC84B, #73B543));
      border:1px solid #3B5A22;
      text-shadow:0 1px 0 #3B5A22;

      &:before{
        background:#649039;
        color:#649039;
        border-bottom:1px solid #3B5A22;
      }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T18:05:21.170

将以下内容添加到您拥有border-radius的每个css类中：9999em

```
-webkit-border-radius:9999em;
-moz-border-radius:9999em; 
```

safari 和 chrome 使用 -webkit 和 -moz 用于我的 mozilla。

# javascript - 从 iframe 内部获取 iframe url 变量

> ID：13748375
> 
> 赞同：0
> 
> 时间：2012-12-06T16:43:25.797
> 
> 标签：javascript, jquery

如果可能的话，我想使用 jquery/javascript 并在 iframe 中获取一个 url 变量 frim

我的 iframe 链接如下所示 - 源动态变化

```
<iframe class="box" src="lightbox.html?img=images/lightbox/blue-shoes.jpg" scrolling="no" frameborder="0"></iframe> 
```

然后，从 lightbox.html iframe 内部 - 我想获取 img (images/lightbox/blue-shoes.jpg) 变量并更改图像的来源

问题是 - 我不知道如何从 iframe 内部获取 iframe 源 url 变量

我试图避免使用 php

我已经将它用于类似的东西，但无法让它工作

```
function getUrlVars() {
var vars = {};
var parts = document.referrer.replace(/[?&]+([^=&]+)=([^&]*)/gi, function(m,key,value) {
    vars[key] = value;
});
return vars;
}
var first = getUrlVars()["ref"]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T17:46:55.363

如果您在 iframe 中控制脚本，这里是一个使用 document.location.herf 而不是referrer 的示例。灯箱.html：

```
<html>
<head>
<script>

    function getUrlVars() {
    var vars = {};
    var parts = document.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi, function(m,key,value) {
            vars[key] = value;
    });
    return vars;
    }
    var first = getUrlVars()["img"];
    alert(first);
    var test = function(){
        first = 'images/red.jpg'
        alert(first);
    }
</script>

</head>
<body>
    <div>Inside</div>
    <button onclick="test()">change url</button>
</body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T17:30:49.823

要使用 JQuery 执行此操作，请尝试此操作。

您的页面 lightbox.html 上的图像，给它广告 id 例如

```
<img id="ImageID" src="whatever" /> 
```

然后使用这个 JQuery 来改变 src 属性

```
$('#ImageID').attr('src', 'whatever'); 
```

更新

实际上，由于它是 IFrame，因此这可能行不通我相信由于[相同的来源政策，您将不会被允许这样做](http://en.wikipedia.org/wiki/Same_origin_policy)

# ruby-on-rails-3 - 谷歌可视化没有出现在heroku生产中

> ID：13748379
> 
> 赞同：1
> 
> 时间：2012-12-06T16:43:33.270
> 
> 标签：ruby-on-rails-3, heroku, google-visualization

我已经实现了[google_visualr](https://github.com/winston/google_visualr) gem，它在开发中完美运行。但是，当我推送到 heroku 时，不会显示可视化。所有 javascript 都存在，并且应用程序日志中没有错误或指示。

这是生成的javascript。它与 dev 完全相同。我是否需要做任何额外的事情才能让谷歌可视化在 heroku 环境中运行？

```
 <script type='text/javascript'>
  google.load('visualization','1', {packages: ['corechart'], callback: function() {
    var data_table = new google.visualization.DataTable();data_table.addColumn('string', 'Status');data_table.addColumn('number', 'Count');data_table.addRow([{v: 'Started Applications'}, {v: 10}]);data_table.addRow([{v: 'Completed Applications'}, {v: 1}]);
    var chart = new google.visualization.PieChart(document.getElementById('pie_chart'));
    chart.draw(data_table, {width: 360, height: 240, title: 'Applications Status Summary', is3D: true, legend: 'bottom'});
  }});
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T17:49:33.723

我发现问题是我对 google jsapi 的调用不安全，因此浏览器阻止了请求。

```
<script src='http://www.google.com/jsapi'></script> 
```

我可以通过使用 https 以安全模式请求 jsapi 来解决此问题

```
<script src='https://www.google.com/jsapi'></script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T02:36:52.163

让可视化在 Heroku 上工作不需要做任何额外的事情。

演示站点也托管在 Heroku 上：http: [//googlevisualr.herokuapp.com/examples/interactive/pie_chart](http://googlevisualr.herokuapp.com/examples/interactive/pie_chart)

只是检查一下，这是在页面顶部的*head标记中吗？*

```
<script src='http://www.google.com/jsapi'></script> 
```

# sql-server - SharePoint 2013 - 新的 BI 语义模型连接 - 无法连接到服务器或数据库

> ID：13748382
> 
> 赞同：1
> 
> 时间：2012-12-06T16:43:41.910
> 
> 标签：sql-server, sharepoint, ssas, sharepoint-2013, powerview

全部在一台机器上，我有：

*   视窗 2012
*   在表格模式下运行 SSAS 的 SQL Server 2012
*   为 AdventureWorksDW 数据库创建的 SSAS 表格模型
*   共享点 2013

使用 Excel 2013，我可以毫无问题地连接到 SSAS 表格模型。

当我尝试在 SharePoint 2013 中创建“新的 BI 语义模型连接”以连接到 SSAS 表格模型时，我收到此错误：“无法连接到服务器或数据库。”

我可以单击“保存链接文件而不进行连接验证”，但是 Power View 也无法使用保存的连接。

当我收到上述错误时，我还在 Windows 事件查看器中看到用户“NT SERVICE\MSSQLServerOLAPService”的“审核失败”事件。

所有 SharePoint 服务都以本地管理员帐户运行。该帐户已成为 SSRS 服务器的管理员，并在 SSAS 表格模型中分配了一个角色。我为“NT SERVICE\MSSQLServerOLAPService”帐户做了同样的事情，但没有运气。

我在某处错过了其他安全配置设置吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-04T16:00:30.880

右键单击分析服务器属性，然后选择安全添加服务帐户作为服务器管理员

# xcode - 禁用自动布局时，“无法实例化名为 NSLayoutConstraint 的类”

> ID：13748383
> 
> 赞同：0
> 
> 时间：2012-12-06T16:43:43.363
> 
> 标签：xcode, ios5, ios-simulator

当我在新视图上调用 presentModalViewController 并出现错误时，我的应用程序在 iOS 5 上崩溃：

> 由于未捕获的异常“NSInvalidUnarchiveOperationException”而终止应用程序，原因：“无法实例化名为 NSLayoutConstraint 的类”

我知道这个错误应该通过取消选中自动布局来解决，但事实并非如此。我在我所有的笔尖中都没有选中它。

非常令人费解的是，使用我一个月前创建的视图，没有崩溃，但使用我今天创建的视图，它崩溃了。

还有其他我应该知道的设置吗？

我正在使用 XCode 4.5.2、SDK 6.0 和部署目标 5.0。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T11:55:15.700

我想你现在已经解决了这个问题。但是对于其他会偶然发现这篇文章的人，请查看这篇文章：[https ://stackoverflow.com/a/13201690/942966](https://stackoverflow.com/a/13201690/942966)

# linux - KGDB远程调试错误

> ID：13748385
> 
> 赞同：3
> 
> 时间：2012-12-06T16:43:51.750
> 
> 标签：linux, debugging, linux-kernel, gdb, kernel

我正在尝试使用 kgdb 调试 Linux 内核。我正在使用 qemu 作为目标机器。Ubuntu 12.04 是我的主机操作系统。我试过这个命令

```
cyborg@skynet:~$ qemu-system-arm -M versatilepb -m 128M -kernel zImage -initrd rootfs.img.gz -append "root=/dev/ram rdinit=/bin/sh kgdboc=ttyAMA0,115200 kgdbwait" 
```

它将启动并等待显示

> **kgdb：等待来自远程 gdb 的连接**

当我尝试使用命令在 linux 主机上使用 gdb 进行调试时

```
cyborg@skynet: arm-none-linux-gnueabi-gdb vmlinux 
```

(gdb): 设置远程波特率 115200

(gdb) target remote /dev/ttyS0 使用 /dev/ttyS0 进行远程调试忽略数据包错误，继续...

警告：“qSupported”响应中无法识别的项目“超时”

忽略数据包错误，继续...

忽略数据包错误，继续...

忽略数据包错误，继续...

忽略数据包错误，继续...

偏移量查询响应错误，超时

> **我并没有真正得到我所缺少的！**

PS 我在启用 KGDB 选项的情况下编译了 linux 内核 2.6.39.4。我按照[这些](http://balau82.wordpress.com/2010/03/27/busybox-for-arm-on-qemu/)说明在 qemu 上运行内核。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T22:45:04.577

如果您`/dev/ttyS0`在主机上引用`gdb`将尝试使用存在的物理串行端口。您必须将`qemu`的模拟串行端口连接到`gdb`。阅读手册，显然您可以通过在命令行中`qemu`添加以下内容来将模拟端口重定向到 tcp 网络。然后您可以使用.`-serial tcp::1234,server``qemu``gdb``target remote :1234`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T12:54:03.527

在 Qemu 中运行时没有真正的理由使用 kgdb。您可以简单地在 Qemu 命令行上指定类似“-gdb tcp::8888”的内容并激活 GDB 存根。然后，您可以使用支持 ARM 的 GDB 连接到存根：

```
 target remote:8888 
```

并调试。您可能会发现以下[gdb 帮助脚本很有用](http://git.kiszka.org/?p=linux-2.6.git;a=shortlog;h=refs/heads/queues/gdb-scripts)

# java - 调用java类时出现异常

> ID：13748386
> 
> 赞同：1
> 
> 时间：2012-12-06T16:43:52.197
> 
> 标签：java

我有这个类，它不能在 eclipse 中作为 java 应用程序运行。有人知道问题是什么吗

```
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.util.ArrayList;
import java.util.List;

import org.apache.http.HttpResponse;
import org.apache.http.NameValuePair;
import org.apache.http.client.HttpClient;
import org.apache.http.client.entity.UrlEncodedFormEntity;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.message.BasicNameValuePair;

import android.test.AndroidTestCase;
import android.util.Log;

public class ClientApp{

    public static void main(String args[]){
        ClientApp client = new ClientApp();
        client.checkLogin("system/system", "system");

    }
    private static final String TAG = ClientApp.class.getSimpleName();

    public static String checkLogin(String username, String password) {

        String retVal = "";
        HttpClient client = new DefaultHttpClient();
        HttpPost post = new HttpPost("http://192.168.101.27/pdxapi/service/rest/ClientApp/checkLogin");
        try {
            String hashedPw = DigestFactory.calculatePasswordHash(password);
            Log.i(TAG, "----hashed pw is: " +  hashedPw);
            List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(2);
            nameValuePairs.add(new BasicNameValuePair("username",   username));
            nameValuePairs.add(new BasicNameValuePair("password",   hashedPw));
            post.setEntity(new UrlEncodedFormEntity(nameValuePairs));

            HttpResponse response = client.execute(post);
            if (response.getEntity() == null){

                retVal = "";                
            }
            else{
                BufferedReader rd = new BufferedReader(new InputStreamReader(response.getEntity().getContent()));
                StringBuffer sb = new StringBuffer();
                String line = "";
                while ((line = rd.readLine()) != null) {
                    sb.append(line);
                }               
                retVal = sb.toString();             
            }

        } catch (IOException e) {
            Log.e(TAG, "error during login " + e.getMessage());
        }
        return retVal;
    }

    public static String attach(String username, String hashedpassword, String attachmentUri) {

        //binary in den body reinhhauen

        String retVal = "";
            return retVal;
    }
} 
```

这是崩溃的日志文件

```
#
# A fatal error has been detected by the Java Runtime Environment:
#
#  Internal Error (classFileParser.cpp:3494), pid=5936, tid=4820
#  Error: ShouldNotReachHere()
#
# JRE version: 6.0_32-b05
# Java VM: Java HotSpot(TM) 64-Bit Server VM (20.7-b02 mixed mode windows-amd64 compressed oops)
# If you would like to submit a bug report, please visit:
#   http://java.sun.com/webapps/bugreport/crash.jsp
#

---------------  T H R E A D  ---------------

Current thread (0x00000000003bc000):  JavaThread "Unknown thread" [_thread_in_vm, id=4820, stack(0x0000000002870000,0x0000000002970000)]

Stack: [0x0000000002870000,0x0000000002970000]
[error occurred during error reporting (printing stack bounds), id 0xc0000005]

---------------  P R O C E S S  ---------------

Java Threads: ( => current thread )

Other Threads:

=>0x00000000003bc000 (exited) JavaThread "Unknown thread" [_thread_in_vm, id=4820, stack(0x0000000002870000,0x0000000002970000)]

VM state:not at safepoint (not fully initialized)

VM Mutex/Monitor currently owned by a thread: None

Dynamic libraries:
0x0000000000400000 - 0x000000000042f000     C:\Program Files\Java\jdk1.6.0_32\bin\javaw.exe
0x0000000077c50000 - 0x0000000077df9000     C:\Windows\SYSTEM32\ntdll.dll
0x0000000077570000 - 0x000000007768f000     C:\Windows\system32\kernel32.dll
0x000007fefe410000 - 0x000007fefe47c000     C:\Windows\system32\KERNELBASE.dll
0x000007fefe670000 - 0x000007fefe74b000     C:\Windows\system32\ADVAPI32.dll
0x000007feffc50000 - 0x000007feffcef000     C:\Windows\system32\msvcrt.dll
0x000007feffd90000 - 0x000007feffdaf000     C:\Windows\SYSTEM32\sechost.dll
0x000007feffdb0000 - 0x000007feffedd000     C:\Windows\system32\RPCRT4.dll
0x0000000077b50000 - 0x0000000077c4a000     C:\Windows\system32\USER32.dll
0x000007fefe910000 - 0x000007fefe977000     C:\Windows\system32\GDI32.dll
0x000007fefecf0000 - 0x000007fefecfe000     C:\Windows\system32\LPK.dll
0x000007fefe840000 - 0x000007fefe909000     C:\Windows\system32\USP10.dll
0x000007fefe980000 - 0x000007fefe9ae000     C:\Windows\system32\IMM32.DLL
0x000007fefebe0000 - 0x000007fefece9000     C:\Windows\system32\MSCTF.dll
0x0000000180000000 - 0x0000000180019000     C:\PROGRA~2\KASPER~1\KASPER~1.0FO\x64\adialhk.dll
0x000007feffa90000 - 0x000007feffb01000     C:\Windows\system32\SHLWAPI.dll
0x00000000002f0000 - 0x00000000002f6000     C:\PROGRA~2\KASPER~1\KASPER~1.0FO\x64\kloehk.dll
0x000000006d8b0000 - 0x000000006e068000     C:\Program Files\Java\jdk1.6.0_32\jre\bin\server\jvm.dll
0x000007fefc190000 - 0x000007fefc1cb000     C:\Windows\system32\WINMM.dll
0x000000006d820000 - 0x000000006d82e000     C:\Program Files\Java\jdk1.6.0_32\jre\bin\verify.dll
0x000000006d450000 - 0x000000006d477000     C:\Program Files\Java\jdk1.6.0_32\jre\bin\java.dll
0x000000006d870000 - 0x000000006d882000     C:\Program Files\Java\jdk1.6.0_32\jre\bin\zip.dll
0x0000000077e10000 - 0x0000000077e17000     C:\Windows\system32\PSAPI.DLL

VM Arguments:
jvm_args: -Dfile.encoding=Cp1252 -Xbootclasspath:F:\Android\android-sdk-windows\platforms\android-17\android.jar 
java_command: de.srs.android.pdixuploader.network.ClientApp
Launcher Type: SUN_STANDARD

Environment Variables:
JAVA_HOME=c:\java
PATH=C:\Program Files (x86)\ImageMagick-6.7.5-Q16;c:\Program Files (x86)\ImageMagick-6.7.5-Q16;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Program Files (x86)\Common Files\Roxio Shared\DLLShared\;C:\Program Files (x86)\Common Files\Roxio Shared\9.0\DLLShared\;C:\Windows\System32\WindowsPowerShell\v1.0\;D:\development\java\tools\apache-ant-1.8.0-bin\bin;C:\Program Files (x86)\gs\gs8.70\bin;C:\Program Files (x86)\gs\gs8.70\lib;D:\development\java\tools\apache-maven-2.2.1\bin;c:\java\bin;C:\Program Files (x86)\gs\gs8.70\bin;C:\Program Files (x86)\gs\gs8.70\lib;C:\Program Files (x86)\TC UP\PLUGINS\Library;C:\Program Files (x86)\gs\gs8.70\bin;C:\Program Files (x86)\gs\gs8.70\lib;C:\Program Files (x86)\Common Files\Adobe\AGL;C:\Program Files\SlikSvn\bin\;C:\strawberry\c\bin;C:\strawberry\perl\site\bin;C:\strawberry\perl\bin;C:\Program Files (x86)\Microsoft SQL Server\100\Tools\Binn\VSShell\Common7\IDE\;C:\Program Files (x86)\Microsoft SQL Server\100\Tools\Binn\;C:\Program Files\Microsoft SQL Server\100\Tools\Binn\;C:\Program Files (x86)\Microsoft SQL Server\100\DTS\Binn\;D:\development\groovy/bin;E:\devel\python\python27;E:\devel\python\python27/Scripts;C:\Program Files\TortoiseSVN\bin;MAVEN\bin;C:\Program Files (x86)\Git\cmd
USERNAME=o.jazic
OS=Windows_NT
PROCESSOR_IDENTIFIER=Intel64 Family 6 Model 23 Stepping 10, GenuineIntel

---------------  S Y S T E M  ---------------

OS: Windows 7 , 64 bit Build 7601 Service Pack 1

CPU:total 4 (4 cores per cpu, 1 threads per core) family 6 model 23 stepping 10, cmov, cx8, fxsr, mmx, sse, sse2, sse3, ssse3, sse4.1

Memory: 4k page, physical 4193268k(465044k free), swap 12383416k(5922328k free)

vm_info: Java HotSpot(TM) 64-Bit Server VM (20.7-b02) for windows-amd64 JRE (1.6.0_32-b05), built on Apr  5 2012 13:39:03 by "java_re" with MS VC++ 8.0 (VS2005)

time: Thu Dec 06 17:11:24 2012
elapsed time: 0 seconds 
```

# rally - Rally Dashboard 'My Defects' App 结果顺序

> ID：13748393
> 
> 赞同：1
> 
> 时间：2012-12-06T16:44:17.670
> 
> 标签：rally

我在我的 Rally 仪表板上使用库存的 My Defects 应用程序。（如果重要的话，我是一名开发人员。）

我想将结果显示的顺序从仅状态更改为状态和 LastUpdateDate。

我一直在搜索 Rally 帮助和 Google 以寻找答案，但我一直找不到。

我试过放置

```
状态，上次更新日期
```

在“订单”字段中，但这似乎不起作用。

谢谢 - 布赖恩

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T14:42:58.773

摆脱空间，你应该准备好：

```
State,LastUpdateDate 
```

# java - I'm calling a method in java which I have no control of. If I don't get a response from it, I want to kill it and move on

> ID：13748403
> 
> 赞同：7
> 
> 时间：2012-12-06T16:44:43.307
> 
> 标签：java, multithreading

If the method call takes more than 10 seconds I want to kill it and move on.

Is multi-threading my only option to solve this problem?

If I go with multi-threading which I'm very new at, my run method would only contain the one method as follows. If myMethod() gets stuck in an infinite loop is there a way to interrupt this thread?

```
public void run() {
    myMethod();
} 
```

Let's assume myMethod() is the following and changing it is not an option.

```
while(true){
    System.out.println("Thinking.");
        for (int i = 0; i < 100000; i++) {
            //wasting time
        }
} 
```

I was going for Mik378's solution, but I don't think this will work as myMethod doesn't throw the InterruptedException exception.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-06T16:47:55.180

Using threads to achieve this is tricky. There is no portable and safe method to kill a thread without cooperation from said thread. For further details, see [How do you kill a thread in Java?](https://stackoverflow.com/questions/671049/how-do-you-kill-a-thread-in-java) and [Why are `Thread.stop` [et al] deprecated?](http://docs.oracle.com/javase/1.5.0/docs/guide/misc/threadPrimitiveDeprecation.html)

A more robust approach is to call the method in the context of a separate process, and kill that process.

An even better approach is to understand why things are getting stuck in the first place, and figure out a way to prevent them from getting stuck (or a way to have a timeout and throw an exception etc). Whether that's a realistic possibility in your case, I don't know.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-06T17:14:36.927

You can start a thread wrapped around your Runnable (named "thread"). Then do

```
thread.start();
thread.join(10000);
if (thread.isAlive()) {
  thread.interrupt();
} 
```

As NPE mentioned, unless you are coding myMethod() yourself or know that it is sensitive to interruptions, there is no guarantee that this will actually kill the thread.

If you are implementing myMethod yourself, then what you need to do is have something like this inside the loop that method runs within the myMethod():

```
if (Thread.interrupted()) {
  break;  // or whatever you need to do to end the method quickly
} 
```

I've left out exception handling. Your compiler will tell you what you need to do in that respect.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-06T17:15:59.613

With two separated threads:

```
class Job implements Runnable {

        public void run(){
            try{
              myMethod();  // declared within this class or wherever you want
            } catch(InterruptedException){
                System.out.println("Interrupted now due probably to infinite loop !!");
            } 
        }

        public static void main(String[] args) throws InterruptedException {
           Job job = new Job();
           Thread process = new Thread(job);
           process.start(); 
           process.join(10000);  //wait here in order to detect wrong loop
           if(process.isAlive()){
             process.interrupt();
           }
        }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-06T16:57:05.887

I agree with NPE, your best bet is to use multithreading with a separate process. That seems to be the safest way if you can't debug the method. Other options would be to simply use a timer and throw an exception if the timer exceeds 10 seconds. But that would be kind of unorthodox.

# javascript - 仅在 IE 中出现 XMLHttpRequest 错误

> ID：13748412
> 
> 赞同：0
> 
> 时间：2012-12-06T16:45:04.550
> 
> 标签：javascript, xmlhttprequest

我们使用一个 XMLHttpRequest 模型对象来测试我们的 ExtJs 4.1 应用程序与 Jasmine。现在，一切都在 Chrome 和 Firefox 中完美运行，但 IE 版本 7 到 9 一如既往地出现问题。

`onreadystatechange`函数有错误，

if `readyState`is `1`then `SCRIPT575`（由于错误而无法继续`c00c023f`）

if `readyState`is `2`then `SCRIPT10`（所需数据尚不可用）

看到这个[Jsfiddle](http://jsfiddle.net/pbaN6/1/)（搜索“错误”跳转到行）

此外，还有一个错误`TypeError: Object expected`。

* * *

**我读过的**：

我读了几篇[这样](https://stackoverflow.com/questions/7287706/ie-9-javascript-error-c00c023f)和[那样](https://stackoverflow.com/questions/7903693/ie9-javascript-error-script575-c00c023f-prototype-file)的帖子，但没有一个建议能解决这个问题。

* * *

**注意**：

在 Chrome 和 Firefox 中，所有请求都只返回`readyState` `4`，但在 IE`readyState`中，值从 1 到 4 重复（？）。

```
Chrome & FF
readyState 4 => OK
readyState 4 => OK
readyState 4 => OK
readyState 4 => OK
readyState 4 => OK
...

IE:
readyState 1 => error
readyState 2 => error
readyState 3 => OK
readyState 4 => OK
readyState 1 => error
... 
```

* * *

你能指导我如何解决这个问题吗？我没有线索。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T10:35:36.127

在读取 responseXML/responseText 属性之前检查 readyState 值。如果 readyState 值为 4，您可以安全地访问 responseXML/responseText

（XMLHttpRequest 的原始实现和后来的规范要求实现在对象完成 I/O 操作之前对数据的访问抛出异常）

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-10T14:21:27.327

有一个名为的属性`response`应该是`responseText`。

`readyState`另外，我正在检查`if( typeof oXhr.readyState !== 'undefined' ) {}`

现在我的代码适用于 IE8、IE9（标准）。

但是，IE8、IE9（Quirks）和 IE 7（Quirks & Standard）失败并出现错误：

`SCRIPT16389: Unknown error`

我会尝试修复，但这个问题已经完成。

# ruby-on-rails - Rails：在这个例子中是什么生成了视图？

> ID：13748415
> 
> 赞同：0
> 
> 时间：2012-12-06T16:45:06.603
> 
> 标签：ruby-on-rails

对不起，如果这是基本的，但我已经陷入了一项工作，包括我在内，没有人在 RoR 中写过任何东西，并被要求“修复”一些东西。

我正在我的网络浏览器中查看一个页面`domain.com/collect`——我在 routes.rb 文件中发现了这个页面：

```
get '/collect' => 'payments#index', :as => :collect 
```

所以我假设这意味着类`index`中的方法`PaymentsController`。我找到了该方法及其：

```
def index
end 
```

就是这样。有一个父类——`PaymentsController < AppController`但超级方法永远不会被调用，如果它是......好吧，它也不存在。

那么，是什么产生了这里的视图？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-06T16:47:12.153

视图位于`app/views/payments/index.html.erb`，其布局可能位于`app/views/layouts/application.html.erb`

# matlab - 随机置换矩阵行，保持相同值行相邻

> ID：13748423
> 
> 赞同：2
> 
> 时间：2012-12-06T16:45:33.397
> 
> 标签：matlab, matrix, permutation

如何随机排列行，使具有相同值的行保持相邻？我知道我可以`randperm`在行上使用随机排列所有行，但我不知道如何保持相同值的行相邻。谢谢。

```
A = [0 0 0;
     0 0 0;
     1 1 1;
     1 1 1;
     1 1 1;
     2 2 2;
     2 2 2];   

 permute_A = [0 0 0;
     0 0 0;
     2 2 2;
     2 2 2;
     1 1 1;
     1 1 1;
     1 1 1]; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T17:45:15.463

您必须识别集群，然后排列它们：

可以通过查找它们的差异变化来找到集群：

```
diffA = diff(A);
clusters_start = [1 ; find(any(diffA,2)~=0)+1]; 
```

然后通过以下方式轻松找到集群末端：

```
clusters_end = [clusters_start(2:end)-1 ;size(A,1)];
clusters_length = clusters_end-clusters_start+1; 
```

现在您知道了集群的数量，您可以对它们进行置换：

```
Nclusters = numel(clusters_start);
perm_idx = randperm(Nclusters );
clusters_start = clusters_start(perm_idx);
clusters_end = clusters_end(perm_idx);
clusters_length = clusters_length(perm_idx); 
```

并将它们放入一个新矩阵中：

```
newA = NaN(size(A));
for ii=1:Nclusters
    newA(sum(clusters_length(1:ii-1))+(1:clusters_length(ii)),:) = A(clusters_start(ii):clusters_end(ii),:);
end 
```

# javascript - 不要在循环中创建函数/不确定代码的含义

> ID：13748431
> 
> 赞同：1
> 
> 时间：2012-12-06T16:46:05.130
> 
> 标签：javascript, function, loops, google-maps-api-3

> **可能重复：**
> [如何解决 jslint 错误“不要在循环中创建函数。”</a>](https://stackoverflow.com/questions/3037598/how-to-get-around-the-jslint-error-dont-make-functions-within-a-loop)
> 
> [](https://stackoverflow.com/questions/3037598/how-to-get-around-the-jslint-error-dont-make-functions-within-a-loop)

[](https://stackoverflow.com/questions/3037598/how-to-get-around-the-jslint-error-dont-make-functions-within-a-loop)

[公平警告，我是一个初学者。我正在开发一个 google maps api v3 项目 (](https://stackoverflow.com/questions/3037598/how-to-get-around-the-jslint-error-dont-make-functions-within-a-loop) [http://jsbin.com/ofepet/9/edit](http://jsbin.com/ofepet/9/edit) )，并且我在 JSBin 上有一个“不要在循环中创建函数”警告。我想修复它，但我使用的是我在别处得到的代码，所以我很难准确理解发生了什么——尤其是最后 7 行。

简而言之，我对代码的理解不够好，无法使函数脱离循环。错误出现在倒数第二行。

```
 function setMarkers(map, markers) {

    for (var i = 0; i < markers.length; i++) {
        var sites = markers[i];
        var siteLatLng = new google.maps.LatLng(sites[1], sites[2]);
        var marker = new google.maps.Marker({
            position: siteLatLng,
            map: map,
            title: sites[0],
            zIndex: sites[3],
            html: sites[4],
            icon: featureImage
        });

        var contentString = "Some content";

        google.maps.event.addListener(marker, "click", function () {
            infowindow.setContent(this.html);
            infowindow.open(map, this);
        });
    } 
```

如何修复此错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T16:48:39.760

该警告实际上是在说明它的含义。:-) 你有一个`for`循环，在`for`循环中你正在创建一个函数来传递给`addEventListener`. 这经常（尽管不总是）是一个错误，这就是它被标记的原因。

在你的情况下，它实际上是无害的——但看起来你可以只对你在循环中创建的所有元素使用一个函数，而不是制作多个。所以：

```
function setMarkers(map, markers) {

    for (var i = 0; i < markers.length; i++) {
        var sites = markers[i];
        var siteLatLng = new google.maps.LatLng(sites[1], sites[2]);
        var marker = new google.maps.Marker({
            position: siteLatLng,
            map: map,
            title: sites[0],
            zIndex: sites[3],
            html: sites[4],
            icon: featureImage
        });

        var contentString = "Some content";

        google.maps.event.addListener(marker, "click", handler);
    }

    function handler() {
        infowindow.setContent(this.html);
        infowindow.open(map, this);
    }
} 
```

现在，您只需为每次调用创建一个函数`setMarkers`并重用它。

# python - 在 python 上使用 join 函数来格式化字典

> ID：13748433
> 
> 赞同：2
> 
> 时间：2012-12-06T16:46:06.637
> 
> 标签：python

我正在尝试格式化字典，其中键是食物网中捕食者的名称，值是捕食者吃的猎物列表。我可以将整个打印出来，但打印出来的猎物列表都用逗号分隔。我想格式化它，所以最后一个逗号不是逗号，而是说“and”这个词。

这就是我所拥有的，d 是我的字典：

```
for key in d:
        print(key, "eats", ', '.join(map(str,d[key]))) 
```

这会打印出来，例如：

```
Lobster eats mussels, limpets, whelk 
```

我想用“and”替换最后一个逗号。我知道我必须找到逗号的索引，这是通过以下方式完成的：

```
pos=str(d[key]).rfind(",") 
```

我只是不知道如何从这里完成它。

有什么建议么？

谢谢你

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-06T16:52:49.443

在您的示例中，如果`prey`包含逗号，您可能会遇到问题，这可能吗？

我会建议：

```
for predator, prey in d.items():
    print '%s eats %s and %s' % (predator, ', '.join(prey[:-1]), prey[-1]) 
```

`for predator, prey in d.items()`循环遍历所有键值对。

`', '.join(prey[:-1])`带走除最后一个猎物以外的所有猎物，并用逗号加入它们

`prey[-1]`然后添加最后一个猎物

每个`%s`都被行尾元组中的值替换

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T16:52:45.837

可能是这样的？

```
def add_and(s):                                
   before, after = s.rsplit(', ', 1)
   return before + ', and ' + after

>>> add_and('Lobster eats mussels, limpets, whelk')
'Lobster eats mussels, limpets, and whelk' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-06T16:52:52.487

尝试这个：

```
for key in d:
  l = d[key]
  print ', '.join(l[:-1]) + ' and ' + str(l[-1]) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-06T17:52:29.823

我会用这个以防万一`len(preys) <= 1`：

```
for predator, preys in d.items():
    print '{0} eats {1}'.format(  predator,
                                  ', '.join(preys[:-1]) + \
                                  " and " + preys[-1] if len(preys) > 1 else preys[-1],
                                  ) 
```

# c# - C# 中的多播委托奇怪行为？

> ID：13748434
> 
> 赞同：0
> 
> 时间：2012-12-06T16:46:09.823
> 
> 标签：c#, .net, delegates

我有这个简单的事件：

```
public class ClassA
{
    public event Func<string, int> Ev;
    public int Do(string l)
    {
        return Ev(l);
    }
} 
```

和2种方法：

```
 static int Display(string k)
        {
            return k.Length;
        }

  static int Display_2(string k)
        {
            return k.Length*10;
        } 
```

我正在注册此活动：

```
 ClassA a = new ClassA();
 a.Ev += Display;
 a.Ev += Display_2; 
```

现在，我正在执行：

```
 Console.WriteLine(a.Do("aaa")); 
```

输出 ：

![在此处输入图像描述](../Images/310f7140c2e75487ef19c2c6ce0c51b8.png)

**什么 ？？？**

*   他在调用列表中有**2**种方法！它*确实*运行了它们，但为什么它只显示*上次*注册的结果？

*   结果`"3"`去哪儿了？（第一次调用）？（*虽然两个`display`+`display_2`都被执行了……没想到`console.write`会遍历结果。但也没想到他会决定显示哪个。*）

# 编辑 ：

![在此处输入图像描述](../Images/492700b6be8b1ea1a013d8288a47bedd.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-07T09:31:30.877

这里有三个方面在起作用：

1.  活动实施
2.  委托组合行为
3.  调用其调用列表具有多个条目的委托的行为

对于第 1 点，您有一个*类似字段的*事件。C# 4 规范的第 10.8.1 节给出了一个示例，并指出：

> 在类的声明之外`Button`，该`Click`成员只能用在`+=`and`-=`运算符的左侧，如
> 
> ```
> b.Click += new EventHandler(...); 
> ```
> 
> 它将**委托附加到事件的**调用`Click`列表

（强调我的）。该规范还明确指出，类字段事件创建一个委托字段，该字段*在*类中用于调用。

更一般地说（第 2 点），C# 4 规范的第 7.8.4 节讨论了通过`+`and的委托组合`+=`：

> 委托组合。每个委托类型都隐式地提供了以下预定义的运算符，其中`D`是委托类型：
> 
> ```
> D operator +(D x, D y) 
> ```
> 
> 当两个操作数都属于某种委托类型时，二元`+`运算符执行委托组合`D`。[...跳过`x`or`y`为空的位 ...] 否则，操作的结果是一个新的委托，当被调用时，它会**调用第一个操作数，然后调用第二个操作数**。

（再次强调我的。）

最后，第 3 点——事件调用和返回值。C# 规范的第 15.4 节指出：

> 如果委托调用包含输出参数或返回值，则它们的最终值将来自列表中最后一个委托的调用。

更一般地说，它取决于事件的实现。如果您使用使用“正常”委托组合/删除步骤的事件实现，则一切都会得到保证。如果您开始编写一个做疯狂事情的​​自定义实现，那是另一回事。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-06T16:49:09.807

作为一般规则，事件返回值是没有意义的。

如果您想从事件处理程序获取信息，则事件处理程序更改输入参数更有意义，或者只是调用触发事件的任何对象的另一个方法来传达其他内容。

通常这甚至不会出现，因为事件在逻辑上正在将信息传递*给*事件处理程序，并且不需要*从*事件处理程序获取信息。老实说，这是代码异味的标志。一个事件不应该关心是否有人订阅了它，他们可能是谁，他们可能在做什么，或者是否有任何订阅者。依赖它们的返回值只会造成过于紧密的耦合。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-06T16:51:13.073

调用多播非 void 委托会返回*最后*执行的处理程序的值。

你几乎无法控制谁是第一个或最后一个。这是一个糟糕的系统。

这就是大多数事件和委托返回的原因`void`。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-12-06T16:58:21.127

事件只是按照它们附加的顺序进行迭代。因为您使用的是返回值，所以您获得的值是最后一次调用的值。

不过，这并不是事件的正常模式。您可能想要更多类似的东西：

```
public class MyEventArgs : EventArgs
{
    public MyEventArgs()
    {
        Results = new List<int>();
    }
    public string InputString{get;set;}
    public List<int> Results{get;set;}
}
public event EventHandler<MyEventArgs> Ev
public int Do(string l)
{
    MyEventArgs e = new MyEventArgs();
    e.InputString = l;
    if(Ev != null) Ev(this, e);
    return e.Results.Sum();
} 
```

进而

```
static int Display(object sender, MyEventArgs e)
        {
            return e.Results.Add(k.Length);
        }

  static int Display_2(object sender, MyEventArgs e)
        {
            return e.Results.Add(k.Length*10);
        } 
```

# groovy - Geb + Spock + groovy 设置

> ID：13748435
> 
> 赞同：3
> 
> 时间：2012-12-06T16:46:17.830
> 
> 标签：groovy, gradle, spock, geb

所以我一直试图让这些工具一起运行，但我似乎无法正确设置。每次出现以下错误时：

```
The project was not built since its build path is incomplete. Cannot find the class file for org.spockframework.mock.MockController. Fix the build path then try building this project. 
```

我已经创建了这个[要点](https://gist.github.com/4225717)。当我运行 gradle chrome test 时，我得到以下输出：

```
 gradle chrome test
 :compileJava UP-TO-DATE
 :compileGroovy UP-TO-DATE
 :processResources UP-TO-DATE
 :classes UP-TO-DATE
 :compileTestJava UP-TO-DATE
 :compileTestGroovy FAILED

 FAILURE: Build failed with an exception.
 * What went wrong:
 Execution failed for task ':compileTestGroovy'.
 > org/spockframework/mock/MockController

 * Try:
 Run with --stacktrace option to get the stack trace. Run with --info or --debug option to get more log output.

 BUILD FAILED 
```

我正在使用 gradle 1.3、geb 0.7.2 和 spock 0.7-groovy-2.0。我还尝试更新 geb 以使用 0.9.0-RC-1。上面的要点应该包含看到同样错误所需的一切。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-06T17:54:15.583

这就是当您使用低于 0.9.0-RC-1 的 Geb 版本（与 Spock 0.7 不兼容）运行 Spock 0.7 时得到的。仔细检查您的设置并执行干净的构建。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-21T18:55:58.707

我遇到了同样的问题。事实证明，您需要使用 groovy 1.8 版本，因为 Geb/Spock 集成 jar 尚未升级到 groovy 2.0。以下设置对我有用：

```
dependencies {

    def seleniumVersion = "2.42.2"
    def phantomJsVersion = '1.1.0'
    def cargoVersion = '1.4.9'

    // selenium drivers
    compile "org.seleniumhq.selenium:selenium-ie-driver:$seleniumVersion"
    compile "org.seleniumhq.selenium:selenium-chrome-driver:$seleniumVersion"
    compile "org.seleniumhq.selenium:selenium-firefox-driver:$seleniumVersion"
    compile "org.seleniumhq.selenium:selenium-support:$seleniumVersion"
    compile("com.github.detro.ghostdriver:phantomjsdriver:$phantomJsVersion") {
        transitive = false
    }

    // geb
    compile 'org.codehaus.geb:geb-core:0.7.2'
    compile 'org.codehaus.geb:geb-spock:0.7.2'

    // spock
    compile 'org.spockframework:spock-core:0.6-groovy-1.8'

    compile 'junit:junit:4.8.2'
    compile 'org.slf4j:slf4j-log4j12:1.7.6@jar'
    compile 'org.slf4j:slf4j-api:1.7.6@jar'

} 
```

我在我的博客上发布了包含货物集成的完整脚本：[http ://www.openscope.net/2015/02/21/how-to-configure-gebspock-with-gradle/](http://www.openscope.net/2015/02/21/how-to-configure-gebspock-with-gradle/)

# ruby - 带引号的 Ruby 语法

> ID：13748447
> 
> 赞同：-1
> 
> 时间：2012-12-06T16:47:16.597
> 
> 标签：ruby, syntax, quotes

我的红宝石代码中有以下语句

```
curlsyntax = "URL = "

restcall = 'http://myurl.com/File?schema=1.5&token=' + auth_token + '&product=http://myurl.com/Product/8283&form=json&productname=http://myurl.com/name/' + productname + '&priority=now'

call = curl + restcall 
```

那给我的是我最终出局开头的报价，即“URL = http ...但我实际上并不希望第一个报价出现，它应该是URL =”http

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T16:52:59.697

您在 URL 之前看到的引号只是 ruby​​ 表示字符串的方式 - 它实际上不是字符串的一部分。要在 之前和之后添加双引号`restcall`，您可以这样做：

```
call = "#{curlsyntax}\"#{restcall}\"" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T16:53:40.447

做这个：

```
call = %{URL = "#{restcall}"} 
```

但是您可能应该使用[http://ruby-doc.org/stdlib-1.9.3/libdoc/open3/rdoc/Open3.html](http://ruby-doc.org/stdlib-1.9.3/libdoc/open3/rdoc/Open3.html)之类的东西来进行安全的系统调用。例子：

```
require 'open3'
require 'shellwords'

command = Shellwords.shelljoin(['curl', 'arg1', 'arg2', 'arg3'])
stdin, stdout, stderr = Open3.popen3({'ENV1' => 'value1', 'ENV2' => 'value2'}, command)

result = stdout.read 
```

这样您就可以安全地转义传递给命令行的参数，甚至将环境变量传递给您的调用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-06T16:55:55.510

手动构建这样的查询是不安全的。我会选择使用这样的东西：[https ://github.com/sporkmonger/addressable](https://github.com/sporkmonger/addressable)

# c# - 在asp.net中转换变量

> ID：13748448
> 
> 赞同：-1
> 
> 时间：2012-12-06T16:47:20.290
> 
> 标签：c#, asp.net

我写了一段简单的代码，我没有找到问题所在。

代码是：

```
 var sortSecurities="SELECT * FROM securities";
           int total=0;
           var value="";
           foreach(var row in db.Query(sortSecurities))
           {
               value=row.lastGate;
               total=Convert.ToInt32(value)*100;// here the problem with compilation.. 
               db.Execute("INSERT INTO holding(IDgrossPortfolio,IDSecurity,totalHolding,units,buyGate) "+"VALUES (@0,@1,@2,@3,@4)",row.category,row.number,total,"100",row.lastGate);
           } 
```

转换有什么问题？

错误是：

> 异常详细信息：System.FormatException：输入字符串的格式不正确。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T16:50:36.790

`value`不包含可以转换为 Int32 的值。如果您可以进行一些调试并查看它的值来自`row.lastGate`，您可能会看到问题所在。

另外，不确定返回的是`db.Query(sortSecurities)`什么（或实际上是什么类型的对象`row.lastGate`），但您也可以尝试更改`value=row.lastGate;`为`value=row.lastGate.ToString();`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T16:55:08.723

您可以使用 try parse 来检查该值是否实际包含一个数字

```
 int total;
  bool result = Int32.TryParse(value, out total);
  if (result)
  {
      db.Execute("INSERT INTO holding(IDgrossPortfolio,IDSecurity,totalHolding,units,buyGate) "+"VALUES (@0,@1,@2,@3,@4)",row.category,row.number,total,"100",row.lastGate);

  } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-06T16:54:45.403

你`value`没有被成功解析`Convert.ToInt32()`

或者，考虑使用`Int32.TryParse()`并验证数据是否确实是您期望的数据类型。

```
int result;
if(Int32.TryParse(row.lastGate, out result))
{
    //row.lastGate was a valid int
    total = result * 100;
}
else
{
    //row.lastGate wasn't a valid int
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-06T17:22:24.363

谢谢大家...我现在尝试并找到了优雅的答案。

**就像我在评论中写的那样，因为我知道 row.lastGate 的值代表一个我不需要检查的数字。** 所以我试试这个并且它有效：

```
var sortSecurities="SELECT * FROM securities";
           int total=0;
           double value=0;
           foreach(var row in db.Query(sortSecurities))
           {
               value=Convert.ToDouble(row.lastGate);
               total=Convert.ToInt32(value)*100;//100 is default
               db.Execute("INSERT INTO holding(IDgrossPortfolio,IDSecurity,totalHolding,units,buyGate) "+"VALUES (@0,@1,@2,@3,@4)",row.category,row.number,total,"100",row.lastGate);
           } 
```

可能我首先需要将值更改为 double ，然后再更改为 int 因为当我尝试将其直接更改为 int 时，编译器没有正确解释字符串，因为数字中的点（双精度类型）。

谢谢你的意图..

# html - HTML / CSS，在每侧获得 2 个背景以使用包装器进行调整

> ID：13748450
> 
> 赞同：0
> 
> 时间：2012-12-06T16:47:20.807
> 
> 标签：html, css

我试图在我的网站上有 2 个单独的背景，每侧一个，根据屏幕大小进行调整

就像在[ownedcore.com](http://www.ownedcore.com/)上一样，其中边用中间包装进行调整

**HTML：**

```
<div id="bleft"></div>
<div id="wrapper">a</div>
<div id="bright"></div> 
```

**CSS：**

```
@charset "utf-8";

header, section, footer, aside, bside, article, figure {display: block;}
* {margin: 0; padding: 0;}

#wrapper {
    width: 1400px;
    margin: 0 auto;
    text-align: left;
    position: absolute;
}

#bleft {
    width: 700px;
    height: 700px;
    float: left;
    background-image: url(images/pageBGLeft.jpg);
    clear: left;
}
#bright {
    width: 700px;
    height: 700px;
    float: right;
    background-image: url(images/pageBGRight.jpg);
    clear: right;
} 
```

不强制正确的背景，但显示一个换行符

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T16:56:52.633

该站点看起来可以在 2 个容器上使用 2 个背景，如下所示：

```
<body>
  <div id="A">
    <div id="B">
      <div id="wrapper"></div>
    </div>
  </div>
</body> 
```

然后是CSS：

```
#A {
  background: url(...) top right no-repeat;
}
#B {
  background: url(...) top left no-repeat;
}
#wrapper {
  width: 700px;
  margin: 0 auto;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T16:51:12.767

我会尝试使用`<img>`元素。也许你可以试着`position:fixed`让一个是`left: 0`和另一个`left: 50%`。每个 to`50%`和 height auto 的宽度......可能需要玩一点，但我认为这个概念应该有效

# web-applications - 可用性 - 如何在菜单中显示创建、编辑、查看和搜索？

> ID：13748452
> 
> 赞同：0
> 
> 时间：2012-12-06T16:47:24.210
> 
> 标签：web-applications, usability, crud

我有一个 Web 应用程序，允许用户立即执行以下两项操作之一：

1) 搜索记录

或者

2) 创建新记录

结果，我在菜单栏中有两个链接，称为“搜索”和“创建”。如果您单击该链接，它将分别将您带到搜索或创建页面。

在搜索记录并从搜索结果网格中选择特定记录后，用户可以选择编辑或查看所选记录。注意：搜索结果提供了记录数据的子集。

当用户选择编辑或查看时：

我应该把用户带到一个新页面吗？

a) 创建一个名为 Edit 或 View 的新菜单栏链接

b) 将 Create 菜单项重命名为 Edit 或 View，一旦用户完成重命名为 Create

还是有更有用（直观）的方法来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T20:01:50.347

如果他们在查看某些内容时点击“创建”会发生什么？那应该仍然有效；您不想删除或重命名“创建”。

创建、编辑和查看页面应该非常相似；create 和 edit 可能是相同的表单。

那说：

菜单栏有两个选项，“创建”和“搜索”。

在菜单栏下方和内容之前应该是页面标题：这里有四个可能的标题是：“创建”、“搜索”、“搜索->查看”和“搜索->编辑”。

单击“创建”总是会让您创建新的东西。
单击搜索始终会将您带到新的搜索。

# jquery - 通过jQuery中的两个数组向前和向后循环

> ID：13748453
> 
> 赞同：2
> 
> 时间：2012-12-06T16:47:28.467
> 
> 标签：jquery, arrays, iframe, cycle

此脚本用于切换两个独立 iframe 中的内容。每个都有自己的特定内容，确实需要同步。我最初创建它只是为了在任何 keyup 触发器上循环前进。它工作得很好。然后我被要求在“返回”按钮事件上向后循环。

它循环，但现在在后向循环中，iframe 中的内容不同步，并且循环不是迭代的，而是看似随机的，具体取决于您在前向循环中的位置，在 iFrame 之间跳转。

该代码在正向循环中有效，我不想破坏它。

```
 <script>
  $(document).ready(function(){
    var locations = ["Assets/Assets0.html", "Assets/Assets1.html", "Assets/Assets2.html", "Assets/Assets3.html"];
    var details = ["Details1/Details0.html", "Details1/Details1.html", "Details1/Details2.html", "Details1/Details3.html"];
    var len = locations.length;
    var len2 = details.length;
    var iframe = $('#Results');
    var iframe2 = $('#Description');
    var i = 0;
    $(document.documentElement).keyup(function (event) {
        // handle delete key
        if (event.keyCode == 8) {
            $(iframe).attr('src', locations[--i % len]);
            $(iframe2).attr('src', details[-i % len2]);

        // all other keys
        } else  {
            $(iframe).attr('src', locations[++i % len]);
            $(iframe2).attr('src', details[+i % len2]);
          }
        });

  });
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T17:15:32.070

负数取模有点奇怪……试试看：

例如，您希望在`-1 % 3`实际为 3 时给您（最后一个元素）`2`。

我的建议是`if`围绕“返回”代码来应对`i == 0`.

# c# - 使用 NLog 的 Ninject 记录器

> ID：13748455
> 
> 赞同：15
> 
> 时间：2012-12-06T16:47:30.530
> 
> 标签：c#, ninject, nlog

我刚刚开始学习 Ninject，但遇到了记录器的问题。我目前有一个控制器，它有一个服务和记录器注入到构造函数中，如下所示：

```
public ToolsController(IToolsService toolsService, ILogger logger)
{
    logger.Info("ToolsController Created");
    this.toolsService = toolsService;
    this.logger = logger;
} 
```

问题出在构造函数中的 logger.Info 行（例如）上，它似乎使用了错误的记录器，因此它打印出的记录器名称不正确。

```
Tools.IGeocodeImporter: ToolsController Created 
```

以下是获取记录器名称的设置方法：

```
kernel.Bind<ILogger>().To<Logger>().WithConstructorArgument("name", x => x.Request.ParentContext.Request.Service.FullName); 
```

任何意见，将不胜感激。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-12-06T17:06:36.150

我使用以下内容：

```
.Bind<ILog>().ToMethod(p => LogManager.GetLogger(
                   p.Request.Target.Member.DeclaringType)); 
```

让记录器带有类的名称。我正在使用 Log4net，但我认为这个想法也可以应用于任何日志：事实上，绑定到一个方法可以让您获得任何解决方案，以便创建所需的实例。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-12-19T07:28:30.163

我使用了一个名为 Ninject.Extensions.Logging.NLog2 的 ninject 扩展，它可以在[NuGet](http://nuget.org/packages/Ninject.Extensions.Logging.nlog2)或[GitHub 上找到](https://github.com/ninject/ninject.extensions.logging)。它处理 NLog 的绑定，因此您只需将其添加到您的项目并删除您现在拥有的任何与 NLog 的绑定即可。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-02-27T05:53:09.630

正如 Felice 提到的，您可以使用相同的方法，但是对于 Nlog，您需要进行一些更改，即：

```
.Bind<ILogger>().ToMethod(p => NLog.LogManager.GetCurrentClassLogger(
                   p.Request.Target.Member.DeclaringType)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-01-19T18:38:55.923

我认为目前最好的方法是为您的记录器（用于 NLog）安装扩展：

```
Install-Package Ninject.Extensions.Logging.NLog4 
```

然后在你的代码中：

```
 using var kernel = new Ninject.StandardKernel(new NinjectSettings(){LoadExtensions = false}, new NLogModule()); 
```

`new NinjectSettings(){LoadExtensions = false}`- 这个元素是正确加载 NLogModule 所必需的。

现在您已准备好获取以下新实例`ILogger`：

```
public class PublicPropertyLoggerClass
{
    [Inject]
    public Ninject.Extensions.Logging.ILogger Logger { get; set; }
} 
```

但是如果你不喜欢安装新的 nuget 包，你仍然可以使用：

```
_kernel.Bind<ILogger>().ToMethod(p => LogManager.GetLogger(p.Request.Target?.Member.DeclaringType.FullName ?? typeof(App).GetType().FullName)); 
```

`App`你的创业课程在哪里。

答案基于：[https ://github.com/ninject/Ninject.Extensions.Logging/wiki/Using](https://github.com/ninject/Ninject.Extensions.Logging/wiki/Using)

# c++ - 使用冒泡排序从类中对 2D Char 和 Int 数组进行排序？

> ID：13748467
> 
> 赞同：0
> 
> 时间：2012-12-06T16:48:08.557
> 
> 标签：c++, class, multidimensional-array, bubble-sort

我正在尝试按降序对`int`和`char`s 的数组（来自一个类）进行排序。这些是学生姓名和成绩。

该类定义为：

```
class Student {
public:
    char name[20];
    int grades;
}; 
```

`numCount`是记录数的增量值。

```
void bubble_sort(Student theResults[], int numCount)
{
  bool swapped = true;
  while(swapped)
  {
    swapped = false;
    for(int i=1;i<numCount;i++)
    {
      if(theResults[i-1].grades < theResults[i].grades)
      {
        int tempHold = theResults[i-1].grades;
        theResults[i-1].grades = theResults[i].grades;
        theResults[i].grades = tempHold;
        swapped = true;
      }
    }
  } 
```

我遇到的问题是`int`值（等级）在循环后正确排序，但难以正确分配名称以匹配等级。

我使用了以下代码，但它不起作用，因为它为学生显示了不正确的成绩。

```
char* title_temp = theResults[i-1].name;
theResults[i-1].name[20] = theResults[i].name[20];
theResults[i].name[20] = title_temp[20]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T16:52:30.407

问题是你需要交换**对象**，等级只需要作为指导排序的**关键，试试这个：**

```
void bubble_sort(Student theResults[], int numCount)
{

    Student tempHold;
    bool swapped = true;
    while(swapped)
    {
        swapped = false;
        for(int i=1;i<numCount;i++)
        {
            if(theResults[i-1].grades < theResults[i].grades)
            {
                tempHold = theResults[i-1]; //swap the objects, not just the grades.

                theResults[i-1]= theResults[i];

                theResults[i] = tempHold;

                swapped = true;
            }
        }
    }} 
```

但是，如果您必须复制成员，那么除了交换成绩：

```
char temp[20];
strcpy(temp ,theResults[i-1].name);
strcpy(theResults[i-1].name,theResults[i].name);    
strcpy(theResults[i].name,temp); 
```

而不是使用

```
 char* title_temp = theResults[i-1].name; // <-wrong
   theResults[i-1].name[20] = theResults[i].name[20];//20 is invalid index
    theResults[i].name[20] = title_temp[20]; //this is just 1 element out of the whole array 
```

由于**许多**原因，这是错误的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T16:54:04.433

您必须使用循环一次复制整个 char 块，每个元素，或者您可以使用 memcpy。

你也可以使用你的类的浅拷贝

```
void bubble_sort(Student theResults[], int numCount)
{

    bool swapped = true;
    while(swapped)
    {
        swapped = false;
        for(int i=1;i<numCount;i++)
        {
            if(theResults[i-1].grades < theResults[i].grades)
            {
                Student tempHold = theResults[i-1];

                theResults[i-1]= theResults[i];

                theResults[i] = tempHold;

                swapped = true;
            }
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-06T16:55:07.323

我认为你的问题在这里：

```
if(theResults[i-1].grades < theResults[i].grades)
{
    int tempHold = theResults[i-1].grades;

    theResults[i-1].grades = theResults[i].grades;

    theResults[i].grades = tempHold;

    swapped = true;
} 
```

你真正想做的是

```
if(theResults[i-1].grades < theResults[i].grades)
{
    Student tempHold = theResults[i-1];

    theResults[i-1] = theResults[i];

    theResults[i] = tempHold;

    swapped = true;
} 
```

在您更改的只是成绩值而不是名称之前，这将切换整个 Student 对象并应该产生您正在寻找的输出

# xslt - XSLT 是否始终适用？

> ID：13748469
> 
> 赞同：-1
> 
> 时间：2012-12-06T16:48:14.843
> 
> 标签：xslt

这只是出于好奇而提出的问题。

谁能举例说明无法使用 XSLT 模板解决的与 XML 处理相关的问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T06:46:48.423

处理一个 XML 文档实际上通常需要处理两件事——文档本身的结构，以及各个节点中的内容。

例如，如果您想`foo`使用 XSLT 1.0 在所有节点上进行正则表达式替换，编写与这些节点匹配的模板很容易，但实际上对内容进行正则表达式替换非常困难，您需要编写自己的正则表达式解析器。在这种情况下，让宿主语言使用 XPath 获取节点列表并自行处理替换会更有意义。

其次，一些解决方案在 XSLT 中效率不高。以这个问题为例：[高效的 xslt 条件增量](https://stackoverflow.com/questions/13727201/efficient-xslt-conditional-increment)，尽管 OP 要求的内容当然是完全可能的，但 XSLT 并不是最有效的语言。我可以很容易地使用程序语言。

另一个论点当然是关于可维护性的——你编写的代码让你的团队能够维护。如果您的团队中没有其他人知道 XSLT，那么短期内您可能最好使用他们所知道的（尽管如果您有时间/预算，让他们学习 XSLT 总是一个好计划）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T03:30:14.517

声明说“特定的计算或特定类型的操作在给定的语言中是不可能的”是不公平的。因为世界上某个地方会有一个人提供扩展并证明它是可能的： )

出色地。XSLT 旨在将 XML 转换为所需的格式，如 XML/HTML/Text（也包括生成 CSV 文件），而 XSLT 在这方面非常完美！！

分享我的个人经验，在 XSLT 1.0 中，我遇到了一些听起来很困难的操作。示例：日期时间操作（加减两个日期时间值）。但幸运的是 msxsl 支持内联脚本，这解决了我的问题！

你为什么不尝试实现一些超出你想象的东西..如果你被困在某个地方，那么让其他成员玩得开心解决这些难题:)

# html - 使用引导程序设计标题（图像、文本和搜索）

> ID：13748475
> 
> 赞同：1
> 
> 时间：2012-12-06T16:48:25.337
> 
> 标签：html, css, twitter-bootstrap

我正在尝试使用引导程序设计标题。我想在顶部，右侧，即标题处放置一个徽标。我想在整个标题的右侧放置一个引导搜索栏。我试图将搜索栏向右浮动，但它被放置在标题文本之后。因此图像、标题文本和搜索栏一个接一个出现，因此当我不断最小化浏览器窗口时，根据引导程序的响应式布局，它们也不能正确堆叠。

```
<div class="container">
        <img src="http://www.computerclipart.com/computer_clipart_images/cartoon_computer_and_books_0521-1004-3015-4128_SMU.jpg" height="90" width="120" />
        <h1 class="logo"> Resource Directory
        <form class="form-search pull-right">
                <div class="input-append">
                        <input type="text" class="span2 search-query">
                        <button type="submit" class="btn">Search</button>
                </div>
        </form>
        </h1>
</div>

<div class="container">
        <div class="navbar navbar-inverse">
                <div class="navbar-inner">
                        <div class="container" style="width: auto">
                                       <!-- Nav Bar Contents goes here, removed it to minimize the code -->
                        </div>
                </div>
        </div>
</div>

<div class="container">
        <div class="hero-unit">
                <h2><center>XYZ University - Academic Resource Directory</center></h2>
        Welcome to the Academic Resource Directory of XYZ University. All the resources related to academics can be found here!
        </div>

        <hr>

        <footer>
                <p>&#169; Copy 2012</p>
        </footer>
</div> 
```

这是我添加的另一个自定义 css 文件。

```
h1 {
font-size:1.8em;
}
h2 {
    font-size:1.4em;
}

img {
    float: left;
}

.logo {
    font:2.5em Arial;
    margin:0 0 10px 0;
    padding-top: 35px;
    width:auto;
    color:#000;
    height: 70px;
    float: left;

}

body {
    background: #fff;
    font-family:Arial;
font-size:0.8em;
}

.clear {
    clear:both;
} 
```

当我尝试向右浮动时，有时它也会出现在文本和图像之间或文本下方。我希望图像在左侧，图像右侧的文本和标题右端的搜索栏与文本对齐。请帮我设计我的标题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T17:22:26.093

您的`<H1>`. 修复此问题，然后继续您的 CSS 更改。

```
<h1 class="logo"> Resource Directory <!-- </h1> should be here -->
    <form class="form-search pull-right">
            <div class="input-append">
                    <input type="text" class="span2 search-query">
                    <button type="submit" class="btn">Search</button>
            </div>
    </form>
</h1><!-- Move </h1> so your form isn't enclosed --> 
```

# c# - SpecFlow 是否对“我应该”这句话有疑问

> ID：13748488
> 
> 赞同：2
> 
> 时间：2012-12-06T16:49:21.287
> 
> 标签：c#, specflow

场景大纲：
礼品卡

```
Given a user has purchased a gift card from a retail store  
When they complete their redemption with a <Card status>  
Then I should <Email status> 
```

例子：

```
| Card status | Email status          |
| Valid       | receive an e mail     |
| Invalid     | not receive an e mail | 
```

我很久以前在我的测试用例中编写了上述功能场景，并在大约一个月前将 specflow 文件更新到其最新版本（1.9），并且从那时起运行它并且运行良好。但是，昨天我运行了我的测试用例，在“那么我应该”这一行上出现了一个模棱两可的步骤定义错误

我尝试了许多更改，例如将其更改为“然后我应该 asdgasgqrg”，同时分别更改步骤定义文件。我也将其更改为“然后我应该 asgasg”并遇到了同样的问题。

我已经检查了整个解决方案中所有其他出现的“那么我应该”，并且我的文件只有一次出现。

当我将其更改为“Then a”时，它终于奏效了。所以我变得好奇并将我的步骤更改为“然后我必须”并分别更改步骤定义并且它起作用了。

我还在另一个导致相同问题的功能文件中将短语“我应该”更改为“我必须”并且它有效。

所以这是我的问题：specflow 中是否存在一些不喜欢“我应该”这个短语的问题（格式或语法方面）？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2014-09-26T09:04:07.223

我正在使用`I should`，它工作得很好：

```
Given I have events present in the Grid
When I click on navigation module on left Panel
Then I should be able to view the X module 
```

# css - 如果里面有 ul，如何使容器 100% 成为父容器

> ID：13748489
> 
> 赞同：0
> 
> 时间：2012-12-06T16:49:33.900
> 
> 标签：css, html, html-lists

我有标记：

[http://jsfiddle.net/ZVXFD/85/](http://jsfiddle.net/ZVXFD/85/)

我需要制作`.step`100% 的父容器，如何做到这一点。html:

```
 <div class="steps-container">
        <div class="group">
            <div class="step">
                <ul class="sortable">
                    <li class="item">Item</li>
                    <li class="item">Item</li>
                    <li class="item">Item</li>
                    <li class="item">Item</li>
                    <li class="item">Item</li>
                </ul>
            </div>
            <div class="step">
                <ul class="sortable">
                    <li class="item">Item</li>
                    <li class="item">Item</li>
                    <li class="item">Item</li>
                    <li class="item">Item</li>
                    <li class="item">Item</li>
                    <li class="item">Item</li>

                </ul>
            </div>
            <div class="step">
                <ul class="sortable">
                    <li class="item">Item</li>
                    <li class="item">Item</li>
                </ul>
            </div>
        </div>

    </div> 
```

CSS：

```
* {
    margin: 0px;
    padding: 0px;
}

ul {
    list-style-type: none;
    margin: 0px;
    padding: 0px;
    display: inline-block;
}

.sortable li {
    margin: 0px;
    padding: 0px;
    width: 100px;
    height: 100px;
    border: 1px solid black;
    background-color: lightgrey;
}

.group {
    display:inline-block;
    border: 1px solid red;
}

.step {
    border: 1px solid green;
    display:inline-block;
    background-color: yellow;
}

.item {
    background-color: lightgray;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T17:26:55.920

你可以设置`position: relative;`为`.group`

和

```
position: absolute;
top: 0;
left: 0;
right: 0;
bottom: 0; 
```

到`.step`

我假设您`.step`当时只显示一个元素，我错了吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T18:59:02.600

[http://jsfiddle.net/ZVXFD/94/](http://jsfiddle.net/ZVXFD/94/)

如果您希望 .group 为 100% 宽，则需要以下样式：

```
.group {
    border: 1px solid red;
    display:table; /* make the element 100% fill the entire available width */
    width: 100%;
} 
```

如果您希望 .step 等高，则需要以下样式：

```
.step {
    border: 1px solid green;
    display:table-cell; /* make the element 100% of its parent's height/equal height columns */
    background-color: yellow;
} 
```

# oracle - 在 oracle 中导出脚本中的更改（使用 Toad ？）

> ID：13748494
> 
> 赞同：0
> 
> 时间：2012-12-06T16:49:50.843
> 
> 标签：oracle, plsql, merge

我希望能够使用脚本将我在测试数据库中所做的所有更改导出到 Prod DB（我不能直接在 ProdDB 中修改数据）。

我想要一个从选择中生成合并脚本的工具。所以我可以直接在测试中更改我的数据，然后生成一个脚本，所以在产品上合并数据。

我蟾蜍能做到吗？有没有其他方法可以做瘦？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T17:27:22.693

生成合并脚本的最好方法是在开发过程中自己编写。

你在表中添加一列？写一行`alter table foo add (bar number);`，保存。

你掉一个？ `alter table foo drop column bar;`， 节省。

等等

不要依赖TOAD，要靠自己。您会惊讶地发现您了解 Oracle 中的工作原理的速度之快。

# android - 如何从另一个应用程序启动 Android Activity？

> ID：13748495
> 
> 赞同：2
> 
> 时间：2012-12-06T16:49:52.590
> 
> 标签：android, android-activity, sim-toolkit

我正在尝试编写一个启动 Android STK Activity 的应用程序，如下所示：

```
 Intent intent = new Intent(); 
            intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK); 
            intent.addCategory(Intent.CATEGORY_LAUNCHER); 
            intent.setAction(Intent.ACTION_MAIN); 
            intent.setComponent(new ComponentName("com.android.stk", "com.android.stk.StkLauncherActivity")); 
            startActivity(intent); 
```

我不断收到以下错误：

```
android.content.ActivityNotFoundException: Unable to find explicit activity class {com.android.stk/com.android.stk.StkLauncherActivity}; have you declared this activity in your AndroidManifest.xml? 
```

我在清单中声明了以下内容：

```
<activity android:name="com.android.stk.StkLauncherActivity"/> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-06T17:10:31.850

尝试使用[PackageManager.getLaunchIntentForPackage](http://developer.android.com/reference/android/content/pm/PackageManager.html#getLaunchIntentForPackage%28java.lang.String%29)，它返回在给定包中启动前门活动的意图：

```
 PackageManager manager = getPackageManager(); 
   Intent intent =manager.getLaunchIntentForPackage("com.android.stk"); 
   if (intent != null)  
    startActivity(intent); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T16:54:31.760

看起来像你这边的错字

```
com.android.stk/com.android.stk2.StkLauncherActivity 
```

`stk`还是`stk2`？:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T06:18:37.147

试试下面的代码片段

```
final Intent intent = new Intent(Intent.ACTION_MAIN, null);

intent.addCategory(Intent.CATEGORY_LAUNCHER);
final ComponentName cn = new ComponentName("com.abc.xyz", "com.abc.xyz.MainActivity");
intent.setComponent(cn);
intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
startActivity( intent); 
```

有关更多详细信息，请[点击此链接](http://glorious-arvind.blogspot.in/2012/11/launching-other-application-using-code.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-06T17:01:09.600

要从另一个应用程序启动活动，您可以在您的活动所属的应用程序的android清单的活动意图过滤器中设置“动作”。在启动时为意图设置相同的“动作”

# css - z-index 问题下拉列表出现在内容下方

> ID：13748506
> 
> 赞同：0
> 
> 时间：2012-12-06T16:50:38.537
> 
> 标签：css, z-index

我一生都无法弄清楚为什么下拉菜单显示在顶层架子上的项目下方。我已经正确设置了 z-indexes 和位置，我只是遗漏了一些东西或把东西放在了错误的地方。

任何人都在这里帮助我。

页面链接：http: [//www.chelleon.co.uk/environ-skincare](http://www.chelleon.co.uk/environ-skincare)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T17:12:12.977

`header`你的div上的 z-index是`z-index:1;`

你的 z-index`top-shelf-products`是`z-index:1;`

将标题的 div 更改为`z-index:2;`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T17:02:39.853

您需要将 z-index 应用于 .header 才能使其正常工作：

```
.header {
    .....
    z-index: 1;
} 
```

原因是您想要在其父元素上放置 z-index 的元素的 z-index 并不比出现在所述元素上方的元素高...`confused with my text, cus i am!`

# javascript - 我的 jQuery 悬停淡入淡出效果有什么问题？

> ID：13748508
> 
> 赞同：0
> 
> 时间：2012-12-06T16:50:42.143
> 
> 标签：javascript, jquery, mouseover, fadein, fadeout

[http://leongaban.com/_stack/fade/](http://leongaban.com/_stack/fade/)

我刚接触 jQuery，那里有很多关于如何进行简单淡入淡出的教程，但是来自 AS3 背景，我的代码似乎应该可以工作，我很好奇为什么它不不。

*   在 rollOver 黄色框淡出
*   然而，在推出时，黄色框有点淡出然后再次淡入

不知道为什么它会“反弹”鼠标悬停功能......想法？

HTML

```
<div class="fade">
    <h2>The Title</h2>

    <p>Lorem ipsum.</p>
</div> 
```

jQuery

```
<script>

    (function() {

        var fade = $('div.fade');

        fade.mouseover(function() {

                fade.fadeOut(500);

        });

        fade.mouseout(function() {

            fade.fadeIn(600);
        });

    })();

</script> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-06T16:54:07.203

这是因为你正在淡出`mouseover`。淡出完成后，该元素将被隐藏。所以当你移动鼠标的那一刻，一个`mouseout`事件就被注册了，然后它又淡入了。

尝试使用`.animate({opacity: 0}, 600);`， `.animate({opacity: 1}, 600);`等等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T16:54:05.447

您应该考虑使用`mouseenter`/`mouseleave`代替。

看看 - [http://www.quirksmode.org/js/events_mouse.html](http://www.quirksmode.org/js/events_mouse.html)

hoverintent[插件](http://cherne.net/brian/resources/jquery.hoverIntent.html)也值得一试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-06T16:56:10.170

您应该使用`mouseenter`and`mouseleave`函数。`mouseover`每次鼠标进入或离开元素时触发。

检查[演示](http://api.jquery.com/mouseover/)以查看`mouseover`实际情况，并了解为什么它不是正确的事件。

# database - 日期转换，节省一天时间

> ID：13748510
> 
> 赞同：0
> 
> 时间：2012-12-06T16:50:55.697
> 
> 标签：database, oracle

我有一些来自 oracle 的旧数据，时间以 Java 生成的毫秒数为单位。

我使用这种转换：

```
to_date('19700101000000','YYYYMMDDHH24MISS')+ column/86400 
```

而且它总是与实际时间相差 5 小时（我不知道为什么），所以我直接从上面的日期中减去 5/24。

但它没有白天转换，所以在冬天它是正确的，但对于夏天它是 1 小时轮班。我该如何解决这个问题？

此外，如果有人能指出为什么有 5 小时轮班，将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T17:11:48.333

5 小时班次可能是由于您的本地时间（中央时区，基于您的用户名）和 UTC 时间之间的差异造成的。实际上班次应该是 6 小时（CST 是 UTC - 6），所以你可能已经把它倒退了；您的夏令时可能更接近正确，而您的冬令时仍然相差一个小时。

# objective-c - 检查 NSString 是否存在于 NSArray 的自定义对象中

> ID：13748511
> 
> 赞同：0
> 
> 时间：2012-12-06T16:50:57.543
> 
> 标签：objective-c, ios, nsarray

我有一个`NSArray`对象`Store`。每个`Store`对象有两个`NSString`对象；`StoreID`和`Name`。我想快速检查对象中是否存在`NSArray`ID `Store`。

例子：

```
Store *s1 = [[Store alloc] init];
s1.name = @"Some Name";
s1.id = @"123ABC";

Store *s2 = [[Store alloc] init];
s2.name = @"Some Other Name";
s2.id = @"ABC123";

NSArray *array = [[NSArray alloc] initWithObjects:s1, s2, nil];

NSString *myIdOne = @"ABCDEF";
NSString *myIdTwo = @"123ABC";

BOOL myIdOneExists = ...?
BOOL myIdTwoExists = ...? 
```

它是`...?`我需要弄清楚的。我知道我可以使用`for`循环来做到这一点，并在找到时中断......但这在我看来是一种令人讨厌的方法，因为它`NSArray`可能包含数千个对象，......理论上。
所以我想知道一个更好的解决方案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-06T18:34:30.757

事情是这样的：无论你采用什么解决方案，它或多或少都会归结为“遍历数组并返回是否找到对象”。除非满足非常具体的条件（例如，数组已经按您正在搜索的值排序），否则没有办法比这更快地搜索数组。您可以使用谓词，可以使用枚举器，可以使用快速枚举，也可以使用测试块——在后台，它们都相当于“遍历数组并执行测试”。这就是数组的工作方式。

如果这是您需要经常做的事情，并且性能是幼稚解决方案的问题，那么明智的解决方案可能是将您的 ID 缓存在 NSSet 中。集合已针对快速成员检测进行了调整，因此您应该能够比使用数组更快地获得答案。

我个人的“loop-over-the-array”解决方案：

```
BOOL idExists = NSNotFound != [stores indexOfObjectPassingTest:^(Store *store, NSUInteger idx, BOOL *stop) {
    return [store.id isEqualToString:@"whatever"];
}]; 
```

（写在浏览器中，所以，你知道，警告编译器。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-06T16:58:10.597

试试这个：

```
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"%K == %@",@"id", myID];
NSArray *filteredArray = [array filteredArrayUsingPredicate:predicate];
if (filteredArray.count > 0)
  Store *store = [filteredArray objectAtIndex:0]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-06T17:02:28.857

最简单的解决方案，只需使用 KVC：

```
NSArray *results = [array valueForKey:@"id"];
BOOL myIdOneExists = [results containsObject:myIdOne];
BOOL myIdTwoExists = [results containsObject:myIdTwo]; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-06T17:06:43.483

```
-(BOOL) id:(NSString*) theId existsInArray:(NSArray*) theArray {
    for (Store* theStore in theArray) {
        if ([theStore.id isEqualToString theId]) {
            return YES;
        }
    }
    return NO;
} 
```

另一种方法是实现仅比较 ID的`isEqual`方法。`Store`然后使用您要查找的 ID 构造一个虚拟`Store`对象并使用`indexOfObject`or `containsObject`，引用您的虚拟`Store`对象。

# imap - 如何向 imap 获取请求添加多个参数？

> ID：13748518
> 
> 赞同：1
> 
> 时间：2012-12-06T16:51:18.307
> 
> 标签：imap

是否可以在获取请求中添加多个参数？

（工作）仅请求带有一些参数的正文：

```
icFetch FETCH 1 (body[header.fields (from to subject date)])\r\n 
```

（不工作）带有一些参数和标志的请求正文：

```
icFetch FETCH 1711:* (body[header.fields (from to subject date)]) (FLAGS (\Unseen))\r\n 
```

谢谢！

问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T22:26:33.130

是的，你有额外的括号！

你要 `icFETCH 1711:* (BODY[HEADER.FIELDS (...)] FLAGS UID INTERNALDATE)`

我认为您不能只获取这样的特定标志。

# php - PHP/MySQL 面试——你会怎么回答？

> ID：13748521
> 
> 赞同：0
> 
> 时间：2012-12-06T16:51:41.863
> 
> 标签：php, mysql

我被问到这个面试问题，所以我想我会把它贴在这里看看其他用户会如何回答：

`Please write some code which connects to a MySQL database (any host/user/pass), retrieves the current date & time from the database, compares it to the current date & time on the local server (i.e. where the application is running), and reports on the difference. The reporting aspect should be a simple HTML page, so that in theory this script can be put on a web server, set to point to a particular database server, and it would tell us whether the two servers’ times are in sync (or close to being in sync).`

这是我放的：

```
// Connect to database server
$dbhost = 'localhost';
$dbuser = 'xxx';
$dbpass = 'xxx';
$dbname = 'xxx';

$conn = mysql_connect($dbhost, $dbuser, $dbpass) or die (mysql_error());

// Select database
mysql_select_db($dbname) or die(mysql_error());

// Retrieve the current time from the database server
$sql = 'SELECT NOW() AS db_server_time';

// Execute the query
$result = mysql_query($sql) or die(mysql_error());

// Since query has now completed, get the time of the web server
$php_server_time = date("Y-m-d h:m:s");

// Store query results in an array
$row = mysql_fetch_array($result);

// Retrieve time result from the array
$db_server_time = $row['db_server_time'];

echo $db_server_time . '<br />';
echo $php_server_time;

if ($php_server_time != $db_server_time) {
    // Server times are not identical

    echo '<p>Database server and web server are not in sync!</p>';

    // Convert the time stamps into seconds since 01/01/1970
    $php_seconds = strtotime($php_server_time);
    $sql_seconds = strtotime($db_server_time);

    // Subtract smaller number from biggest number to avoid getting a negative result
    if ($php_seconds > $sql_seconds) {
        $time_difference = $php_seconds - $sql_seconds;
    }
    else {
        $time_difference = $sql_seconds - $php_seconds;
    } 

    // convert the time difference in seconds to a formatted string displaying hours, minutes and seconds
    $nice_time_difference = gmdate("H:i:s", $time_difference);

    echo '<p>Time difference between the servers is ' . $nice_time_difference;
}
else {
    // Timestamps are exactly the same
    echo '<p>Database server and web server are in sync with each other!</p>';
} 
```

是的，我知道我使用了已弃用的 mysql_* 函数，但除此之外，您将如何回答，即您将进行哪些更改以及为什么？是否有任何我遗漏的因素需要考虑？

有趣的是，在我的主机帐户上执行时，我的结果似乎总是相隔精确的分钟数：

`2012-12-06 11:47:07`

`2012-12-06 11:12:07`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T17:01:03.797

这将是我的大部分代码：

```
$db = new PDO(...);
$dbTime = new DateTime(current($db->query('SELECT NOW()')->fetchAll(PDO::FETCH_COLUMN, 0)));
$myTime = new DateTime();
$diff = $myTime->diff($dbTime);
// do stuff with $diff 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-06T16:56:49.407

```
$php_server_time = date("Y-m-d h:m:s"); 
```

将时间格式化为年-月-日时：月：秒。这解释了服务器时间似乎是的事实`11:12:07`。它实际上说它是十二月。数据库时间和服务器时间正好相差 35 分钟，这将是*非常*令人惊讶的。即使没有“确切地”这个词，也会令人惊讶。

分钟是`i`格式字符串。

* * *

除此之外，时间相差一秒并不一定意味着数据库与服务器不完全同步。这可能只是意味着测量之间经过了一些（任意小）时间。如果要验证同步，可以在服务器上进行两次测量，一次在查询之前，一次在查询之后，并进行范围比较，或者简单地进行增量比较时间（abs(t1-t2)<=1s）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-06T16:56:07.667

您放弃了对已弃用`mysql_`功能的使用，但如果我在求职面试中问这个问题，那将是红旗＃1。它会告诉我，要么你没有跟上当前 PHP 的最佳实践，要么你不在乎。

我担心那段代码的另一件事是您没有指定 MySQL 为您提供时间的格式。我想明确指定输出格式，以便您不依赖任何服务器设置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-06T17:12:33.513

会使用 PDO 和查询：

```
SELECT UNIX_TIMESTAMP() 
```

在代码中：

```
$time_difference = abs($PDOStatement->fetchColumn() - date('U')); 
```

并且可能会在差异时宣布时间“大致相同”`<= 1`

# php - 验证用户是否属于 ldap/活动目录安全组

> ID：13748524
> 
> 赞同：1
> 
> 时间：2012-12-06T16:51:53.750
> 
> 标签：php, active-directory, ldap

好的...我已经在这里挖掘了示例等，但我仍然遇到问题。

```
<?php
// SHOW ERRORS 0=NO 1=YES
ini_set('display_errors', '1');

//USER
$valid_session_username = $_POST["username"];
$valid_session_password = $_POST["password"];

//MEMBER OF THIS GROUP
$dn = "DC=FLRC,DC=local";
$group = "CN=Internet-Purchasing-Allowed,OU=Security Groups,DC=FLRC,DC=LOCAL";
$filter = "(&(objectClass=user)(memberOf=$group))";

$ad = ldap_connect("srv-flc-dc03") or die("Couldn't connect to AD!");
ldap_set_option($ad, LDAP_OPT_PROTOCOL_VERSION,3);
ldap_set_option($ad, LDAP_OPT_REFERRALS,0);
$bd = ldap_bind( $ad, $valid_session_username."@flrc.local", $valid_session_password) or die("Can't bind to server.");
$sr = ldap_search($ad, $dn, $filter);

$found = false;

if ($sr !== false) {
    $count = ldap_count_entries ($ad, $sr);
    if ($count !== false && $count > 0) {
     $found = true;
    }
}

if ($found === true) {
    print $valid_session_username.' does have access to this page';
} else {
    print $valid_session_username.' does NOT have access to this page';
}

?> 
```

我不知道我错过了什么。当我提交我的凭据时，它显示“SRAY 确实有权访问此页面”。这是它应该说的，因为 SRAY 是该组的一部分。它还为不属于该安全组的另一个用户名/密码说明了这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T16:59:55.700

您的过滤器正在寻找**任何**属于 Internet-Purchasing-Allowed 组的直接成员的用户。您需要将 (sAMAccountName=$valid_session_username) 添加到您的过滤器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-12T07:48:08.103

1.  您必须在过滤器中定义**sAMAccountname**

    ```
    //MEMBER OF THIS GROUP
    $dn = "DC=FLRC,DC=local";
    $group = "CN=Internet-Purchasing-Allowed,OU=Security Groups,DC=FLRC,DC=LOCAL";
    $filter = "(&(objectClass=user)(sAMAccountname=".$valid_session_username.")(memberOf=".$group."))"; 
    ```

2.  您必须将 LDAP 与具有必要权限的帐户绑定。创建一个对所有“OU=Security Groups”具有读取权限的管理员**帐户。**然后在你的代码中绑定它。

    ```
    $bd = ldap_bind( $ad, $admin_session_username."@flrc.local", $admin_session_password) or die("Can't bind to server."); 
    ```

# telerik-combobox - RadComboBox 设置要显示的项目数

> ID：13748526
> 
> 赞同：1
> 
> 时间：2012-12-06T16:51:58.863
> 
> 标签：telerik-combobox

有没有办法指定要为 RadComboBox 下拉菜单显示的项目数？

我已经看到有一个属性来设置查找窗口高度，它设置下拉菜单在弹出窗口的高度，但与下拉菜单中一次显示的项目数无关。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T09:52:18.717

您可以在使用机制时指定多个项目，该[**`ShowMoreResultsBox`**](http://www.telerik.com/help/aspnet-ajax/combobox-load-on-demand-showmoreresultsbox.html)机制在下拉列表中提供可点击按钮以在存在时检索更多结果。

上面的链接提供了说明，这里是截图：

* * *

![在此处输入图像描述](../Images/a630c2787574eae3166ba5257bb7d607.png)

* * *

具体来说，您将**`itemsPerRequest`**属性设置为您需要的值，对于上面的照片，该值已设置为**`10`**并因此填充了初始请求中的许多项目的框。

# android - 裁剪的 Android < 4.1 的 WebView HTML5 视频或 3D 渲染器

> ID：13748528
> 
> 赞同：3
> 
> 时间：2012-12-06T16:52:13.373
> 
> 标签：android, html, android-webview

我在我的项目中使用 WebView 小部件来显示 HTML5 视频或 HTML5 中的不同内容。`MATCH_PARENT`如果我的 WebView 在并适合我的屏幕设备，我可以毫无问题地呈现这些 HTML5 页面（使用视频或不使用视频） 。

当我在固定大小的 WebView 中看到 HTML5 视频和其他 HTML5 元素（使用 3D 属性？检查进度...）时出现问题。我想我的问题是在 WebView 渲染一些元素时发生的`SurfaceView`，当 WebView 布局参数不是时，这会导致内容发生变化`MATCH_PARENT`。

让我用一个例子来解释一下，考虑一个 800 * 600 的设备，我决定将我的 webview 居中，它的宽度为 400px。所以我可以在 webview 的右侧看到 100px，在左侧看到 100px，正常。我看到我的 HTML5 视频向右裁剪。裁剪的宽度是屏幕左边框与 webview 左侧之间的偏移量。如果我增加 webview 左侧的空间，裁剪将具有与该空间相同的值。

从 youtube 页面，HTML5 内容以与我的 webview 相同的大小正确显示，但只是我的视频 HTML5 元素被裁剪......为了更好地理解，我让你看一下更容易理解的截图......

[http://android.googlecode.com/issues/attachment?aid=405500000000&name=webviewhtml5-vimeo-cropped.png&token=2lYIR8vnq0aGAHjQ4Ppvj9bs6hg%3A1354812792302&inline=1](http://android.googlecode.com/issues/attachment?aid=405500000000&name=webviewhtml5-vimeo-cropped.png&token=2lYIR8vnq0aGAHjQ4Ppvj9bs6hg%3A1354812792302&inline=1)

从 Android 3.x 到 4.0.x 出现问题。从运行 Android 4.1 和三星 Galaxy S III Android 4.1 的 Nexus S 手机，问题得到解决。

我很惊讶地发现没有人在 bugreport 或 stackoverflow 上报告过这个问题？一般来说，我认为webview是全屏使用的。

如果您可以使用基本项目重现此问题，请转到此地址：

[http://code.google.com/p/android/issues/detail?id=40550](http://code.google.com/p/android/issues/detail?id=40550)

# c++ - Bresenham 线绘制算法

> ID：13748531
> 
> 赞同：0
> 
> 时间：2012-12-06T16:52:17.630
> 
> 标签：c++, c, algorithm, bresenham

Bresenham 的浮点算法中有一些东西让我很恼火。

算法如下：

```
void line(x0, x1, y0, y1)
{
  int deltax = x1 - x0;
  int deltay = y1 - y0;
  float error = 0;
  float deltaerr = Math.abs((float)deltay / (float)deltax);
  int y = y0

  for(int x=x0;x<=x1;x++)
  {
    SetPixel(x,y)
    error = error + deltaerr
    if (error >= 0.5)
    {
             y = y + 1
             error = error - 1.0
    }
  }
} 
```

假设我们要绘制**Y=0.6X**。因此，在 x=0 的第一步中：错误将设置为 0.6，我们将运行 if 语句并且 y 会增加。并且错误将设置为-0.4。-0.4 将如何帮助我们下一步？

所以我的问题是这行代码：

```
error = error - 1.0 
```

为什么我们应该将错误减少 1 ？我读过我们这样做是因为重新调整！它对我们有何帮助？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-06T17:05:43.340

错误是累积的。当它大于半个像素时，线移动一个像素，然后必须纠正错误，再次纠正一个完整的像素。

如果您只是将错误归零，您只会抵消部分错误，因此该线将过早地再次步进并且将是错误的梯度。

在您的 y = 0.6x 示例中，如果您计算错误但将其归零，则会发生以下情况：

```
error = 0;
plot pixel;
increment error. error = 0.6;
error > 0.5, so move over and reset error to 0;
plot pixel;
increment error. error = 0.6;
error > 0.5, so move over and reset error to 0;
plot pixel;
increment error. error = 0.6;
error > 0.5, so move over and reset error to 0;
... 
```

所以这条线实际上有一个梯度为1；事实上，任何梯度 >= 0.5 的线都会出现相同的结果，这显然不是很有用。

如果你做对了：

```
error = 0;
plot pixel;
increment error. error = 0.6;
error > 0.5, so move over and subtract one; error = -0.4;
plot pixel;
increment error. error = 0.2;
plot pixel;
increment error. error = 0.8;
error > 0.5, so move over and subtract one; error = -0.2;
... 
```

该线具有正确的梯度，因为该误差充当了定点计算的小数部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T17:01:26.343

`error`是`ideal_y-current_y`

当我们进入循环的下一次迭代时，我们增加`x`而不接触`y`. `error=error+deltaerr`是`error`此操作后的更新。

如果我们决定增加`y`，我们必须再次更新`error`，就是这样`error=error-1`。

# php - jquery和php结合？

> ID：13748533
> 
> 赞同：-6
> 
> 时间：2012-12-06T16:52:22.130
> 
> 标签：php, jquery, mysql

我正在做一个到目前为止涉及使用 php 和 mysql 的项目（我是 web 开发的新手）。但是，我现在想为我的最终网站编写拍卖代码。对定时拍卖的重要性的明显关注使我开始使用 javascript，然后使用 jquery。我已经阅读了一些关于它的内容，但像往常一样，它有点让人不知所措，所以我只是想知道是否有人可以为我的研究指明正确的方向。

基本上，我很担心 mysql 中的数据在拍卖期间如何不断更新 - 例如当前出价。大概计时器以某种方式不断触发我的 php.ini 中的更新。所以我在这里问的问题是jquery如何触发我的php中发生的事情？或者jquery可以自己更新mysql吗？其次，计时器信息存储在哪里。

在 php 中，我了解当有人访问某个拍卖页面时，只需使用动态变量和 get 函数即可获得数据。我可以很好地做到这一点。但是，如果您理解我的话，计时器如何知道每个页面（对于每个相应的拍卖）显示的时间？如果有人可以简单地概述工作中的概念，我将非常感激。谢谢你的时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T17:02:59.283

> 所以我在这里问的问题是jquery如何触发我的php中发生的事情？或者jquery可以自己更新mysql吗？

PHP 是一种服务器端语言，这意味着它在 Web 服务器上运行、被解析并执行代码并将生成的 HTML 代码发送到客户端。

Javascript（以及因此的 jQuery）在客户端（即浏览器）上运行。客户端操作实际上不能执行任何服务器操作，其中之一是访问 mySql 数据库。

您要做的是将数据发送到您的 PHP 脚本，然后将其保存到数据库中。

> 但是计时器如何知道每个页面的显示时间（对于每个相应的拍卖）

基本上你需要用一个很好的近似时间来工作。如果您知道拍卖什么时候结束并且您知道现在是什么时间，那么您可以计算剩余时间并使用 javascript/jquery 可以显示剩余时间。

您可能需要一种从服务器到客户端来回通信的快速方法。一种称为[Ajax](http://www.w3schools.com/ajax/default.asp)的技术，它可以做到[这一点](http://www.w3schools.com/ajax/ajax_aspphp.asp)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T16:58:43.810

Javascript 是在客户端处理的，假设有人正在查看您的网站并查看产品，突然该产品被超标，一个好的和坏的解决方案是使用 ajax 请求，这对于使用 Jquery 来说非常简单。

然后，您可以从让我们说 itembid.php?id=429 获取信息，并获取项目 ID 的当前出价。

假设您在网页上也有一个计时器（javascript）来检查这一点，然后每个客户都会自动收到一个请求，以查看该项目是否每 x 秒被高价收购。

希望我理解你的正确。

这可能会有所帮助。

[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

# sql - SQL：从具有相同外键的 n 条记录中保留一条记录

> ID：13748534
> 
> 赞同：0
> 
> 时间：2012-12-06T16:52:24.840
> 
> 标签：sql, sybase

我有一些记录，只想保留客户的最低（最小）数字：

这：

```
Customer | Number
1        | 2
1        | 4
2        | 1
1        | 3
2        | 2 
```

应该通过sql转换为：

```
Customer | Number
1        | 2
2        | 1 
```

使用 Sybase ADS 本地表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T16:56:41.840

您应该能够使用`min()`和分组`customer`：

```
select customer, min(number)
from yourtable
group by customer 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/5ae3b/2)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T16:55:38.053

```
SELECT Customer, MIN(Number)
FROM your_table
GROUP BY Customer; 
```

# visual-studio-2010 - 在 Visual Studio 中以编程方式获取书签

> ID：13748536
> 
> 赞同：6
> 
> 时间：2012-12-06T16:52:33.220
> 
> 标签：visual-studio-2010, visual-studio, visual-studio-extensions, visual-studio-macros

我正在使用 VS 2010，我想做一些非常简单的事情。编写一个宏/加载项，它将

*   将书签保存到文件（例如“myfile.bookmarks”）
*   从文件加载书签。

`DTE`我只是在（编写宏时）中找不到任何 API，`Microsoft.VisualStudio`在创建插件时也无法在命名空间中找到任何东西。

有人可以帮忙吗？

* * *

（我要避免的一件事是重新创建书签功能，尽管我可以使用[Numbered Bookmarks 扩展](http://www.codeproject.com/Articles/61915/Numbered-Bookmarks-Visual-Studio-Extension-VSX-201)中的代码）。

# c - printf/scanf 的输入/输出替代方案

> ID：13748539
> 
> 赞同：3
> 
> 时间：2012-12-06T16:52:39.553
> 
> 标签：c, printf, scanf

对 iOS 有很多了解并在 .net 方面有一些经验，这听起来很奇怪，我是 C 的新手。在某个地方我得到了这个目标，即在不使用`printf`and的情况下找到 n 个数字的平均值`scanf`。我不想要该程序的代码，但我正在寻找上述功能的替代品。

这里需要代码`printf/scanf`吗？如果我的查询无效，也请告诉我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-06T16:57:18.300

不，这`printf`也不`scanf`是真正需要的。

显而易见的替代方法是使用类似`getc`或的内容读取输入，并使用类似的内容`fgets`将字符转换为数字`strtol`。

在输出端，您或多或少会颠倒过来，将数字转换为字符（例如，`itoa`这很常见，但实际上并不标准），然后打印出结果字符串（例如，使用 fputs）。

# javascript - 读取多个文件后的回调函数

> ID：13748543
> 
> 赞同：2
> 
> 时间：2012-12-06T16:52:49.753
> 
> 标签：javascript, jquery, html, file-io

我正在做类似于[http://www.html5rocks.com/en/tutorials/file/dndfiles/](http://www.html5rocks.com/en/tutorials/file/dndfiles/)

我正在做的是我一次读取一个选定文件的内容，以验证它们的行是否通过了一些正则表达式测试。完成验证所有文件后，我需要相应地更新（启用/禁用）一些按钮，因此回调功能

是否有可能有一个回调函数在读取所有内容后执行某些操作？

### HTML：

```
<input type="file" id="files" name="files[]" multiple /> 
```

### Javascipt：

```
<script>
  function handleFileSelect(evt) {
    var files = evt.target.files; // FileList object

    // files is a FileList of File objects. List some properties.
    var validArray = [];
    for (var i = 0, f; f = files[i]; i++) {
        //Create new file reader
        var r = new FileReader();
        //On load call
        r.onload = (function (f) {
            return function (e) {
                var contents = e.target.result;
                var lines = contents.split('\n');

                for(var i=0; i<lines.length; i++){
                    //Validate regex of line here
                    //If line does not pass, append file name to validArray and break  
                }

            };
        })(f);
        r.readAsText(f);
    }
  }

  document.getElementById('files').addEventListener('change', handleFileSelect, false);
</script> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-21T18:16:41.887

来这里寻找类似的答案。我想在加载和处理所有文件后调用一个函数。@Snuffleupagus 提供的解决方案对我不起作用，因为在读取所有文件之后调用该函数，但在 onload 函数完成处理之前调用该函数。我找到了一个解决方案，如下所示（不确定它是否是“最干净的”，但它对我有用）。

```
var processedCount=0; // global variable
var totalFiles = 0; // global variable

function handleFileSelect(evt) {
  var files = evt.target.files; // FileList object

  totalFiles = files.length; // important

  // files is a FileList of File objects. List some properties.
  for (var i = 0, f; f = files[i]; i++) {
    //Create new file reader
    var r = new FileReader();
    //On load call
    r.onload = (function(theFile){
        return function(){
          onLoadHandler(this,theFile);
          onLoadEndHandler();
       };
    })(f);
    r.readAsText(f);
  }
}

function onLoadEndHandler(){
  processedCount++;
  if(processedCount == totalFiles){ 
    // do whatever - this code will run after everything has been loaded and processed
  }
} 
```

我尝试使用 r.onloadend 但它被调用得太早了。我相信因为我的函数'onLoadHandler'需要几秒钟来处理每个文件，并且在文件加载完成但在'onload'中的代码完成运行之前调用onloadend。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-06T17:21:51.490

绝对地。回调只是像任何其他普通参数一样传递，因此我们最终将添加另一个参数并将事件侦听器更改为使用额外参数`handleFileSelect`调用的匿名函数。`handleFileSelect`

我设置了一个[小提琴](http://jsfiddle.net/bSdsM/)来给你一个快速的工作演示。

```
function handleFileSelect(evt, cb) {
    var files = evt.target.files; // FileList object

    // files is a FileList of File objects. List some properties.
    var output = [];
    for (var i = 0, f; f = files[i]; i++) {
      output.push('<li><strong>'+ escape(f.name) + '</strong>');
    }
    document.getElementById('list').innerHTML = '<ul>' + output.join('') + '</ul>';
    if(cb) cb();
}
document.getElementById('files').addEventListener('change', function(e){handleFileSelect(e, function(){alert('all done');})}, false);​ 
```

打破它 - 添加了一个额外的参数，`handleFileSelect`并在最后添加`if(cb) cb();`。这只是检查 cb 是否存在，如果存在，则将其作为函数运行。

然后，当我们去绑定事件处理程序而不是传递对我们的引用时，`handleFileSelect`我们使用了一个匿名函数——这让我们可以传递额外的参数。

匿名函数内部的匿名函数只是我们的回调，如果您愿意，它可以是对函数的引用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-21T18:55:30.470

一个非常干净的方法是使用[async.js reduce](https://github.com/caolan/async#reduce)方法。 [Async.js](https://github.com/caolan/async)提供了许多很好的方法来处理多个回调。您可以使用 reduce 遍历文件名数组，并构建一个缩减值，该值是有效行的数组：

```
<input type="file" id="files" name="files[]" multiple />
<script type='text/javascript' src='https://github.com/caolan/async/raw/master/lib/async.js'/>
<script>
var isValidLine = function(text){
// todo: implement
}

function handleFileSelect(evt) {
    var files = evt.target.files; // FileList object
    // reduce by starting with empty array in second argument - 
    // this gets built up with the valid array lines
    async.reduce(files, [], function(validLinesSoFar, file, callback){
        var r = new FileReader();
        // Read file here:
        r.onload = function (f) {

            var contents = f.target.result;
            var lines = contents.split('\n');

            for(var i=0; i<lines.length; i++){
                if isValidLine(lines[i])
                    validLinesSoFar.push(lines[i]);    
            }
            callback(null, validLinesSoFar); 
        };

        r.readAsText(file);
    }, function(err, validLines){
        // gets called after every file iterated through
        // result is entire valid array
        // do something here with valid array
    });
}

  document.getElementById('files').addEventListener('change', handleFileSelect, false);
</script> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-06T17:21:29.260

我会看看jQuery的[延迟对象](http://api.jquery.com/category/deferred-object/)

也是一个可能适用于您的非常相关的问题。

[在Jquery中完成for循环后如何触发回调函数？](https://stackoverflow.com/questions/11046456/how-to-fire-a-callback-function-after-a-for-loop-is-done-in-jquery)

# ant - 使用 Ivy 发布文件时是否尊重 [conf] 令牌？

> ID：13748544
> 
> 赞同：1
> 
> 时间：2012-12-06T16:52:50.243
> 
> 标签：ant, configuration, build, ivy

我正在学习 Ivy (http://ant.apache.org/ivy/) 并将其集成为我们构建过程的一部分。进展顺利，但我被 Ivy 发布任务困住了。具体来说，我想使用以下模式（包括当前配置的名称）发布到本地存储库：

**${ivy.local.default.root}/[organisation]/[module]/[revision]/[type]s/[conf]/[artifact].[ext]**

所以我设置了我的自定义解析器：

```
<filesystem name="modifiedLocalRepo">
    <ivy pattern="${ivy.local.default.root}/[organisation]/[module]/[revision]/[type]s/[conf]/[artifact].[ext]" />
    <artifact pattern="${ivy.local.default.root}/[organisation]/[module]/[revision]/[type]s/[conf]/[artifact].[ext]" />
</filesystem> 
```

并配置了发布任务：

```
<ivy:publish 
    settingsRef="ivy.ext.settings.custom" <!--Location of definition of modifiedLocalRepo-->
    resolver="modifiedLocalRepo" 
    artifactspattern="bin/Debug/[module].[ext]" 
    pubrevision="1.1-Test" 
    overwrite="true"
    conf="primary"
/> 
```

并在 ivy.xml 文件中定义 conf：

```
<info organisation="Mine" module="Dependency"/>
<configurations defaultconf="primary"> <!--Don't think defaultconf should be necessary-->
    <conf name="primary"/>
</configurations>
<publications>
    <artifact name="Dependency" ext="dll" type="bin" conf="primary"/>
    <artifact name="Dependency" ext="pdb" type="bin" conf="primary"/>
</publications> 
```

我已经完成了流程、配置、解析、项目构建和发布的工件（使用我上面的自定义解析器）。但是 [conf] 令牌总是解析为“默认”。所以发布的目录结构如下：

**\.ivy2\local\Mine\Dependency\1.1-Test\bins\default\**

而不是结构

**\.ivy2\local\Mine\Dependency\1.1-Test\bins\primary\**

我一直在修改它，设置 conf 值、defaultconf 值等。在它们有效的任何地方，但它始终是“默认值”。

我正在使用 ant 进行构建，并在调试模式 (-d) 下运行，检查了输出并发现没有任何用处。我查看了 <echoproperties\> 的输出，发现没有任何用处。我通读了 Ivy 文档，只发现在检索和报告输出中使用 [conf] 作为令牌。

如果有用的话，我可以附上我用来进行有限测试构建的完整 xml 文件。

[conf] 令牌在 Ivy 发布的工件模式中是否有效/受尊重？如果是这样，我错过了什么？谢谢！

**更新：** 正在使用 Ivy 2.3.0-rc2 并决定尝试回滚并使用 Ivy 2.0.0。同样的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T19:57:04.417

看看我在[github](http://github.com/qazwart/ivy.dir)上的 Ivy 项目。我进行了设置，因此您可以轻松地将其添加到现有的 Ant 项目中。

我们使用一个 Maven 存储库，所以我设置它来创建一个`pom.xml`，然后使用`mvn deploy:deploy-file`它来将它部署回 Maven 存储库。我们使用 Jenkins 进行构建，所以我们使用 Jenkins 来运行`mvn deploy-file`部署。我想我们可以使用`<ivy:publish>`，但从未真正尝试过。

# ruby - 将唯一变量传递给 Ruby 线程

> ID：13748547
> 
> 赞同：2
> 
> 时间：2012-12-06T16:52:59.230
> 
> 标签：ruby, multithreading, variables

我正在`for`循环中创建线程，并且我想使用`for`循环`i`作为每个特定线程的名称。当我运行它时，我得到的是,而不是`1`,`2`或`2`, 。有没有更好/更安全的方法将变量传递到线程中？`1``2``2`

```
ts = []
for i in 1..2 do
  ts.push( Thread.new(i) do
    x = i
    puts x
  end)
end
ts.each do |t|
  t.join()
end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T17:04:05.927

您的问题是`i`您所指的不是传递给线程的块变量，而是在线程`i`外部定义的。你需要添加`|i|`它，你会得到`1`,`2`或`2`, `1`。

```
ts = []
for i in 1..2 do
  ts.push( Thread.new(i) do |i|
    x = i
    puts x
  end)
end
ts.each do |t|
  t.join()
end 
```

顺便说一句，一个更红的写法是：

```
ts = (1..2).map do |i|
  Thread.new(i) do |i|
    puts i
  end
end.each(&:join) 
```

如果您正在为每个线程寻找一个唯一的名称，我建议使用线程的对象 ID。

```
ts = (1..2).map do
  Thread.new do
    puts Thread.current.object_id
  end
end.each(&:join) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-06T17:00:51.287

您可以通过块传递变量

```
ts = []

for i in 1..2 do
  ts.push( Thread.new(i) do |i|
    x = i
    puts x
  end)
end

ts.each do |t|
  t.join()
end

# => 1
# => 2 
```

# php - php mysql根据IF语句向数组添加值

> ID：13748552
> 
> 赞同：0
> 
> 时间：2012-12-06T16:53:28.130
> 
> 标签：php, mysql, joomla

使用 Joomla，在尝试基于 URL 参数构建 mySQL 查询时遇到问题。我的代码如下所示：

```
 $db =& JFactory::getDBO();
    $hpprice = JRequest::getVar('hprice');
    $lprice = JRequest::getVar('lprice');
    $city = JRequest::getVar('city');
    $zip = JRequest::getVar('zip');
    $bdrms = JRequest::getVar('bdrms');
    $bths = JRequest::getVar('bths');

    $query = "SELECT * FROM " . $db->nameQuote('#__mls') . " WHERE 1=1";
    $clauses = array();
    if ($zip != null) {
        $clauses[] = $db->nameQuote('MSTZIP') . " = " . $db->quote($zip);
    }
    if ($city != null) {
        $clauses[] = $db->nameQuote('MSTCITY') . " = '" . $db->quote($city) . "'";
    }
    if ($bdrms != null){
        $clauses[] = $db->nameQuote('MSTBDRMS')." >= ".$db->quote($bdrms);
    }
    if ($bths != null){
        $clauses[] = $db->nameQuote('MSTBATHS') . " >= " . $db->quote($bths);
    }
    if ($lprice != null){
        $clauses[] = $db->nameQuote('MSTLISTPRC') . " BETWEEN " . $db->quote($lprice) . " AND " . $db->quote($hprice);
    } 

    $query .= implode(" AND ", $clauses);

    $db->setQuery($query);
    $table = $db->loadRowList();
    return $table; 
```

因此，如您所见，根据 URL 中是否存在参数，向 mySQL 查询添加参数。我无法理解的是构建阵列并将其内爆。

每当我在 URL 中输入参数时，都会填充所有表格项。当我尝试传递一个参数时，它会出现空值。[您可以在这里](http://mgoode.com/index.php?option=com_mls&view=list)看到这一点。如果您`zip`在 URL 中添加另一个参数，那么一切都会出现`NULL`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T23:43:13.140

不确定这与您之前的问题有何不同。

$query->select('*"); $query->from($db->nameQuote('#__mls'));

```
 $query->where('1 = 1', AND);
if ($zip != null)
{
  $query->where (.$db->nameQuote('MSTZIP')." = ".$db->quote($zip)); 
}
if ($city != null) 
{ 
   $query->where($db->nameQuote('MSTCITY')." = '".$db->quote($city)); 
} 

Etc 
```

您无需构建任何数组；这就是拥有数据库查询 api 的全部意义所在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T20:08:20.073

我认为问题是这个`" WHERE 1=1"`。试着把这个改成这个- `" WHERE 1=1 "`。因为最终查询将附加到此，您将不会得到期望的结果。为了确认，还`echo $query`请查看它是否是正确的查询。还有一件事是`'" . $db->quote($city) . "'"`.remove `''`，因为您已经通过函数添加了它。

//更新：

最好使用[where](http://docs.joomla.org/API16%3aJDatabaseQuery/where)方法

如果这不起作用，请告诉我。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-07T15:06:01.673

最终脚本最终看起来像这样：

```
 $db =& JFactory::getDBO();
    $hprice = JRequest::getVar('hprice');
    $lprice = JRequest::getVar('lprice');
    $city = JRequest::getVar('city');
    $zip = JRequest::getVar('zip');
    $bdrms = JRequest::getVar('bdrms');
    $bths = JRequest::getVar('bths');

    $query = "SELECT * FROM " . $db->nameQuote('#__mls') . " WHERE 1=1 AND ";
    $clauses = array();
    if ($zip != null) {
        $clauses[] = "MSTZIP = " . $zip;
    }
    if ($city != null) {
        $clauses[] = "MSTCITY = " . $db->quote($city);
    }
    if ($bdrms != null){
        $clauses[] = "MSTBDRMS >= " . $bdrms;
    }
    if ($bths != null){
        $clauses[] = "MSTBATHS >= " . $bths;
    }
    if ($lprice != null){
        $clauses[] = "MSTLISTPRC BETWEEN " . $lprice . " AND " . $hprice;
    } 

    $query .= implode(" AND ", $clauses) . ";";

    $db->setQuery($query);
    $table = $db->loadRowList();
    return $table; 
```

我最终摆脱了`nameQuote`，`quote`除非需要/适用。我正在使用的脚本模型来自一些教程。它适用于我以前所做的事情，但由于某种原因现在不行。最后一步是使初始`AND`条件成为条件，但这应该不会花太多时间。至少框架现在在那里。感谢所有帮助过的人。

# asp.net - 在 RSS Feed 页面上使用 Google Analytics

> ID：13748556
> 
> 赞同：0
> 
> 时间：2012-12-06T16:53:38.320
> 
> 标签：asp.net, rss, google-analytics

我有一个 RSS 提要页面，我想使用 Google Analytics 进行跟踪。我尝试在 .aspx 和 .aspx.cs 页面中添加分析代码，但由于某种原因，当我检查 RSS 提要页面的源时，我没有在其中看到分析代码。分析 JavaScript 代码适用于网站的所有其他页面。

是RSS页面不允许javascript吗？有什么方法可以使用谷歌分析来跟踪 RSS 提要页面本身？

# android - 谷歌地图 android v2 MarkerOption 图标不能接受 StateListDrawable

> ID：13748559
> 
> 赞同：2
> 
> 时间：2012-12-06T16:53:43.217
> 
> 标签：android, google-maps-mobile, statelistdrawable

我想添加一个 StateListDrawable 作为标记图标，如下所示：

```
MarkerOptions marker = new MarkerOptions().position(xy).title("Marker").icon(BitmapDescriptorFactory.fromResource(R.drawable.state)); 
```

但是，它给了我一个空指针异常，有什么解决方法吗？

```
12-06 18:52:51.152: E/AndroidRuntime(3264): Caused by: java.lang.NullPointerException
12-06 18:52:51.152: E/AndroidRuntime(3264):     at maps.y.bw.a(Unknown Source)
12-06 18:52:51.152: E/AndroidRuntime(3264):     at maps.y.bw.b(Unknown Source)
12-06 18:52:51.152: E/AndroidRuntime(3264):     at maps.y.bw.a(Unknown Source)
12-06 18:52:51.152: E/AndroidRuntime(3264):     at maps.y.ae.addMarker(Unknown Source)
12-06 18:52:51.152: E/AndroidRuntime(3264):     at com.google.android.gms.maps.internal.IGoogleMapDelegate$Stub.onTransact(IGoogleMapDelegate.java:167)
12-06 18:52:51.152: E/AndroidRuntime(3264):     at android.os.Binder.transact(Binder.java:279)
12-06 18:52:51.152: E/AndroidRuntime(3264):     at com.google.android.gms.maps.internal.IGoogleMapDelegate$a$a.addMarker(Unknown Source)
12-06 18:52:51.152: E/AndroidRuntime(3264):     at com.google.android.gms.maps.GoogleMap.addMarker(Unknown Source) 
```

谢谢 ！

# sql - 确定 Azure 表的上次修改日期时间

> ID：13748560
> 
> 赞同：2
> 
> 时间：2012-12-06T16:53:43.967
> 
> 标签：sql, sql-server, azure, azure-sql-database

我正在开发一个应用程序，它可以托管在 microsoft sql 服务器或 Azure SQL 上，具体取决于最终用户的意愿。

我的整个系统工作正常，除了一些 WCF 函数使用以下技术确定表的最后修改时间：

```
SELECT OBJECT_NAME(OBJECT_ID) as tableName, 
       last_user_update as lastUpdate
FROM mydb.sys.dm_db_index_usage_stats 
```

此查询在 Azure 中失败。有没有类似的方法可以从 Azure 的 sql 中获取表的最后修改日期？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T17:02:11.317

您是否尝试`mydb.`从查询中删除。**SQL Azure 不支持 4 部分表示法**。您只能在单个数据库的上下文中工作，因此只需尝试执行：

```
SELECT OBJECT_NAME(OBJECT_ID) as tableName, 
       last_user_update as lastUpdate
FROM sys.dm_db_index_usage_stats 
```

# windows-phone-7 - 视频直播

> ID：13748570
> 
> 赞同：1
> 
> 时间：2012-12-06T16:54:05.400
> 
> 标签：windows-phone-7, smooth-streaming

尝试使用流畅的流媒体启动视频流请求我用他们的 url 和我的 uri 尝试了这个例子“但它没有用，我在 vlc 上试过它也适用于 iphone 应用程序..！这是我的一部分xml代码：

```
<Core:SMFPlayer>
                <Core:SMFPlayer.Playlist>
                    <Media:PlaylistItem   DeliveryMethod="AdaptiveStreaming" MediaSource="http://streaming.toutech.net:1936/live/jawharafm.sdp/playlist.m3u8"/>
                </Core:SMFPlayer.Playlist>
            </Core:SMFPlayer> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T14:49:41.990

SMFPlayer 不支持[HLS 流](http://en.wikipedia.org/wiki/HTTP_Live_Streaming)。对于 WindowsPhone，您可能需要使用[SmoothStreaming](http://www.iis.net/downloads/microsoft/smooth-streaming)

此外，还有一个关于 codeplex 的项目可以在 WindowsPhone 上播放 HLS 流，但它不再在线。我只找到了引用这个项目的推文：[https ://twitter.com/JustinAngel/status/179253691549888514](https://twitter.com/JustinAngel/status/179253691549888514)

* * *

**更新**

WindowsPhone 的 HLS 流媒体重新上线： http: [//phonesm.codeplex.com/](http://phonesm.codeplex.com/)

# java - 可执行 jar 中的图形停止

> ID：13748574
> 
> 赞同：2
> 
> 时间：2012-12-06T16:54:08.973
> 
> 标签：java, swing, graphics, executable-jar, keylistener

我在可执行 jar 中正确启动图形时遇到问题。jar 包含所有需要的文件（main.class、main$1.class、HighScore.txt、META-INF 等等），并且程序本身正在正确启动。图形只是不出现。

主要的：

```
import java.awt.*;
import java.awt.event.*;
import java.awt.Graphics;
import java.io.*;
import java.util.Scanner;
import javax.swing.JFrame;

public class main
{
public static int position = 0;
public static long points = 0;
public static boolean happyInt = true;
public static int highScore;
public static void main(String[] args) throws FileNotFoundException
{
    JFrame app = new JFrame();
    Canvas window = new Canvas();

    window.setVisible(true);
    window.setIgnoreRepaint(true);
    window.setSize(1100, 145);
    app.setResizable(false);
    app.setIgnoreRepaint(true);
    app.setDefaultCloseOperation( JFrame.EXIT_ON_CLOSE );
    app.add(window);
    app.pack();
    app.setVisible(true);
    app.setTitle("Shine has made a game!");

    Graphics g = window.getGraphics();

    g.drawString("Working", 10, 20);

    listener(app, window);

    @SuppressWarnings("resource")
    Scanner input = new Scanner(new File("HighScore.txt"));
    while(input.hasNextInt())
    {
        highScore = input.nextInt();
    }
    g.drawString("Working", 10, 20);
    Graphics graphics = null;
    graphics(window);
}
public static void highScore() throws FileNotFoundException
{
    @SuppressWarnings("resource")
    PrintStream output = new PrintStream(new File("HighScore.txt"));
    if(points > highScore)
    {
        output.println(points);
    }
    else
    {
        output.println(highScore);
    }
}
public static void graphics(Canvas window)
{
    Graphics g = window.getGraphics();

    Graphics graphics = null;
    while(happyInt)
    {
        if(position < 11)
        {
            position++;
        }
        else
        {
            position = 1;
        }
        try
        {
            // Draw stuff here using Java's Graphics Object!!!
            g.setColor(Color.black);
            g.fillRect(0, 0, 1100, 145);

            g.setColor(Color.magenta);
            if(position == 1)
            {
                g.setColor(Color.white);
            }
            g.fillRect(0,0,100,100);

            g.setColor(Color.blue);
            if(position == 2)
            {
                g.setColor(Color.white);
            }
            g.fillRect(100,0,100,100);

            g.setColor(Color.green);
            if(position == 3)
            {
                g.setColor(Color.white);
            }
            g.fillRect(200,0,100,100);

            g.setColor(Color.yellow);
            if(position == 4)
            {
                g.setColor(Color.white);
            }
            g.fillRect(300,0,100,100);

            g.setColor(Color.orange);
            if(position == 5)
            {
                g.setColor(Color.white);
            }
            g.fillRect(400,0,100,100);

            g.setColor(Color.red);
            if(position == 6)
            {
                g.setColor(Color.white);
            }
            g.fillRect(500,0,100,100);

            g.setColor(Color.orange);
            if(position == 7)
            {
                g.setColor(Color.white);
            }
            g.fillRect(600,0,100,100);

            g.setColor(Color.yellow);
            if(position == 8)
            {
                g.setColor(Color.white);
            }
            g.fillRect(700,0,100,100);

            g.setColor(Color.green);
            if(position == 9)
            {
                g.setColor(Color.white);
            }
            g.fillRect(800,0,100,100);

            g.setColor(Color.blue);
            if(position == 10)
            {
                g.setColor(Color.white);
            }
            g.fillRect(900,0,100,100);

            g.setColor(Color.magenta);
            if(position == 11)
            {
                g.setColor(Color.white);
            }
            g.fillRect(1000,0,100,100);

            g.setColor(Color.white);
            g.setFont(new Font(Font.SANS_SERIF, Font.PLAIN, 20));
            g.drawString("Score: "+points, 5, 120);
            g.drawString("High score: "+highScore, 5, 140);
            //g.drawString("For debug: "+happyInt, 5, 160);
            // Let the OS have a little time...
            //Thread.yield();
            try
            {
                Thread.sleep(100-points/25);
            }
            catch (InterruptedException e)
            {
            e.printStackTrace();
            }
        }
        finally
        {
        if( graphics != null )
            {
                graphics.dispose();
            }
        }
    }
}
public static void listener(JFrame app, Canvas window)
{
    final Graphics g = window.getGraphics();
    app.addKeyListener( new KeyAdapter() {
        public void keyPressed( KeyEvent e ) {
            if( e.getKeyCode() == KeyEvent.VK_SPACE )
            {
                    if(position == 6)
                    {
                        points = points + 100; 
                    }
                    if(position == 5 || position == 7)
                    {
                        points = points + 50;
                    }
                    if(position > 7 || position < 5)
                    {
                        happyInt = false;
                        g.setColor(Color.black);
                        g.fillRect(0, 0, 1100, 100);
                        position = 12;
                        try
                        {
                            highScore();
                        }
                        catch (FileNotFoundException e1)
                        {
                            e1.printStackTrace();
                        }
                    }
            }
        }
    });
}
} 
```

（我知道监听器不是处理这个问题的最佳方式；我会改变它。）我添加了“工作”部分来检查代码是否在停止并且在绘制图形之前它是否在工作，但不是在绘制之后。有谁知道什么会阻止它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T16:55:54.797

您几乎从不想使用通过调用`getGraphics()`Swing 组件获得的 Graphics 对象。相反，您应该阅读[Swing Graphics 教程](http://docs.oracle.com/javase/tutorial/uiswing/painting/index.html)并按照他们的建议进行操作：在`paintComponent(...)`扩展 JComponent 或其子类之一的类的方法中进行绘图，并使用 JVM 提供给该方法的 Graphics 对象。您可以提高在 BufferedImage 中绘制背景图像的效率，通过这些您*可以*使用通过调用`getGraphics()`图像获得的 Graphics 对象，但是您也将在`paintComponent(...)`方法中绘制图像。

**编辑**
在进一步审查中，我发现您的代码还有其他主要问题，包括在 Swing 事件线程上使用 while (true) 循环和 Thread.sleep(...) 以及过度使用静态成员。你需要做一些工作来解决这个问题，但我们可以提供帮助。

考虑在游戏循环中使用[Swing Timer](http://docs.oracle.com/javase/tutorial/uiswing/misc/timer.html)，考虑删除除 main 方法之外的所有静态内容，并且永远不要调用`Thread.sleep(...)`事件线程。

# xcode - 如何在 NSString 中使用编码？

> ID：13748575
> 
> 赞同：0
> 
> 时间：2012-12-06T16:54:11.930
> 
> 标签：xcode, ios5, ios6

是否有任何解决方案可以在此代码中使用 encoding:NSUTF8StringEncoding：

```
NSString *aa = [[theNews objectAtIndex:indexPath.section]objectForKey:@"Title"];
    cell.titleLabel.text = [aa encoding:NSUTF8StringEncoding]; 
```

因为我有这个结果

```
"&#1578;&#1580;&#1575;&#1585;&#1576; &#1603;&#1578;&#1575;&#1576;&#1577; &#1576;&#1575;&#1604;&#1593;&#1585;&#1576;&#1610;"; 
```

这是阿拉伯语单词

"تجارب كتابة بالعربي"

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T18:36:43.520

“ت” 不是 UTF-8 编码的。它被 XML 编码为实体。它的 UTF-8 版本长 2 个字节（0x06 后跟 0x2A）。你的是一个 7 个字符的字符串。

您想要的工具是 CFXML：

```
NSString *
arabic = CFBridgingRelease(CFXMLCreateStringByUnescapingEntities(NULL,
                                                                 (__bridge void*)string,
                                                                 NULL)); 
```

# gwt - 必须如何将 ListEditor 用作另一个编辑器的子级？

> ID：13748586
> 
> 赞同：2
> 
> 时间：2012-12-06T16:54:47.553
> 
> 标签：gwt, gxt, gwt-editors

我正在使用 GWT 2.5.0

我的意图是创建一个绑定到`ParentBean`对象的编辑器层次结构。`ParentBean`包含 a `List<Group>`，而bean`Group`有 a`List<ChildBean>`和`List<Group>`。从我发现的编辑器教程中，创建一个包含 ListEditor 作为其子编辑器之一的编辑器似乎很简单。但父编辑器似乎从未正确初始化子 ListEditor。

这是我如何尝试执行此操作的解释。

从下面的代码中，我创建了一个`ParentBeanEditor`由另一个编辑器组成的`GroupListEditor`. 工具。
_ 然后，包含一个子编辑器和一个.`GroupListEditor``IsEditor<ListEditor<Group, GroupEditor>>`
`GroupEditor``GroupListEditor``ChildBeanEditor`

`ParentBeanEditor`我用`ParentBean`包含对象列表的a初始化了`Group`，但`GroupEditor`从未为任何`Group`对象构造过。
我在方法中放置了断点`EditorSource<GroupEditor>.create(int)`以验证s 中的每个都`GroupEditor`被创建，但断点从未被命中（ListEditor 没有构造编辑器）。`Group``ParentBean`

我预计`GroupListEditor`会被初始化，因为它是`ParentBeanEditor`. 列表和编辑器链都没有设置在`GroupListEditor`. 我试图通过扩展来`GroupListEditor`直接设置子编辑器的列表。这样做，我上面提到的断点被击中，并试图将 a 附加到编辑器链。但是编辑器链从未设置，并且在第 95 行抛出了 NPE。`ParentBeanEditor``ValueAwareEditor<ParentBean>``GroupListEditor``GroupEditor``ListEditorWrapper`

# 例子

这是`GroupListEditor`未按预期初始化的示例。永远不会设置，这`EditorChain`会导致在`ListEditorWrapper`第 95 行抛出 NPE。

## 数据模型

```
public interface ParentBean {
    ...
    List<Group> getGroups();
}

public interface Group {
    ...
    List<ChildBean> getChildBeans();
    List<Group> getGroups();
}

public interface ChildBean {
    // ChildType is an enum
    ChildType getChildType();
} 
```

## 编辑

ParentBean 编辑器

```
public class ParentBeanEditor extends Composite implements ValueAwareEditor<ParentBean> {

    interface ParentBeanEditorUiBinder extends UiBinder<Widget, ParentBeanEditor> {
    }

    private static ParentBeanEditorUiBinder BINDER = GWT.create(ParentBeanEditorUiBinder.class);

    @Path("groups")
    @UiField
    GroupListEditor groupsEditor;

    public ParentBeanEditor() {
        initWidget(BINDER.createAndBindUi(this));
    }

    @Override
    public void setDelegate(EditorDelegate<ParentBean> delegate) {}

    @Override
    public void flush() {}

    @Override
    public void onPropertyChange(String... paths) {}

    @Override
    public void setValue(ParentBean value) {

        groupsEditor.asEditor().setValue(value.getGroups());
    }
} 
```

组列表编辑器

```
public class GroupListEditor extends Composite implements IsEditor<ListEditor<Group, GroupEditor>>{

    interface GroupListEditorUiBinder extends UiBinder<VerticalLayoutContainer, TemplateGroupListEditor> {
    }

    private static GroupListEditorUiBinder BINDER = GWT.create(GroupListEditorUiBinder.class);

    private class GroupEditorSource extends EditorSource<GroupEditor> {

        private final GroupListEditor GroupListEditor;

        public GroupEditorSource(GroupListEditor GroupListEditor) {
            this.GroupListEditor = GroupListEditor;
        }

        @Override
        public GroupEditor create(int index) {
            GroupEditor subEditor = new GroupEditor();
            GroupListEditor.getGroupsContainer().insert(subEditor, index);
            return subEditor;
        }

        @Override
        public void dispose(GroupEditor subEditor){
            subEditor.removeFromParent();
        }

        @Override
        public void setIndex(GroupEditor editor, int index){
            GroupListEditor.getGroupsContainer().insert(editor, index);
        }

    }

    private final ListEditor<Group, GroupEditor> editor = ListEditor.of(new GroupEditorSource(this));

    @UiField
    VerticalLayoutContainer groupsContainer;

    public GroupListEditor() {
       initWidget(BINDER.createAndBindUi(this));
    }

    public InsertResizeContainer getGroupsContainer() {
        return groupsContainer;
    }

    @Override
    public ListEditor<Group, GroupEditor> asEditor() {
        return editor;
    }
} 
```

组编辑

```
public class GroupEditor extends Composite implements ValueAwareEditor<Group> {

    interface GroupEditorUiBinder extends UiBinder<Widget, GroupEditor> {}

    private static GroupEditorUiBinder BINDER = GWT.create(GroupEditorUiBinder.class);

    @Ignore
    @UiField
    FieldSet groupField;

    @UiField
    @Path("childBeans")
    ChildBeanListEditor childBeansEditor;

    @UiField
    @Path("groups")
    GroupListEditor groupsEditor;

    public GroupEditor() {
        initWidget(BINDER.createAndBindUi(this));
    }

    @Override
    public void setDelegate(EditorDelegate<Group> delegate) {}

    @Override
    public void flush() { }

    @Override
    public void onPropertyChange(String... paths) {}

    @Override
    public void setValue(Group value) {
        // When the value is set, update the FieldSet header text
        groupField.setHeadingText(value.getLabel());
        groupsEditor.asEditor().setValue(value.getGroups());
        childBeansEditor.asEditor().setValue(value.getChildBeans());
    }
} 
```

将使用[这里](https://stackoverflow.com/questions/7043760/using-gwt-editors-with-a-complex-usecase "这里")`ChildBeanListEditor`提到的多态编辑器方法。这意味着特定的叶子编辑器根据枚举的值附加到编辑器链。但是，我没有显示该代码，因为我无法正确初始化。`ChildBean.getType()``GroupListEditor`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T23:52:21.120

关于您的代码的两个问题：

为什么`ParentBeanEditor.setValue`要向它的孩子提供数据？由此看来，这是一种解决`GroupListEditor`未获取数据这一事实的方法。这应该不是必需的，并且可能通过在时间之前连接子编辑器而导致您的 NPE。

然后，假设这一点，似乎遵循的`GroupListEditor`是没有获取数据*或*链。缺少这些表明编辑器框架没有意识到这一点。所有基本接线看起来都是正确的，除了一件事：您的 EditorDriver 在哪里？

如果您尝试通过调用来使用编辑器框架`parentBeanEditor.setValue`并且没有驱动程序，那么您将错过该工具的大部分关键功能。您应该能够要求驱动程序为您完成这项工作，而不是在整个树中调用您自己的 setValue 方法。

快速测试 - 尝试以不应该编译的方式破坏某些东西。这将包括将`@Path`注释更改为类似的内容`@Path("doesnt.exist")`，并尝试运行应用程序。你应该得到一个重新绑定错误，因为没有这样的路径。如果你不明白这一点，你肯定需要创建和使用驱动程序。

首先，尝试驱动程序本身：

从您的代码中不太清楚您使用的是哪种模型，所以我假设`SimpleBeanEditorDriver`对您来说就足够了 - 另一个主要选项是，但即使您使用`RequestFactoryEditorDriver`它实际上也没有必要使用`RequestFactoryEditorDriver`请求工厂。

Driver 在两件事上是通用的：您打算编辑的 bean 类型和负责它的编辑器类型。它使用这些通用参数来遍历这两个对象并生成绑定数据所需的代码。你的可能看起来像这样：

```
public interface Driver extends 
        SimpleBeanEditorDriver<ParentBean, ParentBeanEditor> { } 
```

我们声明这些就像`UiBinder`接口一样 - 足够的细节让代码生成器环顾四周并连接必需品。现在我们有了类型，我们创建一个实例。这可能在您的视图中创建，但仍可能由某些演示者逻辑拥有和控制。请注意，这*不像*uibinder - 我们不能保留静态实例，因为每个实例都直接连接到特定的编辑器实例。

这里有两个步骤 - 创建驱动程序，并将其初始化为给定的编辑器实例（以及所有子编辑器，这将是自动的）：

```
ParentBeanEditor editor = ...;
Driver driver = GWT.create(Driver.class);
driver.initialize(editor); 
```

接下来我们通过将数据传递给驱动程序来绑定数据——它负责将子对象传递给每个子编辑器的 setValue 方法，并连接 ListEditor 所需的编辑器链。

```
driver.edit(parentInstance); 
```

现在用户可以查看或编辑对象，因为您的应用程序要求有效。编辑完成后（假设他们点击了 Save 按钮），我们可以将编辑器中的所有更改刷新回实例（请注意，我们仍在使用相同的驱动程序实例，仍然持有该特定的编辑器实例）：

```
ParentBean instance = driver.flush(); 
```

请注意，我们也可以只是调用`driver.flush()`并重用之前的引用`parentInstance`- 它是同一件事。

假设到目前为止这一切都有意义，可以进行一些清理 - ParentBeanEditor 并没有真正使用 ValueAwareEditor 方法，因此可以将它们删除：

```
public class ParentBeanEditor extends Composite implements Editor<ParentBean> {

    interface ParentBeanEditorUiBinder extends UiBinder<Widget, ParentBeanEditor> {
    }

    private static ParentBeanEditorUiBinder BINDER = GWT.create(ParentBeanEditorUiBinder.class);

    @Path("groups")
    @UiField
    GroupListEditor groupsEditor;

    public ParentBeanEditor() {
        initWidget(BINDER.createAndBindUi(this));
    }
} 
```

观察我们仍然实现`Editor<ParentBean>`- 这允许驱动泛型有意义，并声明我们有可能本身是子编辑器的字段要连接。另外：事实证明，这里的注释是不必要的 - 与属性 ( / ==> ) 或属性名称加“编辑器” ( )`@Path`具有相同名称的任何字段/方法。如果编辑器包含的字段是编辑器，但未映射到 bean 中的属性，您将收到错误消息。如果您确实是故意这样做的（例如，用于搜索的文本框，而不是用于数据输入的文本框），您可以使用.`getGroups()``setGroups()``groups``groupsEditor``@Ignore`

# c# - 在第一个发布请求完成之前，不会发送 jQuery 发布请求

> ID：13748588
> 
> 赞同：1
> 
> 时间：2012-12-06T16:54:58.273
> 
> 标签：c#, jquery, ajax, asynchronous, request

我有一个执行时间很长的函数。

```
 public void updateCampaign()
    {

        context.Session[processId] = "0|Fetching Lead360 Campaign";
        Lead360 objLead360 = new Lead360();
        string campaignXML = objLead360.getCampaigns();

        string todayDate = DateTime.Now.ToString("dd-MMMM-yyyy");
        context.Session[processId] = "1|Creating File  for Lead360 Campaign on " + todayDate;
        string fileName = HttpContext.Current.Server.MapPath("campaigns") + todayDate + ".xml";
        objLead360.createFile(fileName, campaignXML);

        context.Session[processId] = "2|Reading The latest Lead360 Campaign";
        string file = File.ReadAllText(fileName);

        context.Session[processId] = "3|Updating Lead360 Campaign";
        string updateStatus = objLead360.updateCampaign(fileName);
        string[] statusArr = updateStatus.Split('|');
        context.Session[processId] = "99|" + statusArr[0] + " New Inserted , " + statusArr[1] + " Updated , With " + statusArr[2] + " Error , ";
    } 
```

所以为了跟踪函数的进度，我写了另一个函数

```
public void getProgress()
    {
        if (context.Session[processId] == null)
        {
            string json = "{\"error\":true}";
            Response.Write(json);
            Response.End();
        }else{
            string[] status = context.Session[processId].ToString().Split('|');
            if (status[0] == "99") context.Session.Remove(processId);

            string json = "{\"error\":false,\"statuscode\":" + status[0] + ",\"statusmsz\":\"" + status[1] + "\" }";
            Response.Write(json);
            Response.End();  
        }
    } 
```

使用 jQuery post 请求来调用它

```
reqUrl = "AjaxPages/lead360Campaign.aspx?processid=" + progressID + "&action=updatecampaign";
$.post(reqUrl);
setTimeout(getProgress, 500); 
```

获取 getProgress 是：

```
function getProgress() {
    reqUrl = "AjaxPages/lead360Campaign.aspx?processid=" + progressID + "&action=getProgress";
    $.post(reqUrl, function (response) {
        var progress = jQuery.parseJSON(response);
        console.log(progress)
        if (progress.error) {
            $("#fetchedCampaign .waitingMsz").html("Some error occured. Please try again later.");
            $("#fetchedCampaign .waitingMsz").css({ "background": "url(common/images/ajax_error.jpg) no-repeat center 6px" });
            return;
        }
        if (progress.statuscode == 99) {
            $("#fetchedCampaign .waitingMsz").html("Update Status :"+ progress.statusmsz );
            $("#fetchedCampaign .waitingMsz").css({ "background": "url(common/images/ajax_loded.jpg) no-repeat center 6px" });
            return;
        }
        $("#fetchedCampaign .waitingMsz").html("Please Wait... " + progress.statusmsz);
        setTimeout(getProgress, 500);
    });
} 
```

但问题是我看不到中间消息。在很长一段时间的 ajax 加载消息之后，只显示最后一条消息

同样在浏览器控制台上，我只是看到在很长一段时间后第一个请求完成，然后第二个请求完成。但应该有`getProgress`吗？

我检查了 jquery.doc，它说 $post 是一个`asynchronous`请求。

谁能解释一下代码或逻辑有什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T17:04:15.363

您处于此处讨论的情况：

[ASP.net 会话请求队列](https://stackoverflow.com/questions/4318965/asp-net-session-request-queuing)

在处理给定用户会话的请求时，同一会话的其他请求正在等待。您需要在后台线程中运行长函数并让启动它的请求完成。但是，后台线程将无法访问会话，您将需要不同的机制来传达其进度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T17:02:34.097

根据您提供的信息，我怀疑不是您的 javascript 代码正在同步，而是服务器端代码。您可以使用 Firebug 或 Chrome 的开发工具来测试这两个 AJAX 请求的开始和结束时间。如果我是对的，您会看到第二个请求在半秒后开始，但直到第一个请求之后才完成。

如果是这种情况，可能的原因是：

*   在 Visual Studio 的开发环境中运行，尤其是在调试模式下，似乎可以减少异步性。开发环境似乎喜欢一次处理一个请求。
*   请参阅[Igor](https://stackoverflow.com/a/13748758/120955)关于会话请求队列的回答。
*   您的代码可能会显式锁定资源并导致第二个请求阻塞，直到长时间运行的请求完成。

另一个可能的罪魁祸首是大多数浏览器只允许对特定域的有限数量的并发请求。如果您在任何给定时刻有几个请求待处理，则浏览器可能只是将剩余的请求排队，直到它们返回。

# javascript - tbody 中的嵌套无容器 foreach 对 IE 失败

> ID：13748590
> 
> 赞同：0
> 
> 时间：2012-12-06T16:54:59.833
> 
> 标签：javascript, internet-explorer, knockout.js

我在让一些嵌套的、无容器的 foreach 绑定工作时遇到了一些麻烦。它适用于成人浏览器，但不适用于 IE（8 或 9）。

我能找到的最接近的是[这个问题](https://stackoverflow.com/questions/8115896/knockout-js-containerless-foreach-not-working-with-table)，但这个问题的根源似乎是缺少`tbody`标签，我有。IE给出的错误是

> 找不到要匹配的结束评论标签：ko foreach：前辈

对不起，文字墙，但下面是我的标记。

* * *

```
<tbody data-bind="foreach: superGroups">
    <tr>
        <td style="font-weight: bold;" data-bind="text: superName() || 'No Super Set'" colspan="8">
    </tr>
    <!-- ko foreach: seniors -->
    <tr>
        <td></td>
        <td style="font-weight: bold;" data-bind="text: seniorName() || 'No Senior Set'" colspan="7"></td>
    </tr>

        <!-- ko foreach: items -->

        <tr>
            <td>
                <span data-bindX="text:superName"></span>
            </td>
            <td>
                <span data-bindX="text:seniorName"></span>
            </td>
            <td>
                <span data-bind="text:clientName"></span>
                <i class="icon-tags" data-bind="attr:{title: labels}, visible: labels"></i>
            </td>
            <td>
                <span data-bind="text:description"></span>
            </td>
            <td>
                <span data-bind="visible:superPayAmount">$<span data-bind="text:superPayAmount"></span></span>
                <span data-bind="visible:superPayAmount.length == 0">-</span>
            </td>
            <td>
                <span data-bind="shortDate: superStartDate"></span> - <span data-bind="shortDate: superEndDate"></span>
            </td>
            <td>
                <span data-bind="visible:seniorPayAmount">$<span data-bind="text:seniorPayAmount"></span></span>
                <span data-bind="visible:!seniorPayAmount.length == 0">-</span>
            </td>
            <td>
                <span data-bind="shortDate: seniorStartDate"></span> - <span data-bind="shortDate: seniorEndDate"></span>
            </td>
        </tr>

        <!-- /ko -->

    <!-- /ko -->
</tbody> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-06T16:58:45.853

您在第一个中错过了结束`td`标签`tr`：

```
<tr>
    <td style="font-weight: bold;" data-bind="text: superName() || 'No Super Set'" colspan="8"></td>
</tr> 
```

# php - Drupal 7\. 在“node.tpl.php”中，我将如何限制和抵消结果？

> ID：13748592
> 
> 赞同：1
> 
> 时间：2012-12-06T16:54:58.920
> 
> 标签：php, drupal, limit, field

抱歉，新手 Drupal 问题警告：

**目标：**拆分我输出的自定义字段图像列表，以便我可以不同地使用它们。

IE。在我的 node.tpl.php 中，使用滑块中的前 3 个（最近的节点）图像。然后将其余的（抵消前三个）作为普通图像列出。

但我找不到如何限制我的结果。在我的节点模板中，我可以使用以下方式设置所有图像的样式：

```
<a href="<?php $nodeurl = url('node/'. $node->nid); echo $nodeurl; ?>"
 <img src="<?php print render (file_create_url($node->field_featured_image['und'][0]['uri'])); ?>" alt="<?php echo $title; ?>" />
</a> 
```

但是我如何限制结果呢？我想这可以忽略前三个结果：

```
<?php foreach($node->field_featured_image as $k=>$v){
  if ($k < 3) continue;
  print render (file_create_url($node->field_featured_image['und'][0]['uri']));
 }
?> 
```

但**不是**在 node.tpl 中，因为 node.tpl 似乎是一个循环，所以上面的代码被循环并且数组键永远不会超过 0。

我认为 ：/

我对模板有基本的误解吗？

任何指针表示赞赏。拼命地试图坚持使用drupal，但发现它很难。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T01:48:17.497

我可能会被你试图完成的事情误导，但你可能还不需要侵入 node.tpl.php。

如果您不使用[Views](http://drupal.org/project/views)，请从它开始。如果您尝试构建滑块，请使用 Views Rotator。如果您想要一些可以放入的东西，请使用 Enterprise Rotator。（基本上已经构建了 Views Rotator 和 Banner Slide 内容类型）。

您可以使用寻呼机选项来偏移图像，以显示某个数字，并偏移排队的图像数量。

Or if you want to just use specific images, use [Nodequeue](http://drupal.org/project/nodequeue). Make a simple queue, add the nodes that contain the images you want, then in your View create a relationship (marked as required) to the nodequeue.

# javascript - 使用 ScriptManager 注册 Javascript 工作不一致

> ID：13748595
> 
> 赞同：0
> 
> 时间：2012-12-06T16:55:08.033
> 
> 标签：javascript, asp.net

我正在开发一个 ASP.NET 页面。目前页面上没有 AJAX。在不同按钮单击事件的代码中，我正在注册下面的脚本。该脚本的目的是将窗口滚动到特定的锚标记。方法如下：

```
public void RegisterAnchor(string anchorTag)
{
    Page.ClientScript.RegisterStartupScript(Page.GetType(), "navigate",
          "window.onload = function() {window.location.hash='#" + anchorTag + "';}", true);
} 
```

我有两个不同的锚标签是有效的并且以相同的方式定义。但是，一个正在工作，一个没有。我可以检查什么来确定这种行为的原因？

ascx 中的锚标记：

```
<a name="EditDlg"></a> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T21:42:47.693

您可以尝试使用页面实例注册客户端脚本。其他选项是在每个部分回发时生成唯一的脚本 ID。

选项 1（向页面实例注册客户端脚本）：

```
ScriptManager.RegisterStartupScript(this.Page, Caller.GetType() , "navigate", "window.onload = function() {window.location.hash='#" + anchorTag + "';}", true); 
```

选项 2（在每个部分回发时生成唯一的脚本 ID）：

```
ScriptManager.RegisterStartupScript(Caller, Caller.GetType(), Guid.NewGuid(), "window.onload = function() {window.location.hash='#" + anchorTag + "';}", true); 
```

# php - .htaccess 中的 301 重定向，出现 30,000 个错误

> ID：13748599
> 
> 赞同：1
> 
> 时间：2012-12-06T16:55:19.700
> 
> 标签：php, apache, .htaccess

由于重新设计和开发，我的任务是清理旧网站留下的 30,000 个左右的 url 错误。

我通常使用 .htaccess 来执行此操作，但我怀疑在 .htaccess 文件中包含 30,000 301 重定向是否明智！

你们中的一些人用什么方法来解决这个问题？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T17:09:36.903

在这里，您可以使用 apache httpd

```
RewriteMap escape int:escape
RewriteMap lowercase int:tolower
RewriteMap my_redir_map txt:map_rewrite.txt
RewriteCond  ${my_redir_map:${lowercase:${escape:%{HTTP_HOST}%{REQUEST_URI}}}}  ^(.+)$
RewriteRule .*  http://%1 [R=301,L] 
```

我通常直接在 apache httpd 配置中使用这个重写规则。
在 map_rewrite.txt 文件中，您有一个制表符分隔的文件，其中包含以下格式的重定向列表：

```
www.example.it/tag/nozze                www.example.it/categoria/matrimonio
www.example.it/tag/pippo                www.example.it/pluto
www.example.it/tag/ancora               www.google.com 
```

如果您可以概括该方法会容易得多，因为重定向具有共同的模式。但如果没有，在这种情况下，您只需将重定向的 url 添加到列表中。请注意研究 RewriteMap 配置，因为您还可以将列表写入不同的格式，例如数据库表。

请注意这一点：我添加了`escape`并且`lowercase`只是因为我需要编写的网址中有重音符号。如果您的网址没有重音符号，您可以将两者都删除。

如果你想在 php 中实现这些重定向，这里是你需要的代码：

```
 <?php
 $dest_url = "http://example.com/path...";
 header("HTTP/1.1 301 Moved Permanently");
 header("Location: ".$dest_url); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T17:00:39.320

创建一个 PHP 页面以作为 404 处理程序运行。它应该检查传入的 URL，检查它是否应该从旧页面映射到新页面，然后发出 301。如果没有映射，则显示 404。

只需将此页面设置为 .htaccess 中的 404 处理程序即可。IIRC 这就是 Wordpress 在 IIS7 引入 URL 重写而不需要第 3 方 dll 之前在 IIS 上处理“干净”URL 的方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-06T17:01:27.307

我已经在 404 页面上创建了一个重定向类，它将检查数据库是否有有效的 301 重定向页面并将其重定向，而不是提供 404 页面。如果无法确定，它会在数据库中将其标记为 404 页面，以便以后修复。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-14T14:08:29.027

谢谢你们的帮助。我已经从 freedev 执行了建议的操作过程，但在 Apache 中创建了一个单独的配置文件。

在我添加的 httpd.conf 文件中：

```
# Map settings
Include "conf/extra/map.conf" 
```

map.conf 文件：

```
RewriteEngine On
    RewriteEngine on
    RewriteMap url_rewrite_map txt:conf/map.map
    RewriteCond ${url_rewrite_map:$1|NOT_FOUND} !NOT_FOUND
    RewriteRule ^(.*) http://website.com/${url_rewrite_map:$1} [R=301] 
```

map.map 文件格式如下：

```
/oldname/   /newname 
```

我已经为重定向添加了相当多的 url，到目前为止一切都很好，它并没有像添加到 .htaccess 时那样对服务器产生巨大影响

# c# - 具有多个约束的泛型

> ID：13748601
> 
> 赞同：2
> 
> 时间：2012-12-06T16:55:24.303
> 
> 标签：c#, generics, inheritance

我正在尝试调用具有类似于以下定义的方法（为避免混淆而进行了简化）：

```
public static void Register<T>(T value) where T : BaseClass, IInterface 
```

只要我有一个定义这两个值的类实例，它就可以正常工作。当我将“BaseClass”传递给一个方法，然后尝试在上述声明中使用该实例时，就会出现问题。例如：

```
public class MyClass
{
    public MyClass(BaseClass value)
    {
        Register(value);
    }
} 
```

我可以将实现 BaseClass 和 IInterface 的类的实例传递到构造函数中，但是当我尝试在`Register`方法中使用该值时，我得到一个编译错误说明：

> 类型“BaseClass”不能用作泛型类型或方法“Register(T)”中的类型参数“T”。没有从“BaseClass”到“IInterface”的隐式引用转换。

如果我像这样更改构造函数中的类型：

```
public class MyClass
{
    public MyClass(IInterface value)
    {
        Register(value);
    }
} 
```

我收到一条错误消息：

> 类型“IInterface”不能用作泛型类型或方法“Register(T)”中的类型参数“T”。没有从“IInterface”到“BaseClass”的隐式引用转换。

这似乎有点像第 22 条规则。 **有没有一种方法可以定义参数以指示它必须同时实现 BaseClass 和 IInterface？**

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-06T16:55:24.303

当我写这个问题时，我想出了答案，并认为我会发布它而不是删除问题。

我只需要重新定义类：

```
public class MyClass<T> where T : BaseClass, IInterface
{
    public MyClass(T value)
    {
        Register(value);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T19:21:37.230

对于不需要将传入的对象存储在字段或集合中的情况，Matt 给出的解决方案是一个简单的答案。如果您需要持久化传入的对象，事情会*变得更加*困难。`SomeClass<T>`where很容易`T`满足多个约束，存储类 T 的项目并将它们作为泛型传递给具有此类约束的例程，但是如果一个类具有`SomeMethod<TParam>(TParam thing)`where方法`TParam:IFoo,BaseBar`，它将没有任何 type 字段`TParam`。它可以存储到or`thing`类型的字段中，但除非implements ，或者所有传入的实例都将派生自一个特定的派生类，该派生类实现`IFoo``BaseBar``BaseBar``IFoo``BaseBar``IFoo`, 没有办法指定一个字段的类型将同时满足这两个约束（如果每个实例都派生自一个`BaseBar`实现的特定派生`IFoo`，则可以简单地将该类型用作单个约束，或者就此而言根本不关心泛型 - 只是使用它作为参数类型）。

有一些方法可以解决这些问题，要么使用反射，我称之为接口模式，要么使用`ISelf<T>`一些棘手的嵌套回调接口。但是，在某些情况下，最好为采用双重约束参数的方法提供替代方案（让方法采用一种约束类型的参数，将其转换为另一种类型，并接受缺乏编译时安全性） .

# java - 从 UTF-16 编码的文本文件中读取，þÿ 位于前面

> ID：13748613
> 
> 赞同：2
> 
> 时间：2012-12-06T16:56:10.803
> 
> 标签：java, file-io

我正在使用以下方法将字节数组输出到文本文件：

```
try{
    FileOutputStream fos = new FileOutputStream(filePath+".8102");
    fos.write(concatenatedIVCipherMAC);
    fos.close();
    }catch(Exception e)
    {
        e.printStackTrace();
    } 
```

它向文件输出 UTF-16 编码的数据，例如：

> ¢¬6î)ªÈP~m~LïiÆŸÃª•Àe»/#Ó ö¹¥'þ²XhÃ&¼lG:Öé )GU3«´DÃ{+í—Ã]íò

但是，当我读回它时，我会`þÿ`在数据的前面加上，例如：

> þÿ¢¬6î)ªÈP~m~LïiÆŸÃª•Àe»/?#Ó ö¹¥'þ²XhÃ&¼lG:Öé )GU3«´DÃ{+í—Ã]íò

这是我用来读取文件的方法：

```
private String getFilesContents()
{
    String fileContents = "";
    Scanner sc = null;

    try {
        sc = new Scanner(file, "UTF-16");
        System.out.println("Can read file: "+file.canRead());
    } catch (FileNotFoundException e) {
        e.printStackTrace();
    }

    while(sc.hasNextLine()){
        fileContents += sc.nextLine();                     
    }
    sc.close();
    return fileContents;
 } 
```

然后`byte[] contentsOfFile = fileContents.getBytes("UTF-16");`将字符串转换为字节数组。

一个快速的 Google 告诉我 þÿ 代表字节顺序，但是是 Java 把它放在那里还是 Windows？如何避免在我正在读取的数据开头添加 þÿ？我想忽略前两个字节，但如果是 Windows，那么这显然会破坏其他平台上的程序。

编辑：将附加更改为前置。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T17:06:15.870

> 文件是IV+data+MAC。它不是可读的文本吗？我应该做一些不同的事情吗？

是的。您不应该试图在*任何地方*将其视为文本。

如果确实需要将任意二进制数据转成文本，请使用 Base64 进行转换。除此之外，坚持使用字节数组`InputStream`和`OutputStream`.

我不确切知道为什么你应该得到额外的字符，但你没有真正的文本开始这一事实表明它并不值得诊断那一面。只需开始将二进制数据*作为*二进制数据处理即可。

编辑：为了简单起见，看看[Guava](https://code.google.com/p/guava-libraries/)的[IO 助手](https://code.google.com/p/guava-libraries/wiki/IOExplained)......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-12-09T14:58:30.490

`þÿ`是保存为 UTF16-BE的[字节顺序标记 (BOM) unicode 字符，解释为 ISO-8859-1。](https://en.wikipedia.org/wiki/Byte_order_mark)

如果您想避免此类错误，则不应将二进制数据视为文本（以任何编码方式）。

# ios - 如何追踪阻塞主 (UI) 主题的调用？

> ID：13748614
> 
> 赞同：0
> 
> 时间：2012-12-06T16:56:12.907
> 
> 标签：ios, performance, profiling

我有一个存在一些性能问题的 iOS 应用程序。特别是，当用户在特定的 Core Data 支持的 UITableView 中选择一个项目时，在 UI 更新之前会有延迟。由于目前应用程序中的多线程非常少，我猜我正在某个地方进行方法调用，该方法调用花费了太长时间并阻塞了 UI 线程。

单步执行代码并没有向我透露任何信息。（也许是因为问题出在运行循环的另一次旅行中？不确定......我是一个可靠的 iOS 开发人员，但在调试和分析工具方面是新手。）

解决此类问题的最佳方法是什么？某种方式来逐步执行或跟踪线程正在按顺序执行的操作以及每个调用需要多长时间，或者其他什么？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T17:01:12.123

查看 Instruments 中的 Time Profiler。请参阅[WWDC 2012 - Building Concurrent User Interfaces on iOS](https://developer.apple.com/videos/wwdc/2012/?id=211)，以实际演示如何使用分析器识别您可能希望放入后台队列以避免阻塞主队列的候选方法。

有关 Instruments 工具的基本描述，请参阅[Instruments 用户指南](https://developer.apple.com/library/ios/#documentation/developertools/Conceptual/InstrumentsUserGuide/Introduction/Introduction.html)，但我认为 WWDC 视频是熟悉此特定工具 Time Profiler 的更有效方式。此外，如果您从未使用过并发 Core Data，您可能还想查看*Core Data Programming Guide的*[Concurrency with Core Data](http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/CoreData/Articles/cdConcurrency.html)部分。

 ** * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T17:10:12.843

我将支持`Rob`所说的：您会更容易地发现您的应用程序**`Time Profiler`**在使用**`Instruments`**. Rob 的所有参考资料都很好，特别是来自 WWDC 的参考资料。我也遇到了这个涵盖基础知识的教程[。](http://mobile.tutsplus.com/tutorials/iphone/ios-sdk-time-profiling-with-instruments/?search_index=1)`mobile tuts`*

# php - 尝试遍历数组并重新分配值

> ID：13748615
> 
> 赞同：0
> 
> 时间：2012-12-06T16:56:15.620
> 
> 标签：php, arrays

我有两个数组，都具有相同的索引。我想要做的是遍历其中一个数组（portConfigArray），并通过使用第二个数组中的数据来更改现有项的值。(portStatusArray) 逻辑如下：

```
$i=0;
foreach ($portConfigArray as $configentry)
{           
    $configentry['LinkState'] = $portStatusArray[$i]['LinkState'];
    $i = $i + 1;
    echo $configentry['LinkState'];             
}
$portdetailsArray = $portConfigArray;
var_dump($portdetailsArray); 
```

echo 语句显示为 portConfigArray 中的每个项目分配的正确值。（它只是一个字符串值，如“Up”或“Down”）但在 var_dump 中我可以看到该值没有正确更新。表明

```
["LinkState"]=> string(0) "" 
```

作为每条记录的输出。

你能告诉我我做错了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T16:57:48.103

```
foreach ($portConfigArray as $configentry) 
```

应该

```
foreach ($portConfigArray as &$configentry) 
```

本质上，这意味着循环处理实际值而不是它的副本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T16:57:53.297

你需要做`$configentry`一个参考，否则它只是一个副本

```
foreach ($portConfigArray as &$configentry) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-06T17:03:05.783

虽然您可以使 $configentry 成为引用，如其他答案中所述，但如果您稍后在脚本中将此类“引用”变量用于其他目的，则可能会导致重大问题。更安全的方法是使用 foreach 的 key=>val 版本，直接修改数组：

```
foreach($portConfigArray as $key => $configentry) {
    $portConfigArray[$key] = 'newvalue';
} 
```

参考版本可能会导致问题，例如

```
php > $a = array('a', 'b', 'c');
php > foreach($a as &$val) { $val++; };
php > print_r($a);
Array
(
    [0] => b
    [1] => c
    [2] => d
)
php > $b = array('p', 'q', 'r');
php > foreach($b as $val) { $val++; };  <--note, $val, not &$val
php > print_r($b);
Array
(
    [0] => p   <---hey, these 3 didn't change!
    [1] => q
    [2] => r
)
php > print_r($a);
Array
(
    [0] => b
    [1] => c
    [2] => s  <---uh-oh!
)
php > 
```

# c - 计算制表符并检查行长

> ID：13748617
> 
> 赞同：0
> 
> 时间：2012-12-06T16:56:25.590
> 
> 标签：c, file

我正在自己学习 c，实际上我正在尝试编写一个程序来计算文件中 TAb 的数量，如果一行有一个制表符，我想打印整行以及这一行中制表符的数量。如果它不是更难，我希望你帮我做到这一点，如果一行有超过 80 个字符，打印这一行和我有这个主要功能的字符数：

```
include <stdio.h> /* printf */

/* Prototype from tablen.c */
void tablen(const char *filename);

int main(int argc, char **argv)
{
  if (argc < 2)
  {
    printf("Usage: tablen filename\n");
    printf("where: filename - file to process.\n");
    return -1;
  }

  tablen(argv[1]);

  return 0;
} 
```

这个主要功能是非常基本的，所以我希望那里没有错误。还有这个功能：

```
include <stdio.h>  /* FILE, fopen, feof, fgets, fclose   */
include <string.h> /*  strlen */ 

void tablen(const char *filename)
{

    /*Variables*/   
    int i; /*loop controller */
    int tabs = 0; /*number of tabs*/
    int line = 0; /*current line*/
    int size_string; /*size of the string*/

    File *file; /* open and read the file */

    file = fopen(filename, "rt"); /*open the file for read text*/
    size_string = strlen(filename);

    /*if we can read the file*/
    if(file)
    {
        /*while we don't reach the end of file, we still reading*/
        while (!feof(file))
        {
            for(i = 0; i < size_string; i++)
            {
                if(filename[i] == 9) /*ASCII value of TAB is 9 or '\'*/
                {
                    tabs++;
                }           

                if(tabs > 0)
                {
                    printf("# %i: (tabs: %i) |", line, tabs);
                }
                if(filename[i] == '\n')
                {
                    line++;                 
                    tabs = 0;
                }

            }
        }
    }
} 
```

我已经写了这个伪代码，我认为它是正确的计数标签：首先打开一个文件以读取/文本，而文件中有更多行（并逐一读取）我们计算标签的数量，如果我们发现带有标签的一行，打印该行和标签的数量当然我们关闭文件

用于检查线长

首先打开一个文件进行读取/文本，如果文件中有更多行，我们会计算每行的长度。如果该行超过 80 个字符，我们会打印该行的长度信息

我不知道我的方法是否正确，因为这是我第一次尝试处理文件

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T09:12:57.053

要一次计算一行中的选项卡数，最好使用 getline() 函数。getline() 从文件流中读取一行并返回读取行中的字符数。阅读 getline() 的手册页以获取更多信息。

您可以查看以下代码以解决您的问题

```
#include <stdio.h>
#include <stdlib.h>
int main(int argc,char *argv[])
{
    FILE * fp;
    char * line = NULL;
    size_t len = 0;
    ssize_t read;
    int tabs=0,totaltabs=0,i;
        fp = fopen(argv[1], "r");
        if (fp == NULL)
           exit(EXIT_FAILURE);
        while ((read = getline(&line, &len, fp)) != -1) {
              printf("Retrieved line of length %d\n", read);
        for(i=0;i<read;i++){
            if(line[i] == '\t')
            tabs++; 
        }
        if(tabs){
                    printf("line = %s\nNumber of tabs = %d\n",line,tabs);
            totaltabs = totaltabs+tabs;
            tabs=0;
           }
        if(read >=80)
            printf("%s\n",line);
    }       
           if (line)
               free(line);
           exit(EXIT_SUCCESS);

} 
```

# android - android：格式化日期

> ID：13748618
> 
> 赞同：-1
> 
> 时间：2012-12-06T16:56:26.380
> 
> 标签：android, date

如何获取此日期字符串的格式：

```
20121102010000 +0100 
```

我尝试了许多格式的可能性，但是有错误并且没有给出好的日期。

```
SimpleDateFormat format = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss.SSSZ");

Date d;
try {
    d = format.parse(mydate);
    System.out.println(d);
} catch (ParseException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T17:00:13.673

```
SimpleDateFormat format = new SimpleDateFormat("yyyyMMddHHmmss z"); 
```

这就是我看了[这张表](http://developer.android.com/reference/java/text/SimpleDateFormat.html)后的想法。

# image-processing - 是否有任何可用的库/软件可以为我提供有用的图像质量测量？

> ID：13748621
> 
> 赞同：0
> 
> 时间：2012-12-06T16:56:42.127
> 
> 标签：image-processing

我意识到在软件中测量图像质量将非常困难，而且我不是在寻找快速解决方案。谷歌搜索这主要是显示研究论文和讨论让我有点不知所措，所以我想知道 SO 社区中是否有人有任何粗略的图像质量评估经验？

我想用它来扫描几千张图像并将其缩减为几十张最有可能质量较差的图像。然后我可以把这些展示给用户，剩下的留给他们。

显然，有许多指标可以作为图像质量高/低的一部分，我会对任何可以将图像作为输入并为任何基本图像质量指标提供一些合理指标的东西感到满意，例如锐度、动态范围、噪声等，由我的软件决定什么是可接受的，什么是不可接受的。

有些图像质量很差，因为它们已被大幅放大。如果没有像我上面建议的那样获取指标的方法，有没有办法检测到图像已经像这样放大了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T17:02:14.860

这是一个非常困难的问题，因为“图像质量”不是一个定义非常明确的概念。

如果您开始尝试一些基本指标并查看您是否提出适合您的应用程序的度量，这可能是最好的。

例如，对于动态范围，每个通道的分布的分位数可以产生有趣的信息。

另一方面，对于放大，解决方案相当简单：只需对图像进行傅立叶变换，然后查看高频与低频频带的能量大小。

# javascript - 继承自原型对象的 JavaScript 事件方法

> ID：13748625
> 
> 赞同：0
> 
> 时间：2012-12-06T16:56:53.133
> 
> 标签：javascript

我觉得我拥有的是正确的代码，但显然我在这里遗漏了一些东西。

我想要做的是在我的构造函数的原型对象中创建一个事件方法。这是我到目前为止所拥有的：

```
function Controls(but) {
    this.but = document.getElementById(but);
    this.but.onclick = function() {
        displayMessageTwo();
    }
}

Controls.prototype.displayMessageTwo = function() {
    alert("HELLO");
}

var Main = new Controls('testingTwo'); 
```

我在这里的逻辑是，我正在创建一个构造函数，从中为某些东西构建控件（比方说幻灯片）.. `this.but`等于链接的 html 元素，称为作为参数传递给构造函数的任何内容。

在我的原型对象中，我定义了我的方法，然后创建了我的对象。但是，这并没有像我预期的那样工作。

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T16:59:46.123

我怀疑当事件处理程序触发时，调用的上下文不是您注册回调的实例。

尝试以下内容

```
function Controls(but) {
    var that = this;
    this.but = document.getElementById(but);
    this.but.onclick = function() {
        that.displayMessageTwo(); // that is closed-in
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-06T17:01:27.447

> 我在这里做错了什么？

您正在调用`displayMessageTwo();`它，就好像它是一个全局函数。不是，它是您实例的继承属性。[`this`通常你会使用关键字](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/this)来引用实例，但在事件处理程序中你不能。创建一个引用该对象的变量，并像这样调用该变量的方法：

```
function Controls(but) {
    this.but = document.getElementById(but);

    var that = this;
    this.but.onclick = function() {
        that.displayMessageTwo();
    }
} 
```

由于您的`displayMessageTwo`方法不关心其上下文（不通过 引用其他属性`this`），您甚至可以直接分配它：

```
 this.but.onclick = this.displayMessageTwo; 
```

但我建议避免这种情况，应始终使用正确的 thisValue 执行方法。您也可以使用[`bind`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/bind)：

```
 this.but.onclick = this.displayMessageTwo.bind(this); 
```

但是对于较旧的、不支持的浏览器，它需要[额外的代码。](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/bind#Compatibility)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-06T17:01:20.157

我会认为：

```
function Controls(but) {
    this.but = document.getElementById(but);
    this.but.onclick = this.displayMessageTwo;
}

Controls.prototype.displayMessageTwo = function() {
    alert("HELLO");
}

var Main = new Controls('testingTwo'); 
```

更清晰（分配分配给prototype.displayMessageTwo的函数）。如果这不起作用，可能是因为

```
 this.but.onclick = this.displayMessageTwo; 
```

之前评估过：

```
 Controls.prototype.displayMessageTwo = function() { 
```

使其为空...

# matlab - 在 MatLab 中绘制一个 3d 点

> ID：13748633
> 
> 赞同：3
> 
> 时间：2012-12-06T16:57:30.673
> 
> 标签：matlab, 3d, plot, point

我试图在任何坐标系中只绘制一个点：笛卡尔、圆柱或球面。

我尝试`plot3(1,1,1)`了许多值，但只是在所有值的同一位置显示了一个小点！我也试过`surf(X,Y,Z)`，但 matlab 说：Z 必须是矩阵，而不是标量或向量。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-07T05:25:09.470

这个怎么样？

```
plot3(1,1,1,'.');
grid on 
```

![3d 空间中的单点](../Images/152d27b3a6e453ae91a10df540f9411c.png)

您确实尝试过，但话又说回来，这正是它的作用！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-04-17T14:33:55.120

像 scatter3(x,y,z1,720,'g','fill') 这样的东西会在向量 x,y,z1 中列出的所有点周围生成 720 大小的不透明绿色球体。

# android - Android 上的图片库

> ID：13748638
> 
> 赞同：0
> 
> 时间：2012-12-06T16:57:50.410
> 
> 标签：android, android-layout, android-emulator, android-image

我正在尝试制作图片库，我已经编写了代码，一切都很好，但是当我在 avd 上运行应用程序并单击启动活动的按钮时，应用程序崩溃了

我的代码用于我的 xml：

```
<ImageSwitcher android:id="@+id/switcher"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:layout_alignParentTop="true"
    android:layout_alignParentLeft="true"
/>

<Gallery android:id="@+id/gallery"
    android:background="#55000000"
    android:layout_width="match_parent"
    android:layout_height="60dp"
    android:layout_alignParentBottom="true"
    android:layout_alignParentLeft="true"

    android:gravity="center_vertical"
    android:spacing="16dp"
/>

</RelativeLayout> 
```

对于我的班级：

```
public class ScrollingQuran extends Activity implements
AdapterView.OnItemSelectedListener{

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    requestWindowFeature(Window.FEATURE_NO_TITLE);

    setContentView(R.layout.qurangallery);

    mSwitcher = (ImageSwitcher) findViewById(R.id.switcher);
    mSwitcher.setFactory(this);
    mSwitcher.setInAnimation(AnimationUtils.loadAnimation(this,
            android.R.anim.fade_in));
    mSwitcher.setOutAnimation(AnimationUtils.loadAnimation(this,
            android.R.anim.fade_out));

    Gallery g = (Gallery) findViewById(R.id.gallery);
    g.setAdapter(new ImageAdapter(this));
    g.setOnItemSelectedListener(this);
}

public void onItemSelected(AdapterView<?> parent, View v, int position, long id) {
    mSwitcher.setImageResource(mImageIds[position]);
}

public void onNothingSelected(AdapterView<?> parent) {
}

public View makeView() {
    ImageView i = new ImageView(this);
    i.setBackgroundColor(0xFF000000);
    i.setScaleType(ImageView.ScaleType.FIT_CENTER);
    i.setLayoutParams(new ImageSwitcher.LayoutParams(LayoutParams.MATCH_PARENT,
            LayoutParams.MATCH_PARENT));
    return i;
}

private ImageSwitcher mSwitcher;

public class ImageAdapter extends BaseAdapter {
    public ImageAdapter(Context c) {
        mContext = c;
    }

    public int getCount() {
        return mThumbIds.length;
    }

    public Object getItem(int position) {
        return position;
    }

    public long getItemId(int position) {
        return position;
    }

    public View getView(int position, View convertView, ViewGroup parent) {
        ImageView i = new ImageView(mContext);

        i.setImageResource(mThumbIds[position]);
        i.setAdjustViewBounds(true);
        i.setLayoutParams(new Gallery.LayoutParams(
                LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
     //   i.setBackgroundResource(R.drawable.picture_frame);
        return i;
    }

    private Context mContext;

}

private Integer[] mThumbIds = {
        R.drawable.page1, R.drawable.page2};

private Integer[] mImageIds = {
        R.drawable.page1, R.drawable.page2};

} 
```

有人可以告诉我哪里出错了，因为我似乎什么都看不到

我的日志猫：

```
>12-06 17:54:10.050: E/AndroidRuntime(1152): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.fuelfinder/com.example.fuelfinder.ScrollingQuran}: java.lang.ClassCastException: com.example.fuelfinder.ScrollingQuran cannot be cast to android.widget.ViewSwitcher$ViewFactory
12-06 17:54:10.050: E/AndroidRuntime(1152):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2059)
12-06 17:54:10.050: E/AndroidRuntime(1152):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2084)
12-06 17:54:10.050: E/AndroidRuntime(1152):     at android.app.ActivityThread.access$600(ActivityThread.java:130)
12-06 17:54:10.050: E/AndroidRuntime(1152):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1195)
12-06 17:54:10.050: E/AndroidRuntime(1152):     at android.os.Handler.dispatchMessage(Handler.java:99)
12-06 17:54:10.050: E/AndroidRuntime(1152):     at android.os.Looper.loop(Looper.java:137)
12-06 17:54:10.050: E/AndroidRuntime(1152):     at android.app.ActivityThread.main(ActivityThread.java:4745)
12-06 17:54:10.050: E/AndroidRuntime(1152):     at java.lang.reflect.Method.invokeNative(Native Method)
12-06 17:54:10.050: E/AndroidRuntime(1152):     at java.lang.reflect.Method.invoke(Method.java:511)
12-06 17:54:10.050: E/AndroidRuntime(1152):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
12-06 17:54:10.050: E/AndroidRuntime(1152):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
12-06 17:54:10.050: E/AndroidRuntime(1152):     at dalvik.system.NativeStart.main(Native Method)
12-06 17:54:10.050: E/AndroidRuntime(1152): Caused by: java.lang.ClassCastException: com.example.fuelfinder.ScrollingQuran cannot be cast to android.widget.ViewSwitcher$ViewFactory
12-06 17:54:10.050: E/AndroidRuntime(1152):     at com.example.fuelfinder.ScrollingQuran.onCreate(ScrollingQuran.java:31)
12-06 17:54:10.050: E/AndroidRuntime(1152):     at android.app.Activity.performCreate(Activity.java:5008)
12-06 17:54:10.050: E/AndroidRuntime(1152):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1079)
12-06 17:54:10.050: E/AndroidRuntime(1152):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2023)
12-06 17:54:10.050: E/AndroidRuntime(1152):     ... 11 more
12-06 17:56:08.160: E/Trace(1198): error opening trace file: No such file or directory (2) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T18:22:26.617

检查您是否导入了正确的布局参数。我认为应该是 import android.widget.Gallery.LayoutParams; 你可能正在导入其他的.. 看看它

更改类名、xml 文件和那里的图像

```
package com.exam.samplegalery;

import android.app.Activity;
import android.content.Context;
import android.os.Bundle;
import android.view.View;
import android.view.ViewGroup;
import android.view.Window;
import android.view.animation.AnimationUtils;
import android.widget.AdapterView;
import android.widget.BaseAdapter;
import android.widget.Gallery;
import android.widget.Gallery.LayoutParams;
import android.widget.ImageSwitcher;
import android.widget.ImageView;
import android.widget.ViewSwitcher.ViewFactory;

public class MainActivity extends Activity implements AdapterView.OnItemSelectedListener, ViewFactory {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        requestWindowFeature(Window.FEATURE_NO_TITLE);

        setContentView(R.layout.activity_main);

        mSwitcher = (ImageSwitcher) findViewById(R.id.switcher);
        mSwitcher.setFactory(this);
        mSwitcher.setInAnimation(AnimationUtils.loadAnimation(this,
                android.R.anim.fade_in));
        mSwitcher.setOutAnimation(AnimationUtils.loadAnimation(this,
                android.R.anim.fade_out));

        Gallery g = (Gallery) findViewById(R.id.gallery);
        g.setAdapter(new ImageAdapter(this));
        g.setOnItemSelectedListener(this);
    }

    public void onItemSelected(AdapterView<?> parent, View v, int position,
            long id) {
        mSwitcher.setImageResource(mImageIds[position]);
    }

    public void onNothingSelected(AdapterView<?> parent) {
    }

    public View makeView() {
        ImageView i = new ImageView(MainActivity.this);
        i.setBackgroundColor(0xFF000000);
        i.setScaleType(ImageView.ScaleType.FIT_CENTER);
        i.setLayoutParams(new ImageSwitcher.LayoutParams(
                LayoutParams.MATCH_PARENT, LayoutParams.MATCH_PARENT));
        return i;
    }

    private ImageSwitcher mSwitcher;

    public class ImageAdapter extends BaseAdapter {
        public ImageAdapter(Context c) {
            mContext = c;
        }

        public int getCount() {
            return mThumbIds.length;
        }

        public Object getItem(int position) {
            return position;
        }

        public long getItemId(int position) {
            return position;
        }

        public View getView(int position, View convertView, ViewGroup parent) {
            ImageView i = new ImageView(mContext);

            i.setImageResource(mThumbIds[position]);
            i.setAdjustViewBounds(true);
            i.setLayoutParams(new Gallery.LayoutParams(
                    LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
            // i.setBackgroundResource(R.drawable.picture_frame);
            return i;
        }

        private Context mContext;

    }

    private Integer[] mThumbIds = { R.drawable.ic_action_search, R.drawable.ic_launcher };

    private Integer[] mImageIds = { R.drawable.ic_action_search, R.drawable.ic_action_search };

} 
```

# actionscript-3 - textflow 事件以了解何时显示文本

> ID：13748642
> 
> 赞同：0
> 
> 时间：2012-12-06T16:58:09.193
> 
> 标签：actionscript-3, flash, textflow

我需要知道 TextFlow 的文本何时显示。

代码在 MovieClip 中运行，我尝试了以下事件：

textFlow.addEventListener(FlowOperationEvent.FLOW_OPERATION_END, handleEnd); （永远不会发生） textFlow.addEventListener(UpdateCompleteEvent.COMPOSITION_COMPLETE, handleDone); （发生这种情况时，不会显示文本）

看起来文本仅在“下一个”帧上呈现，但我找不到通知文本已显示的事件。

我几乎没有想法，所以如果有人有一些建议，请分享：D

此致

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T18:28:00.227

看起来你把事件搞混了。你有没有尝试过。

```
textFlow.addEventListener(FlowOperationEvent.FLOW_OPERATION_COMPLETE, onFlowComplete); 
```

# c# - 带有 MVC 4 的 VS 2010 中关于缺少对 Microsoft.CSharp.dll 和 System.Core.dll 的引用的警告消息

> ID：13748649
> 
> 赞同：2
> 
> 时间：2012-12-06T16:58:40.667
> 
> 标签：c#, visual-studio-2010, asp.net-mvc-4

我目前收到以下警告：

> 找不到编译动态表达式所需的一种或多种类型。您是否缺少对 Microsoft.CSharp.dll 和 System.Core.dll 的引用？

它会导致智能感知在我所有的 .cshtml 文件中发疯。但是，一切正常。该项目最初是作为 MVC 4 项目创建的。

我试图删除两个 DLL 并重新添加它们以确保它们是 v4.0。

web.config文件中的目标框架也是v4.0。

我似乎无法摆脱警告。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-10-04T19:00:44.860

我相信发生的事情是 web.config 文件以 unicode 格式保存，并且 mvc 的版本中有一个奇怪的字符，因此它被隐藏了。一旦我删除了那个角色，一切都会再次起作用。

# jsp - JSP、javabean和mysql

> ID：13748653
> 
> 赞同：1
> 
> 时间：2012-12-06T16:58:44.170
> 
> 标签：jsp, jdbc, javabeans

您好，我正在做一个项目，每当我尝试运行时，我都会收到此错误消息，但我仍然无法弄清楚该错误。谢谢你的帮助。

```
HTTP Status 500 -

type Exception report

message

descriptionThe server encountered an internal error () that prevented it from fulfilling this request.

exception

javax.servlet.ServletException: The HTTP Monitor server side component intercepted and rethrew an error while processing a JSP or servlet. Please see the stack trace under the root cause message below to identify the problem.

root cause

java.lang.NoClassDefFoundError: JavaBeans/Book

root cause

java.lang.ClassNotFoundException: JavaBeans.Book

note The full stack traces of the exception and its root causes are available in the GlassFish Server Open Source Edition 3.1.2.2 logs. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T17:03:13.163

您很可能已将类命名为

> 带有 Glassfish 3 的 Java EE 6

书。请注意如何命名路径。编译器找不到`Book`该类。

# android - 带有 SQLite 和更新的 Android 应用程序

> ID：13748657
> 
> 赞同：0
> 
> 时间：2012-12-06T16:58:57.537
> 
> 标签：android, sqlite, updates

我在 Google Play 市场上有一个使用 SQLite 的 android 应用程序。我想对应用程序进行新的更新。如果我上传带有更新的新 apk 文件，当用户下载该更新时，那些 SQLite 数据库将被删除并再次创建？更新仅针对图形界面和逻辑，与数据库无关，我没有更改。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T17:00:45.603

他们将留在那里。所有首选项和数据库将保持不变。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T17:56:58.983

Android系统不会弄乱你的数据目录；创建和更新其中的任何文件是您的应用程序的责任。

如果您正在使用`SQLiteOpenHelper`并增加了数据库版本号，您的`onUpgrade`函数将被调用。

# maven - 如何将 github markdown 文件包含到 maven 站点中

> ID：13748659
> 
> 赞同：13
> 
> 时间：2012-12-06T16:59:04.627
> 
> 标签：maven, github, markdown, maven-site-plugin

Github 建议在项目的根目录中创建 Markdown 格式的文件，如 README.md、LICENCE.md 或 CONTRIBUTORS.md。另一方面，这些文件对于自动生成的 Maven 站点来说是有价值的内容。

将这些文件包含到生成的站点报告中的最佳做法是什么？

我的一个想法是将它们复制到 src/site/markdown 并在成功生成站点后再次删除它们（以避免 SCM 污染）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2016-02-16T10:20:04.183

我`README.md`使用您在问题中概述的方法解决了 Git 存储库中文件的这个问题，即`README.md`从根目录复制到`${baseDir}/src/site/markdown`. 我用来`maven-resources-plugin`复制文件。我没有在站点生成后删除复制的文件（以避免 SCM 污染），而是`.gitignore`按照 Bruno 的[建议](https://stackoverflow.com/questions/13748659/how-to-include-github-markdown-files-into-maven-site#comment42980116_13748659)将其添加到.

以下是解决方案的详细说明。

在`project.build.plugins`部分`pom.xml`：

```
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-resources-plugin</artifactId>
    <executions>
        <execution>
            <!-- Copy the readme file to the site source files so that a page is generated from it. -->
            <id>copy-readme</id>
            <phase>pre-site</phase>
            <goals>
                <goal>copy-resources</goal>
            </goals>
            <configuration>
                <outputDirectory>${basedir}/src/site/markdown</outputDirectory>
                <resources>
                    <resource>
                        <directory>${basedir}</directory>
                        <includes>
                            <include>README.md</include>
                        </includes>
                    </resource>
                </resources>
            </configuration>
        </execution>
    </executions>
</plugin> 
```

在`.gitignore`：

```
# Copied from root to site source files by maven-resources-plugin
/src/site/markdown/README.md 
```

[您可以在此处](https://github.com/hobrasoft-cz/PDFMU/commit/6107687d94a9c439459b943031357c5e0632699a)查看相应的提交。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T17:25:17.097

贡献者应该被放入[pom](http://maven.apache.org/pom.html#Contributors)中。许可证文件应该是项目的一部分，通常 LICENSE.txt 作为 Apache 建议的 pom.xml 文件的兄弟。Apache 也建议使用 README.txt。README.md 通常只对 GitHub 在存储库显示期间呈现它有价值。

# javascript - 获取元素的所有父元素，包括元素本身

> ID：13748661
> 
> 赞同：2
> 
> 时间：2012-12-06T16:59:18.460
> 
> 标签：javascript, jquery

我正在尝试创建用户在内容可编辑 div 中单击的所有元素的数组。我有这个使用以下代码。

```
 var els = [];
 var target = event.target;
 while (target){ //Create an array of parent elements
    els.push(target); //Push target to the back of the array
    target = target.parentNode; 
} 
```

但我想知道是否可以使用 jQuery 将其减少到一行。jQuery`.parents()`几乎把我带到了那里，但它不包括第一个`event.target`

```
var els = $(event.target).parents(); 
```

有没有办法将元素本身包含在内，`.parents()`或者有更好的方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-06T17:03:39.763

和Self怎么[样](http://api.jquery.com/andSelf/)？

```
var els = $(event.target).parents().andSelf(); 
```

我的会得到你，曾祖父母，祖父母，父母，自我。

如果你想要：自己、父母、祖父母、曾祖父母，请尝试使用以下方法扩展 Jquery：

```
$.fn.reverse = [].reverse; 
```

然后做：

```
var els = `$(event.target).parents().andSelf().reverse(); 
```

示例：[jsFiddle](http://jsfiddle.net/PhBf9/5/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-06T17:00:23.533

您可以使用[添加](http://api.jquery.com/add/)：

```
var els = $(event.target).parents().add(event.target); 
```

或者，如果您希望它们以不同的顺序排列：

```
var els = $(event.target).add($(event.target).parents()); 
```

* * *

如果您需要的是一个数组（即不是 jQuery 对象），您可以使用 reverse ：

```
var els = $(event.target).parents().add(event.target).get().reverse(); 
```

# excel - 将列数值转换为 alpha

> ID：13748662
> 
> 赞同：0
> 
> 时间：2012-12-06T16:59:20.663
> 
> 标签：excel, vba

> **可能重复：**
> [将列号转换为字母的 VBA 函数？](https://stackoverflow.com/questions/12796973/vba-function-to-convert-column-number-to-letter)

我需要显示一个显示最后使用的列的 msgbox。

现在显示列数值，但可以将其转换为等效的字母字符吗？

前任。第 5 列 = E 列。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T17:41:17.837

我设法得到了2种方法。一个依赖于 excel `Cells`，因此如果您使用无效列，它会失败：

```
Function NumToLetter(q As Long) As String

Dim Add As String
'Ignore error so it fails on an invalid cell
On Error Resume Next
Add = Cells(1, q).Address
If Len(Add) Then
    NumToLetter = Mid(Add, 2, InStr(2, Add, "$") - 2)
Else
    NumToLetter = "Invalid Cell"
End If

End Function 
```

另一个使用基数 26，并且仅限于 bu 的最大值`long`：

```
Function Num2Letter(q As Long) As String

Dim r As Long
While q > 0
    r = q Mod 26
    If r = 0 Then r = 26 ' needed for column Z
    Num2Letter = Chr(64 + r) & Num2Letter
    q = Int(q / 26) + (r = 26) ' fix for column Z
Wend

End Function 
```

使用消息框测试这些值：

```
msgbox "Column 2445 is " & NumToLetter(2445) & " or " Num2Letter(2445) 
```

> 第 2445 列是 CPA 或 CPA

```
msgbox "Column 42445 is " & NumToLetter(42445) & " or " Num2Letter(42445) 
```

> 列 42445 是无效单元格或 BJTM

```
msgbox "Column -1 is " & NumToLetter(-1) & " or " Num2Letter(-1) 
```

> 列 -1 是无效单元格或

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T17:39:04.300

这适用于 A 到 ZZ 列（如 Sean Cheshire 的评论中所指出的）：

```
Function ColLetter(ColNumber As Integer) As String
    ColLetter = Left(Cells(1, ColNumber).Address(False, False), 1 - (ColNumber > 26))
End Function 
```

要使用：`MsgBox ColLetter(oRangeObject.Column)`

# android - OpenCV：转换 MatOfDMatch、MatOfPoint2f、MatOfKeypoint、找到 FundamentalMatrix 的方法

> ID：13748665
> 
> 赞同：0
> 
> 时间：2012-12-06T16:59:35.183
> 
> 标签：android, image-processing, opencv, computer-vision

它可能是一个简单/愚蠢的问题，但我在 opencv (android) 中有一个转换问题。

我的目标是从两个连续图像的相应匹配中计算 basicMatrix。

到目前为止，我对此进行了编程（并且正在工作）：

```
detector.detect(actImg, actKP);
detector.detect(prevImg, prevKP);
descExtractor.compute(prevImg, prevKP, descriptorPrev);
descExtractor.compute(actImg, actKP, descriptorAct);
descMatcher.match(descriptorPrev, descriptorAct, matches);
Features2d.drawMatches(prevImg, prevKP, actImg, actKP,matches, mRgba); 
```

匹配的类型为 MatOfDMatch。

现在我将根据彼此匹配的点计算基础矩阵。因此，我必须知道在第二张图像（actKP）中找到了第一张图像（prevKP）中的哪些关键点。

```
Mat fundamental_matrix = Calib3d.findFundamentalMat(nextPts, prevPts, Calib3d.FM_RANSAC,3, 0.99); 
```

第一个问题：如何将 MatOfKeyPoints 提取/转换为 MatOfPoint2f（它们可以传递给 findFundamentalMatrix）

第二个问题：如何仅将匹配的关键点传递给函数 findFundamentalMatrix。这是一个好方法吗？

非常感谢提前！

**编辑**

非常感谢您的详细回复！我把你的代码写成两个函数：

```
private MatOfPoint2f getMatOfPoint2fFromDMatchesTrain(MatOfDMatch matches2,
        MatOfKeyPoint prevKP2) {
    DMatch dm[] = matches2.toArray();
    List<Point> lp1 = new ArrayList<Point>(dm.length);
    KeyPoint tkp[] = prevKP2.toArray();
    for (int i = 0; i < dm.length; i++) {
        DMatch dmm = dm[i];
        if (dmm.trainIdx < tkp.length) 
            lp1.add(tkp[dmm.trainIdx].pt);
    }
    return new MatOfPoint2f(lp1.toArray(new Point[0]));
}

private MatOfPoint2f getMatOfPoint2fFromDMatchesQuery(MatOfDMatch matches2,
        MatOfKeyPoint actKP2) {
    DMatch dm[] = matches2.toArray();
    List<Point> lp2 = new ArrayList<Point>(dm.length);
    KeyPoint qkp[] = actKP2.toArray();
    for (int i = 0; i < dm.length; i++) {
        DMatch dmm = dm[i];
        if (dmm.queryIdx < qkp.length)
            lp2.add(qkp[dmm.queryIdx].pt);
    }
    return new MatOfPoint2f(lp2.toArray(new Point[0]));
} 
```

但是当我打电话时

```
prevPts = getMatOfPoint2fFromDMatchesTrain(matches, prevKP);
nextPts = getMatOfPoint2fFromDMatchesQuery(matches, actKP);
Mat fundamental_matrix = Calib3d.findFundamentalMat(
        nextPts, prevPts, Calib3d.FM_RANSAC, 3, 0.99); 
```

问题是我收到错误-215。错误：

> *错误：(-215) npoints >= 0 && points2.checkVector(2) == npoints && points1.type() == points2.type() 在函数 cv::Mat cv::findFundamentalMat(...*

我证明了 prevPts 和 nextPts 低于 10 分（对于 ransac）。所以我猜错误是这些点是浮点数。但我用调试器检查了这些点是浮点数。

您建议的代码行：

```
return new MatOfPoint2f(lp2.toArray(new Point[0])); 
```

应该将点转换为浮点还是我错了？

再次感谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-06T22:31:20.130

不幸的是，没有比遍历所有匹配项并将值复制到新的 Mat（或向量）更好的方法（即使在 C++ API 中）。

在 Java 中，您可以执行以下操作：

```
DMatch dm[] = matches.toArray();
List<Point> lp1 = new ArrayList<Point>(dm.length);
List<Point> lp2 = new ArrayList<Point>(dm.length);
KeyPoint tkp[] = prevKP.toArray();
KeyPoint qkp[] = actKP.toArray();
for (int i = 0; i < dm.length; i++) {
    DMatch dm = dm[i];
    lp1.add(tkp[dm.trainIdx].pt);
    lp2.add(qkp[dm.queryIdx].pt);
}

MatOfPoint2f pointsPrev = new MatOfPoint2f(lp1.toArray(new Point[0]));
MatOfPoint2f pointsAct  = new MatOfPoint2f(lp2.toArray(new Point[0])); 
```

# jquery - 客户端验证不适用于 MVC3 剃刀视图中的自定义属性

> ID：13748667
> 
> 赞同：0
> 
> 时间：2012-12-06T16:59:41.720
> 
> 标签：jquery, asp.net-mvc-3

我创建了一个自定义属性来从配置文件中读取字符串长度值的值。我在使用 ajax get 加载的局部视图上使用它。

这是我的自定义属性的代码：

```
public class ConfigMaxLengthAttribute : StringLengthAttribute,IClientValidatable
    {
        private readonly int _maxLength;

        public ConfigMaxLengthAttribute(string key)
            : base(int.Parse(ConfigurationManager.AppSettings[key]))
        {
            _maxLength = int.Parse(ConfigurationManager.AppSettings[key]);
        }

        public override bool IsValid(object value)
        {
            var strValue = value as string;
            if (!string.IsNullOrEmpty(strValue))
            {
                var len = strValue.Length;
                return len <= _maxLength;
            }
            return true;
        }

        public IEnumerable<ModelClientValidationRule> GetClientValidationRules(ModelMetadata metadata, ControllerContext context)
        {
            yield return new ModelClientValidationRule
               {
                   ErrorMessage = "Custom Error Message",
                   ValidationType = "stringmaxlength"
               };
        }
    } 
```

在 JS 文件中，我包含了以下代码：

```
/// <reference path="jquery-1.7.2.js" />
/// <reference path="jquery.validate.js" />
/// <reference path="jquery.validate.unobtrusive.js" />
jQuery.validator.addMethod('greaterThan', function (value, element, params) {
    return value.length>200;
}, '');

jQuery.validator.unobtrusive.adapters.add('stringmaxlength', {}, function (options) {
        options.rules['greaterThan'] = true;
        options.messages['greaterThan'] = options.messages;
    }); 
```

这将为 html 中的字段生成以下标记：

```
<textarea cols="28" data-val="true" data-val-stringmaxlength="Notes entered cannot be more than 200 characters." id="UserNote" name="UserNote" rows="2" >
</textarea> 
```

我已经在视图中包含了这个 JS 文件。在我的 web.config 文件中启用了客户端验证..

我所有使用数据注释的客户端验证都在工作，除了这个自定义属性一..

我不知道如何进一步进行，请任何帮助...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T08:19:00.773

通过 Ajax 加载部分内容需要您重新解析新内容，以便验证框架能够理解 HTML 中任何不显眼的验证属性。我假设您正在使用 jquery 验证。

因此，如果您将一些包含表单的内容加载到某个容器 div 中，那么：

```
var form = $(newContentContainerDiv).find("form");
$.validator.unobtrusive.parse(form); 
```

...这将重新解析新表单中的验证属性。

这是通过 Ajax 加载新内容时的要求，因为验证 f/w 不会知道它。

如果您想测试您的属性是否确实有效，那么只需在一些常规视图中包含部分内容（即不要使用 Ajax），如果您的属性有效，那么它应该在没有任何额外工作的情况下进行验证。

# jsf-2 - 如何在 Primefaces 对话框中显示 DataList 项

> ID：13748668
> 
> 赞同：1
> 
> 时间：2012-12-06T16:59:43.500
> 
> 标签：jsf-2, primefaces

当单击 DataList 中的 SelectBooleanCheckbox 时，我需要能够显示一个引用当前项目的对话框。在对列表进行分页时，我似乎无法在 valueChange 上传递当前项目/索引或保留当前项目的记录。要么对我有用。有人可以帮忙吗？

谢谢 :) 尼尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T20:09:09.637

如果您使用视图范围的 bean，这很容易。基本上，您只需将数据列表的当前项设置为 bean 的属性并更新应显示该项的对话框内容，然后打开对话框。假设对话框表示您希望在成功保存时关闭的编辑表单，那么您也希望使用新值更新数据列表。你可以用`<p:remoteCommand>`这个。当然，您也可以将数据列表的客户端 ID 添加到`update`对话框中命令按钮的属性中，但是当出现验证错误时，这是​​不必要的。

这是一个具体的启动示例：

```
<h:form>
    <p:dataList id="list" value="#{bean.items}" var="item">
        #{item.id} #{item.value}
        <p:commandButton value="edit" 
            action="#{bean.setItem(item)}" 
            update=":editForm" 
            oncomplete="editDialog.show()" />
    </p:dataList>
    <p:remoteCommand name="updateList" update="list" />
</h:form>
<p:dialog widgetVar="editDialog">
    <h:form id="editForm">
        <p:messages autoUpdate="true" />
        <h:inputText value="#{bean.item.value}" required="true" />
        <p:commandButton value="save" 
            action="#{bean.save}" 
            oncomplete="if (!args.validationFailed) { editDialog.hide(); updateList(); }" />
    </h:form>
</p:dialog> 
```

用这个豆子：

```
@ManagedBean
@ViewScoped
public class Bean implements Serializable {

    private List<Item> items;
    private Item item;

    @EJB
    private ItemService service;

    @PostConstruct
    public void loadItems() {
        items = service.list();
    }

    public void save() {
        service.save(item);
        loadItems();
    }

    public List<Item> getItems() {
        return items;
    }

    public Item getItem() {
        return item;
    }

    public void setItem(Item item) {
        this.item = item;
    }

} 
```

# jquery - jQuery 选择器按名称获取表单

> ID：13748669
> 
> 赞同：44
> 
> 时间：2012-12-06T16:59:42.037
> 
> 标签：jquery, jquery-selectors

我有以下 HTML：

```
<form name="frmSave">...</form> 
```

只是要知道，我**无法**修改 HTML 以添加`id`或其他内容。

这就是我试图`form`通过它的名称来获取元素的内容：

```
var frm = $('form[name="frmSave"]');

console.log(frm); 
```

*（但我相信上面的代码会尝试获取一个`frmSave`名称在`form`其中的子元素，这不是我需要的）。*

**我怎样才能做到这一点，是否可以`form`通过`name`和使用选择器来获得？**

* * *

## 更新：

我在我的原始代码中做错了方式（我在选择器中使用了一个空格，也就是“组合器”）而不是在代码片段中，所以 jQuery 试图获取任何具有所需名称的子元素，我在问自己什么是错的，因为没有返回任何东西。

接受的答案对此给出了更好的解释，所以一点空间可以改变一切 - 下次我会好好睡觉:-)

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2012-12-06T17:03:04.597

`$('form[name="frmSave"]')`是正确的。您提到您认为这会使所有`frmsave`在表单中具有该名称的孩子；只有在表单和选择器之间有空格或其他组合符时才会发生这种情况，例如：`$('form [name="frmSave"]');`

`$('form[name="frmSave"]')`字面意思是*查找所有带有 name 的表单`frmSave`*，因为不涉及组合器。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-11-21T08:48:41.800

```
 // this will give all the forms on the page.

    $('form')

   // If you know the name of form then.

    $('form[name="myFormName"]')

  //  If you don't know know the name but the position (starts with 0)

    $('form:eq(1)')  // 2nd form will be fetched. 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-12-06T17:03:41.120

您没有组合子（空格、`>`... `+`），因此永远不会有孩子参与其中。

`ID`但是，您可以通过使用and来避免对 jQuery 的需求`getElementById`，或者您可以使用旧`getElementsByName("frmSave")[0]`的甚至更旧的`document.forms['frmSave']`. 这里不需要 jQuery。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-03-30T11:59:37.223

为了检测表单是否存在，我正在使用

```
if($('form[name="frmSave"]').length > 0) {
    //do something
} 
```

# java - 存储文件以在 Java 项目中使用的良好做法是什么，以及如何访问它们？

> ID：13748671
> 
> 赞同：0
> 
> 时间：2012-12-06T16:59:45.103
> 
> 标签：java, file, persistence, project, javafx-2

目前，我有一种临时的方式来访问我的 Java 代码调用的 FXML 文件和 CSS 文件。

为了访问我的 CSS 文件，我将它们放在我的`bin`文件夹中，并通过我的 FXML 文件中的引用访问它，如下所示。

`<fx:root type="javafx.scene.layout.AnchorPane" prefHeight="600.0" prefWidth="800.0" xmlns:fx="http://javafx.com/fxml" stylesheets="splashStyle.css">`

为了访问我的 FXML 文件，我将它们存储在我的`.class`文件所在的任何位置，并按如下方式访问它们。

`FXMLLoader fxmlLoader = new FXMLLoader(getClass().getResource("splashLayout.fxml"));`

所以我很好奇在存储和访问方面有更好的方法来做到这一点，因为刚才看起来非常不一致和不专业。

谢谢！:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T17:22:21.523

我认为最好的做法是将资源存储在一个文件夹中，如：src/main/resources 作为 maven 项目布局建议（参见：[http ://maven.apache.org/guides/introduction/introduction-to-the-standard-directory -layout.html](http://maven.apache.org/guides/introduction/introduction-to-the-standard-directory-layout.html)

要访问它们，请参见：[http ://docs.oracle.com/javase/1.5.0/docs/guide/lang/resources.html](http://docs.oracle.com/javase/1.5.0/docs/guide/lang/resources.html)

或者这个：[如何在 jar 文件中使用 ClassLoader.getResources()](https://stackoverflow.com/questions/11516655/how-to-use-classloader-getresources-in-jar-file)

# javascript - 这两种声明 JS 属性的方式之间的区别

> ID：13748673
> 
> 赞同：0
> 
> 时间：2012-12-06T16:59:50.863
> 
> 标签：javascript

我目前正在使用以下模式来创建要使用的 JS 模块。但是，我不知道在第一种风格和第二种风格中这样做是否有任何区别或任何好处。

***第一种方式***

```
var UI = UI || {};
(function () {
var BtnShape = function (x, y, width, height, size, color, text)
{
    this.initialise(x, y, width, height, size, color, text);
}
var p = BtnShape.prototype;

    p.isEnabled = false; //<--------------
    p.initialise = function (x, y, width, height, size, color, text)
    {}
UI.BtnShape = BtnShape;
})(); 
```

***第二种方式***

```
var UI = UI || {};
(function () {
var BtnShape = function (x, y, width, height, size, color, text)
{
    this.initialise(x, y, width, height, size, color, text);
}
var p = BtnShape.prototype;

    p.initialise = function (x, y, width, height, size, color, text)
    {
            this.isEnabled = false; //<---------------
    }
UI.BtnShape = BtnShape;
})(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T17:05:59.737

第一种方式：`isEnabled`将是`false`，无论你是否打电话`initialise()`。

第二种方式：`isEnabled`只有`false`当你打电话时才会这样做`initialise()`，`undefined`否则。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-06T17:07:42.920

`isEnabled`我在这里可以看到的唯一区别是设置属性的顺序。通过将属性嵌套`isEnabled`到初始化函数中，您需要在具有任何值`initalise`之前运行该过程。`isEnabled`我假设你会在做任何事情之前运行初始化函数，但如果你不这样做，那`isEnabled`将是空的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-06T17:12:57.507

第一种方式，默认情况下未启用（但未定义）

```
// After all your code
var x= BtnShape.prototype;
// Here x is not enabled . If you want to enable it, you need to do it separately like below.
p.isEnabled = true; 
```

第二种方式，当你初始化对象时，默认情况下它变为 false。除非，你初始化，如果你初始化，它变成拨号。您需要单独启用它。

```
var y =BtnShape.prototype;
// Here if you don't initialize the object y, then isEnabled is undefined. 
```

# python - Python re.sub()：如何用 'you' 替换所有 'u' 或 'U'

> ID：13748674
> 
> 赞同：51
> 
> 时间：2012-12-06T16:59:52.643
> 
> 标签：python, regex

我正在使用 python 和正则表达式进行一些文本规范化。我想用'you'代替所有'u'或'U'。这是我到目前为止所做的：

```
import re
text = 'how are u? umberella u! u. U. U@ U# u '
print re.sub (' [u|U][s,.,?,!,W,#,@ (^a-zA-Z)]', ' you ', text) 
```

我得到的输出是：

```
how are you  you berella you  you  you  you  you  you 
```

如您所见，问题在于“umberella”更改为“berella”。我也想保留出现在“u”之后的字符。例如，我想要“你！” 改为“你！”。谁能告诉我我做错了什么以及编写正则表达式的最佳方法是什么？

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2012-12-06T17:08:20.177

首先，为什么您的解决方案不起作用。你混淆了很多概念。主要是[字符类](http://www.regular-expressions.info/charclass.html)与其他字符类。在您使用的第一个字符类中，`|`它源于[alternation](http://www.regular-expressions.info/alternation.html)。在字符类中，您不需要管道。只需列出您想要的所有字符（和字符范围）：

```
[Uu] 
```

`u`或者，如果您使用不区分大小写的修饰符，则只需编写。如果你在那里写一个管道，字符类实际上会匹配你的主题字符串中的管道。

现在在第二个字符类中，出于某种奇怪的原因，您使用逗号分隔字符。除了在可匹配字符中包含逗号之外，这也无济于事。`s`并且`W`可能应该是内置的字符类。然后逃离他们！否则它们只会匹配 literal`s`和 literal `W`。但是`\W`已经包含了您在此处列出的所有其他内容，因此`\W`单独（不带方括号）就足够了。最后一部分`(^a-zA-Z)`也不起作用，因为它将简单地将`^`,`(`和`)`所有字母包含到字符类中。否定语法仅适用于整个字符类，例如`[^a-zA-Z]`.

你真正想要的是断言你的 . 前面或后面没有字母`u`。您可以为此使用[环视](http://www.regular-expressions.info/lookaround.html)。优点是它们不会包含在匹配中，因此不会被删除：

```
r'(?<![a-zA-Z])[uU](?![a-zA-Z])' 
```

请注意，我使用了原始字符串。通常是正则表达式的好习惯，以避免转义序列出现问题。

这些是负面的环顾四周，确保您的 . 之前或之后没有字母字符`u`。这是断言周围有一个非字母字符（与您所做的类似）的重要区别，因为后一种方法在字符串的开头或结尾不起作用。

当然，您可以`you`从替换字符串中删除空格。

如果您不想替换`u`数字旁边的数字，您可以轻松地将数字包含到字符类中：

```
r'(?<![a-zA-Z0-9])[uU](?![a-zA-Z0-9])' 
```

如果由于某种原因相邻的下划线也会取消您`u`的替换资格，您也可以将其包括在内。但是字符类与内置的一致`\w`：

```
r'(?<!\w)[uU](?!\w)' 
```

在这种情况下，这相当于 EarlGray 的`r'\b[uU]\b'`.

如上所述，您可以通过使用不区分大小写的修饰符来缩短所有这些。以第一个表达式为例：

```
re.sub(r'(?<![a-z])u(?![a-z])', 'you', text, flags=re.I) 
```

或者

```
re.sub(r'(?<![a-z])u(?![a-z])', 'you', text, flags=re.IGNORECASE) 
```

取决于你的喜好。

我建议您阅读我在此答案中多次链接的教程。这些解释非常全面，应该让您在正则表达式方面有一个良好的开端，您可能迟早会再次遇到。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-12-06T17:05:10.577

使用特殊字符`\b`，匹配单词开头或结尾的空字符串：

```
print re.sub(r'\b[uU]\b', 'you', text) 
```

空格不是一个可靠的解决方案，因为还有很多其他标点符号，所以`\b`发明了一个抽象字符来指示单词的开头或结尾。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-03-23T08:43:14.167

这对我有用：

```
 import re
    text = 'how are u? umberella u! u. U. U@ U# u '
    rex = re.compile(r'\bu\b', re.IGNORECASE)
    print(rex.sub('you', text)) 
```

它预编译正则表达式并使用 re.IGNORECASE，这样我们就不必担心正则表达式中的大小写了！顺便说一句，我喜欢伞的时髦拼写！:-)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-07-31T14:27:51.660

也可以用下面的代码来实现

```
import re

text = 'how are u? umberella u! u. U. U@ U# u '
print (re.sub (r'[uU] ( [^a-z] )', r' you\1 ', text)) 
```

或者

```
print (re.sub (r'[uU] ( [\s!,.?@#] )', r' you\1 ', text)) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-11-14T14:21:13.157

我想出的另一个可能的解决方案是：

```
re.sub(r'([uU]+(.)?\s)',' you ', text) 
```

# dynamics-crm-2011 - 不“默认可见”的字段旁边的字段从右列向左移动

> ID：13748676
> 
> 赞同：1
> 
> 时间：2012-12-06T16:59:54.890
> 
> 标签：dynamics-crm-2011, dynamics-crm

我在 Dynamics CRM 2011 中有一个表格，它有两列。左侧列的底部是一个最初不可见的字段（未选中“默认可见”复选框）。在某些情况下，我可能希望使用 JScript 使其可见。

我遇到的问题是，当它不可见时，其右侧的字段向左移动。我不希望这种情况发生，我希望另一个字段保留在右侧栏中。

关于如何做到这一点的任何建议？我不能放一个 Spacer，因为很明显有一个字段挡住了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T18:54:12.607

这取决于表单的设置方式，但有时您可以设置两个部分，并显示/隐藏它们。

例如

```
Section 1
Field A | Field B

Section 2
Spacer | Field B 
```

因此，要仅显示字段 B，请隐藏第 1 节并显示第 2 节。要同时显示它们，请显示第 1 节并隐藏第 2 节。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T10:04:49.830

一种替代方法是在表单中添加一个新的 2 列选项卡，每个选项卡都包含一个单列部分。

您可以只为这两个字段执行此操作，但当然这确实意味着您控制其可见性的字段将超出正常的制表符顺序（即不在其上方列之后的下一个）。这对您来说可能不是问题。您可以格式化选项卡以不显示它的标签，因此它实际上是不可见的。

最好用这样的两列制表符结构有效地替换整个两列部分，以保留您现在拥有的制表符顺序。如果你想要一个节标签，那么两者都必须有一个以保持对齐正确。您可能需要执行一些不理想的选项，例如右侧选项卡的部分具有标签“。”，或者您可以为该列选择一个完全有效的标签，与左侧标签分开。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-08T07:40:11.957

使用 javascript 来“隐藏”该字段。不可见和隐藏是有区别的。

如果一个字段不可见，它会从屏幕上删除，而隐藏字段是一个 CSS 东西，它会留在屏幕上，因此右侧的字段不会向左移动。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-07T16:01:55.810

我认为最简单的解决方案是使用 Spacer。如果已经完成，不需要更改表单，也不需要用 JS 隐藏字段，因为它看起来有点难看（显示一个字段并在隐藏它之后） [http://crmdm.blogspot.ie/ 2011/04/how-to-insert-empty-space-between.html](http://crmdm.blogspot.ie/2011/04/how-to-insert-empty-space-between.html)

# java - Eclipse 插件建议替换已弃用的功能警告

> ID：13748678
> 
> 赞同：3
> 
> 时间：2012-12-06T17:00:01.523
> 
> 标签：java, android, eclipse

有什么我可以安装的，而不是得到不推荐使用的功能警告，这些警告只是表明某些东西已被弃用，并且只提供抑制警告，而是提供有关不推荐使用的做某事的方法的信息。

ex而不是这个Android代码：

```
TableRow tr = new TableRow(this);
tr.setLayoutParams(new LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.WRAP_CONTENT)); 
```

收到此警告/建议：

```
The field ViewGroup.LayoutParams.FILL_PARENT is deprecated 
1 quick fix available: 
@ Add @SupressWarnings 'deprication' to 'currentMethod()' 
```

我倒要看看：

```
The field ViewGroup.LayoutParams.FILL_PARENT is deprecated 
1 quick fix available: 
@ Use LayoutParams.MATCH_PARENT instead 
```

而不必复制消息并搜索以找出[首选修复程序是](https://stackoverflow.com/questions/8516825/is-deprecated-word-the-only-difference-between-fill-parent-and-match-parent)什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T20:08:58.787

你不会找到类似的东西。迁移操作各不相同，实施快速修复需要相当多的工作，而且这种快速修复的有用保质期会很短。考虑到所有这些，它只是不计算开发这些。

# php - MySQL多查询不起作用

> ID：13748681
> 
> 赞同：-1
> 
> 时间：2012-12-06T17:00:05.073
> 
> 标签：php, mysql, sql, mysqli

我正在使用以下脚本：

```
<?php

ini_set('max_execution_time', 0);

ini_set('error_reporting', E_ALL);

$file = file_get_contents('./dump.sql');

//var_dump($file); die();

$conn = new mysqli('localhost', 'myUserName', 'myPassWord', 'myDataBase');

if (mysqli_connect_error()) {
    die('Connect Error (' . mysqli_connect_errno() . ') '
            . mysqli_connect_error());
}

echo 'Success... ' . $conn->host_info . "<br />";
echo 'Retrieving dumpfile' . "<br />";

$sql = $file;
if (!$sql){
    die ('Error opening file');
}

echo 'processing file <br />';
mysqli_multi_query($conn,$sql);

echo 'done.';
$conn->close();

?> 
```

它输出以下内容，一切似乎都很顺利，没有任何错误：

```
Success... localhost via TCP/IP
Retrieving dumpfile
processing file
done. 
```

但是，我的数据库中没有字段。什么都没有添加。

我的 dump.sql 文件中的第一行代码如下：

```
-- phpMyAdmin SQL Dump
-- version 3.4.5
-- http://www.phpmyadmin.net
--
-- Host: localhost
-- Generation Time: Dec 05, 2012 at 04:01 PM
-- Server version: 5.5.16
-- PHP Version: 5.3.8

SET SQL_MODE="NO_AUTO_VALUE_ON_ZERO";
SET time_zone = "+00:00";

/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8 */;

--
-- Database: `myDataBase`
--

-- --------------------------------------------------------

--
-- Table structure for table `content_field_image_cache`
--

CREATE TABLE IF NOT EXISTS `content_field_image_cache` (
  `vid` int(10) unsigned NOT NULL DEFAULT '0',
  `nid` int(10) unsigned NOT NULL DEFAULT '0',
  `delta` int(10) unsigned NOT NULL DEFAULT '0',
  `field_image_cache_fid` int(11) DEFAULT NULL,
  `field_image_cache_list` tinyint(4) DEFAULT NULL,
  `field_image_cache_data` text,
  PRIMARY KEY (`vid`,`delta`),
  KEY `nid` (`nid`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

--
-- Dumping data for table `content_field_image_cache`
--

INSERT INTO `content_field_image_cache` (`vid`, `nid`, `delta`, `field_image_cache_fid`, `field_image_cache_list`, `field_image_cache_data`) VALUES
(1000, 1000, 0, 1000, 1, NULL),
(1001, 1001, 0, 1001, 1, NULL),
(1002, 1002, 0, 1002, 1, NULL),
(1003, 1003, 0, 1003, 1, NULL), 
```

为什么这段代码不起作用？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T17:30:23.370

看来您需要遍历结果以消除`MySQL server has gone away.`错误：

以最简单的形式（未经测试的示例）：

```
mysqli_multi_query($conn,$sql);

// You can do something with the results as well...
while (mysqli_use_result($conn) && mysqli_next_result($conn));

echo 'done.';
$conn->close(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T17:05:08.970

尝试用分号“;”结束插入 而不是最后一个元组后面的逗号。

# asp.net-mvc - 实体框架代码优先多对多插入

> ID：13748686
> 
> 赞同：0
> 
> 时间：2012-12-06T17:00:32.393
> 
> 标签：asp.net-mvc, entity-framework, many-to-many, poco

我正在使用 EF 代码优先方法和流利的 api。我的申请中有一个注册表单，在其中注册候选人可以从下拉列表中选择多个选项（对注册表单上的下拉列表感兴趣），其中包含一组预定义的选项（将来可能会增加，但机会非常少）。当用户提交表单时，我想将此记录保存到数据库中。所以我创建了以下实体。

**将保存注册候选人信息的参与者班级**

```
public class Participant
    {
        public Participant()
        {
            Interests = new Collection<Interest>();
        }
        [Key]
        public int Id { get; set; }
        [DisplayName("First Name")]
        [StringLength(50, ErrorMessage = "First name cannot be more than 50 characters")]
        [Required(ErrorMessage = "You must fill in first name")]
        public string FirstName { get; set; }

        [DisplayName("Last Name")]
        [StringLength(50, ErrorMessage = "Last name cannot be more than 50 characters")]
        [Required(ErrorMessage = "You must fill in last name")]
        public string LastName { get; set; }

        [Required(ErrorMessage = "You must indicate your full birthday")]
        [DisplayName("Birthday")]
        [DataType(DataType.DateTime)]
        public DateTime BirthDate { get; set; }

        [DisplayName("Gender")]
        [Required(ErrorMessage = "You must select gender")]
        public int Gender { get; set; }

        public string Address { get; set; }

        public int CountryId { get; set; }
        public Country Country { get; set; }

        [DisplayName("Zip code")]
        [StringLength(10, ErrorMessage = "Zip code cannot be more than 10 characters")]
        public string ZipCode { get; set; }

        public string Mobile { get; set; }

        public string PhotoUrl { get; set; }

        public int UserId { get; set; }
        public User User { get; set; }

        public virtual ICollection<Interest> Interests { get; set; }
} 
```

**注册表格上的“感兴趣”下拉列表中的兴趣类** **用户可以从“感兴趣”下拉列表中选择多个选项**

```
public class Interest
    {
        public Interest()
        {
            Participants = new Collection<Participant>();
        }
        public int Id { get; set; }
        public string InterestName { get; set; }
        public virtual ICollection<Participant> Participants { get; set; }
    } 
```

为了保持每个参与者的兴趣，我在 DB 中使用以下模式创建了一个 ParticipantInterests 表。 **ParticipantInterests** Id (PK) ParticipantId（来自 Participants 表的 FK） InterestId（FK Interests 表）

我`public virtual ICollection<Participant> Participants { get; set; }`在兴趣模型中添加了

```
public virtual ICollection<Interest> Interests { get; set; } in Participant model to form Many-To-Many association. 
```

**我的数据上下文类如下**

```
public class STNDataContext : DbContext
    {
        public DbSet<User> Users { get; set; }
        public DbSet<Participant> Participants { get; set; }
        public DbSet<Country> Countries { get; set; }
        public DbSet<Interest> Interests { get; set; }
        public DbSet<Role> Roles { get; set; }
        public DbSet<SecurityQuestion> SecurityQuestions { get; set; }

        public DbSet<Tour> Tours { get; set; }
        protected override void OnModelCreating(DbModelBuilder modelBuilder)
        {
            modelBuilder.Entity<Participant>().
                HasMany(p => p.Interests).
                WithMany().
                Map(
                    m =>
                    {
                        m.ToTable("ParticipantInterests");
                        m.MapLeftKey("ParticipantId");
                        m.MapRightKey("InterestId");
                    });
            modelBuilder.Entity<User>().HasRequired(u => u.Role);
            modelBuilder.Entity<Participant>().HasRequired(p => p.Country);
            modelBuilder.Entity<Participant>().HasRequired(p => p.Interests);
        }

        public virtual void Commit()
        {
            base.SaveChanges();
        }
    } 
```

**控制器动作代码**

```
public virtual ActionResult Register(StudentRegisterViewModel studentRegisterViewModel)
        {
if (ModelState.IsValid)
            {
                if (_userService.IsUserExists(studentRegisterViewModel.Participant.User) == false)
                {
                    studentRegisterViewModel.Participant.User.Username = studentRegisterViewModel.Username;
                    studentRegisterViewModel.Participant.User.Email = studentRegisterViewModel.Email;
                    studentRegisterViewModel.Participant.User.DateCreated = DateTime.Now;
                    studentRegisterViewModel.Participant.User.Id = 3;
                    studentRegisterViewModel.Participant.User.IsApproved = false;
                    studentRegisterViewModel.Participant.User.RoleId = 2;
                    studentRegisterViewModel.Participant.CountryId = 1;
                    foreach (var interestItem in studentRegisterViewModel.SelectedInterests)
                    {
                        var interest = new Interest { Id = interestItem};
                        studentRegisterViewModel.Participant.Interests.Add(interest);
                    }

                    _participantService.CreatParticipant(studentRegisterViewModel.Participant);

                }
            }

            studentRegisterViewModel.Gender =
                Enum.GetNames(typeof(Gender)).Select(
                    x => new KeyValuePair<string, string>(x, x.ToString(CultureInfo.InvariantCulture)));
            studentRegisterViewModel.Interests = _interestService.GetAllInterests();
            return View(studentRegisterViewModel);
        } 
```

当我尝试创建参与者时，出现以下错误。 **{"无法将值 NULL 插入到列 'InterestName'、表 'StudyTourNetworkDB.dbo.Interests'；列不允许空值。INSERT 失败。\r\n语句已终止。"}**

理想情况下，根据我的想法，它应该在 Participants 表和 ParticipantsInterests 表中插入参与者信息。但它也试图在兴趣表中插入记录，这也不应该发生。请帮我解决这个问题。通过创建多对多关联，我可能做错了。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T17:15:01.173

*   从表中删除`Id`列并生成一个复合主键。将它们保留为外键。`ParticipantInterests``ParticipantId``InterestId`

*   将您的多对多映射更改为...

    ```
    //...
    HasMany(p => p.Interests).
    WithMany(i => i.Participants).
    //... 
    ```

    ...并删除此映射线：

    ```
    modelBuilder.Entity<Participant>().HasRequired(p => p.Interests); 
    ```

*   将兴趣附加到上下文以避免 EF 尝试插入它：

    ```
    foreach (var interestItem in studentRegisterViewModel.SelectedInterests)
    {
        var interest = new Interest { Id = interestItem};
        context.Interests.Attach(interest);
        studentRegisterViewModel.Participant.Interests.Add(interest);
    } 
    ```

    您必须将与上下文相关联的行带入您的服务类中。`context`我猜你的控制器中没有可用的。但希望你能明白。

# ios - json数据到服务器

> ID：13748690
> 
> 赞同：1
> 
> 时间：2012-12-06T17:00:38.730
> 
> 标签：ios, json, nsdata

我正在开发一个应用程序，我必须在其中以如下格式发送`deviceToken`和`uuid`服务器`JSON`：`"regid":"x1y2z3","uuid":"1a2b3c"`如何将`NSString`s`NSData`以这种格式存储并将其发送到服务器？

`regid`字符串就像`x1y2z3`和`uuid`字符串一样`1a2b3c`。

**我的代码：**

```
 PushNotification* pushHandler = [self.viewController getCommandInstance:@"PushNotification"];
[pushHandler didRegisterForRemoteNotificationsWithDeviceToken:deviceToken];

NSString *deviceT = [[deviceToken description] stringByTrimmingCharactersInSet:[NSCharacterSet characterSetWithCharactersInString:@"<>"]];
NSString *tkStr = [[NSString alloc]initWithData:deviceToken encoding:NSUTF8StringEncoding];
tkStr = [deviceT stringByReplacingOccurrencesOfString:@" " withString:@""];
NSLog(@"Device Token = %@",tkStr);
//UUID
CFUUIDRef uuid = CFUUIDCreate(kCFAllocatorDefault);
NSString *uuidStr = ( NSString *)CFUUIDCreateString(kCFAllocatorDefault, uuid);
CFRelease(uuid);
NSString *finalUIDstr = [uuidStr stringByReplacingOccurrencesOfString:@"-" withString:@""];
NSLog(@"UUID = %@",finalUIDstr);
NSArray *keysArray = [NSArray arrayWithObjects:@"regid", @"uuid", nil];
NSArray *objectArray = [NSArray arrayWithObjects:tkStr,finalUIDstr, nil];
//Dictionary

NSDictionary *jsonDict = [NSDictionary dictionaryWithObjects:objectArray forKeys:keysArray]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T17:17:02.427

如果您想生成该 JSON 字符串，您可以构建您的字典（这是在 Xcode 4.5 中执行此操作的更简洁的方法，而不是构建这两个数组，然后将它们组合成一个字典）：

```
NSDictionary *dictionary = @{@"regid":tkStr,@"uuid":finalUIDstr}; 
```

然后生成您的 JSON 字符串：

```
NSError *error;
NSData *data = [NSJSONSerialization dataWithJSONObject:dictionary
                                               options:0
                                                 error:&error]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T17:16:50.067

将 NSDictionary 转换为 Json（NSJSONSerialization 或 SBJson）并将其作为 Application/Json 发布到服务器。

# php - 如何为多个循环创建单独的分页？

> ID：13748699
> 
> 赞同：3
> 
> 时间：2012-12-06T17:01:00.160
> 
> 标签：php, wordpress

我创建了两个带分页的循环（第一个循环通过**CAT'S**类别循环，第二个循环通过**DOG'S**类别），但现在我被卡住了:(

**问题：**在我的网站（**CAT'S**类别）上单击“下一个条目”后，它转到第二个进入该类别，**但它也**进入我的**DOG'S**类别第二个条目（**我不想要那个！！**）。反之亦然......

我喜欢做的是：我在我的**CAT'S**类别上单击“下一个条目”，它只进入**该****类别（CAT'S）**中的下一个帖子，而**不是**我的**DOG'S**类别中的第二个帖子，或者其他方式：我点击我的**DOG'S**类别中的“下一个条目” ，**它只进入该****类别 (DOG'S)**中的下一个帖子，而**不是**我的**CAT'S**类别中的第二个帖子。

有人能帮助我吗？[我前段时间在wordpress.stackexchange.com](https://wordpress.stackexchange.com/)上寻求帮助， 但没有得到任何答案，所以我在这里提出问题。

索引 php 看起来像这样：

```
<?php get_header(); ?>
<?php get_sidebar(); ?>
<div id="blog">         
    <?php         
    $args = array(
    'category_name' => 'cats' 
    );
    $paged = (get_query_var('paged')) ? get_query_var('paged') : 1;
    $the_query = new WP_query($args . '&paged=' . $paged . '&cat=-3');      
    while( $the_query -> have_posts()) : $the_query -> the_post();              
    ?>

    <div class="post">
    <div class="post_title">
    <h3><a href="<?php the_permalink(); ?>"><?php the_title(); ?></a></h3>
    </div>
        <div class="entry"> 
            <?php the_post_thumbnail(); ?>
            <?php the_content('Read on...'); ?>

            <p class="postmetadata">
            <?php _e('Filed under&#58;'); ?> <?php the_category(', ') ?> <?php _e('by'); ?> <?php  the_author(); ?><br />
            <?php comments_popup_link('No Comments &#187;', '1 Comment &#187;', '% Comments &#187;'); ?> <?php edit_post_link('Edit', ' &#124; ', ''); ?>
            </p>
        </div>
    </div>

    <?php endwhile;?>
    <?php wp_reset_postdata();?>
    <div class="navigation">
    <div style="float:left;" class="alignleft"><?php previous_posts_link('&laquo; Previous Entries') ?></div>
    <div style="float:right;" class="alignright"><?php next_posts_link('Next Entries &raquo;',$the_query->max_num_pages) ?></div>
    </div>      
    </div>

    <div id="blogs">    
    <?php       
    $args = array(
    'category_name' => 'dogs' 
    );
    $paged = (get_query_var('paged')) ? get_query_var('paged') : 1;
    $the_query = new WP_query($args . '&paged=' . $paged . '&cat=-10');
    while( $the_query -> have_posts()) : $the_query -> the_post();              
    ?>

    <div class="post">
    <div class="post_title">
    <h3><a href="<?php the_permalink(); ?>"><?php the_title(); ?></a></h3>
    </div>
        <div class="entry"> 
            <?php the_post_thumbnail(); ?>
            <?php the_content('Read on...'); ?>

            <p class="postmetadata">
            <?php _e('Filed under&#58;'); ?> <?php the_category(', ') ?> <?php _e('by'); ?> <?php  the_author(); ?><br />
            <?php comments_popup_link('No Comments &#187;', '1 Comment &#187;', '% Comments &#187;'); ?> <?php edit_post_link('Edit', ' &#124; ', ''); ?>
            </p>

        </div>
    </div>

    <?php endwhile;?>
    <?php wp_reset_postdata();?>
    <div class="navigation">
    <div style="float:left;" class="alignleft"><?php previous_posts_link('&laquo; Previous Entries') ?></div>
    <div style="float:right;" class="alignright"><?php next_posts_link('Next Entries &raquo;',$the_query->max_num_pages) ?></div>
    </div>
    </div>
   <?php get_footer(); ?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T10:38:01.560

您需要 2 个不同的分页值，因此添加一些新的分页值并重写查找它们的规则（它们实际上只是为了使 url 看起来更整洁）。重写规则和分页链接格式意味着您可以分页浏览一个类别，而另一个类别页面不会更改。

在`functions.php`：

```
function add_new_rules()
{
  // new 'paged' variables
  global $wp;
  $wp->add_query_var('paged_cats');
  $wp->add_query_var('paged_dogs');

  // rewrite rules
  add_rewrite_rule('page/cats/(\d+)/dogs/(\d+)', 'index.php?paged_cats=$matches[1]&paged_dogs=$matches[2]', 'top');
  add_rewrite_rule('page/cats/(\d+)/dogs/?$', 'index.php?paged_cats=$matches[1]&paged_dogs=1', 'top');

  if( !array_key_exists('page/cats/(\d+)/dogs/(\d+)', (array)get_option('rewrite_rules')) )
  {
    global $wp_rewrite;
    $wp_rewrite->flush_rules();
  }
}
add_filter('init', 'add_new_rules'); 
```

检查新的查询变量`index.php`并将它们用于每个 WP_Query 和相关的分页链接。

```
<div id="blog">
  <?php
  $paged_cats = (get_query_var('paged_cats')) ? get_query_var('paged_cats') : 1;
  $paged_dogs = (get_query_var('paged_dogs')) ? get_query_var('paged_dogs') : 1;

  $cats = new WP_query(array(
    'category_name' => 'cats',
    'paged' => $paged_cats,
    'posts_per_page' => 1
  ));
  while( $cats->have_posts() ) : $cats->the_post();
    ?>
    <div class="post">
      <div class="post_title">
        <h3><a href="<?php the_permalink(); ?>"><?php the_title(); ?></a></h3>
      </div>
      <div class="entry">
        <?php the_post_thumbnail(); ?>
        <?php the_content('Read on...'); ?>
        <p class="postmetadata">
          <?php _e('Filed under&#58;'); ?> <?php the_category(', ') ?> <?php _e('by'); ?> <?php the_author(); ?><br />
          <?php comments_popup_link('No Comments &#187;', '1 Comment &#187;', '% Comments &#187;'); ?> <?php edit_post_link('Edit', ' &#124; ', ''); ?>
        </p>
      </div>
    </div>
  <?php endwhile; ?>
  <?php wp_reset_postdata(); ?>
  <?php if ( $cats->max_num_pages > 1 ) : ?>
  <div class="navigation">
    <?php
    echo paginate_links(array(
      'base' => home_url("page/cats/%#%/dogs/{$paged_dogs}"),
      'format' => '%#%',
      'current' => $paged_cats,
      'total' => $cats->max_num_pages,
    ));
    ?>
  </div>
  <?php endif; ?>
</div>

  <hr>

<div id="blogs">
  <?php
  $dogs = new WP_query(array(
    'category_name' => 'dogs',
    'paged' => $paged_dogs,
    'posts_per_page' => 1
  ));
  while( $dogs->have_posts() ) : $dogs->the_post();
    ?>
    <div class="post">
      <div class="post_title">
        <h3><a href="<?php the_permalink(); ?>"><?php the_title(); ?></a></h3>
      </div>
      <div class="entry">
        <?php the_post_thumbnail(); ?>
        <?php the_content('Read on...'); ?>
        <p class="postmetadata">
          <?php _e('Filed under&#58;'); ?> <?php the_category(', ') ?> <?php _e('by'); ?> <?php  the_author(); ?><br />
          <?php comments_popup_link('No Comments &#187;', '1 Comment &#187;', '% Comments &#187;'); ?> <?php edit_post_link('Edit', ' &#124; ', ''); ?>
        </p>
      </div>
    </div>
  <?php endwhile;?>
  <?php wp_reset_postdata();?>
  <?php if ( $dogs->max_num_pages > 1 ) : ?>
  <div class="navigation">
    <?php
    echo paginate_links(array(
      'base' => home_url("page/cats/{$paged_cats}/dogs/%_%"),
      'format' => '%#%',
      'current' => $paged_dogs,
      'total' => $dogs->max_num_pages,
    ));
    ?>
  </div>
  <?php endif; ?>
</div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T04:51:36.783

我在这里找到答案[https://wordpress.stackexchange.com/questions/47259/multiple-wp-query-loops-with-pagination](https://wordpress.stackexchange.com/questions/47259/multiple-wp-query-loops-with-pagination)，选择答案对我有用。它使用格式。

```
<!-- Cats -->
<div class="animals">
    <?php
        $paged1 = isset( $_GET['paged1'] ) ? (int) $_GET['paged1'] : 1;
        $paged2 = isset( $_GET['paged2'] ) ? (int) $_GET['paged2'] : 1;

        // Custom Loop with Pagination 1
        // http://codex.wordpress.org/Class_Reference/WP_Query#Usage
        $args1 = array(
            'paged'          => $paged1,
            'posts_per_page' => 2,
        );
        $query1 = new WP_Query( $args1 );

        while ( $query1->have_posts() ) : $query1->the_post();
            the_title();
            echo '<br>';
            the_category(' ');
            the_excerpt();
            echo '<hr>';
        endwhile;

        // http://codex.wordpress.org/Class_Reference/WP_Query#Pagination_Parameters
        $pag_args1 = array(
            'format'  => '?paged1=%#%',
            'current' => $paged1,
            'total'   => $query1->max_num_pages,
            'add_args' => array( 'paged2' => $paged2 )
        );
        echo paginate_links( $pag_args1 );
    ?>
</div>

<!-- Dogs -->
<div class="animals">
    <?php
        // Custom Loop with Pagination 2
        $args2 = array(
            'paged'          => $paged2,
            'posts_per_page' => 2,
        );
        $query2 = new WP_Query( $args2 );

        while ( $query2->have_posts() ) : $query2->the_post();
            the_title();
            echo '<br>';
            the_category(' ');
            the_excerpt();
            echo '<hr>';
        endwhile;

        $pag_args2 = array(
            'format'  => '?paged2=%#%',
            'current' => $paged2,
            'total'   => $query2->max_num_pages,
            'add_args' => array( 'paged1' => $paged1 )
        );
        echo paginate_links( $pag_args2 );
    ?>
</div> 
```

而且由于它正在生成一个不干净的 url，您可以添加一个 rel="nofollow" 用于 SEO 目的。[这是如何添加 rel="nofollow" 的说明](https://stackoverflow.com/questions/13853262/how-add-rel-no-follow-to-wordpress-paginate-links)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-13T22:43:14.630

您的问题是：在分页时，wordpress 发送页面 id 或计数以获取下一个条目，并且两个列表的回发变量的名称相同。当它进入服务器时，两个列表都会通过查看 post 变量来获得进入下一页的请求。

jho1086 提到的解决方案是创建分页变量作为两个列表的自定义变量并分配它。然后，这将为每个列表发送一个不同的变量，您可以根据需要移动下一个或上一个。

您需要同时添加一个分页变量并将其添加到您的分页中。在 jho1086 的解决方案中看到 $args1 和 $pag_args1 都引用了 $paged2 来实现这一点。

*   当您为猫选择第 2 页时，它应该向服务器发送 catpage=2
*   当您为 Docs 选择第 2 页时，它应该向服务器发送 dogpage=2

如果您可以为分页链接解决此问题并传递参数，那么您可以执行以下操作

*   当服务器获取猫列表时，使用 catpage 作为分页参数
*   当服务器获取狗列表时，使用 dogpage 作为分页参数

这是理论上的，肯定会奏效。您可以通过 firebug 测试进出请求的变量并返回您遇到的其他问题，但是您的循环转到第 2 页以单击一个的原因是两个循环都在同一个 post 变量上分页。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-07T13:33:19.713

[next_post_link()](http://codex.wordpress.org/Template_Tags/next_post_link)和 [previous_post_link()](http://codex.wordpress.org/Template_Tags/previous_post_link)函数有第三个参数称为`'in_same_cat'`- 您需要将其设置为 TRUE。阅读 codex 页面（单击答案中的函数名称。

来自法典：

```
<?php next_post_link('%link', 'Next post in category', TRUE); ?> 
```

他们甚至还有第四个参数`'excluded_categories'` ，您也可以使用它来实现相同的目标，或者将两者结合起来以获得更复杂的结果。

# php - 从循环、超文本 url 生成结果

> ID：13748716
> 
> 赞同：0
> 
> 时间：2012-12-06T17:01:32.830
> 
> 标签：php, mysql, url, while-loop

我正在呼应数据库涵盖的区域列表。该列表具有从数据库中获取的标题和子标题，

```
$area_shire = '';
$area_district = '';
$area_name = '';

while($rows = mysql_fetch_array($query)):

    if($rows['area_shire'] != $area_shire) {

        echo '<h1>'.$rows['area_shire'].'</h1>';
        $area_shire = $rows['area_shire'];
    }

    /* same for district using h2 and name using h3 */

endwhile; 
```

我现在想让每个结果都成为超文本 url，所以我添加了

```
$area_shire_url = str_replace(' ', '_', $area_shire);
$area_district_url = str_replace(' ', '_', $area_district);
$area_name_url = str_replace(' ', '_', $area_name); 
```

并将每个回声更改为

```
 echo '<a href=\"Tree_Surgery_'.$area_shire_url.'.php\"><h2>'.$rows['area_shire'].'<br></h2>';
$area_shire = $rows['area_shire'];}

  /* same for district using h2 and name using h3 */ 
```

这根本不起作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T17:04:34.523

`'<a href=\"Tr`

我认为你不需要逃避，`"`因为你没有`"`用来定义你的 php 语句。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T17:18:29.943

我会将片段重写为：

```
$area_shire = '';
$area_district = '';
$area_name = '';

while($rows = mysql_fetch_assoc($query)) {
    if ($rows['area_shire'] != $area_shire) {
        $area_shire = $rows['area_shire'];
        $area_shire_url = 'Tree_Surgery_'.str_replace(' ', '_', $area_shire).'.php';
        echo '<h2><a href="'.$area_shire_url.'">'.$area_shire.'</a></h2><br>';
    }

    // same for district using h2 and name using h3
} 
```

您的错误似乎是您`"`在单引号字符串中转义了 while。使用 时`'`，php 将按原样回显所有包含的字符；无需转义。

请注意，我还使用了[mysql_fetch_assoc](http://www.php.net/mysql_fetch_assoc)而不是[mysql_fetch_array](http://www.php.net/mysql_fetch_array)并重新排列了 HTML 标记的顺序，以避免将[*块级*元素](https://developer.mozilla.org/en-US/docs/HTML/Block-level_elements)嵌套在[*inline* elements](https://developer.mozilla.org/en-US/docs/HTML/Inline_elements)中。

我还选择将完整的 url 存储在一个变量中，而不是只存储它的一部分并在 echo 语句中将其组合成完整的 url。在我看来，这更容易阅读。特别是当您想稍后编辑内容时。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-06T17:15:02.710

您不需要转义双引号，因为文本不在双引号内。`}`您的代码末尾似乎也有一个，除非这不是所有代码，否则这不是必需的。

我没有看到这种格式或`while`循环，请尝试将其更改为：

```
while($rows = mysql_fetch_array($query)){
    // do stuff
} 
```

更重要的是，你还没有结束你的`a`标签。结束你的行`</a>`

# css - Ruby on Rails 图像显示

> ID：13748717
> 
> 赞同：0
> 
> 时间：2012-12-06T17:01:43.550
> 
> 标签：css, ruby-on-rails, image, web-applications

因此，我正在尝试创建一个网站，您可以在其中上传图像并查看它们。我完成了上传部分和部分显示部分，但我无法让它们一起显示。我在图像之间得到了不需要的空间。例如，现在我得到一行有 4 张图片，然后下一行只有 1 张图片（我无法上传屏幕截图，因为我没有足够的声望点，抱歉）。我已经尝试了我所知道的一切来填充可用空间但没有成功。我的显示视图代码是，

```
<%= render 'nav' %>
<div id = "jags_show">
<h1>Your Jags </h1>
<div id = "clear"></div>
<hr />
<% if @jags.empty? %>
<p> NO JAGS UPLOADED YET <p>
<% else %>
<% @jags.each do |j| %>
    <div id = "jags">
        <p id = "jagimage"><%= image_tag j.image_url(:thumb) %></p>
        <p id = "jagname"> <%= j.name %> </p>
        <div class="actions">
         <%= link_to "update", edit_jag_path(j) %> |
         <%= link_to "remove", j, :confirm => 'Are you sure?', :method => :delete %>
        </div>
    </div>
 <% end %>
  <% end %>
</div> 
```

我的 CSS 是

```
#jags{
display: inline;
float: left;
padding: 10px;
background-color: #222;
border: 2px solid white;
}
#jagname{
position: relative;
margin-left: 10px;
font-family: Helvetica; 
color:#c1f706;
font-size: 18px;
text-align: center;
}
#jagimage img{
border: 1.5px solid white;
}
#jags_show{
background-image:url('background.jpg');
margin-left: 80px;
margin-right: 40px;
margin-top: 80px;

}
#jags_show h1{
padding-top: 80px;
color: #434341;
font-family: Pilgi;
font-size: 35px;
background-color: #f0f0f0;
display:inline;
position: absolute;
margin-top:-100px;
}
#clear{
clear:both; 
}
.actions a{
color: #b3b2b1;
text-decoration: none;

}
.actions {
text-align: center;
padding: 0px;

} 
```

任何建议/建议将不胜感激。谢谢你。哦，如果有帮助的话，我正在使用 CarrierWave Gem。

所以我让我的代码在 jsfiddle 上运行，它在那里看起来很好，这让我认为我遇到的问题是由于图像的不同方向造成的。这是我的 jsfiddle 链接[http://jsfiddle.net/cVvYE/embedded/result/](http://jsfiddle.net/cVvYE/embedded/result/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T17:31:17.037

空格是由于`display: inline;`，HTML（或新行）中的任何空格都将显示为空格。尝试更改为`display: block`并在必要时浮动，这将删除间距。此外，您的图像也需要拥有`display: block;`，因为它们是`inline`默认设置的。

# jquery - 使用 jquery.data 的 jquery 插件模式

> ID：13748718
> 
> 赞同：0
> 
> 时间：2012-12-06T17:01:47.683
> 
> 标签：jquery

我在 jquery 插件模式中看到了这段代码，并且注释部分提到我们可以使用 jQuery.data 函数将插件附加到 DOM 元素。我不明白的是如何使用这段代码。有人可以提供如何使用此功能并解释其重要性的示例吗？

```
 $.fn[pluginName] = function (options) {
        return $Extend(this).each(function () {
            if (!$.data(this, 'plugin_' + pluginName)) {
                $.data(this, 'plugin_' + pluginName,
                new Plugin( this, options ));
            }
        });
    }; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T17:12:05.930

我认为您专门提供的代码的重点不允许重新初始化插件。

它所做的是，当您第一次在元素上调用插件时，它会检查它`data`以查看是否`'plugin_' + pluginName`已经设置了属性 。如果是这样，它不会做任何进一步的事情。如果尚未设置，则调用该`new Plugin()`方法并将其存储在其`data`. 这样，它很容易通过插件方法检索。所有方法要做的就是`$(this).data('plugin_' + pluginName)`检索关于插件的任何东西，特别是针对那个元素。

因此，如果您想进行 2 个插件调用，例如：

```
$(".class").specialPlugin({
    key1: "value1"
});

$(".class2").specialPlugin({
    key23: "value23"
}); 
```

然后每个元素的数据将只包含特定于其原始设置的信息。

实际存储在 中的`data`是`new Plugin`返回的内容，并且范围可以从许多事物的完整对象或只是原始`options`对象的任何地方，以便于参考。

# java - Java连接MySql中的PasswordFiled char []到String？

> ID：13748724
> 
> 赞同：0
> 
> 时间：2012-12-06T17:01:55.297
> 
> 标签：java

这是一个连接到数据库的 jFrame，它位于按钮连接中。我的问题在于密码字段 NetBeans 让我执行 char[]，但我的 .getConnection 不允许我插入 char[] 错误：“找不到适合 getConnection(String,String,char[]) 的方法”。所以我会改成String对吗？因此，当我更改并运行 jFrame 时说访问被拒绝。当我开始做 System.out.println(l) “给我正确的答案”就像这样：“Alex”。但是当我执行 System.out.println(password) “给我数组空间而不是值”时，像这样： jdbc:mysql://localhost/home inventory root [C@5be5ab68 <--- Array space 。我做错了什么？

```
 try {
    Class.forName("org.gjt.mm.mysql.Driver"); //Load the driver

    String host = "jdbc:mysql://"+tServerHost.getText()+"/"+tSchema.getText();

        String uName = tUsername.getText();
        char[] l =  pPassword.getPassword();
        System.out.println(l);
        String password= l.toString();

        System.out.println(host+uName+password);
        con = DriverManager.getConnection(host, uName, password);
        System.out.println(host+uName+password);
    } catch (SQLException | ClassNotFoundException ex) {

    JOptionPane.showMessageDialog(this, ex.getMessage());
    } 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T17:05:07.587

要将 char[] 转换为字符串，只需创建一个新字符串，并将 char[] 作为参数传递给构造函数。[新字符串（字符 []）](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#String%28char%5B%5D%29)

```
char[] l = pPassword.getPassword();
String s = new String(l);
System.out.println(s); 
```

# xml - 检查 XML 节点是否为空

> ID：13748725
> 
> 赞同：0
> 
> 时间：2012-12-06T17:01:57.717
> 
> 标签：xml, xslt, xpath

我有一个简单的 XML 结构，例如

```
<main>
<node1><!-- comments --><!-- comments --></node1>
</main> 
```

这可以有任意数量的子节点或值，例如：

```
 <main>
    <node1><!-- comments --><!-- comments --><p>texttext text</p> 
more text <br/></node1>
    </main> 
```

我想检查节点`<node1>`是否为空：
*条件*：节点中仍然可以有注释，它应该仍然被标记为空我正在做类似的事情：

```
<xsl:if test="string-length(main/node1//text())&gt;0"> 
```

但是如果有多个标签它不起作用`<p>`，那么 string-length 函数会因为多个参数而中断。

非常感谢解决此问题的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T17:16:59.747

`<xsl:template match="main/node1[* | text()[normalize-space()]">`匹配那些`node1`至少有一个元素子节点或一个文本子节点且内容不是空白的元素。因此，条件`node1[* | text()[normalize-space()]`可能是您正在寻找的，因为它忽略了注释节点（和处理指令节点）。

# .net - .NET 正则表达式不起作用 - 1# 检查输入的文本的开头 #2 检查结构

> ID：13748726
> 
> 赞同：0
> 
> 时间：2012-12-06T17:02:03.177
> 
> 标签：.net, regex

好吧，不幸的是，自从我使用 REGEX 以来已经有一段时间了，我正在努力想知道为什么它不能与我的项目一起使用。

我使用了 Regex Tester，它说我的两个测试是有效的，但是在我的项目中进行测试时，它们被拒绝了。

1）检查文本以某些字符开头

```
[RegularExpression("(spAPP)",ErrorMessage = "Stored procedures must begin with spAPP")] 
```

这似乎自己接受 spAPP，但不是我想要的 spAPPabcdef 之类的东西。我正在努力使用 REGEX 找到“忽略其余文本”属性。

2）有点复杂。我对 AD 组有一定的命名约定，所以一个例子是“UK ROLE IT APPLICATION DEV ADMIN”，直到角色名称都有标准（所以我需要检查“UK ROLE IT APPLICATION DEV”。

```
[RegularExpression(@"((UK|FRANCE|GERMANY|USA)\s(ROLE)\s(IT|NON-IT)\s(APPLICATION)\s(DEV|TEST|LIVE))", ErrorMessage = "Please use AD naming standards.")] 
```

我认为这可能是因为我在所有单词周围都使用了 ()，但在我的代码中更容易阅读。我发现的 RegexTester 似乎表明它是正确的，但是在我的 .NET 项目中，它再次拒绝它。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T17:11:45.580

1.  `^spAPP.*$`
2.  `^((UK|FRANCE|GERMANY|USA)\s(ROLE)\s(IT|NON-IT)\s(APPLICATION)\s(DEV|TEST|LIVE)).*$`

后面的 JavaScript 实现`RegularExpressionAttribute`需要指定`^`-string 开始和`$`-string 结束。

见：[http ://blog.regexhero.net/2012/09/aspnet-mvc-dataannotations-and.html](http://blog.regexhero.net/2012/09/aspnet-mvc-dataannotations-and.html)

# facebook - Facebook 错误：“客户端令牌不能用于此 API” - 适用于 DEV 和 STAGE 但不适用于 LIVE 应用程序？

> ID：13748728
> 
> 赞同：2
> 
> 时间：2012-12-06T17:02:06.220
> 
> 标签：facebook, token

我已经构建了一个通知发送系统，它使用应用访问令牌向我们应用的所有用户发送通知。该系统当前在我的本地主机上运行。当我为我的开发和舞台环境使用 appid 和 appsecret 配置它时，它工作正常。但是当我输入 LIVE 应用程序的 appid 和 appsecret 时，我得到了这个错误：

{"message":"客户端令牌不能用于此 API", "type":"OAuthException", "code":190}

那么 dev 和 live 有什么不同呢？Dev 和 Stage 处于沙盒模式，Live 不是。所以我尝试在 Dev/Stage 上禁用沙盒模式，它们继续正常运行。Dev 工作正常，Stage 工作正常，Live 给出这个错误。除了 appid、appsecret 和 redirect_uri（更改它以匹配每个环境的域）之外，所有其他代码都是相同的。

我已经检查了[这篇](https://stackoverflow.com/questions/13188571/error-the-client-token-cannot-be-used-for-this-api)文章，但不幸的是，在一个拥有 1,000,000 名用户的网站上重置我们的 appsecret 不是我们目前可以做的（太多其他功能依赖它）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T19:11:06.883

您需要重置客户端令牌，而不是应用程序机密 - 错误消息意味着在某些时候您的应用程序在“应用程序类型”下设置为“桌面/本机”（而不是“网络”） -

以前，这意味着您的应用访问令牌嵌入在您的客户端代码中，因此在发出应用签名请求时不受信任。

如果您的客户端令牌与应用程序密码相同（如果您从未更改过它），Facebook 仍然认为它是不安全的信任；您需要更改高级设置下的客户端令牌，安全性：

![在此处输入图像描述](../Images/ce3cd3ceadac62abca6f4e916c4e8818.png)

# php - 在 PHPUnit_Extensions_Selenium2TestCase 中处理 HTTP 状态码

> ID：13748729
> 
> 赞同：2
> 
> 时间：2012-12-06T17:02:08.413
> 
> 标签：php, selenium, phpunit

我正在为一个开源项目运行一系列测试，我想获取 curl 请求的状态代码，以确定代码更改破坏功能与代码更改破坏网站的区别完全地。

```
 class ExampleTest extends PHPUnit_Extensions_Selenium2TestCase
    {
        public function setUp()
        {
            $this->setBrowser('firefox');
            $this->setBrowserUrl('http://localhost');
        }

        public function testForError()
        {
            $this->url('/');
            $this->assertNotEmpty($this->title());
        }
    } 
```

这是我现在如何做的一个例子，但我想知道一些具体的信息。由于无法从 CURL 请求中获取信息，我真的不知道该怎么做……

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-14T21:44:05.940

显然这是不可能的，我在 Github 上与该项目的维护者进行了交谈，我要求的是一些不可能的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-13T17:36:39.520

这有助于我解决类似的问题（当您满意地从 curl 请求中获取信息时）：

```
// inside phpunit test
$url = ''; //your http://url.string.here
$request = curl_init($url);
$result = curl_exec($request);
$status = curl_getinfo($request, CURLINFO_HTTP_CODE);
curl_close($request);
$this->assertTrue($status == 200); 
```

# windows-phone-7 - 如何更新屏幕外枢轴项目

> ID：13748735
> 
> 赞同：0
> 
> 时间：2012-12-06T17:02:26.490
> 
> 标签：windows-phone-7, binding, pivot, pivotitem

我想与许多`PivotItems`. 但是，这样做会影响内存。所以我将 pivot 绑定到我的 ViewModel，它有 3 个 item，pivot 将生成 3 `PivotItems`。

我的 ViewModel 是类型`ObservableCollection`，我的项目确实实现了`INotifyPropertyChanged`. 这工作正常。但是当我更新我的 ViewModel 时，只有 current`PivotItem`和 right`PivotItem`被更新。离开`PivotItem`屏幕的左侧未更新。当您将枢轴拖动到左侧时，您可以看到它。

如何解决这个问题？还是 WP7 不更新屏幕`PivotItem`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T17:29:05.440

这是枢轴和全景之间的主要区别之一：

全景在加载时加载所有项目，但在您选择枢轴项目时进行枢轴

# iphone - 按下时获取选定的 UITableViewCell

> ID：13748747
> 
> 赞同：1
> 
> 时间：2012-12-06T17:03:27.650
> 
> 标签：iphone, objective-c, uitableview, touch

我需要获取当前选择的 UITableViewCell 作为它的点击。因此，当我的手指触摸屏幕/单元格时，我想运行一个方法，我可以从中说一些简单的话：

```
selectedCell = cell; 
```

`cell`作为我刚刚点击的那个并且`selectedCell`是我存储的副本。

我正在使用自定义子类 UITableViewCell 这就是为什么我认为我遇到了麻烦。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-15T16:10:57.493

只需像这样在您自己的自定义 tableview 单元格上实现 setHighlighted:animated: 方法。

```
- (void)setHighlighted:(BOOL)highlighted animated:(BOOL)animated {
    [super setHighlighted:highlighted animated:animated];

    NSLog (@"setHighlighted:%@ animated:%@", (highlighted?@"YES":@"NO"), (animated?@"YES":@"NO"));
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T17:07:27.693

**TouchDown**
- setSelected:animated: 在这里触地时调用单元格本身，您可以通知单元格委托

```
- (void)setSelected:(BOOL)selected animated:(BOOL)animated {
   [self.delegate willSelectCell:self];
} 
```

将自定义单元格委托声明为单元格的属性

```
@property id<MyCellDelegate> delegate; 
```

**TouchUP**
将单元格保存在委托中

```
- (void)tableView:(UITableView *)aTableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
_selectedCell = [aTableView cellForRowAtIndexPath:indexPath];
} 
```

只需注意 Cell Views 可以重用的事实

# javascript - 点击点击“地图数据”

> ID：13748751
> 
> 赞同：0
> 
> 时间：2012-12-06T17:03:50.303
> 
> 标签：javascript, google-maps, google-maps-api-3

我需要知道何时单击 Map Data 链接（见图 1，右下角）。当地图数据窗口打开时，它被覆盖的元素隐藏（图 2）。所以我必须在收到打开窗口的触发器时隐藏它们，并在关闭时重新显示它们。

我试图捕捉地图画布下的所有点击事件，如下所示，但是当我点击“地图数据”时我没有被触发

```
$("googleMapCanvas a").click(function() {
        alert("link under map clicked");
        }); 
```

有任何想法吗？

图 1

![图 1](../Images/90cbd020c420ac9f041017fdc2289a88.png)

图 2

![图 2](../Images/182acee0747313716f04ab9eb631ab15.png)

## **更新**

这是克里斯蒂安回答后我的功能代码

```
<div id="googleMapCanvas">
</div>

<div id="currentLocationBubbleContainer">
    ... 
</div>

<script>
$("#googleMapCanvas").on('click', 'a', function(event) {

     var host = event.target.host;      
     var isGoogleExternalLink = false;

     if (host != null && host.search(".google.") != -1 ){
             isGoogleExternalLink = true;
     }

     //It's not enough to check the innerHTML because it's content varies 
     //depending on the device langage, so in stead I check if it is not 
     //a click on the google logo, or on the terms of use which are external links
     if (event.target.innerHTML == "Map Data" || ! isGoogleExternalLink ){
             hideCurrentLocationBubble();
     }
     });

     //Close button of Map Data window
     $("#googleMapCanvas").on('click', 'img', function(event) {

         if (event.target.src == "https://maps.gstatic.com/mapfiles/transparent.png"){
             showCurrentLocationBubble();
         }
     });
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T17:06:46.930

你在哪里绑定那个`.click()`事件？默认情况下不会被委托，因此如果在调用代码时映射不存在，则不会绑定该事件。尝试`.on()`改用：

```
$("googleMapCanvas").on('click', 'a', function() {
    alert("link under map clicked");
}); 
```

# debugging - 如何在存储过程上获得绿色错误（调试）图标？

> ID：13748759
> 
> 赞同：3
> 
> 时间：2012-12-06T17:04:14.887
> 
> 标签：debugging, oracle10g, toad

我的系统上安装了 Oracle 10.5。

我使用 Toad 创建了一个存储过程。它正在成功运行。

我观察到 Toad 中的存储过程有不同的图标：

1.  红十字会（程序错误）
2.  白色矩形（新程序）
3.  绿虫（调试过程）

我的程序有*白色矩形*图标。我想把它改成*绿色的虫子*图标。

我在网上发现我必须在调试模式下运行存储过程。我运行了它，但它没有改变图标。

如何获得存储过程的*绿色错误图标？*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T20:45:54.787

*绿色*的bug表示存储过程（或包）是用调试信息编译的，可以调试。为了创建必要的调试信息，您需要（重新）编译您的存储过程

```
alter procedure PROCNAME compile debug; 
```

替换`PROCNAME`为存储过程的实际名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-21T09:23:43.267

使用**Schema Browser**时，您可以右键单击您的过程并从上下文菜单中选择**“Compile with Debug” 。**

![过程上下文菜单插图](../Images/132ef66a3f6d2b1618dcf9f013927633.png)

对于包，上下文菜单项是**"Compile" > "Compile with Debug"**。

![包上下文菜单插图](../Images/5d904e29b7c12da9aa5ac39e1a761245.png)

如果打开一个对话框要求选择*Refresh Mode*，您可以保留默认选项**“Refresh items one by one”**，除非另有要求。

# eclipse - 在eclipse中禁用语法高亮

> ID：13748762
> 
> 赞同：3
> 
> 时间：2012-12-06T17:04:38.587
> 
> 标签：eclipse, syntax-highlighting, eclipse-cdt

我想关闭 Eclipse 中的语法高亮显示（CDT，如果它是哑光的话）。

我尝试了 Window->Preferences->C/C++->Editor->Syntax Coloring 并未选中“启用语义突出显示”我还尝试了 Window->Preferences->C/C++->Scalability->Disable syntax coloring in editor。也没有为我做任何事情。

如何在 Eclipse 的文本编辑器中为 .c 和 .h 文件获取常规的黑白文本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T17:17:58.697

您可以使用 Eclipse 文本编辑器打开文件（没有语法突出显示没有完成，等等......）：

*   您可以在 Eclipse 首选项中更改默认文件关联（常规 -> Q 编辑器 -> 文件关联）
*   您可以通过文件“使用 -> 文本编辑器打开”的上下文菜单使用文本编辑器打开文件。Eclipse 将记住您的选择，并在您下次打开此文件时使用文本编辑器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-28T13:30:53.957

当我按照以下步骤操作时，可扩展性模式适用于我（在 Eclipse CDT Luna 上）：

1.  选择 Window->Preferences->C/C++->Scalability->Disable syntax coloring in editor
2.  将 Window->Preferences->C/C++->Scalability->“当文件中的行数超过时进入可伸缩模式”设置为较低的值（例如 10）
3.  关闭文件并重新打开它。

# performance - Grails 分批休眠会话

> ID：13748764
> 
> 赞同：5
> 
> 时间：2012-12-06T17:04:42.980
> 
> 标签：performance, hibernate, grails, grails-orm

只要没有超过 10.000 个对象的批次，GORM 开箱即用就可以正常工作。如果不进行优化，您将面临 outOfMemory 问题。

常见的解决方案是对每个 n (egn=500) 个对象刷新() 和 clear() 会话：

```
Session session = sessionFactory.currentSession
Transaction tx = session.beginTransaction();
def propertyInstanceMap = org.codehaus.groovy.grails.plugins.DomainClassGrailsPlugin.PROPERTY_INSTANCE_MAP

Date yesterday = new Date() - 1

Criteria c = session.createCriteria(Foo.class)
c.add(Restrictions.lt('lastUpdated',yesterday))
ScrollableResults rawObjects = c.scroll(ScrollMode.FORWARD_ONLY)

int count=0;
while ( rawObjects.next() ) {
    def rawOject = rawObjects.get(0);

    fooService.doSomething()

    int batchSize = 500
    if ( ++count % batchSize == 0 ) {
        //flush a batch of updates and release memory:
        try{
            session.flush();
        }catch(Exception e){
            log.error(session)
            log.error(" error: " + e.message)
            throw e
        }
        session.clear();
        propertyInstanceMap.get().clear()
    }
}

session.flush()
session.clear()
tx.commit() 
```

但是有一些我无法解决的问题：

1.  如果我使用 currentSession，那么控制器会因为会话为空而失败
2.  如果我使用 sessionFactory.openSession()，那么 currentSession 仍然在 FooService 中使用。当然，我可以使用 session.save(object) 表示法。但这意味着，我必须修改 fooService.doSomething() 并为单个操作（常见的 grails 表示法，如 fooObject.save() ）和批处理操作（session.save(fooObject() ).. 表示法）修改代码。
3.  如果我使用 Foo.withSession{session->} 或 Foo.withNewSession{session->}，那么 Foo 类的对象会按预期由 session.clear() 清除。所有其他对象都没有清除（），这会导致内存泄漏。
4.  当然，我可以使用 evict(object) 手动清除会话。但是由于关联的自动获取，几乎不可能获取所有相关对象。

所以我不知道如何在不使 FooService.doSomething() 更复杂的情况下解决我的问题。我正在为所有域寻找类似 withSession{} 的东西。或者在开始时保存会话（Session tmp = currentSession）并执行类似 sessionFactory.setCurrentSession(tmp) 的操作。两者都不存在！

任何想法都是受欢迎的！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-09-30T10:02:08.130

我建议对这种批处理使用无状态会话。请参阅这篇文章：[使用 StatelessSession 进行批处理](https://stackoverflow.com/questions/14174271/using-statelesssession-for-batch-processing)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-02-21T23:15:47.467

修改后的方法是：

1.  循环遍历整个集合 ( `rawObjects`) 并保存这些对象的所有 id 列表。
2.  循环遍历 id 列表。在每次迭代中，仅通过其 id 查找单个对象。

然后像现在一样使用相同的定期清除会话缓存。

顺便说一句，[其他人提出了与您类似的方法](http://www.tothenew.com/blog/batch-processing-in-grails/)。但请注意，此链接中的代码不正确；清除会话的行应该在 if 语句中，就像您在解决方案中一样。

# jquery - 调用多个显示模式reveal.js

> ID：13748765
> 
> 赞同：2
> 
> 时间：2012-12-06T17:04:48.960
> 
> 标签：jquery, jquery-plugins, reveal.js

我需要在同一页面上有多个模式窗口。基本上我打算有一个链接到每个团队成员，然后单击时会在模式框中弹出打开他们的详细信息。我正在使用 zurb 的揭示插件。这是网站上的示例。

html:

```
<div id="myModal" class="reveal-modal">
     <h1>Modal Title</h1>
     <p>Any content could go in here.</p>
     <a class="close-reveal-modal">&#215;</a>
</div> 
```

js

```
$('#myButton').click(function(e) {
          e.preventDefault();
      $('#myModal').reveal();
     }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-27T16:23:25.397

我*只是*做了这件事。我预计它会比实际复杂得多，所以我一直在错误的地方寻找。这一切都在 HTML 中处理！

首先，复制您在上面发布的代码以创建尽可能多的模式，使“div id”对每个模式都是唯一的（按照上面的示例）：

```
<div id="JOE" class="reveal-modal">
     <h1>Modal Title</h1>
     <p>Any content could go in here.</p>
     <a class="close-reveal-modal">&#215;</a>
</div>

<div id="MARY" class="reveal-modal">
     <h1>Modal Title</h1>
     <p>Any content could go in here.</p>
     <a class="close-reveal-modal">&#215;</a>
</div>

<div id="ANN" class="reveal-modal">
     <h1>Modal Title</h1>
     <p>Any content could go in here.</p>
     <a class="close-reveal-modal">&#215;</a>
</div> 
```

接下来，您要做的就是创建相应的链接来启动每个链接，使其唯一的“data-reveal-id”值与您在上面创建的 ID 匹配，并将它们放置在布局中您需要的任何位置：

```
<a href="#" data-reveal-id="JOE" data-animation="fade">JOE</a>
<a href="#" data-reveal-id="MARY" data-animation="fade">MARY</a>
<a href="#" data-reveal-id="ANN" data-animation="fade">ANN</a> 
```

每个链接只会触发具有匹配 id 标签的模式。

就像我说的，比我预期的要容易得多。:)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-27T04:45:48.737

试试这个插件的多个窗口。最小化、最大化、移动、关闭、覆盖、菜单等：

[http://des.deletesoft.com:8080/?go=3](http://des.delestesoft.com:8080/?go=3)

# version-control - Hg postreview 与私人父母

> ID：13748766
> 
> 赞同：0
> 
> 时间：2012-12-06T17:04:49.583
> 
> 标签：version-control, mercurial, review-board

我有这样的变更集：

```
A --> B --> C --> D 
```

A 是公共提示。D 是我要发布以供审查的变更集。阅读后：[http://www.reviewboard.org/docs/manual/dev/users/tools/post-review/#distributed-version-control-systems](http://www.reviewboard.org/docs/manual/dev/users/tools/post-review/#distributed-version-control-systems)，我希望这可以工作：

```
hg postreview tip --parent=-2 
```

或者

```
hg postreview tip --parent=C 
```

但上述任何一个似乎都不起作用。我收到此错误：

```
abort: The file was not found in the repository or parent revisionhas not been made public (207) 
```

我怎样才能做到这一点？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T08:26:39.230

看起来审查委员会希望您仅**根据不可变的历史**提交审查变更集。

这意味着`D`必须基于`A`您是否希望它可以在没有`B`or的情况下提交`C`。

这可以使用与 Mercurial 捆绑的[rebase 扩展来实现。](http://mercurial.selenic.com/wiki/RebaseExtension)

> hg rebase --dest A --source D

# javascript - 在 Riak 中使用二级索引作为 map reduce 函数的输入

> ID：13748767
> 
> 赞同：1
> 
> 时间：2012-12-06T17:04:54.670
> 
> 标签：javascript, mapreduce, riak

有谁知道在使用二级索引查询的输出时，在使用 Riak 中的 HTTP API 的 map reduce 中“输入”项将采用什么形式？Riak 网站声明“如果您启用了二级索引，则输入列表也可以引用二级索引查询”，但从未解释将采用何种形式。

由于大多数 map reduce 查询的输入格式是 "input" : ["bucket", "key", "keydata"] 'curl riakhost:port/buckets/bucketname/index/indexname_bin/indexvalue' 的等价物是什么？

一个链接或一些信息会很有用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-06T20:12:51.707

```
"inputs":{"index":"INDEX_NAME_bin","bucket":"BUCKET","key":"INDEX_VALUE"} 
```

二级索引的“示例”部分展示了如何使用精确匹配以及范围查询作为 mapreduce 的输入：

[http://docs.basho.com/riak/1.2.1/tutorials/Secondary-Indexes---Examples/#Exact-Match-Query](http://docs.basho.com/riak/1.2.1/tutorials/Secondary-Indexes---Examples/#Exact-Match-Query)

[http://docs.basho.com/riak/1.2.1/tutorials/Secondary-Indexes---Examples/#Range-Query](http://docs.basho.com/riak/1.2.1/tutorials/Secondary-Indexes---Examples/#Range-Query)

# c++ - 将 GCC IR 转换为 LLVM IR

> ID：13748768
> 
> 赞同：8
> 
> 时间：2012-12-06T17:04:58.037
> 
> 标签：c++, c, gcc, llvm

我编写了一个修改中间表示 (IR) 代码的 LLVM 通行证。为了增加可移植性，我还希望它与 gcc 编译器一起工作。所以我想知道是否有任何工具可以将 gcc 的一些中间表示（IR）转换为 LLVM IR。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-06T17:07:34.013

您可能需要[Dragonegg](http://dragonegg.llvm.org/)（它使用 GCC 前端来构建 LLVM IR）。

如果您想处理 GCC 内部表示，[MELT](http://gcc-melt.org/)（一种用于扩展 GCC 的高级域特定语言）可能是正确的工具。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-06T17:33:56.883

简单地编写与 gcc IR 一起使用的另一个版本的代码可能会容易*得多。*你想做的事情可能是不可能的，如果可能的话，它可能非常困难。（比一开始就编写 LLVM 通道更重要。）

# powershell - 通过 nant 运行时，Powershell 脚本失败

> ID：13748769
> 
> 赞同：3
> 
> 时间：2012-12-06T17:04:58.837
> 
> 标签：powershell, nant, executionpolicy

我有几个团队成员无法通过 nant 运行 powershell 脚本。当他们这样做时，他们得到`ExectutionPolicy`（不够高，仍然设置为默认值）。但是，它们 `Set-ExecutionPolicy RemoteSigned`在 powershell 控制台中运行，并且可以直接运行 powershell 脚本。关于出了什么问题的任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-06T17:21:32.660

如果他们在 64 位机器上运行，他们是否为 32 位和 64 位 PowerShell 设置了执行策略？可能是他们为 64 位 PowerShell 设置了策略，而 NAnt 正在启动 32 位 PowerShell（反之亦然）。如果您至少使用 PowerShell 2.0，另一种解决此问题的方法是在调用 PowerShell 时设置策略，例如：

```
PowerShell.exe -ExecutionPolicy RemoteSigned ... 
```

# javascript - 使用 JavaScript 进行电子邮件验证

> ID：13748770
> 
> 赞同：5
> 
> 时间：2012-12-06T17:05:05.980
> 
> 标签：javascript

> **可能重复：**
> [在 Javascript 中验证电子邮件地址？](https://stackoverflow.com/questions/46155/validate-email-address-in-javascript)

这是我的第一篇文章，我有一个小问题。我正在尝试验证表单上的电子邮件地址，但没有运气。我在互联网上找到了这个片段，但它似乎不起作用。我目前正在使用 Javascript 来验证它。我通常不使用 JS，所以任何帮助将不胜感激。

```
<script type="text/javascript">
    function ValidateEmail(inputText)  
    {  
       var mailformat = /^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/;  
       if(inputText.value.match(mailformat))  
       {  
           document.forms.emailform();  
           return true;  
       }  
       else  
       {  
           alert("You have entered an invalid email address!");  
           document.forms.emailform();  
           return false;  
       }  
    } 
```

```
<?php
    $addemail .= '

        <form method="post" action="cart2.php" name="emailform" onsubmit="return validateEmail">
        ';
    $addemail .= '
            E-mail Address: <input type="text" name="email" value="'.$row6['email'].'" size="19" /><input type="hidden" name="cartid" value="'.$cart.'" />';
        if ( $emailerror != '' )
            {
                $addemail .= '<img src="images/email_error.png" width="16" height="16" hspace="4" alt="E-mail Error" />';
            }
        $addemail .= '
            <input type="image" name="Add E-mail Address" alt="Add E-mail Address" src="images/addemail.gif" style="vertical-align:middle" />
        </form>
    ';
    if ( $row6['email'] == '' )
        {
            $emailpresent = 0;
        }
    else
        {
            $emailpresent = 1;
        }
}
        $addemail .= '
                </td>
            </tr>
        ';
}

?> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-06T17:40:31.543

看看这个如何在 Javascript 中完成的例子：

```
<html>

<head>
<script type="text/javascript">
<!--
function validateEmail() {
    var emailText = document.getElementById('email').value;
    var pattern = /^[a-zA-Z0-9\-_]+(\.[a-zA-Z0-9\-_]+)*@[a-z0-9]+(\-[a-z0-9]+)*(\.[a-z0-9]+(\-[a-z0-9]+)*)*\.[a-z]{2,4}$/;
    if (pattern.test(emailText)) {
        return true;
    } else {
        alert('Bad email address: ' + emailText);
        return false;
    }
}

window.onload = function() {
    document.getElementById('email_form').onsubmit = validateEmail;
}
</script>

</head>
<body>

<form id="email_form">
<input type="text" id="email">
<input type="submit">
</form>

</body>
</html> 
```

**编辑：**

如果您确定您的网页的用户正在使用与*HTML5*兼容的浏览器，您可以使用以下更简洁的示例来实现相同的目的：

```
<!DOCTYPE html>

<html>
    <body>
        <form>
            <input type="email" pattern="^[a-zA-Z0-9\-_]+(\.[a-zA-Z0-9\-_]+)*@[a-z0-9]+(\-[a-z0-9]+)*(\.[a-z0-9]+(\-[a-z0-9]+)*)*\.[a-z]{2,4}$">
            <input type="submit">
        </form>
    </body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T17:08:21.860

```
onsubmit="return validateEmail()" 
```

您必须在 validateEmail 之后添加括号才能调用它，否则它将假定您正在尝试返回一个方法。

# mysql - MYSQL 中删除的触发器

> ID：13748773
> 
> 赞同：1
> 
> 时间：2012-12-06T17:05:09.937
> 
> 标签：mysql

我在另一个威胁中发布了这段代码，但这个问题略有不同。我必须做一个触发器。这个问题听起来像这样：

> “创建一个触发器，在删除有关何时和谁生产产品的信息时删除未使用的季节（即，每当从“生产”表中删除记录时，检查是否还有其他有关同一季节生产的产品的记录, 如果没有, 从季节表中删除相应的记录)"

我的MYSQL代码：

MYSQL 代码在这里：

```
CREATE TABLE IF NOT EXISTS Dvds(
Serial integer NOT NULL,
Name varchar(50),
Year integer,
Genre varchar(50),
Price integer,
PRIMARY KEY (Serial));

CREATE TABLE IF NOT EXISTS Shops(
Id integer NOT NULL,
Name varchar(50),
Address varchar(50),
PRIMARY KEY (Id));

CREATE TABLE IF NOT EXISTS Customers(
CNo integer NOT NULL,
AccNo integer,
Time varchar(50),
PRIMARY KEY (CNo));

CREATE TABLE IF NOT EXISTS ContactPersons(
Id integer NOT NULL,
Name varchar(50),
Phone integer,
PRIMARY KEY (Id));

CREATE TABLE IF NOT EXISTS Seasons(
StartDate date NOT NULL,
EndDate date NOT NULL,
PRIMARY KEY (StartDate,EndDate));

CREATE TABLE IF NOT EXISTS WebShops(
Id integer NOT NULL,
Url varchar(50),
FOREIGN KEY (Id) REFERENCES Shops (Id),
PRIMARY KEY (Id));

CREATE TABLE IF NOT EXISTS Producer(
Id integer NOT NULL,
Address varchar(50),
Name varchar(50),
PRIMARY KEY (Id));

CREATE TABLE IF NOT EXISTS Sold(
Id integer NOT NULL,
CNo integer NOT NULL,
Serial integer NOT NULL,
FOREIGN KEY (Id) REFERENCES Shops (Id),
FOREIGN KEY (CNo) REFERENCES Customers (CNo),
FOREIGN KEY (Serial) REFERENCES Dvds (Serial),
PRIMARY KEY (Id,CNo,Serial));

CREATE TABLE IF NOT EXISTS Has(
Id integer NOT NULL,
Serial integer NOT NULL,
FOREIGN KEY (Id) REFERENCES Shops (Id),
FOREIGN KEY (Serial) REFERENCES Dvds (Serial),
PRIMARY KEY (Id,Serial));

CREATE TABLE IF NOT EXISTS Has2(
Serial integer NOT NULL,
Producer_Id integer NOT NULL,
StartDate date NOT NULL,
EndDate date NOT NULL,
ContactPersons_Id integer NOT NULL,
FOREIGN KEY (Serial) REFERENCES Dvds (Serial),
FOREIGN KEY ( Producer_Id) REFERENCES Producer (Id),
FOREIGN KEY (StartDate) REFERENCES Seasons (StartDate),
FOREIGN KEY (EndDate) REFERENCES Seasons (EndDate),
FOREIGN KEY (ContactPersons_Id) REFERENCES ContactPersons (Id),
PRIMARY KEY (Serial,Producer_Id,StartDate,EndDate,ContactPersons_Id)); 
```

触发：

```
CREATE TRIGGER `Seasons_before_delete` 
    AFTER DELETE ON `Seasons`
    FOR EACH ROW 
    BEGIN
    DELETE FROM seasonstart
    WHERE seasonstart.???????
    DELETE FROM seasonend
    WHERE seasonend.??????
    END 
```

但我真的不知道。我的老师告诉我，我可以使用`IF`, `ELSEIF`, `GOTOEND`? 但我在正确的轨道上吗？我现在真的很空白该怎么办，所以希望有人有建议，我能做些什么来解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T17:37:19.217

在触发器中，您有 2 个虚拟表。

`NEW`和`OLD`。

显然在`create`触发器中没有`old`，在`delete`触发器中没有`new`。因此，如果您想使用发生更改的表（触发器附加到的表）的数据，您可以使用这两个表。

因为这是一个`delete`触发器，所以您需要使用该`old`表。

所以你的触发器看起来像这样：

```
CREATE TRIGGER `Seasons_before_delete` AFTER DELETE ON `Seasons`
FOR EACH ROW 
BEGIN
  DELETE FROM seasonstart
  WHERE seasonstart.seasonID = old.ID

  DELETE FROM seasonend
  WHERE seasonend.seasonID = old.ID
END 
```

请注意，调用`AFTER DELETE`触发器“something_something_BEFORE”是没有意义的 :-)。

进一步注意，我不知道为什么你需要`IF`在这个触发器中，`where`在 delete 语句中已经解决了这个问题。

# excel - 在 Excel 宏中创建 CSE 数组公式

> ID：13748780
> 
> 赞同：0
> 
> 时间：2012-12-06T17:05:58.393
> 
> 标签：excel, vba

我最近开始学习在 Excel 中创建 VBA 宏，但是，我完全不知道如何在我的宏中创建 CSE 数组公式

我想将变量定义为工作表中 A 列中的值 = 值 1 和 B 列 = 值 2 的行

在 excel 本身中，以下公式完美运行： `{=Match(1,(A:A=1)*(B:B=2),0)}`

但是，我现在想在我的宏中使用它： `variable = {=Match(1,(Sheets("Right Sheet").range("A:A")=value1)*(Sheets("Right Sheet").range("B:B")=value2),0)}`

任何人都可以对此提供任何启示？我玩过各种变种，`ArrayFormula`但完全没有成功！理想情况下，我希望我的`value1`和`value2`数字等于之前在我的宏中定义的变量（1 和 2）

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T18:49:23.380

这（例如）对我有用：

```
Debug.Print Application.Evaluate("SUM(A1:A5*B1:B5)") 
```

您需要将公式构建成一个字符串，并去掉“=”和“{}”。

```
Debug.Print Application.Evaluate("Match(1,(Sheet1!A:A=" & val1 & _
                                  ")*(Sheet1!B:B=" & val2 & "),0)") 
```

# c# - 如何从 BitmapImage 中获取数组 System.Windows.Media.Color？

> ID：13748781
> 
> 赞同：0
> 
> 时间：2012-12-06T17:05:57.380
> 
> 标签：c#, wpf, image, filestream

我正在开发一个编辑图标的项目，我需要加载一个图标。我使用以下代码保存此图标：

```
 var sd = new SaveFileDialog();
        sd.ShowDialog();
        sd.Filter = "File *.ico|*.ico";
        sd.FilterIndex = 0;
        var path = sd.FileName;
        if (!sd.CheckPathExists) return;

        var w = new WriteableBitmap(Dimention, Dimention, 1, 1, PixelFormats.Pbgra32, null);
        var pix = new int[Dimention,Dimention];
        for (int i = 0; i < Dimention; i++)
            for (int j = 0; j < Dimention; j++)
                pix[i, j] = ToArgb(IconCanvas.Board[i, j].Background.Color);

        w.WritePixels(new Int32Rect(0, 0, Dimention, Dimention), pix, Dimention*4, 0, 0);
        var e = new BmpBitmapEncoder();
        e.Frames.Add(BitmapFrame.Create(w));
        var file = new FileStream(path, FileMode.Create);
        e.Save(file);
        file.Close(); 
```

所以，我需要从这些保存的图像中获取一个 Color[,] 。我假设图标的大小是正方形 (width = height) 。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T16:46:22.430

以下代码是我的问题的解决方案（使用位图）：

```
// get the BitmapImage
var image = new BitmapImage(new Uri(path));
if (image.PixelHeight != image.PixelWidth) return;
Dimension = image.PixelHeight;

// copy to byte array
int stride = image.PixelWidth * 4;
byte[] buffer = new byte[stride * image.PixelHeight];
image.CopyPixels(buffer, stride, 0);

// create a bitmap
var bitmap = new System.Drawing.Bitmap(image.PixelWidth, image.PixelHeight, System.Drawing.Imaging.PixelFormat.Format32bppArgb);

// lock bitmap data
System.Drawing.Imaging.BitmapData bitmapData = bitmap.LockBits(new System.Drawing.Rectangle(0, 0, bitmap.Width, bitmap.Height), System.Drawing.Imaging.ImageLockMode.WriteOnly, bitmap.PixelFormat);

// copy byte array to bitmap data
System.Runtime.InteropServices.Marshal.Copy(buffer, 0, bitmapData.Scan0, buffer.Length);

// unlock
bitmap.UnlockBits(bitmapData);

// copy to Color array
var colors = new Color[Dimension, Dimension];
for (int i = 0; i < bitmap.Height; i++)
    for (int j = 0; j < bitmap.Width; j++)
    {
        var mediacolor = bitmap.GetPixel(i, j);
        var drawingcolor = Color.FromArgb(mediacolor.A, mediacolor.R, mediacolor.G, mediacolor.B);
        colors[i, j] = drawingcolor;
    } 
```

我希望如果你需要它可以解决这个问题。

# intellij-idea - 在 IntelliJ Idea 中设置和使用环境变量

> ID：13748784
> 
> 赞同：59
> 
> 时间：2012-12-06T17:06:13.123
> 
> 标签：intellij-idea, environment-variables

我设置了一个环境变量（下`IDE Settings -> Path Variables`）

```
 APP_HOME = /path/to/app_home 
```

我的一项测试失败了

```
 System.out.println("APP HOME: " + APP_HOME); 
```

和

```
 APP HOME: null/ 
```

它看起来不像正在读取该环境变量。我错过了什么？

* * *

## 回答 #1

> 赞同：105
> 
> 时间：2012-12-06T17:31:03.120

**路径变量**对话框与环境变量无关。

环境变量可以在您的操作系统中指定或在运行配置中自定义：

![环境](../Images/1b449cc1cafac8b9791e7a3831ad4fa2.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2019-12-12T07:55:26.900

如果上面的答案+重新启动IDE没有做，如果你使用它，请尝试重新启动“Jetbrains Toolbox”，这对我有用

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-12-13T14:07:58.443

可以在 intellij “运行配置”中引用 intellij “路径变量”。

在“路径变量”中创建一个变量，例如`ANALYTICS_VERSION`。

在“环境变量”下的“运行配置”中添加例如以下内容：

```
ANALYTICS_LOAD_LOCATION=$MAVEN_REPOSITORY$\com\my\company\analytics\$ANALYTICS_VERSION$\bin 
```

要回答原始问题，您需要将`APP_HOME`环境变量添加到引用路径变量的运行配置中：

```
APP_HOME=$APP_HOME$ 
```

# android-contentprovider - 如何在我的活动广播接收器中接收我的消息？

> ID：13748786
> 
> 赞同：0
> 
> 时间：2012-12-06T17:06:16.987
> 
> 标签：android-contentprovider

我希望有一个已在课堂活动中注册的广播接收器，一旦有新短信到达我的手机，就应该调用该活动，我也可以在其中退出这个广播接收器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-29T18:28:31.437

您必须在您的活动中注册新的广播接收器。

# algorithm - 将六个平面形状变成一个立方体

> ID：13748789
> 
> 赞同：0
> 
> 时间：2012-12-06T17:06:31.560
> 
> 标签：algorithm, puzzle

我今天打开日历，里面有一个谜题。有六块，我想我必须把它们做成一个立方体……我试图解决它，但失败了。所以我决定尝试用编程来解决它......

我把它们做成多边形（不确定这是否是个好主意），但不知道如何旋转它们和/或检查任何形状是否与任何其他形状发生碰撞。

形状是这些：

![在此处输入图像描述](../Images/02b4c0b90717f309ac9483c55f870888.png)

TL;DR：我正在寻求帮助，检查这些形状的每一种可能组合，看看它们是否构成立方体。换句话说，我如何旋转和检查多边形（或代表这些部分的其他东西）是否相交？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T17:41:13.237

将它们制成多边形并不是这个问题的正确抽象。

看，你所拥有的是立方体的 6 个面，但现在你必须弄清楚如何旋转它们。每个多边形的边缘都有 12 个小方块，它们要么开要么关，并且必须与旁边的小方块匹配。这是一个非常离散的问题。

整个立方体有8个（顶点）+ 12 * 2（边）边上的小立方体。

每个面，当放入立方体时，将占据一些小立方体。

您需要 1) 在给定的方向上将面映射到给定面上的整个立方体 2) 搜索没有小立方体被占用两次的配置。

# unity-container - Unity 相当于 Windsor 的版本

> ID：13748793
> 
> 赞同：0
> 
> 时间：2012-12-06T17:06:43.717
> 
> 标签：unity-container, release

我在注入控制器的类中有一些非托管资源，一旦控制器被释放，我需要释放这些资源（否则我会出现内存泄漏）。我查看了 IUnityContainer 并没有找到允许我这样做的 Release （或类似）方法。

经过一些试验和错误（和阅读），在我看来，Unity 并没有跟踪它创建的类型的情况。这与 Windsor 不同，我可以调用 Release，整个对象图将被释放。这实际上是首先拥有容器的要点之一（对象生命周期管理）。我不需要直接调用 Dispose，容器应该能够以正确的顺序/对象为我执行此操作。

所以，我的问题是，我怎样才能告诉 Unity 不再需要某个对象并且应该处置该对象？

如果没有办法做到这一点，有没有办法将生命周期更改为每个 Web 请求？

请注意，更改容器不是一种选择。很遗憾 ：（

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-12T22:10:44.287

您将不得不查看 Unity 中不同的生命周期管理器。ContainerControlledLifetimeManager 将对它创建的每个项目调用 dispose。不幸的是，此管理器充当已解析对象的单例，因此可能不适合您。

另一种选择是创建您自己的生命周期管理器，该管理器跟踪它创建的对象，并且在处置容器时仅处置每个对象。

# database - 为什么我的 oracle 语句在 windows 数据库上的运行与在 linux 上的运行方式不同？

> ID：13748795
> 
> 赞同：1
> 
> 时间：2012-12-06T17:06:45.723
> 
> 标签：database, windows, oracle10g, alias, redhat

我不知道从哪里开始调试这个。一些开发人员已经在他们的 Windows 机器上本地编写了一些 pl/sql 代码，这些代码使用 Oracle 10.2.0.1.0 - 64 位可以很好地完成。当它投入生产时，即 Red Hat 5.3 并运行 10.2.0.2.0，它给了我这个错误：

ORA-00904: "S"."BARSTREAMREFERENCEID": 标识符无效

以下是在 Windows 中运行的代码的要点：

```
EXECUTE IMMEDIATE('
  update candyman.CANDY_REFERENCES s
     set ( s.flavour, s.taste, s.colour, s.privateField3 ) =
         ( select * from
                ( select r.flavour, r.taste, r.colour, null
                    from candyman.FOO_REFERENCE_SET t
                    join candyman.FOO_REFERENCES r on r.fooReferenceID = t.fooReferenceID
                   where t.barStreamReferenceID = s.barStreamReferenceID
                order by r.colour )
            where rownum = 1 )
   where privateField3 is not null
     and exists
         ( select 1
             from candyman.FOO_REFERENCE_SET t
             join candyman.FOO_REFERENCES r on r.fooReferenceID = t.fooReferenceID
            where t.barStreamReferenceID = s.barStreamReferenceID )
'); 
```

我知道......他们应该与公司的其他人一起更新他们的 Oracle 版本，并在与生产相同的版本上进行开发，但为时已晚，我无法控制他们......

任何想法都非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T20:09:30.870

请参阅[此 AskTom 线程](http://asktom.oracle.com/pls/asktom/f?p=100:11:0%3a%3a%3a%3aP11_QUESTION_ID:1853075500346799932)：

> ANSI SQL 的表引用（相关名称）的范围只有一层
> 
> ...
> 
> 在 10.2.0.1.0 版本中，此查询有效：
> 
> select (select count(*) from (select * from scott.emp where ename = dual.dummy)) from dual;
> 
> ...
> 
> 那是一个错误。
> 
> 它不适用于 9i、10g 或 11g 的任何终端版本

我是本地开发的忠实粉丝。主要好处之一是配置和管理本地实例比服务器更容易。我很惊讶开发人员不想使用*更新*的版本。

# ruby-on-rails - 带有数组字段的Rails模型，修改push方法

> ID：13748796
> 
> 赞同：0
> 
> 时间：2012-12-06T17:06:49.160
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我一直试图找到我的问题的答案，但到目前为止还没有运气。我有一个带有数组字段的模型，我希望在将某些东西推入数组时发生方法调用。

```
class Shop::Order
  include Mongoid::Document
  include Mongoid::Timestamps    

  embeds_many :items,class_name: 'Shop::OrderItem', inverse_of: :order
  accepts_nested_attributes_for :items 

  field :price, type: Money, default: Money.new(0)
  field :untaxed_price, type: Money, default: Money.new(0)

end 
```

所以在做的时候`order.items << Shop::OrderItem.new(...)` 我想要一个方法`foo`被调用。

编辑：添加原因

所以这样做的原因是我想在每次添加项目时更新订单的`price`and 。`untaxed_price`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T17:34:54.147

我认为猴子补丁`<<`是个坏主意。我有两个想法：

*   使用某种观察者来监听并执行适当`create`的`OrderItem`动作
*   覆盖`OrderItem.create`方法（甚至更好地提供抽象）：

```

```
class OrderItem
  def add(params)
    if create(params)
      calculate_something
    end
  end
end 
```

```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T17:46:47.847

是否需要一推就发生？或者它可以在您保存订单之前发生吗？如果您可以等到保存，您可以这样做：

```
before_validate :update_tax_info

def update_tax_info
  if items_changed?
    calculate_tax #whatever that may be
  end
end 
```

将其投入验证将允许在不保存的情况下调用该回调。您可以致电`@order.valid?`更新税务信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-06T17:55:15.400

本文档为您提供了实现所需行为的选择范围：http: [//mongoid.org/en/mongoid/docs/callbacks.html](http://mongoid.org/en/mongoid/docs/callbacks.html)

换句话说，您可以选择使用回调`before_save`来`before_update`进行计算，或者您可以实现一个`Observer`类来为您执行此操作。

您还可以使用该`changed`方法查看 items 数组是否已更改以及是否需要更新派生字段。

这是一些示例代码：

```
class OrderObserver < Mongoid::Observer 
  def before_save(order)
    do_something
  end
end 
```

请记住在 application.rb 中使用以下命令实例化您的观察者：

```
config.mongoid.observers = :order_observer 
```

# wcf - WCF 数据合同 - 强制执行所需值的最佳/最干净的方法？

> ID：13748799
> 
> 赞同：5
> 
> 时间：2012-12-06T17:07:00.577
> 
> 标签：wcf, datacontract, non-nullable, isrequired

我有一个 WCF 数据契约，其中包含一堆原始类型的属性，如 int 和 decimal，以及`DateTime`（当然，它是一个结构）。

我的同事建议让它们都可以为空，然后通过检查是否为空来验证服务端所需的值。我相信部分原因是，由于它是一个可序列化的对象，因此您无法使用数据协定上的构造函数强制执行所需的值 - 它避免了测试默认值的麻烦。

但是，我还希望在合同中隐含所需的属性，以便客户可以了解需要哪些属性。

所以不要做类似的事情，

```
[DataMember] 
public Nullable<int> AgencyID { get; set; } 
```

这将允许我在服务端干净地测试 null，我会这样做：

```
[DataMember(IsRequired = true, EmitDefaultValue = true)] 
public int AgencyID { get; set; } 
```

我的理解是，如果该属性没有被赋值或默认值为 0，这将引发异常——这是所需的行为。这是在客户端强制执行所需属性的最佳实践吗？让所有内容都可以为空并在服务端检查它有什么好处吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-06T17:31:01.950

我认为将它们全部设为 Nullable 并不是一个好方法，因为这样客户就不会通过您的合同知道是否确实需要某个字段。

如果您申请`IsRequired=true`，则必须提供字段值，否则会引发异常，但这种方法相对比 Nullable 更好......

在许多情况下，我将 DTO（数据传输对象）用于不同的服务......具有必填字段......

# rspec - 为黄瓜定义正确的`fixture_path`

> ID：13748800
> 
> 赞同：4
> 
> 时间：2012-12-06T17:07:03.733
> 
> 标签：rspec, cucumber, fixtures

我想从黄瓜步骤附加一个文件：

```
When /^I attach an image/ do
  page.attach_file("Image", File.join(fixture_path, "green_small.jpg"))
end 
```

由于某种原因，这导致`/home/xxx/test/fixtures/green_small.jpg`. fixture_path 的默认值`test/fixtures`在 cucumber 中。

我正在使用 rspec，所以灯具的路径应该是`spec/fixtures`. 我的 Rspec`spec_helper.rb`有这个配置：

```
RSpec.configure do |config|
  config.fixture_path = "#{::Rails.root}/spec/fixtures"
end 
```

我已经尝试过设置它`config/environments/test.rb`但没有成功。

显然，我可以简单地自己构建路径，`page.attach_file("Image", File.join(Rails.root, "spec", "fixtures", "green_small.jpg"))`有效。但那`fixture_path`已经存在了。设置正确然后使用它，将使这些步骤更便携和更清洁。

但这不是 Cucumber 使用的。如何在黄瓜中获得正确的网址？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-09T19:06:33.993

你如何定义 Cucumber 全局变量，`World`其中有一个 rb 文件`features/support`

文件`features/support/path_define.rb`

```
module PathDefine
  def my_fixture_path
    @my_fixture_path ||= "#{::Rails.root}/spec/fixtures"
  end
end

World(PathDefine) 
```

然后，您可以`my_fixture_path`在步骤定义中的任何位置使用变量。

参考：[https ://github.com/cucumber/cucumber/wiki/A-Whole-New-World](https://github.com/cucumber/cucumber/wiki/A-Whole-New-World)

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T17:20:43.397

根据[this](http://cassiomarques.wordpress.com/2009/01/23/how-to-test-file-uploads-with-cucumber/) post，您应该在测试中使用路径，而不是环境

像这样：

```
attach_file(:csv_file, File.join(RAILS_ROOT, 'features', 'upload-files', 'products_csv_ok.csv')) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-11T18:45:04.263

请注意，您不能将其放入您的环境/*.rb 文件的原因是此配置块用于`RSpec.config`...而不是用于`YourAppName::Application.configure`

您必须修改`./spec/spec_helper.rb`文件中的路径。

# java - 如何在嵌套的 SmartGWT ListGrids 之间启用拖放

> ID：13748802
> 
> 赞同：0
> 
> 时间：2012-12-06T17:07:11.137
> 
> 标签：java, drag-and-drop, smartgwt, listgrid

我有一个 ListGrid A，它有行，可以展开以显示 B 类型的 ListGrid。这些 ListGrid B 也有可以展开以显示 ListGrid C 的行。所有 ListGrid B 都由同一个数据源 B 提供，该数据源 B 链接到数据源 A 通过外键。同样，所有 ListGrids C 都由同一个数据源 C 提供，该数据源 C 通过外键链接到数据源 B。

我只想在所有这些 ListGrids C 之间启用拖放。因此，在 ListGrids C 初始化期间，我调用这些来设置拖放引擎：

```
    setCanReorderRecords(true);
    setCanDragRecordsOut(true);
        setCanAcceptDroppedRecords(true);
        setDragDataAction(DragDataAction.MOVE);
```

但我只能在同一个网格中重新排序行。在网格 C 之间拖放 n 不起作用。有人知道我缺少什么吗？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T23:34:21.663

在要启用拖放的所有组件上设置相同的类型。即对于所有类型 C 的列表网格使用这两种方法：

```
 public static final String DRAG_AND_DROP_TYPE = "typeC";
    ...
    tileGridOfTypeC.setDropTypes(DRAG_AND_DROP_TYPE);
    tileGridOfTypeC.setDragType(DRAG_AND_DROP_TYPE);
    ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-17T10:59:04.427

我正在使用 SmartGWT 2.5。在这个版本中，我还必须在 B 类型的 ListGrids 上启用拖放功能。我还在 ListGrids B 上添加了一个放置处理程序，它通过简单地调用 event.cancel() 来取消任何放置操作。这不是完美的解决方案，但至少它确实有效。

# asp.net - 如何在 ASP.NET 中使按钮保持在固定位置

> ID：13748804
> 
> 赞同：0
> 
> 时间：2012-12-06T17:07:18.117
> 
> 标签：asp.net, html, internet-explorer

在我的网页中，我有以下代码，基本上，一个按钮，两个单选按钮和一个标签，

```
<tr>
        <td class="primary-BL1" style="text-align:right; width:18%">
            <asp:Button ID="SubmitButton" runat="server" Text="Submit" onclick="SubmitButton_Click" CssClass="button" />
        </td>
        <td class="primary-BL1" style="text-align:left; width:34%">
            <asp:RadioButtonList ID="rblVerification" runat="server" RepeatDirection="Horizontal">
                <asp:ListItem Value="V">Verified</asp:ListItem>
                <asp:ListItem Value="NV">Not Verified</asp:ListItem>
            </asp:RadioButtonList>
        </td>
        <td class="primary-BL1" style="text-align:left; width:48%">
            <asp:Label runat="server" ID="CallReasonMessageLabel" CssClass="required"></asp:Label>
        </td>
    </tr> 
```

当我点击提交按钮时，如果标签显示一些错误信息，按钮的位置会向左移动一点。我应该怎么做才能使按钮保持在固定位置？这只发生在 IE8 中，而不是 IE7。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T17:18:10.960

尝试为第一个单元格设置固定宽度，例如 200px：

```
<td class="primary-BL1" style="text-align:right; width:200px">
    <asp:Button ID="SubmitButton" runat="server" Text="Submit" onclick="SubmitButton_Click" CssClass="button" />
</td> 
```

如果您对单元格使用百分比，在某些浏览器中它将根据其内容进行修复

在其他方面，我建议您使用 div 而不是表格。如果你不擅长 css，你可以使用 css 框架以更干净的方式放置你的项目。我几乎不推荐[bootstrap 的网格系统](http://twitter.github.com/bootstrap/scaffolding.html#gridSystem)

# symfony - Doctrine 2 模式更新产生 MySQL errno 150，外键约束

> ID：13748809
> 
> 赞同：4
> 
> 时间：2012-12-06T17:07:34.123
> 
> 标签：symfony, doctrine-orm, foreign-keys, mysql-error-1005

在 Symfony2 中使用 Doctrine ORM 时，我从三个不同的实体生成了以下表格，其中`accessory`有两个外键约束（下面标记为 A 和 B）。

```
describe publication;
+-------------------+--------------+------+-----+---------+----------------+
| Field             | Type         | Null | Key | Default | Extra          |
+-------------------+--------------+------+-----+---------+----------------+
| id                | int(11)      | NO   | PRI | NULL    | auto_increment |
| kid               | varchar(10)  | NO   |     | NULL    |                |
| title             | varchar(255) | NO   |     | NULL    |                |
| title_canonical   | varchar(255) | NO   |     | NULL    |                | <- A
| created           | datetime     | NO   |     | NULL    |                |
| modified          | datetime     | NO   |     | NULL    |                |
+-------------------+--------------+------+-----+---------+----------------+

describe accessory;
+-------------------+--------------+------+-----+---------+----------------+
| Field             | Type         | Null | Key | Default | Extra          |
+-------------------+--------------+------+-----+---------+----------------+
| id                | int(11)      | NO   | PRI | NULL    | auto_increment |
| publication_title | varchar(255) | YES  |     | NULL    |                | <- A
| index_id          | int(11)      | NO   |     | NULL    |                |
| index_alias       | varchar(255) | NO   |     | NULL    |                |
| value             | longtext     | NO   |     | NULL    |                |
| attribute_name    | varchar(255) | YES  |     | NULL    |                | <- B
+-------------------+--------------+------+-----+---------+----------------+

describe attribute;
+-------------------+--------------+------+-----+---------+----------------+
| Field             | Type         | Null | Key | Default | Extra          |
+-------------------+--------------+------+-----+---------+----------------+
| id                | int(11)      | NO   | PRI | NULL    | auto_increment |
| name              | varchar(255) | NO   |     | NULL    |                |
| name_canonical    | varchar(255) | NO   |     | NULL    |                | <- B
| parameter         | varchar(16)  | NO   |     | NULL    |                |
+-------------------+--------------+------+-----+---------+----------------+ 
```

外键使用注释映射：

**发布.php**

```
/**
 * @ORM\OneToMany(targetEntity="Accessory", mappedBy="publication")
 */
protected $accessories; 
```

**附件.php**

```
/**
 * @ORM\ManyToOne(targetEntity="Publication", inversedBy="accessories")
 * @ORM\JoinColumn(name="publication_title", referencedColumnName="title_canonical")
 */
protected $publication;

/**
 * @ORM\ManyToOne(targetEntity="Attribute", inversedBy="accessories")
 * @ORM\JoinColumn(name="attribute_name", referencedColumnName="name_canonical")
 */
protected $attribute; 
```

**属性.php**

```
/**
 * @ORM\OneToMany(targetEntity="Accessory", mappedBy="attribute")
 */
protected $accessories; 
```

但是在运行时`php app/console doctrine:schema:update --force`我得到了这个异常

```
[Doctrine\DBAL\DBALException]                                                                                                                                               
An exception occurred while executing 'ALTER TABLE accessory ADD CONSTRAINT FK_A1B1251CCEE83EE7 FOREIGN KEY (publication_title) REFERENCES publication (title_canonical)':  

SQLSTATE[HY000]: General error: 1005 Can't create table 'publicationsapp.#sql-2a3c_2828' (errno: 150) 
```

所以我跑了`php app/console doctrine:schema:update --dump-sql`

```
ALTER TABLE accessory ADD CONSTRAINT FK_A1B1251CCEE83EE7 FOREIGN KEY (publication_title) REFERENCES publication (title_canonical);
ALTER TABLE accessory ADD CONSTRAINT FK_A1B1251C5CBDA8E FOREIGN KEY (attribute_name) REFERENCES attribute (name_canonical);
CREATE INDEX IDX_A1B1251CCEE83EE7 ON accessory (publication_title);
CREATE INDEX IDX_A1B1251C5CBDA8E ON accessory (attribute_name); 
```

解决此问题的正确方法是什么？我应该手动编辑表格还是使用 Doctrine 编辑表格？

根据我读到的关于 errno 150 的内容，需要为外部列建立索引，但 Doctrine 不能自动处理这个吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-06T18:06:01.237

可以添加`unique=true`到 $nameCanonical 和 $titleCanonical 属性或外键引用的任何列。然后删除并运行模式更新命令以重新创建表。

在 $titleCanonical 的情况下

```
/**
 * @var string
 *
 * @ORM\Column(name="title_canonical", type="string", length=255, unique=true)
 */
private $titleCanonical; 
```

但理想情况下，使用 Doctrine 时，应将外键引用到另一个表的主键以使其有效。

# java - Java中的梯度问题

> ID：13748810
> 
> 赞同：13
> 
> 时间：2012-12-06T17:07:41.243
> 
> 标签：java, swing, nimbus, gradient

在我的程序中，我想在我的 JFrame 上使用半透明的白色到透明的渐变来覆盖黄色背景。这工作正常，它需要是白色到透明的，因为我的程序设置如何为用户工作。但是，当我将程序带入大学时（JRE7 到我的 JRE6），渐变从白色变为黑色然后透明......在你开始增加白色的不透明度之前，这还不错......无论如何我可以解决这个问题吗？

这是我的 JFrame 代码顶部的相关代码。

```
public class DictionaryGUI extends JFrame
{   
    protected JPanel pGradientPane;

    //Interface gradient specification
    private Color pInterfaceColour = new Color(255, 245, 62);
    protected int iDegreeWhite = 180
    protected int iDegreeBlack = 0

    DictionaryGUI(int iWidth, int iHeight)
    {
        /*General definitions*/
        super(String.format("French Verb Conjugator - Version %s", MainLauncher.version));
        setSize(iWidth, iHeight);
        new Menu(this);

        this.iWidth = iWidth;    
        this.iHeight = iHeight;

        getContentPane().setBackground(pInterfaceColour);
        pGradientPane = new JPanel(new GridBagLayout())
        {
            private static final long serialVersionUID = 1L;

            protected void paintComponent(Graphics pGraphics) 
            {
                Graphics2D pGraphicsGradientRender = (Graphics2D) pGraphics;
                pGraphicsGradientRender.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
                GradientPaint pGradient = new GradientPaint(0, 0, new Color(255, 255, 255, iDegreeWhite), 0, getHeight(), new Color(0, 0, 0, iDegreeBlack));
                pGraphicsGradientRender.setPaint(pGradient);
                pGraphicsGradientRender.fillRect(0, 0, getWidth(), getHeight());
                super.paintComponent(pGraphics);
            }
        };
        pGradientPane.setOpaque(false);
        pGradientPane.setPreferredSize(new Dimension(iWidth - 16, iHeight - 62));
        /*components added to pGradientPane here!*/
        add(pGradientPane);
    } 
```

还有主类：

```
public class MainLauncher
{
    static int iHeight = 400;
    static int iWidth = 730;
    static String version = "0A3B6";

    public static void main(String[] args)
    {
    try 
    {
        for (LookAndFeelInfo info : UIManager.getInstalledLookAndFeels())
        {
            if ("Nimbus".equals(info.getName()))
            {
                UIManager.setLookAndFeel(info.getClassName());
                break;
            }
        }
    } catch (Exception e) {e.printStackTrace();}
    DictionaryGUI window = new DictionaryGUI(iWidth, iHeight);
    window.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    window.setLocationByPlatform(true);
    window.setVisible(true);
} 
```

JRE6和JRE7之间只是有些区别吗？我也应该将底部颜色设为白色吗？（如果人们想使底部的颜色变暗，是黑色的。）

如果有人需要，我明天可以发布一些屏幕截图......

![渐变应该是什么样子](../Images/6d2bb0670f727256bcc849f5453bf9d3.png)

![对于某些人来说，渐变实际上是什么样的](../Images/040509c3b925ff832d27c6b293954073.png)

谢谢杰米

**编辑：** 我将渐变中的第二种（透明）颜色更改为白色，它解决了问题。但是，我仍然很困惑为什么透明的黑色会在中间透出来？它一定与 JRE7 有关，因为这就是它发生的地方……也许他们改变了渐变透明度的工作方式。有谁知道如何在保持黑色的同时消除这个问题？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-06T17:44:37.763

这是我作为[sscce](http://sscce.org)的代码版本：

```
import java.awt.*;
import javax.swing.*;
import javax.swing.UIManager.LookAndFeelInfo;

public class MainLauncher {
   static int iHeight = 400;
   static int iWidth = 730;
   static String version = "0A3B6";

   public static void main(String[] args) {
      try {
         for (LookAndFeelInfo info : UIManager.getInstalledLookAndFeels()) {
            if ("Nimbus".equals(info.getName())) {
               UIManager.setLookAndFeel(info.getClassName());
               break;
            }
         }
      } catch (Exception e) {
         e.printStackTrace();
      }
      DictionaryGUI window = new DictionaryGUI(iWidth, iHeight);
      window.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
      window.setLocationByPlatform(true);
      window.setVisible(true);
   }

}

class DictionaryGUI extends JFrame {
   protected JPanel pGradientPane;

   // Interface gradient specification
   private Color pInterfaceColour = new Color(255, 245, 62);
   protected int iDegreeWhite = 180;
   protected int iDegreeBlack = 0;

   DictionaryGUI(int iWidth, int iHeight) {
      /* General definitions */
      super(String.format("French Verb Conjugator - Version %s",
            MainLauncher.version));
      setSize(iWidth, iHeight);

      getContentPane().setBackground(pInterfaceColour);
      pGradientPane = new JPanel() {
         private static final long serialVersionUID = 1L;

         protected void paintComponent(Graphics pGraphics) {
            Graphics2D pGraphicsGradientRender = (Graphics2D) pGraphics;
            pGraphicsGradientRender.setRenderingHint(
                  RenderingHints.KEY_ANTIALIASING,
                  RenderingHints.VALUE_ANTIALIAS_ON);
            GradientPaint pGradient = new GradientPaint(0, 0, new Color(255,
                  255, 255, iDegreeWhite), 0, getHeight(), new Color(0, 0, 0,
                  iDegreeBlack));
            pGraphicsGradientRender.setPaint(pGradient);
            pGraphicsGradientRender.fillRect(0, 0, getWidth(), getHeight());
            super.paintComponent(pGraphics);
         }
      };
      pGradientPane.setOpaque(false);
      pGradientPane.setPreferredSize(new Dimension(iWidth - 16, iHeight - 62));
      /* components added to pGradientPane here! */
      add(pGradientPane);
   }
} 
```

但这又不能证明你的问题。我猜你的问题是在 Swing GUI 中使用透明背景，其中绘画伪影没有完全纠正。如果是这样，请阅读 Rob Camick 在他的博客上对此的评论：[背景与透明度](http://tips4java.wordpress.com/2009/05/31/backgrounds-with-transparency/)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-10T17:41:15.670

代码的问题是这一行：

```
GradientPaint pGradient = new GradientPaint(0, 0, new Color(255, 255, 255, iDegreeWhite), 0, getHeight(), new Color(0, 0, 0, iDegreeBlack)); 
```

应该是这样的：

```
GradientPaint pGradient = new GradientPaint(0, 0, new Color(255, 255, 255, iDegreeWhite), 0, getHeight(), new Color(255, 245, 62, iDegreeWhite)); 
```

回顾您的问题，我发现您基本上找到了解决方案 - 但它有点不同。原因如下：

在渐变中混合颜色时，您混合颜色的所有方面：RBGA

你看，直到你达到完整的第二种颜色，你将黑色混合到颜色渐变中，并且混合不会完全透明。所以在页面向下的 20% 处，您将拥有以下颜色：204,204,204,144（即 80% 白色、20% 黑色和 56% 不透明）。

最简单的解决方案是在不使用时完全避免半透明——只需从顶部的浅黄色混合到底部的深黄色即可。这种方式也占用更少的资源。

但是由于您使用的是透明度，所以我提供的解决方案也使用了透明度。您将使用一致的透明度从白色混合到黄色。

如果你从白色混合到白色（透明），你会遇到和以前一样的问题，只有白色（因为它是你正在使用的颜色之一，所以不太明显）：渐变会有白色“条纹”直到第二种颜色达到完全透明。

至于为什么它在不同的 JVM 上表现不同，我猜 Oracle 可能已经改变了混合 alpha 的方式。更好的 alpha 支持似乎是他们一段时间以来一直在努力的事情，这是朝着这个方向迈出的合乎逻辑的一步。不过，我对此声明没有任何证据——它只是基于我在 alpha 中看到的其他变化（如透明窗口）。

**编辑** 这个 SSCCE 演示了问题和解决方案：

```
import java.awt.*;
import javax.swing.*;
import javax.swing.UIManager.LookAndFeelInfo;

public class TransparencyDemo extends Box{

    protected JPanel pGradientPane;

    //Interface gradient specification
    private Color pInterfaceColour = new Color(255, 245, 62);
    protected int iDegreeWhite = 180;
    protected int iDegreeBlack = 0;

    public TransparencyDemo() {
        super(BoxLayout.X_AXIS);
        setOpaque(true);

        //Incorrect Solution
        pGradientPane = new JPanel(new GridBagLayout())
        {
            private static final long serialVersionUID = 1L;

            protected void paintComponent(Graphics pGraphics) 
            {
                Graphics2D pGraphicsGradientRender = (Graphics2D) pGraphics;
                pGraphicsGradientRender.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
                GradientPaint pGradient = new GradientPaint(0, 0, new Color(255, 255, 255, iDegreeWhite), 0, getHeight(), new Color(0, 0, 0, iDegreeBlack));
                pGraphicsGradientRender.setPaint(pGradient);
                pGraphicsGradientRender.fillRect(0, 0, getWidth(), getHeight());
                super.paintComponent(pGraphics);
            }
        };
        pGradientPane.setOpaque(false);
        add(pGradientPane);

        //Correct Solution
        JPanel pGradientPane2 = new JPanel(new GridBagLayout())
        {
            private static final long serialVersionUID = 1L;

            protected void paintComponent(Graphics pGraphics) 
            {
                Graphics2D pGraphicsGradientRender = (Graphics2D) pGraphics;
                pGraphicsGradientRender.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
                GradientPaint pGradient = new GradientPaint(0, 0, new Color(255, 255, 255, iDegreeWhite), 0, getHeight(),  new Color(255, 245, 62, iDegreeWhite));
                pGraphicsGradientRender.setPaint(pGradient);
                pGraphicsGradientRender.fillRect(0, 0, getWidth(), getHeight());
                super.paintComponent(pGraphics);
            }
        };
        pGradientPane2.setOpaque(false);
        add(pGradientPane2);

        setBackground(pInterfaceColour);

    }

    public static void main(String[] args){
        try {
             for (LookAndFeelInfo info : UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                   UIManager.setLookAndFeel(info.getClassName());
                   break;
                }
             }
          } catch (Exception e) {
             e.printStackTrace();
          }

        final JFrame frame = new JFrame();
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.add(new TransparencyDemo());
        frame.pack();
        frame.setLocationRelativeTo(null);
        frame.setVisible(true);
    }
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-12-09T19:14:17.273

我的猜测是，它与不同计算机上使用的“图形管道”有关。

Java 有几个不同的管道，这里有[一些关于它们](http://docs.oracle.com/javase/7/docs/webnotes/tsg/TSG-Desktop/html/java2d.html#gcghe)的信息。

在我的计算机上，我可以使用 X11 管道或 OpenGL 管道。使用 X11 管道时会出现黑暗；在 OpenGL 上，它没有。

在 Windows 上，您可以从 3 种不同的管道中进行选择，即使这样（查看上面的链接），也可能存在差异。

我无法立即想象您学校的配置是什么，以及为什么会有所不同，但是您可以尝试调查一下。

您可能希望将此差异归档为错误。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-11T15:09:59.503

正如尼克指出的那样，问题在于您使用的是透明黑色而不是透明白色。所以半透明的颜色是介于白色和黑色之间的阴影。

尝试用代码中的这一行替换：

```
GradientPaint pGradient = new GradientPaint(0, 0, new Color(255, 255, 255, iDegreeWhite), 0, getHeight(), new Color(255, 255, 255, iDegreeBlack)); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-12-10T22:36:56.780

我有fatamorgana，我确定GradientPaint越来越黑越来越黑，phaaa疯狂的眼睛错觉，brrrr

```
//http://stackoverflow.com/questions/13748810/gradient-problems-in-java/13806210#comment18995490_13806210

import java.awt.AlphaComposite;
import java.awt.Color;
import java.awt.Container;
import java.awt.EventQueue;
import java.awt.GradientPaint;
import java.awt.Graphics;
import java.awt.Graphics2D;
import java.awt.GridLayout;
import java.awt.Rectangle;
import java.awt.image.BufferedImage;
import javax.swing.JButton;
import javax.swing.JComponent;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.RepaintManager;
import javax.swing.UIManager;
import javax.swing.UIManager.LookAndFeelInfo;

public class MainLauncher {

    private JFrame window = new JFrame();

    public MainLauncher() {
        GradientPane pane = new GradientPane();
        pane.setLayout(new GridLayout(6, 4, 15, 15));
        for (int i = 1; i <= 24; i++) {
            pane.add(createButton(i));
        }
        pane.setOpaque(false);
        window.add(pane);
        RepaintManager.setCurrentManager(new RepaintManager() {

            @Override
            public void addDirtyRegion(JComponent c, int x, int y, int w, int h) {
                Container con = c.getParent();
                while (con instanceof JComponent) {
                    if (!con.isVisible()) {
                        return;
                    }
                    if (con instanceof GradientPane) {
                        c = (JComponent) con;
                        x = 0;
                        y = 0;
                        w = con.getWidth();
                        h = con.getHeight();
                    }
                    con = con.getParent();
                }
                super.addDirtyRegion(c, x, y, w, h);
            }
        });
        window.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        window.setLocationByPlatform(true);
        window.setSize(400, 300);
        //window.pack();
        window.setVisible(true);
    }

    private JButton createButton(final int text) {
        JButton button = new JButton(Integer.toString(text));
        return button;
    }

    class GradientPane extends JPanel {

        private static final long serialVersionUID = 1L;
        private final int h = 150;
        private BufferedImage img = null;
        private BufferedImage shadow = new BufferedImage(1, h, BufferedImage.TYPE_INT_ARGB);

        public GradientPane() {
            paintBackGround(new Color(150, 250, 150));
        }

        public void paintBackGround(Color g) {
            Graphics2D g2 = shadow.createGraphics();
            g2.setPaint(g);
            g2.fillRect(0, 0, 1, h);
            g2.setComposite(AlphaComposite.DstIn);
            g2.setPaint(new GradientPaint(0, 0, new Color(0, 0, 0, 0f), 0, h, new Color(0.1f, 0.8f, 0.8f, 0.5f)));
            g2.fillRect(0, 0, 1, h);
            g2.dispose();
        }

        @Override
        public void paintComponent(Graphics g) {
            if (img == null || img.getWidth() != getWidth() || img.getHeight() != getHeight()) {
                img = new BufferedImage(getWidth(), getHeight(), BufferedImage.TYPE_INT_ARGB);
            }
            Graphics2D g2 = img.createGraphics();
            super.paintComponent(g2);
            Rectangle bounds = this.getVisibleRect();
            g2.scale(bounds.getWidth(), -1);
            g2.drawImage(shadow, bounds.x, -bounds.y - h, null);
            g2.scale(1, -1);
            g2.drawImage(shadow, bounds.x, bounds.y + bounds.height - h, null);
            g2.dispose();
            g.drawImage(img, 0, 0, null);
        }
    }

    public static void main(String[] args) {
        try {
            for (LookAndFeelInfo info : UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
        EventQueue.invokeLater(new Runnable() {

            @Override
            public void run() {
                MainLauncher ml = new MainLauncher();
            }
        });
    }
} 
```

# java - Java JDBC SQL 异常

> ID：13748811
> 
> 赞同：0
> 
> 时间：2012-12-06T17:07:41.293
> 
> 标签：java, sql, jdbc

我目前正在编写一个 Java 脚本，以将一堆书籍从冗长的纯文本文件导入数据库。我已将所有书籍解析为书籍对象，并尝试将它们写入数据库。但是，我在以下字符串上收到一个缺少逗号的异常“ORA-00917：缺少逗号”：

```
INSERT INTO THE_TABLE VALUES( 'Yes' , '50388,50389' , 'Humanities and Performing Arts' , 'Required' , 'Ember, Carol & Ember, Melvin' , 'Human Culture' , '2nd' , '2012' , 'Pearson' , 'This is for CRN's 4879 & 2486' , '9780205251438' , '50' , 'null' , 'null' , 'null' , 'Spring 2013' , 'ROTN 4270' , 'Required' , 'Ember, Carol & Ember, Melvin,' , 'Human Culture' , 'Pearson,' , '2nd' , 'Edition,' , '2012.' , 'null' , 'Not Applicable' , 'Not Applicable' , 'Not Applicable' , 'Spring 2013' , 'ANTH 270' , '50388,50389' , 'Humanities and Performing Arts' , 'Required' , 'This is for CRN's 15454 & 48456, 'Ember, Carol & Ember, Melvin,' , 'Human Culture' , 'Pearson,' , '2nd' , 'Edition,' , '2012.' , '9780205251438' , '50' , 'null' , 'null' , 'Not Applicable' , 'Not Applicable' , 'Not Applicable' , 'null' , 'null' , 'null' ) 
```

我看不到缺少逗号的地方。这个例外还有其他原因吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-06T17:12:25.557

错误很明显，您在插入语句中的某处缺少逗号。

但是，我强烈建议您在使用 JDBC 执行 SQL 查询时使用[**PreparedStatement**](http://docs.oracle.com/javase/6/docs/api/java/sql/PreparedStatement.html)而不是简单的 Statement 以防止 SQL INJECTION。

```
String query="Insert into table values(?,?);";
PreparedStatement stmnt = conn.preparedStatement(query);
stmnt.setString(1, "val1");
stmnt.setString(2, "val2"); 
```

在此处查看有关[**如何在 java 中使用preparedstatement**](http://docs.oracle.com/javase/tutorial/jdbc/basics/prepared.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-06T17:09:26.123

`, 'This is for CRN's 15454 & 48456,`

在那里。
请注意在 (48456) 之后您是如何错过滴答声的。可能是因为（CRN）部分。

另外，我建议使用 a`record`以方便编程。插入这样的值很麻烦。：） 保持良好的工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-06T17:12:04.537

`'Ember, Carol & Ember, Melvin,'`可能是导致问题尝试`'Ember, Carol &' || ' Ember, Melvin,'`

# android - Android Email Intent 导致强制关闭 4.1 Jelly Bean

> ID：13748813
> 
> 赞同：0
> 
> 时间：2012-12-06T17:07:42.307
> 
> 标签：android, email, android-asynctask

我有一个应用程序可以启动多个 Intent 来发送电子邮件、SMS 等。在 Android 4.0.4 及更早版本中，所有设备似乎都运行良好，但在 Android 4.1 及更高版本中，应用程序崩溃，并且没有异常被发送到 logcat。我可以在 4.1 模拟器中重现这个。例如，这是我用来发送电子邮件的代码。

```
Intent emailIntent = new Intent(Intent.ACTION_SEND);
emailIntent.putExtra(Intent.EXTRA_SUBJECT, email.getSubject());
emailIntent.putExtra(Intent.EXTRA_TEXT, Html.fromHtml(email.getContent()));
emailIntent.putExtra(Intent.EXTRA_EMAIL, getRecipients(email.getTo()));
emailIntent.setType("text/html");
this.startActivityForResult(Intent.createChooser(emailIntent, "Choose Application"),1); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T13:23:08.037

这是因为您无法在较新版本的 android 中通过任何 UI 活动进行网络操作。按照[此](https://stackoverflow.com/questions/6343166/android-os-networkonmainthreadexception/6343299#6343299)链接使其工作。

```
private class LongOperation extends AsyncTask<String, Void, String> {

      @Override
      protected String doInBackground(String... params) {

Intent emailIntent = new Intent(Intent.ACTION_SEND);
emailIntent.putExtra(Intent.EXTRA_SUBJECT, email.getSubject());
emailIntent.putExtra(Intent.EXTRA_TEXT, Html.fromHtml(email.getContent()));
emailIntent.putExtra(Intent.EXTRA_EMAIL, getRecipients(email.getTo()));
emailIntent.setType("text/html");
this.startActivityForResult(Intent.createChooser(emailIntent, "Choose Application"),1);

}

            return "Executed";
      }      

      @Override
      protected void onPostExecute(String result) {
                   }

      @Override
      protected void onPreExecute() {
      }

      @Override
      protected void onProgressUpdate(Void... values) {
      }
} 
```

# wpf - 在 WPF 应用程序中维护会话

> ID：13748815
> 
> 赞同：-4
> 
> 时间：2012-12-06T17:07:49.643
> 
> 标签：wpf, c#-4.0, session

我正在实施一个POS系统。我希望在系统中内置登录功能。独立的 WPF 应用程序在不同的 POS 中运行，它们连接到中央数据库。

在这种情况下实现登录功能的最佳方式是什么？

**PS**：销售人员登录时，如果POS闲置15分钟，则必须自动登录。

**编辑**：基本上我最难的是，因为这个相同的 WPF 应用程序（销售人员的接口）将安装在几台机器上，任何销售人员都可以使用这些机器中的任何一台访问该应用程序。在网站中，我们使用会话和 cookie，但我的方法应该是什么，因为这是仅访问数据库的独立 WPF 应用程序。显然密码可以保存在数据库中是一种安全的方式。我可以让一个线程等待 15 分钟，然后弹出一个登录窗口，冻结工作窗口。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T18:04:55.050

对于 15 分钟检查，您可以使用[DispatchTimer](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatchertimer.aspx)，您需要在空闲时启动它并在销售人员开始使用它时重置它。

登录系统的其余部分是使用存储在数据库中的加密/散列密码进行简单的用户名和密码验证......但是您也可以在桌面应用程序中使用 asp.net 会员 API。见[参考](http://msdn.microsoft.com/en-us/magazine/cc163807.aspx)

# asp.net - 查询字符串不起作用

> ID：13748817
> 
> 赞同：1
> 
> 时间：2012-12-06T17:07:54.937
> 
> 标签：asp.net, visual-studio-2010, c#-4.0, entity-framework-4

我是实体框架模型的新手。我正在制作一个类似购物车的网站，用户可以在其中选择一个产品类别，然后单击任何一个产品类别链接，下一页会显示相应类别中的产品。我正在使用实体数据模型和查询字符串。我的代码如下：

```
 <asp:EntityDataSource ID="EDS_ProductsByCategory" runat="server" AutoGenerateWhereClause="True" 
                      ConnectionString="name=CommerceEntity"  
                      DefaultContainerName="CommerceEntity" 
                      EntitySetName="Products">
<WhereParameters>
        <asp:QueryStringParameter Name="CategoryId" QueryStringField="CatID" Type="String" />
       </WhereParameters>
</asp:EntityDataSource> 
```

问题是页面显示所有产品，而与产品类别无关。当查询字符串为categoryID=1 或categoryID=2 时，显示相同的产品列表，即所有产品。[我按照http://www.asp.net/web-forms/tutorials/tailspin-spyworks/tailspin-spyworks-part-1](http://www.asp.net/web-forms/tutorials/tailspin-spyworks/tailspin-spyworks-part-1)上的教程来实现我想要的。请帮助我，我想我犯了一个小错误。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T15:56:57.957

您说 CategoryId 是 QueryString。但是在您的代码中，您使用 CatId 作为 QueryStringField。将其更改为 CategoryId，它应该可以工作。

# android - 为 url 查询内容提供者不返回任何结果

> ID：13748820
> 
> 赞同：0
> 
> 时间：2012-12-06T17:08:13.327
> 
> 标签：android, sqlite

我有一个非常基本的内容提供程序，它在 sqlite 数据库中存储 4 列。这些列是一个自动递增的键、一个作为文本的 url、一个 long 和一个用于图像的 blob。当我尝试查询 url 时，我没有得到任何结果，即使我知道该行存在于数据库中。为了让选择拉它，我需要对 url 做什么。

```
//called when storing
private void addKey(String url, final Bitmap bm) {
    ContentValues values = new ContentValues();
    values.put(ImagesContentProvider.URL, "'" + url + "'");
    values.put(ImagesContentProvider.TIME, System.currentTimeMillis());
    ByteArrayOutputStream bos = new ByteArrayOutputStream();
    bm.compress(CompressFormat.PNG, 0 /* ignored for PNG */, bos);
    values.put(ImagesContentProvider.BITMAP, bos.toByteArray());
cr.insert(ImagesContentProvider.CONTENT_URI, values); //cr is content resolver
}

//called for querying
private void query(String url) {
    String selection =  ImagesContentProvider.URL + "='" + url+ "'";
    Cursor resultsCursor = cr.query(ImagesContentProvider.CONTENT_URI,
                null, selection, null, null);
    if (!resultsCursor.moveToFirst()) { 
            Log.d(TAG, "Not found in DB");
            resultsCursor.close();

    } else {
            Log.e(TAG, "found in DB");          
            resultsCursor.close();
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T17:33:43.653

我知道你已经知道答案了，但是……错误就在这里

```
values.put(ImagesContentProvider.URL, "'" + url + "'"); 
```

这应该是：

```
values.put(ImagesContentProvider.URL, url); 
//or you should add ' when you do query 
```

您在 ContentValues 中使用了不必要的转义字符串 ...

为防止此类错误，请不要自行转义字符串...使用参数化查询

```
Cursor resultsCursor = cr.query(ImagesContentProvider.CONTENT_URI,
         null, ImagesContentProvider.URL + "=?", new String[] { url }, null); 
```

# excel - 使用 CountIF 创建 VBA 公式

> ID：13748821
> 
> 赞同：1
> 
> 时间：2012-12-06T17:08:13.413
> 
> 标签：excel, vba

我正在创建一个基于 2 个条件计算的公式。我的逻辑是错误的 - 再次。

当我（手动）输入代码求和公式（COUNTIFS）到正确的单元格本身时，它会正确求和：

```
COUNTIFS(E4:E1362,"Requirement",S4:S1362, "<>4") 
```

当我执行以下代码行时，我没有收到任何错误，而是所有的总和都为零。

```
Range("G" & Start(groups) - 1).Formula = "=COUNTIFS(E" & Start(groups) & ":E" & Finish(groups) & "," & "Requirement" & ",S" & Start(groups) & ":S" & Finish(groups) & "," & Chr(34) & "<>4" & Chr(34) & ")" 
```

我意识到 COUNTIFS 正在将 S 列中的值与字符串“<>4”进行比较。并且没有一个单元格包含该字符串。这就是为什么我所有的价值观都是零。我不希望比较针对该字符串。我希望比较的列 S 值不等于 4。

因此，我将行更改为（以及使其工作的变体）：

```
Range("G" & Start(groups) - 1).Formula = "=COUNTIFS(E" & Start(groups) & ":E" & Finish(groups) & "," & "Requirement" & ",S" & Start(groups) & ":S" & Finish(groups) & "," & Chr(34) & "<>" & Chr(34) & "4)" 
```

所以，我很茫然。(1) 我手动输入公式并且它有效。(2) 我在 VBA 中构建它，但它的总和不正确。(3) 我查找了如何正确构建公式，但我一次又一次地出错。似乎让它工作的唯一方法是将引号保持在引号内，但我不想与字符串进行比较。

这有意义吗？我不再喜欢我的工作表了。它不再有任何乐趣。:(

太感谢了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T18:00:27.400

我认为所有这些`Chr(34)`都妨碍您正确查看公式。尝试使用`""`为公式制作报价。

```
.Formula = "=COUNTIFS(E4:E1362,""Requirement"",S4:S1362,""<>4"")" 
```

使用您的`Start`和`Finish`函数，这会将公式更改为：

```
.Formula = "=COUNTIFS(E" & Start(groups) & ":E" & Finish(groups) & _
    ",""Requirement"",S" & Start(groups) & ":S" & Finish(groups) & ",""<>4"")" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-12-11T02:43:10.627

好吧，我发现的问题之一很简单，而不是使用“，你必须使用“;”。这取决于您使用的版本，有些使用“，”，有些使用“;”。你可以试试，希望能解决你的问题。

还有第二个“要求”，我认为您应该改用双引号。

并为您的情况满足此条件：

```
COUNTIFS(E4:E1362,"Requirement",S4:S1362, "<>4") 
```

用这个：

```
 "=COUNTIF(E" & Start(groups) & ":" & "E" & Finish(groups) & "," & """Requirement""" & "," & "S" & Start(groups) & ":" & "S" & Finish(groups) & "," & """<>4"")" 
```

我认为它应该工作（如果我没有错过任何报价的想法）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-06T18:54:11.380

使用初始代码运行快速测试后

```
Range("G1").Formula = "=COUNTIFS(E1" & ":E20" & "," & "Requirement" & ",S1" & ":S20" & "," & Chr(34) & "<>4" & Chr(34) & ")" 
```

稍作修改以考虑您的组变量单元格 G1 最终得到以下公式：

```
=COUNTIFS(E1:E20,requirement,S1:S20,"<>4") 
```

在测试时，它对于您的第二个 if 语句 S1:S20,"<>4" 来说绝对没问题。我猜问题出在你的第一句话上。您的要求范围内的内容以及您尝试匹配的数据。

我将名为范围的要求设置为单元格 D5，我在其中输入了一个 5，每次我在范围 E1:E20 中添加一个额外的 5 时，公式都会递增。然后我开始在 S1:s20 范围内输入 4，这减少了我的计数。

**编辑** 我可以建议的最后一件事是在 F 列中添加一个辅助列，该列评估行以查看它是否符合要求条件，那么制作公式将是一件简单的事情：

```
=COUNTIFS(F1:F20,TRUE,S1:S20,"<>4") 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-06T17:15:19.640

...尝试删除 chr(34) 和额外的引号 - 它应该看起来与“要求”标准完全一样：

```
Range("G" & Start(groups) - 1).Formula = "=COUNTIFS(E" & Start(groups) & ":E" & Finish(groups) & ",""Requirement"",S" & Start(groups) & ":S" & Finish(groups) & ",""<>4"")" 
```

# sql-server-ce - 如何通过 Power Builder 连接到 SQL Server Compact？

> ID：13748822
> 
> 赞同：1
> 
> 时间：2012-12-06T17:08:13.367
> 
> 标签：sql-server-ce, powerbuilder

除了连接到 之外`SQL Server Compact`，我如何通过`PowerBuilder`代码附加、分离数据库，以便可以`exe`与`database`任何系统一起使用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T13:31:50.827

您使用的是哪个版本的 PowerBuilder？希望有 .NET 可用，因为连接非常简单。

1.  将对 System.Data.SqlServerCe.Dll 的引用添加到您的项目中。（在 SQL CE 文件夹中）
2.  将 using for System.Data.SqlServerCe 添加到具有连接逻辑的对象中。
3.  添加连接逻辑

    SqlCeConnection 连接字符串 lsConn、lsFile、lsException

    尝试

    ```
     lsFile = "2ndAmendmentWarning.sdf"
      lsConn = "Data Source=2ndAmendmentWarning.sdf;Password='JoinTheNRAToday'"
      conn = create SqlCeConnection(lsConn)
      conn.Open() 
    ```

    捕获（SqlCeException ex）

    ```
     lsException = ex.Message.ToString() 
    ```

    结束尝试

当然，您的数据库文件和密码将动态设置...

# algorithm - google go中的可重用优先级队列实现

> ID：13748826
> 
> 赞同：1
> 
> 时间：2012-12-06T17:08:24.643
> 
> 标签：algorithm, go, priority-queue, reusability

如何在 Google Go 中编写可重用优先级队列的代码，或者每次需要优先级队列实现时定义`Less` `Push`and函数？`Pop`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T17:10:16.003

后一种情况是必须要做的。至于 Go 没有泛型，它是目前唯一可用的选项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T22:34:08.150

还没有尝试过，但是如果您的案例恰好符合某些限制条件，也许您可​​以使用反射和结构标签。您将要求您的可堆类型是一个结构，在您用于排序的字段上带有类似 `pq:"Key"` 的标签，并且该字段类型是 < 可比较的。它远没有 Less 方法强大，但它可能满足您的需求。

抱歉，我没有适合您的示例代码。我不认为这会非常困难，但我需要一些时间。离开去锻炼。

如果我需要处理任意结构并且我可以忍受简单的密钥限制，我可能会尝试这种技术。但是，对于有限的类型集，我不会这样做。我只是按照书来做，为每种类型分别实现 heap.Interface 。它真的没有那么多工作，也没有那么多代码行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-06T20:07:05.317

标准库的模块中曾经有向量类型，`container/vector`它们实现了这些方法，基于可调整大小的切片，并且完美地用作与`heap`模块一起使用的容器。不幸的是，他们摆脱了`vector`，我从来不理解它，因为它在切片变量上实现了一个很好的方法级抽象。所以现在，每当我看到有人在 Go 中使用 heap 模块时，他们基本上都必须根据切片变量重新实现部分内容`vector`——编写`Push`, `Pop`,等。`Length`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-20T07:30:15.343

我不确定我是否理解这个问题。

我在这里使用 interface{} 作为存储类型实现了一个队列（以及堆栈和环）：

[https://github.com/iNamik/go_container](https://github.com/iNamik/go_container)

使用 interface{} 允许您存储您想要的任何类型 - 尽管它不能帮助您强制执行类型 ala 泛型，但它可以完成工作。

我可以看到创建一个优先级队列没有太多麻烦。

我错过了什么吗？

如果您认为它有用，我很乐意添加一个优先队列容器。

# c# - 如何以编程方式调用和执行 MySQL 命令？

> ID：13748827
> 
> 赞同：0
> 
> 时间：2012-12-06T17:08:24.173
> 
> 标签：c#, mysql, cmd

我想以编程方式运行所有命令，命令如下：

```
string mysql ="C:\Program Files\MySQL\MySQL Server 5.1\bin"
string command =" mysql.exe -u root -ppassword fabrica < c:/backup.sql"; 
```

我想使用 C# 运行这两行，我该如何实现？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T17:16:59.303

编辑：现在我知道你想做什么

这是在方法中制作的代码

```
string binary = @"C:\MySQL\MySQL Server 5.0\bin\mysqldump.exe"
string arguments = @"-uroot -ppassword sample"
ProcessStartInfo PSI = new System.Diagnostics.ProcessStartInfo(binary, arguments);
PSI.RedirectStandardInput = true;
PSI.RedirectStandardOutput = true;
PSI.RedirectStandardError = true;
PSI.UseShellExecute = false;
Process p = System.Diagnostics.Process.Start(PSI);
Encoding encoding = p.StandardOutput.CurrentEncoding;
System.IO.StreamWriter SW = new StreamWriter(@"c:\backup.sql", false, encoding);
p.WaitOnExit();
string output = p.StandardOutput.ReadToEnd()
SW.Write(output)
SW.Close(); 
```

祝你好运！

# teamcity - Team City 7.1 跨构建配置的配置参数

> ID：13748829
> 
> 赞同：0
> 
> 时间：2012-12-06T17:08:35.280
> 
> 标签：teamcity, teamcity-7.0

我想在 TC 配置上定义一个变量，并想在另一个 TC 配置上获取它的值，该 TC 配置对第一个具有触发器依赖性。

是否有可能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-09T19:34:00.843

如果两个配置在同一个项目中，可以定义一个包含共享参数（即变量）的构建配置模板。然后，两个活动配置都必须引用该模板——使用“与模板关联”操作来完成此操作。shared 参数的值必须在模板中设置，以便两个配置都知道相同的值。

如果您尝试在配置之间共享内部版本号（或其他系统级参数），则有[一种特殊的方法](http://confluence.jetbrains.net/display/TCD4/How+To...#HowTo...-Havethesamebuildnumberforsamesnapshotbuildsofdifferentbuildconfigurations)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-10T19:25:37.673

我必须使用类似的东西来实际动态地更改配置参数。

```
Invoke-WebRequest -Uri "http://build/guestAuth/action.html?add2Queue=bt876&name=env&value=test&name=env.number&value=%target.env.number%" -Method "Get" -Verbose 
```

# c - 通过 curl 使用摘要身份验证

> ID：13748830
> 
> 赞同：1
> 
> 时间：2012-12-06T17:08:45.207
> 
> 标签：c, libcurl

我以这种方式使用 libcurl 开发了一个基本身份验证：

```
curl_easy_setopt(curl, CURLOPT_URL, "http://192.168.1.133:8080/myrep");
curl_easy_setopt(curl, CURLOPT_USERNAME, "user");
curl_easy_setopt(curl, CURLOPT_PASSWORD, "passwd"); 
```

我还想用 libcurl 开发摘要认证。

怎么做。

Libcurl 是否支持这种行为

1) --> 客户端向服务器发送一个没有认证字段的http请求

2) <-- 服务器响应 401 需要摘要认证并提供`authrealm`

3) --> 客户端使用接收到的摘要认证发送相同的http消息`authrealm`

4) <-- 在成功的情况下。服务器发送认证成功，客户端通过 libcurl 检测到

5) <-- 在失败的情况下。服务器重新发送 401 消息，客户端通过 libcurl 检测到它

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T17:15:12.607

是的，libcurl 支持它。请参阅[CURLOPT_HTTPAUTH](http://curl.haxx.se/libcurl/c/curl_easy_setopt.html#CURLOPTHTTPAUTH)，然后尤其是 CURLAUTH_DIGEST 位。

# c++ - 是否可以使静态控件透明？

> ID：13748831
> 
> 赞同：4
> 
> 时间：2012-12-06T17:08:53.693
> 
> 标签：c++, winapi

我正在尝试实现一个静态控件，该控件会刷新（更改文本）以响应某些事件，该事件每秒发生一次。由于我不想每秒都绘制整个客户区，所以我决定使用静态控件，现在的问题是父窗口是蒙皮的，这意味着它有自定义位图作为背景，而静态控件没有适合，所以我正在寻找使静态控件的背景透明的方法。

这就是我现在所拥有的：

```
 hHandle = CreateWindowEx( WS_EX_TRANSPARENT, "STATIC", "", WS_CHILD | WS_VISIBLE | WS_CLIPSIBLINGS, 60, 212, 477, 20, hwnd, 0, hInstance, 0) ;

     case WM_CTLCOLORSTATIC: 
          {
              HDC hdC = (HDC)wParam;

              SetTextColor( hdC, RGB(31,122,179) );

              SetBkMode( hdC, TRANSPARENT );

              return 0;//(HRESULT)GetStockObject(NULL_BRUSH);
          }
          break; 
```

我尝试返回 NULL 画笔来绘制背景，希望它可以使其背景透明，但它并没有强制静态控件无法正确重新绘制，我的意思是文本被绘制在旧文本之上所以这一切都很混乱。

子类化是唯一的选择吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-06T20:05:21.607

我发现可靠地做到这一点的唯一方法是对静态控件进行子类化并手动绘制背景。

`WS_EX_TRANSPARENT`不会使控件对底层像素真正透明（尽管它可能看起来像那样）并且`WS_EX_COMPOSITED`不能用于子窗口。

相反，将静态子类化并捕获`WM_ERASEBKGND`消息。然后，您可以绘制底层位图的适当部分。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-08-10T16:19:18.863

据我了解，让 WC_STATIC 控件仅显示您选择的颜色（在图像或其他表面上）的文本的方法是返回。这就是这个[链接](http://www.codeproject.com/Questions/256167/Set-static-background-color-in-cplusplus)对我有用的东西。

```
case WM_CTLCOLORSTATIC:
   SetTextColor((HDC)wParam, RGB(255, 0, 0));
   SetBkMode((HDC)wParam, TRANSPARENT);

   // the correct return needs HOLLOW_BRUSH
   return (LRESULT)GetStockObject(HOLLOW_BRUSH);
break; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-06T17:28:03.600

您没有提到静态控件上的窗口样式，特别是扩展样式 WS_EX_TRANSPARENT 似乎旨在解决您描述的重绘问题。另外据我了解，WS_EX_COMPOSITED 在您的上下文中可能很有用。

您还可以考虑背景窗口是否应该设置 WS_CLIPCHILDREN，因为这可能会影响重绘。

# wcf - 工作进程关闭后队列中的消息时服务未激活

> ID：13748832
> 
> 赞同：1
> 
> 时间：2012-12-06T17:09:02.177
> 
> 标签：wcf, msmq

我的本地机器上有一个（死信）队列，名为`logging/logdeadletterservice.svc`. 我有一个相应的服务正在运行以`appdev.me.com/logging/logdeadletterservice.svc`从队列中提取消息并重新提交它们。只要工作进程正在运行，它就可以很好地工作。但是，一旦工作进程关闭（或者如果它还没有启动），服务将不再从队列中获取消息，除非我手动浏览到 SVC。

根据[这篇文章](http://www.codewrecks.com/blog/index.php/2009/03/17/hosting-a-wcf-service-based-on-msmq-in-iis7/)，NETWORK SERVICE 需要权限才能查看队列。我继续并添加了该权限，但消息没有从队列中拉出。我尝试重新启动 Net.Msmq 侦听器适配器（实际上，它在网络服务下运行），但仍然不行。

关于我做错了什么的任何想法？

**编辑**：我试过[运行`sc sidtype netmsmqactivator unrestricted`](http://social.msdn.microsoft.com/Forums/en-US/wcf/thread/a1df55c4-e642-442a-9057-f0aec278d10c/)并重新启动服务，但不行。在没有解决问题后将其切换回受限（原始）。

**EDIT2**：还尝试以我自己的身份运行 Net.Msmq 侦听器适配器（这是运行服务的用户），但不行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-13T21:30:28.877

最终使用[AppFabric](http://msdn.microsoft.com/en-us/windowsserver/ee695849.aspx)并对 appcmd.exe 运行以下命令，以使池始终可用并始终预热：

```
%windir%\system32\inetsrv\appcmd.exe set apppool "My Site" /startMode:AlwaysRunning
%windir%\system32\inetsrv\appcmd.exe set app /app.name:"My Site/My App" /serviceAutoStartEnabled:True /serviceAutoStartMode:All /serviceAutoStartProvider:Service 
```

# c# - 无法在另一个类中引用公共对象，请查看我的来源并让我知道我做错了什么

> ID：13748834
> 
> 赞同：1
> 
> 时间：2012-12-06T17:09:15.077
> 
> 标签：c#, random, public, monogame

我正在学习 C#，目前正在玩 Monogame。我要做的是在我的 Game1 类中声明一个名为“randVar”的 System.Random 类的公共实例，然后从我的 Testz（从 Sprite 派生）类中访问它。这不起作用，它告诉我“当前上下文中不存在名称 'randVar'。” 我正在挠头试图找出原因，因为 randVar 是公开的，我认为我应该能够访问它。

我的源代码是[https://gist.github.com/4225880](https://gist.github.com/4225880)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T17:13:56.177

为了能够访问该类的`randVar`成员`Game1`，您必须首先拥有该类的一个实例。它与类的任何其他公共成员相同。它目前不存在于`Testz`该类的范围内。如果你只是想要一个随机数，你应该`Random randVar = new Random()`在你的`Testz`班级里做。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T17:17:58.463

您在 Game1 中定义了 randVar，但使用了 TestZ。只需将定义移动到 TestZ 或更好的 Sprite 中。

此外，您应该知道 Random 不是线程安全的。所以最好让每个类都保留它的实例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-06T17:16:20.760

如果没有在第二个类中实例化第一个类，就不能从另一个类中引用定义在一个类中的实例变量。您可以在`TestZ`课堂上执行以下操作：

```
Game1 oGame1 = new Game1(); 
```

然后你可以这样做：

```
location.X = oGame1.randVar.Next(0,100) * .01f * screenBounds.Width; 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-12-06T17:14:16.680

您必须将`static`修饰符添加到变量的声明中：

```
public static Random randVar = new Random(); 
```

# windows-phone-7 - 如何将 ListBox 绑定到非常大的数据集

> ID：13748836
> 
> 赞同：1
> 
> 时间：2012-12-06T17:09:22.463
> 
> 标签：windows-phone-7, binding, listbox, large-data

我想在我的`ListBox`. 所以我使用这样的绑定

```
listBox.ItemsSource = largeList; 
```

我`ListBox`确实使用`VirtualizingStackPanel`了，但是，我发现在屏幕上渲染需要很长时间。

有没有更有效的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T17:14:37.287

我不确定是否有真正的大数据，您应该将它们显示给用户

顺便说一句，你可以这样欺骗它：制作一个新计时器，在滴答事件（每 5 毫秒）添加少于 5 个项目

# java - Google Analytics 3.0 auth flow

> ID：13748837
> 
> 赞同：6
> 
> 时间：2012-12-06T17:09:23.080
> 
> 标签：java, google-api, oauth-2.0, google-analytics-api, google-api-java-client

**EDIT:** Originally this question asked how I could authenticate with the Google Analytics API using only my API key. As [vlatko pointed out](https://stackoverflow.com/a/13834210/697449), this isn't possible. Now I'm just focused on getting OAuth2 to work. I will be trying vlatko's suggestions when I get a chance and will update the question. In the meantime, feel free to contribute answers with anything you think I'm missing.

* * *

**ORIGINAL QUESTION:**

I'm trying to make requests to the Google Analytics API. I'm walking through the [Hello Analytics](https://developers.google.com/analytics/solutions/articles/hello-analytics-api) tutorial trying to replicate the steps. Whatever I try, I can't seem to authenticate succesfully.

The tutorial says the following:

> Open the file you created named `HelloAnalyticsApi.java` and add the following method:
> 
> ```
> private static Analytics initializeAnalytics() throws Exception {
>     // Authorization.
>     Credential credential = OAuth2Native.authorize(
>         HTTP_TRANSPORT, JSON_FACTORY, new LocalServerReceiver(),
>         Arrays.asList(AnalyticsScopes.ANALYTICS_READONLY));
> 
>     // Set up and return Google Analytics API client.
>     return Analytics.builder(HTTP_TRANSPORT, JSON_FACTORY)
>         .setApplicationName("Google-Analytics-Hello-Analytics-API-Sample")
>         .setHttpRequestInitializer(credential)
>         .build();
>   } 
> ```
> 
> When a user encounters this script, the application will attempt to open the default browser and navigate the user to a URL hosted on google.com. At this point, the user will be prompted to login and grant the application access to their data. Once granted, the application will attempt to read a code from the browser window, then close the window.

The difference is that I'm trying to do this with a servlet application, and I want to use simple API access with an API key (rather than an OAuth 2.0 client ID). I know that OAuth 2.0 is recommended, but I only need to access data that I own and want to simplify the technical requirements. I based this decision on [this page](https://developers.google.com/console/help/#WhatIsKey), which says:

> An API key is a unique key that you generate using the Console. When your application needs to call an API that's enabled in this project, the application passes this key into all API requests as a `key={API_key}` parameter. Use of this key does not require any user action or consent, does not grant access to any account information, and is not used for authorization.
> 
> If you are only calling APIs that do not require user data, such as the Google Custom Search API, then API keys may be simpler to implement. However, if your application already uses an OAuth 2.0 access token, then there is no need to generate an API key as well. In fact, Google ignores passed API keys if an OAuth 2.0 access token is already associated with the corresponding project.

I can't find many code examples of auth flow just using the API key - most everything I've found shows using the client ID with the downloaded .p12 file, for example the [`GoogleCredential`](http://javadoc.google-api-java-client.googlecode.com/hg/1.12.0-beta/com/google/api/client/googleapis/auth/oauth2/GoogleCredential.html) javadoc. The one example application I could find was Google's [Books Sample](http://code.google.com/p/google-api-java-client/source/browse/books-cmdline-sample/src/main/java/com/google/api/services/samples/books/cmdline/BooksSample.java?repo=samples) app. Anyway, here's what I tried (mimicking the first request in the tutorial, which gets a list of the accounts from the management API):

```
Analytics analytics =
        new Analytics.Builder(httpTransport, jsonFactory, null)
        .setApplicationName("Dev API Access")
        .build();
Management.Accounts.List list =
        analytics.management().accounts().list().setKey(apiKey);
Accounts accounts = list.execute(); 
```

Where "Dev API Access" is the "Name" field in my API console dashboard. The API key is a server key restricted to my IP address. This fails with the following response:

```
401 Unauthorized
{
  "code": 401,
  "errors": [
    {
      "domain": "global",
      "location": "Authorization",
      "locationType": "header",
      "message": "Login Required",
      "reason": "required"
    }
  ],
  "message": "Login Required"
} 
```

I also tried this:

```
Analytics analytics =
        new Analytics.Builder(httpTransport, jsonFactory, null)
        .setApplicationName("Dev API Access")
        .setGoogleClientRequestInitializer(new AnalyticsRequestInitializer(apiKey))
        .build();

Management.Accounts.List list = analytics.management().accounts().list();
Accounts accounts = list.execute(); 
```

Which shows the same error. What am I doing wrong here? Is OAuth2 required for analytics calls? If so, why does just using the API key work in the Books Sample app?

* * *

Moving on, I went ahead and tried OAuth2 anyway - I created a client ID and downloaded the .p12 private key file. But I couldn't get that working either. Here's what I tried:

```
Credential credential =
        new GoogleCredential.Builder()
        .setTransport(httpTransport)
        .setJsonFactory(jsonFactory)
        .setServiceAccountId(serviceAccountId)
        .setServiceAccountScopes(AnalyticsScopes.ANALYTICS_READONLY)
        .setServiceAccountPrivateKeyFromP12File(new File(p12FilePath))
        .setServiceAccountUser(serviceAccountUser)
        .build();

Analytics analytics =
        new Analytics.Builder(httpTransport, jsonFactory, credential)
        .setApplicationName("Dev API Access")
        .build();

Management.Accounts.List list = analytics.management().accounts().list();
Accounts accounts = list.execute(); 
```

Where `serviceAccountId` is the email address of the Google account owning the project and `serviceAccountUser` is the email address listed on the generated client ID. This fails with the following:

```
400 Bad Request
{
  "error": "invalid_grant"
} 
```

What does "invalid grant" mean, and how do I successfully authenticate (ideally without OAuth2)?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-12T06:40:49.153

To answer your first question: in general, OAuth2.0 is used for authorized access to user's private data, so getting user consent and obtaining an access token is required. In the case with Google Books API, however, if you're accessing public data, there is no need for end user consent so an API key is sufficient. If you try accessing non public data with the Books API, you'll still need an OAuth2 token.

The good news for your case is that even with OAuth2, you can bypass user involvement and streamline your flow with Service Accounts - assuming your application has access to the API. There is a way to set that up for the Analytics API, explained [here](https://developers.google.com/analytics/devguides/reporting/core/v3/gdataAuthorization) (check the steps in the Service Accounts section). I think you are on the right track with your `Credential` builder, but I don't think you need to set the service account user in there, since you are not doing any user impersonation.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-13T21:22:12.683

[vlatko's answer](https://stackoverflow.com/a/13834210/697449) got me on the right track. The issue turned out to be that I was confusing the owner email address with the service account email address. For example, I was doing the following:

```
Credential credential =
    new GoogleCredential.Builder()
    .setTransport(httpTransport)
    .setJsonFactory(jsonFactory)
    .setServiceAccountId("owneremail@gmail.com")                   //wrong
    .setServiceAccountScopes(AnalyticsScopes.ANALYTICS_READONLY)
    .setServiceAccountPrivateKeyFromP12File(new File(p12FilePath))
    .setServiceAccountUser("xxx@developer.gserviceaccount.com")    //unnecessary
    .build(); 
```

When I needed to do this:

```
Credential credential =
    new GoogleCredential.Builder()
    .setTransport(httpTransport)
    .setJsonFactory(jsonFactory)
    .setServiceAccountId("xxx@developer.gserviceaccount.com")
    .setServiceAccountScopes(AnalyticsScopes.ANALYTICS_READONLY)
    .setServiceAccountPrivateKeyFromP12File(new File(p12FilePath))
    .build(); 
```

Also, I had added `owneremail@gmail.com` as a user on my Analytics application - this similarly needed to be the service account email instead.

# vb.net - 局部变量的块作用域

> ID：13748845
> 
> 赞同：6
> 
> 时间：2012-12-06T17:09:53.840
> 
> 标签：vb.net, scope

有没有更好的方法在 VB.Net 中创建任意块来限制局部变量的范围？如果尝试过“If 1 Then”，但它看起来很笨拙。

```
If 1 Then
    Dim table = InputParameter1
    Dim new_row = table.AddRow
    new_row.field(1) = InputParameter3.user_value
End If 
```

我只是不想在程序的后期拥有`table`和访问。`new_row`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-06T17:13:56.070

重构您的过程，以便在另一个过程中 table 和 new_row 做他们的事情。如果您以后真的不需要它们可见，那么它们正在执行一个不同的子任务，无论如何都应该重构。

一般来说，当您可以将您的代码划分为 N 个段时，其中每个段不依赖于其他段，那么您正在查看 N 个任务，最好是 N 个过程。

这可以追溯到任何程序都应该做一件事的规则，而多个段表明它正在做不止一件事。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-09T01:17:34.027

使用`Option Strict On`，那必须是`If True Then`，但更首选的选项（据我所见）是`Do ... Loop While False`.

但是，没有像简单`Begin ... End`（或`{ ...}`）这样的语法。

如果您可以使用`IDisposable`，并将其放置在块的末尾，`Using newVariable = AnIDisposable`则可以为您提供最接近您所描述的内容，但就像我说的那样，它被放置在末尾。

# git - Git 将不再识别我的程序的更改

> ID：13748848
> 
> 赞同：1
> 
> 时间：2012-12-06T17:10:07.943
> 
> 标签：git, version-control

我有一个使用 Git 的本地存储库。

几天前，Git 停止在“未提交的更改”中显示对我的程序所做的更改。我试图恢复或回滚，但它告诉我它不能。

我知道这并不多，但有谁知道如何告诉 git 对我现在拥有的内容进行快照并继续。如果我丢失了从现在到最后一次成功提交之间所做的更改记录，我可以忍受。

还是我需要从头开始一个存储库？

（我承认我是 Git 的 n00b）

**感谢回复**：git status 输出：致命：无法读取树*长字母数字*

**致提问**者：首先感谢您的持续关注，

其次是配置文件：

```
[core]
    bare = false
    repositoryformatversion = 0
    filemode = false
    logallrefupdates = true
    symlinks = false
    ignorecase = true 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T17:15:20.513

我想`git status`在实际尝试解决问题之前查看输出。

**一种可能的“解决方案”？**

您可以备份当前状态，然后执行`git --hard reset`回滚到上一个提交。然后，您可以使用最新状态的备份覆盖这些文件。

# c++ - 如何将可变参数参数传递给另一个函数？

> ID：13748850
> 
> 赞同：2
> 
> 时间：2012-12-06T17:10:10.600
> 
> 标签：c++, c, variadic-functions

**简短版本：** 如何将`...`变量参数函数中表示的内容传递给另一个函数，而无需先将其解析为`va_list`?

**长版：**

以下是我的一类中的两个功能。我想提请您注意，每个函数的前四行是相同的。我在这个类中有六个其他函数，前四行相同。

```
void cyclOps::Logger::warn(char* szFile, char* szFunction, int iLine, char* szFormat, ...) {
    va_list vaArguments;
    va_start(vaArguments, szFormat);
    char szOutput[10000];
    _vsnprintf_s(szOutput, CYCLOPSSIZEOF(szOutput), _TRUNCATE, szFormat, vaArguments);
    this->log("WARNING: %s [%s - %s(%d)]", szOutput, szFile, szFunction, iLine);
}

void cyclOps::Logger::info(char* szFormat, ...) {
    va_list vaArguments;
    va_start(vaArguments, szFormat);
    char szOutput[10000];
    _vsnprintf_s(szOutput, CYCLOPSSIZEOF(szOutput), _TRUNCATE, szFormat, vaArguments);
    this->log("INFO: %s", szOutput);
} 
```

我想将这四行相同的行放在一个名为的函数中`summarizeVariableArguments()`，并称它为这样的......

```
void cyclOps::Logger::info(char* szFormat, ...) {
      std::string strOutput = this->summarizeVariableArguments(/* TBD */);
    this->log("INFO: %s", strOutput.c_str());
} 
```

...其中的内容`strOutput`将与`szOutput`前两个函数中的内容相同。但是如何将`...`参数传递给另一个函数？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-06T17:34:46.100

[这就是完美转发的全部内容](https://stackoverflow.com/questions/3582001/advantages-of-using-forward)+ 可变参数模板。

```
template<typename ...Args>
void cyclOps::Logger::info(char* szFormat, Args &&...args) {
    std::string strOutput = this->summarizeVariableArguments(std::forward<Args>(args)...);
    this->log("INFO: %s", strOutput.c_str());
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-06T17:13:07.680

您不能以可移植的方式做到这一点（或者可能在编译时，使用可怕的 C++2011 可变参数模板技巧）。

如果您想在运行时调用可变参数函数，您可能需要使用[libffi](http://sourceware.org/libffi/)。

详细信息是操作系统、编译器、处理器和 ABI 特定的。（但`libffi`正在尝试抽象它们）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-06T17:33:05.807

你制作了另一个接受`va_list`这样工作的函数：

```
void cyclOps::Logger::vLog(const char* format, va_list args)
{
    std::string logMessage = vFormat<10000>(format, args);
    // Do what you want with logMessage
}

template <size_t BufferSize>
std::string cyclOps::Logger::vFormat(const char* format, va_list args)
{
    char buffer[BufferSize];
    vsprintf(buffer, format, args);
    return std::string(buffer);
} 
```

我已经为我的项目在 MSVC 和 GCC 上对此进行了测试。我只能说它对我有用。

这是一个[工作示例](http://ideone.com/itUR6X)。该解决方案适用于 C++03，我相信应该适用于 C++11。

# asp.net - 在Page_Load中经过长时间的处理后如何实现重定向到其他页面？

> ID：13748852
> 
> 赞同：0
> 
> 时间：2012-12-06T17:10:14.283
> 
> 标签：asp.net, async-await, asp.net-4.5

您好，我想在 Page_Load 事件中使用 Asp Net 4.5 语法（ASYNC 和 TASK 关键字）在服务器端进行一些处理后重定向到其他页面。

我以这种方式找到了类似这样的东西来启动支持的任务（但这在旧的 asp .net 中也是可能的）：http: [//msdn.microsoft.com/en-us/library/system.web.ui.page。 registerasynctask.aspx](http://msdn.microsoft.com/en-us/library/system.web.ui.page.registerasynctask.aspx) 但我记得如果我将更改页面上的内容，我无法使用 Response.Redirect 进行重定向。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T22:47:46.117

我已经找到了我需要使用处理程序并在 js 中调用的方法。

[http://www.codeguru.com/csharp/.net/how-to-create-an-asynchronous-http-handler-in-asp.net-4.5.htm](http://www.codeguru.com/csharp/.net/how-to-create-an-asynchronous-http-handler-in-asp.net-4.5.htm)

[http://forums.asp.net/t/1600144.aspx/1](http://forums.asp.net/t/1600144.aspx/1)

# java - 当用户已经登录时从 CAS 登录页面重定向

> ID：13748854
> 
> 赞同：3
> 
> 时间：2012-12-06T17:10:19.857
> 
> 标签：java, cas

我们使用 CAS 进行身份验证。场景如下：

用户尝试访问网站 www.awesomesite.com/coolthings。

如果用户尚未登录，他们将被带到 www.awesomesite.com/login，这实际上是 CAS 登录。
用户登录并被带到他们试图访问的站点，在本例中为 www.awesomsite.com/coolthings。

现在，如果用户在登录时访问 www.awesomesite.com/login，我想将他们重定向到主页。实际发生的是他们进入登录页面，CAS 响应他们已登录，但他们没有被重定向到任何地方，因为他们已经在 url 处。所以他们只是坐在一个空白的页面上。是否有我可以在 AutenticationFilter 中设置的参数，如果他们已经登录，我可以用来从登录重定向

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T14:46:58.523

我没有看到任何开箱即用的方法来做到这一点，我认为如果没有定义服务，您需要计算默认的 CAS 服务（ *www.awesomesite.com/coolthings ）。*我建议通过覆盖**initialFlowSetupAction**（在 login-webflow.xml 文件中）来做到这一点。

# javascript - 我的纪元日期转换遗漏了一些东西

> ID：13748858
> 
> 赞同：0
> 
> 时间：2012-12-06T17:10:31.487
> 
> 标签：javascript, date, epoch

我正在拆分一个数组，当我取以毫秒为单位报告为纪元日期的数组中间时。我正在使用[Epoch Converter](http://www.epochconverter.com)测试日期及其有效性。

我运行 date() 对象并乘以 1000 进行调整，但我得到了 4000 年。我已经切换到除法只是为了测试我是否得到太大的数字，年份是正确的，但日期和月份是错了....我必须遗漏一些简单的东西：

```
var jEtrim = item.DTM.split(/[(-]/);
    var date = new Date(jEtrim[1] *1000); 
```

示例输出：Thu Jan 08 44037 07:03:20 GMT-0500（东部标准时间）

这是 jEtrim：`["/Date", "1343151455000", "0400)/"]`

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T17:16:25.457

[`Date`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date)它的参数已经以毫秒为单位，因此您不需要乘以 1000。您只需将其转换为数字：

```
new Date(+"1343151455000") 
```

# php - 使用sql和php回显一篇文章

> ID：13748861
> 
> 赞同：-2
> 
> 时间：2012-12-06T17:10:48.137
> 
> 标签：php

有没有办法可以使用 php 来回显以下 HTML 并将 H2 文本和 P 文本替换为存储在 sqlquery 中的结果？

```
<article class="frEvent" onclick="loadPopup('#frpopup1')"> <!-- Documented within the linked script file. -->
    <h2 class="frEventHeadline">FR Event</h2>
    <hr class="frEventDivider">
    <p class="frEventTagLine">25/12/2012</p>
</article>

$sqlget = "SELECT * FROM frEvents WHERE date >= DATE(now());";
$sqldata = mysqli_query($dbcon, $sqlget) or die('error getting service listings'); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T17:39:03.680

您需要将其作为代码的下一部分：

```
while($row=$result->fetch_assoc()){
  echo '
   <article class="frEvent" onclick="loadPopup(\'#frpopup'.$row['yoursidrow'].'\')">
     <h2 class="frEventHeadline">'.$row['yourseventrow'].'</h2>
     <hr class="frEventDivider">
     <p class="frEventTagLine">'.$row['yoursdaterow'].'</p>
   </article>';
} 
```

# vhdl - 如何从 std_logic_vector 检查像素的偶数和奇数

> ID：13748865
> 
> 赞同：0
> 
> 时间：2012-12-06T17:10:56.310
> 
> 标签：vhdl

我想知道“我有 2 个值，`std_logic_vector`我想检查它的最后一位是否为偶数和奇数，我希望它们都计算像素值的确切位置。这可以通过 case 语句实现吗”。

```
X_cont : std_logic_vector(15 downto 0)
Y_cont : std_logic_vector(15 downto 0) 
```

我只想检查 LSB。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T08:30:19.230

检查两个 LSB 使用 case 是：

```
 process(x_cont, y_cont)
    type res_t is (both_low, one_low, none_low);
    variable result: res_t;
    variable lsbs: std_logic_vector(1 downto 0);
  begin
    lsbs:=x_cont(0) & y_cont(0);
    case (lsbs) is
    when "00" =>
        result:=both_low;
    when "01" | "10" =>
        result:=one_low;
    when others =>      
        result:=none_low;
    end case;

end process; 
```

# eclipse - Eclipse 代码样式格式化程序可以对齐赋值语句吗？

> ID：13748866
> 
> 赞同：2
> 
> 时间：2012-12-06T17:11:05.330
> 
> 标签：eclipse, formatting, code-formatting

Eclipse 在缩进中有一个选项：“类声明中的字段对齐”，它将对齐类成员的分配，如下所示：

```
class Foo {  
   int x    = 3;  
   String y = "abc"  
   long z   = 2;  
} 
```

是否有一个设置可以对方法级别分配执行相同的操作：

```
private void foo() {  
   int x    = 3;  
   String y = "abc"  
   long z   = 2;  
} 
```

我找不到这样的设置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T19:34:05.173

尝试创建一个新的 Java Code Style Formatter 配置文件（Window->Preferences->Java->Code Style->Formatter）或修改一个旧的并检查 Indentation 和 Braces 选项卡。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-28T15:02:47.203

对于未来的访客。

Eclipse 中没有这样的选项，但是，正如[这里](https://stackoverflow.com/a/16957139/2725790)提到的，您可以使用名为[OCDFormat](https://stackoverflow.com/a/16957139/2725790)的插件来对齐选定代码段中的分配和声明。

*   [安装：从github 上的项目页面](https://github.com/eduardp/OCDFormat)下载最新版本的 OCDFormat_*.jar （单击 → Raw → 另存为）并将其添加到您的 Eclipse 插件或 dropins 目录中。

*   用法：选择一段代码，按Ctrl+4。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-11-26T17:11:37.873

Eclipse 代码样式格式化程序无法对齐赋值语句。

[columns4eclipse](http://columns4eclipse.sourceforge.net/)是允许您这样做的插件。我制作了一个 gif 视频来说明它的使用，但我的答案被版主删除了（超过 10k 用户会看到），所以我让你尝试这个插件并自己看看。

# magento - Magento：产品添加到购物车后的自定义 Javascript 警报

> ID：13748871
> 
> 赞同：1
> 
> 时间：2012-12-06T17:11:20.753
> 
> 标签：magento, magento-1.7

我一直在关注各种教程，尝试在客户将产品添加到购物车后使用 Magento 事件观察器显示自定义 Javascript 警报，但似乎什么也得不到。我是否已经接近正确的轨道了？

我的模块：

```
<?xml version="1.0"?>
<config>
    <modules>
        <Shoplio_XS>
            <active>true</active>
            <codePool>local</codePool>
        </Shoplio_XS>
    </modules>
</config> 
```

我的 config.xml：

```
<?xml version="1.0"?>
<config>
    <modules>
        <Shoplio_XS>
            <version>0.1.0</version>
        </Shoplio_XS>
    </modules>
    <frontend>
        <events>
            <sales_quote_product_add_after>
                <observers>
                    <Shoplio_XS_Model_Observer>
                        <type>singleton</type>
                        <class>Shoplio_XS_Model_Observer</class>
                        <method>Mytestmethod</method>
                    </Shoplio_XS_Model_Observer>
                </observers>
            </sales_quote_product_add_after>
        </events>
    </frontend>
</config> 
```

我的observer.php：

```
<?php class Shoplio_XS_Model_Observer
{
    public function Mytestmethod($observer) {
        $event = $observer->getEvent();

        // Javascript Alert Here

    } 
} 
```

我主要关注本教程：http: [//goo.gl/DRwd5](http://goo.gl/DRwd5)

唯一的区别是，我不想在购物车页面上显示任何内容，因为在将产品添加到购物车后，我会将客户留在产品页面上。我只是想在产品添加到购物车后在产品页面上显示自定义 Javascript 警报。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T17:26:56.620

您不能使用 Magento 观察者执行 Javascript，因为观察者代码在服务器端“执行”，然后将结果发送回您的浏览器（而 JS 在浏览器中的客户端完成）

你能做的是

在 app/design/frontend/default/[theme]/template/catalog/product/view.phtml

```
 var productAddToCartForm = new VarienForm('product_addtocart_form');
 productAddToCartForm.submit = function(button, url) {
        if (this.validator.validate()) {

            alert('here');

            var form = this.form;
            var oldUrl = form.action;

            if (url) {
               form.action = url;
            }
            var e = null;
            try {
                this.form.submit();
            } catch (e) {
            }
            this.form.action = oldUrl;
            if (e) {
                throw e;
            }

            if (button && button != 'undefined') {
                button.disabled = true;
            }

        }

 }.bind(productAddToCartForm); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T22:26:58.703

我决定捎带 Magento 核心信息。我首先将核心消息块移动到我的本地文件夹并在第 255 行周围添加以下代码：

/app/code/local/Mage/Core/Block/Messages.php

```
if(strstr($html, 'was added to your shopping cart')) {
    $html.= '<script type="text/javascript">setTimeout("myFunction()",1000);</script>';
} 
```

上面的代码片段确保我的自定义 Javascript 函数仅在核心添加到购物车成功消息出现时才延迟执行。

我在之后添加了它：

```
$html.= ($this->_escapeMessageFlag) ? $this->htmlEscape($message->getText()) : $message->getText(); 
```

然后，在我的 view.phtml 文件中，我添加了以下 Javascript 函数以使用我的自定义消息打开一个模式框：

```
function xsModal() {
    Modalbox.show($('modal-id'), {title: 'My Custom Message', width: 600});
} 
```

奇迹般有效！

# java - Java：使用 n 个变量或使用硬编码数组元素之间是否存在性能差异？

> ID：13748872
> 
> 赞同：4
> 
> 时间：2012-12-06T17:11:21.447
> 
> 标签：java, arrays, performance, hardcoded

我正在为自己制作一个程序，突然出现了这个问题。该程序处理图形，因此我必须牢记性能。

如果我使用多个变量或使用带有硬编码索引的数组，性能是否会有所不同？如果有，哪个更好？

为了显示：

```
R = (X *  3.2406) + (Y * -1.5372) + (Z * -0.4986);
G = (X * -0.9689) + (Y *  1.8758) + (Z *  0.0415);
B = (X *  0.0557) + (Y * -0.2040) + (Z *  1.0570); 
```

或者

```
RGB[0] = (XYZ[0] *  3.2406) + (XYZ[1] * -1.5372) + (XYZ[2] * -0.4986);
RGB[1] = (XYZ[0] * -0.9689) + (XYZ[1] *  1.8758) + (XYZ[2] *  0.0415);
RGB[2] = (XYZ[0] *  0.0557) + (XYZ[1] * -0.2040) + (XYZ[2] *  1.0570); 
```

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-07T01:06:54.547

使用单独的变量很可能会更快。

为什么？JVM 在运行时优化您的代码以使其更快。它跟踪每个变量的流程和值，以了解如何优化代码。例如，它可能会意识到方法的参数永远不会被分配，因此是常量。但它不会对数组的每个元素都这样做。数组只是被认为是一个巨大的可变变量。因此，当使用单独的变量时，您更有可能获得最佳代码。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-06T17:22:18.887

肯定有内存差异。

您的第一个场景使用（假设双打）：

```
8    8               8               8  = 24 bytes
R = (X *  3.2406) + (Y * -1.5372) + (Z * -0.4986);
8                                       = 32 bytes
G = (X * -0.9689) + (Y *  1.8758) + (Z *  0.0415);
8                                       = 40 bytes
B = (X *  0.0557) + (Y * -0.2040) + (Z *  1.0570); 
```

第二种情况使用：

```
12 + 8    12 + 8               8                    8 = 56 bytes
RGB[0] = (XYZ[0] *  3.2406) + (XYZ[1] * -1.5372) + (XYZ[2] * -0.4986);
8                                                     = 64 bytes
RGB[1] = (XYZ[0] * -0.9689) + (XYZ[1] *  1.8758) + (XYZ[2] *  0.0415);
8                                                     = 72 bytes
RGB[2] = (XYZ[0] *  0.0557) + (XYZ[1] * -0.2040) + (XYZ[2] *  1.0570); 
```

参考： [http ://www.javamex.com/tutorials/memory/object_memory_usage.shtml](http://www.javamex.com/tutorials/memory/object_memory_usage.shtml)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-06T17:32:30.200

你应该再想一想：

x,y,z 值从何而来？

你有一个 x[] 一个 y[] 和一个 z[] 坐标数组吗？你在哪里迭代？

```
for (int i = 0; i < len; i++) {
   process(x[i], y[i], z[i];
} 
```

毫无疑问，这在内部迭代会更快：

公共无效进程（双x []，双y []，双z []）{

```
 for (int i = 0; i < len; i++) {
       rbgb[0] = (x[i] * 3.24606 +  y[i] * 1.5372 + z[i] * -0.4986);

    } 
```

}

# c# - 从属性表达式中获取属性的拥有对象

> ID：13748880
> 
> 赞同：5
> 
> 时间：2012-12-06T17:12:01.767
> 
> 标签：c#, lambda

我正在编写一些代码，其最终目的是让您使用属性表达式来设置属性的值，其语法类似于将变量作为 out 或 ref 参数传递。

类似于以下内容：

```
public static foo(()=>Object.property, value); 
```

并且 Object.Property 将被赋予 value 的值。

我正在使用以下代码来获取属性的拥有对象：

```
public static object GetOwningObject<T>(this Expression<Func<T>> @this)
    {
        var memberExpression = @this.Body as MemberExpression;
        if (memberExpression != null)
        {
            var fieldExpression = memberExpression.Expression as MemberExpression;
            if (fieldExpression != null)
            {
                var constExpression = fieldExpression.Expression as ConstantExpression;
                var field = fieldExpression.Member as FieldInfo;
                if (constExpression != null) if (field != null) return field.GetValue(constExpression.Value);
            }
        }
        return null;
    } 
```

因此，当用于 ()=>Object.Property 之类的属性表达式时，这将返回“Object”的实例。我对使用属性表达式有点陌生，似乎有很多不同的方法来完成事情，但我想扩展我到目前为止所拥有的，所以给定一个表达式，例如 ()=>Foo.Bar.Baz将给 Bar，而不是 Foo。我总是想要表达式中的最后一个包含对象。

有任何想法吗？提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-01-03T23:00:19.223

你要做的就是遍历属性链到最外层的对象。下面的示例是不言自明的，它表明扩展方法适用于链式字段和属性：

```
class Foo
{
    public Bar Bar { get; set; }
}

class Bar
{
    public string Baz { get; set; }
}

class FooWithField
{
    public BarWithField BarField;
}

class BarWithField
{
    public string BazField;
}

public static class LambdaExtensions
{
    public static object GetRootObject<T>(this Expression<Func<T>> expression)
    {
        var propertyAccessExpression = expression.Body as MemberExpression;
        if (propertyAccessExpression == null)
            return null;

        //go up through property/field chain
        while (propertyAccessExpression.Expression is MemberExpression)
            propertyAccessExpression = (MemberExpression)propertyAccessExpression.Expression;

        //the last expression suppose to be a constant expression referring to captured variable ...
        var rootObjectConstantExpression = propertyAccessExpression.Expression as ConstantExpression;
        if (rootObjectConstantExpression == null)
            return null;

        //... which is stored in a field of generated class that holds all captured variables.
        var fieldInfo = propertyAccessExpression.Member as FieldInfo;
        if (fieldInfo != null)
            return fieldInfo.GetValue(rootObjectConstantExpression.Value);

        return null;
    }
}

[TestFixture]
public class Program
{
    [Test]
    public void Should_find_root_element_by_property_chain()
    {
        var foo = new Foo { Bar = new Bar { Baz = "text" } };
        Expression<Func<string>> expression = () => foo.Bar.Baz;
        Assert.That(expression.GetRootObject(), Is.SameAs(foo));
    }

    [Test]
    public void Should_find_root_element_by_field_chain()
    {
        var foo = new FooWithField { BarField = new BarWithField { BazField = "text" } };
        Expression<Func<string>> expression = () => foo.BarField.BazField;
        Assert.That(expression.GetRootObject(), Is.SameAs(foo));
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-04-17T11:58:17.680

如果您的项目是 MVC 5 项目并且您有对程序集的引用，`System.Web.Mvc`您可以使用以下内容：

前段时间我写了一个扩展方法来轻松地创建一个多选下拉菜单（基于 bootstrap 4），它看起来像这样：

```
public static MvcHtmlString MultiSelectFor<TModel, TProperty>(this HtmlHelper<TModel> htmlHelper, Expression<Func<TModel, TProperty>> expression)
{
/*The challenge I faced here was that the expression you passed could very well be nested, so in order overcome this, I decompiled the dll to see how MVC does it, and I found this piece of code.*/

 string expressionText = System.Web.Mvc.ExpressionHelper.GetExpressionText((LambdaExpression)expression);
 System.Web.Mvc.ModelMetadata metadata = System.Web.Mvc.ModelMetadata.FromStringExpression(expressionText, htmlHelper.ViewData);

} 
```

该`metadata`对象有一个名为的属性`PropertyName`和另一个名为的属性，该属性`Container`是对容器对象实例的引用。

# jquery - 如何在 Primefaces 的 SelectOneRadio 中使用“checked=true”？

> ID：13748881
> 
> 赞同：1
> 
> 时间：2012-12-06T17:12:02.727
> 
> 标签：jquery, button, primefaces, radio, checked

我想使用 jQuery 来更改 Primefaces 单选按钮的选中状态。但我唯一能设置的是：`disabled=false/true`.

我认为使用 jQuery 可以做到这一点，但我看不到 Radio-Button 内的点，可能是因为 Primefaces 正在为此使用图像。

有人知道如何更改`checked`Primefaces 中单选按钮的状态吗？此外，我必须能够获取单个单选按钮的状态。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T13:52:02.860

SelectOneRadio 没有选中的属性。[见文档](http://www.primefaces.org/docs/api/3.4/index.html?org/primefaces/component/selectoneradio/SelectOneRadio.PropertyKeys.html)。

您似乎[正在寻找 SelectBooleanCheckbox](http://www.primefaces.org/docs/api/3.4/org/primefaces/component/selectbooleancheckbox/SelectBooleanCheckbox.html)，或寻找如何找到SelectBooleanCheckbox[的选中值](https://stackoverflow.com/questions/1941461/how-to-get-the-value-of-checkbox)

[您可以使用此答案中发布](https://stackoverflow.com/questions/8385591/how-to-get-the-selected-option-from-hselectoneradio-using-javascript)的解决方案通过 javascript 获取 SelectOneRadio 的值。可以轻松修改它以获得单选按钮的选定值。

## 但你的问题的真正答案是：

`<p:selectOneRadio>`元素没有经过检查的属性。如果你想要一个，你将不得不扩展组件类。

# networking - 带宽延迟积背后的基本原理是什么

> ID：13748883
> 
> 赞同：14
> 
> 时间：2012-12-06T17:12:05.467
> 
> 标签：networking, tcp

我的理解是带宽延迟产品是指两个端点之间任何时间点“传输中”的最大数据量。

我不明白的是，为什么要将带宽乘以 RTT。带宽是底层介质的函数，例如铜线、防火光学等，RTT 是中间节点的繁忙程度、中间节点应用的任何调度、距离等的函数。RTT 可以改变，但可以考虑实际用途的带宽固定的。那么如何将一个常数值（容量也就是带宽）乘以波动值 (RTT) 来表示传输中的数据总量？

基于此，真的会很慢有很大的容量吗？RTT 的“原因”很可能会开始下降。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-12-06T17:39:35.157

看单位：

*   [带宽] = 字节/秒
*   [往返时间] = 秒
*   [数据量] = 字节

[数据量] = [带宽] * [往返时间]。

就单位而言，它是正确的。语义上，

什么是带宽*往返时间？这是发送者收到第一个确认之前离开发送者的数据量。也就是说，带宽 * 往返时间 = 完美条件下所需的窗口大小。

如果往返时间是从最后一个数据包开始测量的，并且发送方的出站带宽完全稳定且被充分利用，那么测量的窗口大小会准确计算传输中的数据包数量（数据和 ACK 一起）。如果您只想要一个方向，请将数量除以二。

由于往返时间是一个测量量，它自然会波动（并被平滑）。测量的带宽也可能会波动，因此*估计*的传输数据总量也会波动。

请注意，传输中的数据量*可能*随数据传输速率而变化。如果瓶颈是线路延迟，那么 RTT 可以被认为是恒定的，并且传输中的数据量将与其发送到网络的速度成正比。

当然，如果往返时间突然急剧增加，估计的最大值。传输中的数据量也会增加，但这是正确的。如果没有伴随的丢包，滑动窗口*需要*扩大。如果出现丢包，*则需要重新考虑带宽估计（带宽延迟积会相应下降）。*

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-12-06T22:44:53.473

为了补充 Jan Dvorak 的答案，您可以将“大肥管”视为花园软管。我们对管道中有多少水感兴趣。因此，我们将其“带宽”（即它可以输送水的*速度*）乘以软管的截面积，乘以它的长度，即 RTT，即一滴水的“长度”需要从一端到达另一端。结果是软管的体积、管道的体积、“管道中”的数据量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-13T20:11:56.383

**首先，BDP 是用于性能调整的计算值，用于确定可能**未确认/未确认的数据上限。这几乎总是不代表“传输中”数据的数量，而是应用调整参数的目标。如果它代表“在途”数据，那么总是没有性能调整的空间。

RTT 实际上确实会波动。这就是为什么在计算中使用预期的最坏情况 RTT。通过调整到最坏的情况，当 RTT 最差时，吞吐量效率将达到最大值。如果 RTT 得到改善，我们会更快地获得出色的 Acks，管道保持满状态并保持最大吞吐量（效率）。

“满管”是用词不当。目标是保持 Tx 端充满，因为 Rx 包含通常小于传输数据包的 Ack 数据包。

RTT 还聚合了不对称的上行和下行带宽（ADSL、卫星调制解调器、电缆调制解调器等）。

# javascript - 使用 AJAX 提取数据后重新加载 jQuery Colorbox

> ID：13748887
> 
> 赞同：0
> 
> 时间：2012-12-06T17:12:15.743
> 
> 标签：javascript, jquery, ajax, colorbox

我在我的页面上同时使用 colorbox jQuery 插件和 AJAX 来加载异步页面。

在我使用 AJAX 从 .php 文件中提取某些内容后，该 .php 文件的内容不适用于 colorbox。

```
$('a.boxed').colorbox({rel: 'Galleria'});
$('a.iframe').colorbox({iframe: true, width: "80%", height: "80%"}); 
```

这是我在颜色框的 .js 文件中仅有的两行（我正确导入了插件，因为它适用于未从 AJAX 加载的其他元素）。我想创建一个图像，一旦单击，就会使用以下代码打开一个颜色框 iframe：

```
<a href="MYURL" class="iframe"><img src="IMGURL"/></a> 
```

当我单击网页上的按钮时，我使用以下代码通过 AJAX 重新加载：

函数 showPage(page) { var xmlhttp = new XMLHttpRequest(); // Creo variabile XMLHttpRequest per il caricamento asincrono con AJAX

```
xmlhttp.onreadystatechange = function() {
    document.getElementById("post-title").innerHTML = page;
    document.getElementById("post-content").innerHTML = xmlhttp.responseText;
}

xmlhttp.open("GET", page + ".php", true);
xmlhttp.send(); 
```

}

我读到我应该使用 live() 方法，但我发现不推荐使用 jQuery，现在有 on() 方法.. 多么混乱！有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T17:29:56.337

试试这个：

```
function showPage(page) { 
    var xmlhttp = new XMLHttpRequest(); // Creo variabile XMLHttpRequest per il caricamento asincrono con AJAX

    xmlhttp.onreadystatechange = function() {
        document.getElementById("post-title").innerHTML = page;
        document.getElementById("post-content").innerHTML = xmlhttp.responseText;
        $('a.iframe').colorbox({iframe: true, width: "80%", height: "80%"});  // <-- add this line
    }

    xmlhttp.open("GET", page + ".php", true);
    xmlhttp.send();
} 
```

如果在加载新元素之前添加事件处理程序，新元素将不会“接收”事件

# css - Opera (only) - 绝对定位子元素的边距将它推到下一个兄弟元素上，也是绝对定位的

> ID：13748889
> 
> 赞同：0
> 
> 时间：2012-12-06T17:12:24.917
> 
> 标签：css, opera, margin

我有非常简单的标记：

```
<div id="container">
    <div id="content"></div>
    <div id="ta-container">
        <div id="gripper"></div>
        <textarea></textarea>
    </div>
</div>​ 
```

我把它设计得像一个基本的聊天窗口。请在此处查看代码：http: [//jsfiddle.net/pavek/rdxN5/3/](http://jsfiddle.net/pavek/rdxN5/3/)

这在 FF、Chrome、IE 中看起来非常好，但**在 Opera**（12.11，现在最新）中却没有。最令人困惑的是容器内的两个绝对定位的元素如何相互影响——我无法理解这一点。

我想看看这个问题的可能解决方案。注意：我更喜欢避免操纵 div#content 的*高度*。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T18:35:02.940

我不知道为什么，但是您可以通过取消边距来纠正它，并使顶部/右侧/底部/左侧属性反映您希望放置边缘的位置：

[http://jsfiddle.net/rdxN5/4/](http://jsfiddle.net/rdxN5/4/)

```
#content {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 50px;
    margin: 5px 5px 0 5px;
    border: 1px solid red;
} 
```

这只是一个粗略的调整，您必须自己进行一些微调才能使其达到应有的位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T17:46:53.863

使用 Opera hack。

但是，你为什么要使用绝对位置呢？

试试这个：http: [//jsfiddle.net/liccyfuentes/KbxJK/](http://jsfiddle.net/liccyfuentes/KbxJK/)

HTML: ​ CSS: * { -moz-box-sizing:border-box; box-sizing：边框框；}

```
#container {
    margin: 20px;
    width: 200px;
    padding:5px;
    min-height: 300px;
    border: 1px solid blue;
    float:left;            
}

#main-content {
    min-height:248px;
    border:1px solid red;
    float:left;
    width:188px;
}
textarea {
    float:left;
    width:188px;
    margin-top: 5px;
    resize: none;
    border: 1px solid green;
}
​ 
```

# sql - SQL 数据库项目对动态临时表的引用

> ID：13748903
> 
> 赞同：4
> 
> 时间：2012-12-06T17:13:11.793
> 
> 标签：sql, visual-studio-2010, sql-server-2008-r2, database-project

我正在尝试使用现在位于 SQL Server 2008 R2 上的旧数据库，并在 Visual Studio 2010 中为其创建一个数据库项目。有几个存储过程使用了一些“即时”临时表（SELECT * INTO #NewTempTable 的那种）显然这会导致数据库项目中出现一些 SQL04151 引用警告。

有什么方法可以修复或忽略这些特定的警告？我知道直接的答案可能是在过程中实际声明临时表并定义列，但在这一点上，这不是一个选项。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T17:20:25.583

上交[`SET FMTONLY OFF`](http://msdn.microsoft.com/en-us/library/ms173839.aspx)您的存储过程。

来自 MSDN：

> 仅将元数据返回给客户端。可用于在不实际运行查询的情况下测试响应的格式。

您的问题是，默认情况下 Visual Studio 已打开此设置...这允许它在不运行查询的情况下确定响应的格式，但如果使用临时表，这将不起作用。

这是 MS Connect 上对此问题的讨论：[提高 FMTONLY 智能](http://connect.microsoft.com/SQLServer/feedback/details/685048/improve-fmtonly-inteligence)

根据微软的回应，这已在 2012 年修复，但不会在早期版本中解决。

最后，这里有一个关于这个[问题](http://www.sqlservercentral.com/Forums/Topic969503-338-1.aspx)[的相关讨论`FMTONLY`](http://www.sqlservercentral.com/Forums/Topic969503-338-1.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T18:37:21.083

[对于作为SQL Server Data Tools](http://msdn.microsoft.com/en-us/data/tools.aspx)的一部分安装的 VS 2010 的最新数据库项目类型，这似乎不是问题。

尝试安装 SQL Server 数据工具。安装后，您可以通过在解决方案资源管理器中右键单击它来将数据库项目升级到新类型。（新的项目类型向后兼容 SQL 2008 和 SQL 2005，并且还进行了一些重大改进。）

仅供参考，新项目类型有一个非常通用的名称“SQL Server 数据库项目”，您会在“SQL Server”模板组中找到它，而不是“Database > SQL Server”组。

# wso2 - WSO2 BAM 的问题：无法连接到服务器 org.apache.hadoop.hive.cassandra.CassandraException：无法连接到服务器

> ID：13748906
> 
> 赞同：1
> 
> 时间：2012-12-06T17:13:25.847
> 
> 标签：wso2, wso2carbon, wso2bam

在 Centos OS 中，我使用默认配置部署了 BAM 2.0.1 服务器。之后，我配置了 AS 和 ESB 工具箱，我将我的 AS 和 ESB 服务器配置为使用此 BAM。

当我重新启动 BAM 服务器时，我开始在控制台中看到此错误。：

```
TID: [0] [BAM] [2012-12-06 12:06:00,031]  INFO {org.wso2.carbon.analytics.hive.task.HiveScriptExecutorTask} -  Running script executor task for script esb_stats_903\. [Thu Dec 06 12:06:00 CST 2012] {org.wso2.carbon.analytics.hive.task.HiveScriptExecutorTask}
TID: [0] [BAM] [2012-12-06 12:06:00,037]  INFO {org.wso2.carbon.analytics.hive.task.HiveScriptExecutorTask} -  Running script executor task for script service_stats_263\. [Thu Dec 06 12:06:00 CST 2012] {org.wso2.carbon.analytics.hive.task.HiveScriptExecutorTask}
TID: [0] [BAM] [2012-12-06 12:06:00,720] ERROR {org.apache.hadoop.hive.ql.exec.Task} -  FAILED: Error in metadata: MetaException(message:Unable to connect to the server org.apache.hadoop.hive.cassandra.CassandraException: unable to connect to server)
org.apache.hadoop.hive.ql.metadata.HiveException: MetaException(message:Unable to connect to the server org.apache.hadoop.hive.cassandra.CassandraException: unable to connect to server)
        at org.apache.hadoop.hive.ql.metadata.Hive.createTable(Hive.java:546)
        at org.apache.hadoop.hive.ql.exec.DDLTask.createTable(DDLTask.java:3479)
        at org.apache.hadoop.hive.ql.exec.DDLTask.execute(DDLTask.java:225)
        at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:133)
        at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:57)
        at org.apache.hadoop.hive.ql.Driver.launchTask(Driver.java:1334)
        at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:1125)
        at org.apache.hadoop.hive.ql.Driver.run(Driver.java:933)
        at org.apache.hadoop.hive.service.HiveServer$HiveServerHandler.execute(HiveServer.java:201)
        at org.apache.hadoop.hive.jdbc.HiveStatement.executeQuery(HiveStatement.java:187)
        at org.wso2.carbon.analytics.hive.impl.HiveExecutorServiceImpl$ScriptCallable.call(HiveExecutorServiceImpl.java:325)
        at org.wso2.carbon.analytics.hive.impl.HiveExecutorServiceImpl$ScriptCallable.call(HiveExecutorServiceImpl.java:225)
        at java.util.concurrent.FutureTask$Sync.innerRun(Unknown Source)
        at java.util.concurrent.FutureTask.run(Unknown Source)
        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(Unknown Source)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
        at java.lang.Thread.run(Unknown Source)
Caused by: MetaException(message:Unable to connect to the server org.apache.hadoop.hive.cassandra.CassandraException: unable to connect to server)
        at org.apache.hadoop.hive.cassandra.CassandraManager.openConnection(CassandraManager.java:118)
        at org.apache.hadoop.hive.cassandra.CassandraStorageHandler.preCreateTable(CassandraStorageHandler.java:168)
        at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.createTable(HiveMetaStoreClient.java:397)
        at org.apache.hadoop.hive.ql.metadata.Hive.createTable(Hive.java:540)
        ... 16 more
 {org.apache.hadoop.hive.ql.exec.Task}
TID: [0] [BAM] [2012-12-06 12:06:00,720] ERROR {org.apache.hadoop.hive.ql.exec.Task} -  FAILED: Error in metadata: MetaException(message:Unable to connect to the server org.apache.hadoop.hive.cassandra.CassandraException: unable to connect to server)
org.apache.hadoop.hive.ql.metadata.HiveException: MetaException(message:Unable to connect to the server org.apache.hadoop.hive.cassandra.CassandraException: unable to connect to server)
        at org.apache.hadoop.hive.ql.metadata.Hive.createTable(Hive.java:546)
        at org.apache.hadoop.hive.ql.exec.DDLTask.createTable(DDLTask.java:3479)
        at org.apache.hadoop.hive.ql.exec.DDLTask.execute(DDLTask.java:225)
        at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:133)
        at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:57)
        at org.apache.hadoop.hive.ql.Driver.launchTask(Driver.java:1334)
        at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:1125)
        at org.apache.hadoop.hive.ql.Driver.run(Driver.java:933)
        at org.apache.hadoop.hive.service.HiveServer$HiveServerHandler.execute(HiveServer.java:201)
        at org.apache.hadoop.hive.jdbc.HiveStatement.executeQuery(HiveStatement.java:187)
        at org.wso2.carbon.analytics.hive.impl.HiveExecutorServiceImpl$ScriptCallable.call(HiveExecutorServiceImpl.java:325)
        at org.wso2.carbon.analytics.hive.impl.HiveExecutorServiceImpl$ScriptCallable.call(HiveExecutorServiceImpl.java:225)
        at java.util.concurrent.FutureTask$Sync.innerRun(Unknown Source)
        at java.util.concurrent.FutureTask.run(Unknown Source)
        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(Unknown Source)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
        at java.lang.Thread.run(Unknown Source)
Caused by: MetaException(message:Unable to connect to the server org.apache.hadoop.hive.cassandra.CassandraException: unable to connect to server)
        at org.apache.hadoop.hive.cassandra.CassandraManager.openConnection(CassandraManager.java:118)
        at org.apache.hadoop.hive.cassandra.CassandraStorageHandler.preCreateTable(CassandraStorageHandler.java:168)
        at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.createTable(HiveMetaStoreClient.java:397)
        at org.apache.hadoop.hive.ql.metadata.Hive.createTable(Hive.java:540)
        ... 16 more
 {org.apache.hadoop.hive.ql.exec.Task}
TID: [0] [BAM] [2012-12-06 12:06:00,721] ERROR {org.apache.hadoop.hive.ql.Driver} -  FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask {org.apache.hadoop.hive.ql.Driver}
TID: [0] [BAM] [2012-12-06 12:06:00,721] ERROR {org.apache.hadoop.hive.ql.Driver} -  FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask {org.apache.hadoop.hive.ql.Driver}
TID: [0] [BAM] [2012-12-06 12:06:00,724] ERROR {org.wso2.carbon.analytics.hive.impl.HiveExecutorServiceImpl} -  Error while executing Hive script.
Query returned non-zero code: 9, cause: FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask {org.wso2.carbon.analytics.hive.impl.HiveExecutorServiceImpl}
java.sql.SQLException: Query returned non-zero code: 9, cause: FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask
        at org.apache.hadoop.hive.jdbc.HiveStatement.executeQuery(HiveStatement.java:189)
        at org.wso2.carbon.analytics.hive.impl.HiveExecutorServiceImpl$ScriptCallable.call(HiveExecutorServiceImpl.java:325)
        at org.wso2.carbon.analytics.hive.impl.HiveExecutorServiceImpl$ScriptCallable.call(HiveExecutorServiceImpl.java:225)
        at java.util.concurrent.FutureTask$Sync.innerRun(Unknown Source)
        at java.util.concurrent.FutureTask.run(Unknown Source)
        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(Unknown Source)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
        at java.lang.Thread.run(Unknown Source)
TID: [0] [BAM] [2012-12-06 12:06:00,727] ERROR {org.wso2.carbon.analytics.hive.task.HiveScriptExecutorTask} -  Error while executing script : esb_stats_903 {org.wso2.carbon.analytics.hive.task.HiveScriptExecutorTask}
org.wso2.carbon.analytics.hive.exception.HiveExecutionException: Error while executing Hive script.Query returned non-zero code: 9, cause: FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask
        at org.wso2.carbon.analytics.hive.impl.HiveExecutorServiceImpl.execute(HiveExecutorServiceImpl.java:110)
        at org.wso2.carbon.analytics.hive.task.HiveScriptExecutorTask.execute(HiveScriptExecutorTask.java:60)
        at org.wso2.carbon.ntask.core.impl.TaskQuartzJobAdapter.execute(TaskQuartzJobAdapter.java:56)
        at org.quartz.core.JobRunShell.run(JobRunShell.java:213)
        at java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source)
        at java.util.concurrent.FutureTask$Sync.innerRun(Unknown Source)
        at java.util.concurrent.FutureTask.run(Unknown Source)
        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(Unknown Source)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
        at java.lang.Thread.run(Unknown Source)
TID: [0] [BAM] [2012-12-06 12:06:00,726] ERROR {org.apache.hadoop.hive.ql.exec.Task} -  FAILED: Error in metadata: MetaException(message:Unable to connect to the server org.apache.hadoop.hive.cassandra.CassandraException: unable to connect to server)
org.apache.hadoop.hive.ql.metadata.HiveException: MetaException(message:Unable to connect to the server org.apache.hadoop.hive.cassandra.CassandraException: unable to connect to server)
        at org.apache.hadoop.hive.ql.metadata.Hive.createTable(Hive.java:546)
        at org.apache.hadoop.hive.ql.exec.DDLTask.createTable(DDLTask.java:3479)
        at org.apache.hadoop.hive.ql.exec.DDLTask.execute(DDLTask.java:225)
        at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:133)
        at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:57)
        at org.apache.hadoop.hive.ql.Driver.launchTask(Driver.java:1334)
        at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:1125)
        at org.apache.hadoop.hive.ql.Driver.run(Driver.java:933)
        at org.apache.hadoop.hive.service.HiveServer$HiveServerHandler.execute(HiveServer.java:201)
        at org.apache.hadoop.hive.jdbc.HiveStatement.executeQuery(HiveStatement.java:187)
        at org.wso2.carbon.analytics.hive.impl.HiveExecutorServiceImpl$ScriptCallable.call(HiveExecutorServiceImpl.java:325)
        at org.wso2.carbon.analytics.hive.impl.HiveExecutorServiceImpl$ScriptCallable.call(HiveExecutorServiceImpl.java:225)
        at java.util.concurrent.FutureTask$Sync.innerRun(Unknown Source)
        at java.util.concurrent.FutureTask.run(Unknown Source)
        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(Unknown Source)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
        at java.lang.Thread.run(Unknown Source)
Caused by: MetaException(message:Unable to connect to the server org.apache.hadoop.hive.cassandra.CassandraException: unable to connect to server)
        at org.apache.hadoop.hive.cassandra.CassandraManager.openConnection(CassandraManager.java:118)
        at org.apache.hadoop.hive.cassandra.CassandraStorageHandler.preCreateTable(CassandraStorageHandler.java:168)
        at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.createTable(HiveMetaStoreClient.java:397)
        at org.apache.hadoop.hive.ql.metadata.Hive.createTable(Hive.java:540)
        ... 16 more
 {org.apache.hadoop.hive.ql.exec.Task}
TID: [0] [BAM] [2012-12-06 12:06:00,726] ERROR {org.apache.hadoop.hive.ql.exec.Task} -  FAILED: Error in metadata: MetaException(message:Unable to connect to the server org.apache.hadoop.hive.cassandra.CassandraException: unable to connect to server)
org.apache.hadoop.hive.ql.metadata.HiveException: MetaException(message:Unable to connect to the server org.apache.hadoop.hive.cassandra.CassandraException: unable to connect to server)
        at org.apache.hadoop.hive.ql.metadata.Hive.createTable(Hive.java:546)
        at org.apache.hadoop.hive.ql.exec.DDLTask.createTable(DDLTask.java:3479)
        at org.apache.hadoop.hive.ql.exec.DDLTask.execute(DDLTask.java:225)
        at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:133)
        at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:57)
        at org.apache.hadoop.hive.ql.Driver.launchTask(Driver.java:1334)
        at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:1125)
        at org.apache.hadoop.hive.ql.Driver.run(Driver.java:933)
        at org.apache.hadoop.hive.service.HiveServer$HiveServerHandler.execute(HiveServer.java:201)
        at org.apache.hadoop.hive.jdbc.HiveStatement.executeQuery(HiveStatement.java:187)
        at org.wso2.carbon.analytics.hive.impl.HiveExecutorServiceImpl$ScriptCallable.call(HiveExecutorServiceImpl.java:325)
        at org.wso2.carbon.analytics.hive.impl.HiveExecutorServiceImpl$ScriptCallable.call(HiveExecutorServiceImpl.java:225)
        at java.util.concurrent.FutureTask$Sync.innerRun(Unknown Source)
        at java.util.concurrent.FutureTask.run(Unknown Source)
        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(Unknown Source)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
        at java.lang.Thread.run(Unknown Source)
Caused by: MetaException(message:Unable to connect to the server org.apache.hadoop.hive.cassandra.CassandraException: unable to connect to server)
        at org.apache.hadoop.hive.cassandra.CassandraManager.openConnection(CassandraManager.java:118)
        at org.apache.hadoop.hive.cassandra.CassandraStorageHandler.preCreateTable(CassandraStorageHandler.java:168)
        at org.apache.hadoop.hive.metastore.HiveMetaStoreClient.createTable(HiveMetaStoreClient.java:397)
        at org.apache.hadoop.hive.ql.metadata.Hive.createTable(Hive.java:540)
        ... 16 more
 {org.apache.hadoop.hive.ql.exec.Task}
TID: [0] [BAM] [2012-12-06 12:06:00,734] ERROR {org.apache.hadoop.hive.ql.Driver} -  FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask {org.apache.hadoop.hive.ql.Driver}
TID: [0] [BAM] [2012-12-06 12:06:00,734] ERROR {org.apache.hadoop.hive.ql.Driver} -  FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask {org.apache.hadoop.hive.ql.Driver}
TID: [0] [BAM] [2012-12-06 12:06:00,735] ERROR {org.wso2.carbon.analytics.hive.impl.HiveExecutorServiceImpl} -  Error while executing Hive script.
Query returned non-zero code: 9, cause: FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask {org.wso2.carbon.analytics.hive.impl.HiveExecutorServiceImpl}
java.sql.SQLException: Query returned non-zero code: 9, cause: FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask
        at org.apache.hadoop.hive.jdbc.HiveStatement.executeQuery(HiveStatement.java:189)
        at org.wso2.carbon.analytics.hive.impl.HiveExecutorServiceImpl$ScriptCallable.call(HiveExecutorServiceImpl.java:325)
        at org.wso2.carbon.analytics.hive.impl.HiveExecutorServiceImpl$ScriptCallable.call(HiveExecutorServiceImpl.java:225)
        at java.util.concurrent.FutureTask$Sync.innerRun(Unknown Source)
        at java.util.concurrent.FutureTask.run(Unknown Source)
        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(Unknown Source)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
        at java.lang.Thread.run(Unknown Source)
TID: [0] [BAM] [2012-12-06 12:06:00,736] ERROR {org.wso2.carbon.analytics.hive.task.HiveScriptExecutorTask} -  Error while executing script : service_stats_263 {org.wso2.carbon.analytics.hive.task.HiveScriptExecutorTask}
org.wso2.carbon.analytics.hive.exception.HiveExecutionException: Error while executing Hive script.Query returned non-zero code: 9, cause: FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.DDLTask
        at org.wso2.carbon.analytics.hive.impl.HiveExecutorServiceImpl.execute(HiveExecutorServiceImpl.java:110)
        at org.wso2.carbon.analytics.hive.task.HiveScriptExecutorTask.execute(HiveScriptExecutorTask.java:60)
        at org.wso2.carbon.ntask.core.impl.TaskQuartzJobAdapter.execute(TaskQuartzJobAdapter.java:56)
        at org.quartz.core.JobRunShell.run(JobRunShell.java:213)
        at java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source)
        at java.util.concurrent.FutureTask$Sync.innerRun(Unknown Source)
        at java.util.concurrent.FutureTask.run(Unknown Source)
        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(Unknown Source)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
        at java.lang.Thread.run(Unknown Source) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T07:19:20.997

你是否改变了 BAM 中的端口偏移量？如果是这样，Hive 脚本将需要修改 cassandra 端口参数。

# wso2 - 使用 UDDI 的 WSO2 治理注册表

> ID：13748908
> 
> 赞同：0
> 
> 时间：2012-12-06T17:13:27.160
> 
> 标签：wso2, wso2esb, wso2carbon, uddi, juddi

我正在使用 WSO2 Governance Registry 4.5.1。

我想使用 UDDI，我下载了 WSO2 Governance Registry 4.5.1 版本，并按照此处的说明进行操作[http://docs.wso2.org/wiki/display/Governance450/Support+for+UDDI](http://docs.wso2.org/wiki/display/Governance450/Support+for+UDDI)但出现下一个错误：

```
 [2012-12-06 17:11:13,635]  INFO {org.wso2.carbon.core.deployment.DeploymentInter
    ceptor} -  Deploying Axis2 service: UDDIReplicationService {super-tenant}
    [2012-12-06 17:11:16,220] **ERROR {org.wso2.carbon.registry.uddi.servlet.JUDDIRegi
    stryServlet} -  jUDDI registry could not be started.java.lang.ArrayIndexOutOfBou
    ndsException: 0**
    org.apache.commons.configuration.ConfigurationException: java.lang.ArrayIndexOut
    OfBoundsException: 0
        at org.apache.juddi.config.AppConfig.getPersistentConfiguration(AppConfig.java:122)
        at org.apache.juddi.config.AppConfig.loadConfiguration(AppConfig.java:95)
        at org.apache.juddi.config.AppConfig.<init>(AppConfig.java:62)
        at org.apache.juddi.config.AppConfig.getInstance(AppConfig.java:183)
        at org.apache.juddi.config.AppConfig.getConfiguration(AppConfig.java:205)
        at org.apache.juddi.Registry.start(Registry.java:55)
        at org.wso2.carbon.registry.uddi.servlet.JUDDIRegistryServlet.init(JUDDI
RegistryServlet.java:25)
        at org.eclipse.equinox.http.servlet.internal.ServletRegistration.init(Se
rvletRegistration.java:64)
        at org.eclipse.equinox.http.servlet.internal.ProxyServlet.registerServle
t(ProxyServlet.java:142)
        at org.eclipse.equinox.http.servlet.internal.HttpServiceImpl.registerSer
vlet(HttpServiceImpl.java:59)
        at org.wso2.carbon.registry.servlet.internal.RegistryAtomServiceComponen
t.registerJUDDIServlet(RegistryAtomServiceComponent.java:96)
        at org.wso2.carbon.registry.servlet.internal.RegistryAtomServiceComponen
t.setJUDDIRegistryServlet(RegistryAtomServiceComponent.java:123)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) 
```

我忘了任何步骤吗？

有什么建议？？？

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T05:59:05.547

请尝试改用 Governance Registry 4.5.3。4.5.1 版本确实有一些限制，这可能就是你看到这个的原因。然而，即使在 4.5.3 中，也有一些已知问题会影响某些 UDDI 操作，但大多数 UDDI 功能在 4.5.3 中都可以正常工作。

谢谢，塞纳卡。

# vb.net - 如何在返回实现类实例的 vb 泛型接口中创建方法？

> ID：13748909
> 
> 赞同：2
> 
> 时间：2012-12-06T17:13:28.473
> 
> 标签：vb.net, generics, interface

在 Visual Basic 中，我想创建一个接口，其中包含一个返回实现类对象的函数。那是

```
public interface I
  function maker as ???
end interface

public class X
  implements I
  function maker as X
    return new X()
  end function
end class

public class Y
  implements I
  function maker as Y
    return new Y()
  end function
end class 
```

有没有办法这么说？我想我总是可以说`maker`返回 an`I`而不是 an `X`or a `Y`，但是调用者必须强制转换它。我想将接口定义为

```
public interface I(of ii as I) 
```

但是这样做的重点是我可以创建一个使用 的泛型类，`of I`如果我这么说，那么编译器会坚持无限回归`of I(of I(of I...`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T17:33:03.980

不完全是，但你可以这样做：

```
Public Interface I(Of T)
    Function Maker() As T
End Interface

Public Class X
    Implements I(Of X)

    Public Function Maker() As X Implements I.Maker
        Return New X()
    End Function
End Class 
```

或者，像这样：

```
Public Interface I
    Function Maker() As I
End Interface

Public Class X
    Implements I

    Public Function Maker() As I
        Return New X()
    End Function
End Class 
```

这些选项都不会*强制*派生类返回它们自己类型的实例，但它们*允许*您以这种方式实现它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-09T01:31:37.463

这是您需要“奇怪地重复”类型声明的地方：

```
Public Interface I(Of T As I(Of T))
    Function Maker() As T
End Interface

Public Class C
    Implements I(Of C)

    Function Maker() As C Implements I(Of C).Maker
        Return New C
    End Function
End Class

Sub Main
    Dim First As I(Of C) = New C
    Dim Second As C = First.Maker

End Sub 
```

正如史蒂文所说，这仍然不会强制声明类型将自身用作`T`，但至少现在`T`肯定实现了`I`。

# python - Web 应用程序数据库设置

> ID：13748910
> 
> 赞同：0
> 
> 时间：2012-12-06T17:13:30.560
> 
> 标签：python, sqlite, postgresql, heroku, flask-sqlalchemy

首先，我搜索了雅虎并没有找到一个好的答案。

所有的 Flask SQLAlchemy 教程都使用 SQLite，但从我读到的 SQLite 对 Heroku 来说并不是很好——或者至少是雅虎搜索 SQLite Heroku——揭示了它的许多问题？

如果使用 SQLite 实际上没有任何问题，请告诉我。

如何使用 Postgres 和 FlaskSQLAlchemy 设置数据库 - 因为根据我的研究，这就是 Heroku 所支持的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T20:01:51.813

使用 Flask-SQLAlchemy，你可以这样做：

```
from flask import Flask
from flask.ext.sqlalchemy import SQLAlchemy

app = Flask(__name__)
app.config['SQLALCHEMY_DATABASE_URI'] = 'postgresql://username:password@host/dbname'
db = SQLAlchemy(app) 
```

现在你可以使用这个 db 对象来做任何你需要的事情。

阅读此处了解更多信息： [http ://packages.python.org/Flask-SQLAlchemy/config.html#configuration-keys](http://packages.python.org/Flask-SQLAlchemy/config.html#configuration-keys)

# php - 如何在 Zend Framework 2 模型声明中添加 File\MimeType Validator

> ID：13748917
> 
> 赞同：0
> 
> 时间：2012-12-06T17:13:57.347
> 
> 标签：php, validation, zend-form, zend-framework2, zend-validate

实际上我正在开发一个简单的文件上传器。

在 ImageUploader.php 文件中，我定义了 getInputFilter 函数，除非我尝试添加 File\MimeType 验证器，否则一切正常：

```
<?php

namespace Admin\Model;

use Zend\InputFilter\Factory as InputFactory;
use Zend\InputFilter\InputFilter;
use Zend\InputFilter\InputFilterAwareInterface;
use Zend\InputFilter\InputFilterInterface;

use Zend\Validator\File\MimeType; //tried also with use Zend\Validator\File;

[...]
public function getInputFilter()
{
    [...]
    $inputFilter->add($factory->createInput(array(
       'name'     => 'image',
       'required' => true,
       'validators' => array(
            array(
                'name'    => 'MimeType', //tried also with File\MimeType
                'options' => array(
                   'mimeType' => array('image/jpeg'),
                ),
            ),
        ),
    )));
    [...]
} 
```

定义 File\Validator\MimeType 的正确方法是什么？

先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T14:41:45.643

这是我的项目中的一个示例，其中包含一些其他有用的功能（例如重命名）：

```
use Zend\File\Transfer\Adapter\Http,
    Zend\Validator\File\Size,
    Zend\Validator\File\IsImage;

[...]
public function editAction() {    
[...]
  if ($request->isPost()) {
    $params = $this->params()->fromPost();
    $files = $this->params()->fromFiles();

    $images = array();
    if(!empty($files['main_image']['name'])) $images['main_image'] = $files['main_image']['name'];
    if(!empty($files['detailed_image']['name'])) $images['detailed_image'] = $files['detailed_image']['name'];

    if(!empty($images)) {
      $adapter = new Http();
      $size = new Size(array('max'=>1000000));
      $is_image = new IsImage();
      $image_errors = array();
      foreach ($images as $field => $filename) {
        $adapter->setValidators(array($size,$is_image), $filename);
        if (!$adapter->isValid($filename)) {
          $adapter_errors = $adapter->getMessages();
          $errors = array();
          foreach($adapter_errors as $key=>$row) {
            $errors[] = $row;
          }
          if(!empty($errors)) {
            array_push($image_errors, $errors);
            $form->setMessages(array($field => $errors));
          }
        } else {
          $adapter->setDestination(IMAGES_PATH);
          $fileinfo = $adapter->getFileInfo();
          preg_match('/.+\/(.+)/', $fileinfo[$field]['type'], $matches);
          $extension = $matches[1];
          $old_filename = $item->__get($field);
          $new_filename = $item->id.'_'.$field.'.'.$extension;

          $adapter->addFilter('File\Rename',
            array(
              'target' => IMAGES_PATH.$new_filename,
              'overwrite' => true,
            )
          );

          if($adapter->receive($fileinfo[$field]['name'])) {
            if(!empty($old_filename) && $old_filename != $new_filename &&
              file_exists(IMAGES_PATH.$old_filename)) {
              unlink(IMAGES_PATH.$old_filename);
            }
            $params[$field] = $new_filename;
          }
        } 
      }
    }
  }
[...]
}
[...] 
```

然而，可以重构代码以将逻辑移动到某个库或模型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-24T16:04:13.980

不确定您现在使用的是哪个版本，但使用 Zendframework 2.4 您现在可以做到这一点。希望这可以帮助。

```
public function getInputFilter()
{
    if (!$this->inputFilter) {
        $inputFilter = new InputFilter();

        $inputFilter->add(array(
            'name'     => 'fileupload',
            'required' => true,
            'allow_empty' => false,
            'filters'  => array(
                array('name' => 'StripTags'),
                array('name' => 'StringTrim'),
            ),
            'validators' => array(
                array(
                    'name' => 'Zend\Validator\File\UploadFile',
                    'name' => 'Zend\Validator\File\MimeType',
                        'options' => array(
                            'mimeType' => 'audio, video, image',
                        ),
                    ),
                ),
        ));

        $this->inputFilter = $inputFilter;
    }

    return $this->inputFilter;
 } 
```

# nhibernate - Fluent NHibernate：抽象类的映射列表，每个具体类都有表（联合子类）

> ID：13748919
> 
> 赞同：3
> 
> 时间：2012-12-06T17:14:00.360
> 
> 标签：nhibernate, fluent-nhibernate

我在以下情况下遇到问题。

我的班级结构如下：

```
public class Owner
{
    public virtual Guid Id { get; set; }
    public virtual string Name { get; set; }
    public virtual IList<Vehicle> Vehicles { get; set; }
}

public abstract class Vehicle
{
    public virtual long Id { get; set; }
    public virtual string Name { get; set; }
}

public abstract class PoweredVehicle : Vehicle
{
    public virtual string EngineType { get; set; }
}

public class Car : PoweredVehicle
{
    public virtual int Doors { get; set; }
}

public class Truck : PoweredVehicle
{
    public virtual long MaxLoad { get; set; }
}

public class Bicycle : Vehicle
{
    public virtual int FrameSize { get; set; }
} 
```

流畅的映射：

```
public class OwnerMap : ClassMap<Owner>
{
    public OwnerMap()
    {
        Id(x => x.Id).GeneratedBy.GuidComb();
        Map(x => x.Name);
        HasMany(x => x.Vehicles);
    }
}

public class VehicleMap : ClassMap<Vehicle>
{
    public VehicleMap()
    {
        Id(x => x.Id).GeneratedBy.HiLo("10");
        Map(x => x.Name);
        UseUnionSubclassForInheritanceMapping();
    }
}

public class PoweredVehicleMap : SubclassMap<PoweredVehicle>
{
    public PoweredVehicleMap()
    {
        Map(x => x.EngineType);
        Abstract();
    }
}

public class CarMap : SubclassMap<Car>
{
    public CarMap()
    {
        Map(x => x.Doors);
    }
}

public class TruckMap : SubclassMap<Truck>
{
    public TruckMap()
    {
        Map(x => x.MaxLoad);
    }
}

public class BicycleMap : SubclassMap<Bicycle>
{
    public BicycleMap()
    {
        Map(x => x.FrameSize);
    }
} 
```

我插入汽车和自行车。当我尝试插入带有车辆对象列表的所有者（带有汽车和自行车）时，我收到以下错误：

> 异常：NHibernate.Exceptions.GenericADOException：无法插入集合：[NHibernateTest.Owner.Vehicles#8ace95bc-ad80-46d7-94c7-a11f012b67c6][SQL: UPDATE "Vehicle" SET Owner_id = @p0 WHERE Id = @p1] -- -> System.Data.SQLite.SQLiteException：SQLite 错误

由于我为每个具体类设置表，为什么 NHibernate 试图更新一个不存在的表，它代表基类？此方案不支持这种类型的映射吗？

此外，当我从 HasMany 更改为 HasManyToMany 时，这工作正常。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T18:58:49.413

在这种情况下，唯一的选择是`Inverse()`映射。这意味着具体的 Vehicle (Car, Bicycle) 必须关心关系的持久性。

`Vehicle`要启用此功能，请使用新属性扩展类：

```
public abstract class Vehicle
{ 
  ..
  // new owner independent navigation property
  public virtual Guid OwnerId { get; set; } 
} 
```

并扩展车辆的映射

```
public VehicleMap()
{  
  ..
  Map(x => x.OwnerId).Column("Owner_id);
} 
```

最后颠倒持久性责任。不是所有者，但集合项将关心正确的`Owner_id`列更改（当`Vehicle`调用具体的插入/更新时）。

（更多关于逆：[https](https://stackoverflow.com/a/1454445/1679310) ://stackoverflow.com/a/1454445/1679310 ）

```
public OwnerMap()
{
  ..
  HasMany(x => x.Vehicles)
    .Inverse()
    .Cascade.All();
} 
```

当`Vehicle`被添加到`Owner`的集合中时，它`OwnerId`也必须被赋值：

```
owner.Vehicles.Add(car);
car.OwnerId = owner.Id; 
```

# android - GCMRegistrar isRegisteredOnServer

> ID：13748922
> 
> 赞同：0
> 
> 时间：2012-12-06T17:14:22.543
> 
> 标签：android

大家好，GCMRegistrar isRegisteredOnServer 真正发送的是什么？它是否将设备 ID、设备名称、连接的 IP 地址等发送到服务器或其他东西？

例如，它可能会返回像 GCMRegistrar Is registered on server: true

我知道它会发送一个注册 ID，但注册 ID 包含什么，它是否包括谷歌帐户等或只是一个随机 ID？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T14:53:49.090

`GCMRegistrar.isRegisteredOnServer(Context)`只是一种检查本地存储标志（使用 SharedPreferences 实现）的便捷方法，您可以使用`GCMRegistrar.setRegisteredOnServer(Context, boolean)`.

您可以选择为标志指定一个生命周期，使用`GCMRegistrar. setRegisterOnServerLifespan(Context, long)`它会在指定的时间段到期后自动将标志设置为 false。[如文档](http://developer.android.com/reference/com/google/android/gcm/GCMRegistrar.html#DEFAULT_ON_SERVER_LIFESPAN_MS)中所示，默认寿命为 7 天。

# c# - 过滤 DataView 是否过滤 DataSource？

> ID：13748923
> 
> 赞同：0
> 
> 时间：2012-12-06T17:14:23.823
> 
> 标签：c#, .net-4.0, dataview

如果我对 a 应用过滤器`DataView`，它是否`DataSource`也会过滤 a 。例如，如果我在 my 中有 7 行`DataSource`并且我对其进行过滤以便在 a 中看到 3 行`GridView`，那么`DataView.DataSource`现在是 3 行还是仍然保留原来的 7 行？

# android - 如何将外部属性传递给 Android 测试用例？

> ID：13748924
> 
> 赞同：0
> 
> 时间：2012-12-06T17:14:30.580
> 
> 标签：android, unit-testing, functional-testing

我正在编写一个 Android 测试用例，我需要传入存储在 .properties 文件中的用户名和 ID。我尝试将它直接放在我的测试项目的资产目录下的“user.properties”文件中，但这似乎不起作用，因为 getActivity().getAssets().open("user.properties") 会引发 FileNotFound 异常. 一个朋友告诉我，我可以在命令行上使用“-e key value”开关和自定义检测运行器，但这似乎比必要的工作更多。解决这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T17:25:38.190

在发布到 StackOverflow 之前，我真的应该喝咖啡！我的愚蠢是调用：getActivity().getAssets().open("user.properties") 而不是：getInstrumentation().getContext().getAssets().open("user.properties") 问题解决了！

# authentication - 我可以在没有“允许”屏幕的情况下使用 access_token 重定向吗？

> ID：13748930
> 
> 赞同：0
> 
> 时间：2012-12-06T17:14:48.927
> 
> 标签：authentication, oauth, oauth-2.0

我的 API 应该支持“官方”应用程序以及第三方应用程序。对于官方应用程序，我不希望用户明确授予访问权限（登录后）。

我是对的，只要我将 redirect_uri 限制为[http://official.service.tdl](http://official.service.tdl)之类的东西，我就可以跳过“允许”屏幕？或者这是否有我没有想到的安全隐患？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T19:46:57.400

由于重定向 URI 来自客户端浏览器，因此您不能保证有人不会设置他们的浏览器来更改 URI 以使其看起来像是来自您的官方 URI。那么问题就变成了，如果第三方应用程序绕过显式访问，您会遇到什么安全问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T22:31:06.027

对于官方应用，假设它们是机密客户端，您可以使用`client credentials grant`. 听起来官方app和你的API会有预先建立的关系，而且你的组织也控制着访问服务器。在`client credentials grant`客户端中，客户端可以直接与访问服务器对话并获得一个令牌以与您的 API 一起使用。

如果您想在重定向 uri 来自您的公司时绕过用户授权，那么您应该查看[Authorization Code Redirection URI Manipulation](https://www.rfc-editor.org/rfc/rfc6749#section-10.6)，特别是

```
In order to prevent such an attack, the authorization server MUST
ensure that the redirection URI used to obtain the authorization code
is identical to the redirection URI provided when exchanging the
authorization code for an access token.  The authorization server
MUST require public clients and SHOULD require confidential clients
to register their redirection URIs.  If a redirection URI is provided
in the request, the authorization server MUST validate it against the
registered value. 
```

并且您需要确保没有任何与您的重定向 URI 匹配的开放重定向。

或者您可以只让用户授权访问一次并使用刷新令牌，这样他们就不需要重新授权访问。

# entity-framework - 当我向我的实体添加接口时，代码优先进行奇怪的迁移

> ID：13748940
> 
> 赞同：0
> 
> 时间：2012-12-06T17:15:39.130
> 
> 标签：entity-framework, ef-code-first

我首先对代码有一个奇怪的问题：

在项目中，我的实体看起来像这样，并且代码首先进行了很好的迁移。

```
public class MyEntity
{
    public Guid Id { get; set; }
    public string Name { get; set; }
} 
```

我决定在我的项目中添加一个像这样的界面

```
public interface IEntity
{
    Guid Id { get; set; }
    bool IsDeleted { get; set; }
} 
```

我的新课程现在看起来像这样：

```
public class MyEntity : IEntity
{
    public Guid Id { get; set; }
    public string Name { get; set; }
    bool IsDeleted { get; set; }
} 
```

现在，如果我尝试使用 Code First 进行迁移，而不是在此处添加列，则首先执行代码：

*   丢弃外键
*   拖放索引
*   尝试 CreateTable MyEntity 表并中断告诉我该表已存在

知道为什么代码首先尝试这样做吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T18:11:36.340

使用 EF5 我无法让它重现。通常，对于迁移，执行命令的顺序很重要，因为元数据在数据库和模型之间是一致的。

这些操作的正确顺序是：

a) 在填充数据库（即运行应用程序）之前运行 Enable-Migrations、Add-Migration 然后 Update-Database，然后在运行应用程序之前在每次模型更改后运行 Add-Migration 和更新数据库

b）运行应用程序，启用迁移，更改模型，添加迁移，更新数据库，再次确保在每次模型更改后运行更新数据库

另请注意，我使用的是一个非常简单的 DbContext，如下所示：

```
public class EntityContext : DbContext  
{
    public DbSet<MyEntity> MyEntities { get; set; }
} 
```

# javascript - onmouseover() 在 1 秒后调用 onclick？

> ID：13748941
> 
> 赞同：1
> 
> 时间：2012-12-06T17:15:48.347
> 
> 标签：javascript, html, events, onmouseover, onmouseout

我有一个元素：

```
<b onclick="alert('');" onmouseover="this.style.color='red'; setTimeout('........', 1000);" onmouseout="this.style.color='';">123</b> 
```

我需要当元素被鼠标悬停并且 1 秒后鼠标光标继续停留在该元素上方时，该元素的 onclick() 事件应该开始。

换句话说，在 onmouseover() 事件中应该用什么来代替 '.......'？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T17:18:17.913

```
window.countdown = setTimeout(function(){this.click();}, 1000); 
```

此外，您需要清除 mouseout 处理程序中的时间间隔：

```
clearTimeout(countdown); 
```

理想情况下，你会给你的元素一个 ID 并使用新的事件注册模型：

```
var e = document.getElementById('myelement');
e.addEventListener('click',function(){
    alert('');
});
e.addEventListener('mouseenter',function(){
    var self = this;
    this.style.color='red';
    window.countdown = setTimeout(function(){self.click();}, 1000);
});
e.addEventListener('mouseleave',function(){
    this.style.color='';
    clearTimeout(countdown);
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T17:37:42.463

您应该将鼠标悬停事件的间隔作为全局变量启动，以引用鼠标移出事件以清除它，就像@Asad 说的那样。

```
<b onclick = "alert()"
 onmouseover = "window.countdown = setTimeout(function(){this.click();}, 1000);"
 onmouseout = "clearTimeout(countdown)">
 123
</b> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-06T17:39:20.757

您必须做一些额外的工作，而在内联 Javascript 中这对您来说效果不佳。这都是伪代码，所以我不建议复制/粘贴！

```
// We'll need to create an interval and store it
var timerInterval = {}
// And keep track of how many seconds have elapsed   
var timeElapsedInSeconds = 0;

function tick (){
   timeElapsedInSeconds++;
   if (timeElapsedInSeconds > 0){
       // YOUR GREAT CODE HERE
   }
   // Either way, let's be sure to reset everything.
   resetTimer();
}

function hoverOverHandler (){
   // Start our timer on hover 
   timerInterval = window.setInterval(tick, 1000);    
}

function resetTimer () {
   timeElapsedInSeconds = 0;
   window.clearInterval(timerInterval);
}

function hoverOutHandler () {
   // Kill timer on hoverout
   resetTimer();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-06T19:36:49.273

好的，我用动态 id 做了一些技巧，结果如下：

```
<b style="color:red;" onclick="if(this.style.color!='green'){return false;}else{this.style.color='red';} alert(this.parentNode);" onmouseover="if(this.style.color!='green'){var newID='tmpID_'+Math.floor(Math.random() * (10000000)); if(this.id==''){this.id=newID;} setTimeout('top.document.getElementById(\''+this.id+'\').onclick();',1000); this.style.color='green';}" onmouseout="this.style.color='red';">click</b> 
```

跨浏览 =)

# java - java的Makefile问题

> ID：13748942
> 
> 赞同：1
> 
> 时间：2012-12-06T17:15:52.583
> 
> 标签：java, makefile

我需要制作一个 makefile 来编译我的几个 java 文件以提交，但我不知道该怎么做。我没有运气在网上搜索。目前我的文件是

```
JFLAGS = -g
JC = javac
.SUFFIXES: .java .class
.java.class:
        $(JC) $(JFLAGS) $*.java

CLASSES = \
        Proj411.java \
        ExecTime.java \
        Clocks.java \
        Instruction.java \

simulator: Proj411.java

Proj411.java: ExecTime.java Clocks.java Instruction.java

clean:
        $(RM) *.java 
```

我想确保这正在做我想做的事情。Proj411 是我的主文件所在的位置，它依赖于要运行的其他三个文件。

另外，关于 makefile 实际作用的任何解释都可能有所帮助。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T17:20:19.103

Java 项目通常使用 Ant 或 Maven 脚本构建，并且比 Makefile (-horror) 更舒适一些。
因此，尝试迁移到 ant 或 maven。蚂蚁可能更简单一些。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T17:45:11.053

我认为您必须将以下行添加到您的 makefile 中：

```
classes: $(CLASSES:.java=.class) 
```

此外，如果您希望能够在命令行中键入“make”而不是“make Simulator”，则应添加：

```
all: simulator 
```

# android - 新活动开始时会发生什么？

> ID：13748945
> 
> 赞同：-1
> 
> 时间：2012-12-06T17:16:17.213
> 
> 标签：android

我正在从活动中调用 Intent：我想知道当我调用 Intent 时活动会发生什么，我的意思是，它是否被破坏了？暂停？停车？

这就是我所说的意图：

```
Intent intent = new Intent(context,class);
context.startActivity(intent); 
```

我想知道，如果我在一个活动中有一个复选框，例如，我检查了该复选框，然后我进入下一个活动，但是如果我回到上一个活动，则复选框不会像我一样被选中调用意图。
我不知道我是否已经解释了自己，但我希望你能给我一个提示来解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-06T17:24:47.107

默认情况下，活动是停止的，而不是销毁的。如果系统资源不足，它可能会被破坏。

因此，在您的情况下可能发生的情况是，系统资源不足，因此会破坏您的活动。您应该将您的 UI 状态保存在 中`onSaveInstaceState`，并将其恢复为`onRestoreInstanceState`. [在这里](http://developer.android.com/guide/components/activities.html#SavingActivityState)阅读更多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-06T17:18:21.507

意图.putExtra("",""); 在此处保存复选框状态

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-06T17:25:38.883

将复选框的状态放入[共享首选项](http://developer.android.com/reference/android/content/SharedPreferences.html)或静态变量中，一旦您返回该活动，检查其状态并在这种情况下填充它

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-06T17:32:13.023

```
I mean, is it destroyed? onPause? onStop? 
```

`onStop`叫做。

来自 developer.android.com

```
onStop() - Called when the activity is no longer visible to the user. 
```

尝试将复选框的状态保存为静态布尔值`isChecked()`并检查该布尔值`onRestart()`- 当您返回之前的活动时，会调用该值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-06T18:28:36.747

关于保存复选框的状态（无论是由于意图还是屏幕旋转），有许多先前的问题。相同的生成方法适用：

例如： [即使在导航到 android 中的不同活动后，如何保持 CheckBox 的状态？](https://stackoverflow.com/questions/10613325/how-can-i-maintain-the-state-of-a-checkbox-even-after-navigating-to-different-ac)

并且要确定进行的生命周期调用，总是可以通过调用超类来覆盖方法并在调试器中使用断点。看到 Android 生命周期图旁边的动态代码一直对我很有帮助。

# google-maps - 谷歌地图缩放到标记位置

> ID：13748959
> 
> 赞同：-1
> 
> 时间：2012-12-06T17:16:53.530
> 
> 标签：google-maps, google-maps-api-3

不确定这是否可行，但我已经用自定义样式和标记设置了我的地图，我想确保地图显示在这个级别，但可以看到伦敦。为此，我将地图置于与我的标记不同的位置。如果可能，我希望地图缩放到我的位置而不是中心。

```
 var myLatlng = new google.maps.LatLng('51.4525368','0.2481994');

        var mapOptions = {
        center: new google.maps.LatLng('51.4600368','0.0781994'),
        mapTypeId: google.maps.MapTypeId.ROADMAP,
        zoom: 11,
        mapTypeControl: false,
        scrollwheel:false

        }; 
```

另外，如果有人能告诉我为什么我的信息窗口显示所有时髦，我也会很感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T06:24:24.207

很难理解您的问题，但如果我说得对，您将尝试在地图上同时适应伦敦市中心和您的位置，而无需在地图上的某个位置设置中心。如果这是正确的，那么你需要`google.maps.LatLngBounds()`完成它。

```
var bounds= new google.maps.LatLngBounds();
var London= new google.maps.LatLng(//London values);
var myLatLng = new google.maps.LatLng(//your values);
bounds.extend(London);
bounds.extend(myLatLng);
map.fitBounds(bounds); 
```

检查这是否符合您的目的。

# jakarta-ee - 对 Solaris 上的 tomcat 中的 ROOT/父目录的读取访问权限

> ID：13748960
> 
> 赞同：1
> 
> 时间：2012-12-06T17:16:57.807
> 
> 标签：jakarta-ee, tomcat, solaris, sunos

我在 SunOS 5.10 上运行 tomcat7，并且正在 webapp/ROOT/ 目录下开发一个 webapp。我正在尝试在应用程序中查看 webapp/foo 目录是否存在：

```
String invpath = application.getRealPath( "user" ) //I also use this for something else
String soapPath = invpath.substring( 0, invpath.indexOf( "ROOT/user" ) ) + "foo";
            out.print(soapPath);
            //test if SOAP is installed
            File soap = new File( soapPath );
            if( soap.exists() )   //this is the line he doesn't like much
            {//html code} 
```

但是tomcat抛出了我：

`org.apache.jasper.JasperException: An exception occurred processing JSP page /content/home.jsp at line 83`

`java.security.AccessControlException: access denied ("java.io.FilePermission" "/path/to/tomcat/webapps/foo" "read")`

目录的绝对路径是好的。

我确实对该目录中的每个人都具有读取权限，并且当我在 debian 机器上运行此代码时，它运行良好......我几乎不知道 Solaris/SunOS（但我确实很了解 linux），所以我的错误可能非常愚蠢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T19:28:11.930

因此，tomcat 似乎是使用参数启动的，该`-security`参数基本上阻止访问几乎所有内容，除非在安全管理器配置文件 ( `conf/catalina.policy`) 中提及...此处的文档：http: [//tomcat.apache.org/tomcat-7.0-doc/security -manager-howto.html](http://tomcat.apache.org/tomcat-7.0-doc/security-manager-howto.html)

# android - 当 InetAddress 更改时，ServerSocket 会发生什么？

> ID：13748967
> 
> 赞同：1
> 
> 时间：2012-12-06T17:17:20.037
> 
> 标签：android, sockets, serversocket, tcp-ip

我正在编写一个 Android 应用程序，它`ServerSocket`接受来自客户端的连接。现在，当 IP 更改时（由于设备打开和关闭到不同的网络接口），会发生什么`SocketServer`？我看到的是连接保持正常并且我确实收到了消息，但是当我的应用程序崩溃并重新启动时，我看到 Socket BindException: Address already in use。我正在关闭套接字`onPause()`。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-06T17:58:03.230

[`setReuseAddress( true )`](http://docs.oracle.com/javase/1.4.2/docs/api/java/net/ServerSocket.html#setReuseAddress%28boolean%29)在调用[`bind()`](http://docs.oracle.com/javase/1.4.2/docs/api/java/net/ServerSocket.html#bind%28java.net.SocketAddress%29).

# active-directory - 服务器不愿意处理请求 - Active Directory - 通过 C# 添加用户

> ID：13748970
> 
> 赞同：13
> 
> 时间：2012-12-06T17:17:22.470
> 
> 标签：active-directory, active-directory-group

我使用[此页面](http://www.codeproject.com/Articles/18102/Howto-Almost-Everything-In-Active-Directory-via-C#36)中的示例将用户添加到 Active Directory 组，但在执行时出现异常消息“服务器不愿意处理请求”

`dirEntry.Properties["member"].Add(userDn);`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2015-08-28T16:46:03.243

我在尝试将成员添加到组时遇到了类似的问题。专门尝试将组添加到组并获得相同的有用错误“服务器不愿意处理请求” OP 提供的答案对我不起作用。

对我来说，我无法将组添加到我的组的原因是因为我试图添加成员的组是一个“全局”范围的组，而它需要是一个“通用”范围的组。希望这可以帮助某人。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-08-05T12:30:55.390

这个问题花了我很多时间来解决。首先，错误信息看起来像个笑话。其次，没有别的了，只有那条信息。

无论如何，我设法通过以下方式修复它：

1.  确保`userDn`包含整个路径（例如，`"LDAP://server-address/CN=" + userDn + ",OU=optional,DC=your-domain,DC=com"`。这实际上**非常重要**，如果您不提供完整路径，它将**从 HRESULT: 0x80005000 抛出异常**。

2.  替换`dirEntry.Properties["member"].Add(userDn);`为`entry.Invoke("Add", new object[] { userDn });`

然后我想删除一个用户，我希望`entry.Invoke("Remove", new object[] { userDn });`能工作。然而，这个恶魔般的广告只有在你使用**小写“remove”**时才有效，所以`entry.Invoke("remove", new object[] { userDn });`对我有用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-01-01T23:18:07.250

当我的路径与林域名不匹配时，我收到此一般错误消息。例如，如果我的森林域名是`ad.example.com`，并且我正在尝试创建一个组，`CN=Users,DC=example,DC=net`其中一个具有 .com 另一个具有 .net 的路径 - 他们不排队。我需要更正我的组以匹配。我的组路径应该是`CN=Users,DC=example,DC=com`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-02-18T12:30:10.123

[ldapwiki.com](https://ldapwiki.com/wiki/WILL_NOT_PERFORM)描述了“服务器不愿意处理请求”的潜在原因。检查异常的*ExtendedErrorMessage*属性以确定适用的内容。在我的情况下，“00002145：SvcErr：DSID-031A1254，问题 5003 (WILL_NOT_PERFORM)”。以下行解决了该问题：

```
ent.Properties["groupType"].Value = 8; 
```

我错过了设置*groupType*，因此试图在全局组中嵌套一个通用组。[在ldapwiki.com](https://ldapwiki.com/wiki/GroupType)中查找有关 groupType 属性的更多信息

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-06-14T12:09:32.850

请注意，因为 的开头`.properties("distinguished Name")`可能与`.properties("cn")`. 如果用户是用`,`或`;`在 中创建的，则以或`.properties("cn")`开头的`.properties("distinguished Name")`用户名。`\,``\;`

如果您尝试将通过使用找到的用户添加`.properties("cn")`到组中，这可能会出错。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2018-05-31T07:40:12.247

经过几天的搜索，我发现了问题。当您在组中添加用户时，您必须设置“可分辨名称”而不是 LDAP 路径。

你必须这样写：

```
ent.Properties["member"].Add("CN=YourUserName,OU=optional,DC=yourdomain,DC=com"); 
```

这是错误的代码：

```
ent.Properties["member"].Add("LDAP://CN=YourUserName,OU=optional,DC=yourdomain,DC=com"); 
```

此外，当您移除桅杆以保存此规则时

```
ent.Properties["member"].Remove("CN=YourUserName,OU=optional,DC=yourdomain,DC=com"); 
```

PS **ent**是组的**DirectoryEntry**对象

# asp.net-mvc - MVC 模型绑定在 Kendo Grid 上不起作用

> ID：13748971
> 
> 赞同：8
> 
> 时间：2012-12-06T17:17:33.520
> 
> 标签：asp.net-mvc, kendo-ui

在 MVC 项目中，我有以下视图，其中我使用 Kendo Grid

```
<%: Html.Kendo().Grid<Milestone>()
                .Name("MilestonesGrid")
                .Columns(columns =>
                {
                    columns.Bound(p => p.ContractMilestoneID).Hidden();
                    columns.Bound(p => p.MilestoneSN).Title("Κωδικός οροσήμου");
                    columns.Bound(p => p.EstimatedDate).Title("Εκτιμώμενη ημερομηνία");
                    columns.Bound(p => p.RealDate).Title("Πραγματική ημερομηνία");
                    columns.Bound(p => p.MilestoneDescription).Title("Περιγραφή");
                    columns.Bound(p => p.Payment).Title("Πληρωμή");
                    columns.Bound(p => p.PaymentRate).Title("Ποσοστό πληρωμής");
                    columns.Bound(p => p.IsCompleted).Title("Έχει ολοκληρωθεί");
                    columns.Command(command =>
                        {
                            command.Edit()
                                   .Text("Επεξεργασία")
                                   .CancelText("Ακύρωση")
                                   .UpdateText("Αποθήκευση");

                            command.Destroy()
                                   .Text("Διαγραφή");
                        });
                })
                .ToolBar(toolbar => toolbar.Create().Text("Προσθήκη νέου οροσήμου"))
                .Editable(editable => editable.Mode(GridEditMode.InLine))
                .Sortable()
                .Pageable()
                .Filterable()
                .Resizable(resize => resize.Columns(true))
                .DataSource(dataSource => dataSource
                    .Ajax()
                    .ServerOperation(true)
                    .Model(model => model.Id(o => o.ContractMilestoneID))
                    .Model(model => model.Field(o => o.MilestoneSN))
                    .Model(model => model.Field(o => o.EstimatedDate))
                    .Model(model => model.Field(o => o.RealDate))
                    .Model(model => model.Field(o => o.MilestoneDescription))
                    .Model(model => model.Field(o => o.Payment))
                    .Model(model => model.Field(o => o.PaymentRate))
                    .Model(model => model.Field(o => o.IsCompleted))
                    .Batch(true)
                    .Create(create => create.Action("CreateMilestone", "Milestones"))
                    .Read(read => read.Action("DetailsJson", "Milestones", 
                        new { id = ViewBag.ID }))
                    .Update(update => update.Action("UpdateMilestone", "Milestones"))
                    .Destroy(delete => delete.Action("DeleteMilestone", "Milestones")))
%> 
```

我也有一个控制器，我想在剑道网格中保存一个新条目。

```
[HttpPost]
    public ActionResult CreateMilestone([DataSourceRequest] DataSourceRequest request, 
        Milestone milestone)
    {
        if (milestone != null && ModelState.IsValid)
        {
            using (TADCEntities database = new TADCEntities())
            {
                tblSymvaseisOrosima item = new tblSymvaseisOrosima
                {
                    fldEstimatedDate = milestone.EstimatedDate,
                    fldIsCompleted = milestone.IsCompleted,
                    fldMilestoneDescription = milestone.MilestoneDescription,
                    fldMilestoneSN = milestone.MilestoneSN,
                    fldPayment = milestone.Payment,
                    fldPaymentRate = milestone.PaymentRate,
                    fldRealDate = milestone.RealDate,
                    fldStoixeioYpoergouID = milestone.ElementSubProjectID
                };

                database.tblSymvaseisOrosima.Add(item);
                database.SaveChanges();

                return Json(new[] { item }.ToDataSourceResult(request, ModelState));
            }
        }

        return View();
        // should also return json
    } 
```

问题是里程碑类型（控制器中的参数）始终为空，即使我在网格中创建新条目并按保存时输入数据也是如此。知道要做什么才能在里程碑参数中传递输入的数据吗？先感谢您

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-06T18:19:20.077

正如我在 Fiddler 中看到的，参数以`models`前缀发布，因此您必须像这样访问它们：

```
public ActionResult CreateMilestone([DataSourceRequest] DataSourceRequest request,
    [Bind(Prefix="models")] List<Milestone> milestons) 
{
    Milestone milestone = milestons[0];
    .
    .
    .  
} 
```

# php - mysql 特定的 4 位 ID 自动递增 zerofill 并将用户密码添加为最后 4 位

> ID：13748974
> 
> 赞同：0
> 
> 时间：2012-12-06T17:18:02.677
> 
> 标签：php, mysql

我的表结构

```
CREATE TABLE IF NOT EXISTS `patients` (
  `patient_id` int(8) unsigned zerofill NOT NULL AUTO_INCREMENT,
  `pin` int(4) unsigned zerofill NOT NULL,
  `patient_name` varchar(100) COLLATE utf8_bin NOT NULL,
  `patient_global_id` int(50) NOT NULL,
  `patient_dob` date NOT NULL,
  PRIMARY KEY (`patient_id`),
  UNIQUE KEY `pt_global_id` (`patient_global_id`)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8 COLLATE=utf8_bin AUTO_INCREMENT=1 ; 
```

我想要的是让 id 列包含这样的数据

编号：**4395** 0001

用户名：傻瓜

引脚：**4395**

* * *

然而 nextuser 有 id=PIN#0002 其中 pin 列是自动随机的 4 位数字

这在mysql中可行还是我需要php它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T17:21:52.833

您可以使用[`RAND()`](http://dev.mysql.com/doc/refman/5.0/en/mathematical-functions.html#function_rand)-function 获取随机数：

如手册中所述，要获得特定范围内的随机数，您可以使用：

```
 FLOOR(i + RAND() * (j – i)) 
```

其中`i`最小数字`j`是最大数字 + 1。因此，要创建一个四位数的数字，您可以使用：

```
 FLOOR(1000 + RAND() * (10000 – 1000)) 
```

如果你也想有前导零，你可以将它与[`LPAD()`](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_lpad)：

```
 LPAD(FLOOR(RAND() * 10000), 4, '0') 
```

# android - Android 4.1.2 对话框被调用两次

> ID：13748988
> 
> 赞同：14
> 
> 时间：2012-12-06T17:18:41.397
> 
> 标签：android, dialog

当我调用显示对话框时，我的应用程序出现了这个问题，它以某种方式被调用了两次。这只发生在 android 4.1 及更高版本上。较低版本工作正常，所以我不认为这是任何代码问题。

你以前听说过\遇到过这个问题吗？

这里的代码：

```
Button edit = (Button) ad.findViewById(R.id.editBtn);
        edit.setTypeface(roboto);
        edit.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View v) {

                setDate();
                ad.dismiss();
            }
        });

        ad.show();

        ad.setOnDismissListener(new OnDismissListener() {

            @Override
            public void onDismiss(DialogInterface dialog) {
                shiftsActivity.setPressed(true);

            }
        });
    }

    public void setDate() {
    // Initialize and open the set date dialog
    DatePickerDialog setDateDialog = new DatePickerDialog(Shifts.this,
            datePickerListener, dateAndTime.get(Calendar.YEAR),
            dateAndTime.get(Calendar.MONTH),
            dateAndTime.get(Calendar.DAY_OF_MONTH));

    setDateDialog.setTitle("Set Date");
    setDateDialog.show();

}

public void setStartTime() {

    TimePickerDialog setStartTimeDialog = new TimePickerDialog(Shifts.this,
            startTimePicker, dateAndTime.get(Calendar.HOUR),
            dateAndTime.get(Calendar.MINUTE), true);

    setStartTimeDialog.setTitle("Started At:");
    setStartTimeDialog.show();

}

public void setEndTime() {

    TimePickerDialog setEndTimeDialog = new TimePickerDialog(Shifts.this,
            setEndTime, dateAndTime.get(Calendar.HOUR),
            dateAndTime.get(Calendar.MINUTE), true);
    setEndTimeDialog.setTitle("Ended:");
    setEndTimeDialog.show();
}

TimePickerDialog.OnTimeSetListener startTimePicker = new TimePickerDialog.OnTimeSetListener() {

    @Override
    public void onTimeSet(TimePicker view, int hourOfDay, int minute) {
        startIntHours = hourOfDay;
        startIntMinutes = minute;
        editStartTime = String.format("%02d", hourOfDay) + ":"
                + String.format("%02d", minute);
        setEndTime();

    }
};

TimePickerDialog.OnTimeSetListener setEndTime = new TimePickerDialog.OnTimeSetListener() {

    @Override
    public void onTimeSet(TimePicker view, int hourOfDay, int minute) {

        finishIntHours = hourOfDay;
        finsihIntMinutes = minute;

        if (finishIntHours < startIntHours) {
            finishIntHours = finishIntHours + Utility.HOURS_TIME_UNIT;
        }

        if (finsihIntMinutes < startIntMinutes) {
            finsihIntMinutes = finsihIntMinutes + Utility.MINUTES_TIME_UNIT;
        }

        totalHours = finishIntHours - startIntHours;
        totalMinutes = finsihIntMinutes - startIntMinutes;
        Log.i("TotalHours in time picker", "" + totalHours);
        Log.i("Totalminute in time picker", "" + totalMinutes);

        editEndTime = String.format("%02d", hourOfDay) + ":"
                + String.format("%02d", minute);

        replace(Shifts.view, Shifts.position);

    }
}; 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-11T12:17:25.007

根据您的代码，这些方法都不会被调用，因为您从不使用`TimePickerDialogs`.

话虽如此，有一个与`DatePickerDialog`/的行为相关的已知问题`TimePickerDialog`可能相关：[http ://code.google.com/p/android/issues/detail?id=34833](http://code.google.com/p/android/issues/detail?id=34833)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-08-06T14:36:18.797

这是一个基本解决方案，适用于需要 TimeChooserDialog 的人，它不会两次调用侦听器，具有基本选项

```
public static AlertDialog getTimePickerDialog(Context context, final OnTimeSetListener listener, int hour, int minute, boolean is24HFormat) {
    AlertDialog.Builder builder = new AlertDialog.Builder(context);
    final TimePicker timePicker = new TimePicker(context);
    timePicker.setIs24HourView(is24HFormat);
    timePicker.setCurrentHour(hour);
    timePicker.setCurrentMinute(minute);
    builder.setView(timePicker);
    builder.setPositiveButton(android.R.string.ok, new OnClickListener() {
        @Override
        public void onClick(DialogInterface arg0, int arg1) {
            if(null != listener) {
                listener.onTimeSet(timePicker, timePicker.getCurrentHour(), timePicker.getCurrentMinute());
            }
        }
    });
    builder.setNegativeButton(android.R.string.cancel, null);
    return builder.create();
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-07-26T13:24:20.937

如果您查看 android 源代码，似乎 onTimeSet() 在 onStop() 期间被调用。该对话框还在其 onClick() 方法中调用 onTimeSet()。

为了解决这个问题，我必须覆盖对话框关闭和取消功能以设置一个布尔值，我检查是否从按钮单击或关闭/取消调用 onTimeSet

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-11-14T09:53:18.663

TimePicker 也出现了同样的问题。我解决了那个问题。

```
new TimePickerDialog.OnTimeSetListener() {
    @Override
    public void onTimeSet(TimePicker view, int setHour, int setMinute) {  
        if (view.isShown()) {
            // This method will return true only once
        }
    }
}; 
```

iShown() ：

返回此视图及其所有祖先的可见性

如果此视图及其所有祖先都是可见的，则返回 True

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-10T21:07:30.053

我试了一下，如果你仍然有问题，它对我很有用尝试使用`classic singleton`

像这样的东西:) 阅读更多关于它的信息。

```
public void setStartTime() {

    TimePickerDialog setStartTimeDialog = NULL;
    if(setStartTimeDialog == null) {
       new TimePickerDialog(Shifts.this, startTimePicker, dateAndTime.get(Calendar.HOUR),dateAndTime.get(Calendar.MINUTE), true);

    setStartTimeDialog.setTitle("Started At:");
       }
    setStartTimeDialog.show();

} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-09-04T18:35:43.623

不要使用内置的 TimePickerDialog 或 DatePickerDialog。而是创建一个自定义对话框，如此处所示。它简单易用，并且可以正常工作！

```
 AlertDialog.Builder builder = new AlertDialog.Builder(getActivity());
        final TimePicker timePicker = new TimePicker(getActivity());
        builder.setTitle("Set Time");
        builder.setView(timePicker);
        builder.setNegativeButton("Cancel", new OnClickListener() {

            @Override
            public void onClick(DialogInterface dialog, int which) {

            }
        });
        builder.setPositiveButton("OK"), new OnClickListener() {

            @Override
            public void onClick(DialogInterface dialog, int which) {
                int minute = timePicker.getCurrentMinute();
                int hourOfDay = timePicker.getCurrentHour();
            }
        });
        builder.show(); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-01-30T09:08:42.433

我没有违反 super.onClose() 或制作自定义对话框，而是通过包装真实监听器并扩展 TimePickerDialog 来解决它，该对话框启用和禁用从包装器到真实监听器的转发。这不是替代品，但它足够整洁。

```
public class TimePickerDialogCustom extends TimePickerDialog
{
    protected TimePickerDialogOnTimeSetListenerWrapper listenerWrapper;

    public TimePickerDialogCustom(Context context,
            TimePickerDialogOnTimeSetListenerWrapper listener,
            int hourOfDay, int minute, boolean is24HourView)
    {
        super(context, listener, hourOfDay, minute, is24HourView);
        listenerWrapper = listener;
    }
    @Override
    protected void onStop()
    {
        if (listenerWrapper != null)
            listenerWrapper.enabled = false;
        super.onStop();
        if (listenerWrapper != null)
            listenerWrapper.enabled = true;
    }
    public static final class TimePickerDialogOnTimeSetListenerWrapper implements TimePickerDialog.OnTimeSetListener
    {
        private boolean enabled = true;
        private final TimePickerDialog.OnTimeSetListener delegate;

        public TimePickerDialogOnTimeSetListenerWrapper(TimePickerDialog.OnTimeSetListener delegate)
        {
            this.delegate = delegate;
        }
        @Override
        public void onTimeSet(TimePicker view, int hourOfDay, int minute)
        {
            if (enabled)
            {
                this.delegate.onTimeSet(view, hourOfDay, minute);
            }
        }
    }
} 
```

然后使用它：

```
 TimePickerDialogCustom.TimePickerDialogOnTimeSetListenerWrapper listenerWrapper =
            new TimePickerDialogCustom.TimePickerDialogOnTimeSetListenerWrapper(realListener);
    // Create a new instance of DatePickerDialog and return it
    TimePickerDialogCustom dialog = new TimePickerDialogCustom(
            getActivity(),
            listenerWrapper,
            hourOfDay,
            minute,
            DateFormat.is24HourFormat(getActivity())); 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2013-08-07T10:20:13.857

我遇到了两次显示时间选择器的问题。我已经覆盖了 TimePickerDialog 的 onStop() 并解决了这个问题。此外，您不应在覆盖的 onStop() 中调用 super.onStop()。

```
@Override
public void onStop() {
    //super.onStop();
    Log.d(TAG, "onStop of starttime TimePickerDialog.");
} 
```

# android - 在android中制作成人内容过滤器应用程序

> ID：13748989
> 
> 赞同：0
> 
> 时间：2012-12-06T17:18:44.870
> 
> 标签：android, android-layout, android-intent, android-service, android-browser

我制作了一个浏览器，它不允许用户查看任何成人内容。我只使用了这样的匹配器和模式：

```
Matcher m = p.matcher(s);
Pattern p = Pattern.compile("\\b" + Pattern.quote("word which you want to block") + "\\b"); 
```

我的问题是：

是否可以在整个 android 中进行过滤？

例如：我可以提供内容过滤器服务，该服务将在 android 的每个浏览器后面工作吗？

我的想法是从每个浏览器获取 url，因为首先我阅读了网站的全部内容，如果我定义的关键字与内容匹配，那么它将阻止网页，否则它不会中断用户上网。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T17:22:22.323

您有多种选择：

*   使用文件阻止`hosts`（在根设备上）。

*   阻止默认的 Android 浏览器（市场上有几个应用程序）。

# c# - 数据访问层的设计模式

> ID：13748993
> 
> 赞同：12
> 
> 时间：2012-12-06T17:19:19.527
> 
> 标签：c#, .net, design-patterns

你可能会觉得这是作业，对此我很抱歉。我已经搜索但找不到正确的答案。

所以我的问题是：

我有几个班级，每个班级都有一个保存方法。所以我为数据库处理创建了一个单独的类。

```
namespace HospitalMgt.Data
{
    public static class DBConnection
    {
        public static string constr = "Data Source=ABD;Initial Catalog=HospitalMgt;User Id=sa;Password=123";
        public static SqlConnection con;
      //  public static SqlCommand com;

        public static SqlConnection OpenConnection()
        {
            con= new SqlConnection(constr);
            con.Open();
            return con;
        }

    }
} 
```

但是，我认为用 DBConnection 类实现所有类并不合适。

**我的问题 ：**

1.  什么设计模式适合解决这个问题？
2.  将 DBConnection 创建为类是一种好习惯吗？（或者它应该是一个接口）

我发现了一些关于使用工厂方法的 DA 层的文章，但据我所知，这种模式不适合我的情况。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-06T19:11:33.997

通常，如果我不能使用任何现有的框架，我会同时使用 Repository 和 Active 模式。

为简单起见，您可以只使用存储库模式。我通常这样定义它：

```
public interface IEntity<T> { }

//  Define a generic repository interface
public interface IRepository<TKey, TEntity>
    where TEntity : IEntity<TKey>
{
    void Add(TEntity entity);
    void AddRange(IEnumerable<TEntity> entities);
    IEntity<TKey> Get(TKey key);
    IEnumerable<TEntity> GetRange(IEnumerable<TKey> keys);
    IEnumerable<TEntity> GetAll();
    //  ..., Update, Delete methods
}

//  Create an abstract class that will encapsulate the generic code
public abstract class Repository<TKey, TEntity> : IRepository<TKey, TEntity>
    where TEntity : IEntity<TKey>
{
    protected Repository(/*parameter you may need to implement the generic methods, like a ConnectionFactory,  table name, entity type for casts, etc */) { }

    public override void Insert(IEntity<TKey> entity)
    {
        //  do the insert, treat exceptions accordingly and encapsulate them in your own and more concise Exceptions, etc
    }
    //  ...
}

//  Create the entities classes, one for each table, that will represent a row of that table
public class Car : IEntity<string> {/* Properties */}

//  Create a specific repository for each table
//  If the table have a composed key, just create a class representing it
public class CarRepository : Repository<string, Car>
{
    public CarRepository() {/* pass the base parameters */}

    // offer here your specific operations to this table entity
    public IEnumerable<Car> GetByOwner(PersonKey ownerKey)
    {
        //  do stuff
    }
} 
```

显然，在进行自己的实现时，您必须考虑线程安全，以便充分利用事务，特别是跨不同的实体存储库。

```
//  simple example
ITransaction t = TransactionFactory.GetNewTransaction();
t.begin();
try{
    //  create person entity
    personRepository.Add(person, t);
    //  create cars assigned to person
    carRepository.AddRange(cars, t);
    t.commit();
}catch(Exception){
    t.rollback();
} 
```

请确保您真的想创建自己的 DAL，因为它可能会非常复杂，特别是尝试开发最通用的解决方案。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-06T17:30:22.033

首先，我想向您推荐[Jeremy Miller 的文章 Design Patterns for Data Persistence](http://msdn.microsoft.com/en-us/magazine/dd569757.aspx)。

有一些数据访问层模式：

1.  [活动记录模式](http://martinfowler.com/eaaCatalog/activeRecord.html)（[wiki](http://en.wikipedia.org/wiki/Active_record_pattern)，[详细信息](http://msdn.microsoft.com/en-us/magazine/dd419658.aspx#id0070001)）。
2.  [存储库模式](http://martinfowler.com/eaaCatalog/repository.html)（[详细信息](http://msdn.microsoft.com/en-us/library/ff649690.aspx)）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-06T17:26:23.207

我建议使用 ORM、实体框架或 NHibernate 会做得很好。然后您不必担心数据库上下文或创建 SQL 语句。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-06T17:49:37.333

我建议您使用 RepositoryBase 进行所有这些常见操作。如果您决定使用 ORM 进行数据访问，最好考虑基于通用类型存储库的存储库实现。

这是一篇关于它的好文章：

[http://lostechies.com/jimmybogard/2009/09/03/ddd-repository-implementation-patterns/](http://lostechies.com/jimmybogard/2009/09/03/ddd-repository-implementation-patterns/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-02-07T13:55:17.250

它太旧了，但刚刚解决了这个问题，无法抗拒发表我的想法。

我发现带有一些下降 ORM 的 UnitOfWork 存储库是一个好[方法](https://stackoverflow.com/a/45029588/5779732)[。](https://stackoverflow.com/a/45460483/5779732)这可以最大限度地减少大多数问题。

上面链接中提到的 UoW 可以注入到 Repository 中。这增加了使用的灵活性。此外，所有 DB 通信代码都集中在一个地方。该示例不完整，只是一个启动点。

上面链接中提到的存储库模式实际上是一个通用基类。您可以为从它派生的每个具体存储库创建新类。

通用存储库被认为是一种反模式；互联网上有很多文章对此进行了解释。

**为什么通用存储库是反模式的？**

1.  存储库是被建模域的一部分，并且该域不是通用的。
    *   并非每个实体都可以删除。
    *   并非每个实体都可以添加
    *   并非每个实体都有存储库。
    *   查询千差万别；存储库 API 变得与实体本身一样独特。
    *   对于`GetById()`，标识符类型可能不同。
    *   无法更新特定字段 (DML)。
2.  通用查询机制是 ORM 的职责。
    *   大多数 ORM 都公开了与通用存储库非常相似的实现。
    *   存储库应该使用 ORM 公开的通用查询机制来实现实体的特定查询。
3.  无法使用复合键。
4.  无论如何，它会泄漏服务中的 DAL 逻辑。
    *   如果您接受作为参数的谓词标准，则需要从服务层提供。如果这是 ORM 特定的类，它会将 ORM 泄漏到服务中。

我建议您阅读这些（1、2、3、4、5 [）](http://blog.sapiensworks.com/post/2012/04/15/The-Repository-Pattern-Vs-ORM.aspx)[文章](http://blog.sapiensworks.com/post/2012/03/05/The-Generic-Repository-Is-An-Anti-Pattern.aspx)[，](https://ayende.com/blog/3955/repository-is-the-new-singleton)解释[为什么](http://www.ben-morris.com/why-the-generic-repository-is-just-a-lazy-anti-pattern/)[通用](https://rob.conery.io/2014/03/03/repositories-and-unitofwork-are-not-a-good-idea/)存储库是一种反模式。

**解决方案：**

1.  编写一个由具体存储库包装的抽象通用存储库。这样，您可以控制公共接口，但仍然具有来自通用存储库的代码重用优势。
2.  使用通用存储库，但要使用组合而不是继承，并且不要将其作为合同公开给域。

在任何情况下，都不要将 Generic Repository 暴露给调用代码。此外，不要`IQueryable`从具体的存储库中公开。

# git - git/bb - 如何通过用户名完成提交？

> ID：13748994
> 
> 赞同：0
> 
> 时间：2012-12-06T17:19:24.327
> 
> 标签：git, commit, bitbucket

对于一个学校项目，我的团队使用 bitbucket 作为我们的 repo。对于最终文档，我们基本上必须写下谁做了什么。我的教授允许我们粘贴我们的 bb 提交并简要解释提交的内容。

有没有一种简单的方法来获取每个用户的提交？在回购中有很多来自拉取请求的合并消息，我如何从我将获得的提交列表中排除这些消息？

![在此处输入图像描述](../Images/4a2b5a2d33de194b6a38648f1eb51d6f.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T17:30:24.723

在命令行中，您可以使用[shortlog](http://www.kernel.org/pub/software/scm/git/docs/git-shortlog.html)命令获取有关谁做了什么的格式化报告：

```
git shortlog --no-merges 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T17:28:25.533

如果是 Git，您必须**阅读文档- 仔细阅读**

[Git 日志手册页](http://www.kernel.org/pub/software/scm/git/docs/git-log.html)包含所有需要的信息

> git-log - 显示提交日志

```
Commit Limiting
...
--author=<pattern> 
...
--no-merges

    Do not print commits with more than one parent. This is exactly the same as --max-parents=1. 
```

# ruby-on-rails - 在 Gemfile 中使用“gem unicorn”将 Rails 应用程序部署到 Ubuntu 时出错

> ID：13748995
> 
> 赞同：1
> 
> 时间：2012-12-06T17:19:28.710
> 
> 标签：ruby-on-rails, ubuntu, nginx, unicorn

我正在将 Rails 3.2.8 应用程序部署到 Ubuntu。服务器已经使用 Unicorn 和 Nginx 运行该应用程序。独角兽 -v 返回独角兽 v4.4.0

Adn rvm gem 列表显示：独角兽 (4.4.0)

然而，当我手动运行 'gem install unicorn '4.4.0' 时，它会失败并显示以下内容。任何想法为什么？

```
Installing unicorn (4.4.0)
 ** [out :: mydomain.net] with native extensions
 ** [out :: mydomain.net] 
 ** [out :: mydomain.net] Gem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.
 ** [out :: mydomain.net] 
 ** [out :: mydomain.net] /home/eg/.rvm/rubies/ruby-1.9.3-p194/bin/ruby extconf.rb
 ** [out :: mydomain.net] checking for SIZEOF_OFF_T in ruby.h... *** extconf.rb failed ***
 ** [out :: mydomain.net] Could not create Makefile due to some reason, probably lack of
 ** [out :: mydomain.net] necessary libraries and/or headers.  Check the mkmf.log file for more
 ** [out :: mydomain.net] details.  You may need configuration options.
 ** [out :: mydomain.net] 
 ** [out :: mydomain.net] Provided configuration options:
 ** [out :: mydomain.net] --with-opt-dir
 ** [out :: mydomain.net] --with-opt-include
 ** [out :: mydomain.net] --without-opt-include=${opt-dir}/include
 ** [out :: mydomain.net] --with-opt-lib
 ** [out :: mydomain.net] --without-opt-lib=${opt-dir}/lib
 ** [out :: mydomain.net] --with-make-prog
 ** [out :: mydomain.net] --without-make-prog
 ** [out :: mydomain.net] --srcdir=.
 ** [out :: mydomain.net] --curdir
 ** [out :: mydomain.net] --ruby=/home/eg/.rvm/rubies/ruby-1.9.3-p194/bin/ruby
 ** [out :: mydomain.net] /home/eg/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:381:in `try_do': The compiler failed to generate an executable file. (RuntimeError)
 ** [out :: mydomain.net] You have to install development tools first.
 ** [out :: mydomain.net] from /home/eg/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:491:in `block in try_compile'
 ** [out :: mydomain.net] from /home/eg/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:443:in `with_werror'
 ** [out :: mydomain.net] from /home/eg/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:491:in `try_compile'
 ** [out :: mydomain.net] from /home/eg/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:686:in `macro_defined?'
 ** [out :: mydomain.net] from /home/eg/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:822:in `block in have_macro'
 ** [out :: mydomain.net] from /home/eg/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:790:in `block in checking_for'
 ** [out :: mydomain.net] from /home/eg/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:284:in `block (2 levels) in postpone'
 ** [out :: mydomain.net] from /home/eg/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:254:in `open'
 ** [out :: mydomain.net] from /home/eg/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:284:in `block in postpone'
 ** [out :: mydomain.net] from /home/eg/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:254:in `open'
 ** [out :: mydomain.net] from /home/eg/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:280:in `postpone'
 ** [out :: mydomain.net] from /home/eg/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:789:in `checking_for'
 ** [out :: mydomain.net] 
 ** [out :: mydomain.net] from /home/eg/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:821:in `have_macro'
 ** [out :: mydomain.net] from extconf.rb:4:in `<main>'
 ** [out :: mydomain.net] 
 ** [out :: mydomain.net] 
 ** [out :: mydomain.net] Gem files will remain installed in /rails_apps/eg/production/shared/bundle/ruby/1.9.1/gems/unicorn-4.4.0 for inspection.
 ** [out :: mydomain.net] Results logged to /rails_apps/eg/production/shared/bundle/ruby/1.9.1/gems/unicorn-4.4.0/ext/unicorn_http/gem_make.out
 ** [out :: mydomain.net] 
 ** [out :: mydomain.net] An error occurred while installing unicorn (4.4.0), and Bundler cannot continue.
 ** [out :: mydomain.net] Make sure that `gem install unicorn -v '4.4.0'` succeeds before bundling. 
```

这是我*认为*相关的 mkmf.log的内容

```
have_macro: checking for SIZEOF_SIZE_T in ruby.h... -------------------- yes

"gcc -I/home/evergreen/.rvm/rubies/ruby-1.9.3-p194/include/ruby-1.9.1/x86_64-linux -I/home/eg/.rvm/rubies/ruby-1.9.3-p194/include/ruby-1.9.1/ruby/backward -I/home/eg/.rvm/rubies/ruby-1.9.3-p194/include/ruby-1.9.1 -I. -I/home/eg/.rvm/usr/include     -O3 -ggdb -Wextra -Wno-unused-parameter -Wno-parentheses -Wno-long-long -Wno-missing-field-initializers -Wpointer-arith -Wwrite-strings -Wdeclaration-after-statement -Wimplicit-function-declaration  -fPIC   -c conftest.c"
checked program was:
/* begin */
1: #include "ruby.h"
2:
3: #include <ruby.h>
4: /*top*/
5: #ifndef SIZEOF_SIZE_T
6: # error
7: >>>>>> SIZEOF_SIZE_T undefined <<<<<<
8: #endif
/* end */

--------------------

have_macro: checking for SIZEOF_LONG in ruby.h... -------------------- yes 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T06:41:22.623

确保安装要求中的所有内容：

```
rvm get head
rvm requirements 
```

# c# - 试图将类成员公开为只读或公共常量

> ID：13748996
> 
> 赞同：0
> 
> 时间：2012-12-06T17:19:32.773
> 
> 标签：c#, struct, asp.net-4.0, scope

我被一个简单的变量赋值卡住了，让它对我来说有点复杂的唯一条件是我需要结构值是私有的，所以它们不会被修改

为了能够以安全的方式使用结构的值，我正在尝试使用公共`readonly`变量。所以这就是我可以在只读模式下与应用程序共享信息的方式，不应该很简单吗？

我错过了什么？

当应用程序启动时，`Page_Load`我正在调用`SetTablesMetaDetails()`

```
protected void Page_Load(object sender, EventArgs e)
{
    if(!Page.IsPostBack)
    {
      .... some other App inits here
    }

    else
    {

    }    

    // this method should be the one that instanciates the DbTable struct
   //..thus sets the values of tables "Name" and "ID"
   currProjData.setTablesReferences(); 
} 
```

*   ,`struct`将用于分配值：

```
 public class DBMetaDetails
            {
                public struct DbTable
                {
                    public DbTable(string tableName, int tableId): this()
                    {
                        this.TableName = tableName;
                        this.TableID = tableId;
                    }

                    public string TableName { get;  set; }
                    public int TableID { get;  set; }
                }
            } 
```

*   保存值的当前项目类

```
public static class currProjData 
{
    static DBMetaDetails.DbTable CustomersMeta = new DBMetaDetails.DbTable();
    static DBMetaDetails.DbTable TimesMeta = new DBMetaDetails.DbTable();

    public static void SetTablesMetaDetails()
    {

        TimesMeta.TableID = HTtIDs.TblTimes;
        TimesMeta.TableName = HTDB_Tables.TblTimes;

        CustomersMeta.TableID = HTtIDs.TblCustomers;
        CustomersMeta.TableName = HTDB_Tables.TblTimeCPAReport;

    }

    public static readonly int CustomersTid = CustomersMeta.TableID;
    public static readonly string CustomersTblName = CustomersMeta.TableName;

    public static readonly int TimesTid = TimesMeta.TableID;
    public static readonly string TimesTblName = TimesMeta.TableName;
} 
```

我的问题是我需要将这两组表（`Tid`& `TblName`）详细信息暴露给应用程序的其余部分，但是随着应用程序启动它调用`SetTablesMetaDetails()`

并且最后四行没有执行，我尝试将这一部分移入`SetTablesMetaDetails()` ，但它的语法不正确，我收到错误，

**完成任务的正确方法是`CustomersTid`什么？** [（也包括其余 3 个）]

公共静态只读 int CustomersTid = CustomersMeta.TableID;

这就是我所缺少的，因为我不知道如何以与上面的结构相同的方式对其进行初始化......最好在一个方法调用中

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-06T17:22:49.493

如果要在本地修改它们，但要全局读取它们，请在 setter 中添加修饰符：

```
public string TableName { get;  private set; }
public int TableID { get;  private set; } 
```

也可以是`internal`或者`protected`如果你愿意。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-06T17:25:33.593

使用属性

```
public static int CustomersTid { get { return CustomersMeta.TableID; } }
public static string CustomersTblName { get { return CustomersMeta.TableName; } }

public static int TimesTid  { get { return TimesMeta.TableID; } }
public static string TimesTblName  { get { return TimesMeta.TableName; } } 
```

# php - 返回 PHP 和 MySQL 中受影响的行数

> ID：13748997
> 
> 赞同：0
> 
> 时间：2012-12-06T17:19:32.830
> 
> 标签：php, mysql, pdo

> **可能重复：**
> [PHP PDO - Num Rows](https://stackoverflow.com/questions/2700621/php-pdo-num-rows)

我无法返回 PHP 和 MySQL 中受影响的行数：

```
$sql = "SELECT `id` FROM `bookmark` WHERE `userid` = :userid AND `hash` = :hash";
    $sql_do = $db->prepare($sql);
    $sql_do->bindParam(':userid', $userid, PDO::PARAM_INT);
    $sql_do->bindParam(':hash', $hash, PDO::PARAM_STR);
    $sql_do->execute();
    $number = $db->query("SELECT FOUND_ROWS()")->fetchColumn(); 
```

返回 0。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T22:42:34.090

您可以在删除或更新时使用它

```
echo 'I have deleted ' . $db->affectedRows() . ' users'; 
```

或者

```
echo mysql_affected_rows(); 
```