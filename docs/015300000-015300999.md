# StackOverflow 问答 15300000-15300999

# c++ - Trie 中的最短路径

> ID：15300003
> 
> 赞同：3
> 
> 时间：2013-03-08T17:36:43.353
> 
> 标签：c++, algorithm, data-structures, shortest-path, trie

对于数据结构项目，我必须找到像“cat”和“dog”这样的两个词之间的最短路径，但我一次只能更改一个字母。我试图通过实现 trie 来做到这一点，并且可以似乎无法实现最短路径搜索。

猫 -> 婴儿床 -> cog -> 狗

所有单词的长度都相同，我从字典文件中填充它们。我们必须逐字逐句。所以中间的词必须是有效的词。

我认为使用 trie 是不可能的，但有人知道吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-08T17:42:00.643

您想使用[VP-Tree](http://en.wikipedia.org/wiki/VP-tree) ，该算法称为[Levenshtein 距离](http://en.wikipedia.org/wiki/Levenshtein_distance) AC 实现可以在这里找到，代码太长，无法作为答案发布：
[C VP-Tree](http://read.pudn.com/downloads150/sourcecode/math/650936/vptree.c__.htm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T17:43:31.300

对于这类问题，一个更好的数据结构是图。它被称为单词阶梯，您可以在此处查找：[http](http://en.wikipedia.org/wiki/Word_ladder) ://en.wikipedia.org/wiki/Word_ladder 。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-03-08T18:37:10.193

您正在寻找的是一个简单的 BFS。每个单词都是一个图顶点，但甚至不需要构建图，您可以使用单词数组来解决它：

```
words = {"cat", "dog", "dot", "cot"}
mark = {0, 0, 0, 0}
distance = {0, 0, 0, 0}
queue Q
start_word_index = 0; // words[0] -> "cat"
destination_word_index = 1; // words[1] -> "dog"
Q.push(start_word_index)
while(Q is not empty) {
    word_index = Q.pop()
    for each `words[j]` {
        if (difference between `words[word_index]` and `words[j]` is only 1 character) AND
           (`mark[j]` is not 1) {
            mark[j] = 1
            Q.push(j)
            distance[j] = distance[word_index] + 1
        }
    }
}

if mark[destination_word_index] is 0 {
    print "Not reachable"
} else {
    print "Distance is ", distance[destination_word_index]
} 
```

# mobile - 各种设备的移动网页设计

> ID：15300011
> 
> 赞同：0
> 
> 时间：2013-03-08T17:37:25.803
> 
> 标签：mobile, mobile-website, pixels, dpi

我是为移动设备开发网站的新手，并希望从那些比我了解更多的人那里获得一些见解。自从开始这个项目以来，我了解到 iphone 和 Android 之间存在很多差异，我认为这主要是由于设备的像素密度。我已将一些设备查询合并到我的 CSS 中，以确定在显示页面之前用户设备的像素密度。

我正在继续尝试调整 CSS 以适应各种设备上的不同变量，但在一个设备上有效的方法在另一个设备上无效（即：字体大小、行高等）。

我的问题是……决定我的网站在不同设备和操作系统上的显示方式的*变量是什么？*我只知道一个，那就是*像素密度*。除了设备的宽度和高度，还有其他的吗？是否需要设定纵横比？

非常感谢您能给我的任何见解。

我正在开发的网站可以在[http://m.usci.westondev.com](http://m.usci.westondev.com)查看。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T17:43:33.107

要确定网站在不同设备上的外观，您需要设置`devices breakpoints` 一个良好的开始是如下所示的媒体查询

```
 /* 600px/16px = 37.5em */
    @media all and (min-width: 37.5em) {
    ...
    }
    /* 940px/16px = 58.75em */
    @media all and (min-width: 58.75em) {
    ...
    }
    /* 1300px/16px = 81.25em */
    @media all and (min-width: 81.25em) {
    ...
    } 
```

可以在[这里](http://pugetworks.com/blog/2011/04/css-media-queries-for-targeting-different-mobile-devices/)找到更详细的教程，这个[答案](https://stackoverflow.com/a/8745075/623546)也给出了一些漂亮的

# jquery - 使用带有可变位置的 jQuery 创建 IMG

> ID：15300013
> 
> 赞同：1
> 
> 时间：2013-03-08T17:37:44.800
> 
> 标签：jquery, variables, object, position

```
function hitQBlock(obj) {
  var objOne=$(obj),
    posOne = objOne.offset(),        
    posVert = posOne.top + (objOne.height()/2),
    posHoriz = posOne.left + (objOne.width()/2);
  var newCoin = document.createElement('.coin');
  newCoin.attr({
    style: 'position: absolute; top: posVert px; left: posHoriz px; width: 500px; height: 500px;', 
    src: 'http://png-3.findicons.com/files/icons/2297/super_mario/256/retro_coin.png'});
} 
```

**第一个问题：**如何将`newCoin`对象定位到变量`posVert`和定义的位置`posHoriz`？我尝试使用该`.val()`方法，但它似乎在引号内不起作用

**第二个问题：**在函数内部创建自定义类的新对象的更好方法是什么？我在上面找到的方法不能正常工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T18:01:32.177

编辑

我的代码有一个错字，我也修复了它，这里有一个 jsfiddle 显示它可以工作。[http://jsfiddle.net/p9n4X/](http://jsfiddle.net/p9n4X/)

为了获得更好的性能，我会连接一个 html 字符串并将其附加到正文中，如下所示

```
var html = '<img class="coin" style="position: absolute; top: ' + posVert + 'px; left: '+ posHoriz +'px; width: 500px; height: 500px;" src="http://png-3.findicons.com/files/icons/2297/super_mario/256/retro_coin.png" />';

$('body').append(html); 
```

另请注意，我已关注 Archer 关于关闭字符串的评论。

# java - 如何重置未读短信计数器变量？

> ID：15300015
> 
> 赞同：0
> 
> 时间：2013-03-08T17:38:02.983
> 
> 标签：java, android, sms, contentobserver

我有内容观察器，它“观察”“content://sms”中的表变化。我正在开发我的应用程序，检查未读短信，它工作正常。我存储在静态变量中的未读消息的值（需要来自另一个类的引用）。

但问题是，当用户导航到消息传递应用程序（SMS 收件箱）时，我需要将此变量重置为零。

有人能指出我正确的方向吗？

提前谢谢..=）

# java - RabbitMQ 挂起队列消费

> ID：15300017
> 
> 赞同：10
> 
> 时间：2013-03-08T17:38:11.993
> 
> 标签：spring-amqp, java, rabbitmq, amqp, spring-amqp

保持持久队列及其绑定但暂停其消费者的最佳方法是什么？

用例是：如果我们不断收到一堆我们无法处理的消息（例如数据库已关闭或架构问题），但希望继续聚合到队列。即允许发布但暂停消费。

我可以想到三个解决方案：

1.  我可以让绑定到队列的所有消费者不断拒绝消息并重新排队，但这有点浪费资源，更不用说我已经以编程方式执行了上述逻辑。
2.  我可以呼吁`basic.cancelConsumer`所有消费者（见下文）
3.  或者就[spring-amqp](/questions/tagged/spring-amqp "显示标记为“spring-amqp”的问题")而言，我想我可以调用`shutdown`所有绑定到队列的[SimpleMessageListenerContainers 。](http://static.springsource.org/spring-amqp/api/org/springframework/amqp/rabbit/listener/SimpleMessageListenerContainer.html)

`#1`我们已经在做，因为消息被拒绝了。问题是这最终就像一个无限的while循环失败，如果你记录这个失败，就会浪费更多的资源。

`#3`似乎很理想，但我必须了解所有消息侦听器，然后通知它们关闭。我想我可以使用扇出交换来通知队列需要暂停。我觉得 RabbitMQ 必须为这个逻辑内置一些东西。另一个问题是您可以将多个队列绑定到一个消息容器（并非所有队列都可能需要暂停）。

因为`#2`我知道我可以用它来[取消消费者](http://www.rabbitmq.com/releases/rabbitmq-java-client/v3.0.3/rabbitmq-java-client-javadoc-3.0.3/com/rabbitmq/client/Channel.html#basicCancel%28java.lang.String%29)`consumerTag`，但问题（假设这是执行上述操作的正确方法）是我从哪里获得`consumerTag`s 到队列的列表？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T18:58:16.773

如果您需要停止消费者，那么只需调用基本取消，这就是这样做的方法。

拥有持久队列是您在声明队列时解决的问题：`durable=true` `auto_delete=false`.

当您发布它们时确定具有持久性消息：`delivery_mode=2.`

每个消费者都有自己的消费者标签。每当您从队列中获得消息时，信封应该有消费者标签，您应该使用该标签调用基本取消。

AFAIK，您不能在 conn 1 中有消费者 A，并在不同的连接上为该消费者调用基本取消。我可能在这一点上错了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-16T21:23:43.173

这个解决方案是[spring-amqp](/questions/tagged/spring-amqp "显示标记为“spring-amqp”的问题")特定的。它基本上`#3`来自我的回答。

我维护一个具有`Map<String,CustomSimpleMessageListenerContainer>`自定义扩展队列名称的服务`SimpleMessageListenerContainer`。

在发生一定数量的异常后，我发送一条“恐慌”消息，该消息进入服务接收的特殊队列以关闭消费者。

# java - 在 Java 中重用具有常量后缀的字符串的最佳实践

> ID：15300023
> 
> 赞同：2
> 
> 时间：2013-03-08T17:38:40.090
> 
> 标签：java, android, string, performance, memory-management

在我的应用程序中，我对每 2 秒更新一次的字段值使用常量后缀，例如：“some_value km/h”，其中 km/h 是常量后缀。目前，我只是将值与声明为 的常量后缀进行简单的连接`static final String`，但我知道每 2 秒我都会以这种方式创建新的`String`. 有更好的方法吗？

***编辑：*** 代码示例：

```
public static final String KM_SUFFIX = " km/h";

public void String getFormattedValue(int val) {
    return val + KM_SUFFIX;
} 
```

另一个注意事项：我在移动应用程序上使用它，这个不断变化的字段是列表中包含大量项目的列表项的一部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T18:08:43.417

正如其他人所说，这不会是性能问题。字符串是不可变的，但它们也很快（好吧，无论如何，像这样的短字符串）

也就是说，如果你*真的，真的*不想每次都连接字符串，你必须有两个`TextView`s 来把它们放进去。一个只需要保存静态后缀值“km/h”，你可以更新另一个只有价值。

当然，这样做的问题是您将拥有两倍多的文本字段供操作系统测量、布局和显示。这可能不是什么大问题，但它仍然比创建/处理一两个字符串要多。

* * *

总而言之，*任何一种方法对性能的影响都可以忽略不计。*如，不明显。如果您发现遇到性能问题，请对其进行分析以找出问题所在。这是[过早优化](http://shreevatsa.wordpress.com/2008/05/16/premature-optimization-is-the-root-of-all-evil/)的经典案例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T17:41:14.060

字符串在 Java 中是不可变的。如果您每 2 秒更改一次字符串，那么您每 2 秒就创建一个新字符串，并且没有办法解决这个问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T17:43:47.977

您可以使用单位和 some_value 创建一个 Tempo 类；

然后你有你的 toSTring()- 方法，它返回你的字符串，你不必改变单位，你只需要改变 some_value 字段。

# multithreading - 在 JSF 2 的 requestScoped bean 中显式创建会话

> ID：15300024
> 
> 赞同：7
> 
> 时间：2013-03-08T17:38:47.450
> 
> 标签：multithreading, jakarta-ee, jsf-2, managed-bean

我对在 JSF 2.x 中的 requestScoped bean 中创建会话有疑问。我知道我们不需要在 JSF 2.x 中创建会话，因为我们可以直接使用 sessionScoped bean 来放置用户所需的数据。但我最近被介绍到一个 JSF 代码，其中开发人员创建了会话的实例变量并从 facescontext 获取会话，如下所示

```
 @ManagedBean
 @RequestScoped
 Public class someClass(){

 FacesContext facesContext = FacesContext.getCurrentInstance();
 HttpSession session = (HttpSession) facesContext.getExternalContext().getSession(true);

 public void someFunction(){

 //Some code here..

 session.setAttribute("key","value");

 //Some code here..

 }

  //rest of the code here...
 } 
```

好吧，我告诉他们不应将“会话”作为实例变量，也无需在 JSF 2 中显式获取会话，而是使用 sessionScoped bean。

首先，我给出了一个原因，即“将会话作为实例变量保持不是线程安全的”，而第二个语句我给出的第二个语句是“您正在为已经提供的 JSF 会话做一个解决方法”。

我得到的反驳是，首先是“我们的应用程序是 Web 应用程序，所以不存在多线程问题”。第二个我得到“无论如何，一旦处理请求，会话变量将被清除，所以这里没有**错**。

我没有其他强项来纠正它。所以我的问题是，1）它们是否正确？2) 是否有任何其他具体原因说明我们应该以应该做的方式做事？3）最后，有什么可能促使他们使用这种方式？

有人可以详细说明吗？请纠正我。谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-12T18:27:05.640

[`HttpSession`](http://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpSession.html)Java EE 6 中定义的接口提供了一种用户操作分组方式、识别用户执行的连续操作以及在多个页面请求中存储有关该用户的信息。

## 总体概述

由于会话显然在许多请求之间共享，因此引发了线程安全问题及其影响。在 Servlet 3.0 规范的第 7 章关于 Sessions 中，人们可能会发现处理此类问题的重要性的支持：

> 多个执行请求线程的 servlet 可以同时对同一个会话对象进行主动访问。容器必须确保以线程安全的方式执行表示会话属性的内部数据结构的操作。**开发人员负责对属性对象本身进行线程安全访问**。这将保护 HttpSession 对象内的属性集合免受并发访问，从而消除应用程序导致该集合损坏的机会。

[Servlet 3.0 规范 (JSR-315)，ch。7.7.1](http://download.oracle.com/otn-pub/jcp/servlet-3.0-fr-eval-oth-JSpec/servlet-3_0-final-spec.pdf)，强调我的。

但是，所有这些混乱从何而来？在 AJAX 之前的时代，Web 应用程序开发人员并不太关心同步，因为同一用户同时访问会话的可能性很小。但是随着构建支持 AJAX 的 Web 应用程序的趋势不断上升，来自同一用户的两个请求很可能同时出现，因此也很可能同时访问会话。

作为旁注，值得注意的是，使用`SingleThreadModel`servlet 的接口可以稍微降低线程问题，但对其应用的必要性存在争议（[Servlet 3.0 Specification (JSR-315), ch. 2.2.1](http://download.oracle.com/otn-pub/jcp/servlet-3.0-fr-eval-oth-JSpec/servlet-3_0-final-spec.pdf)）。此外，它已被弃用，因为 Servlet 3.0 和“一次可访问多个 servlet 实例的对象，例如 HttpSession 的实例，可能在任何特定时间对多个 servlet 可用，包括那些实现 SingleThreadModel 的对象”。

## 同步问题

Java EE 6 教程明确指出“可能出现并发访问......当多个 Web 组件访问存储在会话中的对象时”（[Java EE 6 教程，第 II-15 章](http://docs.oracle.com/javaee/6/tutorial/doc/bnafo.html)）。此外，如果我们仔细观察`HttpSession`接口，我们会发现一些允许*将对象绑定到会话*的方法，本质上提供了跨多个用户连接存储用户信息的可能性，从而克服了 HTTP 协议的无状态性。这些方法是：

*   `getAttribute(String name)`（以及现已弃用的`getValue(String name)`）；
*   `setAttribute(String name, Object value)`（以及现已弃用的`putValue(String name, Object value)`;
*   `removeAttribute(String name)`（以及现已弃用的`removeValue(String name)`）；
*   `invalidate()`和
*   接口的其他方法。

最后一个方法使这个会话无效并解除绑定任何对象，持有用户信息，绑定到它，所以它不是我们害怕的。最重要的方法是`Object`从会话中读取、写入和删除 s 的方法，因为这些方法将被不同的线程同时调用以处理/访问数据。

[正如 Brian Goetz 在Java 理论和实践](http://www.ibm.com/developerworks/library/j-jtp09238/index.html)中提到的，并发访问的明显问题是：所有有状态的 Web 应用程序都被破坏了吗？：

> *   原子性故障，其中一个线程正在更新多个数据，而另一个线程在它们处于不一致状态时读取数据，并且
> *   读取线程和写入线程之间的可见性失败，其中一个线程修改数据，但另一个线程看到过时的数据或处于不一致状态的数据。

## 问题的简单解决方案

他后来提出了 5 种减少 Web 应用程序中并发问题的技术，最后指出“在 HttpSession 上序列化请求可以消除许多并发风险”。[Marty Hall 在他关于会话跟踪](http://www.java-programming.info/tutorial/pdf/csajsp2/08-Session-Tracking.pdf)的在线教程中提出了以下关于同步的建议：“使用会话或会话中的值作为同步块的标签”。所以，基本设置是：

```
HttpSession session = request.getSession();
synchronized(session) {
    SomeClass value = (SomeClass)session.getAttribute("someID");
    if (value == null) {
        value = new SomeClass(...);
    }
    doSomethingWith(value);
    session.setAttribute("someID", value);
} 
```

使用此设置，访问会话的重叠请求将被同步。

## *非线程安全*用法示例

```
HttpSession session = request.getSession();
MyClass myClass = (MyClass)session.getAttribute("myClass");
if(myClass != null) {
    myClass.performOperation();
    session.setAttribute("myClass", myClass);
} 
```

## JSF 中对 session 的显式操作的需要

很明显，在会话对象中操作数据可能会导致并发问题。此外，当您选择在将为您隐式管理会话对象的 JSF 框架内进行开发时，它的适用性是值得怀疑的。

最后，您应该将对象放在会话中，而它们*本来*就属于那里。开发人员有时倾向于将对象放入会话中，以按照*他们的方式*解决问题，但通常有更好的方法。Thomas Asel的文章[JSF Best Practices: Scope management for clean session](http://www.oio.de/public/java/jsf-best-practices-javaserver-faces-session-tips.htm)中涵盖了一些错误。

## 缓解线程问题的一些方法

`HttpSession`当使用错误的方式时，大多数线程问题都会出现。从这个角度来看，*线程问题*是*作用域问题*的结果。

例如，如果您将一个值放入应该属于较窄范围（即请求范围或视图范围）的会话中，那么您的代码就会*很容易受到有形概率的并发问题的影响*。相反，如果您的所有会话数据都属于正确的范围，*那么用户遇到并发问题的可能性就会非常低*。

`@SessionScoped`bean 线程安全必须**由开发人员**确保，只要 JSF 最终将这些 bean 存储为属性，`HttpSession`并以托管 bean 的名称作为键。通过名称访问托管 bean 是 JSF 中的一种便利，据我所知，这是由`session.getAttribute("managedBeanName")`.

在这种情况下，如果用户在会话中放置了正确的数据并正确管理它（我的意思是没有解决应该在没有会话干扰的情况下解决的问题），那么我看到的唯一缺点是在 BalusC 的回答中提到的，即引用“紧密耦合和糟糕的设计”。否则（如果我们忽略*JSF 在幕后正确管理 bean 的生命周期*和糟糕的设计问题），用法是类似的。

我想到了一些导致并发问题的范围问题示例：

*   *存储与会话中的用户信息无关*的任何内容（用户身份验证详细信息、他的偏好、国际化 Web 应用程序中的语言环境选择；
*   视图之间的信息共享不应该使用会话来完成：数据的检索应该通过`GET`请求来完成，数据的操作应该通过`POST`请求来完成；在页面转发过程中传递数据可以通过例如 using`<f:setPropertyActionListener>`来完成，在页面重定向过程中传递数据可以通过例如使用`#{flash}`属性来完成；
*   在重复的组件设置中传递信息应该在不干扰会话的情况下完成，通过`<f:attribute>`、`<f:setPropertyActionListener>`、`<f:param>`和信息检索 - 通过操作（侦听器）方法`<f:viewParam>`等。

总而言之，如果您不严格遵循上述列表，您当然有一天会看到错位的输出，但如果您选择正确的数据属于会话范围，则几乎不会看到任何问题。通常，可以在回答***整个用户会话***问题*期间所需的信息时做出这种数据选择。*

 **话虽如此，一个常见的错误是将信息放入会话中以使其在后续视图中可用，检索该信息然后将其从会话中删除，这显然是错误的。我坚信这种方法是由您的对话者采取的。

最后，JSF 正在发展以促进开发任务，所以为什么不使用它的有用特性呢！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-13T20:21:43.227

虽然这在理论上可行，但这只是紧密耦合和糟糕的设计。`@RequestScoped`从to的一个很小的变化`@ViewScoped`就会完全杀死整个 Web 应用程序。这绝对是不对的。支持 bean 类的设计方式应使其在技术上对其声明的范围不敏感。

您永远不应该将`FacesContext`或任何它的工件分配为支持 bean 的属性，而是始终在线程本地范围内访问它，没有任何借口。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-11T21:30:13.113

我不知道`session`获得代码后代码中发生了什么，实际上一切都取决于它。

对于多线程问题，我必须说，如果您只是从会话中读取某些内容，则没有问题。写入会话时，可能会出现巨大的问题。当针对单个会话（AJAX 请求、多个选项卡...）运行多个请求时，将会出现竞争条件，因此您无法确定会话中实际写入的内容。

没有 JSF 会话和 HTTP 会话，只有一个会话，那就是 HTTP 会话。JSF 只是为该会话提供了一个外观，因此从那时起，如何获取会话就没有问题了。在某些情况下向会话添加一些属性是可以的，但应该控制并且必须限制。例如，您可以在此支持 bean 中生成一些数据，并且这些数据应该显示在另一个窗口中（例如一些报告）。您可以将报告数据添加到会话中，并在获得这些数据时在另一个页面上将它们从会话中删除。这是有限的，因为这些页面将在一个流中，并且它们之间没有任何内容。但是，如果出于其他目的调用该方法也是一个问题。**

# mysql - 是否有可能有一个 MySQL 约束要求一个列是唯一的*除非*它等于一个特定的值？

> ID：15300027
> 
> 赞同：6
> 
> 时间：2013-03-08T17:39:01.710
> 
> 标签：mysql, sql

假设我有一个表，我希望 MY_COLUMN 的值是唯一的，除非值是“xyz”。换句话说，MY_COLUMN 在多行中可能是“xyz”，但所有不是“xyz”的值都必须是唯一的。是否可以设置实现这一目标的约束？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T17:44:10.083

根据[文档](http://dev.mysql.com/doc/refman/5.5/en/create-table.html)

> UNIQUE 索引创建一个约束，使得索引中的所有值都必须是不同的。如果您尝试使用与现有行匹配的键值添加新行，则会发生错误。对于所有引擎，UNIQUE 索引允许包含 NULL 的列有多个 NULL 值。

因此，创建一个可为空的列，当您查询表时，只需使用`ISNULL(MY_COLUMN, 'xyz')`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T19:27:22.993

考虑到这一点，我想我会提供我的意见。

正如其他答案正确指出的那样，MySQL 不能有一个具有重复项的唯一索引。

我不会讨论这样一个事实，即这不会容易引起混淆，或者你是否“应该”甚至做这样的事情。

您可以通过在 my_column 上有一个常规索引但也将其设置为 NOT NULL 来实现我认为相同的结果（这很重要，因为没有这个触发器不会在重复索引上引发错误）。然后，您可以为 my_table 创建一个 TRIGGER，如下所示：

```
CREATE TRIGGER my_table_unique_index_with_exception BEFORE INSERT ON my_table
FOR EACH ROW BEGIN
  IF NEW.my_column != 'xyz' THEN
    -- The value isn't 'xyz' so only one instance of this value is allowed
    -- check the count and if the value exists set it to NULL which will thorw 
    -- an error as my_column annot be NULL
    IF (SELECT COUNT(*) FROM my_table WHERE my_table.my_row = NEW.my_column) > 0 THEN
      SET NEW.my_column = NULL;
  END IF;
END 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T17:48:45.457

您不能设置约束来执行此操作，但是如果您在内部执行此操作，比如说一个 java 项目，您可以执行类似的操作

```
If (MY_COLUMN != "xyz"){
    Get records of table with "xyz" in it 
    X = //maping would equal "Select MY_COLUMN from table" (or select * from table depending on your mapping 
```

然后检查是否有任何匹配，最后如果不匹配，运行您的插入语句。如果您正在做这个自由职业者，也许另一列只是一个布尔值，如果为真，那么 MY_COLUMN = 'xyz' 否则查看 MY_COLUMN 并获得 val。这是一个棘手的问题。

# php - PHP Amazon S3 上传带水印

> ID：15300028
> 
> 赞同：0
> 
> 时间：2013-03-08T17:39:05.170
> 
> 标签：php

我目前有一个功能齐全的脚本，可以将图片从我的服务器直接上传到我的 s3 存储桶......

但是，我现在想开始为每张上传的图像添加水印。如您所知，上传到 S3 从来没有真正将它存储在服务器上，就像一个临时文件一样。

基本上，我正在尝试将图像上传到 S3（已经有效），但在此之前，我想为该图像添加水印（无效）。

这是将文件上传到我的 S3 存储桶的工作代码：

```
 if (!class_exists('S3'))require_once('S3.php');

        //AWS access info
        if (!defined('awsAccessKey')) define('awsAccessKey', 'BLAHBLAH');
        if (!defined('awsSecretKey')) define('awsSecretKey', 'BLAHBLAH');

        //instantiate the class
        $s3 = new S3(awsAccessKey, awsSecretKey);

        $fileName = $_FILES['theFile']['name'];
        $fileTempName = $_FILES['theFile']['tmp_name'];
        $fileSize = $_FILES['theFile']['size'];
        $fileExt = substr($fileName, strrpos($fileName, '.') + 1);
        $fileExt = strtolower($fileExt);

        $custompostid = rand(1000000,9999999);
        $imageName = $custompostid.".".$fileExt.""; 

        //move the file
        if ($s3->putObjectFile($fileTempName, "BUCKETNAME", $image, S3::ACL_PUBLIC_READ, array(), $imageType)) { 
        //success
        }
        else{   
        //error
        } 
```

但在上传文件之前，我想为每张图片添加水印。使用此功能：

```
 // getting the image name from GET variable
        $image = $_GET['image'];

        // creating png image of watermark
        $watermark = imagecreatefrompng('watermark.png');  

        // getting dimensions of watermark image
        $watermark_width = imagesx($watermark); 
        $watermark_height = imagesy($watermark); 

        // creting jpg from original image
        $image_path = '/path/to/image/folder/' . $image;
        $image = imagecreatefromjpeg($image_path);
        //something went wrong
        if ($image === false) {
            return false;
        }
        // getting the dimensions of original image
        $size = getimagesize($image_path); 
        // placing the watermark 5px from bottom and right
        $dest_x = $size[0] - $watermark_width - 5; 
        $dest_y = $size[1] - $watermark_height - 5;
        // blending the images together
        imagealphablending($image, true);
        imagealphablending($watermark, true);
        // creating the new image
        imagecopy($image, $watermark, $dest_x, $dest_y, 0, 0, $watermark_width, $watermark_height);
        imagejpeg($image); 
        // destroying and freeing memory
        imagedestroy($image); 
        imagedestroy($watermark); 
```

我想将这两个工作脚本合二为一。我确信它很简单，所有代码都在这里，我只是不知道如何将一个进程链接到另一个进程。这是我能解释的最好的了..谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-08-25T04:24:31.990

**使用 Watermark Codeigniter 上传 S3 图像**

```
 $s3_bucket_name = $this->config->item('s3_bucket_name');
                $s3_access_key = $this->config->item('s3_access_key');
                $s3_secret_key = $this->config->item('s3_secret_key');
                include('amazon/s3_config.php');
                $uploaddir = "images/";
                $actual_image_name = time().'.'.$ext;
                $newname=$uploaddir.$actual_image_name; 

                if (move_uploaded_file($_FILES['photos']['tmp_name'], $newname)) 
                {   
                    $this->watermarkimages($uploaddir,$actual_image_name);
                    $result_image='/'.$newname; 

                    if($s3->putObjectFile($newname, $bucket , $actual_image_name, S3::ACL_PUBLIC_READ) )
                    {
                        $s3file='http://'.$bucket.'.s3.amazonaws.com/'.$actual_image_name;
                        mysql_query("INSERT INTO photos(product_image,product_id) VALUES('$s3file','$prd_id')");
                    } 
                    unlink($newname);
                } 
```

公共函数 watermarkimages($uploaddir,$image_name) {

```
 $masterURL =$uploaddir.$image_name;

        $path='images/watermark3.png';

                $this->load->library('image_lib');              
                $config1['image_library'] = 'gd2'; 
                $config1['source_image']     = $masterURL;
                $config1['wm_type']          = 'overlay';
                $config1['wm_overlay_path']  = $path; 
                $config1['wm_opacity']       = 100;
                $config1['wm_vrt_alignment'] = 'top';
                $config1['wm_hor_alignment'] = 'right';
                $this->image_lib->initialize($config1);
                $this->image_lib->watermark();

} 
```

# magento - 如何在 magento 1.7 的主页上显示超过 5 个特色产品？

> ID：15300036
> 
> 赞同：1
> 
> 时间：2013-03-08T17:39:25.703
> 
> 标签：magento

我已经研究了很多，但我没有找到适合我的解决方案。

我试图在主页的特色产品部分中显示超过 5 件的默认产品数量。

我目前有 10 个项目设置为“新”，但只有 5 个会显示。

关于如何在不更改核心代码的情况下执行此操作的任何提示？

[http://saks-jewelers.com](http://saks-jewelers.com)

（忽略我正在处理的底部的滑块）

**编辑以解释我目前如何显示它们**

我已经使用我创建的模板 phtml 文件列出了它们，然后添加了一个静态块来在我的 hp 上调用它：

```
<?php if (($_products = $this->getProductCollection()) && $_products->getSize()): ?>
<?php $_columnCount = $this->getColumnCount(); ?>
    <?php $i=0; foreach ($_products->getItems() as $_product): ?>
        <?php if ($i++%$_columnCount==0): ?>
        <ul class="featured-products-grid">
        <?php endif ?>
            <a href="<?php echo $_product->getProductUrl() ?>">
            <li >
            <div class="drop-shadow curved curved-hz-2">
                <img class="product-image" src="<?php echo $this->helper('catalog/image')->init($_product, 'small_image')->resize(135) ?>" width="135" height="135" alt="<?php echo $this->htmlEscape($_product->getName()) ?>" />
                <h3 class="product-name"><?php echo $this->htmlEscape($_product->getName()) ?></h3>
                <?php echo $this->getPriceHtml($_product, true, '-new') ?>
        <button type="button" title="View Product" class="button" onclick="setLocation('<?php echo $_product->getProductUrl() ?>')"><span><span>View Product</span></span></button>
        </div>
            </li></a>
        <?php if ($i%$_columnCount==0 || $i==count($_products)): ?>
        </ul>
        <?php endif ?>
    <?php endforeach; ?>
<?php endif; ?> 
```

和静态块代码：

```
<div id="featured-products-container">
  <div class="featured-products-heading"><strong>Featured Products</strong></div>
  <div class="featured-products-heading-line"></div>
    <div id="featured-products-grid">
        {{block type="catalog/product_new" name="home.catalog.product.new" alias="product_homepage" template="catalog/featured-products.phtml"}}
    </div>
<div style="clear:both;"></div>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T21:20:17.130

如果你这样做了`echo count($_products)`，你可能会发现它总是 5。那是因为块正在确定加载什么集合。打开包含该`$this->getProductCollection()`功能的块并按照代码进行操作。该集合可能会通过 Mage::getStoreConfig 调用后端设置来限制在某个地方。我希望这有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T15:42:49.617

如果它用于新产品而不是特色产品（因为您必须为特色产品使用一些扩展名并且您没有声明任何内容）您需要更改线路`\app\code\core\Mage\Catalog\Block\Product\New.php`

```
$products->setOrder(’news_from_date’)->setPageSize(5)->setCurPage(1); 
```

改成

```
$products->setOrder(’news_from_date’)->setPageSize(10)->setCurPage(1); 
```

这只是一个参考代码。您不应更改任何核心文件，因此您需要创建模块并覆盖块类`Mage_Catalog_Block_Product_New`

在您的 .phtml 中使用它作为第一行代码

`$this->setProductsCount(10);`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-09T17:02:04.270

您正在使用块类`Mage_Catalog_Block_Product_New`来展示您的新产品......一切都很好。我们来看看块类定义：

```
class Mage_Catalog_Block_Product_New extends Mage_Catalog_Block_Product_Abstract
{
    protected $_productsCount = null;

    const DEFAULT_PRODUCTS_COUNT = 5; 
```

该`const`定义应该引起您的注意，因为这就是仅显示 5 个产品的原因。在`Mage_Catalog_Block_Product_New::_beforeToHtml()`功能上，集合仅限于一定数量：

`[...]->setPageSize($this->getProductsCount())[...]`

```
public function getProductsCount()
{
    if (null === $this->_productsCount) {
        $this->_productsCount = self::DEFAULT_PRODUCTS_COUNT;
    }
    return $this->_productsCount;
} 
```

“神奇”的东西（作业：深入 Magento 并找出原因）`_productCount`也可以从模板中传递：

```
{{block products_count="2" type="catalog/product_new" name="home.catalog.product.new" alias="product_homepage" template="catalog/featured-products.phtml"}} 
```

它将仅显示 2 个产品。

# cassandra - 运行 cassandra ccm 的问题（cassandra 集群管理器）

> ID：15300040
> 
> 赞同：0
> 
> 时间：2013-03-08T17:39:39.097
> 
> 标签：cassandra

安装 cassandra 集群管理器 (ccm) 并运行它的问题？

我尝试了两种方法：

方法一：

1.  从 github 克隆 ccm，进行设置并运行，
2.  ccm create --cassandra-version 1.2.2 --nodes 3 --start test

但 node1、node2、node3 永远不会启动。ccm status 将所有节点报告为“DOWN”。当我尝试 ccm node1 ring 时，它抱怨，错误：找不到或加载主类 org.apache.cassandra.tools.NodeCmd。

完全相同的场景，代替版本，我从源代码和 CASSANDRA_HOME 目录中安装 cassandra，我这样做，- ccm create --cassandra-dir=/xxxx/cassandra --nodes 4 --start test

有什么线索吗？这是怎么回事？我确实安装了 openjdk-7

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T06:17:01.013

问题是我在 127.0.0.2 和 127.0.0.3 上的环回已关闭，必须使用 ifconfig 命令将状态从关闭更改为开启。完成后，所有节点都使用： ccm create --cassandra-version 1.2.2 --nodes 3 --start test

或者，您可以在创建每个节点后使用以下命令启动它们： - ccm node1 start - ccm node2 start - ccm node3 start

不要忘记检查 - ccm node1 ring - 检查是否所有八卦频道都已启动并共享负载。

谢谢你。

# excel - 返回类型为日期的自定义 Excel VBA 函数

> ID：15300042
> 
> 赞同：0
> 
> 时间：2013-03-08T17:39:49.603
> 
> 标签：excel, vba

我有一个包含多张工作表的工作簿。除摘要表外，所有其他表都有一个动态范围的连续单元格（在一列内），这些单元格存储了一些日期格式的值。我需要动态选择该范围并选择最大日期值。函数应该返回该值。

这是我正在尝试的：

```
Function GetMSDate(Counter As Integer, DesignCtrs() As String, NumOfVendors() As Long, 
          MSDesc() As String, PlanOrActual As String) As Date
    GetMSDate = Application.Max(ThisWorkbook.Worksheets(Counter + 1).Range("A:A")
            .Find(PlanOrActual, SearchOrder:=xlByColumns, searchDirection:=xlNext)
            .EntireRow
            .Find(MSDesc(1), SearchOrder:=xlByColumns, searchDirection:=xlNext)
            .Offset(1, 0).Address & ":" & _
            ThisWorkbook.Worksheets(Counter + 1).Range("A:A")
            .Find(PlanOrActual, SearchOrder:=xlByColumns, searchDirection:=xlNext)
            .EntireRow
            .Find(MSDesc(1), SearchOrder:=xlByColumns, searchDirection:=xlNext)
            .Offset(NumOfVendors(Counter) + 1, 0).Address)
    MsgBox GetMSDate
End Function 
```

我的意图是为`Application.Max()`参数定义动态构造的 Range。在这样做时，找到范围锚，我选择了正确的工作表（`Counter+1`允许正确）；然后在第一列中找到一个特定的“预定义”字符串；选择找到的单元格的整行并在该范围内找到另一个预定义的字符串；然后定义范围从该锚单元下方的单元到由以下定义的偏移量：`NumOfVendors(Counter)+1`

在运行上述内容时，它给了我：

> 在“GetMSDate =”语句中键入不匹配错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T18:23:53.257

要进行调试，请将您的值分配给一个变体变量，然后在分配后输出该变量的 typename()。它应该告诉你为什么它不接受日期。

```
Function GetMSDate(Counter As Integer, DesignCtrs() As String, NumOfVendors() As Long, MSDesc() As String, PlanOrActual As String) As Date
    Dim v as Variant

    v = Application.Max(ThisWorkbook.Worksheets(Counter +
        1).Range("A:A").Find(PlanOrActual, SearchOrder:=xlByColumns,
        searchDirection:=xlNext).EntireRow.Find(MSDesc(1), SearchOrder:=xlByColumns,
        searchDirection:=xlNext).Offset(1, 0).Address & ":" & _
    ThisWorkbook.Worksheets(Counter + 1).Range("A:A").Find(PlanOrActual,
        SearchOrder:=xlByColumns, searchDirection:=xlNext).EntireRow.Find(MSDesc(1),
        SearchOrder:=xlByColumns, searchDirection:=xlNext).Offset(NumOfVendors(Counter)
        + 1, 0).Address)
    debug.print v
    debug.print TypeName(v)
    stop
    MsgBox GetMSDate
End Function 
```

# php - 如何将 csv 中第 1 列的值求和并解析为 csv PHP

> ID：15300044
> 
> 赞同：0
> 
> 时间：2013-03-08T17:39:52.350
> 
> 标签：php, parsing, csv

我想解析一个包含多个代码的csv文件，有些是重复的，我需要对它进行分组并在最后保留一个unic代码。

file.csv CSV 文件：

```
code    data
12345   45
12345   35
12346   2
12347   3
12345   5 
```

文件 2.csv：

```
code,data
12345,85
12346,2
12347,3 
```

PHP 解析 CSV 文件：

```
<?php

$tsvFile = new SplFileObject('file.csv');
$tsvFile->setFlags(SplFileObject::READ_CSV);
$tsvFile->setCsvControl("\t");

$file = fopen('file2.csv', 'w');
$header = array('col1', 'col2');
fputcsv($file, $header, ',', '"');

foreach ($tsvFile as $line => $row) {
    if($line > 0) {
        fputcsv($file, array($row[0], $row[1]), ',', '"');
    }
}
fclose($file);

?> 
```

该脚本只是从制表符解析为逗号，而不是按代码分组。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T17:56:17.773

尝试这个：

```
$newData = array();
foreach ($tsvFile as $line => $row) {
    if ($line > 0) {
        if (isset($newData[$row[0]])) {
            $newData[$row[0]]+= $row[1];
        } else {
            $newData[$row[0]] = $row[1];
        }
    }
}
foreach ($newData as $key => $value) {
    fputcsv($file, array($key, $value), ',', '"');
} 
```

没有测试过这个，但它应该可以工作。

# c# - XML：写入文件为空？

> ID：15300046
> 
> 赞同：-3
> 
> 时间：2013-03-08T17:39:59.600
> 
> 标签：c#, xml, list, xmlserializer, textwriter

到目前为止，我已经对其进行了调试，该列表具有值..但是它没有将它们写出到文件中。

我不确定为什么它是空的。

该类`GameObjects`包含所有字段。

`GameObjectData`只是为了列表。

然后`ChestPlate`继承自`GameObjects`. 这样做的原因是，我正在制作一个游戏，并且其中的所有值`GameObjects`都与`ChestPlate`.

代码如下：

```
[Serializable]
public class GameObjects
{
    //Defines name within XML file:
    [XmlElement("Item_ID")]
    public int Item_ID { get; set; }
    [XmlElement("Item_Name")]
    public string Item_Name = "bob";
    [XmlElement("Item_type")]
    public string Item_type = "GameObject";
    [XmlElement("Item_Level")]
    public int Item_Level = 5;
    [XmlElement("Item_description")]
    public string Item_description = "best description evar";

    public GameObjects(int id, string name, string type, int level, string description)
    {
        this.Item_ID = id;
        this.Item_Name = name;
        this.Item_type = type;
        this.Item_Level = level;
        this.Item_description = description;
    }
} 
```

* * *

```
[Serializable]
[XmlInclude(typeof(GameObjects))]
public class GameObjectData
{
    [XmlArrayItem(typeof(GameObjects))]
    public List<GameObjects> GameList { get; set;}
} 
```

* * *

```
public class ChestPlate : GameObjects
{
    [XmlElement("Armour_Rating")]
    int Armour_Rating = 5;

    public ChestPlate(int Armour_id, string Armour_name, string Armour_type, int Armour_level, string Armour_description)
        : base(Armour_id, Armour_name, Armour_type, Armour_level, Armour_description)
    {
        this.Item_ID = Armour_id;
        this.Item_Name = Armour_name;
        this.Item_type = Armour_type;
        this.Item_Level = Armour_level;
        this.Item_description = Armour_description;       
    }

    public  void SerializeToXML(List<GameObjects> responsedata)
    {        
        GameObjectData f = new GameObjectData();
        f.GameList = new List<GameObjects>();
        f.GameList.Add(new GameObjects { Item_ID = 1234, Item_Name = "OMG", Item_type =  "CHESTPLATE", Item_Level = 5, Item_description = "omg" });

        XmlSerializer serializer = new XmlSerializer(typeof(GameObjectData));
        TextWriter textWriter = new StreamWriter(@"C:\Test.xml");

        serializer.Serialize(textWriter, f);

        Console.WriteLine(f);           
    } 
```

* * *

```
class Program
{
    static void Main(string[] args)
    {
        GameObjects a = new GameObjects();
        ChestPlate b = new ChestPlate();
        List<GameObjects> d = new List<GameObjects>();
        b.SerializeToXML(d);
        Console.ReadLine();
     }
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T18:13:27.057

我已经运行了你的代码，它似乎正确地序列化了你的数据，测试文件是使用基类设置的默认参数创建的。

让我有点担心的是实现我相信你还有更多工作要做，但你需要正确处理对象，确保继承类的属性和序列化以及它的父类正确完成，否则你将无法 de-正确序列化等。我建议您在网上查找 .net 中 xml 序列化的最佳实践，网上有无数示例，但请参阅下面列出的一些示例。

*   [复杂类的 .NET XML 序列化最佳实践](http://www.c-sharpcorner.com/uploadfile/b81385/best-practices-in-net-xml-serialization-of-complex-classes/)
*   [.NET XML 最佳实践](http://support.softartisans.com/kbview.aspx?ID=673)
*   [XML 序列化简介](http://msdn.microsoft.com/en-us/library/182eeyhh.aspx)

其他可能需要检查的是，如果您真的需要使用 XML 是否足够好，甚至是二进制序列化。

stackoverflow 上有几个社区 wiki 条目，其中包括有关最佳实践的问题。

请在下面的代码输出下方加上完整的源代码。请注意，我将您保存 xml 文件的位置更改为“.\test.xml”，通常是 bin 文件夹和调试文件夹，该应用程序在写入时不会遇到任何问题，例如权限等。

另请注意，在下面的 xml 中，您已经丢失了序列化 ChestPlate 对象的事实。

```
<?xml version="1.0" encoding="utf-8"?>
<GameObjectData xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <GameList>
    <GameObjects>
      <Item_Name>OMG</Item_Name>
      <Item_type>CHESTPLATE</Item_type>
      <Item_Level>5</Item_Level>
      <Item_description>omg</Item_description>
      <Item_ID>1234</Item_ID>
    </GameObjects>
  </GameList>
</GameObjectData> 
```

用于生成 XML 的代码库

```
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Xml.Serialization;

namespace ConsoleApplication12
{
    class Program
    {
        static void Main(string[] args)
        {
            GameObjects a = new GameObjects();
            ChestPlate b = new ChestPlate();
            List<GameObjects> d = new List<GameObjects>();
            b.SerializeToXML(d);
            Console.ReadLine();
        }

    }

    [Serializable]
    public class GameObjects
    {
        //Defines name within XML file:
        [XmlElement("Item_ID")]
        public int Item_ID { get; set; }
        [XmlElement("Item_Name")]
        public string Item_Name = "bob";
        [XmlElement("Item_type")]
        public string Item_type = "GameObject";
        [XmlElement("Item_Level")]
        public int Item_Level = 5;
        [XmlElement("Item_description")]
        public string Item_description = "best description evar";

        public GameObjects(int id, string name, string type, int level, string description)
        {
            this.Item_ID = id;
            this.Item_Name = name;
            this.Item_type = type;
            this.Item_Level = level;
            this.Item_description = description;
        }

        public GameObjects()
        {

        }

    }

    [Serializable]
    [XmlInclude(typeof(GameObjects))]
    public class GameObjectData
    {
        [XmlArrayItem(typeof(GameObjects))]
        public List<GameObjects> GameList { get; set; }

    }

    public class ChestPlate : GameObjects
    {
        [XmlElement("Armour_Rating")]
        int Armour_Rating = 5;

        public ChestPlate(int Armour_id, string Armour_name, string Armour_type, int Armour_level, string Armour_description)
            : base(Armour_id, Armour_name, Armour_type, Armour_level, Armour_description)
        {
            this.Item_ID = Armour_id;
            this.Item_Name = Armour_name;
            this.Item_type = Armour_type;
            this.Item_Level = Armour_level;
            this.Item_description = Armour_description;
        }

        public ChestPlate()
        {

        }

        public void SerializeToXML(List<GameObjects> responsedata)
        {
            GameObjectData f = new GameObjectData();
            f.GameList = new List<GameObjects>();
            f.GameList.Add(new GameObjects { Item_ID = 1234, Item_Name = "OMG", Item_type = "CHESTPLATE", Item_Level = 5, Item_description = "omg" });

            XmlSerializer serializer = new XmlSerializer(typeof(GameObjectData));
            TextWriter textWriter = new StreamWriter(@".\Test.xml");

            serializer.Serialize(textWriter, f);

            Console.WriteLine(f);
        }
    }
} 
```

# php - 在 PHP 中使用数组来比较用户名/密码

> ID：15300048
> 
> 赞同：1
> 
> 时间：2013-03-08T17:40:08.403
> 
> 标签：php, arrays

我有以下 php 脚本，它有一个用户名和密码：

```
$Username = 'user1';
$Password = 'pass1';

/******************************************************************************/
if (isset($_POST['submitform'])){

    // Clean up the input values 
    foreach($_POST as $key => $value) {  
        $_POST[$key] = stripslashes($_POST[$key]); 
        $_POST[$key] = htmlspecialchars(strip_tags($_POST[$key])); 
    }
    $user = isset($_POST['user']) ? $_POST['user'] : '';
    $pass = isset($_POST['pass']) ? $_POST['pass'] : '';
    $report = $_POST['typereport'];

    if ($pass != $Password || $user != $Username) {
        showForm("Wrong Username/Password");
        exit();     
    }
} else {
    showForm();
    exit();
} 
```

我想让脚本更健壮，这意味着我想要其他用户名/密码，以便多个用户可以登录（希望它用于跟踪目的）

那么如何修改脚本，以便可以将以下内容用于`$Username`and `$Password`：

```
$Username=array("user1","user2","user3");
$Password=array("pass1","pass2","pass3"); 
```

所以脚本将始终与正确的用户名和密码匹配，并允许我拥有多个用户？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-08T17:43:33.733

我会使用数据库。如果你必须硬编码，我会使用关联数组：

```
<?php
$logins = array(
    'username1' => 'password1',
    'username2' => 'password2',
    'username3' => 'password3',
);

$user = isset($_POST['user']) ? strtolower($_POST['user']) : '';
$pass = isset($_POST['pass']) ? $_POST['pass'] : '';

if ( ! isset($logins[$user]) or $logins[$user] != $pass)
{
    showForm("Wrong Username/Password");
    exit();
} 
```

# java - 信号量如何阻塞和解除阻塞

> ID：15300049
> 
> 赞同：0
> 
> 时间：2013-03-08T17:40:08.420
> 
> 标签：java, signals, block, semaphore, wait

对于作业，我必须在 Java 中创建一个计数信号量。到目前为止，我已经创建了这个裸骨类

```
public class Semaphore {
    int value;

    public Semaphore(int value) {
        this.value = value;
    }

    public static void wait(Semaphore s) {
        s.value--;
        if (s.value < 0) {
            // block
        }
    }

    public static void signal(Semaphore s) {
        s.value++;
        if (s.value <= 0) {
            // unblock one process that is blocked on semaphore
        }

    }   
} 
```

现在我感到困惑的是，我究竟如何在 wait() 上阻塞，相反，我如何在 signal() 上解除阻塞一个线程？我读到有一个阻塞的队列，但我会在哪里继续引用该队列？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T17:50:32.400

在您的等待方法（应该称为等待以外的其他方法）中，您需要检查您的值是否为零，如果为零，则继续等待。这是通过以下方式实现的：

```
public synchronized void P() throws InterruptedException 
{
    while (value == 0) 
    {
        wait();
    }
    value--;
} 
```

您的方法不采用 Semaphore 对象。您只需在 Semaphore 类中使用 value 字段。

该方法检查当值为 0 时，它等待值被更改。因此，您调用该方法的线程将不得不等待。否则，如果该值不为零，则线程可以进入其临界区，并且该值递减，直到再次达到零，这就是线程阻塞的时候。

您的信号方法需要增加该值，并通知正在等待该值已更改的线程以查看它是否可以进入其临界区。信号方法实现如下：

```
public synchronized void V() 
{
    value++;
    notify();
} 
```

我为这些方法使用的命名来自于 Dijkstra 用于信号量的名称（以防你被它们弄糊涂了）。

你不应该调用阻塞方法等待，因为它会与 Object 的等待方法混淆。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T17:45:26.613

看看使用 wait()/notify() 方法。在调用这些之前需要获取对象锁。这意味着您必须使方法非静态并将它们标记为同步

# sql - 创建可更新视图

> ID：15300052
> 
> 赞同：0
> 
> 时间：2013-03-08T17:40:45.843
> 
> 标签：sql, postgresql, view, insert-update

我正在使用 postgres9.1，我一直在努力寻找一些关于如何创建可以稍后更新的视图以及可以在视图中插入新行的教程。

有人能给我一些关于如何做一个可更新的视图并且可以接受插入新行的指导吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-10T15:31:54.617

可更新视图有些复杂。有两种方法可以做到，一种使用 RULE，另一种使用 TRIGGER。触发器会带来更多性能问题，而规则会带来更微妙的编码问题。我将在这里介绍这两种方法。

假设我有一个基表和一个视图，它提供对基表一部分的访问：

```
CREATE TABLE mybase (
      id serial primary key,
      type_id int not null,
      payload text not null
 );

 CREATE VIEW type1 AS select * from mybase WHERE type_id = 1; 
```

好的，很简单。现在我们想让视图可更新。旧方法（维护陷阱）是使用规则：

```
 CREATE RULE on_insert AS ON insert TO type1 
 DO INSTEAD INSERT into mybase(id, type_id, payload) VALUES (new.id, 1, payload);

 CREATE RULE on_update AS ON update TO type1
 DO INSTEAD UPDATE mybase set payload = new.payload where id = old.id; 
```

现在这将起作用，但有一些警告。首先是如果我：

```
 INSERT INTO type1 (id, type_id, payload) values (DEFAULT, 2, 'foo'); 
```

相反，它会默默地输入 1 而不是 2。这可能是不可取的。您可以使您的代码更复杂，或者您可以调用一个函数来执行您的插入和更新，但 RULE 具有在计划时被解析为查询的优点，并且函数将每行运行一次，因此更新一百万使用简单规则的行将比使用函数执行得更好。获得正确的规则是复杂和棘手的，但这意味着对视图的更新将以写入基表更新的方式扩大。

如果您有多个表，但是事情会变得更加复杂，因为您已经更新或删除了多行，并且因为这在计划时间（而不是每行）被合并，一侧可能会被删除，然后另一侧可能无法找到需要删除的内容。但是，如果您使用函数，那么您会遇到与删除和更新有关的扩展问题（这基本上会将您束缚在重复的索引扫描循环中）。

另一种选择是使用触发器。触发器是为正在写入的每一行调用的函数，因此它们具有规则调用函数的写入缩放问题。使用这种方法，我们将创建触发器函数并在视图上创建触发器：

```
CREATE OR REPLACE FUNCTION type1_trigger_func() RETURNS trigger LANGUAGE PLPGSQL AS 
$$
BEGIN
  IF TG_OP = 'INSERT' THEN
     IF new.type_id <> 1 THEN RAISE EXCEPTION 'Invalid type!'; END IF;
     insert into mybasetable (id, type_id, payload) 
     VALUES (new.id, new.type_id, new.payload);
     RETURN NEW;
  ELSIF TG_OP = 'UPDATE' THEN
     IF new.type_id <> 1 THEN RAISE EXCEPTION 'Invalid type!'; END IF;
     -- update statement goes here
     RETURN NEW;
  ELSIF TG_IP = 'DELETE' THEN
     DELETE FROM mybasetable WHERE id = old.id;
     RETURN OLD;
  END IF;
END;
$$; 
```

然后我们创建触发器：

```
 CREATE TRIGGER make_updateable INSTEAD OF INSERT OR UPDATE OR DELETE ON TYPE1
 FOR EACH ROW EXECUTE PROCEDURE type1_trigger_func(); 
```

一般来说，在这种情况下使用 RULE 和 TRIGGER 的困难使我倾向于存储过程而不是视图。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-11T12:30:23.390

**使用视图更新数据** 视图可用于更新数据的查询，但有一些限制。请记住，视图不是表并且不包含数据——实际的修改总是发生在表级别。视图不能用作覆盖基表中定义的任何约束、规则或引用完整性的机制。

**通过视图更新数据的限制** 您可以在视图中插入、更新和删除行，但受到以下限制：

如果视图包含多个表之间的连接，则只能在视图中插入和更新一个表，不能删除行。

您不能根据联合查询直接修改视图中的数据。您不能修改使用 GROUP BY 或 DISTINCT 语句的视图中的数据。

所有被修改的列都受到相同的限制，就好像直接对基表执行语句一样。

无法通过视图修改文本和图像列。

# html - CSS - 如何使图像容器宽度固定和高度自动拉伸

> ID：15300059
> 
> 赞同：22
> 
> 时间：2013-03-08T17:41:04.500
> 
> 标签：html, css

我有一些像这样的html代码：

```
 <div class="item">
    <img src="...">
 </div> 
```

和这样的css代码：

```
img {
    max-width: 100%;
    height: auto;
}

.item {
    width: 120px;
    height: 120px;
    height: auto;
    float: left;
    margin: 3px;
    padding: 3px;
} 
```

我想做的是使用 div 的宽度来显示 img 并拉伸它的高度。我还希望 div 拉伸自身以适应 img。那可能吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-03-08T17:44:11.033

您正在寻找的是`min-height`和`max-height`。

```
img {
    max-width: 100%;
    height: auto;
}

.item {
    width: 120px;
    min-height: 120px;
    max-height: auto;
    float: left;
    margin: 3px;
    padding: 3px;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T19:10:45.373

不，您不能使 img 拉伸以适应 div 并同时实现反向。您将有一个无限的调整大小循环。但是，您可以从其他答案中记下一些笔记并实现一些最小和最大尺寸，但这不是问题所在。

您需要决定您的图像是否会缩放以适合其父级，或者您是否希望 div 扩展以适合其子级 img。

使用此块告诉我您希望图像大小可变，因此父 div 是图像缩放到的宽度。 `height: auto`将保持您的图像纵横比不变。如果你想拉伸高度，它需要`100%`像这个小提琴一样。

```
img {
    width: 100%;
    height: auto;
} 
```

[http://jsfiddle.net/D8uUd/1/](http://jsfiddle.net/D8uUd/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T18:48:41.443

尝试`width:inherit`使图像采用其容器的宽度`<div>`。它会拉伸/收缩它的高度以保持比例。不要在 中设置高度`<div>`，它将调整大小以适合图像高度。

```
img {
    width:inherit;
}

.item {
    border:1px solid pink;
    width: 120px;
    float: left;
    margin: 3px;
    padding: 3px;
} 
```

[JSFiddle 示例](http://jsfiddle.net/jim31415/CSNVH/)

# wcf - 使用相同的 HTTPS 客户端证书在具有并发会话的 IIS 上出现 413 错误

> ID：15300064
> 
> 赞同：5
> 
> 时间：2013-03-08T17:41:19.757
> 
> 标签：wcf, iis, ssl, iis-8

我有以下问题。

我在 IIS 8 上托管了一个 WCF 应用程序，**它只**接受带有客户端证书的 HTTPS 请求。此服务接受大小可能不同（从几个字节到 1 GB）的 POST 消息，并且大部分时间是并行接收的。

在以下情况下，客户端会收到 413 Request entity too large 响应：

*   **当使用相同**的客户端证书打开多个连接并上传许多小文件时。在这种情况下，一个请求成功，所有其他请求都失败并出现 413 错误。

该问题可以通过将该`uploadReadAheadSize`值设置为大于`system.webServer/serverRuntime`配置部分中所有并行调用大小的总和来解决，但这会导致服务器为每个调用分配预读缓冲区的全部内存量在许多并发调用的情况下导致服务器内存不足。

**如果使用不同**的客户端证书进行调用或上传一个大文件，则我的配置**有效。**

 **我已经读过 IIS 6 有一个选项可以`SSLAlwaysNegoClientCert`在配置中设置以修复类似的错误。我已经尝试过[解决方法](https://stackoverflow.com/questions/2518314/make-iis-require-ssl-client-certificate-during-initial-handshake)来设置此值，但使用 IIS 8.0 没有成功。我还尝试关闭 SSL 客户端缓存以禁用 SSL 会话恢复，但这也没有解决我的问题。

什么可能导致 413 错误？有没有办法在不使用服务器的整个内存的情况下启用多个并行上传与客户端证书到同一服务器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-07T08:24:20.250

只是一个猜测：

> **如果请求客户端重新协商**，则必须使用 SSL 预加载来预加载请求实体主体。SSL 预加载将使用 UploadReadAheadSize 元数据库属性的值，该属性用于 ISAPI 扩展。**但是，如果 UploadReadAheadSize 小于内容长度，则会返回 HTTP 413 错误，并关闭连接以防止死锁。**（发生死锁是因为客户端正在等待完成发送请求实体，而服务器正在等待重新协商完成，但重新协商要求客户端能够发送数据，这是它无法做到的）。

（来自文章[客户端无法重新协商请求并返回 HTTP 413 错误（IIS 6.0）](http://www.microsoft.com/technet/prodtechnol/WindowsServer2003/Library/IIS/7e0d74d3-ca01-4d36-8ac7-6b2ca03fd383.mspx?mfr=true)。）

未设置 SSLAlwaysNegoClientCert 时会发生客户端重新协商，因此请使用 OpenSSL 检查它是否已启用（请参阅[此问题](https://stackoverflow.com/questions/17742003/debugging-ssl-handshake)）。我没有使用 IIS 8，但在 IIS 7.5 上，从[您链接的问题](https://stackoverflow.com/questions/2518314/make-iis-require-ssl-client-certificate-during-initial-handshake)中启用 SSLAlwaysNegoClientCert 的两种方法都对我有用。**

# php - php 结合 ssh2.sftp 和 zip 文件包装器

> ID：15300065
> 
> 赞同：5
> 
> 时间：2013-03-08T17:41:20.737
> 
> 标签：php

有没有办法结合 ssh2.sftp:// 和 zip:// 文件包装器？我知道其他一些包装器是可能的，例如`compress.zlib://php://input`

这是我尝试过的：

```
$handle = fopen("zip://ssh2.sftp://{$session}/myfile.zip#myfile.csv",'r'); 
```

和

```
$handle1 = fopen("ssh2.sftp://{$ssh_session}/myfile.zip",'r');
$handle2 = fopen("zip://{$handle1}",'r'); 
```

（我没想到第二个会起作用）

# php - 无法将 app_data 传递给我的 facebook 标签页

> ID：15300066
> 
> 赞同：1
> 
> 时间：2013-03-08T17:41:24.900
> 
> 标签：php, facebook

我尝试了一些解决方案，但我似乎无法检索我传递给我的 facebook 标签页的“app_data”。

更新---------------- 对于我的标签页，我正在使用以下内容，但它不起作用：

```
// Connect to Facebook
$facebook = new Facebook(array(
        'appId'  => $FB_APP_ID, 
        'secret' => $FB_APP_SECRET
));
$signed_request = $facebook->getSignedRequest();
echo ($signed_request["app_data"]);//Nothing is output here! 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T20:00:58.457

`app_data`在`signed_request`页面标签应用程序中，

对于常规画布应用程序，值应该是可用的`$_REQUEST['app_data']`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T11:09:22.833

```
$facebook = new Facebook(array(
    'appId' => '$testapp_id',
    'secret' => '$testapp_skey',
    'cookie' => true
));

$signed_request = $facebook->getSignedRequest();

$page_id = $signed_request["page"]["id"];
$page_admin = $signed_request["page"]["admin"];
$like_status = $signed_request["page"]["liked"];
$country = $signed_request["user"]["country"];
$locale = $signed_request["user"]["locale"];    
$fanpagid =$page_id;    

try {
$page_info  = $facebook->api("/".$page_id."?fields=link");
}catch(Exception $o) {
}

$fanpage=$page_info["link"];
$fullpageurl=$fanpage."?sk=app_".$app_id; 
```

试试这个代码......

# forms - 当表单使用 AngularJS 无效时禁用提交按钮

> ID：15300067
> 
> 赞同：179
> 
> 时间：2013-03-08T17:41:28.417
> 
> 标签：forms, angularjs, button, disabled-control

我有这样的表格：

```
<form name="myForm">
    <input name="myText" type="text" ng-model="mytext" required />
    <button disabled="{{ myForm.$invalid }}">Save</button>
</form> 
```

如您所见，如果输入为空，则该按钮被禁用，但当它包含文本时它不会变回启用。我怎样才能让它工作？

* * *

## 回答 #1

> 赞同：348
> 
> 时间：2013-03-08T17:43:05.513

您需要使用表单的名称以及 ng-disabled：[这是 Plunker 上的演示](http://plnkr.co/edit/POkHtlIwasOm8bexMKqT)

```
<form name="myForm">
    <input name="myText" type="text" ng-model="mytext" required />
    <button ng-disabled="myForm.$invalid">Save</button>
</form> 
```

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2014-10-28T21:38:44.063

添加到这个答案。我刚刚发现，如果您在表单名称中使用连字符（Angular 1.3），它也会崩溃：

所以这**不起作用**：

```
<form name="my-form">
    <input name="myText" type="text" ng-model="mytext" required />
    <button ng-disabled="my-form.$invalid">Save</button>
</form> 
```

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2015-05-23T17:09:26.783

选择的响应是正确的，但是像我这样的人可能会在向服务器端发送请求时遇到异步验证问题 - 在给定的请求处理期间按钮不会被禁用，因此按钮会闪烁，这对用户来说看起来很奇怪。

要取消这一点，您只需要处理表单的 $pending 状态：

```
<form name="myForm">
  <input name="myText" type="text" ng-model="mytext" required />
  <button ng-disabled="myForm.$invalid || myForm.$pending">Save</button>
</form> 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2017-09-01T12:31:16.323

如果您使用的是反应式表单，则可以使用：

```
<button [disabled]="!contactForm.valid" type="submit" class="btn btn-lg btn primary" (click)="printSomething()">Submit</button> 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-11-14T02:14:51.653

```
<form name="myForm">
        <input name="myText" type="text" ng-model="mytext" required/>
        <button ng-disabled="myForm.$pristine|| myForm.$invalid">Save</button>
</form>
```

如果你想更严格一点

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-04-26T17:38:06.310

我们可以创建一个简单的指令并禁用按钮，直到填写所有必填字段。

```
angular.module('sampleapp').directive('disableBtn',
function() {
 return {
  restrict : 'A',
  link : function(scope, element, attrs) {
   var $el = $(element);
   var submitBtn = $el.find('button[type="submit"]');
   var _name = attrs.name;
   scope.$watch(_name + '.$valid', function(val) {
    if (val) {
     submitBtn.removeAttr('disabled');
    } else {
     submitBtn.attr('disabled', 'disabled');
    }
   });
  }
 };
}
); 
```

[欲了解更多信息请点击这里](http://www.angulartutorial.net/2016/04/disable-submit-button-until-all.html)

# c# - 数组中成员的默认值是多少？

> ID：15300073
> 
> 赞同：34
> 
> 时间：2013-03-08T17:41:58.447
> 
> 标签：c#, arrays, default-value, member

我实例化一个这样的数组：

```
int array[] = new int[4]; 
```

这四个成员的默认值是什么？是否为空、0 或不存在？

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2013-03-08T17:42:47.057

它是 0。它不能为 null，因为 null 不是有效值`int`。

从 C# 5 规范的第 7.6.10.4 节：

> 新数组实例的所有元素都被初始化为其默认值（第 5.2 节）。

从第 5.2 节开始：

> 变量的默认值取决于变量的类型，并确定如下：
> 
> *   对于值类型的变量，默认值与值类型的默认构造函数计算的值相同（第 4.1.2 节）。
> *   对于引用类型的变量，默认值为 null。
> 
> 初始化为默认值通常是通过让内存管理器或垃圾收集器在分配内存之前将内存初始化为所有位为零来完成的。因此，使用全位为零来表示空引用很方便。

（作为实现细节，第一个要点有一些技巧。虽然 C# 本身不允许您为值类型声明无参数构造函数，但您*可以*在 IL 中为值类型创建自己的无参数构造函数。我不相信这些构造函数在数组初始化中调用，但它们*将*在 C#中的表达式中调用`new X()`。不过，它确实超出了 C# 规范的范围。）

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-03-08T17:45:18.557

类型为 的自动初始化变量（`T`例如数组元素或实例字段）的默认值与 的值相同`default(T)`。对于引用类型和指针类型，它是 null。对于数字类型，它是该类型的零。对于 bool，它是错误的。对于结构类型，结构值的所有字段都初始化为默认值。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-03-08T17:44:16.387

从[数组（C# 编程指南）](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/arrays/#array-overview)：

> 数值数组元素的默认值设置为零，参考元素设置为空。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-08T17:44:55.167

整数不能`NULL`。它们将具有值“0”。即使您尝试分配`NULL`给`int`来自代码，您也无法做到。

# javascript - Javascript：事件处理程序不起作用，在 JSFiddle 中工作

> ID：15300074
> 
> 赞同：2
> 
> 时间：2013-03-08T17:41:58.870
> 
> 标签：javascript, event-handling, jsfiddle

所以这是我发布的另一个问题的答案，我认为这是正确的解决方案。然而，虽然它在 jsfiddle 中工作得非常好，但在该环境之外它不起作用。我尝试了多种组合，但我无法让这件事正常工作。

我已经`onLoad`在正文中尝试过，`Window.onload`无论是在函数周围的标题中，还是在所有元素加载后在页面底部单独调用它。没有任何效果。

我总是遇到这个问题：

> 未捕获的 TypeError：无法调用 null 的方法“addEventListener”

这令人沮丧，因为我看到的所有其他针对此错误的解决方案都围绕确保您确实具有处理程序在您的 HTML 中触发的指定 ID。我做的。

我知道在这里发帖可能有点矫枉过正，但我​​正在拔头发。

这是 JSfiddle：http: [//jsfiddle.net/fFW5r/1/](http://jsfiddle.net/fFW5r/1/)

这是我为测试这个概念而制作的模型页面（它永远不会起作用）：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Untitled Document</title>

<script type="text/javascript"> 
    var link_container = document.getElementById('links');
    function myFunction(){ link_container.addEventListener('click', function(e){ 
        if(e.target.nodeName === "A"){
            var href = e.target.getAttribute('href'),
                selfhost = window.location.hostname;
            if(href.indexOf(selfhost) !== -1){
                alert('Inbound link clicked');
            } else {
                alert('Outbound link clicked');
            }
        }
    }, false); 
    }
</script>
</head>

<body onload="myFunction()">

<div id="links">
    <a href="http://fiddle.jshell.net/#foo">Inbound Link</a>
    <a href="http://stackoverflow.com">Outbout Link</a>
</div>

<script>window.onload=myFunction()</script>
</body>
</html> 
```

`onload`在加载完所有内容后，我试图通过页面底部的调用来测试这个特定的迭代。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-08T17:44:32.063

`var link_container = document.getElementById('links');`需要执行`document.onload`所以它必须在里面`myFunction`

在 jsfiddle 中，代码`load`默认执行。在左侧面板的小提琴中>第二个选择框，如果您选择`no wrap - in head`，您可以重新创建问题。演示：[小提琴](http://jsfiddle.net/arunpjohny/fFW5r/3/)

```
<script type="text/javascript"> 

    function myFunction(){ 
        var link_container = document.getElementById('links'); // <<-- Move it inside `myFunction()`
        link_container.addEventListener('click', function(e){ 
        if(e.target.nodeName === "A"){
            var href = e.target.getAttribute('href'),
                selfhost = window.location.hostname;
            if(href.indexOf(selfhost) !== -1){
                alert('Inbound link clicked');
            } else {
                alert('Outbound link clicked');
            }
        }
    }, false); 

    }
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T17:47:27.627

它不起作用的原因是您在 DOM 准备好之前初始化 link_container 。然后当 myFunction() 运行时，link_container 已经被初始化为 undefined。这导致它失败。在函数中初始化它（在 DOM 加载之后）应该可以解决问题

将 declare link_container 放在函数内。

```
var link_container = document.getElementById('links');

function myFunction(){ 
    link_container.addEventListener('click', function(e){ 
        if(e.target.nodeName === "A"){
            var href = e.target.getAttribute('href'),
                selfhost = window.location.hostname;
            if(href.indexOf(selfhost) !== -1){
                alert('Inbound link clicked');
            } else {
                alert('Outbound link clicked');
            }
        }
    }, false); 
} 
```

# symfony - single_text 小部件不需要 Symfony 空日期字段

> ID：15300075
> 
> 赞同：3
> 
> 时间：2013-03-08T17:42:00.303
> 
> 标签：symfony, default, datefield

我使用 single_text 小部件创建了带有日期字段的表单。我之所以选择这个，是因为我使用的是[Bootstrap datepicker](http://aymkdn.github.com/Datepicker-for-Bootstrap/)

我遇到的问题是该字段始终填充当前日期而不是空的。

根据[这](https://github.com/symfony/symfony/pull/4596)一点，如果我将 required 设置为 false 但 id 没有，它应该可以工作。我尝试将 empty_value 设置为与数据相同的空字符串，但在第一种情况下没有发生任何事情，可能是因为此选项适用于选择字段。在第二种情况下，我收到异常“类型为“\DateTime”、“字符串”的预期参数”

我尝试使用 DataTransformer 但没有任何区别。我发现对于数据字段的值总是通过[DateTimeToLocalizedStringTransformer](https://github.com/symfony/symfony/blob/master/src/Symfony/Component/Form/Extension/Core/DataTransformer/DateTimeToLocalizedStringTransformer.php)，如果我理解正确，它会返回空字符串，如果为空值，那么问题就在 datatransformers 之后的某个地方。

我尝试的另一件事是使用 attr 数组设置值，不幸的是，副作用是使用某些值填充表单不会影响日期字段。

有没有办法使用 single_text 小部件将数据字段的默认值设置为空？

这里有一个代码

```
<?php

namespace Psw\AdminBundle\Form;

use Symfony\Component\Form\AbstractType;
use Symfony\Component\Form\FormBuilderInterface;
use Symfony\Component\OptionsResolver\OptionsResolverInterface;
use Doctrine\ORM\EntityRepository;
use Psw\AdminBundle\Form\DataTransformer\EmptyDateTransformer;
use Psw\AdminBundle\Form\DataTransformer\EmptyDateViewTransformer;

class OrdersFilterType extends AbstractType
{
    private $admin;

    public function __construct($admin=false) {
        $this->admin = $admin;
    }

    public function buildForm(FormBuilderInterface $builder, array $options)
    {
        $builder->add('client', 'entity', array(
                'class' => 'PswAdminBundle:User',
                'required' => false,
                'multiple' => false,
                'label'     => 'orders.client',
                'empty_value' => 'orders.allclients',
                'query_builder' => function(EntityRepository $er) {
                    $qb = $er->createQueryBuilder('u');
                    return $qb->where($qb->expr()->like('u.roles', '?0'))
                        ->setParameters(array('%ROLE_CLIENT%'));
                }
            ));
        if($this->admin) {
            $builder->add('staff', 'entity', array(
                'class' => 'PswAdminBundle:User',
                'required' => false,
                'multiple' => false,
                'label'     => 'orders.staff',
                'empty_value' => 'orders.allStaff',
                'query_builder' => function(EntityRepository $er) {
                    $qb = $er->createQueryBuilder('u');
                    return $qb->where($qb->expr()->like('u.roles', '?0'))
                              ->orWhere($qb->expr()->like('u.roles', '?1'))
                              ->orWhere($qb->expr()->like('u.roles', '?2'))
                        ->setParameters(array('%ROLE_STAFF%','%ROLE_ADMIN%','%ROLE_SUPER_ADMIN%'));
                }
            ));
        }
        $builder->add('start', 'date', array(
                    'label' => 'orders.start',
                    'widget' => 'single_text',
                    'required' => false,
                ))
                ->add('end', 'date', array(
                    'label' => 'orders.end',
                    'widget' => 'single_text',
                    'required' => false,
                ))
                ->add('min', null, array(
                    'label' => 'orders.min',
                    'required' => false,
                )) 
                ->add('max', null, array(
                    'label' => 'orders.max',
                    'required' => false,
                ));
    }

    public function getDefaultOptions(array $options)
    {
        $options = parent::getDefaultOptions($options);
        $options['csrf_protection'] = false;

        return $options;
    }

    public function getName()
    {
        return 'psw_adminbundle_ordersfiltertype';
    }
} 
```

# ruby-on-rails - 我对 bitmask_attributes gem 使用什么数据类型？

> ID：15300079
> 
> 赞同：0
> 
> 时间：2013-03-08T17:42:13.423
> 
> 标签：ruby-on-rails, ruby, gem, bit-manipulation

我正在使用这个宝石：[https ://github.com/joelmoss/bitmask_attributes](https://github.com/joelmoss/bitmask_attributes)

老实说，我不知道我应该在迁移中使用什么数据类型。

我已经阅读了文档，但没有看到任何提及。如果尝试几种让我担心的不同数据类型，它似乎会起作用，我觉得如果我选择了错误的数据类型，我会被搞砸并认为它正在工作。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T17:45:28.553

该列应该是一个整数列

如果您的数据库提供多种大小的整数，您需要根据您计划存储在位掩码中的值的数量选择一个足够大的整数 - 如果您有 5 个标志，最大值将为 31 (2**5 - 1)

# c# - 不断检查是否选择了 ListView

> ID：15300080
> 
> 赞同：2
> 
> 时间：2013-03-08T17:42:14.150
> 
> 标签：c#, listview

我以前做过这个，我有办法做到这一点，但我想确保它是最好的方法。我在详细信息视图中有一个 ListView。我也有一个按钮。如果选择了一个项目（禁用多选），我只希望启用该按钮。将在此列表视图中添加和删除项目，但只要有选定的项目，就应启用该按钮，否则应禁用该按钮。

我的事件处理程序：

```
private void listView1_SelectedIndexChanged(object sender, EventArgs e)
{
    if (listView1.SelectedItems.Count > 0)
        button1.Enabled = true;
    else
        button1.Enabled = false;
} 
```

这就是我所拥有的，只是想知道这是否会一直有效，或者是否会出现失败的异常事件？就像我删除或添加东西或其他任何东西一样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T17:48:27.517

如果你展示你拥有的东西会更好 - 但简而言之，你从禁用按钮开始，如果列表视图的 selectedItems.Count 为 1，则在列表视图 selectedindexChanged 事件中启用按钮。如果没有项目，则禁用它被选中。这是一个可能有帮助的链接： [ListView selectedindexchanged](https://stackoverflow.com/questions/9857141/listview-selectedindexchanged)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-08T18:06:41.097

```
public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();            
    }
    private void Form1_Load(object sender, EventArgs e)
    {
        for (int i = 0; i < 9; i++)
        {
            listView1.Items.Add("kashif");
        }
        button1.Enabled = false;            
    }
    private void listView1_ItemSelectionChanged(object sender, ListViewItemSelectionChangedEventArgs e)
    {
        button1.Enabled = listView1.SelectedItems.Count > 0;
    }
    private void button2_Click(object sender, EventArgs e)
    {
        foreach (ListViewItem v in listView1.SelectedItems)
        {
            v.Remove();
        }
    }
} 
```

**Before Button2 Click**

![](../Images/dff6c4f2f9c6555d93336cdf78f3c451.png)

**After Button2 click**

![enter image description here](../Images/f3303d033ac348325a68e08dd477014c.png)

# objective-c - 在 Objective C 和性能中使用 AppleScript 库

> ID：15300081
> 
> 赞同：0
> 
> 时间：2013-03-08T17:42:13.703
> 
> 标签：objective-c, performance, applescript

是否可以在 Objective C 中使用 AppleScript 库？例如，向邮件应用程序询问所有邮箱的列表

性能会不会有提升？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T18:20:41.783

您可以使用[脚本桥](https://developer.apple.com/library/mac/ipad/#documentation/Cocoa/Conceptual/ScriptingBridgeConcepts/Introduction/Introduction.html)

另一个链接[macosxautomation](http://www.macosxautomation.com/applescript/features/scriptingbridge.html)

" AppleScript 是 Apple 事件消息传递的类英语语言界面

Mac OS X 的体系结构。AppleScript 脚本在执行时由 AppleScript 框架转换为 Apple 事件，用于查询和控制“可编写脚本的”应用程序。

多年来，开发人员和解决方案提供商一直在寻找一种简单的方法，将类似的能力包含在其他常见的编程语言中。Mac OS X v.10.5 包含一个名为 Scripting Bridge 的新框架，它使通用语言（如 Ruby、Python 和 Objective-C）能够轻松地将 Apple 事件发送到可编写脚本的应用程序”。

或阅读有关[NSApplescript](https://developer.apple.com/library/mac/ipad/#documentation/Cocoa/Reference/Foundation/Classes/NSAppleScript_Class/Reference/Reference.html)

在我看来，最好使用脚本桥。但是您可能会发现很难找到完整的文档或大量示例。

但我相信你会在这里找到帮助.. :-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T17:43:45.840

是的，您可以使用`AppleScript`，但沙盒会强制执行限制。

是的，肯定存在性能问题，因为 AppleScript 会打开它所针对的应用程序

> 告诉应用程序 Safari

如果 safari 不存在，它将崩溃，如果已安装，它将运行。

# android - 如何在 Android (Nexus 7) 上显示不可缩放的网页

> ID：15300090
> 
> 赞同：1
> 
> 时间：2013-03-08T17:42:54.593
> 
> 标签：android, html, mobile-website, nexus-7, android-resolution

客户报告我在 Nexus 7 上的网页存在问题。Nexus 的本机分辨率为 1280x800，我需要在此设备（和其他机器人）上显示我的网页不可缩放，因此分辨率为 1280x800。

在问题报告之前，我有这个视口设置。

```
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"> 
```

从日志中我知道 JS 检测到他的分辨率为 750x534，而我的 HTC EVO（本机分辨率 960x540）为 640x308。

比我将视口更改为

```
<meta name="viewport" content="target-densitydpi=device-dpi, width=device-width" /> 
```

来源 [http://developer.android.com/guide/webapps/targeting.html#ViewportDensity](http://developer.android.com/guide/webapps/targeting.html#ViewportDensity)

和我的 HTC EVO 现在以 960x462 显示页面（ok nonzoom）但 Nexus 仍以 962x442 显示此页面

谢谢你的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-10T09:56:31.917

试试这个，对我有用

```
<meta name="viewport" content="user-scalable=no,width=device-width, initial-scale=1.0,maximum-scale=1,minimum-scale=1, height=device-height"> 
```

# c - if-else vs if-else-if-else

> ID：15300092
> 
> 赞同：0
> 
> 时间：2013-03-08T17:43:15.373
> 
> 标签：c, conditional-statements

在 else 中使用 if else if 和 else 或 if else 和其他条件有什么区别吗？例如，

```
if (i == 5)
  printf("i is 5");
else if (i > 5)
  printf("i is greater than 5");
else
  printf("i is less than 5"); 
```

或者

```
if (i == 5)
  printf("i is 5");
else {
  if (i > 5)
    printf("i is greater than 5");
  else
    printf("i is less than 5");
} 
```

执行上没有区别。两个片段都会给出相同的结果，但是我们应该使用后一个还是第一个，只是因为一个是更好的编程实践而另一个不是。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-08T17:46:33.667

`else if`使用vs之间没有功能上的区别`else { if`。这纯粹是一种风格决定。

我冒昧地说，尽管大多数开发人员更喜欢`else if`. 使用`else { if`会导致基于相同数据的逻辑不必要的缩进。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T18:14:36.880

使用最清楚地表达情况的任何东西：

```
if (file_opened_successfully)
...
else
{
   if (file_does_not_exist)
   ...
   else if (file_permissions_not_set)
   ...
   else if (file_wrong_type)
   ...
   else
   ...
} 
```

外部决策是严格的二元决策；要么我们可以打开文件，要么我们不能。如果我们可以打开文件，我们正常处理它，否则我们需要处理错误。

但是，我们无法打开文件有多种可能的原因，我们的错误处理取决于结果是哪种原因。所以这是一个多路分支，而不是严格的二进制分支。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T17:47:30.667

如果条件与第一个 If 有关，我通常使用第一种方法，否则我会使用数字 2，但这只是您感觉舒适的方式。

# windows - UNC 路径可以从命令行映射，但不能从 .NET 控制台应用程序映射

> ID：15300093
> 
> 赞同：0
> 
> 时间：2013-03-08T17:43:16.430
> 
> 标签：windows, map, command, drive, unc

如何使 .NET 代码将 Z: 驱动器映射到帐户 SVNdatamgmt 的 UNC 路径？

我正在尝试将本地驱动器映射到 .NET 控制台应用程序中的网络 UNC 路径。该代码似乎可以从服务帐户（＃2和＃3）和我的凭据（＃4）的命令行工作。但是，当使用 .NET 源代码从控制台应用程序运行时，服务帐户不起作用（#5），但我的凭据确实起作用（#6）。

昨晚，我注意到我收到了一个错误（#1）。等了30分钟后，它工作了。所以你可以忽略#1。我想我会提到它，以防它为正在发生的事情提供线索。

控制台应用程序以管理员身份在 Windows Server 2008 机器上运行。SVCdatamgmt 和 macgyver 都是这台机器上的管理员。这些命令也在同一台机器上运行。

==================================================== ======================
***1.）昨晚这不起作用：***

C:>`net use z: \\uwhc-sas2\SASHIMC /USER:SVCdatamgmt thepassword`

```
System error 1909 has occurred.
The referenced account is currently locked out and may not be logged on to. 
```

==================================================== ======================
***2.）等了 30 分钟，然后这个工作（没有域）：***

C:>`net use z: \\uwhc-sas2\SASHIMC /USER:SVCdatamgmt thepassword`

```
The command completed successfully. 
```

==================================================== =======================
***3.）这也适用（与域）：***

C:>`net use z: \\uwhc-sas2\SASHIMC /USER:UWHIS\SVCdatamgmt thepassword`

```
The command completed successfully. 
```

==================================================== ======================
***4.）这也适用于我的凭据：***

C:>`net use z: \\uwhc-sas2\SASHIMC /USER:macgyver thepassword`

```
The command completed successfully. 
```

========================================================================
***5.) .NET code that maps drive. SVCdatamgmt credentials do not work.***

```
public static void MapNetworkDriveToUNC()
{
    var command = @"net use " + mapDrive + " " + uncPath + " " + uncUser + " " + uncPass;
    ExecuteCommand(command, 10000);
}

public static void UnmapNetworkDriveToUNC()
{
    var command = "net use " + mapDrive + " /delete";
    ExecuteCommand(command, 5000);
} 
```

========================================================================
***6.) .NET code that maps drive. My credentials work (macgyver)***

-- same code as #5 --

========================================================================
**FYI: before running each command above, I have to disconnect (unmap) the drive using this code...**

```
C:\>net use z: /delete

z: was deleted successfully. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-11T00:41:07.103

I was looking for the command to map UNC Path to Network Drive from C# and I implemented this and works great. Its too late but may be helpful to someone in future:

```
 public static bool MapDrivetoUNC(string DriveName, string Path)
  {
     try
     {
        bool isMapped = true;

        System.Diagnostics.Process p = new System.Diagnostics.Process();
        p.StartInfo.UseShellExecute = false;
        p.StartInfo.CreateNoWindow = true;
        //p.StartInfo.RedirectStandardError = true;
        //p.StartInfo.RedirectStandardOutput = true;
        p.StartInfo.FileName = "net.exe";
        p.StartInfo.Arguments = " use " + DriveName + ": " + '"' + Path + '"'; 
        p.Start();
        p.WaitForExit();

        //str errMsg = p.StandardError.ReadToEnd();
        // similar for erroutput .. 
        isMapped = true;
     }
     catch(Exception ex)
     { 
         Utility.logError(ex);
         isMapped = false;
     }
     return isMapped;
  } 
```

# xcode - 我应该在源代码管理中包含 Xcode .plist 和 .pch 文件吗？

> ID：15300102
> 
> 赞同：4
> 
> 时间：2013-03-08T17:44:08.370
> 
> 标签：xcode, svn, smartsvn

每当创建新项目或导入现有项目时，Xcode 通常会创建三个文件和一个文件夹。前两个文件位于项目的根目录中：

```
ProjectNameHere-Info.plist
ProjectNameHere-Prefix.pch 
```

也可以在项目根目录中找到的文件夹称为：

```
en.lproj 
```

其中有这个文件：

```
InfoPlist.strings 
```

有谁知道这些文件的目的是什么/它们包含什么？我不确定是否将这些添加到我的 SVN（我正在使用 SmartSVN）。同样，如果我不签入这些生成的文件，当其他人签出项目时 Xcode 将如何反应？Xcode 会重新创建这些文件吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-08T20:13:50.493

您应该将这些文件包含在源代码管理中。

'plist' 是使用 xml 编写的应用程序的属性列表文件，其中包括图标文件名、构建选项等。

'pch' 是预编译的头文件，已从您的所有项目中引用。

'en.lproj' 和 'InfoPlist.strings' 用于语言本地化文件。默认语言已由英语设置。

如果删除这些文件，构建时会发生错误。并且 Xcode 不能从其他文件重新创建这些。

# php - 如何将一些数据传递给 ValidationFilter？[禅2]

> ID：15300105
> 
> 赞同：0
> 
> 时间：2013-03-08T17:44:16.010
> 
> 标签：php, validation, zend-framework2

我有一个像 Zend 1 中的 Db_NoRecordExists 这样的 ValidationFilter。但在某些情况下，已经有一条具有相同值的记录是可以的——例如，当我想更新一些数据时。也许更新后用户名仍然相同。但是后来我的 ValidationFilter 给出了一个错误。现在我可以使用“排除 ID XYZ”之类的东西。但是我怎样才能将这些 ID 传递给验证过滤器呢？

谢谢你！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-09T17:14:44.773

使用该`setValidationGroup()`方法告诉您的表单应该关注哪些字段。

例如，如果您的表单有 3 个名为`username`,`email`和的字段`country`，并且您不需要验证`username`，因为它不会被更改，您可以在您的控制器中执行以下操作（假设`$form`是您的表单的一个实例）

```
$form->setValidationGroup(array(
    'email',
    'country',
)); 
```

# vb.net - AWS 对象元数据

> ID：15300108
> 
> 赞同：1
> 
> 时间：2013-03-08T17:44:23.297
> 
> 标签：vb.net, amazon-web-services, amazon-s3

我读了这篇文章：[Changing Meta data (last modified) on an S3 object](https://stackoverflow.com/questions/14071399/changing-meta-data-last-modified-on-an-s3-object)

我在 VB.Net 中编程。尝试使用此功能时：将 iMetADatA 调暗为新的 ObjectMetadata

VS 告诉我“ObjectMetadata”没有定义。

我正在执行此操作的课程在标题中包含所有 AWS 工具

```
Imports Amazon
Imports Amazon.S3
Imports Amazon.S3.Model
Imports Amazon.S3.Transfer 
```

我想在文件上传后修改（即“复制”/“替换”）元数据日期和时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-07T20:54:30.657

确保您使用的是官方 API 规范中指定的数据类型：http: [//docs.aws.amazon.com/sdkfornet/latest/apidocs/html/N_Amazon_S3.htm](http://docs.aws.amazon.com/sdkfornet/latest/apidocs/html/N_Amazon_S3.htm)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-22T18:27:14.137

将任何对象上传到 s3 时，无需更新元数据（日期和时间等），框架会自动更新，使用 java 中的 GetObjectMetadataRequest() ，就像我们可以获取更新的对象元数据一样。有关更多信息，请通过以下链接：[http ://docs.aws.amazon.com/AmazonS3/latest/dev/RetrievingObjectUsingNetSDK.html](http://docs.aws.amazon.com/AmazonS3/latest/dev/RetrievingObjectUsingNetSDK.html)

# objective-c - NSManagedObjectContext：这是一个很好的线程限制模式吗？

> ID：15300109
> 
> 赞同：1
> 
> 时间：2013-03-08T17:44:25.323
> 
> 标签：objective-c, core-data, thread-safety, nsmanagedobjectcontext

使用 Core Data 时，线程安全问题一直存在。`NSManagedObjectContext`在两个不同线程中的一个上执行获取保证了死锁。Apple 的**核心数据编程指南**建议使用线程限制，但没有提供可以实现此目的的模式。我在下面有一个快速而肮脏的解决方案：

```
- (NSManagedObjectContext *) managedObjectContext
{
    NSManagedObjectContext *moc = objc_getAssociatedObject([NSThread currentThread], _cmd);

    if (!moc && self.persistentStoreCoordinator)
    {
        moc = [[NSManagedObjectContext alloc] init];
        moc.mergePolicy = NSOverwriteMergePolicy;
        moc.persistentStoreCoordinator = self.persistentStoreCoordinator;
        objc_setAssociatedObject([NSThread currentThread], _cmd, moc, OBJC_ASSOCIATION_RETAIN);
    }

    return moc;
} 
```

此方法将出现在管理我的应用程序中的数据堆栈的专有类中。它将 MOC 与当前线程相关联。这对我来说似乎是一个合理的解决方案，但它也显得又快又松。

尝试这样的解决方案我应该担心什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T18:29:07.920

你应该反过来：使用

```
[NSManagedObjectContext alloc] initWithConcurrencyType:concurrencyType]] 
```

创建一个上下文

*   `NSMainQueueConcurrencyType`- 如果您需要一个上下文链接到只需要在主线程上使用的控制器和 UI 对象，或者
*   `NSPrivateQueueConcurrencyType`- 对于在私有后台队列上运行的上下文。

对上下文的所有操作使用`performBlock`or `performBlockAndWait`，这样可以确保在为上下文指定的队列上执行操作。

有关更多信息，请参阅“OS X v10.7 和 iOS 5.0 的核心数据发行说明”中的[托管对象上下文的并发支持。](http://developer.apple.com/library/mac/#releasenotes/DataManagement/RN-CoreData/index.html#//apple_ref/doc/uid/TP40010637-CH1-DontLinkElementID_1)

# matlab - matlab中的位分组

> ID：15300110
> 
> 赞同：0
> 
> 时间：2013-03-08T17:44:28.473
> 
> 标签：matlab, bits

我对matlab中的位有疑问。例如，a=101010101011111001。在这里，我想从 'a' 一次生成一组 8 位，并获得它的 bin2dec 形式并将其保存为另一种形式，例如 b。

'a' 有三组：第一组= 10101010，第二组=10111110，第三组=01。

'b' 将具有这些组的 bin2dec。我希望它是，b = [170 190 1]。我想为具有位的大文件执行此操作，而我无法让组拥有我自己的（与我在上面的示例中所做的不同）。考虑 matlab 循环和所有。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T18:52:52.057

只需使用重塑！bin2dec 采用整个数组。

```
a = '10101001111101010110000001111110010101111001011110011011';
b = bin2dec(reshape(a,8,[])')
b =

   169
   245
    96
   126
    87
   151
   155 
```

也都在一条线上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T17:53:38.913

如果`a`是数字，只需添加：

```
a = num2str(a); 
```

编辑：

好吧，如果我说对了，您想要：

```
a = '1010100111110101011000000111111001010111100101111001';
thesize = ceil(length(a)/8);
b = zeros(1,thesize);
for i = 1:thesize
    b(i) = bin2dec(a(((i-1)*8+1):min(length(a),(i*8)+1)));
end 
```

# ruby-on-rails-3 - 如何将 TMail 添加到 Rails 应用程序

> ID：15300118
> 
> 赞同：0
> 
> 时间：2013-03-08T17:45:00.057
> 
> 标签：ruby-on-rails-3

我认为 TMail 包含在 Rails 中。但是当我尝试调用它时，我得到了错误：

```
email = TMail::Mail.parse("From mikel@example.org\nReceived by.... etc")
NameError: uninitialized constant TMail 
```

当我`require 'tmail'`在我的控制台上时，我也得到了错误：

```
require 'tmail'
LoadError: cannot load such file -- tmail 
```

我已经安装了 tmail 使用`sudo gem install tmail`

我的问题是：如何将 TMail 添加到 Rails 应用程序？我正在使用 Rails 3.2.12。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T17:52:43.727

在 Gemfile 中添加 gem

```
gem 'tmail' 
```

然后运行`bundle install`

# google-chrome - Chrome开发者工具中的（程序）源文件怎么可能被隐藏？

> ID：15300121
> 
> 赞同：0
> 
> 时间：2013-03-08T17:45:14.637
> 
> 标签：google-chrome, google-chrome-devtools

当您打开 chrome 开发工具并进入“源”选项卡时。通常您可以看到您当前所在网站的所有源代码（html、css、js）。

Chrome创建一个“（程序）”文件，其中包含当前页面的基本js

有谁知道为什么（程序）不会在这里？

因为我有一些 chrome 放入该文件中的 javascript，当我在所有文件中进行搜索（Ctrl + Shift + F）时，它不会在（程序）源中搜索，因为它不在树视图中。

谢谢 ！

# asp.net - How to do date subtraction on an item in a repeater asp.net

> ID：15300124
> 
> 赞同：0
> 
> 时间：2013-03-08T17:45:18.270
> 
> 标签：asp.net, repeater

I want to calculate an Age inside a repeater with an existing field.

Query to populate repeater:

```
var qryGetAllBeneficiaries = from p in dbRRSP.Person 
         join rt in dbRRSP.RelationshipType on p.RelationshipTypeId equals rt.RelationshipTypeId
           where p.PlanId == qryPersonDetails.PlanId
           orderby p.LastName
         select new
               {
             BeneficiaryLastName = p.LastName, 
             BeneficiaryFirstName = p.FirstName,
             BeneficiaryMiddleName = p.MiddleName,
             BeneficiaryAka = p.Aka,
             BeneficiaryBirthday = p.Birthdate,
             BeneficiaryRelationshipToClient = rt.RelationshipTypeDescription
                            };

            rptBeneficiary.DataSource = qryGetAllBeneficiaries;
            rptBeneficiary.DataBind(); 
```

Repeater itself:

```
<asp:Repeater ID="rptBeneficiary" runat="server">
    <HeaderTemplate>
    <table>      
    <tr>
    <td class="labels displayInput_noWidth">Last Name</td>
    <td class="labels displayInput_noWidth">First Name</td>
    <td class="labels displayInput_noWidth">Middle Name</td>
    <td class="labels displayInput_noWidth">Aka</td>
    <td class="labels displayInput_75w">Birthday</td>
    <td class="labels displayInput_noWidth">Age</td>
   </tr>                      
   </HeaderTemplate>

   <ItemTemplate>
   <tr>
   <td><%#DataBinder.Eval(Container.DataItem, "BeneficiaryLastName") %></td> 
   <td><%#DataBinder.Eval(Container.DataItem, "BeneficiaryFirstName") %></td>
   <td><%#DataBinder.Eval(Container.DataItem, "BeneficiaryMiddleName") %></td>
   <td><%#DataBinder.Eval(Container.DataItem, "BeneficiaryAka") %></td>
   <td><%#DateTime.Parse(DataBinder.Eval(Container.DataItem, "BeneficiaryBirthday").ToString()).ToString("MM/dd/yyyy")%></td>
   <td> <%(DateTime.Today.Subtract(DateTime.Parse(DataBinder.Eval(Container.DataItem, "BeneficiaryBirthday").ToString())).Days / 365).ToString()%></td> 

   </tr>                            
   </ItemTemplate>
   <FooterTemplate>
   </table>
   </FooterTemplate>
   </asp:Repeater> 
```

I figured out how to just format into a date string I like, but what I'm looking for is to subtract today's date from the birthday to get the age of each Beneficiary in the repeater.

I tried to do the following calculation:

```
<td> <%(DateTime.Today.Subtract(DateTime.Parse(DataBinder.Eval(Container.DataItem, "BeneficiaryBirthday").ToString())).Days / 365).ToString()%></td> 
```

but it wouldn't recognize the DataBinder.Eval container and asked me to add another using statement: System.ComponentModel.Container. Can someone tell me what I'm missing? Thanks in advance.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T17:51:46.127

You are missing a `#` in your code:

Write

```
<td> <%#(DateTime.Today.Subtract(... 
```

instead of

```
<td> <%(DateTime.Today.Subtract(... 
```

You can only use the Container variable in a databinding context, which you don't have if you use the normal nugget syntax instead of the databinding syntax.

Also you can shorten your code a lot if you just write `Eval("yxz")` instead of `DataBinder.Eval(Container.DataItem,"xyz")`. The first is a shorthand for the second, where the dataitem is automatically assumed.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T18:06:03.270

It looks like you are missing the #

```
<td> <%#(DateTime.Today.Subtract(DateTime.Parse(DataBinder.Eval(Container.DataItem, "BeneficiaryBirthday").ToString())).Days / 365).ToString()%></td> 
```

As an alternative though, consider creating a method to wrap your collection and using the foreach:

```
<table>      
    <tr>
        <td class="labels displayInput_noWidth">Last Name</td>
        <td class="labels displayInput_noWidth">First Name</td>
        <td class="labels displayInput_noWidth">Middle Name</td>
        <td class="labels displayInput_noWidth">Aka</td>
        <td class="labels displayInput_75w">Birthday</td>
        <td class="labels displayInput_noWidth">Age</td>
   </tr>
   <% foreach (var beneficiary in GetBenificiaries())
   {%> 
   <tr>
       <td><%= beneficiary.BeneficiaryLastName %></td> 
       <td><%= beneficiary.BeneficiaryFirstName %></td>
       <td><%= beneficiary.BeneficiaryMiddleName %></td>
       <td><%= beneficiary.BeneficiaryAka %></td>
       <td><%= beneficiary.BeneficiaryBirthday.ToString("MM/dd/yyyy")%></td>
       <td> <% DateTime.Now.Subtract(beneficiary.BeneficiaryBirthday).Days / 365%></td> 
   </tr> 
   <%}%> 
```

This way it is a lot more readable, you get strong typed intellisense, it matches more closely with MVC if you ever migrate, and if you use tools like resharper, they will be able to refactor these changes better

# html - 如何使用modernizr在IE8上使用隐藏控件触发HTML5视频中的“播放”

> ID：15300130
> 
> 赞同：0
> 
> 时间：2013-03-08T17:45:34.443
> 
> 标签：html, internet-explorer-8, modernizr

在 Modernizr 的帮助下，我设法在 IE8 上使用 video-js 播放 HTML5 视频，现在的问题是我想隐藏视频控件并通过页面上的链接触发“播放”。除了 ie8 和 ie7，我有一个在任何地方都可以正常工作的解决方案。

请问有什么想法吗？

```
<html><head>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js" ></script>

<!--[if lt IE 9]>
<script type="text/javascript" src="js/modernizr.js"></script>
<![endif]-->

<script type="text/javascript" src="js/video.js"></script>
<script>
$(document).ready(function () { 
 $('.play').click(function(){   $('video').get(0).play(); });
});
</script>
</head>

<body>

<div id="wrapper">

    <video id="example_video_1" class="video-js vjs-default-skin" preload="none" width="640" height="264" poster="http://video-js.zencoder.com/oceans-clip.png" data-setup="{}">
    <source src="http://video-js.zencoder.com/oceans-clip.mp4" type='video/mp4' />
    <source src="http://video-js.zencoder.com/oceans-clip.webm" type='video/webm' />
    <source src="http://video-js.zencoder.com/oceans-clip.ogv" type='video/ogg' />
    <track kind="captions" src="captions.vtt" srclang="en" label="English" />
</video>

<a href="#" class="play">play</a>

</div>
</body></html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-29T03:47:37.247

您遇到的问题是您的代码：

```
$('video').get(0).play(); 
```

仅适用于原生 HTML5 播放器。由于 IE7/8 都不支持 HTML5`<video>`元素，它们都会看到*Video.js*提供的 Flash 回退。

你应该看看[Video.js API](https://github.com/zencoder/video-js/blob/master/docs/api.md)。而不是你上面的代码，也许尝试：

```
myPlayer = _V_('example_video_1');

$('.play').click(function(){
    myPlayer.play();
}); 
```

# javascript - 为什么我的 jQuery draggable 没有正确包含？

> ID：15300131
> 
> 赞同：0
> 
> 时间：2013-03-08T17:45:45.580
> 
> 标签：javascript, jquery, css, jquery-ui, jquery-draggable

[jsFiddle](http://jsfiddle.net/HG8b6/18/)

您会注意到可拖动对象的包含选项是 [7, 0, 40, 0]，尽管我认为它们应该是 [0, 0, 32, 0]。如果单击按钮使其处于“ON”位置并拖动`<div>`（圆形滑块），您会注意到它向左移动而不是向右移动。我不明白为什么会这样。这是问题的图片，非常轻微。

![在此处输入图像描述](../Images/8b907184b265e2c15fc30446c3e504c9.png)当你拖动它时，这就是我想要的：![在此处输入图像描述](../Images/416b7232ab0c2ec2d868be75599ba488.png)

谢谢！

HTML：

```
<section></section>
<div></div> 
```

CSS：

```
section {
    background-image: url(http://www.rsadler.com/OnOff_slider_small.png);
    width: 57px;
    height: 25px;
    margin: 0;
    padding: 0;
}
section:hover{
    cursor: pointer;
}
section.ON {
    background-position: 82px 0px;
}
div {
    background-image: url(http://www.rsadler.com/OnOff_slider_small.png);
    background-position: 26px 0px;
    position: relative;
    height: 24px;
    width: 25px;
    margin: -25px 0px 0px 0px;
    padding: 0;
}
div:hover {
    cursor: pointer;
} 
```

JS：

```
$(document).ready(function(){
    $('section').click(function(){
        if ($(this).hasClass('ON')) {
            $(this).removeClass('ON');
            $(this).next().slideLeft();
        } else {
            $(this).addClass('ON');
            $(this).next().slideRight();
        }     
    }); 
    $('div').click(function(){
        if ($(this).prev().hasClass('ON')) {
            $(this).slideLeft();
            $(this).prev().removeClass('ON');
        } else {
            $(this).slideRight();
            $(this).prev().addClass('ON');
        }     
    });

    $('div').draggable({
        axis: 'x',
        containment: [7, 0, 40, 0]   // why do I have to put 7 as the x1 value? It should be 0
    });
});

jQuery.fn.slideRight = function() {
    var o = $(this[0])
    o.animate({
        'left': '32px'
    }, 300);
};
jQuery.fn.slideLeft = function() {
    var o = $(this[0])
    o.animate({
        'left': '0'
    }, 300);
}; 
```

# java - Struts 2 选择标签默认值

> ID：15300135
> 
> 赞同：1
> 
> 时间：2013-03-08T17:46:14.420
> 
> 标签：java, jsp, struts2, ognl

我正在使用 Struts 创建一个数据库记录编辑表单。

```
<s:select id="status" name="newRecord.status" list="statusTypes" listKey="id" listValue="description" label="Status:" value="" /><br /> 
```

示例列表：

```
Status' list: 
1 Open 
2 Closed 
3 Pending 
```

我想在状态字段上设置一个默认值作为存储的当前状态，`record.status`其中包含字符串表示，例如`"Open"`。

如果我设置`value="%{record.status}`它不起作用，因为那不是任何列表键。当我只有字符串表示可以使用时，有没有办法设置这个值？

或者我应该重新设计`record.status`为具有 ID 和 的对象`String`吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T17:53:25.060

您需要使用哈希而不是列表。注意

```
listKey="id" listValue="description" 
```

然后你可以设置值=键

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T18:17:02.570

您应该初始化`newRecord.status`应该是包含列表键值的单独属性的值。然后只需设置默认值`value="%{record.status}"`。当我说属性时，我指的是可通过 OGNL 访问的 bean 属性。

# jquery - jQuery淡入每个字母

> ID：15300143
> 
> 赞同：0
> 
> 时间：2013-03-08T17:46:50.493
> 
> 标签：jquery, fadein, fade, fadeout

我的褪色有一个小问题。基本上，当我淡化第一个字母时，第二个字母移到左边，占据第一个字母的位置。有没有办法阻止这种情况？如果有怎么办？

```
$('.m').fadeIn( 4000, function() {
    $('.i').fadeIn( 3000, function() {
        $(this).fadeOut( 2000, function() {
            $('.full' ).fadeOut( 3000 );
        } );    
    } );
    $(this).fadeOut( 3000 );    
} ); 
```

jFiddle：http: [//jsfiddle.net/MRvfC/](http://jsfiddle.net/MRvfC/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T17:52:52.097

而不是使用该`display`属性，您应该使用`visibility`. 不幸的是 jQuery`display`在显示/隐藏中使用，所以你必须手动完成。

```
$('.m').css( {'opacity':0,'visibility':'visible'} ).animate( {'opacity':1}, 4000, function() {
    $('.i').css( {'opacity':0,'visibility':'visible'} ).animate( {'opacity':1}, 3000, function() {
        $(this).animate( {'opacity':0}, 2000, function() {
            $('.full' ).animate( {'opacity':0}, 3000 );
        } );    
    } );
    $(this).animate( {'opacity':0}, 3000 ); 
}); 
```

并在 CSS 中更改`display:none`为。`visibility:hidden`通过在最后将可见性设置回隐藏来节省一些处理能力也是值得的，尽管好的浏览器会知道无论如何都不会渲染不透明度为 0 的东西。

# spring - 在 Apache Tomcat 上部署时无法访问属性文件

> ID：15300144
> 
> 赞同：0
> 
> 时间：2013-03-08T17:46:52.077
> 
> 标签：spring, war, web-inf

我已经使用我的 user.properties 文件来访问存储在 WEB-INF 文件夹中的数据库。它在运行 GGTS（Groovy Grail Tool Suite）时正常工作。

我用了

```
Properties prop = new Properties();
prop.load(DataSource.class.getClassLoader().getResourceAsStream("user.properties")); 
```

在数据源中

当我作为独立运行它时它工作

但是当我创建它的war文件并将它部署到tomcat服务器时它不起作用。

我的 user.properties 位于 WEB-INF 文件夹中。

**显示错误**

```
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'pluginManager' defined in ServletContext resource [/WEB-INF/applicationContext.xml]: Invocation of init method failed; nested exception is java.lang.NullPointerException 
```

提前致谢。请帮忙

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T17:50:16.717

您正在使用类加载器加载文件。但**不在**`WEB-INF`类路径中。在类路径中，以及目录中的每个 jar 中。**`WEB-INF/classes``WEB-INF/lib`**

 *** * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-08T17:59:45.523

那是因为 ,`user.properties`不在 Web 应用程序类路径中。

**解决方案**

*   `WEB-INF/classes`构建战争时将 user.properties 移动到文件夹**

# durandal - 如何在 Durandal 路由器中使用 splat 参数？

> ID：15300146
> 
> 赞同：4
> 
> 时间：2013-03-08T17:46:56.613
> 
> 标签：durandal

我正在看的文章是[Durandal Router](http://durandaljs.com/documentation/Router.html)。

下`mapAuto`，它说我们可以在 url 中传递 splat 参数`#/customers/1`。并且`activate`视图模型中的函数将能够检索参数数组。

我在这里建了一条路线

```
router.mapRoute('view/:id', moduleId, 'Customer Details', false); 
```

但是我怎样才能获得函数`id`中的`activate`？文档页面上没有示例。请帮助我们。谢谢你。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-08T17:59:56.617

给你的激活函数一个参数，可能命名为“数据”。

然后，传递到 url 的 id 将在激活函数中作为“data.id”可用。

```
var activate = function(data) {
    alert(data.id);
}; 
```

# c++ - C++：32 与 64 位流操作

> ID：15300148
> 
> 赞同：3
> 
> 时间：2013-03-08T17:47:03.707
> 
> 标签：c++, stream, 64-bit

如果我在 32 位应用程序中将 int 写入 fstream 并在 64 位应用程序中读取该 int，我是否应该期望值不同？如果是这样（我猜是这样），实现独立于架构的流操作的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T17:56:18.640

`operator<<`如果您使用and读写`operator>>`，它将与平台无关，假设整数足够小以适合两种类型，因为 if 将被写为文本。如果您使用`ostream::read`and `osteam::write`，它不会独立于平台，因为您将编写二进制数据。

如果您不需要原始性能，则使用文本格式是实现平台独立性的最简单方法。如果您需要更好的性能，您应该查看序列化库。Boost 有一个很好的跨平台。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-08T18:04:11.903

好吧，这取决于您是编写二进制还是ASCII。如果你用 ASCII (UTF-8) 写你的数字，那么读取应该产生相同的结果。

我建议您使用该`boost::serializaton`包以受控和统一的方式读取和写入数据。

但是，如果它在相反的方向工作是不确定的，即从 64 位到 32 位。这取决于您的编译器，如果它将`int`s 编译为 64 位，那么您可能会将无法读取的值写入 32 位`int`s。即使您写入格式化的流。

但是，`int`在 C++ 中不能保证 a 的大小，只是它的大小大于或等于 a `short`。这取决于编译器。

如果您想真正确定可以使用 GMP 处理大整数，请自动验证数据。

# algorithm - 炸弹投放算法

> ID：15300149
> 
> 赞同：214
> 
> 时间：2013-03-08T17:47:03.497
> 
> 标签：algorithm, language-agnostic, matrix

我有一个`n x m`由非负整数组成的矩阵。例如：

```
2 3 4 7 1
1 5 2 6 2
4 3 4 2 1
2 1 2 4 1
3 1 3 4 1
2 1 4 3 2
6 9 1 6 4 
```

“投下炸弹”将目标单元及其所有八个相邻单元的数量减少一，最小为零。

```
x x x 
x X x
x x x 
```

什么算法可以确定将所有单元格减少到零所需的最小炸弹数量？

**B选项（由于我不是一个细心的读者）**

实际上问题的第一个版本不是我正在寻找答案的那个。我没有仔细阅读整个任务，还有额外的限制，让我们说：

简单的问题呢，当行中的序列必须不增加时：

`8 7 6 6 5`是可能的输入序列

`7 8 5 5 2`不可能，因为 7 -> 8 按顺序增长。

也许为“更简单”的案例找到答案将有助于为更难的案例找到解决方案。

**PS：**我相信当我们有几个相同的情况需要最少的炸弹来清除上线时，我们会选择在行的“左侧”使用最多的炸弹。还有任何可能是正确的证据吗？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2013-03-09T00:31:06.303

有一种方法可以将其简化为一个简单的子问题。

解释有两部分，算法，以及算法提供最佳解决方案的原因。如果没有第二个，第一个就没有意义，所以我将从为什么开始。

如果您考虑轰炸矩形（假设是一个大矩形 - 还没有边缘情况），您可以看到将周边正方形的空心矩形减少到 0 的唯一方法是轰炸周边或轰炸空心矩形正方形就在外围。我将把外围层称为第 1 层，将其内部的矩形称为第 2 层。

一个重要的见解是没有点轰炸第 1 层，因为这样做得到的“爆炸半径”总是包含在第 2 层的另一个正方形的爆炸半径内。您应该能够轻松地说服自己这一点。

因此，我们可以将问题简化为找到一个最佳方法来轰炸周界，然后我们可以重复这个过程，直到所有方格都为 0。

但是当然，如​​果有可能以一种不太理想的方式轰炸周边，这并不总是能找到最佳解决方案，但是通过使用 X 个额外的炸弹，通过 >X 个炸弹减少内层的问题变得更简单。所以，如果我们调用许可者第一层，如果我们在第二层的某个地方（就在第一层内部）放置一个额外的 X 炸弹，我们可以减少后来轰炸第二层的工作量超过 X 吗？换句话说，我们必须证明我们可以贪婪地减少外围。

但是，我们确实知道我们可以贪婪。因为在将第 2 层减少到 0 层时，第 2 层中的任何炸弹都不会比第 3 层中战略性放置的炸弹更有效。出于与以前相同的原因 - 我们总是可以在第 3 层中放置一颗炸弹，它会影响每个方格放置在第 2 层的炸弹可以达到第 2 层。所以，贪婪永远不会伤害我们（在这种贪婪的意义上）。

所以，我们所要做的就是找到最佳方法，通过轰炸下一个内层将permiter减少到0。

先把拐角轰到0我们是不会受伤的，因为只有内层的拐角才能到达，所以我们真的别无选择（而且，任何能到达拐角的外围炸弹的爆炸半径都包含在内层角的爆炸半径）。

一旦我们这样做了，与 0 角相邻的周边方格只能从内层到达 2 个方格：

```
0       A       B

C       X       Y

D       Z 
```

此时，周界实际上是一个封闭的 1 维循环，因为任何炸弹都会减少 3 个相邻的方格。除了角落附近的一些奇怪之处 - X 可以“击中” A、B、C 和 D。

现在我们不能使用任何爆炸半径技巧 - 每个方格的情况都是对称的，除了奇怪的角落，即使没有爆炸半径也是另一个的子集。请注意，如果这是一条线（正如恐慌上校所讨论的）而不是一个闭环，那么解决方案是微不足道的。端点必须减少到 0，并且炸毁与端点相邻的点永远不会对您造成伤害，因为爆炸半径是超集。将端点设为 0 后，您仍然有一个新端点，因此重复（直到该行全为 0）。

因此，如果我们可以将层中的单个正方形最佳地减少到 0，我们就有了一个算法（因为我们已经切断了循环，现在有一条带端点的直线）。我相信在具有最低值的正方形附近进行轰炸（给您 2 个选项），以便在该最小值的 2 个正方形内的最大值是可能的最小值（您可能必须拆分轰炸来管理这个）将是最佳的，但我（还没有？）有证据。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2013-03-08T19:53:38.957

Pólya says "If you can't solve a problem, then there is an easier problem you can solve: find it."

The obvious simpler problem is the 1-dimensional problem (when the grid is a single row). Let's start with the simplest algorithm - greedily bombing the biggest target. When does this go wrong?

Given `1 1 1`, the greedy algorithm is indifferent to which cell it bombs first. Of course, the centre cell is better - it zeros all three cells at once. This suggests a new algorithm A, "bomb to minimise the sum remaining". When does this algorithm go wrong?

Given `1 1 2 1 1`, algorithm A is indifferent between bombing the 2nd, 3rd or 4th cells. But bombing the 2nd cell to leave `0 0 1 1 1` is better than bombing the 3rd cell to leave `1 0 1 0 1`. How to fix that? The problem with bombing the 3rd cell is that it leaves us work to the left and work to the right which must be done separately.

How about "bomb to minimise the sum remaining, but maximise the minimum to the left (of where we bombed) plus the minimum to the right". Call this algorithm B. When does this algorithm go wrong?

* * *

Edit: After reading the comments, I agree a much more interesting problem would be the one dimensional problem changed so that the ends join up. Would love to see any progress on that.

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2013-03-08T21:30:04.680

**由于我没有时间，我不得不只停留在部分解决方案上，但希望即使是这个部分解决方案也能提供一些关于解决这个问题的潜在方法的见解。**

当面对一个难题时，我喜欢提出更简单的问题来培养对问题空间的直觉。在这里，我采取的第一步是将这个二维问题简化为一维问题。考虑一行：

```
0 4 2 1 3 0 1 
```

不知何故，您知道您需要在该`4`地点或附近轰炸 4 次才能将其降至 0。由于该地点左侧的数字较低，因此轰炸`0`或`4`过度轰炸. 没有任何好处`2`。事实上，我相信（但缺乏严格的证据）轰炸`2`直到`4`点下降到 0 至少与任何其他将点下降到 0 的策略一样好。`4`一个人可以在策略中从左到右进行像这样：

```
index = 1
while index < line_length
  while number_at_index(index - 1) > 0
    bomb(index)
  end
  index++
end
# take care of the end of the line
while number_at_index(index - 1) > 0
  bomb(index - 1)
end 
```

几个样品轰炸命令：

```
0 4[2]1 3 0 1
0 3[1]0 3 0 1
0 2[0]0 3 0 1
0 1[0]0 3 0 1
0 0 0 0 3[0]1
0 0 0 0 2[0]0
0 0 0 0 1[0]0
0 0 0 0 0 0 0

4[2]1 3 2 1 5
3[1]0 3 2 1 5
2[0]0 3 2 1 5
1[0]0 3 2 1 5
0 0 0 3[2]1 5
0 0 0 2[1]0 5
0 0 0 1[0]0 5
0 0 0 0 0 0[5]
0 0 0 0 0 0[4]
0 0 0 0 0 0[3]
0 0 0 0 0 0[2]
0 0 0 0 0 0[1]
0 0 0 0 0 0 0 
```

从一个需要以某种方式下降的数字开始的想法很有吸引力，因为它突然变得可以找到一个解决方案，就像一些人声称*至少*与所有其他解决方案一样好。

在复杂性的下一步中，这种*至少同样好的*搜索仍然可行是在棋盘的边缘。我很清楚，轰炸外缘从来没有任何严格的好处。你最好轰炸一个地点并免费获得另外三个空间。鉴于此，我们可以说在边缘内部轰炸第一环*至少*与轰炸边缘一样好。此外，我们可以将此与直觉相结合，即在边缘内部轰炸正确的边缘实际上是使边缘空间降至 0 的唯一方法。更重要的是，找出最优策略非常简单（因为它在至少与任何其他策略一样好）将角数降至 0。我们将所有这些放在一起，可以更接近二维空间中的解决方案。

鉴于对角子的观察，我们可以肯定地说，我们知道从任何起始棋盘到所有角都为零的棋盘的最佳策略。这是这种板的一个例子（我从上面的两个线性板上借用了数字）。我对一些空间进行了不同的标记，我将解释原因。

```
0 4 2 1 3 0 1 0
4 x x x x x x 4
2 y y y y y y 2
1 y y y y y y 1
3 y y y y y y 3
2 y y y y y y 2
1 y y y y y y 1
5 y y y y y y 5
0 4 2 1 3 0 1 0 
```

人们会注意到顶行与我们之前看到的线性示例*非常*相似。回顾我们之前的观察，将第一行全部降为 0 的最佳方法是轰炸第二行（该`x`行）。没有办法通过轰炸任何一排来清除顶排，`y`并且轰炸顶排并没有额外的好处，而不是轰炸该排上的相应空间`x`。

我们*可以*从上面应用线性策略（轰炸行上的相应空间），*只*`x`关心我们自己与顶行无关。它会是这样的：

 *```
0 4 2 1 3 0 1 0
4 x[x]x x x x 4
2 y y y y y y 2
1 y y y y y y 1
3 y y y y y y 3
2 y y y y y y 2
1 y y y y y y 1
5 y y y y y y 5
0 4 2 1 3 0 1 0

0 3 1 0 3 0 1 0
4 x[x]x x x x 4
2 y y y y y y 2
1 y y y y y y 1
3 y y y y y y 3
2 y y y y y y 2
1 y y y y y y 1
5 y y y y y y 5
0 4 2 1 3 0 1 0

0 2 0 0 3 0 1 0
4 x[x]x x x x 4
2 y y y y y y 2
1 y y y y y y 1
3 y y y y y y 3
2 y y y y y y 2
1 y y y y y y 1
5 y y y y y y 5
0 4 2 1 3 0 1 0

0 1 0 0 3 0 1 0
4 x[x]x x x x 4
2 y y y y y y 2
1 y y y y y y 1
3 y y y y y y 3
2 y y y y y y 2
1 y y y y y y 1
5 y y y y y y 5
0 4 2 1 3 0 1 0

0 0 0 0 3 0 1 0
4 x x x x x x 4
2 y y y y y y 2
1 y y y y y y 1
3 y y y y y y 3
2 y y y y y y 2
1 y y y y y y 1
5 y y y y y y 5
0 4 2 1 3 0 1 0 
```

这种方法的缺陷在最后两次轰炸中变得非常明显。很明显，考虑到减少`4`第二行第一列中数字的唯一炸弹站点是第一个`x`和`y`. 最后的两次轰炸显然不如只轰炸第一次`x`，后者的效果完全一样（关于顶行的第一个位置，我们没有其他方法可以清除）。由于我们已经证明我们当前的策略是次优的，因此显然需要对策略进行修改。

在这一点上，我可以在复杂性上退后一步，只关注一个角落。让我们考虑这个：

```
0 4 2 1
4 x y a
2 z . .
1 b . . 
```

很明显，使空格`4`降为零的唯一方法是轰炸`x`、`y`和的某种组合`z`。考虑到一些杂技，我相当确定最佳解决方案是轰炸`x`三下`a`然后`b`。现在的问题是弄清楚我是如何达到这个解决方案的，以及它是否揭示了我们甚至可以用来解决这个本地问题的任何直觉。我注意到没有轰炸`y`和`z`空间。试图找到一个可以轰炸这些空间的角落会产生一个看起来像这样的角落：

```
0 4 2 5 0
4 x y a .
2 z . . .
5 b . . .
0 . . . . 
```

对于这个，我很清楚，最佳解决方案是轰炸`y`5 次和`z`5 次。让我们更进一步。

```
0 4 2 5 6 0 0
4 x y a . . .
2 z . . . . .
5 b . . . . .
6 . . . . . .
0 . . . . . .
0 . . . . . . 
```

在这里，感觉同样直观，最佳解决方案是轰炸6 次，然后`a`4次。`b``x`

现在它变成了如何将这些直觉转化为我们可以建立的原则的游戏。

**希望能继续！**

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2013-03-10T15:29:20.713

对于更新的问题，一个简单的贪心算法给出了最佳结果。

向单元格 A[1,1] 投放 A[0,0] 炸弹，然后向单元格 A[2,1] 投放 A[1,0] 炸弹，并继续向下进行此过程。要清理左下角，请将 max(A[N-1,0], A[N-2,0], A[N-3,0]) 炸弹放到单元格 A[N-2,1] 中。这将完全清理前 3 列。

使用相同的方法清理第 3、4、5 列，然后是第 6、7、8 列等。

不幸的是，这无助于找到原始问题的解决方案。

* * *

“更大”的问题（没有“非增减”约束）可能被证明是 NP 难的。这是一个证明的草图。

假设我们有一个度数不超过 3 的平面图。让我们找到该图的最小[顶点覆盖](http://en.wikipedia.org/wiki/Vertex_cover)。根据维基百科的文章，对于度数高达 3 的平面图，这个问题是 NP-hard。这可以通过 Planar 3SAT 的归约来证明。平面 3SAT 的硬度 - 由 3SAT 降低。这两个证明都在教授最近的[“算法下界”讲座中提出。](http://courses.csail.mit.edu/6.890/fall14/lectures/)Erik Demaine（第 7 和第 9 课）。

如果我们分割原始图的一些边（图上的左图），每条边都有偶数个附加节点，则结果图（图上的右图）应该具有与原始顶点完全相同的最小顶点覆盖。这种转换允许将图形顶点与网格上的任意位置对齐。

![在此处输入图像描述](../Images/47af78608e7d5d8ce89c957a0b424c87.png)

如果我们只将图形顶点放置到偶数行和列（以这样一种方式，没有两条边与一个顶点入射形成锐角），则在有边的地方插入“1”，并在其他网格位置插入“零”，我们可以对原始问题使用任何解决方案来找到最小顶点覆盖。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2013-03-08T22:56:52.903

这是部分答案，我试图找到可能是炸弹数量的下限和上限。

在 3x3 和更小的板中，解决方案通常是最大编号的单元。

在大于 4x4 的棋盘中，第一个明显的下限是角的总和：

```
*2* 3  7 *1*
 1  5  6  2
 2  1  3  2
*6* 9  6 *4* 
```

不管你怎么安排炸弹，用少于 2+1+6+4=13 个炸弹是不可能清除这个 4x4 棋盘的。

在其他答案中已经提到，将炸弹放在第二个角落以消除角落永远不会比将炸弹放在角落本身更糟糕，所以给定棋盘：

```
*2* 3  4  7 *1*
 1  5  2  6  2
 4  3  4  2  1
 2  1  2  4  1
 3  1  3  4  1
 2  1  4  3  2
*6* 9  1  6 *4* 
```

我们可以通过在倒数第二个角落放置炸弹来将角落归零，从而得到一个新的棋盘：

```
 0  1  1  6  0
 0  3  0  5  1
 2  1  1  1  0
 2  1  2  4  1
 0  0  0  0  0
 0  0  0  0  0
 0  3  0  2  0 
```

到目前为止，一切都很好。我们需要 13 颗炸弹来清理角落。

现在观察下面标记的数字 6、4、3 和 2：

```
 0  1  1 *6* 0
 0  3  0  5  1
 2  1  1  1  0
*2* 1  2 *4* 1
 0  0  0  0  0
 0  0  0  0  0
 0 *3* 0  2  0 
```

没有办法用一颗炸弹轰炸*任何两个*牢房，所以最小炸弹增加了 6+4+3+2，所以加上我们用来清除角落的炸弹数量，我们得到了最小炸弹这张地图所需的炸弹数量已变为 28 颗。少于 28 颗炸弹是不可能通关这张地图的，这是这张地图的下限。

您可以使用贪心算法来建立一个上限。其他答案表明，贪心算法会产生使用 28 个炸弹的解决方案。由于我们之前已经证明，没有最优解不能少于 28 颗炸弹，因此 28 颗炸弹确实是最优解。

当贪婪和我上面提到的找到最小界限的方法没有收敛时，我想你必须回去检查所有组合。

寻找下限的算法如下：

1.  选择一个编号最大的元素，将其命名为 P。
2.  将距离 P 和 P 本身两步的所有单元格标记为不可拾取。
3.  将 P 添加到`minimums`列表中。
4.  重复步骤 1，直到所有单元格都不可拾取。
5.  对列表求和`minimums`以获得下限。

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2013-03-08T19:03:03.620

您可以将此问题表示为[整数规划](http://en.wikipedia.org/wiki/Integer_programming)问题。（这只是解决此问题的可能解决方案之一）

有要点：

```
a b c d
e f g h
i j k l
m n o p 
```

一个人可以写出 16 个方程，例如，对于点 f 成立

```
f <= ai + bi + ci + ei + fi + gi + ii + ji + ki 
```

最小化所有索引和整数解的总和。

解决方案当然是这些指标的总和。

这可以通过将所有 xi 设置在边界 0 上来进一步简化，因此在此示例中您最终会得到 4+1 方程。

问题是没有解决此类问题的简单算法。我不是这方面的专家，但是解决这个问题，因为线性规划是 NP 困难的。

* * *

## 回答 #7

> 赞同：9
> 
> 时间：2013-03-08T18:39:35.503

这将是一种贪婪的方法：

1.  计算 n X m 阶的“分数”矩阵，其中 score[i][j] 是如果位置 (i,j) 被轰炸，则矩阵中的总扣分。（最高分9分，最低0分）

2.  逐行移动，找到并选择得分最高的第一个位置（例如 (i,j)）。

3.  炸弹（i，j）。增加炸弹数量。

4.  如果原始矩阵的所有元素都不为零，则转到 1。

我怀疑这是最佳解决方案。

**编辑：**

我在上面发布的贪婪方法虽然有效，但很可能不会为我们提供最佳解决方案。所以我认为应该在其中添加一些 DP 元素。

我认为我们可以同意，在任何时间点，必须瞄准具有最高“分数”的位置之一（score[i][j] = 如果 (i,j) 被轰炸，则总扣分）。从这个假设开始，这是新的方法：

NumOfBombs(M)：（返回所需的最小轰炸次数）

1.  给定一个 n X m 阶的矩阵 M。如果 M 的所有元素都为零，则返回 0。

2.  计算“分数”矩阵 M。

    设 k 个不同的位置 P1,P2,...Pk (1 <= k <= n*m) 是 M 中得分最高的位置。

3.  返回 (1 + min( NumOfBombs(M1), NumOfBombs(M2), ..., NumOfBombs(Mk) ) )

    其中 M1,M2,...,Mk 是我们分别轰炸位置 P1,P2,...,Pk 时的结果矩阵。

此外，如果我们想要除此之外的位置顺序，我们必须跟踪“min”的结果。

* * *

## 回答 #8

> 赞同：8
> 
> 时间：2013-03-10T20:17:52.767

您的**新**问题（跨行的值不递减）很容易解决。

观察左列包含最高的数字。因此，任何最优解都必须首先将该列减少为零。因此，我们可以对该列执行一**维**轰炸，将其中的每个元素减少为零。我们让炸弹落在第二列，这样它们就会造成最大的伤害。我认为这里有很多关于一维案例的帖子，所以我觉得跳过那个案例是安全的。（如果你想让我描述它，我可以。）。由于递减属性，最左边的三列将全部归零。但是，我们将在这里证明使用最少数量的炸弹，因为左列必须归零。

现在，一旦左列归零，我们只需剪掉现在归零的最左边的三列，并使用现在减少的矩阵重复。这必须为我们提供最佳解决方案，因为在每个阶段我们使用可证明的最少数量的炸弹。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2013-03-16T07:42:04.630

## 使用分支定界的 Mathematica 整数线性规划

正如已经提到的，这个问题可以使用整数线性规划（即[NP-Hard](http://en.wikipedia.org/wiki/NP-hard)）来解决。Mathematica 已经内置了 ILP。`"To solve an integer linear programming problem Mathematica first solves the equational constraints, reducing the problem to one containing inequality constraints only. Then it uses lattice reduction techniques to put the inequality system in a simpler form. Finally, it solves the simplified optimization problem using a branch-and-bound method."`[参见Mathematica 中的[约束优化](https://docs.google.com/file/d/1v0cT254BBC9EolkzdmDj-bOwFW8IzTtDWf8pN7Dl9EAd0kdMhbzc_0ii10sH/edit)教程..]

我编写了以下使用 Mathematica 的 ILP 库的代码。它出奇的快。

```
solveMatrixBombProblem[problem_, r_, c_] := 
 Module[{}, 
  bombEffect[x_, y_, m_, n_] := 
   Table[If[(i == x || i == x - 1 || i == x + 1) && (j == y || 
        j == y - 1 || j == y + 1), 1, 0], {i, 1, m}, {j, 1, n}];
  bombMatrix[m_, n_] := 
   Transpose[
    Table[Table[
      Part[bombEffect[(i - Mod[i, n])/n + 1, Mod[i, n] + 1, m, 
        n], (j - Mod[j, n])/n + 1, Mod[j, n] + 1], {j, 0, 
       m*n - 1}], {i, 0, m*n - 1}]];
  X := x /@ Range[c*r];
  sol = Minimize[{Total[X], 
     And @@ Thread[bombMatrix[r, c].X >= problem] && 
      And @@ Thread[X >= 0] && Total[X] <= 10^100 && 
      Element[X, Integers]}, X];
  Print["Minimum required bombs = ", sol[[1]]];
  Print["A possible solution = ", 
   MatrixForm[
    Table[x[c*i + j + 1] /. sol[[2]], {i, 0, r - 1}, {j, 0, 
      c - 1}]]];] 
```

对于问题中提供的示例：

```
solveMatrixBombProblem[{2, 3, 4, 7, 1, 1, 5, 2, 6, 2, 4, 3, 4, 2, 1, 2, 1, 2, 4, 1, 3, 1, 3, 4, 1, 2, 1, 4, 3, 2, 6, 9, 1, 6, 4}, 7, 5] 
```

输出

![在此处输入图像描述](../Images/eb886e87ca2d660791232d5c7781caf8.png)

## 对于任何使用贪心算法阅读本文的人

在以下 10x10 问题上尝试您的代码：

```
5   20  7   1   9   8   19  16  11  3  
17  8   15  17  12  4   5   16  8   18  
4   19  12  11  9   7   4   15  14  6  
17  20  4   9   19  8   17  2   10  8  
3   9   10  13  8   9   12  12  6   18  
16  16  2   10  7   12  17  11  4   15  
11  1   15  1   5   11  3   12  8   3  
7   11  16  19  17  11  20  2   5   19  
5   18  2   17  7   14  19  11  1   6  
13  20  8   4   15  10  19  5   11  12 
```

这里是逗号分隔的：

```
5, 20, 7, 1, 9, 8, 19, 16, 11, 3, 17, 8, 15, 17, 12, 4, 5, 16, 8, 18, 4, 19, 12, 11, 9, 7, 4, 15, 14, 6, 17, 20, 4, 9, 19, 8, 17, 2, 10, 8, 3, 9, 10, 13, 8, 9, 12, 12, 6, 18, 16, 16, 2, 10, 7, 12, 17, 11, 4, 15, 11, 1, 15, 1, 5, 11, 3, 12, 8, 3, 7, 11, 16, 19, 17, 11, 20, 2, 5, 19, 5, 18, 2, 17, 7, 14, 19, 11, 1, 6, 13, 20, 8, 4, 15, 10, 19, 5, 11, 12 
```

对于这个问题，我的解决方案包含**208 个**炸弹。这是一个可能的解决方案（我能够在大约 12 秒内解决这个问题）。

![在此处输入图像描述](../Images/8218c3b985389876756cd254377a1b52.png)

作为测试 Mathematica 产生的结果的一种方法，看看你的贪心算法是否可以做得更好。

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2013-03-09T19:24:02.210

似乎线性规划方法在这里非常有用。

令*P [m xn]*是具有位置值的矩阵：

![职位矩阵](../Images/417aa6f03648ee9cc52d5b76cf6f048d.png)

现在让我们定义一个*炸弹矩阵 B(x, y) [mxn]*，其中*1 ≤ x ≤ m* , *1 ≤ y ≤ n*如下

![炸弹矩阵](../Images/cbbe38dc432a877ffe2f8f06fc9ae187.png)

以这样的方式

![炸弹矩阵中的位置值](../Images/c2ad233f44952f0c5f420a15dccdc367.png)

例如：

![乙(3, 3)](../Images/aade84d4981bbe9b11ce4fa83514c0aa.png)

所以我们正在寻找一个矩阵*B [m xn] =* [ *b [ij]* ]

1.  可以定义为炸弹矩阵的总和：

    ![B 作为炸弹矩阵的总和](../Images/5fe76ccf9c903187a062095583cb6b4f.png)

    （*q [ij]*将是我们将在位置*p* *[ij]**投放的炸弹数量*）

2.  *p [ij] - b [ij] ≤ 0* （为了更简洁，让我们将其称为*P - B ≤ 0*）

此外，*B*应该最小化 sum ![炸弹数量的总和](../Images/eddd1a9698f125c7e82de8d984416145.png)。

我们也可以将*B*写成前面的丑陋矩阵：

![B 作为数量和的矩阵](../Images/fe984cce8588607f8dc43535cd5fab97.png)

并且由于*P - B ≤ 0*（这意味着*P ≤ B*）我们有以下漂亮的线性不等式系统：

![投弹数与位置数值的关系](../Images/00541d1c75bbfe6641e6aa0495ff1787.png)

被*q [mn x 1]*定义为

![数量向量](../Images/f7fd90ab5f501949e8ce2df986854bd1.png)

*p [mn x 1]*定义为

![P 的值作为向量分布](../Images/8beb70c5e9942f0079e940d09b81b079.png)

我们可以说我们有一个系统[![下面的系统表示为矩阵的乘积](../Images/2bc4865ea044854790c7636b37780287.png)](https://i.stack.imgur.com/0sDvS.gif)是*S [mn x mn]*矩阵要反转来解决系统。我自己没有扩展它，但我相信在代码中应该很容易做到。

现在，我们有一个最小问题，可以表示为

![我们必须解决的系统](../Images/f61c1a77c2a188557cca0f69f2451549.png)

[我相信用单纯形算法](https://en.wikipedia.org/wiki/Simplex_algorithm)之类的东西来解决它很容易，几乎是微不足道的（有一个[关于它的相当酷的文档](https://web.archive.org/web/20180712212322/http://mat.gsia.cmu.edu:80/classes/QUANT/NOTES/chap7.pdf)）。然而，我几乎不知道线性规划（我将在 Coursera 上学习关于它的课程，但它只是在将来......），我在试图理解它时有些头疼，我还有一份巨大的自由职业要完成，所以我就在这里放弃吧。可能是我在某个时候做错了什么，或者它不能走得更远，但我相信这条路最终会导致*解决*方案。无论如何，我很期待你的反馈。

（特别感谢[这个从 LaTeX 表达式创建图片的神奇网站](https://www.codecogs.com/latex/eqneditor.php)）

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2013-03-09T02:17:23.020

这会在这个位置“迷宫”中搜索最短路径（一系列轰炸）。不，我无法证明没有更快的算法，抱歉。

```
#!/usr/bin/env python

M = ((1,2,3,4),
     (2,3,4,5),
     (5,2,7,4),
     (2,3,5,8))

def eachPossibleMove(m):
  for y in range(1, len(m)-1):
    for x in range(1, len(m[0])-1):
      if (0 == m[y-1][x-1] == m[y-1][x] == m[y-1][x+1] ==
               m[y][x-1]   == m[y][x]   == m[y][x+1] ==
               m[y+1][x-1] == m[y+1][x] == m[y+1][x+1]):
        continue
      yield x, y

def bomb(m, (mx, my)):
  return tuple(tuple(max(0, m[y][x]-1)
      if mx-1 <= x <= mx+1 and my-1 <= y <= my+1
      else m[y][x]
      for x in range(len(m[y])))
    for y in range(len(m)))

def findFirstSolution(m, path=[]):
#  print path
#  print m
  if sum(map(sum, m)) == 0:  # empty?
    return path
  for move in eachPossibleMove(m):
    return findFirstSolution(bomb(m, move), path + [ move ])

def findShortestSolution(m):
  black = {}
  nextWhite = { m: [] }
  while nextWhite:
    white = nextWhite
    nextWhite = {}
    for position, path in white.iteritems():
      for move in eachPossibleMove(position):
        nextPosition = bomb(position, move)
        nextPath = path + [ move ]
        if sum(map(sum, nextPosition)) == 0:  # empty?
          return nextPath
        if nextPosition in black or nextPosition in white:
          continue  # ignore, found that one before
        nextWhite[nextPosition] = nextPath

def main(argv):
  if argv[1] == 'first':
    print findFirstSolution(M)
  elif argv[1] == 'shortest':
    print findShortestSolution(M)
  else:
    raise NotImplementedError(argv[1])

if __name__ == '__main__':
  import sys
  sys.exit(main(sys.argv)) 
```

* * *

## 回答 #12

> 赞同：3
> 
> 时间：2013-03-08T22:30:18.560

无需将问题转换为线性子问题。

取而代之的是使用简单的贪婪启发式，即从最大的一个开始**轰炸角落。**

在给定的示例中，有四个角，{ 2, 1, 6, 4 }。对于每个角落，没有比轰炸对角线的单元更好的动作了，所以我们知道事实上我们的前 2+1+6+4 = 13 次轰炸必须在这些对角线单元中。完成轰炸后，我们得到了一个新矩阵：

```
2 3 4 7 1      0 1 1 6 0      0 1 1 6 0     1 1 6 0     0 0 5     0 0 0 
1 5 2 6 2      0 3 0 5 1      0 3 0 5 1  => 1 0 4 0  => 0 0 3  => 0 0 0  
4 3 4 2 1      2 1 1 1 0      2 1 1 1 0     0 0 0 0     0 0 0     0 0 3  
2 1 2 4 1  =>  2 1 2 4 1  =>  2 1 2 4 1     0 0 3 0     0 0 3      
3 1 3 4 1      0 0 0 0 0      0 0 0 0 0 
2 1 4 3 2      0 0 0 0 0      0 0 0 0 0 
6 9 1 6 4      0 3 0 2 0      0 0 0 0 0 
```

在前 13 次轰炸之后，我们使用启发式算法通过 3 次轰炸消除 3 0 2。现在，我们有 2 个新角，{ 2, 1 } 在第 4 行。我们轰炸那些，另外 3 次轰炸。我们现在已将矩阵缩减为 4 x 4。有一个角落，左上角。我们轰炸那个。现在我们剩下 2 个角，{ 5, 3 }。由于 5 是最大的角落，我们首先轰炸 5 个，然后最后轰炸另一个角落的 3 个。总数为 13+3+3+1+5+3 = 28。

* * *

## 回答 #13

> 赞同：3
> 
> 时间：2013-03-08T21:26:25.050

这个贪婪的解决方案~~似乎是正确的~~：

正如评论中指出的那样，它会在 2D 中失败。但也许你可以改进它。

对于 1D：
如果至少有 2 个数字，则无需向最左边的数字射击，因为向第二个数字射击**并不差**。所以射击到第二个，而第一个不是 0，因为你必须这样做。移动到下一个单元格。不要忘记最后一个单元格。

C++ 代码：

```
void bombs(vector<int>& v, int i, int n){
    ans += n;
    v[i] -= n;
    if(i > 0)
        v[i - 1] -= n;
    if(i + 1< v.size())
        v[i + 1] -= n;
}

void solve(vector<int> v){
    int n = v.size();
    for(int i = 0; i < n;++i){
        if(i != n - 1){
            bombs(v, i + 1, v[i]);
        }
        else
            bombs(v, i, v[i])
    }
} 
```

所以对于 2D：
同样：你不需要在第一行拍摄（如果有第二行）。于是拍第二张。解决第一行的一维任务。（因为您需要将其设为空）。下去。不要忘记最后一行。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2013-03-10T22:47:02.743

这是一个概括角落的良好特性的解决方案。

假设我们可以为给定字段找到一个完美的下降点，即减少其中值的最佳方法。然后要找到要投下的最小炸弹数量，算法的初稿可能是（代码是从 ruby​​ 实现中复制粘贴的）：

```
dropped_bomb_count = 0
while there_are_cells_with_non_zero_count_left
  coordinates = choose_a_perfect_drop_point
  drop_bomb(coordinates)
  dropped_bomb_count += 1
end
return dropped_bomb_count 
```

挑战是`choose_a_perfect_drop_point`。首先，让我们定义什么是完美的落点。

*   的*下降点*减少`(x, y)`中的值`(x, y)`。它也可能减少其他单元格中的值。
*   一个下降点a*比*一个下降点*b**好*，如果它减少了*b*减少的单元格的适当超集中的值。`(x, y)`**`(x, y)`**
****   如果没有其他更好的落点，则落点是*最大的。**   如果它们减少同一组单元格，则两个下降点`(x, y)`是*等效的。**   如果 的落点等于 的所有最大落点，则它`(x, y)`是*完美*`(x, y)`的。***

 **如果有一个完美的投掷点`(x, y)`，你不能`(x, y)`比在其中一个完美的投掷点投掷炸弹更有效地减少 的值`(x, y)`。

给定字段的完美落点是其任何单元格的完美落点。

这里有几个例子：

```
1 0 1 0 0
0 0 0 0 0
1 0 0 0 0
0 0 0 0 0
0 0 0 0 0 
```

`(0, 0)`单元格（从零开始的索引）的完美下降点是`(1, 1)`. 的所有其他下降点`(1, 1)`，即`(0, 0)`、`(0, 1)`和`(1, 0)`，减少的单元格更少。

```
0 0 0 0 0
0 0 0 0 0
0 0 1 0 0
0 0 0 0 0
0 0 0 0 0 
```

`(2, 2)`单元格（从零开始的索引）的完美下降点是`(2, 2)`，以及所有周围的单元格`(1, 1)`、`(1, 2)`、`(1, 3)`、`(2, 1)`、`(2, 3)`、`(3, 1)`、`(3, 2)`和`(3, 3)`。

```
0 0 0 0 1
0 0 0 0 0
0 0 1 0 0
0 0 0 0 0
0 0 0 0 0 
```

单元格的完美下降点`(2, 2)`是`(3, 1)`：它减少 中的值`(2, 2)`和 中的值`(4, 0)`。所有其他下降点`(2, 2)`都不是最大的，因为它们减少了一个单元格。的完美落点`(2, 2)`也是 的完美落点`(4, 0)`，也是该领域唯一的完美落点。它为这个领域带来了完美的解决方案（一次炸弹投掷）。

```
1 0 0 0 0
0 0 0 0 0
0 0 1 0 0
0 0 0 0 0
1 0 0 0 0 
```

没有完美的落点`(2, 2)`：`(1, 1)`和`(1, 3)`减少`(2, 2)`和另一个单元格（它们是 的最大落点`(2, 2)`），但它们不等价。但是，对于 来说，`(1, 1)`是一个完美的落点，对于`(0, 0)`来说，`(1, 3)`是一个完美的落点`(0, 4)`。

有了完美落点的定义和一定的检查顺序，我得到了问题中示例的以下结果：

```
Drop bomb on 1, 1
Drop bomb on 1, 1
Drop bomb on 1, 5
Drop bomb on 1, 5
Drop bomb on 1, 5
Drop bomb on 1, 6
Drop bomb on 1, 2
Drop bomb on 1, 2
Drop bomb on 0, 6
Drop bomb on 0, 6
Drop bomb on 2, 1
Drop bomb on 2, 5
Drop bomb on 2, 5
Drop bomb on 2, 5
Drop bomb on 3, 1
Drop bomb on 3, 0
Drop bomb on 3, 0
Drop bomb on 3, 0
Drop bomb on 3, 0
Drop bomb on 3, 0
Drop bomb on 3, 4
Drop bomb on 3, 4
Drop bomb on 3, 3
Drop bomb on 3, 3
Drop bomb on 3, 6
Drop bomb on 3, 6
Drop bomb on 3, 6
Drop bomb on 4, 6
28 
```

但是，该算法只有在每一步之后至少有一个完美的下降点时才有效。可以构建没有完美落点的示例：

```
0 1 1 0
1 0 0 1
1 0 0 1
0 1 1 0 
```

对于这些情况，我们可以修改算法，而不是完美的落点，而是选择一个具有最小选择的最大落点的坐标，然后计算每个选择的最小值。在上述情况下，所有具有值的单元格都有两个最大下降点。例如，`(0, 1)`具有最大落点`(1, 1)`和`(1, 2)`。选择其中一个，然后计算最小值会导致以下结果：

```
Drop bomb on 1, 1
Drop bomb on 2, 2
Drop bomb on 1, 2
Drop bomb on 2, 1
2 
```

* * *

## 回答 #15

> 赞同：2
> 
> 时间：2013-03-09T01:59:29.240

我相信要尽量减少炸弹的数量，你只需要最大限度地增加伤害..为此需要检查具有最强力量的区域..所以你首先用 3x3 内核分析场并检查总和更强..在那里轰炸..直到场地变平..对于这个提交的答案是28

```
var oMatrix = [
[2,3,4,7,1],
[1,5,2,6,2],
[4,3,4,2,1],
[2,1,2,4,1],
[3,1,3,4,1],
[2,1,4,3,2],
[6,9,1,6,4]
]

var nBombs = 0;
do
{
    var bSpacesLeftToBomb = false;
    var nHigh = 0;
    var nCellX = 0;
    var nCellY = 0;
    for(var y = 1 ; y<oMatrix.length-1;y++) 
        for(var x = 1 ; x<oMatrix[y].length-1;x++)  
        {
            var nValue = 0;
            for(var yy = y-1;yy<=y+1;yy++)
                for(var xx = x-1;xx<=x+1;xx++)
                    nValue += oMatrix[yy][xx];

            if(nValue>nHigh)
            {
                nHigh = nValue;
                nCellX = x;
                nCellY = y; 
            }

        }
    if(nHigh>0)
    {
        nBombs++;

        for(var yy = nCellY-1;yy<=nCellY+1;yy++)
        {
            for(var xx = nCellX-1;xx<=nCellX+1;xx++)
            {
                if(oMatrix[yy][xx]<=0)
                    continue;
                oMatrix[yy][xx] = --oMatrix[yy][xx];
            }
        }
        bSpacesLeftToBomb = true;
    }
}
while(bSpacesLeftToBomb);

alert(nBombs+'bombs'); 
```

* * *

## 回答 #16

> 赞同：2
> 
> 时间：2013-03-08T20:39:47.040

这是另一个想法：

让我们首先为板上的每个空间分配一个权重，以了解通过在该处投掷炸弹会减少多少个数字。因此，如果空间有一个非零数，它会得到一个点，如果与它相邻的任何空间有一个非零数，它就会得到一个额外的点。因此，如果有一个 1000×1000 的网格，我们会为 100 万个空间中的每一个分配一个权重。

然后按权重对空格列表进行排序，轰炸权重最高的那个。可以这么说，这是我们最大的收获。

之后，更新每个重量受炸弹影响的空间的重量。这将是您轰炸的空间，以及与其紧邻的任何空间，以及与其紧邻的任何空间。换句话说，任何可能通过轰炸使其价值减少到零的空间，或者相邻空间的价值减少到零。

然后，按权重对列表空间进行重新排序。由于只有一小部分空间的重量因轰炸而改变，因此您无需使用整个列表，只需在列表中移动这些空间即可。

轰炸新的最高重量空间，并重复该过程。

这保证了每次轰炸都会减少尽可能多的空间（基本上，它会尽可能少地击中已经为零的空间），所以这将是最佳的，除了它们可以是权重关系。因此，当最高重量存在平局时，您可能需要进行一些回溯。不过，只有最高重量的领带很重要，其他的领带无关紧要，所以希望它不会有太多的回溯。

**编辑：** 下面 Mysticial 的反例表明，实际上这并不能保证是最佳的，无论权重如何。在某些情况下，在给定的步骤中尽可能地减少重量实际上会使剩余的炸弹过于分散，无法在第二步之后实现尽可能高的累积减少，因为第一步中的贪婪选择稍微少一些。我被认为结果对轰炸顺序不敏感的概念有些误导。他们*是*对顺序不敏感，因为您可以进行任何一系列的轰炸并以不同的顺序从头开始重播它们，最终得到相同的结果板。但这并不意味着您可以独立考虑每次轰炸。或者，至少，每次轰炸都必须考虑到它为随后的轰炸设置董事会的程度。

* * *

## 回答 #17

> 赞同：2
> 
> 时间：2013-03-09T18:30:54.767

为了尽量减少炸弹的数量，我们必须最大化每颗炸弹的效果。为了实现这一目标，我们必须在每一步中选择最佳目标。对于每个点求和它和它的八个邻居 - 可以用作轰炸该点的效率量。这将提供接近最佳的炸弹序列。

**UPD**：我们还应该考虑零的数量，因为轰炸它们效率低下。事实上，问题是尽量减少命中零的数量。但我们不知道任何一步如何使我们更接近这一目标。我同意这个问题是 NP 完全的。我建议采用贪婪的方法，这将给出接近真实的答案。

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2013-03-08T18:00:17.230

如果您想要绝对最优解来清理棋盘，则必须使用经典回溯，但如果矩阵非常大，则需要很长时间才能找到最佳解，如果您想要“可能的”最优解，则可以使用贪心算法，如果您在编写算法时需要帮助，我可以帮助您

想想这是最好的方法。在那里制作另一个矩阵，您通过在那里放置炸弹来存储您删除的点，然后选择具有最大点的单元格并将炸弹放在那里更新点矩阵并继续。例子：

```
2 3 5 -> (2+(1*3)) (3+(1*5)) (5+(1*3))
1 3 2 -> (1+(1*4)) (3+(1*7)) (2+(1*4))
1 0 2 -> (1+(1*2)) (0+(1*5)) (2+(1*2)) 
```

值大于 0 的每个相邻单元格的单元格值 +1

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2013-03-08T18:05:01.830

Well, suppose we number the board positions 1, 2, ..., n x m. Any sequence of bomb drops can be represented by a sequence of numbers in this set, where numbers can repeat. However, the effect on the board is the same regardless of what order you drop the bombs in, so really any choice of bomb drops can be represented as a list of n x m numbers, where the first number represents the number of bombs dropped on position 1, the second number represents the number of bombs dropped on position 2, etc. Let's call this list of n x m numbers the "key".

You could try first calculating all board states resulting from 1 bomb drop, then use these to calculate all board states resulting from 2 bomb drops, etc until you get all zeros. But at each step you would cache the states using the key I defined above, so you can use these results in calculating the next step (a "dynamic programming" approach).

But depending on the size of n, m, and the numbers in the grid, the memory requirements of this approach might be excessive. You can throw away all the results for N bomb drops once you've calculated all the results for N + 1, so there's some savings there. And of course you could not cache anything at the cost of having it take *a lot* longer -- the dynamic programming approach trades memory for speed.

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2013-03-09T16:26:30.063

这是我的解决方案..由于我没有时间，所以我不会用代码写出来，但我相信这应该每次都会产生最佳的移动次数 - 尽管我不确定它在寻找时的效率如何要轰炸的点。

首先，正如@Luka Rahne 在其中一条评论中所说，你轰炸的顺序并不重要——只有组合。

其次，正如许多其他人所说，从角落轰炸对角线 1 是最佳的，因为它接触的点比角落多。

这为我的算法版本奠定了基础：我们可以首先或最后轰炸“从角落开始的一关”，这并不重要（理论上）我们先轰炸那些，因为它使以后的决策更容易（在实践中）我们轰炸影响最多点的点，同时轰炸那些角落。

让我们将**Points Of Resistance**定义为棋盘中具有**最多不可轰炸点**+周围**0 最多的点**

**不可轰炸点**可以定义为我们当前正在查看的棋盘**范围内不存在的点。**

我还将定义 4 个边界来处理我们的范围：Top=0、Left=0、Bottom=k、right=j。（开始的值）

最后，我将**最佳炸弹**定义为投在与阻力点相邻的点上并接触（1）最高阻力点和（2）尽可能多的点的炸弹。

关于方法——很明显我们是从外向内工作。我们将能够同时与 4 个“轰炸机”一起工作。

第一个阻力点显然是我们的角落。“越界”点是不可轰炸的（每个角有 5 个超出范围的点）。所以我们首先从角上对角地轰炸点。

算法：

1.  找到 4 个最佳炸弹点。
2.  如果一个炸弹点正在轰炸一个接触 2 个边界（即一个角）的阻力点，则轰炸该点为 0。否则，轰炸每个点，直到接触最佳炸弹点的阻力点之一为 0。
3.  对于每个界限： if(sum(bound)==0) 提前界限

重复直到 TOP=BOTTOM 和 LEFT=RIGHT

稍后我将尝试编写实际代码

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2013-03-12T22:56:59.967

评价函数，总和：

```
int f (int ** matrix, int width, int height, int x, int y)
{
    int m[3][3] = { 0 };

    m[1][1] = matrix[x][y];
    if (x > 0) m[0][1] = matrix[x-1][y];
    if (x < width-1) m[2][1] = matrix[x+1][y];

    if (y > 0)
    {
        m[1][0] = matrix[x][y-1];
        if (x > 0) m[0][0] = matrix[x-1][y-1];
        if (x < width-1) m[2][0] = matrix[x+1][y-1];
    }

    if (y < height-1)
    {
        m[1][2] = matrix[x][y+1];
        if (x > 0) m[0][2] = matrix[x-1][y+1];
        if (x < width-1) m[2][2] = matrix[x+1][y+1];
    }

    return m[0][0]+m[0][1]+m[0][2]+m[1][0]+m[1][1]+m[1][2]+m[2][0]+m[2][1]+m[2][2];
} 
```

目标函数：

```
Point bestState (int ** matrix, int width, int height)
{
    Point p = new Point(0,0);
    int bestScore = 0;
    int b = 0;

    for (int i=0; i<width; i++)
        for (int j=0; j<height; j++)
        {
            b = f(matrix,width,height,i,j);

            if (b > bestScore)
            {
                bestScore = best;
                p = new Point(i,j);
            }
        }

    retunr p;
} 
```

销毁函数：

```
void destroy (int ** matrix, int width, int height, Point p)
{
    int x = p.x;
    int y = p.y;

    if(matrix[x][y] > 0) matrix[x][y]--;
    if (x > 0) if(matrix[x-1][y] > 0) matrix[x-1][y]--;
    if (x < width-1) if(matrix[x+1][y] > 0) matrix[x+1][y]--;

    if (y > 0)
    {
        if(matrix[x][y-1] > 0) matrix[x][y-1]--;
        if (x > 0) if(matrix[x-1][y-1] > 0) matrix[x-1][y-1]--;
        if (x < width-1) if(matrix[x+1][y-1] > 0) matrix[x+1][y-1]--;
    }

    if (y < height-1)
    {
        if(matrix[x][y] > 0) matrix[x][y+1]--;
        if (x > 0) if(matrix[x-1][y+1] > 0) matrix[x-1][y+1]--;
        if (x < width-1) if(matrix[x+1][y+1] > 0) matrix[x+1][y+1]--;
    }
} 
```

目标函数：

```
bool isGoal (int ** matrix, int width, int height)
{
    for (int i=0; i<width; i++)
        for (int j=0; j<height; j++)
            if (matrix[i][j] > 0)
                return false;
    return true;
} 
```

线性最大化函数：

```
void solve (int ** matrix, int width, int height)
{
    while (!isGoal(matrix,width,height))
    {
        destroy(matrix,width,height, bestState(matrix,width,height));
    }
} 
```

这不是最优的，但可以通过找到更好的评估函数来优化..

..但是考虑到这个问题，我认为主要问题之一是在某个时候在零中间得到被遗弃的数字，所以我会采取另一种方法..将最小值控制为零，然后尝试尽可能转义零，这导致最小现有值的一般最小化左右

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2013-03-08T18:17:07.867

1.  永远不要轰炸边界（除非正方形没有非边界邻居）
2.  零角。
3.  零角，将角的值下降一平方对角线（唯一的非边界邻居）
4.  这将创建新的角落。前往 2

编辑：没有注意到 Kostek 提出了几乎相同的方法，所以现在我提出更强有力的主张：如果选择要清除的角落总是在最外层，那么它是最佳的。

在 OP 的示例中：将 2（作为 1+1 或 2）放在 5 以外的任何东西上不会导致击中任何放在 5 上会击中的方格。所以我们必须将 2 放在 5 上（以及 6 放在左下方 1 ...）

在此之后，只有一种方法可以清除（在左上角）原来的 1（现在为 0），即在 B3 上删除 0（类似于符号的 Excel）。等等。

只有在清除了整个 A 和 E 列以及 1 和 7 行之后，才开始清除更深的一层。

只考虑清除那些有意清除的，清除 0 值角不花费任何成本并简化思考。

因为以这种方式投下的所有炸弹都必须投下，这会导致空地，这是最佳解决方案。

* * *

经过良好的睡眠，我意识到这不是真的。考虑

```
 ABCDE    
1 01000
2 10000
3 00000
4 00000 
```

我的方法是在 B3 和 C2 上投放炸弹，而在 B2 上投放就足够了

* * *

## 回答 #23

> 赞同：1
> 
> 时间：2013-03-12T05:17:10.183

这可以使用深度为 O(3^(n)) 的树来解决。其中 n 是所有平方的总和。

首先考虑用 O(9^n) 的树来解决问题是微不足道的，只需考虑所有可能的轰炸位置。有关示例，请参见[Alfe 的实现](https://stackoverflow.com/a/15306421/431079)。

接下来意识到我们可以从下到上进行轰炸，并且仍然获得最小轰炸模式。

1.  从左下角开始。
2.  用唯一有意义的戏剧（向上和向右）将其轰炸到遗忘。
3.  向右移动一格。
4.  虽然目标的值大于零，但考虑两个有意义的玩法（直接向上或向上和向右），将目标的值减少 1，并为每种可能性创建一个新分支。
5.  向右移动另一个。
6.  虽然目标的值大于零，但考虑三个有意义的游戏（左上、上和右上）中的每一个，将目标的值减一，并为每种可能性创建一个新分支。
7.  重复步骤 5 和 6，直到该行被消除。
8.  向上移动一行并重复步骤 1 到 7，直到拼图解决。

这个算法是正确的，因为

1.  有必要在某个时候完成每一行。
2.  完成一行总是需要在该行的上方、下方或在该行内进行游戏。
3.  选择最低未清除行上方的游戏总是与该行或该行下方的游戏一样好或更好。

在实践中，该算法通常会比其理论最大值做得更好，因为它会定期轰炸邻居并减少搜索的大小。如果我们假设每次轰炸都会减少 4 个额外目标的值，那么我们的算法将在 O(3^(n/4)) 或大约 O(1.3^n) 中运行。

因为这个算法仍然是指数的，所以限制搜索的深度是明智的。我们可能会将允许的分支数量限制为某个数字 X，一旦我们达到这个深度，我们就会强制算法选择它迄今为止识别的最佳路径（在它的一个终端叶中具有最小总棋盘总和的路径） ）。那么我们的算法保证在 O(3^X) 时间内运行，但不能保证得到正确答案。但是，如果增加计算量和更好的答案之间的权衡是值得的，我们总是可以增加 X 并进行经验测试。

* * *

## 回答 #24

> 赞同：1
> 
> 时间：2013-03-11T00:21:17.737

这里似乎有一个非二分匹配子结构。考虑以下实例：

```
0010000
1000100
0000001
1000000
0000001
1000100
0010000 
```

这种情况的最佳解决方案的大小为 5，因为这是 9 循环的顶点对其边缘的最小覆盖的大小。

特别是这个案例表明，一些人发布的线性规划松弛并不准确，不起作用，以及所有其他不好的事情。我很确定我可以减少“用尽可能少的边覆盖我的平面三次图的顶点”来解决您的问题，这让我怀疑任何贪婪/爬山解决方案是否会起作用。

在最坏的情况下，我看不到在多项式时间内解决此问题的方法。可能有一个我没有看到的非常聪明的二进制搜索和 DP 解决方案。

**编辑**：我看到比赛（[http://deadline24.pl](http://deadline24.pl)）与语言无关；他们向您发送一堆输入文件，然后您向他们发送输出。所以你不需要在最坏情况多项式时间内运行的东西。特别是，您可以*查看输入*！

输入中有一堆小案例。然后有一个 10x1000 的情况，一个 100x100 的情况和一个 1000x1000 的情况。三个大案子都非常乖巧。水平相邻的条目通常具有相同的值。在一台相对强大的机器上，我能够在几分钟内通过使用 CPLEX 暴力破解来解决所有问题。我在 1000x1000 上很幸运；LP 松弛恰好有一个积分最优解。我的解决方案与`.ans`测试数据包中提供的文件一致。

我敢打赌，如果您看一下，您可以以比我更直接的方式使用输入的结构；似乎您可以反复削减第一行或两行或三行，直到一无所有。（看起来，在 1000x1000 中，所有行都没有增加？我猜这就是你的“B 部分”的来源？）

* * *

## 回答 #25

> 赞同：1
> 
> 时间：2013-03-10T03:52:12.143

您可以使用状态空间规划。例如，使用 A*（或其变体之一）加上`f = g + h`这样的启发式：

*   g：到目前为止投下的炸弹数量
*   h：将网格的所有值相加除以 9（这是最好的结果，这意味着我们有一个可接受的启发式）

* * *

## 回答 #26

> 赞同：1
> 
> 时间：2013-03-12T10:01:50.810

如果不使用我最好的启发式计算轰炸活动，我想不出一种方法来计算实际数字，并希望我能得到一个合理的结果。

所以我的方法是计算每个单元格的轰炸效率指标，轰炸具有最高值的单元格，....迭代过程，直到我把所有东西都弄平。一些人主张使用简单的潜在损坏（即从 0 到 9 的分数）作为衡量标准，但由于敲击高价值单元而不使用损坏重叠而达不到要求。我会计算`cell value - sum of all neighbouring cells`，将任何正数重置为 0 并使用任何负数的绝对值。直观地说，这个指标应该做出一个选择，以帮助最大化对高计数细胞的损伤重叠，而不是直接冲击那些细胞。

下面的代码在 28 枚炸弹中达到了对测试场的完全破坏（请注意，使用潜在损坏作为度量会产生 31！）。

```
using System;
using System.Collections.Generic;
using System.Linq;

namespace StackOverflow
{
  internal class Program
  {
    // store the battle field as flat array + dimensions
    private static int _width = 5;
    private static int _length = 7;
    private static int[] _field = new int[] {
        2, 3, 4, 7, 1,
        1, 5, 2, 6, 2,
        4, 3, 4, 2, 1,
        2, 1, 2, 4, 1,
        3, 1, 3, 4, 1,
        2, 1, 4, 3, 2,
        6, 9, 1, 6, 4
    };
    // this will store the devastation metric
    private static int[] _metric;

    // do the work
    private static void Main(string[] args)
    {
        int count = 0;

        while (_field.Sum() > 0)
        {
            Console.Out.WriteLine("Round {0}:", ++count);
            GetBlastPotential();
            int cell_to_bomb = FindBestBombingSite();
            PrintField(cell_to_bomb);
            Bomb(cell_to_bomb);
        }
        Console.Out.WriteLine("Done in {0} rounds", count);
    } 

    // convert 2D position to 1D index
    private static int Get1DCoord(int x, int y)
    {
        if ((x < 0) || (y < 0) || (x >= _width) || (y >= _length)) return -1;
        else
        {
            return (y * _width) + x;
        }
    }

    // Convert 1D index to 2D position
    private static void Get2DCoord(int n, out int x, out int y)
    {
        if ((n < 0) || (n >= _field.Length))
        {
            x = -1;
            y = -1;
        }
        else
        {
            x = n % _width;
            y = n / _width;
        }
    }

    // Compute a list of 1D indices for a cell neighbours
    private static List<int> GetNeighbours(int cell)
    {
        List<int> neighbours = new List<int>();
        int x, y;
        Get2DCoord(cell, out x, out y);
        if ((x >= 0) && (y >= 0))
        {
            List<int> tmp = new List<int>();
            tmp.Add(Get1DCoord(x - 1, y - 1));
            tmp.Add(Get1DCoord(x - 1, y));
            tmp.Add(Get1DCoord(x - 1, y + 1));
            tmp.Add(Get1DCoord(x, y - 1));
            tmp.Add(Get1DCoord(x, y + 1));
            tmp.Add(Get1DCoord(x + 1, y - 1));
            tmp.Add(Get1DCoord(x + 1, y));
            tmp.Add(Get1DCoord(x + 1, y + 1));

            // eliminate invalid coords - i.e. stuff past the edges
            foreach (int c in tmp) if (c >= 0) neighbours.Add(c);
        }
        return neighbours;
    }

    // Compute the devastation metric for each cell
    // Represent the Value of the cell minus the sum of all its neighbours
    private static void GetBlastPotential()
    {
        _metric = new int[_field.Length];
        for (int i = 0; i < _field.Length; i++)
        {
            _metric[i] = _field[i];
            List<int> neighbours = GetNeighbours(i);
            if (neighbours != null)
            {
                foreach (int j in neighbours) _metric[i] -= _field[j];
            }
        }
        for (int i = 0; i < _metric.Length; i++)
        {
            _metric[i] = (_metric[i] < 0) ? Math.Abs(_metric[i]) : 0;
        }
    }

    //// Compute the simple expected damage a bomb would score
    //private static void GetBlastPotential()
    //{
    //    _metric = new int[_field.Length];
    //    for (int i = 0; i < _field.Length; i++)
    //    {
    //        _metric[i] = (_field[i] > 0) ? 1 : 0;
    //        List<int> neighbours = GetNeighbours(i);
    //        if (neighbours != null)
    //        {
    //            foreach (int j in neighbours) _metric[i] += (_field[j] > 0) ? 1 : 0;
    //        }
    //    }            
    //}

    // Update the battle field upon dropping a bomb
    private static void Bomb(int cell)
    {
        List<int> neighbours = GetNeighbours(cell);
        foreach (int i in neighbours)
        {
            if (_field[i] > 0) _field[i]--;
        }
    }

    // Find the best bombing site - just return index of local maxima
    private static int FindBestBombingSite()
    {
        int max_idx = 0;
        int max_val = int.MinValue;
        for (int i = 0; i < _metric.Length; i++)
        {
            if (_metric[i] > max_val)
            {
                max_val = _metric[i];
                max_idx = i;
            }
        }
        return max_idx;
    }

    // Display the battle field on the console
    private static void PrintField(int cell)
    {
        for (int x = 0; x < _width; x++)
        {
            for (int y = 0; y < _length; y++)
            {
                int c = Get1DCoord(x, y);
                if (c == cell)
                    Console.Out.Write(string.Format("[{0}]", _field[c]).PadLeft(4));
                else
                    Console.Out.Write(string.Format(" {0} ", _field[c]).PadLeft(4));
            }
            Console.Out.Write(" || ");
            for (int y = 0; y < _length; y++)
            {
                int c = Get1DCoord(x, y);
                if (c == cell)
                    Console.Out.Write(string.Format("[{0}]", _metric[c]).PadLeft(4));
                else
                    Console.Out.Write(string.Format(" {0} ", _metric[c]).PadLeft(4));
            }
            Console.Out.WriteLine();
        }
        Console.Out.WriteLine();
    }           
  }
} 
```

生成的轰炸模式输出如下（左侧的字段值，右侧的度量）

```
Round 1:
  2   1   4   2   3   2   6  ||   7  16   8  10   4  18   6
  3   5   3   1   1   1   9  ||  11  18  18  21  17  28   5
  4  [2]  4   2   3   4   1  ||  19 [32] 21  20  17  24  22
  7   6   2   4   4   3   6  ||   8  17  20  14  16  22   8
  1   2   1   1   1   2   4  ||  14  15  14  11  13  16   7

Round 2:
  2   1   4   2   3   2   6  ||   5  13   6   9   4  18   6
  2   4   2   1   1  [1]  9  ||  10  15  17  19  17 [28]  5
  3   2   3   2   3   4   1  ||  16  24  18  17  17  24  22
  6   5   1   4   4   3   6  ||   7  14  19  12  16  22   8
  1   2   1   1   1   2   4  ||  12  12  12  10  13  16   7

Round 3:
  2   1   4   2   2   1   5  ||   5  13   6   7   3  15   5
  2   4   2   1   0   1   8  ||  10  15  17  16  14  20   2
  3  [2]  3   2   2   3   0  ||  16 [24] 18  15  16  21  21
  6   5   1   4   4   3   6  ||   7  14  19  11  14  19   6
  1   2   1   1   1   2   4  ||  12  12  12  10  13  16   7

Round 4:
  2   1   4   2   2   1   5  ||   3  10   4   6   3  15   5
  1   3   1   1   0   1   8  ||   9  12  16  14  14  20   2
  2   2   2   2   2  [3]  0  ||  13  16  15  12  16 [21] 21
  5   4   0   4   4   3   6  ||   6  11  18   9  14  19   6
  1   2   1   1   1   2   4  ||  10   9  10   9  13  16   7

Round 5:
  2   1   4   2   2   1   5  ||   3  10   4   6   2  13   3
  1   3   1   1   0  [0]  7  ||   9  12  16  13  12 [19]  2
  2   2   2   2   1   3   0  ||  13  16  15  10  14  15  17
  5   4   0   4   3   2   5  ||   6  11  18   7  13  17   6
  1   2   1   1   1   2   4  ||  10   9  10   8  11  13   5

Round 6:
  2   1   4   2   1   0   4  ||   3  10   4   5   2  11   2
  1   3   1   1   0   0   6  ||   9  12  16  11   8  13   0
  2   2   2   2   0   2   0  ||  13  16  15   9  14  14  15
  5   4  [0]  4   3   2   5  ||   6  11 [18]  6  11  15   5
  1   2   1   1   1   2   4  ||  10   9  10   8  11  13   5

Round 7:
  2   1   4   2   1   0   4  ||   3  10   4   5   2  11   2
  1   3   1   1   0   0   6  ||   8  10  13   9   7  13   0
  2  [1]  1   1   0   2   0  ||  11 [15] 12   8  12  14  15
  5   3   0   3   3   2   5  ||   3   8  10   3   8  15   5
  1   1   0   0   1   2   4  ||   8   8   7   7   9  13   5

Round 8:
  2   1   4   2   1   0   4  ||   1   7   2   4   2  11   2
  0   2   0   1   0   0   6  ||   7   7  12   7   7  13   0
  1   1   0   1   0   2   0  ||   8   8  10   6  12  14  15
  4   2   0   3   3  [2]  5  ||   2   6   8   2   8 [15]  5
  1   1   0   0   1   2   4  ||   6   6   6   7   9  13   5

Round 9:
  2   1   4   2   1   0   4  ||   1   7   2   4   2  11   2
  0   2   0   1   0   0   6  ||   7   7  12   7   6  12   0
  1   1   0   1   0  [1]  0  ||   8   8  10   5  10 [13] 13
  4   2   0   3   2   2   4  ||   2   6   8   0   6   9   3
  1   1   0   0   0   1   3  ||   6   6   6   5   8  10   4

Round 10:
  2   1   4   2   1   0   4  ||   1   7   2   4   2  10   1
  0   2  [0]  1   0   0   5  ||   7   7 [12]  7   6  11   0
  1   1   0   1   0   1   0  ||   8   8  10   4   8   9  10
  4   2   0   3   1   1   3  ||   2   6   8   0   6   8   3
  1   1   0   0   0   1   3  ||   6   6   6   4   6   7   2

Round 11:
  2   0   3   1   1   0   4  ||   0   6   0   3   0  10   1
  0   1   0   0   0  [0]  5  ||   4   5   5   5   3 [11]  0
  1   0   0   0   0   1   0  ||   6   8   6   4   6   9  10
  4   2   0   3   1   1   3  ||   1   5   6   0   5   8   3
  1   1   0   0   0   1   3  ||   6   6   6   4   6   7   2

Round 12:
  2   0   3   1   0   0   3  ||   0   6   0   2   1   7   1
  0   1   0   0   0   0   4  ||   4   5   5   4   1   7   0
  1   0   0   0   0  [0]  0  ||   6   8   6   4   5  [9]  8
  4   2   0   3   1   1   3  ||   1   5   6   0   4   7   2
  1   1   0   0   0   1   3  ||   6   6   6   4   6   7   2

Round 13:
  2   0   3   1   0   0   3  ||   0   6   0   2   1   6   0
  0   1   0   0   0   0   3  ||   4   5   5   4   1   6   0
  1  [0]  0   0   0   0   0  ||   6  [8]  6   3   3   5   5
  4   2   0   3   0   0   2  ||   1   5   6   0   4   6   2
  1   1   0   0   0   1   3  ||   6   6   6   3   4   4   0

Round 14:
  2   0   3   1   0  [0]  3  ||   0   5   0   2   1  [6]  0
  0   0   0   0   0   0   3  ||   2   5   4   4   1   6   0
  0   0   0   0   0   0   0  ||   4   4   4   3   3   5   5
  3   1   0   3   0   0   2  ||   0   4   5   0   4   6   2
  1   1   0   0   0   1   3  ||   4   4   5   3   4   4   0

Round 15:
  2   0   3   1   0   0   2  ||   0   5   0   2   1   4   0
  0   0   0   0   0   0   2  ||   2   5   4   4   1   4   0
  0   0   0   0   0   0   0  ||   4   4   4   3   3   4   4
  3   1   0   3   0  [0]  2  ||   0   4   5   0   4  [6]  2
  1   1   0   0   0   1   3  ||   4   4   5   3   4   4   0

Round 16:
  2  [0]  3   1   0   0   2  ||   0  [5]  0   2   1   4   0
  0   0   0   0   0   0   2  ||   2   5   4   4   1   4   0
  0   0   0   0   0   0   0  ||   4   4   4   3   3   3   3
  3   1   0   3   0   0   1  ||   0   4   5   0   3   3   1
  1   1   0   0   0   0   2  ||   4   4   5   3   3   3   0

Round 17:
  1   0   2   1   0   0   2  ||   0   3   0   1   1   4   0
  0   0   0   0   0   0   2  ||   1   3   3   3   1   4   0
  0   0   0   0   0   0   0  ||   4   4   4   3   3   3   3
  3   1  [0]  3   0   0   1  ||   0   4  [5]  0   3   3   1
  1   1   0   0   0   0   2  ||   4   4   5   3   3   3   0

Round 18:
  1   0   2   1   0   0   2  ||   0   3   0   1   1   4   0
  0   0   0   0   0   0   2  ||   1   3   3   3   1   4   0
  0   0   0   0   0   0   0  ||   3   3   2   2   2   3   3
  3  [0]  0   2   0   0   1  ||   0  [4]  2   0   2   3   1
  1   0   0   0   0   0   2  ||   2   4   2   2   2   3   0

Round 19:
  1   0   2   1   0  [0]  2  ||   0   3   0   1   1  [4]  0
  0   0   0   0   0   0   2  ||   1   3   3   3   1   4   0
  0   0   0   0   0   0   0  ||   2   2   2   2   2   3   3
  2   0   0   2   0   0   1  ||   0   2   2   0   2   3   1
  0   0   0   0   0   0   2  ||   2   2   2   2   2   3   0

Round 20:
  1  [0]  2   1   0   0   1  ||   0  [3]  0   1   1   2   0
  0   0   0   0   0   0   1  ||   1   3   3   3   1   2   0
  0   0   0   0   0   0   0  ||   2   2   2   2   2   2   2
  2   0   0   2   0   0   1  ||   0   2   2   0   2   3   1
  0   0   0   0   0   0   2  ||   2   2   2   2   2   3   0

Round 21:
  0   0   1   1   0   0   1  ||   0   1   0   0   1   2   0
  0   0   0   0   0   0   1  ||   0   1   2   2   1   2   0
  0   0   0   0   0   0   0  ||   2   2   2   2   2   2   2
  2   0   0   2   0  [0]  1  ||   0   2   2   0   2  [3]  1
  0   0   0   0   0   0   2  ||   2   2   2   2   2   3   0

Round 22:
  0   0   1   1   0   0   1  ||   0   1   0   0   1   2   0
  0   0   0   0   0   0   1  ||   0   1   2   2   1   2   0
 [0]  0   0   0   0   0   0  ||  [2]  2   2   2   2   1   1
  2   0   0   2   0   0   0  ||   0   2   2   0   2   1   1
  0   0   0   0   0   0   1  ||   2   2   2   2   2   1   0

Round 23:
  0   0   1   1   0   0   1  ||   0   1   0   0   1   2   0
  0   0  [0]  0   0   0   1  ||   0   1  [2]  2   1   2   0
  0   0   0   0   0   0   0  ||   1   1   2   2   2   1   1
  1   0   0   2   0   0   0  ||   0   1   2   0   2   1   1
  0   0   0   0   0   0   1  ||   1   1   2   2   2   1   0

Round 24:
  0   0   0   0   0   0   1  ||   0   0   0   0   0   2   0
  0   0   0   0   0   0   1  ||   0   0   0   0   0   2   0
  0   0  [0]  0   0   0   0  ||   1   1  [2]  2   2   1   1
  1   0   0   2   0   0   0  ||   0   1   2   0   2   1   1
  0   0   0   0   0   0   1  ||   1   1   2   2   2   1   0

Round 25:
  0   0   0   0   0  [0]  1  ||   0   0   0   0   0  [2]  0
  0   0   0   0   0   0   1  ||   0   0   0   0   0   2   0
  0   0   0   0   0   0   0  ||   1   1   1   1   1   1   1
  1   0   0   1   0   0   0  ||   0   1   1   0   1   1   1
  0   0   0   0   0   0   1  ||   1   1   1   1   1   1   0

Round 26:
  0   0   0   0   0   0   0  ||   0   0   0   0   0   0   0
  0   0   0   0   0   0   0  ||   0   0   0   0   0   0   0
 [0]  0   0   0   0   0   0  ||  [1]  1   1   1   1   0   0
  1   0   0   1   0   0   0  ||   0   1   1   0   1   1   1
  0   0   0   0   0   0   1  ||   1   1   1   1   1   1   0

Round 27:
  0   0   0   0   0   0   0  ||   0   0   0   0   0   0   0
  0   0   0   0   0   0   0  ||   0   0   0   0   0   0   0
  0   0  [0]  0   0   0   0  ||   0   0  [1]  1   1   0   0
  0   0   0   1   0   0   0  ||   0   0   1   0   1   1   1
  0   0   0   0   0   0   1  ||   0   0   1   1   1   1   0

Round 28:
  0   0   0   0   0   0   0  ||   0   0   0   0   0   0   0
  0   0   0   0   0   0   0  ||   0   0   0   0   0   0   0
  0   0   0   0   0   0   0  ||   0   0   0   0   0   0   0
  0   0   0   0   0  [0]  0  ||   0   0   0   0   0  [1]  1
  0   0   0   0   0   0   1  ||   0   0   0   0   0   1   0

Done in 28 rounds 
```

* * *

## 回答 #27

> 赞同：1
> 
> 时间：2013-03-09T00:48:01.733

蛮力！

我知道它效率不高，但即使你找到了一个更快的算法，你也可以随时测试这个结果以了解它的准确度。

使用一些递归，如下所示：

```
void fn(tableState ts, currentlevel cl)
{
  // first check if ts is all zeros yet, if not:
  //
  // do a for loop to go through all cells of ts, 
  // for each cell do a bomb, and then
  // call: 
  // fn(ts, cl + 1);

} 
```

您可以通过缓存来提高效率，如果不同的方式导致相同的结果，则不应重复相同的步骤。

详细说明：

如果轰炸单元格 1,3,5 导致与轰炸单元格 5,3,1 相同的结果，那么，对于这两种情况，您不应该再次重新执行所有后续步骤，只有 1 就足够了，您应该将所有内容存储在某个地方表状态并使用其结果。

表统计信息的散列可用于进行快速比较。

* * *

## 回答 #28

> 赞同：1
> 
> 时间：2013-03-09T22:14:47.893

我也有28个动作。我使用了两个测试来确定最好的下一步：首先是产生棋盘最小和的棋步。其次，对于相等的和，产生最大密度的移动，定义为：

```
number-of-zeros / number-of-groups-of-zeros 
```

这是哈斯克尔。“解决板”显示引擎的解决方案。您可以通过输入“main”来玩游戏，然后输入目标点，“best”表示推荐，或“quit”表示退出。

输出：
*Main> 求解板
[(4,4),(3,6),(3,3),(2,2),(2,2),(4,6),(4,6), (2,6),(3,2),(4,2),(2,6),(3,3),(4,3),(2,6),(4,2),(4 ,6),(4,6),(3,6),(2,6),(2,6),(2,4),(2,4),(2,6),(3,6 ),(4,2),(4,2),(4,2),(4,2)]

```
import Data.List
import Data.List.Split
import Data.Ord
import Data.Function(on)

board = [2,3,4,7,1,
         1,5,2,6,2,
         4,3,4,2,1,
         2,1,2,4,1,
         3,1,3,4,1,
         2,1,4,3,2,
         6,9,1,6,4]

n = 5
m = 7

updateBoard board pt =
  let x = fst pt
      y = snd pt
      precedingLines = replicate ((y-2) * n) 0
      bomb = concat $ replicate (if y == 1
                                    then 2
                                    else min 3 (m+2-y)) (replicate (x-2) 0 
                                                         ++ (if x == 1 
                                                                then [1,1]
                                                                else replicate (min 3 (n+2-x)) 1)
                                                                ++ replicate (n-(x+1)) 0)
  in zipWith (\a b -> max 0 (a-b)) board (precedingLines ++ bomb ++ repeat 0)

showBoard board = 
  let top = "   " ++ (concat $ map (\x -> show x ++ ".") [1..n]) ++ "\n"
      chunks = chunksOf n board
  in putStrLn (top ++ showBoard' chunks "" 1)
       where showBoard' []     str count = str
             showBoard' (x:xs) str count =
               showBoard' xs (str ++ show count ++ "." ++ show x ++ "\n") (count+1)

instances _ [] = 0
instances x (y:ys)
  | x == y    = 1 + instances x ys
  | otherwise = instances x ys

density a = 
  let numZeros = instances 0 a
      groupsOfZeros = filter (\x -> head x == 0) (group a)
  in if null groupsOfZeros then 0 else numZeros / fromIntegral (length groupsOfZeros)

boardDensity board = sum (map density (chunksOf n board))

moves = [(a,b) | a <- [2..n-1], b <- [2..m-1]]               

bestMove board = 
  let lowestSumMoves = take 1 $ groupBy ((==) `on` snd) 
                              $ sortBy (comparing snd) (map (\x -> (x, sum $ updateBoard board x)) (moves))
  in if null lowestSumMoves
        then (0,0)
        else let lowestSumMoves' = map (\x -> fst x) (head lowestSumMoves) 
             in fst $ head $ reverse $ sortBy (comparing snd) 
                (map (\x -> (x, boardDensity $ updateBoard board x)) (lowestSumMoves'))   

solve board = solve' board [] where
  solve' board result
    | sum board == 0 = result
    | otherwise      = 
        let best = bestMove board 
        in solve' (updateBoard board best) (result ++ [best])

main :: IO ()
main = mainLoop board where
  mainLoop board = do 
    putStrLn ""
    showBoard board
    putStr "Pt: "
    a <- getLine
    case a of 
      "quit"    -> do putStrLn ""
                      return ()
      "best"    -> do putStrLn (show $ bestMove board)
                      mainLoop board
      otherwise -> let ws = splitOn "," a
                       pt = (read (head ws), read (last ws))
                   in do mainLoop (updateBoard board pt) 
```

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2013-03-08T19:13:00.900

**这是对第一个问题的回答。我没有注意到他改变了参数。**

创建所有目标的列表。根据受跌落影响的正值的数量（本身和所有邻居）为目标分配一个值。最高值将是九。

按受影响目标的数量对目标进行排序（降序），对每个受影响目标的总和进行二次降序排序。

向排名最高的目标投掷炸弹，然后重新计算目标并重复，直到所有目标值都为零。

同意，这并不*总是*最佳的。例如，

```
100011
011100
011100
011100
000000
100011 
```

这种方法需要 5 颗炸弹才能清除。不过，最理想的情况是，您可以在 4 内完成。不过，非常接近并且没有回溯。对于大多数情况，它将是最佳的，或者非常接近。

使用原始问题编号，这种方法解决了 28 个炸弹。

添加代码来演示这种方法（使用带有按钮的表单）：

```
 private void button1_Click(object sender, EventArgs e)
    {
        int[,] matrix = new int[10, 10] {{5, 20, 7, 1, 9, 8, 19, 16, 11, 3}, 
                                         {17, 8, 15, 17, 12, 4, 5, 16, 8, 18},
                                         { 4, 19, 12, 11, 9, 7, 4, 15, 14, 6},
                                         { 17, 20, 4, 9, 19, 8, 17, 2, 10, 8},
                                         { 3, 9, 10, 13, 8, 9, 12, 12, 6, 18}, 
                                         {16, 16, 2, 10, 7, 12, 17, 11, 4, 15},
                                         { 11, 1, 15, 1, 5, 11, 3, 12, 8, 3},
                                         { 7, 11, 16, 19, 17, 11, 20, 2, 5, 19},
                                         { 5, 18, 2, 17, 7, 14, 19, 11, 1, 6},
                                         { 13, 20, 8, 4, 15, 10, 19, 5, 11, 12}};

        int value = 0;
        List<Target> Targets = GetTargets(matrix);
        while (Targets.Count > 0)
        {
            BombTarget(ref matrix, Targets[0]);
            value += 1;
            Targets = GetTargets(matrix);
        }
        Console.WriteLine( value);
        MessageBox.Show("done: " + value);
    }

    private static void BombTarget(ref int[,] matrix, Target t)
    {
        for (int a = t.x - 1; a <= t.x + 1; a++)
        {
            for (int b = t.y - 1; b <= t.y + 1; b++)
            {
                if (a >= 0 && a <= matrix.GetUpperBound(0))
                {
                    if (b >= 0 && b <= matrix.GetUpperBound(1))
                    {
                        if (matrix[a, b] > 0)
                        {
                            matrix[a, b] -= 1;
                        }
                    }
                }
            }
        }
        Console.WriteLine("Dropped bomb on " + t.x + "," + t.y);
    }

    private static List<Target> GetTargets(int[,] matrix)
    {
        List<Target> Targets = new List<Target>();
        int width = matrix.GetUpperBound(0);
        int height = matrix.GetUpperBound(1);
        for (int x = 0; x <= width; x++)
        {
            for (int y = 0; y <= height; y++)
            {
                Target t = new Target();
                t.x = x;
                t.y = y;
                SetTargetValue(matrix, ref t);
                if (t.value > 0) Targets.Add(t);
            }
        }
        Targets = Targets.OrderByDescending(x => x.value).ThenByDescending( x => x.sum).ToList();
        return Targets;
    }

    private static void SetTargetValue(int[,] matrix, ref Target t)
    {
        for (int a = t.x - 1; a <= t.x + 1; a++)
        {
            for (int b = t.y - 1; b <= t.y + 1; b++)
            {
                if (a >= 0 && a <= matrix.GetUpperBound(0))
                {
                    if (b >= 0 && b <= matrix.GetUpperBound(1))
                    {
                        if (matrix[ a, b] > 0)
                        {
                            t.value += 1;
                            t.sum += matrix[a,b];
                        }

                    }
                }
            }
        }

    } 
```

您将需要的课程：

```
 class Target
    {
        public int value;
        public int sum;
        public int x;
        public int y;
    } 
```

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2013-03-09T23:38:24.763

所有这些问题归结为计算编辑距离。只需计算给定矩阵和零矩阵之间的 Levenshtein 距离的变体，其中编辑被替换为轰炸，使用动态编程来存储中间数组之间的距离。我建议使用矩阵的散列作为键。在伪 Python 中：

```
memo = {}

def bomb(matrix,i,j):
    # bomb matrix at i,j

def bombsRequired(matrix,i,j):
    # bombs required to zero matrix[i,j]

def distance(m1, i, len1, m2, j, len2):
    key = hash(m1)
    if memo[key] != None: 
        return memo[key]

    if len1 == 0: return len2
    if len2 == 0: return len1

    cost = 0
    if m1 != m2: cost = m1[i,j]
    m = bomb(m1,i,j)
    dist = distance(str1,i+1,len1-1,str2,j+1,len2-1)+cost)
    memo[key] = dist
    return dist 
```

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2013-09-06T09:49:17.413

最慢但最简单且无错误的算法是生成并测试所有有效的可能性。对于这种情况非常简单（因为结果与炸弹放置的顺序无关）。

1.  创建 N 次应用 bomp 的函数
2.  为所有 bompb-placement/bomb-count 可能性创建循环（当 matrix==0 时停止）
3.  永远记住最好的解决方案。
4.  在循环结束时，你有最好的解决方案
    *   不仅是炸弹的数量，还有它们的位置

代码可能如下所示：

```
void copy(int **A,int **B,int m,int n)
    {
    for (int i=0;i<m;i++)
     for (int j=0;i<n;j++)
       A[i][j]=B[i][j];
    }

bool is_zero(int **M,int m,int n)
    {
    for (int i=0;i<m;i++)
     for (int j=0;i<n;j++)
      if (M[i][j]) return 0;
    return 1;
    }

void drop_bomb(int **M,int m,int n,int i,int j,int N)
    {
    int ii,jj;
    ii=i-1; jj=j-1; if ((ii>=0)&&(ii<m)&&(jj>=0)&&(jj<n)&&(M[ii][jj])) { M[ii][jj]-=N; if (M[ii][jj]<0) M[ii][jj]=0; }
    ii=i-1; jj=j  ; if ((ii>=0)&&(ii<m)&&(jj>=0)&&(jj<n)&&(M[ii][jj])) { M[ii][jj]-=N; if (M[ii][jj]<0) M[ii][jj]=0; }
    ii=i-1; jj=j+1; if ((ii>=0)&&(ii<m)&&(jj>=0)&&(jj<n)&&(M[ii][jj])) { M[ii][jj]-=N; if (M[ii][jj]<0) M[ii][jj]=0; }
    ii=i  ; jj=j-1; if ((ii>=0)&&(ii<m)&&(jj>=0)&&(jj<n)&&(M[ii][jj])) { M[ii][jj]-=N; if (M[ii][jj]<0) M[ii][jj]=0; }
    ii=i  ; jj=j  ; if ((ii>=0)&&(ii<m)&&(jj>=0)&&(jj<n)&&(M[ii][jj])) { M[ii][jj]-=N; if (M[ii][jj]<0) M[ii][jj]=0; }
    ii=i  ; jj=j+1; if ((ii>=0)&&(ii<m)&&(jj>=0)&&(jj<n)&&(M[ii][jj])) { M[ii][jj]-=N; if (M[ii][jj]<0) M[ii][jj]=0; }
    ii=i+1; jj=j-1; if ((ii>=0)&&(ii<m)&&(jj>=0)&&(jj<n)&&(M[ii][jj])) { M[ii][jj]-=N; if (M[ii][jj]<0) M[ii][jj]=0; }
    ii=i+1; jj=j  ; if ((ii>=0)&&(ii<m)&&(jj>=0)&&(jj<n)&&(M[ii][jj])) { M[ii][jj]-=N; if (M[ii][jj]<0) M[ii][jj]=0; }
    ii=i+1; jj=j+1; if ((ii>=0)&&(ii<m)&&(jj>=0)&&(jj<n)&&(M[ii][jj])) { M[ii][jj]-=N; if (M[ii][jj]<0) M[ii][jj]=0; }
    }

void solve_problem(int **M,int m,int n)
    {
    int i,j,k,max=0;
    // you probably will need to allocate matrices P,TP,TM yourself instead of this:
    int P[m][n],min;             // solution: placement,min bomb count
    int TM[m][n],TP[m][n],cnt;   // temp
    for (i=0;i<m;i++)            // max count of bomb necessary to test
     for (j=0;j<n;j++)
      if (max<M[i][j]) max=M[i][j];
    for (i=0;i<m;i++)            // reset solution
     for (j=0;j<n;j++)
      P[i][j]=max;
    min=m*n*max; 
        copy(TP,P,m,n); cnt=min;

    for (;;)  // generate all possibilities
        {
        copy(TM,M,m,n);
        for (i=0;i<m;i++)   // test solution
         for (j=0;j<n;j++)
          drop_bomb(TM,m,n,TP[i][j]);
        if (is_zero(TM,m,n))// is solution
         if (min>cnt)       // is better solution -> store it
            {
            copy(P,TP,m,n); 
            min=cnt;    
            }
        // go to next possibility
        for (i=0,j=0;;)
            {
            TP[i][j]--;
            if (TP[i][j]>=0) break;
            TP[i][j]=max;
                 i++; if (i<m) break;
            i=0; j++; if (j<n) break;
            break;
            }
        if (is_zero(TP,m,n)) break;
        }
    //result is in P,min
    } 
```

这可以通过多种方式进行优化，...最简单的是使用 M 矩阵重置解决方案，但您需要更改最大值以及 TP[][] 减量代码

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2014-06-08T00:00:11.233

到目前为止，有几个答案给出了指数时间，一些涉及动态规划。我怀疑这些是否有必要。

我的解决方案是**O(mnS)**，其中*m，n*是棋盘的尺寸，*S*是所有整数的总和。这个想法相当暴力：找到每次可以杀死最多的位置并在0处终止。

它为给定的棋盘提供 28 步移动，并在每次下降后打印出棋盘。

完整的、不言自明的代码：

```
import java.util.Arrays;

public class BombMinDrops {

    private static final int[][] BOARD = {{2,3,4,7,1}, {1,5,2,6,2}, {4,3,4,2,1}, {2,1,2,4,1}, {3,1,3,4,1}, {2,1,4,3,2}, {6,9,1,6,4}};
    private static final int ROWS = BOARD.length;
    private static final int COLS = BOARD[0].length;
    private static int remaining = 0;
    private static int dropCount = 0;
    static {
        for (int i = 0; i < ROWS; i++) {
            for (int j = 0; j < COLS; j++) {
                remaining = remaining + BOARD[i][j];
            }
        }
    }

    private static class Point {
        int x, y;
        int kills;

        Point(int x, int y, int kills) {
            this.x = x;
            this.y = y;
            this.kills = kills;
        }

        @Override
        public String toString() {
            return dropCount + "th drop at [" + x + ", " + y + "] , killed " + kills;
        }
    }

    private static int countPossibleKills(int x, int y) {
        int count = 0;
        for (int row = x - 1; row <= x + 1; row++) {
            for (int col = y - 1; col <= y + 1; col++) {
                try {
                    if (BOARD[row][col] > 0) count++;
                } catch (ArrayIndexOutOfBoundsException ex) {/*ignore*/}
            }
        }

        return count;
    }

    private static void drop(Point here) {
        for (int row = here.x - 1; row <= here.x + 1; row++) {
            for (int col = here.y - 1; col <= here.y + 1; col++) {
                try {
                    if (BOARD[row][col] > 0) BOARD[row][col]--;
                } catch (ArrayIndexOutOfBoundsException ex) {/*ignore*/}
            }
        }

        dropCount++;
        remaining = remaining - here.kills;
        print(here);
    }

    public static void solve() {
        while (remaining > 0) {
            Point dropWithMaxKills = new Point(-1, -1, -1);
            for (int i = 0; i < ROWS; i++) {
                for (int j = 0; j < COLS; j++) {
                    int possibleKills = countPossibleKills(i, j);
                    if (possibleKills > dropWithMaxKills.kills) {
                        dropWithMaxKills = new Point(i, j, possibleKills);
                    }
                }
            }

            drop(dropWithMaxKills);
        }

        System.out.println("Total dropped: " + dropCount);
    }

    private static void print(Point drop) {
        System.out.println(drop.toString());
        for (int[] row : BOARD) {
            System.out.println(Arrays.toString(row));
        }

        System.out.println();
    }

    public static void main(String[] args) {
        solve();
    }

} 
```***

# vim - 在vim中禁用单个文件的pylint

> ID：15300151
> 
> 赞同：2
> 
> 时间：2013-03-08T17:47:06.147
> 
> 标签：vim, pylint

我想为 vim 中的单个文件禁用 pylint 插件。我不想永久禁用文件的 pylint，这就是[添加评论阻止 pylint](https://stackoverflow.com/questions/10238473/pylint-disable-all-warnings-for-a-file)会做的事情。

问题是每次我用 保存时`:w`，在我能够再次编辑文件之前会有大约 5 秒的延迟。据我所知，pylint 导致了这种滞后。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-25T22:56:54.000

我使用 vim 插件[python-mode](https://github.com/klen/python-mode)

阅读`:help pymode`，在第 4 节下。命令：

```
:PyLintToggle                                                   
    Enable, disable pylint

:PyLint                                                        
    Check current buffer 
```

在您的`.vimrc`文件中，您可以添加：

```
let g:pymode_lint_write = 0       "turn off running pylint on file save
let mapleader = ","
nnoremap <leader>p :PyLint<cr>    "pressing ,p will run plyint on current buffer 
```

之后，在正常模式下按下`,p`将在当前缓冲区上运行 pylint，`.py`除非运行，否则自动保存任何文件都不会触发 pylint 检查`:PyLintToggle`。

# php - PHP - 在选择带有 Mysql 值的下拉列表后直接显示来自 MySQL 的消息

> ID：15300153
> 
> 赞同：0
> 
> 时间：2013-03-08T17:47:08.170
> 
> 标签：php, html

哎呀对不起，我忘记改了。在此代码中，它将显示 cakename 列表。

```
<?php
$sql="SELECT * FROM $tbl_name ORDER BY c_id ASC";
$result=mysql_query($sql);

while($rows=mysql_fetch_array($result)){
$c_id=$rows['c_id']; // idnumber of cake
$cakename=$rows['cakename']; //this is the name of cake
$options.="<OPTION VALUE=\"$c_id\">$cakename</OPTION>"; //it will list all the cake
// close while loop 
}
?>

<select name="order_id">
<option value=0>Select Cake:<?php echo $options; ?>
</select> 
```

而这个，当用户选择了 cake1.it 将显示细节，价格和图片。这是我的问题。我想结合所有的代码。我不知道如何显示图片。

```
<html>
<form action="current_file.php" method="POST">
<select name="order_id" id="order_id" onChange="this.form.submit()">
<option value="">Select Cake:</options>
<option value="1">cake1</options>
<option value="2">cake2</options>
<option value="3">cake3</options>
</select>
</form>

<?php

$order_id=$_POST['order_id']; 

if (!empty($order_id)){

   $sql="SELECT * FROM $tbl_name WHERE c_id = $order_id";
    $result=mysql_query($sql);
    while($rows=mysql_fetch_array($result)){
        $price=$rows['price'];
        $details=$rows['details'];
        $picture=$rows['picture'];
       // close while loop 
     }
     echo $details;
echo $price;
}//close if statement

?> 
```

是的，所有的代码都在工作。但我只想成为一个。明白了吗？像这样但不工作：

```
<?php
  $order_id=$_POST['order_id']; 

    if (!empty($order_id)){
    $sql="SELECT * FROM $tbl_name WHERE c_id = $order_id";
    $result=mysql_query($sql);

    while($rows=mysql_fetch_array($result)){

    $price=$rows['price'];
    $details=$rows['details'];
    $picture=$rows['picture'];
    $c_id=$rows['c_id']; // idnumber of cake
    $cakename=$rows['cakename']; //this is the name of cake
    $options.="<OPTION VALUE=\"$c_id\">$cakename</OPTION>"; //it will list all the cake
    // close while loop 
    }
    ?>

    <form action="current_file.php" method="POST">
    <select name="order_id" id="order_id" onChange="this.form.submit()">
    <option value=0>Select Cake:<?php echo $options; ?>
    </select>
<?php
    echo $details;
    echo $price;
    echo $picture; 
?>
</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T17:54:31.110

```
while($rows=mysql_fetch_array($result)){
    $c_id=$rows['c_id'];
    $options.="<OPTION VALUE=\"$c_id\">$cakename</OPTION>";
    // close while loop 
}
?>

<select name="order_id">
    <option value=0>Select Cake:<?php echo $options; ?>
</select> 
```

您在此语句中有 html 错误，因为您的 html 将是这样的

```
<option value=0>Select Cake:<option value='1'>what ever</option> 
```

所以你必须关闭第一个选择选项，所以它应该是：

```
while($rows=mysql_fetch_array($result)){
    $c_id=$rows['c_id'];
    $options.="<OPTION VALUE=\"$c_id\">$cakename</OPTION>";
    // close while loop 
}
?>

<select name="order_id">
    <option value=0>Select Cake:</option>
    <?php echo $options; ?>
</select> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T17:57:56.990

试试这个：

现在只有一个 PHP 文件会检查帖子消息。如果`$_POST['pet_id']`存在，它将显示项目详细信息，否则它将向用户显示一个选择框。

```
<?php
    if (!empty($_POST['order_id'])) {
        $order_id = $_POST['order_id'];
        $sql = "SELECT details FROM $tbl_name WHERE c_id = $order_id";
        $result = mysql_query($sql);
        while ($rows = mysql_fetch_array($result)) {

            // $c_id=$rows['c_id'];
            $details = $rows['details'];
            $price = $rows['price'];
            $picname=$rows['picname']; // this is the name of the picture
            $picture = '<img src="/images/' . $picname . '.jpg" />'; //i change the $pet_id to $picname the pet_id are not inluded 
        } // close while loop 
        echo $details;
        echo $price; // What's the price? You haven't selected price from db...
        echo $picture;
    } else {
        $sql = "SELECT * FROM $tbl_name ORDER BY c_id ASC";
        $result = mysql_query($sql);
        $options = ''; // First Create an empty variable then fill it in a loop
        while ($rows = mysql_fetch_array($result)) {
            $c_id = $rows['c_id'];
            $cakename = $rows['c_cakename'];
            $options .= "<option value=\"$c_id\">$cakename</option>\n";
        }
?>
    <!-- Create a form to send data -->
    <form action="yourtarget.php" method="post">
        <select name="order_id" onChange="this.form.submit()">
            <!-- You are putting all of your options inside the first option tag. Make sure you close the first one and then echo rest of options. -->
            <option value=0>Select Cake:</option>
            <?php echo $options; ?>
        </select>
    </form>
<?php } ?> 
```

我对图像的想法是通过它们的 item-id 将它们存储在一个文件夹中，您可以将图像名称或路径存储在 db 中。有太多方法可以做到这一点。

# parameters - 如何在方法中完全指定返回参数的类型？

> ID：15300157
> 
> 赞同：4
> 
> 时间：2013-03-08T17:47:18.623
> 
> 标签：parameters, abap

我有一个方法可以导入一个结构，从结构中创建一个内部表，然后返回这个表。

我已将其实现为导出方法，但现在我想将其作为返回参数。部分想法是我对直到运行时传递的结构一无所知，所以我使用了大量的泛型。但是，“返回”方法不喜欢泛型。

```
method Parameters:
  Importing struct_data TYPE any 
  Returning table_data TYPE STANDARD TABLE 

method STRUCT_TO_TABLE_R.

  FIELD-SYMBOLS:
    <f_fs>    TYPE any,
    <table>   TYPE STANDARD TABLE .

  DO.

    ASSIGN COMPONENT sy-index OF STRUCTURE struct_data TO <f_fs>.

    IF NOT sy-subrc EQ 0.
      EXIT.
    ENDIF.

    APPEND <f_fs> TO <table>.

  ENDDO.

  table_data = <table>.

endmethod. 
```

我需要改变什么来解决这个问题？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2014-06-20T13:29:28.290

也许现在做出正确的回应已经晚了，但我在几分钟前遇到了同样的问题。

为了将内部表作为 RETURNING 参数发送，您需要定义一个在类中完全键入的表。这是一个类的公共部分的示例代码：

```
PUBLIC SECTION.
    TYPES:
      type_table_A TYPE STANDARD TABLE OF T001, //<----- NOT FULLY SPECIFIED
      type_table_B TYPE STANDARD TABLE OF T001 WITH DEFAULT KEY. //<---- FULLY SPECIFIED 
```

在标准表方面：

TYPE_TABLE_A 只能作为 EXPORTING、IMPORTING 和 CHANGING 参数的参数。

TYPE_TABLE_B 可用于方法签名中所有可能的参数类型，主要是 RETURNING。

因此，作为一种好的做法，您可以决定声明完全指定的标准表类型。

亲切的问候，

塞萨尔·谢克

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-13T21:03:19.647

返回参数由 Value 传递。换句话说，当方法被执行时，你总是可以访问返回的参数，但你的调用者可以完全省略从方法中接收值，但方法仍然必须使用参数。这就是您需要指定完全 TYPED 类型以返回的原因。

作为替代方案，您可以将表转换为对象引用并将其传递回调用者。

```
class lcl_Test DEFINITION.
  PUBLIC SECTION.
   methods: to_Table
            returning value(ro_tab) type ref to data .
ENDCLASS.  
*
class lcl_Test IMPLEMENTATION.
  method to_Table.
  ENDMETHOD.
ENDCLASS. 
```

问候，

# css - 浏览器如何处理高度和宽度的非整数值？

> ID：15300163
> 
> 赞同：38
> 
> 时间：2013-03-08T17:47:35.023
> 
> 标签：css, browser

当浏览器为非整数值的元素提供宽度和高度时，它们如何处理它们？

尤其，

*   非整数值在什么阶段四舍五入？它们是四舍五入到最接近的整数，还是截断它们？
*   当容器的子元素具有非整数尺寸时，是否会出现子元素长度或高度的总和不等于父元素的内部宽度/高度的情况？
*   提供的非整数维度的处理方式是否与基于百分比的维度的非整数结果不同？
*   填充和边距的非整数值呢？
*   **编辑：** *是*执行此舍入的浏览器，还是操作系统？如果是操作系统，这是否会造成浏览器“认为”项目大于其绘制区域的条件，这是否会导致父容器的大小出现问题？

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2013-03-08T17:54:45.977

# 断言

浏览器旨在处理浮点数和小于一个像素的值。

* * *

要查看显示浏览器在其计算中使用浮点数的[简单示例，请创建一个 3% 宽度的项目，并在调整大小时在 Chrome 开发人员工具中查看其计算属性。](http://jsfiddle.net/2hhdm/)

您应该看到如下内容：

![在此处输入图像描述](../Images/74d7c56bfcfef4a2dc0f3c32d61f04e6.png)

“35.296875”无法通过将一个像素映射到物理显示器（CRT，传统 LCD）中的一个像素的显示器精确呈现。然而，较新的高密度显示器使用与 1-1 不同的比率，并且这个小数值在概念上可用于提供更高程度的精度。

即使在低密度显示器上，小数值也可以为[子像素渲染](http://en.wikipedia.org/wiki/Subpixel_rendering)提供提示，它使用像素的红色、绿色和蓝色分量来使对象的边缘看起来比使用整个像素值更平滑。

**但浏览器究竟*会*如何处理这些数字并不是很容易预测。**您（目前）不能要求浏览器制作一个 31.5 像素宽的框并期望得到一致甚至有意义的结果。一些浏览器会截断小数值；其他人向上/向下舍入。

子像素渲染通常用于文本，并且在大多数/所有浏览器中都能很好地工作，但每个浏览器的实现方式不同，开发人员几乎无法影响其工作方式。

## 什么时候

> 非整数值在继承链中的哪个阶段四舍五入？

大多数/所有计算都是作为浮点数执行的，任何舍入都可能发生在过程的后期，甚至超出浏览器的控制范围。例如，浏览器可以将其抗锯齿委托给操作系统组件（例如[IE9 委托给 Windows Direct2D 和 DirectWrite](http://blogs.msdn.com/b/ie/archive/2010/11/03/sub-pixel-fonts-in-ie9.aspx)）。

CSS 过渡可以与操作系统和/或硬件加速紧密集成。这是另一种情况，我认为浮点值很可能被浏览器保留并传递给底层。

## 舍入行为/错误

> 当容器的子元素具有非整数尺寸时，是否会出现子元素长度或高度的总和不等于父元素的内部宽度/高度的情况？

作为百分比计算的结果，我在旧浏览器（IE7）中看到了这一点，其中`50% + 50% > 100%`. 通常在你尝试做一些更复杂的事情之前这不是问题。有趣的是，在尝试将 HTML 元素作为动画的一部分进行精确对齐时，我已经看到了“偏移一个像素”的错误。

## 百分比与其他单位

> 提供的非整数维度的处理方式是否与基于百分比的维度的非整数结果不同？
> 
> 它们是四舍五入到最接近的整数，还是截断它们？

它因人而异。[这个较旧的答案](https://stackoverflow.com/questions/4308989/are-the-decimal-places-in-a-css-width-respected)指出它们被截断，但是（在 Chrome 24 中）我看到了舍入（注意示例小提琴）。请注意我之前关于同一台机器上 Chrome 和 Safari 之间差异的评论。

> 填充和边距的非整数值呢？

相同的规则（或缺乏规则）似乎适用。

## 标准

我还没有找到在所有情况下如何处理浮点值的标准定义。我能找到的[最接近的相关规范](http://www.whatwg.org/specs/web-apps/current-work/#pixel-manipulation)`canvas`是关于像素的：

> 本规范未定义当指定坐标未精确映射到设备坐标空间时的像素舍入处理，除非以下内容必须导致渲染没有可见的变化：[...条件列表...]

同样，这是来自专门处理 的部分`canvas`，但它确实暗示：

*   浏览器绝对与小数像素交互。
*   实际实现会有所不同。
*   确实存在一些标准化。
*   映射到设备的显示屏可能会影响计算。

# matplotlib - 更改 matplotlib 极坐标轮廓中的 figsize

> ID：15300170
> 
> 赞同：0
> 
> 时间：2013-03-08T17:47:56.010
> 
> 标签：matplotlib

我正在使用以下示例[示例](https://stackoverflow.com/questions/9071084/polar-contour-plot-in-matplotlib-best-modern-way-to-do-it)创建两个极坐标子图。当我创建为 pdf 时，我想通过更改 figsize 来删除很多空白。

我通常知道如何更改 figsize，但我很难看到在此代码示例中放置它的位置。任何指导或提示将不胜感激。

非常感谢！

```
import numpy as np
import matplotlib.pyplot as plt

#-- Generate Data -----------------------------------------
# Using linspace so that the endpoint of 360 is included...
azimuths = np.radians(np.linspace(0, 360, 20))
zeniths = np.arange(0, 70, 10)

r, theta = np.meshgrid(zeniths, azimuths)
values = np.random.random((azimuths.size, zeniths.size))

#-- Plot... ------------------------------------------------
fig, ax = plt.subplots(subplot_kw=dict(projection='polar'))
ax.contourf(theta, r, values)

plt.show() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T19:05:03.167

您可以轻松地将其放在`plt.figsize(x,y)`代码的开头，它会起作用。plt.figsize 改变所有未来图的大小，而不仅仅是当前图。

但是，我认为你的问题不是你想的那样。除非您更改选项，否则生成的 PDF 中往往会有相当多的空白。我通常使用

```
plt.savefig( 'name.pdf', bbox_inches='tight', pad_inches=0 ) 
```

这会提供尽可能少的空白。bbox_inches='tight' 试图使边界框尽可能小，而 pad_inches 设置应该填充多少英寸的空白。就我而言，我根本没有额外的填充，因为我在使用该图的任何内容中添加了填充。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T19:30:28.863

另一种方法是`figsize`在调用`plt.subplots`.

`fig, ax = plt.subplots(figsize=(6,6), subplot_kw=dict(projection='polar'))`.

顺便说一下，这些值以英寸为单位。

# python - 将 Python 列表与 SQLAlchemy 集合进行比较

> ID：15300174
> 
> 赞同：1
> 
> 时间：2013-03-08T17:48:26.317
> 
> 标签：python, list, comparison, sqlalchemy, flask-sqlalchemy

**如何将 Python 列表与 SQLAlchemy 集合进行比较？**

我收到以下错误消息

```
InvalidRequestError: Can't compare a collection to an object or collection; use contains() to test for membership 
```

从这条线

```
gr = AGroup.query.filter_by(users=sorted(members)).first() 
```

成员是 AUser 对象的列表。

我想检查是否存在与成员列表具有相同用户的任何组。

但是，由于 users 是一个 sqlalchemy 集合，因此这是行不通的。

谢谢你。:)

基本类结构

```
AGroup
- users

AUser
- name 
```

* * *

## 回答 #1

> 赞同：-3
> 
> 时间：2013-03-09T16:45:13.950

我用下面的代码解决了这个问题。

```
 groups = AGroup.query.all()
    for g in groups:
        if sorted(list(g.users)) == members:
            doSomething() 
```

# android - 如何使用 GSON 将 JSON 字符串转换为对象集合？

> ID：15300179
> 
> 赞同：4
> 
> 时间：2013-03-08T17:48:54.520
> 
> 标签：android, json, gson

我有以下课程：

```
public class UserObject implements Serializable
{
    public Integer id;
    public String name;
    public String phoneno;

    public UserObject()
    {
        this.id = new Integer(0);
        this.name = "";
        this.phoneno = "";
   }
} 
```

我有一个`json`如下字符串：

```
[
    {
        "id": 1,
        "name": "First Name",
        "phoneno": "0123452",
    },
    {
        "id": 2,
        "name": "Second Name",
        "phoneno": "0123452",
    },
    {
        "id": 3,
        "name": "Third Name",
        "phoneno": "0123455",
   }
] 
```

我可以使用以下代码轻松地从`Collection`of`UserObject`转换为：`JSON`

```
Collection users = new Vector();
UserObject userObj = new UserObject();

userObj.id=1; userObj.name="First Name"; userObj.phoneno="0123451";
users.add(userObj);
userObj.id=2; userObj.name="Second Name"; userObj.phoneno="0123452";
users.add(userObj);
userObj.id=3; userObj.name="Second Name"; userObj.phoneno="0123455";
users.add(userObj);

Gson gson = new Gson();
String json = gson.toJson(users); 
```

但我不知道如何转换`JSON` `string`为`collection`of `objects`？我发现我可以使用`gson.fromJson()`但不知道如何使用 for `Collection`。请帮忙。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-08T18:03:40.610

`Collection`以下代码允许您获取`UserObject`

```
Type token = new TypeToken<Collection<UserObject>>() {}.getType();
Collection<UserObject> result = gson.fromJson(json, token); 
```

另外，请注意`json`问题中提供的内容无效，因为`phoneno`字段后有一个额外的逗号。这是正确的：

```
[
    {
        "id": 1,
        "name": "First Name",
        "phoneno": "0123452"
    },
    {
        "id": 2,
        "name": "Second Name",
        "phoneno": "0123452"
    },
    {
        "id": 3,
        "name": "Third Name",
        "phoneno": "0123455"
    }
] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-08T17:52:38.287

鉴于此 JSON，您的包装类应如下所示：

```
public class Data {
    private List<User> users;
    // +getters/setters
}

public class User {
    private String name;
    private String email;
    private List<User> friends;
    // +getters/setters
} 
```

然后转换它，使用

```
Data data = gson.fromJson(this.json, Data.class); 
```

并获得用户，使用

```
List<User> users = data.getUsers(); 
```

# javascript - 将点击事件动态添加到复选框，仅适用于第一个复选框 JQUERY

> ID：15300183
> 
> 赞同：0
> 
> 时间：2013-03-08T17:49:11.383
> 
> 标签：javascript, jquery, asp.net

所以我正在使用几个 ascx，每个控件上都有不同的复选框区域。我最初使用

```
 $('[type=checkbox]').click ( function(){ code }); 
```

它完成了工作，起初。但是当我添加另一个控件时，也使用复选框，该函数也为其他复选框触发，所以我将 js 升级到

```
 $('#chck').click(function(){ code }); 
```

但是有了这个，它只会为该列表中的第一个复选框触发一个事件。我怎样才能让它为所有点击触发？

我也试过这个：

```
 $('#chck').each(function(){ $(this).click({ function() { code }); }); 
```

这也只适用于第一个

这是我的 ascx 页面示例：

```
 <asp:Repeater ID="contacts" runat="server">
            <ItemTemplate>
                <tr>
                    <td>
                        <input type="checkbox" id="chck" />
                    </td>
                  .....
                 </tr>
             </ItemTemplate>
  </asp:Repeater> 
```

这是我的 JS 代码段

```
 $(document).ready(function(){
       $("#chck").each(function () {
           $(this).click(function () { onchange($(this)); });
       });
    });
    function onchange(checkbox) {
    // adds contact to list
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T17:51:23.110

`id`s 必须是唯一的。改用一个类：

```
<input type="checkbox" class="chck" /> 
```

```
$('.chck').click(function(){ code }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T18:00:44.703

见上`using same ids for multiple elems`_`same page is invalid.`

`IDs should be unique to each element. When this happens browser only selects first of it.`

要克服这个问题，必须更改`id`为`class`. 所以你`have to do same thing with your markup change id to class`：

```
<input type="checkbox" class="chck" /> // <----change id to class for every input 
```

现在你的脚本应该是：

```
$('.chck').each(function(){ //<-----use '.' notation for class selectors 
     $(this).click(function() { 
         onchange($(this));
     }); 
}); 
```

# jpa - EclipseLink 注解无法解析

> ID：15300187
> 
> 赞同：1
> 
> 时间：2013-03-08T17:49:18.237
> 
> 标签：jpa, annotations, eclipselink

我正在尝试创建一个简单的 EclipseLink POC。不幸的是，它似乎没有在 JAR 中包含重要的基本类。

例如，以下在 eclipse 中失败（并且 eclipselink 肯定在构建路径上）`import javax.persistence.Id`：我也应该有一个基本的 JPA 功能 jar 吗？注释是否存储在 eclipselink 中的其他位置（我看过，找不到任何东西）？我错过了什么？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T18:02:03.737

缺少 API 部分。jar 的名称是 javax.persistence_1.0.0.jar。在 EclipseLink 2.4.1 ( [http://www.eclipse.org/eclipselink/downloads/index.php#2.4](http://www.eclipse.org/eclipselink/downloads/index.php#2.4) Installer zip) 下载它位于 eclipselink/jlib/jpa/javax.persistence_1.0.0.jar。

# sql - 我可以在 SQL Server 中消除这个子查询吗？

> ID：15300194
> 
> 赞同：1
> 
> 时间：2013-03-08T17:49:46.193
> 
> 标签：sql, sql-server, join, greatest-n-per-group

我有一个视图，我试图合并两组以不同方式存储的时间序列数据。集合**D具有与***每个时间点*一起存储的单个值。集合**R**的值仅以*生效日期存储，*并且在被取代之前一直有效。这是一个示例表结构：

```
Table D
---------+------------------+--------
D_series | D_time           | D_value
---------+------------------+--------
1        | 2012-01-01 00:00 | 4.52
1        | 2012-01-01 01:00 | 2.41
1        | 2012-01-01 02:00 | 5.98
1        | 2012-01-01 03:00 | 3.51
2        | 2012-01-01 00:00 | 4.54
2        | 2012-01-01 01:00 | 6.41
2        | 2012-01-01 02:00 | 5.28
2        | 2012-01-01 03:00 | 3.11
3        | 2012-01-01 00:00 | 4.22
3        | 2012-01-01 01:00 | 9.41
3        | 2012-01-01 02:00 | 3.98
3        | 2012-01-01 03:00 | 3.53

Table L
---------+---------
D_series | R_series
---------+---------
1        | 1
2        | 1
3        | 2

Table RV
---------+----------+--------
R_series | R_header | R_value
---------+----------+--------
1        | 1        | 5.23
1        | 2        | 2.98
2        | 1        | 1.35

Table RH
---------+-----------------
R_header | R_start
---------+-----------------
1        | 2012-01-01 00:00
2        | 2012-01-01 01:49
3        | 2012-01-01 02:10 
```

我希望视图将所有点`D_time`连同它们的对应点`D_value`和`R_value`当前点一起返回：

```
---------+------------------+---------+--------
D_series | D_time           | D_value | R_value
---------+------------------+---------+--------
1        | 2012-01-01 00:00 | 4.52    | 5.23
1        | 2012-01-01 01:00 | 2.41    | 5.23
1        | 2012-01-01 02:00 | 5.98    | 2.98
1        | 2012-01-01 03:00 | 3.51    | 2.98
2        | 2012-01-01 00:00 | 4.54    | 5.23
2        | 2012-01-01 01:00 | 6.41    | 5.23
2        | 2012-01-01 02:00 | 5.28    | 2.98
2        | 2012-01-01 03:00 | 3.11    | 2.98
3        | 2012-01-01 00:00 | 4.22    | 1.35
3        | 2012-01-01 01:00 | 9.41    | 1.35
3        | 2012-01-01 02:00 | 3.98    | 1.35
3        | 2012-01-01 03:00 | 3.53    | 1.35 
```

我知道如果我创建一个子查询并加入它，我可以做到这一点：

```
select D.D_series, D_time, D_value, RV1.R_value
from D
join L on L.D_series = D.D_series
join RV RV1 on RV1.R_series = L.R_series
join RH RH1 on RH1.R_header = RV1.R_header and RH1.R_start <= D.D_time
left join (
    select R_series, R_value, R_start
    from RV RV2
    join RH RH2 on RH2.R_header = RV2.R_header
) RZ on RZ.R_series = RV1.R_series and RZ.R_start > RH1.R_start
where RZ.R_start is null or RZ.R_start > D_time 
```

但据我了解，这个子查询将首先获取*每条*记录`RV`，`RH`即使视图只涉及几个`R_series`. 有什么办法可以消除这个子查询并使其成为标准连接？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T18:23:27.897

您是否考虑过使用交叉应用？它们适用于“没有简单连接条件”的情况。

看到这个答案：[我什么时候应该使用交叉应用而不是内部连接？](https://stackoverflow.com/questions/1139160/when-should-i-use-cross-apply-over-inner-join)

在你的情况下，我认为这些方面的东西可能会起作用：

```
select D.D_series, D_time, D_value, current_r_values.R_value
from D
join L on L.D_series = D.D_series
cross apply (
   select top 1 R_series, R_value, R_start
   from RV RV2
   join RH RH2 on RH2.R_header = RV2.R_header
   where RH2.R_Start<D.D_time
   and RV2.R_series = L.R_series
   order by R.R_Start DESC) current_r_values 
```

我知道这不是您要找的东西，但我经常发现使用交叉应用比加入不等式要快得多。

# jquery - 为静态内容和通过 ajax 加载的内容调用一次 jQuery 插件

> ID：15300200
> 
> 赞同：0
> 
> 时间：2013-03-08T17:50:15.680
> 
> 标签：jquery, ajax, flexslider

我正在使用两个 jQuery 插件：easytabs 和 prettyPhoto。我想对（1）静态页面和（2）通过easytabs插件通过ajax加载的图像使用prettyPhoto插件。

这就是我现在正在做的事情（请注意，这工作得很好，但我想知道是否有更有效的方法来做到这一点）：

```
$(document).ready(function(){
    $("a[rel^='prettyPhoto']").prettyPhoto(); // Calling prettyPhoto for the first time (for images on the static page)

    $('#portfolio-tabs').easytabs();
    $('#portfolio-tabs').bind('easytabs:ajax:complete', function() {
        $("a[rel^='prettyPhoto']").prettyPhoto(); // Calling this again for it to work on images loaded via ajax
    )
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T18:19:42.347

我相信加载的`easytabs`内容是用 in 呈现的，`portfolio-tabs`然后将 ajax 回调更改为

```
var tabs = $('#portfolio-tabs').bind('easytabs:ajax:complete', function() {
    $("a[rel^='prettyPhoto']", tabs).prettyPhoto(); // Calling this again for it to work on images loaded via ajax
) 
```

# iphone - 从 NSString 获取数据时应用程序崩溃

> ID：15300202
> 
> 赞同：0
> 
> 时间：2013-03-08T17:50:22.500
> 
> 标签：iphone, ios, objective-c, xcode

我有一个应用程序，我正在转换`UIImage`为`NSData`进一步`NSData`使用`Base64String`此[https://github.com/nicklockwood/Base64](https://github.com/nicklockwood/Base64)类....但是当我想将转换后的字符串获取到另一个类时，应用程序崩溃。它给出了`EXC_BAD_ACCESS error`......是否有可能`NSString`无法处理这么大的字符串或者还有其他问题吗？

这是我的代码....

```
image = [UIImage imageNamed:@"earring_hoops_small.jpg"];
    NSData *data = UIImageJPEGRepresentation(image, 0.1f);
    NSData *data2 = data;
    NSLog(@"BaseString=%@",data2);
    [Base64 initialize];
    strEncoded = [Base64 encode:data];
    NSLog(@"BaseString=%@",strEncoded); 
```

并且它给出了例外......

```
myString = strEncoded; 
```

# javascript - 注意到 JavaScript 对象属性变化的优雅方式

> ID：15300203
> 
> 赞同：1
> 
> 时间：2013-03-08T17:50:27.220
> 
> 标签：javascript, design-patterns

我正在开发一个带有服务器端组件的 JavaScript 应用程序。目的是在画布上拥有多个不同的对象，这些对象在多个浏览器之间是同步的（即具有相同的外观）。同步由服务器端组件完成，该组件将各个更改广播到所有浏览器。每当一个对象发生变化时，它必须通知服务器，然后由哪个服务器负责通知其他浏览器。

画布上的对象由 JavaScript 对象表示，其属性决定了用户的外观。当然，并不是所有的属性对外观都很重要。因此，只需将重要属性的更改传输到其他浏览器。对象有不同的“类”，但所有对象都从一个共同的“超类”“继承”（我知道，类继承术语在 JavaScript 中并不真正适用，但在这种情况下，我认为这样更容易） .

现在，我在以优雅的方式发送客户端-服务器通知时遇到了一些麻烦。目前，我对不同对象的所有重要属性都有设置方法。这些 setter 方法调用一个将通知发送到服务器的函数。

我不太喜欢那个解决方案，因为它引入了很多样板代码。理想情况下，当我创建一个新对象时，我希望能够只指定重要的属性并对其进行处理。负责监视这些属性变化的逻辑可能在“超类”中。但我不知道如何实现这一点。也许有一种方法可以在运行时动态构建设置器？或者也许还有其他我没有想到的方法？

如果有人能想到这个问题的解决方案，我会很高兴听到这个消息。

提前致谢！

**编辑：**

我不得不撤销已接受的答案（通过 动态创建 getter 和 setter `Object.defineProperty`），因为虽然我认为它可以解决我的问题，但实际上并没有。现在，当通过触发 setter 的直接属性分配更改属性时，我会收到通知，例如：

```
SynchronizedObject.importantProp = 'someValue'; 
```

但正如我注意到的，在许多情况下，这`importantProp`是一些更复杂的对象。这些对象通常是通过*getter*而不是 setter 更新的。

```
SynchronizedObject.importantProp.x = 'someValue'; 
```

据我所知，我没有机会注意到动态 getter/setter 实现以这种方式完成的更改。要使用它，我必须改变访问对象的方式。有效的东西：

```
prop = SynchronizedObject.importantProp;
prop.x = 'someValue';
SynchronizedObject.importantProp = prop; 
```

这样，使用了 setter 并且一切正常。但这感觉真的很尴尬，我不想每次都考虑同步，我设置了一个属性。所以在我看来，该解决方案并不是真正可用的。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T17:53:42.643

一个`set`功能怎么样？

```
MyObj.prototype.set = function(key, value) {
    this[key] = value;
    // do other things
}; 
```

您可以将其与`EventEmitter` [实现](https://github.com/Wolfy87/EventEmitter)结合起来，以便于观察更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T23:04:54.743

这正是`__defineSetter()__`旨在支持的内容。查看 John Ressig 的[JavaScript Getters and Setters](http://ejohn.org/blog/javascript-getters-and-setters/)博客文章，了解一些很好的示例。从 setter 内部触发事件非常简单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T17:56:09.910

如果轮子改造不是您真正的包包，您可能需要考虑[MeteorJS 框架。](http://meteor.com/)

# php - 如何在表中显示此连接查询

> ID：15300210
> 
> 赞同：-2
> 
> 时间：2013-03-08T17:50:51.067
> 
> 标签：php, mysql

我有这个说法

```
$query = mysql_query("SELECT product_name, date_bought, total_price
FROM `order` o
JOIN `order_items` oi
ON o.order_id = oi.order_id
WHERE o.student_id = $id
ORDER BY o.order_id DESC"); 
```

你如何用php显示表格中的所有行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T17:54:36.587

```
while ($row = mysql_fetch_assoc($query)) {
    echo $row['product_name'];
    echo $row['date_bought'];
    echo $row['total_price'];
} 
```

这是一般的想法......你必须处理你想要的格式......另外，请注意`mysql_query()`不*推荐*。请参阅[PHP Docs](http://www.php.net/manual/en/function.mysql-query.php)以了解改用什么。

# python - Pydev+Kivy - Empty __init__ files

> ID：15300215
> 
> 赞同：0
> 
> 时间：2013-03-08T17:51:16.933
> 
> 标签：python, initialization, pydev, kivy

I am using Eclipse and PyDev to develop for the Python library called Kivy.

I ran through the proper setup instructions, and developing and running from Eclipse works perfect.

However, when I, or more namley, my project-mates, try to run the file that contains the main method OUTSIDE of eclipse (via kivy cmd prompt), it comes up with the following error:

```
 File "C:\MyProject\code\main.py", line 8, in <module>
     from code import engine
 ImportError: cannot import name engine 
```

The file code is basically:

```
from kivy.app import App
from kivy.clock import Clock
from kivy.uix.screenmanager import ScreenManager
from code import engine

class MyApp(App):
    def build(self):
        pass

if __name__ == '__main__':
    MyApp.run() 
```

I took a look in my project files. I have a bunch of **init**.py files

```
code/
    __init__.py
    main.py
    engine.py
    system1/
        __init__.py
        my_system.py
etc... 
```

but all the **init**.py files are empty! Am I supposed to construct them manually? Eclipse must be doing it at some point, can I have PyDev do it automatically?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T19:57:09.193

The empty `__init__.py` files are needed by Python (up to version 3.2) ideintify a directory as a Python package - and its contents as modules/sub-packages.

If you did not create them, PyDev created them for you - and they need not contain anything.

If your mates can't import `code.engine` asstated, it ismore likely the directory containing `code` itself is not part of Python's path (PYTHONPATH environment variable) - so it can't find from where do descend into the code package.

# eclipse - Eclipse-连接到 svn 存储库

> ID：15300216
> 
> 赞同：1
> 
> 时间：2013-03-08T17:51:19.467
> 
> 标签：eclipse, svn

我下载了 Eclipse 的 SVN 插件，现在无法连接到我需要的存储库。我有我应该添加的 URL（它适用于我学校的计算机）。但是我不认为它正在做它应该做的事情。当我尝试在 Eclipse 上添加新存储库时，我附上了一张显示弹出窗口的图片。当我尝试添加它时，它正在应用程序中的 eclipse 文件夹中创建一个文件夹。这个窗口上的对话框看起来与学校里出现的不同。这个特定的窗口只会让我选择“文件系统”？我相信这只是在我自己的计算机上创建这个存储库？我需要做什么才能连接到远程存储库？

[http://s23.postimage.org/e4s7iso7f/screen_capture.png](http://s23.postimage.org/e4s7iso7f/screen_capture.png) <- 此处为图片

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-08T17:57:07.080

请按照以下步骤操作：

1.  窗口，打开透视
2.  选择“SVN存储库探索”
3.  到达那里后，如果未显示 SVN 存储库，请转到窗口，显示视图，然后选择“SVN 存储库”
4.  现在右键单击 SVN 存储库的空白区域以显示上下文菜单
5.  选择“存储库位置”
6.  输入您选择的 URL 和标签
7.  如有必要，输入用户名和密码，然后单击“保存身份验证”
8.  点击完成

我怀疑您选择的是“新存储库”而不是“存储库位置”。

# google-maps-api-3 - 适用于 iOS 的 Google Maps SDK：重新定位 Google 徽标

> ID：15300225
> 
> 赞同：1
> 
> 时间：2013-03-08T17:52:08.577
> 
> 标签：google-maps-api-3, google-maps-mobile, google-maps-sdk-ios

对于 iOS 的新 sdk，Google 徽标是否可重定位，就像 Mapkit pre-iOS 6 一样？另外，条件允许吗？

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2017-03-14T11:12:10.290

这实际上可以通过更改地图的可见部分在某种程度上实现，也就是`padding`：

```
let padding = UIEdgeInsets(top: 0, left: 0, bottom: 100, right: 0)
mapView.padding = padding 
```

如果您在地图顶部有一个类似视图的抽屉，并且您希望在更改相机时相应地移动中心（而不移动性能更差的整个 UIView），这将很有用。或者只是将徽标向右移动。

如果您查看文档 [map_padding][ [https://developers.google.com/maps/documentation/ios-sdk/map#map_padding]](https://developers.google.com/maps/documentation/ios-sdk/map#map_padding])

> 如果您在地图底部显示自定义 UI，请在地图底部添加填充，以便始终可见徽标和法律声明。

提醒一下，在更改 时`padding`，如果您移动相机，您可能需要在其中添加一个插图以取消您刚刚用于移动徽标的边距（以相互抵消）：

```
mapView.camera(for: bounds, insets: insets) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-09T08:25:00.640

在谷歌地图的条款中，有以下关于谷歌标志的句子：

> 8.4 (b) 限制。在使用 Google 品牌特征时，您不会：
> 
> ...
> 
> (iii) 在您的 Maps API 实施或您的网站上将 Google 徽标作为最大的徽标（地图图像本身显示的除外）；

还有更进一步的句子

> 9.4 归属。
> (a) 通过服务提供给您的内容可能包含 Google、其合作伙伴或 Google 索引内容的其他第三方权利持有人的商号、商标、服务标记、徽标、域名和其他独特的品牌特征。当 Google 提供此属性时，您必须按照通过服务提供的或 Maps API 文档中的说明显示它，并且不得删除或以任何方式更改这些商号、商标、服务标记、徽标、域名和其他独特品牌特征。

因此，当我阅读本文时，您不得修改 Google 徽标本身的位置或任何属性。但我没有发现任何不允许在 Google 徽标上方放置图层或其他内容的限制。

但请注意，我不是律师，出于我的目的，我看不出有任何修改 Google 徽标的理由。

最好的问候罗伯特

# magento-1.7 - 如何在magento中显示售罄百分比

> ID：15300226
> 
> 赞同：0
> 
> 时间：2013-03-08T17:52:12.853
> 
> 标签：magento-1.7

我想在 magento 中显示产品的售罄百分比。

例如，我有一个品牌的 10 块手表，其中两块已售罄，

在我的产品中，我想售罄百分比，例如 20%，而条形图则表示售罄百分比。

请帮帮我。

问候 MD.Samiuddin

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T21:27:53.283

嗨，你的意思是这样的吗？

**PHP：**

```
<?php
    $initialAmount = 10;
    $itemsLeft  = Mage::getModel('cataloginventory/stock_item')
                  ->loadByProduct($_product)->getQty();
    $sold = $initialAmount - $itemsLeft;
    $perc = $sold/$initialAmount*100;
?> 
```

**CSS**

```
<style>
    .bar {
        height: 20px; 
        width:100%; 
        border: 1px solid #000000; 
        background-color: green;
    }

    .fill {
        height: 20px; 
        width: <?php echo $perc; ?>%; 
        background-color: #FF0000; 
        font-size: 12px; 
        text-align: right; 
        line-height: 20px; 
        vertical-align: middle;   
    }
</style> 
```

**HTML**

```
<div class='bar'>
    <div class="fill"> <?php echo $perc; ?>%</div>
</div> 
```

**检查** [示例](http://codepad.viper-7.com/T2MEiQ)

# ubuntu - 在 64 位平台上构建 32 位 OpenCV

> ID：15300231
> 
> 赞同：1
> 
> 时间：2013-03-08T17:52:44.347
> 
> 标签：ubuntu, opencv, compilation, 32bit-64bit, elf

我正在尝试在我的 Ubuntu 64 位系统上运行预编译程序：

```
$  ./segmentObjs 
./segmentObjs: error while loading shared libraries: 
  libopencv_core.so.2.3: wrong ELF class: ELFCLASS64 
```

我怀疑这意味着程序正在寻找 32 位版本的`libopencv_core`库，但只能找到 64 位版本。

是否可以在我当前版本的同时安装 32 位版本的 OpenCV，并让这个二进制文件使用那个而不是当前安装？OpenCV 的下载部分似乎只提供了一种选择，当我尝试构建 OpenCV 的 2.3 版时，我找不到在“cmake-gui”中构建 32 位版本的任何选项。

我正在尝试做的事情是不可能的，还是我只是尝试做错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T18:48:01.243

它可以完成，但您必须安装 ia32-libs 以及 32 位 opencv 的所有依赖项。

# java - java匹配变量的正则表达式

> ID：15300232
> 
> 赞同：0
> 
> 时间：2013-03-08T17:52:45.957
> 
> 标签：java

我想匹配任何具有模式的字符串

```
{"id":"362237- 
any number of characters followed by
"http//:www.abc.com" 
any number of characters followed by
"id":"364121-
any number of characters followed by
"http://www.efg.com" 
```

我想将上面的模式匹配到下面的字符串。

```
[{"id":"362237-13","http//:www.abc.com"},{"id":"364075-13","http://www.xyz.com"},{"id":"364121-13","http://www.efg.com"}] 
```

代码：

```
String pttrn=".*{\"id\":"362237-.*\"http//:www.abc.com\".*\"id\":"364121-.*\"http://www.efg.com\".*";

String mtchr="[{\"id\":\"362237-13\",\"http//:www.abc.com\"},{\"id":\"364075-13\",\"http://www.xyz.com\"},{\"id\":\"364121-13\",\"http://www.efg.com\"}]";

        boolean b = Pattern.matches(pttrn, mtchr);
        System.out.println("b is !!" + b); 
```

我期待 b 为真，但它返回假。我弄错了正则表达式。

请让我知道如何解决它。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-25T06:14:53.073

您需要使用反斜杠将大括号转义到正则表达式引擎。...并且您需要使用另一个反斜杠将反斜杠转义为 Java。

```
String pttrn=".*\\{\"id\":\"362237-.*\"http//:www.abc.com\".*\"id\":\"364121-.*\"http://www.efg.com\".*";
String mtchr="[{\"id\":\"362237-13\",\"http//:www.abc.com\"},{\"id\":\"364075-13\",\"http://www.xyz.com\"},{\"id\":\"364121-13\",\"http://www.efg.com\"}]";
boolean b = Pattern.matches(pttrn, mtchr);
System.out.println("b is !!" + b); 
```

# html - 如何在 div 元素中水平居中按钮元素？

> ID：15300234
> 
> 赞同：56
> 
> 时间：2013-03-08T17:52:46.557
> 
> 标签：html, css, center, text-alignment, text-align

我不想将 CSS 添加到我的 div 元素（例如`<div style="text-align: center;">`）。

我只想将 CSS 代码添加到按钮元素。

```
<div>
  <button>Button</button>
</div>
```

在这种情况下，如何将按钮水平居中？

* * *

## 回答 #1

> 赞同：144
> 
> 时间：2013-03-08T17:54:59.197

```
button {
    margin:0 auto;
    display:block;
} 
```

```
button {
  margin: 0 auto;
  display: block;
}
```

```
<div>
  <button>Button</button>
</div>
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-08T18:03:42.923

其他人已经提到了这个`margin: 0 auto;`方法，但是如果你想解释一下，浏览器会在你的元素所在的任何容器中分割可用空间。

还需要指出的是，您可能还需要为元素指定宽度，以使其正常工作。

所以，总的来说：

```
button {
    display:inline-block; //Typically a button wouldn't need its own line        
    margin:0 auto;
    width: 200px; //or whatever
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-03-08T17:55:31.493

你需要`display: block; margin: auto;`在`<button>`. [jsFiddle](http://jsfiddle.net/jU994/)

# c# - 将位图转换为矩阵

> ID：15300235
> 
> 赞同：1
> 
> 时间：2013-03-08T17:52:47.430
> 
> 标签：c#, matrix, bitmap, pixel

我一直在尝试将位图对象转换为 int 矩阵。我在一张空白的白纸上用油漆画了字母“C”，如果位图对象中的像素在同一位置（x，y），程序应该用“0”初始化arr（x，y）是白色的，如果它是黑色像素，则相应地为“1”。

我写了以下代码：

```
 static void Main(string[] args)
    {

          Bitmap arie = new Bitmap(@"C:\Users\User\Desktop\letter.bmp");
          object [,] arr = new object[arie.Width, arie.Height];
        int min=1000,counter=1;
        for (int i = 0; i < arr.GetLength(0) - 1; i++)
        {
            for (int j = 0; j < arr.GetLength(1) - 1; j++)
            {
                if (arie.GetPixel(i, j).ToArgb() == Color.White.ToArgb())
                {
                    arr[i, j] = 0;
                }
                else
                    arr[i, j] = 1;
            }
        }

          for (int i = 1; i < arr.GetLength(0) - 2; i++)
          {
              for (int j = 1; j < arr.GetLength(1) - 2; j++)
              {
                  Console.Write(arr[i, j]);
              }
              Console.WriteLine();
          }

    } 
```

最后我画的字母“C”是这样的： http: [//teachers.web.cern.ch/teachers/archiv/hst2000/teaching/expt/wavesand/image39.gif](http://teachers.web.cern.ch/teachers/archiv/hst2000/teaching/expt/wavesand/image39.gif)

似乎有人能认识到这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T21:10:42.630

主要问题是，当您将数组输出到控制台时，您是按列而不是按行遍历它。这就是为什么您的阵列似乎旋转了 90 度。

如果在第二个循环部分（输出到控制台的位置），您交换内部和外部循环，您应该会看到更好的结果。

我也同意其他评论：1）如果您想要更好的性能，请使用 LockBits/UnlockBits 方法访问位图 2）您的循环索引不正常

如果您使用 x 和 y 而不是 i 和 j，它将帮助您识别何时犯了这些错误。

尝试这个：

```
static void Main(string[] args)
{
    Bitmap arie = new Bitmap(@"C:\Users\User\Desktop\letter.bmp");
    object [,] arr = new object[arie.Width, arie.Height];
    int min=1000,counter=1;
    for (int i = 0; i < arie.Width; i++)
    {
        for (int j = 0; j < arie.Height; j++)
        {
            if (arie.GetPixel(i, j).ToArgb() == Color.White.ToArgb())
            {
                arr[i, j] = 0;
            }
            else
                arr[i, j] = 1;
        }
    }

    for (int y = 0; y < arie.Height; y++)
    {
       for (int x = 0; x < arie.Width; x++)
       {
           Console.Write(arr[x, y]);
       }
       Console.WriteLine();
    }
} 
```

# ios - 一键在模拟器和手机上运行

> ID：15300241
> 
> 赞同：3
> 
> 时间：2013-03-08T17:53:04.263
> 
> 标签：ios, objective-c, xcode

我正在开发一个基于聊天的应用程序，并且首先在模拟器中编译/运行该项目，然后将设备更改为我的手机，然后在那里编译/运行。这设置了两个设备，因此我可以测试它们之间的聊天。

这工作正常，但有点乏味，因为我几乎每次编译时都在这样做。

有没有一种方法可以设置 XCode，这样我就可以点击运行，它会在两台设备上编译和运行？

或者有没有人想出一个更有效的解决方案来在需要两个设备时进行测试？

# java - 如何使 Spring 的自定义范围在两个或多个会话之间共享信息？

> ID：15300244
> 
> 赞同：0
> 
> 时间：2013-03-08T17:53:13.473
> 
> 标签：java, spring, session, grails

我们有一个包含聊天的应用程序。我们正在使用 Node.JS 的 IO Socket 向客户端进行推送。客户端在通过身份验证后，以他/她的 id 作为房间的标识符连接到房间。我们这样做是因为有一些单身人士会向客户端推送一些通知，与他/她的会话无关。聊天的 spring bean 是 SessionScoped。当同一个客户端使用两个不同的浏览器登录系统时，我们面临的问题就会发生。创建了两个会话，所以有两个聊天的spring bean在运行。由于两个 bean 都推送到由用户 id 标识的房间，因此在客户端，相同的消息会到达两次。重复消息的数量随着浏览器数量的增加而增加。

所以，我想为 Spring 创建一个自定义范围。此范围必须在使用相同登录名登录的所有客户端之间共享，并且必须在使用此登录名登录的所有会话被销毁时立即销毁。

我认为这个范围需要一个包含每个登录的所有会话的映射，并且它需要监听这些会话的销毁。有人可以帮我弄这个吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T13:13:46.613

我找到了以下解决方案：

我创建了一个 spring 的单例 bean，它有一个使用 MapMaker of Guava 创建的 Map。该地图具有弱值（更多关于弱引用的信息：[http ://weblogs.java.net/blog/2006/05/04/understanding-weak-references](http://weblogs.java.net/blog/2006/05/04/understanding-weak-references)）。然后我有一个春季的会话bean。这个会话 bean 向单例请求传递客户端 ID 的聊天实例。单身人士，验证地图中是否有东西。如果没有，它会创建一个新的聊天实例，放入地图并返回它。会话 bean 维护此聊天实例的引用。如果用户在不同的浏览器中登录，新的会话 bean 也会这样做。这一次，它将获取保存在地图中的实例。当没有更多会话 bean 引用聊天实例时，它将被垃圾收集，因为地图对其具有弱引用。

# ruby-on-rails-3 - 填写创建/更新记录字段

> ID：15300246
> 
> 赞同：0
> 
> 时间：2013-03-08T17:53:27.120
> 
> 标签：ruby-on-rails-3

再会

我有一个企业名称字段，我希望在保存/更新时自动填写第二个字段。如果业务之间有空格，我需要用破折号替换这些空格。

例子

公司名称：ABC地毯清洁剂（输入）

业务领域：abc-carpet-cleaners@domain.com（需要结果） *@domain.com 只是普通文本*

有任何想法吗

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T17:55:17.610

您可以在模型中添加回调：

```
before_validation :fill_business_field

def fill_business_field
  self.business_field = "#{self.business_name.downcase.gsub(' ', '-')}@domain.com" if !self.business_name.nil?
end 
```

# php - mongodb->在文档中排序

> ID：15300254
> 
> 赞同：0
> 
> 时间：2013-03-08T17:54:03.693
> 
> 标签：php, mongodb

每个文档我都有这个结构：

```
{
"_id": NumberInt(781),
"link_id": {
 "11617": {
   "thumb_position": NumberInt(654),
   "last_scan": NumberInt(1362671892),
   "row_numb": NumberInt(0),
   "clicks": NumberInt(0)
},
 "11623": {
   "thumb_position": NumberInt(562),
   "last_scan": NumberInt(1362671892),
   "row_numb": NumberInt(0),
   "clicks": NumberInt(0)
},
 "11689": {
   "thumb_position": NumberInt(93),
   "last_scan": NumberInt(1362671892),
   "row_numb": NumberInt(0),
   "clicks": NumberInt(0)
}, {...}
} 
```

事实是我想通过 thumb_position 订购。我正在使用： $res = $collection->find(array("_id" => intval(781)))->sort(array('link_id.thumb_position' => 1))

它不工作。我试过 ->sort(array('link_id.$.thumb_position' => 1)) 或 ->sort(array('thumb_position' => 1)) 和相应的 $collection->ensureIndex。没运气。我见过一些排序的例子，但它们都与排序文档有关，文档内部没有排序。有任何想法吗？！多谢！

# java - 用于从我的手机发送到 Java 应用程序的数据的 Java 侦听器

> ID：15300261
> 
> 赞同：1
> 
> 时间：2013-03-08T17:54:37.087
> 
> 标签：java, android, bluetooth

所以这是我的基本想法：

我有一个 android 应用程序，它将读取条形码并生成等效字符串。该字符串将被发送到我的电脑。

我有一个 java GUI 应用程序，它有一个`TextField`将在从我的手机发送到我的 PC 时自动填充该字符串。

那么我该怎么做以及我需要什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T18:20:24.990

尝试以下操作：

1.  创建一个 Web 应用程序以接收来自手机的输入。此应用程序在运行时的位置并不重要；您只需要知道 URL 即可访问它。
2.  使用 HTTP 发布请求将手机中的信息发布到 Web 应用程序。
3.  没有下一步。

# iphone - iOS 注册 .p12 文件类型 (cfbundledocumenttypes)

> ID：15300265
> 
> 赞同：0
> 
> 时间：2013-03-08T17:54:58.343
> 
> 标签：iphone, ios, ipad, uidocumentinteraction

我想在我的应用程序上阅读将发送给用户电子邮件的 .p12 文件。

但是 .p12 文件不会出现“打开方式”选项。

我尝试了 public.data，我可以在所有文件中看到“打开”选项（我尝试了图像、pdf、html 文件），除了 .p12 文件。

为什么我看不到 .p12 文件的“打开方式”选项？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T15:34:54.270

似乎无法为 .p12 文件添加“打开方式”选项。

我刚刚将 .p12 更改为我的自定义扩展名，我的应用程序可以读取该文件。

我遵循了本教程：[如何让我的应用程序显示在 iOS 上特定文档类型的“打开方式...”菜单中](https://developer.apple.com/library/ios/#qa/qa1587/_index.html)

# xml - 将空 XML 元素更改为具有自闭合标签的元素

> ID：15300268
> 
> 赞同：0
> 
> 时间：2013-03-08T17:55:07.137
> 
> 标签：xml, formatting

我有几个（~5）大（~1000 行）XML 文件，其中包含许多这样的元素：

```
<Foo Bar="Baz">
</Foo > 
```

我希望他们都变成这样：

```
<Foo Bar="Baz" /> 
```

是否有可以自动为我执行此操作的工具或脚本？注意：有些元素不是空的，不应该改成自闭标签；我关心的只有大约 5 个不同的元素名称。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T19:25:03.747

如果您有`xsltproc`或其他 XSLT 处理器，那么这应该很简单。现在，您在问题中显示的示例元素实际上并不是空的，因为它包含一个文本节点（换行符）。但是 XSLT 允许您指定可以忽略纯空格文本节点的元素。因此像这样的样式表

```
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">
  <xsl:strip-space elements="Foo Bar Baz"/>

  <xsl:template match="@*|node()">
    <xsl:copy><xsl:apply-templates select="@*|node()"/></xsl:copy>
  </xsl:template>
</xsl:stylesheet> 
```

应该做你需要的。`strip-space`告诉它哪些元素应该剥离它们的纯空白文本节点子节点，并且模板是一个恒等变换，它将输入复制到输出不变（在*空白*剥离之后，这发生在解析时）。一旦元素真的是空的，序列化程序应该将它们写成自封闭标签。

# java - 即使窗口大小发生变化，如何将面板的大小设置为窗口的大小？

> ID：15300270
> 
> 赞同：4
> 
> 时间：2013-03-08T17:55:15.467
> 
> 标签：java, swing, jpanel

这是我的代码。我想将球反弹到的框的大小设置为窗口大小，即使用户调整了窗口的大小，例如恢复窗口或将其拖动到某个大小。非常感谢。

```
import java.awt.*;
import javax.swing.*;
import java.awt.event.*;

/**
 * One ball bouncing inside a rectangular box. 
 * All codes in one file. Poor design!
 */
// Extends JPanel, so as to override the paintComponent() for custom rendering codes. 
public class BouncingBallSimple extends JPanel {
// Container box's width and height
private final int BOX_WIDTH = 700;
private final int BOX_HEIGHT = 700;

// Ball's properties
private float ballRadius = 15; // Ball's radius
private float ballX = ballRadius + 50; // Ball's center (x, y)
private float ballY = ballRadius + 20; 
private float ballSpeedX = 60;   // Ball's speed for x and y
private float ballSpeedY = 60;

private static final int UPDATE_RATE = 30; // Number of refresh per second

/** Constructor to create the UI components and init game objects. */
public BouncingBallSimple() {
  this.setPreferredSize(new Dimension(BOX_WIDTH, BOX_HEIGHT));

  // Start the ball bouncing (in its own thread)
  Thread gameThread;
   gameThread = new Thread() {
@Override
public void run() {
  while (true) { // Execute one update step
     // Calculate the ball's new position
     ballX += ballSpeedX;
     ballY += ballSpeedY;
     // Check if the ball moves over the bounds
     // If so, adjust the position and speed.
     if (ballX - ballRadius < 0) {
        ballSpeedX = -ballSpeedX; // Reflect along normal
        ballX = ballRadius; // Re-position the ball at the edge
     } else if (ballX + ballRadius > BOX_WIDTH) {
        ballSpeedX = -ballSpeedX;
        ballX = BOX_WIDTH - ballRadius;
     }
     // May cross both x and y bounds
     if (ballY - ballRadius < 0) {
        ballSpeedY = -ballSpeedY;
        ballY = ballRadius;
     } else if (ballY + ballRadius > BOX_HEIGHT) {
        ballSpeedY = -ballSpeedY;
        ballY = BOX_HEIGHT - ballRadius;
     }
     // Refresh the display
     repaint(); // Callback paintComponent()
     // Delay for timing control and give other threads a chance
     try {
        Thread.sleep(1000 / UPDATE_RATE);  // milliseconds
     } catch (InterruptedException ex) { }
  }
}
};
  gameThread.start();  // Callback run()
}

/** Custom rendering codes for drawing the JPanel */
@Override
public void paintComponent(Graphics g) {
  super.paintComponent(g);    // Paint background

  // Draw the box
  g.setColor(Color.CYAN);
  g.fillRect(0, 0, getWidth(), getHeight());

  // Draw the ball
  g.setColor(Color.BLUE);
  g.fillOval((int) (ballX - ballRadius), (int) (ballY - ballRadius),
        (int)(2 * ballRadius), (int)(2 * ballRadius));
                    Graphics2D comp2D = (Graphics2D) g;                  
                    comp2D.drawRect(0, 645, 1365, 100);
                    comp2D.setColor(Color.GREEN);
                    comp2D.fillRect(0, 645, 1365, 100);
                    Graphics2D stand = (Graphics2D) g;
                    stand.setColor(Color.BLACK);
                    stand.fillRect(80, 575, 30, 70);
                    Graphics2D sling = (Graphics2D) g;
                    sling.drawArc(15, 570, 90, 50, 50, 250);
}

/** main program (entry point) */
public static void main(String[] args) {
  // Run GUI in the Event Dispatcher Thread (EDT) instead of main thread.
  javax.swing.SwingUtilities.invokeLater(new Runnable() {
     @Override
     public void run() {
        // Set up main window (using Swing's Jframe)
        JFrame frame = new JFrame("Angry Birds for Annie May Tion");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setContentPane(new BouncingBallSimple());
        frame.pack();
        frame.setVisible(true);
     }
  });
 }
 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T18:22:58.530

1.  删除这一行：`this.setPreferredSize(new Dimension(BOX_WIDTH, BOX_HEIGHT));`
2.  无论您在哪里使用，都`BOX_WIDTH`将其替换为`getWidth()`
3.  无论您在哪里使用，都`BOX_HEIGHT`将其替换为`getHeight()`

这应该够了吧。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T18:10:45.253

它应该像删除`this.setPreferredSize()`构造函数中的调用一样简单。当窗口调整大小时，它会请求面板自行调整大小。在您的绘画例程中，您将获得面板的当前边界并在它们之间弹跳，因此它应该可以正常工作。

在一个不相关的注释上：你应该用 javax.swing.Timer 替换`aameThread`你[的](http://docs.oracle.com/javase/6/docs/api/javax/swing/Timer.html)。实际上，您正在从事件调度线程外部调用绘制请求，这是一个坏主意。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T18:15:14.097

这里没有简单的答案，因为您已经硬编码了 x,y,w,h 值。不太简单的答案是使用变量而不是硬编码值，并在 paintComponent() 方法中动态调整这些值。

# java - 如何将字符串与java中的对象实例相关联

> ID：15300276
> 
> 赞同：2
> 
> 时间：2013-03-08T17:55:32.410
> 
> 标签：java, instanceof

我有一个代码块，我在其中反序列化传入的数据，然后我必须将其转换为一些已知的类对象，因此我做了这样的事情：

```
 if (object instanceof MyClass) {
         Myclass data = (MyClass)object;  
   } 
```

它工作得很好，但是现在我遇到了一种情况，可能会有不同类型的课程。那么有没有办法根据以下内容进行比较`"String"`：

```
 if (object instanceof "String") {
         String data = (String)object;  
   } 
```

问题是在这种情况下，用户将指定类对象名称，那么我该怎么做呢？
我应该强制用户启动一个虚拟对象，然后传递给我的方法，还是有办法用字符串初始化空对象，有什么想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-08T17:59:03.193

它又臭又丑，而且我不喜欢它，但你*可以*使用[`Class#forName()`](http://docs.oracle.com/javase/7/docs/api/java/lang/Class.html#forName%28java.lang.String%29)and [`Class#isInstance(Object)`](http://docs.oracle.com/javase/7/docs/api/java/lang/Class.html#isInstance%28java.lang.Object%29)。

```
if (Class.forName("java.lang.String").isInstance(object)) {
     String data = (String)object;  
} 
```

不过，你仍然会在演员阵容方面遇到问题。`Class#cast()`只有当你有 a 时才能获得编译时类型安全`Class<T>`——但你只能得到 a `Class<?>`from `Class#forName()`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-08T18:05:41.973

您可以使用[Class#forName()](http://docs.oracle.com/javase/7/docs/api/java/lang/Class.html#forName%28java.lang.String%29)和[Class#isInstance(Object)](http://docs.oracle.com/javase/7/docs/api/java/lang/Class.html#isInstance%28java.lang.Object%29)。要做到这一点

这是一个示例代码

```
FileDemo dd = new FileDemo();
Class object = Class.forName("com.FileDemo");

if(object.isInstance(object)){
    //do your conversion
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-08T17:58:07.710

你总是可以这样做：

```
if(object instanceof MyClass)  
{
             Myclass data = (MyClass)object;  
} else  
{  
       String data = object.toString();
} 
```

默认情况下`Object`，java 中的 each 都有一个`toString`可以调用的函数。没有必要强制转换为`String`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-08T17:58:42.420

请参阅此处的“forname”方法：http: [//docs.oracle.com/javase/7/docs/api/java/lang/Class.html](http://docs.oracle.com/javase/7/docs/api/java/lang/Class.html)

# php - 将选定的桌面 Web 链接从手机重定向到移动网站

> ID：15300277
> 
> 赞同：0
> 
> 时间：2013-03-08T17:55:33.677
> 
> 标签：php, redirect, mobile, hyperlink

我面临一个小挑战。我有一个网站，还有手机版。当使用移动电话的用户单击来自另一个站点（例如 facebook）的链接时，我希望将用户重定向到显示所选链接内容的移动站点。

成就：

我能够将用户从桌面版本重定向到移动页面。

挑战

我无法显示所选链接的内容，例如[http://passnownow.com/inblog.php?id=3840#.UToTf3YetfU.twitter](http://passnownow.com/inblog.php?id=3840#.UToTf3YetfU.twitter)。

它只导航到用户必须搜索帖子的移动站点。

我能做些什么。

这是我的代码。

```
<? include("overall.php");?>
<?

session_start();

require_once('mobile_device_detect.php');

$blackberrystatus = mobile_device_detect(true,true,false,true,true,true,true,false,false);

$androidstatus = mobile_device_detect(true,true,true,true,false,true,true,false,false);

$mobile = mobile_device_detect(true,true,true,true,true,true,true,false,false);
$isMobile = (bool)preg_match('#\b(ip(hone|od)|android\b.+\bmobile|opera m(ob|in)i|windows (phone|ce)|blackberry'.
                    '|s(ymbian|eries60|amsung)|p(alm|rofile/midp|laystation portable)|nokia|fennec|htc[\-_]'.
                    '|up\.browser|[1-4][0-9]{2}x[1-4][0-9]{2})\b#i', $_SERVER['HTTP_USER_AGENT'] );

if($_GET["view"]=="full"){

    setcookie("passnownow[client]", "pc", $time + 1209600);

    $_SESSION["client"] = "pc";

    }

if ($_GET["ref"]=="android" or $_GET["ref"]=="blackberry"){

    setcookie("passnownow[client]", "app", $time + 1209600);

    $_SESSION["client"] = "app";

    header('location: mobile/new.php?id=""');

    } else if ($_SESSION["client"]=="pc" or $_COOKIE['passnownow']["client"]=="pc"){

        }else if ($mobile or $isMobile){

    setcookie("passnownow[client]", "mobile", $time + 1209600);

    $_SESSION["client"] = "mobile";

    **header('location: mobile/new.php?id=""');**   

        }

    include("overall.php");

?> 
```

我的问题是：我怎样才能通过`header('location: mobile/new.php?id=""');`来显示选定的链接，例如`header('location: mobile/new.php?id="234"');`

我添加什么代码来获取所选链接的页面 id 并将其传递给`header('location: mobile/new.php?id=""');`

我尝试使用该`$_GET['']`命令，但它不起作用，即`header('location: mobile/new.php?id=<?php $_GET['id']; ?>');`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T18:05:30.820

Your syntax for your redirect is incorrect and this may be your problem. You're treating the URL variable as a string (ex. `index.php?var="value"`). The proper syntax would be

```
header('Location: mobil/new.php?id=1234'); 
```

Then when building your string you can do

```
header("Location: mobil/new.php?id={$_GET['id']}"); 
```

You should always check your inputs for security reasons.

In your last statement

> I tried using the $_GET[''] command but it didn't work ie header('location: mobile/new.php?id=`<?php $_GET['id']; ?>`');

Your problem was that you were trying to enter into PHP when you were already in it. No need to use `<?php` when you haven't closed out of the last opening. Also, though your syntax is already wrong, you were missing an `echo`.

# google-analytics - 实施事件跟踪后网页浏览量下降并跳出率增加

> ID：15300284
> 
> 赞同：0
> 
> 时间：2013-03-08T17:56:06.667
> 
> 标签：google-analytics, web-analytics, bounce, getscript

我刚刚在网站上完成了一轮 Google Analytics 事件跟踪更新，其中包括更新我的`_addOrganic`呼叫，这些呼叫包含在文件中`/scripts/ga_search_engines.js`。

这些文件是：

新 - 大小分别为 27kb 和 28kb。OLD - 大小分别为 4kb 和 5kb。

```
$.getScript('/scripts/ga_search_engines.js').complete(function() {
    _gaq.push(['_trackPageview']);
});

$.getScript('/scripts/ga_search_engines_global.js').complete(function() {
    _gaq.push(['rollup._trackPageview']);
}); 
```

我的事件跟踪将交互参数设置为`false`，例如：

```
_gaq.push(['_trackEvent', 'Product Details', product_name, product_code, product_price, false]); 
```

因此，上面的代码（事件）在站点上的每个产品页面上都被触发，`getScript`调用被包含在站点上的每个页面中，您会注意到必须在`trackePageview`触发之前下载。

我无法解决的是为什么我发现我的跳出率*增加了大约 50%，因为*[谷歌的文档](https://developers.google.com/analytics/devguides/collection/gajs/eventTrackerGuide)建议添加事件跟踪会**降低**跳出率，而不是增加。

我还注意到网页浏览量下降了 30-40%，但我还是不能指望这一点，尽管上面两个 JavaScript 文件的大小略有增加让我感到奇怪。

调试此问题的最佳方法是什么，我应该调查什么以找出问题所在和位置？

这是我在每一页都包含的 GA 代码的完整部分 - [http://pastebin.com/fj6rf4Xa](http://pastebin.com/fj6rf4Xa)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T11:55:17.310

显然，这归结为以前通过虚拟浏览量的实现*夸大*了浏览量。作为改进的一部分，删除这些会降低页面浏览量的价值，这看起来像是一个问题，但实际上是把它们降低到一个准确的水平。

调试和排除故障不是最容易的事情。

# javascript - Meteor JS - 任何访问者都可以更改集合（mongodb）（不安全）

> ID：15300285
> 
> 赞同：2
> 
> 时间：2013-03-08T17:56:07.333
> 
> 标签：javascript, database, meteor

我正在为我正在从事的项目使用 Meteor JS 节点框架。

我注意到任何访问我网站的人都可以简单地在浏览器的 javascript 控制台中输入类似的命令并编辑我的数据库。

```
MyCollection.insert({name: 'I am a hacker', message: 'hahaha'}); 
```

有没有办法阻止用户这样做？

这真的不安全，他们需要做的就是找到集合的名称，他们可以做任何他们想做的事情。

我该如何解决这个问题？

我应该使用不同的框架吗，Meteor JS 不适合大型项目吗？

谢谢，

乔纳森。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-08T18:13:33.167

您最好阅读他们的文档，特别是[http://docs.meteor.com/#dataandsecurity](http://docs.meteor.com/#dataandsecurity)

# ios - 何时发布 CGMutablePathRef

> ID：15300292
> 
> 赞同：1
> 
> 时间：2013-03-08T17:56:35.927
> 
> 标签：ios, memory-management, memory-leaks, cgpath

我不确定何时在下面的代码示例中释放由 CGPathCreateMutable 创建的路径。

```
 // iVar
    ivarImageView = [[UIImageView alloc] initWithImage:nil];

    // Clip to shape
    CALayer *imageLayer = [self.ivarImageView layer];
    CAShapeLayer *shapeLayer = [CAShapeLayer layer];
    CGMutablePathRef clipPath = CGPathCreateMutable();
    shapeLayer.path = clipPath;
    imageLayer.mask = shapeLayer;

    [self addSubview:self.ivarImageView]; 
```

iVarImageView 是保留的 ivar。所以它在对象的生命周期中使用，就像它的 shapLayer.path 一样。那么什么时候是释放这条路径的合适时机呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T19:22:49.007

您可以在该行之后释放它：

```
shapeLayer.path = clipPath; 
```

由于您分配给`shapeLayer.path`，因此您不必担心`clipPath`之后的事情，因为它将归`shapeLayer`.

# jquery - 基于鼠标悬停显示 div

> ID：15300293
> 
> 赞同：0
> 
> 时间：2013-03-08T17:56:42.970
> 
> 标签：jquery, html, hover, fadein, hoverintent

我正在设计一个包含两行名称的标题的网站。当用户将鼠标悬停在其中一个名称上时，特定的 div 需要出现在名称下方。此 div 将包含其他图像和链接，因此用户必须能够将鼠标从名称向下导航到 div。

为简单起见，我将名称的第一行称为“top”，关联的 div 称为“top-reveal”，将名称的底行称为“bottom”和“bottom-reveal”。（请参阅链接的 jsfiddle。）

“Top-reveal”和“bottom-reveal”需要出现在同一个地方，不能与上面的名字重叠。

我首先尝试使用直接的 CSS div:first-child，但我无法控制用户的“意图”。

然后我使用 hoverIntent 插件切换到 jQuery 方法：

```
var timeHover = 700;

$("[id^='top']").hoverIntent({
    over: topRevealer,
    timeout: timeHover,
    out: topHider
});
$("[id^='bottom']").hoverIntent({
    over: bottomRevealer,
    timeout: timeHover,
    out: bottomHider
});

function topRevealer() {
    setTimeout(function () {
        $('#bottom-reveal').hide(), $('#top-reveal').fadeIn();
    }, timeHover);
}

function bottomRevealer() {
    setTimeout(function () {
        $('#top-reveal').hide(), $('#bottom-reveal').fadeIn();
    }, timeHover);
}

function topHider() {
    $('#top-reveal').hide()
}

function bottomHider() {
    $('#bottom-reveal').hide()
} 
```

我正在使用[hoverIntent](http://cherne.net/brian/resources/jquery.hoverIntent.html)，因为我不知道如何使用 .hover() 进行超时。它可以工作，除了显示 div 淡出然后重新进入。我知道这是因为当鼠标从“Top”移动到“Top-Reveal”时它正在调用“TopHider”，然后在它进入时调用“TopRevealer” “Top-Reveal” div，但我不希望它进出。我还注意到它可以创建一个淡入淡出队列，我不知道如何创建各种错误捕获器。

摆弄我在哪里：http: [//jsfiddle.net/UFZ6U/](http://jsfiddle.net/UFZ6U/)

正如你所看到的，它几乎就在那里，但我需要一些指导来进行最后的推动，甚至需要一些关于更好的 JavaScript 编码的技巧。我最近才开始在下载独立脚本之外使用 JavaScript，现在我已经多次碰壁了。我正在寻找最直接的答案，它不必是 jQuery 或纯 CSS，只需一个轻量级的工作解决方案即可。我也没有与 hoverIntent 结婚，但它帮助我走到了这一步。

我希望这是有道理的。

谢谢所有潜在的回答者。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T18:54:25.483

如果您已经在使用超时，您可以选择性地存储和清除超时 ID 以创建此效果。以下解决方案不使用 hoverIntent jQuery 插件。

**HTML**

```
<div id="hover-area">
    <div id="one" class="hoverable">One</div>
    <div id="two" class="hoverable">Two</div>
    <div id="three" class="hoverable">Three</div>
    <div id="four" class="hoverable">Four</div>
    <div id="one-reveal" class="revealable">One Reveal</div>
    <div id="two-reveal" class="revealable">Two Reveal</div>
    <div id="three-reveal" class="revealable">Three Reveal</div>
    <div id="four-reveal" class="revealable">Four Reveal</div>
</div> 
```

**JS**

```
var timeHover = 700;

// Setup reveal and hide on hoverable items
$('.hoverable').on({
    'mouseenter': function() {
        // Get the hoverable ID
        var hoverableId = $(this).attr('id');
        // Generate the associated revealable ID
        var revealableId = hoverableId + '-reveal';
        // Show the associated revealable item (after timeout)
        showRevealable('#' + revealableId);
    },
    'mouseleave': function() {
        // Get the hoverable ID
        var hoverableId = $(this).attr('id');
        // Generate the associated revealable ID
        var revealableId = hoverableId + '-reveal';
        // Hide the associated revealable item (after timeout)
        hideRevealable('#' + revealableId);
    }
});

// Set up to maintain visibility and hide for the revealable items
$('.revealable').on({
    'mouseenter': function() {
        // Clear the timeout for this revealable item
        clearRevealableTimeout(this);
    },
    'mouseleave': function() {
        // Hide the revealable item (after timeout)
        hideRevealable(this);
    }
});

// Clears the timeout for the given revealable container
function clearRevealableTimeout(revealable) {
    // Get the associated timeout ID from the data attribute
    var timeout = $(revealable).data('timeout');
    // Clear the associated timeout
    clearTimeout(timeout);
}

// Shows the given revealable item (after a delay)
function showRevealable(revealable) {
    // Set a new timeout for the show and get the associated ID
    var timeout = setTimeout(function () {
        // Hide any existing revealables that are not this one
        $('.revealable').not(revealable).hide();
        $(revealable).stop().fadeIn();
    }, timeHover);
    // Store the timeout ID in the data attribute
    $(revealable).data('timeout', timeout);
}

// Hides the given revealable item (after a delay)
function hideRevealable(revealable) {
    // Clear the timeout to prevent any pending behavior
    clearRevealableTimeout(revealable);
    // Set a new timeout for the hide and get the associated ID
    var timeout = setTimeout(function () {
        $(revealable).hide();
    }, timeHover);
    // Store the timeout ID in the data attribute
    $(revealable).data('timeout', timeout);
} 
```

**[演示](http://jsfiddle.net/uzgtD/)**

# asp.net - Plupload for amazon s3 with asp.net c#

> ID：15300294
> 
> 赞同：2
> 
> 时间：2013-03-08T17:56:43.077
> 
> 标签：asp.net, amazon-s3, plupload

我的 plupload 代码工作正常。上传成功后我需要将文件名和文件大小保存到表中。我怎么能用 c# 在 asp.net 中做到这一点，我搜索了很多，但我没有找到任何帮助。

我的工作代码在这里

```
 <div style="text-align: center">
    <img src="images/upload_images.png" style="width: 960px" />
</div>
<div id="runtimediv">No runtime found.</div>
<div id="uploaderdiv">
<p>Your browser does not have HTML5, Flash, or Silverlight support.</p></div> 
```

脚本

```
// Convert divs to queue widgets when the DOM is ready
$(function () {
    $("#uploaderdiv").plupload({
        runtimes: 'html5,flash,silverlight,html4,gears,browserplus',
        url: 'https://s3.amazonaws.com/<%=BucketName%>',
        max_file_size: '5000mb',

        multipart: true,
        multipart_params: {
            'key': '<%=foldername%>/${filename}', // use filename as a key
            'Filename': '${filename}', // adding this to keep consistency across the runtimes
            'acl': 'public-read',
            //'Content-Type': 'image/jpeg',
            'success_action_status': '201',
            'AWSAccessKeyId': '<%=AWSAccessKeyID%>',
            'policy': '<%=PolicyDocument%>',
            'signature': '<%=PolicyDocumentSignature%>'
        },

        preinit: {
            Init: function (up, params) {
                $('#runtimediv').html("<div>Current runtime: " + params.runtime + "</div>");
            }
        },

        // !!!Important!!! 
        // this is not recommended with S3, since it will force Flash runtime into the mode, with no progress indication
        //resize : {width : 800, height : 600, quality : 60},  // Resize images on clientside, if possible 

        // optional, but better be specified directly
        file_data_name: 'file',

        // re-use widget (not related to S3, but to Plupload UI Widget)
        multiple_queues: true,

        // Specify what files to browse for
        //filters : [
        //  {title : "JPEG files", extensions : "jpg"}
        //],

        // Flash settings
        flash_swf_url: '/plupload_v1.5.4/js/plupload.flash.swf',

        // Silverlight settings
        silverlight_xap_url: '/plupload_v1.5.4/js/plupload.silverlight.xap'
    });
}); 
```

C# 代码

```
 protected void Page_Load(object sender, EventArgs e)
        {

            if (!IsPostBack)
            {
                // HttpContext.Current.Response.Cache.SetCacheability(HttpCacheability.NoCache);
                //HttpContext.Current.Response.Cache.SetNoServerCaching();
                //HttpContext.Current.Response.Cache.SetNoStore();

                if (Session["username"] == crs.username && crs.username != null && crs.username != "")
                {
                    AWSAccessKeyID = crs.AWSAccessKey;        //** put your value here **
                    AWSSecretAccessKey = crs.AWSSecretKey;    //** put your value here **
                    BucketName = crs.BUCKET_NAME;            //** put your value here **

                    //  crs.foldname = "user130";
                    foldername = crs.foldname;

                    DateTime ExpirationDate;
                    ExpirationDate = DateTime.UtcNow.AddMinutes(60);

                    PolicyDocument = "";
                    PolicyDocument += "{";
                    PolicyDocument += "  \"expiration\": \"" + ExpirationDate.ToString("s") + ".000Z\",";
                    PolicyDocument += "  \"conditions\": [";
                    PolicyDocument += "    {\"bucket\": \"" + BucketName + "\"},";
                    PolicyDocument += "    {\"acl\": \"public-read\"},";
                    PolicyDocument += "    {\"success_action_status\": \"201\"},";
                    //PolicyDocument += "    [\"starts-with\", \"$Content-Type\", \"image/\"],";
                    PolicyDocument += "    [\"starts-with\", \"$Filename\", \"\"],";
                    PolicyDocument += "    [\"starts-with\", \"$name\", \"\"],";
                    PolicyDocument += "    [\"starts-with\", \"$key\", \"\"],";
                    PolicyDocument += "  ]";
                    PolicyDocument += "}";

                    Byte[] ByteArray;
                    ByteArray = System.Text.Encoding.UTF8.GetBytes(PolicyDocument);
                    Response.Write(ByteArray);
                    PolicyDocument = System.Convert.ToBase64String(ByteArray);

                    ByteArray = System.Text.Encoding.UTF8.GetBytes(AWSSecretAccessKey);

                    System.Security.Cryptography.HMACSHA1 MyHMACSHA1 = new System.Security.Cryptography.HMACSHA1(ByteArray);

                    ByteArray = System.Text.Encoding.UTF8.GetBytes(PolicyDocument);

                    Byte[] HashArray;
                    HashArray = MyHMACSHA1.ComputeHash(ByteArray);

                    PolicyDocumentSignature = System.Convert.ToBase64String(HashArray);

                    BindGridview();

                    //Uncomment the following lines if you would like to check if a CORS configuration exists and apply 
                    //one if it does not exist.

                    if (GetBucketCorsExists() == false)
                    {
                        SetBucketCors();
                    }

                    /*    System.Data.DataTable table = new System.Data.DataTable();
                        table.Columns.Add("ID", typeof(int));
                        table.Columns.Add("Name", typeof(string));
                        table.Columns.Add("Salary", typeof(decimal));

                        for (int i = 1; i < 8; i++)
                        {
                           System.Data.DataRow row = table.NewRow();
                            row["ID"] = i;
                            row["Name"] = "Name " + i;
                            row["Salary"] = 10000 * i;
                            table.Rows.Add(row);
                        }

                        GridView1.DataSource = table;
                        GridView1.DataBind();

                        if (GridView1.Rows.Count > 0)
                        {
                            GridView1.UseAccessibleHeader = true;
                            GridView1.HeaderRow.TableSection = TableRowSection.TableHeader;
                        } 

                    */
                }
                else
                { Response.Redirect("Default.aspx"); }

            }
        }

        private static Boolean GetBucketCorsExists()
        {
            String RequestURL;
            String RequestMethod;
            System.Collections.Generic.Dictionary<String, String> ExtraRequestHeaders;
            String AuthorizationValue;
            SprightlySoftAWS.REST MyREST = new SprightlySoftAWS.REST();
            Boolean RetBool;
            String PostData;

            int ErrorNumber = 0;
            String ErrorDescription = "";
            String LogData = "";
            System.Collections.Generic.Dictionary<String, String> FullRequestHeaders = new System.Collections.Generic.Dictionary<String, String>();
            int ResponseStatusCode = 0;
            String ResponseStatusDescription = "";
            System.Collections.Generic.Dictionary<String, String> FullResponseHeaders = new System.Collections.Generic.Dictionary<String, String>();
            String ResponseString = "";

            RequestURL = MyREST.BuildS3RequestURL(true, "s3.amazonaws.com", BucketName, "", "?cors");
            RequestMethod = "GET";
            PostData = "";

            ExtraRequestHeaders = new System.Collections.Generic.Dictionary<String, String>();
            ExtraRequestHeaders.Add("x-amz-date", DateTime.UtcNow.ToString("r"));

            AuthorizationValue = MyREST.GetS3AuthorizationValue(RequestURL, RequestMethod, ExtraRequestHeaders, AWSAccessKeyID, AWSSecretAccessKey);
            ExtraRequestHeaders.Add("Authorization", AuthorizationValue);

            RetBool = MakeAWSRequest(RequestURL, RequestMethod, ExtraRequestHeaders, PostData, ref ErrorNumber, ref ErrorDescription, ref LogData, ref FullRequestHeaders, ref ResponseStatusCode, ref ResponseStatusDescription, ref FullResponseHeaders, ref ResponseString);

            if (ResponseStatusCode == 404)
            {
                return false;
            }
            else if (RetBool == true)
            {
                return true;
            }
            else
            {
                throw new Exception(LogData);
            }
        }

        private static void SetBucketCors()
        {
            String RequestURL;
            String RequestMethod;
            System.Collections.Generic.Dictionary<String, String> ExtraRequestHeaders;
            String AuthorizationValue;
            SprightlySoftAWS.REST MyREST = new SprightlySoftAWS.REST();
            Boolean RetBool;
            String PostData;

            int ErrorNumber = 0;
            String ErrorDescription = "";
            String LogData = "";
            System.Collections.Generic.Dictionary<String, String> FullRequestHeaders = new System.Collections.Generic.Dictionary<String, String>();
            int ResponseStatusCode = 0;
            String ResponseStatusDescription = "";
            System.Collections.Generic.Dictionary<String, String> FullResponseHeaders = new System.Collections.Generic.Dictionary<String, String>();
            String ResponseString = "";

            PostData = "";
            PostData += "<?xml version=\"1.0\" encoding=\"UTF-8\"?>";
            PostData += "<CORSConfiguration xmlns=\"http://s3.amazonaws.com/doc/2006-03-01/\">";
            PostData += "<CORSRule>";
            PostData += "<AllowedOrigin>*</AllowedOrigin>";
            PostData += "<AllowedMethod>PUT</AllowedMethod>";
            PostData += "<AllowedMethod>POST</AllowedMethod>";
            PostData += "<AllowedMethod>GET</AllowedMethod>";
            PostData += "<AllowedMethod>HEAD</AllowedMethod>";
            PostData += "<MaxAgeSeconds>3000</MaxAgeSeconds>";
            PostData += "<AllowedHeader>*</AllowedHeader>";
            PostData += "</CORSRule>";
            PostData += "</CORSConfiguration>";

            RequestURL = MyREST.BuildS3RequestURL(true, "s3.amazonaws.com", BucketName, "", "?cors");
            RequestMethod = "PUT";

            ExtraRequestHeaders = new System.Collections.Generic.Dictionary<String, String>();

            SprightlySoftAWS.S3.CalculateHash MyCalculateHash = new SprightlySoftAWS.S3.CalculateHash();
            String MyMD5;
            MyMD5 = MyCalculateHash.CalculateMD5FromString(PostData);
            ExtraRequestHeaders.Add("Content-MD5", MyMD5);

            ExtraRequestHeaders.Add("x-amz-date", DateTime.UtcNow.ToString("r"));

            AuthorizationValue = MyREST.GetS3AuthorizationValue(RequestURL, RequestMethod, ExtraRequestHeaders, AWSAccessKeyID, AWSSecretAccessKey);
            ExtraRequestHeaders.Add("Authorization", AuthorizationValue);

            RetBool = MakeAWSRequest(RequestURL, RequestMethod, ExtraRequestHeaders, PostData, ref ErrorNumber, ref ErrorDescription, ref LogData, ref FullRequestHeaders, ref ResponseStatusCode, ref ResponseStatusDescription, ref FullResponseHeaders, ref ResponseString);

            if (RetBool == false)
            {
                throw new Exception(LogData);
            }
        }

        private static Boolean MakeAWSRequest(String RequestURL, String RequestMethod, System.Collections.Generic.Dictionary<String, String> UserRequestHeaders, String PostData, ref int ErrorNumber, ref String ErrorDescription, ref String LogData, ref System.Collections.Generic.Dictionary<String, String> FullRequestHeaders, ref int ResponseStatusCode, ref String ResponseStatusDescription, ref System.Collections.Generic.Dictionary<String, String> FullResponseHeaders, ref String ResponseStringFormatted)
        {
            SprightlySoftAWS.REST MyREST = new SprightlySoftAWS.REST();
            Boolean RetBool = true;
            LogData = "";
            int AWSErrorRetries = 5;

            for (int i = 0; i <= AWSErrorRetries; i++)
            {
                LogData += Environment.NewLine;
                LogData += "-Request Started " + DateTime.Now.ToString() + Environment.NewLine;
                LogData += "-RequestURL=" + RequestURL + Environment.NewLine;
                LogData += "-RequestMethod=" + RequestMethod + Environment.NewLine;

                if (UserRequestHeaders != null)
                {
                    foreach (System.Collections.Generic.KeyValuePair<String, String> MyKeyValuePair in UserRequestHeaders)
                    {
                        LogData += "-RequestHeader=" + MyKeyValuePair.Key + ":" + MyKeyValuePair.Value + Environment.NewLine;
                    }
                }
                LogData += "-RequestPostData=" + PostData + Environment.NewLine;

                RetBool = MyREST.MakeRequest(RequestURL, RequestMethod, UserRequestHeaders, PostData);

                LogData += "-Request Complete " + DateTime.Now.ToString() + Environment.NewLine;
                LogData += "-ResponseErrorNumber=" + MyREST.ErrorNumber + Environment.NewLine;
                LogData += "-ResponseErrorDescription=" + MyREST.ErrorDescription + Environment.NewLine;
                LogData += "-ResponseStatusCode=" + MyREST.ResponseStatusCode + Environment.NewLine;
                LogData += "-ResponseStatusDescription=" + MyREST.ResponseStatusDescription + Environment.NewLine;

                if (MyREST.ResponseHeaders != null)
                {
                    foreach (System.Collections.Generic.KeyValuePair<String, String> MyKeyValuePair in MyREST.ResponseHeaders)
                    {
                        LogData += "-ResponseHeader=" + MyKeyValuePair.Key + ":" + MyKeyValuePair.Value + Environment.NewLine;
                    }
                }

                LogData += "-ResponseString=" + MyREST.ResponseString + Environment.NewLine;

                //Set the return values.
                ErrorNumber = MyREST.ErrorNumber;
                ErrorDescription = MyREST.ErrorDescription;
                FullRequestHeaders = MyREST.RequestHeaders;
                ResponseStatusCode = MyREST.ResponseStatusCode;
                ResponseStatusDescription = MyREST.ResponseStatusDescription;
                FullResponseHeaders = MyREST.ResponseHeaders;
                ResponseStringFormatted = MyREST.ResponseStringFormatted;

                if (RetBool == true)
                {
                    break;
                }
                else
                {
                    if (MyREST.ResponseStatusCode == 500 || MyREST.ResponseStatusCode == 503)
                    {
                        //A Service Unavailable response was returned.  Wait and retry.
                        System.Threading.Thread.Sleep(1000 * i * i);
                    }
                    else if (MyREST.ResponseStatusCode == 0 && MyREST.ErrorNumber == 1003)
                    {
                        //Getting the response failed.  This may be a network disconnection.  Wait and retry.
                        System.Threading.Thread.Sleep(1000 * i * i);
                    }
                    else
                    {
                        //An error occured but retrying would not solve the problem.
                        break;
                    }
                }
            }

            return RetBool;
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T16:02:59.147

我想做类似的事情；这是我所做的；

您可以使用 FileUploaded plupload 事件：

```
 FileUploaded: function(up, file, info) {
            // Called when a file has finished uploading
            log('[FileUploaded] File:', file, "Info:", info);
                            // Call a webmethod to store in DB
        }, 
```

在 FileUploaded 事件中，您可以调用**web 方法**（通过它发送文件名和大小）；webmethod 将信息保存到数据库

希望这可以帮助

# java - 取消引用 SQL 字符串的方法

> ID：15300295
> 
> 赞同：1
> 
> 时间：2013-03-08T17:56:46.630
> 
> 标签：java, sql, hibernate

我必须处理一些作为带引号的 SQL 字符串传入的参数，然后再次引用它。我想知道 Hibernate 或 JDBC 或一些常见的 Java 库中是否有任何实用程序可以执行取消引用位？

（否则我想我可以做到`str.replace("''","'")`。这是正确的吗？）

编辑：

只是一些背景。我正在尝试向 Hibernate 添加功能。我覆盖的 Hibernate 类将其参数作为带引号的字符串接收。我无法访问为绑定变量提交的原始参数（无需重写许多 Hibernate 类）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T18:04:08.333

只是不要引用`String`对象。

您的设计有问题，您不应该收到已经引用的它，如果在任何情况下您需要引用它（避免这种情况），请在使用它之前进行。

对于 JDBC 端，您始终可以执行以下操作，因此您不需要 SQL 引用的字符串：

```
String query ="select myColumn from MyTable where fullname = ?";
PreparedStatement stm = c.prepareStatement(query);
stm.setString(1, "Garis M. Suero"); 
```

以简单的方式设计您的软件是一种非常好的做法，以便在开发人员对您的软件进行编码时减少未来的混乱和错误。

例如，如果您从第三方软件接收此信息，您可以创建一个对象，该对象将获取字符串并将其转换为正确的值，并且可能有两种方法，一种是 'getValue() `and another:`getQuotedValue()`

# magento - Magento：如何在 cms 页面上显示所有产品的所有评论

> ID：15300296
> 
> 赞同：0
> 
> 时间：2013-03-08T17:56:49.500
> 
> 标签：magento, review

我想在 cms 页面上显示我对所有产品的所有评论。有人知道怎么做吗？我正在使用 Magento 1.4.2

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T20:01:53.747

这一切都取决于您使用什么模块来为 Magento 的功能提供扩展。如果您查看模块的文件夹（比如说它的 Cmdcentral/Review）

```
app/code/community/Cmdcentral/Review/ 
```

这是模块所在的位置（它也可能在本地）在`etc`for`config.xml`中查找将有一个看起来像这样的部分：

```
<config>
 ...
   <global>
    ....
    <models>
      <review>
          <class>Cmdcentral_Review_Model</class>
      </review>
      <review_mysql4>
         <class>Cmdcentral_Review_Model_Mysql4</class>
         <entities>
              <reviews>table_in_database</reviews>
         </entities>
      </review_mysql4>
   </models>
  .....
 </global>
  ...
</config> 
```

这将根据您所拥有的而有所不同。重要的是内部节点的名称`<entities></entities>`在我的情况下是`<reviews></reviews>`

然后，您可以查看`controllers`文件夹以`IndexController.php`创建如下所示的新函数：

```
public function showallAction(){
   $this->loadLayout();
   $this->renderLayout();

} 
```

现在您必须为此创建一个块，在其中创建一个新块`app/code/community/Cmdcentral/Review/Blocks`并调用它`Showall.php`

您的块应如下所示：

```
<?php class Cmdcentral_Review_Block_Showall extends Mage_Core_Block_Template{
   public function getAllReviews(){
       return Mage::getModel('review/reviews')->getCollection();
   }
} 
```

`review`是模块名称，`reviews`是我们`<entities></entities>`在`config.xml`.

接下来我们`app/design/frontend/`从这里开始，我们正在寻找的文件很可能在`base/default`但也可能在另一个主题的文件夹中。我们正在寻找的文件`Modulename.xml`在我的情况下将是`app/design/frontend/base/default/layout/Review.xml` 打开您的布局文件，现在只需在`<layout></layout>`节点中添加它：

```
<review_index_showall>
  <reference name="content">
    <block type="review/showall" name="showall" template="review/showall.phtml"/>
   </reference>
<review_index_showall> 
```

这只是告诉 Magento，当我们加载`review/index/showall`路由并访问`showallAction()`控制器中的函数时，将块添加到内容中。

现在块也有一个`template="review/showall.phtml"`属性。去`app/design/frontend/base/default`寻找一个`review`目录（或任何模块被称为）。如果它不存在（我怀疑）创建它！在此创建`showall.phtml`. 所以现在你应该让它看起来像`app/design/frontend/base/default/review/showall.phtml`

打开这个文件，现在你创建了你的页面。~呸！

只需记住使用`$this->getAllReviews()`来获取您的评论/评论集合，然后只需执行以下操作：

```
$reviews = $this->getAllReviews();
foreach($reviews as $review){
  echo $review->getData('column_name');
  #or
  echo $review->getColumnName();
  #does the same thing
} 
```

我希望这会有所帮助，我没有犯任何错误。请记住，起初 Magento 会让您哭泣，但当您习惯 Magento 时，它会变成断断续续的呜咽声！

# youtube-api - 关键字不会显示在经过身份验证的请求中

> ID：15300299
> 
> 赞同：0
> 
> 时间：2013-03-08T17:57:03.950
> 
> 标签：youtube-api

使用 API 的第 2 版。不久前，我不得不切换到 oauth2 身份验证以继续在我的 JSON 响应中获取关键字。我这样做了，它工作了一段时间，但现在关键字已经从经过身份验证的请求中消失了。[通过在https://developers.google.com/oauthplayground/](https://developers.google.com/oauthplayground/)进行测试，我确认这不仅仅是我的代码

有人知道发生了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T20:42:35.633

在重新阅读宣布更改的[博客文章后](http://apiblog.youtube.com/2012/08/video-tags-just-for-uploaders.html)，我看到关键字将仅对经过身份验证的用户可用，然后仅在单个视频上可用。我做了一些测试，并要求他们提供一个单独的视频。

# shell - 通过脚本打开文件时，我得到的字符串与实际包含的字符串不同

> ID：15300300
> 
> 赞同：1
> 
> 时间：2013-03-08T17:57:05.147
> 
> 标签：shell

我有一个脚本可以查看这样的文件：

```
for item in `more $dir_tmp/$lcl_ident_cnl.root.tmp`
    do
        txtPos=`expr index "$item" "."`
... 
```

这让我想起了这个：

```
+ more /gcamp/dbm/processos/temp/tlv.root.tmp
+ expr index :::::::::::::: . 
```

但是，这个文件实际上包含“wca”：

```
$ for item in `cat tlv.root.tmp`
> do
>  echo "${item}"
> done
wca 
```

这个文件的编码是

```
$ file tlv.root.tmp
tlv.root.tmp: ASCII text 
```

为什么它检索`::::::::::::::`而不是`wca`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T18:59:54.477

这些冒号字符看起来很可疑，就像在等待您的命令时提示**[more(1)给您的一样。](http://linux.die.net/man/1/more)**

像这样的程序`more`不打算编写脚本，也许您应该`cat`在两个脚本中使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T19:00:58.207

一个**更好的**方法可能是

```
while read -r item
do
  txtPos=`expr index "$item" "."`
done < "$dir_tmp/$lcl_ident_cnl.root.tmp" 
```

谢谢[`chepner`](https://stackoverflow.com/users/1126841)

# javascript - ko.toJSON 和 Computed observable 的问题

> ID：15300303
> 
> 赞同：0
> 
> 时间：2013-03-08T17:57:09.650
> 
> 标签：javascript, jquery, knockout.js

我对淘汰计算的 observable 和 toJSON 函数有疑问。我创建了一个[**Fiddle Example**](http://jsbin.com/eqejov/5/edit)。在这个例子中，我有一个模型：

```
function VM()
{
  this.Name = ko.observable("Tom");
  this.Age = ko.observable(23);

  //I want this computed evaluate only 
  //when name will change. So i put Name observable 
  //inside it.
  ko.computed(function(){
     this.Name();
    //send only after dom is initiallized
     if(initialized){   
        Server.Sync(this);
     }
  }, this).extend({ throttle: 500 });
}

function Server()
{
}

Server.Sync = function(data)
{
  alert("send");
  var jsonData = ko.toJSON(data); //This is the problamatic code which.. 
  //increases the computed dependency. After executing this code the..
  //computed function is now evaluates on Age also which i do not want.

  //send jsonData
}; 
```

在这个模型中，我希望我的计算值仅在用户更改 Name 可观察属性时进行。*在执行Server.Sync*函数之前，它的工作正常。在*Sync*函数中，我通过*toJSON*函数从 ViewModel 对象创建 JSON 对象，并且*此代码首先打开 observables，然后创建它的 Clean Js 对象，而不是通过 Stringify 它将创建 JSON*。现在我认为在展开可观察对象期间，我计算的可观察对象的年龄可观察依赖项会增加，现在它正在评估用户何时更改年龄属性。

如果我的解释是正确的，我该如何避免这种情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T21:15:28.373

问题是“这个”变量。您正在访问计算中的主视图模型。引用被传递，当它发生变化时，计算值现在重新评估。

你最好的选择是做这样的事情。

创建一个包含您要传递的数据并将其传递给同步的局部变量。

这是您的小提琴中更新的 JSBin。我从计算中删除了它，并使用局部变量来访问它。

[http://jsbin.com/eqejov/9/edit](http://jsbin.com/eqejov/9/edit)

```
function VM()
{
  var self = this;
  self.Name = ko.observable("Tom");
    self.Age = ko.observable(23);

var localValue = {
   Name: self.Name(),
   Age: self.Age()
};

    //I want this computed evaluate only 
    //when name will change. So i put Name observable 
    //inside it.
    ko.computed(function(){
       self.Name();
      //send only after dom is initiallized
       if(initialized){   
          Server.Sync(localVariable);
       }
    }).extend({ throttle: 500 });
  } 
```

# android - SLF4J.properties 使其在 android 中工作

> ID：15300305
> 
> 赞同：0
> 
> 时间：2013-03-08T17:57:24.247
> 
> 标签：android, slf4j

我在各种 java 项目中使用 SLF4J，效果很好。但是我在android上尝试它，我不能让它看到属性文件。

根据他们的指示，（[https://github.com/interdroid/slf4android](https://github.com/interdroid/slf4android)）我已将我的 SLF4J.properties 放在 src/org/slf4j 并设置：default.log.level=warn

我正在检查 \bin\classes\org\slf4j，我的文件在那里。但是我仍然收到我的调试日志消息。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T22:13:04.493

找到了。正在使用版本 slf4j-android-1.6.1-RC1.jar 并且显然它按照我从 github 编译的版本 1.6.2 中的描述工作。

# unix - Unix文件权限，警告：无法访问

> ID：15300309
> 
> 赞同：0
> 
> 时间：2013-03-08T17:57:51.403
> 
> 标签：unix, file-permissions

我正在尝试更改与我上传到我的网站的网页一起使用的一些文件的权限。我正在使用 Unix 命令行来执行此操作。

我试过两个命令：

```
chmod 755 index.html
chmod 644 index.html 
```

但我得到了消息

```
chmod: WARNING: can't access index.html 
```

出于某种原因使用这些命令后，我不知道为什么......最初我虽然可能是因为我在几个程序（文本编辑器和网络浏览器）中打开了文件，但我已经关闭了这些，我仍然遇到同样的问题......知道为什么，以及如何正确设置权限，以便网络上的任何人都可以查看该文件，但只能由我编辑？

干杯!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T18:49:54.060

这是一个看起来与您的问题相似的链接，但它在 Solaris 上：

[http://www.unix.com/solaris/45229-unable-chmod-file-directory.html](http://www.unix.com/solaris/45229-unable-chmod-file-directory.html)

解决方案在此线程的第 2 页，但解决方案的 Cliff 注释版本是人们发现在该目录中安装了其他东西。他们跑的时候就出现了

```
df -k /their_dir_location 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-31T19:30:32.373

另一个可能的问题是……如果您使用的是 solaris 区域 .. 目录在多个区域中可见，但只有一个区域具有写入能力。

# c# - 在 C# 中使用 LINQ .Select 时如何维护类型？

> ID：15300313
> 
> 赞同：1
> 
> 时间：2013-03-08T17:58:08.263
> 
> 标签：c#, linq

我正在尝试返回一组不同的结果，这些结果首先使用 Substring 进行修剪，但是当我调用“Select”时，它会将其转换为匿名类型。我似乎无法让它维持“列表”类型。我只需要返回 Select 方法中指定的字段。

```
public List<Facility> GetFacilities() {
    var facilities = new List<Facility>(); 
    facilities = _facilityRepository.GetAll().ToList();
    var facReturnList = 
        facilities.Where(x => x.Fac_Name = "Something")
                  .OrderBy(x => x.Fac_Name).ToList();

    var facReturnList2 = 
        facReturnList.Select(x => 
            new { ID = x.Fac_Name.Substring(0, 6), 
                  Fac_Name = x.Fac_Name.Substring(0, 3) })
            .Distinct().ToList();
    return facReturnList2;
} 
```

我尝试`List<Facility>`在之后添加`new`，但它说这些属性 (`ID`和`Fac_Name`) 没有在 Facility.xml 中定义。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T18:01:11.473

您正在获得匿名类型，因为您正在创建它。

```
.Select(x => new { 
```

如果你不想那样，就不要那样做。

如果现有类型已经具有您需要的名称和精确属性，请使用它。如果没有类型满足您的需求，请*创建一个。*然后您可以返回该类型的正确列表或枚举。

```
.Select(x => new YourDefinedType { 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-08T18:01:26.343

你想`Facility`用你的结果初始化新实例吗？

```
var facReturnList2 = facReturnList.Select(x => new Facility { ID =   // ...
                                                   ^ concrete type initializer 
```

**对编辑的响应**：在`Select`运算符内部，您需要指定要初始化的*元素的类型，而不是它们的列表。*您之前的代码似乎表明在`Fac_Name` *中*定义`Facility`，但显然不会在 中定义`List<Facility>`。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-08T18:05:23.830

听起来你真正想要的是一种`DistinctBy`方法。您想指定某种方式来表明一个对象是不同的，但您不希望结果是该选择的集合，您希望最终结果是起始对象。LINQ 没有`DistinctBy`内置的，但实现一个很容易：

```
public static IEnumerable<TSource> DistinctBy<TSource, TKey>(this IEnumerable<TSource> source,
    Func<TSource, TKey> keySelector, IEqualityComparer<TKey> comparer = null)
{
    comparer = comparer ?? EqualityComparer<TKey>.Default;
    HashSet<TKey> knownKeys = new HashSet<TKey>(comparer);
    foreach (TSource element in source)
    {
        if (knownKeys.Add(keySelector(element)))
        {
            yield return element;
        }
    }
} 
```

使用它，您的代码现在可以变成：

```
public List<Facility> GetFacilities()
{
    return _facilityRepository.GetAll()
        .Where(x => x.Fac_Name == "Something")
        .DistinctBy(x => new
        {
            ID = x.Fac_Name.Substring(0, 6),
            Fac_Name = x.Fac_Name.Substring(0, 3)
        })
        .OrderBy(x => x.Fac_Name)
        .ToList();
} 
```

如果您有一个`IQueryable`与内存数据集相反的数据集，您可以使用它`GroupBy`来获得相同的行为。在 Linq-to-objects 中，使用`GroupBy`效率会低很多，但对于查询提供程序来说，它不会因为数据库能够优化这一点。

```
public List<Facility> GetFacilities()
{
    return _facilityRepository.GetAll()
        .Where(x => x.Fac_Name == "Something")
        .OrderBy(x => x.Fac_Name)
        .GroupBy(x => new
        {
            ID = x.Fac_Name.Substring(0, 6),
            Fac_Name = x.Fac_Name.Substring(0, 3)
        })
        .Select(group => group.First())
        .ToList();
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-08T18:01:28.870

以下代码指示 linq 返回匿名类型：

```
.Select(x => new { ID = x.Fac_Name.Substring(0, 6), Fac_Name = x.Fac_Name.Substring(0, 3) } 
```

您需要为结果创建一个类

```
public class Result{
    public string ID { get;set; }
    public string Fac_Name { get; set; }
}

//Then do

.Select(x => new Result { ID = x.Fac_Name.Substring(0, 6), Fac_Name = x.Fac_Name.Substring(0, 3) } 
```

这确保您只返回您需要的信息

# django - 使用 _set.all 的 Django 模板

> ID：15300314
> 
> 赞同：5
> 
> 时间：2013-03-08T17:58:15.160
> 
> 标签：django, django-models, django-templates

我正在构建一个用于跟踪光纤电缆的 Django 应用程序。我遇到了我认为是相关管理器的问题，因为在某些模板中我可以让它做我想做的事情，但在其他模板中我不能。

我正在尝试做的一个工作示例：

```
<ul>
    {% for lanroom in building.lanroom_set.all %}
    <li><a href="/lanrooms/{{ lanroom.id }}/">{{ lanroom.lan_room_name }}</a></li>
    {% endfor %}
</ul> 
```

这样做的目的是为我提供一组 LAN 房间，这些房间将建筑物详细视为外键。

我想做的是将一根电缆连接到转接板连接器。因此该模板具有以下内容：

```
<li>Date Added: {{ adaptorplateconnector.date_added }}</li>
<li>Connector Type in {{ adaptorplateconnector }}:</li>
<ul>
    <li><a href="/connectortypes/{{ adaptorplateconnector.connector_type_id.id }}/">{{ adaptorplateconnector.connector_type_id.type }}</a></li>
</ul>
<li>Strand connected to  {{ adaptorplateconnector }}:
<ul>
    {% for strand in adaptorplateconnector.strand_set.all %}
    <ali><a href="/strands/{{ strand.id }}/">{{ strand }}</a></li>
    {% endfor %}
</ul> 
```

然而，我没有得到任何连接到转接板连接器的股线。以下是相关型号：

```
class AdaptorPlateConnector(models.Model):
    adaptor_plate_id = models.ForeignKey('AdaptorPlate')
    connector_type_id = models.ForeignKey('ConnectorType')
    strand_position = models.CharField(max_length=200)
    date_added = models.DateTimeField(auto_now_add=True)

    def __unicode__(self):
        return self.strand_position

class Strand(models.Model):
    cable_id = models.ForeignKey('Cable')
    end1_plate_connector_id = models.ForeignKey('AdaptorPlateConnector', related_name= 'end1_adaptor_plate_connector')
    end2_plate_connector_id = models.ForeignKey('AdaptorPlateConnector', related_name= 'end2_adaptor_plate_connector')
    in_use = models.CharField(max_length=200)
    desc = models.CharField(max_length=200)
    date_added = models.DateTimeField(auto_now_add=True)

    def __unicode__(self):
        return "End1: " + self.end1_plate_connector_id.__unicode__() + ", End2: " + self.end2_plate_connector_id.__unicode__() + ", Cable: " + self.cable_id.__unicode__() 
```

如何获取与正在查看的 AdaptorPlateConnector 相关的股线列表？任何见解将不胜感激。我正在使用通用视图，此模板用于 DetailView

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-08T18:43:02.660

您有两个关系 from `Strand`to `AdaptorPlateConnector`，因此您已经正确地使用`related_name`了反向关系的名称。这意味着您必须使用以下名称之一：

```
{% for strand in adaptorplateconnector.end1_adaptor_plate_connector.all %} 
```

或者

```
{% for strand in adaptorplateconnector.end2_adaptor_plate_connector.all %} 
```

请注意，您对 related_name 的实际选择有点奇怪：如此处所示，它是您用来引用`Strand`from的名称`AdaptorPlateConnector`。

（另外，与此无关，但请不要`_id`在名称中使用`ForeignKeys`：底层数据库字段是一个ID，但字段类本身是对实际相关模型实例的引用，而不是ID。）

# ubuntu - 当您在 Ubuntu 中开发 Web 应用程序时知道您使用的字体在 Windows 上看起来会有所不同，您的工作流程是怎样的？

> ID：15300315
> 
> 赞同：1
> 
> 时间：2013-03-08T17:58:20.540
> 
> 标签：ubuntu, fonts, ubuntu-12.04

我最近开始使用 Ubuntu 12.04，我发现它非常酷且易于用于 Web 开发，但是我遇到了字体问题！为什么它们在 Ubuntu 中看起来如此丑陋？

如果您在 Firefox Ubuntu 中查看一个网站，在 Firefox Windows 7 中查看一个网站，您会发现在 Windows 上每次看起来都更好。即使安装了 ttf-mscorefonts 也会看起来很难看。

我的问题是，当您在 Ubuntu 中开发 Web 应用程序时，知道您使用的字体在 Windows 上看起来会有所不同，您的工作流程如何。您是否使用 Windows 7 创建虚拟机以便在项目结束时测试字体？

非常感谢/Blue

# facebook-graph-api - 将公共 facebook 页面数据加载/显示到自己的网页中

> ID：15300316
> 
> 赞同：0
> 
> 时间：2013-03-08T17:58:20.773
> 
> 标签：facebook-graph-api, facebook-javascript-sdk

我正在尝试通过 facebook 的 javascript SDK 异步加载一些帖子。我正在页面底部加载 javascript 文件：

```
<html>
<head>.....</head>
<body>
 .....
 .....
 .....
 <div id="fb-root"></div>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
    <script type="text/javascript" src="/res/jquery.stp.js"  charset="utf-8"></script>
</body></html> 
```

在 jquery.stp.js 中，我按以下顺序加载这些东西： - javascript sdk - 一些 jquery-things - 函数 loadFBPosts() - fb.init()

文件：

```
var isLoaded = false;   
(function(d, debug){
   var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
   if (d.getElementById(id)) {return;}
   js = d.createElement('script'); js.id = id; js.async = true;
   js.src = "//connect.facebook.net/en_US/all" + (debug ? "/debug" : "") + ".js";
   ref.parentNode.insertBefore(js, ref);
}(document, /*debug*/ false));

$(function(){
    //some jquery event things
})

function loadFBPosts(fbPageId) {
        // Facebook call
        if(isLoaded) {      
                //do some things with the FB.api()
                //and catch errors...
            }else{
                //api not loaded...
            }
 }

window.fbAsyncInit = function() {
        // init the FB JS SDK
        FB.init({
          appId      : 'xxxxx', 
          channelUrl : '//lab.example.com/channel.php', 
          status     : true, 
          cookie     : true, 
          xfbml      : true  
        });

                isLoaded = true;
        laadFBPosts();  // here after FB.init is initialized call the function.
}; 
```

**问题**

现在奇怪的事情发生了。如果我运行此页面，则会弹出一个错误：“请求此资源需要访问令牌”，错误代码为 104。但是，如果我单击页面上的链接，`<a href='javascript:loadFBPosts()'>click</a>`则该函数将按应有的方式执行。

这怎么可能？我尝试使用 FB.api() 获取的资源来自公共 Facebook 页面。例如 FB.api('/218818688131271/posts?limit=5') 所以我不需要访问令牌。正确的？

如果我确实需要一个访问令牌：如果我不想用登录屏幕打扰每个访问者，我如何获得一个；因为它只是显示公共信息....

我唯一想做的就是显示我页面上的最后 5 个帖子和即将发生的事件。

# ruby - AMQP 多任务处理

> ID：15300317
> 
> 赞同：1
> 
> 时间：2013-03-08T17:58:26.220
> 
> 标签：ruby, rabbitmq, amqp, eventmachine

我有一个有趣的情况需要完成。我需要有一个 EventMachine 循环，它在 AMQP 队列中等待消息，然后中断该循环，以便定期将消息发送到单独的 AMQP 队列。我是 EventMachine 的新手，这就是我目前所拥有的，除了 EventMachine 循环没有发送必要的消息。

现在我做了两个过程：

```
 listen_loop = Proc.new {
        AMQP.start(connection_config) do |connection|
            AMQP::Channel.new(connection) do |channel|
                channel.queue("queue1", :exclusive => false, :durable => true) do |requests_queue|
                    requests_queue.once_declared do
                        consumer = AMQP::Consumer.new(channel, requests_queue).consume
                        consumer.on_delivery do |metadata, payload|
                            puts "[requests] Got a request #{metadata.message_id}. Sending a reply to #{metadata.reply_to}..."
                            response = "responding"
                            channel.default_exchange.publish(response,
                                :routing_key    => metadata.reply_to,
                                :correlation_id => metadata.message_id,
                                :mandatory      => true)
                            metadata.ack
                        end
                    end
                end
            end
        end
        Signal.trap("INT")  { AMQP.stop { EM.stop } }
        Signal.trap("TERM") { AMQP.stop { EM.stop } }
    }

    send_message = Proc.new {
        AMQP.start(connection_config) do |connection|
            channel = AMQP::Channel.new(connection)
            queue   = channel.queue('queue2')

            channel.default_exchange.publish("hello world", :routing_key => queue.name)
            EM.add_timer(0.5) do
                connection.close do
                    EM.stop{ exit }
                end
            end
        end
    } 
```

然后我有我的 EventMachine 循环：

```
 EM.run do 
        EM.add_periodic_timer(5) { send_message.call }
        listen_loop.call
    end 
```

我能够在监听循环中接收消息，但我无法定期发送任何消息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T19:28:06.003

弄清楚我做错了什么。消息循环无法打开到 RabbitMQ 服务器的新连接，因为它已经连接。将所有内容合并到一个 EventMachine 循环中并重用连接并且它可以工作。

对于那些好奇的人，它看起来像这样：

```
EM.run do

    AMQP.start(connection_config) do |connection|
        channel = AMQP::Channel.new(connection)

        EM.add_periodic_timer(5) { channel.default_exchange.publish("foo", :routing_key => 'queue2') }

        queue = channel.queue("queue1", :exclusive => false, :durable => true)
        channel.prefetch(1)
        queue.subscribe(:ack => true) do |metadata, payload|
            puts "[requests] Got a request #{metadata.message_id}. Sending a reply to #{metadata.reply_to}..."
            response = "bar"
            channel.default_exchange.publish(response,
                :routing_key    => metadata.reply_to,
                :correlation_id => metadata.message_id,
                :mandatory      => true)
            metadata.ack
        end
    end
    Signal.trap("INT")  { AMQP.stop { EM.stop } }
    Signal.trap("TERM") { AMQP.stop { EM.stop } }

end 
```

# asp.net - 在浏览器后退按钮单击时保留前一页字段值

> ID：15300318
> 
> 赞同：2
> 
> 时间：2013-03-08T17:58:31.773
> 
> 标签：asp.net

我的 Web 应用程序有两个网页 page 1 和 page2。我在第 1 页有一个继续按钮，可以导航到第 2 页。我在具有文本框、下拉列表和其他控件的 page1 中输入或选择一些信息。然后我单击继续按钮转到第 2 页。但是，当我单击浏览器后退按钮转到上一页 page1 时，我失去了 page1 中的所有 vlaues。我的问题是我怎样才能保留价值或信息而不会丢失它。先感谢您。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T18:01:05.997

一种方法是将这些值保留在会话中。
并在您在页面上时将其加载回来。

# jquery - jQuery 全局变量使用

> ID：15300319
> 
> 赞同：0
> 
> 时间：2013-03-08T17:58:36.773
> 
> 标签：jquery

我有这个代码：

```
var products = [];

$(document).ready(function($){  

    $.fn.load_products = function(){      
        $.getJSON('/restaurant/get_products',function(data){
            products = data[0];
            alert(products[0]['idProduct']);//this works fine           
        });
        // EDITED: alert was here, but was a mistake sorry
    }

    $.fn.draw_products = function(){
        alert(products[0]['idProduct']); //this doesn't work            
    }

    $(this).load_products();      
    $(this).draw_products();
} 
```

我在全局范围内声明了产品，但看起来它再次在 load_products 中重新定义。

当我执行此操作时，它说 products[0] 未定义。

编辑：一些额外的信息。警报执行后出现控制台错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T18:03:18.317

这是因为`draw_products`在 AJAX 调用`load_products`返回之前被调用。您将需要`draw_products`在 AJAX 调用中调用回调。

# jquery - 跳过 foreach 淘汰赛 js 数组中的项目？

> ID：15300322
> 
> 赞同：8
> 
> 时间：2013-03-08T17:58:39.717
> 
> 标签：jquery, knockout.js, foreach

我有这个关于淘汰赛 js 中的 foreach 和第一项的问题。我想跳过第一个并迭代下一个项目。

主要问题是我想做这样的事情：

```
<div data-bind="text: ItemsArray[0].someProperty"></div>
<div data-bind="foreach: ItemsArray"> <!-- here i must skip the first item -->
     <div data-bind="text: someProperty"></div>
</div> 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-03-08T18:12:10.900

我不认为 knockoutJS 提供了跳过 Array 中特定元素的功能，但是您可以使用一个小技巧。

如果只想跳过第一项，可以使用以下`$index`属性：

```
<div data-bind="text: ItemsArray[0].someProperty"></div>
<div data-bind="foreach: ItemsArray">
<!-- ko if: $index() != 0 -->
     <div data-bind="text: someProperty"></div>
 <!-- /ko -->
</div> 
```

# regex - Vim，用重音字符交换单词

> ID：15300325
> 
> 赞同：1
> 
> 时间：2013-03-08T17:58:46.267
> 
> 标签：regex, vim, non-ascii-characters

我正在尝试使用以下映射在 Vim 中交换单词：

```
" Swap current word with previous one (push word to the left)
nnoremap <silent> <A-h> "_yiw?\k\+\_W\+\%#<CR>:s/\(\%#\k\+\)\(\_W\+\)\(\k\+\)/\3\2\1/<CR><c-o><cl>:noh<CR>

" Swap current word with the next one (push word to the right)
nnoremap <silent> <A-l> "_yiw:s/\(\%#\k\+\)\(\_W\+\)\(\k\+\)/\3\2\1/<CR><c-o>/\k\+\_W\+<CR><c-l>:noh<CR> 
```

我的 vimrc 文件中也有以下内容

```
set isk=@,48-57,_,192-255,:,# 
```

上述映射适用于交换（推送单词），除非重音字符开始单词。由于我用西班牙语写的重音字符经常使用，所以我该如何更改正则表达式来解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T20:37:49.743

问题在于`\_W`“匹配非单词和换行符”原子。在 Vim 中，WORD 仅限于 ASCII 字符，因此您的重音字符在此处匹配并创建错误的边界。相反，您需要“非关键字和换行符”。由于`\K`不是的否定，我们必须使用“任何不是关键字的字符（和换行符）” *。*这些是生成的映射：`\k``\%(\k\@!\_.\)`

```
nnoremap <silent> <A-h> "_yiw?\k\+\%(\k\@!\_.\)\+\%#<CR>:s/\(\%#\k\+\)\(\%(\k\@!\_.\)\+\)\(\k\+\)/\3\2\1/<CR><c-o><c-l>:noh<CR>

nnoremap <silent> <A-l> "_yiw:s/\(\%#\k\+\)\(\%(\k\@!\_.\)\+\)\(\k\+\)/\3\2\1/<CR><c-o>/\k\+\%(\k\@!\_.\)\+<CR><c-l>:noh<CR> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T18:14:02.163

我通常更喜欢宏，假设我们有如下一行（是的，这没有任何意义，我只是用它来解释）：

无情的实验

现在在 vim 中，我将转到这一行的开头，然后按 q，然后按一个记录键（任何字母数字键）让我们说“l”。然后记录我的动作：

1.  按 'dW' 剪切单词，（大写 w 并假设单词以空格结尾）

2.  用 e 继续到词尾

3.  按'a'添加空格

4.  按 ''

5.  输入“p”进行粘贴。

我第一次知道它太麻烦了，但是一旦你保存了它，你可以通过'@l'在任何一对单词上调用它，'l'是我们上面的记录键。

# html - 将 CSS 样式的 div 宽度清除回无限宽度

> ID：15300329
> 
> 赞同：0
> 
> 时间：2013-03-08T17:59:07.143
> 
> 标签：html, css

我有一系列自动生成的 div，其中包含标签和数据信息。

IE

```
<div class="display-label">
    @Html.DisplayNameFor(model => model.BusinessPhone)
</div>
<div class="display-field">
    @Html.DisplayFor(model => model.BusinessPhone)
</div>
<div class="display-label">
    @Html.DisplayNameFor(model => model.Email)
</div>
<div class="display-field uri">
    @Html.DisplayFor(model => model.Email)
</div> 
```

CSS：

```
div.display-label{
display: inline-block;
float: left;
width: 9em;
}
div.display-field{
display: inline-block;
width: 10em;
min-height: 1em;
float: left;
} 
```

我想做的是让任何带有 uri 类的 div 删除任何先前设置的宽度，并让宽度像无样式的 div 一样浮动。我也想保留原始的“显示字段”类，因为它包含我希望所有字段保持一致的其他样式。

```
div.uri{
   width:**Clear**
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T18:02:18.633

任何给定元素的默认宽度通常是`auto`：

```
div.uri {
   width: auto;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T18:02:32.093

```
div.uri {
    width: auto;
} 
```

并确保在其他类样式之后声明此样式。

# highcharts - Highcharts：半实线和半虚线的折线图？

> ID：15300330
> 
> 赞同：15
> 
> 时间：2013-03-08T17:59:12.037
> 
> 标签：highcharts

我正在尝试在 highcharts 中显示时间序列折线图 - 中心左侧是历史数据，因此线需要是实心的。中心右侧是预测数据，因此需要点划线或虚线。这可能吗？

谢谢！

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2015-03-31T01:02:18.670

是的，您可以使用[zone](http://api.highcharts.com/highcharts#plotOptions.areasplinerange.zones)。区域允许您在同一系列数据中应用不同的样式，并且可以针对 x 轴和 y 轴应用。

## 例子

1.  [y轴值不同的颜色](http://jsfiddle.net/gh/get/jquery/1.7.2/highslide-software/highcharts.com/tree/master/samples/highcharts/series/color-zones-simple/)

```
$(function() {
  $('#container').highcharts({
    series: [{
      data: [-10, -5, 0, 5, 10, 15, 10, 10, 5, 0, -5],
      zones: [{
        value: 0,
        color: '#f7a35c',
        style: 'dotted',
      }, {
        value: 10,
        color: '#7cb5ec'
      }, {
        color: '#90ed7d'
      }, ]
    }]
  });
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script src="http://code.highcharts.com/highcharts.js"></script>

<div id="container" style="height: 400px"></div>
```

2.  [x 轴位置的不同破折号样式](http://jsfiddle.net/gh/get/jquery/1.7.2/highslide-software/highcharts.com/tree/master/samples/highcharts/series/color-zones-dashstyle-dot/)

```
$(function() {
  $('#container').highcharts({
    title: {
      text: 'Zone with dash style'
    },
    subtitle: {
      text: 'Dotted line typically signifies prognosis'
    },
    xAxis: {
      categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
    },
    series: [{
      data: [29.9, 71.5, 106.4, 129.2, 144.0, 176.0, 135.6, 148.5, 216.4, 194.1, 95.6, 54.4],
      zoneAxis: 'x',
      zones: [{
        value: 8
      }, {
        dashStyle: 'dot'
      }]
    }]
  });
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script src="http://code.highcharts.com/highcharts.js"></script>

<div id="container" style="height: 400px; max-width: 800px; margin: 0 auto"></div>
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-03-08T21:39:48.790

我不认为你可以在一个系列中有两种不同的线条样式，但你可以将系列分成两个，然后指定第二个系列的 x 坐标从第一个停止的地方开始。然后你可以设置`dashStyle`那条线的。

```
series: [{
            name: 'Tokyo',
            data: [7.0, 6.9, 9.5, 14.5, 18.2, 21.5]
        }, {
            name: 'New York',
            data: [{x: 5, y: 21.5}, {x: 6, y: 22.0}, {x: 7, y: 24.8}, {x: 8, y: 24.1}, {x: 9, y: 20.1}, {x:10, y: 14.1}, {x:11, y: 13}],
            dashStyle: 'dash'
        }] 
```

这是一个说明它的 JSFiddle：http: [//jsfiddle.net/mkremer90/zMZEV/1/](http://jsfiddle.net/mkremer90/zMZEV/1/)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-03-08T18:29:35.033

是的。这个有可能。很难描绘你的图表，但你可以拥有 2 个系列。一个是您的真实数据，另一个是预测/未来数据。要设置线条样式，请使用[`dashStyle`](http://api.highcharts.com/highcharts#plotOptions.line.dashStyle).

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-04-22T07:46:37.773

是的，一个折线图中的实线和虚线是可能的。我已经使用 java 程序实现了它来创建我的系列数据。

创建两个系列

```
series : [
                                        {
                                            name : 'Series 1',
                                            id : 'series1',
                                            data : mydashData,
                                            allowPointSelect : true,
                                            marker: {
                                                enabled: false
                                            }

                                        },
                                        {
                                            name : 'Series 2',
                                            data : myDotData,
                                            dashStyle : 'dot',
                                            id : 'series2',
                                            color : '#A81F40',
                                            allowPointSelect : true,
                                            marker: {
                                                enabled: false
                                            }

                                        }
} 
```

考虑这些点 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15

从 1 -5 它的虚线。从 5-10 它的虚线。从 10-15 又是它的虚线。根据需要考虑一些示例 X 轴值。

这是创建两个系列数据点的 java 逻辑：-

```
List dashList;
List dotList;

Initial = FirstPoint ;

LOOP
if Initial == Dash and LastParsedPoint = Dash 
 add to DashList corresponding to that X axis value

if Initial ==Dot and LastParsePoint = Dot
 add to DotList corresponding to that X axis value

if Initial == Dot and LastParsePoint =Dash
 add to DashList Y and X values
 add to DashList y =NULL and same X value
 add to DotList  y and X value.

if Initial =Dash and LastParsePoint =Dot
 add to DotList  Y and X values
 add to DotList  Y =NULL and same X value
 add to DashList  Y and X value.

LastParsePoint =Initial

END LOOP. 
```

将这两个列表作为 json 发送到 Jsp 或 HTMl 页面，并将其分配给两个系列的数据。

这是我创建的示例。请将此代码保存在 HTMl 文件中作为 Chart.html

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
<script type="text/javascript"
    src="http://code.jquery.com/jquery-1.9.0.min.js"></script> 
<script src="http://code.highcharts.com/highcharts.js"></script>
<script type="text/javascript">
    var colors = Highcharts.getOptions().colors;
    var pathname = window.location.pathname;
    //console.log(pathname);
    var containerName = 1;

    /*Creates a div element by passing index name and class*/
    function create_div_dynamic(i, id, className) {

        dv = document.createElement('div'); // create dynamically div tag
        dv.setAttribute('id', id + i); //give id to it
        dv.className = className; // set the style classname
        //set the inner styling of the div tag
        dv.style.margin = "0px auto";
        if (id == 'container') {
            //hr = document.createElement('hr');
            //br = document.createElement('br');//Break after Each Chart Container and Horizontal Rule.
            //document.body.appendChild(br);
            //document.body.appendChild(hr);
        }
        document.body.appendChild(dv);
    }

    /*Creates a span element by passing index name and class*/
    function create_span_dynamic(i, id, className) {

        dv = document.createElement('span'); // create dynamically div tag
        dv.setAttribute('id', id + i); //append id to to name
        dv.className = className; // set the style classname
        //set the inner styling of the span tag
        dv.style.margin = "0px auto";
        document.body.appendChild(dv);
    }

    /*Get URL Parameters*/
    function getUrlParameter(sParam)
    {
        var sPageURL = window.location.search.substring(1);
        var sURLVariables = sPageURL.split('&');
        for (var i = 0; i < sURLVariables.length; i++)
        {
            var sParameterName = sURLVariables[i].split('=');
            if (sParameterName[0] == sParam)
            {
                return sParameterName[1];
            }
        }
    }

    $(document).ready(function() {
        var json = getUrlParameter('json');
              $.ajax({
                    type: 'GET',
                    url: json,
                    dataType: 'jsonp',
                    jsonpCallback: 'jsonCallback',
                    async: false,
                    contentType: "application/json",
                    success: function (datas){
            //Each data table column/block index.
                var blockNumber = 0;
                //Each Row inside block index
                var rowNumber = 0;
                //Used to store previous charts row index for blank divs generation
                var prevRowNum=0;

                //Number of blank divs created .
                var oldC=0;

                //J : Chart Index
                for (j = 0; j < 2; j++) {
                    for ( var key in datas.root[j]) {
                        var solid = [];
                        var dot = [];

                        for (i = 0; i < datas.root[j][key][0].solid.length; i++) {
                            solid.push([parseInt(datas.root[j][key][0].solid[i].date),parseFloat(datas.root[j][key][0].solid[i].value)|| null ]);
                        }

                        for (i = 0; i < datas.root[j][key][0].dot.length; i++) {
                            dot.push([parseInt(datas.root[j][key][0].dot[i].date),parseFloat(datas.root[j][key][0].dot[i].value)|| null ]);
                        }
                        var chartBlock = '';

                        var k = j;

                        //Container Name
                        var renderCont = 'container'+ ++j;
                        create_div_dynamic(j,'container','image-capture-container');

                        //Creating Charts
                        this['chart_' + j] = new Highcharts.Chart(
                        {
                            chart : {
                                    renderTo : renderCont,
                                    type : 'line',
                                    zoomType : 'xy',
                                    borderWidth : 0,
                                    borderColor : '#ffffff',
                                    borderRadius : 0,
                                    width : 600,
                                    height : 400,

                                    plotShadow : false,
                                    alignTicks :true,
                                    plotBackgroundColor:'#C0C4C9',
                                    //margin: [15, 10, 40,60],
                                    style : {
                                            //position : 'relative',
                                            opacity : 100,
                                            textAlign : 'center'
                                            }
                                    },
                            xAxis : {
                                        useHTML : true,
                                        type : 'datetime',
                                        lineColor: '#ffffff',

                                        tickInterval:30 * 24 * 3600 * 1000,
                                        tickColor: '#000000',
                                        tickWidth: 1,
                                        tickLength: 5
                                    },
                            yAxis : {
                                        title : {
                                                useHTML :'true',
                                                align : 'high',
                                                offset:0,
                                                rotation: 0,
                                                y: 1,
                                                x:-4,
                                                },
                                            lineWidth : 1,
                                            gridLineWidth :2,
                                            minorGridLineWidth : 1,
                                            gridLineColor :'#FFFFFF',
                                            lineColor:'DarkGray',
                                            opposite : false,
                                            maxPadding: 0.2,
                                        labels : {
                                                align : 'right',
                                                x : -5
                                            }
                                    },
                            series : [
                                        {
                                            name : 'Solid Line',
                                            id : 'series1',
                                            data : solid,
                                            allowPointSelect : true,
                                            color : '#888888',
                                            marker: {
                                                enabled: false
                                            }

                                        },
                                        {
                                            name : 'Dashed',
                                            data : dot,
                                            dashStyle : 'dot',
                                            id : 'series2',
                                            color : '#666666',
                                            allowPointSelect : true,
                                            marker: {
                                                enabled: false
                                            }

                                        }
                                    ]
                        });
                        create_div_dynamic(j,'main','main');
                        var main = 'main'+ j;
                        var chartDiv = $('#'+renderCont).children(":first").attr('id');
                        //console.log(chartDiv);
                        create_div_dynamic(j,'title_div','title_div');
                        $('#' + main).append($('#'+ chartDiv));
                        $('#' + renderCont).append($('#'+ main));
                }
            } //End of Each Chart Loop
        }
    });
    });
</script>
</head>
<body id="mainBody">
</body>
</html> 
```

我在这里在 Jsfiddle 中发布示例 json： [https ://jsfiddle.net/t95r60fc/](https://jsfiddle.net/t95r60fc/ "json文件")

将此 json 保存为 json1.json 并将其保存在与 Chart.html 相同的目录中，并在浏览器中打开 html，如下所示：

[file:///C:/temp/Chart.html?json=C:/temp/json1.json?callback=jsonCallback](http://file:///C:/temp/Chart.html?json=C:/temp/json1.json?callback=jsonCallback)

最终输出将是这样的： [![在此处输入图像描述](../Images/421f779a588ce4e730d87704e3f75da0.png)](https://i.stack.imgur.com/hsEhW.jpg)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-06-07T08:17:36.833

```
var envelopBorder =[[-20, 63], [-20, 85], null, null,null,null,[19, 130], [35,150], [60,150],[65,148], [80,140],[80,100],[65,82],[55,70],[40,67],[20,63],[15,63],[-20,63]] ;

var dasshedBorder =[[-20, 85],[-20, 100],[1, 130],[19, 130]] ;

Highcharts.chart('container', {
    chart: {
        type: 'line'
    },
    title: {
        text: 'Operating Envelop'
    },
        xAxis: {
        title: {
            enabled: true,
            text: 'Evaporating Temperature (°F)'
        },

        gridLineWidth: 0,
        lineWidth:1,
        startOnTick: true,
        endOnTick: true,
        showLastLabel: true
    },
    yAxis: {
        title: {
            text: 'Temperature (°C)'
        }
    },
    plotOptions: {
        line: {
            dataLabels: {
                enabled: true
            },
            enableMouseTracking: false
        }
    },
    series: [{
        name: 'Normal',
        data: envelopBorder
    }, {
        name: 'Dash',
        data: dasshedBorder,
        dashStyle: 'dash'
    }]
}); 
```

结果 ：-

[jsfiddle.net/7c9929mg](http://jsfiddle.net/7c9929mg/)

# c++ - 指向模板类的指针转换

> ID：15300331
> 
> 赞同：0
> 
> 时间：2013-03-08T17:59:12.320
> 
> 标签：c++, templates, pointers

为了向界面用户隐藏实现细节并避免广泛使用模板化函数，我想到了以下概念：

// 数据.h

```
#ifndef DATA_H_
#define DATA_H_

#include <cstddef>

template <size_t N = 0>
class Data
{
   public:
      const size_t n;
      size_t values[N];
      Data<N>();
};

#endif // DATA_H_ 
```

// 数据.cpp

```
#include "data.h"

template <size_t N> Data<N>::Data()
:
   n(N),
   values()
{
   for ( size_t i = 0; i < n; ++i )
   {
      values[i] = i;
   }
}

template class Data<1u>;
template class Data<2u>; 
```

// 列表.h

```
#ifndef LIST_H_
#define LIST_H_

#include <cstddef>
#include <memory>

class List
{
   private:
      std::shared_ptr<void> data;
   public:
      List(const size_t);
      void printData() const;
};

#endif // LIST_H_ 
```

// 列表.cpp

```
#include "list.h"

#include <iostream>
#include <stdexcept>

#include "data.h"

List::List(const size_t n)
:
   data()
{
   switch ( n )
   {
      case 1u:
         data = std::static_pointer_cast<void>(std::make_shared<Data<1u>>());
         break;
      case 2u:
         data = std::static_pointer_cast<void>(std::make_shared<Data<2u>>());
         break;
      default:
         throw std::runtime_error("not instantiated..");
   }
}

void List::printData() const
{
   auto obj = std::static_pointer_cast<Data<>>(data);  // my question is about this
   std::cout << obj->n << ": ";
   for ( size_t i = 0; i < obj->n; ++i )
   {
      std::cout << obj->values[i] << " ";
   }
   std::cout << "\n";
} 
```

// main.cpp

```
#include "list.h"

int main()
{
    for ( size_t i = 1; i <= 2; ++i )
    {
       try
       {
          List list(i);
          list.printData();
       }
       catch ( ... )
       {
          return 1;
       }
    }
} 
```

我知道有些人可能认为这是可怕的设计。请不要在这里讨论这个，除非你有一个很好的选择。

我的问题是关于`auto obj = std::static_pointer_cast<Data<>>(data);`. `List::printData()`感觉有点不安全。是否**保证**使用了正确的实例化？`g++-4.6.3`不会对此代码发出警告，它会打印预期值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T18:13:16.943

是的。这是不安全的。任何时候你通过 a 施放`void*`你都会冒着 UB 的风险。编译器不会警告您，因为它不再具有执行此操作所需的类型信息。因此，您需要转换为正确的类型，而您没有这样做。

从技术上讲，您在这里造成了未定义的行为。但是，我敢打赌，它通常会起作用。这与您一直在 C 中必须做的一些胡说八道没有什么不同。

它起作用的原因是您的实例的二进制布局可能是相同的。首先是'n'，如果你正在做这个讨厌的技巧，你需要拥有它，然后是数组的开头。

如果您曾经在指针领域之外这样做，那么您将自己搞砸。

您的对象被正确删除的唯一原因是 shared_ptr 在创建时创建了一个默认删除器，因此它知道如何删除正确的类型。如果您尝试这样做，任何其他智能指针都会导致各种 BS。

编辑：

现在，一个更好的方法是放弃使用类型系统来调整数组的大小。你真的想要一个运行时分配的数组，使用运行时系统来创建它！无论如何，您都是在免费商店中创建它，因此您不会从像这样滥用类型系统中获得任何好处。如果您只是根据传递给列表构造函数的大小来分配数组，那么您可以拥有安全、可预测的标准行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T18:16:11.757

您所拥有的是在编译时解析的 static_cast 。所以你告诉编译器的是：

```
auto obj = std::static_pointer_cast<Data<>>(data); 
```

`static_pointer_cast`**`data`**要键入的变量**`std::shared_ptr<Data<>>`**。
默认情况下（正如您在模板原型中声明的那样）`Data<>`意味着`Data<0>`.

所以你总是会得到相同类型的`shared_pointer`.

您可以做的是制作一个接口，并在运行时获取大小。

```
class IData 
{
  virutal size_t GetDataSize() = 0;
}

template <size_t N = 0>
class Data : public IData
{
   public:
      const size_t n;
      size_t values[N];
      Data<N>();
      virtual size_t GetDataSize() override { return N; }
}; 
```

然后将列表保存到接口类型并使用`data->GetDataSize();`

此外，不要将模板实现放在 .cpp 文件中，需要看到它们的使用位置。

# html - 无需等待整个缓冲完成即可立即播放 HTML5 音频？

> ID：15300333
> 
> 赞同：7
> 
> 时间：2013-03-08T17:59:16.653
> 
> 标签：html, audio

我的连接速度非常快，歌曲实际开始播放大约需要 2-3 秒。这是一个相对平均的 128kbps MP3 大小 (3mb-4mb)。我已经设置了**preload="auto"**但这并没有多大帮助。有没有办法立即开始播放音频并继续缓冲它（有点像 YouTube 所做的）？

这是我目前正在研究的一个**[例子。](http://seniorproject.heroku.com)**它将在所有连接的客户端上同时播放音频。因此，如果您有 2 台以上的笔记本电脑，则可以尝试一下。在开始播放音频之前，必须连接所有计算机。（*双击歌曲开始播放*）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T08:49:38.363

在没有完全缓冲的情况下运行视频和音频称为平滑/自适应流。它可以在silverlight和flash等播放器中实现。

它实际上做的是创建文件块并让用户逐块播放文件。由于您正在下载块，因此不需要下载整个文件。

好吧，我没有给你完整的答案，因为我没有研究太多，但我给你它是如何工作的确切想法。

我有同样的问题，但使用 HTML5 视频。我通过使用平滑流媒体 Azure 克服了它。

这是相同的教程：[http ://www.wrapcode.com/featured/windows-azure-media-services-mp4-to-smooth-streaming/](http://www.wrapcode.com/featured/windows-azure-media-services-mp4-to-smooth-streaming/)

一旦我发现有用的东西，我会及时通知你:-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-17T13:43:02.937

如果您使用 preload=none，那么您在开始时没有缓冲区，但它会“即时”缓冲您的内容

我有一个 Icecast 服务器，它可以流式传输我的内容，当我使用暂停和播放时，它会缓冲我的内容，即使 preload=none 也是如此。

不要使用 preload=auto。开始需要一些时间。

# php - 内部服务器错误 500，phpmyadmin 已安装并正常工作

> ID：15300334
> 
> 赞同：0
> 
> 时间：2013-03-08T17:59:28.647
> 
> 标签：php, phpmyadmin, internal-server-error

我在大学运行的虚拟机上设置了服务器。我有 phpmyadmin 工作，我可以远程访问我的数据库。我还有一个包含 phpinfo() 的 test.php 脚本，它运行得非常愉快。

当我尝试运行我的任何其他脚本时，我得到一个内部服务器错误。我不知道出了什么问题，因为我完全复制了在本地计算机上工作的脚本。

有人知道我可以采取什么命令或步骤来隔离问题吗？

**编辑** 这是我要运行的脚本

```
<?php
error_reporting(E_ERROR | E_WARNING | E_PARSE | E_NOTICE);
include('db_config.php');
mysql_connect(DB_SERVER,DB_USER,DB_PASSWORD) or die(mysql_error())
$db = mysql_select_db(DB_DATABASE) or die(mysql_error()) or die(mysql_error())
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T22:22:39.383

正如特里在评论中指出的那样：

> 你不是用 ; 来终止你的行。你有一个重复或死（mysql_error（））

呸！

# dependency-injection - CDI 注入回路

> ID：15300338
> 
> 赞同：5
> 
> 时间：2013-03-08T17:59:46.873
> 
> 标签：dependency-injection, cdi, circular-dependency, jboss-weld

我在 JBoss 7.1.1 的 Weld 容器中遇到 CDI 注入问题

我有以下对象模型：

```
@Stateless
class ServiceEjb {
@Inject
A a;
}

class A {
@Inject
B b;
}

class B {
@Inject
A a;
} 
```

当尝试在我的无状态类中注入 A 或 B 时，注入循环并因 javax.enterprise.inject.CreationException 而崩溃。

我尝试了很多事情（范围界定，A 或 B 上的 @Singleton 但没有成功）。我不想破坏代码，这些注入是有道理的。

任何线索将不胜感激。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-08T18:52:31.493

[CDI 标准不要求循环依赖注入](http://docs.jboss.org/cdi/spec/1.0/html/injectionelresolution.html)，除非循环中至少有一个 bean 具有[正常范围](http://docs.jboss.org/cdi/spec/1.0/html/contexts.html#normalscope)。**最简单的解决方案是给 A 或 B 一个正常的范围。**如果你不能给任何一个正常的范围（从代码模型来看，看起来它们都有默认的`@Dependent`伪范围），你将不得不寻找其他解决方案。发布一个真实的代码示例可能会让我们帮助您提供特定的解决方案，但这里是一个开始：

*   A 和 B 可以合并到同一个类中吗？
*   是否可以从 A 和 B 中提取一个新类 C，从而使 A 和 B `@Inject`C 相互替代？

以下是一些 SO 链接，其中包含您可能会发现有用的其他解决方案：

[CDI MVP；避免循环依赖](https://stackoverflow.com/questions/11953740/mvp-with-cdi-avoiding-circular-dependency)

[https://stackoverflow.com/questions/14044538/how-to-avoid-cdi-circular-dependency](https://stackoverflow.com/questions/14044538/how-to-avoid-cdi-circular-dependency)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-06-23T14:01:17.677

我通过明确使用[javax.inject.Provider解决了这个问题。](http://docs.oracle.com/javaee/6/api/javax/inject/Provider.html)虽然我觉得这应该由 WELD 自动在引擎盖下完成，但这对我来说也不是这样。这对我有用并解决了我的相关问题。

```
class A {
    @Inject
    Provider<B> b; // access with b.get()
}

class B {
    @Inject
    Provider<A> a; // access with a.get()
} 
```

我还没有测试过它，但是使用一个 Provider 来打破循环就足够了，即你不需要在两个类中都使用它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-01-15T07:11:07.673

您应该注入 Instance<B> 而不是 B（和/或 Instance<A> 而不是 A）

# android - 活动图标后退按钮

> ID：15300340
> 
> 赞同：0
> 
> 时间：2013-03-08T17:59:48.037
> 
> 标签：android

我如何使活动中的图标显示为带箭头的后退按钮？我已经搜索但没有找到任何答案。

非常感谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T18:04:29.700

它在[ActionBar API](http://developer.android.com/reference/android/app/ActionBar.html) - [setDisplayHomeAsUpEnabled(boolean)](http://developer.android.com/reference/android/app/ActionBar.html#setDisplayHomeAsUpEnabled%28boolean%29)中。

```
getActionBar().setDisplayHomeAsUpEnabled(true); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T18:04:45.890

Per the [Pure Android](http://developer.android.com/design/patterns/pure-android.html) design guidelines:

> **Don't use labeled back buttons on action bars** Other platforms use an explicit back button with label to allow the user to navigate up the application's hierarchy. Instead, Android uses the main action bar's app icon for hierarchical navigation and the navigation bar's back button for temporal navigation. For more information, please review the Navigation pattern.
> 
> Follow this guideline to provide a consistent navigation experience across the platform.

However, you can use the 'Up' button on Android 3.0+ devices (or using [ActionBarSherlock](http://actionbarsherlock.com/), any Android 2.2+ device) per [training on implementing Ancestral Navigation](http://developer.android.com/training/implementing-navigation/ancestral.html)

```
@Override
public void onCreate(Bundle savedInstanceState) {
    ...
    getActionBar().setDisplayHomeAsUpEnabled(true);
    ...
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T18:26:42.867

如果您使用的是 Action Bar Sherlock，请使用此代码：`getSupportActionBar().setDisplayHomeAsUpEnabled(true);`
否则您可以使用`getActionBar().setDisplayHomeAsUpEnabled(true);`

# php - 从子域到查询字符串，htaccess 代码

> ID：15300343
> 
> 赞同：1
> 
> 时间：2013-03-08T17:59:55.703
> 
> 标签：php, .htaccess

如果我在浏览器中输入以下链接。

[http://sub.domain.com](http://sub.domain.com)然后它会打开 http:/domain.com/page.php?c=sub 并且在浏览器地址栏中访问者会看到[http://sub.domain.com](http://sub.domain.com)。

我知道可以通过重写 url 来完成。谁能告诉我htaccess代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T18:03:42.553

恰恰相反，它**不能通过**重写 url 来完成。
您需要设置

*   DNS 服务器（将所有子域定向到您的服务器）
*   和网络服务器（接受它们）。

然而，您不需要查询字符串**也不需要重写**，因为您总是可以轻松地从`HTTP_HOST`变量中获取您的域。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-11T05:59:17.237

我认为你应该分两步完成。

**第 1 步**：

如果您可以直接访问您的控制面板，您应该进入它并使用星号创建一个通用虚拟子域 *

完成此步骤后，您可以使用`sub.domain.com`. 如果您没有控制面板的王牌，请让管理员为您完成。

**第 2 步**：您应该使用以下行编辑 .htaccess 文件

**# 提取 domain.com 的子域部分**

```
RewriteCond %{HTTP_HOST} ^([^\.]+)\.domain\.com$ [NC] 
```

**# 检查子域部分不是www和ftp和mail**

```
RewriteCond %1 !^(www|ftp|mail)$ [NC] 
```

**# 将所有请求重定向到作为参数传递子域的 php 脚本**

```
RewriteRule ^.*$ http://www.domain.com/page.php?c=%1 [R,L] 
```

我希望这可以帮助你

# sqlalchemy - 如何使用关联对象和辅助连接构建反向引用？

> ID：15300344
> 
> 赞同：2
> 
> 时间：2013-03-08T17:59:56.047
> 
> 标签：sqlalchemy

我需要一些模型，例如：

*   工作 - 例如文学作品。
*   工人——例如作曲家、翻译或类似的人对工作有贡献。

因此，需要一个`'type'`字段来通过工作分工来区分工人。作为 SQLAlchemy 的文档，这种情况可以从**关联对象**中受益，如下所示：

```
class Work(base):
    id = Column(Integer, primary_key=True)
    name = Column(String(50))
    description = Column(Text)

class Worker(base):
    id = Column(Integer, primary_key=True)
    name = Column(String(50))
    description = Column(Text)

class Assignment(base):
    work_id = Column(Integer, Foreignkey('work.id'), primary_key=True)
    worker_id = Column(Integer, Foreignkey('worker.id'), primary_key=True)
    type = Column(SmallInteger, nullable=True) 
```

尽管如此，如何利用**backref**和**alternatvie join条件**立即建立关系，以实现每个`Work`对象可以通过不同的属性检索和修改对应`Worker`的（s）以进行区分。例如：

```
work = session.query(Work).get(1)
work.name
>>> 'A Dream of The Red Mansions'
work.composers
>>> [<Worker('Xueqin Cao')>]
work.translators
>>> [<Worker('Xianyi Yang')>, <Worker('Naidie Dai')>] 
```

反之亦然：

```
worker = session.query(Worker).get(1)
worker.name
>>> 'Xueqin Cao'
worker.composed
>>> [<Work('A Dream of The Red Mansions')>]
worker.translated
>>> [] 
```

直接添加`secondaryjoin`而不`secondary`指定似乎不可行，此外，SQLAlchemy 的文档指出：

> 使用关联对象模式时，建议不要将关联映射表用作其他地方的 relationship() 的辅助参数，除非该 relationship() 包含选项 viewonly=True。如果在相关属性和相关对象上检测到类似状态，SQLAlchemy 可能会尝试在同一个表上发出冗余的 INSERT 和 DELETE 语句。

那么，有什么方法可以优雅而轻松地建立这些关系吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T21:24:31.247

这里有三种一般的方法。

一种是，做一个“香草”设置，你有“工作”/“工人”设置而不区分“类型” - 然后，使用`relationship()`“作曲家”，“作曲家”，“翻译者”，“翻译”使用“次要”，`Assignment.__table__`以及自定义连接条件，以及`viewonly=True`. 因此，您只能通过 vanilla 属性进行写入。这里的一个缺点是“vanilla”和“specific”集合之间没有立即同步。

另一个是，与“vanilla”设置相同，但只使用普通的 Python 描述符在内存中给出“composer”、“composed”、“translator”、“translated”视图，即`[obj.worker for obj in self.workers if obj.type == 'composer']`. 这是最简单的方法。无论您放入“vanilla”集合中的什么内容都会直接显示在“filtered”集合中，SQL 很简单，并且使用的 SELECT 语句更少（每个 Worker/Work 一个，而不是每个 Worker/Work 的 N 个）。

最后，最接近您所要求的方法，主要连接和反向引用，但请注意关联对象，反向引用在 Work/Assignment 和 Assignment/Worker 之间，而不是直接在 Work/Worker 之间。这种方法可能最终会使用更多的 SQL 来获得结果，但它是最完整的，并且还具有自动编写“类型”的漂亮特性。我们还使用了“单向反向引用”，因为 Assignment 没有一种简单的向外关联的方法（有办法做到这一点，但会很乏味）。使用 Python 函数自动创建关系会减少样板文件，注意这里我使用字符串作为“类型”，如果您向系统添加更多参数，这可以是一个整数：

```
from sqlalchemy import *
from sqlalchemy.orm import *
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy.ext.associationproxy import association_proxy

Base = declarative_base()

def _work_assignment(name):
    assign_ = relationship("Assignment",
                    primaryjoin="and_(Assignment.work_id==Work.id, "
                                    "Assignment.type=='%s')" % name,
                    back_populates="work", cascade="all, delete-orphan")
    assoc = association_proxy("%s_assign" % name, "worker",
                    creator=lambda worker: Assignment(worker=worker, type=name))
    return assoc, assign_

def _worker_assignment(name):
    assign_ = relationship("Assignment",
                    primaryjoin="and_(Assignment.worker_id==Worker.id, "
                                    "Assignment.type=='%s')" % name,
                    back_populates="worker", cascade="all, delete-orphan")
    assoc = association_proxy("%s_assign" % name, "work",
                    creator=lambda work: Assignment(work=work, type=name))
    return assoc, assign_

class Work(Base):
    __tablename__ = 'work'
    id = Column(Integer, primary_key=True)
    name = Column(String(50))
    description = Column(Text)

    composers, composer_assign = _work_assignment("composer")
    translators, translator_assign = _work_assignment("translator")

class Worker(Base):
    __tablename__ = 'worker'
    id = Column(Integer, primary_key=True)
    name = Column(String(50))
    description = Column(Text)

    composed, composer_assign = _worker_assignment("composer")
    translated, translator_assign = _worker_assignment("translator")

class Assignment(Base):
    __tablename__ = 'assignment'
    work_id = Column(Integer, ForeignKey('work.id'), primary_key=True)
    worker_id = Column(Integer, ForeignKey('worker.id'), primary_key=True)
    type = Column(String, nullable=False)

    worker = relationship("Worker")
    work = relationship("Work")

e = create_engine("sqlite://", echo=True)
Base.metadata.create_all(e)

session = Session(e)

ww1, ww2, ww3 = Worker(name='Xueqin Cao'), Worker(name='Xianyi Yang'), Worker(name='Naidie Dai')

w1 = Work(name='A Dream of The Red Mansions')
w1.composers.append(ww1)
w1.translators.extend([ww2, ww3])

session.add(w1)
session.commit()

work = session.query(Work).get(1)
assert work.name == 'A Dream of The Red Mansions'
assert work.composers == [ww1]
assert work.translators == [ww2, ww3]

worker = session.query(Worker).get(ww1.id)
assert worker.name == 'Xueqin Cao'
assert worker.composed == [work]
assert worker.translated == []

worker.composed[:] = []

# either do this...
session.expire(work, ['composer_assign'])

# or this....basically need composer_assign to reload
# session.commit()

assert work.composers == [] 
```

# c++-cli - 为什么 C++ CLI 强制类在构造函数方法中有变量？

> ID：15300349
> 
> 赞同：1
> 
> 时间：2013-03-08T18:00:07.607
> 
> 标签：c++-cli

```
public ref class masterWeapon{

public :
    property int Slot {
        int get(){
            return 0;
        }
    }
    masterWeapon(){ 
    }
};

OSamp::masterWeapon mw();
int v = mw.Slot; //ERROR error C2228: left of '.Slot' must have class/struct/union 
```

但是以下代码运行良好：

```
public ref class masterWeapon{

public :
    property int Slot {
        int get(){
            return 0;
        }
    }
    masterWeapon(int useless){  
    }
};

OSamp::masterWeapon mw(231312);
int v = mw.Slot; //works fine 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-08T18:02:01.673

> 为什么 C++ CLI 强制类在构造函数方法中有变量？

它没有，你只是在你的代码中有一个错误。

```
OSamp::masterWeapon mw(); 
```

错误信息有点误导；正是上面的行导致了问题。编译器告诉您这`mw`不是对象的实例。`mw`被解释为不带参数并返回`OSamp::masterWeapon`.

该行应重写为：

```
OSamp::masterWeapon mw; 
```

# azure - Azure 虚拟机中的专用端口

> ID：15300356
> 
> 赞同：6
> 
> 时间：2013-03-08T18:00:33.580
> 
> 标签：azure, port, azure-virtual-machine

Azure 虚拟机中的专用端口是什么概念？它的主要优势或用例是什么。在某些情况下，我检查了 RDP 端点的公共端口是 3389，而私有端口占用了一些随机端口号。

为了通过 RD 访问 VM，我也被迫打开该私有端口来访问它。在我见过的几个地方，私有端口和公共端口都设置为 80 来访问 HTTP 端点？

这背后的理论是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-08T21:24:38.503

Windows Azure 将所有虚拟机置于负载平衡器后面。您的所有虚拟机都可以打开出站连接。对于*入站*连接，您需要在防火墙中显式打开端口。这些是*输入端点*和*实例输入端点*：

*   当您要跨虚拟机（例如 Web 服务器）对流量进行负载平衡时，将使用输入端点
*   实例输入端点将允许您直接连接到特定虚拟机（例如数据库服务器）

现在，关于公共和私有端口：公共端口是暴露给外界的端口号。所以对于一个网站，可能是端口 80。然后您可以将该端口映射到虚拟机本身的端口。也许您出于某种原因在端口 8000 上运行您的 Web 服务器。在这种情况下，您可以将公共端口 80 映射到私有端口 8000。

现在想象一下 SSH。SSH 喜欢监听 22 端口。但如果你在一个服务中有 3 个 Linux 虚拟机，那么根本无法在 22 端口上访问*所有*这些虚拟机，因为它们都共享一个 IP 地址。因此，您需要为每台机器指定一个特定的端口号。*在这种情况下，您可以在公共端口*侧将端口 20000 分配给 vm1，将 21000 分配给 vm2 等，作为实例输入端点，指向*专用端口*侧端口 22 上的*特定虚拟机实例。*

 *希望这是有道理的...... :)*

# javascript - 如何更改页面上所有 img src 的一部分？

> ID：15300357
> 
> 赞同：0
> 
> 时间：2013-03-08T18:00:33.770
> 
> 标签：javascript, jquery

我正在寻找的是如何使用 java 脚本更改页面上的所有 img src。

如果说：

```
<img src="myimg1-small.png"></img>
<img src="myimg2-small.gif"></img>
<img src="myimg3-small.jpg"></img>
....... 
```

我只想将“-small”更改为“-large”并保留第一部分和扩展名。

如果有人可以帮助我，那将非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T18:02:47.787

这是 JQuery 代码。

```
$('img').each(function(){
    $(this).attr('src',$(this).attr('src').replace(/-small\./g,'-large'));
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T18:05:12.747

```
$('img').each(function(){
    $(this).attr('src', $(this).attr('src').replace('-small','-large'));
}); 
```

Edit: I notice several of us answered essentially the same within a minute or so of each other. But, a couple of notes:

(1) Don't use a regular expression when a simple string match will do the job more efficiently.

(2) I included the hyphen (-) in my match so as not to accidentally confuse it with an image name that has the string 'small' without the hyphen. After all, if the image is of a small flower, for example, and the image name is 'smallflower-small.jpg', the match that doesn't use the hyphen breaks.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-08T18:04:15.540

```
$('img[src^="myimg1-small"]').attr('src', function() {
    return this.src.replace('small', 'large');
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-08T18:03:46.873

如果你想要常规的 js：

```
var imgs = document.getElementsByTagName('img');
for (var i = 0; i < imgs.length; i++) {
    imgs[i].src = imgs[i].src.replace('small','large');
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-08T18:04:26.533

使用 jQuery，您可以：

```
$(document).ready(function (){
    $('img').each(function (){
        $(this).attr('src', $(this).attr('src').replace('small', 'medium'))
    })
}); 
```

[这是小提琴](http://jsfiddle.net/KgXLY/)

# sql - SQL 处理空值

> ID：15300359
> 
> 赞同：-4
> 
> 时间：2013-03-08T18:00:51.897
> 
> 标签：sql, null

问题是我有 3 个条件好坏丑。我的目标是，如果以下条件之一为 null，则将 null 替换为 0，否则如果所有条件均为 null，则将其显示为 null

```
case when 'Good' is not  null or 'Bad' is not null or 'Ugly' is not null 
     then coalesce(value,0) 
     else value
end result 
```

这里的问题是即使条件将所有空值都变为 0，这不是我想要的。提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T19:36:57.207

我想也许你想要这样的东西。如果我得到更多细节，我会更新。

如果我只是离开这个评论

> 问题是，如果同一产品的好是空，坏和丑陋的值是 0-100，那么我希望将空值替换为 0。如果对于同一个产品，这三个都是空值，那么我希望它们为空值并且不为 0

我会给你这样的东西

```
case
    when good is not null then good 
    when good is null and coalesce(bad,-1) between (0 and 100) and coalesce( ugly,-1) between (0 and 100) then 0
    else null
end 
```

如果您尝试提供所有 3 列（我假设您有多个列），您可能会执行类似的操作。

```
select 
    case 
        when good is null and bad is null and ugly is null then null
        when good is null and (bad is not null or ugly is not null) then 0
        else good
    end as 'good column values'
    ,
    case 
        when good is null and bad is null and ugly is null then null
        when bad is null and (good is not null or ugly is not null) then 0
        else bad
    end as 'bad column values'      
    ,
    case 
        when good is null and bad is null and ugly is null then null
        when ugly is null and (good is not null or bad is not null) then 0
        else ugly
    end as 'ugly column values' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T18:22:03.770

您当前的表达式说（在伪代码中）：

```
IF <something is true> 
   IF value IS NULL
      RETURN 0
    ELSE 
      RETURN value
   ENDIF
ELSE
   RETURN value
ENDIF 
```

那是你想要的吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T18:04:45.607

Your code says "if one of good, bad, or ugly is not null" but your question says "if one of good, bad, or ugly is null"

If I'm understanding you correctly, just take out the nots.

Edit: I'm also assuming that you don't actually mean to use the literal strings "Good", "Bad" and "Ugly", but that they are meant to represent column names or something.

You should be aware that using these strings means that your code will never enter the "else" condition, as "Good", "Bad" and "Ugly" are not null.

EDIT 2: take your column names (good, bad, ugly) out of quotes so they will actually be evaluated. This is why you're still seeing that error.

# qt - 自动控制 Skype Linux UI 应用程序

> ID：15300369
> 
> 赞同：2
> 
> 时间：2013-03-08T18:01:32.317
> 
> 标签：qt, x11, skype, user-interaction, xvfb

我是 Sevabot 项目[http://sevabot-skype-bot.readthedocs.org/](http://sevabot-skype-bot.readthedocs.org/)的作者- 一个适用于 Linux 的 Skype 机器人。

由于服务器安装很痛苦（[https://sevabot-skype-bot.readthedocs.org/en/latest/ubuntu.html](https://sevabot-skype-bot.readthedocs.org/en/latest/ubuntu.html)），我想弄清楚如何让用户更轻松地通过云使用机器人部署......我们可以询问 Skype 用户名、密码和一些云服务凭据，并自动将机器人部署到虚拟机提供商（如 Amazon EC2）上的客户。我们希望以这样一种方式使部署成为可能，即无需运行 VNC 即可连接您的 Xvfb 以在第一次进入 Skype 登录。

一项挑战是自动化 Skype Linux UI 输入（用户名、密码）。Skype 似乎不是从命令行以自动方式输入用户凭据的选项。据我所知，用户界面是基于 Qt 的，您需要某种机器人来选择小部件并模拟按键和鼠标。

我想知道有哪些选项可用于控制黑盒 Linux UI 应用程序并为它们自动执行操作？

# c# - C# 中 MSpaint 图像的图像步幅为 +1 字节，为什么？

> ID：15300371
> 
> 赞同：3
> 
> 时间：2013-03-08T18:01:40.553
> 
> 标签：c#, image, bitmap, byte, stride

我对 C# 中一些基于像素的操作有疑问。我编写了一个类，用作围绕[Bitmap](http://msdn.microsoft.com/en-us/library/4e7y164x.aspx)的图像外壳。`Bitmap.GetRGB(x,y)`通过使用[BitmapData](http://msdn.microsoft.com/en-us/library/system.drawing.bitmap.aspx)和[LockBits](http://msdn.microsoft.com/en-us/library/system.drawing.bitmap.lockbits.aspx)直接访问图像数组并从那里读取字节，它可以比颜色对象更快地为您提供图像中某个 (x,y) 位置的像素的 RGB 值。`0x00RRGGBB`我添加了这个函数以在 (x,y) 像素的掩码中获取 RGB 。

```
public unsafe int getPixel(int x, int y)
    {
        byte* imgPointer = (byte*)bmpData.Scan0;
        int pixelPos = 0;
        if (y > 0) pixelPos += (y * bmpData.Stride);
        pixelPos += x * (hasAlpha ? 4 : 3);            

        int blue = *(imgPointer + pixelPos);
        int green = *(imgPointer + pixelPos + 1);
        int red = *(imgPointer + pixelPos + 2);

        int rgb = red << 16;
        rgb += green << 8;
        rgb += blue;

        return rgb;
    } 
```

除了我使用 MSPaint 生成的任何图像外，这对我迄今为止使用过的所有图像都完美无缺。例如，我用包含 5 种黄色阴影的颜料制作了一张 5x1 的图像。但是，当我将此图像加载到我的程序中时，图像步幅为 16！我怀疑它是 15（每个像素 3 个字节，5 个像素），但由于某种原因，在前三个字节（第一个像素）之后有一个额外的字节，然后其余的像素跟随在数组中。

我只为 MSpaint 保存的图像找到了这个，我希望有人能解释一下那个额外的字节是什么以及如何检测那个额外的字节。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T18:16:20.313

来自[MSDN](http://msdn.microsoft.com/en-us/library/system.drawing.imaging.bitmapdata.stride.aspx)：

`The stride is the width of a single row of pixels (a scan line), rounded up to a four-byte boundary. If the stride is positive, the bitmap is top-down. If the stride is negative, the bitmap is bottom-up.`

因此，步幅始终是 4 的倍数，对于您的 3x5，将四舍五入为 16。

# java - Java：切片数组结束

> ID：15300376
> 
> 赞同：16
> 
> 时间：2013-03-08T18:01:55.800
> 
> 标签：java

我有一个至少包含三个元素的字符串数组。我想将第三个和所有后续元素复制到一个新数组中。如何最有效地实现这一目标？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-03-08T18:05:01.843

```
String[] arr = {"One", "Two", "Three", "Four", "Five"};

String[] arr2 = Arrays.copyOfRange(arr, 2, arr.length); 
//Note third param is exclusive 
```

# common-lisp - Common Lisp - 列表中的列表

> ID：15300380
> 
> 赞同：-1
> 
> 时间：2013-03-08T18:02:12.153
> 
> 标签：common-lisp

我正在尝试创建一个函数，它应该给我一个城市列表：

```
((London United-Kingdom)
(Paris France)
(New-York USA)
(Sydney Australia)) 
```

我的代码不起作用，出了点问题，但我不知道为什么。这是我的代码：

```
(defun make-city (name country)
  (list name country))

(defun cities
       (list (make-city 'London 'United-Kingdom)
             (make-city 'Paris 'France)
             (make-city 'New-York 'USA)
             (make-city 'Sydney 'Australia))) 
```

有谁知道问题出在哪里？它必须在（defun city....），但在哪里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T19:00:29.243

使用[`defvar`](http://www.lispworks.com/documentation/HyperSpec/Body/m_defpar.htm)("define variable") 而不是[`defun`](http://www.lispworks.com/documentation/HyperSpec/Body/m_defun.htm)("define function") for `cities`.

[Common Lisp 是“lisp-2”，scheme 是“lisp-1”。](https://stackoverflow.com/questions/4578574/what-is-the-difference-between-lisp-1-and-lisp-2)

# windows-phone-7 - Windows Phone 7 可以显示来电显示？

> ID：15300381
> 
> 赞同：0
> 
> 时间：2013-03-08T18:02:15.840
> 
> 标签：windows-phone-7

我想做一个联系人管理器，因为我觉得 Windows 7 Phone 有点欠缺。我不得不考虑一个潜在的问题。

现在，如果有人打电话给我，我把他们放在我的联系人列表中，他们的名字就会出现，我会知道他们是谁。

我想知道我是否可以连接来电显示以查看我的联系人列表以及电话中是否存在电话号码。

有谁知道这是否可能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T18:47:46.740

这在 Windows Phone 7.x 和 Windows Phone 8 中都是不可能的。您不能编写服务应用程序，即留在后台并监视某些系统事件的应用程序，也不能替换内置应用程序或响应。

遗憾的是，目前这是一个很大的限制，我希望它会在下一个版本的操作系统中被推翻。

# ruby - 将 Ruby 中方法的引用传递给另一个方法

> ID：15300398
> 
> 赞同：0
> 
> 时间：2013-03-08T18:03:22.157
> 
> 标签：ruby, methods, reference

我有一个循环/遍历某些东西的函数，我希望它接收对设置停止条件/做某事的函数的引用。例如，在一个类中：

```
def a(func_stop,i)
   ret = nil # default
   while(i < 0 ) 
      if (func_stop(@lines[i]))
        ret = i
        break
      end
   end
   return ret
end 
```

这个想法是我可以传递对函数的引用，有点像 PERL'S

```
func1(\&func, $i); 
```

我看过，但没有找到这样的东西。谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-08T18:06:17.510

Normally it is done with blocks.

```
def a(max, &func_stop)
  puts "Processing #{max} elements"
  max.times.each do |x|
    if func_stop.call(x)
      puts "Stopping"
      break
    else
      puts "Current element: #{x}"
    end
  end
end 
```

Then

```
a(10) do |x|
  x > 5
end
# >> Processing 10 elements
# >> Current element: 0
# >> Current element: 1
# >> Current element: 2
# >> Current element: 3
# >> Current element: 4
# >> Current element: 5
# >> Stopping 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T18:14:36.357

你也可以试试这个：

```
def a(func_stop,i)
   ret = nil # default
   while(i < 0 ) 
      if (func_stop.call(@lines[i]))
        ret = i
        break
      end
   end
   return ret
end

a(method(:your_function), i) 
```

# jquery - 带有慢速ajax的jquery点击功能

> ID：15300399
> 
> 赞同：2
> 
> 时间：2013-03-08T18:03:22.873
> 
> 标签：jquery, ajax, asynchronous, callback, out-of-band

我有一个绑定到单选按钮列表的单击处理程序。

当有人点击这些按钮中的任何一个时，就会执行一个 ajax 请求，该请求会发送到服务器，并返回一些数据，这些数据会被注入到页面中。

```
 $('ul#tag_picker').find('input').click(function(e){
    var type = ($(this).attr('type') == 'radio') ? 'radio' : 'checkbox';
    if($('ul#tag_picker input[type="radio"]:checked').length < 1 && type === 'checkbox'){   
        e.preventDefault();
        return false;
    }
    var value = $(this).val();
    var word = $(this).siblings('label').text();
    tag = {};
    tag.tag_id = value;
    tag.tag_word = word;
    tag.jumper = di.tags.jumpers[0];
    //tag.privilege = ui.item.privilege;
    args = {};
    args['jumper']  = di.tags.jumpers[0];
    args['name'] = 'selected_tags[]';
    //args['class'] = 'tag genre_tag';
    tag.privilege = 'genre';

    if (type === 'radio'){
        args['main_tag'] = true;
    }
    else if ( $(this).siblings('input[type="radio"]:first').is(':checked') ){
        $(this).attr('checked','checked');
        return false;                                   
    }
    action = ($(this).is(':checked')) ? 'add' : 'remove';
    user_select_tag(tag, action, args);  // <<< This is the ajax request.       
}) 
```

此 ajax 请求可能需要一些时间（2-3 秒）才能完成。

在请求期间，单选按钮保持在“按下”状态。一旦从远程服务器返回数据，页面就会更新，并且按钮显示为选中状态。

我想让按钮显示为选中状态，并“带外”执行 ajax 请求。

我一直在想我应该使用“延迟”方法或回调，但我不确定如何做到这一点。

关于如何使请求更“带外”发生的任何建议都会很棒！我将 jquery ajax 选项“异步”设置为 true。

编辑在此处添加 ajax 请求：

```
function user_select_tag(tag, operation, overrides) {
var args = [];
args['tag_box'] = 'ul#user_selected_tags';
if ($(args['tag_box']).length < 1 && $('ul#selected_tags').length > 0){
    args['tag_box'] = 'ul#selected_tags';
}
args['name'] = '';
args['class'] = 'tag';
args['jumper'] = false;
args['main_tag'] = false;
args['getSuggestedTags'] = 1;
if(typeof di.tags.max_tags !== 'undefined'){
    args['max_tags'] = parseInt(di.tags.max_tags);
}
else{
    args['max_tags'] = 5;   
}
args['privilege'] = false;
var main_tag_attr = '';
var main_tag_class = '';
var append = 'append';
var tag_privilege = '';
var tag_picker = false
if ($('ul#tag_picker').length>0){
    tag_picker=$('ul#tag_picker');    
}
if (typeof(overrides) === 'object') {
    $.each(overrides,
    function(index, value) {
        if ($.inArray(index, args)) {
            args[index] = value;
        }
    });
}
if (args['jumper'] === false && operation === 'select') {
    log('This jumper was called without a jumper, is cold, and will now exit.');
    return false;
}
var j_id = tag.jumper.id;
var jumper = di.tags.jumpers[j_id];
var tag_box = $(args['tag_box']);
var tag_array = jumper.pre_selected_tags;
var tag_ref = 'ust_' + j_id + '_' + tag.tag_id;
if (operation == 'add') {
    if ($.inArray(tag.tag_id, tag_array) != -1 && args['main_tag'] == false) {
        log('The tag was already selected, so I\'m returning.');
        return false;
    }
    if (tag_array.length + 1 > args['max_tags'] && args['main_tag'] == false && !admin()) {
        alert(args['max_tags'] + ' tags are already selected. Please remove a tag if you would like to replace it with this one.');
        return false;
    }
    if (args['main_tag'] !== false) {
        console.log('main tag was not false ',args,'jumper id is: ',j_id);
        var append = 'prepend';
        $('.main_tag[data-jumper_id="' + j_id + '"]').each(function() {
            var removetag = {};
            removetag.tag_id = $(this).attr('data-tag_id');
            removetag.tag_word = $(this).text();
            removetag.jumper = di.tags.jumpers[j_id];
            var rtargs = {};
            rtargs['jumper'] = di.tags.jumpers[j_id];
            rtargs['getSuggestedTags'] = 0;
            //rtargs['main_tag']  = true;
            console.log('removing ',$(this),' tag',rtargs);
            user_select_tag(removetag, 'remove', rtargs);
            if(admin()){
                removetag['privilege'] = 'genre';
                user_select_tag(removetag, 'add', rtargs);
            }
        });
        //user_select_tag(tag,'remove');
        $('.' + tag_ref).remove();
        main_tag_attr = 'data-main_tag="true"';
        main_tag_class = 'main_tag';
    }
    tag_array.push(tag.tag_id);
    if (typeof  tag.privilege != 'undefined') {
        args['class'] += ' ' + tag.privilege + '_tag';
        tag_privilege = 'data-tag_privilege="' + tag.privilege + '"';
    }
    tag_box[append]('<li id="' + tag_ref + '" name="' + args['name'] + '" class="' + args['class'] + ' ' + main_tag_class + ' ' + tag_ref + '" data-tag_id="' + tag.tag_id + '" data-jumper_id="' + j_id + '"' + main_tag_attr + ' ' + tag_privilege + '><span class="tag_word">' + tag.tag_word + ' </span><img id="x_ust_' + tag.tag_id + '" class="x_ust" src="http://www.dailyinfo.co.uk/dimages/remove_tag.gif" alt="Remove this tag"></li>');
    if (tag_picker){
        tag_picker.find('input[type="checkbox"][value="'+tag.tag_id+'"]').attr('checked','checked');
    }
    var hidden_input = '<input type="hidden" name="' + args['name'] + '" class="' + tag_ref + '" value="' + tag.tag_id + '" />';
    if (jumper.form.length > 0) {
        $(hidden_input).appendTo(jumper.form);
    } else {
        $(hidden_input).appendTo(tag_box);
    }
    if (args['getSuggestedTags'] == 1){
        console.log('getting suggested tags',args)
        getSuggestedTags();   
    }
    else{
        console.log('not getting suggested tags',args)
    }
} else {
    // operation assumed to be remove
    $('.' + tag_ref).remove();
    if (tag_picker){
        tag_picker.find('input[type="checkbox"][value="'+tag.tag_id+'"]').attr('checked','');           
    }
    if (tag_array.length > 0) {

        }
    tag_array.splice($.inArray(tag.tag_id, tag_array), 1);
}
// copy the contents of the tag_box into the tag section of the live event preview
var tag_html = $(args['tag_box']).html();  
if (tag_html.length < 1) {
    tag_html = 'not tagged yet';
}
$('p.event_live_preview[data-handle="tags"]').html(tag_html);
return true; 
```

}

```
function getSuggestedTags(overrides) {
var args = {};
args['jumper_id'] = 0;
if (typeof(overrides) === 'object') {
    $.each(overrides,
    function(index, value) {
        if ($.inArray(index, args)) {
            args[index] = value;
        }
    });
}
var json = {};
json.action = 'getSuggestedTags';
json.arguments = {};
var options = {};
options['chosen_tags'] = di.tags.jumpers[args['jumper_id']].pre_selected_tags;
options['return'] = 'id_key_word';
options['aliases'] = true;
options['related'] = true;
options['text'] = '';
options['location'] = null;
var det_names = ['name', 'description'];
var det_arr = [];
$('.evt_text').each(function() {
    var v = $(this).val();
    if (v.length > 0) {
        det_arr.push(v);
    }
});
if (typeof di.event.defaults.free === 'boolean' && di.event.defaults.free){
    det_arr.push($('input#di_cal_event_times_prices_window_prices').val());
}
if (det_arr.length > 0) {
    options['text'] = det_arr.join(' ');
}
var hid = $('input#hidden_venue_id');
var cv = $('input#custom_venue');
if (hid.length > 0 && cv.length > 0) {
    if (hid.val().length > 0 && cv.val().length < 1) {
        options['location'] = hid.val();
    }
}
json.arguments = options;
var a = ajax_request({
    url: '/ajax/get_suggested_tags.php',
    async: false,
    dataType: 'html',
    data: {
        json: JSON.stringify(json)
    },
    success: function(data) {
        if (data.length > 0) {
            $('ul#suggested_tags').replaceWith(data);
        }
    },
    type: 'GET'
}); 
```

}

ajax_request 是一个包装器：

```
function ajax_request(override_options){
var options={
    "async":true,
    "cache":false,
    //"data":{Xaction and Xquery/Xcode},
    "dataType":"json",
    "error":errorCallback,
    "success":function (data,textStatus){
        //alert("A specific success callback was not specified!\n"+data+"\n"+textStatus)
    },
    "timeout":9000,
    "type":"POST"
}
var option_name
for(option_name in override_options){
    options[option_name]=override_options[option_name]
}
return jQuery.ajax(options) 
```

}

帕特里克

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T18:15:02.570

在您的点击中，对您的按钮执行一些操作。我设置了使用 jQuery UI 按钮（非常棒），所以在我的应用程序中我只是将 attr 设置为禁用......你可以以任何你想要的方式处理这个细节。

接下来，在ajax成功的情况下，简单地改变你最初设置的按钮状态。它还有助于在顶部添加加载程序通知并在此处将其删除。带有来自 ajaxload.info 的动画 gif 的 Jquery 对话框非常完美。

BTW，jQuery 的 ajax 函数默认是异步的，不需要定义。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-08T18:14:42.137

我真的需要查看您的 ajax 代码，但默认情况下，它应该是异步的。不过，这是为您提供的回调 101：

顺便说一下，这假定了 jQuery 语法。如果您需要其他格式，请告诉我。

```
$.ajax({
    type: 'POST',
    url: yourUrl,
    async: true, //not necessary -- its the default behavior, but I put it in there in case you had it set to false currently
    //here are your callbacks: success will be called when your ajax function returns, and error will be called if any errors are thrown
    success: function(results) {                   
             //do something with your results       
             }                                    
    error: function(e) {
             //do something with your error
           }
}); 
```

# sql-server - 如何从数据库中获取最后一个用户ID到asp.net中的文本框

> ID：15300401
> 
> 赞同：0
> 
> 时间：2013-03-08T18:03:31.760
> 
> 标签：sql-server

谢谢我使用了 MAX 语句，它没有返回错误，但仍然不明白为什么它不起作用。我的代码如下所示：

```
Protected Sub txtuserID_TextChanged(sender As Object, e As System.EventArgs) Handles txtuserID.TextChanged
    Dim strConnection As String = "Data Source=.\SQLEXPRESS;AttachDbFilename=E:\LostPropertyProject\App_Data\LostPropertyDatabase.mdf;Integrated Security=True;User Instance=True"
    'Establish SQL Connection
    Dim con As New SqlConnection(strConnection)
    'Open database connection to connect to SQL Server
    con.Open()
    'Data table is used to bind the resultant data
    Dim dtusers As New DataTable()
    'Create a new data adapter based on the specified query.
    Dim comm As New SqlCommand
    comm.CommandText = "SELECT MAX(UserID) FROM tblUser"
    comm.Connection = con

    Dim MaxUserID As Object = comm.ExecuteScalar()
    con.Close()
End Sub 
```

另外，我希望用户ID 在页面加载后立即显示在文本框中。我该怎么做呢？并感谢所有回答我问题的人:) 非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T18:13:26.067

```
SELECT MAX(UserId) FROM User 
```

这将为您提供表中的最新用户 ID。

# tsql - T-SQL - sum 复杂的递归

> ID：15300408
> 
> 赞同：0
> 
> 时间：2013-03-08T18:03:44.573
> 
> 标签：tsql, tree, recursive-query

对于冗长的问题描述，我深表歉意，但我无法将其分解为更多。在继续阅读之前，请记住我的最终目标是 T-SQL（可能是一些递归 CTE？）。但是，非常感谢您朝正确的方向推进（我已经尝试了一百万件事，并且已经摸不着头脑了好几个小时）。

考虑以下问题：我有一个通过 ParentCategoryID->CategoryID 自引用的类别表：

```
----------------------
| 类别 |
----------------------
| *类别ID |
| 姓名 |
| 父类别 ID |
----------------------

```

这种类型的表允许我构建一个树结构，比如：

```
             -----------------  
             | 父类|
             -----------------
             / | \
           小孩(1) 小孩小孩
           / \
      儿童(2) 儿童(3)

```

其中“child”表示“子类别”（忽略数字，我稍后会解释）。显然，我可以在任何级别上拥有尽可能多的孩子。

每天，我编写的程序将值存储到表“ValueRegistration”中，该表连接到“Category”，如下所示：

```
------------------------ ---------- ---- ------------------
| 价值注册 | | 项目 | | 类别 |
------------------------ ---------- ---- ------------------
| *RegID | | *项目ID | | *类别ID |
| 日期 |>-------| 类别ID |>---------| 姓名 |
| 物品编号 | | 项目类型ID | | 父类别 ID |
| 价值 | ---------------------- ----------
------------------------ 是
                                          |
                                          |
                                ---------------------
                                | 项目类型 |
                                ---------------------
                                | *ItemTypeID |
                                | 项目类型 |
                                ---------------------

```

如您所见，ValueRegistration 涉及特定的项目，而该项目又属于某个类别。该类别可能有也可能没有父母（以及祖父母和曾祖父母等）。例如，它可能是我上面图示的树中一直到左下角（数字 2）的孩子。此外，Item 属于某个 ItemType。

我的目标：
我每天将值注册到 ValueRegistration 表中（换句话说，Date 和 ItemID 的组合也是一个主键）。我希望能够以以下形式检索结果集：

```
[ValueRegistration.Date, ItemType.ItemTypeID, Category.CategoryID, Value] 
```

这看起来很简单（显然只是一堆连接）。但是，我还想要 ValueRegistration 表中实际不存在的行的**结果，即对给定日期和 itemID 的兄弟节点的值求和的结果，并在**ValueRegistration.Date**和**ItemType 处生成新行。 ItemTypeID**与子节点中的相同，但**CategoryID**是子节点的父节点**。请记住，结果集中这种类型的行将不存在 Item。

例如，考虑一个场景，我在一堆日期和一堆 ItemID 上有孩子 2 和 3 的 ValueRegistrations。显然，每个注册都属于某个ItemType和Category。读者应该清楚的是

```
ValueRegistration.Date, ItemType.ItemTypeID, Category.CategoryID 
```

是一个足以识别特定 ValueRegistration 的键（换句话说，可以解决我的问题而无需创建临时 Item 行），因此我可以内部连接所有表，例如，以下结果：

```
ValueReg.Date, ItemType.ItemTypeID, Category.CategoryID, ValueReg.Value
08-mar-2013, 1, 5, 200
08-mar-2013, 1, 6, 250 
```

现在假设我有四个如下所示的类别行：

```
1, category1, NULL
2, category2, 1
5, category5, 2
6, category6, 2 
```

即类别 1 是类别 2 的父类别，类别 2 是类别 5 和 6 的父类别。类别 1 没有父类别。我现在希望将以下行附加到我的结果集中：

```
08-mar-2013, 1, 2, (200+250)
08-mar-2013, 1, 1, (200+250+sum(values in all other childnodes of node 1) 
```

记住：

1.  解决方案需要递归，以便在树中向上执行（直到达到 NULL）
2.  计算的树节点将不存在 Item 行，因此必须使用 CategoryID 和 ItemTypeID
3.  是的，我知道当我最初插入数据库时​​，我可以简单地创建“虚拟”项目行并添加 ValueRegistrations，但这种解决方案很容易出错，特别是如果其他程序员针对我的数据库编写代码但忘记或不知道结果必须传递给父节点。相反，根据请求计算此值的解决方案更安全，坦率地说，更优雅。

我试图按照[this](https://stackoverflow.com/questions/8837347/recursive-query-with-cte-sum-of-child-columns-for-a-given-parent)的方式设置一些东西，但我似乎不得不按 Date 和 ItemTypeID 分组，而这在 CTE 中是不允许的。我的程序员只想做一个递归函数，但我真的很难在 SQL 中做到这一点。

任何人都知道从哪里开始，我应该尝试什么，甚至（手指交叉）解决方案？

谢谢！

亚历山大

编辑：SQL 小提琴

```
CREATE TABLE ItemType(
  ItemTypeID INT PRIMARY KEY,
  ItemType VARCHAR(50)
);

CREATE TABLE Category(
  CategoryID INT PRIMARY KEY,
  Name VARCHAR(50),
  ParentCategoryID INT,
  FOREIGN KEY(ParentCategoryID) REFERENCES Category(CategoryID)
  );

CREATE TABLE Item(
  ItemID INT PRIMARY KEY,
  CategoryID INT NOT NULL,
  ItemTypeID INT NOT NULL,
  FOREIGN KEY(CategoryID) REFERENCES Category(CategoryID),
  FOREIGN KEY(ItemTypeID) REFERENCES ItemType(ItemTypeID)
  );

CREATE TABLE ValueRegistration(
  RegID INT PRIMARY KEY,
  Date DATE NOT NULL,
  Value INT NOT NULL,
  ItemID INT NOT NULL,
  FOREIGN KEY(ItemID) REFERENCES Item(ItemID)
  );

INSERT INTO ItemType VALUES(1, 'ItemType1'); 
INSERT INTO ItemType VALUES(2, 'ItemType2');

INSERT INTO Category VALUES(1, 'Category1', NULL);   -- Top parent (1)
INSERT INTO Category VALUES(2, 'Category2', 1);      -- A child of 1
INSERT INTO Category VALUES(3, 'Category3', 1);      -- A child of 1
INSERT INTO Category VALUES(4, 'Category4', 2);      -- A child of 2
INSERT INTO Category VALUES(5, 'Category5', 2);      -- A child of 2
INSERT INTO Category VALUES(6, 'Category6', NULL);   -- Another top parent

INSERT INTO Item VALUES(1, 4, 1);    -- Category 4, ItemType 1
INSERT INTO Item VALUES(2, 5, 1);    -- Category 5, ItemType 1
INSERT INTO Item VALUES(3, 3, 1);    -- Category 3, ItemType 1
INSERT INTO Item VALUES(4, 1, 2);    -- Category 1, ItemType 2

INSERT INTO ValueRegistration VALUES(1, '2013-03-08', 100, 1);
INSERT INTO ValueRegistration VALUES(2, '2013-03-08', 200, 2);
INSERT INTO ValueRegistration VALUES(3, '2013-03-08', 300, 3);
INSERT INTO ValueRegistration VALUES(4, '2013-03-08', 400, 4);
INSERT INTO ValueRegistration VALUES(5, '2013-03-09', 120, 1);
INSERT INTO ValueRegistration VALUES(6, '2013-03-09', 220, 2);
INSERT INTO ValueRegistration VALUES(7, '2013-03-09', 320, 3);
INSERT INTO ValueRegistration VALUES(8, '2013-03-09', 420, 4);

-- -------------------- RESULTSET I WANT ----------------------
--  vr.Date    | ItemType    | CategoryTypeID  |  Value
-- ------------------------------------------------------------
--  2013-03-08 | 'ItemType1' | 'Category4'     | 100              Directly available
--  2013-03-08 | 'ItemType1' | 'Category5'     | 200              Directly available
--  2013-03-08 | 'ItemType1' | 'Category3'     | 300              Directly available
--  2013-03-08 | 'ItemType1' | 'Category2'     | 100+200          Calculated tree node
--  2013-03-08 | 'ItemType1' | 'Category1'     | 100+200+300      Calculated tree node
--  2013-03-08 | 'ItemType2' | 'Category1'     | 400              Directly available
--  2013-03-09 | 'ItemType1' | 'Category4'     | 120              Directly available
--  2013-03-09 | 'ItemType1' | 'Category5'     | 220              Directly available
--  2013-03-09 | 'ItemType1' | 'Category3'     | 320              Directly available
--  2013-03-09 | 'ItemType1' | 'Category2'     | 120+220          Calculated tree node
--  2013-03-09 | 'ItemType1' | 'Category1'     | 120+220+320      Calculated tree node
--  2013-03-09 | 'ItemType2' | 'Category1'     | 420              Directly available 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T19:17:41.977

If you replace all joins to the table Category with joins to this dynamic relation, you will get the hierarchy you are lookinfg for:

```
with Category as (
  select * from ( values
    (1,'Fred',null),
    (2,'Joan',1),
    (3,'Greg',2),
    (4,'Jack',2),
    (5,'Jill',4),
    (6,'Bill',3),
    (7,'Sam',6)
  ) Category(CategoryID,Name,ParentCategoryID)
)
, Hierarchy as (
  select 0 as [Level],* from Category
--  where Parent is null

  union all

  select super.[Level]+1, sub.CategoryID, super.Name, super.ParentCategoryID
  from Category as sub
  join Hierarchy as super on super.CategoryID = sub.ParentCategoryID and sub.ParentCategoryID is not null
) 
select * from Hierarchy
-- where CategoryID = 6
-- order by [Level], CategoryID 
```

For example, uncommenting the two lines at the bottom will yield this result set:

```
Level       CategoryID  Name ParentCategoryID
----------- ----------- ---- ----------------
0           6           Bill 3
1           6           Greg 2
2           6           Joan 1
3           6           Fred NULL 
```

# actionscript-3 - 如何使用嵌入在 SWC 中的字体

> ID：15300413
> 
> 赞同：3
> 
> 时间：2013-03-08T18:04:07.007
> 
> 标签：actionscript-3, flash, fonts, flash-builder, swc

我从 Flash CS3 导出了一个嵌入字体的 SWC。

现在我想在一些TextFields中使用它，但我不知道如何使用字体。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-09T19:47:32.103

完毕！这是我的解决方案：

```
[Embed(source="res/guardanapo.otf", fontName="guardanapo", fontFamily="guardanapo", unicodeRange="U+0020-U+002F,U+0030-U+0039,U+003A-U+0040,U+0041-U+005A,U+005B-U+0060,U+0061-U+007A,U+007B-U+007E", advancedAntiAliasing="false", embedAsCFF="false")]
public static const fonte:Class; 
```

我想从 SWC 嵌入字体，但现在不再需要了。但是，如果您知道该怎么做，请回答，也许有人现在正在寻找它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T19:39:07.247

试试这个。myLoader 是您使用其库中的字体加载 swf/swc 的加载器。myTextField 是一个预先存在的文本字段。我将 embedFonts 设置为 true，但您可能不需要它。

```
var MyFont:Class = myLoader.contentLoaderInfo.applicationDomain.getDefinition("FontClassName");

var embeddedFont:Font = new MyFont();

var textFormat:TextFormat = new TextFormat();
textFormat.font = embeddedFont.fontName;
textFormat.size = 24;

myTextField.setTextFormat(textFormat);
myTextField.embedFonts = true; 
```

也许您可以在 swf 中包含一个获取字体的类以及您想要使用的字体。可能存在将字体应用于字段的静态方法，或者在给定字体类名的情况下返回字体名称。这可以帮助保持应用程序的其余部分更清洁。

# symfony - 从 Twig 表单传递变量

> ID：15300420
> 
> 赞同：-1
> 
> 时间：2013-03-08T18:04:19.407
> 
> 标签：symfony, controller, twig

我是 Symfony2 的新手。我的问题是：我想将值从 Twig 表单传递到数据库。控制器：

```
public function createAction()

{
    $product = new Product();
    $product->setName('name');
    $product->setPrice('price');
    $product->setDescription('description');

    $em = $this->getDoctrine()->getEntityManager();
    $em->persist($product);
    $em->flush();

    return new Response('Izveidots produkts id '.$product->getId());
} 
```

我想使用表单中的值而不是使用常量值（'name'、'price'）。风景：

```
<form action="{{ path('blogger_blog_create') }}" method="post" {{ form_enctype(form) }}>
    {{ form_errors(form) }}

    {{ form_row(form.name)}} 
    {{ form_row(form.price) }}
    {{ form_row(form.description) }}

    {{ form_rest(form) }}

    <input type="submit" />
</form> 
```

我试图弄清楚几个小时。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T18:25:17.067

你可以在[官方 symfony 文档](http://symfony.com/doc/2.1/book/forms.html)中找到你需要的所有信息。最简单的例子：

```
if ($request->isMethod('POST')) {
    $form->bind($request);

    if ($form->isValid()) {
        // perform some action, such as saving the task to the database

        return $this->redirect($this->generateUrl('task_success'));
    }
} 
```

# python - ManyToOneRel 和 ForeignKey 的区别？

> ID：15300422
> 
> 赞同：32
> 
> 时间：2013-03-08T18:04:28.543
> 
> 标签：python, database, django

在 django 中，ManyToOneRel 和 ForeignKey 字段有什么区别？

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2013-06-11T15:07:41.743

Django 关系模型仅公开（和文档）*OneToOneField*、*ForeignKey*和*ManyToManyField*，它们对应于内部

*   **OneToOneField** -> **OneToOneRel**
*   **ForeignKey** -> **ManyToOneRel**
*   **ManyToManyField** -> **ManyToManyRel**

*有关更多详细信息，请参阅django.db.models.fields.related*的来源。

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2013-03-08T18:24:52.210

`ManyToOneRel`不是 a `django.db.models.fields.Field`，它是一个在 Django 内部使用但不在用户代码中使用的类。

# asp.net-mvc - 服务和控制器方法类似的操作

> ID：15300424
> 
> 赞同：0
> 
> 时间：2013-03-08T18:04:38.110
> 
> 标签：asp.net-mvc

我有一个消息服务，其中包含创建、列出、更新和删除等操作。

在此服务中，我有一个 ListByMember(int memberId) 方法。

我需要构建两个视图，一个仅列出消息的标题，另一个视图列出消息的标题和描述，另一个列出标题和已收到的消息答案的总数。

我不知道我是否在服务层中创建了一种方法并通过 DTO 将所有信息从消息实体传输到视图中，并且在视图中我只显示我想要的字段，或者我是否在服务层中创建了三种方法独立于它自己的 DTO 和特定视图。

我害怕创建一个单一的服务方法，如果将来我需要一个特殊的消息列表，我将面临一个问题。

任何建议都会很好。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T02:55:10.993

视图/控制器操作不是放置业务逻辑的最佳位置。尝试在服务中使用三种方法，即使这意味着一些额外的代码。您已决定使用 DTO 来实现非常好的项目。您可以采取的一种方法是创建一个私有方法以从存储库中将 DTO 获取为 IQueryable 并通过公共方法公开它作为示例

```
// DTOs
public class MessageSummaryADto
{
    public int MessageId { get; set; }
    public string Title { get; set; }
}

public class MessageSummaryBDto : MessageSummaryADto
{
    public string Description { get; set; }
}

// public methods
public int GetMessageCount()
{
    return GetMessageSummary().Count();
}

public IQueryable<MessageSummaryADto> GetMessageSummaryADto()
{
    return GetMessageSummary().Select(m => new MessageSummaryADto { MessageId = m.MessageId, Title = m.Title });
}

public IQueryable<MessageSummaryBDto> GetMessageSummaryBDto()
{
    return GetMessageSummary();
}

// the private method
private IQueryable<MessageSummaryBDto> GetMessageSummary()
{
    return yourMessageRepository.Select(m =>
        new MessageSummaryBDto {
            MessageId = m.MessageId,
            Title = m.Title,
            Description = m.Description
        }
    );
} 
```

如果您不是 IQueryable 的粉丝，您可以将 dto 公开为 IList

祝你好运

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T00:17:46.223

我的第二个答案需要两个级别的服务，一个业务服务和一个 UI 服务。如果您有非常具体的 UI 处理（例如列表和网格等的投影和过滤器），您会希望使用这种方法。业务服务将公开更多通用方法，这对 UI 来说是中性的

那么它是如何映射的；

**域对象（*输出：业务对象*）-> 业务服务（*输出通用 DTO*）-> UI 服务（*特定于 UI 的 DTO*）-> 控制器操作-> 视图**

将数据切片和切块的 UI 任务卸载到特定于 UI 的服务使 Controller Action 非常薄（应该如此）；通常，如果您可以将控制器操作中的代码行数限制为 10~15

将 UI 服务与代码业务服务分开将使您可以轻松拥有多个 UI。例如，当您的业务服务是 UI 中立时，您可以使用它来处理 ASP.Mvc 和 WPF 应用程序

上述方法需要维护额外的层，但如果您想要清晰的分离，值得考虑

干杯

# c# - 基于多部分 xml 根声明创建具有命名空间前缀的元素

> ID：15300437
> 
> 赞同：0
> 
> 时间：2013-03-08T18:05:15.633
> 
> 标签：c#, xml, xml-namespaces, prefix

如果我做这样的事情：

```
System.Xml.XmlDocument xmlDoc = new System.Xml.XmlDocument();
XmlElement e = xmlDoc.CreateElement("ShipmentReceiptNotification");
e.SetAttribute("xmlns", "urn:rosettanet:specification:interchange:ShipmentReceiptNotification:xsd:schema:02.02");
e.SetAttribute("xmlns:ssdh", "urn:rosettanet:specification:domain:Procurement:AccountClassification:xsd:codelist:01.03");
XmlNode ShipmentReceiptNotification0Node = e;

ShipmentReceiptNotification0Node.InnerText = String.Empty;
xmlDoc.AppendChild(ShipmentReceiptNotification0Node);
XmlNode DocumentHeader1Node = xmlDoc.CreateElement("ssdh:DocumentHeader");
ShipmentReceiptNotification0Node.AppendChild(DocumentHeader1Node); 
```

会导致第二个节点的前缀`ssdh`不显示，只`DocumentHeader`显示。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T18:51:46.837

您需要像这样创建它：

```
XmlNode DocumentHeader1Node = xmlDoc.CreateElement("ssdh", "DocumentHeader", "urn:rosettanet:specification:domain:Procurement:AccountClassification:xsd:codelist:01.03"); 
```

关键是`XmlDocument`需要知道哪个命名空间前缀（第一个参数）对应哪个命名空间 URI（第三个参数）。有点违反直觉，但这就是它的工作方式。

另请注意，该行`ShipmentReceiptNotification0Node.InnerText = String.Empty;`是无用的；省略它是安全的，该元素*默认*为空。

# c# - Linq-to-Xml prefix parse error

> ID：15300438
> 
> 赞同：0
> 
> 时间：2013-03-08T18:05:17.527
> 
> 标签：c#, linq-to-xml

I am currently trying to learn how to parse data, and its a bit confusing. can someone check out my code and see what I'm doing wrong or if im even heading in the right direction.

XML File:

```
<xml xmlns:a='BLAH'
     xmlns:b='BLAH'
     xmlns:c='BLAH'
     xmlns:d='BLAH'>
  <a:info>
   <b:cat Option1='blah' Option2='blah' Option3='blah' />
  </a:info>
</xml> 
```

C# Code:

```
XmlDocument doc = new XmlDocument();
doc.Load(richTextBox2.Text);

XmlNamespaceManager man = new XmlNamespaceManager(doc.NameTable);
man.AddNamespace("a", "BLAH");
man.AddNamespace("b", "BLAH");
man.AddNamespace("c", "BLAH");
man.AddNamespace("d", "BLAH");

XmlNode temps = doc.SelectSingleNode("/a:info/b:cat/Option1/", man);

richTextBox1.Text = temps.InnerText; 
```

I am new to C#, I cant find a good example ***explaining*** how to successfully use loops to find more then one:

```
<b:chat /> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T18:22:43.427

假设以下输入 XML 文档（请注意命名空间 URL）：

```
<xml xmlns:a='http://localhost/scheme_a'
     xmlns:b='http://localhost/scheme_b'
     xmlns:c='http://localhost/scheme_c'
     xmlns:d='http://localhost/scheme_d'>
    <a:info>
       <b:cat Option1='1' Option2='1' Option3='1' />
    </a:info>

    <a:info>
       <b:cat Option1='2' Option2='2' Option3='2' />
    </a:info>
</xml> 
```

有获得所有`<b:chat />`元素的方法。

1.  [XmlDocument](http://msdn.microsoft.com/en-us/library/system.xml.xmldocument.aspx)类：

    ```
    var xmlDocument = new XmlDocument();
    xmlDocument.Load(...);

    var xmlNamespaceManager = new XmlNamespaceManager(xmlDocument.NameTable);
    xmlNamespaceManager.AddNamespace("a", "http://localhost/scheme_a");
    xmlNamespaceManager.AddNamespace("b", "http://localhost/scheme_b");
    xmlNamespaceManager.AddNamespace("c", "http://localhost/scheme_c");
    xmlNamespaceManager.AddNamespace("d", "http://localhost/scheme_d");

    var bCatNodes = xmlDocument.SelectNodes("/xml/a:info/b:cat", xmlNamespaceManager);
    var option1Attributes = bCatNodes.Cast<XmlNode>().Select(node => node.Attributes["Option1"]);

    // Also, all Option1 attributes can be retrieved directly using XPath:
    // var option1Attributes = xmlDocument.SelectNodes("/xml/a:info/b:cat/@Option1", xmlNamespaceManager).Cast<XmlAttribute>(); 
    ```

2.  LINQ to XML [XDocument 类](http://msdn.microsoft.com/en-us/library/system.xml.linq.xdocument.aspx)。[XName](http://msdn.microsoft.com/en-us/library/system.xml.linq.xname.aspx)可以通过命名空间传递给[Descendants()](http://msdn.microsoft.com/en-us/library/system.xml.linq.xdocument.descendants.aspx)和[Element()](http://msdn.microsoft.com/en-us/library/system.xml.linq.xelement.elements.aspx)方法。

    使用[Descendants()](http://msdn.microsoft.com/en-us/library/system.xml.linq.xdocument.descendants.aspx)获取所有`<b:chat />`元素。

    ```
    var xDocument = XDocument.Load(...);
    XNamespace xNamespace = "http://localhost/scheme_b";
    var xElements = xDocument.Descendants(xNamespace + "cat");

    // For example, get all the values of Option1 attribute for the b:chat elements:
    var options1 = xElements.Select(element => element.Attribute("Option1")).ToList(); 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T18:12:46.037

如果您正在寻找 LINQ to XML，则您使用了错误的 API。请改用 XDocument 类。

# c++ - 当第二个操作数为 1 时，如何将每一位归零？

> ID：15300442
> 
> 赞同：5
> 
> 时间：2013-03-08T18:05:35.903
> 
> 标签：c++, bit-manipulation

例子：

```
1010111110110001
0101011100010010
================
1010100010100001

 |0 1
-|----
0|0 1
1|0 0 
```

如何在 c++ /c++11 中执行此操作？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-08T18:07:39.143

您可以按位 NOT 然后 AND 他们：`a & ~b`

鉴于：

```
 a     = 1010111110110001
 b     = 0101011100010010 
```

然后否定`b`给出：

```
~b     = 1010100011101101 
```

并做`a & ~b`：

```
 a     = 1010111110110001
~b     = 1010100011101101
-------------------------
a & ~b = 1010100010100001 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-08T18:07:46.740

简单的：

```
result = op1 & ~op2; 
```

这将按位反转第二个操作数（1 变为 0，反之亦然）。在此之后，您使用按位与。这通常称为使用位掩码。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-03-08T18:07:49.733

您应该能够使用按位否定进行按位与：

```
result = val1 & ~val2; 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-03-08T18:08:09.433

您想要第二个操作数的补码的按位与。

```
int fun(int x, int y)
{
    return x & ~y;
} 
```

# javascript - 如何将默认脚本文件夹导入空白 mvc4 项目

> ID：15300443
> 
> 赞同：2
> 
> 时间：2013-03-08T18:05:40.970
> 
> 标签：javascript, asp.net-mvc, visual-studio-2012

我创建了一个空的 MVC4 应用程序。它不包含 Scripts 文件夹或任何 javascript 文件。

我需要其中一些 js 文件。

如何将它们添加到我的项目中？我可以添加一个新文件夹，并单独下载/添加每个 JS 文件，但必须有更好的方法。我知道 VS 在某个地方有它们....

例子：

```
<script src="@Url.Content("~/Scripts/jquery.unobtrusive-ajax.min.js")" type="text/javascript"></script> 
```

`~/Scripts`不存在。无论如何，我可以只导入带有默认 JS 文件的文件夹吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-08T19:11:49.740

使用`NuGet`. `NuGet`将正确地将依赖于 JavaScript 的框架放入`~\Scripts`目录中。

右键单击`References->Manage NuGet Packages`。

我在我的项目中使用了作为依赖`NuGet`项下拉到我的.`jQuery 1.9.1``ASP.NET MVC4 Solution`

![NuGet](../Images/5032726959b4b43fbd86e1963c1694e0.png)

我验证这将以下内容带入我的`~\Scripts`目录：

*   jquery-1.9.1-intellisense.js
*   jquery-1.9.1.js
*   jquery-1.9.1.min.js
*   jquery-1.9.1.min.map

这是我的解决方案资源管理器：

![解决方案资源管理器](../Images/e3d4574463db7bd54392020b7328f39e.png)

这是一种通过和管理默认脚本（例如`jQuery`、`knockout`或`modernizr`）的简洁方法。`VS.NET``NuGet`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T18:16:49.673

我最终做的是创建一个新的 Internet 应用程序，然后进入项目文件并将它们复制到空项目中。

必须有一个更好的方法，所以让问题悬而未决。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T18:18:09.697

创建非空项目（它将包含您需要的所有脚本），然后将它们复制到您的空项目到“脚本”文件夹中，并查看几个地方如何将它们包含到项目中：

*   全球.asax
*   App_Start\BundleConfig.cs

这就是你需要做的。谢谢并希望这会有所帮助！

# python - 可被 2 整除：Python

> ID：15300445
> 
> 赞同：0
> 
> 时间：2013-03-08T18:05:42.897
> 
> 标签：python, python-2.7

我正在尝试编写一个名为的函数，该函数`splitList(myList, option)`接受一个列表和一个`0`作为`1`参数的选项。如果选项的值为负数，则该函数返回一个`0`列表`myList`，如果该选项的值为负数，则`1`该函数返回一个由偶数元素组成的列表`myList`（我们认为 0 是偶数，因为它可以被 2 整除）。

例如：

```
splitList([1,-3,5,7,-9,-11,0,2,-4], 0) 
```

将返回列表：

```
[-3,-9,-11,-4] 
```

然而：

```
splitList([1,-3,5,7,-9,-11,0,2,-4], 1) 
```

将返回列表：

```
[0,2,-4] 
```

对于这个问题，我必须使用`for loop`.

这是我所拥有的：

```
def splitList(myList, option):
    negativeValues = []
    positiveValues = []
    evenValues = [] 
    for i in range(0,len(myList)):       
        if myList[i] < 0: 
            negativeValues.append(myList [i]) 
        else: 
            positiveValues.append(myList [i]) 

    for element in myList: 
        if option == 1: 
            myList [i] % 2 == 0 
            evenValues.append(myList [i]) 
            return evenValues 
        else: 
            return negativeValues 
```

我唯一不能做的就是对列表进行排序并返回所有能被 2 整除的数字。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-08T18:12:46.177

在这里使用循环有点多余，因为有一个标准函数`filter`可以执行您想要的操作：返回一个新列表，其中包含与给定谓词匹配的列表元素。

让我们先定义谓词：

```
def is_even(x):
    return x % 2 == 0

def is_negative(x):
    return x < 0 
```

然后你可以很容易地定义你的函数`filter`：

```
def splitList(myList, option):
    predicate = is_negative if option == 0 else is_even
    return filter(predicate, myList) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-08T18:20:26.567

您可以从这些原语构建所有变体：

```
def even_list(numbers):
    return [x for x in numbers if not (x & 1)]

def odd_list(numbers):
    return [x for x in numbers if x & 1]

def negative_list(numbers):
    return [x for x in numbers if x < 0]

def positive_list(numbers):
    return [x for x in numbers if x > 0] 
```

然后测试：

```
>>> def test():
...     numbers = list(range(-3, 4))
...     print even_list(numbers)
...     print odd_list(numbers)
...     print positive_list(numbers)
...     print negative_list(numbers)
... 
>>> test()
[-2, 0, 2]
[-3, -1, 1, 3]
[1, 2, 3]
[-3, -2, -1] 
```

* * *

后来：所以从@Kos窃取，你可以这样写`split_list`：

```
def split_list(myList, option):
    predicate = negative_list if not option else even_list
    return predicate(myList) 
```

或者：

```
def split_list(myList, option):
    predicates = [negative_list, even_list]
    return predicates[option](myList) 
```

`for-loop`如果在被调用函数的列表理解中，不确定它是否满足您的需求。

[另外](http://www.python.org/dev/peps/pep-0008/#function-names)：“函数名称应该是小写的，单词之间用下划线分隔，以提高可读性。”

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-08T18:18:01.423

你回来得太早了。您首先必须完成 foror 循环并在它之后返回，而不是从循环内部返回。

例子

```
for i in range(5):
    print i
    numbers.append(i)
    return numbers   //wrong: exit the function on the first pass in the loop.

for i in range(5):
    print i
    numbers.append(i)

return numbers       //right 
```

除此之外，如果不需要，为什么要计算负值列表？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-08T18:22:59.137

```
def splitList(myList,option):

    negative_numbers = [i for i in myList if i < 0]
    even_numbers = [i for i in myList if i % 2 == 0]

    return sorted(even_numbers) if option else sorted(negative_numbers) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-08T18:18:34.337

我相信这就是您想要实现的目标：

```
def splitList(myList,option):

    result = []

    if option == 0:
        for item in myList:
            if (item < 0):
                result.append(item)
    elif option == 1:
        for item in myList:
            if (item % 2 == 0):
                result.append(item)
    else:
        return "Option Error"

    return sorted(result)

print splitList([1,-3,5,7,-9,-11,0,2,-4], 0)
print splitList([1,-3,5,7,-9,-11,0,2,-4], 1)
print splitList([1,-3,5,7,-9,-11,0,2,-4], 2) 
```

输出：

```
[-11, -9, -4, -3]
[-4, 0, 2]
Option Error 
```

# sql - Manually filling additional columns not populated by a nested SP call

> ID：15300447
> 
> 赞同：1
> 
> 时间：2013-03-08T18:05:51.250
> 
> 标签：sql, sql-server-2008

I have a stored proc which calls another stored proc a number of times with different parameters and fills a temp table.

```
--load inactive SKUs
INSERT INTO #tmpSKUs 
exec GetAdvancedSkus @editionId

--load retailer specific SKUs
INSERT INTO #tmpSKUs 
exec GetAdvancedSkus @editionId, 2, 1 
```

What I want to do is manually populate (hardcode) the SKUType column (this column is not being filled) of the #tmpSKUs table **with each iteration**, so that in the case of Inactive SKUs, it'll populate the table with results and add "Inactive" in the SKUType column. I cannot alter GetAdvancedSKUs as that stored proc has many dependencies.

Here's the full SP code

```
ALTER proc [dbo].[GetSkuTypes]
@editionId as int,
@isbnNum as nvarchar(20)=null,
@upcCode as nvarchar(20)=null,
@productNum as nvarchar(20)=null
as

IF (@editionId > 0)
BEGIN
CREATE TABLE #tmpSKUs
(
    SKUId int,
    ProductNumber varchar(255),
    ISBN varchar(255),
    UPC varchar(255),
    Territory varchar(255),
    Format varchar(255),
    Division varchar(255),
    SourceTag varchar(255),
    PictureFormat varchar(255),
    Retailer varchar(255),
    TextAddDetails nvarchar(3000),
    AddDetails nvarchar(3000),
    PackagingLanguage varchar(255),
    EditionId int,
    BluePrintPublishStatus varchar(255),
    SAPPublishStatus varchar(255),
    SKUType varchar(255)
)

--load inactive SKUs
INSERT INTO #tmpSKUs 
exec GetAdvancedSkus @editionId

--load national single SKUs
INSERT INTO #tmpSKUs 
exec GetAdvancedSkus @editionId, 1, 1

--load retailer specific SKUs
INSERT INTO #tmpSKUs 
exec GetAdvancedSkus @editionId, 2, 1

SELECT * FROM #tmpSKUs

END 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T18:15:44.937

您可以在插入后手动更新列吗？

```
--load inactive SKUs
INSERT INTO #tmpSKUs 
exec GetAdvancedSkus @editionId

UPDATE #tmpSKUs
SET SKUType = 'Inactive'

--load national single SKUs
INSERT INTO #tmpSKUs 
exec GetAdvancedSkus @editionId, 1, 1

UPDATE #tmpSKUs
SET SKUType = 'National Single'
WHERE SKUType <> 'Inactive'

--load retailer specific SKUs
INSERT INTO #tmpSKUs 
exec GetAdvancedSkus @editionId, 2, 1

UPDATE #tmpSKUs
SET SKUType = 'Retailer Specific'
WHERE SKUType NOT IN ('Inactive', 'National Single')

SELECT * FROM #tmpSKUs 
```

# listview - ListView 没有使用自定义 ListItemComponent

> ID：15300452
> 
> 赞同：2
> 
> 时间：2013-03-08T18:06:04.307
> 
> 标签：listview, blackberry-10, blackberry-cascades

我正在尝试在我的级联中使用自定义*ListItemComponent*但是它忽略了它。它没有绘制我的*Label*，将其着色为青色并将 ListItemData.text 放入，而是用 ListItemData.description 填充我的列表（我的 json 具有文本、描述、状态和图像）。[你可以在这里看到截图](http://i.stack.imgur.com/LbniQ.png)。如果我使用*StandardListItem*所有信息都会正确显示。

**QML：**

```
Page {
    Container {
        ListView {
            id: myListView
            dataModel: MyListModel {
                id: myListModel
            }
            listItemComponents: [
                ListItemComponent {
                    type: "listItem"

                    Container {
                        id:item
                        layout: StackLayout {
                            orientation: LayoutOrientation.LeftToRight
                        }
                        Label {
                            id: text
                            text: ListItemData.text
                            textStyle {
                                color: Color.Cyan
                            }
                        }
                    }
                }
            ]
        }
    }
    onCreationCompleted: {
        myListModel.load("app/native/assets/mydata.json")
    }
} 
```

**C++：**

```
void MyListModel::load(const QString& file_name)
{
    bb::data::JsonDataAccess jda;
    QVariantList lst = jda.load(file_name).value<QVariantList>();
    if (jda.hasError()) {
        bb::data::DataAccessError error = jda.error();
        qDebug() << file_name << "JSON loading error: " << error.errorType() << ": " << error.errorMessage();
    }
    else {
        qDebug() << file_name << "JSON data loaded OK!";
        append(lst);
    }
}

QVariant MyListModel::value(int ix, const QString &fld_name)
{
    QVariant ret;
    if(ix >= 0 && ix < size()) {
        QVariantMap curr_val = QVariantListDataModel::value(ix).toMap();
        ret = curr_val.value(fld_name);
    }
    return ret;
}

void MyListModel::setValue(int ix, const QString& fld_name, const QVariant& val)
{      
    if(ix >= 0 && ix < size()) { 
        QVariantMap curr_val = QVariantListDataModel::value(ix).value<QVariantMap>();
        curr_val[fld_name] = val;
        replace(ix, curr_val);
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-08T22:53:21.440

这取决于您的 DataModel 实现/继承的类型。当 ListView 需要知道要显示的项目的类型时，在大多数情况下（请参阅[ListItemTypeMapper](https://developer.blackberry.com/cascades/reference/bb__cascades__listitemtypemapper.html)`itemType()`以了解例外情况）它从[DataModel](https://developer.blackberry.com/cascades/reference/bb__cascades__datamodel.html)调用。默认情况下，大多数数据模型将返回一个空字符串，但[GroupDataModel](https://developer.blackberry.com/cascades/reference/bb__cascades__groupdatamodel.html#function-itemtype-indexpath)将返回“标题”或“项目”，具体取决于项目是否为标题。

您已指定您`ListItemComponent`仅对“listItem”类型的项目有效，这很可能与您`MyListModel::itemType()`返回的内容不匹配。如果`MyListModel`是 a `GroupDataModel`，则将您的更改`ListItemComponent`为 for `type: "item"`，否则使用`type: ""`或完全删除该`type`属性，以便`ListItemComponent`默认情况下将您的用于所有项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-18T09:31:55.933

在 ListItemComponent{ } 中，您有一个“type:”字段，您应该将值设置为“item”，即。**类型：“项目”**。然后列表视图将使用自定义组件

# regex - How do you extract phone numbers from email bodies in Outlook?

> ID：15300458
> 
> 赞同：0
> 
> 时间：2013-03-08T18:06:20.063
> 
> 标签：regex, csv, outlook

I have a pretty large account full of ~20k emails in Outlook and I need to extract phone numbers from those emails.

An example of an email would be:

```
From: Amy Schwartz <amy@blahdyblah.com>

Dear Anatoliy, 
I want you to do blahdy blahdy blah.

Amy Schwartz
(347) 555-1212 <---- I want this
Blahdy Blah Company 
```

The idea is to go through every email and match the last Phone number via regex and export a list in the following format:

*   Name: Name from the "From" field
*   Email: Email from the "From" field
*   Phone: The last phone number matched in the email text

Do you have any ideas on how to go about doing this?

UPDATE: Didn't find any prebuilt solutions, but I'm hacking together my own [using this](http://www.codetwo.com/freeware/outlook-export/). codeTwo Outlook Express. You can export any email field (body, HTML body, from, from name) to CSV. It's a little slow (3 seconds a message on my i7 iMac running a Win7 VM). But it works :) And from there I will probably just put in a database and do some regex magic. Will post process once I'm done.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T01:37:38.830

弄清楚了。如果您知道如何制作 Node.js 脚本（但我相信您可以用 Bash 编写），那将非常容易。

1) 使用[Outlook 导出](http://www.codetwo.com/freeware/outlook-export/)插件将所有电子邮件导出到 CSV。确保电子邮件是第一列，名称是第二列，正文（文本）是第三列。

2) 在与您的 CSV 电子邮件相同的目录中的 Node JS 中编写以下脚本

```
var fs = require('fs');
var csv = require('csv');
csv()
    .from.stream(fs.createReadStream(__dirname+'/data.csv'))
    .to.path(__dirname+'/out.csv')
    .transform( function(row){
      var match = row[2].match(/(?:\+?1\s*(?:[.-]\s*)?)?(?:\(\s*([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9])\s*\)|([2-9]1[02-9]|[2-9][02-8]1|[2-9][02-8][02-9]))\s*(?:[.-]\s*)?([2-9]1[02-9]|[2-9][02-9]1|[2-9][02-9]{2})\s*(?:[.-]\s*)?([0-9]{4})/);
        return '"' + row[0] + '","' + row[1] + '","' + (match ? match[0] : '') + '"\n';
    })
    .on('error', function(error){
      console.log(error.message);
    }); 
```

并使用`node script.js`.

就是这样！运行速度超快（20k 封电子邮件约 20 秒）。

如果您有任何建议，请告诉我（或将其打包成可下载的可执行文件）

# c# - asp.net 中的 HttpClient 调用

> ID：15300462
> 
> 赞同：1
> 
> 时间：2013-03-08T18:06:41.670
> 
> 标签：c#, asp.net

我在调用 HttpClient 类和异步调用时遇到问题。我从 page_load 调用函数 List()。调用从 HttpResponseMessage response = await client.GetAsync(str); 行返回 并且永远不会回来完成它。

我不明白我在做什么错误。以下是我的代码：

```
 protected void Page_Load(object sender, EventArgs e)
        {
            Task<string> s= List(product); 
        }

        protected async Task<string> List(string ProductType)
        {
            string str = "http://xx.xx.com/wiki/api.php";

            using (HttpClient client = new HttpClient())
            {
                client.DefaultRequestHeaders.Authorization = new System.Net.Http.Headers.AuthenticationHeaderValue("Basic", Convert.ToBase64String(Encoding.ASCII.GetBytes(String.Format("{0}:{1}", "username", "password"))));
                HttpResponseMessage response = await client.GetAsync(str);

                response.EnsureSuccessStatusCode();

                string content = await response.Content.ReadAsStringAsync();
            }
            return content;
         } 
```

它从不执行以下行。

```
response.EnsureSuccessStatusCode();
string content = await response.Content.ReadAsStringAsync(); 
```

请帮忙。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T18:56:52.473

你从来没有展示过任务发生了什么`Page_Load`，但考虑到你的症状和事实`Page_Load`并非如此`async`，我敢打赌你是在打电话`Result`，`Wait`而不是在打电话`await`。

当你这样做时，你[会导致一个 deadlock](http://blog.stephencleary.com/2012/07/dont-block-on-async-code.html)。我博客的链接详细解释了这一点，但要点是`await`捕获和恢复当前的“上下文”。在 ASP.NET 中，这是一个请求上下文，请求上下文一次只允许一个线程在其中执行。因此，如果您调用`Result`or `Wait`（当您在请求上下文中时），您将阻塞该请求上下文中的线程，直到`Task<string>`完成。同时，当`HttpClient`得到响应时，它会尝试在`await client.GetAsync(str)`. 但是请求上下文一次只允许一个线程进入，并且该线程被阻塞等待`Task`完成。由于`List`上下文繁忙而无法完成，因此您遇到了死锁。

为了防止死锁，请遵循以下两个[最佳实践（来自我最近的 MSDN 文章）](http://msdn.microsoft.com/en-us/magazine/jj991977.aspx)：

1.  `async`一路使用。也就是说，使用`await`代替`Result`or `Wait`。
2.  在您的“库”代码中使用`ConfigureContext(false)`，即`await`实际上`List`应该是`await ... .ConfigureAwait(false);`

# android - 如何在已解析的 XML 标记值上检查 Null

> ID：15300464
> 
> 赞同：3
> 
> 时间：2013-03-08T18:06:53.377
> 
> 标签：android, xml, android-layout, xml-parsing, android-listview

目前我正在构建这个android应用程序，让我难过的一件事是`ListView`所有按我需要的顺序显示的句柄项目，但是如果一个标签有一个空白值，它会显示为一个singleLine对象，只占用空间和间距布局。

![错误](../Images/e844c61cada30c063add212bdf96f877.png)

此图像 ListView 项目中的所有空间都是正在发送的 Null 字符串，我对其进行解析。我只想知道处理此错误的最佳方法？

我的 ListView 项目的 XML：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <TextView
        android:id="@+id/ContactTitle"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true"
        android:textAppearance="?android:attr/textAppearanceMedium"
        android:textColor="@color/White" />

    <TextView
        android:id="@+id/Name"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignRight="@+id/ContactTitle"
        android:layout_below="@+id/ContactTitle"
        android:layout_marginRight="17dp"
        android:textColor="@color/White" />

    <TextView
        android:id="@+id/MainPhone"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignRight="@+id/Name"
        android:layout_below="@+id/Name"
        android:textColor="@color/White"/>

    <TextView
        android:id="@+id/Cell"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignRight="@+id/MainPhone"
        android:layout_below="@+id/MainPhone"
        android:textColor="@color/White" />

    <TextView
        android:id="@+id/Fax"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/Cell"
        android:layout_below="@+id/Cell"
        android:textColor="@color/White" />

    <TextView
        android:id="@+id/Email"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/Fax"
        android:layout_below="@+id/Fax"
        android:ellipsize="marquee"
        android:textColor="@color/EmailColor" />

</RelativeLayout> 
```

我需要检查 Empty`TextViews`并隐藏它们。我的代码在这里：

```
protected void onPostExecute(String result) {
            String xml = result;
            String KEY_ITEM = "Contact";
            String KEY_CONTACTTITLE = "ContactTitle";
            String KEY_NAME = "Name";
            String KEY_MAINPHONE = "Phone";
            String KEY_CELLPHONE = "Cell";
            String KEY_FAX = "Fax";
            String KEY_EMAIL = "Email";
            ArrayList<HashMap<String, String>> menuItems = new ArrayList<HashMap<String, String>>();

            Document doc = getDomElement(xml);
            if (xml != null) {
                {
                    NodeList nl = doc.getElementsByTagName(KEY_ITEM);
                    for (int i = 0; i < nl.getLength(); i++) {
                        HashMap<String, String> map = new HashMap<String, String>();
                        Element e = (Element) nl.item(i);
                        if (getValue(e, KEY_CONTACTTITLE) != null) {
                            map.put(KEY_CONTACTTITLE,
                                    getValue(e, KEY_CONTACTTITLE));
                        } else {
                            TextView contactTitle = (TextView) findViewById(R.id.ContactTitle);
                        }
                        if (getValue(e, KEY_NAME) != null) {
                            map.put(KEY_NAME, getValue(e, KEY_NAME));
                        }
                        if (getValue(e, KEY_MAINPHONE) != null) {
                            map.put(KEY_MAINPHONE, getValue(e, KEY_MAINPHONE));
                        }

                        if (getValue(e, KEY_CELLPHONE) != null) {
                            map.put(KEY_CELLPHONE, getValue(e, KEY_CELLPHONE));
                        }

                        if (getValue(e, KEY_FAX) != null) {
                            map.put(KEY_FAX, getValue(e, KEY_FAX));
                        }

                        if (getValue(e, KEY_EMAIL) != null) {
                            map.put(KEY_EMAIL, getValue(e, KEY_EMAIL));
                        }

                        menuItems.add(map);
                        menuItems = simple;
                    }

                    String[] hashMapObjects = { KEY_CONTACTTITLE, KEY_NAME,
                            KEY_MAINPHONE, KEY_CELLPHONE, KEY_FAX, KEY_EMAIL };
                    int[] listItemObjects = { R.id.ContactTitle, R.id.Name,
                            R.id.MainPhone, R.id.Cell, R.id.Fax, R.id.Email };

                      ListAdapter adapter = new SimpleAdapter(
                      MoveContactsActivity.this, menuItems,
                      R.layout.listed_contacts, hashMapObjects,
                      listItemObjects);
                     setListAdapter(adapter); 
```

我正在尝试检查该值是否为 null 以将对象添加到`HashMap`. 这当然不起作用，我想知道如何检查`null` `TextViews`并隐藏它们。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T12:18:41.450

仅`View.setVisibility(View.GONE)`当`TextView`. 由于您正在使用`SimpleAdapter`并且没有自定义`getView`方法，因此最简单的方法是使用[`SimpleAdapter.ViewBinder`](http://developer.android.com/reference/android/widget/SimpleAdapter.ViewBinder.html)：

```
String[] hashMapObjects = { 
        KEY_CONTACTTITLE, KEY_NAME, KEY_MAINPHONE, KEY_CELLPHONE, KEY_FAX, KEY_EMAIL 
};

int[] listItemObjects = { 
        R.id.ContactTitle, R.id.Name, R.id.MainPhone, R.id.Cell, R.id.Fax, R.id.Email 
};

SimpleAdapter adapter = new SimpleAdapter(MoveContactsActivity.this, menuItems, R.layout.listed_contacts, hashMapObjects, listItemObjects);
SimpleAdapter.ViewBinder binder = new SimpleAdapter.ViewBinder() {
    @Override
    public boolean setViewValue(View view, Object object, String value) {
        if (!(view instanceof TextView)) {
            return false;
        }

        final TextView text = (TextView) view;

        text.setVisibility(TextUtils.isEmpty(value) ? View.GONE : View.VISIBLE);
        text.setText(value);

        return true;
    }
};

adapter.setViewBinder(binder);
setListAdapter(adapter); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T20:49:09.473

我不知道您的列表视图项目结构。

我的建议是：

检查标记是否为空并采取措施解决此问题，例如设置 TextView 可见性 = GONE。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-12T12:23:20.023

正如 William 所说，如果文本为 null 或为空，您可以扩展 Simple Adapter 以向视图添加可见性：

```
public class MyAdapter extends SimpleAdapter {

    public MyAdapter(Context context, List<? extends Map<String, ?>> data,
            int resource, String[] from, int[] to) {
        super(context, data, resource, from, to);
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
            if(convertView!=null) //reset the visibility if a convert view is used
                convertView.setVisibility(View.VISIBLE);

        View v = super.getView(position, convertView, parent);

        //text recovering from data source. here I check the name field
        //you can add any test and hide any views using views id and setVisibility method
        String displayedText = ((HashMap<String, String>) this.getItem(position)).get("Name"); 
        if( displayedText == null || displayedText.isEmpty())
            v.setVisibility(View.GONE);

        return v;
    }
} 
```

使用此类而不是 SimpleAdapter，然后您可以更改 getView 方法以在 ListView 的任何视图的任何字段上添加条件。

有关信息：getView 返回将显示在 ListView 中给定位置的视图，您可以根据数据源通过恢复给定位置的项目来更改这些视图中的任何内容。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-18T14:06:58.603

只需避免将空值添加到您的集合中，这些值会传递给适配器以填充列表视图

```
boolean elementFound = false;
for (int i = 0; i < nl.getLength(); i++) {
    HashMap<String, String> map = new HashMap<String, String>();
    Element e = (Element) nl.item(i);
    elementFound = false;
    if (getValue(e, KEY_CONTACTTITLE) != null) {
        map.put(KEY_CONTACTTITLE,
                getValue(e, KEY_CONTACTTITLE));
        elementFound = true;
    } else {
        TextView contactTitle = (TextView) findViewById(R.id.ContactTitle);
    }
    if (getValue(e, KEY_NAME) != null) {
        map.put(KEY_NAME, getValue(e, KEY_NAME));
        elementFound = true;
    }
    if (getValue(e, KEY_MAINPHONE) != null) {
        map.put(KEY_MAINPHONE, getValue(e, KEY_MAINPHONE));
        elementFound = true;
    }

    if (getValue(e, KEY_CELLPHONE) != null) {
        map.put(KEY_CELLPHONE, getValue(e, KEY_CELLPHONE));
        elementFound = true;
    }

    if (getValue(e, KEY_FAX) != null) {
        map.put(KEY_FAX, getValue(e, KEY_FAX));
        elementFound = true;
    }

    if (getValue(e, KEY_EMAIL) != null) {
        map.put(KEY_EMAIL, getValue(e, KEY_EMAIL));
        elementFound = true;
    }
    if(elementFound){
        menuItems.add(map);
    }
    //I don't understand whay are you doing this
    //menuItems = simple;
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-19T04:21:50.530

使用非空检查您的值，`String`例如：

```
if (getValue(e, KEY_NAME) != null && !getValue(e,KEY_NAME).toString().equalsIgnoreCase("")) {
 map.put(KEY_NAME, getValue(e, KEY_NAME));
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-03-19T04:42:21.340

您正在使用`SimpleAdapter`. 这很好，但我认为变更管理是软件的关键。您应该扩展`BaseAdapter`并且应该处理`getView`方法。

我知道`SimpleAdapter`实施起来很快，但是当变化来临时，它会骚扰你。如果您现在为[自定义适配器](https://stackoverflow.com/questions/8166497/custom-adapter-for-list-view)再编写一个文件，那么当更改到来时您会很放松。

```
ArrayList<HashMap<String, String>> data = new ArrayList<HashMap<String, String>>();

@Override
public View getView(int position, View convertView, ViewGroup parent) {

    ViewHolder holder;
    if (convertView == null) {

        convertView = infalter.inflate(R.layout.list_row, null);
        holder = new ViewHolder();
        holder.tvRawName = (TextView) convertView
                .findViewById(R.id.tvRawName );
        holder.tvRawEmail= (TextView) convertView
                .findViewById(R.id.tvRawEmail);
        convertView.setTag(holder);

    } else {
        holder = (ViewHolder) convertView.getTag();
    }

    try {
         if(data.get(position).get("Email")!=null && data.get(position).get("Email").length()>0)
         {
                holder.tvRawEmail.setVisibility(View.VISIBLE);
                holder.tvRawEmail.setText(data.get(position).get("Email"));
         }else
         {
                holder.tvRawEmail.setVisibility(View.GONE);
         }

    } catch (Exception e) {
        e.printStackTrace();
    }

//do like for all

    return convertView;
}

public class ViewHolder {
    TextView tvRawName;
    TextView tvRawEmail;
} 
```

# php - 只选择一个 从使用 Ajax/PHP 的外部页面

> ID：15300466
> 
> 赞同：0
> 
> 时间：2013-03-08T18:07:00.980
> 
> 标签：php, javascript, ajax, html, load

我有一个小问题。因此，我使用 Ajax 将另一个页面的内容加载`<div>`到`<select>`. 但问题是，我只想`<div>`将该外部页面中的特定内容加载到我的主页中。这是主页的代码：

```
<script type="text/javascript">
$(function(){
    createListeSelectWithDefault("categorie", <?php echo getJsCategorieListe()?>);
});
function showListes(str)
{
if (str=="")
  {
  document.getElementById("txtHint").innerHTML="";
  return;
  }
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
    document.getElementById("txtHint").innerHTML=xmlhttp.responseText;
    }
  }
xmlhttp.open("GET","liste_result?q="+str,true);
xmlhttp.send();
}
</script>
<div id="content">
    <div id="bloc">
        <div id="title">Combiner</div>
        <div class="mx">
            <form name="new_combiner">
                <select id="categorie" name="categorie" onchange="showListes(this.value)"></select>
            </form>
        </div>  
        <div class="mx">
            <div id="txtHint">

            </div>
        </div>
    </div>
</div> 
```

这是我的外部页面：

```
<html>
    <div> some other kind of text, no need to post it here, but can't take it away</div>
<div id="mainDiv">
    <?php
    $q=$_GET["q"];
    $liste = getListeByCategorie($q);
    echo "<table border='1'>
    <tr>
    <th>Titre</th>
    <th>Vues</th>
    </tr>";

    foreach($liste as $row)
    {
        echo "<tr>";
        echo "<td>" . $row->titre() . "</td>";
        echo "<td>" . $row->vue() . "</td>";
        echo "</tr>";
    }
    echo "</table>";
    ?>
</div>
           <div> some other kind of text, no need to post it here, but can't take it away</div> 
```

所以你去，仅此而已。我该怎么办？我只想`<div id="mainDiv">`将 加载到我的页面中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T18:13:57.840

请更彻底地研究 API。这个特定的用例已经介绍过了。

看这里：**[http](http://api.jquery.com/load/)**
://api.jquery.com/load/ （参见页面上标题为“加载页面片段”的部分）

从 API 页面：

```
$('#result').load('ajax/test.html #container'); 
```

这将**仅**将具有 id 容器的 div 从外部页面 test.html 加载到请求页面上具有 id 结果的 div 中。没有比这更简单的了（根据您的要求更改外部文档选择器）。

# openlayers - openlayers 集群策略 - 展示 1 个功能的集群的自定义图标

> ID：15300467
> 
> 赞同：-1
> 
> 时间：2013-03-08T18:07:03.107
> 
> 标签：openlayers

我有一个页面显示从**kml 文件**导入的**矢量图层**（基本上就像[日晷示例](http://openlayers.org/dev/examples/sundials.html)）。它运行得非常好，既可以仅使用固定策略，也可以同时使用固定策略和集群策略。

 **我想创建一个**混合显示**，而**“包含 1 个功能的集群”**将显示为包含在 KML 文件中的原始**自定义图标**`<Style><IconStyle><Icon><href>img/arrowRed.png`，例如。

现在，**如果我使用集群策略，则使用默认图标**（黄色磁盘）显示 1 个（功能）的集群。

我宁愿不使用任何不是标准开放层的插件或库。 **有什么建议么？**

下面是使用集群的原始javascript代码的一部分（删除集群策略声明`new OpenLayers.Strategy.Cluster()`和自定义图标显示就好了）：

```
var urlKMLClient = 'KMLClientsAll.kml'; 
var layerKMLClient = new OpenLayers.Layer.Vector("Clients", {
        strategies: [new OpenLayers.Strategy.Fixed(), new OpenLayers.Strategy.Cluster(), refresh],
        protocol: new OpenLayers.Protocol.HTTP({
            url: urlKMLClient,
            format: new OpenLayers.Format.KML({
                extractStyles: true, 
                extractAttributes: true,
                maxDepth: 2
            })
        })
    }); 
```

![无集群](../Images/99e422d4970730b4978aeb8188f4a86e.png)

请参阅下面的客户端自定义图标（绿色标记）让位于集群默认图标（黄色磁盘）

![带集群](../Images/8e96fc5be74d90e8a1a57ce521d26170.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-10T13:49:37.123

使用：`new OpenLayers.Strategy.Cluster({threshold:2})`这允许它们不在集群中的孤立点。

（是 GIS 论坛中同一问题的答案的重复）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T22:01:36.913

[在这个 GIS 问题](https://gis.stackexchange.com/questions/29425/how-to-access-the-icon-of-a-feature-retrieved-from-text-in-a-vector-layer)中找到了解决方案：

将集群策略更改为 MORE THAN 1。上面的代码将变为：

```
var clusterStrategy = new OpenLayers.Strategy.Cluster({ distance: 35, threshold: 2 });
var urlKMLClient = 'KMLClientsAll.kml'; 
var layerKMLClient = new OpenLayers.Layer.Vector("Clients", {
        strategies: [new OpenLayers.Strategy.Fixed(), clusterStrategy, refresh],
        protocol: new OpenLayers.Protocol.HTTP({
            url: urlKMLClient,
            format: new OpenLayers.Format.KML({
                extractStyles: true, 
                extractAttributes: true,
                maxDepth: 2
            })
        })
    }); 
```**

# php - jQuery AJAX form using mail() PHP script sends email, but POST data from HTML form is undefined

> ID：15300470
> 
> 赞同：14
> 
> 时间：2013-03-08T18:07:13.083
> 
> 标签：php, javascript, jquery, ajax, html

Thanks for taking the time to look, guys. I'm creating a pretty basic AJAX contact form using jQuery. The email sends, but upon opening the email there is no POST data, so I just get the strings I defined in the PHP script. On my phone's email client, the content of the email literally says 'undefined'. I've tried adding different types of header data to no avail, and a number of variations on the PHP mail() function.

I am more than willing to adopt an easier solution for a simple AJAX form, so thanks in advance for any new approaches.

Here is the form:

```
 <section id="left">
      <label for="form_name">Name</label>
      <input name="form_name" id="form_name" type="text" >

      <label for="form_email">Email</label>
      <input name="form_email" id="form_email" type="email" >
   </section>

   <section id="right">
      <label for="form_msg">Message</label>
      <textarea name="form_msg" id="form_msg"></textarea>
      <input id="submit" class="button" name="submit" type="submit" value="Send">
   </section>

</form> 
```

The jQuery AJAX:

```
$(function() {
    $("#contact .button").click(function() {
        var name = $("#form_name").val();
        var email = $("#form_email").val();
        var text = $("#msg_text").val();
        var dataString = 'name='+ name + '&email=' + email + '&text=' + text;

        $.ajax({
            type: "POST",
            url: "email.php",
            data: dataString,
            success: function(){
            $('.success').fadeIn(1000);
            }
        });

        return false;
    });
}); 
```

The PHP script (external file 'email.php'):

```
<?php
if($_POST){
    $name = $_POST['form_name'];
    $email = $_POST['form_email'];
    $message = $_POST['form_msg'];

//send email
    mail("email@gmail.com", "This is an email from:" .$email, $message);
}
?> 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-03-08T18:10:45.540

无需创建查询字符串。只需将您的值放入一个对象中，jQuery 将为您处理其余的事情。

```
var data = {
    name: $("#form_name").val(),
    email: $("#form_email").val(),
    message: $("#msg_text").val()
};
$.ajax({
    type: "POST",
    url: "email.php",
    data: data,
    success: function(){
        $('.success').fadeIn(1000);
    }
}); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-08T18:34:33.900

保留您的 email.php 代码相同，但替换此 JavaScript 代码：

```
 var name = $("#form_name").val();
        var email = $("#form_email").val();
        var text = $("#msg_text").val();
        var dataString = 'name='+ name + '&email=' + email + '&text=' + text;

        $.ajax({
            type: "POST",
            url: "email.php",
            data: dataString,
            success: function(){
            $('.success').fadeIn(1000);
            }
        }); 
```

有了这个：

```
 $.ajax({
        type: "POST",
        url: "email.php",
        data: $(form).serialize(),
        success: function(){
        $('.success').fadeIn(1000);
        }
    }); 
```

以便您的表单输入名称匹配。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-08T18:08:21.750

您使用了错误的帖子参数：

```
 var dataString = 'name='+ name + '&email=' + email + '&text=' + text;
                      ^^^^-$_POST['name']
                                       ^^^^--$_POST['name']
                                      etc.... 
```

javascript/html ID 与实际的 POST 无关，尤其是当您构建自己的数据字符串并且不使用相同的 ID 时。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-03-08T18:14:54.783

您使用了错误的参数名称，请尝试：

```
if($_POST){
    $name = $_POST['name'];
    $email = $_POST['email'];
    $message = $_POST['text'];

//send email
    mail("j.andrew.sears@gmail.com", "51 Deep comment from" .$email, $message);
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-08-20T11:02:00.993

你的代码应该是：

```
 <section id="right">
      <label for="form_msg">Message</label>
      <textarea name="form_msg" id="#msg_text"></textarea>
      <input id="submit" class="button" name="submit" type="submit" value="Send">
   </section> 
```

JS

```
var data = {
    name: $("#form_name").val(),
    email: $("#form_email").val(),
    message: $("#msg_text").val()
};
$.ajax({
    type: "POST",
    url: "email.php",
    data: data,
    success: function(){
        $('.success').fadeIn(1000);
    }
}); 
```

PHP：

```
<?php
if($_POST){
    $name = $_POST['name'];
    $email = $_POST['email'];
    $message = $_POST['text'];

//send email
    mail("email@gmail.com","My Subject:",$email,$message);
}
?> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-08T18:11:04.357

您的 PHP 脚本（外部文件 'email.php'）应如下所示：

```
<?php
if($_POST){
    $name = $_POST['name'];
    $email = $_POST['email'];
    $message = $_POST['text'];

//send email
    mail("j.andrew.sears@gmail.com", "51 Deep comment from" .$email, $message);
}
?> 
```

# objective-c - Why would my application fail to "unhide" (show)

> ID：15300472
> 
> 赞同：8
> 
> 时间：2013-03-08T18:07:24.227
> 
> 标签：objective-c, macos, cocoa

I'm investigating an issue on Mac OS X 10.8, and I am at the end of my wits. I'm not sure what to do next.

The application is 32 bit and has some Carbon calls in it.

Here is the problem: when I right-click the application icon in the dock, select the menu item "Hide", then, after the application has hidden, I select the "Show" menu item from the dock, and the problem occurs: the main document window does not appear (the palettes and menu do appear).

At this point, the "Show" menu item does not change to "Hide" even though the palettes have become visible.

I expect that the main document window becomes visible when I select "Show" from the application dock menu. Just like other Mac applications.

When it fails, I can make the main document window visible again if I use the App Exposé gesture on the Trackpad to show the document windows and select the main document window.

It works fine if I launch the application from the Terminal or from Xcode. The document window shows and the dock menu item for my application changes to "Hide" as expected. I launch the app from the terminal by navigating to the parent directory of the *.app, and typing `./MyApp.app/Contents/MacOS/MyApp`.

It fails when I have launched by double-clicking the application icon in the Finder.

My log messages from the application delegate's unhide functions appear when the application is launched from the Terminal and Xcode, but not when launched from the Finder.

```
– applicationWillUnhide:
– applicationDidUnhide: 
```

I have looked in the Console.app for any exceptions thrown (or any other messages). There are none.

* * *

**Update**:

To try and debug this, I launched from the Finder, and used Xcode to attach to the process.

I had suspected that an exception was being thrown and when I tested it using Xcode's "Exception Breakpoint" as well as putting a breakpoint on objc_exception_throw (just in case), it dd not break when I hide or "show" the application.

I then thought that I needed to prove that the `NSApplicationWillUnhideNotification` and `NSApplicationDidUnhideNotification` were being sent out. They are when I launch from Xcode or from the Terminal, but if I launch from the Finder, they are not.

I verified this by, after attaching Xcode to the application, putting a breakpoint via "Add Symbolic Breakpoint" for:

```
-[NSNotificationCenter postNotificationName:object:userInfo] 
```

And then, I added a Debugger Command: "po * (id*) ($esp+12)" to print out the first parameter to that selector (the notification name).

Which I found in an [answer posted here,](https://stackoverflow.com/questions/8174414/objective-c-print-method-parameters-with-gdb) in StackOverflow.

Using that, I can see the notifications that are posted after I choose the "Show" menu item. When I launch from Xcode/Terminal, I see the following notifications posted:

```
NSApplicationWillUpdateNotification, NSWindowDidUpdateNotification, NSApplicationDidUpdateNotification, ** NSApplicationWillUnhideNotification **, ..., ** NSApplicationDidUnhideNotification **, ..., NSApplicationWillBecomeActiveNotification, ... 
```

`NSApplicationWillUnhideNotification` is posted in this situation.

When I launch from the Finder, I see the following notifications are posted:

```
NSApplicationWillUpdateNotification, NSWindowDidUpdateNotification, NSApplicationDidUpdateNotification, NSApplicationWillBecomeActiveNotification, ... 
```

It does not send the `NSApplicationWillUnhideNotification`. Also, when I select "Show" from the Xcode-launched version, I see `-[NSApplication _doUnhideWithoutActivation]` in the backtrace. Putting a breakpoint for that function when I attach to the Finder-launched version does not result in a break when I select "Show".

Then, I thought to myself, perhaps the application thinks that it is not hidden.

I have a idle event handler, so from there I printed out the value of `[[NSApplication sharedApplicaton] isHidden]` while I Hide and "Show" the application.

For the problem situation, when the application is not hidden, it prints out `NO` for `isHidden`. When the application becomes hidden, it prints out `YES` for `isHidden`. When I select "Show" from the dock menu, it continues to print out `NO` for `isHidden`. It knows that it is hidden, but part of the application has been activated: the `NSPanels` and the `NSMenuBar` appear.

I can see the document window by entering into the application Exposé mode, and clicking the document window will make the window appear, but the dock menu item is still "Show" and `isHidden` is still `YES`.

The unhide mechanism works fine for a sample application, so I'm pretty sure that our code is doing something to shut this off.

* * *

I wonder what would be different between an application launched from the Terminal compared to an application launched from the Finder?

I had the application log the environment variables using `[[NSProcessInfo processInfo] environment]` and the only real difference I could see is that **PWD** exists in the variables for the Terminal application: I cannot see anything in our code that makes use of that.

I had the application log the command-line arguments via `[[NSProcessInfo processInfo] arguments]`, and I do see something different in the Finder-launched version. Both the Terminal and Finder launched versions list the path of the binary as the first argument; the Finder also lists a second paramter, "-psn_0_89445704". I have read online that it is something that Mac OS X adds to command-line arguments for GUI applications and I see it added to the command-line arguments for other applications that Hide and Show properly from the Dock menu.

Do you have any other thoughts that may lead me further towards solving this mystery? Thanks for any help or suggestions!

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-06-14T16:33:37.843

在与 AppKit 中的 Apple 工程师合作后，找到了解决方案。

在我们的应用程序中，出于各种原因，我们通过此方法“刷新”事件队列：

```
NSEvent* lastEvent = [NSEvent otherEventWithType:NSPeriodic
                                            location:NSMakePoint(0.0, 0.0)
                                            modifierFlags:0
                                           timestamp:[NSDate timeIntervalSinceReferenceDate]
                                        windowNumber:1
                                             context:NULL
                                             subtype:0
                                               data1:0
                                               data2:0];

    [[NSApplication sharedApplication] discardEventsMatchingMask:NSAnyEventMask beforeEvent:lastEvent]; 
```

Mac OS X 系统在启动时向应用程序发送“显示”事件。我们的*flush*函数在启动时被调用，它有效地从队列中删除了那个事件，但是Mac OS X的核心进程部分有它自己的内部队列，它跟踪显示和隐藏以及其他类型的事件类型，所以它不会' t 发送重复消息。（我会调查这个冲洗是否真的有必要）

问题是，当在*每个*`discardEventsMatchingMask:NSAnyEventMask`事件上调用时，它会清除应用程序的事件，但不响应核心进程的*显示*事件，因此核心进程认为它不需要再次发送显示事件。

 **这个特定问题的解决方案是在清除事件时更具选择性。在我的新实现中，我不会清除核心进程将发送的事件。

```
/* a bug in Apple's Core Process group forces me to isolate which events should be cleared as
        show|hide|activate|deactivate messages get sent by Core Process, but are not _marked_ as
     handled and so Core Process thinks that the "Show" event is still pending and will not send
     another */

    NSEvent* lastEvent = [NSEvent otherEventWithType:NSPeriodic
                                            location:NSMakePoint(0.0, 0.0)
                                            modifierFlags:0
                                           timestamp:[NSDate timeIntervalSinceReferenceDate]
                                        windowNumber:1
                                             context:NULL
                                             subtype:0
                                               data1:0
                                               data2:0];

    NSEventMask maskForEventsToDiscard = (NSPeriodic |
                                          NSLeftMouseDown |
                                          NSLeftMouseUp |
                                          NSMouseMoved |
                                          NSLeftMouseDragged |
                                          NSRightMouseDragged |
                                          NSMouseEntered |
                                          NSMouseExited |
                                          NSKeyDown |
                                          NSOtherMouseDown |
                                          NSOtherMouseUp |
                                          NSOtherMouseDragged);

    [[NSApplication sharedApplication] discardEventsMatchingMask:maskForEventsToDiscard
                                                     beforeEvent:lastEvent]; 
```

由于“显示”事件在发布时未清除，现在显示和隐藏工作！

*特别感谢 Apple 的 KF！*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T02:31:36.277

这种技术不适合发表评论，但我可能会建议与 DTrace 近距离接触。我在上面的评论中建议将 NSWindow 子类化并将 NSLog 语句放在 -orderOut: 等方法中。但是，为此使用 DTrace 可能会更有效——尽管正如您将看到的，知道您将要观察的对象的地址仍然很有用 – 好处是您不会乱扔代码一堆 NSLog 语句。

最简单的脚本可能是：

```
#pragma D option quiet

objc$target:NSWindow:-orderOut?:entry
{
    printf( "%30s %10s %x %x\n", probemod, probefunc, arg0, arg1 );
} 
```

并将通过执行以下操作使用应用程序的进程 ID 调用：

```
sudo dtrace -s dtrace_window.d -p9434 
```

在这种特殊情况下，arg0 将包含窗口的地址。不幸的是，从 DTrace 中获取窗口的标题或什至 NSString 的内容显然并非易事，但可能值得付出努力。我在[这里](https://stackoverflow.com/questions/15537677/printing-the-nswindow-title-in-a-dtrace-script)和[这里](https://stackoverflow.com/questions/15538623/how-to-print-a-nsstring-from-a-dtrace-script)确实有一个问题，看看是否有人知道做这些事情中的任何一件。（如果你能得到窗口的标题，你可以设置一个从窗口地址到字符串的映射。）

将探测器附加到您认为可能涉及的任何和所有方法、函数等将很容易，因此您可以尝试“跟踪事件”来解决此问题。

因此，最终，我建议继续添加 DTrace 探针，直到提供所需的提示来解决此问题。**

# c# - WPF 动画（同时缩放/翻译多个图像）

> ID：15300479
> 
> 赞同：0
> 
> 时间：2013-03-08T18:07:43.987
> 
> 标签：c#, wpf, animation

我正在使用 WPF 在 C# 中开发一个项目，以尝试制作一个类似于[http://www.scaleofuniverse.com/](http://www.scaleofuniverse.com/)的程序。

我知道它可以在 Flash 中轻松完成，但我想将控件集成到其他平台（即新的 Leap 运动和 Kinect）。我知道我可以安装它，以便 kinect 将按键模拟到 Flash 游戏上，但我真的很想弄清楚在 C# 中制作它。我完成了一些关于基本动画和故事板的基本教程，但我没有发现任何迹象表明我想要完成的项目甚至可以完成！我是不是咬得太多了，还是我在某处使程序过于复杂？我只是在设计阶段，所以我没有任何源代码供审查（仍在完成教程）。在我继续工作之前，我真的很想知道这个项目是否合理。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T18:20:55.997

它绝对可以在 WPF 中完成。这是 WPF [http://www.ab4d.com/ZoomPanel.aspx](http://www.ab4d.com/ZoomPanel.aspx)的自定义缩放控件的示例。

# java - 关于方法上的 Spring @Transactional 注释的一些说明

> ID：15300483
> 
> 赞同：41
> 
> 时间：2013-03-08T18:07:50.497
> 
> 标签：java, spring, hibernate, spring-mvc, annotations

我是 Spring 世界的新手，我开发了一个使用 Spring 3.2.1 和 Hibernate 4.1.9 来实现 DAO 的简单项目。该项目工作正常，但我对在此 DAO 的 CRUD 方法上使用**@Transactional** Spring 注释有一些疑问。

这是实现我的项目的 CRUD 操作的类的全部代码：

```
package org.andrea.myexample.HibernateOnSpring.dao;

import java.util.List;

import org.andrea.myexample.HibernateOnSpring.entity.Person;

import org.hibernate.Criteria;
import org.hibernate.HibernateException;
import org.hibernate.Session;
import org.hibernate.Transaction;
import org.hibernate.SessionFactory;
import org.hibernate.cfg.Configuration;
import org.hibernate.service.ServiceRegistry;
import org.hibernate.service.ServiceRegistryBuilder;
import org.springframework.transaction.annotation.Transactional;

public class PersonDAOImpl implements PersonDAO {

    // Factory per la creazione delle sessioni di Hibernate:
    private static SessionFactory sessionFactory;

    // Metodo Setter per l'iniezione della dipendenza della SessionFactory:
    public void setSessionFactory(SessionFactory sessionFactory) {
        this.sessionFactory = sessionFactory;
    }

    /** CREATE CRUD Operation:
     * Aggiunge un nuovo record rappresentato nella tabella rappresentato
     * da un oggetto Person
     */
    @Transactional(readOnly = false)
    public Integer addPerson(Person p) {

        System.out.println("Inside addPerson()");

        Session session = sessionFactory.openSession();

        Transaction tx = null;
        Integer personID = null;

        try {
            tx = session.beginTransaction();

            personID = (Integer) session.save(p);
            tx.commit();
        } catch (HibernateException e) {
            if (tx != null)
                tx.rollback();
            e.printStackTrace();
        } finally {
            session.close();
        }

        return personID;

    }

    // READ CRUD Operation (legge un singolo record avente uno specifico id):
    public Person getById(int id) {

        System.out.println("Inside getById()");

        Session session = sessionFactory.openSession();

        Transaction tx = null;          
        Person retrievedPerson = null;  

        try {
            tx = session.beginTransaction();
            retrievedPerson = (Person) session.get(Person.class, id);
            tx.commit();
        }catch (HibernateException e) { 
            if (tx != null)                 
                tx.rollback();          
            e.printStackTrace();
        } finally {                 
            session.close();
        }

        return retrievedPerson;
    }

    // READ CRUD Operation (recupera la lista di tutti i record nella tabella):
    @SuppressWarnings("unchecked")
    public List<Person> getPersonsList() {

        System.out.println("Inside getPersonsList()");

        Session session = sessionFactory.openSession();
        Transaction tx = null;
        List<Person> personList = null;

        try {
            tx = session.beginTransaction();
            Criteria criteria = session.createCriteria(Person.class);
            personList = criteria.list();
            System.out.println("personList: " + personList);
            tx.commit();
        }catch (HibernateException e) { 
            if (tx != null)                 
                tx.rollback();          
            e.printStackTrace();
        } finally {
            session.close();
        }
        return personList;
    }

    // DELETE CRUD Operation (elimina un singolo record avente uno specifico id):
    public void delete(int id) {

        System.out.println("Inside delete()");

        Session session = sessionFactory.openSession();
        Transaction tx = null;

        try {
            tx = session.beginTransaction();
            Person personToDelete = getById(id);
            session.delete(personToDelete);
            tx.commit();
        }catch (HibernateException e) { 
            if (tx != null)                 
                tx.rollback();          
            e.printStackTrace();
        } finally {
            session.close();
        }

    }

    @Transactional
    public void update(Person personToUpdate) {

        System.out.println("Inside update()");

        Session session = sessionFactory.openSession();
        Transaction tx = null;

        try {
            System.out.println("Insite update() method try");
            tx = session.beginTransaction();
            session.update(personToUpdate);

            tx.commit();
        }catch (HibernateException e) { 
            if (tx != null)                 
                tx.rollback();          
            e.printStackTrace();
        } finally {
            session.close();
        }   

    }

} 
```

好的，正如您所看到的，某些方法使用@Transactional 注释进行了注释。

我在这里阅读官方文档[http://static.springsource.org/spring/docs/3.2.x/spring-framework-reference/html/transaction.html](http://static.springsource.org/spring/docs/3.2.x/spring-framework-reference/html/transaction.html)关于在方法上使用这个注释，它看到：**A使用@Transactional 注释的方法必须具有事务语义**，但它对事务语义意味着什么？

这是否意味着必须将方法执行视为事务的执行？所以这意味着方法操作必须被视为可能导致成功或失败的单个操作，如果成功，则操作结果必须是永久的，而如果失败则返回到之前的状态交易的开始。

这是在方法上使用**@Transactional**注解的意思吗？

**addPerson()**方法的@Transactional 注释中的**readOnly = false**属性到底是什么意思？这意味着我也可以在数据库中写入一条记录（而不仅仅是读取它）还是什么？这个疑问是相关的，因为我知道，默认情况下，使用 @Transactional 注释定义的事务是**读/写**的，而不仅仅是读...我还尝试删除**(readOnly = false)**属性并且仍然可以正常工作（插入数据库表中的新记录）

 ******以下问题是：“为什么使用@Transactional 注释对某些方法进行注释，而对其他一些方法不进行注释？用@Transactional 注释所有CRUD 方法是一种好习惯吗？”

肿瘤坏死因子

安德烈亚

* * *

## 回答 #1

> 赞同：76
> 
> 时间：2013-03-08T18:19:51.053

首先，您不应该使 DAO 方法具有事务性，而是服务方法。

其次，使用 Transactional 是一种让 Spring 为您启动和提交/回滚事务的方法。所以你不应该自己开始和提交事务。

第三：这仅在您使用知道如何将 Hibernate 会话与事务关联的事务管理器（通常是 a `HibernateTransactionManager`）时才有效。会话工厂也应该由 Spring 处理，并由 Spring 在您的 DAO 中注入。DAO 的代码应如下所示：

第四：你不应该打开一个新的会话，而是获取当前的一个，通过 Spring 关联到当前事务。

```
public class PersonDAOImpl implements PersonDAO {

    @Autowired
    private SessionFactory sessionFactory;

    public Integer addPerson(Person p) {
        Session session = sessionFactory.getCurrentSession();
        Integer personID = (Integer) session.save(p);
        return personID;
    }

    public Person getById(int id) {
        Session session = sessionFactory.getCurrentSession();
        Person retrievedPerson = (Person) session.get(Person.class, id);
        return retrievedPerson;
    }

    @SuppressWarnings("unchecked")
    public List<Person> getPersonsList() {
        Session session = sessionFactory.getCurrentSession();
        Criteria criteria = session.createCriteria(Person.class);
        return criteria.list();
    }

    public void delete(int id) {
        Session session = sessionFactory.getCurrentSession();
        Person personToDelete = getById(id);
        session.delete(personToDelete);
    }

    public void update(Person personToUpdate) {
        Session session = sessionFactory.getCurrentSession();
        session.update(personToUpdate);
    }
} 
```

阅读[文档](http://static.springsource.org/spring/docs/3.1.x/spring-framework-reference/htmlsingle/spring-framework-reference.html#orm-hibernate)以获取更多信息。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2018-05-28T09:19:46.320

`@Transactional`在方法上使用。

我们首先在方法级别声明它打开事务，执行操作并关闭事务。

如果操作失败则回滚，如果操作成功则自动提交

这是关于`@Transactional`最后的注释和简短的。

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans" 
    xmlns:p="http://www.springframework.org/schema/p"
    xmlns:context="http://www.springframework.org/schema/context" 
    xmlns:tx="http://www.springframework.org/schema/tx" 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="
        http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
        http://www.springframework.org/schema/context
        http://www.springframework.org/schema/context/spring-context-3.0.xsd
        http://www.springframework.org/schema/tx
        http://www.springframework.org/schema/tx/spring-tx.xsd
        ">

    <!-- Scans the classpath for annotated components that will be auto-registered as Spring beans -->
    <context:component-scan base-package="hu.daniel.hari.learn.spring" />
    <!-- Activates various annotations to be detected in bean classes e.g: @Autowired -->
    <context:annotation-config />

    <!-- creating the internal datasource object -->

    <bean id="dataSource" class="org.springframework.jdbc.datasource.DriverManagerDataSource">
        <property name="driverClassName" value="org.hsqldb.jdbcDriver" />
        <property name="url" value="jdbc:hsqldb:mem://productDb" />
        <property name="username" value="sa" />
        <property name="password" value="" />
    </bean>

    <bean id="entityManagerFactory" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean"
            p:packagesToScan="hu.daniel.hari.learn.spring.orm.model"
            p:dataSource-ref="dataSource"
            >
        <property name="jpaVendorAdapter">
            <bean class="org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter">
                <property name="generateDdl" value="true" />
                <property name="showSql" value="true" />

            </bean>
        </property>
    </bean>

    <!-- Transactions -->
    <bean id="transactionManager" class="org.springframework.orm.jpa.JpaTransactionManager">
        <property name="entityManagerFactory" ref="entityManagerFactory" />
    </bean>
    <tx:annotation-driven transaction-manager="transactionManager" />

</beans> 
```

```
package hu.daniel.hari.learn.spring.orm.main;

import hu.daniel.hari.learn.spring.orm.model.Product;
import hu.daniel.hari.learn.spring.orm.service.ProductService;

import java.util.Arrays;

import org.springframework.context.support.ClassPathXmlApplicationContext;
import org.springframework.dao.DataAccessException;

public class SpringOrmMain {

    public static void main(String[] args) {

        //Create Spring application context
        ClassPathXmlApplicationContext ctx = new ClassPathXmlApplicationContext("classpath:/spring.xml");

        //Get service from context. (service's dependency (ProductDAO) is autowired in ProductService)
        ProductService productService = ctx.getBean(ProductService.class);

        //Do some data operation

        productService.add(new Product(1, "Bulb"));
        productService.add(new Product(2, "Dijone mustard"));

        System.out.println("listAll: " + productService.listAll());

        //Test transaction rollback (duplicated key)

        try {
            productService.addAll(Arrays.asList(new Product(3, "Book"), new Product(4, "Soap"), new Product(1, "Computer")));
        } catch (DataAccessException dataAccessException) {
        }

        //Test element list after rollback
        System.out.println("listAll: " + productService.listAll());

        ctx.close();
    }
} 
```******

# jquery-mobile - Jquery 移动页面加载确实运行 javascript，直到页面刷新之后

> ID：15300485
> 
> 赞同：0
> 
> 时间：2013-03-08T18:08:02.877
> 
> 标签：jquery-mobile

我在页面上包含了一个外部`javascript`文件`jquery` `mobile`。该`javascript`文件修改了一些在服务器上生成`html`的`css`片段。我尝试将`jquery`修改标记的代码放在以下`jquery` `mobile`事件中 -

```
pageinit, pagecreate, pageshow, pagebeforecreate 
```

但是该脚本不会在页面加载时修改加载的标记，但在页面刷新时，它可以完美运行。所以我试图找到一种在页面呈现之前进行修改的方法。任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T21:25:19.873

我已经解决了我的问题。我在索引页面上包含了所有外部文件`javascript`和`css`文件，并且效果很好。这是因为`jquery`移动`ajax`端在加载第一页之后通过 加载后续页面。

# android - Android代码：我正在尝试将字符串值从一个页面传递到另一个页面

> ID：15300486
> 
> 赞同：0
> 
> 时间：2013-03-08T18:08:04.873
> 
> 标签：android

我无法理解问题出在哪里，并且无法执行应用程序

进一步他们是我的代码

代码：pass1：-

```
public class Pass1 extends Activity {

    EditText pno=(EditText)findViewById(R.id.editText1);
Button btn=(Button)findViewById(R.id.button1);
String pn=pno.getText().toString();
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_pass1);

    btn.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {
            if(pn.charAt(0)=='9' || pn.charAt(0)=='8' || pn.charAt(0)=='7')
            {
                if (pno.getText().toString().length()==10)
                {
                 Intent i= new Intent(Pass1.this, Pass2.class);
                        i.putExtra("phoneno", pn);
                                startActivity(i);                   
                }
        }
        else
            pno.setError("The entered number is invalid!!");

            }               
        });
    }
} 
```

通行证2：-

```
public class Pass2 extends Activity {

EditText codetxt=(EditText)findViewById(R.id.editText1);

String ph=codetxt.getText().toString();

Button codebtn=(Button)findViewById(R.id.button1);

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        Intent i = getIntent();
        final String phn = i.getStringExtra("phoneno");

setContentView(R.layout.activity_pass2);
            codebtn.setOnClickListener(new View.OnClickListener() {

                @Override

public void onClick(View v) {
                // TODO Auto-generated method stub
                if(ph.charAt(0)==phn.charAt(0) && ph.charAt(1)==phn.charAt(5) && ph.charAt(2)==phn.charAt(4) && ph.charAt(3)==phn.charAt(9))
                {
                    if( codetxt.getText().toString().length()==4)
                    {
                        //code.setError("right number");
                        Intent i=new Intent(Pass2.this,Pass3.class);
                        startActivity(i);
                    }
                }
                else
                    codetxt.setError("Entered Code is wrong!"); 
            }
        });
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T18:14:28.023

移动此代码

```
 EditText pno=(EditText)findViewById(R.id.editText1);
Button btn=(Button)findViewById(R.id.button1);
String pn=pno.getText().toString(); 
```

在 setContentView() 行之后的 onCreate() 内。同样对于 Pass2

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T18:11:07.817

在您当前的 Activity 中，创建一个新的 Intent：

```
Intent i = new Intent(getApplicationContext(), NewActivity.class);
i.putExtra("new_variable_name","value");
startActivity(i); 
```

然后在新的 Activity 中，检索这些值：

```
Bundle extras = getIntent().getExtras();
if (extras != null) {
    String value = extras.getString("new_variable_name");
} 
```

在你的情况下

```
Bundle extras = getIntent().getExtras();
        final String phn = extras.getString("phoneno"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T18:17:09.083

你应该`findViewById()`在之后使用`setContentView()`

# python - Python/Aptana 列表问题

> ID：15300488
> 
> 赞同：0
> 
> 时间：2013-03-08T18:08:05.433
> 
> 标签：python, aptana3

我一直试图找出我的 Python/Aptana 配置有什么问题。
我一直在输入一个基本列表并运行它，但没有结果。运行程序后控制台什么也不显示，也没有发布错误，但控制台是空的。
我正在使用`Python 3.3.0`和`Aptana Studio 3`。

我的解释器是
`C:\Python33python.exe`，我的 PYTHONPATH 是

`System libs>C:\Python33.dlls>C:\Python33.lib>C:\Python33>C:\Python33\lib\site-packages`.

我的简单程序：

```
aList = [1,"john","Craig","car",3,6]
aList
aList[2] 
```

我到处找，包括stackoverflow，找不到答案。我知道这是基本的，但请帮忙。我的 PYTHONPATH 一定是错误的。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T18:53:04.773

不确定您的配置有什么问题，但是您的 python 代码没有返回任何内容。如果您试图查看 aList[2] 的输出：

```
aList = [1,"john","Craig","car",3,6]
aList
print aList[2] 
```

# xpages - ACL 更改后资源与文件系统不同步

> ID：15300492
> 
> 赞同：0
> 
> 时间：2013-03-08T18:08:26.367
> 
> 标签：xpages, lotus-domino

这似乎是 java 的常见错误。我搜索了错误，但找不到特定于 domino 和 ACL 问题的任何内容。

我的数据库中有几个 java 类。一个是 HttpServlet 类，另一个是 IHttpServlet 工厂。我还在数据库中添加了一个常规类进行测试。

每当我对 ACL 进行任何更改时，servlet 都将不再运行。如果打开了任何 java 源文档，则显示 Resource is out of sync with the file system: mydb.nsf 按 F9 或 Select File>Refresh 选择文件。该测试类也显示此消息。

我需要刷新文档并重建以使 servlet 运行。

我打算将此提交给技术支持，但我想我会先在这里问。希望这是一个可以轻松解决的问题。

# php - PHP 中的点对点文件共享

> ID：15300493
> 
> 赞同：0
> 
> 时间：2013-03-08T18:08:39.903
> 
> 标签：php, file, p2p, sharing

这个问题对我来说非常重要，因为我正在用 PHP 开发一个聊天系统，我希望允许用户通过某种点对点系统在他们之间共享文件。

现在我知道点对点有独立的协议，而 HTTP 不是其中之一，但我仍然认为这是可能的。

就像用户 A 和用户 B 都已连接，并且 A 想向 B 发送一个 1GB 的文件，有两种解决方案：

*   懒惰的：A将他的文件完全上传到服务器，然后B下载它，这使得服务器更像是一个“存储”服务器而不是聊天服务器。

*   我认为好的一个：用户A将文件发送给B，而在传输之前它实际上没有存储在服务器上。

这在PHP中可能吗？

先感谢您。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-08T18:23:59.980

让我们想想你的问题。

解决方案 1 如下所示：

```
User A <----->  Server -------> User B
                (PHP) 
```

即服务器给用户A一个上传表单，然后用户A向服务器发送一个文件。用户 B 从服务器获取文件。

解决方案 2 如下所示：

```
Server ----->  User A
Server ----->  User B
User A ----->  User B 
```

这一次，服务器给用户 A 和 B 一些代码，然后允许用户 A 与用户 B 通信。

需要明确的是，Server 不能是向 B 发送文件的那个，而且由于 Server 是 PHP 运行的唯一地方，所以不能使用 PHP 来发送文件。

用户 A 和 B 可以保证共享的语言是 Javascript。幸运的是，有一个非常新的规范可以解决这个问题，称为 WebRTC（RTC 代表实时通信）。

它旨在解决您遇到的问题，您应该使用它。它目前仅在 Chrome 和 Firefox Nightlies 中。最近，它变得足够稳定，Chrome 可以与 Firefox 对话，而不仅仅是 Chrome 与 Chrome 以及 Firefox 与 Firefox 对话。

应该清楚，这是相当新的！

根据您的项目和您正在做的事情的范围，这可能是也可能不是一个好的选择。

[http://www.webrtc.org/](http://www.webrtc.org/)可能会帮助你。

[https://webrtc-experiment.appspot.com/file-hangout/](https://webrtc-experiment.appspot.com/file-hangout/)是您尝试做的演示。

[https://webrtc-experiment.appspot.com/docs/how-file-broadcast-works.html](https://webrtc-experiment.appspot.com/docs/how-file-broadcast-works.html)是一些关于如何做的信息。

# java - Java 编辑器没有打开我的 Java 代码

> ID：15300494
> 
> 赞同：0
> 
> 时间：2013-03-08T18:08:41.820
> 
> 标签：java, editor, open-with

当我从 Project Explorer 中双击其中一个 .java 文件时，它不会在`Java Editor`. 我什至试图打开它，`Open With -> Java Editor`但无济于事。我什至确定`Windows -> Preferences -> General -> Editors`并将扩展名 .java 默认设置为`Java Editor`.

我刚刚完成了这个应用程序，我觉得我没有改变任何东西，现在我无法打开 .java 文件。如果您查看屏幕截图，您可以在红色框处看到文件似乎已打开并且在某个行号等处。有什么建议可以打开和查看这些文件吗？

![在此处输入图像描述](../Images/b32a439e746feaec3abff3b0e4d00293.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T18:47:49.167

在 Eclipse 中转到
`Window->Open perspective->Jave`
`Window->Reset perspective`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-25T10:49:51.577

在 IntelliJ 中，转到

> 设置 -> 文件类型 -> 在关联应用程序中打开的文件
> 
> 设置 -> 文件类型 -> Java 源文件

在其中任何一个中，如果在下部面板中显示一个异常并且您无法打开的文件的名称，只需将其删除并应用更改

# mysql - 我应该在方法调用之间关闭 mySQL 连接吗？

> ID：15300495
> 
> 赞同：0
> 
> 时间：2013-03-08T18:08:42.207
> 
> 标签：mysql, database

所以这个问题是一个好主意/坏主意的问题。我在很短的时间内多次使用 MySQL 连接。我创建了自己的方法调用来更新值、插入、删除等。

我为这些方法中的每一个重复使用相同的连接，但我在每次调用时打开和关闭连接。问题是我需要检查以确保连接未打开，然后再尝试再次打开它。

所以，问题是：在方法调用之间让 MySQL 连接保持打开状态有危险吗？我想让它保持打开状态，并可能在我使用它时提高速度。

感谢您的任何建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T18:20:16.123

一般来说，不，如果在同一个类/库/代码范围内你只是要再次打开它，你不应该关闭它。

这取决于您使用的收费/连接库。如果您使用连接池，则某些库实际上不会（立即）关闭连接，而是将其返回到池中。

关于重用连接，我要发表的唯一评论是，如果您使用的是特定于连接的变量，那么这些变量对于同一个连接仍然有效，并且如果另一个查询使用其中一个并且它有一个值，以后可能会导致问题来自不再依赖的过去查询 - 但是这也会首先引发有关变量适用性的问题。

在 MySQL 中打开连接是相当轻的（与其他数据库相比），但是如果可以避免的话，您不应该创建额外的工作。

# android - 洗牌适配器

> ID：15300497
> 
> 赞同：0
> 
> 时间：2013-03-08T18:08:46.320
> 
> 标签：android, shuffle, android-adapter

我正在使用`Adapter`：

```
final ArrayAdapter<String> adapter = new ArrayAdapter<String>(this,
            android.R.layout.simple_list_item_1, android.R.id.text1); 
```

我想改组它的内容，但是我发现这`Collections.shuffle(adapter);`不起作用。还有另一种方法可以做到这一点吗？在保持`adapter`ie 的格式的同时不将其更改为`List`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T18:12:32.617

当然`Collections.shuffle(adapter)`不起作用..shuffle 需要一个 java.util.List... Java Collections API 对 Android API 一无所知...

您需要打乱基础列表，然后告诉适配器数据已更改..类似于：

```
Collections.shuffle(myList);
adapter.notifyDataSetChanged(); 
```

# c# - 如何创建未指定的文件路径

> ID：15300498
> 
> 赞同：0
> 
> 时间：2013-03-08T18:08:49.923
> 
> 标签：c#, winforms, file-io

我需要将 file.pdf 复制到我的 Winforms 应用程序中的 AppData 文件夹，但由于这将被很多人使用，我需要一个通用路径来找到

```
iFile.CopyTo("somethinghere...//AppData//Temp//file.pdf"); 
```

并复制上述文件。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-08T18:12:00.707

`Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData)`将获取当前用户的 appdata 文件夹。

如果您想为所有用户提供一份 PDF 副本，请`Environment.GetFolderPath(Environment.SpecialFolder.CommonApplicationData)`改用。

[MSDN on Environment.GetFolderPath](http://msdn.microsoft.com/en-us/library/system.environment.getfolderpath.aspx)
[MSDN on Environment.SpecialFolder](http://msdn.microsoft.com/en-us/library/system.environment.specialfolder.aspx)

# android - 标签覆盖标签覆盖，同时在 cocos2d android 中显示健康标签

> ID：15300500
> 
> 赞同：1
> 
> 时间：2013-03-08T18:09:06.880
> 
> 标签：android, cocos2d-iphone, cocos2d-android

我必须在我的游戏中展示玩家的生活。每次玩家击中错误的敌人，生命就会减少。默认生命是 5。

我的代码如下

首先我在我的游戏层中声明这个

```
static int lifes=5;
CCLabel _lifes; 
```

然后在代码底部的方法如下

```
public void showLable(CCLabel _lifes){

     if(_lifes != null){
            this.removeChild(_lifes,true);
        }

     _lifes = CCLabel.makeLabel("" + lifes, "Verdana", 20);
        _lifes.setColor(ccColor3B.ccbrown);
        _lifes.setPosition(winSize.width/2,(winSize.height/2));
        addChild(_lifes,3)
    } 
```

然后我写了这个条件，玩家击中了错误的敌人

```
lifes--;
showLable(_lifes); 
```

1）一切正常，标签显示并且标签减少，但标签直到玩家击中错误的敌人才会显示，如你所见，我将默认值设置为 5，标签在玩家击中错误的敌人后显示，即，从 4 开始。

2）另一个主要问题是显示的标签在显示时没有删除以前的值。例如。生命值默认为 5。游戏开始时显示5。当生命值减少时生命值应该是 4，所以在我的游戏中，4 放在 5 上。然后将生命放在与 3 或 2 或 1 相同的数字上。所有数字相互显示。现在我想你理解我了

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T19:56:48.997

1）在游戏初始化后检查您是否 `showLable(_lifes);`在游戏开始时调用，因此标签显示为值 5。

2) 我不太确定，但**CCLabel**应该扩展一个**CCSprite**，因此有一个 setVisible 方法。您可以尝试以下方法：

```
 if(_lifes != null){
        _lifes.setVisible(false);
        this.removeChild(_lifes,true);
    } 
```

我只找到了 c++ api 参考版本： http: [//www.cocos2d-x.org/reference/native-cpp/d4/de7/classcocos2d_1_1_c_c_sprite.html](http://www.cocos2d-x.org/reference/native-cpp/d4/de7/classcocos2d_1_1_c_c_sprite.html)

# r - 在没有特殊权限的情况下远程安装 R 包。又名在 /tmp/ 中安装 R 包造成的损坏

> ID：15300503
> 
> 赞同：1
> 
> 时间：2013-03-08T18:09:22.090
> 
> 标签：r, path, installation, packages, distributed-computing

我在集群上分配作业，我不想去每台机器手动安装正确的包。作业控制器以无人身份运行脚本，因此我必须为安装指定无可争议的可写路径。我实际上有这个工作解决方案：

```
`%ni%` = Negate(`%in%`) ### "not in"
.libPaths("/tmp/") ### for local (remote non super user) install of packages
if ("xxx" %ni% installed.packages()) {install.packages("xxx", repos = "http://cran.r-project.org", lib="/tmp/")}
# ... and more
library(xxx)
# ... and more 
```

起初它有效，但一周后我遇到了一个奇怪的问题。

```
> library(xxx)
Error in library(xxx) : there is no package called 'xxx' 
```

xxx（和其他包）在 installed.packages() 的清单中，.libPaths 报告路径上的 /tmp/，ls 在 /tmp/ 中显示包的文件夹。使用 install.packages 重新安装会引发错误，remove.package、update.package 和 find.package 也是如此。

两个问题：我应该以不同的方式管理远程安装吗？
任何想法是什么导致我无法加载包的问题？

请让我不必实施像

```
locdir <- paste("/tmp/", as.integer(runif(1, 1, 100000)), sep='')
system(paste("mkdir", locdir))
.libPaths(locdir)
install.packages("xxx", repos = "http://cran.r-project.org", lib=locdir)
library(xxx) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T21:16:29.680

您可能需要 option `character.only = TRUE`，尽管您的代码以前有效但现在不再有效，这很奇怪。无论如何，试试这个功能：

```
packageLoad<-function(libName){
    # try to load the package
    if (!require(libName,character.only = TRUE)){ 
      # if package is not available, install it
      install.packages(libName,dep=TRUE, 
         repos="http://cran.r-project.org",lib="/tmp/",destdir="/tmp/")
      # try again
      if(!require(libName,character.only = TRUE)) 
         stop(paste("Package ",libName," 
            not found and its installation failed."))
    }
} 
```

# c# - 如何在asp.net的字符串变量中执行动态创建的html代码

> ID：15300504
> 
> 赞同：-3
> 
> 时间：2013-03-08T18:09:24.333
> 
> 标签：c#, asp.net, html, runtime

[我在 C# 的字符串](http://msdn.microsoft.com/en-us/library/system.string.aspx)变量中有一些 HTML 代码。

该代码在运行时生成并存储在[String](http://msdn.microsoft.com/en-us/library/system.string.aspx)变量中。但现在我想在运行时执行这段代码。我想做的就是看看该代码在浏览器中的外观。

我怎样才能做到这一点？

asp.net 中是否有提供此类功能的控件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T18:11:02.963

您可以使用任何控件，例如`panel` `literal`.

假设你有一个字符串

```
string str="<p><div>Some Text</div></p>";
Literal1.Text = str; 
```

## html

```
 <asp:Literal ID="Literal1" runat="server"></asp:Literal> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T18:19:44.593

**在您的 .aspx 中放置带有属性runat=server**的 html 标记（div、段落、标签等）

 **```
 <p id="dynamicstring" runat="server"></p> 
```

在代码隐藏中

```
 dynamicstring.InnerText= yourstring; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T18:27:33.367

您可以使用 StringBuilder 然后简单地使用 Response.Write 为 StringBuilder**

# html - 音频回退有问题

> ID：15300507
> 
> 赞同：-1
> 
> 时间：2013-03-08T18:09:41.310
> 
> 标签：html

我正在尝试在 Firefox 或 Google Chrome 以外的其他浏览器中使用 HTML5 音频标签，但它似乎不起作用。任何帮助将不胜感激。该控件显示在 Firefox 中，但它似乎没有播放该文件。

这是我的代码：

```
 <audio id="audioplayer" preload controls loop style="width:424px;">
 <source src="02-24-13 Ed Randall with Art Shamsky.mp3" type="audio/mpeg">
 Your browser does not support the audio element.
 </audio>
 <script type="text/javascript">
 var audioTag = document.createElement('audio');
 if (!(!!(audioTag.canPlayType) && ("no" != audioTag.canPlayType("audio/mpeg")) && ("" != audioTag.canPlayType("audio/mpeg")))) {
 AudioPlayer.embed("audioplayer", {soundFile: "02-24-13 Ed Randall with Art Shamsky.mp3"});
 }
 </script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T18:35:19.703

火狐浏览器不支持符合 MDN mp3 格式。看看[这个](https://developer.mozilla.org/en-US/docs/HTML/Supported_media_formats)

# asp.net - 在 app.config 文件中传递十六进制值

> ID：15300512
> 
> 赞同：2
> 
> 时间：2013-03-08T18:10:17.520
> 
> 标签：asp.net, .net, web-services, c#-4.0, app-config

我正在开发 ac# web 服务。我有一个特殊要求，我需要在我的代码中配置一个十六进制值。我需要将这个十六进制值复制到一个字节变量中。我正在尝试通过 appSettings 在 app.config 文件中传递它。

例如

```
byte ASCII_VALUE = 0xA5; 
```

我想从 app.config 文件中获取这个 0xA5 并将其复制到 ASCII_VALUE。

我目前在 app.config 文件中使用以下代码：

```
<appSettings>
  <add key="Ascii_value" value="0xA5"/>
</appSettings> 
```

在我的 c# 代码中，我正在做：

```
byte ASCII_VALUE = (byte)ConfigurationManager.AppSettings["Ascii_value_for_pound"]; 
```

但由于这是一个字符串，它不会直接将其转换为字节值。

我也试过

```
<appSettings>
  <add key="Ascii_value" value="&#xA5;"/>
</appSettings> 
```

和 c# 中的相同代码。但我仍然无法弄清楚如何获得十六进制值。

任何想法伙计们？？？请帮忙。

提前非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T19:47:23.553

此外，您可能想看看[SoapHexBinary](http://msdn.microsoft.com/en-us/library/system.runtime.remoting.metadata.w3cxsd2001.soaphexbinary%28v=vs.80%29.aspx)，它直接解析十六进制字符串并为您提供字节值及其`Value`属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T18:30:37.837

我想到了。

需要做的是

在 app.config 中

```
<add key="Ascii_value" value="A5"/> 
```

在c#中

```
string strAsciiValue = ConfigurationManager.AppSettings["Ascii_value"];
int intAsciiValue = Int32.Parse(strAsciiValue, System.Globalization.NumberStyles.HexNumber);
byte ASCII_VALUE = (byte)intAsciiValue; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T18:15:22.810

你试过`Byte.Parse`吗？

这是 MSDN 链接：http: [//msdn.microsoft.com/en-GB/library/4eszwye3.aspx](http://msdn.microsoft.com/en-GB/library/4eszwye3.aspx)

您可以覆盖该方法以接受十六进制。

这是 MSDN 示例： `byte val = Byte.Parse(num, NumberStyles.HexNumber);`

# c# - LookUpEdit 在失去焦点事件后失去其价值

> ID：15300515
> 
> 赞同：1
> 
> 时间：2013-03-08T18:10:24.773
> 
> 标签：c#, winforms, devexpress

DevExpress LookUpEdit 控件在失去焦点后立即失去其价值。

一个人如何保持它的价值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T18:13:51.370

在其他地方找不到答案......只是想分享它。（适用于我的 LookUpEdit，也许对 Combo 也一样）

就我而言，在定义与对象源的绑定时，如果源属性可以为空，则必须像这样定义它：

```
myLookUpOrCombo.DataBindings.Clear();
myLookUpOrCombo.DataBindings.Add("EditValue", myObjectSource, "IdOfaForeignKey", true, DataSourceUpdateMode.OnPropertyChanged, null); 
```

否则事件会有点尴尬。

# python - 从列表编译时，Python正则表达式仅替换第一个字符

> ID：15300516
> 
> 赞同：0
> 
> 时间：2013-03-08T18:10:26.093
> 
> 标签：python, regex, django

我正在创建一个 django 过滤器，用于将“a”标签插入到列表中的给定字符串中。

这是我到目前为止所拥有的：

```
def tag_me(text):
    tags = ['abc', 'def', ...]
    tag_join = "|".join(tags)
    regex = re.compile(r'(?=(.))(?:'+ tag_join + ')', flags=re.IGNORECASE)
    return regex.sub(r'<a href="/tag/\1/">\1</a>', text) 
```

例子：

```
tag_me('some text def') 
```

回报：

```
'some text <a href="/tag/d/">d</a>' 
```

预期的：

```
'some text <a href="/tag/def/">def</a>' 
```

问题在于 regex.sub 匹配但仅返回第一个字符。我在最后一行捕获/使用 \1 的方式有问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T18:47:44.963

请注意，`(?: ...)`问题中的序列专门关闭捕获。请参阅[`re`文档](http://docs.python.org/2/library/re.html)（大约 1/5 通页），其中（重点添加）说：

> `(?:...)` 常规括号的非捕获版本。匹配括号内的任何正则表达式，但**组匹配的子字符串在执行匹配后无法检索**或稍后在模式中引用。

如上一个答案中所述，如果在目标文本中使用了转义，则可以使用`'('+ tag_join + ')'`或使用建议的版本。`"|".join(re.escape(tag) for tag in tags)`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-08T18:18:30.937

您正在捕捉`(.)`只有一个角色的部分。

我不确定我是否遵循您的正则表达式 - 简化版本`r'('+ tag_join + ')'`适用于您的示例。

请注意，如果您的标签名称中可能包含字母数字字符以外的任何字符，您需要这样做：

```
tag_join = "|".join(re.escape(tag) for tag in tags) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-08T18:41:33.263

简单地做

```
import re

def tag_me(text):
    tags = ['abc', 'def']
    reg = re.compile("|".join(tags).join('()'),
                       flags=re.IGNORECASE)
    return reg.sub(r'<a href="/tag/\1/">\1</a>', text)

print '            %s' % tag_me('some text def')
print 'wanted:     some text <a href="/tag/def/">def</a>' 
```

那是因为你写了一个非捕获组`(?:....)`，然后你必须把这个令人不安的东西`(?=(.))`放在前面。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-08T18:47:25.960

这应该这样做

```
def tag_me(text):
    tags = ['abc', 'def', ]
    tag_join = "|".join(tags)
    pattern = r'('+tag_join+')'
    regex = re.compile(pattern, flags=re.IGNORECASE)
    return regex.sub(r'<a href="/tag/\1/">\1</a>', text) 
```

# java - 为什么 Java Date 有一个小时的“GB”时间？

> ID：15300517
> 
> 赞同：1
> 
> 时间：2013-03-08T18:10:38.530
> 
> 标签：java

我们遇到了一些 Java 数据函数的问题，Java 似乎认为伦敦在 DST 中，只是我不确定为什么，他们不是。以下是显示问题的代码片段。

```
 public static void main(String[] args) {
    TimeZone t = TimeZone.getTimeZone("GB");
    TimeZone.setDefault(t);
    Date d = new Date(38182478);
    System.out.println(d.toString());
} 
```

输出为

```
Thu Jan 01 11:36:22 GMT 1970 
```

我本来期望的地方

```
 Thu Jan 01 10:36:22 GMT 1970 
```

为什么会这样？

# asp.net - 试图在 Jquery UI 自动完成中显示值和描述，不显示数据，我做错了什么？

> ID：15300520
> 
> 赞同：1
> 
> 时间：2013-03-08T18:10:39.523
> 
> 标签：asp.net, jquery-ui, jquery, webmethod

我一直在寻找尝试解决我的问题。我想它可能在我的后端，但不确定。我正在尝试使用自动完成来填写文本框，但在下拉列表中显示带有值的描述。

**我获取数据的方法：**

```
[WebMethod]
public static ArrayList GetQueries(string id)
{
    queries q;
    var cs = Global.CS; 
    var con = new SqlConnection(cs);
    var da = new SqlDataAdapter(querystring, con);
    var dt = new DataTable();
    da.Fill(dt);

    ArrayList rows = new ArrayList(dt.Rows.Count);
    for (int i = 0; i < dt.Rows.Count; i++)
    {
        var val = dt.Rows[i]["Query_ID"];
        var des = dt.Rows[i]["Description"];

        q = new queries();
        q.label = val.ToString();
        q.value = val.ToString() + " -- " + des.ToString();

        var json = new JavaScriptSerializer().Serialize(q);

        rows.Add(json);
    }
    return rows;
}

public class queries
{
    public string label { get; set; }
    public string value { get; set; }
} 
```

它正在返回一个数组列表。

**我的 JQuery 方法来获取数据和自动完成。**

```
$("[id$=QueryManager]").change(function () {
    var id = $("[id$=QueryManager] :selected").val();
    $.ajax({
        type: 'POST',
        url: 'Upload.aspx/GetQueries',
        data: JSON.stringify({ id: id }),
        contentType: 'application/json; charset=utf-8',
        dataType: 'json',
        success: function (data) {
            fillit(data);
        },
        error: function (ex) {
            alert('Request Status: ' + ex.status + '\n\nStatus Text: ' + ex.statusText + '\n\n' + ex.responseText);
        }
    });
});

    function fillit(data) {
        $("#QueryTxt").autocomplete({
            delay: 0,
            minLength: 0,
            source: function (data, response) {                
                response($.map(data, function (item) {
                    return {
                        label: item.label,
                        value: item.value
                    }
                }));
            }                
        });
    }; 
```

我已经尝试过序列化并且没有结果。当此代码运行时，它显示自动完成功能正在工作（通过下面显示的框），但其中没有数据。

我不确定我做错了什么，感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T18:47:00.310

我在下面所做的是，在“选择”事件中，我获取从查询返回的值，并将下拉文本设置为返回数据中的描述和 Id 值。然后我将一个虚拟文本框的值设置为描述。“colDescName”只是我用作文本框 ID 的变量。

> ```
>  $("#" +colDescName).autocomplete({
>                 minLength: 2,
>                     select: function( event, ui ) 
>                     {
>                         var rowElement=event.target.id;//Drop down Id
>                         setTimeout(function()
>                         {
>                               $("#"+rowElement).val(ui.item.value+':'+ui.item.id)
>                         },100);//need a slight delay here to set the value
>                         $("#TextBoxId").val(ui.item.value);
>                         //ui.item.value  is the description in the drop down.
>                         //ui.item.id  is the Id value from the drop down
>                     },
>                 source: function (request, response) {
>                     var term = request.term;
>                     if (term in cache) {
>                         response(cache[term]);
>                         return;
>                     }
>                     lastXhr = $.getJSON("Upload.aspx/GetQueries", request, function (data, status, xhr) {
>                         cache[term] = data;
>                         if (xhr === lastXhr) {
>                             response(data);
>                         }
>                     }).error(function () {
>                         console.log("error"); 
>                         }); 
>                 } 
>             }); 
> ```

您有更改方法的“$("[id$=QueryManager]")” 是什么对象？如果您可以使用上面的代码，您是否需要更改事件？

**编辑** 确定一个更简单的方法是在“QueryManager”管理器下拉菜单上执行任何更改事件之前，将文本框“$("#QueryTxt")”设置为自动完成框。然后，当您的 "QueryManager" 中确实发生更改事件时，请调用：

> $(this).autocomplete('search', '你的数据在这里');

然后将执行搜索功能并使用您所需的数据调用自动完成的 url

# .net - 在进行 BDD 时，我必须先对通过验收测试所需的每段代码进行 TDD 吗？

> ID：15300521
> 
> 赞同：5
> 
> 时间：2013-03-08T18:10:39.797
> 
> 标签：.net, testing, tdd, bdd, atdd

周末有人给了我一个 kata 工作。在开始之前，我真的只是想收集一些想法。我不是在寻找解决方案，只是关于最佳方法/实践的一些想法。

从我的谈话来看，我似乎需要使用 BDD --> ATDD（与 gherkin 中的场景相关） --> TDD 方法。我只是想找出最好的方法。

我目前的想法是

1）创建一个specflow项目并将用户故事提炼成一个小黄瓜。

2）使用 GWT 语法在小黄瓜（场景）中创建相关的验收测试，从而在 [binding] 类中生成我的 ATTD 样式测试（右键单击“生成”）。

3) 使小黄瓜 ATDD 测试通过。

我遇到的难题是，直接链接到我的小黄瓜文件中的 ATTD 测试的测试没有给我足够低级别的测试。

那我该怎么办？我要编写高级 ATDD 测试，然后在使它们通过之前，我是否深入挖掘并编写纯 TDD 测试来设计我的低级对象？

是的，我还没有弄清楚如何以完全 BDD 方式（纯风格）工作，但我只是想知道我是如何挖掘的。我很欣赏您应该逐步工作并完成一项测试并通过，但我觉得我需要从高级 ATDD 测试开始，然后更深入，所以在我使低级代码工作之前，更高级别的测试将无法工作，但要遵循TDD 我需要测试那个低级代码，所以我已经打破了 1 个单元测试然后通过然后重构的原则......

希望有人明白如何告诉我“如何”在没有实际操作的情况下解决这个问题。但这是提供给我的问题......（我很感激如果测试人员看到这一点，他们可能会因为在这里问我而失败，但更重要的是我学习而不是得到这份工作）。是的，我知道我很生气 :-)

我也很想知道我是否应该为我的纯 TDD 测试创建一个单独的项目。最好的项目结构是什么？我正在考虑 1 个 specflow 项目和一个 .test 项目以及一个类库和一个用于运行时的控制台应用程序。

PS任何帮助我的人都有我欠他们的人情。拥抱或慈善捐赠。或者我想这里的 +1 是你真正想要的：-/

剪刀石头布

```
User Story Front
+--------------------------------------------------+
|                                                  |
|     Title: Waste an Hour Having Fun              |
|                                                  |
| As a frequent games player,                      |
| I'd like to play rock, paper, scissors           |
| so that I can spend an hour of my day having fun |
|                                                  |
| Acceptance Criteria                              |
|  - Can I play Player vs Computer?                |
|  - Can I play Computer vs Computer?              |
|  - Can I play a different game each time?        |
|                                                  |
+--------------------------------------------------+

User Story Back
+--------------------------------------------------+
|                                                  |
| Technical Constraints                            |
|                                                  |
| - Doesn't necessarily need a flashy GUI          |
|   (can be simple)                                |
| - Can use any modern language                    |
|                              |
| - Libs / external modules should only be used    |
|   for tests                                      |
| - Using best in industry practices               |
|                                                  |
+--------------------------------------------------+ 
```

不懂游戏？[http://en.wikipedia.org/wiki/Rock-paper-scissors](http://en.wikipedia.org/wiki/Rock-paper-scissors)

我正在寻找一个缩小版本（想想最小的可行产品）。没有数据库（即会话存储），简单的界面 - 2 或 3 小时的工作（顶部）是完全合理的。我不是在寻找一个完整的东西，只是一个精心制作的小东西。如果这是 Java 而不是 .NET，并且更面向后端，我会使用控制台应用程序。在 C# 中寻找单元测试和精心设计的代码。我正在寻找的是碰巧使用 C# ASP.Net MVC 的编码器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-02-03T12:11:24.127

在做 BDD 时可以严格遵循 TDD，但你不必，我也不必。

BDD 说编写验收测试并通过单元测试排除细节。因此，在为某个功能编写验收测试后，您可以

*   编写使验收测试通过（然后重构）所需的所有代码，或

*   想想你需要哪些类和这样的类来使验收测试通过，对它们中的每一个进行 TDD（即为它们中的每一个编写单元测试，使这些测试通过，然后重构），然后运行验收测试以确保它通过（和重构）。

不管遵循这两种方法中的哪一种，一种是通过编写单元测试来测试那些不值得自己进行验收测试的需求。但是，第一种方法不需要返回并为实现验收测试时创建的每个类编写单元测试。

我使用第一种方法，因为

*   更容易思考。它不需要太多的预先设计，也不需要在验收和单元测试之间进行上下文切换。

*   它只创建使验收测试通过所需的代码。我总是发现在接受之前（或不接受）编写单元测试会导致错误的猜测和额外的代码。

*   它不会两次测试任何要求。最小化的测试套件更快更容易维护。

我可以看到的第二种方法的优点是

*   它分解了使验收测试通过所需的工作。（但是，使用我使用的工具和我从事的应用程序，我通常不会有问题，只需一次实施验收测试。如果我这样做了，我会在第一遍中偷工减料，然后回去填写第二遍。）

*   每个类总是有一个单元测试，因此很容易找到一个测试来运行，以确保在更改给定类时没有破坏它。（但无论如何，您必须尽快找到并运行相关的验收测试。）

关于项目结构，我总是发现最好将各种测试与代码放在同一个项目、存储库等中。眼不见，心不烦。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-02-01T12:51:28.280

来自 WordPress 后端世界的想法 [是的，这是一件事]...

**你在做BDD！**实际上，您正在讨论的这种二分法在我看来是进行 BDD 的主要方面之一。一般来说，验收测试比单元测试更慢、更脆弱、更不集中。通常，您使用浏览器测试的内容可以通过另一种方式进行测试，例如使用 API 测试或单元测试。通常最好减少对浏览器或端到端测试的使用，并增加对单元测试的使用。**我喜欢将验收测试视为尚未重构的单元测试。**

尽管我的评论与框架无关，但我使用 Codeception [for WordPress / PHP]。Codeception 在基于浏览器的测试和单元测试之间轻松切换。Codeception 的一个简洁功能是它具有自由形式的 PHP 验收测试，比 Gherkin [它还运行 Gherkin] 更进一步。所以我可以从比 Gherkin 场景不那么正式和不完整的验收测试开始。很多时候，它只是一堆评论或注释。[顺便说一句：作为一名自由小型企业开发人员，我还没有看到一个能够容忍 Gherkin 的非程序员。不是一个。]在开发中[与测试相反]，我经常发现当我开始接受测试时，它们开始有点模糊或一半工作。所以我可能会从一个做不了多少的验收测试开始，当我试图把它变成一些东西时，

换句话说，我使用验收测试来驱动我接下来要进行的单元测试。希望在一堆周期结束时，我要么有一个非常好的和简单的以激光为中心的验收测试和更多的单元测试 - 或者 - 理想情况下我完全消除了验收测试，只进行了一堆快速的单元测试. 它有点蒸发成一堆单元测试。

至于要测试什么。如果您在团队中，请测试所有内容。如果您自己工作，请执行以下操作：当您开始在脑海中形成关于应该发生什么的想法时，开始根据您的一半想法进行单元测试。如果可以消除一些验收测试，那就太好了！如果想法完成，请完成测试以使其成为现实。测试完成后，如果您想在不进行其他测试的情况下继续进行，那很好。继续。只需保持代码简洁明了。当您自己工作时，您不必担心覆盖范围，它只是一个工具。一遍又一遍地这样做，很快你就会有一堆测试和一堆对你的代码的信心。

# .net - 如何从 Windows SDK 打开文件？

> ID：15300525
> 
> 赞同：0
> 
> 时间：2013-03-08T18:10:52.480
> 
> 标签：.net, windows, dll, sdk, interop

我是com互操作，反编译等的新手。

我正在尝试使用[此处](https://stackoverflow.com/questions/2838896/any-way-to-avoid-creating-a-huge-c-sharp-com-interface-wrapper-when-only-a-few-m)建议的解决方案。但是，我不知道如何从 Windows SDK 中访问 UIAutomationClient.h。到目前为止，我的研究发现在安装 SDK 而没有实际使用它时出现建议/错误。

如何在 Visual Studio（或其他方式）中打开 SDK，以便浏览此文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-05-13T15:45:33.533

正如@HansPassant 所提到的，这些文件位于以下位置，具体取决于 Visual Studio 版本：

```
VS2010: C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\Include\UIAutomationClient.idl
VS2012: C:\Program Files (x86)\Windows Kits\8.0\Include\um\UIAutomationClient.idl 
```

# c# - InvalidJSONprimitive：Asp.net 中的 ABC Ajax 调用

> ID：15300529
> 
> 赞同：0
> 
> 时间：2013-03-08T18:11:04.160
> 
> 标签：c#, jquery, asp.net, ajax

我的脚本

```
<script type ="text/javascript">
     $(document).ready(function () {
         $('#<%=Button1.ClientID %>').click(function () {
             var ABC = 'TEST';
             $.ajax({
                 type: "POST",
                 url: "Default.aspx/ServerSideMethod"  ,
                 data: "{ EmailAddress : ABC }",
                 contentType: "application/json; charset=utf-8",
                 dataType: "json",
                 async: true,
                 cache: false,
                 success: function (msg) {
                     alert(msg);
                     $('#myDiv').text(msg.d);
                 }
             })
             return false;
         });
     });
     </script> 
```

代码隐藏方法

```
[WebMethod]
public static string ServerSideMethod(string EmailAddress)
{
    return EmailAddress ;
}

<asp:Button ID="Button1" runat="server" Text="Click" />
<br /><br />
<div id="myDiv"></div> 
```

在按钮单击它给我**InvalidJSONprimitive:ABC**这个错误可以告诉任何人我做错了什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T18:12:34.127

正如错误明确指出的那样，您发送到服务器的 JSON 无效。
JSON 中的字符串文字必须加引号。

您应该调用`JSON.stringify({ EmailAddress: ABC })`以从 Javascript 对象表达式构建 JSON 字符串。

# c++ - 无法使用 cmake 构建 Opencv 项目

> ID：15300533
> 
> 赞同：9
> 
> 时间：2013-03-08T18:11:15.267
> 
> 标签：c++, windows, opencv, makefile, cmake

所以，我正在尝试使用 cmake 构建一个 opencv 项目，但同时使用 GUI 实用程序和命令行工具，但总是弹出相同的错误

```
 CMake Warning at cmake/modules/FindOpenCV.cmake:160 (message):
  Found OpenCV 2.4.3 Windows Super Pack but it has not binaries compatible
  with your configuration.
      You should manually point CMake variable OpenCV_DIR to your build of OpenCV library.
  Call Stack (most recent call first):
  CMakeLists.txt:48 (FIND_PACKAGE) 
```

如果这里有人可以帮助我，那就太好了；

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-27T14:10:48.677

将 CMake 中 OpenCV 下的 OpenCV_DIR 条目从 C:\OpenCV\cmake 更改为 C:\OpenCV\build。它会解决你的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T18:15:53.643

我认为您的 CMake 变量`OpenCV_DIR`未指向正确的位置。查看您的 opencv 二进制文件的保存位置以及`OpenCV_DIR`变量指向的位置

* * *

如果您正在使用 window 给出命令`setx`并找出它的正确值

# c# - ASP.NET MVC4 Ajax ActionLink 帮助器不起作用 - 使用返回的部分视图重新加载整个页面

> ID：15300538
> 
> 赞同：3
> 
> 时间：2013-03-08T18:11:26.147
> 
> 标签：c#, asp.net, jquery, razor, asp.net-mvc-4

我有一个非常简单的 MVC 项目索引页面，它允许您创建“作业”并编辑现有作业。我正在尝试使用 Ajax 链接将 div 的内容替换为作业编辑表单， Create() 和 Edit() 操作作为部分视图返回。相反，当您单击 Ajax 链接时，整个页面内容将替换为部分视图，而不仅仅是相应 div 元素的内容。这是相关的 .cshtml 代码：

```
@{
    string placeholder = "777777";
}

    <body>
        <ol id="JobListing">
        @Html.Partial("_ExportJobListingPartial", Model)
        </ol>
        <br /><br /><br />
        @Ajax.ActionLink("New", "Create", new AjaxOptions { UpdateTargetId = "EditJobContainer", InsertionMode = InsertionMode.Replace, HttpMethod = "GET" })
        <br /><br />
        <div id="EditJobLinkContainer">
        @Ajax.ActionLink("Edit", "Edit", 
            new { id = placeholder }, // Route values
            new AjaxOptions { UpdateTargetId = "EditJobContainer", InsertionMode = InsertionMode.Replace, HttpMethod = "GET" }, // Ajax options
            new { id = "EditJobLink" } // Html attributes
            ) 
        </div>
        <br /><br />
        <div id="EditJobContainer">
        EMPTY BOX HERE
        </div>
        <br />
    </body>
    </html>

    <script>
      $(function() {
          $("#JobListing").selectable({
              selected: function (event, ui) {
                  // Select only one at a time
                  $(ui.selected).addClass("ui-selected").siblings().removeClass("ui-selected");
                  $("#EditJobLinkContainer").html('@Ajax.ActionLink("Edit", "Edit", 
                    new { id = placeholder }, // Route values
                    new AjaxOptions { UpdateTargetId = "EditJobContainer", InsertionMode = InsertionMode.Replace, HttpMethod = "GET" }, // Ajax options
                    new { id = "EditJobLink" } // Html attributes
                    )');

                  $("#EditJobLink").click(UpdateOnClick);
              }
          });

          $("#EditJobLink").click(UpdateOnClick);

          function UpdateOnClick() {
              //Get the id of the selected item
              var id = $(".ui-selected").first().attr("name");
              this.href = this.href.replace("@placeholder", id);
          }

      });

    </script> 
```

我在网上阅读的大多数类似问题的答案表明，也许我没有正确或在正确的位置包含 unobtrusive-ajax 代码。我在 _Layout 视图中，在 RenderBody() 调用之前，作为

```
 <script src="~/Scripts/jquery.unobtrusive-ajax.js"></script>
    <script src="~/Scripts/jquery.unobtrusive-ajax.min.js"></script> 
```

我知道这段代码正在加载，因为我在 unobtrusive-ajax.js 文件中插入了一个 alert() 调用，该文件在页面加载时启动，并且 Chrome 中代码的链接工作正常。但是，我不得不手动替换 ajax 脚本中对 live() 的调用，因为 live() 在最新版本的 jQuery 中已被弃用，即使我很确定它们是 MVC4 的最新脚本. 在某一时刻，Ajax 调用实际上是为“新建”链接工作的，但从那以后我已经进行了更改，现在几天没有任何工作。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-05T09:52:42.817

您需要将其包含在您的页面中

```
<script src="@Url.Content("~/Scripts/jquery.unobtrusive-ajax.js")" type="text/javascript"></script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T13:39:00.797

我为此使用空的专用 div

html是

```
<div id="targetDiv"> 
```

脚本是

```
 $(".get-roles").live("click", function (e) {

        $("#targetDiv").empty();

        $.ajax({
         url: "edit",
         type: 'GET'
         xhrFields: {
             withCredentials: true
         },
         success: function (data) {
             if (data) {

                 $("#targetDiv").append(data);
             }
             else {
                 $("#targetDiv").text("Error");
             }
         }
     });
    }); 
```

# wordpress - Wordpress：来自多个类别的儿童帖子

> ID：15300539
> 
> 赞同：0
> 
> 时间：2013-03-08T18:11:26.440
> 
> 标签：wordpress, wp-list-categories

转到“mysite.com/category/my_city/restaurants/”，我可以显示“my_city”类别和“restaurants”类别下的所有帖子。

让我们假设餐厅类别有几个子类别（泰国菜、意大利菜等）：我怎样才能列出所有子类别的餐厅的所有子类别，这些子类别也是并且仅在 my_city 类别下？

例如“mysite.com/category/my_city/thai/”

目前这是我的 category.php 文件中的代码：

```
<?php
$this_cat = (get_query_var('cat')) ? get_query_var('cat') : 1;
$this_category = get_category($this_cat);
if ( $this_category->parent ) { $this_cat = $this_category->parent; }
wp_list_categories('title_li=&child_of=' . $this_cat . '');
?> 
```

结果是一个类似“泰国、意大利等”的列表（这显然很好），但链接都指向“mysite.com/category/restaurants/thai/”之类的东西，显示所有餐厅，不仅是那些在我的城市。显然我没有赶上其他类别，也不知道如何做正确的数组。

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-01T05:47:50.463

[https://gist.github.com/siddhartanaranjo/6073854](https://gist.github.com/siddhartanaranjo/6073854)

在此代码中，获取 cat-page 的 cat 并使用简单的 subcategory-loop 显示 subcats 和 parent

或在您的餐厅页面模板中

[https://gist.github.com/siddhartanaranjo/6128695](https://gist.github.com/siddhartanaranjo/6128695)

# sql-server - 具有共享维度的多个度量之间的 DISTINCT COUNT 篮子分析

> ID：15300542
> 
> 赞同：1
> 
> 时间：2013-03-08T18:11:40.727
> 
> 标签：sql-server, ssas, mdx

假设我有一个具有两个不同的不同计数度量的多维数据集，称它们为`Measure1`和`Measure2`。这两个度量都包含一个共同的维度 ，`Dimension1`这两个度量都计算了该维度。

**我需要做的是`Dimension1``Measure1``Measure2`**在根据需要对每个度量进行适当过滤之后，返回**存在于****和中的不同成员计数。**

我可以分别定义 MDX 查询`Measure1`并`Measure2`获得不同的计数，但我需要能够“重叠”结果以避免重复计算两个集合中存在的成员。

注意：在实际场景中，涉及的度量不止2个，所有MDX查询都会动态构造（用户定义包含哪些度量和维度条件）。

这可以在 SSAS/MDX 中完成吗？如果没有，是否有其他 Microsoft 工具/功能可以？系统的最低要求是 SQL Server 2008 R2 标准版。

老实说，我不知道从哪里开始。谷歌没有出现这样的结果（我看到了一些涉及单个度量的篮子分析内容，但我不确定是否或如何将其应用于我的场景）。无论如何，我都不是 SSAS/MDX/BI 专家。

我能想到两种选择：

1.  使用`DRILLTHROUGH`单个 MDX 查询和（基本上）`COUNT DISTINCT`结果。
2.  在数据仓库源数据库上使用 T-SQL。（可能难以有效地考虑所有情况。）

我们确实需要能够钻取，所以无论如何我可能都必须实施解决方案#1，但最好有一种更有效的方法来获取计数，因为需要*更*频繁地进行计数.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T23:00:22.470

我会添加一个基于 Dimension1 Key 属性的 Distinct Count 度量。我会在 Excel 2010+ 中使用 Sets MDX 功能在 Measure1、2 等上进行过滤。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T20:11:53.280

我从来没有为此找到 MDX 解决方案。

我继续使用直接查询数据仓库的解决方案，经过一些性能调整后，它运行良好。这种方法可能不适用于所有应用程序，但看起来它适用于我们的特定场景。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-11-19T08:00:43.743

我会在 SQL Server 端（从两个表创建视图）或在 SSAS 端（创建单个度量但使用来自不同来源的不同分区（例如，Partition1 - 用于 Credits，Partition2 - 用于存款）推荐联合函数。

对于第二种方式，首先在这个“可怕的”决定上，您需要使用 SUM 函数进行简单的 Measure1。之后，点击 Measure1 并使用 DistionctCount 函数选择“创建新度量”。因此，SSAS 将使用 DistionctCount 函数与 Measure2 创建一个单独的新测量组。

它必须完美运行。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2018-11-24T22:51:52.707

让我们简化问题陈述。您需要同时购买面包和鸡蛋或拥有丰田和本田的顾客的数量。我很久以前就遇到过这个问题，并想出了一个查询设计。这些查询的性能并不好。由于这些查询的性质，他们正在将事实开放到粒度级别。因此，所有的聚合利益都失去了。

这是代码，我根据他们的名字来计算客户，他们订购了 ClassicVestS 或 HLMountainTire 和其他产品

```
with  
member [Measures].[CustomersWhoBoughtClassicVestS] as 
count(
intersect(
{nonempty(
existing ([Customer].[Customer].children),[Measures].[Internet Order Count]
)},
{extract(nonempty( ([Customer].[Customer].children* [Product].[Product].&[471]),[Measures].[Internet Order Count]),[Customer].[Customer])}
)
) 
member [Measures].[CustomersWhoBoughtHLMountainTire] as 
count(
intersect(
{nonempty(
existing ([Customer].[Customer].children),[Measures].[Internet Order Count]
)},
{extract(nonempty( ([Customer].[Customer].children* [Product].[Product].&[537]),[Measures].[Internet Order Count]),[Customer].[Customer])}
)
) 
Select {[Measures].[CustomersWhoBoughtClassicVestS],[Measures].[CustomersWhoBoughtHLMountainTire] 
} on columns , 
{ nonempty( [Product].[Product].children 
,[Measures].[Internet Order Count]) } 
on rows 
from [Adventure Works] 
```

[![结果](../Images/6e416c411ebb083586596822f216dd1c.png)](https://i.stack.imgur.com/j5LEi.jpg)

# android - NodeJS 在响应之前等待三个请求

> ID：15300549
> 
> 赞同：0
> 
> 时间：2013-03-08T18:12:12.357
> 
> 标签：android, node.js

我有三个具有相同应用程序的 Android 设备，但我需要这三个设备同时启动该应用程序。

我也有一个服务器，应用程序与这个服务器交换数据（用 NodeJS 开发）。

我认为所有设备都可以连接到服务器并等待响应。但我不知道如何使用 Node.js 来实现。我在 Node 中使用了集群，但它不起作用，因为我不知道如何同步所有这 3 个集群。

我怎样才能做到这一点？另一个想法？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T15:34:31.987

好吧，在 node.js 中使用通用事件很容易实现。创建一些特殊事件，并保持请求没有响应，直到事件被触发，当收到第三个请求时显然会发生什么。node.js 在这方面非常强大。

# python - return，return None，根本不返回？

> ID：15300550
> 
> 赞同：486
> 
> 时间：2013-03-08T18:12:15.430
> 
> 标签：python, null, return

考虑三个函数：

```
def my_func1():
  print "Hello World"
  return None

def my_func2():
  print "Hello World"
  return

def my_func3():
  print "Hello World" 
```

他们似乎都返回无。这些函数的返回值的行为方式有什么不同吗？有什么理由更喜欢一个而不是另一个？

* * *

## 回答 #1

> 赞同：651
> 
> 时间：2013-03-08T18:19:21.737

在实际行为上，没有区别。他们都回来`None`了，就是这样。然而，所有这些都有时间和地点。以下说明基本上是应该如何使用不同的方法（或者至少是我被教导应该如何使用它们），但它们不是绝对的规则，所以如果你觉得有必要可以将它们混合起来。

## 使用`return None`

这表明该函数确实是要返回一个值以供以后使用，在这种情况下它返回`None`. `None`然后可以在其他地方使用此值。`return None`如果函数没有其他可能的返回值，则永远不会使用。

在下面的示例中，如果给定的是人类，我们将返回`person`'s 。如果它不是人类，我们会返回，因为它没有 a （假设它不是动物或其他东西）。`mother``person``None``person``mother`

```
def get_mother(person):
    if is_human(person):
        return person.mother
    else:
        return None 
```

## 使用`return`

`break`这与在循环中使用的原因相同。返回值无关紧要，您只想退出整个函数。它在某些地方非常有用，即使您并不经常需要它。

我们有 15 个`prisoners`，我们知道其中一个有一把刀。`prisoner`我们一个一个地循环检查他们是否有刀。如果我们用刀打人，我们可以退出函数，因为我们知道只有一把刀，没有理由检查其余部分`prisoners`。如果我们没有找到`prisoner`带刀的人，我们会发出警报。这可以通过许多不同的方式完成，并且 using`return`可能甚至不是最好的方式，但这只是展示如何`return`用于退出函数的示例。

```
def find_prisoner_with_knife(prisoners):
    for prisoner in prisoners:
        if "knife" in prisoner.items:
            prisoner.move_to_inquisition()
            return # no need to check rest of the prisoners nor raise an alert
    raise_alert() 
```

注意：你不应该这样做`var = find_prisoner_with_knife()`，因为返回值并不意味着被捕获。

## `return`完全不使用

这也将返回`None`，但该值并不意味着被使用或捕获。它只是意味着函数成功结束。它与 C++ 或 Java 等语言`return`中的函数基本相同。`void`

在下面的例子中，我们设置了人的母亲的名字，然后函数在成功完成后退出。

```
def set_mother(person, mother):
    if is_human(person):
        person.mother = mother 
```

注意：你不应该这样做`var = set_mother(my_person, my_mother)`，因为返回值并不意味着被捕获。

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2013-03-08T18:23:10.773

是的，它们都是一样的。

我们可以查看解释过的机器代码，以确认它们都在做完全相同的事情。

```
import dis

def f1():
  print "Hello World"
  return None

def f2():
  print "Hello World"
  return

def f3():
  print "Hello World"

dis.dis(f1)
    4   0 LOAD_CONST    1 ('Hello World')
        3 PRINT_ITEM
        4 PRINT_NEWLINE

    5   5 LOAD_CONST    0 (None)
        8 RETURN_VALUE

dis.dis(f2)
    9   0 LOAD_CONST    1 ('Hello World')
        3 PRINT_ITEM
        4 PRINT_NEWLINE

    10  5 LOAD_CONST    0 (None)
        8 RETURN_VALUE

dis.dis(f3)
    14  0 LOAD_CONST    1 ('Hello World')
        3 PRINT_ITEM
        4 PRINT_NEWLINE            
        5 LOAD_CONST    0 (None)
        8 RETURN_VALUE 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2013-03-08T18:13:33.033

它们每个都返回相同的单例`None`——没有功能差异。

我认为放弃该`return`语句是合理的习惯用法，除非您需要它提前退出函数（在这种情况下，bare`return`更常见），或者返回除`None`. `return None`当它在一个函数中具有另一个返回除`None`. 显式写出`return None`是对读者的视觉提示，即有另一个分支返回更有趣的内容（调用代码可能需要处理这两种类型的返回值）。

通常在 Python 中，返回`None`的函数与 C 中的函数一样使用`void`——它们的目的通常是对输入参数进行操作*（*除非您使用全局数据（*颤抖*））。返回`None`通常会更明确地表明参数已发生变化。这更清楚地说明了为什么`return`从“语言约定”的角度省略该声明是有意义的。

也就是说，如果您正在使用已经围绕这些东西预先设定约定的代码库，我肯定会效仿以帮助代码库保持统一......

* * *

## 回答 #4

> 赞同：11
> 
> 时间：2019-12-04T23:36:46.743

正如其他人回答的那样，结果完全相同，`None`在所有情况下都返回。

区别在于风格，但请注意[**PEP8**](https://www.python.org/dev/peps/pep-0008/#programming-recommendations)要求使用一致：

> 在返回语句中保持一致。函数中的所有 return 语句都应该返回一个表达式，或者它们都不应该返回。如果任何 return 语句返回一个表达式，则任何没有返回值的 return 语句都应将其显式声明为 return None，并且显式 return 语句应出现在函数的末尾（如果可访问）。
> 
> 是的：
> 
> ```
> def foo(x):
>     if x >= 0:
>         return math.sqrt(x)
>     else:
>         return None
> 
> def bar(x):
>     if x < 0:
>         return None
>     return math.sqrt(x) 
> ```
> 
> 不：
> 
> ```
> def foo(x):
>     if x >= 0:
>         return math.sqrt(x)
> 
> def bar(x):
>     if x < 0:
>         return
>     return math.sqrt(x) 
> ```

[https://www.python.org/dev/peps/pep-0008/#programming-recommendations](https://www.python.org/dev/peps/pep-0008/#programming-recommendations)

* * *

基本上，如果你曾经`None`在函数中返回非值，这意味着返回值是有意义的并且意味着被调用者捕获。因此，当您返回时`None`，它也必须是明确的，`None`在这种情况下要传达的意思是，它是可能的返回值之一。

如果您根本不需要 return，那么您的函数基本上是作为过程而不是函数工作的，所以不要包含该`return`语句。

如果您正在编写一个类似过程的函数并且有机会提前返回（即您已经在该点完成并且不需要执行该函数的剩余部分），您可以使用 empty an `return`s 向读者发出信号这只是执行的早期完成，`None`隐式返回的值没有任何意义，也不意味着被捕获（类似过程的函数总是返回`None`）。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2018-10-31T20:13:17.557

就功能而言，它们都是相同的，它们之间的区别在于代码的可读性和风格（这是需要考虑的重要因素）

# html - 超链接不在整个按钮中

> ID：15300552
> 
> 赞同：0
> 
> 时间：2013-03-08T18:12:19.140
> 
> 标签：html

我的屏幕上有两个按钮..

```
 <div class="checksheet">
        <a href="http://some_link" target="_blank">
        <input class="btn btn-large btn-primary" type="button" value='Graph Search'>
      </a>
    </div>
    <div class="nchecksheet">
   <form action="/link" method="POST">
   <input class="btn btn-large btn-primary" type="submit" value='Analyze Topics'   onclick="$('#loading').show();">
    </form>
    <div id="loading" style="display:none; position:relative ;left:860px"><img src="{{ url_for('static', filename='img/newload.gif') }}" alt="" /></div>

</div> 
```

问题是..第一个按钮..在按钮的一小部分上有超链接..而“提交”类型的按钮..很好..

我的意思是……整个“提交”按钮是可点击的。

在第一部分......只有一个非常小的条带（按钮的顶部）是可点击的......

我错过了什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T18:16:16.960

您将输入标签放在锚标签内，这是不可能的。

我猜你正在使用 Twitter bootstrap 哪些`btn`类也可以被赋予`<a>`标签并使它们看起来像按钮，所以你可以这样做：

```
<div class="checksheet">
    <a href="http://some_link" target="_blank" class="btn btn-large btn-primary">
    Graph Search
    </a>
</div>
<div class="nchecksheet">
    <form action="/link" method="POST">
        <input class="btn btn-large btn-primary" type="submit" value="Analyze Topics" onclick="$('#loading').show();">
    </form>
    <div id="loading" class="hide" style="position: relative; left:860px;">
        <img src="{{ url_for('static', filename='img/newload.gif') }}" alt="" />
    </div>
</div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T18:30:17.723

尝试...

```
<div class="checksheet">
        <input type=button class="btn btn-large btn-primary" onClick="location.href='http://some_link'" value='Graph Search'>
    </div>
     <div class="nchecksheet">
   <input type=button class="btn btn-large btn-primary" onClick="location.href='http://some_link'; onclick="$('#loading').show();" value='Analyze Topics'>
    <div id="loading" style="display:none; position:relative ;left:860px"><img src="{{ url_for('static', filename='img/newload.gif') }}" alt="" /></div>
</div> 
```

# c# - MVC3、Razor 和 EF5：不显示子属性

> ID：15300554
> 
> 赞同：2
> 
> 时间：2013-03-08T18:12:31.937
> 
> 标签：c#, asp.net-mvc, entity-framework, razor, entity

好的，所以我有一个 Course 实体，它与 Industry 实体具有多对一或零关系。这意味着出于分类目的，课程可以指定或不指定行业。我通过 EF 创建了所有实体和模型，因此存储在 Course 实体中的唯一链接是 IndustryId。

创建控制器时创建的默认视图显示 IndustryId。

我现在要做的是显示描述，这是行业实体的属性。这是我的代码：

```
@foreach (var item in Model)
{
    <tr>
        <td><a href="@Url.Action("Details","Course", new { id=item.Id })"><img class="media-object" data-src="holder.js/64x64" /></a></td>
        <td>@Html.DisplayFor(modelItem => item.Name)</td>
        <td>@Html.DisplayFor(modelItem => item.Description)</td>
        <td>@Html.DisplayFor(modelItem => item.Industry.Description)</td>
        <td>@Html.DisplayFor(modelItem => item.Author)</td>
        <td>
            <a href="@Url.Action("Edit","Course", new { id=item.Id })"><i class="icon-edit"></i> Modify</a>
            <a href="@Url.Action("Delete","Course", new { id=item.Id })"><i class="icon-trash"></i> Delete</a>
        </td>
    </tr>
} 
```

现在的问题是**@Html.DisplayFor(modelItem => item.Industry.Description 行**什么也不显示。有谁知道为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T18:16:41.873

最可能的原因是您的查询中没有填充 Industry 对象，因此为空。您可能需要`Include("Industry")`在模型或控制器中添加填充的 LINQ 查询以预先加载该相关实体。

# mysql - phpmyadmin 数据库导出是二进制的

> ID：15300557
> 
> 赞同：0
> 
> 时间：2013-03-08T18:12:33.833
> 
> 标签：mysql, phpmyadmin, export

我正在使用 phpmyadmin（版本 3.3.8）导出我与托管服务提供商一起拥有的网站的数据库（因此我唯一的备份方法）。当我进行导出时，我设置了以下选项：

```
Export: SQL

Within the OPTIONS group; under the STRUCTURE sub group,
Selected the check box next to "Structure"
Selected the check box labeled "Add AUTO_INCREMENT value"
Selected the check box labeled "Enclose table and field names with backquotes"

Within the OPTIONS group, under the DATA sub group:
Selected the check box marked "Complete inserts".
Selected the check box marked "Extended inserts".
Selected the check box labeled "Use hexadecimal for binary fields" may be selected
Selected "INSERT" in the combo box labeled "Export type:"

Selected to gzip the exported file. 
```

生成的文件看起来像是二进制文件（而不是我预期的 SQL）。我尝试导入二进制文件，但当然失败了。如何解决此问题，以便导出的文件在导入时起作用？我从来没有在任何其他网站上遇到过这个问题。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T18:43:51.377

通过不选择压缩导出的文件，我找到了解决问题的方法。由于某种原因，在这种特殊情况下，选择压缩输出会导致导出损坏。为什么会这样，我不知道，因为我之前已经成功使用过这个选项（也许托管服务提供商有某种奇怪的设置）。如果您遇到同样的问题，请尝试不使用压缩，看看它是否为您解决了问题。

# linux - 在 Linux (Fedora Xfce) 中启动 byzanz-record 的 Bash 脚本

> ID：15300564
> 
> 赞同：2
> 
> 时间：2013-03-08T18:12:46.147
> 
> 标签：linux, bash, option, duration

我希望我的英语足以展开讨论...如果您发现一些错误，请见谅！我正在尝试编写一个 bash 脚本来启动 byzanz-record（Linux Fedora 下的屏幕录像机）一段不确定的时间，直到它被另一个脚本停止。Byzanz-record 需要一个选项 --duration 来指定记录的持续时间，但我希望它可以是无限期的。试图给出这个命令：

```
byzanz-record -v -a -c --display=:0.0 --width=1366 --height=768 --duration=86400 --delay=0 ~/Video/test.flv 
```

然后用 kill 命令手动停止它，当决定时，我获得了一个虚拟持续时间为 24 小时（86400 秒）的 test.flv 文件，无法使用时间线滑块滚动视频，因为视频实际上是远少于24小时，所以很难，然后我想得到一个显示真实持续时间的视频。所以我正在考虑使用环境变量作为 --duration 选项。我正在尝试以这种方式：

```
#!/bin/bash
pid_byzanz=$(ps -o pid --no-headers -C "byzanz-record")
sec_byzanz=$(ps -p ${pid_byzanz} -o etime= > /tmp/byzanz_elapsed_time && more /tmp/byzanz_elapsed_time | sed -E 's/(.*):(.+):(.+)/\1*3600+\2*60+\3/;s/(.+):(.+)/\1*60+\2/' | bc)
x=$(( ${sec_byzanz} + 3 ))
byzanz-record -v -a -c --display=:0.0 --width=1366 --height=768 --duration=$x --delay=0 /home/Riccardo/Video/test.flv
exit 
```

我在其中创建了两个环境变量 ${pid_byzanz} 和 ${sec_byzanz}，其中第一个注册了 byzanz-record 进程的 PID，这是命令“ps -p PID -o etime=”所必需的，它给了我持续时间以 hh:mm:ss 格式启动的进程，然后我用命令在几秒钟内翻译：

```
sed -E 's/(.*):(.+):(.+)/\1*3600+\2*60+\3/;s/(.+):(.+)/\1*60+\2/' | bc 
```

我将在环境变量 ${sec_byzanz} 中注册，我认为应该增加任意数字（例如 3）以允许进程启动，否则它可能会在启动的同一时刻结束，并且通过这种方式，也许我应该能够为我的进程获得一个无限期（因为 --duration 选项将是 3 的总和，其数字会自行增加，直到从另一个启动的脚本生成下一次杀戮）。

这是我的想法，但脚本没有按预期工作，因为它不会将我的 ${sec_byzanz} 变量与 3 相加，但它会创建一个持续时间仅为 3 秒的视频。我怎样才能实现我的目的。我刚开始编写 bash 脚本，我试图在谷歌上找到一个解决方案，直到我找到这个页面（[如何在 bash 脚本中添加数字](https://stackoverflow.com/questions/6348902/how-can-i-add-numbers-in-a-bash-script)）来总结两个变量，我没有目标地尝试过，所以我的直接向您请求。

我希望有一个解决方案。

问候，

里卡多

**编辑1：**

在终端中，我发出命令：

```
./launch_byzanz-record 
```

其中“launch_byzanz-record”是我的脚本，里面有：

```
#!/bin/bash
pid_byzanz=$(ps -o pid --no-headers -C "byzanz-record")
sec_byzanz=$(ps -p ${pid_byzanz} -o etime= > /tmp/byzanz_elapsed_time && more /tmp/byzanz_elapsed_time | sed -E 's/(.*):(.+):(.+)/\1*3600+\2*60+\3/;s/(.+):(.+)/\1*60+\2/' | bc)
x=$(( ${sec_byzanz} + 60 ))
byzanz-record -v -a -c --display=:0.0 --width=1366 --height=768 --duration=$x --delay=0 /home/Riccardo/Video/test.flv
exit 
```

当前进程的 commad 输出为：

```
$ ps ax | grep byzanz-record

 4314 pts/1    S+     0:00 /bin/bash ./launch_byzanz-record
 4318 pts/1    Sl+    0:04 byzanz-record -v -a -c --display=:0.0 --width=1366 --height=768 --duration=60 --delay=0 /home/Riccardo/Video/test.flv
 4330 pts/0    S+     0:00 grep --color=auto byzanz-record 
```

直到 60 秒结束（我增加了秒数，让我有时间测试会发生什么）。

**编辑2：**

也许我可以做这样的事情，作为想法，我必须尝试在 bash 脚本中进行转换：

基数是选择较大的固定数，如：

*24h = "86400 秒" = "记录时间" + "加时赛"*

我希望*“记录时间”*作为我的选项“--duration”的值。所以，我可能会做一些这样的，可能：

*   如果我的进程*byzanz-record*没有运行，我的**$x**环境变量是一个固定的大数字（例如***86400 seconds***）；

*   如果我的进程*byzanz-record*开始运行，相反，我的**$x**变为“***记录时间***”=“ *86400 秒*”-“*额外时间*”= ***“86400 秒”-（“86400 秒”-“记录时间”）***，其中“*记录” time* ”是“ **ps -p ${pid_byzanz} -o etime=** ”命令的输出......它可以作为想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-09T22:35:50.440

[这](http://forum.fedoraonline.it/viewtopic.php?pid=205415)是我的解决方案，用意大利语！我解决了！！作为我英语的练习，我也会尽快为您翻译成英语:)！你好

里卡多

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-23T19:41:23.573

这是我的。我发现杀死 byzanz-record 进程会截断我想要的视频。我只在 gif 和一台机器上测试过这个，所以我不能保证它在任何地方都能像这样工作。

基本上我启动 byzanz-record 并将其发送到后台。然后我启动一个 dzen2，点击 dzen 栏会退出 dzen。一旦退出，原始的 byzanz 进程就会被杀死。

我只做 60 多岁，因为我不想让 byzanz 有机会吃掉我所有的公羊。我想要更长的 gif 的那一天就是我增加这个限制的那一天。

```
byzanz-record -d 60 $DIMS "$IMAGE" &
echo "Recording window.  Click here to exit." | dzen2 -e 'button1=exit;button2=exit;button3=exit' -p 
kill $PID 
```

您可以提供自己的尺寸来代替 $DIMS。我改用我写的函数。

```
function byzanz-dimensions() {
  info="$(xwininfo)"
  x=$(echo "$info" | grep 'Absolute upper-left X' | cut -f 7 -d' ')
  y=$(echo "$info" | grep 'Absolute upper-left Y' | cut -f 7 -d' ')
  w=$(echo "$info" | grep Width | cut -f 4 -d' ')
  h=$(echo "$info" | grep Height | cut -f 4 -d' ')

  echo "-x $x -w $w -y $y -h $h"
} 
```

整个过程发生在另一个脚本中，该脚本将新保存的图像上传到 imgur。 [https://github.com/sagotsky/.dotfiles/blob/master/.cli-board/record-gif-imgur](https://github.com/sagotsky/.dotfiles/blob/master/.cli-board/record-gif-imgur)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T19:38:39.790

你的第一行

```
pid_byzanz=$(ps -o pid --no-headers -C "byzanz-record") 
```

应该为 生成一个空字符串`pid_byzanz`，因为您实际上还没有运行`byzanz-record`。结果，您实际上并没有从第二行获得任何输出，因为您真正运行的命令是

```
ps -p -o etime 
```

这会导致错误，因为您没有指定进程 ID。因此， 的值`x`本质上是 0 + 您提供的任何硬编码值。

`ps`只能告诉您活动进程*已*运行多长时间，而不是未来进程*可能*运行多长时间。我不知道`byzanz-record`，所以我不能建议一种让它提前停止录制的方法（只需给它一个巨大的持续时间并在你想要它停止时手动杀死它可能会起作用）。

# c# - 替代 Urlmon.dll 中的 FindMimeFromData 方法，该方法具有更多 MIME 类型

> ID：15300567
> 
> 赞同：8
> 
> 时间：2013-03-08T18:13:01.333
> 
> 标签：c#, mime-types

考虑到存储此类数据的字节数组的前 256 个字节，可通过 Windows DLL 访问的[FindMimeFromData](http://msdn.microsoft.com/en-us/library/ms775107%28VS.85%29.aspx)`Urlmon.dll`方法能够确定存储在内存中的给定数据的 MIME 类型。

然而，在阅读了它的文档之后，我被引导到[Windows Internet Explorer 中的 MIME 类型检测，在](http://msdn.microsoft.com/en-us/library/ms775147%28VS.85%29.aspx)那里我可以找到该方法能够识别的 MIME 类型。见[清单](http://msdn.microsoft.com/en-us/library/ms775147%28VS.85%29.aspx#Known_MimeTypes)。如您所见，此方法仅限于 26 种 MIME 类型。

所以我想知道是否有人可以将我指向具有更多 MIME 类型的另一种方法，或者我可以包含我认为合适的 MIME 类型的另一种方法/类。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-03-24T05:40:09.433

更新：@GetoX 已采用此代码并将其包装在 .net 核心的 NuGet 包中！见下文，加油！！

> 所以我想知道是否有人可以将我指向具有更多 MIME 类型的另一种方法，或者我可以包含我认为合适的 MIME 类型的另一种方法/类。

我使用 Winista 和 URLMon 的混合体来检测上传文件*的*真实格式。

**Winista MIME 检测**

假设有人用 jpg 扩展名重命名 exe，您仍然可以使用二进制分析确定“真实”文件格式。它不检测 swf 或 flv，但几乎可以检测所有其他众所周知的格式 + 您可以获得一个十六进制编辑器并添加更多它可以检测的文件。

**文件魔术**

Winista 使用 XML 文件“mime-type.xml”检测真正的 MIME 类型，该文件包含有关文件类型和用于识别内容类型的签名的信息。例如：

```
<!--
 !   Audio primary type
 ! -->

<mime-type name="audio/basic"
           description="uLaw/AU Audio File">
    <ext>au</ext><ext>snd</ext>
    <magic offset="0" type="byte" value="2e736e64000000"/>
</mime-type>

<mime-type name="audio/midi"
           description="Musical Instrument Digital Interface MIDI-sequention Sound">
    <ext>mid</ext><ext>midi</ext><ext>kar</ext>
    <magic offset="0" value="MThd"/>
</mime-type>

<mime-type name="audio/mpeg"
           description="MPEG Audio Stream, Layer III">
    <ext>mp3</ext><ext>mp2</ext><ext>mpga</ext>
    <magic offset="0" value="ID3"/>
</mime-type> 
```

当 Winista 无法检测到真正的文件格式时，我求助于 URLMon 方法：

```
public class urlmonMimeDetect
{
    [DllImport(@"urlmon.dll", CharSet = CharSet.Auto)]
    private extern static System.UInt32 FindMimeFromData(
        System.UInt32 pBC,
        [MarshalAs(UnmanagedType.LPStr)] System.String pwzUrl,
        [MarshalAs(UnmanagedType.LPArray)] byte[] pBuffer,
        System.UInt32 cbSize,
        [MarshalAs(UnmanagedType.LPStr)] System.String pwzMimeProposed,
        System.UInt32 dwMimeFlags,
        out System.UInt32 ppwzMimeOut,
        System.UInt32 dwReserverd
    );

public string GetMimeFromFile(string filename)
{
    if (!File.Exists(filename))
        throw new FileNotFoundException(filename + " not found");

    byte[] buffer = new byte[256];
    using (FileStream fs = new FileStream(filename, FileMode.Open, FileAccess.Read))
    {
        if (fs.Length >= 256)
            fs.Read(buffer, 0, 256);
        else
            fs.Read(buffer, 0, (int)fs.Length);
    }
    try
    {
        System.UInt32 mimetype;
        FindMimeFromData(0, null, buffer, 256, null, 0, out mimetype, 0);
        System.IntPtr mimeTypePtr = new IntPtr(mimetype);
        string mime = Marshal.PtrToStringUni(mimeTypePtr);
        Marshal.FreeCoTaskMem(mimeTypePtr);
        return mime;
    }
    catch (Exception e)
    {
        return "unknown/unknown";
    }
}
} 
```

从 Winista 方法内部，我在这里求助于 URLMon：

```
 public MimeType GetMimeTypeFromFile(string filePath)
    {
        sbyte[] fileData = null;
        using (FileStream srcFile = new FileStream(filePath, FileMode.Open, FileAccess.Read))
        {
            byte[] data = new byte[srcFile.Length];
            srcFile.Read(data, 0, (Int32)srcFile.Length);
            fileData = Winista.Mime.SupportUtil.ToSByteArray(data);
        }

        MimeType oMimeType = GetMimeType(fileData);
        if (oMimeType != null) return oMimeType;

        //We haven't found the file using Magic (eg a text/plain file)
        //so instead use URLMon to try and get the files format
        Winista.MimeDetect.URLMONMimeDetect.urlmonMimeDetect urlmonMimeDetect = new Winista.MimeDetect.URLMONMimeDetect.urlmonMimeDetect();
        string urlmonMimeType = urlmonMimeDetect.GetMimeFromFile(filePath);
        if (!string.IsNullOrEmpty(urlmonMimeType))
        {
            foreach (MimeType mimeType in types)
            {
                if (mimeType.Name == urlmonMimeType)
                {
                    return mimeType;
                }
            }
        }

        return oMimeType;
    } 
```

[从 netomatix 到 Winista 实用程序的 Wayback Machine 链接](https://web.archive.org/web/20171218070604/http://www.netomatix.com/Products/DocumentManagement/MimeDetector.aspx)。AFAIK 他们在开源 Nutch 爬虫系统中发现了一些“mime reader 实用程序类”，并且他们在 2000 年代初期进行了 C# 重写。

我已经使用 Winista 托管了我的 MimeDetect 项目，并且 URLMon 回退到这里（请使用十六进制编辑器贡献新的文件类型）： [https ://github.com/MeaningOfLights/MimeDetect](https://github.com/MeaningOfLights/MimeDetect)

您也可以使用Paul Zahra 链接到的[这篇文章](https://stackoverflow.com/questions/58510/using-net-how-can-you-find-the-mime-type-of-a-file-based-on-the-file-signature)中提到的 Registry 方法或[.Net 4.5 方法](http://msdn.microsoft.com/en-us/library/system.web.mimemapping.getmimemapping)，但 Winista 是最好的恕我直言。

享受知道您系统上的文件**是** *他们声称的*文件，而不是[恶意软件](https://security.stackexchange.com/q/81677/10505)！

* * *

**更新：**

对于桌面应用程序，您可能会发现 WindowsAPICodePack 效果更好：

```
using Microsoft.WindowsAPICodePack.Shell;
using Microsoft.WindowsAPICodePack.Shell.PropertySystem;

private static string GetFilePropertyItemTypeTextValueFromShellFile(string filePathWithExtension)
{
   var shellFile = ShellFile.FromFilePath(filePathWithExtension);
   var prop = shellFile.Properties.GetProperty(PItemTypeTextCanonical);
   return prop.FormatForDisplay(PropertyDescriptionFormatOptions.None);
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2019-12-16T22:45:55.990

经过几个小时寻找弹性解决方案。我采用了@JeremyThompson 解决方案，将其适应框架 .net core/.net 4.5 并将其放入[nuget package](https://www.nuget.org/packages/Winista.MimeDetect)。

```
 //init
   var mimeTypes = new MimeTypes();

   //usage by filepath
   var mimeType1 = mimeTypes.GetMimeTypeFromFile(filePath);

   //usage by bytearray
   var mimeType2 = mimeTypes.GetMimeTypeFromFile(bytes); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-15T10:08:36.190

[这篇 SO 帖子](https://stackoverflow.com/questions/58510/using-net-how-can-you-find-the-mime-type-of-a-file-based-on-the-file-signature)中有多种可能的解决方案，至少会给你一些思考的余地。

似乎唯一真正做到这一点的方法是以二进制形式读取它，然后进行比较，无论 MIME 类型是以某种方式声明的硬编码，还是您依赖机器自己可用的 MIME 类型/注册表。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2021-03-05T21:00:37.003

刚刚找到[FileSignatures](https://github.com/neilharvey/FileSignatures)。它实际上是一个很好的替代方案，在 Linux 目标应用程序上也能正常运行。

## 语境

`Urlmon.dll`不适合 Linux - 因此不适用于多平台应用程序。我在 Microsoft Docs 中找到[了这篇文章。](https://docs.microsoft.com/en-us/aspnet/core/mvc/models/file-uploads?view=aspnetcore-5.0#file-signature-validation)它引用了一个[文件签名数据库](https://www.filesignatures.net)，这是一个很好的文件类型参考（在我写这篇文章时是 518 个）。

再挖掘一下，我发现了这个非常好的项目：[FileSignatures](https://github.com/neilharvey/FileSignatures) nuget [here](https://www.nuget.org/packages/FileSignatures/)。它还具有很强的可扩展性，例如，您可以从 filesignatures.net 获取所需的所有类型并创建自己的类型模型。

## 用法

您可以检查任何定义的类型

```
var format = inspector.DetermineFileFormat(stream);

if(format is Pdf) {
  // Just matches Pdf
}

if(format is OfficeOpenXml) {
  // Matches Word, Excel, Powerpoint
}

if(format is Image) {
  // Matches any image format
} 
```

或使用它带来的一些元数据，基于匹配的文件类型

```
var fileFormat = _fileFormatInspector.DetermineFileFormat(stream);
var mime = fileFormat?.MediaType; 
```

## 可扩展性

您可以定义任意数量的继承自`FileFormat`并配置 a`FileFormatLocator`以在需要时加载它们的类型

```
var assembly = typeof(CustomFileFormat).GetTypeInfo().Assembly;

// Just the formats defined in the assembly containing CustomFileFormat
var customFormats = FileFormatLocator.GetFormats(assembly);

// Formats defined in the assembly and all the defaults
var allFormats = FileFormatLocator.GetFormats(assembly, true); 
```

更多细节在[项目的 Github](https://github.com/neilharvey/FileSignatures)

# xml - XSLT：基于命名空间 uri 跨节点的所有子节点进行复制

> ID：15300568
> 
> 赞同：1
> 
> 时间：2013-03-08T18:13:08.827
> 
> 标签：xml, xslt, dynamic, matching

我对 XSLT 完全陌生，我需要使用它进行一些转换。我想了解的是如何在 xml 文档上复制特定元素的子元素。

这个元素是动态的，但我知道它的命名空间的 uri。有没有办法根据我拥有的uri匹配这个元素，然后复制它的所有子元素？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T18:28:47.453

该[`xsl:copy-of`](http://www.w3.org/TR/xslt#copy-of)元素可用于将节点集复制到结果树。

例如，要将`foo`命名空间中的子节点复制到结果中，您可以使用如下内容：

```
<xsl:copy-of xmlns:ns="foo" select="ns:*"/> 
```

另请参见[`xsl:copy`](http://www.w3.org/TR/xslt#copying)用于复制当前节点的元素。

* * *

*编辑添加：*如果您只在运行时知道命名空间，请参阅[`namespace-uri`](http://www.w3.org/TR/xpath/#function-namespace-uri)XPath 函数。

例如，如果您有`$uri`包含命名空间 URI 的变量，则上面的等价物将是：

```
<xsl:copy-of select="*[namespace-uri() = $uri]"/> 
```

# javascript - 延迟ajax成功，jQuery

> ID：15300569
> 
> 赞同：1
> 
> 时间：2013-03-08T18:13:11.273
> 
> 标签：javascript, jquery

我被一些简单的事情困住了。当我发出 ajax 请求时，由于某些原因它没有足够的时间来分配`combonews`变量：

```
jQuery.ajax({
            type: "POST",
            url: "People.aspx/LoadComboNews",
            data: "{\"id\":" + usrid + "}",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (msg) {
                // Replace the div's content with the page method's return.
                combonews = '';
                setTimeout(function () { combonews = eval(msg.d); }, 500);
                //combonews = eval(msg.d);

            }
    }); 
```

尝试添加 setTimeout 如图所示，但是当我想提醒`combonews` 它为空时。当我发出警报`msg.d`时，它总是准备好数据。有没有办法延长执行时间`combonews = eval(msg.d);`？

**更新：**

当我通过绑定到按钮单击事件来运行它时，分配工作正常

**--------------------------------------**

**更新2**

```
function lcombo() {
    jQuery('#combostart ~ option').remove();
    //setTimeout((function () {
        jQuery.ajax({
            type: "POST",
            url: "People.aspx/LoadComboNews",
            data: "{\"id\":" + usrid + "}",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            complete: function (msg) {
                // Replace the div's content with the page method's return.
                combonews = '';
                //setTimeout(function () { combonews = eval(msg.d); }, 500);
                combonews = JSON.parse(msg.d);

            }
        });
        //combonews = eval(combonews);
        //alert(combonews);
        jQuery(".chzn-select").chosen();
        jQuery(".chzn-select-deselect").chosen({ allow_single_deselect: true });
        var str = "";
        if (combonews.length > 0)
            for (var i in combonews) {
                str += "<option value='" + combonews[i][0] + "'>" + combonews[i][1] + "</option>";
            }
        jQuery("#combooptions").append(str);
        jQuery("#combooptions").val(draftid);
        jQuery("#combooptions").trigger("liszt:updated"); 
} 
```

然后我加载 lcombo() 函数。它在点击时起作用，但在其他一些后果中不起作用（我的意思是不会将消息加载到组合新闻中）

感谢您

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T18:29:47.950

@Adam 这是我找到的唯一解决方案，我将您的评论作为答案

为简单起见，请在您的 ajax 请求之后获取所有代码，并将其全部放入您的完整函数中。在您的 ajax 请求完成之前，您试图对变量“combonews”做一些事情。- 亚当

但不是`complete`我用`success`

谢谢大家

# tridion - Tridion 撤消签出/签入

> ID：15300570
> 
> 赞同：5
> 
> 时间：2013-03-08T18:13:12.187
> 
> 标签：tridion, tridion-2011

是否可以向非系统管理员的用户授予撤消签出/签入功能？我希望将此功能授予选定的超级用户，以便他们可以删除组件/页面上的旧锁。我不想增加他们对系统管理员的权限，因为这显然会阻止限制其他功能，例如修改模式。

谢谢

菲尔

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-09T07:18:52.630

不幸的是，这是不可能的。考虑为此使用工作流。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-09T10:09:11.173

您可以考虑一个[CME GUI 扩展](http://sdllivecontent.sdl.com/LiveContent/content/en-US/SDL_Tridion_2011_SPONE/concept_DC9C231E60874E3386BBAF129328D9AD)，它允许选定的超级用户撤消签出/签入，但这需要一些开发。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-10T20:43:54.417

通过模拟管理员用户创建自定义页面以撤消签出/签入并与特定用户共享以使用此页面。

注意：在历史记录中，不会说管理员已完成撤消签出/签入。

# apache - Apache 服务器上 Backbone.js 应用程序的 SEO - phantom.js 和 node.js？

> ID：15300571
> 
> 赞同：6
> 
> 时间：2013-03-08T18:13:15.493
> 
> 标签：apache, node.js, backbone.js, seo, phantomjs

我正在开发一个需要搜索引擎优化 (SEO) 的骨干网.js/marionette 网站。我们正在使用 java/spring RESTful 后端和 Apache 2.2 网络服务器。我目前正在我们的应用程序中实现 pushstate，但它仍处于早期阶段。

到目前为止，我提出的解决方案是：

*   对于使用启用了 javascript 的浏览器的普通用户，请使用纯粹的客户端骨干实现。
*   使用 Apache 的 mod_rewrite 将所有路径路由到我们的 index.html 页面，路径保持不变，以便主干.js 返回正确的页面，并且 url 保留其形式。我有这么多工作正常（减去一个错误）。
*   使用 Apache 的 httpd.conf 文件嗅探机器人/爬虫，并创建重写规则以将机器人重新路由到我们的 node.js 服务器。
*   使用 phantomjs 生成 html/content 并将其返回给 webcrawler。

我们不需要网站对机器人完全正常运行，但它必须返回正确的内容。我们正在使用 mustache 模板，但我们想要一个 DRY 站点，并且觉得随着站点的增长，任何类型的 java 模板渲染都会变得非常混乱。我们希望这个站点存在很多年，而不是试图连接到大量的 3rd 方库（至少不比我们现在的多）。

有人对此主题有任何经验或建议吗？根据我的研究，其他人有点警惕，特别是[这个相关的问题](https://stackoverflow.com/questions/12445896/using-node-js-to-serve-content-from-a-backbone-js-app-to-search-crawlers-for-seo)。我有点担心机器人是否在 javascript 中“点击”与执行获取请求。想法和建议？

首先十分感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T22:32:54.347

非常糟糕的主意，对不起，我太直率了。

您想要做的是以下内容：

如果我通过直接的 HTTP 请求点击[http://yoursite.com/path/to/resource](http://yoursite.com/path/to/resource)，那么您的服务器应该为我提供该资源页面的 html，然后如果您愿意，您可以在那时使用 javascript 来“ init" 提升单页应用程序方面。从那里开始，如果我通过 AJAX 和主干路由导航，从那里开始一切都很好。如果我然后复制一个 url，关闭我的浏览器，然后在我重新打开时将其粘贴，我应该会看到相同的 html。

这种方法已被证明是最好的方法，不仅适用于 SEO，而且适用于从概念上设计您的系统，以及确保您为每个人“工作”，而不仅仅是支持快速 JS 的浏览器。

您要不惜一切代价避免试图欺骗爬虫并为它们提供与用户看到的内容不同的内容......这是黑名单的秘诀。

总之，构建您的网站，以便如果您通过 http 访问 url，您将获得完整的 html，如果您通过单页应用程序模式 ajax 访问相同的 url，您将获得保持同步所需的部分内容...... . 更好的架构，更少的 SEO 黑名单！

# c# - 将列表保存到 txt 文件

> ID：15300572
> 
> 赞同：68
> 
> 时间：2013-03-08T18:13:16.233
> 
> 标签：c#, list

我正在尝试将列表保存到文本文件中。

这是我的代码：

```
public void button13_Click(object sender, EventArgs e)
{
    TextWriter tw = new StreamWriter("SavedLists.txt");

    tw.WriteLine(Lists.verbList);
    tw.Close();
} 
```

这是我在文本文件中得到的：

> System.Collections.Generic.List`1[System.String]

我必须使用`ConvertAll<>`吗？如果是这样，我不确定如何使用它。

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2016-04-19T06:55:28.427

框架4：无需使用StreamWriter：

```
System.IO.File.WriteAllLines("SavedLists.txt", Lists.verbList); 
```

* * *

## 回答 #2

> 赞同：82
> 
> 时间：2013-03-08T18:15:45.727

假设您的通用列表是字符串类型：

```
TextWriter tw = new StreamWriter("SavedList.txt");

foreach (String s in Lists.verbList)
   tw.WriteLine(s);

tw.Close(); 
```

或者，使用 using 关键字：

```
using(TextWriter tw = new StreamWriter("SavedList.txt"))
{
   foreach (String s in Lists.verbList)
      tw.WriteLine(s);
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-03-08T18:22:59.130

@Jon 的回答很棒，可以带你去你需要去的地方。那么为什么你的代码会打印出它是什么。答案：您不是通过隐式调用 Lists.verbList.ToString() 来写出列表的内容，而是*列表本身的字符串表示形式。*[Object.ToString()](http://msdn.microsoft.com/en-us/library/system.object.tostring.aspx)定义了您在此处看到的默认行为。

# svn - 颠覆中正确的 mime 类型的 shell 脚本

> ID：15300574
> 
> 赞同：11
> 
> 时间：2013-03-08T18:13:18.357
> 
> 标签：svn, shell, mime-types

当我将 shell 脚本 (foo.sh) 添加到 subversion 时，默认情况下它将设置`svn:mime-type`为`application/x-shellscript`. 由于这不是以 , 开头的`text/`， diff 和 blame 基本上忽略了该文件。我查看了[文本 mime 类型的官方列表，](http://www.iana.org/assignments/media-types/text)但没有看到任何看起来像 shell 脚本的东西。

设置它有很好的价值吗？

## 更新

按照下面的建议，我将 mime-type 设置为 text/x-shellscript。但是，blame 仍然认为它是一个二进制文件。

```
$ svn blame file.sh 
Skipping binary file: 'file.sh' 
$ svn proplist file.sh 
Properties on 'file.sh':
  svn:executable
  svn:mime-type 
$ svn propget svn:mime-type file.sh
 text/x-shellscript 
```

我还需要做些什么来说服 subversion 它是一个文本文件吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-08T20:37:50.213

该`file`实用程序将 `text/x-shellscript' 用于 shell 脚本：

```
$ file --mime-type /tmp/test.sh
/tmp/test.sh: text/x-shellscript 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-09T14:58:26.377

自动属性是完全客户端功能。使用 auto=properties，您还可以定义|重新定义一些属性以添加到 Subversion 存储库对象（即，对于旧添加，您必须重新定义错误的 mime 类型）

在`config`您的颠覆文件中（取决于平台的位置）

*   在`[miscellany]`部分取消注释`# enable-auto-props = yes`字符串
*   在`[auto-props]`部分取消注释`# *.sh = svn:eol-style=native;svn:executable`并相应地编辑（删除不需要的，添加需要的喜欢`svn:mime-type=text/plain`）

在此之后 repo 中的所有**新***.sh 文件将显示为 text/plain。

但是，因为 config 是客户端的，并且其中的更改不会填充到 repo 中，所以任何其他 Subversion 客户端将继续添加 *.sh 文件作为 text/x-shellscript 除非您的更改不重复

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-06T16:08:22.480

Subversion 很少自己设置 mime 类型。要么是你的客户端自己做的（在这种情况下你可能想要调整它的配置），或者某种形式的标准 svn 自动道具处理是活跃的（同样，你会想要调整它 - 对于 shell 脚本，你也会想要将 svn:eol-style 设置为 LF；一些 shell 会在 DOS/Windows 行结尾处出现问题，并且通过确保在任何地方都使用 Unix 行结尾，您可以避免通过网络共享或某些 Windows 构建的 shell 使用文件时出现问题（例如 Cygwin））。

svn blame 的问题在于该属性是版本化的。在属性更改之前对文件的任何修订仍然是二进制的（因为 mime 类型不以 text/ 开头），因此差异（和责备）将不会（轻松地）针对这些修订起作用。

我认为唯一的*解决*方法是让管理员修改存储库以删除“坏”mime 类型。

但是，作为一种解决方法，您应该能够通过 --force 责备，告诉它将所有文件视为文本。

事实上，看看[http://subversion.1072662.n5.nabble.com/svn-blame-not-working-for-files-which-had-binary-mime-type-in​​-a-previous-revision-td177847 .html](http://subversion.1072662.n5.nabble.com/svn-blame-not-working-for-files-which-had-binary-mime-type-in-a-previous-revision-td177847.html)，最近的颠覆客户端会告诉你使用 --force。

# html - excel vba表单提交并解析结果中的数据

> ID：15300576
> 
> 赞同：1
> 
> 时间：2013-03-08T18:13:21.677
> 
> 标签：html, excel, parsing, vba

这是我的代码，不幸的是，公司问题我无法发布真正的网址，它可以工作但不是我想要的方式，请查看下面的问题：

```
Dim doc As HTMLDocument
Dim IE As InternetExplorer
Dim TDelements As IHTMLElementCollection
Dim TDelement As HTMLTableCell
Dim r As Long

Sub ficfinder()
Set IE = CreateObject("InternetExplorer.Application")
    With IE
        .Visible = True
        .navigate URL:="...INPUT"<---this is my search form, but i have to redact due to co policy
    Do 'Until .readyState = 4
    DoEvents
    Loop Until IE.readyState = READYSTATE_COMPLETE
    'pick field to fill out
    Set mytextfield1 = .document.all.Item("WESTAC")
    'set value to put in
    mytextfield1.Value = "5416869160"
    'click the submit button
    IE.document.all.Item("Submit").Click
    Do 'Until .readyState = 4
    DoEvents
    Loop Until IE.readyState = READYSTATE_COMPLETE
    End With
'I think i'm missing something here

    Set doc = IE.document
    Dim sdd As String
    Set TDelements = doc.getElementsByTagName("td")
    r = 0
    For Each TDelement In TDelements
        If TDelement.Align = "right" Then
            Sheet2.Range("A1").Offset(r, 0).Value = TDelement.innerText
            r = r + 1
        End If
    Next
End Sub 
```

所以这可以工作并将数据放入我的电子表格中，但它提取的数据来自搜索表单，而不是您提交后出现的页面。我如何使 IE.document 出现的新页面？

任何帮助表示赞赏，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T03:33:53.317

我添加了

```
Do While IE.Busy: DoEvents: Loop 
```

就在提交之后，它工作得很好。感谢蒂姆威廉姆斯的帮助！

# android - 如何将值与存储在文本文件中的整数进行比较

> ID：15300577
> 
> 赞同：1
> 
> 时间：2013-03-08T18:13:23.220
> 
> 标签：android, google-maps, text-files, latitude-longitude, cellid

我将一些值存储在一个文本文件中，每一行看起来像这样，Cellid: -----, LAC: ------, Lat: ------, Long: ----- ----我想要做的是将手机当前运行的cellid与文本文件中的cellid进行比较，如果匹配，则在谷歌地图中打印一个标记。我的问题是如何在阅读文本文件时导航。该文件存储在手机的 SD 卡中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T17:49:04.320

```
 public static final String Key_Cellid = "Cellid";
    public static final String Key_LAC = "LAC";
    public static final String Key_Lat = "Lat";
    public static final String Key_Long = "Long";
    ArrayList<HashMap<String,String>> values = new ArrayList<HashMap<String, String>>();
    int cellidtt,lact;
    double latt,longt;

    public void stringExtracter(String st){

         String mainStr = st;

            int items = 4; // Numbers of items in each line

            HashMap<String,String> hash = new HashMap<String, String>();

            for(int i=0; i<items; i++){
                String num="";
                int sep = mainStr.indexOf(":");
                String fst = mainStr.substring(0, sep);
                mainStr = mainStr.replaceFirst(fst+":", "");
                if(i<items - 1){
                    sep = mainStr.indexOf(",");
                    num = mainStr.substring(0, sep);
                }
                else{
                    num = mainStr;
                    mainStr = mainStr.replaceFirst(num+",", "");
                }

                hash.put(fst, num);
            }
             values.add(hash);
        }

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.map);

        GoogleMap gmap = ((SupportMapFragment) getSupportFragmentManager().findFragmentById(R.id.mapg)).getMap();

        // Show the Up button in the action bar.
       // getActionBar().setDisplayHomeAsUpEnabled(true);
        GooglePlayServicesUtil.isGooglePlayServicesAvailable(getApplicationContext());

        gmap.setMapType(GoogleMap.MAP_TYPE_NORMAL);
        gmap.setMyLocationEnabled(true);

      File sdcard = Environment.getExternalStorageDirectory();
//Get the text file
      File file = new File(sdcard,"cellidt.txt");

      try {
          BufferedReader br = new BufferedReader(new FileReader(file));
          String line;

          while ((line = br.readLine()) != null) {
             Log.d("line=",line); // print the text file in the LogCat to ensure that the program is reading the file proper.
             stringExtracter(line);
          }

         //here you can get only numbers from text and convert it to integer then compare it
          for(int i=0;i<values.size();i++){

              HashMap<String,String> hash = values.get(i);
              cellidtt = Integer.parseInt(hash.get(Key_Cellid));
              Log.d("cellidtt=",hash.get(Key_Cellid));
              lact = Integer.parseInt(hash.get(Key_LAC));
              Log.d("lact=",hash.get(Key_LAC));
              latt = Double.parseDouble(hash.get(Key_Lat));
              Log.d("latt=",hash.get(Key_Lat));
              longt = Double.parseDouble(hash.get(Key_Long));
              Log.d("longt=",hash.get(Key_Long));

              gmap.addMarker(new MarkerOptions()
                    .position(new LatLng(latt,longt))
                    .title(cellidtt+","+lact));

          }
      br.close();
      }
      catch (IOException e) {

      }

    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T00:23:47.580

尝试这个

第一：在公共区域添加这些

```
public static final String Key_Cellid = "Cellid";
public static final String Key_LAC = "LAC";
public static final String Key_Lat = "Lat";
public static final String Key_Long = "Long";
ArrayList<HashMap<String,String>> values = new ArrayList<HashMap<String, String>>(); 
```

然后添加此方法以分隔每个项目的名称和值：

```
public void stringExtracter(String st){

 String mainStr = st;

    int items = 4; // Numbers of items in each line

    HashMap<String,String> hash = new HashMap<String, String>();

    for(int i=0; i<items; i++){
        String num="";
        int sep = mainStr.indexOf(":");
        String fst = mainStr.substring(0, sep);
        mainStr = mainStr.replaceFirst(fst+":", "");
        if(i<items - 1){
            sep = mainStr.indexOf(",");
            num = mainStr.substring(0, sep);
            mainStr = mainStr.replaceFirst(num+",", "");
        }
        else{
            num = mainStr;
            //mainStr = mainStr.replaceFirst(num+",", "");
        }

        hash.put(fst, num);
    }
     values.add(hash);
} 
```

现在编辑您的代码：

```
 //Find the directory for the SD Card using the API
//*Don't* hardcode "/sdcard"
File sdcard = Environment.getExternalStorageDirectory();

//Get the text file
File file = new File(sdcard,"file.txt");

//Read text from file

try {
    BufferedReader br = new BufferedReader(new FileReader(file));
    String line;

    while ((line = br.readLine()) != null) {

       stringExtracter(line);
    }

   //here you can get only numbers from text and convert it to integer then compare it
}
catch (IOException e) {
    //You'll need to add proper error handling here
} 
```

知道您可以从`values`数组列表中获取数据，例如：

```
for(int i=0;i<values.size();i++){
        HashMap<String,String> hash = values.get(i);
        System.out.println(hash.get(Key_Cellid));
        System.out.println(hash.get(Key_LAC));
        System.out.println(hash.get(Key_Lat));
        System.out.println(hash.get(Key_Long));
        System.out.println("--------------");
    } 
```

**重要的提示：**

我假设文本文件的每一行都没有空格

> Cellid:123,LAC:456,Lat:223,Long:213

我将数字存储为字符串，因为您应该将其转换为 Integer 或 Double 或您想在 map 中使用它。

希望这对您有所帮助。

# c# - 接受设置参数

> ID：15300583
> 
> 赞同：0
> 
> 时间：2013-03-08T18:13:43.357
> 
> 标签：c#, visual-studio, command-line, arguments

您好，我正在编写命令行程序，并且正在努力接受参数。

我已经让应用程序在他们可以输入程序和数据的地方工作，即

```
CMD>software (name) 
```

我只是不确定如何在他们可以配置设置的地方获取它，例如使用命令更改服务器 -s 。我需要让应用程序像这样工作：

```
CMD>software –s 192.168.1.1 (name)

CMD>software (name) -s 192.168.1.1 
```

我知道如何实际更改服务器等。只是不确定如何使用参数接受这些设置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T18:16:06.287

你只需要让你的`Main`方法接受一个字符串数组：

```
public class Test
{
    static void Main(string[] args)
    {
        for (int i = 0; i < args.Length; i++)
        {
            Console.WriteLine("{0}: {1}", i, args[i]);
        }
    }
} 
```

然后：

```
test.exe foo bar baz

0: foo
1: bar
2: baz 
```

请注意，与其他一些语言不同，*不是*`args[0]`二进制文件的名称——它实际上是二进制文件的第一个*参数*。

 **有第三方库可以帮助将一系列命令行参数转换为更有用的设置。例如，在 Noda Time 我们嵌入[了这个](https://github.com/gsscoder/commandline)。**

# ms-word - 是否可以计算某个书签是否在我的word文档中

> ID：15300589
> 
> 赞同：0
> 
> 时间：2013-03-08T18:14:23.290
> 
> 标签：ms-word, formula, bookmarks

我的 Word 文档页脚中有一个仅显示在最后一页的计算。我将当前页面与 numpages 进行比较。如果它们相同，则显示页脚详细信息。

都不错，但是我有一种情况，有人加了封面，意思就是现在比计算多了一页，封底什么也没显示。如果他们删除封面，那又可以了。

如果我添加一个具有唯一名称的书签以及封面，我想我可以使用它来将 numpages 值减少一。有人对语法有什么建议吗？你甚至可以计算一个书签的存在吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T10:08:53.357

在 VBA 帮助中搜索 Bookmarks.Exists 方法可能会有所帮助。

# java - WCF 是否可以通过 TCP 使用 SOAP 并被 java 客户端使用

> ID：15300591
> 
> 赞同：0
> 
> 时间：2013-03-08T18:14:34.213
> 
> 标签：java, wcf, soap, tcp

WCF 使用 NetTCP Binding 通过 TCP 协议交换信息。此外，SOAP 是一种消息格式或协议，它对于不同技术之间的互操作性是普遍接受的。因此，当我开发任何使用 TCP 和 SOAP 格式化的 WCF 服务时，它可能会被 java 客户端使用，或者它只能与 Dot Net 客户端一起使用，因为它使用了 NetTCPBinding，这可能是 Microsoft 对基于 TCP 的通信的专有绑定。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T18:22:19.010

理论上是的。使用Microsoft 创建`NetTcpBinding`的自定义[帧协议](http://msdn.microsoft.com/en-us/library/cc219293.aspx)能够从 TCP 流中拆分消息。除了[允许重用常用字符串的 SOAP 扩展](http://msdn.microsoft.com/en-us/library/cc219190.aspx)之外，该绑定还使用XML和[SOAP 结构的](http://msdn.microsoft.com/en-us/library/cc219175.aspx)[二进制表示](http://msdn.microsoft.com/en-us/library/cc219210.aspx)。正如您从链接中看到的，所有这些信息都是公开的，并且文档非常全面，因此可以在任何平台上创建一个客户端来与基于 NetTcpBinding 的 WCF 端点通信。

在实践中，我认为没有人这样做过，所以这样的工作不会掉以轻心（在那个层，你无论如何都会谈论处理套接字通信）。

# java - 从文件中的一个点或单词读取文件到另一个特定点或单词

> ID：15300598
> 
> 赞同：0
> 
> 时间：2013-03-08T18:14:56.450
> 
> 标签：java

我想要一些指导，如果可能的话，还有关于如何处理这个项目的骨架示例代码。

我有一个包含文本的文件，我想从特定点开始读取此文本并在文件中的特定点结束，然后跳过一些行并再次继续。

我想阅读**目标**和**时间结束之间的**所有内容并跳到下一个**目标**并阅读其间的所有内容并以该格式继续到文件末尾

这就是我的意思.. 示例文件

这是结束的开始，也是我们目前所能做的所有 **目标** 谁有权： 访问 IMG 访问上表 确保访问与公司定义的角色相匹配 验证 **时间结束** 没有人在某事之后更聪明像这样的 事情发生在嘲笑错误的人 mate **目标** 想想看，没有人能真正看到一棵树是如何生长的，但它确实是正确 **的**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T18:29:07.617

最简单的方法可能是使用正则表达式，如下所示： [Java string - get everything between (但不包括) two regular expressions？](https://stackoverflow.com/questions/962122/java-string-get-everything-between-but-not-including-two-regular-expressions). 我已经有一段时间没有编写 Java 了，所以语法可能不正确，但应该很接近。

```
import java.util.regex.Matcher;
import java.util.regex.Pattern;

public class Regex {

    public static void main(String[] args) {
        Pattern p = Pattern.compile(
                "Objective (.*) end of time",
                Pattern.DOTALL
            );

        Matcher matcher = p.matcher(
                "this objective is the test end of time"
            );

        if(matcher.matches()){
            System.out.println(matcher.group(1));
        }
    }

} 
```

# servicestack - 指定的错误模块找不到 ServiceStackHttpHandlerFactory

> ID：15300604
> 
> 赞同：1
> 
> 时间：2013-03-08T18:15:14.387
> 
> 标签：servicestack

我在我的 web.config 中收到“指定的错误模块”红色波浪线，用于以下几行：

```
<add path="*" name="ServiceStack.Factory" type="ServiceStack.WebHost.Endpoints.ServiceStackHttpHandlerFactory, ServiceStack, Version=3.9.38.0, Culture=neutral, PublicKeyToken=null" verb="*" preCondition="integratedMode" resourceType="Unspecified" allowPathInfo="true" />
<add path="*" type="ServiceStack.WebHost.Endpoints.ServiceStackHttpHandlerFactory, ServiceStack, Version=3.9.38.0, Culture=neutral, PublicKeyToken=null" verb="*"/> 
```

仅供参考，我确保没有按照类似帖子的建议选择 .NET 框架 3.5 版的客户端配置文件。

当我选择 Resharper 提供的“修复模块资格”时，我的 web.config 中仍然出现错误指示。

我正在关注 ServiceStack 网站中提供的示例应用程序。我安装了 ServiceStack 的最新稳定版本，这是我的 package.config：

```
<?xml version="1.0" encoding="utf-8"?>
<packages>
  <package id="ServiceStack" version="3.9.38" targetFramework="net35" />
  <package id="ServiceStack.Common" version="3.9.38" targetFramework="net35" />
  <package id="ServiceStack.OrmLite.SqlServer" version="3.9.39" targetFramework="net35" />
  <package id="ServiceStack.Redis" version="3.9.38" targetFramework="net35" />
  <package id="ServiceStack.Text" version="3.9.38" targetFramework="net35" />
</packages> 
```

当我运行该应用程序时，我收到了这条友好的消息：

配置错误

```
Description: An error occurred during the processing of a configuration file required to service this request. Please review the specific error details below and modify your configuration file appropriately. 

Parser Error Message: Could not load type 'ServiceStack.WebHost.Endpoints.ServiceStackHttpHandlerFactory' from assembly 'ServiceStack, Version=3.9.38.0, Culture=neutral, PublicKeyToken=null'. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-09-21T21:07:32.267

这出现在搜索“找不到 ServiceStackHttpHandlerFactory”时。在我的例子中，Pluralsight 和其他地方使用的示例是添加默认处理程序`ServiceStack.WebHost.Endpoints.ServiceStackHttpHandlerFactory`，它是用于 ServiceStack 3.9 的。升级到ServiceStack 4.5.0，出厂为`ServiceStack.HttpHandlerFactory`. 例如：

```
<add path="*" name="ServiceStack.Factory" type="ServiceStack.HttpHandlerFactory, ServiceStack" verb="*" preCondition="integratedMode" resourceType="Unspecified" allowPathInfo="true" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T18:49:22.917

该`ServiceStack.WebHost.Endpoints.ServiceStackHttpHandlerFactory`类型位于主**ServiceStack.dll**中。如果找不到它，则它没有被正确引用，这可能是由于尝试将其添加到错误的配置文件（例如客户端配置文件），或者在您的 Web.config 所在的主机项目中没有正确引用它。

# javascript - 将新选择框添加到页面时重新应用 jQuery 选择框样式

> ID：15300608
> 
> 赞同：0
> 
> 时间：2013-03-08T18:15:26.617
> 
> 标签：javascript, jquery

我的 jQuery 选择框样式适用于初始页面加载，但是当带有选择框的内容动态加载到页面中时，样式不会应用于它。

确保新选择框在加载到页面后立即设置样式的最佳方法是什么？

```
jQuery(document).ready(function() {
    jQuery.jStyling.createSelect(jQuery('select'));
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T18:16:22.757

尝试使用 CSS 而不是 jQuery

```
select {
    //Styling
} 
```

或根据需要按班级或 ID。

```
.classOfSelect {
    //Styling
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T19:55:38.237

在动态制作具有交替色带颜色的表格时，我遇到了这个问题，我就是这样做的：

[工作小提琴](http://jsfiddle.net/s5fTt/)

HTML：

```
<input id="add" type="button" value="Add Box"></input>
<div class="styled">BOX</div> 
```

JavaScript：

```
function addStyle() {
    $(".styled").css({
        "width": "100px",
        "height": "100px",
        "background": "#ff0000"
    });
};

$(document).on("click", "#add", function () {
    var myBox = $("<div>");
    myBox.addClass("styled");
    myBox.text("BOX");
    myBox.appendTo($("body"));
    addStyle();
});

addStyle(); 
```

# javascript - 在 Windows Phone 上禁用双击缩放

> ID：15300610
> 
> 赞同：1
> 
> 时间：2013-03-08T18:15:28.973
> 
> 标签：javascript, html, touch, windows-phone

我一直在使用 HTML 和 JavaScript 开发基于浏览器的点击游戏。我已经设法抑制导致移动浏览器在 iOS 和 Android 中缩放、滚动和执行各种其他技巧的默认行为。

然而，对于 Windows Phone，双击仍然会导致它尝试放大。在测试中，它会放大然后恢复到正常大小，但这足以阻止游戏元素，即尽可能快地单击。

我在 HTML 中有以下内容：

```
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1, maximum-scale=1, user-scalable=0"> 
```

我在 JavaScript 中也有以下内容：

```
window.addEventListener('touchstart', function(e) {
    clickarea.trigger('click'); // this is what tracks the number of clicks / touches
    e.preventDefault();
}, false);

window.addEventListener('touchmove', function(e) {
    e.preventDefault();
}, false);

window.addEventListener('touchend', function(e) {
    e.preventDefault();
}, false); 
```

Windows Phone 是否有我遗漏的任何其他事件或者我的代码中是否存在错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T19:33:54.677

Windows 手机使用微软专有的触摸事件而不是标准的，你需要添加条件代码来监听它们。

[适应你的 webkit 优化站点为互联网浏览器 10](http://blogs.windows.com/windows_phone/b/wpdev/archive/2012/11/15/adapting-your-webkit-optimized-site-for-internet-explorer-10.aspx#step4)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-14T12:45:05.593

您可以使用鼠标按下或 MSPointer 事件更改触摸启动事件，如下面的链接所述：http: [//blogs.windows.com/windows_phone/b/wpdev/archive/2012/11/15/adapting-your-webkit-为互联网优化的站点-explorer-10.aspx#step4](http://blogs.windows.com/windows_phone/b/wpdev/archive/2012/11/15/adapting-your-webkit-optimized-site-for-internet-explorer-10.aspx#step4)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-18T16:38:05.607

我看到了一个错误

```
meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1, maximum-scale=1, user-scalable=0"
```

最后一个用户可缩放的值是错误的。下一个字符串应该可以工作：

```
meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1, maximum-scale=1"
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-10T07:24:15.647

Windows Phone 中的 webbbrowser 控件仍然允许缩放和滚动，因为这是在实际浏览器组件“上方”的控件上完成的。

这可以在 C# 中禁用（此外，您可能可以检测右/左与上/下滚动手势并单独抑制它们）

有关完整描述，请参阅此博客条目： [http ://www.scottlogic.co.uk/blog/colin/2011/11/suppressing-zoom-and-scroll-interactions-in-the-windows-phone-7-browser -控制/](http://www.scottlogic.co.uk/blog/colin/2011/11/suppressing-zoom-and-scroll-interactions-in-the-windows-phone-7-browser-control/)

彼得

答案复制自： [电话：WebBrowser 禁用平移/缩放 wp7？](https://stackoverflow.com/questions/8516497/phonewebbrowser-disable-pan-zoom-wp7/17018615#17018615)

# javascript - 用于显示和隐藏的 Java 脚本

> ID：15300613
> 
> 赞同：1
> 
> 时间：2013-03-08T18:15:38.207
> 
> 标签：javascript, jquery, sharepoint-2010

我的要求很简单，它必须检查一个变量并相应地显示/隐藏一个类。它位于共享点发布页面上。使用以下代码段不起作用。

```
if ( source = 'show')
{
$('.classshide').hide();
}
else
{
$('.classsshow').hide();
} 
```

只有当源变量为show时才有效，反之亦然，当不等于show或等于hide时，请隐藏classshow。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T18:17:04.377

你的平等测试是错误的。

```
if ( source = 'show') 
```

应该

```
if ( source == 'show') 
```

或者它可能是

```
if ( source === 'show') //if source is a string and you don't want type coercion 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T18:28:23.837

您需要使用相等 ( `==`) 或严格相等 ( `===`) 运算符将`source`变量与 if 语句中的“显示”进行比较。因为你提到需要显示和隐藏类，我猜你想交替显示哪些类，所以我相应地调整了其余代码。

```
if ( source === 'show' )
{
    $('.classshide').hide();
    $('.classsshow').show();
}
else if ( source === 'hide' )
{
    $('.classsshow').hide();
    $('.classshide').show();
}
else // for some reason source is neither 'show' or 'hide'
{    //default to the logic for if it is 'hide'
    $('.classsshow').hide();
    $('.classshide').show();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T18:18:53.017

请使用严格的比较`===`。`type`它更快，因为它在比较`value`变量时不必转换。

*编辑：*

```
// get what the current state of hide/show is
var source = $('.classhide').length === 0 ? 'show' : 'hide';

if ( source === 'show') {
    $('.classshide').hide();
} else {
    $('.classsshow').hide();
} 
```

# netbeans - 如何在构建时向我的 Netbeans 项目添加一些操作？

> ID：15300617
> 
> 赞同：0
> 
> 时间：2013-03-08T18:15:45.590
> 
> 标签：netbeans, netbeans-7

是否可以更改我的 Netbeans 项目的构建操作？如果是这样，怎么做？

例如，我的项目中有一些 XML 文件。我希望在调用构建操作时找到、读取该文件并相应地创建另一个文件。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T04:03:54.673

您可以编辑**build.xml**文件。有一些关于如何为构建脚本创建新目标的示例。

# jquery - 通过 GET 请求 OAuth 令牌

> ID：15300619
> 
> 赞同：0
> 
> 时间：2013-03-08T18:15:47.067
> 
> 标签：jquery, oauth, get, twitter, twitter-oauth

我正在尝试使用 GET 请求从 Twitter 获取 OAuth 请求令牌。我不确定这是否可能，但我用这个生成我的参数：http: [//oauth.googlecode.com/svn/code/javascript/example/signature.html](http://oauth.googlecode.com/svn/code/javascript/example/signature.html)

我将消费者密码、令牌和令牌密码字段留空。HTTP 方法是 GET。我点击生成，它给了我规范化的参数，然后我将其复制/粘贴到浏览器中的 URL 之后，如下所示：`https://api.twitter.com/oauth/request_token?`+ `normalized parameters`。但是，我不断收到错误“无法验证 oauth 签名和令牌”。

这是不可能的，还是我做错了什么？

如果不可能，是否还有其他可能的途径可以通过纯 JavaScript 获取请求令牌？（不关心安全）

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T11:32:51.257

Twitter 的[文档](https://dev.twitter.com/docs/api/1/post/oauth/request_token)指出，您必须使用 POST 请求获取请求令牌。但是，我认为您并不完全了解 OAuth 请求的构造。首先，您必须在正在使用的签名生成器中包含消费者密钥和消费者秘密，然后必须将请求的授权标头设置为页面底部生成的值。您不能使用浏览器地址栏发出此请求，而是使用[Fiddler](http://www.fiddler2.com/fiddler2/)之类的东西进行测试。

# perl - Perl 脚本中的语法错误

> ID：15300621
> 
> 赞同：0
> 
> 时间：2013-03-08T18:15:53.163
> 
> 标签：perl

冒着通过提问得到减分的风险，我正在为 Perl 解释器发现的错误寻求帮助。这是来自Beginning Perl 的一个家庭作业问题。

问：修改货币程序以不断询问货币名称，直到输入有效的货币名称。

```
#! /usr/bin/perl
#convert.pl
use warnings;
use strict;

my ($value, $from, $to, $rate, %rates);
%rates = (
    pounds => 1,
    dollars => 1.6,
    marks => 3,
    "french frances" => 10,
    yen => 174.8,
    "swiss frances" => 2.43,
    drachma => 492.3,
    euro => 1.5
);

print "currency exchange formula -
pounds, dollars, marks, french frances, 
yen, swiss frances, drachma, euro\n";

print "Enter your starting currency: ";
$from = <>;
chomp($from);

While ($from ne $rates{$from}) {

    print "I don't know anything about $from as a currency\n";
    print "Please re-enter your starting currency:";
    $from = <>;
    chomp($from);
    }

print "Enter your target currency: ";
$to =<>;
chomp($to) ;

While ($to ne $rates{$to}) {

    print "I don't know anything about $to as a currency\n";
    print "Please re-enter your target currency:";
    $to = <>;
    chomp($to);
    }

print "Enter your amount: ";
$value = <>;
chomp ($value);
    if ($value == 0) {
    print "Please enter a non-zero value";
    $value = <>;
    chomp ($value);
    }

$rate = $rates{$to} / $rates{$from};
print "$value $from is ", $value*$rate, " $to.\n"; 
```

识别出 4 个错误，都在`while`循环内，例如`"syntax error at line 27, near ") {"`or `...at line 33, near "}"`... 等。我唯一的东西，例如第 27 行，是 and 之间的`")"`空格`"{"`。据我所知，作者提供的解决方案与我的脚本几乎相同，除了作者使用`while (not exists $rates{$from}) { ... }`. 我误解了“ne”的用法吗？或者我的脚本还有什么问题吗？非常感谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-08T18:21:22.640

您`While`以**大写字母 W**开头。Perl 区分大小写，应该是`while`.

如您所述使用`while (not exists $rates{$from}) { ... }`是正确的。在您的代码中，您将字符串与哈希中**对应**的`$from`数字进行比较。无论如何，这不会是真的。 **`$from``%rates`**

 *** * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-08T18:24:17.313

`ne`是“不等于”。你的第一个`while`循环使用它，但它永远不会用你写东西的方式得到一个错误的条件。你将永远被困在那个循环中。一个词永远不会匹配一个数字。这就是为什么您要检查密钥是否存在的原因`not exists`。

正确的做法是打印出您知道的货币，例如`say for keys %rates`并使用`do {...} while (...)`循环。

而且，正如 Cthulhu 所提到的，您正在调用`While`而不是正确的`while`.**

# html - 在整体包装之前，如何在内部进行内部 div 包装？

> ID：15300625
> 
> 赞同：1
> 
> 时间：2013-03-08T18:16:07.657
> 
> 标签：html, css, web

在我的网站上，我有一个包含另外两个 div 的 div。左边的内部 div 的宽度很窄，而右边的 div 相当宽（并且由文本组成）。

当我减小窗口的宽度时，一旦我到达最右边的内部 div 的最右边，整个 div（及其所有内容）都会包裹在左边的内部 div 下方。当我进一步调整窗口大小时，曾经正确的 div 的内容（文本）开始换行。

本质上，我有这个代码：

```
<style type="text/css">
#wrapper {
  width: 100%;
}

#leftdiv {
  float: left;
}
</style>

<div id="wrapper">
  <div id="leftdiv">
    shortleft
  </div>
  <div id="rightdiv">
    longrightlongrightlongright
  </div>
</div> 
```

但是，我希望右 div 中的文本在整个 div 换行到左 div 下方之前换行。我可以做些什么来修改我的代码以实现这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T21:59:13.617

尝试这个：

```
#wrapper {
  width: 100%;
 }

#leftdiv {
  width: 20%;
  float: left;
}

#rightdiv {
  width: 79%
  float: right;
 } 
```

如果你想看到这个在行动，看看我的网页

```
http://sherwoods-forests.com 
```

百分比不应该加到 100。当渲染引擎计算像素数时，有时会因为舍入而得到奇怪的结果。

左边的导航栏就是这样完成的。
在内容 div 中，每张图片及其标题都向左或向右浮动，并且主体文本环绕。您还需要使用嵌入 div 的边距

# t4 - 从 t4 模板编译打字稿文件

> ID：15300630
> 
> 赞同：2
> 
> 时间：2013-03-08T18:16:20.157
> 
> 标签：t4, typescript, envdte, web-essentials

我创建了一个 t4 模板，它基于我的 c# dtos 创建 typescript dto 文件。在生成过程中，我还想将生成的 ts 文件编译成 js 文件并将它们添加到解决方案中，就像我保存 ts 文件时 web Essentials 对我所做的那样。

我最初的想法是以某种方式触发保存事件；

```
EnvDTE.DTE dte = (EnvDTE.DTE) ((IServiceProvider) this.Host).GetService(typeof(EnvDTE.DTE));
dte.OpenFile(EnvDTE.Constants.vsViewKindAny, outputFilePath); 
```

保存文件（触发编译），然后再次关闭它。但我无法让它发挥作用。

有人对我有想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T14:24:33.403

我最终按照 Ryan Cavanaugh 的建议做了，只是调用了编译器。我使用[Olegs 技巧为模板创建多个输出，](http://www.olegsych.com/2008/03/how-to-generate-multiple-outputs-from-single-t4-template)以将生成的文件添加到项目和 tt 模板中。

我通过以下代码启动了编译器：

```
<#+ 
void CompileTypeScriptFile(string fullFileName)
{
    var process = new System.Diagnostics.Process
    {
        StartInfo = new ProcessStartInfo
        {
            FileName = "tsc.exe",
            Arguments = "--target ES5 \"" + fullFileName + "\""

        }
    };
    process.Start();
    process.WaitForExit();
}
#> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T03:09:41.753

正确的做法是有一个单独的构建目标（或任务）在 T4 模板之后运行并编译输出。T4 似乎不适合这个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-18T05:35:25.260

您可以使用[T4Toolbox](http://visualstudiogallery.msdn.microsoft.com/7f9bd62f-2505-4aa4-9378-ee7830371684)将您的 T4 文件与 .ts 文件相关联。它将“自定义工具模板”添加到 Visual Studio 属性窗口，并提供一个名为 T4Toolbox.TemplatedFileGenerator 的自定义工具，该工具将在保存 .ts 文件时自动转换模板。您可以使用 T4Toolbox 的[输出管理](http://www.olegsych.com/2010/03/t4-tutorial-integrating-generated-files-in-visual-studio-projects/)功能将生成的 .js 文件添加到解决方案中的所需位置。

# android - 在 SQLite 支持的 Android ContentProvider 中，我应该如何实现 insertOrUpdate 语义？

> ID：15300633
> 
> 赞同：2
> 
> 时间：2013-03-08T18:16:22.887
> 
> 标签：android, android-sqlite, android-contentprovider

这是在 _id 列之外还有一个 UNIQUE 列的情况。

我可以看到三个选项：

1.  将 insert 保留为 insert-if-no-conflict，将 update 保留为 update-if-present（这似乎是“标准”），并在客户端执行所有工作以决定如何解决此问题。

2.  将 insert 更改为 insert-or-update-if-present 并将 update 保留为 update-if-present。这是否违反了标准的 ContentProvider 合同？

3.  将 update 更改为 update-or-insert-if-not-present 并将 insert 保留为 insert-if-no-conflict。这对我来说比上面的第二个选项更没有意义，所以我可能不会这样做 - 但我怀疑它最终非常相似。

另外，如果我做第一个选项，这样做有什么好处吗

1.  查询然后如果count=1，替换，否则插入
2.  插入，如果失败则替换
3.  替换，如果插入失败。

我预计更新比整体更新更多，但我主要关心的是使其可维护，因为我不认为这会成为性能瓶颈。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-06-02T17:16:19.683

我倾向于查询，然后根据是否存在现有记录进行更新或插入。您可以为此使用现有的 ContentProvider 方法 - 它对于后续开发人员来说非常易读。

缺点是有几个不必要的数据库命中。

本文讨论了如何修改 ContentProvider 以“实现” [insertOrUpdate](https://www.buzzingandroid.com/2013/01/sqlite-insert-or-replace-through-contentprovider/)

# ruby-on-rails - Rails 无法浏览具有活动记录的模型

> ID：15300635
> 
> 赞同：0
> 
> 时间：2013-03-08T18:16:24.333
> 
> 标签：ruby-on-rails, activerecord, ruby-on-rails-3.2

我不明白为什么我不能使用 activerecord 浏览我的模型。

我有一个拥有个人资料的用户模型（实际上是用户的详细信息）

```
class User < ActiveRecord::Base
  has_one :profile, :dependent => :destroy 
end 
```

属于用户和城市的模型配置文件

```
class Profile < ActiveRecord::Base
  belongs_to :user
  belongs_to :city
end 
```

还有一个拥有_many Profiles的模范城市

```
class City < ActiveRecord::Base
  belongs_to :country
  has_many :profiles  
end 
```

在我的 user_controller 中，我可以像这样访问配置文件：

```
@user = User.find(params[:id])
logger.info(@user.profile.inspect) 
```

但我不能像这样更深入：

```
@user = User.find(params[:id])
logger.info(@user.profile.city.inspect) 
```

退货

```
undefined method `city' for nil:NilClass 
```

我想要得到的是来自存储在 Profile 模型中的 city_id 的城市名称。有人可以向我解释我做错了什么吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T18:28:27.027

那是因为你没有`Profile`那个`User`(ie) `@user.profile`is `nil`。所以你需要先创建`profile`for`user`和 do `@user.profile.city`。它会起作用的。如果您认为`profile`可能`nil`仍然想要获取某些记录`city`，`profile`那么您可以使用`try`.

```
 @user.profile.try(:city) 
```

# javascript - 如何在javascript中将哈希表转换为数组

> ID：15300636
> 
> 赞同：2
> 
> 时间：2013-03-08T18:16:26.663
> 
> 标签：javascript

我想在一行中通过javascript函数将哈希转换为数组

a 是哈希值是

```
Object { 10="aa", 11="bb"} 
```

我想把它转换成

```
a=[10,"aa",11,"bb"] 
```

有什么方法可以将其转换为数组

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T18:24:29.420

```
var ob={10:"aa", 11:"bb"};

a = []; 
```

一条线

```
for(o in ob) a.push(Number(o), ob[o]); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T18:20:58.647

像这样？

```
var obj = { 10: "aa", 11: "bb"};
var array = [];

for( i in obj ) {
   array.push(i);
   array.push(obj[i]);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T18:23:44.073

例如：

```
var obj = {
    10: 'aa',
    11: 'bb'
}; 
```

把它翻译成你想要的*数组，我们可以去*

```
var array = Object.keys( obj ).map(function( name ) {
    return [ +name ? +name : name, obj[ name ] ];
}).reduce(function( a, b ) {
    return a.concat(b);
}); 
```

# javascript - 根据选定的单选按钮隐藏节目

> ID：15300638
> 
> 赞同：1
> 
> 时间：2013-03-08T18:16:36.100
> 
> 标签：javascript, jquery, asp.net, html

我正在为我一直在研究的表单尝试一些 JS。如果他们的用户没有选择是，目的是隐藏。这是我遇到的一些问题：HTML：

```
<asp:RadioButtonList runat="server" ID="rbMatchingGift" ClientIDMode="Static">
    <asp:ListItem Value="0" Text="No"></asp:ListItem>
    <asp:ListItem Value="1" Text="Yes"></asp:ListItem>
</asp:RadioButtonList>
<li id="shcompany">                 
    <label for="txtCompanyName">Company Name</label>
    <asp:TextBox runat="server" ID="txtCompanyName" CssClass="narrow" />   
    <label for="txtCompanyPhone">Company Phone Number</label>
    <asp:TextBox runat="server" ID="txtCompanyPhone" CssClass="narrow" />       
</li> 
```

JS：

```
$(document).ready(function () { 
    var shcompany = $('#shcompany'); 
    showHide();
    mgift.change(function () {
        showHide();
    });

    function showHide() {
        var mgift = $('#rbMatchingGift');
        var shcompany = $('#shcompany');

        if (mgift.val() == "1") {
            shcompany.show();
        } else {       
            shcompany.hide();        
        }
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T19:03:39.467

![在此处输入图像描述](../Images/1eafe13bff8a9f5357f33f8eae86d022.png)

```
<asp:RadioButtonList runat="server" ID="rbMatchingGift" ClientIDMode="Static">
    <asp:ListItem Value="0" Text="No"></asp:ListItem>
    <asp:ListItem Value="1" Text="Yes"></asp:ListItem>
</asp:RadioButtonList>
<li id="shcompany">
    <label for="txtCompanyName">Company Name</label>
    <asp:TextBox runat="server" ID="txtCompanyName" CssClass="narrow" />
    <label for="txtCompanyPhone">Company Phone Number</label>
    <asp:TextBox runat="server" ID="txtCompanyPhone" CssClass="narrow" />
</li>
<script>

    $(document).ready(function () {
        showHide();
        $('#rbMatchingGift input').change(function () {
            showHide();
        });

        function showHide() {
            var mgift = $('#rbMatchingGift input:checked');
            var shcompany = $('#shcompany');

            if (mgift.val() == "1") {
                shcompany.show();
            } else {
                shcompany.hide();
            }
        }
    });
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T18:22:58.647

我认为要获得选定的单选按钮，您需要做这样的事情

```
var rblSelectedValue = $("#<%= rbMatchingGift.ClientID %> input:checked"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T18:25:35.497

我看到的问题之一是变量 mgift 是在函数 showHide 中定义的，但是您试图在它之外分配一个更改事件处理程序。将声明放在 var shcompany 之后。

此外，找出您在页面上呈现的实际 HTML 并使用正确的选择器来获取您需要的元素。

# json - Elasticsearch “More Like This” API 与 more_like_this 查询

> ID：15300650
> 
> 赞同：23
> 
> 时间：2013-03-08T18:17:22.987
> 
> 标签：json, rest, elasticsearch

Elasticsearch 有两个相似的特性来获取“相似”的文档：

有[“更像这个 API”](http://www.elasticsearch.org/guide/reference/api/more-like-this.html)。它给了我类似于给定文件的文件。不过，我不能在更复杂的表达式中使用它。

还有[`"more_like_this"`用于搜索 API 的查询](http://www.elasticsearch.org/guide/reference/query-dsl/mlt-query.html)我可以在 bool 或 boosting 表达式中使用它，但我不能给它一个文档的 id。我必须提供`"like_text"`参数。

我有带有标签和内容的文档。有些文档会有很好的标签，有些则没有。我想要一个“类似文档”功能，它每次都可以使用，但会将具有匹配标签的文档排名高于具有匹配文本的文档。我的想法是：

```
{
    "boosting" : {
        "positive" : {
            "more_like_this" : {
                "fields" : ["tag"],
                "id" : "23452",
                "min_term_freq" : 1
            }
        },
        "negative" : {
            "more_like_this" : {
                "fields" : ["tag"],
                "id" : "23452",
            }
        },
        "negative_boost" : 0.2
    }
} 
```

显然这不起作用，因为没有`"id"`in `"more_like_this"`。有哪些替代方案？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2013-03-10T08:49:23.777

首先简单介绍一下这个功能及其工作原理。这个想法是您有一个特定的文档，并且您希望有一些与它相似的其他文档。

为了实现这一点，我们需要从当前文档中提取一些内容并使用它来进行查询以获取相似的内容。我们可以从 lucene 存储字段（或 elasticsearch _source 字段，它实际上是 lucene 中的存储字段）中提取内容并以某种方式重新分析它或使用存储在术语向量中的信息（如果在索引时启用）来获取术语列表我们可以用它来查询，而不必重新分析文本。我不确定如果术语向量可用，elasticsearch 是否会尝试后一种方法。

越[喜欢这个查询](http://www.elasticsearch.org/guide/reference/query-dsl/mlt-query.html)，您就可以提供文本，而不管您从哪里得到它。该文本将用于查询您选择的字段并返回类似的文档。文本不会被完全使用，但会重新分析，并且只会保留最多`max_query_terms`（默认 25 个），在至少具有提供的`min_term_freq`（最小词频，默认 2）和文档频率之间的词`min_doc_freq`中`max_doc_freq`。还有更多参数可以影响生成的查询。

[更像这个 api](http://www.elasticsearch.org/guide/reference/api/more-like-this.html)更进一步，允许提供文档的 id 以及字段列表。这些字段的内容将从该特定文档中提取，并用于在相同字段上进行更像此查询。这意味着生成的更像这个查询将具有包含先前提取的文本的属性文本，并将在相同的字段上执行。正如你所看到的，这个 api 在后台执行的查询更像这个查询。

假设这个查询越像这个查询就越灵活，因为您可以将它与其他查询结合起来，并且可以从您喜欢的任何来源获取文本。另一方面，这个 api 更像是公开了为您做更多工作但有一些限制的通用功能。

在你的情况下，我会将几个不同的更像这样的查询组合在一起，这样你就可以利用强大的弹性搜索查询 DSL，以不同的方式提升查询等等。缺点是您必须自己提供文本，因为您无法提供要从中提取文档的 id。

有不同的方法可以实现你想要的。我会使用[bool 查询](http://www.elasticsearch.org/guide/reference/query-dsl/bool-query.html)在 should 子句中将这两个查询组合起来，并赋予它们不同的权重。我也会改用[更像这个字段的查询](http://www.elasticsearch.org/guide/reference/query-dsl/mlt-field-query.html)，因为您想一次查询一个字段。

```
{
    "bool" : {
        "must" : {
          {"match_all" : { }}
        },
        "should" : [
            {
              "more_like_this_field" : {
                "tags" : {
                  "like_text" : "here go the tags extracted from the current document!",
                  "boost" : 2.0
                }
              }
            },
            {
              "more_like_this_field" : {
                "content" : {
                  "like_text" : "here goes the content extracted from the current document!"
                }
              }
            }
        ],
        "minimum_number_should_match" : 1
    }
} 
```

这样，至少有一个 should 子句必须匹配，并且标签上的匹配比内容上的匹配更重要。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2015-07-20T19:41:47.117

现在可以使用新的**like**语法：

```
{
    "more_like_this" : {
        "fields" : ["title", "description"],
        "like" : [
        {
            "_index" : "imdb",
            "_type" : "movies",
            "_id" : "1"
        },
        {
            "_index" : "imdb",
            "_type" : "movies",
            "_id" : "2"
        }],
        "min_term_freq" : 1,
        "max_query_terms" : 12
    }
} 
```

见这里：[https ://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-mlt-query.html](https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-mlt-query.html)

# codeigniter - 在 codeIgniter 2 / MySQL 中使用 $query->field_data()

> ID：15300654
> 
> 赞同：0
> 
> 时间：2013-03-08T18:17:59.533
> 
> 标签：codeigniter, codeigniter-2

我正在尝试使用

```
$query = $this->db->query("YOUR QUERY");
$fields = $query->field_data(); 
```

这记录在本手册页的底部 [http://ellislab.com/codeigniter/user-guide/database/fields.html](http://ellislab.com/codeigniter/user-guide/database/fields.html)

但我得到一个错误列表（超过 100 个），任何查询，甚至是简单的`select * from tablename`.

我正在使用 CodeIgniter 2，PHP 版本 5.4.10，MySQL 版本 5.5.29

有谁知道为什么会这样？

```
$sql = "SELECT * FROM `article`";
$query = $this->db->query($sql);
$fields = $query->field_data(); 
```

错误列表（前几个）：

> 遇到 PHP 错误 严重性：通知消息：未定义属性：stdClass::$Type 文件名：mysqli/mysqli_result.php 行号：89
> 
> 遇到 PHP 错误 严重性：通知消息：未定义属性：stdClass::$Field 文件名：mysqli/mysqli_result.php 行号：95
> 
> 遇到 PHP 错误 严重性：通知消息：未定义属性：stdClass::$Default 文件名：mysqli/mysqli_result.php 行号：97
> 
> 遇到 PHP 错误 严重性：通知消息：未定义属性：stdClass::$Key 文件名：mysqli/mysqli_result.php 行号：99

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T21:46:58.460

似乎是 codeIgniter 中的错误，他们在开发人员分支中修复了它 [https://github.com/EllisLab/CodeIgniter/commit/effd0133b3fa805e21ec934196e8e7d75608ba00](https://github.com/EllisLab/CodeIgniter/commit/effd0133b3fa805e21ec934196e8e7d75608ba00)

# android - ImageView 超出父边界？

> ID：15300657
> 
> 赞同：1
> 
> 时间：2013-03-08T18:18:04.610
> 
> 标签：android, android-layout

我是这里的 Android 开发新手，但我似乎遇到了一个非常简单的问题。我正在尝试用三种线性布局来布置屏幕，顶部占 12.5%，中间占 73%，底部占 14.5%。在顶部区域，我想放置一个相对布局，在顶部线性布局内放置一个 ImageView。（这个布局还有很多东西，有按钮和所有东西，但我把它剥离了以显示问题）。

如果我删除 ImageView，一切都会完美地遮挡，我会得到正确大小的漂亮矩形区域。但是使用 ImageView，顶部线性区域的高度至少扩展为屏幕的 3/4！

我希望 RelativeLayout 保持在顶部线性区域内。有任何想法吗？

顺便说一句，我的 drawable/top_bar 本身是 800px 宽 x 186px 高。

这是布局：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:id="@+id/masterLinearLayout"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:fitsSystemWindows="false"
    android:orientation="vertical"
    tools:context=".MainActivity" >

    <LinearLayout
        android:id="@+id/linearTop"
        android:layout_width="fill_parent"
        android:layout_height="0dp"
        android:layout_weight=".125"
        android:orientation="horizontal"
        android:layout_alignParentTop="true" >

    <RelativeLayout
        android:id="@+id/topToolbarRelativeLayout"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:layout_alignParentTop="true" >

        <ImageView
            android:id="@+id/topBar"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:scaleType="fitStart"
            android:src="@drawable/top_bar" />

    </RelativeLayout>

    </LinearLayout>

    <LinearLayout
        android:id="@+id/linearMiddle"
        android:layout_width="fill_parent"
        android:layout_height="0dp"
        android:orientation="horizontal"
        android:layout_weight=".730">

    </LinearLayout>

    <LinearLayout
        android:id="@+id/linearBottom"
        android:layout_width="fill_parent"
        android:layout_height="0dp"
        android:layout_alignParentBottom="true"
        android:orientation="horizontal"
        android:layout_weight=".145">

    </LinearLayout>
</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T18:33:27.950

您可以尝试将比例因子设置为 fitXY。就像是 ：

```
android:scaleType="fitXY" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T18:35:25.223

我刚刚测试过了。将 ImageView 更改为以下内容：

```
 <ImageView
        android:id="@+id/topBar"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerHorizontal="true"
        android:layout_centerVertical="true"
        android:scaleType="fitStart"
        android:src="@drawable/top_bar" /> 
```

# html - 当身体始终居中时，如何使单个固定图像适合屏幕

> ID：15300662
> 
> 赞同：0
> 
> 时间：2013-03-08T18:18:33.187
> 
> 标签：html, css, background, center

所以也许这只是我将身体居中的方式，因为我将它显示为 html 中的居中表格。

```
html {
    display: table;
    margin: auto;
}

body {
    width:100%;
    display: table-cell;
    vertical-align: middle;
}

#background{
    width:100%;
    height:100%;
    position:fixed;
    background-image:url('image.jpg'); 
    background-repeat: no-repeat;
    background-size:cover;
} 
```

基于该代码，我可以看到图像将从主体的开头开始，从中心开始，因此图像将从那里开始，并且我有不应该存在的空白空间；我希望正文中的内容居中，但背景不应该如此，这样它才能以正确的方式适合屏幕。我尝试将我的中心代码转移到容器中，但没有奏效。我环顾了一两个小时，所有的答案都没有为我工作。知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T18:52:46.600

您是否重置了页面的边距？

```
html {
  margin: 0;
  padding: 0;
 }

body {
  margin: 0;
  padding: 0;
 } 
```

此外，如果您想要的结果是全屏背景，为什么不这样：

```
body {
  background: url(images/bg.jpg) no-repeat center center fixed; 
   -webkit-background-size: cover;
   -moz-background-size: cover;
   -o-background-size: cover;
background-size: cover;
} 
```

检查此链接以获取替代方法： [http ://css-tricks.com/perfect-full-page-background-image/](http://css-tricks.com/perfect-full-page-background-image/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T18:24:12.043

不让你的身体居中怎么样，你能把它包在一个容器里吗？“mainContainer”并将其居中？

*编辑：这是一个从你的*[http://jsfiddle.net/amyamy86/C4Spd/](http://jsfiddle.net/amyamy86/C4Spd/)分叉的小提琴

```
<html>
    <body>
       <div id="background"></div>
       <div id="outerContainer">
           <div id="mainContainer">
               <div id="box">
                   <p>This is some content</p>
               </div>
           </div>
       </div>
    </body>
</html>

#outerContainer {
    display: table;
    margin: auto;
}
#mainContainer{
    width:100%;
    display: table-cell;
    vertical-align: middle;
}
#background {
    width:100%;
    height:100%;
    background-image:url('http://mytwopiasters.files.wordpress.com/2011/01/ocean.jpg');
    position:absolute;
    background-repeat: no-repeat;
    background-size:cover;
}
#box {
    text-align:center;
    width:100px;
    position:fixed;
    height:100px;
    background:#fff;
    border:1px #000 solid;
} 
```

# asp.net-mvc-3 - 当 SQL 中的格式更改为 bigint 时，Int SQL 变量在 .Net 中取值为 1

> ID：15300663
> 
> 赞同：0
> 
> 时间：2013-03-08T18:18:33.377
> 
> 标签：asp.net-mvc-3, sql-server-2008, stored-procedures

我正在为我的项目使用 ASP.NET MVC 3 和 SQL SERVER 2008。存储过程是使用实体框架声明的。

我已经从.Net成功调用了一些SQL存储过程，但是其中一个出现了奇怪的行为......

## SQL部分：

```
ALTER PROCEDURE [dbo].[UPD_OR_CRE] 
    @ID int, -- Create element if null, update if not null
    @other_paramters ...,
AS
BEGIN
SET NOCOUNT ON; -- I also tried with OFF : same effect

Declare 
@result int,
@resultbigint bigint;

IF (@ID is not null)
    BEGIN
     -- @ID is not null => update
        BEGIN TRY
        update TABLE
        set
        ...
        where ID = @ID
        ;
        set @result = @ID;
        END TRY

        BEGIN CATCH
        -- catching some error.
        END CATCH;
    END

ELSE
    BEGIN
    -- @ID is null => create
    exec @result = CREATE_FUNCTION ... ; 

    -- CREATE_FUNCTION return the new ID

    -- set @result = 56; -- hard coded for test
    END

-- I put here for test a write in a journal table : @result is always correct
select @result "RESULT";
END 
```

* * *

## .Net 部分：

```
Int32? iD = null;
ObjectResult<Nullable<global::System.Int32>> coll = _db.UPD_OR_CRE(parameters ...);

iD = coll.ElementAt(0); 
```

* * *

工作始终由存储过程（更新或创建）完成，当我调用更新时，我可以在.Net 中取回 iD（与在这种情况下调用时相同），当我调用创建时，我总是在 .NET 中得到 iD = 1，即使我使用“set @result = 56;”进行硬编码也是如此 在 CREATE_FUNCTION 之后。

当我删除 CREATE_FUNCTION 调用时，硬编码的结果会出现在 .Net 中（例如这里是 56）。

我认为问题可能来自整数格式（在某些情况下，@result 在 CREATE_FUNCTION 中为 bigint 更改，但它的值始终保持 int 兼容），但我进行了很多其他测试以将 @result 转换回 Int 但没有成功（而且我仍然不明白为什么在这种情况下它会返回“1”..）。这些测试的示例

* * *

```
exec @resultbigint = CREATE_FUNCTION ... ;
-- (one of the following lines)
set @result = (select cast(cast(@resultbigint as varchar) as int));
set @result = convert(int,@resultbigint);
set @result = (select cast(@resultbigint as int)); 
```

* * *

当然，答案可能是重写 CREATE_FUNCTION 以获得 Int 作为回报，但这涉及很多其他工作......

任何帮助、跟踪或想法将不胜感激......

菲利普

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T15:55:28.847

我终于找到了问题所在。不是格式问题。

在一个被调用的过程中（在 CREATE_FUNCTION 之后），它是对表访问测试的请求（类似于 try catch 中的“从表中选择前 1 个”）

直到我将这个请求更改为一个做作的请求（类似“select @toto = count(*) from table”在同一个 try catch 中）之前，问题才出现

至少当从 .Net 调用时，SQL Server 似乎无法在一组存储过程中管理许多简单的选择；

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T18:49:39.833

我不是数据库的专家，但如果只是为了测试你修改存储过程的 else 部分，比如

```
ELSE
    BEGIN
     Begin tran
      --exec @result = CREATE_FUNCTION ... ; 
      insert into Table(COL) values('someValue')

      if @@error <>0
        begin
          rollback
        end

      set @result = SCOPE_IDENTITY()
     commit
    END

select @result "RESULT"; 
```

你的问题将得到解决

# xpath - 将 Xpath 的输出保存在 Hive 表中

> ID：15300665
> 
> 赞同：0
> 
> 时间：2013-03-08T18:18:46.630
> 
> 标签：xpath, hadoop, hive

我正在使用 xpath 来解析 Hive 表中已经存在的数据。

我正在使用以下命令：

创建视图 xmlout104(line) 作为 select * from testdata104 限制 100；从 xmlout104 限制 1 中选择 xpath(line,'MC/SC/S/@art');

我只是想知道，如何将输出保存在新的 Hive 表中。

这就是输出：

[“乐队”、“乐队”、“瀑布”、“克里登斯清水复兴”、“约翰尼·卡什”、“鲍勃·西格”、“老鹰队”、“约翰尼·霍顿”、“马蒂·罗宾斯”、“鲍勃·西格” ","Conway Twitty","Kenny Rogers & The First Edition","Neil Young","Neil Young","The Springfields","The Statler Brothers","The Statler Brothers","The Statler Brothers","史蒂夫·米勒乐队”、“史蒂夫·米勒乐队”、“盖尔·加内特”、“各种艺术家”、“威利·纳尔逊”、“老鹰队”、“老鹰队”、“公路人”、“马蒂·罗宾斯”、“马蒂·罗宾斯” “公路人”、“罗伊克拉克”、“罗伊克拉克”、“西蒙&Garfunkel”、“橡树岭男孩”、“Vern Gosdin”、“Vern Gosdin”、“John Denver”、“John Denver”、“Vince Gill”、“Vince Gill”、“Vince Gill”、“Waylon Jennings”、 “韦伦詹宁斯”]

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T19:22:36.823

在不知道您想要的表模式的情况下，将查询结果插入表中的最基本方法，例如：

```
create table results(res string);
insert overwrite table results [select statement] 
```

有关更多示例，请查看[文档](https://cwiki.apache.org/Hive/gettingstarted.html#GettingStarted-SELECTSandFILTERS)：

# mysql - MySql 错误：无法更新存储函数/触发器中的表，因为它已被调用此存储函数/触发器的语句使用

> ID：15300673
> 
> 赞同：61
> 
> 时间：2013-03-08T18:19:22.277
> 
> 标签：mysql, triggers

我正在运行 MySQL 查询。但是，当从表单输入添加新行时，我收到此错误：

```
Error: Can't update table 'brandnames' in stored function/trigger because it is 
already used by statement which invoked this stored function/trigger. 
```

从代码：

```
CREATE TRIGGER `capital` AFTER INSERT ON `brandnames`
FOR EACH
ROW UPDATE brandnames
SET bname = CONCAT( UCASE( LEFT( bname, 1 ) ) , LCASE( SUBSTRING( bname, 2 ) ) ) 
```

这个错误是什么意思？

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2013-03-08T18:35:30.783

`INSERT`触发器触发时不能更改表。可能会做一些锁定，这`INSERT`可能会导致死锁。此外，从触发器更新表会导致相同的触发器在无限递归循环中再次触发。这两个原因都是**MySQL**阻止您这样做的原因。

但是，根据您要实现的目标，您可以通过使用`NEW.fieldname`甚至是旧值*来访问新值`UPDATE`——*如果使用`OLD`.

如果你有一个命名的行`full_brand_name`，并且你想在字段中使用前两个字母作为短名称，`small_name`你可以使用：

```
CREATE TRIGGER `capital` BEFORE INSERT ON `brandnames`
FOR EACH ROW BEGIN
  SET NEW.short_name = CONCAT(UCASE(LEFT(NEW.full_name,1)) , LCASE(SUBSTRING(NEW.full_name,2)))
END 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-03-08T18:35:04.020

正确的语法是：

```
FOR EACH ROW SET NEW.bname = CONCAT( UCASE( LEFT( NEW.bname, 1 ) )
                                   , LCASE( SUBSTRING( NEW.bname, 2 ) ) ) 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-10-08T18:07:56.057

“BEFORE-INSERT”触发器是在插入时实现同表更新的唯一方法，并且只能从 MySQL 5.5+ 开始。但是，自动增量字段的值仅可用于“AFTER-INSERT”触发器 - 在 BEFORE 情况下默认为 0。因此，以下示例代码将根据自动增量值设置先前计算的代理键值`id`，但将编译，但实际上不会工作，因为 NEW.id 将始终为 0：

```
create table products(id int not null auto_increment, surrogatekey varchar(10), description text);
create trigger trgProductSurrogatekey before insert on product
for each row set NEW.surrogatekey = 
  (select surrogatekey from surrogatekeys where id = NEW.id); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-07-02T15:24:09.493

我有同样的问题并通过添加“新”来解决。在字段更新之前。我在这里发布了完整的触发器，以便有人想写一个触发器

```
DELIMITER $$

USE `nc`$$

CREATE
    TRIGGER `nhachung_province_count_update` BEFORE UPDATE ON `nhachung` 
    FOR EACH ROW BEGIN

    DECLARE slug_province VARCHAR(128);
    DECLARE slug_district VARCHAR(128);

    IF old.status!=new.status THEN  /* neu doi status */
        IF new.status="Y" THEN
            UPDATE province SET `count`=`count`+1 WHERE id = new.district_id;
        ELSE 
            UPDATE province SET `count`=`count`-1 WHERE id = new.district_id;
        END IF;
    ELSEIF old.province_id!=new.province_id THEN /* neu doi province_id + district_id */

        UPDATE province SET `count`=`count`+1 WHERE id = new.province_id; /* province_id */
        UPDATE province SET `count`=`count`-1 WHERE id = old.province_id;
        UPDATE province SET `count`=`count`+1 WHERE id = new.district_id; /* district_id */
        UPDATE province SET `count`=`count`-1 WHERE id = old.district_id;

        SET slug_province = ( SELECT slug FROM province WHERE id= new.province_id LIMIT 0,1 );
        SET slug_district = ( SELECT slug FROM province WHERE id= new.district_id LIMIT 0,1 );
        SET new.prov_dist_url=CONCAT(slug_province, "/", slug_district);

    ELSEIF old.district_id!=new.district_id THEN 

        UPDATE province SET `count`=`count`+1 WHERE id = new.district_id;
        UPDATE province SET `count`=`count`-1 WHERE id = old.district_id;

        SET slug_province = ( SELECT slug FROM province WHERE id= new.province_id LIMIT 0,1 );
        SET slug_district = ( SELECT slug FROM province WHERE id= new.district_id LIMIT 0,1 );
        SET new.prov_dist_url=CONCAT(slug_province, "/", slug_district);

    END IF;

    END;
$$

DELIMITER ; 
```

希望这对某人有帮助

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-03-11T18:24:10.630

@gerrit_hoekstra 写道：“但是，自动增量字段的值仅适用于“AFTER-INSERT”触发器 - 在 BEFORE 情况下默认为 0。”

这是正确的，但您可以很容易地选择将由后续 INSERT 插入的自动增量字段值。这是一个有效的例子：

```
CREATE DEFINER = CURRENT_USER TRIGGER `lgffin`.`variable_BEFORE_INSERT` BEFORE INSERT 
ON `variable` FOR EACH ROW
BEGIN
    SET NEW.prefixed_id = CONCAT(NEW.fixed_variable, (SELECT `AUTO_INCREMENT`
                                                FROM  INFORMATION_SCHEMA.TABLES
                                                WHERE TABLE_SCHEMA = 'lgffin'
                                                AND   TABLE_NAME   = 'variable'));      
END 
```

# javascript - 单击链接时显示 DatePicker？

> ID：15300674
> 
> 赞同：0
> 
> 时间：2013-03-08T18:19:27.210
> 
> 标签：javascript, jquery, jquery-ui

我有一个链接，我想在单击它时显示一个日期选择器：

```
$('body').on("click", ".date-link", function (e) {
    /*
    $("#daterange").dialog("option", "position",
           {
               my: "left top",
               at: "left bottom",
               of: e,
           });

    $("#daterange").dialog('open');
    */

    $(e).datepicker({
        beforeShowDay: $.datepicker.noWeekends,
        onSelect: function (dateText) {
            changeCalendarDate(dateText);
        },
        onClose: function (dateText) {
        }
    });

    $("#filter").dialog('close');
}); 
```

我还希望它在单击任何文档元素时自动关闭，除非用户选择自动关闭的日期。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T19:30:06.807

您可以在点击处理程序之外设置您的日期选择器实例。然后，当单击链接时，只需调用`.datepicker('show')`设置日期选择器的元素。

这是一个简化的示例：

**HTML**

```
<input id="date" />
<a href="#" class="date-link">Date Link</a> 
```

**JS**

```
$("#date").datepicker({
    beforeShowDay: $.datepicker.noWeekends,
    onSelect: function (dateText) {
        changeCalendarDate(dateText);
    }
});

$('.date-link').on('click', function(e) {
    // Do not follow link
    e.preventDefault();
    // Show the datepicker
    $('#date').datepicker('show');
});

function changeCalendarDate(dateText) {
    // Process date
    console.log(dateText);
} 
```

**[演示](http://jsfiddle.net/JYqqg/)**

# c# - 用户定义转换如何在 C# 中发生

> ID：15300677
> 
> 赞同：-1
> 
> 时间：2013-03-08T18:19:31.733
> 
> 标签：c#, casting, operators, implicit-conversion, explicit-conversion

任何人都可以解释以下程序，即用户定义转换是如何显式和隐式发生的？

另请参阅我对显式转换方法和隐式转换方法的评论。

```
/*** conversion.cs ***/

using System;
using System;

struct RomanNumeral {
    public RomanNumeral(int value) {
        this.value=value; // what happen here?? 
    }

    static public implicit operator RomanNumeral(int value) {
        // here the default constructor is called  and the parameter in the 
        // argument is passed for the conversion to RomanNumeral but the 
        // constructor is of the type int so how it happen please explain?? 
        return new RomanNumeral(value); 
    }

    static public explicit operator int(RomanNumeral roman) {
        return roman.value;//how it is  happen here??
    }

    static public implicit operator string(RomanNumeral roman) {
        return ("Conversion not yet implemented");
    }

    private int value;
}

class Test {
    static public void Main() {
        RomanNumeral numeral;

        numeral=10;

        Console.WriteLine((int)numeral);

        Console.WriteLine(numeral);

        short s=(short)numeral;

        Console.WriteLine(s);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T18:29:13.103

让我们从这个例子开始：

```
static public implicit operator RomanNumeral(int value)
{
    // here the default constructor is called  and the argument is passed for
    // the conversion to RomanNumeral but the parameter in the constructor is
    // of the type int so how it happen please explain ??
    return new RomanNumeral(value);
} 
```

为了便于阅读，我已移动并重新格式化了您的评论。

首先，不，默认构造函数*没有*被调用（直接，无论如何）。构造`RomanNumeral(int)`函数被调用。

将隐式运算符视为自动调用的方法很有用。所以想象我们有一个像这样的静态方法：

```
// Note: body is the same as the implicit conversion
public static RomanNumeral FromInt32(int value)
{
    return new RomanNumeral(int value);
} 
```

那么你可以这样想：

```
int x = 10;
RomanNumeral numeral = x; 
```

编译为：

```
int x = 10;
RomanNumeral numeral = RomanNumeral.FromInt32(x); 
```

只是操作符是一个没有名称的方法，您可以在 C# 中引用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T22:26:09.473

```
/*** Answer with the comments in code ***/
// You can imagine that conversion operator as `cast constructor`, though 
// it can output an instance of target type in the ways other than a real 
// constructor. 
// The semantic model is `OutputType(InputType value)`
// which means the LHS is of `OutputType` and RHS is of `InputType`. 
// For more information, see 
//      http://msdn.microsoft.com/en-us/library/85w54y0a.aspx
struct RomanNumeral {
    public RomanNumeral(int value) {
        // here the parameter `value` assiged to the field value ----+
        this.value=value;                                         // |
    }                                                             // |
    //                                                               |
    static public implicit operator RomanNumeral(int value) {     // |
        // RomanNumeral(int value) is semantically tells that it     |
        // outputs a `RomanNumeral` from taking an `int` like        |
        // the constructor.                                          |
        // Thus if there was a method `M(RomanNumeral x)`            |
        // and called with M(3), then it's called with               |
        // M((RomanNumeral)3) by effection of this implicit operator |
        // and because it's implicit, you don't need to explicitly   |
        // cast it.                                                  |
        return new RomanNumeral(value);                           // |
    }                                                             // |
    //                                                               |
    static public explicit operator int(RomanNumeral roman) {     // |
        // Here the explicit operator just does the reverse thing    |
        // of what the implicit operator does                        |
        // However, because it's declared as explicit, you'll need   |
        // to tell the compiler you want to cast explicitly, or the  |
        // compiler treats statement like `int x=myRoman;` as an     |
        // error where `myRoman` is assumed a `RomanNumeral`         |
        // So you would write the statement as `int x=(int)myRoman;` |
        // and it compiles.                                          |
        return roman.value;                                       // |
    }                                                             // |
    //                                                               |
    static public implicit operator string(RomanNumeral roman) {  // |
        return ("Conversion not yet implemented");                // |
    }                                                             // |
    //                                                               |
    private int value; // <------------------------------------------+ 
} 
```

# python - 不在类似 sql 的查询中谷歌应用引擎不工作

> ID：15300691
> 
> 赞同：0
> 
> 时间：2013-03-08T18:20:31.730
> 
> 标签：python, google-app-engine, google-cloud-datastore

如何转这个：

```
Contact.gql('WHERE email IN :1', emails) 
```

emails 是一个电子邮件列表，例如：["foo@example.com", "foo2@example.com"]

进入这个：

```
Contact.gql('WHERE email NOT IN :1', emails) 
```

它引发了一个错误：

```
BadQueryError: Parse Error: Invalid WHERE Condition at symbol NOT 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-08T19:09:26.463

不是它不起作用，而是你正在尝试一些不受支持的东西。

请参阅[https://developers.google.com/appengine/docs/python/datastore/gqlreference](https://developers.google.com/appengine/docs/python/datastore/gqlreference)

# java - 如何通过他的手机/平板电脑在我的 Android 应用程序上获取用户 IP 地址上网

> ID：15300692
> 
> 赞同：0
> 
> 时间：2013-03-08T18:20:33.877
> 
> 标签：java, android, mobile, ip

我创建了一个使用 WebView 加载互联网页面的 Android 应用程序。我想获取移动用户 IP 地址。怎么做？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T18:30:54.150

这将在屏幕上加载 IP 地址

```
 webview.loadUrl("http://www.whatismyip.com") 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-08T18:32:13.473

```
public static String getipAddress() { 
            try {
                for (Enumeration en = NetworkInterface.getNetworkInterfaces(); en.hasMoreElements();) {
                    NetworkInterface intf = en.nextElement();
                    for (Enumeration enumIpAddr = intf.getInetAddresses(); enumIpAddr.hasMoreElements();) {
                        InetAddress inetAddress = enumIpAddr.nextElement();
                        if (!inetAddress.isLoopbackAddress()) {
                            String ipaddress=inetAddress.getHostAddress().toString();
                            Log.e("ip address",""+ipaddress);
                            return ipaddress;
                        }
                    }
                }
            } catch (SocketException ex) {
                Log.e("Socket exception in GetIP Address of Utilities", ex.toString());
            }
            return null; 
    } 
```

还添加了 mainfest

```
<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" /> 
```

# matlab - 为什么梯度下降算法的解总是朝着正确的方向发展？

> ID：15300693
> 
> 赞同：1
> 
> 时间：2013-03-08T18:20:36.253
> 
> 标签：matlab, optimization, gradient-descent

我对经典梯度下降算法有疑问。最近我想实现一个函数拟合程序，提供观察数据以及给定函数的参数。我使用的方法是梯度下降算法，因为函数的导数可用。假设给定函数参数，我可以根据函数创建模拟数据：

```
clean;
rng('default');
rng(54321);
low_value = 15;
high_value = 200;
dis_value  = (high_value-low_value)/2;
central_value = (low_value+high_value)/2;
x = 1:55;
central_pixel = (1+length(x))/2;
delta = 3;
len = length(x);
y_true = dis_value*erf((x-central_pixel)./delta)+central_value;
y = y_true + randn(1,len);
figure;plot(x,y,'b*');
hold on; plot(x,y_true,'r'); 
```

下图显示了模拟数据（模糊星号点）以及势函数（红色）： ![在此处输入图像描述](../Images/2cb772b1c4e763ce11be6722cf952061.png) 从图中可以看出，在这个例子中有两个参数需要估计，一个是中心点位置 p，另一个是是标准推导增量，函数写为

![在此处输入图像描述](../Images/c8cab6fbc214f1491feb065fe0c2f0b2.png)

其中 A 和 B 可以认为是已知的。那么如果我想使用梯度下降算法，我应该做两件事：一是分别为两个未知参数（p和delta）定义函数的导数，二是调用梯度下降算法。但是，我发现令人困惑的是，在迭代过程中，估计参数之一（delta）并不总是朝着正确的方向发展：

![在此处输入图像描述](../Images/b7484cfc84d9477e28da9fc2d69454cd.png)

但是，我确实注意到，目标函数（拟合点与估计函数之间的平方距离之和）总是变得更小： ![在此处输入图像描述](../Images/977918ed92b11521fcc7e2ffa5da4177.png)

那么我的问题是为什么解决方案并不总是朝着正确的方向发展，即使最终它们可以到达正确的位置。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T21:51:06.907

梯度下降最小化器只是跟随函数在其当前位置的负梯度。您（可能）给出了`(p,delta)`负梯度增量增加的最小化起始值。对于不同的起始值，您可能会看到不同的行为。

一个想法，虽然。因为`erfc( (x-p)/delta )`具有 的比率`p/delta`，所以您的参数有些相互依赖。也就是说，对于较小的 值`x`或较大的 值`p/delta`，比率将占主导地位，并且最小化器可能会陷入分子和分母大小不断增加的循环中。

尝试使用修改后的参数：`erfc( x/delta - pdratio )`, 并拟合到`delta`和`pdratio`。然后，您可以退出原始`p`参数：`p = pdratio*delta`.

# asp.net-mvc-4 - MVC WebApi + 基础认证 + JSONP 跨域

> ID：15300696
> 
> 赞同：2
> 
> 时间：2013-03-08T18:20:47.087
> 
> 标签：asp.net-mvc-4, asp.net-web-api, jsonp, basic-authentication

我正在尝试创建一个基于 MVC 的站点，通过 WebApi 向本地页面和外部客户端提供一些服务，因此需要 JSONP 来避免同源策略错误。问题是该站点使用的是基本身份验证，正如我从这里的其他帖子中了解到的那样，无法使用 JSONP。我尝试在 URL 中注入 user:pass，如文章[How do I make a JSONP call with JQuery with Basic Authentication 中所建议的那样？](https://stackoverflow.com/questions/1640391/how-do-i-make-a-jsonp-call-with-jquery-with-basic-authentication)，但这不起作用，服务器返回未经授权的代码。此外，我尝试在不注入的情况下拨打电话，因为我可以在浏览器中输入用户名和密码：浏览器按预期要求我提供凭据，但由于某种原因它们被拒绝，再次以未经授权的代码结束. 然而凭据是好的，我可以通过从同一个域成功运行完全相同的代码来确认。谁能告诉我我的代码有什么问题？

我的 MVC WebApi 控制器操作如下：

```
[BasicAuthorize(Roles = "administrator,customer,trial")]
public class TextApiController : ApiController
{
      // ...

    public SomeResult Get([FromUri] SomeParams p)
    {
          // some processing which returns a SomeResult object
          //...
    }
} 
```

其中 BasicAuthorize 属性是我从[http://kevin-junghans.blogspot.it/2013/02/mixing-forms-authentication-basic.html](http://kevin-junghans.blogspot.it/2013/02/mixing-forms-authentication-basic.html)修改的类，如下所示：

```
[AttributeUsageAttribute(AttributeTargets.Class |
    AttributeTargets.Method, Inherited = true,
    AllowMultiple = true)]
public sealed class BasicAuthorizeAttribute : AuthorizeAttribute
{
    static private string DecodeFrom64(string sEncodedData)
    {
        byte[] encodedDataAsBytes = Convert.FromBase64String(sEncodedData);
        return Encoding.ASCII.GetString(encodedDataAsBytes);
    }

    static private bool GetUserNameAndPassword(HttpActionContext context,
        out string sUserName,
        out string sPassword,
        out bool bCookieAuthorization)
    {
        bCookieAuthorization = false;
        bool bSuccess = false;
        sUserName = sPassword = "";
        IEnumerable<string> headerVals;

        if (context.Request.Headers.TryGetValues("Authorization", out headerVals))
        {
            try
            {
                string sAuthHeader = headerVals.First();
                string[] authHeaderTokens = sAuthHeader.Split();

                if (authHeaderTokens[0].Contains("Basic"))
                {
                    string sDecoded = DecodeFrom64(authHeaderTokens[1]);
                    string[] aPairMembers = sDecoded.Split(new[] { ':' });
                    sUserName = aPairMembers[0];
                    sPassword = aPairMembers[1];
                } 
                else
                {
                    if (authHeaderTokens.Length > 1)
                        sUserName = DecodeFrom64(authHeaderTokens[1]);
                    bCookieAuthorization = true;
                } 

                bSuccess = true;
            }
            catch
            {
                bSuccess = false;
            }
        } 

        return bSuccess;
    }

    static private bool Authenticate(HttpActionContext actionContext,
        out string sUserName)
    {
        bool bIsAuthenticated = false;
        string sPassword;
        bool bCookieAuthorization;

        if (GetUserNameAndPassword(actionContext,
            out sUserName, out sPassword, out bCookieAuthorization))
        {
            // if the header tells us we're using Basic auth then log the user in
            if (!bCookieAuthorization)
            {
                if (WebSecurity.Login(sUserName, sPassword, true))
                    bIsAuthenticated = true;
                else
                    WebSecurity.Logout();
            } 
            // else get authentication from web security
            else
            {
                if (WebSecurity.IsAuthenticated) bIsAuthenticated = true;
                sUserName = WebSecurity.CurrentUserName;
            } 
        } 
        else actionContext.Response =
            new HttpResponseMessage(HttpStatusCode.BadRequest);

        return bIsAuthenticated;
    }

    private bool IsAuthorized(string sUserName)
    {
        SimpleRoleProvider roles =
            (SimpleRoleProvider)System.Web.Security.Roles.Provider;
          string[] aRoles = Roles.Split(new[] {','});

        return (aRoles.Any(sRole => roles.IsUserInRole(sUserName, sRole)));
    }

    public override void OnAuthorization(HttpActionContext actionContext)
    {
        string sUserName;

        if (Authenticate(actionContext, out sUserName))
        {
            if (!IsAuthorized(sUserName))
                actionContext.Response = new HttpResponseMessage(HttpStatusCode.Forbidden);
        } 
        else
        {
            actionContext.Response = new HttpResponseMessage(HttpStatusCode.Unauthorized);
        } 
    }
} 
```

我的客户端代码是一个带有一些 Javascript（使用 jQuery）的简单 HTML 页面，例如：

```
...
<form>
    <fieldset>
        <legend></legend>
        <ol>
            <li>
                input text
                <input type="text" id="input"/>
            </li>
            <li>
                username
                <input type="text" id="user"/>
            </li>
            <li>
                password
                <input type="password" id="password"/>
            </li>
            <li><a href="#" id="apip">API: JSONP</a></li>
        </ol>
    </fieldset>
</form>
<div id="result"></div>
<script>
    function getAuthorizationHeader(username, password) {
        "use strict";
        var authType;

        if (password == "") {
            authType = "Cookie " + $.base64.encode(username);
        }
        else {
            var up = $.base64.encode(username + ":" + password);
            authType = "Basic " + up;
        };
        return authType;
    };

    function ajaxSuccessHandler(data) {
        "use strict";
        $("#result").text(data);
    };

    function ajaxErrHandler(jqXHR, textStatus, errorThrown) {
        "use strict";
        $("#result").text(errorThrown + " : " + textStatus);
    }

    $(function () {
        "use strict";

        $("#apip").click(function () {
            "use strict";
            var text = $("#input").val();
            $.ajax({
                url: "https://somesiteurl.com/api/wordapi?Text=" + encodeURIComponent(text),
                dataType: "jsonp",
                type: "GET",
                beforeSend: function (xhr) {
                    xhr.setRequestHeader("Authorization", getAuthorizationHeader($("#user").val(), $("#password").val()));
                },
                success: ajaxSuccessHandler,
                error: ajaxErrHandler
            });
        });
    });
</script> 
```

## CORS

抱歉回复晚了...我正在按照建议尝试使用 CORS，但我肯定会遗漏一些明显的东西，因为我的客户发送的标头不包括 Origin。这是我所做的，通过使用来自[http://brockallen.com/2012/06/28/cors-support-in-webapi-mvc-and-iis-with-thinktecture-identitymodel/](http://brockallen.com/2012/06/28/cors-support-in-webapi-mvc-and-iis-with-thinktecture-identitymodel/)的库：

1.  我创建了一个新的 MVC4 互联网应用程序来测试这个场景，并使用 NuGet 添加 Thinktecture.IdentityModel。

2.  在 App_Start 我创建了这个 CorsConfig 类：

```
`static public class CorsConfig
{
    public static void RegisterCorsForWebApi(HttpConfiguration httpConfig)
    {
        WebApiCorsConfiguration corsConfig = new WebApiCorsConfiguration();

```
 // this adds the CorsMessageHandler to the HttpConfiguration’s 
    // MessageHandlers collection
    corsConfig.RegisterGlobal(httpConfig);

    corsConfig
        .ForResources("Products")
        .ForOrigins("http://hello.net")
        .AllowAll();
}

public static void RegisterCorsForMvc(MvcCorsConfiguration corsConfig)
{
    corsConfig
        .ForResources("Products.GetProducts")
        .ForOrigins("http://hello.net")
        .AllowAll();
} 
```

}` 
```

`*   在 Global.asax.cs 我调用这个类的两个方法。

    *   在 web.config 中添加：

    *   我在返回一些 JSON 的 MVC 控制器中创建了一个简单的操作方法。我计划稍后用 [Authorize] 进行装饰，一旦调用正确放置在客户端，我就可以测试身份验证（和授权，添加角色）。

    *   在一个视图中，我将我的方法称为：` 

 ````
`var text = $("#input").val();
var json = "{'text': " + JSON.stringify(text) + "}";
$.ajax({
    url: "/Home/GetSomeJson",
    dataType: "json",
    data: json,
    type: "GET",
    beforeSend: function (xhr) {
        xhr.withCredentials = true;
    },
    crossDomain: true,
    username: $("#user").val(),
    password: $("#password").val(),
    success: ajaxSuccessHandler,
    error: ajaxErrHandler
});` 
```

`然而，检查标题我看不到起源。此外，这是为对 MVC 操作/WebApi 的 CORS 调用传递凭据的正确方法（当然在现实世界中这将是 HTTPS）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-10T20:00:41.953

为什么你不使用[CORS](http://en.wikipedia.org/wiki/Cross-origin_resource_sharing)启用你的 web api 服务而不是使用 JSONP？. [这](http://blogs.msdn.com/b/carlosfigueira/archive/2012/07/02/cors-support-in-asp-net-web-api-rc-version.aspx)是一篇很棒的文章，解释了如何在 Web API 中启用 CORS 支持``

# frame - 我如何为弹跳的球增加重力？

> ID：15300701
> 
> 赞同：0
> 
> 时间：2013-03-08T18:21:06.870
> 
> 标签：frame, gravity

我希望下面代码中的球根据重力反弹。此刻，它在墙壁的框架周围弹跳。我正在制作愤怒的小鸟版本，所以重力是关键。我有一些想法，使用二次方程来制作抛物线，然后球会跟随，但我不确定具体的编码。

```
import java.awt.*;
import javax.swing.*;
import java.awt.event.*;

/**
* One ball bouncing inside a rectangular box. 
* All codes in one file. Poor design!
*/
// Extends JPanel, so as to override the paintComponent() for custom rendering codes. 
public class BouncingBallSimple extends JPanel {
// Container box's width and height
private final int BOX_WIDTH = 700;
private final int BOX_HEIGHT = 700;

// Ball's properties
private float ballRadius = 15; // Ball's radius
private float ballX = ballRadius + 50; // Ball's center (x, y)
private float ballY = ballRadius + 20; 
private float ballSpeedX = 60;   // Ball's speed for x and y
private float ballSpeedY = 60;

private static final int UPDATE_RATE = 30; // Number of refresh per second

/** Constructor to create the UI components and init game objects. */
public BouncingBallSimple() {
  this.setPreferredSize(new Dimension(BOX_WIDTH, BOX_HEIGHT));

  // Start the ball bouncing (in its own thread)
  Thread gameThread;
   gameThread = new Thread() {
@Override
public void run() {
  while (true) { // Execute one update step
     // Calculate the ball's new position
     ballX += ballSpeedX;
     ballY += ballSpeedY;
     // Check if the ball moves over the bounds
     // If so, adjust the position and speed.
     if (ballX - ballRadius < 0) {
        ballSpeedX = -ballSpeedX; // Reflect along normal
        ballX = ballRadius; // Re-position the ball at the edge
     } else if (ballX + ballRadius > BOX_WIDTH) {
        ballSpeedX = -ballSpeedX;
        ballX = BOX_WIDTH - ballRadius;
     }
     // May cross both x and y bounds
     if (ballY - ballRadius < 0) {
        ballSpeedY = -ballSpeedY;
        ballY = ballRadius;
     } else if (ballY + ballRadius > BOX_HEIGHT) {
        ballSpeedY = -ballSpeedY;
        ballY = BOX_HEIGHT - ballRadius;
     }
     // Refresh the display
     repaint(); // Callback paintComponent()
     // Delay for timing control and give other threads a chance
     try {
        Thread.sleep(1000 / UPDATE_RATE);  // milliseconds
     } catch (InterruptedException ex) { }
  }
}
};
  gameThread.start();  // Callback run()
}

/** Custom rendering codes for drawing the JPanel */
@Override
public void paintComponent(Graphics g) {
  super.paintComponent(g);    // Paint background

  // Draw the box
  g.setColor(Color.CYAN);
  g.fillRect(0, 0, getWidth(), getHeight());

  // Draw the ball
  g.setColor(Color.BLUE);
  g.fillOval((int) (ballX - ballRadius), (int) (ballY - ballRadius),
        (int)(2 * ballRadius), (int)(2 * ballRadius));
                    Graphics2D comp2D = (Graphics2D) g;                  
                    comp2D.drawRect(0, 645, 1365, 100);
                    comp2D.setColor(Color.GREEN);
                    comp2D.fillRect(0, 645, 1365, 100);
                    Graphics2D stand = (Graphics2D) g;
                    stand.setColor(Color.BLACK);
                    stand.fillRect(80, 575, 30, 70);
                    Graphics2D sling = (Graphics2D) g;
                    sling.drawArc(15, 570, 90, 50, 50, 250);
}

/** main program (entry point) */
public static void main(String[] args) {
  // Run GUI in the Event Dispatcher Thread (EDT) instead of main thread.
  javax.swing.SwingUtilities.invokeLater(new Runnable() {
     @Override
     public void run() {
        // Set up main window (using Swing's Jframe)
        JFrame frame = new JFrame("Angry Birds for Annie May Tion");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setContentPane(new BouncingBallSimple());
        frame.pack();
        frame.setVisible(true);
     }
  });
}
} 
```

# java - 访问地图的最佳方式

> ID：15300703
> 
> 赞同：1
> 
> 时间：2013-03-08T18:21:12.340
> 
> 标签：java, map

考虑以下情况：

我有一个以 String 为键的映射，另一个 Map 作为值。现在value中的Map也是一个以String为key、以Map为value的Map。我们有这样的 n 个级别，最后一个级别有一个 Map，其中 String 为键，String 为值。现在假设，我有每个级别的键列表。我必须得到最终的字符串值。

这就是我想在java中实现它的方式：

```
Object q = initialMap; 
for(String key : keyList)
{
    Map x = (Map)q;
    q = x.get(key);
}
return (String)q; 
```

这是处理这个问题的正确方法吗？我收到了未经检查的转换警告。有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T18:40:14.090

我想我理解你的问题，你从一个文件中获得一个字符串映射到字符串映射到......等等的映射。这样的事情：

```
 Map<String, Map<String, Map<String, Map<String, String>>>> initialMap; 
```

您的问题中不清楚的是您是否知道会有多少级别的地图。如果是，那么只需像我刚刚所做的那样（对于 4 个级别的地图）编写您需要的级别数的 initialMap。

如果你事先不知道你有多少级别，那就更难了。在这种情况下，您的算法是合理的。我只会让它更像这样的泛型：

```
Object q = initialMap; 
for(String key : keyList)
{
    Map<String, ?> x = (Map<String, ?>)q;
    q = x.get(key);
}
return (String)q; 
```

但这总是会给你一个警告，你必须通过在方法中添加 @SuppressWarnings("unchecked") 来抑制。

您可以尝试在方法中将其抽象出来。

**编辑**：有一种方法可以在实用程序类中完全抽象它。我会称你想要一种递归地图。您的任何 Map 要么是从 String 到 String 的映射，要么是从 String 到递归映射的映射。这可以这样抽象：

```
interface IRecursiveMap {
  String get(List<String> keyList);
}

class RecursiveMap implements IRecursiveMap{
  Map<String, IRecursiveMap> map;

  @Override
  public String get(List<String> keyList) {
    String key = keyList.get(0);
    return map.get(key).get(keyList.subList(1, keyList.size()));
  }
}

class ValueMap implements IRecursiveMap{
  Map<String, String> map;

  @Override
  public String get(List<String> keyList) {
    String key = keyList.get(0);
    return map.get(key);
  }
} 
```

因此 IRecursiveMap 是定义映射的常见行为的接口：从键列表中获取某些内容的能力。RecursiveMap 是将一个 String 映射到另一个 IRecursiveMap 的实现，而 ValueMap 是递归的最后一个映射，它实际上将 String 映射到 String。

该实施的好处是：

*   代码正确使用泛型并且数据是完全类型化的。这意味着您没有更多通用警告。
*   在这个映射链中存储东西的所有逻辑都抽象在几个实用程序类中。

另一方面，缺点是填充地图可能有点复杂，但同样可以递归完成。

# javascript - 使用我的 JQuery 函数进行 sql 变量名验证的正则表达式

> ID：15300704
> 
> 赞同：1
> 
> 时间：2013-03-08T18:21:14.840
> 
> 标签：javascript, jquery, regex

我需要让它工作，我已经在谷歌上搜索了大约`45`几分钟。

这就是我想要做的......（请注意，我正在使用替换功能，所以我猜正则表达式应该是我想要的任何东西......？）

```
 $('#parameter_name').keyup(function(e){   

      var regex_str = '/@[a-zA-Z][a-zA-Z0-9]/';

      var val       = $(this).val();     

      val           = val.replace(regex_str, ''); 

      $(this).val(val); 
   }); 
```

这就是我需要正则表达式允许的：

*   第一个字符必须是`@`
*   第二个字符必须在`[a-zA-Z]`
*   可能有 0-多个以下字符`[a-zA-Z0-9_]`

（旁注：我意识到这`_`可能在第二个字符位置，但这有点复杂，因为它需要第三个字符不是 a`_`并且不符合我所拥有的其余规则......我正在做简单的事情，只是不允许它）

我放在那里的东西..它最终会留下空白并做其他奇怪的事情。

**编辑：** 所以...我尝试了几种方法，但从未找到完美的解决方案

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T18:22:34.270

对于您的书面规范，您似乎需要

```
/^@[a-zA-Z][a-zA-Z0-9]*/ 
```

匹配字符串的`^`开头，因此您之前不能拥有某些东西。

如果您想要匹配字符串中可能不止一次出现，那么您可能需要测试单词边界并添加`g`标志：

```
/\b@[a-zA-Z][a-zA-Z0-9]*\b/g 
```

另请注意，正则表达式不是字符串，而是[正则表达式文字](https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Regular_Expressions)，您必须删除`'`: 它是

```
val.replace(/\b@[a-zA-Z][a-zA-Z0-9]*\b/g, ''); 
```

代替

```
val.replace('/\b@[a-zA-Z][a-zA-Z0-9]*\b/g', ''); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T18:24:48.953

这应该有效：

```
'/@[a-zA-Z][a-zA-Z0-9_]*/' 
```

@ 字符，后跟一个字母，后跟零个或多个字母、数字和下划线。

# c++ - 将类放在单独的文件中不起作用[C++]

> ID：15300705
> 
> 赞同：0
> 
> 时间：2013-03-08T18:21:16.520
> 
> 标签：c++, class

我尝试使用 c++ 将一个类放在一个单独的文件中，但不包括 .cpp 文件，它不起作用。

这是类示例的 CPP 文件

```
//Example.cpp
#include "Example.h"
#include<iostream>
using namespace std;

Example::Example()
{
    cout<<"I am am Executed\n";
} 
```

这是头文件

```
//Example.h
#ifndef EXAMPLE_H
#define EXAMPLE_H

class Example
{
    public:
        Example();
};
#endif 
```

现在如果我不将 C++ 文件包含到我的主函数文件中，它会给出一个错误

```
#include "Example.h"
//#include "Example.cpp"
#include<iostream>
using namespace std;
int main()
{
    Example aak;
    return 0;
} 
```

所以在这里我注释掉了**//#include "Example.cpp"**，它会给我一个错误，说明

```
/tmp/ccuHMRJB.o: In function `main':
main.cpp:(.text+0x10): undefined reference to `Example::Example()'
collect2: ld returned 1 exit status 
```

但是，如果我取消注释 #include "Example.cpp" 它工作得很好！给我一个输出

> > 我被执行了！

我不明白为什么我需要包含两个文件（.h 和 .cpp）来执行程序。只要我认为它应该只包含 .h 文件就可以工作，但它没有......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T18:22:45.020

您不应该**在**`.cpp`其他文件中包含`.cpp`文件。相反，`.cpp`在编译器命令行上列出构成您的项目的所有文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T18:25:01.743

这是因为当您包含 cpp 文件时，该文件（即函数）也在被编译。但是，当您包含原型文件，即头文件时，您还必须指定在何处搜索功能代码的可执行代码。表示链接器将在哪里找到您以二进制形式（已编译）存储 cpp 文件的库，否则需要对其进行编译。我认为后一种情况是你的情况（即你没有从你的 cpp 文件创建一个库）。现在想想如果你不包含 cpp 文件，它就不会被编译。然后你正在调用一个二进制代码不存在的函数。

* * *

因此，如果您不包含 cpp 文件，链接器将引发错误

# c# - ASP.net 部署程序集错误

> ID：15300708
> 
> 赞同：0
> 
> 时间：2013-03-08T18:21:30.940
> 
> 标签：c#, asp.net, deployment, .net-assembly

将我的 ASP.NET 项目部署到我们的服务器时出现问题。

网络配置：

```
 <?xml version="1.0" encoding="utf-8"?>
<!--
  For more information on how to configure your ASP.NET application, please visit
  http://go.microsoft.com/fwlink/?LinkId=169433
  -->
<configuration>
  <!--For crystal Report-->
  <configSections>
    <sectionGroup name="businessObjects">
      <sectionGroup name="crystalReports">
        <section name="rptBuildProvider" type="CrystalDecisions.Shared.RptBuildProviderHandler, CrystalDecisions.Shared, Version=13.0.2000.0, Culture=neutral, PublicKeyToken=692fbea5521e1304, Custom=null" />
        <section name="crystalReportViewer" type="System.Configuration.NameValueSectionHandler" />
      </sectionGroup>
    </sectionGroup>
  </configSections>
  <businessObjects>
    <crystalReports>
      <rptBuildProvider>
        <add embedRptInResource="true" />
      </rptBuildProvider>
      <crystalReportViewer>
        <add key="ResourceUri" value="/crystalreportviewers13" />
      </crystalReportViewer>
    </crystalReports>
  </businessObjects>
  <appSettings>
    <add key="CrystalImageCleaner-AutoStart" value="true" />
    <add key="CrystalImageCleaner-Sleep" value="60000" />
    <add key="CrystalImageCleaner-Age" value="120000" />
    <!--For crystal Report-->
  </appSettings>
  <connectionStrings>
    <clear />        

    <add name="EB_WebProjectEntities" connectionString="metadata=res://*/ClassModel.Database.EB_WebProject.csdl|res://*/ClassModel.Database.EB_WebProject.ssdl|res://*/ClassModel.Database.EB_WebProject.msl;provider=System.Data.SqlClient;provider connection string=&quot;data source=NATE-PC\SQLEXPRESS2008;initial catalog=EB_NEW;user id=user1;password=user;multipleactiveresultsets=True;App=EntityFramework&quot;" providerName="System.Data.EntityClient" />
    <add name="EB_NEWConnectionString" connectionString="Data Source=NATE-PC\SQLEXPRESS2008;Initial Catalog=EB_NEW;Persist Security Info=True;User ID=user1;Password=user" providerName="System.Data.SqlClient" />    

    <!--<add name="EB_WebProjectEntities" connectionString="metadata=res://*/ClassModel.Database.EB_WebProject.csdl|res://*/ClassModel.Database.EB_WebProject.ssdl|res://*/ClassModel.Database.EB_WebProject.msl;provider=System.Data.SqlClient;provider connection string=&quot;data source=KOO-PC\SQLEXPRESS;initial catalog=EB_NEW;user id=user1;password=user;multipleactiveresultsets=True;App=EntityFramework&quot;" providerName="System.Data.EntityClient" />
    <add name="EB_NEWConnectionString" connectionString="Data Source=KOO-PC\SQLEXPRESS;Initial Catalog=EB_NEW;Persist Security Info=True;User ID=user1;Password=user" providerName="System.Data.SqlClient" />-->        

  </connectionStrings>
  <!--Koo Testing Server-->
  <system.web>
    <customErrors mode="Off" defaultRedirect="~/Module/SharedPage/ErrorPage.aspx">
      <error statusCode="403" redirect="~/Module/SharedPage/ErrorPage.aspx" />
      <error statusCode="404" redirect="~/Module/SharedPage/ErrorPage.aspx" />
    </customErrors>
    <httpHandlers>
      <add path="Reserved.ReportViewerWebControl.axd" verb="*" type="Microsoft.Reporting.WebForms.HttpHandler, Microsoft.ReportViewer.WebForms, Version=10.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" validate="false" />
      <add verb="GET" path="CrystalImageHandler.aspx" type="CrystalDecisions.Web.CrystalImageHandler, CrystalDecisions.Web, Version=13.0.2000.0, Culture=neutral, PublicKeyToken=692fbea5521e1304" />
    </httpHandlers>
    <pages enableSessionState="true" />
    <httpRuntime executionTimeout="86400" />
    <!--set the default time format to Malaysia (Koo-8/3/2011)-->
    <globalization culture="en-MY" uiCulture="en" responseEncoding="utf-8" />
    <compilation debug="true" targetFramework="4.0">
      <assemblies>
        <add assembly="System.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A" />
        <add assembly="System.Web.Extensions.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
        <add assembly="System.Windows.Forms, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089" />
        <add assembly="System.Data.Entity, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" />
        <add assembly="Microsoft.ReportViewer.WebForms, Version=10.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A" />
        <add assembly="Microsoft.ReportViewer.Common, Version=10.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A" />
        <add assembly="Microsoft.Build.Framework, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A" />
        <add assembly="System.Management, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A" />
        <add assembly="log4net, Version=1.2.10.0, Culture=neutral, PublicKeyToken=692FBEA5521E1304" />
        <add assembly="CrystalDecisions.Web, Version=13.0.2000.0, Culture=neutral, PublicKeyToken=692FBEA5521E1304" />
        <add assembly="CrystalDecisions.Shared, Version=13.0.2000.0, Culture=neutral, PublicKeyToken=692FBEA5521E1304" />
        <add assembly="CrystalDecisions.ReportSource, Version=13.0.2000.0, Culture=neutral, PublicKeyToken=692FBEA5521E1304" />
        <add assembly="CrystalDecisions.ReportAppServer.Controllers, Version=13.0.2000.0, Culture=neutral, PublicKeyToken=692FBEA5521E1304" />
        <add assembly="CrystalDecisions.ReportAppServer.DataDefModel, Version=13.0.2000.0, Culture=neutral, PublicKeyToken=692FBEA5521E1304" />
        <add assembly="CrystalDecisions.CrystalReports.Engine, Version=13.0.2000.0, Culture=neutral, PublicKeyToken=692FBEA5521E1304" />
        <add assembly="CrystalDecisions.CrystalReports.Engine, Version=13.0.2000.0, Culture=neutral, PublicKeyToken=692fbea5521e1304" />
        <add assembly="CrystalDecisions.ReportSource, Version=13.0.2000.0, Culture=neutral, PublicKeyToken=692fbea5521e1304" />
        <add assembly="CrystalDecisions.Shared, Version=13.0.2000.0, Culture=neutral, PublicKeyToken=692fbea5521e1304" />
        <add assembly="CrystalDecisions.ReportAppServer.ClientDoc, Version=13.0.2000.0, Culture=neutral, PublicKeyToken=692fbea5521e1304" />
      </assemblies>
      <buildProviders>
        <add extension=".rdlc" type="Microsoft.Reporting.RdlBuildProvider, Microsoft.ReportViewer.WebForms, Version=10.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" />
      </buildProviders>
    </compilation>
    <authorization>
      <allow users="*" />
    </authorization>
    <membership>
      <providers>
        <clear />
        <add name="AspNetSqlMembershipProvider" type="System.Web.Security.SqlMembershipProvider" connectionStringName="ApplicationServices" enablePasswordRetrieval="false" enablePasswordReset="true" requiresQuestionAndAnswer="false" requiresUniqueEmail="false" maxInvalidPasswordAttempts="5" minRequiredPasswordLength="6" minRequiredNonalphanumericCharacters="0" passwordAttemptWindow="10" applicationName="/" />
      </providers>
    </membership>
    <profile>
      <providers>
        <clear />
        <add name="AspNetSqlProfileProvider" type="System.Web.Profile.SqlProfileProvider" connectionStringName="ApplicationServices" applicationName="/" />
      </providers>
    </profile>
    <roleManager enabled="false">
      <providers>
        <clear />
        <add name="AspNetSqlRoleProvider" type="System.Web.Security.SqlRoleProvider" connectionStringName="ApplicationServices" applicationName="/" />
        <add name="AspNetWindowsTokenRoleProvider" type="System.Web.Security.WindowsTokenRoleProvider" applicationName="/" />
      </providers>
    </roleManager>
    <!--HTTPMODULE Part-->
    <httpModules>
      <add name="ValidateUser" type="BLClass.BLCommon.HMValidateType" />
    </httpModules>
    <!--HTTPMODULE Part-->
  </system.web>
  <system.web.extensions>
    <scripting>
      <scriptResourceHandler enableCompression="true" enableCaching="true" />
    </scripting>
  </system.web.extensions>
  <system.webServer>
    <modules>
      <add name="ValidateUser" type="BLClass.BLCommon.HMValidateType" preCondition="" />
    </modules>
    <handlers>
      <add name="ReportViewerWebControlHandler" preCondition="integratedMode" verb="*" path="Reserved.ReportViewerWebControl.axd" type="Microsoft.Reporting.WebForms.HttpHandler, Microsoft.ReportViewer.WebForms, Version=10.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" />
      <add name="ScriptResource" preCondition="integratedMode" verb="GET,HEAD" path="ScriptResource.axd" type="System.Web.Handlers.ScriptResourceHandler, System.Web.Extensions, Version=1.0.61025.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
      <add name="CrystalImageHandler.aspx_GET" verb="GET" path="CrystalImageHandler.aspx" type="CrystalDecisions.Web.CrystalImageHandler, CrystalDecisions.Web, Version=13.0.2000.0, Culture=neutral, PublicKeyToken=692fbea5521e1304" preCondition="integratedMode" />
    </handlers>
    <validation validateIntegratedModeConfiguration="false" />
  </system.webServer>
</configuration> 
```

这是我得到的错误

```
Parser Error Message: 
Could not load file or assembly 'System.Design, Version=4.0.0.0, PublicKeyToken=b03f5f7f11d50a3a' or one of its dependencies. The system cannot find the file specified.

Could not load file or assembly 'log4net, Version=1.2.10.0, Culture=neutral, PublicKeyToken=692fbea5521e1304' or one of its dependencies. The located assembly's manifest definition does not match the assembly reference. (Exception from HRESULT: 0x80131040)

Could not load file or assembly 'CrystalDecisions.Web, Version=13.0.2000.0, Culture=neutral, PublicKeyToken=692fbea5521e1304' or one of its dependencies. The system cannot find the file specified. 
```

所有与`crystaldecision`抛出上述错误相关的程序集。有人有解决方案吗？我使用的是window server 2008。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T18:26:22.587

您需要在服务器上安装 Crystal Reports redist。这篇 SO 文章有一些很好的解释和下载[Crystal Reports 13 和 Asp.Net 3.5的链接](https://stackoverflow.com/questions/5193887/crystal-reports-13-and-asp-net-3-5?rq=1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T18:26:49.350

如果您要部署到 64 位计算机，则需要在运行您的网站的应用程序池中启用 32 位应用程序。据我所知，Log4net 是 32 位 dll。

您可以在应用程序池设置中看到[此问题。](https://stackoverflow.com/questions/5216192/enable-application-pool-32-bit-mode-on-64-bit-server)

# c++ - 按 C++ 顺序解析 XML

> ID：15300711
> 
> 赞同：0
> 
> 时间：2013-03-08T18:21:50.193
> 
> 标签：c++, recursion, binary-tree, rapidxml

这与我之前的一个问题有关。我正在尝试从 xml 文件构建一棵树。我计划浏览 xml 文件并从数据中创建对象，并按前序和中序创建对象的向量，以便我可以构造树对象。我使用的 xml 文件比这要密集得多（大约 23 级左右），但这里是一个布局示例：

```
<?xml version="1.0" encoding="utf-8"?>
<MyJournal>
    <species>
        <name>Sea Creature</name>
        <species>
            <name>Fish</name>
            <species>
                <name>swordfish</name>
            </species>
            <species>
                <name>grouper</name>
            </species>
        </species>
        <species>
            <name>Mammal</name>
            <species>
                <name>dolphin</name>
            </species>
            <species>
                <name>whale</name>
            </species>
        </species>
    </species>
    <species>
        <name>Land animal</name>
        <species>
            <name>Mammal</name>
            <species>
                <name>dog</name>
            </species>
            <species>
                <name>cat</name>
            </species>
        </species>
        <species>
            <name>Bird</name>
            <species>
                <name>blue jay</name>
            </species>
            <species>
                <name>robin</name>
            </species>
        </species>
    </species>
</MyJournal> 
```

我的预购和后购方法。首先传入根节点“MyJournal”。

```
void preOrder(xml_node<> *species) // add to left node
{
    Node t1 = *new Node();
    xml_node<> * name_node = species->first_node("name");
    //If there is a value for name, set the name of the node to this name
    if(name_node != 0)
    {
        t1.setName(name_node->value());
        cout << t1.getName() << " ";
    }
    //If there is no name node, print the default name which is "ROOT"
    if(name_node == 0)
    {
        cout << t1.getName() << " ";
    }
    for (xml_node<> * child_node = species->first_node("species"); child_node; child_node = child_node->next_sibling())
    {
        loop2(child_node); // add these to right node
    }
}

void postOrder(xml_node<> *species) // add to left node
{
    Node t1 = *new Node();
    for (xml_node<> * child_node = species->first_node("species"); child_node; child_node = child_node->next_sibling())
    {
        loop3(child_node); // add these to right node
    }
    xml_node<> * name_node = species->first_node("name");
    if(name_node != 0)
    {
        t1.setName(name_node->value());
        cout << t1.getName() << " ";
    }
    if(name_node == 0)
    {
        cout << t1.getName() << " ";
    }

} 
```

到目前为止，我能够通过文件并按前序和后序获取对象，但我无法弄清楚如何按顺序获取数据，因为没有左或右指针来递归调用函数。谁能给我一些关于如何去做的指导？是否可以通过这种方式获取数据并成功构建树形结构？感谢您的任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T12:47:57.403

前、后和中序遍历的概念仅适用于二叉树：每个节点最多有两个孩子的树。

XML 数据（通常）不必遵循这一点：每个节点可以有任意数量的子节点。

如果您的 XML 文件必须作为二叉树进行解释，则只需将第一个种类节点视为“左”，将其兄弟节点（如果存在）视为“右”。

请注意，在这种情况下，您遍历所有兄弟姐妹的循环没有任何意义。

# asp.net-mvc - MVC 路由 - 参数和控制器名称之间的冲突

> ID：15300713
> 
> 赞同：1
> 
> 时间：2013-03-08T18:22:02.507
> 
> 标签：asp.net-mvc, asp.net-mvc-4

如何在不明确连接它们的情况下解决以下路由规则？

出于促销原因，我想添加友好的 URL，如下所示：

```
domain.com/promoA
domain.com/promoB 
```

这些应该由单个“促销”控制器处理。（我不介意这是否由“家庭”控制器处理）

然后，我想将以下形式的 URL 直接映射到控制器

```
domain.com/account       ---> controller=account, action=index
domain.com/account/login ---> controller=account, action=login
domain.com/product/list  ---> controller=product, action=list
domain.com               ---> controller=home, action=index 
```

是否可以？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T14:47:35.893

我不确定这是否是最简单的方法，但您可以设置一条带有约束的路线。只要确保在其他路线之前声明它即可。

```
routes.MapRoute(
    "Promos", // Route name
    "{action}", // URL with parameters
    new { controller = "Promotions", }, // Parameter defaults
    new { action = new PromoConstraint(), }
); 
```

其中 PromoConstraint 定义为

```
public class PromoConstraint : IRouteConstraint
{
    private readonly List<string> _promos = new List<string> { "promoA", "promoB", }; 

    public bool Match(
        HttpContextBase httpContext
        , Route route
        , string parameterName
        , RouteValueDictionary values
        , RouteDirection routeDirection
    )   {
        object value;
        if(!values.TryGetValue(parameterName, out value)) return false;

        var str = value as string;
        if(str == null) return false;

        return _promos.Any(promo => promo.ToLower() == str.ToLower());
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T18:48:07.433

是的，有可能。

您所要做的就是让 Home 控制器中的 Index 操作方法检查产品表中是否存在提供的产品。如果是，则返回该产品的视图，否则，只返回索引视图。

您需要为所有其他控制器设置路由，就像您在问题中描述的那样。

并且您的根路由需要指定它将采用可选的“产品”参数。

```
routes.MapRoute("Root",   "{product}",   new { controller = "Home", action = "Index", product = "" }); 
```

如果它们遵循某种模式，您可以通过使用正则表达式添加约束来添加处理这些促销的新路由。

# emacs - 在 emacs 中使用 shift 键作为控件

> ID：15300715
> 
> 赞同：1
> 
> 时间：2013-03-08T18:22:17.103
> 
> 标签：emacs

我开始使用大写锁定键作为控制键，但事实证明这样做对我来说真的很不舒服。我希望能够使用左移作为控制键，大写作为左移键。左控制作为左控制

我找不到任何可以帮助我做到这一点的文档。

有人试过这个吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T19:00:01.330

我不会推荐这个。如果您不使用这两个`Shift`键（基本上是任何“语言”，无论它是否是编程语言），那么您真的应该习惯使用两者。

`Control`拥有as 所获得的好处`Shift`并没有真正超过它。

此外，您可能应该只`CapsLock`像`Control`使用笔记本电脑一样使用。否则，您可能想学习用`Control`手掌使用。

很多文章都写在这上面，我在这里总结一下。也许稍后我会寻找参考资料。

# php - PHP中的fputcsv不会写入文件

> ID：15300720
> 
> 赞同：8
> 
> 时间：2013-03-08T18:22:33.880
> 
> 标签：php, fputcsv

我已经搜索和搜索并进行了广泛的调试，并且在我的一生中无法弄清楚为什么 fputcsv 不适合我。

我可以成功打开 .csv 文件并对其进行写入。

我的调试证明该数组已正确加载，并且 foreach 循环工作正常。但是， fputcsv 函数根本无法写入任何内容。我已经删除了所有可能会导致问题的字符串，例如 URL 等，但它仍然不会写入。

我是唯一可以访问此环境的人，所以我知道这不是文件锁冲突。我可以创建文件并写入它，所以我知道这不是权限问题。而且，我从 foreach 循环获得调试输出，所以我知道这不是数组或循环的问题。

我将在下面提供我的代码和调试日志...

```
$posts_meta = array(
    'twitter_title'       => $this_title,
    'twitter_brandtag'    => $this_brandtag,
    'twitter_hashtags'    => $this_hashtags,
    'twitter_iterations'  => $this_iteration,
    'twitter_timing'      => $this_timing,
    'twitter_time'        => $this_time,
    'twitter_id'          => $post_id,
 );

// Debuging
file_put_contents("/blog/debug.txt", "About to write CSV file.\n", FILE_APPEND);
file_put_contents("/blog/debug.txt", print_r($posts_meta, true)."\n", FILE_APPEND);

$myfile = fopen('/blog/pdm_twitter_ouptut.csv', 'a+');

// More debugin
file_put_contents("/blog/debug.txt", "myfile handle = ".$myfile."\n", FILE_APPEND);
fwrite($myfile, "This file is open and working.\r\n");

foreach ($posts_meta as $fields){
    $fresponse = fputcsv($myfile, $fields);

    // A little more debugging...
    file_put_contents("/blog/debug.txt", $fields."\n", FILE_APPEND);
}

fclose($myfile);

// And more debugging
file_put_contents("/blog/debug.txt", "fputcsv response = ".$fresponse."\n", FILE_APPEND);
file_put_contents("/blog/debug.txt", "Just closed CSV file.", FILE_APPEND); 
```

这是生成的调试日志...

```
About to write CSV file.
Array
(
    [twitter_title] => World Stocks Up As US Jobs, China Exports Improve
    [twitter_brandtag] => - FP test 9
    [twitter_hashtags] => #Economy #Markets #Business #Investing #Stocks
    [twitter_iterations] => 12
    [twitter_timing] => 240
    [twitter_time] => 2013-03-08 07:55:24
    [twitter_id] => 11051
)

myfile handle = Resource id #548

// Print-out of $fields here...
World Stocks Up As US Jobs, China Exports Improve
- FP test 9
#Economy #Markets #Business #Investing #Stocks
12
240
2013-03-08 07:55:24
11051

fputcsv response =      // Hm!? I wonder why no response code?
Just closed CSV file. 
```

.csv 文件中出现的所有内容都是（如您在上面的调试代码中所见）“此文件已打开且正在运行”。

任何人可能有的任何想法将不胜感激！

非常感谢！！！

旅行

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-08T18:27:11.637

to 的第二个参数[`fputcsv()`](http://php.net/fputcsv)应该是一个数组，但是您传入一个字符串，因为您正在循环一个字符串数组并单独编写每个字符串。

我怀疑你只是想要这个：

```
$myfile = fopen('/blog/pdm_twitter_ouptut.csv', 'a+');
fputcsv($myfile, $posts_meta); 
```

如果你也想写列标题，我猜你可能是因为你使用的是关联数组，你可能想要一些更像这样的逻辑：

```
$filePath = '/blog/pdm_twitter_ouptut.csv';

$exists = file_exists($filePath) && filesize($filePath) > 0;

$myfile = fopen($filePath, 'a+');

if (!$exists) {
    fputcsv($myfile, array_keys($posts_meta));
}

fputcsv($myfile, $posts_meta); 
```

# ruby-on-rails - 得到 Tire::Results::Collection 的随机结果

> ID：15300727
> 
> 赞同：1
> 
> 时间：2013-03-08T18:22:52.447
> 
> 标签：ruby-on-rails, ruby-on-rails-3, elasticsearch, tire

我在这个变量里面`@results`有`Tire::Results::Collection`很多结果。

我怎样才能得到**1 个随机**结果`Tire::Results::Collection`

**谢谢！**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T09:43:34.350

在 Ruby 1.9 上，只需使用以下`Array#sample`方法：

```
p [1, 2, 3].sample

# -----

require 'tire'
s = Tire.search { query { all } }

p s.results.to_a.sample 
```

# python - 熊猫数据框到矩阵 dtype 错误

> ID：15300732
> 
> 赞同：0
> 
> 时间：2013-03-08T18:23:07.153
> 
> 标签：python, numpy, pandas

我发现同一组命令在两种情况下的工作方式不同。谁能说出为什么第二种情况提取整数而第一种情况没有。我想复制案例 I 的行为。

案例一：作品

```
<<< df = pd.read_csv('...csv file 1 ')
<<< df = df.ix[:,[0, 7, 8, 11, 20, 24, 25]]
<<< datFm = df.values 
<<< datFm[1,:5]
   array([413190.2978, 1, 100000, 93.1, 0.0], dtype=object) 
```

案例二：有字符串

```
<<< dfPL = pd.read_csv('  csv file 2 ')
<<< PLRT = dfPL.ix[:,17]
<<< PLRT_M = PLRT.values
<<< PLRT_M[:5]
 array(['-8.85', '250.72', '1,220.25', '124.89', '11.21'], dtype=object) 
```

这两个 csv 文件都是以 csv 格式保存的 excel 文件。

# c# - c# API可以返回HttpWebResponse吗

> ID：15300735
> 
> 赞同：3
> 
> 时间：2013-03-08T18:23:20.450
> 
> 标签：c#, .net, asp.net-web-api, httprequest

我想做的-我猜-是使用API​​作为代理。它与 Fiddler 合作，并且有了这个想法。

我有一个网站，希望在 iframe 中显示另一个网站。但我需要删除“禁止打开”标题才能做到这一点。

所以计划是：从我的站点向 API 发送一个 url 字符串，API 向该 url 发出请求，获取响应，并且不保存页面只是更改一些标题并响应我的网站。

问题：它一直返回一个 json。我试图将 html 代码作为字符串返回，但是我的网站不会将它呈现到 iframe 中。

这是我的代码。

```
 public class ProductsController : ApiController
{
    public HttpWebResponse GetProductsByCategory(string url, int edit)
    {            
        HttpWebRequest request = (HttpWebRequest)WebRequest.Create(url);
        request.Method = WebRequestMethods.Http.Get;
        request.ContentType = "text/html";
        HttpWebResponse response = (HttpWebResponse)request.GetResponse();
        //
        if (edit == 1)
        {                              
            response.Headers.Set("Content-Disposition", "");
            response.Headers.Set("X-Download-Options", "");               
        }
        response.Headers.Set("Content-Type", "text/html");
        response.Headers.Set("APIflag", "Hi!");

        Stream theHTML = response.GetResponseStream();
        StreamReader objReader = new StreamReader(theHTML);
        string myHTML = objReader.ReadToEnd();

        System.Diagnostics.Debug.WriteLine("url was: "+url); //is OK
        System.Diagnostics.Debug.WriteLine("edit flag was: " +edit); //is OK
        System.Diagnostics.Debug.WriteLine(myHTML); //is OK

        return response;
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T09:42:27.073

这种方式奏效了

```
 public class ProductsController : ApiController
{      
    public HttpResponseMessage GetProductsByCategory(string url)
    {          
        HttpResponseMessage theResponse = null;
        // init a wep api Client
        var myClient = new HttpClient();
        var theTask = myClient.GetAsync(url).ContinueWith((lamdaObj) =>
        {
            theResponse = lamdaObj.Result;
        });
        // wait for task to complete. Not really async, is it?!
        theTask.Wait();
        // remove annoying header 
        theResponse.Content.Headers.Remove("Content-Disposition");
        return theResponse;
    }
} 
```

}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T18:31:22.870

您可能想查看 ASP.net web api。您可以使用位于[http://wcf.codeplex.com/](http://wcf.codeplex.com/)的 WCF HTTP 堆栈来执行此操作。它已包含在 ASP.net web api 中。[http://www.asp.net/web-api](http://www.asp.net/web-api)

# ios - Xcode INSTRUMENTS pass/fail logging 功能似乎在 Xcode 4.6 中损坏

> ID：15300737
> 
> 赞同：3
> 
> 时间：2013-03-08T18:23:29.783
> 
> 标签：ios, instruments, ui-automation

上周我一直在这个问题上绞尽脑汁，无处可去。目前，每当我在 Instruments 中运行测试时，通过/失败日志记录功能几乎总是会报告：

> 问题：脚本结束时没有明确关闭此测试

**注意——是的，拼写错误是正确的**

但是我的记录方法是正确的。有时当我对测试进行更改时，可能只是添加一个额外的空格或注释，然后保存并再次运行，通过/失败功能实际上会工作一次！

但是，如果相同的代码在没有任何更改的情况下立即再次运行，`Issue: Script ended without explicting closing this test`问题就会再次出现。

真让人抓狂！

这是我的测试代码的一个精简示例：

```
var target = UIATarget.localTarget();
var app = UIATarget.localTarget().frontMostApp();

var testName = "LoginCreateEntry";

//Start test logging
UIALogger.logStart(testName);

//**Do UI automation stuff here generated by Instruments/record**
//The automation creates a list entry in my application
//The flow goes, run the automation that creates the entry, then verify that the entry
//got created as expected and is visible to the user in the iPhone interface.

 var window = app.mainWindow();
 var tableView = window.tableViews()[0];
 var tableGroup = tableView.groups()[0];
 var entryName = "My Dogs!";
 var myEntry = tableView.cells()[0].name(); 

//Do a bunch of UI automation here to create my entry, which results in the entry
//appearing in the mainWindow with the label: My Dogs!

//Get the value held in myEntry to print to the log so that I know
//the variable has a value in it to evaluate
UIALogger.logMessage("My Story Title: " + myEntry);

//If myEntry evaluates to true, then call this test a pass.

if (myEntry === entryName) {    
UIALogger.logMessage("My entry was created!");

    //Mark the test as a PASS
    UIALogger.logPass(testName);
}
else {

    UIALogger.logMessage("My entry was not created!");

    //Mark the test as a FAIL
    UIALogger.logFail(testName); 
    }

//End test 
```

如前所述，运行此代码时，我得到：

> 问题：脚本结束时没有说明关闭此测试

但是如果我添加第二种`logMessage()`方法，或对脚本进行任何更改——甚至添加注释，并保存这些更改然后再次运行——一次运行通过/失败的可能性为 80%。但是如果代码立即再次运行而没有任何变化，那么令人愤怒的“ `Issue: Script ended...`”行为再次发生。

我在这里束手无策。任何帮助或反馈将不胜感激！

此外，其他人也遇到过同样的问题，如下所述：[Instruments Automation Tool: Script Ended without Explicitly Closing This Test](https://stackoverflow.com/questions/14865999/instruments-automation-tool-script-ended-without-explicitly-closing-this-test/15259630#15259630)

- - - - - - - - - - -更新 - - - - - - - - - - - - - -
我现在已经在运行 Xcode 4.6 的单独 MacBook Pro 上复制了这个问题。我也做了各种努力故意让我的测试失败——只是为了得到一个反应，但仍然得到`Issue: Script ended without expliciting closing this test`日志消息，它告诉我条件可能甚至没有被读取。然而，再一次，如果我对脚本进行任何微小的更改，然后保存这些更改并再次运行，那么通过/失败功能很有可能会在一次运行中起作用，然后开始出现“问题：脚本结束.. ." 即使没有脚本更改，下一次运行也会再次出现这种行为。

---------------------更新 x 2-------------- -
这是似乎没有触发的 IF 语句，我什至不能使用断点来确定这一点。但我只是运行了一个这样的简单测试：

```
UIALogger.logStart();

if (5 < 10) 
{        
        //Mark the test as a PASS
        UIALogger.logPass();    
}
    else 
{
        //Mark the test as a FAIL
        UIALogger.logFail();         
} 
```

仍然得到`Issue: Script ended without explicating closing this test`

----------更新 x 3-------------- --

因此，我刚刚在 Instruments 中创建了一个全新的单独脚本，仅使用下面的代码，现在无论我如何更改`IF`语句中的相对值，通过/失败始终有效。哇，现在这变得越来越陌生了。

```
var target = UIATarget.localTarget();

UIALogger.logStart();

if (5 > 10) 
{        
        //Mark the test as a PASS
        UIALogger.logPass();    
}
    else 
{
        //Mark the test as a FAIL
        UIALogger.logFail();         
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T21:14:52.480

好的，这个问题是真实存在的，并且可能只影响 Xcode 4.6。该问题在多台机器上和多个跟踪脚本上重复出现。这是解决方案：

在 if 语句中添加等待，如下所示：

```
UIALogger.logStart( testName );

//Do automation stuff here

        if (5 < 10) {
        UIALogger.logMessage("We passed!");
            //Wait a moment
        target.delay(1);
            UIALogger.logPass( testName );
        } else {
        UIALogger.logMessage("We Failed!");
            UIALogger.logFail( testName );
            UIALogger.logFail( testName );
        } 
```

另外，这听起来可能很愚蠢——但这对我有用，请注意，IF 语句的 logFail() 部分没有延迟，但是有两个 logFail() 语句（有时需要 3 个 logFail() 语句）。如果您在 IF 语句的失败部分使用延迟，您将收到 ISSUE 消息而不是干净的 FAIL 消息。不，我不是在开玩笑。是的，这很愚蠢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-21T09:11:07.233

我尝试了 Wulf 的答案和其他几个答案，但没有一个总是有效，但我发现在 logFail/logPass 之后添加延迟几乎总是会导致正确关闭测试。

像这样：

```
UIALogger.logPass(testName);
target.delay(1); 
```

失败也一样。请注意，它也不会在日志中为您提供多次失败：

```
UIALogger.logFail(testName);
target.delay(1); 
```

我知道这个话题很老了，但我希望这对某人有所帮助。

# ios - 声音不在 iOS 设备上播放，但在 iOS 模拟器中工作

> ID：15300738
> 
> 赞同：4
> 
> 时间：2013-03-08T18:23:32.790
> 
> 标签：ios, monogame

使用来自 GitHub 的最新 Monogame 源 06/03/13，我的游戏在 ipad/iPhone 模拟器（在 VMWare 上的 OSX 中）运行时播放音效很好，但是当我将它部署/调试到 iPad 4 时没有完全没有声音。在应用程序输出窗口中，有时我会看到 Failed to get buffer attributes: when execution of an ingame action that should play a sound。当声音在模拟器中播放时，我假设我已经使用 monogame 声音处理器正确编译了 xnbs。fwiw 我使用 Visual Studio 2012 Windows Phone 游戏库项目编译了这些。这就是我在游戏加载时播放我的介绍声音的方式。

```
public override void Activate(bool instancePreserved)
    {
        if (!instancePreserved)
        {
            if (content == null) 
                content = new ContentManager(ScreenManager.Game.Services, "Content");

            backgroundTexture = content.Load<Texture2D>(MyGame.Settings.Assets.SplashBackground);
            introSound = content.Load<SoundEffect>(MyGame.Settings.Assets.IntroSound);
        }
        introSound.CreateInstance().Play();
    } 
```

任何人都知道会导致这种情况以及如何解决它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T22:17:22.683

对于其他任何对此感到头疼的人，我通过按照 miguel.de.icaza 的评论中的建议配置 AudioSession 来解决它[Sound not working in iOS for iPad](https://stackoverflow.com/questions/11963098/sound-not-working-in-ios-for-ipad?rq=1)

```
MonoTouch.AudioToolbox.AudioSession.Initialize();   
MonoTouch.AudioToolbox.AudioSession.Category = MonoTouch.AudioToolbox.AudioSessionCategory.MediaPlayback;   
MonoTouch.AudioToolbox.AudioSession.SetActive(true); 
```

我不知道为什么模拟器会玩而真正的设备不会玩，或者为什么这不是由monogame处理的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T16:59:09.737

尝试直接或通过内容管道使用 MP3。

# joomla - 模块未在 mercurialmart 中显示

> ID：15300740
> 
> 赞同：1
> 
> 时间：2013-03-08T18:23:40.160
> 
> 标签：joomla, joomla1.5, virtuemart

我正在使用 joomla1.5 和 measuremart1.1.9 我已将模块包含在 admin 中，它显示在所有页面中，除了我为 meadowmart 创建的菜单。我想知道为什么会这样。我已经分配了菜单链接，直接在 index.php 中给出

```
<li><a href="index.php?option=com_virtuemart&Itemid=28""><img src="<?php echo $this->baseurl ?>/templates/animal/images/shop.jpg" width="101" height="31" /></a></li> 
```

为什么在 mercurialmart 菜单中没有显示模块。

在 index.php 中

```
<div id="mainBlock">
     <div id="col1">
     <div id="tab"></div>
      <div class="scrollbox">
    <jdoc:include type="modules" name="news" />
    <jdoc:include type="modules" name="top" />
     </div>
    <a href="index.php?option=com_joomgallery&Itemid=4"><img src="<?php echo $this->baseurl ?>/templates/animal/images/photogallery.jpg" width="295" height="334" /></a>
    </div>
    <div id="col2">
       <jdoc:include type="modules" name="shopmodule" />
        <jdoc:include type="component" />
     </div>
    </div> 
```

但什么都没有显示请检查[这个](http://universalanimals.net/index.php?option=com_virtuemart&Itemid=28)

为什么模块不显示在 Virtuemart 组件页面中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-04T10:11:16.467

我认为这是因为您直接在模板中给出了菜单。只需使用菜单管理器中的外部 URL 功能添加菜单并检查它。

# java - 无法从 request.getInputStream() 获取图像

> ID：15300745
> 
> 赞同：0
> 
> 时间：2013-03-08T18:23:48.107
> 
> 标签：java, android, google-app-engine, jakarta-ee

我正在尝试从来自移动应用程序的请求属性中获取图像字节。

向上游发送的图像格式为 BitMap。以 Base64 格式编码。

如何获取 Web 应用程序中的字节？我在我的 Web 应用程序中使用以下代码片段，我用它来从移动应用程序请求中获取数据。我对代码感到震惊。我不确定我是对还是错。

```
byte[] line             = null;

    int noOfBytesRead;
    StringBuffer content    = new StringBuffer();

    HashMap<String, Object> lResultMap  =   null ;

    try 
    {
        log.info("request getInputStream: " + request.getInputStream());
        ServletInputStream sis  = request.getInputStream();

        line                    = new byte[128];
        noOfBytesRead           = sis.readLine(line, 0, 128);
        log.info("noOfBytesRead :1 " + noOfBytesRead);

        if (noOfBytesRead < 3)
            return null;

        noOfBytesRead           = sis.readLine(line, 0, 128); // Reads the content disposition and form name and filename

        log.info("line :"+line+" adn the noOfBytesRead : 2 : "  +   noOfBytesRead);

        int numBytesToRead      = noOfBytesRead;
        int availableBytesToRead;

        while ((availableBytesToRead = sis.available()) > 0) 
        {
            byte[] bufferBytesRead;
            bufferBytesRead     = availableBytesToRead >= numBytesToRead ? new byte[numBytesToRead] : new byte[availableBytesToRead];
            sis.read(bufferBytesRead);
            content.append(new String(bufferBytesRead, Charset.forName("iso-8859-1")));
        }
        sis.close();
        log.info("The bytes is  : " +content.toString());
        byte[] image        =   null;
        image   =   content.toString().getBytes(Charset.forName("iso-8859-1")) ;
        log.info("image : "  +image);

        Base64Decoder decoder = new Base64Decoder();  
        byte[] imgBytes = decoder.decode(content.toString());
        log.info("imgBytes : decoded byted" + imgBytes);        
        lResultMap          =   new HashMap<String, Object>();

        lResultMap.put("content"    , imgBytes );
        log.info("content string buffer :  " +content);
        log.info("lResultMap : "  +lResultMap);
    } 
    catch (Exception e) 
    {
        e.printStackTrace();
        log.log(Level.SEVERE, e.getMessage(), e);
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T18:35:01.013

从您的代码中很难理解，因为它没有格式化，但这是我的简单解决方案

```
URL url = new URL(contentUrl);
        URLConnection conn = url.openConnection();
        InputStream inStr = conn.getInputStream();
        BufferedInputStream buffInStr = new BufferedInputStream(inStr);
        // Need to check the size of Byte Array Buffer.
        ByteArrayBuffer baf = new ByteArrayBuffer(500);
        int current = 0;
        while ((current = buffInStr.read()) != -1) {
            baf.append((byte) current);
        }
        byte[] array = baf.toByteArray(); 
```

在谷歌应用引擎上

图像服务 API 接受任何受支持的图像文件格式的数据。根据[这个页面](https://developers.google.com/appengine/docs/java/images/overview)，这些格式包括“JPEG、PNG、WEBP、GIF（包括动画GIF）、BMP、TIFF和ICO”。图像服务不提供从头开始创建新图像数据的方法。但是您可以使用图形库以一种可接受的数据格式生成图像，然后使用该服务将其转换为另一种格式，或对其进行转换。当然，取决于图形库，您可能可以直接从库中获取最终图像，而不使用该服务。

要提供图像，只需为您使用的数据格式设置适当的 Content-Type 标头，然后将图像数据的字节写入响应的输出流：

```
// byte[] pngData = ...
resp.addHeader("Content-Type", "image/png");
resp.getOutputStream().write(pngData); 
```

如果您想尝试在没有库的情况下生成图像数据，BMP 格式可能是最简单的。您可以使用图像服务将其转换为 PNG。

# string - OCTAVE 单元格和字符串

> ID：15300747
> 
> 赞同：0
> 
> 时间：2013-03-08T18:23:54.667
> 
> 标签：string, matrix, octave, cells

的反函数是`cellstr`什么？

解释：首先我有：

`d=["aa";"bb";"cc";"dd"];`

然后我做：

`d=cellstr(d);`

但后来我想`d`恢复到开始时的状态（即矩阵）。

我该怎么做？/我应该使用什么功能？感谢您的回答

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T18:37:30.757

这应该可以完成工作： d=char(d(:,1));

# c# - 定时方法调用 - 当时间到期而不等待操作完成时如何继续？

> ID：15300751
> 
> 赞同：0
> 
> 时间：2013-03-08T18:24:10.793
> 
> 标签：c#, multithreading, asynchronous, task-parallel-library, async-await

我遇到了一个有趣的场景，我无法确定最佳解决方案是什么。

假设我有以下 foreach-loop

```
Request[] requestArray = //Get Array of Request objects from somewhere

foreach(IRequest r in requestArray)
{
      var response = r.MakeRequest();
}

public class Request:IRequest
{
       public double IntervalInSeconds {get;set;} //Allowed Time To Complete Request

       public Response MakeRequest()
       {
             //Perform arbitrary operation, could be long or short running
       }
}

public interface IRequest
{
       Response MakeRequest();
} 
```

**问题：**我需要做的是给每个请求一个**IntervalInSeconds**值，指定在我们继续之前该请求必须从**MakeRequest()**返回多长时间。例如，如果我们将它设置为 10，并且 10 秒过去了，我想继续前进，完全忘记现有的 MakeRequest() 调用。

我研究了很多不同的方法可以用来实现这一点，但不知道如何真正做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T19:30:18.790

很明显，在 MakeRequest 中完成的工作可能会持续超过 IntervalInSeconds 秒。如果 MakeRequest 必须同步运行，则很难将方法留在 IntervalInSeconds 中，除非您在那里有一个循环，允许您非常定期地检查经过的时间。不是一个好方法。

这是您的 foreach 循环的一种快速简单的方法，不涉及更改接口 IRequest：

```
foreach(IRequest r in requestArray)
{
  var responseTask = Task.Run(r.MakeRequest);

  await Task.WhenAny(responseTask, Task.Delay(TimeSpan.FromSeconds(r.IntervalInSeconds));
} 
```

这当然要求这个 foreach 循环所在的方法可以被赋予一个 Task（或 void，但不要这样做）返回类型。

我可以想象更复杂的解决方案，如果需要，MakeRequest 会自行处理超时间隔。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T21:55:34.190

我使用了以下解决方案：

```
for(int i = 0; i < requestArray.Length;i++)
{
    var request = requestArray[i];
    var task = Task.Factory.StartNew<Response>(makeRequest);

    Task.WaitAny(new Task[]{task},request.IntervalInSeconds * 1000);

    if(task.Status == TaskStatus.RanToCompletion)
    {
         /*Done*/
         return task.Result;
    }      
    /*Keep Going*/
} 
```

# xpath - XPath 中的子集

> ID：15300752
> 
> 赞同：1
> 
> 时间：2013-03-08T18:24:10.820
> 
> 标签：xpath, sequence, schematron

在 xPath 中，如果有 sequence1 = sequence2，则如果在 sequence1 中至少有一个元素也在 sequence2 中，则返回 true。我需要一些东西来测试sequence1 的所有元素是否存在于sequence2 中（sequence1 的值集是sequence2 中值集的子集）。

这可行吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T19:22:56.553

这应该在 XPath 1.0 中工作：

```
not($sequence1[not(. = $sequence2)]) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-09T16:00:23.037

**使用[双重否定定律](http://en.wikipedia.org/wiki/Double_negation)**：

```
not($seq1[not(. = $seq2)]) 
```

**或者，更有效 - 对于节点序列和基于节点身份的相等语义： (O(N) vs O(N^2))**：

```
count($seq1 | $seq2) = count($seq2) 
```

* * *

**二、XPath 2.0**

**对于节点序列（基于节点身份的相等语义）**：

```
not($seq1 except $seq2) 
```

**以及值序列的有效表达式**：

```
count(distinct-values(($seq1, $seq2))) eq count(distinct-values($seq2)) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T18:33:20.427

您可以使用every 检查每个元素是否在sequence2

```
every $x in $sequence1 satisfies $x = $sequence2 
```

# c# - 具有多个 List 类型的列的 Linq GroupBy >

> ID：15300759
> 
> 赞同：0
> 
> 时间：2013-03-08T18:24:34.127
> 
> 标签：c#, linq, group-by

我不知道应该使用什么语法来使多列分组与索引一起使用。

假设我有这样的结构：

```
 var listToGroupBy = new List<List<string>>
        {
            new List<string> {"a", "b", "c"},
            new List<string> {"a", "b", "c"},
            new List<string> {"d", "k", "c"},
            new List<string> {"d", "z", "c"}
        }; 
```

接下来我想按第 1 项和第 3 项分组。我想使用类似于下面的语法，但到目前为止我还没有成功。

```
var groupByResult = listToGroupBy.GroupBy(c => new { c[0], c[2] }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T18:26:56.540

您可能只需要在匿名类型中命名字段：

```
var groupByResult = listToGroupBy.GroupBy(c => new { c0 = c[0], c3 = c[3] }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T18:33:22.153

要详细说明 Douglas 的答案，如果您不使用点表示法，则需要明确命名您的字段。

当您使用点表示法时，Linq 可以根据属性的名称来确定列的名称。但是由于您使用的是数组索引，所以它不知道如何命名它。

因此，在下面的示例中，Linq 会知道使用`Something`和`SomethingElse`作为字段名称。

```
var groupByResult = listToGroupBy.GroupBy(c => new {c.Something, c.SomethingElse}); 
```

就像道格拉斯所说，您可以通过命名字段来获得与点符号相同的结果：

```
var groupByResult = listToGroupBy.GroupBy(c => new { Something = c[0], SomethingElse = c[3] }); 
```

# iphone - GPUImageStillCamera 输出图像分辨率

> ID：15300761
> 
> 赞同：0
> 
> 时间：2013-03-08T18:24:46.973
> 
> 标签：iphone, ios, objective-c, gpuimage

我正在尝试使用 GPUImage 框架从相机拍照。使用标准[实现](https://github.com/BradLarson/GPUImage#capturing-and-filtering-a-still-photo)。但是我的输出图像的分辨率太低 - {640, 852}。有没有办法获得更高的分辨率？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T18:36:06.967

不久前我遇到了同样的问题。这是`AVCaptureSession`设置的方式。

尝试使用以下命令初始化相机：

```
GPUImageStillCamera *videoCamera = [[GPUImageStillCamera alloc]
            initWithSessionPreset:AVCaptureSessionPresetPhoto
                   cameraPosition:AVCaptureDevicePositionBack]; 
```

# c# - 是否可以编写自定义事件以便在 LIFO 基础上调用事件处理程序？

> ID：15300764
> 
> 赞同：3
> 
> 时间：2013-03-08T18:24:56.877
> 
> 标签：c#, .net, delegates

我想创建一些自定义事件，它们总是以事件注册的相反顺序调用注册的事件处理程序，即总是首先调用最近注册的事件处理程序。可能吗？这些事件将由业务层类在某些错误条件下引发，其中注册的事件处理程序可能能够克服错误条件。

这是一个纯粹的技术问题，是否可以这样做？是否可以覆盖事件链调用顺序？语言（C# 2.0、3.0、4.0 的任何版本）是否支持此功能？

**编辑：**

可能的用途是尽可能用于错误报告和错误恢复。例如，Func A 调用 Func B，Func B 又调用 Func C。Func C 可能会遇到错误情况并有相应的事件。如果 Func A 和 Func B 能够提供错误恢复机制，它们就会注册该事件。由于 Func B 更有可能具有解决错误的上下文，因此我想调用最近注册的处理程序并检查事件参数以查看错误是否已解决。如果是，我什至不会调用其他事件处理程序。如果不是，我将调用第二个最近注册的处理程序，这将是调用者的调用函数，即 Func A。

在大多数情况下，代码的结构通常是这样的：如果 Func A 调用 Func B，那么 Func B 不会调用 Func A，即通常不存在循环调用，并且事件处理程序的顺序将与函数调用的顺序相同。因此，如果 Func A 调用 Func B，而 Func B 又调用了 Func C，而 Func C 引发了一个“错误事件”，则最适合处理错误的候选者是 Func B 的事件处理程序，其次是 Func A 的事件处理程序，依此类推。

它就像堆栈跟踪的展开，并让最近的调用函数有机会消费事件。任何没有。调用者函数可能在那里。

在任何处理程序成功使用该事件后，引发“错误事件”的 Func C 将继续执行。它将检查事件参数以确定这一点。如果没有处理程序使用该事件，Func C 将抛出异常。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-08T19:02:39.767

是的，您可以使用 MulticastDelegate.GetInvocationList() 方法自己迭代事件的调用列表。像这样：

```
 public event EventHandler Custom;

    protected virtual void OnCustom(EventArgs e) {
        var handler = Custom;
        if (handler != null) {
            var subscribers = handler.GetInvocationList();
            for (int ix = subscribers.Length - 1; ix >= 0; --ix) {
                var sub = (EventHandler)subscribers[ix];
                sub(this, e);
            }
        }
    } 
```

请注意，这是一个不确定的解决方案，您无法控制其他代码订阅事件的顺序。

# javascript - 这是一个很好的移动重定向javascript吗？或者我会被谷歌禁止吗？

> ID：15300765
> 
> 赞同：0
> 
> 时间：2013-03-08T18:24:56.560
> 
> 标签：javascript, redirect, mobile, agent

我在网上找到了这个：

```
<script>//<![CDATA[    
var mobile = (/iphone|ipad|ipod|android|blackberry|mini|windows\sce|palm/i.test(navigator.userAgent.toLowerCase()));    
var refUrl = document.referrer; // Get the URL where the user came from    
var prevUrl = refUrl.substr(7,23); // Create a substring after 'http://' and '.com'
var mobileUrl = "m.testsite.com"; // String from mobile site URL; must match prevUrl    
// Run auto-redirect only if the user is on mobile and isn't from m.testsite.com   
if ((mobile) && !(prevUrl == mobileUrl)) {        document.location = "http://m.testsite.com";    } //]]></script> 
```

它工作正常，但我以前没有见过这个，因此我担心这可能会受到处罚或被谷歌禁止。你怎么看？我应该在用户代理字符串中放入移动 googlebot 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T03:53:40.777

谷歌这些天非常聪明，它需要的不仅仅是一个糟糕的重定向来将你列入黑名单。很有可能它会确切地知道您要做什么。此外，他们不会禁止你，除非你做了非常非常糟糕的事情。在最坏的情况下，他们不会索引该页面。

# python-3.x - 蟒蛇 3.3。连接来自输入的字符串。如何？

> ID：15300768
> 
> 赞同：0
> 
> 时间：2013-03-08T18:25:04.850
> 
> 标签：python-3.x

我正在尝试制作一个简单的 python 应用程序，它要求用户输入并将此输入与 HEX 分隔符和第二个输入连接起来。我可以闭着眼睛在 C# 中做到这一点，但我对 Python 很陌生。想发布样品吗？

非常感谢，

维尼

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T18:34:07.143

```
a = input("Enter the first input:")
b = input("Enter the second input:") 
result = a + delimiter + b
# or 
# result = delimiter.join([a, b]) 
```

在源代码中键入[“NO-BREAK SPACE”字符：](http://codepoints.net/U+00A0)

```
delimiter = "\u00A0" 
```

如果您将其作为整数：

```
delimiter = chr(0x00A0) 
```

# wikimedia - wikimedia Lockdown 与现有的命名空间

> ID：15300772
> 
> 赞同：0
> 
> 时间：2013-03-08T18:25:29.367
> 
> 标签：wikimedia, lockdown

我正在使用 Media Wiki 获取文档。例如，在我添加了很多带有命名空间的页面之后，`INTERN:My Page`或者`Public:My Page`想要限制对此存在的命名空间的读取访问权限。

我找到了扩展“锁定”，可以将它用于新的、自定义的命名空间：

```
define ("NS_CUSTOM", 110);
$wgExtraNamespaces[NS_CUSTOM] = "customNamespace";

$wgNamespacePermissionLockdown[NS_CUSTOM]['*'] = array('sysop'); 
```

如果我为现有的命名空间尝试相同的代码，则无法访问旧页面 - 页面似乎不存在。

有没有办法限制现有命名空间的访问？我可以在数据库的某处找到命名空间 ID 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T19:16:13.617

According to [Lockdown documentation](http://www.mediawiki.org/wiki/Extension%3aLockdown), a single line should suffice for an already existing namespace like NS_PROJECT:

```
$wgNamespacePermissionLockdown[NS_PROJECT]['*'] = array('sysop'); 
```

From your question and your own answer it is not clear enough what your configuration looks like (e.g. whether you are trying to lock down multiple namespaces and maybe did some errors there). However, you should *not*

1.  redefine existing namespaces
2.  re-use the NS_CUSTOM definition for different namespace ids (which is a variant of 1.)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T18:43:35.267

我创建了一个新的自定义命名空间

```
define ("NS_CUSTOM", 111);
$wgExtraNamespaces[NS_CUSTOM] = "customNamespace";
$wgNamespacePermissionLockdown[NS_CUSTOM]['*'] = array('sysop'); 
```

并将`page`数据库表中的 ROW 更改为`page_namespace = 111`

# expect - 如何在期望获取特定文本的同时发送命令（以保持 telnet 会话处于活动状态）？

> ID：15300775
> 
> 赞同：1
> 
> 时间：2013-03-08T18:25:41.897
> 
> 标签：expect

我必须将来自 1980 电话系统 (DMS100) 的命令的输出保存在文件中。我有一个期望脚本来执行此操作，但我的问题如下：

1.  该命令最多可以输出 10 个小时的信息。
2.  由于某种原因，在提交我的命令后，我的会话在 10 分钟后关闭。

我需要这样的东西：[在期望时发送命令可以获得特定的文本](https://stackoverflow.com/questions/11797697/send-command-while-expect-can-get-specific-text)

但不同的是，我的期望可以在 10-12 小时后实现，并且我的会话每 10 分钟到期一次。

我想在我期望我的字符串时发送一个不可见的字符，以使我的会话保持活跃。像这样的东西：

```
While expect "The End Of My Output"
{
send \007
} 
```

我怎样才能做到这一点？

编辑：

我的问题是我使用的 telnet 端口配置了 10 分钟超时。找到另一个没有超时的端口并且它工作正常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T09:02:31.100

尝试这样的事情（未经测试）：

```
# timeout after 5 minutes
set timeout 300

expect {
  "The End Of My Output" {
    # got all the output
  }
  timeout {
    send "\007"
    exp_continue
  }
} 
```

# javascript - 将 HTML 和 Javascript 组件合并到 Android 应用程序中

> ID：15300778
> 
> 赞同：0
> 
> 时间：2013-03-08T18:25:56.950
> 
> 标签：javascript, android, html, graph

我正在开发一个 Android 应用程序，并想在应用程序的某些页面中添加一些现有的网络图表。这些图表目前是在 HTML 中定义的，并且在外部依赖于 CSS 和 Javascript。我想知道将这些图表移植到我的应用程序的最佳方法，但不知道任何最佳实践，并且以前从未在 Android 中使用过图表。该图的示例如下所示：

![在此处输入图像描述](../Images/e825b0c0a8abfc5713b797ab42197264.png)

我知道我可以在 /assets 中创建一个 html 文件并用它填充一个 WebView：

```
 WebView wb = (WebView) findViewById(R.id.webView1);
    wb.loadUrl("file:///android_asset/example.html"); 
```

但是，我不确定这是否允许我将必要的 Javascript 与 HTML 元素合并，或者这是否是最佳实践。我还应该补充一点，需要从设备上存储的数据动态生成图表。

非常感谢任何提示、帮助或建议！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T18:31:48.697

我认为你应该使用像[http://androidplot.com/](http://androidplot.com/)这样的原生图表 api （我在 google 上找到的第一个，我相信还有更多）。使用 WebView 和 Javascript 没问题，但如果您需要从设备上的数据动态生成的图表，我认为使用本机 api 会更简单、更直接。

另请参阅这个 SO 问题：[Android Line chart/graph API](https://stackoverflow.com/questions/10680469/android-line-chart-graph-api)

# java - 在处理中加载网站

> ID：15300780
> 
> 赞同：0
> 
> 时间：2013-03-08T18:26:08.500
> 
> 标签：java, google-maps, processing

我需要加载一个正在处理的网站。我已经制作了自己的 HTML 文件，用于谷歌地图基于 web 的 api，它工作得非常好，但我需要一种在处理中显示它的方法（即在处理 java 窗口中）。

有没有办法？我知道处理是基于 java 的，所以我认为这很容易，但我已经搜索了几个小时，但我找不到任何东西。任何帮助都会很棒！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T19:46:44.287

处理只是一种编程语言。如果您需要在 Processing 应用程序中启动浏览器，您将不得不停止单独使用 Processing 作为一种语言，而只需将其用作完整 Java 应用程序中的 API 库。它没有任何充当浏览器的功能，处理本身所能做的就是将您链接到某个地方（使用 link() 函数调用）。

如果您将草图作为 Applet 运行，请注意不再推荐这样做；如果您仍然在浏览器中启用 Java，那么您在过去几个月没有关注 Java 的安全新闻。一般的想法是，如果你需要一个浏览器插件，看看你是否可以通过使用 Processing.js 来完成这项工作（它通过将它们解释为 JavaScript 来在浏览器中运行处理草图，而不是将它们编译为 Java VM 字节码和在JVM中运行它）。如果你有很多导入，这将不起作用，你可能不得不走普通的 Java 路线。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-09T09:30:50.263

如果您需要一些处理功能，为什么不留在浏览器中并使用[ProcessingJS](http://processingjs.org)。

如果绝对有必要将代码作为 Java 应用程序或小程序运行，请尝试[DJ](http://djproject.sourceforge.net/ns/index.html)之类的东西。

只要确保您使用最简单的设置选项即可。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-11T20:24:28.117

我认为使用[处理 JavaScript 模式](http://wiki.processing.org/w/JavaScript)，您可以使用 JavaScript 代码扩展您的处理草图行为。

> JavaScript 选项卡允许在 PDE 中编写纯 JavaScript 代码，这些代码可以超出处理 API 提供的范围。查看模式中包含的示例，了解如何将 JavaScript 代码与“正常处理”集成。

这个 Stack Overflow 问题可能会帮助您实现“HTML 加载窗口”效果： [How to create an iframe on click a link?](https://stackoverflow.com/questions/13584252/how-to-create-an-iframe-on-clicking-a-link)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-19T15:55:14.893

不清楚您需要的工作流程，但您可以使用`PDEGraphics2D`. 这是一个`java.awt.Graphics2D`子类，它生成处理代码的方式与 Apache Batik 为 SVG 所做的方式非常相似。只需将一个`PDEGraphics2D`实例传递给 AWT/Swing 层次结构的常用绘制机制。见[http://waterloo.sourceforge.net/PDEGraphics2D/](http://waterloo.sourceforge.net/PDEGraphics2D/)

# vim - vim：聚焦时突出显示视口的标题

> ID：15300786
> 
> 赞同：0
> 
> 时间：2013-03-08T18:26:37.800
> 
> 标签：vim, highlight, identification

当我在拆分视口中打开许多文件时，需要努力识别焦点的位置。尽管我尝试通过使用 突出显示光标来解决此问题`cursorline`，但突出显示出现在所有相应的视口中。那么有没有办法在选择文件时突出显示文件的标题？如果没有，任何易于识别的解决方案将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T18:34:44.480

好的配色方案通常具有`StatusLine`（当前窗口）和`StatusLineNC`（其他窗口）的突出显示定义。

如果您的配色方案没有，只需找到 的行`StatusLine`，复制它，更改`StatusLine`为`StatusLineNC`并放入您想要的颜色。

作为参考，以下是我使用的颜色方案中的两条相关行：

```
hi StatusLine term=bold,reverse cterm=bold ctermbg=101 ctermfg=16 gui=bold guibg=#808070 guifg=#000000
hi StatusLineNC term=reverse cterm=NONE ctermbg=59 ctermfg=16 gui=italic guibg=#404c4c guifg=#000000 
```

# objective-c - 在 NSURLConnection 发送的分块 HTTP 1.1 请求期间丢弃的数据包

> ID：15300788
> 
> 赞同：1
> 
> 时间：2013-03-08T18:26:46.070
> 
> 标签：objective-c, http, nsurlconnection, wireshark

我正在使用以下代码来设置分块的 HTTP 1.1 请求（请求本身是 SOAP 请求，但我认为这不是特别重要）：

```
 NSMutableURLRequest* request = [NSMutableURLRequest requestWithURL:url];
            ...
            NSInputStream *dataStream = [NSInputStream inputStreamWithFileAtPath:_tempFilePath];
            [request setHTTPBodyStream:dataStream];
            self.p_connection = [[NSURLConnection alloc] initWithRequest:request delegate:self startImmediately:YES]; 
```

这似乎工作正常，除非请求变得太大，我可以看到一些数据包在 WireShark 中随机丢弃 - 它将其标记为“*未捕获 TCP 上一个段*”。我认为请求的大小只有在数据包的随机丢弃更有可能发生时才重要，否则它是一些更基本的问题。

有人知道这里可能会发生什么吗？是 NSURLConnection 的错还是我使用它的方式？

# magento - 将社区主题转换为企业主题

> ID：15300790
> 
> 赞同：0
> 
> 时间：2013-03-08T18:26:53.227
> 
> 标签：magento, magento-1.7

我目前购买了一个 Magento 主题并将其插入到我的 EE 安装中。主题工作正常，但 EE 特定功能（如横幅/小部件和礼品卡）无法正常显示或工作。我需要做什么才能将这个为 CE 编写的主题转换为支持所有 EE 功能的 EE 主题？是否像将 /layout/ 和 /template/ 缺少的企业主题项目复制到新主题中一样容易，或者企业主题中是否存在一些我需要添加/更改的潜在编程差异？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T18:30:33.150

我对您的建议是将模板和布局文件从 EE 基本/默认主题复制到新主题的文件夹中，并在必要时对其进行编辑。这不应该花费太长时间，它将主要是 CSS，但您会发现您需要对模板文件进行细微的更改。祝你好运！

# objective-c - 如何为 iOS 6 xcode 4.6 制作任何时间动画？

> ID：15300792
> 
> 赞同：0
> 
> 时间：2013-03-08T18:26:58.017
> 
> 标签：objective-c, cocoa-touch, ios6, uiviewanimation, xcode4.6

那么如何为 UIViews 或 xcode 中的 UIImageViews 制作任何时间动画，但意味着当用户在应用程序中时，动画显示的任何时间，我的动画是这样的：

```
- (void)showAnimation
{

    [UIImageView beginAnimations:@"EFFECT_SHOW" context:nil];
    [UIImageView setAnimationCurve:UIViewAnimationCurveEaseInOut];
    [UIImageView setAnimationDuration:5.0f];

    self.imageAnimation.frame = CGRectMake(400, imageAnimation.frame.origin.y, imageAnimation.frame.size.width, imageAnimation.frame.size.height);
    self.imageAnimation2.frame = CGRectMake(-400, imageAnimation2.frame.origin.y, imageAnimation2.frame.size.width, imageAnimation2.frame.size.height);

    [UIImageView commitAnimations];
} 
```

&当我调用方法时，我只是做 [self showAnimation];，但是在 viewDidload 中，只显示一次动画，如何随时制作？，我需要一个“while”问题吗？或者我可以在另一个虚空中吗？

感谢拉巴斯和圣克鲁斯德拉谢拉 - 玻利维亚的帮助和问候！摇滚吧！！！n_n'

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T18:38:32.727

使用属于`UIView`. [iOS](http://developer.apple.com/library/ios/#documentation/WindowsViews/Conceptual/ViewPG_iPhoneOS/AnimatingViews/AnimatingViews.html#//apple_ref/doc/uid/TP40009503-CH6-SW1)的View Programming Guide有一个很棒的动画部分。

调用方法时

```
+ (void)animateWithDuration:(NSTimeInterval)duration delay:(NSTimeInterval)delay options:(UIViewAnimationOptions)options animations:(void (^)(void))animations completion:(void (^)(BOOL finished))completion 
```

您可能想要的“选项”是`UIViewAnimationOptionAutoreverse`.

例如：

```
[UIView animateWithDuration:5.0f delay:0 options:UIViewAnimationOptionAutoreverse | UIViewAnimationOptionRepeat animations:^{
    self.imageAnimation.frame = CGRectMake(400, imageAnimation.frame.origin.y, imageAnimation.frame.size.width, imageAnimation.frame.size.height);
    self.imageAnimation2.frame = CGRectMake(-400, imageAnimation2.frame.origin.y, imageAnimation2.frame.size.width, imageAnimation2.frame.size.height);
} completion:nil]; 
```

编辑：是的..这是我的错，它不会重复。根据文档......

> **UIViewAnimationOptionAutoreverse**
> 
> 前后运行动画。必须与**UIViewAnimationOptionRepeat**选项结合使用。

我更新了代码以包含`UIViewAnimationOptionRepeat`它，它现在应该可以工作了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T21:49:44.523

动画完成后再次调用showAnimation方法即可

```
 - (void) showAnimation
{
    //TODO: maybe reset you animation
    [UIView setAnimationCurve:UIViewAnimationCurveEaseInOut];
    [UIView animateWithDuration:5.0f animations:^(){
            // define animation
            self.imageAnimation.frame = CGRectMake(400, imageAnimation.frame.origin.y, imageAnimation.frame.size.width, imageAnimation.frame.size.height);
            self.imageAnimation2.frame = CGRectMake(-400, imageAnimation2.frame.origin.y, imageAnimation2.frame.size.width, imageAnimation2.frame.size.height);
        }
        completion:^(BOOL finished){
            // after the animation is completed call showAnimation again
            [self showAnimation];
    }]; 
} 
```

# javascript - 对同名属性的 div 应用 jquery 效果

> ID：15300793
> 
> 赞同：0
> 
> 时间：2013-03-08T18:26:59.387
> 
> 标签：javascript, jquery, class, plugins, effects

我很难找到一种将效果应用于我正在制作的 jquery 插件的方法，我已经让它工作了，但这不是我真正想要的方式，所以我需要一些指导

Jquery 插件将图像分割成 div 的小方块，这样我就可以从角落开始应用淡入淡出效果，现在每个 div 都有相同的 CSS 类，但名称不同，它们的名称是根据顺序给出的div必须出现......问题是我现在不知道如何让所有名称为3的div同时淡入..这是代码

HTML

```
<!DOCTYPE html>
<html>
    <head>
        <link href="style.css" type="text/css" rel="stylesheet" />
        <script src="jquery.js" type="text/javascript"></script>
        <script src="separar.js" type="text/javascript"></script>

        <title>AEMB Portales Web</title>        
    </head>

    <body>
        <div id="contenedor" style="width:800px; height:508px; position:relative; margin:0 auto;">
            <a href="#"><img src="img/fma.jpg"  /></a>
        </div>

        <script>
            $(document).ready(function(){
                $("#contenedor").separar(4);
            });
        </script>
    </body>
</html> 
```

查询插件

```
(function($){

$.fn.separar =  function(cantidad){
    var contenedor = $(this);
    var slides = $(this).children();
    var altoTotal = contenedor.height();
    var lastId = 0;

    separarslides(contenedor,slides[0]);
    aparecer();

    function separarslides(slider, hijo) {
        var imagen = hijo.children[0];
        $(hijo).hide();

                var anchoSlide = Math.round(slider.width()/cantidad);
                var altoSlide = Math.round(slider.height()/cantidad);
                var id = 0;
                var idFila = 1;

                for(var j = 0; j < altoTotal; j+=altoSlide){    
                    id = idFila;
                    for(var i = 0; i < cantidad; i++){                  
                        slider.append(
                            $('<div class="slice'+id+'" style="position:absolute;" name="'+id+'"><img src="'+ $(imagen).attr('src') +'" style="position:absolute; width:'+ slider.width() +'px; height:'+slider.height()+'px; display:block !important; top:'+ j*-1 +'px;; left:'+ i * anchoSlide*-1 +'px;" /></div>').css({ 
                                left:(anchoSlide*i)+'px',
                                top:j+'px',                         
                                width:anchoSlide+'px',
                                height:altoSlide+'px',
                                opacity:'0',
                                overflow:'hidden'
                            })
                        );                      
                        lastId = id;
                        id++;                       
                        if(i==3)
                           idFila++;                       
                    }                   
                }
        //slider.append($(alert(lastId)));  //Para ver el numero final que tiene lastId
    } 

    function aparecer(){

            var slices = $('.slice', contenedor);
            var time = 500;

            for(i=1;i<=lastId;i++){
               $(".slice"+i).fadeTo(time,1);
               time+=650;
            }
    }  
  }  
})(jQuery); 
```

javascript 中的最后一个函数负责显示 div，但在这种情况下，div 有不同的类，我怎样才能通过 div 的名称来制作它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T18:37:05.303

首先，我很确定您不应该在元素上使用该`name`属性。`<div>`

那么为什么不直接使用类名，因为它使用与您的 name 属性相同的 id 呢？

```
$('.slice3') 
```

编辑：这是我如何构建它的示例：

```
...
slider.append(
    $('<div class="slice slice'+id+'" style="position:absolute;"><img src="'+ $(imagen).attr('src') +'" style="position:absolute; width:'+ slider.width() +'px; height:'+slider.height()+'px; display:block !important; top:'+ j*-1 +'px;; left:'+ i * anchoSlide*-1 +'px;" /></div>').css({ 
        left:(anchoSlide*i)+'px',
        top:j+'px',                         
        width:anchoSlide+'px',
        height:altoSlide+'px',
        opacity:'0',
        overflow:'hidden'
    })
);  
... 
```

现在您可以将一些 CSS 添加到所有`slice`类，并将 jQuery 添加到特定`slice3`类。

CSS：

```
slice {
    background: green:
} 
```

JS：

```
$('.slice3').click(...); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T18:46:29.307

这是一个适用于您的情况的选择器：

```
$('div[name="3"]') 
```

# uilabel - 忽略隐藏的uilabel的自动布局

> ID：15300798
> 
> 赞同：0
> 
> 时间：2013-03-08T18:27:18.587
> 
> 标签：uilabel, hidden, autolayout

我有以下情况：

1.  我正在使用自动布局
2.  我有一个`UITableViewCell`包含`UILabel`信息文本的。下面`UILabel`是其他 UI 元素，如`uilabel`“价格变化”（见第二张图片）和其他元素，如按钮（图中未显示）
3.  由于信息文本`uilabel`的高度是动态的，因此下方的元素会根据信息文本标签的高度垂直向下移动。
4.  在第一张图片中，您可以看到一条水平线。如果信息标签的高度增加，这条水平线会垂直向下移动。“价格变化”标签根据这条水平线的位置垂直对齐。

这工作正常。如果信息文本增长，则其他元素会根据需要向下移动。

![在此处输入图像描述](../Images/4e96361414730270ea173ccd88467915.png)

现在我的问题：有时信息标签和水平分隔符需要隐藏，因为没有信息文本。不幸的是，uilabel 下的元素仍然被标签的高度向下移动，尽管它是隐藏的。请看我图片的右侧。元素应向上移动红色竖线标记的量。

如果信息标签和“需求”标签被隐藏，我如何告诉元素“价格变化”等应该向上移动。

![在此处输入图像描述](../Images/34a92237bd0a4cf4c9dd0afed79ab0c4.png)

更新：

我现在在我的代码中添加了两个 NSLayoutContstraints 并将它们连接到情节提要中创建的约束（请看第三张图片）

![在此处输入图像描述](../Images/094dd5f5703e696f6146bcb52894b2b7.png)

好的，这里有一个解释：我得到了两个 NSLayoutConstraints 第一个：horizo​​ntalSeparatorConstraint 将“Price Changes in”标签与第一个水平分隔符 UIImageView 连接起来。我将该值设置为 4 个单位，这样如果隐藏了“需求”和“特殊请求标签”，则此约束应该生效，并且“价格变化”标签会向上移动。第二个约束： requirementsLabelConststraint - 这个约束描述了第二个水平 UIImageView 和“价格变化”标签之间的不理想空间。间隙应为 4 个单位。如果特殊请求文本可用，则此约束应该是“活跃的”。

这是一些新代码：

```
if( tour.specialRequests.length > 0 ) {
    [demandsLabelContstraint setPriority:UILayoutPriorityDefaultHigh];
    [horizontalSeparatorContstraint setPriority:UILayoutPriorityDefaultLow];

    self.demandsLeftLabel.text = NSLocalizedString(@"GenericTour_Demands", @"");
    self.demandsRightLabel.text = tour.specialRequests;

    demandsLeftLabel.hidden = NO;
    demandsRightLabel.hidden = NO;
    horizontalSeparator.hidden = NO;
} else {
    [demandsLabelContstraint setPriority:UILayoutPriorityDefaultLow];
    [horizontalSeparatorContstraint setPriority:UILayoutPriorityDefaultHigh];

    horizontalSeparator.hidden = YES;
    demandsRightLabel.hidden = YES;
    demandsLeftLabel.hidden = YES;
} 
```

从代码中可以看出：我的想法是针对每种情况切换优先级。如果特殊请求文本可用，则通过设置优先级触发相应的 NSLayoutContraints。

我对 Autolayout 的意图或理解是，通过更改优先级，我可以在它们之间切换。但情况似乎并非如此。

那么我应该如何解决我的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T00:53:30.807

如果您添加一个`IBOutlet`.

因此，您可以`IBOutlet`为与信息标签和水平分隔符相关的约束添加一个，然后当它们被隐藏时，您可以删除这些约束并在标签再次显示时将它们放回去。

然后，您还可以添加一个新约束，将价格更改标签链接到顶部的水平分隔符，只要信息标签被隐藏，以便价格更改标签将正确连接

WWDC 2012 中有一个视频解释了如何做这样的事情，我认为这是掌握自动布局的最佳实践

# python - python：使用另一个文件夹中的测试在文件夹上运行覆盖（Eclipse PyDev）

> ID：15300799
> 
> 赞同：1
> 
> 时间：2013-03-08T18:27:21.057
> 
> 标签：python, eclipse, code-coverage, pydev

我的 python 模块在文件夹 A 中，但我的测试在文件夹 B 中。在 Eclipse Pydev 中使用覆盖率时，如何使此设置正常工作？

尝试的事情：

1.  目前，如果我使用 A 作为文件夹，则覆盖率为 0%；
2.  如果我将 B 链接到项目中，它会将我的测试类视为代码类。
3.  然后我尝试将所有测试复制到 A 并再次运行它，仍然是 0% 的覆盖率。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T18:39:05.193

如果你想让 python 编译器知道它们在哪里，你可以简单地将它们的路径添加到 sys.path，这就是你要找的吗？

[链接到 python 文档中的 sys.path](http://docs.python.org/2/library/sys.html#sys.path)

**编辑：** 尝试使用类似的东西

```
sys.path.append(r"C:\path\to\tests") 
```

# scala - play - 如何在 Global.scala 中的 onError 中得到结果

> ID：15300806
> 
> 赞同：0
> 
> 时间：2013-03-08T18:27:42.447
> 
> 标签：scala, playframework-2.0

我需要在 onError 方法中访问响应状态码和其他响应参数。我该怎么做？

我当前的 onError -

```
@Override
public Result onError(RequestHeader rh, Throwable t) {  
    return null;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T19:32:41.970

如果发生错误，您将无法从响应中获得任何信息：代码从未到达`Result`创建 a 的位置。

# git - 获取日期之后的提交历史记录（since/after 参数）

> ID：15300807
> 
> 赞同：1
> 
> 时间：2013-03-08T18:27:45.537
> 
> 标签：git, shell, date, version-control

现在是3月8日。我想查看自 3 月 1 日以来的 git 历史记录。为此，我正在使用命令：

```
$ git log --pretty="%cd - %h - %an - %s" --after="2013-3-01 0am" 
```

它工作正常。然后我想看看“未来”的历史（自 3 月 8 日起，`after`价值增加了​​ +1 天）。例子：

```
$ git log --pretty="%cd - %h - %an - %s" --after="2013-3-11 0am" 
```

命令返回空历史，这是正确的。那么`after`值等于 18：

```
$ git log --pretty="%cd - %h - %an - %s" --after="2013-3-18 0am" 
```

Git 开始返回**整月历史**。为什么？`git log`在我的示例中，日期时间格式似乎有问题。

git 版本 1.7.12.4 (Apple Git-37)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T19:43:38.757

在这个问题上有一个[开放的错误。](https://git-scm.atlassian.net/browse/AUTO-3072)如果您从源代码构建了 git，`test-date`则包含一个实用程序。以下是通过它运行各种日期的一些结果（注意 - 18 号不再是我的断点，所以使用 19 号）：

```
$ ./test-date approxidate "2013-3-01 0am"
2013-3-01 0am -> 2013-03-01 19:22:21 +0000

$ ./test-date approxidate "2013-3-11 0am"
2013-3-11 0am -> 2013-03-11 19:22:21 +0000

$ ./test-date approxidate "2013-3-19 0am"
2013-3-19 0am -> 2013-03-03 19:22:21 +0000 
```

很明显，在所有情况下时间都是有问题的，所以让我们修正一下时间：

```
$ ./test-date approxidate "2013-3-01 0:00"
2013-3-01 0:00 -> 2013-03-01 08:00:00 +0000
$ ./test-date approxidate "2013-3-19 0:00"
2013-3-19 0:00 -> 2013-03-19 07:00:00 +0000 
```

看起来好一点，我们未来的日期不再严重不正确，但时间与我的时区有关，并且在有和没有 DST 之间有所不同（E：对于任何未来的读者，DST 转变发生在 2013-03-10 ，所以这些日期确实包含了转变）。

```
$ ./test-date approxidate "2013-3-19 0:00 +0000"
2013-3-19 0:00 +0000 -> 2013-03-19 00:00:00 +0000 
```

现在我们的约会看起来好多了。如果我确实希望时区生效，现在可以轻松更改为`-0800`/ `-0700`、`PST`、`PDT`或任何其他时区。

简而言之，有两个问题：

1.  您的时间没有被正确解析。一旦包含了时间组件，git 在解析日期方面就会变得更加智能。
2.  在解析任何日期的过程中，git 会丢弃你的并在当月的某一天`dd`使用你的：`mm`

    ```
    $ ./test-date approxidate "2013-3-20"
    2013-3-20 -> 2013-03-03 19:22:21 +0000
    $ ./test-date approxidate "2013-4-19"
    2013-4-19 -> 2013-03-04 19:22:21 +0000
    $ ./test-date approxidate "2013-4-32"
    2013-4-32 -> 2013-03-04 19:22:21 +0000 
    ```

您的问题应该可以通过固定时间并根据意图添加时区来解决。

# java - 从文件中获取 Json 以用于 Java 中的 RESTful Post 请求

> ID：15300811
> 
> 赞同：0
> 
> 时间：2013-03-08T18:28:02.203
> 
> 标签：java, json, rest

我见过几个人拿一个字符串并将其用作 Json 的例子。我想从一个包含 json 的文件中读取，并将其用作我的请求的正文。最有效的方法是什么？

非常感谢帮忙。我的最终解决方案，使用 groovy 控制台并从 .json 文件中读取，如下所示：

```
@Grab(group='org.apache.httpcomponents', module='httpclient', version='4.2.3')
@Grab(group='org.apache.httpcomponents', module='httpcore', version='4.2.3')
@Grab(group='org.apache.commons', module='commons-io', version='1.3.2')
import org.apache.http.impl.client.DefaultHttpClient
import org.apache.http.client.methods.HttpPost
import org.apache.http.HttpResponse
import org.apache.http.HttpEntity
import org.apache.http.entity.StringEntity
import org.apache.http.util.EntityUtils
import org.apache.commons.io.IOUtils

String json = IOUtils.toString(new FileInputStream("C:\\MyHome\\example.json"));

DefaultHttpClient httpclient = new DefaultHttpClient();
HttpPost httpPost = new HttpPost("http://api/location/send");
httpPost.addHeader("content-type", "application/json");
httpPost.setEntity(new StringEntity(json));
HttpResponse response2 = httpclient.execute(httpPost);

try {
    System.out.println(response2.getStatusLine());
    HttpEntity entity2 = response2.getEntity();
    // do something useful with the response body
    // and ensure it is fully consumed
    EntityUtils.consume(entity2);
} finally {
    httpPost.releaseConnection();
} 
```

这对我来说是一个很好的快速健全性检查，是一种快速原型化的好方法，可以更好地了解我正在尝试做的事情。再次感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T20:14:59.747

您可以使用 Apache [HttpComponents](http://hc.apache.org/index.html)。这是一个小示例，您可以在 Groovy 附带的 GroovyConsole 中试用。我使用它是因为它是快速原型化的最简单方法，因为使用 Grape 自动加载库 jar（这就是 @Grab 注释所做的）。此外，在 GroovyConsole 中，无需创建项目。您也不需要使用 Groovy，尽管我通常会这样做。

请注意，下面的代码是从[HttpClient Quick Start](http://hc.apache.org/httpcomponents-client-ga/quickstart.html)中获取的修改后的 POST 示例。另外，请注意 HttpComponents/HttpClient 是一个较新的项目，它取代了来自 Apache 的旧 HttpClient（如果您在 Google 周围搜索并看到没有 HttpComponents 的 HttpClient，请清除它）。我使用的主机 (posttestserver.com) 只是一个测试服务器，它将接受 Http 请求并在一切正常时返回响应。

```
@Grab(group='org.apache.httpcomponents', module='httpclient', version='4.2.3')
@Grab(group='org.apache.httpcomponents', module='httpcore', version='4.2.3')
import org.apache.http.impl.client.DefaultHttpClient
import org.apache.http.client.methods.HttpPost
import org.apache.http.HttpResponse
import org.apache.http.HttpEntity
import org.apache.http.entity.StringEntity
import org.apache.http.util.EntityUtils

String json = "{foo: 123, bar: \"hello\"}";

DefaultHttpClient httpclient = new DefaultHttpClient();
HttpPost httpPost = new HttpPost("http://posttestserver.com/post.php");
httpPost.setEntity(new StringEntity(json));
HttpResponse response2 = httpclient.execute(httpPost);

try {
    System.out.println(response2.getStatusLine());
    HttpEntity entity2 = response2.getEntity();
    // do something useful with the response body
    // and ensure it is fully consumed
    EntityUtils.consume(entity2);
} finally {
    httpPost.releaseConnection();
} 
```

# c++ - 为什么在 FreeLibrary() 之后从 DLL 中分配的内存变得无效？

> ID：15300812
> 
> 赞同：4
> 
> 时间：2013-03-08T18:28:04.297
> 
> 标签：c++, winapi, dll, dynamic-memory-allocation

我今天遇到了这个错误，原来是因为我**在**调用`FreeLibrary()`.

这是一个重现崩溃的简单示例。这在 DLL 中：

```
void dllFunc(char **output)
{
    *output = strdup("Hello"); // strdup uses malloc
} 
```

这是在加载 DLL 的 EXE 中：

```
void exeFunc()
{
    char *output;
    dllFunc(&output);
    std::string s1 = output; // This succeeds.
    FreeLibrary(dll);
    std::string s2 = output; // This crashes with access violation.
} 
```

我阅读了文档，`FreeLibrary()`但在调用内存后我找不到任何关于内存变得无效的信息。

**编辑**

我刚刚意识到我一直在为 DLL 使用 VS2008 工具链，而为 EXE 使用 VS2010 工具链（我将 VS2010 用作两者的 IDE，但您可以从项目设置中选择工具链）。将 DLL 的工具链设置为 VS2010 也消除了崩溃。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-09T06:57:25.493

如果您选择与 MSVCRT（C 运行时）库的静态链接，您将获得您所描述的行为。如果您的 EXE 和 DLL 动态链接到 MSVCRT DLL，但使用不同的版本，也会发生同样的事情。或者如果它们与相同的版本匹配，但一个使用 DEBUG 而另一个使用 RETAIL。换句话说，内存只与用于进行分配的 MSVCRTxxx.dll 的生命周期一样好。我刚刚看到您对问题的更新-是的，在 VS 2008 和 2010 之间混合和匹配 CRT 是崩溃的确切原因。

如果您的 DLL 和 EXE 都动态链接到**同一**版本的 MSVCRT DLL，那么您共享内存堆并避免您遇到的问题。

标准做法是这样的：如果您导出的 DLL 函数返回任何需要稍后“释放”或“释放”的东西，那么标准做法是提供一个从 DLL 导出的附加函数来处理取消分配。

您可以从代码生成页面为项目中的 C/C++ 项目设置配置 EXE 和 DLL 的 C 运行时链接。

图片在这里：http: [//imgur.com/uld4KYF.png](https://imgur.com/uld4KYF.png)

![](../Images/f9bf6d499d032e971c5af38e39d49cfc.png)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-08T18:36:20.787

这是因为每个 Dll 创建了自己的内存堆（它`malloc`和它的 C 朋友，以及`new`将在内部使用，通常是 via `HeapAlloc`），并且当 Dll 被释放时，它的堆也是如此。

有关更多 Dll 内存警告，请参阅[此 MSDN 文章](http://msdn.microsoft.com/en-us/library/ms235460%28v=vs.110%29.aspx)。除非您使用自定义内存分配器，在所有二进制文件中共享，否则您需要在创建它的模块内保持动态分配的内存（除非您可以 100% 保证该对象不会超过其创建者）。

# sql - 检查日期是否大于/小于

> ID：15300813
> 
> 赞同：0
> 
> 时间：2013-03-08T18:28:06.207
> 
> 标签：sql, oracle

```
to_char(to_date(A.PERMISSION_USE_DT, 'YYYY-MM-DD')) < to_char(to_date(sysdate, 'YYYY-MM-DD')) 
```

`A.PERMISSION_USE_DT`当前格式为`04/12/2013`; 如果日期早于系统日期，我想检查并匹配。我该怎么做呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-08T18:34:49.530

如果 A.Permission_Use_Dt 是日期类型，则无需进行 TO_CHAR/TO_DATE 转换。只需这样做：

```
A.Permission_Use_Dt < SYSDATE 
```

请注意，SYSDATE 也有一个时间组件，所以现在是今天的日期和*时间*。要仅比较值的日期部分，请执行以下操作：

```
TRUNC(A.Permission_Use_Dt) < TRUNC(SYSDATE) 
```

# java - Java 1.6 中的枚举类主体功能

> ID：15300816
> 
> 赞同：7
> 
> 时间：2013-03-08T18:28:13.817
> 
> 标签：java, enums

```
enum CoffeeSize{               
      BIG(8),   
      HUGE(10),   
      OVERWHELMING(16) {   

       public String getLidCode(){   
            return "A";   
       }   
      };   

    private int ounces;   

    public int getOunces(){   
         return ounces;   
    }    

    CoffeeSize(int ounces){   
        this.ounces = ounces;   
    }   

    public String getLidCode(){   
            return "B";   
    }   
} 
```

这是 K&B 6 书中的 SCJP 1.6 问题。这是作为 SCJP 6 功能的常量特定类主体的示例。我如何执行它并查看结果输出？

我有两个问题：

1.  我的 Java 主要方法是什么样的？请帮我执行这个部分代码。我无法理解输出的行为。

2.  `getLidCode()`该方法在 Java 1.6 的此类主体中如何工作？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-08T18:46:16.660

您所说的常量特定类主体是[JLS](http://docs.oracle.com/javase/specs/jls/se5.0/html/classes.html#8.9)所指*的枚举常量的可选类主体*。它被实现为一个匿名的内部类，它*扩展*了外部的封闭枚举。因此，在您的情况下，枚举常量`OVERWHELMING`将是一个匿名内部类型，它扩展`CoffeeSize`并覆盖方法`getLidCode()`。在伪代码中，内部类看起来像这样：

```
class CoffeeSize$1 extends CoffeeSize {
    @Override
    public String getLidCode() {
        return "A";
    }
} 
```

调用`getLidCode()`常量`BIG`或`HUGE`将调用基本枚举实现，而调用相同的方法`OVERWHELMING`将调用该方法的覆盖版本，因为`OVERWHELMING`实际上是不同的类型。要进行测试，只需运行代码来调用`getLidCode()`不同的枚举常量。

```
System.out.println(CoffeeSize.BIG.getLidCode());
System.out.println(CoffeeSize.HUGE.getLidCode());
System.out.println(CoffeeSize.OVERWHELMING.getLidCode()); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-09T12:53:26.430

```
I have executed my answer,as below.Please correct me if im wrong.output is given. 
```

干杯:-))

```
public class EnumOverriddenExample {
enum CoffeeSize{               
      BIG(8),   
      HUGE(10),   
      OVERWHELMING(16){   

           public String getLidCode(){   
                return "A";   
           }   
      };

    CoffeeSize(int ounces){   
            this.ounces = ounces;   
    }

    private int ounces;   

    public int getOunces(){   
         return ounces;   
    }   

    public void setOunces(int ounces){   
         this.ounces=ounces;   
    }

    public String getLidCode(){   
            return "B";   
    }   
}  
public static void main(String[] args) {
    // TODO Auto-generated method stub
    System.out.println("CoffeeSize for BIG is "+EnumOverriddenExample.CoffeeSize.BIG.getLidCode());
    System.out.println("CoffeeSize for HUGE is "+EnumOverriddenExample.CoffeeSize.HUGE.getLidCode());
    System.out.println("CoffeeSize for OVERWHELMING is "+EnumOverriddenExample.CoffeeSize.OVERWHELMING.getLidCode());

    System.out.println("CoffeeSize for BIG is "+EnumOverriddenExample.CoffeeSize.BIG.getOunces());
    System.out.println("CoffeeSize for HUGE is "+EnumOverriddenExample.CoffeeSize.HUGE.getOunces());
    System.out.println("CoffeeSize for OVERWHELMING is "+EnumOverriddenExample.CoffeeSize.OVERWHELMING.getOunces());

}

}

Output is below
-----------------------------------
CoffeeSize for BIG is B --> returns "B"
CoffeeSize for HUGE is B -->returns "B"
CoffeeSize for OVERWHELMING is A--constant specific class body returns "A"
CoffeeSize for BIG is 8
CoffeeSize for HUGE is 10
CoffeeSize for OVERWHELMING is 16
------------------------------------ 
```

# javascript - 永远滚动使用数组动态加载内容

> ID：15300817
> 
> 赞同：0
> 
> 时间：2013-03-08T18:28:14.837
> 
> 标签：javascript, arrays, loops, get, scroll

我有这段代码，它工作正常，问题是它会一遍又一遍地加载内容，这是我想要的，但同时我不想要。我希望每次滚动到底部时都会加载一个新页面。基本上，我正在尝试为我的成员列表创建一个 Forever Scroll。url 是相同的，除了一个整数被 28 分割 0-28-56-84 等等。代码是

```
 function yHandler () {
   var wrap = document.getElementById('members_wrapper');
   var contentHeight = wrap.offsetHeight;
   var yOffset = window.pageYOffset;
   var y = yOffset + window.innerHeight;
 if (y >= contentHeight) {
    $.get('/memberlist?mode=lastvisit&order=DESC&start=28&username',function(data) {
     var elems= $(data);
      $('#members_wrapper').append(elems.find('#members_wrapper'));
   },'html');

  }
}

window.onscroll = yHandler; 
```

老实说，我不太确定该怎么做……我确定我可以做到以下几点，

```
var number = ["28","56","84"];
   for (var i = 0; i>number.length; i++) {
      var url = '/memberlist?mode=lastvisit&order=DESC&start='+ number[i] +'&username'
 } 
```

然后反过来我可以像这样发帖`$.get(url, function(data) {`

如果这行得通，请告诉我，因为下一个问题是，如果我有超过 84 个成员并且有一天会增加到 200 多个成员怎么办？然后我会反过来做一个我从未做过的数学方程式，所以让我解释一下......

如果 number 已经通过 + 28；

是的，我知道这是不正确的，因为我不知道该怎么做。基本上我真正需要的是，如果 url 已经通过添加 28 ，然后在页面向下滚动时传递下一个 url。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T18:48:27.767

在 AJAX 请求拉入内容之前，`window.onscroll`处理程序将触发多次，这意味着您将触发多个 AJAX 请求。

跟踪您何时请求成员列表，如果 AJAX 请求仍在处理中，则不要运行 onscroll 处理程序。

```
var fetchingContent = false; // tracks if an AJAX request is active

function yHandler () {
   var wrap = document.getElementById('members_wrapper');
   var contentHeight = wrap.offsetHeight;
   var yOffset = window.pageYOffset;
   var y = yOffset + window.innerHeight;

   if (y >= contentHeight && !fetchingContent) {
       // set to TRUE before AJAX request
       fetchingContent = true; 
       $.get('/memberlist?mode=lastvisit&order=DESC&start=28&username',function(data) {
           var elems= $(data);
           $('#members_wrapper').append(elems.find('#members_wrapper'));
           // set to FALSE after AJAX request complete
           fetchingContent = false; 
        },'html');
   }
}

window.onscroll = yHandler; 
```

**编辑**

要在 url 中加载适当的起始值，您需要保留对它的引用。

```
var start = 0, limit = 28;

// once the AJAX request has finished you can update the start value
// notice the start variable is dynamically added to the AJAX url
$.get('/memberlist?mode=lastvisit&order=DESC&start='+start+'&username',function(data) {
    var elems= $(data);
    $('#members_wrapper').append(elems.find('#members_wrapper'));
    // set to FALSE after AJAX request complete
    fetchingContent = false; 
    // add to the start value for the next AJAX request
    start = start + limit;
},'html'); 
```

做这个客户端的问题是你不知道什么时候达到了用户总数。因此，您需要检查是否有错误响应。

服务器端

```
$response = array();
if (no members found with given start value) {
    $response['success'] = 0;
} else {
    $html = {get members and build div}
    $response['success'] = 1;
    $response['html'] = $html;
}

// send JSON back to the client
echo json_encode($response); 
```

现在您需要检查 AJAX 响应中的成功参数。请注意，我将其更改`$.get datatype`为`json`. 你也可以`$.getJSON`改用。

```
$.get('/memberlist?mode=lastvisit&order=DESC&start='+start+'&username',function(response) {
    if (response.success === 1) {
        var elems= $(response.html);
        $('#members_wrapper').append(elems.find('#members_wrapper'));
        // set to FALSE after AJAX request complete
        fetchingContent = false; 
        // add to the start value for the next AJAX request
        start = start + limit;
    }
},'json'); 
```

# java - JPanel repaint() 调用不起作用

> ID：15300818
> 
> 赞同：0
> 
> 时间：2013-03-08T18:28:17.117
> 
> 标签：java, swing, jpanel

我觉得这个问题的解决方案非常简单，我只是忽略了一些愚蠢的事情，但我似乎无法让我的一个 JPanel 的 repaint() 方法工作。有问题的 JPanel 是另一个类的成员对象，它处理绘制到 JPanel 背后的所有逻辑，但是，每当我在线程中调用 repaint() 时，我看不到任何绘制，也看不到我的系统。 out.println() 调用，我把它放在那里是为了调试。为方便起见，我已将文件放在 Github 上。以下是我认为可能与它有关的三个文件。如果需要，您可以随时查看其他人。

[SageLife.java](https://github.com/packetpirate/SageLife/blob/master/SageLife/src/sagelife/SageLife.java)

[LifeFramework.java](https://github.com/packetpirate/SageLife/blob/master/SageLife/src/sagelife/framework/LifeFramework.java)

[网格.java](https://github.com/packetpirate/SageLife/blob/master/SageLife/src/sagelife/canvas/Grid.java)

我之前创建了很多 JPanel 并且很少遇到这个问题，所以我只是不确定是什么原因造成的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T18:32:11.153

你是压倒一切的`paintComponents`，而不是`paintComponent`在你的`Grid` `JPanel`. 这不遵循 Swing 的绘制链机制。

```
@Override
public void paintComponents(Graphics g) {
    super.paintComponents(g); 
```

注意：始终使用[Swing Timer](http://docs.oracle.com/javase/tutorial/uiswing/misc/timer.html) over`Thread`来处理 Swing 中的 UI 更新。

# iphone - 在 iOS6 中，将 ViewController 推送到堆栈时出现问题

> ID：15300819
> 
> 赞同：8
> 
> 时间：2013-03-08T18:28:19.443
> 
> 标签：iphone, ios, cocoa-touch, uiviewcontroller

我设置了以下视图控制器：

viewController1 可以自由旋转到任何方向，除了纵向倒置。

viewController2 被推到 viewController1 的顶部，我希望它与 viewController1 的方向相同，并且我希望它不能旋转。

viewController3 被推到 viewController2 之上。我希望 viewController3 处于纵向模式。

我在尝试在 iOS6 中完成此操作时遇到了很多问题（在 iOS5 中尚未尝试过）。首先，我已经创建了自己的导航控制器并将以下内容放入其中：

```
- (UIInterfaceOrientation)preferredInterfaceOrientationForPresentation
{
    return [self.topViewController preferredInterfaceOrientationForPresentation];
}

- (NSUInteger)supportedInterfaceOrientations
{
    return [self.topViewController supportedInterfaceOrientations];
}

- (BOOL) shouldAutorotate
{
    return [self.topViewController shouldAutorotate];
} 
```

我已经尝试了很多这些东西的不同组合以了解是否有用。如果 vc2 处于横向状态，我主要在苦苦挣扎的地方是强制 vc3 显示为纵向。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-08T19:00:20.470

您在这里尝试做的是与框架作斗争。您所描述的根本不是导航控制器架构在 iOS 6 中的工作方式。如果您想显示视图控制器的视图并强制旋转，请使用呈现的视图控制器。这是唯一`preferredInterfaceOrientationForPresentation`有意义的时间，并且`supportedInterfaceOrientations`实际上将咨询您的视图控制器，因为在呈现时，它将位于界面的根部。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-05-04T22:22:21.047

我在另一个答案中解释说，iOS 6 不支持在将新视图控制器推到导航控制器时*强制旋转。*您可以构建有关*补偿*旋转的规则（即如果用户旋转*设备*会发生什么），但您不能*强制*界面旋转。iOS 6 很乐意让您*强制*旋转的唯一情况是在呈现或关闭视图控制器（`presentViewController:animated:`和`dismissViewControllerAnimated:`）时。

但是，可以使用呈现的视图控制器，使其*看起来*像是在推动导航控制器。我制作了一部电影来表达我的意思：

[http://youtu.be/O76d6FhPXlE](http://youtu.be/O76d6FhPXlE)

现在，无论如何，这并不完全完美。状态栏没有旋转动画，两个视图之间有一种黑色的“闪烁”——这是故意的，因为它是为了掩盖*真正*发生的事情。真正发生的是，实际上有*两个*不同的导航控制器和*三个*视图控制器，如故事板的屏幕截图所示。

![在此处输入图像描述](../Images/52f55164077aff6a4978847b117d9de6.png)

我们拥有的是：

*   设置为纵向的导航控制器子类及其根视图控制器

*   第二个导航控制器子类设置为横向，以及它的根视图控制器，它是黑色的，用作中介

*   第三个视图控制器被推送到第二个导航控制器的堆栈上

当用户要求从第一个视图控制器“前进”时，我们*呈现*第二个导航控制器，因此暂时看到黑色视图控制器，但随后我们立即*推动*第三个视图控制器。所以我们得到了强制旋转，以及一种黑色闪光和推动动画。当用户点击第三个视图控制器中的后退按钮时，我们反转该过程。

所有的过渡代码都在黑色视图控制器（ViewControllerIntermediary）中。我试图调整它以提供我能做到的最令人满意的动画：

```
@implementation ViewControllerIntermediary {
    BOOL _comingBack;
}

- (void) viewDidLoad {
    [super viewDidLoad];
    self.navigationController.delegate = self;
}

-(void)navigationController:(UINavigationController *)nc 
        willShowViewController:(UIViewController *)vc 
        animated:(BOOL)anim {
    if (self == vc)
        [nc setNavigationBarHidden:YES animated:_comingBack];
    else
        [nc setNavigationBarHidden:NO animated:YES];
}

-(void)viewDidAppear:(BOOL)animated {
    [super viewDidAppear:animated];
    if (!_comingBack) {
        [self performSegueWithIdentifier:@"pushme" sender:self];
        _comingBack = YES;
    }
    else
        [self.navigationController dismissViewControllerAnimated:YES 
            completion:nil];
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-12-19T07:55:06.117

```
- (NSUInteger)application:(UIApplication *)application supportedInterfaceOrientationsForWindow:(UIWindow *)window
{
if ([self.window.rootViewController.presentedViewController isKindOfClass: [SecondViewController class]])
{
    SecondViewController *secondController = (SecondViewController *) self.window.rootViewController.presentedViewController;

    if (secondController.isPresented)
        return UIInterfaceOrientationMaskAll;
    else return UIInterfaceOrientationMaskPortrait;
}
else return UIInterfaceOrientationMaskPortrait;
} 
```

对于斯威夫特

```
func application(application: UIApplication, supportedInterfaceOrientationsForWindow window: UIWindow) -> Int {

    if self.window?.rootViewController?.presentedViewController? is SecondViewController {

        let secondController = self.window!.rootViewController.presentedViewController as SecondViewController

        if secondController.isPresented {
            return Int(UIInterfaceOrientationMask.All.toRaw());
        } else {
            return Int(UIInterfaceOrientationMask.Portrait.toRaw());
        }
    } else {
        return Int(UIInterfaceOrientationMask.Portrait.toRaw());
    }

} 
```

有关更多详细信息，请查看此[链接](http://swiftiostutorials.com/ios-orientations-landscape-orientation-one-view-controller/)

# windows - Workingset/privateWorkingSet 内存不计入任务管理器中的内存使用量

> ID：15300823
> 
> 赞同：1
> 
> 时间：2013-03-08T18:28:34.650
> 
> 标签：windows, memory-management, process, operating-system, taskmanager

**内存问题**

我们的其中一台服务器在任务管理器中显示 96% 的内存使用率（使用了 137/140GB 左右）。

但是，当我查看“进程”选项卡时（即使检查了所有用户的显示进程），在高峰时间合并的顶级进程仅使用 40GB 左右。我在下面提供了最常用进程的图像以及显示内存使用情况的性能面板图像。

*注意：CPU 使用率通常不会达到 99%，当我截取该屏幕截图时它会飙升。*

**我的问题**

这种差异的原因是什么，我怎样才能更准确地判断哪些进程正在占用另外 100GB 的内存？

* * *

![任务管理器内存使用率最高的进程](../Images/0099515643dddc3c32f2fa535e554366.png)

为了验证，这是性能面板的图像：

![性能面板](../Images/352fc61d727253ab09ae876cd6860ebc.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T16:20:28.370

Sergmat 在他的评论中是正确的（顺便谢谢）；实际上我昨天自己找到了 RAMMAP 并使用它，它揭示了问题。

我们的服务器运行一个使用非常频繁的 SQL Server 实例。RAMMAP 显示有一个 105GB 的内存区域用于“AWE”地址窗口扩展——它们用于通过诸如 RDBMS (SQL Server) 之类的东西非常快速地操作大内存区域。

显然，您可以配置 SQL Server 将使用的最大内存，包括在内；这就是解决方案。

# android - Android：无法在问答游戏中识别正确答案

> ID：15300824
> 
> 赞同：0
> 
> 时间：2013-03-08T18:28:39.600
> 
> 标签：android, multiple-choice

好吧，我有这个问题大约 3 天。我正在做一个问答游戏，但我无法确定点击的按钮是否包含正确答案。按照我在这里看到的一些提示，我对代码进行了一些更改。查看新代码：

```
package com.app;

import java.util.ArrayList;
import java.util.Collections;
import java.util.List;
import java.util.Random;

import android.os.Bundle;
import android.app.Activity;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.TextView;

public class MyActivity extends Activity implements OnClickListener {

    TextView textView1, textView2;
    Button btn1, btn2, btn3, btn4;

    ArrayList<Question> qsts = new ArrayList<Question>();
    List<Integer> generated = new ArrayList<Integer>();

    ArrayList<String> allAnswers = new ArrayList<String>();

    Random rng = new Random();
    Question nextQuestion;

// Creating the objects Question that recieves the values "questionText", "correctAnswerText", and the other 3 wrong answers "wrongAnswer1" 2 and 3...

    Question q1 = new Question(
            "Question 1",

            "Correct Answer - Question 1",
            "Wrong 1 - Question 1",
            "Wrong 2 - Question 1",
            "Wrong 3 - Question 1"
            );
    Question q2 = new Question(
            "Question 2",

            "Correct Answer - Question 2",
            "Wrong 1 - Question 2",
            "Wrong 2 - Question 2",
            "Wrong 3 - Question 2"
            );
    Question q3 = new Question(
            "Question 3",

            "Correct Answer - Question 3",
            "Wrong 1 - Question 3",
            "Wrong 2 - Question 3",
            "Wrong 3 - Question 3"
            );

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_other);

    // ADD THE QUESTIONS IN THE ArrayList qsts

    qsts.add(q1);           
        qsts.add(q2);
        qsts.add(q3);

        textView1 = (TextView) findViewById(R.id.textView1);
            textView2 = (TextView) findViewById(R.id.textView2);

            btn1 = (Button) findViewById(R.id.btn1);
            btn2 = (Button) findViewById(R.id.btn2);
            btn3 = (Button) findViewById(R.id.btn3);
            btn4 = (Button) findViewById(R.id.btn4);

            btn1.setOnClickListener(this);
            btn2.setOnClickListener(this);
            btn3.setOnClickListener(this);
            btn4.setOnClickListener(this);

        generateQuestion();

    }

        public void generateQuestion(){

            while(true){

                int nxt = rng.nextInt(3);

                if (!generated.contains(nxt)){

                    generated.add(nxt);

                    Question nextQuestion = qsts.get(nxt);

                    textView1.setText(nextQuestion.questionText);

                    allAnswers.add(nextQuestion.correctAnswerText);
                    allAnswers.add(nextQuestion.wrongAnswer1);
                    allAnswers.add(nextQuestion.wrongAnswer2);
                    allAnswers.add(nextQuestion.wrongAnswer3);

                    Collections.shuffle(allAnswers);

                    btn1.setText(allAnswers.get(0));
                    btn2.setText(allAnswers.get(1));
                    btn3.setText(allAnswers.get(2));
                    btn4.setText(allAnswers.get(3));

                    break;
                }
            }
        }

        @Override
        public void onClick(View v) {
            Button b = (Button)v;
            String buttonText = b.getText().toString();

            if(buttonText.equals(nextQuestion.correctAnswerText))
            { 

                textView2.setText("CORRECT!");
                generateQuestion();
                return;

            }else{
                textView2.setText("WRONG!");
                generateQuestion();
                return;
            }

        }
} 
```

我在 Question 类代码中创建对象并使用`static`对象，但是按照提示，我这样做了。

这是课程代码：

```
package com.app;

public class Question {

    String questionText;
    String correctAnswerText;       
    String wrongAnswer1;
    String wrongAnswer2;
    String wrongAnswer3;

    Question (String qst, String cAns, String wAns1, String wAns2, String wAns3){

        questionText = qst;
        correctAnswerText = cAns;
        wrongAnswer1 = wAns1;
        wrongAnswer2 = wAns2;
        wrongAnswer3 = wAns3;

    } 
```

我知道问题出`if`在 onClick 方法的比较中，因为当我将 String buttonText 与其他内容进行比较时，它可以工作。请有人告诉我为什么我不能与`nextQuestion.correctAnswerText`. 我在错误的地方声明了什么吗？

观察：当我单击包含答案（正确或错误）的 4 个按钮之一时，应用程序停止

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T18:40:17.210

看到你的声明`Question nextQuestion`两次。一个在全球范围内，另一个在功能上`generateQuestion()`

全局`nextQuestion`为空，这是您的错误。

将函数中的this( `Question nextQuestion = qsts.get(nxt);`) 行 替换`generateQuestion()`为`nextQuestion = qsts.get(nxt);`

**您的评论的解决方案。** `allAnswers.clear()`在生成新问题之前执行此操作。

```
 if(buttonText.equals(nextQuestion.correctAnswerText))
        { 

            textView2.setText("CORRECT!");
            allAnswers.clear();
            generateQuestion();
            return;

        }else{
            textView2.setText("WRONG!");
            allAnswers.clear();
            generateQuestion();
            return;
        } 
```

# multithreading - 将创建多少进程和线程？

> ID：15300830
> 
> 赞同：8
> 
> 时间：2013-03-08T18:28:56.067
> 
> 标签：multithreading, fork, pid

我有这段代码，并试图了解将由此创建多少进程和线程：

```
pid t pid; 
pid = fork(); 
if (pid == 0) { /* child process */ 
 fork(); 
 thread create( . . .); 
} 
fork(); 
```

我认为它从 if 循环内的 fork 创建了 2 个线程。和8个过程？但我不确定那是否正确

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-03-09T02:36:55.877

实际上，应该有 8 个线程和 6 个进程。

为了清楚起见，这里有图表：

```
1) after first fork():

   |-------------------  child of p0 [p1]
---|-------------------  parent      [p0]

2) after second fork():

       |---------------  child of p1 [p2]
   |---|---------------              [p1]
---|-------------------              [p0]

3) after pthread_create():

            -----------  thread 1 of p2 [p2t1] 
       |---/-----------  thread 0 of p2 [p2t0]
       |    -----------  thread 1 of p1 [p1t1]
   |---|---/-----------  thread 0 of p1 [p1t0]
---|-------------------                 [p0]

4) after third fork():

         |------------ child of p2 [p5]
         |      ------             [p2t1]
       |-|-----/------             [p2t0]
       |   |---------- child of p1 [p4]
       |   |    ------             [p1t1]
   |---|---|---/------             [p1t0]
   |     |------------ child of p0 [p3]
---|-----|------------             [p0] 
```

**重要：**请记住，[fork(2)](http://man7.org/linux/man-pages/man2/fork.2.html)调用只克隆执行它的线程，因此进程 4 [p4] 只有一个线程（同样适用于进程 5[p5]）。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-03-09T00:11:11.923

每次`fork`调用都会创建一个额外的进程。

在第一次调用 时`fork`，父进程 P 创建子进程 SP1。在 fork 之后，父进程`fork`再次调用（跳过`if`），创建子进程 SP2。

`fork`SP1内部fork 调用后`if`，创建子子进程 SSP1。SP1 然后产生一个线程。SP1 离开`if`. 并再次调用`fork`，创建子子流程 SSP2。

SSP1 产生一个线程。SSP1 离开`if`, 并调用`fork`, 创建子子子流程 SSSP。

因此，创建的进程：SP1、SP2、SSP1、SSP2、SSSP = 5 个进程。如果算上原始进程 P，则有 6 个进程。

只有 SP1 和 SSP1 产生线程，因此创建了 2 个线程。如果统计所有进程的所有主线程，有7个或8个线程，这取决于你算不算原始进程P。

正在创建的与代码相关的进程和线程的图示。

```
 P
pid t pid;               |
pid = fork();            +------SP1
if (pid == 0) {          |      |
 fork();                 |      +---------------SSP1
 thread create(...);     |      |-SP1's thread  |-SSP1's thread
}                        |      |               |
fork();                  +-SP2  +-SSP2          +-SSSP
                         | |    | |             | | 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-07-10T15:01:03.820

不应该是2个线程和6个进程吗？

```
M
|  ↘
M     A
|     |↘
M     A*   B*
|     |    |
| ↘   | ↘  |↘
M   C A  D B  E 
```

因为我使用 * 来表示线程。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-01-06T11:59:52.877

总分叉进程是=5 线程创建是=2

# c# - 更改 ListBox 项目间距

> ID：15300831
> 
> 赞同：0
> 
> 时间：2013-03-08T18:29:05.380
> 
> 标签：c#, visual-studio-2010, listbox

我有这个界面：

![在此处输入图像描述](../Images/d58e5219ce672aa9ff9de0289afd2c71.png)

我想要做的是将左侧的名称`ListBox`与右侧的网格对齐或隔开，以便每个名称与每个网格行内联。

我确实试过这个：

```
lstNames.ItemHeight = 15; 
```

但这并不影响它。注意：My`listbox`是使用数据库动态创建和填充的。

关于如何实现这一目标的任何提示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T18:35:57.120

您必须将`DrawMode`属性更改`OwnerDrawFixed`为使用 custom `ItemHeight`。

当你使用`DrawMode.OwnerDrawFixed`你必须`paint/draw items "manually".`

引用`Max`自此`Stackoverflow`发布的[Combobox 外观](https://stackoverflow.com/questions/3789596/combobox-appearance)

```
public class ComboBoxEx : ComboBox
{
    public ComboBoxEx()
    {
        base.DropDownStyle = ComboBoxStyle.DropDownList;
        base.DrawMode = DrawMode.OwnerDrawFixed;
    }

    protected override void OnDrawItem(DrawItemEventArgs e)
    {
        e.DrawBackground();
        if(e.State == DrawItemState.Focus)
            e.DrawFocusRectangle();
        var index = e.Index;
        if(index < 0 || index >= Items.Count) return;
        var item = Items[index];
        string text = (item == null)?"(null)":item.ToString();
        using(var brush = new SolidBrush(e.ForeColor))
        {
            e.Graphics.TextRenderingHint = System.Drawing.Text.TextRenderingHint.ClearTypeGridFit;
            e.Graphics.DrawString(text, e.Font, brush, e.Bounds);
        }
    }
} 
```

# android - Android TextView 不显示受影响的文本

> ID：15300838
> 
> 赞同：0
> 
> 时间：2013-03-08T18:29:34.633
> 
> 标签：android, textview

好的，所以...我一直在尝试将文本影响到 TextView （因为它旨在显示文本，对吗？）但是由于某些我不知道的原因，它拒绝打印我放入其中的任何内容。

我的应用程序有两个活动，MainAcivity 或欢迎屏幕本身，以及一个 GameActivity（该项目是一个 Domino 游戏）。

我在 GameActivity 类的开头创建了我之前编写的 java 对象，然后尝试在 TextView 中显示玩家的姓名。

```
Player player1 = new Player("Hulk"); 
```

如您所想，创建一个名为 Hulk 的玩家。我在 Player.java 中有一个方法来返回玩​​家的名字：

```
player1.getName() 
```

返回字符串“绿巨人”

然后我尝试将我的 TextView 的文本设置为 hulk，首先通过创建一个句柄来处理它：

```
TextView p1v = (TextView) findViewById(R.textviews.p1view); 
```

然后执行以下操作：

```
p1v.setText("Player 1 : " + player1.toString()); 
```

p1view 在 game.xml 布局中定义如下：

```
<LinearLayout
 ...
   <LinearLayout
 ...
         <TextView
            android:id="@+textviews/p1view"
            android:text="Board"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
        />
   </LinearLayout>
</LinearLayout> 
```

我尝试了 p1view.textAppend，尝试使用 android:editable="true"。似乎没有任何效果。

有趣的是，当我尝试在 MainActivity 中做同样的事情时，它可以正常工作，如下所示：public class

```
@Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
    } 
```

在 main.xml 中定义的 TextView 如下：

```
 <TextView
        android:id="@+textviews/mainview_player"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
  /> 
```

以下是文件的完整代码，只是为了避免这样的答案：给我们完整的代码 D：

游戏活动.java：

> 包多米诺.asd;
> 
> 导入 LI260.*；导入android.app.Activity；导入android.os.Bundle；导入 android.widget.TextView；
> 
> 公共类 GameActivity 扩展 Activity {
> 
> ```
> private Player player1 = new Player("HULK");
> private Player player2 = new Player("CPU");
> private Pioche bag = new Pioche();
> private Plateau board = new Plateau();
> private Game game1 = new Game(bag, board, player1, player2);
> TextView p1name = null;
> TextView p2name = null;
> 
> /**
>  * Called when the activity is first created.
>  *
>  * @param savedInstanceState
>  */
> @Override
> public void onCreate(Bundle savedInstanceState) {
>     super.onCreate(savedInstanceState);
>     setContentView(R.layout.game);
>     TextView tv = (TextView) findViewById(R.textviews.p1view);
>     tv.setText(player1.getName());
> }    } 
> ```

游戏.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
              android:orientation="vertical"
              android:layout_width="fill_parent"
              android:layout_height="fill_parent"
              android:weightSum="10"

>
    <!-- Played layout -->
    <LinearLayout
        android:id="@+drawable/gameview_Scores"
        android:layout_width="fill_parent"
        android:layout_height="0px"
        android:layout_gravity="top"
        android:layout_weight="2"
        android:layout_marginBottom="10px"
        android:orientation="horizontal"
        android:background="#ff0000"
        android:gravity="center"
    >
        <Button
            android:id="@+buttons/exitButton"
            android:text="Exit"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:gravity="center"
            />

        <Button
            android:id="@+buttons/drawButton"
            android:text="Draw"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
        />

        <Button
            android:id="@+buttons/scoresButton"
            android:text="Show scores"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
        />
    </LinearLayout>

    <!-- Board layout -->
    <LinearLayout
        android:id="@+textviews/gameview_Table"
        android:layout_width="fill_parent"
        android:layout_height="0px"
        android:layout_gravity="center"
        android:layout_weight="6"
        android:layout_marginBottom="10px"
        android:background="#ffff00"
    >
        <TextView
            android:id="@+textviews/p1view"
            android:text="Board"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
        />
    </LinearLayout>

    <!-- At hand layout -->
    <LinearLayout
        android:id="@+drawable/gameview_Playable"
        android:layout_width="fill_parent"
        android:layout_height="0px"
        android:layout_weight="2"
        android:layout_gravity="bottom"
        android:background="#ff00ff"
    >
        <TextView
            android:id="@+textviews/gameview_AtHandText"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
        />
    </LinearLayout>
</LinearLayout> 
```

MainActivity.java：

```
package domino.asd;

import LI260.*;
import android.app.Activity;
import android.os.Bundle;
import android.view.View;
import android.widget.EditText;
import android.widget.TextView;
import android.widget.Toast;

public class MainActivity extends Activity {

    Player p1 = new Player("Hulk");
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        TextView p1view = (TextView) findViewById(R.textviews.mainview_player);
        p1view.setText(p1.getName());
    }

    public void btnClick_Name(View view) {

        if (view.getId() == R.buttons.B_EnterName) {
            EditText playersname = (EditText) findViewById(R.string.playerNameInput);
            Toast.makeText(this, "Your name: " + playersname.getText().toString(), Toast.LENGTH_SHORT).show();

        }

        setContentView(R.layout.game);
    }
} 
```

最后是 main.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
              android:orientation="vertical"
              android:layout_width="fill_parent"
              android:layout_height="fill_parent"
              android:gravity="center"
>
    <EditText
        android:id="@+string/playerNameInput"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:inputType="textMultiLine"
        android:lines="1"
        />

    <TextView
        android:id="@+textviews/mainview_player"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        />

    <Button
        android:id="@+buttons/B_EnterName"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:gravity="center"
        android:text="Save name and start game."
        android:onClick="btnClick_Name"
      />

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T18:41:23.863

当您第一次加载活动时，您正在调用此代码：

```
setContentView(R.layout.main);
TextView p1view = (TextView) findViewById(R.textviews.mainview_player);
p1view.setText(p1.getName()); 
```

然而，当用户单击按钮时，您只是调用此代码：

```
 setContentView(R.layout.game); 
```

因为您已重置主要内容视图，所以子视图 mainview_player 已被销毁并在从 R.layout.game 膨胀时替换为新视图。

您需要再次调用此代码以在游戏布局中找到新视图并使用您的玩家姓名填充它：

```
TextView p1view = (TextView) findViewById(R.textviews.mainview_player);
p1view.setText(p1.getName()); 
```

您最好了解活动之间的关系并为 R.layout.game 开始一项新活动

# c# - 一个选择/取消选择它们的复选框

> ID：15300839
> 
> 赞同：0
> 
> 时间：2013-03-08T18:29:37.443
> 
> 标签：c#, jquery, asp.net-mvc, html, razor

我想创建一个复选框，该复选框将具有“权力”来检查/取消选中列表中每个项目的复选框。

这是我现在构建的视图的一部分（请容忍错误的名称和约定）：

```
 <p>
        @using (Html.BeginForm("SendObj", "Manager"))
        {
            <p>
               Select / UnSelet All Items @Html.CheckBox("selectAll", true) 
            </p>
            <table id="objToSend">
                <tr>
                    <th>Obj Name</th>
                    <th>Number In Stock</th>
                    (...)
                </tr>
                @for (int i = 0; i < Model.Count(); i++)
                {
                    <tr>
                        <td>@Html.DisplayFor(x => x[i].m_OthObj.m_ObjName)</td>
                        <td>@Html.DisplayFor(x => x[i].m_NbInStock)@Html.HiddenFor(x => x[i].m_NbInStock)</td>
                        (...)
                    <div id="divChckBox">
                        <td>
                            @Html.CheckBoxFor(x => x[i].m_IsSelected)
                        </td>
                    </div>

                    </tr>
                }

            </table>
            <input type="submit" value="Send"/>
        }
    </p> 
```

至于“如何”，好吧，我搜索了一下，我尝试了这个 jquery 脚本，但无济于事：

```
 **** EDIT **** 
```

这是基于人们在下面发布的评论的新 jQuery。警报用于调试目的，并在需要时出现：

```
 <script type="text/javascript">
    $(document).ready(function() {
        alert("The document is ready");
        $("#selectAll").click(function() {
            alert("The case has been clicked");
            var chkValue = $(this).is(":checked");
            $("#divChckBox").attr("checked", "checked");
        });
    });
    </script> 
```

我不介意使用 jquery，远非如此，我只是不知道它是如何工作的。也许这就是为什么我的想法不起作用的原因。

谁能帮我吗？谢谢！

*** 编辑 ***

我将在此处添加渲染页面为复选框提供的内容：

```
<td><input checked="checked" class="chckBoxList" data-val="true" data-val-required="The m_IsSelected field is required." name="[0].m_IsSelected" type="checkbox" value="true" /><input name="[0].m_IsSelected" type="hidden" value="false" /></td> 
```

也许这会提供更多关于正在发生的事情的信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T18:53:13.380

**我的立场得到纠正：** CheckBoxFor 不允许类设置

在你的助手中

```
<div id="divChckBox">
  @Html.CheckBoxFor(x => x[i].m_IsSelected)
</div> 
```

然后按类使您的选择器组：

```
$("#divChckBox :checkbox").attr("checked", "checked"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T18:58:07.500

```
@Html.CheckBox("TheOneCheckBoxToRuleThemAll") 
```

将您当前的复选框代码更改为：

```
<td>@Html.CheckBoxFor(x => x[i].m_IsSelected, new{ @class = "checkGroup1"})</td> 
```

有史以来最简单的 Jquery（确保将其放入 document.ready 中，如图所示）：

```
 <script type="text/javascript">
    $(document).ready(function () {
         //alert("the document is ready"); 
         $("#TheOneCheckBoxToRuleThemAll").click(function () {
              //alert("inside my click event");
              var chkValue = $(this).is(":checked");
              $(".checkGroup1").prop("checked", chkValue);
          });
     });
  </script> 
```

编辑：

我之前的回答使用了 .attr() 属性。测试后，我遇到了各种各样的麻烦。在参考了[这篇 SO 帖子后](https://stackoverflow.com/questions/426258/how-do-i-check-a-checkbox-with-jquery-or-javascript)，我转而使用 .prop() 并且一切都神奇地开始正常运行。

*   [jQuery .Attr()](http://api.jquery.com/attr/)
*   [jQuery .Prop()](http://api.jquery.com/prop/)

编辑：

在我提供的示例中，您的复选框必须如下所示：

```
<input name='itdoesnotmatter' id='donotcare' class='checkGroup1' /> 
```

另外，不要使用我放在那里的那个愚蠢的名字，使用简单的名字，比如

```
@Html.CheckBox("MasterCheck") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T20:43:59.937

由于周围有很多评论和很多答案，这是我当前的代码（有效！）：

```
<script type="text/javascript">
    $(document).ready(function() {
        //alert("The document is ready");
        $("#selectAll").click(function() {
            //alert("The case has been clicked");
            var chkValue = $(this).is(":checked");
            $(".divChckBox").prop("checked", chkValue);
        });
    });
</script>
<p>
    @using (Html.BeginForm("SendObj", "Manager"))
    {
        <p>
            Select / UnSelet All Items @Html.CheckBox("selectAll", true) 
        </p>
        <table>
            <tr>
                <th>Card Name</th>
                <th>Number In Stock</th>
                (...)
            </tr>
            @for (int i = 0; i < Model.Count(); i++)
            {
                <tr>
                    <td>@Html.DisplayFor(x => x[i].m_OthObj.m_ObjName)</td>
                    <td>@Html.DisplayFor(x => x[i].m_NbInStock)@Html.HiddenFor(x => x[i].m_NbInStock)</td>
                    (...)
                    <td>
                        <input type="checkbox" name="itdoesnotmatter" class="divChckBox" checked="true"/>
                    </td>
                </tr>
            }

        </table>
        <input type="submit" value="Send"/>
    }
</p> 
```

现在每个复选框都被选中或不选中，具体取决于全选复选框的状态！谢谢大家。现在我需要解决在我的控制器中“取消链接”复选框结果的问题，因为有一个行为与此相关联。但这是另一个问题。

# ios - 在 iOS 应用程序中从 Junos Pulse 获取用户凭据

> ID：15300840
> 
> 赞同：2
> 
> 时间：2013-03-08T18:29:51.610
> 
> 标签：ios, api, vpn

我正在通过 Junos Pulse 在我的 iPad 中建立 VPN 连接，以进入我组织的内部网。谁能告诉我是否有任何 iOS api 或 SDK 可用于获取在 iOS 应用程序内的 Junos 脉冲中输入的用户凭据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-03-04T12:00:12.410

Junos Pulse（或现在的 Pulse Secure）有一个 AppConnect SDK，这直接来自他们的[指南](http://www.juniper.net/techpubs/software/pulse/guides/Junos_Pulse_AppConnect_Deployment_Guide.pdf)：

> AppConnect SDK 是由瞻博网络提供的一组 API 和库，允许移动应用程序开发人员直接打开与 Connect 安全网关的基于套接字的 SSL VPN 连接。从 Connect Secure Gateway 的角度来看，这些隧道反映了所有其他形式的 AppConnect 隧道。集成是在代码级别完成的。任何与 AppConnect SDK 集成的应用程序都需要重新编译并手动部署到最终用户。AppConnect SDK 最适合在不使用 MDM 解决方案的情况下部署的容器解决方案或内部应用程序。API 包括身份验证和连接管理功能。连接可以在单个设备上的多个应用程序之间共享。有关 AppConnect SDK 的更多详细信息，请联系您的瞻博网络销售代表。

不幸的是，正如您在最后一段中所读到的，它只能通过您所在组织的瞻博网络销售代表获得。

# sql-server-2008 - Oracle 11g 到 MSSQL2012 迁移后表中的数据未正确解析

> ID：15300841
> 
> 赞同：1
> 
> 时间：2013-03-08T18:30:05.637
> 
> 标签：sql-server-2008, oracle11g, sql-server-2012, database-migration

我们最近将数据库从 Oracle 11g 迁移到 SQL Server 2012 SP1。我们还将同一个数据库从 Oracle 11g 迁移到 SQL Server 2008 R2。

数据库从 Oracle 迁移到 SQL Server 2008 已成功执行；我们的应用程序可以毫无问题地利用该数据库。但是，我们在从 Oracle 迁移到 SQL Server 2012 SP1 时遇到了问题。

当从特定列（类型：VARCHAR(MAX)）检索数据时，在某些情况下，我们不会显示存储字符串的内容，而是只显示一个“/”。当我们查看存储在列中的数据时，一切都在那里。我们的应用程序使用和配置了 MSSQL11 驱动程序的 OBDC。

我们还观察到：

*   使用MSSQL10驱动时，varchar(max)列检索成功；

有什么我们可能需要改变才能完成这项工作吗？不要犹豫，询问更多信息。

谢谢！

# asp.net - ASP.Net 更改 IE10 的浏览器模式

> ID：15300842
> 
> 赞同：6
> 
> 时间：2013-03-08T18:30:06.063
> 
> 标签：asp.net, meta-tags, internet-explorer-10

在IE 10中，如果查看开发者工具，可以看到浏览器有两种模式：

*   浏览器模式
*   文档模式

通过添加以下标签：

```
<meta http-equiv="X-UA-Compatible" content="IE=9" /> 
```

一种是能够强制 IE10 以 IE9 文档标准呈现页面。

ASP.Net 有没有办法强制浏览器更改浏览器模式以使用 IE10 兼容性视图或任何更低版本？

我有一个似乎与 IE10 发生故障的应用程序，但在 IE10 兼容性和 IE 低版本浏览器模式下尝试该应用程序，该应用程序运行良好。

感谢任何帮助。

更新：

发布浏览器模式和文档模式的屏幕截图。

如果我添加了上面的元标记，我会得到：

![浏览器模式截图](../Images/453990eb80dc7b3c1014945a1685b7d2.png)

请注意，文档模式处于元标记中指定的 IE9 模式。

但我的应用程序需要将浏览器模式 (IE10) 更改为 IE10 兼容模式或更低。使用当前的 IE10 模式，会中断应用程序。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-08T18:35:25.613

您可以通过以下方式强制浏览器使用最新的：

```
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" /> 
```

如果您想使用较低版本，只需更改数字：

```
<meta http-equiv="X-UA-Compatible" content="IE=7" /> 
```

将为 IE 7 呈现。但您可以从发布的示例中了解这一点。不知道你还在问什么。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-22T14:50:15.200

> 我有一个似乎与 IE10 发生故障的应用程序，但在 IE10 兼容性 > 和 IE 较低版本的浏览器模式下尝试该应用程序，该应用程序运行良好。

我的应用程序在 IE10 上无法正常运行时遇到了类似的问题。我发现我的问题与无法识别最新 IE 的 ASP.NET 浏览器定义文件有关：

[来源： http: [//support.microsoft.com/kb/2600100](http://support.microsoft.com/kb/2600100) ]

> 默认情况下，ASP.NET 对用户代理字符串使用嗅探技术来检测浏览器。浏览器定义文件涵盖了一定范围的浏览器版本。但是，随着版本号的增加，ASP.NET 可能无法通过使用用户代理字符串来识别浏览器的新版本。在这种情况下，ASP.NET 可能会将这些版本作为未知浏览器处理。

## 修补程序链接：

.NET 2.0 SP 和 .NET 3.5 SP1：http: [//support.microsoft.com/kb/2600100](http://support.microsoft.com/kb/2600100)

.NET 4.0： http: [//support.microsoft.com/kb/2600088](http://support.microsoft.com/kb/2600088)

# php - 使用带有 XML 主体的 PHP 创建 SOAP 调用

> ID：15300843
> 
> 赞同：23
> 
> 时间：2013-03-08T18:30:08.603
> 
> 标签：php, soap

我正在尝试使用 PHP 调用 SOAP 方法。

这是我得到的代码：

```
$data = array('Acquirer' =>
  array(
    'Id' => 'MyId',
    'UserId' => 'MyUserId',
    'Password' => 'MyPassword'
  ));
$method = 'Echo';
$client = new SoapClient(NULL,
           array('location' => 'https://example.com/ExampleWebServiceDL/services/ExampleHandler', 
           'uri' => 'http://example.com/wsdl', 'trace' => 1));
$result = $client->$method($data); 
```

这是它创建的请求：

```
 <?xml version="1.0" encoding="UTF-8"?>
  <SOAP-ENV:Envelope SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/" xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns1="http://example.com/wsdl" xmlns:ns2="http://xml.apache.org/xml-soap" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <SOAP-ENV:Body>
      <ns1:Echo>
        <param0 xsi:type="ns2:Map">
          <item>
            <key xsi:type="xsd:string">Acquirer</key>
            <value xsi:type="ns2:Map">
              <item>
                <key xsi:type="xsd:string">Id</key>
                <value xsi:type="xsd:string">mcp</value>
              </item>
              <item>
                <key xsi:type="xsd:string">UserId</key>
                <value xsi:type="xsd:string">tst001</value>
              </item>
              <item>
                <key xsi:type="xsd:string">Password</key>
                <value xsi:type="xsd:string">test</value>
              </item>
            </value>
          </item>
        </param0>
      </ns1:Echo>
    </SOAP-ENV:Body>
  </SOAP-ENV:Envelope> 
```

这就是我*希望*请求的样子：

```
 <?xml version="1.0" encoding="UTF-8"?>
  <SOAP-ENV:Envelope SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/" xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/" xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns1="http://example.com/wsdl" xmlns:ns2="http://xml.apache.org/xml-soap" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <SOAP-ENV:Body>
      <Echo>
        <Acquirer>
          <Id>MyId</Id>
          <UserId>MyUserId</UserId>
          <Password>MyPassword</Password>
        </Acquirer>
      </Echo>
    </SOAP-ENV:Body>
  </SOAP-ENV:Envelope> 
```

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2013-03-12T14:15:01.067

有几种方法可以解决这个问题。最少的hackiest，几乎是您想要的：

```
$client = new SoapClient(
    null,
    array(
        'location' => 'https://example.com/ExampleWebServiceDL/services/ExampleHandler',
        'uri' => 'http://example.com/wsdl',
        'trace' => 1,
        'use' => SOAP_LITERAL,
    )
);
$params = new \SoapVar("<Acquirer><Id>MyId</Id><UserId>MyUserId</UserId><Password>MyPassword</Password></Acquirer>", XSD_ANYXML);
$result = $client->Echo($params); 
```

这将为您提供以下 XML：

```
<?xml version="1.0" encoding="UTF-8"?>
<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns1="http://example.com/wsdl">
    <SOAP-ENV:Body>
        <ns1:Echo>
            <Acquirer>
                <Id>MyId</Id>
                <UserId>MyUserId</UserId>
                <Password>MyPassword</Password>
            </Acquirer>
        </ns1:Echo>
    </SOAP-ENV:Body>
</SOAP-ENV:Envelope> 
```

这几乎正​​是您想要的，除了方法名称上的命名空间。我不知道这是否有问题。如果是这样，您可以进一步破解它。您可以`<Echo>`手动将标记放入 XML 字符串中，并通过添加`'style' => SOAP_DOCUMENT,`到 options 数组中让 SoapClient 不设置方法，如下所示：

```
$client = new SoapClient(
    null,
    array(
        'location' => 'https://example.com/ExampleWebServiceDL/services/ExampleHandler',
        'uri' => 'http://example.com/wsdl',
        'trace' => 1,
        'use' => SOAP_LITERAL,
        'style' => SOAP_DOCUMENT,
    )
);
$params = new \SoapVar("<Echo><Acquirer><Id>MyId</Id><UserId>MyUserId</UserId><Password>MyPassword</Password></Acquirer></Echo>", XSD_ANYXML);
$result = $client->MethodNameIsIgnored($params); 
```

这会产生以下请求 XML：

```
<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/">
    <SOAP-ENV:Body>
        <Echo>
            <Acquirer>
                <Id>MyId</Id>
                <UserId>MyUserId</UserId>
                <Password>MyPassword</Password>
            </Acquirer>
        </Echo>
    </SOAP-ENV:Body>
</SOAP-ENV:Envelope> 
```

Finally, if you want to play around with SoapVar and SoapParam objects, you can find a good reference in this comment in the PHP manual: [http://www.php.net/manual/en/soapvar.soapvar.php#104065](http://www.php.net/manual/en/soapvar.soapvar.php#104065). If you get that to work, please let me know, I failed miserably.

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-03-14T04:56:02.943

First off, you have to specify you wish to use Document Literal style:

```
$client = new SoapClient(NULL, array(
    'location' => 'https://example.com/path/to/service',
    'uri' => 'http://example.com/wsdl',
    'trace' => 1,
    'use' => SOAP_LITERAL)
); 
```

Then, you need to transform your data into a SoapVar; I've written a simple transform function:

```
function soapify(array $data)
{
        foreach ($data as &$value) {
                if (is_array($value)) {
                        $value = soapify($value);
                }
        }

        return new SoapVar($data, SOAP_ENC_OBJECT);
} 
```

Then, you apply this transform function onto your data:

```
$data = soapify(array(
    'Acquirer' => array(
        'Id' => 'MyId',
        'UserId' => 'MyUserId',
        'Password' => 'MyPassword',
    ),
)); 
```

Finally, you call the service passing the Data parameter:

```
$method = 'Echo';

$result = $client->$method(new SoapParam($data, 'Data')); 
```

# informatica-powercenter - 使用聚合器转换对字段进行分组并检查每个字段的所有值

> ID：15300844
> 
> 赞同：1
> 
> 时间：2013-03-08T18:30:09.463
> 
> 标签：informatica-powercenter, informatica

我有以下格式的来源：

```
field1(key)  field2  field3     field4
  111          1        1     randomstring
  111          2        1     randomstring
  111          3        1     randomstring   
  111          4        1     randomstring
  111          4        1     randomstring2
  111          1        2     randomstring
  ... 
```

每个字段 3 可以有任意数量的字段 2 和字段 4，并且字段 2 可能出现多次字段 4。

我想检查存在的每个 field3 的所有 field2 和 field4 值，并确定所有 field4 值是否相同。

我的第一个想法是尝试使用聚合器转换到 groupby field3，然后在 field4 上使用 groupby 执行额外的聚合，并比较每个之间的 Count()，但我不确定这是否可行，或者是最好的方法执行这个逻辑。

* * *

我想了解的是在 field3 上执行第一个 groupby 之后，我如何检查每个条目的所有字段。是否可以在某种意义上应用聚合函数 First() 来获取第一个值，然后作为输出发送以用于以下过滤器转换？

# php - 插入新数据时避免重复显示的值

> ID：15300848
> 
> 赞同：0
> 
> 时间：2013-03-08T18:30:19.250
> 
> 标签：php, mysql

我在表单中动态地添加记录，然后我应该插入数据或更新它。我使用 ON DUPLICATE KEY UPDATE 来执行任务。一切都很好，除了每次我插入新记录或更新现有记录时，它首先复制现有记录，然后进行插入或更新。我猜查询正在使用 HTML foreach 循环中已经显示的值。我怎样才能避免这个问题？

```
 <?php
        foreach ($data as $ov) {                   
  ?>      

  <tr class="dataRow" id="soRows">
    <td>
        <input type="text" name="tableService" value="<?=$ov['service_type']?>" /><input type="hidden" value="<?=$ov['id_service']?>" class="id_service" name="id_service[]"/></td>
    <td>
        <input type="text" name="tableProject" value="<?=$ov['project_name']?>" /><input type="hidden" value="<?=$ov['id_project']?>"  class="id_project" name="id_project[]"/></td>
    <td>
        <input type="text" name="tableQuantity[]" value="<?=$ov['quantity']?>" /></td>          
    <td>
        <input type="text" name="tablePus[]" value="<?=$ov['unit_price_no_tax']?>" /></td>
    <td>
        <input type="text" name="tablePuc[]" value="<?=$ov['unit_price']?>" /></td>    
    <td>
        <input name="tableTotal[]" value="<?=$ov['total_item_imp']?>" /></td>
    <td>
        <i style="cursor: pointer;" class="icon-remove deleteRow"></i></td>
  </tr>

 <?php
 }  
 ?>

    for ($i = 0; $i < count($_POST['id_service']); $i++){

    $servtype = $_POST['id_service'][$i];    
    $project = $_POST['id_project'][$i];
    $quantity = $_POST['tableQuantity'][$i];
    $pus = $_POST['tablePus'][$i];
    $puc = $_POST['tablePuc'][$i];
    $totalitem = $_POST['tableTotal'][$i];
    $result1 = $_POST['labelResult'];
    $result2 = $_POST['labelResult2'];
    $id = $_POST['id'];

    $query = "INSERT INTO sales_order_items (id_soitems, id_so, id_service, id_project, quantity, unit_price_no_tax, unit_price, total_item_imp)
    VALUES
    (null,
    :id,
    :servtype,
    :project,
    :quantity,
    :pus,
    :puc,
    :totalitem
    )
    ON DUPLICATE KEY UPDATE
    id_project = :project,
    id_service = :servtype,
            quantity = :quantity,
    unit_price_no_tax = :pus,
    unit_price = :puc,
    total_item_imp = :totalitem
    ";

    $stmt = $this->dbh->prepare($query);

    $stmt->bindValue(':id', $id, PDO::PARAM_INT);
    $stmt->bindValue(':servtype', $servtype, PDO::PARAM_INT);
    $stmt->bindValue(':project', $project, PDO::PARAM_INT);
    $stmt->bindValue(':quantity', $quantity, PDO::PARAM_STR);
    $stmt->bindValue(':pus', $pus, PDO::PARAM_STR);
    $stmt->bindValue(':puc', $puc, PDO::PARAM_STR);
    $stmt->bindValue(':totalitem', $totalitem, PDO::PARAM_STR);
    $stmt->bindValue(':result1', $result1, PDO::PARAM_STR);
    $stmt->bindValue(':result2', $result2, PDO::PARAM_STR);
    $stmt->execute();

    } 
```

# c++ - C ++程序接受多个输入并使用指针放入数组

> ID：15300850
> 
> 赞同：1
> 
> 时间：2013-03-08T18:30:27.673
> 
> 标签：c++

在这个问题中我面临一个问题：“编写一个 C++ 控制台程序，以在一行中接受来自键盘的五个整数值，用空格分隔。然后程序使用指针将这五个值存储在一个数组中。然后打印数组的元素屏幕 。”

我尝试创建一个字符串变量并接受来自用户的 5 个整数，然后将其转换为整数，但它不能很好地工作，因为它在空格之后不接受数字。

任何帮助家伙？

```
#include<iostream>
#include<string>
#include<sstream>

using namespace std;

int main(){
    string numbers;
    getline(cin, numbers);
    int arr[5];
    int *ptr;
    int values;
    stringstream convert(numbers);
    convert >> values;
    cout << values;

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T19:12:44.240

我成功做到了

```
#include<iostream>
#include<string>
#include<sstream>
using namespace std;

int main(){
int arr[5];
string number;
cout << "Please enter 5 integers separeted with spaces " << endl;
getline(cin, number);
int *ptr = arr ;
stringstream convert(number);
convert >> *ptr++ ;
convert >> *ptr++;
convert >> *ptr++;
convert >> *ptr++;
convert >> *ptr++;

for(  int i = 0; i < 5; ++i )
{
  cout << arr[i] << " " ;
}
cout << std::endl ;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T18:34:08.517

一次只需要一个，您需要添加更多调用来转换，如下所示：

```
 stringstream convert(numbers);
  convert >> values;
  cout << values;
  convert >> values;
  cout << " " << values;
  convert >> values;
  cout << " " << values; 
```

C++faq 对此有一个很好的[部分](http://www.parashift.com/c++-faq/convert-string-to-num.html)。

无需大的修改，如果你需要使用指针将数字直接放入数组中，你可以这样做：

```
int *ptr = arr ;

convert >> *ptr++ ;
convert >> *ptr++;
convert >> *ptr++;
convert >> *ptr++;
convert >> *ptr++;

for( unsigned int i = 0; i < 5; ++i )
{
  cout << arr[i] << " " ;
}
cout << std::endl ; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T18:37:29.483

`numbers.find_first_not_of(" ");`
我的 numbers 变量是字符串，您可以使用和第一个空格字符搜索第一个非空格字符，然后使用现在将 substr 放在另一个字符串变量中`numbers.find_first_of(" ");`
创建一个子集。现在将子字符串转换为 int。重复这些步骤所需的次数。即将整个代码放在一个while循环中。返回时终止循环`substr(.....)`

`numbers.find_first_of(" ");``numbers.end()`

# html - 图标字体在 Firefox 中不起作用

> ID：15300853
> 
> 赞同：0
> 
> 时间：2013-03-08T18:30:34.993
> 
> 标签：html, .htaccess, css, font-face, access-control

我正在尝试使用图标字体，到目前为止，它在除 Firefox 之外的所有浏览器中都能正常工作，我不明白为什么，它只是显示`data-icon`属性中的值而不是图标，任何人都可以解释为什么它在 firefox 中不起作用（最新)?

```
@font-face {
  font-family: 'icon-font';
  src: url('//bit.ly/ZxomPz') format('woff'),
       url('//bit.ly/WPGMJF') format('truetype'),
       url('//bit.ly/16eqBwn') format('eot'),
       url('//bit.ly/16eqLDZ') format('svg');
}

[data-icon]::before {
font-family: 'icon-font';
font-weight: 400 !important;
content: attr(data-icon);
text-transform: none;
margin-right: 3px;
position: relative;
top: 8px;
right: 5px;
font-size: 31px;
line-height: 0;
} 
```

```
<span data-icon="1" aria-hidden="true"></span> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T19:13:03.863

这是推荐的@font-face 声明。也许你可以尝试用这个例子重写你的。

```
@font-face {
    font-family: 'Lobster13Regular';
    src: url('/skins/default/media/fonts/lobster/Lobster_1.3-webfont.eot');
    src: url('/skins/default/media/fonts/lobster/Lobster_1.3-webfont.eot?#iefix') format('embedded-opentype'),
    url('/skins/default/media/fonts/lobster/Lobster_1.3-webfont.woff') format('woff'),
    url('/skins/default/media/fonts/lobster/Lobster_1.3-webfont.ttf') format('truetype'),
    url('/skins/default/media/fonts/lobster/Lobster_1.3-webfont.svg#Lobster13Regular') format('svg');
} 
```

此外，让您的服务器提供正确的“Mime 类型”(ttf|otf|eot|woff) 并允许外部资源的可访问性 (Access-Control-Allow-Origin "*")

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-12T20:11:19.717

我知道我迟到了，但这是一个对我有用的解决方案，我在答案中看不到它（除了@Milkyways patterns 的简短提及）。

使用以下信息创建一个`.htaccess`文件并将其保存在您的字体所在的同一文件夹中：

```
<FilesMatch ".(ttf|otf|eot|woff)$">
    <IfModule mod_headers.c>
        Header set Access-Control-Allow-Origin "*"
    </IfModule>
</FilesMatch> 
```

更多信息在这里：

*   火狐是因为火狐不允许跨域字体：[http ://red-team-design.com/firefox-doesnt-allow-cross-domain-fonts-by-default/](http://red-team-design.com/firefox-doesnt-allow-cross-domain-fonts-by-default/)

*   [http://alittlecode.com/font-awesome-icons-not-working-in-firefox-probable-cause-and-a-fix/](http://alittlecode.com/font-awesome-icons-not-working-in-firefox-probable-cause-and-a-fix/)

# javascript - Highcharts 如何在 PlotLines 中添加链接？

> ID：15300855
> 
> 赞同：0
> 
> 时间：2013-03-08T18:30:41.777
> 
> 标签：javascript, jquery, highcharts

我正在使用 PlotLines 处理 Highcharts。我想在 PlotLine 的标签内添加一个链接来做某事（例如删除或更新）。

```
 $(function () {
        $(document).ready(function() {

            var chart = new Highcharts.Chart({
                chart: {
                    renderTo: 'container',
                    type: 'column'
                },
                title: {
                    text: 'Add Link in PlotLines'
                },
                xAxis: {
                    categories: ['Africa', 'America', 'Asia'],
                },
                yAxis: {
                    plotLines:[{
                        value:450,
                        color: '#ff0000',
                        width:2,
                        zIndex:4,
                        id:'PlotLine1',
                        label:{text:'PlotLine 1 ' + '<a href="#" onClick="delete(PlotLine1);">Delete</a>'}               
                    },
                     {
                        value:200,
                        color: '#000055',
                        width:2,
                        id:'PlotLine2', 
                        zIndex:4,
                        label:{text:'PlotLine 2 ' + '<a href="#" onClick="delete(PlotLine2);">Delete</a>'}                
                    }]                
                },
                series: [{
                    name: 'Year 1800',
                    data: [107, 31, 50]
                },
                        {
                    name: 'Goal',
                            type: 'scatter',
                            marker: {
                        enabled: false
                    },
                    data: [450]
                }]
            });
        });

}); 
```

如果您看到 PlotLines 生成的源代码，您会看到如下内容：

```
<tspan onclick="location.href="#"" style="cursor: pointer;" dx="3">
      Delete
</tspan> 
```

我不知道是否有任何方法可以在标签中添加链接或按钮。来源在[http://jsfiddle.net/nDjdc/21/](http://jsfiddle.net/nDjdc/21/)

提前致谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T18:59:24.963

Highcharts 在渲染时似乎没有携带该`onClick`属性，但它确实携带了，`href`所以你可以这样做：

```
<a href="javascript: deleteMe('PlotLine1');">Delete</a> 
```

我从你的那里创造了一个工作小提琴。请看一下：http: [//jsfiddle.net/amyamy86/V82pQ/](http://jsfiddle.net/amyamy86/V82pQ/)

唯一需要注意的是它只能访问全局对象，所以我希望你适当地命名你的应用程序:)

Fyi`delete`不是变量的好名称，因为它是一个保留字。请参阅[https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Reserved_Words](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Reserved_Words)

# php - 脚本制作函数调用的PHP路径

> ID：15300856
> 
> 赞同：1
> 
> 时间：2013-03-08T18:30:45.593
> 
> 标签：php, dirname

我有一个帮助文件，基本上看起来像这样：

```
helper.php:
<?php
  function renderPartial($name) {
    return file_get_contents(__DIR__.'/'.$name.'.php');
  } 
```

我正在尝试从视图中调用该函数：

```
view.php:
<h2>Title</h2>
<?= renderPartial('_form') ?> 
```

_form.php 与 view.php 位于同一目录中，因此我想在该目录中进行搜索。__DIR__ 神奇常量返回 helper.php 的目录而不是 view.php。有什么方法可以包含这样的帮助文件并返回进行调用的文件的目录而不是定义函数的文件？我搜索了 PHP 文档，但找不到任何常量或辅助函数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T18:33:41.383

您可以将当前`__DIR__`作为参数传递

```
function renderPartial($name, $dir) {
    return file_get_contents($dir.'/'.$name.'.php');
} 
```

和

```
<?= renderPartial('_form', __DIR__) ?> 
```

# java - 第 K 个最小元素算法

> ID：15300861
> 
> 赞同：1
> 
> 时间：2013-03-08T18:31:14.977
> 
> 标签：java, arrays, quicksort

我正在编写一个算法，该算法通过划分和征服一个未排序的整数数组来找到第 k 个最小的元素。在测试我的程序时，我的一些输出出错了。这是代码：

```
public class kthsmallest {

public static final int MaxSize = 500;

public static int find_kth_smallest( int[] A, int n, int k )
{
         return quicksort(A, n, k, 0, n-1);
}  

public static int quicksort(int[] A, int n, int k, int low, int high){
int i = low;
int j = high;
int position = low + (high-low)/2;
int pivot = A[position];

while (i <= j){
    while(A[i] < pivot)
        i++;

    while(A[j] > pivot)
        j--;

    if (i <= j){
        int temp = A[i];
        A[i] =A[j];
        A[j] = temp;
        i++;
        j--;
    }
}

//
if (position + 1 > k){
    return quicksort(A, n, k, low, position-1);
} else if (position + 1 < k){
     return quicksort(A, n, k, position+1, high);
} else
    return A[position]; 
```

如果有人能看出这个算法有什么问题，请告诉我。我已经调试了几个小时。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T21:56:27.680

`1,2,3,20,4,5,6`输入和搜索第 6 个元素会出错。那是因为在这种情况下，您将不得不多次交换一个元素，而在我看来，您从不这样做。您将交换 20 和 6，但之后您将增加 i，因此将永远不会再交换 6，而您实际上应该这样做。6 是正确答案。我不确定你会找到什么值，但它不会是 6。

由于元素等于枢轴，也可能会发生一些问题。尝试为此类元素添加特殊检查。

# jquery - 从我的 chrome 扩展程序调用网络服务

> ID：15300862
> 
> 赞同：1
> 
> 时间：2013-03-08T18:31:17.037
> 
> 标签：jquery, google-chrome-extension

我有一个小的 chrome 扩展程序，它应该向我的网络服务报告浏览器正在访问的 url。关于如何将其发送回我的服务的任何想法？我尝试了一个标准的 JQuery $.get 方法，但由于跨域问题而失败。

有没有比这样做更聪明的方法？og有没有人有一个有效的样本

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-08T23:05:33.597

您`JQuery $.get`失败了，因为您必须明确告诉 Chrome 您的应用程序可以与哪些站点进行通信。

1.  打开你的`manifest.json`文件。
2.  将站点添加到`permissions`阵列中。查看[匹配模式](http://developer.chrome.com/extensions/match_patterns.html)。

如果您想允许与所有站点进行通信 - 您可以添加`"http://*/*", "https://*/*"`.

此外 - 如果您要发布到 Chrome 网上应用店 - 下载您的应用程序的任何人都将被告知您的应用程序被授予了哪些权限。

来源：[声明权限](http://developer.chrome.com/extensions/declare_permissions.html)，[匹配模式](http://developer.chrome.com/extensions/match_patterns.html)

# java - 如何将 KVP 列表映射到 Map > .. 快

> ID：15300863
> 
> 赞同：2
> 
> 时间：2013-03-08T18:31:17.253
> 
> 标签：java, performance, algorithm

我很快写了这个片段来完成这项工作

```
private void map() {
    for (KVPair kvPair : content) {
        String k = kvPair.getKey();
        String v = kvPair.getValue();

        if (mappedContent.containsKey(k)) {
            List<String> values = mappedContent.get(k);
            values.add(v);
        } else {
            List<String> values = new ArrayList<>();
            values.add(v);
            mappedContent.put(k, values);
        }
    }
} 
```

它可以工作，当使用 1k、2k、4k 和 8k 的随机数据运行时，我得到以下性能（平均 100,000 次运行）

```
Running with 1,000 pairs
  [perfRun] 100000 iterations took 3 seconds
  [perfRun] Run time: 3758786000 ns. 1 iteration takes 37 us
Running with 2,000 pairs
  [perfRun] 100000 iterations took 6 seconds
  [perfRun] Run time: 6675544000 ns. 1 iteration takes 66 us
Running with 4,000 pairs
  [perfRun] 100000 iterations took 13 seconds
  [perfRun] Run time: 13337145000 ns. 1 iteration takes 133 us
Running with 8,000 pairs
  [perfRun] 100000 iterations took 27 seconds
  [perfRun] Run time: 27109480000 ns. 1 iteration takes 271 us 
```

粗略地说，当大小翻倍时，时间翻倍。我会采用线性增长，但仍然想知道，我们能做得更好吗？是否可以使用恒定时间映射事物？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T18:35:08.573

我所看到`mappedContent.containsKey(k)`的，大致不需要的，您可以通过检查`BigO(n)`逃脱，`null`

```
for (KVPair kvPair : content) {
        String k = kvPair.getKey();
        String v = kvPair.getValue();
        List<String> values = mappedContent.get(k);
        if (values!=null) {
            values.add(v);
        } else {
            values = new ArrayList<>();
            values.add(v);
            mappedContent.put(k, values);
        }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T19:02:25.367

根据@Quoi的回答，不知道在空检查之后保存else块是否有区别

```
for (KVPair kvPair : content) {
    String k = kvPair.getKey();
    List<String> values = mappedContent.get(k);
    if (values == null) {
        values = new ArrayList<>();
        mappedContent.put(k, values);
    }
    values.add(kvPair.getValue());
} 
```

您还可以对列表可能会变得多大做出一些假设，因此您将该大小传递给列表构造函数并节省列表需要重新调整大小的时间。如果内存不是问题，您可以将`content.size() + 1`其作为列表的大小。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T18:40:17.650

除非你能改变底层的数据结构，否则你不能比线性时间做得更好。

考虑一下：您有一个包含*n 个*唯一条目的列表。要映射每个必须访问的一个。假设访问成本为 1。那么必须有*n*次访问。因此，正如您的基准测试所指出的那样，您的复杂性为 at *n* * 1 = *n或线性时间。*

现在，如果你有一个数据结构，可以共享数据但同时提供两个接口，那么你可以实现在两者之间切换的恒定时间。显然，您的静态类型与您的示例不同。

# r - 根据特定因子的输入顺序添加具有值的列

> ID：15300867
> 
> 赞同：0
> 
> 时间：2013-03-08T18:31:42.923
> 
> 标签：r, conditional-statements

我想向数据框中添加一列，其中列中的值基于另一列中特定因子的输入顺序。因此，特别是对于我的数据，我希望第一次访问某个点时使用“1”，第二次访问时使用“2”，第三次访问时使用“3”等。但是，有些点对于给定的访问有重复访问日期并且应该共享相同的访问号码。

数据框是预先排序的，看起来像这样：

```
 Transect Point    Date 
 1      BEN     1  5/7/12 
 2      BEN     1 5/10/12 
 3      BEN     1 5/10/12 
 4      BEN     2  5/8/12 
 5      BEN     2 5/11/12
 6      BEN     2 5/13/12 
```

我想得到这样的东西：

```
 Transect Point    Date  Vist
1      BEN     1  5/7/12     1
2      BEN     1 5/10/12     2
3      BEN     1 5/10/12     2
4      BEN     2  5/8/12     1  
5      BEN     2 5/11/12     2
6      BEN     2 5/13/12     3 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T18:35:43.777

假设您的 data.frame 称为 SODF，请使用`ave`：

```
within(SODF, {
  Visit <- ave(Point, Point, FUN = seq_along)
})
#   Transect Point    Date Visit
# 1      BEN     1  5/7/12     1
# 2      BEN     1 5/10/12     2
# 3      BEN     1 5/13/12     3
# 4      BEN     2  5/8/12     1
# 5      BEN     2 5/11/12     2 
```

如果您按多列分组，例如“横断面”和“点”，请将`ave`语句更改为：

```
ave(Point, Transect, Point, FUN = seq_along) 
```

* * *

当然，还有其他方法，使用基本 R 和使用包。@Arun 在[此处的回答](https://stackoverflow.com/a/15281528/1270695)中对其中一些进行了总结和基准测试。

* * *

# 更新以解决新的问题要求

考虑到您的新要求，想到的一个快速解决方案是首先提取唯一案例，执行上述索引生成，然后将结果表与原始表合并。

```
SODFunique <- SODF[!duplicated(SODF), ]
SODFunique <- within(SODFunique, {
  Visit <- ave(Point, Transect, Point, FUN = seq_along)
})
merge(SODF, SODFunique, sort = FALSE)
#   Transect Point    Date Visit
# 1      BEN     1  5/7/12     1
# 2      BEN     1 5/10/12     2
# 3      BEN     1 5/10/12     2
# 4      BEN     2  5/8/12     1
# 5      BEN     2 5/11/12     2
# 6      BEN     2 5/13/12     3 
```

# matlab - 计算中值图像时出错？

> ID：15300875
> 
> 赞同：0
> 
> 时间：2013-03-08T18:32:07.410
> 
> 标签：matlab, image-processing

```
image=imread('Tiger.jpg');
%figure,imshow(uint8(image)),title('Before applying Median Filter');

[rows, cols]=size(image);
B=zeros(rows, cols);

for rowNo=2:rows-1
    for colNo=2:cols-1
         K=image(rowNo-1:rowNo+1,colNo-1:colNo+1);

    B(rows,cols)=median(K);
   end
end

figure,imshow(uint8(B)),title('After applying Median Filter'); 
```

我想在不使用内置函数的情况下计算图像的中位数，但是我给了我错误，任何人都可以帮我解决错误

```
??? Subscripted assignment dimension mismatch.

Error in ==> Quest_2median at 18
    B(rows,cols)=median(K); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T20:32:50.893

下面的代码是一个更好的实现：

```
image=imread('../SampleImages/cat.jpg');
%figure,imshow(uint8(image)),title('Before applying Median Filter');
image = rgb2gray(image);
image = imnoise(image,'salt & pepper');
[rows, cols]=size(image);
B=zeros(rows, cols);

for rowNo=2:rows-1
    for colNo=2:cols-1
        K=image(rowNo-1:rowNo+1,colNo-1:colNo+1);
K = reshape (K,1,9);
B(rowNo,colNo)=median(K);
    end
end

figure,imshow(uint8(image)),title('Before applying Median Filter');
figure,imshow(uint8(B)),title('After applying Median Filter'); 
```

注意是中值函数需要一个向量，当你传递一个矩阵时，它会给出一个行向量，包括每列的中值。

# c++ - 如何安装和使用 Boost？

> ID：15300876
> 
> 赞同：1
> 
> 时间：2013-03-08T18:32:08.463
> 
> 标签：c++, boost

我是 C++ 新手，第一次尝试安装和使用 Boost 库。我正在尝试编译高分辨率时序示例：

```
#include <boost/timer/timer.hpp>
#include <cmath>

int main()
{
   boost::timer::auto_cpu_timer t;

   for (long i = 0; i < 100000000; ++i)
      std::sqrt(123.456L); // burn some time

   return 0;
} 
```

但是，当我尝试编译它时，我似乎并没有为 boost 库洗澡：

```
$ g++ -Wall -I ~/boost_1_53_0 boost_cpu_timer.cc
Undefined symbols for architecture x86_64:
    "boost::timer::auto_cpu_timer::auto_cpu_timer(short)", referenced from:
        _main in ccQSlF30.o
    "boost::timer::auto_cpu_timer::~auto_cpu_timer()", referenced from:
        _main in ccQSlF30.o
    "boost::system::generic_category()", referenced from:
        __static_initialization_and_destruction_0(int, int)in ccQSlF30.o
    "boost::system::system_category()", referenced from:
       __static_initialization_and_destruction_0(int, int)in ccQSlF30.o
ld: symbol(s) not found for architecture x86_64
collect2: ld returned 1 exit status 
```

我使用建议的命令安装了 boost：

```
$ tar xzfv boost_1_53_0.tar.bz2
$ cd boost_1_53_0
$ ./bootstrap.sh --prefix=/usr/local
$ sudo ./b2 --prefix=/usr/local install 
```

其中在/usr/local中安装了一些动态库，即$ ls /usr/local/lib/ ... libboost_timer.a
libboost_date_time.a
libboost_timer.dylib ...

但我仍然没有建立连接如何使用 boost 标头编译 C++ 代码，例如

```
#include <boost/timer/timer.hpp> 
```

任何帮助深表感谢。

# java - 将数据添加到 JSP 的显示表中

> ID：15300877
> 
> 赞同：0
> 
> 时间：2013-03-08T18:32:08.867
> 
> 标签：java, jquery, jsp

```
<display:table name="example" class="FORM">
            <display:setProperty name="paging.banner.placement" value="bottom" />
            <display:setProperty name="paging.banner.all_items_found" value=""/>
            <display:setProperty name="paging.banner.onepage" value=""/>
            <display:setProperty name="paging.banner.one_item_found" value=""/>
            <display:column property="userId" sortable="false" title="User ID" headerClass="sortable"/>
            <display:column property="dateAdded" sortable="false" title="Added Date" headerClass="sortable"/>
            <display:column property="statusDate" sortable="false" title="Status Date" headerClass="sortable"/>
            <display:column property="params" sortable="false" title="Parameters" headerClass="sortable"/>
            <display:column property="status" sortable="false" title="Status" headerClass="sortable"/>
        </display:table> 
```

所以我在我的 JSP 页面中有这个表。所有数据都是从一个 java 文件中的 ArrayList 设置的，如下所示：

```
ArrayList options = new ArrayList(); (Has data in it though....)
request.setAttribute("example", options); 
```

我怎样才能动态地添加到这个表中？信息来自 SQL 查询，我希望能够使用偏移量并添加新数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T12:28:58.847

如果您需要从 SQL 查询中动态添加更多数据，您可以进行 Ajax 查询，然后将新行添加到当前表中。

# google-maps-api-3 - 如何捕获 FusionTablesLayer 的右键单击事件？

> ID：15300878
> 
> 赞同：0
> 
> 时间：2013-03-08T18:32:08.923
> 
> 标签：google-maps-api-3, google-fusion-tables

按照谷歌的文档：

[https://developers.google.com/maps/documentation/javascript/reference#FusionTablesLayer](https://developers.google.com/maps/documentation/javascript/reference#FusionTablesLayer) [https://developers.google.com/maps/documentation/javascript/reference#FusionTablesMouseEvent](https://developers.google.com/maps/documentation/javascript/reference#FusionTablesMouseEvent)

似乎没有任何记录在案的方法可以像在 Map 对象上那样在 FutionTablesLayer 上捕获右键单击事件。有没有人想出如何捕获右键单击（或上下文菜单）事件？

即使以像素为单位获取 x/y 坐标也会很有帮助，因为我可以使用它们来查找 latlng 并以某种方式自己查询 FusionTable ......但看起来地图上的右键单击事件已被取消或被阻止触发。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T00:07:04.147

恐怕这是不可能的。

当您将图层的可点击选项设置为 false 时，地图会响应右键单击，但这对您没有多大帮助，因为 latLng 属性将包含地图上的点击坐标而不是标记的位置.

# html - 我想让一个谷歌文档成为一个可以放置代码的地方，该代码将在网页上自动更新

> ID：15300880
> 
> 赞同：1
> 
> 时间：2013-03-08T18:32:11.763
> 
> 标签：html, google-docs

例如，假设我的页面上有一张需要每周更改的图片。我不想进入代码并更改图片，而是想以某种方式在“发布到网络”的谷歌文档中引用特定单元格来代替我在代码中的图像，这样我就可以更改图像的名称在谷歌文档中，新图像将显示在我的网页上。我想做到这一点，这样我就可以让几个人（不会编码）能够从他们的计算机上更改图像。我知道这是可能的，但我什至不知道从哪里开始。任何人都知道如何设置这个？谢谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T18:43:21.117

一种方法是，当您使用时`File > Publish to the web`，Google Docs 将生成一个 iframe 嵌入代码，如下所示：

```
<iframe src="https://docs.google.com/document/d/abcdefghijklmnopqrstuvwxyzabcdefghijklmnopq/pub?embedded=true"></iframe> 
```

您可以将 iframe 插入到您的网页中。您可以选中“进行更改时自动重新发布”，这样您的用户只需要在需要更改图像时修改文档。

但是，我强烈建议**使用适当的 CMS 会更好**，或者至少构建一个粗略的身份验证和 CRUD 来更新图像。

# mongodb - 限制 MongoDB 中的结果但 仍然获得完整计数？

> ID：15300882
> 
> 赞同：43
> 
> 时间：2013-03-08T18:32:20.467
> 
> 标签：mongodb, count, limit

为了速度，我想将查询限制为 10 个结果

```
db.collection.find( ... ).limit(10) 
```

但是，我也想知道总数，所以说“有 124 个，但我只有 10 个”。有没有一种很好的有效方法来做到这一点？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2013-03-08T18:55:53.797

默认情况下，`count()`忽略`limit()`并计算整个查询中的结果。因此，例如，当您执行此操作时，`var a = db.collection.find(...).limit(10);` 运行`a.count()`将为您提供查询的总数。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2014-11-07T17:27:07.277

做count(1)包括limit和skip。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2016-09-04T21:06:12.833

@johnnycrab 接受的答案是针对 mongo CLI。

如果您必须在 Node.js 和 Express.js 中编写相同的代码，则必须像这样使用它才能使用“count”函数以及 toArray 的“result”。

```
var curFind = db.collection('tasks').find({query}); 
```

然后你可以像这样运行两个函数（一个嵌套在另一个函数中）

```
curFind.count(function (e, count) {

// Use count here

    curFind.skip(0).limit(10).toArray(function(err, result) {

    // Use result here and count here

    });

}); 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-03-08T18:54:46.383

`cursor.count()`应该忽略`cursor.skip()`并且`cursor.limit()`默认情况下。

来源：[http ://docs.mongodb.org/manual/reference/method/cursor.count/#cursor.count](http://docs.mongodb.org/manual/reference/method/cursor.count/#cursor.count)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-12-03T22:03:11.010

您可以使用[`$facet`](https://docs.mongodb.com/master/reference/operator/aggregation/facet/index.html)在同一阶段输入文档上处理多个聚合管道的阶段：

```
// { item: "a" }
// { item: "b" }
// { item: "c" }
db.collection.aggregate([
  { $facet: {
    limit: [{ $limit: 2 }],
    total: [{ $count: "count" }]
  }},
  { $set: { total: { $first: "$total.count" } } }
])
// { limit: [{ item: "a" }, { item: "b" }], total: 3 } 
```

这样，在同一个查询中，您可以获得一些文档 ( `limit: [{ $limit: 2 }]`) 和文档总数 ( `{ $count: "count" }`)。

最后一个`$set`阶段是一个可选的清理步骤，只是在那里投射`$count`阶段的结果，这样`"total" : [ { "count" : 3 } ]`就变成了`total: 3`.

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2017-02-09T17:46:12.820

有一个使用推送和切片的解决方案：[https ://stackoverflow.com/a/39784851/4752635](https://stackoverflow.com/a/39784851/4752635)

我更喜欢

1.  首先进行过滤，然后按 ID 分组以获取过滤元素的数量。不要在这里过滤，没有必要。
2.  第二个查询，过滤、排序和分页。

推送 $$ROOT 并使用 $slice 的解决方案遇到了 16MB 的大型集合的文档内存限制。此外，对于大型集合，两个查询一起运行似乎比使用 $$ROOT 推送的查询运行得更快。您也可以并行运行它们，因此您只受到两个查询中较慢的查询（可能是排序的那个）的限制。

我已经使用 2 个查询和聚合框架解决了这个解决方案（注意 - 我在这个例子中使用了 node.js，但想法是一样的）：

```
var aggregation = [
  {
    // If you can match fields at the begining, match as many as early as possible.
    $match: {...}
  },
  {
    // Projection.
    $project: {...}
  },
  {
    // Some things you can match only after projection or grouping, so do it now.
    $match: {...}
  }
];

// Copy filtering elements from the pipeline - this is the same for both counting number of fileter elements and for pagination queries.
var aggregationPaginated = aggregation.slice(0);

// Count filtered elements.
aggregation.push(
  {
    $group: {
      _id: null,
      count: { $sum: 1 }
    }
  }
);

// Sort in pagination query.
aggregationPaginated.push(
  {
    $sort: sorting
  }
);

// Paginate.
aggregationPaginated.push(
  {
    $limit: skip + length
  },
  {
    $skip: skip
  }
);

// I use mongoose.

// Get total count.
model.count(function(errCount, totalCount) {
  // Count filtered.
  model.aggregate(aggregation)
  .allowDiskUse(true)
  .exec(
  function(errFind, documents) {
    if (errFind) {
      // Errors.
      res.status(503);
      return res.json({
        'success': false,
        'response': 'err_counting'
      });
    }
    else {
      // Number of filtered elements.
      var numFiltered = documents[0].count;

      // Filter, sort and pagiante.
      model.request.aggregate(aggregationPaginated)
      .allowDiskUse(true)
      .exec(
        function(errFindP, documentsP) {
          if (errFindP) {
            // Errors.
            res.status(503);
            return res.json({
              'success': false,
              'response': 'err_pagination'
            });
          }
          else {
            return res.json({
              'success': true,
              'recordsTotal': totalCount,
              'recordsFiltered': numFiltered,
              'response': documentsP
            });
          }
      });
    }
  });
}); 
```

# symfony - 使用 QueryBuilder 的多个 WHERE

> ID：15300884
> 
> 赞同：18
> 
> 时间：2013-03-08T18:32:23.230
> 
> 标签：symfony, doctrine-orm, query-builder

使用以下内容时，仅将最后一个`where`添加到我的查询中；

```
$qb = $this->getEntityManager()->createQueryBuilder();

$qb->select(array('qi'))
    ->from('Table:Qi', 'qi')
    ->where("qi.content = " . $content->getId())
    ->where("qi.queue = " . $child->getQueue()->getId()); 
```

我必须这样做才能注意到两者

```
$qb->select(array('qi'))
    ->from('Table:Qi', 'qi')
    ->where("qi.content = " . $content->getId() . 
                 " AND qi.queue = " . $child->getQueue()->getId()); 
```

这似乎不对？如何使用第一种方法进行多次`where`调用？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-03-08T18:35:01.813

你可以`->andWhere`这样使用：

```
->where("qi.content = " . $content->getId())
->andWhere("qi.queue = " . $child->getQueue()->getId()); 
```

# mercurial - 如何使用 Mercurial Queues 同时处理多个补丁？

> ID：15300885
> 
> 赞同：1
> 
> 时间：2013-03-08T18:32:36.253
> 
> 标签：mercurial, patch, mercurial-queue

可以说，我有 2 个错误要修复：bug1 和 bug2。

我从 bug1 开始，在修复它的过程中，我去 bug2 并修复了一半。

我返回 bug1 并再次部分修复它并再次转到 bug2。

像这样，经过多次切换，我完成了两个错误的修复。

审查这两个错误的人是不同的，他们不想与他们不关心的错误有任何关系。所以，我需要为他们提供不同的补丁。

如果我使用 plain `hg diff`，我会这样做：

`hg diff -U 7 -p file1 -r OLD_REVISION_NUMBER > patch1`对于 bug1，和

`hg diff -U 7 -p file2 -r OLD_REVISION_NUMBER > patch2`对于错误2

如何使用 Mercurial Queues 做同样的事情？请建议一个基本的工作流程。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T20:18:42.780

这是一个非常简化的工作流程，假设两个补丁不重叠，即两个补丁不修改相同的文件。

```
$ hg init myrepo
$ cd myrepo
$ echo "This is file1" >file1
$ echo "This is file2" >file2
$ hg add
adding file1
adding file2
$ hg commit -m 'initial files'

#  Initialize and work on patch1

$ hg qnew -m 'Fix for bug1' patch1
$ echo "a second line" >>file1
$ hg diff
diff --git a/file1 b/file1
--- a/file1
+++ b/file1
@@ -1,1 +1,1 @@
-This is file1
+a second line
$ hg qdiff
diff --git a/file1 b/file1
--- a/file1
+++ b/file1
@@ -1,1 +1,1 @@
-This is file1
+a second line

#  Update the current patch (patch1)

$ hg qrefresh
$ hg diff
$ hg qdiff
diff --git a/file1 b/file1
--- a/file1
+++ b/file1
@@ -1,1 +1,1 @@
-This is file1
+a second line

#   Initialize and work on patch2

$ hg qnew -m 'Fix for bug2' patch2
$ hg qseries
patch1
patch2
$ hg qtop
patch2
$ hg diff
$ echo 'another line for file2' >>file2
$ hg diff
diff --git a/file2 b/file2
--- a/file2
+++ b/file2
@@ -1,1 +1,2 @@
 This is file2
+another line for file2
$ hg qrefresh
$ hg diff
$ hg qdiff
diff --git a/file2 b/file2
--- a/file2
+++ b/file2
@@ -1,1 +1,2 @@
 This is file2
+another line for file2

#  Export patch2

$ hg export qtip
# HG changeset patch
# User My Name <myemail>
# Date 1362771912 28800
# Node ID 2baa2bf81b000d4d720f9c4151242458b90bcd80
# Parent  ccd75363c8f459bec4a8d6b94dfb4150fb9e3014
Fix for bug2

diff --git a/file2 b/file2
--- a/file2
+++ b/file2
@@ -1,1 +1,2 @@
 This is file2
+another line for file2

#  Pop back to and export patch1

$ hg qpop
popping patch2
now at: patch1
$ hg export qtip
# HG changeset patch
# User My Name <myemail>
# Date 1362771745 28800
# Node ID ccd75363c8f459bec4a8d6b94dfb4150fb9e3014
# Parent  a227e9c42f2d17fb28082ad2451a03d4926505ba
Fix for bug1

diff --git a/file1 b/file1
--- a/file1
+++ b/file1
@@ -1,1 +1,1 @@
-This is file1
+a second line

#  Resume working on patch2

$ hg qpush
applying patch2
now at: patch2
...

#  Apply patch1 to repo

$ hg qpop
popping patch2
now at: patch1
$ hg qfinish -a
$ hg qseries
patch2
$ hg summary
parent: 1:ccd75363c8f4 tip
 Fix for bug1
branch: default
commit: (clean)
update: (current)
mq:     1 unapplied
$ hg qpush
applying patch2
now at: patch2 
```

请记住，Mercurial 队列旨在管理有序的补丁列表，其中系列中的后续补丁可能会修改早期补丁所做的更改。如果您正在处理的项目涉及对同一组文件进行并行开发，那么 MQ 可能不是最好的工具。在这种情况下，请考虑使用带有或不带有书签的 Mercurial 分支或 Mercurial 匿名头像。

# c# - 同时运行两个winform窗口

> ID：15300887
> 
> 赞同：21
> 
> 时间：2013-03-08T18:32:37.887
> 
> 标签：c#, multithreading, winforms

我有两个 C# winform (.NET 4.0) 表单，每个表单都连续运行单独但相似的自动化任务。分开是因为它们是不同的流程/工作流，但它们的操作方式足够相似以在项目中共享相同的资源（方法、数据模型、程序集等）。

两种形式都是完整的，但现在我不确定如何运行程序，以便每个窗口在启动时打开并独立运行。该程序在部署时将“永远在线”。

这可能看起来有点基础，但我的大部分开发经验都是 Web 应用程序。线程/等对我来说还是有点陌生​​。我已经研究过，但我发现的大多数答案都与用户交互和顺序用例有关——这只是一个系统不断运行两个不同的进程，它们需要独立地与世界交互。

我发现的潜在解决方案可能涉及多线程，或者某种 MDI，或者一些人建议使用 DockPanelSuite（虽然在超级企业环境中，下载第三方文件说起来容易做起来难）。

```
static class Program
{
    /// <summary>
    /// The main entry point for the application.
    /// </summary>
    [STAThread]
    static void Main()
    {
        Application.EnableVisualStyles();
        Application.SetCompatibleTextRenderingDefault(false);

        // Rather than specifying frmOne or frmTwo,
        // load both winforms and keep them running.
        Application.Run(new frmOne());
    }
} 
```

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2013-03-08T18:45:30.773

您可以创建一个新`ApplicationContext`的来表示多个表单：

```
public class MultiFormContext : ApplicationContext
{
    private int openForms;
    public MultiFormContext(params Form[] forms)
    {
        openForms = forms.Length;

        foreach (var form in forms)
        {
            form.FormClosed += (s, args) =>
            {
                //When we have closed the last of the "starting" forms, 
                //end the program.
                if (Interlocked.Decrement(ref openForms) == 0)
                    ExitThread();
            };

            form.Show();
        }
    }
} 
```

使用它，您现在可以编写：

```
Application.EnableVisualStyles();
Application.SetCompatibleTextRenderingDefault(false);
Application.Run(new MultiFormContext(new Form1(), new Form2())); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-03-08T18:44:37.897

如果你真的需要两个窗口/窗体在两个单独的 UI 线程上运行，你可以这样做：

```
static class Program
{
    [STAThread]
    static void Main()
    {
        Application.EnableVisualStyles();
        Application.SetCompatibleTextRenderingDefault(false);

        var thread = new Thread(ThreadStart);
        // allow UI with ApartmentState.STA though [STAThread] above should give that to you
        thread.TrySetApartmentState(ApartmentState.STA); 
        thread.Start(); 

        Application.Run(new frmOne());
    }

    private static void ThreadStart()
    {
        Application.Run(new frmTwo()); // <-- other form started on its own UI thread
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-08T19:09:04.933

## 假设

您*不需要*这两个不同的进程，您只使用这两个进程，因为您希望拥有两种不同的表单，并且希望能够保持应用程序运行，直到两个表单都退出。

## 另一种解决方案

依靠`Form.Closed`事件机制。您可以添加一个事件处理程序，它允许您指定表单关闭时要执行的操作。**例如，当两者都**退出应用程序**表单都关闭**

 **## 就一些代码而言

```
 public Form1()
    {
        InitializeComponent();

        _form2 = new Form2();
        _form2.Show(this);

        this.Closed += Form1Closed;
        _form2.Closed += Form2Closed;
    }

    protected override void OnFormClosing(FormClosingEventArgs e)
    {
        e.Cancel = true;
        Hide();
        Form1Closed(this, new EventArgs());
        base.OnFormClosing(e);
    }

    private void Form1Closed(object sender, EventArgs eventArgs)
    {
        form1IsClosed = true;

        TryExitApplication();
    }

    private void Form2Closed(object sender, EventArgs eventArgs)
    {
        _form2IsClosed = true;

        TryExitApplication();
    }

    private void TryExitApplication()
    {
        if (form1IsClosed && _form2IsClosed)
        {
            Dispose();
            Application.Exit();
        }
    } 
```

请注意，这应该被重构以使其成为更好的解决方案。

* * *

**更新**

Servy提供的评论使我修改了这个“应该是简单的解决方案”，指出他的解决方案比这个解决方案要好得多。由于支持我留下答案，因此我将使用此答案，我还将解决在寻求此解决方案时开始出现的问题：

*   取消关闭事件
*   从一个事件重新路由到另一个事件
*   强制调用`Dispose`。
*   正如Servy指出的那样：维护不友好（检查哪个表单已关闭的状态）**

# javascript - 如何获得正确的 $.ajax 数据类型

> ID：15300890
> 
> 赞同：0
> 
> 时间：2013-03-08T18:32:58.580
> 
> 标签：javascript, jquery, ajax

你能帮忙吗？我有以下 javascript：

```
$('form').click(function (e)
           {
            if (e.target.getAttribute('id') === 'SubmitAddLevel')
            {
                var parent = $('#' + e.target.getAttribute('attr')),
                var Data = [];
                parent.find('.input').children().each(function (i, e)
                {
                  Data.push(e.getAttribute('id') + ":" + e.value);
                    console.log(Data);
                });                

                $.ajax({
                    type: "POST",
                    url: 'AjaxControls.aspx/CreateUserLevel',
                    //data: Data, //.join(','),
                    dataType: "text",
                    contentType: "application/json; charset=utf-8",
                    //error: function (er) { alert(er); },
                    success: function (response)
                    {

                        if (response.d === "true")
                        {

                            $("#ErrorDivAddLevel").html('Level created successfully!').fadeIn('slow');
                        }
                        else
                        {
                            $("#SuccessDivAddLevel").html('Level creation failed!').fadeIn('slow');
                        }
                    },

                });
            } 
```

我在控制台上得到的“数据”的结果是：["LevelNameAddLevel:Admin", "PriviledgeIDAddLevels:|1|2|3|4|5|6|7|"]。如何将其转换为 ajax 将传递给我的 web menthod 的内容？

这是网络方法

```
<WebMethod(EnableSession:=True)>
 Public Shared Function CreateUserLevel(userLevel As String, userPriviledges As String) As String

 return "true"

end function 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T19:05:15.337

我认为您的数据应该看起来更像这样：

```
[{"LevelNameAddLevel":"Admin"}, {"PriviledgeIDAddLevels":"|1|2|3|4|5|6|7|"}] 
```

所以你在数组中有键/值对。在请求中，您应该能够通过请求中的键获取数据。但我不太确定这应该是什么意思：“|1|2|3|4|5|6|7|”

# python - 如何使用 django-tagging-0.3.1 在标签名称中允许空格？

> ID：15300891
> 
> 赞同：1
> 
> 时间：2013-03-08T18:33:00.450
> 
> 标签：python, django, tagging, django-tagging

我正在使用[django-tagging-0.3.1](https://github.com/selwyn/codeshare/tree/master/thirdparty/django-tagging-0.3.1)包来标记我网站中的所有文章。但是我刚刚发现这个包似乎不支持标签名称中的空格，这意味着当标签名称中有空格并且您使用它提供的功能时`TaggedItem.objects.get_by_model`，搜索所有带有该标签的文章，您将得到一个空列表. 但实际上我检查了我的服务器，标签名称已正确显示并与相应的文章相关联。那么有什么方法可以配置以使包含空间的标签搜索工作？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T19:03:01.503

问题似乎出在由[`get_tag_list`](https://github.com/selwyn/codeshare/blob/master/thirdparty/django-tagging-0.3.1/tagging/utils.py#L142)调用的实用程序函数中`get_by_model`。如果传递一个字符串（例如`'my tag with spaces'`），它将返回以下查询：

```
Tag.objects.filter(name__in=parse_tag_input(tags)) 
```

不幸的是，该[`parse_tag_input`](https://github.com/selwyn/codeshare/blob/master/thirdparty/django-tagging-0.3.1/tagging/utils.py#L18)函数**假定以空格分隔的单词是不同的标签**，因此它会断言您正在搜索标签`['my', 'tag', 'with', 'spaces']`，这当然不会返回任何内容。

稍后在`get_tag_list`函数中，检查输入是否为列表/元组：

```
elif isinstance(tags, (types.ListType, types.TupleType)):
    ... 
```

它后面的代码**不调用 parse_tag_input**（我猜它[假设列表/元组中的每个字符串都是一个完整的标签](https://github.com/selwyn/codeshare/blob/master/thirdparty/django-tagging-0.3.1/tagging/utils.py#L182)）。

**TL;DR：** 因此，我相信如果您传递包含标签名称的元组或列表，它会正确找到它。

```
TaggedItem.object.get_by_model(MyModel, ['my tag with spaces']) 
```

# c++ - C++ 实例化一个类

> ID：15300892
> 
> 赞同：2
> 
> 时间：2013-03-08T18:33:02.107
> 
> 标签：c++

```
#include <iostream>

class Base
{
    public:
        int id;
};

int main()
{
    Base b();
    b.id = 1; 
} 
```

上面代码中的对象创建有什么问题？`Base b()`和 和有什么不一样`Base b`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T18:33:57.923

这

```
Base b(); 
```

`b()`被解析为返回`Base`对象的被调用函数的函数声明。你需要这个：

```
Base b; 
```

这将实例化一个`Base`对象并调用其默认构造函数。请注意，这不会将初始化归零`base::id`。您可以通过提供执行此操作的默认构造函数来解决此问题：

```
class Base
{
    public:
        Base() : id(0) {}
        int id;
}; 
```

并以相同的方式实例化：

```
Base b; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-08T18:34:13.087

问题是您**没有**实例化一个对象，而是*声明一个函数*。这：

```
Base b(); // Function declaration! (not what you want) 
```

声明一个`b()`返回类型对象`Base`且不接受任何参数的函数。因此，当您稍后尝试访问成员`id`时，编译器会发出错误，因为函数没有成员：

```
b.id = 1; // ERROR! b is a function, accessing member "id" makes no sense 
```

如果要创建 的实例`Base`，只需删除括号：

```
Base b; // Object instantiation! (what you want) 
```

请注意，在 C++11 中，您可以使用*统一初始化*语法几乎按照您尝试的方式创建类的实例，但使用大括号而不是括号：

```
Base b{}; // Object instantiation! (what you want, in C++11) 
```

# c# - netpeertcpbinding 是否支持请求/回复

> ID：15300893
> 
> 赞同：2
> 
> 时间：2013-03-08T18:33:05.077
> 
> 标签：c#, wcf, wcf-binding

我有一个 WCF p2p 网状网络，对于单向对话运行良好。我正在调查是否可以调用一个方法来添加两个数字并返回和总和。

但是，尝试连接时出现错误：

**合同需要请求/回复，但绑定“NetPeerTcpBinding”不支持它或未正确配置以支持它。**

**C# 连接**

```
private void button1_Click(object sender, EventArgs e)
{
   try
   {
      // Construct InstanceContext to handle messages on callback interface. 
      // An instance of ChatApp is created and passed to the InstanceContext.
      InstanceContext instanceContext = new InstanceContext(new ChatApp(radTextBoxusername.Text, this));

      // Create the participant with the given endpoint configuration
      // Each participant opens a duplex channel to the mesh
      // participant is an instance of the chat application that has opened a channel to the mesh
      factory = new DuplexChannelFactory<IChatChannel>(instanceContext, "ChatEndpoint");
      participant = factory.CreateChannel();

      // Retrieve the PeerNode associated with the participant and register for online/offline events
      // PeerNode represents a node in the mesh. Mesh is the named collection of connected nodes.

      IOnlineStatus ostat = participant.GetProperty<IOnlineStatus>();
      ostat.Online += new EventHandler(OnOnline);
      ostat.Offline += new EventHandler(OnOffline);

      try
      {
         participant.Open();
      }

      catch (CommunicationException)
      {
         radListViewChats.Text = radListViewChats.Text + ("Could not find resolver.  If you are using a custom resolver, please ensure");
         radListViewChats.Text = radListViewChats.Text + ("that the service is running before executing this sample.  Refer to the readme");
         radListViewChats.Text = radListViewChats.Text + ("for more details.");
         return;
      }

      radListViewChats.Text = radListViewChats.Text +("You are connected: " + radTextBoxusername.Text);

      // Announce self to other participants
      participant.Join(radTextBoxusername.Text);

      }

      catch (Exception ex)
      {
         radListViewChats.Text = radListViewChats.Text + ex.Message.ToString();
         MessageBox.Show(ex.Message.ToString());
      }
    } 
```

**C#代码添加2个数字**

```
public int Add(int number1, int number2)
{
   try
   {
      return number1 + number2;
   }

   catch (Exception ex)
   {
      form.SetLogText(ex.Message.ToString());
      return -1;
   }
} 
```

**我聊天**

```
namespace Client
{
    // Chat service contract
    // Applying [PeerBehavior] attribute on the service contract enables retrieval of PeerNode from IClientChannel.
    [ServiceContract(Namespace = "http://Microsoft.ServiceModel.Samples", CallbackContract = typeof(IChat))]
    public interface IChat
    {
        [OperationContract(IsOneWay = true)]
        void Join(string member);

        [OperationContract(IsOneWay = true)]
        void Chat(string member, string msg);

        [OperationContract(IsOneWay = true)]
        void Leave(string member);

        [OperationContract(IsOneWay = false)]
        int Add(int number1, int number2);
    }

    public interface IChatChannel : IChat, IClientChannel
    { }
} 
```

**查普应用**

```
public class ChatApp : IChat
{    
    // member id for this instance
    string member;
    Form1 form;

    public ChatApp(string member, Form1 form)
    {
        this.member = member;
        this.form = form;
    }

    //IChat implementation
    public void Join(string member)
    {
        form.SetLogText(member + " joined");
    }

    public void Chat(string member, string msg)
    {
        try
        {               
           //Comment out this if statement if you wish to echo chats from the same member
           if (member != this.member)
           {
               form.SetLogText(msg);
           }
        }

        catch (Exception ex)
        {
           form.SetLogText(ex.Message.ToString());
        }
    }

    public int Add(int number1, int number2)
    {
       try
       {
            return number1 + number2;
       }

       catch (Exception ex)
       {
          form.SetLogText(ex.Message.ToString());
          return -1;
       }

    }

    public void Leave(string member)
    {
        form.SetLogText(member + " left the chat");
    }
} 
```

**应用程序配置**

```
<?xml version="1.0"?>
<configuration>

  <system.serviceModel>

    <client>
      <!-- chat instance participating in the mesh -->
      <endpoint name="ChatEndpoint" address="net.p2p://chatMesh/ServiceModelSamples/Chattest" binding="netPeerTcpBinding" bindingConfiguration="BindingCustomResolver" contract="Client.IChat">
      </endpoint>

    </client>

    <bindings>
      <netPeerTcpBinding>
        <!-- Refer to Peer channel security samples on how to configure netPeerTcpBinding for security -->
        <binding name="BindingCustomResolver" port="0">
          <security mode="None"/>
          <resolver mode="Custom">
            <custom address="net.tcp://localhost/servicemodelsamples/peerResolverService" binding="netTcpBinding" bindingConfiguration="Binding3"/>
          </resolver>
        </binding>
      </netPeerTcpBinding>

      <netTcpBinding>
        <!-- You can change security mode to enable security -->
        <binding name="Binding3">
          <security mode="None"/>
        </binding>
      </netTcpBinding>
    </bindings>

  </system.serviceModel>

  <startup>
    <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.0"/>
  </startup>
</configuration> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T20:07:34.027

看来这篇文章的答案是否定的

[WCF](http://paradise-coding.blogspot.ie/2012/05/wcf-request-reply-operations.html)

# c# - File.CopyTo 错误

> ID：15300895
> 
> 赞同：2
> 
> 时间：2013-03-08T18:33:15.183
> 
> 标签：c#

我有一个 C# 程序，它根据密钥号查询远程数据库中的图像文件。当它找到匹配项时，它会在本地（在运行程序的服务器上）定位文件并将其复制到临时本地目录，从该目录在用户的浏览器中提供图像。但是，我收到一个指向程序的 file.CopyTo 行的 COM 错误。该程序确实成功找到了文件并将其复制到临时目录，因此它实际上可以工作，但由于某种原因，它显然没有收到成功消息或其他什么，因此它在将文件名返回给模块之前停止这将在浏览器中提供它。如果这太模糊，我很抱歉。下面是错误，然后我把它指向的代码行。真的没有太多要补充的，因为它显然具备成功所需的条件，但似乎并不承认这一点。让我知道是否需要发布更多无论如何...

* * *

## “/Indus”应用程序中的服务器错误。

DB-0039 复制文件时出错。说明：执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。

> 异常详细信息：System.Runtime.InteropServices.COMException：DB-0039 复制文件时出错。

源错误：

> 在执行当前 Web 请求期间生成了未处理的异常。可以使用下面的异常堆栈跟踪来识别有关异常起源和位置的信息。

堆栈跟踪：

> [COMException (0x80004005): DB-0039 复制文件时出错。] XtenderSolutions.interop.AEXDBLib.IObjectFile.CopyTo(Object FileName) +0 ip_axdb.AXNetConnect.GetAXDocuments(String FieldValue) 在 C:\IndusAXProject2013\IP_AXDb\ AXDB\AXNetConnect.cs:67
> IP_EDMSforVentyx._Default.Page_Load(Object sender, EventArgs e) in C:\IndusAXProject2013\IP_EDMSforVentyx\EDMSforVentyx_Default.cs:21
> System.Web.Util.CalliHelper.EventArgFunctionCaller(IntPtr fp, Object o, Object t , EventArgs e) +14
> System.Web.Util.CalliEventHandlerDelegateProxy.Callback(Object sender, EventArgs e) +35 System.Web.UI.Control.OnLoad(EventArgs e) +91
> System.Web.UI.Control.LoadRecursive() +74
> System.Web.UI.Page.ProcessRequestMain（布尔includeStagesBeforeAsyncPoint，布尔includeStagesAfterAsyncPoint）+2207

* * *

这行代码很简单：

```
file.CopyTo(filepath + filename); 
```

这是其中的一部分：

```
for (int j = 1; j <= ((int) pages.Count); j++)
{
    PAGE page = (PAGE) pages[j];
    PageVersions versions = (PageVersions) page.Versions;
    int num4 = 0;
    num4 = (int) versions.Count;
    if (num4 < 1)
    {
        break;
    }

    PAGEVERSION pageversion = (PAGEVERSION) versions[num4];
    ObjectFile file = (ObjectFile) app.FileObject;
    filename = i.ToString() + "_" + j.ToString() + ".tif";
    file.ObjectId = pageversion.ObjectId;
    file.PathId = (pageversion.PathId);
    file.GenerateNewFileName();
    file.CopyTo(filepath + filename);
    if (IsJpegHeader(filepath, filename))
    {
        this.DeleteImgFile(filepath, filename);
        file.CopyTo(filepath + (i.ToString() + "_" + j.ToString() + ".jpg"));
    }
} 
```

无论如何，如果有人有任何想法，谢谢。

# c - C 编程 2D 数组 malloc：每一行之后的有趣值。寻求解释

> ID：15300901
> 
> 赞同：1
> 
> 时间：2013-03-08T18:33:34.943
> 
> 标签：c, malloc, 2d, internal

在问这个问题之前，我提到[了这个](https://stackoverflow.com/questions/2842135/c-programming-malloc-for-a-2d-array-using-pointer-to-pointer)、[这个](https://stackoverflow.com/questions/3144132/malloc-in-c-but-use-multi-dimensional-array-syntax?rq=1) 和[这个SO 帖子：](https://stackoverflow.com/questions/2248737/dynamic-allocation-malloc-of-contiguous-block-of-memory)

在向朋友教授动态内存分配时，我编写了一个简单的程序，其代码片段如下：

```
matrix = (int**) malloc (sizeof(int*) * m);
for (i = 0; i < m; ++i)
matrix[i] = (int*) malloc (sizeof(int) * n);

for (i = 0; i < m; ++i)
  for (j = 0; j < n; ++j)
      matrix[i][j] = rand() % 100; /*some random value*/

for (i = 0; i < m; ++i)
{
  for (j = 0; j < n; ++j)
  {
      printf("(%8u)%-5d", &matrix[i][j], matrix[i][j]);
  }

  /* Print element just after the first row*/
  printf("(%8u)%-5d", matrix[i] + n, *(matrix[i] + n));

  /* Print second NEXT element just after the first row*/
  printf("(%8u)%-5d", matrix[i] + n + 1, *(matrix[i] + n + 1));
} 
```

当我运行这个程序时

```
unmesh@unmesh-laptop:~/teaching/C/Day3$ ./matrix
Enter number of rows: 3
Enter number of columns: 3

(141189144)1    (141189148)2    (141189152)3    **(141189156)17**   (141189160)2    

(141189160)2    (141189164)3    (141189168)4    **(141189172)17**   (141189176)3    

(141189176)3    (141189180)4    (141189184)5    (141189188)135105(141189192)0 
```

我对 17 的值很好奇。如果我没记错的话，在这个调用中有三个 malloc 调用，所以内存可能不是可以观察到的连续的。但是我使用**m=n=4 或 m=n=5**运行程序，然后我可以在每行之后看到值**25 。**对于**m=n=6 和 m=n=7** ，观察到值**33 。**

更有趣的是，当 n 为奇数时（n=3 / n=5 ..），该值会在行结束后立即存储。m=n=3 时的示例行

```
Values  1        2       3       17  
Address 100      104    108     112  

Next row starts from 116 
```

当 n 为偶数时，存储在 m=n=2 时的 4 字节示例行之后

```
Values  1        2       0       17  
Address 100      104    108     112  

Next row starts from 116 
```

问题是这些值 17/25/33 来自哪里？为什么它们总是一样的？我希望它们不是垃圾，并且必须具有某种意义..我无法推断。请帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T18:46:16.943

您会看到内部簿记信息 malloc 存储以跟踪已分配的块。此信息的精确性质和大小因系统而异，但通常情况下 malloc 会将请求的大小四舍五入，以便在结合其簿记信息时，生成的块是通常所需的最大对齐的倍数你的机器。在您的情况下，对齐看起来像是 8 个字节（两个整数），导致您看到的偶数/奇数行为。您看到的 17/25/33 值可能是已分配块的大小（包括填充和大小信息），其中最低位设置为指示正在使用的块。

# mysql - CAP_FIRST 函数给出语法错误

> ID：15300902
> 
> 赞同：3
> 
> 时间：2013-03-08T18:33:36.150
> 
> 标签：mysql

我发现这个函数用于将字符串中单词的第一个字母大写，但是当我尝试在 PHPMyadmin 中的 SQL 中运行它时，它在第 8 行给了我一个语法错误。谁能帮我解决问题是什么？这是代码：

```
CREATE FUNCTION CAP_FIRST (input VARCHAR(255))

RETURNS VARCHAR(255)

DETERMINISTIC

BEGIN
DECLARE len INT;
DECLARE i INT;

SET len   = CHAR_LENGTH(input);
SET input = LOWER(input);
SET i = 0;

WHILE (i < len) DO
    IF (MID(input,i,1) = ' ' OR i = 0) THEN
        IF (i < len) THEN
            SET input = CONCAT(
                LEFT(input,i),
                UPPER(MID(input,i + 1,1)),
                RIGHT(input,len - i - 1)
            );
        END IF;
    END IF;
    SET i = i + 1;
END WHILE;

RETURN input;
END; 
```

这就是错误：MySQL 说：文档 #1064 - 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 8 行的 '' 附近使用正确的语法

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-08T18:46:23.170

定界符向数据库引擎发出语句结束的信号。通常是`;`. 但这将首先结束存储过程`;`。它的定义是不完整的。

您可以更改分隔符并将其添加到程序的末尾。之后将分隔符改回`;`

```
delimiter |
CREATE FUNCTION CAP_FIRST (input VARCHAR(255))
...
END;
|
delimiter ; 
```

# scala - 为协变集合添加 `to[Col[_]]` 方法

> ID：15300906
> 
> 赞同：6
> 
> 时间：2013-03-08T18:33:45.663
> 
> 标签：scala, collections, covariance

我正在实现一个数据结构。虽然它没有直接混入 Scala 的任何标准集合特征，但我想包含一个`to[Col[_]]`方法，给定一个构建器工厂，它可以生成标准 Scala 集合。

现在假设这个，复制自`GenTraversableOnce`：

```
trait Foo[+A] {
  def to[Col[_]](implicit cbf: CanBuildFrom[Nothing, A, Col[A]]): Col[A]
} 
```

这失败了`error: covariant type A occurs in invariant position`。

那么如何才能[`GenTraversableOnce`](https://github.com/scala/scala/blob/v2.10.0/src/library/scala/collection/GenTraversableOnce.scala#L1)做到这一点呢？我可以在源代码中看到，他们添加了一个`annotation.unchecked.uncheckedVariance`...

这看起来像一个肮脏的把戏。如果打字机正常拒绝这个，这怎么能安全并用 关闭`uncheckedVariance`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T20:29:05.887

方差检查是类型检查中非常重要的一部分，跳过它很容易导致运行时类型错误。在这里，我可以通过打印来演示填充了无效运行时值的类型。不过，我还不能让它因类型转换异常而崩溃。

```
import collection.generic.CanBuildFrom
import collection.mutable.Builder
import scala.annotation.unchecked.uncheckedVariance

trait Foo[+A] {
  def toCol[Col[_]](implicit cbf: CanBuildFrom[Nothing, A, Col[A @uncheckedVariance]]): Col[A @uncheckedVariance]
}

object NoStrings extends Foo[String] {
  override def toCol[Col[_]](implicit cbf: CanBuildFrom[Nothing, String, Col[String]]): Col[String] = {
    val res : Col[String] = cbf().result
    println("Printing a Col[String]: ")
    println(res)
    res
  }
}

case class ExactlyOne[T](t : T)

implicit def buildExactlyOne = new CanBuildFrom[Nothing, Any, ExactlyOne[Any]] {
  def apply() = new Builder[Any, ExactlyOne[Any]]  { 
    def result = ExactlyOne({}) 
    def clear = {}
    def +=(x : Any) = this
  }
  def apply(n : Nothing) = n
}

val noStrings : Foo[Any] = NoStrings
noStrings.toCol[ExactlyOne] 
```

这里`println(res)`有`res : Col[String]`印刷品`ExactlyOne(())`。但是，`ExactlyOne(())`没有类型`Col[String]`，表明类型错误。

为了在尊重方差规则的同时解决问题，我们可以将不变代码移出特征并仅保留协变部分，同时使用隐式转换将协变特征转换为不变辅助类：

```
import collection.generic.CanBuildFrom

trait Foo[+A] {
  def to[R](implicit cbf: CanBuildFrom[Nothing, A, R]): R
}

class EnrichedFoo[A](foo : Foo[A]) {
  def toCol[Col[_]](implicit cbf: CanBuildFrom[Nothing, A, Col[A]]): Col[A] = 
    foo.to[Col[A]]
}

implicit def enrich[A](foo : Foo[A]) = new EnrichedFoo(foo)

case class Bar[A](elem: A) extends Foo[A] {
  def to[R](implicit cbf: CanBuildFrom[Nothing, A, R]): R = {
    val b = cbf()
    b += elem
    b.result()
  }
}

val bar1 = Bar(3)
println(bar1.toCol[Vector]) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-08T18:56:51.743

我阅读了@axel22 提到的另一个问题的链接。不过，它似乎仍然不是真正的原因（允许`GenTraversableOnce`对变体和不变集合都起作用——它在 中*是*协变的`A`）。

例如，以下内容在不强制键入器的情况下正常工作：

```
import collection.generic.CanBuildFrom

trait Foo[+A] {
  def to[A1 >: A, Col[_]](implicit cbf: CanBuildFrom[Nothing, A1, Col[A1]]): Col[A1]
}

case class Bar[A](elem: A) extends Foo[A] {
  def to[A1 >: A, Col[_]](implicit cbf: CanBuildFrom[Nothing, A1, Col[A1]]): Col[A1]= {
    val b = cbf()
    b += elem
    b.result()
  }
} 
```

在我看来，这将是正确的签名。但是当然，它变得丑陋：

```
val b = Bar(33)
b.to[Int, Vector] 
```

因此，我对使用的解释仅仅是为了避免在签名`@uncheckedVariance`中重复元素类型（作为上限） 。`to`

但是，如果我们可以想象一个由于忽略方差而导致运行时错误的情况，那仍然没有答案？

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-08T18:45:35.953

可以，因为它使用`@uncheckedVariance`注解绕过类型系统并忽略方差检查。

简单地`import scala.annotation.unchecked.uncheckedVariance`注释您希望禁用方差检查的类型：

```
def to[Col[_]](implicit cbf: CanBuildFrom[Nothing, A, Col[A @uncheckedVariance]]): Col[A @uncheckedVariance] 
```

[在相关答案中](https://stackoverflow.com/questions/2454281/when-is-uncheckedvariance-needed-in-scala-and-why-is-it-used-in-generictravers)查看更完整的解释。

# regex - 排除正则表达式中的确切短语

> ID：15300908
> 
> 赞同：0
> 
> 时间：2013-03-08T18:33:57.493
> 
> 标签：regex, phrase

这是我的代码的一部分，用于在 p、span、a 和其他一些标签中找到“1”，也在“{changenumber}”和“{/changenumber}”之间的任何地方，然后用“2”替换它：

查找代码：

```
(((<(p|span|a|li|ul|br|/br|tr|td)[^>]*>)|(\{changenumber\}))[^<|(\{/changenumber\})]*)1(.*(<|(\{/changenumber\}))) 
```

和替换代码：

```
\12\7 
```

但有一个问题它排除在`[^<|(\{/changenumber\})]`这个短语的所有字符中：`"{","c","h","a"`等

我尝试`\b\{/changenumber\}\b`但`(?!...)`我做不到！

它怎么能排除确切的短语“ `{changenumber}`”？！

* * *

以更简单的方式：

当我们写 [^abc]+ 它排除“a”和“b”和“c”但是如果我们希望它排除确切的“abc”怎么办？！

[^(abc)]+ 不起作用

[^\babc\b]+ 不起作用

(?!abc) 不起作用

(?!\babc\b) 不起作用

...

* * *

它的语言是英语

我使用正则表达式，因为它是在 joomla 的替换组件中替换的方式

没门？！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-05T08:45:53.880

> 当我们写 [^abc]+ 它排除“a”和“b”和“c”但是如果我们希望它排除确切的“abc”怎么办？！
> 
> [^(abc)]+ 不起作用
> 
> [^\babc\b]+ 不起作用
> 
> (?!abc) 不起作用

那是错误的；负前瞻工作；如果它似乎没有，则使用错误。

> 但是有一个问题：它排除`[^<|(\{/changenumber\})]`了这个短语的所有字符——“{”、“c”、“h”、“a”等。

代替

```
[^<|(\{/changenumber\})] 
```

写

```
((?!\{/changenumber\})[^<]) 
```

— 即，将前瞻放在否定集的前面。

此外，您应该`.*`通过将其替换为非贪婪`.*?`。

# android - 将我的应用程序转换为片段：如何处理活动？

> ID：15300909
> 
> 赞同：1
> 
> 时间：2013-03-08T18:33:57.440
> 
> 标签：android, android-layout, android-fragments

我打算将现有的 android 应用程序转换为片段布局。

这个想法是拥有经典的两个面板布局（左侧的项目列表，右侧的详细信息）。

实际上，该应用程序由 4 个活动组成：

1.  具有所有可用选项的 ChoiceListActivity
2.  3 种不同的活动，针对工具上可用的每个操作进行一项。

现在我开始进行转换并创建了一个 FragmentActivity 类，这是主类：

```
 public class MainFragment extends FragmentActivity {

    private static final String TAG = "MainFragment";

    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.fragment_main);
        if(findViewById(R.id.fragment_container)!=null){
            Log.i(TAG, "No Tablet");
            Intent i = new Intent(MainFragment.this, main.ChoiceActivity.class);
            startActivity(i);
        } else {
            Log.i(TAG, "Tablet");
        }
    }
} 
```

我创建了一个 ChoiceListFragment：`

```
public class ChoiceListFragment extends ListFragment {

    @Override
    public void onListItemClick(ListView l, View v, int position, long id) {
        Toast.makeText(getActivity(), getListView().getItemAtPosition(position).toString(), Toast.LENGTH_LONG).show();
        super.onListItemClick(l, v, position, id);
    }

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);     
    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {
        String[] options = getResources().getStringArray(R.array.listitems);
        ArrayAdapter<String> adapter = new ArrayAdapter<String>(inflater.getContext(), R.layout.list_item, options);
        setListAdapter(adapter);
        return super.onCreateView(inflater, container, savedInstanceState);
    }

} 
```

该片段将位于面板的左侧。

我的问题是右侧。这个想法是，对于列表的每个元素，将显示相应的活动（或片段？）。

那么正确的方法是什么？

1.  当用户选择一个项目时，在正确的片段中启动一个活动是个好主意吗？

2.  或者我必须以编程方式在片段之间切换？以及如何做到这一点（我找到了很多教程，但他们总是使用相同的活动来更改右侧面板中的一些数据）？

我为正确的片段创建了以下类（但我不确定我做对了）：

```
public class RightFragment extends Fragment {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {        
        return inflater.inflate(R.layout.main, container, false);
    }

} 
```

我注意到我最终可以在 onCreate 方法期间使用 LayoutInflater 对象更改布局，但这只是在屏幕上切换布局，布局中声明的对象未初始化（也未添加 eventListener 等）。那么该怎么做呢？

也许我应该创建一个 Intent 并使用 startActivity 来启动现有的活动，或者这是一个片段的坏主意？

实际上xml布局是：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="horizontal" >

    <fragment
        android:id="@+id/choicelist_fragment"
        android:name="main.fragments.ChoiceListFragment"
        android:layout_width="0dp"
        android:layout_height="match_parent"
        android:layout_weight="1" />

    <fragment
        android:id="@+id/right_fragment"
        android:name="main.fragments.RightFragment"
        android:layout_width="0dp"
        android:layout_height="match_parent"
        android:layout_weight="2" />

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T23:28:20.370

好的，我找到了自己的解决方案，一开始还不清楚，但是阅读了一些文档，查看了许多教程，也许我了解它是如何工作的。

首先，我从布局中删除了第二个片段 *right_fragment*（检查问题），我用一个名为 *activity_container* 的空 FrameLayout 替换它，这将是我的片段的容器。

背后的想法是简单地使用 FragmentManager 来替换容器内的片段。

所以我将*onListItemClick*方法更新到 ChoiceListFragment 中，并根据所点击的列表项创建一个新的 Fragment 并将其替换为 *activity_container*。更新的方法类似于以下：

```
public void onListItemClick(ListView l, View v, int position, long id) {            
        String itemName = getListView().getItemAtPosition(position).toString();
        switch(position){
        case OPTION_ONE:                getFragmentManager().beginTransaction().replace(R.id.activity_container, new OptionOneFragment()).commit();
            break;
        case RESISTOR_VALUE:
            getFragmentManager().beginTransaction().replace(R.id.activity_container, new OptionTwoFragment()).commit();
            break;
        default:
            Toast.makeText(getActivity(), getListView().getItemAtPosition(position).toString(), Toast.LENGTH_LONG).show();
            break;
        }       
        super.onListItemClick(l, v, position, id);
    } 
```

这样，应用程序的每个组件都有自己的片段，由不同的类处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T18:42:13.240

你在正确的轨道上。在小屏幕上，单击列表项会启动 DetailActivity，它是 DetailFragment 的简单包装器。在更大的屏幕上，单击列表项会将右侧替换为 DetailFragment 的新实例。

如果您使用 eclipse 和 ADT，我建议您查看 MasterDetailFlow 模板，可以通过创建新的 Android 项目或新的 Android Activity 来访问该模板。

# ruby - （跨平台）不使用路径名库检查文件路径是否绝对

> ID：15300919
> 
> 赞同：2
> 
> 时间：2013-03-08T18:34:32.760
> 
> 标签：ruby, file, cross-platform

我需要一种跨平台的方式来检查给定的文件路径是否是绝对的*，而不*使用`Pathname`库。我希望为此依赖的唯一库是`File`. 它需要跨平台和跨实现，因此无论是 Ruby MRI、JRuby、Rubinius 等，它都应该可以工作。

我希望使用纯 Ruby，而不是 C 或 Java。我想不出一个健壮的方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-08T20:24:12.303

```
def absolute_path?(path)
  File.expand_path(path) == path
end 
```

# java - Java Files.copy 完全替换现有的删除文件

> ID：15300921
> 
> 赞同：7
> 
> 时间：2013-03-08T18:34:36.977
> 
> 标签：java, file-io

我有一些代码旨在通过覆盖主文件和覆盖可访问网络位置上的写保护副本来打开本地主文件、进行添加和保存文件。这是通过将修改后的文件保存到临时文件然后复制其他两个文件来完成的。

```
String tempFileName= "File.tmp";
String fileName= "File.xlsm";
String serverPath="\\\\network path\\";
File serverFile = new File(serverPath+fileName);

Files.copy(Paths.get(tempFileName),Paths.get(fileName),
   StandardCopyOption.COPY_ATTRIBUTES,StandardCopyOption.REPLACE_EXISTING);

if(serverFile.exists()){serverFile.setWritable(true, false);}

Files.copy(Paths.get(tempFileName),Paths.get(serverPath+fileName),
   StandardCopyOption.COPY_ATTRIBUTES,StandardCopyOption.REPLACE_EXISTING);

serverFile.setWritable(false,false);

Files.delete(Paths.get(tempFileName)); 
```

此代码在大多数情况下运行良好，但有时代码成功完成，无一例外，但网络位置文件已删除。本地主文件已正确保存和更新，但应该存在于网络上的文件却消失了。

使这更加困难的是，我无法在任何受控情况下重现此问题。因此，我向您询问有关文件复制/覆盖操作如何发生这种情况的任何指导。

谢谢

更新：

我有预感并检查了服务器文件路径的网络访问日志。当且仅当文件被创建者以外的用户访问但并非所有时间都在访问文件时，才会删除文件。同样，这是以只读方式访问的，因此打开文件的用户不应影响覆盖新版本，而且大多数情况下不会。深入挖掘似乎偶尔当且仅当文件被另一个用户打开并且java试图覆盖文件时抛出AccessDenied Exception并删除文件。

我相信这一定是 setWritable() 或 Files.copy （或组合）中的一个错误，因为在任何情况下都不应该删除该文件，并且 isWritable() 每次都返回 true。我尝试了其他设置/取消设置只读权限的方法，但结果为空。我现有的解决方法只是捕获异常并循环，直到文件被删除并且新副本就位。这可行，但实际上是一个黑客，所以如果有人有更好的解决方案/建议，我欢迎他们。

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2013-07-08T16:03:29.237

请参阅[FileLock 如何工作？](https://stackoverflow.com/questions/4025721/java-file-locking)，您可以执行以下操作：

1.  等待文件可用
2.  锁定文件
3.  覆盖/删除/其他
4.  解锁（如果适用）

这应该可以防止其他用户在修改文件的过程中进行访问。

# vb.net - 新建 Word 文档时如何立即停止

> ID：15300922
> 
> 赞同：1
> 
> 时间：2013-03-08T18:34:39.263
> 
> 标签：vb.net, visual-studio-2010, vba, word-2007

我有一个创建 Word 2007 文件的 VS2010 Vb.net 程序。

我的 Normal.dot 文件经过定制，为我提供了一个带有按钮的新选项卡，当按下这些按钮时，该选项卡通过 Normal.dot 程序中的 VBA 执行特定操作。

这一切都很好，但是，我现在想添加一些功能，而一旦创建了新的 Word 文档，它就会在 Outlook 中编辑一个任务。

我已经编辑了 2 个“本文档”程序，您可以在随附的屏幕截图中看到我的 Normal.Dot 文件。

![我的 Normal.Dot 模板](../Images/abf5e8498246316330e96a5ec74c3547.png)

当我运行我的 VB.Net 程序来创建一个全新的 Word 2007 文档时，该程序不会在任何一个消息框上停止，它只是继续并像以前一样打开 Word 文档，我的代码如下，我做错了什么？！？

```
 'Open or Create Word document for Editing

    myNewsLetter = myFolder + myLeague + "News" + mySession + ".doc"

    If File.Exists(myNewsLetter) Then
        'do nothing
    Else
        myTemplate = myTempFolder + "NL Skeleton.doc"
        File.Copy(myTemplate, myNewsLetter)
        Create_Blank_Newsletter()
    End If

    'Open Word Newsletter, or switch to it if it's already open

    Dim myFileOpen As Boolean

    myFileOpen = IsFileOpen(myNewsLetter)

    If myFileOpen = False Then
        MSDoc = MSWord.Documents.Open(myNewsLetter)
    End If

    MSWord.WindowState = Word.WdWindowState.wdWindowStateNormal
    MSWord.Visible = True
    MSWord.ActiveDocument.Bookmarks("\StartOfDoc").Select() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T14:47:38.610

好的，排序了，完整的讨论可以在这里找到... [http://www.vbaexpress.com/forum/showthread.php?p=286771#post286771](http://www.vbaexpress.com/forum/showthread.php?p=286771#post286771)

基本上，我不是在创建新文档，而是通过副本创建一个新文档，然后打开该现有文档！！！

# javascript - 无法访问全局变量

> ID：15300932
> 
> 赞同：-3
> 
> 时间：2013-03-08T18:35:04.540
> 
> 标签：javascript

我正在尝试访问 中的全局变量`testGlob1`，但是我无法这样做：

```
var displayVar;

function globVariable(){
    displayVar="2";
}

function testGlob1(){
    alert(displayVar);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T18:38:09.010

您没有显示如何为变量赋值。加载文档时是否调用 globVariable()？我相信这会奏效：

```
var displayVar=2;

function testGlob1(){
   alert(displayVar);   
} 
```

# sed - 如何通过 sed 摆脱与时间戳不匹配的行？

> ID：15300937
> 
> 赞同：0
> 
> 时间：2013-03-08T18:35:22.777
> 
> 标签：sed, grep

我不确定为什么`sed`在这个特定情况下没有按预期工作。我有以下形式的行：

`12:42:46.675 token`

我希望时间戳总是具有这种格式。不幸的是，文件中时不时有一些不以时间戳开头的行，我想摆脱这些行。我尝试过滤掉与上述内容不匹配的所有内容：

`sed -n /^\d{2}:\d{2}:\d{2}.\d{3}/p`

但即使我提供`sed`了`-r`选项，上述内容也会过滤掉所有内容。这样做的正确方法是什么`sed`？还有其他选择`grep`吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T18:42:39.697

用于仅显示以`grep`时间戳格式开头的行：

```
grep -E '^([0-9]{2}:){2}[0-9]{2}\.[0-9]{3} ' file 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T18:38:51.633

`Sed`不接受`\d`，`[0-9]`改用。两者`{`和`}`都不是元字符，它们是字面意思的，`sed`因此您需要为特殊行为转义它们，结果如下：

```
sed -n '/^[0-9]\{2\}:[0-9]\{2\}:[0-9]\{2\}.[0-9]\{3\}/p' infile 
```

**编辑**：还要将引号之间的表达式括起来（单引号比双引号更好）以避免外壳扩展。

# php - 在 php 中回显函数是不好的做法吗？

> ID：15300942
> 
> 赞同：0
> 
> 时间：2013-03-08T18:35:34.393
> 
> 标签：php

使用 php 中的函数回显一堆 HTML 并使其具有如下内容是不好的做法：

```
function my_function() {
global $post;
$custom_fields = get_post_custom();
$some_field = $custom_fields ['some_field'][0];
?>

<div class="something <?php if ($some_field) { echo $special-clas;} ?>">
<div class="something-else">
/* bunch more of html code */
</div>
</div>
} 
```

然后在你想用它来回显它的页面中？

```
<html>
<body>
.....
....

<?php echo my_function(); ?>

.... 
```

我不确定回显函数有多“被接受”？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-08T18:38:38.780

考虑两个函数：

```
function does_return() {
   return 'foo';
}

function does_echo() {
   echo 'bar';
}

does_return();      // nothing displayed
echo does_return(); // 'foo' displayed

does_echo();        // 'bar' displayed
echo does_echo();   // 'bar' displayed 
```

在这两种情况下，都可以执行输出，但发生方式不同。由于`does_return()`它本身没有任何代码在其定义中执行输出，因此输出取决于调用代码，例如`echo`您执行的代码。

使用`does_echo()`，您如何调用函数（带或不带回声）都没有关系，因为函数本身会输出。你会得到`bar`不管。

现在考虑一下：

```
function this_is_fun();
    echo 'foo';
    return 'bar';
}

this_is_fun();       // outputs 'foo'
echo this_is_fun();  // outputs 'foobar'; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-08T18:48:02.743

这是不好的做法，因为它使您的代码难以维护。

使用这样的功能，您可以混合逻辑和表示。因此，当您在输出中看到不喜欢的内容时，您无法确定先去哪里进行更改。你是去页面代码还是功能代码？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-08T18:36:38.707

我不明白这是多么糟糕的做法。只要您重用该功能，那么您似乎就以正确的方式使用它。

你唯一不应该做的就是使用`global`; 而是传递`$post`给函数。[请参阅此答案](https://stackoverflow.com/questions/5166087/php-global-in-functions)以了解原因。

由于您的函数已经有输出，因此您不需要`echo`.

```
my_function( $post ); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-08T18:37:38.760

函数应该返回数据，然后您的应用程序按照您的意愿处理它，无论是将其分配给变量还是回显它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-08T18:37:10.087

没关系。我宁愿看到 PHP 完全混合到 HTML 中。

`<?= my_function() ?>`如果您想编写更少的代码，您可以使用它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-08T18:38:41.107

@DaveRandom 在他的评论中说了什么。除此之外，不，这不一定是坏习惯。它可以生成难以调试的代码。考虑一种 MVC 方法，而不是逻辑主要在 Controller 中，而 View 仅根据该逻辑处理渲染视图。

# xsd - Enunciate 不会从 xs:documentation on xs:elements 生成描述

> ID：15300947
> 
> 赞同：0
> 
> 时间：2013-03-08T18:35:45.297
> 
> 标签：xsd, enunciate

我们正在使用 maven-enunciate-plugin 版本 1.26.2，并且在生成文档时遇到了问题。我们通过以下方式向 XSD 添加了注释：

```
<xs:complexType name="PagingParameters">
    <xs:annotation>
        <xs:documentation>information about PagingParameters</xs:documentation>
    </xs:annotation>
    <xs:sequence>
        <xs:choice minOccurs="0">
            <xs:element name="StartPos" type="xs:long" nillable="false">                    
                <xs:annotation>
                    <xs:documentation>information about StartPos</xs:documentation>
                </xs:annotation>
            </xs:element>
            <xs:element name="FollowOnBrowseToken" type="xs:string" nillable="false">
                <xs:annotation>
                    <xs:documentation>information about token</xs:documentation>
                </xs:annotation>
            </xs:element>
        </xs:choice>
        <xs:element name="NoOfRecords" type="xs:long" nillable="false">
            <xs:annotation>
                <xs:documentation>information about noOfRecords</xs:documentation>
            </xs:annotation>
        </xs:element>
    </xs:sequence>
</xs:complexType> 
```

第一个集合在发音页面上被正确解析和输出，但是其中各个元素的所有注释都完全丢失了。奇怪的是，这只发生在元素序列中，但枚举工作得很好。

我尝试了几种不同的格式化文档的方法，包括使用 CDATA 块，但似乎没有任何效果。

我错过了什么？如果需要，我可以包含更多的 XSD。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-06T20:22:49.583

Enunciate 使用 JavaDoc 来解析其文档。您能否确认 JavaDoc 出现在生成的 Java 类中？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-07T13:12:35.540

Javadoc*不会*出现在生成的类中，但是 jaxb 会用他们自己的标准注释覆盖它，如下所示：

```
/**
 * Gets the value of the X property.
 * 
 * @return
 *     possible object is
 *     {@link String }
 *     
 */
public String getX() { 
```

但在 enuciate 中仍然没有显示 javadoc

# ruby-on-rails - 未定义的方法 _path (NoMethodError)

> ID：15300948
> 
> 赞同：10
> 
> 时间：2013-03-08T18:35:46.583
> 
> 标签：ruby-on-rails

当我尝试访问包含创建帖子的表单的页面时，我在 Rails 应用程序中收到以下错误。我正在尝试在他的示例应用程序中实现类似于 Michael Hartl 的 Micropost 功能的功能：

```
NoMethodError in Home#index
undefined method `posts_path' for #<#<Class:0xb5c70744>:0xb60013b8> 
```

这是包含插入表单的代码的索引视图页面：

```
<%= render 'shared/post_form' if user_signed_in? %> 
```

_post_form.html.erb：

```
<%= form_for(@post) do |f| %>
  <%= render 'shared/error_messages', object: f.object %>
  <div class="field">
    <%= f.text_area :content, placeholder: "Provide your network with a status update..." %>
  </div>
  <%= f.submit "Post", class: "btn btn-large btn-primary" %>
<% end %> 
```

这是家庭控制器：

```
 class HomeController < ApplicationController

    before_filter :authenticate_user!

  def index
    #render :text => "Welcome #{current_user.email}!"
    @users = User.all
    @post = current_user.posts.build if signed_in?
  end
end 
```

我真的可以在审查代码时使用一些帮助。我正盯着它看，我需要其他人为我审查它。我是 Rails 的新手，所以如果我没有提供必要的信息，请原谅我。

附加信息：我正在使用 Devise gem 来处理用户身份验证。

谢谢！

编辑：我添加了错误的控制器。

编辑2：

Routes.rb 文件：

```
AppName::Application.routes.draw do

  #get "users/index"

  #get "users/show"

authenticated :user do
    root :to => 'home#index'
  end
  root :to => "home#index"
  devise_for :users
  resources :users do
    member do
      get :following, :followers, :posts
    end
  end
  resources :works
  resources :relationships, only: [:create, :destroy]
end 
```

编辑 3：耙路线

```
root        /                              home#index
                    root        /                              home#index
        new_user_session GET    /users/sign_in(.:format)       devise/sessions#new
            user_session POST   /users/sign_in(.:format)       devise/sessions#create
    destroy_user_session DELETE /users/sign_out(.:format)      devise/sessions#destroy
           user_password POST   /users/password(.:format)      devise/passwords#create
       new_user_password GET    /users/password/new(.:format)  devise/passwords#new
      edit_user_password GET    /users/password/edit(.:format) devise/passwords#edit
                         PUT    /users/password(.:format)      devise/passwords#update
cancel_user_registration GET    /users/cancel(.:format)        devise/registrations#cancel
       user_registration POST   /users(.:format)               devise/registrations#create
   new_user_registration GET    /users/sign_up(.:format)       devise/registrations#new
  edit_user_registration GET    /users/edit(.:format)          devise/registrations#edit
                         PUT    /users(.:format)               devise/registrations#update
                         DELETE /users(.:format)               devise/registrations#destroy
          following_user GET    /users/:id/following(.:format) users#following
          followers_user GET    /users/:id/followers(.:format) users#followers
              posts_user GET    /users/:id/posts(.:format)     users#posts
                   users GET    /users(.:format)               users#index
                         POST   /users(.:format)               users#create
                new_user GET    /users/new(.:format)           users#new
               edit_user GET    /users/:id/edit(.:format)      users#edit
                    user GET    /users/:id(.:format)           users#show
                         PUT    /users/:id(.:format)           users#update
                         DELETE /users/:id(.:format)           users#destroy
                   works GET    /works(.:format)               works#index
                         POST   /works(.:format)               works#create
                new_work GET    /works/new(.:format)           works#new
               edit_work GET    /works/:id/edit(.:format)      works#edit
                    work GET    /works/:id(.:format)           works#show
                         PUT    /works/:id(.:format)           works#update
                         DELETE /works/:id(.:format)           works#destroy
           relationships POST   /relationships(.:format)       relationships#create
            relationship DELETE /relationships/:id(.:format)   relationships#destroy 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-03-08T21:15:11.130

您需要添加`resources :posts`您的`routes.rb`文件，以便 Rails 自动`posts_path`为您创建帮助程序。

添加`resources :posts`将生成适当的 RESTful 路由供您创建、删除、更新和获取`posts`。查看 Ruby on Rails 路由指南，特别是[这里](http://guides.rubyonrails.org/routing.html#crud-verbs-and-actions)关于路由和 RESTful 路由的部分。

# asp.net - 在 asp.net 页面和用户控件之间共享数据表

> ID：15300949
> 
> 赞同：2
> 
> 时间：2013-03-08T18:35:56.403
> 
> 标签：asp.net, session, user-controls, postback, viewstate

我有一个动态加载用户控件的 ASP.Net 页面，我想在它们之间共享一个数据表

我使用会话状态如下

```
HttpContext.Current.Session["DataTable"] = DT; 
```

并在用户控件中按以下方式访问它

```
gridVw.DataSource =(DataTable) HttpContext.Current.Session["DataTable"] ;
 gridVw.DataBind(); 
```

数据已成功加载，但问题是在访问服务器端的任何事件或回发时，会引发无效视图状态的错误（仅在 IE 中）

从页面访问会话也会在回发时导致同样的问题

这是错误页面

> 此页面的状态信息无效，可能已损坏。FormatException：输入不是有效的 Base-64 字符串，因为它包含非 base 64 字符、两个以上的填充字符或填充字符中的非法字符。]
> System.Convert.FromBase64_ComputeResultLength(Char* inputPtr, Int32 inputLength) +10545429 System.Convert.FromBase64CharPtr(Char* inputPtr, Int32 inputLength) +71
> System.Convert.FromBase64String(String s) +41
> System.Web.UI.ObjectStateFormatter。反序列化（字符串输入字符串，目的目的）+66
> System.Web.UI.ObjectStateFormatter.System.Web.UI.IStateFormatter2.Deserialize（字符串序列化状态，目的目的）+8
> System.Web.UI.Util.DeserializeWithAssert(IStateFormatter2 格式化程序，字符串序列化状态，目的用途) +40
> System.Web.UI.HiddenFieldPageStatePersister.Load() +127
> 
> [ViewStateException：无效的视图状态。

我认为这是因为会话有长数据或零分隔符或其他任何原因导致

> System.Convert.FromBase64

我使用了另一个会话变量（虚拟数字）并从用户控件访问它以确保此用户控件没有问题并且没有问题

问题是我不想使用 Session 来保存我的数据表，因为我知道它的缺点，但还有其他建议吗？ **注意**：我正在以静态方法（）在网页中加载用户控件，`WebMethod`这使我无法采取任何可能的解决方法

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T18:47:17.443

您根本不需要使用会话变量。如果将用户控件的公共函数（或属性）公开给 Web 应用程序，则可以将表分配给控件。例子：

```
Partial Class user_controls_myControl
    Inherits System.Web.UI.UserControl
   'create a public method your app can see:

   Public Sub bindData(ByVal dt As dataTable)
   End Sub

End Class 
```

然后，您可以像这样从您的主应用程序访问它：

```
dim mydataTable as dataTable
'fill the datatable
dim myControl as myControl1
myControl.bindData(mydataTable) 
```

# xml - 使用 XPath 从 GET 响应中提取和使用数据

> ID：15300953
> 
> 赞同：2
> 
> 时间：2013-03-08T18:36:05.537
> 
> 标签：xml, rest, fitnesse

这是场景...我执行 GET 来检索 XML。我想从 XML 中提取一个值以在后续测试中使用。例如，我执行 GET 来检索 Order XML。然后，我想提取 ProposalNumber 元素的文本并使用 LET 将其分配给一个变量，以便稍后在测试中使用它。我下载了一个 RestFixtureTest，它可以按预期工作并返回文本（使用 text()）。但是当我用被测系统尝试时，响应是空的。我看到的唯一明显区别是 Content-Type 标头。RestFixtureTest 使用 text/xml，而我的测试使用 application/xml。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-05-29T10:33:37.253

根据您的 Web 服务，必须在使用 FITNESSE 的 RestFixture 启动 Web 服务之前更新 Content-Type

例如，如果您的 Web 服务使用 application/xml 使用 SetHeaders 并将 Content-Type 定义为 application/xml

然后使用 let 使用以下格式解析 XML 响应，

|let |proposalnumber|body|//proposalnumber/text()|$proposalnumber=|

提案编号标签的值将存储在提案编号变量中

# batch-file - 试图传递变量会添加额外的字符

> ID：15300957
> 
> 赞同：1
> 
> 时间：2013-03-08T18:36:33.433
> 
> 标签：batch-file, environment-variables

几年前我见过其他人解决这个问题，但他们似乎没有给出有效的答案。

当我尝试在批处理文件中传递这两个命令时（它们在手动完成时工作）：

```
nltest /dsgetsite>c:\windows\temp\site.txt 
set /p CurrentADSite<c:\windows\temp\site.txt 
```

但是当我尝试通过批处理文件发出命令时，我得到了这个：

```
C:\working>nltest /dsgetsite  1>c:\windows\temp\site.txt

C:\working>set /p CurrentADSite  0<c:\windows\temp\site.txt
The syntax of the command is incorrect. 
```

我到底怎么才能让它发挥作用？有没有更简单的方法可以将 dsgetsite 结果直接传递到变量中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T19:21:34.587

您可以使用`for /f`来避免临时文件（而且您 [通常] 不能写入 Windows 目录，因此无论如何都会爆炸）：

```
for /f %%x in ('nltest /dsgetsite') do if not defined CurrentADSite set CurrentADSite=%%x 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T19:03:03.960

根据[http://ss64.com/nt/set.html](http://ss64.com/nt/set.html)，您可能错过了一个=
“将文件的第一行放入变量中：
`Set /P _MyVar=<MyFilename.txt`”

如果一切都失败了，你总是可以依靠：

```
:: start the temp batch with start of set command
echo set CurrentADSite=>c:\windows\temp\site.bat
:: add to the temp bat : the variable assignment
nltest /dsgetsite>>c:\windows\temp\site.bat
:: run the temp batch and return here
call c:\windows\temp\site.bat 
```

# json - 从 PHP 中提取/解析以 JSON 形式返回的数据

> ID：15300958
> 
> 赞同：0
> 
> 时间：2013-03-08T18:36:36.113
> 
> 标签：json, delphi, delphi-xe3

我正在使用 TIdHTTP 从 PHP 调用中获取 JSON 数据。我期待使用 TJSONObject 但不知道如何为此目的使用它。XE3 帮助中没有示例。

示例 JSON 数据

```
[{"fleet_id":"2","fleet":"EMB195"},{"fleet_id":"3","fleet":"EMB175"},{"fleet_id"‌:"1","fleet":"DHC84-400Q"}] 
```

我敢肯定这很简单，但是如何！

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T21:29:47.503

用于[`TJsonObject.ParseJsonValue`](http://docwiki.embarcadero.com/Libraries/XE2/en/Data.DBXJSON.TJSONObject.ParseJSONValue)将输入字符串转换为 JSON 值：

```
var
  val: TJsonValue;

s := '[{"fleet_id":"2","fleet":"EMB195"},{"fleet_id":"3","fleet":"EMB175"},{"fleet_id"‌:"1","fleet":"DHC84-400Q"}]';
val := TJsonObject.ParseJsonValue(s); 
```

在这种情况下，JSON 恰好代表一个数组，因此您可以将其类型转换为：

```
var
  arr: TJsonArray;

arr := val as TJsonArray; 
```

您可以使用 访问数组的元素[`Get`](http://docwiki.embarcadero.com/Libraries/XE2/en/Data.DBXJSON.TJSONArray.Get)，并将结果类型转换为`TJsonObject`。

```
var
  i: Integer;
  elem: TJsonObject;

for i := 0 to Pred(arr.Size) do begin
  elem := arr.Get(i) as TJsonObject;
end; 
```

要检查对象的属性，您可以使用该[`Get`](http://docwiki.embarcadero.com/Libraries/XE2/en/Data.DBXJSON.TJSONObject.Get)方法，该方法返回一个`TJsonPair`包含名称和值的值。

# json - PostgreSQL 导入工具 (RDF/JSON/CSV)

> ID：15300960
> 
> 赞同：1
> 
> 时间：2013-03-08T18:36:42.323
> 
> 标签：json, postgresql, import, rdf

我正在寻找一种 (GUI) 工具来帮助我将各种数据格式（主要是 RDF、JSON 和 CSV）转换为 PostgreSQL 数据库。有没有什么好工具可以帮助我为要导入（和互连）的文件定义表模式并导入数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T00:27:47.560

一。您可以尝试将 Microsoft Access 中的表与 pgODBC 2nd 链接。您可以导入文件。CSV 进入 Access 并运行命令 Insert 3rd。通过 Access to Export 单击文件并选择所需的 PostgreSQL ODBC 源。

# java - 无法使用 gcm 从服务器接收通知到 android 设备

> ID：15300961
> 
> 赞同：0
> 
> 时间：2013-03-08T18:36:52.160
> 
> 标签：java, android, google-cloud-messaging

我已经发布了这个[问题](https://stackoverflow.com/questions/15218162/cant-recieve-notification-from-gcm)。

我以为下载最新版本的 gcm 就可以了，但我错了。我已经下载了最新版本的 gcm，但仍然收不到通知。我有一个 GOOGLE API KEY 和一个发件人 ID。

当我注册 ID 时一切都很好 - 它工作正常并显示在数据库中，但是当我尝试从服务器向我的 android 设备发送消息时，我没有从服务器收到消息。

谁能帮我？我也尝试了一些示例，但它们不起作用。有没有人有工作示例，或者我的 API 密钥无效？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-04T06:28:47.430

请检查您的服务器代码是否访问已注册 Android 设备的注册 ID。

以下链接通过简单的客户端代码和服务器端代码对 GCM 进行了准确解释。 [http://avilyne.com/?p=267](http://avilyne.com/?p=267)

# javascript - 在javascript中以dd.mm.yyyy格式显示日期

> ID：15300962
> 
> 赞同：-1
> 
> 时间：2013-03-08T18:36:52.107
> 
> 标签：javascript

我有一个约会`var string = 2013-02-22`。我想把它转换成`22.02.2013`. 我怎样才能在 JavaScript 中做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T19:02:01.077

如果您只想更改日期的文本表示，可以使用正则表达式：

```
var string = '2013-02-22';
var patt = /(\d\d\d\d)-(\d\d)-(\d\d)/;
var dates = patt.exec(string);

if (dates && dates.length === 4) {
    alert(dates[3] + '.' + dates[2] + '.' + dates[1]);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T18:43:16.720

你可以使用[datejs](http://www.datejs.com/)。它是一个免费的开源 javascript 库，用于处理日期。

# javascript - ASP.NET WebMethod 以 json 形式返回对象，但不在响应方法中

> ID：15300963
> 
> 赞同：0
> 
> 时间：2013-03-08T18:37:01.387
> 
> 标签：javascript, ajax, json

我有一个简单的网络方法：

```
<WebMethod(Description:="Does something.")> _
<ScriptMethod(ResponseFormat:=ResponseFormat.Json)> _
Public Shared Function ReturnJSONData() As Person
    Dim guy As New Person
    guy.Name = "Joe"
    guy.Age = 8
    Return guy
End Function 
```

这里是我调用 ajax 方法的地方：

```
 function GetPerson() {
     PageMethods.ReturnJSONData(OnWSRequestComplete1);
 }
 function OnWSRequestComplete1(result) {
     alert(result.d);
 } 
```

当我使用像 firebug 这样的工具时，我可以看到 JSON 结果：

```
{"d":{"__type":"Person","Name":"Joe","Age":8}} 
```

但是，当我调用“alert(result.d)”时，我得到了未定义。我错过了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T18:41:45.273

当您从 WebMethod 获得响应时，您需要评估响应，因为它作为字符串返回。我会犹豫`eval`在您的代码中使用，因为存在安全风险。

如果您使用的是 jQuery，您可以调用`jQuery.parseJSON(result)`它将返回您期望的实际 Javascript 对象。

# macos - OpenNI 2 OS X 山狮

> ID：15300979
> 
> 赞同：4
> 
> 时间：2013-03-08T18:37:45.983
> 
> 标签：macos, openni

我已经为此苦苦挣扎了太多时间。我正在尝试安装 OpenNI 2 以使我的 kinect 在 OS X Mountain Lion 上与 Mac 一起工作。

[我从http://www.openni.org/openni-sdk](http://www.openni.org/openni-sdk)下载了 OS X 的软件包，并在其中运行了带有 sudo 权限的 install.sh 文件，它只是在其中创建了一个“OpenNIDevEnvironment”文件与安装文件相同的文件夹。在 Redist 中，我看到一些未安装的库。我还查看了 install.sh 脚本。它不应该复制任何东西！

谁能告诉我如何从这一点开始？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T09:09:29.380

我也有这个问题。尝试下载 [https://github.com/OpenNI/OpenNI2](https://github.com/OpenNI/OpenNI2) 而不是进入文件夹并执行“sudo make”

就我而言，我的新问题是“找不到设备”。但这可能是 Kinect Model 1473 的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-10T16:38:45.860

看起来第一步似乎什么也没做，但还有更多，这可能有一些答案：[http ://www.theworldneedsmoredreamers.net/using-openni-2-2-beta-on-os-x/](http://www.theworldneedsmoredreamers.net/using-openni-2-2-beta-on-os-x/)

# asp.net-mvc - 可能的解决方法是让多个 http get 方法两个具有相同名称的操作？

> ID：15300980
> 
> 赞同：2
> 
> 时间：2013-03-08T18:37:52.603
> 
> 标签：asp.net-mvc, asp.net-mvc-4, http-get, asp.net-mvc-controller

我正在使用 asp.net MVC 4。有没有办法在同名但参数不同的操作上使用两个 http get 方法？或者只是一种让页面成为两者的索引页面的方法，所以页面的名称是一致的？此外，int 不能为空。

例子：

用于查询字符串和搜索

```
 [HttpGet]
    public ActionResult Index(int num, string aString)
   {
   } 
```

仅用于操作链接单击（默认搜索）

```
 [HttpGet]
  public ActionResult Index()
 {
 } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T18:41:34.813

没有变通办法。您可以执行以下操作：

```
[HttpGet]
public ActionResult Index(int num, string aString)
{
      //if num == null, throw exception or do something
      // if string == null, do something, if not, do something else
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-24T22:01:11.257

```
 - (Html . BeginForm ( "ViewName", "ControllerName", FormMethod.Get ) {
   Html . Hidden ( "actionname1", "true" ) form elements set 1 submit
   button 1 }

   (Html . BeginForm ( "ViewName", "ControllerName", FormMethod.Get ) {
   Html . Hidden("actionname2", "true") form elements set 2 submit
   button 2 }

   In Controller, check for "true "values for actionname1, actionname2
   and decide on control flow for each. Assumption: Same View and Same
   Controller WITH Two distinct FormMethod.Gets

   ..Paurav 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-25T01:58:29.300

我实际上最终做的是在一次获取 http 请求操作中传入一个具有可为空值的对象。正如上面评论中的@Display Name 所建议的那样，Microsoft 已将此功能内置到 .net 框架中。

# vim - .vimrc 设置粘贴不始终生效

> ID：15300981
> 
> 赞同：2
> 
> 时间：2013-03-08T18:37:53.003
> 
> 标签：vim

似乎我在 .vimrc 中的“设置粘贴”选项没有被选中。当我启动 vim 并进入插入模式时，我得到了预期的插入（粘贴）。但是，当我使用 apple-V 从剪贴板粘贴时，文本会在每一行逐渐缩进，就好像我没有打开粘贴模式一样。然后我手动输入 :set paste 再试一次，文本格式正确。

此外，即使它也被明确设置，自动缩进似乎也参差不齐。

这是 OSX Lion 上的 vim 7.3。谢谢！

```
set paste 
set autoindent
syntax on

colorscheme elflord

set tabstop=2
set softtabstop=2
set shiftwidth=2 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T19:54:58.123

`set paste` has no business being in your `~/.vimrc` as it conflicts with a number of useful options.

The only use for `:set paste` is to reset a bunch of indentation-related options to allow your text to be pasted "correctly" when you use the mouse or your system's "paste" facilities. It's probably a good idea to read `:h pastetoggle`.

In such a situation, you are supposed to do `:set paste` before you paste and `:set nopaste` afterwards.

If your Vim has clipboard support built-in (`:echo has('clipboard')` should return `1`) and you work locally, I highly recommend you use `"+y` and `"+p` instead.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T18:55:45.357

选项`paste`和`autoindent`不相处。我建议保留选项的切换`autoindent`并将其映射到功能键，例如：`<F10>``paste`

```
:map <F10> :set invpaste<CR> 
```

# ipad - 检测蓝牙键盘上的 Tab 键按下

> ID：15300989
> 
> 赞同：1
> 
> 时间：2013-03-08T18:38:51.527
> 
> 标签：ipad, cocoa-touch, uikit, uitextfield, uitextfielddelegate

如果蓝牙键盘连接到 iPad，我可以通过以下方式选择**回车**键：

```
-(BOOL)textFieldShouldReturn:(UITextField *)textField 
```

但是如果我还需要检测**tab**键，我该怎么做？

仅供参考，在 ios 模拟器中使用硬件键盘本质上是一回事。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T18:44:27.993

祝你好运; 请参阅下面的帖子以深入了解这个问题。:)

[http://weaklyreferenced.wordpress.com/2012/11/13/responding-to-the-tab-and-shift-tab-keys-on-ios-5-ios-6-with-an-external-keyboard/](http://weaklyreferenced.wordpress.com/2012/11/13/responding-to-the-tab-and-shift-tab-keys-on-ios-5-ios-6-with-an-external-keyboard/)

简短的回答是 iOS（至少从 iOS 6 开始）没有为`tab`密钥公开类似的方法，您必须发挥创造力才能检测到它。

# python - 在 Python 中处理大量数字的更有效方法？

> ID：15300995
> 
> 赞同：0
> 
> 时间：2013-03-08T18:39:06.673
> 
> 标签：python

我在 Python 中有一个问题，我已经为它创建了一个答案，但我正在努力提高答案的效率。

我不能使用函数，递归，只有基本的东西..

问题是：

对于数字 3 的幂 2209，有 1000 位。找到 12 个序列号，它的总和是最大的。

例如：5 次方 36 等于 14551915228366851806640625。乘积最大和的 12 个序列数是 836685180664。

```
sumOfBig=0
Big=""
x=5**36
strp=str(x)
s=len(strp)
print(x)
print()
for i in range(s-11):
    new=strp[i:i+12]
    l=0
    for j in new:
        l=l+int(j)
    print(i)
    print(new)
    print(l)
    print()
    if l>sumOfBig:
        sumOfBig=l
        Big=new
print(Big)
print(sumOfBig) 
```

你们对更好的代码有什么想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-08T18:48:13.440

好吧，您可以采用更有效的方法对 12 个连续数字求和。您可以跟踪 12 个序列号，从子集的总和中弹出/减去最旧（最左边）的一个，推送/添加最新（最右边）一个。

另外，`sum(iterable)`是一个内置函数。

我的新代码只有基本的`list`和`for-loop`：

```
x = 5 ** 36
num_list = [int(i) for i in str(x)]
sumOfBig = last_sum = sum(num_list[:12])
maximal_index = 0

for i, n in enumerate(num_list[12:]):
   last_sum = last_sum + n - num_list[i]
   if last_sum > sumOfBig:
      maximal_index = i+1
      sumOfBig = last_sum

print num_list[maximal_index:maximal_index+12] #[8, 3, 6, 6, 8, 5, 1, 8, 0, 6, 6, 4] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T18:55:17.697

```
x = 5**36
str_x = [int(i) for i in str(x)]

curBestIndex = 0
curBestSum = sum(str_x[:12])
curSum = curBestSum

for i in range(len(str_x) - 11):
    delta = str_x[i + 11] - str_x[i]
    curSum += delta
    if curSum > curBestSum:
        curBestSum = curSum
        curBestIndex = i

big = str(x)[curBestIndex : curBestIndex + 12]
print(big)
print(curBestSum) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T19:10:40.043

这是一种有助于排除所有出现的 11/12 等的方法。

```
MAX_LENGTH = 12
x = 5 ** 36

sequence = []
d = []

for i in str(x):
    d.append(int(i))
    if len(d) > MAX_LENGTH:
        d.pop(0)
    if sum(d) >= sum(sequence):
        sequence = list(d)

print sequence, sum(sequence) 
```

回报：

```
>>> 
[8, 3, 6, 6, 8, 5, 1, 8, 0, 6, 6, 4] 61 
```

根据 Python 之禅“可读性很重要”，我认为这里介绍的单行操作比切片操作更直接，尤其是在考虑来自多个硬编码序列长度实例的错误时。

# java - 如何在android中读取XML数据

> ID：15300996
> 
> 赞同：1
> 
> 时间：2013-03-08T18:39:15.967
> 
> 标签：java, android, xml, eclipse, oop

嗨，我一直在尝试在我的 android 中读取我的 XML 文件，但没有成功。这是我的 XML 文件：[http](http://collectionservice.byethost13.com/backup.XML) ://collectionservice.byethost13.com/backup.XML 我所要做的就是文档中有一个行标签，并且必须只显示列表视图内所有行标签中的 ID第一个屏幕。任何机构都可以给我一个例子或什么将非常感谢。

嗨，我只想显示这个 XML 文件：

来自 XML 的第一个屏幕列表视图上的 ID，然后单击特定 ID，它转到下一个屏幕并显示该 ID 的 ID、姓名、电话、部门、What_Ever。

谁能给我一个代码或今天必须给客户的东西，我是android的新手，非常感谢你。

男人已经尝试了很多链接，但没有成功，请。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T18:41:54.597

这里是官方文档，非常清晰和简单：[https ://developer.android.com/training/basics/network-ops/xml.html](https://developer.android.com/training/basics/network-ops/xml.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T18:43:57.380

我发现[simple-xml](http://simple.sourceforge.net/)很容易用于将 xml 解析为对象。

文档写得很好，因此可能对您有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T18:44:02.363

您可以使用 SaxParser 在 android 中解析 XML 文件。扩展 DefaultHandler 类以读取您的标签。 [在这里找到一个简单的例子](http://www.jondev.net/articles/Android_XML_SAX_Parser_Example)

# java - 从 GridBagLayout 中的特定坐标获取组件

> ID：15300997
> 
> 赞同：1
> 
> 时间：2013-03-08T18:39:16.717
> 
> 标签：java, swing, coordinates, jbutton, gridbaglayout

我正在使用带有 GridBagLayout 的 JFrame，并且我希望能够从特定的 x,y 坐标获取组件（在我的情况下为 JButton）。这不应该是可能的，因为我一开始就给了它 x,y 坐标和 GridBagConstraints 吗？

是否有捷径可寻？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T19:15:00.623

> 我希望能够从特定的 x,y 坐标中获取组件（在我的情况下为 JButton）。

1.  为每个按钮添加一个 ActionListener。
2.  `event.getSource()`在 ActionListener 代码中，您可以使用ActionEvent的方法获取您单击的按钮。
3.  一旦知道了来源，就可以使用`getParent()`Component 的方法获取父 Container。
4.  `getLayout()`然后就可以使用Container的方法获取布局管理器了。
5.  拥有 GridBagLayout 后，您可以使用该`getContraints()`方法对 Component 进行约束。
6.  然后你可以得到x/y坐标。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T18:59:56.647

如果您知道所需的 JFrame 上的 x,y 坐标，您可以使用 GridBagLayout 的 location() 方法找到单元格（GridBagConstraints 中的 x,y）。知道 GridBagLayout 上的 x,y 后，您希望遍历 JFrame 的组件并在 GridBagConstraints 中找到具有相同 x,y 的组件，并将其与方法 getConstraints(Component comp) 上给出的约束进行比较。

看看[GridBagLayout API](http://docs.oracle.com/javase/6/docs/api/java/awt/GridBagLayout.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T20:56:05.147

![在此处输入图像描述](../Images/f00dc97fea30dc5aee8f649a18fcfc43.png)
这是实现您想要的东西的小可笑示例。我希望它会对你有所帮助...

```
import javax.swing.JFrame;
import javax.swing.JButton;
import javax.swing.SwingUtilities;
import java.awt.GridBagLayout;
import java.awt.GridBagConstraints;
import java.awt.Color;
import java.awt.Point;
import java.awt.Container;
import java.awt.event.ActionListener;
import java.awt.event.ActionEvent;
import java.util.Map;
import java.util.Set;
import java.util.LinkedHashMap;
class GridBagFrame extends JFrame implements ActionListener
{
    GridBagLayout gb ;
    GridBagConstraints gc;
    Map <Point,JButton> map ;
    final int SIZE = 20;
    public void createAndShowGUI()
    {
        gb = new GridBagLayout();
        gc = new GridBagConstraints();
        gc.fill = GridBagConstraints.BOTH;
        map = new LinkedHashMap<Point,JButton>();
        Container container = getContentPane();
        container.setLayout(gb);
        int x =0 , y = -1 ;
        JButton[] button = new JButton[SIZE];
        for (int i = 0 ; i < SIZE ; i++ )
        {
            button[i] = new JButton(String.valueOf(i + 1));
            if (i % 4 == 0)
            {
                x = 0 ;
                y = y +1;
            }
            gc.gridx = x++;
            gc.gridy = y;
            gb.setConstraints(button[i],gc);
            container.add(button[i]);
            map.put(new Point(x,y),button[i]);
            button[i].setActionCommand(x+","+y);
            button[i].addActionListener(this);
        }
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        pack();
        setResizable(false);
        setVisible(true);
    }
    @Override
    public void actionPerformed(ActionEvent evt)
    {
        resetAll();
        JButton source = (JButton)evt.getSource();
        String command = source.getActionCommand();
        String[] arr = command.split(",");
        int x = Integer.parseInt(arr[0]);
        int y = Integer.parseInt(arr[1]);
        for ( int iy = y - 1; iy <= y + 1; iy++)
        {
            for (int ix = x -1 ; ix <= x + 1 ; ix++)
            {
                JButton button = map.get(new Point(ix,iy));
                if (button != null)
                {
                    button.setForeground(Color.red);
                }
            }
        }
        source.setForeground(Color.blue);
    }
    private void resetAll()
    {
        Set<Point> pointSet = map.keySet();
        for (Point point : pointSet )
        {
            map.get(point).setForeground(Color.black);
        }
    }
    public static void main(String[] args) 
    {
        SwingUtilities.invokeLater( new Runnable()
        {
            @Override
            public void run()
            {
                GridBagFrame frame = new GridBagFrame();
                frame.createAndShowGUI();
            }
        });
    }
} 
```

# jquery - 如何创建类似于 Google+ 中的工具提示？

> ID：15300998
> 
> 赞同：1
> 
> 时间：2013-03-08T18:39:26.097
> 
> 标签：jquery, css, tooltip

![在此处输入图像描述](../Images/aeb244654264df4adbce3b25bfacb92f.png)

我正在尝试创建像 Google+ 这样的功能，如果用户调整窗口大小，左侧的菜单项会被隐藏，当用户悬停更多链接时，隐藏的菜单项开始显示在工具提示中，如上图所示。

我已经完成了一半。我捕获了窗口调整大小事件并成功地将隐藏列表项 (li) 附加到了一个 div 中。这是我的代码：

```
<ul>
      <li><a href="#"><img alt="" src="../images/icons/home_active.png"> <em>Home</em></a></li>
      <li><a href="#"><img alt="" src="../images/icons/msg_active.png"> <em>Messages</em></a></li>
      <li><a href="#"><img alt="" src="../images/icons/reports_active.png"> <em>Reports</em></a></li>
      <li style="display: none;"><a href="#"><img alt="" src="../images/icons/mng_active.png"> <em>Manager</em></a></li>
      <li style="display: none;"><a href="#"><img alt="" src="../images/icons/shop_active.png"> <em>Shop</em></a> </li>
      <li class="mymore" style="display: block;"><a href="#"><img alt="" src="../images/icons/more_active.png"> <em>More</em></a> 
        <div id="mytooltip" style=""><a href="#"><img alt="" src="../images/icons/mng_active.png"> <em>Manager</em></a><a href="#"><img alt="" src="../images/icons/shop_active.png"> <em>Shop</em></a> </div>

      </li>
    </ul> 
```

仔细看代码。我在 div id="mytooltip" 中附加了隐藏的 li（检查 li 的 style="diplay:none"）。但是现在悬停在 li 上（具有 class = mymore）我想将 div id="mytooltip" 显示为工具提示，如图所示。如果用户没有悬停工具提示，我还需要隐藏此工具提示。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T01:51:02.047

一种选择是让“mymore”链接向工具提示添加一个类，以使其可见。

使用 jquery，您可以使用悬停事件。下面的示例在工具提示中添加了一个“活动”类。这个活动类只是将其显示设置为阻止。

```
$(".mymore").hover(function () {
    $("#mytooltip").addClass("active"); //hover over
}, function () {
    $("#mytooltip").removeClass("active"); //hover out
}); 
```

编辑：如果用户将鼠标悬停在实际的工具提示上，您可能不希望工具提示关闭。您可以使用计时器来解决此问题。例如，如果用户将鼠标移出“mymore”按钮，我们可以尝试在 0.5 秒内关闭该按钮。如果用户在计时器完成之前将鼠标悬停在实际的工具提示上，我们可以简单地清除计时器。

```
ToolTip = {
    interval: null,
    timer: 600,
    open: function () {
        clearTimeout(ToolTip.interval);
        $("#mytooltip").addClass("active");
    },
    close: function () {
        ToolTip.interval = setTimeout(function () {
            $("#mytooltip").removeClass("active");
        }, ToolTip.timer) //hover out
    }
}

$(".mymore, #mytooltip").hover(function () {
    ToolTip.open() //hover over
}, function () {
    ToolTip.close() //hover out
}); 
```

相关小提琴：http: [//jsfiddle.net/J9WB7/](http://jsfiddle.net/J9WB7/)

# delphi - 打开 Windows Explorer 目录，选择特定文件（在 Delphi 中）

> ID：15300999
> 
> 赞同：19
> 
> 时间：2013-03-08T18:39:34.350
> 
> 标签：delphi, explorer

我有一个程序可以在 Windows 资源管理器中打开一个通过目录路径的文件夹：

```
procedure TfrmAbout.ShowFolder(strFolder: string);
begin
   ShellExecute(Application.Handle,PChar('explore'),PChar(strFolder),nil,nil,SW_SHOWNORMAL);
end; 
```

有没有办法也传递这个文件名（完整的文件名路径或只是名称+扩展名）并在 Windows 资源管理器中打开文件夹但也被突出显示/选择？我要去的位置有很多文件，然后我需要在 Windows 中操作该文件。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2013-03-08T18:41:17.847

是的，您可以在调用时使用该[`/select`标志](http://support.microsoft.com/kb/152457)`explorer.exe`：

```
ShellExecute(0, nil, 'explorer.exe', '/select,C:\WINDOWS\explorer.exe', nil,
  SW_SHOWNORMAL) 
```

一种更花哨（也许也更可靠）的方法（`uses ShellAPI, ShlObj`）：

```
const
  OFASI_EDIT = $0001;
  OFASI_OPENDESKTOP = $0002;

{$IFDEF UNICODE}
function ILCreateFromPath(pszPath: PChar): PItemIDList stdcall; external shell32
  name 'ILCreateFromPathW';
{$ELSE}
function ILCreateFromPath(pszPath: PChar): PItemIDList stdcall; external shell32
  name 'ILCreateFromPathA';
{$ENDIF}
procedure ILFree(pidl: PItemIDList) stdcall; external shell32;
function SHOpenFolderAndSelectItems(pidlFolder: PItemIDList; cidl: Cardinal;
  apidl: pointer; dwFlags: DWORD): HRESULT; stdcall; external shell32;

function OpenFolderAndSelectFile(const FileName: string): boolean;
var
  IIDL: PItemIDList;
begin
  result := false;
  IIDL := ILCreateFromPath(PChar(FileName));
  if IIDL <> nil then
    try
      result := SHOpenFolderAndSelectItems(IIDL, 0, nil, 0) = S_OK;
    finally
      ILFree(IIDL);
    end;
end; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-04-05T22:46:49.337

[delphi.lonzu.net](http://delphi.longzu.net/viewthread.php?tid=48280&extra=page%3D67)和[swissdelphicenter](https://www.swissdelphicenter.ch/en/showcode.php?id=484)的答案提供了一个更简单的解决方案。我只在 Windows 10、1909 上测试过它，但它的要点是：

```
uses ShellApi, ...
...
var
   FileName : TFileName;
begin
  FileName := 'c:\temp\somefile.html';

  ShellExecute(Handle, 'OPEN', 
    pchar('explorer.exe'), 
    pchar('/select, "' + FileName + '"'), 
    nil, 
    SW_NORMAL);
end; 
```

这是简单易用的。我不知道它是否适用于旧版本的 Windows。