# StackOverflow 问答 15558000-15558999

# php - 将 PHP 数组转换为 javascript 数组

> ID：15558011
> 
> 赞同：0
> 
> 时间：2013-03-21T21:00:39.743
> 
> 标签：php, javascript, arrays

我正在尝试转换该 PHP 数组：

```
 Array
(
    [1] => 
Array
        (
            [ID] => 6927
            [Town] => Paris
            [latitude] => 48.867521
            [longitude] => 2.3317145
        )

    [2] => Array
        (
            [ID] => 6928
            [Town] => Paris
            [latitude] => 48.8615398
            [longitude] => 2.3496911
        )

    [3] => Array
        (
            [ID] => 6929
            [Town] => Paris
            [latitude] => 48.8675335
            [longitude] => 2.3292922
        )

    [4] => Array
        (
            [ID] => 6930
            [Town] => Paris
            [latitude] => 48.8686698
            [longitude] => 2.3413497
        ) 
```

到一个 javascript 数组，但我不知道如何。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T21:02:01.140

您需要将其转换为 JSON。看看这个函数[http://php.net/manual/en/function.json-encode.php](http://php.net/manual/en/function.json-encode.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T21:03:49.070

听说过[JSON](http://www.json.org/)吗？

```
<?

$jsarray = json_encode($phpArray);

?>

<script>

var myArray = <? echo $jsarray; ?>;

</script> 
```

也许这会有所帮助： http: [//php.net/manual/en/ref.json.php](http://php.net/manual/en/ref.json.php)

# sql - 将每日更改添加到数据库表

> ID：15558013
> 
> 赞同：1
> 
> 时间：2013-03-21T21:00:44.780
> 
> 标签：sql, sql-server

我正在尝试构建一个简单的数据库来跟踪用户位置属性的任何更改。每天我都会生成用户、日期、位置的当前信息并上传到 sql server 中的临时表。我试图找出正确的 sql 来查询新用户、修改用户和删除用户。

寻找新用户很容易：

```
SELECT table1.UserGuid,table1.Location
FROM table1
WHERE table1.UserGuid NOT IN 
(
  SELECT DISTINCT table2.UserGuid
  FROM table2
) 
```

我遇到的问题是查找修改过的位置和删除的用户。

对于修改后的用户，我试图返回他们在数据库中的最后一个位置与日常临时数据库中的当前位置不匹配的用户。这就是我所拥有的，但我认为它不正确：

```
SELECT table1.UserGuid,table1.Location
FROM table1
WHERE EXISTS 
(
  SELECT TOP 1 table2.UserGuid,table2.Location
  FROM table2
  WHERE (table2.UserGuid = table1.UserGuid) AND (table2.Location != table1.Location)
  ORDER BY table2.Date DESC
) 
```

对于已删除的用户，我正在尝试使用以下 sql 来识别主表中不存在于日常临时表中且没有已删除位置的任何用户。（如果这返回任何已删除的用户，那么我将它们添加到主表中，位置为已删除，因此下次不会返回它们）

```
SELECT table2.UserGuid,table2.Location
FROM table2
WHERE table2.UserGuid NOT IN
(
  SELECT UserGuid
  FROM table1
)
AND table2.Location != 'deleted' 
```

在我运行所有 3 个查询以查找添加、修改和删除后，我将它们与当前日期一起添加到主表中，并在第二天重复。因此，主表有 3 列（UserGuid、Date、Location），并且每天都会添加新的行，其中包含更改的信息。到目前为止，我的新用户 sql 是唯一可靠工作的。有没有更简单的方法来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T21:15:30.407

我倾向于使用 EXISTS 进行此类检查

```
 --INSERTS
    SELECT table1.UserGuid,table1.Location
    FROM table1
    WHERE NOT EXISTS (SELECT 1 FROM table2 WHERE table2.UserGuid = table1.UserGuid)
    UNION ALL
    --UPDATES
    SELECT table1.UserGuid,table1.Location
    FROM table1
    WHERE EXISTS 
    (
        SELECT 1 FROM table2 
        WHERE table2.UserGuid = table1.UserGuid 
        AND ISNULL(table2.Location,'') <> ISNULL(table1.Location,'')
    )
    UNION ALL
    --DELETES
    SELECT table2.UserGuid,table2.Location
    FROM table2
    WHERE NOT EXISTS (SELECT 1 FROM table1 WHERE table2.UserGuid = table1.UserGuid) 
```

如果您的位置可能为空，我包括 ISNULL 检查；如果不可能，就不需要它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T21:12:13.813

对于您的第二个查询，请尝试：

```
SELECT table1.UserGuid,table1.Location
FROM table1
WHERE table1.UserGuid IN
(
  SELECT table2.UserGuid
  FROM table2
  WHERE table2.UserGuid = table2.UserGuid AND table2.Location <> table2.Location
) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T21:11:41.990

所以我*认为*这可以满足您的所有要求。

```
 Select 
table1.*,
    case when table2.userguid is null then 'INSERT'
    when table1.userguid is null and table2.location != 'deleted' then 'DELETE'
    when table1.location != table2.location then 'UPDATE'
     from table1
    full join (select max(date) as lastEntry, userGuid from Table2) lastRecords
    inner join table2 on table2.date = lastRecords.lastEntry and table2.userGuid = lastRecords.userGuid
     on lastRecords.userguid = table1.userguid 
```

# database - 用户、客户、租户、员工——都在同一张表中？

> ID：15558016
> 
> 赞同：0
> 
> 时间：2013-03-21T21:00:55.963
> 
> 标签：database, structure, multi-tenant

在这种情况下，让我更具体地说明这个问题

我有一个 peoples 表（带有客户和供应商），我有一个 users 表（用于可以登录的用户）。

目前我有这个数据库结构

客户 -> 组织 -> 通过 rel_customer_addresses 链接到地址表。（因为 1 位客户可能有送货地址、发票地址等）

用户 -> 租户 -> 通过 rel_users_addresses 链接到地址表（因为 1 个用户可能有送货地址、发票地址等）

现在我已经在发票表 customer_key 中了。问题是当用户自己是客户并且发票来自他的一位客户时。如何指示我的网络应用程序查找用户而不是客户？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T12:37:47.757

由于您正在查看 2 个单独的实体（客户和用户），我将继续使用 2 个单独的表并让它们共享一个唯一标识符（即用户名、SID）。

这样一来，没有适当的权限，一个人就不可能看到另一个人的信息。

有几种方法可以控制它，但逻辑是这样的。

`If userID exists in table user, do this.`
`If userID exists in table customer, do this.`
`If userID exists in table user AND table customer, do this.`

这样，您就可以独立或共同完全控制局势。换句话说，您可以授予`userID`在 table 中找到的特殊权限`customer`，或者只是将其完全分开（类似于说，facebook 如何为页面与其注册的帐户创建单独的“身份”）。

希望有帮助！

# mysql - 如何通过检查两个表找到在线可用的用户？

> ID：15558019
> 
> 赞同：0
> 
> 时间：2013-03-21T21:01:07.820
> 
> 标签：mysql

我有 2 个表“用户”和“朋友”：

```
Table: Users(username,email,location,online_status)
Table: Friends(Friend_rq_from,Friend_request_to,status) 
```

“用户”表用于显示网站中的注册用户数

和“朋友”表供个人用户维护他们的朋友。

我想数一下，例如：mithun's 来自“Friends”表的朋友（1 表示他们是 Friends 表中的朋友）在 Users 表中在线..（1 表示在“users”表中在线）

这对我来说有点困难，因为“朋​​友”表有 2 个字段，“mithun”可以在“Friend_rq_from”字段或“Friend_request_to”字段中......如何找到这个？

NB: Friend_rq_from: 表明谁发起了好友请求，Friend_request_to: 表明请求发送给谁（或者谁正在等待接受）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T21:15:34.080

```
SELECT COUNT(distinct u.username)
FROM Users u
INNER JOIN Friends f
ON (u.username = f.Friend_rq_from AND f.Friend_rq_to='mithun' AND f.status=1)
OR (u.username = f.Friend_rq_to AND f.Friend_rq_from='mithun' AND f.status=1)
WHERE u.online_status = 1 AND u.username <> 'mithun' 
```

# regex - 如何为包含某个单词的 URL 执行 301？

> ID：15558033
> 
> 赞同：-1
> 
> 时间：2013-03-21T21:02:02.550
> 
> 标签：regex, .htaccess, http-status-code-301

我对正则表达式一点也不擅长，所以请耐心等待。

我想为以下内容执行 301 重定向：

```
http://{mydomain.com}/searches/{whatever}?{whatever}={whatever} => http://mynewdomain.com/ 
```

谁能帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T21:34:38.217

将这些指令添加到 mydomain.com 根目录（或虚拟主机配置）中的 .htaccess，我假设长度大于 0

```
 RewriteBase /
 RewriteCond %{QUERY_STRING} ^.+=.+$
 RewriteRule ^searches/.+$ http://mynewdomain.com/ [R=301,L,NC] 
```

# php - 创建一个没有秒的php日期对象当前日期

> ID：15558037
> 
> 赞同：6
> 
> 时间：2013-03-21T21:02:09.990
> 
> 标签：php

我需要一个日期对象，该对象的时间为当天上午 12:00:00（意味着没有秒数）。我将其转换为秒数并将其传递给另一个函数。它最终用于使用 date = "someDateHere' 关闭数据库的报告过滤器，并且该字段中的挂秒正在搞砸报告。

我不确定在 time 函数的第二个参数中放入什么 - 将其留空将使用当前时间，这是我不想要的。我在 php 文档中找不到示例或任何内容。如果还有其他功能可以完成这项工作，我愿意接受建议。这应该很简单，但它在暗示我。

```
 date_default_timezone_set('America/Detroit');
        $now = date("Y-m-d 0:0:0");
        echo $now . '<br/>';
        $now = time($now,0);
        echo $now . '<br/>'; 
```

提前致谢。

编辑：请注意：我需要将该日期对象转换为秒。这就是时间戳让我用 strtotime 函数和 time 函数搞砸的地方。即使我将一个*没有*时间戳的日期对象传递给它，将其转换为秒也不太方便，因为它会将时间戳作为默认为当前时间的第二个参数插入。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-21T21:13:12.207

这里有很多可用的选项，因为 PHP 接受多种时间格式。

```
$midnight = strtotime('midnight');
$midnight = strtotime('today');
$midnight = strtotime('12:00am');
$midnight = strtotime('00:00');
// etc. 
```

或以[日期](http://php.net/class.datetime)时间形式：

```
$midnight = new DateTime('midnight');
$midnight = new DateTime('today');
$midnight = new DateTime('12:00am');
$midnight = new DateTime('00:00');
// etc. 
```

请参阅手册中的[时间格式](http://php.net/datetime.formats.time)和[相关格式](http://php.net/datetime.formats.relative)以获取带有说明的完整格式列表。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T21:09:06.297

哦，我会完全停止使用这些功能，并开始利用 DateTime 类！

```
$date = new DateTime("now", new DateTimeZone("America/Detroit"));
echo $date->format("Y-m-d"); 
```

[http://php.net/manual/en/class.datetime.php](http://php.net/manual/en/class.datetime.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-21T21:12:30.920

time() 不接受任何参数。你在做什么是没有意义的。为什么不只是`strtotime(date('Y-m-d'))`获取午夜的 unix 时间戳？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T21:08:02.753

我认为 mktime() 正是你需要的[http://www.php.net/manual/en/function.mktime.php](http://www.php.net/manual/en/function.mktime.php)

```
<?php
// Set the default timezone to use. Available as of PHP 5.1
date_default_timezone_set('UTC');

// Prints: July 1, 2000 is on a Saturday
echo "July 1, 2000 is on a " . date("l", mktime(0, 0, 0, 7, 1, 2000));

// Prints something like: 2006-04-05T01:02:03+00:00
echo date('c', mktime(1, 2, 3, 4, 5, 2006));
?> 
```

# php - 如何本地化 PHP 中的标志菜单？

> ID：15558039
> 
> 赞同：0
> 
> 时间：2013-03-21T21:02:11.377
> 
> 标签：php, localization

我有一个多语言网站。该站点有一个区域设置标志菜单，其中包含这些链接

`example.com/en/pages/more-info`
`example.com/fr/pages/plus-d-informations`
`example.com/de/pages/mehr-infos`
`example.com/pl/pages/więcej-informacji`

当用户访问特定页面时，他会看到整个页面已本地化，例如法语。但是菜单必须显示网站使用的所有可能的本地化。

问题是：我应该使用这段代码吗

```
putenv("LANG=" . $language); 
setlocale(LC_ALL, $language); 
bindtextdomain("messages", "Locale");
bind_textdomain_codeset("messages", 'UTF-8'); 
textdomain("messages"); 
```

然后

```
<a href="/fr/pages/<?=_("more-info")?>">French</a>
... 
```

每次在标志菜单中显示每个项目时切换区域设置？

`$language`在标志菜单中显示每个项目之前更改。

这是一个正确的解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T10:28:04.980

当您迭代语言以打印出替代语言链接时，临时切换区域设置是一种常见的做法。我在我工作过的网站上做过。

*   不要忘记在开始之前保存“当前语言环境”，并在完成该代码部分后将语言环境更改回它。
*   这似乎是很多切换语言环境的机制。您需要将其封装在一个函数中。
*   至于性能，我不确定您的按摩是如何存储的，或者它们是否被缓存。如果您发现您的方法表现不佳，那么添加一些缓存机制并修复它应该很简单。

# .net - 使用 VS 2010 使用第三方 Web 服务

> ID：15558044
> 
> 赞同：1
> 
> 时间：2013-03-21T21:02:49.297
> 
> 标签：.net, vb.net, web-services

我需要从 COTS 应用程序中使用 Java Web 服务。我只让 wsdl 使用它。它要求我提供用户名和密码。我以前在我的 .NET 2005 Windows 服务中使用 WSE 3.0 使用它们。我正在尝试将 Windows 服务升级到 2010。

我通过添加服务添加了对服务的引用。（由于公司政策，我不得不更改自定义名称和服务器，所以希望我没有造成语法错误。）我不得不编辑链接，因为这是我的第一篇文章。

我看到它在我的应用配置中添加了条目：

```
<startup><supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.0"/></startup><system.serviceModel>
    <bindings>
        <customBinding>
            <binding name="MyServiceSoapBinding">
                <textMessageEncoding maxReadPoolSize="64" maxWritePoolSize="16"
                    messageVersion="Soap12" writeEncoding="utf-8">
                    <readerQuotas maxDepth="32" maxStringContentLength="8192" maxArrayLength="16384"
                        maxBytesPerRead="4096" maxNameTableCharCount="16384" />
                </textMessageEncoding>
                <httpTransport manualAddressing="false" maxBufferPoolSize="524288"
                    maxReceivedMessageSize="65536" allowCookies="false" authenticationScheme="Anonymous"
                    bypassProxyOnLocal="false" decompressionEnabled="true" hostNameComparisonMode="StrongWildcard"
                    keepAliveEnabled="true" maxBufferSize="65536" proxyAuthenticationScheme="Anonymous"
                    realm="" transferMode="Buffered" unsafeConnectionNtlmAuthentication="false"
                    useDefaultWebProxy="true" />
            </binding>
        </customBinding>
    </bindings>
    <client>
        <endpoint address="htp://servername:1234/webservices/thewebservicename"
            binding="customBinding" bindingConfiguration="MyServiceSoapBinding"
            contract="MyServiceReference.thewebservicename" name="thewebservicenameSoapPort" />
    </client>
</system.serviceModel> 
```

我首先尝试使用 BasicHttpBinding：

```
 Dim Binding As BasicHttpBinding
    Dim Binding As CustomBinding
    Dim EndPoint As EndpointAddress
    Dim etFramework As MyServiceReference.thewebserviceClient
    Dim rsp As MyServiceReference.MethodResponse
    Dim req As MyServiceReference.atkinpovoucherRequest
    Dim rsp1 As MyServiceReference.atkinpovoucherResponse

        Binding = New BasicHttpBinding()
        Binding.Name = "MyServiceSoapBinding"
        Binding.Security.Mode = BasicHttpSecurityMode.Message
        Binding.Security.Message.ClientCredentialType = BasicHttpMessageCredentialType.UserName
        Binding.MessageEncoding = WSMessageEncoding.Mtom
        Binding.ReceiveTimeout = New TimeSpan(0, 5, 0)
        Binding.OpenTimeout = New TimeSpan(0, 5, 0)
        Binding.CloseTimeout = New TimeSpan(0, 5, 0)
        Binding.SendTimeout = New TimeSpan(0, 5, 0)
        ' Set the transport security to UsernameOverTransport for Plaintext usernames
        EndPoint = New EndpointAddress("htp://server:1234/webservices/thewebservice")
        'Create the SOAP Client (and pass in the endpoint and the binding)
        etFramework = New MyServiceReference.thewebserviceClient(Binding, EndPoint)
        ''Set the username and password
        etFramework.ClientCredentials.UserName.UserName = "theusername"
        etFramework.ClientCredentials.UserName.Password = "thepassword"
        req = New MyServiceReference.theservicenameRequest(strXMLToSubmit)
        rsp1 = etFramework.MyServiceReference_thewebservice_theservicename(req)
        Debug.WriteLine(rsp1.ToString()) 
```

我收到此错误：{“BasicHttp 绑定要求 BasicHttpBinding.Security.Message.ClientCredentialType 等同于安全消息的 BasicHttpMessageCredentialType.Certificate 凭据类型。为 UserName 凭据选择 Transport 或 TransportWithMessageCredential 安全性。”} System.InvalidOperationException: {“BasicHttp 绑定要求 BasicHttpBinding.Security.Message.ClientCredentialType 等效于安全消息的 BasicHttpMessageCredentialType.Certificate 凭据类型。为 UserName 凭据选择 Transport 或 TransportWithMessageCredential 安全性。"}

更改安全模式只会导致不同的错误（需要 Soap 标头；预期 https 不是 http ....）

经过研究，我发现我需要使用 WSHttpBinding。我更改了 Binding 并得到错误：{“响应消息的内容类型 text/xml; charset=utf-8 与绑定的内容类型不匹配 (multipart/related; type="application/xop+xml") . 如果使用自定义编码器，请确保正确实现 IsContentTypeSupported 方法。响应的前 373 个字节为：'env:VersionMismatchunable to locate Envelope in namespace [http://schemas.xmlsoap.org/soap/envelope/](http://schemas.xmlsoap.org/soap/envelope/). 根元素是命名空间“Envelope”中的“htp://www.w3.org/2003/05/soap-envelope”。”} System.ServiceModel.ProtocolException: {“内容类型 text/xml; 响应消息的 charset=utf-8 与绑定的内容类型不匹配（multipart/related; type="application/xop+xml"）。如果使用自定义编码器，请确保正确实现 IsContentTypeSupported 方法。响应的前 373 个字节是：'env:VersionMismatchunable to locate Envelope in namespace htp://schemas.xmlsoap.org/soap/envelope/。根元素是命名空间“Envelope”中的“htp://www.w3.org/2003/05/soap-envelope”。”}

我进行了更多研究，并将 app.config 中的 messageVersion="Soap12" 更改为 messageVersion="Soap11" 并得到相同的错误。我将 WSMessageEncoding 更改为 TEXT 并得到类似的错误消息（绑定是 application/soap+xml）。我能找到的所有研究似乎都在使用 WCF 服务而不是 java。

任何帮助将不胜感激！贝卡

# service - 从 Windows Azure 流式传输 HLS 内容

> ID：15558047
> 
> 赞同：0
> 
> 时间：2013-03-21T21:02:57.543
> 
> 标签：service, azure, streaming, media, smooth

为了争论，假设我有 5000 个文件已转码为 HLS mp4

我想从 Windows Azure 托管它们，我认为我不能将它们放在 CDN 中，我需要通过 azure 媒体服务托管它们吗？额外费用是多少？

任何想法/HLS教育非常感谢

HC

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T22:44:42.763

Windows Azure 媒体服务使用订阅的存储帐户来存储要发布的媒体文件。因此，在 Windows Azure 中存储视频与将它们存储为 blob 一样昂贵（目前每 GB 大约 0.70c）。但是您需要记住，为流畅的流媒体编码视频意味着以多种分辨率存储它们以适应任何带宽。因此，您提供的流媒体变体越多，它的价格就越贵。

在 blob 存储中托管媒体文件不会为您提供流畅的流媒体功能。您只能以固定传输速率提供渐进式可下载文件（.mp4 文件）。为了提供流畅的流媒体，您需要通过 Windows Azure 媒体服务发布您的资产。他们使用 IIS 功能进行平滑流式处理。通过 WAMS 发布视频没有指定额外费用，因此我希望您按通常的 12c/GB 的出站流量收费。

Windows Azure 媒体服务有特殊费用，很难：

*   编码 1GB 数据需要 1.99 美元
*   拥有一台专门用于编码工作的服务器是 99 美元
*   拥有一个专用于您的流媒体的服务器是 199 美元

有关更多信息，您可能需要查看Windows Azure和[WAMS](http://www.windowsazure.com/en-us/home/features/media-services/)站点的完整[定价计算器。](http://www.windowsazure.com/en-us/pricing/calculator/?scenario=full)

高温高压

# jquery-mobile - jQuery Mobile ListView 项的悬停颜色不正确

> ID：15558050
> 
> 赞同：0
> 
> 时间：2013-03-21T21:03:08.317
> 
> 标签：jquery-mobile

## 环境

*   jQuery 移动 1.3.0
*   Ruby on Rails 3.2.12
*   Chrome 和 Firefox 最新或接近最新版本（如果需要，可以获得确切版本）
*   OS X 狮子 10.8.2

## 问题

在后端使用带有 Rails 的 jQuery Mobile，我得到了一个奇怪的悬停效果，只有列表视图项。下图显示了列表视图项在悬停时的外观。如果我在列表视图项的右侧添加一个图标/按钮，则只有左侧有问题，如第二张图片所示。所有其他具有悬停效果的元素都可以正常工作。

## 证据

没有图标，悬停时（列表视图项）：

![演示列表视图突出显示错误](../Images/7c83a9b2ff3861b09160738e96b6941e.png)

带有图标，悬停时（列表视图项）：

![在此处输入图像描述](../Images/5c7ebe1007f49bc1693c7f9a12be3cd0.png)

带有图标，悬停时（列表视图项目右侧图标）： ![在此处输入图像描述](../Images/0c30c3a9c5d64d01fd28e458fe44c3f4.png)

## 问题

为什么在悬停时，我的列表视图项目会变成难看的黑色，而不是其他所有东西似乎都可以毫无问题地处理的漂亮的悬停渐变（包括列表视图本身的图标/按钮）？

## 代码

以下是我的列表视图的 HAML 模板代码。

```
%ul{"data-filter" => "true", "data-inset" => "true", "data-role" => "listview"}
- @item.subitem.each do |item|
  %li{"data-theme" => "c"}
    %a{"data-prefetch" => "", "data-transition" => "slide", href: edit_item_subitem_path(@item, subitem), :rel => "external"}
      = item.text
      - if item.set
        %span.ui-li-count.ui-btn-up-c
          ✓ 
```

这就是 Rails/HAML 生成的：

```
<ul data-filter='true' data-inset='true' data-role='listview' data-split-icon='gear' data-split-theme='b'>
<li data-theme='c'>
  <a data-transition='slide' href='/items/5' rel='external'>
    Testing
    <span class='ui-li-count ui-btn-up-c'>
      2
    </span>
  </a>
  <a data-theme='c' href='/items/5/edit'>
    <span class='ui-icon ui-icon-gear ui-icon-shadow'></span>
  </a>
</li> 
```

这是 jQuery Mobile 生成的“计算”源代码（我省略了搜索/过滤代码）：

```
<ul data-filter="true" data-inset="true" data-role="listview" data-split-icon="gear" data-split-theme="b" class="ui-listview ui-listview-inset ui-corner-all ui-shadow">
<li data-theme="c" data-corners="false" data-shadow="false" data-iconshadow="true" data-wrapperels="div" data-icon="false" data-iconpos="right" class="ui-btn ui-btn-icon-right ui-li ui-li-has-alt ui-li-has-count ui-first-child ui-last-child ui-btn-up-c">
    <div class="ui-btn-inner ui-li ui-li-has-alt">
        <div class="ui-btn-text">
            <a data-transition="slide" href="/items/5" rel="external" class="ui-link-inherit">
                Testing
                <span class="ui-li-count ui-btn-up-c ui-btn-corner-all">
                    2
                </span>
            </a>
        </div>
    </div>
    <a data-theme="c" href="/items/5/edit" title="" class="ui-li-link-alt ui-btn ui-btn-icon-notext ui-btn-up-c" data-corners="false" data-shadow="false" data-iconshadow="true" data-wrapperels="span" data-icon="false" data-iconpos="notext">
        <span class="ui-btn-inner">
            <span class="ui-btn-text"></span>
            <span data-corners="true" data-shadow="true" data-iconshadow="true" data-wrapperels="span" data-icon="gear" data-iconpos="notext" data-theme="c" title="" class="ui-btn ui-btn-up-c ui-shadow ui-btn-corner-all ui-btn-icon-notext">
                <span class="ui-btn-inner">
                    <span class="ui-btn-text">
                    </span>
                    <span class="ui-icon ui-icon-gear ui-icon-shadow">&nbsp;</span>
                </span>
            </span>
        </span>
    </a>
</li>
</ul> 
```

## 谢谢

提前致谢，如果您需要任何其他信息，请告诉我。另外，我没有标记这个 Rails，因为我认为它与 Rails 无关，但如果我应该这样做，或者它最终成为根本原因，我会这样标记它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T20:52:48.447

好吧，事实证明，当我最初使用`rails scaffold`cli 命令对应用程序进行原型设计时，我不小心留下了脚手架.css.scss。那是造成问题的原因。

# android - 如何做方法 onPostExecute 启动新的 Activity

> ID：15558059
> 
> 赞同：0
> 
> 时间：2013-03-21T21:03:41.340
> 
> 标签：android, android-asynctask

我有一项任务执行方法 doInBackground 并返回一个布尔值。我想要的是启动一个新的 Intent 但方法 startActivity 不可用。我怎样才能做到这一点？

我的任务：

```
 public class LoginTask extends AsyncTask<String, Integer, Boolean> {

            @Override
            protected Boolean doInBackground(String... params) {

                 boolean sucess;

                 //do some stuff

                 return sucess;
            }

    @Override
        protected void onPostExecute(Boolean result) {

            if (result) {
                //startActivity(new Intent(this, MainViewActivity.class));
                            //it doesn't find startActivity
            }
        }
        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T21:09:07.717

在构造函数中传递启动 AsyncTak 的 Activity

```
public class LoginTask {
    private Context mCtx;

    public LoginTask(Context ctx){
        mCtx = ctx;
    }

    ....

    @Override
    protected void onPostExecute(Boolean result) {
        if (result) {
            mCtx.startActivity(new Intent(mCtx, MainViewActivity.class));
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T21:38:19.173

关于之前回复的备注：请记住不要[泄露您的活动](http://www.androiddesignpatterns.com/2013/01/inner-class-handler-memory-leak.html)。使用`WeakReference`类：

```
public static class LoginTask extends AsyncTask<String, Integer, Boolean> {
    WeakReference<Activity> mActivityReference;

    public LoginTask(Activity activity){
        this.mActivityReference = new WeakReference<Activity>(activity);
    }

    @Override
    protected Boolean doInBackground(String... params) {

         boolean sucess;

         //do some stuff

         return sucess;
    }

    @Override
    protected void onPostExecute(Boolean result) {
        if (result && mActivityReference.get() != null) {
            Activity activity = mActivityReference.get();
            activity.startActivity(new Intent(activity, MainViewActivity.class));
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-21T21:12:21.477

您需要使用对产生它的活动或上下文的引用来创建任务。

```
public class LoginTask extends AsyncTask<String, Integer, Boolean> {
    Activity mActivity;

    public LoginTask(Activity activity){
        this.mActivity = mActivity;
    }

    @Override
    protected Boolean doInBackground(String... params) {

         boolean sucess;

         //do some stuff

         return sucess;
    }

    @Override
    protected void onPostExecute(Boolean result) {
        if (result) {
            mActivity.startActivity(new Intent(mContext, MainViewActivity.class));
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T21:11:01.183

您确定 startActivity 不可用吗？我刚刚对其进行了测试，它对我来说很好用。

我认为你应该替换你的行中的**this**，因为 this 不是指 Activity，它指的是 ASyncTask。

```
 startActivity(new Intent(getApplicationContext(), MainViewActivity.class)); 
```

那应该行得通。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-21T21:11:57.917

`this`onPostExecute() 内部指的是 AsyncTask 类实例。改用`YourActivityName.this`：

```
startActivity(new Intent(ParentActivity.this, MainViewActivity.class)); 
```

# crystal-reports - Crystal Reports - 在第一页上隐藏页眉

> ID：15558060
> 
> 赞同：6
> 
> 时间：2013-03-21T21:03:45.323
> 
> 标签：crystal-reports, crystal-reports-2010

我有一份报告需要在第 1 页显示报告标题，并在后续页面上显示不同的标题。

这看起来很简单；如果我添加`pagenumber=1 and goupnumber=1`到第二个标题的抑制公式，它只会在第一页之后显示。但是，该报告还应该在一个组中多次重置页数，从而留下几个符合这些条件的页面。

Crystal 报表中是否有另一个字段可以为第一页具有唯一值？或者我还有其他方法可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-12-19T16:32:31.023

您必须在*选择专家 - 抑制公式*中指定以下公式：

```
PageNumber = 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-09T05:44:08.443

在抑制公式中尝试这个公式 Drilldowngrouplevel = 1 ;

或者

页码=总页数

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-09-28T12:11:04.903

您必须在选择专家 - 第二个标题 - 抑制公式中指定以下公式：

页码 <> 1

# php - 处理 facebook 响应时出现意外的令牌功能

> ID：15558064
> 
> 赞同：0
> 
> 时间：2013-03-21T21:03:50.920
> 
> 标签：php, javascript, facebook-graph-api

这是我的代码

```
 echo '<script type="text/javascript"> 
     FB.init({
          appId   : "myappid",
          channelUrl : "//www.mysite/channel.html",
          status  : true, // check login status
          cookie  : true, // enable cookies to allow the server to access the session
          xfbml   : true // parse XFBML
        });
    FB.getLoginStatus(function(response) {
    if (response.status === "connected") {

    FB.api(
  "me/bookvote:download",
  "post",
  {
    book: "http://samples.ogp.me/199815506812566",
    fb:explicitly_shared = "true"
  }

 function(response) {
  if (!response || response.error) {
     alert("Error occured" + response.error);
   } else {
    alert("Post ID: " + response.id);
    }
    }
 )

   // else {
   //do nothing since user did not authorize
  // alert("I am an alert box!");

    // }
    }
    }
    )

    </script>'; 
```

当我添加时，我在控制台中遇到的错误是 Unexpected token function

```
 function(response) {
  if (!response || response.error) {
     alert("Error occured" + response.error);
   } else {
    alert("Post ID: " + response.id);
    }
    }
 ) 
```

facebook 在这里[https://developers.facebook.com/docs/reference/javascript/FB.api/](https://developers.facebook.com/docs/reference/javascript/FB.api/)演示了这一点，这些帖子没有发布到开发人员的 faecbook 墙上，所以我需要处理响应以查看哪些错误消息facebook 正在打印是否有另一种方法来处理响应？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T21:09:47.650

有一些缩进：

```
FB.init({
    appId: "myappid",
    channelUrl: "//www.mysite/channel.html",
    status: true, // check login status
    cookie: true, // enable cookies to allow the server to access the session
    xfbml: true // parse XFBML
});
FB.getLoginStatus(function (response) {
    if (response.status === "connected") {
        FB.api("me/bookvote:download", "post", {
            book: "http://samples.ogp.me/199815506812566",
            fb: explicitly_shared = "true" //? Is syntactically valid but creates a global
        } //Missing a , here?

        function (response) {
            if (!response || response.error) {
                alert("Error occured" + response.error);
            } else {
                alert("Post ID: " + response.id);
            }
        })

    }
}) 
```

# jquery - jQuery过滤功能导致无响应的脚本

> ID：15558070
> 
> 赞同：1
> 
> 时间：2013-03-21T21:04:25.450
> 
> 标签：jquery, loops, indexof, each

我有一个列出产品类别的网站。

使用 jQuery，我正在查看每个产品的标题链接并过滤掉任何带有“销售”、“清仓”或“新”字样的内容。

然后，根据我收到的结果，我在产品缩略图上添加“销售”、“清仓”或“新”横幅图像。

当我的脚本在标题链接中只找到 1 或 2 个带有这些词的产品时，这似乎工作得很好，但是如果我尝试在一个页面上运行我的脚本，比如说 20 个产品，我的浏览器会冻结并且我得到一个无响应的脚本警告。

有人会介意看看我下面的代码，看看我是在哪里引起这个问题的吗？据我所知，似乎我试图在每个结果中多次叠加“横幅”图像，我相信这是导致我的脚本变得无响应的原因。

这是我的 jQuery 代码：

```
// Set CSS position to relative for each thumbnail container
$('.ProductImage').css('position','relative');
// Find the title for each product on the page
var $title = $('div.product a.title');

// START SALE PRODUCTS
var theSaleTitle = $($title);
// Search for all SALE products by finding the word "sale" in the title element
var iSale = $(theSaleTitle).filter(function() {
    return $(this).text().trim().toLowerCase().indexOf('sale') != -1;
});
$(iSale).each(function(){
    // Select each matching title element's parent
    var parentSale = $(iSale).parent();
    // Select the thumbnail image for each parent
    var Sale = $('a img', parentSale);
    // Insert "SALE" ribbon before each thumbnail for products with "sale" in the title element
    $(Sale).each(function() {;
        $('a img', parentSale).before("<img style='position:absolute;top:-3px;left:-3px;border:0;' src='/content/images/sale-ribbon.png'/>");
    });
    // Remove the word "Sale" from the product title for each sale product
    $(this).html($(this).html().replace(/sale/ig,''))
});
// END SALE PRODUCTS 
```

这是我的示例 HTML 代码：

```
<div class="product">
    <a href="#"></a><div data-product="4318" class="ProductImage QuickView" style="position: relative;"><a href="#">
    </a><a href="/sigep-black-mega-flag-tee/"><img alt="SigEp Black Mega Flag Tee" src="/products/4318/images/2369/052183__14662.1363380086.230.230.jpg"></a>
    <div class="QuickViewBtn" style="background: -moz-linear-gradient(center top , rgb(247, 247, 247), rgb(220, 219, 219)) repeat scroll 0% 0% transparent; color: rgb(0, 0, 0); display: none; margin: 0px; top: 96.5px; left: 60px;" data-product="4318">Quick View</div>
</div>

<a class="title " href="/sigep-black-mega-flag-tee/">sale SigEp Black Mega Flag Tee</a>
<span class="price">$19.95</span>

</div> 
```

如果我可以提供任何进一步的信息来帮助解决问题，请告诉我，感谢您的关注！

更新：如要求，我已将我的代码缩短为 1 个产品的较小示例，并在产品标题链接中仅搜索“销售”一词。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T21:39:58.643

我不明白你为什么要使用这样的选择器。您编写 jQuery 代码的方式可能存在性能问题。为什么不尝试这样的事情：

```
// Set CSS position to relative for each thumbnail container
$('.ProductImage').css('position','relative');

// Search for all SALE products by finding the word "sale" in the title element
$('div.product a.title').each(function() {
    if ($(this).text().toLowerCase().indexOf('sale') != -1) {
        $(this)
            .parent()
            // Select the thumbnail image for each parent
            .find('a img')
            // Insert "SALE" ribbon before each thumbnail for products with "sale" in the title element
            .before("<img style='position:absolute;top:-3px;left:-3px;border:0;' src='/content/images/sale-ribbon.png'/>");
        // Remove the word "Sale" from the product title for each sale product
        $(this).html($(this).html().replace(/sale/ig,''))
    }
});
// END SALE PRODUCTS 
```

您不需要对元素进行两次迭代。第一次用于过滤，第二次用于应用更改。

你不需要那么多变量和奇怪的选择器。使用链接并了解何时可以使用一个 jQuery 函数将操作应用于多个元素。

# sql - 使用 WHILE 循环的 SQL Server 批量删除不起作用

> ID：15558073
> 
> 赞同：23
> 
> 时间：2013-03-21T21:04:33.673
> 
> 标签：sql, sql-server, rowcount

我有一个非常大的表，所以我使用以下内容来删除旧条目：

```
WHILE (@@ROWCOUNT > 0)
BEGIN
    DELETE TOP (5000) FROM myTable
    WHERE date < 20130103
END 
```

我已经使用不同的日期运行了几次。有时它可以正常工作（大约需要 20 分钟），但有时查询会立即完成并且没有任何内容被删除。发生这种情况时，我只需从该表中执行一个简单的 SELECT 语句，然后再次尝试上面的 WHILE 语句，然后它就可以工作了！有谁知道这是为什么？我需要自动执行此查询以定期运行以控制表大小，但我想确保它在运行时正确删除。谢谢你。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2013-03-21T21:09:52.003

在这段代码之前你在运行什么？ `@@ROWCOUNT`将设置为执行它的任何语句.. 如果您事先运行其他命令，它可能是`0`.

相反，您可以强制初始计数为`1`：

```
DECLARE @Rows INT
SET @Rows = 1

WHILE (@Rows > 0)
BEGIN
    DELETE TOP (5000) FROM myTable
    WHERE date < 20130103

    SET @Rows = @@ROWCOUNT
END 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-03-21T21:08:06.407

据推测，原因是因为`@@ROWCOUNT`被初始化为0的值。

您可以先运行此查询来设置它：

```
select count(*) from myTable where date < 20130103 
```

这会为您的查询增加一点时间，但您会看到被删除的行数。

您还可以执行以下操作：

```
select top 1     * from myTable 
```

这会快得多。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-03-21T21:11:35.167

这是因为有时`@@ROWCOUNT`从零开始 - 所以`while`循环永远不会执行，因为它在每次执行*之前*检查条件，包括第一个。

这是一个自制的`do-while`循环，因为 SQL Server 没有内置循环。

```
loop:
   DELETE TOP (5000) FROM myTable
   WHERE date < 20130103
if @@ROWCOUNT > 0 goto loop 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2018-09-06T22:10:15.623

当我批量删除时，我添加了一个等待延迟（至少 1 或 2 秒）。也是我在循环外创建的第一条语句。顺便说一句，避免使用 ROWCOUNT 作为分隔符（[https://docs.microsoft.com/en-us/sql/t-sql/statements/set-rowcount-transact-sql?view=sql-server-2017](https://docs.microsoft.com/en-us/sql/t-sql/statements/set-rowcount-transact-sql?view=sql-server-2017)）。有两种选择：

```
DECLARE @BatchSize BIGINT = 50000
SET ROWCOUNT @BatchSize

DELETE 
FROM myTable 
WHERE 
date < 20130103

WHILE (@@ROWCOUNT > 0)
BEGIN
WAITFOR DELAY '00:00:02'
DELETE 
FROM myTable 
WHERE 
date < 20130103
END 
```

或者

```
DECLARE @BatchSize BIGINT = 50000

WHILE 1=1
BEGIN

    WAITFOR DELAY '00:00:02'

    DELETE TOP(@BatchSize )
    FROM myTable 
    WHERE 
    date < 20130103

    IF @@ROWCOUNT < @BatchSize 
        Break
END 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-08-23T11:14:41.543

基本上，

```
SELECT 0 -- rowcount is 1 
WHILE (@@ROWCOUNT > 0)
BEGIN
    DELETE TOP (5000) FROM myTable
    WHERE date < 20130103
END 
```

或者

```
SET ROWCOUNT 5000 -- set row count to 5000
SELECT 0 -- rowcount is 1 
WHILE (@@ROWCOUNT > 0)
BEGIN
    DELETE FROM myTable
    WHERE date < 20130103
END
SET ROWCOUNT 0  -- set rowcount to unlimited 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-06-18T19:02:10.357

你也可以这样写你的查询：

```
SET ROWCOUNT 5000; -- set batch size
WHILE EXISTS (SELECT 1 FROM myTable WHERE date < '2013-01-03')
BEGIN
    DELETE FROM myTable
    WHERE date < '2013-01-03'
END;
SET ROWCOUNT 0; -- set batch size back to "no limit" 
```

无论哪种方式，您都应该正确格式化您的日期字符串。

只要确保您的删除条件和您的存在子句中的语句相同，否则您可能会遇到无限循环。

# ruby-on-rails - Rails查询输出所有表列数据，只需要图像

> ID：15558075
> 
> 赞同：0
> 
> 时间：2013-03-21T21:04:41.060
> 
> 标签：ruby-on-rails, ruby

我正在执行以下 rails 查询：

```
@related_products = @taxon.product.offset(rand(Spree::Product.count)).limit(7) 
```

然后我试图用这个输出图像：

```
 <ul class="related_products_list">
         <%= @related_products.each do |related_product| %>
         <li class="related_products_item"><%= link_to large_image(related_product, :itemprop => "image", :class => "related_products_image"), url_for(related_product) %></li>
         <% end %>
    </ul> 
```

但是当我输出图像时，它会显示图像以及每个产品的所有表数据的总转储。任何想法为什么？

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T21:07:42.303

改变这个：

```
<%= @related_products.each do |related_product| %> 
```

对此：

```
<% @related_products.each do |related_product| %> 
```

说明：`<%=`呈现其内容，以便将 的内容`@related_products`插入到页面中。

# c++ - MergeSort 打印出奇怪的数字！无法在调试中跟踪

> ID：15558079
> 
> 赞同：0
> 
> 时间：2013-03-21T21:04:59.640
> 
> 标签：c++, mergesort

我做了一个 MergeSort 函数，但它打印出奇怪的数字。当我传入 int arr[12]={5,3,2,7,6,8,9,6,3,5,2,1}; 我得到“123500085000”。我试图在调试器中跟踪我的数组，但对它有点缺乏经验。当我“观察”数组变量时，当它被传递给函数时，值会变成地址。谁能指出我的功能出了什么问题的正确方向？

```
#include <iostream>
using namespace std;

void merge(int arr[], int aux[], int low, int mid, int high)
{
    int leftStart = low;
    int rightStart = mid+1;
    int auxIndex = low;
    int start = low;

while(leftStart<=mid && rightStart<= high)
{
    if(arr[leftStart]>=arr[rightStart])
    {
        aux[auxIndex++] = arr[rightStart++];
    }
    else
        aux[auxIndex++] = arr[leftStart++];
}
if(leftStart>mid)
{
    for(;rightStart<=high; rightStart++)
    {
        aux[auxIndex] = arr[rightStart];
    }
}
if(rightStart>high)
{
    for(;leftStart<=mid; leftStart++)
    {
        aux[auxIndex] = arr[leftStart];
    }
}
for(; start <= high; start++)
    arr[start]=aux[start];
}

void mergeSort(int arr[], int aux[], int low, int high)
{
    int mid;
    if(low<high)
    {
    mid=(low+high)/2;
    mergeSort(arr, aux, low, mid);
    mergeSort(arr, aux, mid+1, high);
    merge(arr,aux, low, mid, high);
    }
}

int main() {
int arr[12]={5,3,2,7,6,8,9,6,3,5,2,1};
int aux[12]={0,0,0,0,0,0,0,0,0,0,0,0};
mergeSort(arr, aux, 0, 11);
for(int i = 0; i<12; i++)
    cout<<arr[i];
    cout<<endl;
for(int i = 0; i<12; i++)
    cout<<aux[i];
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T21:16:28.760

您在代码中的问题在于以下几点：

```
if(leftStart>mid)
{
  for(;rightStart<=high; rightStart++)
  {
    aux[auxIndex] = arr[rightStart]; //wrong
    aux[auxIndex++] = arr[rightStart];
  }
}

if(rightStart>high)
{
  for(;leftStart<=mid; leftStart++)
  {
    aux[auxIndex] = arr[leftStart]; //wrong again
    aux[auxIndex++] = arr[leftStart];
  }
} 
```

您必须增加`aux`数组的索引。更正后，我得到：

```
1 2 2 3 3 5 5 6 6 7 8 9

1 2 2 3 3 5 5 6 6 7 8 9 
```

通过在两个数组的每个元素后添加一个空格。

# routes - 未找到 Laravel RESTful 控制器方法

> ID：15558083
> 
> 赞同：0
> 
> 时间：2013-03-21T21:05:20.687
> 
> 标签：routes, laravel, restful-url, laravel-4

我无法让我的控制器收听 DELETE 请求。当我向 /api/players/1 发送 DELETE 请求时，我得到了 NotFoundHttpException。这是我的 routes.php

```
Route::group(array('prefix' => 'api'), function() {

    Route::controller('matches', 'MatchController');
    Route::controller('players', 'PlayerController');
    Route::controller('auth', 'AuthController');

}); 
```

我的播放器控制器

```
class PlayerController extends BaseController {

    public function getIndex() {
        // do something... this works
    }

    public function postIndex() {
        // do something... this works
    }

    public function deleteIndex() {
        // works when I send a DELETE request to /api/players
    }

    public function delete($id = null) {
        // doesn't work!
    }
} 
```

我想我错过了某种秘密词或其他东西......我只是不知道如何捕捉带有 id 的 DELETE 请求。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T21:52:47.960

好的...所以现在我将控制器更改为资源控制器...我不完全确定这是否是正确的方法，但它似乎有效！

新路线.php：

```
Route::group(array('prefix' => 'api'), function() {

    Route::resource('matches', 'MatchController');
    Route::resource('players', 'PlayerController');
    Route::resource('auth', 'AuthController');

}); 
```

播放器控制器.php：

```
class PlayerController extends BaseController {

    public function index() {
        // GET /api/players
    }

    public function store() {
        // POST /api/players
    }

    public function destroy($id) {
        // DELETE /api/players/{id}
    }
} 
```

# mongodb - mongodb获取在某个文档之后插入的元素

> ID：15558084
> 
> 赞同：5
> 
> 时间：2013-03-21T21:05:21.020
> 
> 标签：mongodb

我有一个文档，我需要查询 mongodb 数据库以返回在当前文档之后插入的所有文档。

是否有可能以及如何进行该查询？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-21T21:57:39.623

如果您不覆盖默认的 _id 字段，则可以使用该 objectID（请参阅[mongodb 文档](http://docs.mongodb.org/manual/core/object-id/)）按时间进行比较。例如，以下查询将查找插入 curDoc 后插入的所有文档（假设没有覆盖 _id 字段）：

```
>db.test.find({ _id : {$gt : curDoc._id}}) 
```

请注意，这些时间戳不是超细粒度的，如果您想要更细粒度的文档插入时间视图，我鼓励您将自己的时间戳字段添加到您正在插入的文档中，并使用该字段进行此类查询。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-22T06:26:38.967

如果您使用插入时间戳作为参数，您可以像下面这样查询

```
> db.foo.find()
{ "_id" : ObjectId("514bf8bbbe11e483111af213"), "Name" : "abc", "Insert_time" : ISODate("2013-03-22T06:22:51.422Z") }
{ "_id" : ObjectId("514bf8c5be11e483111af214"), "Name" : "xyz", "Insert_time" : ISODate("2013-03-22T06:23:01.310Z") }
{ "_id" : ObjectId("514bf8cebe11e483111af215"), "Name" : "pqr", "Insert_time" : ISODate("2013-03-22T06:23:10.006Z") }
{ "_id" : ObjectId("514bf8eabe11e483111af216"), "Name" : "ijk", "Insert_time" : ISODate("2013-03-22T06:23:38.410Z") }
> 
```

这里我的 Insert_time 对应于文档插入时间，以下查询将为您提供特定 Insert_time 之后的文档，

```
> db.foo.find({Insert_time:{$gt:ISODate("2013-03-22T06:22:51.422Z")}})
{ "_id" : ObjectId("514bf8c5be11e483111af214"), "Name" : "xyz", "Insert_time" : ISODate("2013-03-22T06:23:01.310Z") }
{ "_id" : ObjectId("514bf8cebe11e483111af215"), "Name" : "pqr", "Insert_time" : ISODate("2013-03-22T06:23:10.006Z") }
{ "_id" : ObjectId("514bf8eabe11e483111af216"), "Name" : "ijk", "Insert_time" : ISODate("2013-03-22T06:23:38.410Z") }
> 
```

# c++ - 使用包含 3001 位的极大整数

> ID：15558087
> 
> 赞同：0
> 
> 时间：2013-03-21T21:05:30.130
> 
> 标签：c++

例如，如何使用 1000^1000 的结果进行算术运算？我认为没有一个图书馆可以容纳它，我最多只能看到 100 个数字。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-21T21:07:20.210

使用[任意精度的算术](http://en.wikipedia.org/wiki/Arbitrary-precision_arithmetic)库，如[GMP](http://gmplib.org/)或[Boost.Multiprecision](http://www.boost.org/doc/libs/release/libs/multiprecision/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T21:09:25.297

您正在寻找的是像[GMP](http://gmplib.org/)或[Boost-Multiprecision](http://www.boost.org/doc/libs/1_53_0/libs/multiprecision/doc/html/index.html)或[TTmath](http://www.ttmath.org/)这样的库。

或者，您可能会挑战自己编写一个处理比标准位表示更长的低级表示，并用它进行算术运算。

不过，坚持第一个选项，如果它可以完成您的工作。

# ruby-on-rails - 在 heroku 上将某些 Rails 对象从登台转移到生产数据库

> ID：15558089
> 
> 赞同：1
> 
> 时间：2013-03-21T21:05:35.863
> 
> 标签：ruby-on-rails, ruby-on-rails-3, postgresql, heroku, ruby-on-rails-3.2

我有一个网络应用程序，管理员可以在其中创建通过移动应用程序中的 API 发布和访问的“图书”对象。我们希望允许管理员在暂存环境中创建这些书籍，然后在移动应用程序上对其进行测试后将它们推送到生产数据库。从那里开始，我们希望允许他们在暂存应用程序/数据库上对这些书籍进行编辑，然后在准备好生产时推送它们。我们不希望直接在生产中进行任何编辑。

最好的方法是什么？我最初的想法是使用 SQL 导入/导出。但我想知道是否有更优雅的不引人注目的方式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T03:48:17.630

我会说你以错误的方式处理这个问题。暂存和生产应用程序是管理和测试不同版本代码的好方法，但使用它们来测试和暂存数据，然后对数据进行混洗，并不是最佳选择。

相反，我会在应用程序中为书籍设置“草稿”模式，使它们仅对管理员或测试人员可见。一旦他们对一本书感到满意，他们就可以设置`is_draft`为`false`，然后每个人都可以看到这本书。

# php - Twitter OAuth 两次要求确认

> ID：15558090
> 
> 赞同：0
> 
> 时间：2013-03-21T21:05:36.120
> 
> 标签：php, oauth, twitter

我写了一个脚本，要求 Twitter 授权。如果脚本第一次运行，它将被重定向到 Twitter，然后凭据将保存到 json 文件中。这行得通。但是来自twitter的授权页面将被加载两次。也许有人可以帮助我找到错误。这是脚本：

```
require('./vendor/autoload.php');

use TijsVerkoyen\Twitter\Twitter;

$twitter = new Twitter('xyz', 'xyz');
$response = $twitter->oAuthRequestToken('http://localhost:8888/tweeted-news/oauth-test.php');

$credentials = json_decode(file_get_contents('credentials.json'), true);

if (!isset($credentials['oauth_token'])) {
    $response = $twitter->oAuthAuthorize($response['oauth_token']);
    $response = $twitter->oAuthAccessToken($_GET['oauth_token'], $_GET['oauth_verifier']);
    file_put_contents('credentials.json', json_encode($response));
    var_dump('authorized');
} else {
    $twitter->setOAuthToken($credentials['oauth_token']);
    $twitter->setOAuthTokenSecret($credentials['oauth_token_secret']);
    var_dump('credentials');
}

var_dump($twitter->accountSettings()); 
```

我正在使用这个库[https://github.com/tijsverkoyen/TwitterOAuth](https://github.com/tijsverkoyen/TwitterOAuth)和作曲家。非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T16:50:18.137

删除 else 行。在 var_dump('authorized') 之后，您应该设置 OAuthToken 和 OAuthTokenSecret。所以代码应该是：

```
if (!isset($credentials['oauth_token'])) {
    $response = $twitter->oAuthAuthorize($response['oauth_token']);
    $response = $twitter->oAuthAccessToken($_GET['oauth_token'], $_GET['oauth_verifier']);
    file_put_contents('credentials.json', json_encode($response));
    var_dump('authorized');
    $twitter->setOAuthToken($credentials['oauth_token']);
    $twitter->setOAuthTokenSecret($credentials['oauth_token_secret']);
    var_dump('credentials');
} 
```

# jquery - JQuery 1.9.1 min.js 文件对“in”对象的操作数无效

> ID：15558091
> 
> 赞同：4
> 
> 时间：2013-03-21T21:05:38.957
> 
> 标签：jquery, object

第一次海报和有点初级的开发人员。试图在很多地方寻找答案，但没有具体的，我真的需要帮助。

我正在尝试在此站点 cdms.amctec.net 上安装图像旋转器/滑块 (nivo)。图像旋转器在 FF 中工作正常，但我在 IE 9 和控制台中的所有其他浏览器中收到以下错误消息：

```
SCRIPT5007: Invalid operand to 'in': Object expected *jquery.min.js, line 5 character 1203* 
```

这是我从谷歌提取的脚本，所以我不确定这是一个错误，或者我是否没有通过补丁或其他东西正确调用它。

任何人都可以帮我找出解决方案并使其适用于非 FF 浏览器吗？

谢谢，迈克

* * *

实现代码：

```
<script type="text/javascript">
$(document).ready(function() {

$('#slider').nivoSlider({
    effect: "boxRain", // Specify sets like: 'fold,fade,sliceDown'
    slices: 15, // For slice animations
    boxCols: 8, // For box animations
    boxRows: 4, // For box animations
    animSpeed: 500, // Slide transition speed
    pauseTime: 7000, // How long each slide will show
    startSlide: 0, // Set starting Slide (0 index)
    directionNav: false, // Next & Prev navigation
    controlNav: true, // 1,2,3... navigation
    controlNavThumbs: false, // Use thumbnails for Control Nav
    pauseOnHover: true, // Stop animation while hovering
    manualAdvance: false // Force manual transitions
   /* prevText: 'Prev', // Prev directionNav text
    nextText: 'Next', // Next directionNav text
    randomStart: false, // Start on a random slide
    beforeChange: function(){}, // Triggers before a slide transition
    afterChange: function(){}, // Triggers after a slide transition
    slideshowEnd: function(){}, // Triggers after all slides have been shown
    lastSlide: function(){}, // Triggers when last slide is shown
    afterLoad: function(){} // Triggers when slider has loaded */
    });
});
</script>

<script type="text/javascript">
$(document).ready(function() {
    $('#slider').nivoSlider();
});
</script> 
```

# c# - VS c# 益智游戏

> ID：15558097
> 
> 赞同：-1
> 
> 时间：2013-03-21T21:05:51.223
> 
> 标签：c#, image, class, puzzle

我正在按照本教程制作 ac# 益智游戏，[http://jetgamedev.blogspot.ro/2012/05/lesson-0229-c-lab-4-create-image-puzzle.html](http://jetgamedev.blogspot.ro/2012/05/lesson-0229-c-lab-4-create-image-puzzle.html)。

我的问题是在教程的第 77 步，它找不到任何 PictureBox 类，所以我将 Form1 添加为父类。现在我在第 86 步收到此错误：

```
Cannot implicitly convert type 'PuzzleImage.MyPictureBox' to 'System.Windows.Forms.PictureBox' 
```

问题出在以下几行：

```
picBoxes[i] = new MyPictureBox();
((MyPictureBox)picBoxes[i]).Index = i;
 ((MyPictureBox)picBoxes[i]).ImageIndex = indice[i]; 
```

这是问题源代码的一部分：

```
 private void PlayLevel()
     {
         if (pictureBoxWhole != null)
         {
             groupboxPuzzle.Controls.Remove(pictureBoxWhole);
             pictureBoxWhole.Dispose();
             pictureBoxWhole = null;
         }
         if (picBoxes == null)
         {
             images = new Image[currentLevel];
             picBoxes = new PictureBox[currentLevel];
         }
         int numRow = (int)Math.Sqrt(currentLevel);
         int numCol = numRow;
         int unitX = groupboxPuzzle.Width / numRow;
         int unitY = groupboxPuzzle.Height / numCol;
         int[] indice = new int[currentLevel];
         int i = 0;
         for (i = 0; i < currentLevel; i++)
         {
             indice[i] = i;
             if (picBoxes[i] == null)
             {
                 picBoxes[i] = new MyPictureBox();
                 picBoxes[i].Click += new EventHandler(OnPuzzleClick);

                 picBoxes[i].BorderStyle = BorderStyle.Fixed3D;

             }
             picBoxes[i].Width = unitX;
             picBoxes[i].Height = unitY;

             ((MyPictureBox)picBoxes[i]).Index = i;

             CreateBitmapImage(image, images, i, numRow, numCol, unitX, unitY);

             picBoxes[i].Location = new Point(unitX * (i % numCol), unitY * (i / numCol));
             if (!groupboxPuzzle.Controls.Contains(picBoxes[i]))
                 groupboxPuzzle.Controls.Add(picBoxes[i]);

         }
         suffle(ref indice);
         for (i = 0; i < currentLevel; i++)
         {
             picBoxes[i].Image = images[indice[i]];
             ((MyPictureBox)picBoxes[i]).ImageIndex = indice[i];
         }
     } 
```

感谢您的时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T21:09:44.240

`picBoxes`是一个数组`PictureBox`。每个元素都是 type `PictureBox`。

你有这一行：

```
picBoxes[i] = new MyPictureBox(); 
```

当您尝试分配不兼容的类型时。

如果您将其更改为：

```
picBoxes[i] = new PictureBox(); 
```

它会起作用的。

# vb.net - 数据访问层 - 返回包含两个实体的类型

> ID：15558100
> 
> 赞同：1
> 
> 时间：2013-03-21T21:06:03.073
> 
> 标签：vb.net

请查看我在这里提出的问题中的代码： [数据访问层返回 DataTable](https://stackoverflow.com/questions/14467167/data-access-layer-returns-datatable)。

我有数据传输对象来表示持久实体。例如，假设我在数据库中有一个名为 Customer 的表和一个名为 Order 的表：

CREATE TABLE Customer (ID int, Name VARCHAR(100), Primary Key (ID)) CREATE TABLE Order (ID int, Name VARCHAR(100), Primary Key (ID))

假设我想从数据库中检索链接到客户的所有订单。我可以看到两个选项：

1) 具有如下组合客户和订单的类型（注意订单数组）：

```
Public Class CustomerOrder
    Private _CustomerID As Integer
    Private _Name As String
    Private _OrderID() As Integer

    Public Property CustomerID() As Integer
        Get
            Return _CustomerID
        End Get
        Set(ByVal value As Integer)
            _CustomerID = value
        End Set
    End Property

    Public Property Name() As Integer
        Get
            Return _Name
        End Get
        Set(ByVal value As Integer)
            _Name = value
        End Set
    End Property

    Public Property OrderID() As Integer()
        Get
            Return _OrderID
        End Get
        Set(ByVal value As Integer())
            _OrderID = value
        End Set
    End Property

End Class 
```

2) 返回一个客户对象和一个订单对象列表。Customer 和 Order 会有自己的类型。

我相信选项 1 更好，但是如果类型应该只针对一个数据库表，我会徘徊。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T21:17:36.700

这是一个品味问题，以及你想使用什么**设计模式。**我在我的项目中使用了这两个选项。我可以建议您将您的`Orders`属性创建为一个`generic list`（或`IEnumerable`）`Order`对象，不要初始化它（null），并将其设为只读，这样如果您不必使用它，您就不会浪费内存和处理时间你不会使用的东西。然后当它被访问时，你可以简单地在那里填写。

```
Private _OrderID As Integer()
Public ReadOnly Property OrderID() As Integer()
    Get
        If (_OrderID Is Nothing Or _OrderID.Length = 0) Then
            GetOrders(_CustomerID)
        End If
        Return _OrderID
    End Get
End Property 
```

同样，我相信在这种特定情况下，最适合您的将是最佳选择。如果您只需要 ID，请使用您的整数数组，如果您需要访问订单的其他属性，请使用数组、对象、linq 或任何更适合您的方式。

# bash - Bash 中不区分大小写的比较

> ID：15558101
> 
> 赞同：9
> 
> 时间：2013-03-21T21:06:06.313
> 
> 标签：bash, syntax

我正在尝试在不区分大小写的 while 语句中编写比较。基本上，我只是试图缩短以下内容，以便对用户提出是或否问题提示...

```
while[ $yn == "y" | $yn == "Y" | $yn == "Yes" | $yn == "yes" ] ; do 
```

解决此问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-21T21:09:27.510

```
shopt -s nocasematch
while [[ $yn == y || $yn == "yes" ]] ; do 
```

或者 ：

```
shopt -s nocasematch
while [[ $yn =~ (y|yes) ]] ; do 
```

## 笔记

*   `[[`是一个与命令类似（但比`[`命令更强大）的 bash 关键字。请参阅[http://mywiki.wooledge.org/BashFAQ/031](http://mywiki.wooledge.org/BashFAQ/031)和[http://mywiki.wooledge.org/BashGuide/TestsAndConditionals](http://mywiki.wooledge.org/BashGuide/TestsAndConditionals)
    除非您正在编写 POSIX sh，否则我们建议使用`[[`.
*   `=~`运算符根据右手`[[`扩展正则表达式 (ERE) 计算左手字符串。成功匹配后，`BASH_REMATCH`可用于从模式中扩展匹配组。正则表达式的引用部分变为文字。为了安全和兼容，将正则表达式放入参数中并执行`[[ $string =~ $regex ]]`

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-08-25T17:45:17.893

无需使用 shopt 或正则表达式。最简单快捷的方法（只要你有 Bash 4）：

```
if [ "${var1,,}" = "${var2,,}" ]; then
  echo "matched"
fi 
```

您所做的只是将两个字符串都转换为小写并比较结果。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-21T21:33:15.767

这是一个使用扩展模式而不是正则表达式的答案：

```
shopt -s nocasematch
shopt -s extglob
while [[ $yn = y?(es) ]]; do
  ...
done 
```

请注意，从版本 4.1 开始，始终在条件表达式中`bash`使用扩展模式，因此不需要该行。`[[ ... ]]``shopt`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-21T21:12:45.480

也试试这个：

```
 [[ $yn =~ "^[yY](es)?$" ]] 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-07-30T13:21:35.007

我更喜欢使用`grep -E`or`egrep`简称：

```
while egrep -iq '^(y|yes)$' <<< $yn; do
  your_logic_here
done 
```

这里有`grep`手册的解释：

> -i，--忽略大小写
> 
> 忽略 PATTERN 和输入文件中的大小写区别。（-i 由 POSIX 指定。）
> 
> -q，--安静，--静音
> 
> 安静的; 不要向标准输出写入任何内容。 **如果找到任何匹配项**，即使检测到错误，也会立即以零状态退出。另请参阅 -s 或 --no-messages 选项。（-q 由 POSIX 指定。）

# php - 使用混合身份验证恢复会话

> ID：15558105
> 
> 赞同：2
> 
> 时间：2013-03-21T21:06:21.927
> 
> 标签：php, authentication, session-cookies, hybridauth

我最近在我的网站中实现了 Hybrid Auth，我不得不说它写得很好并且很容易上手。我克服了一些小问题，但是就我的测试而言，基础在那里并且可以正常工作...

但是，在他们的用户指南（[http://hybridauth.sourceforge.net/userguide/HybridAuth_Sessions.html](http://hybridauth.sourceforge.net/userguide/HybridAuth_Sessions.html)）中的持久会话示例下，有些东西我不明白，或者理解他们的意思：

> 为了这个例子，假设我们有一个用户，你的应用程序上的 id 是 $current_user_id，我们将使用一个数据库表来存储混合身份验证会话数据。

因此，为用户存储带有 ID 的信息不是问题，获取它也不是问题，但是当用户在一段时间后重新访问该站点时获取 $current_user_id 是什么意思？我能想到的唯一方法是使用他们的 ID 设置一个 $_COOKIE，因为每个会话 cookie 在注销时都会被销毁。但这真的是他们所暗示的吗？如果是这样，我将不得不提示用户（假设在他们登录后）他们是否要保持登录状态。我对此是否正确，或者系统是否会有其他方式？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-30T02:26:32.333

迟到的答案，但是是的，您应该将用户的内部 ID 存储在 cookie 中，然后使用方法 getSessionData 和 storeSessionData 根据用户的内部 ID 从数据库中存储/获取会话数据。您的应用应与用户的社交登录信息同步。也就是说，如果他注销您的网站，他也会同时注销所有社交登录。如果他不再登录社交登录，除非他重新进行身份验证，否则他不应再登录您的网站。这就是 HybridAuth 为您设置的。

# c# - 比较两个 BitmapImage 以检查它们在 WPF 中是否不同的最快方法

> ID：15558107
> 
> 赞同：5
> 
> 时间：2013-03-21T21:06:41.493
> 
> 标签：c#, wpf, image, bitmap

比较 2 个 BitmapImage 对象的最快方法是什么。一个在 Image Source 属性中，另一个是我在代码中创建的。

我可以使用新的位图图像设置图像源，但它会导致闪烁，因为它会一遍又一遍地设置相同的图像。

如果图像的像素与 Image.Source 中的像素不同，我只想设置图像。

编辑：

AlbumArt 是视图中的图像（在 MVVM 之后）。

一些代码（在视图代码隐藏中运行）：

```
Task.Factory.StartNew(() =>
    {
        while (((App)Application.Current).Running)
        {
            Thread.Sleep(1000);

            Application.Current.Dispatcher.Invoke(new Action(() =>
            {
                if ((this.DataContext as AudioViewModel).CurrentDevice != null)
                {
                    if ((((this.DataContext as AudioViewModel).CurrentDevice) as AUDIO).SupportsAlbumArt)
                    {
                        BitmapImage image = new BitmapImage();
                        image.BeginInit();
                        image.UriSource = new Uri((((this.DataContext as AudioViewModel).CurrentDevice) as AUDIO).AlbumArt);
                        image.CacheOption = BitmapCacheOption.None;
                        image.CreateOptions = BitmapCreateOptions.IgnoreImageCache;
                        image.EndInit();

                        AlbumArt.Source = image;
                        ... 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-21T21:44:23.807

您可以比较 的字节`BitmapImage`以检查它们是否相等

就像是：

```
public static class BitmapImageExtensions
{
    public static bool IsEqual(this BitmapImage image1, BitmapImage image2)
    {
        if (image1 == null || image2 == null)
        {
            return false;
        }
        return image1.ToBytes().SequenceEqual(image2.ToBytes());
    }

    public static byte[] ToBytes(this BitmapImage image)
    {
        byte[] data = new byte[] { };
        if (image != null)
        {
            try
            {
                var encoder = new BmpBitmapEncoder();
                encoder.Frames.Add(BitmapFrame.Create(image));
                using (MemoryStream ms = new MemoryStream())
                {
                    encoder.Save(ms);
                    data = ms.ToArray();
                }
                return data;
            }
            catch (Exception ex)
            {
            }
        }
        return data;
    }
} 
```

用法：

```
BitmapImage image1 = ..............
BitmapImage image2 = ................

if (image1.IsEqual(image2))
{
    // same image
} 
```

# ruby - 测试与字段关联的错误文本

> ID：15558110
> 
> 赞同：0
> 
> 时间：2013-03-21T21:06:59.990
> 
> 标签：ruby, cucumber, capybara, capybara-webkit, gherkin

在 Capybara + Webkit + Ruby 1.9.3 中，我有以下 HTML

当特定字段出现错误时，simple_form 会生成以下内容。我在“获取”错误文本跨度时遇到了麻烦，并且知道我肯定有与“标题”相关联的那个，而不是另一个可能也有错误的字段。

```
 <div class="input-wrapper string required error">
    <div class="input-label">
      <label class="string required" for="event_title">
        <abbr title="required">*</abbr>
        Title
      </label>
      <span class="error-text">can't be blank</span>
      <input id="event_title" class="string required" type="text" value="" size="50" name="event[title]">
  </div> 
```

（当然还有许多其他领域！）

我想测试 Title 实际上是必需的，当用户留空并单击提交按钮时，错误消息“不能为空”存在。除了调整 simple_form 来包裹整个事物之外，有没有办法简单地找到标签，然后转到 DOM 中的下一个元素，看看它是否是一个包含“不能为空白”内容的跨度？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T17:54:40.817

我不确定你真的需要这样做。测试用例应该使得页面上只有一条错误消息。您可以使用其他测试来检查多个错误消息，但应该有一个特定于此场景的测试。这样做然后检查 span.error-text 是否在页面上并且它包含文本不能为空白的测试就足够了。

```
page.should have_selector('span.error-text', text: "can't be blank") 
```

# sql - SQL Server 从多个表编译和计算数据

> ID：15558122
> 
> 赞同：1
> 
> 时间：2013-03-21T21:07:26.697
> 
> 标签：sql, sql-server, sql-server-2005, sql-server-2008-r2

我试图找出我数据库中的订阅者在一天中打开最多电子邮件的时间。

我有一个包含一堆订阅者 ID 的表，我还有另一个表，其中电子邮件打开记录映射到一个表，该表存储已发送的电子邮件，然后映射到特定的订阅者 ID。

所以我的基本愿望是得到一个表格输出，每一行都是一个特定的订阅者（订阅者 ID）以及他们打开最多电子邮件的时间。所以我需要先检查每个订阅者 ID，然后我想创建一个临时表每行是与他们在该小时内打开的电子邮件数量相关的不同小时。然后我需要选择 Max 以从该临时表中获取最大行，然后我需要将其放入我的输出表中，并为下一个订阅者重复。

我只关心一天中的时间。我不在乎月份、年份或时间。我只是想知道人们在一天中的什么时间最常打开电子邮件。

我一直在尝试使用 CTE 和 while 循环，但无济于事。任何帮助将不胜感激。

这是（最小化）结构：

表：订户

| 订阅者 ID | 姓氏 | 名字 |
| 9999999999 | 史密斯 | 约翰 |

表：已发送电子邮件

| message_id | 订阅者 ID |
| 9028340 | 9999999999 |

表：OpenEmails

| open_id | message_id | dtoped |
| 9923489 | 9028340 | '2011-11-22 15:53:02.157' |

我的目标是这样的输出表（最后一列是不必要的），每个subscriber_id 在列表中都是唯一的：

| 订阅者 ID | 开放时间 | 打开次数 |
| 999999999 | 10 | 32 |

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T21:29:46.603

您必须弄清楚如何使用正确的列对其进行调整，以及由于未提供架构而无法解决的问题...

```
With    orderedHourly As
(
        Select  SubscriberID, 
                Convert(Date,OpenDateTime) OpenDate, 
                Hour(OpenDateTime) OpenHour, 
                Row_Number() Over (Partition By SubscriberID, Convert(Date,OpenDateTime) Order By Count(1) Desc) As HourPriority
        From    subscriber s
        Join    email e
                On  s.subscriberID = e.subscriberID
        Group   By SubscriberID, Convert(Date,OpenDateTime), Hour(OpenDateTime)
)
Select  SubScriberID, OpenDate, OpenHour
From    orderHourly
Where   HourPriority = 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T21:57:02.657

我做了一些假设，因为没有包含结构。

这是我使用的结构。

```
CREATE TABLE Subscriber (
    Id int not null identity(1,1),
    SubscriberId varchar(50)
    )
CREATE TABLE EmailOpened (
    OpenDate DateTime,
    EmailId int
    )
CREATE TABLE Emails (
    EmailId int not null identity(1,1),
    SubscriberId varchar(50),
    EmailText varchar(max)
)
GO 
```

这是我最终得到的查询。

```
WITH OpenedByHour AS (
    SELECT 
        SubscriberId,
        DATEPART(YEAR, OpenDate) AS OpenYear,
        DATEPART(DAYOFYEAR, OpenDate) AS OpenDOY,
        DATEPART(HOUR, OpenDate) AS OpenHour,
        COUNT(1) AS OpenCount
    FROM Emails
    JOIN EmailOpened
        ON Emails.EmailId = EmailOpened.EmailId
    GROUP BY 
        SubscriberId,
        DATEPART(YEAR, OpenDate),
        DATEPART(DAYOFYEAR, OpenDate),
        DATEPART(HOUR, OpenDate)
    ),
    MaxOpenedByHour AS (
    SELECT
        SubscriberId,
        OpenYear,
        OpenDOY,
        OpenHour,
        OpenCount,
        Row_Number() Over (Partition By SubscriberId
                Order By OpenCount Desc) AS MaxRow
    FROM OpenedByHour
    )
SELECT SubscriberId,
    OpenYear,
    OpenDOY,
    OpenHour,
    OpenCount
FROM MaxOpenedByHour
WHERE MaxRow = 1 
```

# python - python - 从 /etc/hosts 的每一行获取主机名值

> ID：15558123
> 
> 赞同：3
> 
> 时间：2013-03-21T21:07:28.297
> 
> 标签：python, hosts

我有一个使用 AWS 开发工具包 (PHP) 的 cronjob 来更新 /etc/hosts 文件，该文件写入当前 EC2 私有 IP 以及每个服务器的友好主机名。

在 Python 中，我试图逐行读取 /etc/hosts 文件，然后提取主机名。

示例 /etc/hosts：

```
127.0.0.1              localhost localhost.localdomain
10.10.10.10            server-1
10.10.10.11            server-2
10.10.10.12            server-3
10.10.10.13            server-4
10.10.10.14            server-5 
```

在 Python 中，到目前为止我所拥有的是：

```
 hosts = open('/etc/hosts','r')
    for line in hosts:
        print line 
```

我正在寻找的只是创建一个仅包含主机名（server-1、server-2 等）的列表。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-21T21:10:31.847

```
for line in hosts:
        print line.split()[1:] 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2017-03-24T10:10:17.843

我知道这个问题已经过时并且在技术上已解决，但我只是想我会提到（现在）有一个库可以读取（和写入）主机文件：[https ://github.com/jonhadfield/python-hosts](https://github.com/jonhadfield/python-hosts)

以下将导致与接受的答案相同：

```
from python_hosts import Hosts
[entry.names for entry in hosts.Hosts().entries 
             if entry.entry_type in ['ipv4', 'ipv6'] 
```

与上面的答案不同——公平地说，它超级简单，按照要求做并且不需要额外的库—— `python-hosts`将处理行注释（但不是内联注释）并且具有 100% 的测试覆盖率。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-02-21T23:58:21.273

这应该返回所有主机名，并且也应该处理内联注释。

```
def get_etc_hostnames():
    """
    Parses /etc/hosts file and returns all the hostnames in a list.
    """
    with open('/etc/hosts', 'r') as f:
        hostlines = f.readlines()
    hostlines = [line.strip() for line in hostlines
                 if not line.startswith('#') and line.strip() != '']
    hosts = []
    for line in hostlines:
        hostnames = line.split('#')[0].split()[1:]
        hosts.extend(hostnames)
    return hosts 
```

# java - 使用 java 客户端应用程序将条目添加到 mysql 数据库中

> ID：15558128
> 
> 赞同：1
> 
> 时间：2013-03-21T21:07:48.857
> 
> 标签：java, php, mysql, httpclient

我现在在处理大学网络作业时遇到了一些麻烦。我有一个 php 书店项目，其中包含一个名为“books”的数据库和一个名为“books”的表。我可以在我的 PHP 书店上创建、更新、删除书籍没问题，但大学作业的任务是能够创建一个 HttpClientApp 程序，该程序能够向书店发送 GET 和 POST 添加新书进入数据库。

我不确定我为 HttpClient 和 HttpClientApp 获得的代码是否能够将新书添加到数据库中。我想知道是否有人可以看看他们两个，看看我是否错过了什么？

**这是 MyHttpClient.java 文件的完整代码：** `

```
package com.example.bookstore;
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.PrintWriter;
import java.net.Socket;

public class MyHttpClient {

    /*This creates the method MyHttpResponse execute, with a parameter of MyHttpRequest request which
     * creates a variable called request that stores a reference to the MyHttpRequest object allowing us
     * to use the objects methods in the MyHttpClient.java., we also add the throws IOException which
     * will tell us if we have an error with the input or output in the program
     */
    public MyHttpResponse execute(MyHttpRequest request) throws IOException {

        /*
         * Creates a variable called host of type string which
         * stores reference for the method getHost() which is in
         * the MyHttpRequest object. We then create a variable
         * int port which also stores the reference to the method getPort()
         * from the MyHttpRequest which gives us the port number of the avaya server
         * we are contacting, if it is less than or equal to 0 it will be set to 80 as
         * a default
         */
        String host = request.getHost();
        int port = request.getPort();
        if (port <= 0) {
            port = 80;
        }

        /*
         * Create the variable bookSoc of type Socket and is given the paramters of host and port
         * which is used in creating the socket to connect to the server
         */

        Socket bookSoc = new Socket(host, port);

        /*
        * Declares a variable called response, which allows us to assign the MyHttpResponse object to the
        * response variable. This stores a reference to the MyHttpResponse Object and allows us to reference and use
        * the methods in the MyHttpResponse Object
        */
        MyHttpResponse response = new MyHttpResponse();

        /*
         * Creates the a variable fromServer of type BufferedReader which is given the parameter of new
         * InputStreamReader which then opens up the stream using the bookSoc.getInputStream method.
         */
        BufferedReader fromServer = new BufferedReader(new InputStreamReader(bookSoc.getInputStream()));
        /*The variable toServer of type PrintWriter creates the OutPutStream which allows to output to the
         * Avaya Server
         */
        PrintWriter toServer = new PrintWriter(bookSoc.getOutputStream(), true);
        String method = request.getMethod();

        /*
         * The if statement works by checking if the the Method call equals a GET then
         * create the string path and queryString to print out to the server the path and host
         * which we require
         */
        if (method.equals("GET")) {
            String path = request.getPath();
            String queryString = request.getQueryString();
            toServer.println("GET " + path + " " + "HTTP/1.0");
            toServer.println(queryString);
            toServer.println("GET " + host);
            toServer.println(+port);

            /*
             * Creates a variable called line of type String
             * which will then be used to store the fromServer message, then we creates
             * another var called status of type int which the substring which count the
             * characters given. Then set the Status var equal to 200 OK
             */
            String line;
            line = fromServer.readLine();
            int status = Integer.parseInt(line.substring(9, 12));
            response.setStatus(status);
            String descr = line.substring(13);
            response.setDescription(descr);

            /*
             * Once the above code has been executed the do while do while loop,
             * is then run, the first do while loop reads in a line from the server
             * if the line is not null and line length is greater than 0,
             * creates a name and value var and are added to the header.
             *
             * Then the while  creates a var sbuf of type StringBuilder which
             * creates a new StringBuilder, then the next do while prints out the body of the the
             * repsonse, we then print the host and port number data.
             */
            do {
                line = fromServer.readLine();
                if (line != null && line.length() > 0) {
                    String name = line.substring(0, line.indexOf(": "));
                    String value = line.substring(line.indexOf(": ") + 2);
                    response.addHeader(name, value);
                }
            } while (line != null && line.length() > 0);
            StringBuilder sbuf = new StringBuilder();          
            do {
                line = fromServer.readLine();
                if (line != null) {
                    sbuf.append(line + "\n");
                }

            } while (line != null);
            String body = sbuf.toString();
            response.setBody(body);

            System.out.println("host: " + host);
            System.out.println("port: " + String.valueOf(port));
        } 

        /*
         * if the method call is for the POST then the code below is executed which is
         * executing the same code as the above if statment except for that it is a POST method instead
         * of a GET method.
         */
        else if (method.equalsIgnoreCase("POST")) {

            String path = request.getPath();
            String queryString = request.getQueryString();
            toServer.println("POST " + path + " " + "HTTP/1.0");
            toServer.println();
            toServer.println(queryString);

            String line;
            line = fromServer.readLine();

            int status = Integer.parseInt(line.substring(9, 12));
            response.setStatus(status);

            String descr = line.substring(13);
            response.setDescription(descr);

            do{             
                line = fromServer.readLine();
                if (line != null && line.length() > 0) {

                    String name = line.substring(0, line.indexOf(": "));
                    String value = line.substring(line.indexOf(": ") + 2);
                    response.addHeader(name, value);

                }
            } 
            while (line != null && line.length() > 0);

            StringBuilder sb = new StringBuilder();
            do 
            {
                line = fromServer.readLine();
                if (line != null) {
                    sb.append(line).append("\n");
                }

            } while (line != null);
            String body = sb.toString();

            response.setBody(body);

            System.out.println("host: " + host);
            System.out.println("port: " + String.valueOf(port));

        }
        /*Close the socket*/
        bookSoc.close();
        /*return the response*/
        return response;
    }
} 
```

`

**这是 MyHttpClientApp.java 文件的完整代码：**

`

```
package com.example.bookstore;

import java.io.IOException;
import java.net.URI;
import java.net.URISyntaxException;

public class MyHttpClientApp {

    public static void main(String[] args) {
        String urlString = null;
        URI uri;
        MyHttpClient client;
        MyHttpRequest request;
        MyHttpResponse response;

        try {
            //==================================================================
            // send GET request and print response
            //==================================================================
            urlString = "http://localhost:8888/bookstore/view_books.php";
            uri = new URI(urlString);
            client = new MyHttpClient();

            request = new MyHttpRequest(uri);
            request.setMethod("GET");
            response = client.execute(request);

            System.out.println("=============================================");
            System.out.println(request);
            System.out.println("=============================================");
            System.out.println(response);
            System.out.println("=============================================");

            //==================================================================
            // send POST request and print response
            //==================================================================
            urlString = "http://localhost:8888/bookstore/view_books.php";
            uri = new URI(urlString);
            client = new MyHttpClient();

            request = new MyHttpRequest(uri);
            request.setMethod("POST");
            request.addParameter("title", "Fringe");
            request.addParameter("firstName", "JJ");
            request.addParameter("lastName", "Abrams");
            request.addParameter("ISBN", "987654321349211");
            request.addParameter("publisher", "Sci-fi");
            request.addParameter("year", "2010");
            request.addParameter("price", "19.99");
            response = client.execute(request);

            System.out.println("=============================================");
            System.out.println(request);
            System.out.println("=============================================");
            System.out.println(response);
            System.out.println("=============================================");
        } catch (URISyntaxException e) {
            String errorMessage = "Error parsing uri (" + urlString + "): " + e.getMessage();
            System.out.println("MyHttpClientApp: " + errorMessage);
        } catch (IOException e) {
            String errorMessage = "Error downloading book list: " + e.getMessage();
            System.out.println("MyHttpClientApp: " + errorMessage);
        }
    }
} 
```

`

我很清楚我可能会提出一个模糊的问题，所以请随时要求我发布更多代码等。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T21:28:30.853

您的 java 代码看起来不错，但我会从客户端解决很多问题，只需使用 HttpURLConnection 实用程序，而不是自己做所有事情： [http ://docs.oracle.com/javase/7/docs/api /java/net/HttpURLConnection.html](http://docs.oracle.com/javase/7/docs/api/java/net/HttpURLConnection.html)

粘贴您的服务器端代码 (php) 进行验证。您的服务器也不需要任何 GET 或 POST 参数吗？因为现在你的请求是空的，这很好，只要确保你没有忘记发送一些东西。

# verilog - Cadence Hal 掉毛

> ID：15558130
> 
> 赞同：0
> 
> 时间：2013-03-21T21:07:59.307
> 
> 标签：verilog

因此，在运行 linting 时，您可以编写自己的排除文件。在此文件中，您可以指定模块名称，它将排除模块及其使用的所有模块。所以假设我有 *top_old* 和 *top_new*。他们使用一些相同的模块，但我想排除 *top_old* 相互文件也将被排除，这不是我想要的。

我只想排除文件 top_old 而不是它使用的所有文件。

因此，当您创建您使用的排除文件时：

```
designunit = top_old; 
```

（这是模块名称）

我想知道是否有办法：

```
file = top_old.v; 
```

并让它只排除文件而不是别的

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T08:34:20.593

好的，最好的方法如下：

无论您在哪里`bb_list{...}`包含一个部分`gb_list{...}`

所以文件看起来像这样

```
bb_list{

   designunit = dut;

}

gb_list{

   designunit = dut2;

} 
```

dut2 将从 linting 中排除，但它实例化的所有模块仍将被 linting。

# python - 获得直方图的最大 y 值

> ID：15558136
> 
> 赞同：15
> 
> 时间：2013-03-21T21:08:07.043
> 
> 标签：python, matplotlib

我正在寻找有关如何计算直方图的最大 y 值的建议。

```
#simple histogram. how can I obtain the maximum value of, say, x and y?

import matplotlib.pyplot as plt
hdata = randn(500)
x = plt.hist(hdata)
y = plt.hist(hdata, bins=40) 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-03-21T21:45:26.970

`hist`返回一个包含直方图 bin 位置和 y 值的元组。试试这个：

```
y, x, _ = plt.hist(hdata)

print x.max()
print y.max() 
```

请注意`len(y) = len(x) - 1`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2020-03-25T20:04:56.877

如果您还想知道该间隔开始的相应 x 坐标，请按照@tiago 的建议添加：

```
 x[np.where(y == y.max())] 
```

# php - 从正确定义的 PHP 对象属性中获取 0（零）

> ID：15558138
> 
> 赞同：1
> 
> 时间：2013-03-21T21:08:11.443
> 
> 标签：php, object, properties, dump, zero

我有一个存储在 var 中的 PHP 对象，`$category`它具有以下属性（用 转储`print_r()`）：

```
jstandCategory Object
(
    [category_id] => 1
    [category_image] => 
    [category_parent_id] => 0
    [category_publish] => 1
    [category_ordertype] => 1
    [category_template] => default
    [category_ordering] => 1
    [category_add_date] => 2013-03-18 22:10:45
    [cars_page] => 6
    [cars_row] => 1
    [name_en-GB] => Used Cars
    [alias_en-GB] => used-cars
    [short_description_en-GB] => 
    [description_en-GB] => <table>... some html code ...</table>
) 
```

但是，当我尝试使用i get转储`name_en-GB`属性时。我究竟做错了什么？上面的属性被转储得很好。`print_r($category->name_en-GB);``0``name_en-GB`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T21:10:41.753

PHP将其理解为`$category->name_en`- `GB`（数学运算），一种`NULL - NULL`情况，为0。

最好不要在属性名称中使用连字符。如果您愿意，请使用下划线或驼峰式。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T21:09:40.757

```
- is an operator don't use it in variable names 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-21T21:11:11.143

您正在使用带有无效字符的属性名称，您需要将名称用大括号括起来才能被识别

```
print_r($category->{'name_en-GB'}); 
```

如果您更改命名策略会更好

# jquery - 如何将 html 字形标记添加到 JQuery 显示/隐藏功能

> ID：15558142
> 
> 赞同：0
> 
> 时间：2013-03-21T21:08:33.103
> 
> 标签：jquery, html, css

我有一个非常基本的显示/隐藏功能，可以上下滑动粘性标题以显示更多内容。当容器打开或关闭时，我已经设法让触发器将文本更改为适当的措辞，但我还想在附加的文本中添加一个向上箭头和向下箭头字形。如何做到这一点？

> 我正在寻找的输出应该是这样的：
> ↓展开播放列表
> ↑关闭播放列表

以下是我的标记到目前为止的样子：

**HTML**

```
<div id="sticky_header">
    <div id="sticky_content" class="player">
        <a href="#" id="toggle_sticky_header">Expand Playlist</a>
    </div>
</div> 
```

**CSS**

```
/* 
-------------------------------------------------------------------------
Sticky Header
-------------------------------------------------------------------------
*/

#sticky_header {
    background-color: #000000;
    /* border-bottom: 5px solid #B54000; */
    border-bottom: 5px solid #0995B0;
    /* height: 100px; */
    height: 600px;
    min-width: 100%;
    width: 100%;
    position: fixed;
    top: -500px;
    left: 0px;
    z-index: 2000;

    box-shadow: 0px 1px 15px #000000;
    -moz-box-shadow: 0px 1px 15px #000000;
    -webkit-box-shadow: 0px 1px 15px #000000;
}

#sticky_content {
    margin: 0px auto;
    width: 990px;
    padding: 15px 0px;
    color: #FFFFFF;
    position: relative;
}

a#toggle_sticky_header {
    position: absolute;
    bottom: -560px;
    right: 0px;
    color: #0995B0;
    font-size: 10px;
    line-height: 10px;
    text-transform: uppercase;
} 
```

**查询**

```
<!-- Toggle sticky header -->
<script type="text/javascript">
$(document).ready(function(){

    $('#toggle_sticky_header').click(function(){
        if($("#sticky_header").css("top") == "-500px") {
          $("#sticky_header").animate({top: "0px"}, 500);
        } else {
          $("#sticky_header").animate({top: "-500px"}, 500);
        }

        $(this).toggleClass("active"); 

        if ($(this).html() == "Expand Playlist") {
            $(this).html("Close Playlist");
        }
        else if ($(this).html() == "Close Playlist") {
            $(this).html("Expand Playlist");
        }

        return false;
    });

});
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T21:10:34.207

鉴于您正在使用`html()`，您可以简单地使用 html 实体：

```
if ($(this).html() == "Expand Playlist") {
    $(this).html("&uarr; Close Playlist");
}
else if ($(this).html() == "Close Playlist") {
    $(this).html("&darr; Expand Playlist");
} 
```

虽然我建议稍作修改：

```
$(this).html(function(i,h){
    return h == '&darr; Expand Playlist' ? '&darr; Expand Playlist' : '&uarr; Expand Playlist'
}); 
```

参考：

*   [HTML 符号实体](http://www.webstandards.org/learn/reference/charts/entities/symbol_entities/)。

# css - 可能的不透明度 Z 索引错误

> ID：15558148
> 
> 赞同：4
> 
> 时间：2013-03-21T21:08:55.440
> 
> 标签：css, opacity

在网页上设置不透明度时，我遇到了一个非常奇怪的问题。具有不透明度的元素会遮盖页面上的其他元素。这在 Safari、Chrome 和 Firefox 中会发生。在 IE7 和 8 中忽略不透明度。未在 IE9 上测试。

[小提琴](http://jsfiddle.net/V4MrH/)

```
<style>
   #content { opacity: .92; background: #dfd; height: 300px;}
   #sidebar { width: 200px; float: right; background: #fdd; height: 200px; }
</style>
<div id="sidebar"></div>
<div id="content"></div> 
```

删除不透明度会恢复预期的行为。另一个可能的解决方法是使用 rgba 背景值而不是不透明度。

有人遇到过这种情况么？如果是这样，你是如何解决的？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-21T21:21:39.603

您设置的不透明度正在`#content`创建一个新的[stacking context](https://developer.mozilla.org/en-US/docs/CSS/Understanding_z-index/The_stacking_context)，并且 stacking contexts 会影响 z-indexes。由于您没有手动指定 z-indexes，因此它们是自动分配的，并且`#content`具有比`#sidebar`标记中稍后出现的值更高的值。

一个简单的 CSS 解决方案：只需添加`position: relative; z-index: 2`到`#sidebar`（以建立另一个堆叠上下文）。`#content`在您的真实代码中，如果您在下面有更多元素，您可能还需要添加一个 z-index `#wrapper`：

```
#sidebar { position: relative; z-index: 2; /* etc */ } 
```

[http://jsfiddle.net/V4MrH/3/](http://jsfiddle.net/V4MrH/3/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-21T21:14:37.067

这个问题已经知道了。 [https://www.google.com/#q=opacity%20change%20z-index](https://www.google.com/#q=opacity%20change%20z-index)

您应该使用 rgba 背景，这也是一个广泛支持的属性。

# windows - sc qprivs 空白权限

> ID：15558150
> 
> 赞同：1
> 
> 时间：2013-03-21T21:08:57.110
> 
> 标签：windows, privileges

运行以下命令时，我收到此输出：

> SERVICE_NAME：AdobeARM 服务

```
 PRIVILEGES       : 
```

> [SC] QueryServiceConfig2 成功

我的问题是 Adob​​eARMservice 有什么样的权限？似乎没有……但不可能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T01:27:33.887

实际上，我不确定 Adob​​e ARM 服务是否需要任何特权。本地系统令牌始终包括管理员组，该组被明确授予访问大多数文件和注册表项的权限。系统任务通常需要特权，例如加载设备驱动程序、查看安全审计日志或更改时区。服务所需的最常见特权可能是“模拟客户”，但在这种情况下不适用。我想它可能想要“关闭系统”，以便它可以在安装更新后启动重新启动。

但是，碰巧的是，如果没有配置权限列表，则服务会获得与安全原则相关的所有权限，在这种情况下是大多数权限。

引用[MSDN (SERVICE_REQUIRED_PRIVILEGES_INFO)](http://msdn.microsoft.com/en-us/library/windows/desktop/ms685976%28v=vs.85%29.aspx)：“如果您没有设置所需的权限，SCM 将使用默认分配给进程令牌的所有权限。”

我刚刚检查过，对于未设置所需权限列表的服务，`sc qprivs`确实显示了一个空列表，如您的问题所示。如果我没记错的话，显式设置一个空列表具有相同的效果。如果该服务不想要任何特权，它将设置一个只有一项的列表，即 SeChangeNotifyPrivilege，无论如何每个人都会得到它。

# ios - 我应该什么时候调用 CVPixelBufferLockBaseAddress 和 CVPixelBufferUnlockBaseAddress？

> ID：15558153
> 
> 赞同：1
> 
> 时间：2013-03-21T21:09:07.577
> 
> 标签：ios, opengl-es-2.0, avfoundation, gpuimage

在 iOS6 中，我使用 OpenGL 对 AVFoundation 视频帧进行渲染。我见过很多使用 CVPixelBufferLockBaseAddress 和 CVPixelBufferUnlockBaseAddress 的示例代码，但我不清楚我何时执行锁定和解锁或为什么要这样做。CPU修改内存时我应该锁定地址吗？或者当 GPU 正在读取它时我应该锁定它吗？我应该什么时候解锁？为什么我什至想解锁？我已经看过[这个 Stack Overflow 答案](https://stackoverflow.com/questions/6468535/cvpixelbufferlockbaseaddress-why-capture-still-image-using-avfoundation)，但它并没有完全回答我的问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-22T06:50:57.870

您应该在每次需要使用它时锁定它，并在使用完并且不再需要它时解锁。这可以防止缓冲区被覆盖，从而使其处于不一致的状态。

一位固件专家曾经给我解释过：一般来说，在处理视频输出的时候，你应该注意有很多带有指针的间接引用，这就像在说：“嘿，这是我的，我正在使用它，指向下一个在其他地方框架”。

我无法根据您的应用程序判断何时不再需要缓冲区，但这是您应该能够弄清楚的。如果您已将缓冲区数据复制到其他地方（例如创建新对象），则意味着您可以解锁它。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-06-19T21:28:27.933

你应该只在你想访问 CPU 上的像素缓冲区的情况下调用这个函数，在 GPU 的情况下不要这样做！，Apple doc 对此非常清楚。

以下是来自苹果官方文档的信息：

[https://developer.apple.com/library/prerelease/ios/documentation/QuartzCore/Reference/CVPixelBufferRef/index.html#//apple_ref/c/func/CVPixelBufferLockBaseAddress](https://developer.apple.com/library/prerelease/ios/documentation/QuartzCore/Reference/CVPixelBufferRef/index.html#//apple_ref/c/func/CVPixelBufferLockBaseAddress)

您必须在 CPU 访问像素数据之前调用 CVPixelBufferLockBaseAddress 函数，然后再调用 CVPixelBufferUnlockBaseAddress 函数。如果在锁定缓冲区时在 lockFlags 参数中包含 kCVPixelBufferLock_ReadOnly 值，则在解锁缓冲区时也必须包含它。

**重要的**

**使用 GPU 访问像素数据时**，锁定不是必需的，并且会降低性能。

# grails - 无法在 Grails 上将 Cucumber 与 Geb 集成

> ID：15558162
> 
> 赞同：1
> 
> 时间：2013-03-21T21:09:42.243
> 
> 标签：grails, cucumber, geb

我正在尝试设置 Grails (2.2) + Cucumber (0.8.0) + Geb (0.9.0-RC-1) 环境，但我的 Cucumber 步骤定义没有找到 Geb 页面 - 因此，我得到了很多缺少属性异常：

```
| Server running. Browse to http://localhost:8080/weddo
| Compiling 3 source files.
| Running 13 cucumber tests...
groovy.lang.MissingPropertyException: No such property: page for class: WishlistStepDefinitions
    at WishlistStepDefinitions$_run_closure5.doCall(WishlistStepDefinitions.groovy:68)
    at ?.Then the total gifted amount should be 0(ChoosingGift.feature:14)
groovy.lang.MissingMethodException: No signature of method: WishlistStepDefinitions.wishAmountsFromCategory() is applicable for argument types: (java.lang.Integer) values: [1]
    at WishlistStepDefinitions$_run_closure6.doCall(WishlistStepDefinitions.groovy:72)
    at ?.And I write "1" on every wish on the 1 category(ChoosingGift.feature:25)
groovy.lang.MissingMethodException: No signature of method: WishlistStepDefinitions.namedWishAmountFromCategory() is applicable for argument types: (java.lang.String, java.lang.Integer) values: [wish_1_2, 0]
    at WishlistStepDefinitions$_run_closure7.doCall(WishlistStepDefinitions.groovy:78)
... 
```

WishlistStepDefinitions.groovy（顶部）：

```
import static cucumber.api.groovy.EN.*

import weddo.Wish
import weddo.WishCategory

import pages.WishlistPage

Given(~'^I am on the "([^"]*)" page$') { String pageName ->
    if (pageName.matches(/wishlist/)) {
        to WishlistPage
    }
}

Then(~'^the total gifted amount should be (\\d+)$') { int expectedTotalAmount ->
    assert page.totalAmount.value() == expectedTotalAmount 
}

When(~'^I write "([^"]*)" on every wish on the (\\d+) category$') { String amount, int categoryPosition ->
    wishAmountsFromCategory(categoryPosition).each {
        it.value(amount)
    }
}
... 
```

WishlistPage.groovy（顶部）：

```
package pages

import geb.Page
import org.openqa.selenium.Keys

class WishlistPage extends Page {
    static url = "/"
    static at = {
        title.startsWith("Wishlist")
    }

    static content = {
        totalAmount = {
            $("#amount")
        }
        wishAmountsFromCategory = { categoryIndex ->
            $(".category", categoryIndex).find(".wishes input[data-bind*='currentGiftAmount']")
        }
        wishAmountFromName = { wishName ->
            $(".wishes .control-group").find(".control-label", text: wishName).parent().parent().find("input[data-bind*='currentGiftAmount']")
        }
... 
```

还有一个 GebConfig.groovy、CucumberConfig.groovy 和 env.groovy。最后一个应该将步骤定义粘合到 Geb 页面（据我所知）。但它似乎没有被执行。这是它的内容（env.groovy）：

```
import geb.binding.BindingUpdater
import geb.Browser

import static cucumber.api.groovy.Hooks.*

def bindingUpdater
Before () {
    bindingUpdater = new BindingUpdater (binding, new Browser ())
    bindingUpdater.initialize ()
}

After () {
    bindingUpdater.remove ()
} 
```

我在 Eclipse Groovy/Grails Tool Suite 中运行测试，使用：

```
grails test-app functional:cucumber 
```

有人可以帮忙吗？

编辑：第一个错误（第 68 行）是指此代码中的断言：

```
67\. Then(~'^the total gifted amount should be (\\d+)$') { int expectedTotalAmount ->
68\.     assert page.totalAmount.value() == expectedTotalAmount 
69\. } 
```

编辑 2：在 BuildConfig.groovy 中，我有（摘录）：

```
 ...
    def gebVersion = "0.9.0-RC-1" //"0.7.2"
    def cukesVersion = "0.8.0"
    def seleniumVersion = "2.27.0" //"2.25.0"

    dependencies {
        test("org.seleniumhq.selenium:selenium-htmlunit-driver:$seleniumVersion") {
            exclude "xml-apis"
        }
        test("org.seleniumhq.selenium:selenium-chrome-driver:$seleniumVersion")
        test("org.seleniumhq.selenium:selenium-firefox-driver:$seleniumVersion")
        test "org.gebish:geb-junit4:$gebVersion"
    }

    plugins {
        runtime ":hibernate:$grailsVersion"
        runtime ":jquery:latest.release"
        runtime ":resources:latest.release"

        compile ":google-visualization:latest.release"
        compile ":cloud-foundry:1.2.3"

        test "org.grails.plugins:geb:$gebVersion"
        test ":cucumber:$cukesVersion"
        // Uncomment these (or add new ones) to enable additional resources capabilities
        //runtime ":zipped-resources:1.0"
        //runtime ":cached-resources:1.0"
        //runtime ":yui-minify-resources:0.1.4"

        build ":tomcat:$grailsVersion"
    }
} 
```

和 grails-conf/CucumberConfig.groovy：

```
cucumber {
    features = ["test/cucumber/wishlist"]
    glue = ["test/cucumber/steps"]
} 
```

和测试/功能/GebConfig.groovy

```
import org.openqa.selenium.htmlunit.HtmlUnitDriver
import org.openqa.selenium.firefox.FirefoxDriver
import org.openqa.selenium.chrome.ChromeDriver

// Use htmlunit as the default
// See: http://code.google.com/p/selenium/wiki/HtmlUnitDriver
driver = { 
    def driver = new HtmlUnitDriver()
    driver.javascriptEnabled = true
    driver
}

environments {

    // run as “grails -Dgeb.env=chrome test-app”
    // See: http://code.google.com/p/selenium/wiki/ChromeDriver
    chrome {
        driver = { new ChromeDriver() }
    }

    // run as “grails -Dgeb.env=firefox test-app”
    // See: http://code.google.com/p/selenium/wiki/FirefoxDriver
    firefox {
        driver = { new FirefoxDriver() }
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-14T14:05:39.063

我认为不支持 HtmlUnitDriver。从配置中删除它并将 Firefox 驱动程序设置为默认值。

# mysql - MySQL REGEXP + 空格 (\s)

> ID：15558172
> 
> 赞同：18
> 
> 时间：2013-03-21T21:09:56.447
> 
> 标签：mysql, regex, json

我使用的数据库以 LONGTEXT 数据类型存储 JSON 条目。我希望能够根据 JSON 数据选择条目。以下是一些示例数据：

```
 {
    "12f9cb0a-2218-4590-a05d-c1ffab00f693":  {
        "0":  {
            "value": "test"
        }
    },
    "4d1dfd2e-7bc1-4303-9c8c-90856e918bb9":  {
        "item":  {
            "0": "11"
        }
    }
 } 
```

**因此，我**想通过使用REGEXP 函数，我试过这个没有用：

```
SELECT * FROM my_table WHERE (elements REGEXP BINARY '"4d1dfd2e-7bc1-4303-9c8c-90856e918bb9":\s*{\s*"item":\s*{\s*"0":\s*"11"\s*}\s*}'); 
```

正则表达式测试使用 Rubular 和 Regexpal.com 工作，但 MYSQL 似乎不喜欢**\s***表达式。有没有人对此有更好的解决方案？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2013-03-21T21:15:25.110

**在 MySQL 8.0 之前**，MySQL 正则表达式仅支持[*MySQL 5.7 参考手册*](https://dev.mysql.com/doc/refman/5.7/en/regexp.html#regexp-syntax)[的第 12.7.2 节“正则表达式”中](https://dev.mysql.com/doc/refman/5.7/en/regexp.html#regexp-syntax)*列出的符号（或相应版本的对应物），其中包含`[[:space:]]`符号但不包含`\s`符号。因此，您只需要将每次出现的地方替换`\s`为`[[:space:]]`.*

 ***在 MySQL 8.0 及更高版本**中，MySQL 使用国际组件的正则表达式支持 Unicode [[链接](https://dev.mysql.com/doc/refman/8.0/en/regexp.html#regexp-syntax)]，其中包括`\s`[[链接](http://userguide.icu-project.org/strings/regexp)]；但是因为 MySQL 本身`\`在字符串中用作转义字符，所以您需要将反斜杠加倍，将每次出现的地方替换`\s`为`\\s`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T21:16:00.597

使用字符串替换；

```
select replace(json, ' ','') from table; 
```

如果您的数据中有空格，这将不起作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-21T13:52:07.347

最好使用 json 类型： `SELECT CAST(`column` AS JSON) WHERE JSON_EXTRACT(CAST(`column` as JSON),'$."4d1dfd2e-7bc1-4303-9c8c-90856e918bb9".item."0"')="11"`*

# c++ - Boost Asio HTTPS 请求给出“证书验证失败”错误

> ID：15558177
> 
> 赞同：6
> 
> 时间：2013-03-21T21:10:17.277
> 
> 标签：c++, boost, https, boost-asio

我正在尝试使用 C++ 应用程序中的 Boost.Asio 通过 HTTPS 连接读取数据。我正在解决一个类似的 SO 问题（[使用 Boost.Asio 和 OpenSSL 的 HTTPS 请求](https://stackoverflow.com/questions/7046370/https-request-with-boost-asio-and-openssl)），但仍然收到“证书验证失败”错误。

我已经稍微更新了代码——改用谷歌，因为 www.mtgox.com 网站发生了变化，并且给我浏览器关于自签名证书的警告。我想谷歌的证书链不会有这些问题。

我已经下载了颁发者证书并从命令行确认它可以正常工作：

```
openssl s_client -showcerts  -CApath ./certs -connect google.com:443 
```

给我：

```
CONNECTED(00000003)
depth=2 C = US, O = Equifax, OU = Equifax Secure Certificate Authority
verify return:1
depth=1 C = US, O = Google Inc, CN = Google Internet Authority
verify return:1
depth=0 C = US, ST = California, L = Mountain View, O = Google Inc, CN = *.google.com
verify return:1
---
Certificate chain
 0 s:/C=US/ST=California/L=Mountain View/O=Google Inc/CN=*.google.com
   i:/C=US/O=Google Inc/CN=Google Internet Authority
-----BEGIN CERTIFICATE-----
MIIF/DCCBWWgAwIBAgIKHN4TOQAAAAB/azANBgkqhkiG9w0BAQUFADBGMQswCQYD
VQQGEwJVUzETMBEGA1UEChMKR29vZ2xlIEluYzEiMCAGA1UEAxMZR29vZ2xlIElu
dGVybmV0IEF1dGhvcml0eTAeFw0xMzAzMDcxNDI0MDFaFw0xMzA2MDcxOTQzMjda
MGYxCzAJBgNVBAYTAlVTMRMwEQYDVQQIEwpDYWxpZm9ybmlhMRYwFAYDVQQHEw1N
b3VudGFpbiBWaWV3MRMwEQYDVQQKEwpHb29nbGUgSW5jMRUwEwYDVQQDFAwqLmdv
b2dsZS5jb20wgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGBANVtYuy195QvNel7
trGWR58HJwAZ+ePoaDQgb2tBFllwxpNZDWSAeUi+L2FHDla/L7DEig62yWvR2xgJ
Fg0w9XZkm5uyKIi4olF9ahjWDdlzRJNwYp8cEfReW2d7buBbRIRx7QHywR3FSi9B
uY7BEwIne/Sppz/j8RttVSDXYGNJAgMBAAGjggPPMIIDyzAdBgNVHSUEFjAUBggr
BgEFBQcDAQYIKwYBBQUHAwIwHQYDVR0OBBYEFDeOUXJygXLBA10KGrRYrS7UX19J
MB8GA1UdIwQYMBaAFL/AMOv1QxE+Z7qekfv8atrjaxIkMFsGA1UdHwRUMFIwUKBO
oEyGSmh0dHA6Ly93d3cuZ3N0YXRpYy5jb20vR29vZ2xlSW50ZXJuZXRBdXRob3Jp
dHkvR29vZ2xlSW50ZXJuZXRBdXRob3JpdHkuY3JsMGYGCCsGAQUFBwEBBFowWDBW
BggrBgEFBQcwAoZKaHR0cDovL3d3dy5nc3RhdGljLmNvbS9Hb29nbGVJbnRlcm5l
dEF1dGhvcml0eS9Hb29nbGVJbnRlcm5ldEF1dGhvcml0eS5jcnQwDAYDVR0TAQH/
BAIwADCCApUGA1UdEQSCAowwggKIggwqLmdvb2dsZS5jb22CDSouYW5kcm9pZC5j
b22CFiouYXBwZW5naW5lLmdvb2dsZS5jb22CEiouY2xvdWQuZ29vZ2xlLmNvbYIW
Ki5nb29nbGUtYW5hbHl0aWNzLmNvbYILKi5nb29nbGUuY2GCCyouZ29vZ2xlLmNs
gg4qLmdvb2dsZS5jby5pboIOKi5nb29nbGUuY28uanCCDiouZ29vZ2xlLmNvLnVr
gg8qLmdvb2dsZS5jb20uYXKCDyouZ29vZ2xlLmNvbS5hdYIPKi5nb29nbGUuY29t
LmJygg8qLmdvb2dsZS5jb20uY2+CDyouZ29vZ2xlLmNvbS5teIIPKi5nb29nbGUu
Y29tLnRygg8qLmdvb2dsZS5jb20udm6CCyouZ29vZ2xlLmRlggsqLmdvb2dsZS5l
c4ILKi5nb29nbGUuZnKCCyouZ29vZ2xlLmh1ggsqLmdvb2dsZS5pdIILKi5nb29n
bGUubmyCCyouZ29vZ2xlLnBsggsqLmdvb2dsZS5wdIIPKi5nb29nbGVhcGlzLmNu
ghQqLmdvb2dsZWNvbW1lcmNlLmNvbYINKi5nc3RhdGljLmNvbYIMKi51cmNoaW4u
Y29tghAqLnVybC5nb29nbGUuY29tghYqLnlvdXR1YmUtbm9jb29raWUuY29tgg0q
LnlvdXR1YmUuY29tggsqLnl0aW1nLmNvbYILYW5kcm9pZC5jb22CBGcuY2+CBmdv
by5nbIIUZ29vZ2xlLWFuYWx5dGljcy5jb22CCmdvb2dsZS5jb22CEmdvb2dsZWNv
bW1lcmNlLmNvbYIKdXJjaGluLmNvbYIIeW91dHUuYmWCC3lvdXR1YmUuY29tMA0G
CSqGSIb3DQEBBQUAA4GBAFnvOnn7rF3Tj94qGAPl09lYFYZxoObOYvqQg5H2tEr6
JZk1OEn/743r3yyTllwk8E6zyyerXMzNPXI9dOtkdNwGUcEaWw19eDAWUiZOi7EI
wIRY2VPT5+7BPIwFgcydtyqcDJz39HdNNHtIkOXHzgEnwnFiqJT2cjeX27DWyqwl
-----END CERTIFICATE-----
 1 s:/C=US/O=Google Inc/CN=Google Internet Authority
   i:/C=US/O=Equifax/OU=Equifax Secure Certificate Authority
-----BEGIN CERTIFICATE-----
MIICsDCCAhmgAwIBAgIDC2dxMA0GCSqGSIb3DQEBBQUAME4xCzAJBgNVBAYTAlVT
MRAwDgYDVQQKEwdFcXVpZmF4MS0wKwYDVQQLEyRFcXVpZmF4IFNlY3VyZSBDZXJ0
aWZpY2F0ZSBBdXRob3JpdHkwHhcNMDkwNjA4MjA0MzI3WhcNMTMwNjA3MTk0MzI3
WjBGMQswCQYDVQQGEwJVUzETMBEGA1UEChMKR29vZ2xlIEluYzEiMCAGA1UEAxMZ
R29vZ2xlIEludGVybmV0IEF1dGhvcml0eTCBnzANBgkqhkiG9w0BAQEFAAOBjQAw
gYkCgYEAye23pIucV+eEPkB9hPSP0XFjU5nneXQUr0SZMyCSjXvlKAy6rWxJfoNf
NFlOCnowzdDXxFdF7dWq1nMmzq0yE7jXDx07393cCDaob1FEm8rWIFJztyaHNWrb
qeXUWaUr/GcZOfqTGBhs3t0lig4zFEfC7wFQeeT9adGnwKziV28CAwEAAaOBozCB
oDAOBgNVHQ8BAf8EBAMCAQYwHQYDVR0OBBYEFL/AMOv1QxE+Z7qekfv8atrjaxIk
MB8GA1UdIwQYMBaAFEjmaPkr0rKV10fYIyAQTzOYkJ/UMBIGA1UdEwEB/wQIMAYB
Af8CAQAwOgYDVR0fBDMwMTAvoC2gK4YpaHR0cDovL2NybC5nZW90cnVzdC5jb20v
Y3Jscy9zZWN1cmVjYS5jcmwwDQYJKoZIhvcNAQEFBQADgYEAuIojxkiWsRF8YHde
BZqrocb6ghwYB8TrgbCoZutJqOkM0ymt9e8kTP3kS8p/XmOrmSfLnzYhLLkQYGfN
0rTw8Ktx5YtaiScRhKqOv5nwnQkhClIZmloJ0pC3+gz4fniisIWvXEyZ2VxVKfml
UUIuOss4jHg7y/j7lYe8vJD5UDI=
-----END CERTIFICATE-----
---
Server certificate
subject=/C=US/ST=California/L=Mountain View/O=Google Inc/CN=*.google.com
issuer=/C=US/O=Google Inc/CN=Google Internet Authority
---
No client certificate CA names sent
---
SSL handshake has read 2744 bytes and written 348 bytes
---
New, TLSv1/SSLv3, Cipher is ECDHE-RSA-RC4-SHA
Server public key is 1024 bit
Secure Renegotiation IS supported
Compression: NONE
Expansion: NONE
SSL-Session:
    Protocol  : TLSv1.1
    Cipher    : ECDHE-RSA-RC4-SHA
    Session-ID: A69DDC4E1D33F3D03603AED0CC9F101CC1A49BEE76D61AC0508A780D9E2AF06A
    Session-ID-ctx: 
    Master-Key: 8B08C4A8FB1332EE278F037B115EB4E3E6EF51BCE464B05F8B0652A2773FD34FC2F769B2AB51DCC57CF9844A8B747F97
    Key-Arg   : None
    PSK identity: None
    PSK identity hint: None
    SRP username: None
    TLS session ticket lifetime hint: 100800 (seconds)
    TLS session ticket:
    0000 - 1f 6b 71 a9 3c 1f 83 b0-ad 45 ee 74 5f bb d6 3f   .kq.<....E.t_..?
    0010 - 06 a3 01 3a a6 00 53 da-b2 72 9b 16 d5 5f 54 75   ...:..S..r..._Tu
    0020 - 7e 35 10 1d c8 7e 6e 9e-29 dc f1 67 97 aa 94 77   ~5...~n.)..g...w
    0030 - 81 f5 a4 6c 25 29 61 13-12 6b d3 13 86 40 95 ae   ...l%)a..k...@..
    0040 - d0 6b d9 1f 9e 62 a4 09-68 8a fb 7b 6a b0 34 74   .k...b..h..{j.4t
    0050 - 57 0e 2f 45 d8 e9 9c 10-af 43 dc 83 b7 bd 8f 63   W./E.....C.....c
    0060 - 5e 84 d4 e1 bd 8a 18 55-de 4b a7 58 1e 9d b1 bf   ^......U.K.X....
    0070 - 84 de bb 0b 4a 9b 46 7f-cf 94 8b e3 48 53 54 49   ....J.F.....HSTI
    0080 - 1a 3b f9 41 4b 08 fc ac-b6 09 f0 5b 65 bf e3 cd   .;.AK......[e...
    0090 - 62 7b ad e4                                       b{..

    Start Time: 1363898770
    Timeout   : 300 (sec)
    Verify return code: 0 (ok) 
```

如果我然后输入

```
GET 
```

我得到了谷歌主页的 html/javascript 代码，这是我所期望的。

但是，我的代码仍然失败。（我试图让它尽可能短）：

```
#include <boost/asio.hpp>
#include <boost/asio/ssl.hpp>
#include <boost/bind.hpp>
#include <iostream>
#include <istream>
#include <ostream>
#include <string>

class client
{
public:
  client(boost::asio::io_service& io_service, boost::asio::ssl::context& context, boost::asio::ip::tcp::resolver::iterator endpoint_iterator)
    : socket_(io_service, context)
  {
    socket_.set_verify_mode(boost::asio::ssl::context::verify_peer);
    socket_.set_verify_callback(boost::bind(&client::verify_certificate, this, _1, _2));

    boost::asio::async_connect(socket_.lowest_layer(), endpoint_iterator, boost::bind(&client::handle_connect, this, boost::asio::placeholders::error));
  }

  bool verify_certificate(bool preverified, boost::asio::ssl::verify_context& ctx)
  {
    char subject_name[256];
    X509* cert = X509_STORE_CTX_get_current_cert(ctx.native_handle());
    X509_NAME_oneline(X509_get_subject_name(cert), subject_name, 256);
    std::cout << "Verifying:\n" << subject_name << std::endl;

    return preverified;
  }

  void handle_connect(const boost::system::error_code& error)
  {
    if(!error){
      std::cout << "Connection OK!" << std::endl;
      socket_.async_handshake(boost::asio::ssl::stream_base::client, boost::bind(&client::handle_handshake, this, boost::asio::placeholders::error));
    }else{
      std::cout << "Connect failed: " << error.message() << std::endl;
    }
  }

  void handle_handshake(const boost::system::error_code& error)
  {
    if(!error){
      std::cout << "Sending request: " << std::endl;

      std::stringstream request_;

      request_ << "GET HTTP/1.1\r\n";
      request_ << "Host: google.com\r\n";
      request_ << "Accept-Encoding: *\r\n";
      request_ << "\r\n";

      std::cout << request_.str() << std::endl;

      boost::asio::async_write(socket_, boost::asio::buffer(request_.str()), boost::bind(&client::handle_write, this, boost::asio::placeholders::error, boost::asio::placeholders::bytes_transferred));
    }else{
      std::cout << "Handshake failed: " << error.message() << std::endl;
    }
  }

  void handle_write(const boost::system::error_code& error, size_t bytes_transferred)
  {
    if (!error){
      std::cout << "Sending request OK!" << std::endl;
      boost::asio::async_read(socket_, boost::asio::buffer(reply_, bytes_transferred), boost::bind(&client::handle_read, this, boost::asio::placeholders::error, boost::asio::placeholders::bytes_transferred));
    }else{
      std::cout << "Write failed: " << error.message() << std::endl;
    }
  }

  void handle_read(const boost::system::error_code& error, size_t bytes_transferred)
  {
    if (!error){
      std::cout << "Reply: ";
      std::cout.write(reply_, bytes_transferred);
      std::cout << "\n";
    }else{
      std::cout << "Read failed: " << error.message() << std::endl;
    }
  }

private:
  boost::asio::ssl::stream<boost::asio::ip::tcp::socket> socket_;
  char reply_[0x1 << 16];
};

int main(int argc, char* argv[])
{
  try{
    boost::asio::io_service io_service;

    boost::asio::ip::tcp::resolver resolver(io_service);
    boost::asio::ip::tcp::resolver::query query("www.google.com", "443");
    boost::asio::ip::tcp::resolver::iterator iterator = resolver.resolve(query);
    boost::asio::ssl::context context(boost::asio::ssl::context::sslv23);
    context.add_verify_path("/home/mint/workspace/BoostExamples/certs");
    client c(io_service, context, iterator);
    io_service.run();
  }catch (std::exception& e){
    std::cerr << "Exception: " << e.what() << "\n";
  }

  std::cin.get();
  return 0;
} 
```

出现以下错误：

```
Connection OK!
Verifying:
/C=US/O=Google Inc/CN=Google Internet Authority
Handshake failed: certificate verify failed 
```

我认为我正确加载了证书，但我不确定，我也不清楚如何从 Boost 中获取更多信息以进一步阐明问题。我在 Linux Mint 上，所以我不知道 SSL 3 的 Debian 问题是否也在起作用。大量搜索和阅读 Boost.Asio 文档也无济于事。有很多参考资料，但没有太多解释。

关于我做错了什么或如何找出导致问题的原因的任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-05T21:53:47.163

### `OpenSSL`可能会为您完成工作：

```
int main(int argc, char* argv[]) {
    ...
    boost::asio::ssl::context context(boost::asio::ssl::context::sslv23);
    context.set_default_verify_paths();
    ...
} 
```

Boost`SSL_CTX_set_default_verify_paths()`在后台使用 OpenSSL。

**来自提升文档：**

> 将上下文配置为使用默认目录来查找证书颁发机构证书。

另请参阅 [http://www.boost.org/doc/libs/1_53_0/doc/html/boost_asio/reference/ssl__context/set_default_verify_paths.html](http://www.boost.org/doc/libs/1_53_0/doc/html/boost_asio/reference/ssl__context/set_default_verify_paths.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-22T18:31:30.813

从您发布的代码中，我目前只能看到一个或多或少明显的原因。

似乎您只是直接返回函数`preverified`中的布尔值。`verify_certificate(...)`如果是这样`false`呢？如果 boost 没有预先验证它会是什么。您的功能应该进行验证-您不...

尝试返回 true。如果有效，请看下面。

我可以授予您，您拥有的代码应该开箱即用，因为它是 boost 示例代码。但可能是你把`context.add_verify_path("/home/mint/workspace/BoostExamples/certs");`它搞砸了......或者更确切地说，目录中的文件没有预期的名称。从参考：

```
Each file in the directory must contain a single certificate.
The files must be named using the subject name's hash and an extension of ".0". 
```

# c++ - 内存分配中的seqmentation错误

> ID：15558180
> 
> 赞同：0
> 
> 时间：2013-03-21T21:10:22.707
> 
> 标签：c++, memory-management, segmentation-fault

在启动时，我的应用程序将在大约 %50 的时间内崩溃，并在以下代码行出现分段错误：

```
float** temp = new float*[map_size]; 
```

map_size 的值为 513。

在调试模式下永远不会出现这种糟糕的情况。该应用程序现在相当大，有 10,000 行代码，并且有多个线程在运行，所以我怀疑发布任何其他代码是否有用。（我不确定要发布什么）

由于这行代码相当简单，我猜我的错误在其他地方。我最好的猜测是我的程序在其他地方超出了分配的内存，然后当我偶尔尝试分配更多内存时，它会发生冲突并导致错误。这是可能的情况吗？

什么样的行为会导致内存分配出现分段错误？以及如何缩小代码中发生这种情况的范围？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T21:19:23.897

调用内存分配函数的崩溃几乎总是由于堆损坏。

想想内存分配函数是如何工作的。它首先检查以前释放的块列表，看看是否有一个合适的大小，如果没有找到，它会从操作系统请求一个新块。

如果其他代码通过**写入超出其他动态分配对象的边界而**破坏了堆的内部指针，那么当使用的内存分配函数`::operator new`尝试遍历堆时，它将使用野指针并崩溃。

崩溃发生在这里，但内存损坏发生得更早，并且实际上可能是在您的程序中使用动态分配的对象的*任何地方。*它甚至不必是分配或解除分配发生的地方。

检查您的编译器是否提供“malloc 调试”，它会向围绕动态分配的堆元数据添加额外的金丝雀字段，以检测超出范围的写入。像[Electric Fence](http://en.wikipedia.org/wiki/Electric_Fence)（免费！）之类的东西也可以提供帮助，方法是安排一个无法访问的内存页面来将元数据与每个对象分开，这样 MMU 就会捕获边界错误。或者类似于 Rational Purify 的运行时边界检查器（真的非常昂贵）。

# html - 网站不会以手机浏览器为中心

> ID：15558181
> 
> 赞同：0
> 
> 时间：2013-03-21T21:10:29.347
> 
> 标签：html, css, mobile

我想知道为什么我的网站[Miss Circle](http://www.misscircle.com/)在我的计算机（Firefox、IE、Chrome）上查看时居中，但在我的智能手机（Chrome、Safari）上查看时却左对齐。[CSS 布局是从我的其他网站Sneak Outfitters](http://www.sneakoutfitters.com/)复制的，该网站完美地以我的手机浏览器为中心。这两个网站的唯一区别是一个是 800px 宽，一个是 960px 宽。我只是不明白为什么一个能够居中而另一个在手机浏览器上是左对齐的。我将不胜感激对这个问题的任何启发，

# networking - TCP Paylod 中间的应用程序数据包

> ID：15558182
> 
> 赞同：0
> 
> 时间：2013-03-21T21:10:29.133
> 
> 标签：networking, tcp, ip

我认为通常 HTTP 数据包应该在 TCP 有效负载的开头。是否可以在 TCP 有效负载中间开始 HTTP 数据包？

标记

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T23:09:17.093

当然，如果 HTTP keepalive 有效，或者隧道请求（这实际上是批处理，名称非常糟糕的功能：在读取任何响应之前发送了几个请求）。

# css - 使用 Sass 创建转换变量

> ID：15558187
> 
> 赞同：2
> 
> 时间：2013-03-21T21:10:42.987
> 
> 标签：css, sass, css-transitions, codekit

有没有办法在 Sass 中为转换创建一个变量来复制这个：

```
-webkit-transition: .2s;
-moz-transition: .2s;
-ms-transition: .2s;
-o-transition: .2s;
transition: .2s; 
```

我刚接触 Sass，我正在使用 CodeKit 进行编译。

谢谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-21T21:16:30.083

您可以创建一个[mixin](https://sass-lang.com/documentation/at-rules/mixin)来封装：

```
@mixin transition($duration) {
    -webkit-transition: $duration;
    -moz-transition: $duration;
    -ms-transition: $duration;
    -o-transition: $duration;
    transition: $duration;
} 
```

然后像这样使用它：

```
.class { @include transition(.2s); } 
```

您可能还想查看[Compass](http://compass-style.org)，它包括许多用于 CSS3 的内置 mixin，例如[transitions](http://compass-style.org/reference/compass/css3/transition/)。

或者，您可能希望通过[Autoprefixer](https://github.com/postcss/autoprefixer)运行您的 CSS （在将您的 Sass 编译为 CSS 之后）。这是一个 PostCSS 插件（尽管您也可以[通过](https://github.com/postcss/autoprefixer#usage)Gulp、Grunt、Webpack 和许多其他构建工具使用它），它会自动添加（和删除）必要的供应商前缀，因此您只需要编写无前缀的 CSS。您可以使用要支持的浏览器对其进行配置，它会确保存在任何所需的前缀。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-22T09:13:10.767

您还可以使用**过渡持续时间**混合 [http://compass-style.org/reference/compass/css3/transition/#mixin-transition-duration](http://compass-style.org/reference/compass/css3/transition/#mixin-transition-duration)

```
a {
  color:red;
  @include transition-duration(.2s);
  &:hover {
    color:blue;
  }
} 
```

# .net - Mono Xamarin 应用程序开发

> ID：15558188
> 
> 赞同：0
> 
> 时间：2013-03-21T21:10:44.283
> 
> 标签：.net, mvvm, cross-platform, prism, xamarin

我最近的任务是将我们的大型 Web 应用程序重建为一个跨平台的可安装应用程序，涵盖 WPF、iOS、Android 和 Surface。这是我打算使用的：

带有 Prism 框架的 MVVM 架构 Unity IoC（包含在 Prism 中） SQLite 和 SQLite-NET ORM 用于本地存储 用于进行 REST 服务调用 (TBD) 的库

鉴于此应用程序的大范围，Prism 和 Unity 使用起来很有意义。我的问题是，有没有人在使用 Xamarin 的跨平台应用程序中成功使用这些库？如果这些太大并且不能很好地移植，还有哪些替代方案？

对于 IoC，我在 Xamarin 网站上看到了 TinyIoc，但也看到它适用于小型项目，而我的不是。

已经看到人们在哪里使用过 MVVM Light，但我再次看到它声明这是用于较小的应用程序。

由于这是我第一次构建多平台应用程序，我想确保我拥有适合这项工作的工具。因此，任何经验、替代方案等将不胜感激。

# actionscript-3 - 使用 XML 在 AS3 中保存和删除

> ID：15558189
> 
> 赞同：0
> 
> 时间：2013-03-21T21:10:47.080
> 
> 标签：actionscript-3

我正在尝试通过 AS3 应用程序将某些内容保存在 XML 中。我认为我有正确的保存功能，所以我认为它在于我将数据推送到 XML 的功能。我也不确定在 XML 中删除节点的语法。

这是我的保存功能：

```
public function saveData():void {
            var file:File =        File.desktopDirectory.resolvePath("newPlayer.xml");

            var stream:FileStream = new FileStream()
            stream.open(file, FileMode.WRITE);

            var newXML:XML = new XML("<player></player>");
            newXML.appendChild(playerList.source);
            var str:String = newXML.toString();

            stream.writeUTFBytes(str);
            stream.close();

        } 
```

我通过文本输入框将数据推送到 XMl 的函数：

```
//add a new player from text input into newPlayer.xml
            var newPlayer:XML = <player></player>;

            newPlayer.@name = myTextBox.text;

            playerData.appendChild(newPlayer.@name);

            myPlayerLabel.text = newPlayer.@name; 
```

这在我的 init 函数中，也可以在应用程序完成时加载。我认为这是我重新启动程序时重新加载 XML 的原因：

```
public function init():void {
            var file:File = File.desktopDirectory.resolvePath("newPlayer.xml");
            var stream:FileStream = new FileStream();
            stream.open(file, FileMode.READ);

            var str:String = stream.readUTFBytes(stream.bytesAvailable);
            stream.close();

            playerData = XML(str);

        } 
```

我认为问题在于输入，但我不完全确定，因为 XML 对我来说是新的。提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T00:27:46.483

我认为问题出在您用于将新数据附加到 XML 的函数中。以下行将 player 属性的值附加到现有`playerData`节点而不是您创建的新节点：

```
// Appending the attribute as a child     
playerData.appendChild(newPlayer.@name);

// Actually, you want to append the new node
playerData.appendChild(newPlayer); 
```

# macos - 如何以编程方式重新路由来自特定进程的所有 TCP/IP 或 HTTP 连接

> ID：15558196
> 
> 赞同：1
> 
> 时间：2013-03-21T21:11:00.023
> 
> 标签：macos, routing, network-programming, tcp-ip

这是一个非常高级的问题，答案可能涉及一些系统和套接字级别的编码（我并不反对），因为今天似乎没有现成的东西可以做到这一点。我对所有解决方案（现成的或自己构建的）持开放态度。请提供您最好的建议。

我正在构建一个执行第三方提交的测试二进制文件的测试执行环境。测试二进制文件是针对一个善意的测试框架构建的，该框架连接到 HTTP 服务器，用于在浏览器和被测虚拟设备之间中继测试命令和测试结果。该框架使用户可以轻松地对其测试进行硬编码以连接到静态 IP 地址和端口号，但不提供外部覆盖机制。编写这些测试二进制文件的人并不总是最聪明的工具，因此要求他们做一些像获取动态 IP 地址和端口号这样基本的事情是不可能的。这将为这项免费服务增加太多的进入障碍。

一个测试二进制文件需要准确地附加到系统上可用的 1 个浏览器/设备主机 HTTP 服务器（系统上将有几十个可用。）只有一个测试二进制文件被允许连接到任何特定的浏览器/设备主机 HTTP 服务器时间。我从与二进制文件关联的上下文中知道它们需要附加到哪个设备。他们将尝试通过连接到默认 IP/端口来附加到它，其中默认 IP 是 localhost。那时，我想要一个软件，它可以根据连接过程的 PID 将该端口上的连接路由到动态端口。这很神奇，对吧？根据请求过程，实际将它们连接到不同的端口。这可以在用户模式下完成吗？今天是否有一些漂亮的实用程序服务器可用？

首选 Mac OS X (Lion) 的特定答案，但我很高兴尝试调整适用于其他操作系统的任何解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T21:17:09.367

你试过 charlesproxy (Mac) [http://www.charlesproxy.com/documentation/](http://www.charlesproxy.com/documentation/)或 Fiddler (Windows) [http://www.fiddler2.com/fiddler2/](http://www.fiddler2.com/fiddler2/)

两者都允许重写 http 连接。我知道 Fiddler 是可编写脚本的，我相信 Charles 也是如此，但还没有尝试过

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T23:55:12.373

在基于 Linux 的操作系统上，我建议使用包装器启动器来设置来自应用程序的所有数据包中的服务类型位。然后，您可以使用 iptables 规则将具有该 ToS 位的所有数据包放在一个链中，并在那里进行您需要的任何操作。它不需要编写任何软件。

可以通过使用预加载策略来控制对系统调用的访问，例如`socket`在套接字上设置选项。服务类型只是一个套接字选项。有关该策略的示例，请参阅[本文。](http://static.usenix.org/event/usenix05/tech/freenix/full_papers/eriksen/eriksen.pdf)我虽然过去曾使用过用户空间包装器，但现在找不到了。

但是我认为可能存在使用 iptables 的更简单的方法。`owner`匹配目标可以基于多个参数进行匹配，例如, `uid`, `gid`,`pid`等`sid`。看起来在 SMP 内核上，`pid`and`sid`匹配不起作用，因此不存在。至少在我运行的 Linux 3.2 内核上，它们不存在。如果您以单独的用户身份运行测试二进制文件，这仍然是从测试程序中捕获所有数据包并重新路由的有效方法。您可以在 OUTPUT nat 表中捕获它们并将它们重定向到 DNAT 目标的任何位置。这是一个假设的规则

```
iptables -t nat -I OUTPUT -m owner --uid-owner softwaretesting -j DNAT --to-destination 192.168.1.1 
```

在这里，运行测试的用户被命名`softwaretesting`，该用户启动的程序的所有 IP 流量都被重定向到 192.168.1.1。这可能会产生一些意想不到的后果，例如使`ssh`该用户无法真正工作。既然您说测试框架是 HTTP，您可能只需通过查找端口 80 来匹配它的流量。

```
iptables -t nat -I OUTPUT -p tcp --dport 80 -m owner --uid-owner softwaretesting -j DNAT --to-destination 192.168.1.1 
```

显然，如果 HTTP 在非标准端口上运行，您必须将其调整`80`为正在使用的任何端口。

# mongodb - 如何使用 Mongoid 执行 $geoIntersects 查询？

> ID：15558198
> 
> 赞同：5
> 
> 时间：2013-03-21T21:11:03.130
> 
> 标签：mongodb, sinatra, mongoid, geospatial

我正在使用 Sinatra 和**mongoid**驱动程序，现在我正在尝试在 mongoid 中执行此查询，实际上我有一个名为“**几何**”的地理空间（多边形）字段：

```
db.states.find({
    geometry: {
        $geoIntersects: {
            $geometry: {
                type: "Point",
                coordinates: [-99.176524, 18.929204]
            }
        }
    }
}) 
```

实际上这个查询在 mongodb shell 中工作。

但是，我想找到与给定点（Point-in-polygon）与 mongoid 或其他 ruby​​ 驱动程序相交的状态。

任何帮助将不胜感激。

谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-03-27T14:02:13.213

我最近正在寻找这个，过了一段时间我发现了以下内容。也许其他人会对此有用..

$geoIntersects 现在在 mongoid 4.0.0.beta1 中实现，但没有很好的记录。我在原始更改日志中发现了这一点：[https ://github.com/mongoid/origin/blob/master/CHANGELOG.md#new-features -1](https://github.com/mongoid/origin/blob/master/CHANGELOG.md#new-features-1)

```
query.geo_spacial(:location.intersects_line => [[ 1, 10 ], [ 2, 10 ]])
query.geo_spacial(:location.intersects_point => [[ 1, 10 ]])
query.geo_spacial(:location.intersects_polygon => [[ 1, 10 ], [ 2, 10 ], [ 1, 10 ]])
query.geo_spacial(:location.within_polygon => [[ 1, 10 ], [ 2, 10 ], [ 1, 10 ]]) 
```

并提交：[https ://github.com/mongoid/origin/commit/30938fad644f17fe38f62cf90571b78783b900d8](https://github.com/mongoid/origin/commit/30938fad644f17fe38f62cf90571b78783b900d8)

```
 # Add a $geoIntersects selection. Symbol operators must be used as shown in
 # the examples to expand the criteria.
 #
 # @note The only valid geometry shapes for a $geoIntersects are: :line,
 #   :point, and :polygon.
 # ...
 # @example Add a geo intersect criterion for a point.
 #   query.geo_intersects(:location.point => [[ 1, 10 ]]) 
```

在我的项目中，我有 mongoid (4.0.0.beta1) 和 origin (2.1.0) 我有一个模型 Polygon

```
class Polygon
  include Mongoid::Document
  # some fields 

  embeds_many :loc

  # coordinates is an array of two points: [10, 12]
  def find_polygons_with_point(coordinates)
    # This is where the magic happens!
    Polygon.all.geo_spacial(:loc.intersects_point => coordinates)
  end

end 
```

和一个模型 Loc

```
class Loc
  field :type, type: String #Need to be set to 'Polygon' when creating a new location.
  field :coordinates, type: Array
  # For some reason the array has to be in the format
  # [ [ [1,1], [2,3], [5,3], [1,1] ] ]
  # And the first coordinate needs to be the same as the last
  # to close the polygon

  embedded_in :polygon

  index({ coordinates: "2d" }, { min: -200, max: 200 }) #may not need min/max
end 
```

此代码返回包含此点的所有多边形。

可能有更优雅的方法来做到这一点。如果是这样，我想听听:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-02T02:29:14.487

我一直在考虑做同样的事情。据我所知，Mongoid 尚不支持此功能，而且我不知道实施它的时间范围。

同时，您可以使用 Mongoid/Moped 驱动程序来运行查询，但您不会获得 Mongoid 提供的任何对象映射功能——您只会获得数组/哈希值。下面的示例语法：

```
ids = Mongoid.default_session["states"].find( geometry:
    { "$geoIntersects" =>
        { "$geometry" =>
            { type: "Point", coordinates: [-99.176524, 18.929204] }
        }
    }
).select( id: 1 ) 
```

这实际上返回一个带有键“_id”和 _id 字段值的哈希数组，但您可以根据需要进行配置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-28T06:21:22.583

当我们在等待 Mongoid 4.0 添加**$geoIntersects**支持时，我自己添加了它。它允许链接和所有其他很酷的东西。找到这个文件（你的路径可能看起来有点不同）：

```
/usr/local/lib/ruby/gems/1.9.1/gems/origin-1.1.0/lib/origin/selectable.rb 
```

在文件中的任何位置添加：

```
def geo_intersects(criterion = nil)
   __override__(criterion, "$geoIntersects")
end
key :geo_intersects, :override, "$geoIntersects" 
```

现在你可以这样做：

```
Houses.where(:color => "red").geo_intersects(:loc => {"$geometry" => {:type => "Polygon", :coordinates => [[[1,2],[2,3][1,2]]]}) 
```

# android - 屏幕旋转后，嵌套片段丢失对 onCreateOptionsMenu 的调用

> ID：15558201
> 
> 赞同：4
> 
> 时间：2013-03-21T21:11:12.433
> 
> 标签：android, android-viewpager, fragment, screen-orientation, oncreateoptionsmenu

我实现了一个 Activity( `A`)，它只显示一个片段 ( `PF`) 和`getSupportFragmentManager()`. Fragment ( `PF`) 有一个 ViewPager 来显示 2 个 Fragment (`F1`和`F2`)。ViewPager`FragmentPagerAdapter`与`getChildFragmentManager()`.

[相关代码](https://github.com/marsucsb/nested-fragments)（ViewPagerActivity）

`PF`已经`setRetainInstance(true)`和我添加`setHasOptionsMenu(true)`到 PF、F1 和 F2 因为它们具有个性化选项菜单。

一切正常。当我在显示选项菜单 1 或选项菜单 2 的操作栏更改之间滑动时，但是当屏幕旋转发生时，片段 1 和 2 中的选项菜单在 swype 之后不再被调用`F1`。`F2`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-27T01:00:43.420

您还需要添加`setRetainInstance(true)`到 F1 和 F2。由于片段可以有自己的选项菜单，因此您必须告诉 android 它也应该保留您的子片段，而不仅仅是父片段。

# java - 如何在java中调整图像大小？

> ID：15558202
> 
> 赞同：18
> 
> 时间：2013-03-21T21:11:19.327
> 
> 标签：java, image, qr-code

您好，我有一个 QR 码图像，我想调整它的大小，当我尝试使用此码将其调整为小图像时，我总是得到一个模糊的图像，并且当我扫描它时 QR 码不再有效，但是当我使用相同的代码调整为大尺寸图像时，它工作正常：

```
public BufferedImage getScaledInstance(BufferedImage img,
                                   int targetWidth,
                                   int targetHeight,
                                   Object hint,
                                   boolean higherQuality)
{
int type = (img.getTransparency() == Transparency.OPAQUE) ?
    BufferedImage.TYPE_INT_RGB : BufferedImage.TYPE_INT_ARGB;
BufferedImage ret = (BufferedImage)img;
int w, h;
if (higherQuality) {
    // Use multi-step technique: start with original size, then
    // scale down in multiple passes with drawImage()
    // until the target size is reached
    w = img.getWidth();
    h = img.getHeight();
} else {
    // Use one-step technique: scale directly from original
    // size to target size with a single drawImage() call
    w = targetWidth;
    h = targetHeight;
}

do {
    if (higherQuality && w > targetWidth) {
        w /= 2;
        if (w < targetWidth) {
            w = targetWidth;
        }
    }

    if (higherQuality && h > targetHeight) {
        h /= 2;
        if (h < targetHeight) {
            h = targetHeight;
        }
    }

    BufferedImage tmp = new BufferedImage(w, h, type);
    Graphics2D g2 = tmp.createGraphics();
    g2.setRenderingHint(RenderingHints.KEY_INTERPOLATION, hint);
    //        g2.setRenderingHint(RenderingHints.KEY_DITHERING, hint);
    g2.drawImage(ret, 0, 0, w, h, null);
    g2.dispose();

    ret = tmp;
} while (w != targetWidth || h != targetHeight);

return ret;
} 
```

什么问题，我不太明白，请至少给我提示，谢谢

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-03-21T21:18:39.007

我使用仿射变换来完成这个任务，这是我的代码，希望对你有帮助

```
/**
 * scale image
 * 
 * @param sbi image to scale
 * @param imageType type of image
 * @param dWidth width of destination image
 * @param dHeight height of destination image
 * @param fWidth x-factor for transformation / scaling
 * @param fHeight y-factor for transformation / scaling
 * @return scaled image
 */
public static BufferedImage scale(BufferedImage sbi, int imageType, int dWidth, int dHeight, double fWidth, double fHeight) {
    BufferedImage dbi = null;
    if(sbi != null) {
        dbi = new BufferedImage(dWidth, dHeight, imageType);
        Graphics2D g = dbi.createGraphics();
        AffineTransform at = AffineTransform.getScaleInstance(fWidth, fHeight);
        g.drawRenderedImage(sbi, at);
    }
    return dbi;
} 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2016-02-25T20:43:43.120

基于@A4L 的回答：

更直接的版本。此外，他的解决方案仅缩放画布而不是图像本身。

```
public static BufferedImage scale(BufferedImage imageToScale, int dWidth, int dHeight) {
        BufferedImage scaledImage = null;
        if (imageToScale != null) {
            scaledImage = new BufferedImage(dWidth, dHeight, imageToScale.getType());
            Graphics2D graphics2D = scaledImage.createGraphics();
            graphics2D.drawImage(imageToScale, 0, 0, dWidth, dHeight, null);
            graphics2D.dispose();
        }
        return scaledImage;
    } 
```

提高您可以添加的质量

```
graphics2D.setRenderingHint(RenderingHints.KEY_INTERPOLATION, RenderingHints.VALUE_INTERPOLATION_BILINEAR);
graphics2D.setRenderingHint(RenderingHints.KEY_RENDERING, RenderingHints.VALUE_RENDER_QUALITY);
graphics2D.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON); 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-03-21T21:15:21.763

我写了这个我个人也使用的类。我希望代码是直截了当的。

```
import java.awt.Graphics;
import java.awt.Image;
import java.awt.Toolkit;
import java.awt.image.BufferedImage;
import java.awt.image.CropImageFilter;
import java.awt.image.FilteredImageSource;
import java.io.File;
import java.io.IOException;
import javax.imageio.ImageIO;
import javax.swing.ImageIcon;
import javax.swing.JComponent;

public class ImageScaler {

        private ImageIcon originalImage;
        private ImageIcon scaledImage;

        public ImageScaler(Image image) {
                this.originalImage = new ImageIcon(image);
        }

        public ImageScaler(String fileName) {
                originalImage = new ImageIcon(fileName);
        }

        public void createScaledImage(int size, ScalingDirection scalingDirection) {
                if (scalingDirection == ScalingDirection.HORIZONTAL) {
                        scaledImage = new ImageIcon(originalImage.getImage().getScaledInstance(size, -1, Image.SCALE_SMOOTH));
                } else {
                        scaledImage = new ImageIcon(originalImage.getImage().getScaledInstance(-1, size, Image.SCALE_SMOOTH));
                }       
        }

        public void createScaledImage(int size, ScalingDirection scalingDirection, int scale) {
                if (scalingDirection == ScalingDirection.HORIZONTAL) {
                        scaledImage = new ImageIcon(originalImage.getImage().getScaledInstance(size, -1, scale));
                } else {
                        scaledImage = new ImageIcon(originalImage.getImage().getScaledInstance(-1, size, scale));
                }
        }

        public void createScaledImage(int width, int height, ScaleType scaleType) {
                int imageWidth = originalImage.getImage().getWidth(null);
                int imageHeight = originalImage.getImage().getHeight(null);
                double originalImageRatio = imageWidth / (double) imageHeight;
                double scaledImageRatio = width / (double) height;

                if(scaleType == ScaleType.FIT) {
                        if(imageHeight - (Math.abs(imageWidth - width) / originalImageRatio) <= height) {
                                scaledImage = new ImageIcon(originalImage.getImage().getScaledInstance(width, -1, Image.SCALE_SMOOTH));
                        } else if(imageWidth - (Math.abs(imageHeight - height) * originalImageRatio) <= width) {
                                scaledImage = new ImageIcon(originalImage.getImage().getScaledInstance(-1, height, Image.SCALE_SMOOTH));
                        }
                } else if(scaleType == ScaleType.FILL) {
                        if(imageHeight - (Math.abs(imageWidth - width) / originalImageRatio) >= height) {
                                scaledImage = new ImageIcon(originalImage.getImage().getScaledInstance(width, -1, Image.SCALE_SMOOTH));
                                int thumbHeight = scaledImage.getImage().getHeight(null);

                                // Crop the image
                                scaledImage = new ImageIcon(Toolkit.getDefaultToolkit().createImage(new FilteredImageSource(scaledImage.getImage().getSource(), new CropImageFilter(0, (thumbHeight-height)/2, width, height))));
                        } else if(imageWidth - (Math.abs(imageHeight - height) * originalImageRatio) >= width) {
                                scaledImage = new ImageIcon(originalImage.getImage().getScaledInstance(-1, height, Image.SCALE_SMOOTH));
                                int thumbWidth = scaledImage.getImage().getWidth(null);

                                // Crop the image
                                scaledImage = new ImageIcon(Toolkit.getDefaultToolkit().createImage(new FilteredImageSource(scaledImage.getImage().getSource(), new CropImageFilter((thumbWidth-width)/2, 0, width, height))));
                        }               
                }
        }

        public void saveScaledImage(File file, ImageType imageType) {
                if (scaledImage != null) {
                        BufferedImage bi = new BufferedImage(scaledImage.getIconWidth(), scaledImage.getIconHeight(), BufferedImage.TYPE_INT_RGB);
                        Graphics g = bi.getGraphics();
                        g.drawImage(scaledImage.getImage(), 0, 0, null);
                        try {
                                ImageIO.write(bi, imageType.value(), file);
                        } catch (IOException ioe) {
                                System.out.println("Error occured saving scaled image");
                        }
                } else {
                        System.out.println("Scaled image has not yet been created");
                }
        }

        public void saveOriginalImage(File file, ImageType imageType) {
                if (originalImage != null) {
                        BufferedImage bi = new BufferedImage(originalImage.getIconWidth(), originalImage.getIconHeight(), BufferedImage.TYPE_INT_RGB);
                        Graphics g = bi.getGraphics();
                        g.drawImage(originalImage.getImage(), 0, 0, null);
                        try {
                                ImageIO.write(bi, imageType.value(), file);
                        } catch (IOException ioe) {
                                System.out.println("Error occured saving original image");
                        }
                } else {
                        System.out.println("Original image has not yet been created");
                }
        }

        // ENUMS
        public enum ScalingDirection {VERTICAL, HORIZONTAL};
        public enum ScaleType {FIT, FILL};
        public enum ImageType {
                IMAGE_JPEG ("jpeg"),
                IMAGE_JPG ("jpg"),
                IMAGE_PNG ("png");

                private String value = null;

                ImageType(String value) {
                        this.value = value;
                }

                String value() {
                        return value;
                }
        };
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-21T21:15:20.483

请检查这个 Image.getScaledInstance() 细节可以在这个答案中找到：[如何提高用于调整图像大小的 g.drawImage() 方法的性能](https://stackoverflow.com/questions/3967731/java-scale-image-best-practice)

希望能帮助到你

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-12-12T14:21:05.613

```
 public static BufferedImage resizeImg(BufferedImage img, int newW, int newH)
    {
    int w = img.getWidth();
    int h = img.getHeight();
    BufferedImage dimg = new BufferedImage(newW, newH, img.getType());
    Graphics2D g = dimg.createGraphics();
    g.setRenderingHint(RenderingHints.KEY_INTERPOLATION,
            RenderingHints.VALUE_INTERPOLATION_BILINEAR);
    g.drawImage(img, 0, 0, newW, newH, 0, 0, w, h, null);
    g.dispose();
    return dimg;      
   } 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-10-23T17:30:42.397

我推荐[Thumbnailnator](https://github.com/coobird/thumbnailator)，因为它提供了比 Java 多步骤方法更好的图像质量。但是，使用您的 Graphics2D drawImage 代码，速度可能会更好。

另请参阅[Java - 在不损失质量的情况下调整图像大小](https://stackoverflow.com/questions/24745147/java-resize-image-without-losing-quality)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-11-17T21:35:32.580

事实上，解决方案更加简单。您不必创建新的 BufferedImage。您可以将for3st提到的方法直接应用于原始的BufferedImage图像（'image'）并设置您想要的宽度和高度。因此只需要一个语句（包含在标准 Java 文档中）：

```
drawImage(BufferedImage image, int x, int y, int width, int height, ImageObserver observer) 
```

# mysql - MySQL 列名作为与联结表的多对多关系的字段名

> ID：15558209
> 
> 赞同：3
> 
> 时间：2013-03-21T21:11:44.483
> 
> 标签：mysql, sql, many-to-many, pivot, pivot-table

这里有点复杂。我一直在寻找一种将结果用作列名的方法，虽然这似乎可行，但我发现的所有示例都使用了非常简单的表格设计。

我有的是3张桌子。

我们有一个 'order' 表，然后它可以有 'order_extras'。“附加”表存储附加的名称和价格，“订单附加”基本上包含一个主键、订单 ID 和附加 ID。

粗略的图形表示如下：![在此处输入图像描述](../Images/44e334f42f895d390fd2f38eb5ee08f7.png)

以此为例，假设“附加”表中填充了 3 个额外的项目，名称和价格在此阶段无关紧要。

我想要做的是获取所有订单，但每个额外项目的名称都有额外的列。如果该项目已被购买（又名链接在 order_extras 表中），它将显示价格，否则它将为空/null。

这甚至可能吗？我一直在研究数据透视表，但这类事情的信息似乎有点不稳定。任何信息或建议将不胜感激！

**示例数据**

附加功能：

```
+----+------------------+--------+
| id |       name       | price  |
+----+------------------+--------+
|  1 | Insurance        | 59.95  |
|  2 | Lifetime Updates | 79.95  |
|  3 | Phone Support    | 124.95 |
+----+------------------+--------+ 
```

订单：

```
+----+------------+
| id |  customer  |
+----+------------+
|  1 | John Smith |
|  2 | Bob Newbie |
|  3 | Bill Jobs  |
|  4 | Ray Stantz |
+----+------------+ 
```

order_extras：

```
+----+----------+----------+
| id | order_id | extra_id |
+----+----------+----------+
|  1 |        4 |        2 |
|  2 |        3 |        1 |
|  3 |        3 |        3 |
|  4 |        1 |        1 |
+----+----------+----------+ 
```

期望的输出：

```
+----------+----------------+-----------+------------------+---------------+
| order.id | order.customer | Insurance | Lifetime Updates | Phone Support |
+----------+----------------+-----------+------------------+---------------+
|        1 | John Smith     | 59.95     | 0                | 0             |
|        2 | Bob Newbie     | 0         | 0                | 0             |
|        3 | Bill Jobs      | 59.95     | 0                | 124.95        |
|        4 | Ray Stantz     | 0         | 79.95            | 0             |
+----------+----------------+-----------+------------------+---------------+ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T22:06:54.217

不幸的是，MySQL 没有*枢轴*函数，但可以使用带有`CASE`表达式的聚合函数进行复制。

如果您有已知数量的`extras`，那么您可以对查询进行硬编码：

```
select o.id,
  o.customer,
  max(case when e.name = 'Insurance' then e.price else 0 end) Insurance,
  max(case when e.name = 'Lifetime Updates' then e.price else 0 end) `Lifetime Updates`,
  max(case when e.name = 'Phone Support' then e.price else 0 end) `Phone Support`
from orders o
left join order_extras oe
  on o.id = oe.order_id
left join extras e
  on oe.extra_id = e.id
group by o.id, o.customer 
```

请参阅[SQL Fiddle with Demo](http://www.sqlfiddle.com/#!2/1e0fa/2)。

对于您的情况，您似乎将拥有未知数量的值。如果是这种情况，那么您将需要使用准备好的语句来生成动态 sql：

```
SET @sql = NULL;
SELECT
  GROUP_CONCAT(DISTINCT
    CONCAT(
      'max(CASE WHEN e.name = ''',
      name,
      ''' THEN e.price else 0 END) AS `',
      name, '`'
    )
  ) INTO @sql
FROM extras;

SET @sql 
  = CONCAT('SELECT o.id,
                o.customer, ', @sql, ' 
            from orders o
            left join order_extras oe
              on o.id = oe.order_id
            left join extras e
              on oe.extra_id = e.id
            group by o.id, o.customer');

PREPARE stmt FROM @sql;
EXECUTE stmt;
DEALLOCATE PREPARE stmt; 
```

请参阅[SQL Fiddle with Demo](http://www.sqlfiddle.com/#!2/1e0fa/4)。

这两个版本都会给出结果：

```
| ID |   CUSTOMER | INSURANCE | LIFETIME UPDATES | PHONE SUPPORT |
------------------------------------------------------------------
|  1 | John Smith |     59.95 |                0 |             0 |
|  2 | Bob Newbie |         0 |                0 |             0 |
|  3 |  Bill Jobs |     59.95 |                0 |        124.95 |
|  4 | Ray Stantz |         0 |            79.95 |             0 | 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T22:06:01.857

试试这个 。

```
 select o.id , o.customer ,
    max(if(e.name = 'Insurance' , round(e.price,2), 0)) as Insurance,
    max(if(e.name = 'Lifetime Updates' , round(e.price,2), 0)) as Lifetime_Updates,
    max(if(e.name = 'Phone Support' , round(e.price,2), 0)) as Phone_Support

     from orders o
     left join order_extras oe
     on o.id = oe.order_id
    left join Extras e
    on oe.extra_id = e.id

    group by o.id, o.customer 
```

[**在这里演示**](http://sqlfiddle.com/#!2/881ad/20)

输出是：

```
 ID   CUSTOMER    INSURANCE   LIFETIME_UPDATES    PHONE_SUPPORT
    1   John Smith   59.95              0                0
    2   Bob Newbie     0                0                0
    3   Bill Jobs    59.95              0              124.95
    4   Ray Stantz     0              79.95              0 
```

# asp.net-mvc - ASP MVC/Linq - 从查询中删除对象

> ID：15558215
> 
> 赞同：1
> 
> 时间：2013-03-21T21:11:54.627
> 
> 标签：asp.net-mvc, asp.net-mvc-3, linq

我需要根据用户提供的搜索过滤器从 Linq 查询中删除某些项目（在这种情况下，它将是代理的名称）。

基本上第一个查询从相关表中获取所有信息，我需要过滤掉那些没有与指定名称对应的名称。

下面是我试图使用的代码，但显然这`followUpItems.Remove()`不是一个实际的方法，只是在寻找类似的东西。由于`followUpItems`被定义为一个`var`而不是一个列表，我想知道这是否可能？

```
 var followUpItem = from follow in db.FollowUpItems
                           where (follow.TableName.Equals(TableName) || TableName.Equals("%")) &&
                                 (follow.IssueType.Equals(IssueType) || IssueType.Equals("%")) &&
                                 (follow.Status.Equals(Status) || Status.Equals("%"))
                           orderby follow.Id
                           select follow;

        //Set display names
        foreach (var item in followUpItem)
        {
            var key1 = int.Parse(item.Key1);

            var name = (from a in db.Agent
                               where key1 == a.SymetraNumber
                               select a).Single();

            item.DisplayName = name.FirstName + " " + name.LastName;
            if (!item.DisplayName.Equals(AgentName))
                followUpItem.Remove(item);
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T21:17:31.080

```
followUpItem = followUpItem.RemoveAll(i=> i.Id == item.Id); 
```

抱歉，这不适用于 iqueryable。试试这个：

```
followUpItem = followUpItem.Where(i=> i.Id != item.Id); 
```

这假设 ID 永远不会为空。

您还可以构建“要删除的项目”列表并调用 .Except(itemsToRemove), **OUTSIDE OF THE LOOP**。在循环中修改列表有时会让您头疼；）

```
followUpItem = followUpItem.Except(itemsToRemove); 
```

# emacs - 仅用于显示的 Emacs 缩写

> ID：15558217
> 
> 赞同：2
> 
> 时间：2013-03-21T21:11:59.133
> 
> 标签：emacs

我在 emacs 中编辑 Mathematica 代码。Mathematica 对希腊字母的明文表示看起来像

```
\[Alpha], \[Beta], \[Gamma], ... 
```

我不介意输入这些，但生成的代码很大而且看起来很笨拙，例如：

```
k[\[Beta]_,z_]:=z^(\[Beta]/2) Hypergeometric2F1[\[Beta]/2,\[Beta]/2,\[Beta],z]; 
```

有没有办法让emacs自动将某些字符串（如`\[Alpha]`）显示为其他字符串（如alpha的unicode字符）？注意，我不想用另一个字符串替换一个字符串（如果我理解正确，这是缩写的作用），因为 Mathematica 应该仍然可以正确读取该文件。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-21T21:56:28.580

是的，有办法。普通的 Emacs 解决方案是使用`compose-region`可以做到这一点的函数。此代码段将为您定义一个函数`compose-greek-symbols`，如果 font-lock 处于活动状态，它将激活当前缓冲区中请求的缩写替换：

```
(setq
 greek-symbols
 (loop
  ;; characters are entered with `ucs-insert'
  ;; 'α' is "GREEK SMALL LETTER ALPHA"
  for ch from ?α to ?ω
  collect (let ((str (get-char-code-property ch 'name)))
        (setq str
          (upcase-initials
           (downcase
            (replace-regexp-in-string "greek small letter " "" str))))
        (cons str ch))))

(defun compose-greek-symbols ()
  (interactive)
  (font-lock-add-keywords
   nil
   '(("\\\\\\[\\([^]]+\\)\\]"
      (0 (progn (let
            ((sym (cdr-safe (assoc (match-string 1) greek-symbols))))
          (when sym
            (compose-region (match-beginning 0)
                    (match-end 0)
                    sym))))))))) 
```

EmacsWiki 提供[了更多的解决方案](http://www.emacswiki.org/emacs/PrettySymbol)。如果你愿意安装新的包，你总是可以尝试一些更复杂的东西，比如[pretty-symbols-mode](https://github.com/drothlis/pretty-symbols)。

# r - 使用 igraph 在 R 中绘制多个离散网络

> ID：15558218
> 
> 赞同：5
> 
> 时间：2013-03-21T21:11:59.960
> 
> 标签：r, tree, igraph

我有一组要绘制的简单方向关系（父->子）。我的数据的结构使得有许多离散的子网络。这是一些看起来像我的假数据。

```
require(igraph)
parents<-c("A","A","C","C","F","F","H","I")
children<-c("B","C","D","E","G","H","I","J")
begats<-data.frame(parents=parents,children=children)
graph_begats<-graph.data.frame(begats)
plot(graph_begats) 
```

假数据中有两个不同的子网络，每个子网络严格来说都是父子血统。我需要在同一个窗口（理想情况下是相同的顶点坐标系）中将两个谱系绘制为树网络。我曾尝试使用 layout.reingold.tilford()，但我最多只能绘制其中一棵树，所有其他顶点都绘制在根顶点之上，就像这样。

```
lo<-layout.reingold.tilford(graph_begats,root=1)
plot(graph_begats,layout=lo) 
```

对任意数量的离散谱系执行此操作有什么想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-23T01:34:09.460

因此，正如我在上面的评论中提到的，一种解决方案是分别为每个组件计算布局。这相当简单，即使需要一些代码才能正确完成。下面的代码应该适用于任意数量的组件。拓扑排序中的第一个顶点用作每棵树的根节点。

```
require(igraph)

## Some data
parents <- c("A", "A", "C", "C", "F", "F", "H", "I")
children <- c("B", "C", "D", "E", "G", "H", "I", "J")
begats <- data.frame(parents=parents, children=children)
graph_begats <- graph.data.frame(begats)

## Decompose the graph, individual layouts
comp <- decompose.graph(graph_begats)
roots <- sapply(lapply(comp, topological.sort), head, n=1)
coords <- mapply(FUN=layout.reingold.tilford, comp,
                 root=roots, SIMPLIFY=FALSE)

## Put the graphs side by side, roots on the top
width <- sapply(coords, function(x) { r <- range(x[, 1]); r[2] - r[1] })
gap <- 0.5
shift <- c(0, cumsum(width[-length(width)] + gap))
ncoords <- mapply(FUN=function(mat, shift) {
  mat[,1] <- mat[,1] - min(mat[,1]) + shift
  mat[,2] <- mat[,2] - max(mat[,2])
  mat
}, coords, shift, SIMPLIFY=FALSE)

## Put together the coordinates for the original graph,
## based on the names of the vertices
lay <- matrix(0, ncol=2, nrow=vcount(graph_begats))
for (i in seq_along(comp)) {
  lay[match(V(comp[[i]])$name, V(graph_begats)$name),] <- ncoords[[i]]
}

## Plot everything
par(mar=c(0,0,0,0))
plot(graph_begats, layout=lay) 
```

![阴谋](../Images/ddad94b27fe2d75ddaab34854d8ac385.png)

# perl - Excel::Writer::XLSX 页面视图和分页符 (Perl)

> ID：15558219
> 
> 赞同：1
> 
> 时间：2013-03-21T21:12:01.473
> 
> 标签：perl, excel, pageviews, page-break, spreadsheet-excel-writer

我搜索了 API、Google、StackOverflow 等，试图找到以下问题的答案，但到目前为止，我的追求一直令人失望。有没有人可以帮助我？

1) 我正在尝试使用 set_page_view() 选项将工作表默认为“分页预览”。不幸的是，CPAN 页面没有给我这个函数的有效参数。我尝试使用 set_page_view('Page Break Preview')，但这给了我“页面布局”视图。

2) 在我的脚本中，我引用 set_h_pagebreaks() 和 set_v_pagebreaks 来动态放置分页符，因为我编写了 excel 表。这非常有效，但是工作表有时也会创建默认的分页符。有没有办法使用这个模块删除默认的分页符？

感谢您提供的任何帮助！如果需要，我可以提供一些我的代码集。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T21:53:48.473

关于您的问题：

1.  Excel::Writer::XLSX 当前不支持分页预览。

2.  Excel::Writer::XLSX 模块不做任何设置默认分页符的操作。这些可能是 Excel 自己设置的。如果它们是，则 Excel::Writer::XLSX 没有任何工具可以删除它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-08-10T14:56:10.620

关于您的问题：“有没有办法使用此模块删除默认分页符？”

我想我已经开始为您提供解决方案了；）

（即使是 5 年前，我的回答也可以帮助其他人......）

我也为此苦苦挣扎（有一个垂直和水平自动分页符，arg，太烦人了！）但我已经意识到就像办公室网站说的那样：“Microsoft Excel 根据纸张大小、边距设置插入自动分页符、比例选项以及您插入的任何手动分页符的位置。” ( [https://support.office.com/en-us/article/insert-move-or-delete-page-breaks-in-a-worksheet-ad3dc726-beec-4a4c-861f-ed640612bdc2?omkt=en-001&ui =en-US&rs=en-001&ad=US](https://support.office.com/en-us/article/insert-move-or-delete-page-breaks-in-a-worksheet-ad3dc726-beec-4a4c-861f-ed640612bdc2?omkt=en-001&ui=en-US&rs=en-001&ad=US) )

因此，就像本文所说，您的自动分页符取决于几个因素。例如，您的打印比例是多少？你的纸张尺寸是多少？等等...

就个人而言，我的问题是对于一个非常宽且长的 Excel 文档，我的比例为 100%。所以我只写了一个计算理想比例的函数，以避免自动垂直分页符，而我的自动水平分页符消失了。

希望有用^^

* * *

## 编辑：这是代码示例

```
#We put the horizontal page breaks at line 20, 40 and 60
worksheet.set_h_pagebreaks([20,40,60])
#We calculate the ideal scale according to your criterias
ideal_scale=pre_determined_number/width_of_all_columns
#We put a scale and then, Excel won't put some automatic breakline when we'll 
#finish to write the excel file
worksheet.set_print_scale(ideal_scale) 
```

# c++ - 从客户端接收数据时出现异常 - “文件结束”错误

> ID：15558223
> 
> 赞同：0
> 
> 时间：2013-03-21T21:12:15.110
> 
> 标签：c++, boost-asio

我目前正在使用 Boost ASIO 开发客户端服务器 TCP/IP 应用程序。客户端使用以下语句向服务器发送数据

```
boost::system::error_code ignored_error; 
boost::asio::write(socket, boost::asio::buffer("Hello World\0"), ignored_error); 
```

服务器按原样读取此数据（从异步读取）

```
boost::asio::async_read(*sock, boost::asio::buffer(buf_server),boost::bind(&ServerRead,boost::asio::placeholders::error)); 
```

这是阅读完成的地方

```
boost::array<char, 158> buf_server;

void ServerRead(const boost::system::error_code& error)
{
    if(!error)
    {
        std::cout << "Message: " << buf_server.data() << std::endl;
    }
    else
    {
        std::cout << "Error occurred." << error.message() << std::endl;
    }
} 
```

但是我收到错误“文件结束”。所以现在我有两个问题

1.  我该如何解决这个问题。我在这里做错了什么？

2.  假设我`buf_server`只有 5 个字符而不是 158 个字符。我怎样才能让我的接收器只使用这个缓冲区来读取整个数据`std::cout`呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T21:56:56.480

当您指示应用程序读取 158 个字节但只发送 12 个字节时，应该会出现这种行为。要解决此问题，您可以发送一个固定大小的标头来指示消息大小，Asio 文档中包含的[聊天客户端和服务器](http://www.boost.org/doc/libs/release/doc/html/boost_asio/example/chat/chat_client.cpp)示例显示了如何完成此操作，摘自客户端示例：

```
void handle_connect(const boost::system::error_code& error)
  {
    if (!error)
    {
      boost::asio::async_read(socket_,
          boost::asio::buffer(read_msg_.data(), chat_message::header_length),
          boost::bind(&chat_client::handle_read_header, this,
            boost::asio::placeholders::error));
    }
  }

  void handle_read_header(const boost::system::error_code& error)
  {
    if (!error && read_msg_.decode_header())
    {
      boost::asio::async_read(socket_,
          boost::asio::buffer(read_msg_.body(), read_msg_.body_length()),
          boost::bind(&chat_client::handle_read_body, this,
            boost::asio::placeholders::error));
    }
    else
    {
      do_close();
    }
  }

  void handle_read_body(const boost::system::error_code& error)
  {
    if (!error)
    {
      std::cout.write(read_msg_.body(), read_msg_.body_length());
      std::cout << "\n";
      boost::asio::async_read(socket_,
          boost::asio::buffer(read_msg_.data(), chat_message::header_length),
          boost::bind(&chat_client::handle_read_header, this,
            boost::asio::placeholders::error));
    }
    else
    {
      do_close();
    }
  } 
```

或者，或者使用更奇特的协议[，例如 HTTP](http://www.boost.org/doc/libs/release/doc/html/boost_asio/example/http/client/async_client.cpp)`\r\n` ，在遇到分隔符之前一直阅读。

# ruby - Ruby GeoJSON 到 KML

> ID：15558234
> 
> 赞同：0
> 
> 时间：2013-03-21T21:12:49.300
> 
> 标签：ruby, gem, sinatra, kml, geojson

我有一个 Sinatra 应用程序，我正在使用`post`GeoJSON（多边形）到.. 在我之前，我正在寻找一个 gem/脚本来将 JSON 转换为 KML。到电子邮件（使用[邮件](http://rubygems.org/gems/mail)gem）。

我能找到的最接近的东西是[georuby](https://github.com/nofxx/georuby)，它似乎还没有这样的转换，肯定有办法......？？或者也许这更好地手动实现：？

Ruby 新手*（来自 Python/JavaScript 背景）*，因此非常感谢您的小步骤！

**编辑：**为了我的目的，更容易（“手动”）转换坐标，并插入模板 kml erb/ 字符串。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T01:09:16.123

（我也找不到将 KML 转换为 GeoJSON 的纯 Ruby 库......？）

如果`ogr2ogr`二进制文件在您的系统上可用并且您可以写入 tmp 目录：

```
require 'tmpdir'
require 'fileutils'

tmpdir = Dir.mktmpdir
geojson_path = File.join(tmpdir, 'a.geojson') # the input
kml_path = File.join(tmpdir, 'a.kml') # the output

File.open(geojson_path, 'w') do |f|
  # params[:geojson] is from the web request
  f.write params[:geojson]
end

Kernel.system 'ogr2ogr', '-f', 'KML', kml_path, geojson_path

# now you can email kml
kml = File.read(kml_path)

FileUtils.rm_rf tmpdir 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-20T15:11:04.233

您可以使用名为[FFI-OGR](https://github.com/scooterw/ffi-ogr)的新 gem来执行此操作。

FFI 或[Foreign Function Interface](https://en.wikipedia.org/wiki/Foreign_function_interface)允许 Ruby 调用用其他语言编写的函数，而无需编写本机代码。FFI-OGR 在 Ruby 中包装了 OGR 的 C 实现。

添加`gem 'ffi-ogr', git: 'https://github.com/scooterw/ffi-ogr'`到您的`Gemfile`并运行`bundle install`. 然后，在您进行转换的任何脚本中，您将编写如下内容：

```
require 'ffi-ogr'

# read in GeoJSON
geojson = OGR.read 'path/to/file.geojson'

# output as KML, write to file
geojson.to_kml 'destination/of/file.kml' 
```

GeoRuby 是相当新的，工具还没有很好地构建。但是，[@scooterw](https://github.com/scooterw)正在领导开发一些具有基本功能的 Ruby 工具。

查看[FOSS4G 2014 中的示例](https://github.com/scooterw/foss4g-examples)了解更多信息，并加入[Github 上的 GeoRubyists 组](https://github.com/geo-rubyists)。

# android - 线性布局（Android）上的边框问题

> ID：15558241
> 
> 赞同：3
> 
> 时间：2013-03-21T21:13:39.203
> 
> 标签：android, android-layout, android-linearlayout

![在此处输入图像描述](../Images/3a32b37157b2ba749c5f7f65e6850cd6.png)

> 以上是我的应用程序仪表板屏幕的屏幕截图。每个仪表板项目都是一个线性布局，我已将其设置为可点击，并在 OnClick 事件上应用了 background.xml，以在点击时显示不同的背景颜色。我遇到的问题是采购历史顶部的额外灰线。

我一直坚持下去。

这是我的**background.xml**文件

```
<?xml version="1.0" encoding="utf-8"?>
<shape xmlns:android="http://schemas.android.com/apk/res/android">
 <solid android:color="@drawable/bgColorButtonClick" />
 <stroke android:width="1dp" android:color="@drawable/llBorderColor" />
 <padding android:left="15dp" android:top="15dp" android:right="15dp" android:bottom="15dp" />
 </shape> 
```

非常感谢任何帮助。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T21:31:36.767

我认为问题在于您的 background.xml 文件中的笔划。

为什么不以编程方式设置不同的背景颜色？例如

```
layout.setBackgroundColor(Color.DKGRAY); 
```

# python - 设置 djangoappengine

> ID：15558243
> 
> 赞同：0
> 
> 时间：2013-03-21T21:13:46.033
> 
> 标签：python, django, google-app-engine

我正在尝试设置 djangoappengine。我已经从 git / bitbucket per [here](http://www.allbuttonspressed.com/projects/djangoappengine#installation)克隆了代码（按照 Google 的一些链接），复制到 django-testapp 并为我自己的应用程序重命名。

但是 python manage.py runserver 遇到了这个问题：

```
 Traceback (most recent call last):
  File "manage.py", line 11, in <module>
    execute_manager(settings)
  File "/Users/gimli/sandbox/iAgri/whipple/django/core/management/__init__.py", line 438, in execute_manager
    utility.execute()
  File "/Users/gimli/sandbox/iAgri/whipple/django/core/management/__init__.py", line 379, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File "/Users/gimli/sandbox/iAgri/whipple/django/core/management/__init__.py", line 261, in fetch_command
    klass = load_command_class(app_name, subcommand)
  File "/Users/gimli/sandbox/iAgri/whipple/django/core/management/__init__.py", line 67, in load_command_class
    module = import_module('%s.management.commands.%s' % (app_name, name))
  File "/Users/gimli/sandbox/iAgri/whipple/django/utils/importlib.py", line 35, in import_module
    __import__(name)
  File "/Users/gimli/sandbox/iAgri/whipple/djangoappengine/management/commands/runserver.py", line 5, in <module>
    from django.db import connections
  File "/Users/gimli/sandbox/iAgri/whipple/django/db/__init__.py", line 78, in <module>
    connection = connections[DEFAULT_DB_ALIAS]
  File "/Users/gimli/sandbox/iAgri/whipple/django/db/utils.py", line 94, in __getitem__
    conn = backend.DatabaseWrapper(db, alias)
  File "/Users/gimli/sandbox/iAgri/whipple/dbindexer/base.py", line 54, in DatabaseWrapper
    return Wrapper(merged_settings, *args, **kwargs)
  File "/Users/gimli/sandbox/iAgri/whipple/dbindexer/base.py", line 37, in __init__
    super(BaseDatabaseWrapper, self).__init__(*args, **kwargs)
  File "/Users/gimli/sandbox/iAgri/whipple/djangoappengine/db/base.py", line 290, in __init__
    self.ops = DatabaseOperations(self)
TypeError: __init__() takes exactly 1 argument (2 given) 
```

我用谷歌搜索，随着时间的推移，该项目似乎出现了此类错误，但没有一个解决方案似乎是最新的。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-30T12:38:02.207

要运行[djangoappengine](https://github.com/django-nonrel/djangoappengine)，请在您的应用程序根目录中获取以下模块并复制：

1.[自动加载](https://github.com/praekelt/autoload)

2.[数据库索引器](https://github.com/django-nonrel/django-dbindexer)

3.djangoappengine [_](https://github.com/django-nonrel/djangoappengine)

4.django[工具箱](https://github.com/django-nonrel/djangotoolbox)

5.django（我认为它是可选的）

你可以得到[django-testapp](https://github.com/django-nonrel/django-testapp)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T12:06:19.390

**不要使用来自 bitbucket 的代码或来自 allbuttonspressed 的文档！**

它们既旧又过时。该项目的新家是：

**[http://django-nonrel.org/](http://django-nonrel.org/)**

在那里，您会找到不错的文档和当前的下载链接。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T23:39:25.313

allbuttonspressed 文档很旧，需要更新，尤其是在安装方面。幸运的是，有人构建了一个安装程序（我没有尝试过）：

[https://groups.google.com/forum/?fromgroups=#!topic/django-non-relational/Nlkh-zldQ6w](https://groups.google.com/forum/?fromgroups=#!topic/django-non-relational/Nlkh-zldQ6w)

# ajax - jQuery back 插件的 Path.js 问题

> ID：15558244
> 
> 赞同：1
> 
> 时间：2013-03-21T21:13:46.500
> 
> 标签：ajax, refresh, path.js

我已经决定使用 path.js 作为我的 jQuery 插件来实现返回/重新加载功能，它几乎可以启动并运行，但似乎无法正常工作。插件链接：[https ://github.com/mtrpcic/pathjs](https://github.com/mtrpcic/pathjs)

头：

```
<script type="text/javascript" src="jquery.js"></script>  
<script type="text/javascript" src="core.js"></script>
<script type="text/javascript" src="path.js"></script>
<script type="text/javascript" src="back.js"></script> 
```

导航：

```
<div id="leftnav">
        <p class="leftnavtext">
            <a class="navlinks" id="about2" href="#/about">ABOUT</a> <br>
            <a class="navlinks" id="process2" href="#/process">PROCESS</a> <br>
            <a class="navlinks" id="materials2" href="#/materials">MATERIALS</a> <br>
            <a class="navlinks" id="pricing2" href="#/pricing">PRICING</a>
        </p> 
```

AJAX Javascript 代码：

```
$(document).ready(function(){
  $("#about2").click(function(){
    $("#content").load("content.html #about");
});
  $("#process2").click(function(){ 
    $("#content").load("content.html #process");
 });
  $("#materials2").click(function(){ 
    $("#content").load("content.html #materials");
});
  $("#pricing2").click(function(){
    $("#content").load("content.html #pricing");
 });
   $("#pricing3").click(function(){
    $("#content").load("content.html #pricing");
});
   $("#infinite1").click(function(){
    $("#content").load("content.html #infinite");
});

}); 
```

Path.js 代码（header 中的 back.js，path.js 是插件。）：

```
function notFound(){
            $("#content .content").html("404 Not Found");
            $("#content .content").addClass("Error");
        }

        function setPageBackground(){
            $("#content .content").removeClass("Error");
        }        

        Path.map("#/about").to(function(){
            $("#content .content").html("About");
        }).enter(setPageBackground);

       Path.map("#/process").to(function(){
            $("#content .content").html("Process");
        }).enter(setPageBackground);

       Path.map("#/materials").to(function(){
            $("#content .content").html("Materials");
        }).enter(setPageBackground);

       Path.map("#/pricing").to(function(){
            $("#content .content").html("Pricing");
        }).enter(setPageBackground);

        Path.root("#/about");
        Path.rescue(notFound);

        $(document).ready(function(){

            Path.listen();
 }); 
```

谁能看到我哪里出了问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-04T16:02:23.123

如果您尝试`/#/materials`通过在浏览器地址栏中输入 url 直接导航到，[根据作者的](https://github.com/mtrpcic/pathjs/issues/31#issuecomment-6660068)说法，PathJS 目前不支持此功能，因为它仅用于客户端路由。

我通过包含`Path.history.pushState({}, "", location.hash);`在我的 onload 脚本中解决了这个问题。

# java - 为什么Java使用堆数据结构来存储对象？

> ID：15558245
> 
> 赞同：7
> 
> 时间：2013-03-21T21:14:03.027
> 
> 标签：java, memory-management, data-structures, heap, heap-memory

或者它不使用堆“数据结构”。分配给内存的名称（内存池）只是称为“堆”吗？

如果是，那么在内存池中堆数据结构和堆之间是否有任何关系？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-21T21:15:56.737

[堆内存](http://en.wikipedia.org/wiki/Dynamic_memory_allocation#Dynamic_memory_allocation)和[堆数据结构](http://en.wikipedia.org/wiki/Heap_%28data_structure%29)之间没有关系。他们只是碰巧同名。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T21:17:05.030

您是在谈论堆内存和堆栈内存之间的区别吗？

我会解释它，但这个答案很甜蜜

[堆栈和堆是什么以及在哪里？](https://stackoverflow.com/questions/79923/what-and-where-are-the-stack-and-heap)

# asp.net - ASP.NET 解析器错误仅在服务器上

> ID：15558247
> 
> 赞同：0
> 
> 时间：2013-03-21T21:14:19.980
> 
> 标签：asp.net, iis

我收到了常见的 YSOD Parser 错误，如下所示：

```
 Server Error in '/' Application.
 --------------------------------------------------------------------------------

 Parser Error 
 Description: An error occurred during the parsing of a resource required to service this request. Please review the following specific parse error details and modify your source file appropriately. 

 Parser Error Message: Could not load type '_3rd_party_data_reporting_tool.edtk'.

 Source Error: 

 Line 1:  <%@ Page Language="vb" AutoEventWireup="false" CodeBehind="edtk.aspx.vb" Inherits="_3rd_party_data_reporting_tool.edtk" %>
 Line 2:  
 Line 3:  <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

 Source File: /gpo/edtk.aspx    Line: 1

 --------------------------------------------------------------------------------
 Version Information: Microsoft .NET Framework Version:2.0.50727.3082; ASP.NET Version:2.0.50727.3082 
```

问题是我只有在将错误发布到目标网络服务器后才会收到错误消息。它在 localhost 中运行良好，如果我将它发布到我机器上的 IIS 并从那里运行它，它运行良好。任何想法可能是什么问题？

# loops - 识别元素列表中的唯一字符串值

> ID：15558249
> 
> 赞同：0
> 
> 时间：2013-03-21T21:14:24.057
> 
> 标签：loops, stata, unique-values

我有一个不平衡的大型数据集，其中每个观察都可以采用多个字符串值，每个值都存储在一个单独的变量中：

```
obs    year   var1    var2    var3    newval  

1      1990   str1    str2    str3     3   

1      1991   str1    str4    str5     2  

2      1990   str3    str4             2  

2      1991   str4    str5             1  

2      1993   str3    str5             0 

2      1994   str7                     1 
```

在每个时间点和每次观察，我都需要计算字符串值是否是“新的”。这意味着它们没有出现在前几年的观察值中。

我应该如何在Stata中解决这个问题？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T02:06:55.543

这个问题也发布在Statalist上。这是我的答案。`merge`除非问题始于两个或更多文件，否则我倾向于不使用s。

```
clear
input obs     yr   str4 var1 str4  var2 str4   var3
1        90   str1    str2    str3
1        91    str1    str4    str5
2        90    str3    str4
2        91    str4    str5
2        93    str3    str5
2        94    str7
end
reshape long var , i(obs yr) j(which)
bysort obs var (yr) : gen new = _n == 1 & !missing(var)
bysort obs yr : replace new = sum(new)
by obs yr : replace new = new[_N]
reshape wide var, i(obs yr) j(which) 
```

（更多）进一步的评论主要集中在效率上，这意味着这里的速度而不是空间。（存储空间*可能*会咬海报。）

如果没有重组，这里使用`reshape`，问题是一个三重循环：超过标识符，超过每个标识符的观察和变量。可能两个外环可以折叠成一个。但是在Stata中，对观察结果的显式循环通常很慢。

使用 Dimitriy 和我提出的重组解决方案，`by:`操作直接进入编译代码并且相对较快：`reshape`是解释代码并且需要文件操作，因此可能很慢。另一方面`reshape`，有一些经验可以很快写下来，而且确实值得获得`reshape`经验所带来的流畅性。除了帮助`reshape`和手动输入，请参阅我在[http://www.stata.com/support/faqs/data-management/problems-with-reshape/](http://www.stata.com/support/faqs/data-management/problems-with-reshape/)`reshape`上写的常见问题解答

另一个考虑因素是您还想对这种数据集做什么。如果还有其他类似特征的问题，通常使用由 生成的长结构会更容易`reshape`，因此保留该结构将是一个好主意。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T22:52:00.113

可能有一种更优雅的方法可以做到这一点。

主要思想是我首先重塑数据并按顺序计算每个字符串的出现次数。重塑使这更容易。然后我将与折叠聚合，但只计算每个字符串出现的第一个实例。然后我将重新加入您的原始数据。

```
#delimit;

preserve;
    tempfile newval;

    reshape long var, i(obs year) j(s); // stack all the vars on top of each other
    bys obs var (year): gen n=_n if !missing(var); // number the appearance of each string in chronological order
    replace n=0 if n>1 & !missing(n); // only count the first instance

    collapse (sum) mynewval=n, by(obs year); // add up the counts
    save `newval';
restore;

merge 1:1 obs year using `newval', nogen;

compare newval mynewval; 
```

# python - 格式化文本 (.prn) 文件中的数据

> ID：15558252
> 
> 赞同：0
> 
> 时间：2013-03-21T21:14:39.837
> 
> 标签：python, web-scraping, beautifulsoup, mechanize

我试图找出处理以下数据的最佳方法。我正在抓取一个站点并使用文本 (.prn) 文件（用于打印的文件，这是包含我想要的数据的文件，我认为这会比 Adob​​e Acrobat 文件更好）来收集数据。我的问题是当我将数据带入 python 时：数据只是在屏幕上一次一个字母垂直向下出现，所以即使有多行，这些数据也只是在一列中流入。我想知道是否有人会知道如何以更“传统”的方式输入数据，我可以引入 row[0]、row [1] 等......这是我的代码以防万一（你还可以看到我尝试过的其他一些功能）。

```
import os
import urllib
import urllib2
import string
import sys
import os
from bs4 import BeautifulSoup
import csv
import mechanize
from numpy import*
import datetime
import traceback
from pylab import*
site="http://www.treasurydirect.gov/govt/reports/pd/mspd/mspd.htm"

br = mechanize.Browser()
br.set_handle_equiv(False)
br.open(site)
print 'br.title',br.title()
allforms = list(br.forms())
br.form = allforms[0]
br.follow_link(text_regex="February", nr=0)
#br.click_link(text='February', nr=0) # this works to

#next page
print br.title()
allforms = list(br.forms())
print allforms
br.form = allforms[0]   
getstuff=br.click_link(text="Text (.prn)", nr=0) # this works to
#getstuff= br.click_link(text="Adobe Acrobat (.pdf)", nr=0)  Adobe Acrobat (.pdf)

br.open(getstuff)

csvData=br.response().read() # use read to BeautifulSoup(x)
#site = BeautifulSoup(csvData)
#print site
for row in csvData:
 print row[0] 
```

以下是文本 (.prt) 文件所在的确切网站页面： [http ://www.treasurydirect.gov/govt/reports/pd/mspd/2013/2013_feb.htm](http://www.treasurydirect.gov/govt/reports/pd/mspd/2013/2013_feb.htm)

我正在尝试处理摘要下的文本（.prn）文件中的数据。请就处理数据的最佳方式提供建议。

我正在使用 python27、mechanize、beautiful soup 和 urllib

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T23:28:07.167

*用漂亮*的汤读取文本文件似乎会给您返回 csvData 中的单个字符串，而不是您期望的行列表。因此，对字符串进行迭代会在每个迭代步骤中返回一个字符。这就是为什么您的文本似乎转换为单列的原因。

首先，你似乎根本不需要*漂亮的汤*！您正在检索文本文件，而不是 HTML 文件。*Beautiful Soup*是一个 HTML/XML 解析器。*mechanize*对我来说似乎也没有必要（我已经看过[你之前的问题](https://stackoverflow.com/questions/15487772/python-mechanize-open-a-text-file-with-mechanize)，但实际上，你不需要解析 HTML 页面来发现链接，因为你已经知道最终的 url）。

对我来说，您应该将算法分为三个部分：

*   将文本检索为行列表
*   删除不必要的行
*   格式化您的行以适合您的目的

您的问题似乎主要与第一部分有关，但是由于您还询问有关如何检索最终数据的建议，我想您也需要另外两个:)

这是我的建议：让我们开始定义三个函数，一个用于算法的每个部分......

```
import urllib2, re

def get_data_text(month, year):
    """given a month and a year, this method returns the raw data file (as a list of rows)"""
    url_pattern = 'http://www.treasurydirect.gov/govt/reports/pd/mspd/{year:4d}/opds{month:02d}{year:4d}.prn'
    url = url_pattern.format(month=month, year=year)
    source = urllib2.urlopen(url)
    data = source.readlines()
    source.close()
    return data

def keep_only_interesting_rows(data, interesting_rows):
    """filter data rows in order to keep only the ones that start with strings in interesting_rows list"""
    return [line for line in data if any([line.strip().startswith(ir) for ir in interesting_rows])]

def convert_data_to_dict(data):
    """converts every row in data to a dictionary element """
    return {re.sub('\.*\s*$', '', el[0:46]).strip():(int(el[47:63].replace(',','')), int(el[69:90].replace(',','')), int(el[95:115].replace(',',''))) for el in data} 
```

所以现在我已经定义了三个函数，一个用于我提出的解决方案中的每个部分。

* * *

如何使用这些功能？这是一个例子：

```
interesting_rows = ['Bills', 'Notes', 'Total Public Debt Outstanding']  # add the initial part of any row you are interested at (without leading spaces)

mytext = get_data_text(2, 2013)  # gets the text for feb, 2013 as rows
data = keep_only_interesting_rows(mytext, interesting_rows)  # filter rows
final_data = convert_data_to_dict(data)  # convert remaining rows into a dict

print final_data
print final_data['Bills'][2]  # this gives you the third column

# >>> {'Notes': (7416574, 5888, 7422462), 'Bills': (1738404, 3546, 1741950), 'Total Public Debt Outstanding': (11822436, 4864853, 16687289)}
# >>> 1741950 
```

* * *

如果您愿意，无论出于何种原因，访问初始文本文件（.prn 文件）中的精确行，您可以键入：

```
mytext = get_data_text(9, 2012)  # this time let's get the text for September, 2012 
print mytext[0] 
```

返回：

```
 MONTHLY STATEMENT OF THE PUBLIC DEBT 
```

# configuration - Log4Net 到外部配置的相对路径

> ID：15558253
> 
> 赞同：3
> 
> 时间：2013-03-21T21:14:39.837
> 
> 标签：configuration, log4net, relative-path

我有一种情况，我从我的 web 根配置中引用了一个外部 Log4Net 配置文件。但是，我的个人应用程序继承了 Web 根配置并反过来引用外部 Log4Net 配置文件。

如果我有一个到 Log4Net Config 的硬编码路径，这一切都可以正常工作。例如：c:\inetpub\wwwroot\logging.config

我想做的是引用这个 logging.config 而不必指定驱动器号或最好通过相对路径。如果网站现在存在于 E:\ 或 D:\ 或 F:\ 驱动器上，这将使切换环境变得容易。

我尝试以这种形式引用文件：\inetpub\wwwroot\logging.config - 但 Log4Net 似乎没有选择它。

我也考虑过在代码中从 HttpRuntime.AppDomainAppPath 中获取驱动器号，但它看起来很hack'ish。

有没有人想出一种奇特的方法来使用引用路径而不是硬编码路径来引用外部 Log4Net 配置文件？

提前感谢大家的帮助。:)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-05-21T10:56:29.067

我遇到过同样的问题。我想在我的解决方案中创建一个名为 Logs 的文件夹并将所有日志放入其中，但如果没有驱动器号，它就无法工作。

我在文件夹名称之前添加了一个反斜杠，并且在删除它之后才起作用。

```
<file value="Logs\RedmineTaskCreator.log" /> 
```

只需确保存在 Logs 文件夹即可。我不确定 log4net 是否会创建该文件夹。希望对你有效。

# highcharts - 如何在 Highstock 上设置 xAxis 最小值和最大值？

> ID：15558254
> 
> 赞同：4
> 
> 时间：2013-03-21T21:14:49.820
> 
> 标签：highcharts, highstock

我的 HighStock 图表有点问题。我正在绘制数据库中的数据，该数据库在特定时间段（3 天）内返回汽车的速度值。

例如，我想绘制 1 月 1 日 00:00 和 1 月 3 日 00:00 之间的速度值，但我只有 1 月 2 日的值……其他几天汽车停放。

正在发生的事情是，highstock 自动调整 xAxis 以适应有可用数据的时期，在这种情况下是 1 月 2 日......它没有向我显示汽车停放的其他 2 天。有没有办法在 xAxis 上设置固定的开始日期和结束日期？我试图在文档中找到一些东西，但到目前为止没有任何效果。

你可以帮帮我吗？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T12:39:50.377

您正在寻找的是 xAxis 的“最小”和“最大”属性：

[http://api.highcharts.com/highstock#xAxis.min](http://api.highcharts.com/highstock#xAxis.min)

[http://api.highcharts.com/highstock#xAxis.max](http://api.highcharts.com/highstock#xAxis.max)

如果您指定值，它不应自动为您计算它们。

如果这不起作用，您能否用您的代码发布一个[http://JSfiddle.net](http://JSfiddle.net)，以便我看一下？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T14:58:20.603

您可以尝试将 ordinal 设置为 false [http://api.highcharts.com/highstock#xAxis.ordinal](http://api.highcharts.com/highstock#xAxis.ordinal)或使用 tickPositioner 来定义刻度位置[http://api.highcharts.com/highstock#xAxis.tickPositioner](http://api.highcharts.com/highstock#xAxis.tickPositioner)

# c# - C#(WCF) - 在网络共享驱动器中创建 excel 文件

> ID：15558255
> 
> 赞同：0
> 
> 时间：2013-03-21T21:14:49.843
> 
> 标签：c#, visual-studio-2010, excel, oledb, wcf-data-services

我的Visual Studio项目存储在`C:\Projects`项目名称是`Project1`，文件名是`Test.xls`

```
string directory = AppDomain.CurrentDomain.BaseDirectory;
// directory = C:\\Projects\\Project1 (local drive)

directory = directory.Remove(0, 2);
// directory = \\Projects\\Project1

string newDirectory = "\\server" + directory; 
// newDirectory = \\server\\Projects\\Project1 (now, network shared drive)

string pathCreate = System.IO.Path.Combine(newDirectory, file);
// pathCreate = \\server\\Projects\\Project1\\Test.xls
string excelConStr = @"Provider=Microsoft.Jet.OLEDB.4.0; Data Source=" + pathCreate + @"; Extended Properties=""Excel 8.0;HDR=Yes; MultipleActiveResultSets=True"";";

private void CreateExcel(string excelConStr)
    {
        DataTable table = new DataTable();
        using (OleDbConnection excelCreateCon = new OleDbConnection(excelConStr))
        {
            OleDbCommand excelCreateCmd = new OleDbCommand();
            excelCreateCmd.Connection = excelCreateCon

            ... 
```

使用调试，excelConStr 返回

```
"Provider=Microsoft.Jet.OLEDB.4.0; Data Source=\\server\\Projects\\Project1\\Test.xls; Extended Properties=\"Excel 8.0;HDR=Yes; MultipleActiveResultSets=True\";"

excelCreateCmd.Connection.DataSource returns "\\server\\Projects\\Project1\\Test.xls" 
```

看起来不错。但是，它给了我以下错误：`'C:\server\Projects\Project1\Test.xls' is not a valid path. Make sure that the path name is spelled correctly and that you are connected to the server on which the file resides.`

有什么建议可以解决这个问题吗？请高手！！（注：不存在PERMISSON问题）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T21:20:18.497

对于网络，我认为您不需要 \server 但需要 \\server，不是吗？

# php - javascript在动态下载的html上执行

> ID：15558256
> 
> 赞同：1
> 
> 时间：2013-03-21T21:14:58.943
> 
> 标签：php, javascript, jquery, twitter-bootstrap

我相信我已经在某处看到了这一点，但过去 30 分钟的谷歌搜索并没有得到可接受的答案。

我正在使用 Bootstrap 生成一个弹出框。我使用以下方法将表格下载到 div 中：

```
$(document).ready(function() {
  $('#jobTable').load('./includes/job_table.inc.php');
  $('#commpop').popover({trigger: 'hover'});
  setInterval(function() {
    $('#jobTable').load('./includes/job_table.inc.php');
    $('#jobTable #commpop').popover({trigger: 'hover'});
  }, 5000);//end reload
});//end load 
```

这在以下情况下执行良好：

```
<a href="#" class="btn btn-success" id="commpop" rel="popover"
data-content="I'm working!" data-original-title="Further Details">hey you!</a> 
```

它存在于我的基本 php 文件中，但不适`<div id="jobTable"></div>`用于动态下载的放置在其中的相同语句。

我如何也将其应用于该 div？你可以看到我上面的尝试不起作用......

**编辑：**是的，这`$('#jobTable').load('./includes/job_table.inc.php');`是我用来下载然后定期刷新表的 jQuery AJAX 语句。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T21:20:22.900

```
$(document).ready(function() {
  $('#jobTable').load('./includes/job_table.inc.php', function() {
  alert('Load was performed.');
// do all your work here
});

});//end load 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T21:25:15.663

我想采用上述答案，但不要定义像'./includes/job_table.inc.php'这样的部分路径，而是定义完整路径。它可能会有所帮助！

# php - Codeigniter - 输入数据库的日期/时间

> ID：15558260
> 
> 赞同：0
> 
> 时间：2013-03-21T21:15:11.320
> 
> 标签：php, codeigniter

我已经阅读了许多关于 CI 在使用活动记录时如何转义 NOW() 函数的指南/页面等。

我试图在一个变量中使用一个函数，然后在我的数组中调用它，它将各种字段输入到数据库中；但它似乎根本不起作用。我尝试过的两种方法如下，第二种在数据库中被解释为0000-00-00；第一个将我的 AJAX 控制器放入一个循环中，导致根本没有添加任何数据..

谢谢！

尝试 1

```
if ($this->form_validation->run() != FALSE) 
        {
            // Passed the form validation

            **$initiated_date =  $this->db->set('date', 'NOW()', FALSE);**  

            $order = array(

                'status'          => $this->input->post('status'), 
                'priority'        => $this->input->post('priority'), 
                'target_date'     => $this->input->post('target_date'),
                'initiated_date'  => $this->input->post('$initiated_date'),
                'requestor_name'  => $this->input->post('requestor_name'),
                'requestor_telno' => $this->input->post('telephone'),           
                'job_description'        => $this->input->post('job_desc'), 
                'trade_type'    => $this->input->post('trade')

            ); 
```

尝试 2

```
 if ($this->form_validation->run() != FALSE) 
            {
                // Passed the form validation

                $initiated_date =  $this->db->set('date', 'NOW()', FALSE);  

                $order = array(

                    'status'          => $this->input->post('status'), 
                    'priority'        => $this->input->post('priority'), 
                    'target_date'     => $this->input->post('target_date'),
                    'initiated_date'  => $this->input->post('date', 'NOW()', FALSE), 
                    'requestor_name'  => $this->input->post('requestor_name'),
                    'requestor_telno' => $this->input->post('telephone'),           
                    'job_description'        => $this->input->post('job_desc'), 
                    'trade_type'    => $this->input->post('trade')

                ); 
```

**工作解决方案**

```
//sets variable and uses php date function
            $initiated_date =  date('Y-m-d');  

        $order = array(

            'status'          => $this->input->post('status'), 
            'priority'        => $this->input->post('priority'), 
            'target_date'     => $this->input->post('target_date'),
            'initiated_date'  => $initiated_date,
            'requestor_name'  => $this->input->post('requestor_name'),
            'requestor_telno' => $this->input->post('telephone'),           
            'job_description'        => $this->input->post('job_desc'), 
            'trade_type'    => $this->input->post('trade')

        ); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T21:23:14.843

CI input->post 函数用于从 $_POST ( [http://ellislab.com/codeigniter/user-guide/libraries/input.html](http://ellislab.com/codeigniter/user-guide/libraries/input.html) )中提取数据

我认为这就是您要完成的任务：

'initiated_date' => $initiated_date

如果要设置initiated_date 为时间戳，可以使用php time() 函数： $initiated_date = time()

# maven - 从属性动态添加 Maven 依赖项

> ID：15558265
> 
> 赞同：3
> 
> 时间：2013-03-21T21:15:20.820
> 
> 标签：maven

我正在尝试向`system`我的 POM 添加范围依赖项。诀窍是我没有`systemPath`. 相反，我有一个属性文件的路径，其中包含我可以用作路径的属性。

我尝试使用[properties-maven-plugin](http://mojo.codehaus.org/properties-maven-plugin/index.html)来处理这个问题，但似乎系统依赖项在插件运行之前得到了解决，因此我试图定义的属性还不够快。

这是我的 POM 的部分：

```
<profiles>
    <profile>
        <id>dylink</id>
        <dependencies>
            <dependency>
                <artifactId>outside-lib</artifactId>
                <groupId>com.foo</groupId>
                <version>1.0</version>
                <scope>system</scope>
                <systemPath>${outsidelib.location}/outside-lib.jar</systemPath>
            </dependency>
        </dependencies>
        <build>
            <plugins>
                <plugin>
                    <groupId>org.codehaus.mojo</groupId>
                    <artifactId>properties-maven-plugin</artifactId>
                    <version>1.0-alpha-2</version>
                    <executions>
                        <execution>
                            <phase>initialize</phase>
                            <goals>
                                <goal>read-project-properties</goal>
                            </goals>
                            <configuration>
                                <files>
                                    <file>C:\path\to\file.properties</file>
                                </files>
                            </configuration>
                        </execution>
                    </executions>
                </plugin>
            </plugins>
        </build>
    </profile>
</profiles> 
```

我运行类似的东西`mvn -P dylink compile`并被告知 my`systemPath`无效，因为它不是绝对路径。（该属性包含绝对路径）

或者，还有其他方法可以做到这一点吗？我需要能够查询主机系统以获取系统范围依赖项的位置。仅将路径硬编码到 POM 中是行不通的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-11T21:55:06.020

这不可能。为了执行插件，maven 需要在本地存储库中“下载”所有需要的东西。它需要确定依赖项的版本，这些版本通常在属性中定义。因此，在执行插件之前，它需要先找到属性值，然后再下载所有缺失的内容。您希望在定义属性值之前执行插件...

我猜属性插件在执行时会添加额外的属性值，但这是在 maven 依赖项检查之后发生的......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T21:35:39.400

我在这里猜测，但如果你必须动态指定它，那是因为你必须在另一个环境中运行它。您可以做的仍然是使用 maven 属性，但您可以将其作为参数传递到命令行：

```
mvn -Doutsidelib.location=myAbsolutePathReadFromPropertyFileJustBefore 
```

当然，在运行 maven 命令之前，您必须阅读属性文件或设置环境变量。

# jquery - jquery 在 SELECT 中获取选定的选项

> ID：15558274
> 
> 赞同：0
> 
> 时间：2013-03-21T21:15:35.337
> 
> 标签：jquery

有没有区别

```
$("#myselectname option:selected").val() 
```

和

```
$("#myselectname").val() 
```

，其中 myselectname 是 SELECT 的标识符。我可以看到两者返回相同。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T21:16:54.257

是的，第一个获取被选中选项的值，第二个获取被选中选项本身的值，而select的值会和被选中的选项相等，所以它们都会返回相同的值，但它们不一样事物。

最后一个通常是最好的选择，因为它有一个只使用 getElementById 的选择器，并且没有 DOM 遍历，因此会更快更直接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T21:17:05.897

没有。没有任何区别。`val()`返回当前选中的项目。唯一的区别是第二个版本稍微快一些，因为第一个版本是多余的。

# knockout.js - 我可以从 JSON 创建 ko 可观察对象吗

> ID：15558275
> 
> 赞同：1
> 
> 时间：2013-03-21T21:15:39.583
> 
> 标签：knockout.js, knockout-mapping-plugin

我在服务器上创建了一个 json 字符串。我可以在没有先在 jscript 中定义其可观察属性的情况下创建一个新的、可观察的结构化对象吗？我定义了一个变量：

```
var viewModel; 
```

使用从 ajax 调用返回的 jsonString，我使用：

> viewModel = ko.mapping.fromJSON(jsonString);

当我`ko.applyBindings`- 它抛出一个找不到可观察对象错误。

我在 viewModel 中看不到任何属性。我错过了什么？

# python-2.7 - Gunicorn 500'ing on POST to Flask app

> ID：15558276
> 
> 赞同：2
> 
> 时间：2013-03-21T21:15:39.837
> 
> 标签：python-2.7, flask, virtualenv, gunicorn

这是 Flask 应用程序：

```
from flask import Flask, request, render_template, redirect, url_for, flash
app = Flask(__name__)

@app.route('/')
def index():
    return render_template('index.html')

@app.route('/contact', methods = ['POST'])
def contact():
    if request.method == 'POST':
        name = request.form['name']
        email = request.form['email']
        message = request.form['message']

        flash(name)
        flash(email)
        flash(message)

    return redirect(url_for('index'))

if __name__ == '__main__':
    app.debug = True
    app.secret_key='a;sldfjka;oeiga;lbneas; biaweag'
    app.run() 
```

这是我正在使用的模板：

```
<!DOCTYPE html>
<html>
    <head>
    </head>

    <body> 
        <form action="/contact" method="post">
            <input type="text" name="name" />
            <input type="text" name="email" />
            <textarea name="message"> </textarea>
            <input type="submit" />
        </form> 
        <ul>
        {% for message in get_flashed_messages() %}
            <li><h3> {{ message }} </h3></li>
        {% endfor %}
        </ul>
    </body>
</html> 
```

这是`gunicorn`我用来服务它的命令行：

```
gunicorn --error-logfile err.log --access-logfile access.log \
--log-level debug -b 127.0.0.1:5000 --debug -w 4 wsgi:app 
```

它可以很好地为模板提供 GET 请求。但是，当我实际发布表单时，它已经 500 了。这是响应标头：

```
HTTP/1.1 500 INTERNAL SERVER ERROR
Server: gunicorn/0.17.2
Date: Thu, 21 Mar 2013 21:57:25 GMT
Connection: close
Content-Type: text/html
Content-Length: 291 
```

这是 gunicorn 日志中显示的内容：

```
==> err.log <==
2013-03-21 17:12:38 [10092] [DEBUG] POST /contact

==> access.log <==
"127.0.0.1 - - [21/Mar/2013:17:12:38] "POST /contact HTTP/1.1" 500 291 \
"http://localhost:5000/" "Mozilla/5.0 (X11; Linux x86_64; rv:19.0) \
Gecko/20100101 Firefox/19.0" 
```

当我使用 Flask 的内置开发服务器提供服务时工作正常。

啊大脑告诉我，这是我只是想念的非常简单的东西。嗯。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-23T06:09:21.913

我在 name == main 块中定义了 secret_key。Gunicorn 感到窒息，因为该应用程序没有说它需要处理表单提交的密钥。

```
if __name__ == '__main__':
    app.secret_key = #... 
```

这条线需要......在其他任何地方，只要它在脚本由 gunicorn 运行时得到评估。

```
app = Flask(__name__)
app.secret_key = #... 
```

我认为值得指出的是，如果我设置了任何体面的日志记录，我会立即发现这个小问题。

# haskell - 如何从 Haskell 中的 10 元组中获取第 n 个元素？

> ID：15558278
> 
> 赞同：30
> 
> 时间：2013-03-21T21:15:42.677
> 
> 标签：haskell, tuples

我必须在 Haskell 元组中获取第 n 个元素。元组是这样的： (3,5,"String1","String2","String3","String4","String5","String6","String7","String8","String9","String10 ”）。你能给我一个想法，以便我可以解决这个问题吗？谢谢。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2013-03-21T21:23:39.220

您可能知道也可能不知道 fst 和 snd 仅适用于 2 元素元组，即

```
fst' (a,b) = a 
```

据我所知，你必须自己写

```
get5th (_,_,_,_,a,_,_,_,_,_) = a 
```

如您所见，您可能想要定义自己的类型。

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2013-03-21T21:23:11.603

你可以通过模式匹配来做到这一点。就像你可以匹配一个二值或三值元组一样，你也可以匹配一个十值元组。

```
let (_, _, _, _, _, _, _, _, _, x, _, _) = tuple in x 
```

但是，您可能*不想*这样做。如果您试图从元组中获取第 n 个值，那么您几乎肯定使用了错误的类型。在 Haskell 中，不同长度的元组是不同的*类型*——它们从根本上是不兼容的。就像`Int`和`String`不同，`(Int, Int)`也`(Int, Int, Int)`完全不同。

如果您想要一个可以获取第 n 个元素的数据类型，您需要一个列表：类似于`[String]`. 使用列表，您可以使用`!!`运算符进行索引（从 0 开始），因此您可以这样做：

```
myList !! 9 
```

获得第 10 个元素。

鉴于你的例子，我怀疑你想要一个类型`(Int, Int, [String])`而不是一个巨大的元组。这将使您有两个数字和任意数量的字符串；您可以使用上述运算符按索引获取字符串`!!`。

* * *

## 回答 #3

> 赞同：24
> 
> 时间：2013-03-21T22:32:44.580

您可能想使用[tuple 包中的选择功能](http://hackage.haskell.org/packages/archive/tuple/0.2.0.1/doc/html/Data-Tuple-Select.html)。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2017-02-21T13:33:17.993

如果您只需要每个元组执行一次，并且一次需要所有元素，则可以简单地使用

```
let (x, y, s1, s2, s3, s4, s5, s6, s7, s8) = someTuple
in ... 
```

并直接使用这些值。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-01-21T05:45:22.583

我认为您最好使用记录类型，例如：

```
data MyRec = MyRec {myrecfoo::Double, myrecbar::String, myrecbaz::String} 
```

然后使用记录访问器：

```
baz = myrecbaz rec 
```

但是如果你想/需要坚持使用元组并且有少于 20 个字段，你可以使用[Control.Lens.Tuple](https://hackage.haskell.org/package/lens/docs/Control-Lens-Tuple.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-05-24T18:23:42.030

当我为同一问题寻找解决方案时，我已经看到了您的问题。我读过“！！” 运营商是一个糟糕的解决方案。我想到了一个解决方案：

例如，如果列表中的每个元组都有三个元素，则可以这样做：

```
nTuple :: [(a, a, a)] -> Integer -> Integer -> [a]
nTuple list group position = [ fst x | x <- (concat [ fst x | x <- (zip [(zip[t1, t2, t3][0..]) | (t1, t2, t3) <- list ] [0..]) , snd(x) == group ]) , snd(x) == position] 
```

现在，一些测试用例：

```
*Main> nTuple [("l","m","n"),("o","p","q"),("r","s","t")] 2 1
["s"]

*Main> nTuple [("l","m","n"),("o","p","q"),("r","s","t")] 0 2
["n"]

*Main> nTuple [("l","m","n"),("o","p","q"),("r","s","t")] 100 2
[]

*Main> nTuple [("l","m","n"),("o","p","q"),("r","s","t")] 2 100
[] 
```

上述函数的逐步解释：

1.拆分元素并放一个索引：

```
[ zip[t1,t2,t3][0..] | (t1,t2,t3) <- [("l","m","n"),("o","p","q"),("r","s","t")]]

result: [[("l",0),("m",1),("n",2)],[("o",0),("p",1),("q",2)],[("r",0),("s",1),("t",2)]] 
```

2.为每个列表放置一个索引。现在我们在每个组中都有组和位置。

```
zip [[("l",0),("m",1),("n",2)],[("o",0),("p",1),("q",2)],[("r",0),("s",1),("t",2)]] [0..]

result: [([("l",0),("m",1),("n",2)],0),([("o",0),("p",1),("q",2)],1),([("r",0),("s",1),("t",2)],2)] 
```

3.我们可以选择一个组。例如组号 1（第一组是 0）与“snd(x)==1”

```
[ fst x | x <- [([("l",0),("m",1),("n",2)],0),([("o",0),("p",1),("q",2)],1),([("r",0),("s",1),("t",2)],2)] , snd(x) == 1 ]

result: [[("o",0),("p",1),("q",2)]] 
```

4.我们有一份清单。在单个元组列表中连接元组

```
concat [[("o",0),("p",1),("q",2)]]

result: [("o",0),("p",1),("q",2)] 
```

5.最后，我们通过索引得到一个元素。在这个例子中，我们得到第二个元素（第一个元素是“0”位置）

```
[ fst x | x <- [("o",0),("p",1),("q",2)] , snd(x) == 2]

result ["q"] 
```

# python - 如何使用 Haystack 添加额外的上下文

> ID：15558279
> 
> 赞同：1
> 
> 时间：2013-03-21T21:15:42.900
> 
> 标签：python, django, django-haystack

我已经在我的网站上设置了 Haystack 搜索。搜索工作正常，我真的很喜欢。我在添加额外上下文时遇到问题。我想将 3 个模型中的对象“推送”到我的模板。第一个对象是我的搜索结果，另外两个应该是附加的。我的问题是：如何从其他模型传递对象。这是我的**search_indexes.py**文件：

```
import datetime
from haystack.indexes import *
from haystack import site
from filmy.models import Video, Page, Category

class VideoIndex(SearchIndex):
    text = CharField(document=True, use_template=True)
    title = CharField(model_attr='title')
    description = CharField(model_attr='description')
    date = DateTimeField(model_attr='date')

    def index_queryset(self, using=None):
        # """Used when the entire index for model is updated."""
        return Video.objects.filter(date__lte=datetime.datetime.now())

    def extra_context(self):
        return {
            'categories': Category.objects.all().order_by('-name'),
            'list_of_pages': Page.objects.all().order_by('id'),
        }

site.register(Video, VideoIndex) 
```

搜索工作正常，但我想要一个所有类别的列表和所有页面的列表（我在 base.html 模板中使用它们。我的解决方案不起作用。我尝试了第二个子类：

```
import datetime
from haystack.indexes import *
from haystack import site
from filmy.models import Video, Page, Category

class VideoIndex(SearchIndex):
    text = CharField(document=True, use_template=True)
    title = CharField(model_attr='title')
    description = CharField(model_attr='description')
    date = DateTimeField(model_attr='date')

    def index_queryset(self, using=None):
        # """Used when the entire index for model is updated."""
        return Video.objects.filter(date__lte=datetime.datetime.now())

site.register(Video, VideoIndex)

class VideoSearchIndex(VideoIndex):
    def extra_context(self):
        extra = super(VideoSearchIndex, self).extra_context()
        extra['categories'] = Category.objects.all().order_by('-name')
        extra['list_of_pages'] = Page.objects.all().order_by('id')
        return extra 
```

但是这段代码也不起作用。我不知道如何在我的搜索结果中轻松实现其他模型。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T19:24:28.170

我找到了解决我的问题的方法。我无法用**extra_context**函数解决它，所以我使用 **TEMPLATE_CONTEXT_PROCESSORS**在我的模板中设置全局变量。

这是一个非常方便的解决方案，因为我不需要在我的所有模型中使用 extra_context 函数。我只是在一个定义中的一个文件中设置全局变量。它增加了 views.py 文件的可读性。

# c++ - QProgressDialog 在暂停期间不绘制

> ID：15558282
> 
> 赞同：1
> 
> 时间：2013-03-21T21:15:48.040
> 
> 标签：c++, linux, qt

我有理由在循环中使用 QProgressDialog，我希望对话框弹出并等待用户输入，然后再显示对话框。但是，在第二次循环中，对话框在开始正确更新之前保持不露面。这是一些示例代码：

```
QProgressDialog progressDialog("progress", "Cancel",
               0, 10000);
progressDialog.setMinimumDuration(0);
progressDialog.setWindowModality(Qt::WindowModal);

while(1) {

  progressDialog.show();
  progressDialog.setValue(0);

  qApp->processEvents();

  getchar();

  for(unsigned int i = 0; i < 10000; i++)
    progressDialog.setValue(i+1);
} 
```

第一次它显示对话框中的所有小部件，但第二次显示，什么都没有。如果我在循环内移动 QProgressDialog 声明，也会发生同样的事情。每次通过循环等待用户输入时，如何让它显示所有小部件，为什么它不在上面的代码中这样做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T21:34:28.333

这是因为您在 GUI 线程中完成所有工作。由于 getchar() 在用户输入某些内容之前不会返回，因此 GUI 线程无法重新绘制小部件和窗口。

你需要：

*   将工作代码（从用户读取数据并对其执行操作）移动到其他对象并在单独的线程中运行，很好的例子是在 qt-project 页面上：http: [//qt-project.org/doc/qt-4.8/qthread .html#详细信息](http://qt-project.org/doc/qt-4.8/qthread.html#details)
*   [使用信号和槽将worker对象与progressDialog连接起来](https://stackoverflow.com/questions/20657753/python-pyside-and-progress-bar-threading)

# haskell - 确认惰性评估

> ID：15558283
> 
> 赞同：6
> 
> 时间：2013-03-21T21:15:54.490
> 
> 标签：haskell, lazy-evaluation

我不小心删除了我的帖子，但为了澄清，我重新发布了这个问题。

如果我有一个功能：
`const x = 1`

如果我问 Haskell：
`const (1/0)`

它会返回`1`，因为惰性评估实际上并没有计算出什么`1/0`，对吧？它不需要。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-21T21:18:27.707

是的，这是正确的。`const`，正如您定义的那样，在评估它时总是会产生 1 - 无论参数是什么。并且由于参数与结果无关，因此不对其进行评估。因此，不会发生可能由评估参数引起的任何错误或未终止。

# c# - 为 HTML 格式电子邮件的潜力做准备 - c# WinForms

> ID：15558285
> 
> 赞同：0
> 
> 时间：2013-03-21T21:15:57.243
> 
> 标签：c#, .net, winforms, email, formatting

我正在写一个小的电子邮件处理小程序。它要么发送一封电子邮件（我知道是初级的），要么回复收到的电子邮件。在后一种情况下，我想在用户消息的文本框下方显示原始电子邮件。我在那里有另一个 TextBox，但我意识到大多数电子邮件客户端都以一种或另一种方式使用 HTML 格式，这将无法在 TextBox 中正确显示。

我真的不想让用户在一些花哨的预建所见即所得编辑器中格式化他们的电子邮件（我遇到的大多数潜在的解决方案都建议这种类型的东西），我只是想考虑到收到的电子邮件的可能性是用 HTML 格式化。我同样满足于从原始消息中剥离所有 HTML 格式，就像我在 TextBox 以外的控件中显示原始 HTML 内容一样，并在发送回复时将其原封不动地附加到未格式化的用户输入中，但我不看到也找不到优雅的方式来完成。

任何帮助是极大的赞赏。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T21:20:07.747

如果 HTML 是 text/html 则只显示 HTML，并且可能有一个预览按钮或带有 WebBrowser 的窗格，您可以通过管道将 HTML 传输到。

# php - AWS PHP SDK 版本 2 S3 文件名编码问题

> ID：15558289
> 
> 赞同：1
> 
> 时间：2013-03-21T21:16:08.887
> 
> 标签：php, sdk, amazon-web-services, amazon-s3

我们一直在使用 AWS 开发工具包上传/抓取文件，结果非常好，但我们遇到了障碍。

S3 中存储了一个文件，看起来像是被转义了。 `"/mefile/412501_413000/412604_-12%20C008%20Fil%20R[1].doc.gpg"`

到目前为止，SDK 已经设法处理了我们扔给它的每一个损坏的文件名。但是当我尝试“doesObjectExist”时，该文件也会失败。

`$s3->doesObjectExist("mabucket","/mefile/412501_413000/412604_-12%20C008%20Fil%20R[1].doc.gpg")`

总会失败。我尝试从本地存储上传该文件，但也失败了。我得到一个时髦的例外：“我们计算的请求签名与您提供的签名不匹配。检查您的密钥和签名方法。”

在使用“doesObjectExist”之前，我需要对文件名进行编码吗？它似乎已经处理了各种错误的文件名（空格/utf-8 字符/& 等），所以我很困惑为什么这不起作用。

**更新：** 升级到适用于 PHP 2.2.1 的最新 AWS 开发工具包。在版本 2.1.0 上运行，显然有几个错误。如果您使用的是 Ubuntu 10.04，这有点粗糙。（请参阅此处有关 PHP 版本升级的评论：[http](http://www.zalexblog.com/2011/01/07/installing-php-5-3-3-on-ubuntu-10-04/) ://www.zalexblog.com/2011/01/07/installing-php-5-3-3-on-ubuntu-10-04/ ）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T21:26:56.593

升级到适用于 PHP 2.2.1 的最新 AWS 开发工具包。在版本 2.1.0 上运行，显然有几个错误。如果您使用的是 Ubuntu 10.04，这有点粗糙。（请参阅此处有关 PHP 版本升级的评论：[http](http://www.zalexblog.com/2011/01/07/installing-php-5-3-3-on-ubuntu-10-04/) ://www.zalexblog.com/2011/01/07/installing-php-5-3-3-on-ubuntu-10-04/ ）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T21:20:54.343

你可以试试 html_entity_decode 吗？

```
$s3->doesObjectExist("mabucket",html_entity_decode("/mefile/412501_413000/412604_-12%20C008%20Fil%20R[1].doc.gpg")) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-07-16T10:44:45.787

密钥/文件名的 urldecode() 对我有用

# ios - 如何自动单击确定以响应“ 想在使用 KIF 进行测试时使用您当前的位置”？

> ID：15558301
> 
> 赞同：4
> 
> 时间：2013-03-21T21:16:54.670
> 
> 标签：ios, ios-simulator, kif-framework

我正在使用 KIF 进行 GUI 测试，似乎我们无法在 Simulator 中自动单击`<app> would like to use your current location`应用程序首次运行时出现的警报中的 OK 按钮。有没有办法配置模拟器或应用程序来绕过该弹出窗口？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-12-15T19:52:47.137

最近[添加](https://github.com/kif-framework/KIF/commit/a57ee3519585c94cc97bfdd9446e9eee84835a3c)到 KIF 的内容增加`-acknowledgeSystemAlert`了测试运行程序。这可以在模拟器上运行以确认位置服务授权对话框时使用。当请求访问用户的照片库时，可以以相同的方式使用它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-22T00:41:40.223

[大约一年前，KIF 邮件列表上](https://groups.google.com/forum/?fromgroups=#%21topic/kif-framework/_MffdyvMizU)有一个关于此的主题。

由于您这样做只是为了测试，因此很容易调出 的部分`CLLocationManager`以避免此警报。

（显然，任何提交到应用商店的代码都会让你在匆忙后被拒绝。）

```
[CLLocationManager swizzleInstanceSelector:@selector(startUpdatingLocationFake) toSelector:@selector(startUpdatingLocation)];
[CLLocationManager swizzleInstanceSelector:@selector(locationFake) toSelector:@selector(location)];

// One for class, one for (deprecated) instance method 
[CLLocationManager swizzleInstanceSelector:@selector(locationServicesEnabledFake) toSelector:@selector(locationServicesEnabled)];
[CLLocationManager swizzleClassSelector:@selector(locationServicesEnabledFake) toSelector:@selector(locationServicesEnabled)]; 
```

这两个新的类方法定义如下：

```
+ (void)swizzleInstanceSelector:(SEL)firstSelector toSelector:(SEL)secondSelector;
{
    Method swizzleMethod = class_getInstanceMethod(self, firstSelector);
    Method method = class_getInstanceMethod(self, secondSelector);
    method_exchangeImplementations(method, swizzleMethod);
}

+ (void)swizzleClassSelector:(SEL)firstSelector toSelector:(SEL)secondSelector;
{
    Method swizzleMethod = class_getClassMethod(self, firstSelector);
    Method method = class_getClassMethod(self, secondSelector);
    method_exchangeImplementations(method, swizzleMethod);
} 
```

# ios - 返回的每个标志中数字的重要性 - SCNetworkReachabilityFlags

> ID：15558304
> 
> 赞同：1
> 
> 时间：2013-03-21T21:17:02.760
> 
> 标签：ios, ipad, vpn, reachability

我正在尝试以编程方式检查 iOS 应用程序内的 iPad 中的 VPN 连接是打开还是关闭。下面的代码总是表明我组织中的给定主机始终可以访问，即使 iPad 中的 VPN 连接已关闭。但是，当我打印使用“SCNetworkReachabilityGetFlags”api 获得的标志时，它显示 VPN 关闭和 VPN 开启之间存在差异。每当连接 VPN 时，标志打印“3”，当 VPN 关闭时，标志打印“2”。

我的问题是

1.  我可以使用这个标志来确定 VPN 连接吗？
2.  这些数字有什么意义？
3.  任何人都可以向我提供有关这些标志的更多信息吗？

以下是我的代码：

```
bool success = false;

const char *host_name = [@"<<host name here>>"
                         cStringUsingEncoding:NSASCIIStringEncoding];

SCNetworkReachabilityRef reachability = SCNetworkReachabilityCreateWithName(NULL,
                                                                            host_name);
SCNetworkReachabilityFlags flags;
success = SCNetworkReachabilityGetFlags(reachability, &flags);
NSLog(@"success=%d",flags);
bool isAvailable = success && (flags & kSCNetworkFlagsReachable) &&
!(flags & kSCNetworkFlagsConnectionRequired);
if (isAvailable) {
    NSLog(@"Host is reachable: %d", flags);
}else{
    NSLog(@"Host is unreachable");
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-26T00:45:18.210

值得一提的是，这些标志在[SCNetworkReachability Reference](https://developer.apple.com/library/mac/documentation/SystemConfiguration/Reference/SCNetworkReachabilityRef/Reference/reference.html#//apple_ref/c/tdef/SCNetworkReachabilityFlags)中定义。正如您将看到的，这些是按位标志，因此“2”表示仅`kSCNetworkReachabilityFlagsReachable`设置，而“3”表示同时设置和`kSCNetworkReachabilityFlagsTransientConnection`设置。

# sql - SQL子查询日期问题

> ID：15558307
> 
> 赞同：1
> 
> 时间：2013-03-21T21:17:06.983
> 
> 标签：sql, ms-access

我遇到的问题非常基本，我正在尝试使用以下 SQL 代码

```
SELECT *
FROM [Car For Sale]
WHERE CFS_Selling_Price IN (SELECT MAX (CFS_Selling_Price)
                            FROM [Car For Sale] 
                            HAVING CFS_Status ='Sold'); 
```

它已经与以下 SQL 代码一起工作

```
CFS_Sold_Date > dateadd("m",-1,date()) 
```

为了减少从本月销售的最贵汽车到最昂贵汽车的结果。我已经尝试为自己弄清楚无济于事，有人可以提供帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T21:35:21.697

你的意思是：

```
SELECT *
FROM [Car For Sale]
WHERE CFS_Selling_Price IN 
   (SELECT MAX (CFS_Selling_Price)
    FROM [Car For Sale] 
    WHERE CFS_Status ='Sold'
    AND CFS_Sold_Date > dateadd("m",-1,date())); 
```

# php - 变量 URL 的 htaccess 排除项

> ID：15558312
> 
> 赞同：0
> 
> 时间：2013-03-21T21:17:15.847
> 
> 标签：php, .htaccess, zen-cart

我有一个 Zen Cart 站点，我需要在其中排除一个 URL 被重写。问题是 URL 的一部分每次都不同，所以我需要一些通配符，但我不知道该怎么做。

这是我的 URL 的样子：

```
http://XXXXXX.com/index.php?zenid=9cbbba111d0e229809dbf5a0053c2486&main_page=wp_callback 
```

字符每次都不同，`zenid`所以我需要一个不会重写以 . 结尾的 URL 的规则`main_page=wp_callback`。

谁能告诉我该怎么做，好吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T21:21:26.930

尝试在其他重写规则之上添加类似这样的内容：

```
# Stop rewrite processing if the query string contains main_page=wp_callback
RewriteCond %{QUERY_STRING} main_page=wp_callback
RewriteRule . - [L] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T21:20:09.013

重写规则是正则表达式。这是匹配以 结尾的所有内容的正则表达式`main_page=wp_callback`：

```
index.php.*main_page=wp_callback$ 
```

# hadoop - 将 snappy 压缩文件加载到 Elastic MapReduce

> ID：15558315
> 
> 赞同：5
> 
> 时间：2013-03-21T21:17:38.903
> 
> 标签：hadoop, amazon-web-services, compression, hadoop-streaming, emr

我在 S3 中有一堆经过快速压缩的服务器日志，我需要使用 Elastic MapReduce 上的流处理它们。我如何告诉 Amazon 和 Hadoop 日志已经压缩（在它们被拉入 HFS 之前！），以便可以在发送到流式映射器脚本之前对其进行解压缩？

我能找到的唯一文档是：http: [//docs.aws.amazon.com/ElasticMapReduce/latest/DeveloperGuide/HadoopDataCompression.html#emr-using-snappy](http://docs.aws.amazon.com/ElasticMapReduce/latest/DeveloperGuide/HadoopDataCompression.html#emr-using-snappy) ，它似乎指的是中间压缩，而不是文件当它们到达 HFS 时被压缩。

顺便说一句，我主要在 python 中工作，所以如果你有 boto 的解决方案，那就加分吧！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-04T20:31:58.787

答案是“做不到”。至少，不适用于将 hadoop 流应用到源自 hadoop 之外的 snappy 压缩文件的特定情况。

我（彻底！）探索了两个主要选项来得出这个结论：（1）尝试使用 highcaffeinated 建议的 hadoop 的内置 snappy 压缩，或（2）编写我自己的流模块来使用和解压缩 snappy 文件。

对于选项 (1)，似乎 hadoop 在使用 snappy 压缩文件时会向文件添加一些标记。由于我的文件是在 hadoop 外部使用 snappy 压缩的，所以 hadoop 的内置编解码器无法解压缩文件。

此问题的一个症状是堆空间错误：

```
2013-04-03 20:14:49,739 FATAL org.apache.hadoop.mapred.Child (main): Error running child : java.lang.OutOfMemoryError: Java heap space
    at org.apache.hadoop.io.compress.BlockDecompressorStream.getCompressedData(BlockDecompressorStream.java:102)
    at org.apache.hadoop.io.compress.BlockDecompressorStream.decompress(BlockDecompressorStream.java:82)
    at org.apache.hadoop.io.compress.DecompressorStream.read(DecompressorStream.java:76)
    at java.io.InputStream.read(InputStream.java:85)
    ... 
```

当我切换到一个更大的实例并启动 mapred.child.java.opts 设置时，我得到了一个新错误：

```
java.io.IOException: IO error in map input file s3n://my-bucket/my-file.snappy 
```

Hadoop 的 snappy 编解码器不适用于外部生成的文件。

对于选项 (2)，问题在于 hadoop 流不区分 \n、\r 和 \r\n 换行符。由于快速压缩最终会在整个压缩文件中散布这些字节码，因此这是致命的。这是我的错误跟踪：

```
2013-04-03 22:29:50,194 WARN org.apache.hadoop.mapred.Child (main): Error running child
java.lang.RuntimeException: PipeMapRed.waitOutputThreads(): subprocess failed with code 1
    at org.apache.hadoop.streaming.PipeMapRed.waitOutputThreads(PipeMapRed.java:372)
    at org.apache.hadoop.streaming.PipeMapRed.mapRedFinished(PipeMapRed.java:586)
    at org.apache.hadoop.streaming.PipeMapper.close(PipeMapper.java:135)
    at org.apache.hadoop.mapred.MapRunner.run(MapRunner.java:57)
    ... 
```

通过对 hadoop 的 Java 类做一些工作（例如，参见[这里](https://stackoverflow.com/questions/8999734/hadoop-converting-r-n-to-n-and-breaking-arc-format)），我们或许可以解决 \r 与 \n 的问题。但正如我最初所说，我的目标是在 hadoop 流模块中构建，而不涉及 Java。有了这个限制，似乎没有任何方法可以解决这个问题。

最后，我回到了生成这个集群正在消耗的文件的人那里，并说服他们切换到 gzip 或 lzo。

PS - 在选项 (2) 上，我尝试在不同的字符上拆分记录（例如 textinputformat.record.delimiter=X），但它感觉非常hacky 并且无论如何都不起作用。

PPS - 另一种解决方法是编写脚本以从 S3 下载文件，解压缩它们，然后运行 ​​-copyFromLocal 将它们拉入 HDFS。在计算上，这并没有错，但从工作流程的角度来看，它会带来各种麻烦。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-31T23:00:46.820

Assuming you are using TextInputFormat (or one of its subclasses), compressed input files with .snappy extension are handled automatically.

You might want to consider using lzo compression (.gz extenstion) instead of snappy. You give up some compression speed for better compression ratio and an input file that is splittable. Cloudera mentions this [in their blog](http://blog.cloudera.com/blog/2011/09/snappy-and-hadoop/):

> One thing to note is that Snappy is intended to be used with a container format, like Sequence Files or Avro Data Files, rather than being used directly on plain text, for example, since the latter is not splittable and can’t be processed in parallel using MapReduce. This is different to LZO, where is is possible to index LZO compressed files to determine split points so that LZO files can be processed efficiently in subsequent processing.

# libpcap - 数据包嗅探器 - 追溯内容的来源

> ID：15558317
> 
> 赞同：0
> 
> 时间：2013-03-21T21:17:44.377
> 
> 标签：libpcap, packet-sniffers, whois

我使用[sniffex.c](http://www.tcpdump.org/sniffex.c)作为我的起点，我花了几个月的时间让数据包嗅探器按照我想要的方式工作。它是一个很好的工具，可以提供进出我网络上每台计算机的流量摘要，但我发现自己想要更多关于入站流量来源的信息。如果我对样本入站数据包的 src_ip 进行 whois，大多数时候我会获得有关 Qwest Communications Company, LLC 或 AKAMAI TECHNOLOGIES INC 拥有的主机的信息，这并不能真正为我提供我感兴趣的信息.

在这一点上，我有兴趣跟踪数据的来源，例如 youtube 或 espn ......如何做到这一点？

反向 dns 查找听起来像我正在寻找的东西，但是如果我从 src_ip 中接收到大量数据并将其放入在线反向 dns 搜索表单之一，我得到的只是它归 qwest 所有。

**编辑＃1：**

好的，感谢 Guy Harris 在下面的回答，我现在对如何提出这个问题有了更好的了解。正如他所说，每个数据包内的 ascii 数据中应该有一个“主机：”行，这应该为我提供有关此数据来源的更高级别的更直接信息。现在我如何获得这些数据？解析 ascii 文本是最好的方法，还是有预先存在的函数来获取这些数据？

**编辑#2：**

好吧，解析有效载荷或标头 ascii 似乎是一条死胡同。[我在这里](http://www.binarytides.com/packet-sniffer-code-c-libpcap-linux-sockets/#viewSource)找到了一个非常有用的 libpcap 应用程序的源代码。该程序将上述所有内容打印到日志文件中。查看这些数据，我发现很少有数据包具有“主机：”字段。显然只有 TCP 端口 80 的数据包，然后只有系列中的第一个数据包。即便如此，我发现只有这个主机字段是由我网络上的一个盒子上的网络服务器提供的。

那么现在我要问的是完全不可能弄清楚许多不同网站的内容可能缓存在一个主机上吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T08:39:50.687

Qwest（被[CenturyLink](http://www.centurylink.com)收购）是一家 ISP（CenturyLink 仍然是）。例如，某些公司可能会将它们用作托管 ISP，因此对 www.example.com 的 HTTP 请求等请求实际上由 Qwest/CenturyLink 的服务器之一处理，因此如果您从 www.example 下载。 com，您实际上是从 Qwest/CenturyLink 拥有的服务器下载的，该服务器的 IP 地址也属于 Qwest/CenturyLink。

[Akamai](http://www.akamai.com)是一家为希望让*很多*人下载材料成为可能的组织提供基础架构的公司；该组织将[安排其服务器的域名实际解析为 Akamai 的 IP 地址](https://en.wikipedia.org/wiki/Akamai_Technologies#Content_delivery_to_a_user)，因此，如果您认为您是从 www.example.com 下载的，那么您实际上是从 Akamai 的一台服务器下载的，即 IP其地址也属于 Akamai。

因此，作为对来自 www.example.com 的下载请求（例如 HTTP GET 请求）的回复的一部分的入站数据包的源 IP 地址可能是属于 Qwest 或 Akamai 的主机的 IP 地址 - 这确实*才是*真正开始流量的主机！

如果它属于 Qwest，Example Inc. 的 Web 服务器可能实际上存储在具有 Qwest IP 地址的 Qwest 机器上，而不是 Example Inc. 拥有的机器并使用 Example Inc. 拥有的范围内的 IP 地址（示例与管理服务器和私有 IP 地址范围相比，Inc. 可能有更好的资源来处理）。

如果它属于 Akamai，则它具有要下载的材料的副本，由 Example Inc. 提供，该公司与 Akamai 签订合同以提供内容缓存。

要想确定实际下载了谁的资料，您所能做的就是查看，例如，客户端执行的 DNS 请求以确定 IP 地址（以便您在 DNS 请求中看到“www.example.com” ，而不仅仅是看到 Qwest/Akamai/为 DNS 请求返回的任何 IP 地址）和/或，至少对于 HTTP，HTTP 1.1 请求中的“Host:”标头（也将包含域名）。

而且，是的，在一般情况下，当您在下载过程中的某个任意点开始捕获时，*并不*总是能够找出正在下载的内容的“原始”来源。

Host: 标头只会出现在初始 HTTP 请求中，因此，如果您在发出初始 HTTP 请求时没有捕获流量，或者如果下载不是 HTTP 请求的结果，那么您就退出了运气。

将在下载开始之前发出 DNS 请求 - 而且，由于 DNS 解析器可以缓存 DNS 请求的结果，因此在下载开始之前可能已经发出了相当长的时间 - 因此，再次，如果您没有在发出 DNS 请求时，您就不走运了。

# php - OpenSSL 在 Windows 上不起作用，错误 0x02001003 0x2006D080 0x0E064002

> ID：15558321
> 
> 赞同：52
> 
> 时间：2013-03-21T21:17:55.487
> 
> 标签：php, apache, apache2, openssl, easyphp

**问题：** OpenSSL 在我的 Windows 环境中不起作用。OpenSSL 反复报错 0x02001003、0x2006D080 和 0x0E064002。

**环境：**

```
Windows NT x 6.1 build 7601 (Windows 7 Business Edition Service Pack 1) i586
Apache/2.4.4 (Win32)
PHP/5.4.13 x86
PHP Directory: E:\wamp\php\
Virtual Host Directory: E:\Projects\1\public_html 
```

**我尝试过的：**

*   **安装说明** [http://www.php.net/manual/en/openssl.installation.php](http://www.php.net/manual/en/openssl.installation.php)
*   **PHP.ini** `extension=php_openssl.dll`
*   **Openssl.cnf** `E:\wamp\php\extras\openssl.cnf`
*   **％小路％** `E:\wamp\php`
*   **重新启动**
*   **phpinfo:**
    ----OpenSSL 支持已启用
    ----OpenSSL 库版本 OpenSSL 1.0.1e 2013 年 2 月 11 日
    ----OpenSSL 标头版本 OpenSSL 0.9.8y 2013 年 2 月 5 日
*   有和没有指定**配置**`configargs`
*   `<Directory E:\wamp\php\extras>`在 apache 配置中指定和不指定
*   复制`openssl.cnf`到 virtualhost public_html，指向那个并且仍然得到相同的错误
*   没有记录**错误日志**
*   **研究：**过去两天我一直在研究这个，很惊讶没有更多的信息，所以我在这里发帖。似乎是 OpenSSL 配置或 apache/php 未正确读取配置的问题。

**代码：**

```
$privateKey = openssl_pkey_new();
while($message = openssl_error_string()){
    echo $message.'<br />'.PHP_EOL;
} 
```

**结果：**

```
error:02001003:system library:fopen:No such process
error:2006D080:BIO routines:BIO_new_file:no such file
error:0E064002:configuration file routines:CONF_load:system lib
error:02001003:system library:fopen:No such process
error:2006D080:BIO routines:BIO_new_file:no such file
error:0E064002:configuration file routines:CONF_load:system lib 
```

**手动 OpenSSL：**

```
E:\wamp\apache\bin>openssl.exe pkey
WARNING: can't open config file: c:/openssl-1.0.1e/ssl/openssl.cnf

E:\wamp\apache\bin>set OPENSSL_CONF="E:\wamp\php\extras\openssl.cnf"

E:\wamp\apache\bin>openssl.exe pkey
3484:error:0200107B:system library:fopen:Unknown error:.\crypto\bio\bss_file.c:169:fopen('"E:\wamp\php\extras\openssl.cnf"','rb')
3484:error:2006D002:BIO routines:BIO_new_file:system lib:.\crypto\bio\bss_file.c:174:
3484:error:0E078002:configuration file routines:DEF_LOAD:system lib:.\crypto\conf\conf_def.c:199: 
```

**编辑：**

1.  感谢@Gordon，我现在可以看到 open_ssl 错误使用`openssl_error_string`
2.  完全卸载 EasyPHP。手动安装稳定版本的 PHP/Apache。结果一样！在 Windows 上实现 openssl 绝对是我做错了。
3.  OpenSSL 手动部分...附加错误信息

**最后的想法：**
我设置了一个 linux 机器，我得到了同样的错误。经过一番玩耍后，我发现即使它在 openssl_pkey_new 上抛出错误，它最终还是会创建我的测试 p12 文件。长话短说，这些错误具有误导性，它必须更多地处理您**如何**使用 openssl 功能而不是服务器端配置。

最终代码：

```
// Create the keypair
$res=openssl_pkey_new();

// Get private key
openssl_pkey_export($res, $privkey);

// Get public key
$pubkey=openssl_pkey_get_details($res);
$pubkey=$pubkey["key"];

// Actual file
$Private_Key = null;
$Unsigned_Cert = openssl_csr_new($Info,$Private_Key,$Configs);
$Signed_Cert = openssl_csr_sign($Unsigned_Cert,null,$Private_Key,365,$Configs);
openssl_pkcs12_export_to_file($Signed_Cert,"test.p12",$Private_Key,"123456"); 
```

**关闭。**

**一年后...**

所以一年后我发现自己又这样做了，无论我在计算机上设置什么 PATH 变量或在脚本执行期间，它都会不断出错，提示找不到文件。我能够通过在数组中传入`config`参数来解决它。这是一个测试能否成功使用 OpenSSL 的函数：`config_args``openssl_pkey_new`

```
 /**
     * Tests the ability to 1) create pub/priv key pair 2) extract pub/priv keys 3) encrypt plaintext using keys 4) decrypt using keys
     * 
     * @return boolean|string False if fails, string if success
     */
    function testOpenSSL($opensslConfigPath = NULL)
    {
        if ($opensslConfigPath == NULL)
        {
            $opensslConfigPath = "E:/Services/Apache/httpd-2.4.9-win32-VC11/conf/openssl.cnf";
        }
        $config = array(
            "config" => $opensslConfigPath,
            "digest_alg" => "sha512",
            "private_key_bits" => 4096,
            "private_key_type" => OPENSSL_KEYTYPE_RSA,
        );

        $res = openssl_pkey_new($config); // <-- CONFIG ARRAY
        if (empty($res)) {return false;}

        // Extract the private key from $res to $privKey
        openssl_pkey_export($res, $privKey, NULL, $config); // <-- CONFIG ARRAY

        // Extract the public key from $res to $pubKey
        $pubKey = openssl_pkey_get_details($res);
        if ($pubKey === FALSE){return false;}

        $pubKey = $pubKey["key"];

        $data = 'plaintext data goes here';

        // Encrypt the data to $encrypted using the public key
        $res = openssl_public_encrypt($data, $encrypted, $pubKey);
        if ($res === FALSE){return false;}

        // Decrypt the data using the private key and store the results in $decrypted
        $res = openssl_private_decrypt($encrypted, $decrypted, $privKey);
        if ($res === FALSE){return false;}

        return $decrypted;
    }

    // Example usage:
    $res = testOpenSSL();
    if ($res === FALSE)
    {
        echo "<span style='background-color: red;'>Fail</span>";
    } else {
        echo "<span style='background-color: green;'>Pass: ".$res."</span>";
    } 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-26T20:36:41.963

下面的代码按预期工作。但是，如果您`openssl_error_string()`在 openssl 方法之后运行，它会显示`error:0E06D06C:configuration file routines:NCONF_get_string:no value`一些通知，我无法找到相关文档。

进一步注意，根据[http://www.php.net/manual/en/function.openssl-error-string.php](http://www.php.net/manual/en/function.openssl-error-string.php)您可能会看到误导性错误，因为错误消息已排队：

> 使用此函数检查错误时要小心，因为它似乎是从 > 错误的缓冲区中读取的，其中可能包括来自另一个使用 openssl > 函数的脚本或进程的错误。（我惊讶地发现它在调用任何 > openssl_* 函数之前返回错误消息）

```
<?php
/* Create the private and public key */
$res = openssl_pkey_new();
openssl_error_string(); // May throw error even though its working fine!

/* Extract the private key from $res to $privKey */
openssl_pkey_export($res, $privKey);
openssl_error_string(); // May throw error even though its working fine!

/* Extract the public key from $res to $pubKey */
$pubKey = openssl_pkey_get_details($res);
$pubKey = $pubKey["key"];

$data = 'i.amniels.com is a great website!';

/* Encrypt the data using the public key
 * The encrypted data is stored in $encrypted */
openssl_public_encrypt($data, $encrypted, $pubKey);

/* Decrypt the data using the private key and store the
 * result in $decrypted. */
openssl_private_decrypt($encrypted, $decrypted, $privKey);

echo $decrypted;
?> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-07-01T16:36:30.133

这里有几件事：

`%PATH%`还应该包含 windows 和 system32 所以你的 %PATH% 应该看起来像`c:\windows;c:\windows\system32;E:\wamp\php`并且`e:\wamp\php`应该是 openssl dll 文件

还可以尝试与标头版本相匹配的openssl版本`0.9.8y 5 Feb 2013`下载[here for 32bit](http://slproweb.com/download/Win32OpenSSL-0_9_8y.exe)和[here for 64bit](http://slproweb.com/download/Win64OpenSSL-0_9_8y.exe)

这段代码似乎对我有用：

```
// Create the keypair
$res=openssl_pkey_new();

// Get private key
openssl_pkey_export($res, $privkey);

// Get public key
$pubkey=openssl_pkey_get_details($res);
$pubkey=$pubkey["key"];
$Info = array(
    "countryName" => "UK",
    "stateOrProvinceName" => "Somerset",
    "localityName" => "Glastonbury",
    "organizationName" => "The Brain Room Limited",
    "organizationalUnitName" => "PHP Documentation Team",
    "commonName" => "Wez Furlong",
    "emailAddress" => "wez@example.com"
);

// Actual file
$Private_Key = null;
$Unsigned_Cert = openssl_csr_new($Info,$Private_Key);
$Signed_Cert = openssl_csr_sign($Unsigned_Cert,null,$Private_Key,365);
openssl_pkcs12_export_to_file($Signed_Cert,"test.p12",$Private_Key,"123456"); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-10-20T10:50:34.243

我遇到了类似的问题，对我来说，它有助于在脚本开头**手动设置环境变量“OPENSSL_CONF”。**

不知何故，环境变量设置不正确，或者没有通过我的 php（设置：AMPPS，Win7 64Bit）。

下面使用的示例位置是您必须在标准 AMPPS 安装中使用的路径，因此如果您使用的是 AMPPS，只需复制和粘贴：

```
putenv("OPENSSL_CONF=C:\Program Files (x86)\Ampps\php\extras\openssl.cnf"); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-12-12T11:42:04.357

如果您使用的是 Apache 2.4 + mod_fcgid，您可以通过添加`FcgidInitialEnv`httpd.conf 文件来指定 OpenSSL conf 文件：

```
# OPENSSL CONF
FcgidInitialEnv OPENSSL_CONF "D:/apps/php70/extras/ssl/openssl.cnf" 
```

我没有使用 WAMP 等预配置包，我从[Apache Lounge获得 Apache，从](http://www.apachelounge.com/download/)[windows.php.net](http://windows.php.net/)获得PHP，并由我自己配置​​。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-08-09T04:03:19.977

**清洁解决方案：**

1.  从这里下载 PHP Windows 二进制文件的存档（不管是哪个）：http: [//windows.php.net/download](http://windows.php.net/download)
2.  在里面你找到文件 /extras/ssl/openssl.cnf
3.  在某处提取 openssl.cnf（例如“C:/WEB/PHP/extras/ssl/openssl.cnf”）
4.  `OPENSSL_CONF`使用您使用的路径添加全局系统变量（例如“C:\WEB\PHP\extras\openssl.cnf”（不带双引号））。

[![在此处输入图像描述](../Images/713e76b6a187323b7de4b1b2ac3e9f69.png)](https://i.stack.imgur.com/MfRTp.png)

您必须将路径添加到`OPENSSL_CONF`系统变量。将其添加到`Path`系统变量中是不够的！在 Windows 7 下，您可以在以下位置找到设置对话框：“控制面板 > 系统和安全 > 系统 > 高级系统设置（左侧菜单）> 高级（选项卡）> 环境变量...”。在那里添加变量`OPENSSL_CONF`。

使用前不需要准备 openssl.cnf 文件 - 它可以开箱即用。但是，如果您想微调设置，您可以。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-06-07T17:41:09.987

您是否通过此方法安装了 OpenSSL？在 Windows 上安装 OpenSSL

1.  访问[http://gnuwin32.sourceforge.net/packages/openssl.htm](http://gnuwin32.sourceforge.net/packages/openssl.htm)，下载“二进制”的“安装”版本，openssl-0.9.7c-bin.exe。

2.  双击 openssl-0.9.7c-bin.exe 将 OpenSSL 安装到 \local\gnuwin32 目录。

3.  返回同一页面，下载“文档”的“设置”版本，并将其安装到同一目录。

4.  打开命令行窗口，然后尝试以下命令： 代码：

```
 \local\gnuwin32\bin\openssl -help
    openssl:Error: '-help' is an invalid command.

    Standard commands
    asn1parse      ca             ciphers        crl            crl2pkcs7
    dgst           dh             dhparam        dsa            dsaparam
    enc            engine         errstr         gendh          gendsa
    genrsa         nseq           ocsp           passwd         pkcs12
    pkcs7          pkcs8          rand           req            rsa
    rsautl         s_client       s_server       s_time         sess_id
    smime          speed          spkac          verify         version
    x509
    ...... 
```

如果您看到 OpenSSL 打印的命令列表，您就知道您的安装已正确完成。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-10-14T18:07:56.340

就我而言，将文件复制到 c:\windows\system32 帮助了我

libeay32.dll、ssleay32.dll

可以在 OpenSSL_INSTALL_PATH\bin 中找到它们。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2022-02-16T10:29:34.113

我对 XAMPP 也有类似的问题。我发现`OPENSSL_CONF`in`[xampp_dir]\apache\conf\extra\httpd-xampp.conf`被错误地设置为`[xampp_dir]/apache/bin/openssl.cnf`. 修复后就可以`[xampp_dir]/apache/conf/openssl.cnf`了。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-02-27T16:42:47.827

```
<?php 

         // also see  stackoverflow.com/questions/59195251/php-get-private-key-from-a-single-line-private-key 
         // micmap.org/php-by-example/de/function/openssl_get_publickey
         // best  stackoverflow.com/questions/15558321/openssl-not-working-on-windows-errors-0x02001003-0x2006d080-0x0e064002
         // sandrocirulli.net/how-to-encrypt-and-decrypt-emails-and-files/

         echo '<pre>';

        function testOpenSSL($openssl_args)
        {

                $res = openssl_pkey_new($openssl_args); // <-- CONFIG ARRAY
                openssl_error_string(); // May throw error even though its working fine!
                if (empty($res)) {return false;}
                $openssl_args['keysnew']=$res;
                        //var_dump($res);echo '<br><br>';

                // Extract the private key from $res to $privKey
                openssl_pkey_export($res, $privKey, NULL, $openssl_args); // <-- CONFIG ARRAY
                openssl_error_string(); // May throw error even though its working fine!

                // Extract the public key from $res to $pubKey
                $pubKey = openssl_pkey_get_details($res);
                openssl_error_string(); // May throw error even though its working fine!
                if ($pubKey === FALSE){return false;}
                $pubKey = $pubKey["key"];   

                // Encrypt the data to $encrypted using the public key
                $data = $openssl_args['data'];          
                $res = openssl_public_encrypt($data, $encrypted, $pubKey);
                if ($res === FALSE){return false;}
                        #var_dump($res);exit; //bool
                // Decrypt the data using the private key and store the results in $decrypted
                $res = openssl_private_decrypt($encrypted, $decrypted, $privKey);
                if ($res === FALSE){return false;}

                //return $decrypted;
                $openssl_args['pub_key']=$pubKey;
                $openssl_args['priv_key']=$privKey;
                $openssl_args['encr']=$encrypted;
                $openssl_args['decr']=$decrypted; 

                return $openssl_args;

        }

        // try sam openssl.cnf   , most error on windows xampp
        $try= 5;     
        $openssl_cnf_path = array(
            0=>'C:\xampp\apache\conf\openssl.cnf',   //11259 bytes
            1=>'C:\xampp\apache\bin\openssl.cnf',   //11259 bytes

            2=>'C:\xampp\php\windowsXamppPhp\extras\ssl\openssl.cnf',  //10909
            3=>'C:\xampp\php\extras\ssl\openssl.cnf',   //10909 byes
            4=>'C:\xampp\php\extras\openssl\openssl.cnf',   //9374 bytes

            5=>'C:\Program Files\Git\usr\ssl\openssl.cnf',  //10909 bytes
            6=>'C:\Program Files\Git\mingw64\ssl\openssl.cnf',  //10909 bytes
            );

        $data = ' todo in spin activate theme elementor-child plugin qw_casino ... permalinks postname media Lib. add new upload paysave pic make empty page   with template-casino in -child make page4todo in spin activate theme elementor-child plugin qw_casin245'; /**  ... permalinks postname media Lib. add new upload paysave pic make empty page   with template-casino in -child make page6todo in spin activate theme elementor-child plugin qw_casino  .. permalinks postname media Lib.add new upload paysave pic  make empty501'; 
        /** mist max str len 501  in RFC3447 can operate on messages of length up to k - 11 octets (k is the octet length of the RSA modulus) so if you are using 2048-bit RSA key then maximum length of the plain data to be encrypted is 245 bytes.  /***/

        echo 'str len : ', strlen($data);

        $openssl_args = array(
            "config" => $openssl_cnf_path[$try],
            "digest_alg" => "sha512",
            //"private_key_bits" => 4096,
            "private_key_bits" => 2048,
            "private_key_type" => OPENSSL_KEYTYPE_RSA,
            "try_path_ar" => $openssl_cnf_path,
            "data" => $data,
            );

        // Example
        $res = testOpenSSL($openssl_args);
        if ($res === FALSE)
        {
            echo "<h4 style='background-color: red;'>Fail</h4>";
        } else {
            echo '<h3 style=\'background-color: green; color:white;\'>with $try= '.$try.' decrypted ok: '.$res['decr'].'</h3>';
        }

                //////////////////////////////////////////
                //
                echo '<br>vardump res <br>';  var_dump($res);   
                echo '<br>======================<br>';      

        $privKey=$res['priv_key'];
        $pubKey =$res['pub_key'];
        file_put_contents('pri_key.txt',$privKey);
        file_put_contents('priv_key.txt',$privKey);
        file_put_contents('pub_key.txt',$pubKey);

        echo '<br><br><pre>';

        /* Encrypt the data using the public key
         * The encrypted data is stored in $encrypted */
        openssl_public_encrypt($data, $encrypted, $pubKey);
                echo '<br>public encrypt: '; var_dump( base64_encode($encrypted));

        /* Decrypt the data using the private key and store the
         * result in $decrypted. */
        openssl_private_decrypt($encrypted, $decrypted, $privKey);
                echo ' private decrypt: ', $decrypted;      

        // inverse testOpenSSL
        openssl_private_encrypt($data, $encrypted, $privKey);
                echo '<br><br> invers<br>pri encrypt: '; var_dump( base64_encode($encrypted));

        openssl_public_decrypt($encrypted, $decrypted, $pubKey);
                echo ' pub decrypt: ', $decrypted , '<br>'; 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2013-06-19T21:00:50.010

我可以建议使用[Virtual Box](https://www.virtualbox.org/)，创建一个 VM 并安装 LAMP 堆栈。这会给你一个“更真实”的环境。除了故障排除 OpenSSL 在 Linux 上更容易。

话虽如此，我相信您的问题是您找不到插件文件本身。确保它位于正确的路径并存在于您的机器上，并且 Apache 运行的进程有权读取它。

# perl - 如何管理开源 Perl 项目使用的模块的安装？

> ID：15558323
> 
> 赞同：7
> 
> 时间：2013-03-21T21:18:04.597
> 
> 标签：perl, makefile, cpan, catalyst

我使用 Catalyst、Open Street Map 和几十个模块从事一个[小型的开源 Perl 项目。](https://github.com/smonff/Shurf)我尝试尽可能多地使用 CPAN 上的模块，因为我的目标不是重新发明轮子。

所有这些东西都是通过 cpanm 和 local::lib 安装的。每次我需要新的东西时，我都会安装几个模块和依赖项（使用 cpanm 非常简单）。现在，我在问自己，那些将克隆我的项目的人如何安装数十个模块而不会感到头疼？

这方面的最佳做法是什么？我应该在 Makefile.pl 中列出所有必需的模块吗？我现在对此感到焦虑，因为我在这个项目上努力工作，尝试遵循很多好的实践，但我觉得我在这个特定点上犯了错误（不要考虑这个）。

我需要一些关于这个问题的建议，因为一切看起来都很神奇，以至于我不相信在 Makefile 中使用 'require' 关键字列出模块名称就足够了。我也希望不必在项目中包含所有依赖项并提交所有这些巨大的包以供以后使用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T21:21:05.637

如果您使用 Catalyst，您可以在为您的 Catalyst 应用程序创建的 Makefile.PL 中添加您需要的模块作为依赖项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T22:10:33.703

我建议看一下[纸箱](https://metacpan.org/pod/Carton)（来自与令人敬畏的 cpanm 相同的作者）。

[我是 Ruby捆绑](http://gembundler.com/)器的忠实粉丝，carton 的文档将其描述为“Bundler for Perl”。不久前我对它进行了试验，它看起来很有希望。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-15T09:38:47.763

您应该只列出（in `Makefile.PL`）您直接需要的那些模块（即，您`use`或`require`在您的模块中的那些）。您无需担心间接需要的模块（即，您使用的模块）；这是安装人员的工作。

要获取您使用的模块列表，您当然可以手动编译该列表。但是，如果您碰巧有*The Definitive Guide to Catalyst*，那么第 129 页上有一个方便的 Bash 函数，我不确定是否可以在此处复制。还有[Perl::PrereqScanner::App](https://metacpan.org/pod/release/RJBS/Perl-PrereqScanner-1.018/bin/scan-perl-prereqs)，我没有直接使用，但 Dist::Zilla 使用它。

FWIW，如果您使用[Dist::Zilla](https://metacpan.org/pod/Dist%3a%3aZilla)来管理您的分发（我什至对于我不上传到 CPAN 的私人项目也这样做），它可以（并且默认情况下）为您跟踪依赖关系。

# excel - 为每月的每一天添加按升序循环的工作表

> ID：15558324
> 
> 赞同：0
> 
> 时间：2013-03-21T21:18:10.073
> 
> 标签：excel, vba

我的循环有效，但它使它们以相反的顺序排列。我意识到它正在做我下面的事情，但我的语法还不够好。我不知道如何扭转它。

当前工作表顺序为降序：3.31、3.30、3.29 等...

我需要升序：3.21、3.22、3.23、3.24 等...

days = 每个月的数值天数 mon = 月份的数值

建议？

```
For i = 1 To Val(days)
    Sheets(1).Copy after:=Sheets(1)
    ActiveSheet.Name = mon & "." & (i)
Next i 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T21:24:55.597

这会将工作表以正确的顺序放置在工作簿的末尾：

```
For i = 1 To Val(days)
    Sheets(1).Copy After:=Sheets(Sheets.Count)
    ActiveSheet.Name = mon & "." & (i)
Next i 
```

这会将它们正确放置在 sheet1 之后：

```
Set wsTemp = Sheets(1)
For i = 1 To Val(days)
    Set wsTemp = Sheets(1).Copy(After:=wsTemp)
    wsTemp.Name = mon & "." & (i)
Next i 
```

# hyperlink - 锚名称未连接到锚链接

> ID：15558325
> 
> 赞同：0
> 
> 时间：2013-03-21T21:18:13.443
> 
> 标签：hyperlink, tags, anchor, internal

我正在构建的移动网站上有一个菜单按钮，它链接到底部的导航菜单，因此用户可以单击它并直接下拉到菜单。我已经检查过 HTML 很多次，但我不确定为什么它不能在这个特定的站点上运行。（该网站[可以在这里找到](http://www.absolutenexus.net/tiffin-music-and-art-festival/mobile)。）

这是我的代码：

```
<a href="#bottom_nav">Menu</a> 
```

链接到：

```
<a href="" name="bottom_nav" id="bottom_nav"><img src=""/></a> 
```

我已经尝试将它链接到名称属性和 id。两者都没有工作。有人看到我的代码有问题吗？我什至尝试将名称和 ID 添加到 img 标签。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T21:50:11.817

我认为您可能试图一次加载太多版本的 jQuery ......这似乎会阻止您的链接锚点跳转到您的命名锚点。

*在您的网页顶部，您有以下内容：*

```
<script src="http://code.jquery.com/jquery-1.8.0.min.js"></script>
<script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script> 
```

*然后，在你的网页底部，你有这个：*

```
<script src="/tiffin-music-and-art-festival/mobile/js/jquery.mobile-1.2.0.js"></script>
<script src="/tiffin-music-and-art-festival/mobile/js/jqm-docs.js"></script>
<script src="/tiffin-music-and-art-festival/mobile/js/jquery-1.7.1.min.js"></script> 
```

尝试确定您真正想要包含的 jQuery 版本，然后删除多余的行。然后......链接跳转应该可以工作。

# php - 在 Ubuntu 服务器上安装 XHProf

> ID：15558326
> 
> 赞同：4
> 
> 时间：2013-03-21T21:18:17.513
> 
> 标签：php, ubuntu, xhprof

我尝试了以下教程以及其他教程：

[http://akyl.net/how-install-xhprof-profiler-ubuntu](http://akyl.net/how-install-xhprof-profiler-ubuntu)

[http://erichogue.ca/2011/03/linux/profiling-a-php-application/](http://erichogue.ca/2011/03/linux/profiling-a-php-application/)

我不断收到以下错误消息：

```
running: make
/bin/bash /tmp/pear/install/pear-build-fieldnation1Iqjyy/xhprof-0.9.2/libtool --mode=compile cc  -I. -I/tmp/pear/install/xhprof/extension -DPHP_ATOM_INC -I/tmp/pear/install/pear-build-fieldnation1Iqjyy/xhprof-0.9.2/include -I/tmp/pear/install/pear-build-fieldnation1Iqjyy/xhprof-0.9.2/main -I/tmp/pear/install/xhprof/extension -I/usr/include/php5 -I/usr/include/php5/main -I/usr/include/php5/TSRM -I/usr/include/php5/Zend -I/usr/include/php5/ext -I/usr/include/php5/ext/date/lib -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64  -DHAVE_CONFIG_H  -g -O2   -c /tmp/pear/install/xhprof/extension/xhprof.c -o xhprof.lo
libtool: compile:  cc -I. -I/tmp/pear/install/xhprof/extension -DPHP_ATOM_INC -I/tmp/pear/install/pear-build-fieldnation1Iqjyy/xhprof-0.9.2/include -I/tmp/pear/install/pear-build-fieldnation1Iqjyy/xhprof-0.9.2/main -I/tmp/pear/install/xhprof/extension -I/usr/include/php5 -I/usr/include/php5/main -I/usr/include/php5/TSRM -I/usr/include/php5/Zend -I/usr/include/php5/ext -I/usr/include/php5/ext/date/lib -D_LARGEFILE_SOURCE -D_FILE_OFFSET_BITS=64 -DHAVE_CONFIG_H -g -O2 -c /tmp/pear/install/xhprof/extension/xhprof.c  -fPIC -DPIC -o .libs/xhprof.o
In file included from /usr/include/php5/main/php.h:33:0,
                 from /tmp/pear/install/xhprof/extension/xhprof.c:27:
/usr/include/php5/main/php_config.h:2396:0: warning: "_GNU_SOURCE" redefined [enabled by default]
/tmp/pear/install/xhprof/extension/xhprof.c:24:0: note: this is the location of the previous definition
/tmp/pear/install/xhprof/extension/xhprof.c:236:1: warning: 'visibility' attribute ignored [-Wattributes]
/tmp/pear/install/xhprof/extension/xhprof.c:240:28: warning: 'visibility' attribute ignored [-Wattributes]
/tmp/pear/install/xhprof/extension/xhprof.c: In function 'hp_get_function_name':
/tmp/pear/install/xhprof/extension/xhprof.c:898:10: warning: assignment discards 'const' qualifier from pointer target type [enabled by default]
/tmp/pear/install/xhprof/extension/xhprof.c:909:13: warning: assignment discards 'const' qualifier from pointer target type [enabled by default]
/tmp/pear/install/xhprof/extension/xhprof.c:911:13: warning: assignment discards 'const' qualifier from pointer target type [enabled by default]
/tmp/pear/install/xhprof/extension/xhprof.c:930:34: error: 'znode_op' has no member named 'u'
/tmp/pear/install/xhprof/extension/xhprof.c:963:9: warning: passing argument 1 of 'hp_get_base_filename' discards 'const' qualifier from pointer target type [enabled by default]
/tmp/pear/install/xhprof/extension/xhprof.c:856:14: note: expected 'char *' but argument is of type 'const char *'
/tmp/pear/install/xhprof/extension/xhprof.c: In function 'hp_execute_internal':
/tmp/pear/install/xhprof/extension/xhprof.c:1650:24: error: 'znode_op' has no member named 'u'
/tmp/pear/install/xhprof/extension/xhprof.c:1651:59: error: 'struct <anonymous>' has no member named 'return_reference'
/tmp/pear/install/xhprof/extension/xhprof.c:1652:25: error: 'znode_op' has no member named 'u'
/tmp/pear/install/xhprof/extension/xhprof.c: In function 'hp_compile_file':
/tmp/pear/install/xhprof/extension/xhprof.c:1683:3: warning: passing argument 1 of 'hp_get_base_filename' discards 'const' qualifier from pointer target type [enabled by default]
/tmp/pear/install/xhprof/extension/xhprof.c:856:14: note: expected 'char *' but argument is of type 'const char *'
make: *** [xhprof.lo] Error 1
ERROR: `make' failed 
```

基本上，'make' 无法运行。我该如何度过这个难关？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-06-06T14:45:39.030

我遇到了同样的问题，使用以下步骤修复了它：

下载“xhprof”包：

*   cd /扩展/
*   php化
*   ./configure --with-php-config=
*   制作
*   进行安装
*   做测试

现在在 php.ini 中添加以下行：

*   [xhprof]
*   扩展=xhprof.so
*   xhprof.output_dir="directory_for_storing_xhprof_runs"

现在：**apache重启**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-24T09:16:46.230

[使用来自http://pecl.php.net/package/xhprof](http://pecl.php.net/package/xhprof)的最新更新成功完成了制作过程

# c# - 我可以使用 Lambda（方法语法）而不是（查询语法）执行什么查询？

> ID：15558332
> 
> 赞同：3
> 
> 时间：2013-03-21T21:18:40.953
> 
> 标签：c#, .net, linq, lambda

我可以使用 Lambda（方法语法）而不是（查询语法）执行什么查询？

问题很简单，这是两者的示例：

```
 int[] numbers = { 5, 10, 8, 3, 6, 12};

    //Query syntax:
    IEnumerable<int> numQuery1 = 
        from num in numbers
        where num % 2 == 0
        orderby num
        select num;

    //Method syntax:
    IEnumerable<int> numQuery2 = numbers.Where(num => num % 2 == 0).OrderBy(n => n); 
```

什么是我可以执行方法语法而不是查询语法的查询？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-22T06:51:47.230

（这个答案比我最初写的要短，但其他答案已经提供了一些细节。）

有两个原因可能希望使用 lambda 表达式而不是查询表达式：

*   查询表达式根本没有涵盖的操作，无论是根本没有涵盖的方法（例如）还是查询表达式*中*包含但不以该形式包含`Count`的操作的重载。例如：

     *```
    var indexedValues = values.Select((value, index) => new { value, index }); 
    ```

    没有使用该重载的查询表达式形式。* 
**   当 lambda 形式更简单时。例如，如果您只有一个投影或过滤器，则在一次调用中完成它可能比设置查询表达式的绒毛更简单：

    ```
     var adults = people.Where(person => person.Age > 18); 
    ```

    对比：

    ```
     var adults = from person in people
                  where person.Age > 18
                  select person; 
    ```

    此外，当您想在查询后继续表达式时，lambda 表达式方法会更加整洁。例如，创建一个成年人姓名列表：

    ```
     var names = people.Where(person => person.Age > 18)
                       .Select(person => person.Name)
                       .ToList(); 
    ```

    对比：

    ```
     var names = (from person in people
                  where person.Age > 18
                  select person.Name).ToList(); 
    ```

    括号最终有点烦人。* 

 *查询表达式的亮点在于引入*透明标识符*的操作- 连接`SelectMany`等`let`。虽然您显然*可以*将此类代码转换为 lambda 形式，但它最终会变得非常丑陋。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-21T21:50:07.510

您可以在此处找到在查询表达式语法中具有相应关键字的方法的完整列表：[标准查询运算符的查询表达式语法](http://msdn.microsoft.com/en-us/library/vstudio/bb882642.aspx)。列表包含有关 C# 和 VB.NET 支持的信息。任何未列出的方法在 C# 和 VB.NET 中均不可用。

有趣的是，在 VB.NET 中比在 C# 中可用的更多。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-21T21:44:14.333

您不能执行`select top 10`查询语法。您可以`.Take(10)`在方法语法中使用。

也不支持聚合函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T21:44:30.763

LINQ 查询语法直接转换为扩展方法语法。然而，反过来是*不*正确的。扩展方法比 LINQ 查询语法关键字支持的方法多得多。

因此，使用方法语法，您可以执行与使用 LINQ 查询语法*完全相同或更多的操作。*通常 LINQ 查询语法更易于阅读。

```
// LINQ query syntax
var query = 
    from num in numbers
    where num % 2 == 0
    orderby num
    select num;

// Corresponding method syntax
var query = numbers
    .Where(num => num % 2 == 0)
    .OrderBy(num => num)
    .Select(num => num); 
```

一个简单的示例，说明您可以使用方法语法而不是查询语法（因为它没有关键字）：

```
var query = numbers
    .First(); 
```

如果需要，您可以将两者结合起来：

```
var query = 
    (from num in numbers
    where num % 2 == 0
    orderby num
    select num)
    .First(); 
```

除了`First`，还有大量的 LINQ 扩展方法（`Sum`, `Average`, `Max`...）在 LINQ 查询语法中没有关键字。

* * *

顺便说一句，由于 LINQ 查询语法映射到扩展方法，因此您*不限*于使用 LINQ 扩展方法。如果您在自己的自定义对象上定义都接受委托的 a`Select`和`Where`方法，那么您可以*在自己的对象上*使用 LINQ 查询语法！多么酷啊？例如，一个无意义的例子：

```
public class MyClass
{
    public MyClass Where(Func<string, bool> function)
    {
        return this;
    }

    public List<string> Select(Func<string, string> function)
    {
        return new List<string>();
    }
}

MyClass myClass = new MyClass();
var x = from m in myClass
        where !String.IsNullOrEmpty(m)
        select m; 
```*

# c# - 如何递归地包含所有可导航属性以模拟延迟加载

> ID：15558334
> 
> 赞同：2
> 
> 时间：2013-03-21T21:18:47.530
> 
> 标签：c#, entity-framework, entity-framework-5

为了模拟延迟加载，我想要一个方法，通过急切加载递归地包含完整的对象图，以便在加载实体时，也加载其所有相关数据。

从 MSDN 文档：

*   要包含单个引用：query.Include(e => e.Level1Reference)。
*   要包含单个集合：query.Include(e => e.Level1Collection)。
*   要包含一个参考，然后是一个参考向下一级：query.Include(e => e.Level1Reference.Level2Reference)。
*   要包含一个引用，然后包含一个向下一级的集合：query.Include(e => e.Level1Reference.Level2Collection)。
*   要包含一个集合，然后包含一个参考，请执行以下操作：query.Include(e => e.Level1Collection.Select(l1 => l1.Level2Reference))。
*   要包含一个集合，然后包含一个向下一级的集合：query.Include(e => e.Level1Collection.Select(l1 => l1.Level2Collection))。
*   要包含一个集合，然后包含一个参考，请执行以下操作：query.Include(e => e.Level1Collection.Select(l1 => l1.Level2Reference))。
*   要包含一个集合，然后包含一个向下一级的集合：query.Include(e => e.Level1Collection.Select(l1 => l1.Level2Collection))。
*   要包含一个集合、一个引用和一个向下两个级别的引用：query.Include(e => e.Level1Collection.Select(l1 => l1.Level2Reference.Level3Reference))。
*   要包含一个集合、一个集合和一个参考向下两个级别：query.Include(e => e.Level1Collection.Select(l1 => l1.Level2Collection.Select(l2 => l2.Level3Reference)))。

问题：

如何递归地包含所有可导航属性并将其构建到通用存储库方法中，以便我可以在需要时获得实体的深层对象图，无论是否添加了新属性？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-22T14:40:10.523

好的，这是一个经过编辑的版本，应该能更好地满足您的要求：

```
private static void EnumerateAllIncludesList(DbContext context, IEnumerable entities, List<object> entitiesLoaded = null)
{
    if (entitiesLoaded == null)
        entitiesLoaded = new List<object>();

    foreach (var entity in entities)
        EnumerateAllIncludesEntity(context, entity, entitiesLoaded);

}

private static void EnumerateAllIncludesEntity(DbContext context, object entity, List<object> entitiesLoaded)
{
    if (entitiesLoaded.Contains(entity))
        return;

    entitiesLoaded.Add(entity);

    Type type = entity.GetType();
    var properties = type.GetProperties();

    foreach (var propertyInfo in properties)
    {
        var propertyType = propertyInfo.PropertyType;

        bool isCollection = propertyType.GetInterfaces().Any(x => x == typeof(IEnumerable)) &&
                            !propertyType.Equals(typeof(string));

        if (isCollection)
        {
            var entry = context.Entry(entity);

            if(entry.Member(propertyInfo.Name) as DbCollectionEntry == null)
                continue;

            entry.Collection(propertyInfo.Name).Load();

            var propertyValue = propertyInfo.GetValue(entity);

            if (propertyValue == null)
                continue;

            EnumerateAllIncludesList(context, (IEnumerable)propertyValue, entitiesLoaded);
        }
        else if ((!propertyType.IsValueType && !propertyType.Equals(typeof(string))))
        {
            var entry = context.Entry(entity);

            if (entry.Member(propertyInfo.Name) as DbReferenceEntry == null)
                continue;

            entry.Reference(propertyInfo.Name).Load();

            var propertyValue = propertyInfo.GetValue(entity);

            if (propertyValue == null)
                continue;

            EnumerateAllIncludesEntity(context, propertyValue, entitiesLoaded);
        }
        else
            continue;
    }
} 
```

你会这样使用它：

```
using (var context = new MyContext())
{
    var result = context.People.Where(x => x.Id == 1).ToList();
    EnumerateAllIncludesList(context,result);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T14:12:22.467

如果您使用模型优先或数据库优先，您可以编写一些 T4 模板来使用 edmx 模型生成您需要的内容。这并不容易，但可能。

# java - 为什么这个类是抽象的？

> ID：15558337
> 
> 赞同：0
> 
> 时间：2013-03-21T21:19:07.800
> 
> 标签：java, optimization

在我的 AP 计算机科学课上，我们一直在学习[GridWorld](https://apstudent.collegeboard.org/apcourse/ap-computer-science-a/gridworld-case-study)案例研究。看着它，似乎 AbstractGrid 类没有抽象的理由，因为它没有抽象方法或值。为什么会这样？

**更多信息**

如果只是强制实现 Grid 接口，为什么不将这些方法作为抽象方法（因此在没有接口的情况下强制这些类的签名）。此外，无论如何，这两个孩子都会覆盖它的大部分方法。

```
package info.gridworld.grid;
import java.util.ArrayList;

public abstract class AbstractGrid<E> implements Grid<E>
{
    public ArrayList<E> getNeighbors(Location loc)
    {
        ArrayList<E> neighbors = new ArrayList<E>();
        for (Location neighborLoc : getOccupiedAdjacentLocations(loc))
            neighbors.add(get(neighborLoc));
        return neighbors;
    }

    public ArrayList<Location> getValidAdjacentLocations(Location loc)
    {
        ArrayList<Location> locs = new ArrayList<Location>();

        int d = Location.NORTH;
        for (int i = 0; i < Location.FULL_CIRCLE / Location.HALF_RIGHT; i++)
        {
            Location neighborLoc = loc.getAdjacentLocation(d);
            if (isValid(neighborLoc))
                locs.add(neighborLoc);
            d = d + Location.HALF_RIGHT;
        }
        return locs;
    }

    public ArrayList<Location> getEmptyAdjacentLocations(Location loc)
    {
        ArrayList<Location> locs = new ArrayList<Location>();
        for (Location neighborLoc : getValidAdjacentLocations(loc))
        {
            if (get(neighborLoc) == null)
                locs.add(neighborLoc);
        }
        return locs;
    }

    public ArrayList<Location> getOccupiedAdjacentLocations(Location loc)
    {
        ArrayList<Location> locs = new ArrayList<Location>();
        for (Location neighborLoc : getValidAdjacentLocations(loc))
        {
            if (get(neighborLoc) != null)
                locs.add(neighborLoc);
        }
        return locs;
    }

    /**
     * Creates a string that describes this grid.
     * @return a string with descriptions of all objects in this grid (not
     * necessarily in any particular order), in the format {loc=obj, loc=obj,
     * ...}
     */
     public String toString()
     {
         String s = "{";
         for (Location loc : getOccupiedLocations())
         {
             if (s.length() > 1)
                 s += ", ";
             s += loc + "=" + get(loc);
         }
         return s + "}";
     }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-21T21:24:24.430

由于`AbstractGrid<E>`implements `Grid<E>`，但没有实现其所有方法，因此必须声明它`abstract`。

任何非子`abstract`类`AbstractGrid<E>`都需要实现这些方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T21:26:53.283

该类是抽象的，因为多种类型的“网格”类继承自它。虽然 AbstractGrid 包含常用方法/变量，但它不能单独运行。因此，它是抽象的。

去年必须参加这个考试，祝你好运=）

# java - @Autowired 和 bean 创建顺序

> ID：15558338
> 
> 赞同：3
> 
> 时间：2013-03-21T21:19:07.563
> 
> 标签：java, spring, autowired

在创建其他依赖豆之前，是否可以避免@Autowire 一些豆？让我用一个例子更好地解释它：

我有一个 FactoryBean，它创建一个类型为*A*的对象，该对象具有一个名为*a*的属性。*如果该属性为 null，它会为 bean A*分配一个默认值。

在@Configuration 类中，我有：

```
    @自动连线
    私有的一个 myBean；

```

发生的事情是工厂创建了 bean（我不完全理解如何）但是工厂中的字段*a*为空，我需要它需要另一个用于创建*A*的 bean 。我无法向 Factory 添加任何注释，因为它位于外部依赖项中。

问题是我需要在 @Autowired 向工厂请求对象之前设置*a的值。*考虑到我的限制，有可能吗？

**编辑** 继承人的代码：

```
@Configuration
@ImportResource("classpath:factory-context.xml")
public class ServiceContextConfig {
    @Autowired
    private A createdObject;

    @Bean(name = "entities-list")
    public List<String> getEntity() {
        List<String> ls = new ArrayList<String>();
        ls.add("countriescatalog");
        return ls;
    } 
```

然后 factory-context.xml 看起来像这样：

```
<bean id="client-factory" class="ClientFactory">
    <property name="entities" ref="entities-list"/>
</bean> 
```

其实配置要大一些。我没有尝试像这样的简化示例。我将尝试使用像这样的简化上下文来重现它，看看我是否可以按照@emd 的建议修复它包装工厂

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T21:23:24.510

我希望我正确理解了这个问题。但这里有一个例子，你可以做什么：

把工厂包裹在自己的工厂里。在您自己的工厂中自动连接该字段。用原厂构造对象，注入字段，返回对象。

例子：

```
public class MyFactory {

    @Autowired
    private A a;

    private final OriginalFactory originalFactory;

    public MyFactory(OriginalFactory originalFactory) {
        this.originalFactory=originalFactory;
    }

    public CreateObject getInstance() {

        CreatedObject createdObject = originalFactory.getInstance();
        createdObject.setA(a);

        return createdObject;
    }
} 
```

弹簧部分：

```
<bean id="myFactory" class="aa.aa.MyFactory">
    <constructor-arg ref="originalFactory" />  
</bean>         
<bean id="createdObject" factory-bean="myFactory" factory-method="getInstance"/> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-03-06T21:37:42.507

根据您的问题，我假设`@Autowired A createdObject`依赖于`@Bean "entities-list"`，但在创建`createdObject`之前正在自动装配`"entities-list"`。

我遇到了类似的问题并找到了解决方案。

在任何特定的类中，Spring在将任何方法添加到上下文之前`@Configuration`首先解析所有字段。但是，列表中的任何 bean都将在解析字段之前添加到上下文中。`@Autowired``@Bean``@Import``@Autowired`

因此，我们可以通过创建一个内部配置类来解决我们的问题：

```
@Configuration
@Import(ServiceContextConfig.InnerConfig.class)   // <-- don't forget to add here 
@ImportResource("classpath:factory-context.xml")
public class ServiceContextConfig {
    @Autowired
    private A createdObject;

    @Configuration
    static class InnerConfig {     // <-- wrap bean in an "inner-configuration"
        @Bean(name = "entities-list")
        public List<String> getEntity() {
            List<String> ls = new ArrayList<String>();
            ls.add("countriescatalog");
            return ls;
        }
    }
} 
```

如果您无法编辑其他配置，这将特别有用，`factory-context.xml`.

# php - 非常简单的 HTML / 纯文本电子邮件在 microsoft live.com 中根本没有显示

> ID：15558340
> 
> 赞同：1
> 
> 时间：2013-03-21T21:19:09.847
> 
> 标签：php, email, live, html-email

我一直在使用一个非常简单的 PHP 函数来构建 HTML / 纯文本电子邮件。它在我看到的 gmail 和许多其他客户中运行良好。

事实证明，@live.com 帐户根本看不到电子邮件内容。

以下是相关代码：

```
$random_hash = md5(date('r', time()));
//define the headers we want passed. Note that they are separated with \r\n
$headers = "From: server@example.com\r\nReply-To: server@example.com\r\n";
$headers .= "MIME-Version: 1.0\r\n";
//add boundary string and mime type specification
$headers .= "Content-Type: multipart/alternative; boundary=$random_hash\r\n";
$headers .= "Content-Transfer-Encoding: 7bit\r\n";
//define the body of the message.
$message = "This is a MIME encoded message.\r\n\r\n" .
    "--$random_hash\r\n" .
    "Content-Type: text/plain; charset=utf-8\r\n" .
    //"Content-Transfer-Encoding: 7bit\r\n" .
"\r\nthis is plain text.\r\n\r\n" .
"--$random_hash\r\n" .
"Content-Type: text/html; charset=utf-8\r\n" .
    //"Content-Transfer-Encoding: 7bit\r\n" .
    "\r\n<html><body>this is wonderful <b>HTML</b> text.</body></html>" .
    "\r\n\r\n--$random_hash--\r\n";
mail('someAddress@live.com', 'This is u umlaut: ü', $message, $headers); 
```

如果我只发送 HTML 或纯文本，它将正确显示。

有任何想法吗？

我不想使用额外的库。基本上，我需要的 HTML 就是链接。[PHP Multi-Part Text/HTML 上显示空白](https://stackoverflow.com/questions/15553903/php-multi-part-text-html-showing-blank)的答案对我没有帮助。

顺便说一句：u umlaut 在 live.com 收件箱的电子邮件列表中显示不正确，但当我在 live.com 中打开电子邮件时显示正确...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T11:57:43.440

几个小时后得到它。

问题是`CR`和`LF`。

`\r\n`我用LF ( )替换了所有 CRLF ( `\n`) 并且它起作用了。

途中，我还把7bit换成了8bit。

至于主题行，谷歌很容易找到，这是 utf-8 的解决方案：

```
$subject = '=?utf-8?B?' . base64_encode($subject) . '?='; 
```

多谢你们！

# c# - 如何使用静态列表 作为缓存对象？

> ID：15558341
> 
> 赞同：3
> 
> 时间：2013-03-21T21:19:14.647
> 
> 标签：c#, design-patterns, collections, synchronization

我有一个静态`List<T>`作为缓存对象，被多个线程大量读取。我需要每 5 分钟从数据库刷新一次对象。

问题是，如果我在其中一个线程使用对象时更新对象，则`foreach`循环将引发异常。

我试图实现像`inUse = true`and之类的标志`inUpdate = true`，以及等待标志设置或释放的*while*循环，但最终它变得太麻烦了，我认为有一个错误会阻止对象被更新。

对于这种情况，我可以使用类似设计模式的东西吗？

* * *

**编辑：**

基于[Jim Mischel 的示例](https://stackoverflow.com/questions/15558341/how-to-use-a-static-listt-as-a-cache-object/15558578#15558578)，我能够生成以下代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading;

namespace ConsoleApplication4 
{
    class Program 
    {
        static Timer g;
        static Timer f;
        static Timer r;
        static Timer l;

        static void Main(string[] args) 
        {
            f=new Timer(
                o => SetK(new Random().Next(Int32.MinValue, Int32.MaxValue)), 
                null, 0, 1);

            l=new Timer(
                o => SetK(new Random().Next(Int32.MinValue, Int32.MaxValue)), 
                null, 1, 1);

            g=new Timer(o => RunLoop(), null, 1000, Timeout.Infinite);
            r=new Timer(o => RunLoop(), null, 1001, Timeout.Infinite);

            Console.ReadLine();
        }

        public static void SetK(int g) 
        {
            try {
                if(g<0) {
                    List<int> k=new List<int>(10);

                    k.Insert(0, g);
                    k.Insert(1, g);
                    k.Insert(2, g);
                    k.Insert(3, g);
                    k.Insert(4, g);
                    k.Insert(5, g);
                    k.Insert(6, g);
                    k.Insert(7, g);
                    k.Insert(8, g);
                    k.Insert(9, g);

                    SynchronizedCache<Int32>.Set(k);
                }
                else {
                    List<int> k=new List<int>(5);
                    k.Insert(0, g);
                    k.Insert(1, g);
                    k.Insert(2, g);
                    k.Insert(3, g);
                    k.Insert(4, g);

                    SynchronizedCache<Int32>.Set(k);
                }
            }
            catch(Exception e) {
            }
        }

        public static void RunLoop() 
        {
            try {
                while(true) {
                    try {
                        SynchronizedCache<Int32>.GetLock().EnterReadLock();

                        foreach(var g in SynchronizedCache<Int32>.Get()) {
                            Console.Clear();
                            Console.WriteLine(g);
                        }
                    }
                    finally {
                        SynchronizedCache<Int32>.GetLock().ExitReadLock();
                    }
                }
            }
            catch(Exception e) {
            }
        }
    }

    public static class SynchronizedCache<T> 
    {
        private static ReaderWriterLockSlim 
            cacheLock=new ReaderWriterLockSlim();

        private static List<T> cache=new List<T>();

        public static ReaderWriterLockSlim GetLock() 
        {
            return cacheLock;
        }

        public static void Set(List<T> list) 
        {
            cacheLock.EnterWriteLock();

            try {
                cache=list;
            }
            finally {
                cacheLock.ExitWriteLock();
            }
        }

        public static List<T> Get() 
        {
            return cache;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-21T21:32:27.777

不幸的是，没有一个`System.Collections.Concurrent`集合可以很好地映射到`List<T>`. 如果我需要这样的东西，我会使用一个在内部使用 a`ReaderWriterLockSlim`来保护它的包装器。例如：

```
public class ConcurrentList<T>: IList<T>
{
    private readonly List<T> _theList;
    private readonly ReaderWriterLockSlim _rwlock = new ReaderWriterLockSlim();

    public ConcurrentList()
    {
        _theList = new List<T>();
    }

    public ConcurrentList(IEnumerable<T> collection)
    {
        _theList = new List<T>(collection);
    }

    public ConcurrentList(int size)
    {
        _theList = new List<T>(size);
    }

    public int IndexOf(T item)
    {
        _rwlock.EnterReadLock();
        try
        {
            return _theList.IndexOf(item);
        }
        finally
        {
            _rwlock.ExitReadLock();
        }
    }

    public void Insert(int index, T item)
    {
        _rwlock.EnterWriteLock();
        try
        {
            _theList.Insert(index, item);
        }
        finally
        {
            _rwlock.ExitWriteLock();
        }
    }

    public T this[int index]
    {
        get
        {
            _rwlock.EnterReadLock();
            try
            {
                return _theList[index];
            }
            finally
            {
                _rwlock.ExitReadLock();
            }
        }
        set
        {
            _rwlock.EnterWriteLock();
            try
            {
                _theList[index] = value;
            }
            finally
            {
                _rwlock.ExitWriteLock();
            }
        }
    }

    public IEnumerator<T> GetEnumerator()
    {
        _rwlock.EnterReadLock();
        try
        {
            foreach (var item in _theList)
            {
                yield return item;
            }
        }
        finally
        {
            _rwlock.ExitReadLock();
        }
    }

    System.Collections.IEnumerator System.Collections.IEnumerable.GetEnumerator()
    {
        return GetEnumerator();
    }

    // other methods not implemented, for brevity
} 
```

}

第一次设置它有点工作，但之后它运行良好。它支持任意数量的并发读取器，或者只支持一个写入器。

任意数量的读者可以同时访问该列表。如果一个线程想要写入列表，它必须获得写锁。为了获得写锁，它一直等到所有读取器都完成。一旦线程请求了写锁，就没有线程可以进入读锁。一旦作者完成，读者将被允许通过。

@Servy 也有一个很好的建议。如果您的线程只是在阅读，并且您定期从数据库中刷新列表（即完全构建一个新列表），那么按照他的说法很容易做到。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-21T21:21:01.400

使用[`System.Collections.Concurrent`](http://msdn.microsoft.com/en-us/library/system.collections.concurrent.aspx)命名空间中的并发集合之一。

> 命名空间提供了几个线程安全的集合类，当多个线程同时访问集合时`System.Collections.Concurrent`，应该使用这些类来代替 和 命名空间中的相应类型`System.Collections`。`System.Collections.Generic`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-21T21:35:31.557

与其改变单个列表，在这种情况下，最好创建一个包含您想要的更改的新列表（即具有其他项目，不添加某些项目等），然后将缓存值设置为请参阅新列表。由于设置缓存的值是原子的，因此您可以确保一旦有人从缓存中获取值，它可能会有点陈旧，但他们仍然能够很好地读取它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T21:49:45.220

我认为最好的解决方案是使用互斥锁设计模式来避免竞争条件。幸运的是，.NET 框架具有互斥体设计模式的标准实现。您可以阅读[http://msdn.microsoft.com/it-it/library/system.threading.mutex.aspx](http://msdn.microsoft.com/it-it/library/system.threading.mutex.aspx)上的文档。

# php - 将来自指定站点的 cookie 保存到我的服务器上的文件

> ID：15558343
> 
> 赞同：0
> 
> 时间：2013-03-21T21:19:21.290
> 
> 标签：php, javascript, cookies

对于我的示例，我将使用以下变量：

*   first_site.com = 我将在其中执行 cookie 获取命令的网站

*   specified_site.com = 我的第二个网站，客户已经登录

*   my_server.com = 我的服务器地址，我有一个 php 脚本来处理接收到的数据

用户已经连接到 first_site.com 和 specified_site.com

我想从“first_site.com”获取cookie并将它们保存到“my_server.com”

有什么方法可以做到这一点，用 php 或 javascript 吗？

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T21:22:17.657

如果两个站点都是您的，并且您可以访问两个站点上的服务器端代码，那么您可以让第一个服务器使用服务器到服务器通信将 cookie 转发到第二个服务器。

浏览器内置的“同源”保护试图阻止您从纯客户端代码执行您想做的事情（不涉及两个服务器）。

这是因为只有当您的页面位于 cookie 所属的域中时，您才能检索 cookie。而且，您只能将 cookie（使用 ajax）发送到与页面位于同一域的服务器。因此，您不能将一个域的 cookie 发送到另一台服务器。这是一个明显的安全违规行为，浏览器打算用它的“同源”保护来阻止它。[您可以在此处](https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&ved=0CDUQFjAA&url=https://developer.mozilla.org/en-US/docs/JavaScript/Same_origin_policy_for_JavaScript&ei=p3pLUYWIG4bKiwKOoYD4CQ&usg=AFQjCNEWPbryDUJDEOIJJ3661cxWzgMgiQ&sig2=MB4SHI-rOG5H4DPT93Qszw&bvm=bv.44158598,d.cGE)阅读有关这些保护的信息。

如果您有来自第一个站点的合作服务器，您可以让该服务器在它与原始页面请求一起发送时检索 cookie，然后该服务器可以使用服务器到服务器通信将 cookie 发送到您的第二个站点. 如果第一个域不是您可以修改服务器端代码的域，那么显然您不能在该服务器上运行代码来执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T21:21:35.783

没有办法做到这一点，因为这将是一个巨大的安全漏洞。

想象一下，如果我创建一个网站来保存你所有的 PHPSESSID，我可以在许多网站上访问你的个人资料......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T21:33:57.543

这些是少数几个选项。虽然不是最好的。一些帮助您入门的一般指示：

一个。您也可以考虑设置 VPN。这会将两台服务器的 IPS 列入白名单。

1.  您可以创建一个包含您的 cookie 信息的 REST API（虽然不公开）！！
2.  在 App1 上提供您的 cookie 数据；
3.  使您的 cookie 可用作可通过请求/响应对象提供的 Cookie 对象
4.  使用“同源”政策；你可以让 app2 和 app1 对话

# ruby - 通过 .net 技术在 Ruby 中创建 SHA1 哈希

> ID：15558345
> 
> 赞同：0
> 
> 时间：2013-03-21T21:19:23.117
> 
> 标签：ruby, ruby-on-rails-3

好的，希望标题没有吓跑你。我正在使用 Ruby 创建一个 sha1 哈希，但它必须遵循我们其他系统用来创建哈希的公式。

如何通过 Ruby 执行以下操作？我很好地创建了哈希 - 但格式的东西让我感到困惑 - 好奇 Ruby 标准库中是否有等价的东西。

[系统安全密码学 (MSDN)](http://msdn.microsoft.com/en-us/library/system.security.cryptography.sha1.aspx)

这是我试图转换为 Ruby 的 C# 代码。我的哈希值很好，但不确定 'String.Format("{0,2:X2}' 部分。

> ```
> //create our SHA1 provider
> SHA1 sha = new SHA1CryptoServiceProvider();
> 
> String str = "Some value to hash";
> String hashedValue; -- hashed value of the string
> 
> //hash the data -- use ascii encoding
> byte[] hashedDataBytes = sha.ComputeHash(Encoding.ASCII.GetBytes(str));
> 
> //loop through each byte in the byte array 
> foreach (byte b in hashedDataBytes) 
> {
>    //convert each byte -- append to result
>    hashedValue += String.Format("{0,2:X2}", b); 
> } 
> ```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T21:26:15.053

特定数据的 SHA1 哈希始终是相同的哈希（实际上只是一个大数字），唯一的变化应该是您需要如何格式化它，例如发送到其他系统。尽管特别晦涩的系统可能会对数据进行后处理、截断或仅采用备用字节等。

根据阅读 C# 代码的一个非常粗略的猜测，这最终得到了一个标准的 40 个字符的十六进制字符串。所以我最初对 Ruby 的想法是：

```
require 'digest/sha1'
Digest::SHA1.hexdigest("Some value to hash").upcase 
```

. . . 但是，我不知道当 C# 中的 ascii 格式以 Latin-1 或 UTF-8 字符串开头时会产生什么影响。如果只是为了看到 C# 抛出异常，它们将是有用的示例输入 - 你知道你是否需要担心你的 Ruby 版本的字符编码。输入到 SHA1 的数据是字节，而不是字符，因此使用哪种编码以及如何转换是您的问题的一部分。

我目前的理解是 Encoding.ASCII.GetBytes 将强制任何超过字符号 127 的内容为“？”，因此您可能需要在 Ruby 中使用 .gsub 或类似名称来模拟它，特别是如果您实际上期望它来自数据源。

# php - 解析发送到 PayPal 的自定义变量

> ID：15558352
> 
> 赞同：0
> 
> 时间：2013-03-21T21:19:37.123
> 
> 标签：php, variables, paypal

当用户进行购买时，我想向 PayPal 发送一个自定义变量。该变量包含用户提供并存储在 $message 变量中的信息。$product 变量仅用于标识正在购买的产品并为该产品创建适当的 PayPal 按钮（通过引用包含在 'products.php' 中的数组。PayPal 允许您通过名称为“自定义”，就像我在下面所做的那样。

```
<?php
include('products.php');
$currentProduct = $_GET['product'];
$message = $_GET['message'];
?>

<form action="https://www.paypal.com/cgi-bin/webscr" method="post"><input type="hidden" name="cmd" value="_s-xclick"/>
    <input type="hidden" name="hosted_button_id" value="<?php echo $products[$currentProduct]["paypal"]; ?>"/>
    <input type="hidden" name="custom" value="<?php echo $message?>"/>
    <input type="submit" class="button paypal" value="Pay with PayPal"/>
</form> 
```

但是，我环顾四周，找不到关于如何在订单完成后从 PayPal 实际检索此信息的解释。任何人都可以提供一个简单的解释，说明如何在订单完成后检索 $message 中的信息（使用或不使用自定义 PayPal 变量）。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T03:40:53.923

当您使用托管按钮时，您不能像这样包含自定义变量。您必须将其包含在托管按钮创建向导的高级部分中。不幸的是，它在那里几乎没有用，因为你不能那样使用动态值。

您需要做的是返回 PayPal 上的按钮编辑器并禁用“在 PayPal 上保存按钮”选项。这将为您的按钮代码提供更多字段，然后自定义将起作用。

不过，这不如托管按钮安全。因此，我建议您使用[Express Checkout API](https://www.x.com/sites/default/files/pp_expresscheckout_integrationguide.pdf)而不是 Payments Standard。当然，这需要您具有使用 Web 服务 API 的一般经验。

# android - 如何提取自己的 Android 应用程序的（私人）数据？

> ID：15558353
> 
> 赞同：106
> 
> 时间：2013-03-21T21:19:42.723
> 
> 标签：android, adb

尝试使用拉取单个文件

```
adb pull /data/data/com.corp.appName/files/myFile.txt myFile.txt 
```

失败了

```
failed to copy '/data/data/com.corp.appName/files/myFile.txt myFile.txt' to 'myFile.txt': Permission denied 
```

尽管在设备上启用了 USB 调试。

我们可以通过古老的路线绕过这个问题

```
adb shell
run-as com.corp.appName
cat files/myFile.txt > myFile.txt 
```

但这对于多个文件来说很笨拙。

如何将目录 /data/data/com.corp.appName/files 拉到我的 MacBook？

直接或通过在 `/storage/sdcard0/myDir 中的传输（我可以从那里继续进行 Android 文件传输）执行此操作都可以。

**附加评论**

可能只是运行

```
adb backup  -f myFiles com.corp.appName 
```

将生成我正在寻找的文件。在这种情况下，我正在寻找一种解压缩/解压缩生成备份的方法！

* * *

## 回答 #1

> 赞同：121
> 
> 时间：2013-03-21T22:17:54.223

adb backup 将写入一个特定于 Android 的存档：

```
adb backup  -f myAndroidBackup.ab  com.corp.appName 
```

可以使用以下方法将此存档转换为 tar 格式：

```
dd if=myAndroidBackup.ab bs=4K iflag=skip_bytes skip=24 | openssl zlib -d > myAndroidBackup.tar 
```

参考：

[http://nelenkov.blogspot.ca/2012/06/unpacking-android-backups.html](http://nelenkov.blogspot.ca/2012/06/unpacking-android-backups.html)

在该链接中搜索“更新”。

* * *

或者，使用[Android 备份提取器](https://github.com/nelenkov/android-backup-extractor)从 Android 备份 ( `.ab`) 文件中提取文件。

* * *

## 回答 #2

> 赞同：59
> 
> 时间：2015-06-05T06:54:26.357

我有同样的问题，但解决了它运行如下：

```
$ adb shell
$ run-as {app-package-name}
$ cd /data/data/{app-package-name}
$ chmod 777 {file}
$ cp {file} /mnt/sdcard/ 
```

在此之后你可以运行

```
$ adb pull /mnt/sdcard/{file} 
```

* * *

## 回答 #3

> 赞同：35
> 
> 时间：2015-07-19T18:03:50.150

这对我有用：

```
adb -d shell "run-as com.example.test cat /data/data/com.example.test/databases/data.db" > data.db 
```

我将数据库直接打印到本地文件中。

* * *

## 回答 #4

> 赞同：23
> 
> 时间：2015-08-27T21:56:37.453

在 MacOSX 上，通过结合 Calaf 和 Ollie Ford 的答案，以下内容对我有用。

在命令行上（确保 adb 在您的路径中，我的路径是 ~/Library/Android/sdk/platform-tools/adb），并且您的 android 设备已插入并处于 USB 调试模式，运行：

```
 adb backup -f backup com.mypackage.myapp 
```

您的 Android 设备会询问您是否允许备份您的数据。选择“备份我的数据”

稍等片刻。

文件备份将出现在您运行 adb 的目录中。

现在运行：

```
dd if=backup bs=1 skip=24 | python -c "import zlib,sys;sys.stdout.write(zlib.decompress(sys.stdin.read()))" > backup.tar 
```

现在您将拥有一个 backup.tar 文件，您可以像这样解压：

```
 tar xvf backup.tar 
```

并查看您的应用程序存储的所有文件。

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2018-03-29T23:04:29.050

较新版本的 Android Studio 包括*设备文件资源管理器*，我发现它是一种方便的 GUI 方法，可以从我的开发 Nexus 7 下载文件。

您必须确保已在设备上启用 USB 调试

1.  单击查看 > 工具窗口 > 设备文件资源管理器或单击工具窗口栏中的设备文件资源管理器按钮以打开设备文件资源管理器。
2.  从下拉列表中选择一个设备。
3.  在文件资源管理器窗口中与设备内容交互。右键单击文件或目录以创建新文件或目录，将选定的文件或目录保存到您的计算机，上传、删除或同步。双击文件以在 Android Studio 中打开它。

    Android Studio 会将您以这种方式打开的文件保存在项目外部的临时目录中。如果您对使用设备文件资源管理器打开的文件进行了修改，并且希望将更改保存回设备，则必须手动将文件的修改版本上传到设备。

[![文件管理器](../Images/b968363d8dfb1bba81af505a78344b59.png)](https://developer.android.com/studio/debug/device-file-explorer.html)

[完整文档](https://developer.android.com/studio/debug/device-file-explorer.html)

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2014-07-09T16:16:03.873

您可以在下面使用这个 shell 脚本。它也能够从应用程序缓存中提取文件，不像该`adb backup`工具：

```
#!/bin/sh

if [ -z "$1" ]; then 
    echo "Sorry script requires an argument for the file you want to pull."
    exit 1
fi

adb shell "run-as com.corp.appName cat '/data/data/com.corp.appNamepp/$1' > '/sdcard/$1'"
adb pull "/sdcard/$1"
adb shell "rm '/sdcard/$1'" 
```

然后你可以像这样使用它：

```
./pull.sh files/myFile.txt
./pull.sh cache/someCachedData.txt 
```

* * *

## 回答 #7

> 赞同：6
> 
> 时间：2018-01-03T12:02:30.653

如果您使用的是 Mac 机器和三星手机，这是您必须做的（因为在三星上`run-as` [不起作用](https://issuetracker.google.com/issues/37093233#c4)，在 Mac上`zlib` [也不起作用）](https://stackoverflow.com/q/29830981/4747587)

1.  备份应用程序的数据目录 `adb backup -f /Users/username/Desktop/data.ab com.example`

2.  您将被要求输入密码以在您的手机中加密，请勿输入任何密码。只需点击“备份我的数据”。请参阅[如何进行备份？](https://nelenkov.blogspot.in/2012/06/unpacking-android-backups.html)

3.  成功备份后，您将`data.ab`在桌面中看到文件。现在我们需要将其转换为`tar`格式。

4.  为此，请使用**Android Backup Extractor**。[下载](https://sourceforge.net/projects/adbextractor/?source=typ_redirect)| [源代码](https://github.com/nelenkov/android-backup-extractor)

5.  下载它，你会看到`abe.jar`文件。将此添加到您的 PATH 变量中。

6.  执行此操作以生成**tar**文件：`java -jar abe.jar unpack /Users/username/Desktop/data.ab /Users/username/Desktop/data.tar`

7.  提取**data.tar**文件以访问所有文件

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2013-07-02T12:37:14.847

通过添加以下代码设置正确的权限后：

```
File myFile = ...;
myFile.setReadable(true, false); // readable, not only for the owner 
```

`adb pull`按需要工作。

见[File.setReadable()](http://docs.oracle.com/javase/6/docs/api/java/io/File.html#setReadable%28boolean,%20boolean%29)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2016-10-12T23:10:27.397

该答案基于我对其他答案的经验以及答案中的评论。我希望我可以帮助处于类似情况的人。

我正在通过终端在**OSX上执行此操作。**

以前，Vinicius Avellar 的回答对我很有用。我只是大部分时间都需要来自调试应用程序的设备中的数据库。

今天我有一个需要***多个私有文件***的用例。我最终得到了两种适用于这种情况的解决方案。

> 1.  使用接受的答案以及 Somewhere 的 OSX 特定评论。创建备份并使用第 3 方解决方案 [sourceforge.net/projects/adbextractor/files/?source=navbar](https://sourceforge.net/projects/adbextractor/files/?source=navbar)解压缩成 tar。我将在这个答案的底部写更多关于我使用这个解决方案的经验。*如果这是您要查找的内容，请向下滚动。*
>     
>     
> 2.  我解决了一个更快的解决方案。我创建了一个用于提取多个文件的脚本，类似于 Tamas 的答案。我能够这样做是因为我的应用程序是一个调试应用程序，并且我可以在我的设备上访问 run-as。如果您无权访问 run-as，则此方法在 OSX 上对您不起作用。

这是我的脚本，用于提取多个私人文件，我将与你分享，读者也在调查这个很棒的问题；）：

```
#!/bin/bash
#
# Strict mode: http://redsymbol.net/articles/unofficial-bash-strict-mode/
set -euo pipefail
IFS=$'\n\t'

# 
# Usage: script -f fileToPull -p packageName
# 

# This script is for pulling private files from an Android device
# using run-as. Note: not all devices have run-as access, and
# application must be a debug version for run-as to work.
# 
# If run-as is deactivated on your device use one of the
# alternative methods here:
# http://stackoverflow.com/questions/15558353/how-can-one-pull-the-private-data-of-ones-own-android-app
# 
# If you have encrypted backup files use:
# sourceforge.net/projects/adbextractor/files/?source=navbar 
# From comments in the accepted answer in the above SO question
# 
# If your files aren't encrypted use the accepted answer 
# ( see comments and other answers for OSX compatibility )
# 
# This script is open to expansions to allow selecting 
# device used. Currently first selected device from
# adb shell will be used.

#Check we have one connected device
adb devices -l | grep -e 'device\b' > /dev/null

if [ $? -gt 0 ]; then
    echo "No device connected to adb."
    exit 1
fi

# Set filename or directory to pull from device
# Set package name we will run as
while getopts f:p: opt; do
    case $opt in
        f)
            fileToPull=$OPTARG
            ;;
        p)
            packageName=$OPTARG
            ;;
    esac
done;

# Block file arg from being blank
if [ -z "$fileToPull" ]; then
    echo "Please specify file or folder to pull with -f argument"
    exit 1
fi

# Block package name arg from being blank
if [ -z "$packageName" ]; then
    echo "Please specify package name to run as when pulling file"
    exit 1
fi

# Check package exists
adb shell pm list packages | grep "$packageName" > /dev/null
if [ $? -gt 0 ]; then
    echo "Package name $packageName does not exist on device"
    exit 1
fi

# Check file exists and has permission with run-as
fileCheck=`adb shell "run-as $packageName ls $fileToPull"`
if [[ $fileCheck =~ "Permission denied" ]] || [[ $fileCheck =~ "No such file or directory" ]]; then
    echo "Error: $fileCheck"
    echo "With file -> $fileToPull"
    exit 1
fi

# Function to pull private file
#
# param 1 = package name
# param 2 = file to pull
# param 3 = output file
function pull_private_file () {

    mkdir -p `dirname $3`

    echo -e "\033[0;35m***" >&2
    echo -e "\033[0;36m Coping file $2 -> $3" >&2
    echo -e "\033[0;35m***\033[0m" >&2

    adb shell "run-as $1 cat $2" > $3
}

# Check if a file is a directory
# 
# param 1 = directory to check
function is_file_dir() {

    adb shell "if [ -d \"$1\" ]; then echo TRUE; fi"
}

# Check if a file is a symbolic link
# 
# param 1 = directory to check
function is_file_symlink() {

    adb shell "if [ -L \"$1\" ]; then echo TRUE; fi"
}

# recursively pull files from device connected to adb
# 
# param 1 = package name
# param 2 = file to pull
# param 3 = output file
function recurse_pull_private_files() {

    is_dir=`is_file_dir "$2"`
    is_symlink=`is_file_symlink "$2"`

    if [ -n "$is_dir" ]; then

        files=`adb shell "run-as $1 ls \"$2\""`

        # Handle the case where directory is a symbolic link
        if [ -n "$is_symlink" ]; then
            correctPath=`adb shell "run-as $1 ls -l \"$2\"" | sed 's/.*-> //' | tr -d '\r'`
            files=`adb shell "run-as $1 ls \"$correctPath\""`
        fi

        for i in $files; do

            # Android adds nasty carriage return that screws with bash vars
            # This removes it. Otherwise weird behavior happens
            fileName=`echo "$i" | tr -d '\r'` 

            nextFile="$2/$fileName"
            nextOutput="$3/$fileName"
            recurse_pull_private_files "$1" "$nextFile" "$nextOutput"
        done
    else

        pull_private_file "$1" "$2" "$3"
    fi
}

recurse_pull_private_files "$packageName" "$fileToPull" "`basename "$fileToPull"`" 
```

要点： [https ://gist.github.com/davethomas11/6c88f92c6221ffe6bc26de7335107dd4](https://gist.github.com/davethomas11/6c88f92c6221ffe6bc26de7335107dd4)

* * *

**回到方法 1 ，使用**[Android Backup Extractor](https://sourceforge.net/projects/adbextractor/files/?source=navbar)解密备份

以下是我在 Mac 上采取的步骤，以及遇到的问题：

首先，我排队备份（并设置密码来加密我的备份，我的设备需要它）：

```
adb backup -f myAndroidBackup.ab  com.corp.appName 
```

其次，我从这里下载了 abe.jar：[https ://sourceforge.net/projects/adbextractor/files/abe.jar/download](https://sourceforge.net/projects/adbextractor/files/abe.jar/download)

接下来我跑了：

```
java -jar ./abe.jar unpack myAndroidBackup.ab myAndroidBackup.tar 
```

此时我收到一条错误消息。因为我的存档是加密的，java 给了我一个错误，我需要安装一些安全策略库。

*   所以我去了[http://www.oracle.com/technetwork/java/javase/downloads/jce8-download-2133166.html](http://www.oracle.com/technetwork/java/javase/downloads/jce8-download-2133166.html)并下载了我需要的安全策略 jar。现在就我而言，安装说明告诉我放置 jar 文件的位置错误。它说正确的位置是**<java-home>/lib/security**。我先把它们放在那里，但仍然收到错误消息。所以我调查并在我的 Mac 上使用 Java 1.8 放置它们的正确位置是：**<java-home>/jre/lib/security**。我确保备份原始策略 jar，并将它们放在那里。Vola 我能够使用 abe.jar 输入密码并解密为 tar 文件。

最后我刚刚跑了（*再次运行上一个命令之后*）

```
tar xvf myAndroidBackup.tar 
```

现在重要的是要注意，如果您可以只 run-as 和 cat，它会快得多。一，你只得到你想要的文件，而不是整个应用程序。第二，文件越多（对我来说是 + 加密），传输速度就越慢。因此，如果您在 OSX 上没有运行方式，那么知道这样做很重要，但脚本应该首先转到调试应用程序。

请注意，我今天才写它并测试了几次，所以请通知我任何错误！

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2017-06-21T01:39:17.770

与[Tamas 的回答](https://stackoverflow.com/a/24658841/539149)类似，这里是 Mac OS X 的单行代码，用于`your.app.id`从您的设备获取应用程序的所有文件并将它们保存到（在这种情况下）`~/Desktop/your.app.id`：

```
(
    id=your.app.id &&
    dest=~/Desktop &&
    adb shell "run-as $id cp -r /data/data/$id /sdcard" &&
    adb -d pull "/sdcard/$id" "$dest" &&
    if [ -n "$id" ]; then adb shell "rm -rf /sdcard/$id"; fi
) 
```

*   排除`-d`从模拟器中提取的
*   不会踩踏您的会话变量
*   您可以将整个块粘贴到 Terminal.app 中（或根据需要删除换行符）

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-03-05T11:53:58.557

从 Dave Thomas 脚本开始，我已经能够编写自己的解决方案来克服 2 个问题：

1.  我的备份只包含清单文件
2.  戴夫·托马斯（Dave Thomas）获得的二进制文件无法读取

这是我的脚本，它将应用程序数据复制到 sdcard 然后拉取它

```
#Check we have one connected device
adb devices -l | grep -e 'device\b' > /dev/null

if [ $? -gt 0 ]; then
    echo "No device connected to adb."
    exit 1
fi

# Set filename or directory to pull from device
# Set package name we will run as
while getopts f:p: opt; do
    case $opt in
        f)
            fileToPull=$OPTARG
            ;;
        p)
            packageName=$OPTARG
            ;;
    esac
done;

# Block package name arg from being blank
if [ -z "$packageName" ]; then
    echo "Please specify package name to run as when pulling file"
    exit 1
fi

# Check package exists
adb shell pm list packages | grep "$packageName" > /dev/null
if [ $? -gt 0 ]; then
    echo "Package name $packageName does not exist on device"
    exit 1
fi

    adb shell "run-as $packageName cp -r /data/data/$packageName/ /sdcard/$packageName"
    adb pull /sdcard/$packageName
    adb shell rm -rf /sdcard/$packageName 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2018-03-27T08:43:38.590

你可以做：

> adb pull /storage/emulated/0/Android/data//

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-04-27T05:57:31.823

**使用 apk 备份游戏数据**。牛轧糖一加 2。

```
**adb backup "-apk com.nekki.shadowfight" -f "c:\myapk\samsung2.ab"** 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-11-10T09:16:14.530

> 这是否意味着可以将目录从 world:--x chmod 到 world:rx 足够长的时间以能够获取文件？

对，就是这样。奇怪的是，您还需要文件来`x`设置位。（至少在 Android 2.3 上）

`chmod 755`一直在复制文件（但如果您打算继续使用该设备，则应在之后恢复权限）。

# overflow - 是否可以从具有固定高度的菜单中创建纯 CSS 子菜单？

> ID：15558355
> 
> 赞同：0
> 
> 时间：2013-03-21T21:19:45.610
> 
> 标签：overflow, submenu, css

我有一个垂直菜单，其中一些项目的右侧有一个子菜单。这大部分工作正常，但主菜单上可能有很多项目，所以我想要一个带有垂直滚动条的最大高度。

问题是，如果我在主菜单上设置了溢出：自动，那么子菜单将不再正确显示，因为它不能溢出主菜单的宽度。

[这是我的代码，在http://jsfiddle.net/FK8p6/](http://jsfiddle.net/FK8p6/)上有一个示例。如果您从 .menu 类中删除了 overflow: auto ，那么您可以看到子菜单正常工作，但是当然主菜单不再正确显示。

### HTML：

```
<ul class="menu">
    <li>Menu 1</li>
    <li>Menu 2</li>
    <li>Menu 3</li>
    <li>Menu 4</li>
    <li>Menu 5</li>
    <li>
        Menu 6
        <ul class="menu submenu">
            <li>SubMenu 1</li>
            <li>SubMenu 2</li>
            <li>SubMenu 3</li>
        </ul>
    </li>
</ul> 
```

### CSS：

```
.menu
{
    padding: 5px;
    list-style-type: none;
    background-color: #99f;
    max-height: 80px;
    width: 100px;
    overflow: auto;
}

.menu li
{
    border: #ddd 1px solid;
    position: relative;
    line-height: 24px;
    cursor: default;
}

.menu li:hover
{
    background-color: #d1e7ff;
}

.submenu
{
    max-height: none;
    background-color: #fff;
    padding: 0;
    position: absolute;
    top: -1px;
    left: 100%;
    display: none;
}

.menu li:hover .submenu
{
    display: block;
} 
```

我知道我可以将子菜单拉到层次结构中的主菜单之外，然后使用 javascript 来定位它。但后来我失去了纯 CSS 菜单，它也不再是语义的。如果必须，我可以忍受，但如果可能的话，我想找到一个更好的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T17:21:17.277

你看过这个教程吗？我认为固定高度的导航栏没有任何问题......

[http://www.devinrolsen.com/pure-css-horizo​​ntal-menu/](http://www.devinrolsen.com/pure-css-horizontal-menu/)

哦，该死的 - 垂直菜单？那时这可能无济于事。

# jquery - 使用 jQuery 手动切换手风琴与 nth-child(n)

> ID：15558356
> 
> 赞同：0
> 
> 时间：2013-03-21T21:19:51.057
> 
> 标签：jquery, jquery-selectors, slidetoggle

嗨，我有一个 4 步的任务。该步骤在开始时具有价值，并且每次当用户做出正确的事情时，步骤++。

现在我在手风琴中有一个解释：每个步骤的部分。

所以我希望当用户做出正确的步骤时，它会向上滑动正确的步骤说明，并向下滑动下一个。

这是我到目前为止得到的

```
acco=$('#accordion:nth-child('+this.step+')');

acco.slideToggle(); 
```

不过好像不太对...

你们有什么想法吗？

谢谢！

更新：

功能这么大！但就几句话。我有这样的手风琴

```
<div id="accordion">
<h3>Step1</h3>
<div>La la la</div>

<h3>Step2</h3>
<div>La la la</div>

<h3>Step3</h3>
<div>La la la</div>

<h3>Step4</h3>
<div>La la la</div>

<h3>Step5</h3>
<div>La la la</div>

</div> 
```

例如 Step1 部分现在是开放的。

我想编写一个函数，它将接收多个步骤作为参数并打开所需的解释部分（并关闭所有其他部分）

```
openclose = function(step) {
acco=$('#accordion:nth-child('+step+')');
acco.slideToggle();
} 
```

# javascript - 如何使用“getElementById()”查找元素值？

> ID：15558362
> 
> 赞同：0
> 
> 时间：2013-03-21T21:20:18.823
> 
> 标签：javascript, getelementbyid

```
function demo() {
var y=document.getElementById("count");
if(y="0") {
alert("There's nothing on list");
}
else {
document.getElementById("count").innerHTML="0";
alert("List sent.");
}
}
</script>
<p>List values: <span id="count">0</span></p> 
```

我用过`count++`，所以当有人输入一些东西时，价值会增加。有没有办法检查计数的值并根据它返回警报？我尝试使用不同数量的`=`y 并将 y 与另一个值为 0 的变量进行比较，但没有占上风。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T21:20:50.993

使用读取元素内的内容`innerHTML`

[JSFIDDLE](http://jsfiddle.net/TU726/)

```
var y=document.getElementById("count").innerHTML; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T21:23:30.493

试试这个。您`(y = "0")`需要`(y == "0")`并且您需要使用 innerHTML（您在代码的一部分中使用它，但不是在另一部分中使用）。

```
function demo() {
    var y=document.getElementById("count").innerHTML;
    if(y == "0") {
        alert("There's nothing on list");
    }
    else {
        document.getElementById("count").innerHTML="0";
        alert("List sent.");
    }
}
</script>
<p>List values: <span id="count">0</span></p> 
```

# .htaccess - firefox 和 fontface htaccess

> ID：15558365
> 
> 赞同：0
> 
> 时间：2013-03-21T21:20:29.180
> 
> 标签：.htaccess, firefox, font-face

要使字体在 FF 上工作，我需要制作一个 .htaccess 文件，将其上传到根目录，这应该是对的吗？

所以在一个空白文本文件中我写：

```
<FilesMatch "\.(ttf|otf|eot)$">
<IfModule mod_headers.c>
Header set Access-Control-Allow-Origin "*"
</IfModule>
</FilesMatch> 
```

我保存它，我将它上传到站点根目录并将其重命名为 .htaccess 但它不起作用，无论我做什么.. 最奇怪的是 ff 在某些页面上加载字体但不是全部

是否应该将其他内容添加到 text/htaccess 文件中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T18:18:34.063

如上所述使用 htaccess 并没有解决任何问题，它实际上只是让事情变得更糟。解决方案是使所有路径都相对。

我的意思是，与字体相关的每条路径。

# c# - 如何在 Windows 8 上使用 PlayTo 播放 BackgroundCapableMedia？

> ID：15558367
> 
> 赞同：0
> 
> 时间：2013-03-21T21:20:37.810
> 
> 标签：c#, windows, windows-runtime

我在 StandardStyles.xaml 中有下一个代码：

```
 <Style  x:Key="RootFrameStyle" TargetType="Frame">
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="Frame">
                <Grid>
                    <MediaElement x:Name="MediaPlayer" AudioCategory="BackgroundCapableMedia" />
                    <ContentPresenter />
                </Grid>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style> 
```

在 App.Xaml.cs 中 OnLaunched 中的下一个代码：

```
...
rootFrame.Style = Resources["RootFrameStyle"] as Style;
... 
```

在 MainPage.xaml.cs 代码中：

```
 PlayToManager playToManager = null;
        CoreDispatcher dispatcher = null;

        private void LayoutAwarePage_Loaded_1(object sender, RoutedEventArgs e)
        {
            if (App.Player == null)
            {
                var rootGrid = VisualTreeHelper.GetChild(Window.Current.Content, 0);
                App.Player = (MediaElement)VisualTreeHelper.GetChild(rootGrid, 0);
                App.Player.Source = new Uri("http://myserverlink.com/mymp3file.mp3");

                App.Player.Play();
            }
        }

protected override void OnNavigatedTo(NavigationEventArgs e)
        {
            dispatcher = Window.Current.CoreWindow.Dispatcher;
            playToManager = PlayToManager.GetForCurrentView();
            playToManager.SourceRequested += playToManager_SourceRequested;
        }

        void playToManager_SourceRequested(PlayToManager sender, PlayToSourceRequestedEventArgs args)
        {
            var deferral = args.SourceRequest.GetDeferral();
            var handler = dispatcher.RunAsync(CoreDispatcherPriority.Normal, () =>
                {
                    args.SourceRequest.SetSource(App.Player.PlayToSource);
                    deferral.Complete();
                });
        } 
```

如果我在 Windows 8 中单击设备，则在 PlayTo 的设备列表中没有设备。如果要在 MainPage.xaml 中添加一个 MediaElement，则列表中的设备。但是我需要MediaElement 的Style File，导航到另一个页面没有停止播放音乐。该怎么办？

# ruby - Ruby 应用程序在使用工作正常时崩溃（heroku 日志已发布）

> ID：15558372
> 
> 赞同：0
> 
> 时间：2013-03-21T21:20:51.480
> 
> 标签：ruby, ruby-on-rails-3, heroku

我今天早上能够访问该网站，但突然出现应用程序错误。

我运行了 heroku restart 但这并没有解决任何问题。

有谁知道是什么导致它崩溃？为什么我会看到两个 IP 地址？我知道另一个 IP 属于谁，但我相当肯定他并没有在查看该站点。我是75开头的，另一个是64开头的。

```
C:\Users\Me\Desktop\myapp>heroku logs
2013-03-21T20:52:08+00:00 heroku[router]: at=info method=GET path=/assets/applic
ation-2fc6a05b812117a44c9ad81d589996e4.css host=www.myapp.com fwd="75.xx.xx.xxx"
 dyno=web.1 queue=0 wait=4ms connect=4ms service=7ms status=304 bytes=0
2013-03-21T20:54:26+00:00 app[web.1]: Started GET "/" for 64.xx.xxx.xxx at 2013-
03-21 20:54:26 +0000
2013-03-21T20:54:26+00:00 app[web.1]:
2013-03-21T20:54:26+00:00 app[web.1]:
2013-03-21T20:54:56+00:00 heroku[router]: at=error code=H12 desc="Request timeou
t" method=GET path=/ host=boiling-bastion-xxxx.herokuapp.com fwd="64.xx.xxx.xxx"
 dyno=web.1 queue=0ms wait=12ms connect=9ms service=30003ms status=503 bytes=0
2013-03-21T20:54:56+00:00 app[web.1]: Processing by StaticPagesController#home a
s HTML
2013-03-21T20:54:56+00:00 heroku[router]: at=info method=GET path=/favicon.ico h
ost=boiling-bastion-xxxx.herokuapp.com fwd="64.xx.xxx.xxx" dyno=web.1 queue=0 wa
it=2ms connect=9ms service=8ms status=200 bytes=1150
2013-03-21T21:01:46+00:00 heroku[router]: at=error code=H12 desc="Request timeou
t" method=GET path=/ host=www.myapp.com fwd="75.xx.xx.xxx" dyno=web.1 queue=0ms
wait=0ms connect=2ms service=30000ms status=503 bytes=0
2013-03-21T21:02:20+00:00 heroku[router]: at=error code=H12 desc="Request timeou
t" method=GET path=/ host=www.myapp.com fwd="75.xx.xx.xxx" dyno=web.1 queue=0ms
wait=0ms connect=1ms service=30001ms status=503 bytes=0
2013-03-21T21:03:38+00:00 heroku[router]: at=error code=H12 desc="Request timeou
t" method=GET path=/ host=www.myapp.com fwd="75.xx.xx.xxx" dyno=web.1 queue=0ms
wait=3ms connect=7ms service=30001ms status=503 bytes=0
2013-03-21T21:04:50+00:00 heroku[router]: at=error code=H12 desc="Request timeou
t" method=GET path=/ host=boiling-bastion-xxxx.herokuapp.com fwd="75.xx.xx.xxx"
dyno=web.1 queue=0ms wait=0ms connect=1ms service=30000ms status=503 bytes=0
2013-03-21T21:04:51+00:00 heroku[router]: at=info method=GET path=/favicon.ico h
ost=boiling-bastion-xxxx.herokuapp.com fwd="75.xx.xx.xxx" dyno=web.1 queue=0 wai
t=0ms connect=2ms service=79ms status=200 bytes=1150
2013-03-21T21:05:12+00:00 heroku[web.1]: State changed from up to starting
2013-03-21T21:05:15+00:00 heroku[web.1]: Stopping all processes with SIGTERM
2013-03-21T21:05:16+00:00 app[web.1]:   /usr/local/lib/ruby/1.9.1/webrick/server
.rb:90:in `select'
2013-03-21T21:05:16+00:00 app[web.1]: [2013-03-21 21:05:16] ERROR SignalExceptio
n: SIGTERM
2013-03-21T21:05:16+00:00 heroku[web.1]: Starting process with command `bundle e
xec rails server -p 25301`
2013-03-21T21:05:25+00:00 heroku[web.1]: Stopping remaining processes with SIGKI
LL
2013-03-21T21:05:25+00:00 heroku[web.1]: Error R12 (Exit timeout) -> At least on
e process failed to exit within 10 seconds of SIGTERM
2013-03-21T21:05:27+00:00 heroku[web.1]: Process exited with status 137
2013-03-21T21:05:45+00:00 app[web.1]: DEPRECATION WARNING: You have Rails 2.3-st
yle plugins in vendor/plugins! Support for these plugins will be removed in Rail
s 4.0\. Move them out and bundle them in your Gemfile, or fold them in to your ap
p as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes f
or more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been
-released. (called from <top (required)> at /app/config/environment.rb:5)
2013-03-21T21:05:45+00:00 app[web.1]: DEPRECATION WARNING: You have Rails 2.3-st
yle plugins in vendor/plugins! Support for these plugins will be removed in Rail
s 4.0\. Move them out and bundle them in your Gemfile, or fold them in to your ap
p as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes f
or more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been
-released. (called from <top (required)> at /app/config/environment.rb:5)
2013-03-21T21:05:45+00:00 app[web.1]: DEPRECATION WARNING: You have Rails 2.3-st
yle plugins in vendor/plugins! Support for these plugins will be removed in Rail
s 4.0\. Move them out and bundle them in your Gemfile, or fold them in to your ap
p as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes f
or more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been
-released. (called from <top (required)> at /app/config/environment.rb:5)
2013-03-21T21:05:45+00:00 app[web.1]: DEPRECATION WARNING: You have Rails 2.3-st
yle plugins in vendor/plugins! Support for these plugins will be removed in Rail
s 4.0\. Move them out and bundle them in your Gemfile, or fold them in to your ap
p as lib/myplugin/* and config/initializers/myplugin.rb. See the release notes f
or more on this: http://weblog.rubyonrails.org/2012/1/4/rails-3-2-0-rc2-has-been
-released. (called from <top (required)> at /app/config/environment.rb:5)
2013-03-21T21:05:50+00:00 app[web.1]:         SECURITY WARNING: No secret option
 provided to Rack::Session::Cookie.
2013-03-21T21:05:50+00:00 app[web.1]:         This poses a security threat. It i
s strongly recommended that you
2013-03-21T21:05:50+00:00 app[web.1]:         provide a secret to prevent exploi
ts that may be possible from crafted
2013-03-21T21:05:50+00:00 app[web.1]:         cookies. This will not be supporte
d in future versions of Rack, and
2013-03-21T21:05:50+00:00 app[web.1]:         future versions will even invalida
te your existing user cookies.
2013-03-21T21:05:50+00:00 app[web.1]:
2013-03-21T21:05:50+00:00 app[web.1]:         Called from: /app/vendor/bundle/ru
by/1.9.1/gems/actionpack-3.2.3/lib/action_dispatch/middleware/session/abstract_s
tore.rb:28:in `initialize'.
2013-03-21T21:05:50+00:00 app[web.1]:
2013-03-21T21:05:50+00:00 app[web.1]:   Is the server running on host "ec2-23-21
-105-133.compute-1.amazonaws.com" and accepting
2013-03-21T21:05:50+00:00 app[web.1]: /app/vendor/bundle/ruby/1.9.1/gems/activer
ecord-3.2.3/lib/active_record/connection_adapters/postgresql_adapter.rb:1194:in
`initialize': could not connect to server: Connection refused (PGError)
2013-03-21T21:05:50+00:00 app[web.1]: => Ctrl-C to shutdown server
2013-03-21T21:05:50+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/
activerecord-3.2.3/lib/active_record/connection_adapters/postgresql_adapter.rb:1
194:in `new'
2013-03-21
T21:05:50+00:00 app[web.1]: => Booting WEBrick
2013-03-21T21:05:50+00:00 app[web.1]: => Rails 3.2.3 application starting in pro
duction on http://0.0.0.0:25301
2013-03-21T21:05:50+00:00 app[web.1]:   TCP/IP connections on port 5432?
2013-03-21T21:05:50+00:00 app[web.1]: => Call with -d to detach
2013-03-21T21:05:50+00:00 app[web.1]: Exiting
2013-03-21T21:05:50+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/
activerecord-3.2.3/lib/active_record/connection_adapters/postgresql_adapter.rb:2
8:in `postgresql_connection'
2013-03-21T21:05:50+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/
activerecord-3.2.3/lib/active_record/connection_adapters/postgresql_adapter.rb:1
194:in `connect'
2013-03-21T21:05:50+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/
activerecord-3.2.3/lib/active_record/connection_adapters/postgresql_adapter.rb:2
8:in `new'
2013-03-21T21:05:50+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/
activerecord-3.2.3/lib/active_record/connection_adapters/abstract/connection_poo
l.rb:313:in `checkout_new_connection'
2013-03-21T21:05:50+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/
activerecord-3.2.3/lib/active_record/connection_adapters/abstract/connection_poo
l.rb:303:in `new_connection'
2013-03-21T21:05:50+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/
activerecord-3.2.3/lib/active_record/connection_adapters/abstract/connection_poo
l.rb:237:in `block (2 levels) in checkout'
2013-03-21T21:05:50+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/
activerecord-3.2.3/lib/active_record/connection_adapters/abstract/connection_poo
l.rb:232:in `block in checkout'
2013-03-21T21:05:50+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/
activerecord-3.2.3/lib/active_record/connection_adapters/abstract/connection_poo
l.rb:232:in `loop'
2013-03-21T21:05:50+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/
activerecord-3.2.3/lib/active_record/connection_adapters/abstract/connection_poo
l.rb:229:in `checkout'
2013-03-21T21:05:50+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/
activerecord-3.2.3/lib/active_record/connection_adapters/abstract/connection_poo
l.rb:95:in `connection'
2013-03-21T21:05:50+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/
activerecord-3.2.3/lib/active_record/connection_adapters/abstract/connection_spe
cification.rb:168:in `retrieve_connection'
2013-03-21T21:05:50+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/
activerecord-3.2.3/lib/active_record/connection_adapters/abstract/connection_spe
cification.rb:142:in `connection'
2013-03-21T21:05:50+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/
activerecord-3.2.3/lib/active_record/connection_adapters/postgresql_adapter.rb:3
29:in `initialize'
2013-03-21T21:05:50+00:00 app[web.1]:   from /usr/local/lib/ruby/1.9.1/monitor.r
b:201:in `mon_synchronize'
2013-03-21T21:05:50+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/
activerecord-3.2.3/lib/active_record/connection_adapters/abstract/connection_poo
l.rb:398:in `retrieve_connection'
2013-03-21T21:05:50+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/
activerecord-3.2.3/lib/active_record/model_schema.rb:308:in `clear_cache!'
2013-03-21T21:05:50+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/
activesupport-3.2.3/lib/active_support/callbacks.rb:385:in `_run_prepare_callbac
ks'
2013-03-21T21:05:50+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/
activesupport-3.2.3/lib/active_support/callbacks.rb:81:in `run_callbacks'
2013-03-21T21:05:50+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/
actionpack-3.2.3/lib/action_dispatch/middleware/reloader.rb:74:in `prepare!'
2013-03-21T21:05:50+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/
activerecord-3.2.3/lib/active_record/railtie.rb:91:in `block (2 levels) in <clas
s:Railtie>'
2013-03-21T21:05:50+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/
activesupport-3.2.3/lib/active_support/callbacks.rb:405:in `__run_callback'
2013-03-21T21:05:50+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/
actionpack-3.2.3/lib/action_dispatch/middleware/reloader.rb:48:in `prepare!'
2013-03-21T21:05:50+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/
railties-3.2.3/lib/rails/application/finisher.rb:47:in `block in <module:Finishe
r>'
2013-03-21T21:05:50+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/
railties-3.2.3/lib/rails/initializable.rb:30:in `instance_exec'
2013-03-21T21:05:50+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/
railties-3.2.3/lib/rails/initializable.rb:30:in `run'
2013-03-21T21:05:50+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/
railties-3.2.3/lib/rails/initializable.rb:55:in `block in run_initializers'
2013-03-21T21:05:50+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/
railties-3.2.3/lib/rails/initializable.rb:54:in `each'
2013-03-21T21:05:50+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/
railties-3.2.3/lib/rails/initializable.rb:54:in `run_initializers'
2013-03-21T21:05:50+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/
railties-3.2.3/lib/rails/application.rb:136:in `initialize!'
2013-03-21T21:05:50+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/
railties-3.2.3/lib/rails/railtie/configurable.rb:30:in `method_missing'
2013-03-21T21:05:50+00:00 app[web.1]:   from /app/config/environment.rb:5:in `<t
op (required)>'
2013-03-21T21:05:50+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/
activesupport-3.2.3/lib/active_support/dependencies.rb:236:in `load_dependency'
2013-03-21T21:05:50+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/
activesupport-3.2.3/lib/active_support/dependencies.rb:251:in `require'
2013-03-21T21:05:50+00:00 app[web.1]:   from /app/config.ru:3:in `block in <main
>'
2013-03-21T21:05:50+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/
rack-1.4.5/lib/rack/builder.rb:51:in `instance_eval'
2013-03-21T21:05:50+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/
rack-1.4.5/lib/rack/builder.rb:51:in `initialize'
2013-03-21T21:05:50+00:00 app[web.1]:   from /app/config.ru:in `new'
2013-03-21T21:05:50+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/
rack-1.4.5/lib/rack/builder.rb:40:in `eval'
2013-03-21T21:05:50+00:00 app[web.1]:   from /app/config.ru:in `<main>'
2013-03-21T21:05:50+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/
activesupport-3.2.3/lib/active_support/callbacks.rb:418:in `_run__64769039690635
3246__prepare__2495173404169152159__callbacks'
2013-03-21T21:05:50+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/
activesupport-3.2.3/lib/active_support/dependencies.rb:251:in `require'
2013-03-21T21:05:50+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/
activesupport-3.2.3/lib/active_support/dependencies.rb:251:in `block in require'

2013-03-21T21:05:50+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/
rack-1.4.5/lib/rack/builder.rb:40:in `parse_file'
2013-03-21T21:05:50+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/
rack-1.4.5/lib/rack/server.rb:200:in `app'
2013-03-21T21:05:50+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/
railties-3.2.3/lib/rails/commands/server.rb:46:in `app'
2013-03-21T21:05:50+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/
rack-1.4.5/lib/rack/server.rb:304:in `wrapped_app'
2013-03-21T21:05:50+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/
rack-1.4.5/lib/rack/server.rb:254:in `start'
2013-03-21T21:05:50+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/
railties-3.2.3/lib/rails/commands/server.rb:70:in `start'
2013-03-21T21:05:50+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/
railties-3.2.3/lib/rails/commands.rb:50:in `tap'
2013-03-21T21:05:50+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/
railties-3.2.3/lib/rails/commands.rb:55:in `block in <top (required)>'
2013-03-21T21:05:50+00:00 app[web.1]:   from /app/vendor/bundle/ruby/1.9.1/gems/
railties-3.2.3/lib/rails/commands.rb:50:in `<top (required)>'
2013-03-21T21:05:50+00:00 app[web.1]:   from script/rails:6:in `require'
2013-03-21T21:05:50+00:00 app[web.1]:   from script/rails:6:in `<main>'
2013-03-21T21:05:52+00:00 heroku[web.1]: Process exited with status 1
2013-03-21T21:05:52+00:00 heroku[web.1]: State changed from starting to crashed
2013-03-21T21:05:52+00:00 heroku[web.1]: State changed from crashed to starting
2013-03-21T21:06:37+00:00 heroku[web.1]: State changed from starting to crashed
2013-03-21T21:06:41+00:00 heroku[router]: at=error code=H10 desc="App crashed" m
ethod=GET path=/ host=www.myapp.com fwd="75.xx.xx.xxx" dyno= queue= wait= connec
t= service= status=503 bytes=
2013-03-21T21:09:26+00:00 heroku[router]: at=error code=H10 desc="App crashed" m
ethod=GET path=/ host=www.myapp.com fwd="75.xx.xx.xxx" dyno= queue= wait= connec
t= service= status=503 bytes=
2013-03-21T21:09:26+00:00 heroku[router]: at=error code=H10 desc="App crashed" m
ethod=GET path=/favicon.ico host=www.myapp.com fwd="75.xx.xx.xxx" dyno= queue= w
ait= connect= service= status=503 bytes= 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T15:35:22.973

`ec2-23-21-105-133.compute-1.amazonaws.com`昨晚有硬件问题；已经解决了。

# orchardcms - 如何获取 Orchard.Rules 事件的旧值和新值已发布

> ID：15558374
> 
> 赞同：1
> 
> 时间：2013-03-21T21:20:55.980
> 
> 标签：orchardcms, orchardcms-1.6

我可以使用“已发布”事件创建新规则，并且可以获取给定部分的值，例如 AutoroutePart。但是我如何获得旧值？

我想比较这两个值，如果它发生了变化，我想基于它创建一个新的重写规则。

我的目标是制作一个简单的 URL Tracker 模块，它允许您更改任何内容项的路由，而无需担心 SEO。

这将取决于 Sébastien Ros 的 Orchard.Module.Contrib.RewriteRules

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T17:32:17.910

You can't Published 与旧值无关。您想要的是创建新内容版本时的 Versionned 事件。因为用户可以创建一个新版本并通过两个不同的步骤发布它。如果您仍想在 Published 事件期间访问旧版本，那么您可能需要一个带有自定义令牌的自定义事件。

或者，也许您可​​以提交功能请求，以便我们提供新令牌来访问内容项的先前版本。最新的 {Content.Versions:0} 和最新之前的 {Content.Versions:1} 之类的东西。只是一个想法。这也将解决您最初的问题。

或者更好的是，您可以实现它并执行拉取请求。

# sql - Bash Shell 脚本中的数据库访问

> ID：15558376
> 
> 赞同：0
> 
> 时间：2013-03-21T21:21:01.320
> 
> 标签：sql, linux, bash, shell, unix

我是 shell 脚本世界的新手。

我写了一个 bash shell 脚本。

脚本名称是 new.sh

```
Select T1.date as dateFact,
T2.idmfg as idMfg,
T1.id as userId,
FROM Table1 T1
JOIN 
Table2 T2
ON 
T1.id=T2.id 
WHERE 
T1.date ='${Date}'
T2.idmfg='${idMfg}'; 
```

`Date`在运行 new.sh 时，我想`idMfg`手动输入。例如

```
sh new.sh -d 2013-03-20 -i 201 
```

在哪里，`Date`是`2013-03-20`和`idMfg`是`201`。

我该怎么做？

先感谢您。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T21:24:54.013

```
#!/bin/bash

Date="$1"
idMfg="$2"

mysql<<EOF
SELECT T1.date AS dateFact, T2.idmfg AS idMfg, T1.id AS userId
FROM Table1 T1
JOIN Table2 T2
ON T1.id=T2.id 
WHERE T1.date = "${Date}", T2.idmfg = "${idMfg}";
EOF 
```

用法 ：

```
./new.sh 2013-03-20 201 
```

如果您想要命名开关，请参阅教程：[http](http://wiki.bash-hackers.org/howto/getopts_tutorial) ://wiki.bash-hackers.org/howto/getopts_tutorial示例： http: [//mywiki.wooledge.org/BashFAQ/035](http://mywiki.wooledge.org/BashFAQ/035)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T21:22:46.670

```
 new.sh 2013-03-20 201 
```

在脚本中，第一个（日期）参数是 $1，第二个是 $2。

# vba - 在类文件中引用过程

> ID：15558381
> 
> 赞同：0
> 
> 时间：2013-03-21T21:21:15.000
> 
> 标签：vba

我有一个 Word VBA 应用程序，它处理各种文档以使它们具有一致的外观（它们是从另一个 SW 工具导出的）。每种文档类型都有一个“知道”如何进行转换的类文件。如果添加了新的文档类型，我会创建一个新的类文件，然后必须更新几个过程来添加对新类的引用。我想自动化发现和使用类文件的过程（它们都遵循命名约定）。这是我必须收集对文件的引用：

```
Dim olVBCodeMod As VBComponents
Dim olaClasses() As VBComponent
Dim olVBCodeCmpt As VBComponent

Const slCLASS_NAME_PREFIX = "clsXXXX"

Set olVBCodeMod = Application.VBE.ActiveVBProject.Collection.Item("Normal").VBComponents

ReDim olaClasses(0)
For Each olVBCodeCmpt In olVBCodeMod

    If olVBCodeCmpt.Type = vbext_ct_ClassModule Then

        If InStr(olVBCodeCmpt.Name, slCLASS_NAME_PREFIX) = 1l Then

            Set olaClasses(UBound(olaClasses)) = olVBCodeCmpt
            ReDim Preserve olaClasses(UBound(otaClasses) + 1)
        End If
    End If

Next
ReDim Preserve olaClasses(UBound(otaClasses) - 1) 
```

不幸的是，我没有看到从对类文件的引用到能够在类文件中运行过程的任何方法，即 olaClasses(0).function1？

我的后备方法是创建一个 sub，它返回一个对象数组（作为参数传入），并引用每个类：

```
Set olaClasses(0) = New clsXXXX 
```

这行得通，例如 olaClasses(0).function1 给了我正确的响应，但能够自动发现类文件会很整洁......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T01:33:37.950

谢谢你的评论，我想我现在和你在一起。所以你想要这样的东西：

```
Public Sub FormatActiveDocument()
    Dim className as String
    className = "cls" & [ActiveDocumentDocType or whatever] 
    Dim docClass as Object
    Set docClass = GetClass(className)
    If (obj is Nothing) Then MsgBox("ERROR: Missing VBA class '" & className & "'.")

    docClass.FormatDocument   '<-- MAGIC HAPPENS HERE (via late binding)
End Sub

Private Function GetClass(className as String) as Object    
    Dim classes() as VBComponent
    Set classes = ' [YOUR CODE]     
    For each obj as VBComponent In classes
        If (obj.Name = className) Then
            GetClass = obj
            Exit Function
        End If
    Next
    GetClass = Nothing
End Function 
```

# javascript - D3和JS调用中函数如何传参

> ID：15558387
> 
> 赞同：2
> 
> 时间：2013-03-21T21:21:41.420
> 
> 标签：javascript, d3.js

尝试学习 D3.js 和 JavaScript 等内容 :) 所以这是我在书中看到的代码：

```
<script>
    function draw(data){
      d3.select("body")
              .append("div")
              .attr("class", "chart")
              .selectAll(".bar")
              .data(data.cash)
              .enter()
              .append("div")
              .attr("class", "bar")
              .style("width", function(d){return d.count/100 +"px"})
              .style("outline", "1px solid blue")
              .text(function(d){return Math.round(d.count)});
    }
</script> 
```

我习惯于强类型语言，如 .NET 或 Java，所以这对我来说看起来很奇怪，在这句话中

```
.style("width", function(d){return d.count/100 +"px"}) 
```

它从哪里获得**“d”**的值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T21:24:38.377

在这段代码中，匿名函数被传递**但没有被调用。**`d`参数由最终调用该函数的人传递给该函数——在这种情况下，d3 库将。

这是一个更简单的示例，类似于您问题中的代码片段：

```
doSomething(function (someParameter) {
    alert(someParameter);
}); 
```

这是库内部的类似函数定义：

```
function doSomething(someCallback) {
    var foo = 42;
    someCallback(foo);
} 
```

# sql - 使用 select 语句在表中插入

> ID：15558389
> 
> 赞同：1
> 
> 时间：2013-03-21T21:21:45.330
> 
> 标签：sql, plsql, oracle10g, plsqldeveloper

嗨，我正在使用 select 语句将值插入表中。但是插入没有发生。select语句的结果集中有5行。但是，当我使用选择数据触发插入语句时，不会将其插入表中。

我检查了属性的顺序，一切似乎都是正确的。我还尝试使用“values”关键字在表中插入一行，并在此帮助下插入数据。为什么我的插入不能使用“选择”命令？

请帮助其紧急。

下面是查询

```
insert into schema1.tabletemp
    select distinct 
    a.name as name,
    a.stu_number as rollno,
    c.userid as login_id,
    b.Address as stuAddress,
    b.totalgrades as FinalGrdaes
    ' ' as Misc
from
    Schema1.stu_info a, schema1.address_info b, schema1.logindetails c
where
    a.stu_no = b.record_no and
    a.status in ('Active') and 
   c.last_name=a.stu_lname and 
    c.first_name=a.stu_fname and  
    a.stu_no not in (select distinct student_number from schema1.student_final_records); 
```

此查询正在尝试将学生数据插入 tabletemp。条件是不应该再次插入 student_final_record 表中存在的学生记录。因此，系统中的任何新学生编号，即不存在于 student_final_record 中的学生编号都将插入到 tabletemp 中。

不在不工作的条款中。有什么建议么？？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T19:09:09.137

这里少了一个逗号：

```
 b.totalgrades as FinalGrdaes
    ' ' as Misc 
```

固定版本：

```
 b.totalgrades as FinalGrdaes,
    ' ' as Misc 
```

# html - 翻转 div 的宽度与容器不同

> ID：15558391
> 
> 赞同：1
> 
> 时间：2013-03-21T21:21:47.890
> 
> 标签：html, css, scale, rollover, fluid-images

我在让 Chrome 和 Safari 正确显示容器图像上方的翻转 div 时遇到问题。我所做的有时会起作用，但是在调整页面大小时，您有时会看到翻转 div 和图像容器之间存在 1 或 2 个像素的小间隙。

我在这里做了一个演示：http: [//jsfiddle.net/eJNsS/9/](http://jsfiddle.net/eJNsS/9/)

**截屏** ![在此处输入图像描述](../Images/2c488922e117f969a42ec69d0f270208.png)

**HTML**

```
<div id="related_projects">
    <a href=#  ><div class="thumbnail_image_related_project"><div id="image"><img width="300" height="173" src="http://www.gulfster.com/Lessern/Gulfsterhat.jpg" class="attachment-post-thumbnail wp-post-image"  /></div><h2 class="transparent_font">IMG1</h2></div></a>          
    <a href=#  ><div class="thumbnail_image_related_project"><div id="image"><img width="300" height="173" src="http://www.gulfster.com/Lessern/Gulfsterhat.jpg" class="attachment-post-thumbnail wp-post-image"  /></div><h2 class="transparent_font">IMG2</h2></div></a>          
    <a href=#  ><div class="thumbnail_image_related_project"><div id="image"><img width="300" height="173" src="http://www.gulfster.com/Lessern/Gulfsterhat.jpg" class="attachment-post-thumbnail wp-post-image"  /></div><h2 class="transparent_font">IMG3</h2></div></a>          
    <a href=#  ><div class="thumbnail_image_related_project"><div id="image"><img width="300" height="173" src="http://www.gulfster.com/Lessern/Gulfsterhat.jpg" class="attachment-post-thumbnail wp-post-image" /></div><h2 class="transparent_font">IMG4</h2></div></a>           
    <a href=# ><div class="thumbnail_image_related_project"><div id="image"><img width="300" height="173" src="http://www.gulfster.com/Lessern/Gulfsterhat.jpg" class="attachment-post-thumbnail wp-post-image" /></div><h2 class="transparent_font">IMG5</h2></div></a>            
    <a href=#  ><div class="thumbnail_image_related_project"><div id="image"><img width="300" height="173" src="http://www.gulfster.com/Lessern/Gulfsterhat.jpg" class="attachment-post-thumbnail wp-post-image" /></div><h2 class="transparent_font">IMG6</h2></div></a>           
    <a href=# ><div class="thumbnail_image_related_project"><div id="image"><img width="300" height="173" src="http://www.gulfster.com/Lessern/Gulfsterhat.jpg" class="attachment-post-thumbnail wp-post-image" /></div><h2 class="transparent_font">IMG7</h2></div></a> 
```

CSS

```
#related_projects {
    background-color :#FFFF44;
    margin-bottom: 20px;
    position: relative;
    top: 0;
    left: 0;
    overflow: hidden;
    margin-bottom: 20px;
    display: block;
    margin-top: 2%;
}
#related_projects .thumbnail_image_related_project {
    width: 23%;
    position: relative;
    float: left;
    top: 0;
    left: 0;
    margin-left: 1%;
    margin-right: 1%;
    margin-top: 0%;
    margin-bottom: 2%;
    overflow: hidden;
    line-height: 0;
}
#related_projects img {
    width: 100% !important;
    height: auto;
}
#related_projects p, #categories_container #left p {
    text-align: left;
    color: black;
    font-family: HermL, Arial, sans-serif;
    font-size: 17px;
    line-height: 23px;
    margin-bottom: 20px;
}
#link_description {
    float: left;
    width: 98%;
    margin-left: 1%;
    margin-right: 1%;
}
#link_description #link {
    width: 50%;
    float: right;
    color: black;
    font-family: HermL, Arial, sans-serif;
    font-size: 17px;
    line-height: 23px;
}
#link_description #link a {
    color: #666666;
    font-family: HermL, Arial, sans-serif;
    font-size: 17px;
}
#link_description #link a:hover {
    color: #22B573;
    font-family: HermL, Arial, sans-serif;
    font-size: 17px;
}

/* THUMBNAIL PICTURES
-------------------------------------------------------------- */

.thumbnail_image_related_project .transparent_font {
    line-height: 1.25em;
    position: absolute;
    top: 0;
    left: 0;
    color: black;
    background-color:white; 
    width: 92%;
    padding-right: 3%;
    height: 100%;
    padding-left: 5%;
    opacity:1;
    filter: alpha(opacity=0);
}
.thumbnail_image_related_project h2 {
    padding-top: 30px;
    text-align: left;
    color: black;
    font-family: HermL, Arial, sans-serif;
    font-size: 17px;
    line-height: 23px;
}
h2 {
    margin:0px;
} 
```

**jQuery**

```
$("#slider").hover(
    function(){
        $(".caption").stop().animate({'opacity' : '0.9'}, 200);
    },
    function(){
        $(".caption").stop().animate({'opacity' : '0'}, 100);
    }
);

$(".thumbnail_image_related_project").hover(
    function(){
        $(this).children(".transparent_font").stop()
               .animate({'opacity' : '0.7', 'padding-top': '10px'}, 300);
    },
    function(){
        $(this).children(".transparent_font").stop()
               .animate({'opacity' : '0', 'padding-top': '30px'}, 300);
    }
); 
```

感谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-02T16:24:49.830

我稍微更改了您的 CSS 并移动了一些 CSS 属性以将您的链接容器集中在`#related_projects`. 链接的内容宽度和高度没有您所拥有的 100%。

这段代码对我有用，如果这就是你要找的，请告诉我。不过，您将不得不修正您的利润。

另外，我没有将填充放在 h2 标记上，而是更改了您的标记并将其放在 h2 内的跨度上。

**[更新了 jsFiddle](http://jsfiddle.net/eJNsS/15/)**

编辑：问题已在 Chrome 中修复，但您仍然可以在 Safari 中看到它。

Edit2：更新了 jsFiddle，我在 Chrome 和 Safari 中都看不到问题

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-02T18:26:03.050

## 像素舍入误差

`h2`标签并不总是完全覆盖它下面的图像。黑线是图像中未​​被覆盖的部分。这是由于缩放内容时发生的像素舍入误差。

有 2 个地方会出现明显的像素舍入误差：

1.  `h2`标签的绝对定位。即使使用`top:0; left:0`，这仍然会引入舍入误差。发生这种情况时，会以轻微的偏移量显示，因此它不会与标签`h2`一致地排列。`img`
2.  将标签的总宽度拆分`h2`为 8% 的组合水平填充和 92% 的内部内容。实际上，组合的 % 值在缩放时并不总是等于 100%。

其中任何一个本身都会导致`h2`标签和`img`标签之间出现不一致的舍入错误。并且这两个元素之间的不一致往往在视觉上很明显。

## 解决方案

[更新的演示](http://jsfiddle.net/Matt_Coughlin/85zpF/)

避免这种不一致的关键概念是确保`h2`标签具有与标签完全相同的舍入误差`img`。没有实际的方法可以完全避免这种舍入错误，但只要它们在 2 个元素之间保持一致，在这种情况下它们就不会被注意到。

要修复 #1，请添加`position:relative;`到`img`标签。标签相对定位中的任何舍入误差`img`将与标签绝对定位中的舍入误差一致`h2`（因为它们的定位是相对于同一元素）。这基本上抵消了由绝对定位引起的舍入误差。

**添加了 CSS**

```
#related_projects img {
    position: relative;
    ...
} 
```

要修复 #2，请使用以下方法之一：

*   将标签的宽度更改`h2`为 100% 并添加`box-sizing: border-box;`（以及 -moz- 和 -webkit- 版本）。这[不适用于 IE7](http://caniuse.com/#search=box-sizing)或更早版本。[演示](http://jsfiddle.net/Matt_Coughlin/85zpF/)使用`box-sizing`.
*   从`h2`标签中删除水平填充，并添加一个`text-indent`来模拟左侧填充（如果足够的话）。[演示](http://jsfiddle.net/Matt_Coughlin/wE697/1/)使用`text-indent`.
*   从标签中删除水平填充`h2`，并在标签内部或外部添加一个包装器元素`h2`，外部元素具有`width:%100; position:absolute;`，内部元素具有`padding: 0 3% 0 5%;`。通常，这将通过在`h2`标签内添加一个跨度来完成。

上述任何方法都可以防止发生这种特定的舍入误差。上面提到的[更新演示](http://jsfiddle.net/Matt_Coughlin/85zpF/)使用`box-sizing`. 只要不需要对 IE7 或更早版本的支持，这可能是对#2 最优雅的修复，并且不需要添加额外的 HTML 元素。

**已移除 CSS**

```
.thumbnail_image_related_project .transparent_font {
    width: 92%;
    ...
} 
```

**添加了 CSS**

```
.thumbnail_image_related_project .transparent_font {
    width: 100%;
    -webkit-box-sizing: border-box;
       -moz-box-sizing: border-box;
            box-sizing: border-box;
    ...
} 
```

如果需要对 IE7 或更早版本的支持，`text-indent`但还不够，并且无法编辑静态 HTML，则使用 JavaScript 或 jQuery 注入包装器元素。

# python - 如何检查字符串中的字符是否为字母？（Python）

> ID：15558392
> 
> 赞同：175
> 
> 时间：2013-03-21T21:21:48.843
> 
> 标签：python, string, find

我知道`islower`and `isupper`，但你能检查那个字符是否是一个字母吗？例如：

```
>>> s = 'abcdefg'
>>> s2 = '123abcd'
>>> s3 = 'abcDEFG'
>>> s[0].islower()
True

>>> s2[0].islower()
False

>>> s3[0].islower()
True 
```

`.islower()`除了 do or之外，还有什么方法可以问它是否是一个角色`.isupper()`？

* * *

## 回答 #1

> 赞同：268
> 
> 时间：2013-03-21T21:24:43.883

您可以使用[`str.isalpha()`](https://docs.python.org/3.8/library/stdtypes.html#str.isalpha).

例如：

```
s = 'a123b'

for char in s:
    print(char, char.isalpha()) 
```

输出：

```
a True
1 False
2 False
3 False
b True 
```

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2016-10-19T03:00:24.910

```
str.isalpha() 
```

如果字符串中的所有字符都是字母并且至少有一个字符，则返回 true，否则返回 false。字母字符是在Unicode 字符数据库中定义为“字母”的字符，即一般类别属性为“Lm”、“Lt”、“Lu”、“Ll”或“Lo”之一的字符。请注意，这与 Unicode 标准中定义的“Alphabetic”属性不同。

在 python2.x 中：

```
>>> s = u'a1中文'
>>> for char in s: print char, char.isalpha()
...
a True
1 False
中 True
文 True
>>> s = 'a1中文'
>>> for char in s: print char, char.isalpha()
...
a True
1 False
� False
� False
� False
� False
� False
� False
>>> 
```

在 python3.x 中：

```
>>> s = 'a1中文'
>>> for char in s: print(char, char.isalpha())
...
a True
1 False
中 True
文 True
>>> 
```

此代码工作：

```
>>> def is_alpha(word):
...     try:
...         return word.encode('ascii').isalpha()
...     except:
...         return False
...
>>> is_alpha('中国')
False
>>> is_alpha(u'中国')
False
>>>

>>> a = 'ａ'
>>> b = 'a'
>>> ord(a), ord(b)
(65345, 97)
>>> a.isalpha(), b.isalpha()
(True, True)
>>> is_alpha(a), is_alpha(b)
(False, True)
>>> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-11-20T07:05:51.103

我找到了一个使用函数和基本代码的好方法。这是一个接受字符串并计算大写字母、小写字母以及“其他”的数量的代码。其他被归类为空格、标点符号甚至日文和中文字符。

```
def check(count):

    lowercase = 0
    uppercase = 0
    other = 0

    low = 'a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','v','w','x','y','z'
    upper = 'A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V','W','X','Y','Z'

    for n in count:
        if n in low:
            lowercase += 1
        elif n in upper:
            uppercase += 1
        else:
            other += 1

    print("There are " + str(lowercase) + " lowercase letters.")
    print("There are " + str(uppercase) + " uppercase letters.")
    print("There are " + str(other) + " other elements to this sentence.") 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-07-28T10:16:03.547

`data = "abcdefg hi j 12345"`

```
digits_count = 0
letters_count = 0
others_count = 0

for i in userinput:

    if i.isdigit():
        digits_count += 1 
    elif i.isalpha():
        letters_count += 1
    else:
        others_count += 1

print("Result:")        
print("Letters=", letters_count)
print("Digits=", digits_count) 
```

输出：

```
Please Enter Letters with Numbers:
abcdefg hi j 12345
Result:
Letters = 10
Digits = 5 
```

通过使用`str.isalpha()`，您可以检查它是否是一个字母。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-03-30T11:07:56.157

**这有效：**

```
any(c.isalpha() for c in 'string') 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2017-04-15T08:00:03.937

这有效：

```
word = str(input("Enter string:"))
notChar = 0
isChar = 0
for char in word:
    if not char.isalpha():
        notChar += 1
    else:
        isChar += 1
print(isChar, " were letters; ", notChar, " were not letters.") 
```

# android - 使用 LayoutInflator 创建一个占据整个屏幕的对话框

> ID：15558394
> 
> 赞同：0
> 
> 时间：2013-03-21T21:21:59.353
> 
> 标签：android, android-layout, layout-inflater

我正在为应用程序设计一个“关于”菜单，并在选项菜单中使用以下代码来生成它：

```
 case DIALOG_ABOUT:
        builder = new AlertDialog.Builder(this);
        Context context = getApplicationContext(); 
        LayoutInflater inflater = (LayoutInflater) context.getSystemService(LAYOUT_INFLATER_SERVICE); 
        View layout = inflater.inflate(R.layout.about_dialog, null); 
        builder.setView(layout);

        TextView title = new TextView(this);
        title.setText(R.string.about_title);
        title.setGravity(Gravity.CENTER);
        title.setTextSize(20);
        builder.setCustomTitle(title);
        builder.setPositiveButton("OK", null); 
        dialog = builder.create();
        break; 
```

我为 about 菜单创建了两个不同的视图——水平和垂直视图。

垂直显示时，关于菜单看起来不错，但水平显示时，文本的底部被截断。我正在使用 LayoutInflator 和 View 控件，但对它们的工作原理没有太多了解，因此我假设它们当前正在填充到某些 Android 指定的大小。

如何创建对话框以占据整个屏幕或至少 90%？

**编辑 - 我的布局看起来像这样：**

**垂直布局：**

```
<ImageView
    android:id="@+id/imageView1"
    android:layout_width="120dp"
    android:layout_height="120dp"
    android:src="@drawable/icon" />

<TextView
    android:id="@+id/textView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_marginTop="20dp"
    android:text="@string/game_name"
    android:textAppearance="?android:attr/textAppearanceMedium" />

<TextView
    android:id="@+id/textView2"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_marginTop="5dp"
    android:text="@string/game_description"
    android:textAppearance="?android:attr/textAppearanceMedium" /> 
```

**横向布局：**

```
<ImageView
    android:id="@+id/imageView1"
    android:layout_width="120dp"
    android:layout_height="120dp"
    android:src="@drawable/icon" />

<TextView
    android:id="@+id/textView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_marginTop="20dp"
    android:text="@string/game_name"
    android:textAppearance="?android:attr/textAppearanceMedium" />

<TextView
    android:id="@+id/textView2"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_marginTop="5dp"
    android:text="@string/game_description"
    android:textAppearance="?android:attr/textAppearanceMedium" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T21:26:38.520

您可以在**对话框**中调用以下命令来填充整个空间。

```
dialog.getWindow().setLayout(LayoutParams.FILL_PARENT, LayoutParams.FILL_PARENT); 
```

# php - 如何在 laravel 4 中跨包创建路由集合

> ID：15558395
> 
> 赞同：0
> 
> 时间：2013-03-21T21:22:07.063
> 
> 标签：php, laravel, laravel-4

我在 laravel 4 中编写一个将使用多个包（例如页面/博客/画廊）的 ap，并且在管理区域中，我希望为每个包提供一个基本管理路由的列表，例如：

```
Edit CMS (goes to admin/page/)
Edit Blog (goes to admin/blog)
Edit Gallery (goes to admin/gallery) 
```

我不知道如何做到这一点，我想是否可以在每个包服务提供商的 register 方法中设置一些东西，但我不确定如何做到这一点，然后如何在刀片中将其拉出。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-03T14:49:32.047

在您查看文件中：

```
<a href="{{URL::to('admin/page/')}}">Edit CMS</a> 
```

# javascript - 如何使图像在单击时跟随光标停止/开始

> ID：15558396
> 
> 赞同：2
> 
> 时间：2013-03-21T21:22:07.703
> 
> 标签：javascript, jquery

我对 jquery 还是很陌生，想知道是否有人可以帮助我。我有一个小脚本，可以检测光标的位置并跟随它的图像。如果单击鼠标按钮，我不知道如何让图像停止/开始跟随。任何人都可以帮我指出写作方向吗？

```
<!doctype html>
<head>
<title>Follow</title>
<link href="stylesheets/standard.css" rel="stylesheet">
<script src="http://code.jquery.com/jquery-latest.min.js"></script>
<script>
$(document).ready(function() {
$("html").mousemove(function (e) {
var xPos = e.pageX;
var yPos = e.pageY;
$("#foxlocation").html("The fox is at: " + xPos + ", " + yPos);
$("#imgFollow").offset({left:e.pageX,top:e.pageY});
});
});
</script> 
</head>
<body>
<h1>Test</h1>
<h2 id="foxlocation"></h2>
<img id="imgFollow" width="75px" height="75px" src="images/fox.jpg"></img>
<footer>Test2</footer>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T21:25:49.067

```
$(document).ready(function () {
    var init = true;
    $(document).on('click', function () {
        $(this)[init ? 'on' : 'off']('mousemove', follow);
        init = !init;
    });

    function follow(e) {
        var xPos = e.pageX;
        var yPos = e.pageY;
        $("#foxlocation").html("The fox is at: " + xPos + ", " + yPos);
        $("#imgFollow").offset({
            left: e.pageX,
            top: e.pageY
        });
    }
}); 
```

[**小提琴**](http://jsfiddle.net/8FAfU/)

**编辑：**

从初始化函数开始，最简单的方法是触发一次点击：

```
 $(document).on('click', function () {
        $(this)[init ? 'on' : 'off']('mousemove', follow);
        init = !init;
    }).trigger('click'); 
```

[**小提琴**](http://jsfiddle.net/8FAfU/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T21:28:52.350

这是一个例子：`**[LIVE EXAMPLE](http://jsfiddle.net/UQTY2/31/)**`

使用我的解决方案，图像在页面加载后直接跟随鼠标而无需用户交互

我正在使用 CSS 属性

```
#imgFollow{
    position:absolute;
} 
```

而你的代码除了`.css()`而不是`.offset()`

```
$(document).ready(function () {
    $(window).mousemove(function (e) {
        var xPos = e.pageX;
        var yPos = e.pageY;
        $("#foxlocation").html("The fox is at: " + xPos + ", " + yPos);
        $("#imgFollow").css({
            left: e.pageX,
            top: e.pageY
        });
    });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T21:35:35.517

尝试这个！

```
$(document).ready(function() {
    $("html").mousemove(function (e) {
        follow(e);
    })
    .click( function () {
        var foo = $.data( this, 'events' ).mousemove;
        if(typeof foo = 'function') {
          $(this).off('mousemove');
        } else {
          $(this).mousemove( function (e) {
            follow(e);
          });
        }
    });
});

function follow(e){
  var xPos = e.pageX;
  var yPos = e.pageY;
  $("#foxlocation").html("The fox is at: " + xPos + ", " + yPos);
  $("#imgFollow").offset({left:e.pageX,top:e.pageY});
} 
```

# c++ - 用短路操作替换链式 if

> ID：15558398
> 
> 赞同：5
> 
> 时间：2013-03-21T21:22:12.550
> 
> 标签：c++, c, short-circuiting

这是一个非常微不足道的问题：有四个布尔函数：a()、b()、c() 和 d()。我想继续按顺序调用它们，直到第一个返回`true`。而不是做传统的

```
if(!a()) {
    if(!b()) {
        if(!c()) {
            d();
        }
    }
} 
```

或者

```
if(!a() && !b() && !c()) d(); 
```

我考虑将表达式写为短路评估。

```
(a() || b() || c() || d()); 
```

但我从未见过在 C/C++ 代码中以这种方式完成此测试。我缺少这种方法有什么问题吗？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T21:30:42.180

您编写的代码是有效的。`d()`只有当其他布尔函数返回时才会被评估`false`。

然而，短路评估的可读性较差，并且从维护的角度来看容易出错，因为读者可能无法轻易理解它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T21:29:46.097

它们是等效的，但短路评估解决方案的可读性可能会降低，尤其是在函数名称很长或接受参数的情况下。

# jquery - 多次初始化可排序小部件是否有害？

> ID：15558401
> 
> 赞同：0
> 
> 时间：2013-03-21T21:22:19.473
> 
> 标签：jquery, jquery-ui-sortable

我有一种情况，我需要一个尚未创建的元素，以便在创建时对其进行排序。所以在我的代码中，每次创建新元素时我都会调用可排序小部件。这会产生任何不利影响，还是只是覆盖了小部件的先前版本？

示例代码：

```
function createNewElement(){
    $("#myDiv").append("<li class="newElement"></li>");

    $(".newElement").sortable({
        //various options here
    });
}

$("#clickThis").click(function(){ createNewElement(); }); 
```

如果它是有害的，那么我如何只在创建第一个元素时初始化一次可排序小部件？

**编辑**：

如果可排序小部件已经启动，我会使用`sortable("refresh")`，但因为启动可排序小部件的元素尚不存在，我收到错误消息“您无法在尚未初始化的可排序小部件上调用方法”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T15:59:46.180

我想你正在寻找这个

```
function createNewElement(){
    $("<li class="newElement"></li>")
      .appendTo("#myDiv").sortable({...});
}

$("#clickThis").click(function(){ createNewElement(); }); 
```

# excel - 将 Excel 文本时间转换为值

> ID：15558404
> 
> 赞同：0
> 
> 时间：2013-03-21T21:22:32.490
> 
> 标签：excel, timestamp

我在 excel 列中有这种格式：

00:03:30

它代表 3 分 30 秒。

我需要将其转换为可以添加它们的数字格式。

我可以使用一种特殊的格式吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T22:41:15.640

如果格式是文本，则无法通过更改格式来更改它

使用应用于其中一个单元格的此公式检查数据是否为文本

`=ISNUMBER(A2)`

这可能会给你 FALSE

假设您的数据中没有其他字符，您可以使用“文本到列”进行转换 - 只需选择“时间”列然后使用

`Data > Text to Columns > Finish`

现在您应该能够汇总和/或重新格式化数据

# c++ - C++ getline() 跳过空字符串

> ID：15558405
> 
> 赞同：0
> 
> 时间：2013-03-21T21:22:38.750
> 
> 标签：c++, getline, stringstream

我正在阅读我的 c++ 程序 csv 文件：

```
abc;def;ghi

10;;10 
```

通过此代码：

```
 while(getline(in, str, '\n')){
      stringstream ss;
      while(getline(ss, str, ';')){
         line.add(str);
      }
    } 
```

其中 in 是输入文件，`str`是字符串变量，而 line 是我的集合（如`vector`）。但是`getline`跳过了 csv 文件中的空字符串。

任何人都可以帮助我阅读空字符串吗？

谢谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T21:26:36.253

你从来没有初始化你的流！

尝试这个：

```
#include <string>   // for std::string and std::getline
#include <sstream>  // for std::istringstream

for (std::string jimbob; std::getline(in, jimbob); )
{
    std::istringstream marysue(jimbob);  // !
    for (std::string charlie; std::getline(marysue, charlie, ';'); )
    {
        line.add(charlie);
    }
} 
```

# crash-dumps - 使用 Windbg 进行故障转储

> ID：15558409
> 
> 赞同：1
> 
> 时间：2013-03-21T21:22:46.817
> 
> 标签：crash-dumps

我正在开发一种运行嵌入式 Windows XP 的医疗设备。最近，当我尝试远程访问设备中的某些功能时，设备发生了崩溃。它生成了小型转储文件，我正在尝试分析崩溃的原因。

我对 windbg 完全陌生，并试图分析转储文件。这是命令的输出`!analyze`：

```
FAULTING_IP: 
S14_RecorderManager!HcTask::hc_erase_rec_entry+73 [f:\jenkins_views\jvc_vg2.2_ci_a19545\infrastructure\framework\managers\recordermanager\hc_task.cpp @ 1771]
6d040ef3 8991c4e30000    mov     dword ptr [ecx+0E3C4h],edx

EXCEPTION_RECORD:  ffffffff -- (.exr 0xffffffffffffffff)
ExceptionAddress: 6d040ef3 (S14_RecorderManager!HcTask::hc_erase_rec_entry+0x00000073)
   ExceptionCode: c0000005 (Access violation)
  ExceptionFlags: 00000000
NumberParameters: 2
   Parameter[0]: 00000001
   Parameter[1]: 0000e3c4
Attempt to write to address 0000e3c4

DEFAULT_BUCKET_ID:  INVALID_POINTER_WRITE

PROCESS_NAME:  s14_fwcontainer.exe

ERROR_CODE: (NTSTATUS) 0xc0000005 - The instruction at "0x%08lx" referenced memory at "0x%08lx". The memory could not be "%s".

EXCEPTION_CODE: (NTSTATUS) 0xc0000005 - The instruction at "0x%08lx" referenced memory at "0x%08lx". The memory could not be "%s".

EXCEPTION_PARAMETER1:  00000001

EXCEPTION_PARAMETER2:  0000e3c4

WRITE_ADDRESS:  0000e3c4 

FOLLOWUP_IP: 
S14_RecorderManager!HcTask::hc_erase_rec_entry+73 [f:\jenkins_views\jvc_vg2.2_ci_a19545\infrastructure\framework\managers\recordermanager\hc_task.cpp @ 1771]
6d040ef3 8991c4e30000    mov     dword ptr [ecx+0E3C4h],edx

MOD_LIST: <ANALYSIS/>

NTGLOBALFLAG:  0

FAULTING_THREAD:  00000964

PRIMARY_PROBLEM_CLASS:  INVALID_POINTER_WRITE

BUGCHECK_STR:  APPLICATION_FAULT_INVALID_POINTER_WRITE

LAST_CONTROL_TRANSFER:  from 6d04103c to 6d040ef3

STACK_TEXT:  
0012f684 6d04103c 6d0a3e98 561b3efd 00a2a328 S14_RecorderManager!HcTask::hc_erase_rec_entry+0x73 [f:\jenkins_views\jvc_vg2.2_ci_a19545\infrastructure\framework\managers\recordermanager\hc_task.cpp @ 1771]
0012f6ac 6d043302 6d0a3e98 09ce1ed8 09a86c68 S14_RecorderManager!HcTask::hc_remove_current_rec_entry+0x7c [f:\jenkins_views\jvc_vg2.2_ci_a19545\infrastructure\framework\managers\recordermanager\hc_task.cpp @ 1849]
0012f6c0 6d04a129 09ce1ed8 561b3eb9 00000ecc S14_RecorderManager!HcTask::hc_cancel_remote_recording+0xc2 [f:\jenkins_views\jvc_vg2.2_ci_a19545\infrastructure\framework\managers\recordermanager\hc_task.cpp @ 12599]
0012f804 100953eb 00000ecc 009ec7d8 00000054 S14_RecorderManager!Listen_Port_Svc_Handler::handle_input+0x1a9 [f:\jenkins_views\jvc_vg2.2_ci_a19545\infrastructure\framework\managers\recordermanager\network_task.cpp @ 596]
0012f820 1009525e 09ce1ec0 00000ecc 0012f858 s14ace!ACE_WFMO_Reactor::upcall+0xbb [m:\rafuro00_thirdparty_ms_int\thirdparty\ace\ace\wfmo_reactor.cpp @ 2212]
0012f888 100950c6 00000003 00000e38 00000004 s14ace!ACE_WFMO_Reactor::complex_dispatch_handler+0xce [m:\rafuro00_thirdparty_ms_int\thirdparty\ace\ace\wfmo_reactor.cpp @ 2111]
0012f8a4 10094f7d 00000e38 00000964 00000000 s14ace!ACE_WFMO_Reactor::dispatch_handler+0xe6 [m:\rafuro00_thirdparty_ms_int\thirdparty\ace\ace\wfmo_reactor.cpp @ 2018]
0012f8c8 10094ee6 00000003 00000001 009ec7d8 s14ace!ACE_WFMO_Reactor::dispatch_handles+0x5d [m:\rafuro00_thirdparty_ms_int\thirdparty\ace\ace\wfmo_reactor.cpp @ 1971]
0012f8dc 1004ba33 00000003 a9715800 00000001 s14ace!ACE_WFMO_Reactor::dispatch+0x36 [m:\rafuro00_thirdparty_ms_int\thirdparty\ace\ace\wfmo_reactor.cpp @ 1927]
0012f918 10094bcd 00000003 a9715830 00000001 s14ace!ACE_WFMO_Reactor::safe_dispatch+0x53 [m:\rafuro00_thirdparty_ms_int\thirdparty\ace\ace\wfmo_reactor.inl @ 965]
0012f984 78729882 0012f99c 1004b7f3 00000000 s14ace!ACE_WFMO_Reactor::event_handling+0x12d [m:\rafuro00_thirdparty_ms_int\thirdparty\ace\ace\wfmo_reactor.cpp @ 1721]
0012f99c 1006ba1c 00000000 642f20b0 642f1cc0 mfc100u!AFX_MAINTAIN_STATE2::~AFX_MAINTAIN_STATE2+0x1d
0012f9b4 10010349 1006b9d0 00403d69 ab8d2213 s14ace!ACE_Reactor::run_reactor_event_loop+0x2c [m:\rafuro00_thirdparty_ms_int\thirdparty\ace\ace\reactor.cpp @ 220]
0012f9bc 00403d69 ab8d2213 004065dc 009dd848 s14ace!ACE_Reactor::run_event_loop+0x19 [m:\rafuro00_thirdparty_ms_int\thirdparty\ace\ace\reactor.inl @ 27]
0012fe64 00404633 00000005 009d61c8 ab8d25a3 s14_fwcontainer!S14::FrameworkRuntimeContainer::run+0x1289 [f:\jenkins_views\jvc_vg2.2_ci_a19545\infrastructure\framework\container\frameworkruntime.cpp @ 166]
0012fed8 0040476f 00000005 009d61c8 10057966 s14_fwcontainer!ace_wmain_i+0x163 [f:\jenkins_views\jvc_vg2.2_ci_a19545\infrastructure\framework\container\main.cpp @ 47]
0012fee4 10057966 00000005 009d61c8 a9715fe0 s14_fwcontainer!ACE_Main::run_i+0xf [f:\jenkins_views\jvc_vg2.2_ci_a19545\infrastructure\framework\container\main.cpp @ 38]
0012ff68 00403fce 0012ff7c 00000005 009d61c8 s14ace!ace_os_wmain_i+0xa6 [m:\rafuro00_thirdparty_ms_int\thirdparty\ace\ace\os_main.cpp @ 72]
0012ff7c 00404d7e 00000005 009d61c8 009d6a48 s14_fwcontainer!wmain+0x1e [f:\jenkins_views\jvc_vg2.2_ci_a19545\infrastructure\framework\container\main.cpp @ 38]
0012ffc0 7c817077 00000000 00000000 7ffdd000 s14_fwcontainer!__tmainCRTStartup+0x122 [f:\dd\vctools\crt_bld\self_x86\crt\src\crtexe.c @ 552]
0012fff0 00000000 00404e9f 00000000 00000000 kernel32!BaseProcessStart+0x23

STACK_COMMAND:  ~0s; .ecxr ; kb

SYMBOL_STACK_INDEX:  0

SYMBOL_NAME:  s14_recordermanager!HcTask::hc_erase_rec_entry+73

FOLLOWUP_NAME:  MachineOwner

MODULE_NAME: S14_RecorderManager

IMAGE_NAME:  S14_RecorderManager.dll

DEBUG_FLR_IMAGE_TIMESTAMP:  51424061

FAILURE_BUCKET_ID:  INVALID_POINTER_WRITE_c0000005_S14_RecorderManager.dll!HcTask::hc_erase_rec_entry

BUCKET_ID:  APPLICATION_FAULT_INVALID_POINTER_WRITE_s14_recordermanager!HcTask::hc_erase_rec_entry+73

WATSON_STAGEONE_URL:  http://watson.microsoft.com/StageOne/s14_fwcontainer_exe/0_0_0_0/514232ba/S14_RecorderManager_dll/0_0_0_0/51424061/c0000005/00010ef3.htm?Retriage=1

Followup: MachineOwner 
```

我可以理解`S14_RecorderManager`模块中的代码失败。对此输出的任何输入以进一步进行都会有很大帮助。

提前感谢您的任何建议。

# ios - iOS上的NSThread号？

> ID：15558411
> 
> 赞同：10
> 
> 时间：2013-03-21T21:22:48.240
> 
> 标签：ios, debugging, nsthread

当你打印一个 NSThread 的描述时，你会得到这样的东西：

```
<NSThread: 0x1e511b70>{name = (null), num = 1} 
```

这个“num”是否以某种方式可用？

这仅用于调试，因此不需要清除 Apple 的审批流程。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-21T22:08:02.463

这个数字实际上是 NSThread 的私有实现类中的一个 ivar。类是`_NSThreadInternal`，它的名字是“_private”。在该对象内部，ivar 是`seqNum`.

如果您愿意依赖未记录的密钥路径，则可以直接提取它。这样就可以了（并且在使用 valueForKeyPath 而不是运行时调用时很好地调用 Neilsbot）：

```
@implementation NSThread (GetSequenceNumber)

- (NSInteger)sequenceNumber
{
    return [[self valueForKeyPath:@"private.seqNum"] integerValue];
}

@end 
```

我通过使用运行时调用手动设置该 ivar 然后 NSLogging 线程对其进行了测试。果然，描述反映了变化。这显然没有记录，所以......

# ...使用风险自负。

这是一个有趣的练习，但出于某种原因，事情通常是私密的。交付的代码当然应该避免这样的事情，除非所有其他路线都已彻底用尽。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-21T21:54:30.253

我继续写了@xlc的建议，只是因为：

```
@implementation NSThread (ThreadGetIndex)

-(NSInteger)getThreadNum
{
    NSString * description = [ self description ] ;
    NSArray * keyValuePairs = [ description componentsSeparatedByString:@"," ] ;
    for( NSString * keyValuePair in keyValuePairs )
    {
        NSArray * components = [ keyValuePair componentsSeparatedByString:@"=" ] ;
        NSString * key = components[0] ;
        key = [ key stringByTrimmingCharactersInSet:[ NSCharacterSet whitespaceCharacterSet ] ] ;
        if ( [ key isEqualToString:@"num" ] )
        {
            return [ components[1] integerValue ] ;
        }
    }
    @throw @"couldn't get thread num";
    return -1 ;
}

@end 
```

这回答了从线程中获取“num”的问题——尽管作为欺骗链接的问题可能有助于唯一标识线程的一般问题。

（我喜欢的答案是“生成一个 UUID 并放入线程的线程字典中。）

# javascript - 如何根据路由动态包含几个 AngularJS 部分之一？

> ID：15558412
> 
> 赞同：0
> 
> 时间：2013-03-21T21:22:49.813
> 
> 标签：javascript, angularjs

我正在开发一个具有以下形式的 url 的音乐应用程序`my-app.com/[0-9]{10}`，如下所示：

```
my-app.com/0123456789
my-app.com/1293938388 
```

每一个都是一首歌曲、一个播放列表或一个用户页面，我可以查询后端以确定是哪一个。但是，由于这些 URL 在不查询数据库的情况下是无法区分的，因此我无法正常`$routeProvider.when('route-prefix/:routeArgument')`地为每个 URL 实例化不同的部分。

我希望能够指定一个默认处理程序，该处理程序显示一个微调器并查询数据库，然后根据响应的类型包括多个部分之一和多个控制器之一。

用角度做这件事的正确方法是什么？我应该使用`ng-include`吗？如果不活动的控制器根本不执行，我会喜欢它，这就是为什么使用带有多个`ng-controller`指令的部分的明显解决方案似乎不正确的原因。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T14:56:22.287

正如评论中所讨论的，可以使用[ng-switch根据路由有条件地从 DOM 中添加或删除内容。](http://docs.angularjs.org/api/ng.directive%3angSwitch)（这与 ng-show/ng-hide 形成对比，ng-show/ng-hide 目前只修改 CSS 属性以显示或隐藏始终在 DOM 中的内容）。

# javascript - 如何从 Three.js 画布中保存图像？

> ID：15558418
> 
> 赞同：57
> 
> 时间：2013-03-21T21:23:16.470
> 
> 标签：javascript, three.js

如何从 Three.js 画布中保存图像？

我正在尝试使用 Canvas2Image，但它不喜欢使用 Threejs。因为画布只有在有一个 div 可以将画布对象附加到时才被定义。

[http://ajaxian.com/archives/canvas2image-save-out-your-canvas-data-to-images](http://ajaxian.com/archives/canvas2image-save-out-your-canvas-data-to-images)

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2013-03-22T05:51:55.127

由于 toDataURL 是 canvas html 元素的一种方法，因此也适用于 3d 上下文。但是你必须注意几件事。

1.  确保在初始化 3D 上下文时将`preserveDrawingBuffer`flag 设置为 true，如下所示：

    ```
    var context = canvas.getContext("experimental-webgl", {preserveDrawingBuffer: true}); 
    ```

2.  然后用户`canvas.toDataURL()`获取图像

在threejs中，当渲染器被实例化时，您必须执行以下操作：

```
new THREE.WebGLRenderer({
    preserveDrawingBuffer: true 
}); 
```

另外，请记住，这可能会对性能产生影响。（阅读：[https](https://github.com/mrdoob/three.js/pull/421#issuecomment-1792008) ://github.com/mrdoob/three.js/pull/421#issuecomment-1792008 ）

这**仅适用于 webgl 渲染器**，但对于threejs canvasRenderer，您可以直接执行`renderer.domElement.toDataURL();`，无需初始化参数。

我的 webgl 实验： http: [//jsfiddle.net/TxcTr/3/](http://jsfiddle.net/TxcTr/3/)按“ **p** ”截屏。

[gaitat](https://stackoverflow.com/users/1980846/gaitat)的道具，我只是按照他评论中的链接来获得这个答案。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2014-08-19T18:55:46.237

我阅读了 Dinesh 发布的对话 ( [https://github.com/mrdoob/three.js/pull/421#issuecomment-1792008](https://github.com/mrdoob/three.js/pull/421#issuecomment-1792008) ) 并提出了一个不会减慢您的应用程序的解决方案。

```
 function render() { 
        requestAnimationFrame(render);
        renderer.render(scene, camera);
        if(getImageData == true){
            imgData = renderer.domElement.toDataURL();
            getImageData = false;
        }
    } 
```

有了这个，您可以将 preserveDrawingBuffer-Flag 保留为 false 并仍然从 THREE.js 获取图像。只需将 getImageData 设置为 true 并调用 render() 即可。

```
getImageData = true;
render();
console.debug(imgData); 
```

希望这可以帮助像我这样需要高 fps 的人 :)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2020-11-05T09:00:28.013

使用canvas创建url，然后同样可以下载

```
function createImage(saveAsFileName) {

    var canvas = document.getElementById("canvas");

    var url = canvas.toDataURL();

    var link = document.createElement('a');

    link.setAttribute('href', url);
    link.setAttribute('target', '_blank');
    link.setAttribute('download', saveAsFileName);

    link.click();
} 
```

# vb6 - VB6 框架高度

> ID：15558427
> 
> 赞同：2
> 
> 时间：2013-03-21T21:24:04.227
> 
> 标签：vb6, height, frames

我正在构建一个表单，其中除了滚动条之外的每个控件都包含在一个框架中。滚动条自然会移动框架。

我的表单的高度 x 宽度是 12150 x 15800。框架 - 完全包含在框架内 - 是 18935 x 15285。

尽管我可以在表单的边界内看到整个框架，但它坚持认为它是 6785 twips TALLER。然而，宽度是有道理的——可以合理地说它从左到右窄了 515 缇。

这里发生了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-22T13:52:28.350

我认为这`ScaleHeight`是罪魁祸首。如果将窗体的 ScaleHeight 加倍，则窗体高度内的所有控件也会加倍，而窗体的高度保持不变。因此，表单中的控件的高度可能是 10000 并且 Form = 5000

# asp.net - DataGrid——一列使用与其他列不同的数据

> ID：15558429
> 
> 赞同：0
> 
> 时间：2013-03-21T21:24:15.480
> 
> 标签：asp.net, datagrid, datagridtemplatecolumn

我有 a `DataGrid`I 绑定到 a `DataTable`，`BoundColumn`结果显示三个 s。

我想要第四列连接不同的数据——例如，如果 DataGrid 中的第 3 列是用户 ID，我想用它来查询数据库并检索用户的名字，并显示它在第四列。

有什么推荐的方法吗？我不是 DataGrid 专家，但我应该看看`TemplateColumn`这些方面的东西吗？

我应该将所有这些查询挂钩到哪个事件`OnItemDataBound`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T21:35:42.880

推荐的方法是将用户的名字作为原始查询的一部分返回，并且只使用`BoundColumn`. 如果您需要在显示之前修改数据，那么可以使用 a`TemplateColumn`和`OnItemDataBound`事件来操作数据。

`OnItemDataBound`我不会鼓励运行查询。因此，如果您的网格将一次显示 100 条记录，您想在每次页面加载时运行 100 个额外的查询？如果您实施，这可能会在测试期间在合理范围内运行。但是一旦在负载下，您会发现运行数百个额外的查询并不是一个好主意......它可以通过修复原始查询或根据您的数据库结构和您的复杂性制作非规范化表来解决询问。

当我遇到类似问题时，我采用了非规范化表路线。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T22:50:41.547

在您的 sql 语句中使用连接来获取其他值。

# javascript - jQuery表单插件在请求和响应中传递上下文

> ID：15558430
> 
> 赞同：0
> 
> 时间：2013-03-21T21:24:17.943
> 
> 标签：javascript, jquery, forms

我在对象中使用[jQuery 表单插件](http://www.malsup.com/jquery/form/)，例如：

```
var myObject = {

  el : $('#form'),

  init : function() {

    var options = {
        beforeSubmit: this.submitRequest,
        success: this.submitResponse,
        error: function(xhr, reply, error) {

        }
    };

    this.el.ajaxForm(options);

  },
  submitRequest : function(formData, jqForm, options) {

     //this no longer contains the el attribute or access to any other myObject properties     
     console.log(this);

  },
  submitResponse : function() {

  }

}; 
```

您可以看到这个情况，beforeSubmit 它正在调用`this.submitRequest`，但在该函数中，我无法获取 myObject 的上下文。任何想法如何传递上下文或访问 myObject 的其他属性？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T21:27:31.503

使用`context`ajax的属性。

```
var options = {
    context: this
}; 
```

# javascript - 如何将许多值传递给 Angularjs 指令？

> ID：15558445
> 
> 赞同：13
> 
> 时间：2013-03-21T21:24:47.707
> 
> 标签：javascript, angularjs, angularjs-directive

我正在通过指令创建一个可重用的 html 位。html 将有一些我想从原始范围传递的变量。这很容易通过在指令上声明属性，然后创建隔离范围并捕获它们来完成。问题是，对于更多的变量，是否有更好的方法来做到这一点？我曾想过传入一个像这样的`{firstAttr: $scope.one, secondAttr: $scope.two...}`对象，然后把这个对象拆开来得到每一块。这是第一次工作，但双向数据绑定不起作用（即使使用'='）。

问题是绑定的是对象，而不是对象的每个单独部分。我可以使用指令中的编译函数将每个属性添加到元素或其他东西吗？所以：

```
<mydirective databinding="{one:'first one', two:'second one'}"> 
```

将被翻译成：

```
<mydirective one="first one" two="second one"> 
```

这样，我的数据绑定将通过捕获指令中的属性按预期工作。我将如何完成该设计，或者是否有另一种方法可以完全做到这一点？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-12-17T18:09:08.943

数据绑定指令的想法是一个有趣的想法，但我不会这样做，因为我相信您会遇到指令优先级问题，而且它非常不标准并且会使您的代码难以为未来的程序员遵循。有几种方法可以做到这一点，所以我将讨论我使用过的 3 种不同的解决方案。

**解决方案 1**

如果您只需要一种方式的数据绑定，最简单的解决方案是在使用 {{}} 在其上插入任何简单的范围变量之后，对指令内对象的字符串表示形式使用 angular 的 scope.$eval 函数。字符串表示甚至不必是有效的 JSON，因为您会注意到在下面的示例中我没有在对象键周围包含引号。

在视图中：

```
<div databinding="{one:'first', two:{{scopeVar}}, complex:[1,2, "Hi"]}"></div> 
```

在javascript中：

```
app.directive('databinding', function () {
   return{
      link: function (scope, elm, attrs) {

        console.debug(scope.$eval(attrs['databinding']));

      }
   }
}); 
```

**解决方案 2**

另一种单向数据绑定解决方案是在控制器内部创建一个选项对象，并使用“@”（甚至“=”）将其传递给指令：

在控制器中：

```
$scope.options = {one: "first, two: "second"}; 
```

在视图中：

```
<div databinding="options"></div> 
```

在javascript中：

```
app.directive('databinding', function () {
   return{
      scope: {

        options: "@" //Can also use = here

      },
      link: function (scope, elm, attrs) {

        console.log(scope.options);

      }
   }
}); 
```

**解决方案 3**

如果您确实需要双向数据绑定，那么您很不走运，因为没有优雅的方法可以做到这一点。但是，如果您在市场上寻找 hackish 解决方案，您可以使用与解决方案 2 非常相似但更改选项对象的方法来完成双向数据绑定。

与其声明包含简单原始数据类型（如字符串）的选项对象，不如在选项对象内创建一个虚拟对象，然后在其中声明变量。这样做，控制器中范围变量的更改也将在指令内实现，如超时所示。

控制器：

```
$scope.someScopeVar = "Declared in controller"    

$scope.options = {
  dummy: {
     one: $scope.someScopeVar,
     two: "second"
  }
}

window.setTimeout(function(){

  $scope.someScopeVar = "Changed in controller";

}, 2000) 
```

看法：

```
<div databinding="options"></div> 
```

指示：

```
app.directive('databinding', function () {
   return{
      scope: {
        options: "=" //You need to use = with this solution
      },
      link: function (scope, elm, attrs) {

        console.log(scope.options.dummy.one); //Outputs "Declared in controller"

        window.setTimeout(function(){

           console.log(scope.options.dummy.one) //Outputs "Changed in controller"

        }, 5000)

      }
   }
}); 
```

此方法有效，因为 javascript 通过引用传递对象，而原语被复制。通过将对象嵌套在对象中，可以保留数据绑定。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T21:27:44.037

您可以按如下方式更改指令中的范围

```
.('mydirective ', function(){

   var linker = function(scope, element){
        console.log(scope.one, scope.two);    
   }    
   return {
        link: linker,
        scope: {one:"=", two:"="}
   }    
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-22T04:19:44.367

> 问题是，对于更多的变量，是否有更好的方法来做到这一点？

我不这么认为。正如您已经发现的那样，尝试将它们作为一个对象传递会导致对象被数据绑定，而不是单个部分。

即使您可以使用 $compile 进行工作，其他阅读您的代码的人也不会清楚发生了什么。

另一种选择是不创建范围（`scope: false`，这是指令的默认值），或创建新的子范围（`scope: true`），但要求调用范围必须使用某些范围属性名称才能使用指令。然后您不必指定任何属性。这使得指令的使用更具限制性，但我认为这是您的两个选择：指定多个属性，或需要某些范围属性名称。

# javascript - 如何使用工具提示在 highcharts 中显示不属于系列的数据？

> ID：15558449
> 
> 赞同：-1
> 
> 时间：2013-03-21T21:24:57.067
> 
> 标签：javascript, highcharts, tooltip

我喜欢highcharts的工具提示功能！然而到目前为止，我只能显示从系列到工具提示的数据，而不能显示系列外的数据。我正在考虑添加更多系列，但这些添加的系列最终会出现在图表中，这不是我想要的。谁能帮我？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T14:08:59.767

我使用的方法是为每个系列数据点添加一个附加属性：

```
series:[{
    name:"Example Series",
    data:[{x:1,y:2,tt:"Tooltip for point 1"},{x:2,y:3,tt:"Tooltip for point 2"}]
}] 
```

这些附加属性可用于工具提示格式化程序上下文

```
tooltip: {
    formatter: function() {
        if(typeof this.point.tt != 'undefined'){
            return this.point.tt;
        }else{
            return ''+this.x +' / '+ this.y +'';
        }                    
    }
}, 
```

如果您使用两个元素数组来传递数据，则必须转换为具有 x 和 y 属性的对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T21:29:23.057

您可以在工具提示格式化程序中访问您喜欢的任何数据，包括外部变量（如果它们在范围内）。

[jsFiddle 示例](http://jsfiddle.net/MgV27/)

```
var extraVariable = "This is not part of the chart"

var chart = new Highcharts.Chart({
    tooltip: {
        formatter: function() {
            return 'The value for <b>'+ this.x +
                '</b> is <b>'+ this.y +'</b>  I\'m also showing this: '+extraVariable;
        }
    }, 
```

# jquery - 从所有元素中删除所有处理程序

> ID：15558451
> 
> 赞同：2
> 
> 时间：2013-03-21T21:25:06.057
> 
> 标签：jquery, event-handling

关于如何从元素中删除所有“特定”处理程序（例如 onclick），或从元素中清除所有事件等有很多问题。

1.  [如何删除 Jquery 中的所有 Click 事件处理程序](https://stackoverflow.com/questions/825112/how-to-remove-all-click-event-handlers-in-jquery)
2.  [Jquery：如何释放所有事件处理程序，dom更改？](https://stackoverflow.com/questions/3869088/jquery-how-to-release-all-event-handlers-dom-changes)

这个问题有点宽泛。我们在 IE7 和 IE8 下的 asp.net 站点中面临巨大的内存泄漏，而缩小这些泄漏的调整之一是取消绑定页面上所有元素的所有事件。基本上是这样的：

```
$('*').off(); 
```

现在，我们正在努力提高应用程序的性能，毫不奇怪，这条特殊的线路是热点之一。

所以，问题是：有没有办法更有效地实现相同的结果（从文档中的所有元素中显式删除所有处理程序）？

禁止选项：

*   “重新加载页面” - 以这种方式保留内存泄漏。
*   “每次你附加一个处理程序时，你都会将它存储在一个数组中”——这样的地方太多了

我在想的是使用一些 jQuery 内部（甚至可能是非公共 API）来利用附加处理程序的元素检测。但这略高于我目前使用 jQuery 的能力。如果有帮助，我们的目标是 jQuery 1.7.1。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T02:21:55.267

我想你可以创建类似[hasEvent](https://stackoverflow.com/questions/10840800/jquery-selector-for-all-click-handlers?lq=1)的东西来检测事件，但我怀疑你的问题更多的是遍历 dom，而不是调用`.off()`没有事件的元素。您可以对其进行测试以确保。

根据您的应用程序的性质，您可能会通过调整选择器以更精确地定位您的元素来获得一些性能。
见：[http ://www.artzstudio.com/2009/04/jquery-performance-rules/](http://www.artzstudio.com/2009/04/jquery-performance-rules/)

另一个想法是[覆盖](https://stackoverflow.com/questions/4536788/override-jquery-functions)添加事件处理程序的 jQuery 函数，以便您可以填充数组以供以后使用。它不需要修改您的数百个文件，但仍然可以让您更直接地访问以供以后操作。

# c# - 在 C# 中进行游戏开发需要什么？

> ID：15558455
> 
> 赞同：5
> 
> 时间：2013-03-21T21:25:15.853
> 
> 标签：c#, game-engine

我已经阅读了很多关于 XNA 框架即将消失并且微软不再公开支持它的信息。我想知道是否有任何类似的技术可用，记住我不想为创建跨平台独立游戏支付很多美元。我知道 XNA 只支持 Microsoft 设备，并且已经有许多可用的开源游戏引擎，例如[Torque](http://www.garagegames.com/)、[NeoAxis](http://www.neoaxis.com/)等。我主要是在寻找一个简化的游戏引擎，我可以在其中使用 c# 进行编码。我不需要复杂的 3D 渲染组件，也不需要过多担心内存管理。只是想获得一个简化的工具集作为初学者。任何建议将不胜感激..

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-21T21:28:40.487

Unity3D 是您问题的答案。尽管名称中有 3D，但您可以在 Unity 中进行几乎任何类型的游戏。它还支持其他语言的游戏脚本，如 JS。有很多例子，很大的支持，并且越来越受欢迎。我相信他们也有他们的引擎的免费版本。[www.unity3d.com](http://www.unity3d.com)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-21T22:16:06.470

如果您想要类似于 Microsoft 的 XNA 的东西，您可以随时尝试[MonoGame](http://monogame.codeplex.com/)，它是 XNA 4 的开源实现，包括对 Windows、Windows Metro、Mac OSX、Linux、Android（使用 MonoDroid）和 iOS（使用 Xamarin.iOS/单触）

# c# - 每个提供的属性都带有“OR”子句的通用表达式树

> ID：15558456
> 
> 赞同：5
> 
> 时间：2013-03-21T21:25:22.953
> 
> 标签：c#, generics, lambda, expression-trees

我为 IQueryable 创建了一个通用搜索扩展方法，使您能够搜索单个属性以查看其中是否包含搜索词。

[http://jnye.co/Posts/6/c%23-generic-search-extension-method-for-iqueryable](http://jnye.co/Posts/6/c%23-generic-search-extension-method-for-iqueryable)

我现在想让用户选择多个属性以在每个属性中进行搜索，匹配是否***有任何***属性包含文本。

**编码：**

用户输入以下代码来执行此搜索：

```
string searchTerm = "Essex";
context.Clubs.Search(searchTerm, club => club.Name, club => club.County)

//Note: If possible I would rather something closer to the following syntax...
context.Clubs.Search(club => new[]{ club.Name, club.County}, searchTerm);
// ... or, even better, something similar to this...
context.Clubs.Search(club => new { club.Name, club.County}, searchTerm); 
```

这将返回任何名称中带有“Essex”或县的高尔夫球杆。

```
 public static IQueryable<TSource> Search<TSource>(this IQueryable<TSource> source, string searchTerm, params Expression<Func<TSource, string>>[] stringProperties)
    {
        if (String.IsNullOrEmpty(searchTerm))
        {
            return source;
        }

        // The lamda I would like to reproduce:
        // source.Where(x => x.[property1].Contains(searchTerm)
        //                || x.[property2].Contains(searchTerm)
        //                || x.[property3].Contains(searchTerm)...)

        //Create expression to represent x.[property1].Contains(searchTerm)
        var searchTermExpression = Expression.Constant(searchTerm);

        //Build parameters
        var parameters = stringProperties.SelectMany(prop => prop.Parameters);
        Expression orExpression = null;

        //Build a contains expression for each property
        foreach (var stringProperty in stringProperties)
        {
            var checkContainsExpression = Expression.Call(stringProperty.Body, typeof(string).GetMethod("Contains"), searchTermExpression);
            if (orExpression == null)
            {
                orExpression = checkContainsExpression;
            }

            //Build or expression for each property
            orExpression = Expression.OrElse(orExpression, checkContainsExpression);
        }

        var methodCallExpression = Expression.Call(typeof(Queryable),
                                                   "Where",
                                                   new Type[] { source.ElementType },
                                                   source.Expression,
                                                   Expression.Lambda<Func<TSource, bool>>(orExpression, parameters));

        return source.Provider.CreateQuery<TSource>(methodCallExpression);
    } 
```

**错误**

![错误](../Images/7907120c0cda14ab8fc3d7be56140f32.png)

如果我将提供的参数数量更改为 1：

```
Expression.Lambda<Func<TSource, bool>>(orExpression, parameters.First())); 
```

我收到一个新错误：

![第二个错误](../Images/879097bbf6b84ce978464e1b5cc92ed3.png)

**更新**

我已经写[了一篇关于这个问题中讨论的工作的帖子](http://www.ninjanye.co.uk/2013/04/generic-iqueryable-or-search-on.html)。 [也可以在 GitHub 上查看](https://github.com/ninjanye/SearchExtensions)。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-22T07:26:18.060

开始了; 你非常接近 - 正如我在评论中指出的那样，这里的关键部分是用来`ExpressionVisitor`根据你想要保留的单个参数来重写树：

```
using System;
using System.Linq;
using System.Linq.Expressions;
static class Program
{
    static void Main()
    {
        var data = new[] { new Foo { A = "x1", B = "y1", C = "y1" }, new Foo { A = "y2", B = "y2", C = "y2" },
            new Foo { A = "y3", B = "y3", C = "x3" } }.AsQueryable();

        var result = data.Search("x", x => x.A, x => x.B, x => x.C);

        foreach (var row in result)
        {
            Console.WriteLine("{0}, {1}, {2}", row.A, row.B, row.C);
        }
    }
    class Foo
    {
        public string A { get; set; }
        public string B { get; set; }
        public string C { get; set; }
    }
    public class SwapVisitor : ExpressionVisitor
    {
        private readonly Expression from, to;
        public SwapVisitor(Expression from, Expression to)
        {
            this.from = from;
            this.to = to;
        }
        public override Expression Visit(Expression node)
        {
            return node == from ? to : base.Visit(node);
        }
        public static Expression Swap(Expression body, Expression from, Expression to)
        {
            return new SwapVisitor(from, to).Visit(body);
        }
    }
    public static IQueryable<TSource> Search<TSource>(this IQueryable<TSource> source, string searchTerm, params Expression<Func<TSource, string>>[] stringProperties)
    {
        if (String.IsNullOrEmpty(searchTerm))
        {
            return source;
        }
        if (stringProperties.Length == 0) return source.Where(x => false);

        // The lamda I would like to reproduce:
        // source.Where(x => x.[property1].Contains(searchTerm)
        //                || x.[property2].Contains(searchTerm)
        //                || x.[property3].Contains(searchTerm)...)

        //Create expression to represent x.[property1].Contains(searchTerm)
        var searchTermExpression = Expression.Constant(searchTerm);

        var param = stringProperties[0].Parameters.Single();
        Expression orExpression = null;

        //Build a contains expression for each property
        foreach (var stringProperty in stringProperties)
        {
            // re-write the property using the param we want to keep
            var body = SwapVisitor.Swap(stringProperty.Body, stringProperty.Parameters.Single(), param);

            var checkContainsExpression = Expression.Call(
                body, typeof(string).GetMethod("Contains"), searchTermExpression);

            if (orExpression == null)
            {
                orExpression = checkContainsExpression;
            }
            else
            {   // compose
                orExpression = Expression.OrElse(orExpression, checkContainsExpression);
            }
        }

        var lambda = Expression.Lambda<Func<TSource, bool>>(orExpression, param);
        return source.Where(lambda);
    }
} 
```

# c# - 在表单之间传递 arrayList

> ID：15558457
> 
> 赞同：0
> 
> 时间：2013-03-21T21:25:24.970
> 
> 标签：c#, winforms

我首先要说的是，在表单之间传递数组时，我对这个概念非常陌生。

目前我有以下情况：

1.  用户单击一个按钮，该按钮会生成一个显示用户详细信息的网格视图

2.  用户可以单击一个单元格，然后将数据添加到文本框和数组列表中

3.  然后用户单击一个按钮返回到前一个表单，在该表单中访问数组列表元素并在第一个表单的文本框中显示。

目前我已经为我的第一个表单（Form1）创建了一个新的构造器，它应该从第二个表单设置声明的 arrayList。

目前我没有收到任何错误，但只是生成了一个空白表格。以下屏幕截图将显示情况：

用户单击第一个表单的“添加”按钮 - Form1

![在此处输入图像描述](../Images/ef6df7afc03e08b87b6d9b53e886bceb.png)

然后用户选择将地址放入文本框中的“电子邮件”单元格。此电子邮件地址也会添加到后台代码中的列表数组中。

![在此处输入图像描述](../Images/5248849aeca6f724dd04c82b5ad69a7e.png)

单击“添加联系人”时，**应显示第一个表单（第一张图片中的那个），但会生成一个新表单：**

![在此处输入图像描述](../Images/2a002900e3b0a8799afc5838637e660e.png)

这是代码。我目前认为这个问题出在我的 Form1 类中的第二个构造函数上，该构造函数用于设置返回的数组 List：

```
 List<string> myCollection = new List<string>();

   private void dataGridView1_CellContentClick(object sender, DataGridViewCellEventArgs e)
    {

        string add = dataGridView1.CurrentRow.Cells[3].Value.ToString();

        myCollection.Add(add);

        txtCCAdd.Text += add + ", ";

    }

 private void btnSetCC_Click(object sender, EventArgs e)
    {
        Form1 form = new Form1(myCollection);
        form.Show();
    } 
```

用于设置 List 的 Form1 构造函数：

```
 string attachment;
    List<string> myCollection = new List<string>();

    public Form1()
    {
        InitializeComponent();

    }

    **** Second constructor used to set the List array ****
    public Form1(List<string> a)
    {
        myCollection = a;
    } 
```

希望有人能告诉我哪里出错了！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T21:28:32.240

您从未实际初始化任何控件，因此从未实际创建表单。利用：

```
public Form1(List<string> a)
{
    InitializeComponent();
    myCollection = a;
} 
```

或者

```
public Form1(List<string> a)
{
    Form1();
    myCollection = a;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T21:31:43.840

无需传递列表并创建新的*Form1*，只需从第二种形式返回选定的值：

在*Form1*中（当您需要显示*Form2*时）：

```
using(Form2 form2 = new Form2())
{
   if (form2.ShowDialog() != DialogResult.OK)
      return;

   myCollection.Add(form2.SelectedValue); // add value to list here
} 
```

在*Form2*中：

```
public string SelectedValue { get; private set; }

void dataGridView1_CellContentClick(object sender, DataGridViewCellEventArgs e)
{
    SelectedValue = dataGridView1.CurrentRow.Cells[3].Value.ToString();
}

private void btnSetCC_Click(object sender, EventArgs e)
{
    DialogResult = DialogResult.OK;
} 
```

即使您想从*Form2*返回几个选定的值，然后使用本地值列表，并将该列表返回到*Form1*。*Form2*不应该知道您将如何使用这些值。想想`FileOpenDialog`。它只返回选定的文件名，这是该对话框的责任。您不需要传递一些列表或对象来填充`FileOpenDialog`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T21:30:09.960

在第二个构造函数中调用 InitializeComponent。

# php - 权限：按位操作还是多对多子表？

> ID：15558460
> 
> 赞同：5
> 
> 时间：2013-03-21T21:25:40.283
> 
> 标签：php, mysql, permissions, bit-manipulation

我正在尝试了解使用权限的最佳方式，据我所知，有两个主要选项。

第一个选项是使用按位运算，为此我将使用以下数据库结构：

**用户**

```
user_id | user_permission
---------------------
1       | 15
2       | 1 
```

**权限**

```
permission_id | permission_name
-----------------------
1             | Read
2             | Write
4             | Execute
8             | Delete 
```

然后检查用户是否具有权限，我将使用以下操作：

```
$user_permission & $permission_id 
```

我看到的主要好处是：

1.  设置、获取和验证权限很简单
2.  更少的存储空间（没有子数据库；每个用户权限没有额外的行）

我看到的主要缺点是：

1.  列出用户的权限稍微复杂一些
2.  不能使用外键约束
3.  有限的权限（如果使用 64 `BIGINT`）

第二种选择是使用多对多子表，为此我将使用以下数据库结构：

**用户**

```
user_id
-------
1      
2 
```

**权限**

```
permission_id | permission_name
-----------------------
1             | Read
2             | Write
3             | Execute
4             | Delete 
```

**用户权限**

```
user_id | permission_id
-----------------------
1       | 1
1       | 2
1       | 3
1       | 4
2       | 1 
```

然后为了检查用户是否有权限，我将使用该操作（ s`$user_permission`数组在哪里`permission_id`）：

```
in_array($permission_id, $user_permission); 
```

我看到的主要好处是：

1.  可以使用外键约束
2.  简单列出用户的权限
3.  允许更多的权限

我看到的主要缺点是：

1.  更大的存储空间（子数据库；每个用户权限的附加行）
2.  设置和获取权限稍微复杂一些

**问题**

其中哪一个是更好的选择？我看到了每个人的优点和缺点，不确定哪个更合适。尽管我知道上下文可能起作用；那么在哪些情况下按位运算会更好，在哪些情况下多对多子表会更好？还是有我不知道的第三种选择？

我目前更倾向于使用多对多表来获得外键约束和更多权限可能性的好处，但我想知道我是否遗漏了其他东西；按位操作权限似乎很普遍，所以我认为使用它们是有充分理由的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-02-27T10:00:06.767

我认为按位运算符是实现用户权限的最佳方式。在这里，我将展示如何使用 Mysql 实现它。

以下是带有一些示例数据的示例表：

**表 1**：存储权限名称的权限表，有点像 1,2,4,8..etc（2 的倍数）

```
CREATE TABLE IF NOT EXISTS `permission` (
  `bit` int(11) NOT NULL,
  `name` varchar(50) NOT NULL,
  PRIMARY KEY (`bit`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1; 
```

将一些示例数据插入表中。

```
INSERT INTO `permission` (`bit`, `name`) VALUES
(1, 'User-Add'),
(2, 'User-Edit'),
(4, 'User-Delete'),
(8, 'User-View'),
(16, 'Blog-Add'),
(32, 'Blog-Edit'),
(64, 'Blog-Delete'),
(128, 'Blog-View'); 
```

**表 2**：用于存储用户 ID、名称和角色的用户表。角色将被计算为权限的总和。
示例：
如果用户 'Ketan' 具有 'User-Add' (bit=1) 和 'Blog-Delete' (bit-64) 的权限，则角色将为 65 (1+64)。
如果用户“Mehata”拥有“Blog-View”（bit=128）和“User-Delete”（bit-4）的权限，那么角色将为 132（128+4）。

```
CREATE TABLE IF NOT EXISTS `user` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `name` varchar(50) NOT NULL,
  `role` int(11) NOT NULL,
  `created_date` datetime NOT NULL
  PRIMARY KEY (`id`)
) ENGINE=InnoDB  DEFAULT CHARSET=latin1; 
```

样本数据-

```
INSERT INTO `user` (`id`, `name`, `role`, `created_date`)
   VALUES (NULL, 'Ketan', '65', '2013-01-09 00:00:00'),
   (NULL, 'Mehata', '132', '2013-01-09 00:00:00'); 
```

加载用户权限 登录后如果我们想加载用户权限，我们可以在下面查询来获取权限：

```
SELECT permission.bit,permission.name  
   FROM user LEFT JOIN permission ON user.role & permission.bit
 WHERE user.id = 1 
```

这里 user.role "&" permission.bit 是一个按位运算符，它将输出为 -

```
User-Add - 1
Blog-Delete - 64 
```

如果我们要检查天气，特定用户是否具有用户编辑权限-

```
 SELECT * FROM `user` 
     WHERE role & (select bit from permission where name='user-edit') 
```

输出 = 无行。

您还可以查看：http: [//goo.gl/ATnj6j](http://goo.gl/ATnj6j)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T21:31:06.740

我不会使用按位运算解决方案。除非你真的很拥挤，否则将它分解成它自己的表和映射表不会花费那么多磁盘。不是您的人更容易理解，并且您可以通过这种方式更轻松地实施 FK 关系。此外，正如您所提到的，权限的数量几乎可以无限制地增长。根据您索引表的方式，诸如“向我显示所有具有读取权限的用户”之类的查询似乎执行起来更快并且更容易理解（我意识到这是主观的）。

# php - 在 MySQL 中将表从一个数据库移动到另一个数据库

> ID：15558461
> 
> 赞同：75
> 
> 时间：2013-03-21T21:25:43.110
> 
> 标签：php, mysql

如何在不使用 phpMyAdmin 的情况下将表从一个数据库移动到另一个数据库？如果可以通过PHP实现就更好了。

* * *

## 回答 #1

> 赞同：173
> 
> 时间：2013-03-21T21:40:53.823

`ALTER TABLE ..`可用于将表从一个数据库移动到另一个数据库：

```
alter table my_old_db.mytable rename my_new_db.mytable 
```

警告：正如你所问，**这是一个移动，而不是复制**到新数据库！

但是您将保留表数据（如果它们适用于您的情况，则不会保留完整性约束）

关于php，php能够运行sql命令，所以不会有问题。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-03-21T21:28:22.450

**整个数据库（所有表）：**

```
mysqldump -u root databasename > dump.sql
mysql -u root databasename < dump.sql 
```

**一张表：**

```
mysqldump -u root -p yourpass dbname tablename | mysql -u root -p pass secondDB 
```

**PHP：**

运行 PHP **SELECT FROM SOURCE-DB** **TABLE**并运行**INSERT INTO Table** IN **TARGET-DB**

# c# - 正确更新 XmlDocument 中的 XmlNode

> ID：15558463
> 
> 赞同：0
> 
> 时间：2013-03-21T21:25:58.253
> 
> 标签：c#, xml, .net-2.0, xmldocument

我整天都在与 XmlDocuments 进行战争。他们正在获胜。我正在.net 2.0 中构建一个组件，因此被迫使用它。请看看这个并帮助我恢复理智：

```
 private static string UpdateMeterAccessXml(string meterAccess, int childToUpdate, string field, string value)
    {
        var doc = new XmlDocument();
        doc.LoadXml(meterAccess);
        var xpath = String.Format("/items/item[{0}]/{1}", childToUpdate, field);           
        var modNode = doc.SelectSingleNode(xpath);

        modNode.InnerText = value;

        doc.ReplaceChild(modNode, doc.SelectSingleNode(xpath));
        return doc.OuterXml;
    } 
```

doc.ReplaceChild 产生一个 ArgumentException（“要删除的节点不是该节点的子节点。”）

我认为由于 XmlDocument 是一种引用类型，我不必尝试换出节点，但如果我只是更新我想要的节点的 InnerText，则 doc.OuterXml 不会反映更改。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T03:37:56.780

我认为错误消息很清楚，doc对象表示整个文档，根据您的xpath，“doc.SelectSingleNode(xpath)”不是doc的孩子，而是后代，所以它抛出了异常。
您可以更新节点的 InnerText，doc.OuterXml 将反映更改。以下代码对我来说很好：

```
XmlDocument doc = new XmlDocument();
doc.LoadXml("<book genre='novel' ISBN='1-861001-57-5'>" +
           "<title>Pride And Prejudice</title>" +
           "</book>");

string xPath = "/book/title";
XmlNode node = doc.SelectSingleNode(xPath);
node.InnerText = "new title";
Console.WriteLine(doc.OuterXml); //it's changed 
```

# php - 如何在 Codeigniter 中使视图“可移植”？

> ID：15558464
> 
> 赞同：0
> 
> 时间：2013-03-21T21:25:59.813
> 
> 标签：php, codeigniter

我的索引中有一个我想包含搜索表单的地方。问题是这个“搜索表单”需要位于网站的不同部分，所以我所做的是为搜索表单视图创建一个控制器和模型。现在我的问题是我不知道如何将它包含在我的索引中（或网站的其他部分）。

我已经知道从视图加载控制器违反了 MVC 模式，所以我不再寻找它。我做了一些研究，最常见的答案似乎是“重用模型”，但我不确定这意味着什么。我应该复制搜索表单控制器中的功能并将它们包含在索引控制器中吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T13:19:07.060

首先，我认为你应该看看模板方法，如果你还没有使用它。

[http://williamsconcepts.com/ci/codeigniter/libraries/template/reference.html](http://williamsconcepts.com/ci/codeigniter/libraries/template/reference.html)

这使您能够制作自定义模板，并且您可以在控制器中决定是否要在其中使用搜索表单。

如果您希望在视图本身中执行此操作，您可以尝试在您的视图中使用它

```
include(searchform.php) 
```

# ruby - 更改 ruby 方法上下文/使用 instance_exec 调用方法

> ID：15558472
> 
> 赞同：5
> 
> 时间：2013-03-21T21:26:39.093
> 
> 标签：ruby, methods, module, scope, metaprogramming

首先，对于简短版本：

方法定义不只是一个块吗？为什么我不能这样做：

```
obj.instance_exec(&other_obj.method(:my_method)) 
```

目标是在单独类的实例的上下文中运行某些模块方法？该方法被调用，但它似乎没有在“obj”的上下文中执行，尽管调用了“instance_exec”。

我能弄清楚如何做到这一点的唯一方法是将'my_method'的所有代码包装在一个proc中，然后以以下方式调用：

```
obj.instance_eval(&other_obj.my_method) 
```

但我想避免将我所有的模块方法封装在 procs 中。

* * *

现在，对于长版本：

我正在尝试创建一个模块化的外部提供程序系统，对于任何给定的类/方法（通常是控制器方法），我可以为给定的提供程序（例如 facebook）调用相应的方法。

由于可能有多个提供者，提供者方法需要命名空间，但不是简单地包含一堆方法，例如“facebook_invitation_create”，我希望我的 InvitationsController 实例有一个包含创建方法的 facebook 成员 -例如

```
class InvitationsController < ApplicationController
  def create
    ...
    # e.g. self.facebook.create
    self.send(params[:provider]).create
    ...
  end
end 
```

此外，我希望提供者方法不仅可以像控制器本身的一部分一样运行——这意味着它们应该可以访问控制器实例变量、参数、会话等内容——而且还可以（大部分）编写就好像它们是控制器本身的一部分一样——这意味着由于模块化而没有任何复杂的附加代码。

我在下面创建了一个简化的示例，其中 MyClass 有一个 greet 方法，如果使用有效的提供者名称（在本例中为：facebook）调用该方法，则会改为调用该提供者的 greet 方法。反过来，提供者 greet 方法访问包含类的 message 方法，就好像它是类本身的一部分一样。

```
module Providers
  def facebook
    @facebook ||= FacebookProvider
  end

  module FacebookProvider
    class << self
      def greet
        proc {
          "#{message} from facebook!"
        }
      end
    end
  end
end

class MyClass
  include Providers
  attr_accessor :message

  def initialize(message="hello")
    self.message = message
  end

  def greet(provider=nil)
    (provider.nil? or !self.respond_to?(provider)) ? message : instance_exec(&self.send(provider).greet)
  end
end 
```

这实际上完成了我之前所说的几乎所有事情，但是我挂断了我的提供程序函数需要封装在 procs 中的事实。我想也许我可以简单地在方法上调用 instance_exec （在删除 proc 封装之后）：

```
instance_exec(&self.send(provider).method(:greet)) 
```

...但是似乎 instance_exec 被忽略了，因为我收到了错误：

```
NameError: undefined local variable or method `message' for Providers::FacebookProvider:Module 
```

有没有办法在定义的方法上调用 instance_exec ？

（我也愿意接受有关如何更好地实施这一点的建议......）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2015-04-15T21:12:12.483

我认为这比您预期的要简单（而且我意识到我的回答是在您询问后 2 年）

您可以使用模块中的实例方法并将它们绑定到任何对象。

```
module Providers
  def facebook
    @facebook ||= FacebookProvider
  end

  module FacebookProvider
    def greet
      "#{message} from facebook!"
    end
  end
end

class MyClass
  include Providers
  attr_accessor :message

  def initialize(message="hello")
    self.message = message
  end

  def greet(provider=nil)
    if provider
      provider.instance_method(:greet).bind(self).call
    else
      message
    end
  end
end 
```

如果您`provider`是一个模块，您可以`instance_method`创建一个`UnboundMethod`并将其绑定到当前的`self`.

这是委托。这是[铸造](https://github.com/saturnflyer/casting)宝石的基础，可以像这样工作：

```
delegate(:greet, provider) 
```

或者，如果您选择使用`method_missing`from cast，您的代码可能如下所示：

```
greet 
```

但是你需要先设置你的委托：

```
class MyClass
  include Providers
  include Casting::Client
  delegate_missing_methods
  attr_accessor :message

  def initialize(message="hello", provider=facebook)
    cast_as(provider)
    self.message = message
  end
end

MyClass.new.greet # => "hello from facebook!" 
```

[我在我的博客上](http://www.saturnflyer.com/blog/jim/2013/11/18/delegation-is-everything-and-inheritance-does-not-exist/)写了关于[什么是委托](http://saturnflyer.com/blog/jim/2012/07/06/the-gang-of-four-is-wrong-and-you-dont-understand-delegation/)，什么不是委托，这与理解 DCI 以及我在[Clean Ruby中所写的内容有关](http://clean-ruby.com)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-05T23:27:14.873

也许我没有跟随，但*看起来*你让这变得比需要的更难。

为什么不在你的类中实现一个“调度”模式，在那里你有一个提供者名称和提供者方法的哈希 {:f​​acebook=>"facebook_greet"} 然后只是通过 "Object#send" 将传入调用“发送”到正确的处理程序”（[http://ruby-doc.org/core-1.9.3/Object.html#method-i-send](http://ruby-doc.org/core-1.9.3/Object.html#method-i-send)）？Send对于调度方法*非常*快，因此与 eval 不同，您应该获得出色的性能。

这是一些代码来演示我解决它的方式（假设我正在关注您要完成的工作）：

```
module TwitterProvider
  def providerInit(providers)
    @providers[:twitter]="twitter_greet"
    super(providers) if defined?(super)
  end
  def twitter_greet
    "Hello Twitter User"
  end
end

module FacebookProvider
  def providerInit(providers)
    providers[:facebook]="facebook_greet"
    super(providers) if defined?(super)
  end
  def facebook_greet
    "Hello Facebook User"
  end
end

class MyClass
  include FacebookProvider
  include TwitterProvider
  attr_accessor :message

  def providerInit(providers)
    super(providers) if defined?(super)
  end

  def initialize(message="hello")
    @providers = {}
    self.message = message
    providerInit(@providers)
  end

  def greet(provider=nil)
    if provider.nil? or !self.respond_to?(@providers[provider])
      self.message
    else
      self.send(@providers[provider])
    end
  end
end

my_class = MyClass.new
puts my_class.greet
puts my_class.greet(:twitter)
puts my_class.greet(:facebook)

# Output:
# hello
# Hello Twitter User
# Hello Facebook User 
```

# javascript - javascript 旋转背景图像覆盖 IE 中的文本框的问题

> ID：15558474
> 
> 赞同：0
> 
> 时间：2013-03-21T21:26:41.453
> 
> 标签：javascript, internet-explorer

我有一个旋转的背景图像，其中一个文本框覆盖了背景图像的底部。我以为我一切正常，然后我检查了 IE。在那里，旋转的背景位于文本框的顶部，切断了顶部。我在 z-index 上尝试了多次尝试，但似乎没有任何解决方法。它在 safari、chrome 和 firefox 中看起来不错。

我很乐意提供源代码，但不确定问题出在我的 css、脚本还是 html...

网址是[http://awaybug.com](http://awaybug.com)

# php - 跟踪用户在页面上停留的时间？

> ID：15558475
> 
> 赞同：5
> 
> 时间：2013-03-21T21:26:46.520
> 
> 标签：php, javascript, jquery

如何跟踪用户在请求另一个页面或离开站点之前在页面上停留的时间？

基本上，我想做一个检查，如果用户在页面上停留 20 分钟或更长时间，然后做一些事情。

我相信这需要 php 和 javascript，但我不确定如何完成它。

也许`$_SERVER`在php中使用它来获取执行时间，然后在用户单击其他地方时获取时间戳并简单地比较两者？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-21T21:29:59.313

您可以使用简单的 javascript 完成所有这些操作。
**对于单页：**

```
window.setTimeout(function(){
// Do stuff after 20 minutes of loading the page
// Then using jQuery you can call a PHP script to do stuff like so:
$.ajax({
     url: '/myScript.php',
     method: 'POST',
     success: function(result){
        //The request was successful and the output is stored in a variable: result
     },
     complete: function(){
        //Do stuff when the request is completed (Ignores if success or not)
     },
     beforeSend: function(){
        //Do something before the request is sent
     }
});
}, 20 * 60 * 1000); //This is in milliseconds that's why I use the equation 
```

**对于多个页面：**
我建议您在用户点击页面的时间设置一个 cookie，并在每个页面上检查 cookie 是否存在。如果存在，则每 x 秒运行一次查询，以查看自创建 cookie 以来是否已过去 20 分钟。

如需完整的 Ajax 文档，请访问：[http ://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-30T22:51:37.973

我已经在一个小型 JavaScript 库和服务中投入了一些工作，以计算用户在网页上停留的时间。它还有一个额外的好处，那就是更准确（虽然不是很完美）跟踪用户实际与页面交互的时间。它忽略了用户切换到不同选项卡、空闲、最小化浏览器等的时间。谷歌分析方法有一个缺点（据我所知）它只检查你的域处理新请求时，这不是总是准确的。它不考虑是否有人不再查看您的页面，是否已最小化浏览器，自上次加载您的页面后是否已将选项卡切换到 3 个不同的网页等。

供参考 - 没有完美的解决方案。但希望这个也能提供价值。您可以实现 Javaacript API 并自己收集统计信息，或者您可以使用为您完成这一切的服务。

[http://timemejs.com](http://timemejs.com)

其用法示例：

**在您的页面中包含：**

```
<script src="https://timemejs.com/timeme.min.js"></script>
<script type="text/javascript">
TimeMe.initialize({
    currentPageName: "home-page", // page name
    idleTimeoutInSeconds: 15 // time before user considered idle
});
</script> 
```

**如果您想自己向后端报告时间：**

```
xmlhttp=new XMLHttpRequest();
xmlhttp.open("POST","ENTER_URL_HERE",true);
xmlhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
var timeSpentOnPage = TimeMe.getTimeOnCurrentPageInSeconds();
xmlhttp.send(timeSpentOnPage); 
```

TimeMe.js 还支持通过 websockets 发送计时数据，因此您不必尝试将完整的 http 请求强制到`document.onbeforeunload`事件中。

# python - Python中的文件输入和输出，剥离空间并输出到列表

> ID：15558478
> 
> 赞同：0
> 
> 时间：2013-03-21T21:27:04.040
> 
> 标签：python

我正在用python编写一个程序，从文件'var_input'中获取5行输入并将其输入到列表中，然后将每个单独的数字首先或第二输入到列表中

我只是想知道最好的方法是将每个数字之间的空间分开，然后将其附加到列表中。我正在考虑使用 python 的 split 方法，但我不确定如何做到这一点

输入文件中的数据如下所示

```
18 24               
10 5
101 567
234 90
107 4567 
```

首先应该包含`['18', '10', '101', '234', '107']`

第二个应该包含`['24', '5', '567', '90', '4567']`

这是我到目前为止所拥有的

```
first = []
second = []

file_input = open('var_input')
input_list = file_input.readlines() 
```

非常感谢，任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T21:28:51.757

你可以用`zip`and做到这一点`split`：

```
with open('var_input') as file_input:
    input_list = file_input.readlines()
first, second = zip(*[l[:-1].split() for l in input_list]) 
```

它是如何工作的 -`[l[:-1].split() for l in input_list]`是一个列表推导，它将`split`方法应用于每一行，使其看起来像：

```
[["18", "24"], ["10", "5"], ["101", "567"], ["234", "90"], ["107", "4567"]] 
```

`zip`是一个函数，然后将多个列表压缩在一起（当与 一起给出时`*`，它将输入列表中的每个项目视为一个单独的参数）。它通过获取每个列表的第一项，然后是每个列表的第二项来“压缩”它（如果每行有三个或更多项目，你最终会得到三个或更多输出列表）。结果看起来像

```
[('18', '10', '101', '234', '107'), ('24', '5', '567', '90', '4567')] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T07:30:55.897

```
first = []
second = []

with open('var_input') as fp:
    for line in fp:
        temp = line.split()
        first.append(temp[0])
        second.append(temp[1]) 
```

这可能看起来很愚蠢，但它很简单并且有效。

# javascript - JavaScript: SyntaxError: missing ) 在参数列表之后

> ID：15558482
> 
> 赞同：47
> 
> 时间：2013-03-21T21:27:12.063
> 
> 标签：javascript, syntax-error, dom-events

我收到错误消息：

> SyntaxError: missing ) 在参数列表之后

使用这个 javascript：

```
var nav = document.getElementsByClassName('nav-coll');
for (var i = 0; i < button.length; i++) {
    nav[i].addEventListener('click',function(){
            console.log('haha');
        }
    }, false);
}; 
```

这个错误是什么意思？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2013-03-21T21:28:11.717

你的函数有一个额外的结束`}`。

```
var nav = document.getElementsByClassName('nav-coll');
for (var i = 0; i < button.length; i++) {
    nav[i].addEventListener('click',function(){
            console.log('haha');
        }        // <== remove this brace
    }, false);
}; 
```

你真的应该使用 JSHint 或 JSLint 之类的东西[来](http://www.jshint.com/)帮助[找到](http://www.jslint.com/)这些东西。这些工具与许多编辑器和 IDE 集成，或者您可以将代码片段粘贴到上述网站并请求分析。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-03-21T21:28:55.773

你有一个额外`}`的很多，如下所示：

```
var nav = document.getElementsByClassName('nav-coll');
for (var i = 0; i < button.length; i++) {
    nav[i].addEventListener('click',function(){
            console.log('haha');
        } // <-- REMOVE THIS :)
    }, false);
}; 
```

[**jsFiddle**](http://jsfiddle.net/)是一个非常好的工具。我用你的无效代码创建了一个小提琴，当点击`TidyUp`按钮时，它会格式化你的代码，如果缺少大括号有任何可能的错误，它会更清楚。

* * *

[**演示**](http://jsfiddle.net/6kwwz/)- 你的代码在小提琴中，玩一下 :)

* * *

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2021-01-27T02:10:08.467

只是发布以防其他人有同样的错误......

我在“异步”函数之外使用“等待”，无论出于何种原因导致参数列表后出现“缺少)”错误。

解决方案是使函数异步

```
function functionName(args) {} 
```

变成

```
async function functionName(args) {} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-05-26T09:51:23.467

与 Josh McGee 类似，我试图`await`在全局范围内使用，因为它不是`async`函数，所以会引发错误。有关解决方案，请参见[此处](https://stackoverflow.com/q/51525234/9063935)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2022-02-09T15:37:12.517

此错误可能是您的 Android 版本（特别是如果您使用的是 Web 视图），请尝试像旧版本的 JavaScript 引擎一样更改您的代码，例如：

```
 .then(function(canvas){
            //canvas object can gained here
   }); 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2021-04-22T18:47:01.513

我遇到了同样的错误，我发现随着 ES6 和字符串插值的使用增加，越来越多的人会开始犯我在使用[Template Literals](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals)时犯的同样错误：

最初，我记录了这样的语句：

```
console.log(`Metadata: ${data}`); 
```

但后来改变它并忘记删除`${}`：

```
console.log('Metadata: ' + JSON.stringify(${data})); 
```

# html - 标签的右边框未显示

> ID：15558483
> 
> 赞同：0
> 
> 时间：2013-03-21T21:27:12.430
> 
> 标签：html, forms, css

我已经建立了一个小的登录表单。不幸的是，输入的右边框没有显示，如您在随附的屏幕截图中所见： ![在此处输入图像描述](../Images/da5827831f30393c6881bf5163605177.png)

我根据[这篇文章](https://stackoverflow.com/a/6938990/1273551)的建议构建了它，以使输入与标签右对齐，并且仍然使用剩余空间。

HTML：

```
<div id="wrapper">
    <form id="loginform">
        <label for="username">Username:</label>
        <span><input name="username" id="username" type="text" autofocus /></span>

        <label for="password">Password:</label>
        <span><input name="password" id="password" type="password" /></span>

        <input id="loginBtn" type="submit" name="submit" value="Login" />
    </form>
</div> 
```

CSS：

```
#wrapper {
    height: auto;
    background-color: #dfe9f6;
    margin: 40px 8px 8px 8px;
    padding: 8px;
    border: 1px solid #99bce8;
}
span {
    margin-bottom: 8px;
    display: block;
    overflow: hidden;
}
label, input {
    height: 17px;
}
label {
    float: left;
    width: 80px;
}
input {
    border: 1px solid #abadb3;
    width: 100%;
}
input[type="submit"] {
    height: 22px;
} 
```

（不）JSFiddle 上的工作示例：http: [//jsfiddle.net/kN4wa/1/](http://jsfiddle.net/kN4wa/1/)

我已经在 Firefox 19 和 Chrome 25 中进行了测试，非常感谢一些帮助！

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T21:31:53.300

只需添加

```
input {
    border: 1px solid #abadb3;
    -moz-box-sizing: border-box; /* partially supported */
    box-sizing: border-box; /* here is what I added */
    width: 100%;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T21:29:28.733

您已输入 { width: 100%; 因此，边框添加到这个宽度上，使其高于父级的宽度，这就是它不显示的原因；使其宽度：99.5%；或者只是 99%。或添加`box-sizing: border-box;`到输入。

带有供应商前缀：

```
-webkit-box-sizing: border-box; /* Safari/Chrome, other WebKit */
-moz-box-sizing: border-box;    /* Firefox, other Gecko */
box-sizing: border-box;         /* Opera/IE 8+ */ 
```

# ruby-on-rails - 使虚拟属性成为一个哈希的一部分

> ID：15558485
> 
> 赞同：0
> 
> 时间：2013-03-21T21:27:20.230
> 
> 标签：ruby-on-rails, activerecord

我有一个模型，它在数据库中有一个实际列。此列存储为 JSON 配置字符串。我使用了一堆我想在这个配置 JSON 属性中映射的虚拟属性。我基本上不想在数据库中创建一堆列，而是使用这个 JSON 属性来包含所有内容。有没有比以下更清洁`def`的方法来实现这一目标？

```
class Device < ActiveRecord::Base
  attr_accessible :configuration
  serialize :configuration, JSON

  attr_accessor :background_color, :title

  # below is ew
  def background_color; self.configuration["background_color"]; end
  def background_color=(value); self.configuration["background_color"] = value; end

  def title; self.configuration["title"]; end
  def title=(value); self.configuration["title"] = value; end
end 
```

理想情况下，我会寻找类似的东西`attr_maps_to_hash :configuration, [:background_color, :title]`。这样的事情存在吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T21:59:07.020

您可以为此使用[ActiveRecord::Store](http://api.rubyonrails.org/classes/ActiveRecord/Store.html)。

```
class User < ActiveRecord::Base
  store :settings, accessors: [ :color, :homepage ]
end

u = User.new(color: 'black', homepage: '37signals.com')
u.color                          # Accessor stored attribute
u.settings[:country] = 'Denmark' # Any attribute, even if not specified with an accessor

# Add additional accessors to an existing store through store_accessor
class SuperUser < User
  store_accessor :settings, :privileges, :servants
end 
```

如果您使用的是 PostgreSQL，请查看[HStore](https://github.com/engageis/activerecord-postgres-hstore)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T22:00:45.393

Rails 自 3.2 起在 ActiveRecord 中内置了键值存储 - 请参见此处：

[我在哪里可以阅读更多关于 Rails 3.2 的数据存储与文本字段中的键值的信息？](https://stackoverflow.com/questions/9563282/where-can-i-read-more-about-rails-3-2s-data-store-with-key-value-in-textfield)

在您的情况下，您可以有一个名为 configuration 的文本字段，然后执行以下操作：

class Device < AR::Base store :configuration, accessors: [:title, :background_color, ...] ...

这应该适用于表单等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T22:00:41.613

想到了两种方法。

首先，您可以拥有一个属性数组 [:background_color, :title]，然后在调用 define_method 时遍历它们。您将定义两个方法，define(method_name) 和 define("#{method_name}=")。

第二，类似的想法，但使用方法缺失。

```
def method_missing(method_name, *args, &block)
  ...see if it's a get or set...
  ...do your stuff...
  ...rain dance...
  ...yay...
end 
```

# c++ - 为各种 C/C++ 编译器优化代码

> ID：15558488
> 
> 赞同：1
> 
> 时间：2013-03-21T21:27:28.330
> 
> 标签：c++, compiler-construction, c-preprocessor, development-environment, compiler-optimization

对于那些为多个平台开发软件的人，您如何处理编译器可能比其他编译器做得更好的潜力。

假设您为 OS X、Windows、Linux 开发，并且正在使用 Clang/LLVM、VS 和 GCC。

因此，如果有人在 OS X 上编译您的应用程序并且他们正在使用 GCC，而另一个人在 OS X 上使用英特尔编译器进行编译，那么您*可以*优化英特尔编译器的代码部分（如果该人拥有它们）。

你会检查一个预处理器指令吗？

```
#ifdef __GCC_
    // do it this way
#endif

#ifdef __INTEL__
    // do it this way
#endif

#ifdef __GCC_WITH C++_V11_Support__
    // do it this way
#endif

#idfef __WINDOWS_VISUAL_STUDIO
    // do it this way
#endif 
```

或者，还有更好的方法？

如何找到编译器为检查编译器版本等提供的指令列表

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-21T21:36:09.563

不要选择基于预定义宏的实现。让构建系统控制它。

这使您可以在单元测试期间构建和比较多个实现。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-21T21:35:45.327

通常，优化遵循传统的 80/20 或 90/10 规则，即“20% 的代码需要 80% 的时间来运行”（以及“20% 的代码需要 80% 的时间来开发”）。如果您愿意，可以用 80/20 代替 90/10 - 它几乎总是介于这两者之间……

因此，“我们是否针对特定编译器进行优化”的第一阶段是弄清楚代码的哪些部分很慢，以及是否可以以适用于所有编译器的通用方式使其变得更好（例如传递 const 引用而不是而不是一个大对象的副本）。一旦你用尽了对代码的所有通用改进，你可能想要查看编译器特定的优化——但这确实需要你获得足够多的东西，以至于在不同编译器之间拥有不同的代码确实值得额外维护。

一般来说，我会非常避免“不同编译器中的东西不同”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T21:33:22.467

一般来说，编译器是为优化通用代码而编写的，而不是专门为编译器编写的。所以通常你应该只专注于编写干净的代码，使用最快的算法。然而，一些编译器是可提示的，例如 gcc，通过使用这些属性的属性可以让编译器更好地完成它的工作。

例如，使用 noreturn 属性将允许 gcc 丢弃函数返回代码，从而最小化代码大小。我猜很多编译器都有类似的提示方案。

然后可以这样做；

```
#ifdef GCC
     #define NO_RETURN __attribute(...)
#else
     #define NO_RETURN
#endif 
```

并在您的代码中使用 NO_RETURN。

# javascript - 根据下拉选择自动完成源

> ID：15558490
> 
> 赞同：0
> 
> 时间：2013-03-21T21:27:30.173
> 
> 标签：javascript, jquery

您好我正在尝试实现一些 JQuery 以使用自动完成 UI。我有一个包含两个选项的下拉列表。演员和电影。根据选择的内容，我希望自动完成输入框的来源有所不同。我的 JQuery 有什么问题吗？

```
<script type="text/javascript">
           $(document).ready(function(){
           $("#selectType").change(function() {

           if ($(this).val() == "Actor"){
            $("#tags").autocomplete({
            source: "nameSearch.php",
            minLength: 2
        });

        }
        else if($(this).val() == "Film"){
            $("#tags").autocomplete({
            source: "FilmSearch.php",
            minLength: 2
        });
        }
        });
        });
    </script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T21:39:06.320

像这样使用：

```
 $(document).ready(function () {
           //Create widget with default data source
           $("#tags").autocomplete({
               source: "nameSearch.php",
               minLength: 2
           });

           $("#selectType").change(function () {
               // Assign new data source like that :

               if ($(this).val() == "Actor")
                   $("#tags").autocomplete("option", "source", "nameSearch.php");
               else 
                   if ($(this).val() == "Film")
                       $("#tags").autocomplete("option", "source", "FilmSearch.php");

              // And what is your 2 conditions are not met?????
           });
       }); 
```

# c# - 激活器.CreateInstance () - 有没有更有效的创建对象的方法？

> ID：15558493
> 
> 赞同：0
> 
> 时间：2013-03-21T21:27:39.753
> 
> 标签：c#, asp.net, .net, asp.net-4.5

我有很多目前使用 Activator.CreateInstance() 根据类型创建对象的代码。有没有更优化的方法来实现这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T23:55:38.313

我将假设您无法使用`new`关键字，因为您正在通过通用工厂创建对象的实例。

您的选择受限于如何通过反射实例化对象。除了`Activator.CreateInstance`及其衍生物之外，我知道您可以使用泛型类型定义实例化对象的唯一方法是声明[新的约束](http://msdn.microsoft.com/en-us/library/sd2w2ew5.aspx)。这允许您调用`new T()`. 您要实例化的对象必须声明一个无参数构造函数才能使其工作。

如果性能是最重要的，那么我建议您避免任何基于反射或泛型的对象实例化模式，并尽可能使用 new 关键字创建相关对象的实例。

# excel - 在Excel中检索重复项之间最大日期的单元格值

> ID：15558500
> 
> 赞同：2
> 
> 时间：2013-03-21T21:28:15.317
> 
> 标签：excel, excel-formula, vba

我在 Excel 2010 的 Excel 工作表中有以下列：

```
Batch Number        BatchID            END TIME
120319-0001     120319-0001_TEST1   3/20/12 13:44
120319-0001     120319-0001_TEST2   3/20/12 10:05
120319-0002     120319-0002_TEST1   3/20/12 14:40
120319-0002     120319-0002_TEST2   3/20/12 12:46
120319-0003     120319-0003_TEST1   3/20/12 14:01
120319-0003     120319-0003_TEST2   3/20/12 12:11
120319-0004     120319-0004_TEST1   3/20/12 15:37
120319-0004     120319-0004_TEST2   3/20/12 11:59
120319-0005     120319-0005_TEST1   3/20/12 19:06
120319-0005     120319-0005_TEST2   3/20/12 11:47 
```

我需要一个可以填写在第 4 列中的公式，该公式将执行以下操作：

*   选择“批号”列中的所有重复项
*   在“END TIME”列中查找重复项的最大值
*   在所有重复项的“END TIME”中，用 Max 的“BatchID”列中的单元格值填充第 4 列

第 4 列的预期输出：

```
120319-0001_TEST1
120319-0001_TEST1
120319-0002_TEST1
120319-0002_TEST1
120319-0003_TEST1
120319-0003_TEST1
120319-0004_TEST1
120319-0004_TEST1
120319-0005_TEST1
120319-0005_TEST1 
```

我已经尝试使用、 和语句的组合`INDEX`，但还没有让它工作。`MATCH``IF`

我也愿意使用 VBA/宏解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T22:23:22.430

我快速尝试使用公式，但我认为您可能需要使用数组公式，它们对我来说毫无意义！

下面的宏应该可以做到。（虽然比较时间戳可能是一个问题）

```
Sub Main()
Dim Sheet As Worksheet
Dim Data As Range

Set Sheet = ThisWorkbook.Worksheets("Sheet1")
Set Data = Sheet.Range("A2:A" & Range("A" & Range("A" & Sheet.UsedRange.Rows.Count).Row)

Dim BatchNumber As Variant
Dim EndTime As Variant
Dim Result As Variant

BatchNumber = Data.Value2
BatchID = Data.Offset(ColumnOffset:=1).Value2
EndTime = Data.Offset(ColumnOffset:=2).Value2
Result = Data.Offset(ColumnOffset:=3).Value2

Dim Index As Integer
Dim Lookup As Integer
Dim Max As Integer

For Index = LBound(BatchNumber, 1) To UBound(BatchNumber, 1)
    Max = Index
    For Lookup = LBound(BatchNumber, 1) To UBound(BatchNumber, 1)
        If BatchNumber(Lookup, 1) = BatchNumber(Index, 1) Then
            If Not Lookup = Index Then
' NOTE: you might to do stuff to the date/time comparison below to get it to work correctly
                If EndTime(Lookup, 1) > EndTime(Index, 1) Then
                    Max = Lookup
                Else
                    Max = Index
                End If
            End If
        End If
    Next Lookup
    Result(Index, 1) = BatchID(Max, 1)
Next Index

Data.Offset(ColumnOffset:=3).Value2 = Result

End Sub 
```

**更新**

下面的应该会快一点，因为它只在数据集上迭代~~两次~~。而不是第一个 Rows*Rows 迭代（我认为）。

```
Sub Main2()
Dim Sheet As Worksheet
Dim Data As Range
Dim vData As Variant
Dim vResult As Variant
Set Sheet = ThisWorkbook.Worksheets("Sheet1")
Set Data = Sheet.Range("A2:A" & Range("A" & Sheet.UsedRange.Rows.Count).Row)

vData = Data.Resize(ColumnSize:=3).Value2
vResult = Data.Value2
Dim List As Object

Set List = CreateObject("Scripting.Dictionary")

Dim Index As Integer
Dim Key As String

For Index = LBound(vData, 1) To UBound(vData, 1)
    Key = vData(Index, 1)
    If List.exists(Key) Then
        If vData(Index, 3) > vData(List(Key)(1), 3) Then
            List(Key)(1) = Index
        End If
    Else
        List.Add vData(Index, 1), Array(Index, Index)
    End If
Next Index

For Index = LBound(vData, 1) To UBound(vData, 1)
    Key = vData(Index, 1)
    vResult(Index, 1) = vData(List(Key)(1), 2)
Next Index

Data.Offset(ColumnOffset:=3).Value2 = vResult

Set List = Nothing

End Sub 
```

# php - 烦人的持久 $_GET 变量

> ID：15558504
> 
> 赞同：0
> 
> 时间：2013-03-21T21:28:28.720
> 
> 标签：php

我的`<a href>`网页中有一个包含以下链接：

`<a href=\"?remove=0\">Remove</a>`

这很好。然后我通过以下方式引用它：

`if(isset($_REQUEST['remove']))`

检查它是否已设置，然后执行相关操作（从数组中删除值）。

但是，当我在我的 php 页面中单击另一个表单时，该表单设置为`method='POST'`，该`$_GET`值保留在 URL 栏中，因此由于某种原因**再次**传递并破坏了我的程序。

有什么想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-21T21:30:15.393

听起来`action=`您的表单中缺少一个道具。如果您没有指定表单应该发布到的位置，它会发布到当前 URL，包括查询字符串。

帖子到当前网址：

```
<form method="post"> 
```

发布到您指定的 URL：

```
<form method="post" action="mypage.php"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T21:32:18.887

删除听起来像是一项危险的操作。它不应该在响应 GET 请求时执行：用户可能会重新加载页面，意外再次删除某些内容，或者搜索机器人可能会跟随该链接并删除该内容（当然，假设它具有权限）。即使是现在的浏览器也会进行预取 - 如果预取链接之一是删除链接会发生什么？

因此，明智的做法是检查

```
if (isset($_POST['remove'])) 
```

并将要删除的链接转换为表单。

# php - 使用提取（$_REQUEST，EXTR_IF_EXISTS）是否安全？

> ID：15558509
> 
> 赞同：3
> 
> 时间：2013-03-21T21:28:37.857
> 
> 标签：php, security, extract

在函数（不是类方法）中，`extract( $_REQUEST, EXTR_IF_EXISTS )`如果您事先定义了变量，是否可以安全使用？

例子：

```
$a = $b = $c = '';
extract( $_REQUEST, EXTR_IF_EXISTS ); 
```

或者这会允许恶意攻击者覆盖 PHP 全局变量和其他敏感内容吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T21:37:33.267

你*可以*这样做，但你也可以很容易地避免这样做：

```
$a = isset($_REQUEST['a']) ? $_REQUEST['a'] : '';
$b = isset($_REQUEST['b']) ? $_REQUEST['b'] : '';
$c = isset($_REQUEST['c']) ? $_REQUEST['c'] : ''; 
```

然后，您可以确保没有其他任何东西进入您当前的范围。

如果您只是希望您的代码更漂亮，请考虑使用全局辅助函数：

```
function request($k, $def=''){
    return isset($_REQUEST[$k]) ? $_REQUEST[$k] : $def;
} 
```

然后您可以根据需要使用未设置参数的默认值进行初始化：

```
$a = request('a');
$b = request('b', null);
$c = request('c', "hello"); 
```

如果你真的想使用`extract`，试试这个：

```
function requested($a){
    return array_intersect_key($_REQUEST, array_flip($a));
}

extract( requested(array('a', 'b', 'c')), EXTR_IF_EXISTS ); 
```

这通过`$_REQUEST`首先修改以仅包含您想要的键，然后在其上运行提取来工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T21:30:59.920

好吧，这并不安全。有人可以做这样的事情：`www.example.com?_SERVER['anything']`或者如果他有任何知识，他可以尝试将一些东西注入另一个变量。这仍然是某种猜谜游戏，但这是可能的。

此外，当提取物放在错误的位置并替换重要的东西时，一个输入名称中的一个拼写错误可能会弄乱你的整个程序。像这样的错误很难调试。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-21T21:54:31.163

我认为 using 有太多的疑问，`extract()`因为您实际上必须在本地命名空间中才能真正知道已经定义了哪些变量。

我将按照这些思路进行一些操作，这不是很漂亮，但仍然很容易看出哪些变量被接受为来自以下的输入`$_REQUEST`：

```
foreach ( array(
    'a',
    'b',
    'c',
    'foo' )
as $auth_var){
    if ( isset( $_REQUEST[$auth_var] ) ) ${$auth_var} = $_REQUEST[$auth_var];
} 
```

## 更新

我比我更好地挖掘 Cal 的解决方案。它看起来也更好：

```
extract ( array_intersect_key( $_REQUEST, array_flip( array(
    'a',
    'b',
    'c',
    'foo' )
) ) ); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T21:34:19.617

该代码符合您的预期，但如果您将其放在错误的位置，当然可能会出错：

```
include ('/some/file/with/super/secret/config/in.php');

$a = $b = $c = '';
extract( $_REQUEST, EXTR_IF_EXISTS ); 
```

但是，只要你知道你在哪里做，你在什么范围内，那就没问题了。

我个人可能不会写这个，但这取决于你想要做什么。

如果您在服务器上运行，请记住 $_SERVER 可以被它覆盖。其实少了些琐碎的CLI应用，别用这个，太吓人了！

# c++ - 如何在 Ubuntu 12.10 的 Netbeans 7.3 中使用 Stroustrup 的图形库（Simple_window.h、Graph.h、...）？

> ID：15558519
> 
> 赞同：0
> 
> 时间：2013-03-21T21:29:07.053
> 
> 标签：c++, netbeans-7, ubuntu-12.10, fltk

每个人。我正在学习 Bjarne Stroustrup 的“Programming principle and practice using C++”一书。我在 Ubuntu 12.10 中使用 Netbeans 7.3。我想在本书的第 12 章中构建并运行这个简单的图形程序。程序是这样的：

```
#include "Simple_window.h" // get access to our window library
#include "Graph.h" // get access to our graphics library facilities

int main()  
{    
    using namespace Graph_lib; // our graphics facilities are in Graph_lib

    Point tl(100,100); // to become top left corner of window    
    Simple_window win(tl,600,400,"Canvas"); // make a simple window

    Polygon poly; // make a shape (a polygon)

    poly.add(Point(300,200)); // add a point    
    poly.add(Point(350,100)); // add another point    
    poly.add(Point(400,200)); // add a third point    
    poly.set_color(Color::red); // adjust properties of poly

    win.attach (poly); // connect poly to the window

    win.wait_for_button(); // give control to the display engine    
} 
```

我无法在 2 天内构建此程序。[我将http://www.stroustrup.com/Programming/Graphics/](http://www.stroustrup.com/Programming/Graphics/)中的所有图形库添加到我的项目中。我还成功安装了 FLTK-1.1.10 并将其配置为 Netbeans。所有关于 FLTK 的程序都在 Netbeans 中运行得很好。但是在构建和运行上面显示的程序时，会出现很多错误。错误是这样的：“未定义的引用...”。如何在 Netbeans 中解决这个问题？

错误发生如下：

g++ -o dist/Debug/GNU-Linux-x86/cppapplication_3 build/Debug/GNU-Linux-x86/GUI.o build/Debug/GNU-Linux-x86/Graph.o build/Debug/GNU-Linux-x86/ Simple_window.o build/Debug/GNU-Linux-x86/Window.o build/Debug/GNU-Linux-x86/main.o -L../../Downloads/fltk-1.1.10/lib -lfltk -lfltk_forms -lfltk_gl -lfltk_images -lfltk_jpeg ../../Downloads/fltk-1.1.10/lib/libfltk.a(Fl_get_system_colors.o): 在函数`getsyscolor(char const*, char const*, char const*, char const*, void (*)(unsigned char, unsigned char, unsigned char))': Fl_get_system_colors.cxx:(.text+0x17): undefined reference to`XGetDefault' Fl_get_system_colors.cxx:(.text+0x38): 对`XParseColor' ../../Downloads/fltk-1.1.10/lib/libfltk.a(Fl_get_system_colors.o): In function`fl_parse_color的未定义引用(char const*, unsigned char&, unsigned char&, unsigned char&)': Fl_get_system_colors.cxx:(.text+0x2cd): undefined reference to `XParseColor' ... ...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T21:54:41.423

看起来您需要指定要链接的 X 库：

```
 -lXext -lX11 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2017-08-18T00:33:22.700

如果您下载了 FLTK 1.3.3，则包含的名称与以前的版本不同。因此，在 Bjarne Stroustrup 书中的第 1203 页，关于如何安装 fltk 的教程不再好，因为它们已经发生了很大的变化。这是一个关于如何为 VS 安装它以及如何在 Win32 项目中设置它的教程。[http://www.c-jump.com/bcc/common/Talk2/Cxx/FltkInstallVC/FltkInstallVC.html](http://www.c-jump.com/bcc/common/Talk2/Cxx/FltkInstallVC/FltkInstallVC.html) 在fltk网站上，有一些教程（没有Bjarne解释得那么好，但没关系）。

# php - php cURL CURLOPT_VERBOSE 不显示有效负载

> ID：15558520
> 
> 赞同：3
> 
> 时间：2013-03-21T21:29:13.423
> 
> 标签：php, debugging, curl, payload, verbose

虽然 curl 的以下输出提供了有用的标头信息，但它不提供有效负载信息。例如，我想在提供的调试信息中查看 {"jason_index","json_value"}。

1.) 是否可以在详细模式下内联显示有效负载？

2.) 查看由 cURL 处理的已发送有效负载的最佳方式是什么？

```
* About to connect() to domain.com port 443 (#0)
*   Trying IP... * connected
* Connected to domain.com (IP) port 443 (#0)
* successfully set certificate verify locations:
*   CAfile: /usr/share/curl/curl-ca-bundle.crt
  CApath: none
* SSL connection using RC4-SHA
* Server certificate:
*    subject: /serialNumber=SN/C=CA/ST=Ontario/L=Ottawa/O=ORG Inc./CN=*.domain.com
*    start date: 2010-05-10 22:23:08 GMT
*    expire date: 2015-08-12 19:17:14 GMT
*    subjectAltName: alt.domain.com matched
*    issuer: /C=US/O=Equifax/OU=CA
* SSL certificate verify ok.
* Server auth using Basic with user 'userid'
> POST request_uri.json HTTP/1.1
Authorization: Basic auth_string=
User-Agent: UA
Host: alt.domain.com
Accept: */*
Content-Type: application/json; charset=utf-8
Content-Length: 85

< HTTP/1.1 422 Unprocessable Entity
< Server: ServerName
< Date: Thu, 21 Mar 2013 20:08:56 GMT
< Content-Type: application/json; charset=utf-8
< Transfer-Encoding: chunked
< Connection: keep-alive
< Status: 422 Unprocessable Entity
< 
* Connection #0 to host alt.domain.com left intact
* Closing connection #0 
```

cURL 语句示例

```
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, $url);
curl_setopt($ch, CURLOPT_POSTFIELDS, $data);
curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_VERBOSE, true);
curl_setopt($ch, CURLOPT_STDERR, fopen(dirname(__FILE__) . "/headers.txt", "w+"));
$result = curl_exec($ch); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-12T19:42:01.873

我最近遇到了这个问题，我设法看到发生了什么的唯一方法是使用调试代理，例如：

*   [burp 套件](http://portswigger.net/burp/download.html)- Linux/Windows/Mac (Java)
*   [提琴手](http://fiddler2.com)- Windows

其他解决方案是使用数据包检查器（此选项**不会**让您看到`HTTPS`流量）：

*   [线鲨](http://www.wireshark.org/)

使用代理的解决方案易于设置、安装和使用：

```
curl_setopt($ch, CURLOPT_PROXY, 'localhost:8080'); // default for burp suite
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false); // ignore certs while connecting to https 
```

# php - PHP PDO 可以选择字符串

> ID：15558526
> 
> 赞同：1
> 
> 时间：2013-03-21T21:29:35.350
> 
> 标签：php, select, pdo

我有点困惑。当我在下面执行此操作并且用户名是 test@test.com 时，即使记录存在，它也不会找到任何东西。我意识到我需要添加引号，但我不知道在哪里，有人可以指出这一点。

```
 $stmt = $db->prepare("SELECT USER_ID, USERNAME, PASSWORD, SALT, EMAIL FROM USERS WHERE     USERNAME = :username LIMIT 1");
    $stmt->bindValue(':username', $username); 
    $stmt->execute(); 
    $results = $stmt->fetch(PDO::FETCH_ASSOC); 
```

非常感谢

编辑：如下所述，我也尝试过 bindParam 。

编辑2：解决了-我已经解决了！我在数据库中查看错误的列，对不起，伙计们/女孩们，这是一个漫长的夜晚：（感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T21:35:48.543

我想，该`username`列类似于`test`，并且该`email`列具有 value `test@test.com`。

如果您测试`test@test.com`，我怀疑您必须与`email`列进行比较

```
SELECT USER_ID, USERNAME, PASSWORD, SALT, EMAIL FROM USERS WHERE EMAIL = :username LIMIT 1 
```

如果你真的想测试用户名，`$username`大概应该是`test`.

# c# - 单击或选项卡时如何将文本框字体更改回默认值并清除默认文本？

> ID：15558527
> 
> 赞同：1
> 
> 时间：2013-03-21T21:29:35.317
> 
> 标签：c#, fonts, textbox, default

在 C# Windows 窗体应用程序中，如何以编程方式使其在用户单击（或选项卡）上/（到）文本框时，清除默认文本并将字体样式恢复为 Windows 默认值？

我只是在做一个基本的测试表格。我不会包含我正在使用的失败的代码，因为我已经尝试了很多不同的东西。我有点需要帮助填补空白。我将 textBox 中的文本设为灰色和斜体。当文本框被选项卡或单击时，文本需要消失，字体样式和颜色需要设置回 windows 默认值。我整天都在搞这个，我知道它应该很简单，但我一辈子都无法弄清楚。求救！我在网上看到的大多数信息都有 ASP、HTML 和 Java，但我似乎无法偶然发现 C# 示例。

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;

namespace WindowsFormsApplication5
{
public partial class Form1 : Form
{

    public Form1()
    {
        InitializeComponent();
    }

    private void textBox1_Click(object sender, EventArgs e)
    {

    }

    private void Form1_Load(object sender, EventArgs e)
    {

    }

    private void button1_Click(object sender, EventArgs e)
    {

    }

}
} 
```

我进行了广泛搜索，找不到用 C# 编写的好示例。几天前我跑了一个页面，但还没有上市，所以我没有注意它，现在我再也找不到它了。我尝试了几种方法，现在我很困惑。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T21:42:46.490

您需要存储一个值来指示文本已更改。我会考虑创建一个派生的 TextBox，如下所示：

```
/// <summary>
/// Represents a Windows TextBox control that displays placeholder text when the
/// control is empty.
/// </summary>
public class PlaceholderTextBox : TextBox
{
    private bool _set;
    private Color _valueForeColor;
    private Color _valueBackColor;
    private Font _valueFont;
    private Color? _PlaceholderForeColor;
    private Color? _PlaceholderBackColor;
    private Font _PlaceholderFont;

    /// <summary>
    /// Gets or sets the text that is shown when the <see cref="TextBox"/> is empty.
    /// </summary>
    [Browsable(true)]
    [Category("Appearance")]
    [Description ("The text that is shown when the TextBox is empty.")]
    [DefaultValue("")]
    public string PlaceholderText { get; set; }

    /// <summary>
    /// Gets or sets the <see cref="Color"/> of the placeholder text.
    /// </summary>
    [Browsable(true)]
    [Category("Appearance")]
    [Description("The color of the placeholder text.")]
    public Color PlaceholderForeColor
    {
        get { return _PlaceholderForeColor ?? _valueForeColor; } 
        set
        {
            if (value == _valueForeColor)
                _PlaceholderForeColor = null;
            else
                _PlaceholderForeColor = value;
        }
    }

    /// <summary>
    /// Gets or sets the <see cref="Color"/> of the background when displaying placeholder text.
    /// </summary>
    [Browsable(true)]
    [Category("Appearance")]
    [Description("The color of the background when displaying placeholder text.")]
    public Color PlaceholderBackColor
    {
        get { return _PlaceholderBackColor ?? _valueBackColor; } 
        set
        {
            if (value == _valueBackColor)
                _PlaceholderBackColor = null;
            else
                _PlaceholderBackColor = value;
        }
    }

    /// <summary>
    /// Gets or sets the <see cref="Font"/> used by the control when displaying placeholder text.
    /// </summary>
    [Browsable(true)]
    [Category("Appearance")]
    [Description("the Font used by the control when displaying placeholder text.")]
    public Font PlaceholderFont
    {
        get { return _PlaceholderFont ?? Font; }
        set { _PlaceholderFont = value.Equals(Font) ? null : value; }
    }

    /// <summary>
    /// Gets or sets the foreground color of the control.
    /// </summary>
    /// <returns>
    /// A <see cref="Color"/> that represents the control's foreground color.
    /// </returns>
    public override Color ForeColor
    {
        get { return _valueForeColor; }
        set
        {
            _valueForeColor = value;
            if(_set)
                base.ForeColor = value;
        }
    }

    /// <summary>
    /// Gets or sets the background color of the control.
    /// </summary>
    /// <returns>
    /// A <see cref="Color"/> that represents the background of the control.
    /// </returns>
    public override Color BackColor
    {
        get { return _valueBackColor; }
        set
        {
            _valueBackColor = value;
            if(_set)
                base.BackColor = value;
        }
    }

    /// <summary>
    /// Gets or sets the font of the text displayed by the control.
    /// </summary>
    /// <returns>
    /// The <see cref="Font"/> to apply to the text displayed by the control. 
    /// The default is the value of the <see cref="Control.DefaultFont"/> property.
    /// </returns>
    public override Font Font
    {
        get { return _valueFont; }
        set
        {
            _valueFont = value;
            if(_set)
                base.Font = value;
        }
    }

    public PlaceholderTextBox()
    {
        _valueForeColor = base.ForeColor;
        _valueBackColor = base.BackColor;
        _valueFont = base.Font;
    }

    /// <summary>
    /// Raises the <see cref="E:System.Windows.Forms.Control.GotFocus"/> event.
    /// </summary>
    /// <param name="e">An <see cref="T:System.EventArgs"/> that contains the event data.</param>
    protected override void OnGotFocus(EventArgs e)
    {
        if (!_set)
        {
            Text = String.Empty;
            base.ForeColor = _valueForeColor;
            base.BackColor = _valueBackColor;
            base.Font = _valueFont;
            _set = true;
        }

        base.OnGotFocus(e);
    }

    /// <summary>
    /// Raises the <see cref="E:System.Windows.Forms.Control.LostFocus"/> event.
    /// </summary>
    /// <param name="e">An <see cref="T:System.EventArgs"/> that contains the event data. </param>
    protected override void OnLostFocus(EventArgs e)
    {
        if (Text == String.Empty)
        {
            Text = PlaceholderText;
            base.ForeColor = PlaceholderForeColor;
            base.BackColor = PlaceholderBackColor;
            base.Font = PlaceholderFont;
            _set = false;
        }

        base.OnLostFocus(e);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T21:35:40.507

[`GotFocus`](http://msdn.microsoft.com/en-us/library/system.windows.uielement.gotfocus.aspx)该活动可能适合您吗？

# jquery - Html 内容面板滑入

> ID：15558535
> 
> 赞同：0
> 
> 时间：2013-03-21T21:29:58.577
> 
> 标签：jquery, html, slide, nav

我希望创造一种类似于这里看到的效果

[http://www.templatemonster.com/demo/42436.html](http://www.templatemonster.com/demo/42436.html)

当按下导航栏上的按钮时，内容从左侧滑入并停留在中心，当按下另一个按钮时，新内容执行相同操作，旧内容框离开右侧。任何帮助将不胜感激，我尝试通过使用大滑块来完成此操作，但导航已关闭，因此任何建议都将是一个巨大的奖励！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T22:03:02.390

一个可能的解决方案是使用 jQuery Plus Anchor 插件。

[http://css-plus.com/2011/03/plusanchor-jquery-plugin/](http://css-plus.com/2011/03/plusanchor-jquery-plugin/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T22:29:40.737

以与菜单项相同的顺序创建菜单对应的 div，并为每个 div 赋予相同的类和 css 属性（宽度、高度、位置：绝对），然后使用以下代码：

```
$(document).ready(function(){
$('.active').css('left', ($(window).width() - $('.active').outerWidth())/2);  
$('li').click(function(){
var ind = $(this).index(),
    activeSlide = $('.active'),    
    slide = $('.slide').eq(ind);
    if(!slide.hasClass('active')){
   slide.stop().animate({'left': ($(window).width() - slide.outerWidth()) / 2}, 300);
        activeSlide.animate({'left': $(window).width()}, 300, function(){
            activeSlide.css('left', - activeSlide.outerWidth());
        });
        activeSlide.removeClass('active');
        slide.addClass('active');   
    }
});        
$(window).resize(function(){
    $('.active').css('left', ($(window).width() - $('.active').outerWidth()) / 2);
});                  
}); 
```

有关 HTML 结构和 CSS 属性的更多详细信息，请参见此处的[DEMO ：](http://jsfiddle.net/arcm111/LTEqJ/)

# image-processing - OCR 处理前的图像预处理

> ID：15558537
> 
> 赞同：3
> 
> 时间：2013-03-21T21:30:00.420
> 
> 标签：image-processing, ocr, tesseract

我目前的项目涉及将 pdf 中的文本转录成文本文件，我首先尝试将图像文件直接放入 OCR 程序（tesseract），但效果不佳。原始图像文件基本上是旧报纸，并且有一些背景噪音，我确信 tesseract 有问题。因此，我尝试在将其输入 tesseract 之前使用一些图像预处理。有没有适合这种情况的开源图像预处理引擎的建议？？？以及如何使用它的说明将更加感激！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-21T21:38:38.713

我从未听说过为此目的的“*图像预处理引擎*”，但您可以查看[OpenCV](http://opencv.org/)（开源计算机视觉库）并实现自己的“*预处理引擎*”。**OpenCV**是一个计算机视觉库，它提供了许多功能来执行图像处理。

作为**预处理步骤**，您可能想要测试的一件有趣的事情是对图像应用**阈值**以去除噪音和东西。无论如何，我已经在**[这个线程](https://stackoverflow.com/a/11471322/176769)****中谈到了这种东西**。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-22T14:24:00.373

就像@karlphillip 提到的那样，我非常怀疑是否有一个现成的预处理引擎可用于您的目的，因为预处理技术与所需结果有很大差异。

清除噪声图像中文本的一些常用方法包括： 1\. 自适应阈值处理（Sauvola 或 Niblack 二值化） 2\. 应用尺寸略大于文本的中值滤波器来获得背景图像，然后从图像中减去背景原始图像（去除较大的噪点，如折痕、污渍、手写笔记等）。

OpenCV 实现了这些过滤器/二值化方法。如果您可以访问已发表的文献，那么在噪声文档的二值化方面有相当多的工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-10T06:05:19.760

查看[ScanTailor](http://scantailor.sourceforge.net/)。它具有令人印象深刻的预处理功能，并且是开源的。

# jira - 以编程方式创建自定义字段

> ID：15558546
> 
> 赞同：3
> 
> 时间：2013-03-21T21:30:29.193
> 
> 标签：jira, jira-plugin

我一直在尝试弄清楚如何使用 Atlassian SDK 在我的 Jira 插件中创建自定义字段，但是我在想知道文档和文档的同时遇到了几个问题。目前，我可以使用以下代码创建自定义字段：

```
CustomField fieldType = customFieldManager.getCustomFieldObjectByName("Type of Work");
    CustomFieldSearcher fieldTypeSearcher = customFieldManager.getCustomFieldSearcher("com.atlassian.jira.plugin.system.customfieldtypes:select");
    if(fieldType == null) {
        List<String> issueTypes = new ArrayList<String>();
        issueTypes.add("Story");

        List<String> contextTypes = new ArrayList<String>();
        //contextTypes.add(GlobalIssueContext.GLOBAL_CONTEXT_STR);
        contextTypes.add("Global");

        /*Collection<IssueType> list = constantsManager.getAllIssueTypeObjects();
        for(IssueType issueType : list) {
            if(issueType.getName().equals("Story")) {
                issueTypes.add(issueType);
            }
        }*/

        /*if(issueTypes.size() == 0)
            throw new Exception("Greenhopper must be installed!");*/

        CustomFieldType selectFieldType = customFieldManager.getCustomFieldType("com.atlassian.jira.plugin.system.customfieldtypes:select");
        try {
            CustomField typeOfWorkField = customFieldManager.createCustomField("Type of Work", "Used to track a stories type of work", selectFieldType, fieldTypeSearcher, contextTypes, issueTypes);
            //typeOfWorkField.
        } catch (GenericEntityException e) {
            writeMe += e.toString();
        }
    } 
```

我的问题在于设置 customFields 上下文和 issueTypes。我希望它能够在全球范围内和 greenhoppers Story Issue 中发挥作用。任何人都可以帮忙吗？另外，一旦我完成了设置，我想设置默认屏幕。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T15:29:39.067

[在这里](https://answers.atlassian.com/questions/16646/how-do-i-programatically-create-and-add-options-to-custom-fields-of-type-select-and-radiobutton)找到了我的问题的解决方案

# javascript - 在 AngularJS 中突出显示当前活动菜单的正确方法是什么？

> ID：15558552
> 
> 赞同：1
> 
> 时间：2013-03-21T21:30:57.213
> 
> 标签：javascript, angularjs, angular-routing

我有一个路由器，当某些路由处于活动状态时 - 我显示正确的模板。但是我的导航菜单与此不同步.. 将导航菜单与路由器同步的正确方法是什么？

我想过`NavigationCtrl`，但我需要特殊服务，这将是其他控制器和导航之间的一层......

目前我的导航是这样的：

```
var app = angular.module('Money', []);

app.config(['$routeProvider', function ($routeProvider) {
  $routeProvider
    .when('/', {
      templateUrl: 'general.html',
      controller: 'GeneralCtrl'
    })
    .when('/accounts', {
      templateUrl: 'accounts.html',
      controller: 'AccountsCtrl'
    });
}]);

app.controller('NavigationCtrl', ['$scope', '$rootScope', function ($scope, $rootScope) {
  // nothing right now
}]);

app.controller('GeneralCtrl', ['$scope', function ($scope) {
    $scope.model = {
      title: 'General page!'
    };
}]);

app.controller('AccountsCtrl', ['$scope', function ($scope) {
    $scope.model = {
      title: 'Accounts page!'
    };
}]); 
```

```
<div id="app" ng-app="Money">
  <div class="navbar navbar-inverse" ng-controller="NavigationCtrl">
    <div class="navbar-inner">
      <div class="container">
        <a class="btn btn-navbar" data-toggle="collapse" data-target=".navbar-responsive-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </a>
        <a class="brand" href="#">My money</a>
        <div class="nav-collapse collapse navbar-responsive-collapse">
          <ul class="nav">
            <li class="active"><a href="#">General</a></li>
            <li><a href="#accounts">Accounts</a></li>
          </ul>

          <ul class="nav pull-right">
            <li><a href="/logout">Sign out</a></li>
          </ul>
        </div><!-- /.nav-collapse -->
      </div>
    </div><!-- /navbar-inner -->
  </div>

  <ng-view></ng-view>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T21:45:00.383

-编辑-

Ben Nadel 很好地[解释了将 AngularJS 路由映射到 URL 参数和客户端事件](http://www.bennadel.com/blog/2420-Mapping-AngularJS-Routes-Onto-URL-Parameters-And-Client-Side-Events.htm)，那么为什么要重新发明轮子呢？

这是完整[的要点](https://gist.github.com/bennadel/3706530)。

[第 166 行](https://gist.github.com/bennadel/3706530#file-index-htm-L166)是更新第[44 行](https://gist.github.com/bennadel/3706530#file-index-htm-L44)`ng-class`导航项值中使用的变量的函数。

* * *

您可以`ng-class`与检查您更新的变量的函数结合使用`$scope`——大概是在您更改路线时。

```
$scope.isActive = function (url) {
    if (url == "#" + $scope.activeRoute) {
        return "on";
    } else {
        return "off";
    }
}; 
```

```
<ul class="nav" ng-cloak>
    <li ng-repeat="button in navigation" ng-class="isActive(button.url)">
        {{button.text}}
    </li>
</ul> 
```

# unit-testing - 使用 Cakephp 在组件单元测试中模拟 AuthComponent

> ID：15558557
> 
> 赞同：5
> 
> 时间：2013-03-21T21:31:16.220
> 
> 标签：unit-testing, cakephp, phpunit

我已经想出了如何在测试我的控制器时模拟 Auth 组件，但是在测试我的组件时我很难模拟 Auth 组件。我正在使用 cakephp2.0 和 phpUnit。

当我使用 ::generate() 时出现错误：调用未定义的方法 TestCalendarController::generate。

有没有办法模拟 Auth Component user() 函数？还是我需要重写组件以避免使用它？

谢谢！

日历组件测试

```
App::uses('Controller', 'Controller');
App::uses('CakeRequest', 'Network');
App::uses('CakeResponse', 'Network');
App::uses('ComponentCollection', 'Controller');
App::uses('CalendarComponent', 'Controller/Component');
App::uses('AuthComponent', 'Controller/Component');

class TestCalendarController extends Controller {

}

class CalendarComponentTest extends CakeTestCase {
    public $CalendarComponent = null;
    public $Controller = null;

public function setUp() {
        parent::setUp();
        // Setup our component and fake test controller
        $Collection = new ComponentCollection();
        $this->CalendarComponent = new CalendarComponent($Collection);
        $CakeRequest = new CakeRequest();
        $CakeResponse = new CakeResponse();
        $this->Controller = new TestCalendarController($CakeRequest, $CakeResponse);
        $this->CalendarComponent->startup($this->Controller);
}

//Here I am trying to mock the Auth component. I've tried a number of different things, and I'm not getting anything to work.
public function testAdjust() {
    $TestCalendar = $this->Controller->generate('TestCalendar', array(
        'components' => array(
            'Auth' => array('user')
        )
    ));
    $TestCalendar->Auth->staticExpects($this->any())
        ->method('user')
        ->will($this->returnValue(array('id'=>1, 'timezone'=>'America/Los_Angeles', 'type'=>'student')));

    // Test our adjust method with different parameter settings
    $this->CalendarComponent->calculate_parameters();

}

 public function tearDown() {
      parent::tearDown();
      // Clean up after we're done
      unset($this->CalendarComponent);
      unset($this->Controller);
  }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-10T18:53:40.880

我有同样的问题并找到了可能的解决方案，至少它对我有用。

为了获得一些提示，我将注意力集中在 cakephp 本身的测试用例上，特别是 AuthComponent 的测试用例[https://github.com/cakephp/cakephp/blob/master/lib/Cake/Test/Case/Controller/组件/AuthComponentTest.php](https://github.com/cakephp/cakephp/blob/master/lib/Cake/Test/Case/Controller/Component/AuthComponentTest.php)

它似乎包含对其他组件的模拟，例如：

```
$this->Auth->Session = $this->getMock('SessionComponent', array('renew'), array(), '', false); 
```

在你的情况下，你应该使用类似的东西：

```
$this->CalendarComponent->Auth = $this->getMock('Auth', array('user'));
$this->CalendarComponent->Auth->expects($this->any())->method('user')->with('id')->will($this->returnValue($user_id)); 
```

# html - 如何在 Joomla 编辑器中使用 div 实现表格？

> ID：15558559
> 
> 赞同：0
> 
> 时间：2013-03-21T21:31:33.543
> 
> 标签：html, joomla, vertical-alignment

我正在尝试将我的代码从 html 表更改为 Joomla 中的 div。我找到了一些答案，但我需要具体的指导。

1.  我有 3 x 3 表（每个窗口都可以容纳任何东西 - 文本、视频、图片......）
2.  使用表格时，很容易做到“垂直对齐”

现在我需要将带有表格的 html 翻译成 div。但...

1.  不能用css，应该是纯html
2.  我生成的 div“表”应该垂直对齐。

我没有发布任何代码，因为它只是一个 3 x 3 表......

**如果没有 CSS 就无法做到这一点，那么如何将我的 CSS 代码保存在 Joomla 的 JCE 编辑器中？它一直在评论它。**

这是代码的一部分：

```
<style>
#container {
    display: table;
    }
#row  {
    display: table-row;
    }
#left, #right, #middle {
    display: table-cell;
    padding-right: 15px;
    }
#left p, #right p, #middle p {
    margin: 20px 1px;
   }
</style>

<div id="container">
  <div id="row">
    <div id="left"> 
    </div>

    <div id="middle">
    </div>

    <div id="right">
    </div>
</div> 
```

这是我在编辑器中保存后看到的：

```
<p>
    <style type="text/css" scoped="scoped">
        <!-- #container {
            display: table;
        }
        #row {
            display: table-row;
        }
        #left, #right, #middle {
            display: table-cell;
            padding-right: 15px;
        }
        #left p, #right p, #middle p {
            margin: 20px 1px;
        }
        -->
    </style>
</p>
<div id="container">
    <div id="row">
        <div id="left">&nbsp;</div>
        <div id="middle">&nbsp;</div>
        <div id="right">&nbsp;</div>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-24T12:49:25.843

为什么不将自己的 CSS 文件添加到模板中？通过这种方式，您可以在整个站点中重复使用您的 CSS，而不是在您需要的每篇文章中使用 C&P？

YooTheme 为您提供了一个名为 custom.css 的文件，您可以对其进行编辑，`template manager/templates/yourtemplate name` 然后在右侧查找 custom.css。

RocketTheme 还提供了自定义文件，但您需要将其添加到 `templates/yourtemplatename/css`文件夹中 `yourtemplatename_custom.css`。您可以为此使用 ftp 或通过您的 CPanel/Plesk 上传它（如果您使用它）。其实JCE不是也在控制面板中添加了文件浏览器按钮吗？您也许可以通过它添加文件。

诚然，模板开发人员为他们的模板执行此操作的方式有很多，这可能会有点令人困惑，但是一旦您弄清楚了，它将为您节省数小时的工作时间。

想象一下，更改一个 CSS 条目并让您的所有文章都反映该更改，而无需编辑每个条目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T21:33:15.557

对于这样的布局，你不能使用`div`没有 CSS 的 s。

没有 CSS 是不可能的（即使那样，也不是直截了当的）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T21:43:39.950

在您的 Joomla 管理面板中：

组件 > JCE > 配置文件 > your_profile > 编辑器参数选项卡 > 高级选项卡：

允许 CSS (*) 是 ( ) 否

然后，转到站点 > 全局配置 > 文本过滤器并将您的过滤器类型设置为“无过滤”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T21:59:46.107

您应该尝试将样式标签中的 CSS 移动到`<head></head>`文档顶部的标签中。也许您的 css 被注释掉的原因是因为您已将其包含在`<p></p>`文档正文的标签中。

希望这是可以理解的。

# javascript - 如何在存储在 jQuery 变量中的 dom 树中查找节点？

> ID：15558562
> 
> 赞同：-1
> 
> 时间：2013-03-21T21:31:40.543
> 
> 标签：javascript, jquery

如果我在做什么`var $html = jQuery(html);`，我怎样才能在 $html 中找到一个元素？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T21:33:09.987

[.find()](http://api.jquery.com/find/)通常..

```
$html.find('#myElement'); // redundant, find my ID
$('#myElement'); // better
$html.find('.myClass'); // elements which share a class
$('.myClass'); // uses QSA
$html.find('[name="foo"]'); // an input perhaps 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T21:32:50.627

嗯：

```
var $html     = jQuery(html),
    some_elem = $html.find('.some_elem'); //finds elements with that class ? 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T21:34:48.703

您必须在内部使用带有 CSS 选择器的[find函数：](http://api.jquery.com/find/)

```
$html.find("#my.css.selector:last"); 
```

就像在 CSS 中一样，你也可以链接选择器：

```
$html.find("#my div.html span.tree"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T21:35:46.617

一个班轮...

```
var some_elem = $(html).find('#some_elem'); 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-03-21T21:33:05.287

您可以运行常规 jquery 选择

```
var $html = jQuery(html),
 elem_in_html= $html.find("#elem_in_html"); 
```

# javascript - 多线程还是不多线程 - JavaScript

> ID：15558563
> 
> 赞同：1
> 
> 时间：2013-03-21T21:31:42.103
> 
> 标签：javascript, multithreading

我目前正在试验一款类似于太空侵略者的 JavaScript 射击游戏。现在的编码方式，无论是带有移动的弹丸还是船。玩过原版的人都知道这不好。我记得在我的 Java 类中讨论过多线程，并且想知道这是否是正确的方法，还是有其他方法可以做到这一点？例如：

```
Thread Move start;
Thread Move run;
Thread Shoot start;
Thread Move run;
Thread Shoot run;
Thread Shoot end;
Thread Move run;
Thread Move end; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T21:42:19.127

您可以在 Javascript 中使用[WebWorkers](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=5&cad=rja&ved=0CGAQFjAE&url=http://ejohn.org/blog/web-workers/&ei=Pn5LUemaDYbqiwKogoH4Ag&usg=AFQjCNGX25uwxo9Rzd6FF8yjKKYjn3PPSQ&sig2=I_SDu4QS8V5jSRcl-jFpjg&bvm=bv.44158598,d.cGE)，但它们的行为与真正的多线程环境相差甚远，就像在 java 中一样。你将不得不对你的游戏开发采取不同的方法，使用一种循环技术来更新你的游戏逻辑，所有这些都在同一个线程下，对不起。:( 在 javascript 中为线程添加的支持仍然非常骗人，在我看来几乎是一个噱头，唯一的一种是 Chrome，因为您不一定要复制传递给线程的所有数据。这就是为什么线程在 javascript 中受挫：

1.  无法真正访问 dom
2.  大多数（如果不是全部）数据（取决于引擎）必须复制到其他线程，这意味着如果您想在后台处理大量数据，则必须先对该数据执行复制
3.  WebWorkers 上的错误并不总是很明显（有时你会遇到随机的、难以理解的错误）

WebWorkers 有很大的潜力，但对我来说，它们的使用受到了当时对它们的限制的严重限制。也许您可以在游戏中找到它们的巧妙用途。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T21:44:09.980

传统上，JavaScript 是单线程的，因此像在 Java 中使用的那样使用线程是不可行的。一个相对较新的 JavaScript 新增功能是提供真正的多线程的网络工作者（[此处为规范）。](http://www.whatwg.org/specs/web-workers/current-work/)但是，[浏览器之间的支持](http://caniuse.com/#feat=webworkers)有些不同，工作线程可以做的事情受到限制，线程之间的通信很痛苦。

您还可以使用[Clumpy.js 之](http://www.tumuski.com/code/clumpy/overview/)类的东西来模拟异步执行。

无论你做什么，重要的是不要阻塞主线程。整个浏览器窗口变得无响应。

# ruby-on-rails - 在 Jruby 中获取 CookieStore::CookieOverflow

> ID：15558566
> 
> 赞同：-1
> 
> 时间：2013-03-21T21:31:51.670
> 
> 标签：ruby-on-rails, ruby, jruby

我收到以下错误

```
Status: 500 Internal Server Error
  ActionController::Session::CookieStore::CookieOverflow
    D:\apps/Apache/tomcat-6.0.24/temp/1-epap/WEB-INF/vendor/rails/actionpack/lib/action_controller/session/cookie_store.rb:102:in `call'
    D:\apps/Apache/tomcat-6.0.24/temp/1-epap/WEB-INF/vendor/rails/actionpack/lib/action_controller/failsafe.rb:11:in `call'
    D:\apps/Apache/tomcat-6.0.24/temp/1-epap/WEB-INF/vendor/rails/actionpack/lib/action_controller/dispatcher.rb:106:in `call'
    D:/apps/Apache/tomcat-6.0.24/work/Catalina/localhost/epap/loader/rack/adapter/rails.rb:35:in `serve_rails'
    D:/apps/Apache/tomcat-6.0.24/work/Catalina/localhost/epap/loader/rack/adapter/rails.rb:40:in `call'
    D:/apps/Apache/tomcat-6.0.24/work/Catalina/localhost/epap/loader/jruby/rack/rails.rb:144:in `call'
    /D:/apps/Apache/tomcat-6.0.24/work/Catalina/localhost/epap/loader/rack/handler/servlet.rb:17:in `call'
    :1 
```

我正在尝试通过 ruby​​ 应用程序上传 excel 表。excel有大约1800行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T22:06:14.067

您尝试存储的信息量是问题所在。如[文档](http://guides.rubyonrails.org/security.html#session-storage)中所述：`Cookies imply a strict size limit of 4kB`。

# ios - iOS - 如何将 JSON 对象附加到 Web 请求？（不使用 NSURLConnection）

> ID：15558568
> 
> 赞同：0
> 
> 时间：2013-03-21T21:31:55.660
> 
> 标签：ios, json, web-services, nsdata, nsurlrequest

我正在尝试向我在我的网络服务器上设置的后端 API 发送一些网络请求。但是，为了使事情通用，我想将整个 JSON 对象发送到后端，并在那里对数据进行所有过滤以确定请求的用途、要传递的参数等。

我将从一个类向不同的服务发出许多请求，所以我不想使用 NSURLConnection，因为它必须过滤完成处理程序中的所有结果以确定最初获取哪个请求。

我喜欢 NSURLConnection 如何允许您像这样附加 JSON 对象，但我想知道如何使用不同的方法（比如 [NSData dataWithContentsOfURL:]）

```
NSMutableDictionary *postObject = [[NSMutableDictionary alloc] init];
[postObject setValue:@"login" forKey:@"request"];
[postObject setValue:inputUsername.text forKey:@"userName"];
[postObject setValue:inputPassword.text forKey:@"password"];

NSData *postData = [NSJSONSerialization dataWithJSONObject:postObject options:0 error:NULL];
NSString *postLength = [NSString stringWithFormat:@"%d", [postData length]];

NSMutableURLRequest *request = [[NSMutableURLRequest alloc] init];
[request setURL:[NSURL URLWithString:@"WEB_URL"]];
[request setHTTPMethod:@"POST"];
[request setValue:postLength forHTTPHeaderField:@"Content-Length"];
[request setValue:@"application/json" forHTTPHeaderField:@"Content-Type"];
[request setHTTPBody:postData];
[request setTimeoutInterval:20]; 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T22:44:20.897

我这样做的方法是创建一个带有 NSURLConnection 的 NSObject 类，并在该类上设置一个属性标签。然后你有 NSObject/NSURLConnection 类，当下载完成时，连接将自身返回给委托。您有一个像下面的 -(void)downloadFinished 示例这样的方法来处理委托中的回复。

在 NSObject 类中，您使用 NSJsonSerialization 将 NSDictionary 转换为 Json 并将其附加到 NSURLConnection。

我希望我可以将您链接到 Github 上的 JsonHelper 类，但是我还没有将它上传到 Github :(。

示例请求：

```
NSDictionary *post = [NSDictionary dictionaryWithObjectsAndKeys:@"Json_Value",@"Json_Key",nil];

JsonHelper *jsonHelper = [[JsonHelper alloc]initWithURL:@"http://mycoolwebservice.com" withDictionary:post
withMethod:@"POST" showIndicator:NO withDelegate:self withCache:NO];
[jsonHelper setTag:1];
[jsonHelper connectionStart]; 
```

代表回复示例：

```
-(void)downloadFinished:(id)sender
{
   if ([sender isKindOfClass:[JsonHelper class]]) {

    NSError *error = nil;
    JsonHelper *jsonHelper = (JsonHelper*)sender;
        NSData *data = [[NSData alloc]initWithData:jsonHelper.receivedData];
        NSString *returnString = [[NSString alloc]initWithData:data encoding:NSUTF8StringEncoding];    

    if (jsonHelper.tag == 0) {

    // Do Something
    }

    else if (jsonHelper.tag == 1) {

    // Do Something Else
    }
  }    
} 
```

使用这个例子编写自己的自定义类来做或多或少相同的事情应该不会太难。

# c++ - 在单链表中搜索节点

> ID：15558569
> 
> 赞同：-1
> 
> 时间：2013-03-21T21:31:58.203
> 
> 标签：c++, linked-list, singly-linked-list

我有由具有以下结构的节点组成的单链表：

```
struct date
{
    int day, month, year;       
};
struct Node
{
    string item;
    date Exp;
    int count;
    Node *link;
};
typedef Node* NodePtr; 
```

当我搜索到期日期时，我搜索时会显示所有其他节点，但不会显示第一个节点。当我也更改节点的顺序时会发生这种情况。这是一个简单的错误吗？

这是我用于搜索节点的函数：

```
NodePtr search_date(NodePtr head, int month, int day, int year)
{
    // Point to the head node
    NodePtr here = head;

    // If the list is empty nothing to search
    if (here == NULL)
        return NULL;

    // Search for the item    
    else{
        //while you have still items and you haven't found the target yet 
        while (here-> Exp.day != day && 
               here-> Exp.month != month && 
               here->Exp.year != year &&
               here->link != NULL) 
            here = here->link; 

        // Found the target, return the pointer at that location 
        if (here-> Exp.month == month &&
            here-> Exp.day == day &&
            here-> Exp.year == year) 
            return here;

        // Search unsuccessful, return Null 
        else 
            return NULL; 
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T22:11:46.967

@LiHO 基本上是正确的：您的比较逻辑有缺陷。

解决此问题的一个好方法是为`date`

```
struct date
{
    int day, month, year;

    bool operator==(const date &lhs, const date &rhs)
    {
      return (rhs.day == lhs.day) && (rhs.month == lhs.month) (rhs.year == lhs.year);
    }
}; 
```

然后你的循环简化为

```
NodePtr search_date(NodePtr head, const date &wantedDate)
{
  for (NodePtr p == head; p != NULL; p = p->link)
    if (p.Exp == wantedDate)
     return p;

  return NULL;
} 
```

警告。未经测试;-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T21:46:10.190

问题在于您的`while`陈述中的条件。假设您正在查找 date`03/21/2013`并且您将“检查”的第一个项目将具有 date `04/21/2013`。天数不相等，因此条件将被评估为`false`，即使有您要查找的日期的记录，您也永远无法找到它。

该函数可能如下所示：

```
NodePtr search_date(NodePtr node, int month, int day, int year)
{    
    // while there is some node still:
    while (node)
    {
        // if we found the right node, return it:
        if (node->Exp.month == month &&
            node->Exp.day == day &&
            node->Exp.year == year) 
            return node;

        // move to the next node:
        node = node->link;
    }

    // we haven't found it:
    return NULL;
} 
```

# list - 从列表列表中查找元素的位置

> ID：15558577
> 
> 赞同：1
> 
> 时间：2013-03-21T21:32:23.520
> 
> 标签：list, haskell

我想从列表列表中找到元素的位置。

例如，在给定的列表 [[1,2,3],[4,5,6],[7,8,9]] 我想找到 8 的位置。函数应该返回 [[3,2 ]]，即第三行第二列。如果列表是 [[1,2,8],[4,5,6],[7,8,9]] 那么它应该返回： [[1,3],[3,2]] 如果可以找不到那么它应该返回空列表

```
findPosition :: [[Int]]  ->  [(Int,Int)]
findPostion  ..  ? 
```

我想以最有效的方式做到这一点。谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T22:11:09.937

好的，让我们分解一下。

如果您只对正常的整数列表感兴趣，那么您有

```
 findPosition :: [Int] -> [Int] 
```

你怎么能实现呢？嗯，你需要输入你实际搜索的东西！

```
 findPosition :: Int -> [Int] -> [Int] 
```

嗯不错。所以内置`elem`函数会告诉你*你*想要的元素是否在那里。但我们想要它的*位置*。又怎样？好吧，您可以用它的位置“标记”每个元素，如下所示：

```
 label :: [x] -> [(Int, x)]
 label = zip [0..] 
```

现在我们可以使用它`filter`来查找所有项目：

```
 find :: (Eq x) => x -> [(Int, x)] -> [(Int, x)]
 find x0 = filter (\ (n, x) -> x == x0) 
```

但我们只想要实际位置，而不是`x`s（此时它们都是相同的）。所以我们可以`map fst`得到它。

全部组装起来，

```
 findPosition :: Int -> [Int] -> [Int]
 findPosition x0 = map fst . filter (\ (n, x) -> x == x0) . zip [0..] 
```

* * *

那太棒了！但是你想要一个整数列表*的列表，对吧？*

我建议您更改您的需求规范以将每个“坐标”作为元组而不是列表返回。也就是说，让它这样

```
findPosition 8 [[1,2,8],[4,5,6],[7,8,9]] => [(1, 3), (3, 2)] 
```

这样可能不会那么混乱。希望我已经给了你足够的提示来从这里弄清楚事情......

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-21T22:17:36.170

你的类型签名是错误的。它应该是

```
findPosition :: Eq a => a -> [[a]] -> [(Int, Int)] 
```

因为

*   您需要告诉函数要查找的值
*   没有理由仅限`findPosition`于搜索 s 列表的列表`Int`--- 它需要对内部元素做的就是比较它们是否相等
*   您的版本将返回一个总是长度为 2 的列表列表：如果内部列表为空或长度为 3，那将是一个错误；我们可以通过使用一对来排除这种错误的可能性

我也会`findPosition`产生从零开始的索引（Haskell 的标准列表函数使用的），而不是你要求的从一开始的索引。

所以我会有例如`findPosition 8 [[1,2,3],[4,5,6],[7,8,9]] = [(2, 1)]`。

* * *

可悲的是，Hoogle 不知道带有 type 的函数`Eq a => a -> [[a]] -> [(Int, Int)]`。但是搜索更简单的签名[`Eq a => a -> [a] -> [Int]`](http://www.haskell.org/hoogle/?hoogle=Eq%20a%20=%3E%20a%20-%3E%20%5ba%5d%20-%3E%20%5bInt%5d)（搜索列表而不是列表的类似函数）将我们指向[`elemIndices`](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-List.html#v%3aelemIndices)。我们可以在`findPosition`.

（哦，我太累了，无法完成这个。希望它能让你深思。）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-22T02:49:30.720

```
import Data.List

findPosition  :: Int -> [[Int]] -> [(Int,Int)]
findPosition n xs = fp n xs 0

fp n [] i = []
fp n (x:xs) i = p x ++ fp n xs (i+1)
    where 
      p x = zip (repeat i) (elemIndices n x) 
```

例子：

```
findPosition 3 [[2,3,4,3],[4,5,2,3],[],[3,2,5,6,3],[2],[3]]
   == [(0,1),(0,3),(1,3),(3,0),(3,4),(5,0)] 
```

如果将函数的类型签名更改为：

```
findPosition :: (Eq a1, Num a) => a1 -> [[a1]] -> [(a, Int)] 
```

您将有一个更通用的解决方案。例子：

```
findPosition 'a' ["car","small","caveat","big","","aah!"]
   == [(0,1),(1,2),(2,1),(2,4),(5,0),(5,1)] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-21T22:11:36.117

一个可能的解决方案：

```
import Control.Monad

findPosition :: Eq a => a -> [[a]] -> [(Int,Int)]
findPosition e ll = do
    let annotate = zip [1..]
    (i1,x) <- annotate ll
    (i2,y) <- annotate x
    guard $ y == e
    return (i1,i2) 
```

我们用索引注释列表和子列表中的每个元素，并使用 List 的 Monad 实例来搜索所有可能的出现。

# mysql - 小复杂的MYSQL join

> ID：15558580
> 
> 赞同：0
> 
> 时间：2013-03-21T21:32:36.717
> 
> 标签：mysql, join

我正在尝试向此函数添加类别参数：

```
 public function get_prog_channel($chaine_id = NULL, $nb = NULL, $debut = NULL) {
    $q = $this->db->select('*');
    $q->from($this->table_prog);
    if($nb !==NULL || $debut !== NULL){
    $q->LIMIT($nb, $debut);}

    if ($chaine_id !== NULL) {
        $q->where('channel_id', $chaine_id);
         $q->join($this->table_emission, 'programs.id=emissions.id');

                  return $q ->get()
                            ->result();
    } else {
        return $q->get()
                  ->result();

    }

} 
```

这是我的桌子：

*   程序（id，title，emission_id ...）
*   排放（id，....，channel_id） 类别（id，...）
*   rel_emission_categories(category_id,emission_id)

我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T23:09:12.087

您没有指定，但这看起来像是使用 CodeIgniter 框架的 PHP。如果是这样，请修改以下内容以满足您的需要。

```
$query="SELECT *
FROM table1 INNER JOIN table2 on table1.col=table2.col
WHERE table1.whatever=? AND table1.hello=?
LIMIT 1";
$params=array();
$params[]='whatever';
$params[]='world';

$result=$this->db->query($query,$params);
$result=$result->result_array();
print_r($result); 
```

# asp.net - IE 10 的 ASP.NET 身份验证失败

> ID：15558586
> 
> 赞同：2
> 
> 时间：2013-03-21T21:32:58.697
> 
> 标签：asp.net, .net, asp.net-mvc, iis, internet-explorer-10

今天我遇到了奇怪的问题。我的网站在 .NET 4 下的应用程序池上运行，今天我们注意到它无法在 IE 10 下对用户进行身份验证（使用其他浏览器一切正常）。这是引发的异常：

> “/”应用程序中的服务器错误。
> 
> 无法将“System.Security.Principal.GenericIdentity”类型的对象转换为“System.Web.Security.FormsIdentity”类型。说明：执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。
> 
> 异常详细信息：System.InvalidCastException：无法将“System.Security.Principal.GenericIdentity”类型的对象转换为“System.Web.Security.FormsIdentity”类型。

但是在将 .NET 4 升级到 4.5 版后，错误就消失了。奇怪的是，我们并没有更改应用程序池上 .NET 的版本，它仍然是 .NET 4。

顺便说一句，我正在使用自定义主体，并将 userData 附加到 AuthenticationTicket。这是我来自 Global.asax 的代码：

```
protected void Application_PostAuthenticateRequest(object sender, EventArgs e)
    {
        HttpCookie authCooke = Request.Cookies[FormsAuthentication.FormsCookieName];
        if (authCooke != null)
        {
            FormsAuthenticationTicket authTicket = FormsAuthentication.Decrypt(authCooke.Value);
            if (authTicket != null)
            {
                var identity = new GenericIdentity(authTicket.Name, "Forms");
                var principal = new CustomPrincipal(identity);

                string userData = ((FormsIdentity)(Context.User.Identity)).Ticket.UserData;
                var serializer = new JavaScriptSerializer();
                principal.User = (User)serializer.Deserialize(userData, typeof(User));

                Context.User = principal;
                Thread.CurrentPrincipal = principal;
            }
        }
    } 
```

谁能向我解释我做错了什么以及在不更改应用程序池的情况下更新 .NET 版本会如何影响站点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-13T13:26:08.183

我的网站上有类似的问题。身份验证仅在 IE10 中失败，但在 Firefox 和 IE8、IE9 中可以正常工作。为了解决这个问题，我在 web.config 中添加了参数 cookieless="UseCookies"

```
<authentication mode="Forms" >
  <forms loginUrl="~/Account/LogOn" timeout="2880" cookieless="UseCookies" />
</authentication> 
```

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2013-03-23T09:32:59.447

可能是由于您的代码拼写错误（HttpCookie authCooke）。它应该是“authCookie”吗？

# css - 我希望使用特定于正在查看的页面的正确文本块和音频文件加载某些 Div

> ID：15558587
> 
> 赞同：0
> 
> 时间：2013-03-21T21:33:00.053
> 
> 标签：css, image, text, load, external

这对图形来说非常简单。我有一个“外部”CSS 文件，它简单地列出了每个网页上两个不同位置的图形。每个页面的容器都单独编号（即，ID=upper6、lower6、upper7 等等）。外部 CSS 文件（imageref.css）只有一个列表：`#upper6 {background:url(path to graphic) no-repeat;)`等。

这些负载就好了。

为什么我不能对文本块（即#uppercaption6、#lowercaption6）执行此操作。我已经尝试了我能想到的所有排列（背景等）。

我想做同样的事情来填充每一页上的音频剪辑。我必须学习 jQuery 吗？在这里帮助一个排名初学者好吗？

根据要求，我因此扩展了我的困境：

在有问题的页面上，我最初加载 CSS 和一个像这样的文本文件：

```
<link rel="stylesheet" type="text/css" href="../includes/stylesheet.css" />
<link rel="stylesheet" type="text/css" href="../includes/imageref.css" /> 
```

第二个文件可能只是文本，因为它的格式如下：

```
#upper6 {background:url(../images/phone.png) no-repeat right 0px;}
#lower6 {background:url(../images/writing_utensils.png) no-repeat right 0px;} 
```

. . .

此处列出的图像链接是从 HTML 中的这一点调用的：

```
<figure id="photo_1"><a href="javascript:" onclick="upvis();" >
    <div class="figure_photo" id="upper6"></div></a></figure> 
```

并且所有网页都可以正常工作。

问题：我怎样才能对视频剪辑和文本块做同样的事情？

这些区域具有相同类型的列表，但不起作用。

```
<video class="video-container" preload="none" controls>
    <source class="vid_mp4" id="vid01" />
</video> 
```

或者，

```
<div class="CC_container">
    <div class="closed_caption" id="caption1" ></div>
</div> 
```

我很困惑，我可以通过引用它们的“ID”来轻松调用图形和照片，而不是视频剪辑或文本块。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T21:49:46.727

这可以使用“内容”属性来完成。

例如，您可以这样做：

```
<div class="CC_container">
<div class="closed_caption" id="caption1" >your dynamic text here: </div>
</div>

.closed_caption:after {
    content : " some text";
} 
```

[jsFiddle](http://jsfiddle.net/kpdhT/)

如果效果好，请告诉我。

# entity-framework - 实体框架误读函数导入新手上的存储过程

> ID：15558593
> 
> 赞同：0
> 
> 时间：2013-03-21T21:33:08.997
> 
> 标签：entity-framework

我不是 ef 方面的专家，所以这几乎可以肯定是我的错，但这里是……

知道为什么这个 sp 被导入 ef，而 ef 说它没有输出吗？

```
SELECT TaxiAuthority.AuthorityID, [Cardiff_region_1].NAME
FROM [Cardiff_region] AS [Cardiff_region_1] INNER JOIN YourCompany_TaxiAuthority ON Cardiff_region_1].ID = TaxiAuthority.LALinkID WHERE geom.STIntersects(@point) = 1; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T21:36:44.170

SQL 不解析。你有：

```
SELECT  TaxiAuthority.AuthorityID, [Cardiff_region_1].NAME
FROM    [Cardiff_region] AS [Cardiff_region_1] 
        INNER JOIN YourCompany_TaxiAuthority ON Cardiff_region_1].ID = TaxiAuthority.LALinkID 
WHERE geom.STIntersects(@point) = 1; 
```

`TaxiAuthority`不存在。尝试：

```
SELECT  TaxiAuthority.AuthorityID, [Cardiff_region_1].NAME
FROM    [Cardiff_region] AS [Cardiff_region_1] 
        INNER JOIN YourCompany_TaxiAuthority AS [TaxiAuthority] ON [Cardiff_region_1].ID = TaxiAuthority.LALinkID 
WHERE geom.STIntersects(@point) = 1; 
```

# batch-file - 是否可以显示用户列表？

> ID：15558598
> 
> 赞同：1
> 
> 时间：2013-03-21T21:33:15.660
> 
> 标签：batch-file

[http://pastebin.com/0fP0kiJC](http://pastebin.com/0fP0kiJC)

批处理文件

嗨，我想让用户查看哪些用户已登录系统，它是否可以读取它制作的 Accounts.UF 文件中列出的用户并显示它们？如果是这样，那将是一个很大的帮助。我所有的尝试似乎都没有奏效。

要测试修复它，请将其保存为批处理文件并运行它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T16:48:02.000

> 它是否有可能读取它制作的 Accounts.UF 文件中列出的用户并显示它们？

您可以在批处理脚本中使用以下行：

```
FOR /F "usebackq tokens=2" %%u IN (`FINDSTR "^username[^;]*$" %~dp0Accounts.uf`) DO ECHO %%u 
```

这假设您不允许用户名带有`;`，但您的批处理脚本似乎并没有首先检查无效的用户名。

# git - 确定 SSH 连接上的虚拟主机名（对虚拟 git 托管很有用）

> ID：15558601
> 
> 赞同：0
> 
> 时间：2013-03-21T21:33:19.810
> 
> 标签：git, networking, ssh

我正在寻找一种方法来执行 HTTP Host: 标头的功能，但 SSH 除外。

想象一下，`foo.example.com`双方`bar.example.com`都决心`1.2.3.4`。我怎样才能发现登录是通过`ssh git@foo.example.com`而不是发生的`ssh git@bar.example.com`？

我正在寻找`$SSH_CONNECTION`，但它只有客户端和服务器的 IP 地址，而不是主机名。

PS 我真正要问的是如何通过 SSH 传输使 git 虚拟主机工作。我的客户不是直接ssh，而是git调用ssh。我了解虚拟 git 托管可能可以通过 HTTP（使用 Host:）和 git-daemon（似乎被告知主机名是什么）工作。但是 SSH 呢？否则，我如何使（安全）提交在虚拟主机环境中工作？

如果不是：任何可以近似此的kludges？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T22:05:26.853

简单的答案是否定的，openSSH afaik 没有等效的虚拟主机。

问题实际上归结为您想向通过`foo.example.com`和登录的客户呈现什么不同`bar.example.com`？

我猜您只是想提供 2 组独立的根目录，用于根据他们使用的主机为您的客户端托管 git 存储库。如果是这种情况，您可以要求每个用户使用不同的用户名，从而他们可以访问具有适当隔离权限的不同主目录。git只是使用SSH协议将文件存储在服务器上，所以它应该是真正透明的。

如果您的案例涉及在单个 Xen 或等效服务器上拥有多个 VM，那么您可以考虑按照[本文](https://serverfault.com/questions/329529/virtual-hosts-for-ssh)中的描述从您的 Xen 服务器设置到多个 VM 的 SSH 网关。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-19T17:36:08.847

（**未来的答案**）去年似乎已经[讨论过将其添加到 SSH 中。](http://www.gossamer-threads.com/lists/openssh/dev/55943)对于`openssh`实施的建议是使用环境变量，以便在服务器上运行的脚本可以知道正在访问哪个虚拟主机。

# javascript - jqPlot DateAxisRenderer tickInterval 问题

> ID：15558604
> 
> 赞同：0
> 
> 时间：2013-03-21T21:33:24.303
> 
> 标签：javascript, jquery, jqplot

我正在使用 jqPlot 来说明一些时间序列数据。同时，我有一个下拉菜单，用于控制 x 轴（时间轴）的刻度间隔。滴答间隔可以动态更改，但最后一个滴答始终超出范围。

比如我的x轴上界是`Dec 1 1961`，开始日期是`Jan 2 1961`，时间间隔是`3 month`。然后轴上的最后一个刻度是`Jan 2 1962`，而不是实际的上限。所以我的问题是如何使刻度间隔仅在 x 轴边界内工作（比如在外推之前与上限进行比较）。谢谢！

这是我的情节的[演示](http://jsfiddle.net/godhong/aZwHL/#base)。

## 试着更好地解释一下自己。

1.  x 轴上的最后一个数字应该是数组 x_date2[300] 的最后一个元素。如果第一个日期 x_date[0] 和最后一个日期之间的差异可以除以刻度间隔的值，那么一切都很好。
2.  如果不是，除了作为上限的最后一个元素外，其他刻度之间的间隔应由下拉刻度间隔选择控制。

JS：

```
var x_water = [data are available on JSFIDDLE]
var x_date2 = [data are available on JSFIDDLE]
var x_date2_len = x_date2.length;
var paired = [];

for (var i = 0; i <= x_date2_len; i += 1) {
    paired.push([x_date2[i], x_water[i]]);
}

$('#calc1').click(function (range_interval) {
    var range_interval = $("#display_interval_1").val();
    createplot1(range_interval);
});

function createplot1(range_interval) {
    $.jqplot.config.enablePlugins = true;
    $('#chart1').empty();
    $.jqplot('chart1', [paired], {
        seriesDefaults: {
            showMarker: false,
            pointLabels: {
                show: false
            }
        },
        series: [{
            label: 'Water Concentrations'
        }],
        axes: {
            xaxis: {
                renderer: $.jqplot.DateAxisRenderer,
                tickRenderer: $.jqplot.CanvasAxisTickRenderer,
                tickOptions: {
                    formatString: '%#m/%#d/%Y',
                    angle: -30
                },
                min: x_date2[0],
                max: x_date2[300],
                tickInterval: range_interval,
                label: 'Date',
                pad: 0
            },
            yaxis: {
                label: 'Water Total (μg/L)',
                labelRenderer: $.jqplot.CanvasAxisLabelRenderer,
                pad: 0
            }
        },
        legend: {
            show: true,
            location: 'nw',
            placement: 'inside',
            fontSize: '11px'
        }
    })
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T22:16:37.760

在您的函数 createplot1 中，我将最大值：x_date2[300] 更改为最大值：x_date2[200]。我随机选择了这个数字来查看效果，现在它可以按照您的意愿工作。

# wpf - 如何将 x:key 从 dll 公开到主机应用程序

> ID：15558606
> 
> 赞同：1
> 
> 时间：2013-03-21T21:33:30.420
> 
> 标签：wpf, dll, key, resourcedictionary, skin

我创建了一个“主题引擎”，其中包含资源字典和自定义组合框来更改应用程序的外观。这包含在 .dll 文件中，目的是能够从任何新应用程序中引用此 .dll 并准备好皮肤逻辑。我已经相对轻松地解决了这个项目的大部分问题，但我留下了一个大问题......在调用 .dll 的应用程序中，可以使用背景设置元素的背景等属性= "{DynamicResource XKeyOfBrushIWantToUse}" 但有一个编译时警告指出“资源 "XKeyOfBrushIWantToUse" 无法解析。这是有道理的，因为 .dll 尚未加载。一旦我运行应用程序，它现在能够找到该资源并适当地使用它。我想要的是一种在编译时/设计时知道画笔 x:key 属性是什么的方法，这样当我将属性设置为一个值时，我就可以知道哪些选项可用。

例如，在我的 .dll 中有一个画笔 x:key="MainWindowBackgroundBrush"。此画笔的颜色属性会根据加载的包含颜色的资源字典而更改。（即 BlueColors.xaml 的颜色是 BackgroundColor，RedColors.xaml 也是如此。在运行时我可以交换颜色文件，尽管颜色的十六进制值现在不同，但画笔仍将指向“BackgroundColor”）现在当我去一个新的应用程序并引用.dll并设置一个按钮的背景颜色，我必须知道画笔的键是什么，因为我还没有找到从.dll中公开可用键的方法。

非常感谢您的帮助！！！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T21:49:28.207

[DevExpress](http://www.devexpress.com/)提出了一个有趣的方法来解决这个问题，他们基本上`Enums`为每个特定的元素和样式设置了一组，并且`MarkupExtension`从这个枚举中接收一个值并返回适当的字符串键。这样，您可以执行以下操作：

```
<Style BasedOn="{StaticResource {dxgt:GridRowThemeKey ResourceKey=CellStyle}}"> 
  <!-- and so on... --> 
```

# iphone - iphone 右边距

> ID：15558607
> 
> 赞同：1
> 
> 时间：2013-03-21T21:33:32.150
> 
> 标签：iphone, css, ipad

iphone中出现一个宽的右边距，所有的内容都是可见的。当我滑动 a 时，右侧间隙很大，我该如何解决这个问题。

我在用

`<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">`

@media screen and (max-width: 480px) {

```
body{
    width:100% !important;
    padding:0;
    margin:0;
    background-color:#1d1d1d;
    outline: 1px solid palegreen;
} 
```

}

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T21:37:57.613

您的页面上有一些东西在右侧突出。您可以在 Firefox 中使用检查元素或检查元素上的 3d 视图来确定它是什么元素，然后减小其宽度或调整其`display`规则。

# ios - 如何通过名称获取属性？如果我有`@"color"`，我如何获得`self.color`？

> ID：15558609
> 
> 赞同：1
> 
> 时间：2013-03-21T21:33:36.957
> 
> 标签：ios, objective-c, macos, cocoa-touch, cocoa

我正在通过 KVO 观察一个 NSDictionary，我在其中存储我的用户偏好。

更改首选项字典时，我想将类的属性更新为新值。

我有许多子类，每个子类都有不同的属性。我正在寻找一种在超类中拥有一个方法的方法，该方法可以正确地为任何子类的各种属性将 NSDictionary 中的值分配给属性。

```
//Observe when user toggles preferences
- (void)observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary *)change context:(void *)context 
{
    NSDictionary *prefs = [change objectForKey:NSKeyValueChangeNewKey];

    //I know I can do...
    //Subclass1
    self.isEnabled = [[prefs objectForKey:@"isEnabled"] boolValue];
    self.color = [[prefs objectForKey:@"color"];
    self.width = [[prefs objectForKey:@"width"];

    // -- or -- 

    //Subclass2
    self.isEnabled = [[prefs objectForKey:@"isEnabled"] boolValue];
    self.weight = [[prefs objectForKey:@"weight"];
    self.age = [[prefs objectForKey:@"age"];
    //...etc.

    //But I would prefer to do something like this... (Pseudocode)
    for (id key in prefs)
    {
        id value = [prefs objectForKey:key];
        [self propertyNamed:key] = value; // How can I accomplish this?
    }
} 
```

我知道我可以将方法子类化，并让每个子类使用自定义方法处理其特定属性。我正在寻找一种让超类处理所有子类的方法。

显然这里有很多情况......如果字典有一个键并且该属性在类中不存在，等等。让我们暂时忽略它。

有什么想法吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-21T21:38:07.997

请参阅[NSKeyValueCoding](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Protocols/NSKeyValueCoding_Protocol/Reference/Reference.html)。

```
[self setValue:... forKey:@"color"];
color = [self valueForKey:@"color"]; 
```

# php - simplexml_load_string 无法从 url 加载 xml

> ID：15558613
> 
> 赞同：0
> 
> 时间：2013-03-21T21:33:44.273
> 
> 标签：php

我正在尝试从 URL 中提取 XML 数据。它不是 XML 文件，而是基于请求字符串的响应。

```
$url = "http://eligibility.sc.egov.usda.gov/eligibility/eligibilityservice?eligibilityType=Property&requestString=<?xml version='1.0'?><Eligibility xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:noNamespaceSchemaLocation='/var/lib/tomcat5/webapps/eligibility/Eligibilitywsdl.xsd'><PropertyRequest StreetAddress1='".$street."' StreetAddress2='' StreetAddress3='' City='".$city."' State='".$state."' County='' Zip='".$zip."' Program='RBS'></PropertyRequest></Eligibility>";
$xml = simplexml_load_string($url); // requires allow_url_fopen to be on
$elg = (string)$xml->Property[Eligibility];

var_dump($xml); 
```

我想要的数据如下所示：

```
<Eligibility>
    <Adjusted AnnualIncome="" TotalDeduction="" AdjustedIncome="" ElderlyDeduction="" YoungDeduction="">
    </Adjusted>
    <Section502Guaranted MaximumAdjusted="" Eligible="">
    </Section502Guaranted>
    <Section502Direct MaximumAdjusted="" Eligible="">
    </Section502Direct>
    <Property Eligibility="UnableToVerifyAddress" MapURL="http://rdgdwe.sc.egov.usda.gov/eligibilitymaps/index.jsp?app=RBSIELG&ADDRESS=392 Spruce east alton&STATE=IL&ZIP=62024"/>
    <ErrorResponse EngineId="" HostName="" MaxSeverity="" LogFile="" Class="" Module="" Severity="" Time="">
        <Message Code="" Type="" Text=""/>
    </ErrorResponse>
</Eligibility> 
```

我回来的样子是这样的：

```
bool(false) bool(false) bool(false) bool(false) bool(false) bool(false) bool(false) bool(false) bool(false) bool(false) 
```

我不知道它为什么这样做。也没有错误发布。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T21:36:58.647

`simplexml_load_string()`需要格式正确的 XML 字符串，而不是 URL。你可能想试试`simplexml_load_file()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T21:40:03.153

**尝试这个：**

```
$url = "http://eligibility.sc.egov.usda.gov/eligibility/eligibilityservice?eligibilityType=Property&requestString=<?xml version='1.0'?><Eligibility xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xsi:noNamespaceSchemaLocation='/var/lib/tomcat5/webapps/eligibility/Eligibilitywsdl.xsd'><PropertyRequest StreetAddress1='".$street."' StreetAddress2='' StreetAddress3='' City='".$city."' State='".$state."' County='' Zip='".$zip."' Program='RBS'></PropertyRequest></Eligibility>";
$url_arr = explode( 'requestString=', $url );
$xml = simplexml_load_string( $url_arr[ 1 ] ); // requires allow_url_fopen to be on
$elg = (string)$xml->Property[Eligibility];

var_dump($xml); 
```

基本上，我只是分解你给出的 $url 以便格式良好的 xml 将被隔离在 $url_arr[ 1 ]

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T21:38:42.957

您需要从 $url 中删除以下内容：

```
http://eligibility.sc.egov.usda.gov/eligibility/eligibilityservice?eligibilityType=Property&requestString= 
```

因为 simplexml_load_string 函数采用格式正确的 XML 字符串，并且您在起始标记之前有一个 URL

# excel - 日期范围内的 VLOOKUP 日期

> ID：15558620
> 
> 赞同：1
> 
> 时间：2013-03-21T21:34:06.910
> 
> 标签：excel, if-statement, indexing, excel-2010, vlookup

有没有更简单的方法来完成这个任务？

我想在列表中查找一个值和一个日期，如果它匹配或在原始日期的 5 天内返回日期。

到目前为止，我能够做到这一点的唯一方法是创建一个辅助键 (A1) 并在辅助键列表 (F:F) 中查找辅助键，然后添加一个 IFERROR 以再次查找但添加 1 等等。

例子：

```
 A           B           C           D
1   table1_ky   table1_id   table1_dt   vlookup
2   99941275    999         1/1/2013    1/3/2013

    G           H           I
1   table2_ky   table2_id   table2_dt
2   99941277    999         1/3/2013 
```

D2中的公式：

> =IFERROR(VLOOKUP(TEXT(A2,0),F:H,3,0),IFERROR(VLOOKUP(TEXT(A2+1,0),F:H,3,0),IFERROR(VLOOKUP(TEXT(A2) +2,0),F:H,3,0),"否")))

我希望能够使“+1”的数量可变，这样我就可以将日期范围更改为 5、10、30 等，而不必使用多达 30 个 IFERROR 语句。

Excel中是否有可以执行此类操作的函数？

如果可能，我想避免使用 VBA。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T22:06:05.287

您可以使用这样的 LOOKUP 公式

`=IFERROR(LOOKUP(2,1/(G$2:G$100=B2)/(H$2:H$100>=C2)/(H$2:H$100<=C2+5),H$2:H$100),"no")`

这将在 H2:H100 中找到**最后一个**日期，该日期介于 C2 和 C2+5 之间，并且列 G 值也匹配 - 不需要任何“连接”辅助列，您可以将 5 调整为您想要的任何值。

“最后”是指位置 - 如果您想要在多个匹配的情况下最早的日期（这是您当前的公式所做的），那么切换到这样的“数组公式”：

`=IFERROR(SMALL(IF((G$2:G$100=B2)*(H$2:H$100>=C2)*(H$2:H$100<=C2+5),H$2:H$100),1),"no")`

用`CTRL`+ `SHIFT`+确认`ENTER`

# javascript - Ember.js 一个命名空间中的不同资源

> ID：15558621
> 
> 赞同：0
> 
> 时间：2013-03-21T21:34:10.533
> 
> 标签：javascript, ember.js, ember-data, ember-router

干杯! 我必须在 Rails 后端的一个命名空间中使用不同的资源：

```
 namespace :api, defaults: { format: :json } do
    resources :users, only: [:show] do
      collection do
        get 'profile'
      end
    end
    resource :music, only: [], controller: 'music' do
      collection do
        get 'search'
      end
    end
  end 
```

有没有办法在我的 rest_adapter 中分离命名空间 'api/users' 和 'api/music' ？

```
Bandyard.CustomAdapter = DS.RESTAdapter.extend({
  bulkCommit: false,
  url: "http://bandyard.dev",
  namespace: 'api/users'
}); 
```

如果我需要从 'api/music' 路径中获取 json 怎么办？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T22:43:26.157

> 如果我需要从 'api/music' 路径中获取 json 怎么办？

您只需将 ember 适配器的命名空间设置为“api”。Ember 数据的 REST 适配器将根据模型的名称向其添加“/music”或“/users”。

有关默认命名约定的详细信息，请参阅[其余适配器指南](http://emberjs.com/guides/models/the-rest-adapter/)。

> 我需要从'host/api/users/profile'和'host/api/music/search'中获取资源'profile'和'search'。如果我将适配器的命名空间设置为“api”，它将从“host/api/profiles”中获取“profile”资源

要为特定模型自定义端点，请考虑覆盖适配器上的**[buildURL 方法](https://github.com/emberjs/data/blob/master/packages/ember-data/lib/adapters/rest_adapter.js#L343)**。请参阅问题**[如何覆盖 RestAdapter 中单个模型的 URL](https://github.com/emberjs/data/issues/775)**

您可能还会发现这个拉取请求很有帮助：**[Expose buildURL suffix parameter in findQuery, filter](https://github.com/emberjs/data/pull/825)**

# java - 将二进制文件复制到 jar 之外

> ID：15558626
> 
> 赞同：2
> 
> 时间：2013-03-21T21:34:40.850
> 
> 标签：java, jar, exe, java.util.scanner, getresource

我有一个 exe 打包在我的 jar 文件中，我试图将它复制到一个临时位置，以便我可以使用它来运行它`Desktop.browse()`，为此我使用输入流构造函数设置了一个扫描仪`class.getResourceAsStream`，然后用一个`printwriter`写入所有到一个文件。出现的问题说exe无效。我认为这是由于丢失了一些二进制数据。如果有人可以提供帮助，请发表评论。

```
 Scanner sc = new Scanner(ClassBuilder.class.getResourceAsStream("jd-gui.exe"));
    File copy = new File("C://users//Owner//Desktop//java//jd-gui.exe");
    copy.createNewFile();
    PrintWriter writer = new PrintWriter(copy);

    while(sc.hasNextLine())
        writer.println(sc.nextLine());

    writer.flush();
    writer.close();
    sc.close();

    Desktop.getDesktop().browse(copy.toURI()); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-21T22:28:28.103

如前所述，将流用于二进制数据。Commons io 使复制流变得容易。就像是：

```
InputStream in = getClass().getResourceAsStream("jd-gui.exe");
OutputStream out = new FileOutputStream("jd-gui.exe");
IOUtils.copy(in, out); 
```

# javascript - 将 JSON 字符串转换为 JavaScript 数组

> ID：15558634
> 
> 赞同：-4
> 
> 时间：2013-03-21T21:35:19.840
> 
> 标签：javascript, json

我有大量（235）个 JSON 字符串，如下所示：

```
"57": {
    "ID": 6986,
    "Town": "Paris",
    "latitude": 48.8829447,
    "longitude": 2.3453532999999
},
"58": {
    "ID": 6987,
    "Town": "Paris",
    "latitude": 48.8749566,
    "longitude": 2.3588815000001
} 
```

我想做一个 JavaScript 数组。我在互联网上阅读了很多关于它的帖子，但所有这些似乎都不适合我的情况。我应该怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T21:37:00.847

您可以使用`JSON.parse()`

```
var javascriptObject = JSON.parse(jsonString); 
```

在旧浏览器中，您需要包含 json2.js 库：

[下载链接](https://github.com/douglascrockford/JSON-js)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-21T21:54:41.570

您发布的 JSON 有点损坏，看着它我假设它应该是一个具有包含对象的属性的对象：

```
{
    "57": {
            "ID": 6986,
            "Town": "Paris",
            "latitude": 48.8829447,
            "longitude": 2.3453532999999
    },
    "58": {
            "ID": 6987,
            "Town": "Paris",
            "latitude": 48.8749566,
            "longitude": 2.3588815000001
    }
} 
```

假设这一点，您首先需要使用以下方法将其转换为 JS 对象`JSON.parse`：

```
var obj = JSON.parse(jsonString); 
```

然后你需要把这个对象变成一个数组：

```
var i,
  arr = [];

for (i in obj) {
  if (obj.hasOwnProperty(i)) {
    arr.push(obj[i]);
  }
};

// arr now contains the array you were trying to get 
```

# java - 通过引用更新对象 (Suduko)

> ID：15558637
> 
> 赞同：0
> 
> 时间：2013-03-21T21:35:27.440
> 
> 标签：java, oop, object, pass-by-reference

我有一个数独难题求解器，需要我们使用递归。问题是我检查可用空间的布尔值应该通过引用更新当前位置，但事实并非如此。什么会导致这个？

```
 public boolean solve()
{
    Coordinate current = new Coordinate(); 

    if (findEmptyGridSlot(current)) {   // THE ERROR IS HERE **********  THIS IS SHOWING (0,0) STILL ******************

        for (int number = 1; number <= 9; number++)  
            if (canPlaceNumber(current, number)) { 
                grid[current.getRow()][current.getColumn()] = number; 

                if (solve()) 
                    return true; 

                grid[current.getRow()][current.getColumn()] = 0; 
            } return false;
    }else
        return true;

}

private boolean findEmptyGridSlot(Coordinate coordinate)
{
    boolean found = false;

    try{
        while (!found) 
        {
            if (grid[coordinate.getRow()][coordinate.getColumn()] == 0)
                found = true;
            else
                coordinate = coordinate.next(); // *****This is supposed to update the current coordinate ******
        }
    }catch (Exception e){
        //CREATE No Empty Cells Exception
    } 
    return found;
}

public Coordinate next()
{
    Coordinate result = new Coordinate(row, column);

    result.column++;
    if (result.column > MAX_COORDINATE)
    {
        result.column = MIN_COORDINATE;
        result.row++;
        if (result.row > MAX_COORDINATE) result = null;
    }

    return result;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T21:45:13.680

Java 按值传递。这意味着您将获得坐标参考的*副本。*如果您将该副本指向一个新对象（即`coordinate = coordinate.next`），那么您只是在更改本地副本。现在，另一方面，如果您更改了对象的属性，则您的变量引用（例如`coordinate.x = foo`或`coordinate.setX(foo)`）该更改将对您的方法的调用者可见。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T22:05:37.017

jpm 是正确的，但我第一次看错了，所以我要努力澄清

```
private boolean findEmptyGridSlot(Coordinate coordinate) 
```

引用是按值传递的。在这些术语中，“坐标”是一个装有一张纸的盒子，在这张纸上写着一个地址。坐标是一个只属于这个方法的盒子，它有自己的一张纸（很多张纸上可能写着相同的地址）

我们可以查看这个盒子并将东西“邮寄”到纸上写的地址，但是当我们说

```
coordinate=something 
```

这意味着在一张新纸上写下“某物”的地址。扔掉旧纸。

此操作绝不会影响第一张纸上有地址的原始“房子”。当我的朋友乔恩更新他的通讯录时，不管他写什么，我仍然住在我的房子里。

因此，如果坐标有一些简单的子结构（例如 x 和 y），您可以“发布”一条指令以将 x 和 y 更改为等于“下一个”。

或者作为 hack，您可以将 Coordinate 包含在另一个对象中，以便您可以向其发布指令以更改 hack 类指向的内容

评论中引用的测试代码：

```
public class Test {

    public static void main(String args[]){
        String bareMinObject="start";
        changeString(bareMinObject);
        System.out.println(bareMinObject); //Prints start, change string has no effect

    }

    public static void changeString(String input){
        String temp="end";
        input=temp;

    }

} 
```

# jquery - 我如何知道在进入下拉框后是否单击了按钮，该下拉框也将提交表单 jquery mvc

> ID：15558650
> 
> 赞同：0
> 
> 时间：2013-03-21T21:36:11.170
> 
> 标签：jquery, asp.net-mvc

我正在尝试创建一个表单，尽管用户已经输入了在焦点关闭时提交的下拉框：如果他们单击“清除”按钮，它将改为清除表单而不是保存值。

查询：

```
 $("#clearbtn").click(function () {
        alert("clear clicked");
        $(this).data("clicked", true);
    });

    if ($("#clearbtn").data("clicked") == true) {
        this.form.submit();
    }
    else {
        $("#MainContent_ddlCountry").blur(function () {
            $("#MainContent_txtCountrySelected").val($(this).val());
            this.form.submit();
        });
    } 
```

看法：

```
<%  var qryCountry = from c in dbPCCommon.Country
               orderby c.CountryDescription ascending
               select new { c.CountryId, c.CountryDescription };

            ddlCountry.DataSource = qryCountry;
            ddlCountry.DataTextField = "CountryDescription";
            ddlCountry.DataValueField = "CountryId";
            ddlCountry.SelectedValue = Model.CountryId.ToString();
            ddlCountry.DataBind();
%>
<tr>
<td class="labels">Country:</td>
<td>
<asp:DropDownList ID="ddlCountry" runat="server"  />
<%=Html.HiddenFor(a => Model.CountryId, new {@Value = ddlCountry.SelectedValue}) %>   
</td>                                   

</tr>
<asp:TextBox ID="txtCountrySelected" name = "txtCountrySelected" runat="server" /> 
```

但是，每次我运行这个 jQuery 时，它都会默认使用 else 语句。或者，我是不是完全走错了路？

编辑澄清：让我尝试两种情况。

场景 1：用户在表单中填写地址信息，他们的光标焦点移动到“国家/地区”的最后一个下拉框。这里的想法是，一旦用户关闭 Country 框（或失去焦点），它将提交表单并因此保存。这很好用。

场景2：现在，如果用户填写信息并且他们的光标焦点移动到“国家”的最后一个下拉菜单，他们决定通过单击屏幕上的“清除”提交按钮来清除整个表单。我希望这清除整个表单而不是提交条目。

我认为通过使用焦点在下拉框上的 .blur ，当用户单击按钮时它不会失去焦点并且应该清除表单，因为单击按钮时焦点没有移动。然而，我错了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T23:01:00.967

这是一个使用短计时器延迟来解决点击事件的工作解决方案：它可能不是理想的解决方案，但它确实有效。

```
$("#clearbtn").click(function () {
    $(this).data("clicked", true);
});

function submitForm(e) {
    if ($("#clearbtn").data("clicked") !== true) {
        $("#MainContent_txtCountrySelected").val($("#MainContent_ddlCountry").val());
        alert("we are submitting!");
        document.forms[0].submit();
    }
    else {
        alert("we are NOT submitting!");
    }
}

$("#MainContent_ddlCountry").blur(function () {
   setTimeout(submitForm,100);
}); 
```

# java - 删除Java中的第一个空格

> ID：15558651
> 
> 赞同：7
> 
> 时间：2013-03-21T21:36:13.843
> 
> 标签：java

如何删除 Java 中的第一个空格？

现在我正在使用这个：

```
if (str.charAt(0) == ' ') str = str.replace(" ", ""); 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-03-21T21:42:13.157

只需使用[`str.trim()`](https://docs.oracle.com/javase/7/docs/api/java/lang/String.html#trim())摆脱所有前导和尾随空格。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-03-21T21:36:56.920

使用[`replaceFirst()`](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#replaceFirst%28java.lang.String,%20java.lang.String%29)而不是`replace()`.

摆脱您可以使用的所有前导空格

```
str = str.replaceFirst("^ *", ""); 
```

这`^`只是为了确保空格实际上位于字符串的开头，这似乎是您想要的。如果不是这种情况，只需将其删除。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-21T21:43:29.457

您可以使用修剪（）

```
newString = stringToTrim.trim(); 
```

这将修剪字符串的两侧......开始和结束......不确定是否有帮助。

更多信息在这里... [http://docs.oracle.com/javase/7/docs/api/](http://docs.oracle.com/javase/7/docs/api/)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-21T21:38:36.120

您也可以使用[String.substring()](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#substring%28int%29)。

调用`s.substring(1)`将返回除字符串的第一个字符之外的所有内容`s`。

这适用于您的特定问题，因为您只想删除第一个字符（如果它是空格）。

```
if (str.charAt(0) == ' ') {
     str = str.substring(1);
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-21T21:38:45.107

你想要第一个还是第一个和最后一个？

[`trim()`](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/String.html#trim%28%29)将从字符串的开头和结尾删除您想要的内容。否则，Keppil 的答案有效。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-03-22T01:09:11.430

您可以将该`Character.isWhitespace`方法实现到您的代码中。

链接在这里： http: [//msdn.microsoft.com/en-us/library/aa989424 (v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/aa989424(v=vs.80).aspx)

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2021-02-02T16:49:58.867

```
 int charStartPos = 0;
  for (int i = 0; i < text.length(); i++) {
     Char character = text.charAt(i);
     if (character == ' ' || character == '\t' || character == '\n') {
        charStartPos = i + 1;
     } else {
        break;
     }
  }
  text = text.substring(charStartPos); 
```

# google-app-engine - 使用 FieldList 来自调用者的 protopc 读取列表

> ID：15558654
> 
> 赞同：4
> 
> 时间：2013-03-21T21:36:21.250
> 
> 标签：google-app-engine, python-2.7, google-cloud-endpoints, protorpc

我有一个 web 服务，它应该从调用者那里读取一个列表，做一些工作，然后返回一个响应。

```
 @endpoints.method(ARequestMessage, AResponseMessage,
                    name="call", path="call")
  def call(self, request):
    aList = request.in_list
    for stuff in aList:
       "do work here"
    return when I am done 
```

下面的`ARequestMessage`课程会起作用吗？

```
class ARequestMessage(messages.Message):
  name = messages.StringField(1, required=True)
  in_list = messages.FieldList(2, required=True) 
```

我不确定我`FieldList`在结构或上下文中的用法。请在响应中包含一些代码。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-21T21:50:08.473

`FieldList`不是要使用的，你想要的是`repeated=True`你的领域的参数：

```
class ARequestMessage(messages.Message):
  name = messages.StringField(1, required=True)
  in_list = messages.StringField(2, repeated=True) 
```

# sql - SQL Server 2008 的 T-SQL 查询：如何在匹配另一列时查询 X 行，其中 X 是查询中的值

> ID：15558658
> 
> 赞同：0
> 
> 时间：2013-03-21T21:36:39.303
> 
> 标签：sql, sql-server-2008, select

*概括：*

我有一个我试图分配给工作人员列表的工作项列表。每个工作最多只能分配 100 个工作项。每个工作项都指定了应该使用它的用户（关联为所有者）。

*例如：*

Jim 共有 5 个帐户，每个帐户具有多个工作项。吉姆总共有 50 项工作已经分配给他。我只能再分配 50 个。

*我的困境/目标：*

我正在使用一个临时表和一个 select 语句来获取每个所有者当前分配给他们的项目的数量，我计算新项目的可用插槽并将值存储在新列中。我需要能够从所有者与我的所有者列表及其可用项目（在临时表中）匹配的项目表中进行选择，仅检索每个用户的行数等于每个用户的可用插槽数 - 查询将只返回 50 行给 jim，即使可能有 200 行符合条件，而 sam 可能会得到 0 行，因为他没有可用的插槽，而在 items 表中有 30 个项目可供他使用。

我意识到我可能错误地处理了这个问题。我想避免使用游标。

编辑：添加一些示例代码

```
SELECT
nUserID_Owner
,   CASE
        WHEN COUNT(c.nWorkID) >= 100 THEN 0
        ELSE 100 - COUNT(c.nWorkID)
    END
,COUNT(c.nWorkID)   
FROM tblAccounts cic
LEFT JOIN tblWorkItems c
ON c.sAccountNumber = cic.sAccountNumber
AND c.nUserID_WorkAssignedTo = cic.nUserID_Owner
AND c.nTeamID_WorkAssignedTo = cic.nTeamID_Owner
WHERE cic.nUserID_Collector IS NOT NULL
AND nUserID_CurrentOwner = 5288
AND c.bCompleted = 0
GROUP BY nUserID_Owner 
```

这提供了 5288、50、50 的输出值（在 Jim 的场景中）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T20:58:27.327

它花费的时间比我想要的要长，但我找到了解决方案。

我确实使用了上面建议的子查询来生成具有用户唯一行数的工作项。

我使用 PARTITION BY 为每个工作人员生成唯一的行数，并在我的 HAVING 子句中包含行号必须小于可用插槽的计数。我会发布代码，但它超出了 char 限制，而且我还有很多东西要正确地更改为 anon 系统。

最初，我错误地解决了这个问题，专注于限制结果，而不是考虑创建必要的数据来关联结果集。

# c++ - 将此指针分配给对指针的右值引用

> ID：15558664
> 
> 赞同：12
> 
> 时间：2013-03-21T21:36:53.630
> 
> 标签：c++, c++11, rvalue-reference

下面的示例应该编译吗？

```
struct B;
struct A
{
  A(B*&&){}
};

struct B : A
{
  B() : A(this){}
};

int main(){} 
```

在带有 clang 的[LWS](http://liveworkspace.org/code/1v4bC9%241)上它可以编译，但是使用 gcc 我得到：

> 没有已知的参数 1 从 'B* const' 到 'B*&&' 的转换

如果我添加一个`const`它会编译。

我还想指出 MSVC 也弄错了：

> 无法将参数 2 从 'B *const' 转换为 'B *&&'

所以看起来我们在两个编译器中有一个错误。

**提交的错误**

[MSVC 错误链接](https://connect.microsoft.com/VisualStudio/feedback/details/781977/this-pointer-fails-to-bind-to-rvalue-reference-to-pointer)

[GCC 错误链接](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=56701)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-21T21:50:38.600

是的，那应该编译。

`this`实现为不正确`cv T* const`（其中 cv 是函数的 cv 限定符，如果有的话，并且`T`是类类型）。`this`is not `const`，仅仅是内置类型（不可修改）的纯右值表达式。

很多人认为因为你不能修改`this`它一定是`const`，但正如[Johannes Schaub - litb](https://stackoverflow.com/users/34509/johannes-schaub-litb)很久以前评论的那样，一个更好的解释是这样的：

```
// by the compiler
#define this (__this + 0)

// where __this is the "real" value of this 
```

很明显，你不能修改`this`（比如，`this = nullptr`），但也清楚 no`const`对于这样的解释是必要的。（而您在构造函数中的值只是临时值。）

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-21T21:43:42.747

我说 clang 是对的 - 代码应该编译。出于某种原因，GCC 认为`this`指针是`const`尽管有以下几点：

> 类的`this`成员函数中的类型`X`是`X*`。如果声明了成员函数`const`，则this的类型为`const X*`，如果声明了成员函数，则为this的`volatile`类型，如果声明`volatile X*`了成员函数，则为`const volatile`this的类型`const volatile X*`。

所以在这种情况下，`this`应该是一个纯右值`B*`并且完全可以绑定到`B*&&`. 但是，请注意，当绑定`this`到右值引用时， 的值`this`将被复制到临时对象中，而引用将被绑定到该临时对象。这可确保您永远不会实际修改原始`this`值。

> 对“cv1”类型的引用由“cv2 `T1`”类型的表达式初始化，`T2`如下所示：
> 
> *   [...]
>     
>     
> *   [...] 或**引用应为右值引用**。
>     
>     
>     *   如果初始化表达式
>         
>         
>         *   是 xvalue、类 prvalue、数组 prvalue 或函数 lvalue 和 [...]，或
>             
>             
>         *   有一个类类型（即 T2 是一个类类型），[...]
>             
>             
>         
>         然后 [...]
>         
>         
>     *   **否则**，将使用非引用复制初始化 (8.5) 的规则从初始化表达式创建并初始化“cv1 T1”类型的临时变量。然后将引用绑定到临时文件。[...]

# c# - 使用 C# 中对象的值写入文件

> ID：15558670
> 
> 赞同：1
> 
> 时间：2013-03-21T21:37:03.307
> 
> 标签：c#, asp.net, web-applications, asp.net-mvc-4

我使用此代码的目标是使用 foreach 循环遍历每个对象并将当前字符串值写入 txt 文件。

我使用“Woof”和“Bull”作为测试。Bull 是我的 AverageValues 类中的字符串变量。

不幸的是，它目前不会将 Bull 的值写入文件，但是，它会创建文件。

我认为这很容易解决，我现在似乎无法找到它。

所有帮助将不胜感激！

```
 public void doStuff()
    {
        AverageValues AVS = new AverageValues();
        AVS.Bull = "Woof";
        string path = "C:\\users\\kjenks11\\Averages.txt";
        FileStream NewFile = File.Create(path);
        StreamWriter writeIt = new StreamWriter(NewFile);
        List<AverageValues> AV = new List<AverageValues>();
        AV.Add(AVS);

        foreach (var value in AV)
        {
                writeIt.Write(value.Bull);
        } 
        NewFile.Close();
     } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T21:38:46.703

[在关闭文件本身之前刷新](http://msdn.microsoft.com/en-GB/library/system.io.stream.flush.aspx)或关闭流：

```
foreach (var value in AV)
{
     writeIt.WriteLine(value.Bull);
}
writeIt.Flush();
writeIt.Close(); 
```

关于样式的注意事项 - 当创建`Stream`（任何类型的），或者更确切地说，任何实现的对象时，使用[语句](http://msdn.microsoft.com/en-gb/library/yh598w02.aspx)`IDisposable`创建它：[`using`](http://msdn.microsoft.com/en-gb/library/yh598w02.aspx)

```
using(var writeIt = new StreamWriter(NewFile))
{
  // use writeIt here - it will dispose properly
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-21T21:40:02.333

您需要刷新才能将数据写入文件。完成后，您还可以考虑向编写器添加 using 语句以释放资源。

```
public void doStuff()
{
  AverageValues AVS = new AverageValues();
  AVS.Bull = "Woof";
  string path = "C:\\users\\kjenks11\\Averages.txt";
  using (var NewFile = File.Create(path))
  {
    using (var writeIt = new StreamWriter(NewFile))
    {
      List<AverageValues> AV = new List<AverageValues> {AVS};
      foreach (var value in AV)
      {
        writeIt.Write(value.Bull);
      }
    }
  }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-21T21:44:37.837

如果您`using`在流周围使用，则无需显式调用刷新和关闭。一旦您离开`using`块的范围，流将被关闭和处置。收盘价会为你叫同花顺。

```
 public void doStuff()
    {
        AverageValues AVS = new AverageValues();
        AVS.Bull = "Woof";
        string path = "C:\\users\\kjenks11\\Averages.txt";
        FileStream NewFile = File.Create(path);
        List<AverageValues> AV = new List<AverageValues>();
        AV.Add(AVS);

        using(StreamWriter writeIt = new StreamWriter(NewFile))
        {
           foreach (var value in AV)
           {
                writeIt.Write(value.Bull);
           } 
        }
       NewFile.Close();
    } 
```

# entity-framework - 无法使用泛型创建 EF 代码优先映射类

> ID：15558672
> 
> 赞同：1
> 
> 时间：2013-03-21T21:37:08.713
> 
> 标签：entity-framework, ef-code-first, entity-framework-5

我有几个相同的实体，除了每个都映射到相应的相同表的类名。每个表的映射类似于以下内容：

```
modelBuilder.Entity<Foo>().Map(x =>
{
  x.MapInheritedProperties();
  x.ToTable("Foo");
}) 
```

这种方法有效，但重复。

我创建了这个类，希望摆脱重新定位。为简洁起见，此处对其进行了简化。

```
public class Generic<T>
{
    public Generic(DbModelBuilder modelBuilder, string tableName)
    {
        modelBuilder.Entity<T>().Map(m =>
        {
            m.MapInheritedProperties();
            m.ToTable(tableName);
        });
    }
} 
```

我收到以下我不理解的编译器错误：

```
The type 'T' must be a reference type in order to use it as parameter 'TEntityType' in the generic type or method 'System.Data.Entity.DbModelBuilder.Entity<TEntityType>()' 
```

*   像许多 .Net 编码器一样，我经常使用泛型，但不经常编写它们。
*   我使用 EF 有一段时间了，但我对 Code First 还是很陌生
*   我在 SO 上下进行了很多搜索，但没有运气。
*   我究竟做错了什么？我不明白什么？

在此先感谢，吉姆

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T21:43:58.727

只需添加通用参数约束`where T : class`：

```
public class Generic<T>
   where T : class
{
    public Generic(DbModelBuilder modelBuilder, string tableName)
    {
        modelBuilder.Entity<T>().Map(m =>
        {
            m.MapInheritedProperties();
            m.ToTable(tableName);
        });
    }
} 
```

方法上存在相同的约束`DbModelBuilder.Entity<T>`，这就是为什么在泛型类中需要相同的约束。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-21T21:48:01.307

该错误表明您的泛型缺少`class`约束。[在此处阅读](http://msdn.microsoft.com/en-us/library/d5x73970.aspx)有关“类型参数的约束”的信息。

所以`Generic<T>`应该声明为

```
public class Generic<T> where T: class
{
    public Generic(DbModelBuilder modelBuilder, string tableName)
    {
        modelBuilder.Entity<T>().Map(m =>
        {
            m.MapInheritedProperties();
            m.ToTable(tableName);
        });
    }
} 
```

但我建议使用[EntityTypeConfiguration](http://msdn.microsoft.com/en-us/library/gg696117%28v=vs.103%29.aspx)。此类将允许您将实体映射与上下文分离并实现您想要的一种继承。

例如：

```
public abstract class EntityConfiguration<T> : EntityTypeConfiguration<T>
    where T : Entity
{
    protected EntityConfiguration()
    {
        ToTable(typeof(T).Name);

        // All primary keys are named as <EntityName>Id
        Property(e => e.Id)
            .HasColumnName(typeof(T).Name + "Id");
    }
} 
```

此类声明所有实体都将具有到名称等于类型名称的表的映射，并且每个表都有一个带有名称的主键列`<TableName>Id`。

然后实体的映射配置`Foo`可以声明如下：

```
public class FooConfiguration : EntityConfiguration<Foo>
{
    public FooConfiguration()
    {
        Map(m => m.MapInheritedProperties());
        // add you mapping logic here
    }
} 
```

然后配置应该在 DbContext 中注册：

```
public class MyDbContext : DbContext
{
    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        modelBuilder.Configurations.Add(new FooConfiguration());
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T21:49:01.447

EF 提供了一个允许您执行此操作的类：

```
class SomeEntityMapping : EntityTypeConfiguration<SomeEntity>
{
    public SomeEntityMapping()
    {
        ToTable("My_Entity");
        HasKey(e => e.Id);
        //...
    }
} 
```

然后，在您的 DbContext 中，覆盖 OnModelCreating 并将映射添加到配置中：

```
protected override void OnModelCreating(DbModelBuilder builder)
{
   builder.Configurations.Add(new MyEntityConfiguration());
} 
```

# android - Android 用 Path 画圆

> ID：15558673
> 
> 赞同：5
> 
> 时间：2013-03-21T21:37:08.803
> 
> 标签：android, android-animation, bezier

我正在尝试绘制一个圆圈的动画。在我的自定义视图中，我有

```
private final Paint mPaint = new Paint() {
    {
        setDither(true);
        setStyle(Paint.Style.STROKE);
        setStrokeCap(Paint.Cap.ROUND);
        setStrokeJoin(Paint.Join.ROUND);
        setColor(Color.BLUE);
        setStrokeWidth(30.0f);
        setAntiAlias(true);
    }
};
...
protected void onDraw(Canvas canvas) {
    super.onDraw();
    if (mOval == null) {
        mOval = new RectF(getLeft(), getTop(), getRight(), getBottom());
    }
    if (mPath == null) {
        mPath = new Path();
    mPath.moveTo(0, getHeight() / 2);
    }

    float sweepAngle = Math.min((float) mElapsedTime / 1000 * 60 * 1, 1) * 360;
    if (sweepAngle == 0) {
        mPath.reset();
    } else if (mCurrentAngle != sweepAngle) {
    mPath.arcTo(mOval, mCurrentAngle, sweepAngle);
    }
    mCurrentAngle = sweepAngle;
    canvas.drawPath(mPath, mPaint);
} 
```

每隔一段时间，我就会更新`mElapsedTime`和调用`invalidate()`. 但是，屏幕上没有绘制任何内容。我尝试了几种变体，但无济于事。有什么我做错了吗？有没有更简单的方法来做到这一点？给定一个圆圈的百分比，我希望能够使圆圈的大部分成为屏幕上绘制的内容。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-21T23:15:23.953

这里有两件事：

1.  `canvas.drawOval(...)`在将弧线绘制到椭圆上之前，您必须先打电话。否则不会出现。这就是为什么我的方法不起作用的原因。

2.  `Canvas`有一个`drawArc`方法，它需要一个起始角度和一个度数来扫除。见[`Canvas.drawArc(RectF, float, float, boolean, Paint)`](https://developer.android.com/reference/android/graphics/Canvas.html#drawArc(android.graphics.RectF,%20float,%20float,%20boolean,%20android.graphics.Paint))。这就是我要画圆圈的东西。

**编辑：**这是我的子类中的相关代码`View`：

```
private final Paint mArcPaint = new Paint() {
    {
        setDither(true);
        setStyle(Paint.Style.STROKE);
        setStrokeCap(Paint.Cap.ROUND);
        setStrokeJoin(Paint.Join.ROUND);
        setColor(Color.BLUE);
        setStrokeWidth(40.0f);
        setAntiAlias(true);
    }
};

private final Paint mOvalPaint = new Paint() {
    {
        setStyle(Paint.Style.FILL);
        setColor(Color.TRANSPARENT);
    }
};

@Override
protected void onDraw(Canvas canvas) {
    super.onDraw(canvas);
    RectF mOval = new RectF(left, top, right, bottom); //This is the area you want to draw on
    float sweepAngle = 270; //Calculate how much of an angle you want to sweep out here
    canvas.drawOval(mOval, mOvalPaint); 
    canvas.drawArc(mOval, 269, sweepAngle, false, mArcPaint); //270 is vertical. I found that starting the arc from just slightly less than vertical makes it look better when the circle is almost complete.
} 
```

# xamarin.ios - MonoTouch UIButton 渐变覆盖标题

> ID：15558674
> 
> 赞同：0
> 
> 时间：2013-03-21T21:37:10.973
> 
> 标签：xamarin.ios, uibutton, xamarin

我有一个与这篇文章类似的问题（[UIButton: Add gradient layer and title is not displayed – how to fix?](https://stackoverflow.com/questions/4780310/uibutton-add-gradient-layer-and-title-is-not-shown-anymore-how-to-fix)）但他的解决方案对我不起作用。首先，我对 MonoTouch 有点陌生，但从来没有定制过开箱即用的控件。

我正在尝试向我的按钮添加渐变，但是当我这样做时，渐变看起来完全符合我的要求，但文本被覆盖（我将渐变的不透明度设置为 0.5 以进行测试）。我有一个故事板，我在其中直观地设计了界面，但想调整一些东西。

这是我的代码：

```
var gradient = new CAGradientLayer();
gradient.Frame = getStartedButton.Layer.Bounds;
gradient.Colors = new MonoTouch.CoreGraphics.CGColor[]
{
    UIColor.FromRGB (23, 55, 94).CGColor,
    UIColor.FromRGB (33, 81, 141).CGColor
};

getStartedButton.Layer.AddSublayer(gradient);
getStartedButton.Layer.CornerRadius = 10;
getStartedButton.Layer.BorderColor = UIColor.White.CGColor;
getStartedButton.Layer.BorderWidth = 1;

getStartedButton.VerticalAlignment = UIControlContentVerticalAlignment.Center;
getStartedButton.Font = UIFont.FromName("Helvetica", 12);
getStartedButton.SetTitleColor(UIColor.White, UIControlState.Normal);

getStartedButton.SetTitle("Get Started", UIControlState.Normal); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T00:26:33.883

尴尬，但这只是在 XCode 中将按钮类型更改为自定义的问题。

# sql - SQL 层次结构和连接表计数

> ID：15558676
> 
> 赞同：1
> 
> 时间：2013-03-21T21:37:18.187
> 
> 标签：sql, recursion

我有一个员工表和一个项目表。员工只能在 1 个项目中，并将员工表作为具有 ID 和 ReportsTO ID 的层次结构。我需要获得项目的计数，其中经理计数将是他手下员工的总数，依此类推......

```
 DECLARE @Employees TABLE (EmpID INT, EmpName VARCHAR(20), ReportsTo INT)
INSERT INTO @Employees(EmpID, EmpName, ReportsTo)
  SELECT 1, 'Jacob', NULL UNION ALL
  SELECT 2, 'Rui', NULL UNION ALL
  SELECT 3, 'Jacobson', NULL UNION ALL
  SELECT 4, 'Jess', 1 UNION ALL
  SELECT 5, 'Steve', 1 UNION ALL
  SELECT 6, 'Bob', 1 UNION ALL
  SELECT 7, 'Smith', 2 UNION ALL
  SELECT 8, 'Bobbey', 2 UNION ALL
  SELECT 9, 'Steffi', 3 UNION ALL
  SELECT 10, 'Bracha', 3 UNION ALL
  SELECT 11, 'John', 5 UNION ALL
  SELECT 12, 'Michael', 6 UNION ALL
  SELECT 13, 'Paul', 6 UNION ALL
  SELECT 14, 'Lana', 7 UNION ALL
  SELECT 15, 'Johnson', 7 UNION ALL
  SELECT 16, 'Mic', 8 UNION ALL
  SELECT 17, 'Stev', 8 UNION ALL
  SELECT 18, 'Paulson', 9 UNION ALL
  SELECT 19, 'Jessica', 10

DECLARE @Projects Table (ID INT,EMPID INT, PROJNAME VARCHAR(50))
INSERT INTO @PROJECTS(ID,EMPID,PROJNAME)  
    SELECT 1,19,'ABCD' UNION ALL
    SELECT 2,5,'EFGH'   UNION ALL

    SELECT 3,16,'ADAD'  UNION ALL

    SELECT 4,6,'FSDFSD' UNION ALL
    SELECT 6,8,'DSDSDSD' UNION ALL
    SELECT 6,8,'DSDSADDSD'

--Solution starts here
DECLARE @manager VARCHAR(20)
SELECT @manager ='JACOB'

--CTE
;With Hierarchy(EmpName, EmpID, Level, FullyQualifiedName)
As
(
  Select E.EmpName, E.EmpID, 0, Cast('.'+E.EmpName+'.' as Varchar(MAX))
    From @Employees E
    Where E.ReportsTo is null
  Union all
  Select E.EmpName, E.EmpID, H.Level+1, H.FullyQualifiedName+'.'+E.EmpName+'.'
    from @Employees E
    inner join Hierarchy H on H.EmpID=E.ReportsTo
)

--Result
Select Space((Level-(Select Top(1) Level from Hierarchy H2 Where H2.EmpName=@manager))*4) + EmpName
  from Hierarchy H
  where CHARINDEX('.'+(Select Top(1) E.EmpName from @Employees E Where E.EmpName=@manager)+'.', H.FullyQualifiedName) > 0
  order by H.FullyQualifiedName 
```

我如何获得每个员工的项目计数？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T22:40:26.847

经理汇总项目所有员工的数量。

```
--Result
Select Space((Level-(Select Top(1) Level from Hierarchy H2 Where H2.EmpName=@manager))*4) + EmpName,
       COALESCE(CASE WHEN ID IS NOT NULL THEN 1 END,
       CASE WHEN Level = 0 THEN SUM(CASE WHEN ID IS NOT NULL THEN 1 END) OVER() END, 0) AS cnt
from Hierarchy H LEFT JOIN @PROJECTS p ON H.EMPID = p.EMPID
where CHARINDEX('.'+(Select Top(1) E.EmpName from @Employees E Where E.EmpName=@manager)+'.', H.FullyQualifiedName) > 0
order by H.FullyQualifiedName 
```

[**SQLFiddle**](http://sqlfiddle.com/#!3/d41d8/11401)上的演示[](http://sqlfiddle.com/#!3/d41d8/11401)

 **或者试试这个

```
--Result
Select Space((Level-(Select Top(1) Level from Hierarchy H2 Where H2.EmpName=@manager))*4) + EmpName,       
       CASE WHEN Level = 0 THEN SUM(CASE WHEN ID IS NOT NULL THEN 1 END) OVER() END AS totalCnt,
       CASE WHEN ID IS NOT NULL THEN 1 END AS cntSingle,              
       o.cntChild
from Hierarchy H OUTER APPLY (
                              SELECT COUNT(p.PROJNAME) AS cntChild
                              FROM @Employees e LEFT JOIN @PROJECTS p ON e.EmpID = p.EMPID
                              WHERE h.EmpID = e.ReportsTo
                              ) o
                 LEFT JOIN @PROJECTS p ON H.EMPID = p.EMPID                           
where CHARINDEX('.'+(Select Top(1) E.EmpName from @Employees E Where E.EmpName=@manager)+'.', H.FullyQualifiedName) > 0
order by H.FullyQualifiedName 
```**

# python - 如何使用python将文本文件拆分为多个文本文件

> ID：15558677
> 
> 赞同：0
> 
> 时间：2013-03-21T21:37:32.537
> 
> 标签：python, python-2.7

我有一个巨大的文本文件，其中包含这样的数据集

```
EOG61ZHH8   ENSRNOG00000004762  627
EOG61ZHH8   ENSRNOG00000004762  627
EOG61ZHH9   ENSG00000249709 1075
EOG61ZHH9   ENSG00000249709 230
EOG61ZHH9   ENSG00000249709 87
EOG61ZHHB   ENSG00000134030 2347
EOG61ZHHB   ENSG00000134030 3658
EOG61ZHHB   ENSRNOG00000018342  241
EOG61ZHHB   ENSRNOG00000018342  241
EOG61ZHHC   ENSBTAG00000006084  1159
EOG61ZHHC   ENSG00000158828 820
EOG61ZHHC   ENSMMUG00000000126  631 
```

我想像这样转换或拆分它

```
EOG61ZHH8.txt
ENSRNOG00000004762  627
ENSRNOG00000004762  627
EOG61ZHH9.txt
ENSG00000249709 1075
ENSG00000249709 230
ENSG00000249709 87 
```

等等。我不知道从哪里开始从上面的文本文件中获取新的 txt 文件，我之前做过这件事，但是条目在条目开始之前有 '[' 符号，现在我有很多文件但没有任何特殊符号来转换它们这个是我在 python 中完成的代码

```
with open("entry.txt") as f: 
  for line in f:
    if line[0] == "[":
     if out: out.close()
     out = open(line.split()[1] + ".txt", "w")
   else: out.write(line)' 
```

我在windows中使用它，所以我知道linux awk命令，所以不需要关于linux的信息

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T21:47:33.353

You need only a few adjustments to your script:

```
out = None
oldfile = None
with open("entry.txt") as f: 
    for line in f:
        newfile = l.split("\t")[0]
        if newfile != oldfile:
            if out: out.close()
            out = open(newfile + ".txt", "w")
            oldfile = newfile
        out.write("\t".join(line.split("\t")[1:])) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T22:01:19.880

使用正则表达式；

```
import re

string = '    EOG61ZHH8   ENSRNOG00000004762  627    EOG61ZHH8   ENSRNOG00000004762  627    EOG61ZHH9   ENSG00000249709 1075    EOG61ZHH9   ENSG00000249709 230    EOG61ZHH9   ENSG00000249709 87    EOG61ZHHB   ENSG00000134030 2347    EOG61ZHHB   ENSG00000134030 3658    EOG61ZHHB   ENSRNOG00000018342  241    EOG61ZHHB   ENSRNOG00000018342  241    EOG61ZHHC   ENSBTAG00000006084  1159    EOG61ZHHC   ENSG00000158828 820    EOG61ZHHC   ENSMMUG00000000126  631'

result = re.findall('\s+(.*?)\s+(.*?)\s+(\d+)', string, re.S)

buffer = {}

for i in result:
    if not i[0] in buffer:
        buffer[i[0]] = ''

    buffer[i[0]] = buffer[i[0]] + i[1] + '  ' + i[2] + '\n'

for i in buffer.iteritems():
    print i

    filename = i[0] + '.txt'
    content = i[1] # you could remove the unneeded "\n" here with substring if wanted

    # CODE: Create the file with "filename"

    # CODE: Write "content" to the file 
```

# android - 画布中的 AdMob

> ID：15558680
> 
> 赞同：0
> 
> 时间：2013-03-21T21:37:34.467
> 
> 标签：android, multithreading, canvas, admob

所以，我有单独的绘图类，我想在那里画 adMob，我从游戏类中调用它并将活动作为参数传递：

```
public void drawAddMob(Activity a){
LinearLayout ll = new LinearLayout(a);
ll.setPadding(0, 50, 0, 0);
adView = new AdView(a, AdSize.BANNER,  "a15140cd49b6e7b");  
AdRequest request = new AdRequest();
adView.loadAd(request);
adView.setVisibility(View.VISIBLE);

ll.addView(adView);

ll.draw(canvas);
} 
```

但是当我这样做时，我得到了错误：

```
03-21 23:35:09.646: W/System.err(333):
java.lang.RuntimeException: Can't create handler 
inside thread that has not called Looper.prepare()
03-21 23:35:09.656: W/System.err(333):
at com.google.ads.internal.AdWebView.<init>  (SourceFile:69) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T21:51:27.323

您需要在 UI 线程上运行此代码，因为它会改变您的 UI。为您的方法主体尝试以下操作：

```
a.runOnUiThread(new Runnable() {
    public void run() {
        LinearLayout ll = new LinearLayout(a);
        ll.setPadding(0, 50, 0, 0);
        adView = new AdView(a, AdSize.BANNER,  "a15140cd49b6e7b");  
        AdRequest request = new AdRequest();
        adView.loadAd(request);
        adView.setVisibility(View.VISIBLE);

        ll.addView(adView);

        ll.draw(canvas);
    }
}); 
```

# javascript - 案例语句中的按钮，启动 url

> ID：15558682
> 
> 赞同：0
> 
> 时间：2013-03-21T21:37:36.800
> 
> 标签：javascript, html, websense

以下是我试图开始工作的案例陈述。我在我想要的地方设置了格式，但是此时按钮（onclick）没有任何操作。

```
case 'This Websense category is filtered: <b>Uncategorized</b>.':
document.write('<p><b style="margin-left: 8px;">Help:</b><INPUT TYPE="button" STYLE="margin-left: 64px;" VALUE="Submit UNCATEGORIZED website to Websense" onClick="window.open=(http://aceinsight.websense.com/?url=' + 
'$*WS_URL*$,' + ' "_blank")' + '"></p>\
<hr />\
<p style="margin-left: 108px; color: #FF0000;">Clicking on the above button will open another webpage for Websense to categorize the above site. You will NOT receive a confirmation e-mail or any communication from Websense indicating your request is processing. Please note the response time for your request will vary. Allow three to four (3-4) hours for updates to take effect once approved.</p>');
break; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T21:48:04.240

You shouldn't bind events inside the elements via html, it makes debugging javascript very difficult. You can create the element with document.write, and then after you do that you can reference the elements using the DOM and add an event that way. Here's an example:

```
document.write('<button id="foo">Hai!</button>');
document.getElementById('foo').onclick = function () {
    window.open('http://aceinsight.websense.com/',"_blank");
}; 
```

[http://jsfiddle.net/5QxuD/](http://jsfiddle.net/5QxuD/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T21:44:05.227

我认为您的 onClick 调用可能是错误的。

尝试：

```
window.open("http://aceinsight.websense.com/?url= (rest of your url)") 
```

代替：

```
window.open=("http://aceinsight.websense.com/?url= (rest of your url)") 
```

[https://developer.mozilla.org/en-US/docs/DOM/window.open](https://developer.mozilla.org/en-US/docs/DOM/window.open)

# parsing - 在 flex 中匹配尾随上下文

> ID：15558684
> 
> 赞同：4
> 
> 时间：2013-03-21T21:37:57.113
> 
> 标签：parsing, lex, flex-lexer

在[flex 手册](http://westes.github.io/flex/manual/Patterns.html)中，它提到了一个“尾随上下文”模式 ( `r/s`)，这意味着`r`，但只有在后面跟着`s`. 但是以下代码无法编译（而是给出“无法识别的规则”的错误。为什么？

```
LITERAL a/b
%%
{LITERAL} { } 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-22T01:42:19.397

简单的答案是，除非您使用*不*`-l`推荐的选项，否则您不能将尾随上下文放入名称定义中。那是因为弹性：

 **   不允许括号内的尾随上下文；和

*   自动用括号括住定义的扩展，除了在少数情况下（见下文）。

flex 用括号包围扩展的原因是，否则会发生奇怪的事情。例如：

```
prefix        milli|centi
%%
{prefix}pede  return BUG; 
```

如果没有自动括号，模式将扩展为：

```
milli|centipede 
```

这不匹配`millipede`。（各种后缀运算符也存在类似的问题。`{prefix}?pede`例如，考虑一下。）

Flex 不允许括号内的尾随上下文，因为许多这样的表达式更难编译。实际上，您最终可以编写为两个正则表达式的交集的模式。（例如， (`{base}/{a}){b}`匹配`{base}`后跟 a `{b}`，它是前缀或 的投影`{a}`。）这些仍然是正则表达式，但 Thomson 算法并未考虑将正则表达式转换为有限状态机。因为该特征是很少需要，也没有尝试实施它。

不幸的是，禁止括号内的尾随上下文也禁止在包含尾随上下文的模式周围使用冗余括号，这包括定义扩展，因为定义可能使用冗余括号进行扩展。

最初的 AT&T lex 没有添加括号，这就是为什么强制 lex-compatibility with`-l`允许您的 flex 文件编译的原因。但是，如上所述，它可能会导致各种其他问题，因此我不推荐它。

此外，这里的“尾随上下文”是指 form`r/s`或 form的完整模式`r$`。放入`r/s`括号内（无论是显式还是隐式）都会产生错误消息，但放入`r$`括号内只会使`$`匹配成为一个`$`字符，而不是强制模式在行尾匹配。在这种情况下不会发出错误或警告。

这将使得在名称定义中无法使用`$`(or )。`^`但是，在版本 2.3.53 之前的某个时间点，插入了一个 hack，如果定义`^`以`$`. 而且，由于我不完全理解的原因，如果扩展发生在尾随上下文的末尾，它也会抑制括号。这可能是一个错误，并且确实有一个与之相关的错误报告。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T22:53:07.177

`info`我在以下页面的常见问题解答中找到了您问题的答案`flex`：“您的问题是扫描仪中的某些定义使用'/'尾随上下文运算符，并将其包含在 () 中。Flex 不允许此运算符包含在 () 中，因为这样做允许未定义的正则表达式，例如`"(a/b)+"`。所以解决方案是删除括号。请注意，您还必须使用`-l`AT&T lex 兼容性选项构建扫描仪。没有此选项， flex 自动将定义括在括号中。” （引自弗恩·帕克森）。另请参阅[常见问题解答尾随上下文](http://westes.github.io/flex/manual/Why-can_0027t-flex-understand-this-variable-trailing-context-pattern_003f.html)

如果可能，最好避免使用尾随上下文。如上所述，它不允许在嵌套表达式中使用。您的示例确实适用于该`-l`选项。*

# object - 如何通过 for 循环在 Arraylist 中添加对象的各个元素？

> ID：15558686
> 
> 赞同：0
> 
> 时间：2013-03-21T21:38:02.863
> 
> 标签：object, arraylist, element

我正在尝试将对象的所有元素添加到 ArrayList 中。对象的元素具有不同的类型。

例如，对象 Employee 具有 emp_id、name、address、DOB 等属性。

我想将每个属性作为一个对象存储在 ArrayList 中。喜欢，

```
ArrayList[1] = Employee.emp_id
ArrayList[2] = Employee.name
ArrayList[3] = Employee.address 
```

我想动态地做。就像，将来会在这个对象中添加更多属性，而无需手动操作。有没有办法创建一个数组列表？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T21:46:07.563

ArrayList 必须是同一类型。你可以有一个 ArrayList 类型，你可以在其中做你正在做的事情，因为 Java 中的所有对象都扩展了 Object。但是，如果您尝试在数组列表中存储不同的对象类型，这是不可能的。

您可能知道第一部分，只是在您的帖子中有点不清楚。

以下是使用反射处理对象的方法：

```
//make sure you import java.lang.reflect.*

public void addMyFields(Employee e){
    ArrayList<Object> list = new ArrayList();
    for (Field field : emp.getClass().getDeclaredFields())
    {
        field.setAccessible(true);
        list.add(field.get(emp);
    }    
} 
```

# wpf - VB.Net 接口和抽象类：wpf windows 共享通用功能

> ID：15558689
> 
> 赞同：0
> 
> 时间：2013-03-21T21:38:10.540
> 
> 标签：wpf, vb.net, wpf-controls

一般来说，我是 VB.Net 和 .Net 的新手。我正在使用 wpf windows 构建一个调查应用程序。其中许多窗口具有相似的功能和相似的类成员。我以为我可以使用接口和抽象类来定义和部分实现通用功能。然后，在 WPF 窗口的 Classes 中实现并继承它。但是，当“wpf”类继承抽象类时，它就失去了对所有常规子例程的访问权。我意识到我在这里犯了一些根本性的错误。谁能解释我如何实现通用功能，定义通用成员，然后在不同的 WPF 窗口中使用它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T00:24:10.027

我不完全确定我是否遵循您的问题，但是如果您有一个 WPF 窗口继承一个类，该类本身至少不是从 WPF Window 派生的，或者将窗口类的成员隐藏到它的后代中，您将失去WPF 窗口类的功能。

假设我有`MyWPFWindowClass`继承自的类，`System.Windows.Window`因此具有窗口的所有方法。

如果你现在让它继承自一个新类`MyWPFWindowClassBase`，`MyWPFWindowClass`那么它将拥有`MyWPFWindowClassBase`.

现在，除非`MyWPFWindowClassBase`它本身继承自并`System.Windows.Window`因此具有窗口的所有方法，否则您将无法在.`MyWPFWindowClass``MyWPFWindowClassBase`

我希望这确实使它更清楚一点？

看看[这个链接](http://www.informit.com/articles/article.aspx?p=170719)，让你开始在 .Net 中继承。

# scala - Apache POI excel文件超链接地址中的西里尔字符

> ID：15558691
> 
> 赞同：0
> 
> 时间：2013-03-21T21:38:29.420
> 
> 标签：scala, character-encoding, apache-poi

我使用 Scala 和 Apache POI（使用[folone/poi-scala](https://github.com/folone/poi.scala)）。

我想在单元格中创建指向本地文件的超链接。文件的路径包含西里尔字符。在 Excel 中我无法打开此文件，我看到“？” 而不是西里尔字符。我尝试了很多编码和 URL 编码，但没有奏效。

这是我的代码：

```
...
val cell = sheetOne.asPoi.getSheetAt(0).getRow(0).getCell(0)
cell.setHyperlink({
    val link = new HSSFHyperlink(HSSFHyperlink.LINK_FILE)
    link.setAddress("D:/Проверка/проверка.txt")
    link
})
... 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T21:53:15.643

需要更换

```
HSSFHyperlink.LINK_FILE 
```

经过

```
HSSFHyperlink.LINK_URL 
```

# jquery - jQuery：如何仅在移动屏幕分辨率下隐藏下拉菜单？

> ID：15558692
> 
> 赞同：0
> 
> 时间：2013-03-21T21:38:31.833
> 
> 标签：jquery, drop-down-menu, menu, responsive-design, resolution

我正在创建一个 CSS 响应式网站。

**如何以移动屏幕分辨率隐藏下拉菜单？并在更大的分辨率下再次出现？**（我是 jQuery 新手）

这是我的html：

```
<div id="menuContainer">

  <ul id="menu">

     <li id="about">

     <a href="about.html">About</a>

          <ul class="dropdown">

             <li>
               <a href="#">Link 1</a>
             </li>

             <li>
               <a href="#">Link 2</a>
             </li>

             <li>
               <a href="#">Link 3</a>
             </li>

          </ul>

      </li>

  </ul>

</div> 
```

还有我的 jQuery：

```
$('#menu li ul').css({
    display: "none",
  });
      $('#menu li').hover(function() {
        $(this)
          .find('ul')
          .stop(true, true)
          .slideDown('fast');
      }, function() {
        $(this)
          .find('ul')
          .stop(true,true)
          .fadeOut('fast');
      }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T21:41:39.817

尝试在 CSS 中使用媒体查询

```
@media only screen and (max-device-width: 480px) {
    .dropdown {  display: none; }

} 
```

这意味着它仅在屏幕尺寸小于 480 像素时将 display: none 应用于该类

阅读这篇文章以了解更多信息 - [http://css-tricks.com/css-media-queries/](http://css-tricks.com/css-media-queries/) - 这些是使网站响应式的核心。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T21:41:43.007

为什么不使用媒体查询

```
@media only screen 
and (min-device-width : 320px) 
and (max-device-width : 480px) {
/* Styles */
/* Do whatever you want for this resolution */
} 
```

*正如你上面的评论*
你可以试试这个

```
$(window).resize(function() {
  var windowWidth = $(window).width(); //retrieve current window width
  var windowHeight = $(window).height(); //retrieve current window height

  // show/hide dropdown based on height/width values
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T21:42:36.190

这可能不是您想要的，但我用于动态页面大小的是[Twitter 的 Bootstrap 库](http://twitter.github.com/bootstrap/)。

这是一个免费使用的 API。

否则，我没有技术知识来帮助您实现 JQuery。

# sql - 将每两行合并，期望每第七行（总和值，并更改年龄范围）

> ID：15558697
> 
> 赞同：2
> 
> 时间：2013-03-21T21:38:39.443
> 
> 标签：sql, sql-server-2008, tsql

我有一个这样的数据列表：（它在不同的城市继续存在）

```
Ref_Date    City           Province                   sex          age   Value
2010    St. John's   Newfoundland and Labrador  Males   15 to 19 years  2720
2010    St. John's   Newfoundland and Labrador  Males   20 to 24 years  5670
2010    St. John's   Newfoundland and Labrador  Males   25 to 29 years  5910
2010    St. John's   Newfoundland and Labrador  Males   30 to 34 years  5900
2010    St. John's   Newfoundland and Labrador  Males   35 to 39 years  6120
2010    St. John's   Newfoundland and Labrador  Males   40 to 44 years  6160
2010    St. John's   Newfoundland and Labrador  Males   45 to 49 years  6450
2010    St. John's   Newfoundland and Labrador  Males   50 to 54 years  5990
2010    St. John's   Newfoundland and Labrador  Males   55 to 59 years  5050
2010    St. John's   Newfoundland and Labrador  Males   60 to 64 years  3830
2010    St. John's   Newfoundland and Labrador  Males   65 years and over 2820  
2010    St. John's   Newfoundland and Labrador  Females 15 to 19 years  2840
2010    St. John's   Newfoundland and Labrador  Females 20 to 24 years  5820
2010    St. John's   Newfoundland and Labrador  Females 25 to 29 years  6080
2010    St. John's   Newfoundland and Labrador  Females 30 to 34 years  6070
2010    St. John's   Newfoundland and Labrador  Females 35 to 39 years  6120
2010    St. John's   Newfoundland and Labrador  Females 40 to 44 years  6450
2010    St. John's   Newfoundland and Labrador  Females 45 to 49 years  6750
2010    St. John's   Newfoundland and Labrador  Females 50 to 54 years  6090
2010    St. John's   Newfoundland and Labrador  Females 55 to 59 years  4990
2010    St. John's   Newfoundland and Labrador  Females 60 to 64 years  3410
2010    St. John's   Newfoundland and Labrador  Females 65 years and over 2320 
```

现在我想将每两行（但不考虑 65+ 组）与值的总和相结合并更改年龄组：如下所示：

```
Ref_Date    City         Province                   sex    age           Value
2010    St. John's   Newfoundland and Labrador  Males   15 to 24 years  2720+5670
2010    St. John's   Newfoundland and Labrador  Males   25 to 34 years  5910+5900
2010    St. John's   Newfoundland and Labrador  Males   35 to 44 years  6120+6160
2010    St. John's   Newfoundland and Labrador  Males   45 to 54 years  6450+5990
2010    St. John's   Newfoundland and Labrador  Males   55 to 64 years  5050+3830
2010    St. John's   Newfoundland and Labrador  Males   65 years and over 2820 
```

有没有办法做到这一点？我坚持了很长时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T21:46:27.827

You need to do an aggregation. This version defines the new age group in a subquery:

```
select ref_date, city, province, sex, newage, SUM(value) as value
from (select ref_date, city, province, sex, age, value,
             (case when age in ('15 to 19 years', '20 to 24 years')
                   then '15 to 24 years'
                   when age in ('25 to 29 years', '30 to 34 years')
                   then '25 to 34 years'
                   when age in ('35 to 39 years', '40 to 44 years')
                   then '35 to 44 years'
                   when age in ('45 to 49 years', '50 to 54 years')
                   then '45 to 54 years'
                   when age in ('55 to 59 years', '60 to 64 years')
                   then '55 to 64 years'
                   else age
               end) as newage
      from t
     ) t
group by ref_date, city, province, sex, newage 
```

# spring - Spring 3 字段格式

> ID：15558703
> 
> 赞同：1
> 
> 时间：2013-03-21T21:38:59.600
> 
> 标签：spring, spring-mvc, formatting, date-formatting

我正在考虑使用 Spring 的字段格式，特别是现有的 DateFormatter。我明白我需要在我的 POJO 中的注释上指定一个模式。

我没有硬编码我需要能够动态提供它的模式，我知道这对于注释是不可行的。为了正确支持国际化，我需要先从属性文件中查找模式，然后再将其传递给格式化程序。

谁能建议我可以采取的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T06:47:00.820

但是不确定您可以尝试实现 InitializingBean 或 init-method 并动态设置值。

就像在[春季论坛](http://forum.springsource.org/showthread.php?31736-Setting-dynamic-Property)中建议的 cron 表达式一样。

# postgresql - 存储大文件的最佳数据库解决方案

> ID：15558709
> 
> 赞同：3
> 
> 时间：2013-03-21T21:39:41.467
> 
> 标签：postgresql, jakarta-ee, nosql

我必须提供一个解决方案，用户可以上传文件并且它们必须与 some 一起存储`metadata`，这可能会变得非常大。

必须控制对这些文件的访问，因此他们希望我将它们存储在 DB 中`BLOB`，但我担心`PostgreSQL`随着时间的推移无法正确处理它。

我的第一个想法是使用一些`NoSQL`DB 解决方案，但我找不到任何可以替代好的 RDBMS 并将文件优雅地存储在一起的方法。然后我想把这些文件保存在 HD 的某个地方，WebServer 不会为它们提供服务，将它们命名为它们的表 ID，然后将它们加载到 RAM 上并使用适当的内容类型打印它们。

任何人都可以为此建议我任何更好的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T21:53:57.260

我需要存储许多图像（带有一些元数据）并允许对它们进行受控访问，这就是我所做的。

[到云端](http://www.youtube.com/watch?v=mjtqoQE_ezA)™</p>

我将图像文件保存在 Amazon S3 中。我的本地数据库将元数据与文件的 S3 位置作为一列。当经过身份验证和授权的用户需要查看文件时，他们会在我的系统中点击一个 URL（进行身份验证和授权检查的地方），然后生成一个预签名的、过期的图像 URL 并将重定向发送回浏览器。然后，浏览器能够在给定的时间内加载图像（如 URL 中的签名中指定的那样）。

使用此解决方案，我可以对资源进行用户级别的访问，并且不必将它们存储为 BLOB 或任何可能随着时间的推移而变得笨拙的东西。我也不使用我的带宽将文件流式传输到客户端并为它们获得廉价的冗余存储。显然，此解决方案的适用性将取决于您要存储的二进制文件的性质以及您对 Am​​azon 的信任程度。如果出现失误并且有人从我的系统中看到他们不应该看到的图像，世界并没有结束。YMMV。

# iphone - Facebook 模板 xcode iphone

> ID：15558711
> 
> 赞同：0
> 
> 时间：2013-03-21T21:39:51.203
> 
> 标签：iphone, xcode, templates, menu

我正在为 iPhone 用 xcode 做我的第一个应用程序。我正在使用 xcode 3.2。

我想使用 Facebook 应用程序的格式（左侧的可移动菜单）。我想知道这个选项是否是 xcode 的模板（我在其他应用程序中看到过相同的子菜单）。或者这个模板可能在新版本的 xcode 中可用。我在我的 xcode 版本中找不到它（或者我不知道我必须如何构建它）。

所以：

1.  左侧的可移动菜单是模板吗？这个模板叫什么名字？
2.  xcode的版本是多少？
3.  我可以在 xcode 3.2 中使用这个模板吗？

提前谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T21:45:37.953

该特定控件不是 iOS 默认设置，而是许多应用程序使用的第三方库，因为它非常有效且美观。这是您可以在项目中使用的实现之一：

[http://www.cocoacontrols.com/controls/iiviewdeckcontroller](http://www.cocoacontrols.com/controls/iiviewdeckcontroller)

# windows-phone - Windows Phone 8 上的 FontAwesome

> ID：15558716
> 
> 赞同：4
> 
> 时间：2013-03-21T21:40:11.873
> 
> 标签：windows-phone, font-awesome

我无法在 Windows Phone 8 上显示 FontAwesome 图标。

*   电话 (HTC 8X)：在开发盒 (http) 上正常，但在 QA 服务器上不正常 (https)
*   Surface RT、Pro、台式机：在两台服务器上都可以

所有设备都使用 IE10。两种环境（Dev 和 QA）都使用 IIS7。看来 IE10 手机在处理可下载字体方面与 IE10 平板电脑/台式机有些不同。

有没有其他人经历过这个？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-22T18:41:40.360

It was due to a missing MIME type. I was wrong about both environments using IIS7; The QA server uses IIS6\. We added `application/x-font-woff` to the IIS configuration, and that fixed it.

UPDATE: Add this to your `Web.config` to associate .woff files with the correct MIME type, so the server will know what to do when such a file is requested:

```
<configuration>
    <system.webServer>
        <staticContent>
            <mimeMap fileExtension=".woff" mimeType="application/x-font-woff" />
        </staticContent>
    </system.webServer>
</configuration> 
```

# django - Django 教程：应用通用视图后出现错误“没有名为 polls 的模块”

> ID：15558717
> 
> 赞同：1
> 
> 时间：2013-03-21T21:40:18.507
> 
> 标签：django, module, django-generic-views

Windows 7、64 位
Python 2.7.3
Django 1.5
python manage.py runserver

我正在关注“ [https://docs.djangoproject.com/en/1.5/intro/tutorial04/](https://docs.djangoproject.com/en/1.5/intro/tutorial04/) ” 中提供的教程

在我将通用视图代码应用于“polls/urls.py”之前，一切都运行良好。现在我的网络浏览器窗口出现以下错误：

@索引.py ![](../Images/2689916dfcd9feb9419be2a13791e2c7.png)

@detail.py ![](../Images/2596e18d7dc476f03a7f6bd3f5ab6702.png)

我已经阅读了@'绝对初学者的Django官方教程的问答[，绝对失败！](https://stackoverflow.com/questions/1054494/django-official-tutorial-for-the-absolute-beginner-absolutely-failed)’而我现在更加困惑。这指的是教程文档的一部分，并建议：

**“浏览您的模板，并将对 latest_poll_list 的任何引用修改为 object_list，并将对 poll 的任何引用更改为 object。”**

但是，我正在使用的教程文档的版本似乎表明可以通过设置方便地避免这种情况：

```
context_object_name='latest_poll_list' 
```

我的 polls/urls.py 目前看起来像这样：

```
from django.conf.urls import patterns, url  
from django.views.generic import DetailView, ListView  
from polls.models import Poll  
from polls import views  

urlpatterns=patterns(' ',  
# ex: /polls/  
  url(r'^$',  
    ListView.as_view(  
      queryset=Poll.objects.order_by('-pub_date')[:5],  
      context_object_name='latest_poll_list',  
      template_name='polls/index.html'),  
    name='index'),  
# ex: /polls/5/  
  url(r'^(?P<pk>\d+)/$',  
    DetailView.as_view(  
      model=Poll,  
      template_name='polls/detail.html'),  
    name='detail'),  
# ex:/polls/5/results/  
  url(r'^(?P<pk>\d+)/results/$',  
    DetailView.as_view(  
      model=Poll,  
      template_name='polls/results.html'),  
    name='results'),  
# ex: /polls/5/vote/  
  url(r'^(?P<poll_id>\d+)/vote/$','polls.views.vote',name='vote'),  
) 
```

我的 polls/views.py 看起来像这样：

```
from django.http import Http404, HttpResponseRedirect  
from django.template import Context, loader  
from django.shortcuts import render, render_to_response, get_object_or_404  
from django.core.urlresolvers import reverse  
from polls.models import Poll, Choice  

def vote(request,poll_id):  
  p=get_object_or_404(Poll, pk=poll_id)  
  try:  
    selected_choice=p.choice_set.get(pk=request.POST['choice'])  
  except (KeyError, Choice.DoesNotExist):  
    return render(request, 'polls/detail.html',{  
      'poll':p,  
      'error_message': "You didn't select a choice.",  
    })  
  else:  
    selected_choice.votes+=1  
    selected_choice.save()  
    return HttpResponseRedirect(reverse('polls:results',args=(p.id,))) 
```

这是我错过的错字还是我确实需要更改 HTML 文件中的引用？非常感谢所有建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T21:46:44.960

您是否将命名空间添加到您的根 urls.py？

```
 url(r'^polls/', include('polls.urls', namespace="polls")), 
```

**编辑：** 尝试将模式调用中的空格参数更改为空字符串：

```
urlpatterns=patterns(' ', 
```

到

```
urlpatterns=patterns('', 
```

# css - 表格未显示为 100%

> ID：15558718
> 
> 赞同：0
> 
> 时间：2013-03-21T21:40:19.843
> 
> 标签：css, twitter-bootstrap, css-tables

我在 Twitter 引导程序上对齐表格时遇到了一些问题。我一直在努力避免使用固定宽度等。当标题不那么长时，我似乎有 100% 的表格甚至 78% 的标题来填充空间。

你可以在这里看到我的主表问题： [MY TABLE THAT WONT ALIGN CENTER](http://www.onlinebanter.com/football-betting)

它位于比分直播下方的中间表格。div 类视图分类术语。我希望它填满整个中间空间“区域内容”。

我已经做了几个小时了；文本对齐中心，边距 0px 等

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T21:49:25.780

目前，表格只有一个`max-width:100%;`属性，它只*限制*表格的最大宽度。如果要*设置*表格的宽度，则应使用该`width`属性。例如：

```
.views_table {
     ...
     width:100%;
     ...
} 
```

或者，如果您只想让表格居中，您可以尝试将`margin-left`and`margin-right`属性设置为`auto`：

```
.views_table {
    ...
    margin:0 auto 0 auto; /* or in shorthand - margin:0 auto;*/
    ...
} 
```

# css - 绝对定位的子级与父级滚动条重叠

> ID：15558719
> 
> 赞同：8
> 
> 时间：2013-03-21T21:40:20.577
> 
> 标签：css

我有一个带有两个子 div（标题和正文）的父 div，我想将标题位置设置为固定在顶部，并且只有正文应该滚动。

HTML

```
<div class="box">
<div class="header">Header</div>
<div class="body">Body</div> 
```

CSS

```
.box {
height: 300px;
border: 1px solid #333;
overflow: auto;
}
.header {
position: absolute;
width: 100%;
height: 100px;
background: #ccc;
}
.body {
height: 300px;
background: #999;
margin-top: 101px;
} 
```

我发现标题 div 与父 div 的滚动条重叠。我无法将父 div 位置设置为相对位置，因为我想要固定标题位置。我无法将标题位置设置为“固定”，因为此内容在页面中间的某个位置可用。

如何避免绝对定位的孩子不与父母的滚动条重叠？

找到jsfiddle：http: [//jsfiddle.net/T43eV/1/](http://jsfiddle.net/T43eV/1/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T21:47:47.147

The overflow property should be set on the `.body`, not `.box`, as such : [http://jsfiddle.net/T43eV/8/](http://jsfiddle.net/T43eV/8/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T21:44:15.143

这有帮助吗？

```
.box { position:relative; } 
```

**编辑：**无论如何都不需要使用，`absolute`删除它并穿上`overflow:auto`.`.body`

[jsFiddle](http://jsfiddle.net/yp9JJ/)

```
.box {
    height: 300px;
    border: 1px solid #333;
}
.header {
    width: 100%;
    height: 100px;
    background: #ccc;
}
.body {
    height: 200px;
    background: #999;
    width:100%;
    overflow: auto;
} 
```

**编辑：**我不认为你可以跨平台始终如一地做到这一点。您可以通过将`right`.header 上的属性设置为与滚动条一样大，但滚动条的大小与操作系统绑定，而不是单一大小。

您可以查看一个`iframe`，因为它将在您的页面、滚动条和所有内容中创建一个页面。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-04-12T12:49:47.397

如果它有助于在 .header 中设置 z-index:-1 并且标题不会与滚动条重叠。

```
Here is the working fiddle: 
```

[http://jsfiddle.net/T43eV/28/](http://jsfiddle.net/T43eV/28/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-12-31T03:22:32.833

一种方法是使用[粘性位置](https://developer.mozilla.org/fr/docs/Web/CSS/position)。这会将标题保留在可滚动的 div 内，但不会使其与滚动重叠（或者如果您设置较低的 z-index，则位于滚动后面）

```
.box {
    height: 300px;
    border: 1px solid #333;
    overflow: auto;
}
.header {
    position: sticky;
    top:0;
    height: 100px;
    margin-bottom:-100px;
    background: #ccc;
}
.body {
    height: 300px;
    background: #999;
    margin-top: 101px;
} 
```

但是[Internet Explorer 不支持此功能](https://caniuse.com/#feat=css-sticky)

# c# - 如何调试使用内联 sqldatasource 时传递的参数？

> ID：15558720
> 
> 赞同：2
> 
> 时间：2013-03-21T21:40:25.850
> 
> 标签：c#, asp.net, sqldatasource

假设我在 .aspx 页面上有某种数据网格或中继器，并且我的数据源是内联定义的，例如：

```
<asp:SqlDataSource ID="ds1" runat="server" ConnectionString="..."
SelectCommand="some_proc" ...>
  <SelectParameters>
             <asp:ControlParameter ControlID="ddlYear" Name="Year" .. />
   </SelectParameters>
</asp:SqlDataSource> 
```

如何调试我的代码，以便确切地看到 Year 绑定到网格时的值？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-21T21:53:44.203

您可以挂钩 SqlDataSource 事件：

```
protected void SqlDataSource1_Selecting(object sender, SqlDataSourceSelectingEventArgs e)
{
    foreach (DbParameter P in e.Command.Parameters)
    {
        Response.Write(P.ParameterName + "<br />");
        Response.Write(P.DbType.ToString() + "<br />");
        Response.Write(P.Value.ToString() + "<br />");
    }
} 
```

当然，您可能希望将输出发送到调试窗口。

# php - Fopen 没有创建新文件

> ID：15558721
> 
> 赞同：0
> 
> 时间：2013-03-21T21:40:29.987
> 
> 标签：php, fopen

我知道这是一个重复的问题，但我已经尝试了一切。

所以这是我的代码：

```
<?php
  $link = $_GET['link'];
  $urlparse = parse_url($link);
  $filename = $urlparse['host'] . ".txt";
  $dlink = "../get/" . $filename;
  if(isset($link)){
    $source = file_get_contents($link);
    $file = fopen($dlink,"w");
    $string = htmlspecialchars($source);
    fwrite($string,$file);
    fclose($file);
    chmod($dlink,0777);
  }
?> 
```

** 我删除了一些不必要的代码部分

另外，我检查了 php.ini 中的允许 fopen，我检查了 php 文件的权限。发生的情况是代码运行时没有警告或错误，但是它不会创建新的文本文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T21:46:11.273

好吧，如果 fwrite 没有抛出任何错误并且没有创建文件，那么几乎可以肯定的是，您已经“错误配置”了 php.ini 中的 error_reporting 指令：

试试这个，你应该开始收到警告和错误：

```
error_reporting = E_ALL & ~E_NOTICE 
```

# maven - 空 Maven mojo 参数而不是 null

> ID：15558723
> 
> 赞同：2
> 
> 时间：2013-03-21T21:40:37.307
> 
> 标签：maven, maven-plugin, mojo

我想知道是否可以区分“参数未指定”和“参数为空”。在这两种情况下，Mojo 参数的值为 null。

如果用户不提供参数，我希望使用默认值，如果用户提供空参数元素，则使用空字符串。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T08:42:24.553

如果您在字符串的情况下为空，则可以假设用户根本没有定义它，否则您可以假设它已被定义。您可以为 Mojo 参数设置适当的默认值以区分这些情况。或者你可以更具体一点。

# django - Django + New Relic 性能基准测试

> ID：15558728
> 
> 赞同：1
> 
> 时间：2013-03-21T21:40:51.530
> 
> 标签：django, performance, automation, newrelic

我有一个 Django Web 应用程序，它的复杂数据模型遇到了性能问题。使用 New Relic，我几乎可以立即找出问题所在。但是我可以尝试许多不同的解决方案。我想做的是能够以各种组合对不同解决方案的功效进行基准测试。

在我看来，手动执行此操作的一种方法是制作一个 Django 模型，该模型将配置标志存储在我的设置文件之外，因此我可以通过管理员更改它们而不是重新部署。然后我可以监控 New Relic 并将指标记录到电子表格中。

但我觉得那将是对人们可能一直在做的事情的糟糕改造。有没有一种很好的方法可以在没有大量体力劳动的情况下做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-22T00:21:26.637

我不确定整体方法，但另一个让我非常满意的选项是[Tracelytics](http://www.tracelytics.com/)。

此外，另一个可以帮助您解决问题的事情是我从未使用过的项目[django-waffle](https://github.com/jsocol/django-waffle)，但似乎从管理员更改标志/设置会很好！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-12T21:16:23.573

如果您在推送一些配置更改时在 NewRelic 中记录了部署，那么您可以通过部署仪表板使用更改日志或更改报告之前和之后分析性能。

记录部署就像使用 curl 命令一样简单

```
curl -H "x-api-key:REPLACE_WITH_YOUR_API_KEY" -d "deployment[app_name]=REPLACE_WITH_YOUR_APP_NAME" https://api.newrelic.com/deployments.xml 
```

您可以在此处阅读有关部署的更多详细信息：

[http://docs.newrelic.com/docs/applications-menu/deployments-dashboard](http://docs.newrelic.com/docs/applications-menu/deployments-dashboard)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-15T10:07:01.707

除了 Waffle，您可能还想查看其他设置后端，例如[Menagerie](https://github.com/disqus/menagerie)，它从 Zookeeper 检索其设置，并在更改时更新它们。

# c# - 带参数的 DataGridView 选择命令

> ID：15558730
> 
> 赞同：0
> 
> 时间：2013-03-21T21:40:57.207
> 
> 标签：c#, select, datagridview

基本上我想要的是这样的数据网格视图的填充查询

> 选择 DealerName、OrderId、DealerId、OrderDate、ItemType、价格、数量、总计、TotalBill FROM dbo.DetailedRecord where DealerName=ComboboxName.SelectedValue

我看不到如何向它添加参数，我不想使用工具条填充

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T21:44:21.573

为什么不使用存储过程，然后给它一个数据集来填充你的信息呢？

[从存储过程填充 DataGridView](https://stackoverflow.com/questions/1927822/populate-datagridview-from-a-stored-procedure)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T22:06:32.163

尝试将表格绑定到您的`DataGridView`.

请参阅下面的简单示例：

```
MySqlConnection conn = new MySqlConnection(connectionstring);          
conn.Open();

string stmt = "SELECT DealerName, OrderId, DealerId, OrderDate, ItemType, Price, Quantity,
Total, TotalBill FROM dbo.DetailedRecord where DealerName=ComboboxName.SelectedValue";

DataSet ds = new DataSet();
MySqlDataAdapter da = new MySqlDataAdapter(stmt, conn);
da.Fill(ds, "dbo.DetailedRecord");           
dataGridView1.DataSource = ds.Tables["dbo.DetailedRecord"];
conn.Close(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T22:09:03.367

假设您想通过一些 combobox.selectedvalue 过滤数据，并且您有一个提交按钮，在该提交按钮代码中，您初始化了一个 yourdatasource.table 类型的新数据表，例如

```
YourDataSource.YourTableDataTable anything= new YourDataSource.YourTableDataTable();

    yourdataadapter.fill(anything,parametervalue.tostring());
     DataGridView1.datasource= anything; 
```

你都准备好了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-06-05T14:00:00.010

只需将您的参数作为字符串传递到您的查询中。使用简单的字符串连接 (++)。仔细观察您如何创建该搜索字符串。确保首先初始化 DataTable 否则它会弹出关于 null 参数的错误：例如（适用于 SQL Server、Mysql 和 Postgres）

```
 String connectionString = "server = ...; db= ...; passwd = ....;";
    DataTable dt_reservation_product_mix = new DataTable();
    MySqlDataAdapter ad3;
    ad3  = new MySqlDataAdapter("select `product`.`name`, `product`.`notes` from `product` where `product`.`code` = " + Convert.ToString(ComboboxName.SelectedValue) + "; ", connectionString);
    ad3.Fill(dt_reservation_product_mix);
    ad3.Dispose(); 
```

# matlab - 如何对integral2的函数进行矢量化？

> ID：15558731
> 
> 赞同：1
> 
> 时间：2013-03-21T19:08:24.877
> 
> 标签：matlab, numerical-integration

我想评估形式为 $$\int_{-\infty}^a \int_{-\infty}^b \sum_{i,j}^K a_ia_jx^iy^j\exp(-x^ 2 - y^2 + xy)dx dy $$

其中 $a_i$ 和 $a_j$ 是常量。由于积分是线性的，我可以互换求和和积分，但在这种情况下，我必须评估 $K^2$ 积分，而且花费的时间太长。在这种情况下，我会执行以下操作：

```
for i = 1:K
   for j = 1:K
       fun = @(x,y) x.^i.*y.^j.*exp(-2.*(x.^2 + y.^2 - 2.*x.*y))
       part(i,j) = alpha(i)*alpha(j)*integral2(fun,-inf,a,-inf,b)
   end
end 
```

时间太长，所以我只想评估一个积分，但我不知道如何向量化 $\sum_{i,j}^K a_ia_jx^iy^j\exp(-x^2 - y^2 + xy)$，即如何提供给integral2。如果有任何帮助，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T21:02:35.367

1.  如果你只是想提高速度，你可以试试 parfor。

2.  设 $X=(x,x^2,\cdots,x^K)$, $Y=(y,y^2,\cdots,y^K)$, $A=(a_{ij})$ $a_{ij}=a_{i}a_{j}$ 的矩阵，然后 $$\sum_{i,j}^K a_{i}a_{j}x^iy^j=XAY^{T} $$

我的matlab上没有integral2函数，所以我没有测试它是否会大大提高速度。

另外，我认为您需要在计算 $$XAY^{T}$$ 之后使用符号 x 和 y，然后使用 matlabFunction 将符号表达式转换为函数句柄。这是我的测试代码：syms xy; X=[x,x^2]; Y=[y,y^2]; Z=X*Y'; 乐趣 =matlabFunction(Z); ff=@(x,y) x^2+y^2; gg=fun(x,y).*ff(x,y);

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T01:59:18.290

看起来您需要将 i 和 j 设为第三维和第四维，这样代码才有可能正常工作。

我也没有integral2（我使用octave，integral2是octave还没有的新matlab函数），所以我无法测试它，但我认为这样的事情可能会起作用：

```
alphaset=zeros(1,1,K,K);
alphaset(1,1,1:K,1:K)=alpha(1:K)'*alpha(1:K);
i_set=zeros(1,1,K,1);
j_set=zeros(1,1,1,K);
i_set(:)=1:K;
j_set(:)=1:K;
fun=@(x,y)  x.^i_set.*y.^j_set.*exp(-2.*(x.^2 + y.^2 - 2.*x.*y));
part = squeeze(alphaset.*integral2(fun,-inf,a,-inf,b)); 
```

正如我所说，我不能保证它会起作用，因为我不知道integral2 是如何工作的。但是如果你用简单的“sum(sum(fun([1,2,4],[3,-1,2]))) 替换integral2，那么它就可以按照该操作的预期工作（也就是说，它求和在 x 和 y 值上，结果是一组索引上的矩阵）。

# vb.net - 在用户可以看到它所在的更新面板之后，在可编辑的网格视图中进行更新

> ID：15558737
> 
> 赞同：2
> 
> 时间：2013-03-21T21:41:44.677
> 
> 标签：vb.net, gridview, updatepanel

几天来我一直在搜索论坛并试图解决这个问题，但我被卡住了。如果这是我错过的如此简单和明显的事情，我深表歉意。尽管我发现了与我的问题相似的帖子，但它们并不完全相同。

以下是我的 Web 应用程序部分功能的概要：

1.  显示一个简单的 asp:dropdownlist
2.  当用户选择一个值时，相应的更新面板是可见的（这些更新面板在后面的 Page_Load 代码中是可见的 = false ），显示一个可编辑的网格视图：

    `Protected Sub DropDownList1_SelectedIndexChanged(sender As Object, e As EventArgs) If DropDownList1.SelectedItem.Value <> "0" Then If DropDownList1.SelectedValue = "Activate or Inactivate Users" Then UpdatePanel1.Visible = True End If ...`

    ```
     <asp:GridView ID="GridView3" runat="server" AllowSorting="True" AutoGenerateColumns="False" AutoGenerateEditButton="True" DataSourceID="SqlDataSource2">
             <Columns>
                 <asp:BoundField DataField="iMemberId" HeaderText="iMemberId" InsertVisible="False" ReadOnly="True" SortExpression="iMemberId" />
                 <asp:BoundField DataField="sFname" HeaderText="sFname" SortExpression="sFname" />
                 <asp:BoundField DataField="sSname" HeaderText="sSname" SortExpression="sSname" />
                 <asp:BoundField DataField="dDateCreated" HeaderText="dDateCreated" SortExpression="dDateCreated" />
                 <asp:BoundField DataField="sEmailAddress" HeaderText="sEmailAddress" SortExpression="sEmailAddress" />
                 <asp:BoundField DataField="sMobileNo" HeaderText="sMobileNo" SortExpression="sMobileNo" />
                 <asp:CheckBoxField DataField="bActiveMember" HeaderText="bActiveMember" SortExpression="bActiveMember" />
             </Columns>
         </asp:GridView>
         <asp:SqlDataSource ID="SqlDataSource2" Runat="server" ConnectionString="<%$ ConnectionStrings:PTCCHomeTestConnectionString %>" SelectCommand="SELECT * FROM [MemberTable] ORDER BY [sSname]" 
             UpdateCommand="UPDATE MemberTable SET sFname = @sFname, sSname = @sSname, sEmailAddress = @sEmailAddress, sMobileNo =, bActiveMember = WHERE (iMemberId = @iMemberId)">
         <UpdateParameters>
                             <asp:Parameter Name="sFname" />
                             <asp:Parameter Name="sSname" />
                             <asp:Parameter Name="sEmailAddress" />
                             <asp:Parameter Name="iMemberId" />
         </UpdateParameters>
         </asp:SqlDataSource>

    </ContentTemplate> 
    ```

每个 gridview 的选择和更新查询都已经过测试并且工作正常。我已经在一个页面中测试了它们都可见的网格视图（并且一切正常，但我希望根据用户从下拉列表中选择的唯一一个合适的网格视图可见。

1.  然后，用户应该能够单击所选行上的编辑并更新它。网格视图显示正常，填充正确，但是当用户连续单击编辑（更新）链接时，出现错误：

* * *

“无效的回发或回调参数。事件验证在配置中启用或在页面中使用 <%@ Page EnableEventValidation="true" %>...

堆栈跟踪：

```
[ArgumentException：回发或回调参数无效。使用配置或页面启用事件验证。出于安全目的，此功能验证回发或回调事件的参数是否源自最初呈现它们的服务器控件。如果数据有效且符合预期，请使用 ClientScriptManager.RegisterForEventValidation 方法注册回发或回调数据以进行验证。]
   System.Web.UI.ClientScriptManager.ValidateEvent（字符串唯一标识，字符串参数）+144
   System.Web.UI.Control.ValidateEvent（字符串唯一ID，字符串事件参数）+111
   System.Web.UI.WebControls.GridView.RaisePostBackEvent（字符串 eventArgument）+32
   System.Web.UI.WebControls.GridView.System.Web.UI.IPostBackEventHandler.RaisePostBackEvent（字符串 eventArgument）+13
   System.Web.UI.Page.RaisePostBackEvent(IPostBackEventHandler sourceControl, String eventArgument) +13
   System.Web.UI.Page.RaisePostBackEvent(NameValueCollection postData) +9643314
   System.Web.UI.Page.ProcessRequestMain（布尔 includeStagesBeforeAsyncPoint，布尔 includeStagesAfterAsyncPoint）+1724

版本信息：Microsoft .NET Framework 版本：4.0.30319；ASP.NET 版本：4.0.30319.17929"`

```

* * *

我已经尝试了以下（但仍然是同样的错误）：

我添加了一个 Render 子程序，它注册了 select 和 update 中的所有值以进行事件验证：

```
Protected Overrides Sub Render(ByVal writer As System.Web.UI.HtmlTextWriter)

    'override (page) Render and loop over the GridView Rows
    Dim row As GridViewRow
    For Each row In GridView3.Rows
        If (row.RowType = DataControlRowType.DataRow) Then        
            Page.ClientScript.RegisterForEventValidation(New System.Web.UI.PostBackOptions(Me.GridView3, "Select$" + row.RowIndex.ToString()))
            Page.ClientScript.RegisterForEventValidation(New System.Web.UI.PostBackOptions(Me.GridView3, "Update$" + row.RowIndex.ToString()))          
        End If   
    Next

    MyBase.Render(writer) 
```

...

我还尝试重新绑定gridview和数据源：

```
 If Not (IsPostBack) Then
       SqlDataSource2.DataBind()
       GridView3.DataBind()
    End If 
```

我还尝试在 Page 标记中添加 EnableEventValidation="false"。发生的情况是我现在可以按编辑链接，但随后 UpdatePanel 消失（根据 Page_Load），然后当我从下拉列表中选择值时，它再次出现在编辑模式下的行，但用空白而不是行的当前值。

我还尝试在 gridview 所在的同一 updatePanel 之外定义 gridview 的数据源，但这没有任何区别。

只是为了确认一下，如果我没有在 Page_Load 代码中使 UpdatePanels visible=false 以便用户可以看到所有这些，那么 gridviews 可以很好地更新行。这使我认为问题在于无状态，好像我理解正确一样，当按下 Edit 链接时，再次调用 Page_Load 代码并且不再保留 dropdownlistvalue，从而使 gridview 所在的 updatepanel 再次可见 = false .

那么，有没有其他方法可以根据不是 Page_Load 的下拉列表选择隐藏更新面板？这可能是解决方案所在吗？

或者在编辑链接（Page_Load 调用）完成后让下拉列表选择的值保持不变的另一种方法？

我认为我走在正确的轨道上，但获得一些指导会很有帮助。

# c++ - select() 在 send() 之后不会超时

> ID：15558740
> 
> 赞同：0
> 
> 时间：2013-03-21T21:41:52.017
> 
> 标签：c++, sockets, select, timeout, udp

我开始锁定套接字编程并遇到了一些麻烦：我创建了下面的小程序，它通过 udp 发送消息并在可能的循环中接收消息。我想稍后尝试使用多个套接字，所以我使用`select()`.

当我使用 my时`127.0.0.1`，`select()`在第一个循环中（在 之后）给出超时，`send()`但之后它总是返回`1`指示套接字是可读的而没有收到消息：

```
//C++
WSADATA wsa;
SOCKADDR_IN RemoteAddr;
SOCKADDR_IN OwnAddr;
SOCKET UDP_Socket1;
fd_set m_Fds;
struct timeval m_Timeout;
int iRemoteAddrLenght = sizeof(SOCKADDR_IN);
int i = 0;

//--Init
WSAStartup (MAKEWORD (2,2), &wsa);
UDP_Socket1 = socket(AF_INET, SOCK_DGRAM, 0);
m_Timeout.tv_sec = 2;
m_Timeout.tv_usec = 0;

RemoteAddr.sin_family = AF_INET;
RemoteAddr.sin_port = htons (2002);
RemoteAddr.sin_addr.s_addr = inet_addr("127.0.0.1");   

OwnAddr.sin_family = AF_INET;
OwnAddr.sin_port = htons (2003);
OwnAddr.sin_addr.s_addr = htonl(INADDR_ANY);

bind(UDP_Socket1, (SOCKADDR*) &OwnAddr, sizeof(OwnAddr));

for(;;)
{
    //..//
    //--send
    sendto(UDP_Socket1, sSend.c_str(), strlen(sSend.c_str()), 0 ,  (SOCKADDR*)&RemoteAddr, sizeof(RemoteAddr));

    //--select & recv
    FD_ZERO(&m_Fds);
    FD_SET(UDP_Socket1,&m_Fds);
    i = select(sizeof(m_Fds)*8, &m_Fds, NULL, NULL, &m_Timeout);
    if(i > 0)
    {
        recvfrom(UDP_Socket1, m_szBuff, 256, 0, (SOCKADDR*) &RemoteAddr, &m_iRemoteAddrLenght);
    } //if
    else if(i < 1)        // "0" in 1st loop, then "1" =(
    {
        cout << "Udp Timeout" << endl;    
    } //else if
} //for 
```

`send`返回`56`（发送字节）`WSAGetLastError: 0`

`recvfrom`返回`-1` _`WSAGetLastError: 10054`

感谢您提供有关为什么在应该超时时`select()`返回的帮助`1`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-28T03:38:45.940

对于 UDP，您可以忽略这些类型的错误。有些操作系统会报告它们，有些则不会。它们基本上没有意义。

# sql-server - 使用 lambda 语法的 LINQ

> ID：15558741
> 
> 赞同：0
> 
> 时间：2013-03-21T21:41:55.197
> 
> 标签：sql-server, asp.net-mvc, c#-3.0

```
public class ConvertedReading
{
    public int DatePointID { get; set; }
    public string DatapointName { get; set; }
    public DateTime ReadingDate { get; set; }
    public double Value { get; set; }
} 
```

给定以下集合：

```
 IEnumerable<ConvertedReading> readingData; 
```

使用 c# ，使用 lambda 语法编写一个 LINQ 语句以输出以下内容的集合：

```
public class DataPointTotal
{
    public string DatapointName{get; set;}
    public double Total{get; set;}
} 
```

每件应退回一件`datepointID`

Total 应该表示`convertedReading.valye`每个相关的总和`datePointID`

我已经尝试过以下方法，如果它有效，我似乎无法得到正确的价值总和。

```
var subtotals = from x in ConvertedReading group x by x.DatapointName into g select new { Type = x.DatapointName , SubTotal = g.Sum(x => x.Total) }; 
```

语法是否正确？

多谢你们，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T21:50:05.640

答案是：

```
var result = readingData.GroupBy(r => r.DataPointID)
                        .Select(g => new DataPointTotal
                                {
                                    DataPointName = g.First().DataPointName,
                                    Total = g.Sum(r => r.Value)
                                }); 
```

但考虑到我写了这个问题，我想这是作弊！;)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T21:52:12.050

```
var result = db.ConvertedReading.GroupBy(i=>i.DatapointName).Select(g => new DataPointTotal(){DatapointName = g.DatapointName, Total = g.Sum(i=>i.Total)}); 
```

# c# - 如何在个人商店中给予证书完全信任？

> ID：15558751
> 
> 赞同：0
> 
> 时间：2013-03-21T21:42:53.197
> 
> 标签：c#, asp.net, wcf, iis, certificate

我创建了一个使用基本身份验证（sql 成员资格提供程序）和 https 的简单 WCF Web 服务。尽管我的客户尝试访问它时遇到问题。

我几乎 100% 肯定这与证书不被信任有关，尽管我认为几乎所有的东西都试过了。

该应用程序托管在 IIS 中。当我尝试编辑“默认网站”的绑定并为 https 选择证书时，它只显示我个人存储中的证书。所以我不能从受信任的商店中选择任何证书。

我尝试在 MMC 中从个人添加权限并将其拖回受信任的人或受信任的 CA 存储，尽管它仍然没有出现在 IIS 中。

我的客户端返回的错误是：错误：底层连接已关闭：无法为 SSL/TLS 安全通道建立信任关系。

我已经[在这里](https://stackoverflow.com/questions/10580326/privatekey-trust-permissions-for-local-machine-trusted-roots-certificates)尝试了一切来解决这个问题。

他们有什么方法可以从受信任的商店为 IIS 中的 https 设置证书吗？或者，如果这不是问题，有人可以阐明真正的问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T22:39:10.503

几个月前我遇到了这个问题，您的问题可能与我遇到的问题相同。

我的证书来自第 3 方。我将它安装在个人商店中，并提供了证书随附的密码。我设置了我的 web.config、绑定、端点，我可以在 IIS 中看到证书等。一切看起来都很好。无论我尝试什么，我都会收到错误消息：

`The underlying connection was closed: Could not establish trust relationship for the SSL/TLS secure channel`

最后我发现在 IIS 中运行 ApplicationPool 的进程没有访问证书的权限。使用`inetmgr.exe`我单击应用程序池，右键单击用于我的网站的应用程序池并选择`Advanced Settings`。在 Section 下的对话框中`Process Model`有一个`Identity`属性。这被设置为`ApplicationPoolIdentity`，我将其更改为`NetworkService`认为这应该具有权限。又试了一次，它奏效了。

我希望这有帮助。

# android - ScrollView 不能与 LinearLayout 一起使用

> ID：15558752
> 
> 赞同：0
> 
> 时间：2013-03-21T21:42:55.927
> 
> 标签：android, android-linearlayout, android-scrollview

滚动视图不工作。我尝试了不同的组合，但没有运气。有人能指出我哪里出错了吗？

```
 <?xml version="1.0" encoding="utf-8"?>
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical"
    android:fillViewport="true" >

    <LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical" >

        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:background="#333333"
            android:orientation="horizontal" >

            <ImageView
                android:layout_width="48dp"
                android:layout_height="48dp"
                android:src="@drawable/ic_launcher" />

            <com.appsolute.ultimateproject.TypedfacedTextView
                xmlns:android="http://schemas.android.com/apk/res/android"
                xmlns:font="http://schemas.android.com/apk/res/com.appsolute.ultimateproject"
                android:id="@+id/overview"
                android:layout_width="wrap_content"
                android:layout_height="match_parent"
                android:gravity="center"
                android:textAppearance="?android:attr/textAppearanceMedium"
                android:textColor="#ffffff"
                font:typeface="Roboto-Condensed.ttf" />
        </LinearLayout>

        <ListView
            xmlns:android="http://schemas.android.com/apk/res/android"
            android:id="@android:id/list"
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:background="#ffffff"
            android:paddingLeft="@dimen/list_padding"
            android:paddingRight="@dimen/list_padding" />

        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:background="#333333"
            android:orientation="horizontal"
            android:paddingTop="10dp" >

            <com.appsolute.ultimateproject.TypedfacedTextView
                xmlns:android="http://schemas.android.com/apk/res/android"
                xmlns:font="http://schemas.android.com/apk/res/com.appsolute.ultimateproject"
                android:id="@+id/header"
                android:layout_width="wrap_content"
                android:layout_height="match_parent"
                android:gravity="center"
                android:paddingBottom="2dp"
                android:textAppearance="?android:attr/textAppearanceSmall"
                android:textColor="#ffffff"
                font:typeface="Roboto-Condensed.ttf" />
        </LinearLayout>

        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:orientation="horizontal"
            android:paddingTop="10dp" >

            <ImageView
                android:layout_width="48dp"
                android:layout_height="48dp"
                android:src="@drawable/ic_action_person" />

            <com.appsolute.ultimateproject.TypedfacedTextView
                xmlns:android="http://schemas.android.com/apk/res/android"
                xmlns:font="http://schemas.android.com/apk/res/com.appsolute.ultimateproject"
                android:id="@+id/header"
                android:layout_width="wrap_content"
                android:layout_height="match_parent"
                android:gravity="center"
                android:textAppearance="?android:attr/textAppearanceSmall"
                font:typeface="Roboto-Condensed.ttf" />
        </LinearLayout>

        <View
            android:layout_width="wrap_content"
            android:layout_height="1dp"
            android:background="#333333"
            android:padding="1dp" />

        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:orientation="horizontal"
            android:paddingTop="1dp" >

            <ImageView
                android:layout_width="48dp"
                android:layout_height="48dp"
                android:src="@drawable/ic_action_fav" />

            <com.appsolute.ultimateproject.TypedfacedTextView
                xmlns:android="http://schemas.android.com/apk/res/android"
                xmlns:font="http://schemas.android.com/apk/res/com.appsolute.ultimateproject"
                android:id="@+id/favorites"
                android:layout_width="wrap_content"
                android:layout_height="match_parent"
                android:gravity="center"

                android:textAppearance="?android:attr/textAppearanceSmall"
                font:typeface="Roboto-Condensed.ttf" />
        </LinearLayout>

        <View
            android:layout_width="wrap_content"
            android:layout_height="1dp"
            android:background="#333333"
            android:padding="1dp" />

        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:orientation="horizontal"
            android:paddingTop="1dp" >

            <ImageView
                android:layout_width="48dp"
                android:layout_height="48dp"
                android:src="@drawable/ic_action_save" />

            <com.appsolute.ultimateproject.TypedfacedTextView
                xmlns:android="http://schemas.android.com/apk/res/android"
                xmlns:font="http://schemas.android.com/apk/res/com.appsolute.ultimateproject"
                android:id="@+id/saved"
                android:layout_width="wrap_content"
                android:layout_height="match_parent"
                android:gravity="center"
                android:textAppearance="?android:attr/textAppearanceSmall"
                font:typeface="Roboto-Condensed.ttf" />
        </LinearLayout>
    </LinearLayout>

</ScrollView> 
```

我使用了 fillViewport 并且还对底层内容进行了包装。请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T21:50:33.927

每['我怎样才能把`ListView`一个`ScrollView`'？问题](https://stackoverflow.com/questions/3495890/how-can-i-put-a-listview-into-a-scrollview-without-it-collapsing)和随后的答案，`ListView`s 处理自己的内部滚动，并且将一个滚动容器放入另一个滚动容器既昂贵（从布局性能的角度来看）又不可行。

解决此问题的最简单方法是使用[ListView.addHeaderView](http://developer.android.com/reference/android/widget/ListView.html#addHeaderView%28android.view.View%29)和[ListView.addFooterView](http://developer.android.com/reference/android/widget/ListView.html#addFooterView%28android.view.View%29)如果您希望布局中的其他项目随`ListView`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T21:47:39.867

NEVER put a ListView inside of a ScrollView! Google for "android ListView in Scrollview" for more information. One example would be this one: [How can I put a ListView into a ScrollView without it collapsing?](https://stackoverflow.com/questions/3495890/how-can-i-put-a-listview-into-a-scrollview-without-it-collapsing)

# javascript - 如何检测 iframe 页面何时开始加载？

> ID：15558759
> 
> 赞同：4
> 
> 时间：2013-03-21T21:43:30.810
> 
> 标签：javascript, jquery, iframe

我希望 iframe 的开启者能够检测到用户每次更改该 iframe 中的页面。使用 jQuery，我可以通过以下方式检测每次页面在 iframe 中*完成*加载的时间：

```
$('#myIframe').on('load', function() {/*do stuff*/}); 
```

但是，我还想在每次页面*开始*在该 iframe 中加载时检测（在 iframe*开启器中）。*

 *注意：iframe 中显示的内容来自第三方站点，因此我无法在其中插入代码，以便 iframe 可以显式提醒开启者。

有谁知道页面开始加载时触发的事件？我没有太多运气通过互联网搜索找到任何东西，因为大多数人似乎只对检测 iframe 何时*完成*加载感兴趣。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T21:53:56.673

不幸的是，确保它在大多数浏览器中工作的唯一方法是使用`<iframe onload="myonloadscript();"`

主页的`window.onload`事件将告诉您 iframe 何时加载，您可以确定它已经开始请求它的 src 页面

* * *

**编辑：**

只是从一篇文章中复制它（[他们是对此的黑客](http://blog.cakemail.com/the-iframe-cross-domain-policy-problem/)）

*做这个跨域？没那么容易。您会得到以下内容：子文档无权访问父文档。事实上，网络上有很多关于如何实现它的文档，但问题是它经常过时，解决方案通常只适用于几个浏览器。**

# python - 展平链表中的“下一个”和“上一个”链接

> ID：15558763
> 
> 赞同：3
> 
> 时间：2013-03-21T21:43:51.870
> 
> 标签：python

我有一个代表数据结构遍历的字符串列表。我想将链接列表遍历折叠成更紧凑的表示。为此，我想计算相邻`next`和`prev`链接的数量并将它们折叠成一个整数。

以下是我想做的转换示例：

```
['modules']                                   -->  ['modules']
['modules', 'next']                           -->  ['modules', 1]
['modules', 'prev']                           -->  ['modules', -1]
['modules', 'next', 'next', 'next', 'txt']    -->  ['modules', 3, 'txt']
['modules', 'next', 'prev', 'next', 'txt']    -->  ['modules', 1, 'txt']
['super_blocks', 'next', 's_inodes', 'next']  -->  ['super_blocks', 1, 's_inodes', 1] 
```

每个`next`链接计为+1，每个链接`prev`为-1。相邻`next`的 s 和`prev`s 相互抵消。他们可以按任何顺序出现。

我有一个可行的解决方案，但我正在努力寻找一个令人满意的优雅和 Pythonic 的解决方案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-21T21:49:40.050

您可以使用生成器：

```
def links(seq):
    it = iter(seq)
    while True:
        el = next(it)
        cnt = 0
        try:
            while el in ['prev', 'next']:
                cnt += (1 if el == 'next' else -1)
                el = next(it)
        finally:
            if cnt != 0:
                yield cnt
        yield el

print list(links(['modules', 'next', 'prev', 'next', 'txt'])) 
```

值得注意的是，包含相同数量`next`和的序列`prev`会被完全删除。如果这是您想要的，则可以很容易地更改代码以生成 a `0`（我认为对此的要求还不清楚）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T21:54:52.383

这是我想到的最直接的方法。直截了当是理解、调试和未来维护的宝贵品质。

```
def process(l):
    result = []
    count = 0
    keepCount = False
    for s in l:
        if s == "next":
            count += 1
            keepCount = True
        elif s == "prev":
            count -= 1
            keepCount = True
        else:
            if keepCount:
                result.append(count)
                count = 0
                keepCount = False
            result.append(s)
        # end if
    # end for
    if keepCount:
        result.append(count)

    return result
# end process() 
```

不过，我确实更喜欢 NPE 使用生成器。（我的可以通过将'result.append（）'更改为'yield'来轻松转换）他的*（原始）*答案与我的几乎相同，但如果下一个/上一个标记相邻，我会包括0计数数量相等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-21T22:12:00.900

一点点怎么样`reduce()`？

```
def collapse(lst):
    was_link = [False] # No nonlocal in Python 2.x :(
    def step(lst, item):
        val = { 'prev': -1, 'next': 1 }.get(item)

        if was_link[0] and val:
            lst[-1] += val
        else:
            lst.append(val or item)
        was_link[0] = bool(val)

        return lst

    return reduce(step, [[]] + lst) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-21T22:15:12.460

怎么样：

```
def convert(ls):
    last = None
    for x in ls:
        if x == 'prev': x = -1
        if x == 'next': x = +1
        if isinstance(x, int) and isinstance(last, int):
            x += last
        elif last:  # last is not None if you want zeroes
            yield last
        last = x
    yield last 
```

# .net - PowerShell 中的 .Net 异步方法：Net.Mail.SmtpClient::Send() 并不总是同步的？（通过计划任务不一致）

> ID：15558767
> 
> 赞同：1
> 
> 时间：2013-03-21T21:44:08.267
> 
> 标签：.net, email, powershell, asynchronous, scheduled-tasks

## 问题：

发送电子邮件的 PowerShell 脚本在从交互式会话调用时有效，但在通过计划任务调用时失败。这似乎是由于脚本退出时 SMTP 会话在传输过程中被中断所致。自然，这不会在交互式会话期间发生，因为脚本结束后会话继续存在。但是，当通过计划任务调用时，会话在脚本结束时被终止。

脚本：

```
 $msg = New-Object Net.Mail.MailMessage
    foreach( $To in $Recipients ) {
      $msg.To.Add($To)
    }
    $msg.From = $From
    $msg.Subject = $Subject
    $msg.Body = $Body
    $ctype = New-Object Net.Mime.ContentType -Property @{
      MediaType = [Net.Mime.MediaTypeNames+Application]::Octet
      Name = $AttachmentName
    }
    $msg.Attachments.Add([Net.Mail.Attachment]::CreateAttachmentFromString($csv, $ctype))
    $client = new-object System.Net.Mail.SmtpClient($SMTPServer)
    $client.Send($msg) 
```

## 问题

System.Net.Mail.SmtpClient::Send() 应该是同步的，但在实践中并不是这样。我知道我可以通过在脚本结束时让脚本休眠一小段时间来缓解这种情况。坦率地说，这是一些非常草率的工作，我拒绝那样做。最好的解决方法是什么？

注意：`Send-MailMessage`不合适，因为我宁愿避免创建文件以制作附件。我不确定它是否遇到同样的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T21:44:08.267

## 解决方案：SendAsync()

不幸的`Send()`是，它不像文档声称的那样同步。我发现使用异步变体`SendAsync()`并使用`SendCompleted`事件来提供同步性是最有益的。请参阅我为解决这个问题而编写的以下通用函数（尽管它可用于各种异步调用）：

```
<#
.SYNOPSIS
  Calls a script block and waits for the specified event.
.DESCRIPTION
  Provides a convenient way to call an asynchronous method with synchronous semantics.
  This is achieved by registering to receive an event before calling the block that is
  expected to signal its completion via a .NET event.  The given script block need not
  necessarily cause the event to be signaled, but that is the most obvious use case.
.PARAMETER EventSource
  The object expected to raise the event.
.PARAMETER EventName
  The name of the expected event.
.PARAMETER ScriptBlock
  This block will be executed after registering the event and before waiting for the event.
.PARAMETER Timeout
  Maximum duration in seconds to wait for the expected event.  Default value of -1 means
  to wait indefinitely.  No error is raised when this timeout is reached.
.NOTES
  Author:  Erik Elmore <erik@ironsavior.net>
#>
function Wait-AsyncCall {
  Param(
    [Parameter(Mandatory = $True, Position = 0)]
    $EventSource,
    [Parameter(Mandatory = $True, Position = 1)]
    [string]$EventName,
    [Parameter(Mandatory = $True, Position = 2)]
    [ScriptBlock]$ScriptBlock,
    [int]$Timeout = -1
  )
  $id = "Wait-AsyncCall:$($EventName):$([guid]::NewGuid().ToString())"
  Register-ObjectEvent $EventSource $EventName -SourceIdentifier $id -EA Stop
  try {
    $output = &$ScriptBlock
    Wait-Event -SourceIdentifier $id -Timeout $Timeout -EA SilentlyContinue |Remove-Event -EA SilentlyContinue
  }
  finally {
    Unregister-Event -SourceIdentifier $id -EA SilentlyContinue
  }
  $output
} 
```

使用`Wait-AsyncCall`，我可以改用该`AsyncSend()`方法，但使用同步语义。原来的代码块就变成了：

```
$msg = New-Object Net.Mail.MailMessage
foreach( $To in $Recipients ) {
  $msg.To.Add($To)
}
$msg.From = $From
$msg.Subject = $Subject
$msg.Body = $Body
$ctype = New-Object Net.Mime.ContentType -Property @{
  MediaType = [Net.Mime.MediaTypeNames+Application]::Octet
  Name = $AttachmentName
}
$msg.Attachments.Add([Net.Mail.Attachment]::CreateAttachmentFromString($csv, $ctype))
$client = new-object System.Net.Mail.SmtpClient($SMTPServer)
Wait-AsyncCall $client "SendCompleted" { $client.SendAsync($msg, $Null) } 
```

# php - PHP：如何获取内部参数？

> ID：15558770
> 
> 赞同：13
> 
> 时间：2013-03-21T21:44:12.290
> 
> 标签：php, command-line-arguments

给定命令：

```
/usr/bin/php -c /path/to/custom/php.ini /path/to/script.php 
```

我想获得内部选项：

```
-c /path/to/custom/php.ini 
```

我试过的东西不起作用：

*   **`$argv`**包含`['/path/to/script.php']`
*   **`getopt('c')`**包含`[]`
*   **`$_ENV`**不包含它
*   **`$_SERVER`** 不包含它

我还寻找了一个`PHP_*`常数（例如`PHP_BINARY`），但找不到这些参数的常数。

有没有办法得到这些论点？请注意，我不是试图获取加载的`ini`文件，而是获取此处可能存在的任何参数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T22:03:30.293

PHP 没有这样做的内部方法，因此您将不得不依赖某些系统信息和权限。

```
$pid = getmypid();
$ps = `ps aux | grep $pid`;
$command = substr($ps, strpos($ps, '/usr/bin/php'));
$args = explode(' ', $command); //not pretty, should probably use preg 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T21:47:49.153

`-c /path/to/custom/php.ini` is an option passed to the PHP parser, interpretator and other internall stuff before even starting your script.

`/path/to/script.php` is an actual argument passed not only to the PHP executable, but to your script.

Following arguments like `/usr/bin/php -c /path/to/custom/php.ini /path/to/script.php A B C` would also be passed to your script.

Unfortunately the `-c` option is not one of them.

You could get the used `php.ini` file within the executed PHP script by using `get_cfg_var`.

```
echo get_cfg_var('cfg_file_path'); 
```

If you are passing the `-c` option you would get the path to your php.ini file. Otherwise you would get the default php.ini file.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T22:00:09.627

不幸的是，由于命令行 BASH 参数的解析方式，您将无法在脚本调用之前访问这些参数。目前，该程序`/usr/bin/php`已

```
argv[0]=/usr/bin/php
argv[1]=-c
argv[2]=/path/to/custom/php.ini
argv[3]=/path/to/script.php 
```

这就是你的论点落地的地方。另一方面，您的脚本具有：

```
argv[0]=/path/to/script.php 
```

只是因为参数是从右到左处理的，并且在您的脚本调用之后没有参数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T22:47:34.203

我会使用如下的东西，因为它不需要任何解析。

```
$ (ARGS="-c /path/to/custom/php.ini"; /usr/bin/php $ARGS /path/to/script.php $ARGS) 
```

# ruby - TFTP数据包示例？

> ID：15558780
> 
> 赞同：0
> 
> 时间：2013-03-21T21:44:35.720
> 
> 标签：ruby, tftp

我正在用 Ruby 编写一个 TFTP 服务器，但我不明白一些事情。

首先，我通读[了整个 RFC](http://www.ietf.org/rfc/rfc1350.txt)，了解了数据包的 TFTP 部分（2 字节操作码等），但我不知道 TID 的去向。此外，我从未在 Ruby 中以字节级别做过任何事情。我不知道如何创建一个 2 个字节的变量，然后是 1 个字节的那个，然后是什么。

如果有人可以向我展示如何在 ruby​​ 中构建读取请求数据包的示例，那就太好了。假设我在客户端，我选择端口#20000（用于我的本地 TID），我想读取`/Users/pachun/documents/hello.txt`服务器上命名的文件，该文件现在的 TID 为 69，因为它是第一个请求。我将如何在 Ruby 中构建该数据包？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T22:25:39.137

看看这个项目：

[https://github.com/spiceworks/net-tftp](https://github.com/spiceworks/net-tftp)

那里的代码应该回答您有关如何构造字节序列以与 tftp 协议通信的问题。

# ruby-on-rails - auto_html 打破轨道迁移

> ID：15558781
> 
> 赞同：1
> 
> 时间：2013-03-21T21:44:36.943
> 
> 标签：ruby-on-rails, rails-migrations

我在使用 auto_html 中断 Rails 迁移时遇到了麻烦。我在新的 db/first 迁移运行中得到了这个跟踪（见结尾，因为它很大）。

我通过在模型中注释掉这样的代码来解决它：

```
 auto_html_for :story do
    strip_tags
    html_escape
  end 
```

有关如何处理此问题的任何建议，以便迁移正常运行而无需注释掉？

```
$rake db:migrate

** Invoke db:migrate (first_time)
** Invoke environment (first_time)
** Execute environment
rake aborted!
PG::Error: ERROR:  relation "profiles" does not exist
LINE 4:              WHERE a.attrelid = '"profiles"'::regclass
                                        ^
:             SELECT a.attname, format_type(a.atttypid, a.atttypmod), d.adsrc, a.attnotnull
              FROM pg_attribute a LEFT JOIN pg_attrdef d
                ON a.attrelid = d.adrelid AND a.attnum = d.adnum
             WHERE a.attrelid = '"profiles"'::regclass
               AND a.attnum > 0 AND NOT a.attisdropped
             ORDER BY a.attnum
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/activerecord-3.2.8/lib/active_record/connection_adapters/postgresql_adapter.rb:1158:in `async_exec'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/activerecord-3.2.8/lib/active_record/connection_adapters/postgresql_adapter.rb:1158:in `exec_no_cache'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/activerecord-3.2.8/lib/active_record/connection_adapters/postgresql_adapter.rb:664:in `block in exec_query'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract_adapter.rb:280:in `block in log'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/activesupport-3.2.8/lib/active_support/notifications/instrumenter.rb:20:in `instrument'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/activerecord-3.2.8/lib/active_record/connection_adapters/abstract_adapter.rb:275:in `log'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/activerecord-3.2.8/lib/active_record/connection_adapters/postgresql_adapter.rb:663:in `exec_query'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/activerecord-3.2.8/lib/active_record/connection_adapters/postgresql_adapter.rb:1283:in `column_definitions'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/activerecord-3.2.8/lib/active_record/connection_adapters/postgresql_adapter.rb:859:in `columns'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/activerecord-3.2.8/lib/active_record/connection_adapters/schema_cache.rb:12:in `block in initialize'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/activerecord-3.2.8/lib/active_record/model_schema.rb:228:in `yield'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/activerecord-3.2.8/lib/active_record/model_schema.rb:228:in `default'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/activerecord-3.2.8/lib/active_record/model_schema.rb:228:in `columns'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/activerecord-3.2.8/lib/active_record/model_schema.rb:248:in `column_names'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/auto_html-1.6.0/lib/auto_html/auto_html_for.rb:21:in `auto_html_for'
/Users/heather/3r/website/app/models/profile.rb:73:in `<class:Profile>'
/Users/heather/3r/website/app/models/profile.rb:1:in `<top (required)>'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:469:in `load'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:469:in `block in load_file'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:639:in `new_constants_in'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:468:in `load_file'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:353:in `require_or_load'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:502:in `load_missing_constant'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:192:in `block in const_missing'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:190:in `each'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:190:in `const_missing'
/Users/heather/3r/website/app/admin/profiles.rb:1:in `<top (required)>'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:245:in `load'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:245:in `block in load'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:236:in `load_dependency'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:245:in `load'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/activeadmin-0.5.1/lib/active_admin/application.rb:190:in `block in load!'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/activeadmin-0.5.1/lib/active_admin/application.rb:190:in `each'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/activeadmin-0.5.1/lib/active_admin/application.rb:190:in `load!'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/activeadmin-0.5.1/lib/active_admin/application.rb:213:in `routes'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/activeadmin-0.5.1/lib/active_admin.rb:79:in `routes'
/Users/heather/3r/website/config/routes.rb:41:in `block in <top (required)>'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/actionpack-3.2.8/lib/action_dispatch/routing/route_set.rb:282:in `instance_exec'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/actionpack-3.2.8/lib/action_dispatch/routing/route_set.rb:282:in `eval_block'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/actionpack-3.2.8/lib/action_dispatch/routing/route_set.rb:260:in `draw'
/Users/heather/3r/website/config/routes.rb:28:in `<top (required)>'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:245:in `load'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:245:in `block in load'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:236:in `load_dependency'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:245:in `load'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/railties-3.2.8/lib/rails/application/routes_reloader.rb:40:in `block in load_paths'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/railties-3.2.8/lib/rails/application/routes_reloader.rb:40:in `each'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/railties-3.2.8/lib/rails/application/routes_reloader.rb:40:in `load_paths'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/railties-3.2.8/lib/rails/application/routes_reloader.rb:16:in `reload!'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/railties-3.2.8/lib/rails/application.rb:108:in `reload_routes!'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/activeadmin-0.5.1/lib/active_admin/reloader.rb:34:in `reload!'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/activeadmin-0.5.1/lib/active_admin/reloader.rb:61:in `block in attach!'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:429:in `_run__574638835061218640__prepare__331886071729593740__callbacks'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:405:in `__run_callback'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:385:in `_run_prepare_callbacks'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/activesupport-3.2.8/lib/active_support/callbacks.rb:81:in `run_callbacks'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/actionpack-3.2.8/lib/action_dispatch/middleware/reloader.rb:74:in `prepare!'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/actionpack-3.2.8/lib/action_dispatch/middleware/reloader.rb:48:in `prepare!'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/railties-3.2.8/lib/rails/application/finisher.rb:47:in `block in <module:Finisher>'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/railties-3.2.8/lib/rails/initializable.rb:30:in `instance_exec'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/railties-3.2.8/lib/rails/initializable.rb:30:in `run'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/railties-3.2.8/lib/rails/initializable.rb:55:in `block in run_initializers'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/railties-3.2.8/lib/rails/initializable.rb:54:in `each'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/railties-3.2.8/lib/rails/initializable.rb:54:in `run_initializers'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/railties-3.2.8/lib/rails/application.rb:136:in `initialize!'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/railties-3.2.8/lib/rails/railtie/configurable.rb:30:in `method_missing'
/Users/heather/3r/website/config/environment.rb:5:in `<top (required)>'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `require'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `block in require'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:236:in `load_dependency'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/activesupport-3.2.8/lib/active_support/dependencies.rb:251:in `require'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/railties-3.2.8/lib/rails/application.rb:103:in `require_environment!'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/gems/railties-3.2.8/lib/rails/application.rb:295:in `block (2 levels) in initialize_tasks'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@global/gems/rake-10.0.3/lib/rake/task.rb:228:in `call'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@global/gems/rake-10.0.3/lib/rake/task.rb:228:in `block in execute'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@global/gems/rake-10.0.3/lib/rake/task.rb:223:in `each'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@global/gems/rake-10.0.3/lib/rake/task.rb:223:in `execute'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@global/gems/rake-10.0.3/lib/rake/task.rb:166:in `block in invoke_with_call_chain'
/Users/heather/.rvm/rubies/ruby-1.9.3-p392/lib/ruby/1.9.1/monitor.rb:211:in `mon_synchronize'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@global/gems/rake-10.0.3/lib/rake/task.rb:159:in `invoke_with_call_chain'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@global/gems/rake-10.0.3/lib/rake/task.rb:187:in `block in invoke_prerequisites'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@global/gems/rake-10.0.3/lib/rake/task.rb:185:in `each'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@global/gems/rake-10.0.3/lib/rake/task.rb:185:in `invoke_prerequisites'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@global/gems/rake-10.0.3/lib/rake/task.rb:165:in `block in invoke_with_call_chain'
/Users/heather/.rvm/rubies/ruby-1.9.3-p392/lib/ruby/1.9.1/monitor.rb:211:in `mon_synchronize'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@global/gems/rake-10.0.3/lib/rake/task.rb:159:in `invoke_with_call_chain'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@global/gems/rake-10.0.3/lib/rake/task.rb:152:in `invoke'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@global/gems/rake-10.0.3/lib/rake/application.rb:143:in `invoke_task'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@global/gems/rake-10.0.3/lib/rake/application.rb:101:in `block (2 levels) in top_level'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@global/gems/rake-10.0.3/lib/rake/application.rb:101:in `each'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@global/gems/rake-10.0.3/lib/rake/application.rb:101:in `block in top_level'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@global/gems/rake-10.0.3/lib/rake/application.rb:110:in `run_with_threads'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@global/gems/rake-10.0.3/lib/rake/application.rb:95:in `top_level'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@global/gems/rake-10.0.3/lib/rake/application.rb:73:in `block in run'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@global/gems/rake-10.0.3/lib/rake/application.rb:160:in `standard_exception_handling'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@global/gems/rake-10.0.3/lib/rake/application.rb:70:in `run'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@global/gems/rake-10.0.3/bin/rake:33:in `<top (required)>'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@global/bin/rake:19:in `load'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@global/bin/rake:19:in `<main>'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/bin/ruby_noexec_wrapper:14:in `eval'
/Users/heather/.rvm/gems/ruby-1.9.3-p392@3r/bin/ruby_noexec_wrapper:14:in `<main>'
Tasks: TOP => db:migrate => environment
Heathers-MacBook-Pro:website heather$ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-07T13:59:05.367

我确实找到了一个解决方案，基本上如果 rake 正在运行 - 禁用 auto_html。这是 auto_html 初始化程序中的代码：

```
if File.basename($0) == 'rake' && ARGV.grep(/db:/)
  class ActiveRecord::Base
    def self.auto_html_for(field, &block)
        #nothing
    end
  end

else

  AutoHtml.add_filter(:strip_tags).with({}) do |text, options|
    view = ActionView::Base.new
    view.strip_tags text
  end
  AutoHtml.add_filter(:autolink).with({}) do |text, options|
    view = ActionView::Base.new
    view.auto_link(text, :html => { :target => '_blank', :rel => "nofollow" })
  end

  class ActiveRecord::Base
    class << self
      alias_method :auto_html_for!, :auto_html_for
    end

    def self.auto_html_for(field, &block)
      auto_html_for!(field, &block)
    end
  end

end 
```

# groovy - 带有 Geb 脚本的简单 Groovy

> ID：15558783
> 
> 赞同：1
> 
> 时间：2013-03-21T21:44:44.687
> 
> 标签：groovy, geb

我正在尝试学习 Geb，并在我的 Mac 上创建了一个 groovy 脚本并尝试运行它。我收到有关葡萄无法下载某些依赖项的错误。我需要做一些特别的事情才能让它工作吗？

```
@Grab(group='org.codehaus.geb', module='geb-core', version='0.7.1')
@Grab(group='org.seleniumhq.selenium', module='selenium-firefox-driver', version='2.31.0')

import geb.*
import org.openqa.selenium.firefox.FirefoxDriver

Browser.drive(driver: new FirefoxDriver()) {
    go "http://ebay.com/"
    $('input#gh-ac').value("transformers")
    $('input#gh-btn').click()
    sleep 10000
} 
```

这是我收到的错误消息。

```
org.codehaus.groovy.control.MultipleCompilationErrorsException: startup failed:
General error during conversion: Error grabbing Grapes -- [download failed: org.apache.httpcomponents#httpclient;4.2.1!httpclient.jar, download failed: org.apache.httpcomponents#httpcore;4.2.1!httpcore.jar]

java.lang.RuntimeException: Error grabbing Grapes -- [download failed: org.apache.httpcomponents#httpclient;4.2.1!httpclient.jar, download failed: org.apache.httpcomponents#httpcore;4.2.1!httpcore.jar]
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)
    at java.lang.reflect.Constructor.newInstance(Constructor.java:513)
    at org.codehaus.groovy.reflection.CachedConstructor.invoke(CachedConstructor.java:77)
    at org.codehaus.groovy.reflection.CachedConstructor.doConstructorInvoke(CachedConstructor.java:71)
    at org.codehaus.groovy.runtime.callsite.ConstructorSite$ConstructorSiteNoUnwrap.callConstructor(ConstructorSite.java:81)
    at org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCallConstructor(CallSiteArray.java:57)
    at org.codehaus.groovy.runtime.callsite.AbstractCallSite.callConstructor(AbstractCallSite.java:182)
    at org.codehaus.groovy.runtime.callsite.AbstractCallSite.callConstructor(AbstractCallSite.java:190)
    at groovy.grape.GrapeIvy.getDependencies(GrapeIvy.groovy:411)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.codehaus.groovy.runtime.callsite.PogoMetaMethodSite$PogoCachedMethodSite.invoke(PogoMetaMethodSite.java:231)
    at org.codehaus.groovy.runtime.callsite.PogoMetaMethodSite.callCurrent(PogoMetaMethodSite.java:52)
    at org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCallCurrent(CallSiteArray.java:49)
    at org.codehaus.groovy.runtime.callsite.AbstractCallSite.callCurrent(AbstractCallSite.java:133)
    at groovy.grape.GrapeIvy.resolve(GrapeIvy.groovy:546)
    at groovy.grape.GrapeIvy$resolve$0.callCurrent(Unknown Source)
    at org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCallCurrent(CallSiteArray.java:49)
    at org.codehaus.groovy.runtime.callsite.AbstractCallSite.callCurrent(AbstractCallSite.java:133)
    at org.codehaus.groovy.runtime.callsite.AbstractCallSite.callCurrent(AbstractCallSite.java:153)
    at groovy.grape.GrapeIvy.resolve(GrapeIvy.groovy:515)
    at groovy.grape.GrapeIvy$resolve.callCurrent(Unknown Source)
    at org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCallCurrent(CallSiteArray.java:49)
    at org.codehaus.groovy.runtime.callsite.AbstractCallSite.callCurrent(AbstractCallSite.java:133)
    at org.codehaus.groovy.runtime.callsite.AbstractCallSite.callCurrent(AbstractCallSite.java:149)
    at groovy.grape.GrapeIvy.grab(GrapeIvy.groovy:254)
    at groovy.grape.Grape.grab(Grape.java:141)
    at groovy.grape.GrabAnnotationTransformation.visit(GrabAnnotationTransformation.java:312)
    at org.codehaus.groovy.transform.ASTTransformationVisitor$3.call(ASTTransformationVisitor.java:319)
    at org.codehaus.groovy.control.CompilationUnit.applyToSourceUnits(CompilationUnit.java:912)
    at org.codehaus.groovy.control.CompilationUnit.doPhaseOperation(CompilationUnit.java:575)
    at org.codehaus.groovy.control.CompilationUnit.processPhaseOperations(CompilationUnit.java:551)
    at org.codehaus.groovy.control.CompilationUnit.compile(CompilationUnit.java:528)
    at groovy.lang.GroovyClassLoader.doParseClass(GroovyClassLoader.java:279)
    at groovy.lang.GroovyClassLoader.parseClass(GroovyClassLoader.java:258)
    at groovy.lang.GroovyClassLoader.parseClass(GroovyClassLoader.java:244)
    at groovy.lang.GroovyClassLoader.parseClass(GroovyClassLoader.java:185)
    at groovy.lang.GroovyShell$2.run(GroovyShell.java:206)
    at groovy.lang.GroovyShell$2.run(GroovyShell.java:204)
    at java.security.AccessController.doPrivileged(Native Method)
    at groovy.lang.GroovyShell.run(GroovyShell.java:204)
    at groovy.lang.GroovyShell.run(GroovyShell.java:150)
    at groovy.ui.GroovyMain.processOnce(GroovyMain.java:588)
    at groovy.ui.GroovyMain.run(GroovyMain.java:375)
    at groovy.ui.GroovyMain.process(GroovyMain.java:361)
    at groovy.ui.GroovyMain.processArgs(GroovyMain.java:120)
    at groovy.ui.GroovyMain.main(GroovyMain.java:100)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.codehaus.groovy.tools.GroovyStarter.rootLoader(GroovyStarter.java:106)
    at org.codehaus.groovy.tools.GroovyStarter.main(GroovyStarter.java:128)

1 error 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-16T05:14:08.153

我遇到了和上面一样的错误——下载httpclient的问题。

我在grapeConfig.xml 中注释了以下行，问题得到解决：

```
<ibiblio name="local" root="file:${user.home}/.m2/repository/" m2compatible="true"/> 
```

有趣的是，成功运行 Geb 脚本后，我可以重新启用上述 XML 行，脚本仍然运行。我猜“本地”.m2 存储库中的某些内容已损坏。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T01:41:12.560

在我看来这是一个环境问题。我刚刚将代码从您的代码片段复制粘贴到了一个 groovy 控制台，它可以正常工作。您是否在阻止 Ivy 连接到 Maven Central 的防火墙后面？

# sql - 用字符串更新数字列，错了

> ID：15558784
> 
> 赞同：0
> 
> 时间：2013-03-21T21:44:46.127
> 
> 标签：sql, sql-server

请参阅以下 sql 语句，我在其中添加了一个数字列并填充它。

```
 ALTER TABLE #TMP_TABLE1 ADD [WEIGHT RECORDED] [decimal](18, 2) NULL

  UPDATE #TMP_TABLE1 
  SET [WEIGHT RECORDED] = [TOTAL WEIGHT] * ISnull( COALESCE ( [AI PERCENTAGE_RECYCLED] ,[OI PERCENTAGE_RECYCLED],[SMB PERCENTAGE_RECYCLED])/100, 0)
  FROM #TMP_TABLE1 
```

现在我有一个要求，其中 3 列中不存在回收的百分比，然后`[WEIGHT RECORDED]`用`N/A`该记录填充列的内容。但是该`[WEIGHT RECORDED]`列是一个数字。如何在不更改列定义并损害为其他记录保留的数字的情况下执行此操作，这些记录将是数字？

# numpy - np.array 的 astype 是否会阻止将来在 DataFrames 中进行编辑？

> ID：15558785
> 
> 赞同：0
> 
> 时间：2013-03-21T21:44:47.490
> 
> 标签：numpy, dataframe, pandas

我最初可以更改 DataFrame 的第一个条目：

```
In [6]: df = pd.DataFrame(np.random.rand(5,2))
In [7]: df
Out[7]:
          0         1
0  0.514592  0.459589
1  0.329704  0.409099
2  0.061246  0.966191
3  0.336747  0.908513
4  0.169220  0.468437

In [8]: df.ix[0][0] = 1
In [9]: df
Out[9]:
          0         1
0  1.000000  0.459589
1  0.329704  0.409099
2  0.061246  0.966191
3  0.336747  0.908513
4  0.169220  0.468437 
```

但是在我这样做之后：

```
In [10]: df[0] = np.floor(df.index / 10).astype(int) * 10
In [11]: df
Out[11]:
   0         1
0  0  0.459589
1  0  0.409099
2  0  0.966191
3  0  0.908513
4  0  0.468437 
```

我找不到改变它的方法。

```
In [12]: df.ix[0][0] = 1
In [13]: df
Out[13]:
   0         1
0  0  0.459589
1  0  0.409099
2  0  0.966191
3  0  0.908513
4  0  0.468437 
```

而且我什至无法更改其他列的元素

```
In [16]: df.ix[0][1] = 1

In [17]: df
Out[17]:
   0         1
0  0  0.459589
1  0  0.409099
2  0  0.966191
3  0  0.908513
4  0  0.468437 
```

这是怎么回事？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T21:51:50.990

您正在编辑副本，请尝试

```
In [3]: df = pd.DataFrame(np.random.rand(5,2))

In [4]: df[0] = np.floor(df.index / 10).astype(int) * 10

In [5]: df
Out[5]: 
   0         1
0  0  0.201611
1  0  0.390364
2  0  0.727422
3  0  0.941035
4  0  0.036764

In [6]: df.ix[0,1] = 1

In [7]: df
Out[7]: 
   0         1
0  0  1.000000
1  0  0.390364
2  0  0.727422
3  0  0.941035
4  0  0.036764 
```

# oracle11g - 查询空间数据库

> ID：15558786
> 
> 赞同：0
> 
> 时间：2013-03-21T21:44:48.223
> 
> 标签：oracle11g, netbeans-7

我正在使用 ORACLE SQL DEVELOPER 。我已经创建了表格

```
Create table building(
building_ID varchar2(5) Primary Key, 
building_name Varchar2(50),
shape MDSYS.SDO_GEOMETRY);

INSERT INTO USER_SDO_GEOM_METADATA 
  VALUES (
  'building',
  'shape',
  SDO_DIM_ARRAY(   -- 20X20 grid
    SDO_DIM_ELEMENT('X', 0, 100, 1),
    SDO_DIM_ELEMENT('Y', 0, 100, 1)
     ),
  NULL   -- SRID
);

CREATE INDEX building_index
   ON building(shape)
   INDEXTYPE IS MDSYS.SPATIAL_INDEX; 
```

并使用 java 程序使用 executeUpdate() 插入值

现在我使用查询 oracle 数据库

```
select * from building; 
```

并且所有行都出现了，输出是- ![在此处输入图像描述](../Images/6c1977e66f659eac0ee2afb62633adb4.png)

但是当我查询oracle数据库时

```
SELECT building_ID
  FROM building 
  WHERE building_name = 'SSL'; OR

  SELECT c.shape.GET_GTYPE()
  FROM building c WHERE c.building_name = 'BHE'; 
```

或类似的语句，其中没有出现任何行的 where 子句。什么问题请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T22:12:12.447

您的 Java 应用程序似乎插入了带有前导空格的数据。在`DUMP`输出中，您将看到每个数据元素的长度为 4，第一个字节为 32，映射到[ASCII 字符集中](http://www.asciitable.com/)的一个空格。

您应该能够通过在前面加上空格来查询数据

```
SELECT *
  FROM building
 WHERE building_name = ' SSL' 
```

或者您可以修改数据以删除前导空格并使用现有查询。

```
UPDATE building
   SET building_name = TRIM(building_name); 
```

假设您这样做了，您还需要修改您的 Java 应用程序，以便将来不会插入前导空格。

# html - 备份未使用的 html 文件可以减慢服务器速度吗？：

> ID：15558790
> 
> 赞同：0
> 
> 时间：2013-03-21T21:45:01.640
> 
> 标签：html

我的一个客户有一些旧的 HTML 文件没有在他的网站上使用。我想知道这些文件是否会导致服务器变慢？

例子：

他有 10 个 index.html 文件，只有一个正在使用，其余的都是以前更改的备份。

```
index.html <- 只有一个是活的
index010113.html
index010114.html
index010115.html
```

等等

如果手动输入这些其他文件，则可以提取它们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T21:49:34.283

没有任何明显的数量，不。保留旧文件仍然不是一个好主意。这就是版本控制系统旨在管理的内容。使用诸如 Git 之类的 VCS 来处理此类事情。

# android - 如何从自定义类在 UI 线程上运行 Runnable

> ID：15558791
> 
> 赞同：1
> 
> 时间：2013-03-21T21:45:10.147
> 
> 标签：android

如何从自定义类在 UI 线程上运行 Runable？“runOnUiThread(Runnable)”方法可以完成工作，但它是 Activity 的一部分。我想知道 Application 类是否支持类似的东西，因为它很容易获得它的实例。我已经阅读了来自 androidannotation 框架的注释“@UiTread”。此注释是否也适用于自定义类？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T21:50:27.990

您可以使用[Handler](http://developer.android.com/reference/android/os/Handler.html)或[View.post(Runnable)](http://developer.android.com/reference/android/view/View.html#post%28java.lang.Runnable%29)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-22T01:04:10.477

我建议您避免在 UI 线程上运行 Runnable。关于我能想到的唯一原因是做某种计时器，在它退出之前“休眠”一段时间。通常，在 Android 框架之外使用 Threads、Runnables 等可能会导致很多性能问题。并不是说它们不起作用，但是你可能会再次扯掉你的头发试图让它们调试。

相反，要执行“后台”工作，请使用 AsyncTask 或 IntentService。

# c# - 如何设置类属性的隐式分配？

> ID：15558793
> 
> 赞同：1
> 
> 时间：2013-03-21T21:45:18.420
> 
> 标签：c#, c#-4.0, operators, operator-overloading, implicit-conversion

我有一个自定义类，并希望为其属性之一隐式赋值。我知道微软曾经将这个内置到某些控件中，例如`TextBox1 = "Sets the TextBox1.Text property"`. 是因为它内置在编译器中而被微软锁定还是可用？

这似乎类似于隐式转换，但我需要一个结果实例来修改。

我的实际代码示例：

```
public class CustomObject<TObject>
{
    public TObject BaseObject { get; set; }

    //Psuedocode for what I want, this doesn't compile for multiple reason
    public implicit operator CustomObject<TObject>(TObject FillIn)
    {
         this.BaseObject = FillIn;
    }
}

//Usage
var x = new CustomObject<int>();
x = 3; //this is the end result I want to code. 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T21:56:22.350

C# 中的`implicit`重载运算符不能在对象上**设置**属性，它只能**将**自身转换为对象。

VB6 的默认属性在 C# 或[VB.NET](http://msdn.microsoft.com/en-us/library/h7bfkxc1%28v=vs.71%29.aspx)中不可用。

# windows - 使用 mongoexport 导出到 csv mongodb 集合

> ID：15558795
> 
> 赞同：0
> 
> 时间：2013-03-21T21:45:27.157
> 
> 标签：windows, mongodb, csv, mongoexport

我正在尝试使用 mongodbexport 从我的 mongoDB 集合中导出所有数据。我遵循这些语法：

mongoexport --db mydb --collection mycollection --csv --out text.csv --fields NameColumn1、NameColumn2、NameColumn3等...

运行上面的代码，它只创建了一个包含字段名且没有值的文件。如果我只是删除 --csv 并将输出更改为 text.txt，它会导出所有数据。

我还缺少其他参数吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T00:53:22.967

我是对的，问题出在 Guid 属性上。我改为字符串，现在它工作正常。我会详细说明这个问题，因为它可以帮助其他人。

我在我的项目中使用官方 MongoDB C# 驱动程序。我是通过Nuget安装的，当前版本是1.8.0。

这是我用来保存的代码：

```
public void Save(SampleModel model)
{
    var collection = _database.GetCollection<SampleModel>("SampleCollection");
    collection.Insert(model);
} 
```

此示例模型具有以下属性：

```
public Guid MyId { get; set; }
public DateTime InitProcess { get; set; }
public DateTime EndProcess { get; set; }
public string RuleName { get; set; }
public bool Match { get; set; }
public DateTime InitUpdate { get; set; }
public DateTime EndUpdate { get; set; } 
```

# c++ - 如果我使用 memcpy 函数复制一个数组，可能会产生什么后果：瓶颈和性能变化？

> ID：15558798
> 
> 赞同：1
> 
> 时间：2013-03-21T21:45:34.510
> 
> 标签：c++, performance, stl, memcpy

我正在尝试实现我的容器 Vector 以用于教育目的。
在实现它的**方法reserve**时，我遇到了一个问题：
**这是将元素数组从内存中的一个位置（初始容量）重定位到分配给新容量的内存的最佳方式吗？**
我考虑了 2 种可能性：使用循环或使用 c 函数**memcpy**。
这是我的实现：

```
template <typename T>
void MyVector<T>::reserve(int elements) 
{
    if (m_size >= elements) // when no need to reserve memory as at least demanded amount of memory has been already allocated
        return;
    m_capacity = elements;
    tmp = m_array;
    // allocate needed amout of memory:
    m_array = new T[elements];
    // copy elements ???? can I use memcpy????
    for (int i = 0; i < m_size; ++i)
    {
        m_array[i] = tmp[i];
    }
    delete tmp;
}

template <typename T>
void MyVector<T>::reserve1(int elements) 
{
    if (m_size >= elements) // when no need to reserve memory as at least demanded amount of memory has been already allocated
        return;
    m_capacity = elements;
    tmp = m_array;
    // allocate needed amout of memory:
    m_array = new T[elements];
    // copy elements ???? can I use memcpy????
    memcpy(m_array, tmp, m_size);
    delete [] tmp;
} 
```

**问题：** - 我应该考虑哪些瓶颈？
- 性能上有什么不同？
- 有没有更有效的方法？
- 您能否建议我的信息来源，其中深入描述了 STL 容器的实施（我的目标是进行自己的实施，并与专业实施进行比较，以检查我的知识并找出需要改进的领域）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-21T21:54:57.663

您不能使用`memcpy`，因为重要的对象可能包含指向其他内存块的指针。

考虑一个向量`std::string`： 每个通常都实现为一个小对象，其中包含一个指向动态分配的字符数组的指针。如果你`memcpy`是字符串，你会复制指针而不是它们的实际字符数据。但是这些指针的*所有权*不会转移。因此，当您删除原始数组（为所有这些字符串调用析构函数）时，它们的内存被释放，并且您的“新”对象都有悬空指针。

使用`std::copy`是实现这一目标的更好方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T21:56:58.553

在性能方面以及使用`memcpy`“简单循环”方法复制对象会产生影响的其他因素。例如：

```
class Blah
{
    Blah()
    {
        some_function(this);
    }
};

MyVector<Blah> v;

... 
```

现在，如果以某种方式`some_function`存储`this`[无论出于好坏原因]，您`reserve1`将导致它被删除，但对的引用`this`仍将指向已删除的对象。这可能不是你想要的。

如果对象包含任何在内部使用分配的对象，当然同样适用——例如`std::string`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T22:11:18.857

我同意罗迪的观点。但更糟糕的是。即使您设法在不调用析构函数的情况下释放旧内存并且未释放其他内存，某些对象也可能包含指向内部部分的引用或指针，无论如何都会被破坏。最后，最好知道新内存对齐的后果。（对于 T=char，memcpy 可能是最好的）。

**如果可行，则强制执行移动任务`for`可能是最好的解决方案。**（你不需要旧的副本）

好吧，最终您可以看到 std::vector 是如何设计的，具有单独的内存分配，未初始化，然后就地初始化，复制或移动。查看 Stroustrup 的 The C++ Programming Language, Third Edition 中的 19.4 Allocators。

# excel - VBA excel中的文件名损坏

> ID：15558800
> 
> 赞同：3
> 
> 时间：2013-03-21T21:45:42.900
> 
> 标签：excel, vba, filenames, corruption

在晴朗的蓝天中，我突然收到一个我以前从未见过的错误，我不知道为什么会这样，因为我没有做任何事情来导致这个问题。

我正在尝试打开一个 .csv 文件，我已经成功完成了数千次。这是代码：

```
ChDir "KathyStringHD:Library:WebServer:Documents:DispatchReports:DispatchReportsFolder:"

NextFile = Dir("")

Do While NextFile <> ""

If NextFile <> ".DS_Store" Then
    Extension = Right(NextFile, 4)

    If Extension = ".csv" Then
         SaveFile = Left(NextFile, Len(NextFile) - 4) & ".xlsx"

MsgBox NextFile

         Call ProcessMonthlyReport(NextFile, Extension, SaveFile, sPath, SavePath)
     End If
End If

NextFile = Dir

Loop 
```

除一个文件外，一切正常。该文件的名称是“ACTStillwater February, 2013.csv”，但是当例程尝试打开这个文件时，该名称被损坏为“ACTStillwater Februa#, 6 random hex numbers, then .csv”。附件看起来像一个颜色代码，但我在文件本身或生成文件的 PHP 脚本中没有那个颜色代码。当我进入 Finder 并获取文件信息时，那里的名称很好。正如我所说，让我困惑的是错误只在一个文件上。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T21:55:09.413

文件名中似乎有一个逗号：

> ACTStillwater 2013 年 2**月**.csv

尝试删除它：

> ACTStillwater 2013 年 2 月.csv

看看它现在是否会运行。

有关详细信息，请参阅 [MSDN - 文件名 (Windows)](http://msdn.microsoft.com/en-us/library/windows/desktop/aa368590%28v=vs.85%29.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-11T00:10:59.617

我怀疑不是逗号，而是文件名超过 32 个字符的事实。

我发现当在 vba 中打开一个文件时，如果整个路径中的任何一个文件或文件夹名称超过 32 个字符，都会失败。

这或许可以解释为什么会突然出现问题：

'ACT Stillwater February, 2013.csv' 有 33

然而：

'ACT Stillwater 2013 年 1 月.csv

有 32

只是一个想法。

如果你的路径是

“KathyStringHD:Library:WebServer:Documents:DispatchReports:Dispatch Reports for the year 文件夹：”

也会失败

鲍勃·J。

# java - 从服务器调用方法

> ID：15558802
> 
> 赞同：0
> 
> 时间：2013-03-21T21:45:47.750
> 
> 标签：java, client-server

client1.java

```
import java.io.*;
import java.net.*;

class client1 {
   public static void main (String [] args) {

       Socket connectToServer;
       OutputStream out;
       BufferedReader in;
       String msg;
       String result;

       try {
            connectToServer = new Socket ("localhost", 5555);
            out = connectToServer.getOutputStream ( );

            in = new BufferedReader (new InputStreamReader (connectToServer.getInputStream ( )));

            msg = "sum" + "\n";

            out.write (msg.getBytes ( ), 0, msg.length ( ));
            msg = "5" + "\n";

            out.write (msg.getBytes ( ), 0, msg.length ( ));
            result = in.readLine ( );

            System.out.println (result);

            connectToServer.close ( );
      } catch (Exception ex) {System.out.println (ex);}
   }
} 
```

server1.java

```
import java.io.*;
import java.net.*;

class server1 {
   public static void main (String [] args) {

       ServerSocket c;
       Socket cs;
       OutputStream out;
       BufferedReader in;
       String msg;
       String name;
       int parameter;
       int result=0;

       try {
            c = new ServerSocket (5555);
            cs = c.accept ( );

            out = cs.getOutputStream ( );
            in = new BufferedReader (new InputStreamReader (cs.getInputStream ( )));

            name = in.readLine( );

            parameter = Integer.parseInt (in.readLine ( ));

            result = name(parameter);
            out.write (result.getBytes ( ), 0, result.length ( ));                

        } catch (Exception ex) {System.out.println (ex);}
    }

    static int sum (int n)
    {
        return (n + 5);
    }
} 
```

我想从服务器调用 sum 方法，并且我从服务器除外来支持函数的结果，但是有一些错误我真的很累需要一些帮助我的朋友

对不起，我的英语不好

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T22:08:39.557

在第 21 行，您将`msg`字符串“sum\n”写入服务器。

服务器`msg`在其第 23 行接收到 并将其存储在`name`变量中。目前，`name`是一个 String 对象，因此`name(someString)`除非前面有`new`.

最好的办法是使用 if 语句来检查调用了哪个方法，然后运行该方法，因此：

```
if (name.equals("sum")) {
    result = sum(parameter);
    out.write (result.getBytes ( ), 0, result.length ( )); 
} 
```

如果除了`sum`.

您可以使用 Java 反射 API 来动态调用类的方法。但是，由于 Java 是一种编译语言，因此局部变量（在方法、构造函数、参数等中）的信息在编译时会被删除。但是，您仍然可以完全访问类名、层次结构、方法和字段（类变量）。一个很好的起点是[反射 API 教程](http://download.oracle.com/javase/tutorial/reflect/index.html)或 Object 的 getClass() 方法。但是，这可能超出了您想要做的范围。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T22:01:43.900

您的服务器不完整。

```
result = name(parameter); 
```

这行代码调用了一个名为`name`. 它不使用变量的值查找方法`name`。

```
int result=0;
// [...]
out.write (result.getBytes ( ), 0, result.length ( )); 
```

在这里，您尝试在 int 上使用 String 方法。

* * *

*更正：*

在您的服务器中，您需要处理消息，以便您可以选择正确的方法来调用。此外，您需要处理协议文本以将其转换为正确的 Java 类型，反之亦然。具体来说，您需要调用`Integer.parseInt()`将`String`协议从协议转换为`int`您的`sum()`方法所需的。然后，您需要将`int`返回的格式设置为 a `String`，以便您可以将其发送回您的客户。

例如。

```
if ("sum".equals(name))
    {
    // TODO: catch NumberFormatException and handle bad input
    final int parameter_value = Integer.parseInt(parameter);
    result = sum(parameter_value);
    } 
```

# design-patterns - 如果具体类已知，为什么要使用 IoC / DI？

> ID：15558803
> 
> 赞同：3
> 
> 时间：2013-03-21T21:45:47.803
> 
> 标签：design-patterns, dependency-injection, inversion-of-control

我已经阅读了几天关于依赖注入/控制反转的内容，并且正在努力理解一个概念。

假设我有以下*简单*的场景：

```
public interface ILocation
{
    string LocationName { get; set; }
}

// The implementation / concrete class for ILocation
public class Location : ILocation
{
    public string LocationName {
        get { /* logic */ }
        set { /* logic */ }
    }
}

// My class that depends on ILocation as a dependency
public class SomeClass{
    public SomeClass(ILocation location)
    {
        this.theLocation = location;
    }

    // 
    // more code...
    // 
} 
```

太好了，所以我将我的`ILocation`注入到我的`SomeClass`......但我必须在我的依赖注入框架`ILocation`中处理并编译它。`Location`（旁白：我意识到有些框架可以在文件中进行此配置，即 XML 配置文件）

当上面列出的所有组件都必须在编译时存在时，创建这种知识“分离”的意义何在？

这真是折磨我。也许我完全错过了重点。现在，话虽这么说，我确实看到很多人谈论“可测试性”，我可以看到那里的优势，但是让我们假设我们将测试抛到了窗外；还有什么优点？这*真的*给了我什么？

我最初寻找这个概念是为了了解更多信息，希望能找到一种为我正在构建的应用程序设计“插件”模式的好方法。到目前为止，这似乎不适用于运行时插件的概念。

期待有关该主题的见解-谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T22:12:57.803

让我们上你的课，摆脱 DI。

```
public class SomeClass
{
    private Location _location = new Location();
    public SomeClass()
    {
    }
} 
```

太好了，您可以创建 Location 对象，并且它的构造函数中不接受任何参数。代码看起来很漂亮，而且很容易对吧？但是等等，现在 Location 类发生了变化，需要它自己的依赖项 LocationFinder。所以我们将它添加到对象构造中，也许我们将它移到构造函数中。

```
public class SomeClass
{
    private Location _location;
    public SomeClass()
    {
         _location = new Location(new LocationFinder());
    }
} 
```

好吧，不那么漂亮，但还不算太糟糕。但果然 6 个月后 LocationFinder 必须改变，现在它需要从一个工厂 LocationFinderFactory 中创建，它有自己的依赖项。

```
public class SomeClass
{
    private Location _location;
    public SomeClass()
    {
        var locationFinderFactory = new LocationFinderFactory(new LocationFinderStrategy());
        _location = new Location(locationFinderFactory.Create());
    }
} 
```

不是很干净，不是吗？更值得注意的一点是，每次 Location 实现更改时，您也必须更改 SomeClass。 **您已经将 SomeClass 的实现耦合到 Location 和其他 3 个类！** 现在，每次这 4 个类中的任何一个必须更改时，您都将更改 SomeClass。

故事的道德，以松散耦合的方式（例如使用 DI）对您的类进行编码，并且这些类型的代码更改将仅本地化到它应该影响的类。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T21:52:53.027

依赖注入的第一个目标是使代码易于单元测试。

然后是额外的优势，比如可以注入代理（AOP，用于事务、安全检查等）、配置注入的组件、根据配置文件或配置选择实现等。所有这些都取决于你的框架。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-21T21:55:34.543

你得到的是关注点分离。使用 DI，您可以自由更改实现或换出实现，`ILogger` *而无需*修改（甚至重新编译）`SomeClass`。使用 DI，`SomeClass`并不关心实现接口的类是什么`ILogger`，只要它实现了接口中的所有方法即可。如果你使用具体的类，如果你想改变哪个类实现了这些方法，你也必须修改`SomeClass`。使用 DI，您只需更改将发送到构造函数的类或 IoC 容器的配置，而无需修改`SomeClass`自身。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T22:04:27.960

管理系统内部依赖项的方式对软件的质量（灵活性、健壮性、可重用性、可维护性）产生巨大影响，尤其是从长远来看，当您的系统随着时间的推移而发生大量变化时。依赖注入是管理依赖的一种强大工具（除其他外）。

这篇文章很好地讨论了这个话题，所以我不会尝试复制它:) [http://www.objectmentor.com/resources/articles/Principles_and_Patterns.pdf](http://www.objectmentor.com/resources/articles/Principles_and_Patterns.pdf)

# asp.net - 在 asp.net 中发送电子邮件（Gmail）

> ID：15558804
> 
> 赞同：2
> 
> 时间：2013-03-21T21:45:51.083
> 
> 标签：asp.net, smtp, gmail, email

我试图在 asp.net c# 上`email`使用发送，但我不断收到此错误：`gmail account`

> 连接尝试失败，因为连接方在一段时间后没有正确响应，或者连接失败，因为连接的主机没有响应 [2607:f8b0:400c:c01::6c]:587

我尝试了来自不同资源的不同代码，但它们都没有与我的项目一起使用更多我已经尝试了这些步骤但仍然无法正常工作：

1.  在 VS 2012 服务器和 localhost (iis 7) 上尝试端口 25、465、587。
2.  防火墙设置为关闭，防病毒设置为关闭。
3.  以管理员身份启动 Visual Studio。

请，谁能告诉我这个错误背后的原因是什么。如果有可能改变一些东西，我应该从哪里开始..

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

public partial class Default6 : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        var myMailMessage = new System.Net.Mail.MailMessage();
        myMailMessage.From = new System.Net.Mail.MailAddress("serveremail@gmail.com");
        myMailMessage.To.Add("youremail@yahoo.com");// Mail would be sent to this address
        myMailMessage.Subject = "Feedback Form";
        myMailMessage.Body = "Hello";

        var smtpServer = new System.Net.Mail.SmtpClient("smtp.gmail.com");
        smtpServer.Port =587;
        smtpServer.Credentials = new System.Net.NetworkCredential("serveremail@gmail.com", "**YOURPASSWORD**");
        smtpServer.EnableSsl = true;
        smtpServer.Send(MyMailMessage);

        Response.Redirect("Default.aspx");
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-02T12:10:30.837

试试这个，
添加命名空间

系统网；system.net.mail；

```
 protected void Button1_Click(object sender, EventArgs e)
    {
        MailMessage MyMailMessage = new MailMessage();

        MyMailMessage.From = new MailAddress("from");

        MyMailMessage.To.Add("to");

        MyMailMessage.Subject = "Feedback Form";

        MyMailMessage.Body = "This is the test message from xx for testing mail send";

        MyMailMessage.IsBodyHtml = true;

        SmtpClient SMTPServer = new SmtpClient("smtp.gmail.com");

        SMTPServer.Port = 587;

        SMTPServer.Credentials = new System.Net.NetworkCredential("username","password");

        SMTPServer.EnableSsl = true;

        try
        {

            SMTPServer.Send(MyMailMessage);

           //Response.Redirect("Thankyou.aspx");

        }

        catch (Exception ex)
        {

        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T07:03:41.253

你可以试试这个：

```
 MailMessage mail = new MailMessage();
 mail.Subject = "Your Subject";
 mail.From = new MailAddress("senderMailAddress");
 mail.To.Add("ReceiverMailAddress");
 mail.Body = "Hello! your mail content goes here...";
 mail.IsBodyHtml = true;

 SmtpClient smtp = new SmtpClient("smtp.gmail.com", 587);
 smtp.EnableSsl = true;
 NetworkCredential netCre = new NetworkCredential("SenderMailAddress","SenderPassword" );
 smtp.Credentials = netCre;

 try
  {
   smtp.Send(mail);                
  }
  catch (Exception ex)
  {        
  } 
```

# iphone - MKMapView 重置回世界视图：重新烘焙

> ID：15558806
> 
> 赞同：3
> 
> 时间：2013-03-21T21:46:03.707
> 
> 标签：iphone, ios, mkmapview

我一直存在 MKMapView 的内存泄漏问题（已报告给 Apple，但没有回应），因此作为一种解决方法，我尝试只分配一个 MKMapView 并重新使用该映射而不是重新分配一个新映射。我遇到的问题是我还不能将 MKMapView 重置为它开始的视图。我假设因为我在美国工作，我最初得到这样的看法：

[![美国地图](../Images/c12fea6be2dfd71465390a4dbcc4dc00.png)](https://i.stack.imgur.com/bsOaw.png)
[（来源：[cprince.com](http://www.cprince.com/stackoverflow/map1.png)）]

使用此代码：

```
static MKMapView *map = nil;

- (void) showUserLocation {    
    [map setShowsUserLocation:YES];

    CLLocationCoordinate2D coord;

    coord.latitude = 39.0; // changed from original coords
    coord.longitude = -105.0;

    MKCoordinateRegion r = MKCoordinateRegionMakeWithDistance(coord, 1000, 1000);

    [map setRegion:r animated:YES];
}

- (void) viewWillAppear:(BOOL)animated {
    [super viewWillAppear:animated];

    if (! map) {
        CGRect r = CGRectMake(20, 50, 196, 75);
        map = [[MKMapView alloc] initWithFrame:r];

        defaultRegion = MKCoordinateRegionMake(map.centerCoordinate, MKCoordinateSpanMake(180, 360));
    } else {
        [map setRegion:defaultRegion animated:YES];
    }

    [self.view addSubview:map];
}

- (IBAction)annotateMap:(id)sender {
    [self showUserLocation];
} 
```

当我单击调用 annotateMap 的按钮时，我得到以下地图（还没有惊喜）：

[![我家的地图](../Images/2b9cd955d9dc88b6236e8cb71e1dd1c5.png)](https://i.stack.imgur.com/aS0gu.png)
[（来源：[cprince.com](http://www.cprince.com/stackoverflow/map2.png)）]

然后，当我从该视图导航离开（使用导航控制器）然后重新进入视图（再次调用 viewWillAppear，但这次它重新使用之前分配的 MKMapView）时，我得到以下地图视图：

[![海洋地图](../Images/396f624d9e63486be4661863fb9ac09a.png)](https://i.stack.imgur.com/AW8DQ.png)
[（来源：[cprince.com](http://www.cprince.com/stackoverflow/map3.png)）]

当然，由于 viewWillAppear 的这一部分，我应该得到原始的默认区域：

```
 defaultRegion = MKCoordinateRegionMake(map.centerCoordinate, MKCoordinateSpanMake(180, 360));
    } else {
        [map setRegion:defaultRegion animated:YES];
    } 
```

setRegion 在 addSubview 之后还是之前都没有关系。也就是说，下面的更改并不能纠正问题：

```
- (void) viewWillAppear:(BOOL)animated {
    [super viewWillAppear:animated];

    BOOL firstTime = NO;
    if (! map) {
        firstTime = YES;
        CGRect r = CGRectMake(20, 50, 196, 75);
        map = [[MKMapView alloc] initWithFrame:r];

        defaultRegion = MKCoordinateRegionMake(map.centerCoordinate, MKCoordinateSpanMake(180, 360));
    }

    [self.view addSubview:map];
    if (! firstTime) {
        [map setRegion:defaultRegion animated:YES];
    }
} 
```

并且使用 MKMapRectWorld 也无济于事：

```
defaultRegion = MKCoordinateRegionForMapRect(MKMapRectWorld); 
```

问题也不是由于 MKMapView 的某种竞争条件。如果我更改按钮的处理程序：

```
- (IBAction)annotateMap:(id)sender {
    defaultRegion = MKCoordinateRegionMake(map.centerCoordinate, MKCoordinateSpanMake(180, 360));
    [self showUserLocation];
} 
```

并等到地图在美国视图上解决，然后再单击按钮，问题是一样的。

我正在使用 iOS 6.1.2 和 XCode 4.6。

（完整的 XCode 项目可在[http://www.cprince.com/stackoverflow/Map.zip](http://www.cprince.com/stackoverflow/Map.zip)获得）。

想法？

第一次改变

我将 defaultRegion 设为静态而不是实例变量，这并没有显着改变情况。（我在下面报告了默认区域的纬度/经度）。这是地图中的结果：

[![海洋地图](../Images/0feee752a549610b4b936bb9d430819b.png)](https://i.stack.imgur.com/qTZS9.png)
[（来源：[cprince.com](http://www.cprince.com/stackoverflow/map4.png)）]

为了清楚起见，现在的代码是：

```
static MKMapView *map = nil;
static MKCoordinateRegion defaultRegion;

- (void) showUserLocation {    
    [map setShowsUserLocation:YES];

    CLLocationCoordinate2D coord;
    coord.latitude = 39.0; // changed from original
    coord.longitude = -105.0;

    MKCoordinateRegion r = MKCoordinateRegionMakeWithDistance(coord, 1000, 1000);

    [map setRegion:r animated:YES];
}

- (void) viewWillAppear:(BOOL)animated {
    [super viewWillAppear:animated];

    BOOL firstTime = NO;
    if (! map) {
        firstTime = YES;
        CGRect r = CGRectMake(20, 50, 196, 75);
        map = [[MKMapView alloc] initWithFrame:r];

        defaultRegion = MKCoordinateRegionMake(map.centerCoordinate, MKCoordinateSpanMake(180, 360));

        NSLog(@"defaultRegion: center: lat: %f, long: %f; span: %f dlat: dlong: %f", defaultRegion.center.latitude, defaultRegion.center.longitude, defaultRegion.span.latitudeDelta, defaultRegion.span.longitudeDelta);
        //defaultRegion = MKCoordinateRegionForMapRect(MKMapRectWorld);
    }

    [self.view addSubview:map];
    if (! firstTime) {
        NSLog(@"defaultRegion: center: lat: %f, long: %f; span: %f dlat: dlong: %f", defaultRegion.center.latitude, defaultRegion.center.longitude, defaultRegion.span.latitudeDelta, defaultRegion.span.longitudeDelta);
        [map setRegion:defaultRegion animated:YES];
    }
}

- (IBAction)annotateMap:(id)sender {
    //defaultRegion = MKCoordinateRegionMake(map.centerCoordinate, MKCoordinateSpanMake(180, 360));
    [self showUserLocation];
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-22T00:20:47.967

如果您将视图控制器设置`delegate`为`MKMapView`and 实现`regionDidChangeAnimated`，您会看到当您第一次创建地图视图时，`centerCoordinate`is `30, -40`，但随后设置为`37.178181, -96.054581`（至少对于美国用户而言）。您显然不能在创建地图视图后立即依赖`region`和/或。`centerCoordinate`你必须给它一个重置它的机会`region`，这显然是异步发生的。

如果要在第一次设置`defaultRegion`后保存`MKMapView`，请设置的`delegate`属性`MKMapView`然后实现：

```
- (void)mapView:(MKMapView *)mapView regionDidChangeAnimated:(BOOL)animated
{
    static BOOL firstTime = YES;
    if (firstTime)
    {
        defaultRegion = mapView.region;
        firstTime = NO;
    }
} 
```

请注意，在 上`viewWillDisappear`，既然您已经制作了地图 a `static`，请确保`nil`地图的`delegate`（因为旧的视图控制器将消失）。如果您想继续将视图控制器的新实例设置为 a `MKMapViewDelegate`，则只需在`delegate`将地图视图重新添加到详细视图控制器的新实例时再次设置。

* * *

老答案：

当您设置`defaultRegion`时，这是一个实例变量。因此，当您关闭视图时，它就会丢失。当您回到地图（即`firstTime`is `NO`）时，`defaultRegion`从未初始化，因此为 0,0，因此位于大西洋中部。

您显然没有保存`defaultRegion`（通常您有一个协议将其传递回主视图控制器），这使得应用程序很难知道当您再次选择主视图中的项目时该做什么。

# jsf - 有没有让过滤器不适用于 h:commandLink 点击的好方法？

> ID：15558810
> 
> 赞同：1
> 
> 时间：2013-03-21T21:46:13.623
> 
> 标签：jsf, action, servlet-filters

我有一个问题，我的动作`h:commandLink`没有触发。我查看了 BalusC 关于原因可能是什么的非常[有用的帖子](https://stackoverflow.com/questions/2118656/hcommandlink-hcommandbutton-is-not-being-invoked/)，我能够将其追溯到第 11 号：

> 确保同一请求-响应链中没有过滤器或 Servlet 以某种方式阻止了对 FacesServlet 的请求。

似乎有一个过滤器导致了问题 - 我通过删除过滤器并重试发现了这一点。不幸的是我没有写过滤器，更不幸的是我对它们知之甚少。所以我想知道是否有一种好方法可以让这个过滤器不适用于`h:commandLink`动作触发？我看到该`doFilter()`方法传递了以下参数：

```
ServletRequest request
ServletResponse response
FilterChain chain 
```

所以我的第一直觉是看看是否可以在其中一个参数中使用一些东西来告诉我这是来自我的`h:commandLink`. 如果是这样，我将`doFilter()`绕过该方法中的所有代码。不确定这是否可能，或者是一种好的方法，但这是首先想到的。

但我也想在这里问一下是否有一种体面的方法来处理这个问题？或者这是否表明过滤器本身存在某种问题，我可能需要考虑修复？任何类似的信息都会很有用。

顺便说一句，我知道我可能可以使用 an`actionListener`来触发我的 bean 中的方法，但是，据我了解，这是一个糟糕的设计，所以我想避免这种情况。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T14:00:46.190

我说一旦我的解决方案解决了，我会更新这个。所以我最初的问题的答案是它是可能的。但是这样做的方法并不是很好的设计。

警告 - 这第一个选项非常hacky，我不建议你这样做 - 只是为了完整性而添加。一种方法是给你`h:commandLink`一个 ID，比如“skipFilter”。然后在过滤器中，检查此 ID。您可以在`#HttpServletRequest.getParameterNames()`. 如果您看到请求来自此 ID，则添加逻辑以跳过过滤器。

另一种选择是只使用ajax。然后在过滤器中添加逻辑以检查请求是否为ajax，如果是则绕过过滤器：`if("partial/ajax".equalsIgnoreCase(#HttpServletRequest.getHeader("Faces-Request")))`

稍微不那么hacky。

但这已经在我的项目过滤器中完成了，所以我没有自己添加它。

另一种选择当然是 BalusC 推荐的，纠正或更换过滤器。在我的情况下，这不是一个选项，所以我必须在我的过滤器的限制范围内工作。所以我只使用ajax。我有我的`h:commandLink`：

```
<h:commandLink action="#{orderInvoiceBean.navToPdfAction}" value="-EXTRA INVOICE LINK- #{invoice.customerTrxId}" >   
   <f:setPropertyActionListener target="#{orderInvoiceBean.orderInvoiceNative}" value="#{invoice}"/>
   <f:ajax/>  
</h:commandLink> 
```

这样，首先设置 orderInvoiceNative 属性，然后发生 ajax 操作，并且可以根据需要访问该值。

但是，我还有一个问题。我需要显示二进制响应 - 而不是文本。当然，ajax 并不完全允许这样做。但是我被限制使用ajax。那么该怎么办？

好吧，我让我的 ajax 操作触发了一个导航规则，它只是导航到以下页面：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html">
   <h:body binding="#{orderInvoiceBean.orderInvoicePdf}"/>
</html> 
```

通过这个页面动作，创建了一个新的请求，所以现在我可以在响应中返回一个二进制文件。所以结果是，您停留在您单击链接的页面上，并且您会看到一个文件下载对话框 - 在发送二进制文件响应之前，它不会导航到空白页面，就像我最初担心的那样 - 您继续原始页面，并且浏览器中的 url 不会改变，即使您调用了导航规则转到新页面。

希望这对某人有用。

# angularjs - AngularJS 路由与后端路由

> ID：15558813
> 
> 赞同：15
> 
> 时间：2013-03-21T21:46:27.287
> 
> 标签：angularjs, url-routing, frontend, backend

我想在我的下一个项目中使用 AngularJS。具有 Python 后端和 html5、Angular 前端的应用程序。

我将在后端使用 MVC 框架，我有点困惑。我必须在后端和前端使用路由吗？

因为我一直使用后端路由，而前端路由对我来说真的是一个新想法。

客户端路由更好吗？而当我选择使用前端路由时，后端不会有路由吗？所有请求都将发送到一个 url？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-03-22T08:34:02.310

您可以使用客户端路由，让后端返回静态文件和 JSON 数据。Angular 中的路由基本上告诉您需要从服务器下载哪个部分模板以及哪个控制器将处理它。

您的后端路线将是这样的

```
'/partials/:name' -> return corresponding partial

'/api/*' -> handlers to return json data

'/*' -> return index.html 
```

您的 index.html 将包含对其他视图的引用

```
...
<div ng-view></div>
... 
```

现在假设您访问 yourapp.com/someview.html。服务器返回 index.html 并且由于 url 是 /someview，Angular 将向服务器请求“someview”部分并相应地呈现页面。

简而言之，服务器的作用是返回 index.html、partials 和服务 REST API 请求。客户端始终接收 index.html 并根据 url 请求对应的部分和 JSON 数据。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-03-21T21:53:18.970

您可以选择进行客户端路由、服务器端路由或两者的组合...

在客户端路由的情况下，您将拥有一个由服务器提供的页面。之后的所有路由都将由客户端完成。如果您的应用程序有很多页面，这可能不是最佳解决方案，您可能希望进行服务器端路由。

在服务器端路由的情况下，您将为服务器应用程序上定义的每个路由提供一个页面。它们中的每一个都将包含一个 mini-angularJS 应用程序（此外，如果有意义的话，这些 mini-SPA 中的每一个都可以做一些额外的路由）

由您决定什么最适合您的情况。

## 更新：

如果您打算进行客户端路由，请务必从 AngularUI 项目中查看[UI-router 。](https://github.com/angular-ui/ui-router)它使您能够创建基于状态的视图以及其他一些使用 Angular 的本机路由无法实现的功能。

# iphone - MailCore IMAP 服务器导致应用程序崩溃？

> ID：15558816
> 
> 赞同：-2
> 
> 时间：2013-03-21T21:46:33.487
> 
> 标签：iphone, sdk, mailcore

我正在使用 MailCore 构建我的电子邮件客户端，并在尝试使用 IMAP 从电子邮件帐户接收消息时遇到了一个小问题。

这是我在 viewDidLoad 中的代码：

```
CTCoreAccount *account = [[CTCoreAccount alloc] init];
        BOOL success = [account connectToServer:@"imap.mail.me.com"
                                           port:993
                                 connectionType:CTConnectionTypePlain
                                       authType:CTImapAuthTypePlain
                                          login:[keychain objectForKey:(__bridge id)kSecAttrAccount]
                                       password:[keychain objectForKey:(__bridge id)kSecValueData]];
        if (!success) {

            UIAlertView *alertView1 = [[UIAlertView alloc] initWithTitle:@"Error Checking Email" message:@"There was a problem checking your inbox, please try again later." delegate:self cancelButtonTitle:@"OK" otherButtonTitles:nil];
            [alertView1 show];

        }

        CTCoreFolder *inbox = [account folderWithPath:@"INBOX"];
        messages = [inbox messagesFromSequenceNumber:1 to:0 withFetchAttributes:CTFetchAttrEnvelope];
        [tableView reloadData]; 
```

问题是当我运行我的应用程序时，它没有启动并且我的手机显示空白黑屏。我尝试注释掉代码，一切正常。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T22:59:25.383

这会阻止连接和下载消息的主（UI）线程，这很容易比启动应用程序所允许的时间更长（我认为大约 20 秒）。

看起来 MailCore 没有异步 API，所以你必须自己在后台使用它。我建议使用调度队列（`dispatch_async()`如果您只使用对 UIKit 类的弱引用，则可以相当简单地正确使用）或`NSOperationQueue`让事情在后台运行。

通常的并发警告适用。

# android - Binary XML file line #4: tag requires a 'duration' attribute

> ID：15558818
> 
> 赞同：-1
> 
> 时间：2013-03-21T21:46:40.363
> 
> 标签：android, tabs, duration

I'm a newbie to android programming. I'm trying to create a 4 tab application on a machine running Windows Vista x64-Bit using the eclipse IDE. After doing some thorough researching, I came across [this](http://www.mkyong.com/android/android-tablayout-example/) tutorial for creating a 4 tab application. I followed the instructions closely, modifying it where necessary to make my application.

When I attempted launching it in an Android Gingerbread 2.3.3 emulator, i kept getting a forced quit. What am I doing wrong? All suggestions are welcome. Thanks in advance.

Here is my MainActivity.java code (keep in mind that the extra imports are for future purposes)

```
package com.riverboys.riverbook_android;

import android.annotation.TargetApi;
import android.app.TabActivity;
import android.app.Activity;
import android.content.Intent;
import android.content.res.Resources;
import android.os.Build;
import android.os.Bundle; // Makes an Android application an Android application
import android.os.StrictMode;
import android.support.v4.app.NavUtils;
import android.util.Log;
import android.view.Menu;
import android.view.MenuItem;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button; // For Button element
import android.widget.TabHost; // For Tab element
import android.widget.TabHost.TabSpec;
//import android.widget.EditText; // For EditText element (to take text input)
import android.widget.TextView; // For TextView element
import com.riverboys.riverbook_android.CustomHttpClient;
import java.util.ArrayList;
import org.apache.http.NameValuePair;
import org.apache.http.message.BasicNameValuePair;
import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;

public class MainActivity extends TabActivity {
    // Called when the activity is first created
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        /* Show the Up button in the action bar.
        setupActionBar();*/

        Resources rsrcsRiverbook = getResources();
        TabHost tbhstRiverbook = getTabHost();
        // No need to call TabHost.Setup()

        // First (Favorites) tab
        Intent intntTab1 = new Intent().setClass(this, FavoritesActivity.class);
        TabSpec tbspcTab1 = tbhstRiverbook
                .newTabSpec("Favorites")
                .setIndicator("Favorites",  rsrcsRiverbook.getDrawable(R.drawable.icon_tab_favorites))
                .setContent(intntTab1);

        // Second (Search) tab
        Intent intntTab2 = new Intent().setClass(this, SearchActivity.class);
        TabSpec tbspcTab2 = tbhstRiverbook
                .newTabSpec("Search")
                .setIndicator("Search", rsrcsRiverbook.getDrawable(R.drawable.icon_tab_search))
                .setContent(intntTab2);

        // Third (Map) tab
        Intent intntTab3 = new Intent().setClass(this, MapActivity.class);
        TabSpec tbspcTab3 = tbhstRiverbook
                .newTabSpec("Map")
                .setIndicator("Map", rsrcsRiverbook.getDrawable(R.drawable.icon_tab_map))
                .setContent(intntTab3);

        // Fourth (River Log) tab
        Intent intntTab4 = new Intent().setClass(this, RiverLogActivity.class);
        TabSpec tbspcTab4 = tbhstRiverbook
                .newTabSpec("River Log")
                .setIndicator("River Log", rsrcsRiverbook.getDrawable(R.drawable.icon_tab_river_log))
                .setContent(intntTab4);

        //
        tbhstRiverbook.addTab(tbspcTab1);
        tbhstRiverbook.addTab(tbspcTab2);
        tbhstRiverbook.addTab(tbspcTab3);
        tbhstRiverbook.addTab(tbspcTab4);

        // Set Favorites tab as default (zero based)
        tbhstRiverbook.setCurrentTab(0);
    }
} 
```

and here is my activity_main.xml code

```
<?xml version="1.0" encoding="utf-8"?>

<TabHost xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@android:id/tabhost"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent">

    <LinearLayout
        android:orientation="vertical"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:padding="0dp">

        <FrameLayout
            android:id="@android:id/tabcontent"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:padding="0dp" />

        <TabWidget
            android:id="@android:id/tabs"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_gravity="bottom" />
    </LinearLayout>
</TabHost> 
```

The code in the activity of the 4 tabs is identical to the following

```
package com.riverboys.riverbook_android;

import android.annotation.TargetApi;
import android.app.TabActivity;
import android.app.Activity;
import android.content.Intent;
import android.content.res.Resources;
import android.os.Build;
import android.os.Bundle; // Makes an Android application an Android application
import android.os.StrictMode;
import android.support.v4.app.NavUtils;
import android.util.Log;
import android.view.Menu;
import android.view.MenuItem;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button; // For Button element
import android.widget.TabHost; // For Tab element
import android.widget.TabHost.TabSpec;
//import android.widget.EditText; // For EditText element (to take text input)
import android.widget.TextView; // For TextView element
import com.riverboys.riverbook_android.CustomHttpClient;
import java.util.ArrayList;
import org.apache.http.NameValuePair;
import org.apache.http.message.BasicNameValuePair;
import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;

public class FavoritesActivity extends Activity {
    // Called when the activity is first created
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_favorites);
    }
} 
```

and the code in their corresponding layout xml file is identical to the following

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:paddingBottom="@dimen/activity_vertical_margin"
    android:paddingLeft="@dimen/activity_horizontal_margin"
    android:paddingRight="@dimen/activity_horizontal_margin"
    android:paddingTop="@dimen/activity_vertical_margin"
    tools:context=".FavoritesActivity" >

    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="@string/hello_world" />

</RelativeLayout> 
```

This is the error information I get in logcat when the app attempts to launch in the emulator

```
03-21 21:10:14.136: D/AndroidRuntime(338): Shutting down VM
03-21 21:10:14.136: W/dalvikvm(338): threadid=1: thread exiting with uncaught exception (group=0x40015560)
03-21 21:10:14.186: E/AndroidRuntime(338): FATAL EXCEPTION: main
03-21 21:10:14.186: E/AndroidRuntime(338): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.riverboys.riverbook_android/com.riverboys.riverbook_android.MainActivity}: android.content.res.Resources$NotFoundException: File res/drawable/icon_tab_favorites.xml from drawable resource ID #0x7f020005
03-21 21:10:14.186: E/AndroidRuntime(338):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1647)
03-21 21:10:14.186: E/AndroidRuntime(338):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1663)
03-21 21:10:14.186: E/AndroidRuntime(338):  at android.app.ActivityThread.access$1500(ActivityThread.java:117)
03-21 21:10:14.186: E/AndroidRuntime(338):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:931)
03-21 21:10:14.186: E/AndroidRuntime(338):  at android.os.Handler.dispatchMessage(Handler.java:99)
03-21 21:10:14.186: E/AndroidRuntime(338):  at android.os.Looper.loop(Looper.java:123)
03-21 21:10:14.186: E/AndroidRuntime(338):  at android.app.ActivityThread.main(ActivityThread.java:3683)
03-21 21:10:14.186: E/AndroidRuntime(338):  at java.lang.reflect.Method.invokeNative(Native Method)
03-21 21:10:14.186: E/AndroidRuntime(338):  at java.lang.reflect.Method.invoke(Method.java:507)
03-21 21:10:14.186: E/AndroidRuntime(338):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
03-21 21:10:14.186: E/AndroidRuntime(338):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
03-21 21:10:14.186: E/AndroidRuntime(338):  at dalvik.system.NativeStart.main(Native Method)
03-21 21:10:14.186: E/AndroidRuntime(338): Caused by: android.content.res.Resources$NotFoundException: File res/drawable/icon_tab_favorites.xml from drawable resource ID #0x7f020005
03-21 21:10:14.186: E/AndroidRuntime(338):  at android.content.res.Resources.loadDrawable(Resources.java:1697)
03-21 21:10:14.186: E/AndroidRuntime(338):  at android.content.res.Resources.getDrawable(Resources.java:581)
03-21 21:10:14.186: E/AndroidRuntime(338):  at com.riverboys.riverbook_android.MainActivity.onCreate(MainActivity.java:47)
03-21 21:10:14.186: E/AndroidRuntime(338):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
03-21 21:10:14.186: E/AndroidRuntime(338):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1611)
03-21 21:10:14.186: E/AndroidRuntime(338):  ... 11 more
03-21 21:10:14.186: E/AndroidRuntime(338): Caused by: org.xmlpull.v1.XmlPullParserException: Binary XML file line #4: <item> tag requires a 'duration' attribute
03-21 21:10:14.186: E/AndroidRuntime(338):  at android.graphics.drawable.AnimationDrawable.inflate(AnimationDrawable.java:256)
03-21 21:10:14.186: E/AndroidRuntime(338):  at android.graphics.drawable.Drawable.createFromXmlInner(Drawable.java:787)
03-21 21:10:14.186: E/AndroidRuntime(338):  at android.graphics.drawable.Drawable.createFromXml(Drawable.java:728)
03-21 21:10:14.186: E/AndroidRuntime(338):  at android.content.res.Resources.loadDrawable(Resources.java:1694)
03-21 21:10:14.186: E/AndroidRuntime(338):  ... 15 more
03-21 21:10:18.925: I/Process(338): Sending signal. PID: 338 SIG: 9
03-21 21:10:22.785: D/AndroidRuntime(349): Shutting down VM
03-21 21:10:22.785: W/dalvikvm(349): threadid=1: thread exiting with uncaught exception (group=0x40015560)
03-21 21:10:22.815: E/AndroidRuntime(349): FATAL EXCEPTION: main
03-21 21:10:22.815: E/AndroidRuntime(349): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.riverboys.riverbook_android/com.riverboys.riverbook_android.MainActivity}: android.content.res.Resources$NotFoundException: File res/drawable/icon_tab_favorites.xml from drawable resource ID #0x7f020005
03-21 21:10:22.815: E/AndroidRuntime(349):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1647)
03-21 21:10:22.815: E/AndroidRuntime(349):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1663)
03-21 21:10:22.815: E/AndroidRuntime(349):  at android.app.ActivityThread.access$1500(ActivityThread.java:117)
03-21 21:10:22.815: E/AndroidRuntime(349):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:931)
03-21 21:10:22.815: E/AndroidRuntime(349):  at android.os.Handler.dispatchMessage(Handler.java:99)
03-21 21:10:22.815: E/AndroidRuntime(349):  at android.os.Looper.loop(Looper.java:123)
03-21 21:10:22.815: E/AndroidRuntime(349):  at android.app.ActivityThread.main(ActivityThread.java:3683)
03-21 21:10:22.815: E/AndroidRuntime(349):  at java.lang.reflect.Method.invokeNative(Native Method)
03-21 21:10:22.815: E/AndroidRuntime(349):  at java.lang.reflect.Method.invoke(Method.java:507)
03-21 21:10:22.815: E/AndroidRuntime(349):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
03-21 21:10:22.815: E/AndroidRuntime(349):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
03-21 21:10:22.815: E/AndroidRuntime(349):  at dalvik.system.NativeStart.main(Native Method)
03-21 21:10:22.815: E/AndroidRuntime(349): Caused by: android.content.res.Resources$NotFoundException: File res/drawable/icon_tab_favorites.xml from drawable resource ID #0x7f020005
03-21 21:10:22.815: E/AndroidRuntime(349):  at android.content.res.Resources.loadDrawable(Resources.java:1697)
03-21 21:10:22.815: E/AndroidRuntime(349):  at android.content.res.Resources.getDrawable(Resources.java:581)
03-21 21:10:22.815: E/AndroidRuntime(349):  at com.riverboys.riverbook_android.MainActivity.onCreate(MainActivity.java:47)
03-21 21:10:22.815: E/AndroidRuntime(349):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
03-21 21:10:22.815: E/AndroidRuntime(349):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1611)
03-21 21:10:22.815: E/AndroidRuntime(349):  ... 11 more
03-21 21:10:22.815: E/AndroidRuntime(349): Caused by: org.xmlpull.v1.XmlPullParserException: Binary XML file line #4: <item> tag requires a 'duration' attribute
03-21 21:10:22.815: E/AndroidRuntime(349):  at android.graphics.drawable.AnimationDrawable.inflate(AnimationDrawable.java:256)
03-21 21:10:22.815: E/AndroidRuntime(349):  at android.graphics.drawable.Drawable.createFromXmlInner(Drawable.java:787)
03-21 21:10:22.815: E/AndroidRuntime(349):  at android.graphics.drawable.Drawable.createFromXml(Drawable.java:728)
03-21 21:10:22.815: E/AndroidRuntime(349):  at android.content.res.Resources.loadDrawable(Resources.java:1694)
03-21 21:10:22.815: E/AndroidRuntime(349):  ... 15 more
03-21 21:10:25.485: I/Process(349): Sending signal. PID: 349 SIG: 9 
```

EDIT: Here's the code contained in the icon_tab_favorites, it's similar to the other three

```
<?xml version="1.0" encoding="utf-8"?>
<animation-list xmlns:android="http://schemas.android.com/apk/res/android" >
    <!-- When selected, you should use bg with grey -->
    <item android:drawable="@drawable/ic_tab_favorites"
          android:state_selected="true" />
    <!-- When not selected, you should use bg with white -->
    <item android:drawable="@drawable/ic_tab_favorites" />
</animation-list> 
```

EDIT: For future purposes, here's the correct form of the code :)

```
<?xml version="1.0" encoding="utf-8"?>
<animation-list xmlns:android="http://schemas.android.com/apk/res/android"
    android:oneshot="false" >

    <!-- When selected, you should use bg with grey -->
    <item android:drawable="@drawable/ic_tab_favorites"
          android:state_selected="true"
          android:duration="200" />

    <!-- When not selected, you should use bg with white -->
    <item android:drawable="@drawable/ic_tab_favorites"
          android:duration="200" />
</animation-list> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T21:52:48.790

首先，您正在使用的编程方法——一个`TabActivity`使用选项卡的活动——已经被弃用了两年多。

其次，您的特定问题来自`res/drawable/icon_tab_favorites.xml`格式错误的 XML 可绘制对象。您可以通过阅读堆栈跟踪来判断这一点，尤其是最后两行“Caused by”：

```
03-21 21:10:14.186: E/AndroidRuntime(338): Caused by: android.content.res.Resources$NotFoundException: File res/drawable/icon_tab_favorites.xml from drawable resource ID #0x7f020005
03-21 21:10:14.186: E/AndroidRuntime(338): Caused by: org.xmlpull.v1.XmlPullParserException: Binary XML file line #4: <item> tag requires a 'duration' attribute 
```

请编辑该文件以将`duration`属性放在第 4 行，并考虑检查该文件的其余部分是否存在任何类似类型的问题。

# javascript - Creating a HTML form with selector a selector of saved SQL Hex colors

> ID：15558820
> 
> 赞同：2
> 
> 时间：2013-03-21T21:46:46.953
> 
> 标签：javascript, html, sql, css, forms

I working on a friends website, and I'm helping create a simple estimator form. He does gutter repair and he has a list of different gutter colors he has in stock. I've developed an app for him to update the sql database with a sku, name, price, and hex color. I want to pull the hex colors within the database and implement it into the estimator form, but I'm not for sure the best way of doing this. I know that there are a lot of 'color pickers' scripts out there, but I'm not dealing with every hex combination... roughly 20 different colors max, but this number will change as his inventory changes.

Is there any way to create a selector with a little box that displays the hex color next to the name as a value? Or even, have a table of colored box with X rows and 5 columns, and the form would be able to process with one of those boxes the user selected?

I mainly focus on mobile application development, and I don't know I'm describing my question properly, but I hope you know what I mean.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T21:57:50.187

创建一个表来存储您的值： **`var tbl = $('<table/>');`**

现在让我们创建行：

```
for(var x = 0; x < products.length; x++){
 var row = $('<tr/>'),
     colorSwatch = $('<div/>').css({width: '20px', height: '20px', background: bColor[x]}),

 row.html([
 $('<td/>').html(colorSwatch),
 $('<td/>').html(sku),
 $('<td/>').html(name),
 $('<td/>').html(price) 
 ]);

 row.appendTo(tbl); //Append the row to the table
} 
```

# iphone - Building on iPhone with provisioning profile

> ID：15558821
> 
> 赞同：1
> 
> 时间：2013-03-21T21:46:53.690
> 
> 标签：iphone, ios, code-signing, provisioning, provisioning-profile

I am having a lot of trouble setting up my Xcode project so that it builds on my iPhone.

I have followed all the steps in the Development Provisioning Assistant, but I always end up with a valid provisioning profile matching the application's Identifier 'com.test' could

not be found Error when I build.

My app identifier on the provisioning profile is 93QA3MXYM7.com.test.MediaAccess. In my

info.plist file the bundle identifier is com.test.I have tired pretty much every

combination of 93QA3MXYM7.com.test.MediaAccess that makes sense and I can think of, but I

always get the same error, saying that a provisioning profile doesn't match!

I am very confused as what is the application name, the project name, the bundle name, the

app ID description, the bundle ID, and the bundle seed ID. In the Development Provisioning

Assistant, when you create an AppID, there is only the app description field. When you

create an AppID through the regular interface, there are 3 fields! Which ones should match?

Could I get an example please? thanks!

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T21:53:11.470

只需将 com.test.MediaAccess 放入“Bundle identifier”属性即可。然后去选择你项目的设置，找到**代码签名身份**部分并为你的调试配置选择正确的配置文件（应该下载并设置正确的配置文件）

# c# - Implementation-specific constants in service layer

> ID：15558825
> 
> 赞同：1
> 
> 时间：2013-03-21T21:47:09.037
> 
> 标签：c#, asp.net, architecture, interface

I have an ASP.Net Web Forms project, which is built as (among other things) a user interface to a CRM web service.

I have an interface, `IMembershipService`, which exposes a number of methods for purchasing different kinds of subscriptions to a service. The concrete implementation of this, `SpecificMemberService`, will abstract a number of web service calls to a third-party CRM system.

The concrete implementation requires that different 'subscription levels' be passed to it as specific 4-character string codes. Currently, I have defined the following in my service layer:

```
public static class MemberTypes
{
    public const string Basic = "MEM1";
    public const string Extra = "MEM2";
    public const string Professional = "MEM3";
} 
```

However, these codes are specific to the concrete class `SpecificMemberService` and - as such - shouldn't really be independent of it as they currently are. How can I expose strongly-typed `MemberType` codes to my web application, which are constant with respect to a *concrete implementation* of `IMembershipService`?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T22:07:10.557

创建一个 MemberType 接口。向您的服务接口添加一个`GetMemberTypes`方法，该方法公开一个`IMemberType`.

```
public interface IMemberType {      
    public string Name { get; set; } // i.e. "Professional"
    public string Code { get; set; } // i.e. "MEM3"
}

public void ClientCode() {

    // Instantiate a concrete service (calling a factory would be even better).
    IMembershipService service = new MembershipService();

    // Get the list of MemberTypes exposed by the concrete MembershipService.
    Collecton<IMemberTypes> types = service.GetMemberTypes();

    // Subscribe to service defined in IMembershipService with "Professional" level, if possible.
    foreach (IMemeberType type in types) {
        if ((type.Name == "Professional"))
            service.SubscribeToAwesomeService(type.Code);
    }
} 
```

将“专业”公开为常量或枚举以获得奖励积分。

# r - R making space for the xaxis labels

> ID：15558826
> 
> 赞同：0
> 
> 时间：2013-03-21T21:47:27.323
> 
> 标签：r, plot, label

I have the following boxplots ![enter image description here](../Images/c7dcb420987e34621436b5c995a3adf7.png)

as you can see my problem is that the lables are not fitting in my figure since they are exceeding the margins of the figure, I tried to use the **par** function and its **mars** attribute that shows the margins, but didn't work for me, I used par(par()$mar+c(10,0,0,0))

If you got any idea for my problem please let me know

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T21:54:56.237

您似乎没有将新创建`mar`的参数分配给`mar`参数

相比

```
d <- data.frame(a=1:5,b=1:5)
boxplot(d)

# your call was
# par(par()$mar+c(10,0,0,0)) which doesn't specify which 
# par is being set (and returns NULL, (A vague hint that it isn't working properly)
par(mar = par('mar') + c(10,0,0,0))
boxplot(d) 
```

# codeigniter - 通过 Cpanel 的 CodeIgniter Cron 作业

> ID：15558830
> 
> 赞同：1
> 
> 时间：2013-03-21T21:47:38.053
> 
> 标签：codeigniter, cron

好的，我查看了其他所有线程，并且已经完成了他们所做的以及手册中所说的内容，但我一生都无法弄清楚这一点。cron 作业的结果正在通过电子邮件发送到我的一封电子邮件。它所做的只是打印出布局的 html 标记......并打印基本页面内容......就像它没有注册任何东西一样。

```
php /home/jdstable/public_html/dev/index.php cron decrease_pets_stats 
```

那是我的命令行..我也尝试用 user/local/bin/php 替换 php，但它没有用。问题是我有其他 cron 作业运行程序 PHP 代码，这些代码可以与 php path/to/cron.php 一起正常工作...但它不适用于 CI ..

我的控制器是 Cron，我的方法是 reduction_pets_stats..

```
//decrease pets stats
public function decrease_pets_stats() {
$this->load->model('Cron_model', 'cron');
    $this->cron->decrease_pets_stats();
    echo 'Decreased pet stats';
} 
```

这是该方法的逻辑：

```
//decrease pets stats
//runs every hour
public function decrease_pets_stats() {
    $this->db->set('hunger', 'hunger - 5');
    $this->db->set('happiness', 'happiness - 5');
    $this->db->set('loyalty', 'loyalty - 5');
    $this->db->update('user_creature');
} 
```

有谁知道为什么它只是打印布局标记？我的构造函数如下所示：

```
public function __construct() {
        parent::__construct();
        if( ! $this->input->is_cli_request()) show_error('Direct access is not allowed');

        $this->load->model('Cron_model', 'cron');
    } 
```

而且我的父构造函数包含很多东西（加载帮助程序和库以及让用户信息出现在每个页面上（如果他们已登录）。

在打开控制器 Cron 类之前，这是否位于控制器的顶部是否重要？

```
if ( ! defined('BASEPATH')) exit('No direct script access allowed'); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-21T22:36:56.807

您使用的默认 PHP 安装可能被编译为 CGI-FCGI，而不是 CLI。这取决于您的主机和/或服务器，但您需要搜索您的 PHP 安装以获取命令行界面，然后在您的 cron 作业中使用它。我在 Hostmonster 上遇到了完全相同的问题，我的 cron 命令最终变成：

```
/ramdisk/bin/php5-cli ~/public_html/sitefolder/index.php controller method 
```

对我来说，我需要的 PHP 在`/ramdisk/bin/php5-cli`.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-10-16T08:45:48.217

**对于 CodeIgniter 2.2.0**

你可以试试这两种方法：

1.  `php-cli /home/username/public_html/index.php controller method`
2.  `wget http://www.example.com/controller/method`

或根据您的情况

1.  `php-cli /home/username/public_html/index.php Cron decrease_pets_stats`
2.  `wget http://www.example.com/Cron/decrease_pets_stats`

它适用于我..干杯！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-08-24T07:32:41.877

有同样的问题，在尝试了任何我能做的事情之后，明显的工作...... /usr/local/bin/php /absolute/path/to/index.php cron

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-22T15:39:06.993

/usr/local/bin/php /home/jdstable/public_html/dev/index.php cron reduction_pets_stats

这解决了它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-04-16T11:15:01.923

这是解决方案，首先您需要从 phpinfo document_root 文件名中找到路径

php5 /home/abc/public_html/index.php folder_name 控制器函数

# qt - Simple TextArea Element in qml

> ID：15558831
> 
> 赞同：1
> 
> 时间：2013-03-21T21:47:39.900
> 
> 标签：qt, textarea, qml

I want to create simple TextArea element in QML and I try this code. but when write in Textarea , text's fall out of border.

Are you have simple TextArea or can you help me to improve this code:

```
FocusScope {
    id: focusScope
    width: 400; height: 50
property int fontSize: focusScope.height -30
property color textColor: "black"
property string placeHolder: "Type something..."
property string inputExpression: ".*"
property bool isUserInTheMiddleOfEntringText: false

Rectangle {
    width: parent.width
    height: parent.height
    border.color: 'steelblue'
    color: focus?'red':'#AAAAAA'
    border.width: 3
    radius: 0
    MouseArea {
        anchors.fill: parent
        onClicked: { focusScope.focus = true; textInput.openSoftwareInputPanel();
        }
    }
}

Text {
    id: typeSomething
    anchors.fill: parent; anchors.rightMargin: 8
    verticalAlignment: Text.AlignVCenter
    text: placeHolder
    color: "gray"
    font.italic: true
    font.pointSize: fontSize
    MouseArea {
        anchors.fill: parent
        onClicked: { focusScope.focus = true; textInput.openSoftwareInputPanel();
        }
    }

}

MouseArea {
    anchors.fill: parent
    onClicked: { focusScope.focus = true; textInput.openSoftwareInputPanel();
    }
}

TextEdit {
    id: textInput
    anchors { right: parent.right; rightMargin: 8; left: clear.left; leftMargin: 8; verticalCenter: parent.verticalCenter }
    focus: true
    selectByMouse: true
    font.pointSize: fontSize
    wrapMode: TextEdit.WordWrap
    color: textColor

}

Text {
    id: clear
    text: "\u2717" // 'x'//"\u2713"
    color: 'steelblue'
    font.pointSize: 25
    opacity: 0
    anchors { left: parent.left; leftMargin: 8; verticalCenter: parent.verticalCenter }
    MouseArea {
        anchors.fill: parent
        onClicked: { textInput.text = ''; focusScope.focus = true; textInput.openSoftwareInputPanel(); }
    }
}
states: State {
        name: "hasText"; when: textInput.text != ''
        PropertyChanges { target: typeSomething; opacity: 0 }
        PropertyChanges { target: clear; opacity: 1 }
    }
transitions: [
    Transition {
        from: ""; to: "hasText"
        NumberAnimation { exclude: typeSomething; properties: "opacity" }
    },
    Transition {
        from: "hasText"; to: ""
        NumberAnimation { properties: "opacity" }
    }
]
} 
```

thank's for help

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-27T12:48:18.377

这段代码应该做你想做的：

```
import QtQuick 2.0

FocusScope {
    id: focusScope;
    width: 400;
    height: textInput.paintedHeight + (2 * textInput.anchors.topMargin);

    property alias  value                          : textInput.text;
    property alias  fontSize                       : textInput.font.pointSize;
    property alias  textColor                      : textInput.color;
    property alias  placeHolder                    : typeSomething.text;

    Rectangle {
        id: background;
        anchors.fill: parent;
        color: "#AAAAAA";
        radius: 5;
        antialiasing: true;
        border {
            width: 3;
            color: (focusScope.activeFocus ? "red" : "steelblue");
        }
    }
    TextEdit {
        id: textInput;
        focus: true
        selectByMouse: true
        font.pointSize: 20;
        wrapMode: TextEdit.WrapAtWordBoundaryOrAnywhere;
        color: "black";
        anchors {
            top: parent.top;
            topMargin: 10;
            left: parent.left;
            leftMargin: 10;
            right: parent.right;
            rightMargin: 10;
        }
    }
    Text {
        id: typeSomething;
        text: "Type something...";
        color: "gray";
        opacity: (value === "" ? 1.0 : 0.0);
        font {
            italic: true
            pointSize: fontSize;
        }
        anchors {
            left: parent.left;
            right: parent.right;
            leftMargin: 10;
            rightMargin: 10;
            verticalCenter: parent.verticalCenter;
        }

        Behavior on opacity { NumberAnimation { duration: 250; } }
    }
    MouseArea {
        visible: (!focusScope.activeFocus);
        anchors.fill: parent
        onClicked: { textInput.forceActiveFocus(); }
    }
    Text {
        id: clear;
        text: "\u2717" // 'x' //"\u2713"
        color: 'steelblue';
        font.pixelSize: 30;
        opacity: (value !== "" ? 1.0 : 0.0);
        anchors {
            right: parent.right;
            bottom: parent.bottom;
            margins: 5;
        }

        Behavior on opacity { NumberAnimation { duration: 250; } }

        MouseArea {
            anchors.fill: parent
            onClicked: {
                value = "";
                focusScope.focus = false;
            }
        }
    }
} 
```

我还在你的代码中修复了很多东西，比如多个 MouseArea 用于相同的用途、绑定循环、错误的锚点/对齐等......

# jquery - jquery cycle pager and before and after functions

> ID：15558836
> 
> 赞同：0
> 
> 时间：2013-03-21T21:47:52.733
> 
> 标签：jquery

I know how to make a jquery cycle with a pager or a cycle with before and after functions. when I have both though, it removes the pager. is there anyway I can get around this. do I have to recreate the pager myself or something, or is there a better way

can I call the super before and after functions maybe? thank you

(I want to add the commented code)

```
 $LAB.script('/sesame_scripts/scripts/jquery.cycle.2.73.all.min.js')
        .wait(function() {

            var $firstSlide = $slideshowContainer.find('img'),
                width = $firstSlide.attr('width'),
                height = $firstSlide.attr('height'),
                slideItems = '';

            // add slides to slideshow (images 1-4)
            for (var i = 1; i <= 4; i++) {
                slideItems += '<img src="/assets/images/slideshow/slide'+i+'.jpg" alt="slide" width="'+width+'" height="'+height+'" />';
            }

            $slideshowContainer.append(slideItems);

            // start the slideshow 
            $('.slideshow img:first').fadeIn(1000, function() {
                $slideshowContainer.cycle({
                    fx:    'fade',
                    pause: false,
                    wmode: 'transparent',
                    height: height,
                    cleartype: false, // true if clearType corrections should be applied (for IE)
                    cleartypeNoBg: true, // Set to true to disable extra cleartype fixing (leave false to force background color setting on slides)
                    speed: 1000, // This controls speed of transition
                    timeout: 7000, // This controls delay between slides. Set to 0 if more than one office tour on a page, so they don't auto-play
                    pager: '#slide-pager',
                    /*before: function(){
                        //$('.slideA').css('display', 'none');
                    },
                    after: function() {
                        if(opts.slideCount == 1){
                            $('#slide1a').css('display', 'block');
                            $('#slide1n').css('display', 'block');

                        }else if(opts.slideCount == 3){
                            $('#slide3').css('display', 'block');

                        }else if(opts.slideCount == 4){
                            $('#slide4').css('display', 'block');
                        }
                    }*/
                });
            });
    }); 
```

# css - make an abosolute position div stretch content width

> ID：15558837
> 
> 赞同：1
> 
> 时间：2013-03-21T21:47:59.807
> 
> 标签：css, position, css-position

hope you can help me with my problem.

I have a div that is absolutly positioned (this can not be changed). This div has a maximum and minimum width.

Want i want to achieve is that the div stretch to its content and only when it overpases the width, start with a new line.

HTML:

```
<div class="black_tooltip_container ">
    some text in here, it can be anything!
</div> 
```

CSS:

```
position:absolute; min-width:10px; max-width:150px; 
```

What i see:

```
 _____________
  | some      |
  | text      |
  | in        |
  | here,     |
  | it        |
  | can       |
  | be        |
  | anything! |
  _____________ 
```

What i want to see:

```
 width: 150px
  _______________________________
  | some text   in here, it can |
  | be anything!                |
  ______________________________ 
```

**EDIT:** Issue solved. The problem was that I didn't realize the div was nested very far away in a div that was with relative position and width:50px;

After removing it from it's parent, it worked as spected

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T21:52:11.040

你有什么应该工作：

```
<div class="black_tooltip_container ">
    some text in here, it can be anything!
</div>

.black_tooltip_container {
    border:1px solid;
    min-width:10px; 
    max-width:150px;
    position:absolute;
} 
```

**在这里看到它：**

[http://jsfiddle.net/nbHMY/](http://jsfiddle.net/nbHMY/)

# ruby - Ruby：将两种相似的方法合二为一？

> ID：15558839
> 
> 赞同：3
> 
> 时间：2013-03-21T21:48:02.587
> 
> 标签：ruby, coding-style

对于 Rails 应用程序，我的 Ruby 对象中有两个*极其*相似的方法。我知道它们可以组合，我只是不知道如何。（如果你能找到一种更漂亮的方法来处理可能的 nils `return unless`，而不是使用 ，则加分`#try`。）

```
 def is_portal_admin?(resource)
    return unless resource.user && resource.user.clinic_memberships.any?
    memberships = resource.user.clinic_memberships.collect { |membership| membership.portal_admin? }
    memberships.include?(true)
  end

  def is_staff_admin?(resource)
    return unless resource.user && resource.user.clinic_memberships.any?
    memberships = resource.user.clinic_memberships.collect { |membership| membership.staff_admin? }
    memberships.include?(true)
  end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T21:51:31.520

怎么样：

```
def is_admin_of_type?(type, resource)
  return unless resource.user && resource.user.clinic_memberships.any? && type
  memberships = resource.user.clinic_memberships.collect { |membership| membership.send("#{type}_admin?") }
  memberships.include?(true)
end 
```

如果有人给出一个不存在的类型，它会抛出`NoMethodError`. 此外，如果您添加更多管理员类型，它是向前兼容的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T21:59:12.627

而不是你的`collect`and`include?`机制，你可以简单地使用`any?`. 如果`clinic_memberships`总是返回一个数组（如果它是一个`has_many`关联，它会这样做），你甚至不需要检查它。

```
def has_membership?(resource, &block)
  return unless resource.user
  resource.user.clinic_memberships.any?(&block)
end 
```

然后可以这样调用

```
has_membership?(resource, &:portal_admin?) 
```

这相当于

```
has_memberhsip?(resource){|m| m.portal_admin?} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T22:03:16.817

```
def is_admin?(resource, kind)
  if resource.user && resource.user.clinic_memberships.any?
    !!resource.user.clinic_memberships.detect { |membership| membership.send("#{kind}_admin?") }
  end
end 
```

如果您不进入 if 分支，则返回 nil，因此执行上述条件将产生与显式返回相同的结果，除非...

添加第二个参数并传递 :staff 或 :portal（或“staff”或“portal”）。使用“send”将在运行时评估为“staff_admin?” 或“portal_admin？”

使用检测而不是收集+包含？如果至少找到一个对象并且 !! 双重否定将其变成真/假结果。

自从resource.user.clinic_memberships.any？在宏伟的计划中没有实际意义：

```
def is_admin?(resource, kind)
  !!resource.user.clinic_memberships.detect { |membership| membership.send("#{kind}_admin?") } if resource.user
end 
```

如果您实际上是在尝试防止 Clinic_memberships 为 nil，那么您确实需要条件的第二半，但删除“.any？”，否则您会得到一个错误测试 any？反对零。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T22:13:18.930

```
def is_portal_admin?(resource)
  is_admin_of_type?(resource, :portal)
end

def is_staff_admin?(resource)
  is_admin_of_type?(resource, :staff)
end

def is_admin_of_type?(resource, type)
  if (user = resource.user)
    user.clinic_memberships.any? { |ms| ms.send("#{type}_admin?") }
  end
end 
```

*   检查是否有`memberships`.
*   您可以在`|| false`条件后添加，以确保您`method?`返回布尔值。
*   你可以设为`is_admin_of_type?`私有。

# c++ - 调用函数 // “]”标记之前的预期主表达式

> ID：15558841
> 
> 赞同：-8
> 
> 时间：2013-03-21T21:48:06.600
> 
> 标签：c++

```
`#include <iostream>

 using namespace std;

 #define N 10

 void QuickSort(int arr[],int left,int right)
{
int i = left, j = right;
int buffer;
int middle = arr[(left+right)/2];

//partition
while(i<=j)
{
    while(arr[i]<middle)
        i++;
    while(arr[j]>middle)
        j--;
    if(i<=j)
    {
        buffer = arr[i];
        arr[i] = arr[j];
        arr[j] = buffer;
        i++;
        j--;
    }
}

//recursion
 if (left < j)
    QuickSort(arr, left, j);
 if (i < right)
    QuickSort(arr, i, right);
}

int main()
{

  int A[N] = {10,9,8,7,6,5,4,3,2,1};
  QuickSort(A[],A,A+N);     //ERROR
  return 0;

}` 
```

好的，伙计们-这是我的问题。我真的不知道如何调用该函数来对标准的非动态数组进行排序。当我尝试使用 QuickSort(A[],A,A+N) 调用 QuickSort(int A[],int left, int right) 时，会出现一个错误，提示“在 "]" token 之前预期的主表达式"。提前感谢您的反馈。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T21:50:16.593

像这样传入A。您的第二个和第三个参数也是 int 值，因此虽然我不会深入探讨您的代码逻辑，但您应该选择一个整数来为您的数组排序提供界限。您现在传入的是数组中第一个元素的 int *，然后第三个参数是该值 + N。坏消息熊！

```
#include <iostream>

 using namespace std;

 #define N 10

 void QuickSort(int arr[],int left,int right)
{
int i = left, j = right;
int buffer;
int middle = arr[(left+right)/2];

//partition
while(i<=j)
{
    while(arr[i]<middle)
        i++;
    while(arr[j]>middle)
        j--;
    if(i<=j)
    {
        buffer = arr[i];
        arr[i] = arr[j];
        arr[j] = buffer;
        i++;
        j--;
    }
}

//recursion
 if (left < j)
    QuickSort(arr, left, j);
 if (i < right)
    QuickSort(arr, i, right);
}

int main()
{

  int A[N] = {10,9,8,7,6,5,4,3,2,1};
  QuickSort(A,0,N);     //DO THIS
  return 0;

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T21:54:07.333

两件事情：

1.  自己`A`过去。
2.  `left`并且`right`是数组索引，而不是指针。

试试这个：

```
int A[N] = {10,9,8,7,6,5,4,3,2,1};
QuickSort(A, 0, N - 1); // array length N means the last element is index N-1. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T21:52:03.967

将数组传递给函数时不应使用大括号，而且您的代码似乎应该是：

```
QuickSort(A,0,0+N); 
```

# maven-3 - 声纳：IllegalStateException

> ID：15558848
> 
> 赞同：0
> 
> 时间：2013-03-21T21:48:51.987
> 
> 标签：maven-3, sonarqube

我正在尝试在 Ubuntu 12.04 机器上设置声纳。但是，当我运行`mvn`（maven 3.0.4）时，它会因为这个异常而失败。声纳服务器运行良好，我可以从浏览器访问它。

这是我在 settings.xml (~/.m2/settings.xml) 中的声纳配置文件

```
<profiles>
 <profile>
  <id>sonar</id>
  <activation>
     <activeByDefault>true</activeByDefault>
  </activation>
  <properties>
     <sonar.jdbc.url>jdbc:h2:tcp://localhost:9092/sonar</sonar.jdbc.url>
     <sonar.jdbc.driver>org.h2.Driver</sonar.jdbc.driver>
     <sonar.jdbc.username>sonar</sonar.jdbc.username>
     <sonar.jdbc.password>sonar</sonar.jdbc.password>
  </properties>
 </profile>
</profiles> 
```

例外：

```
[ERROR] Failed to execute goal org.codehaus.mojo:sonar-maven-plugin:2.0:sonar (default-cli) on project configurator: Can not execute Sonar: IllegalStateException -> [Help 1]
org.apache.maven.lifecycle.LifecycleExecutionException: Failed to execute goal     org.codehaus.mojo:sonar-maven-plugin:2.0:sonar (default-cli) on project configurator: Can not     execute Sonar
at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:217)
at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:153)
at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:145)
at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:84)
at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:59)
at org.apache.maven.lifecycle.internal.LifecycleStarter.singleThreadedBuild(LifecycleStarter.java:183)
at org.apache.maven.lifecycle.internal.LifecycleStarter.execute(LifecycleStarter.java:161)
at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:320)
at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:156)
at org.apache.maven.cli.MavenCli.execute(MavenCli.java:537)
at org.apache.maven.cli.MavenCli.doMain(MavenCli.java:196)
at org.apache.maven.cli.MavenCli.main(MavenCli.java:141)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597)
at org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced(Launcher.java:290)
at org.codehaus.plexus.classworlds.launcher.Launcher.launch(Launcher.java:230)
at org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(Launcher.java:409)
at org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:352)
Caused by: org.apache.maven.plugin.MojoExecutionException: Can not execute Sonar
at org.codehaus.mojo.sonar.Bootstraper.executeMojo(Bootstraper.java:118)
at org.codehaus.mojo.sonar.Bootstraper.start(Bootstraper.java:65)
at org.codehaus.mojo.sonar.SonarMojo.execute(SonarMojo.java:90)
at org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo(DefaultBuildPluginManager.java:101)
at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:209)
... 19 more
Caused by: java.lang.IllegalStateException
at org.sonar.home.cache.FileCache.newTempFile(FileCache.java:143)
at org.sonar.home.cache.FileCache.get(FileCache.java:83)
at org.sonar.batch.bootstrap.PluginDownloader.downloadPlugin(PluginDownloader.java:53)
at org.sonar.batch.bootstrap.BatchPluginRepository.doStart(BatchPluginRepository.java:74)
at org.sonar.batch.bootstrap.BatchPluginRepository.start(BatchPluginRepository.java:65)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597)
at org.picocontainer.lifecycle.ReflectionLifecycleStrategy.invokeMethod(ReflectionLifecycleStrategy.java:110)
at org.picocontainer.lifecycle.ReflectionLifecycleStrategy.start(ReflectionLifecycleStrategy.java:89)
at org.picocontainer.injectors.AbstractInjectionFactory$LifecycleAdapter.start(AbstractInjectionFactory.java:84)
at org.picocontainer.behaviors.AbstractBehavior.start(AbstractBehavior.java:169)
at org.picocontainer.behaviors.Stored$RealComponentLifecycle.start(Stored.java:132)
at org.picocontainer.behaviors.Stored.start(Stored.java:110)
at org.picocontainer.DefaultPicoContainer.potentiallyStartAdapter(DefaultPicoContainer.java:1009)
at org.picocontainer.DefaultPicoContainer.startAdapters(DefaultPicoContainer.java:1002)
at org.picocontainer.DefaultPicoContainer.start(DefaultPicoContainer.java:760)
at org.sonar.api.platform.ComponentContainer.startComponents(ComponentContainer.java:72)
at org.sonar.batch.bootstrap.Container.start(Container.java:71)
at org.sonar.batch.bootstrapper.Batch.startBatch(Batch.java:88)
at org.sonar.batch.bootstrapper.Batch.execute(Batch.java:72)
at org.sonar.maven3.SonarMojo.execute(SonarMojo.java:142)
at org.codehaus.mojo.sonar.Bootstraper.executeMojo(Bootstraper.java:113)
... 23 more 
```

如果您需要任何其他信息，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-22T01:04:07.947

堆栈跟踪告诉我们，自 2011 年 11 月 5 日以来，当前插件已经`org.codehaus.mojo:sonar-maven-plugin:2.0`相当老了。

我建议***不要在我们的 pom.xml 中将其定义***[为使用 Maven](http://docs.codehaus.org/display/SONAR/Analyzing+with+Maven#AnalyzingwithMaven-RecommendedWay)进行分析中的提及：推荐方式如下：-

```
mvn clean install -DskipTests=true
mvn sonar:sonar 
```

> skipTests=true 不运行单元测试两次：安装目标期间和声纳目标期间。您还可以停用集成测试执行。请参阅 Maven 文档。

无论如何，如果您想明确定义它，请使用与您的 Sonar 服务器版本匹配的最新版本。例如，我正在使用当前的 Sonar 服务器版本 3.5。插件应该是，`org.codehaus.sonar:sonar-maven-plugin:3.5`或者`org.codehaus.sonar:sonar-maven3-plugin:3.5`

甚至[安装和配置 Maven](http://docs.codehaus.org/display/SONAR/Installing+and+Configuring+Maven)也告诉我们`sonar.host.url`是可选的（默认是`http://localhost:9000`），我也想鼓励明确定义它。

我希望这可能会有所帮助。

# ubuntu-12.04 - 开始散居时失败

> ID：15558851
> 
> 赞同：1
> 
> 时间：2013-03-21T21:49:17.727
> 
> 标签：ubuntu-12.04, diaspora

我在我的 Ubuntu 服务器上安装了 diaspora。这是我的堆栈跟踪。我不知道该怎么做才能修复它。甚至无法通过谷歌找到任何答案。

```
22:45:03 web.1    | started with pid 16564
22:45:03 worker.1 | started with pid 16567
22:45:14 web.1    | /usr/local/rvm/gems/ruby-1.9.3-p385@diaspora/gems/unicorn-4.6.0/lib/unicorn/configurator.rb:589:in `set_path': ArgumentError (ArgumentError)
22:45:14 web.1    |     from /usr/local/rvm/gems/ruby-1.9.3-p385@diaspora/gems/unicorn-4.6.0/lib/unicorn/configurator.rb:493:in `stderr_path'
22:45:14 web.1    |     from config/unicorn.rb:24:in `reload'
22:45:14 web.1    |     from /usr/local/rvm/gems/ruby-1.9.3-p385@diaspora/gems/unicorn-4.6.0/lib/unicorn/configurator.rb:75:in `instance_eval'
22:45:14 web.1    |     from /usr/local/rvm/gems/ruby-1.9.3-p385@diaspora/gems/unicorn-4.6.0/lib/unicorn/configurator.rb:75:in `reload'
22:45:14 web.1    |     from /usr/local/rvm/gems/ruby-1.9.3-p385@diaspora/gems/unicorn-4.6.0/lib/unicorn/configurator.rb:68:in `initialize'
22:45:14 web.1    |     from /usr/local/rvm/gems/ruby-1.9.3-p385@diaspora/gems/unicorn-4.6.0/lib/unicorn/http_server.rb:108:in `new'
22:45:14 web.1    |     from /usr/local/rvm/gems/ruby-1.9.3-p385@diaspora/gems/unicorn-4.6.0/lib/unicorn/http_server.rb:108:in `initialize'
22:45:14 web.1    |     from /usr/local/rvm/gems/ruby-1.9.3-p385@diaspora/gems/unicorn-4.6.0/bin/unicorn_rails:209:in `new'
22:45:14 web.1    |     from /usr/local/rvm/gems/ruby-1.9.3-p385@diaspora/gems/unicorn-4.6.0/bin/unicorn_rails:209:in `<top (required)>'
22:45:14 web.1    |     from /usr/local/rvm/gems/ruby-1.9.3-p385@diaspora/bin/unicorn_rails:19:in `load'
22:45:14 web.1    |     from /usr/local/rvm/gems/ruby-1.9.3-p385@diaspora/bin/unicorn_rails:19:in `<main>'
22:45:14 web.1    |     from /usr/local/rvm/gems/ruby-1.9.3-p385@diaspora/bin/ruby_noexec_wrapper:14:in `eval'
22:45:14 web.1    |     from /usr/local/rvm/gems/ruby-1.9.3-p385@diaspora/bin/ruby_noexec_wrapper:14:in `<main>'
22:45:14 web.1    | exited with code 1
22:45:14 system   | sending SIGTERM to all processes
SIGTERM received
22:45:14 worker.1 | rake aborted!
22:45:14 worker.1 | SIGTERM
22:45:14 worker.1 | /root/diaspora_source/diaspora/config/application.rb:11:in `require'
22:45:14 worker.1 | /root/diaspora_source/diaspora/config/application.rb:11:in `<top (required)>'
22:45:14 worker.1 | /root/diaspora_source/diaspora/Rakefile:8:in `require'
22:45:14 worker.1 | /root/diaspora_source/diaspora/Rakefile:8:in `<top (required)>'
22:45:14 worker.1 | /usr/local/rvm/gems/ruby-1.9.3-p385@diaspora/bin/ruby_noexec_wrapper:14:in `eval'
22:45:14 worker.1 | /usr/local/rvm/gems/ruby-1.9.3-p385@diaspora/bin/ruby_noexec_wrapper:14:in `<main>'
22:45:14 worker.1 | (See full trace by running task with --trace)
22:45:14 worker.1 | terminated by SIGTERM 
```

提前致谢！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-22T14:45:05.453

正如 jaywink 指出的那样，您不应该以 root 身份运行 Diaspora。

但是，您的错误仅发生在当前发布的版本中，并且仅在您设置`stderr_path`和/或`stdout_path`为独角兽时才会发生。一旦制作了下一个非修补程序版本，它将使用此[修补程序修复。](https://github.com/diaspora/diaspora/commit/43f21d6e55256b0ad161a91a39dfc702aba66574)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-22T14:22:43.517

您是否以 root 身份安装了 Diaspora*？这是绝对不推荐的，Diaspora* 应该在普通用户下安装。

引用 Diaspora* 安装说明：

> 我们经常看到人们以 root 身份做所有事情。如果您认为这是个好主意：不是。这是你能做的最糟糕的事情！所有程序都会告诉您以 root 身份运行它们或要求您输入密码。如果它或本指南未明确要求，请勿以 root 身份启动任何内容。只需使用您的普通用户或为 Diaspora 创建自己的系统用户。

[https://wiki.diasporafoundation.org/Installation](https://wiki.diasporafoundation.org/Installation)

# css - vertical centering of Myriad Pro in IE9 and IE10

> ID：15558853
> 
> 赞同：2
> 
> 时间：2013-03-21T21:49:22.657
> 
> 标签：css, fonts, internet-explorer-9, vertical-alignment, internet-explorer-10

I've a single line of text written with Myriad Pro vertically centered to parent. In most browsers it renders fine, however in IE9&10 the text is not exactly centered, it shifted up by about 3 pixels from its correct position.

I've found out that the problem is caused by the font, the same case is rendered correctly with Arial. On the following image you can see the problem. Part of the text is selected and it seems that the text is sticked to the top of the selection for some weird reason and the selection is vertically centered correctly.

![align problem](../Images/3f8907097cab672fe933bd0a9c41c60f.png)

Source:

```
<!DOCTYPE html>
<html>    
    <head>
      <style type="text/css">
        div
          {
            vertical-align:middle;
            height:40px;
            line-height:40px;
            background-color:red;
            font-family:"Myriad pro",arial;
          }
      </style>
    </head>    
    <body>
        <div>LOREM IPSUM</div>
    </body>
</html> 
```

Can you please explain me why this happens and how to fix it?

Thanks a lot.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T18:00:05.037

我终于使用 Adob​​e Typekit 解决了这个问题。用 Typekit 编写的 Myriad Pro 正确垂直居中。

但我仍然想知道为什么会这样。

# php - url 的预匹配。正则表达式

> ID：15558855
> 
> 赞同：0
> 
> 时间：2013-03-21T21:49:25.830
> 
> 标签：php, regex, validation

我有一个验证特定网址的正则表达式，但它并没有真正起作用。我想验证这样的网址 -----> https : // example.co.nz/#![RANDOM_KEYS_HERE]。
我只想用https来做。最重要的是，用户的输入需要匹配 https://example.co.nz/#! 但是在#!之后，用户可以放任何他喜欢的东西。

这是代码：我知道代码是错误的 xD 我对此有基本的了解，哈哈

```
#^https://example+\.[co\.nz][a-z0-9-_.]+\.[a-z]{2,4}#i 
```

如果有人可以帮助我做到这一点，那就太好了！谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T21:55:43.850

呃...甚至没有接近。您的正则表达式如下所示：

*   从字符串的开头开始...
*   从字面上匹配`https://exampl`
*   匹配一个或多个`e`
*   匹配文字`.`
*   匹配以下任何一项：`cnoz.`
*   匹配以下一项或多项：`a-z0-9-_.`
*   匹配文字`.`
*   匹配 2 到 4 个字母

这与您正在寻找的完全不同。毕竟，我认为您不希望这通过：

```
https://exampleeeeeeeeeeee.complete.and.total.failure.-_-.lol 
```

相反，试试这个：

```
(^https://example\.co\.nz/#!(.*)) 
```

这个正则表达式如下：

*   从字符串的开头开始...
*   从字面上匹配`https://example.co.nz/#!`
*   之后捕捉一切

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T21:56:29.043

```
if (preg_match('%^https://example\.co\.nz/#!(.+)$%i', $subject)) {
    # Successful match
} else {
    # Match attempt failed
} 
```

或者你可以用这个得到你的 [RANDOM_KEYS_HERE] 部分

```
if (preg_match('%^https://example\.co\.nz/#!(.+)$%i', $subject, $regs)) {
    $result = $regs[0];
} else {
    $result = "";
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T21:56:53.747

试试这个：

```
^https:\/\/example\.co\.nz\/\#\!(.*)$ 
```

最后的括号将进行子表达式匹配，这应该允许您提取 ID。

```
if (preg_match('/^https:\/\/example\.co\.nz\/\#\!(.*)$/', $searchString, $matches)) {
    $id = $matches[1];
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T21:58:23.917

你在那里不需要正则表达式。您只需要找出字符串是否以某个子字符串开头。检查这个：

```
if(strpos($url, 'https://example.co.nz/#!')===0)
{
    echo 'url is OK';
}
else
{
    echo 'url is wrong';
} 
```

[http://www.php.net/manual/en/function.strpos.php](http://www.php.net/manual/en/function.strpos.php)

我希望这有帮助。

# php - PHP 条件重定向总是重定向到同一页面

> ID：15558859
> 
> 赞同：0
> 
> 时间：2013-03-21T21:49:38.283
> 
> 标签：php, redirect, dns, conditional

我有两个域，需要创建一个入口脚本，这样我就可以确定用户要访问的站点并将它们重定向到站点的正确部分，但它只是指向第一个链接

```
<?php

if($_SERVER['HTTP_HOST'] == 'neonbacon.com' || 'www.neonbacon.com') 
{
header("Location: http://neonbacon.com/client");
}
else if($_SERVER['HTTP_HOST'] == 'scarletgamers.com' || 'www.scarletgamers.com')
{
header("Location: http://scarletgamers.com/home");
}else
{
echo 'Error 1';
}

?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T21:51:18.380

这是一个操作顺序问题。你在问是否

`$_SERVER['HTTP_HOST'] == 'neonbacon.com'` 或者 `'www.neonbacon.com'`

...是真的。第二个永远是真的，因为它只是一个字符串。因此，它将始终执行该`if`块。

尝试这个：

```
if($_SERVER['HTTP_HOST'] == 'neonbacon.com' || $_SERVER['HTTP_HOST'] == 'www.neonbacon.com') 
```

和：

```
else if($_SERVER['HTTP_HOST'] == 'scarletgamers.com' || $_SERVER['HTTP_HOST'] == 'www.scarletgamers.com') 
```

# css - 包含 div 未完全扩展为包含具有百分比的子项

> ID：15558863
> 
> 赞同：1
> 
> 时间：2013-03-21T21:49:55.170
> 
> 标签：css

我有一个 div 可以扩展以适合其子 div，但是当我给子填充或边距以百分比指定时，父级似乎没有考虑该空间。但是，如果我使用像素指定填充或边距，它可以正常工作，这看起来很奇怪。我一直在寻找解决方案，但无济于事。我已经在 Firefox 和 Chrome 中尝试过，这是我必须支持的唯一浏览器。
[http://jsfiddle.net/YTsmz/5/](http://jsfiddle.net/YTsmz/5/)

带像素：
![像素示例](../Images/48c1999cba66e3406b4443b5a7c3e819.png)

百分比：
![在此处输入图像描述](../Images/6dc87a336e98b47c0ce0aa5994549bba.png)

的HTML：

```
<div class="field">
    <div class="name">countries</div>
    <div class="value">united states</div>
    <div class="value">united kingdom</div>
    <div class="value">dominican republic</div>
</div> 
```

的CSS：

```
.field {
    position: relative;
    float: left;
    border-right: 1px dotted #3d3d3d;
    line-height: 1em;
    white-space: nowrap;
    padding: 0 1% 0 1%;
    font-weight:bold;
}
.field .name {
    font-size:1em;
    line-height:1.5em;
}
.field .value {
    display: inline-block;
    margin: 0% 1% 0% 0%;
    border-right: 1px dotted #3d3d3d;
    padding: 0 1% 0 1%;
    font-size:1.3em;
    line-height:1.3em;
}
.field .value:last-of-type {
    border-right: none;
} 
```

# neo4j - 将密码查询结果映射到域对象

> ID：15558864
> 
> 赞同：2
> 
> 时间：2013-03-21T21:50:01.303
> 
> 标签：neo4j, spring-data-neo4j

我刚开始将 Neo4j 与 Spring Data 一起使用，我无法恢复图形对象并将它们转换回域对象。我必须说我以前没有这种数据库的经验。

这样，我正在使用 Spring Data 存储库。对于标准查询，存储库代码是自动生成的，但我想定义一些自定义方法，所以我创建了我的自定义存储库，如此[处](http://static.springsource.org/spring-data/commons/docs/current/reference/html/repositories.html)所述。

例如，我希望能够从两个特定节点之间的给定边更新某个属性值（在这种情况下为 currentValue 属性）（searchByUserName 是我的节点实体中先前定义的代表用户的索引）。我在自定义存储库实现中使用来自 Neo4j 模板的查询方法，如下所示：

```
public class TwitterUserRepositoryImpl implements TwitterUserRepositoryCustom{

    @Autowired
    private Neo4jOperations neo4jTemplate;

public void updateRelationshipValueByUserName(
            String userAUserName, String userBUserName, double value){
        HashedMap params = new HashedMap();
        params.put("userAUserName", userAUserName);
        params.put("userBUserName", userBUserName);
        params.put("value", value);
        String query = "START x=node:searchByUserName(userName = {userAUserName}), " +
                        "y=node:searchByUserName(userName = {userBUserName})" +
                        " MATCH (x)-[r:FOLLOWS]->(y)" +
                        " SET r.currentValue = {value}" +
                        " RETURN r";
        Result<Map<String, Object>> relationships = neo4jTemplate.query(query, params);
        /* let's try to recover the relationship entity and do some more stuff */
    } 
```

密码查询返回两个用户之间的“边缘”，其关系类型为“FOLLOWS”，模拟 Twitter 用户网络。我不知道如何将此 QueryResult 对象转换回我的 RelationshipEntity 对象。那可能吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-21T22:50:46.187

只需使用结果-dsl：[http ://static.springsource.org/spring-data/data-graph/snapshot-site/reference/html/#d5e1118](http://static.springsource.org/spring-data/data-graph/snapshot-site/reference/html/#d5e1118)

```
relationships.to(MyRelationshipEntity.class) 
```

会给你`Result<MyRelationshipEntity>`一个`Iterable`

# arrays - 使用Matlab在具有约束的数组中增加值？

> ID：15558867
> 
> 赞同：1
> 
> 时间：2013-03-21T21:50:06.437
> 
> 标签：arrays, matlab, compare

**场景：**
如果我有一个包含 4 个负载的数组（a1 a2 a3 a4）

```
a=[a1 a2 a3 a4] (locations of these loads must be fixed)
a=[1 2 3 3] 
```

我想尝试将数组中的所有值增加到 3。
*注意：数组`a`不是固定的，可以有任何值`0:3`*

**约束：**

1.  有一个不能违反的优先级数组
2.  总增量数限制为 3

**给定：**

优先级数组`v=[1 3 2 1]`——（1 为最高优先级，3 为最低优先级）。
*注意：数组`v`不是固定的，可以有任何值`0:3`*

使用此优先级数组：

```
a(1,1)=highest priority  
a(1,4)=2nd highest priority  
a(1,3)=3rd priority  
a(1,2)=lowest priority 
```

**实施，我的伪代码试验：**

```
a=[1 2 3 3]
v=[1 3 2 1]
count=3

Check highest priority : a(1,1)
increment by 1
decrement count by 1
count = 2
still less than 3 ? if yes, then increment again until a(1,1)<= 3 AND count >=0
Change highest priority to 5 (so that min(v) will not pick it up)

ans : a=[3 2 3 3] ; v=[5 2 3 3] ; count = 1

Check highest priority : a(1,3)
value >= 3
Change highest priority to 5 (so that min(v) will not pick it up)
skip

ans : a=[3 2 3 3] ; v=[5 2 5 3] ; count = 1

Check highest priority : a(1,4)
value >=3 
Change highest priority to 5 (so that min(v) will not pick it up)
skip

ans : a=[3 2 3 3] ; v=[5 2 5 5] ; count = 1

Check highest priority : a(1,2)
increment by 1
decrement count by 1
count = 0
still less than 3 ? if yes, then increment again until a(1,1)<= 3 AND count >=0 
Change highest priority to 5 (so that min(v) will not pick it up)

ans = [a1 a2 a3 a4] = [3 3 3 3] 
```

*注意：如果达到优先级值 = [1 1 1 1]，则`a`从左到右优先（我还没有找到更好的方法）*

我希望这是有道理的，并且我的伪代码显示了我正在尝试实现的内容。问我是否有不清楚的地方。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T22:02:32.093

你可以做这样的事情

```
a = [1 2 3 3]; 
v = [1 3 2 1];

% Sort a in the order of priority v
[vSrt, indSrt] = sort(v);
a = a(indSrt);

nIncsRemaining = 3; % Total no. of increments allowed
target = 3; % Target value for each value in a

for curInd = 1:length(a)
    % Difference from target
    aDiff = target - a(curInd);
    % Do we need to increment this value of a?
    if aDiff > 0
        % Increment by a maximum of nIncsRemaining
        aDelta = min(aDiff, nIncsRemaining); 
        % Increment a and decrement no. of increments remaining by the
        % same amount
        a(curInd) = a(curInd) + aDelta; 
        nIncsRemaining = nIncsRemaining - aDelta; 
    end

    % Have we done as much as we're allowed?
    if nIncsRemaining == 0, break; end
end 
```

关键步骤是优先级数组的排序，以及通过相同索引对 a 进行排序。然后你可以循环 a，确信你从最高优先级开始。

如果您需要与输出时的输入相同的顺序，那么您可以通过执行来反转排序操作

```
[~, indReSrt] = sort(indSrt);
a = a(indReSrt); 
```

数组 v 一开始没有被修改，因此您不需要反转该数组的排序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T22:33:25.707

另一个版本：

```
a = [1 2 3 3];
v = [1 3 2 1];
count = 3;
target = 3; 
```

按优先顺序`a`排序`v`

```
[vSorted, order] = sort(v);
aSorted = a(order); 
```

找到将导致`count`相等的位置`0`

```
pos = find(cumsum(target - aSorted) >= count); 
```

更新所有值，直到但不包括，相应`pos`递减`count`

```
count = count - sum(3 - aSorted(1:pos - 1));
vSorted(1:pos - 1) = 5;
aSorted(1:pos - 1) = target; 
```

更新值 s`pos`

```
aSorted(pos) = aSorted(pos) + count;
count = 0;
if aSorted(pos) == target
    vSorted(pos) = 5;
end 
```

恢复排序顺序

```
 [~, invOrder] = sort(order);
 a = aSorted(invOrder);
 v = vSorted(invOrder); 
```

if`v`仅用于确定优先级，无需更新。在所有的值都达到之后，如果`count`可能仍然非零，则需要对这种情况进行一些额外的处理，因为这将导致返回一个空数组。`a``target``pos = find(...);`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-21T22:35:22.187

这是我想出的：

```
a = [1 2 3 3];
v = [1 3 2 1];

% Get priority vector - this converts v into the indices of a that are most important in descending order. This can also be preallocated for speed or stored in place if v is not important;
priority_vec = [];
for i = 0:3
   % Get indices
   priority_vec = horzcat(priority_vec,find(v == i));   
end

% Loop over priority_vec
count = 3; % count is the number of additions you can make
for i = 1:4 % Loop over the indices of priority vec
    priority_ind = priority_vec(i); % This is the current index of most importance
    while(a(priority_ind) < 3 && count ~= 0) % Continue to add one while count is greater than 0 and the value at the priority index is less than three             
        a(priority_ind) = a(priority_ind) + 1;
        count = count - 1;
    end    
end 
```

# unit-testing - 使用 Autofixture 的 CreateProxy 来使用 Likeness、SemanticComparison 功能时遇到问题

> ID：15558873
> 
> 赞同：3
> 
> 时间：2013-03-21T21:50:24.673
> 
> 标签：unit-testing, autofixture, stub-data-generation, semantic-comparison

在我[之前](https://stackoverflow.com/q/15470997/533958)询问过 Autofixture 的[CreateProxy 方法](http://blog.ploeh.dk/2012/06/22/ResemblanceandLikeness/)的问题中，发现了一个[潜在的错误](https://github.com/AutoFixture/AutoFixture/issues/87)。

我不认为这个失败的测试是因为这个，而是我对 Likeness.Without(...).CreateProxy() 语法如何工作的持续困惑。考虑以下失败的测试，在该测试中，我通过创建对象的新实例使[原始测试](https://stackoverflow.com/q/15470997/533958) *变得稍微复杂*一些，并认为它的创建是[SUT](http://en.wikipedia.org/wiki/System_under_test)：

```
[Fact]
public void Equality_Behaves_As_Expected()
{
    // arrange: intent -> use the fixture-created Band as Object Mother
    var template = new Fixture().Create<Band>();

    // act: intent -> instantiated Band *is* the SUT
    var createdBand = new Band {Brass = template.Brass,
                                Strings = template.Brass};

    //   intent -> specify that .Brass should not be considered in comparison 
    var likeness = template.AsSource().OfLikeness<Band>().
        Without(x => x.Brass).CreateProxy(); // Ignore .Brass property

    // per [https://stackoverflow.com/a/15476108/533958] explicity assign
    // properties to likeness
    likeness.Strings = template.Strings;
    likeness.Brass = "foo"; // should be ignored

    // assert: intent -> check equality between created Band & template Band
    //         to include all members not excluded in likeness definition
    likeness.Should().Be(createdBand);          // Fails
    likeness.ShouldBeEquivalentTo(createdBand); // Fails
    Assert.True(likeness.Equals(createdBand));  // Fails
} 
```

这是乐队：

```
public class Band
{
    public string Strings { get; set; }
    public string Brass { get; set; }
} 
```

我[之前的问题](https://stackoverflow.com/q/15470997/533958)不够复杂，无法帮助我理解 the `Source`of the`Likeness`通常应该是什么。

源是否应该是[SUT](http://en.wikipedia.org/wiki/System_under_test)的输出，在这种情况下，它将与 AutoFixture 创建的*模板*实例进行比较？

或者源应该是 AutoFixture 创建的*模板*实例，在这种情况下它将与[SUT](http://en.wikipedia.org/wiki/System_under_test)的输出进行比较？

**编辑：更正了测试中的错误**

我意识到我错误地将属性分配给了`template.Brass`新*实例*的和属性`Brass` *。*更新后的测试反映了更正，并且所有六个断言现在都通过了。`Strings``Band``var createdBand = new Band {Brass = template.Brass, Strings = template.Strings}`

```
[Fact]
public void Equality_Behaves_As_Expected()
{
    // arrange: intent -> use the fixture-created Band as Object Mother
    var template = new Fixture().Create<Band>();

    // act: intent -> instantiated Band *is* the SUT
    var createdBand = new Band {Brass = template.Brass, Strings = template.Strings};

    // likeness of created
    var createdLikeness = createdBand.AsSource().OfLikeness<Band>().
        Without(x => x.Brass).CreateProxy(); // .Brass should not be considered in comparison 

    // https://stackoverflow.com/a/15476108/533958 (explicity assign properties to likeness)
    createdLikeness.Strings = createdBand.Strings;
    createdLikeness.Brass = "foo"; // should be ignored

    // likeness of template
    var templateLikeness = template.AsSource().OfLikeness<Band>()
        .Without(x => x.Brass)
        .CreateProxy();
    templateLikeness.Strings = template.Strings;
    templateLikeness.Brass = "foo";

    // assert: intent -> compare created Band to template Band
    createdLikeness.Should().Be(template);
    createdLikeness.ShouldBeEquivalentTo(template);
    Assert.True(createdLikeness.Equals(template));

    templateLikeness.Should().Be(createdBand);
    templateLikeness.ShouldBeEquivalentTo(createdBand);
    Assert.True(templateLikeness.Equals(createdBand));
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-22T07:21:50.303

你的意思是：

```
likeness.Should().BeAssignableTo<Band>(); // Returns true. 
```

在提供的示例中，生成的代理是从`Likeness`派生的类型，使用语义比较算法`Band`覆盖。`Equals`

使用反射是：

```
createdBand.GetType().IsAssignableFrom(likeness.GetType()) // Returns true. 
```

**更新**：

createBand和*模板*实例不受该*方法*的影响。为什么他们应该？*`CreateProxy`*

 *使用 Likeness `CreateProxy`，您基本上可以创建一个[自定义平等断言](http://xunitpatterns.com/Custom%20Assertion.html)，允许您执行以下操作：

```
Assert.True(likeness.Equals(createdBand)); // Passed. 
```

没有它，原始的平等断言将失败：

```
Assert.True(template.Equals(createdBand)); // Failed. 
```

但是，以下操作也会失败：

```
Assert.True(likeness.Equals(template)); 
```

它失败了，因为该`Strings`值是*createdBand*实例中的值。

这种行为是预期的，您可以`Likeness`直接使用以下方法进行验证：

```
 createdBand.AsSource().OfLikeness<Band>()
     .Without(x => x.Brass).ShouldEqual(template); 
```

输出：

```
 The provided value `Band` did not match the expected value `Band`. The following members did not match:
      - Strings. 
```*

# celery - 使用主管运行 celeryd_multi

> ID：15558875
> 
> 赞同：7
> 
> 时间：2013-03-21T21:50:29.237
> 
> 标签：celery, django-celery, supervisord, background-foreground

我正在与 djcelery 和主管合作。我和主管一起经营芹菜，一切正常，一旦我意识到我需要把它换成芹菜多，一切都破裂了。如果我在终端中运行 celeryd_multi 它可以工作但总是在后台运行，就像主管需要命令在问题所在的前台运行。

这是我的`celery.ini`：

```
[program:celery_{{ division }}]
command = {{ virtualenv_bin_dir }}/python manage.py celeryd_multi start default mailchimp -c:mailchimp 3 -c:default 5 --loglevel=info --logfile={{ log_dir }}/celery/%n.log --pidfile={{ run_dir }}/celery/%n.pid --schedule=/home/celery/celerybeat-schedule --settings={{ django_settings_python_path }}
autorestart = false
autostart = false
directory = {{ repo_dir }}/{{ division }}
user=celery
numprocs = 1
redirect_stderr = True
stopwaitsecs = 10
startsecs = 10
priority = 997
startretries = 3 
```

这是我在终端中输入的命令，效果很好

`python manage.py celeryd_multi start default mailchimp -c:mailchimp 3 -c:default 5 --loglevel=info --logfile=/var/log/celery/%n.log --pidfile=/var/log/celery/%n.pid --schedule=/home/celery/celerybeat-schedule --settings=lively.settings_gunicorn`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-02T15:40:00.857

[celery 主要开发者的回复](https://groups.google.com/forum/?fromgroups=#!topic/celery-users/oQh7mJOV-G8)（2012 年 3 月 23 日）：

> 我不知道使用主管启动多个 celeryd 实例的任何简单解决方案，但您始终可以为每个实例使用一个配置。也许其他人对此有解决方案。
> 
> generic-init.d/celeryd 脚本使用 celeryd-multi 来启动多个服务器，您可以使用 CELERYD_NODES /etc/init.d/celeryd 变量来设置一个数字，或者一个worker名称列表。我不确定如何让supervisord与celeryd-multi一起使用，因为它可能需要知道哪些结果PID应该被监控（也许可以编写一个supervisord插件？）
> 
> ——问索伦

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-27T16:26:28.787

Daemontools 有一个名为 fghack 的实用程序，旨在使后台进程“停留”在前台。

pidsig 应该是相似的，但代理信号：

```
http://permalink.gmane.org/gmane.comp.sysutils.supervision.general/2010

https://github.com/chexum/pidsig/blob/master/pidsig.c 
```

我相信两者基本上都是等待有背景的孩子的包装器。

# python - django url 参数

> ID：15558880
> 
> 赞同：1
> 
> 时间：2013-03-21T21:50:45.727
> 
> 标签：python, django, url

我想接受带有参数的 GET 请求的 url。就像是：

```
/api/objects/[object_type]/?feature=1 
```

如何配置 url 以接受此类内容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T21:53:26.060

视图开箱即用地支持这一点。要获取您可以执行的参数`request.GET.get('feature')`，在您的示例中将返回 1。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T21:59:34.397

尝试

```
 url(r'^/api/objects/\/?feature=(?P<number>.*)...), 
```

# python - ISBN 最后一位数字查找器

> ID：15558881
> 
> 赞同：0
> 
> 时间：2013-03-21T21:50:54.350
> 
> 标签：python, isbn

我在 python 3 中工作，我正在制作一个程序，该程序将接收一个 10 位的 ISBN 号码，并对其应用一种方法来查找第 11 个号码。

这是我当前的代码

```
ISBN=input('Please enter the 10 digit number: ')

while len(ISBN)!= 10:

    print('Please make sure you have entered a number which is exactly 10 characters long.')
    ISBN=int(input('Please enter the 10 digit number: '))
    continue

else:

    Digit1=int(ISBN[0])*11
    Digit2=int(ISBN[1])*10
    Digit3=int(ISBN[2])*9
    Digit4=int(ISBN[3])*8
    Digit5=int(ISBN[4])*7
    Digit6=int(ISBN[5])*6
    Digit7=int(ISBN[6])*5
    Digit8=int(ISBN[7])*4
    Digit9=int(ISBN[8])*3
    Digit10=int(ISBN[9])*2
    Sum=(Digit1+Digit2+Digit3+Digit4+Digit5+Digit6+Digit7+Digit8+Digit9+Digit10)
    Mod=Sum%11
    Digit11=11-Mod
    if Digit11==10:
       Digit11='X'
    ISBNNumber=str(ISBN)+str(Digit11)
    print('Your 11 digit ISBN Number is ' + ISBNNumber) 
```

我想创建某种循环，以便变量名的“数字”之后的数字从 1 开始增加（如果它使生活更轻松，则为零），方括号中的数字从 0 开始增加，乘法数减少从 11 点到 2 点。

有什么方法可以更有效地执行此代码吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T22:02:46.980

我认为这应该做你想要的。

```
def get_isbn_number(isbn):
    digits = [(11 - i) * num for i, num in enumerate(map(int, list(isbn)))]
    digit_11 = 11 - (sum(digits) % 11)
    if digit_11 == 10:
        digit_11 = 'X'    
    digits.append(digit_11)
    isbn_number = "".join(map(str, digits))
    return isbn_number 
```

**例子**

```
>>> print(get_isbn_number('2345432681'))
22303640281810242428
>>> print(get_isbn_number('2345432680'))
2230364028181024240X 
```

第二行说明：

```
digits = [(11 - i) * num for i, num in enumerate(map(int, list(isbn)))] 
```

可以写成这样：

```
isbn_letters = list(isbn) # turn a string into a list of characters
isbn_numbers = map(int, isbn_letters) # run the function int() on each of the items in the list
digits = [] # empty list to hold the digits
for i, num in enumerate(isbn_numbers): # loop over the numbers - i is a 0 based counter you get for free when using enumerate
    digits.append((11 - i) * num) # If you notice the pattern, if you subtract the counter value (starting at 0) from 11 then you get your desired multiplier 
```

您应该查找以了解代码的单行版本的术语：
[map](http://docs.python.org/2/library/functions.html#map)，
[enumerate](http://docs.python.org/2/library/functions.html#enumerate)，
[list conprehension](http://docs.python.org/2/tutorial/datastructures.html#list-comprehensions)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T21:56:11.267

```
ISBN=int(input('Please enter the 10 digit number: ')) # Ensuring ISBN is an integer

while len(ISBN)!= 10:

    print('Please make sure you have entered a number which is exactly 10 characters long.')
    ISBN=int(input('Please enter the 10 digit number: '))
    continue

else:
    Sum = 0
    for i in range(len(ISBN)):
        Sum += ISBN[i]
    Mod=Sum%11
    Digit11=11-Mod
    if Digit11==10:
       Digit11='X'
    ISBNNumber=str(ISBN)+str(Digit11)
    print('Your 11 digit ISBN Number is ' + ISBNNumber) 
```

# angularjs - 模块内的参考控制器

> ID：15558890
> 
> 赞同：2
> 
> 时间：2013-03-21T21:51:44.847
> 
> 标签：angularjs

我在模块内定义了一个控制器：

```
angular.module('myModule').controller('MyCtrl', function ($scope) {
$scope.property = 'myproperty'; }); 
```

部分包含在主 html 中，如下所示：

```
<div ng-include src="'partial/mypartial.html'"></div> 
```

是否可以在 mypartial.html 中引用 MyCtrl？例如以某种方式是这样的：

```
<div ng-controller="myModule.MyCtrl"> 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T01:10:53.767

给定角度的javascript：

```
angular.module('myModule').controller('MyCtrl', function ($scope) {
  $scope.property = 'myproperty'; }); 
```

您的视图设置应类似于：

```
<html ng-app>
  <head>
  </head>
  <body>
    <div ng-controller="MyCtrl">
      {{property}}
    </div>
  </body>
</html> 
```

上面的代码应该生成：

```
myproperty 
```

# php - 如何使用 Yahoo API PHP 找出 Yahoo 电子邮件地址

> ID：15558897
> 
> 赞同：0
> 
> 时间：2013-03-21T21:52:14.213
> 
> 标签：php, email, sdk, yahoo-api

所以这就是我的困境。

目前使用带有 PHP 的 Yahoo API，以便在我的网站上使用“使用 Yahoo 登录”功能。

我设法检索了我的整个个人资料。麻烦的是，我无法直接显示与该帐户关联的主要电子邮件。

如果我使用`print_r($profile)`，我会从我的个人资料中删除所有内容。它看起来像这样（删除了个人数据）：

```
 stdClass Object ( [uri] => [http://social.yahooapis.com/v1/user/](http://social.yahooapis.com/v1/user/)*********************/profile [guid] =>* ************* [birthdate] => */* [created] => 2010-04-22T20:47:48Z [emails] => Array ( [0] => stdClass Object ( [handle] => ********@gmail.com [id] => 1 [type] => HOME ) [1] => stdClass Object ( [handle] => **********@yahoo.com [id] => 2 [primary] => 1 [type] => HOME ) ) [familyName] => Surname [gender] => M [givenName] => Ricki [image] => stdClass Object ( [height] => 192 [imageUrl] => [http://l.yimg.com/dh/ap/social/profile/profile_b192.png](http://l.yimg.com/dh/ap/social/profile/profile_b192.png) [size] => 192x192 [width] => 192 ) [lang] => en-US [memberSince] => 2010-04-08T11:22:56Z [nickname] => Ricki [profileUrl] => [http://profile.yahoo.com/](http://profile.yahoo.com/)********************* [updated] => 2013-03-03T18:12:22Z [isConnected] => )*** 
```

***但是，使用`$profile->emails->handle`不会产生任何结果。关于做什么的任何想法？我可以使用`$profile->emails`它返回一个数组，简单地显示为“数组”，但是如果我尝试从数组中进行选择，我会收到一个错误：***

 ***“可捕获的致命错误：stdClass 类的对象无法转换为字符串”

任何人？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T21:54:32.650

`$profile->emails[0]->handle`将为您提供系统中的第一个句柄。

你也可以做`foreach($profile->emails as $email) { print $email->handle; }`***

# android - Jquery忽略错误和成功json代码

> ID：15558899
> 
> 赞同：1
> 
> 时间：2013-03-21T21:52:42.357
> 
> 标签：android, jquery, json, cordova

我尝试使用 phonegap 和 android 使用服务。

我使用 localhost 的服务返回带有 chrome 的 json：

```
{
    "GetListaMunicipiosResult": [{
        "MunicipioID": "1",
        "MunicipioNome": "Florianópolis",
        "MunicipioUf":"SC"
    }, {
        "MunicipioID": "2",
        "MunicipioNome": "Jaraguá do Sul",
        "MunicipioUf": "SC"
    }]
} 
```

在我的`.js`文件中，我使用以下代码调用 GET json：

```
$('#cidades_page').live('pageshow',function(event){
    $.ajax("http://10.0.2.2:56976/MunicipiosService.svc/ListaMunicipios",{
        beforeSend: function (xhr) {
        $.mobile.showPageLoadingMsg();
        alert("beforeSend");
        },

        complete: function () {
            // $.mobile.hidePageLoadingMsg();
            alert("complete");
        },
        contentType: "application/json",
        dataType: "jsonp",
        jsonp: "callback",
        type: "GET",
        error: function (xhr, ajaxOptions, thrownError) {
            alert(xhr.status);
            alert(xhr.responseText);
            //alert(thrownError);
        },
        success: function (data) {
            alert(JSON.stringify(data));

        }
    });
}); 
```

但是当页面显示时，只有 alert alert("beforeSend") 触发，并且什么也没发生。

我使用 $.ajax(.... 在 html 中插入 json 调用并使用 chrome 及其工作打开。我不知道还能做什么。

感谢帮助

编辑我在 windows phone 中测试，现在我可以得到错误 Error:GetListaMunicipios 没有被调用。

我的.js：

```
$.ajax("http://localhost:56976/MunicipiosService.svc/ListaMunicipios?callback=?",{
        beforeSend: function (xhr) {
            // $.mobile.showPageLoadingMsg();
        alert('beforeSend');
        },

        complete: function () {
            // $.mobile.hidePageLoadingMsg();
            alert('complete');
        },
        contentType: 'application/json; charset=utf-8',
        dataType: 'jsonp',
        crossDomain: true,
        jsonp: 'callback',
        jsonpCallback:'GetListaMunicipios',
        type: 'GET',
        error: function (xhr, ajaxOptions, thrownError) {
            alert(xhr.status);
            alert(xhr.responseText);
            alert(thrownError);
        },
        success: function (data) {
            alert('success');

        }
    }); 
```

我的 WCF 服务

命名空间 GuiaService {

```
[ServiceContract]

public interface IMunicipiosService
{
    [OperationContract]
    [WebInvoke(Method = "GET",
        ResponseFormat = WebMessageFormat.Json,
        BodyStyle = WebMessageBodyStyle.Wrapped,
        UriTemplate = "ListaMunicipios")]

    List<ClsListaMunicipios> GetListaMunicipios();
} 
```

}

感谢帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T21:58:19.823

您应该使用`done`,`fail`和`always`。

`success`,`error`并且`complete`已被弃用。

更新：如评论中所述，这不适用于您使用它的方式。我现在认为问题是因为您使用`jsonp`的是 as 类型而不是`json`.

`jsonp`设计为在加载时自动调用函数，因此您的服务器应该向生成的代码添加函数调用。jQuery 可能期望这种行为并禁用它自己的回调，或者使用该`jsonp`机制来触发它自己的回调，但是由于您的服务器实际上并没有添加函数调用，所以什么也没有发生。

# c++ - io_service 在 TCP/IP 套接字中的作用 - 需要帮助理解

> ID：15558900
> 
> 赞同：1
> 
> 时间：2013-03-21T21:52:42.767
> 
> 标签：c++, boost-asio

当涉及到 TCP/IP 套接字时，我很难理解 io_service 的作用。这是我对io_service的基本理解。`io_service->run()`阻止并接受工作请求（我们使用）`io_service::work`或`post`工作`dispatch`到`io_service`. 我在这里正确吗？如果我遗漏了什么，请告诉我？现在以下是我的简单服务器代码

```
void RunServer()
{
    boost::shared_ptr< boost::asio::io_service > io_service(new boost::asio::io_service);
    boost::shared_ptr< boost::asio::ip::tcp::acceptor > acceptor(new boost::asio::ip::tcp::acceptor( *io_service ));
    boost::shared_ptr< boost::asio::ip::tcp::socket > sock( new boost::asio::ip::tcp::socket( *io_service ) );

    try
    {
        boost::asio::ip::tcp::resolver resolver( *io_service );
        boost::asio::ip::tcp::resolver::query query( "127.0.0.1", boost::lexical_cast< std::string >( 7777 ));
        boost::asio::ip::tcp::endpoint endpoint = *resolver.resolve( query );
        acceptor->open( endpoint.protocol() );
        acceptor->set_option( boost::asio::ip::tcp::acceptor::reuse_address( false ) );
        acceptor->bind( endpoint );
        acceptor->listen( boost::asio::socket_base::max_connections );
        acceptor->async_accept( *sock, boost::bind( OnAccept, _1, sock ) );//Receives only one connection
        std::cout << "Waiting for incoming connections \n";
        io_service->run();  //Confusion here --- Line A
    }
    catch( std::exception & ex )
    {
        std::cout << "[" << boost::this_thread::get_id()<< "] Exception: " << ex.what() << std::endl;   
    }
} 
```

现在我知道如果 io_service 没有附加工作对象，该方法`io_service->run()`将永远不会阻塞，对吗？现在我的问题是上面扮演了什么角色`io_service->run()`。从实验中我意识到，如果我删除代码，`OnAccept`则不会调用该方法。还有工作在哪里被添加到`io_service`这里。这里到底发生了什么？任何澄清这一点的解释将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T22:37:13.370

首先，您的简单服务器代码看起来不错。An`io_service`就是这样，它服务于 I/O 操作。研究 Asio[解剖结构](http://www.boost.org/doc/libs/1_53_0/doc/html/boost_asio/overview/core/basics.html)有助于更好地理解其在异步操作中的作用

![异步连接](../Images/d3cb5472a1609ea3ed070cbe6746b33b.png)

您不需要一个[`io_service::work`](http://www.boost.org/doc/libs/1_53_0/doc/html/boost_asio/reference/io_service__work.html)对象来防止`io_service::run()`立即返回。在您的情况下，您已经`io_service`完成了与 相关的工作`async_accept()`，并且可能更多的工作`OnAccept()`与另一个`async_accept()`电话有关。

对于关于 SO 的类似问题，还有其他几个有用的[答案，您可能会觉得有帮助。](https://stackoverflow.com/a/5291002/283302)

# c++ - C++ std条件变量覆盖了很多共享变量

> ID：15558902
> 
> 赞同：0
> 
> 时间：2013-03-21T21:52:49.013
> 
> 标签：c++, multithreading, variables, conditional

我正在用 C++ 编写一个多线程程序，在我的主线程中，我正在等待其他线程将包放入不同的队列中。取决于包的种类和它们来自哪个线程。

队列应该受到互斥锁的保护。

但在我的主要我不想做：

```
while(true)
if(!queue1->empty)
{
     do stuff
}
if(!queue2->empty)
{
     do stuff
}
etc 
```

因此，您需要使用条件变量来向 main 发出信号表明某些事情发生了变化。现在我只能阻塞 1 个条件变量，所以我需要所有这些线程使用相同的条件变量和附带的互斥锁。现在我不想真正使用这个互斥锁来锁定我所有的线程。这并不意味着当一个线程写入队列时，另一个线程不能写入完全不同的队列。所以我为每个队列使用单独的互斥锁。但是现在我如何使用条件变量附带的这个额外的互斥锁。

它是如何使用 boost 完成 2 个线程和 1 个队列的，与 std 非常相似。 [http://www.justsoftwaresolutions.co.uk/threading/implementing-a-thread-safe-queue-using-condition-variables.html](http://www.justsoftwaresolutions.co.uk/threading/implementing-a-thread-safe-queue-using-condition-variables.html)：

```
template<typename Data>
class concurrent_queue
{
    private:
    boost::condition_variable the_condition_variable;  
    public:
    void wait_for_data()
    {
        boost::mutex::scoped_lock lock(the_mutex);
        while(the_queue.empty())
        {
             the_condition_variable.wait(lock);
        }
    }
    void push(Data const& data)
    {
         boost::mutex::scoped_lock lock(the_mutex);
         bool const was_empty=the_queue.empty();
         the_queue.push(data);
         if(was_empty)
         {
             the_condition_variable.notify_one();
         }
     }
     // rest as before
 }; 
```

那么你如何解决这个问题呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T23:27:37.160

我想说你问题的关键在这里：

`Now I dont want to really use this mutex to lock all my threads. It doesn't mean that when 1 thread is writing to a queue, another cant write to a totally different queue. So I use seperate mutexes for each queue.`

为什么？因为：

`... packages come in relatively slow. And queues are empty most of the time`

在我看来，您将自己设计到了一个角落，因为您认为您需要某些东西，而实际上您可能不需要它，因为一个队列实际上可以在您提到的使用场景中工作。

我会说从一个队列开始，看看它能让你走多远。然后，当您遇到一个限制时，您确实有许多线程在一个互斥体上等待，您将获得有关该问题的更多信息，因此能够更好地解决它。

从本质上讲，我会说您面临此问题的原因是过早的设计优化，而解决该问题的方法是立即回溯并更改设计。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T22:04:46.867

创建一个包含所有在其中工作的队列的顶级（可能是循环的）队列。

*该*队列可以由单个互斥体保护，并且具有一个 condvar，仅当它从空变为非空时才需要发出信号。

*现在，您的各个队列都可以有自己的互斥体，并且当它们*从空变为非空时，它们只需要接触共享/顶级队列（及其互斥体） 。

一些细节将取决于您是否希望您的线程依次只从每个非空队列中获取最前面的项目，或者按顺序消耗每个整个队列，但想法就在那里。

* * *

> 从非空到非空（但增加了大小）也应该传递到顶级队列？

正如我所说，这取决于你如何消费它们。如果每次队列中有*东西*时，您都这样做：

1.  （你已经拥有了顶级锁，这就是你知道这个队列中有东西的方式）
2.  锁定队列
3.  将队列内容与本地工作副本交换
4.  从顶级队列中删除队列
5.  解锁队列

*那么工作队列要么*总是非空的，因此在顶级队列中，*要么*是空的，因此不在队列中。

如果您*不*这样做，而只是从每个非空队列中拉出最前面的元素，那么您需要考虑更多的状态。

* * *

请注意，如果

> ... 包裹进来相对较慢。而且队列大部分时间都是空的

你可能只有*一个*队列，因为没有足够的活动来引起很多争用。这极大地简化了事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-26T02:50:35.650

@Carleeto 和@Useless 都给出了很好的答案。您只有一个消费者，因此单个队列将为您提供*最佳*性能。您无法获得比不断工作的单个使用者更高的吞吐量，因此您的目标应该是最小化单个*使用者*的锁定开销，而不是生产者。为此，您可以让生产者使用单个互斥锁等待单个条件变量（指示队列非空）。

以下是如何执行参数多态性。完全类型安全，无强制转换，父类中只有一个虚函数：

```
class ParentType {
public:
  virtual void do_work(...[params]...)=0;
  virtual ~ParentType() {}
};

class ChildType1 : public ParentType {
private:
  // all my private variables and functions
public:
  virtual void do_work(...[params]...) {
    // call private functions and use private variables from ChildType1
  }
};

class ChildType2: public ParentType {
private:
  // completely different private variables and functions
public:
  virtual void do-work(...[params]...) {
    // call private functions and use private variables from ChildType2
  }
}; 
```

# ruby-on-rails - RoR Facebook Canvas 应用程序用户注册和登录

> ID：15558911
> 
> 赞同：3
> 
> 时间：2013-03-21T21:53:10.637
> 
> 标签：ruby-on-rails, facebook, canvas

我目前正在开发一个只能在 Facebook Canvas 内使用的 RoR 应用程序。我使用 Devise 对用户进行建模。现在，我的目标是让注册和登录过程变得简单。如果我的潜在用户打开该应用程序，应提示他/她授权该应用程序访问姓名和电子邮件。如果发生这种情况，应使用名称、fb_uid 和电子邮件创建用户。每次该用户现在返回到画布应用程序时，他都应该登录。我该如何完成呢？请帮忙 - 查看考拉、omniauth、javascript 和 php sdks -> 我的大脑感觉很煎熬......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T01:06:09.053

这个 railscasts 剧集向您展示了如何使用 omniauth-facebook 轻松组合身份验证系统。实际上我今天也刚刚使用它。如果您有任何更具体的问题，请告诉我。

[http://railscasts.com/episodes/360-facebook-authentication](http://railscasts.com/episodes/360-facebook-authentication)

# c# - 从while条件中返回一个变量

> ID：15558917
> 
> 赞同：-1
> 
> 时间：2013-03-21T21:53:24.710
> 
> 标签：c#, sql, ms-access

我想从这个方法中返回一个变量。是的，我确实将其设为静态字符串。并试图返回 Messagebox.Show 所在的变量。我什至有一个相等的变量并试图返回它。但我似乎无法从 while 括号内返回。而且我无法让括号外的变量返回。该怎么办？该代码使用 MessageBox 工作，但我需要字符串变量。

```
static void rsnREAD(string dbTbl)
    {
        OleDbConnection machStopDB = new OleDbConnection("Provider=Microsoft.ACE.OLEDB.12.0;Data Source=" + @"C:\Users\sgarner\Google Drive\Visual Studio 2012\Write_to_db\Write_to_db\Machine_Stop.accdb");
        //string sDate;
        //sDate = DateTime.Now.ToString("MM/dd/yyy HH:mm:ss");
        string str = "SELECT LAST(REASON) AS lastREASON FROM "+dbTbl+"";
        OleDbCommand rdCmd = new OleDbCommand(str, machStopDB);
        try
        {
            machStopDB.Open();
            OleDbDataReader reader = rdCmd.ExecuteReader();
            while (reader.Read())
            {
                MessageBox.Show(reader[0].ToString());
            }
            reader.Close();
        }
        catch (Exception ex)
        {
            MessageBox.Show(ex.Message);
        }
        finally
        {
            machStopDB.Close();
        }
        machStopDB.Close();
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T21:56:31.307

只需`String`在 try 块之外创建变量并在从数据库中读取值时设置它。还将方法的返回类型更改为，`string`而不是`void`. 您可以使用`if`代替，`while`因为您只从数据库中读取一个值。

```
static string rsnREAD(string dbTbl)
    {
      string result = string.Empty;
      using(var machStopDB = new OleDbConnection("Provider=Microsoft.ACE.OLEDB.12.0;Data Source=" + @"C:\Users\sgarner\Google Drive\Visual Studio 2012\Write_to_db\Write_to_db\Machine_Stop.accdb");
      {
        string str = "SELECT LAST(REASON) AS lastREASON FROM "+dbTbl+"";
        OleDbCommand rdCmd = new OleDbCommand(str, machStopDB);
        try
        {
          machStopDB.Open();
          using(var reader = rdCmd.ExecuteReader())
          {
            if(reader.Read())
            {
                result = reader[0].ToString();
            }
          }
        }
        catch (Exception ex) // Sample only. Catch only ones you need.
        {
            MessageBox.Show(ex.Message);
        }
      }
      return result;
    } 
```

因此，如果返回值为空字符串，则数据库为空或出现错误。

# ruby-on-rails - ActiveRecord 限制（7） - 应该总是拉 7

> ID：15558919
> 
> 赞同：0
> 
> 时间：2013-03-21T21:53:28.720
> 
> 标签：ruby-on-rails, ruby, activerecord, rails-activerecord

我有以下rails查询：

```
@related_products = @taxon.products.offset(rand(Spree::Product.count)).limit(7) 
```

有时它会输出 7，有时它会输出更少，但是当它输出更少时，它会弄乱样式。无论如何让它总是输出7并且只输出7？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T22:16:07.960

那是因为您选择的偏移量可能与最后一条记录的距离小于 7。而是强制偏移量在最大值以下 7 处达到最大值：

```
 @related_products = @taxon.products.offset(rand(Spree::Product.count - 7)).limit(7) 
```

# c# - 添加 JSON 调用后在 MVC 部分视图中呈现 DataTables.net 的问题

> ID：15558922
> 
> 赞同：1
> 
> 时间：2013-03-21T21:53:44.320
> 
> 标签：c#, javascript, jquery, asp.net-mvc, json

我正在尝试为我的项目使用数据表和 jeditable 在屏幕上呈现可编辑的表。这显示在索引调用的局部视图中。但是，当我尝试加载它时，它会在屏幕上显示页面的 html 而不是渲染它。有人可以告诉我我做错了什么来解决这个问题吗？

这是我的部分观点：

```
<script type="text/javascript"  src="../../Scripts/jquery-1.9.1.js"></script>
<script type="text/javascript"  src="../../Scripts/FixedColumns.min.js"></script>
<script type="text/javascript" src="../../Scripts/jquery.dataTables.js"></script>
<script type ="text/javascript" src="../../Scripts/jquery.jeditable.mini.js"></script>
<script type="text/javascript" charset="utf-8">
$(document).ready(function () {
    var oTable1 = $('#myDataTable').dataTable({
        "bServerSide": true,
        "sAjaxSource": '/Home/PartialView',
        "fnDrawCallback": function () {
            $('#myDataTable tbody td:nth-child(2)').editable('/Home/Write/', {
                "callback": function (sValue, y) {
                    oTable1.fnDraw();
                },

            });
        }
    });
})
</script>
<table id ="myDataTable" class="display">
    <thead>
        <tr>
            <th>Analysis ID</th>
            <th>Name</th>
            <th>Time</th>
            <th>Sample Type</th>
            <th>Grade</th>
            <th>Product ID</th>

    </thead>
    <tbody>
    </tbody>
</table> 
```

调用我的索引中的部分视图：

```
 @if(ViewBag.SearchKey != null)
  {

     @Html.Action("PartialAnalysis", "Home", (string)ViewBag.SearchKey)

     {Html.RenderAction("PartialView", "Home", (string)ViewBag.SearchKey);}

   } 
```

我的控制器：

```
public ActionResult PartialView(jQueryDataTableParamModel param, string Search)
    {
        PartialModel D = new PartialModel();
        IEnumerable<PartialModel> model = D.SlagList;
        D.ViewDataPull(Search);

        return Json(new
        {
            sEcho = param.sEcho,
            iTotalRecords = D.List.Count(),
            iTotalDisplayRecords = D.List.Count(),
            aaData = D.List
        },
        JsonRequestBehavior.AllowGet);
    } 
```

# javascript - 以编程方式重新加载 SVG 文件

> ID：15558923
> 
> 赞同：2
> 
> 时间：2013-03-21T21:53:45.660
> 
> 标签：javascript, jquery, svg, browser-cache

我有一个 Javascript/jQuery 函数，它创建/覆盖一个 SVG 文件，该文件嵌入在 Web 应用程序的页面中。我确保每次调用此函数时都会更新 SVG 文件，但在某些情况下（我不确定何时），SVG 文件似乎缓存在 Web 浏览器中，并且没有显示为已更新。每次调用此函数时，确保使用新内容呈现 SVG 文件的最佳方法是什么？

# serialization - 在backbone.js 中$.ajax 类型put 和model.save 之间的区别？

> ID：15558927
> 
> 赞同：1
> 
> 时间：2013-03-21T21:54:01.283
> 
> 标签：serialization, backbone.js, asp.net-mvc-4, asp.net-web-api

使用 this.model.save() 保存模型和使用 jquery ajax 类型 PUT 之间似乎存在一些差异？

我的 api 控制器中有以下方法

```
public void Put(string id, [FromBody]IContent value) {
    // save
} 
```

我还在 JSON 格式化程序序列化程序设置上启用了 TypeNameHandling，如下所示：

```
config.Formatters.JsonFormatter.SerializerSettings.TypeNameHandling = TypeNameHandling.Auto; 
```

如果我像这样使用 jquery ajax 放置一些数据

```
$.ajax({  
    url: "/api/page/articles/1",  
    type: "PUT",  
    dataType: "json",  
    contentType: "application/json",
    data: JSON.stringify({"$type": "BrickPile.Samples.Models.Article,BrickPile.Samples","id": "articles/1", "heading": "Some heading..." })
}); 
```

我的对象在 put 方法中绑定正确，但是当我尝试在主干中使用 model.save() 保存对象时，输入值为 null 并且无法绑定对象？

我就是这样做的：

```
this.model.set({ heading: 'foo' });
this.model.save(); 
```

请求标头看起来不错，并且有效负载似乎是 JSON，至少如果我查看萤火虫的话。也可以使用具有相同有效负载的提琴手将一些数据放入我的 api，但如果我从 firebug 复制有效负载源，请参阅：[http ://cl.ly/Nked](http://cl.ly/Nked)

谁能解释我在这里做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T06:20:39.730

如果不了解更多关于您的模型实现的信息，就很难确定。从您的萤火虫屏幕截图中我可以看到的一件事是，正在传递 id 属性，因为`"articles/1"`这对于标准 Backbone 来说是不寻常的。如果您要保存模型对象，则 id 通常为`"1"`. 所以 a`model.save()`会生成一个 HTTP PUT`articles/1`并将 json 作为包括`{"id":"1", ... }`. [Backbone.sync](http://backbonejs.org/#Sync "骨干网同步")文档有更多关于默认行为的详细信息。

# oracle - 如何将参数传递给在 sqlplus 中使用 START 调用的 sql 文件中的 PL/SQL 块？

> ID：15558929
> 
> 赞同：1
> 
> 时间：2013-03-21T21:54:06.777
> 
> 标签：oracle, plsql, sqlplus

我有一个通过 sqlplus 运行多个 sql 文件的 bash 脚本：

```
sqlplus $connectioninfo << end
start file1.sql
start file2.sql
start file3.sql $variable
quit
end 
```

file3 有一些 PL/SQL：

```
BEGIN

  DBMS_OUTPUT.PUT_LINE(&1);

END;
/ 
```

但它只是打印文字`"&1"`而不是`$variable`. 我还在file3中尝试了以下内容：

```
DEFINE var_a = &1;
BEGIN

  DBMS_OUTPUT.PUT_LINE(var_a);

END;
/ 
```

还有以下内容：

```
DECLARE
  var_b VARCHAR2(64) := &1;

BEGIN

  DBMS_OUTPUT.PUT_LINE(var_b);

END;
/ 
```

最后：

```
DEFINE var_a = &1;

DECLARE
  var_b VARCHAR2(64) := var_a;

BEGIN

  DBMS_OUTPUT.PUT_LINE(var_b);

END;
/ 
```

但是，我收到了各种错误，或者只是所有这些错误的文字值“&1”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T22:24:00.713

尝试添加`SET DEFINE ON`到脚本的开头`file3.sql`。

如果`SET DEFINE`是`ON`，SQL*Plus 将`&...`用它们的值替换替换参数。如果`SET DEFINE`是`OFF`（它似乎适合您），SQL*Plus 不会这样做。

# sql - SQL Server 标量函数返回 VARCHAR 被截断

> ID：15558932
> 
> 赞同：0
> 
> 时间：2013-03-21T21:54:23.873
> 
> 标签：sql, sql-server, concat

我在 SQL Server 2008 R2 中创建了一个返回 varchar (4000) 的标量函数。此 varchar (4000) 是连接表的多行和多列的结果。我将在选择报告源中使用此功能。详细信息是具有特定销售数量和价格的产品。

当我使用 select 功能时会出现问题。结果被截断。他要返回 13 行，只返回 5。如果我在 sql management studio 函数中使用 print 命令返回 13 行。

函数如何返回正确的数字行？

```
print dbo.fnReturnProducts ('{25899A98-5E68-E641-8C9D-7F341F17F2EF}')  -- returns 13 lines
select dbo.fnReturnProducts ('{25899A98-5E68-E641-8C9D-7F341F17F2EF}') -- returns 5 lines

alter function [dbo].[fnReturnProducts](@OrderId uniqueidentifier) returns varchar(4000)
begin 

declare @Products as varchar(4000)
declare @ProductName as varchar(43)
declare @ProductOrder as varchar(3)
declare @Quantity varchar(30)
declare @UnitPrice varchar(30)
declare @TotalPrice varchar(30)

select @Products = ''

DECLARE aux_cursor CURSOR FOR 
select
    ProductName as ProductName,
    dbo.FormatNumber (ProductOrder, 0, '(', 0) as ProductOrder,
    dbo.FormatNumber (Quantity, 2, '', 0) as Quantity,
    dbo.FormatNumber (UnitPrice , 2, '$', 0) as UnitPrice,
    dbo.FormatNumber (Quantity * UnitPrice, 2, '$', 0) as TotalPrice    
from    vwOrderDetails
Where OrderId = @OrderId
order BY vwOrderDetails.ProductOrder

OPEN aux_cursor
FETCH NEXT FROM aux_cursor 
INTO 
    @ProductName,
    @ProductOrder,
    @Quantity,
    @UnitPrice,
    @TotalPrice

WHILE @@FETCH_STATUS = 0
BEGIN
    if len(@Products) > 0 
    begin
        select @Products = @Products + char(10)
    end 
    select @Products = @Products +  '(' + @ProductOrder + ') ' + @Quantity + ' - ' + @ProductName  + ' a ' + @UnitPrice + ' = ' + @TotalPrice

   FETCH NEXT FROM aux_cursor 
   INTO 
    @ProductName,
    @ProductOrder,
    @Quantity,
    @UnitPrice,
    @TotalPrice

END

CLOSE aux_cursor
DEALLOCATE aux_cursor

RETURN @Products

end

go 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T22:15:47.193

尝试这个：

```
select dbo.fnReturnProducts ('{25899A98-5E68-E641-8C9D-7F341F17F2EF}')  into #tablename
select * from #tablename 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T12:10:23.313

这不是答案，而是 SSMS（和应用程序）的结果。查看区别：仅打印和选择命令。在应用程序中，我使用 select （我的问题）。

```
print dbo.fnReturnProducts ('{25899A98-5E68-E641-8C9D-7F341F17F2EF}')  -- returns 13 lines

(1) 1.00 - MAC INST PARATI GAL/CAIPIRA 85GR            a $.75 = $.75
(2) 1.00 - MAC INST PARATI CAR/LEG.85GR                a $.75 = $.75
(3) 1.00 - MAC INST PARATI GAL/CAIPIRA 85GR            a $.75 = $.75
(4) 1.00 - TRINK TANGERINA 35GR                        a $.69 = $.69
(5) 1.00 - TRINK TANGERINA 35GR                        a $.69 = $.69
(6) 1.00 - MAC ORSI BAM.OVOS PARAFUSO 500GR            a $1.56 = $1.56
(7) 1.00 - MAC INST PARATI CAR/LEG.85GR                a $.75 = $.75
(8) 1.00 - ORSI ACHOC PO 400GR                         a $2.16 = $2.16
(9) 1.00 - ORSI ACHOC PO 400GR                         a $2.16 = $2.16
(10) 1.00 - BISC.PANCO ROSQ NATA 500G                   a $3.53 = $3.53
(11) 1.00 - ST PROTEX ERVA DOCE 90GR                    a $1.76 = $1.76
(12) 1.00 - OLEO SOJA CORCOVADO 900ML               UN  a $3.59 = $3.59
(13) 1.00 - OLEO SOJA CORCOVADO 900ML               UN  a $3.59 = $3.59

select dbo.fnReturnProducts ('{25899A98-5E68-E641-8C9D-7F341F17F2EF}') -- returns 5 lines

(1) 1.00 - MAC INST PARATI GAL/CAIPIRA 85GR            a $.75 = $.75
(2) 1.00 - MAC INST PARATI CAR/LEG.85GR                a $.75 = $.75
(3) 1.00 - MAC INST PARATI GAL/CAIPIRA 85GR            a $.75 = $.75
(4) 1.00 - TRINK TANGERINA 35GR 
```

# php - 向 HTML 页面添加可重复使用的导航菜单

> ID：15558938
> 
> 赞同：-1
> 
> 时间：2013-03-21T21:54:33.570
> 
> 标签：php, javascript, include, client-side, server-side

目前，我的网站使用静态手写 HTML 页面。我手动将导航菜单添加到所有页面。我希望能够维护一个包含菜单 HTML 代码的单个用户资源文件，并从网站上的所有其他 HTML 文件中引用该文件。我知道我们可以使用服务器端包含和客户端包含来做到这一点。但是在阅读了每种方法的优缺点之后，我对我应该使用哪种方法来适应我的情况感到困惑。

PS 我的服务器不是 PHP 服务器。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T22:11:02.577

平面 HTML 文件不能相互包含。您必须使用一种或另一种服务器端脚本语言。

您的服务器是 Apache (Linux) 的某种风格吗？如果是，它可能会启用 php。请咨询您的托管服务提供商。

不管怎样，经验法则如下（适用于任何后端框架，但详细与 php 相关）：

1) 在一个 HTML 页面上编码你的导航

2) 将其保存为 php 文件（或按照服务器端的程序进行操作——从现在开始，我继续假设您将使用 php）

3) 将所有页面保存为 .php，以便能够包含新的可重用元素

4) 用 php include 语句替换所有页面中的导航部分 HTML，包括您的导航文件，例如 nav.php 例如，

```
 include( $path . 'nav.php') 
```

5）如果您希望包括“you-are-here”突出显示，a）在所有页面的 body 标签上设置一个 id b）在您包含的 nav.php 中的每个链接上设置一个 id

6) 在您的 CSS 中，列出所有可能的页面 ID 和导航链接 ID 组合，例如

```
 #homepage #homeLink, 
  #contactPage #contactLink,
  #aboutPage #aboutLink {

  /* format your "active" nav link here */

  } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T22:02:42.563

最后，您希望网站加载速度更快且易于维护。如果您使用客户端 javascript 来执行 AJAX 以获取模块/小部件，那么您将添加更多 http 请求，并且该站点将明显变慢。使用服务器组装页面是可行的，但是您会失去 javascript 动画和 AJAX 的优势。服务器和客户端的混合可能会令人困惑，但可能是最佳的。如果您的服务器是 Node.JS，那么您将拥有巨大的优势，因为可以将服务器上的相同功能配置为适用于客户端。

例如，您可以使用服务器来组装导航栏作为索引文件的一部分，并使用客户端在用户通过 ajax 登录后加载更新的导航栏等内容。可以在 Node 和浏览器中使用相同的功能 - 例如，jQuery 或 YUI 在 node.js 中可用。

所以这真的取决于你的服务器，以及你想做多少工作。

到目前为止，我能给你的最简单、最快捷的解决方案是使用服务器端模板。不知道你的服务器，使用 jQuery 和 load 方法对于客户端模板加载很有用。

[http://docs.jquery.com/Ajax/load](http://docs.jquery.com/Ajax/load)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-21T22:20:35.330

或者，您可以使用 Jquery 的 .load() 函数将另一个文本文件加载到导航中（如果在 txt 文件中使用 html 标记，它将加载为 html），但如果用户禁用了 JavaScript，这将无用。

请参阅下面的 Jquery 文档链接

[http://api.jquery.com/load/](http://api.jquery.com/load/)

# iis - IIS 7.5 URL 重定向直接链接到媒体页面

> ID：15558942
> 
> 赞同：0
> 
> 时间：2013-03-21T21:54:43.327
> 
> 标签：iis, redirect, url-rewriting, mp3, jplayer

我认为我的实施没有通过，现在我被卡住了。我正在使用 IIS 7.5、URL 重写 2.0 和 Jplayer。

我目前的实现是让用户将音频文件上传到我的服务器。要收听这些音频文件，用户将获得一个直接链接，可以在浏览器中播放或通过 Android/iOS 在应用媒体播放器中播放。

现在我创建了一个登陆页面，我想将那些直接链接到音频文件的用户重定向到该页面。登陆页面使用 Jplayer。

问题是我必须使用音频文件的直接链接来让 jplayer 播放它。由于我正在重定向直接链接，因此无法加载媒体网址。

这也成为一个问题，因为我的 Android 和 iOS 应用程序直接链接到 .mp3 以便在其 AV 播放器中播放文件。有没有办法解决？有更好的实现吗？不知道此时该做什么。

播放器：

```
 $("#jquery_jplayer_1").jPlayer({
    ready: function (event) {
        $(this).jPlayer("setMedia", {
            mp3: "http://192.168.0.28/flows/t/test/test1334187052069.mp3"
        }).jPlayer("play"); // auto play;
    },
    swfPath: "js",
    supplied: "mp3",
    errorAlerts: true,
    warningAlerts: true,
    wmode: "window"
}); 
```

IIS 7.5 重定向规则：

```
<rewrite>
    <rules>
        <rule name="FlowURLs">
            <match url="^flows/[_0-9a-zA-Z-]+/[_0-9a-zA-Z-]+/([._0-9a-zA-Z-]+)" />
            <action type="Redirect" redirectType="Found" url="music.html?flow={R:1}" />
        </rule>
    </rules>
</rewrite> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T08:49:11.080

一种可能的解决方案可能是检查 HTTP 接受标头并查看它是否是期望加载页面的浏览器。如果是这样，那么您将重定向到您的播放器登录页面。否则，您将请求保持原样并让它直接加载音频文件。

您可以使用条件检查接受标头：

```
<rewrite>
    <rules>
        <rule name="FlowURLs">
            <match url="^flows/[_0-9a-zA-Z-]+/[_0-9a-zA-Z-]+/([._0-9a-zA-Z-]+)" />
            <conditions>
                <add input="{HTTP_ACCEPT}" pattern="text/html" />
            </conditions>
            <action type="Redirect" redirectType="Found" url="music.html?flow={R:1}" />
        </rule>
    </rules>
</rewrite> 
```

# wpf - WPF中的问号标签

> ID：15558943
> 
> 赞同：0
> 
> 时间：2013-03-21T21:54:46.150
> 
> 标签：wpf, xaml

一段时间以来，我一直在努力寻找这个问题的答案。

这个标签在 WPF 中有什么用？

```
<?  ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T22:20:34.507

`<? ?>`是一个称为 的接口[`Processing Instruction`](http://msdn.microsoft.com/en-us/library/ms256173.aspx)。

它被用作在`XML`文档文本中保留特定于处理器的信息的一种方式。

根据[Mozilla 开发者网络 (MDN)](https://developer.mozilla.org/en-US/docs/DOM/ProcessingInstruction)

> 处理指令为特定于应用程序的指令提供了嵌入 XML 中的机会，并且可以被不支持处理其指令的 XML 处理器忽略（除了它们在 DOM 中的位置之外）。

# javascript - 在 ember.js 中处理表单提交和保存记录的逻辑应该位于哪一层？

> ID：15558944
> 
> 赞同：1
> 
> 时间：2013-03-21T21:54:49.223
> 
> 标签：javascript, model-view-controller, ember.js

在使用 rails-api、ember.js(rc-1.0) 和 ember-data 几个小时后，我取得了不错的进展。但是，我正处于十字路口，需要一些建议。如果我有一个用于创建或更新记录的表单，那么应该在哪里处理该表单的提交操作并使用 ember-data 进行持久化。

我已经看到在路由器、视图和控制器中处理它的示例。我想我还没有清楚地了解什么属于哪里，尤其是当涉及到视图时。视图是否应该处理提交操作并委托给控制器，而控制器又处理模型？视图似乎大多是可选的，也许我根本不需要，如果不涉及视图，可以将权限委托给控制器。

非常感谢您对每个人的职责以及您的首选方法的任何其他想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T00:40:16.533

如果您使用的是 HTML`<form>`元素，则需要`submit`在视图中捕获事件。您可能希望视图只告诉控制器保存模型。

另一种选择是做这样的事情：

节省

不利的一面是，您无法获得捕捉`submit`事件提供的一些好处：

*   HTML 表单在您按下时提交`ENTER`
*   如果不满足验证/限制条件，HTML5 表单将不会提交

# sql-server-2008 - 子系统上下文的数据库设计 - KVP 与列

> ID：15558950
> 
> 赞同：1
> 
> 时间：2013-03-21T21:55:01.207
> 
> 标签：sql-server-2008, database-design

在复杂系统中，具有与多个实体相关的通用子系统是否很常见。一个例子可能是一个工作流引擎，其中一个申请、工作和评估可能都有自己的工作流。

有些甚至可能有 >1 链接到子系统，例如表单引擎，其中用户可能有个人详细信息表单和员工历史表单。

您甚至可以将日志记录视为一个子系统，其中一个实体可以有多个日志记录。

有几种方法可以模拟这种“上下文”，一种是使用 KVP 样式：

CREATE TABLE Workflows (WorkflowID, ContextObject varchar(20), ContextKey int )，其中 ContextObject 将包含“Job”、“User”、“Assessment”，而 ContextKey 可以是 JobID、UserID、AssessmentID 等。

另一种方法是使用具有可空列的更宽的表，例如，

CREATE TABLE 工作流（WorkflowID、JobID INT NULL、UserID INT NULL、AssessmentID INT NULL）

上下文键是互斥的。

我想知道从性能的角度来看哪种方法“更好”，尤其是当行数增加到数十万到数百万时？

KVP 样式表将以更窄的行（更大的表）结束，而可空列方法具有更宽的行，但是可以在这些行上构建单独的索引。使用 SQL Server，我们可以使用 Filtered Indexes 为每个上下文创建一个索引，其中 contextID 不为空。

使用 nullable-column 方法会为优化器提供更好的统计信息 - 即，如果它是基于 JobID 的连接，那么优化器将知道该表中的 100 万行中，只有 10,000 行与 jobID 相关。

我想知道人们对这两种不同方法的想法是什么。

假设每个上下文都提供了相当高的基数（每个上下文类型几乎为 1）。还假设 SQL Server 的最新版本。

# c# - 如何实现 BigRational 幂方法

> ID：15558951
> 
> 赞同：3
> 
> 时间：2013-03-21T21:55:03.753
> 
> 标签：c#, numerics

我正在使用 的 BCL Codeplex 实现`BigRational`，但是它似乎没有可以采用两个的 Pow 方法`BigRational`，只有一个采用 a`BigRational`和 a的 Pow 方法`BigInteger`。我会自己写一个，但我不知道从哪里开始。编辑：一些代码：

```
 public static BigRational Pow(BigRational baseVal, BigRational exponent, int inputPrecision)
    {
        if (exponent == 0)
        {
            return BigRational.One;
        }
        if (exponent == 1)
        {
            return baseVal;
        }
        if (exponent.GetWholePart() == exponent)
        {
            return Pow(baseVal, exponent.GetWholePart());
        }
        baseVal = Round(baseVal, inputPrecision); //custom rounding method
        exponent = Round(exponent, inputPrecision); 
        BigInteger exponentWhole = exponent.GetWholePart();
        BigRational extra = exponent - exponentWhole;
        return //what?
    } 
```

# xcode - Xcode 项目模板：将文件添加到项目组

> ID：15558953
> 
> 赞同：7
> 
> 时间：2013-03-21T21:55:13.657
> 
> 标签：xcode, xcode-template

如何让我的自定义 Xcode 项目模板添加一个文件，例如，`README.md`到项目组（在项目导航器中）？

以下步骤将`README.md`文件放在根项目目录（在文件系统上）但在以目标命名的组中。如何将其添加到项目组？

1.  添加`README.md`到项目模板的根目录。

2.  将以下键值对添加到`TemplateInfo.plist`.

    ```
    <key>Definitions</key>
    <dict>
        <key>../README.md</key>
        <dict>
            <key>Path</key>
            <string>README.md</string>
            <key>TargetIndices</key>
            <array/>
        </dict>
    </dict> 
    ```

    和

    ```
    <key>Nodes</key>
    <array>
        <string>../README.md</string>
    </array> 
    ```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-06-27T11:01:22.883

1.  您可以将 README.md 文件放入 Project template/FolderName
2.  在 TemplateInfo.plist 中添加定义

    ```
    <key>FolderName/README.md</key>
    <dict>
        <key>Path</key>
        <string>FolderName/README.md</string>
        <key>Group</key>
        <array>
            <string>FolderName</string>
        </array>
    </dict> 
    ```

和

3.  添加节点

    ```
    <string>FolderName/README.md</string> 
    ```

# nsarray - 通过随机 NSArray Objective C 反向枚举

> ID：15558955
> 
> 赞同：0
> 
> 时间：2013-03-21T21:55:32.543
> 
> 标签：nsarray, enumeration

我目前正在制作一个从数组播放视频的应用程序。我已经将数组连接到随机发生器，这样当用户点击“下一步”按钮时，随机选择数组中的视频。下一个按钮工作正常，但我正在努力的是后退按钮。我希望用户能够通过点击“返回”按钮返回到上一个视频。我研究了几种方法来做到这一点，但都没有奏效。如果有人可以看看我下面的代码并给我一些建议，那将不胜感激！请注意，我只从数组中选择了 1 个索引以节省空间。另外，我知道还有其他几篇关于反向枚举的帖子，就像我说的，没有一个能给我带来成功。如果做了大量的研究，这是我最后的手段。

```
@implementation MajesticViewController

@synthesize arrayName = _arrayName;

- (void)viewDidLoad
{

[super viewDidLoad];

//Heres the array containing the videos

_arrayName = [NSArray arrayWithObjects:

// video 0- losing you

@"<iframe width=\"279\" height=\"199\" src=\"http://www.youtube.com/embed/YjvRydejkYY\" frameborder=\"0\" allowfullscreen></iframe>", @"<iframe width=\"279\" height=\"199\" src=\"http://www.youtube.com/embed/nosOsDG38nQ?rel=0\" frameborder=\"0\" allowfullscreen></iframe>", nil];    

[self pickSong:_arrayName];

}

//This is the next button

-(IBAction)newSongButton:(id)sender
{

[self pickSong:_arrayName];

}

//This randomly picks the next video

-(void)pickSong:(NSArray *)arrayName

{

int r = arc4random() % 47;

//int r = 46; /////tester

if (r==0)

{

NSString *randomResponse = [arrayName objectAtIndex:0];

[[self myWebView] loadHTMLString:randomResponse baseURL:nil];     

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T03:18:26.363

如果您需要返回，只需创建一个跟踪前一个对象的 ivar 或属性。如果需要更多，请使用数组创建一个简单的堆栈，该堆栈跟踪 x 个先前对象。您可以使用 indexOfObject 在新的排序/随机数组中找到它们

# shell - 命令行中的多线程可能吗？

> ID：15558956
> 
> 赞同：0
> 
> 时间：2013-03-21T21:55:33.380
> 
> 标签：shell, command-line, ssh, command

我正在使用以下命令从文本文件中的域列表中检查 whois 信息，然后将包含电子邮件的任何行输出到新文件：

```
for i in $(cat testdomains.txt); do whois $i| egrep [a-zA-Z0-9]@[a-zA-Z0-9]\.[a-zA-Z0-9]; done >> results.txt 
```

有没有办法通过一次检查多个域来加快速度？例如，现在它正在从一个域到下一个域检查信息。我可以在命令中更改什么以使其一次检查 50 个域吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T21:58:28.060

使用`&`，您可以在后台运行任何命令（因此并行）：

```
for i in $(< testdomains.txt); do
    whois "$i" | egrep '[a-zA-Z0-9]@[a-zA-Z0-9]\.[a-zA-Z0-9]' &
done >> results.txt 
```

## 笔记

*   如果您将控制操作符`&`放在命令的末尾，例如，shell 在*子shell*`command args &`的后台执行命令。shell 不等待命令完成，返回状态为 0。最后一个后台命令的 Pid 可通过特殊变量获得*`$!`*
**   每个人都在后台`&`做一个`fork(2)`*   请参阅[如何等待多个衍生进程？](http://mywiki.wooledge.org/BashFAQ/108)*

# java - 自定义 java Graphics.drawLine() 方程？

> ID：15558962
> 
> 赞同：0
> 
> 时间：2013-03-21T21:55:49.840
> 
> 标签：java, graphics, awt, line

我正在编写自己的自定义类以按照我想要的方式绘制线条和点，但是我遇到了绘制线条的问题。我有一个`ArrayList`我写的类扩展`java.awt.Point`，当我调用方法来画线时，我想首先将它们添加到数组列表中，以便在我想要它们时呈现。

我有终点和线的起点，但我不知道如何得到斜率，或者得到沿它的所有点。我想知道如何做到这一点，但在代码中。

# postgresql - 如何终止 postgresql 8.3 会话？

> ID：15558963
> 
> 赞同：2
> 
> 时间：2013-03-21T21:55:53.437
> 
> 标签：postgresql, postgresql-8.3

我正在尝试终止 postgresql 8.3 中的会话（特定会话或所有会话，无关紧要），但在执行此操作时遇到了麻烦。我知道在较新的版本（8.4 及更高版本）中有一个 pg_terminate_backend 命令可以解决问题，但这在 postgresql 8.3 中不可用。如果我使用 pg_stat_activity，我可以看到所有处于活动状态但无法终止它们的会话。

解决方案不一定是 sql 命令，但我希望它独立于正在使用的操作系统（即没有 DOS/UNIX 命令）。

在 Windows 服务中停止和启动 postgres 服务效果很好，但这是一种特定于操作系统的方法。但是，使用 'pg_ctl restart -D DATA_DIR' 不会停止服务。实际上，在我尝试这样做时使用 pg_ctl 尝试并重新启动服务会导致一些奇怪的行为。如果有一种方法我可以以某种方式使用 pg_ctl 来强制关闭进程，就像我假设的 windows 那样，那么我可能可以使用它。

无论如何，我正在寻找一种方法来终止 postgresql 8.3 中非特定平台的一个或所有会话。任何帮助都会很棒！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-21T21:59:11.533

您可以使用 pg_cancel_backend()：

```
select pg_cancel_backend(55555); 
```

您可以将其与 pg_stat_activity 一起使用。例如：

```
select pg_cancel_backend(procpid)
from pg_stat_activity where current_query='<IDLE>'; 
```

如果这不起作用，你可以试试这个：

```
pg_ctl kill -TERM pid 
```

那应该是独立于操作系统的。我不确定行为是否有任何真正的差异。

除此之外，您可以尝试停止和启动服务器，但您指出了奇怪的行为。（哪一种？）

最后，对于特定于操作系统的选项，在 linux 上您当然可以尝试使用 kill 命令。`kill -15`( `SIGTERM`) 是安全的；这基本上是什么`pg_terminate_backend`用途：`kill -15 <pid>`. [`kill -9`是适度不安全的，你应该只作为最后的手段使用它](https://serverfault.com/questions/415188/kill-9-a-postgres-process)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-21T12:12:45.660

```
su - posgres
psql

SELECT pg_terminate_backend(pg_stat_activity.procpid)  FROM  pg_stat_activity  WHERE  procpid <> pg_backend_pid()  AND datname = 'dbname' ;
drop database "database name"; 
```

# ios - Xcode 自动完成为 NSArray getter 建议神秘的“songsAtIndexes”

> ID：15558964
> 
> 赞同：2
> 
> 时间：2013-03-21T21:56:02.447
> 
> 标签：ios, objective-c, xcode, autocomplete, nsarray

我的班级有一个 NSArray 类型的属性，称为“歌曲”。我正在为它创建一个自定义 getter，XCode 为我提供了一个创建方法的选项：

```
songsAtIndexes:(NSIndexSet *)indexes 
```

这是什么，为什么 XCode 提供这个？这是特定于 NSArray 属性的吗？为该方法创建方法/getter 的目的是什么？如果我不手动定义它，它会自动创建/合成吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-21T22:04:40.610

这是对可用于您的类的索引集合进行少量使用的 KVC 优化的结果。[您可以在此处](http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/KeyValueCoding/Articles/Compliant.html)阅读有关此内容的信息，但要摘录：

> 索引对多关系合规性
> 
> 对于索引到多的关系，KVC 合规性要求您的类：
> 
> *   实现一个名为`-<key>`返回数组的方法。
> *   `<key>`或者有一个名为or的数组实例变量`_<key>`。
> *   或者实现该方法`-countOf<Key>`和 -objectInAtIndex: 或 中的一个或两个`-<key>AtIndexes:`。
> *   或者，您还可以实施`-get<Key>:range:`以提高性能。

它只真正与带有 KVC（有时`NSPredicate`是 s）的 Core Data 一起使用，但如果您愿意，可以利用这些方法。

在 99% 的情况下确实没有必要实现这一点，但如果你愿意，你可以这样做。

# c++ - 使用 '\uxxxx' 格式定义的字符显示错误字符

> ID：15558977
> 
> 赞同：3
> 
> 时间：2013-03-21T21:56:45.073
> 
> 标签：c++, unicode, character-encoding

我正在使用 Dev C++，Windows 7。

我正在尝试使用以下方法打印出非 ascii 字符：

```
char a='\uwxyz'; 
```

例如：

```
#include <locale.h>
#include <iostream>
#include <cstdlib>
#include <windows.h>
#include <conio.h>
#include <stdio.h>

using namespace std;

int main()
{
    setlocale(LC_ALL,"en_US.UTF-8");
    char a='\u0041'; //Should display 'A'
    cout<<a<<endl;
    a='\u2639'; //Should display '☹'
    cout<<a<<endl;
    system("PAUSE");
} 
```

在本例中，大写字母 A 正确显示。使用 wxDev，☹ 字符不会显示任何内容。使用 Dev（我需要将其用于最终程序），我会得到一个扩展的 ascii 字符（它是一个类似于 ∥ 的符号，但有多个符号看起来像这样，我不知道它是哪个）。

在 Dev 和 wxDev 中，☹ 显示为 ?。

在对如何正确显示 unicode 字符进行了一些初步搜索后，我添加了 setlocale，但我还没有找到任何解决此问题的方法。

我不能使用不同的编译器或修改系统设置来完成这项工作。（是的，这是一个学校项目。不，该项目不需要特殊字符；我只是想让它看起来更好。）如果不修改这些设置就无法工作，那也是有用的信息。

预先感谢您的任何帮助。

编辑：使用 Dev，而不是 wxDev，

```
char a='\u0041'; //should be A
cout<<a; 
```

我收到一个错误：\u0041 不是有效的通用字符

如果我使用 wchar_t 作为数据类型：

```
wchar_t a = '\u2639';
cout<<a<<endl; 
```

输出为 39097。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-22T21:34:20.837

通用字符名称 (UCN) 是一种向编译器传达您想要表示的字符的方法。只要您可以将*基本源字符*提供给编译器，那么每个编译器都会看到相同的 UCN，因此会看到您代表的是相同的字符。

这与在源代码中逐字写入字符相反：

```
char a = '☹'; 
```

由于编译器只需要支持基本的源字符，因此编译器甚至可能无法处理此代码。它实际看到的内容取决于编译器使用的*源编码。*一个编译器可能会看到您想要的字符，而另一个编译器会看到

```
char a = 'Â☐¹'; 
```

但是，仅仅因为 UCN 能够向编译器指定字符并不意味着：

*   编译器的*执行字符集*包含该字符或
*   数据类型`char`可以表示该字符值

在您的情况下，主要问题是*执行字符集*是 Windows 的代码页之一（可能是 CP1252），它没有字符“☹”。所以当编译器将字符'☹'转换为执行字符集时，转换产生'?' 而不是你想要的。

我的编译器的执行字符集确实包含字符“☹”，但它恰好有一个多字节表示，所以我的编译器说：

```
error: character too large for enclosing character literal type
    char a = '☹';
             ^ 
```

要真正理解这个主题，您需要了解编码、字符集、它们如何在 C++ 翻译阶段发挥作用，以及它们与编译器对字符和字符串文字的处理有何关系。此外，语言环境实际上与这些无关。语言环境处理运行时行为，而您的问题完全在于编译器对编码的编译时处理。

* * *

在到处使用 UTF-8 的平台上，以下工作：

```
#include <iostream>

int main() {
    std::cout << "☹\n";
} 
```

请注意，上面使用字符串文字而不是字符文字，以便字符可以扩展为多字节表示。

不幸的是，Windows 不支持这种方式的 Unicode。在 Windows 上它更复杂：

```
#include <Windows.h>
#include <cwchar>

int main() {
    wchar_t const *a = L"\u2639\n";
    DWORD numOfCharsWritten;
    WriteConsole(GetStdHandle(STD_OUTPUT_HANDLE), a, wcslen(a), &numOfCharsWritten, NULL);
} 
```

不幸的是，即使上面的代码也不太可能显示您想要的内容，因为 Windows 上的控制台通常未配置为能够显示 Unicode 字符“☹”。相反，您可能想查看控制台使用的 OEM 编码（可能是 CP437），查找所需字符的编码，然后打印出该值。例如 CP437 有字符 '☺'，你可以像这样打印出来：

```
#include <iostream>

int main() {
    std::cout << "\x01\n"; // ☺ has the value 0x01 in CP 437
} 
```

# jquery - slideToggle div 的一半？

> ID：15558982
> 
> 赞同：2
> 
> 时间：2013-03-21T21:56:58.590
> 
> 标签：jquery, slidetoggle, toggleclass

是否可以使用从 div 的一半到完整然后返回的 slideToggle？

我有这个代码的一个解决方案：

```
$("button").click(function() {
  $("#myDiv").toggleClass("reveal-closed").toggleClass("reveal-open");
}); 
```

请参阅工作示例[http://jsfiddle.net/NHRzH/1/](http://jsfiddle.net/NHRzH/1/)

但我想使用更多的幻灯片效果和更好的解决方案，而不涉及类

```
$("button").click(function () {
    $(".mydiv").slideToggle("slow");
}); 
```

这个脚本需要重复 20-30 div 和按钮（阅读更多功能） 这是一个 slideToggle 的例子，它不适用于半 div [http://jsfiddle.net/Xvxs3/](http://jsfiddle.net/Xvxs3/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T22:17:03.017

这个怎么样？

```
.reveal-open {
  max-height: 100px;
}
div {
  overflow: hidden;
  max-height: 50px;
  -webkit-transition: max-height .5s linear;
  -moz-transition: max-height .5s linear;
  transition: max-height .5s linear;
} 
```

和jQuery

```
$("button").click(function() {
  $("#myDiv").toggleClass("reveal-open");
}); 
```

[http://jsfiddle.net/Dtwigs/NHRzH/4/](http://jsfiddle.net/Dtwigs/NHRzH/4/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T23:01:32.157

这是我的解决方案：http: [//jsfiddle.net/NHRzH/12/](http://jsfiddle.net/NHRzH/12/)

**CSS：**

```
#myDiv {
    overflow: hidden;
    height: 50px;
} 
```

**jQuery：**

```
$("button").click(function(e) {
    toggleDiv($(this).attr('href'));
    e.preventDefault();
});

function toggleDiv(selector) {
    var $this = $(selector);

    //Close div, if open.
    if($this.hasClass('open'))
    {
        var originalHeight = $this.data('height');
        $this.animate({
                height: originalHeight},
                200,
                function() { $(this).removeClass('open'); });
        return false;
    }

    //Open the div
    var currentHeight =  $this.height();
        autoHeight = $this.css('height', 'auto').height()
        $this.data('height', currentHeight)
             .height(currentHeight).animate({
                                        height: autoHeight},
                                        200,
                                        function() { $(this).addClass('open'); });
} 
```

**HTML：**

```
<div id="myDiv">
    Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum
</div>
<button href="#myDiv">Show more</button>

<hr />

<div id="myDiv2">
    Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum
</div>
<button href="#myDiv2">Show more</button> 
```

**这个怎么运作。**

我们为按钮分配一个`href`值，然后将其传递给一个`toggleDiv`函数（处理 div 的切换）。

该`toggleDiv`函数将处理 的状态`div`，并根据其当前状态将其切换为打开或关闭。它将从中高到全高（自动）。

完整的工作示例可以在这里查看，有多个 div：http: [//jsfiddle.net/NHRzH/12/](http://jsfiddle.net/NHRzH/12/)

# android - Android：从另一个活动中创建一个活动中的表格行

> ID：15558985
> 
> 赞同：0
> 
> 时间：2013-03-21T21:57:02.020
> 
> 标签：android, android-intent

我有 2 个活动

活动 1 和活动 2

我正在尝试从活动 1 创建一个表，并尝试在活动 2 中创建它

```
private TableRow createRow(int y){
    TableRow row = new TableRow(Activity2.context); <---- this one?
    row.setHorizontalGravity(Gravity.CENTER);

    for (int x = 0; x < COL_COUNT; x++) {
        row.addView(createImageButton(x,y));
    }
    return row;
} 
```

我怎样才能使这个possbiel谢谢。

# c++ - 在 C++ 中使用结构

> ID：15558987
> 
> 赞同：-4
> 
> 时间：2013-03-21T21:57:02.980
> 
> 标签：c++

我在使用结构编程时遇到问题。我想接受可以重复多次的（整数，字符）形式的输入。然后程序会将字符存储在数组中整数指示的位置。目前，问题是消息未定义且位置未定义。

```
struct MessagePiece
{
    int location;
    char message;
};

void readMessage( istream& in, Message message[] )
{
    MessagePiece;
    message[256];
    Message message;

      while ( !in.fail() )
     {
             in >> location; //I'm not sure why this counts as undefined as it is defined in the struct

             if (location < 256, location >= 0)
                in >> message[location];
      }
return;
}; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T21:59:21.240

它是未定义的，因为它只`location`存在于类型**对象的上下文中**`MessagePiece`

```
MessagePiece mp;
in >> mp.location; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T22:09:09.213

您应该在 if 语句中使用 && 而不是 ',' 来检查条件。此外，这些行：

```
MessagePiece;
message[256];
Message message; 
```

应该这样写：

```
MessagePiece messages[256]; //declaring an array of struct MessagePiece
char message; // a char for storing input read from the user. 
```

还有一件事，要么将消息作为参数，要么在函数本身中声明它。

请考虑阅读一本关于 C++ 编程的好书。

# c# - 如何将 unicode 从 html 转换为常规单词

> ID：15558991
> 
> 赞同：-1
> 
> 时间：2013-03-21T21:57:18.233
> 
> 标签：c#, html, unicode, webclient

```
htmlCode = client.DownloadString("http: //abc.com"); 
```

执行时，html 有来这等 unicode 字符。如何正确转换它然后显示在文本框中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T22:13:29.833

尝试使用：

```
WebClient client = new WebClient();
TextBox1.Text = HttpUtility.HtmlDecode(client.DownloadString("http://abc.com")); 
```

# ios - AFNetworking 返回 NSCFData；registerHTTPOperationClass 的问题

> ID：15558992
> 
> 赞同：2
> 
> 时间：2013-03-21T21:57:18.677
> 
> 标签：ios, afnetworking

我是 AFNetworking 的新手，正在调用一个返回 json 的简单登录 api，例如：

```
{"status":"success","data":{"auth_token":"12jt34"}} 
```

我正在通过以下方式进行操作，但它返回的是 __NSCFData 而不是我可以操纵的东西。

```
NSURL *baseURL = [NSURL URLWithString:@"http://localhost:3000/arc/v1/api/"];
AFHTTPClient *httpClient = [[AFHTTPClient alloc] initWithBaseURL:baseURL];
[httpClient registerHTTPOperationClass:[AFJSONRequestOperation class]];
[httpClient defaultValueForHeader:@"Accept"];
NSDictionary *params = [NSDictionary dictionaryWithObjectsAndKeys:
                        uname,@"email", pwd, @"password",
                        nil];
[httpClient postPath:@"login-mobile" parameters:params success:^(AFHTTPRequestOperation *operation, id responseObject) {
    NSString *className = NSStringFromClass([responseObject class]);
    NSLog(@"val: %@",className);
}failure:^(AFHTTPRequestOperation *operation, NSError *error) {
    NSLog(@"Error retrieving data: %@", error);
}]; 
```

它输出：

```
2013-03-21 14:52:51.290 FbTabbed[21505:11303] val: __NSCFData 
```

但我希望它成为一本我可以操纵的字典，这就是我认为它应该如何工作的方式？我究竟做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-21T22:15:07.393

```
[httpClient defaultValueForHeader:@"Accept"]; 
```

应该：

```
[httpClient setDefaultHeader:@"Accept" value:@"application/json"]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T22:19:25.160

是的，`responseObject`是一个`NSData`. `NSJSONSerialization`然后，您可以使用方法将其解析为字典或数组`JSONObjectWithData`：

```
NSURL *baseURL = [NSURL URLWithString:@"http://localhost:3000/arc/v1/api/"];
AFHTTPClient *httpClient = [[AFHTTPClient alloc] initWithBaseURL:baseURL];
[httpClient registerHTTPOperationClass:[AFJSONRequestOperation class]];
[httpClient defaultValueForHeader:@"Accept"];
NSDictionary *params = [NSDictionary dictionaryWithObjectsAndKeys:
                        uname,@"email", pwd, @"password",
                        nil];
[httpClient postPath:@"login-mobile" parameters:params success:^(AFHTTPRequestOperation *operation, id responseObject) {

    NSAssert([responseObject isKindOfClass:[NSData class]], @"responseObject is supposed to be a NSData"); // it should be a NSData class

    NSError *error;
    self.results = [NSJSONSerialization JSONObjectWithData:responseObject
                                                   options:0
                                                     error:&error];
    if (error != nil)
    {
        // handle the error

        // an example of the sort of error that could result in a parse error 
        // is if common issue is that certain server errors can result in an
        // HTML error page (e.g. you have the URL wrong, your server will 
        // deliver a HTML 404 page not found page). If you want to look at the 
        // contents of the `responseObject`, you would:
        //
        // NSLog(@"responseObject=%@", [[NSString alloc] initWithData:responseObject encoding:NSUTF8StringEncoding]);
    }
}failure:^(AFHTTPRequestOperation *operation, NSError *error) {
    NSLog(@"Error retrieving data: %@", error);
}]; 
```

显然，您的`results`对象将是 a`NSDictionary`或`NSArray`，具体取决于您从 API 获得的响应类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T22:04:20.823

> 我究竟做错了什么？

`NSStringFromClass()`返回作为`NSString`对象传入的类的名称。

如果你想从返回的 JSON 字符串中创建一个字典，那么你必须解析它，例如使用`NSJSONSerialization`类。

# java - 在 Java 中打开文件时通知操作系统

> ID：15558997
> 
> 赞同：3
> 
> 时间：2013-03-21T21:57:53.673
> 
> 标签：java, swing, file, recent-file-list

我想知道是否有某种用于 Java (Swing) 的 API 库允许您的程序告诉系统它刚刚打开了一个文件，以便它可以将其添加到任何操作系统的用户最近的文档中（如 Windows 的 SHAddToRecentDocs）。这样的事情存在吗？注意：我不考虑将[j7Goodies](http://www.strixcode.com/j7goodies/)作为解决方案。

编辑：有问题的文件我已经打开了，我不希望系统打开它。我还在我的程序中跟踪最近的文档，我想知道如何告诉系统我打开了它，而不需要系统指示默认程序打开它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-22T01:18:56.993

The class `java.awt.Desktop` includes an `open()` method that does this on Mac OSX. You'll want to test on your other target platforms. If you can't use the feature directly, this [earlier incarnation](http://www.javadesktop.org/articles/jdic/index.html) of the API may suggest an approach.

Absent a better implementation, this [`FileMenu`](https://stackoverflow.com/a/4039359/230513) can be used within an application. Also, consider one of the persistence mechanisms mentions [here](https://stackoverflow.com/a/11114200/230513).

Addendum: Internally, `java.awt.Desktop` delegates to an instance of a platform-specific [`java.awt.peer.DesktopPeer`](http://doc.java.sun.com/DocWeb/api/java.awt.peer.DesktopPeer) for each supported platform. You might be able to leverage the approach taken in existing implementations for the platforms you intend to support.

# java - 深度复制错误

> ID：15558998
> 
> 赞同：-4
> 
> 时间：2013-03-21T21:57:57.477
> 
> 标签：java, deep-copy

死所有，

我有以下内容：

```
class test {
    int x = 6;
    int y = 7;

    private int getX() {
        return x;
    }

    private int getY() {
        return y;
    }

    public test copy() {
        test myTest = new test();
        myTest.x = getX();
        myTest.y = getY();
        return myTest;
    }
} 
```

但是，当我执行时：

```
test a = new test();
test b = a.copy();
b.x = 17;
System.out.println(a.x); 
```

结果仍然是 17。但是，深度复制不应该阻止这种情况吗？

有谁能帮助我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T22:00:23.173

首先，您忽略了`b.copy()`in 的返回值：

```
test b = new test();
b.copy(); 
```

其次，我已经测试了您的代码并且它打印出来`6`，而不是`17`您在问题中所说的那样。

**编辑**我注意到您已经修复了编辑中的第一个问题。但是，代码的行为仍然不像您所说的那样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T22:09:13.450

结果应该是 6 而不是 17。

# c# - 在我的网站解决方案中包含一个 WCF 服务项目并引用它

> ID：15558999
> 
> 赞同：0
> 
> 时间：2013-03-21T21:58:11.837
> 
> 标签：c#, .net, wcf

我是 .net 的新手，我有我的网站解决方案，我将我的数据库 WCF 服务添加到解决方案中，我如何引用该服务的接口？我将在开发时对服务进行更改，我是否必须每次都构建/部署服务，或者我可以以某种方式引用 .svc 文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T23:29:58.333

[nkvu - 退出评论并作为答案，以防以后需要找到它......]

如果您的 WCF 服务是与您的 Web 项目相同的解决方案中的一个单独项目，那么您应该能够按照“在当前解决方案中添加对服务的引用”标题下的说明[进行](http://msdn.microsoft.com/en-us/library/bb628652.aspx)操作...在您进行更改后只需使用“更新服务参考”下的说明来确保您的 Web 项目与服务更改同步