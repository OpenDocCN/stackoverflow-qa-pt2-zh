# StackOverflow 问答 13388000-13388999

# linq - Tridion OData 服务和 Linq 的“方法加入不受支持”

> ID：13388000
> 
> 赞同：6
> 
> 时间：2012-11-14T21:52:47.623
> 
> 标签：linq, tridion, tridion-2011, tridion-content-delivery

我正在尝试加入 CustomMeta 和 PageContents 以通过一些已设置的元数据选择特定页面，但我收到“不支持方法加入”错误。我认为问题出在我的 linq 语句上，因为错误发生在任何东西被发送到 OData 服务之前。但究竟是什么问题？linq 语句对我来说看起来不错：

```
 var pages2 = (from p in cds.PageContents
    join m in cds.CustomMetas on p.PageId equals m.ItemId
    where m.ItemType==64 && m.KeyName=="SomeKey" && m.StringValue=="SomeValue"
    select p).ToList<SDLODataClient.SDLOData.PageContent>(); 
```

更新 1

这篇[Tridion OData 文章](https://sdltridionworld.com/articles/sdltridion2011/tutorials/using-odata-with-tridion-and-net.aspx)有一个连接示例，但我正在阅读的一些 MS Linq to OData 文章似乎表明 Linq to OData 不支持连接（[这里](https://stackoverflow.com/questions/4878567/how-do-i-get-an-inner-join-in-a-wcf-data-service)）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-14T23:20:25.293

据我所知，针对数据服务 (OData) 的 LINQ 查询不支持多种方法。您使用的`join`那个也属于同一类别，因此即使从 LINQ 的角度来看语法非常有效，您也会看到错误。`join`属于“投影和过滤运算符”，不支持使用 LINQ 对 OData 进行查询。

这是解释所有不受支持的方法的链接（请参阅部分 - 不受支持的 LINQ 方法）

[http://msdn.microsoft.com/en-us/library/ee622463(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/ee622463(v=vs.100).aspx)

回到您的问题，我不太了解如何实现您正在寻找的东西，但我会尝试以下方法（您可能必须在多次迭代中获得结果）：

*   获取与自定义元查询匹配的页面 ID 列表（示例片段 - 未测试）

```
_client.CustomMetas.Where (
 m => m.KeyName == "somekey" && m.StringValue == "somevalue" && m.ItemType == 64)
.ToList(); 
```

*   现在您可以使用上述页面 id 查询页面内容。您可能已经为每个页面 ID 构建了过滤器类型查询。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T14:04:02.237

您是否尝试过使用 expand 的概念？

在OData服务中我们没有join查询但是有Expand关键字，其中两个具有外键关系的实体（表）可以一起使用来得到一个结果集。它的工作原理如下：

```
from item in table1.Expand(table2).AsEnumerable()
where (item.property1.Equals("x") & item.table2[0].prop2.Equals("y"))
select item 
```

这里第二个实体作为第一个实体的属性公开。

# jquery - 在 modal('show') 上自动滚动引导模式

> ID：13388002
> 
> 赞同：2
> 
> 时间：2012-11-14T21:52:53.083
> 
> 标签：jquery, html, css, twitter-bootstrap, autoscroll

我有一个用于评论的引导模式。评论表单附加在评论列表的底部。我希望此模式在打开时滚动到列表底部，如果有超过 2 或 3 条评论。我已经安装了这个幻灯片插件
[http://jesseprice.com/jquery-slide-to-plugin/](http://jesseprice.com/jquery-slide-to-plugin/)

理想情况下，我希望能够使用该插件。我已经用我目前的想法设置了一个小提琴：http: [//jsfiddle.net/D2RLR/3275/](http://jsfiddle.net/D2RLR/3275/)

这是我当前的 jQuery

```
 $('.slideto').slideto({
    target : '.new-comment-entry',
    speed  : 'slow'
}); 
```

我已经让它在常规浏览器窗口中工作，但它不会附加到模态。

如果有人想要挑战，那就来吧；）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T23:16:24.177

是的。因为如果该模态尚未显示，您无法告诉您的模态主体滚动......您需要使用某种回调函数。Twitter Bootstrap 为您提供模态事件。在此处查看文档：http: [//twitter.github.com/bootstrap/javascript.html#modals](http://twitter.github.com/bootstrap/javascript.html#modals)在*Events*下。

```
$('#myModal').on('shown', function () {
    // do something…
}) 
```

给你：http: [//jsfiddle.net/bws9N/](http://jsfiddle.net/bws9N/)

编辑：我真的认为不需要在这里使用那个幻灯片插件，因为无论如何你都可以让它工作。但主要思想在这里......

# google-apps-script - typeof 在触发器对象属性上失败

> ID：13388012
> 
> 赞同：1
> 
> 时间：2012-11-14T21:53:30.007
> 
> 标签：google-apps-script

我正在尝试将 dumpObject 函数添加到电子表格容器绑定脚本中。

理想情况下，它是为了查看通过触发器传递的变量。

我可以在脚本编辑器中整天运行它，但是当设置为 onEdit 事件或 onEdit Installible 触发器时，它会毫无错误地死掉。

我做了一些试验和错误 toast 消息，并确认 dumpObject 中的代码是从触发器执行的。

如果您在下面使用此代码，将 onEdit2 设置为可安装触发器，您可能会看到它。

要将其视为触发器，请取消注释 onEdit2 的第一行 //e。

我能想到的最好的事情是，来自触发器的 e 对象中的某些东西与对象的预期不完全一样吗？

这个测试应该将 maxDepth 限制为 5，所以我认为我没有达到 1000 的深度限制。

**更新**：问题是在触发器对象属性上调用 typeof。例如，“typeof e.user”报告以下错误：Invalid JavaScript value of type

谢谢，吉姆

```
function onEdit2(e) {
  //e = {fish:{a:"1",b:"2"},range:SpreadsheetApp.getActiveSpreadsheet().getActiveRange(),B:"2"};
  Browser.msgBox(typeof e);
  Browser.msgBox("U:" + Utilities.jsonStringify(e));
  e.range.setComment("Edited at: " + new Date().toTimeString());

  Browser.msgBox("ShowOBJ:"+dumpObject(e, 5));

}

function dumpObject(obj, maxDepth) {
  var dump = function(obj, name, depth, tab){
  if (depth > maxDepth) {
    return name + ' - Max depth\n';
  }

  if (typeof obj === 'object') {
    var child = null;
    var output = tab + name + '\n';
    tab += '\t';
    for(var item in obj){
      child = obj[item];
      if (typeof child === 'object') {
        output += dump(child, item, depth + 1, tab);
      } else {
        output += tab + item + ': ' + child + '\n';
      }
    }
   }
    return output;
  };
  return dump(obj, '', 0, '');
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T14:43:04.450

您并没有从事件对象中得到您所期望的。如果你投入：

```
 for(var q in e) {
    Logger.log(q + " = " + e[q])   
 } 
```

然后在你得到的脚本编辑器中检查 View->Logs 菜单项

```
source = Spreadsheet
user = <your user> 
```

所以，检查[文档](https://developers.google.com/apps-script/class_spreadsheet)，你可以想出这个作为你的替代方案`e.range.setComment("Edited at: " + new Date().toTimeString());`：

```
e.source.getActiveSheet().getActiveCell().setComment("Edited at: " + new Date().toTimeString()); 
```

注意：您可以通过将语句包装在 try catch 中来调试错误，就像（秘密地）得到的错误，如下所示：

```
 try {
    e.range.setComment("Edited at: " + new Date().toTimeString());
  } catch (ex) {
    Logger.log(ex); 
  } 
```

然后如上所述检查日志（或转储到`Browser.msgBox()`，如果您愿意）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T17:21:42.807

这可能不是一个很好的“答案”，但它有效。

我发现用 Object.prototype.toString.call(obj) 替换 typeof 我得到了一些有用的东西。

值得注意的是，e 对象返回 [object Object] 但属性 (e.user) 返回 [object JavaObject]

```
if (Object.prototype.toString.call(obj).indexOf("object") != -1) {
  var child = null;
  var output = tab + name + '\n';
  tab += '\t';
  for(var item in obj){
    child = obj[item];
    if (Object.prototype.toString.call(child).indexOf("object") != -1) {
      output += dump(child, item, depth + 1, tab); 
```

# php - 如何使用 cURL 在目标页面中避免基于 IP 的重定向？

> ID：13388016
> 
> 赞同：0
> 
> 时间：2012-11-14T21:53:47.463
> 
> 标签：php, curl, http-headers, ip, user-agent

我正在尝试从 Web 获取数据并**使用 cURL**和 Simple HTML Dom PHP 类将其显示给用户。

**某些页面**根据客户端的语言进行重定向，我正在使用一个函数来确定要抓取的最终页面。

为了像用户看到的那样显示它，我使用这个：

```
$useragent = $_SERVER['HTTP_USER_AGENT'];
curl_setopt($ch, CURLOPT_USERAGENT,  $useragent); 
```

目前，我目前的大多数用户都是说西班牙语的，因此我暂时限制接受的语言，所以如果**目标页面上有语言重定向**，它将首先显示西班牙语或英语。

```
$header[] = "Accept-Language: es-es,es;q=0.8,en-us;q=0.5,en;q=0.3"; 
```

但是，由于我的服务器位于荷兰，并且某些页面具有基于**IP 的重定向器**，因此有时页面会重定向到 /nl/ 目录，而忽略语言参数。

例如，**www.econsultancy.com**网站会发生这种情况。

是否可以避免这种重定向，也许在 cURL 请求中使用**客户端的 IP 地址？**

另外，是否可以使用**客户端的浏览器语言设置**来使*Accept-Language*参数动态化？

这是整个函数脚本：

```
<?
function redirector($originalurl) {

$ch = curl_init();

$useragent = $_SERVER['HTTP_USER_AGENT'];

    $header[0] = "Accept: text/xml,application/xml,application/xhtml+xml,";
    $header[0] .= "text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5";
    $header[] = "Cache-Control: max-age=0";
    $header[] = "Connection: keep-alive";
    $header[] = "Keep-Alive: 300";
    $header[] = "Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7";
    $header[] = "Accept-Language: es-es,es;q=0.8,en-us;q=0.5,en;q=0.3";
    $header[] = "Pragma: ";

curl_setopt($ch, CURLOPT_HTTPHEADER, $header);
curl_setopt($ch, CURLOPT_USERAGENT,  $useragent); 
curl_setopt($ch, CURLOPT_HEADER, true);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);

    curl_setopt($ch, CURLOPT_URL, $originalurl);
    $out = curl_exec($ch);

    $out = str_replace("\r", "", $out);

    $headers_end = strpos($out, "\n\n");
    if( $headers_end !== false ) { 
        $out = substr($out, 0, $headers_end);
    }   

    $headers = explode("\n", $out);
    foreach($headers as $header) {
        if( substr($header, 0, 10) == "Location: " ) { 
            $target = substr($header, 10);

            $targeturl = $target;
        }   
    }

return $targeturl;
}
?> 
```

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T22:04:39.967

一些基于 IP 的重定向非常顽固（几乎不可能将某些页面从*<whatever page thinks your language is>*切换为英文），但您可以尝试通过使用[`CURLOPT_FOLLOWLOCATION`](http://php.net/manual/en/function.curl-setopt.php)set to`False`和解析`Location`标头来拦截任何重定向（此解决方案需要您正确猜测 URL）：

```
$status_code = curl_getinfo($ch, CURLINFO_HTTP_CODE);
if( $status_code >= 300 && $status_code < 400){
    // Was redirect, parse header
    if( substr( $location, '/nl/') !== false){
         // Try to load page $url = str_replace( $location, '/nl/', '/en/');
         // Remember to check whether page exists
    } else {
         // Continue request
    }
} 
```

### 编辑 - 每个站点

如果您有能力在“每个站点”的基础上执行此操作（为每个站点创建切换语言的功能），您可以跟踪切换语言时发生的情况（例如 Firefox 有完美[的插件](https://addons.mozilla.org/en-us/firefox/addon/tamper-data/)），并且大多数时候您'将最终使用：

*   *硬核*（用户无法控制语言） - 你被搞砸了
*   *不同的 URL*（我们已经介绍过） - 你会在 URL 中看到`/nl/`, `lang=nl`, `l=nl`, ...
*   *语言存储在 cookie 中*- 您只需设置 cookie 一次[[tutorial]](http://coderscult.com/php/php-curl/2008/05/20/php-curl-cookies-example/)然后它就正确了
*   *注册用户可以更改语言*- 您需要在每个站点上创建用户，将他的（其）语言切换为*<whatever you want>*然后（打开页面时）您首先在页面上模拟登录（使用 cookie 打开登录表单以及`POST`用户名和密码）

运气好的话，你会很好地结合“大数组” cookie 值对已经拥有的东西，如下所示：

```
array (
    'lang' => 'eng',
    'l' => 'en',
    'Language' => 'Engligh',
    ...
) 
```

但是，一旦您遇到两个使用相同*“cookie 变量名称”*和不同值的页面：

```
lang=eng
lang=en
lang=7 
```

你被搞砸了，你将不得不`switch($domain)`再次使用某种东西。

# jquery - 一个按钮 一个功能在第一次点击另一个在第二个

> ID：13388017
> 
> 赞同：6
> 
> 时间：2012-11-14T21:53:49.337
> 
> 标签：jquery

我想要一个按钮来执行两个 jquery 功能。第一次单击时一个，第二次单击时另一个。这是两个按钮的代码。有没有办法组合功能？

```
<input type="button" value="View Page" onclick="ViewPage()" />

<script type="text/javascript">
function ViewPage() {
example_animate('-=50%');
$("#mainContent").toggle();
}
</script>

<input type="button" value="View Menu" onclick="ViewMenu()" />

<script type="text/javascript">
function ViewMenu() {
example_animate('+=50%');
$("#mainContent").toggle();
}
</script> 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-11-14T21:59:45.857

尝试这样的事情 -[**演示**](http://jsfiddle.net/7YATm/)

```
var action = 1;

$("input").on("click", viewSomething);

function viewSomething() {
    if ( action == 1 ) {
        $("body").css("background", "honeydew");
        action = 2;
    } else {
        $("body").css("background", "beige");
        action = 1;
    }
} 
```

所以在你的情况下

```
function viewSomething() {
    if ( action == 1 ) {
        example_animate('-=50%');
        action = 2;
    } else {
        example_animate('+=50%');
        action = 1;
    }
    $("#mainContent").toggle();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T22:05:33.277

另一种使用`one`方法，两者都只会触发一次

```
$("input").one("click", viewSomething);
function viewSomething()
{
    $("body").css("background", "honeydew");
    $("input").one("click", function(){ // on can be used
        $("body").css("background", "beige");
    });
} 
```

[**演示**](http://jsfiddle.net/7YATm/1/)。

**更新：**如果您想让第二个处理程序保持活动状态，请替换`one`为`on`这样[**的**](http://jsfiddle.net/7YATm/3/)处理程序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-12-25T16:01:19.470

您还可以为 html 元素指定名称。

```
<input type="button" value="Click me" onclick = 'viewSomething(this)'/>           
<script>
    function viewSomething(e){  

        //First time click
        if(e.name != 'Click'){
           e.name = "Click";
           <!--do whatever..-->
         }//end if

       //When click it again..
       else if(e.name == 'Click'){
           e.name = "Unclick";
           <!--do whatever-->
       }//end else
  }//end function
</script> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-14T22:11:39.887

你可以给你的按钮添加一个类，这样你就知道按钮应该做什么，然后在这两个函数中测试按钮是否有这个类。当然，您还需要删除 viewMenu() 中的类，在 jQuery v1.8.3 中看起来像这样：

```
<input id="toggle-view" type="button" value="View Menu" class="view-page" />

$('#toggle-view').on('click', function() 
{
   var button = $(this);

   if ( button.hasClass('view-page')  ) 
   {
       ViewPage();
       button.removeClass('view-page');   
   } 
   else 
   {
        ViewMenu();
        button.addClass('view-page');
   }
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-14T22:06:20.270

你可以使用一个数组来存储你的函数和一个计数器`data`来跟踪索引。这非常灵活，因为您可以添加任意数量的功能，并且如果您继续单击它会循环播放。

**演示：http:** [//jsbin.com/ehatoj/2/edit](http://jsbin.com/ehatoj/2/edit)

```
var funcs = [
  function one() { alert('one'); },
  function two() { alert('two'); },
  function three() { alert('three'); }
];

$('button')
  .data('counter', 0) // begin counter at zero
  .click(function() {
    var counter = $(this).data('counter');
    funcs[ counter ]();
    $(this).data('counter', counter < funcs.length-1 ? ++counter : 0);
  }); 
```

# c++ - 访问 std::vector 元素会随着向量大小而变慢

> ID：13388025
> 
> 赞同：1
> 
> 时间：2012-11-14T21:54:16.857
> 
> 标签：c++, performance, stl, stdvector

今天我遇到了一个问题，即访问向量元素会随着向量的大小而变慢。由于这不是我的代码，我无法发布它，所以请多多包涵。我将尝试尽可能详细地描述它。

代码的功能如下： 1\. Dataset 类，采用.txt 文件，其中包含文件名。这些指向需要加载的标准 png 图像。这是由一个`Image<T>`班级完成的。图像被加载`Image<unsigned char>`并推回`std::Vector`. 2\. 数据加载完成后。我可以访问我的数据集中的向量以便使用它。所以它看起来像这样：

```
Dataset d;
d.init("filenames_list.txt"); //Loads the images
for(int i=0; i< d.getDatavector().size(); i++){
  Image<unsigned char> current = d.getDatavector()[i];
  //Do work on current image here.
} 
```

这里 getDatavector() 将返回一个`std::Vector<Image<unsigned char> >`. 图像包含三个整数，宽度、高度和通道数，此外还有一个指向交错数据的 Boost 共享指针。

对于小型测试运行，我有一个包含大约 150 个图像的文件列表。用这个运行程序很好，速度测量告诉我

`Image<unsigned char> current = d.getDatavector()[i];`

大约需要 10ms 才能完成。但是，如果我想处理包含 1500 张图像的完整数据集，则上述行大约需要 500 毫秒才能完成。我尝试做很多不同的事情来修复它，但我受到代码的一般结构和内存的限制。因为如果我执行以下操作：

`const std::Vector<Image<unsigned char> > data = d.getDatavector();`

在循环之前，它运行得非常快，但我很快就用完了内存。

我知道我的问题描述有些含糊，我不希望找到确切的解决方案，但我希望有一些关于在哪里查找的提示。我搜索了类似的问题，但人们似乎只关心向量与数组的一般速度。我的问题是，速度会随着向量的长度而降低！如果有人看到这种问题，非常欢迎任何建议！

到目前为止，我已经尝试使用 std::vector::iterator 或使用 (d.getDatavector().data()) 作为指针访问内容。似乎没有什么可以提高它的速度。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-14T21:59:02.837

原因是您在循环中按值返回向量。

让你`getDatavector()`返回`std::Vector<Image<unsigned short> >&`或`std::Vector<Image<unsigned short> > const&`不返回`std::Vector<Image<unsigned short> >`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-14T22:03:02.790

的签名是`getDataVector()`什么样的？是吗

```
std::vector<Image<unsigned char>> getDataVector(); 
```

如果是这样，该函数将返回`vector`by 值，并且每次您编写`d.getDatavector()[i]`副本时`vector`，都会将`i`元素复制出`vector`然后`vector`销毁自身。

如果您可以修改`Dataset`类，请将函数更改为

```
std::vector<Image<unsigned char>> const& getDataVector(); 
```

现在不会在每次调用该函数时都进行复制。

如果您无法修改类，请在进入循环*之前制作一个副本，然后在循环中使用局部变量。*

问题不可能是索引，因为`std::vector`的基础数据数组需要是连续的，因此访问第*i^个*元素就像添加`i`到标记数据数组起始地址的指针并取消引用结果一样简单。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-14T21:57:18.653

您使用的是 C++11 还是更早的 C++？

如果较早的 C++11 和 getDataVector 返回一个向量，则可能必须复制它。如果您使用的是 C++11，则可以将其移动到返回变量中而无需复制

这可能是你减速的根源。

访问向量的元素是一个常数时间操作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-14T22:18:14.443

如前所述，问题的根源似乎在于`getDatavector()`返回向量的完整副本，解决方案是返回引用（或指针）。您在制作图像副本的位置
也有类似的问题。 这些问题的一种解决方案是使用对图像的直接访问：`Image<unsigned char> current = ...`

```
Image<unsigned char>* getImage(int idx)
{
 if (idx < _myVector.size())
 {
   return &_myVector[idx].Image;
 }
 return NULL;
} 
```

**编辑：**版本返回参考

```
 Image<unsigned char>& getImage(int idx)
    {
     if (idx < _myVector.size())
     {
       return _myVector[idx].Image;
     }
     // throw exception here;
    } 
```

显然，如果您必须拥有每个图像的副本，这将不起作用。

# jquery-ui - 使用jquery计算多个类中子元素的总宽度

> ID：13388028
> 
> 赞同：0
> 
> 时间：2012-11-14T21:54:23.123
> 
> 标签：jquery-ui, jquery, jquery-selectors

我有以下代码

```
 <span class="numbers">
    <a href="#">20</a>, <a href="#">50</a>, <a href="#">100</a>
 </span> 
```

类“数字”是位置绝对元素，它在页面中使用多次。

类“数字”中的内容将动态变化。所以我需要将孩子的总宽度应用于其父容器

我尝试了这段代码，但没有工作。

```
var totalWidth = 0;
$(".numbers").children('a').each(function() {
      totalWidth = totalWidth + $(this).width();
      $('.numbers').each(function(){$(this).css("width", totalWidth);});
}); 
```

但我只得到 totalWidth 值 0 。任何人都可以帮忙............？

请参阅[http://jsfiddle.net/contactsreejesh/xP3mn/6/](http://jsfiddle.net/contactsreejesh/xP3mn/6/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T22:13:17.770

首先，您需要遍历所有`numbers`元素。然后在该循​​环中，循环属于每个单独`numbers`跨度的孩子

```
$('.numbers').each(function() {
    var totalWidth = 0;
    /* "this" in this loop is the current numbers span*/
    var $self=$(this) 
   /* loop over all the children of this element*/
    $self.children('a').each(function() { 
        /* "this" in current loop is an A tag*/
        totalWidth += $(this).width();      
    });

    /* now set width*/
    $self.width( totalWidth)

}) 
```

该语句将影响整个页面中具有该类的所有元素，并且它们都将具有相同的宽度

```
$('.numbers').width(totalWidth); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T22:03:55.130

检查这个小提琴[http://jsfiddle.net/FGmYU/](http://jsfiddle.net/FGmYU/)

变化是这样的：

```
totalWidth += $(this).width(); 
```

输入显示计算出的宽度为 56。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T22:06:46.640

根据[这里](http://jsfiddle.net/emosaurusrex/S6h9J/1)，这对我有用。

```
var w = 0;
$('.numbers').find('a').each(function(){
    w += $(this).width();
});​​​​​​ 
```

# ssrs-2008 - SSRS 2008 R2 过滤 Tablix 组，但使用组中的所有数据进行聚合

> ID：13388029
> 
> 赞同：0
> 
> 时间：2012-11-14T21:54:26.510
> 
> 标签：ssrs-2008

我正在构建一个带有 SharePoint 列表作为数据集的 SSRS 2008 R2 报告（不能使用数据库......但不确定它是否会有所帮助）。

这是我拥有的数据示例（仅显示相关字段）。

```
工作流标题 Show_On_Workstream_Report 值
---------- ------ ------------- ------
WA TA 真 1
WA TB 错误 2
WA TC 假 3
WB TD 真 1
WB TE 真 2
WB TF 错误 2
WC TG 假 1
WC TH 假 2
WC TI 错误 2

```

我需要我的 tablix 输出如下。

```
工作流/标题 Max_Value
--------------
西澳 3
  助教1
世界银行 2
  TD 1
  TE 2

*请注意，WC 未显示在 tablix 输出中，因为没有条目将 Show_On_Workstream_Report 设置为 true。
*我相信这是这个问题的关键所在......

```

我在分组和诸如此类的方面降低了 Tablix 格式，但不能完全弄清楚如何在 Max_value 计算中同时包含工作流的所有记录，但只显示工作流下的“选定”标题。

我认为需要填写的项目。

```
行组
  工作流
     过滤器： ?
  标题
     过滤器：Show_On_Workstream_Report = True

```

如果您认为它可以解决问题，我愿意接受自定义报告代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T12:32:58.937

您有 2 个行组、WorkStream 及其子标题（详细信息行）？在 Title 行之前添加一个总数，将其设置为从 Workstream 组中选择最大值。工作流组不应应用过滤器

```
 =Max(Fields!VALUE.Value, "Workstream") 
```

# core-data - RestKit / Core Data：远程删除的实体不会从 Core Data 中删除

> ID：13388030
> 
> 赞同：1
> 
> 时间：2012-11-14T21:54:30.673
> 
> 标签：core-data, restkit

为什么远程删除的实体没有从 Core Data 和数据存储中删除？在 - (void)deleteCachedObjectsMissingFromResult:(RKObjectMappingResult *)result in RKManagedObjectLoader 的开头设置断点表明变量结果不包含任何内容。

我可以通过在 RestKit 委托中实现这个功能来解决这个问题 - (void)objectLoader:(RKObjectLoader *)objectLoader didLoadObjects:(NSArray *)objects 但在我看来这是一种不干净的代码。RestKit / Core Data 应该自己做？！无论如何，以下实现将解决问题：

```
- (void)objectLoader:(RKObjectLoader *)objectLoader didLoadObjects:(NSArray *)objects
{

NSArray *allReservations = [Reservation findAll];  

for(Reservation *reservationRecord in allReservations) {
    if(![objects containsObject:reservationRecord]) {
        [[[[RKObjectManager sharedManager] objectStore] managedObjectContextForCurrentThread] deleteObject:reservationRecord];
    }
}
} 
```

在没有 didLoadObjects 帮助的情况下解决该问题的任何想法？添加/更新现有实体可以正常工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-25T12:50:55.507

RestKit 只会删除 NSManagedObjectContext 中的条目。您的方法仅编辑 NSManagedObjectContext 中的对象，但从不将它们保存到 objectStore。确保在添加/编辑/删除完成后将更改保存到 ObjectStore。

```
- (void)objectLoader:(RKObjectLoader *)objectLoader didLoadObjects:(NSArray *)objects
{
    NSArray *allReservations = [Reservation findAll];  

    // Deleting each item in NSManagedObjectContext
    for(Reservation *reservationRecord in allReservations) {
        if(![objects containsObject:reservationRecord]) {
            [[[RKObjectManager sharedManager] objectStore] managedObjectContextForCurrentThread] deleteObject:reservationRecord];
        }
    }

    // Changes only exist in NSManagedObjectContext, delete them in the ObjectStore
    NSError *error = nil;
    if (![[[RKObjectManager sharedManager] objectStore] managedObjectContextForCurrentThread] save:&error]) 
        NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
} 
```

# sql-server - SQL Server Round DateTime Up

> ID：13388038
> 
> 赞同：3
> 
> 时间：2012-11-14T21:54:47.510
> 
> 标签：sql-server, datetime

我需要一个向上舍入到最接近的 x 分钟的函数。我在下面找到了一个，但它向上或向下舍入到最近的 x 分钟。基于另一个值，我要么需要将其向上舍入到最接近的半小时或小时。

```
CREATE FUNCTION [dbo].[RoundTime] (@Time DATETIME, @RoundToMin INT)
RETURNS DATETIME
AS
BEGIN
RETURN ROUND(CAST(CAST(CONVERT(VARCHAR,@Time,121) AS DATETIME) AS FLOAT) * (1440/@RoundToMin),0)/(1440/@RoundToMin)
END
GO 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T22:31:34.113

这会将您的函数更改为四舍五入到任意分钟数。

```
CREATE FUNCTION [dbo].[RoundUpTime] (@Time DATETIME, @RoundToMin INT)
RETURNS DATETIME
AS
BEGIN
return dateadd(mi, - datepart(mi, @time) + (datepart(mi, @time) + @roundToMin - 1) / @roundToMin * @roundToMin, @Time)
END
GO 
```

注意我将名称更改为 RoundUpTime。警告，它仅适用于 MINUTE 部分，并忽略秒和毫秒。

```
select dbo.RoundUpTime('20121212 12:30:00.003', 30)
--
2012-12-12 12:30 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T22:05:20.670

将 ROUND 更改为 CEILING 并从 ROUND 中去掉“, 0”：

```
CREATE FUNCTION [dbo].[RoundTime] (@Time DATETIME, @RoundToMin INT)
RETURNS DATETIME
AS
BEGIN
RETURN CEILING(CAST(CAST(CONVERT(VARCHAR,@Time,121) AS DATETIME) AS FLOAT) * (1440/@RoundToMin))/(1440/@RoundToMin)
END
GO 
```

# ruby-on-rails - 如何在 rails 3.2.9 引擎中加载 db rake 任务

> ID：13388041
> 
> 赞同：3
> 
> 时间：2012-11-14T21:55:10.800
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2, rake, rake-task, rails-engines

我们正在 3.2.9 上开发 Rails 引擎。引擎是通过以下方式生成的：

```
rails plugin new rails_engine -mountable --skip-test-unit --dummy-path=spec/dummy 
```

初始设置后，我们可以像在常规 Rails 应用程序中那样生成模型：

```
rails g model post name:string 
```

在 db/migrate/ 下创建了一个迁移文件。接下来我们在 /rails_engine 下做了 db:migrate ：

```
rake db:migrate 
```

它会导致错误：

```
Don't know how to build task 'db:migrate' 
```

列出可用的 rake 任务：

```
bundle exec rake --tasks
rake build         # Build test_itemx-0.0.1.gem into the pkg directory
rake clobber_rdoc  # Remove RDoc HTML files
rake install       # Build and install test_itemx-0.0.1.gem into system gems
rake rdoc          # Build RDoc HTML files
rake release       # Create tag v0.0.1 and build and push test_itemx-0.0.1.gem to Rubygems
rake rerdoc        # Rebuild RDoc HTML files 
```

其中没有 db:migrate 。问题是如何将 db 任务加载回 rake。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T16:43:15.620

这是预期的行为。请记住，它是一个**可安装**的引擎。它没有自己的环境。您需要将它安装到 Rails 应用程序（不是引擎，而是实际应用程序）。引擎没有任何数据库。它使用在其挂载的父应用程序中定义的数据库。所以很明显你的 db:migrate 不会工作。

在您的父应用中为引擎执行以下操作：

1.  使用 :path 或 :git 选项将您的引擎作为另一个引擎安装在 rails 应用程序的 Gemfile 中

    gem 'engine_name', :path=>'path/to/engine/directory'

2.  `bundle install`

3.  `rake engine_name:install:migrations`

4.  `rake db:migrate`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-10T16:03:59.047

我在我的引擎文件夹中输入了 spec/dummy 并且刚刚运行了 rake db:migrate plus 相同的测试环境，并添加了 db/schema.rb。但我之前必须手动添加 spec/dummy/db 文件夹。

# javascript - 我需要一个 javascript 来搜索页面中的文本，然后隐藏一个下拉框

> ID：13388043
> 
> 赞同：-2
> 
> 时间：2012-11-14T21:55:12.343
> 
> 标签：javascript, drop-down-menu, full-text-search, show-hide, replace

如果找到“X 特定字符串”，我需要能够隐藏下拉框。关于如何做到这一点的任何想法我将不胜感激。我搜索了隐藏文本框/下拉列表，但找不到通过搜索整个页面使其工作的方法。谢谢

我没有选择任何搜索和隐藏，因为它不起作用。http://stackoverflow.com/questions/6848797/show-hide-drop-down 我已经看到了这个选项。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T23:29:42.200

要从 JavaScript 操作元素，您需要以某种方式获取对它的引用，这可以通过多种方式完成 - 没有任何上下文可以继续我建议您最好的选择是确保您的 select 元素具有`id`属性：

```
<select id="myDropDown" name="whatever">
     <option>One</option>
     <option>Two</option>
</select> 
```

...然后使用`document.getElementById()`. 然后要隐藏它，您可以更新适当的样式属性：

```
document.getElementById("myDropDown").style.display = "none";
// OR
document.getElementById("myDropDown").style.visibility = "hidden"; 
```

Using`display:none`导致浏览器呈现文档，就好像该元素不存在一样，即它不会为它留下空间。使用`visibility:hidden`会使它不可见，但页面上会有一个空白区域。

有不止一种方法可以测试页面上的特定字符串，但一种方法是通过 body 元素的`innerHTML`或`textContent`（或在 IE 中`innerText`）属性获取所有内容，然后使用`.indexOf()`：

```
var searchString = "some string",
    pageContent = document.body.innerHTML;

if (pageContent.indexOf(searchString) != -1) {
   document.getElementById("myDropDown").style.display = "none";
} 
```

放置代码的位置取决于您何时要进行测试。`onload`如果您想在没有用户输入的情况下执行此操作，则可以将其放入处理程序中，否则将其放入单击处理程序或适当的东西中。

演示：http: [//jsfiddle.net/n8uA9/](http://jsfiddle.net/n8uA9/)

# oracle - 用于 Spring 的 Oracle 数据源配置

> ID：13388045
> 
> 赞同：18
> 
> 时间：2012-11-14T21:55:25.120
> 
> 标签：oracle, spring, datasource

在 Spring 框架中，Oracle 数据源是如何配置的？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-11-14T21:55:25.120

在*context.xml*文件中：

```
<bean id="dataSource" class="oracle.jdbc.pool.OracleDataSource">
    <property name="dataSourceName" value="ds"/>
    <property name="URL" value="jdbc:oracle:thin:@<hostname>:<port_num>:<SID>"/>
    <property name="user" value="dummy_user"/>
    <property name="password" value="dummy_pwd"/>
</bean> 
```

**URL 示例：** jdbc:oracle:thin:@abc.def.ghi.com:1234:TEAM4

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2017-11-01T04:38:40.423

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-12-11T17:58:42.407

请注意，您可能需要在上面补充一点，Oracle 驱动程序没有开源许可证，因此它不会位于 Maven 中央存储库中。您必须将其添加到本地存储库中。

为此：从 [http://www.oracle.com/获取所需的驱动程序](http://www.oracle.com/)

或者您可以从您的 oracle 安装中获取它：{ORACLE_HOME}\jdbc\lib\ojdbc6.jar

然后运行以下 maven 命令：

```
mvn install:install-file -Dfile={Path/to/your/ojdbc.jar} -DgroupId=com.oracle -DartifactId=ojdbc6 -Dversion=11.2.0 -Dpackaging=jar 
```

这应该将它安装在您的本地存储库中，因此当您按照上面的 user640378 状态引用它时，它应该可以正常工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-04-17T16:17:59.120

```
<bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource">
    <property name="dataSourceName" value="oracle.jdbc.driver.OracleDriver" />
    <property name="URL" value="jdbc:oracle:thin:@localhost:1521:XE" />
    <property name="username" value="hr" />
    <property name="password" value="hr" />
    <property name="initialSize" value="1" />
    <property name="maxActive" value="5" />
</bean> 
```

# c# - 如何读取/提取 Live SDK 中 GetAsync() 返回的日历条目？

> ID：13388051
> 
> 赞同：0
> 
> 时间：2012-11-14T21:56:12.297
> 
> 标签：c#, .net-4.0, windows-8, calendar, windows-live

我正在尝试获取用户拥有的所有日历。我正在使用的代码是：

```
LiveConnectClient liveClient = new LiveConnectClient( App.Session );
LiveOperationResult operationResult = await liveClient.GetAsync( "me/calendars" );
dynamic result = operationResult.Result; 
```

当使用调试器查看**结果**时，我可以看到日历（键和值）。但是，我在从此 DynamicDictionary 中提取信息时遇到问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T22:10:46.003

它只是一本字典。你应该能够做到：

```
var item = result[key]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T06:37:01.573

我设法解决了这个问题，执行它的代码（带有一些调试消息）如下：

```
try
{
    LiveConnectClient liveClient = new LiveConnectClient( App.Session );
    LiveOperationResult operationResult = await liveClient.GetAsync( "me/calendars" );
    dynamic result = operationResult.Result;

    List<object> data = null;
    IDictionary<string, object> calendar = null;

    string msg = "Calendar names: ";
    Debug.WriteLine( msg );

    if ( operationResult.Result.ContainsKey( "data" ) )
    {
        data = (List<object>)operationResult.Result[ "data" ];
        for ( int i = 0 ; i < data.Count ; i++ )
        {
            calendar = (IDictionary<string, object>)data[ i ];
            if ( calendar.ContainsKey( "name" ) )
            {
                string Name = (string)calendar[ "name" ];
                string ID   = (string)calendar[ "id" ];
                msg = string.Format( "Name = {0}, ID = {1}", Name, ID );
                Debug.WriteLine( msg );
            }
        }
    }
}
catch ( LiveConnectException exception )
{
    Debug.WriteLine( "Error getting calendar info: " + exception.Message );
} 
```

# sql - 从具有日期时间的非常大的表中选择不同的日期（不是时间）

> ID：13388052
> 
> 赞同：0
> 
> 时间：2012-11-14T21:56:14.273
> 
> 标签：sql, sql-server-2005, datetime, group-by, distinct

我有一张大表，我一直在使用查询分析器并寻找最好的方法来做到这一点。

表格是这样的：

```
name         rows        reserved     data         index_size   unused
table_name   110980132   7802944 KB   6119784 KB   1679320 KB   3840 KB 
```

并有这些列：

```
 ID int, time_stamp datetime, value1 float, value2 float, value3 float.... 
```

这些`time_stamps`是带有时间的日期。我需要找到一种简单的方法，而不存储任何东西，以便能够只获取表格的日期部分。最终，我可能只需要知道天 + 小时部分（而不是整个时间部分）。目前，我只需要知道过去 30 天我们拥有的数据是什么（有时此时缺少几天，这个问题/查询最终将不仅仅是寻找最后 x 天，而是所有天，或者任何）。

考虑到性能和时间，最好的方法是什么？我玩过`group by`, `distinct`, `top x`, `rank()`, 临时表、视图……有些东西比其他东西好，但我所做的一切似乎都不是很好。

想法？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T22:41:27.383

```
-- Get the earliest date (without time) you want
DECLARE @smallestDate datetime = DATEADD(DAY, DATEDIFF(DAY, -30, GETDATE()), 0)

-- Select the distinct dates
SELECT DISTINCT DATEADD(DAY, DATEDIFF(DAY, 0, time_stamp), 0) AS [Date]
FROM yourTable
WHERE time_stamp > @smallestDate 
```

这是一些性能比较 [SQL Server 中从日期+时间获取日期的最有效方法？](https://stackoverflow.com/questions/133081/most-efficient-way-in-sql-server-to-get-date-from-datetime)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T22:16:15.697

如果您愿意使用 T-SQL 批处理而不是单个查询，那么您可以使用如下索引：

```
create table #tmp (date datetime primary key clustered);
declare @pivot datetime;
  insert #tmp
  select TOP(1) datediff(d,0,time_stamp)
    from tbl
order by time_stamp desc;
while @@rowcount > 0 and (select count(*) from #tmp) < 30
begin
      insert #tmp
      select TOP(1) datediff(d,0,time_stamp)
        from tbl
       where time_stamp < (select min(date) from #tmp)
    order by time_stamp desc;
end; 
```

所有这一切都需要您在 上建立一个良好的索引`time_stamp`，并且它将在该索引上执行 30 次（或更少）搜索。非常手术和快速。我把它作为一个概念提出来，所以显然可以很容易地优化其中的 2 个标量子查询。

# ruby-on-rails - 这是一个有效的密码确认

> ID：13388057
> 
> 赞同：0
> 
> 时间：2012-11-14T21:56:31.057
> 
> 标签：ruby-on-rails, password-protection

根据 Hardl 在 Ruby on rails 中，您可以根据以下内容编写密码确认，但是我无法使用该系列中的最后一个测试：

```
#IS THIS A VALID TEST?
  describe "when password confirmation is not present" do
    before { @user.Password_confirmation = nil }
    it { should_not be_valid }
  end 
```

所以我的问题是这样做是否有效，我将最后一部分中的 nil 更改为“”，空格，这与针对 nil 进行测试时是否相同？：

```
describe User do
  before { @user = User.new(Address:"Dummy Address",Email: "user@example.com", FirstName:"Jim", LastName:"Beam", Password:"ABC123", Password_confirmation:"ABC123", Phone:"+46000", Username:"ExampleUser", Zip:"22646" ) }

  subject { @user }
  puts "TEST"

  it { should respond_to(:FirstName) }
  it { should respond_to(:LastName) }
  it { should respond_to(:Email) }
  it { should respond_to(:password_digest) }
  it { should respond_to(:Password) }
  it { should respond_to(:Password_confirmation) }
  it { should be_valid }

  describe "when password is not present" do
    before { @user.Password = @user.Password_confirmation = " " }
    it { should_not be_valid }
  end

  describe "when password doesn't match confirmation" do
    before { @user.Password_confirmation = "mismatch" }
    it { should_not be_valid }
  end

  #IS THIS A VALID TEST?
  describe "when password confirmation is not present" do
    before { @user.Password_confirmation = " " }
    it { should_not be_valid }
  end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T22:07:07.473

甚至`"".nil?`返回假。如果您需要测试空白，只需使用`blank?`ActveSupport 提供的方法。

# php - 将 Composer 与本地依赖项一起使用

> ID：13388060
> 
> 赞同：6
> 
> 时间：2012-11-14T21:56:36.867
> 
> 标签：php, composer-php

我因为 Symfony2 而认识 Composer，但现在我想将它用作独立的部分。我按照其文档中的说明进行操作，但不知道如何将本地库设置为依赖项，如何加载它？

换句话说，如何使用 Composer 加载本地存储库而不是引用远程存储库？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T22:27:27.010

我刚刚找到了解决方案！我做的一切都很好，但是输入了我想自动加载的依赖项的命名空间。所以这个问题的答案是

1.  我安装了作曲家：`curl -s https://getcomposer.org/installer | php`
2.  创建了一个文件`composer.json`，然后将以下内容放入其中：

    ```
    {
        "autoload": {
            "psr-0": {
                "MyNamespace":"src/"
            }
        }
    } 
    ```

3.  跑：`php composer.phar install`

4.  包含在 index.php 中`../vendor/autoload.php`

# perl - 使用 perl 严格分割

> ID：13388067
> 
> 赞同：1
> 
> 时间：2012-11-14T21:56:51.710
> 
> 标签：perl, split

在下面的代码中，我试图在两个数字之间进行拆分。拆分功能不正常。例如：当我在 0 和 1 之间拆分时，拆分也发生在 10 和 11 的数字之间。

有人可以帮助我吗？

```
 use strict;
    use warnings;

    my $j= "0,2,3,6,5,1,4,7,8,12,11,10,9";
    my $k=1; my $k1=0,;
    my @ar=split(/($k|$k1)/,$j);

    print join(";",@ar);

    Expected result:0;2,3,6,5;1;4,7,8,12,11,10,9
    Above code result: 0;,2,3,6,5,;1;,4,7,8,;1;2,;1;1;,;1;0;,9 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T22:07:33.167

首先，您不想在 0 或 1 上拆分，您想在数字`0`或旁边的逗号上拆分`1`。

```
split /(?<!\d)(?:0|1)\K,|,(?=(?:0|1)(?!\d))/ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T22:03:06.737

尝试

```
split /(\b$k\b|\b$k1\b)/, $j 
```

`\b`是零宽度字边界分隔符。

# java - 休眠验证失败时出现意外的 UnsupportedOperationException

> ID：13388069
> 
> 赞同：3
> 
> 时间：2012-11-14T21:56:59.700
> 
> 标签：java, hibernate, jpa, bean-validation

为什么我在验证失败时从 Hibernate 收到 UnsupportedOperationException？我希望有一个 ConstraintViolationException。

下面是我的 DAO。当它通过验证时，它工作正常。我正在使用 Hibernate 和 Hibernate Validator 4。我正在使用 Websphere 8.0。我认为 WebSphereExtendedJtaPlatform 是罪魁祸首，但我不知道为什么。

如果我查看应该是 WebSphereExtendedJtaPlatform 的源代码（点击源代码链接），看起来那里的大多数方法只是抛出 UnsupportedOperationException。

[http://grepcode.com/file/repo1.maven.org/maven2/org.hibernate/hibernate-core/4.0.0.CR1/org/hibernate/service/jta/platform/internal/WebSphereExtendedJtaPlatform.java](http://grepcode.com/file/repo1.maven.org/maven2/org.hibernate/hibernate-core/4.0.0.CR1/org/hibernate/service/jta/platform/internal/WebSphereExtendedJtaPlatform.java)

这是我的堆栈跟踪：

```
org.hibernate.AssertionFailure <init> HHH000099: an assertion failure occured (this may indicate a bug in Hibernate, but is more likely due to unsafe use of the session): org.hibernate.AssertionFailure: null id in com.westfieldgrp.beanvalidation.persistence.Car entry (don't flush the Session after an exception occurs)
[11/14/12 16:48:48:785 EST] 00000020 RegisteredSyn E   WTRN0074E: Exception caught from before_completion synchronization operation: java.lang.UnsupportedOperationException
    at org.hibernate.service.jta.platform.internal.WebSphereExtendedJtaPlatform$TransactionManagerAdapter.setRollbackOnly(WebSphereExtendedJtaPlatform.java:139) 
```

我的堆栈跟踪中另一个有趣的片段：

```
Entity manager factory name (src_persistence) is already registered.  If entity manager will be clustered or passivated, specify a unique value for property 'hibernate.ejb.entitymanager_factory_name' 
```

这是课程

```
package com.westfieldgrp.pom.data.dao;

import java.util.ArrayList;
import java.util.Set;

import javax.faces.application.FacesMessage;
import javax.faces.context.FacesContext;
import javax.persistence.EntityManager;
import javax.persistence.EntityManagerFactory;
import javax.persistence.Persistence;
import javax.persistence.RollbackException;
import javax.validation.ConstraintViolation;
import javax.validation.ConstraintViolationException;

import com.westfieldgrp.beanvalidation.persistence.Car;
import com.westfieldgrp.beanvalidation.persistence.Driver;
import com.westfieldgrp.beanvalidation.persistence.Person;

public class CarDAO  {

    private EntityManager entityManager;

    public void save(Person convertedPerson, Driver convertedDriver, Car convertedCar, FacesContext facesContext) throws ConstraintViolationException{
    EntityManager em = getEntityManager();
    //em.setFlushMode(FlushModeType.COMMIT);

    if("test".equals(convertedPerson.getName())){       // To test JPA validation
        convertedPerson.setName(null);
    }
    //Person savedPerson =  em.merge(convertedPerson);
    try {
        //em.merge(convertedPerson);
        em.persist(convertedPerson);
        em.flush();
    } catch (Exception e) {
        System.out.println("*******" + getRootCause(e));
    }
    }

private String getRootCause(Throwable e){
    if(e.getCause() != null){
        return getRootCause(e.getCause());
    } else {
        return e.toString();
    }
}

    public EntityManager getEntityManager() {
            EntityManagerFactory emf = Persistence.createEntityManagerFactory("src_persistence");
            entityManager = emf.createEntityManager();
        return entityManager;
    }

    public void setEntityManager(EntityManager entityManager) {
        this.entityManager = entityManager;
    }
} 
```

个人实体：

```
package com.westfieldgrp.beanvalidation.persistence;

import java.io.Serializable;

import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;
import javax.persistence.Table;
import javax.validation.constraints.NotNull;
import javax.validation.constraints.Pattern;
import org.hibernate.validator.constraints.Length;

/**
 * The persistent class for the PERSON database table.
 * 
 */
@Entity
@Table(name="PERSON")
public class Person implements Serializable {
    private static final long serialVersionUID = 1L;

    @Id
    @GeneratedValue(strategy=GenerationType.AUTO)
    @Column(name="PERSON_ID")
    private int personId;

    @Column(name="NAME")
    @NotNull(message = "A name is required.")
    //@Length(min = 5, message = "Need a longer name.")
    private String name;

    @Column(name="EMAIL")
    @NotNull(message = "An email is required.")
    //@Pattern(regexp="[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?", message="Invalid email format.")
    private String email;

    public Person() {
    }

    public int getPersonId() {
        return this.personId;
    }

    public void setPersonId(int personId) {
        this.personId = personId;
    }

    public String getName() {
        return this.name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public void setEmail(String email) {
        this.email = email;
    }

    public String getEmail() {
        return email;
    }

} 
```

整个堆栈跟踪：

```
[11/14/12 19:00:53:202 EST] 0000003c EntityManager Z org.hibernate.ejb.internal.EntityManagerFactoryRegistry addEntityManagerFactory HHH000436: Entity manager factory name (src_persistence) is already registered.  If entity manager will be clustered or passivated, specify a unique value for property 'hibernate.ejb.entitymanager_factory_name'
[11/14/12 19:00:53:214 EST] 0000003c SystemOut     O *******java.lang.UnsupportedOperationException
[11/14/12 19:00:53:214 EST] 0000003c AssertionFail Z org.hibernate.AssertionFailure <init> HHH000099: an assertion failure occured (this may indicate a bug in Hibernate, but is more likely due to unsafe use of the session): org.hibernate.AssertionFailure: null id in com.westfieldgrp.beanvalidation.persistence.Person entry (don't flush the Session after an exception occurs)
[11/14/12 19:00:53:215 EST] 0000003c RegisteredSyn E   WTRN0074E: Exception caught from before_completion synchronization operation: java.lang.UnsupportedOperationException
    at org.hibernate.service.jta.platform.internal.WebSphereExtendedJtaPlatform$TransactionManagerAdapter.setRollbackOnly(WebSphereExtendedJtaPlatform.java:139)
    at org.hibernate.engine.transaction.internal.jta.CMTTransaction.markRollbackOnly(CMTTransaction.java:131)
    at org.hibernate.engine.transaction.internal.TransactionCoordinatorImpl.setRollbackOnly(TransactionCoordinatorImpl.java:305)
    at org.hibernate.engine.transaction.synchronization.internal.SynchronizationCallbackCoordinatorImpl.setRollbackOnly(SynchronizationCallbackCoordinatorImpl.java:118)
    at org.hibernate.engine.transaction.synchronization.internal.SynchronizationCallbackCoordinatorImpl.beforeCompletion(SynchronizationCallbackCoordinatorImpl.java:108)
    at org.hibernate.engine.transaction.synchronization.internal.RegisteredSynchronization.beforeCompletion(RegisteredSynchronization.java:53)
    at org.hibernate.service.jta.platform.internal.WebSphereExtendedJtaPlatform$TransactionManagerAdapter$TransactionAdapter$1.invoke(WebSphereExtendedJtaPlatform.java:176)
    at $Proxy56.beforeCompletion(Unknown Source)
    at com.ibm.ws.jtaextensions.SynchronizationCallbackWrapper.beforeCompletion(SynchronizationCallbackWrapper.java:66)
    at com.ibm.tx.jta.impl.RegisteredSyncs.coreDistributeBefore(RegisteredSyncs.java:291)
    at com.ibm.ws.tx.jta.RegisteredSyncs.distributeBefore(RegisteredSyncs.java:152)
    at com.ibm.ws.tx.jta.TransactionImpl.prePrepare(TransactionImpl.java:2332)
    at com.ibm.ws.tx.jta.TransactionImpl.stage1CommitProcessing(TransactionImpl.java:553)
    at com.ibm.tx.jta.impl.TransactionImpl.processCommit(TransactionImpl.java:1014)
    at com.ibm.tx.jta.impl.TransactionImpl.commit(TransactionImpl.java:948)
    at com.ibm.ws.tx.jta.TranManagerImpl.commit(TranManagerImpl.java:379)
    at com.ibm.tx.jta.impl.TranManagerSet.commit(TranManagerSet.java:181)
    at com.ibm.ejs.csi.TranStrategy.commit(TranStrategy.java:922)
    at com.ibm.ejs.csi.TranStrategy.postInvoke(TranStrategy.java:234)
    at com.ibm.ejs.csi.TransactionControlImpl.postInvoke(TransactionControlImpl.java:579)
    at com.ibm.ejs.container.EJSContainer.postInvoke(EJSContainer.java:4755)
    at com.westfieldgrp.ejb.EJSLocalNSLCarSessionBean_f700c086.save(EJSLocalNSLCarSessionBean_f700c086.java)
    at com.westfieldgrp.beans.CarBean.processCar(CarBean.java:35)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:60)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)
    at java.lang.reflect.Method.invoke(Method.java:611)
    at org.apache.el.parser.AstValue.invoke(AstValue.java:262)
    at org.apache.el.MethodExpressionImpl.invoke(MethodExpressionImpl.java:278)
    at org.apache.myfaces.view.facelets.el.TagMethodExpression.invoke(TagMethodExpression.java:83)
    at javax.faces.component._MethodExpressionToMethodBinding.invoke(_MethodExpressionToMethodBinding.java:88)
    at org.apache.myfaces.application.ActionListenerImpl.processAction(ActionListenerImpl.java:100)
    at javax.faces.component.UICommand.broadcast(UICommand.java:120)
    at javax.faces.component.UIViewRoot._broadcastAll(UIViewRoot.java:973)
    at javax.faces.component.UIViewRoot.broadcastEvents(UIViewRoot.java:275)
    at javax.faces.component.UIViewRoot._process(UIViewRoot.java:1285)
    at javax.faces.component.UIViewRoot.processApplication(UIViewRoot.java:711)
    at org.apache.myfaces.lifecycle.InvokeApplicationExecutor.execute(InvokeApplicationExecutor.java:34)
    at org.apache.myfaces.lifecycle.LifecycleImpl.executePhase(LifecycleImpl.java:171)
    at org.apache.myfaces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:118)
    at javax.faces.webapp.FacesServlet.service(FacesServlet.java:189)
    at com.ibm.ws.webcontainer.servlet.ServletWrapper.service(ServletWrapper.java:1147)
    at com.ibm.ws.webcontainer.servlet.ServletWrapper.handleRequest(ServletWrapper.java:722)
    at com.ibm.ws.webcontainer.servlet.ServletWrapper.handleRequest(ServletWrapper.java:449)
    at com.ibm.ws.webcontainer.servlet.ServletWrapperImpl.handleRequest(ServletWrapperImpl.java:178)
    at com.ibm.ws.webcontainer.filter.WebAppFilterManager.invokeFilters(WebAppFilterManager.java:1020)
    at com.ibm.ws.webcontainer.servlet.CacheServletWrapper.handleRequest(CacheServletWrapper.java:87)
    at com.ibm.ws.webcontainer.WebContainer.handleRequest(WebContainer.java:883)
    at com.ibm.ws.webcontainer.WSWebContainer.handleRequest(WSWebContainer.java:1659)
    at com.ibm.ws.webcontainer.channel.WCChannelLink.ready(WCChannelLink.java:195)
    at com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.handleDiscrimination(HttpInboundLink.java:452)
    at com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.handleNewRequest(HttpInboundLink.java:511)
    at com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.processRequest(HttpInboundLink.java:305)
    at com.ibm.ws.http.channel.inbound.impl.HttpICLReadCallback.complete(HttpICLReadCallback.java:83)
    at com.ibm.ws.tcp.channel.impl.AioReadCompletionListener.futureCompleted(AioReadCompletionListener.java:165)
    at com.ibm.io.async.AbstractAsyncFuture.invokeCallback(AbstractAsyncFuture.java:217)
    at com.ibm.io.async.AsyncChannelFuture.fireCompletionActions(AsyncChannelFuture.java:161)
    at com.ibm.io.async.AsyncFuture.completed(AsyncFuture.java:138)
    at com.ibm.io.async.ResultHandler.complete(ResultHandler.java:204)
    at com.ibm.io.async.ResultHandler.runEventProcessingLoop(ResultHandler.java:775)
    at com.ibm.io.async.ResultHandler$2.run(ResultHandler.java:905)
    at com.ibm.ws.util.ThreadPool$Worker.run(ThreadPool.java:1648) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-18T06:56:49.583

我最终根据以下链接修改了 WebSphereExtendedJtaPlatform 代码。我很困惑为什么这个类基本上没有实现。

[https://forum.hibernate.org/viewtopic.php?f=1&t=992310](https://forum.hibernate.org/viewtopic.php?f=1&t=992310)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-01-14T06:09:25.227

我在 Websphere Liberty 16.0.0.4 上遇到了同样的问题，并通过更改 persistence.xml 解决了这个问题：

```
<property name="hibernate.transaction.jta.platform" value="biz.bitech.hibernate.websphere.WebSphereJtaPlatform" /> 
```

以下类需要与休眠库一起位于类路径中：

```
package biz.bitech.hibernate.websphere;

import javax.transaction.TransactionManager;
import javax.transaction.UserTransaction;

import com.ibm.tx.jta.TransactionManagerFactory;
import com.ibm.tx.jta.UserTransactionFactory;
import org.hibernate.engine.transaction.jta.platform.internal.AbstractJtaPlatform;

public class WebSphereJtaPlatform extends AbstractJtaPlatform {

    @Override
    protected TransactionManager locateTransactionManager() {
        return TransactionManagerFactory.getTransactionManager();
    }

    @Override
    protected UserTransaction locateUserTransaction() {
        return UserTransactionFactory.getUserTransaction();
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-16T07:59:18.840

*您使用getEntityManager()*在每个请求上创建一个新的实体管理器。您应该请求（例如通过依赖注入）应用程序范围的持久性管理器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-04-18T19:58:33.297

下面的代码来自 hibernate-core 4.3.7.FINAL (SynchronizationCallbackCoordinatorNonTrackingImpl)

您将在重新打包和发送异常之前看到对 setRollbackOnly 的调用，对于 WebSphereExtendedJtaPlatform，它只会抛出不受支持的操作异常，这就是您在日志中看到的内容。此时，由于您永远不会到达重新打包运行时异常的地步，因此它会丢失。

但不知何故，hibernate 设法将它记录到标准输出，所以你会在 SystemOut.log 文件中找到你的 SQL 异常

```
@Override
public void beforeCompletion() {
    LOG.trace( "Transaction before completion callback" );

    if ( !transactionCoordinator.isActive() ) {
        return;
    }

    boolean flush;
    try {
        final int status = transactionCoordinator.getTransactionContext().getTransactionEnvironment()
                .getJtaPlatform().getCurrentStatus();
        flush = managedFlushChecker.shouldDoManagedFlush( transactionCoordinator, status );
    }
    catch ( SystemException se ) {
        setRollbackOnly();
        throw exceptionMapper.mapStatusCheckFailure(
                "could not determine transaction status in beforeCompletion()", se );
    }

    try {
        if ( flush ) {
            LOG.trace( "Automatically flushing session" );
            transactionCoordinator.getTransactionContext().managedFlush();
        }
    }
    catch ( RuntimeException re ) {
        setRollbackOnly();
        throw exceptionMapper.mapManagedFlushFailure( "error during managed flush", re );
    }
    finally {
        transactionCoordinator.sendBeforeTransactionCompletionNotifications( null );
        transactionCoordinator.getTransactionContext().beforeTransactionCompletion( null );
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-02-09T16:28:30.190

请注意，您从休眠中收到 HHH000099 错误。这是由于 GeneratedValue 返回 null 并且当 hibernate 进行插入时，它会将 null 传递给您的 PK。

我认为您的 ID 会随表格自动递增。当您将 Generated value 设置为 AUTO/TABLE/IDENTITY 时，Hibernate 会在表中查找该值。如果您保留表格，这应该不是问题。

我有一个类似的问题，我所做的只是将列设为可插入 = false。

希望有帮助。

# c# - 是否可以在 C# 中使用 iTextSharp 修改 PDF 中的专色名称？

> ID：13388079
> 
> 赞同：1
> 
> 时间：2012-11-14T21:57:11.043
> 
> 标签：c#, itextsharp

是否可以在 C# 中使用 iTextSharp 修改 PDF 中的专色名称，它只是需要更改的颜色名称。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-15T13:15:21.960

因此，您有一个使用一些专色的现有 PDF，例如名为“ABC”的颜色，并且您想要操作该 PDF，以便名称为“XYZ”。

这是可能的，但它需要低级别的 PDF 语法操作。

您需要创建一个 PdfReader 实例，查找定义专色的字典，更改名称，然后使用 PdfStamper 基于更改后的 PdfReader 实例创建一个新文件。

没有关于如何回答您的特定问题的“现成”示例（我怀疑其他人，但 iText 的原始开发人员会回答这样的问题），但您可以通过查看第 13 章中的代码示例获得一些灵感《iText in Action》第二版：http: [//itextpdf.com/book/chapter.php ?id=13](http://itextpdf.com/book/chapter.php?id=13)

例如，参见`manipulatePdf()`本示例中的方法：http: [//itextpdf.com/examples/iia.php](http://itextpdf.com/examples/iia.php?id=239) ?id=239 在本示例中，使用上述原理将一个 URL 替换为另一个 URL。

您需要修改此示例，以便找到存储专色名称的位置的路径、更改该名称并保留更改。

提示：专色名称将在一个数组中，其中第一个元素是名称（/Separation），第二个条目将是您要更改的名称（这是您要替换为新`PdfName`实例的名称），等等。

如何找到这个 /Separation 数组？我将遍历页面（该`getPageN()`方法将为您提供页面字典），获取每个页面的资源（`pageDict.getAsDict(PdfName.RESOURCES)`），查找 /Colorspace 字典的存在，然后查找该字典中的所有 /Separation 颜色。每当遇到要更改的名称时，替换第二个元素。

第 13 章中的示例与 ISO-32000-1（可从 Adob​​e.com 站点下载）相结合将引领潮流。

# windows - 批处理文件替换文件中的字符

> ID：13388080
> 
> 赞同：1
> 
> 时间：2012-11-14T21:57:12.370
> 
> 标签：windows, batch-file

我已经有一段时间没有写批处理文件了。我以前曾经玩过它，但现在我需要写一个，我迷路了。谁能帮我一把？我需要编写一个具有以下要求的批处理文件：

*   它将在 Windows 中运行
*   它应该将文件名作为唯一参数
*   它应该只搜索文件中的前 100 个字符，并且应该将出现的两个连续星号替换为`**`一个星号、两个空格和一个最后一个星号`* *`
    *   老的：`The quick brown f**ox jumped over something`
    *   新的：`The quick brown f* *ox jumped over something`
*   文件的新版本应保存为原始文件名加上 .new 到子文件夹
    *   原始文件名`C:\Myfolder\myfile.txt`
    *   新文件名`C:\Myfolder\NewFolder\myfile.txt.new`

任何和所有的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T14:23:54.433

使用`sed`.

GnuWin32包括一个：[http ://gnuwin32.sourceforge.net/](http://gnuwin32.sourceforge.net/)

Git 的 windows 端口也是如此。

以下假设您使用的是 ASCII 文本文件：100 个字节 == 100 个字符。

```
@echo off
set output_file=%input_file%.new
set end_of_header=5
set /a start_of_body=%end_of_header% + 1

head --bytes=%end_of_header% ^
    %input_file% ^
    | sed --expression "s/\*\*/*  */g" ^
    1> %output_file%

tail --bytes=+%start_of_body% ^
    %input_file% ^
    1>> %output_file%

type %input_file% %output_file% 
```

# java - 我们可以使用带有 java.security api（如 KeyPairGenerator 等）的 keytool 来做任何事情吗

> ID：13388087
> 
> 赞同：2
> 
> 时间：2012-11-14T21:57:38.730
> 
> 标签：java, security, api, keytool

我们可以使用带有 java.security api（如 KeyPairGenerator 等）的 keytool 来做任何事情吗？

我有兴趣扩展具有特定有效性的证书。

例如，可以使用 Java 安全 API 完成以下命令运行

> keytool -genkeypair {-alias alias} {-keyalg keyalg} {-keysize keysize} {-sigalg sigalg} [-dname dname] [-keypass keypass] {-validity valDays} {-storetype storetype}

我只想使用 java 核心安全 API，对第三方 API 不感兴趣

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T22:22:42.947

大多数操作`keytool`（至少我知道的操作）可以使用`java.security.*`带有一些附加实用程序类的类来重新创建，例如，创建一对可以使用的新密钥：

```
private static final String ALGORITHM = "RSA";
private static final String PROVIDER = "BC";

private PrivateKey privateKey;
private PublicKey publicKey;

...

public void generateNewKeyPair() {
    try {
        KeyPairGenerator keyGen = KeyPairGenerator.getInstance(ALGORITHM, PROVIDER);
        keyGen.initialize(2048, new SecureRandom());
        KeyPair keypair = keyGen.genKeyPair();
        privateKey = keypair.getPrivate();
        publicKey = keypair.getPublic();
    } catch (Exception e) {
        LOG.error("Error creating keyPair", e);
    }
} 
```

这是从 a[中检索](http://www.java2s.com/Tutorial/Java/0490__Security/RetrievingaKeyPairfromaKeyStore.htm)a的示例`KeyPair``KeyStore`

这是一个（更详细的）[示例](http://www.java2s.com/Tutorial/Java/0490__Security/Createsa1024bitRSAkeypairandstoresittothefilesystemastwofiles.htm)，它不仅创建`KeyPair`，而且将其存储在文件中

您还可以将`KeyPair`过期时间戳旁边序列化为[SealedObject](http://docs.oracle.com/javase/1.4.2/docs/api/javax/crypto/SealedObject.html)以模拟`validity`由`keytool`

**编辑：** [SealedObject](http://docs.oracle.com/javase/1.4.2/docs/api/javax/crypto/SealedObject.html)单独不会给你`validity`参数模拟，是与密钥对一起存储的时间戳（在 a 中`SealedObject`），它将“模拟”到期日期（可以看作是密钥的有效性）。例如：

```
class KeyWithExpiration {
    private PublicKey publicKey;
    private Date expirationDate;
}

public static void serializeEncrypted(File file, Serializable instance) {
   // With these lines, I hope to expose some of the craft that is needed to work with the API 
   PBEKeySpec keySpecObj = new PBEKeySpec(PASSWORD, SALT, ITERATIONS);
   Cipher ecipherObj = Cipher.getInstance(keyObj.getAlgorithm());
   SecretKeyFactory secretKeyFactory = SecretKeyFactory.getInstance(ALGORITHM);
   SecretKey keyObj = secretKeyFactory.generateSecret(keySpecObj);

   SealedObject sealedObject = new SealedObject(instance, ecipherObj);

   ObjectOutputStream objOutputStream = new ObjectOutputStream(new FileOutputStream(file));
   objOutputStream.writeObject(sealedObject);
   objOutputStream.close();
}

// Generate a new KeyWithExpiration 
KeyWithExpiration key = new KeyWithExpiration(keyPair, DateUtil.future().days(365));
serializeEncrypted(new File(".key"), key); 
```

这就是为什么需要 API 和一些实用程序类来实现由`keytool`

# unity3d - Unity - 如何用初始属性（如速度）实例化新对象？

> ID：13388094
> 
> 赞同：0
> 
> 时间：2012-11-14T21:58:43.330
> 
> 标签：unity3d, instantiation

我正在尝试在 Unity 中实现塔防游戏，但我不知道如何将速度或力分配给新的实例化对象（在创建者对象的脚本中）我有一个应该射击的塔一颗子弹射向敌人，触发了它的对撞机。这是塔的脚本：

```
function OnTriggerEnter(other:Collider){
if(other.name=="Enemy")
{
ShootBulletTo(other.transform);
}
}

function ShootBulletTo(target:Transform)
{//public var Bullet:Transform
var BulletClone = Instantiate(Bullet,transform.position, Quaternion.identity); // ok
BulletClone.AddForce(target.position); //does not compile since Transform.AddForce() does not exist.
} 
```

我想问题是我必须使用一个`Transform`变量来实例化，但我需要一个`GameObject`速度、力等变量。那么我怎样才能用初始速度实例化子弹呢？感谢帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T12:22:31.590

您必须访问子弹克隆的刚体组件才能更改力，而不是变换。

这是您的代码的外观：

```
function OnTriggerEnter(other:Collider)
{
    if(other.name=="Enemy")
    {
       ShootBulletTo(other.transform);
    }
}

function ShootBulletTo(target:Transform)
{
    var Bullet : Rigidbody;
    BulletClone = Instantiate(Bullet, transform.position, Quaternion.identity);

    BulletClone.AddForce(target.position); 
} 
```

在统一脚本参考 [http://docs.unity3d.com/Documentation/ScriptReference/Object.Instantiate.html中也有一个很好的例子](http://docs.unity3d.com/Documentation/ScriptReference/Object.Instantiate.html)

[编辑] 我很确定，您不想将敌人的位置添加为力量，而是应该添加一个朝向敌人位置的方向。您减去两个位置以获得它们之间的方向向量，因此 ShootBulletTo 函数应如下所示：

```
function ShootBulletTo(target:Transform)
{
    // Calculate shoot direction
    var direction : Vector3;
    direction = (target.position - transform.position).normalized;

    // Instantiate the bullet
    var Bullet : Rigidbody;
    BulletClone = Instantiate(Bullet, transform.position, Quaternion.identity);

    // Add force to our bullet
    BulletClone.AddForce(direction); 
} 
```

# windows - 如何注册内核模式加密提供程序

> ID：13388098
> 
> 赞同：5
> 
> 时间：2012-11-14T21:58:56.780
> 
> 标签：windows, cryptography, kernel, driver, registration

我是 Windows 驱动程序开发的新手。最近我正在使用WDK开发一个测试内核模型驱动程序。我基本上是按照微软提供的示例——KernelModeProviderSample，但是，为了使用这个提供程序，我需要在系统中注册它，但我不知道该怎么做？对此有何建议？谢谢。

# iphone - 删除特定对象的自动布局约束

> ID：13388104
> 
> 赞同：51
> 
> 时间：2012-11-14T21:59:30.423
> 
> 标签：iphone, uiview, uiimageview, autolayout

我有一个`UIImageView`嵌入在`UIView`. 我的整个应用程序都使用，`AutoLayout`但我想删除`constraints`. 不允许我删除，有没有办法为特定对象禁用它们，将它们设置为零，什么？`UIImageView``Xcode``constraints`

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2013-06-21T09:54:53.890

我同意如果你想要一些特别的东西，Xcode 自动布局会很糟糕......

我用来以编程方式删除约束的方法：

```
[detailsPhotoView removeConstraints:detailsPhotoView.constraints]; 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2013-11-14T00:50:57.023

在 XCode 5 中，编辑约束时有一个选项“在构建时删除”。如果启用此功能，则在运行时将自动删除约束。如果您不想要特定的约束，该选项可以让 Interface Builder 满意。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-11-24T12:54:33.127

这里有两个不同的问题：

1.  如何使用 Xcode 设置没有约束的 UIImageView
2.  当 UIImageView 的布局由约束处理时，如何允许平移和/或调整其大小。

关于（1），jturton 是正确的。只要您在 Xcode 中启用了自动布局，Xcode 就会保证/要求有足够的约束来唯一地确定视图的大小和位置。

如果您没有在 Xcode 中手动指定足够的约束（通过布局检查器中以蓝色显示的“用户约束”），那么 Xcode 将添加它猜测的新约束（以紫色显示），直到有足够的约束来确定布局。

如果 UIImageView 没有约束，它的布局将无法确定，所以你不能在 Xcode 中设置它。要解决此问题，您应该使用 Xcode 将 IBOutlets 设置为要删除的所有约束，然后在 UIView 的 awakeFromNib: 或 UIViewController 的 viewDidLoad: 中通过调用 removeConstraints: 手动删除约束。

但是，现在您的 UIImageView 的布局尚未确定。因此，此时您将需要手动添加新的约束，以允许您移动和调整 UIImageView 的大小，这将我们带入问题 (2)。

关于（2），如何调整和移动布局由约束决定的视图，答案是像往常一样设置手势识别器来检测捏和平移手势，而不是那些调用 setFrame: 的手势识别器来修改视图，他们应该修改`constant`确定 UIImageView 框架的 NSLayoutConstraint 的参数，然后调用 layoutIfNeeded:，这将导致布局系统立即将修改后的约束转换为新框架。

因此，例如，假设您想使用一组布局约束来操作 UIImageView，这些约束与熟悉的 setFrame: 调用非常相似。在这种情况下，在移除 Xcode 设置的约束后，您可以向视图添加约束，指定其宽度、高度以及父视图顶部和左侧的空间。然后，您的平移手势识别器的动作处理程序将只更新起搏器手势识别器的常量参数，而您的捏合手势识别器可以只更新高度和宽度约束的常量参数。

做 (2) 的另一种方法是设置`translatesAutoresizingMaskIntoConstraints=YES`. 这将做两件事。它将导致自动布局系统根据视图的 autoresizingMask 在视图的父视图中自动生成约束。第二——至关重要！– 它将导致布局系统自动将对 setFrame: 的调用转换为对这些约束的修改。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-11-17T07:55:40.583

你*不能*没有约束——你必须有足够的约束来明确地调整每个视图的大小和位置

您*可以*创建使用 Autolayout 布局的可调整大小的视图。

例如，在您的情况下，您可以创建定位约束 - 例如，将图像视图的中心水平和垂直固定在其父视图的中心。

您还可以在水平和垂直方向上创建尺寸限制。[请在此处](https://stackoverflow.com/questions/13418834/ios-simple-autolayout-with-1-label-and-3-buttons/13422791#13422791)查看我的答案，了解如何执行此操作。为这两个约束创建出口（如果使用界面生成器）。您可以有特定数字的高度和宽度约束，或者使用乘数来制作固定的纵横比。

针对捏合手势，可以调整`.constant`两个大小约束的属性，调用`setNeedsLayout`. 这将调整您的图像视图的大小，同时保持其中心固定。

如果您执行上述固定纵横比建议，则使用约束调整视图大小实际上比设置框架要简单得多。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2014-11-20T20:50:21.717

你可以打电话

```
[yourElement removeFromSuperview]; 
```

然后打电话

```
[yourSuperview addSubview:yourElement]; 
```

删除所有约束`yourElement`并将其添加回视图。

值得一提的是，如果您在 UIView 类别或扩展等上执行上述操作，则需要在从超级视图中删除之前保存对视图超级视图的引用：

```
var theSuperview = self.superview
self.removeFromSuperview()
theSuperview?.addSubview(self) 
```

您可能还需要使 yourElement 强而不是弱，因为从超级视图中删除可能会导致您丢失对它的引用。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2015-01-29T17:57:16.557

如果您只是想从层次结构中删除视图，只需调用`[theView removeFromSuperview]`. 任何影响它的约束也将被删除。

但是，有时您可能还想放回视图，**暂时**将其删除。

为了实现这一点，我在`UIView`. 它将视图层次结构从一个视图向上`v`移动到某个最终容器视图`c`（通常是您的视图控制器的根视图），并删除`v`. 这些是与 的兄弟姐妹的约束`v`，而不是仅影响`v`的孩子的约束。你可以隐藏`v`。

```
-(NSArray*) stealExternalConstraintsUpToView: (UIView*) superview
{
    NSMutableArray *const constraints = [NSMutableArray new];

    UIView *searchView = self;
    while(searchView.superview && searchView!= superview)
    {
        searchView = searchView.superview;

        NSArray *const affectingConstraints =
        [searchView.constraints filteredArrayUsingPredicate:
         [NSPredicate predicateWithBlock:^BOOL(NSLayoutConstraint *constraint, NSDictionary *bindings)
          {
              return constraint.firstItem == self || constraint.secondItem == self;
          }]];

        [searchView removeConstraints: affectingConstraints];
        [constraints addObjectsFromArray: affectingConstraints];
    }

    return constraints;
} 
```

该方法将删除的约束传回一个数组中，您可以将其保留在某个地方，以便稍后您可以添加回约束。

使用它有点像这样......</p>

```
NSArray *const removedConstraints = [viewToHide stealExternalConstraintsUpToView: self.view];
[viewToHide setHidden: YES]; 
```

稍后，将约束放回去。

从 iOS 8 开始，您无需考虑应该将约束放在哪里。就用这个……</p>

```
[NSLayoutConstraint activateConstraints: removedConstraints];
[viewToHide setHidden: NO]; 
```

使用早期版本的 iOS，您无需考虑在哪里添加约束。然后扔进控制器的`self.view`. 如果约束在它们影响的所有视图的超级视图中，它们就会起作用**。**

```
[self.view addConstraints: removedConstraints];
[viewToHide setHidden: NO]; 
```

# php - 对 Twitter API 进行身份验证

> ID：13388106
> 
> 赞同：1
> 
> 时间：2012-11-14T21:59:32.703
> 
> 标签：php, twitter

总而言之，我一直在达到速率限制。我只是想从我自己的时间线中提取最新状态。我正在使用以下代码来实现这一点：

```
$url = "https://api.twitter.com/1/statuses/user_timeline.json?screen_name={$username}&count={$how_many}";
$curl = curl_init();
curl_setopt( $curl, CURLOPT_URL, $url );
curl_setopt( $curl, CURLOPT_RETURNTRANSFER, 1 );
$contents = curl_exec( $curl );
curl_close( $curl );
if ( ! empty( $contents ) ) {
    // Decode it.
    $tweet = json_decode( $contents );
    // Cache it for next time.
    set_transient( $id.'-'.$username, $tweet, 60*60*12 ); // 3 hour cache
} 
```

这工作正常，但我一直达到每小时 150 个请求的速率限制。我已经读过，如果我对 API 进行身份验证，则会取消速率限制。谁能解释如何做到这一点？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T22:28:54.973

您是否需要超过每 4 分钟刷新一次您的状态？我猜不是，您实际上在代码中设置了 3 小时缓存，那么为什么不使用它呢？

```
if(get_transient($id.'-'.$username) === false) {
    $url = "https://api.twitter.com/1/statuses/user_timeline.json?screen_name={$username}&
    count={$how_many}";
    $curl = curl_init();
    curl_setopt( $curl, CURLOPT_URL, $url );
    curl_setopt( $curl, CURLOPT_RETURNTRANSFER, 1 );
    $contents = curl_exec( $curl );
    curl_close( $curl );
    if ( ! empty( $contents ) ) {
        // Decode it.
        $tweet = json_decode( $contents );
        // Cache it for next time.
        set_transient( $id.'-'.$username, $tweet, 60*60*12 ); // 3 hour cache
    }
} 
```

显然，如果需要，您可以减少缓存的持续时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T22:09:01.247

Twitter REST API 的费率与您所说的完全相同 - 未经身份验证的请求（按 IP 地址）为 150，Oauth 身份验证请求为 350。我过去所做的是查看您的查询，并使用 Search API - 进行更有效的调用。或者，从不同的虚拟 IP 地址执行更多呼叫。

来自[https://dev.twitter.com/docs/rate-limiting#rest](https://dev.twitter.com/docs/rate-limiting#rest) 未经身份验证的呼叫允许每小时 150 个请求。未经身份验证的呼叫是根据发出请求的服务器或设备的面向公众的 IP 来衡量的。OAuth 调用每小时允许 350 个请求，并根据请求中使用的 oauth_token 进行测量。

您不能被列入白名单。这是一个支持它的[链接](https://dev.twitter.com/docs/rate-limiting#rest)。

有关直接来自 twitter 的 PHP 示例，请在[此处](https://dev.twitter.com/docs/auth/oauth/single-user-with-examples)尝试并查看 PHP twitter 库。本质上，您必须通过设置 Twitter 应用程序并接收 Oauth 密钥和秘密来建立 Oauth 连接。

# node.js - 独立的 Node.js 应用程序

> ID：13388108
> 
> 赞同：70
> 
> 时间：2012-11-14T21:59:42.967
> 
> 标签：node.js

我正在考虑开发一个由两部分组成的桌面应用程序：

*   用户界面（例如 Java 应用程序）
*   后端 Node.js 服务器

两部分通过插座连接。不要问我为什么知道这很奇怪。

我希望能够通过安装程序向客户提供应用程序。我不希望用户必须自己安装 Node.js。

有没有办法将 Node.js 服务器安装为独立的，即无需在系统上全局安装 Node.js。

**这是任何（Windows、Linux、Mac OS X...）环境的问题。**

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2013-09-09T17:09:30.927

**2017-05-04 更新**：镇上有一个新孩子：

*   [PKG（按时代）](https://www.npmjs.com/package/pkg)

**2016-11-14 更新**：如今 Electron 和 nwjs 似乎是最好的选择。

*   [电子](https://medium.com/developers-writing/building-a-desktop-application-with-electron-204203eeb658#.ua40dkt4c)
*   [nwjs-builder](https://github.com/nwjs/nw-builder)

**原文**：

创建安装程序需要执行多个步骤，并且每个操作系统的安装程序都不同。例如：

*   在 Mac OS X 上，您需要创建一个`.pkg`，这里有关于如何执行此操作的说明：[https ://coolaj86.com/articles/how-to-create-an-osx-pkg-installer.html](https://coolaj86.com/articles/how-to-create-an-osx-pkg-installer.html)
*   在 Ubuntu Linux 上，您需要创建一个`.deb`，这里有关于如何执行此操作的说明：[https ://coolaj86.com/articles/how-to-create-a-debian-installer.html](https://coolaj86.com/articles/how-to-create-a-debian-installer.html)
*   在 Microsoft Windows 上，您需要创建一个`.exe`or `.msi`，这里有关于如何使用 innosetup 安装程序的说明：[https ://coolaj86.com/articles/how-to-create-an-innosetup-installer.html](https://coolaj86.com/articles/how-to-create-an-innosetup-installer.html)

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-11-15T03:07:48.863

您可以将二进制文件与您的应用程序捆绑在一起。无需安装任何东西即可运行 Node 应用程序。二进制文件与安装程序在同一页面上[可用。](http://nodejs.org/download/)

你只需要知道二进制文件在哪里，但我假设你有一个安装程序可以将它们放在已知的地方。

```
// To start the node process
$ /path/to/binaries/npm install
$ /path/to/binaries/node myApp.js 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-11-14T23:50:39.307

[Node-Webkit](https://github.com/rogerwang/node-webkit)是一个选项，但它实际上并没有设置为执行“服务器 - 客户端”类型的关系。

另一种选择是将 node.js 安装程序与您的应用程序安装程序一起打包。然后，当应用程序启动时，您可以启动 node.js 进程。我知道一些开发人员一直在用钛做这件事，这里有一些更多的信息[信息](http://developer.appcelerator.com/blog/2011/06/titanium-desktop-node-js-prototype.html)。

希望这可以帮助！

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-11-14T22:13:35.717

这是一个选项：[Light Table](http://www.lighttable.com/)是一个节点应用程序，但安装得很好，并且在大多数操作系统上干净地集成了 GUI（webkit）。

为此，它利用了[node-webkit](https://github.com/rogerwang/node-webkit)。（直接从 html 页面运行节点代码。）这是[打包文档](https://github.com/rogerwang/node-webkit/wiki/How-to-package-and-distribute-your-apps)。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-12-06T11:11:26.033

值得一提的是 GitHub 制作的[Electron 。](http://electron.atom.io/)用于构建 Atom、Slack、Visual Studio Code 等。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-06-04T12:16:44.947

我刚刚偶然发现了[nexe——](https://github.com/crcn/nexe)一个“从你的 node.js 应用程序中创建单个可执行文件”的工具。

我还没有尝试过，但我想即使没有安装程序也可以工作——只生成一个独立的二进制文件。

# django - 即使使用模板过滤器，Django模板也不会呈现日期

> ID：13388115
> 
> 赞同：0
> 
> 时间：2012-11-14T21:59:55.917
> 
> 标签：django, django-templates

我确定我错过了一些简单的东西，但我无法弄清楚它是什么。我有一个模型，EntryDate：

```
class EntryDate(models.Model):
    dateWorked = models.DateTimeField('date worked')
    employeeid = models.IntegerField() 
```

然后我尝试在模板中呈现 dateWorked 字段，如下所示：

```
 {% for ed in entryDates %}
        <li class="entryDate">
            {{ ed.employeeid }} | {{ ed.dateWorked|date:"SHORT_DATE_FORMAT" }}
        </li>
    {% endfor %} 
```

我得到的是“employeeid |”，或者真实数据“12345 |”。我已经检查了 sqlite 并且模型中有一个日期（显然，这是一个必填字段）。为什么我的日期时间模型字段不会在模板中呈现？我正在使用 Django 1.4

更新：外壳证明是有用的:-)。我收到一个 DateTimeField 收到一个天真的日期时间警告，当我查询对象 dateWorked 字段时，它返回 None。我真的不需要时区支持，但为什么它会返回 None？如何解决 sqlite 中的有效日期时间作为 None 返回给 django 的问题？

# android - OpenGL 性能不佳（qt 移植到 android）

> ID：13388119
> 
> 赞同：1
> 
> 时间：2012-11-14T22:00:26.617
> 
> 标签：android, c++, qt, qt-necessitas

需要将 Qt 移植到 Android

我开发了经典游戏 Break The Wall 的克隆。到目前为止，我一直使用 QPainter 和 QPixmaps 进行绘图。最近我已将绘图切换到 OpenGL。虽然我一直在使用原生绘画，但性能下降了大约 5 倍。所以，如果有人知道任何类似的问题，请让我现在。

规格：所有游戏（大约 3000 行代码）都是用 C4droid IDE（来自 google play）在智能手机 HTC Desire 上编写的。欲望根深蒂固，具有温和野生氰模式 5.0。我没有在模拟器或其他任何东西上测试过，所以问题可能与手机有关。

我会很感激任何需要 OpenGL 的经验（无论是在 PC 上还是在手机上开发）。

最后一件事，我有 fps 计数器，它在 game_loop 中计算出非常好的结果，但绘图非常抽搐。

谢谢

# .net - 无需配置文件即可访问 ASMX Web 服务，在环境之间切换

> ID：13388126
> 
> 赞同：2
> 
> 时间：2012-11-14T22:00:48.277
> 
> 标签：.net, web-services, vb6, .net-2.0, asmx

在几台运行 Windows 2000 的客户端 PC 上，我只能使用 .Net 2.0。（它们运行的​​其他专有软件在任何其他操作系统上都会失败）

我希望能够从一个 .net DLL 访问一些 web 服务，该 DLL 是从一个 VB6 DLL 调用的，该 DLL 由（等待它）调用......一个 COBOL 应用程序。（我完全清楚这是一个次优环境）。我的理解是在这种情况下我无法访问配置文件。我还希望能够在环境之间切换。

我希望能够创建 2.0 网络服务并在代码中对其进行配置。我一直在通过谷歌搜索，但我能找到的只是 WCF 服务示例。

这可能吗？你有代码吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T15:12:48.880

事实证明，Framework 2.0 Web 服务（在 Visual Studio 2010 中）甚至不需要配置文件。当您创建 Web 引用时，它会烘焙所有内容。您可以在 Web 配置中注释掉整个 system.serviceModel 部分，它会运行良好（使用默认值）。然后，您可以设置 URL。

```
 Friend Shared Function CreateContractsServiceInstance(UseLive As Boolean) As ContractsService.ContractsWebService

    Dim client As New ContractsService.ContractsWebService()

    If UseLive Then
        client.Url = "http://xxx/livecontracting/WebService.asmx"
    Else
        client.Url = "http://xxx/contractstest/WebService.asmx"
    End If

    Return client

End Function 
```

# c# - 如何使用画布或窗口上的 mousedown 事件在 WPF 中为图像设置动画

> ID：13388132
> 
> 赞同：2
> 
> 时间：2012-11-14T22:01:25.403
> 
> 标签：c#, wpf, image, mouseevent, animated

我有一个带有使用 WPF 和 C# 的画布的窗口。在画布上我有一个图像。我想将 mousedown 事件应用于窗口或画布，该事件将根据单击的鼠标按钮向左或向右动画图像。鼠标左键应移动图像左键和鼠标右键应将图像向右移动。当按钮不再按下时，运动应该停止。我已经使用计时器在 winforms 中完成了此操作，但我刚刚开始使用 WPF，我似乎找不到任何鼠标触发动画的示例。任何人都可以帮助 WPF 新手吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T00:12:14.940

这通常通过在 EventTriggers 上启动 Storyboard 来完成：

```
<Canvas Background="White">
    <Canvas.Resources>
        <Storyboard x:Key="MoveLeft" TargetName="imageView" TargetProperty="(Canvas.Left)">
            <DoubleAnimation To="50" Duration="0:0:0.25"/>
        </Storyboard>
        <Storyboard x:Key="MoveRight" TargetName="imageView" TargetProperty="(Canvas.Left)">
            <DoubleAnimation To="250" Duration="0:0:0.25"/>
        </Storyboard>
        <Storyboard x:Key="Restore" TargetName="imageView" TargetProperty="(Canvas.Left)">
            <DoubleAnimation To="150" Duration="0:0:0.25"/>
        </Storyboard>
    </Canvas.Resources>

    <Canvas.Triggers>
        <EventTrigger RoutedEvent="Image.MouseLeftButtonDown">
            <BeginStoryboard Storyboard="{StaticResource MoveLeft}"/>
        </EventTrigger>
        <EventTrigger RoutedEvent="Image.MouseRightButtonDown">
            <BeginStoryboard Storyboard="{StaticResource MoveRight}"/>
        </EventTrigger>
        <EventTrigger RoutedEvent="Image.MouseRightButtonUp">
            <BeginStoryboard Storyboard="{StaticResource Restore}"/>
        </EventTrigger>
        <EventTrigger RoutedEvent="Image.MouseLeftButtonUp">
            <BeginStoryboard Storyboard="{StaticResource Restore}"/>
        </EventTrigger>
    </Canvas.Triggers>

    <Image Width="200" Canvas.Left="150" Canvas.Top="90" x:Name="imageView" Source="floppydisk.jpg"/>
</Canvas> 
```

# sql-server-2008 - 基于多值参数多次显示子报表

> ID：13388139
> 
> 赞同：1
> 
> 时间：2012-11-14T22:02:17.113
> 
> 标签：sql-server-2008, reporting-services, ssrs-2008, reporting, sql-server-data-tools

我有一份报告显示一个或多个商店的汇总销售数据。可以通过用于过滤共享数据集的多值参数 (shopID) 来选择商店。参数 shopid 由共享数据集 shop 填充

此报告包含一个子报告，显示每个商店的详细信息。子报表有一个单值参数 (shopID)，用于过滤子报表中的共享数据集。

现在，当我像这样链接子报告时：

```
Parameters Tab on Properties page of the subreport:
Name = shopID  Value = Fields!shopid.Value 
```

*为数据集中的每个 shopid*显示子报表。但我希望为*参数 shopID 中的每个 shopID*显示子报告。我认为使用参数作为值就足够了，如下所示：

```
Parameters Tab on Properties page of the subreport:
Name = shopID  Value = Parameters!LaagID.Value 
```

但是后来我只得到了返回参数中的第一家商店。我得到的子报告显示第一家商店的次数与商店的数量一样......如果我使用

```
Parameters Tab on Properties page of the subreport:
Name = shopID  Value = Parameters!LaagID.Value(1) 
```

我看到（惊喜，惊喜）第二家商店的次数与商店数量一样多......

我尝试过拆分、连接等各种操作，但对于我的一生，我无法找到如何在参数 shopid 中为每个商店显示一次子报表。

建议？请问漂亮吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T20:23:51.537

似乎您可以通过另一个数据集运行参数，该数据集将仅返回选定的 shopIds（这是将参数转换为可以由数据区域处理的东西）查询可能看起来像`Select shopId where shopId in (@shopId)`

# ios - 如何更改 Grouped UITableView 中 UITableView 部分的边框颜色/大小？

> ID：13388144
> 
> 赞同：0
> 
> 时间：2012-11-14T22:02:29.563
> 
> 标签：ios, uitableview

我需要在IOS的Grouped TableView中更改每个部分的边框颜色和大小。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T05:39:26.213

你可以看到[PrettyKit](https://github.com/vicpenap/PrettyKit) =>PrettyTableViewCell

# ajax - 如何使用 JSF 检测表单中的渲染事件？

> ID：13388153
> 
> 赞同：3
> 
> 时间：2012-11-14T22:03:04.397
> 
> 标签：ajax, jsf

考虑 JSF 页面中的以下形式：

```
<h:form id="countForm">
  <h:outputText value="#{myBean.count}" />
  <h:commandButton value="Increment the count!">
    <f:ajax listener="#{myBean.increment()}" render="@form" />
  </h:commandButton>
</h:form> 
```

每当用户通过 ajax 请求单击按钮时，这个简单的代码都会增加计数器。

假设我还想在表单更新（重新呈现）时向用户显示通知计数器的新值的警报。我该怎么做？有没有类似下面的代码？

```
<h:form onUpdate="alert('the new value is #{myBean.count()}')"> 
```

我知道我可以使用 primefaces 的“oncomplete”方法，但事件将链接到按钮而不是表单，这不是我想要的。

计数器不是我想要做的，这只是一个简单的例子来更好地展示我的问题。

预先感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T04:04:03.833

由于您的确切要求不清楚，因此很难提供准确的答案。
1\. 你试过`<a4j:form>`which has `onComplete`event吗？没有解决你的问题吗？**2\. 如果您在重新渲染**
表单后绝对需要运行脚本，您可以在表单内放置标签，并将 javascript 代码放入其中，如下所示。**`<script>`**

 **```
<h:form id="frm">
  <script>
    alert('#{myBean.count()}');
  </script>
</h:form> 
```

每次呈现表单时都会显示此警报。
请注意，如果您需要阻止此 JS 在页面加载时运行，您可能需要添加如下条件。

```
<head>
  <script>
    var showAlert = false;
  </script>
</head> 
<body>
<h:form id="frm">
  <script>
    if(showAlert) {
      alert('#{myBean.count()}');
    }
    showAlert = true;
  </script>
</h:form>
</body> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T06:31:57.270

您可以使用[PrimeFaces](http://www.primefaces.org/showcase-labs/ui/ajaxStatusStandard.jsf)中的 ajax 状态标记组件：`<p:ajaxStatus>`或[RichFaces](http://showcase.richfaces.org/richfaces/component-sample.jsf?demo=status&skin=blueSky)：（`<a4j:status>`链接到[其文档](http://docs.jboss.org/richfaces/latest_4_2_X/Component_Reference/en-US/html/chap-Component_Reference-Processing_management.html#sect-Component_Reference-Processing_management-a4jstatus)）。两个组件都处理表单中进行的 ajax 调用的开始和完成事件。

我没有在 JSF 2 应用程序中尝试过任何这些，但我建议使用 PrimeFaces （至少文档比 RichFaces 更好）。我`<a4j:status>`在 JSF 1.2 + RichFaces 3.3 应用程序中使用 RichFaces 向用户显示/隐藏任何 ajax 请求的对话框。它看起来像这样（并且可以给你一个想法）：

```
<a4j:status onstart="Richfaces.showModalPanel('mdpWaitMessage')" 
    onstop="Richfaces.hideModalPanel('mdpWaitMessage')" />
<!-- defining the modal (popup) panel to show the user there was an ajax action -->
<rich:modalPanel id="mdpWaitMessage" resizeable="false" zindex="5000"
    minHeight="30" minWidth="10" height="70" width="150">
    <f:facet name="header">
        <h:outputText value="#{aplicacion.waitMessageTitle}" />
    </f:facet>
    <h:graphicImage value="#{aplicacion.waitMessagePath}" />
    <h:outputText value="#{aplicacion.waitMessageDescription}" />
</rich:modalPanel> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T22:23:47.700

看一眼`javax.faces.event.PreRenderComponentEvent.`

```
<h:form id="myForm">
  <f:event type="preRenderComponent"
           listener="#{someActionListener}" />
</h:form> 
```

每次（重新）呈现表单时，都会首先调用 actionListener。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-15T11:40:56.930

有一种方法不是很优雅，但我在没有其他选择的情况下使用它。我正在使用`<h:panelGroup>`包含一个块的 a，并且我在部件的一部分中`<script>`使用了 panelGroup id`render=``<f:ajax`

```
<h:form id="countForm">
  <h:outputText value="#{myBean.count}" />
  <h:commandButton value="Increment the count!">
    <f:ajax listener="#{myBean.increment()}" render="postAjax" />
  </h:commandButton>
  <h:panelGroup id="postAjax">
    <script>
     //...
    </script>
  </h:panelGroup>
</h:form> 
```

`panelGroup`请注意，如果位于 a`ui:repeat`或中，这将无法正常工作`datatable`。**

# java - Lucene TermQuery 和 QueryParser

> ID：13388159
> 
> 赞同：0
> 
> 时间：2012-11-14T22:03:12.330
> 
> 标签：java, lucene

我有 2 个 lucene 查询：

1)

```
Term term = new Term(Properties.LUCENE_APPARTMENT_ADDRESS,address);
Query termQuery = new TermQuery(term);
TopDocs topDocs = indexSearcher.search(termQuery, 20); 
```

和 2)

```
QueryParser queryParser = new QueryParser(Version.LUCENE_36, Properties.LUCENE_APPARTMENT_ADDRESS, analyzer);
Query query = queryParser.parse(address);
ScoreDoc[] queryResults = indexSearcher.search(query, 20).scoreDocs; 
```

为什么第一个返回 1 个结果，而第二个什么也不返回？（地址为一字以上）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-15T16:22:38.907

当您使用 时`QueryParser`，它使用分析器执行与索引期间相同的操作序列（标记化、小写、停用词等）。

当您使用 raw`TermQuery`时，您需要自己完成所有这些步骤。

我猜你的分析器做了一些特别的事情`Properties.LUCENE_APPARTMENT_ADDRESS`，而你在传递地址时没有这样做，`TermQuery`因此搜索结果存在差异。

# javascript - JavaScript 中的字符串连接与引号文字

> ID：13388161
> 
> 赞同：-1
> 
> 时间：2012-11-14T22:03:30.837
> 
> 标签：javascript, string-concatenation

我在 JavaScript 中指定引号文字时遇到问题。如何创建一个等同于以下内容的字符串？

```
<li><a onclick="goSomePlace('SomeName')">SomeName</a></li> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-14T22:05:14.130

您必须使用转义：

`var str = "<li><a onclick=\"goSomePlace('SomeName')\">SomeName</a></li>";`

或者

`var str = '<li><a onclick="goSomePlace(\'SomeName\')">SomeName</a></li>";`

javascript 中的字符串可以用`"`或包围`'`。当使用与用于包围字符串的字符相同的字符时，您必须使用`\`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-14T22:04:53.617

这应该对你有用：（函数参数中的转义单引号）

```
var string = '<li><a onclick="goSomePlace(\'SomeName\')">SomeName</a></li>'; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-14T22:04:56.537

```
var foo = "<li><a onclick=\"goSomePlace('SomeName')\">SomeName</a></li>"; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-14T22:06:09.443

你应该用“\”转义，

```
var s = "<li><a onclick="goSomePlace(\'SomeName\')">SomeName</a></li>';
var s = "<li><a onclick='goSomePlace(\"SomeName\")'>SomeName</a></li>";
var s = '<li><a onclick=\'goSomePlace("SomeName")\'>SomeName</a></li>'; 
```

# vb.net - 获取计算机名称

> ID：13388164
> 
> 赞同：27
> 
> 时间：2012-11-14T22:03:47.890
> 
> 标签：vb.net, winforms

我想获取当前的计算机名称。

这是我的代码：

```
Public Function GetComputerName() As String
    Dim ComputerName As String
    ComputerName = System.Net.Dns.GetHostName
    Return ComputerName
End Function 
```

此代码有效，但我记得有更快的方法。

获取计算机名称的快速方法是什么？

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2012-11-14T22:05:03.787

你可以只使用没有功能：

```
System.Net.Dns.GetHostName 
```

或者：

```
Environment.MachineName 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-14T22:44:00.880

这不是以前的答案那么好，但是如果您喜欢使用表单：

```
Private Sub Form1_Load(sender As System.Object, e As System.EventArgs) Handles MyBase.Load

    Me.Text = System.Windows.Forms.SystemInformation.ComputerName

End Sub 
```

System.Windows.Forms.SystemInformation 提供了很多很好的信息。

-> 用户域名

-> 用户名

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2016-03-09T18:36:28.970

有一个很好的静态属性应该可以在您的程序以及 VB.NET 和 C# 中的任何地方工作：

```
System.Environment.MachineName 
```

因为**系统**命名空间是默认自动导入的，所以只需键入**Environment.MachineName**即可引用它。

由于未知原因， **My.Computer.Name**不适用于许多人（包括我），尽管它经常被称为获取当前主机名的正确方法。因此，您无需费心尝试使其工作。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-12-03T10:09:27.403

获取先前回复中未提及的计算机名称的另一种方法：

```
My.Computer.Name 
```

**编辑**

仅适用于 VB.NET，不适用于 C#

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-01-19T02:57:11.043

对于 WPF 应用程序：

1.  在 MainWindow.xaml 表单上放置一个 Button 和 TextBlock
2.  为按钮和文本块创建一个名称。示例：文本块 1、按钮 1

代码示例 #1

```
Private Sub load(sender As Object, e As EventArgs)Handles MyBase.Loaded

TextBlock1.Text = Environment.MachineName 

End Sub 
```

代码示例 #2

```
Private Sub Button_Click_1(sender As Object, e As RoutedEventArgs) Handles Button1.Click

TextBlock1.Text = Environment.MachineName 

MyBase.Title = "Hello " + Environment.MachineName 

End Sub 
```

希望这能让您更了解如何显示用户的计算机名称。

我停止使用 Windows 窗体应用程序，因为它们太慢了。现在我使用 WPF 应用程序主要是因为它更流畅，并且它有更多的自定义和编码 WPF 应用程序非常类似于 Windows 窗体应用程序。

# c# - 通过 ASMX Web 服务将 XML 参数传递给存储过程

> ID：13388166
> 
> 赞同：0
> 
> 时间：2012-11-14T22:03:50.243
> 
> 标签：c#, wcf, sql-server-2005, stored-procedures, asmx

我有一个 SQL Server 2005 存储过程，其签名如下：

```
CREATE PROCEDURE [dbo].[ProcTRequest] 
   @Pxml xml, @ClientCode varchar(10) 
AS
BEGIN
  ...
END 
```

我的任务是编写一个`.asmx`将调用此存储过程的 Web 服务。这就是我遇到障碍的地方。

如果参数`@Pxml`在 C# web 方法中指定为字符串，我们得到

> *服务器无法处理请求。*

然后尝试`XmlText`作为 for 的类型`@Pxml`，结果是

> *服务器无法处理请求。方法 MyWebService.MyWebMethod 无法反映。出现反映“PXML”的错误。->; 反映类型“System.Xml.XmlText”的错误。-> System.Xml.XmlText 不能用作：'xml 元素'。*

从 C# Web 方法调用此存储过程的正确方法是什么？请注意，`@Pxml`参数将始终是格式正确的 XML。

调用此 Web 服务的人正在 Unix 系统上使用 Curl。

虽然要求是一个 ASMX，但如果这可以通过 WCF 实现，你能告诉我如何用一段伪代码来实现吗？我还不熟悉 WCF。

请帮忙。谢谢你。

更新：这就是我所说的 SP

```
 [WebMethod]
 public string GetRequestID(string PXml, string clientcode)
    {
        Database db = DatabaseFactory.CreateDatabase();
        using (IDataReader dr = db.ExecuteReader("ProcRequestID", PXml, clientcode))
        {
            return dr["RequestID"].ToString();
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T22:20:20.483

您不能在 ASMX 接口上使用**字符串**（因此调用者会向您发送一个字符串），但是在 ASMX Web 服务中，您将`@PXml`存储过程调用上的参数定义为`SqlDbType.Xml`？我认为这应该工作....

类似的东西：

```
[WebMethod]
public void MyWebMethod(string input, string clientCode)
{
        using (SqlConnection conn = new SqlConnection(your-connection-string-here))
        using (SqlCommand cmd = new SqlCommand("dbo.ProcTRequest", conn))
        {
            cmd.CommandType = CommandType.StoredProcedure;

            cmd.Parameters.Add("@Pxml", SqlDbType.Xml);
            cmd.Parameters.Add("@ClientCode", SqlDbType.VarChar, 10);

            cmd.Parameters["@Pxml"].Value = input;
            cmd.Parameters["@ClientCode"].Value = clientCode;

            conn.Open();
            cmd.ExecuteNonQuery();
            conn.Close();
        }
} 
```

由于您只是调用存储过程并且不期望返回结果集 - 使用`ExecuteNonQuery`而不是`ExecuteReader`.

同样至关重要的是：告诉 ADO.NET 您正在调用**存储过程**！这就是这条线的作用：

```
 cmd.CommandType = CommandType.StoredProcedure; 
```

否则，默认情况下，ADO.NET 期望获得完整的内联 SQL 语句，并且可能无法解析和执行该语句......

# c# - 在 C# 中禁用 SeDebugPrivilege

> ID：13388168
> 
> 赞同：1
> 
> 时间：2012-11-14T22:03:58.830
> 
> 标签：c#, security, privileges, least-privilege

我有一个基于 C# 中的 WPF 的程序，我想删除用户调试应用程序的权限（SeDebugPrivilege）（至少在发布模式下）。最好的方法是什么？我在需要对非托管代码进行不安全调用的代码中找到了几种方法。我更喜欢纯粹在 C# 中执行此操作，或者更好的是，通过应用程序清单或其他方式来阻止用户在执行我的应用程序期间完全拥有 SeDebugPrivilege。无论如何声明一个 Windows 组并撤销整个组的特权？这样做的动机是通过遵循最小特权原则来更好地保护我的应用程序的一部分。还有其他特权我确定我想稍后删除，但我'

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T22:42:24.010

我认为您可能误解了特权的影响，例如`SeDebugPrivilege`. 虽然您当然可以使用 删除进程令牌的权限`AdjustTokenPrivileges`，但这不会阻止应用程序*被*调试，而是会阻止应用程序本身执行某些调试操作。但是，这可用于通过防止应用程序通过需要特权的方式影响其他进程来减少应用程序中可能存在的漏洞的影响。

请注意，默认情况下，即使没有 ，用户也可以调试他们自己启动的应用程序`SeDebugPrivilege`，因此即使以非管理员用户身份运行（默认情况下根本没有权限），这也不会阻止应用程序被调试。

当然，有许多应用程序示例尝试检测是否附加了调试器，并且它们的成功程度各不相同。充其量您将能够使调试应用程序变得更加困难，但如果您在用户的机器上运行，您将无法完全阻止它。

您也许可以定期检查[`System.Diagnostics.Debugger.IsAttached`](http://msdn.microsoft.com/en-us/library/system.diagnostics.debugger.isattached.aspx)，如果值为 ，则采取一些措施`true`，但对于决心调试应用程序的人来说，克服它相对简单。

# c - 在守护进程中释放信号量

> ID：13388171
> 
> 赞同：0
> 
> 时间：2012-11-14T22:04:05.813
> 
> 标签：c, resources, semaphore

我目前正在编写一个网络服务器，以更好地了解进程和进程间通信。当请求文件时，我将其锁定以确保在读/写期间文件没有更改。这很好用。我的问题是如何在守护进程完成执行后从内存中清除锁定。我知道信号量在创建它们的进程停止执行后仍然存在。我知道信号量的丢弃需要在父级中完成，但是，信号量是在子级中创建的，这意味着父级中没有引用。所以基本上，它归结为：有没有办法引用在子进程期间创建的信号量，以便我可以在守护进程停止时丢弃退出处理程序中的信号量？我不 没有代码可以分享，因为我真的不知道如何做到这一点。我在 Linux 系统上用 C 编写代码。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T22:21:22.557

```
 SemId = semget(IPC_PRIVATE, n, 0600); 
```

您肯定是在使用它来创建信号量。这里，`n`是信号量的数量。

`SemId`可以在共享内存中。

这将允许您清除父级中的信号量。

如果您想避免创建全局变量并在父级中获取信号量或在共享内存中使用该变量，那么在退出子级之前，您绝对可以使用：

```
 semctl(SemId, 0, IPC_RMID, 0); 
```

共享内存必须在父级中完成，可以使用：

```
 ID = shmget(IPC_PRIVATE, sizeof(int) * X, 0600); 
```

共享内存的大小绝对是您的选择。

```
 SemId = (int *) shmat(ID, NULL, 0); 
```

这将属性的空间`SemId`。退出后，子父级可以（或任何其他子级）访问此变量并使用`semctl`上述方法删除信号量。

您必须声明`int *SemID`为全局变量。

所以，如果创建信号量，`semget`使用该函数，你可以只返回它的值给`SemId`上面提到的。

如果您决定使用共享内存选项，则必须记住使用以下方法删除该内存的属性空间：

```
 shmdt((void *) SemId);
  shmctl(ID, IPC_RMID, NULL); 
```

# java - Java编程，小数

> ID：13388173
> 
> 赞同：-1
> 
> 时间：2012-11-14T22:04:15.577
> 
> 标签：java, bluej

这是一个复利计算器，一切正常，除了我不知道如何让我的答案只有 2 位小数，而不是现在的长数字。请查看代码并建议我是否应该更正。非常感谢。

```
class InvestmentProject{
public double CompoundInterest(double InitialDeposit, double YearlyContribution, double InterestRate, int PeriodsInYr) {

double RateInDecimal = InterestRate/100;
double Value = YearlyContribution/RateInDecimal - YearlyContribution/(RateInDecimal * Math.pow(1 + RateInDecimal, PeriodsInYr));
return (InitialDeposit + Value) * Math.pow(1 + RateInDecimal, PeriodsInYr);
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T22:17:45.000

在 Java 中进行财务计算，尤其是比较时，绝不应该使用浮点数或双精度数。改用 BigDecimal。[这是一篇解释原因的文章](http://www.mikeash.com/pyblog/friday-qa-2011-01-04-practical-floating-point.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T23:00:44.993

您应该使用 decimalFormat 类

```
import java.text.DecimalFormat;  

public class Java0605
{
    public static void main (String args[])
    {
        DecimalFormat output = new DecimalFormat("00000");
        System.out.println(output.format(1));
        System.out.println(output.format(12));
        System.out.println(output.format(123));
        System.out.println(output.format(1234));
        System.out.println(output.format(12345));
        System.out.println(output.format(123456));
        System.out.println(output.format(1234567));
        System.out.println();
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T22:06:38.723

利用`Math.round(result*100)/100;`

这里有一个类似的问题（[How to round a number to n decimal places in Java](https://stackoverflow.com/questions/153724/how-to-round-a-number-to-n-decimal-places-in-java)）概述了在 Java 中进行舍入的更多方法。

# php - 在 JavaScript/HTML 前端和 PHP/MySQL 后端之间发送或链接文件

> ID：13388176
> 
> 赞同：1
> 
> 时间：2012-11-14T22:04:32.743
> 
> 标签：php, javascript, widget

我正在寻找创建一个“文件生成器”，因为需要一个更好的词。但是，我愿意接受有关如何执行此操作的创造性建议。

基本上我想要的是：

*   **输入：**用户填写几个文本框
*   **过程：**系统将文本信息存储在数据库中，将文本格式化为带有标题等的漂亮框。
*   **输出：**系统使格式化的文本可供用户使用..不知何故

但是，我会接受的是这样的：

*   **输入：**用户填写几个文本框。
*   **过程：**系统将文本信息存储在数据库中以供将来编辑/检索操作
*   **输出：**系统生成PDF文件供用户下载

这听起来很简单。仅在 PHP 中就可以了。

不幸的是，我正在使用学校的虚拟学习环境。我必须创建[Netvibes UWA 格式](http://dev.netvibes.com/)小部件（在 JavaScript 中）并使用 AJAX（严格来说，AHAH）调用与 PHP 进行通信。

假设我因此无法使用 JavaScript 创建我想要的文档（似乎找不到任何半体面的 PDF 库，而且我不想被限制为一种文件格式），有什么办法可以让调用我的 PHP 脚本，然后让它返回一个文件以供 JavaScript 代码以某种方式处理？

我不确定我是否可以通过 VLE 使所有用户都可以访问 PHP 脚本目录，因此在使用 PHP 创建文件后简单地发回链接是行不通的。

提前致谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T22:19:48.940

扩展我的评论；

1.  将 php 创建的文件作为 ajax 响应发回
2.  [`btoa`](https://developer.mozilla.org/en-US/docs/DOM/window.btoa)制作base64字符串的数据（或者做这个服务器端并将它发回，更大的互联网使用，但我不确定XMLHttpRequest如何处理二进制数据）
3.  将此字符串附加到`'data:application/octet-stream;base64,'`以获取[数据 URI](https://developer.mozilla.org/en-US/docs/data_URIs)
4.  将`window.location.href`（或某些 iframe）设置为此 URI，页面不会更改，因为它会执行下载行为。

# python - 连接了无限数量的套接字？

> ID：13388177
> 
> 赞同：0
> 
> 时间：2012-11-14T22:04:39.260
> 
> 标签：python, sockets, networking

我正在尝试制作聊天服务器。基本上，我希望多个客户端能够同时连接。

我想要它，所以它总是在听。每当有人尝试连接时，它都会立即接受它们并将它们添加到连接列表中。

我可以有一个listen（1）然后超时，并继续将它们附加到一个列表然后关闭套接字，并创建一个新的，然后超时监听等等。虽然，这看起来很慢，我不是甚至确定它会起作用

请记住，它不必是套接字。如果有任何其他类型的网络接口，它也可以正常工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T22:12:45.590

根据系统的内存，最大套接字数会有实际限制。

请参阅[http://docs.python.org/2/library/socketserver.html](http://docs.python.org/2/library/socketserver.html)。我认为最后几个示例（在 Asynchronous Mixins 下）非常接近您想要实现的目标。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-14T22:19:22.347

考虑您是否真的需要为每个连接维护单独的套接字。像无连接UDP这样的东西合适吗？这样你就可以支持任意数量的用户，同时只使用一个 OS 套接字。

当然，使用这种方法，您需要在内部维护连接语义（如果您的应用程序关心这些事情）；通过查看他们的 IP/端口或通过检查网络协议中的一些信封数据来确定每个数据报已发送到哪个用户，偶尔发送 ping 以查看另一端是否还活着，等等。但是这种方法应该很好地将你分开来自任何操作系统问题 RE：允许您的进程一次保持打开的套接字数量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-14T22:43:17.683

您正在查看的问题略有错误。使用服务器端套接字，您接受到同一个套接字的连接，然后由其他进程/线程处理。

```
#
# Setup socket and other handling stuff here
#

while True:
    conn = sock.accept()
    thread.start_new_thread(handler, (conn,)) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-15T00:24:31.227

> 我想要它，所以它总是在听。每当有人尝试连接时，它都会立即接受它们并将它们添加到连接列表中。

所以你只有：

1.  一个 accept() 循环，除了 accept() 新连接之外什么都不做，并启动一个新线程来处理每个连接。

2.  无论您希望会话空闲超时是什么，每个连接的一个线程都会以长超时读取。如果超时到期，则关闭套接字并退出线程。

如果服务器用完 FD，如果有足够的同时连接，accept() 将开始失败并显示相应的 errno：在这种情况下，您只需忽略它并继续循环。也许您在这种情况下减少空闲超时，并在接受再次开始工作时将其放回。

# primefaces - Primefaces - 如何设置要上传的文件

> ID：13388181
> 
> 赞同：0
> 
> 时间：2012-11-14T22:04:54.393
> 
> 标签：primefaces

我想使用 Primefaces 文件上传，这是我的 jsf 页面：

```
 <h:form id="uploadForm" enctype="multipart/form">  

    <p:fileUpload id="fileUpload" value="#{fileUploadController.file}" mode="simple"/>  

    <p:commandButton value="Submit" ajax="false"  
                                 actionListener="#{fileUploadController.upload}" />               
 </h:form> 
```

这是我的豆子：

```
package FileUploadController;

import javax.faces.application.FacesMessage;
import javax.faces.bean.ManagedBean;
import javax.faces.bean.SessionScoped;
import javax.faces.context.FacesContext;
import org.primefaces.model.UploadedFile;

@ManagedBean
@SessionScoped
public class FileUploadController {  

    private UploadedFile file; 

    public UploadedFile getFile() {  
        return file;  
    }  

    public void setFile(UploadedFile file) {  
        this.file = file;  
    }  

    public void upload() {  
        if(file != null) {  
            FacesMessage msg = new FacesMessage("Succesful", file.getFileName() + " is uploaded.");  
            FacesContext.getCurrentInstance().addMessage(null, msg);  
        }  
    }  
} 
```

这是 prim 所需的依赖项。文件上传，pom.xml（我使用 maven 项目）：

```
<dependency>
    <groupId>commons-fileupload</groupId>
    <artifactId>commons-fileupload</artifactId>
    <version>1.2.1</version>
</dependency>     
<dependency>
     <groupId>org.apache.commons</groupId>
     <artifactId>commons-io</artifactId>
     <version>1.3.2</version>
</dependency>
<dependency>
     <groupId>portlet-api</groupId>
     <artifactId>portlet-api</artifactId>
     <version>1.0</version>
</dependency> 
```

这是我的 web.xml：

```
 <filter>
        <filter-name>PrimeFaces FileUpload Filter</filter-name>
        <filter-class>
            org.primefaces.webapp.filter.FileUploadFilter
        </filter-class>
    </filter>
    <filter-mapping>
        <filter-name>PrimeFaces FileUpload Filter</filter-name>
        <servlet-name>Faces Servlet</servlet-name>
    </filter-mapping> 
```

我想设置`UploadedFile`文件。当我单击提交按钮时，上传方法被正确调用，但`UploadedFile`文件仍然为空，未设置为所选文件。我怎样才能设置这个文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T22:40:16.107

[enctype](http://www.w3.org/TR/html401/interact/forms.html#adef-enctype)属性`enctype="multipart/form"`无效。该`enctype`属性指定用于将表单提交到服务器的内容类型。

根据 PrimeFaces 文档（第 183 页），该`enctype`属性应定义为`enctype="multipart/form-data"`，在您的情况下：

```
<h:form id="uploadForm" enctype="multipart/form-data">
    ...
</h:form> 
```

# html - 网站未在某些页面上加载 css 文件

> ID：13388184
> 
> 赞同：3
> 
> 时间：2012-11-14T22:05:01.600
> 
> 标签：html, css, jekyll

我正在构建的网站没有为某些页面加载任何 css/javascript 文件。有问题的页面是降价发布文件。我正在使用 Jekyll 构建网站。

链接在这里

[http://joshhornby.co.uk/](http://joshhornby.co.uk/)

如您所见，索引页面有效，但博客文章无效。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-14T22:07:23.643

您的`href`开头`/`既不是绝对的 ( )，也不是绝对的 ( `http://`)，因此它将使用相对于当前页面的路径。

它正在文件夹中寻找 CSS`http://joshhornby.co.uk/2012/11/14/`

在`/`你之前添加，你应该很好。`stylesheet/``href`

# git - 有没有办法告诉 GIT 不同分支上的两个提交是相关的——即它们解决了相同的问题？

> ID：13388193
> 
> 赞同：3
> 
> 时间：2012-11-14T22:05:33.703
> 
> 标签：git

我在我的项目的一个分支上发现了一个崩溃问题。我修好了，承诺了。

然后我发现，与我最初的看法相反，那个特定的崩溃错误在多个分支中普遍存在，所以我在 master 分支中修复了它。

不幸的是，这让我在两个分支上进行了“相同”的提交（不完全相同，因为在同一代码区域中的分支略有不同）。

当我将更改从主服务器拉到分支时，有什么方法可以告诉 GIT 提交是相关的并且应该出于合并的目的而忽略？

* * *

作为背景，有问题的分支并非旨在添加功能，它旨在将有问题的应用程序“列入白名单”——相同的应用程序，具有不同的艺术作品和种子数据。（基本上，第二家公司授权我们的软件并假装它是他们的）。这是我能想到的最好的解决方案，让白标版本的软件基于主版本进行更新。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T22:11:27.887

如果您计划稍后合并或挑选樱桃，这应该不是问题。这样做的算法会注意到相似之处并做正确的事情。

如果合并这两个分支，您将有多个提交消息，但您应该 - 这是您合并工作的方式，这里的工作恰好具有相同的内容。如果你真的很担心，一旦你合并，你可以压扁，但我不会打扰，历史很重要。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-14T22:09:00.363

我不确定您的 GIT 工作流程，但我会从 master 创建一个修补程序分支，修复该分支中的问题，并将其合并到所有相关分支中。

这样，如果/当您将分支合并到 master 中时，将不会有多个提交用于同一个修复。

# html - SVG hexgrid：悬停无法正常工作

> ID：13388194
> 
> 赞同：1
> 
> 时间：2012-11-14T22:05:34.663
> 
> 标签：html, css, svg

我正在开发一个带有底层 hexgrid 的小游戏。为此，我建议使用 svg，因为重叠的 img 存在正确的鼠标交互问题。现在我用一些多边形构建了一个简单的 hexgrid，并添加了一些 CSS 来实现悬停效果。但这不能正常工作。它并非一直触发，并且行为非常不稳定。基本上它包括：

```
...
<svg id="svggrid" class="grid" xmlns="http://www.w3.org/2000/svg" version="1.1">
  <polygon points="25,43 75,43 100,86 75,129 25,129 0,86" class="tile"></polygon>
  <polygon points="25,129 75,129 100,172 75,215 25,215 0,172" class="tile"></polygon>
  <polygon points="25,215 75,215 100,258 75,301 25,301 0,258" class="tile"></polygon>
  <polygon points="100,0 150,0 175,43 150,86 100,86 75,43" class="tile"></polygon>
  <polygon points="100,86 150,86 175,129 150,172 100,172 75,129" class="tile"></polygon>
  <polygon points="100,172 150,172 175,215 150,258 100,258 75,215" class="tile"></polygon>
  <polygon points="175,43 225,43 250,86 225,129 175,129 150,86" class="tile"></polygon>
  <polygon points="175,129 225,129 250,172 225,215 175,215 150,172" class="tile"></polygon>
  <polygon points="175,215 225,215 250,258 225,301 175,301 150,258" class="tile"></polygon>
</svg>
... 
```

和 CSS（外部文件，链接到网站）：

```
...
.tile{
  stroke: #000000;
  fill:none;
}

.tile:hover{
  stroke: #808080;
  fill:red;
}
... 
```

我把它放进这个jsfiddle：

[http://jsfiddle.net/TZjDp/](http://jsfiddle.net/TZjDp/)

如果我删除 SVG 的 CSS 中的 .tile ，它可以工作，但如果没有，我将无法调整多边形的颜色和边框。我很困惑为什么没有这个部分它可以工作。

这显示在这个 jsfiddle 中：http: [//jsfiddle.net/tf3fu/](http://jsfiddle.net/tf3fu/)

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T22:22:15.033

事件的默认设置是仅针对绘制对象且未填充对象的位置。[pointer-events](http://www.w3.org/TR/SVG/interact.html#PointerEventsProperty)属性可以对此进行调整，以便无论是否设置了填充/描边，悬停都可以工作。

```
.tile{
    stroke: #000000;
    fill:none;
    pointer-events: visible;
}

.tile:hover{
    stroke: #808080;
    fill:red;
    pointer-events: visible;
} 
```

# c# - 在 C# 的 RichTextBox 中使用 HTML 标签

> ID：13388196
> 
> 赞同：2
> 
> 时间：2012-11-14T22:05:40.160
> 
> 标签：c#, html, winforms, richtextbox

在我的项目中，我想使用一个富文本框，它具有对齐的文本对齐和呈现 HTML 标记。我检查并尝试了网络上的所有示例。但我并没有在我的脑海中找到类似的东西。我厌倦了[AdvRichTextBox](http://geekswithblogs.net/pvidler/archive/2003/10/14/182.aspx)但它不支持 HTML。我想为它写一些新功能。我尝试编写如下方法：

```
private void htmlRTB(AdvRichTextBox rtb)
{
    foreach (var line in rtb.Lines)
    {
        int boldStart = rtb.Find("<b>");
        int boldEnd = rtb.Find("</b>");
        rtb.Select(boldStart, (boldEnd - boldStart));
        rtb.SelectionFont = new Font("Arial", 9, FontStyle.Bold);
        line.Replace("<b>", "").Replace("</b>", "");

        int italicStart = rtb.Find("<i>");
        int italicEnd = rtb.Find("</i>");
        rtb.Select(italicStart, (italicEnd - italicStart));
        rtb.SelectionFont = new Font("Arial", 9, FontStyle.Italic);
        line.Replace("<i>", "").Replace("</i>", "");
    }
} 
```

但它被搞砸了。首次使用 HTML 标记时，它们显示为粗体或斜体。但是替换方法不起作用。并且当 HTML 标签在第二次或更多次使用时，它们不会显示为粗体或斜体，并且替换方法不起作用。这是截图图像： ![在此处输入图像描述](../Images/b0db832279e18b82eefd70bec378e8c7.png) 请你帮我解决这个问题？亲切的问候。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T20:13:33.477

看起来您只是在替换您拉出的行中的标签，而不是 RTB 本身。您需要对 RTB 文本运行替换。应该不会太难，因为您已经有了标签的 int 位置，可以使用它。

此外，你的 for 循环不会像你想象的那样工作，因为所有文本都被认为是一行......这就是为什么它只加粗/突出显示第一行。当我下班回家时，我会试着为你写一个例子。

# c# - AJAX 参数不正确

> ID：13388197
> 
> 赞同：0
> 
> 时间：2012-11-14T22:05:40.893
> 
> 标签：c#, jquery, ajax

嗨，我有以下代码

**在 JQuery 中：**

```
this.myFunction = function()
{

   var dto =
   {
       id : getID()
   };

   //alert(getID();) to verify that my number is indeed non zero.

    $.ajax({
        type: "POST",
        url: "Create",
        contentType: 'application/json; charset=utf-8',
        data: JSON.stringify(dto),
        dataType: "json",
        success: function(result) {
            alert("Data Returned: ");
        }
    });
} 
```

在 C# 中

```
public void myCFunction(int i)
{
  //do some stuff
} 
```

当我在 Visual Studios 中运行调试器时，我注意到我的 C# 函数中的整数始终为零，尽管我传递的值不是零。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T22:21:22.263

在评论中回答，但这是为了更清楚。

您的 JSON 数据需要与处理请求的 C# 方法的数据相匹配。'i' 始终为 0，因为该方法没有正在处理与 'i' 匹配的数据。例如，它被传递空数据。更改数据以匹配参数名称将解决此问题。例如，

```
public void myCFunction(int id)
{
  //do some stuff
} 
```

# java - 如何更新作为 Spring Security ACL 一部分的 acl_sid 表中的用户名？

> ID：13388199
> 
> 赞同：1
> 
> 时间：2012-11-14T22:05:49.913
> 
> 标签：java, jdbc, spring-security, acl

Spring 安全 ACL 中使用的 ACL_SID 表包含用户名作为列之一。我想知道修改此值的最佳方法。例如，当与现有用户对应的用户名发生更改时，这是必需的。它看起来不`JdbcMutableAclService`支持此功能。任何帮助表示赞赏。

谢谢，拉古

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T22:33:13.560

您可以扩展`JdbcMutableAclService`类并添加所需的新方法。

在您的构造函数中，您可以创建以下实例`JdbcTemplate`：

```
public YourClassName(DataSource dataSource, LookupStrategy lookupStrategy, AclCache aclCache) {
    super(dataSource, lookupStrategy, aclCache);
    this.jdbcTemplate = new JdbcTemplate(dataSource);
    this.aclCache = aclCache; 
} 
```

现在您可以`JdbcTemplate`在新方法中使用它来更新 SID 的用户名。

```
jdbcTemplate.update("update acl_sid set sid = ? where sid = ?", newUsername, oldUsername); 
```

记住唯一约束

```
constraint unique_uk_1 unique(sid,principal) 
```

`JdbcTemplate`在失败的情况下可以抛出`DataAccessException`。例如`DataIntegrityViolationException`，当您的数据库中已存在具有该名称的 SID 时，将引发此问题。

还要记住交易。

如您所见，Spring Security 正在使用它`AclCache`来提高执行效率。您最好在每次用户名更新时从该缓存中清除所有内容。您可以为此使用`void clearCache();`方法。`AclCache`是超类的私有成员，因此您需要记住类中的该实例（查看建议的构造函数的主体）。

# jquery - jQuery 设置超时和显示

> ID：13388206
> 
> 赞同：0
> 
> 时间：2012-11-14T22:06:40.847
> 
> 标签：jquery, html, css, jquery-animate, settimeout

抱歉这个菜鸟问题，我正在尝试让三个红色的气泡一个一个出现，请在此处查看我的代码：http: [//jsfiddle.net/FLt9Z/](http://jsfiddle.net/FLt9Z/)

该部分的 javascript 如下所示：

```
function leftappear() {
    $('#redbubble-left').show();
}

function topappear() {
    $('#redbubble-top').show();
}

function rightappear() {
    $('#redbubble-right').show();
}

var animation_script = [
    {
         at_time: 30 * 1000, // 30 seconds
         animation: leftappear()
    },
    {
         at_time: 31 * 1000, // 31 seconds
         animation: topappear()
    },
    {
         at_time: 32 * 1000, // 32 seconds
         animation: rightappear()
    }
];

var current_time = 0;

function animate_next() {
    var next = animation_script.shift(),
        time_between = next.at_time - current_time;
    setTimeout(function () {
        current_time = next.at_time;
        next.animation();
        animate_next();
    }, time_between);
} 
```

非常感谢你们！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-14T22:14:58.820

两个问题：

1.  你在调用动画方法而不是在你的动画脚本中引用它们
2.  你永远不会触发下一个 FIRST 动画。

[http://jsfiddle.net/FLt9Z/1/](http://jsfiddle.net/FLt9Z/1/)

这是两个主要变化。

```
var animation_script = [
    {
         at_time: 2* 1000, // 30 seconds
         animation: leftappear // NOTE: drop the parens ()
    },
    {
         at_time: 3* 1000, // 31 seconds
         animation: topappear // NOTE: drop the parens ()
    },
    {
         at_time: 4* 1000, // 32 seconds
         animation: rightappear // NOTE: drop the parens ()
    }
]; 
```

然后2，开始，我只是添加`animate_next();`到底部。您可以将它放在顶部或其他地方的初始化脚本中。这仅用于演示目的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-14T22:21:56.337

除了第一个答案之外，我还想指出您当前的代码会继续调用自身，即使它通过了要显示的气泡列表，而是我只会循环一次并设置超时：

```
$.each(animation_script, function(i, animation) {
    var next = animation_script.shift(),
        time_between = next.at_time - current_time;
    setTimeout(function() {
        current_time = next.at_time;
        next.animation();
    }, time_between);
}); 
```

# coffeescript - CoffeeScript for 循环获取迭代器变量

> ID：13388209
> 
> 赞同：0
> 
> 时间：2012-11-14T22:06:48.153
> 
> 标签：coffeescript

在咖啡里我有

```
arr = ["a","b","c"]
for i in [0..arr.length] by 1
  if (sometimesTrue)
    arr.pop()
    i-- 
```

但它正在将其翻译为：

```
var arr, i, _i, _ref;

arr = ["a", "b", "c"];

for (i = _i = 0, _ref = arr.length; _i <= _ref; i = _i += 1) {
  if (sometimesTrue) {
    arr.pop();
    i--;
  }
} 
```

你可以看到这个循环使用 a`_i`作为参考，而不是`i`my`i--`并没有真正做任何事情。

由于在这个循环中，数组的长度发生了变化，我有点需要弄清楚如何处理这个......有没有办法用 for 循环来做到这一点？还是我需要切换到一段时间？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T04:29:11.787

CoffeeScript 将计算一次循环边界，并且您无法重置计算，因此在迭代时更改数组只会造成很大的混乱。

例如，这个：

```
f(i) for i in [0..a.length] 
```

变成这样：

```
var i, _i, _ref;
for (i = _i = 0, _ref = a.length; 0 <= _ref ? _i <= _ref : _i >= _ref; i = 0 <= _ref ? ++_i : --_i) {
  f(i);
} 
```

请注意，在`_ref`循环开始时计算的迭代次数是固定的。另请注意，`i`每次迭代都会为它分配一个新值，因此您`i`在循环内所做的任何更改都将被忽略。并且，请注意，循环`[0..a.length]`是`a.length+1`迭代，而不是`a.length`迭代；`[a..b]`产生一个闭区间（即包含两个端点），`[a...b]`给你一个半开区间（即`b`不包括在内）。同样，这个：

```
f(i) for i in a 
```

变成这样：

```
var i, _i, _len;
for (_i = 0, _len = a.length; _i < _len; _i++) {
  i = a[_i];
  f(i);
} 
```

同样，迭代次数是固定的，并且更改会`i`被覆盖。

如果您想弄乱循环内的数组和循环索引，那么您必须使用`while`循环手动完成所有操作：

```
i = 0
while i < arr.length
  if(sometimesTrue)
    arr.pop()
    --i
  ++i 
```

或者：

```
i = 0
while i < arr.length
  if(sometimesTrue)
    arr.pop()
  else
    ++i 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T17:47:52.637

`for ... in ...`修改您正在循环的数组很少能在具有构造的语言中实现您想要的效果。你真正要找的是一个`filter`. 许多 javascript 实现都有一个过滤器函数附加到数组原型：

```
arr = arr.filter((member) -> !sometimesTrue) 
```

如果你不能指望这一点，你可以使用类似的 CoffeeScript 构造：

```
arr = (member for member in arr when !sometimesTrue) 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-15T07:44:49.687

在 coffeescript 中使用索引是很不自然的。

我认为你想要的是这样的：

```
arr = ["a","b","c"]
arr = (i for i in arr when ! sometimeTrue ) 
```

我认为您应该在[http://coffeescript.org/阅读以下主题“循环和理解”](http://coffeescript.org/)

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-11-15T02:02:09.350

有时散步会有所帮助，也许在树林里真正新鲜的空气中，也许在屋前抽着香烟（尽管你的妻子可能讨厌吸烟）......有时甚至可以和橡皮鸭交谈一些超级-geeks 在他们的显示器上。有时，简单明了有助于从不同的角度攻击简单的事情。 ~~arr = [“a”，“b”，“c”]~~

 ~~```
for i in [0..arr.length]
  if (sometimesTrue)
    arr.splice i, 1
  else i++ 
```~~  ~~编辑：正如下面的评论中所见，我在这里遗漏了一些东西。我确实没有被忽视，我一开始怎么会这么想？~~

# mysql - 为 MySQL 表中的每个重复项返回唯一行

> ID：13388210
> 
> 赞同：2
> 
> 时间：2012-11-14T22:06:50.647
> 
> 标签：mysql, duplicates

我对 MySQL 有点陌生，我不确定如何做到这一点，或者它是否可能。

我有一张这样的桌子：

```
Table products
    id  |  model  |  alt_model
    --     -----     ---------
    1      abc          abc
    2      ab-c         abc
    3      a-bc         abc
    4      def          def
    5      ghi          ghi
    6      gh-i         ghi
    7      jk-l         jkl
    8      mno          mno
    9      m-n-o        mno
    10     mn-o         mno
    11     m-no         mno
    12     pqr          pqr
    13     stu          stu 
```

我希望能够进行查询，该查询将导致 alt_models 相同的产品的每个重复组合。每对重复项都是唯一的，切换它们的顺序不应产生另一个结果，但结果应在 id1 字段中具有较低的 id

结果应如下所示：

```
id1  |  id2   |  model1  |  model2
---     ---      ------     ------
 1       2       abc        ab-c
 1       3       abc        a-bc
 2       3       ab-c       a-bc
 5       6       ghi        gh-i
 8       9       mno        m-n-o
 8       10      mno        mn-o
 8       11      mno        m-no
 9       10      m-n-o      mn-o
 9       11      m-n-o      m-no
 10      11      mn-o       m-no 
```

这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T22:15:18.360

一个简单的自连接就可以了；

```
SELECT a.id id1, b.id id2, a.model model1, b.model model2
FROM products a
JOIN products b
  ON a.alt_model=b.alt_model           -- alt_model must match
 AND a.id < b.id                       -- and id1 is smaller
ORDER BY id1,id2; 
```

[SQLfiddle 在这里进行测试](http://sqlfiddle.com/#!2/4f7ff/2)。

# ruby-on-rails - OpenStack API 的开源 Rails gem？

> ID：13388213
> 
> 赞同：3
> 
> 时间：2012-11-14T22:07:06.943
> 
> 标签：ruby-on-rails, ruby, openstack

针对 OpenStack API 进行开发的领先开源 Rails gem 是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T22:16:49.027

我建议您在[The Ruby Toolbox](https://www.ruby-toolbox.com)上查看此类问题。这是他们网站上[Openstack 搜索的结果。](https://www.ruby-toolbox.com/search?utf8=%E2%9C%93&q=openstack)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-14T22:23:22.143

您可能想看看 Fog ( [https://github.com/fog/fog](https://github.com/fog/fog) )。Fog 为包括 OpenStack 在内的众多云提供商提供了抽象。虽然文档有点稀疏......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-26T23:34:25.400

查看[OpenStack ActiveResource](https://github.com/Unidata-SpA/openstack_activeresource "OpenStack 活动资源") gem。它是在 ActiveResource 之上实现的 OpenStack Ruby（和 RoR）绑定，支持 Keystone（管理员和公共）、Nova 和 Glance。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-11-10T20:16:35.320

我知道这是一个旧线程，但是puppet-openstacklib[最近开始使用](https://github.com/stackforge/puppet-openstacklib/commit/612fa7e121c9ddc36a365de3053879e1544b409f)[Aviator](http://aviator.github.io/www/)。

# jenkins - Jenkins纯文本控制台输出不是实时的

> ID：13388217
> 
> 赞同：1
> 
> 时间：2012-11-14T22:07:21.470
> 
> 标签：jenkins, jenkins-plugins

“html”版本的控制台输出对我来说很好，并从控制台实时显示。

但是当我切换到纯文本版本（即![以纯文本形式查看](../Images/cd48ded8b22d398dadd3b8a648cef865.png)）时，它就不起作用了。

它只显示一小部分控制台输出，直到构建完成，然后显示完整输出。

目前，问题仅存在于超过 5k 行的控制台输出上。

詹金斯版本：1.477

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T23:08:51.790

这是因为默认情况下输出在 5k 行左右被截断，因此在构建过程中全文将始终拉取最后 5k 行，类似于 HTML 视图仅显示约 5k 行的方式，直到您单击“显示完整输出” “ 按钮。

构建完成后，完整的输出将转储为纯文本，因此会显示整个输出。

# java - Java——事件处理设计

> ID：13388221
> 
> 赞同：5
> 
> 时间：2012-11-14T22:07:30.617
> 
> 标签：java, events, event-driven-design

我正在尝试开发一个基于处理某些事件和生成数据的系统。每个事件将包含（可能）几个不同的字段，每个侦听器将处理一些或它们。我有以下两种方法

1.  在事件生成类中，我将注册多个事件侦听器，每个侦听器侦听事件特定字段的一个特定值，例如：

    ```
    public class MicroListener implements Listener {

    public void processEvent(Event e){
        if(e.getName().equals(registeredName)) { ... }
    } 
    ```

这很诱人，因为处理是在对象本身内部完成的，并且没有集中处理事件，而是允许每个对象处理信息。缺点（可能是致命的）是每个事件（几十万个）都必须广播给所有听众，而实际上只有一小部分会做某事。从长远来看，它可能会产生巨大的性能冲击......

1.  一个集中式侦听器，它将侦听所有事件并对其采取行动，并将处理委托给相应的事件处理器，例如：

    ```
     public class CentralListener implements Listener {

        Map<String, Processor> processorsByName;

        public void processEvent(Event e){
            processorsByName.get(e.getName()).process(e);
        }
    } 
    ```

这会更快，但是对于事件的任何其他部分，例如检查事件ID等的处理器，它需要单独的映射或处理器集合。方法1中不是这种情况。因为我们将简单地生成另一组侦听器并注册他们与事件生成类。

你们怎么看这些？它们有意义吗，还是您宁愿建议完全不同的东西？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-14T22:21:29.053

这是一个常见的设计决策，我认为没有一个通用的答案适用于所有（甚至大多数）情况。我可以列出这两种方法的各种权衡，但它们可能是显而易见的。在我考虑可能的性能影响之前，我会优先考虑最适合概念模型的任何设计（并且不会产生一堆无关的类）。

如果性能是最受关注的问题，那么在整数事件 id 上使用大型 switch/case 块切换的集中式控制器可能是最快的。...随着时间的推移，也是最不灵活/可维护的。

您可能想要查看[Guava 项目的 EventBus](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/eventbus/package-summary.html)。它使用注解来注册事件监听器，并为这种类型的事件广播/订阅提供了一个非常干净的 api。根据他们在方法签名中声明的事件类型通知事件订阅者。它非常光滑并且节省了很多样板文件。我不知道它可以扩展到成千上万的事件类型，但与一些类似的库不同，事件总线不是全局的。您可以创建不同的事件总线实例以在有意义的情况下分离事件处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T22:40:45.077

听起来您正处于相当大且（可能）复杂的事情的开始。在使用您提到的两种更具命令式启发的方法之前，我可能会仔细研究基于事件的编程。这个想法与使用侦听器非常相似，只是异步实现，因此事件侦听器可以是它们自己的小线程，仅在被要求采取行动时才行动。

我不知道它是否适用于此，但让我们假设您有不同的事件类型需要传播到不同的侦听器。与其将观察者存储在一个巨大的堆中，不如为观察者可以注册的每种事件类型创建一个侦听器？如果您有一些生成事件的核心组件，它们可以将它们发送到侦听器，然后再将它们发送给观察者。

在我看来，主要的好处是在得到照顾之前将责任委托给（子）听众。在一个可以真正帮助程序员并防止性能瓶颈的大型环境中。我相信这也被称为[反应堆模式](http://en.wikipedia.org/wiki/Reactor_pattern)。

如果您正在寻找灵感，请尝试查看[akka 框架](http://akka.io/)。它专为高效的分布式事件编程而设计。

# java - 我在 JAVA 和 VB 中有可以工作的代码。我需要用 PHP 做同样的事情，我该怎么做

> ID：13388223
> 
> 赞同：1
> 
> 时间：2012-11-14T22:07:37.477
> 
> 标签：java, php, vb.net

有效的VB代码：

```
Public Function Encrypt(ByVal Data As String) As Byte()
    Dim md5Hasher As New MD5CryptoServiceProvider()
    Dim hashedBytes As Byte()
    Dim encoder As New UTF8Encoding()

    hashedBytes = md5Hasher.ComputeHash(encoder.GetBytes(Data))
    Return hashedBytes
End Function 
```

有效的JAVA代码：

```
byte[] bytes = stringToConvert.getBytes("UTF-8");
MessageDigest m = MessageDigest.getInstance("MD5");
hashedBytes = m.digest(bytes); 
```

我在 PHP 中尝试过的东西不起作用，我想我知道为什么。

我想是因为这个：

Java 中的字符存储为 Unicode 16 位序列。在 PHP 中，它们是单字节序列。这是我尝试过的代码...

```
 $UTFbString = UTF8_encode($bString);
     $hashedBytes = md5($UTFbString, true); 
```

好的，我发现如果我使用这种方法......

```
 function ascii_to_dec($str)
 {
     for ($i = 0, $j = strlen($str); $i < $j; $i++) {
     $dec_array[] = ord($str{$i});
  }
   return $dec_array;
  } 
```

而这段代码......

```
 $bStringArr = array( ascii_to_dec($bString));

 I can get back an array that matches the byte array in JAVA.

 So the next challenge is to convert that to bytes then md5 hash those bytes? 
```

执行此操作的 JAVA 代码如下所示...

```
 MessageDigest digester = MessageDigest.getInstance("MD5");
   byte[] bytes = new byte[8192];
   int byteCount;
   while ((byteCount = in.read(bytes)) > 0) {
      digester.update(bytes, 0, byteCount);
   }
   byte[] digest = digester.digest(); 
```

关于在 PHP 中实现类似的东西有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T22:12:01.050

尝试：

```
<?php
$hashedBytes = base64_encode(md5($bString, true)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T22:59:36.713

虽然我不确定为什么要使用字节数组作为 md5 哈希，但这是我的解决方案：

```
<?php
    $stringToConvert = "äöüß";
    $md5 = md5(utf8_encode($stringToConvert), true);
    for($i = 0; $i < strlen($md5); $i++) {
        $c = ord($md5[$i]);
        $b[] = $c > 127 ? $c-256 : $c;
    }
    print_r($b);
?> 
```

# c++ - 分解出精神规则的共同部分

> ID：13388227
> 
> 赞同：2
> 
> 时间：2012-11-14T22:08:01.253
> 
> 标签：c++, boost-spirit

我有很多具有共同前缀和后缀的规则：

```
rule = begin_stuff >> some >> other >> stuff >> end_stuff. 
```

（其中`begin_stuff`和`end_stuff`由文字组成）

我想能够说

```
 rule = wrapped(some >> other >> stuff); 
```

我尝试了一些类似的东西

```
 template<typename Rule> Rule wrapped(Rule inside) 
  {
    Rule result;
    result = begin_stuff >> inside >> end_stuff;
    return result;
  } 
```

但我得到的只是来自 Qi 的大量编译时断言。

如何以这种方式重构 Spirit 规则？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T01:40:51.560

我认为您正在寻找“子规则”（Spirit V1/classical 曾经拥有）。这些现在已经过时了。

看一下

*   c++11`auto`和`BOOST_AUTO`

    ```
    auto subexpression = int_ >> ',' >> double_;
    qi::rule<It> rule  = "A:" >> subexpression >> "Rest:" >> (subexpression % eol); 
    ```

    使用`auto`Spirit 规则（尤其是 MSVC）曾经存在问题（请参阅[2 秒内从零到 60 MPH！](http://boost-spirit.com/home/articles/qi-example/zero-to-60-mph-in-2-seconds/)和评论），但我已被告知（很快）[不再是问题](http://boost.2283326.n4.nabble.com/What-happened-to-subrules-tc4636688.html)：

    > ```
    > Yep. Anyway,FYI, it's fixed in Spirit-3\. You can 
    > use auto all you want. 
    > 
    > Regards, 
    > -- 
    > Joel de Guzman 
    > ```

*   [齐::懒惰](http://www.boost.org/doc/libs/1_52_0/libs/spirit/doc/html/spirit/qi/reference/auxiliary/lazy.html)

*   [继承的参数](http://www.boost.org/doc/libs/1_52_0/libs/spirit/doc/html/spirit/qi/reference/parser_concepts/nonterminal.html#spirit.qi.reference.parser_concepts.nonterminal._code__phrase_role__identifier___r1__phrase___code_______code__phrase_role__identifier__r10__phrase___code_)- 在[Mini XML - ASTs](http://www.boost.org/doc/libs/1_52_0/libs/spirit/doc/html/spirit/qi/tutorials/mini_xml___asts_.html)教程中介绍

这是一个概念证明，它将一个公共子规则传递给不同的“复合”规则，以允许包装`()`,`[]`或`{}`:

```
#include <boost/spirit/include/qi.hpp>
#include <boost/spirit/include/phoenix.hpp>

namespace qi = boost::spirit::qi;
namespace phx = boost::phoenix;

typedef std::string::const_iterator It;

template <typename R>
    void test(const std::string& input, R const& rule)
{
    It f(input.begin()), l(input.end());
    bool ok = qi::phrase_parse(f,l,rule,qi::space);
    std::cout << "'" << input << "'\tparse " << (ok?"success":"failure") << "\n";
}

int main()
{
    typedef qi::rule<It,                    qi::space_type> common_rule;
    typedef qi::rule<It, void(common_rule), qi::space_type> compound_rule;

    common_rule common = qi::int_;

    compound_rule 
        in_parens   = qi::lit('(') >> qi::_r1 >> ')',
        in_brackets = qi::lit('[') >> qi::_r1 >> ']',
        in_braces   = qi::lit('{') >> qi::_r1 >> '}';

    test("{ 231 }"  , in_braces  (phx::ref(common )) );
    test("{ hello }", in_braces  (phx::val("hello")) );

    test("( 231 )"  , in_parens  (phx::ref(common )) );
    test("( hello )", in_parens  (phx::val("hello")) );

    test("[ 231 ]"  , in_brackets(phx::ref(common )) );
    test("[ hello ]", in_brackets(phx::val("hello")) );
} 
```

输出：

```
'{ 231 }'   parse success
'{ hello }' parse success
'( 231 )'   parse success
'( hello )' parse success
'[ 231 ]'   parse success
'[ hello ]' parse success 
```

PS。注意以上***不是***典型的 Spirit 语法。当“通用”规则会暴露不同的属性时，这种方式就不能很好地发挥作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-11T03:10:09.510

我认为您需要使用 Spirit Repository 中的Qi [Confix](http://www.boost.org/libs/spirit/repository/doc/html/index.html) [Parser Derective](http://www.boost.org/libs/spirit/repository/doc/html/spirit_repository/qi_components/directives/confix.html)。这正是您所需要的。

# ruby-on-rails - 乘客从网络服务器消失

> ID：13388239
> 
> 赞同：0
> 
> 时间：2012-11-14T22:08:43.477
> 
> 标签：ruby-on-rails, ruby, passenger, redhat

我有一个运行 ruby​​ on rails 应用程序和乘客的 Web 服务器，具有以下规格

```
Red Hat Enterprise Linux Server release 5.4 (Tikanga)
Server version: Apache/2.2.3
Server built:   May 28 2012 08:45:26
PHP 5.3.8 (cli) (built: Oct  3 2012 18:55:28) 
rvm 1.16.19 (stable)
ruby 1.8.7 (2012-02-08 MBARI 8/0x6770 on patchlevel 358) [x86_64-linux], MBARI 0x6770, Ruby Enterprise Edition 2012.02
Rails 3.2.8
Phusion Passenger version 3.0.18 
```

今天早上，我收到了来自服务器管理员的电子邮件，说该网站已开始返回错误。我登录服务器发现乘客不仅没有运行，而且有些已经从服务器上完全卸载。

这是服务器多次抛出的错误

```
ruby: No such file or directory -- /directory/rvm/gems/ree-1.8.7-2012.02/gems/passenger-3.0.18/helper-scripts/passenger-spawn-server (LoadError)
[ pid=3324 thr=48010014159632 file=ext/apache2/Hooks.cpp:884 time=2012-11-14     10:59:55.403 ]: Unexpected error in mod_passenger: Cannot spawn application '/var/www/html/application/current': Could not read from the spawn server: Connection reset by peer (104)
Backtrace:
 in 'virtual Passenger::SessionPtr Passenger::ApplicationPool::Client::get(const Passenger::PoolOptions&)' (Client.h:742)
 in 'Passenger::SessionPtr Hooks::getSession(const Passenger::PoolOptions&)' (Hooks.cpp:312)
 in 'int Hooks::handleRequest(request_rec*)' (Hooks.cpp:585) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T19:11:04.853

我通过像这样重新安装乘客来解决问题

```
gem install passenger 
```

我的所有配置仍然存在，它恢复了应用程序，就好像什么都没发生一样。

# java - Java 应用程序将与日志记录相关的错误消息打印到标准输出

> ID：13388244
> 
> 赞同：1
> 
> 时间：2012-11-14T22:09:01.200
> 
> 标签：java, log4j, slf4j, java.util.logging

当我运行我的 java 应用程序时，它会在标准输出中打印以下两行：

```
Bad level value for property: .level
Bad level value for property: java.util.logging.ConsoleHandler.level 
```

这似乎是从 java.util.logging (?)

但是在我的项目中，我使用的是 log4j 和 slf4j。据我所知，我没有直接使用 java.util.logging。

日志本身工作正常——我的日志属性文件被读取，日志输出被定向到输出文件。我只是想了解这些错误消息的来源。

当我在特定主机（运行 CentOS 6.2）上运行时，会输出这些消息。当我在 MacBook 上运行相同的程序时，我看不到错误。

任何关于我可以做些什么来进一步调试的建议将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-14T08:58:43.720

似乎即使不使用 java.util.logging 也会解析 logging.properties （至少 $PATH_TO_JAVA/jre/lib/logging.properties ），如果设置错误，java会抱怨。我设置了“.level = DEBUG”，但 DEBUG 不是允许的值。

# ios - 将数据导出/共享到另一个应用程序安装

> ID：13388255
> 
> 赞同：0
> 
> 时间：2012-11-14T22:09:44.520
> 
> 标签：ios, iphone, share

我想制作一个 iPhone 应用程序，它将一些信息本地保存在应用程序文件夹中，并且我还希望在不同设备上安装的其他应用程序上共享这些信息。

我举个例子：

在我的应用程序中，我可以读取和写入文件，并且可以将其内容保存在本地。始终在此应用程序中，有一个“共享”按钮，我可以通过该按钮将书面文件发送（例如通过电子邮件）给安装了相同应用程序的另一个用户。是否有可能在不通过矿山服务器的情况下做类似的事情，或者有必要在两个客户端应用程序之间建立基础设施以允许它们通信？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T08:38:55.337

在属于同一用户的两台设备之间共享文件的选项包括[iCloud](http://developer.apple.com/icloud/)和[DropBox](https://www.dropbox.com/developers/reference/sdk)。如果只有 iOS，前者可能是最简单的。

**编辑：**

我接受了“设备之间共享”的概念，但现在才注意到您正在谈论*在两个不同的人之间发送文件。*那是一个完全不同的蜡球。如果不同的人，那么这些都不适合（虽然 DropBox 可以在用户之间共享，但我怀疑 API 并不完全适合）。

对您来说不幸（但对我们其他人有好处），您不能让您的应用程序在目标设备上读取/拦截电子邮件。但是，如果可以，您可以定义自己的文件扩展名，通过电子邮件发送这样的文件，并且当删除 iPhone 收到文件时，当用户打开文件时，设备会知道打开您的应用程序（如果应用程序已安装）。[Ray Wenderlich 的文章](http://www.raywenderlich.com/1980/how-to-import-and-export-app-data-via-email-in-your-ios-app)中讨论了这种情况。

如果这不是一个选项，那么您肯定会谈论编写自己的服务器代码来接收、保存和根据请求将文件传递给目标用户。如果这是不可接受的，您将不得不分享一些关于应用程序如何知道一个用户正在向其他人发送内容的细节（不依赖于以编程方式接收电子邮件或 SMS）。而且，如果您不想将文件存储在服务器上，而是通过 Internet 直接对设备进行操作，您可能仍需要服务器来协调该过程。

# asp.net - 是否可以在 App_Folder 下为 mdf 文件运行查询分析器？

> ID：13388256
> 
> 赞同：2
> 
> 时间：2012-11-14T22:09:48.453
> 
> 标签：asp.net, sql-server-2008, profiling

我正在使用来自[http://www.codeproject.com/Articles/170921/MvcContrib-Grid-Paging-and-Searching-in-ASP-NET-MV](http://www.codeproject.com/Articles/170921/MvcContrib-Grid-Paging-and-Searching-in-ASP-NET-MV)的小型演示项目。它有一个带有数据库的 App_Data 文件夹，我想针对其数据库运行分析器以与我自己的项目进行比较。在我的项目中没有 App_data 文件夹，我的数据库在实际的 sqlexpress 上，并且我使用 Anjlab 作为分析器，我可以看到查询进入我自己的数据库没有任何问题，但我没有看到任何进入 App_data 文件夹的数据库。

我想知道是否有一种方法可以将探查器用于 App_data 文件夹下的 mdf 文件。

谢谢。

# html - 如何使 div 动态更改为内容宽度并使其保持该宽度，即使浏览器窗口改变大小？

> ID：13388257
> 
> 赞同：5
> 
> 时间：2012-11-14T22:09:53.387
> 
> 标签：html, css, width

看看这个：（场景1）

```
#container {
    height:150px;
    border:1px solid pink;
    width:1100px;
}
#widget {
    display:inline-block;
    width:100px;
    height:100px;
    background-color:red;
}​ 
```

[http://jsfiddle.net/DQFja/1/](http://jsfiddle.net/DQFja/1/)

非常简单。一个 div 里面有一堆其他的 div。父 div 的固定宽度约为 1000 像素，子 div 设置为 display:inline-block; 当您使浏览器窗口小于父窗口时，会出现一个滚动条，您可以滚动查看其余窗口。

现在看看这个：（场景2）

```
#container {
    height:150px;
    border:1px solid pink;
    float:left;
}
#widget {
    display:inline-block;
    width:100px;
    height:100px;
    background-color:red;
}​ 
```

[http://jsfiddle.net/zZRq7/](http://jsfiddle.net/zZRq7/)

相同的父项和子项，但父项的宽度由您放置在其中的 div 子项的数量动态确定。这是花花公子。但是，当您将浏览器窗口缩小时，父 div 变得与窗口一样宽，并且子 div 开始环绕，使父 div 更高（即使我们设置了固定高度！）

如何`div`像场景 2 一样使父级的宽度都动态化，但是当浏览器窗口变小时也保持其形状/高度/宽度，以便我们可以获得滚动条？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-14T22:16:46.810

`Min-width`是要走的路：

```
#container {
    height:150px;
    border:1px solid pink;
    min-width:1100px; // set the minimum width of the container to 1100px
    width: 100%; // if the window size is bigger than 1100px, then make the container span the entire window
} 
```

[在这里](http://jsfiddle.net/DQFja/2/)查看一个活生生的例子。

实现的一个hacky方法是使用`white-space`如下属性：

```
#container {
    border:1px solid pink;
    white-space: nowrap;
}
#widget {
    display: inline-block;
    width:100px;
    height:100px;
    background-color:red;
}​ 
```

[在此处](http://jsfiddle.net/DQFja/4/)查看实时示例

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-14T22:14:30.563

更新答案以包括空白行：

```
#container {
    height:150px;
    border:1px solid pink;
    white-space:nowrap;
    overflow:auto;
} 
```

[http://jsfiddle.net/DQFja/3/](http://jsfiddle.net/DQFja/3/)

# c# - C# 下拉列表选择的索引更改需要很多时间

> ID：13388259
> 
> 赞同：0
> 
> 时间：2012-11-14T22:10:06.047
> 
> 标签：c#, asp.net, webforms

我有一个带有计时器控件、1 个更新面板、几个下拉菜单等的网页。更改的选定索引上的许多下拉菜单需要显示超过 1 个附加控件或隐藏一些控件。问题是它需要很多时间以一种用户没有意识到它尚未完成事件点击的方式。请提出一些想法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T22:18:16.437

如果需要很长时间，我假设您在下拉选择更改时使用服务器端事件处理程序。当服务器端事件触发时，这意味着您的表单被发送回服务器，服务器重新呈现表单并将其发送回客户端，然后客户端替换更新面板的内容。因此，用户受制于可能导致缓慢的多种因素。

如果您可以选择，您可以重新设计页面，以便在客户端完成事件处理。您必须编写一些 JavaScript 代码并确保更新页面所需的数据可用于您的 JavaScript。如果您无法公开更新纯客户端所需的所有数据，则可以执行 Ajax 调用来获取您需要的数据；这应该比完整的部分回发更轻量级。

所有这些都是大量的工作，但应该让你的页面更快。当然，也许你真的不需要解决页面的速度问题，而是提供更好的反馈让用户知道页面正在更新。例如，如果您在进行部分回发时有一个“正在加载...”指示符，那么用户就会知道要等待。

# php - PHP MySQL插入语句不会插入数据

> ID：13388262
> 
> 赞同：0
> 
> 时间：2012-11-14T22:10:18.077
> 
> 标签：php, mysql

我在将字符串插入 MySQL 表时遇到问题。我的代码是：

```
mysql_query( "INSERT INTO jos_content (
    title, alias, introtext, metakey, state, created_by, metadesc)
VALUES ('$izv','$izv','$forprint','$mk',1,62,'$izv')" ); 
```

当变量`$forprint`不在查询中时，一切都按预期工作，但是当我添加它时，我的数据库不会更新。`$forprint`是一个长度超过 4000 个字符的字符串。

编辑：

使用 mysql_real_escape_string 输入已传递给 db，但有些缺失。

缺少的部分是：

```
<p><br></p><table style="text-align: left;" mce_style="text-align: left;" 
class="mceItemTable" border="0" width="100%"><tbody><tr><td colspan="2" 
rowspan="1"><h1 style="text-align: center;">HP</h1></br></br><h1 style="text-
align: center;" mce_style="text-align: center;"><br><p><br></p><p></h1></p><p><a 
href="#" mce_href="#" onclick="jwplayer().load('/templates/BV/list
/HP.xml')"><p style="text-align: center;" mce_style="text-align: 
center;">SDS</p></a><br mce_bogus="1"></p><br mce_bogus="1"></td></tr> 
```

所以在我从 $forprint 生成的 exit.txt 中，所有数据都在那里，但是在 DB 中，这部分和表的关闭部分丢失了。

EDIT2：PDO 完成了这项工作，谢谢您的建议。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-14T22:12:54.060

的内容是`$forprint`什么？它包含`'`吗？如果是这样，那将导致问题。内容是否`$forprint`来自用户？如果是这样，你有**严重**的问题。

## 你没有逃避你的变量，这可能会因为允许[SQL 注入攻击而变得极其危险](http://en.wikipedia.org/wiki/SQL_injection)

尝试使用[`mysql_real_escape_string`](http://php.net/manual/en/function.mysql-real-escape-string.php)

例如：

```
$con = mysql_connect("localhost","root","");
if (!$con)
  die('Could not connect: ' . mysql_error());

mysql_select_db("balkan", $con);

$izv_safe = mysql_real_escape_string($izv,$con);
$mk_safe = mysql_real_escape_string($mk,$con);
$forprint_safe = mysql_real_escape_string($forprint,$con);

$query = <<<END_OF_SQL
  INSERT INTO jos_content (title, alias, introtext, metakey, state, created_by, metadesc)
  VALUES ('$izv_safe','$izv_safe','$forprint_safe','$mk_safe',1,62,'$izv_safe')"
END_OF_SQL;

mysql_query($query,$con); 
```

更好的是，[通过 mysqli](http://www.php.net/manual/en/mysqli.quickstart.prepared-statements.php)或[PDO](http://php.net/manual/en/book.pdo.php)使用准备好的语句。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T22:12:57.370

检查`varchar`column 类型的长度`introtext`，并将其设为 4000+ 字符`say varchar(6000)`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T22:13:34.730

我确定有一个单引号，它破坏了插入查询。

您必须转义字符串上的引号。

就像是，

```
mysql_query("INSERT INTO jos_content 
            (title, alias, introtext, metakey, state, created_by, metadesc)
            VALUES (
              '".mysql_real_escape_string($izv)."',
              '".mysql_real_escape_string($izv)."',
              '".mysql_real_escape_string($forprint)."',
              '".mysql_real_escape_string($mk)."',
              1,
              62 ,
              '".mysql_real_escape_string($izv)."'
            )
"); 
```

当然，您应该对所有文本输入做同样的事情。

# c# - 服务器缓解 P2P 连接

> ID：13388268
> 
> 赞同：1
> 
> 时间：2012-11-14T22:10:44.803
> 
> 标签：c#, .net, windows, winforms, pnrp

我正在用 C# 编写一个系统，该系统由 1 个桌面应用程序（我称之为“主机”）组成，这些应用程序通过 Internet 连接到多个“客户端”应用程序。“主机”应该能够检索状态信息（至少客户端应用程序是否正在运行）以及将文件发送到客户端计算机。客户端计算机不必相互查看或通信。客户端应用程序将 24/7 全天候运行，但主机应用程序仅在用户想要检查运行客户端应用程序的 PC 时运行。

我已经对微软的 PNRP 进行了相当多的阅读，并认为我将使用基于此的系统来减轻主机和客户端之间的连接 - 即每个客户端应用程序检测到 WAN IP 更改，并将其新 IP 报告给 linux我拥有的服务器。当主机应用程序想要连接时，它将连接到服务器，进行身份验证，并获取客户端应用程序的 WAN IP 列表。

从这里，我想直接从主机应用程序连接到每个客户端应用程序。为了减轻服务器上的负载，我不想通过服务器发送文件或状态信息。最好的方法是什么？每个客户端应用程序都可能在防火墙、NAT 等之后，我将无法手动进行端口转发（尽管我可以在它工作时使用 uPnP）。

PS - 你会建议任何 PNRP 替代品吗？我会直接使用 PNRP，除了 (1) 出于安全原因我需要使用我自己的种子服务器 (linux) 而不是 microsoft PNRP 种子服务器，并且我的理解是 PNRP 仅适用于 Windows 和 (2) PNRP 仅适用于ipv6，网络（和 ISP）可能并不总是支持。

# c# - 使用 object.Equals 比较两个 float[] 数组元素是否相等

> ID：13388271
> 
> 赞同：1
> 
> 时间：2012-11-14T22:10:59.103
> 
> 标签：c#, .net, c#-4.0

我有两个`float[]`对象。在不编写 for 循环的情况下，我想比较我的两个一维数组，看看它们在数值上是否相等。

当我运行以下代码时（因为所有元素都相等），它不会通过 if 语句并显示消息。

我应该如何应用**Equals**命令才能正常工作？
我可以使用任何比较命令吗？

```
 Random r1 = new Random(1);
   int rndNumber= r1.Next(10);
   float[] m = Enumerable.Repeat((float)rndNumber, 180).ToArray();
   float[] m2 = Enumerable.Repeat((float)rndNumber, 180).ToArray();
   if (m.Equals(m2))
    {
    MessageBox.Show("we are equal");
   } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-14T22:13:29.537

`Equal`for的方法不会从仅比较对象的引用（不相等）`Array`的默认实现中被覆盖。`object`

您想比较序列中每个元素的值，并确保它具有相同的内容以相同的顺序。为此，请使用`SequenceEqual`in `System.Linq.Enumerable`。

```
if(m.SequenceEqual(m2)) {...} 
```

在内部，该方法将遍历每个序列的每个元素并调用`Equals`每个元素对以验证它们是否相同。虽然这肯定比 for 循环*更容易*使用（并且可以说更具可读性），但请记住，它不会比使用`for`循环更好，它只是对你隐藏了循环。

# c# - 如何从偶尔发出非常慢请求的 IEnumerable 中有效地跳过项目？

> ID：13388272
> 
> 赞同：1
> 
> 时间：2012-11-14T22:11:04.083
> 
> 标签：c#, .net, linq

我有以下代码：

```
class Program
{
    static void Main(string[] args)
    {
        foreach (var item in GetEnumerable().Skip(100))
        {
            Console.WriteLine(item);
        }
    }
    static IEnumerable<int> GetEnumerable(int? page = null, int limit = 10)
    {
        var currentPage = page ?? 1;
        while (true)
        {
            Thread.Sleep(1000); // emulates slow retrieval of a bunch of results
            for (int i = limit * (currentPage - 1); i < limit * currentPage; i++)
            {
                yield return i;
            }
            currentPage++;
        }
    }
} 
```

我希望能够`.Skip(n)`有效地跳过我不需要的结果。因此，例如，如果我使用`Skip(100)`并且每个请求检索 10 个项目，则应完全跳过前 10 个请求。

有没有我可以用来实现这一目标的模式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T22:43:49.060

您可以创建自己的`IEnumerable<int>`类型并提供自己的实现`Skip`：

```
public class PagedEnumerable : IEnumerable<int>
{
    private readonly int currentPage;
    private readonly int limit;

    public PagedEnumerable(int currentPage, int limit)
    {
        this.currentPage = currentPage;
        this.limit = limit;
    }

    public PagedEnumerable Skip(int count)
    {
        int pages = count / this.limit;
        return new PagedEnumerable(this.currentPage + pages, this.limit);
    }

    public IEnumerator<int> GetEnumerator()
    {
        int pageNo = this.currentPage;
        while (true)
        {
            Thread.Sleep(1000);
            for (int i = this.limit * (pageNo - 1); i < (this.limit * pageNo); i++)
            {
                yield return i;
            }
            pageNo++;
        }
    }

    System.Collections.IEnumerator System.Collections.IEnumerable.GetEnumerator()
    {
        return this.GetEnumerator();
    }
} 
```

然后，您可以将您的替换`GetEnumerable`为：

```
static PagedEnumerable GetEnumerable(int? page = null, int limit = 10)
{
    var currentPage = page ?? 1;
    return new PagedEnumerable(currentPage, limit);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-14T22:27:52.713

如果您想对“页面”进行延迟评估，则不应在 while 循环中加载它。

相反，您可以做的是返回一个 lambda 并从中返回页面，就像这样。

```
// return a list of funcs, where each one returns a loaded page
static IEnumerable<Func<int>> GetEnumerable(int? page = null, int limit = 10)
{
    var currentPage = page ?? 1;
    while (true)
    {
        for (int i = limit * (currentPage - 1); i < limit * currentPage; i++)
        {
            yield return () => {
               Thread.Sleep(1000);
               return i;
            };
        }
        currentPage++;
    }
} 
```

从消费者线程中，您只需执行返回的函数即可获取页面。

```
foreach (var item in GetEnumarable().Skip(100).Take(10))
{
    Console.WriteLine(item());
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-15T00:40:53.847

这是我对此的看法。我使用 lambda 表达式以 Patrick 的想法为基础，但我已对其进行了修复，以便它仅在需要时评估每个批次，并且不超过一次。

```
static IEnumerable<Func<int>> GetEnumerable(int? page = null, int limit = 10)
{
    var currentPage = page ?? 1;
    while (true)
    {
        var thisPage = currentPage;
        List<int> thisPageResult = null;

        // Function that evaluates this batch and returns the result
        Func<List<int>> getPageResult = () =>
        {
            // only evaluate this batch once
            if (thisPageResult == null)
            {
                // slow retrieval of a bunch of results happens here
                Thread.Sleep(1000);
                // store the result for future calls
                thisPageResult = Enumerable.Range(limit * (thisPage - 1), limit).ToList();
            }
            return thisPageResult;
        };

        for (int i = 0; i < limit; i++)
        {
            var j = i;
            // lazy: evaluate the batch only if requested by client code
            yield return () => getPageResult()[j];
        }

        currentPage++;
    }
}

static void Main(string[] args)
{
    foreach (var func in GetEnumerable().Skip(100).Take(10))
    {
        Console.WriteLine(func());
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-14T22:14:31.047

让它成为方法中的第一个参数，不要给它一个默认值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-16T17:28:42.617

希望有人发现这种方法有帮助。.NET 中的通用 Lazy 类适用于这种情况。

```
//Enumerable over all of the pages you want to possibly retrieve from:
IEnumerable<Lazy<Page>> pages = Enumerable
    .Range(0, 5)
    .Select(i => new Lazy<Page>(() => LoadPage(i)));
//Now if each page contains 10 items, and you want to skip the first
//35 items (and thus not load the first 3 pages), do this:
var items = pages
    .SelectMany(page => Enumerable
        .Range(0, 10)
        .Select(i => () => page.Value.GetItem(i)))
    .Skip(35) //any combination of Take, Skip, etc. could go here
    .Select(itemGetter => itemGetter())
    .ToList(); 
```

# c# - 尝试更新数据库时并发冲突（仅在特定表上）

> ID：13388282
> 
> 赞同：0
> 
> 时间：2012-11-14T22:11:42.893
> 
> 标签：c#, mysql

这个问题快把我逼疯了。

我正在尝试使用 MySQL dataAdapter 更新数据集。此方法适用于我数据库中的其他表，它只是发生在此表中。以下是代码示例：

```
 String query = "select * from accounts";
    DataSet dataSet = new DataSet();
    connection.Open();
    MySqlDataAdapter dataAdapter = new MySqlDataAdapter(query, (MySqlConnection)connection);
    MySqlCommandBuilder commandBuilder = new MySqlCommandBuilder(dataAdapter);
    dataAdapter.FillSchema(dataSet, SchemaType.Source);
    commandBuilder.RefreshSchema();
    dataAdapter.Fill(dataSet);

    dataSet.Tables[0].Rows[0]["balance"] = 1M;
    dataAdapter.Update(dataSet); 
```

一旦它尝试更新它就会抛出异常。请记住，这是我的代码的简化示例，但它得到了相同的结果。

我已经研究了这个错误，我能找到的只是：
1）如果这个数据自填充后被另一个用户更改了
2）如果该行不存在。

但是其他用户不可能更改数据，因为这发生在我的开发机器上。并且该行显然存在，因为它不会在 Rows[0] 处引发异常。

正如我所说，这只发生在这张桌子上。该表有一个 int 作为主键，而我要更新的列是 Decimal，所以我不知道问题出在哪里。

谢谢你的任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-14T14:44:24.593

我知道这是不久前发布的，但我刚刚找到了解决问题的方法：

似乎问题出在表结构或类似的东西上。我在表上做了一个 mysqldump，然后只导入了转储（它基本上是从头开始构建表）。在我这样做之后，一切都像魅力一样。

希望我可以帮助遇到这个奇怪问题的其他人。

# java - Joda Time LocalDate(Object instant, DateTimeZone zone) 构造函数的目的

> ID：13388283
> 
> 赞同：7
> 
> 时间：2012-11-14T22:11:45.080
> 
> 标签：java, timezone, jodatime

Joda Time`LocalDate`将自己描述为：

> LocalDate 是一个不可变的日期时间类，表示没有时区的日期。

然而，有一个[`LocalDate(Object instant, DateTimeZone zone)`](http://www.joda.org/joda-time/apidocs/org/joda/time/LocalDate.html#LocalDate%28java.lang.Object,%20org.joda.time.DateTimeZone%29)接受时区的构造函数。如果对象是无时区的，那么时区构造函数的目的是什么？

构造函数 JavaDocs 指出：

> 从表示日期时间的 Object 构造一个实例，将时区强制为指定的时区。

我不知道“将时区强制为指定的时区”是什么意思，因为该对象是无时区的。也许它在内部转换为 UTC，然后丢弃时间（保留日期）。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-19T17:10:55.680

**瞬间**是物理学领域的一个概念。这是一个定义明确**的时间点**，无论您如何表示它。从概念上讲，它与时区、日历或任何人类文化惯例无关。

例如：[阿波罗 XI 号登陆月球](http://en.wikipedia.org/wiki/Apollo_11#Landing)的那一刻，或者 J. Kennedy 被枪杀的那一刻，都是瞬间。每一个都可以用几种方式表示：儒略历，从泰坦尼克号撞上冰山那一刻起的几秒钟，一些生活在火星上的外星人使用的日历......所有这些都是不同的表示，但瞬间将是一个（就像`1903`，`0x76F`或者`MCMIII`是相同数字的不同表示）。

现在，如果您想将“阿波罗 XI 登月瞬间”转换为**LocalDate**（地球公历中使用的日-月-年），您将进入一个完全不同的领域，并且 - 一方面- 您需要知道时区，因为在某些国家/地区，即时（1969 年 7 月 20 日，20:17:40 UTC）对应于 1969 年 7 月 20 日，[在其他国家/地区对应于 7 月 21 日](http://www.timeanddate.com/worldclock/converted.html?iso=19960720T20&p1=0&p2=540&p3=&p4=&p5=&p6=&p7=&p8=&p9=&p10=&p11=&p12=)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-15T10:51:59.897

在不知道时区（或至少与 UTC/格林威治的偏移量）的情况下，您无法从瞬间转换为本地日期或时间。由于第一个参数是一个瞬间（例如`Long`or `java.util.Date`，所以需要第二个参数来指定要使用的时区。

请注意，还有一个`LocalDate(Object)`在内部使用默认时区的构造函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-14T22:18:59.257

您应该阅读整个 JavaDoc：

> 如果对象不包含年表，则使用 ISOChronology。如果指定的时区为空，则使用默认时区。构造函数完成后，不再使用该区域。
> 
> 可识别的对象类型在 ConverterManager 中定义，包括 ReadablePartial、ReadableInstant、String、Calendar 和 Date。字符串格式由 ISODateTimeFormat.localDateParser() 描述。默认的字符串转换器会忽略该区域并仅解析字段值。

这样，日期（字符串、日历、日期等）的表示形式与指定的时区一起为您提供本地时间。

例如，如果您有`java.util.Date`日期的表示，那么它的本地时间取决于时区。通过指定时区，您可以定义本地时间。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-12-12T19:17:43.380

（回复乔达斯蒂芬）

> 请注意，还有一个`LocalDate(Object)`在内部使用默认时区的构造函数。

请注意，如果您使用带有 a`java.util.Date`作为即时的构造函数，则“默认时区”将是 UTC，而不是某些人所期望**的 JVM 默认时区。**（我假设`LocalDate`从 a`java.util.Date`或其本机“yyyy-MM-dd”表示创建 a 意味着相同的事情，并且因为`java.util.Date.toString()`使用 JVM 默认时区......）

因此，要将 a 正确转换为`java.util.Date`不考虑时区而创建的 a （例如，简单地从“yyyy-MM-dd”字符串解析）到 a `LocalDate`，您必须执行以下操作：

```
LocalDate localDate = new LocalDate(javaUtilDate,
                              DateTimeZone.forTimeZone(TimeZone.getDefault())); 
```

至少 JodaTime 2.2 是这样。我们已经调试到代码中。

# asp-classic - 追溯剥离 MS Word 格式

> ID：13388284
> 
> 赞同：0
> 
> 时间：2012-11-14T22:11:54.857
> 
> 标签：asp-classic, ms-word

我有一个 ASP 网站，其中数百名用户提交了从 MS Word 粘贴的论文问题答案。一旦粘贴到编辑器中，他们没有意识到格式没有被剥离并继续提交。系统在 MS SQL Server 上运行。有什么办法让我不必回到所有这些用户并自己删除不可读的字符/格式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T11:34:50.753

在显示内容之前，我会使用正则表达式来删除 div、字体、样式等标签。

例如删除所有字体标签：

```
<font[^><]*>|<.font[^><]*> 
```

# php - 无法从文件中反序列化序列化的 getimagesize 数组

> ID：13388285
> 
> 赞同：0
> 
> 时间：2012-11-14T22:11:54.957
> 
> 标签：php

我有一个文件“serialized.txt”，其中包含一个序列化数组（通过执行 serialize($array) 创建）。

```
s:133:"a:7:{i:0;i:640;i:1;i:480;i:2;i:2;i:3;s:24:"width="640" height="480"";s:4:"bits";i:8;s:8:"channels";i:3;s:4:"mime";s:10:"image/jpeg";}"; 
```

要获取我做的内容：

```
$string = file_get_contents("serialized.txt"); 
```

然后我做：

```
print_r(unserialize($string)); 
```

我得到的输出：

```
a:7:{i:0;i:640;i:1;i:480;i:2;i:2;i:3;s:24:"width="640" height="480"";s:4:"bits";i:8;s:8:"channels";i:3;s:4:"mime";s:10:"image/jpeg";} 
```

当它应该打印未序列化的数组时，这是字符串的未序列化版本（文件的内容）。如果我复制字符串并执行以下操作：

```
print_r(unserialize('a:7:{i:0;i:640;i:1;i:480;i:2;i:2;i:3;s:24:"width="640" height="480"";s:4:"bits";i:8;s:8:"channels";i:3;s:4:"mime";s:10:"image/jpeg";}')); 
```

我得到正确的输出：

```
Array
(
    [0] => 640
    [1] => 480
    [2] => 2
    [3] => width="640" height="480"
    [bits] => 8
    [channels] => 3
    [mime] => image/jpeg
) 
```

因此，从文件中提取时，问题似乎与序列化数组隔离。

根据反[序列化](http://php.net/manual/en/function.unserialize.php)文档，如果出现问题，该函数应该返回**false ；**不是字符串的内容。

序列化数据取自[getimagesize](http://php.net/manual/en/function.getimagesize.php)，我已经验证如果我序列化另一个数组并将其放入文件中：

```
serialize(array("hi")); 
```

我可以成功生成输出：

```
Array
(
    [0] => hi
) 
```

有什么想法为什么会发生这种情况？与 getimagesize 数组相关的序列化过程中的错误，或者可能是我的复制和粘贴删除的文件中的“隐藏”字符？我已经生成了数百万个这样的文件，因此我无法更改存储方法。我想解决方案可能只是编写我自己的解析器来序列化数组？输入总是相同的格式，所以这是合理的，但我想知道这是一个错误或我在某处的错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T22:16:06.767

据我所见，您的数据是双重序列化的，因此以下代码应打印您的数组：

```
$string = file_get_contents("serialized.txt");
print_r(unserialize(unserialize($string))); 
```

尽管您应该考虑如何保存到文件。您可能想要删除一个序列化。

这能解决你的问题吗？

# javascript - 通过aspx应用访问远程数据

> ID：13388287
> 
> 赞同：0
> 
> 时间：2012-11-14T22:12:01.753
> 
> 标签：javascript, asp.net, ruby

我的工作场所将客户记录保存在数据库中，该数据库可通过托管在我们本地网络上的 aspx 应用程序访问。该页面允许登录、简单搜索和检索显示在此网页上的信息。我正在执行的一项任务需要我访问每条记录，将一段文本复制到我们正在创建的新数据库中，然后移动到下一条记录（数千次）。

我的问题是，有没有办法自动化这个？我查看了浏览器宏，但搜索每条记录的任务不允许使用简单的宏接口。我希望编写一个无需浏览器即可直接与 aspx 应用程序交互的程序。在代码中，我可以告诉应用程序我正在寻找哪些记录（例如，按日期或唯一 ID），并让 aspx 应用程序返回我需要的相应文本字段。我对 aspx 应用程序没有任何后端访问权限（它是第三方专有应用程序，他们的开发人员对帮助我完成这项任务不感兴趣）

1.  这可以做到吗？
2.  如果是，从广义上讲，我应该考虑什么样的解决方案？是否有更适合此任务的特定语言？

任何帮助表示赞赏。我意识到这个问题有点模糊和广泛，但第三方应用程序只在本地托管，所以我不能举个例子。我知道一点红宝石，遇到了宝石 Mechanize，看起来它可能会工作......但我找不到太多关于与 asp.net 交互的信息

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T03:04:47.360

您在 ruby​​ mechanize 的正确轨道上。Mechanize 将为您跟踪 cookie 并使提交表单变得容易（登录、asp doPostBack 操作）。试一试，如果遇到困难，请在新问题中发布具体信息。

# java - 无法使用 cygwin 编译 java 文件

> ID：13388295
> 
> 赞同：2
> 
> 时间：2012-11-14T22:12:34.250
> 
> 标签：java, cygwin, classpath

我正在尝试使用 cygwin shell 编译一些文件。

我试图编译的 java 文件是 C:\Users\Programs\x.java

对于 windows 命令提示符

> C:\用户\程序>javac x.java

没有错误。

对于 Cygwin 外壳

> $ javac /c​​ygdrive/c/Users/Programs/x.java

错误：

> javac：找不到文件：\cygdrive\c\Users\Programs\x.java

为什么我在 cygwin shell 中出现错误，尽管它在 windows 命令提示符下运行

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-14T22:19:19.573

`javac`是 Windows 应用程序。它没有任何线索`/cygdrive`。始终牢记这一点并传递有效的 Windows 路径。

所以使用`javac 'c:/Users/Programs/x.java'`or`javac c\:/Users/Programs/x.java` 另外，就像在大多数 Unix shell 中一样，如果你需要使用它，\ 必须被转义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T22:21:48.700

I think that the problem is that "cygdrive" is a pseudo-device that is implemented in a Cygwin-specific library. If the executable you are running has not been linked against that library (and the Oracle Java executables have not!) it won't correctly resolve the "/cygdrive" path component.

# php - 以 HTML 格式显示的 PHP MySQL 函数

> ID：13388301
> 
> 赞同：0
> 
> 时间：2012-11-14T22:13:03.877
> 
> 标签：php, mysql, function

我有这个功能：

```
function get_current_users($current_users) 
{
global $db;
$current_users = $db->EscapeString($current_users);
$total_current_users = $db->QueryFetchArray("SELECT COUNT(*) FROM users AS total_current_users");
return $total_current_users['total_current_users']; 
```

}

但我不知道如何输出结果，我尝试了以下选项但没有显示：

```
 `<?$total_current_users?>
 <?['$total_current_users']?>
 <?=data['$total_current_users']?>` 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T22:18:49.410

如果您确定您的函数完成了它应该做的事情，我猜这两种等效方法将为您提供输出：

`<?= get_current_users() ?>`或者 `<?php echo get_current_users() ?>`

作为说明：我没有看到您逃避的论点`$current_users`- 因为它永远不会在后续查询中使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T22:16:50.370

试试这个语法

```
$total_current_users = $db->QueryFetchArray("SELECT COUNT(*) as total_current_users FROM users"); 
```

您正在从结果集中选择一个值以返回，该值未命名，请尝试上述方法以使其与您的代码匹配。

然后将模板代码更改为：`<?php echo $total_current_users; ?>`

# php - 如何轻松地从 PHP 代码中进行 POST？

> ID：13388304
> 
> 赞同：0
> 
> 时间：2012-11-14T22:13:12.373
> 
> 标签：php, http-post

> **可能重复：**
> [PHP + curl、HTTP POST 示例代码？](https://stackoverflow.com/questions/2138527/php-curl-http-post-sample-code)
> [POST 数据到 URL php](https://stackoverflow.com/questions/3080146/post-data-to-url-php)
> [如何发出 HTTP POST 请求？](https://stackoverflow.com/questions/3084834/how-to-issue-http-post-request)

我创建了一个拦截常规帖子的脚本，并根据用户名做一件事或另一件事。

在一个条件分支中，我想移动用户并将他在登录表单中写下的内容发布到另一个 PHP 脚本。

如何轻松地向 URL 发出 POST 请求？

有没有类似的东西：

```
$data = array("username" => "admin", "password" => "hunter2");

http_post("foo.com", "POST", $data); 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-14T22:16:23.710

像这样：

```
// Create map with request parameters
$params = array ('surname' => 'Filip', 'lastname' => 'Czaja');

// Build Http query using params
$query = http_build_query ($params);

// Create Http context details
$contextData = array (
            'method' => 'POST',
            'header' => "Connection: close\r\n".
                        "Content-Length: ".strlen($query)."\r\n",
            'content'=> $query );

// Create context resource for our request
$context = stream_context_create (array ( 'http' => $contextData ));

// Read page rendered as result of your POST request
$result =  file_get_contents (
              'http://www.sample-post-page.com',  // page url
              false,
              $context);

// Server response is now stored in $result variable so you can process it 
```

来源： http: [//fczaja.blogspot.ch/2011/07/php-how-to-send-post-request-with.html](http://fczaja.blogspot.ch/2011/07/php-how-to-send-post-request-with.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T22:15:28.143

这就是 curl 函数存在的目的。参见，例如：[http ://davidwalsh.name/curl-post](http://davidwalsh.name/curl-post)

# servicestack - 十进制值后无法识别的参数

> ID：13388321
> 
> 赞同：1
> 
> 时间：2012-11-14T22:14:26.177
> 
> 标签：servicestack

如果前面的参数（纬度和经度）在 URL 中没有小数点，ServiceStack 会识别参数（在我的例子中是 RADIUS）。一旦我将小数点放在纬度或经度上，我就会得到一个“未找到请求的处理程序”。以下是我的代码和错误

这是位置类

```
public class Location
{
    [DataMember(Name = "Latitude", Order = 5)]
    public double? LATITUDE { get; set; }
    [DataMember(Name = "Longitude", Order = 6)]
    public double? LONGITUDE { get; set; }
    [DataMember(Name = "Radius", Order = 7)]
    public double? RADIUS { get; set; }
} 
```

这是我的 AppHost 路径定义

```
Routes.Add<Location>("/Locate/geo/{LATITUDE}/{LONGITUDE}", "GET");
Routes.Add<Location>("/Locate/geo/{LATITUDE}/{LONGITUDE}/rad/{RADIUS}", "GET");
Routes.Add<Location>("/Locate/rad/{RADIUS}/geo/{LATITUDE}/{LONGITUDE}", "GET"); 
```

下面是我的结果

作品

```
http://localhost:2222/api/Locate/geo/30.1783/-96.3911?format=xml
http://localhost:2222/api/Locate/rad/20/geo/30.1783/-96.3911?format=xml 
```

不工作

```
http://localhost:2222/api/Locate/geo/30.1783/-96.3911/rad/20?format=xml 
```

- 我收到以下错误

未找到请求的处理程序：

请求.应用程序路径：/

Request.CurrentExecutionFilePath：/api/Locate/geo/30.1783/-96.3911

请求文件路径：/api/Locate/geo/30.1783/-96.3911

请求.HttpMethod: GET

Request.MapPath('~'): C:\Webservices\

请求路径：/api/Locate/geo/30.1783/-96.3911/rad/20

请求路径信息：/rad/20

Request.ResolvedPathInfo: /rad/20

Request.PhysicalPath：C:\Webservices\api\Locate\geo\30.1783-96.3911

Request.PhysicalApplicationPath: C:\Webservices\

Request.QueryString：格式=xml

Request.RawUrl：/api/Locate/geo/30.1783/-96.3911/rad/20?format=xml

Request.Url.AbsoluteUri：[http://localhost:2222/api/Locate/geo/30.1783/-96.3911](http://localhost:2222/api/Locate/geo/30.1783/-96.3911) /rad/20?format=xml

Request.Url.AbsolutePath：/api/Locate/geo/30.1783/-96.3911/rad/20

Request.Url.Fragment：

Request.Url.Host：本地主机

Request.Url.LocalPath：/api/Locate/geo/30.1783/-96.3911/rad/20

Request.Url.Port: 2222

Request.Url.Query: ?format=xml

Request.Url.Scheme：http

Request.Url.Segments：System.String[]

App.IsIntegratedPipeline：假

App.WebHostPhysicalPath: C:\Webservices

App.DefaultHandler: DefaultHttpHandler

App.DebugLastHandlerArgs: GET|/api/Locate/geo/30.1783/-96.3911|C:\Webservices\api\Locate\geo\30.1783-96.3911

如果小数是问题，想知道带有 Lat 和 Long 的第一个 URL 如何使用小数。如果任何 AppHost 路径错误，请纠正我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T22:25:56.243

[从这个先前的答案](https://stackoverflow.com/a/12872793/85785)：

ServiceStack 的 Routes 中有 2 个组件分隔符：`.` 和`/`，这是一个示例，显示了[ServiceStack 支持的不同 Route 路径](https://github.com/ServiceStack/ServiceStack/blob/master/tests/ServiceStack.ServiceHost.Tests/RestPathTests.cs#L99)。

您可以尝试对 url 进行编码，`.`否则`%2E`只需将操作添加为查询字符串参数，例如：`/path/to/me%40example.com?action=action`

# c# - 持续联系 - 更新联系

> ID：13388327
> 
> 赞同：0
> 
> 时间：2012-11-14T22:14:38.617
> 
> 标签：c#, asp.net, constantcontact

我正在尝试使用 **Utility.UpdateContactFullForm(authenticationData, contact);更新列表中已存在的联系人。**

但是，我收到一条错误消息： **远程服务器返回错误：(500) 内部服务器错误。**

**说明：**执行当前 Web 请求期间发生未处理的异常。请查看堆栈跟踪以获取有关错误及其源自代码的位置的更多信息。

**异常详细信息：** System.Net.WebException：远程服务器返回错误：（500）内部服务器错误。

**源错误：** 在执行当前 Web 请求期间生成了未处理的异常。可以使用下面的异常堆栈跟踪来识别有关异常起源和位置的信息。

我已经引用了**ConstantContactBO.dll**和**ConstantContactUtility；**

我似乎无法找出问题所在，非常感谢任何帮助。谢谢。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using ConstantContactBO;
using ConstantContactUtility;

public partial class hmm : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        string nextChunkId;
        Contact contact = new Contact();
        //Authentication Data
        AuthenticationData authenticationData = new AuthenticationData();
        authenticationData.Username = "";
        authenticationData.Password = "";
        authenticationData.ApiKey = "";

        // get user Contact List collection
        IList<ContactList> lists = Utility.GetUserContactListCollection(authenticationData, out nextChunkId);

        //Search for Contact By Email
        string x = "a@a.com";
        string[] emailAddress = new string[] { x.Trim() };
        IList<Contact> myList = Utility.SearchContactByEmail(authenticationData, emailAddress, out nextChunkId);

        for (int i = 0; i < myList.Count; i++)
        {
            contact.Id = myList[0].Id;
            contact.FirstName = Server.HtmlEncode("abc");
            contact.LastName = Server.HtmlEncode("def");
            contact.EmailAddress = Server.HtmlEncode("a@a.com");

            ContactOptInList theList = new ContactOptInList();
            theList.OptInSource = ContactOptSource.ActionByContact;
            theList.ContactList = new ContactList("39");
            contact.ContactLists.Add(theList);
              Utility.UpdateContactFullForm(authenticationData, contact);
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T20:16:58.770

我错过了包括以下内容：

```
 Contact thisContact = Utility.GetContactDetailsById(authenticationData, myContact[0].Id);
           // //Add Lists
            ContactOptInList newList = new ContactOptInList();
            //thisContact.OptInSource = ContactOptSource.ActionByCustomer;
            newList.ContactList = new ContactList("39"); //Contact list you want to add them to
            newList.ContactList = new ContactList("10"); //Contact list you want to add them to
            thisContact.ContactLists.Add(newList);

            //Update contact
            Utility.UpdateContactFullForm(authenticationData, thisContact); 
```

# python - 在一维上绘制熊猫面板

> ID：13388330
> 
> 赞同：0
> 
> 时间：2012-11-14T22:14:50.577
> 
> 标签：python, pandas

我有一个数据面板，我想切片数据来绘制它。

例如。次要维度上的切片。数据是

```
<class 'pandas.core.panel.Panel'>
Dimensions: 71 (items) x 192 (major) x 19 (minor)
Items: gain to gain_delta
Major axis: AFG to ZWE
Minor axis: ISO3 to 2011 
```

所以如果我想绘制这个切片：

```
scores.ix[['gain'],['ESP'],2:21] 
```

给

```
<bound method Panel.to_frame of <class 'pandas.core.panel.Panel'>
Dimensions: 1 (items) x 1 (major) x 17 (minor)
Items: gain to gain
Major axis: ESP to ESP
Minor axis: 1995 to 2011> 
```

但这些都给出错误：

```
scores.ix[['gain'],['ESP'],2:21].plot()

scores.ix[['gain'],['ESP'],2:21].to_frame.plot()

a=scores.ix[['gain'],['ESP'],2:21]
plot(a) 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T23:41:26.073

我不认为你可以绘制一个面板。

要从面板中提取系列（和绘图），您可以使用`ix`以下语法：

```
scores.ix['gain', 'ESP', 2:21].plot() 
```

# c++ - 在各自的线程上运行多个对象似乎多次运行同一个对象

> ID：13388334
> 
> 赞同：3
> 
> 时间：2012-11-14T22:15:04.273
> 
> 标签：c++, multithreading, oop, winapi, object

我正在尝试创建一个类的 12 个新实例并运行它们中的每一个，它是一个自己的线程，但它们会共享相同的数据。所有 12 个实例都在相同的 X 和 Y 位置，但它们每个都应该在随机方向上移动。正如您在代码中看到的那样，我尝试了各种 apraoches，但我无法找出原因。

我在这里做错了什么？

ps是的...我知道还有一些未使用的变量。pss 在我发布问题之前，我已经看过很多地方和这里

敌人.cpp

```
#include "enemy.h"
#include <time.h>
#include <windows.h>

FILE* pEnemyFile = fopen ("enemylog.txt","w");

Enemy::Enemy(const MouseServer& mServer, int& lastMousePosX, int& lastMousePosY, int& winSizeX, int& winSizeY )
    :mouseServer(mServer),
    lastMouseX( ( lastMousePosX ) ? lastMousePosX : 0 ), // evaluate if we get the reference
    lastMouseY( ( lastMousePosY ) ? lastMousePosY : 0 ),
    myPositionX(0),
    myPositionY(0),
    winSizeX(winSizeX),
    winSizeY(winSizeY),
    x(0),
    y(0)
{
    // original source:
    // http://msdn.microsoft.com/en-us/library/windows/desktop/ms682516(v=vs.85).aspx
    // Allocate memory for thread data.
    EDATA threadEnemyData = (EDATA) HeapAlloc(GetProcessHeap(), HEAP_ZERO_MEMORY,sizeof(enemyData));

    // http://www.codeproject.com/Articles/14746/Multithreading-Tutorial
    // http://www.codeguru.com/cpp/w-d/dislog/win32/article.php/c9823/Win32-Thread-Synchronization-Part-I-Overview.htm

    // usefull information
    // http://msdn.microsoft.com/en-us/library/z3x8b09y(v=vs.100).aspx

     if( threadEnemyData == NULL )
     {
         //If the array allocation fails, the system is out of memory
         //so there is no point in trying to print an error message.
         //Just terminate execution.
         ExitProcess(2);
     }

    threadEnemyData->X = 0;
    threadEnemyData->Y = 0;

    this->hThread = CreateThread( 
        NULL, 
        0, 
        this->MyThreadFunction,
        this,
        /*threadEnemyData,*/
        0,
        &this->dwThreadID
    );

        // Check the return value for success.
        // If CreateThread fails, terminate execution. 
        // This will automatically clean up threads and memory. 

        if (this->hThread== NULL) 
        {
           ErrorHandler(TEXT("CreateThread"));
           ExitProcess(3);
        }
        //End of main thread creation loop.
}

Enemy::~Enemy()
{
    // Wait until all threads have terminated.
    WaitForSingleObject(this->hThread,INFINITE);

    // Close all thread handles and free memory allocations.
    this->hDefaultProcessHeap = GetProcessHeap();
    if (this->hDefaultProcessHeap == NULL) {
    }

    CloseHandle(this->hThread);
    //if(threadEnemyData != NULL)
    //{
    //  HeapFree(GetProcessHeap(), 0, threadEnemyData);
    //  hThread = NULL;    // Ensure address is not reused.
    //}

    // close debug file
    fclose (pEnemyFile);
}

void Enemy::Draw(D3DGraphics& gfx)
{
    gfx.PutPixel(this->x + 0,this->y,255,255,255);
    gfx.PutPixel(this->x + 1,this->y,255,255,255);
    gfx.PutPixel(this->x + 2,this->y,255,255,255);
    gfx.PutPixel(this->x + 3,this->y,255,255,255);
    gfx.PutPixel(this->x + 4,this->y,255,255,255);
    gfx.PutPixel(this->x + 5,this->y,255,255,255);
    gfx.PutPixel(this->x + 6,this->y,255,255,255);
    gfx.PutPixel(this->x + 7,this->y,255,255,255);
}

// read
// http://www.tek-tips.com/viewthread.cfm?qid=1068278
DWORD WINAPI Enemy::MyThreadFunction( void* param ) 
{ 
    Enemy* self = (Enemy*) param;
    ////self->  // <-- "this"
    return self->NewThread();
}

  /* initialize random seed: */

// the itelligence loop of your enemy/object
DWORD Enemy::NewThread()
{
    do
    {
        srand ( time(NULL) );
        /* generate random number: */
        //self->x += rand() % 4;
        //self->y += rand() % 4;
        this->x += rand() % 4;
        this->y += rand() % 4;

        // debug stuff
        char buffer[ 64 ];
        sprintf_s(buffer, "enemy:   x:   %d Y: %d id: %d\n", (char)this->x,  (char)this->y, (char)this->dwThreadID);
                fputs (buffer,pEnemyFile);

        // allow processor time to other threads
        Sleep(100);
    }while(true);  // endles loop
}

void Enemy::ErrorHandler(LPTSTR lpszFunction) 
{ 
    // Retrieve the system error message for the last-error code.
    this->dw = GetLastError(); 
    // todo
} 
```

敌人.h

```
#pragma once

#include "timer.h"
#include "D3DGraphics.h"
#include "D3DGraphics.h"
#include "Mouse.h"

/////// thread stuf
#include <tchar.h>
#include <strsafe.h>

#include <stdio.h>
#include <stdlib.h>
#include <time.h>

class Enemy
{
public:
    Enemy();
    Enemy(const MouseServer& mServer, int& lastMousePos, int& lastMousePosY, int& winSizeX, int& winSizeY);
    ~Enemy();

    static DWORD WINAPI MyThreadFunction( LPVOID lpParam );
    DWORD Enemy::NewThread();
    void ErrorHandler(LPTSTR lpszFunction);

    void lookingForFood();
    void Draw(D3DGraphics& gfx);
    int Enemy::correctX(int xParam);
    int Enemy::correctY(int yParam);

private:
    int myPositionX;
    int myPositionY;
    int lastMouseX; 
    int lastMouseY;
    int winSizeX;
    int winSizeY;
    //int moveToX;  // todo
    //int moveToY;

    int x;
    int y;

    // threading stuff
    typedef struct ENEMYDATA // don't forget "typedef "
    {
        int X;
        int Y;  // test
    } enemyData, *EDATA;

    // Cast the parameter to the correct data type.
    // The pointer is known to be valid because 
    // it was checked for NULL before the thread was created.
    static Enemy* self;
    HANDLE  hThread;
    DWORD   dwThreadID;
    HANDLE hDefaultProcessHeap;
    DWORD dw; // error message

    EDATA* threadEnemyData;

    MouseClient mouseServer;
    //D3DGraphics& grafix;
    Timer timer;
}; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-14T22:18:19.053

它在你的线程过程中被注释掉了，但看起来你在正确的轨道上：

srand (时间(NULL));

它对您不起作用，因为所有线程都启动得如此之快，以至于它们最终以 time(NULL) 为每个线程返回相同的值。这意味着它们都使用相同的随机序列。尝试使用线程 ID（或每个线程唯一的其他来源）播种 rand，您应该会看到唯一的伪随机数序列。

# javascript - 对多个数据使用翻译功能

> ID：13388337
> 
> 赞同：1
> 
> 时间：2012-11-14T22:15:14.930
> 
> 标签：javascript, d3.js

目前我正在使用 .filter 来指定我想要在我的数据集中的数据类型。然而，当涉及到特定的定位时，它当然是通过重叠来实现的。例如：

```
.filter(function(d) {
    return d.Country === 'Russia';
})

.attr("transform", function(d,i) {
    return "translate(-180,50)";
}); 
```

当然，这只会使所有特定数据在一个地方重叠。因此，我想知道是否可以进行由我拥有的过滤器指定的多个转换。我试图做这样的事情：

```
.attr("transform", function(d,i) {
    return if (d.name === 'Amy') { "translate(-180,50)"; }
}) 
```

这是我的 json 等示例。[http://jsfiddle.net/xwZjN/38/](http://jsfiddle.net/xwZjN/38/)

如果有人能指出我正确的方向，那就太好了

# java - Android的HTTP请求执行时间真长

> ID：13388338
> 
> 赞同：0
> 
> 时间：2012-11-14T22:15:16.410
> 
> 标签：java, android, http-request

我的应用程序有问题。一开始我将描述它是如何工作的。它向服务器发送请求（不是我创建的），在响应中我得到 JSON 字符串（JSONarray 中平均 10 条记录不是那么大），在一个参数中有一个指向我下载的图片的 URL 和保存为每个 JSON 对象的位图。总结一下，我下载了一个 JSON，它看起来像：

```
{
    "id":"125", 
    "description":"desc",   
    "type":"type",  
    "state":"state",    
    "date":"2012-09-22 10:40:46.0",
    "lat":"52.321911",
    "lng":"19.464111",
    "author":"user",
    "photo":"GetImage?size=small&id=0",
    "comments":[

    ]
    } 
```

例如 x 10，然后我从 URL 下载每个对象的“照片”图像。问题在于执行的时间，真的很长，不应该不是大数据。这是我这样做的方法： 下载图像的 AsyncClass：

```
private class HttpGetImage extends AsyncTask<Object, Integer, Integer>
    {
        public boolean ready = false;
        public boolean success = false;

        @Override
        protected Integer doInBackground(Object... obj) {
            DefaultHttpClient client = new MyHttpClient(ViewEdit.this);

            HttpGet get = new HttpGet(url+photoUrl);
            HttpResponse getResponse = null;
            try {
                getResponse = client.execute(get);
            } catch (ClientProtocolException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
                ready=true; return null;

            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
                ready=true; return null;

            }

            HttpEntity responseEntity = getResponse.getEntity();
            BufferedHttpEntity httpEntity = null;
            try {
                httpEntity = new BufferedHttpEntity(responseEntity);
            } catch (IOException e1) {
                // TODO Auto-generated catch block
                e1.printStackTrace();
                ready=true; return null;

            }
            InputStream imageStream = null;
            try {
                imageStream = httpEntity.getContent();
                m_orders.get((Integer)obj[1])
                    .setOrderBitmap(BitmapFactory.decodeStream(imageStream));

                success = true;
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
                ready=true; return null;

            } finally {
                try {
                    imageStream.close();
                } catch (IOException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                    ready=true; return null;

                }
            }

            ready = true;
            return null;
        }
    } 
```

和 jsonString 的 AsyncClass：

```
private class HttpGetNotifications extends AsyncTask<Double, Integer, Integer>
    {
        public boolean ready = false;
        public boolean success = false;

        @Override
        protected Integer doInBackground(Double... params) 
        {
            DefaultHttpClient client = new MyHttpClient(ViewEdit.this);
            HttpGet get = new HttpGet(url + Double.toString(params[0]) + "&longitude=" + Double.toString(params[1]) + "&radius="+distance);

            HttpResponse getResponse = null;
            try {
                getResponse = client.execute(get);

            } catch (ClientProtocolException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
                ready=true; return null;
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
                ready=true; return null;
            }
            HttpEntity responseEntity = getResponse.getEntity();
            String entityContents="";
            try {
                entityContents = EntityUtils.toString(responseEntity);

                loadNotifications(entityContents);
                success = true;
            } catch (ParseException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
                ready=true; return null;

            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
                ready=true; return null;

            } catch (JSONException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
                ready=true; return null;

            }

            ready = true;
            return null;
        }

        public void loadNotifications(String jsonstring) throws JSONException
        {
            JSONObject jsonResponse = new JSONObject(jsonstring);

            JSONArray notifi = jsonResponse.getJSONArray("notifications");
            for (int i =0, count = notifi.length(); i <count; i++){
                //storage of data
            }       
        }
    } 
```

也许你们知道如何优化该代码以减少执行时间？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T22:21:39.220

进行一些分析以查找需要时间的内容。在您的每个 AsyncTask 中：

```
private long time0, time1;
@Override protected void onPreExecute() {
    time0 = System.currentTimeMillis();
}
@Override protected void onPostExecute(HttpResponse response) {
    time1 = System.currentTimeMillis();
long deltaT = (time1 - time0);
Log.d(TAG, "Execute took "+deltaT+"ms");
} 
```

然后从那里去。

# android - Android NDK 递归搜索标头

> ID：13388345
> 
> 赞同：3
> 
> 时间：2012-11-14T22:16:04.443
> 
> 标签：android, c++, path, header, android-ndk

我怎样才能让 NDK 搜索所有文件夹中的标题？

例如它的工作原理：

```
#include "../../../CPPCore/Model/User.h" 
```

但它没有：

```
#include "User.h" 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-14T22:41:17.883

在android.mk文件中添加头文件路径

```
LOCAL_C_INCLUDES := $(LOCAL_PATH)/include
LOCAL_C_INCLUDES += <PATH>/CPPCore/Model 
```

查看android论坛的一些链接，它可能会有所帮助：

[https://groups.google.com/forum/?fromgroups=#!topic/android-ndk/-_scQd5leqo](https://groups.google.com/forum/?fromgroups=#!topic/android-ndk/-_scQd5leqo)

# javascript - 删除后未填充 JQGrid 源

> ID：13388347
> 
> 赞同：0
> 
> 时间：2012-11-14T22:16:10.700
> 
> 标签：javascript, asp.net-mvc, jqgrid

我正在使用 $(document).ready 中设置的 jqGrid，如下所示：

```
jQuery("#list").jqGrid({
        datatype: 'json',
        colNames: ['ID', 'Note', 'Date Added'],
        colModel: [
            { name: 'ID', index: 'ID', width: 60, key: true },
            { name: 'ContactNote', index: 'ContactNote', width: 300, cellattr: function (rowId, tv, rawObject, cm, rdata) { return 'style="white-space: normal;"'; } },
            { name: 'ContactDate', index: 'DateAdded', width: 100 }
        ],
        mtype: 'POST',
        viewrecords: true,
        jsonReader: { repeatitems: false },
        ignoreCase: true,
        height: 450,
        loadonce: false,
        onSelectRow: function (id) { $('#ContactId').val(id); }
    }); 
```

这是页面的 HTML：

```
<div class="col-12">
<div class="ui-content-6 ui-widget-content ui-corner-all">
    @using (Html.BeginForm())
    {
        <h3 class="ui-widget-header ui-corner-all">Enter account number</h3>
        <div class="field-container">
            @Html.LabelFor(o => o.AccountNumber)
            @Html.TextBoxFor(o => o.AccountNumber)
        </div>

        <div class="form-submit">
            <button id="btnSearchContactItems">Get Contact Items</button>
        </div>

        <h3 class="ui-widget-header ui-corner-all">Contact item list</h3>

        <table id="list" class="scroll" cellpadding="0" cellspacing="0"></table>

        <div class="form-submit">
            <button id="btnRemoveContactItem" type="submit">Remove Selected Contact Item</button>
        </div>

        @Html.HiddenFor(o => o.ContactId)

        @Html.ValidationSummary()
    }
</div> 
```

btnSearchContactItems 按钮有一个点击事件：

```
$("#btnSearchContactItems").click(function () {

        $("#list")
            .jqGrid('setGridParam', { postData: { accountNumber: $('#AccountNumber').val() }, url: baseSearchURL })
            .trigger('reloadGrid');

        return false;
    }); 
```

这是问题：

我让用户输入他们的帐号，然后单击 btnSearchContactItems 按钮，在网格中填写一些注释。When one of the notes is selected and the btnRemoveContactItem button is clicked the action is called and the note is removed. 问题是，一旦删除了 not ，网格就会清空。我想要发生的是让网格重新加载数据减去已删除的行。

我发誓，为了我的一生，我无法让数据重新填充。我尝试在网格加载、页面加载等中触发按钮单击，但仍然没有。如果我物理单击按钮，它只会再次填充网格。有人有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T23:21:06.233

我怎么想你不想在页面开始时向服务器发送任何请求。为此，您可以`datatype: "local"`在创建网格时使用。您可以`url: baseSearchURL`在创建网格时设置。该参数将被忽略`datatype: "local"`。

现在我回到你的主要问题：你可以`postData`直接在创建网格时定义选项，但你应该使用函数（方法）作为属性（详见[答案](https://stackoverflow.com/a/2928819/315935)）：

```
postData: {
    accountNumber: function () {
        var account = $('#AccountNumber').val();
        return account ? account : null;
    }
} 
```

`accountNumber`每次重新加载网格时都会调用该方法。所以你可以使用

```
$("#btnSearchContactItems").click(function () {
    $("#list").jqGrid('setGridParam', { datatype: "json" }}).trigger('reloadGrid');
    return false;
}); 
```

如果您愿意，您可以在`click`处理程序内部额外设置`datatype: "local"`if`$('#AccountNumber').val()`为空。

如果您真的不想将任何`accountNumber`属性发送到服务器它的值是`null`，或者`""`您可以使用`serializeGridData`以下形式

```
serializeGridData: function (postData) {
    var propertyName, propertyValue, dataToSend = {}, val;
    for (propertyName in postData) {
        if (postData.hasOwnProperty(propertyName)) {
            propertyValue = postData[propertyName];
            val = $.isFunction(propertyValue) ? propertyValue() : propertyValue;
            if (propertyName !== "accountNumber" || val) {
                // don't send "accountNumber" with empty value
                dataToSend[propertyName] = val;
            }
        }
    }
    return dataToSend; // ?? probably you can use JSON.stringify(dataToSend);
} 
```

（详情见[答案](https://stackoverflow.com/a/13162471/315935)）

此外，我建议您设置`gridview: true`以提高网格的性能并添加`rowNum: 10000`. jqGrid 旨在显示分页数据。你不使用`pager`option，但是默认值为`rowNum`20。所以不设置`rowNum: 10000`jqGrid只会显示前20行数据。这不是你想要的。

# visual-c++ - 为什么 ntdll.dll 会使我的 c++ 可执行文件崩溃？

> ID：13388350
> 
> 赞同：18
> 
> 时间：2012-11-14T22:16:19.313
> 
> 标签：visual-c++, process, crash, ntdll

我无法让 Visual C++ 可执行文件工作，应用程序崩溃，这是我在事件查看器中看到的。

```
Faulting application name: submit.exe, version: 0.0.0.0, time stamp: 0x50a3cce7
Faulting module name: ntdll.dll, version: 6.1.7601.17514, time stamp: 0x4ce7ba58
Exception code: 0xc0000374
Fault offset: 0x000ce653
Faulting process id: 0x8fc
Faulting application start time: 0x01cdc2a3da4f2997
Faulting application path: c:\submit.exe
Faulting module path: C:\Windows\SysWOW64\ntdll.dll
Report Id: 1813823a-2e97-11e2-8675-000c29229191 
```

在旧版本的 Visual Studio 中编译的可执行文件可以工作，但我在使用 2008 或 2010 等较新的 VS 编译的可执行文件时遇到错误。请咨询

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-27T15:47:17.287

对此类问题进行故障排除可能是一个真正的挑战……尤其是当您不熟悉代码库时。

考虑将[Application Verifier](http://msdn.microsoft.com/en-us/library/ms220948%28v=vs.90%29.aspx "应用程序验证者")与 Visual Studio 调试器结合使用。

1.  启动 Visual Studio 并编译您的应用程序
2.  启动应用程序验证程序实用程序。
3.  `File`=>`Add Application`
4.  选择适当的`Tests`（例如堆，异常，...）
5.  使用 Visual Studio`Debug`启动您的应用程序。

当发生*不好*的事情时……您的调试器将停止。这应该使您对问题的根源有了一个很好的了解。

此外，在开始测试之前加载缺失的符号*可能会有所帮助。*在 Visual Studio 2012 中，您可以通过以下方式执行此操作： `Debug`=> `Options and Settings`=> `Debugging`=> `Symbols`=> `Load all symbols`。

祝你好运！

## 参考

*   [MSDN：“应用程序验证器”文章](http://msdn.microsoft.com/en-us/library/ms220948%28v=vs.90%29.aspx "MSDN：应用程序验证器")
*   [下载：应用程序验证器](http://www.microsoft.com/en-ca/download/details.aspx?id=20028 "下载：应用程序验证器")
    *   以前此应用程序可以单独下载：[这里](http://www.microsoft.com/en-ca/download/details.aspx?id=20028 "下载：应用程序验证器")
        *   此下载不再可用。
    *   该应用程序现在包含在 Windows SDK 中。（以前称为 Platfrom SDK）
    *   请注意，您可能安装了两个版本：
        *   `C:\Windows\SysWOW64\appverif.exe`[32 位版本]
        *   `C:\Windows\System32\appverif.exe`[64位版本]
*   [TechNet：两分钟练习：应用程序验证程序](http://blogs.technet.com/b/askperf/archive/2009/05/22/two-minute-drill-application-verifier.aspx "TechNet：两分钟练习：应用程序验证程序")

## 更新：2015 年 7 月

完成后，请务必禁用您启用的*AppVerfier*检查......否则，当您忘记*AppVerifier*时，您可能会在 6 个月后遇到一些意想不到的副作用。

# eclipse - “新建文件夹”、“新建源文件夹”和“新建包”的区别？

> ID：13388353
> 
> 赞同：3
> 
> 时间：2012-11-14T22:16:24.853
> 
> 标签：eclipse

在eclipse中右键项目时，“新建文件夹”、“新建源文件夹”、“新建包”有什么区别？他们似乎都在做同样的事情，参考资料并没有说太多。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-14T22:20:07.287

*新文件*夹在项目中创建一个新文件夹。

*新源文件*夹在项目旁边创建一个新文件夹，并将该文件夹添加到项目的源文件夹集中。Eclipse 将编译此文件夹中的文件。

*新包*在源文件夹中创建一个新的 Java 包。当然，它还会创建与包关联的文件夹。

# java - 图像 IO 奇怪行为重置输入流

> ID：13388354
> 
> 赞同：1
> 
> 时间：2012-11-14T22:16:25.177
> 
> 标签：java, image, io, bufferedimage

我看到 ImageIO.read() 方法的奇怪行为。

我将 InputStream 传递给此方法，当我第二次尝试读取它时，它读取失败并返回 null。

我正在尝试将图像上传到 Amazon S3，并且我想创建图像的 3 个版本。原始和 2 个缩略图。我的问题是，当我想创建 2 个缩略图时，我需要使用 ImageIO.read() 读取 InputStream。如果我为同一个 InputStream 运行此方法 2，我会在第二次读取时得到 null。

我可以通过只读取一个并将相同的 BufferedImage 传递给缩放方法来规避这个问题。但是，我仍然需要将我的方法传递给其他 AmazonS3 服务的 InputStream 来上传原始文件。

所以我的问题是，有没有人知道 ImageIO 第一次读取输入流后会发生什么？

下面的代码示例

```
public String uploadImage(InputStream stream, String filePath, String fileName, String fileExtension) {
    try {

        String originalKey = filePath + fileName + "." + fileExtension;
        String smallThumbKey = filePath + fileName + ImageConst.Path.SMALL_THUMB + "." + fileExtension;
        String largetThumbKey = filePath + fileName + ImageConst.Path.LARGE_THUMB + "." + fileExtension;

        BufferedImage image = ImageIO.read(stream); 
        InputStream smallThumb = createSmallThumb(image, fileExtension);
        InputStream largeThumb = createLargeThumb(image, fileExtension);

        uploadFileToS3(originalKey, stream);
        uploadFileToS3(smallThumbKey, smallThumb);
        uploadFileToS3(largetThumbKey, largeThumb);

        return originalKey;

    } catch (IOException ex) {
        Logger.getLogger(ManageUser.class.getName()).log(Level.SEVERE, null, ex);
    }
    return null;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T22:36:29.470

ImageIO.read 将读取到输入流的末尾。这意味着没有数据可供读取，这就是为什么当您尝试从中读取更多数据时得到 null 的原因。

如果要重用输入流，则必须对其调用 reset() ；但这只有在底层 InputStream 实现支持重置时才有效，请参阅 InputStream 的 markSupported()。

这是简单但幼稚的解决方法。

请记住，您已经将图像读入内存，因此您实际上不需要这样做。这有点笨拙，但您可以将其写入 ByteArrayOutputStream，然后构建一个新的 ByteArrayInputStream。

如果我这样做，我可能会先将其读入字节数组。为此，请查看 Commons IOUtils.read()。然后我会根据需要构建一个新的 ByteArrayInputStream 和 reset() ，因为它肯定支持标记。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T22:25:33.390

我想，您可以将原始输入流包装在[BufferedInputStream](http://docs.oracle.com/javase/6/docs/api/java/io/BufferedInputStream.html)中，并使用[mark()](http://docs.oracle.com/javase/6/docs/api/java/io/BufferedInputStream.html#mark%28int%29)保存流中的起始位置，并使用[reset()](http://download.java.net/jdk7/archive/b123/docs/api/java/io/BufferedInputStream.html#reset%28%29)返回它。

要完全回答您的问题：每个流都按顺序读取（通常有某种内部指针指向当前位置）。在第一个之后`ImageIO.read()`，将读取流直到其结束，因此，任何进一步的读取操作都不会返回任何数据（通常 -1 表示流的结束）。使用 mark() 您可以保存某个位置，然后使用 reset() 返回该位置。

# c# - 如何引用未绑定到中继器的 XML 数据

> ID：13388355
> 
> 赞同：0
> 
> 时间：2012-11-14T22:16:30.090
> 
> 标签：c#, asp.net, xml, data-binding, asp.net-2.0

C#新手问，所以如果问题很愚蠢或者答案很明显，可能是因为我不完全理解它是如何`XmlDataSource`工作的。

给定以下 XML 文件“super-simple-xml.xml”（格式化以节省一些空间），

```
<items>
    <item> <one id="ms">Microsoft</one>  <two>MSFT</two> </item>
    <item> <one id="in">Intel</one>      <two>INTC</two> </item>
    <item> <one id="de">Dell</one>       <two>DELL</two> </item>
</items> 
```

一个看起来像这样的中继器，

```
<asp:Repeater id="SuperSimple" runat="server" OnItemCommand="SuperSimple_ItemDataBound">
    <HeaderTemplate>
        <table border="1"><tr><th>Company</th><th>Symbol</th><th>Wrong</th></tr>
    </HeaderTemplate>
    <ItemTemplate>
        <tr>
            <td><asp:Label Text=<%#XPath("one") %> runat="server" /></td>
            <td><asp:CheckBox Text=<%#XPath("two") %> runat="server" id="symbol" /></td>
        </tr>
    </ItemTemplate>  
    <FooterTemplate>
        </table>
        <asp:Button id="buttonOne" Text="Submit!" runat="server" />
    </FooterTemplate>
</asp:Repeater> 
```

和以下绑定XML：

```
private void Page_Load(object sender, EventArgs e) 
{
    XmlDataSource xmlSource = new XmlDataSource();
    xmlSource.DataFile = "super-simple-xml.xml";
    xmlSource.XPath = "items/item";

    if (!IsPostBack) // Did this to prevent an error
    {
        SuperSimple.DataSource = xmlSource;
        SuperSimple.DataBind();
    }
} 
```

我将如何`id`从每个 XML 条目中提取到一个类或变量中？

这里的想法是我在中继器中显示项目。我添加了复选框，所以我可以检查任何`<two>`条目，然后按提交。当它回发时，我想将选中的条目存储在我制作的课程中。进入`<one>`和`<two>`进入很容易，因为它们在中继器中有我可以参考的 ID。但是`id`XML 中的属性永远不会被调用，所以我不知道如何获取它。我希望`id`在传递数据时在类中引用。这可能吗，我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T23:07:02.703

使用 XPath @ 语法获取属性：

```
<%# XPath("one/@id") %> 
```

您可以将此表达式绑定到 HiddenField 并在回发中访问它：

```
<asp:HiddenField runat="server" ID="hidID" Value='<%# XPath("one/@id") %>' /> 
```

将命令按钮添加到`<ItemTemplate>`：

```
<asp:Button runat="server" ID="btnGetID" Text="Get ID" CommandName="GetID" /> 
```

在 OnItemCommand 事件中：

```
protected void SuperSimple_ItemDataBound(object sender, RepeaterCommandEventArgs e)
{
    //check the item type, headers won't contain the control
    if (e.CommandName == "GetID")
    {
        //find the control and put it's value into a variable
        HiddenField hidID = (HiddenField)e.Item.FindControl("hidID");
        string strID = hidID.Value;
    }
} 
```

这是另一种选择（我最初发布是因为我对您的 OnItemCommand 事件的名称感到困惑，并认为您想要 DataBinding 时的值）：

在你的`<ItemTemplate>`：

```
<asp:Button runat="server" ID="btnGetID" OnClick="btnGetID_Click" Text="Get ID" /> 
```

代码隐藏：

```
protected void btnGetID_Click(object sender, e as EventArgs)
{
    //sender is the button
    Button btnGetID = (Button)sender;
    //the button's parent control is the RepeaterItem
    RepeaterItem theItem = (RepeaterItem)sender.Parent;
    //find the hidden field in the RepeaterItem
    HiddenField hidID = (HiddenField)theItem.FindControl("hidID");
    //assign to variable
    string strID = hidID.Value;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T23:01:27.067

也许这有帮助，问题可能出在错误的 xml 结构中。

[http://forums.asp.net/t/1813664.aspx/1?getting+xml+node+id+number](http://forums.asp.net/t/1813664.aspx/1?getting+xml+node+id+number)

# excel - 在没有VBA的excel中查找

> ID：13388364
> 
> 赞同：0
> 
> 时间：2012-11-14T22:17:31.667
> 
> 标签：excel, lookup

我正在尝试编写一个 Excel 电子表格，上面会有两张表格。

一张表 (sheet2) 在一列中包含名称列表，每个名称旁边都有一个数字。

然后，我会将这一列名称作为另一个工作表（工作表）中的下拉列表的列表。

我想要解决的是，当我在下拉列表中选择一个名称时，sheet2 上名称旁边的数字将显示在下拉列表旁边的单元格上。

我正在尝试使用查找，但它似乎不起作用，我想我用错了。

这是我正在使用的公式，它位于下拉列表旁边的单元格上，下拉列表位于 Sheet1 的 A1 上。

=LOOKUP(A1,{+Sheet2!A2:A7,"d";+Sheet2!B2:B7})

Sheet2!A2:A7 是名称列表 Sheet2!B2:B7 是每个名称的相应值的列表。

任何帮助将非常感激。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T23:02:11.170

`=vlookup(A1,Sheet2!$A$2:$B$7,2,0)`正如 Tim WIliams 建议的那样，应该返回正确的值。

# c# - 我应该如何在服务层报告重复的业务实体/对象？

> ID：13388368
> 
> 赞同：0
> 
> 时间：2012-11-14T22:18:08.573
> 
> 标签：c#, asp.net, service, repository, design-patterns

我正在尝试使用最佳实践进行编码，但我对此有疑问。我正在 WebForms 上对此进行测试。

我有一个 UserService 层，其中我有一个将用户传递给 RepositoryLayer 的方法：

```
public AddUserResponse AddUserResponse(AddUserRequest addUserRequest)         
{
  AddUserResponse response = new AddUserResponse();
  User objUser = new User();

  objUser.Names = addUserRequest.Names;
  objUser.LastName = addUserRequest.LastName;
  objUser.Email  = addUserRequest.Email;
  objUser.Alias  = addUserRequest.Alias;
  objUser.Profile.IdProfile = addUserRequest.Profile.IdProfile;
  objUser.Password = addUserRequest.Password;
  objUser.Active = addUserRequest.Active;

  short OperationState=_userRepository.Add(objUser);        
  if (OperationState==0)  
  {
    response.State=true;
    response.Message="User inserted";
  }
  else if (OperationState==2)
  {
    response.State=false;
    response.Message="Alias or Email already exist. Cannot insert User";
  }
  else 
  {
    response.State=false;
    response.Message="Error in User insertion";
  }       

  return response;           
} 
```

然后我有一个 UserRepository 层，其中我有一个添加来自我的服务层的用户的功能：

```
public short Add(User objUser)
    { ...  return OperationState  } 
```

如图所示，此函数依靠存储过程调用来插入用户记录。如果用户电子邮件或别名不存在，则插入并返回 0，如果存在则返回 2，如果操作失败则返回 1。

我在一次调用中执行检查和插入以节省数据库往返。

我是否以正确的方式对我的服务和存储库类执行检查？或者如果不是，我应该如何抽象逻辑以让系统确定何时是重复用户？我应该使用模型或服务来放置验证逻辑并在发生这种情况时引发自定义异常吗？

非常感谢您的洞察力。

**更新**

出于普遍的兴趣，我现在发布如何在我的应用程序上实现这一点，一旦我得到 Jason 的 IoC 解决方案，我也会对此进行更新。

型号类：

```
using ABC.DEF.Infrastructure.Domain;

namespace ABC.DEF.Model
{   
    public class AliasOrEmailAreUnique
    {
        private readonly IRepository<User, int> repository;

        public AliasOrEmailAreUnique(IRepository<User,int> repository) 
        {
            this.repository = repository;
        }

        //If the user is added has Id 0 so search among all the existing users for one that could have the alias or email registered already    
        //else if the user is being edit then search among all the user except the user with such Id(itself)
        public bool IsBroken(User model) 
        {
            if (model.IdUser == 0)
            {
                return (
                repository.List().Where(x => x.Alias == model.Alias).Any()
                || repository.List().Where(x => x.Email == model.Email).Any()
                );
            }
            else 
            {
                return (
                repository.List().Where(x => x.Alias == model.Alias && x.IdUser != model.IdUser).Any()                    
                || repository.List().Where(x => x.Email == model.Email && x.IdUser != model.IdUser).Any()
                );
            }

        }

        public ErrorMessage ErrorMessage
        { 
          get { return new ErrorMessage { Property = "AliasEmail", Message = "Alias or Email exists already" }; } 
        }
    }
} 
```

服务等级：

```
using ABC.DEF.Repository;
using ABC.DEF.Model;
using ABC.DEF.Service.Messaging.User;

namespace ABC.DEF.Service
{
    public class UsuarioService
    {
        public AddUserResponse AddUserResponse(AddUserRequest addUserRequest)         
        {
            AddUserResponse response = new AddUserResponse();
            User objUser = new User();

            objUser.Names = addUserRequest.Names;
            objUser.LastName = addUserRequest.LastName;
            objUser.Email  = addUserRequest.Email;
            objUser.Alias  = addUserRequest.Alias;
            objUser.Profile.IdProfile = addUserRequest.Profile.IdProfile;
            objUser.Password = addUserRequest.Password;
            objUser.Active = addUserRequest.Active;

            //Determine if the Alias or Email are unique
            Model.AliasOrEmailAreUnique aliasOrEmailAreUnique = new Model.AliasOrEmailAreUnique(_userRepository);

            if (!aliasOrEmailAreUnique.IsBroken(objUser))
            {
            _usuarioRepository.Add(objUser);
            response.State = true;
            response.Message = "User added succesfully";
            }
            else
            {
            response.State = false;
            response.Message = aliasOrEmailAreUnique.ErrorMessage.Message;
         }

         return response;           
      }
   }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T22:25:49.670

我喜欢在工作单元开始时验证输入。对于 Web 应用程序，请求是工作单元。在触发控制器操作之前，我验证用户输入。行动本身就是“幸福的道路”。如果能做到这一点，我知道我的手术会成功。在请求（响应）的最后，我将任何更改提交回数据库。

我还想保持我的操作明确，因此添加实体的调用与编辑实体的调用与删除实体的调用不同。

在您的场景中，您有一个服务层而不是控制器操作，但过程仍然相同。在调用服务层之前验证模型。然后将模型传递给服务层以执行您想要的操作。

**...更新 1...**

回应您在下面的评论......

> 我一直只在服务层调用我的存储库

小心不要落入认为有一个用于拨打电话的线性模式的陷阱。通过应用程序。而是将其视为具有多层的[洋葱或球体。](http://jeffreypalermo.com/blog/the-onion-architecture-part-1/)

该模型只是一个 POCO/DTO。将有其他组件负责验证模型。通常我有一个看起来像这样的业务规则引擎......从我的头顶上写下来。

```
interface IRule<T>
{
     bool IsBroken(T model);
     ErrorMessage Message {get;}
}

interface IRulesEngine
{
     IEnumerable<ErrorMessage> Validate<T>(T model);
}

class ErrorMessage
{
      public string Property {get;set;}
      public string Message {get;set;}
}

class RulesEngine : IRulesEngine
{
     private readonly IContainer container;
     public RulesEngine(IContainer container)
     {
          this.container = container;
     }

     public IEnumerable<ErrorMessage> Validate<T>(T model)
     {
           return container
                     .GetInstances<IRule<T>>()
                     .Where(rule => rule.IsBroken(model))
                     .Select(rule =>  rule.Message);
     }
} 
```

此实现假设一个 IoC 容器，但可以在没有 IoC 容器的情况下实现。a 规则可能看起来像这样

```
class NameIsUnique<MyClass> : IRule<MyClass>
{
     private readonly IRepository<TheEntity> repository;

     public NameIsUnique<MyClass>(IRepository<TheEntity> repository)
     {
         this.repository = repository;
     }

     public bool IsBroken(MyClass model)
     {
          return repository.Where(x => x.Name == model.Name).Any();
     }

     public ErrorMessage 
     { 
         get { return new ErrorMessage { Property = "Name", Message = "Name is not unique" }; } 
     }
} 
```

最后，如何使用它。

```
var errors = engine.Validate(model);
LoadErrorsInToView(errors);
if(errors.Any()) return;

//call service to process the happy path... 
```

**...更新 2...**

首先我们重构我们的接口

```
//this is just a marker interface. don't directly imeplement this.
interface IRule
{
}

interface IRule<T> : IRule
{
    bool IsBroken(T model);
    ErrorMessage Message {get;}
}

class RulesEngine : IRulesEngine
{
    public reasdonly ICollection<IRule> Rules = new List<IRule>();

    public IEnumerable<ErrorMessage> Validate<T>(T model)
    {
       return Rules
                 .Where(x => typeof(IRule<T>).IsAssignableFrom(x.GetType()))
                 .Cast<IRule<T>>()
                 .Where(rule => rule.IsBroken(model))
                 .Select(rule =>  rule.Message);
    }
} 
```

# html - 桌面或离线网络应用程序？

> ID：13388372
> 
> 赞同：0
> 
> 时间：2012-11-14T22:18:16.607
> 
> 标签：html, desktop-application, offline

我正在为朋友的活动公司构建应用程序。该软件只会被少数举办活动的人使用。

这些是基本要求：

*   该软件将捕获有关事件和竞争对手的基本数据输入。

*   该软件将需要离线工作 - 不能保证场馆的互联网连接。

*   当互联网连接可用时，该软件将在本地存储要同步到远程数据库的数据。

*   该软件将显示发送到投影仪屏幕的第二个窗口，并向观众显示更新。

*   该软件需要通过串行端口为每个事件记录数据。

尽管这可能传统上是一个桌面应用程序，但我认为尝试构建类似 Web 应用程序的东西是有充分理由的，即：

*   我更容易构建/维护/测试。

*   更便宜（.NET 将是我对桌面的第一个呼叫端口，但我听说微软正在放弃 Windows 8 的 VS Express）。

*   独立于平台 - 如果发生现场笔记本电脑故障，则
    无需安装和配置软件即可使用另一台机器，以及未来硬件升级的可能性。

因为我还没有使用 HTML5 的离线功能。我想知道在走这条路之前是否有任何警告 - 桌面应用程序更好，还是其他解决方案？

（我知道我必须为串行端口通信创建一个 Java Applet，如此处所示[。](https://stackoverflow.com/questions/3310643/how-to-read-from-serial-port-in-a-webpage)）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T22:30:23.813

由于您需要与硬件通信，因此我不会为 HTML5 和可能的 Java 小程序而烦恼。只需使用桌面应用程序即可。

# java - 风暴在 23 小时后坠毁

> ID：13388375
> 
> 赞同：5
> 
> 时间：2012-11-14T22:18:21.190
> 
> 标签：java, mysql, jdbc, apache-storm

大家好，我有一个基本的 Storm 应用程序设置，它接收推文流并将它们存储在 MySQL 数据库中。该应用程序在前约 23 小时左右运行良好，然后开始出现以下错误：

```
SQL Exception
SQL State: 08003 
```

在它这样做几次之后，它就死了。我正在使用标准 JBDC 连接器从 Java 连接到数据库。存储和建立数据库连接的函数代码如下：

```
private String _db="";
private Connection conn = null;
private PreparedStatement pst = null;

public ArchiveBolt(String db){
    _db = db;
}

private void setupConnection() {
    //Connect to the database
    try {
        Class.forName("com.mysql.jdbc.Driver");
        conn = DriverManager.getConnection("jdbc:mysql://localhost:8889/twitter_recording", "root", "root");
    } catch (Exception e){
        e.printStackTrace();
    }
}

public void execute(Tuple tuple, BasicOutputCollector collector) {

    Status s = (Status) tuple.getValue(0);

    //setup the connection on the first run through or if the connection got closed down
    try {
        setupConnection();
    } catch (Exception e) {
        // TODO: handle exception
        System.out.println(e.toString());
    }

    try {

        pst = conn.prepareStatement("INSERT INTO " + _db + " (tweet)" +
                                    "VALUES (?);");

        pst.setString(1, s.toString());

        //execute the SQL
        pst.executeUpdate();

    } catch (SQLException ex) {
        // handle any errors
        System.out.println("SQLException: " + ex.getMessage());
        System.out.println("SQLState: " + ex.getSQLState());
        System.out.println("VendorError: " + ex.getErrorCode());

        if(ex.getSQLState().equals("08003")){
            setupConnection();
        }

    } finally {
        try {
            conn.close();
        } catch (SQLException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }
} 
```

在很明显它由于 08003 错误而崩溃后，我决定如果它抛出该错误，它应该重试连接设置，但这也无济于事。谁能指出我解决这个问题的正确方向？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T00:12:28.257

> 在很明显它由于 08003 错误而崩溃后，我决定如果它抛出该错误，它应该重试连接设置，但这也无济于事。谁能指出我解决这个问题的正确方向？

这里基本上有两个问题需要解决：

*   为什么连接首先会丢失？
*   为什么您重新连接的尝试没有成功？

对于第一个问题，您应该查看 MySQL 日志，看看那里是否有任何迹象。此外，在（重复的）“状态 080003”异常之前立即检查 SQL 异常。后者只是告诉您连接之前已断开。

我的猜测是问题是以下之一：

*   MySQL 服务器由于不活动而导致连接超时。如果这是问题，您可以在 MySQL 配置中更改连接超时。

*   您的应用程序可能会慢慢泄漏 JDBC 连接。

对于第二个问题，一般做法是正确的，但你的代码与描述不符。实际上，每次调用您的方法时，它似乎*总是试图建立一个新的数据库连接。*`execute`这使得异常处理程序中的重新连接调用毫无意义。（OTOH，代码显示有人一直在“敲打它”试图让它工作......这很可能是问题的一部分。）

我会检查它是否*在需要时*`setupConnection`被调用，并查找可能引发的任何异常。此外，您应该确保您明确地死连接对象......并重新考虑/重新编码您的连接管理，使其不会泄漏。*`close()`*

 ** * *

作为记录，有一个名为“autoReconnect”的连接 URL 参数在遥远的过去用于“处理”丢失的连接。不幸的是，最初的实现是不安全的，所以他们有效地禁用了它；有关详细信息，请参阅此问题：[为什么 autoReconnect=true 似乎不起作用？](https://stackoverflow.com/questions/667289/why-does-autoreconnect-true-not-seem-to-work)*

# twig - 带标点符号的 Silex 和 twig 变量

> ID：13388376
> 
> 赞同：0
> 
> 时间：2012-11-14T22:18:36.657
> 
> 标签：twig, silex

我正在使用 Silex 和 Twig，并且无法在 Twig 中打印一些带有标点的变量：

```
$app['gateway.name'];

{{ app.gateway.name }} 
```

如果我只有一个标点，它会工作得很好，但不是多个。

这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T23:10:50.103

是的，您也可以在 twig 中使用方括号表示法：

```
{{ app['gateway.name'] }} 
```

另请参阅：[树枝文档的模板变量部分](http://twig.sensiolabs.org/doc/templates.html#variables)。

# php - 报表中的 PHP 组项目

> ID：13388378
> 
> 赞同：1
> 
> 时间：2012-11-14T22:18:52.190
> 
> 标签：php

设计在表格中显示的报告（PHP 输出 HTML）。数据看起来像这样（着色不是我的）：

```
Date         PID  Client Name  Activity         Hours
2012-10-15   52   Company Y    Report writing   3.5
2012-10-15   16   Company D    Meeting          1.3
2012-10-15   21   Company F    Telecon          0.3
2012-10-15   52   Company Y    Telecon          0.8
2012-10-16   16   Company D    Client visit     1.7
2012-10-16   52   Company Y    Preparation      1.8
2012-10-16   16   Company D    Edit MMS 12      7.1 
```

我已经编写了从 MySQL 获取数据、逐行提取数据`mysql_fetch_assoc`、构建包含值的 HTML 表并输出的所有内容。基本的东西——通过 jQuery 调用 Ajax 来完成，看起来很棒。

我现在被要求按 CID/CompanyName（相同的东西）和输出（我认为是单独的表格）对项目进行分组，并在每个 companytable 下方汇总每个公司的总小时数。

我只想使用一个 mysql_query，这意味着在 PHP 中进行组/计算。

我刚刚度过了一个为期 3 天的周末，完成了数据库重组并编写了初始报告，但我很难考虑清楚这一点。一个善良的灵魂会帮助我解决这个问题吗？我已经开始了几种不同的算法，它们的意大利面条失控了。我知道有一种优雅、简单的方法，但目前我无法想象它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T18:13:03.053

在用户的善意指导下`sudowned`，他让我走上了正确的轨道，我能够完成这个项目。对于未来的读者，这对我有用：

这是算法：

```
$rCards = Get all time entries for specific user within certain date range
$rCardsPJ = Get PID (project_num)s between those dates
Top Loop (through all projects)
    $TopLoopPID = get next project_num
    $ttl_hrs_this_pj = 0;

    Loop through all time entries ($rCards)
        get next rCard
        if (PID on this rCard == $TopLoopPID) {
            echo this row
            $hrs_this_rCard = get hrs from this rCard
            $ttl_hrs_this_pj += $hrs_this_rCard
        }
    }
    echo 'Total Hours: ' . $ttl_hrs_this_pj;
} 
```

这是代码：

```
$rCards = mysql_query("SELECT `t_id`, `date`, `project_num`, `task_desc`, `hours` FROM `timecards` WHERE `staff_id`='$staff_id' AND `date` BETWEEN '$date_start' AND '$date_finish'");
$rCardsPJ = mysql_query("SELECT `project_num`, COUNT(`project_num`) FROM `timecards` WHERE `staff_id`='$staff_id' AND `date` BETWEEN '$date_start' AND '$date_finish' GROUP BY `project_num`");

$num_cards = mysql_num_rows($rCards);
$num_projs = mysql_num_rows($rCardsPJ);

//If no time cards for this period, respond with a single zero
if ($num_cards < 1) {
    echo '0';
    exit();
}

$t = ''; //Initialize var (necc)

$cntr = 1;
for($i = 1; $i<=$num_projs; $i++){
//Loop through each project
    $aPJ = mysql_fetch_assoc($rCardsPJ);
    $this_pj = $aPJ['project_num'];
    $this_pjCnt = $aPJ['COUNT(`project_num`)'];
    //Counter for row striping
    $stripe_cnt = 0;

    $csv .= '"Date","PJ#","Project Name","Task Description","Hours"'.chr(13);
    $t .= '<table style="width:90%;background:white;border-radius:10px;margin:-8px 0 3px 0; padding:10px 20px;box-shadow:2px 2px 5px;">
        <tr>
            <th width="90">
                Date
            </th>
            <th width="50">
                PJ #
            </th>
            <th width="250">
                Project Name
            </th>
            <th width="500">
                Description
            </th>
            <th width="50">
                Hours
            </th>
            <th width="10">
                Edit
            </th>
        </tr>
        ';
    $ttl_hrs_this_pj = 0;
    for($j = 1; $j<=$num_cards; $j++){
        $crd = mysql_fetch_assoc($rCards);
            $pj = $crd['project_num'];
            /*---------------------------------------------------------------------*/
            if($pj == $this_pj) {
                $date = $crd['date'];
                $project_num = add_zeros($crd['project_num'], '3');
                $project_name = get_project_name_from_project_num($project_num);
                $task = $crd['task_desc'];
                $hours = $crd['hours'];
                $t_id = $crd['t_id'];
                $ttl_hrs_this_pj += $hours;

                $stripe_cnt++; //for row striping
                $stripe = (is_odd($stripe_cnt)) ? 'class="tr_odd"' : 'class="tr_even"' ;

                $t .= '<tr '.$stripe.'>
                    <td>
                        '.$date.'
                    </td>
                    <td>
                        '.$project_num.'
                    </td>
                    <td>
                        '.$project_name.'
                    </td>
                    <td>
                        '.$task.'
                    </td>
                    <td style="text-align:right;">
                        '.$hours.'
                    </td>
                    <td>
                        <img id="tc_"'.$t_id.' class="tc_edit" src="images/Edit_Icon.jp">
                    </td>
                </tr>
                ';
            }

    }
                $t .='<tr>
                    <td>
                    </td>
                    <td>
                    </td>
                    <td>
                    </td>
                    <td>
                        <span class="SumHoursLabel">Total Hours:</span>
                    </td>
                    <td style="text-align:right;">
                        <span class="SumHoursValue">'.number_format($ttl_hrs_this_pj,2).'</span>
                    </td>
                </tr>
            </table>
                <br />';

                //Reset counter to top for this mysql resource
                mysql_data_seek($rCards,0);

                $cntr++;
}
echo $t; 
```

# javascript - JS。如何用另一个元素/文本替换html元素，以字符串表示？

> ID：13388379
> 
> 赞同：32
> 
> 时间：2012-11-14T22:18:53.063
> 
> 标签：javascript, html, replace

我在替换 html 元素时遇到问题。

例如，这是一个表：

```
<table>
    <tr>
        <td id="idTABLE">0</td>
        <td>END</td>
    </tr>
</table> 
```

（可以是 div、span 等任何东西）

JavaScript 中的字符串：

```
var str = '<td>1</td><td>2</td>'; 
```

（可以是任何东西，，`123 text`或`<span>123 element</span> 456`任何`<tr><td>123</td>`东西）

如何用 替换`idTABLE`元素`str`？

所以：

```
<table>
    <tr>
        <td id="idTABLE">0</td>
        <td>END</td>
    </tr>
</table> 
```

变成：

```
<table>
    <tr>
        <td>1</td>
        <td>2</td>
        <td>END</td>
    </tr>
</table> 
<!-- str = '<td>1</td><td>2</td>'; -->

<table>
    <tr>
        123 text
        <td>END</td>
    </tr>
</table>
<!-- str = '123 text' -->

<table>
    <tr> 
        <td>123</td> 
        <td>END</td>
    </tr>
</table>
<!-- str = '<td>123</td>' --> 
```

我试过`createElement`, `replaceChild`, `cloneNode`, 但根本没有结果 =(

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2012-11-17T18:36:55.820

由于 Jquery replaceWith() 代码过于庞大、棘手和复杂，这是我自己的解决方案。=)

最好的方法是使用 outerHTML 属性，但它还没有跨浏览器，所以我做了一些技巧，很奇怪，但很简单。

这是代码

```
 var str = '<a href="http://www.com">item to replace</a>'; //it can be anything
    var Obj = document.getElementById('TargetObject'); //any element to be fully replaced
    if(Obj.outerHTML) { //if outerHTML is supported
        Obj.outerHTML=str; ///it's simple replacement of whole element with contents of str var
    }
    else { //if outerHTML is not supported, there is a weird but crossbrowsered trick
        var tmpObj=document.createElement("div");
        tmpObj.innerHTML='<!--THIS DATA SHOULD BE REPLACED-->';
        ObjParent=Obj.parentNode; //Okey, element should be parented
        ObjParent.replaceChild(tmpObj,Obj); //here we placing our temporary data instead of our target, so we can find it then and replace it into whatever we want to replace to
        ObjParent.innerHTML=ObjParent.innerHTML.replace('<div><!--THIS DATA SHOULD BE REPLACED--></div>',str);
    } 
```

就这样

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-11-14T22:50:24.017

因为您正在谈论您的替换是*任何东西*，并且还在元素的子元素中间替换，所以它变得比插入单个元素或直接删除和附加更棘手：

```
function replaceTargetWith( targetID, html ){
  /// find our target
  var i, tmp, elm, last, target = document.getElementById(targetID);
  /// create a temporary div or tr (to support tds)
  tmp = document.createElement(html.indexOf('<td')!=-1?'tr':'div'));
  /// fill that div with our html, this generates our children
  tmp.innerHTML = html;
  /// step through the temporary div's children and insertBefore our target
  i = tmp.childNodes.length;
  /// the insertBefore method was more complicated than I first thought so I 
  /// have improved it. Have to be careful when dealing with child lists as  
  /// they are counted as live lists and so will update as and when you make
  /// changes. This is why it is best to work backwards when moving children 
  /// around, and why I'm assigning the elements I'm working with to `elm` 
  /// and `last`
  last = target;
  while(i--){
    target.parentNode.insertBefore((elm = tmp.childNodes[i]), last);
    last = elm;
  }
  /// remove the target.
  target.parentNode.removeChild(target);
} 
```

示例用法：

```
replaceTargetWith( 'idTABLE', 'I <b>can</b> be <div>anything</div>' ); 
```

演示：

*   [http://jsfiddle.net/97H5Y/1/](http://jsfiddle.net/97H5Y/1/)

通过使用`.innerHTML`我们的临时 div 这将生成`TextNodes`并且`Elements`我们需要插入而不需要任何努力。但与其插入临时 div 本身——这会给我们标记我们不想要的——我们可以扫描并插入它的孩子。

...要么，要么期待使用 jQuery 和它的`replaceWith`方法。

```
jQuery('#idTABLE').replaceWith('<blink>Why this tag??</blink>'); 
```

### 2012/11/15 更新

作为对上述 EL 2002 评论的回应：

> 这并不总是可能的。例如，当`createElement('div')`并设置其innerHTML为时`<td>123</td>`，这个div就变成`<div>123</div>`了（js丢掉了不合适的td标签）

上述问题显然也否定了我的解决方案——我已经相应地更新了上面的代码*（至少对于这个`td`问题）*。但是，对于某些 HTML，无论您做什么，都会发生这种情况。所有用户代理都通过自己的解析规则解释 HTML，但几乎所有用户代理都会尝试自动更正错误的 HTML。准确实现您正在谈论的内容*（在您的某些示例中）*的唯一方法是将 HTML 完全从 DOM 中取出，并将其作为字符串进行操作。这将是使用以下实现标记字符串的唯一方法*（jQuery 也无法解决此问题）*：

```
<table><tr>123 text<td>END</td></tr></table> 
```

如果您随后将此字符串注入到 DOM 中，则取决于浏览器，您将获得以下信息：

```
123 text<table><tr><td>END</td></tr></table>

<table><tr><td>END</td></tr></table> 
```

剩下的唯一问题是，为什么您首先要实现损坏的 HTML？:)

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2012-11-14T22:24:48.557

使用 jQuery 你可以这样做：

```
var str = '<td>1</td><td>2</td>';
$('#__TABLE__').replaceWith(str); 
```

[http://jsfiddle.net/hZBeW/4/](http://jsfiddle.net/hZBeW/4/)

或者在纯 javascript 中：

```
var str = '<td>1</td><td>2</td>';
var tdElement = document.getElementById('__TABLE__');
var trElement = tdElement.parentNode;
trElement.removeChild(tdElement);
trElement.innerHTML = str + trElement.innerHTML; 
```

[http://jsfiddle.net/hZBeW/1/](http://jsfiddle.net/hZBeW/1/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-11-14T22:23:37.247

您将首先删除表，然后将新的替换添加到表的父对象中。

抬头`removeChild`看`appendChild`

[http://javascript.about.com/library/bldom09.htm](http://javascript.about.com/library/bldom09.htm)

[https://developer.mozilla.org/en-US/docs/DOM/Node.appendChild](https://developer.mozilla.org/en-US/docs/DOM/Node.appendChild)

编辑：jQuery .append 允许 sting-html 不删除标签：[http ://api.jquery.com/append/](http://api.jquery.com/append/)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-14T22:43:53.933

如果您需要实际替换您从 DOM 中选择的 td，那么您需要首先转到 parentNode，然后~~将内容~~替换为表示您想要的新 html 字符串的 innerHTML。诀窍是将第一个表格单元格转换为字符串，以便您可以在字符串替换方法中使用它。

我添加了一个小提琴示例：http: [//jsfiddle.net/vzUF4/](http://jsfiddle.net/vzUF4/)

```
<table><tr><td id="first-table-cell">0</td><td>END</td></tr></table>

<script>
  var firstTableCell = document.getElementById('first-table-cell');
  var tableRow = firstTableCell.parentNode;
  // Create a separate node used to convert node into string.
  var renderingNode = document.createElement('tr');
  renderingNode.appendChild(firstTableCell.cloneNode(true));
  // Do a simple string replace on the html
  var stringVersionOfFirstTableCell = renderingNode.innerHTML;
  tableRow.innerHTML = tableRow.innerHTML.replace(stringVersionOfFirstTableCell,
    '<td>0</td><td>1</td>');
</script> 
```

这里的很多复杂之处在于您将 DOM 方法与字符串方法混合在一起。如果 DOM 方法适用于您的应用程序，那么使用它们会更好。 ~~您也可以使用纯 DOM 方法（document.createElement、removeChild、appendChild）来执行此操作，但它需要更多的代码行，并且您的问题明确表示您想使用字符串。~~

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-14T23:47:46.370

在这种情况下，您的输入太模棱两可了。您的代码必须知道它是否应该按原样插入文本或解析出一些 HTML 标记（否则会以错误的 HTML 结束）。这是不必要的复杂性，您可以通过调整您提供的输入来避免。

如果乱码输入是不可避免的，那么如果没有一些复杂的解析（最好在一个单独的函数中），您最终可能会得到一些糟糕的 HTML（就像您在第二个示例中所做的那样......这很糟糕，对吗？）。

我猜您想要一个将列插入 1 行表的函数。在这种情况下，您的内容应作为数组传入（不带 table、tr、td 标记）。每个数组元素将是一列。

# HTML

```
<table id="__TABLE__"><tr><td></td></tr></table> 
```

# JS

为简洁起见使用 jQuery...

```
function insert_columns (columns)
{
    var $row = $('<tr></tr>');

    for (var i = 0; i < columns.length; i++)
        $row.append('<td>'+columns[i]+'</td>');

    $('#__TABLE__').empty(); // remove everything inside

    $('#__TABLE__').append($row);
} 
```

那么……

```
insert_columns(['hello', 'there', 'world']); 
```

# 结果

```
<table id="__TABLE__"><tr><td>hello</td><td>there</td><td>world</td></tr></table> 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2012-11-14T22:29:58.393

使用属性“innerHTML”

以某种方式选择表格：

```
var a = document.getElementById('table, div, whatever node, id')
a.innerHTML = your_text 
```

# amazon-web-services - 检索二手和新商品，检测它们的状况 - 亚马逊 MWS

> ID：13388383
> 
> 赞同：0
> 
> 时间：2012-11-14T22:19:14.887
> 
> 标签：amazon-web-services, amazon, amazon-mws

我们已经通过 Amazon MWS API 获得了我们的产品列表，其中包含 ReportTyp `_GET_FLAT_FILE_OPEN_LISTINGS_DATA_`。我们遇到的问题是，我们无法查看产品是`NEW`还是`USED`。而且我也不知道我可以和谁一起做那个报告。您是否知道任何解决方案，这让我有机会检测 SKU 是否列在下面`NEW`或下面`USED`？

感谢 adcanve

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T21:59:12.000

对于这个问题，我找到了以下方法。您将需要`Amazon MWS Product API`ReportTyp `GetMyPriceForSKU`。在那里你会找到部分`condition`和`subCondition`。

# objective-c - 尝试按降序对部分进行排序

> ID：13388389
> 
> 赞同：0
> 
> 时间：2012-11-14T22:19:34.217
> 
> 标签：objective-c, xcode

```
 self.sections = [[NSMutableDictionary alloc] init];
        BOOL found;
        for (NSDictionary *wine in sortedWines)
        {
            NSNumber *rate = [wine valueForKey:@"Rate"];
            NSString *rateStr = [NSString stringWithFormat:@"%.f", [rate floatValue]];
            found = NO;
            for (NSString *str in [self.sections allKeys])
            {
                if ([str isEqualToString:rateStr])
                {
                    found = YES;
                }
            }
            if (!found)
            {[self.sections setValue:[[NSMutableArray alloc] init] forKey:rateStr];}
        }
        for (NSDictionary *wine in sortedWines)
        {[[self.sections objectForKey:[NSString stringWithFormat:@"%.f", [[wine valueForKey:@"Rate"] floatValue]] ] addObject:wine];}

        // Sort:
        for (NSString *key in [self.sections allKeys])
        {[[self.sections objectForKey:key] sortUsingDescriptors:[NSArray arrayWithObject:[NSSortDescriptor sortDescriptorWithKey:@"Rate" ascending:NO]]];} 
```

这段代码将我的葡萄酒分成几个部分，但它不会按降序对它们进行排序！难道是因为 NSNumber 被转换成了 NSString？我尝试使用 NSNumber 值编写代码：

```
 self.sections = [[NSMutableDictionary alloc] init];
        BOOL found;
        for (NSDictionary *wine in sortedWines)
        {
            NSNumber *rate = [wine valueForKey:@"Rate"];
            found = NO;
            for (NSNumber *str in [self.sections allKeys])
            {
                if ([str isEqualToNumber:rate])
                {
                    found = YES;
                }
            }
            if (!found)
            {[self.sections setValue:[[NSMutableArray alloc] init] forKey:rate];}
        }
        // Loop again to sort wines into their keys
        for (NSDictionary *wine in sortedWines)
        {[[self.sections objectForKey:[wine valueForKey:@"Rate"]] addObject:wine];}

        // Sort each section array
        for (NSString *key in [self.sections allKeys])
        {[[self.sections objectForKey:key] sortUsingDescriptors:[NSArray arrayWithObject:[NSSortDescriptor sortDescriptorWithKey:@"Rate" ascending:NO]]];} 
```

但它给出了一个警告

```
if (!found)
{[self.sections setValue:[[NSMutableArray alloc] init] forKey:rate];} 
```

上面写着“不兼容的指针类型将 NSNumber ___strong 发送到 NSString 类型的参数”

如果我运行该应用程序，它会因错误而崩溃`-[__NSCFNumber localizedCaseInsensitiveCompare:]: unrecognized selector sent to instance 0x1e085810`

我必须进行哪些更改才能使其正常工作并按降序对部分进行排序？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T01:37:01.630

我不知道 sortDescriptorWithKey:ascending: 的默认选择器现在是否为 caseInsensitiveCompare:，我很确定它曾经只是 compare:。在任何情况下，您都可以使用 sortDescriptorWithKey:ascending:selector: 代替，并为选择器传递 compare:。我认为这应该可以解决您的第二个错误。仍然不确定为什么会出现第一个错误。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T02:12:44.363

You would do much better (and we'd understand you better) if you formatted your code for legibility. Eg:

```
 // Loop again to sort wines into their keys
    for (NSDictionary *wine in sortedWines) {
        NSArray* section = [self.sections objectForKey:[wine valueForKey:@"Rate"]];
        [section addObject:wine];
    }

    // Sort each section array
    NSArray* sortDescriptorArray = [NSArray arrayWithObject:[NSSortDescriptor sortDescriptorWithKey:@"Rate" ascending:NO]];
    for (NSString *key in [self.sections allKeys]) {
         NSArray* section = [self.sections objectForKey:key];
         [section sortUsingDescriptors:sortDescriptorArray];
    } 
```

Among other things, this makes debugging much simpler since you can stop and dump the `section` arrays.

Or, if you really liked it better the other way, I can highly recommend that you learn APL or LISP instead.

# java - 如何使用 Junit 测试处理 try/catch 和 throw

> ID：13388390
> 
> 赞同：1
> 
> 时间：2012-11-14T22:19:40.207
> 
> 标签：java, exception-handling, junit

我对使用 Junit 在 Java 中处理异常有点陌生，非常感谢一些指导。

我正在尝试做的事情：

*   我用 a 包围了新 CustomObject 的创建，因为当我们调用时`try`，用户可以传入一个与 a`String`不匹配的a 。我希望能够在这里捕获异常，尽管有人告诉我：“应该避免捕获异常仅重新抛出异常的 catch 语句。”。必须有更好的方法来处理这个问题？`enum``valueof()`

*   如果新对象正确，`enum`那么我调用`isValidObject`，它返回一个`boolean`. 如果`Integer`无效，那么我`throw`是一个例外。

*   我的测试有一个`@Test(expected = AssertionError.class)`并且正在通过。

是否有更好/更清洁的方式来使用异常？

我有以下代码：

```
private CustomObject getObjectFromString(String objectDataString) {
        if (objectDataString != null) {
            String[] customObjectComponents = objectDataString.split(":");
            try {
                CustomObject singleObject = new CustomObject(EnumObjectType.valueOf(customObjectComponents [0]),
                        Integer.parseInt(customObjectComponents [1]));
                if (isValidCustomObject(singleObject)) {
                    return singleObject;
                } else {
                    throw new IllegalArgumentException("Unknown custom object type/value: " + EnumObjectType.valueOf(customObjectComponents [0]) + ":"
                            + Integer.parseInt(customObjectComponents [1]));
                }
            } catch (IllegalArgumentException e) {
                throw e;
            }

        } 
```

哦，如果有人能推荐任何关于异常处理的好读物，那就太好了。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-14T22:21:38.487

> 应该避免捕获异常仅重新抛出异常的 catch 语句。”。必须有更好的方法来处理这个问题吗？

是的，只需删除 try catch。您的代码相当于：

```
private CustomObject getObjectFromString(String objectDataString) {
    if (objectDataString != null) {
        String[] customObjectComponents = objectDataString.split(":");
        CustomObject singleObject = new CustomObject(EnumObjectType.valueOf(customObjectComponents[0]),
                Integer.parseInt(customObjectComponents[1]));
        if (isValidCustomObject(singleObject)) {
            return singleObject;
        } else {
            throw new IllegalArgumentException("Unknown custom object type/value: " + EnumObjectType.valueOf(customObjectComponents[0]) + ":"
                    + Integer.parseInt(customObjectComponents[1]));
        }
    }
} 
```

`IllegalArgumentException`如果传递给您的值`enum.valueOf()`无效或者您的`isValidCustomObject`方法返回 false ，则该代码将抛出一个错误。

请注意，`IndexOutOfBoundException`如果字符串不包含`:`您可能想要在调用之前测试的 a ，它也可能会抛出一个`customObjectComponents[1]`。它也可能抛出 NumberFormatException 。

而且您似乎接受空字符串作为有效条目，[这可能不是一个好主意](https://stackoverflow.com/questions/271526/avoiding-null-statements-in-java)（显然取决于您的用例）。

我可能会这样写：

```
private CustomObject getObjectFromString(String objectDataString) {
    Objects.requireNonNull(objectDataString, "objectDataString should not be null");
    String[] customObjectComponents = objectDataString.split(":");
    if (customObjectComponents.length != 2) {
        throw new IllegalArgumentException("Malformed string: " + objectDataString);
    }

    EnumObjectType type = EnumObjectType.valueOf(customObjectComponents[0]);
    try {
        int value = Integer.parseInt(customObjectComponents[1]);
    } catch (NumberFormatException e) {
        throw new IllegalArgumentException(customObjectComponents[1] + " is not an integer);
    }

    CustomObject singleObject = new CustomObject(type, value);
    if (isValidCustomObject(singleObject)) {
        return singleObject;
    } else {
        throw new IllegalArgumentException("Unknown custom object type/value: " + type + ":" + value);
    }
} 
```

最后，CustomObject 的构造函数自己检查它的参数是否正确可能是有意义的，而不是必须调用单独的 isValid 方法。最后一个块将只是：

```
 return new CustomObject(type, value); 
```

如果需要，它将从构造函数中抛出 IllegalArgumentException。

# mod-rewrite - mod_rewrite 301 重定向数百个旧的非结构化 url

> ID：13388393
> 
> 赞同：1
> 
> 时间：2012-11-14T22:19:53.153
> 
> 标签：mod-rewrite, redirect, apache2, rewritemap

我需要将（301）数百个旧的非结构化 url 重定向到新的。旧网址有查询字符串 domain/directories/randomtext?args=1

我有一个包含 oldurl newurl 行的文件。

我正在尝试在虚拟主机中使用 RewriteMap

```
RewriteMap mapfile txt:mapfile.txt
RewriteCond ${mapfile:$1|NOT_FOUND} !NOT_FOUND
RewriteRule ^(.+)$ ${mapfile:$1} [L,R=301] 
```

是否可以在 RewriteCond 中包含查询字符串？

我这样解决了：

```
#define map file with oldurl newurl format
RewriteMap mapfile txt:mapfile.txt
#test if request_uri?query_string is in mapfile so length is greater than ""
RewriteCond ${mapfile:$1?%{QUERY_STRING}} >""
#If matched rewrite oldurl to mapfile[key]
RewriteRule ^/(.+)$ ${mapfile:$1?%{QUERY_STRING}}? [R=301] 
```

我认为这可以改进，因为缓存查找总是失败。我想只有 request_uri 被缓存。

重写日志

```
(2) init rewrite engine with requested uri /prueba
(3) applying pattern '(.*)' to uri '/prueba'
(4) RewriteCond: input='/prueba' pattern='^/$' => not-matched
(3) applying pattern '(.*)' to uri '/prueba'
(4) RewriteCond: input='/prueba' pattern='^/index.php$' => not-matched
(3) applying pattern '^/(.+)$' to uri '/prueba'
(4) RewriteCond: input='/prueba' pattern='!-f' => matched
(4) RewriteCond: input='/prueba' pattern='!-d' => matched
(4) RewriteCond: input='/prueba' pattern='!.*\.(ico|gif|jpg|jpeg|png|js|css|GIF|JPG)' =>     matched
(6) cache lookup FAILED, forcing new map lookup
(5) map lookup OK: map=mapfile[txt] key=prueba?prueba=1 -> val=/index.php
(4) RewriteCond: input='/index.php' pattern='>""' => matched
(5) cache lookup OK: map=mapfile[txt] key=prueba?prueba=1 -> val=/index.php
(2) rewrite '/prueba' -> '/index.php?' 
```

# php - mysql/php 更新查询参数导致它失败

> ID：13388397
> 
> 赞同：1
> 
> 时间：2012-11-14T22:20:33.557
> 
> 标签：php, mysql

我正试图让我的表格按照[这个视频](http://youtu.be/Zr0ktM3fjaI?t=12m3s)的工作方式工作。（如果您只是移动到最后 3-4 分钟，您将看到他的最终代码。）

```
 $UpdateQuery = "UPDATE aznet_data_spare_inventory SET ID='$_POST[id]', Shelf='$_POST[shelf]', Device Type='$_POST[device type]' WHERE ID='$_POST[hidden]'"; 
```

如果我取出更新查询的设备类型部分，ID 和货架更新将起作用，但当我尝试使设备类型工作时，它就会中断。我想我只是想知道是否有针对空格的规则或类似的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T22:29:50.030

首先考虑使用 MySQLi 或 PDO 代替 MySQL，然后尝试调试您的代码

```
$UpdateQuery = "UPDATE aznet_data_spare_inventory SET ID='$_POST[id]', Shelf='$_POST[shelf]', Device Type='$_POST[device type]' WHERE ID='$_POST[hidden]'";

if(mysql_query($UpdateQuery,$con)){
//query is ok
 echo "item is updated";
}else{
 die(mysql_error());
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T22:30:07.023

请注意，不推荐使用 MySql 扩展，您应该考虑使用 MySqli 或 PDO。并且您永远不应该将用户输入数据，例如`$_POST`，直接放入您的查询中。研究清理数据的适当方法。
我没有看到您`<tr>`在 while 循环中关闭标签。您也不会关闭任何`<input>`标签。

是的，MySql 列名也不应该有任何空格。尝试重命名`Device Type`为`Device_Type`. 如果您检查是否`mysql_query()`返回 false 和 output `mysql_error()`，它可能会提供一些错误详细信息。

# php - 多表 SQL 字符串不起作用

> ID：13388399
> 
> 赞同：1
> 
> 时间：2012-11-14T22:20:42.097
> 
> 标签：php, mysql, sql

我得到了一些代码，需要查看三个表以显示我的世界顶级列表的一些信息。表格如下：

服务器

```
id | user_id | name | information | websitename | websiteurl | postdate.. etc 
```

这是包含服务器名称、网站信息（服务器的完整描述）等的主表。

投票

```
id | server_id | username | ipaddress | votetimestamp 
```

在网站上，我允许玩家每 24 小时投票一次。所有投票都被插入到这个表中，用户在游戏中的名称（用户名）、服务器 ID 和投票时间。

平

```
id | server_id | min_player | max_player | motd | pingtimestamp 
```

该表每 10 分钟由另一个脚本更新一次，其中 CronJobs 使用 fsock 在我的 Web 服务器上运行。这样做我可以知道服务器是离线还是在线，有多少玩家在线以及一次可以有多少玩家在线。

在我的索引页面上，我得到了一个脚本，该脚本应该将所有三个表中的数据提取到网页上，并按照数据库顺序显示每个服务器，排在得票最多的服务器到得票最少的服务器之后。

我可以拉出所有已经在投票表中投票的服务器，但是如果有一个服务器还没有收到投票，它就不会被列出。这是我使用的 SQL 代码。

```
SELECT DISTINCT(ping.server_id), COUNT(vote.server_id) AS count, servers.id,
       servers.name, servers.server_ip, ping.min_player,ping.max_player,ping.motd
  FROM servers,vote,ping
 WHERE servers.id = vote.server_id
   AND servers.id = ping.server_id
 GROUP BY servers.id
 ORDER BY count DESC
 LIMIT $start, $per_page 
```

我确信这很简单，但我现在尝试了一些东西，但似乎没有任何效果。在这一点上提一下 SQL 并不是我的强项是个好主意。

**编辑** 我试图删除字符串中的“DISTINCT”，但由于某种原因，它返回每台服务器的多行，这些服务器不止一次显示服务器。每个服务器应该只显示一次，从上到下排序在获得最多票数到最少票数的服务器之后。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T23:05:27.053

首先，不要使用逗号分隔的语法来简单地列出 From 子句中的表；而是使用 Join 语法。如果您向我们展示一些示例输入和预期输出，将会有所帮助。您说您想要所有服务器，无论他们是否有投票权，这意味着您可能需要使用左连接：

```
Select servers.id
    , Count(vote.server_id) As cnt
    , servers.name
    , servers.server_ip
    , Min(ping.min_player) As min_player
    , Max(ping_ping.max_player) As max_player
    , Min(ping.motd) As Min_Motd
From servers
    Left Join votes
        On votes.server_id = servers.id
    Left Join ping
        On ping.server_id = servers.id
Group By servers.id
    , servers.name
    , servers.server_ip
    , ping.server_id 
```

`ping`如果表中有多行`ping`具有相同的`servers.id`值，您不清楚表的结构和用途，也不清楚结果的性质。在上面的例子中，我猜到了用于 和 的`ping.min_player`聚合`ping.max_player`函数`ping.motd`。此外，我假设您确实需要所有服务器行，而不一定是`ping`表中包含值的行，因此我使用了左连接 from `servers`to `ping`。

此外，如果`servers.id`是`servers`表的主键，并且由于您使用的是 MySQL，因此您不需要在 Group By 中枚举其所有列（但您会在其他数据库产品中）。由于没有说明是否`servers.id`是主键，所以我列举了它们。

# java - 用于 Windows 的目标 C IDE

> ID：13388413
> 
> 赞同：0
> 
> 时间：2012-11-14T22:21:52.807
> 
> 标签：java, objective-c, ide, java-native-interface, native

在 Windows 计算机上，对我来说，Objective C 的最佳 IDE 是什么？我想使用它的主要原因是创建供 JNI 使用的 .dll 库。即使我使用 Visual Studio C++，JNI 是否允许 .dll 跨平台？我已经为 C/C++ 尝试了 Eclipse，但它不能正常工作，我得到一个启动错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T23:42:17.750

这个如何？它可能不是一个完整的 IDE，但仍然可以提供帮助吗？

[http://www.editrocket.com/features/objective-c_editor.html](http://www.editrocket.com/features/objective-c_editor.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-10-29T01:47:20.650

我会使用 code::blocks ide。它带有向导来帮助您设置项目，例如：SFML 2d 图形或 sdl 甚至 Opengl 等等！

# android - 如何将结果发送到列表中

> ID：13388416
> 
> 赞同：1
> 
> 时间：2012-11-14T22:22:05.923
> 
> 标签：android, listview, android-listview

输出在文本上，但我想在列表或列表视图中输出以供选择。我该怎么做？注意：这段代码是用 THREAD 写的

```
ChannelSftp sftpChannel = (ChannelSftp) channel;

                     try {
                         Vector ls=sftpChannel.ls("/home/volkan/Masaüstü");

                         for(int i=0;i<ls.size();i++){
                             text +=sftpChannel.pwd()+"/";
                             text += (((LsEntry)ls.get(i)).getFilename())+"\n";

                         }
                         t.post(new Runnable() {
                             public void run() {
                                t.setText(text);
                             }
                         });
                     } catch (SftpException e1) {
                         // TODO Auto-generated catch block
                     } 
```

# c# - MediaElement 源属性不适用于 VideosLibrary 中的视频

> ID：13388418
> 
> 赞同：0
> 
> 时间：2012-11-14T22:22:17.037
> 
> 标签：c#, windows-8, windows-runtime

我在 KnownFolders.VideoLibrary 文件夹中有一个 mp4 视频，我可以使用以下代码通过 MediaElement Control (MyPlayer) 将其作为流播放：

```
var file = await KnownFolders.VideosLibrary.GetFileAsync("video.mp4");
var stream = await file.OpenAsync(FileAccessMode.Read);
MyPlayer.SetSource(stream, file.FileType); 
```

但我无法使用 Source 属性让它播放：

```
var file = await KnownFolders.VideosLibrary.GetFileAsync("video.mp4");
MyPlayer.Source = new Uri(file.Path, UriKind.Absolute); 
```

但是 Source 属性适用于本地资产文件：

```
MyPlayer.Source = new Uri(this.BaseUri, "Assets/video.mp4"); 
```

任何想法为什么？每当文件位于 VideoLibrary 文件夹中时，我也无法将视频绑定到 XAML 中的 Source 属性。如果文件是应用程序的资产，则效果很好。

现在，如果我*必须*对库中的视频使用流和 SetSource，我该如何从 ViewModel 绑定它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-17T11:55:33.230

我通过使用 ContentControl 并将 MediaElement 绑定到它来解决这个问题。我写了一篇关于它的简短博客文章。

[将 MediaElement 绑定到 Windows 8 应用商店应用中的 ViewModel](http://weblogs.asp.net/jdanforth/archive/2012/12/14/binding-mediaelement-to-a-viewmodel-in-a-windows-8-store-app.aspx)

# c++ - C ++ istream提取器精度？

> ID：13388425
> 
> 赞同：1
> 
> 时间：2012-11-14T22:22:36.380
> 
> 标签：c++, precision, istream, extractor

我正在从包含以下行的文本文件中读取：

```
 deltaT          0.005; 
```

一旦我在字符串中找到了正确的行，我想用这样的代码读出值：

```
 double deltaT;
      stringstream ss(line);
      ss >> tag;                //Contains:         deltaT
      ss >> deltaT;             //Should contain:   0.005 
```

在调试过程中，我看到 deltaT 包含： 0.0050000000000000001

那么有没有办法像流插入器一样设置提取器的“精度”？

或者保证文本文件中的值是我程序中的双精度值的最佳方法是什么。

谢谢，玛德琳。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T22:27:06.803

这是二进制浮点类型的常见问题：`0.005`不能完全由 a 表示`double`，因此从“十进制文字”转换产生的数字与 a 可表示的最相似`double`。

如果您想使用`double`或其他有限的二进制浮点类型，则没有解决方案，因为`0.005`在十进制中具有有限形式，但[在二进制中是周期性的](http://www.wolframalpha.com/input/?i=0.005%20in%20binary)（并且任何 FP 类型的尾数都是有限的）。

要了解这怎么可能，请考虑分数 1/3：在基数 3 中它具有有限表示，而在基数 10 中它是周期性的：

(1/3) [10] = 0.33333... [10] = 0.1 [3]

现在，任何“常规”浮点类型都只有一些有限的尾数空间（即要存储的有效数字），因此每个周期数都必须在某个点被截断（实际上是四舍五入）；这会导致您看到的精度损失。

请注意，有几个“任意精度库”可用于处理此类问题，并以仅受可用内存（例如[GMP](http://gmplib.org/)）限制的精度进行数学运算，但您应该考虑额外的复杂性/性能损失是否实际上是合理的获得精度。

另一种解决方案（通常在进行涉及金钱的计算时使用）是使用固定精度类型，将金额存储为一个整数，通过一些小数因子“隐式缩放”（这个概念是您将美分存储为整数而不是美元作为`float`或任何）; 这避免了从十进制到二进制转换的任何意外，因为所有整数都可以用任何基数的有限位数精确表示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T22:34:20.490

读取值时没有精度限制之类的东西。无论如何，您都不想拥有它：您希望获得最接近的值。乍一看，这似乎就是你得到的！该值`0.005`看起来不像可以用二进制浮点精确表示的值。类型`double`及其朋友表示为 (-1)^(*符号*)**有效*数*2^(*指数*)，很明显这不能表示所有十进制值。

问题更多出在格式上：您应该让格式选择要格式化的数字位数。假设原始值只是从某个源读取并且是十进制值而不是某些计算的结果，那么您应该在格式化时取回原始值（即尾随零除外）。

# usb - USB JTAG 脚本

> ID：13388428
> 
> 赞同：0
> 
> 时间：2012-11-14T22:22:50.310
> 
> 标签：usb, jtag

我需要编写一个脚本来通过 JTAG-USB（Texas Instrument 的 XDS100v2）连接 Texas Instrument 的 RM48x，以实现边界扫描，因为 Texas Instrument 的工具都没有这样做。

有一些工具可以做到这一点，但它们都非常昂贵，我的项目没有钱。

这里有人试过吗？或者至少这里有人知道从哪里开始吗？

# html - 中心对齐子导航到父级

> ID：13388433
> 
> 赞同：0
> 
> 时间：2012-11-14T22:23:23.347
> 
> 标签：html, css

如何将子导航菜单居中到父项？

对于每个导航菜单，我希望子导航菜单居中。

这是我尝试过的：[JSFIDDLE](http://jsfiddle.net/XzqS4/7/)

这是我的 HTML：

```
<ul class="nav">
    <li>
        <a href="#">Lorem Ipsum</a>
        <ul class="sub-nav">
            <li>
                <a href="#">Sub Nav 1</a>
            </li>
            <li>
                <a href="#">Sub Nav 2</a>
            </li>
            <li>
                <a href="#">Sub Nav 3</a>
            </li>
        </ul>
    </li>
    <li>
        <a href="#">Lorem</a>
        <ul class="sub-nav">
            <li>
                <a href="#">Sub Nav 1</a>
            </li>
            <li>
                <a href="#">Sub Nav 2</a>
            </li>
            <li>
                <a href="#">Sub Nav 3</a>
            </li>
        </ul>
    </li>
     <li>
        <a href="#">Sum</a>
            <ul class="sub-nav">
            <li>
                <a href="#">Sub Nav 1</a>
            </li>
            <li>
                <a href="#">Sub Nav 2</a>
            </li>
            <li>
                <a href="#">Sub Nav 3</a>
            </li>
        </ul>
    </li>
    <li>
        <a href="#">Lorem Lorem Ipsum</a>
            <ul class="sub-nav">
            <li>
                <a href="#">Sub Nav 1</a>
            </li>
            <li>
                <a href="#">Sub Nav 2</a>
            </li>
            <li>
                <a href="#">Sub Nav 3</a>
            </li>
        </ul>
    </li>
</ul>​ 
```

CSS：

```
.nav {
    list-style-type: none;
    margin: 0;
    padding: 0;
}

.nav li {
    float: left;  
    margin: 0 10px 0 0;   
    position: relative;        
} 

.nav li:hover .sub-nav {
    display: block;
}    

.nav li .sub-nav {
    margin: 0;
    padding: 0;
    width: 120px;
    position: absolute;
    z-index: 500;
    left: 0;
    top: 32px;
    display: none;  
    background: red;    
} 

.nav li .sub-nav li {
    float: none;    
    text-align: center;    
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-14T22:47:31.767

从 subnav 的中心点减去第一个 nav 的中心点，并将其用作 subnav 上的左侧位置

[http://jsfiddle.net/XzqS4/10/](http://jsfiddle.net/XzqS4/10/)

```
$(".nav > li > a").hover(function(e){
    var $el = $(this),
    elc = $el.width()/2,
    $subnav = $el.parent().find('.sub-nav'),
    subc = $subnav.width()/2;

    $subnav.css({ left: -(subc-elc)+'px' });
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-14T22:44:30.800

可以用 JQuery 做到这一点

```
var subNavWidth=120;

$('.sub-nav').each(function(){
   var parentW=$(this).parent().width()
   var left= (parentW-subNavWidth)/2;
   $(this).css('left', left);       
}); 
```

演示[http://jsfiddle.net/XzqS4/9/](http://jsfiddle.net/XzqS4/9/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-14T23:22:22.593

如果子菜单具有固定宽度，您可以在没有 js/jquery 的情况下执行此操作，试试这个小提琴[http://jsfiddle.net/XzqS4/13/](http://jsfiddle.net/XzqS4/13/)

如果您将 sub-nav 50% 放在左侧，将 li -60px (width/2) 放在左侧（以及其他更改，例如背景颜色和宽度）

```
.nav li .sub-nav {
    margin: 0;
    padding: 0;
    width: 100%;
    position: absolute;
    z-index: 500;
    left: 50%;
    top: 32px;
    display: none;
} 

.nav li .sub-nav li {
    float: none;    
    text-align: center;
    width: 120px;
    background: red;
    margin-left: -60px;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-14T22:28:22.277

尝试添加“宽度：120px；” to .nav li .sub-nav li

# javascript - 改变div的内容

> ID：13388437
> 
> 赞同：0
> 
> 时间：2012-11-14T22:23:52.490
> 
> 标签：javascript

我想更改 div 内容，

这是我的代码：

```
<script type="text/javascript">
function changeText(){
    document.getElementById('df').value = 'changed';
}
</script>
<div id="df"></div>
<input type='button' onclick='changeText()' value='Change'/> 
```

没发生什么事

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T22:25:00.867

你需要`innerHTML`，不是`value`

```
function changeText(){
    document.getElementById('df').innerHTML = 'changed';
} 
```

[**演示**](http://jsfiddle.net/YTzdN/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T22:32:35.080

```
document.getElementById('df').innerHTML = 'changed'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T22:38:49.813

采用：

```
function changeText(){
    document.getElementById('df').innerHTML = 'changed';
} 
```

此外 - 这是实际的 html，而不仅仅是文本。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-11-14T22:27:14.133

尝试：

```
$('#df').append("changed"); 
```

# android - 仅完成选项卡布局中的一项活动

> ID：13388438
> 
> 赞同：-1
> 
> 时间：2012-11-14T22:23:53.950
> 
> 标签：android, tabs, android-activity, activity-finish

我正在制作一个带有标签布局的应用程序。在应用程序内部，我有两个活动。一项活动有 30 个项目，我通过按下按钮来标记/取消标记它们。在第二个活动中，只显示标记的项目（我有两个列表视图，我正在传递一个包含标记项目数量的数组）。这就是问题所在，假设我在第一个活动中标记了 2 个项目，我要去第二个，一切正常，但是当我回去标记 2 个新项目时，我的第二个活动没有任何反应。我知道为什么，我在 oncreate 方法中“制作”我的项目，当我在第一个活动中时，我的第二个活动是 onPause。 **所以我想完成那个活动，但是**当我写这样的东西时，问题就来了：

```
 @Override
protected void onPause() {
    Second.this.finish();
    super.onPause();
} 
```

它关闭了整个应用程序，如何只完成第二个活动，以便每次再次打开时都可以调用 oncreate 方法？感谢帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T23:03:01.200

你不应该完成那个活动。一旦您标记了新项目将其状态（标记/未标记）存储在数据库或文件或其他任何内容中，一旦您的第二个即将开始，您将需要加载项目并按标记过滤它们，因此您将获得标记项目的列表。

# objective-c - XCode 4.5 警告父/子类的类别之间的方法名称冲突

> ID：13388440
> 
> 赞同：7
> 
> 时间：2012-11-14T22:24:12.037
> 
> 标签：objective-c, ios, xcode, xcode4.5, categories

我正在开发一个最初在 XCode 4.0 中构建的项目，然后迁移到使用 XCode 4.2。现在我已经测试了迁移到 XCode 4.5，我收到了大量的警告，如下所示......

```
instance method 'values' in category from <pathToTheFile>/HistoryObject+extras.o conflicts with same method from another category 
```

这些警告从未出现在以前版本的 XCode 中，代码也没有改变。

该项目为部署目标设置为 iOS 4.3。

因此，我们从以前的开发人员那里得到了一堆 DAO 类型类，我相信它们是从 CoreData 自动生成的，然后这些类中的每一个都有一个 Category 扩展它以实现某些方法。我举个例子...

我们有一个名为 LisaObject 的基类，它继承自 NSManagedObject，它有一个名为 LisaObject+extras 的类别。在 LisaObject+extras 中，有一个名为“values”的方法，它返回一个 NSMutableDictionary。

然后我们有一个继承自 LisaObject 的名为 HistoryObject 的类。HistoryObject 还有一个名为 HistroyObject+extras 的类别。此类别还有一个名为“值”的方法。在 HistoryObject+extras values 方法中，它调用 [super values]，然后检查一些条件并在字典中设置一些在基类方法中没有设置的附加值。

然后，我们有一个名为 LessonStatusObject 的类，它继承自 HistoryObject，它也有一个名为 LessonStatusObject+extras 的类别，它有一个名为 values 的方法。这个 values 方法也调用 [super values] 然后对返回的字典做一些额外的工作。

对于这些“值”方法中的每一个，我们在编译时都会收到一个警告，就像上面显示的那样，它说 Category 有一个名称冲突的方法。

我对此有几个问题。

首先，这种实现是否会导致任何合法问题，或者这些警告通常是良性的？我试图思考这个实现如何在运行时导致歧义，但我不明白这是怎么发生的。

其次，我应该做些什么来修复这些警告（我的意思不是让它们停止出现；我的意思是修复原因）？我们还有其他方法可以解决这个问题吗？

另外，为什么 XCode 4.2 不会对此发出警告，但 XCode 4.5 会发出警告？

我对类别有误解吗？我的意思是，如果“values”方法实际上是每个类实现的一部分，那么按照我们的方式覆盖它们不会有问题，但编译器似乎只是因为这些是类别而抱怨。这有什么不安全的吗？

非常感谢任何建议。

**编辑：**只是为了提供更多信息......当我们使用 XCode 4.2 时，该项目将编译器设置为 Apple LLVM Compiler 3.0。现在，当我在 XCode 4.5 中打开项目时，它的编译器设置为 Apple LLVM Compiler 4.1。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-11-24T00:27:07.383

我遇到了同样烦人的问题，结果发现我不小心在我的一个 VC 代码中包含了该类别的 .m 文件而不是 .h 文件。将其更正为 .h 文件删除了链接器警告。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-14T23:27:21.083

不要忽略警告。

Apple 的“使用 Objective-C 编程”指南在“[自定义现有类](http://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/ProgrammingWithObjectiveC/CustomizingExistingClasses/CustomizingExistingClasses.html)”部分中说：

> 如果在一个类别中声明的方法的名称与原始类中的方法相同，或者与同一类（甚至是超类）上的另一个类别中的方法相同，则对于在哪个方法实现中使用的行为是不确定的运行。

如果它一直为你工作，那么它是幸运的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-30T21:55:35.767

我也有这个问题，但又是由不同的东西引起的。对我来说，这个类别已经被添加到 Xcode 项目中两次了！直到我去重命名其中一个方法并在重构预览中看到它两次列出了类别文件时，我才发现是这种情况。

# dojo - 从回调函数访问 ioArgs

> ID：13388443
> 
> 赞同：0
> 
> 时间：2012-11-14T22:24:21.220
> 
> 标签：dojo

我正在将一堆旧道场升级到 1.8。对于我们的 ajax 请求处理，我们有一个装饰器（嗯，函数包装器），它将在某些情况下根据响应内容执行重定向，例如：

```
// Decorator func:
var redirectDecorator = function(func) {
    var f = function(data, ioArgs) {
        if(data.redirect) {
            // A manual location redirect:
            window.location.href = data.redirect;
        if(data.redirect_xhr) {
            // clone ioArgs, spawn new request to follow redirect etc
            // <snip>
        } else {
            func(response);
        }
    }
    return f;
}

// Used like so:

dojo.xhrPost({
    url: url
    handleAs: "json",
    form: form,
    load: redirectDecorator(function(data, ioArgs) {
        // do stuff
    })
}); 
```

现在，在 dojo 1.8（[dojo/request/xhr](http://dojotoolkit.org/reference-guide/1.8/dojo/request/xhr.html#dojo-request-xhr)模块）中`xhr()`返回一个`Deferred`for 链接，并且回调仅提供`data`参数（不`ioArgs`- 显然这些附加到承诺 - 请参阅[http://bugs.dojotoolkit.org/ticket/ 12126](http://bugs.dojotoolkit.org/ticket/12126) )。

也就是说，上面的ajax调用变成了：

```
xhr.post(url, {
    handleAs: "json",
    form: form
}).then(function(data) {
    // do stuff
}); 
```

问题是，我不能再包装匿名函数，因为`ioArgs`没有提供。检查延迟（通过中断链接）似乎也不起作用，并且需要比我想要的更多的重新设计。

有任何想法吗？

* * *

感谢 Ken（也感谢您在#dojo 的帮助）。详细地说，解决方案是使用`dojo/request`和使用`.response`延迟承诺，它提供了必要的信息：

```
// Decorator func:
var redirectDecorator = function(func) {
    var f = function(response) {
        var data = response.data;
        if(data.redirect) {
            // A manual location redirect:
            window.location.href = data.redirect;
        if(data.redirect_xhr) {
            request(data.redirect_xhr, response.options).then(func);
        } // more conditions follow.
    }
    return f;
}

request.post(url, {
    handleAs: "json",
    form: form
}).response.then(redirectDecorator(function(response) { // <-- note .response.then(
    // do stuff where data is response.data
})); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T22:39:38.573

从返回的 Promise实际上是带有提供更多信息`dojo/request`的附加 Promise 的对象。`response`有关信息，请参见以下位置：

*   [http://www.sitepen.com/blog/2012/08/21/introducing-dojorequest/](http://www.sitepen.com/blog/2012/08/21/introducing-dojorequest/)
*   [http://dojotoolkit.org/reference-guide/1.8/dojo/request.html](http://dojotoolkit.org/reference-guide/1.8/dojo/request.html)
*   [http://dojotoolkit.org/documentation/tutorials/1.8/ajax/](http://dojotoolkit.org/documentation/tutorials/1.8/ajax/)

# cloudbees - 公共可用的 Maven 存储库

> ID：13388448
> 
> 赞同：2
> 
> 时间：2012-11-14T22:25:00.807
> 
> 标签：cloudbees

是否可以在 cloudbees 上拥有公开可用的读取访问 maven 存储库？我确实在私有 maven 存储库[http://wiki.cloudbees.com/bin/view/DEV/CloudBees+Private+Maven+Repository](http://wiki.cloudbees.com/bin/view/DEV/CloudBees+Private+Maven+Repository)上找到了一个 wiki 条目，但它明确指出，只有连接到 cloudbees 帐户的用户才能访问maven 存储库.

查看[https://github.com/arey/hibernate-hydrate](https://github.com/arey/hibernate-hydrate)上由 Dev@Cloud 构建然后部署到 cloudbees maven repo 的项目描述，似乎是可能的。就我而言，每次输入时都会`https://repository-<cloudbees-account>.forge.cloudbees.com`提示我输入密码。谁可以帮我这个事？假设我有 2 个 cloudbees 帐户：A 和 B，是否可以为帐户 A 提供可公开访问的 maven 存储库，同时为帐户 B 提供受密码保护的存储库？

更新：我终于明白了，在存储库页面上，您可以定义存储库之一（svn/git/maven repo）是公开还是帐户访问

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T18:34:37.383

因此，关于 Jesse 的建议，我发布了对我自己的问题的回复：在 cloudbees 存储库页面上，您可以定义是否可以访问（以只读模式）给存储库（maven、svn、git 类型）以供公共访问。最初，我被 cloudbees 使用的“maven 私有存储库”名称所迷惑——它确实是私有的（专门为您的 cloudbees 帐户定义），但它可以公开访问。

# plsql - oracle 10g pl/sql 有条件的循环选择

> ID：13388450
> 
> 赞同：2
> 
> 时间：2012-11-14T22:25:05.757
> 
> 标签：plsql, oracle10g

有可能在 10g 的 PL/SQL 中做这样的事情吗？

```
if user_is_goat = 1 then
  for item_rec in (select * from pricing_for_goats)
else 
  for item_rec in (select * from pricing_for_non_goats)
end if;
loop
.
.
end loop; 
```

似乎当 oracle 看到“for rec in select * from dual”时，它期望“循环”立即跟随。我在循环中的代码有很多行，我不想维护它的 2 个副本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T22:28:44.943

尝试下面的查询，这将检查是否变量`user_is_goat = 1`并返回数据，`for_goats`否则它将返回`for_non_goats`

```
for item_rec in 
(
  select * from pricing_for_goats where user_is_goat = 1
  union
  select * from pricing_for_non_goats where user_is_goat <> 1
)
loop
.....
.....
end loop; 
```

# android - 安装后 OpenCV Android 库错误

> ID：13388458
> 
> 赞同：5
> 
> 时间：2012-11-14T22:26:00.533
> 
> 标签：android, opencv

我使用 Win 8、jdk7、Eclipse 4.2、Andoird SDK (ADT) Rev 21、OpenCV 2.4.3、C/C++ Dev。工具 8.1.1。自 API 级别 8 以来，已安装所有 Android Target SDK。如下所述： [http ://docs.opencv.org/doc/tutorials/introduction/android_binary_package/O4A_SDK.html](http://docs.opencv.org/doc/tutorials/introduction/android_binary_package/O4A_SDK.html)

导入库和示例项目后，我在 File OpenCVEngineInterface 中收到以下错误。mac 操作系统也是如此。

```
Description Resource    Path    Location    Type 
The method asBinder() of type OpenCVEngineInterface.Stub must override a superclass method  OpenCVEngineInterface.java  /OpenCV Library -
2.4.3/gen/org/opencv/engine line 35 Java Problem 
The method asBinder() of type OpenCVEngineInterface.Stub.Proxy must override a superclass method    OpenCVEngineInterface.java  /OpenCV Library -
            2.4.3/gen/org/opencv/engine line 96 Java Problem 
The method getEngineVersion() of type OpenCVEngineInterface.Stub.Proxy must override a superclass method    OpenCVEngineInterface.java  /OpenCV Library - 2.4.3/gen/org/opencv/engine   line 107    Java Problem 
    The method getLibPathByVersion(String) of type OpenCVEngineInterface.Stub.Proxy must override a superclass method   OpenCVEngineInterface.java  /OpenCV Library - 2.4.3/gen/org/opencv/engine   line 129    Java Problem 
    The method installVersion(String) of type OpenCVEngineInterface.Stub.Proxy must override a superclass method    OpenCVEngineInterface.java  /OpenCV Library - 2.4.3/gen/org/opencv/engine   line 152    Java Problem 
    The method getLibraryList(String) of type OpenCVEngineInterface.Stub.Proxy must override a superclass method    OpenCVEngineInterface.java  /OpenCV Library - 2.4.3/gen/org/opencv/engine   line 175    Java Problem 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-15T19:18:25.610

具体昨天晚上，我遇到了和你一样的问题，今天我找到了解决方案。显然，或者我们的 Eclipse 有一些默认配置，或者我们从 OpenCV 获得的 Eclipse 项目是错误的。

要解决此问题，请转到 Eclipse 下的项目并：

1.  鼠标右键
2.  特性
3.  Java 编译器
4.  编译器合规级别 = 1.6

我有 Java 1.5 版，它在覆盖方法方面存在一些问题，但在 Java 1.6 中它工作正常！我希望我对你有所帮助：D

编辑：我公开的解决方案比另一个更好。您不必更改 ADT，只需更改 Java 编译器的版本，它就可以正常工作：D

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T21:22:02.820

不同版本的 ADT 插件之间的 Eclipse 项目设置看起来有些不兼容。要删除这些错误，您必须在导出到 Eclipse 之前从 /sdk/java 文件夹中删除 .settings 文件夹。感谢：Andrey Pavlenko [http://answers.opencv.org/question/4209/build-errors-after-opencv-library-import/](http://answers.opencv.org/question/4209/build-errors-after-opencv-library-import/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T21:55:52.743

这里发布了一个对我有用的解决方案......

[http://answers.opencv.org/question/4209/build-errors-after-opencv-library-import/](http://answers.opencv.org/question/4209/build-errors-after-opencv-library-import/)

在导入示例项目之前删除 OpenCV-2/sdk/java 下的 .settings 文件夹。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-29T10:29:03.907

我也遇到了这个问题。

这是我的解决方案： 1.打开 OpenCV-2.4.3-android-sdk\sdk\java.settings\org.eclipse.jdt.core.prefs 2.将 1.5 替换为 1.6

这是因为 java 编译器版本。

# javascript - 你能给我举一个“'？'之前换行不好”的例子吗？

> ID：13388462
> 
> 赞同：12
> 
> 时间：2012-11-14T22:26:52.227
> 
> 标签：javascript, jslint

我收到此错误消息，我不喜欢。

```
Bad line breaking before '?'. 
```

我觉得像

```
var s = (a === b)
        ? 'one'
        : 'two'; 
```

看起来更好。克罗克福德 说：

> 分号插入可以掩盖复制/粘贴错误。如果您总是在运算符之后换行，那么 JSLint 可以更好地发现这些错误。

有人可以给我举一两个例子，说明他所指的复制/粘贴错误吗？

**更新：**

```
var s = (a === b)
        ? 'one'
        : 'two'; 
```

看起来比

```
var s;
if(a === b) {
    s = 'one';
} else {
    s = 'two';
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-22T21:55:54.100

（根据要求，我的评论重新发布为答案：）

您展示的示例中的“明显”复制/粘贴错误将是复制第一行：

```
var s = (a === b) 
```

...当然，这本身就是有效的代码，但显然与三行一起做的事情不同。人们会希望人们在复制一行之前先查看周围的代码，但你永远不会知道。

我认为 Crockford 先生试图说明的一点是，如果您故意将多行表达式拆分为各个行本身不是有效的代码，*那么*如果您不小心只复制了表达式的一行将其粘贴到其他位置时可能会导致语法错误。这很好，因为语法错误是由浏览器和/或 JSLint/JSHint 报告的，因此比复制/粘贴单独有效的行所产生的更细微的错误更容易找到。因此，如果您像 Crockford 建议的那样“总是在运算符之后换行”：

```
var s = (a === b) ? 
        'one' : 
        'two';​ 
```

...然后三元组中唯一的有效代码行（第三行）看起来并不完整，因此如果单独粘贴会更容易发现错误，因为它显然没有自己做任何事情-出于同样的原因，它不太可能首先被自己复制。

（话虽如此，我不强调我自己代码中的三元运算符，而且我认为上面看起来很难看。我在一行上放了一个短的三元表达式，一个长的超过两行的三元表达式，中间后面有换行符操作数和 : 排列在 ? 下，或者像你的一样长的三行一列。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-14T22:33:28.933

最（不）著名的例子如下：

```
function one() {
  return
  {
    val: 1
  };
}

alert(one()); // undefined 
```

对比

```
function one() {
  return {
    val: 1
  };
}

alert(one()); // [objet Object] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-14T22:39:38.583

他所指的复制粘贴错误类型是您在 6 个月内将代码交给其他人或您自己，而其他人随意复制您的代码，以条件的结束括号结束，假设赋值意味着被评估的右侧的值。

这似乎不可信，从某种意义上说，你会希望它是......
但我知道自动插入已经多次为我的公司编写代码，现在，他们仍然没有强制采用显式分号，仍然对待JS 好像新行很重要并且仍然会由于忽略和缺乏工具/版本管理/构建系统而导致剪切/粘贴错误。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-14T22:45:01.247

假设您在之前粘贴了一个函数表达式，

```
var a = 1, b = 1; // a === b, expect 'one'
(function(){
    console.log('called');
})
(a === b)
? 'one'
: 'two'
// called
// "two" 
```

# wordpress - Safari 和 IE 没有响应菜单元素的高度

> ID：13388465
> 
> 赞同：1
> 
> 时间：2012-11-14T22:27:10.250
> 
> 标签：wordpress, internet-explorer, safari, css

我在 Jakoody.com 上工作。在 Safari（至少 5.0.5-Lion）和 IE 9 及以下版本中，浏览器会在菜单底部添加填充，从而重复背景图像并在底部显示双针。这也发生在“stitched-quote”（在滑块下）。

我现在已经搜索了几个小时，还没有找到任何有效的方法。有什么建议么？

我正在使用带有 Headway 框架的 WordPress（两个最新版本）

提前致谢！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T22:44:25.753

`.block`将`box-sizing`属性设置为**border-box**。并非所有浏览器都支持此功能。`box-sizing`对于不支持 CSS 的浏览器（可能是 Javascript？） ，您可以禁用(style.css:line 257) 并将其减小到`.block`28px或**将**of 减小`min-height`到28px **。**`#block-86`**`min-height``#block-86`**`box-sizing`****

# c# - C# WaitHandle.WaitAll() 总是在等待

> ID：13388467
> 
> 赞同：0
> 
> 时间：2012-11-14T22:27:25.703
> 
> 标签：c#

以下是我的代码，wait all 方法总是在等待。

```
 class Program
    {
        static StreamWriter _fileStream;
        static void Main(string[] args)
        {
            _fileStream = File.CreateText(@"C:\Praveen\HelloThread.txt");
            List<ManualResetEvent> meList = new List<ManualResetEvent>();
            ManualResetEvent currentEvent = new ManualResetEvent(true);
            ManualResetEvent nextEvent = new ManualResetEvent(false);
            meList.Add(currentEvent);
            int length = 10;
            Data data = null;
            Console.WriteLine("Writing started...");
            for (int i = 0; i < length; i++)
            {
                data = new Data { CurrentEvent = currentEvent, Number = i, NextEvent = nextEvent };
                ThreadPool.QueueUserWorkItem(PrintMsg, data);
                meList.Add(nextEvent);
                currentEvent = nextEvent;
                nextEvent = nextEvent = new ManualResetEvent(false);
            }

            CloseAll(meList);
            Console.ReadLine();
        }

        private static void CloseAll(List<ManualResetEvent> meList)
        {
            Console.WriteLine("Requested to close all...");
            while (WaitHandle.WaitAll(meList.ToArray()))
            {

            }

            Console.WriteLine("Done with the writing...");
        }

        private static void PrintMsg(object state)
        {

            Data data = state as Data;

            data.CurrentEvent.WaitOne();

            string msg = "Hello times...";
            for (int j = 0; j < 5; j++)
            {
                _fileStream.WriteLine(msg + data.Number);
                Console.WriteLine(msg + data.Number);
            }           
            data.NextEvent.Set();
        }
    }

    public class Data
    {
        public ManualResetEvent CurrentEvent { get; set; }
        public ManualResetEvent NextEvent { get; set; }
        public int Number { get; set; }
    } 
```

发生了什么事，为什么它总是在等待，知道吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T22:29:52.480

您的`CloseAll`方法中有一个无限循环。当所有事件都发出信号时，[WaitAll](http://msdn.microsoft.com/en-us/library/z6w25xa6%28v=vs.100%29.aspx)返回。`true`您不需要空的 while 循环，只需添加以下行：

```
WaitHandle.WaitAll(meList.ToArray()); 
```

# sql-server - SQL Server - 使用文本文件更新表

> ID：13388470
> 
> 赞同：0
> 
> 时间：2012-11-14T22:27:30.990
> 
> 标签：sql-server

我有一个存储在数据库中的表，其中包含以下示例数据：

```
 Name     City     Age
  lily   New York   NULL
  Sam    Seattle    NULL 
```

现在我需要使用包含以下数据的文本文件更新表格：

```
 Name     City     Age
  lily   New York   27
  Sam    Seattle    33 
```

文本文件没有列名。我不允许删除当前表并使用新文本文件进行批量插入。任何人都知道它的方法吗？谢谢！！！！！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T22:29:38.967

Sql Server Management Studio => 右键单击​​目标数据库 => 任务 => 导入数据

在那里你会有一个向导，你可以选择“平面文件”作为源

我不记得你是否可以在执行之前编写脚本

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T22:31:32.813

您可以使用扩展属性='text;HDR=Yes;FMT=Delimited 的 Jet-Engine 的 OLEDB-Provider 创建链接服务器

# java - 支持Java集成的缓存系统

> ID：13388471
> 
> 赞同：0
> 
> 时间：2012-11-14T22:27:34.830
> 
> 标签：java, caching, memcached, ehcache

我正在构建一个需要将数据（从解析的 JSON 对象）填充到缓存中的宁静 Web 服务。

问题）：

1.  支持 Java、Web Service (Restful) 和 tomcat 集成的最便宜（最好是开源）和最容易使用的缓存系统是什么？

2.  他们有到期政策吗？

3.  他们是否支持内存和/或文件系统持久性？

我正在寻找不需要很大学习曲线的东西。

感谢您抽出时间来阅读...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T22:42:13.857

我将把[番石榴缓存解决方案](http://code.google.com/p/guava-libraries/wiki/CachesExplained)放在桌面上：

1.  比 Memcached 和 EHCache 轻
2.  具有大小/时间/引用[驱逐策略](http://code.google.com/p/guava-libraries/wiki/CachesExplained#Eviction)
3.  只活在记忆中。如果您追求内置的持久化功能，创建者自己会在[本节](http://code.google.com/p/guava-libraries/wiki/CachesExplained#Applicability)中向您指出其他解决方案，例如 Memcached 。

最重要的是，我将通过使用构建器设计模式来添加易于使用和直观的个人经验，正如您将发现的那样。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-14T22:29:19.217

您应该使用 memcached，它支持您列出的所有三个要求。Memcached 使用内存缓存。它是开源的，非常容易学习。

# jquery - 简单：Addclass removeClass hasClass 问题？

> ID：13388476
> 
> 赞同：4
> 
> 时间：2012-11-14T22:27:54.387
> 
> 标签：jquery

我在容器 div 中有一些按钮需要切换为活动状态，但一次只有 1 个活动按钮。

编辑：

html 是： .filter(btn, btn, btn, etc) 的 div 容器有 3 个按钮容器。第三个容器有一个按钮，其 id 为：#filter1-none

下面的代码可以使每组只有 1 个按钮处于活动状态。

此外，如果任何其他按钮处于活动状态，我将如何仅从 ID 为 #filter1-none 的按钮中删除活动？

```
$('.filter .btn').click(function () {
    $(this).addClass('active').siblings('.active').removeClass('active');
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T22:30:09.000

你试过类似的东西吗？

```
$('.filter .btn').click(function () {
    $(this).closest('.filter').find('.btn.active').removeClass('active');
    $(this).addClass('active');
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T22:31:01.377

我通常会这样做：

```
$('.filter .btn').click(function () {
    $(this).addClass('active').siblings('.active').removeClass('active');
}); 
```

编辑：

这不允许“切换”行为。因此，`.btn`s 将表现得像收音机，而不是复选框。如果您正在寻找复选框类型的行为，请告诉我。

# sublimetext3 - 单个 Sublime Text 2 用户键盘映射快捷方式中的多个“命令”

> ID：13388477
> 
> 赞同：21
> 
> 时间：2012-11-14T22:27:56.333
> 
> 标签：sublimetext3, sublimetext2, sublimetext, keymapping, sublimetext4

有没有办法让多个“命令”与一个快捷方式相关联？

我有这两个快捷方式。第一个快捷方式使左侧的窗口大于右侧的窗口（在 2 列视图中），下一个快捷方式将焦点放在第一个窗口上。快速编码时，我倾向于忘记一个或另一个快捷方式。

```
{
    "keys": ["super+alt+left"],
    "command": "set_layout",
    "args":
    {
        "cols": [0.0, 0.66, 1.0],
        "rows": [0.0, 1.0],
        "cells": [[0, 0, 1, 1], [1, 0, 2, 1]]
    }
},
{ "keys": ["ctrl+alt+left"], "command": "focus_group", "args": { "group": 0 } } 
```

这个问题让我听起来像我很懒，但我想认为它是有效的。

请问有什么意见或建议吗？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2015-01-16T23:49:37.983

从*Sublime Text 4（build 4104，2021 年 5 月 3 日）*开始，您可以使用内置`chain`命令。

在旧版本（ST2 或 ST3）中，您需要安装[命令链](https://packagecontrol.io/packages/Chain%20of%20Command)插件 ( [GitHub](https://github.com/jisaacks/ChainOfCommand) )。

两者具有相同的语法，允许您编写执行多个操作的键绑定等，例如：

```
{ "keys": ["ctrl+d"],
  "context": [
    { "key": "panel_visible", "operator": "equal", "operand": true }
  ],
  "command": "chain",
  "args": {
    "commands": [
      ["hide_panel", {"cancel": true}],
      ["find_under_expand"]
    ]
  }
}, 
```

它重新定义了 Ctrl+D 以便在“查找”面板打开时关闭它，然后执行其正常操作（快速添加下一步）。

您可以执行任意数量的子命令。每个都是一个带有命令名称（例如）的数组，`"hide_panel"`后跟可选的参数（例如`{"cancel": true}`）。[可用命令及其参数](https://docs.sublimetext.io/reference/commands.html)的非官方/不完整文档可能会有所帮助。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-11-15T00:31:14.363

[Sublime Text 2 论坛](http://www.sublimetext.com/forum/viewtopic.php?f=5&t=8677)上有一篇帖子，其中包含通用“运行多个命令”插件的代码。它将允许您将多个命令绑定到任何键绑定，就像您通常将它们绑定到一个一样：

```
 {
    "keys": ["super+alt+left"],
    "command": "run_multiple_commands",
    "args": {
      "commands": [
        { "command": "set_layout", "args": { "cols": [0.0, 0.66, 1.0], "rows": [0.0, 1.0], "cells": [[0, 0, 1, 1], [1, 0, 2, 1]] } },
        { "command": "focus_group", "args": { "group": 0 } }
      ]
    }
  } 
```

请注意，这是未经测试的，**您必须安装帖子中提供的插件**才能使其正常工作。

[或者，您可以按照此答案](https://stackoverflow.com/a/10863489/1684247)中的说明为一组特定的命令创建插件。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2016-04-07T21:43:51.107

您可以录制宏（使用“工具”菜单），然后保存并设置键盘快捷键以使用

```
{"keys": ["super+alt+l"], "command": "run_macro_file", "args": {"file": "res://Packages/User/Example.sublime-macro"}} 
```

[http://docs.sublimetext.info/en/latest/extensibility/macros.html](http://docs.sublimetext.info/en/latest/extensibility/macros.html)

当然，这并不是您所要求的，但可能会为其他有类似问题的人提供相同的结果。

# c# - 为什么在 Log4Net 中命名为 logger？

> ID：13388482
> 
> 赞同：5
> 
> 时间：2012-11-14T22:28:30.433
> 
> 标签：c#, reflection, dependency-injection, castle-windsor, log4net

我一直在研究使用 Castle Windsor 将 Log4Net ILog 注入类的方法。在大多数示例中，我看到 Castle Windsor 可以在哪里提供提供属性注入的“促进者”，并注入 ILogger（而不是 ILog）。我只找到了一个使用构造函数注入的示例，并且没有使用辅助方法（请参阅[Castle Windsor 依赖注入：使用调用者类型作为参数](https://stackoverflow.com/questions/5740108/castle-windsor-dependency-injection-use-the-caller-type-as-a-parameter)）

在所有这些示例中，Log4Net 似乎都想要一个命名记录器。大多数示例参考 Log4Net 静态方法 LogManager.GetLogger(此处为类名)。这使得在不使用反射或辅助方法的情况下定义 CastleWindsor 的依赖关系成为一项挑战（可以将辅助方法与 ctor 注入一起使用吗？？？）。在查看 Ilya Kogan 提出的问题（上面的 URL ...）时，我想我不明白我为什么需要，甚至想要一个命名的记录器。我不能到处使用同名的记录器吗？

例如，我不能只注册硬编码名称为 XXX 的记录器吗？（它似乎工作正常，最后，我只想记录 - 我不在乎哪个记录器记录了它......）是否存在范围问题？是否存在内存泄漏问题？为什么记录器不能/不应该是单例？

```
public void Install(IWindsorContainer container, IConfigurationStore store)
        {
            container.Register(
                Component.For<log4net.ILog>().UsingFactoryMethod(() => log4net.LogManager.GetLogger("xxx"))
                );
        } 
```

**更新：**

经过一些研究，可以使用硬编码的命名记录器 - 例如上面我的示例中的 XXX，但是如果记录器的配置将记录器名称输出到日志文件并且记录器名称被动态分配给与方法相同的名称或类，您会自动获得对日志记录来源的引用。日志文件中的上下文非常有帮助。

在专门解决 ctor 注入时，似乎有 5 种可能的选择......

*   使用单例而不使用命名记录器（因此不在日志文件中报告）
*   将反射与 ctor 注入一起使用（如 Ilya Kogan 的示例所示）
*   使用属性注入（通过促进者）
*   使用 post-sharp AOP IL 注入进行日志记录
*   使用 CTOR 注入（通过促进者）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-14T22:41:20.160

好问题。

简而言之，log4net 需要命名记录器，因为名称用于过滤日志输出（有关详细信息，请参阅 log4net 文档）。类型名称只是一个方便的约定，因为它为您提供了额外的上下文，再加上正确使用命名空间，您可以执行诸如“将所有 NHibernate 消息记录到单独的文件”之类的操作

这也是为什么通常，如果您不为此使用容器，您的类中有一个静态记录器属性/字段。

您指的`ILogger`是Castle over logging 中的抽象，其中之一可以用于log4net。

虽然`LoggingFacility`提供`ILogger`对它的依赖的开箱即用支持绝不是强迫您这样做。

你的`ILog`注册应该改写如下（我是凭记忆写的，所以细节可能会略有不同）：

```
Component.For<log4net.ILog>()
    .UsingFactoryMethod((k, c) => log4net.LogManager.GetLogger(c.RequestedType))
    .LifestyleTransient() 
```

`c.RequestedType`将为您提供满足依赖项的类型并使其成为瞬态将避免所有类型将重用以请求依赖项的第一个类型命名的单个记录器实例的问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-14T22:31:34.877

使用 Castle Windsor DI Log4Net 日志的推荐方法是使用设施。已经为 Log4Net 创建了一个，[本教程](http://docs.castleproject.org/Default.aspx?Page=Windsor-Tutorial-Part-Five-Adding-logging-support&NS=Windsor&AspxAutoDetectCookieSupport=1)演示了它的使用。

# java - 如何在 Java 中使用模拟 Akka 演员进行正确测试？

> ID：13388483
> 
> 赞同：3
> 
> 时间：2012-11-14T22:28:36.850
> 
> 标签：java, unit-testing, mocking, akka

我对 Akka 很陌生，我正在尝试用 Java 编写一些单元测试。考虑以下演员：

```
public class Worker extends UntypedActor {

  @Override
  public void onReceive(Object message) throws Exception {

    if (message instanceof Work) {
      Work work = (Work) message;
      Result result = new Helper().processWork(work);
      getSender().tell(result, getSelf());
    } else {
      unhandled(message);
    }
  }

} 
```

拦截电话的正确方法是什么`new Helper().processWork(work)`？附带说明一下，有没有推荐的方法来使用 Java 在 Akka 演员中实现依赖注入？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-15T20:46:31.987

您的代码已经可以正确测试：

*   您可以单独测试您的业务逻辑，因为您可以实例化您`Helper`的演员外部
*   一旦你确定它`Helper`做了它应该做的事情，只需向演员发送一些输入并观察正确的回复回来

现在，如果您需要“模拟”`Worker`来测试其他组件，根本不要使用 Worker，`TestProbe`而是使用 a。你通常会得到`ActorRef`Worker 的地方，只需注入`probe.getRef()`.

那么，如何注入呢？

我假设您的其他组件是一个 Actor（因为否则您将不会遇到任何您通常使用的注入技术的问题）。然后是三个基本的选择：

1.  将其作为构造函数参数传入
2.  在消息中发送
3.  如果参与者创建 ref 作为其子项，则传入`Props`，可能在替代构造函数中

第三种情况可能是您正在查看的（我根据演员类的名称猜测）：

```
public class MyParent extends UntypedActor {
  final Props workerProps;

  public MyParent() {
    workerProps = new Props(...);
  }
  public MyParent(Props p) {
    workerProps = p;
  }

  ...
  getContext().actorOf(workerProps, "worker");
} 
```

然后你可以注入`TestProbe`这样的：

```
final TestProbe probe = new TestProbe(system);
final Props workerMock = new Props(new UntypedActorFactory() {
  public UntypedActor create() {
    return new UntypedActor() {
      @Override
      public void onReceive(Object msg) {
        probe.getRef().tell(msg, getSender());
      }
    };
  }
});
final ActorRef parent = system.actorOf(new Props(new UntypedActorFactory() {
  public UntypedActor create() {
    return new MyParent(workerMock);
  }
}), "parent"); 
```

# grid - 剑道 - 网格 - 与复杂对象聚合

> ID：13388488
> 
> 赞同：2
> 
> 时间：2012-11-14T22:28:50.753
> 
> 标签：grid, aggregate, kendo-ui, complextype

我有一个剑道 UI 网格。网格有一个包含复杂对象数据的数据源。例如，{“foo”：{“bar”：10}}。尽管列字段可以导航对象图（即 foo.bar），但聚合字段似乎不能。

这是代码：

```
var grid = $("#grid").kendoGrid({
   dataSource: {
       data: [
           {"foo": {"bar": 10}},
           {"foo": {"bar": 20}}
       ],

       aggregate: [
           {field: "foo.bar", aggregate: "sum"}
       ]  
   },
   columns: [
       {
           field: "foo.bar",
           footerTemplate: "Sum: #= sum # "
      }
  ]   
}).data("kendoGrid"); 
```

这是小提琴：http: [//jsfiddle.net/e6shF/1/](http://jsfiddle.net/e6shF/1/)

Firebug 在 kendo.all.min.js 的第 8 行报告“TypeError: data.foo is undefined”。

我做错了什么吗？如果这是剑道的一个错误，有没有办法解决这个问题？我必须保持对象复杂。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-23T20:38:29.470

这是来自 Kendo Support 的“更好”的答案：

您遇到的行为是由于您指定的“路径”将用作聚合结果创建的地图中的键。生成类似于以下内容的对象：

{“foo.bar”：{总和：30}}

不幸的是，页脚模板生成不支持此构造，因此无法正确解析。对于这种情况，一种可能的解决方法是改用函数。为了说明这一点，我修改了示例。

```
var grid = $("#grid").kendoGrid({
    dataSource: {
        data: [
            {"foo": {"bar": 10}},
            {"foo": {"bar": 20}}
        ],

        aggregate: [
            {field: "foo.bar", aggregate: "sum"}
        ]
    },
    columns: [
        {
            field: "foo.bar",
            footerTemplate: function(data) { return "Sum: " + data["foo.bar"].sum; }
        }
    ]   
}).data("kendoGrid"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T00:44:20.323

聚合中不可能有复杂的对象，因为动态生成的评估它的函数认为这`foo.bar`是字段的名称（只有一个字段）？

你真的需要那个复杂的领域吗？

我可能理解服务器（提供网格的数据）发送的复杂，`foo`但您始终可以使用数据源中的或函数将其*展平。*像这样的东西：`parse``data`

```
var grid = $("#grid").kendoGrid({
    dataSource:{
        data:[
            {"foo":{"bar":10}},
            {"foo":{"bar":20}}
        ],
        aggregate:[
            {field:"foo_bar", aggregate:"sum"}
        ],
        schema:   {
            parse:function (data) {
                var res = [];
                $.each(data, function (idx, elem) {
                    res.push({ "foo_bar":elem.foo.bar })
                });
                return res;
            }
        }
    },
    columns:   [
        {
            field:         "foo_bar",
            footerTemplate:"Sum: #= sum # "
        }
    ]
}).data("kendoGrid"); 
```

我将接收`foo.bar`到的转换`foo_bar`为聚合并将其用于聚合。

# android - 如何将 android 资源 int 转换为字符串。例如：android.R.string.cancel？

> ID：13388493
> 
> 赞同：33
> 
> 时间：2012-11-14T22:29:03.693
> 
> 标签：android, android-resources

如何从此资源 int: android.R.string.cancel 获取字符串值“cancel”？

谢谢你

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2012-11-14T22:30:43.273

只需使用[`Context#getString()`](http://developer.android.com/reference/android/content/Context.html#getString%28int%29)：

```
String string = getString(android.R.string.cancel); 
```

* * *

> 我已经尝试过这种方法但没有成功......我有一堂课：`public class MyDialogFragment extends DialogFragment {`

DialogFragment 不是 Context 的子类，因此您需要访问有效的（例如您的 Activity）。用这个：

```
String string = getActivity().getString(android.R.string.cancel); 
```

或者，正如您发现的那样，您可以使用传入的 Activity `onAttach()`，但要明白，只要您有一个有效的 Context 可以使用，您就可以在 Fragment 内的任何地方执行此操作。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-14T22:31:44.857

如此处所示：http: [//developer.android.com/reference/android/content/Context.html#getString(int)](http://developer.android.com/reference/android/content/Context.html#getString(int))

```
String s = context.getString(android.R.string.cancel); 
```

`context`可以是当前活动，也可以是任何继承`Context`抽象类的对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-02-11T12:55:44.633

我知道这是一个老问题，但它可能会帮助更多的人。您可以做的是调用 getIdentifier()。为此，您需要调用它在您想要的 this 变量的值之后插入，以生成您想要的资源 ID 字符串。举个例子：

您的资源文件：

```
R.string.cancel 
```

在java中：

```
int resourceId = getResources().getIdentifier("cancel", "string", this.getPackageName())
println(getResources().getString(resourceId)); 
```

然后，在您的 resourceId 变量中，您将拥有一个等价于：R.string.cancel。而且，在 println 中，您将拥有资源字符串的对应值。

在科特林：

```
val resourceId = this.resources.getIdentifier("cancel", "string", this.packageName)
println(resources.getString(resourceId)) 
```

和我之前说的一样的解释。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-04-25T21:37:52.240

这会将任何 Android 资源转换为字符串。在此示例中，我使用了“R.color.myColor”，但它适用于任何 Android 资源类型。

颜色.xml

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <color name="btnDialBgColor">#00BFA5</color>
    <color name="btnDialBgColorActive">#C51162</color>
</resources>

TypedValue typedValueActive = new TypedValue();
TypedValue typedValue = new TypedValue();
getResources().getValue(R.color.btnDialBgColorActive, typedValueActive, true);
getResources().getValue(R.color.btnDialBgColor, typedValue, true); 
```

希望这可以帮助。

# magento - 如何将 osCommerce 商店导入 Magento 1.7.0.2

> ID：13388494
> 
> 赞同：3
> 
> 时间：2012-11-14T22:29:07.593
> 
> 标签：magento, magento-1.7, oscommerce

我花了很长时间尝试将 osCommerce 商店导入 Magento 1.7.0.2 并希望在相关的地方记录它。

[官方迁移工具](http://www.magentocommerce.com/magento-connect/oscommerce-migration-tool.html)似乎是最好的免费选择，但它显然从未完成或经过适当测试（公平地说，它被标记为 Beta）。

它仍然有可能让它工作，有*很多*调整。我能够使用以下答案中的方法导入类别、产品、订单和客户：

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-14T22:29:07.593

[从http://www.magentocommerce.com/magento-connect/oscommerce-migration-tool.html](http://www.magentocommerce.com/magento-connect/oscommerce-migration-tool.html)安装扩展，然后在 SVN 中使用最新版本（从 1.5 主干）升级它：

```
svn co http://svn.magentocommerce.com/source/branches/1.5-trunk/app/code/core/Mage/Oscommerce/ Oscommerce 
```

然后，您应该能够按照以下说明运行导入：

*   备份您的数据库
*   将您所有的 osCommerce 产品图像复制到媒体/导入中（并使它们可由网络服务器写入）
*   非常重要：将管理界面的语言更改为英语（美国） - 否则即使成功导入也不会出现任何产品。之后可以切换回来
*   设置您的导入配置文件（从系统 > 导入/导出 > osCommerce）
*   单击左侧的运行配置文件，然后单击“检查要求”按钮
*   如果您只有一个商店/网站，则网站代码字段将为“基础”。

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T17:56:12.090

我使用[Magmi](http://sourceforge.net/apps/mediawiki/magmi/index.php?title=Main_Page)将产品、类别和图像导入到 magento。它工作得很好，而且速度非常快。
在 2 分钟内进口 6500 件产品。如果您与官方进口商合作，则需要数小时。
我喜欢通过定义数据模型的 sql 查询而不是使用 csv 文件来导入的可能性。
如果你有 utf8 字符，会有一些奇怪的效果，但如果你只有英文，你就可以了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-23T09:33:51.610

作为对 dearlbry 的回应，（但是，我无法评论缺少积分。）我想指出，作为对使用此方法的任何人的有用警告，它会在客户导入时向他们发送“订阅成功”电子邮件来自 OSCommerce。如果您不小心，这可能会非常令人沮丧，并会与客户产生一些分歧。更多信息：在此处[输入链接描述](http://www.boostingecommerce.com/importing-customers-into-magento-without-newsletter-subscription-notification)

# php - PHP5邮件（）不发送

> ID：13388497
> 
> 赞同：0
> 
> 时间：2012-11-14T22:29:22.647
> 
> 标签：php, email

使用 PHP mail() 函数时遇到问题。它根本不会发送。

我的如下：

```
//email them new password
$recipient = $actual_email; //recipient
$subject = "Reset Password"; //subject = reason for contacting
// To send HTML mail, the Content-type header must be set
$headers  = "MIME-Version: 1.0" . "\r\n";
$headers .= "Content-type: text/html; charset=iso-8859-1" . "\r\n";
$headers .= "From: Website <do-not-reply-reset@domain.co.nz>\r\n"; //headerfields
$mail_body = "
  <html>
   <head>
     <title>Reset Password</title>
   </head>
    <body>
        <h2>Reset Password</h2>
        <p>Hello $actual_email<br />
        You recently asked to reset your password.</p>
        <p>Your reset password is below:<br />
        <br />
        <b>$string</b></p>
        <br />
        <p>It is recommended you copy and paste this password into the login page, and change your password under settings, then delete this email.</p>
        <p>If you did not request this change of password, it is recommended you login and change your password immediately, and get in contact with us.</p>
        <p>Thank you,<br />
        The Team
        <br />
        NOTE:<br />
        Please do not reply to this message, which was sent from an unmonitored e-mail address. Mail sent to this address cannot be answered.</p>
     </body>
    </html>";       
//send mail
if(mail($recipient, $subject, $mail_body, $headers)){ //mail command
   header('Location: index.php?success=yes');
   exit;
} else {
   $error_message = "<div class='error'>
      <img src='http://resources.domain.co.nz/backgrounds/icon_error.png' class='messageimg' />
    <h4>Error - Recovery Error</h4>
    <p>There was an error sending a recovery password. If the problem persists, please contact us directly.</p>
   </div>"; 
} 
```

我确保 sendmail 安装在 UNIX 的默认位置，并且它在 PHP.ini 中正确引用它。

我以前使用过相同的代码，没有任何问题，所以我认为它是服务器端的东西？

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T23:56:59.563

**披露：我是 AlphaMail 背后的开发者之一**

正如WebnetMobile 所说，我还建议您停止使用PHP 内置的mail() 函数。如果您正在为 PHP 寻找一个好的 SMTP 客户端，我宁愿建议您使用[SwiftMailer](http://swiftmailer.org/)或[PHPMailer](http://code.google.com/a/apache-extras.org/p/phpmailer/)，它们可以更好地完成工作！（更简洁的代码和更容易处理错误）。

但请记住，这只是来自客户端，它不能保证您的电子邮件一旦“发送”就送达。因此，我建议您使用事务性电子邮件服务，例如：

*   [阿尔法邮件](http://comfirm.se/alpha-mail/)
*   山魈
*   邮筒

**为什么？**

*   您不必过多考虑电子邮件传递。
*   统计数据。让您跟踪总发送/点击/打开/退回。
*   通常基于 Web 服务而不是 SMTP。即更容易处理。
*   更简洁的代码（至少如果您使用 AlphaMail 将数据与表示分离）。
*   可扩展且面向未来。

如果您选择使用 AlphaMail，您可以使用[AlphaMail PHP-client](https://github.com/comfirm/alphamail-php5-client)。

**例子：**

```
include_once("comfirm.alphamail.client/emailservice.class.php");

$email_service = AlphaMailEmailService::create()
    ->setServiceUrl("http://api.amail.io/v1")
    ->setApiToken("YOUR-ACCOUNT-API-TOKEN-HERE");

$person = new stdClass();
$person->userId = "1234";
$person->firstName = "John";
$person->lastName = "Doe";
$person->dateOfBirth = 1975;

$response = $email_service->queue(EmailMessagePayload::create()
    ->setProjectId(12345) // Your AlphaMail project (determines template, options, etc)
    ->setSender(new EmailContact("Sender Company Name", "from@example.com"))
    ->setReceiver(new EmailContact("Joe Doe", "to@example.org"))
    ->setBodyObject($person) // Any serializable object
); 
```

AlphaMail 的另一个优点是您可以直接在[AlphaMail Dashboard](http://amail.io/login.php)中编辑您的模板，并且您可以使用[Comlang 模板语言](http://docs.amail.io/?section=comlang)来格式化您的电子邮件。

```
<html>
    <body>
        <b>Name:</b> <# payload.firstName " " payload.lastName #><br>
        <b>Date of Birth:</b> <# payload.dateOfBirth #><br>

        <# if (payload.userId != null) { #>
            <a href="/sign-up">Sign Up Free!</a>
        <# } else { #>
            <a href="/login?id=<# payload.userId #>">Sign In</a>
        <# } #>
    </body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T22:27:07.467

原来 SELinux 必须**关闭**邮件才能工作。

一旦它关闭，机器重新启动 mail() 工作没有任何问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-20T11:00:39.150

代码对我来说看起来不错，它应该与服务器有关。如果您认为服务器设置正确，则可能是由 selinux 引起的。请从外壳检查：

```
getsebool -a | grep mail 
```

如果你得到一个像

```
allow_postfix_local_write_mail_spool --> off 
```

比你发现问题。

要么禁用它，要么使用以下命令允许从 httpd 发送邮件：

```
setsebool -P httpd_can_sendmail on 
```

如果这不能解决您的问题，请从日志中发布错误消息。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-11-15T12:04:41.897

检查发送邮件是否在您的 Linux 服务器上正确配置，然后相应地更改 PHP.INI 中的设置。

# jquery - IE9 中的 jQuery 属性选择器

> ID：13388498
> 
> 赞同：0
> 
> 时间：2012-11-14T22:29:36.117
> 
> 标签：jquery, jquery-selectors, attributes

这在 IE9 中返回 undefined 但在所有其他现代浏览器中都可以正常工作。

```
var new_src = $("img[alt=\"" + value + "\"]").attr('src'); 
```

如何使它适用于所有 IE？

谢谢！

# c# - 为什么 XmlNodeReader 会读入 XML 中的结束标记？

> ID：13388499
> 
> 赞同：0
> 
> 时间：2012-11-14T22:29:37.790
> 
> 标签：c#, xml

我在 xml 文件中有以下内容：

```
<MyTag>Inner Text</MyTag> 
```

在我的代码中，我有以下内容来读取 xml 文件：

```
XmlNodeReader nodeReader = new XmlNodeReader(myXmlDoc);
while (nodeReader.Read());
{
    string temp = nodeReader.Name;
} 
```

在成功读取`<MyTag>`xml 后，它会读取一个空白，然后移动到下一个标签。这是为什么？

编辑：

我还注意到第一个元素正确读取，但是，第二个元素的内部文本没有通过。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T05:29:54.443

请注意，您的循环是一个空循环，因为您有 ';' 在 while 行上意味着您将阅读器移动到最后而不阅读任何内容。去除那个 ';' 你应该有更好的结果。这是一个例子：

```
 static void Main(string[] args)
    {
        XmlDocument myXmlDoc = new XmlDocument();
        myXmlDoc.LoadXml("<MyTag>Inner Text</MyTag>");

        XmlNodeReader nodeReader = new XmlNodeReader(myXmlDoc);
        while (nodeReader.Read())
        {
            Console.WriteLine(
                "Node Type : {0}, Node Name: {1}, Node Value {2}", 
                nodeReader.NodeType, 
                nodeReader.Name, 
                nodeReader.Value);
        }

    } 
```

结果；

```
Node Type : Element, Node Name: MyTag, Node Value
Node Type : Text, Node Name: , Node Value Inner Text
Node Type : EndElement, Node Name: MyTag, Node Value 
```

按任意键继续 。. .

请注意，对于文本节点，名称为空，因为只有元素和属性有名称。

# asp.net - asp.net 如何从 iframe 访问路由数据

> ID：13388511
> 
> 赞同：0
> 
> 时间：2012-11-14T22:30:26.517
> 
> 标签：asp.net, iframe, image-uploading

我有一个基本的 asp.net 页面，其中包含通过 iframe 加载的图像上传：

```
 <asp:Panel runat="server">
        <asp:TextBox runat="server" id="imgCaption" CssClass="imgCaption" PlaceHolder="caption(optional)" />

        <asp:FileUpload runat="server" ID="programmImages" Width="200px" CssClass="offScreen" />

        <asp:Button runat="server" id="hiddenImageUpload" OnClick="UploadImage" CssClass="insButton" Text="Upload" />
   </asp:Panel> 
```

图片上传取决于要上传的路线数据，但每当我尝试上传图片时，我都会收到此错误：

> 你调用的对象是空的

在这条线上：

```
var ProgName = Page.RouteData.Values["prog"].ToString(); 
```

此行在其他页面中运行良好。

那么如何通过 iframe 检索路线数据。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T09:52:24.183

我发现了这个问题，iframe 是一个单独的页面，而不是它所在的页面，所以我必须将数据作为查询字符串传递，它工作正常。

# jquery - 如何在 $.ajax 中嵌入 $.post

> ID：13388513
> 
> 赞同：1
> 
> 时间：2012-11-14T22:30:30.700
> 
> 标签：jquery, google-maps-api-3, dom-events

我正在尝试使用函数将 a 嵌入到调用中，`$.post`但是当数据发送到我的回调函数时出现以下错误：`$.ajax``setTimeout`

> TypeError: data.sector is undefined
> for (var i = 0, len = data.sector.length; i < len; i++) {

任何帮助都是解决方案，非常感谢。

阿贾克斯的东西：

```
 var browserUTC = new Date().getTime();
        var test = Math.floor(browserUTC / 1000);
        //document.write(test);

        $.ajax({
            type : 'POST',
            url  : 'php_scripts/currentFile.php',
            dataType : 'json',
            data     : { "func" : "getFirstAndNext", epochTime : browserUTC, "func" : "getUpdateAndInterval" },
            success  : function( data ) {

            data1 = JSON.parse(data.first);
            next = JSON.parse(data.next);
            sector_callback( data1 );

            console.log(data.interval);
            console.log(data.update);

            setTimeout(function () {

                // ajax to retreive new file
                $.post ('php_scripts/newFile.php',
                {
                    epochTime : data.next,
                    dataType : 'json',
                    data : { "func" : "getNext", epochTime : data.next },
                }),
                removeSectors();
                next = JSON.parse(data.next);
                console.log('hello');
                console.log(next);
                sector_callback( next );
                //console.log('worked');

                console.log("Ding!",Date()); // This is where I will load first JSON file
                setInterval(function () { console.log("Dong!",Date()); }, data.interval * 60 * 1000); 
            }, data.update);    

            },
            error : function ( XMLHttpRequest, textStatus, errorThrown ) {
            }
        }); 
```

打回来：

```
 var allPolygons = [];
    function sector_callback(data) {
        //console.log(data);
        var bounds = new google.maps.LatLngBounds();        
        for (var i = 0, len = data.sector.length; i < len; i++) {
            coords = data.sector[i].geometry.coordinates[0];
            siteNames = data.sector[i].properties.Name; // added for site names
            health = data.sector[i].properties.Health;
            calls = data.sector[i].properties.Calls;
            drops = data.sector[i].properties.Drops;
            blocks = data.sector[i].properties.Blocks;
            TCCFs = data.sector[i].properties.TCCFs;
            dcr = data.sector[i].properties.DCR;
            TCCFpct = data.sector[i].properties.TCCFpct;
            path = [];
        for ( var j = 0, len2 = coords.length; j < len2; j++ ){ // pull out each     set of coords and create a map object
            var pt = new google.maps.LatLng(coords[j][1], coords[j][0])
            bounds.extend(pt);
            path.push(pt);

        }

        if ( health == 1 ) 
        {
            var polygons = new google.maps.Polygon({
            path: path,
                strokeColor: "#000000",
                strokeOpacity: 0.8,
                strokeWeight: 1,
                fillColor: "#FF0000",
                fillOpacity: 0.35,
            map: map
            });
        } else {
            var polygons = new google.maps.Polygon({
            path: path,
                strokeColor: "#000000",
                strokeOpacity: 0.8,
                strokeWeight: 1,
                fillColor: "#000000",
                fillOpacity: 0.35,
            map: map
            });
        }   
        createClickablePoly(polygons, "Site: " + siteNames + "</br>" + "Total_calls " + calls + "</br>" + "Total_drops " + drops 
            + "</br>" + "Total_blocks " + blocks + "</br>" + "Total_TCCF " + TCCFs + "</br>" + "DCR " + dcr + "</br>" + "TCCFR " + TCCFpct);

        google.maps.event.addListener(polygons, 'mouseover', function() {
        var currentPolygon = this;
        currentPolygon.setOptions({ 
            fillOpacity: 0.45,
            fillColor: "#FF0000"
            })
        });

        if ( health == 1 ) 
        {
            google.maps.event.addListener(polygons, 'mouseout', function() {
            var currentPolygon = this;
            currentPolygon.setOptions({ 
                fillOpacity: 0.35,
                fillColor: "#FF0000"
                })
            });
        } else {
            google.maps.event.addListener(polygons, 'mouseout', function() {
            var currentPolygon = this;
            currentPolygon.setOptions({ 
                fillOpacity: 0.35,
                fillColor: "#000000"
                })
            });
        }   

        allPolygons.push(polygons);
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T22:37:07.573

可能当调用 set_timeout 时，调用 $.ajax 的底层函数已经终止，因此变量“数据”被删除？$.ajax() 是一个异步函数...

例子：

```
function test() {
    var bla = 'test';
    $.ajax({
        // config
        success  : function( data ) {
            alert(bla); // should be 'undefined';
        }
    });
} 
```

可能的解决方案：

1.  要么使变量成为全局变量（始终有效），要么
2.  如果在 success: 函数中声明了变量，则将其传递给 set_timeout 函数。如果没有，请通过它。

老实说，我不知道这个的第二次调用是什么变量

```
next = JSON.parse(data.next); 
```

指。因为，正如您在帖子的评论中所写，我相信您在上面 2 行有语法错误。

# cakephp - CakePHP：控制器中的自定义查询：如何检查是否成功？

> ID：13388516
> 
> 赞同：0
> 
> 时间：2012-11-14T22:30:42.050
> 
> 标签：cakephp

我正在使用自定义查询手动更新我的数据库，如下所示：

```
$this->Model->query("UPDATE table SET attribute='1' WHERE condition='".
$variable); 
```

一切都很好，工作正常。但是如何检查结果（在这种情况下是更新）是否成功？

我需要检查它是否成功，所以我可以在它之后重定向，并向用户发布一条消息。

查询执行后返回真还是假？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T03:21:24.270

根据[文档](http://book.cakephp.org/2.0/en/models/retrieving-your-data.html#model-query)，`query`返回：

> 指示成功/失败的数组或**布尔值，**具体取决于执行的查询

使用您自己的代码进行测试或在文档中查找大约需要 4 秒。

# php - Sql 按浏览器分组，例如

> ID：13388521
> 
> 赞同：0
> 
> 时间：2012-11-14T22:31:03.630
> 
> 标签：php, sql

嗨，我得到了关于用户浏览器的数据库日志，它显示 f.ex：Firefox 6.0.2、Firefox 6.0.0 Chrome 14.0.835.163 和其他版本....等等

这都是关于浏览器版本的。我的问题是可以在浏览器名称为-> firefox（所有版本）、chrome（所有版本）的地方做sql问题。我需要计算它们现在我得到了这样的东西：

```
SELECT `logs`.`log_browser`, COUNT(*) AS `amount` 
FROM `logs` GROUP BY `log_browser` 
```

但它以不同的行返回 Firefox 6.0.2 和 Firefox 6.0.0 可能吗？还是我必须在 php 中使用结果？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T22:36:46.053

你可以这样做

[SQL 小提琴](http://sqlfiddle.com/#!2/c85db/2)

```
select REPLACE(log_browser, substring_index(log_browser,' ',-1),'') log_browser, 
count(*) cnt
from logs group by log_browser; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T22:35:50.103

这样的事情怎么样？这用于`LOCATE`查找第一个空格，并将分组并返回浏览器名称的左侧部分。

```
SELECT LEFT(log_browser, LOCATE(' ', log_browser)) AS browser, COUNT(*) AS amount
FROM logs
GROUP BY LEFT(log_browser, LOCATE(' ', log_browser)) 
```

## [看到它在行动](http://sqlfiddle.com/#!2/7548f/1)

**架构**

```
创建表日志（
  log_browser varchar(25));

插入日志值
('Firefox 6.0.2'),
('Firefox 6.0.0'),
('Chrome 14.0.835.163')
```

**结果**

```
| 浏览器 | 数量 |
---------------------
| 铬 | 1 |
| 火狐 | 2 |
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T23:06:13.487

如果执行速度不是问题，那么之前给出的（由其他人 - 但已删除）答案的扩展版本将很有用。您可以添加任何其他浏览器名称并使用 OR 对不同的语法进行分组

```
SELECT CASE 
WHEN `log_browser` like '%Firefox%' Then 'FIREFOX'
WHEN `log_browser` like '%Chrome%%' Then 'CHROME'
WHEN `log_browser` like '%Explorer%' Then 'INTERNET EXPLORER'
WHEN `log_browser` like '%Opera%%' Then 'OPERA'
ELSE LEFT(log_browser,10) 
END Browser, count(*) from logs
group by 
CASE 
WHEN `log_browser` like '%Firefox%' Then 'FIREFOX'
WHEN `log_browser` like '%Chrome%%' Then 'CHROME'
WHEN `log_browser` like '%Explorer%' Then 'INTERNET EXPLORER'
WHEN `log_browser` like '%Opera%%' Then 'OPERA'
ELSE LEFT(log_browser,10) 
END 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-11-14T22:45:28.763

您可能希望在 group by 子句中使用 substring 函数，假设浏览器最多以 n 个字符标识自己，例如 chrome 是 6 个字母，您可以这样做：

```
SELECT `logs`.`log_browser`, COUNT(*) AS `amount` 
FROM `logs` GROUP BY SUBSTRING(`log_browser`,1,6) 
```

# mysql - 将不同的数据库复制到不同的从站

> ID：13388522
> 
> 赞同：1
> 
> 时间：2012-11-14T22:31:12.580
> 
> 标签：mysql, database, replication, privileges

我需要复制一些数据库，如下所示。

```
 -DB1---replicate to---> SLAVE_A
        /
MASTER <--DB2---replicate to---> SLAVE_B
        \
         -DB3---replicate to---> SLAVE_C 
```

如果我同时控制主服务器和所有从服务器，[此处](http://dev.mysql.com/doc/refman/5.1/en/replication-solutions-partitioning.html)描述的过程将运行良好，但不幸的是，在这种情况下我只控制主服务器。奴隶可能在不同的国家，由其他管理员管理。

我担心的是 SLAVE_A 上的配置可以很容易地更改为不仅复制预期的 DB1，而且复制 DB2 和 DB3，这是不好的。

我限制哪个从属复制哪个数据库的唯一希望是，如果我能以某种方式从主控控制它，据我所知，这是无法做到的。一个用户要么拥有所有数据库的复制权限，要么没有，这是不幸的。

我在这里遗漏了什么，或者这只是 MySQL 的一个限制？关于如何实现这一点的任何想法？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-02-10T13:53:20.087

在从服务器上，可以通过**replicate-do-db**或**replicate-ignore-db**参数过滤要应用的事务，这些参数包含在my.cnf 文件中或作为选项在命令行中。使用 binlog-do-db 或 binlog-ignore-db 可以在 master 上完成相同的操作，但是 - 它限制了 master 上某些特定数据库的复制。因此，对您而言，更好的解决方案是过滤从属设备上的事务。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-14T22:38:37.647

为每个复制从属创建不同的 MySQL 用户，并仅授予该用户对您希望其具有复制访问权限的数据库的访问权限。

您可以在 MySQL 文档中阅读更多内容：[16.1.1.3。为复制创建用户](http://dev.mysql.com/doc/refman/5.6/en/replication-howto-repuser.html)

```
CREATE USER 'slave_a'@'some_slave_server' IDENTIFIED BY 'slavepass';
GRANT REPLICATION SLAVE ON `DB1`.* TO 'slave_a'@'some_slave_server';
FLUSH PRIVILEGES; 
```

然后分别对 DB 2 和 3 上的从站 B 和 C 重复此操作。

# visual-studio-2012 - 如何从 Visual Studio 连接到 SQL 数据库/打开 .mdf 文件

> ID：13388523
> 
> 赞同：2
> 
> 时间：2012-11-14T22:31:18.500
> 
> 标签：visual-studio-2012, database-connection

如果我复制由 SQL Server Management Studio 创建的 .mdf 文件并将其放在 app_data 文件夹中，我会收到此错误：

“此数据库文件与 SQL Server 的当前实例不兼容。

要解决此问题，您必须通过创建新的数据连接来升级数据库文件，或者您必须修改与此数据库文件的现有连接。

有关详细信息，请参阅[http://go.microsoft.com/fwlink/?LinkId=235986](http://go.microsoft.com/fwlink/?LinkId=235986) "

如果我尝试使用 Visual Studio 向导添加连接，选择 Microsoft SQL Server 数据库文件并选择该文件，我会收到此错误：

" 无法打开物理文件 "path" {访问被拒绝) 尝试附加一个自动命名的文件 "path" 存在同名数据库，或者指定的文件无法打开，或者它位于 UNC 共享上"

如果我尝试在选择数据源窗口中选择“Microsoft SQL 服务器”选项添加连接：

“建立与 SQL 服务器的连接时发生网络相关或特定于实例的错误。未找到服务器或无法访问服务器。验证实例名称是否正确以及 SQL 配置为允许远程连接...”

我想将 Visual Studio 连接到数据库的唯一原因是因为 VS 不允许我导入文本文件。我已从 SQL Server Management Studio 将文本文件导入数据库，我想将其连接到 VS。我已经在 Windows 7 中关闭了 UAC，并且我对 mdf 文件具有文件权限。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-09-01T08:53:20.420

老问题，但只是为来自 Google 的访问者提供答案，该问题与文件系统访问无关（尽管管理员帐户应该对包含 mdf 和日志文件的文件夹具有完全权限）。解决方案是需要使用“以管理员身份运行”打开 SQL Management Studio。提升的权限将允许 SQL Server（或 SQLExpress）附加较旧的 mdf 文件并对其进行更新。附加 db 后，您可以通过 Add New Item->Data->ADO.NET Entity Data Model 向导添加数据库连接，在 Visual Studio 中访问它。

# asp.net-mvc - 最佳实践——如何从控制器工厂取回内部绑定？

> ID：13388524
> 
> 赞同：0
> 
> 时间：2012-11-14T22:31:25.083
> 
> 标签：asp.net-mvc, binding, dependency-injection, ninject

我正在关注 Steven Sanderson 和 Adam Freeman 的“ASP.Net MVC 3”，他们曾一度定义`ControllerFactory`. 暴露的接口用于创建控制器，注入其中的（如提供数据的类）是黑盒（用于外部世界）。

我在这一点上，我真的不想获得任何控制器，而是控制器的绑定集——即提供数据的类。

我可以为控制器工厂添加另一种方法（如`GetBinding`），它会起作用，但这是*正确*的方法吗？

* * *

只是为了专注于某事。我有`IDataProvider`两个课程——`MockupProvider`和`ProviderForReal`。我想设置一次，现在只要我需要`IDataProvider`我就会得到`MockupProvider`。这是（由我）在控制器工厂中设置的。

而且我想以最*优雅*的方式检索我设置的内容，因此我不会再次绑定接口类。将这种方法添加`GetBinding`到控制器因素中是一种好的模式吗？

*我不是在构建控制器，我需要绑定控制器使用。*

* * *

## 换句话说...

有控制器厂。里面定义了一些绑定。我必须使用检索它们（绑定，而不是控制器）。从技术上讲，我可以通过多种方式做到这一点：

*   查看代码，查看特定绑定，然后在其他地方使用绑定类型（硬编码）

*   将公共方法添加到控制器工厂`GetBinding`

*   ...？

什么是正确的方法？

* * *

## 更新

我的控制器工厂：

```
public class NinjectControllerFactory : DefaultControllerFactory
{
    private IKernel ninject_kernel;

    public NinjectControllerFactory()
    {
        ninject_kernel = new StandardKernel();
        AddBindings();
    }

    private void AddBindings()
    {
        ninject_kernel.Bind<IBookRepository>().To<DataManagement.Concrete.EFBookRepository>();
        // ninject_kernel.Bind<IBookRepository>().ToConstant(DataManagement.Mocks.Mocks.BookRepository);
    }

    public T GetBinding<T>()
    {
        return ninject_kernel.Get<T>();
    }

    protected override IController GetControllerInstance(System.Web.Routing.RequestContext requestContext, Type controllerType)
    {
        if (controllerType == null)
            return null;
        else
            return (IController)ninject_kernel.Get(controllerType);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T23:55:41.143

*我正在尝试根据评论回答您的问题。如果它不适合你，我准备删除它。*

因此，在我的 ASP.NET MVC 应用程序中，我使用 ninject 及其 mvc 扩展将依赖项注入到我的控制器（以及底层服务和存储库）。

**全球.asax**

```
public class MvcApplication : Ninject.Web.Mvc.NinjectHttpApplication
{
        /// this is here only to see that NinjectHttpApplication uses its own ControllerFactory, which is supposed to create your controllers with dependencies injected
        protected override Ninject.Web.Mvc.NinjectControllerFactory CreateControllerFactory()
        {
            return base.CreateControllerFactory();
        }

        protected override IKernel CreateKernel()
        {
            var kernel = new StandardKernel();
            // here you can configure your bindings according to actual requirements 
            kernel.Bind<IDataProvider>().To<ProviderForReal>().InRequestScope(); 
            kernel.Bind<IDataService>().To<RealDataService().InRequestScope();                
            return kernel;
        }
} 
```

**控制器**

```
public class MyController : Controller
{
    private readonly IDataProvider dataService;
    // i will get injected an IDataProvider according to my actual configuration
    public MyController(IDataService dataService)
    {
          this.dataService = dataService;
    }
} 
```

**数据服务**

```
public class RealDataService: IDataService{
     private readonly IDataProvider dataProvider;
     public RealDataService(IDataProvider dataProvider){
         this.dataProvider = dataProvider;
     } 
} 
```

***更新***

您不需要编写自己的控制器工厂。在上面的代码中，我将我的`CreateControllerFactory`方法覆盖只是为了显示`Ninject.Web.Mvc.NinjectHttpApplication`隐式覆盖此方法并使用它自己的`NinjectControllerFactory`实现来为您解决依赖关系（即使该依赖关系是间接的 - 正如您在我更新的代码中看到的那样 => Ninject 将为您解决它，因为它会看到`MyController`需要`IDataService`并会查看绑定并将看到绑定到`RealDataService`，但它只有依赖于的构造函数`IDataProvider`。所以它会再次查看绑定并且会看到`IDataProvider`绑定到`ProviderForReal`而不是创建`ProviderForReal`将其注入到`ReadDataService`RealDataService 到`MyController`）。

# html - 在同一行上获取 Twitter 推文和 Facebook 喜欢

> ID：13388530
> 
> 赞同：0
> 
> 时间：2012-11-14T22:32:12.380
> 
> 标签：html, css, facebook, twitter

我无法将 Twitter 推文和 Facebook 喜欢放在同一条线上。目前，Facebook Likes 比 Twitter Tweets 低几个像素。我将如何纠正这一点？

我尝试向 Twitter 添加一种样式以将边距降低几个像素，但这也使 Facebook 向下移动。我还尝试向 Facebook 添加负边距，但没有任何效果。

我想指出，我没有以任何方式使用 CSS 修改 Twitter/Facebook 按钮，因为我所有的尝试都失败了。

```
.social {
    clear: both;
    padding: 10px 36px 20px 36px; 
}

<div class="social">
    <a class="twitter-share-button" data-url="http://www.google.com/" href="https://twitter.com/share" data-lang="en"></a>
    <div class="fb-like" data-href="http://www.google.com/" data-send="false" data-width="90" data-show-faces="false" data-layout="button_count"></div> 
</div>

/**** Twitter plugin ****/
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

/**** Facebook plugin ****/
<script>(function(d, s, id) { var js, fjs = d.getElementsByTagName(s)[0]; if (d.getElementById(id)) return; js = d.createElement(s); js.id = id; js.src = "//connect.facebook.net/en_US/all.js#xfbml=1"; fjs.parentNode.insertBefore(js, fjs); }(document, 'script', 'facebook-jssdk'));</script> 
```

是）我有的：

![在此处输入图像描述](../Images/ec949dd578cda444fbb13f7db6cd5177.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T23:03:43.840

为了解决这个问题，我添加`float:left;`了 Twitter 和 Facebook 的代码行。

# java - 删除 StyledDocument 的一部分先进后出并保持布局

> ID：13388532
> 
> 赞同：1
> 
> 时间：2012-11-14T22:32:24.113
> 
> 标签：java, layout, jtextpane, styleddocument

虽然有相当多的空闲时间可以使用，但我遇到了一个关于作为 JTextPane 一部分的 StyledDocument 的问题。当文档的总大小达到 x 值（在我的情况下为 10.000）时，我想删除文本的第一部分。但是由于保留布局很重要，让我先向您展示图像中发生的情况，然后我将发布源代码。

在图 1 中：当尚未达到最大长度时，我没有水平滚动条

在图 2 中：当达到 10.000 个字符的最大长度时，使用 styleddoc.getDocument().remove(0, maxsize) 裁剪 StyledDocument；

[http://i.stack.imgur.com/i10KZ.png](http://i.stack.imgur.com/i10KZ.png) [图 1]

[http://i.stack.imgur.com/dUZ0K.png](http://i.stack.imgur.com/dUZ0K.png) [图 2]

（非常抱歉，因为这是我在这里的第一个问题，所以我不允许发布图片作为垃圾邮件拒绝措施）

如您所见，horizo​​ntar 滚动条突然出现，我的布局完全混乱，并且在任何情况下，文本不适合时会整齐地分成几行，就像它在删除之前所做的那样。

现在，这是我的来源。请帮助我找到解决此问题的天才解决方案。

```
public void publicTextPaneOutput(String sender, String receiver, int type, String message) {
    int messagesize = 0;
    StyledDocument styledDocument = (StyledDocument) publicText.getDocument();
    Style defaultStyle = styledDocument.addStyle("Default Text", null);
    Style nicknameStyle = styledDocument.addStyle("Personal Nickname", null);
    StyleConstants.setBold(nicknameStyle, true);
    StyleConstants.setForeground(nicknameStyle, Color.decode("#006400"));
    Style chatterStyle = styledDocument.addStyle("Other Nickname", null);
    StyleConstants.setBold(chatterStyle, true);
    StyleConstants.setForeground(chatterStyle, Color.blue);

    switch (type) {
        case 1: {
            messagesize += sender.length() + message.length() + 3;
            publicTextPaneOverflowProtection(styledDocument, messagesize);
            try {
                if (sender.equals(nickname)) {
                    styledDocument.insertString(styledDocument.getLength(), (new StringBuilder()).append(sender).toString(), nicknameStyle);
                } else {
                    styledDocument.insertString(styledDocument.getLength(), (new StringBuilder()).append(sender).toString(), chatterStyle);
                }
                styledDocument.insertString(styledDocument.getLength(), ": ", chatterStyle);
                styledDocument.insertString(styledDocument.getLength(), message, defaultStyle);
                styledDocument.insertString(styledDocument.getLength(), "\n", defaultStyle);
            } catch (BadLocationException e) {
                e.printStackTrace();
            }
            break;
        }
        case 2: {
            messagesize += sender.length() + receiver.length() + message.length() + 7;
            publicTextPaneOverflowProtection(styledDocument, messagesize);
            try {
                if (sender.equals(nickname)) {
                    styledDocument.insertString(styledDocument.getLength(), (new StringBuilder()).append(sender).toString(), nicknameStyle);
                } else {
                    styledDocument.insertString(styledDocument.getLength(), (new StringBuilder()).append(sender).toString(), chatterStyle);
                }
                styledDocument.insertString(styledDocument.getLength(), (new StringBuilder()).append(" -> ").toString(), chatterStyle);
                if (receiver.equals(nickname)) {
                    styledDocument.insertString(styledDocument.getLength(), (new StringBuilder()).append(receiver).toString(), nicknameStyle);
                } else {
                    styledDocument.insertString(styledDocument.getLength(), (new StringBuilder()).append(receiver).toString(), chatterStyle);
                }
                styledDocument.insertString(styledDocument.getLength(), (new StringBuilder()).append(": ").toString(), chatterStyle);
                styledDocument.insertString(styledDocument.getLength(), message, defaultStyle);
                styledDocument.insertString(styledDocument.getLength(), "\n", defaultStyle);

            } catch (BadLocationException e) {
                e.printStackTrace();
            }
            break;
        }
    }
    scroll();
}

private void publicTextPaneOverflowProtection (StyledDocument styledDocument, int messagesize)
{
    if(styledDocument.getLength() + messagesize > 10000) {
        try {
            styledDocument.remove(0, messagesize);
        } catch (BadLocationException e) {

        }
    }

}

public void scroll() {
    StyledDocument styleddocument = (StyledDocument) publicText.getDocument();
    publicText.setCaretPosition(styleddocument.getLength());
}

// this part is coded in the class itself

private JTextPane publicText;
private JScrollPane publicTextScrollPane;

//this is coded in the constructor of the class
publicText = new JTextPane();
publicTextScrollPane = new JScrollPane();

publicText.setEditable(false);
publicTextScrollPane.setViewportView(publicText); 
```

如果有人需要我项目某个部分的附加代码，请尽快告诉我

我想要的解决方案应该在 StyledDocument 的开头实现这种文本的删除，并将放置的 \n 字符保留在帐户中，即使是部分被删除。我已经尝试了几件事，甚至只使用普通的“文档”而不是样式化的，但这不是选择，因为我计划在我的聊天小程序中实现颜色和表情符号的使用。

事先感谢每一个人对此进行调查！我会尽可能跟进。

亲切的问候， 史蒂文库斯特斯

PS.：为什么我要删除 StyledDocument 的一部分？内存管理，因为这是一个聊天小程序的一部分，最多可以同时供 200 人使用，当每个人每 10 秒说一句话时，一分钟后你有 1200 条消息，这将占用大量内存这持续了 10 个小时：估计最大负载为 720.000 条消息。（最坏情况（或最好情况，取决于观点））

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-26T18:00:34.390

您的问题有很多不同的部分，但其中一部分可能很容易解决。听起来您主要关心的是如何从文档中删除行。有人已经实现了一个 DocumentListener 来为您处理这方面的问题。查看[LimitLinesDocumentListener](http://tips4java.wordpress.com/2008/10/15/limit-lines-in-document/)。该页面链接到该类的源代码，其中还包含有关如何从文档中删除行的示例。

# php - 如果数据丢失，重定向到页面

> ID：13388534
> 
> 赞同：0
> 
> 时间：2012-11-14T22:32:28.950
> 
> 标签：php, mysql

好的，所以我今天工作太久了，我被困在一些简单的事情上（我想）

```
function commonData($uid)
{
    if ($uid)
    {
            $sql = "
                    SELECT a.user_id, a.email, a.username, a.displayname, a.level_id, a.photo_id
                    FROM engine4_users AS a
                    WHERE a.user_id = ".$uid;
    }

    $UserInfo = @mysql_fetch_assoc(mysql_query($sql));

    if ($UserInfo[user_id])
    {

            if ($UserInfo[photo_id] && $UserInfo[photo_id]!="NULL")
            {
                    $PPhoto = @mysql_fetch_assoc(mysql_query("SELECT a.* FROM engine4_storage_files AS a WHERE a.file_id = ".$UserInfo[photo_id]));
                    $photo = SITE.$PPhoto[storage_path];
            }
            else $photo = NO_PHOTO; 

    $queryMoreProfile = mysql_query("SELECT * FROM engine4_user_fields_values AS a WHERE a.item_id = ".$UserInfo[user_id]);

    while ($moreProfile = @mysql_fetch_assoc($queryMoreProfile))
    {

            //$location = '';
            if ($moreProfile['field_id']==24)
            {
                    $locationNumber = $moreProfile['value'];
                    $locationsql = @mysql_fetch_assoc(mysql_query("SELECT a.* FROM engine4_user_fields_options AS a WHERE a.option_id = ".$locationNumber));

                    if (isset($locationsql['label']) && !empty($locationsql['label']))
                    {
                            $location = $locationsql['label'];
                    }
            }

            //if(empty($location))
            //{
            //      header("Location: http://www.fetishmen.net/members/edit/profile");
            //      exit;
            //}
} 
```

我想做的是说，如果`$location`没有价值（完全从数据库中丢失）重定向到一个页面。我在这里做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T22:34:19.300

数组的索引，`$moreProfile`需要`$locationsql`是变量或字符串，

```
if ($moreProfile['field_id']==24) //or $field_id
{
    $locationNumber = $moreProfile['value']; //or $value
    $locationsql = @mysql_fetch_assoc(mysql_query("SELECT a.* FROM engine4_user_fields_options AS a WHERE a.option_id = ".$locationNumber));
    $location = $locationsql['label']; //or $label 
}

if(empty($location))
{
    header("Location: http://website.com");
    exit;
} 
```

**编辑：**根据OP的评论，

```
 if ($moreProfile['field_id'] == 24 ) 
{
    $locationNumber = $moreProfile['value']; //or $value
    $locationsql = @mysql_fetch_assoc(mysql_query("SELECT a.* FROM engine4_user_fields_options AS a WHERE a.option_id = ".$locationNumber));
    $location = $locationsql['label']; //or $label 
} else if(empty($moreProfile['field_id'])) {
     header("Location: http://website.com");
     exit;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T23:16:55.520

您应该停止使用 @ 并适当地检查 mysql_result 和 mysql_fetch_assoc 是否正在返回某些内容。试试这个，看看它是否为你重定向：

```
$location = '';

if ($moreProfile['field_id']==24)
{
    $locationNumber = $moreProfile['value'];
    $locationsql = @mysql_fetch_assoc(mysql_query("SELECT a.* FROM engine4_user_fields_options AS a WHERE a.option_id = ".$locationNumber));

    if (isset($locationsql['label']) && !empty($locationsql['label'])) {
            $location = $locationsql['label'];
    }
}

if(empty($location))
{
    header("Location: http://website.com");
    exit;
} 
```

# c++ - 什么决定了两个源文件中的同名类包含哪个类定义？

> ID：13388536
> 
> 赞同：2
> 
> 时间：2012-11-14T22:32:35.853
> 
> 标签：c++, templates

如果我在一个项目中有两个源文件，每个源文件都定义了一个同名的类，那么是什么决定了使用哪个版本的类？

例如：

```
// file1.cpp:

#include <iostream>
#include "file2.h"

struct A
{
    A() : a(1) {}
    int a;
};

int main()
{
    // foo() <-- uncomment this line to draw in file2.cpp's use of class A

    A a; // <-- Which version of class A is chosen by the linker?
    std::cout << a.a << std::endl; // <-- Is "1" or "2" output?
} 
```

...

```
//file2.h:

void foo(); 
```

...

```
// file2.cpp:

#include <iostream>
#include "file2.h"

struct A
{
    A() : a(2) {}
    int a;
};

void foo()
{
    A a; // <-- Which version of class A is chosen by the linker?
    std::cout << a.a << std::endl; // <-- Is "1" or "2" output?
} 
```

我已经能够`A`使用相同的代码获得链接器选择的不同版本 - 只需更改我键入代码的顺序（沿途构建）。

诚然，在同一个名称空间中包含具有相同名称的类的不同定义是一种糟糕的编程习惯。但是，是否有定义的规则来确定链接器将选择哪个类 - 如果是，它们是什么？

作为这个问题的一个有用的附录，我想知道（通常）编译器/链接器如何处理类 - 编译器在构建每个源文件时是否将类名和编译的类定义合并到目标文件中，而链接器（在名称冲突的情况下）丢弃一组编译的类函数/成员定义？

名称冲突的问题并不神秘 - 我现在意识到它每次都会发生一个仅包含头文件的模板文件`#included`由两个或多个源文件（随后实例化相同的模板类，并调用相同的成员函数，在这些多个源文件），这是 STL 的常见场景。我认为，每个源文件都必须具有相同实例化模板类函数的单独编译版本，因此链接器必须在链接时在这些函数的不同此类编译版本中进行选择）。

-- 附有 Java 相关问题的附录 --

我注意到各种答案都表明了 C++ 的单一定义规则 ( [http://en.wikipedia.org/wiki/One_definition_rule](http://en.wikipedia.org/wiki/One_definition_rule "一种定义规则") )。顺便说一句，我是否正确地认为 Java 没有这样的规则 - 因此 Java 规范允许在 Java 中使用多个不同的定义？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T22:33:49.523

这样的程序违反了单一定义规则并表现出未定义的行为。

如果程序中有多个类或内联函数定义（在不同的翻译单元或源文件中），则所有定义必须相同。编译器和链接器都不需要诊断所有违反此规则的行为（并非所有违规行为都可以轻松诊断）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-14T22:37:57.067

如果一个 C++ 程序提供了同一个类的两个定义（即，在同一个命名空间中并且命名相同），那么该程序就违反了标准的规则并且你会得到未定义的行为。究竟会发生什么在某种程度上取决于编译器和链接器：有时您会收到链接器错误，但这不是必需的。

明显的解决方法是不要有冲突的类名。获得唯一类名的最简单方法是在未命名的命名空间中定义本地使用的类型：

```
// file1.cpp
namespace {
    class A { /*...*/ };
}

// file2.cpp
namespace {
    class A { /*...*/ };
} 
```

这两个类不会冲突。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-14T22:36:49.027

这只是成功链接，因为 2 个构造函数的定义隐含为`inline`。尝试将它们移到类下而不使用`inline`关键字。您正在滥用的链接类型告诉链接器将有多个定义，通常会错误地认为您正在破坏一个定义规则，而您实际上正在破坏该规则。通常，这种允许您看似破坏 ODR 的条件存在于模板之类的东西中，模板在不同的翻译单元中总是有多个相同的定义。但这就是条件：不同翻译单元中的定义必须相同。

最终，在您的示例中，使用哪个编译器取决于您的编译器。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-14T22:37:52.553

如果您允许（您应该这样做），编译器会针对多个定义向您发出警告。

gnu 链接器按照您在命令行上显示文件的顺序解析符号，因此它使用它看到的第一个定义。不确定所有链接器是否都以相同的方式工作。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-14T22:45:48.077

[存在单一定义规则](http://en.wikipedia.org/wiki/One_definition_rule)的原因是无论使用哪个定义都无关紧要，它们都是相同的。至于使用哪个版本，或者它们是否一致，完全取决于所讨论的编译器和链接器。唯一外部可见的副作用是当函数内部有一个静态变量时，必须在函数的所有实例之间使用该变量的单个实例。

通过违反单一定义规则，您以与正确编写的程序无关的方式暴露了编译器/链接器的机制。

# javascript - 忽略 z-index 的 HTML5 视频

> ID：13388537
> 
> 赞同：20
> 
> 时间：2012-11-14T22:32:42.427
> 
> 标签：javascript, jquery, css, html

所以这是我到目前为止所尝试的：

```
<div id="video" style="position:absolute;margin-top: 231px;margin-left: 127px;">            
    <video width="520" height="390" style="z-index:-10;">
        <source src="m/video.ogv" type="video/ogg">
        <source src="m/video.mp4" type="video/mp4">
    </video>        
</div> 
```

我有一个固定菜单，当菜单在视频上方时，视频似乎忽略了 z-index。我目前在 chrome windows 上工作，没有运气。有任何想法吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-11-14T22:36:24.230

对两个重叠的元素使用 css属性，并尝试赋予`position:absolute`高于`0``z-index`

**[这是工作 jsFiddle 示例。](http://jsfiddle.net/YZT5s/117/)**

CSS：

```
#main_container { float: left; position: relative; left:0; top:0; }
#video { position: absolute; left: 0px; top: 0px; min-height: 100%;
         min-width: 100%; z-index: 9997; }​
#overlay { position: absolute; left: 0px; top: 0px; height: 100%; width: 100%;
           z-index: 9998; } 
```

html:

```
<div id="main_container">
<div id="overlay"></div>
<video id="video" width="" height="" controls="controls" loop="loop" autoplay="">
 <source src="http://www.w3schools.com/html/mov_bbb.mp4" type="video/mp4" />
 <source src="http://www.w3schools.com/html/mov_bbb.ogg" type="video/ogg" />
  Your browser does not support the video tag.
</video>
</div> 
```

注意：使用覆盖 div 来停用控件，您可以使用视频中的任何内容，例如 jsFiddle 示例。

来源：[视频作为网站上的背景播放命令](https://stackoverflow.com/questions/11903924/video-as-background-on-a-website-playing-on-command/11904238#11904238)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-05-09T07:54:21.630

在您的覆盖/菜单元素上，使用：

```
backface-visibility: hidden; 
```

这对我有用。我的猜测是它会触发元素上的 3d 渲染，从而消除 z-index 问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-31T20:16:23.417

叠加层也需要是视频的兄弟。如果视频是叠加层的子级，它将不起作用。

作品：

```
<div id="container">
  <div id="overlay" style="width:100px; height:100px; position:absolute; top:20px; left:20px; z-index:20;">
  </div><!-- end #overlay -->
  <video id="video" style="width:100px; height:100px; position:absolute; top:20px; left:20px; z-index:10;">
    <source src="video.mp4" type="video/mp4">
    <source src="video.webm" type="video/webm">
  </video>
</div><!-- end #container --> 
```

不工作：

```
<div id="container">
  <div id="overlay" style="width:100px; height:100px; position:absolute; top:20px; left:20px; z-index:20;">
    <video id="video" style="width:100px; height:100px; position:absolute; top:20px; left:20px; z-index:10;">
      <source src="video.mp4" type="video/mp4">
      <source src="video.webm" type="video/webm">
    </video>
  </div><!-- end #overlay -->
</div><!-- end #container --> 
```

我只在 Chrome 中尝试过，如果这不是普遍正确的，我深表歉意。

# php - PHP Parse 错误：语法错误，意外的 T_OBJECT_OPERATOR

> ID：13388541
> 
> 赞同：51
> 
> 时间：2012-11-14T22:33:16.383
> 
> 标签：php

调试代码时出现此错误：

> PHP Parse 错误：语法错误，第 72 行的 order.php 中出现意外的 T_OBJECT_OPERATOR

这是代码片段（从第 72 行开始）：

```
$purchaseOrder = new PurchaseOrderFactory->instance();
$arrOrderDetails = $purchaseOrder->load($customerName); 
```

* * *

## 回答 #1

> 赞同：88
> 
> 时间：2012-11-14T22:36:07.737

`new`不幸的是，在 PHP 5.4 之前无法调用刚刚创建的对象的方法。

在 PHP 5.4 及更高版本中，可以使用以下内容：

```
$purchaseOrder = (new PurchaseOrderFactory)->instance(); 
```

请注意强制性的括号对。

在以前的版本中，您必须在变量上调用该方法：

```
$purchaseFactory = new PurchaseOrderFactory;
$purchaseOrder = $purchaseFactory->instance(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-14T22:34:59.380

更改为您的语法无效：

```
$purchaseOrder = PurchaseOrderFactory::instance();
$arrOrderDetails = $purchaseOrder->load($customerName); 
```

其中大概`instance()`创建了一个类的实例。你可以这样做而不是说`new`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-14T22:35:08.317

您不能使用（这是无效的 php 语法）：

```
new PurchaseOrderFactory->instance(); 
```

您可能是指其中之一：

```
// Initialize new object of class PurchaseOrderFactory
new PurchaseOrderFactory(); 

// Clone instance of already existing PurchaseOrderFactory
clone  PurchaseOrderFactory::instance();

// Simply use one instance
PurchaseOrderFactory::instance();

// Initialize new object and that use one of its methods
$tmp = new PurchaseOrderFactory();
$tmp->instance(); 
```

# ide - CoffeeScript 的语法检查

> ID：13388546
> 
> 赞同：1
> 
> 时间：2012-11-14T22:33:56.290
> 
> 标签：ide, coffeescript

我搜索了谷歌，但没有找到专门允许语法检查的 IDE。有没有办法在 VS 或其他工具中检查语法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T12:41:37.363

即使不是免费的，[Webstorm 也](http://www.jetbrains.com/webstorm/)为 Coffeescript 提供了开箱即用的良好支持。

到目前为止，我更喜欢目前大多数开发 Coffe/Javascript 的 IDE。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T02:00:30.477

+1 在 vi​​m-coffee-script 和 syntastic 上。

你检查过 CoffeeScript 的[wiki](https://github.com/jashkenas/coffee-script/wiki/Text-editor-plugins)吗？有几个插件可以添加语法检查：

*   [用于 sublime 的 CoffeeScript 插件](https://github.com/Xavura/CoffeeScript-Sublime-Plugin)
*   [适用于 Netbeans 的 CoffeeScript](https://github.com/dstepanov/coffeescript-netbeans)

您可能对使用像[CoffeeLint](http://www.coffeelint.org/)这样的命令行工具感兴趣，它提供了可选的验证规则。您可以将其添加到您的开发过程中，编写您自己的脚本来监视文件的变化或使用[Grunt](http://gruntjs.com/)之类的工具。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-14T23:38:48.530

请参阅[gVim](http://www.vim.org/download.php)并安装此[插件](https://github.com/scrooloose/syntastic)以进行语法检查，并安装[此](https://github.com/kchmck/vim-coffee-script)插件以进行语法着色。

这是一种轻量级、可扩展且便宜的选择。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-14T23:40:05.360

如果您可以使用 Vim，只需添加[vim-coffee-script](https://github.com/kchmck/vim-coffee-script)和[syntastic](https://github.com/scrooloose/syntastic)插件

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-28T01:36:52.827

如果您喜欢 Emacs，那么[CoffeeScript 有一个 Emacs 主要模式](https://github.com/defunkt/coffee-mode)。

这是宣布其发布的[博客文章。](http://ozmm.org/posts/coffee_mode.html)

# mysql - MYSQL 从两个表连接

> ID：13388549
> 
> 赞同：2
> 
> 时间：2012-11-14T22:34:04.390
> 
> 标签：mysql

我不确定我错过了什么，但我知道它不应该这么难。我有两张桌子。第一个表列出了站点的所有可能工作。第二个表包含在站点完成工作的时间。我想要一个查询，在那里我可以获得所有可能的工作并加入秒表中的数据（如果有的话）。尚未完成作业的站点将具有 NULL 值。

**例子：**

*表 1：*
ID
名称
说明

*表 2：*
ID
siteID
status
jobID

```
SELECT table1.* , table2.*
FROM table1
LEFT JOIN table2
ON table1.id = table2.jobID
WHERE siteID = 12 
```

这仅返回已完成的作业，而不是所有已完成和未完成的作业。

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T22:50:14.907

如果您想要此特定站点或 null

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T22:49:57.753

应该做一个简单的更改，只需更改 上的值的顺序`JOIN`，如下所示：

```
SELECT table1.* , table2.* 
FROM table1
LEFT JOIN table2
ON table2.jobID = table1.id
WHERE siteID = 12 OR siteID IS NULL 
```

请记住，`NULL`当没有结果时，siteID 将是，因此也要更改您`WHERE`的。

# c# - 名称空间“http://schemas.xceed.com/wpf/xaml/toolkit”中不存在名称“RichTextBox”

> ID：13388551
> 
> 赞同：1
> 
> 时间：2012-11-14T22:34:08.820
> 
> 标签：c#, wpf, xaml, toolkit, xceed

> **可能重复：**
> [扩展的 WPF 工具包 - 使用 RichTextBoxFormatBar](https://stackoverflow.com/questions/10188373/extended-wpf-toolkit-using-the-richtextboxformatbar)

这一直让我发疯。我以前使用过 WPF 扩展工具包，但现在尝试它，即使是在一个全新的项目上（见截图），也不起作用。我得到了错误的图片。

我无法嵌入图像，因为我是 stackoverflow 的新用户（但长期潜伏）。

捕获整个问题的屏幕截图在这里：http: [//i.imgur.com/fmFsd.png](https://i.imgur.com/fmFsd.png)

基本上，如果我创建一个全新的项目，添加对 WPFExtended 工具包 .dll 的引用（未以任何方式修改），然后将命名空间添加到 mainwindow.xaml，然后尝试添加一个（或我测试过的任何其他控件）远），我得到：

"名称 "RichTextBox" 不存在于命名空间 " [http://schemas.xceed.com/wpf/xaml/toolkit](http://schemas.xceed.com/wpf/xaml/toolkit) ""

有没有搞错？这个我用过几次了，怎么现在这么快？

这是 Visual Studio (Express) 2012 / .net 4.5 的问题吗？

更新：我似乎能够在后面的代码中很好地创建对象，尽管 xaml 出现错误，但应用程序仍然“构建”......奇怪。

# mysql - MyISAM 在几乎只读的表中会更好吗？

> ID：13388561
> 
> 赞同：0
> 
> 时间：2012-11-14T22:35:01.253
> 
> 标签：mysql, innodb, myisam

基本上，我有一个包含、、 、`lang`列的表，用于我的网站的多语言支持，在 99.999% 的情况下，数据将从表中读取而不是写入。我听说 MyISAM 在面向读的表上表现比 InnoDB 好；考虑到只有列用作子句，该表应该是 MyISAM 还是 InnoDB？`pg VARCHAR(20)``id VARCHAR(20)``en (TEXT)``ru (TEXT)``pg``WHERE`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T22:49:09.030

前言：我不是DBA。

我认为 MyISAM 的主要优点是它实际上会在您指定的字段上建立索引，而不是将每个指定的索引索引到强制自动生成的主键 id（a la InnoDB）。这里最大的优势是，如果您想要包含多个字段的索引，例如 (pg, en, ru) 上的单个索引，MyISAM 实际上可以创建一个索引，而不是将每个索引索引到 id 并执行三个查找作为较慢的等效项。

在您的情况下，如果您只想搜索一个字段，您可能会从 MyISAM 获得适度的性能提升，因为它只需要查看那个字段即可检索您的行。InnoDB 将从您的字段中获取 id 列表，然后按 id 检索行。无论如何，这几乎就是它的优化目标。

如果没有明显的优势，我会做任何更清洁或更容易的事情。如果您真的想知道答案，您可能需要对其进行基准测试。

再说一次，我不是 DBA，所以也许我在这方面还差得远！

# jquery - Webkit（Chrome、Safari）浏览器在 JQuery addClass 后无法更新 CSS

> ID：13388563
> 
> 赞同：0
> 
> 时间：2012-11-14T22:35:15.340
> 
> 标签：jquery, css, webkit, addclass

我建立了一个行为的小例子。基本上，我在左侧有一个带有可展开窗格的页面。当它展开时，Chrome 似乎无法更新 CSS。

[http://jsfiddle.net/HUHqA/2/](http://jsfiddle.net/HUHqA/2/)

在此示例中，您单击展开左侧面板的绿色矩形。通过 JQuery 将一个 css 类移至右侧面板。似乎在有某种布局操作之前不会应用 CSS 类。例如，如果您稍微调整页面大小，或者如果您打开开发人员工具并取消选中一些随机 CSS。当您执行该操作时，蓝色矩形的边缘会跳到它应该在的位置。

看起来它可能与一个类中的 !important 覆盖另一个类有关。

最初它有这两个类：

```
#main-content-right{
    min-width:200px;
    padding:0 15px 0 100px;
    margin-bottom:10px;
    z-index:1;
    min-height:300px;
}

.main-content-collapse-right{
    padding:0 150px 0 29px !important;
} 
```

然后后者被删除。

如果您在我的 hack 函数中取消注释该行，则可以修复它。我基本上有两个问题。
1）这是浏览器本身的错误吗？2）有没有比仅仅切换一些随机css更好的解决方案？

编辑：看起来问题 1 的答案是肯定的：[https](https://bugs.webkit.org/show_bug.cgi?id=93876) ://bugs.webkit.org/show_bug.cgi?id=93876和简化演示：[https://bug-93876-attachments.webkit.org/attachment。 cgi?id=158063](https://bug-93876-attachments.webkit.org/attachment.cgi?id=158063)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T22:45:48.623

`!important`您应该可以通过使用它来摆脱：

```
#main-content-right.main-content-collapse-right{
 padding:0 150px 0 29px;
} 
```

包含 id 后，特异性应该足够高，这`!important`是不必要的。

# algorithm - 时间复杂度

> ID：13388565
> 
> 赞同：0
> 
> 时间：2012-11-14T22:35:36.070
> 
> 标签：algorithm, time-complexity

如果我们有一个算法是 order `N^2*logN`，并且输入大小为 64 需要 1 ms；运行输入大小为 2048 的算法需要 2^10*(11/6) 毫秒吗？我在这里使用直接比例，这就是为什么它对我来说似乎有缺陷。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T22:40:33.117

最简单的求解方法可能是将 2048 除以 64，将得到的数字代入复杂度方程，结果就是输入大小 2048 的毫秒数。

# spring - 使用 Maven 的具有多个子项目的 Spring MVC 项目的包结构

> ID：13388566
> 
> 赞同：0
> 
> 时间：2012-11-14T22:35:37.640
> 
> 标签：spring, maven, spring-mvc, module, package

我们想使用 maven 创建一个 Spring MVC 项目。我们只想使用一个项目，并且在它之下有多个子项目

例如，对于项目来说，什么是好的目录/包结构

```
com
    company
        subproject_1
            controller
            doa
            service
            entity
        subproject_2
            controller
            dao
            service
            entity 
```

或一个项目中子项目的所有文件

```
com
    company
            controller
                all controllers of all sub projects 
            doa
                all dao of all sub projects
            service
            entity 
```

取决于经验，如果项目增加并且子项目不断增加，哪种项目结构是可维护的

或任何其他包结构的建议？

还有用于目录的命名标准是实体还是域？做还是坚持？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T22:55:47.110

为什么不按照多模块项目结构对子项目进行分组？这是一种被广泛采用、认可且易于管理的良好编码实践。看看[这个例子](https://books.sonatype.com/mvnex-book/reference/multimodule.html)。

就命名约定而言，这是个人喜好，但最好在包结构中清楚地维护不同的层，正如您从 botton-top 方法所说的那样：*dao*级别、*域*、*服务*层、*控制器*，最后是*视图*.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T09:41:50.937

1.  创建 Maven 多模块项目。
2.  在每个项目中都有两个选项：

    *   按功能打包
    *   逐层打包

    这些选项在这里讨论：[http ://www.javapractices.com/topic/TopicAction.do?Id=205](http://www.javapractices.com/topic/TopicAction.do?Id=205)

我个人的方法是在每个 maven 模块项目包中按功能和“功能”包使用的一些“实用”包创建。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T05:48:17.147

尝试使用*添加到工作集*选项。

# batch-file - 如何在不使用 Vbscript 的情况下隐藏 CMD/BAT

> ID：13388569
> 
> 赞同：1
> 
> 时间：2012-11-14T22:35:57.177
> 
> 标签：batch-file, cmd, hide

如何在不使用 Vbscript 的情况下隐藏 CMD/BAT，我不喜欢使用 VBSCRIPT，因为它会在自动运行之前减慢应用程序的速度。因此，如果您有一个代码要放入批处理或 CMD 以隐藏 CMD/Bat 文件而不使用 VBScrpit。请告诉我。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T23:32:50.740

我试过这样做一次，但从未真正成功。这是我的示例代码，这是我最接近解决方案的代码：

```
@echo off
if not defined PIL (
    set PIL=1
    start /min "" %~0
    exit /b
)
TITLE Hello World
echo Hello world!
pause>nul 
```

# java - 如何将相机视图设置为背景并对其进行查看？

> ID：13388572
> 
> 赞同：1
> 
> 时间：2012-11-14T22:36:09.097
> 
> 标签：java, android, android-layout, view, android-camera

所以，我试图让我的一个应用程序的背景看起来“未来感”。我想了一个主意，让屏幕看起来几乎是透明的，同时还能看到它。所以，它看起来像这样：（[来源：][[rackspacecloud.com](http://c2499022.cdn.cloudfiles.rackspacecloud.com/wp-content/uploads/2009/08/window-phone-concept.jpg)][）][![这个。](../Images/e2825f28d2fd67d96701bfff8c521326.png)](https://i.stack.imgur.com/hfLch.jpg)

我在想我可以使用相机来捕捉手机的背景（无需拍照，只需在背景中有实时视图），然后，如果可能的话，在上面放置一个半透明的稍微模糊的 ImageView。最后，最重要的是，我可以放置其他视图，包括 ImageButtons。

所以，我的问题是我该怎么做呢？我已经搜索过，但没有找到任何相关的东西。必须是可能的；它只是怎么做？我不希望您给我所有的代码作为答案，只要您有任何可以帮助的想法或可以为我指明正确方向的链接或代码，将不胜感激！谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T22:58:12.950

开始应该不会太难。[这里](http://developer.android.com/training/camera/cameradirect.html)有一些示例，向您展示如何打开相机并将预览绘制到 SurfaceView 上。由于您想将其他视图覆盖在相机预览之上，因此只需确保您用于相机预览的 SurfaceView 包含在 FrameLayout 中（文档位于[此处](http://developer.android.com/reference/android/widget/FrameLayout.html)）。FrameLayout 允许您插入子视图，并使用它们插入的顺序对它们进行 z 索引。因此，如果您插入 SurfaceView，然后插入某种 Button，它将在 SurfaceView 前面按 z 顺序排列，您可以设置其 alpha 值，使其或多或少透明。话虽如此，您将不得不对如何定位在相机预览前渲染的视图进行一些试验和错误，因为在不同屏幕尺寸上使用的 FrameLayout 可能会以不同的方式定位视图。另外，我会避免将太多视图叠加在一起，因为合成器必须弄清楚如何将所有视图渲染到一个可能会影响性能的窗口中。

# java - Java 扫描器不工作

> ID：13388580
> 
> 赞同：3
> 
> 时间：2012-11-14T22:36:27.093
> 
> 标签：java, csv

此 CSV 阅读器还通过使用地图工具检查电子邮件地址和密码的有效性。

```
import java.io.*;
import java.util.*;

public class CSVReaders{

public static void  run(String[] args) throws Exception {
    Map<String, String> emailPasswordMap = new HashMap<String, String> ();
    BufferedReader CSVFile =
        new BufferedReader(new FileReader("testa453.csv"));
    String dataRow = CSVFile.readLine();
    while (dataRow != null){
        String[] dataArray = dataRow.split(",");
        emailPasswordMap.put (dataArray[0], dataArray[1]);
        dataRow = CSVFile.readLine();
    }
    CSVFile.close();
    //Scanner in = new Scanner(System.in);
    //String email = in.nextLine();
    //String password = in.nextLine();
    String password = ("raj45");
    String email = ("rakhter@bluebell.org");
    if (password.equals (emailPasswordMap.get (email))) {
        System.out.println ("The entered email and password are valid");
    }
    else {
        System.out.println ("The entered email and password are invalid");
    }

} 
```

}

我遇到的问题是，在运行时，当我将“//”更改为字符串密码和电子邮件并尝试使用包含程序“运行”但控制台窗口没有出现的扫描仪时，我必须强制停止程序以使其停止运行。虽然像我在这里展示的那样使用它，但它工作得很好。以前我在扫描仪上遇到与静态和非静态变量相关的错误。我查找了它们并尝试使用实例变量，但收效甚微。是我声明扫描仪错误的方式还是我不能将映射与扫描仪结合使用？

编辑：我目前在 Mac 上使用 BlueJ，因为我对 java 编程相当陌生。是的，正如我所引用的那样，它确实有效，只有当我尝试使用扫描仪时它才会停止工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T22:44:16.433

> 是我声明扫描仪错误的方式还是我不能将映射与扫描仪结合使用？

该`Scanner`声明似乎是正确的。不，没有任何限制禁止同时使用 Java 标准库的任何两个部分。所以使用`Map`和`Scanner`一起使用是完全可以的。

目前，SO 社区的最佳猜测是您正在使用具有内置控制台窗口/视图的 IDE（如 eclipse）。在此假设下，假设您希望打开一个黑色终端/cmd 窗口，但在大多数 IDE 中并非如此。在 Eclipse 中，“控制台视图”是您进行输入的地方。在 Netbeans 中，这将是输出窗口。

# java - 在 hibernate 中映射一个引用项目中的类

> ID：13388584
> 
> 赞同：0
> 
> 时间：2012-11-14T22:36:30.483
> 
> 标签：java, hibernate, hibernate-mapping

我正在使用引用项目中的类作为休眠项目的映射 - 我可以在 Java 代码中使用这些类，但不能引用休眠配置文件中的类。我明白了`WARN: HHH000183: no persistent classes found for query class`

所以在我使用的休眠映射配置文件中：

```
...

<mapping package="com.me.my.proj.oracle"/>
<mapping class="com.me.my.proj.oracle.WDI_HBD_PSNG_SMRY"/>
</session-factory> ###end of hibernate config file### 
```

是否可以使用 hibernate 在参考项目中引用一个类？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T22:50:16.763

您引用的项目 (Java) 将作为`JAR`文件添加到当前项目的类路径中。我认为您需要使用`mappingJarLocation`with location 作为您的`ReferenceProjectName.jar`.

```
 <property name="mappingJarLocations" value="file:**/ReferenceProjectName.jar"/> 
```

# visual-studio-2012 - 由于许可证问题，此应用程序无法启动

> ID：13388586
> 
> 赞同：30
> 
> 时间：2012-11-14T22:36:32.177
> 
> 标签：visual-studio-2012, windows-store-apps

我很高兴在编码过程中，然后我尝试在调试模式下启动我的应用程序，但我收到了这个错误消息。

> 无法激活 Windows 应用商店应用
> 
> 由于许可证问题，此应用程序无法启动

该应用程序在几分钟前启动良好，因此令人惊讶。我尝试重新启动 Visual Studio，但这样做没有帮助。

我想我昨天收到了烦人的“更新您的开发人员许可证”对话框。它已毫无问题地更新。

如何使此错误消息消失，以便我可以调试我的应用程序？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2012-11-14T22:46:31.023

好吧，我通过删除主项目的“bin”和“obj”文件夹来实现它。清洁和重建是不够的。希望这个答案可以为其他人节省我刚刚经历的几分钟的困惑。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-11-26T12:23:04.130

我最近有一个类似的问题。就我而言，我必须卸载重新安装应用程序才能使其正常工作。

希望这可以帮助某人。此外，要了解有关失败原因的更多详细信息，您可以查看事件日志：

事件查看器 > 应用程序和服务日志 > Microsoft > Windows > Aps > Microsoft-Windows-TWinUI/Operational

里面可能有更多细节。在我的情况下，它被记录为一个错误事件，表示该应用程序由于其许可证的临时问题而无法启动。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-01-26T23:18:38.200

我刚刚从开始屏幕卸载了应用程序的现有版本，然后从 Visual Studio 再次启动了该应用程序，它启动得很好。

我认为这背后的原因是因为更新了 Visual Studio 的许可证并尝试启动在以前的许可证处于活动状态时安装的应用程序。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-04-14T17:45:20.070

我看到用 bin 和 obj 文件夹做事似乎是对此的公认答案。

我通过选择“卸载然后重新安装我的软件包”解决了这个问题。删除有关应用程序状态的所有信息。项目属性的调试选项卡下的复选框。为所有未来的构建完成一次后，您可以取消选中它。

我对这个解决方案没有任何问题。简单的修复，您不必担心有人对文件夹做一些可能导致更大问题的事情。

[http://daxdude.blogspot.com/2013/04/c-error-unable-to-activate-windows.html](http://daxdude.blogspot.com/2013/04/c-error-unable-to-activate-windows.html)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-09-02T21:00:24.613

我已经有几次这个问题了，大多数时候删除 Bin 和 Obj 文件夹会解决这个问题（这些文件夹是在项目构建期间自动生成的，所以不用担心删除它们）

我在远程设备（平板电脑或手机）上调试时发现删除这些文件夹并不能解决问题 - 在这种情况下，我发现的最佳解决方案就是在我正在远程调试的设备上重新启动.

简单但有效！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-29T17:26:35.627

我刚刚清理了我的解决方案并重新启动了 Visual Studio。这对我有用 - 并且不涉及寻找要删除的文件，因此您可能想先尝试一下。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-12-16T06:02:29.297

转到 BUILD-->Clean Solution 并单击，然后再次清理后转到 BUILD-->Rebuild Solution。成功重建您的解决方案后，只需部署它 (Ctrl+F5)。这为我解决了这个问题。

# javascript - navigator.geolocation 不返回 iOS 6 的有效时间戳

> ID：13388588
> 
> 赞同：3
> 
> 时间：2012-11-14T22:36:46.047
> 
> 标签：javascript, iphone, ios, geolocation, ios6

我在浏览器应用程序中有一些非常基本的 GeoLocation 代码，它必须报告纬度/经度和时间戳的准确 GPS 值。

这一直适用于 Android 设备和 iPhone 至 iOS 5.1.1。

现在我们的一个使用已经升级到 iOS 6.0.1，返回的时间戳现在都无效了。

javascript代码具有基本形式：

```
navigator.geolocation.getCurrentPosition(foundLocation, noLocation, { enableHighAccuracy: accuracyVal, timeout: timeoutVal, maximumAge: maxageVal }

function foundLocation(position) {
    var lat = position.coords.latitude;
    var long = position.coords.longitude;
var gps_ts =  position.timestamp;
} 
```

Android 设备继续返回与实际时间匹配的 gps_ts UNIX 时间戳，但在 iOS 6 中，我们得到的时间戳转换为 1958 年到 1969 年间的奇数日期时间。它们似乎是按时间顺序测量的，因为这些值会随着时间的推移而增加使用，但它们不再是当前时间的 UNIX 时间戳。

对此的帮助将不胜感激。我看到还有其他支持 iOS 6 地理位置的报告（请参阅[https://discussions.apple.com/thread/4313850?start=0&tstart=0](https://discussions.apple.com/thread/4313850?start=0&tstart=0)），但没有专门关于 javascript 使用和时间戳功能。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-30T16:45:40.877

我今天一直在试验这个。据我所知`timestamp`，iOS 中的“分辨率”基本上比其他浏览器高 1000 倍（微秒而不是毫秒）。我写了一个这样的辅助函数来解决它：

```
function getGeoTimestampDate(timestamp) {
    if (timestamp > 14000000000000) { timestamp = Math.floor(timestamp / 1000); }
    return new Date(timestamp);
} 
```

我只能在几台设备上进行测试（原始 iPad 和 iPhone 4，都在 iOS 6.0.1 上），所以如果有人能确认它是否适用于其他设备，我将不胜感激。

# twitter-bootstrap - 带有 twitter bootstrap 一般问题的 FontAwesome

> ID：13388596
> 
> 赞同：2
> 
> 时间：2012-11-14T22:37:14.413
> 
> 标签：twitter-bootstrap, icons, less, retina-display, font-awesome

我有一些关于在 Twitter Bootstrap 中使用 Font Awesome 的一般性问题。

我使用了他们网站上描述的 LESS 集成方法。

1.  我认为这是一种“标志性”字体。那么为什么它会改变 Twitter Bootstrap 提供的主要文本字体呢？我可以防止这种行为吗？

2.  与 twitter bootstrap 提供的 Glyphicon png 版本相比，图标看起来确实很模糊，尤其是在较小的尺寸下。为什么？

3.  在标准和视网膜显示器上正确显示图标（使用 Twitter Bootstrap）的解决方案是什么？

感谢您的任何意见。

编辑：这是我遇到的问题的一个例子。

![字体真棒问题](../Images/52e800ef608495e3e0009117f0457d97.png)

如您所见，安装 Font Awesome 后字体看起来有所不同。按钮的形状和感觉都丢失了。绿色和红色按钮的图标已使用 icon-large 渲染，但它们看起来仍然非常模糊。除此之外，我现在意识到它只是以某种方式搞砸了我的设计。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T09:45:53.020

Font-Awesome 大量使用包含`[class^="icon-"]`. 如果您出于某种原因使用从其他地方开始的类，这可能会导致问题`icon-`。Bootstrap 做同样的事情，但可能不会为其图标设置边距和字体大小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T03:58:18.173

我一直在我的网站上使用很棒的字体，并且一直很喜欢它。我没有看到它与页面上的字体混淆的任何地方，所以对于这一点，我必须看一个你在说什么的例子。一些图标在变小时真的很模糊，除了使用 icon-large 类使它们变大之外，没有办法解决这个问题。这是因为字体了不起的家伙制作它们的比例当我使用 em 时，我一直将所有图标放在自己的元素中 -`<em class="icon-thumbs-up></em>`然后将文本放在其之后或之前..据我所知，图标可在所有移动和桌面浏览器上工作，除了 Opera mini，因为 mini 不支持 font-face 属性

我也一直在查看[http://icomoon.io/app/](http://icomoon.io/app/)的图标，虽然我还没有尝试过。我计划在一天将字体真棒切换到那个，但这需要一点时间，因为我现在的桌子上有很多东西。

# sql - 在存储过程中创建带有 @parameter 指令的表

> ID：13388598
> 
> 赞同：0
> 
> 时间：2012-11-14T22:37:31.560
> 
> 标签：sql, stored-procedures, sql-server-2008-r2

我想在 SQL Server 中从此代码创建一个表，但存储过程返回错误

```
CREATE PROCEDURE Recovery_CountryCode (@NombreTabla SYSNAME)
AS
DECLARE @ParamDefinition nvarchar(500);
DECLARE @SQLString nvarchar (4000);
 SET @SQLString=N'SELECT Name
                INTO @TableName
                FROM AdventureWorks2008R2.Production.Location';
SET @ParamDefinition=N'@TableName SYSNAME';
EXECUTE sp_executesql @SQLString, @ParamDefinition, @TableName=@NombreTabla;
GO 
```

我想避免定义表

当我调用存储过程时：

```
EXEC Recovery_CountryCode @NombreTabla='Paises'; 
```

我收到以下消息：

> *男士。102，Nivel 15，Estado 1，Línea 2 Sintaxis wronga cerca de '@TableName'。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T22:43:13.193

您可以在过程中连接 SQL

```
CREATE PROCEDURE Recovery_CountryCode (@NombreTabla SYSNAME)
AS
DECLARE @ParamDefinition nvarchar(500);
DECLARE @SQLString nvarchar (4000);
 SET @SQLString=N'SELECT Name INTO ' + 
                @NombreTabla + 
                ' FROM AdventureWorks2008R2.Production.Location';
EXECUTE sp_executesql @SQLString
GO 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T22:43:50.797

您不能以这种方式将变量绑定到表名。你需要做类似的事情

```
Declare @sql nvarchar(max), @NombreTable sysname = 'Test'

Set @sql = N'Select Name Into ' + @NombreTable +
           N' From AdventureWorks2008R2.Production.Location

exec sp_executesql @sql 
```

[http://www.sommarskog.se/dynamic_sql.html](http://www.sommarskog.se/dynamic_sql.html)推荐阅读。

# windows-8 - 使“卸载”命令为 Windows 8 应用程序做正确的事情

> ID：13388601
> 
> 赞同：4
> 
> 时间：2012-11-14T22:37:41.143
> 
> 标签：windows-8, uninstallation

在 Windows 8 开始屏幕中，我注意到如果您右键单击某个应用程序，底部会出现一个**卸载图标。**对于我开发的应用程序，如果单击“卸载”图标，它会打开“程序和功能”对话框。理想情况下，它应该直接启动我的卸载程序。有谁知道这是怎么做到的吗？是否需要设置一些注册表项才能将“开始”菜单快捷方式与卸载程序相关联？

我使用各种技术来制作我的应用程序（例如 Qt、C#、Visual Studio 安装项目、NSIS）。在 Windows 7 及更低版本上，我的安装程序将快捷方式放在“开始”菜单中。在 Windows 8 上，这些快捷方式在“开始”屏幕中显示为一个小方块。所以那个快捷方式是我右键单击的对象。有没有办法将卸载数据添加到快捷方式文件本身？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T19:01:41.440

桌面应用程序的磁贴不会像商店应用程序的磁贴那样自动卸载。正如您所指出的，为桌面应用程序磁贴选择“卸载”会启动添加/删除程序体验。这是设计使然。

# html - 为什么在 cPanel 下显示的是 `?` 而不是非英文字符？但不在 localhost 或 DirectAdmin 下？使用 codeigniter 和 UTF-8。没有使用 mysql

> ID：13388602
> 
> 赞同：0
> 
> 时间：2012-11-14T22:37:41.823
> 
> 标签：html, utf-8, character-encoding, cpanel, non-english

我首先创建了一个简单的 HTML 页面，`UTF-8`用作其字符编码。

然后我将 HTML 内容复制到 codeigniter 中的一个视图中，它仍然可以（我使用的非英文字符一如既往地没问题）

我添加了一个简单的动态功能（有一个联系表单，可以将用户的反馈通过电子邮件发送给站点管理员）。

**本地主机仍然没有问题。**（这是在 Ubuntu 12.04 LTS 上运行的 LAMP 服务器）

**我什至没有连接到 mysql 或任何其他 DBMS。**

但奇怪的是，当我将应用程序上传到服务器时，只`???????`显示而不是波斯字符（例如`نام`（表示名称）变成`???`了等等......）

也许我应该说，在用户反馈后，我也使用会话库来感谢用户，仅此而已。

请注意，它是小项目中唯一的页面（它更像是一个正在建设的页面），并且没有使用其他任何内容。

我真的不知道问题出在哪里！

* * *

**评论后更新**

*   **现在我可以看到问题仅出在 cPanel 上。在 Directadmin（当然还有本地 LAMP）上一切正常。**我没有测试过其他主机控制面板。
*   Chromium 和 Firefox 都可以理解`UTF-8`为页面的字符编码。它们都设置为自动检测编码。
*   URL 是`http://WEBSITE.COM/dmf/dynamic/`（dmf 是项目名称的缩写！）。URL 中没有任何非英语的内容。
*   页面代码如下：

    ```
    <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
    <html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>نام وب‌سایت&lt;/title>
        <link rel="stylesheet" type="text/css" href="<?php echo base_url('template/css/style.css'); ?>" />
    <!-- 1\. jquery library -->
    <script
      src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js">
    </script>

    <!-- 2\. flowplayer -->
    <script src="http://releases.flowplayer.org/5.1.1/flowplayer.min.js"></script>

    <!-- 3\. skin -->
    <link rel="stylesheet" type="text/css" href="http://releases.flowplayer.org/5.1.1/skin/minimalist.css" />
    </head>
    <body>
        <div id="wrapper">
            <header>
                <h1>نام وب‌سایت&lt;/h1>
            </header>
            <section id="box-container">
                <?php
                    echo form_open('contact', "id='contact-us'");
                    echo form_fieldset('تماس با ما');
                    if ($this->session->userdata('mailsent'))
                    {
                        echo '<div>باتشکر، پیام شما ارسال شد</div>';
                        $this->session->sess_destroy();
                    }
                    echo '<input tabindex="1" id="name-in" value="نام" type="text" name="name"/>
                        <input tabindex="2" id="mail-in" value="ایمیل" type="email" name="email"/>
                        <textarea tabindex="3" id="content-in" name="message">توضیحات</textarea>
                        <input tabindex="4" id="submit" type="submit" value="ارسال" />';
                    echo '<div class="clear"></div>';
                    echo form_fieldset_close();
                    echo form_close();
                ?>

                <div id="sms-comp">
                    <h2>مسابقه پیامکی</h2>
                    <p>
                        <span id="comp-title">یک متن تستی</span>
    سامی برندگان هفته پیش
                    </p>
                </div>

                <div id="last-program">
                    <h2>دریافت آخرین برنامه</h2>
                    <div class="flowplayer">
                        <video id="my_video_1" width="212" height="126"
                            poster="<?php echo base_url('template/images/img.jpg'); ?>" controls="controls"
                            src="http://archive.org/download/Pbtestfilemp4videotestmp4/video_test.ogv" type='video/mp4'>
                        </video>
                    </div>
                </div>
                <div class="clear"></div>
            </section>
        </div>
        <footer>
            طراحی و توسعه : <a href="http://powered-by.com/" target="_blank">پاورد بای</a>
        </footer>
    </body>
    </html> 
    ```

# c# - 将值成员从数据库分配到组合框

> ID：13388603
> 
> 赞同：2
> 
> 时间：2012-11-14T22:37:51.660
> 
> 标签：c#, sql-server, database, combobox, database-connection

我正在尝试从我的数据库中选择两列，一列使其成为我的组合框中的显示成员，另一列使其成为值成员

我的代码如下：

```
SqlConnection con = new SqlConnection(@"Data Source=.\SQLEXPRESS;AttachDbFilename=c:\users\administrator\documents\visual studio 2010\Projects\Clinic\Clinic\Clinc.mdf;Integrated Security=True;Connect Timeout=30;User Instance=True");
con.Open();
SqlDataAdapter da = new SqlDataAdapter("select ClinicName,ClinicCode from Clinic",con);
DataSet ds = new DataSet();
da.Fill(ds);
comboBox1.DataSource = ds.Tables[0];
comboBox1.DisplayMember = "ClinicName";
comboBox1.ValueMember = "ClinicCode"; 
```

它确实从数据库中获取数据并很好地显示它，但不能设置值成员。

当我尝试将其打印到标签以查看它时，标签显示“cliniccode”

怎么了 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T22:52:46.403

你失踪了`comboBox1.BindingContext = this.BindingContext;`吗？

[组合框 ValueMember 和 DisplayMember 的使用](https://stackoverflow.com/questions/8367860/use-of-combobox-valuemember-and-displaymember/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T22:54:07.040

您应该使用该`comboBox1.SelectedValue`属性来获取或设置该值。

# facebook-graph-api - 无法获取 relationship_status 数据

> ID：13388608
> 
> 赞同：2
> 
> 时间：2012-11-14T22:38:22.163
> 
> 标签：facebook-graph-api, relationship, facebook-oauth

我正忙着在 facebook 上编写一个应用程序，但无论我尝试什么，我都无法获得 relationship_status 数据。我的应用程序成功获取了它需要的所有其他数据（朋友列表数据，如姓名、性别、个人资料图片等），但没有获取关系详细信息。

我试图更改应用程序的权限，以便“user_relationships”、“user_relationship_details”、“friends_relationships”和“friends_relationship_details”位于名为“用户和朋友权限”的框中。但是无论我尝试什么，当有人想要访问该应用程序时，它只要求提供标准数据，而在预览验证对话框中它会显示“关系详细信息”等内容。

Graph API 浏览器还显示该字段为空或我的应用程序的访问令牌不允许该字段。

无论我尝试什么，JSON 数据都不包含任何 relationship_status 数据。

我在这里错过了一些非常基本的东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T09:33:05.953

如果它在 Graph API Explorer 上显示正常，它应该可以正常工作。

您将需要的权限: `user_relationships`,`user_relationship_details`

您现在可以从 /me 和 json_decode 数据中捕获详细信息。

既然你说你没有得到任何信息，请确保它是否存在。我的意思是，如果 user_relationships 是`single`，就不会有任何`user_relationship_details`.

添加：我刚刚尝试过，它工作得很好。

# php - 如何让 SoapClient 尊重会话？

> ID：13388613
> 
> 赞同：3
> 
> 时间：2012-11-14T22:38:50.913
> 
> 标签：php, session, soap, soap-client

我正在为电子商务购物车使用 SOAP API，我似乎无法让会话在不同的页面中持续存在。

例如，我在下面有一些测试代码（带有一堆调试消息），它将一个项目添加到购物车，然后查看购物车。当我在浏览器中运行它时，它运行良好，但如果我刷新页面，我希望购物车中有两个项目（两个页面调用中的一个）。但是，它似乎不记得以前调用该页面的任何内容。我知道 API 正在工作，因为如果我在此页面上调用两次“AddToCart”然后调用“GetCartContents”，我会正确看到购物车中的 2 件商品。

我错过了什么吗？

```
<?php 
session_start();

$url = "https://www.example.com/soap-checkout.php?wsdl";
$client = new SoapClient($url, array("trace" => 1, "exception" => 0));

if (!empty($_SESSION['soapcookies'])) {
    foreach($_SESSION['soapcookies'] AS $name=>$value) {
        if (is_array($value)) {
            foreach($value AS $k=>$v) {
                $client->__setCookie($name[$k], $v);
            }
        } else {
            $client->__setCookie($name, $value);
        }
    }
}
echo "<pre style='background: grey;'>browser cookies: ".print_r($_COOKIE, true)."</pre>";//debug

// Add to Cart
$data = array( 
    "domain" => 'www.example.net', 
    "sku"    => "1234",
    "qty"    => 1
);
$result = $client->__soapCall("AddToCart", $data);
$responseHeader = $client->__getLastResponseHeaders();//debug
echo "<pre style='background: purple;'>responseHeader: ".print_r($responseHeader, true)."</pre>";//debug
echo "<pre style='background: grey;'>cookies: ".print_r($client->_cookies, true)."</pre>";//debug
echo "<pre style='background: yellow;'>Result of 'AddToCart': ".print_r($result, true)."</pre>";//debug

// Set SOAP Cookies in PHP Session
$_SESSION['soapcookies'] = $client->_cookies;

// View Cart
$data = array(
    "domain" => 'www.example.net'
);
$result = $client->__soapCall("GetCartContents", $data);
echo "<pre style='background: skyblue;'>Result of 'GetCartContents': ".print_r($result, true)."</pre>";//debug
?> 
```

仅供参考，PHP 版本是 5.2.6

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-02T05:33:06.460

如果您的目标是尝试将活动用户会话与与 SOAP API 的特定交互联系起来，那么您的方法看起来是正确的。您在会话中存储和设置 SOAP cookie 并通过 setCookie 恢复到 SOAP 会话的方法也是可行的方法。

您的代码无法正常工作可能是由于在线错误：

```
$client->__setCookie($name[$k], $v); 
```

需要是：

```
$client->__setCookie($name, $v); 
```

希望有帮助。

# sql-server - 使用多租户数据库从 saas 网站向客户端发布 SQL Server 数据？

> ID：13388614
> 
> 赞同：1
> 
> 时间：2012-11-14T22:38:53.733
> 
> 标签：sql-server, saas

我们维护一个位于多租户 SQL Server 数据库之上的软件即服务 (SaaS) Web 应用程序。系统中有大约 200 个表，其中最大的只有 100 多列，最后看看数据库的大小约为 10 GB。我们有大约 25 家客户公司使用该应用程序，每个都输入他们的数据并运行报告。

单实例架构对我们来说非常有效——我们能够设计和开发每月发布给所有客户的新功能。每个客户端体验都可以通过使用功能切换、数据字典定制、CSS 皮肤等进行配置。

我们的典型客户是一家拥有多个分支机构、一个总部，有时还拥有自己的内部 IT 软件开发团队的公司。

我们现在面临的问题是，一些客户正在开展他们自己的内部项目，以基于我们多租户数据库中当前存储的数据开发报告、数据仓库和仪表板。我们认为这些项目的数量和复杂程度可能会随着时间的推移而增加，我们希望有效地满足它。

目前，我们有一个“精简版”解决方案，通过该解决方案，我们公开了一个安全的 XML Web 服务，客户端可以调用该 Web 服务从表中获取其记录的完整下载。他们指定表，我们将其映射到一个专门构建的存储过程，该过程返回固定数量的列。目前，客户在一夜之间将大约 20 个表提取到他们管理的本地 SQL 数据库中。一些客户在其中一些表中有数万条记录。

这种“精简”方法有几个缺点：1）每个客户端都需要开发和维护自己的数据拉取机制，处理所有日志记录、错误处理等。2）我们的数据库模式在不断扩展和变化。他们调用的存储过程具有固定数量的列，但有时当我们扩展现有列（例如，将 varchar(50) 转换为 varchar(100)）时，它们的 pull 会失败，因为它突然超过了本地的列大小数据库。3) 我们开始为每个客户及其特定的下载期望积累数百个不同的存储过程，这是管理上的麻烦。4) 我们正在努力满足客户对更多数据的要求。我们提供一个“shell”模式（即我们的数据库副本，其中没有数据）并要求他们选择他们需要提取的表。

很抱歉这个冗长的问题，但我正在寻找的是其他团队已经成功解决这个问题的方法。我们希望以他们最容易使用的方式安全地向他们公开所有数据，但又不会陷入不断协商数据交换和模式更改后清理的过程中。

什么对你有用？

谢谢，

迈克尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T23:50:11.273

我曾在一家 SaaS 公司工作过，几年前该公司也经历过类似的工作，而 Web 服务可能是这里最好的解决方案。顺便说一句，您的“缺点”之一实际上是一种好处。应该鼓励客户进行自己的数据拉取，因为每个客户对时间和数据量的需求会有所不同。

现在，您应该考虑构建一个 WSDL，而不是 LITE 解决方案，为每个表使用单独的 CRUD 调用和良好的过滤功能。此外，请确保每个表上的记录都有更改时间。这样，客户可以点击每个表并立即仅提取自上次提取以来已更新的记录。

会不会很轻松。不是机会，但如果你想要可扩展性，这是唯一的途径。

祝你好运。

# php - 是否可以将 json post 请求从 jquery/javascript 传递给 php 以执行，然后让它传回 json？

> ID：13388615
> 
> 赞同：0
> 
> 时间：2012-11-14T22:38:53.583
> 
> 标签：php, javascript, jquery, ajax, post

所以我试图使用places api向谷歌地图添加一个地方但是我发现jquery和javascript使用jsonp并且在places api中不支持这个。因此我尝试在 php 中执行此操作，但我对 php 的经验很少，只能使用 CURL 发出发布请求。它成功了，我能够创建这个地方并打印 json。我想知道的是，是否有一种方法可以使用 javascript 或 jquery 获取要创建的地点的数据，然后发出 json post 请求，该请求会将地点信息传递给 php 文件，然后发出 json post 请求从那里然后将json返回到javascript文件？

到目前为止，这就是我所拥有的 php 文件，

```
<?php
    function ProcessCurl($URL, $fieldString){
             $ch = curl_init();
             curl_setopt($ch, CURLOPT_HTTPHEADER, array('Content-Type: application/json'));
             curl_setopt($ch, CURLOPT_URL, $URL);
             curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
             curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);
             curl_setopt($ch, CURLOPT_VERBOSE, 1);
             curl_setopt($ch, CURLOPT_POSTFIELDS, $fieldString);
             $resulta = curl_exec ($ch);
     curl_close($ch);
            echo $resulta;
    }

    $jsonpost =  '{
    "location": {
    "lat": -33.8669710,
    "lng": 151.1958750
    },
    "accuracy": 50,
    "name": "Daves Test!",
    "types": ["shoe_store"],
    "language": "en-AU"
    }';
    $url = "https://maps.googleapis.com/maps/api/place/add/jsonsensor=false&key=YOUR_API_KEY";
    $results = ProcessCurl($url, $jsonpost);
    echo $results. "<BR>";
 ?> 
```

因此，我需要能够将 json 数据传递给变量 $jsonPost 并将正确的 json 数据返回给 javscript 文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T22:40:40.660

是的，转换为 php 数组，然后转换为 json 数组

[http://php.net/manual/en/function.json-encode.php](http://php.net/manual/en/function.json-encode.php)

[http://www.php.net/manual/en/function.json-decode.php](http://www.php.net/manual/en/function.json-decode.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T23:26:14.967

很难理解你在问什么。你问...

*   如何从网页中获取地点信息？

如果是这样，您使用什么作为接口？

*   如何让您的网页发布到您的 php 文件？

如果是这样，您可以填充一个指向您的 PHP 文件的表单，然后提交信息。

*   还有什么？

你的问题有点不清楚。

# javascript - Firefox，查询选择器和可见的伪选择器

> ID：13388616
> 
> 赞同：18
> 
> 时间：2012-11-14T22:38:55.543
> 
> 标签：javascript, firefox, selectors-api

无论如何使用带有 Firefox 的 querySelector() 或 querySelectorAll() 函数的伪选择器来检测可见性？特别是我希望能够做这样的事情：

```
elem.querySelector('#list .list-item:visible');
elem.querySelector('#section .sub-section:visible .title'); 
```

无需担心浏览器不一致或其他实现，只需 Firefox。谢谢！

**编辑：** Visible 由**display** not **none**和**visibility** not being **hidden**定义。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-11-14T23:19:15.083

由于 :visible 伪选择器没有原生实现，我决定使用 CSS 类来隐藏和显示我的元素，因此只需检查类名而不是可见性。这是我的选择器现在的样子：

```
elem.querySelector('#list .list-item:not(.hidden)'); 
```

现在在 2016 年，我们还可以使用隐藏的 html5 属性，所以这个选择器也可以工作：

```
elem.querySelector('#list .list-item:not([hidden])'); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-11-14T22:46:58.040

不，没有。[CSS 规范](http://www.w3.org/TR/css3-selectors/)没有定义`:visible`（或相关的）选择器，AFAIK Firefox 没有实现非标准的伪选择器。

如果您想自己实现它，请注意 jQuery 如何实现其`:visible`选择器：

> 在 jQuery 1.3.1（和更早版本）中，如果元素的 CSS“显示”不是“无”，它的 CSS“可见性”不是“隐藏”，并且它的类型（如果是输入）不是“隐藏”，则元素是可见的”。在 jQuery 1.3.2 中，如果浏览器报告的 offsetWidth 或 offsetHeight 大于 0，则元素可见。

来源：[http ://docs.jquery.com/Release:jQuery_1.3.2#:visible.2F:hidden_​​Overhauled](http://docs.jquery.com/Release:jQuery_1.3.2#:visible.2F:hidden_Overhauled)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2019-01-18T19:07:13.587

`display:none`用于查找与 CSS 选择器不等价`:visible`的元素

```
:not([style='display:none']) 
```

`visibility:hidden`如果需要，您可以对然后链接选择器执行相同的`:not()`操作。

这是一个[小提琴](http://jsfiddle.net/hrz0t29e/)。

编辑：注意空格和其他标点符号。如果您稍后使用 JQuery 和 操作这些元素`hide()`，并且需要调用相同的函数，那么您将需要链接`:not([style="display: none;"])`到您的 CSS 选择器。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2017-10-18T10:52:06.313

使用纯 javascript，您还可以轻松模拟 jQuery 行为，将您的 querySelector 结果转换为数组，并对其进行过滤：

```
Array.prototype.slice.call(document.querySelectorAll('your selector')) 
```

这将创建一个包含选择器结果的普通数组，您可以将其过滤为：

```
.filter(function (item,index) { return item.style.display!="none" } ); 
```

甚至是其余的 jquery 条件（`item.style.visibility != "hidden" && item.style.opacity > 0 && ...`）。

作为一个班轮：

```
Array.prototype.slice.call(document.querySelectorAll('your selector')).filter(function (item,index) { return item.style.display!="none" } ); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-04-18T17:07:29.413

检查元素是否可见，支持所有主流浏览器：

jQuery：

```
$('.list-item').is(':visible'); 
```

香草JS：

```
function isVisible(elem) {return elem.offsetWidth > 0 || elem.offsetHeight > 0 || elem.getClientRects().length > 0; } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-04-17T07:40:47.943

您可以使用该`offsetParent`值来确定元素是否可见。

```
let parent = document.getElementById('parent');
let allSubChildren = parent.querySelectorAll('.sub-children');

let visibleChildren = Array.prototype.slice.call(allSubChildren).filter(function (item, index) {
    console.log('Element "' + item.textContent + '" is ' + (item.offsetParent !== null ? 'visible' : 'hidden'));
    return item.offsetParent !== null;
  }
);

console.log(visibleChildren);
```

```
.none {
  display: none;
}

.hidden {
  visibility: hidden;
}
```

```
<p><b>item.offsetParent</b> returns <b>null</b> if the element or any parent is not displayed.</p>
<em>Check the console</em>

<div id="parent">
  <div class="children">
    <div class="sub-children">visible</div>
  </div>
  <div class="children hidden">
    <div class="sub-children">visibility hidden doesn't work</div>
  </div>
  <div class="children none">
    <div class="sub-children">display none</div>
  </div>
  <div class="children">
    <div class="sub-children">also visible</div>
  </div>
  <div class="children">
    <div class="sub-children none">also display none</div>
  </div>
</div>

<div id="result">

</div>
```

# php - 如何与sql或codeigniter中的多个表进行交互？

> ID：13388620
> 
> 赞同：0
> 
> 时间：2012-11-14T22:39:20.257
> 
> 标签：php, mysql, sql, join

我想与 codeigniter 中的 4 个表进行交互。我试过但没有结果。我的桌子看起来像：

```
----university----     ----------department----------    -------language--------
| id |  name     |     | id |         name          |    | id |    name        |
------------------     ----------------------------     -----------------------
| 1  | Oxford    |     | 1  | Computer Engineering  |    | 1  |  English       |
| 2  | Harvard   |     | 2  | International Affairs |    | 2  |  German        | 
```

这些表的行只是示例。我的第四张表包含有关其他表的数据。

```
 --------------------------result----------------------------
  | result_id | university_id | department_id | language_id  |
  ------------------------------------------------------------
  |    1      |    4          |       6       |      8       |
  |    2      |    4          |       7       |      4       | 
```

我想同时显示同一行大学名称、部门名称和语言，其中语言 id = 2。我尝试了该代码，但没有任何结果：

```
$this->db->select('university.name,department.name,language.name' );
$this->db->from ( 'university' );
$this->db->from ( 'department' );
$this->db->from ( 'language' );
$this->db->join ( 'result', 'result.university_id = university.id', 'inner' );
$this->db->join ( 'result', 'result.department_id = department.id', 'inner' );
$this->db->join ( 'result', 'result.language_id   = language.id', 'inner'   );
$this->db->where( 'result.language_id', '2' );
$this->db->order_by( 'department.name', 'asc' );

$query = $this->db->get ();

return $query->result (); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T23:38:13.893

尝试从/加入结构

```
$this->db->select('university.name,department.name,language.name' );
$this->db->from ( 'university' );
$this->db->join ( 'result', 'result.university_id = university.id', 'inner' );
$this->db->from ( 'department' );
$this->db->join ( 'result', 'result.department_id = department.id', 'inner' );
$this->db->from ( 'language' );
$this->db->join ( 'result', 'result.language_id   = language.id', 'inner'   );

$this->db->where( 'result.language_id', '2' );
$this->db->order_by( 'department.name', 'asc' );

$query = $this->db->get ();

return $query->result (); 
```

如果它不起作用，请尝试进行 3 个不同的查询并全部合并！

# c# - log4net 创建日志文件但不写入

> ID：13388627
> 
> 赞同：5
> 
> 时间：2012-11-14T22:39:49.433
> 
> 标签：c#, windows, service, windows-services, log4net

我正在尝试将基本日志记录用于 Windows 服务。

我添加了对 log4net 的引用。

我在 AssemblyInfo.cs 中添加了以下内容：

```
[assembly: log4net.Config.XmlConfigurator(Watch = true)] 
```

我在我的 App.config 中添加了以下内容：

```
<?xml version="1.0" encoding="utf-8" ?>
<configuration>
  <configSections>
    <section name="log4net" type="log4net.Config.Log4NetConfigurationSectionHandler,log4net, Version=1.2.10.0, Culture=neutral, PublicKeyToken=1b44e1d426115821" requirePermission="false" />
  </configSections>

  <!-- Log4net Logging Setup -->
  <log4net>
    <appender name="RollingFileAppender" type="log4net.Appender.RollingFileAppender,log4net">
      <file value="c:\\CGSD\\log\\logfile.txt" />
      <appendToFile value="true" />
      <lockingModel type="log4net.Appender.FileAppender+MinimalLock" />
      <layout type="log4net.Layout.PatternLayout">
        <conversionPattern value="%date [%thread] %level %logger - %message%newline" />
      </layout>
      <filter type="log4net.Filter.LevelRangeFilter">
        <levelMin value="INFO" />
        <levelMax value="FATAL" />
      </filter>
    </appender>

    <root>
      <level value="ALL"/>
      <appender-ref ref="RollingFileAppender"/>
    </root>
  </log4net>
</configuration> 
```

我的服务中有以下代码：

```
 log4net.Config.XmlConfigurator.Configure();
    log4net.ILog log = log4net.LogManager.GetLogger(typeof(Program));

    log.Debug("test"); 
```

该文件`c:\CGSD\log\logfile.txt`已创建，但没有写入任何内容。

我整天都在论坛上试图追踪这个问题，但如果我忽略了一个已经发布的解决方案，我深表歉意。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-14T22:55:20.853

您的过滤器级别看起来已配置，`<levelMin value="INFO" />`但您正在测试一条`log.Debug`消息。将您的配置更改为拥有`<levelMin value="DEBUG" />`并重试。如果这不能解决它，可能还有其他配置问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T22:56:54.813

您需要最低级别 `INFO`并尝试使用 level 记录消息`DEBUG`。正如您在文档（http://logging.apache.org/log4net/release/manual/introduction.html）中看到的那样，优先级`DEBUG`低于`INFO`所以您的消息被过滤掉了。

# iis-7 - 重写规则配置...这可能吗？

> ID：13388632
> 
> 赞同：0
> 
> 时间：2012-11-14T22:40:19.460
> 
> 标签：iis-7, url-rewriting

所以我有一组这样的页面：

```
domain.com/product/?_d=1
domain.com/product/?_d=2
domain.com/product/?_d=3 
```

我已经为更干净的 URL 设置了一个重写映射，像这样

```
domain.com/shoes
domain.com/pants
domain.com/gloves 
```

所以现在我有很好的网址供人们使用。但我还想做的是开始将现有 URL 转发到较新的 URL。所以对于任何去的人：

```
domain.com/product/?_d=1 
```

我希望将它们转发或将 URL 重写为：

```
domain.com/shoes 
```

我尝试添加另一个地图，其中包含以下内容：

```
Original: domain.com/product/?_d=1
New Value: domain.com/shoes 
```

我得到了 404。我想我明白为什么，因为我使用的是第一张地图，所以另一张地图将不适用。但是如何为旧 URL 设置地图？或者我可以吗？我知道我的查询字符串值是否像 _d=shoes 我可以做一个重写规则，但它不是那样的。我想我可以将我的页面更改为这种方式，但只是在寻找另一种方式。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T02:31:49.153

I ended up creating a rewrite rule that looked for the pattern to the old URLs and forwarded them to the new URL. Then in my Server side code I just did a check for those legacy variables and redirected with a 301 accordingly.

# meteor - 在发布调用的函数中访问用户/用户 ID

> ID：13388633
> 
> 赞同：5
> 
> 时间：2012-11-14T22:40:25.187
> 
> 标签：meteor

我的代码中有一个`Meteor.publish`，它调用另一个函数，调用另一个函数，依此类推。然后，在最内部的功能中，我需要知道哪个*用户*是活动用户。

`Meteor.user()`不能使用。它说

> Meteor.userId 只能在方法调用中调用。在发布函数中使用 this.userId。

并且`this.userId`在内部函数内部无法访问。

那可以做什么呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-22T13:17:04.587

您不能只`this.userId`在发布方法中分配一个变量然后传递该变量吗？

```
Meteor.publish("my_channel", function() {
  var userId = this.userId;
  myFunction(userId);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-08-11T15:42:22.007

你可以这样称呼它`Reflect.apply(Meteor.call, this, ['myFunctionName'])`

# javascript - JavaScript 正则表达式检查搜索的字符串前面是否没有任何内容或空格

> ID：13388636
> 
> 赞同：0
> 
> 时间：2012-11-14T22:40:33.540
> 
> 标签：javascript, regex

我有以下代码：

```
var requestData = {};

var byPattern = /by=(\w+)/;
var value = byPattern.exec(stringToSearch);
if (value && value.length === 2)
    requestData.by = value[1]; 
```

这个正则表达式的第一个问题是，如果`stringToSearch`是例如“standby=foo”，它匹配并返回“foo”。我希望它在那里失败。我希望正则表达式只有在“by”或*空格之前**没有任何内容*时才匹配。

 *所以我换成了`/^\s*by=(\w+)/`

这更好，但我希望正则表达式匹配`stringToSearch`例如“city=paris by=foo”。它应该匹配并返回“foo”。不是这里的情况：/

有人可以帮我修复正则表达式吗？非常感谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-14T22:44:49.823

神奇的词是`\b`：

```
var byPattern = /\bby=(\w+)/;
console.log(byPattern.exec("by=3"));
console.log(byPattern.exec(" by=3"));
console.log(byPattern.exec("standby=3")); 
```

只有前两个匹配，这是（我认为）你想要的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-14T22:45:35.813

如果您在捕获组之前想要*空格或什么都没有*`( +|^)`，那就是：

```
/( |^)by=(\w+)/ 
```

从技术上讲，我匹配*space 或 nothing*，但效果是一样的。*

# python - 基于每个应用程序的 Django 身份验证

> ID：13388639
> 
> 赞同：3
> 
> 时间：2012-11-14T22:40:52.407
> 
> 标签：python, django, redirect, login, django-views

我刚开始使用 Django，发现在用户身份验证方面我不太了解（使用典型的[django.contrib.auth](https://docs.djangoproject.com/en/dev/topics/auth/#module-django.contrib.auth)机制）。

当我创建一个“[网站](https://docs.djangoproject.com/en/dev/intro/tutorial01/#creating-a-project)”使用

```
django-admin.py startproject mysite 
```

我知道我创建了类似“服务器”的东西。然后，我需要创建一个应用程序（如“[入门](https://docs.djangoproject.com/en/dev/intro/tutorial01/#creating-models)”教程中所述）。我为应用程序创建模型，而不是为服务器创建模型。我的想法（这可能是完全错误的）是应用程序之间是相当独立的（彼此非常隔离）。我为每个应用程序创建我的模型，每个应用程序都有一组不同的“视图”，等等。

但是当涉及到用户管理时，这种管理似乎对整个项目（或“服务器”）来说是全局的：所有的设置都是通过全局`settings.py`文件指定的，内置的登录页面存储在全局`templates/`目录中......如果我有两个应用程序并且我希望它们的登录页面具有不同的方面怎么办？如果在成功登录后，我想根据用户尝试登录的应用程序重定向到*app#1的特定页面或**app#2*的另一个特定页面怎么办？也许我误解了 Django 应用程序背后的整个概念？

基本上，我`mystartapp`在一个名为`myserver`. 我正在使用内置登录视图，将表单发送到`"django.contrib.auth.views.login"`. 使用默认配置，成功登录试图将我重定向到`http://127.0.0.1:8000/accounts/profile/`我没有的。

`settings.py`我可以通过编辑全局文件和全局文件找到解决方法`urls.py`：

```
---------- settings.py ----------
[ . . . ]
# User Logging in Settings
LOGIN_URL = '/login'
LOGIN_REDIRECT_URL = '/'
[ . . . ]
--------------------------------- 
```

和

```
------------ urls.py ------------
urlpatterns = patterns('',
    # Examples:
    # url(r'^$', 'myserver.views.home', name='home'),
    # url(r'^myserver/', include('myserver.foo.urls')),

    # Uncomment the admin/doc line below to enable admin documentation:
    # url(r'^admin/doc/', include('django.contrib.admindocs.urls')),

    #The following line will include the urls for the "mystartapp" application 
    url(r'^s', include('mystartapp.urls', namespace="mystartapp")), #Dirty trick
    url(r'^mystartapp/', include('mystartapp.urls', namespace="mystartapp")),
    # Uncomment the next line to enable the admin:
    url(r'^admin/', include(admin.site.urls)),
    url(r'^login/$', 'django.contrib.auth.views.login'),
)
------------------------------ 
```

这样，多亏了第 10 行（带有`#'Dirty trick'`注释的行），所有到根目录的内容`127.0.0.1:8000/`都将被重定向到与我使用的相同的一组 url `127.0.0.1:8000/mystartapp/`，它与 中的 `LOGIN_REDIRECT_URL = '/'`选项相结合`settings.py`，最终将使浏览器在正确登录后重定向到`127.0.0.1:8080/mystartapp/index.html`，但这似乎并不“干净”。

有没有更好的方法来建立重定向`127.0.0.1:8080/mystartapp/index.html`？肮脏的把戏真的是肮脏的把戏还是它应该起作用的方式？我在这里错过了什么吗？（不过，我很确定最后一个问题的答案是“是的！”）

先感谢您。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T22:48:08.757

`LOGIN_REDIRECT_URL = '/mystartapp/index.html'`在您的情况下使用不起作用有什么原因吗？

* * *

关于应用程序的概念，它们应该是独立的功能部分（这就是它们有时被标记为“可重用”的原因）。但是，一旦将应用程序绑定到项目中，目标就是它们在某个时候确实可以协同工作！

在 的情况下`contrib.auth`，这种可重用性由您使用的参数（例如`LOGIN_URL`或`LOGIN_REDIRECT_URL`）表示，它允许您配置应用程序的行为，使其在您的项目中工作。

例如，对于商家而言，您可以使用多个应用程序来执行与您的项目相关的不同操作：

*   具有您的实际功能（产品、页面...）的应用程序
*   搜索应用程序（如`django-solr`）
*   注册应用程序 ( `django-registration`)
*   用于身份验证、会话的贡献应用程序
*   用于支付的商家应用程序

这些应用程序执行不同的功能，但它们都具有相同的目的并共同构成一个项目。

* * *

如果您需要应用程序以完全独立的方式运行，那么它们首先不应该是同一个项目的一部分！（例如，尽管您可以在项目 P 和 Q 中使用应用程序 A，而仅在 P 中使用应用程序 B）。

# excel - JSP 将查询结果导出到 Excel w/o displaytag

> ID：13388640
> 
> 赞同：1
> 
> 时间：2012-11-14T22:40:55.003
> 
> 标签：excel, jsp, export

我希望将我的查询结果导出到 excel 或 csv。我通常使用显示标签中的功能导出到csv，但是这次......问题是记录将超过20,000，所以我不想显示结果，而只是提供excel文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T22:46:01.930

看看[Java Excel API](http://jexcelapi.sourceforge.net/)。另一种选择是[Apache POI](http://poi.apache.org/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T22:49:03.917

使用 servlet，将 CSV（或 Excel）格式的数据写入响应输出流，并确保在响应中设置适当的内容类型并设置以下标头：

```
response.setHeader("Content-disposition",
                   "attachment; filename=someFile.csv"); 
```

有很多库可以从 Java 生成 CSV 或 Excel。

# c++ - Xcode 4.5.2 致命错误：预编译的头文件已被修改

> ID：13388647
> 
> 赞同：0
> 
> 时间：2012-11-14T22:41:47.687
> 
> 标签：c++, xcode

我整天都在对我的项目进行更改，构建和运行项目，现在在尝试构建时突然出现这个错误：

```
fatal error: file
/Applications/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.8.sdk/System/Library/Frameworks/Foundation.framework/Headers/Foundation.h'
has been modified since the precompiled header was built 
```

*   当我尝试通过转到它来清理项目时，`Product -> Clean`它拒绝清理并给我同样的错误。
*   我已经`.build`从项目文件夹中删除了该目录，强制它重新构建项目并且没有解决任何问题。
*   我已经删除了`~/Library/Developer/Xcode/DerivedData/PROJECT_NAME_HERE`文件夹，也没有帮助。
*   我试过关闭并重新打开 Xcode，这也没有帮助。

我检查了该`Foundation.h header`文件，它显示`Date Modified`10 月 30 日，以及文件夹中的所有其他文件`Headers`，因此它实际上没有被修改。

我构建的其他项目没有此错误。

我在这里不知所措。好像 Xcode 在骗我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T16:18:49.320

好吧，我没有找到一个干净的解决方案来解决这个问题，但它仍然是一个解决方案。该项目受源代码控制，因此我将更改提交到存储库，将整个项目从我的硬盘驱动器中删除，然后从存储库中取回它并解决了问题。

我的猜测是项目中的某个设置或项目旁边存储的数据从未提交到存储库，这就是为什么从存储库中删除和刷新项目可以解决问题的原因。奇怪的是，从项目中删除目录`DerivedData`并`.build`没有解决问题，因此它必须是存储在其他地方的设置。

# c# - .Net 拆分，保留拆分字符

> ID：13388648
> 
> 赞同：-1
> 
> 时间：2012-11-14T22:41:48.390
> 
> 标签：c#, string, parsing, split

> **可能重复：**
> [C# 拆分字符串但保留拆分字符/分隔符](https://stackoverflow.com/questions/521146/c-sharp-split-string-but-keep-split-chars-separators)

是否有一种简单的方法来执行 .Net 字符串 split() 函数，该函数会将原始拆分字符留在结果中？

这样：

```
"some text {that|or} another".Split('{','|','}'); 
```

将产生一个数组：

```
[0] = "some text "
[1] = "{"
[2] = "that"
[3] = "|"
... 
```

最好没有正则表达式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T22:46:33.937

看看**[这篇文章](https://stackoverflow.com/questions/2484919/how-do-i-split-a-string-by-strings-and-include-the-delimiters-using-net)**

正则表达式解决方案的第一个答案，非正则表达式解决方案的第二个答案......

在概念...

```
string source = "123xx456yy789";
foreach (string delimiter in delimiters)
    source = source.Replace(delimiter, ";" + delimiter + ";");
string[] parts = source.Split(';'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T22:50:01.200

您可能可以使用[String.IndexOf Method (String, Int32)](http://msdn.microsoft.com/en-us/library/7cct0x33.aspx)自行查找所有初始分隔符，并将它们与结果合并`String.Split`

# asp.net - Application_End 是否应该在自动应用程序池回收时触发？

> ID：13388649
> 
> 赞同：8
> 
> 时间：2012-11-14T22:41:54.110
> 
> 标签：asp.net, iis, memory-management

我已经阅读[了这个](https://stackoverflow.com/questions/5320180/asp-net-mvc-why-does-my-app-keep-restarting)、[这个](https://stackoverflow.com/questions/844050/rule-of-thumb-for-amount-of-usage-memory-it-takes-to-make-a-worker-process-recyc)、[这个](https://stackoverflow.com/questions/10830633/determine-memory-used-by-asp-net-cache-in-shared-hosting)和[这个](http://blogs.msdn.com/tess/archive/2006/09/06/net-memory-usage-a-restaurant-analogy.aspx)以及其他十几个帖子/博客。

我在共享主机中有一个经常回收的 ASP.Net 应用程序。我们使用 NLog 并在 global.asax 中有以下代码

```
void Application_Start(object sender, EventArgs e) 
{
    NLog.Logger logger = NLog.LogManager.GetCurrentClassLogger();
    logger.Debug("\r\n\r\nAPPLICATION STARTING\r\n\r\n");
}
protected void Application_OnEnd(Object sender, EventArgs e)
{
    NLog.Logger logger = NLog.LogManager.GetCurrentClassLogger();
    logger.Debug("\r\n\r\nAPPLICATION_OnEnd\r\n\r\n");
}

void Application_End(object sender, EventArgs e) 
{
        HttpRuntime runtime = (HttpRuntime)typeof(System.Web.HttpRuntime).InvokeMember("_theRuntime", BindingFlags.NonPublic  | BindingFlags.Static  | BindingFlags.GetField,  null,  null,  null);

if (runtime == null)
    return;

string shutDownMessage = (string)runtime.GetType().InvokeMember("_shutDownMessage",  BindingFlags.NonPublic  | BindingFlags.Instance  | BindingFlags.GetField,  null,  runtime,  null);

string shutDownStack = (string)runtime.GetType().InvokeMember("_shutDownStack",   BindingFlags.NonPublic  | BindingFlags.Instance  | BindingFlags.GetField,  null,  runtime,  null);

ApplicationShutdownReason shutdownReason = System.Web.Hosting.HostingEnvironment.ShutdownReason;

NLog.Logger logger = NLog.LogManager.GetCurrentClassLogger();
logger.Debug(String.Format("\r\n\r\nAPPLICATION END\r\n\r\n_shutDownReason = {2}\r\n\r\n _shutDownMessage = {0}\r\n\r\n_shutDownStack = {1}\r\n\r\n",
                shutDownMessage, shutDownStack, shutdownReason));
}

void Application_Error(object sender, EventArgs e) 
{
    NLog.Logger logger = NLog.LogManager.GetCurrentClassLogger();
    logger.Debug("\r\n\r\nApplication_Error\r\n\r\n");

} 
```

我们的日志文件中到处都是“APPLICATION STARTING”条目，但在这些自发重启期间，既没有`Application_OnEnd`, `Application_End`, 也没有`Application_Error`被触发。我知道它们正在工作，因为有用于触摸 web.config 或 /bin 文件的条目。我们还运行了内存过载测试，并且可以触发`OutOfMemoryException`被捕获的`Application_Error`.

我们正在尝试确定虚拟内存限制是否导致回收。我们在`GC.GetTotalMemory(false)`整个代码中都添加了，但这适用于**所有 .Net**，而不仅仅是我们的应用程序池，对吗？我们也试过

```
var oPerfCounter = new PerformanceCounter();
oPerfCounter.CategoryName = "Process";
oPerfCounter.CounterName = "Virtual Bytes";
oPerfCounter.InstanceName = "iisExpress";
logger.Debug("Virtual Bytes: " + oPerfCounter.RawValue + " bytes"); 
```

但没有共享主机的权限。

我已经监视了开发服务器上的应用程序，该应用程序具有相同的请求，这些请求导致在生产中使用 ANTS Memory Profiler 进行回收，并且似乎找不到罪魁祸首。我们还使用 dev 中附加的调试器运行它，以检查衍生线程中可能导致应用程序中止的未捕获异常。

我的问题是：

*   如何有效监控共享主机中的内存使用情况，以了解我的应用程序在应用程序回收之前消耗了多少？
*   为什么没有调用 global.asax 中的 Application_[End/OnEnd/Error] 处理程序？
*   我还能如何确定导致这些回收的原因？

谢谢。

编辑：基于@Jani Hyytiäinen 的回答

场景：线程#1 开始，然后是线程#2。线程 #1 达到内存限制但继续处理。线程#3 开始。线程 #1 完成，但 #2 在 #1 达到内存限制后处理超过 60 秒。

池然后不优雅地中止？#2 和 #3 会收到什么 http 响应（这些是 AJAX 调用，但我在 Fiddler 中收到 504 错误）？
#3 的请求是否被接受，还是只是排队等待新池启动？
有没有办法知道内存限制已经达到或即将达到？

欢迎任何策略。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-14T23:04:02.230

iis 中有应用程序池关闭时间限制。假设它是 60 秒，并且在共享主机环境中存在应用程序池内存限制。您的应用程序池达到此限制，iis 告诉应用程序池完成当前请求的所有工作。如果所有请求在 60 秒之前完成处理，application_end 将触发，应用程序池将优雅地自行关闭。但是，如果 60 秒过去了，请求仍在处理中，IIS 就会感到不安并终止应用程序池。这次没有 application_end 会触发。同样，不会触发任何错误事件处理程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-28T07:59:43.243

不确定您使用的是哪个版本的 IIS，但在 IIS7.5 上有一堆应用程序池回收事件日志设置，可让您记录应用程序池回收的原因。

在 IIS 中，转到应用程序池并转到相关应用程序池的高级设置。转到回收，有一个名为“生成回收事件日志条目”的子菜单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T22:57:27.557

我查看了我的一个正确触发关闭事件的应用程序，这是 Global.asax.cs 中的签名：

```
protected void Application_End(object sender, EventArgs e)
{
    ApplicationShutdownReason shutdownReason = System.Web.Hosting.HostingEnvironment.ShutdownReason;
    // Write to log
} 
```

我注意到的唯一区别是您的“Application_End”和“Application_Error”方法没有“protected”修饰符。我见过很多情况，反射不适用于私人成员，所以这可能在起作用。

此外，尝试将本地/开发应用程序池上的[空闲超时](https://stackoverflow.com/questions/3891178/how-to-prevent-extend-idletimeout-in-iis-7)设置为较低（如 1 分钟），然后确保您的 Application_End 事件在本地触发。

请注意，默认情况下，IIS 应用程序池会在 20 分钟无请求后回收，因此如果您的应用程序流量较低，您可能会遇到这种情况。此外，一些共享主机提供商将这个“空闲超时”值更改为更低以节省资源。

# jquery-mobile - jQuery mobile 和 mvc4，如何重定向到自定义错误页面替换“错误加载页面”消息

> ID：13388651
> 
> 赞同：1
> 
> 时间：2012-11-14T22:42:13.127
> 
> 标签：jquery-mobile, asp.net-mvc-4

当发生未处理的异常时，我正在尝试设置自定义错误页面（Views/Shared 文件夹中的 Error.vbhtml）。我看到的只是黄色背景上的“加载页面错误”消息。

这些是我到目前为止为实现结果所做的工作：

1.  我在 web.config 中设置了 customErrors 模式 =“On”
2.  检查 FilterConfig.vb 中是否存在 filters.Add(New HandleErrorAttribute())
3.  抛出异常，使用 firebug 的 Net 选项卡查找错误发生的页面，可以看到 HTML 选项卡中有 Error.vbhtml 中的自定义消息。

我假设由于 jQuery mobile 依赖 ajax 进行页面导航，因此错误页面由于某种原因没有显示。如何显示该页面？有什么想法吗？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T02:24:44.117

通过将以下 javascript 代码添加到 _Layout.vbhtml 中解决了这个问题

```
 <script type="text/javascript">
          $(document).live("pagechangefailed", function (e, data) {
            //alert("pagechangefailed live");
            var url = '@Url.Action("CustomError", "Account")';
            window.location.href = url;  

          }); 
        </script> 
```

其中 CustomError 是 AccountController 中新创建的操作。

# asp.net-mvc - 在 ASP.NET MVC4 中使用 Google OAuth 时出现 MembershipCreateUserException

> ID：13388659
> 
> 赞同：2
> 
> 时间：2012-11-14T22:43:24.457
> 
> 标签：asp.net-mvc, oauth

我在让 Google OAuth 与 Visual Studio 2012 中的默认 MVC4 Internet 应用程序项目模板一起工作时遇到问题。

在重定向到 Google 并随后注册用户名后，我在 AccountController 的第 276 行收到了**MembershipCreateUserException ，并显示以下消息：**

> 提供的用户名无效。

失败的代码行是：

```
OAuthWebSecurity.CreateOrUpdateAccount(provider, providerUserId, model.UserName); 
```

我检查了数据库，并且 UserProfiles 表包含我按预期输入的用户名，并且我尝试了各种用户名组合。

我是否错过了一些东西，因为源代码中的链接文章都没有建议其他需要配置的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-28T14:02:31.037

首先，我想在这里留下我的经验。(asp.net mvc4)

1.  更改 SimpleMembership 提供程序的 dbcontext。转到过滤器文件夹-> 打开 InitializeSimpleMembershipAttribute。然后做这样的改变。因此它将在您的数据库中包含成员资格表。

    ```
    WebSecurity.InitializeDatabaseConnection("ChangeYourDbContext", "UserProfile", "UserId", "UserName", autoCreateTables: true); 
    ```

2.  去AccontController。查找 UserContext，默认情况下使用 defaultConnection 字符串。转到 UserContext 声明 ( `f12`)。并将 UserContext Connectionstring 覆盖到您的实际 Dbcontext

    ```
    public UsersContext(): base("YourAcutalDbContext")
    {

    } 
    ```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-30T23:38:01.140

我想我想通了。OAuthWebSecurity.CreateOrUpdateAccount 需要在 Users 表中有一个用户。

问题是，该方法将在表中“创建”一条新记录，该记录`webpages_OAuthMembership`具有用户表的外键。

因此，为了使您的调用正常工作，要么首先通过 WebSecurity.CreateAccount 创建一个新用户，要么编写一些手动代码将用户添加到表中。

我选择了 WebSecurity.CreateAccount 并使用 GeneratePassword 方法来解决这个问题。

希望能帮助到你。

# delphi - TClientDataSet.Cancel 丢失 TDBMemo 值

> ID：13388662
> 
> 赞同：2
> 
> 时间：2012-11-14T22:43:36.533
> 
> 标签：delphi, delphi-xe2, tclientdataset, data-loss

我有一个带有以下控件的表单：`TDBEdit`, `TDBMemo`, `TDataSource`,`TClientDataSet`

如果用户编辑字段，然后单击表单上的一个按钮，该按钮仅调用该`MyCDS.Cancel`方法（取消编辑），则`TDBEdit`字段将恢复为其原始值，但`TDBMemo`字段不会恢复（它们被设置为空白值）。

由`TClientDataSet`MSSQLServer 2008 数据库填充。`TDBEdit`字段在`nvarchar(255)`数据库中，并且`TDBMemo`是`nvarchar(max)`或`xml`字段。

查看 Debug Inspector (ctrl+F7, MyCDS.FieldByName('afield'), Inspect) 中的值显示以下`nvarchar(max)`字段之一：

*   数据大小 = 0
*   数据类型 = ftWideMemo
*   大小 = 1

无论底层字段是否有数据，所有的`nvarchar(max)`and字段都是一样的。`xml`

`nvarchar(max)`（被视为 a `ftWideMemo`）和`TDBMemo`控件之间似乎存在不兼容性。

有没有人见过这样的问题？您对如何解决它有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T23:09:26.983

如果有人感兴趣，问题是`TClientDataSet`组件中的错误。仅当您克隆数据集，没有 a`Provider`并关闭时，才会出现此问题`LogChanges`。如果您在克隆数据集上编辑记录，然后取消编辑，则任何*备注*字段都会丢失其值。

由于您不一定要`Provider`在基于文件的应用程序中使用 a，因此启用`LogChanges`. 但是，要解决*备注*字段的限制，您可以保持`LogChanges`打开状态，然后`MergeChangeLog`在更改克隆数据集的操作之后调用。

我创建了一个演示该问题的程序。请参阅 Embarcadero 事件 QC#110511。

# c - 如何打开文件以写入其他进程可以读取的文件？

> ID：13388672
> 
> 赞同：1
> 
> 时间：2012-11-14T22:44:17.820
> 
> 标签：c, visual-studio-2010, visual-studio, file-io

我想让我的程序打开一个文本文件进行日志记录。当我的程序正在运行（并写入/更新文件）时，我希望能够在另一个程序（记事本、ultraedit 等）中打开文件并查看当前已写入文件的所有内容。

我尝试使用`_fsopen`with `_SH_DENYWR`，虽然我确实可以打开日志文件，但在我的程序退出之前，该文件是空白的/大小为 0。我错过了什么？

# email - 用于发送每日自动电子邮件的 Amazon SES 与 Newsletter 服务（例如 MailChimp）

> ID：13388686
> 
> 赞同：2
> 
> 时间：2012-11-14T22:45:38.763
> 
> 标签：email, mailchimp, amazon-ses

我目前正在开发的系统为所有用户发送“每日报告”，对于我的普通电子邮件后端，我使用 Amazon SES 发送此类电子邮件。

问题是，通过 Amazon SES 发送此类电子邮件（不是真正的时事通讯，而是状态更新）是一种更好的做法，还是应该迁移到 MailChimp 或 Campaign Monitor 等服务提供商。

Ps：现在，我使用[django-mailer](https://github.com/jtauber/django-mailer)异步发送电子邮件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-18T11:09:28.080

如果您已经准备好使用 Amazon SES 的所有设置，请坚持使用。这确实是交易电子邮件的绝佳选择。Mailchimp 确实更适合时事通讯，如果 mailchimp 用户想要发送交易电子邮件，他会被称为 mailchimp 姊妹服务[Mandrill](http://mandrill.com/)。

我想到的将现有系统从 Amazon SES 迁移到 Mandrill 的唯一优势是，在 Mandrill 中，您可以将“发件人”电子邮件设置为您想要的任何内容。通常这对于“发送给朋友”功能很有用。在 Amazon SES 中，您目前不能这样做。

# facebook-opengraph - 为什么我不能将开发者添加到 Facebook 应用程序？

> ID：13388689
> 
> 赞同：1
> 
> 时间：2012-11-14T22:45:51.913
> 
> 标签：facebook-opengraph, facebook-apps, roles

我的客户已达到他们的好友上限，所以我无法成为好友。在角色下的开发人员部分：https://developers.facebook.com/apps/[longId]/roles

我想将自己添加为开发人员。在我键入时，该字段似乎正在检查现有朋友。当我完成添加我的电子邮件时，它说我不是 Facebook 用户。不对。

有没有人遇到过这个？看来我需要成为朋友才能在应用程序上进行测试。

# c++ - Arduino - 将拆分字符串与另一个字符串进行比较

> ID：13388694
> 
> 赞同：0
> 
> 时间：2012-11-14T22:46:11.990
> 
> 标签：c++, split, serial-port, arduino, string-comparison

我正在尝试将爆炸的字符串与 Arduino 中的另一个字符串进行比较，但它不起作用。从串行端口读取拆分的字符串。

首先，这些是我用来分解字符串的函数：

```
int count_delimiters(char str[], const char* delimiters) {
    int i, j, result = 0;
    for (i = 0; i < strlen(str); ++i) {
        for (j = 0; j < strlen(delimiters); ++j) {
            if (str[i] == delimiters[j]) {
                ++result;
            }
        }
    }
    return (result + 1);
}

char** split(char str[], const char* delimiters) {
    int result_size = count_delimiters(str, delimiters);
    int i = 0;
    char* result[result_size];
    char* pch = strtok(str, ",");

    while (pch != NULL)
    {
      result[i] = pch;
      pch = strtok(NULL, ",");
      ++i;
    }

    return result;
} 
```

我尝试将分解的字符串与另一个字符串进行比较的部分如下所示：

```
char input_array[input.length()];
input.toCharArray(input_array, (input.length() + 1));
exploded = split(input_array, ",");

if ("$test" == exploded[0]) {
    Serial.println("match"); // This code is never reached.
} 
```

当我在串行监视器中输入**$test,other**时，我希望打印出匹配项，但没有打印任何内容。如果我这样做，它应该`Serial.println(exploded[0]);`输出**$test**。我究竟做错了什么？

我已经尝试寻找不可打印的字符，例如`\r`,`\n`和`\0`，但它似乎不包含任何这些字符，因为当我检查 "$test\r" 或其他字符时，它仍然没有返回 true。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T22:51:15.423

在这一行：

```
if ("$test" == exploded[0]) 
```

使用 strcmp 而不是按 == 进行比较。

# mysql - 有没有机会加快这个简单的 MySQL 查询？

> ID：13388701
> 
> 赞同：1
> 
> 时间：2012-11-14T22:47:00.113
> 
> 标签：mysql, performance, query-optimization

遇到这个查询时，它会搜索一个包含大约 213k 行的重要表。查询的目的是上报一个月的流量数据。该月每一天的流量。以及每天的十进制值的总和。这个查询经常运行，所以我需要尽可能优化它。目前需要平均。2秒..

SQL小提琴：[http ://sqlfiddle.com/#!2/171f5/3/0](http://sqlfiddle.com/#!2/171f5/3/0)

所有建议将不胜感激！谢谢你。

**询问：**

```
SELECT `date_day`, COUNT(*) AS num, SUM(decval) AS sum_decval FROM (`tbl_traffic`)
WHERE `uuid` = '1' AND `date_year` = '2012' AND `date_month` = '11'
GROUP BY `date_day`; 
```

**解释结果：**

```
id: 1
select_type: SIMPLE
table: adb1_analytics
type: ref
possible_keys: keys1,keys2,keys3
key: keys1
key_len: 7
ref: const,const,const
rows: 106693
Extra: Using where
1 row in set (0.13 sec) 
```

**表结构：**

```
CREATE TABLE IF NOT EXISTS `tbl_traffic` (
  `id` int(100) unsigned NOT NULL AUTO_INCREMENT,
  `uuid` int(100) unsigned NOT NULL,
  `country` char(2) CHARACTER SET latin1 DEFAULT NULL,
  `browser` varchar(50) CHARACTER SET latin1 DEFAULT NULL,
  `platform` varchar(50) CHARACTER SET latin1 DEFAULT NULL,
  `referrer` varchar(255) COLLATE utf8_bin DEFAULT NULL,
  `decval` decimal(15,5) NOT NULL,
  `date_year` smallint(4) unsigned NOT NULL,
  `date_month` tinyint(2) unsigned NOT NULL,
  `date_day` tinyint(2) unsigned NOT NULL,
  PRIMARY KEY (`id`),
  KEY `keys1` (`uuid`,`date_year`,`date_month`,`date_day`),
  KEY `keys2` (`date_year`,`date_month`,`referrer`),
  KEY `keys3` (`date_year`,`date_month`,`country`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T22:49:35.553

您没有有效的索引`date_day`。

我建议专门为您要获取和计算的内容创建一个密钥：`(date_day, decval)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T22:52:25.220

每当您执行“分组依据”时，您都要求进行全表扫描。

[http://dev.mysql.com/doc/refman/5.0/en/group-by-optimization.html](http://dev.mysql.com/doc/refman/5.0/en/group-by-optimization.html)

如果您无法更好地对其进行索引（请参阅@njk 答案），那么您可能需要选择您的特定值，然后对子集进行分组、求和等。如果不出意外，至少它将是一个较小的排序集。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T23:00:20.770

使用 count(id) 并在 date_day 和 decval 上添加键。两个领域的覆盖键可能会更好

# node.js - 什么是 TTY，如何在 Ubuntu 上启用它？

> ID：13388704
> 
> 赞同：6
> 
> 时间：2012-11-14T22:47:28.353
> 
> 标签：node.js, ubuntu, stdout, tty

我目前正在设置一个 node.js 服务器，我在这里使用调试模块[https://github.com/visionmedia/debug](https://github.com/visionmedia/debug)。

我正在尝试启用它，以便我可以在输出中获取彩色调试信息，但是我的终端看起来像底部的最后一个终端屏幕，它说：

```
When stdout is not a TTY, Date#toUTCString() is used, making it more useful for logging the debug information as shown below: 
```

任何人都可以对此有所了解吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-03-12T19:01:29.413

tty 是那些将连接到标准输入的终端名称打印（或显示）到标准输出的时髦 Unix 命令之一。

这些通常用作访问计算机以修复问题的一种方式，而无需实际登录可能已损坏的桌面。

相关：命令行中的 tty7 是什么？

默认情况下，Ubuntu 有 7 个 tty。

1-6 仅是命令行，7 运行您的 X 会话（您的普通桌面）。

要访问它们，请使用此键盘快捷键：

Ctrl + Alt + F1

（将 F1 更改为 F1-F6 以访问您需要的终端）

要回到您的 X 会话（普通桌面），

Ctrl + Alt + F7

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T23:14:48.377

TTY 是[终端](http://en.wikipedia.org/wiki/Tty_%28Unix%29)或命令提示符本身。

屏幕截图展示了`stdout`定向到终端/TTY（带有颜色和时间差异）与重定向到其他地方（例如文件（通过`> out`和带有时间戳）时）的不同结果。

它[确定](https://github.com/visionmedia/debug/blob/0.7.0/lib/debug.js#L54)与 .一起使用的格式[`tty.isatty`](http://nodejs.org/api/tty.html#tty_tty_isatty_fd)。

请注意，并非所有终端都支持用于[显示颜色的](https://github.com/visionmedia/debug/blob/master/lib/debug.js#L115)[ANSI 转义码](http://en.wikipedia.org/wiki/ANSI_escape_code#Support)。

# java - 从 SVG 文件创建非缓冲 java.awt.Image

> ID：13388706
> 
> 赞同：2
> 
> 时间：2012-11-14T22:47:34.000
> 
> 标签：java, svg, batik

我有一些现有代码，看起来很像[Swing & Batik 上的解决方案：从 SVG 文件创建 ImageIcon？](https://stackoverflow.com/questions/2495501/swing-batik-create-an-imageicon-from-an-svg-file)

但是我的图像的目的地是 PDF，当你放大 PDF 时，你会看到像素，这让我很烦恼。如果源数据和目标数据都是矢量图形，应该可以直接渲染。

我们正在使用的库（iText）采用 java.awt.Image，但我似乎无法弄清楚如何获取呈现 SVG 的 java.awt.Image。蜡染有办法做到这一点吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T04:08:02.620

好吧，这就是我最终要做的。`java.awt.Image`肯定是一条死胡同。有一个解决方案是将 a 包装`PdfTemplate`在 an 中，`ImgTemplate`以便它可以用作 iText `Image`。

（我必须把它放在知道它大小的东西里，因为它被用在桌子上，否则布局会变得非常疯狂。An`Image`似乎知道这一点。）

```
public class SvgHelper {
    private final SAXSVGDocumentFactory factory;
    private final GVTBuilder builder;
    private final BridgeContext bridgeContext;

    public SvgHelper() {
        factory = new SAXSVGDocumentFactory(
            XMLResourceDescriptor.getXMLParserClassName());
        UserAgent userAgent = new UserAgentAdapter();
        DocumentLoader loader = new DocumentLoader(userAgent);
        bridgeContext = new BridgeContext(userAgent, loader);
        bridgeContext.setDynamicState(BridgeContext.STATIC);
        builder = new GVTBuilder();
    }

    public Image createSvgImage(PdfContentByte contentByte, URL resource,
                                float maxPointWidth, float maxPointHeight) {
        Image image = drawUnscaledSvg(contentByte, resource);
        image.scaleToFit(maxPointWidth, maxPointHeight);
        return image;
    }

    public Image drawUnscaledSvg(PdfContentByte contentByte, URL resource) {
        GraphicsNode imageGraphics;
        try {
            SVGDocument imageDocument = factory.createSVGDocument(resource.toString());
            imageGraphics = builder.build(bridgeContext, imageDocument);
        } catch (IOException e) {
            throw new RuntimeException("Couldn't load SVG resource", e);
        }

        float width = (float) imageGraphics.getBounds().getWidth();
        float height = (float) imageGraphics.getBounds().getHeight();

        PdfTemplate template = contentByte.createTemplate(width, height);
        Graphics2D graphics = template.createGraphics(width, height);
        try {
            // SVGs can have their corner at coordinates other than (0,0).
            Rectangle2D bounds = imageGraphics.getBounds();

            //TODO: Is this in the right coordinate space even?
            graphics.translate(-bounds.getX(), -bounds.getY());

            imageGraphics.paint(graphics);

            return new ImgTemplate(template);
        } catch (BadElementException e) {
            throw new RuntimeException("Couldn't generate PDF from SVG", e);
        } finally {
            graphics.dispose();
        }
    }
} 
```

# windows - 如何完成我的批处理文件代码？

> ID：13388709
> 
> 赞同：-2
> 
> 时间：2012-11-14T22:48:06.400
> 
> 标签：windows, batch-file, batch-processing

我想在批处理文件中执行以下操作：

我想打开 pdf，如果它存在于 USB 上。如果此文件不存在，则从另一个位置启动 pdf（如果存在）。

例如

```
:: Searchs USB Drive Letter
For %%I In (G,D,E,F,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z) Do If Exist "%%I:\Document1.pdf" (

xcopy /H /Y /C /R "%%I:\Document1.pdf" "%tmp%"
start %tmp%\Document1.pdf
) 
```

如果插入，我想打开 pdf 文档（来自 USB）。启动此 .bat 并插入 USB 后，从临时文件夹启动 pdf。我希望这在批处理中没有任何错误消息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T08:46:18.120

从您发布的内容来看，我只能猜测您是在插入 USB 驱动器时尝试运行批处理文件？

我很确定没有本地方法可以批量执行此操作，因此我只能建议您在批处理上使用无限循环并使其始终运行，以检测任何插入的内容。

```
:LOOP
:: Searchs USB Drive Letter
For %%I In (G,D,E,F,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z) Do (
    If Exist "%%I:\Document1.pdf" (
    xcopy /H /Y /C /R "%%I:\Document1.pdf" "%tmp%"
    start %tmp%\Document1.pdf
    )
)
REM Use timeout /t 5 instead of ping if you have Vista or above
ping 127.0.0.1 -n 5
goto :LOOP 
```

而不是循环所有可能的驱动器号，我建议将你的`for`循环改为这个，所以它只查看当前存在的驱动器

```
for /f "skip=2 delims=" %%I in ('wmic logicaldisk get caption') do ( 
```

我跳过了前两行，因为第一行是列标题，第二行是 99% 肯定是`C:\`您未包含在脚本中的驱动器。

# javascript - 创建元素后运行回调

> ID：13388711
> 
> 赞同：1
> 
> 时间：2012-11-14T22:48:22.967
> 
> 标签：javascript, jquery, knockout.js

**问题：**我正在通过 JS 模板系统创建一个元素。在该模板中，我指定了一个 ID。创建该 ID 后，jQuery 是否有办法在创建特定元素时触发回调？

带有 Knockoutjs 的示例 JS/HTML：

```
function Dialogs(){
    this.createDialog = function(id){
        //alert('creating dialog');
        // If i add a setTimeout here, it will work.
            $("#" + id).dialog({
                autoOpen: true,
                resizable: false,
                width: 360,
                height: 200,
                dialogClass: 'systemError',
                modal: true,
                closeText: 'hide'
            });

    };
    this.data = ko.observableArray([
        new Dialog("Demo", 'htmlContent', { 
            id: 'testDialog',
            success: function() {}, 
            error: function(){},
            actions:[
                new DialogAction('continue', { 
                    className: 'foo', 
                    id: 'bar',
                    events: { 
                        click: function() { 
                            console.log('do stuff');
                        }
                    }
                })
            ] 
        })

    ]);
}
function Dialog (name, htmlContent, options) {
    options = options || {};
    this.id = options['id'] || '';
    this.name = ko.observable(name || "");
    this.className = options['className'] || '';
    this.htmlContent = ko.observable( htmlContent || "");
    this.successCallback = options['success'] || this.close;
    this.errorCallback = options['error'] || this.throwError
    this.actions = options['actions'] || [];
}

function DialogAction (name, options) {
    options = options || {};
    this.name = ko.observable(name || "");
    this.className = options['className'] || null;
    this.id = options['id'] || null;
    this.successCallback = options['success'] || null;
    this.errorCallback=  options['error'] || null;

}
ko.applyBindings(new Dialogs()); 
```

的HTML：

```
<div id="dialog-holder" data-bind="foreach: Dialogs.data()">
      <div class="systemErrorDialog" data-bind="template: { name: 'dialog-system-error', data: $data, afterRender: Global.Dialogs.createDialog($data.id) }"></div>
</div>

<script type="text/template" id="dialog-system-error">
    <div data-bind="html:htmlContent(), attr:{id: id, class:className,title:name()}">
      <div class="actions" data-bind="foreach: actions"> 
        <div data-bind="attr:{id: name(), class: className}"></div>
      </div> 
    </div>
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T22:52:43.703

您可以运行一个时间间隔来检查 dom 中的 id，然后在它存在时触发一个事件。

```
var intv = setInterval(function(){
 var $el = $("#myId");

 if ( $el.length > 0 ) {
   clearInterval(intv);
   doSomething();
 }
}, 500); 
```

如果从未显示，可能应该在事件 10 秒后清除间隔：

```
setTimeout(function(){
  clearInterval(intv);
}, 10000); 
```

# crystal-reports - SAP 子报表将打印到 PDF，但不会打印到查看器或打印机

> ID：13388712
> 
> 赞同：0
> 
> 时间：2012-11-14T22:48:23.063
> 
> 标签：crystal-reports, reportviewer

我有两个不同的 SAP Crystal Reports，一个有子报表，另一个没有。无论出于何种原因，简单的 CR 都可以很好地打印到打印机、PDF 和查看器。无论出于何种原因，带有子报表的 CR 都只能打印为 PDF。这让我相信报告本身没有任何内在错误，否则当我保存为 PDF 时它不会工作。

我的代码片段如下（在 VB 中）：

```
 Select Case PrintMedia
            Case PrintType.Printer
                crOrderPrintout.PrintToPrinter(1, False, 0, 0)
            Case PrintType.Viewer
                Dim frmReportViewer As New frmReportViewer
                frmReportViewer.CrystalReportViewer1.ReportSource = crOrderPrintout
                frmReportViewer.ShowDialog()
            Case PrintType.File
                crOrderPrintout.ExportToDisk(CrystalDecisions.Shared.ExportFormatType.PortableDocFormat, String.Format("C:\Documents and Settings\{0}\Desktop\{1}.pdf", mdlSharedVars.StripDomainFromFullUsername(WindowsIdentity.GetCurrent.Name), ReceiptID))
            Case Else
                crOrderPrintout.PrintToPrinter(1, False, 0, 0)
        End Select 
```

为了澄清，PrintMedia 是一个变量，其类型是我的自定义枚举 PrintType。

当我尝试在查看器中显示带有子报表的报表或打印到打印机时，我得到一个“索引超出范围。必须是非负数并且小于集合的大小。参数：索引。” 错误。然而，无论 PrintMedia 是什么，简单的非子报表 CR 都可以正常工作。

不要以为有人有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T22:51:20.707

在与这个问题进行了比我想象的更长的斗争之后，事实证明水晶报告显示字符串中的一个字段存在问题。基本上，我从头开始编写报告，逐个添加以尝试隔离错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-17T09:36:02.690

您可以在现成的 Crystal 查看器或 Crystal Reports 本身中试用该报表吗？它有效吗？

也许尝试将页面设置中的打印机选项设置为“无打印机（优化屏幕显示）”

# ruby-on-rails - Rails 包罗万象/通配路线

> ID：13388715
> 
> 赞同：26
> 
> 时间：2012-11-14T22:48:28.910
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我正在使用 rails 3.0.14，并且正在使用资源丰富的样式构建 routes.rb。我想要一个通配符路由来捕获所有与所述任何路由都不匹配的请求。

构建这样一条路线的合适方法是什么？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-11-14T22:58:33.840

放

```
match '*path' => 'your_controller#your_action' 
```

在 routes.rb 文件的末尾。这很重要，因为路线是自上而下逐步进行的。

另请参阅[http://guides.rubyonrails.org/routing.html](http://guides.rubyonrails.org/routing.html) -> 3.10

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2014-11-14T17:19:59.257

对于 Rail 4，您需要指定请求类型：

```
match "*path", to: "application#custom_action", via: :all 
```

正如其他人所说，将其放在您的路线文件的最底部。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2016-08-24T10:16:44.260

在`match '*path'`语句中完全使用“路径”不是强制性的。您可以在那里设置任何令牌：

```
get "*string1" 
```

或者

```
get "*string2" 
```

Rails 会将您真正的 HTTP 查询分配给以您的令牌命名的参数，例如：

```
get "*user" => "users#show" 
```

在控制台中：

```
Started GET "/john" ....  
Processing by UsersController#show as HTML 
Parameters: {"user"=>"john"} 
```

您可以使用多个星号，例如`get "*id*user"`. 但在这种情况下，您会得到一些不可预知的结果，因为 Rails “以直观的方式”处理 2 个或更多星号 - 有关更多信息，请参阅[http://guides.rubyonrails.org/routing.html#route-globbing-and-wildcard -段](http://guides.rubyonrails.org/routing.html#route-globbing-and-wildcard-segments)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-12-04T16:36:21.110

除了@steel 和@awenkhh，我建议将以下内容添加到该路由的控制器操作中

```
respond_to do |format|
  format.html
  # other formats you already support
  format.all { render text: '' }
end 
```

否则，您会遇到一些`ActionView::MissingTemplate: Missing template`出乎意料的格式错误。

[咆哮]对于那些尝试错误攻击向量`/wp-admin/css/wp-admin.css`等的人特别有帮助。我似乎每天收到大约 100 个请求`/wp-admin/*`，来自超级讨厌的人，他们显然希望我获得更昂贵的 Rollbar 帐户计划。[/rant]

# c++ - C ++程序不读取公式

> ID：13388716
> 
> 赞同：0
> 
> 时间：2012-11-14T22:48:37.287
> 
> 标签：c++, math, loops, numbers

**我一直在处理的程序应该输出以下内容： * 所需的油漆数量 * 所需的劳动时间 * 油漆的成本 * 人工费用 * 油漆工作的总成本 但是，它显示0 在每个领域.. 我现在做错了什么？您的帮助将不胜感激。**

这是我的代码：

```
//Headers
#include <iostream>
#include <fstream>
#include <cmath>
#include <cstdlib>
#include <iomanip>

using namespace std;

void PaintJobEstimator(double gallonprice, double calc)
{
    float numBucket=0;
    float hours=0;
    float bucketCost=0;
    float laborCharges=0;
    float totalCost=0;
    //calculates number of buckets of paint (gallons) needed
    numBucket=numBucket+calc*(1/115);
    //calculates paint cost
    bucketCost=bucketCost+gallonprice*numBucket;
    //calculates labor hour
    hours=hours+calc*(8/115);
    //calculates labor charges
    laborCharges=hours*18;
    //calculates total cost
    totalCost=totalCost+bucketCost+laborCharges;
    //Console output
    cout << "The number of Gallons of paint required:\t" << setprecision(2) << numBucket << endl;
    cout << "The hours of labor required:\t" << setprecision(2) << hours << " hrs" << endl;
    cout << "The labor charges:\t$" << setprecision(2) << laborCharges << endl;
    cout << "The cost of the paint:\t$" << setprecision(2) << bucketCost << endl;
    cout << "The total cost of the paint job:\t$" << setprecision(2) << totalCost << endl;
}

void main ()
{
    int rooms;
    double calc=0;
    double wallspace;
    double gallonprice;
    cout << "=========================================================\n";
    cout << "___________________Paint Job Estimator___________________\n";
    cout << "_________________________________________________________\n";
    cout << endl;
    cout << "Enter the number of rooms: ";
    cin >> rooms;
    while (rooms<1) //validates rooms
    {
        cout << "Invalid entry, enter one or more rooms:\t";
        cin >> rooms;
    }
    for (int roomNum=1;
        roomNum<=rooms;
        roomNum++)
    {
        cout << "Enter the wall space in square meters for room " << roomNum << ":\t" << endl;
        cin >> wallspace;
        while (wallspace < 0.01)//validates wallspace
        {
            cout << "Invalid entry, please re-enter the wall area for room " << roomNum << ":\t";
            cin >> wallspace;
        }
        calc=calc+wallspace;
    }//end loop
    cout << "\nEnter price of the paint per gallon: ";
    cin >> gallonprice;
    if (gallonprice <10) //validates price per gallon
    {
        cout << "Invalid entry, Reenter price at a $10.00 minimum: ";
        cin >> gallonprice;
    }
    PaintJobEstimator(gallonprice,wallspace);
    system ("pause");
} 
```

这是控制台的屏幕截图：![在此处输入图像描述](../Images/f5c08ea517f9598a72ab2de4c5e348c1.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-14T22:51:30.923

您在某些计算中乘以零。例如，在以下代码行中：

```
numBucket=numBucket+calc*(1/115); 
```

您将 1/115 放在括号中，由于整数除法，它的计算结果为零。要达到预期的效果，请尝试：

```
numBucket = calc / 115.0f; 
```

# python - 为什么我可以使用 python 而不是 ./ 运行 python 脚本？

> ID：13388717
> 
> 赞同：0
> 
> 时间：2012-11-14T22:48:45.133
> 
> 标签：python

谁能告诉我为什么我不能使用 ./ 运行 python 但能够使用 python

```
-rwxr-xr-x@ 1 xxxx  staff   258 14 Nov 14:08 ltry.py
-rwxr-xr-x@ 1 xxxx  staff  1037 14 Nov 11:20 pdTry.py
 xxxx-MacBook-Pro:python xxxx$ ./ltry.py
 File "./ltry.py", line 10
 print "Hello you"
                 ^
 SyntaxError: invalid syntax
xxxx-MacBook-Pro:python xxxx$ python ltry.py
Hello you
['ltry.py'] 
```

另外，我安装了python IDLE，但我无法尝试打印，为什么？

```
Python 3.3.0 (v3.3.0:bd8afb90ebf2, Sep 29 2012, 01:25:11) 
[GCC 4.2.1 (Apple Inc. build 5666) (dot 3)] on darwin
Type "copyright", "credits" or "license()" for more information.
>>> print 'eeere'
SyntaxError: invalid syntax
>>> print "helooe"
SyntaxError: invalid syntax 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-14T22:50:06.580

对于第二个问题，您在那里使用 Python 3.X，其中打印的语法从您使用的 2.X 样式更改（`print 'string'`在`print('string')`3.X 中）。我敢打赌，对于第一个问题，您的机器上安装了 2 个 Python，一个 3.X，被称为 .py 文件的默认程序，一个 2.X，当您明确调用时调用蟒蛇。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T22:54:40.310

对于问题一：您是否在脚本的第一行中设置了正确的 python 解释器路径，以 开头`#!`？

在我的机器（Linux）上，例如：

```
#!/usr/bin/python 
```

# java - Java 持久性继承中的序列号

> ID：13388718
> 
> 赞同：0
> 
> 时间：2012-11-14T22:48:50.777
> 
> 标签：java, jakarta-ee, jpa, persistent

使用 JSF 和 JPA 开发应用程序。

```
@Entity
@Inheritance(strategy = InheritanceType.SINGLE_TABLE) 
```

Bill 是父类，是 OpdBill、PharmacyBill 等的子类。

多个用户可能会尝试同时持久化。

为 Bill 类生成序列号很容易，但这在功能中不是必需的。我们如何为子类单独自动生成序列号？（不需要ID，只需序列号）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T23:22:14.943

据我所知，JPA 无法为非 ID 列创建这样的序列，但您可以做一些像这样的肮脏解决方法：

生成第二个实体，如

```
@Entity
public class OpdSequence {
  @Id
  @GeneratedValue
  private Long id;
} 
```

并为您的 OpdBill 创建一个 1-1

```
@Entity 
public class OpdBill extends Bill {
  @OneToOne
  private OpdSequence opdId;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T22:58:50.867

如果 OpdBill 是账单，那么两者必须共享相同的 ID 字段，并且 Hibernate 必须能够通过它们的 ID 区分两个账单（无论它们的类是什么）。因此，所有子类必须与基类共享相同的 ID 生成，并且 Bill 及其子类的所有实例的 ID 必须是唯一的。

# java - 由于不可见字符，PHP JSON to Java 无法解析

> ID：13388720
> 
> 赞同：0
> 
> 时间：2012-11-14T22:48:56.267
> 
> 标签：java, php, android, json, encode

我将一些 SQL 结果从 PHP 返回到 android。

我将 JSON 响应编码如下：

```
$json_string = json_encode($rows);
$json_string = str_replace("\\", "", $json_string, $i);
return $json_string; 
```

一旦我将此回显到 android，我会得到一个字符串，当我将其放入 JSON 验证器时会给出有效的 JSON 代码。

但是......一旦我尝试将此有效字符串传递到新的 JSONObject 或 JSONArray 中，我会收到无法转换的错误消息。

我确信这是因为空白不可见字符。

我已经使用 Java 中的以下内容将我的 PHP 和 Java 编码为 utf-8 字符集...

```
BufferedReader reader = new BufferedReader(new InputStreamReader(
                is, "utf-8"), 8); 
```

对于 PHP...

```
header('Content-Type: text/html; charset=utf-8'); 
```

但这并没有解决问题。

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-14T22:54:06.210

那是因为你操纵了一个有效的 json 表示

> ```
> $json_string = str_replace("\\", "", $json_string, $i); 
> ```

不要那样做，json_encode 已经产生了一个有效的 json。

并且`Content-Type`应该仅`application/json`用于 json 输出。

# ios - 在 iOS 上使用具有多个 VBO 和 IBO（多个对象）OpenGLES 2 的 VAO 进行绘制

> ID：13388723
> 
> 赞同：2
> 
> 时间：2012-11-14T22:49:02.513
> 
> 标签：ios, opengl-es, 3d, opengl-es-2.0, glkit

对于多个对象（大约 200 个对象，其中 15 个一次可见，每个对象都有自己的顶点和索引缓冲区），我对使用 VAO（顶点数组对象）有些困惑。下面是我的渲染功能

```
- (void)glkView:(GLKView *)view drawInRect:(CGRect)rect
 {

glClearColor(0.50f, 0.50f, 0.50f, 1.0f);

glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

[super drawLines];

for(int i=0; i< self.numberofBars; i++) //numberofBars

{

    // Render the object

    [self.barShaderProg use];

    iVBarNode *temp = [theBars objectAtIndex:i];

    _modelViewProjectionMatrix = GLKMatrix4Multiply(ProjectionView, modelMatrix);
    _modelViewProjectionMatrix =  GLKMatrix4Multiply(_modelViewProjectionMatrix, temp.modelMatrix);
    GLKMatrix4 modeltotalMatrix = GLKMatrix4Multiply(modelMatrix, temp.modelMatrix);
    GLKMatrix4 modelViewMatrix = GLKMatrix4Multiply(ViewMatrix, modeltotalMatrix);

    _normalMatrix = GLKMatrix3InvertAndTranspose(GLKMatrix4GetMatrix3(modelViewMatrix), NULL);

    glUniformMatrix4fv(uniforms[UNIFORM_MODELVIEWPROJECTION_MATRIX], 1, 0, _modelViewProjectionMatrix.m);
    glUniformMatrix3fv(uniforms[UNIFORM_NORMAL_MATRIX], 1, 0,_normalMatrix.m);//
    glUniformMatrix4fv(uniforms[UNIFORM_MODELVIEW_MATRIX], 1, 0, modelViewMatrix.m);

    glUniform4f(uniforms[COLOR_VECTOR], temp.barColor.r, temp.barColor.g, temp.barColor.b, temp.barColor.a);

    //bind corresponding buffer before drawing
    glBindBuffer(GL_ARRAY_BUFFER, [temp getVertexID]);

    glEnableVertexAttribArray(GLKVertexAttribPosition);
    glVertexAttribPointer(GLKVertexAttribPosition, 3, GL_FLOAT, GL_FALSE, 6*sizeof(GLfloat), BUFFER_OFFSET(0));
    glEnableVertexAttribArray(GLKVertexAttribNormal);
    glVertexAttribPointer(GLKVertexAttribNormal, 3, GL_FLOAT, GL_FALSE, 6*sizeof(GLfloat), BUFFER_OFFSET(12));

    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, [temp getIndexID]);
    glDrawElements(GL_TRIANGLES, [temp.bar getIndicesSize], GL_UNSIGNED_SHORT, (void*)0); 
}

if(self.translation>0)
{
    self.paused = NO;

}
else{
    self.paused = YES;
} 
} 
```

这工作得很好。在 OpenGLES Analyzer 中分析了我的代码后，它显示使用 VAO 可以从中受益，因为 glVertexAttribPointer 调用是多余的（对所有人都一样）。但我只是不知道是否可以将它们与不同的顶点缓冲区对象一起使用。我在互联网上找到的大多数示例仅将它们与一个 VBO 或两个 VBO 一起使用，其中第二个 VBO 定义了不同的属性，而不是我的情况相同的属性。我尝试绑定我为我的对象生成的每个顶点缓冲区索引使用单个 VAO，但它没有按如下方式工作

```
-(void) configureVertexArrayObject

{

// Create and bind the vertex array object.

glGenVertexArraysOES(1,&vertexArrayObject);

glBindVertexArrayOES(vertexArrayObject);

for(int i=0;i<self.numberofBars;i++)
{
    iVBarNode *myNode = [theBars objectAtIndex:i];

 glBindBuffer(GL_ARRAY_BUFFER, [myNode getVertexID]);
// Configure the attributes in the VAO
glEnableVertexAttribArray(GLKVertexAttribPosition);
glVertexAttribPointer(GLKVertexAttribPosition, 3, GL_FLOAT, GL_FALSE, 6*sizeof(GLfloat), BUFFER_OFFSET(0));
glEnableVertexAttribArray(GLKVertexAttribNormal);
glVertexAttribPointer(GLKVertexAttribNormal, 3, GL_FLOAT, GL_FALSE, 6*sizeof(GLfloat), BUFFER_OFFSET(12));

    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, [myNode getIndexID]);

}

// Bind back to the default state.

glBindBuffer(GL_ARRAY_BUFFER,0);

glBindVertexArrayOES(0); 
```

}

这是我的渲染方式

```
- (void)glkView:(GLKView *)view drawInRect:(CGRect)rect
{

glClearColor(0.50f, 0.50f, 0.50f, 1.0f);

glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

[super drawLines];

glBindVertexArrayOES(vertexArrayObject);

for(int i=0; i< self.numberofBars; i++) //numberofBars

{

    // Render the object

    [self.barShaderProg use];

    iVBarNode *temp = [theBars objectAtIndex:i];

    _modelViewProjectionMatrix = GLKMatrix4Multiply(ProjectionView, modelMatrix);
    _modelViewProjectionMatrix =  GLKMatrix4Multiply(_modelViewProjectionMatrix, temp.modelMatrix);
    GLKMatrix4 modeltotalMatrix = GLKMatrix4Multiply(modelMatrix, temp.modelMatrix);
    GLKMatrix4 modelViewMatrix = GLKMatrix4Multiply(ViewMatrix, modeltotalMatrix);

    _normalMatrix = GLKMatrix3InvertAndTranspose(GLKMatrix4GetMatrix3(modelViewMatrix), NULL);

    glUniformMatrix4fv(uniforms[UNIFORM_MODELVIEWPROJECTION_MATRIX], 1, 0, _modelViewProjectionMatrix.m);
    glUniformMatrix3fv(uniforms[UNIFORM_NORMAL_MATRIX], 1, 0,_normalMatrix.m);//
    glUniformMatrix4fv(uniforms[UNIFORM_MODELVIEW_MATRIX], 1, 0, modelViewMatrix.m);

    glUniform4f(uniforms[COLOR_VECTOR], temp.barColor.r, temp.barColor.g, temp.barColor.b, temp.barColor.a);

    //all buffer associated with VAO now

    glDrawElements(GL_TRIANGLES, [temp.bar getIndicesSize], GL_UNSIGNED_SHORT, (void*)0); 
}

  glBindVertexArrayOES(0);

 if(self.translation>0)
 {
     self.paused = NO;

 }
  else{
    self.paused = YES;

 }

} 
```

在我的第二次尝试中，我尝试仅指定 VAO 的布局，对顶点和法线使用 glVertexAttribPointer()（而不是指定 VBO 和 IBO id），并像我在没有 VAO 时所做的那样进行渲染（上面的第一个渲染代码），但是现在我没有使用 glVertexAttribPointer() 指定顶点布局，因为我已经向 VAO 提到了它（实际上这是使用 VAO 的全部意义）。**这两种方法都给了我相同大小的对象**让我觉得 VAO 正在为我的所有对象复制几何图形。我的所有对象都具有相同的几何形状但高度不同。现在我有一个选择是拥有一个顶点和索引缓冲区对象，我可以沿高度缩放并根据需要定位对象。我仍然想知道 VAO 到底有什么，没有什么，以及是否有办法让它发挥作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T23:57:16.030

> 在 OpenGLES 分析器中分析了我的代码后，它显示使用 VAO 可以从中受益，因为 glVertexAttribPointer 调用是多余的（对所有人都一样）。

除非您的`glBindBuffer`调用每次都绑定相同的缓冲区，否则我认为这种推理是可疑的。

*通过将所有对象打包到同一个*缓冲区中，您可以从中获得更多收益，从而在绘制时执行一次 bind+glVertexAttribPointer 调用。由于您的所有对象都具有相同的顶点格式，因此您似乎没有理由不能这样做。您必须调整顶点索引以在现在更大的缓冲区中选择正确的位置，但这并不太难。

# curl - 在 Windows 7 命令行中创建 curl 命令

> ID：13388727
> 
> 赞同：1
> 
> 时间：2012-11-14T22:49:16.127
> 
> 标签：curl, windows-7, cmd, windows-7-x64

我从 curl 网站下载了 curl.exe 文件并将其放在我的 C 盘中。C:\curl.exe 。如何在命令行中将其设为快捷方式？

例如，我不想输入“C:\curl [http://www.google.com ”，而只想输入“curl](http://www.google.com) [http://www.google.com](http://www.google.com) ”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T22:52:56.823

通过将其添加到 PATH 环境变量中，将其放在命令处理器将搜索的目录中。

例如：

```
C:\Windows> set PATH=%PATH%;c:\

C:\Windows> curl "http://www.google.com" 
```

这将起作用。

您可以`path`在命令提示符中使用该命令来获取 PATH 中的当前目录列表。

当然，我不建议将 curl.exe 放在 C:\ 根目录下，而是放在更安全的位置，比如在您的个人目录`C:\Users\YourName`中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T22:52:34.840

您需要`curl.exe`在路径中放入一个目录，例如`c:\WINDOWS\`（键入 PATH 以查看系统路径中的所有目录）或将其放入其自己的目录中，然后将该目录添加到您的路径中。

例如，如果您放入`curl.exe`，`C:\Utils`您可以通过键入以下内容将此目录添加到您的路径中：

```
SET PATH=%PATH%;C:\Utils 
```

要使其永久化，请转到`Control Panel / System and Security / System`，单击`Advanced System Settings`，单击`Environment Variables`，然后修改 下的“路径”变量`System Variables`。坚持`;C:\Utils`到底。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T22:53:02.907

我想到了。我没有将 curl.exe 文件添加到 C:\，而是将其添加到 C:\Windows 目录

# svn - 为什么测试合并显示实际合并中不会发生的冲突？

> ID：13388734
> 
> 赞同：1
> 
> 时间：2012-11-14T22:49:58.970
> 
> 标签：svn, tortoisesvn

在 Subversion 中执行合并时，可以选择测试合并。我经常看到这个测试发现冲突，但是当执行实际合并时，这些冲突不会发生。有谁知道为什么有时会发生这种情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T22:56:21.227

通常，当有多个不同的范围时会发生这种情况。Subversion 将测试合并第一个范围并且看不到冲突。然后，它会根据您当前的工作副本测试合并第二个范围检查。因为第一个范围尚未应用，所以工作副本的状态不好，无法合并第二个：您会遇到冲突。当实际合并第一个范围时，确实会应用于工作副本。然后第二个范围可以毫无问题地合并。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T22:53:31.373

不确定，但它会出现“错误”还是只是警告？有没有你可以指导我们或展示的例子？测试合并中可能有其他编码来分析在正常合并下您不会添加的合并。

# php - 如何组合选择列表以确定哪个选择语句

> ID：13388736
> 
> 赞同：1
> 
> 时间：2012-11-14T22:50:01.790
> 
> 标签：php, sql, variables, switch-statement

我有一个 mysql 数据库并且正在使用 php 5.2

我想要做的是提供一个供人们选择的选项列表（只有 1 个）。选择的选项将导致运行选择、更新或删除语句。

不需要显示语句的结果，尽管显示旧的然后新的会很好（那部分没有问题。）。

伪代码：

```
Assign $choice = 0
Check the value of $choice  //  This way, if it = 100, we do a break
Select a Choice:<br>
  1\.  Adjust Status Value (+60) // $choice = 1<br>
  2\.  Show all Ships <br> // $choice = 2
  3\.  Show Ships in Port <br> // $choice = 3
  ...  
  0\.  $choice="100"  // if the value =100, quit this part 
```

使用 case (switch) 或 if/else 语句来运行用户选择1

```
If the choice is 1, then run the "Select" statement with the variable of $sql1
    --  "SELECT ....
If the choice is 2, then run the "Select" statement with the variable of $sql2
    --- SELECT * FROM Ships
If the choice is 3, then run the "Select" statement with the variable of $sql3  <br>
    ....
If the choice is 0, then we are done. 
```

我认为 (3) 语句将在 php 中分配为：

```
$sql1="...".
$sql2="SELECT * FROM Ships"
$sql3="SELECT * FROM Ships WHERE nPort="1" 
```

我的想法是使用 switch 语句，但迷路了。:(

我希望这些选项一次又一次地可用，直到选择了一个变量 ($choice)。在这种情况下，此特定页面完成并返回“主菜单”？

编码和显示，如果我使用它，我可以做到。只是不知道如何编写选择我想要的方式。我可能会运行所有查询，而其他时候只运行一个，这就是我想要选择的原因。我感到困惑的一个领域是使用正确的形式，例如 -- ' ' " " 和 ...??

不确定我最终会得到多少个选项，但它会超过 5 个但少于 20 个/页。因此，如果我在 2-3 个选项中关闭系统，我可以根据需要复制它。而且，一如既往，如果存在更好的方法，我愿意尝试。

再次感谢...

拉里

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T22:57:49.417

[Switch](http://php.net/manual/en/control-structures.switch.php)是一个不错的选择。 `if-then`也可以，看需要。

对于你的例子，你会谈论这样的事情：

```
switch($choice) {
    case 1:
        $sql = $sql1="...".
        break;
    case 2:
        $sql2="SELECT * FROM Ships"
        break;
    case 3:
        $sql3="SELECT * FROM Ships WHERE nPort="1"
        break;
    default:
        // Do some default behavior - as you mentioned
} 
```

如果您希望它可重用，您可以将其放入一个函数中：

```
function getSQL($choice) {

    switch($choice) {
        case 1:
            $sql = $sql1="...".
            break;
        case 2:
            $sql="SELECT * FROM Ships"
            break;
        case 3:
            $sql="SELECT * FROM Ships WHERE nPort="1"
            break;
        default:
            // Do some default behavior - as you mentioned
    }
    return $sql;
} 
```

然后，您可以这样称呼它：

```
$mysql = getSQL($choice); 
```

# objective-c - 如何阻止此 UINavigationController 释放视图控制器

> ID：13388737
> 
> 赞同：0
> 
> 时间：2012-11-14T22:50:02.137
> 
> 标签：objective-c, ios, xcode, uinavigationcontroller, rubymotion

我有一个包含 2 种主要控制器类型的应用程序：

1) UITableViewController - 充当导航屏幕 2) UIViewController 包含在 UINavigationController - 显示主要应用程序内容。

TableViewController 的内容看起来有点像这样：

*   第 1 页
*   第2页
*   第 3 页 ... 等

我在 AppDelegate 上定义了一个属性——一个名为 PageViewControllers 的数组。*当应用程序启动时，会为应用程序中的每个页面*创建一个新的 UIViewController 实例。

第一个*Page*的控制器设置为 UINavigationController 的 rootViewController。

当用户在 UITableView 控制器中选择一行时，UINavigationController 会推送或弹出该行的相关视图控制器。（如果我点击“第 3 页”，它会推送到第三*页*的控制器）。

我的这个运行良好 - 唯一的问题是应用程序在尝试跳回导航堆栈时偶尔会崩溃。例如，从*第*15 页到*第*2页

我收到的错误消息是：

```
*** Terminating app due to uncaught exception 'RuntimeError', reason: 'NSInternalInconsistencyException: Tried to pop to a view controller that doesn't exist. 
```

我认为 UINavigationController 可能会发布一些控制器。我认为该应用程序会将所有以前的控制器保存在内存中，以允许 UINavigationController 的后退按钮按预期运行？

知道如何防止这种情况发生，还是我错过了什么？

## 更新

这是我在选择表格行后推送/弹出导航控制器的代码。（这是Rubymotion）

```
def tableView(tableView, didSelectRowAtIndexPath: indexPath)
  # first we need to work out which controller was selected...
  page = Page.current

  currentPageController      = appDelegate.pageControllers[page.absoluteIndex]
  currentPageControllerIndex = appDelegate.pageControllers.index(currentPageController)

  nextPageController      = appDelegate.pageControllers[Page.pageAtIndexPath(indexPath).absoluteIndex]
  nextPageControllerIndex = appDelegate.pageControllers.index(nextPageController)

  case
  # When we're moving forward in the stack... 
  when currentPageControllerIndex < nextPageControllerIndex
    for controller in appDelegate.pageControllers[(currentPageControllerIndex + 1)..nextPageControllerIndex]
      # push the next controller on to the nav stack, only animate if it's the last one
      appDelegate.rootViewControllerNav.pushViewController(controller, animated: controller == nextPageController)        
    end

  # When we're moving backward in the stack...
  when currentPageControllerIndex > nextPageControllerIndex
    appDelegate.rootViewControllerNav.popToViewController(nextPageController, animated: true)

  # When we select the same step again...
  else
    NSLog("Selected the same page")
  end

  # close the side menu afterwards
  appDelegate.rootViewControllerNav.sideMenu.toggleSideMenuPressed(self)
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T04:13:33.017

“我认为该应用程序会将所有以前的控制器保存在内存中，以允许 UINavigationController 的后退按钮按预期运行？”

只要你继续前进，这是真的——当你推送一个新的视图控制器时，它会将新的视图控制器添加到堆栈上的先前视图控制器中。但是，当你 popViewController 时，它会从堆栈中删除，如果你没有对它的强引用，它将被释放。所以如果你去 1-->2-->3........-->15 然后弹出到 2，它应该可以工作，但是如果你做这样的事情：

1-->2-->3 popTo 1 然后 push to-->15 然后 pop 到 2，2 和 3 都不会再存在了。因此，您应该注意在表格中选择单元格的顺序，并注意何时出现错误。看看是否对应这个解释。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T10:09:59.860

破解它！

这里的问题在于我的应用程序其他地方的逻辑。您会看到该页面是从**Page.currentPage**设置的。

```
page = Page.currentPage 
```

**Page.currentPage**应始终设置为当前正在显示的页面。

设置当前页面的代码在 PagesViewController 的 viewDidLoad 方法中，而不是 viewDidAppear:animated 方法中——这意味着已经查看了一个页面，它不会再次设置 Page.currentPage。

现已修复 - 非常感谢分享的想法和技巧！

# android - 为什么这个数组列表不起作用？

> ID：13388739
> 
> 赞同：0
> 
> 时间：2012-11-14T22:50:06.593
> 
> 标签：android

嗨，下面的作品

```
package com.ahmad.actionBar;

import java.util.ArrayList;

import android.app.Fragment;
import android.os.Bundle;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ArrayAdapter;
import android.widget.ListView;

public class FragMent1 extends Fragment {

    private String arry[] = { "Tofeeq", "Ahmad", "Fragment", "Example",
            "Tofeeq", "Ahmad", "Fragment", "Example" };

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {
        ListView listView = new ListView(getActivity());
        ArrayAdapter<String> array = new ArrayAdapter<String>(getActivity(),
                android.R.layout.simple_list_item_1);

        for (String str : arry)
            array.add(str);
        listView.setAdapter(array);
        return listView;
    }
} 
```

但是当我试图用字符串对象填充我的数组时它不起作用

```
package com.ahmad.actionBar;

import java.util.ArrayList;

import android.app.Fragment;
import android.os.Bundle;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ArrayAdapter;
import android.widget.ListView;

public class FragMent1 extends Fragment {

    private String bookNames[];

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {
        ListView listView = new ListView(getActivity());
        ArrayAdapter<String> array = new ArrayAdapter<String>(getActivity(),
                android.R.layout.simple_list_item_1);

        bookNames= bookNames();//This doesn't work
        for (String str : bookNames)//This doesn't work
            array.add(str);
        listView.setAdapter(array);
        return listView;
    }

    private String[] bookNames(){
        SimpleBookManager testBook = new SimpleBookManager();
        for(int i=0; i < testBook.count(); i++){
        bookNames[i]= testBook.getBook(i).getTitle();
    }
        return bookNames;
    }
} 
```

我收到以下错误 NullpointeException??

```
11-14 23:36:54.531: E/AndroidRuntime(1949): FATAL EXCEPTION: main
11-14 23:36:54.531: E/AndroidRuntime(1949): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.ahmad.actionBar/com.ahmad.actionBar.ActionBarMain}: java.lang.NullPointerException
11-14 23:36:54.531: E/AndroidRuntime(1949):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2059)
11-14 23:36:54.531: E/AndroidRuntime(1949):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2084)
11-14 23:36:54.531: E/AndroidRuntime(1949):     at android.app.ActivityThread.access$600(ActivityThread.java:130)
11-14 23:36:54.531: E/AndroidRuntime(1949):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1195)
11-14 23:36:54.531: E/AndroidRuntime(1949):     at android.os.Handler.dispatchMessage(Handler.java:99)
11-14 23:36:54.531: E/AndroidRuntime(1949):     at android.os.Looper.loop(Looper.java:137)
11-14 23:36:54.531: E/AndroidRuntime(1949):     at android.app.ActivityThread.main(ActivityThread.java:4745)
11-14 23:36:54.531: E/AndroidRuntime(1949):     at java.lang.reflect.Method.invokeNative(Native Method)
11-14 23:36:54.531: E/AndroidRuntime(1949):     at java.lang.reflect.Method.invoke(Method.java:511)
11-14 23:36:54.531: E/AndroidRuntime(1949):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
11-14 23:36:54.531: E/AndroidRuntime(1949):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
11-14 23:36:54.531: E/AndroidRuntime(1949):     at dalvik.system.NativeStart.main(Native Method)
11-14 23:36:54.531: E/AndroidRuntime(1949): Caused by: java.lang.NullPointerException
11-14 23:36:54.531: E/AndroidRuntime(1949):     at com.ahmad.actionBar.FragMent1.bookNames(FragMent1.java:39)
11-14 23:36:54.531: E/AndroidRuntime(1949):     at com.ahmad.actionBar.FragMent1.onCreateView(FragMent1.java:29)
11-14 23:36:54.531: E/AndroidRuntime(1949):     at android.app.FragmentManagerImpl.moveToState(FragmentManager.java:829)
11-14 23:36:54.531: E/AndroidRuntime(1949):     at android.app.FragmentManagerImpl.moveToState(FragmentManager.java:1035)
11-14 23:36:54.531: E/AndroidRuntime(1949):     at android.app.BackStackRecord.run(BackStackRecord.java:635)
11-14 23:36:54.531: E/AndroidRuntime(1949):     at android.app.FragmentManagerImpl.execPendingActions(FragmentManager.java:1397)
11-14 23:36:54.531: E/AndroidRuntime(1949):     at android.app.Activity.performStart(Activity.java:5017)
11-14 23:36:54.531: E/AndroidRuntime(1949):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2032) 
```

这是我的 SimpleBookManager 类，我手动填充它，所以它不应该为空。

```
package com.ahmad.actionBar;

import java.util.ArrayList;

public class SimpleBookManager implements BookManager {
    private ArrayList<Book> allBooks = new ArrayList<Book>();

    public ArrayList<Book> getAllBooks(){
    return  allBooks;
    }

    public int count(){
        return getAllBooks().size();
    }

    public Book getBook(int index){

        return allBooks.get(index);
    }
    public Book createBook(){
        Book book = new Book();
        allBooks.add(book);
        return book;
    }
    public void removeBook(Book book){
        allBooks.remove(book);
        //Remove instance of book
    }
    public void moveBook (int from, int to){
        Book book1 = allBooks.get(from);
        Book book2 = allBooks.get(to);
        allBooks.add(to, book1);
        allBooks.add(from, book2);

    }
    public int getMinPrice(){
    ArrayList<Integer> allPrices = getAllPrices();
    int smallestElem=allPrices.get(0);
    for(int i=0; i < allPrices.size(); i++){
         if (smallestElem > allPrices.get(i)){
             smallestElem = allPrices.get(i);
         }
      }
        return smallestElem;

    }
    public int getMaxPrice(){
        ArrayList<Integer> allPrices = getAllPrices();
        int biggestElem=allPrices.get(0);
        for(int i=0; i < allPrices.size(); i++){
             if (biggestElem < allPrices.get(i)){
                 biggestElem = allPrices.get(i);
             }
          }
            return biggestElem; 
    }
    public float getMeanPrice(){
        ArrayList<Integer> allPrices = getAllPrices();
        int total=0;
        for(int i=0; i < allPrices.size(); i++){
             total+=allPrices.get(i);
          }
            return total/allPrices.size();  

    }
    public int getTotalCost(){
        ArrayList<Integer> allPrices = getAllPrices();
        int total=0;
        for(int i=0; i < allPrices.size(); i++){
             total+=allPrices.get(i);
          }
            return total;
    }
    public void saveChanges(){
        //What to do here
    }
    private ArrayList<Integer> getAllPrices(){
        int totalElements = allBooks.size();
        ArrayList<Integer> allBookPrices = new ArrayList<Integer>();
        //loop through it
        for(int i=0; i < totalElements; i++){
          allBookPrices.add(allBooks.get(i).getPrice());
        }
        return allBookPrices;
    }

    public SimpleBookManager(){
        Book harryPotter1 = createBook();
        Book harryPotter2 = createBook();

        harryPotter1.setAuthor("JK Rowling");
        harryPotter1.setCourse("Harry Potter Kunskap");
        harryPotter1.setPrice(199);
        harryPotter1.setTitle("Harry Potter and the philosifer Stone");
        harryPotter1.setIsbn("9780590353403");

        harryPotter2.setAuthor("JK Rowling");
        harryPotter2.setCourse("Harry Potter Kunskap");
        harryPotter2.setPrice(299);
        harryPotter2.setTitle("Harry Potter and snake");
        harryPotter2.setIsbn("0439064872");
    }
} 
```

可能与[此处](https://stackoverflow.com/questions/5140535/populating-arrayadapter-type-string)的此示例之类的 List 有关，但我无法弄清楚示例中的确切语法，因此非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-14T22:54:29.933

在您的代码中，您不初始化`bookNames`数组

```
private String[] bookNames(){
    SimpleBookManager testBook = new SimpleBookManager();
    bookNames = new String[testBook.count ()]; // this is what you should add
    for(int i=0; i < testBook.count(); i++){
        bookNames[i]= testBook.getBook(i).getTitle();
    }
    return bookNames;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-14T22:54:27.693

我没有看到你在哪里初始化`String[] bookNames`......

```
private void bookNames(){
    SimpleBookManager testBook = new SimpleBookManager();
    bookNames = new String[testBook.count()];
    for(int i=0; i < testBook.count(); i++){
        bookNames[i]= testBook.getBook(i).getTitle();
    }
} 
```

由于`bookNames`是一个字段变量，您只需要调用：`bookNames()`本身。还有一个名称相同的方法和变量有点令人困惑，考虑给`bookNames()`一个更具描述性的名称。

# c - 在循环中“保存”当前状态以便稍后继续

> ID：13388748
> 
> 赞同：0
> 
> 时间：2012-11-14T22:50:54.940
> 
> 标签：c, algorithm

目前我正在考虑以下问题，也许有人可以帮助我：

对于我的世界，我想更改很多块并防止滞后，我只想同时更改几个块。要更改长方体，我通常使用这样的循环：

```
for(int x=t.x; x<t.X; x++) 
  for(int y=t.y; y<t.Y; y++) 
    for(int z=t.z; z<t.Z; z++) {
      // ..
    } 
```

其中 t 保存 from 和 to 坐标。

现在我想保存当前进度以便以后继续。

请帮助我厌倦了思考它..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T19:11:58.950

您的代码看起来像 C。在 C 中，进程在离开调用函数后无法返回到给定的堆栈状态。因此，在语言级别上离开循环并稍后返回它是不可能的。在其他语言中，情况有所不同。例如，在 Python 语言的 Pypy 实现中，可以使用[continuelets来实现您所描述的。](http://doc.pypy.org/en/latest/stackless.html#continulet)

但是，您可以通过使用自己的对象来存储最后一个计数器来实现类似的方法。

```
struct counters { int x, y, z; };

bool continueLoops(struct counters *ctrs) {
  for (; ctrs->x < t.X; ctrs->x++) {
    for (; ctrs->y < t.Y; ctrs->y++) {
      for (; ctrs->z < t.Z; ctrs->z++) {
        // ..
        if (weWantToInterruptTheLoop)
          return true;
      }
      ctrs->z = t.z;
    }
    ctrs->y = t.y;
  }
  return false;
}

void startLoops() {
  struct counters ctrs;
  ctrs.x = t.x;
  ctrs.y = t.y;
  ctrs.z = t.z;
  while (continueLoops(&ctrs)) {
    // do whatever you want to do between loops
  }
} 
```

但是，与直接在内部循环中执行相关操作相反，我认为上述方法没有太多好处。所以我不确定这对你是否有用。

# r - 如何在 R 中仅绘制轴以进行 3d 绘图？

> ID：13388757
> 
> 赞同：1
> 
> 时间：2012-11-14T22:51:39.660
> 
> 标签：r, 3d, plot

基本上我只想用空图绘制 x、y、z 轴，但上面有我自己的标签的 x、y、z。可以在R中做到吗？我知道如何在二维图中绘制它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T23:10:33.730

这是你的答案：

```
library(scatterplot3d)
scatterplot3d(0,0,0, pch="", xlab="X", ylab="Y",zlab="Z", 
              xlim=c(0,1), ylim=c(0,1), zlim=c(0,1)) 
```

Y标签的位置似乎有点奇怪。这是此软件包的限制。因此，您可以通过以下方式设置`ylab=""`然后手动将标签放置到您想要的位置`text(x, y, "Y")`

![在此处输入图像描述](../Images/a56d3ff60d4dfbb710b5f87ff3ca4a6e.png)

# asp.net - 通过主域登录子域

> ID：13388761
> 
> 赞同：0
> 
> 时间：2012-11-14T22:52:23.783
> 
> 标签：asp.net, ssl

我有一个网站，可通过多个域名访问。像

```
www.domain1.com
....
www.domain5.com 
```

我所有的客户都有自己的子域。像：

```
customer1.domain1.com
customer2.domain1.com
....
customer351.domain4.com 
```

目前我不使用 SSL，每个客户都通过他们的子域登录他们自己的帐户。我想改变这一点，让所有客户在一个中央登录页面上登录，例如，该页面将使用 SSL。

```
https://login.domain1.com 
```

并以某种方式将每个用户重定向到正确的子域地址。（不使用 SSL 的子域）我如何做到这一点，并保持安全？

我有一个想法：

登录 -> 在数据库中某处添加随机值，重定向到子域，查询字符串为随机值。之后会话会处理它，每个值只能使用一次..但这有多安全？

我想有人会问“为什么？” 对我来说。因为 SSL 需要花钱。不幸的是，我没有很多。:D

谢谢你的时间！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T22:56:35.533

尝试使用[OpenID](http://openid.net)。这里[.Net/C#的库以及](http://dotnetopenid.googlecode.com/)[http://openid.net/developers/libraries/](http://openid.net/developers/libraries/)上的所有可用库列表

# scheme - 我怎样才能消除缺点的副作用？

> ID：13388763
> 
> 赞同：0
> 
> 时间：2012-11-14T22:52:31.920
> 
> 标签：scheme, period, cons

我可以使用以下代码获取列表的奇数元素：

```
(define (odds lis)
(cond
    ((null? lis) '())
    ((not (list? lis)) (quote (Usage: odds(list))))
    ((null? (car lis)) '())
    ((= (length lis) 1) (car lis))
    (else (cons (car lis) (odds (cddr lis)))))) 
```

但是当输入奇数长度的列表例如： (odds '(abcde)) 它将返回 (ac . e)

我怎样才能摆脱这个令人讨厌的时期？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T22:55:52.043

试试这个，它只改变了一行：

```
(define (odds lis)
  (cond
    ((null? lis) '())
    ((not (list? lis)) (quote (Usage: odds(list))))
    ((null? (car lis)) '())
    ((= (length lis) 1) lis) ; change here
    (else (cons (car lis) (odds (cddr lis)))))) 
```

在突出显示的行中，您返回的是单个元素而不是正确的列表（以 null 结尾的列表），这就是导致问题的原因。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-14T23:48:40.860

您的代码存在一些问题：

*   ((null? (car lis)) '()) 不是必需的

这不是必需的，因为当列表有 1 个元素时，car 不会为 null，最后一个条件处理它，而当列表没有元素时，第一个条件处理这种情况。

*   ((= (长度 lis) 1) (汽车 lis))

此终端条件有 3 个错误：

1.  没有必要，因为最后一个条件适用于包含 1 个元素的列表的情况。

2.  它不返回一对，而是一个原子元素。当它被转换为一对时，结果将是 (x . atom)

3.  您可以抛出（错误“某事”），而不是在答案末尾附加错误消息

所以，去掉这两个条件，你的代码就是你想要的。

```
(define (odds lis)
(cond
    ((null? lis) '())
    ((not (list? lis)) (quote (Usage: odds(list))))
    (else (cons (car lis) (odds (cddr lis)))))) 
```

# javafx-2 - 如何禁用绽放效果的剪辑

> ID：13388766
> 
> 赞同：3
> 
> 时间：2012-11-14T22:52:40.240
> 
> 标签：javafx-2, fxml

JavaFX 2 中的bloom 效果受到裁剪的影响，裁剪了效果本身的一部分。有没有办法避免这种剪辑或扩展将被保留的区域？

示例 FXML（只需使用 Scene Builder 打开），演示了裁剪的绽放效果：

```
<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.scene.effect.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.shape.*?>
<StackPane xmlns:fx="http://javafx.com/fxml">
    <children>
        <Rectangle fill="#808080" height="90.0" width="90.0" />
        <Circle fill="WHITE" radius="35">
            <effect><Bloom /></effect>
        </Circle>
    </children>
</StackPane> 
```

![剪花](../Images/2a7613e872a5ca7bb0cb18776bf95821.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T01:06:05.483

这似乎是一个错误，因为像 dropshadow 这样的效果不会受到相同的剪切。[我鼓励您在http://javafx-jira.kenai.com](http://javafx-jira.kenai.com)上针对运行时项目提交错误。

一种解决方法是在圆圈上设置透明笔触。

```
<?xml version="1.0" encoding="UTF-8"?>

<?import java.lang.*?>
<?import javafx.scene.effect.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.shape.*?>

<StackPane xmlns:fx="http://javafx.com/fxml">
  <children>
    <Rectangle fill="GREY" height="90.0" width="90.0" />
    <Circle fill="WHITE" radius="35.0" stroke="TRANSPARENT" strokeType="OUTSIDE" strokeWidth="10.0">
      <effect>
        <Bloom />
      </effect>
    </Circle>
  </children>
</StackPane> 
```

![布卢洛克](../Images/2bc5421a00711c1bd14d732f0690faed.png)

# c# - 从 C# 中的 PHP 页面下载文件

> ID：13388774
> 
> 赞同：0
> 
> 时间：2012-11-14T22:53:13.357
> 
> 标签：c#, php

好的，我们有一个 PHP 脚本，它从文件创建下载链接，我们想通过 C# 下载该文件。这适用于进度等，但是当 PHP 页面出现错误时，程序会下载错误页面并将其保存为请求的文件。这是我们在ATM上的代码：

PHP代码：

```
<?php
$path = 'upload/test.rar';

    if (file_exists($path)) {
        $mm_type="application/octet-stream";
        header("Pragma: public");
        header("Expires: 0");
        header("Cache-Control: must-revalidate, post-check=0, pre-check=0");
        header("Cache-Control: public");
        header("Content-Description: File Transfer");
        header("Content-Type: " . $mm_type);
        header("Content-Length: " .(string)(filesize($path)) );
        header('Content-Disposition: attachment; filename="'.basename($path).'"');
        header("Content-Transfer-Encoding: binary\n");
        readfile($path); 
        exit();
    } 
    else {
    print 'Sorry, we could not find requested download file.';
    }
?> 
```

C#代码：

```
private void btnDownload_Click(object sender, EventArgs e)
    {
        string url = "http://***.com/download.php";
        WebClient client = new WebClient();
        client.DownloadFileCompleted += new AsyncCompletedEventHandler(client_DownloadFileCompleted);
        client.DownloadProgressChanged += new DownloadProgressChangedEventHandler(ProgressChanged);
        client.DownloadFileAsync(new Uri(url), @"c:\temp\test.rar");
    }

    private void ProgressChanged(object sender, DownloadProgressChangedEventArgs e)
    {
        progressBar.Value = e.ProgressPercentage;
    }

    void client_DownloadFileCompleted(object sender, AsyncCompletedEventArgs e)
    {
            MessageBox.Show(print);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T22:57:56.103

[您应该使用此处](http://php.net/manual/en/function.header.php)`Header`记录的 PHP 函数，而不是打印错误消息。

```
header($_SERVER["SERVER_PROTOCOL"]." 404 Not Found", true, 404); 
```

由于您的异步调用的性质，没有`WebException`抛出。在您的 DownloadFileCompleted 回调中，您可以检查

```
if(e.Error != null) 
```

您的 e.Error 将包含类似于`"The remote server returned an error: (404) Not Found."`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T23:01:35.440

您需要通过设置标头来通知网络客户端发生了错误，就像您在成功下载时一样。我对PHP不是很熟悉，但是找到了一个401的例子

```
header('HTTP/1.0 401 Unauthorized', true, 401); 
```

从[这里](https://stackoverflow.com/questions/6163970/set-response-status-code)

# html - OS X 应用程序，使用 HTML 页面作为帮助系统，可以更改 HTML 链接以在应用程序内工作吗？

> ID：13388785
> 
> 赞同：0
> 
> 时间：2012-11-14T22:53:59.020
> 
> 标签：html, webview, osx-lion

OS X 应用程序，使用 HTML 页面作为帮助系统，你能帮帮我吗？

我有八个网页。每两列页面都有相同的八个链接侧边栏菜单。一旦我加载了第一个“登陆”页面，这八个页面就可以在 Safari 中使用。

我有一个带有 WebView 的窗口，当以下代码运行以加载此“登陆”页面时，该窗口可以正确显示：

```
- (void)awakeFromNib {

NSURL *url = [[NSBundle mainBundle] URLForResource: @"HungryMe" withExtension:@"html"];
NSURLRequest*request=[NSURLRequest requestWithURL:url];
[[webView mainFrame] loadRequest:request];
...
} 
```

HTML 的片段如下：

```
<div class="sidebar1">
 <ul class="nav">
  <li><a href="file:///DataDisk/Cocoa/HungryMeHelp/HungryMe.html">1.Getting Started</a></li>
... 
```

八个链接 html“菜单”显然不能按原样工作，我的问题是：

我是否必须在 WebView 旁边的窗口上放置八个按钮，每个按钮对应一个不同的页面，显示帮助，或者我可以以某种方式更改链接，以便“HTML 菜单”在应用程序内工作？或者，也许我只是看错了？

非常感谢，马克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T18:29:28.407

对不起，我找到了答案。有称为 Apple Help URLs 的特殊 URL，可用于在应用程序的 Bundle 中查找文件的 URL。我现在将这些帮助 URL 与帮助锚点结合使用。锚点放在目标文件中。然后显示页面：

```
<a href='help:anchor=topic1_page bookID=theBookID'>1.Topic #1</a> 
```

请参阅帮助手册文档。

# mongodb - 在 MongoDB 中删除带有条件的嵌套文档

> ID：13388791
> 
> 赞同：0
> 
> 时间：2012-11-14T22:54:27.487
> 
> 标签：mongodb, nosql

对于以下 JSON，我如何删除高度最小的狗

```
{
   _id:0
   "name":"Andy",
   "pets":[
      {
         "type":"dog","name":"max","height":120
      },
      {
         "type":"dog","name":"rover","height":44
      },
      {
         "type":"dog","name":"katie","height":100
      },
      {
         "type":"cat","name":"minni"
      }
   ]
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T22:05:46.180

问题是子文档数组不是一个集合，你不能对它进行排序或做其他事情。但是，如果您可以访问任何语言界面，例如 JavaScript，或者其他语言界面，这是可能的。您只需要提取子文档列表，按高度对它们进行排序，记住第一个，然后运行命令根据其名称和高度将其从数组中拉出。例如，可以在 MongoDB shell 中使用以下 JavaScript 代码来完成：

```
var min = 0; var name = "";
db.animals.find({ query:{"_id" : 0} }).forEach(
function(record){
    var sets = record.pets; 
    min = sets[0].height;
    sets.forEach(function(set){
        if(set.height <= min) 
            {min=set.height;
            name=set.name;}
            });
    print(min);
    print(name);    
    query = {"_id": 0}
    update = { "$pull" : { "pets" : { "name" : name } } };
    db.animals.update(query, update);
    }) 
```

我怀疑该解决方案不是最优雅的，但无论如何它都有效。

# c# - 如何按名称获取控件

> ID：13388795
> 
> 赞同：0
> 
> 时间：2012-11-14T22:54:41.543
> 
> 标签：c#, .net, winforms

我正在努力获得正确的上下文，以了解如何以`TextBox`我的形式获得当前。

现在我有一个按钮，按下时将允许用户选择一个文件夹。我想走那条路，把它放在`TextBox`当前名为`installPath`.

```
namespace CustomLauncher
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void browse_Click(object sender, EventArgs e)
        {
            //browse to select a folder
            FolderBrowserDialog folder = new FolderBrowserDialog();
            DialogResult result = folder.ShowDialog();
            if (result == DialogResult.OK)
            {
                MessageBox.Show("You chose" + folder.SelectedPath);
            }
            else if (result == DialogResult.Cancel)
            {
                return;
            }
        } 
```

我见过各种各样的尝试，比如......

`this.Controls.Find("installPath");`//visual studio 不喜欢这个

`Control myControl1 = FindControl("installPath");`//也不喜欢这个

我还看到了其他一些方法。虽然我似乎找不到视觉工作室会接受的。我觉得我错过了有关此事件侦听器上下文的一些相当明显/巨大的事情，这就是为什么我无法弄清楚如何实现这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T22:59:49.653

为什么不`this.installPath.Text = folder.SelectedPath`呢？是`TextBox`另一种形式吗？

顺便说一句，您已经`FindControl`在 ASP.NET 站点上看到了这些方法。

如果您使用的是 .NET 2 或更高版本，则可以使用[`Control.ControlCollection.Find`Method](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.controlcollection.find%28v=vs.80%29.aspx)。

```
TextBox txtInstallPath = (TextBox)this.Controls.Find("installPath", true)[0]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T23:03:31.480

尝试使用此代码：

```
private void browse_Click(object sender, EventArgs e)
{
    //browse to select a folder
    FolderBrowserDialog folder = new FolderBrowserDialog();
    DialogResult result = folder.ShowDialog();
    if (result == DialogResult.OK)
    {
        installPath.Text = folder.SelectedPath;
        MessageBox.Show("You chose" + folder.SelectedPath);
    }
    else if (result == DialogResult.Cancel)
    {
        return;
    }
} 
```

# android - 在应用计费前台

> ID：13388798
> 
> 赞同：0
> 
> 时间：2012-11-14T22:54:57.677
> 
> 标签：android, eclipse

我有 inAppBilling 工作，但我正在尝试对其进行一些改进。我注意到，当我在 Angry Birds 中尝试应用计费时，它直接在应用程序顶部打开，但我的应用程序将应用计费拉到前台/桌面。我阅读了文档，它指出必须关闭 singleTop 并且必须使用反射以及给定的活动上下文而不是应用程序上下文。我已经证实我已经完成了所有这些事情，但它仍然处于前台。有任何想法吗？

我的验证：我有一个名为 MyActivity 的活动

`Log.d("TEST", mContext.getClass().getName());`

回复 MyActivity

并在 MyActivity 的 Android 清单中

`android:launchMode="standard"`

编辑：

启动结帐活动的代码

```
 void startBuyPageActivity(PendingIntent pendingIntent, Intent intent) {
    if (mStartIntentSender != null) {
        // This is on Android 2.0 and beyond.  The in-app buy page activity
        // must be on the activity stack of the application.
        try {
            // This implements the method call:
            // mActivity.startIntentSender(pendingIntent.getIntentSender(),
            //     intent, 0, 0, 0);
            mStartIntentSenderArgs[0] = pendingIntent.getIntentSender();
            mStartIntentSenderArgs[1] = intent;
            mStartIntentSenderArgs[2] = Integer.valueOf(0);
            mStartIntentSenderArgs[3] = Integer.valueOf(0);
            mStartIntentSenderArgs[4] = Integer.valueOf(0);
            mStartIntentSender.invoke(mActivity, mStartIntentSenderArgs);
            Log.d("TAG", mActivity.getClass().getName());
        } catch (Exception e) {
            Log.e(TAG, "error starting activity", e);
        }
    } else {
        // This is on Android version 1.6\. The in-app buy page activity must be on its
        // own separate activity stack instead of on the activity stack of
        // the application.
        try {
            pendingIntent.send(mActivity, 0 /* code */, intent);
        } catch (CanceledException e) {
            Log.e(TAG, "error starting activity", e);
        }
    }
} 
```

我想要完成的是应用内计费提示是否完成交易或取消以恢复我的游戏，而不是简单地关闭和完成。我目前的修复是再次启动游戏活动，这将导致重新加载所有内容并将播放器放回主菜单页面。

# scala - 我们如何覆盖 scala actor 的 react 构造？

> ID：13388805
> 
> 赞同：0
> 
> 时间：2012-11-14T22:55:49.637
> 
> 标签：scala, remote-actors, act

检测 scala actor 中接收到的消息类型的常用方法是

```
loop{
     react{
            case x: String =>
           }
     } 
```

但是，我想知道我们如何覆盖这个 react 构造的实现，以便我们可以对收到的消息进行隐式记录。

我正在尝试实现下面提到的用例-> 1。在消息与任何案例类匹配之前，我想在控制台/文件上编写一条日志语句，显示消息的出现。2\. 我们可以通过 println() / log4j logging 显式记录这些消息。但是，我想为 scala 演员设计一个通用记录器，它将记录所有发送或接收的消息。

在这方面的任何帮助都会有所帮助。提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T18:18:28.583

```
//Following is a code for a logReact Method that does the same thing as react but also logs the message received hope this works for you
import scala.actors.Actor;
import scala.actors.Actor._

trait ActorLogging extends Actor {
    def logReact(handler: PartialFunction[Any, Unit]): Nothing = {
        val handler2: PartialFunction[Any, Unit] = {
            case x =>
                println("Inside Logs -- with message recieved  -- " + x.toString);
                handler.apply(x);
        }
        super.react(handler2)
    }
}

class sumAct extends Actor with ActorLogging {
    def act() {
        loop {
            logReact {
                case a: Int =>
                    println("Inside actor Sum Act Received the message -- " + a)
                    exit;
            }
        }
    }
}

object ActorLog {
    def main(args: Array[String]): Unit = {
        var s: sumAct = new sumAct;
        s.start();
        s ! 1.toInt;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T23:08:03.980

首先，请注意 Scala 演员库正在被 Akka 弃用。所以这个答案不会有很长时间的帮助（尽管其他演员库将继续可用一段时间——而且如果人们想要维护它，它可能永远是开源的）。

无论如何，该`react`方法定义在`scala.actors.Actor`. 只是无法导入它，或者用你自己的隐藏它。你自己的*什么*？

好吧，该方法只需要一个`PartialFunction[Any,Unit]`. 因此，您还应该：

```
def react(pf: PartialFunction[Any,Unit]): Nothing = { /*how?;*/ Actor.react(/*what?*/) } 
```

您实际上只能访问部分功能，并且您必须按照`Actor.react`自己的意愿去做。所以你需要包装`pf`另一个`PartialFunction`执行你的日志记录。这样你就可以

```
val qf = new PartialFunction[Any,Unit] {
  def isDefinedAt(a: Any) = pf.isDefinedAt(a)
  def apply(a: Any): Unit = {
    log(a)  // Maybe add more logic to know what a is
    pf(a)
  }
} 
```

如果您想查看进来并被检查但实际上并未被消费的消息，您可以使用`isDefinedAt`also.

所以，很明显，我希望，`/*how?*/`上面定义 (create) `qf`，并且`/*what?*/`只是`qf`.

如果你想知道是否`a`是一个案例类，答案是你不能（按设计）。案例类只是普通 Scala 特性之上的语法糖；它只是为了节省您的打字时间。例如，参见[这个问题](https://stackoverflow.com/questions/4697534)。

但是，您可以通过模式匹配`Product`并检查它是否具有`copy`方法来非常接近：

```
case class M(i: Int)
val a: Any = M(5)

scala> a match {
  case p: Product if p.getClass.getMethods.exists(_.getName=="copy") => println("Yes")
  case _ => println("No")
}
Yes 
```

如果你真的想花哨，请检查是否`copy`与构造函数具有相同数量和类型的参数。

# mysql - 在 MySql 中按日期条件插入

> ID：13388808
> 
> 赞同：0
> 
> 时间：2012-11-14T22:56:01.257
> 
> 标签：mysql, insert

我有两个表（`employee`& ），我想在没有为用户找到记录的时候`log_sheet`插入今天的日期。如果有记录，它应该返回一些值。`log_sheet``log_sheet`

```
SELECT employee.id,
       employee.name,
       log_sheet.`date`
FROM   employee
       LEFT OUTER JOIN log_sheet
                    ON employee.id = log_sheet.employee_id
WHERE  employee.name = 'admin' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T23:11:49.600

所以你想确保每个员工至少有一个 log_sheet，对吧？

像这样的东西应该工作：

```
INSERT INTO log_sheet (employee_id, date)
    SELECT id, DATE(NOW()) 
    FROM   employee
    WHERE  name = 'admin' 
      AND  id NOT IN ( SELECT DISTINCT employee_id FROM log_sheet ) 
```

要预览这会做什么，请`#`在该`INSERT`行之前添加。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T23:14:47.313

试试下面的查询：

```
insert into log_sheet (date, employee_id) 
(
SELECT now(),
    employee.id
FROM employee
LEFT OUTER JOIN log_sheet ON employee.id = log_sheet.employee_id
WHERE employee.name = 'admin' AND log_sheet.`date` IS NULL
) 
```

# c++ - 定位集群上运行的多线程程序的分段错误

> ID：13388810
> 
> 赞同：7
> 
> 时间：2012-11-14T22:56:10.633
> 
> 标签：c++, multithreading, segmentation-fault, cluster-computing, hpc

在交互模式下运行简单程序时，使用它`gdb`来定位分段错误非常简单。但是考虑我们有一个多线程程序 - 由 - 编写`pthread`- 提交到集群节点（通过`qsub`命令）。所以我们没有交互式操作。

我们如何定位分段错误？我正在寻找一种通用方法、程序或测试工具。我无法提供可重现的示例，因为该程序非常大，并且在某些未知情况下会在集群上崩溃。

我需要在这种困难的情况下找到问题，因为程序可以在本地机器上以任意数量的线程正确运行。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-14T23:02:25.130

“正常”的方法是让环境生成一个核心文件并获取这些文件。如果这不是一个选项，您可能想尝试安装一个信号处理程序`SIGSEGV`，至少获得一个转储到某处的堆栈跟踪。当然，这会立即导致[“如何获取堆栈跟踪”](https://stackoverflow.com/questions/616653/portable-c-stack-trace-on-exception)的问题，但这在其他地方得到了回答。

最简单的方法可能是获取核心文件。假设您有一台可以读取核心文件的类似机器，您可以使用它`gdb program corefile`来调试`program`生成核心文件的程序`corefile`：您应该能够查看不同的线程、它们的数据（在某种程度上）等。如果您没有合适的机器，可能需要交叉编译`gdb`匹配运行它的机器的硬件。

我对核心文件为空的说法有点困惑：您可以`ulimit`在 shell 上设置核心文件的限制。如果核心的大小设置为零，则不应生成任何核心文件。生产一个空的似乎很奇怪。但是，如果您无法更改程序的限制，您可能只能安装信号处理程序并从有问题的线程中转储堆栈跟踪。

考虑一下，假设您可以在相应的机器上运行调试器，您也许可以让程序在信号处理程序中进入睡眠状态并使用调试器附加到它。您将确定进程 ID（使用，例如，`ps -elf | grep program`），然后使用附加到它

```
gdb program pid 
```

不过，我不确定如何让程序在程序中进入睡眠状态（可能`SIGSTOP`为`SIGSEGV`...安装处理程序）。

也就是说，我假设您尝试在本地计算机上运行您的程序......？有些问题比需要在每个节点上运行多个线程的分布式系统更为根本。显然，这不能替代上述方法。

# java - 我怎样才能得到 jsapi.jar

> ID：13388812
> 
> 赞同：-1
> 
> 时间：2012-11-14T22:56:13.540
> 
> 标签：java, python, jython, cmusphinx

我正在开发一个使用 CMU Sphinx4 的应用程序，但是当我尝试运行 PythonTranscriber 时出现以下错误：

```
[root@karen python]# java -cp /home/karen/jython2.5/jython.jar:$CLASSPATH org.python.util.jython PythonTranscriber.py 
Traceback (most recent call last):
  File "PythonTranscriber.py", line 36, in <module>
    from edu.cmu.sphinx.jsapi import JSGFGrammar
ImportError: No module named jsapi 
```

我注意到目录：`"/home/karen/sphinx4-1.0beta5-scr2/sphinx4-1.0beta/lib"` 没有 jsapi.jar。我试图在另一个目录中寻找它，但我找不到它。

我怎样才能在目录中获取 jsapi.jar：`"/home/karen/sphinx4-1.0beta5-scr2/sphinx4-1.0beta/lib"` 它应该在那里！请帮忙！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T06:54:08.333

它似乎与 Sphinx-4 一起提供。请参阅[此安装教程](http://www.robbrewer.me/projects/speechlion/INSTALL.html)。

基本说明：

从 SourceForge下载[Sphinx-4 1.0beta4 包。](http://sourceforge.net/projects/cmusphinx/files/sphinx4/1.0%20beta4/sphinx4-1.0beta4-bin.zip/download)

然后，运行以下命令：

```
unzip sphinx4-1.0beta4-bin.zip
cd sphinx4-1.0beta4-bin/lib
sh jsapi.sh 
```

您需要接受屏幕上显示的 BCL 许可协议（滚动到最后，然后按“y”），这将解压缩`jsapi.jar`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T23:22:12.353

经过一番谷歌搜索（和诅咒）后，我最终得到了：

[http://www.oracle.com/technetwork/java/jsapifaq-135248.html#implementation](http://www.oracle.com/technetwork/java/jsapifaq-135248.html#implementation)

它指向提供 JSAPI 实现的人员列表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-21T09:03:32.553

我遇到了同样的错误。您所要做的就是安装**sharutils**。就我而言，我使用的是 Redhat 6，因此“sudo yum install sharutils”应该安装 sharutils，并且您应该能够运行“sh jsapi.sh”而不会出现任何错误。

# java - 根据文件大小将一个 Pdf 文件拆分为多个

> ID：13388816
> 
> 赞同：2
> 
> 时间：2012-11-14T22:56:23.773
> 
> 标签：java, pdf, itext

我一直在尝试根据其大小将一个大 PDF 文件拆分为多个 pdf 文件。我能够拆分它，但它只创建一个文件，其余文件数据丢失。意味着它不会创建多个文件来拆分它。有人可以帮忙吗？这是我的代码

```
public static void main(String[] args) {
    try {
        PdfReader Split_PDF_By_Size = new PdfReader("C:\\Temp_Workspace\\TestZip\\input1.pdf");
        Document document = new Document();
        PdfCopy copy = new PdfCopy(document, new FileOutputStream("C:\\Temp_Workspace\\TestZip\\File1.pdf"));
        document.open();

        int number_of_pages = Split_PDF_By_Size.getNumberOfPages();
        int pagenumber = 1; /* To generate file name dynamically */
        // int Find_PDF_Size; /* To get PDF size in bytes */
        float combinedsize = 0; /* To convert this to Kilobytes and estimate new PDF size */
        for (int i = 1; i < number_of_pages; i++ ) {
            float Find_PDF_Size;
            if (combinedsize == 0 && i != 1) {
                document = new Document();
                pagenumber++;
                String FileName = "File" + pagenumber + ".pdf";
                copy = new PdfCopy(document, new FileOutputStream(FileName));
                document.open();
            }

            copy.addPage(copy.getImportedPage(Split_PDF_By_Size, i));
            Find_PDF_Size = copy.getCurrentDocumentSize();
            combinedsize = (float)Find_PDF_Size / 1024;
            if (combinedsize > 496 || i == number_of_pages) {
                document.close();
                combinedsize = 0;
            }
        }

        System.out.println("PDF Split By Size Completed. Number of Documents Created:" + pagenumber);                        
    }
    catch (Exception i)
    {
        System.out.println(i);
    }
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T23:51:37.480

（顺便说一句，如果您也用*itext*标记了您的问题，那就太好了。）

`PdfCopy`用于在页面导入源切换或关闭`PdfReaders`时关闭它导入的页面。这是由于最初的预期用例是从**多个源 PDF 创建****一个**目标 PDF 以及许多用户忘记关闭其.`PdfReader``PdfCopy`****`PdfReaders`****

 ****因此，在您关闭第一个目标之后`PdfCopy`，`PdfReader`也将关闭，并且不会提取更多页面。

如果我正确解释最近签入到 iText SVN 存储库，则此隐式关闭`PdfReaders`正在从代码中删除。因此，使用下一个*iText*版本之一，您的代码可能会按预期工作。****

# image - 为什么有些图片在不同的浏览器中不显示？

> ID：13388817
> 
> 赞同：0
> 
> 时间：2012-11-14T22:56:30.637
> 
> 标签：image, cross-browser

我有*不真实的问题*。我有一个网站，其中在经典`<img>`标签上显示图像。

所有图像都从数据库加载，图像的*URL 列*在哪里。我的问题是**十**张图片**中有三张没有显示**。

但是如果我打开源代码并单击图像的 URL，我可以看到图像。

在源代码中有一些看起来像（只是一个简单的例子）：

```
<img src = "http://some.image/1.jpg" alt = "description" height = "140" width = "187" /> 
```

但**最大的障碍**是**Opera 显示所有图像都正确**，但只是在**FF**、**IE**、**Chrome**中提到了问题。

我不能提供*截图*，因为页面有点反常。如何显示问题所在的站点？或者一些建议？谢谢你。

# visual-studio-2010 - 阻止 Visual Studio 将数字附加到新控件的末尾

> ID：13388819
> 
> 赞同：2
> 
> 时间：2012-11-14T22:56:39.057
> 
> 标签：visual-studio-2010

我想知道是否有任何方法可以阻止 Visual Studio 2010 在我创建的新控件的 ID 末尾附加一个数字。例如，当我添加一个新的文本框时，我希望它这样做：

```
<asp:TextBox ID="TextBox" runat="server">
<asp:TextBox ID="TextBox" runat="server">
<asp:TextBox ID="TextBox" runat="server"> 
```

而不是这个：

```
<asp:TextBox ID="TextBox1" runat="server">
<asp:TextBox ID="TextBox2" runat="server">
<asp:TextBox ID="TextBox3" runat="server"> 
```

适当地重命名它们会更容易，所以我不必每次都用箭头/鼠标移动并删除数字。当我写这篇文章时，“可能已经有你答案的问题”提出了这个建议：

[如何防止 Visual Studio 重命名我的控件？](https://stackoverflow.com/questions/484327/how-do-i-prevent-visual-studio-from-renaming-my-controls)

诚然，这是我烦恼的最大部分，但这似乎完全关闭了输入`ID=""`字段，而不仅仅是粘贴控件。关闭新的未粘贴控件的编号并且也不重命名粘贴的控件仍然会有所帮助。目前我正在使用 ASP.NET，但如果它也有一种方法可以用于 WinForms，那就太好了。

在任何人建议之前，我确实知道如果我不适当地重命名它们，允许它附加数字可以防止名称冲突。但是，我宁愿让它编译失败，所以我知道现在解决问题（如果我忘记正确命名某些东西），而不是`"TextBox1"`稍后在代码中找到随机项。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-11T22:26:22.707

在视觉工作室转到：

工具 > 选项 > 文本编辑器 > HTML > 其他

取消选中“在源视图中粘贴时自动 ID 元素”。

# jquery - DropKick 插件无法使用可滚动性 | 移动滚动

> ID：13388821
> 
> 赞同：2
> 
> 时间：2012-11-14T22:56:56.840
> 
> 标签：jquery, mobile, scroll

我正在尝试让[Scrollability](http://joehewitt.github.com/scrollability/)与[Dropkick 插件](http://jamielottering.github.com/DropKick/)一起使用。DropKick 声称它适用于可滚动性，但是我无法让它适用于移动滚动。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-04T22:50:51.523

似乎有一段时间没有更新可滚动性，如果您使用的是 dropkick 和 jquery，这是我必须做的，请在您的 scrollability.js 文件上编辑以下内容：

代替：

```
require.ready(function() {
   document.addEventListener(isTouch ? 'touchstart' : 'mousedown', onTouchStart, false);
   window.addEventListener('load', onLoad, false);
}); 
```

为了这：

```
$(document).ready(function(){
   document.addEventListener(isTouch ? 'touchstart' : 'mousedown', onTouchStart, false);
   window.addEventListener('load', onLoad, false);
}); 
```

并注释掉以“export”开头的行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T11:29:37.040

也在 github scrollability.js 问题上检查它

[https://github.com/joehewitt/scrollability/issues/36](https://github.com/joehewitt/scrollability/issues/36) 或 [https://github.com/joehewitt/scrollability/issues/37](https://github.com/joehewitt/scrollability/issues/37)

# c++ - 在 boost::spirit::karma 中使用 boost::fusion::map

> ID：13388824
> 
> 赞同：3
> 
> 时间：2012-11-14T22:57:22.867
> 
> 标签：c++, boost-spirit, boost-fusion

我正在使用 boost spirit 将一些文本文件解析为一个数据结构，现在我开始从这个数据结构中生成文本（使用 spirit karma）。

对数据结构的一种尝试是 boost::fusion::map （如对 [这个](https://stackoverflow.com/questions/409827/boosttuples-vs-structs-for-return-values)问题的回答中所建议的那样）。但是，虽然我可以使用 boost::spirit::qi::parse() 并轻松获取其中的数据，但当我尝试使用 karma 从中生成文本时，我失败了。

下面是我的尝试（尤其是“map_data”类型）。在阅读和尝试了其他融合类型之后，我发现了 boost::fusion::vector 和 BOOST_FUSION_DEFINE_ASSOC_STRUCT。我成功地用它们生成了输出，但它们似乎并不理想：在向量中，你不能使用名称访问成员（它就像一个元组）——而在另一个解决方案中，我认为我不需要两种方式（成员名称和密钥类型）来访问成员。

```
#include <iostream>
#include <string>
#include <boost/spirit/include/karma.hpp>
#include <boost/fusion/include/map.hpp>
#include <boost/fusion/include/make_map.hpp>
#include <boost/fusion/include/vector.hpp>
#include <boost/fusion/include/as_vector.hpp>
#include <boost/fusion/include/transform.hpp>

struct sb_key;
struct id_key;

using boost::fusion::pair;

typedef boost::fusion::map
  < pair<sb_key, int>
  , pair<id_key, unsigned long>
  > map_data;

typedef boost::fusion::vector < int, unsigned long > vector_data;

#include <boost/fusion/include/define_assoc_struct.hpp>
BOOST_FUSION_DEFINE_ASSOC_STRUCT(
    (), assocstruct_data,
    (int, a, sb_key)
    (unsigned long, b, id_key))

namespace karma =  boost::spirit::karma;

template <typename X>
std::string to_string ( const X& data )
{
  std::string generated;
  std::back_insert_iterator<std::string> sink(generated);
  karma::generate_delimited ( sink, karma::int_ << karma::ulong_, karma::space, data );
  return generated;
}

int main()
{
  map_data d1(boost::fusion::make_map<sb_key, id_key>(234, 35314988526ul));
  vector_data d2(boost::fusion::make_vector(234, 35314988526ul));
  assocstruct_data d3(234,35314988526ul);

  std::cout << "map_data as_vector: " << boost::fusion::as_vector(d1) << std::endl;
  //std::cout << "map_data to_string: " << to_string(d1) << std::endl; //*FAIL No 1*
  std::cout << "at_key (sb_key): " << boost::fusion::at_key<sb_key>(d1) << boost::fusion::at_c<0>(d1) << std::endl << std::endl;

  std::cout << "vector_data: " << d2 << std::endl;
  std::cout << "vector_data to_string: " << to_string(d2) << std::endl << std::endl;

  std::cout << "assoc_struct as_vector: " << boost::fusion::as_vector(d3) << std::endl;
  std::cout << "assoc_struct to_string: " << to_string(d3) << std::endl;
  std::cout << "at_key (sb_key): " << boost::fusion::at_key<sb_key>(d3) << d3.a << boost::fusion::at_c<0>(d3) << std::endl;

  return 0;
} 
```

包括注释行会给出很多页面的编译错误，其中值得注意的是：从 'boost::fusion::pair' 到 'double' 的参数 1 没有已知的转换 'boost::fusion 的参数 1 没有已知的转换::pair'到'浮动'</p>

可能是 to_string 需要 map_data 的值，而不是对？虽然我不擅长模板，但我尝试通过以下方式使用变换从地图中获取矢量

```
template <typename P>
struct take_second
{
  typename P::second_type operator() (P p)
  {
    return p.second;
  }
};
// ... inside main()
pair <char, int> ff(32);
std::cout << "take_second (expect 32): "
  << take_second<pair<char,int>>()(ff) << std::endl;
std::cout << "transform map_data and to_string: "
  << to_string(boost::fusion::transform(d1, take_second<>())); //*FAIL No 2* 
```

但是我不知道在实例化 take_second 时我应该给出什么类型，无论如何我认为必须有一种更简单的方法来获取（迭代）地图的值（有吗？）

如果您回答了这个问题，还请就使用 ASSOC_STRUCT 还是使用地图更好地发表您的意见。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-15T01:08:49.687

我想我之前[在 [spirit-general] 列表中](http://boost.2283326.n4.nabble.com/karma-how-to-generate-with-a-boost-fusion-map-as-data-td4638494.html)注意到了您的问题。

它在那里获得了 14 次观看——我做了一些相当深入的调查。遗憾的是，据我所知，我认为 Spirit 不支持相关的 Fusion 结构。

事实上，在 MSM 和 Phoenix 之外，我在 boost 中没有看到使用 fusion::map 的地方。

您是否有机会只使用 std::map/std::pair 代替？这是一个小小的概念证明：

```
#include <boost/spirit/include/karma.hpp>
#include <boost/fusion/adapted.hpp>

int main()
{
    const auto data = std::map<std::string, double> { 
        { "pi", 3.1415925 }, 
        { "e", 2.718281828 }, 
        { "Answer", 42 } };

    namespace karma = boost::spirit::karma;
    std::cout << karma::format((karma::string << " = " << karma::double_) % karma::eol, data)
              << std::endl;
} 
```

输出：

```
Answer = 42.0
e = 2.718
pi = 3.142 
```

# arrays - 变量矩阵 NumPy 的值

> ID：13388826
> 
> 赞同：4
> 
> 时间：2012-11-14T22:57:26.080
> 
> 标签：arrays, matrix, numpy, python-2.7

我正在开发一个确定线是否相交的程序。我正在使用矩阵来做到这一点。我了解所有数学概念，但我是 Python 和 NumPy 的新手。

我想将斜率变量和 yint 变量添加到新矩阵中。他们都是花车。我似乎无法弄清楚输入它们的正确格式。这是一个例子：

```
import numpy as np

x = 2
y = 5
w = 9
z = 12 
```

我知道如果我只是输入原始数字，它看起来像这样：

```
matr = np.matrix('2 5; 9 12') 
```

不过，我的目标是输入变量名而不是整数。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-14T23:23:15.027

你可以做：

```
M = np.matrix([[x, y], [w, z]])

# or
A = np.array([[x, y], [w, z]]) 
```

我也包括了数组，因为我建议使用数组而不是矩阵。尽管起初矩阵似乎是一个好主意（或者至少对我来说是这样），但是通过使用数组，您可以避免很多麻烦。[以下是两者的比较，可帮助您确定哪个适合您。](http://www.scipy.org/NumPy_for_Matlab_Users#head-e9a492daa18afcd86e84e07cd2824a9b1b651935)

我能想到的数组的唯一缺点是矩阵乘法运算不那么漂亮：

```
# With an array the matrix multiply like this
matrix_product = array.dot(vector)

# With a matrix it look like this
matrix_product = matrix * vector 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-14T23:12:10.893

你能像这样格式化字符串吗？：

```
import numpy as np

x = 2
y = 5
w = 9
z = 12

matr = np.matrix('%s %s; %s %s' % (x, y, w, z)) 
```

# java - 写入静态字段 - 在这种情况下 FindBugs 错了吗？

> ID：13388829
> 
> 赞同：12
> 
> 时间：2012-11-14T22:57:35.230
> 
> 标签：java, static-methods, static-members, findbugs

我有一个这样的Java类：

```
public class Foo {

    public static int counter = 0;

    public void bar(int counter) {
        Foo.counter = counter;
    }
} 
```

`counter`FindBugs 警告我通过实例方法写入静态字段`bar`。但是，如果我将代码更改为：

```
public class Foo {

    public static int counter = 0;

    public static void setCounter(int counter) {
        Foo.counter = counter;
    }

    public void bar(int counter) {
        setCounter(counter);
    }
} 
```

然后 FindBugs 不会抱怨。那不是错了吗？我仍在从实例方法写入静态字段，只是通过静态方法，不是吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-11-14T23:08:25.283

假设在未来的某个时候，您决定这个 setter 方法需要是线程安全的，并且您想要实现它`synchronized`。

这段代码可以正常工作：

```
public synchronized static void setCounter(int counter) {
    Foo.counter = counter;
}

public void bar(int counter) {
    setCounter(counter);
} 
```

此代码是错误的，并且会有不正确的行为：

```
public synchronized void bar(int counter) {
    Foo.counter = counter;
} 
```

在这个人为的示例中，这似乎没有显着差异，尤其是因为`counter`通常可以标记为`volatile`。但是，在实际示例中，setter 方法具有更复杂的逻辑并且从许多不同的地方（不仅仅是从一个实例方法）调用，后一种模式将更容易重构。

顺便说一句，在我看来，[Google 的 CodePro Analytix](https://developers.google.com/java-dev-tools/codepro/doc/)插件是一个比 FindBugs 更快、更全面的工具。

有关的：

*   [Java 中的同步与易失性](https://stackoverflow.com/questions/3519664/difference-between-volatile-and-synchronized-in-java-j2me)
*   [同步的 Getter 和 Setter](https://stackoverflow.com/questions/11459543/java-synchronized-getters-and-setters)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-14T23:12:40.080

从[错误描述](http://findbugs.sourceforge.net/bugDescriptions.html)的 FindBugs 列表中：

> ST：从实例方法写入静态字段（ST_WRITE_TO_STATIC_FROM_INSTANCE_METHOD）
> 
> 此实例方法写入静态字段。如果正在操纵多个实例，这很难纠正，而且通常是不好的做法。

通过从实例方法调用的静态方法访问静态字段没有类似的错误描述。

[您可能想在 FindBugs邮件列表](https://mailman.cs.umd.edu/mailman/listinfo/findbugs-discuss)上讨论此决定背后的理由

# java - Java For-Each 循环处理多手

> ID：13388831
> 
> 赞同：2
> 
> 时间：2012-11-14T22:57:43.513
> 
> 标签：java, foreach

我正在尝试找到一种将牌“发”到 4 只不同手牌的好方法。

```
 System.out.println("Deal to 4 Hands: "); 

         Hand hand1 = new Hand();
         Hand hand2 = new Hand();
         Hand hand3 = new Hand();
         Hand hand4 = new Hand();

         hand1.addSingleCard(Deck.deal());
         hand2.addSingleCard(Deck.deal());             
         hand3.addSingleCard(Deck.deal());
         hand4.addSingleCard(Deck.deal());

         hand1.addSingleCard(Deck.deal());
         hand2.addSingleCard(Deck.deal());            
         hand3.addSingleCard(Deck.deal());
         hand4.addSingleCard(Deck.deal());

         System.out.println("Cards left in deck: " + Deck.size());

         System.out.println("Player 1's Hand: \n" + hand1.getHand());
         System.out.println("Player 2's Hand: \n" + hand2.getHand());
         System.out.println("Player 3's Hand: \n" + hand3.getHand());
         System.out.println("Player 4's Hand: \n" + hand4.getHand()); 
```

有没有更简单的方法来对付双手？例如使用 For-Each 循环？

我试过这个：但它不起作用。我还没有真正使用过这种类型的循环非常必须......

```
 for(Hand card : hand1){
            System.out.println("Player 1's Hand: \n" + hand1);
         } 
```

顺便说一句，这会将 2 张牌发给 4 个不同的手，然后打印每手。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-14T23:02:40.340

创建一个数组！

```
Hand[] hands = new Hand[4];

// create Hand object within the array and deal a single card to each hand
for(int i = 0; i < hands.length; i++) {
    hands[i] = new Hand();
    hands[i].addSingleCard(Deck.deal());
}

// deal an additional card to each hand (use a nested loop for dealing additional cards, if necessary)
for(int i = 0; i < hands.length; i++) {
    hands[i].addSingleCard(Deck.deal());
}

System.out.println("Cards left in deck: " + Deck.size());

for(int i = 0; i < hands.length; i++) {
    System.out.printf("Player %d's hand: \n %s\n", i+1, hands[i]);
} 
```

该数组包含 4 个单独的 Hand 对象，并允许您通过遍历数组对所有手执行操作。

如果每只手有四个不同的命名变量（hand1、hand2 等），那么如果不在操作中显式使用变量名称（hand1.dealSingleCard() 等），就没有简单的方法可以对它们所代表的对象执行操作。

循环数组是要走的路:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-14T23:03:52.933

尝试这个：

```
 System.out.println("Deal to 4 Hands: "); 

 Hand[] hands=new Hand[4];
 for(int i=0;i<hands.length;i++)
      hands[i]=new Hand();
 for(Hand hand:hands)
      hand.addSingleCard(Deck.deal());
 for(Hand hand:hands)
      hand.addSingleCard(Deck.deal());
 System.out.println("Cards left in deck: " + Deck.size());
 for(int i=0;i<hands.length;i++)
      System.out.println("Player "+i+"'s Hand: \n" + hands[i].getHand()); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-14T23:10:56.870

您的 for 循环不起作用，因为您将 Hand 对象之一作为要迭代的项目。我不是 100% 熟悉这种 for 循环风格的所有应用程序，但根据我的经验，它用于在对象列表中移动。所以你想做这样的事情：

```
 System.out.println("Deal to 4 Hands: "); 

     Hand hand1 = new Hand();
     Hand hand2 = new Hand();
     Hand hand3 = new Hand();
     Hand hand4 = new Hand();

     List<Hand> handList = new ArrayList<Hand>();
     handList.add(hand1);
     handList.add(hand2);
     handList.add(hand3);
     handList.add(hand4);

     for (Hand currHand : handList) {
         currHand.addSingleCard(Deck.deal());
         currHand.addSingleCard(Deck.deal());
     } 
```

我意识到我没有使用 for 循环来添加到列表中，但我正在工作，复制粘贴比从头开始编写更容易。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-14T23:07:36.410

怎么样：

```
for(int j=0; j<MAX_NUMBER_OF_DEALS_PER_PLAYER;j++)
{
  for(int i=0; i<MAX_HAND_SIZE;i++)
  {
    handsArray[i].addSingleCard(Deck.deal());
  }
} 
```

?

然后，您可以将交易数量设置为 2，例如，以复制您的示例。手的大小将取决于您要玩的游戏类型。

当然，您需要先初始化数组，例如：

```
Hand[] handsArray = new Hand[MAX_NUMBER_OF_PLAYERS];
for(int i=0;i<MAX_NUMBER_OF_PLAYERS;i++)
{
  handsArray[i] = new Hand();

} 
```

这是你要找的吗？

如果您想使用 foreach 循环，您当然可以执行您发布的操作：

```
for(Hand card : hand1){
  System.out.println("Player 1's Hand: \n" + card); //notice it needs to be card here, NOT hand1
} 
```

除了注意你需要在这里将hand1 更改为card，以打印手中的每张卡片。否则，您将为每张卡片打印相同的值（hand1），因此如果您有 3 张卡片，它将打印 hand1 的值 3 次。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-14T23:03:11.027

将您的手存储在一个数组（或一个列表）中，并使用两个嵌套循环：

```
for (int i = 0; i < 2; i++) {
    for (Hand hand : hands) {
        hand.addSingleCard(Deck.deal());
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-14T23:04:52.287

您只能在实现 Iterable 的类上使用 ForEach 循环

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-14T23:06:32.207

像这样的东西可以工作（虽然未经测试）：

```
Hand hands[] = new Hand[] {hand1, hand2, hand3, hand4};
for (int i=0; i<2; i++) {               // deal 2 cards
    for (Hand currentHand: hands) {     // to each hand
         currentHand.addSingleCard(Deck.deal());
    }
 }

for (int i=0; i<hands.length; i++)  {
     System.out.println("Player " + i + "'s Hand: \n" + hands[i].getHand());
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-11-14T23:14:23.303

要使用for-each 循环，您需要某种类型的Iterable，可以是Collection（即List），也可以是数组。在这种情况下，您的代码可以大大简化：

```
private static final NUM_HANDS = 4;
System.out.println("Deal to 4 Hands: "); 
List<Hand> hands = new ArrayList<Hand>();
for(int i=0; i<NUM_HANDS) {
    hands.add(new Hand());
    hand.addSingleCard(Deck.deal());
}
int handNum = 1;
for (Hand hand: hands) {
    hand.addSingleCard(Deck.deal());
    System.out.println("Player " + handNum + "'s Hand: \n" + hand.getHand());
    handNum++;
}
System.out.println("Cards left in deck: " + Deck.size()); 
```

# bing-maps - 文本未显示在自定义图钉中？有办法吗？

> ID：13388832
> 
> 赞同：0
> 
> 时间：2012-11-14T22:57:43.533
> 
> 标签：bing-maps, pushpin

这是我用来在 Bing 地图上绘制自定义图钉的代码。我无法在图钉图标上打印文本，该图钉图标只是默认图钉，但颜色不同。

甚至有可能这样吗？还有其他方法吗？好像没找到，求救！

```
var pushpinOptions = {icon: '/assets/greenpin.png', visible: true};
var pushpin = new Microsoft.Maps.Pushpin(new Microsoft.Maps.Location(lat, lng), pushpinOptions, {text: alphas[i] }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T01:17:02.247

知道了！只需将 htmlContent 添加到 pushpinOptions

```
var pushpinOptions = {icon: '/assets/greenpin.png', 
    visible: true, 
    htmlContent: '<div style="position: absolute; text-align: center; width: 100%; font-family: Arial, Helvetica, sans-serif; font-size: 10pt; font-style: normal; font-variant: normal; font-weight: bold; line-height: normal; color: rgb(255, 255, 255); left: 0px; top: 5px; ">'+alphas[i]+'</div>'
}; 
```

# emacs - Yasnippet 中的 ido 保存新片段

> ID：13388834
> 
> 赞同：0
> 
> 时间：2012-11-14T22:57:50.680
> 
> 标签：emacs, yasnippet, ido

我想保存一个新的片段。Emacs24 向我询问文件名，但 ido 在 minibuffer 中不起作用。这是一个已知的错误，还是我的配置中的错误。

### 如何重现：

```
$ emacs /tmp/test.tex 
```

菜单：YSSnippet/新片段

我创建了一个小片段

```
# -*- mode: snippet -*-
# name: int
# key: int
# --
\int_{$1}^{$2} $3 \diff\,$4 
```

现在我想保存它并按`C-x C-s` minibuffer 说 `File to save in: /tmp/` 我希望`ido`这个 minibuffer 中的功能应该看起来像

```
Write file: /tmp/{test.tex| foo.tex | bar.tex | ...} 
```

但它不起作用。我的配置在[github上](https://github.com/jonasstein/emacs-config)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T14:50:33.150

也许你想定制`ido-everywhere`？

# iphone - UIView 动画结果不一致

> ID：13388835
> 
> 赞同：0
> 
> 时间：2012-11-14T22:57:53.863
> 
> 标签：iphone, objective-c, animation, uiview

我正在尝试利用 UIView 动画在屏幕上滑动我的视图。我的视图控制器中有一个 UIScrollView，其中有我的 UIView。

我也有这个方法：

```
-(void)translateView:(UIView *)view toRect:(CGRect)rect withDuration:(CGFloat)duration
{
    [UIView animateWithDuration:duration
    animations:^
    {
        view.frame = rect;
    }
    completion:^(BOOL finished)
    {
        //Finished
    }];
} 
```

我称之为在一定时间内以动画方式将我的 UIView 移动到我选择的 CGRect 上。我有一个循环创建并滑出 7 个视图。这很好用，我这样称呼它，循环当然会在不同的视图上调用 7 次：

```
[self translateView:cell toRect:translationRect withDuration:0.7]; 
```

但是，之后我不能立即再次调用它，只是没有任何反应。虽然，假设我在 2 秒 NSTimer 后再次调用它，动画确实运行，但是当我滚动我的 UIScrollView 时，我刚刚动画的视图跳回到它之前的 CGRect。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-15T03:30:39.360

您的故事板已启用自动布局。当自动布局运行时，它会根据您在情节提要中设置的（或为您自动设置的）约束来设置视图的框架。这意味着如果您更改视图的框架，自动布局将在下次运行时撤消您的更改。

系统会在不同时间自动触发自动布局，包括滚动滚动视图时。这就是为什么您在滚动时看到视图“跳回”的原因。

**如果您不需要自动布局，**则可以将其关闭（如果您需要帮助将其关闭，请参阅[此答案）。](https://stackoverflow.com/questions/13201586/nsinvalidunarchiveoperationexception-could-not-instantiate-class-named-nslayout/13201690#13201690)然后，您可以在情节提要中使用较旧的“弹簧和支柱”布局系统，它可以让您根据需要设置视图的框架。

**如果您确实需要自动布局，则**需要学习如何使动画与自动布局一起使用。有两种基本方法。一种方法是修改约束，以便自动布局将视图放置在您想要的位置，然后`[view layoutIfNeeded]`在动画块中执行以将视图动画到其新位置。另一种方法是使用 a`NSTimer`或 a为约束本身设置动画`CADisplayLink`。

[WWDC 2012 视频](https://developer.apple.com/videos/wwdc/2012/)“ Session 228 - Best Practices for Mastering Auto Layout”解释了您的问题，并深入讨论了这两种技术，从 30 分 45 秒开始。如果您需要使用带有自动布局的动画，我**强烈**建议您观看该视频以及 WWDC 2012 中其他与自动布局相关的视频。

# java - 如何为 DB2 通用 JDBC 驱动程序设置套接字超时？

> ID：13388837
> 
> 赞同：3
> 
> 时间：2012-11-14T22:57:56.967
> 
> 标签：java, jdbc, db2, settimeout, websphere-6.1

如何在 WebSphere Application Server 6.1 上为 DB2 (9.7) 通用 JDBC 驱动程序数据源设置套接字超时？我已经尝试按照[IBM Technote](http://www-01.ibm.com/support/docview.wss?uid=swg21590014)`blockingReadConnectionTimeout`的说明添加该属性，但问题仍然存在。还有另一种设置此属性的方法吗？我应该在 Java 应用程序代码中设置它吗？

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T13:47:32.690

尝试通过管理控制台更改连接池设置的超时。

```
Data sources > Default > Connection pools 
```

具体来说，有一个名为 Connection timeout 的属性。我们的设置为 60。

# sql - Ã¶的奇怪编码问题

> ID：13388848
> 
> 赞同：2
> 
> 时间：2012-11-14T22:59:21.877
> 
> 标签：sql, sql-server-2008, encoding, character-encoding

我正在尝试从 sql server 2008 db 中提取以下字符作为 unicode

字符应该是变音符号

这是表中的架构信息

```
character_set_name    collation_name

iso_1                 SQL_Latin1_General_CP1_CI_AS 
```

这是我的选择声明

```
select 
    StudentName

from GenData.dbo.StudentInfo 
where StudentID = 105
order by studentname COLLATE SQL_Latin1_General_Pref_CP850_CI_AS 
```

然而，上面仍然产生：

```
Ã¶ 
```

有谁知道我做错了什么或如何提取这个角色？您的帮助将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T23:05:09.590

如果您将列从`char`或更改`varchar`为`nvarchar`它应该可以解决未来的问题。

```
ALTER TABLE MyTable ALTER COLUMN MyField nvarchar(1234) 
```

请注意在 sql 查询中使用 nvarchar。

```
 'this is varchar'
  N'but this is nvarchar' 
```

就恢复已经倾斜的信息而言，根据我的经验，这通常是一个艰难的反复试验过程。您可以尝试在 varchar 字段中输入字符并使用该信息来清理您的数据。

```
INSERT INTO #transpose
SELECT '' low, N'Ü' high
UPDATE #transpose SET low = high

Update MyTable 
SET MyFIELD = REPLACE(MyField, low, high) 
FROM MyTable 
CROSS JOIN #transpose 
```

# java - 为什么 Hibernate 4 的逆向工程工具不会为实体类创建关系注解？

> ID：13388851
> 
> 赞同：1
> 
> 时间：2012-11-14T23:00:05.240
> 
> 标签：java, eclipse, hibernate, spring-mvc, reverse-engineering

我在尝试让 Hibernate 4 从我的数据库模式中对实体类进行逆向工程时遇到了很多困难。我的数据库实际上是一个 Derby 数据库，但是在阅读之后，我听说 Derby 可能存在休眠逆向工程问题，所以我决定使用 MySQL 数据库连接生成实体，但使用生成的实体我的德比联系（如果有任何意义的话）。

我有安装了 JBoss 的 Hibernate 插件的 SpringToolsSuite。我从数据库开发的角度出发，创建了一个成功链接到 MySQL 的数据源。我可以从 STS/Eclipse 内部很好地探索这些表。然后我进入 Hibernate 透视图并设置控制台配置。同样，这似乎是成功的，从 Hibernate 的角度来看，我可以浏览表并查看数据库表的列定义。然后我转到 Hibernate Code Generation Configurations 对话框来创建一个新配置。我选中“从 JDBC 连接进行反向工程”并检查所有 4 个已启用的选项。（我不能包含图片，因为我目前的声誉太低，如果这不完全清楚，请见谅）

逆向工程师确实使用这些设置并为我完成了很多任务，但一个主要问题是正在创建的实体没有正确注释它们的外键。例如，如果我有 Foo 并且 Foo 的列之一是 Bar 的外键，我希望在 Foo 的实体类中看到类似这样的内容：

```
...
@ManyToOne(fetch=FetchType.LAZY)
@JoinColumn(name = "barid", nullable = false, referencedColumnName="id")
@ForeignKey(name="FK_BarID")
private Bar bar;
... 
```

但我得到的用处不大：

```
...
@Column(name = "barid")
@NotNull
private Integer barid;
... 
```

现在，我决定看看是否可以让 Hibernate 4 的逆向工程功能使用比我实际尝试使用的更小的模式。最好是有人报告为工作的人。在谷歌搜索之后，我发现有人与我遇到的问题完全相同（尽管他的解决方案不适用于我的情况）在线一个小示例模式：

[http://forum.springsource.org/showthread.php?99864-Relationships-and-MySQL-domain-reverse-engineering](http://forum.springsource.org/showthread.php?99864-Relationships-and-MySQL-domain-reverse-engineering)

我不得不稍微改变他的模式，因为我的 MySQL 版本中的 InnoBD 引擎不满意外键只是 int，而他们引用的主键是 bigint。所以我使用以下架构：

```
create table folder (
    id bigint not null auto_increment,
    title varchar(100) not null,
    primary key (id) 
) ENGINE=InnoDB;

create table language (
    id bigint not null auto_increment,
    name varchar(30),
    code varchar(3),
    primary key (id) 
) ENGINE=InnoDB;

create table document (
    id bigint not null auto_increment,
    folderId bigint not null,
    title varchar(100) not null,
    primary key (id),
    FOREIGN KEY (folderId) REFERENCES folder(id)
) ENGINE=InnoDB;

create table page (
    id bigint not null auto_increment,
    version int not null default 1,
    documentId bigint not null,
    languageId bigint not null default 1,
    fileName varchar(100),
    primary key (id),
    FOREIGN KEY (documentId) REFERENCES document(id),
    FOREIGN KEY (languageId) REFERENCES language(id)
) ENGINE=InnoDB; 
```

我已经检查并验证了 InnoDB 是否处于活动状态并且正在使用（使用 SHOW TABLE STATUS WHERE NAME = 'TableName'; 命令），但这并不能解决链接所暗示的问题。我想如果我至少可以让这个基本模式做我想做的事，我可以让我的模式正常工作，但是经过数小时的尝试，我似乎无法让它识别任何模式的外键。有没有我遗漏的步骤？谢谢。

# flash - 使用 'gotoandplay/stop? 更改帧时隐藏 my_player 帧？

> ID：13388853
> 
> 赞同：1
> 
> 时间：2012-11-14T23:00:07.827
> 
> 标签：flash, adobe

**自己解决了。我应该指的是 my_loader 而不是 my_player**

我有一个愚蠢的东西。

我用 Flash 创建了某种“网站”，每页使用 1 帧。在第 3 帧上，我使用此代码创建了一个 youtube 视频播放器

```
Security.allowDomain("www.youtube.com");

var my_player:Object;

var my_loader:Loader = new Loader();
my_loader.load(new URLRequest("http://www.youtube.com/apiplayer?version=3")); 
my_loader.contentLoaderInfo.addEventListener(Event.INIT, onLoaderInit);

function onLoaderInit(e:Event):void{
addChild(my_loader);
my_player = my_loader.content;
my_player.addEventListener("onReady", onPlayerReady); 
} 

function onPlayerReady(e:Event):void{
my_player.setSize(640,360);
my_player.x = 370;
my_player.y = 200;
my_player.loadVideoById("44LnsBZ3OTc",0);
} 

play_btn.addEventListener(MouseEvent.CLICK, playVid); 
function playVid(e:MouseEvent):void { 
my_player.playVideo(); 
} 
pause_btn.addEventListener(MouseEvent.CLICK, pauseVid); 
function pauseVid(e:MouseEvent):void { 
my_player.pauseVideo();
} 
```

问题是：在切换帧时（GotoAndPlay(#)，它会按应有的方式更改帧，但 my_player 帧仍然存在。无论我尝试了什么。

有什么解决办法吗？

FLA 文件：[https ://www.dropbox.com/s/alouv7nxinnbjkp/EindopdrachtPortfolio.fla](https://www.dropbox.com/s/alouv7nxinnbjkp/EindopdrachtPortfolio.fla)

# jquery - Manually (re)inserting the jquery datepicker values for two datepicker fields

> ID：13388855
> 
> 赞同：0
> 
> 时间：2012-11-14T23:00:19.527
> 
> 标签：jquery, jquery-ui-datepicker

I have a lot of things going on in my datepicker file to achieve a few tasks. 1.) I needed to be able to block select dates or weekends (code not included below as it works) 2.) I needed a min and max date on each field to ensure the end user can't select anything less than, say, 3 days from the start date (see below)

My problem is that my website allows visitors to come BACK to the page they selected the dates on and change them if necessary to extend or shorten their stay. But when I come back, I can't seemingly pre-populate the fields properly so that my min/max date rules stay in-tact. How can I modify my code below to ensure my min/max rules are preserved while (re)inserting the values.

```
//CORE DATEPICKER FUNCTION
$(document).ready(function () {
$.datepicker.setDefaults({dateFormat: 'mm/dd/yy',minDate: +3,maxDate: "1Y +3D",changeMonth: true,firstDay: 1,changeYear: true,numberOfMonths: 2,constrainInput:true,beforeShowDay:nationalDays,});

$('#datepicker_start').datepicker({
            onSelect: function(selectedDate) {
    var minDate = $(this).datepicker('getDate');
    if (minDate) {minDate.setDate(minDate.getDate() + 3);}//min nights required
    $('#datepicker_end').datepicker('option', 'minDate', minDate || 1);
    days();
}}).val('12/11/2012');
$('#datepicker_end').datepicker({minDate: 1, onSelect: function(selectedDate) {
    var maxDate = $(this).datepicker('getDate');    
    if (maxDate) {maxDate.setDate(maxDate.getDate() - 1);}
    $('#datepicker_start').datepicker('option', 'maxDate', maxDate); // Date - 1    
    days();
}}).val('12/15/2012');
    $('#datepicker_start,#datepicker_end').change()
        }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T11:20:53.527

Essentially you need to be able to run the same code as in the `onSelect` option. By wrapping that code in a separate function you can call the function when the page loads as well as in the `onSelect` handler.

```
function setEndMin(){
     var minDate = $('#datepicker_start').datepicker('getDate');  
        if (minDate) {
            minDate.setDate(minDate.getDate() + 3);
        } //min nights requires
        $('#datepicker_end').datepicker('option', 'minDate', minDate || 1);

}

$('#datepicker_start').val('12/11/2012').datepicker({       
    onSelect: function(selectedDate) {
       setEndMin();
    }
});
/* after create both pickers can process  min/max*/
setEndMin() 
```

DEMO : [http://jsfiddle.net/XtS9B/4/](http://jsfiddle.net/XtS9B/4/)

# javascript - 如何进行多个 jQuery UI 拖放？

> ID：13388858
> 
> 赞同：3
> 
> 时间：2012-11-14T23:00:25.460
> 
> 标签：javascript, jquery, jquery-ui, drag-and-drop

提前感谢您花时间查看我的问题。

使用 jQuery 和 jQuery UI，我一直在尝试将诸如绷带、石膏和水坑之类的元素拖到一个火柴人的各个元素上。例如，如果绷带掉到他的左臂上，左臂的背景图像就会变为上面有绷带。

有一次，我的代码可以拖放您选择的第一个项目——这是一个开始。现在，我已经失去了它，它只是在做 jQuery 列表中的最后一个元素，在这种情况下，它是将水坑拖到火柴人的元素上。

我一直在尝试纠正它几个小时，但无法解决问题！

如果有人可以提供帮助，将不胜感激。

```
$(document).ready(function () {
  //Drag bandage
  $(".draggableBandage").draggable({ containment: ".scenarioSec", cursor: "pointer", helper: "clone" });
  //Drop bandage on right arm 
  $("#droppableRightArm").droppable({
    drop: function (event, ui) {
      $(this).addClass("rpRightArmBandage")
    }
  });
  //Drop bandage on right leg
  $("#droppableRightLeg").droppable({
    drop: function (event, ui) {
      $(this).addClass("rpRightLegBandage")
    }
  });
  //Drop bandage on head
  $("#droppableHead").droppable({
    drop: function (event, ui) {
      $(this).addClass("rpHeadBandage")
    }
  });
  //Drop bandage on left arm
  $("#droppableLeftArm").droppable({
    drop: function (event, ui) {
      $(this).addClass("rpLeftArmBandage")
    }
  });
  //Drop bandage on left leg
  $("#droppableLeftLeg").droppable({
    drop: function (event, ui) {
      $(this).addClass("rpLeftLegBandage")
    }
  });
});
$(document).ready(function () {
  //Drag plaster 
  $(".draggablePlaster").draggable({ containment: ".scenarioSec", cursor: "pointer", helper: "clone" });
  //Drop plaster on right arm
  $("#droppableRightArm").droppable({
    drop: function (event, ui) {
      $(this).addClass("rpRightArmPlaster")
    }
  });
  //Drop plaster on right leg
  $("#droppableRightLeg").droppable({
    drop: function (event, ui) {
      $(this).addClass("rpRightLegPlaster")
    }
  });
  //Drop plaster on head
  $("#droppableHead").droppable({
    drop: function (event, ui) {
      $(this).addClass("rpHeadPlaster")
    }
  });
  //Drop plaster on left arm
  $("#droppableLeftArm").droppable({
    drop: function (event, ui) {
      $(this).addClass("rpLeftArmPlaster")
    }
  });
  //Drop plaster on left leg
  $("#droppableLeftLeg").droppable({
    drop: function (event, ui) {
      $(this).addClass("rpLeftLegPlaster")
    }
  });
});
$(document).ready(function () {
  //Drag water
  $(".draggableWater").draggable({ containment: ".scenarioSec", cursor: "pointer", helper: "clone" });
  //Drop water on right arm
  $("#droppableRightArm").droppable({
    drop: function (event, ui) {
      $(this).addClass("rpRightArmWater")
    }
  });
  //Drop water on right leg
  $("#droppableRightLeg").droppable({
    drop: function (event, ui) {
      $(this).addClass("rpRightLegWater")
    }
  });
  //Drop water on head
  $("#droppableHead").droppable({
    drop: function (event, ui) {
      $(this).addClass("rpHeadWater")
    }
  });
  //Drop water on left arm
  $("#droppableLeftArm").droppable({
    drop: function (event, ui) {
      $(this).addClass("rpLeftArmWater")
    }
  });
  //Drop water on left leg
  $("#droppableLeftLeg").droppable({
    drop: function (event, ui) {
      $(this).addClass("rpLeftLegWater")
    }
  });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T00:23:15.933

好的，所以每次您附加一个新的`droppable`事件处理程序时，它都会覆盖您拥有的前一个事件处理程序，因此最后一个是唯一有效的。

所以我建议你处理被丢弃的对象的类型，并且每个肢体有一个事件处理程序。

我找出哪些项目被丢弃的方法是使用`data-`标记中的属性，然后在丢弃的事件中将它们拉出来。

这意味着您可以编写非常通用的代码，通过将对象类型附加到类名来动态应用适当的 css 样式。

```
<div class="draggableObject bandage" data-object="Bandage"></div>
<div class="draggableObject plaster" data-object="Plaster"></div> 
```

这是 javascript 示例：[这是 JSFiddle 中快速演示的链接](http://jsfiddle.net/V4ECr/1/)

```
$(document).ready(function() {
    $('.draggableObject').draggable();

    $('.droppableRightArm').droppable({
        drop: function(event, ui) {
            var $this = $(this); // reuse JQuery object.
            var droppedObject = ui.draggable.data('object'); // get object type
            // css reset
            $this.removeClass();
            $this.addClass("rpRightArm" + droppedObject);
            //
        }
    });
});​ 
```

# android - 在我们的页面上发布链接我们的应用程序不适用于移动设备

> ID：13388860
> 
> 赞同：0
> 
> 时间：2012-11-14T23:00:34.013
> 
> 标签：android, facebook, mobile, hyperlink, facebook-php-sdk

我想知道是否有人遇到这些问题，我们从 10 月 30 日开始：

当用户从 Facebook 原生 Android 应用程序内部点击任何指向我们应用程序的链接时（但不是所有设备，只有一些，我们认为这可能是最新版本的 facebook native 的问题，我们甚至有任何关于 iPhone 用户的报告，但我们与 Android 沟通的主要问题），他们收到此错误“此应用程序尚未配置其移动 Web URL 或 URL 无法验证为由应用程序拥有。无法重定向。” 我们以前从未设置过移动 Web URL，自从一年多前推出该应用程序以来，一切都很好。我们将所有移动点击发送到与桌面浏览器相同的 URL，并在服务器端处理移动渲染。我们没有在 App Settings 或类似的地方更改我们的应用程序域。

在应用程序设置中，可以将移动 Web URL 设置到我们的主页 (www.ciberweb.com/www/movil.php) 并且链接有效（并且错误消息消失）但这根本不是所需的行为 - 它会意味着无论链接是什么，所有链接都以相同的移动 Web URL 结束！

我坚持认为我们向粉丝发送了数百条信息。

自 10 月 31 日以来我们遇到的问题主要发生在 Android 移动应用程序的本机应用程序中，几乎每个人在 Facebook 的网络版本中似乎都没有问题

我们非常清楚如何安全播放错误，因为来自我们的粉丝的数百份报告任何想法主要影响具有本机 Facebook 应用程序的 Android 设备，但无法说明该版本设备何时安全。

当我们的粉丝在我们的任何网页（例如[https://www.facebook.com/OfertasTrabajoGranada](https://www.facebook.com/OfertasTrabajoGranada)或[https://www.facebook.com/OfertasEmpleoValencia](https://www.facebook.com/OfertasEmpleoValencia)和他们在他的画布或墙上看到了它，但问题很普遍，甚至我们已经要求我们的一些粉丝尝试其他使用链接共享系统的页面，就像并且似乎有同样的问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T04:36:47.030

这可能是 Facebook 的错误，最好订阅此开发人员的错误报告以随时了解最新更新。

[https://developers.facebook.com/bugs/124107044413049](https://developers.facebook.com/bugs/124107044413049)

# php - 在 PHP 中计算 RSA 私钥的更快方法

> ID：13388863
> 
> 赞同：0
> 
> 时间：2012-11-14T23:00:43.480
> 
> 标签：php, rsa, private-key

嗨，我需要在 php 中自己实现 RSA 算法。我唯一有问题的是计算私钥的部分。我的函数的工作方式是获取一个随机数并检查它是否适合私钥公式。这很好用，但是唯一的问题是当使用非常大的数字时，它需要很长时间并且页面超时。我想知道，有没有更好的方法可以实现这一点而不必继续生成随机数？这是所需的代码：

```
$decrypt = rand(1,($phi-1));
while(!private($decrypt, $encrypt, $phi)){
$decrypt = rand(1,($phi-1));
}

...

function private($decrypt, $encrypt, $phi) {

 if(($decrypt * $encrypt) % ($phi) == 1){
 Return true;
 }
 else{
 Return false;
 }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T23:42:30.340

这种方法行不通。PHP 数字类型是双精度浮点数，因此不能精确表示超过 53 位的整数。您很可能需要使用 PHP 多精度库，例如[bcmath](http://us1.php.net/manual/en/book.bc.php)或[gmp](http://us1.php.net/manual/en/book.gmp.php)。这仍然不会很快，但它至少会给出正确的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T00:31:24.373

选项1：

您最好按顺序执行此操作。您的 rand() 可以找到以前使用过的数字。假设你的最大值是 10，要求的数字是 8 或 4，使用 rand() 你可以得到 3,5,9,10,3,6,2,7,3,6,9,10,1,3, 5,6,3,7,8 在找到答案之前。如果您按顺序运行，您最多可以调用 10 次来获取它。

但是，您需要一个随机数，因此您可能应该从一个随机数开始，然后按顺序增加，直到获得命中 - 这样您可以得到 8 个，也可以得到 4 个，具体取决于您的起点。

选项 2：

在那之后，还有其他数学方法可以解决。从一个随机数开始，计算模数是多少，以及与 1 的差值（如果为负，则添加`$phi`）。然后你可以从 1 运行`$decrypt`到找出修改后的数字与 1 有什么不同，然后添加它来加密你的响应。

```
$decrypt = 7
$encrypt = 9
$phi = 3
($decrypt * $encrypt) % ($phi) = 0
$differenceInMod = 1 - ($decrypt * $encrypt) % ($phi) = 1;
if ($differenceInMod < 0) {
    $differenceInMod+=$phi;
}
for($i = 1; $i<$decrypt; $i++) {
   if (($decrypt * $i) % ($phi) == $differenceInMod) {
      $validEncrypt = $encrypt + $i;
      break;
   }
} 
```

可能没有比直接顺序更快（选项 1） - 但数字更小，你有限制。

# c++ - return true 在 C++ 中返回 0

> ID：13388867
> 
> 赞同：3
> 
> 时间：2012-11-14T23:00:48.320
> 
> 标签：c++

这是一个简单的递归回文测试，它本身有效，但无论函数实际返回什么都返回 0。这是我的代码，我在调试 cout 语句时留下了，所以你可以看到它确实有效：

```
bool pal(int l, int r, char *a)
{
     if(l >= r)
     {
        cout << "returning true" << endl;
        return true;
     }

     if(a[l] != a[r])
     {
        cout << "returning false" << endl;
        return false;
     }
     pal(l+1, r-1, a);
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-14T23:02:17.707

您的程序具有未定义的行为，因为有一条根本不返回的路径。您应该`return`在末尾添加一条语句：

```
return pal(l+1, r-1, a); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-14T23:02:27.570

```
pal(l+1, r-1, a); 
```

调用`pal`，但丢弃结果。它还会导致没有路径返回值的情况（检查您的警告！）。你想要的是：

```
return pal(l+1, r-1, a); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T23:35:08.400

最后你需要一个 return 语句。因为如果函数没有进入 if 语句，就没有返回值。

它可能是这样的

```
return pal(l+1, r-1, a); 
```

# search - 用于搜索用户名和关键字的 YouTube 搜索 URL；并按评级对结果进行排序

> ID：13388868
> 
> 赞同：0
> 
> 时间：2012-11-14T23:00:52.967
> 
> 标签：search, youtube, youtube-api, youtube-data-api

我有一个脚本可以显示 youtube 搜索的 json 结果。以下 url 不会排序，尽管它确实返回了我将用户名放入*username*的结果。

```
http://gdata.youtube.com/feeds/users/username/uploads?alt=json-in-script&search_sort=video_view_count 
```

这似乎没有排序。而且如果我附加它似乎也无法按关键字搜索`&q=dogs`

是否可以搜索用户名加关键字并在之后进行排序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T18:08:51.077

这是您需要的网址：

```
http://gdata.youtube.com/feeds/api/videos
?v=2
&author=SesameStreet
&q=rubber+ducky
&orderby=viewCount
&start-index=1
&max-results=10
&alt=json-in-script
&callback=myCallbackFunction
&prettyprint=true 
```

[单击此处查看输出](http://gdata.youtube.com/feeds/api/videos?v=2&author=SesameStreet&q=rubber+ducky&orderby=viewCount&start-index=1&max-results=10&alt=json-in-script&callback=myCallbackFunction&prettyprint=true)

使用的参数：

> **author**在搜索请求中，作者参数将搜索限制为特定 YouTube 用户上传的视频。
> 
> **q** q 参数指定搜索查询词。
> 
> **orderby**视频源和播放列表源支持的 orderby 参数指定将用于对 API 响应中的条目进行排序的方法。

完整的[文档可在此处获得](https://developers.google.com/youtube/2.0/reference)，您应该参考它以获取其他参数、可能的值和行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T05:35:04.793

而不是使用 q=something
我使用 search_query=something
q 显然搜索完全匹配

# powershell-2.0 - 如何获取文件内容到事件日志

> ID：13388869
> 
> 赞同：1
> 
> 时间：2012-11-14T23:00:57.990
> 
> 标签：powershell-2.0

我有 PS 脚本来获取 Regkey 计数到文本文件。我在任务计划程序中使用此脚本&您能否告诉我我们是否可以获取该文件的内容并在任务运行后将其记录到事件查看器中？脚本在下面提到 -

```
if (!([diagnostics.process]::GetCurrentProcess().Path -match '\\syswow64\\'))
{
$uninstallPath = "\Software\Microsoft\Windows\CurrentVersion\Uninstall\"
$uninstallWow6432Path = "\Software\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall\"
@(
if (Test-Path "HKLM:$uninstallWow6432Path" ) {Get-ChildItem "HKLM:$uninstallWow6432Path"-Recurse | Measure-Object | Out-File "C:\PS Output\Total6432.txt"}
if (Test-Path "HKLM:$uninstallpath" ) {Get-ChildItem "HKLM:$UninstallPath" -Recurse | Measure-Object | Out-File "C:\PS Output\Total32.txt"}
)
} 
```

* * *

我尝试了下面提到的以下代码，但在事件查看器中看不到任何内容。你能给我一些指导吗？

```
if (!([diagnostics.process]::GetCurrentProcess().Path -match '\\syswow64\\'))
{
  $uninstallPath = "\Software\Microsoft\Windows\CurrentVersion\Uninstall\"
  $uninstallWow6432Path = "\Software\Wow6432Node\Microsoft\Windows\CurrentVersion  \Uninstall\"
  @(
  if (Test-Path "HKLM:$uninstallWow6432Path" ) {Get-ChildItem "HKLM:$uninstallWow6432Path"-Recurse | Measure-Object | Out-File "C:\PS Output\Total6432.txt"}
  if (Test-Path "HKLM:$uninstallpath" ) {Get-ChildItem "HKLM:$UninstallPath" -Recurse | Measure-Object | Out-File "C:\PS Output\Total32.txt"}
)

$Content = Get-content -Path 'C:\PS Output\Total6432.txt'
$Content1 = Get-Content -Path 'C:\PS Output\Total32.txt'
{
Write-EventLog -LogName Application -Source $Content AND $Content1 -EventId 3001 -EntryType Information "Count is Registered"
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T20:11:34.973

为什么不简单地读取文件的内容并使用类似`write-eventlog`在脚本末尾写入特定事件日志的命令？你遇到什么问题？

查看[http://blogs.msdn.com/b/davethompson/archive/2011/10/25/running-a-scheduled-task-after-another.aspx](http://blogs.msdn.com/b/davethompson/archive/2011/10/25/running-a-scheduled-task-after-another.aspx)了解有关运行一项又一项任务的信息，您可以然后创建第二个任务，它只是读取上面的文件并将它们写入事件日志。

如果这不能回答您的问题，那么您到底遇到了什么问题？

# grails - 如何使用 grails 分类插件向分类单元添加层次结构？

> ID：13388871
> 
> 赞同：2
> 
> 时间：2012-11-14T23:01:25.003
> 
> 标签：grails, plugins, taxonomy

我想在我的分类单元中有某种层次结构，我使用 Grails Taxonomy 插件添加到我的域类 Foo 中。[http://grails.org/plugin/taxonomy](http://grails.org/plugin/taxonomy)

示例（用于构建类似树的注释）：{A:{A1:{A1I, A1II}, A2:{A2I}}, B:{B1:{B1I}, B2:{B2II}}}

`foo.addToTaxonomy(['A1', 'A2'], "A") foo.addToTaxonomy(['B1', 'B2'], "B")`

A1，A2，B1和B2的孩子怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T20:03:47.573

假设您的分类树由

> {A:{A1:{A1I, A1II}, A2:{A2I}}, B:{B1:{B1I}, B2:{B2II}}}

符号 A->A1->A1I 描述了树中的路径。在这种情况下，路径是在 A 树中从其根 (A) 到叶 (A1I)。

如果您想将 foo 添加到 A->A1->A1I 分类，您可以使用`foo.addTaxonomy(['A', 'A1', 'A1I'])`. 该函数的列表参数`addTaxonomy`实际上表示分类树中的路径。接受的第二个参数`addTaxonomy`是可选的，本质上定义了分类树的范围。所以，如果我要这样做

```
foo.addTaxonomy(['A', 'A1', 'A1I'], 'scope1')
foo.addTaxonomy(['A', 'A1', 'A1I'], 'scope2') 
```

这会将 foo 放在范围 1 和范围 2 中的 A->A1->A1I 中。它们本质上是两种不同的树。你可能不需要这个。

以下是与您在问题中描述的树结构相关的一些示例：

添加到A->A1->A1II

```
foo.addTaxonomy(['A', 'A1', 'A1II']) 
```

添加到 A2->A2I

```
foo.addTaxonomy(['A2', 'A2I']) 
```

添加到 B->B1->B1I

```
foo.addTaxonomy(['B', 'B1', 'B1I']) 
```

添加到 B2->B2I

```
foo.addTaxonomy(['B2', 'B2I']) 
```

上面的 4 个示例分别创建了以 A、A2、B 和 B2 为根的树。

如果您不想定义分类单元的绝对路径，可以执行以下操作：

```
def taxonPath(taxonName) {
    def currentTaxon = Taxon.findByName(taxonName)
    def path = [currentTaxon.name]

    while(currentTaxon.parent) {
        currentTaxon = currentTaxon.parent
        path = [currentTaxon.name] + path
    }

    return path
}

taxonomyService.createTaxonomyPath(['B', 'B2', 'B2I'])
def book = new Book(name:"hacky solution")
book.addToTaxonomy(taxonPath('B2I')) 
```

这相当于`book.addToTaxonomy(['B', 'B2', 'B2I'])`. 您还需要`import com.grailsrocks.taxonomy.Taxon`将 taxonomyService 注入到您的工件中，例如 ( `def taxonomyService`) 以使其工作。

该解决方案感觉有点笨拙且效率低下，但它确实有效。

# mysql - mySQL 变量搜索空变量

> ID：13388873
> 
> 赞同：1
> 
> 时间：2012-11-14T23:01:32.513
> 
> 标签：mysql

我有一个包含 5 列的表 - col1、co12、...我有 5 个搜索参数在每列上进行搜索。我需要编写一个 mySQL 查询，它将返回所有匹配的结果。如果我没有为搜索参数提供值，它将被忽略。

我有这个，但它不起作用

```
select * from tableA
where ((col1 IS NULL AND srch1 IS NULL) OR (col1 like srch1))
and ((col2 IS NULL AND srch2 IS NULL) OR (col2 like srch2))
etc... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T23:14:57.173

```
Select * from tableA where
col1 like '%' + Coalesce(srch1,col1) + '%' and
col2 like '%' + Coalesce(srch2,col2) + '%' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T23:28:07.160

我认为“不起作用”是指您的`like`部分条件不起作用。

那是因为您必须用`%`字符包装搜索字符串以形成“喜欢”搜索词。尝试这个：

```
select * from tableA
where ((col1 IS NULL AND srch1 IS NULL) OR col1 like concat('%', srch1, '%'))
and ((col2 IS NULL AND srch2 IS NULL) OR col2 like concat('%', srch2, '%'))
etc... 
```

你非常接近！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T23:55:00.367

通过在括号中将每个条件与自身进行 OR'd，并首先测试 null，这将预先限定条件并忽略另一半。如果有一个值，则针对相应的列进行测试。现在，也就是说，如果您真的需要“LIKE”限定符，那么您可能需要期待或添加“%”以进行通配符匹配。

```
select
      A.* 
   from 
      tableA  A
   where 
          (srch1 is null OR col1 like srch1)
      AND (srch2 is null OR col2 like srch2)
      AND (srch3 is null OR col3 like srch3)
      AND (srch4 is null OR col4 like srch4)
      AND (srch5 is null OR col5 like srch5) 
```

因此，如果您只提供 srch3 参数，那么答案将解释为

```
where 
       TRUE
   and TRUE
   and col3 like srch3
   and TRUE
   and TRUE 
```

自从srch？is null 首先为真，然后忽略该测试的其余部分。

# php - 新的 php facebook 库重用会话

> ID：13388880
> 
> 赞同：0
> 
> 时间：2012-11-14T23:01:50.480
> 
> 标签：php, facebook, api

我不小心用新的最新版本覆盖了 Facebook PHP 库，因为我的整个系统现在已经损坏，所以损坏已经造成。

问题是，我不知道新的身份验证过程是如何工作的，起初你会在用户对应用程序进行身份验证后得到一个包含过期、oauth_key、oauth_secret 和 accesstoken 的签名响应（或类似的东西），但是现在我只得到参数“状态”和“代码”。

谁能向我解释我必须如何重新配置​​我的应用程序以使用这些参数来重用用户会话？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T00:41:59.610

我也讨厌 Facebook API，它就像......猴子：P 你可以在 SDK 3 中使用

```
$facebook->getAccessToken(); 
```

将哈希保存在数据库中并稍后使用

```
$facebook->setAccessToken('...'); 
```

[http://qpleple.com/get-and-use-facebook-offline_access-tokens/](http://qpleple.com/get-and-use-facebook-offline_access-tokens/)

您需要在 Facebook 开发者页面的应用程序配置中预先配置关闭“删除离线访问权限”。

如果您想在 Javascript 中使用此会话，请向上帝发送电子邮件：P

# mapreduce - PigLatin：java.lang.OutOfMemoryError：超出 GC 开销限制

> ID：13388883
> 
> 赞同：2
> 
> 时间：2012-11-14T23:02:03.637
> 
> 标签：mapreduce, weka, apache-pig

我对 Pig Latin 非常陌生，试图通过我的作业来理解 Pig Latin，这是我之前使用 Map Reduce 所做的。而且我收到 GC 开销错误，PS：我的输入只是 10 行简单的 csv 文件。

我正在尝试将 csv 格式转换为 arff。

**我的UDF：**

```
public class CSV2ARFF extends EvalFunc<String> {
private String arffDataString;
private String arffHeaderString;

public String exec(Tuple input) throws IOException {
    if (input == null || input.size() == 0)
        return null;
    try{
            System.out.println(">>> " + input.get(0).toString());
            // csv to instances
            ByteArrayInputStream inputStream = new ByteArrayInputStream(input.get(0).toString().getBytes("UTF-8"));
            CSVLoader loader = new CSVLoader();             
            loader.setSource(inputStream);
            Instances data = loader.getDataSet(); //**Line #30**
            //convert into arff
            ArffSaver arff = new ArffSaver();               
            arff.setInstances(data);                
            this.arffDataString = arff.getInstances().toString();               
            Instances arffdata = arff.getInstances();
            // header
            Instances header = new Instances(arffdata, 0);
            this.arffHeaderString = header.toString();
            this.arffDataString = this.arffDataString.substring(this.arffHeaderString.length());

            return arffDataString;

    }catch(Exception e){
        System.err.println("CSV2ARFF: failed to proces input; error - " + e.getMessage());
        return null;
    }
} 
```

}

**我的脚本.pig**

```
REGISTER ./csv2arff.jar;
REGISTER ./weka.jar;

csvraw = LOAD 'sample' USING PigStorage('\n') as (c);

arffraws = FOREACH csvraw GENERATE pighw2java.CSV2ARFF(c);

--output

STORE arffraws INTO 'output' using PigStorage(); 
```

**错误**

```
java.lang.OutOfMemoryError: GC overhead limit exceeded
at java.nio.CharBuffer.wrap(CharBuffer.java:369)
at sun.nio.cs.StreamDecoder.implRead(StreamDecoder.java:310)
at sun.nio.cs.StreamDecoder.read(StreamDecoder.java:177)
at java.io.InputStreamReader.read(InputStreamReader.java:184)
at java.io.BufferedReader.fill(BufferedReader.java:154)
at java.io.BufferedReader.read(BufferedReader.java:175)
at java.io.StreamTokenizer.read(StreamTokenizer.java:500)
at java.io.StreamTokenizer.nextToken(StreamTokenizer.java:544)
at weka.core.converters.ConverterUtils.getToken(ConverterUtils.java:888)
at weka.core.converters.CSVLoader.readHeader(CSVLoader.java:937)
at weka.core.converters.CSVLoader.readStructure(CSVLoader.java:578)
at weka.core.converters.CSVLoader.getStructure(CSVLoader.java:563)
at weka.core.converters.CSVLoader.getDataSet(CSVLoader.java:596)
at pighw2java.CSV2ARFF.exec(CSV2ARFF.java:30)
at pighw2java.CSV2ARFF.exec(CSV2ARFF.java:1) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-04-07T06:14:51.427

我遇到过类似的情况。在本地模式下运行 pig 会导致此错误（pig -x local）。当我在 Map reduce 模式下运行相同的查询时，它得到了解决（猪）。

希望能帮助到你。

# android - Android Live-wallpaper：访问资源文件夹

> ID：13388888
> 
> 赞同：1
> 
> 时间：2012-11-14T23:02:12.620
> 
> 标签：android, opengl-es, android-activity, resources, live-wallpaper

我目前坚持使用opengl ES2制作实时背景。

在我的渲染器中，我想从资源文件夹中访问纹理和着色器，但我找不到这样做的方法。

我目前对此的尝试只会导致崩溃。

```
return new SurfaceRenderer((Activity) this.getApplicationContext(), WallpaperService.this); 
```

它是我在苦苦挣扎的 SurfaceRenderer 构造函数中的第一个参数！

稍后这些变量将用于访问如下文件：

```
final int resVertex = activity.getResources().getIdentifier(input+"_vertexshader","raw", activity.getPackageName());

    int resID = activity.getResources().getIdentifier(path,"raw", activity.getPackageName());
    InputStream inputStream = activity.getResources().openRawResource(resID); 
```

ETC..

其中activity是SurfaceRenderer构造函数中的第一个参数，而ctx是第二个！

有什么解决办法吗？

编辑：尝试实施解决方案，但我仍然遇到问题！

这是我的渲染器构造函数：

```
public SurfaceRenderer(GLWallpaperService activity, Context ctx) {
    this.activity = activity;
     cc = activity;

    shaderlib = new ShaderLib(activity, ctx);
} 
```

用于将活动转发到我的着色器创建对象，最终运行：

```
inputStream = activity.getContext().getAssets().open(filename); 
```

没有可用的 getcontext 函数，当我尝试创建一个时，我只得到一个空指针，在这个命令上，有什么解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T23:17:47.803

您可以将资源放在 Assets 文件夹中并使用 AssetManager 访问它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T12:14:35.030

`GLWallpaperService`可以用作上下文。创建渲染器时，您可以将`GLWallpaperService`实现传递给渲染器实例并使用它来访问*/assets*文件夹。

渲染器类的示例代码：

```
public BaseRenderer(Context context, IWallpaper wallpaper) {
    mContext = context;
    mWallpaper = wallpaper;
}

...
is = mWallpaper.getContext().getAssets().open(filename); 
...
is = mContext.getAssets().open(filename);
... 
```

`mWallpaper``GLWallpaperService`是渲染器类中自定义的一个实例。这是我的壁纸中的代码。通过将传递的上下文设置为本地`mContext`成员，您可以在需要访问资源的任何地方使用此上下文。

# sencha-touch-2 - 如果在 Sencha Touch 中扩展一个 XTemplate，如何指定模板文本值？

> ID：13388892
> 
> 赞同：1
> 
> 时间：2012-11-14T23:02:30.560
> 
> 标签：sencha-touch-2

我不想控制我们连接一个巨大的 HTML 字符串，而是想将 XTemplate 对象分离到它自己的文件中。问题是我不知道如何在这个类中设置模板文本。通常，您会在线创建一个新的 XTemplate 对象并将模板文本作为第一个参数传递。

这可能吗？我应该设置什么属性？

```
/**
 * Custom XTemplate
 */
Ext.define('MyApp.view.MySuperDuperXTemplate', {
    extend: 'Ext.XTemplate',
    xtype: 'mySuperDuperXTemplate',

    html: 'Does the template text go here?',
    text: 'That didn\'t work, let me try this...',
    tpl: 'How about this?  No?...'
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T14:57:46.460

当您在构造函数中传递 XTemplate 时，XTemplate 会获取 HTML，因此您需要覆盖它来创建它：

```
Ext.define('Test', {
    extend: 'Ext.XTemplate',

    html: 'testing',

    constructor: function() {
        return this.callParent([this.html]);
    }
});

// Then use it
new Test(); 
```

# javascript - 放置在底部的 jQuery 选项卡控件不起作用

> ID：13388894
> 
> 赞同：0
> 
> 时间：2012-11-14T23:02:34.310
> 
> 标签：javascript, jquery

我正在使用此解决方案[在一页中有多个选项卡](https://stackoverflow.com/questions/3689660/jquery-conflict-with-identical-scripts/3689751#3689751)。

```
$(".tab_content").not(':first-child').hide();
var tabs = $('.tabs li');

tabs.filter(':first-child').addClass('active');

tabs.click(function() {
    var current = $(this);

    if(!current.hasClass('active')){
        current.addClass('active').siblings().removeClass('active');
        var activeTab = current.find("a").attr("href");
        current.parent().next().children().hide().filter(activeTab).fadeIn();
    }

    return false;
}); 
```

我需要将选项卡控件放在选项卡内容之后。但它不会起作用。如果选项卡控件放置在选项卡内容之前，则可以正常工作。你能帮助我吗？

这是我的[jsfiddle](http://jsfiddle.net/pivi/pnm98/)：

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T23:06:04.267

只需将 next() 更改为 prev() - 因为现在兄弟姐妹在选项卡之前

```
current.parent().prev().children().hide().filter(activeTab).fadeIn(); 
```

[http://jsfiddle.net/Kf2f4/](http://jsfiddle.net/Kf2f4/)

# sql - 在zend中选择左侧

> ID：13388895
> 
> 赞同：0
> 
> 时间：2012-11-14T23:02:37.810
> 
> 标签：sql, zend-framework, zend-db

如何在zend中做这样的事情：

```
SELECT LEFT(log_browser, LOCATE(' ', log_browser)) AS browser, COUNT(*) AS amount
FROM logs
GROUP BY LEFT(log_browser, LOCATE(' ', log_browser)) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T07:14:25.220

对表达式语句使用 Zend_Db_Expr 类：

```
$browserExpr = new Zend_Db_Expr('LEFT(log_browser, LOCATE(" ", log_browser))');
$select->from("logs", array('browser' => $browserExpr))->group($browserExpr); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T02:57:18.547

尝试：$select->from($name, $column)->group()

```
$select->from("logs", array("LEFT(log_browser, LOCATE(' ', log_browser))" => "browser" ,"count(*)" => "amount"))
       ->group(array("LEFT(log_browser, LOCATE(' ', log_browser)"); 
```

更多信息这是如何工作的 [http://framework.zend.com/manual/1.12/en/zend.db.select.html#zend.db.select.building.group](http://framework.zend.com/manual/1.12/en/zend.db.select.html#zend.db.select.building.group)

丁斯

# python - Django - 如何在查询集中使用 modelForm 的关联模型到表单

> ID：13388897
> 
> 赞同：1
> 
> 时间：2012-11-14T23:02:49.407
> 
> 标签：python, django, django-models, django-forms

如何访问 ModelForm 中关联的模型对象？像 self.Meta.model 这样的东西？我的模型和表单定义如下，我试图通过“self.Meta.model.attribute”访问模型的属性，但这不起作用。

```
class Attribute(models.Model):
    name = models.CharField(max_length=64)

class AttributeIndex(models.Model):
    product = models.OneToOneField(Product)
    attribute = models.ManyToManyField(Attribute)

class AttributeIndexForm(forms.ModelForm):
    class Meta: 
        model = AttributeIndex  
    def __init__(self, *args, **kwargs):
        super(AttributeIndexForm, self).__init__(*args, **kwargs)
        self.fields['attribute'] = forms.ModelMultipleChoiceField(queryset=self.Meta.model.attribute.all, widget=widgets.FilteredSelectMultiple("Attributes", is_stacked=False)) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T23:49:01.353

当你声明一个模型时

```
class MyModel(models.Model):
    class Meta:
        something = 'foo' 
```

或带有的 ModelForm

```
class MyModelForm(forms.ModelForm):
    class Meta:
        model = MyModel 
```

有一个特殊的[元类](http://docs.python.org/2/reference/datamodel.html#__metaclass__)，在“读取”您的类定义时，它`Meta`会将属性设置/替换为`_meta`.

因此，为了访问您的 ModelForm 中的关联模型，请执行以下操作：

```
AttributeIndexForm._meta.model 
```

但是在您只想自定义`attribute`字段的查询集的特定情况下，您应该这样做：

```
class AttributeIndexForm(forms.ModelForm):
    class Meta: 
        model = AttributeIndex  
    def __init__(self, *args, **kwargs):
        super(AttributeIndexForm, self).__init__(*args, **kwargs)
        self.fields['attribute'].queryset = Attribute.objects.filter(..condition..)
        self.fields['attribute'].widget = widgets.FilteredSelectMultiple("Attributes", is_stacked=False)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T00:51:29.213

我发现“self.instance”有效，这正是我想要的：

```
 self.fields['attribute'].queryset = self.instance.attribute.all() 
```

# django - Django标签

> ID：13388901
> 
> 赞同：2
> 
> 时间：2012-11-14T23:03:16.740
> 
> 标签：django, hashtag

嘿 StackOverFlowers :) 我一直在开发一个博客图片应用程序。我一直在到处寻找有关如何为 Django 实现主题标签功能的解决方案，以便用户可以为图片创建主题标签并排序/检索基于图片的主题标签。

我在 GitHub 上查看了 django-hastags：[https](https://github.com/semente/django-hashtags) ://github.com/semente/django-hashtags但即使在阅读了文档之后，我还是很迷茫:(

我有一个用户模型，我有一个博客图片模型。下面我从我的 models.py 中为我的两个模型发布了我的代码：

```
from django.db import models
from django.contrib.auth.models import User
from django.contrib.sites.models import Site
from bookmarks.handlers import library

class Bloguser(models.Model):
    user = models.OneToOneField(User, primary_key=True)
    bio = models.CharField(max_length=140, blank=True)
    favorites = models.ManyToManyField('BlogPicture', through='Favorites', related_name = 'picture_favs')
    likes = models.ManyToManyField('BlogPicture', related_name='likedby', blank=True)
    userPic = models.CharField(max_length=128, blank=True)
    userCover = models.CharField(max_length=128, blank=True)
    phoneNum = models.CharField(max_length=20, blank=True)

def __unicode__(self):
        return self.user.username

class BlogPicture(models.Model):
    title = models.CharField(max_length=40)
    bloguser = models.ForeignKey(Bloguser, related_name = 'shot_owner')
    postTime = models.DateTimeField(auto_now_add=True)
    description = models.CharField(max_length=100, blank=True)
    url = models.CharField(max_length=128)

def json_feat(self):
     return{
        'title': self.title,
        'photo-url': self.url,

    }

def __unicode__(self):
     return self.title 
```

从这里开始，任何人都可以为我指出如何实现标签的正确方向吗？抱歉，如果我不够清楚，请发表评论并让我知道，以便我可以为您和其他人更清楚地提出我的问题！谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-14T23:08:17.287

使用 django 标记库怎么样？比如[django-taggit](https://github.com/alex/django-taggit)。

无耻地从项目文档中提取：

```
>>> apple = Food.objects.create(name="apple")
>>> apple.tags.add("red", "green", "delicious")
>>> apple.tags.all()
[<Tag: red>, <Tag: green>, <Tag: delicious>]
>>> apple.tags.remove("green")
>>> apple.tags.all()
[<Tag: red>, <Tag: delicious>]
>>> Food.objects.filter(tags__name__in=["red"])
[<Food: apple>, <Food: cherry>] 
```

* * *

老实说，该[`django-hashtags`](https://github.com/semente/django-hashtags)库看起来只是在将“散列”添加到“标记”之前利用了“酷”因素，但看起来并不是很好。

它似乎确实提供了一些不错的功能（例如基于标签的列表视图），但这是您可以通过几行*轻松*实现的功能。`ListView`

# sql-server - 对象的选择权限被拒绝

> ID：13388904
> 
> 赞同：3
> 
> 时间：2012-11-14T23:03:27.567
> 
> 标签：sql-server, select, permissions

好吧，我正在使用 Cold Fusion 创建一个应用程序网站，每次我在浏览器中调试我的项目时都会收到此错误：

> *执行数据库查询时出错。*
> 
> *[Macromedia][SQLServer JDBC 驱动程序][SQLServer] 对象“用户”、数据库“酒店”、模式“dbo”的 SELECT 权限被拒绝*

我正在使用一个名为的用户`CFLogin`，我通过 SQL Server 中的此命令授予他选择权限：

```
USE hotel
GO
GRANT SELECT ON dbo.users TO CFLogin 
```

我还执行了以下存储过程来为我的用户赋予角色：

```
EXEC sp_addrolemember 'db_owner',CFLogin
EXEC sp_addrolemember 'db_datareader',CFLogin
EXEC sp_addrolemember 'db_accessadmin',CFLogin 
```

但它总是导致相同的消息：`Select permission was denied on object...`我什至重新启动了服务，但似乎根本没有任何效果。

我究竟做错了什么？

问候！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-06-27T13:57:50.163

在运行 IIS 7 的 Windows 2008 服务器中使用启用了冷融合的网站时，我也遇到了类似的问题。执行以下查询有助于为我解决问题，

```
使用数据库名称
将 dbo.TABLENAME 上的选择授予公共；

```

从 sql 提示符执行上述查询帮助我解决了这个问题。将**DATABASENAME**和**TABLENAME**替换为错误显示的 sql server 数据库和表名。

# objective-c - 从控制台获取用户数据

> ID：13388909
> 
> 赞同：1
> 
> 时间：2012-11-14T23:03:38.437
> 
> 标签：objective-c

昨天刚开始用 Java 背景在 Objective-C 编程，我迷路了。我有一个可以运行的程序，它的目的是从控制台获取一个人的姓名、年龄和体重，然后将这些值输出给用户。我的问题是当我在控制台中输入数据时，它只会显示我输入的第一个字母。然后它不会显示我的字符串的任何其他字符。所以这里有一些示例控制台数据来证明我的观点。

**安慰：**

```
2012-11-14 17:56:05.673 Tutorial[1757:403] Please Enter In Your Name
warning: this program uses gets(), which is unsafe.
C
2012-11-14 17:56:09.494 Tutorial[1757:403] Please Enter Your Age
1
2012-11-14 17:56:11.239 Tutorial[1757:403] Please Enter Your Weight
2
2012-11-14 17:56:13.205 Tutorial[1757:403] 
Name: Chris 
Age: 18 
Weight: 200 
```

如您所见，它只会显示我输入的第一个字母，但它实际上使用输入字符串。为什么会发生这种情况？

**函数声明：**

```
#import "Person.h"

Person * readPersonData (Person * object);
void writePersonInformation(Person * object); 
```

**主要方法：**

```
int main (int argc, const char * argv[])
{
    @autoreleasepool
    {
        Person * p1 = [[Person alloc] init];
        p1 = readPersonData(p1);
        writePersonInformation(p1);
    }
} 
```

**功能实现：**

```
Person * readPersonData (Person * object)
{
    char nameCharacters[100];
    NSString * objectName;
    int objectAge, objectWeight;

    NSLog(@"Please Enter In Your Name");
    gets(nameCharacters);
    objectName = [[NSString alloc] initWithUTF8String:nameCharacters];
    [object setName : objectName];

    NSLog(@"Please Enter Your Age");
    scanf("%i", &objectAge);
    [object setAge : objectAge];

    NSLog(@"Please Enter Your Weight");
    scanf("%i", &objectWeight);
    [object setWeight : objectWeight];

    return object;
}
void writePersonInformation(Person  * object)
{
    NSLog(@"\nName: %@ \nAge: %i \nWeight: %i", object.getName, object.getAge, object.getWeight);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T23:23:24.953

众所周知，由于缓冲区溢出的可能性，gets() 存在安全问题，因此相当长一段时间以来的建议是改用 fgets()。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T23:31:46.557

我认为这个问题与 Xcode 4.5 的问题有关（请参阅[this](https://discussions.apple.com/thread/4318031?start=0&tstart=0)）。

你没有在你的问题中说你是从调试器控制台还是从命令行运行，但是当你从命令行尝试它时会发生什么？

`fgets()`但是，如果只是为了停止该运行时警告消息，您应该使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T23:25:13.693

使用`fgets`为文件传递标准输入，而不是`gets`大多数编译器通常将其标记为不安全。这至少会消除可能导致输入不显示的警告。这是一个关于如何使用的帖子`fgets`

[获取的安全替代方案](https://stackoverflow.com/questions/4309746/safe-alternative-to-gets)

或者，您可以尝试抑制警告，可能有一些编译器指令可以做到这一点（我知道在 VS 中有）。我曾经对很多“不安全”的函数进行自己的边界检查，发现这样可以减少编译器的一些烦恼。

# c# - 绑定表格中的多列单选按钮（为每一行分组）

> ID：13388913
> 
> 赞同：3
> 
> 时间：2012-11-14T23:03:58.930
> 
> 标签：c#, .net, asp.net-mvc-3, razor

（我不是 MVC 专家，只是说）我需要渲染一个`<table>`包含 4 列的：

*   姓名*   无权访问*   查看器*   文件管理器

    最后3个是布尔值，需要绑定一个单选按钮，这个单选按钮需要对每一行进行分组。

    我知道在视图中显示它的许多不同方法，但不确定确保数据正确提交回控制器的最佳方法。

    模型：

    ```
    public class DetailModel 
    { 
        //this displays the user information
        public Users_SelectByUserId User { get; set; }
        //This is what builds the Table with the 4 columns.
        public List<UserMinistryRef_SelectByUserID> MinistryRef { get; set; }

    } 
    ```

    --

    ```
    public class UserMinistryRef_SelectByUserID
    {
        public int UserRecordId { get; set; }
        public int MinistryId { get; set; }
        public bool Minadmin { get; set; }
        public bool Updater { get; set; }
        public bool Viewer { get; set; }
        public string mname { get; set; }
    } 
    ```

    什么是最好的显示方式，并且有能力将它们正确地填充回控制器？我尝试遍历 MinistryRef 集合，但我没有得到太多的运气，在循环集合时无法让它与 Razor 一起工作，并且绑定到第 3 方网格控件只是结果相当忙碌。

    我不确定我是否走在正确的轨道上......

    ```
     @foreach (UserMinistryRef_SelectByUserID ministry in Model.MinistryRef)
                { 
                    <tr>
                        <td>@ministry.mname</td>
                        ***NOte the below @Helpers are not supposed to work, just trying to show what I'm hoping to achieve.
                        <td>
                            @Html.RadioButtonFor(Model.MinistryRef.MinAdmin == true)
                        </td>
                        <td>
                           Html.RadioButtonFor(Model.MinistryRef.Viewer == true)
                        </td>
                        <td>
                            Html.RadioButtonFor(Model.MinistryRef.Viewer == false && Model.MinistryRef.MinAdmin == false)
                        </td>
                    </tr>
                } 
    ```

    有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T00:19:36.000

也许您可以使用 int 抽象来控制单选按钮组，如下所示：

模型

```
public class UserMinistryRef_SelectByUserID
{
 public int UserRecordId { get; set; }
 public int MinistryId { get; set; }
 public bool Minadmin { get; set; }
 public bool Updater { get; set; }
 public bool Viewer { get; set; }
 public string mname { get; set; }
 public int AccessRights { get; set; } //0 = viewer, 1 = updater, 2 = minadmin
} 
```

看法

```
@{ int count = 0; }
@foreach (UserMinistryRef_SelectByUserID ministry in Model.MinistryRef)
{
 <tr>
  <td>@ministry.mname</td>
  <td>
   <input name="MinistryRef[@(count)].AccessRights" type="radio" value="0" @if(ministry.Viewer){<text>checked="checked"</text>} /> 
  </td>
  <td>
   <input name="MinistryRef[@(count)].AccessRights" type="radio" value="1" @if(ministry.Updater){<text>checked="checked"</text>} /> 
  </td>
  <td>
   <input name="MinistryRef[@(count)].AccessRights" type="radio" value="2" @if(ministry.Minadmin){<text>checked="checked"</text>} /> 
  </td>
 </tr>
 count++;
} 
```

控制器

```
[HttpPost]
public ActionResult action( DetailModel vm )
{
 if (ModelState.IsValid)
 {
  foreach( var min in vm.MinistryRef )
  {
   switch( min.AccessRights )
   {
    case 0: /* Viewer */
    case 1: /* Updater */
    case 2: /* Minadmin */
   }
  }
 }

 return RedirectToAction("SomeHttpGet");
} 
```

# hexdump - 如何十六进制转储大文件

> ID：13388916
> 
> 赞同：4
> 
> 时间：2012-11-14T23:04:22.967
> 
> 标签：hexdump

我想输出一个 8go 文件的 hexdump 结果。可以一块一块地做吗？如何指定有限的行数（我已经阅读了手册页，它似乎对应于 -n 长度，但它不起作用）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-14T23:22:09.087

像这样的东西？转储即字节3600到3700：

```
$ hexdump -n 100 -s 3600 -v -e '32/1 "%02x" "\n"' some_file

-s 3600 ; search to offset 3600 before starting dump.
-n 100 ; dump 100 bytes.
-e '32/1 "%02x" "\n"' ; dump 32 bytes pr. line and print by 1 as zero padded hex. 
```

如果您需要**行**偏移而不是字节，您可能不得不求助于例如 sed：

```
$ sed -n '3701q;3600,3700p' some_file | hexdump -ve '32/1 "%02x" "\n"' 
```

取决于您将要使用的数据，它也是简短 C 程序的不错选择；P

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-08T10:35:30.213

如果您想要一个文件的十六进制转储，就像您在 debug.com 中一样，那么您可以执行以下操作：

Debug 不允许您打开大小超过 64 K 的文件，但您可以在 Android 手机上使用一些软件。Google Play 商店中可用的此类软件之一是“Hex Editor”。我也可以在那个“十六进制编辑器”中打开一个 46 MB 的文件。我可以看到十六进制转储，就像我可以在 debug.com 中看到一个文件一样

# c# - WebService 无响应

> ID：13388917
> 
> 赞同：1
> 
> 时间：2012-11-14T23:04:27.733
> 
> 标签：c#, asp.net, web-services

我有这个网络服务类

```
@WebService(serviceName = "Reception", name = "PersonalName")
public class webswsdl {
    public void receptionOC(org.tempuri.SalesOrderHeader salesOrderHeader) {
        ...
        ...
    }
} 
```

没关系，网络服务运行良好

但这有回应

```
HTTP/1.1 200 OK
Content-Type: text/xml; charset=utf-8
Content-Length: length

<?xml version="1.0" encoding="utf-8"?>
<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
  <soap:Body>
    <ReceptionOCResponse xmlns="http://tempuri.org/" />
  </soap:Body>
</soap:Envelope> 
```

我需要做同样的网络服务，但没有回应。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T03:08:38.567

如果您不想了解此处发生的所有绑定，并且希望它快速且非常简单，那么就是这样：

```
HttpContext.Current.Response.Clear();
HttpContext.Current.Response.End(); 
```

只需将其放入您的网络方法功能中即可。

# c# - c#截取特定区域的截图

> ID：13388922
> 
> 赞同：1
> 
> 时间：2012-11-14T23:04:49.573
> 
> 标签：c#, bitmap, screenshot, rectangles

我知道有很多这样的问题，但他们的答案都不适合我，或者我不能正确地做到这一点，无论如何，如果可能的话，请给我一个简单的代码！

我知道绿点的位置，我想根据这个位置构造一个矩形。

例子：

![在此处输入图像描述](../Images/7ecf80820dea6eca6d1c570e8158322a.png)

最重要的是如何截取该区域的屏幕截图？

我不知道如何更改此代码以适用于我的情况。

```
private Bitmap Screenshot()
    {
        Bitmap bmpScreenshot = new Bitmap(Screen.PrimaryScreen.Bounds.Width, Screen.PrimaryScreen.Bounds.Height);

        Graphics g = Graphics.FromImage(bmpScreenshot);

        g.CopyFromScreen(0, 0, 0, 0, Screen.PrimaryScreen.Bounds.Size);

        return bmpScreenshot;
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-14T23:18:23.800

合并[MSDN 上的文档](http://msdn.microsoft.com/en-us/library/fw1kt6f9.aspx)和您的问题：

```
g.CopyFromScreen(center.X - 36, center.Y - 30, 0, 0, new Size(36 * 2, 30 * 2)); 
```

# objective-c - 如何为按钮添加短促的声音？

> ID：13388925
> 
> 赞同：1
> 
> 时间：2012-11-14T23:04:54.050
> 
> 标签：objective-c, audio, button

我希望我的按钮发出短暂的叮当声，并在每次单击后在两个位置之一之间随机切换。当我尝试下面的代码时，程序停止工作。在我插入 systemSound ID 代码之前，代码运行良好。

```
- (IBAction)CountRedClicks:(id)sender{
SystemSoundID soundID;
NSString *soundFile = [[NSBundle mainBundle] pathForResource:@"ding" ofType:@"mp3"];
AudioServicesCreateSystemSoundID((__bridge CFURLRef)[NSURL fileURLWithPath:soundFile], &soundID);
AudioServicesPlaySystemSound(soundID);
RedCounter = RedCounter + 1;
RandNumber = 1 + arc4random() % 2;
if (RandNumber == 1) {
    CGRect frame = RedButton.frame;
    frame.origin.x = 128;
    frame.origin.y = 458;
    RedButton.frame = frame;
}
if (RandNumber == 1) {
    CGRect frame = GreenButton.frame;
    frame.origin.x = 422;
    frame.origin.y = 458;
    GreenButton.frame = frame;
}
if (RandNumber == 2) {
    CGRect frame = RedButton.frame;
    frame.origin.x = 422;
    frame.origin.y = 458;
    RedButton.frame = frame;
}
if (RandNumber == 2) {
    CGRect frame = GreenButton.frame;
    frame.origin.x = 128;
    frame.origin.y = 458;
    GreenButton.frame = frame;
}
if (RedCounter == 10) {
    RedCounter = 0;
    PointsCounter = PointsCounter + 1;
    PointsLabel.text = [NSString stringWithFormat:@"%i", PointsCounter];
    RedButton.hidden = true;
    GreenButton.hidden = true;
    PointsLabel.hidden = false;
    ResetButton.hidden = false;

    if (PointsCounter == 3){
        [PointsLabel setText:@"GREAT JOB!"];
        ResetButton.hidden = true;

    }

} 
```

}

# flash - Flash CS6：如何将 .swf 文件嵌入到另一个 .swf 文件中，该文件将在用户单击按钮时打开

> ID：13388927
> 
> 赞同：1
> 
> 时间：2012-11-14T23:04:56.670
> 
> 标签：flash, embed

我是Flash的新手。我不知道如何使我在 Flash 中的菜单页面上的按钮可点击并附加到我的另一个 swf 文件。我希望用户单击该按钮，然后我的其他 Flash 电影将出现并开始播放。如果可能的话，我需要这样的新手指导。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-10-27T04:16:26.280

可能有点晚了.. 但是我对动作脚本 2 完全没有兴趣.. 我对动作脚本 3 还好.. 我唯一能真正建议的可能是使用 `loadMovieNum("NameOrLinkToSwf.swf",0,"GET");`加载 Swf 的方法.. 可能查看 onClickListeners .. 我还没有深入到 AS2，但应该不会太难.. 祝阅读本文的人好运

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-14T23:40:37.853

Hrm，如果我错了，有人纠正我，但我认为这样做的唯一方法是为你拥有的按钮编写一些代码并让它加载外部 swf，然后将它放在舞台上。

我建议查找在 actionscript 2 或 3 中创建按钮并使用 MovieClip。actionscript 2 中的 loadMovie() 方法或 actionscript 3 中的 Loader 类，您想使用哪种语言（不过，我建议使用 AS3）。

实际上还有另一个问题在问这个问题： [Loading another swf file using AS3](https://stackoverflow.com/questions/9642154/loading-another-swf-file-using-as3)

# export - 数据存储下载/导出到本地文件

> ID：13388929
> 
> 赞同：1
> 
> 时间：2012-11-14T23:05:05.487
> 
> 标签：export, localhost, datastore

我正在尝试将数据存储数据下载/导出到任何类型的本地文件，即 txt。xls。我已经阅读了我能找到的所有信息，但只需要一个快速的方法来导出

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-08T06:46:01.770

这取决于您使用的数据存储。如果您使用的是 stardog，它会为您提供命令行功能以导出为 rdf 格式。

```
$ stardog export -c myDatabase --format RDFXML myDatabase_output.rdf 
```

如果您想导出为 txt 或 xls 格式。您必须查询数据存储并将结果集写入文件。

# php - $_GET 变量的类型

> ID：13388933
> 
> 赞同：1
> 
> 时间：2012-11-14T23:05:56.013
> 
> 标签：php, url, get

我在`.htaccess`文件中有这个重写规则

```
RewriteRule ^(.+)$ index.php?url=$1 
```

然后，当我检查 , 的类型时`$_GET['url']`，它总是一个字符串。

我想知道是否有可能在浏览器的地址栏中写一些魔术符号（或类似的东西）并`$_GET['url']`以其他类型（不是字符串）获得？

或者`$_GET`永远是的类型`string`？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-14T23:13:22.043

如果你这样做：

```
 index.php?url=asd&url[]=asd //asd&url[]=asd being the dynamic part 
```

然后`$_GET['url']`将是一个数组。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-14T23:08:33.137

无论您从中获取什么，`$_GET`都将永远是一个字符串。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T23:11:48.617

`$_GET`参数将始终是字符串。

但是您可以检查您的变量是否为数字，然后使用强制转换：

```
if (is_numeric($_GET['url'])) {
  $url = (int) $_GET['url'];
} 
```

[http://php.net/manual/en/function.is-numeric.php](http://php.net/manual/en/function.is-numeric.php)

[http://php.net/manual/en/language.types.type-juggling.php](http://php.net/manual/en/language.types.type-juggling.php)

# c++ - c++虚函数性能

> ID：13388941
> 
> 赞同：-1
> 
> 时间：2012-11-14T23:06:45.790
> 
> 标签：c++, performance, virtual

我有两个类`foo`，`bar`一个是另一个的超类，它们都有一个方法`hello_world`。

```
class foo {
    virtual void hello_world();
};
class bar : public foo {
    void hello_world();
}; 
```

我的问题是：如果我将它设为虚拟 for `bar`'s会有任何性能差异`hello_world`吗？它会变成这样：

```
class foo {
    virtual void hello_world();
};
class bar : public foo {
    virtual void hello_world();
}; 
```

我将主要`hello_world`从`bar`. 我知道虚函数会使函数变慢，因为我们会进行运行时查找。但是对于这种情况，有什么区别吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T23:11:01.473

与具有相同逻辑的可内联函数相比，在类实际上可能是多态的上下文中调用虚函数总是会对性能产生一些影响。主要原因是调用函数的开销很小，查找需要调用的函数的开销很小，以及优化机会的重大损失。最后一点通常是最昂贵的。

原始示例没有编译，也就是说，很明显还没有进行性能分析。一旦您测量到您的代码运行太慢并且特定调用确实在性能问题所在的区域中，请担心性能影响。

# php - 允许跨域ajax请求

> ID：13388942
> 
> 赞同：39
> 
> 时间：2012-11-14T23:06:47.867
> 
> 标签：php, ajax, cross-domain

在我的项目中，我需要允许其他人向我的脚本发送 ajax 请求。因此，外部请求可能来自其他网站和域，也可能来自浏览器扩展。
我在脚本顶部简单地添加了这两行，让他们这样做：

```
header('Access-Control-Allow-Origin: *');
header('Access-Control-Allow-Methods: GET, POST'); 
```

现在我的问题是：这里有我错过的任何安全考虑吗？这个简单的解决方案会造成严重的问题吗？
如果是这样，更好的解决方案是什么？

感谢您的回复。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-11-15T00:07:57.947

如上所述，任何人都可以随时向您的页面发送请求：因此您需要的主要安全问题是验证用户输入并仅显示可供公众使用的信息。但这适用于所有脚本。

您需要关注的两个主要问题（在验证用户输入之后）是：

1.  您可能遇到的问题是用户将信息接收到他们的脚本中。根据浏览器的不同（甚至在同一浏览器的不同版本之间），会有不同的安全规则阻止它们取回信息。一个常见的解决方案是将信息返回为“JSONP”，即将返回值包装为可由客户端执行的函数调用。这是一个简单的示例（取自[http://www.geekality.net/2010/06/27/php-how-to-easily-provide-json-and-jsonp/](http://www.geekality.net/2010/06/27/php-how-to-easily-provide-json-and-jsonp/)）。要进一步锁定它，您可以坚持所有查询都是 JSONP 并拒绝任何未发送回调函数的人。

.

```
<?php

header('content-type: application/json; charset=utf-8');
$data = array(1, 2, 3, 4, 5, 6, 7, 8, 9);
echo $_GET['callback'] . '('.json_encode($data).')';

?> 
```

2.  有人经常打电话滥用您的服务。解决方案是捕获 IP 地址并在您从 IP 地址收到过多呼叫时拒绝。并非万无一失，但这是一个开始。

其他要记住的因素：

*   脚本设置的 cookie 和其他标头可能会被忽略
*   同样适用于会话

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T23:13:10.623

就像 zerkms 所说，如果他们只是“进入”您的 php 页面，他们将能够看到它回显的任何内容。 **如果可能**（不确定），它还将允许不受欢迎的人甚至在本地主机上创建自己的表单并通过 AJAX 提交以获取他们想要的响应.. 如果您同意，并且信息不明确/无害的......那么我想它会是“安全的”。获取/传输敏感信息的方法不好

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-04T09:36:24.380

```
private function set_headers() {
    header("HTTP/1.1 ".$this->_code." ".$this->get_status_message());
    header("Content-Type:".$this->_content_type);           
    header("Access-Control-Allow-Origin: *");
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-10-21T13:47:18.740

这对我来说很完美。

```
header('Access-Control-Allow-Origin: *');
header("Access-Control-Allow-Headers: X-API-KEY, Origin, X-Requested-With, Content-Type, Accept, Access-Control-Request-Method");
header("Access-Control-Allow-Methods: GET, POST, OPTIONS, PUT, DELETE");
header("Allow: GET, POST, OPTIONS, PUT, DELETE");
$method = $_SERVER['REQUEST_METHOD'];
if($method == "OPTIONS") {
    die();
} 
```

# javascript - 地图不加载标记asp.net

> ID：13388950
> 
> 赞同：0
> 
> 时间：2012-11-14T23:07:07.413
> 
> 标签：javascript, asp.net, google-maps

我正在尝试创建具有多个位置的谷歌地图。地图显示得很好，但每个纬度和经度都没有出现标记。不知道我在这里做错了什么。我在网上找到了代码，只是根据要求对其进行了调整。如果你能在这里帮助我，我将不胜感激。

```
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
<title>Google Maps Multiple Markers</title>
<script src="http://maps.google.com/maps/api/js?key=apikey&sensor=false"
       type="text/javascript"></script>
<script type="text/javascript">

    var map;

    // Cretes the map
    function initialize() {
        map = new google.maps.Map(document.getElementById("map"), {
            zoom: 7,
            center: new google.maps.LatLng(42.0046, -93.2140),
            mapTypeId: google.maps.MapTypeId.ROADMAP
        });
        generateMarkers(
    ['Albia', 41.0157, -92.8094],
    ['Algona', 43.0811, -94.2356],
    ['Altoona', 41.6438, -93.4648],
    ['Ames', 42.0225, -93.6689],
    ['Ankeny', 41.7343, -93.6007],
    ['Atlantic', 41.4041, -94.9899],
    ['Bedford', 40.6758, -94.7259],
    ['Bettendorf', 41.5536, -90.4849],
    ['Bloomfield', 41.7514, -92.4189],
    ['Boone', 42.0638, -93.8765],
    ['Burlington', 40.8018, -91.1106],
    ['Carroll', 42.0713, -94.8771],
    ['Cedar Falls', 42.513, -92.4328],
    ['Cedar Rapids', 41.9743, -91.6978],
    ['Centerville', 40.7383, -92.8678],
    ['Chariton', 41.0147, -93.3253],
    ['Charles City', 43.0661, -92.6739],
    ['Cherokee', 42.7641, -95.5521],
    ['Clarinda', 40.7267, -95.0378],
    ['Clinton', 41.8364, -90.1931],
    ['Columbus Junction', 41.2799, 91.3606],
    ['Coralville', 41.6821, -91.592],
    ['Corning', 40.919, -94.7321],
    ['Corydon', 40.7573, -93.3157],
    ['Council Bluffs', 41.2613, -95.879],
    ['Creston', 41.0504, -94.3744],
    ['Davenport', 41.5105, -90.6202],
    ['Denison', 42.0168, -95.3535],
    ['Des Moines', 41.6256, -93.6527],
    ['Dubuque', 42.4915, -90.7251],
    ['Eldora', 42.3608, -93.1034],
    ['Estherville', 43.4021, -94.8286],
    ['Fairfield', 41.0047, -91.9786],
    ['Fort Dodge', 42.5052, -94.1581],
    ['Fort Madison', 40.6268, -91.3424],
    ['Grimes', 41.6868, -93.7826],
    ['Grinnell', 41.7347, -92.7269],
    ['Harlan', 41.6461, -95.3366],
    ['Humboldt', 42.7318, -94.2168],
    ['Huxley', 41.8943, -93.6007],
    ['Indianola', 41.3683, -93.5581],
    ['Iowa City', 41.6433, -91.5308],
    ['Iowa Falls', 42.5087, -93.2618],
    ['Jefferson', 42.0153, -94.375],
    ['Johnston', 41.6648, -93.6991],
    ['Keokuk', 40.4151, -91.4033],
    ['Knoxville', 41.3254, -93.1068],
    ['Lamoni', 40.6239, -93.9248],
    ['Laurens', 42.8468, -94.8516],
    ['Le Mars', 42.7778, -96.1847],
    ['Leon', 40.7397, -93.7565],
    ['Marcus', 42.8248, -95.8079],
    ['Marion', 42.0358, -91.5719],
    ['Marshalltown', 42.0391, -92.9127],
    ['Mason City', 43.1485, -93.2357],
    ['Milford', 43.4325, -95.1498],
    ['Mount Ayr', 40.7117, -94.233],
    ['Mount Pleasant', 40.9606, -91.5225],
    ['Muscatine', 41.4498, -91.0355],
    ['Newton', 41.6991, -93.0339],
    ['Osceola', 41.0304, -93.7723],
    ['Oskaloosa', 41.2949, -92.6497],
    ['Ottumwa', 41.0168, -92.4387],
    ['Pella', 41.3969, -92.9029],
    ['Perry', 41.8288, -94.1037],
    ['Pleasant Hill', 41.5979, -93.5199],
    ['Red Oak', 41.0195, -95.2328],
    ['Sheldon', 43.1866, -95.8314],
    ['Shenandoah', 40.7618, -95.3848],
    ['Sioux Center', 43.0562, -96.1754],
    ['Sioux City', 42.5196, -96.4178],
    ['Spencer', 43.1461, -95.1465],
    ['Spirit Lake', 43.4228, -95.1133],
    ['Storm Lake', 42.6526, -95.2009],
    ['Urbandale', 41.6294, -93.7369],
    ['Wapello', 41.1818, 91.1852],
    ['Washington', 41.2959, -91.7078],
    ['Waterloo', 42.4726, -92.3767],
    ['Waukee', 41.6155, -93.8538],
    ['Waverly', 42.7138, -92.4761],
    ['Webster City', 42.4695, -93.8246],
    ['West Des Moines', 41.597, -93.7522],
    ['Windsor Heights', 41.6004, -93.7151],
    ['Canton', 40.566, -90.0349],
    ['Galesburg', 40.9722, -90.3823],
    ['Hamilton', 40.3932, -91.345],
    ['Macomb', 40.4587, -90.6482],
    ['Milan', 41.4439, -90.5694],
    ['Moline', 41.4899, -90.4769],
    ['Peoria', 40.7394, -89.6058],
    ['Peru', 41.3395, -89.1291],
    ['Quincy', 39.9134, -91.3949],
    ['Rock Island', 41.4933, -90.5586],
    ['Silvis', 41.4897, -90.4216],
    ['Sycamore', 41.9587, -88.7189],
    ['Lawrence', 38.9428, -95.2814],
    ['Leawood', 38.9076, -94.6075],
    ['Lenexa', 38.971, -94.7413],
    ['Manhattan', 39.1859, -96.5609],
    ['Mission', 39.0203, -94.6619],
    ['Olathe', 38.8838, -94.7727],
    ['Overland Park', 38.9564, -94.7199],
    ['Prairie Village', 38.9907, -94.6078],
    ['Shawnee', 39.0148, -94.7432],
    ['Topeka', 39.0144, -95.7621],
    ['Albert Lea', 43.6843, -93.3588],
    ['Austin', 43.68, -92.99],
    ['Fairmont', 43.6455, -94.4474],
    ['Faribault', 44.2952, -93.297],
    ['Mankato', 44.1649, -94.0068],
    ['Marshall', 44.4379, -95.7763],
    ['New Ulm', 44.2929, -94.4411],
    ['Owatonna', 44.0673, -93.2261],
    ['Rochester', 44.0065, -92.4681],
    ['Waseca', 44.0899, -93.5068],
    ['Windom', 43.8671, -95.1144],
    ['Winona', 44.0469, -91.6762],
    ['Worthington', 43.6317, -95.5967],
    ['Albany', 40.2558, -94.3252],
    ['Belton', 38.8137, -94.5208],
    ['Bethany', 40.2586, -94.0279],
    ['Blue Springs', 39.0104, -94.2713],
    ['Chillicothe', 39.7986, -93.5539],
    ['Columbia', 38.9549, -92.3832],
    ['Gladstone', 39.2225, -94.5483],
    ['Grant City', 40.4875, -94.4069],
    ['Independence', 39.0784, -94.3946],
    ['Jefferson City', 38.5859, -92.2559],
    ['Kansas City', 39.2469, -94.6468],
    ['Kirksville', 40.1983, -92.5719],
    ['Lees Summit', 38.9188, -94.36],
    ['Liberty', 39.2453, -94.4495],
    ['Maryville', 40.3337, -94.8736],
    ['Osage Beach', 38.1619, -92.6042],
    ['Princeton', 40.3972, -93.5869],
    ['Raytown', 38.9938, -94.4693],
    ['Springfield', 37.1591, -93.3152],
    ['St. Joseph', 39.7675, -94.8033],
    ['Tarkio', 40.4389, -95.3759],
    ['Trenton', 40.0744, -93.6015],
    ['Unionville', 40.4722, -93.0192],
    ['Columbus', 41.4389, -97.3635],
    ['Fremont', 41.4515, -96.4867],
    ['Grand Island', 40.918, -98.3823],
    ['Lincoln', 40.8135, -96.6511],
    ['Norfolk', 42.0325, -97.4065],
    ['Omaha', 41.2412, -95.9939],
    ['Papillion', 41.1374, -96.0242],
    ['Plattsmouth', 41.0109, -95.9096],
    ['South Sioux City', 42.4659, -96.4277],
    ['Brookings', 44.2972, -96.7689],
    ['Sioux Falls', 43.5317, -96.6716],
    ['Vermillion', 42.7869, -96.9386],
    ['Watertown', 44.8899, -97.0947],
    ['Yankton', 42.8908, -97.3966],
    ['Madison', 43.1188, -89.3204]
  );
    }

    // This function takes an array argument containing a list of marker data
    function generateMarkers(locations) {
        for (var i = 0; i < locations.length; i++) {
            var marker = new google.maps.Marker({
                position: new google.maps.LatLng(locations[i][1], locations[i][2]),
                map: map,
                title: locations[i][0]
            });
            marker.setMap(map);
        }
    }
  </script>

</head> 
<body> 
 <div id="map" style="width: 800px; height: 600px;"></div>
   <script type="text/javascript">
     window.onload = function () {
      initialize();
   };
   </script>
 </body>
 </html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T23:22:04.180

您在标记周围缺少一组额外的方括号，以使其成为列表列表，目前传递给生成标记的位置参数只是第一点。

应该是`[['Albia', 41.0157, -92.8094]...['Madison', 43.1188, -89.3204]]`。

看到[这个jsfiddle](http://jsfiddle.net/f7RrQ/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T23:24:46.170

这是你的问题：

```
generateMarkers(
    ['Albia', 41.0157, -92.8094],
    ['Algona', 43.0811, -94.2356],
    ...
) 
```

用

```
generateMarkers(
   [
    ['Albia', 41.0157, -92.8094],
    ['Algona', 43.0811, -94.2356],
    ...
   ]
) 
```

# haskell - GHC IO 编译错误

> ID：13388951
> 
> 赞同：0
> 
> 时间：2012-11-14T23:07:18.040
> 
> 标签：haskell, ghc

我在 GHC 6.12.3 上编译以下代码时遇到问题，我不明白为什么。

function 的目的`test2`是返回一个函数，该函数使用整数从列表中获取字符串元素（列表是从对列表中的第一个节点创建的）。

IO 位是需要的，因为`test2`另一个使用 IO 的函数使用。

```
type PairList = [(String, String)]

test1 :: [String] -> Int -> String
test1 list x = list !! x

test2 :: PairList -> IO (Int -> String)
test2 pl = do
    f <- [fst x | x <- pl] :: IO [String]
    return test1 f 
```

GHC 给了我这个错误：

```
Test.hs:8:6:
    Couln't match expected type 'IO [String]'
        against inferred type '[a]'
    In a stmt of a 'do' expression:
        f <- [fst x | x <- pl] :: IO [String]
    In the expression:
        do { f <- [fst x | x <- pl] :: IO [String];
            return test1 f }
            ... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T23:12:10.190

编辑：
如果您想直接执行此操作（计算时需要额外的 IO `test2`），您可以执行类似的操作

```
test2 :: PairList -> IO (Int -> String)
test2 pl = do
     putStrLn "Hi Mum!"
     return (test1 [fst x | x <- pl]) 
```

您的原始代码不起作用，因为当您这样做时`f <- [...]`，您正在使用 list monad，就好像它是 IO monad。

仅作为示例，您可以像这样使用它：

```
myactions = do
   putStrLn "Please enter a list of (String,String) pairs:"
   pl <- readLn -- which you'd have to write, or derive Read and use readLn
   f <- test2 pl
   putStrLn "please enter a number:"
   n <- readLn
   putStrLn $ f n 
```

这会给你这样的行为

```
*Main> myactions
Please enter a list of (String,String) pairs:
[("hi","yes"),("oops","bye")]
Hi Mum!
please enter a number:
1
oops 
```

* * *

**原答案：**

我认为你不需要这些`IO`位：

```
type PairList = [(String, String)]

test1 :: [String] -> Int -> String
test1 list x = list !! x

test2pure :: PairList -> (Int -> String)
test2pure pl = test1 [fst x | x <- pl] 
```

这编译得很好，并给出了类似的结果

```
test2pure [("a String","ignored"), ("Another String","bye!")] 0
"a String" 
```

如果你想在 IO 中使用它，你可以这样使用它：

```
myactions = do
   pl <- readLn
   let chosen = test2pure pl 3
   putStrLn ("3: " ++ chosen) 
```

或者你可以写

```
test2IO :: PairList -> Int -> IO String
test2IO pl n = return (test2pure pl n) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T23:26:52.890

如果你真的想`IO ()`用作返回类型，你可以像这样修复编译错误：

```
test2 pl = return $ test1 [fst x | x <- pl] 
```

正如 AndrewC 在他的回答中所说，你可能在这个函数中不需要单子。

# c++ - DirectX 着色器无法正常工作？

> ID：13388952
> 
> 赞同：4
> 
> 时间：2012-11-14T23:07:22.467
> 
> 标签：c++, directx, shader, hlsl, occlusion

好的，所以我有这个用于环境光遮蔽的着色器。它正确加载到世界，但它只是将所有模型显示为白色。我不知道为什么。我只是在模型渲染时运行着色器，对吗？还是我需要制作渲染目标或其他东西？如果是这样，那怎么办？我正在使用 C++。这是我的着色器。

```
float sampleRadius;
float distanceScale;
float4x4 xProjection;
float4x4 xView;
float4x4 xWorld;

float3 cornerFustrum;

struct VS_OUTPUT
{
    float4 pos              : POSITION;
    float2 TexCoord         : TEXCOORD0;
    float3 viewDirection    : TEXCOORD1;
}; 

VS_OUTPUT VertexShaderFunction(
    float4 Position : POSITION, float2 TexCoord : TEXCOORD0)
{
    VS_OUTPUT Out = (VS_OUTPUT)0;

    float4 WorldPosition = mul(Position, xWorld);
    float4 ViewPosition = mul(WorldPosition, xView);
    Out.pos = mul(ViewPosition, xProjection);
    Position.xy = sign(Position.xy);
    Out.TexCoord = (float2(Position.x, -Position.y) + float2( 1.0f, 1.0f ) ) * 0.5f;
    float3 corner = float3(-cornerFustrum.x * Position.x,
            cornerFustrum.y * Position.y, cornerFustrum.z);
    Out.viewDirection =  corner;

    return Out;
}

texture depthTexture;
texture randomTexture;

sampler2D depthSampler = sampler_state
{
    Texture = <depthTexture>;
    ADDRESSU = CLAMP;
    ADDRESSV = CLAMP;
    MAGFILTER = LINEAR;
    MINFILTER = LINEAR;
};

sampler2D RandNormal = sampler_state
{
    Texture = <randomTexture>;
    ADDRESSU = WRAP;
    ADDRESSV = WRAP;
    MAGFILTER = LINEAR;
    MINFILTER = LINEAR;
};

float4 PixelShaderFunction(VS_OUTPUT IN) : COLOR0
{
    float4 samples[16] =
    {
        float4(0.355512,    -0.709318,  -0.102371,  0.0 ),
        float4(0.534186,    0.71511,    -0.115167,  0.0 ),
        float4(-0.87866,    0.157139,   -0.115167,  0.0 ),
        float4(0.140679,    -0.475516,  -0.0639818, 0.0 ),
        float4(-0.0796121,  0.158842,   -0.677075,  0.0 ),
        float4(-0.0759516,  -0.101676,  -0.483625,  0.0 ),
        float4(0.12493,     -0.0223423, -0.483625,  0.0 ),
        float4(-0.0720074,  0.243395,   -0.967251,  0.0 ),
        float4(-0.207641,   0.414286,   0.187755,   0.0 ),
        float4(-0.277332,   -0.371262,  0.187755,   0.0 ),
        float4(0.63864,     -0.114214,  0.262857,   0.0 ),
        float4(-0.184051,   0.622119,   0.262857,   0.0 ),
            float4(0.110007,    -0.219486,  0.435574,   0.0 ),
        float4(0.235085,    0.314707,   0.696918,   0.0 ),
        float4(-0.290012,   0.0518654,  0.522688,   0.0 ),
        float4(0.0975089,   -0.329594,  0.609803,   0.0 )
    };

    IN.TexCoord.x += 1.0/1600.0;
    IN.TexCoord.y += 1.0/1200.0;

    normalize (IN.viewDirection);
    float depth = tex2D(depthSampler, IN.TexCoord).a;
    float3 se = depth * IN.viewDirection;

    float3 randNormal = tex2D( RandNormal, IN.TexCoord * 200.0 ).rgb;

    float3 normal = tex2D(depthSampler, IN.TexCoord).rgb;
    float finalColor = 0.0f;

    for (int i = 0; i < 16; i++)
    {
        float3 ray = reflect(samples[i].xyz,randNormal) * sampleRadius;

        //if (dot(ray, normal) < 0)
        //  ray += normal * sampleRadius;

        float4 sample = float4(se + ray, 1.0f);
        float4 ss = mul(sample, xProjection);

        float2 sampleTexCoord = 0.5f * ss.xy/ss.w + float2(0.5f, 0.5f);

        sampleTexCoord.x += 1.0/1600.0;
        sampleTexCoord.y += 1.0/1200.0;
        float sampleDepth = tex2D(depthSampler, sampleTexCoord).a;

        if (sampleDepth == 1.0)
        {
            finalColor ++;
        }
        else
        {       
            float occlusion = distanceScale* max(sampleDepth - depth, 0.0f);
            finalColor += 1.0f / (1.0f + occlusion * occlusion * 0.1);
        }
    }

    return float4(finalColor/16, finalColor/16, finalColor/16, 1.0f);
}

technique SSAO
{
    pass P0
    {          
        VertexShader = compile vs_3_0 VertexShaderFunction();
        PixelShader  = compile ps_3_0 PixelShaderFunction();
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T22:14:19.230

回答核心问题：此着色器用于渲染目标处理——您需要在运行之前填充深度缓冲区。它不适用于在模型表面上进行渲染。

# c# - 表单加载的焦点问题

> ID：13388955
> 
> 赞同：0
> 
> 时间：2012-11-14T23:07:34.637
> 
> 标签：c#, winforms, focus

我有一个 ActiveX 控件（可能是用 VB 6.0 或 C++ 编写的），我们在 C# WinForms 程序中用作 AxInterop。它非常像一个文本框，但有一些特殊的逻辑等......我们已经将它添加到工具栏。

当表单加载时，我希望键盘焦点位于此控件内，因此我在其上使用了`.Focus`和`.Select`方法，但它仍然没有获得焦点。

当我从 Visual Studio 运行时，控件获得焦点。

当我在 IDE 之外运行时，控件没有获得焦点。

为什么是这样？

这是它的屏幕截图：

![在此处输入图像描述](../Images/e23d9e0e4ec40b8d2e8576b8f23c5c51.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T09:30:20.023

您可以使用[WindowsApi.SetFocus](http://msdn.microsoft.com/en-us/library/windows/desktop/ms646312%28v=vs.85%29.aspx)方法来设置焦点。
此方法可用于将焦点设置在**[外部应用程序](https://stackoverflow.com/questions/9503027/pinvoke-setfocus-to-a-particular-control)**中的特定控件上，因此它应该在您的应用程序中的第 3 方控件上工作。

这是另一个选项 - 一个工作代码块，用于在 winforms 中为外部应用程序中的控件设置焦点：

```
 [DllImport("user32.dll")]
    static extern IntPtr GetWindowThreadProcessId(IntPtr hWnd, IntPtr ProcessId);
    [DllImport("kernel32.dll")]
    static extern IntPtr GetCurrentThread();

    [DllImport("user32.dll")]
    static extern bool AttachThreadInput(IntPtr idAttach, IntPtr idAttachTo,  bool fAttach);

    [DllImport("user32.dll", SetLastError = true)]
    static extern bool BringWindowToTop(IntPtr hWnd);

    [DllImport("user32.dll")]
    [return: MarshalAs(UnmanagedType.Bool)]
    static extern bool SetForegroundWindow(IntPtr hWnd);

    [DllImport("User32.dll", EntryPoint = "FindWindow")]
    public static extern IntPtr FindWindow(String lpClassName, String lpWindowName);
    [DllImport("user32.dll")]
    static extern IntPtr SetFocus(IntPtr hWnd);

    [DllImport("user32.dll")]
    [return: MarshalAs(UnmanagedType.Bool)]
    static extern bool EnumChildWindows(IntPtr hwndParent, EnumWindowsProc lpEnumFunc, string  lParam);
    private delegate bool EnumWindowsProc(IntPtr hWnd, string className);

    [DllImport("user32.dll")]
    static extern uint RealGetWindowClass(IntPtr hwnd, [Out] StringBuilder pszType,   uint cchType);

    void SetFocus(IntPtr hwndTarget, string childClassName)
    {
        // hwndTarget is the other app's main window 
        // ...
        IntPtr targetThreadID = GetWindowThreadProcessId(hwndTarget, IntPtr.Zero); //target thread id
        IntPtr myThreadID = GetCurrentThread(); // calling thread id, our thread id

        bool lRet = AttachThreadInput(myThreadID, targetThreadID, true); // attach current thread id to target window

        // if it's not already in the foreground...
        lRet = BringWindowToTop(hwndTarget);
        SetForegroundWindow(hwndTarget);

        // Enumerate and find target to set focus on
        EnumChildWindows(hwndTarget, OnChildWindow, childClassName);
    }

    List<object> windowHandles = new List<object>();
    static bool OnChildWindow(IntPtr handle, string className)
    {
        // Find class of current handle
        StringBuilder pszType = new StringBuilder();
        pszType.Capacity = 255;
        RealGetWindowClass(handle, pszType, (UInt32)pszType.Capacity);

        string s = pszType.ToString();

        // Remove (potentially) unneeded parts of class
        if (s.Length > className.Length)
        {
            s = s.Substring(0, className.Length);
        }

        // Set focus on correct control
        if (s == className)
        {
            SetFocus(handle);
        }

        return true;
    }

    private void Form1_Load(object sender, EventArgs e)
    {
        InitializeComponent();

        SetFocus(this.Handle, "<ClassName from Spy++>");

    } 
```

如果您不知道该文本框的类名，您可以使用**spy++**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-16T06:58:14.780

当您尝试赋予它焦点时，您确定该组件是可见的吗？

如果您尝试在[`Form.Load`](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.load.aspx)事件处理程序中进行聚焦，请尝试将其移至[`Form.Shown`](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.shown.aspx)处理程序，或者也许[`Control.Enter`](http://msdn.microsoft.com/en-us/library/system.windows.forms.control.enter.aspx).

行为上的差异可能归结为时间问题。[在 MSDN 上](http://msdn.microsoft.com/en-us/library/86faxx0d.aspx)查看打开表单上事件发生的顺序以获得更多想法。

# cookies - Silex 透明饼干

> ID：13388958
> 
> 赞同：1
> 
> 时间：2012-11-14T23:07:43.590
> 
> 标签：cookies, silex

我正在使用 Silex，我正在尝试清除 cookie。为 Silex 提供的关于 cookie 控制的文档很差，所以我依赖于 Symfony2 - 不幸的是我无法让它工作！

```
$shop->match('/expire', function(Request $request) use ($app) {

    $response = new Response();
    $response->headers->clearCookie('order');
    $response = $app['twig']->render('completed.html.twig');

    return $response;

}); 
```

在另一次尝试中，我尝试使用负过期时间重新设置 cookie，但这也不起作用。完全没有错误。

有人知道我做错了什么吗？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-14T23:18:49.913

您正在创建一个响应对象，设置正确的标头，然后将其替换为内容字符串。这是你应该做的：

```
$response = new Response();
$response->headers->clearCookie('order');
$response->setContent($app['twig']->render('completed.html.twig'));

return $response; 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-03-08T14:09:40.267

“删除”对我来说就足够了：`$app['session']->remove('order');`

# r - 如何在限制区域绘制直线？

> ID：13388963
> 
> 赞同：1
> 
> 时间：2012-11-14T23:08:18.333
> 
> 标签：r, line

我有一个带有 2 条直线的频谱图，我使用以下命令制作：（a 是频谱左侧的斜率，b 是右侧的斜率。此处的边界为 3200 Hz）

```
a=0.009909
b=-0.003873

plot(spec, type="l", main...)

abline(a, col="orange")
abline(b, col="skyblue")
abline(v=3200, lty=2) 
```

![在此处输入图像描述](../Images/b4b44ab8c05801c702f9b2395129117d.png)

我想做的是绘制橙色线直到 3200 Hz 和从 3200 Hz 开始的天蓝色线，如下图（大致由 photoshop 创建，抱歉）：

![在此处输入图像描述](../Images/8fd789ef8398070393de974362a28112.png)

这与功能 abline() 可能吗？或者有什么办法吗？

非常感谢你！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-16T09:46:11.753

如果您有拟合模型，那么最好的解决方案是使用该`predict()`方法为感兴趣的区间上的一组等距点生成预测。

使用来自@thelatemail 答案的数据

```
df <- data.frame(y = c(1.4, 2.3, 3.8, 3.6, 5.9, 5.4, 7.6, 7.4, 8.1,
                       8.7, 7.4, 6.9, 5.4, 4.7, 2.7, 1.8, 1.1),
                 x = 1:17,
                 ind = rep(c(TRUE,FALSE), times = c(8,9)))

fit1 <- lm(y ~ x, data = df, subset = ind)
fit2 <- lm(y ~ x, data = df, subset = !ind)

## regions in a new data frame over which to predict
r1 <- data.frame(x = seq(from = 1, to = 8, length.out = 20))
r2 <- data.frame(x = seq(from = 9, to = 17, length.out = 20))

## predict
p1 <- predict(fit1, newdata = r1)
p2 <- predict(fit2, newdata = r2)

## add lines to plot
plot(y ~ x, data = df, type = "l")
lines(p1 ~ x, data = r1, col = "red")
lines(p2 ~ x, data = r2, col = "blue") 
```

这给

![在此处输入图像描述](../Images/8e9901fe9716fbd4e142f733ae8765bb.png)

这是一种比手动写出方程式更灵活的方法，并且适用于许多类型的模型，它们都有`predict()`方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-15T02:06:29.993

*编辑以修复错误*

这是一个可以扩展到您的数据的基本示例。它依赖于为每个数据子集生成最佳拟合线的系数，首先使用`glm`然后在`lines`语句中调用它们。

```
test <- c(1.4, 2.3, 3.8, 3.6, 5.9, 5.4, 7.6, 7.4, 8.1, 8.7, 7.4, 6.9, 
5.4, 4.7, 2.7, 1.8, 1.1)

plot(test,type="l",ylim=c(0,12))
fit1 <- glm(test[1:8] ~ I(1:8))
fit2 <- glm(test[9:17] ~ I(1:9))

# ...$coefficients[2] is the slope, ...$coefficients[1] is the intercept
lines(1:9, 1:9 * fit1$coefficients[2] + fit1$coefficients[1],col="red")
lines(9:17,1:9 * fit2$coefficients[2] + fit2$coefficients[1],col="blue") 
```

![在此处输入图像描述](../Images/6d5aa564bd18fdea631247b5abc7c0c6.png)

# ruby - 如何通过单个#each 迭代从 XML 树中提取多个元素

> ID：13388968
> 
> 赞同：0
> 
> 时间：2012-11-14T23:08:41.030
> 
> 标签：ruby, xml, nokogiri

我的 xml 看起来像这样：

```
<entry>
  <updated>2012-11-14T13:58:49-07:00</updated>
  <id im:id="557137623" im:bundleId="com.rovio.angrybirdsstarwars">Some text</id>
  <title>Angry Birds Star Wars - Rovio Entertainment Ltd</title>
</entry>
<entry>
  <updated>2012-11-14T13:58:49-07:00</updated>
  <id im:id="557137623" im:bundleId="com.rovio.angrybirdsstarwars">Some text</id>
  <title>Angry Birds Star Wars - Rovio Entertainment Ltd</title>
</entry> 
```

我想使用 Nokogiri 从 xml 中获取一些数据。即我对上面的 xml中的`im:id`,`im:bundleId`​​ 和感兴趣。`<title>`

我已经设法达到了这个工作的阶段：

```
xml.css("entry id").each do |entry|
   puts entry["im:id"]
   puts entry["im:bundleid"]
end 
```

问题是要获得`title`内容，我必须`xml.css("entry title")`单独迭代。是否有遍历条目然后在同一个循环中提取`id`数据和数据的方法？`title`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-15T00:22:32.963

首先，您的示例 XML 未正确嵌套，因此需要修复：

```
<root>
  <entry>
    <updated>2012-11-14T13:58:49-07:00</updated>
    <id im:id="557137623" im:bundleId="com.rovio.angrybirdsstarwars">Some text</id>
    <title>Angry Birds Star Wars - Rovio Entertainment Ltd</title>
  </entry>
  <entry>
    <updated>2012-11-14T13:58:49-07:00</updated>
    <id im:id="557137623" im:bundleId="com.rovio.angrybirdsstarwars">Some text</id>
    <title>Angry Birds Star Wars - Rovio Entertainment Ltd</title>
  </entry>
</root> 
```

然后，这有效：

```
require 'nokogiri'
require 'pp'

doc = Nokogiri::XML(<<EOT)
<root>
  <entry>
    <updated>2012-11-14T13:58:49-07:00</updated>
    <id im:id="557137623" im:bundleId="com.rovio.angrybirdsstarwars">Some text</id>
    <title>Angry Birds Star Wars - Rovio Entertainment Ltd</title>
  </entry>
  <entry>
    <updated>2012-11-14T13:58:49-07:00</updated>
    <id im:id="557137623" im:bundleId="com.rovio.angrybirdsstarwars">Some text</id>
    <title>Angry Birds Star Wars - Rovio Entertainment Ltd</title>
  </entry>
</root>
EOT

pp doc.search('entry').map{ |e|
  id = e.at('id')
  [
    id['id'],
    id['bundleId'],
    e.at('title').text
  ]
} 
```

看起来像：

```
[["557137623",
  "com.rovio.angrybirdsstarwars",
  "Angry Birds Star Wars - Rovio Entertainment Ltd"],
["557137623",
  "com.rovio.angrybirdsstarwars",
  "Angry Birds Star Wars - Rovio Entertainment Ltd"]] 
```

这是有效的，因为我正在浏览`entry`标签。对于每个`entry`，我都会查找`id`标签并记住它，这样就可以轻松地反复查看`id`和`bundleID`参数。`e`然后这是一个在内部寻找`title`标签的简单案例。

我确信它可以使用一些时髦的 XPath 来完成，但我是凡人并且喜欢保持简单。

# actionscript-3 - 为 Flash AS3 和 Away3D 中的对象创建自定义类

> ID：13388969
> 
> 赞同：0
> 
> 时间：2012-11-14T23:08:43.323
> 
> 标签：actionscript-3, flash, class, 3d, away3d

我将使用 Away3D API 在 Flash AS3 中制作一个基于图块的 3D RPG 游戏。

我的问题是到目前为止我还不太了解 away3d api..

我想做一个“块”类。如果我加载瓷砖地图数据，我想做这样的事情：

```
viewport.addchild( tileArray[ layer ][ x ][ y ] ); 
```

所以这将是一个循环。

到目前为止一切都很好，但这必须是一个 3dObject。

用那个 3dObject 填充那个数组，我想做这样的事情。

```
tileArray[ layer ][ x ][ y ] = myBlocksClass.getBlock( "grassCube" ); 
```

所以 myBlocksClass 中的 getBlock 函数会返回一个 3dObject。

`<edit>`

这些块应该是类似于我的世界中的某种块（grassCube，dirtCube，...）所以我想在地图中加载一个块的多个实例

`</edit>`

我怎样才能做到这一点 ？有人可以给我任何想法或参考吗？

是的，我已经查看了所有可访问的资源/纪录片/示例，但无论如何我都无法弄清楚。

**更新：**

问题更多的是编码。我知道这个理论，但游戏开发的 actionscript3 对我来说几乎是新的。

如何为“块”构建类？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T04:53:37.477

大多数 3D 应用程序实际上都是基于图块的。例如，流行的地形实现是一组具有高分辨率混搭用于近距离和低分辨率的块。这些块（以及场景中的每个对象）都组织在场景图中。通常它的[八叉树](http://en.wikipedia.org/wiki/Octree)。 ![八叉树地形](../Images/d3c1d0e7be045f92dbc25f697657e183.png)

还有[截锥体剔除](http://en.wikipedia.org/wiki/Viewing_frustum)

引擎只渲染部分（或全部）在视图金字塔内的节点。

[这里是Away3D的实现](http://away3d.com/livedocs/away3d/4.0/away3d/core/partition/package-detail.html)

特定案例的优化同样非常重要，但也非常棘手。例如，地形网格顶点顺序和块大小针对 GPU 追逐命中进行了优化，并且可能是 GPU 特定的（为特定客户端构建），同时与纹理和阴影的数量相关（如果不需要，您不想交换材质所以最好用相同的材​​料一个接一个地渲染块然后交换材料）或者如果你有 1000 个纹理立方体，你只需要一个模型，它将用不同的材料绘制 1000 次。这对 GPU 内存有好处，但它就像 10000 次绘图调用，可能会严重损害您的性能。因此，您可能希望将它们焊接到更适合八叉树节点并具有组合纹理的更大对象上。但是你显然想丢弃那些在地下并且看不到的立方体。

# nunit - NunitLite 自定义 ITestListener, TestOutput() 从未调用

> ID：13388971
> 
> 赞同：0
> 
> 时间：2012-11-14T23:08:55.087
> 
> 标签：nunit

我已经实现了 NunitLite ITestListener 的自定义实现。永远不会调用 TestOutput(...) 方法，无论我调用 stdout 的方式（Console.WriteLine、Trace.WriteLIne、Debug.WriteLine 等）。我不确定这是否是一个错误。简单的代码检查显示 TestOutput 类从未在捕获的输出上实例化。我非常感谢您的任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T16:08:05.647

事实证明，NUnitLite 默认不支持此功能。话虽如此，使用自定义 TextWriter（见下文代码）的简单重定向到标准 IO 效果很好。非常感谢 Charlie Pool 的基本答案。

在您的 program.cs 或 App.xaml.cs 中使用以下内容：

```
//Override output in order to get mid-test output.
Console.SetOut(new TestListenerTextWriter(IoC.Resolve<ITestListener>(), TestOutputType.Out));
Console.SetError(new TestListenerTextWriter(IoC.Resolve<ITestListener>(), TestOutputType.Error));
Trace.Listeners.Add(new TextWriterTraceListener(new TestListenerTextWriter(IoC.Resolve<ITestListener>(), TestOutputType.Trace))); 
```

然后定义 TestListenerTextWriter 如下。

```
public class TestListenerTextWriter : TextWriter
{
    private readonly ITestListener _eventListener;
    private readonly TestOutputType _type;

    public TestListenerTextWriter(ITestListener eventListener, TestOutputType type)
    {
        _eventListener = eventListener;
        _type = type;
    }
    override public void Write(char aChar)
    {
        _eventListener.TestOutput(new TestOutput(aChar.ToString(CultureInfo.InvariantCulture), _type));
    }

    override public void Write(string aString)
    {
        _eventListener.TestOutput(new TestOutput(aString, _type));
    }

    override public void WriteLine(string aString)
    {
        _eventListener.TestOutput(new TestOutput(aString + NewLine, _type));
    }

    override public Encoding Encoding
    {
        get { return Encoding.Default; }
    }
} 
```

# objective-c - 获取 AppKit 类的私有方法的名称

> ID：13388976
> 
> 赞同：0
> 
> 时间：2012-11-14T23:09:09.563
> 
> 标签：objective-c, xcode, macos, cocoa, private

我已经为此苦苦挣扎了一段时间。

有很多次我想改变控件中的一些小东西，但我不得不重新绘制整个东西来调整它。就像一个 NSPathControl，我只是想改变路径控件的背景，我最终创建了一个全新的控件，只是为了那个小调整......

Apple 使用私有方法，如下所示：

```
- (void)_drawContextMenuHighlightForIndexes:(NSIndexSet *)rowIndexes clipRect:(NSRect)rect; 
```

我在 Stackoverflow-Post 中找到了这个。

我应该怎么知道这些？我不认为它们是公开的，但这更容易。这些人是从哪里知道的？有没有参考资料？我不需要知道任何源代码，我只需要知道私有方法的名称。

所以我的问题是，如何获取 AppKit 类的私有方法的名称？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T23:16:05.513

可以使用[Obj-C 运行时函数](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/ObjCRuntimeRef/Reference/reference.html)获取私有类方法名称。要获取类的方法列表，您可以执行以下操作：

```
unsigned int methodCount;
Method *methods = class_copyMethodList(theClass, &methodCount);
for (int i = 0; i < methodCount; i++) {
    Method method = methods[i];
    NSString *methodName = NSStringFromSelector(method_getName(method));
    // collect name in an array or print it.
}
free(methods); 
```

还有一个方便的终端工具可以为您执行此操作，称为[class-dump](http://stevenygard.com/projects/class-dump/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T23:20:03.740

您可以在运行时查询类具有的方法/属性/变量，或者使用来自 github 的便捷工具 (DDDump)，该工具在运行时通过在 NSObject 上添加类别来执行此操作

```
NSLog(@"%@", [obj dump]); 
```

* * *

**NSObjCMessageLoggingEnabled**环境变量没有被要求但在该上下文中也非常有用，它 - 当是时 - 允许您查看任何调度完成！

* * *

哦，获取所有通知也总是一个好主意:)

# jquery - jQuery 1.4.2，获取文本并替换第一个字符

> ID：13388979
> 
> 赞同：1
> 
> 时间：2012-11-14T23:09:26.910
> 
> 标签：jquery, string, replace

我有以下 HTML：

```
<span class="drop_cap">3 <span>Dinners</span></span> 
```

我想替换第一个字符。数字会根据用户交互而变化，所以我不能只抓住“3”

我试过了：

```
$("drop_cap").text().substr(0,1).replace(var); 
```

和

```
$("drop_cap").html().substr(0,1).replace(var); 
```

和类似的事情。

TIA

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T23:28:34.400

jQuery 不太擅长处理文本节点。由于您知道要编辑跨度内的第一个节点（文本节点），因此可以执行以下操作。

```
// This inserts 100 in front of that text node inside drop_cap
$("span.drop_cap").each(function(){
    this.firstChild.nodeValue = "100" + this.firstChild.nodeValue;
}); 
```

这是一个使用的示例`String.replace`

```
$("span.drop_cap").each(function(i){
    this.firstChild.nodeValue = this.firstChild.nodeValue.replace(/\d/, i);
}); 
```

示例： http: [//jsfiddle.net/rLGPW/2/，http](http://jsfiddle.net/rLGPW/2/) : [//jsfiddle.net/rLGPW/3/](http://jsfiddle.net/rLGPW/3/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T23:15:21.060

解决方法，这更容易，特别是如果您只使用数字：

```
<input id='number' type='text' readonly='readonly' value='3'> 
```

现在您可以使用 J-QUERY 更改输入的值，这比尝试更改 html 的错误少很多。

```
$("#number").val(var); 
```

并确保你 css 输入框，因为默认情况下它具有时髦的输入框样式

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T23:32:08.747

如果你知道总是有一个数字，然后只有一些文本，我想你可以使用一个简单的正则表达式来提取数字：

```
var num = $('span.drop_cap').text().match(/\d+/)[0] 
```

# android - 无法为前置摄像头设置 HIGH_QUALITY 配置文件

> ID：13388981
> 
> 赞同：0
> 
> 时间：2012-11-14T23:09:32.633
> 
> 标签：android, android-camera, android-capture

我不断收到“11-15 01:00:53.185: E/MediaRecorder(976): setOutputFormat called in an invalid state: 1” on "recorder.setProfile(profile); "

```
package com.apress.proandroidmedia.ch1.cameraintent;

import java.io.IOException;

import android.app.Activity;
import android.hardware.Camera;
import android.media.CamcorderProfile;
import android.media.MediaRecorder;
import android.os.Bundle;
import android.view.SurfaceHolder;
import android.view.SurfaceView;

public class JustRecord extends Activity implements SurfaceHolder.Callback{

    SurfaceView cameraView;
    SurfaceHolder surfaceHolder;
    Camera camera;
    MediaRecorder recorder;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main1);
        cameraView = (SurfaceView) findViewById(R.id.CameraView);
        surfaceHolder = cameraView.getHolder();
        surfaceHolder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS);
        surfaceHolder.addCallback(this);

    }

    @Override
    public void surfaceChanged(SurfaceHolder arg0, int arg1, int arg2, int arg3) {
        // TODO Auto-generated method stub

    }

    @Override
    public void surfaceCreated(SurfaceHolder holder) {
        // TODO Auto-generated method stub

        try{
            camera = Camera.open(Camera.CameraInfo.CAMERA_FACING_FRONT);
            camera.setDisplayOrientation(90);

        }
        catch (Exception exception){
            camera.release();
            exception.printStackTrace();
        }

        recorder = new MediaRecorder();
        recorder.setCamera(camera);

        CamcorderProfile profile = CamcorderProfile.get(Camera.CameraInfo.CAMERA_FACING_FRONT, CamcorderProfile.QUALITY_HIGH);
        if(profile != null) {
            recorder.setProfile(profile);  

        }else {
            //default to basic H263 and AMR_NB if profile not found
            recorder.setAudioEncoder(MediaRecorder.AudioEncoder.AMR_NB);       
            recorder.setVideoEncoder(MediaRecorder.VideoEncoder.H263);
        }

        recorder.setOutputFile("/sdcard/videocapture_example.mp4");
        recorder.setMaxDuration(5000); // 50 seconds

        prepareRecorder();
        recorder.start();

    }

    @Override
    public void surfaceDestroyed(SurfaceHolder arg0) {
        // TODO Auto-generated method stub
        //camera.stopPreview();
        recorder.stop();
        recorder.release();
        camera.release();
    }

    private void prepareRecorder() {
        recorder.setPreviewDisplay(surfaceHolder.getSurface());

        try {
            recorder.prepare();
        } catch (IllegalStateException e) {
            e.printStackTrace();
            finish();
        } catch (IOException e) {
            e.printStackTrace();
            finish();
        }
    }

} 
```

有任何想法吗？谢谢！

编辑：我不妨补充一点，如果我输入编解码器等，代码就可以正常工作。只是由于某种原因我无法确定最好的质量。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T20:28:55.357

我设法通过实际开始考虑改变来解决这个问题......

当您查看 MediaRecorder 流程​​图时，您首先看到的是定义的 AudioSource 和 VideoSource。此外，在使用 CamcorderProfile 时，显然没有定义这 2 个。然而，在定义了这两行之后，MediaRecorder 仍然拒绝启动。这里缺少的是“camera.unlock()”，因为我的相机在之前的测试中被“拍摄”了。

# typescript - TypeScript 可以在哪些 JS 运行时上运行？

> ID：13388982
> 
> 赞同：1
> 
> 时间：2012-11-14T23:09:50.327
> 
> 标签：typescript

...除了 Microsoft 支持的 Node.js 和 Windows Script Host。

有没有人尝试过 IronJS 或 *Monkey、Rhino、Carakan、Microsoft.JScript 等？

**更新：**显然，有一个[支持 Rhino](http://typescript.codeplex.com/SourceControl/network/forks/nobuoka/TypeScript/changeset/view/c2417dec616e)的叉子。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-11-16T09:19:46.760

有几种方法可以在 Java 环境中运行 TypeScript 编译器。除了上面提到的“maven-typescript-plugin”（顺便说一句似乎被放弃了。）还有一个名为“Typescript4j”的项目。

但据我所知，在 Java 的 Rhino JS 引擎上运行 TypeScript 通常存在巨大的性能问题：由于 JVM 问题（“64K 方法大小限制”），无法在“优化”中运行 Rhino但它需要以“解释”模式执行。因此，解析内部捆绑的“lib.d.ts”（每次执行 TypeScript 编译器都需要）需要很长时间（在我的计算机上至少需要 30 秒！）。我也玩过新的 Nashorn JS 引擎（与 JDK 8 捆绑），但我没有注意到性能改进。

最后，我使用“grunt-maven-plugin”来编译 Java/Maven 项目中的 TypeScript 文件。您可能想看看[http://pegirino.wordpress.com/2013/11/08/typescript-in-maven-projects/](http://pegirino.wordpress.com/2013/11/08/typescript-in-maven-projects/)和/或[https://github.com/pkaul/maven-typescript-example](https://github.com/pkaul/maven-typescript-example)以获得更详细的描述和示例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-05-01T08:27:06.987

在具有 Maven 和 NPM 依赖项的 JVM 上运行：[https ://1c.wizawu.com](https://1c.wizawu.com)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-14T23:25:00.847

其他主机不会开箱即用，因为在 中没有文件 I/O 实现`io.ts`，除非这些主机恰好具有与节点或 WSH 完全匹配的文件 API。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-24T20:45:25.373

除了您提到的 fork 之外，当然可以为几乎任何运行时实现您自己的适配器，例如参见[https://github.com/ppedregal/typescript-maven-plugin/blob/master/src/main/资源/模块/fs.js](https://github.com/ppedregal/typescript-maven-plugin/blob/master/src/main/resources/modules/fs.js)。

# django-models - 如何在 Django 中描述 set 字段

> ID：13388984
> 
> 赞同：1
> 
> 时间：2012-11-14T23:09:55.787
> 
> 标签：django-models, set

我有一个文章对象，并且想给它分配一些标签（我有多达 30 个预定义的类别），所以我需要在 ArticleModel 中有一组有序的属性。

我尝试为 TagsTable 创建几个 ForeignKey，但在这种情况下，用户可以多次设置相同的标签。

是否有任何标准方法可以在 Django ORM 中存储集合字段？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T00:56:44.537

在 ArticleModel 中使用 ManyToManyField 而不是 ForeignKey。

# gpars - GPAR 异步函数和传递由另一个线程更新的引用

> ID：13388986
> 
> 赞同：0
> 
> 时间：2012-11-14T23:10:18.220
> 
> 标签：gpars

在解析文件中的每一行时，我正在使用 GPAR 异步函数来触发进程。

我看到一些奇怪的行为，这让我想知道我是否有线程安全问题。

假设我有一个当前对象正在加载输入电子表格中当前行的值，如下所示：

```
Uploader {
  MyRowObject currentRowObject
} 
```

一旦它具有当前行中的所有值，我就会启动一个看起来有点像这样的异步闭包：

```
Closure processCurrentRowObject = { ->
    myService.processCurrentRowObject (currentRowObject)
}.asyncFun() 
```

它在同一个类中定义，因此它可以访问 currentRowObject。

当它关闭并运行时，我解析下一行，并从创建一个新对象开始：

```
MyObject currentObject = new MyObject() 
```

并开始用值加载它。

我认为这是安全的，异步函数将指向前一个对象。但是，我想知道是否因为我让闭包绑定到引用，如果以某种方式在异步函数中更新了引用，并且我正在从它下面拉出对象实例，可以这么说 - 在它尝试时更改它处理前一个实例。

如果是这样，有什么修复建议吗？还是我安全？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T09:49:36.053

我不确定我是否完全理解您的情况，但是，这里有一个快速提示。由于在线程之间共享单个可变对象总是很危险，我建议完全分离用于不同行的行对象：

最终 localRowObject = currentRowObject currentRowObject = null

关闭 processCurrentRowObject = { -> myService.processCurrentRowObject (localRowObject) }.asyncFun()

# c++ - 在对话框中显示容器元素

> ID：13388990
> 
> 赞同：0
> 
> 时间：2012-11-14T23:10:46.420
> 
> 标签：c++, visual-studio-2010, dialog

此问题适用于 Microsoft Visual Studio 2010 Professional 的资源查看器/编辑器。这更像是一个设计问题而不是编程问题，但由于对话框是程序设计的一部分，我认为问它不会有坏处。

我有几个这样的结构：

```
struct Car
{
    const char* m_color;
    int m_miles;
};

struct CarGarage
{
    std::vector<Car> m_cars;

    int m_capacity;
    bool m_freeparking;
}; 
```

我想创建一个对话框来编辑车库以及其中的任何汽车。由于车库可以拥有可变数量的汽车，因此我很难弄清楚如何设计对话框。

到目前为止，我有一个简单的对话框，用于编辑单个汽车的信息。我希望`Edit CarGarage`对话框列出所有汽车，并提供一种机制来编辑每辆汽车，如果用户选择这样做的话。

工具箱中是否有任何实用程序旨在处理此类情况？是否存在用于在对话框中显示可变数量的容器元素的优雅解决方案？

# php - 从字符串中获取多个数字

> ID：13388994
> 
> 赞同：0
> 
> 时间：2012-11-14T23:10:56.480
> 
> 标签：php, string, dynamic, numbers, extraction

我有一个表格，其中一个输入名称的数字与我的数据库中的信息相对应。我需要提取数字并将它们设置为变量，以便我可以使用它们来存储和检索数据库中的数据。

示例：rdobtn_1_15 或 qtybx_9_82

那么数字将是动态的并且会改变，所以我需要一些可以获取数字的东西，无论它们是“20”还是“5327”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T23:20:48.893

```
$input = 'rdobtn_1_15'
$matches = null;
$returnValue = preg_match('/_(\\d+)_(\\d+)/', $input, $matches); 
```

您的匹配项将存储为

```
array (
  0 => '_1_15',
  1 => '1',
  2 => '15',
) 
```

所以你的号码可以通过

```
echo $matches[1] // 1
echo $matches[2] // 15 
```

供参考：[正则表达式](http://de.wikipedia.org/wiki/Regular_Expression)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T23:20:13.483

如果这是您想要实现的，您可以从字符串中提取数字，使用：

```
preg_match_all('!\d+!', $your_string, $matches);
print_r($matches); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T23:13:11.247

```
$array = explode('_', $string);

$element = $array[5]; // or whichever element you want 
```

# java - 平板扫描仪中的 ADF

> ID：13388997
> 
> 赞同：1
> 
> 时间：2012-11-14T23:11:02.553
> 
> 标签：java, scanning

Wee 正在使用 Jimageconnect Java API 来扫描来自不同设备的文件。使用 HP scanjet 3000 等单进纸扫描仪，一切正常，但使用 HP scanjet 7500（具有 ADF 和玻璃表面）我们无法从 ADF（仅从玻璃表面）获取扫描图像，是否有任何其他 java API 可以访问来自这种平板扫描仪的 ADF？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-05-05T06:25:09.423

是的。

通过 TWAIN 访问扫描仪：http: [//asprise.com/product/jtwain/](http://asprise.com/product/jtwain/)

这将允许您通过 WIA 在 Java 中进行 ADF 扫描：http: [//asprise.com/product/jia](http://asprise.com/product/jia)

正如您提到的第二个扫描仪有两个功能单元 - 平板和进纸器，您需要在调用 ADF 之前选择第二个功能单元。

*免责声明：我为提供上述产品的公司工作。*