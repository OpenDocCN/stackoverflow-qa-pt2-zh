# StackOverflow 问答 13495000-13495999

# java - 以编程方式识别当前的 eclipse 实例

> ID：13495000
> 
> 赞同：0
> 
> 时间：2012-11-21T14:04:32.647
> 
> 标签：java, eclipse, eclipse-plugin

我正在开发一个 Eclipse 插件，我通过本地主机上的端口在客户端和插件端之间进行通信。问题是，如果多个 Eclipse 实例同时运行，它会失败，所以我需要以某种方式识别匹配的实例。对于使用的框架（SIMON），没问题，有一个注册表，我可以很容易地使用不同的标识符，但是如何找出哪个客户端实例与哪个插件实例在同一个 Eclipse 上运行？

我的想法是以某种方式从双方访问当前工作区的目录并使用文件进行通信。从插件中可以很容易地做到这一点，但是任何java项目也可以（干净地）实现吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T14:41:10.030

我建议您使用 Eclipse EMF 生成通用唯一 ID 的功能：

```
EcoreUtil.generateUUID() 
```

您可以让每个客户端和服务器生成一个 UUID 并使用它来区分不同的实例。

# vba - countif/条件vba/锁定宏

> ID：13495002
> 
> 赞同：0
> 
> 时间：2012-11-21T14:04:35.757
> 
> 标签：vba, excel

`sub financials`

```
dim g as long
dim r as long
dim y as long
dim oh as range
dim vr as range
dim sum as long
set vr = Sheets("Financials").Range("B5:B53")
set oh = sheets("Financials").Range("B2")

y = application.worksheetfunction.countif(vr, "y")
g = application.worksheetfunction.countif(vr, "g")
r = application.worksheetfunction.countif(vr, "r")

if g = 5 then
oh = "G"
elseif g = 4 and y = 1 then
oh = "G"
elseif r>=2 then
oh = "R"
elseif y >= 1 and r>= 1 then
oh = "R"
elseif y >=3  then
oh = "R"
elseif g=3 and y=2 then
oh = "Y"
elseif g=4 and r=1 then
oh = "Y"
elseif g=2 and y=3 then
oh = "Y"
elseif y=2 then
oh = "Y"
end if
end sub 
```

这是我到目前为止所写的，它工作正常，但正如你所见，有 5 个单元格决定了整个单元格。但我意识到有时少于 5 个单元格 - 有时只有 2 个或 3 个。如果少于 5 个，则此公式不适用，因为它需要 5 个单元格来确定整个单元格。

我正在考虑使用 sum 函数。所以总结 y, g, r 的计数，如果该总和等于 1,2,3 那么它将执行以下命令，但我不知道该怎么做

如果 y,g,r 之和 = 3，则执行以下操作：

```
if g = 3 then
oh = "G"
elseif g = 1 and y = 2 then
oh =  "Y"
elseif g = 2 and r = 1 then
oh = "Y"
elseif g =1 and y = 1 and r =1 then
oh = "R"
elseif y = 2 and r = 1 then
oh = "R"
elseif r = 3 then
oh = "R" 
```

如果 y,g,r 之和 = 2，则执行以下操作：

```
if g = 2 then
oh ="G"
elseif g = 1 and y = 1 then 
oh = "y"
elseif y = 1 and r =1 then
oh = "R" 
```

等等

我也需要锁定工作表，但宏必须继续运行。我怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T14:40:39.463

在获得单元格的总和后，您可以使用选择案例。对于这个例子，我会使用 select case，因为它比使用 ifs 和 else ifs 对我来说更简洁一些，但这是个人喜好。有关选择案例的更多示例，请[在此处查看](http://support.microsoft.com/kb/141691)

锁定工作表需要一行：

```
sheets("worksheetname").protect userinterfaceonly:=True 
```

有关工作表锁定的更多信息，请查看此[链接](http://www.cpearson.com/Excel/Protection.aspx)

```
Sub financials()

Dim g As Long
Dim r As Long
Dim y As Long
Dim oh As Range
Dim vr As Range
Dim sum As Long
Dim i
Set vr = Sheets("Financials").Range("B5:B53")
Set oh = Sheets("Financials").Range("B2")

y = Application.WorksheetFunction.CountIf(vr, "y")
g = Application.WorksheetFunction.CountIf(vr, "g")
r = Application.WorksheetFunction.CountIf(vr, "r")

x = y + g + r

Select Case x
    Case Is = 5
        If g = 5 Then
        oh = "G"
        ElseIf g = 4 And y = 1 Then
        oh = "G"
        ElseIf r >= 2 Then
        oh = "R"
        ElseIf y >= 1 And r >= 1 Then
        oh = "R"
        ElseIf y >= 3 Then
        oh = "R"
        ElseIf g = 3 And y = 2 Then
        oh = "Y"
        ElseIf g = 4 And r = 1 Then
        oh = "Y"
        ElseIf g = 2 And y = 3 Then
        oh = "Y"
        ElseIf y = 2 Then
        oh = "Y"
        End If

    Case Is = 3
        If g = 3 Then
        oh = "G"
        ElseIf g = 1 And y = 2 Then
        oh = "Y"
        ElseIf g = 2 And r = 1 Then
        oh = "Y"
        ElseIf g = 1 And y = 1 And r = 1 Then
        oh = "R"
        ElseIf y = 2 And r = 1 Then
        oh = "R"
        ElseIf r = 3 Then
        oh = "R"
        End If

    Case Is = 2
        If g = 2 Then
        oh = "G"
        ElseIf g = 1 And y = 1 Then
        oh = "y"
        ElseIf y = 1 And r = 1 Then
        oh = "R"
        End If

    'more cases here

    End Select

End Sub 
```

# ruby-on-rails - Rspec匹配器评估css？

> ID：13495006
> 
> 赞同：1
> 
> 时间：2012-11-21T14:04:44.690
> 
> 标签：ruby-on-rails, rspec, cucumber, capybara

我使用 capybara/rspec 匹配器进行了一些测试来检查内容或链接。无论如何，我只是将它们更改为小写并使用 CSS 将第一个字母大写。现在所有测试都失败了，因为原始 html`post`虽然`Post`看起来像`Post`.

应用css后是否可以忽略大小写或检查文本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T14:27:56.863

Capybara 支持正则表达式：

```
find('a', :text => /post/i).click 
```

您可能需要使用`click_link`或`click_on`

[参考谷歌网上论坛](https://groups.google.com/forum/?fromgroups=#!topic/ruby-capybara/u5iZ6W1H_98)

# css - div 和 span 有什么区别？

> ID：13495007
> 
> 赞同：-5
> 
> 时间：2012-11-21T14:04:57.577
> 
> 标签：css, html

> **可能重复：**
> [HTML 标签 DIV 和 SPAN 有什么区别？](https://stackoverflow.com/questions/183532/what-is-the-difference-between-html-tags-div-and-span)
> [div和span的区别](https://stackoverflow.com/questions/9047939/difference-between-div-and-span)

很多人问我同样的问题，我不知道答案。`div`你能告诉我和有什么区别吗`span`？标签`html`？

**有什么区别？**
**是什么让他们与众不同？**

以及您认为对此更好的一些其他可能的答案。并且，请给出`code`这将使`span`工作成为`div`使用`css`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-21T14:06:06.247

`div`是块级元素，`span`是内联元素。这基本上就是它的要点。;)

详细说明; 元素的`div`默认样式是块级。这意味着它可以包含其他块级元素以及行内元素。元素的`span`默认样式是内联的，这意味着块级元素可以包含它，但不能包含块级元素。但是，这两者都可以使用 CSS 进行更改，因此您可以拥有内联`div`和块级`span`！

请记住，虽然您可以通过使`span`s 块和`div`s 内联来获得更好的内容布局，但如果您尝试在元素中包含块级元素，例如`span`，HTML 验证器可能会向您抛出错误，因为*技术上*这些元素不应该出现在那里。

“块级别”是指它是一个内容块，并迫使其他块出现在其下方。内嵌元素出现在内容块中，例如，您可以使用该`span`元素为块内的文本添加样式，并且不会使文本“脱节”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T14:06:26.827

Span 是内联元素，其中 div 是块元素。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T14:06:37.493

`div``display: block`默认情况下。默认情况下`span`。`display: inline`他们可能有不同的元素作为他们的孩子。它们可能是不同元素的子元素。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T14:06:34.203

首先，`div`标签是块级元素，`span`标签是内联元素。

[https://developer.mozilla.org/en-US/docs/HTML/Block-level_elements](https://developer.mozilla.org/en-US/docs/HTML/Block-level_elements)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-21T14:13:22.847

A`<span>`是一个`inline`元素，其中a`<div>`是一个`block`元素。我认为它们与不同的默认`display`样式基本相同。 `<div>`默认为`display: block`&`<span>`默认为`display: inline`.

我倾向于`<span>`只使用然后根据需要修改`display`样式。

# eclipse - Eclipse Juno CDT，链接特定的 .so

> ID：13495008
> 
> 赞同：0
> 
> 时间：2012-11-21T14:04:57.653
> 
> 标签：eclipse, shared-libraries, eclipse-cdt

我找不到将特定 .so 与 Eclipse CDT 链接的正确方法：我需要在 Ubuntu 上像 libGL.so.1.2.0 一样链接，并且在 CDT 项目中我必须省略前缀“lib”和后缀“.so”。

我怎样才能指定那种东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T14:57:14.003

某处可能会有一个 libGL.so 符号链接，所以使用 -lGL 应该可以做到。

# c# - 如何使用通配符删除字符串的特定部分？

> ID：13495009
> 
> 赞同：2
> 
> 时间：2012-11-21T14:05:02.617
> 
> 标签：c#, regex, string

目前，我使用：

变量：

```
 int recordCount = 5;
 Header = "Index"; // Can also be "Starting Index" 
```

标题：

```
 Header = Header.Split(' ')[0] + " (" + recordCount + ")"; 
```

变化：

```
 Index (5) 
```

至：

```
 Index (6) 
```

当我想用新的 Header 替换 Header 时，我使用上面的方法，但问题是当我开始在其中使用多个单词时，`Header`它会删除 Header Name 的其余部分。即当它说`Starting Index:`它只显示`Starting`。

我可以使用正则表达式来简单地查找括号之间的值并将其替换为另一个变量吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-21T14:11:40.053

```
Regex re = new Regex(@"\(\w+\)");
string input = "Starting Index: (12asd)";
string replacement = "12ddsa";
string result = re.Replace(input, replacement); 
```

如果您需要执行更复杂的替换（即，如果替换取决于大括号之间的捕获值），则必须坚持使用`Regex.Match`方法

更新：`Match`事情很快就会变得丑陋:)

```
 Regex re = new Regex(@"^(.*)\((\w+)\)\s*$");
 string input = "Starting Index: (12)";
 var match = re.Match(input);

 string target = match.Groups[2].Value;
 //string replacement = target + "!!!!"; // general string operation
 int autoincremented = Convert.ToInt32(target) + 1; // if you want to autoincrement

 string result = String.Format("{0}: ({1})", match.Groups[1].Value, autoincremented); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T15:00:51.193

如果您需要系统地替换其中的一些（并且算法需要原始值），请记住 Regex.Replace() 可以接受将返回替换值的方法。这是一个示例，它将增加括号中包含的所有整数：

```
string s1 = "Index (5) and another (45) and still one more (17)";

string regex = @"\((\d+)\)";

string replaced = Regex.Replace(s1,regex,m => "("+(Convert.ToInt32(m.Groups[1].Value)+1).ToString()+")");
// Result: Index (6) and another (46) and still one more (18) 
```

该方法接受一个正则表达式匹配对象并返回一个替换字符串。我在这里使用了 lambda 方法，但是您的正则表达式和替换方法都可以根据需要变得复杂。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T20:20:59.357

你也可以这样：

```
string sample = "Index (5) Starting Index(0) and Length (6)";
string content = Regex.Replace(sample, @"(?<=\()\d+(?=\))", m => (int.Parse(m.Value) + 1).ToString()); 
```

此模式将查找用圆括号括起来的任意数量的数字，并将推进到 1。

这里不需要附加额外的括号，因为它们在比赛期间没有被捕获。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T14:11:40.933

你可以使用这个模式

```
\[\((\d+)\).*?\] 
```

匹配括号之间的数字，然后您可以用您想要的任何数字替换该数字

```
var mg = Regex.Match( "Starting Index:(10)", @"\[\((\d+)\).*?\]");

if (mg.Success)
{
    var num = mg.Groups[1].Value; // num == 10
} 
```

在那之后

```
headerString = headerString.Replace("10", "11"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-21T14:16:36.210

`\((\d+)\)`这将更适合

并在这种情况下替换数字“asdq(wdq)wdqwd (12)”

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-21T14:23:27.067

```
int dynamicNumber = 6;

string pattern = string.Format("({0})", dynamicNumber);

string data = "My Header 6:";

Console.WriteLine (Regex.Replace(data,pattern, "!!!")); // My Header !!!: 
```

# javascript - 如何使用 JS 将内容添加到 html 正文？

> ID：13495010
> 
> 赞同：46
> 
> 时间：2012-11-21T14:05:08.093
> 
> 标签：javascript

`<section>`我的 html 中有很多内容，`<body>`想通过 javascript 添加更多内容。但是，使用`innerHTML`只是用新的部分替换我现有的部分，而不是将它们添加到旧的部分。

我还能用什么？

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2012-11-21T14:07:26.083

您可以使用

```
document.getElementById("parentID").appendChild(/*..your content created using DOM methods..*/) 
```

或者

```
document.getElementById("parentID").innerHTML+= "new content" 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2018-07-22T19:33:39.693

我刚刚遇到了一个类似于这个问题的解决方案，其中包含一些性能统计信息。

下面的示例似乎更快：

```
document.getElementById('container').insertAdjacentHTML('beforeend', '<div id="idChild"> content html </div>');
```

InnerHTML vs jQuery 1 vs appendChild vs innerAdjecentHTML。

[![在此处输入图像描述](../Images/c570656a264d9085b68afae7a955265c.png)](https://i.stack.imgur.com/BQnCC.jpg)

参考：1）[性能统计](https://jsperf.com/insert-html-to-div) 2）[API - insertAdjacentHTML](https://developer.mozilla.org/en-US/docs/Web/API/Element/insertAdjacentHTML)

我希望这将有所帮助。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2015-01-16T10:30:50.687

我认为如果您想直接将内容添加到正文中，最好的方法是：

```
document.body.innerHTML += "bla bla"; 
```

要替换它，请使用：

```
document.body.innerHTML = "bla bla"; 
```

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2017-08-03T11:28:41.257

尝试以下语法：

```
document.body.innerHTML += "<p>My new content</p>"; 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-11-21T14:11:35.783

你可能正在使用

```
document.getElementById('element').innerHTML = "New content" 
```

试试这个：

```
document.getElementById('element').innerHTML += "New content" 
```

或者，最好使用[DOM](http://docs.webplatform.org/wiki/tutorials/traversing_the_dom) [Manipulation](http://docs.webplatform.org/wiki/tutorials/creating_and_modifying_html#Creating_HTML)：

```
document.getElementById('element').appendChild(document.createElement("div")) 
```

与 using 相比，Dom 操作更受欢迎`innerHTML`，因为`innerHTML`只需将字符串转储到文档中。浏览器将不得不重新解析整个文档以获取它的结构。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2018-10-31T12:00:11.963

工作演示：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<title></title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<script type="text/javascript">
onload = function(){
var divg = document.createElement("div");
divg.appendChild(document.createTextNode("New DIV"));
document.body.appendChild(divg);
};
</script>
</head>
<body>

</body>
</html> 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-08-03T15:23:09.760

在大多数浏览器中，您可以使用 javascript 变量而不是使用`document.getElementById`. 假设您的 html 正文内容是这样的：

```
<section id="mySection"> Hello </section> 
```

然后你可以`mySection`在javascript中引用一个变量：

```
mySection.innerText += ', world'
// same as: document.getElementById('mySection').innerText += ', world' 
```

看到这个片段：

```
mySection.innerText += ', world!'
```

```
<section id="mySection"> Hello </section>
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-11-21T14:07:56.930

只是：

```
 document.getElementById('myDiv').innerHTMl += "New Content"; 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-04-13T20:15:52.470

你也可以这样做

```
document.querySelector("#yourid").append('<div>my element<div>'); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-08-28T05:11:06.617

```
document.querySelector('body').appendChild( //your content ) 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-03-21T18:32:08.357

最近，我遇到了同样的问题，但我想在正文内容的开头添加内容。所以我发现这个解决方案值得：`insertAdjecentHTML(positions, text)`在指定位置时使用。该位置可以是`'beforebegin'`, `'afterbegin'`, `'beforeend'`,`'afterend'`

```
const element = document.getElementById('my-id')

element.insertAdjacentHTML(position, text); 
```

# google-maps - 通过谷歌地图中的航路点获取到同一点的路线

> ID：13495012
> 
> 赞同：1
> 
> 时间：2012-11-21T14:05:13.487
> 
> 标签：google-maps, google-maps-api-3

嗨，我有一些位置和一个位置的中心。我想将中心位置设置为起点和终点。我有一些航路点，我想从原点开始，穿过航路点并再次返回原点。谁能帮我？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T20:41:45.367

您的目的地点必须是同一来源

```
 if (origem == null) {  // origem
                            var lat = document.getElementById("lat").value;
                            var lng = document.getElementById("lng").value;
                            event.LatLng = new google.maps.LatLng(lat, lng); 
                            origem = event.LatLng;
                            addMarkerOrigem(origem);

                    } else if (destino == null) {   // destino
                        var latD = document.getElementById("latInt").value;
                        var lngD = document.getElementById("lngInt").value;
                        event.LatLng = new google.maps.LatLng(latD, lngD);
                        destino = event.LatLng;
                        addMarkerOrigem(destino); 
```

后

```
 var request = {
                            origin: origem, //define a origem no paramentro do metodo route()
                            destination: origem,//define o destino no parametro do metodo route() 
                            waypoints: waypoints,
                            travelMode: mode, // o modo de gerar o caminho que vem mode = google.maps.DirectionsTravelMode.DRIVING;
                            optimizeWaypoints: true, // variavel true, optimiza o caminho, mostrará sempre o menor custo
                            provideRouteAlternatives: true //exibira rotas alternativas
                            //tem muitas outras propriedades opcionais, obrigatorias são apenas origin destination e travelMode.
                        };

                        directionsService.route(request, function(response, status) {//seta os parametros de requisição e resposta
                            if (status == google.maps.DirectionsStatus.OK) { // se as direções estiverem "OK" ele vai criar a rota
                                directionsDisplay.setDirections(response);
                            }
                        });

                        clearMarkers();
                        directionsVisible = true;
                    } 
```

vai 然后使用把这个potos的其他点放在source和destination之间的想法，而destination = source

origin: origem, //定义一个 origem no paramentro do metodo route() destination: origem,//define o destino no parametro do metodo route()

# visual-studio - 无法构建 Qt 应用程序

> ID：13495014
> 
> 赞同：1
> 
> 时间：2012-11-21T14:05:18.127
> 
> 标签：visual-studio, qt, include

我最近将 Qt 应用程序源代码移动到了一个新目录（为了上传到 perforce，它必须在我的工作区中）。不幸的是，现在当我尝试在 VS2008 中构建时出现构建错误（无论如何，VS2008 是我以前用来构建的）。

我确实有一些不起作用的相对路径，所以我修复了它们并使其成为绝对路径。但是，VS 编译器向我显示了这些错误：

```
Error   30  fatal error C1083: Cannot open include file: 'QtGui/QApplication': No such file or directory
Error   31  fatal error C1083: Cannot open include file: 'QMainWindow': No such file or directory
Error   32  fatal error C1083: Cannot open include file: 'QString': No such file or directory 
```

依此类推，适用于所有标准 Qt 头文件。我已经编辑了我的附加包含目录，那里应该不会再有问题了。我查看了我的 vcproj 文件......我完全不知道为什么会发生这种情况。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-07-07T16:35:34.143

您是否为您的 Qt 应用程序创建了 .pro 文件 如果没有，请转到菜单栏中的 Qt

1.  单击创建基本 .pro 文件（创建 .pro 文件并将其保存在项目的同一位置）
2.  之后，使用 Qt 菜单中的 Open Qt Project File(.pro) 打开创建的 .pro 文件。
3.  然后它会要求您替换现有的 .pro 文件并单击是，然后单击确定。

我认为问题将得到解决谢谢:)

# c++ - 中断 Visual Studio 2010 c++ 中的下一步操作

> ID：13495015
> 
> 赞同：0
> 
> 时间：2012-11-21T14:05:18.730
> 
> 标签：c++, visual-studio-2010, mfc

我有一个巨大的程序，我正在尝试在 VS2010 中调试它。我想说的是，一旦我激活此选项，就在第一个成功匹配的消息映射项上中断，无论它在代码中的什么位置。我不知道这是否可能，但这会非常有帮助，因为有太多的项目需要单独设置一个断点。我认为这将是有效的；停在代码库的下一行。

谢谢，詹姆斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T14:09:34.320

我认为您正在寻找的是`Condition`on a `Breakpoint`。右键单击`Breakpoint`，然后您可以添加一个`Condition`. 您可以控制是否`Breakpoint`在条件`Is true`或`Has changed`.

另一个有用的调试工具是“内存断点”。在`Breakpoints`窗口中，单击`New > New Data Breakpoint`并提供要监视的地址和大小，一旦对此内存进行更改，它将进入调试器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T14:37:33.150

另一种选择是在源代码中使用[DebugBreak函数。](http://msdn.microsoft.com/en-us/library/windows/desktop/ms679297%28v=vs.85%29.aspx)

# nightly-build - 针对多个目标框架版本 TFS 2012 构建解决方案

> ID：13495016
> 
> 赞同：0
> 
> 时间：2012-11-21T14:05:19.103
> 
> 标签：nightly-build

是否可以在 TFS 2012 的夜间构建中针对两个不同的目标框架版本构建相同的 C# 解决方案？

这样我们就可以针对 .NET 4.0 和 .NET 4.5 构建一个解决方案。如果我们保持代码与每个版本兼容，这应该是可能的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-06T00:25:49.963

查看此链接[如何从 MSBuild 定位多个版本的 .NET Framework？](https://stackoverflow.com/questions/2923181/how-to-target-multiple-versions-of-net-framework-from-msbuild). 我最近实施了同样的解决方案。我确定这与 TFS 最佳实践的兼容性如何。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T16:59:30.793

msbuild 任务允许您指定命令行参数。所以你可以使用 /p:TargetFramework=4.0 选项来实现编译。但是，由于您实际上是在编译同一个项目，因此您的第二次 msbuild 运行会覆盖从第一次生成的 dll，因为它们将具有相同的名称。这是您需要处理的事情。

# xml - xsl排序不排序？

> ID：13495018
> 
> 赞同：2
> 
> 时间：2012-11-21T14:05:33.067
> 
> 标签：xml, xslt

**讲师.xsl**

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:fo="http://www.w3.org/1999/XSL/Format">
    <xsl:output method="html" version="4.0"/>
        <xsl:template match="/">
            <html>
            <head>
                <title>Lecturer Information</title>
            </head>
            <body>  

                <table border="1">

                    <tr bgcolor="#9acd32">
                        <th>Name</th>
                        <th>Teaching</th>
                        <th>Research</th>
                    </tr>

                    <xsl:for-each select="lecturers/lecturer">
                        <tr>
                            <td>
                                <xsl:apply-templates select="name">
                                     <xsl:sort select="@last" data-type="text" order="descending"/>
                                </xsl:apply-templates>
                            </td>
                            <td><xsl:apply-templates select="teaching/course" /></td>
                            <td><xsl:value-of select="research"/></td>
                        </tr>
                    </xsl:for-each>

                </table>

            </body>
        </html>
    </xsl:template>

    <!-- Templates HERE -->
    <xsl:template match="name">
        <xsl:value-of select="@title"/><xsl:text> </xsl:text>
        <xsl:value-of select="@first"/><xsl:text> </xsl:text>
        <xsl:value-of select="@last"/>
    </xsl:template>

    <xsl:template match="teaching/course">
        <xsl:for-each select=".">
                <xsl:value-of select="concat(. , '(',@code, ')')"/>  <br />
            <!-- <xsl:value-of select="."/> (<xsl:value-of select="@code"/>) -->
        </xsl:for-each>
    </xsl:template>

</xsl:stylesheet> 
```

**讲师.xml**

```
<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="lecturer.xsl" ?>

<!DOCTYPE lecturers [

<!ELEMENT lecturers (lecturer+)>
<!ELEMENT lecturer (name, teaching, research)>

 <!-- Element name must contain attribute title, first and last -->
<!ELEMENT name (#PCDATA)>
<!ATTLIST name
  title CDATA #REQUIRED
  first CDATA #REQUIRED
  last CDATA #REQUIRED
>

<!-- Teaching can have more than one course-->
<!ELEMENT teaching (course+)>

<!ELEMENT course (#PCDATA)>
<!ATTLIST course
    code CDATA #REQUIRED
>

<!ELEMENT research (#PCDATA)>

]>
<lecturers>
    <lecturer>
        <name title="Professor" first="Peter" last="Quirk"/>
        <teaching>
                <course code="CO3070">XML and the Web</course>
                <course code="CO3300">Web Server Architectures</course>
        </teaching>
        <research>
                The application of Web protocols to Biology
        </research>
    </lecturer>
    <lecturer>
        <name title="Mr" last="Abdi" first="Ahmet"/>
        <teaching>
                <course code="CO1337">Ahmet's Course</course>
        </teaching>
        <research>
                The Best Research In the world.
        </research>
    </lecturer>
</lecturers> 
```

这部分 xsl 似乎没有排序

```
<xsl:sort select="@last" data-type="text" order="descending"/> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T14:30:07.337

我相信这条线

```
<xsl:sort select="name/@last" data-type="text" order="descending"/> 
```

需要在`for-each`声明下正确

```
<xsl:for-each select="lecturers/lecturer"> 
```

这应该按姓氏对所有讲师进行排序。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-21T14:31:25.130

您将`<xsl:sort>`元素作为 的子元素`<xsl:apply-templates select="name">`，但您不需要在那里进行任何排序，因为在给定的上下文中只有一个名称。

相反，您需要创建`<xsl:sort>`一个孩子`<xsl:for-each>`：

```
<xsl:sort select="name/@last" data-type="text" order="descending"/> 
```

确保按所示更改`select`属性，以便排序能够从`<lecturer>`元素的上下文中找到姓氏。

# c++ - 班上的朋友

> ID：13495021
> 
> 赞同：0
> 
> 时间：2012-11-21T14:05:40.320
> 
> 标签：c++, visual-c++

我有 2 个类：Budget 和 AuxiliaryOffice，我正在使用一个朋友功能：friend AuxiliaryOffice::addBudget(double,Budget &); 访问 Budget 的私人成员 corpDivision。

辅助.h

```
#ifndef AUXIL_H
#define AUXIL_H
class Budget;
class AuxiliaryOffice
{
private:
    double auxBudget;
public:
    AuxiliaryOffice(){auxBudget=0.0;}
    double getDivisionBudget()const{return auxBudget;}
    void addBudget(double b, Budget &);
};
#endif 
```

预算.h

```
#include"auxil.h"
#ifndef BUDGET_H
#define BUDGET_H
class Budget
{
private:
    static double corpDivision;
    double divisionBudget;
public:
    Budget(){divisionBudget=0.0;}
    void addBudget(double b){divisionBudget+=b; corpBudget+=b;}
    double getDivisionBudget()const{return divisioBudget;}
    double getCorpDivision()const{return corpDivision;}
    friend AuxiliaryOffice::addBudget(double,Budget &);
};
#endif 
```

辅助文件

```
#include"auxil.h"
#include"budget.h"

void AuxiliaryOffice::addBudget(double b, Budget& div)
{
    auxBudget+=b;
    **div.corpDivision+=b;** //this line it is the problem. 
} 
```

div.corpDivision+=b -> Budget::corpDivision 不可访问

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T14:41:21.410

经过一些尝试，它可以工作，但我必须纠正您示例中的一些问题：

```
class Budget;
class AuxiliaryOffice
{
private:
    double auxBudget;
public:
    // It would be a good idea to add spaces to your code to help other reading it
    AuxiliaryOffice() { auxBudget = 0.0; }
    double getDivisionBudget() const { return auxBudget; }
    void addBudget(double b, Budget &);
}; // so far, so good    

class Budget
{
private:
    static double corpDivision;
    double divisionBudget;
    double corpBudget; // ** this was missing **

public:
    Budget() { divisionBudget = 0.0; }
    void addBudget(double b) { divisionBudget += b; corpBudget+=b; }
    double getDivisionBudget() const { return divisionBudget; }
    double getCorpDivision() const { return corpDivision; }

    // ** note the "void" here, missing from your sample
    friend void AuxiliaryOffice::addBudget(double, Budget&);
};

// this is also required to compile properly, usually in a Budget.cpp file
double Budget::corpDivision; 
```

# matlab - matlab读取二进制文件

> ID：13495023
> 
> 赞同：0
> 
> 时间：2012-11-21T14:05:47.663
> 
> 标签：matlab, binary, fread

假设这很简单，但我就是做错了，可能是因为我不懂一些非常基本的东西。

我试图弄清楚如何将二进制文件读入由 7 个变量组成的 matlab，每个变量以 2 个字节（高位和低位）写入。第一个字节是 MSB 和其他 LSB。问题是我知道 fread 函数，但是当涉及多个变量时，我似乎从来不知道如何正确使用它（只是相同类型的数字向量很容易）所以如果你们中的一些人可以解释一下一两句话我会很感激的。

谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T14:10:38.997

我想您必须调用`fread`两次，逐次指定您使用的格式（大端或小端）。

```
 first = fread(fileID, 1, 'int16', 0 , 'b'); %big endian
 last =  fread(fileID, 7, 'int16', 0 , 'l'); %little endian 
```

您还必须具体说明所存储变量的*值类型*。您说您有 2 个字节的变量，`'int16'`例如，它们可以是 。考虑对具有 2 个字节的可能值类型的[fread引用。](http://www.mathworks.it/it/help/matlab/ref/fread.html)

# ruby-on-rails-3 - 带有 Postgres 的 Rails - 角色

> ID：13495027
> 
> 赞同：0
> 
> 时间：2012-11-21T14:06:01.567
> 
> 标签：ruby-on-rails-3, postgresql

我正在使用 PG 进行 Rails 开发。每次我创建一个新应用程序时，它都会创建一个默认的 database.yml 文件，该文件将“用户名”设置为应用程序的名称。我必须进入并将数据库的用户名更改为已经存在的用户名，或者在 PG 上创建该角色。如果可能的话，我想跳过这个。

有什么方法可以配置 PG 以允许来自任何角色的交互，尽管名称如此，所以我可以忽略这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T14:35:24.933

无法将 postgres 配置为允许使用默认身份验证方法与任何角色进行连接。

可能有一种方法可以将应用名称映射到数据库角色。从详细信息阅读此[http://www.postgresql.org/docs/current/static/auth-methods.html](http://www.postgresql.org/docs/current/static/auth-methods.html)以找到合适的身份验证方法。

# r - R中的随机森林（y中的空类和参数长度为0）

> ID：13495041
> 
> 赞同：14
> 
> 时间：2012-11-21T14:06:45.607
> 
> 标签：r, random-forest

我第一次与随机森林打交道，遇到了一些我无法弄清楚的问题。当我对所有数据集（大约 3000 行）运行分析时，我没有收到任何错误消息。但是当我对我的数据集的一个子集（大约 300 行）执行相同的分析时，我得到一个错误：

```
dataset <- read.csv("datasetNA.csv", sep=";", header=T)
names (dataset)
dataset2 <- dataset[complete.cases(dataset$response),]
library(randomForest)
dataset2 <- na.roughfix(dataset2)
data.rforest <- randomForest(dataset2$response ~ dataset2$predictorA + dataset2$predictorB+ dataset2$predictorC + dataset2$predictorD + dataset2$predictorE + dataset2$predictorF + dataset2$predictorG + dataset2$predictorH + dataset2$predictorI, data=dataset2, ntree=100, keep.forest=FALSE, importance=TRUE)

# subset of my original dataset:
groupA<-dataset2[dataset2$order=="groupA",]
data.rforest <- randomForest(groupA$response ~ groupA$predictorA + groupA$predictorB+ groupA$predictorC + groupA$predictorD + groupA$predictorE + groupA$predictorF + groupA$predictorG + groupA$predictorH + groupA$predictorI, data=groupA, ntree=100, keep.forest=FALSE, importance=TRUE)

Error in randomForest.default(m, y, ...) : Can't have empty classes in y. 
```

但是，我的响应变量没有任何空类。

相反，如果我这样写 randomForest`(a+b+c,y)`而不是`(y ~ a+b+c)`收到其他消息：

```
Error in if (n == 0) stop("data (x) has 0 rows") : 
  argument length zero
Warning messages:
1: In Ops.factor(groupA$responseA + groupA$responseB,  :
  + not meaningful for factors 
```

第二个问题是，当我尝试通过我估算我的数据时，`rfImpute()`我得到一个错误：

```
Errore in na.roughfix.default(x) :  roughfix can only deal with numeric data 
```

但是，我的列都是因子和数字。

有人能看出我哪里错了吗？？？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-11-21T16:02:53.860

根据评论中的讨论，这里是对潜在解决方案的猜测。

这里的混淆源于一个因素的水平是变量的一个属性。无论您从数据中获取什么子集，无论该子集有多小，这些级别都将保持不变。这是一项功能，而不是错误，并且是常见的混淆来源。

如果您想在子集时*删除*缺失的级别，请将您的子集操作包装在`droplevels()`：

```
groupA <- droplevels(dataset2[dataset2$order=="groupA",]) 
```

我可能还应该添加许多 R 用户`options(stringsAsFactors = FALSE)`在开始新会话时设置（例如在他们的 .Rprofile 文件中）以避免这些麻烦。这样做的缺点是，如果您经常与其他人共享您的代码，如果他们没有更改 R 的默认选项，这可能会导致问题。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-12-08T22:02:39.337

当通过子集删除因子水平时，您必须重置水平：

```
levels(train11$str);
[1] "B" "D" "E" "G" "H" "I" "O" "T" "X" "Y" "b";
train11$str <- factor(train11$str);
levels(train11$str);
[1] "B" "D" "E" "G" "H" "I" "O" "T" "b" 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-03-10T13:54:00.587

这是因为您在将数据发送到随机森林之前对您的训练集进行了子设置，而子设置有可能在子设置之后从响应变量中丢失一些级别，因此需要使用以下方法重新分配因子：

dataset2$response <- 因子（dataset2$response）

在子设置后删除数据中不存在的附加级别。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-07-02T09:21:54.203

在将其传递给 randomForest 之前尝试使用函数公式：

```
formula("y ~ a+b+c") 
```

这解决了我的问题。

或者，randomForest 可能会将一个参数误认为另一个参数。

尝试指定每个参数是什么：

```
randomForest(,,, data=my_data, mtry=my_mtry, etc) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-03-04T18:13:21.387

randomForest（x = 数据，y = 标签，重要性 = TRUE，ntree = 1000）

label 是一个因素，因此在传递给 randomForest 函数之前，请使用 droplevels(label) 删除计数为零的级别。有用。

要检查每个级别的计数，请使用 table(label) 函数。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-21T14:49:27.143

似乎调用语句中的问题。如果您使用公式接口，则调用

```
randomForest(response ~ predictorA + predictorB + ... + predictorI, data=groupA, ntree=100, keep.forest=FALSE, importance=TRUE) 
```

`x`但是显式传递和更方便快捷`y`

```
randomForest(y = groupA$response, x = groupA[,c("predictorA", "predictorB", ...)], ntree=100, keep.forest=FALSE, importance=TRUE) 
```

您可以使用它们的索引来代替变量的名称。试试这些建议。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-12-10T18:33:50.527

只是另一个建议添加到组合中：您可能不希望 read.csv() 将字符串解释为因素。尝试将此添加到 read.csv 以强制转换为字符：

```
dataset <- read.csv("datasetNA.csv", 
                    sep=";", 
                    header=T,
                    colClasses="character") 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2013-09-01T17:21:53.913

我今天和你有同样的问题，我已经解决了。当你做随机森林时，R 默认是分类，而我的响应是数字。当您使用子集作为训练数据集时，与测试相比，训练的水平受到限制。

# jms - jms 和 spring 集成的性能问题。以下配置有什么问题？

> ID：13495042
> 
> 赞同：1
> 
> 时间：2012-11-21T14:06:49.847
> 
> 标签：jms, activemq, messaging, spring-integration

我有一个 jms 生产者，它每秒生成许多消息，这些消息被发送到 amq 持久队列并由单个消费者消费，需要按顺序处理它们。但似乎生产者比消费者快得多，而且我遇到了性能和内存问题。消息的获取速度非常非常慢，并且消费似乎是间隔发生的（消费者以轮询方式“询问”消息，这很奇怪？！）

基本上，一切都发生在 spring 集成中。这是生产者端的配置。第一个质押消息进入stakesInMemoryChannel，从那里，它们被过滤并抛出filteredStakesChannel，然后它们从那里进入jms队列（使用执行器，因此发送将在单独的线程中发生）

```
 <bean id="stakesQueue" class="org.apache.activemq.command.ActiveMQQueue">
        <constructor-arg name="name" value="${jms.stakes.queue.name}" />
    </bean>

    <int:channel id="stakesInMemoryChannel" />

    <int:channel id="filteredStakesChannel" >
        <int:dispatcher task-executor="taskExecutor"/>
    </int:channel>

    <bean id="stakeFilterService" class="cayetano.games.stake.StakeFilterService"/>

    <int:filter 
       input-channel="stakesInMemoryChannel"
       output-channel="filteredStakesChannel" 
       throw-exception-on-rejection="false"
       expression="true"/>

    <jms:outbound-channel-adapter channel="filteredStakesChannel" destination="stakesQueue" delivery-persistent="true" explicit-qos-enabled="true"  />

    <task:executor id="taskExecutor" pool-size="100" /> 
```

另一个应用程序正在使用这样的消息......消息来自 jms stakesQueue 的 stakesInputChannel，之后它们被路由到 2 个单独的通道，一个保留消息，另一个做一些其他的事情，我们称之为“处理” .

```
 <bean id="stakesQueue" class="org.apache.activemq.command.ActiveMQQueue">
    <constructor-arg name="name" value="${jms.stakes.queue.name}" />
</bean>

<jms:message-driven-channel-adapter 
    channel="stakesInputChannel" 
    destination="stakesQueue" 
    acknowledge="auto"
    concurrent-consumers="1"
    max-concurrent-consumers="1"
    />
<int:publish-subscribe-channel id="stakesInputChannel" />
<int:channel id="persistStakesChannel" />
<int:channel id="processStakesChannel" />

<int:recipient-list-router 
        id="customRouter" 
        input-channel="stakesInputChannel" 
        timeout="3000" 
        ignore-send-failures="true" 
        apply-sequence="true"
        >
    <int:recipient channel="persistStakesChannel"/>
    <int:recipient channel="processStakesChannel"/>
</int:recipient-list-router> 

<bean id="prefetchPolicy" class="org.apache.activemq.ActiveMQPrefetchPolicy">
    <property name="queuePrefetch" value="${jms.broker.prefetch.policy}" />
</bean>

<bean id="connectionFactory" class="org.springframework.jms.connection.CachingConnectionFactory">
    <property name="targetConnectionFactory">
        <bean class="org.apache.activemq.ActiveMQConnectionFactory">
            <property name="brokerURL" value="${jms.broker.url}" />     
            <property name="prefetchPolicy" ref="prefetchPolicy" /> 
            <property name="optimizeAcknowledge" value="true" /> 
            <property name="useAsyncSend" value="true" />
        </bean>
    </property>
    <property name="sessionCacheSize" value="10"/>
    <property name="cacheProducers" value="false"/>
</bean> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T14:53:23.500

不确定您所说的“每隔一段时间（消费者以轮询方式“询问”消息，这很奇怪）”是什么意思。

容器线程可能“看起来”像是在轮询，但实际上并非如此；它们在 AMQ 客户端中阻塞，直到消息到达或超时；当超时时，它立即返回到 AMQ 接收（）。

这个配置看起来不错；对于一个线程，消耗率将直接取决于您在路由器下游所做的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-23T04:57:09.030

建议使用[PooledConnectionFactory](http://activemq.apache.org/maven/5.5.0/activemq-pool/apidocs/org/apache/activemq/pool/PooledConnectionFactory.html/ "池化连接工厂")。这建议与 Spring JmsTemplate 一起使用，它汇集了 Connection、Session 和 MessageProducer 实例，以便在它们不再使用后可以返回它们。

我相信您在消费者方面看到的“间隔”行为是消费者超时。

与 Gary Russel 所说的相反，`amq.receive()`它确实有效地轮询了队列。Spring 配置隐藏了这一点，但消息基本上是在一个循环中从队列中拉出，该循环调用队列消费者的接收。`receive()`队列的消费者在调用尝试获取消息之前无法知道消息是否在队列中。

这与主题相反，您在其中注册一个侦听器，该侦听器在消息进入时执行操作。主题是一个优雅的解决方案，因为您注册了一个处理消息的侦听器。

使用 Topic，您告诉 activemq 如何处理消息，使用 Queue，activemq 只是在您请求消息时给您消息。

# vb.net - vb.net 奇怪的扩展方法行为？

> ID：13495048
> 
> 赞同：5
> 
> 时间：2012-11-21T14:07:28.820
> 
> 标签：vb.net, extension-methods

这是我在 vb.net 中发现的一些我无法弄清楚的东西，我刚刚得到一个带有树视图的表单，然后是以下内容：

```
Private Sub Form1_Load(sender As System.Object, e As System.EventArgs) Handles MyBase.Load
    treeTest.Nodes.Add("a")
    treeTest.Nodes(0).Test()
End Sub 
```

测试是一种扩展方法：

```
Imports System.Runtime.CompilerServices
Public Module ExtModule
    <Extension()>
    Public Sub Test(ByRef node As TreeNode)
    End Sub
End Module 
```

如果我使用 ByRef 那么我的树视图看起来像：

![http://i.imgur.com/nQk0s.png](../Images/d09274117fba94a1dec2296f47cb6aac.png)

通过 ByVal 我得到：

![http://i.imgur.com/n2ZSf.png](../Images/8465a53b68bf299a0231e5ea0686f499.png)

这似乎完全倒退了，如果我只是发送一个参考，为什么节点会出现两次，而如果我制作一个副本，它只会出现一次？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-21T14:46:27.463

好的，我已经弄清楚*了*发生了什么。

它与扩展方法本身的关系相对较小。它更多的是关于 VB 如何处理`ByRef`一般情况，以及一些奇怪的行为`TreeView.Nodes`。

特别是，如果您更改此设置，您将获得*完全相同的行为：*

```
treeTest.Nodes(0).Test() 
```

至：

```
ExtModule.Test(treeTest.Nodes(0)) 
```

...即使您删除`ExtensionAttribute`.

下面是一些 C# 代码，它演示了相同的效果，`ref`根本不使用参数或扩展方法：

```
using System.Drawing;
using System.Windows.Forms;

class Test
{
    static void Main()
    {
        TreeView tree = new TreeView { Nodes = { "a" } };
        Form form = new Form { Controls = { tree } };
        form.Load += delegate {
            TreeNode node = tree.Nodes[0];
            tree.Nodes[0] = node;
        };
        Application.Run(form);
    }
} 
```

重要的几行是这些：

```
TreeNode node = tree.Nodes[0];
tree.Nodes[0] = node; 
```

当您的空扩展方法有一个`ByRef`参数时，您的代码相当于上面的 C# 代码 - 因为 VB`ByRef`通过使用临时变量然后分配回原始属性来伪造“真实”行为。

当你的空扩展方法有一个`ByVal`参数时，你的代码就相当于：

```
TreeNode node = tree.Nodes[0];
// Do nothing 
```

...这*不会*创建第二个节点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T15:09:43.593

我编译了一个小 VB 示例，并使用 Reflector 将其反编译为 C# 代码。这就是我得到的：

```
treeView.Nodes.Add("a");
TreeNodeCollection VB$t_ref$S0 = treeView.Nodes;
int VB$t_i4$S0 = 0;
TreeNode VB$t_ref$S1 = VB$t_ref$S0[VB$t_i4$S0];
ref VB$t_ref$S1.Test();
VB$t_ref$S0[VB$t_i4$S0] = VB$t_ref$S1; 
```

它不编译。因此我做了另一个测试

```
treeView1.Nodes.Add("a");
treeView1.Nodes[0] = treeView1.Nodes[0];
treeView1.Nodes[0] = treeView1.Nodes[0];
treeView1.Nodes[0] = treeView1.Nodes[0]; 
```

`Nodes`对集合的每个分配都会在视觉上复制节点；但是，节点数仍然存在`1`。这显然是行为的错误`TreeView`。

注意：显然 VB 允许通过引用扩展方法的第一个参数。这很尴尬，并且可能导致许多意想不到的行为。我的建议：不要`ByRef`在这里使用！

# .net - OperationVetoedException - 更新现有（唯一）文档时

> ID：13495051
> 
> 赞同：3
> 
> 时间：2012-11-21T14:07:41.580
> 
> 标签：.net, ravendb, unique-constraint

当我尝试更新 RavenDB 数据库中的文档时，我收到了 OperationVetoedException。

我的 RavenDB 和 UniqueConstraintsBundle 版本是 960（并且一直是，从未从任何以前的版本更新）。

我检查过，在数据库中找不到任何重复项。所以我不明白这个错误怎么可能发生。

下面我的代码示例中的列表 oldVisitorSessions 仅包含唯一对象。

**代码**

```
using (var session = _documentStore.OpenSession())
{
    foreach (var visitorSession in oldVisitorSessions)
    {
        visitorSession.ProspectType = string.Empty;
        session.Store(visitorSession);
    }

    session.SaveChanges();
} 
```

**例外**

```
Url: "/bulk_docs"
Raven.Database.Exceptions.OperationVetoedException: PUT vetoed by Raven.Bundles.UniqueConstraints.UniqueConstraintsPutTrigger because: Ensure unique constraint violated for fields: session_id
   at Raven.Database.DocumentDatabase.AssertPutOperationNotVetoed(String key, RavenJObject metadata, RavenJObject document, TransactionInformation transactionInformation) in c:\Builds\RavenDB-Stable\Raven.Database\DocumentDatabase.cs:line 522
   at Raven.Database.DocumentDatabase.<>c__DisplayClass37.<Put>b__30(IStorageActionsAccessor actions) in c:\Builds\RavenDB-Stable\Raven.Database\DocumentDatabase.cs:line 476
   at Raven.Storage.Esent.TransactionalStorage.Batch(Action`1 action) in c:\Builds\RavenDB-Stable\Raven.Storage.Esent\TransactionalStorage.cs:line 330
   at Raven.Database.DocumentDatabase.Put(String key, Nullable`1 etag, RavenJObject document, RavenJObject metadata, TransactionInformation transactionInformation) in c:\Builds\RavenDB-Stable\Raven.Database\DocumentDatabase.cs:line 468
   at Raven.Database.Extensions.CommandExtensions.Execute(ICommandData self, DocumentDatabase database) in c:\Builds\RavenDB-Stable\Raven.Database\Extensions\CommandExtensions.cs:line 25
   at Raven.Database.DocumentDatabase.<>c__DisplayClassca.<Batch>b__c6(IStorageActionsAccessor actions) in c:\Builds\RavenDB-Stable\Raven.Database\DocumentDatabase.cs:line 1196
   at Raven.Storage.Esent.TransactionalStorage.ExecuteBatch(Action`1 action) in c:\Builds\RavenDB-Stable\Raven.Storage.Esent\TransactionalStorage.cs:line 376
   at Raven.Storage.Esent.TransactionalStorage.Batch(Action`1 action) in c:\Builds\RavenDB-Stable\Raven.Storage.Esent\TransactionalStorage.cs:line 337
   at Raven.Database.DocumentDatabase.Batch(IEnumerable`1 commands) in c:\Builds\RavenDB-Stable\Raven.Database\DocumentDatabase.cs:line 1192
   at Raven.Database.Server.Responders.DocumentBatch.Batch(IHttpContext context) in c:\Builds\RavenDB-Stable\Raven.Database\Server\Responders\DocumentBatch.cs:line 94
   at Raven.Database.Server.Responders.DocumentBatch.Respond(IHttpContext context) in c:\Builds\RavenDB-Stable\Raven.Database\Server\Responders\DocumentBatch.cs:line 38
   at Raven.Database.Server.HttpServer.DispatchRequest(IHttpContext ctx) in c:\Builds\RavenDB-Stable\Raven.Database\Server\HttpServer.cs:line 550
   at Raven.Database.Server.HttpServer.HandleActualRequest(IHttpContext ctx) in c:\Builds\RavenDB-Stable\Raven.Database\Server\HttpServer.cs:line 316 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T09:22:37.827

请注意，您在“session_id”上有一个独特的约束失败，很可能您将其设置为 null，对吗？还有另一件事也是空的。

# jsf - Omnifaces 1.3 + Primefaces 3.4 + 会话超时

> ID：13495053
> 
> 赞同：1
> 
> 时间：2012-11-21T14:07:46.337
> 
> 标签：jsf, primefaces, glassfish, httpsession, omnifaces

我遇到了以下问题。我有一个使用 JSF (PrimeFaces 3.4) 和 Glassfish 的 Web 应用程序。当会话超时发生时，我正在尝试将用户重定向到登录页面。现在我已经阅读了很多关于此的内容，并尝试了很多解决方案。首先，我尝试编写一个没有结果的 ExceptionHandler。经过数小时的研究，我决定尝试 Omnifaces (1.3-SNAPSHOT) FullAjaxExceptionHandler。还是没有结果。

在调试时，我注意到处理程序工厂被正确调用，但 UnhandledExceptionQueue 对我来说总是空的。似乎没有抛出 ViewExpiredException （或任何其他类型的异常）。

症状总是一样的：发生会话超时后，服务器绝对没有响应。只有当我重新加载整个页面时，才会出现登录页面，表明会话不再有效。

请给我一些建议，非常感谢！

# html - 通过使用 Jquery 从一个 ul 拖动到另一个 ul 来添加 li

> ID：13495056
> 
> 赞同：0
> 
> 时间：2012-11-21T14:07:53.887
> 
> 标签：html, jquery-ui

通过从一个 ul 拖动到另一个 ul 来添加 li

例如

**第一个** `ul`清单项目：

*   1
*   2
*   3
*   4

**第二个** `ul`列表项：**空**

当 item`a`被拖放到 second`ul`时，必须将 item 添加到 second`ul`中。

限制第二项添加超过 2 项`ul`。

我使用了 jquery.ui 的[Sortable Widget](http://jqueryui.com/sortable/#connect-lists) (Categories: Interactions)

但不能实施添加不超过2 li 项的限制。

请帮我..

DndOptionDiv 是第一次潜水有选项 - 1 - 2 - 3 - 4 我正在尝试从**sortable1** ul 2 **DndFirstAns**和**DndSecondAns** ul添加选项

**css**

```
 .connectedSortable {
        background-color: seagreen;
        width: 150px;
    }
    .DndOptionDivCss {
        width:150px;
        float:left;

    }

    .DndFirstAnsDiv {
        width:150px;
        float:left;

    }

    .DndSecondAnsDiv {
        width:150px;
        float:left;

    }
    ul {
        border:dashed;
        border-width:1px;
    } 
```

**aspx 代码**---

```
 <div d="DndOptionDiv" class="DndOptionDivCss">
            <ul id="sortable1" >
                <li id="1" >1 </li>
                <li id="2" >2</li>
                <li id="3" >3</li>
                <li id="4" >4</li>
            </ul>
        </div>
        <div id="DndFirstAnsDiv" class="DndFirstAnsDiv">
            <ul id="DndFirstAns" >
                <li class="ui-draggable" >1st ans</li>
            </ul>
        </div>
        <div id="DndSecondAnsDiv" class="DndSecondAnsDiv">
            <ul id="DndSecondAns" >
                <li class="ui-draggable">2nd Ans</li>

        </div> 
```

脚本是

```
$(function () {
        $("#sortable1 li").draggable({
            revert: true,
            stop: function (event, ui) {
                $(ui.draggable).remove();
            }
        });

        $("#DndFirstAns").droppable({
            drop: function (event, ui) {
                $(this).find("p").html("Dropped!");//$(this).addClass("ui-state-highlight").find("p").html("Dropped!");
                toDrop = $(ui.draggable);
                //if ($("#queAnsOptions1").find("li[uniqueIdentity=" + toDrop.attr("uniqueIdentity") + "]").length <= 0)//for uniqueId
                //{

                $("#DndFirstAns").append(toDrop);
                //$(ui.draggable).remove();
                //}

            },

        });

        $("#DndSecondAns").droppable({
            drop: function (event, ui) {
                $(this).find("p").html("Dropped!");//$(this).addClass("ui-state-highlight").find("p").html("Dropped!");
                toDrop = $(ui.draggable);
                //if ($("#queAnsOptions1").find("li[uniqueIdentity=" + toDrop.attr("uniqueIdentity") + "]").length <= 0)//for uniqueId
                //{

                $("#DndSecondAns").append(toDrop);
                //$(ui.draggable).remove();
                //}

            },

        });
        $("#DndFirstAns li").click(function () {
            $(this).appendTo("#sortable1");
        });
        $("#DndSecondAns li").click(function () {
            $(this).appendTo("#sortable1");
        });
    }); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T21:05:14.000

从您提到的 jquery 示例中，希望这个小提琴可能会有所帮助，

[http://jsfiddle.net/T3n4u/](http://jsfiddle.net/T3n4u/)

它只是计算在“接收”事件中传输了多少项目，并且当两个项目被丢弃时，connectWith 属性被设置，并且第一个 ul.li 不可丢弃到第二个 ul

```
receive: function(event, ui){
        if(++count > 1)
            $("#sortable1").sortable("option", { connectWith: "" });
    } 
```

# ruby-on-rails - Rails：如何访问视图中的 belongs_to 字段？

> ID：13495061
> 
> 赞同：6
> 
> 时间：2012-11-21T14:08:15.133
> 
> 标签：ruby-on-rails, activerecord

鉴于下面的 MVC 结构，我该如何访问`:category`？我将它添加到列表中`attr_accessible`并重新启动了服务器，但调用`p.category`仍然没有返回任何内容。我相信你们 Rails 专家会知道发生了什么。提前致谢！

**模型**

```
class Product < ActiveRecord::Base
  belongs_to :category
  belongs_to :frame
  belongs_to :style
  belongs_to :lenses
  attr_accessible :description, :price
end 
```

**看法**

```
<% @product.each do |p| %>
<%= p.category %>
<% end %> 
```

**控制器**

```
def sunglass
  @product = Product.all
end 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-21T14:17:37.247

您需要指定`categories`要显示的表格的哪一列。例如，名为 的列`name`：

```
<% @product.each do |p| %>
 <%= p.category.name %>
<% end %> 
```

否则它将返回对象...换句话说，所有列`{id: 1, name: 'blabla', etc }`

还，

```
class Category < ActiveRecord::Base
   has_many :products
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T14:34:55.233

这个定义：

```
belongs_to :category 
```

只需为 Product 模型的每个对象定义一个表 Category 的引用点。例如，您的类别模型有一些列，例如：名称、类型、...

一个产品属于一个类别，而 Category 有很多产品。现在，您如何找到产品的类别名称？你不能这样写：

```
product.category # this is just reference to Category table 
```

你应该这样写：

```
product.category.name # this will get category's name which product belongs to 
```

如果要获取类别类型（示例）：

```
product.category.type 
```

# javascript - 简单的 d3.js 示例图表开始

> ID：13495070
> 
> 赞同：3
> 
> 时间：2012-11-21T14:08:40.407
> 
> 标签：javascript, canvas, charts, svg, d3.js

我浏览了 d3.js 网站上的所有图表示例，但它太复杂了，难以理解。我想要的只是绘制 x 轴和 y 轴并绘制一个 json 数据，如

```
{count:100,year:1999}
{count:240,year:2010}
{count:290,year:2009} 
```

在 x 轴上计数，在 y 轴上计数。任何人都可以提供一个简单的示例来开始。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T15:59:25.040

这两个沙箱有助于理解 d3 - [http://phrogz.net/js/d3-playground/#VerticalBars_HTML](http://phrogz.net/js/d3-playground/#VerticalBars_HTML)（尽管有些示例不再适用）和[http://enjalot.com](http://enjalot.com) - Tributary。

这是基于您的数据的条形图的开始：http: [//enjalot.com/inlet/4125640/](http://enjalot.com/inlet/4125640/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T14:19:54.193

这就是我与 nvd3 一起使用的

```
 [{values: 
              [{"value":3,"label":"17 hr"},
               {"value":2,"label":"18 hr"},
               {"value":1,"label":"19 hr"}]
    }]; 
```

这里 label 是 x 轴， value 是 y 轴

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T14:25:32.073

你看过[这个](http://mbostock.github.com/d3/tutorial/bar-1.html)教程吗？从基本图表到更复杂的 svg 示例，它似乎相当简单地分解它。一旦这些似乎有意义，您可以尝试用您的 JSON替换**数据变量并从那里开始。**

# java - Java - 在本地端口上侦听 RTP 数据包

> ID：13495071
> 
> 赞同：3
> 
> 时间：2012-11-21T14:08:51.610
> 
> 标签：java, sockets, rtp

所以我目前正在开发一个客户端应用程序，它在端口 5004 上侦听 RTP 数据包。由于可能有多个服务器发送 RTP 数据包，因此我无法使用套接字连接到特定的远程主机。相反，我尝试了以下方法来监听本地端口：

```
Socket socket = new Socket("127.0.0.1", 5004);
Socket socket = new Socket("localhost", 5004);
Socket socket = new Socket(InetAddress.getByName("localhost"), 5004);
Socket socket = new Socket(InetAddress.getLocalHost(), 5004); 
```

以上任何一项都会给我这个例外：

```
java.net.ConnectException: Connection refused: connect 
```

我也尝试过使用 DatagramSocket，但 DatagramPackets 要求我指定要读取的数据包的大小。

总而言之，我需要找到一种方法来在本地端口 5004 上侦听未知大小的 RTP 数据包，而无需连接到特定的远程主机/地址。任何帮助是极大的赞赏！

编辑：

我现在设置了一个 ServerSocket 来监听连接，但我仍然无法读取任何数据包。

```
try {   ServerSocket server = new ServerSocket(5004);
        Socket s = server.accept();
        BufferedReader rtpReader = new BufferedReader(new InputStreamReader(s.getInputStream()));
        while (true){
            int k = rtpReader.read();
            if (k == -1) break;
            System.out.println(k);
        }
} 
```

注意：RTP 数据包通过多播地址发送。

问题原来是多播。参考尼古拉的回答。非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T14:13:00.080

您需要创建一个新的[ServerSocket](http://docs.oracle.com/javase/1.4.2/docs/api/java/net/ServerSocket.html)类，然后使用 accept() 方法使用当有人连接到您的侦听服务器/端口时创建的 Socket。

```
ServerSocket server = new ServerSocket(5004);
Socket s = server.accept();
// You can now use the socket "s"... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T15:23:35.187

你必须使用[`java.net.MulticastSocket`](http://download.java.net/jdk7/archive/b123/docs/api/java/net/MulticastSocket.html)，并***加入多播组***。就像是：

```
// put your multicast address here
InetAddress group = InetAddress.getByName( "244.10.10.10" );
MulticastSocket sock = new MulticastSocket( 5004 );
sock.joinGroup( group );

byte[] buf = new byte[1472];
DatagramPacket pack = new DatagramPacket( buf, buf.length );

while ( whatever ) {
    sock.receive( pack );
    // handle data
}

sock.leaveGroup( group ); 
```

# c++ - linux中c/c++的加密库和压缩库

> ID：13495082
> 
> 赞同：-1
> 
> 时间：2012-11-21T14:09:44.260
> 
> 标签：c++, c, cryptography, compression

我需要一个可以在 linux 中使用对称密钥加密/解密文件的库。

我还需要一个库来压缩要加密的文件。我应该使用以下哪些库进行压缩？：gzip、zlib、libarchive、libtar。

这两个库都必须能够解密/解压缩到内存，因为我不想在硬盘上留下任何痕迹。

这可能可以通过受密码保护的存档来完成，尽管我不知道使用这两个库是否有任何优点/缺点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T19:23:57.697

好吧，以下是具体的 Ubuntu 软件包形式的具体建议：

*   `libmcrypt-dev`：可以处理十几种对称算法（AES/Rijndael，Blowfish...）
*   `zlib1g-dev`: gzip 是速度和大小之间的一种可能选择

# selenium - 使用 RemoteWebDriver 和 Selenium 的安全连接

> ID：13495083
> 
> 赞同：0
> 
> 时间：2012-11-21T14:09:49.037
> 
> 标签：selenium, webdriver

似乎在使用 Selenium RemoteWebDriver 时，所有以纯文本形式发送到 servlet 容器的命令在大多数情况下都不是问题，但我担心的是测试数据是以相同的方式发送的。即用户名和密码登录到网站的个性化区域待测。有没有人遇到过安全处理这些问题的要求，如果有，你是怎么做的。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-01T13:53:00.150

似乎实现这一目标的最佳方法是使用安全隧道，并发送 selenium 通过该隧道生成的所有 http 流量

# cakephp - CakePHP 基于 ACL 显示按钮

> ID：13495090
> 
> 赞同：0
> 
> 时间：2012-11-21T14:10:28.220
> 
> 标签：cakephp, acl, cakephp-2.2

我在 CakePHP 2.2.3 中的应用程序上有一个 ACL 系统设置。

我想知道在烘焙模型以仅向有权访问它的组自动显示命令（按钮）时如何制作蛋糕？

如果可能的话，我也需要一个有效的解决方案，因为我正在创建一个大型应用程序。

先感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T14:24:54.347

签出`MenuBuilder`以根据 ACL 设置定义和调用/构建预定义菜单。

[http://bakery.cakephp.org/articles/rifat/2011/05/08/menubuilder_v1_0_1](http://bakery.cakephp.org/articles/rifat/2011/05/08/menubuilder_v1_0_1)

我正在处理一个使用此设置交给我的项目。它似乎在 CakePHP 2.1.2 上开箱即用。但是，我必须覆盖部分 AuthComponent 才能使 HABTM 组/权限模型正常工作。

快速编辑：作者的 github 链接自该页面以获取最新信息。该页面和谷歌似乎有足够的支持来解决大多数问题。

# java - 使用动态映射语句检查 iBatis 中的 bean 是否为空

> ID：13495093
> 
> 赞同：0
> 
> 时间：2012-11-21T14:10:35.880
> 
> 标签：java, sql, database, ibatis

我想使用动态语句检查我用作参数的 bean 是否为空。

```
<select id="my-query" resultClass="my.package.Results" parameterClass="my.package.Bean">
     //MY QUERY
</select> 
```

有一种方法可以直接在查询中检查我的 bean 是否为空，或者我必须检查属性是否可用、空等？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T15:57:25.477

是的，你可以这样做：

```
<select ...>
SELECT * FROM RESULT 
<dynamic prepend="WHERE ">
   <isNull property="id">
      id IS NULL
   </isNull>
   <isNotNull property="id">
     id = #id#
   </isNotNull>
</dynamic>
</select> 
```

欢呼和快乐的编码！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-02T08:04:26.703

如果您提供的 bean 为空，则 Ibatis 在尝试对该 bean 调用 getId() 时抛出 NullpointerException。您必须确保 bean 在您的代码中事先不为空。

# macos - 在 Automator 中编辑文本

> ID：13495102
> 
> 赞同：3
> 
> 时间：2012-11-21T14:11:03.947
> 
> 标签：macos, automator

我想创建一个 Automator 服务，它可以获取选定的文本并将其替换为已编辑的版本。

IE

选定的文本将类似于“这是选定的文本”。

然后输出将采用该文本并输出类似...

“一些预定义的开头（这是选定的文本，这是选定的文本）”

我以前用文件名做过类似的事情，但 nr=ever 用实际文本。

有人可以指出我正确的方向吗？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-22T09:06:29.647

当您打开 Automator 时，选择服务作为您的文档类型。

使用运行 applescript 操作。

设置服务在任何应用程序勾选中接收选定的“文本”输出替换选定的文本。

将此代码示例放入 Run applescript Action 中：

```
 on run {input, parameters}

    set new_text to "this is selected text, " & input

    return new_text
end run 
```

节省。

通过选择文本并crtl+单击它以获取服务菜单来尝试一些文本。导航到您的服务。

# jquery - 如何在javascript中进行同步跨域调用

> ID：13495105
> 
> 赞同：2
> 
> 时间：2012-11-21T14:11:12.177
> 
> 标签：jquery, ajax, cross-domain

我正在做跨域调用。这需要更多时间（一些毫秒或 1 秒）。

所以下面的代码正在执行。

```
var xdr;
    if (window.XDomainRequest) // Check whether the browser supports XDR. 
    {
        xdr = new XDomainRequest(); // Create a new XDR object.
        if (xdr) {
            xdr.onload = function () {
                var data = $.parseJSON(xdr.responseText);
                AddData(data, link);
            };
            xdr.open("post", urlSearch);
            xdr.send();
        }
        else {
            alert('Server Error!! Try Later.');
        }
    }
    else {
         alert("Not IE 8");
     } 
```

我想做那个同步的。这样在调用完成后，下面的代码将执行

请帮忙

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T16:17:59.983

澄清一下，因为一些“JavaScript”程序员实际上往往是 jQuery 程序员（我怀疑他们甚至可以是这样，我说的是评论）。

回到主题。经过几分钟的谷歌搜索，似乎 XDomainRequest 对象**不**支持同步调用。

这实际上很好。您不知道的是，同步 AJAX（请注意，同步 AJAX 本身就是一个矛盾 - 第一个 A 代表 Asynchronous ）是浏览器**中万恶之源。**为什么？因为 JavaScript 是单线程的，所以当用户等待请求完成时，他**什么也做不**了——整个页面被阻塞（在某些更糟糕的情况下，我相信像 IE8 一样，整个浏览器都被阻塞）。

那你该怎么办？你应该做每个优秀的 JavaScript 程序员都会做的事情，并以异步方式编写代码。例如：

```
var xdr;
if (window.XDomainRequest) { // Check whether the browser supports XDR. 
    xdr = new XDomainRequest(); // Create a new XDR object.
    xdr.onload = function () {
        var data = $.parseJSON(xdr.responseText);
        AddData(data, link);
        // other code goes here
    };
    xdr.onerror = function () {
        alert('Server Error!! Try Later.');
    };
    xdr.open("post", urlSearch);
    xdr.send();
} else {
    alert("Not IE 8");
} 
```

如果您有更多依赖的代码`xdr`，那么只需将其添加到`onload`处理程序（您可以将其包装在单独的函数中以使其更易于阅读）。

# html - 元视口标签和 CSS 媒体查询

> ID：13495106
> 
> 赞同：1
> 
> 时间：2012-11-21T14:11:13.330
> 
> 标签：html, css, ipad, safari, viewport

我对与元视口标签一起使用的 CSS 媒体查询有疑问。我正在制作 iPad webapp，它将在主屏幕上的独立视图中工作。

这是CSS：

```
.header_portrait {

    position: relative;
    top: 0px;
    left: 0px;
    background: #ccc;
    width: 1536px;
    height: 219px;

}

.header_landscape {

    position: relative;
    top: 0px;
    left: 0px;
    background: #fff;
    width: 1536px;
    height: 219px;

}

@media only screen and (max-device-width: 1024px) and (orientation:portrait) { 
    .header_landscape { display: none; }
}
@media only screen and (max-device-width: 1024px) and (orientation:landscape) { 
    .header_portrait { display: none; }
} 
```

这是 HTML 的一部分`<head>`：

```
<meta id="viewport" name="viewport" content="user-scalable=0, width=device-width, height=device-height, initial-scale=0.5, maximum-scale=0.5" />
<meta name="apple-mobile-web-app-capable" content="yes"> 
```

这是 HTML 的一部分`<body>`：

```
<div class="header_portrait" ontouchmove="togle_touch('disable');">

</div>
<div class="header_landscape" ontouchmove="togle_touch('disable');">

</div> 
```

如果我从头部方向检测中删除元视口标签工作正常。似乎视口弄乱了 max-device-width ，因此 CSS 媒体查询没有按应有的方式检测到它。

任何帮助是极大的赞赏 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-01-26T14:27:27.400

（在评论或编辑中回答。请参阅[没有答案的问题，但问题在评论中解决（或在聊天中扩展）](https://meta.stackoverflow.com/questions/251597/question-with-no-answers-but-issue-solved-in-the-comments)）

OP写道：

> 我已经解决了这个问题！
> 
> 只需更换：

```
<meta id="viewport" name="viewport" content="user-scalable=0, width=device-width, height=device-height, initial-scale=0.5, maximum-scale=0.5" /> 
```

> 和：

```
<meta name="viewport" content="width=device-width, maximum-scale=0.5" /> 
```

> 它现在运行良好，在 iPad 3 中我必须在 iPad 1 和 2 中测试它......

# typescript - 有什么方法可以在打字稿中声明嵌套类结构？

> ID：13495107
> 
> 赞同：54
> 
> 时间：2012-11-21T14:11:15.020
> 
> 标签：typescript

我对定义现有框架 (openlayers.d.ts) 很感兴趣，但不知道如何表达 OpenLayers.Layer 既是类又是 OpenLayers.Layer.Markers 的命名空间这一事实。我相信这使 Markers 成为 Layer 的嵌套类。

用法：

```
l = new OpenLayers.Layer(...); // this is a base class, never do this
m = new OpenLayers.Layer.Markers(...); 
```

您将如何在 typescript 中同时声明 Layer 和 Markers 类？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2014-02-20T21:44:26.967

这似乎已在 0.9.1.1 及更高版本中修复。您只需创建一个与要嵌套类型的类同名的模块，然后将嵌套类型放入其中。

更具体地说，这就是你的做法：

```
declare module a
{
    class b
    {
    }

    module b
    {
        class c
        {
        }
    }
}

var myB = new a.b();
var myC = new a.b.c(); 
```

这在使用 export 关键字在打字稿代码中嵌套类型时也有效：

```
export module a
{
    export class b
    {
    }

    export module b
    {
        export enum c
        {
            C1 = 1,
            C2 = 2,
            C3 = 3,
        }
    }
} 
```

正如用户@recursive 在下面的评论中所提到的，声明的顺序很重要。因此类定义必须位于具有嵌套类型的模块之前。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2012-11-21T17:24:33.110

您可以使用命名空间/类合并来获得与嵌套类等效的效果。这个例子改编自 Pro TypeScript 的第 1 章。

您执行与类和命名空间或函数和命名空间的合并。

> 在所有情况下，命名空间必须出现在类或函数之后才能使合并工作。

改编的例子：

```
class Outer {

}

namespace Outer {
    export class Mid {

    }

    export module Mid {
        export class Inner {

        }
    }
}

var a = new Outer();
var b = new Outer.Mid();
var x = new Outer.Mid.Inner(); 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2016-02-17T02:17:04.273

截至 2016 年，我想这更容易：

```
class A {
    static B = class { }
}

var a = new A();
var b = new A.B(); 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-11-21T16:38:12.217

目前不支持嵌套类。

[http://typescript.codeplex.com/workitem/460](http://typescript.codeplex.com/workitem/460)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2013-07-03T23:12:06.093

这有点晚了，但其他人可能会发现它很有用。我就是这样骗TS来完成任务的。

```
declare module OpenLayers {
  interface Layer { 
   ....
  }

  interface Markers {
    ....
  }

  var Layer: {
    new(name:string, options?:any):Layer;
    prototype:Layer;
    Markers: { 
      new(params?:any):Markers;
      prototype: Markers;
    }
  }
}

var markers = new OpenLayers.Layer.Markers(); 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-04-14T09:18:10.187

为此使用 TypeScript 的*类表达式*：

```
var OpenLayers = class {
    static Layer = class {
        static Markers = class {}
    }
} 
```

# .net - 在运行 .NET Framework 2.0 的 Windows Server 2008 上安装 .NET Framework 4.5 是否安全？

> ID：13495110
> 
> 赞同：1
> 
> 时间：2012-11-21T14:11:30.917
> 
> 标签：.net, iis-7, windows-server-2008, .net-framework-version

我目前正在我的 Windows 2008 R2 服务器上运行 ASP.NET MVC2 Web 应用程序，我想将我的应用程序升级到 MVC4。这当然需要在服务器上安装更高版本的 .NET Framework。服务器是否能够处理 .NET Framework 的两个版本，IIS 7.0 是否能够处理更高版本的 .NET Framework？

是否可以在同一个 IIS 实例中运行一些使用 MVC2 和早期 .NET Framework 的网站以及一些 MCV4 应用程序？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T14:21:51.333

是的，.NET Framework 支持并行执行，这意味着安装多个版本不应相互影响。

*有关应用程序如何选择*其版本的所有详细信息和说明，请参阅： [.NET Framework 中的并行执行](http://msdn.microsoft.com/en-us/library/8477k21c.aspx ".NET Framework 中的并行执行")

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T14:16:15.627

是的。您可以并排安装任何和所有 .NET Framework 版本。

***这下一个可能没有必要，但它不会受到伤害：***

我在按顺序安装它们时取得了更好的成功。首先是 2.0，然后是 3.0，然后是 4.5，然后是 4.0。 ***同样，这应该不是必需***的，但是在安装它们时我遇到了一些愚蠢的错误，这些错误是通过卸载它们然后以正确的顺序重新安装来修复的。这可能只适用于 2.0 - 3.5，尽管因为 3.0 和 3.5 是附加安装 - 它们只是添加到 2.0 版本。4.0 更像是一个“真正的”不同的版本。

# javascript - 在 d3.js 中从 csv 创建层次结构

> ID：13495112
> 
> 赞同：8
> 
> 时间：2012-11-21T14:11:37.080
> 
> 标签：javascript, d3.js

我有一个包含以下数据的 csv：

```
world,country,state

World,US,CA

World,US,NJ

World,INDIA,OR

World,INDIA,AP

World,INDIA,TN 
```

我需要转换为树层次结构，如下所示：

```
{

    "name": "World",
    "children": [
      { "name": "US",
          "children": [
           { "name": "CA" },
           { "name": "NJ" }
         ]
      },
      { "name": "INDIA",
          "children": [
          { "name": "OR" },
          { "name": "TN" },
          { "name": "AP" }
         ]
      }
 ]
}; 
```

然后这棵树将用于树的可视化。有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-21T17:20:17.273

d3.nest 是你的朋友！

查看 D3 的 Nest 文档：[https ://github.com/d3/d3-collection/blob/master/README.md#nests](https://github.com/d3/d3-collection/blob/master/README.md#nests)

以下是我在学习使用 Nest 时写的一些示例：[https ://gist.github.com/3176159](https://gist.github.com/3176159)

这个问题也有帮助： [D3: use nest function to turn flat data with parent key into a hierarchy](https://stackoverflow.com/questions/11934862/d3-use-nest-function-to-turn-flat-data-with-parent-key-into-a-hierarchy)

# powershell - Powershell - 注销所有用户？

> ID：13495123
> 
> 赞同：0
> 
> 时间：2012-11-21T14:12:05.113
> 
> 标签：powershell, logoff

我以前使用[此处](http://poshcode.org/3285)找到的脚本来注销所有用户，但这不适用于某些版本的 Windows 7（特别是 Windows 7 家庭版。quser 可执行文件不存在）。

还有其他人对我如何注销所有用户有任何建议吗？我要尝试的另一种选择是：

```
(gwmi win32_operatingsystem -computername '.').Win32Shutdown(4) 
```

但这似乎只会注销当前用户（我想注销所有用户）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-12-09T19:26:19.043

看一下 WMI Win32_OperatingSystem 类的 Win32ShutdownTracker 方法。[https://msdn.microsoft.com/en-us/library/aa394057(v=vs.85).aspx](https://msdn.microsoft.com/en-us/library/aa394057(v=vs.85).aspx)

我在针对远程计算机的脚本中使用它，它会注销所有用户和/或重新启动计算机。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T07:18:27.460

我认为您可以将[psshutdown](http://technet.microsoft.com/en-us/sysinternals/bb897541.aspx)与 -o 参数一起使用

# eclipse - 在 Eclipse 中，如何选择垂直连续的文本框，就像在 Notepad++ 中使用 alt+drag 一样？

> ID：13495130
> 
> 赞同：3
> 
> 时间：2012-11-21T14:12:27.210
> 
> 标签：eclipse, notepad++

notepad++ 有一个很棒的功能，它允许您按连续的列选择文本。它非常有用，并且有可能在处理大型数据集时节省数小时。

Eclipse中有这样的功能吗？我不确定词汇表，所以如果它是一个执行相同工作的 Eclipse 插件，我不知道要搜索什么。

这是一个 Eclipse 问题，但我也使用 notepad++ 进行了标记，以防该阵营中熟悉 notepad++ 功能的人知道答案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T14:25:27.707

在我的 Eclipse (Helios) 中，“Alt+Shift+A”有效。它被标记为“切换块选择模式”。 ![在此处输入图像描述](../Images/ebdc18ef959bba5dc4e6ebc2d324b7a7.png)

# xml - 调试编码问题 (R XML)

> ID：13495133
> 
> 赞同：3
> 
> 时间：2012-11-21T14:12:46.420
> 
> 标签：xml, r, debugging, encoding, xml-parsing

有没有办法在 XML 文件中定位编码问题？我正在尝试使用in 中的库解析这样的文件（我们称之为`doc`），但编码似乎存在问题。`XML``R`

```
xmlInternalTreeParse(doc, asText=TRUE)
Error: Document labelled UTF-16 but has UTF-8 content.
Error: Input is not proper UTF-8, indicate encoding!
Error: Premature end of data in tag ... 
```

然后是带有可能过早结束数据的标签列表。但是，我很确定本文档中不存在过早的结束。

好的，接下来尝试：

```
doc <- iconv(doc, to="UTF-8")
doc <- sub("utf-16", "utf-8", doc)
xmlInternalTreeParse(doc, asText=T)
Error: Premature end of data in tag... 
```

又是一个标签列表和行号。我检查了线路，我找不到任何错误。

另一个怀疑：文档中出现的“µ”字符可能会导致错误。所以接下来尝试：

```
doc <- iconv(doc, to="UTF-8")
doc <- gsub("µ", "micro", doc)
doc <- sub("utf-16", "utf-8", doc)
xmlInternalTreeParse(doc, asText=T)
Error: Premature end of data in tag... 
```

还有其他调试建议吗？

*编辑：*花了两天时间尝试修复错误后，我仍然没有找到解决方案。但是，我想我已经缩小了可能的答案。这是我发现的：

*   将字符串从源数据库复制到文件中，并将其保存为Notepad++ --> 中`XML`的单独文件。`xml``Document labelled UTF-16 but has UTF-8 content`

*   在此文件中更改`<?xml version="1.0" encoding="utf-16"?>`为`<?xml version="1.0" encoding="utf-8"?>`（或`encoding="latin1"`）->**没有错误**

*   `XML`通过从数据库中读取字符串，使用or`doc <- sqlQuery(myconn, query.text, stringsAsFactors = FALSE); doc <- doc[1,1]`对其进行操作，然后尝试使用-->对其进行解析`str_sub(doc, 35, 36) <- "8"``str_sub(doc, 31, 36) <- "latin1"``xmlInternalTreeParse(doc)``Premature end of data in tag...`

*   如上所述从数据库中读取`XML`字符串，然后尝试使用`xmlInternalTreeParse(doc)`-->解析它`Document labelled UTF-16 but has UTF-8 content. Input is not proper UTF-8, indicate encoding ! Bytes: 0xE4 0x64 0x2E 0x20 Premature end of data in tag...`（标签列表如下）。

*   `XML`如上所述从数据库中读取字符串并使用`xmlInternalTreeParse(doc, encoding="latin1")`-->进行解析`Premature end of data in tag...`

*   在解析之前使用`doc <- iconv(doc[1,1], to="UTF-8")`or`to="latin1"`不会改变任何东西

我非常感谢任何建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-05T14:00:27.323

发生编码问题的原因是原始 XML 文件的编码与存储 XML 内容的 SQL 数据库中的编码`longtext`不匹配。替换 XML 字符串中的编码规范并转换此字符串解决了该问题：

```
doc <- sqlQuery(myconn, query.text, stringsAsFactors = FALSE)
doc <- iconv(doc[1,1], to="UTF-8")
doc <- sub("utf-16", "utf-8", doc)
doc <- xmlInternalTreeParse(doc, asText = TRUE) 
```

在从数据库检索期间截断 XML 字符串原来是一个单独的问题。此处提供了解决方案：[如何使用 R 从 SQL 数据库中检索很长的 XML 字符串？](https://stackoverflow.com/questions/13525539/how-to-retrieve-a-very-long-xml-string-from-an-sql-database-with-r?lq=1)

# python - Mac 10.6.8 上的 postgres 安装错误

> ID：13495135
> 
> 赞同：1
> 
> 时间：2012-11-21T14:12:48.887
> 
> 标签：python, django, postgresql

我是 web 开发的新手，我正在尝试设置我的 mac 来做 Django 教程并帮助一些开发人员完成一个使用 postgres 的项目。我会尽量详细说明我的问题。但是，这个问题似乎有很多浮动部分，我不太了解 SQL Shell、虚拟环境、路径、数据库、终端之间的连接的某些部分（这似乎是在此上运行所必需的）网络开发项目）。我将详细说明我所做的以及出现的错误消息。如果您可以帮助我处理错误消息或简单地发布教程链接以帮助我更好地了解这些浮动部件如何协同工作，我将非常感激。

我安装了 postgres 和 pgAdmin III 并将其设置在默认端口上。我创建了一个测试数据库。现在，当我尝试在本地服务器上打开它时，我收到一条错误消息：'错误：列“datconfig”不存在 LINE1:...b.dattablespace AS spcoid，spcname，datallowconn，dataconfig，...

这是我在关闭 pgAdmin 然后重新打开它之前所做的： 安装：安装程序告诉我在 /Library/PostgreSQL/9.2/data set 找到了一个现有数据目录以使用端口 5433。我加载了一个 .sql 文件，我想测试（我把它保存在我的桌面上并从那里加载到数据库中）。

我不确定这是否与问题有关，但我在文件夹 ~/Sites/django_test 中也有虚拟环境（即，当我告诉 bash 终端“激活”这个文件夹时，它把我放在一个（环境））。

我在一个论坛上读到，我需要通过在 bash 终端命令行运行“python manage.py runserver”来完成 Django 教程。当我这样做时，我收到一条错误消息，说“无法打开文件 'manage.py ': [Errno 2] No such file or directory”。即使我在 (env) 中运行命令，我也会收到错误消息：/Library/Frameworks/Python.framework/Versions/3.2/Resources/Python.app/内容/MacOS/Python：无法打开文件“manage.py”：[Errno 2] 没有这样的文件或目录（我想这告诉我该路径仍然设置在错误版本的 Python（3.2）上，即使虽然我想使用 2.7 版并从我的系统中删除了 3.2 版。）

我认为在这里我的理解存在一些差距：

*   我不明白在我的 bash 终端和我的 SQL shell 中输入命令之间的区别
*   运行“python manage.py runserver”是否与使用 IDLE 之类的 IDE 运行 Python 程序相同？
*   如何以及在哪里调整您的 $PATH 环境变量，以便正确的 python 首先出现在路径上？
*   我认为我使用 pip install 将正确的 Python 版本安装到了虚拟环境中。为什么我仍然收到“没有这样的文件或目录”错误？
*   为什么 Python 3.2 版仍然出现在我的错误消息指示的路径中是我已丢弃它？

如果您可以帮助我解决这些问题，或者简单地列出任何解释此问题的教程的链接，那将不胜感激。再次，抱歉没有更具体。但我认为列出我在这些不同部分而不是仅仅一个部分中遇到的问题会更有帮助，因为它们的相互关联性似乎导致了错误消息。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T14:36:56.117

1.  呃，不知道我们可以如何帮助你。一个用于 bash，一个用于 SQL。

2.  不，这是为了运行开发网络服务器，正如教程所解释的那样。

3.  没有必要这样做，这就是 virtualenv 的用途。

4.  这与 Python 版本无关，您似乎根本不在正确的目录中。请注意，正如教程所解释`manage.py`的那样，在您运行`django-admin.py startproject myprojectname`. 你这样做了吗？

5.  您大概使用 3.2 创建了 virtualenv。删除它并使用 2.7 重新创建它。

您不应该“在论坛中阅读”如何学习 Django 教程。你应该只是按照教程。

# vhdl - 画圆vhdl

> ID：13495140
> 
> 赞同：3
> 
> 时间：2012-11-21T14:13:05.220
> 
> 标签：vhdl, fpga

如何在 VHDL 中画圆？有 [我的 BDF 设计](http://oi48.tinypic.com/o7kfts.jpg)

母猪，我需要画一个红色的圆圈~ 100 px 的半径。我想我应该使用一些向量，但是如何？

```
entity VGAFrameTest is
port(   yrow, xcolumn : in unsigned(9 downto 0); -- row and  column number of VGA video
        VGA_CLK : in std_logic;                -- pixel clock
        VGA_R, VGA_G, VGA_B: out std_logic_vector(9 downto 0)); --  color information
end;

architecture rtl of VGAFrameTest is
constant COLOR_ON : std_logic_vector(9 downto 0) := (others=>'1'); 
constant COLOR_OFF : std_logic_vector(9 downto 0) := (others=>'0');
constant ROW_HEIGHT : integer := 480; -- number of visible rows 
```

> ```
> -- A test of visible range is recommended
> -- VGA 640x480@60Hz resolution is not natural for LCD monitors
> -- They support it but some monitors do not display all columns
> -- 1 or 2 last columns can be missing 
> ```

```
constant COLUMN_WIDTH : integer := 640 -1 ; -- number of visible columns - correction

begin
  frame:process(VGA_CLK)
  begin
  if rising_edge(VGA_CLK) then
        VGA_R<=COLOR_ON;VGA_G<=COLOR_ON;VGA_B<=COLOR_ON; --initilize  color to white  
        if (yrow = 240 and xcolumn = 320) then
          VGA_B<=COLOR_OFF; VGA_G<=COLOR_OFF; 
        elsif yrow = 1 or yrow = ROW_HEIGHT-2 or xcolumn=1 or xcolumn = COLUMN_WIDTH-2 then
          VGA_R<=COLOR_OFF; VGA_G<=COLOR_OFF; VGA_B<=COLOR_OFF; -- black frame
        elsif yrow = ROW_HEIGHT-1 then        
          VGA_B<=COLOR_OFF; VGA_G<=COLOR_OFF; --last  column is red
        end if;  
 end if;    
 end process;

end; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T12:24:30.740

一种方法是一些变体，`X**2 + Y**2 = R**2;` 例如`Y = Sqrt(R**2 - X**2)`

高效实现的诀窍是避免像 sqrt 这样昂贵的操作，并尽量减少（稍微）昂贵的乘法。

您可以猜测 Y，（从您知道 Y 为 0 的地方开始），将其平方并与每个新 X 的 R* *2 - X* *2 进行比较，当错误太多时修改您的猜测。Martin 的搜索词在这里会很有帮助。

将原点 (0,0) 设置在屏幕上正确位置的坐标变换相对容易。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-24T18:20:04.970

您可以通过将 157696 更改为 (160000 - r^2) 来设置任何半径

480 和 640 是圆心乘以 2

```
 begin
      frame:process(VGA_CLK)
      begin
      if rising_edge(VGA_CLK) then 
      VGA_R<=COLOR_OFF;VGA_G<=COLOR_OFF;VGA_B<=COLOR_OFF;
            if yrow>159 and yrow <320 and xcolumn < 440  and xcolumn > 199  then 
              VGA_B<=COLOR_ON; VGA_G<=COLOR_ON;VGA_R<=COLOR_ON;   

               if  (480*yrow-yrow*yrow+640*xcolumn-xcolumn*xcolumn )> 157696   then
              VGA_B<="0001001100"; VGA_G<=COLOR_OFF; VGA_R <= "1011111000";  
             end if;
            end if;  

 end if;    
 end process; 
```

# matlab - 图像调整大小和裁剪的顺序是否重要？

> ID：13495142
> 
> 赞同：0
> 
> 时间：2012-11-21T14:13:13.357
> 
> 标签：matlab, resize, machine-learning, computer-vision, crop

我有一些不同尺寸的图像。我也有裁剪后的图像和尺寸，它们被裁剪的地方。现在，我想要大小为 x*y 的新裁剪图像。它的面积可以比之前裁剪的图像多一点或少一点。我应该调整原始图像的大小然后裁剪以避免边界上的伪影吗？如果是，我应该调整原始图像的大小，然后裁剪什么大小？应保留纵横比。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T15:30:01.460

一般来说，更少的步骤将提供更好的结果。在许多情况下，特别是增加尺寸不会很好。

但是，这只是理论上的，可能根本看不到质量上的差异。找出你的情况如何的最好方法就是像@slayton提到的那样尝试它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T10:28:52.230

为什么要重新调整大小或裁剪它们！？如果你这样做增加了一些例子。在不影响质量的情况下获得更多正面示例的一个好方法是在垂直轴上镜像您的训练图像（这样左上角将变成右上角）。镜像示例与原始示例不同，但发生的可能性相同，因此镜像是生成新数据的好方法。

以及您使用哪种算法！？如果您使用 LDA，LDA 需要固定长度的特征，大多数优化和机器学习方法也是如此。

# macos - Applescript 在文本编辑文件的表格单元格中添加图像

> ID：13495148
> 
> 赞同：0
> 
> 时间：2012-11-21T14:13:21.863
> 
> 标签：macos, applescript, textedit

我是mac开发的新手。我想通过applescript在textedit文件的表格单元格中添加图像。我不知道该怎么做。

告诉应用程序“TextEdit”打开文件“用户：开发者：桌面：test.rtfd”结束告诉

谁能帮我。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T16:21:48.720

```
I dont have any idea how to do it. 
```

每个应用程序都有自己的 applescript 命令。您必须查看应用程序的 applescript 字典才能找到它可以做什么。因此，您的第一个操作应该是查看 TextEdit 的字典，看看是否有任何您想要执行的命令。为此，请打开 AppleScript 编辑器。在文件菜单下选择“打开字典”并选择文本编辑。您可以浏览字典或使用搜索字段。这是你应该开始的地方。

我也不知道如何做你想做的事，但我会从字典开始，然后也使用谷歌。祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T15:54:33.613

假设您没有将所有内容都放在脚本中的一行，那么我认为它不起作用的原因是完整路径名应该包含硬盘驱动器的名称。

```
tell application "TextEdit"
    open "Name of hard drive:Users:developer:desktop:test.rtfd"
end tell 
```

# objective-c - 将视图控制器与 iOS 中的视图分开是否有意义？

> ID：13495151
> 
> 赞同：5
> 
> 时间：2012-11-21T14:13:33.073
> 
> 标签：objective-c, ios, project-layout

来自 web 开发背景，主要做基于 MVC 的应用程序，我习惯于将代码的组件分成三组文件：控制器、模型和视图。

但是在 iOS 应用程序中，即使也使用 MVC 模式，遵循相同的技术是否有意义？

An`UIViewController`为您提供了一个默认视图，您可以在其中添加其余的子视图 ( `UILabel`, `UIButton`,...) 并立即访问它们。而且语言是一样的，不需要处理 HTML/CSS 和其他东西。

但是我遇到了一些 iOS 应用程序，其中 an`UIView`被子类化并维护在一个单独的文件中，即使它只用于`UIViewController`. 因此，您必须编写自定义访问器来处理内部子视图。

我认为没有必要这样做，除非您`UIView`在多个地方重复使用相同的内容或进行自定义绘图。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T16:03:43.750

诚然，我们中的许多人会稍微模糊 MVC 线条，并将少量与视图相关的代码放入我们的控制器中。我个人认为这很好。这并没有削弱我们仍然在很大程度上遵循 MVC 模式的事实（并且 Cocoa 类正在为视图做繁重的工作）。但是，对我来说，如果与视图相关的代码超出了琐碎的范围，我发现自己选择子类化视图。

会有人在宗教上分等级`UIView`，但我认为有一点实用主义是有道理的。如果您要添加少量与视图相关的代码，是否通过将其抽象为新的`UIView`子类来提高代码的易读性？不总是。但我认为这种情况（有人在他们可能不需要子类时进行子类化）远不如相反的问题（有人在他们可能应该有子类时未能子类化）常见。

所以，你问：

> 我认为没有必要这样做 [子类化 UIView]，除非您在多个地方重用相同的 UIView 或进行自定义绘图。

我同意重用和自定义绘图（例如`drawRect`）是两个很好的例子。但我还要添加一个原则，如果子类化会提高代码的易读性，因为视图足够复杂（当然是主观调用），那么我将子类化。两个例子：

1.  我在应用程序中有一个日历视图，视图控制器变得笨拙，管理一个月中不同日子的所有单元格，等等。所以通过子类化`UIView`，我能够抽象出所有子视图的丑陋细节由日历视图组成。我不仅对主要的“月”视图进行了子分类，还对“月”视图中的“日”视图进行了分类。*本身*没有重用。没有自定义图纸。但这显然是正确的做法。代码更加清晰易读。

2.  我越来越多地`UITableViewCell`为我的表格视图子类化。在我的第一个项目中，我会让表格视图控制器`cellForRowAtIndexPath`完成该单元格的所有复杂组合和布局。现在我的代码更容易理解了，因为`UITableViewCell`在我不使用其中一种标准单元格类型的任何情况下，我都会例行地将其子类化。

简而言之，虽然我同意不应该被迫`UIView`为每个视图控制器子类化 a，但我个人尝试在视图达到一定复杂程度时这样做。我让代码易读性支配我的实践。我发现我比以前更多地对视图进行子类化，但绝不是我一直都在这样做。

归根结底，虽然您不需要一直对视图进行子类化，但我个人认为许多开发人员在应该有子类化视图（或模型）时犯了错。他们不应该出于某种符合 MVC 的狂热愿望而这样做，而是他们应该问自己，如果他们适当地对视图或模型进行子类化，他们的代码是否更易于阅读和维护。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T14:21:39.897

通常，我会有一个`UIViewController`<=> SingletonManager <=> 实际数据源。我更喜欢把事情分开。如果我碰巧有一个 custom `UIView`，我在其中进行自己的自定义绘图，我将为此创建一个不同的文件，因为它是有意义的。即使我只在一个地方使用（你永远不知道明天需要什么，而且你可能碰巧在其他地方需要它）。也不要忘记你实际上已经在 iOS 中很好地分离了 MVC：

*   NIBS/故事板/自定义绘图
*   UIViewControllers
*   数据源

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T14:25:23.073

当您处理 iPhone 和 iOS 上的同一应用程序之间的差异时，这可能是一个很好的模式。iPad 上的 DetailViewController 可能是 iPhone 上的 UINavigationController。

另一个常见的模式是控制器与 DataSource 耦合，而视图与 DataSource 无关，并且可以在多个控制器中重用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T14:39:11.313

视图不在视图控制器中，它们要么在单独的类中，要么在视图控制器加载的 nib 文件中，视图控制器是为该视图编写的，因此它将所有操作和出口连接到该视图。

现在，如果您询问使用 nib 或子类，在组合和继承之间进行选择是一样的。

如果你需要一个特殊的视图，子类化 UIView，但是如果你想拥有一个带有控件作为子视图的视图，使用组合并且使用 Interface Builder 来组合你的视图更容易。

我看到只有子视图的 UIView 子类的唯一原因是为了更好的封装，但是因为您的控制器是专门为视图编写的，所以不需要这种封装。

# c# - 使用本机 C# API 管理我的 Azure 云服务？

> ID：13495152
> 
> 赞同：11
> 
> 时间：2012-11-21T14:13:34.487
> 
> 标签：c#, api, rest, azure

我想以编程方式管理我的 Azure 云服务。

我知道 REST API，但我想知道它是否是可用的本机 C# API，就像 Azure 存储一样。

REST API - 托管服务上的操作：http: [//msdn.microsoft.com/en-us/library/windowsazure/ee460812.aspx](http://msdn.microsoft.com/en-us/library/windowsazure/ee460812.aspx)

还是我需要自己包装 REST API，如下文所述？

Azure - 无法以编程方式执行 VIP 交换：[Azure - 无法以编程方式执行 VIP 交换](https://stackoverflow.com/questions/8460305/azure-cannot-programmatically-perform-vip-swap)

谢谢。

* * *

**编辑：**

CSManage 的建议对我帮助很大。

您可以重用 ServiceManagement 项目并编写自己的客户端（而不是 CSManage）。

使用 ServiceManagementHelper 设置一个通道来执行命令。

例子：

```
 public static string SubscriptionId { get; set; }
    public static string CertificateThumbprint { get; set; }

    public static X509Certificate2 Certificate { get; set; }

    private void button1_Click(object sender, EventArgs e)
    {
        SubscriptionId = ConfigurationManager.AppSettings["SubscriptionId"];
        CertificateThumbprint = ConfigurationManager.AppSettings["CertificateThumbprint"];

        X509Store certificateStore = new X509Store(StoreName.My, StoreLocation.CurrentUser);
        certificateStore.Open(OpenFlags.ReadOnly);
        X509Certificate2Collection certs = certificateStore.Certificates.Find(X509FindType.FindByThumbprint, CertificateThumbprint, false);
        if (certs.Count != 1)
        {
            MessageBox.Show("Client certificate cannot be found. Please check the config file. ");
            return;
        }
        Certificate = certs[0];

        // List Hosted Services
        var channel = ServiceManagementHelper.CreateServiceManagementChannel("WindowsAzureEndPoint", Certificate);
        var lhs = channel.ListHostedServices(SubscriptionId);
        foreach (HostedService hs in lhs)
        {
            MessageBox.Show(hs.ServiceName);
        }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-08-14T08:06:12.473

截至 2013 年 10 月，有一组 C# 库封装了 Windows Azure 服务管理 REST API。

[它在包名称Microsoft.WindowsAzure.Management.Libraries](http://www.nuget.org/packages/microsoft.windowsazure.management.libraries)下的 nuget 中可用。

[此处](http://www.bradygaster.com/post/getting-started-with-the-windows-azure-management-libraries)和[此处](http://www.jeff.wilcox.name/2014/04/wamlmaml/)的博客文章提供了一些概述，文档可以在[MSDN](http://msdn.microsoft.com/en-us/library/azure/ee460799.aspx)上找到。

正如问题所问，这些库允许您管理服务（创建部署、扩展部署、执行 vip 交换等），而不是与 blob/表存储交互。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-24T12:26:34.603

您还可以查看[Azure Fluent 管理库](http://nuget.org/packages/Elastacloud.AzureManagement.Fluent)。有一个 NuGet 包可用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T14:29:05.687

我有一个非常相似的要求，不幸的是没有包装器可以让你做到这一点，另一个答案中提到的只有表/blob/队列支持。

但是有一个名为 csmanage 的巧妙解决方案，它是一个命令提示应用程序，它在后台使用 REST API，让您可以管理 Azure 上的几乎所有内容；您可以查看源代码并了解它是如何完成的以及如何自己实现它。

[链接到 MSDN 上的 CSManage](http://code.msdn.microsoft.com/windowsazure/Windows-Azure-CSManage-e3f1882c)

*警告*：掌握应用程序的流程是一项艰巨的任务，但是一旦开始，它就会变得更容易。

提示：看看`CSManageCommand.cs`第 104 行是魔法开始发生的地方，他们使用 WCF 与 API 进行通信，您可以在`app.config`.

如果您正在寻找使用某些已知命令，您可以看到它们出现在以下类中：

![在此处输入图像描述](../Images/dd024b1381071f54e5a1b932fcf9458f.png)

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-11-21T14:16:27.323

是的，有一个适用于 C# 和 .NET 的 Windows Azure API。

[你可以在这里](http://www.windowsazure.com/en-us/develop/net/)找到他们的 Github 页面和[这里](https://github.com/WindowsAzure/azure-sdk-for-net)的文档。

# php - 使用 mysql 和计数请求时出现问题

> ID：13495153
> 
> 赞同：0
> 
> 时间：2012-11-21T14:13:35.110
> 
> 标签：php, mysql, sql

我在使用 mysql 时遇到了一些麻烦，事实上我有一个这样的表格：

```
n_doss   etat     date       etc...
-----------------------------------
145        N      20/10
145        EC     15/10
146        N      25/10 
```

我想做的是让每个`etat`人计算我有多少文件夹（文件夹由 标识`n_doss`）。

问题是最后一个`etat`重要的是每个文件的最新文件。

所以我必须为每个文件计算`etat`我有多少文件，但我不能`etat`为每个文件计算每个文件，而只能计算`n_doss`最近的文件。

我已经尝试了几乎所有方法，但我无法在此查询中成功。

我试过了：

```
SELECT  `etat` , `n_doss`, COUNT(  'etat' ) 
FROM  `commentaire` WHERE  
GROUP BY  `etat` 
```

这不适用于我尝试做的事情。

我也试过

```
SELECT `etat` , `n_doss`, COUNT(  'etat' ) 
FROM  `commentaire`   
GROUP BY  `n_doss`
HAVING max(date) with 
```

没有成功。任何形式的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T14:22:23.577

```
SELECT  a.*, c.totalCOunt
FROM    commentaire a
        INNER JOIN
        (
            SELECT etat, MAX(date) maxDate
            FROM commentaire
            GROUP BY etat
        ) b ON a.etat = b.etat AND
                a.date = b.maxDate
        INNER JOIN
        (
            SELECT etat, COUNT(*) totalCOunt
            FROM commentaire
            GROUP BY etat
        ) c ON a.etat = c.etat 
```

*   [SQLFiddle 演示](http://sqlfiddle.com/#!2/1109bd/4)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T14:18:15.990

```
SELECT  c.*, cnt
FROM    (
        SELECT  etat, COUNT(*) AS cnt
        FROM    commentaire
        GROUP BY
                etat
        ) cd
JOIN    commentaire c
ON      c.id =
        (
        SELECT  id
        FROM    commentaire ci
        WHERE   ci.etat = cd.etat
        ORDER BY
                date DESC, id DESC
        LIMIT 1
        ) 
```

为此创建一个索引以`(etat, date, id)`使其快速工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T14:18:20.497

尝试这个：：

```
SELECT  `etat` , COUNT(  'n_doss' ) 
FROM  `commentaire`  
GROUP BY  `etat` 
```

# c++ - 使用 opencv（opencv 和 c++）时出现重大内存泄漏

> ID：13495159
> 
> 赞同：0
> 
> 时间：2012-11-21T14:14:04.173
> 
> 标签：c++, opencv

我的系统编程课程有作业。一切都很好，没有任何内存泄漏，直到我使用 opencv（仍然是初学者）。

基本上，我有一个学生班和课程班，我必须将正确类型的学生（计算机科学学生、PG 学生..）分配给正确的课程（选修课和 PG/CS 课程）。

我做了所有我必须做的事情，现在最后一步是显示谁以彩色毕业的图像和谁没有以灰度毕业的图像。都做了。

我制作了一个图像处理程序类，用于处理打开图像、将图像保存到文件、初始化新图像以及转换为 RGB 和转换为 GreyScale 等所有功能。

此图像处理程序类具有图像字段，即：

```
cv::Mat m_image; 
```

现在，在学生类中，我让每个学生都有一个图像处理程序对象，我将他的图像存储到其中。

我什至在 imagehandler 类中做了一个析构函数：

```
imagehandler::~imagehandler(){
   m_image.release();
} 
```

在我开始执行 opencv 步骤之前（在我什至安装 opencv 并将我需要做的事情嵌入到我的代码中之前）我根本没有内存泄漏。在我对 opencv 步骤进行编程（并且全部工作）之后，我遇到了重大泄漏。

这是 valgrind 的日志文件（必须把它放在一个粘贴箱中，因为它太大而不能放在这里）： [valgrind.log](http://sebsauvage.net/paste/?96f8c3c8effc4ef2#lutPwjh8nBzZCCfF+1VwlQUpYl3u0RrTl1TqpNr3AKM=)

错误主要是当我读取图像、保存图像、调整图像大小、转换为 rgb 或灰度时......所有与 opencv 相关的泄漏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-08-12T13:56:48.470

我以前遇到过这个问题，我通过更改OpenCV的版本解决了这个问题。我现在使用opencv-2.4.13并且没有内存泄漏问题。问题版本是opencv-3.0.00。

# android - 没有标题栏的Android自定义设计对话框问题

> ID：13495161
> 
> 赞同：3
> 
> 时间：2012-11-21T14:14:16.840
> 
> 标签：android, android-layout, dialog, tile

我使用以下 xml 来设计自定义对话框。

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:background="@drawable/wound_screener_bg"
    android:layout_height="match_parent" >

    <TextView 
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:textStyle="bold"
        android:paddingTop="15dp"
        android:paddingRight="70dp"
        android:textColor="#5A5C5E"
        android:paddingLeft="70dp"
        android:id="@+id/bodyPartText"
        android:layout_centerHorizontal="true"
        android:text="You selected the arm"/>
    <TextView 
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:textStyle="normal"
        android:paddingTop="5dp"
        android:paddingBottom="5dp"
        android:textColor="#727576"
        android:id="@+id/confirmText"
        android:layout_below="@id/bodyPartText"
        android:layout_centerHorizontal="true"
        android:text="Is that correct?"/>
    <View 
        android:layout_width="15dp"
        android:layout_height="1dp"
        android:layout_below="@id/confirmText"
        android:layout_centerHorizontal="true"
        android:id="@+id/buffer"></View>
    <Button 
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="YES"
        android:paddingTop="10dp"
        android:paddingBottom="10dp"
        android:paddingRight="30dp"
        android:paddingLeft="30dp"
        android:background="#DDDDDD"
        android:textColor="#EB9093"
        android:id="@+id/yesBtn"
        android:layout_below="@id/confirmText"
        android:layout_toLeftOf="@id/buffer"/>  
    <Button 
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="NO"
        android:paddingTop="10dp"
        android:paddingBottom="10dp"
        android:paddingRight="30dp"
        android:paddingLeft="30dp"
        android:id="@+id/noBtn"
        android:background="#DDDDDD"
        android:textColor="#EB9093"
        android:layout_below="@id/confirmText"
        android:layout_toRightOf="@id/buffer"/>
</RelativeLayout> 
```

现在我使用以下代码来显示对话框。

```
Dialog dialog = new Dialog(this);
dialog.requestWindowFeature(Window.FEATURE_NO_TITLE);
dialog.setContentView(R.layout.bodypart_comfirm);

TextView bodyPartText = (TextView) dialog.findViewById(R.id.bodyPartText);
Button yesBtn = (Button) dialog.findViewById(R.id.yesBtn);
Button noBtn = (Button) dialog.findViewById(R.id.noBtn);

bodyPartText.setText("You selected the " + partName);

noBtn.setOnClickListener(new OnClickListener() {
 @Override
 public void onClick(View v) {
   dialog.dismiss();
 }
});     

yesBtn.setOnClickListener(new OnClickListener() {
 @Override
 public void onClick(View v) {
   .............
   .............

 }
});

dialog.show(); 
```

它给出了一个如下所示的对话框。 ![在此处输入图像描述](../Images/bc7a5f35e540f1201d87230370def4b3.png)

现在，如果我删除“dialog.requestWindowFeature(Window.FEATURE_NO_TITLE);”行，它会给出正确的设计，但带有标题栏，但我没有标题栏。

![在此处输入图像描述](../Images/bb793976f8282727ee5ed9bf95bc9414.png)

我的代码有什么问题？如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T14:25:55.740

将此样式添加到您的 styles.xml 文件中：

```
<style name="FullHeightDialog" parent="android:style/Theme.Dialog">
        <item name="android:windowNoTitle">true</item>
        <item name="android:windowBackground">@android:color/transparent</item>
    </style> 
```

然后实例化你的对话：

```
LayoutInflater inflater=LayoutInflater.from(mContext);
View contentView=inflater.inflate(R.layout.instructions_popup_layout, null);
final Dialog dialog=new Dialog(this, R.style.FullHeightDialog);
dialog.setContentView(contentView);
Button button=(Button) dialog.findViewById(R.id.okButton); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T14:22:28.867

尝试将布局修改为

```
<TextView 
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:textStyle="bold"
    android:paddingTop="15dp"
    android:paddingRight="70dp"
    android:textColor="#5A5C5E"
    android:paddingLeft="70dp"
    android:id="@+id/bodyPartText"
    android:layout_centerHorizontal="true"
    android:text="You selected the arm"/>
<TextView 
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:textStyle="normal"
    android:paddingTop="5dp"
    android:paddingBottom="5dp"
    android:textColor="#727576"
    android:id="@+id/confirmText"
    android:layout_below="@+id/bodyPartText"
    android:layout_centerHorizontal="true"
    android:text="Is that correct?"/>
<View 
    android:layout_width="15dp"
    android:layout_height="1dp"
    android:layout_below="@+id/confirmText"
    android:layout_centerHorizontal="true"
    android:id="@+id/buffer"></View>
<Button 
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="YES"
    android:paddingTop="10dp"
    android:paddingBottom="10dp"
    android:paddingRight="30dp"
    android:paddingLeft="30dp"
    android:background="#DDDDDD"
    android:textColor="#EB9093"
    android:id="@+id/yesBtn"
    android:layout_below="@+id/confirmText"
    android:layout_toLeftOf="@+id/buffer"/>  
<Button 
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="NO"
    android:paddingTop="10dp"
    android:paddingBottom="10dp"
    android:paddingRight="30dp"
    android:paddingLeft="30dp"
    android:id="@+id/noBtn"
    android:background="#DDDDDD"
    android:textColor="#EB9093"
    android:layout_below="@+id/confirmText"
    android:layout_toRightOf="@+id/buffer"/> 
```

将所有引用更改为： android:layout_toRightOf="@id/buffer" 为 android:layout_toRightOf="@+id/buffer"

# silverlight - Silverlight EF 对象上下文未在 Web.cs 文件中生成

> ID：13495162
> 
> 赞同：1
> 
> 时间：2012-11-21T14:14:20.990
> 
> 标签：silverlight, entity-framework-4

这是我们正在做的，我们创建了一个 DLL 来容纳我们的实体框架模型。然后，我们创建了一个单独的 Silverlight 业务应用程序解决方案。然后将包含 DAL 的 DLL 添加到通常包含 EF 模型的项目中。然后我们添加了我们的域服务，对象上下文可用并且实体在列表中，因为它们应该是。然后在编译并进入包含我们代理的生成文件（*** .Web.cs）之后，我发现实体本身在那里，但不是它们所属的对象上下文。有没有人有同样的问题？

# c++ - 如何使用 istringstream 两次

> ID：13495164
> 
> 赞同：0
> 
> 时间：2012-11-21T14:14:26.793
> 
> 标签：c++, string, istringstream

> **可能重复：**
> [C++ - 重复使用 istringstream](https://stackoverflow.com/questions/2767298/c-repeatedly-using-istringstream)

鉴于此代码：

```
 string line;  // for the line
   ifstream myfile ("input.txt");
   int algorithmNumber , matrixDim;
   getline (myfile,line);
   istringstream buffer(line);
   buffer >> algorithmNumber; 
```

我读了一行，然后将该行从 string 转换为 int 。

但是，如果我想阅读下一行并再次执行此操作：

```
 buffer(line);
   buffer >> matrixDim; 
```

我明白了：`no match for call to '(std::istringstream {aka std::basic_istringstream<char>}) (std::string&)'`

如何阅读下一行并将其转换为 int with `istringstream`？

问候

# xmpp - XMPP 持久的会议室存在

> ID：13495167
> 
> 赞同：7
> 
> 时间：2012-11-21T14:14:39.903
> 
> 标签：xmpp

我有 XMPP 服务器（openfire）和一堆客户端（spark）分成几个组（部门）。我正在寻找将它们保留在会议室中的能力。我的意思是Skype具有的类似功能；当用户通过群组对话关闭窗口时，他的客户会继续跟踪该房间的活动，并且当出现新消息时，用户会再次自动加入该会议。我已经发现 spark+openfire 中没有这样的功能，虽然有很好的自动加入群聊书签功能，但是它并不能阻止用户简单地离开房间并且无法注意到进一步的事件。我想问一下是否有任何 XMPP 客户端实现了这个功能。我发现我可以设置我自己的具有管理权限的机器人来坐在每个房间上，并可能让它在用户离开会议并且他没有结束会话时强制踢/重新连接（例如通过 Openfire 的 HTTP 功能管理） ，所以连接时的自动加入会让他回来。但是，如果有替代方案，我认为简单地更改客户端应用程序会更容易和更好。

更新：我刚刚在 spark 中找到了“自动接受群聊邀请”选项，因此，如果我在他们不知情的情况下重新配置所有客户端并将此机器人设置为在此人离开频道时简单地发送邀请，它应该可以解决问题。还有其他想法吗？

更新2：

好的，伙计们，我已经成功测试了“Spark->首选项->群聊->自动接受群聊邀请”选项，它正在工作；我的 spark 会自动加入我被邀请参加的每个会议。所以我在基于 JAXL 3.0 的机器人中实现了会议观看 -> 自动重新邀请功能。唯一的问题是 jaxl-sent 邀请对我不起作用。这是源代码：

```
<?php
###  JAXL message bot composed by ewilded
require 'JAXL-3.x/jaxl.php';
$jabber_conf=array('jid' => 'messagebot@localhost','host'=>'openfire','user'=>'messagebot','domain'=>'localhost','logLevel'=>4, 'strict'=>true, 'port'=>5222, 'pass'=>'somepass','log_level' => JAXL_INFO);
error_reporting(E_ALL);
$conference_rooms=array('tech@conference.localhost');
$client=null;

## Creating the object
$client = new JAXL($jabber_conf);
$client->require_xep(array(
      '0045', // MUC
      '0203', // Delayed Delivery
      '0199',  // XMPP Ping
      '0249'    // direct invite
));
## connect up callbacks
$client->add_cb('on_auth_success', function() use($client,$conference_rooms,$cron_interval) {
        echo "Auth success.\n";
    echo "My full jid: ".$client->full_jid->to_string()."\n";
        $client->set_status("Mesasge bot - available!");  // set your status
        $client->get_vcard();               // fetch your vcard
        $client->get_roster();              // fetch your roster list
        foreach($conference_rooms as $conference)
        {
            echo "Joining conference $conference.\n";
            $room_full_jid=new XMPPJid("$conference/messagebot");
            $client->xeps['0045']->join_room($room_full_jid);
       }
    });
$client->add_cb('on_chat_message', function($msg) use($client) {
            $to=$msg->from; 
          echo "Sending answer to: ".$to."\n";
            $client->send_chat_msg($to,"I am just simple bot written in PHP with JAXL XMPP library.");
        });
$client->add_cb('on_connect_error',function(){echo "Connection error :(\n";});
$client->add_cb('on_disconnect', function() {
     echo "Got disconnected.\n";
     _debug("got on_disconnect cb");
});

$client->add_cb('on_error_stanza',function($msg)
{    
    echo "Error stanza.";
    #print_r($msg);  
});
$client->add_cb('on_presence_stanza',function($msg) use($client)
{
    echo "Presence stanza.\n";
    ### joins and lefts are shown here, so here we simply send reinvite if we see that someone's left
    if(isset($msg->attrs['type'])&&$msg->attrs['type']=='unavailable')
    {
        if(isset($msg->childrens[0])&&isset($msg->childrens[0]->childrens[0])&&isset($msg->childrens[0]->childrens[0]->attrs['jid']))
        {
            echo "Sending invite.\n";
            $jid=$msg->childrens[0]->childrens[0]->attrs['jid'];
            $bare_jid=explode("/",$jid);
            $from_room=$msg->attrs['from'];
            $bare_from_room=explode("/",$from_room);
            echo $bare_jid[0]."\n";
            echo $bare_from_room[0]."\n";
            $client->xeps['0249']->invite($jid,$from_room); ### for some reason it does not work :(
            echo "Invite ($jid to $from_room) sent.\n";
        }
        else
        {
            echo "Ignoring.\n";
        }
    }
    echo "After presence stanza.\n";
});
$client->add_cb('on_normal_stanza',function()
{
    echo "Normal stanza.\n"; 
});
$client->add_cb('on_groupchat_message',function($msg) use ($client) {
echo "Groupchat event received.\n";
});

echo "Start called.\n";
$client->start();
?> 
```

会议室有“允许占用者邀请其他人”选项，两个帐户（我的朋友过去工作时向我发送邀请的帐户和消息机器人使用的帐户）都是技术组的成员，他们都没有管理权限，所以我确定这不是设置/权限相关的问题。

现在，当我离开会议室时，bot 检测到它并向我发送邀请，这是它在输出中的样子：... Presence 节。发送邀请。ewilded@localhost tech@conference.localhost 邀请（ewilded@localhost/Spark 2.6.3 to tech@conference.localhost/Ewil Ded）已发送。在存在节之后。...不幸的是，这个邀请没有生效。我想我在那个 xep 调用上做错了，或者更确切地说是它的参数： $client->xeps['0249']->invite($jid,$from_room);

如果有人在 Jaxl 中有工作邀请，请帮助，这是唯一要做的事情。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-07T12:42:42.037

您是否在日志中看到邀请数据包被发送？

对于下一级调试，您可能需要直接调用`$invite_pkt = $client->xeps['0249']->get_invite_pkt($to_bare_jid, $room_jid)`. 两者都`$to_bare_jid`必须`$room_jid`作为字符串传递。`get_invite_pkt`将返回您需要根据[直接 MUC 邀请 xmpp 扩展](http://xmpp.org/extensions/xep-0249.html)发送的必要节。如果您看到返回的节一切正常，只需调用`$client->send($invite_pkt)`.

希望这可以帮助您更好地调试并解决问题。

# c# - 变量名到字符串

> ID：13495168
> 
> 赞同：0
> 
> 时间：2012-11-21T14:14:40.240
> 
> 标签：c#

我有一个 CParam 字典，其中注册为键，

CParam 有一个从外部文本文件中读取的字段，Description 用作在 HumanDesc 中读取的键。

文本文件是翻译文件，描述必须是字符串。像这样的东西

```
PLACE_HOLDER1 "First Place where things are put"
PLACE_HOLDER2 "Secod Place where things are put"
..... 
```

我可以通过插入 Register as 并将其放在引号中轻松地做到这一点。但是有一个 100 的寄存器，它会很乏味（而且不是很优雅）。有没有办法让构造函数为我处理这个问题。

下面是我想要做的一个非常简化的例子：

```
using System;
using System.Collections.Generic;
namespace Var2String
{
    public class CParam
    {
    public ushort Register;
    public string Description;
    public ushort Content;
    public string HumanDesc;
    public CParam(ushort t_Register, string t_Description, string t_HumanDesc, ushort DefaultVal)
    {
        Register = t_Register;
        Description = t_Description;
        Content = DefaultVal;
        HumanDesc = t_HumanDesc;
    }
};

static class Device1
{
    public const ushort PLACE_HOLDER1 = 0x0123;
    public const ushort PLACE_HOLDER2 = 0x0125;
    public const ushort PLACE_HOLDER_SAME_AS_1 = 0x0123;
    public static Dictionary<ushort, CParam> Registers;
    static Device1()
    {
        Registers = new Dictionary<ushort, CParam>()
     {
       {PLACE_HOLDER1, new CParam(PLACE_HOLDER1,"PLACE_HOLDER1","Place One Holder",100)},
       {PLACE_HOLDER2, new CParam(PLACE_HOLDER1,"PLACE_HOLDER2","Place Two Holder",200)}
     };
        /*
         * Like to be able to do this
         * And constructor CParam
          Registers = new Dictionary<ushort, CParam>()
     {
       {PLACE_HOLDER1, new CParam(PLACE_HOLDER1,"Place One Holder",100)},
       {PLACE_HOLDER2, new CParam(PLACE_HOLDER1,"Place Two Holder",200)}
     };
        */
    }

}
class Program
{
    static private string LookUpTranslationFor(string Key)
    {
        string Translated = "Could not find Val for " + Key;
        //This would read XML file use Key to get translation
        return Translated;
    }
    static void Main(string[] args)
    {
        Console.WriteLine(Device1.Registers[Device1.PLACE_HOLDER1].HumanDesc);
        Console.WriteLine(Device1.Registers[Device1.PLACE_HOLDER2].HumanDesc);
        Device1.Registers[Device1.PLACE_HOLDER2].HumanDesc = LookUpTranslationFor(Device1.Registers[Device1.PLACE_HOLDER2].Description);
        Console.WriteLine(Device1.Registers[Device1.PLACE_HOLDER2].HumanDesc);
        Console.ReadKey(true);
    }
} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T14:43:36.273

我不确定我对您的理解是正确的，但是如果您注册的变量不是 const，您可以执行以下操作：

1.向CParam添加另一个构造函数

```
public class CParam
{
    ....

    public CParam(Expression<Func<ushort>> ex, string t_HumanDesc, ushort DefaultVal)
    {
        Content = DefaultVal;
        HumanDesc = t_HumanDesc;
        Description = ((MemberExpression) ex.Body).Member.Name;
        Register = ex.Compile().Invoke();
    }
}; 
```

2.像这样更改您的设备类：

```
internal static class Device1
{
    public static ushort PLACE_HOLDER1 = 0x0123;
    public static ushort PLACE_HOLDER2 = 0x0125;
    public static ushort PLACE_HOLDER_SAME_AS_1 = 0x0123;
    public static Dictionary<ushort, CParam> Registers;

    static Device1()
    {
        Registers = new Dictionary<ushort, CParam>()
                        {
                            {PLACE_HOLDER1, new CParam(() => PLACE_HOLDER1, "Place One Holder", 100)},
                            {PLACE_HOLDER2, new CParam(() => PLACE_HOLDER1, "Place Two Holder", 200)}
                        };
    }
} 
```

请注意这不适用于 const 变量！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T14:22:15.187

要获取变量名，您需要使用反射类，但不能对值类型使用反射

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T14:22:17.257

您可以使用 构建一个包含所需属性的类[`Reflection.Emit`](http://www.codeproject.com/Articles/121568/Dynamic-Type-Using-Reflection-Emit)，但对我来说它感觉很笨拙，并且您将缺少 IntelliSense，因为成员将在运行时生成（导致与使用字符串相同的问题）。

如果文件结构可靠并且可以依赖，为什么不创建一个从配置文件生成类文件的小实用程序呢？然后，您可以使用类作为占位符，在运行时使用配置文件中的数据填充成员（使用反射将类中的属性映射到文件中的属性），或者直接在类中设置数据。

然后，您可以将此配置类添加到您的项目中，并在需要时将其转换为字典。

# nhibernate - SetFirstResult(0) 有效，但 SetFirstResult(1) 无效

> ID：13495173
> 
> 赞同：0
> 
> 时间：2012-11-21T14:15:04.817
> 
> 标签：nhibernate, detachedcriteria

我正在尝试使用 MVC3 和 nhibernate 在我的 web 应用程序上进行分页，第一页工作正常，但除了工作之外别无他法`SetFirstResult(0)`！

.SetFirstResult(request.pageIndex * request.pageSize).SetMaxResults(request.pageSize)

> NHibernate.Exceptions.GenericADOException 未被用户代码处理 Message=could not execute query
> 
> InnerException: System.Data.SqlClient.SqlException Message=为“查询”多次指定了“DossierN5_8_3_”列。

我已经搜索了很多，但我找不到任何有同样问题的人。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-14T14:45:34.790

我对 SetFirstResult 有同样的问题。我发现使用JoinAlias时出现了问题。

无法解释原因，但重命名别名后一切正常。

在我的情况下，问题完全与别名有关，我猜在某些情况下将连接类型更改为`JoinType.LeftOuterJoin`可能会有所帮助。

# python - TypeError：列表索引必须是整数，而不是 str

> ID：13495175
> 
> 赞同：-7
> 
> 时间：2012-11-21T14:15:10.487
> 
> 标签：python, python-2.7

使用的变量的声明如下：

```
self.features = {}      #dictionary defined for storing the features and the values
self.featureNameList = []  #list to store the names and values of the features
self.featureCounts = collections.defaultdict(lambda: 1) #the counts of the features and labels
self.featureVectors = [] # 
self.labelCounts = collections.defaultdict(lambda: 0)            
def Classify(self):      #featureVector is a simple list like the ones that we use to train
    probabilityPerLabel = {}
    for label in self.labelCounts.keys():
        Prob = 0
        for featureValue in self.featureVectors:
            #print self.labelCounts[label]
            Prob+=self.featureCounts[[label][self.featureNameList[self.featureVectors.index(featureValue)]][featureValue]]/self.labelCounts[label]
            # Prob+= self.featureCounts(label, self.featureNameList[self.featureVectors.index(featureValue)], featureValue)/self.labelCounts[label]
        probabilityPerLabel[label] = (self.labelCounts[label]/sum(self.labelCounts.values())) * (Prob)
    print probabilityPerLabel
    return max(probabilityPerLabel, key = lambda classLabel: probabilityPerLabel[classLabel]) 
```

该错误是在该行产生的：

```
Prob+=self.featureCounts[[label][self.featureNameList[self.featureVectors.index(featureValue)]][featureValue]]/self.labelCounts[label] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T14:20:31.663

你的问题可能是：

```
[label][self.featureNameList[self.featureVectors.index(featureValue)] 
```

在我看来，您正在制作一个长度为 1 的列表：

```
[label] 
```

然后你试图通过索引从中获取一个元素：

```
[self.featureNameList[self.featureVectors.index(featureValue)] 
```

但是外括号内的东西评估为一个字符串。并且字符串不能用于索引列表。

最终，这几乎肯定*不是*你想要做的，但我认为它解释了错误。一般来说，我建议您避免像这样非常长且令人困惑的 1 行，并使用临时（但恰当命名）变量将其分解为组成部分。这将使您的代码更容易理解，因此更容易编写和开发。

# c# - Serializable Class 序列化为 Xml，但同一个 Xml 不会反序列化

> ID：13495177
> 
> 赞同：0
> 
> 时间：2012-11-21T14:15:21.883
> 
> 标签：c#, xmlserializer, invalidoperationexception

`AuthenticateUserOutput`我们从 WCF Web 服务返回类的实例。

所以我们有这个方法：

`public override AuthenticateUserOutput AuthenticateUser(AuthenticateUserInput AuthenticateUserInput)`

AuthencateUserOutput 是自动生成的：

```
[System.CodeDom.Compiler.GeneratedCodeAttribute("System.Xml", "2.0.50727.5420")]
[System.SerializableAttribute()]
[System.Diagnostics.DebuggerStepThroughAttribute()]
[System.ComponentModel.DesignerCategoryAttribute("code")]
[System.Xml.Serialization.XmlTypeAttribute(AnonymousType=true, Namespace="xxxx")]
public partial class AuthenticateUserOutput : WS2MethodOutput
{

    private bool authenticationResultField;

    private UserContext userContextField;

    /// <remarks/>
    public bool AuthenticationResult
    {
        get
        {
            return this.authenticationResultField;
        }
        set
        {
            this.authenticationResultField = value;
        }
    }

    /// <remarks/>
    public UserContext UserContext
    {
        get
        {
            return this.userContextField;
        }
        set
        {
            this.userContextField = value;
        }
    }
} 
```

我们需要能够反序列化为`AuthenticateUserOutput`，但它不起作用。

作为测试，我实例化了一个`AuthenticateUserOutput`，序列化它并尝试反序列化它。

它因 InvalidOperationException 而失败。

这是序列化的 XML：

```
<?xml version="1.0" encoding="utf-16"?>
<AuthenticateUserOutput xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="xxxx">
  <Response xmlns="xxxx">
    <IsValid>true</IsValid>
    <Success>true</Success>
  </Response>
  <AuthenticationResult xmlns="xxxx">true</AuthenticationResult>
  <UserContext xmlns="xxxx">
  </UserContext>
</AuthenticateUserOutput> 
```

下面是序列化和反序列化代码：

```
 public static string ToXml(this object input)
    {
        string output;
        XmlSerializer serializer = new XmlSerializer(input.GetType());
        StringBuilder sb = new StringBuilder();
        using (TextWriter textWriter = new StringWriter(sb))
        {
            serializer.Serialize(textWriter, input);
        }
        output = sb.ToString();
        return output;
    } 
```

和：

```
 public static T FromXml<T>(this string input)
    {
        T output;

        XmlSerializer serializer = new XmlSerializer(typeof(T));

        output = (T)serializer.Deserialize(new StringReader(input));

        return output;
    } 
```

异常的具体细节：

```
System.InvalidOperationException occurred
  Message="<AuthenticateUserOutput xmlns='xxxx'> was not expected."
  Source="qkxd8dd-"
  StackTrace:
       at Microsoft.Xml.Serialization.GeneratedAssembly.XmlSerializationReaderAuthenticateUserOutput.Read31_AuthenticateUserOutput()
  InnerException: 
```

所以它不能反序列化它自己的序列化 Xml。

有人能看出为什么吗？

谢谢，

J1M。

**更新**：这是测试代码：

```
 AuthenticateUserOutput test = new AuthenticateUserOutput();

        test.AuthenticationResult = true;
        test.Response = new ResponseType();
        test.Response.Exception = null;
        test.Response.IsValid = true;
        test.Response.Success = true;
        test.Response.ValidationErrors = null;
        test.UserContext = new UserContext();

        string serializedXml = test.ToXml();

        AuthenticateUserOutput deserializedString = serializedXml.FromXml<AuthenticateUserOutput>(); 
```

**UPDATE2** : 多亏了 Mark Gravell，反序列化器才能工作

[好的，我忘了我已经添加了这个来让命名空间在反序列化时正确出现：](https://stackoverflow.com/questions/11242038/adding-root-xmlns-using-xmlserializer-with-wcf-soap)

```
public partial class WS2MethodInput
{
    [XmlNamespaceDeclarations]
    public XmlSerializerNamespaces _xmlns;

    /// <summary>
    /// Constructor for WS2MethodInput that sets up default namespaces
    /// </summary>
    public WS2MethodInput()
    {
        _xmlns = new XmlSerializerNamespaces();
        _xmlns.Add("", "xxxx");
    }
} 
```

有了这个，序列化的 Xml 就像在这条消息的顶部一样。没有它，反序列化程序可以工作，但 AuthenticateUserOutput 缺少命名空间：

```
<?xml version="1.0" encoding="utf-16"?>
<AuthenticateUserOutput xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="xxxx">
  <Response xmlns="xxxx">
    <IsValid>true</IsValid>
    <Success>true</Success>
  </Response>
  <AuthenticationResult xmlns="xxxx">true</AuthenticationResult>
  <UserContext xmlns="xxxx">
  </UserContext>
</AuthenticateUserOutput> 
```

注意`xmlns="xxxx"`末尾的`AuthenticateUserOutput`

问题是，现在我不能在没有其他代码的情况下使用该 Xml：

1）将其加载到 XDocument 中并添加命名空间并在我需要对其进行反序列化时将其删除 2）对正则表达式的字符串替换或其他内容执行相同操作

我真的不喜欢这两个。事实上，这太可怕了！8X

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T16:15:44.727

问题是设置 XmlSerializerNamespaces 以强制根元素上的 xmlns。

把它拿走，它就起作用了。

但是，现在我不能在其他任何地方使用序列化的 Xml，因为它缺少命名空间。

我将开始一个新的问题，关注这个问题。

谢谢，

J1M。

**更新：**

好的，我想通了，所以我不打算写一个新问题。

给定以下 XSD：

```
<xs:schema xmlns="urn:www-test-com:testservice" xmlns:xs="http://www.w3.org/2001/XMLSchema" targetNamespace="urn:www-test-com:testservice" elementFormDefault="qualified" attributeFormDefault="unqualified">
    <xs:element name="AuthenticateUserInput">
        <xs:annotation>
            <xs:documentation>Used to provide user credentials to the AuthenticateUser method</xs:documentation>
        </xs:annotation>
        <xs:complexType>
            <xs:sequence>
                <xs:element name="Username" type="xs:string"/>
                <xs:element name="Password" type="xs:string"/>
                <xs:element name="Method" type="xs:string"/>
            </xs:sequence>
        </xs:complexType>
    </xs:element>
</xs:schema> 
```

svcutil 会生成类似这样的东西，尽管我想有很多工具会为 XSD 吐出类似的东西：

```
[Serializable()]
[XmlType(AnonymousType = true, Namespace = "urn:www-test-com:testservice")]
public class AuthenticateUserInput
{
    public string Username { get; set; }
    public string Password { get; set; }
    public string Method { get; set; }
} 
```

现在，使用“默认”`XmlSerializer`代码：

```
 static string ToXml(object input)
    {
        string output;

        XmlSerializer serializer = new XmlSerializer(input.GetType());
        StringBuilder sb = new StringBuilder();

        using (XmlWriter xw = XmlWriter.Create(sb))
        {
            serializer.Serialize(xw, input);
        }
        output = sb.ToString();
        return output;
    } 
```

您将获得以下 XML：

```
<AuthenticateUserInput xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
    <Username xmlns="urn:www-test-com:testservice">sa</Username>
    <Password xmlns="urn:www-test-com:testservice">Password1</Password>
    <Method xmlns="urn:www-test-com:testservice">Plain</Method>
</AuthenticateUserInput> 
```

哪个不符合模式（验证失败，这就是目前正在杀死我们的原因）

`[XmlType]`好的，所以，我找到了更改为的参考，`[XmlRoot]`并且粗略的测试有效，如果我更改生成的类，我现在得到以下一致的 Xml：

```
<AuthenticateUserInput xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="urn:www-test-com:testservice">
    <Username>sa</Username>
    <Password>Password1</Password>
    <Method>Plain</Method>
</AuthenticateUserInput> 
```

但我不想手动更改所有自动生成的类。所以过了一段时间我找到了以下解决方案：

```
 static string ToXml(object input)
    {
        string output;

        XmlSerializer serializer = CreateSerializer(input.GetType());
        StringBuilder sb = new StringBuilder();

        var settings = new XmlWriterSettings() { OmitXmlDeclaration = true, Encoding =  Encoding.UTF8, Indent = true };

        using (XmlWriter xw = XmlWriter.Create(sb, settings))
        {
            serializer.Serialize(xw, input);
        }
        output = sb.ToString();
        return output;
    }

    static T FromXml<T>(string input)
    {
        T output;

        XmlSerializer serializer = CreateSerializer(typeof(T));

        output = (T)serializer.Deserialize(new StringReader(input));

        return output;
    }

    private static XmlSerializer CreateSerializer(Type incomingType)
    {
        XmlAttributeOverrides attrOverrides = new XmlAttributeOverrides();
        XmlAttributes newAttributes = new XmlAttributes();

        newAttributes.XmlRoot = new XmlRootAttribute();
        newAttributes.XmlRoot.Namespace = ((XmlTypeAttribute)incomingType.GetCustomAttributes(typeof(XmlTypeAttribute), true)[0]).Namespace;
        attrOverrides.Add(incomingType, newAttributes);

        XmlSerializer serializer = new XmlSerializer(incomingType, attrOverrides);
        return serializer;
    } 
```

如您所见，您可以创建一个`XmlAttributeOverrides`并添加一个`XmlAttributes`实例化`XmlRoot`属性，而不是仅使用 XmlSerializer 的默认构造函数。为了使这个更好和通用，它将命名空间从传入的类型中剔除，`((XmlTypeAttribute)incomingType.GetCustomAttributes(typeof(XmlTypeAttribute), true)[0]).Namespace`如果类型没有该属性，则会失败，所以这个解决方案需要更多的工作，但你明白了一般的想法。

问候，

`J1M`

# jquery - 在 jQuery 数据表和服务器端数据处理中使用多行 THEAD

> ID：13495182
> 
> 赞同：1
> 
> 时间：2012-11-21T14:15:47.257
> 
> 标签：jquery, datatables

我正在使用 jquery Datatables 插件 (http://www.datatables.net) 并且需要显示许多列 (75+) 和一些 <50 行。为了让用户更轻松，我使用了出色的插件 FixedColumns。我没有使用任何分页和排序（这会使这变慢，并且实际上不需要最多 50 行的分页）

在 IE9 中，表格的呈现速度太慢（>7 秒），所以现在我使用来自 PHP 的 JSON 数据检索数据服务器端。这加快了速度，但现在我遇到了一个问题。我的表头有两行，第一行有一个 colspan，第二行有列数作为数据。

不知何故，我不能以这种方式在表内使用 THEAD，并且“aoColumns”参数看起来不支持多行列。有人知道我如何使用多行 THEAD（包括 colspan）和使用 ajax 获取数据吗？

我正在使用此代码来构建表格。

```
 var defaultOptions =  {
                "sScrollX": "100%",
                "bScrollCollapse": false,
                "sHeightMatch": "none",
                "bPaginate": false,
                "bLengthChange": false,
                "bSortClasses": false,
                "bSort":false,
                "bFilter": false,
                "bSort": false,
                "bInfo": false,
                "bAutoWidth": false,
                "bServerSide": false,
                "bProcessing":true,
                "bDeferRender": false,
                "sAjaxSource": "/leerkracht/controle_data.php",
                "fnServerParams": function ( aoData ) {
                      aoData.push( { "name":"groep", "value":"56"} );
                }, 
                "oLanguage": {
                         "sProcessing": "<div style='margin-top:7px;margin-bottom:7px;'><img src='/images/ajax-loader.gif' style='margin-right:7px;'/>Bezig met ophalen scores...</div>",    "sLengthMenu": "_MENU_ resultaten weergeven",    "sZeroRecords": "Geen resultaten gevonden",    "sInfo": "_START_ tot _END_ van _TOTAL_ resultaten",    "sInfoEmpty": "Geen resultaten om weer te geven",    "sInfoFiltered": " (gefilterd uit _MAX_ resultaten)",    "sInfoPostFix": "",    "sSearch": "Zoeken:",    "sEmptyTable": "Geen resultaten aanwezig in de tabel",    "sInfoThousands": ".",    "sLoadingRecords": "Een moment geduld aub - bezig met laden...",    "oPaginate": {        "sFirst": "Eerste",        "sLast": "Laatste",        "sNext": "Volgende",        "sPrevious": "Vorige"    }
                }

            }

        var oTable = $('#controleTable').dataTable(defaultOptions );
        new FixedColumns( oTable ); 
```

我真的希望有一个像[Scroller](http://datatables.net/extras/scroller/ "滚动条")这样的插件用于水平滚动（滚动后执行 ajax 调用并重绘“新”列和“新数据”）......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-25T23:35:11.557

由于性能不佳，我离开了 jQuery Datatables。我决定使用 Dojo 网格并解决了我的问题。它也快了很多。

# asp.net - 选择 ASP.NET DropDownList 以使 DetailsView 显示结果

> ID：13495183
> 
> 赞同：0
> 
> 时间：2012-11-21T14:15:47.913
> 
> 标签：asp.net, sql-server

我使用 2 个下拉列表，它是显示 SQL Server 数据列表的父子控件。我想在我选择第二个下拉列表时实现它，DetailsView 将显示我选择的结果。如果我选择数据库名称是 Database3，我希望 DetailsView 显示来自 database3 的所有结果。我尝试进行一些编码，但详细信息视图没有显示任何内容。请帮忙！这是我的下拉列表代码，

```
<asp:DropDownList ID="DropDownServerName" runat="server" AutoPostBack="True" DataSourceID="SqlDataSource2" DataTextField="ServerName" DataValueField="ServerName">
    </asp:DropDownList>
    <asp:SqlDataSource ID="SqlDataSource2" runat="server" ConnectionString="<%$ ConnectionStrings:Database_Shared_NotebookConnectionString %>" SelectCommand="SELECT [ServerName] FROM [tblServer]"></asp:SqlDataSource>
    <br />
    <br />
    <br />
    <asp:Label ID="Label10" runat="server" Text="Select Database:"></asp:Label>
    <br />
    <asp:DropDownList ID="DropDownDatabase" runat="server" AutoPostBack="True" DataSourceID="SqlDataSource3" DataTextField="DatabaseName" DataValueField="DatabaseName" OnSelectedIndexChanged="DropDownDatabase_SelectedIndexChanged">
    </asp:DropDownList>
    <asp:SqlDataSource ID="SqlDataSource3" runat="server" ConnectionString="<%$ ConnectionStrings:Database_Shared_NotebookConnectionString %>" SelectCommand="SELECT [DatabaseName] FROM [tblDatabase] WHERE [ServerName] = @ServerName">
        <SelectParameters>
            <asp:ControlParameter ControlID="DropDownServerName" Name="ServerName" PropertyName="SelectedValue" />
        </SelectParameters>
    </asp:SqlDataSource> 
```

然后在DetailsView中，我不想放太多代码，你必须去看看所有的低谷，但DetailsView有更新、删除和插入功能。它们附带的 DataSourceID 是 SQLDataSource1，它从表数据库中绑定字段。在 SQLDataSource1 中，在 SelectCommand 上，我键入：

```
SelectCommand="SELECT * FROM [tblDatabase] WHERE [DatabaseName] = @DatabaseName" 
```

然后我为此从选定的下拉列表中添加 SQLDataSource1 中的 SelectParameter，

```
<SelectParameters>
            <asp:ControlParameter ControlID="DropDownDatabase" Name="DatabaseName" PropertyName="SelectedValue" />
        </SelectParameters 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T23:19:49.587

这是我使用相同要求构建的页面的一些代码。我有两个下拉列表，一个是客户姓名，另一个是他们购买的产品。详细信息视图将显示在第二个下拉列表中选择的任何产品的完整详细信息。

我想这就是你想要的。请记住，当您为第二个下拉列表和详细信息视图设置数据源时，您必须确保使用向导创建 where 子句，以便两者都从下拉列表控件中获取主键。

例如，sqldatasource1（参见代码底部）的 ControlID 设置为“ddlProducts”，PropertyName 设置为“SelectedValue”。使用 sqlDataSource1 的详细信息视图使用 Products 下拉列表的选定值运行 select 语句。希望这会有所帮助。

```
<table class="style4">
        <tr>
            <td>
                Customer:</td>
            <td>
        <asp:DropDownList ID="ddlCustomers" runat="server" 
            DataSourceID="ObjectDataSource1" AutoPostBack="True" DataTextField="Name" 
            DataValueField="CustomerID" AppendDataBoundItems="True" 
            onselectedindexchanged="ddlCustomers_SelectedIndexChanged">
             <asp:ListItem Text="--Select a customer--" Value="0"></asp:ListItem>
        </asp:DropDownList>
        <asp:ObjectDataSource ID="ObjectDataSource1" runat="server" TypeName="CustomerDB" SelectMethod="GetCustomerList">
        </asp:ObjectDataSource>
                <asp:RequiredFieldValidator ID="RequiredFieldValidator1" runat="server" 
                    ControlToValidate="ddlCustomers" ErrorMessage="Please select a Customer" 
                    InitialValue="0"></asp:RequiredFieldValidator>
            </td>
        </tr>
        <tr>
            <td>
                Product</td>
            <td>
        <asp:DropDownList ID="ddlProducts" runat="server" AutoPostBack="True" 
            DataSourceID="ObjectDataSource2" DataTextField="Name" 
            DataValueField="ProductCode" AppendDataBoundItems="True" 
                    onselectedindexchanged="ddlProducts_SelectedIndexChanged">
            <asp:ListItem Text="--Select a product--" Value="0"></asp:ListItem>
        </asp:DropDownList>
        <asp:ObjectDataSource ID="ObjectDataSource2" runat="server" 
            SelectMethod="GetCustomerProducts" TypeName="ProductDB" 
            OldValuesParameterFormatString="original_{0}">
            <SelectParameters>
                <asp:ControlParameter ControlID="ddlCustomers" Name="CustomerID" 
                    PropertyName="SelectedValue" Type="Int32" />
            </SelectParameters>
        </asp:ObjectDataSource>
                <asp:RequiredFieldValidator ID="RequiredFieldValidator2" runat="server" 
                    ControlToValidate="ddlProducts" ErrorMessage="Please select a product" 
                    InitialValue="0"></asp:RequiredFieldValidator>
            </td>
        </tr>

    </table>

    <asp:DetailsView ID="DetailsView1" runat="server" AutoGenerateRows="False" 
        DataKeyNames="ProductCode" DataSourceID="SqlDataSource1" Height="50px" 
        Width="125px">
        <Fields>
            <asp:BoundField DataField="ProductCode" HeaderText="ProductCode" 
                ReadOnly="True" SortExpression="ProductCode" />
            <asp:BoundField DataField="Name" HeaderText="Name" SortExpression="Name" />
            <asp:BoundField DataField="Version" HeaderText="Version" 
                SortExpression="Version" />
            <asp:BoundField DataField="ReleaseDate" HeaderText="ReleaseDate" 
                SortExpression="ReleaseDate" />
        </Fields>
    </asp:DetailsView>
    <asp:SqlDataSource ID="SqlDataSource1" runat="server" 
        ConnectionString="<%$ ConnectionStrings:TechSupport_DataConnectionString %>" 
        SelectCommand="SELECT [ProductCode], [Name], [Version], [ReleaseDate] FROM [Products] WHERE ([ProductCode] = @ProductCode)">
        <SelectParameters>
            <asp:ControlParameter ControlID="ddlProducts" Name="ProductCode" 
                PropertyName="SelectedValue" Type="String" />
        </SelectParameters>
    </asp:SqlDataSource> 
```

# iphone - inApp 为同一用户购买多台设备

> ID：13495185
> 
> 赞同：0
> 
> 时间：2012-11-21T14:15:51.313
> 
> 标签：iphone, objective-c, xcode, in-app-purchase

我在应用程序中集成**了inApp购买**以使用服务器模型解锁其他内容，即我将收据数据发送到服务器进行验证。

**问题**：如果用户有多个设备假设 Device1 和 Device2

1.  设备 1：用户安装 XYZ 应用程序，使用邮件/密码注册自己，然后订阅内容。
2.  Device2：（同一用户）用户安装 XYZ 应用程序，使用邮件/密码注册自己并转到订阅页面。

**问题**：我怎么知道这个 Device2 属于同一个已经订阅了 Device1 的用户？

**谢谢**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T15:34:09.673

利用

```
[[SKPaymentQueue defaultQueue] restoreCompletedTransactions] 
```

在 Apple 文档中阅读有关恢复交易的更多信息：

[StoreKit 指南](http://developer.apple.com/library/ios/documentation/NetworkingInternet/Conceptual/StoreKitGuide/MakingaPurchase/MakingaPurchase.html#//apple_ref/doc/uid/TP40008267-CH3-SW2)

[SKPaymentQueue 参考](http://developer.apple.com/library/ios/documentation/StoreKit/Reference/SKPaymentQueue_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40008257-CH1-SW14)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T14:20:33.907

让用户在两台设备上使用相同的帐户登录 iTunes Store。当他们尝试下载您的 IAP 时，将被视为重新下载，并且不会向他们收费。

# javascript - html5改变背景图片间隔时间

> ID：13495186
> 
> 赞同：0
> 
> 时间：2012-11-21T14:15:59.973
> 
> 标签：javascript

我如何在间隔时间更改身体背景图像，例如，每 10 秒应该更改背景图像。html5可以吗？
谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T14:39:45.820

您可以为此使用 javascript 函数并在该函数本身中使用 SetTimeOut，它将在指定的时间间隔后调用相同的函数。

尝试以下操作：

```
<!DOCTYPE html>
<html>
<head>
<script type='text/javascript'>
var imageID=0;
function changeimage(every_seconds){
    //change the image
    if(!imageID){
        document.getElementById("myimage").src="http://www.all-freeware.com/images/full/38943-nice_feathers_free_screensaver_desktop_screen_savers__nature.jpeg";
        imageID++;
    }
    else{if(imageID==1){
        document.getElementById("myimage").src="http://www.hickerphoto.com/data/media/186/flower-bouquet-nice_12128.jpg";
        imageID++;
    }else{if(imageID==2){
        document.getElementById("myimage").src="http://www.photos.a-vsp.com/fotodb/14_green_cones.jpg";
        imageID=0;
    }}}
    //call same function again for x of seconds
    setTimeout("changeimage("+every_seconds+")",((every_seconds)*1000));
}
</script>
</head>

<body style='background:black;' onload='changeimage(2)'>
<div style='position:absolute;width:100%;height:100%;left:0px;top:0px;' align='center'><img width='300px' height='250px' id='myimage' src='http://www.photos.a-vsp.com/fotodb/14_green_cones.jpg'/></div>
</body>

</html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T14:17:42.347

只需设置 document.body.backgroundImage。

您可以在 setInterval 或 setTimeout 调用的函数中执行此操作。

# c# - 在方法中嵌入事件处理程序的缺点

> ID：13495190
> 
> 赞同：2
> 
> 时间：2012-11-21T14:16:18.077
> 
> 标签：c#, asynchronous, manualresetevent

有时，当我使用具有异步交互方法的程序集时（您调用一个方法，然后您得到一个带有答案的事件），我喜欢通过在方法中嵌入事件处理程序将它们转换为同步方法。

问题是; 我在其他任何地方都看不到这种代码，所以我有一种令人讨厌的感觉，即这种方法存在一些我错过的主要缺点，而其他人都看到了。那么你怎么看 - 写这样的代码可以吗？

嵌入连接事件的事件处理程序的登录方法的简单示例。

```
 private void Logon(GatewayConnection connection)
    {
        const int fiveSecondTimeout = 5000;
        ManualResetEvent waitUntilOnlineEvent = new ManualResetEvent(false);
        EventHandler<ConnectionEventArgs> connectionHandler = (sender, e) =>
                                            {
                                                if (connection.Status == ConnectionStatus.Connected)
                                                    waitUntilOnlineEvent.Set();
                                            };

        connection.ConnectionEvent += connectionHandler;
        connection.Connect();
        bool timeoutReached = !waitUntilOnlineEvent.WaitOne(fiveSecondTimeout);
        connection.ConnectionEvent -= connectionHandler;

        if (timeoutReached)
            throw new ApplicationException("Logon failure");
    } 
```

我还认为，这种类型的代码，即使实际方法可能变得有点复杂，也有助于保持封装具有大量事件的对象的类的简洁和易于阅读。

# jquery - 在 jQuery Selector 中使用“-”号会出错

> ID：13495192
> 
> 赞同：-2
> 
> 时间：2012-11-21T14:16:20.817
> 
> 标签：jquery, html, css

我正在尝试运行以下代码：

```
$(document).ready({

    $("#menu-nav a").hover(
         function () {
           $(this).css ( marginRight: '20px' );
         }, 
         function () {
            $(this).css ( marginRight: '10px' );
         }
     );

}); //end ready 
```

但是，我的dreamweaver 报错就行了`$("#menu-nav a").hover(`。可以将选择器用作`#menu-nav a`其他东西还是应该使用其他东西？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T14:19:04.643

问题不是这个：

```
$(document).ready({ 
```

你需要这个：

```
$(document).ready(function () { 
```

我相信您知道这一点，但是由于错误显示在以下行中，因此很容易忽略。

* * *

**另一个问题：**

我想你也会在这里遇到问题：

```
 $(this).css ( marginRight: '20px' ); 
```

根据[jQuery docs](http://api.jquery.com/css/)，你应该使用这个：

```
 $(this).css ('margin-right', '20px'); 
```

* * *

**替代：**

这里还有一件事，只是为了给出一个完整的答案。正如评论中所指出的，如果您不想使用它，您实际上根本不需要 jQuery。试试这个：

```
#menu-nav a:hover { margin-right: 20px; } 
```

您可以添加任何您想要的样式。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-21T14:19:28.610

在你的例子中

```
$(document).ready({...}); 
```

应该

```
$(document).ready(function(){
    //...
}); 
```

也改变

```
$(this).css ( marginRight: '20px' ); 
```

到

```
$(this).css('marginRight','20px'); 
```

或者

```
$(this).css({'marginRight':'20px'}); 
```

在两条线上

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-21T14:20:05.297

你不传递一个对象，所以你不能使用`property: value`，你可以编码：

```
$(this).css({ marginRight: '20px'}); 
```

或者：

```
$(this).css( 'marginRight', '20px' ); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T14:22:51.423

我使用这个约定来避免在无数的括号和括号中迷失和困惑：

```
$(document).ready(DocReady);

function DocReady()
{       
       // More code here
} 
```

一个优点是您还可以通过单击按钮调用 DocReady 函数（也许是为了测试它）。

# java - 如何在 LinearLayout 中使部分可见的视图不可见？

> ID：13495194
> 
> 赞同：2
> 
> 时间：2012-11-21T14:16:30.267
> 
> 标签：java, android, layout, views

假设我们有一个简单的 LinearLayout，它具有垂直方向，大小宽度：100dp，高度：100dp

布局内部有 10 个 TextView（宽度：fill_parent，高度：wrap_content，max_lines = 1，scroll_horizo​​ntally = true，ellipsize = end）。每个文本视图都是可见的，并填充有 14dp 文本“What a text”。android 设备的最终密度无关紧要。大多数 TextView 将正确显示，但由于强制布局大小，其中一些将不可见或被裁剪。

目标是：检测剪裁视图并隐藏它们。

我尝试使用自定义 LinearLayout 子类，在布局阶段每个子视图都被测量并与目标大小进行比较。问题是测量调用会更改内部视图测量值 - 如果子视图不是简单视图而是 ViewGroup - 它不会正确显示。据我所知 - 在测量阶段之后 - 应该有布局阶段。但是一切都已经发生在自定义 LinearLayout 的布局阶段。

**编辑：**

好的，简化我的问题 - 我想要一个 LinearLayout 或一般来说 - 一个 ViewGroup，它不会绘制部分可见的孩子。

自定义布局类代码：

```
public final class ClipAwareLinearLayout extends LinearLayout
{    
    public ClipAwareLinearLayout(Context context, AttributeSet attrs)
    {
        super(context, attrs);
    }

    public ClipAwareLinearLayout(Context context)
    {
        super(context);
    }

    @Override
    protected void onLayout(boolean changed, int l, int t, int r, int b)
    {
        super.onLayout(changed, l, t, r, b);
        final int width = r - l;
        final int height = b - t;
        final int count = getChildCount();
        final int msWidth = MeasureSpec.makeMeasureSpec(width, MeasureSpec.AT_MOST);
        final int msHeight = MeasureSpec.makeMeasureSpec(height, MeasureSpec.AT_MOST);
        View child;
        int measuredHeight;
        int childHeight;
        for (int i = 0; i < count; ++i)
        {
            child = getChildAt(i);
            if (child != null)
            {
                childHeight = child.getHeight();
                child.measure(msWidth, msHeight);
                measuredHeight = child.getMeasuredHeight();
                final boolean clipped = (childHeight < measuredHeight);
                child.setVisibility(clipped ? View.INVISIBLE : View.VISIBLE);
            }
        }
    }

}` 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T16:29:56.870

试试下面的代码。它应该可以工作，但我没有测试过，所以我可能错了：

```
class ClippedLinear extends LinearLayout {

    public ClippedLinear(Context context, AttributeSet attrs) {
        super(context, attrs);
    }

    @Override
    protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) {
        super.onMeasure(widthMeasureSpec, heightMeasureSpec);
        boolean status = false;
        for (int i = getChildCount() - 1; i > 0; i--) {
            if (status) {
                continue;
            }
            final View child = getChildAt(i);
            final int childHeight = child.getMeasuredHeight();
            if (childHeight == 0) {
                child.setVisibility(View.GONE);         
            } else {                
                child.measure(widthMeasureSpec, heightMeasureSpec);
                if (childHeight < child.getMeasuredHeight()) {                  
                    child.setVisibility(View.GONE);
                }
                status = true;
            }
        }
    }

} 
```

# makefile - 使用 automake 将配置的变量传递给第三方 makefile

> ID：13495195
> 
> 赞同：0
> 
> 时间：2012-11-21T14:16:32.817
> 
> 标签：makefile, cross-compiling, automake, subdirectory

我正在处理一个使用自动工具编译的项目。它包含一个只有常规 Makefile 的外部库，当我从顶级项目运行配置时生成一个 Makefile，其中包含对库的递归调用 make 并且一切正常。

当我尝试交叉编译项目时出现问题。顶级生成的 Makefile 具有正确的设置（它来自配置脚本），但该库仍然使用我的默认 gcc 和 CFLAGS 编译。

有没有办法将生成的 Makefile 中的变量传递给库？我正在考虑添加`export`到生成的 Makefile 的末尾，但我找不到如何使用 automake 实现这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T08:57:43.507

好的，这很容易。`echo 'export' >> project_top/Makefile.in`帮助:-)

# java - 从布局中删除组件失败

> ID：13495198
> 
> 赞同：7
> 
> 时间：2012-11-21T14:16:45.167
> 
> 标签：java, vaadin, add-on

我目前正在处理来自[Ikarus widgetset](http://vaadin.com/addon/ikaruswidget)附加组件的 SlidingPanel。`removeComponent()`当我在服务器端收到一些“特殊”事件（例如，用户单击按钮或窗口被调整大小）时，我试图从视图中删除此面板。但是组件在视图上仍然可见。我试图调试 UI 接收的数据：

活动前：

```
-Response:
-change format=uidl pid=PID0
-com.vaadin.terminal.gwt.client.ui.VWindow id=PID0 height=590px width=815px immediate=true caption=ASM 5.0.7 name=1 theme=acs-reindeer resizable=true main=true        layoutRelativeHeight=true layoutRelativeWidth=true
      +variables
       -com.vaadin.terminal.gwt.client.ui.VVerticalLayout id=PID127 height=100.0% width=100.0% margins=0 alignments={} expandRatios={PID133:1,}
       +com.vaadin.terminal.gwt.client.ui.VHorizontalLayout
       +com.vaadin.terminal.gwt.client.ui.VPanel
       +com.vaadin.terminal.gwt.client.ui.VHorizontalLayout
       +com.vaadin.terminal.gwt.client.ui.VUriFragmentUtility
       +com.velociti.ikarus.widget.client.ui.VIkarusSlidingPanel 
```

活动结束后：

```
-Response:
   -change format=uidl pid=PID0
   -com.vaadin.terminal.gwt.client.ui.VWindow id=PID0 height=995px width=1853px immediate=true caption=ASM 5.0.7 name=1 theme=acs-reindeer resizable=true   main=true layoutRelativeHeight=true layoutRelativeWidth=true
      +variables
             -com.vaadin.terminal.gwt.client.ui.VVerticalLayout id=PID127 height=100.0% width=100.0% margins=0 alignments={} expandRatios={PID133:1,}
             +com.vaadin.terminal.gwt.client.ui.VHorizontalLayout
             +com.vaadin.terminal.gwt.client.ui.VPanel
             +com.vaadin.terminal.gwt.client.ui.VHorizontalLayout
             +com.vaadin.terminal.gwt.client.ui.VUriFragmentUtility 
```

我从响应中清楚地看到 - 窗口不再包含 VIkarusSlidingPanel - 但实际上它仍然存在，因为它没有从 DOM 中删除。

*   唯一对我有帮助的 - 重新加载页面。
*   从同一事件的窗口中删除按钮 - 效果很好。
*   `setVisible(false)`不起作用。在此之后尝试重新加载页面时我收到一个空白页面。（抛出 javacript 异常）

问题是什么？有人可以帮我解决问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-26T15:24:38.023

检查您的组件是否具有即时状态。在 Vaadin 中，它只是通过组件上的 setImmediate(true) 设置。而且我认为，删除组件的最佳方法是通过 setVisible(false) 隐藏它。

无论如何，希望你能找到解决办法。

# c# - .Net SFTP 连接中的错误密钥格式无效

> ID：13495199
> 
> 赞同：2
> 
> 时间：2012-11-21T14:16:47.177
> 
> 标签：c#, .net

我正在将现有的 win 服务移动到登台服务器。我只有win服务的exe文件。

当我启动服务时，它会抛出“无效的密钥格式”错误。

我使用反射器分析了 exe 文件，发现分配给“SFTP”对象的“PrivateKey”正在引发错误。代码如下：

```
SFTPInfo info=new SFTPInfo();
DataRow current = (DataRow)enumerator.Current;
info.Server = Conversions.ToString(current["SSHServer"]);
info.Login = Conversions.ToString(current["SSHLogin"]);
info.Key = (byte[])current["SSHKey"]; 
```

其中 SSHKey 来自数据库表，它是二进制格式（将 .prk 文件转换为二进制）

我如何生成有效的私钥并对其进行配置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T07:53:30.123

我们可以使用**PUTTYGEN**生成私钥/公钥对。

步骤是：

1.  打开腻子密钥生成器
2.  单击“转换”菜单并选择“导入密钥”
3.  选择要导入的密钥，然后单击“打开”按钮。
4.  单击“保存公钥”按钮。
5.  命名密钥并单击“保存”按钮

快乐编程... :)

# jaydata - Jaysvcutil 不生成任何类

> ID：13495200
> 
> 赞同：1
> 
> 时间：2012-11-21T14:16:49.617
> 
> 标签：jaydata

我跑：

```
JaySvcUtil.exe --metadataUri http://localhost:1578/Service.svc/$metadata --out Model.js -- namespace Model --v V2 
```

输出是：

```
Requesting: http://localhost:1578/Service.svc/$metadata... done.
OData version: V2 
```

结果文件：

```
(function(global, $data, undefined) {

})(window, $data); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T10:50:47.130

各种 OData 版本有多个 edm 命名空间。我首先尝试避免使用 --v 开关，让 JaySvcUtil.exe 尝试确定正确的开关。

如果这不起作用，请在[https://github.com/jaydata/JaySvcUtil/blob/master/Program.cs检查支持的命名空间版本](https://github.com/jaydata/JaySvcUtil/blob/master/Program.cs)

```
public static Dictionary<string, string> NamespaceVersions  = new Dictionary<string,string>
  {
    {"http://schemas.microsoft.com/ado/2007/05/edm", "V11" },
    {"http://schemas.microsoft.com/ado/2006/04/edm", "V1" },
    {"http://schemas.microsoft.com/ado/2008/09/edm", "V2" },
    {"http://schemas.microsoft.com/ado/2009/08/edm", "V21" },
    {"http://schemas.microsoft.com/ado/2009/11/edm", "V3" }
  }; 
```

如果 localhost:1578/Service.svc/$metadata 不在其中，请在[https://github.com/jaydata/JaySvcUtil/issues添加请求](https://github.com/jaydata/JaySvcUtil/issues)

# actionscript-3 - Away3d 设置 (fp10) 和绘图路径。

> ID：13495201
> 
> 赞同：1
> 
> 时间：2012-11-21T14:16:49.850
> 
> 标签：actionscript-3, flash, 3d, away3d

我试图让一个 2D 路径在 3d 中倾斜，然后一个 local3dtoglobal 方法现在工作了一段时间。我最初使用的是 Five3d，但[被卡住了](https://stackoverflow.com/questions/13474553/five3d-local3dtoglobal/13475244#comment18445778_13475244)。我已经搬到 Away3D 并很快发现它已经超出了我的想象。我已经开始了，但什至无法让任何东西出现在舞台上。任何人都可以看看我是否走对了路线，任何人都可以指出为什么我在舞台上看不到任何东西。

我正在使用 Away3D fp10，因为我读到它可以绘制曲线，而 Away4 fp11 还没有这种能力。

谢谢

```
package
{
    import away3d.cameras.TargetCamera3D;
    import away3d.containers.View3D;
    import away3d.core.base.Face;
    import away3d.core.base.Mesh;
    import away3d.materials.ColorMaterial;
    import away3d.materials.Material;
    import away3d.materials.WireColorMaterial;
    import flash.display.Sprite;
    import flash.events.Event;

    public class Away3Dfp10Test extends Sprite
    {
        private var _camera:TargetCamera3D;
        private var view:View3D;

        public function Away3Dfp10Test()
        {
             this.addEventListener(Event.ADDED_TO_STAGE, onAddedToStage);
        }

        protected function onAddedToStage(event:Event):void
        {
        // TODO Auto-generated method stub
            this.removeEventListener(Event.ADDED_TO_STAGE, onAddedToStage);
            createView();
            createScene();
        }

        private function createView():void
        {
            _camera = new TargetCamera3D();
            _camera.z = -1000;
            view = new View3D();
            view.x = 400;
            view.y = 300;
            view.camera = _camera;
            addChild(view);
        }

        private function createScene():void
        {
            var mesh:Mesh = new Mesh();
            mesh.bothsides = false;
            var material:WireColorMaterial = new WireColorMaterial(0xff0000);
            material.thickness = 10;
            material.color = 0x000000;
            material.wireColor = 0x00ff00;
            mesh.material = material;
            var face:Face = new Face();
            face.moveTo(0, 0, 0);
            face.lineTo(0, 100, 0);
            face.lineTo(100, 100, 0);
            face.lineTo(100, 0, 0);
            face.lineTo(0, 0, 0);
            mesh.addFace(face);
            view.scene.addChild(mesh);
            view.render();
        }

    } 

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T15:05:48.553

尝试简化一点，试试这个：

[http://away3d.com/tutorials/Setting_Up_Your_Scene](http://away3d.com/tutorials/Setting_Up_Your_Scene)

您的 createView 函数可能是问题所在。

坚持下去，祝你好运！

这是最新版本，我假设你有。

# windows - 在dependency walker中，有没有办法获得一个简单的未解决依赖项列表？

> ID：13495202
> 
> 赞同：1
> 
> 时间：2012-11-21T14:16:49.647
> 
> 标签：windows, dll, java-native-interface

我正在对一个巨大的 Windows dll 进行 jni 调用，该 dll 我有源代码并已构建，当我调用 loadlibrary 时，它失败并显示“找不到依赖库”。看到我已经构建了它，我假设我需要的一切都在机器上的某个地方......我正在通过依赖walker，我找到了通常的“WNetRestoreConnectionA”，但我希望还有更多。但是有成百上千的 dll 和函数需要筛选。

有没有办法得到一个会出现红色的东西的清单？

# java - 如何将 sqljdbc_auth.dll 添加到我的 maven 项目中

> ID：13495203
> 
> 赞同：15
> 
> 时间：2012-11-21T14:16:59.017
> 
> 标签：java, sql-server, maven, netbeans, jdbc

我正在尝试建立与数据库的连接。这是一个使用 maven 的简单项目。

我有问题`sqljdbc_auth.dll`

我添加了 mssql jdbc 驱动程序并添加了一个依赖项`pom.xml`

```
<dependency>
    <groupId>com.microsoft</groupId>
    <artifactId>mssql-jdbc</artifactId>
    <version>4.0.0</version>
</dependency> 
```

这是我的尝试块

```
try {
    // Establish the connection. 
    SQLServerDataSource ds = new SQLServerDataSource();
    ds.setIntegratedSecurity(true);
    ds.setServerName("BUILDSRV");
    ds.setDatabaseName("master");
    ds.setIntegratedSecurity(true);
    con = ds.getConnection();       
} 
```

我得到这个错误

```
 21.11.2012 18:07:04 com.microsoft.sqlserver.jdbc.AuthenticationJNI <clinit>
    WARNING: Failed to load the sqljdbc_auth.dll cause :- no sqljdbc_auth in       java.library.path
    com.microsoft.sqlserver.jdbc.SQLServerException: 
```

我有我的`sqljdbc_auth.dll`，但我不需要把它放到我的`C:\windows\...` 我需要从 maven 将它添加到我的项目中。我怎样才能做到这一点？

我试图将它添加到`pom.xml`但它不起作用

```
<plugin>
    <groupId>org.codehaus.mojo</groupId>
    <artifactId>build-helper-maven-plugin</artifactId>
    <version>1.1</version>
    <executions>
    <execution>
        <id>attach-artifacts</id>
        <goals>
            <goal>attach-artifact</goal>
        </goals>
        <configuration>
            <artifacts>
                <file>target</file>
                <type>dll</type>
            </artifacts>
        </configuration>
    </execution>
    </executions>
</plugin> 
```

我在构建时遇到了另一个错误

```
Failed to execute goal org.codehaus.mojo:build-helper-maven-plugin:1.1:attach-artifact (attach-artifacts) on project mavenproject1dbconnect: Unable to parse configuration of mojo org.codehaus.mojo:build-helper-maven-plugin:1.1:attach-artifact for parameter file: Cannot configure instance of org.codehaus.mojo.buildhelper.Artifact from target -> [Help 1] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T15:58:55.327

我不认为你需要在`maven-helper-plugin`这里使用。这里的文档说您需要*安装*dll 或在系统变量中指定其路径`java.library.path`。

看看 [http://msdn.microsoft.com/en-us/library/ms378428.aspx#Connectingintegrated](http://msdn.microsoft.com/en-us/library/ms378428.aspx#Connectingintegrated)

更新：确保 dll 与您的 jar 一起分发。如果您使用的是 maven，请将 dll 文件放在您的 src/main/resources 文件夹中。然后通过将其从包中排除来确保 dll 最终在 jar 之外。按照类似于[此处](http://chandanpandey.wordpress.com/2012/06/06/77/)概述的步骤进行操作。`target`在此之后，您应该在目录中拥有您的 dll 以及您构建的 jar 文件

然后，当您运行应用程序时，将系统属性作为命令行参数传递`java -Djava.library.path=.`。

如果您不想打扰通过命令行传递参数 - 您可以使用提取当前工作目录`System.getProperty("user.dir"))`并按照[此处](http://blog.cedarsoft.com/2010/11/setting-java-library-path-programmatically/)所述的步骤在您的方法`java.library.path`中以编程方式将您设置为当前目录`main`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-04-29T12:34:47.503

根据[此答案](https://stackoverflow.com/a/15409446/3410989)`java.library.path`中找到的信息，您可以通过在运行时注入 dll 来实现。

*我已经在生产环境中运行了几年，在 Java <= 8 上没有问题。不过，从来没有真正使用过新版本。快速测试适用于 Java 11，而不是 Java 15*

这是我的做法：

1.  将 dll 存储在您的应用程序路径中。例如：

```
project_root
├─src (or any other source path structure)
│ └─...packages...
└─extlib
  └─SqlJdbc
    └─auth
      ├─x64
      │ └─sqljdbc_auth.dll
      └─x86
        └─sqljdbc_auth.dll 
```

2.  在建立 JDBC 连接的类中使用以下静态初始化代码*（java <= 11 版本）*：

```
static {
    File file;
    if ("64".equals(System.getProperty("sun.arch.data.model")))
        file = new File("./extlib/SqlJdbc/auth/x64");
    else
        file = new File("./extlib/SqlJdbc/auth/x86");
    String dllPath;
    try {
        dllPath = file.getCanonicalPath();
        synchronized(Runtime.getRuntime()) {
            final Field usrPathsField = ClassLoader.class.getDeclaredField("usr_paths");
            usrPathsField.setAccessible(true);
            Object o = usrPathsField.get(null);
            String[] paths = o == null ? new String[0] : (String[]) o;
            if (!Arrays.stream(paths).anyMatch(s -> dllPath.equals(s))) {
                String[] usr_paths = Arrays.copyOf(paths, paths.length + 1);
                usr_paths[paths.length] = file.getCanonicalPath();
                usrPathsField.set(null, usr_paths);
            }
        }
        DriverManager.registerDriver(new SQLServerDriver());
    } catch (Exception e) {
        e.printStackTrace();
        throw new ExceptionInInitializerError(e);
    }
} 
```

根据[这个答案](https://stackoverflow.com/a/59468135/3410989)，您应该能够将其推送到至少 Java <= 13 使用`MethodHandles.privateLookupIn`而不是`ClassLoader.class.getDeclaredField`. 例如：

```
Lookup cl = MethodHandles.privateLookupIn(ClassLoader.class, MethodHandles.lookup());
VarHandle usrPathsField= cl.findStaticVarHandle(ClassLoader.class, "usr_paths", String[].class);
Object o = usrPathsField.get();
...
usrPathsField.set(usr_paths); 
```

*Java 15 肯定会破坏它，因为字段`usr_paths`不再存在`ClassLoader`*

***此时，您应该能够从 IDE 运行代码***

3.  将包含 dll（即`extlib`）的目录与您的 jar 一起部署。对于 Maven，您可以在 pom.xml 中使用以下内容：

```
<plugin>
    <artifactId>maven-resources-plugin</artifactId>
    <version>3.0.2</version>
    <executions>
        <execution>
            <id>copy-resources</id>
            <phase>prepare-package</phase>
            <goals>
                <goal>copy-resources</goal>
            </goals>
            <configuration>
                <outputDirectory>${project.build.directory}/extlib</outputDirectory>
                <resources>
                    <resource>
                        <directory>extlib</directory>
                        <filtering>false</filtering>
                    </resource>
                </resources>
            </configuration>
        </execution>
    </executions>
</plugin> 
```

从那里开始，如果您需要将 dll 打包到 jar 中，您可以使用`maven-resources-plugin`，并在运行时解压缩所需的 dll，然后使用上述代码的变体将其强制到库路径中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-06-11T19:40:18.317

将 dll 直接放在与主 jar 相同的级别应该就足够了。我怀疑您的问题与 dll 的 x64 和 x86 版本有关。你确定你的版本是一致的吗？

我正在使用这个部门：

```
<dependency>
    <groupId>com.microsoft.sqlserver</groupId>
    <artifactId>mssql-jdbc</artifactId>
    <version>9.1.1.jre8-preview</version>
</dependency> 
```

和dll：

mssql-jdbc_auth-9.1.1.x64-preview.dll

对于我的 64 位项目，它工作正常

# asp.net - 如何在操作中实现 razor.cshtml 文件

> ID：13495205
> 
> 赞同：1
> 
> 时间：2012-11-21T14:17:07.567
> 
> 标签：asp.net, asp.net-mvc, razor, asp.net-mvc-4

我想在 action 中实现 view.cshtml 文件，然后将其结果作为字符串获取，但不作为 ActionResult 从 action 方法返回。
用代码来解释，而不是：

```
public ActionResult Tesst()
        {
            // return ViewResult
            return View();
        } 
```

一定是这样的：

```
public string Test()
        {
            string viewResult = string.Empty;
            // implement "test.cshtml" and get its result as string
            // assign result to viewResult variable
            return viewResult;
        } 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T14:30:53.563

我使用这样的东西将我的应用程序内的视图呈现为字符串：

```
public static string RenderViewToString(System.Web.Mvc.Controller controller,
                                  string viewName, string layout, object model)
{
    controller.ViewData.Model = model;
    using (StringWriter sw = new StringWriter())
    {
        ViewEngineResult viewResult =
                   ViewEngines.Engines.FindView(
                           controller.ControllerContext, viewName, layout);
        ViewContext viewContext = new ViewContext(
                   controller.ControllerContext, 
                   viewResult.View, controller.ViewData, 
                   controller.TempData, sw);
        viewResult.View.Render(viewContext, sw);

        return sw.GetStringBuilder().ToString();
    }
} 
```

# c++ - OpenCV C++：按轮廓区域对轮廓进行排序

> ID：13495207
> 
> 赞同：13
> 
> 时间：2012-11-21T14:17:16.913
> 
> 标签：c++, sorting, opencv, contour

如何按轮廓区域的大小对轮廓进行排序？我怎样才能得到最大/最小的？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-11-21T14:17:16.913

您可以使用[`std::sort`](http://www.cplusplus.com/reference/algorithm/sort/)自定义比较函数对象

```
// comparison function object
bool compareContourAreas ( std::vector<cv::Point> contour1, std::vector<cv::Point> contour2 ) {
    double i = fabs( contourArea(cv::Mat(contour1)) );
    double j = fabs( contourArea(cv::Mat(contour2)) );
    return ( i < j );
} 
```

用法：

```
[...]

// find contours
std::vector<std::vector<cv::Point> > contours;
std::vector<cv::Vec4i> hierarchy;
cv::findContours( binary_image, contours, hierarchy, CV_RETR_EXTERNAL, CV_CHAIN_APPROX_SIMPLE, cv::Point(0, 0) );

// sort contours
std::sort(contours.begin(), contours.end(), compareContourAreas);

// grab contours
std::vector<cv::Point> biggestContour = contours[contours.size()-1];
std::vector<cv::Point> smallestContour = contours[0]; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2015-12-07T14:20:19.250

如果 C++11 可用，只需使用 lambda 函数给出解决方案。

```
 sort(contours.begin(), contours.end(), [](const vector<Point>& c1, const vector<Point>& c2){
    return contourArea(c1, false) < contourArea(c2, false);
}); 
```

然后您可以访问`contours[0]`以获取面积最小的轮廓并`contours[contours.size()-1]`获得面积最大的轮廓，因为轮廓是按升序排序的。

# c# - UIElement.IsVisible == false 用于自定义控件，无法聚焦

> ID：13495218
> 
> 赞同：2
> 
> 时间：2012-11-21T14:17:42.793
> 
> 标签：c#, wpf, custom-controls

我有一个从 System.Windows.Controls.Control 派生的自定义 wpf 控件，它在大多数情况下都做得很好。

然而，有时在调用 UIElement.Focus() 的控件上调用 x.Focus() 会返回 false 并且不会聚焦控件。

经过一番挖掘，我发现

```
var x = control as FrameworkElement;
var focusable = x.Focusable; // -> true
var enabled = x.IsEnabled;  // -> true
var visible = x.IsVisible; // -> FALSE <- !!! ARRGG 
```

控件已渲染，我完全可以在 UI 中看到它。我尝试将 Focus() 的调用放到 Dispatcher，尝试在控件上调用 UpdateLayout() 都没有帮助。

最有趣的部分是，如果我使用 Snop 检查 IsVisible 属性，Snoop 会报告它为 True :)

我是否遗漏了一些明显的东西，在我的控制实现或其他地方？

编辑 22.11.2012

感谢到目前为止的评论，对于那些建议控件可能尚未完全呈现的评论

```
var x = control as FrameworkElement;
x.Dispatcher.Invoke(new Action(() =>
{
var isVisible = fe.IsVisible; // -> False
var focused = fe.Focus(); // -> False
}), DispatcherPriority.ApplicationIdle); 
```

这也没有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-08-20T01:10:38.030

检查 MSDN 文档中的所有`override`s 并确保在需要时调用基类的方法。

我只是遇到了同样的问题，在几乎发疯后我发现了罪魁祸首：我正在重写`OnVisualParentChanged`并且没有*调用*基类（`FrameworkElement`在我的情况下），即使 MSDN 明确指出：

> 始终调用基本实现以保留此行为，否则当声明为另一个元素的子元素时，此元素的元素树行为可能与预期不同。

添加对属性的调用后`base.OnVisualParentChanged`，`IsVisible`事件`IsVisibleChanged`开始按预期运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T14:22:55.403

你什么时候检查 IsVisible 看它是假的？控件是否已完全初始化和加载？如果 snoop 认为它是真的，那么它一定是:) 你什么时候尝试集中控制？如果您在它未完全初始化时尝试集中它，则可能有合理数量的原因它不起作用。

无论如何，尝试通过[Keyboard.Focus](http://msdn.microsoft.com/en-us/library/system.windows.input.keyboard.focus.aspx)方法而不是使用[UIElement.Focus](http://msdn.microsoft.com/en-us/library/system.windows.uielement.focus.aspx)来选择您的控件。

```
Keyboard.Focus(x); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-12T21:05:22.887

我有同样的问题，不知道是什么原因造成的。我通过解决方法修复了它。

我在样式中将 Visibility 设置为 Collapsed，然后在 Loaded 事件中将其设置为 Visible。我意识到这并不适合所有用途，但如果其他人遇到此问题，那么您可以尝试此解决方法来解决它。

```
 // Set to visible on load
 Loaded += delegate
 {
     Dispatcher.BeginInvoke(new Action(() => Visibility = Visibility.Visible));
 };

 <!-- By default set to Collapsed -->
 <Style TargetType="{x:Type MyCustomTypeThatIsMisbehaving}">
    <Setter Property="Visibility" Value="Collapsed"/>
 </Style> 
```

当控件可见时， IsVisibleChanged 触发，从那时起，它似乎工作得很好

# c# - foreach 在 ObservableCollection 上抛出 NullReferenceException

> ID：13495219
> 
> 赞同：0
> 
> 时间：2012-11-21T14:18:02.683
> 
> 标签：c#, .net, foreach, observablecollection, nullreferenceexception

我有`class ElementRelation { ... }`和`class ElementRelationCollection : System.Collections.ObjectModel.ObservableCollection<ElementRelation> { ... }`

我有这个代码：

```
ElementRelationCollection a = ...;
if (a == null)
    throw new Exception("a is null(???)"); // this exception is never thrown
try
{
    foreach (ElementRelation relation in a) // exception is thrown here
    { ... } // never thrown here
}
catch (NullReferenceException ex)
{
    string message = "Something is null here. a.Count: " + a.Count;
    IEnumerator<ElementRelation> enumerator = a.GetEnumerator();
    message += ", enumerator is " + (enumerator == null ? "null" : "not null");
    throw new Exception(message, ex);
} 
```

我可以从日志中看到，此代码有时会引发异常，并显示消息“这里的东西为空。a.Count：9，枚举器不为空”。当这种情况开始发生时，它会在每次页面加载时继续发生，直到我 iisreset。

内部异常当然是 System.NullReferenceException，它有这个堆栈跟踪：

```
at MyNamespace.MyClass.MyMethod() in c:\path\MyClass.cs:line 74 
```

其中第 74 行是说`foreach (ElementRelation relation in a)`

为什么会抛出这个异常？

**编辑：**

集合有时由后台线程更新。我认为这不会导致比迭代失败更严重的问题，但事实证明整个集合都已损坏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T15:53:30.930

该类`ObservableCollection<T>`不是线程安全的。从多个线程修改它可能会破坏内部状态，以至于无法修改或枚举实例。

您会随机看到诸如`NullReferenceException`和`IndexOutOfRangeException`- 之类的异常，这是最好的结果！在其他情况下，可以静默删除对集合的更改。

您将需要将您对列表的访问权包装在一个锁中，可能使用[class `ReaderWriterLockSlim`，](http://msdn.microsoft.com/en-us/library/system.threading.readerwriterlockslim.aspx)或者切换到一个线程安全的集合。对于 .NET 4.0，[`System.Collections.Concurrent`命名空间](http://msdn.microsoft.com/en-us/library/system.collections.concurrent.aspx)有多种可能性。

# dozer - 没有为字段调用由 Dozer java API 设置的自定义转换器

> ID：13495225
> 
> 赞同：3
> 
> 时间：2012-11-21T14:18:20.567
> 
> 标签：dozer

我正在使用[Dozer](http://dozer.sourceforge.net/)框架在 Java Bean 之间进行转换。我想使用 Dozer 的 Java Api 而不是 XML 创建我的映射，以便能够操作和配置我的自定义转换器。

如果我在下面的代码中使用替代 1 运行我的转换器，并删除了 alt 2 - xml 文件中的映射，则转换工作正常并且我的自定义转换器被调用。如果我使用备选方案 2 运行转换器 - 使用 java API 进行映射，则映射器永远不会调用我的转换器。bean被转换，但是同类型的嵌套字段被忽略，在下面的代码中，父字段转换后为null。

```
Organization org = ...init organization....
OrganizationDto orgDto = new MyConverter().convert(organization, OrganizationDto.class);
assertEquals(3,orgDto.getParent().getX()) //Fails due to NPE since parent field is not copied 
```

我知道 java API 不支持类级别的自定义转换器，但是字段级别的转换器看起来像是受支持的，因为它是在 java 映射 API[示例](http://dozer.sourceforge.net/documentation/apimappings.html)中提供的。

（我也知道推土机作者建议将推土机用作单例，但这不包括在下面的示例中。）

有什么提示吗？

```
public class OrganizationDto {
   int x;
   OrganizationDto parent ;
   // getters and setters....
}

public class Organization {
   int x;
   Organization parent ;
   // getters and setters....
}

public class MyConverter{

private DozerBeanMapper mapper = null;

public MyConverter() {
        mapper = new DozerBeanMapper();
        // Alternative 1 - works 
//          List<String> myMappingFiles = new ArrayList<String>();
//          myMappingFiles.add("myBeanMappings.xml");
//          mapper.setMappingFiles(myMappingFiles);

        // Alternative 2 - does not work
        Map<String,CustomConverter> customConvertersWithId = new HashMap<String, CustomConverter>();
        customConvertersWithId.put("OrganizationDetailsConverter", new OrganizationDetailsConverter());
        mapper.setCustomConvertersWithId(customConvertersWithId);

        // Also tried variants using
        //mapper.setCustomConverters(Collections.<CustomConverter> singletonList(new OrganizationDetailsConverter()));

        BeanMappingBuilder builder = new BeanMappingBuilder() {
            protected void configure() {
                mapping(OrganizationDto.class, Organization.class)
                .fields("parent",
                        "parent",
                        customConverterId("OrganizationDetailsConverter"));
                }
            };          
            mapper.addMapping(builder);
    }

    public <T, S> T convert(S fromBean, Class<T> toBeanClass) {
    return mapper.map(fromBean, toBeanClass);
    }

}

<?xml version="1.0" encoding="UTF-8"?>
<mappings xmlns="http://dozer.sourceforge.net" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://dozer.sourceforge.net
      http://dozer.sourceforge.net/schema/beanmapping.xsd">
    <mapping>
        <class-a>foo.OrganizationDto</class-a>
        <class-b>foo.Organization</class-b>
        <field custom-converter="foo.OrganizationDetailsConverter">
            <a>parent</a>
            <b>parent</b>
        </field>
    </mapping>
</mappings> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-01-14T17:09:09.877

```
public class DozerMap {

   public static class ContainerA {
      private A a;
      public A getA() { return a; }
      public void setA(A a) { this.a = a; }
   }

   public static class ContainerB {
      private B b;
      public B getB() { return b; }
      public void setB(B b) { this.b = b; }
   }

   private static class A { };

   private static class B { };

   static class ConverterImpl extends DozerConverter<A, B> {

      ConverterImpl() {
         super(A.class, B.class);
      }

      @Override
      public B convertTo(A source, B destination) {
         Logger.getAnonymousLogger().info("Invoked");
         return destination;
      }

      @Override
      public A convertFrom(B source, A destination) {
         Logger.getAnonymousLogger().info("Invoked");
         return destination;
      }
   }

   public static void main(String[] args) {

      DozerBeanMapper mapper = new DozerBeanMapper();
      mapper.setCustomConverters(Collections.<CustomConverter> singletonList(new ConverterImpl()));
      BeanMappingBuilder foo = new BeanMappingBuilder() {

         @Override
         protected void configure() {
            mapping(ContainerA.class, ContainerB.class).fields("a", "b", FieldsMappingOptions.customConverter(ConverterImpl.class));
         }
      };
      mapper.setMappings(Collections.singletonList(foo));
      ContainerA containerA = new ContainerA();
      containerA.a = new A();
      ContainerB containerB = mapper.map(containerA, ContainerB.class);
   }
} 
```

# c# - 多线程串口

> ID：13495231
> 
> 赞同：1
> 
> 时间：2012-11-21T14:18:33.407
> 
> 标签：c#, multithreading, serial-port, modbus

我正在尝试在串行端口中进行多线程。假设我有 X 串口。每个端口都有 Y 个设备（modbus）。我正在从每个设备中取出数据。要从设备中取出数据，我需要发送一条消息，然后等待响应。我想加快应用程序的速度，这就是为什么我想在其中使用多线程。

是否可以在一个串行端口中发送和等待多条消息？

问候
丹尼尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T14:20:26.660

不，这不对。串行端口不会以这种方式组织数据。它只接收字节并允许您以顺序方式取出字节。尝试你的要求是行不通的。如果不是完全错误，您将得到乱码的串行端口数据。只是没有办法说“这些字节属于该消息”。

抱歉，这只是[它们工作方式](http://computer.howstuffworks.com/serial-port.htm)的基本设计。

# java - GoogleApp Engine 在构建 Web 应用程序方面有多好？

> ID：13495234
> 
> 赞同：0
> 
> 时间：2012-11-21T14:18:41.533
> 
> 标签：java, google-app-engine, web-applications

经过相当多的研究，许多博客/帖子/教程已经过时了。我不知道 Google App 引擎现在是否足以构建一个 webapp。仅将 Java 视为一种语言。有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T14:25:32.120

GAE 绝对是生产就绪的，并且已经有很长时间了。但是是否适合您的需求的选择取决于您的需求。作为一个完整且不灵活的堆栈，通过致力于 GAE，您将自己限制在它提供的功能上。你确实得到了很多回报。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T14:24:42.150

Google App Engine中有[超过十万个应用](http://www.bitcurrent.com/how-many-google-app-engine-apps-are-there/)程序。所以是的，我想它已经足够稳定了。:)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T14:42:37.873

看看 Udacity 的这篇博文。他们围绕谷歌应用引擎开发了一个网络开发课程：

[http://googleappengine.blogspot.nl/2012/10/teaching-thousands-of-students-to.html](http://googleappengine.blogspot.nl/2012/10/teaching-thousands-of-students-to.html)

还有这个视频群聊：[https ://developers.google.com/live/shows/9826022/](https://developers.google.com/live/shows/9826022/)

# cookies - haproxy 和粘性会话

> ID：13495235
> 
> 赞同：2
> 
> 时间：2012-11-21T14:18:44.380
> 
> 标签：cookies, haproxy

我需要在我的 haproxy(1.4) 上进行粘性会话。在我的后端配置下方。

> ```
>  cookie SRVSTICKY insert indirect nocache
>       server server1 192.162.20.1:80 check cookie s1
>       server server2 192.162.20.2:80 check cookie s2 
> ```

这很好，但在客户端不接受 cookie 的情况下，我的网页的加载不起作用。我尝试添加没有 cookie 的第三台服务器来重定向这些客户端（如默认服务器）。但这不起作用。

您是否有一个想法，将阻止 cookie 会话的客户端重定向到默认服务器？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T18:30:44.623

与 cookie 不兼容的客户端打交道的人通常使用源地址，因为这两个功能中至少有一个通常可以工作（例如：某些不支持 cookie 的支付终端或 Web 服务客户端将具有固定地址）。

# ruby-on-rails - 是否有一种简单/标准的方法可以将前端构建工具添加到 Rails 应用程序？

> ID：13495239
> 
> 赞同：0
> 
> 时间：2012-11-21T14:18:49.730
> 
> 标签：ruby-on-rails, build-automation, frontend

我最近被转移到了一个 Ruby on Rails (2.x) 项目，我正在尝试添加一些构建工具来提高前端代码质量。理想情况下，我想为 JavaScript 和 CSS 添加 linting，以及一个单元测试框架（最好是[Mocha](http://visionmedia.github.com/mocha/)）。

我习惯于使用 Node 或 PHP 应用程序，在这些应用程序中，我通常只需将我需要的库指定为 npm 依赖项。我不知道这里的“Rails 方式”是什么。

我想知道是否有事实上的标准，以及您在 Rails 应用程序中使用哪些工具来检查/测试前端代码。如果对我来说使用 Node 来处理这些东西仍然最有意义（为 deps 添加一个 package.json 和一个像[Jake](https://github.com/mde/jake)这样的 JS 工具），那很好。

# java - 为什么 lucene 单字符通配符查询找到的文档比完全指定通配符时少？

> ID：13495243
> 
> 赞同：3
> 
> 时间：2012-11-21T14:19:01.510
> 
> 标签：java, lucene

我有一个包含值`abc`和`def`分析器默认字段的索引，属于两个不同的文档。当我执行查询时`abc OR def`，我得到了索引中两个文档的命中。但是当我使用时，`abc OR d?f`我只会对包含`abc`. 当我查询索引时，`d?f`我得到了包含`def`.

当我查看解析后的查询时，`abc OR d?f`我看到了正确的结果。这意味着将 a`BooleanQuery`解析`WildcardQuery`为第二个子句。

难道我做错了什么？

在我的应用程序中，我在上面指定的上面还有另一个布尔子句。这匹配与上面指定的字段不同的字段。所以在我的情况下，一个完整的查询是：`user:john AND (abc OR d?f)`. 但是我索引中的所有文档都包含`john`在该`user`字段中。所以这不应该是问题。

我正在使用 lucene 3.0.3。

**编辑：**
我使用[luke](http://www.getopt.org/luke/)查看了索引。在那里，我看到在重写的查询中，该术语`d?f`被替换为`()`. 知道很明显查询只会匹配`abc`. 但是为什么重写查询时要替换通配符呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T07:14:49.677

这只是我的错。测试场景中使用的数据有点复杂。所以这个词`abc`在索引中出现了多次。但我只从索引中获取了得分最高的 10 个文档。由于查询`abc`之前`d?f`与最高分匹配，因此这些结果是第一位的。因此`def`查询未找到包含的文档。

# slf4j - SLF4J 绑定错误

> ID：13495245
> 
> 赞同：1
> 
> 时间：2012-11-21T14:19:05.300
> 
> 标签：slf4j, mahout

我是 mahout 的新手，我正在努力将它安装在我的 ubuntu 12.10 上。正如我看到的许多与 SLF4J 和 Eclipse 相关的问题，我提到我不使用 Eclipse。

Maven 编译工作正常。(mvn install -DskipTests=true)

我想我已经正确设置了我的环境变量，这是我的 /etc/environment ：

```
PATH="/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/usr/lib/jvm/java-1.6.0-openjdk-amd64/bin:/usr/local/hadoop/bin"
JAVA_HOME=/usr/lib/jvm/java-1.6.0-openjdk-amd64/
MAHOUT_HOME=/home/edelans/mahout/
HADOOP_HOME=/usr/local/hadoop/
HADOOP_CONF_DIR=/usr/local/hadoop/conf 
```

当我开始尝试运行一些示例脚本时，我开始遇到一些错误：

```
root@edelans-ubuntu-master:/home/edelans/mahout/examples/bin# ./cluster-reuters.sh 
Please select a number to choose the corresponding clustering algorithm
1\. kmeans clustering
2\. fuzzykmeans clustering
3\. dirichlet clustering
4\. minhash clustering
Enter your choice : 1
ok. You chose 1 and we'll use kmeans Clustering
creating work directory at /tmp/mahout-work-root
MAHOUT_LOCAL is set, so we don't add HADOOP_CONF_DIR to classpath.
MAHOUT_LOCAL is set, running locally
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/home/edelans/mahout/examples/target/mahout-examples-0.8-SNAPSHOT-job.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/edelans/mahout/examples/target/dependency/slf4j-jcl-1.7.2.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/home/edelans/mahout/examples/target/dependency/slf4j-log4j12-1.4.3.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: slf4j-api 1.6.x (or later) is incompatible with this binding.
SLF4J: Your binding is version 1.5.5 or earlier.
SLF4J: Upgrade your binding to version 1.6.x.
Exception in thread "main" java.lang.NoSuchMethodError: org.slf4j.impl.StaticLoggerBinder.getSingleton()Lorg/slf4j/impl/StaticLoggerBinder;
    at org.slf4j.LoggerFactory.bind(LoggerFactory.java:128)
    at org.slf4j.LoggerFactory.performInitialization(LoggerFactory.java:107)
    at org.slf4j.LoggerFactory.getILoggerFactory(LoggerFactory.java:295)
    at org.slf4j.LoggerFactory.getLogger(LoggerFactory.java:269)
    at org.slf4j.LoggerFactory.getLogger(LoggerFactory.java:281)
    at org.apache.mahout.driver.MahoutDriver.<clinit>(MahoutDriver.java:89)
Could not find the main class: org.apache.mahout.driver.MahoutDriver. Program will exit.
Running on hadoop, using /usr/local/hadoop/bin/hadoop and HADOOP_CONF_DIR=
MAHOUT-JOB: /home/edelans/mahout/examples/target/mahout-examples-0.8-SNAPSHOT-job.jar
12/11/21 14:48:23 INFO vectorizer.SparseVectorsFromSequenceFiles: Maximum n-gram size is: 1
12/11/21 14:48:23 INFO vectorizer.SparseVectorsFromSequenceFiles: Minimum LLR value: 1.0
12/11/21 14:48:23 INFO vectorizer.SparseVectorsFromSequenceFiles: Number of reduce tasks: 1
12/11/21 14:48:24 INFO mapred.JobClient: Cleaning up the staging area hdfs://localhost:54310/app/hadoop/tmp/mapred/staging/root/.staging/job_201211211039_0002
12/11/21 14:48:24 ERROR security.UserGroupInformation: PriviledgedActionException as:root cause:org.apache.hadoop.mapreduce.lib.input.InvalidInputException: Input path does not exist: hdfs://localhost:54310/tmp/mahout-work-root/reuters-out-seqdir
Exception in thread "main" org.apache.hadoop.mapreduce.lib.input.InvalidInputException: Input path does not exist: hdfs://localhost:54310/tmp/mahout-work-root/reuters-out-seqdir
    at org.apache.hadoop.mapreduce.lib.input.FileInputFormat.listStatus(FileInputFormat.java:235)
    at org.apache.hadoop.mapreduce.lib.input.SequenceFileInputFormat.listStatus(SequenceFileInputFormat.java:55)
    at org.apache.hadoop.mapreduce.lib.input.FileInputFormat.getSplits(FileInputFormat.java:252)
    at org.apache.hadoop.mapred.JobClient.writeNewSplits(JobClient.java:962)
    at org.apache.hadoop.mapred.JobClient.writeSplits(JobClient.java:979)
    at org.apache.hadoop.mapred.JobClient.access$600(JobClient.java:174)
    at org.apache.hadoop.mapred.JobClient$2.run(JobClient.java:897)
    at org.apache.hadoop.mapred.JobClient$2.run(JobClient.java:850)
    at java.security.AccessController.doPrivileged(Native Method)
    at javax.security.auth.Subject.doAs(Subject.java:416)
    at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1121)
    at org.apache.hadoop.mapred.JobClient.submitJobInternal(JobClient.java:850)
    at org.apache.hadoop.mapreduce.Job.submit(Job.java:500)
    at org.apache.hadoop.mapreduce.Job.waitForCompletion(Job.java:530)
    at org.apache.mahout.vectorizer.DocumentProcessor.tokenizeDocuments(DocumentProcessor.java:93)
    at org.apache.mahout.vectorizer.SparseVectorsFromSequenceFiles.run(SparseVectorsFromSequenceFiles.java:255)
    at org.apache.hadoop.util.ToolRunner.run(ToolRunner.java:65)
    at org.apache.hadoop.util.ToolRunner.run(ToolRunner.java:79)
    at org.apache.mahout.vectorizer.SparseVectorsFromSequenceFiles.main(SparseVectorsFromSequenceFiles.java:55)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:616)
    at org.apache.hadoop.util.ProgramDriver$ProgramDescription.invoke(ProgramDriver.java:68)
    at org.apache.hadoop.util.ProgramDriver.driver(ProgramDriver.java:139)
    at org.apache.mahout.driver.MahoutDriver.main(MahoutDriver.java:195)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:616)
    at org.apache.hadoop.util.RunJar.main(RunJar.java:156) 
```

[另一个用户在这里](https://stackoverflow.com/questions/12773694/playframework-multiple-slf4j-bindings?answertab=votes#tab-top)遇到了类似的问题，但我不知道如何编写回答他问题的代码行：

```
"org.apache.mahout" % "mahout-core" % "0.7" excludeAll(ExclusionRule(organization = "org.slf4j")) 
```

而且我无权评论他的问题......很抱歉为此提出另一个问题。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T15:34:51.213

堆栈跟踪中描述了该问题。您正在项目中混入更旧版本的 slf4j。不要那样做。如果它来自第三方，则需要将其排除在外。

```
SLF4J: Found binding in [jar:file:/home/edelans/mahout/examples/target/dependency/slf4j-log4j12-1.4.3.jar!/org/slf4j/impl/StaticLoggerBinder.class] 
```

# c# - 特殊字符的 XML 格式

> ID：13495252
> 
> 赞同：0
> 
> 时间：2012-11-21T14:19:40.730
> 
> 标签：c#, xml

1.  哪些特殊字符会破坏 XML？

例如，如果值中没有特殊字符，则以下 xml 有效。但是当我有 & 签名时失败。我尝试使用 CDATA 语法 ( `<![CDATA[CITY & COUNTY]]>`) 包装该值，但得到“解析 CDATA 时出现意外的文件结尾。第 44 行，位置 122”

```
<Method ID="5">         
    <Field Type="Text" Name="Company" DisplayName="Company Name" FromBaseType="TRUE" >
        <Default>Rob & Schnider Company</Default>
    </Field> 
</Method> 
```

附加信息（如果需要）：我正在使用 SharePoint 2010，它是用于为文档库中的某些列设置默认值的 Web 服务。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T15:36:39.410

实际上，由于我将 Nintex 用于工作流程，因此有一个功能可以处理特殊字符。您所做的就是用函数包装值。

```
fn-XmlEncode 
```

对字符串进行编码以使其在 html 中可以安全查看。

例子

```
fn-XmlEncode({WorkflowVariable:Text}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T15:15:07.877

没有很多。您必须在 xml 中转义 5 个字符。

```
&   &amp;   Ampersand sign
'   &apos;  Single quote
"   &quot;  Double quote
>   &gt;    Greater than
<   &lt;    Less than 
```

只需将您的更改`&`为 a `&amp;`，它应该可以工作。

如果您使用 ac# XML 库解析它，它应该知道如何处理转义序列。

[http://www.rtslink.com/introductionxmlsoap.html](http://www.rtslink.com/introductionxmlsoap.html)

# java - 用于乘法矩阵的同步线程

> ID：13495254
> 
> 赞同：4
> 
> 时间：2012-11-21T14:19:42.150
> 
> 标签：java, multithreading, synchronization, matrix-multiplication

我整晚都在研究这个，还没有找到解决方案，所以如果有人能帮助我，我会非常感激！我可能遗漏了一些非常明显的东西。这是一个理解同步的分配，我们在之前的分配中使用线程来乘以 2 个矩阵。在之前的分配中，每个线程乘以一行，因此线程数与行数一样多。

在这个分配中，我们只应该使用 5 个线程——所有线程都应该从一行/列开始，一旦线程完成，它应该使用同步选择下一个可用的行/列，所以现在两个线程将最终执行同一列。

[这个问题](https://stackoverflow.com/questions/10459258/multithreading-why-one-thread-is-doing-all-of-the-work)帮助我找到了正确的方向，但我必须在实施中做错了，因为到目前为止我只得到了程序：

1.  只做前 5 行——5 个线程执行一次，每个线程计算一行或
2.  我添加了一个循环（现在在我的代码中被注释掉了），所以线程会继续执行，但是当我这样做时，只有第一个线程做任何工作。

这是我的主要方法和几个辅助方法的课程：

```
import java.io.FileWriter;
import java.io.IOException;
import java.io.PrintWriter;
import java.util.Random;
import java.util.Scanner;
import java.util.concurrent.Semaphore;
import java.util.concurrent.locks.Lock;

public class MatrixMult {

public static void main(String[] args){
    int[][] matrixA;
    int[][] matrixB;
    int colA = 0;
    int rowA = 0;
    int colB = 0;
    int rowB = 0;
    Scanner userInput = new Scanner( System.in );
    System.out.println("Please enter the dimensions of matrix A");

    do{
        System.out.print("column for matrix A: ");
        colA = userInput.nextInt();
        System.out.println();
    } while(!validDimension(colA));

    rowB = colA;

    do{
        System.out.print("row for matrix A: ");
        rowA = userInput.nextInt();
        System.out.println();
    } while(!validDimension(rowA));

    matrixA = new int[rowA][colA];

    System.out.println("Please enter the dimensions of matrix B:");
    do{
        System.out.print("column for matrix B: ");
        colB = userInput.nextInt();
        System.out.println();
    } while(!validDimension(colB));

    matrixB = new int[rowB][colB];

    fillMatrix(matrixA);
    fillMatrix(matrixB);

    System.out.println("Would you like to print out matrix A and B? (y/n)");
    String userResponse = userInput.next();
    if(userResponse.equalsIgnoreCase("y")){
        System.out.println("Matrix A:");
        printBackMatrix(matrixA);
        System.out.println();
        System.out.println("Matrix B:");
        printBackMatrix(matrixB);
        System.out.println();
    }

    int[][] matrixProduct3 = multMatrixWithThreadsSync(matrixA, matrixB);

    String fileName = "C:/matrix.txt";
    System.out.println("Matrix product is being written to "+fileName);
    try {
        printMatrixToFile(matrixProduct3, fileName);
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
}

private static int[][] multMatrixWithThreadsSync(int[][] matrixA, int[][] matrixB) {

    int[][] matrixProduct = new int[matrixA.length][matrixB[0].length];
    int[] matrixProductColumn = new int[matrixA.length];

    Runnable task = new MultMatrixByRow(matrixA, matrixB, matrixProduct);

    for(int i=0; i<5; i++){

        Thread worker = new Thread(task);
        worker.start();
//          System.out.println(worker.getName());
        try {
            worker.join();
        } catch (InterruptedException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }
    return matrixProduct;
}

private static void printMatrixToFile(int[][] matrix, String fileName) throws IOException{
    PrintWriter userOutput = new PrintWriter(new FileWriter(fileName));
    for(int i=0; i<matrix.length; i++){
        for(int j=0; j<matrix[0].length; j++){
            userOutput.print(matrix[i][j]+" ");
        }
        userOutput.println();
    }
    userOutput.close();

}

private static void printBackMatrix(int[][] matrix) {
    for(int i=0; i<matrix.length; i++){
        for(int j=0; j<matrix[0].length; j++){
            System.out.print(matrix[i][j]+" ");
        }
        System.out.println();
    }
}

private static void fillMatrix(int[][] matrix) {
    Random rand = new Random();

    for(int i=0; i<matrix.length; i++){
        for(int j=0; j<matrix[0].length; j++){
            matrix[i][j] = rand.nextInt(100) + 1;
        }
    }

}

public static boolean validDimension(int dim){
    if (dim <= 0 || dim >1000){
        System.err.println("Dimension value entered is not valid");
        return false;
    }
    return true;

}
} 
```

这是我的可运行类：

```
public class MultMatrixByRow implements Runnable {
private int i;
private int[][] matrixA;
private int[][] matrixB;
private int[][] matrixProduct;

public MultMatrixByRow(int[][] A, int[][] B, int[][] C) {
    this.matrixA = A;
    this.matrixB = B;
    this.matrixProduct = C;
}

@Override   
public void run(){
//      while(i < matrixProduct.length){
        int rowToWork = 0;
        synchronized (this){
 //             System.out.println("i is "+i);
            if ( i < matrixProduct.length){
                rowToWork = i;
                i++;
            }
            else{
                return;
            }
        }
        for(int j = 0; j < matrixB[0].length; j++){
            for(int k=0; k < matrixA[0].length; k++){
                matrixProduct[rowToWork][j] += matrixA[rowToWork][k]*matrixB[k][j];
            }
        }
//      }
        }
    } 
```

再次 - 任何帮助将不胜感激！非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T14:41:09.647

1.  您没有在资源上同步，您需要共享一个锁对象（在静态上下文中或通过构造函数）
2.  当你甚至不让它们同步工作时，我真的无法弄清楚你的程序中应该同步什么......你启动一个线程并直接等待他停止。我认为您必须首先启动它们，然后在另一个循环中调用每个线程上的连接。

另外，我不太确定您的线程应该单独解决什么问题，我认为它们都可以解决整个产品矩阵。您需要共享一个变量，用于识别您同步访问的已处理行。

我可以修复您的代码，但我希望您自己完成这项工作，因为这是一项了解线程并发性的任务。

编辑：同步的解释：
同步将对象作为锁，只有一个线程可以为它保存监视器。当有锁的监视器时，线程可以处理该块，如果没有，他必须等待获得监视器。
在您的情况下，您可以`private static final Object lock = new Object();`用作锁，您将同步。

编辑 2：我完全构建了您的代码
我并不为完成您的所有工作而感到自豪，但没关系，就在这里。

```
package anything.synchronize_stackoverflow_post;

/**
 * @date 21.11.2012
 * @author Thomas Jahoda
 */
public class ConcurrentMatrixMultiplyingTask implements Runnable {

    private int[][] matrixA;
    private int[][] matrixB;
    private int[][] matrixProduct;
    //
    private final ConcurrencyContext context;

    public ConcurrentMatrixMultiplyingTask(ConcurrencyContext context, int[][] A, int[][] B, int[][] C) {
        if (context == null) {
            throw new IllegalArgumentException("context can not be null");
        }
        this.context = context;
        this.matrixA = A;
        this.matrixB = B;
        this.matrixProduct = C;
    }

    @Override
    public void run() {
        while (true) {
            int row;
            synchronized (context) {
                if (context.isFullyProcessed()) {
                    break;
                }
                row = context.nextRowNum();
            }
            System.out.println(Thread.currentThread().getName() + " is going to process row " + row);
            // i'm not really sure if this matrix algorithm here is right, idk..
            for (int j = 0; j < matrixB[0].length; j++) {
                for (int k = 0; k < matrixA[0].length; k++) {
                    matrixProduct[row][j] += matrixA[row][k] * matrixB[k][j];
                }
            }
        }
    }

    public static class ConcurrencyContext {

        private final int rowCount;
        private int nextRow = 0;

        public ConcurrencyContext(int rowCount) {
            this.rowCount = rowCount;
        }

        public synchronized int nextRowNum() {
            if (isFullyProcessed()) {
                throw new IllegalStateException("Already fully processed");
            }
            return nextRow++;
        }

        public synchronized boolean isFullyProcessed() {
            return nextRow == rowCount;
        }
    }
} 
```

和处理任务

```
package anything.synchronize_stackoverflow_post;

import java.io.FileWriter;
import java.io.IOException;
import java.io.PrintWriter;
import java.util.Random;
import java.util.Scanner;
import java.util.logging.Level;
import java.util.logging.Logger;

/**
 * @date 21.11.2012
 * @author Thomas Jahoda
 */
public class MatrixMulti {

    public static void main(String[] args) {
        int[][] matrixA;
        int[][] matrixB;
        int colA = 0;
        int rowA = 0;
        int colB = 0;
        int rowB = 0;
        Scanner userInput = new Scanner(System.in);
        System.out.println("Please enter the dimensions of matrix A");

        do {
            System.out.print("column for matrix A: ");
            colA = userInput.nextInt();
            System.out.println();
        } while (!validDimension(colA));

        rowB = colA;

        do {
            System.out.print("row for matrix A: ");
            rowA = userInput.nextInt();
            System.out.println();
        } while (!validDimension(rowA));

        matrixA = new int[rowA][colA];

        System.out.println("Please enter the dimensions of matrix B:");
        do {
            System.out.print("column for matrix B: ");
            colB = userInput.nextInt();
            System.out.println();
        } while (!validDimension(colB));

        matrixB = new int[rowB][colB];

        fillMatrix(matrixA);
        fillMatrix(matrixB);

        System.out.println("Would you like to print out matrix A and B? (y/n)");
        String userResponse = userInput.next();
        if (userResponse.equalsIgnoreCase("y")) {
            System.out.println("Matrix A:");
            printBackMatrix(matrixA);
            System.out.println();
            System.out.println("Matrix B:");
            printBackMatrix(matrixB);
            System.out.println();
        }

        int[][] matrixProduct3 = multMatrixWithThreadsSync(matrixA, matrixB);

        String fileName = "test.txt";
        System.out.println("Matrix product is being written to " + fileName);
        try {
            printMatrixToFile(matrixProduct3, fileName);
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
    }

    private static int[][] multMatrixWithThreadsSync(int[][] matrixA, int[][] matrixB) {

        int[][] matrixProduct = new int[matrixA.length][matrixB[0].length];
        int[] matrixProductColumn = new int[matrixA.length];
        //
        ConcurrentMatrixMultiplyingTask.ConcurrencyContext context = new ConcurrentMatrixMultiplyingTask.ConcurrencyContext(matrixProduct.length);
        //
        Runnable task = new ConcurrentMatrixMultiplyingTask(context, matrixA, matrixB, matrixProduct);
        Thread[] workers = new Thread[5];
        for (int i = 0; i < workers.length; i++) {
            workers[i] = new Thread(task, "Worker-"+i);
        }
        for (int i = 0; i < workers.length; i++) {
            Thread worker = workers[i];
            worker.start();
        }
        for (int i = 0; i < workers.length; i++) {
            Thread worker = workers[i];
            try {
                worker.join();
            } catch (InterruptedException ex) {
                Logger.getLogger(MatrixMulti.class.getName()).log(Level.SEVERE, null, ex);
            }
        }
        return matrixProduct;
    }

    private static void printMatrixToFile(int[][] matrix, String fileName) throws IOException {
        PrintWriter userOutput = new PrintWriter(new FileWriter(fileName));
        for (int i = 0; i < matrix.length; i++) {
            for (int j = 0; j < matrix[0].length; j++) {
                userOutput.print(matrix[i][j] + " ");
            }
            userOutput.println();
        }
        userOutput.close();

    }

    private static void printBackMatrix(int[][] matrix) {
        for (int i = 0; i < matrix.length; i++) {
            for (int j = 0; j < matrix[0].length; j++) {
                System.out.print(matrix[i][j] + " ");
            }
            System.out.println();
        }
    }

    private static void fillMatrix(int[][] matrix) {
        Random rand = new Random();

        for (int i = 0; i < matrix.length; i++) {
            for (int j = 0; j < matrix[0].length; j++) {
                matrix[i][j] = rand.nextInt(100) + 1;
            }
        }

    }

    public static boolean validDimension(int dim) {
        if (dim <= 0 || dim > 1000) {
            System.err.println("Dimension value entered is not valid");
            return false;
        }
        return true;

    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T18:43:56.480

要解决您的问题，您需要定义什么是“工作单元”。这个“工作单元”（或任务）是每个线程将要执行的。定义好之后，您可以推断该工作单元需要什么来完成其工作。

在矩阵乘法的情况下，工作的自然单位是结果矩阵的每个单元。因此，给定矩阵 A[i,j] 和 B[j,k]，您的计算可以集中在向量 A.row(x) (dot) B.column(y) 的点积上`(0<=x<i,0<=y<k)`。

下一步是表示每个任务。将任务“提供”给线程的理想结构是队列。[java.util.concurrent.BlockingQueue](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/BlockingQueue.html)就是这样一个例子，同步工作是在后台完成的。鉴于您被要求“手动”推理同步，您可以使用另一个容器，如 List（甚至是数组）。您的结构将包含定义结果矩阵的每个单元格。可能是这样的：

```
class Cell;  // int x, int y, getters, setters, ...
// build the structure that contains the work to be shared
List<Cell> cells = new LinkedList<Cell>();
for (int i=0;i<a.rows;i++) {
   for (int j=0;j<b.columns;j++) {
       cells.add(new Cell(i,j)); // represent the cells of my result matrix
   }
} 
```

现在，您需要一个任务，给定一个单元格和矩阵 A 和 B，可以计算该单元格的值。这是您的工作单元，因此是在线程上下文中运行的。在这里，您还需要决定是否要放置结果。在 java 中，您可以使用期货并在线程上下文之外组装矩阵，但为了简单起见，我将共享一个保存结果的数组。（因为，根据定义，不会有任何碰撞）

```
class DotProduct implements Runnable {
 int[][] a;
 int[][] b;
 int[][] result; 
 List<Cell> cells;
 public DotProduct(int[][] a, int[][] b, int[][]result, List<Cell> cells) {
 ...
 }
 public void run() {
     while(true) {
         Cell cell = null;
         synchronized(cells) { // here, we ensure exclusive access to the shared mutable structure
             if (cells.isEmpty()) return; // when there're no more cells, we are done.
             Cell cell = cells.get(0); // get the first cell not calculated yet
             cells.remove(cell);  // remove it, so nobody else will work on it
         }
         int x = cell.getX();
         int y = cell.getY();
         z = a.row(x) (dot) b.column(y);
         synchronized (result) {
             result[x][y] = z;
         }
     }
} 
```

现在你几乎完成了。您唯一需要做的就是创建线程，用`DotProduct`任务“喂它们”并等待它们完成。请注意，我同步`result`更新了结果矩阵。尽管根据定义，不可能同时访问同一个单元格（因为每个线程都在不同的单元格上工作），但您需要通过显式同步对象来确保结果“安全地发布”到其他线程。这也可以通过声明来完成，`result` `volatile`但我不确定你是否已经涵盖了这一点。

希望这有助于理解如何处理并发问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T14:44:23.520

您使用所有范围的同步原语：信号量、锁定、同步。最好只从同步开始，学习东西。您实际需要的是指示要处理的下一行/列（如果有）的资源。所有线程使用同步块访问它，读取下一行/列，将行/列移动到下一个单元格，退出块，并处理获得的行/列。

如果满足矩阵的结尾，则工作线程简单地退出。主线程使用 Thread.join() 等待所有工作线程退出。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T15:22:52.353

你真的误解了你上一个问题的答案。`rowToWork`需要在线程之间共享。一个线程可能应该在构造时调用一个方法来获取它的初始值。您需要了解您的[关键部分](https://stackoverflow.com/questions/5607157/what-exactly-is-a-critical-section)是下一行对给定线程的归属。

# sharepoint - Web 分析 Web 部件在热门内容列表中显示同一文档的多个副本

> ID：13495255
> 
> 赞同：1
> 
> 时间：2012-11-21T14:19:42.553
> 
> 标签：sharepoint, sharepoint-2010, web-analytics

我在我们的 SP 2010 环境中添加并配置了一个 Web 分析 Web 部件。Web 部件用于显示网站集中查看频率最高的 10 个文档。然而，它似乎在文件上加倍。因此，如果我打开一个文档 3 次，则表明它被打开了 3 次。有没有人见过这个并知道原因？难道只是因为它是全新的，还没有积累很多资料吗？

任何投入将不胜感激。我发布了一张图片来说明我的意思：

![在此处输入图像描述](../Images/0e64d917d42da326254358835ad408a8.png)

# android - 如何每 1 分钟更新一次主片段列表

> ID：13495257
> 
> 赞同：-1
> 
> 时间：2012-11-21T14:19:47.703
> 
> 标签：android, android-fragments

我在活动中有一个主细节片段。Master Fragment 有一个从 Sqlite DB 查询的动态列表。如何每 1 分钟更新一次主片段列表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T14:25:52.150

您可以使用 Handler 及其`postDelayed()`触发 Runnable 来完成这项工作。一旦工作完成，可运行文件将再次延迟触发。伪代码：

```
Handler mHandler = new Handler(); 
```

在代码中，启动雪崩：

```
mHandler.postDelayed( mRunnable, 60*1000 ); 
```

并且可以运行

```
Runnable mRunnable = new Runnable() {
   public void run() {
      // do your job

      mHandler.postDelayed( this, 60*1000 );
   }
} 
```

# c# - 如何修复此正则表达式？（如何获得共享一个单词的重叠匹配？）

> ID：13495263
> 
> 赞同：1
> 
> 时间：2012-11-21T14:20:03.893
> 
> 标签：c#, regex, expression

我正在尝试使用正则表达式构造文本 - 以以下示例格式拆分和分组所有管理器：

```
General MANAGER
John Doe
(123) 456 7890
abcdefg@netcare.co.za
Nursing MANAGER
John Doe
(123) 456 7890
abcdefg@netcare.co.za
Financial MANAGER
John Doe
(123) 456 7890
Human Resource MANAGER
John Doe (Acting)
(123) 456 7890
abcdefg@netcare.co.za
Marketing OFFICER
John Doe
abcdefg@netcare.co.za
Pharmacy MANAGER
John Doe
(123) 456 7890
abcdefg@netcare.co.za
Technical Services MANAGER
John Doe
(123) 456 7890
abcdefg@netcare.co.za 
```

我试过了

```
(?<FOUND>^.*?(manager|officer)+.*?)(manager|officer)+ 
```

期望它对这样的项目进行分组：

```
General Manager
John Doe
(123) 456 7890
abcdefg@netcare.co.za 
```

但它并不完全有效。任何正则专家可以告诉我如何解决它？

我正在使用[http://regexhero.net/tester/](http://regexhero.net/tester/)进行选项测试：CultureInvariant、ExplicitCapture、IgnoreCase、Multiline、SingleLine

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T22:06:39.070

使用 RegexOptions.Multiline | 正则表达式选项.IgnoreCase

```
 ^(?<Title>.*(?:Manager|Officer)).*\n(?<Name>.*)(?:\n(?!.*(?:Manager|Officer))(?<Detail>.*))+$ 
```

见：[http ://regexhero.net/tester/?id=1ac1bd9f-be0a-4bea-ac01-cc32a6605ae7](http://regexhero.net/tester/?id=1ac1bd9f-be0a-4bea-ac01-cc32a6605ae7)

使用检索值

```
Match.Groups["Name"].Value
Match.Groups["Title"].Value
Match.Groups["Detail"].Captures[1..n].Value 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T14:33:14.790

如果文件中的最后一个字符是换行符，您可能想在正则表达式的*末尾尝试肯定的前瞻断言。*查找以 manager 或 officer 开头并且前面有 manager 或 officer 行或 EOF 的所有块。

```
(^.*?(manager|officer)(.*?$)*?)(?=(^.*?(manager|officer))|\Z) 
```

但是，如果除了在新块开始时块数据结束这一事实之外真的没有其他结构，我个人更喜欢以下老式方法：

```
# WARNING: pseudocode 
managers = []
for line in file:
    if 'manager' in line or 'officer' in line: 
        manager = new Manager(line)
        managers.append(manager)
    else:
        manager.set_data(line) 
```

# php - 来自 jQuery AJAX 帖子的多次返回

> ID：13495264
> 
> 赞同：0
> 
> 时间：2012-11-21T14:20:04.673
> 
> 标签：php, jquery, ajax, post

让我快速解释一下我的工作，我有多个 jQuery AJAX 帖子正在返回不同的结果。这是我目前正在做的事情：

**JavaScript**

```
$("select#be_betrieb")
  .change(function() {

    $.ajax({
      type: "POST",
      url: "/functions/antragsformulare_benutzer.inc.php",
      data: { action: "getkst", bkuerzel: $(this).val() },
      success: function(data) {
        $("select#be_kostenstelle").attr('disabled',false);             
        $("select#be_kostenstelle").html(data);
      }
    });

    $.ajax({
      type: "POST",
      url: "/functions/antragsformulare_benutzer.inc.php",
      data: { action: "getcompnames", bkuerzel: $("select#be_betrieb").val() },
      success: function(data) {             
        $("select#be_arbeitsplatzbestehend").html(data);
      }
    });
  }); 
```

如您所见，我对同一个 PHP 文件进行了两次发布，只是定义了不同的操作。由于我对该文件还有其他几篇文章（大约 6 篇）要做，我想知道是否还有其他方法可以做到这一点？

我希望你们能理解我的问题。我期待着您的意见。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T08:43:47.113

根据您的输入，我更改了代码，如果可以的话，您可以再看看吗？

**Javascript**

```
$("select#be_betrieb")
        .change(function() {

            $.ajax({
                type: "POST",
                url: "/functions/antragsformulare_benutzer.inc.php",
                dataType: "json",
                data: 
                    { 
                        actions: [
                                    {action: "getkst", bkuerzel: $(this).val()},
                                    {action: "getcompnames", bkuerzel: $(this).val()}
                                 ]
                    },
                success: function(data)
                    {
                        for (var i = 0; i<data.length; i++)
                        {
                            switch(data[i]["action"])
                            {
                                case "getkst":
                                    alert(data[i]["queryresult"]);
                                    break;

                                case "getcompnames":
                                    alert(data[i]["queryresult"]);
                                    break;
                            }
                        }
                    }
            }); 
```

**PHP**

```
if ( $_POST['actions'] != "" )
{
foreach ($_POST['actions'] as $action)
{
    switch ($action['action'])
    {
        case "getkst":

            $queryresult = "here something to return";

            $results[] = array('action' => 'getkst', 'queryresult' => $queryresult);
            break;

        case "getcompnames":

            $queryresult = "here something to return";

            $results[] = array('action' => 'getcompnames', 'queryresult' => $queryresult);
            break;
    }
}

echo json_encode($results);
} 
```

到目前为止非常感谢！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-25T09:21:56.240

您可以使用自动为您执行此操作的库，甚至在完成后链接 AJAX 响应，但不是在客户端执行此操作，而是从服务器端调用 ajax 函数。使用 phery 库 ( [http://phery-php-ajax.net](http://phery-php-ajax.net) )，您可以从服务器完成所有操作：

```
<select data-remote="getkst" name="bkuerzel" data-target="/functions/antragsformulare_benutzer.inc.php">
   // fill your options here
</select> 
```

在你的`antragsformulare_benutzer.inc.php`文件中

```
function getcompnames($data){
  $r = new PheryResponse;  
  // get your comp names here. If you are appending to a select, use
  $r->jquery('select#be_arbeitsplatzbestehend')->html($html_content);
  return $r;
}

function getkst($data){
  $r = new PheryResponse; 
  $html_content = set_your_html_content();

  $r
  ->jquery('select#select#be_kostenstelle')
  ->removeAttr('disabled')->html($html_content);
  // you could do
  // $r->phery_remote('getcompnames', array('bkuerzel' => $data['bkuerzel']), array('target' => '/functions/antragsformulare_benutzer.inc.php'));
  // to call a second ajax when this one is completed, but it's best to merge the response from getcompnames and keep it all in one single AJAX call
  return $r->merge(getcompnames());
}

Phery::instance()->set(array(
  'getkst' => 'getkst',
  'getcompnames' => 'getcompnames'
))->process(); 
```

如您所见，您可以调用第二个 AJAX 响应，或者合并两个答案，我认为这对您来说是最好的选择，并保存一个 AJAX 调用；）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T14:38:20.737

一旦您将所有这些请求一一发送到同一页面，我认为最好执行以下操作：

```
$.ajax({
      type: "POST",
      url: "/functions/antragsformulare_benutzer.inc.php",
      dataType:'json',
      data: {actions: [{action: "getkst", bkuerzel: $(this).val()},
                       {action: "getcompnames", bkuerzel: $("select#be_betrieb").val()},
                       ...] },
      success: function(data) {
        for(var i = 0;i<data.length;i++) {
            switch(data[i]["action"]) {
                case "getkst":
                    $("select#be_kostenstelle").attr('disabled',false);             
                    $("select#be_kostenstelle").html(data[i].resultHTML);
                    break;
                case "getcompnames":
                    $("select#be_arbeitsplatzbestehend").html(data[i].resultHTML);
                    break;
            }
        }
      }
    }); 
```

在您`/functions/antragsformulare_benutzer.inc.php`返回的结果数组中使用[`json_encode`](http://www.php.net/manual/en/function.json-encode.php).

`dataType:'json'`这会让 jQuery 知道它应该像 JSON 一样处理响应，因此数据将包含常规 JS 对象。

原因：

*   一个请求导致服务器负载降低（无需为 6 个请求初始化环境）
*   更快（每个请求都需要一些时间来连接服务器，会话锁定也可能存在问题：一旦您使用默认会话，所有请求将被一一使用，等待先前的请求完成）

基本思想是通过一个 AJAX 请求推送所有操作及其值。然后，在服务器上，迭代`$_POST['actions']`并执行每个操作所需的内容。将结果收集到 PHP 数组中，如下所示：

```
 $results = array(array("action" => 'action1', 
                        "results" => "some action results"), 
                  array("action" => 'action2', 
                        "results" => "some action results"),
                  ...); 
```

而不是用 json_encode 对该数组进行编码，因此 jQuery 可以解析它：

```
echo json_encode($results); 
```

# cron - 为什么我应该使用守护进程而不是 cron 作业？

> ID：13495271
> 
> 赞同：2
> 
> 时间：2012-11-21T14:20:31.070
> 
> 标签：cron, daemon

我想在特定时间向用户发送消息（例如在用户输入每个事件后 15 分钟）。用户可以在任何时间/任何一天安排活动。为什么我应该使用守护进程而不是 cron 作业？cron 作业与守护进程的优点和 cron 是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T14:29:18.497

守护进程适用于您希望不断运行的进程。例如，一个 wsgi 服务器，传入的通信可以随时到来。cron 作业用于应以一定频率发生的批处理作业。

这听起来像是一项 cron 工作。您可以设置一个计时器或一个 while 循环，以每小时（无论您选择什么时间）不断地运行和发送消息。但是，它增加了您不需要的复杂性。制作一个批量运行的脚本，并在您需要的定期间隔调用它。

# windows-7 - Firebird ODBC Windows 7 主页

> ID：13495273
> 
> 赞同：3
> 
> 时间：2012-11-21T14:20:34.640
> 
> 标签：windows-7, odbc, firebird

我有一个在 Windows 2003 上运行的 Firebird 2.1.2 数据库。我已经有 Windows XP 客户端，还有 Windows 7 64 位 Professional，都登录到与服务器相同的 Windows 域，并且每个都使用 ODBC 连接。

但我想将 Windows 7 64 位 Home Basic 连接到该 Firebird 数据库。使用 Firebird 客户端 (ODBC) 我无法打开与 Firebird 服务器的连接。我也尝试了 FlameRobin，但没有成功......我可以访问共享，但不能访问数据库。

以前有人遇到过这个问题吗？这是因为Windows 7 Home的域限制吗？有什么工具可以帮助我诊断这个问题吗？非常感谢！！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-22T10:19:07.623

*根据我解决问题的评论回答*

最可能的原因是缺少库或各种组件的位数不正确。如果您的应用程序是 32 位的，那么您需要确保

*   ODBC 驱动程序是 32 位的
*   安装的 Firebird 客户端库是 32 位的
*   如果您使用 DSN：该 DSN 是使用 32 位 ODBC 管理员创建的

如果您的应用程序是 64 位的，这同样适用，但当然所有组件都需要是 64 位的。位数不匹配仅意味着应用程序看不到库。当然，如果上述其中一项完全缺失，它也将不起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-04T17:55:58.780

使用`64bit ODBC`位于`C:\Windows\SysWOW64\odbcad32.exe` 双击的管理员，`odbcad32.exe`然后您将获得查看`Firebird`驱动程序的选项。

# c# - WinRT 复选框属性

> ID：13495275
> 
> 赞同：0
> 
> 时间：2012-11-21T14:20:42.507
> 
> 标签：c#, xaml, windows-runtime

你好朋友我正在尝试检查复选框是否选中或未选中如果其他但它不允许我向下查看我的代码在我翻页之前我想要检查一下它说“Window.UI.Xaml.Controls.Primitives.ToogleButton .Checked 只能出现在 += 或 -= 的左侧

```
 private async void soru6to7_Clicked(object sender, RoutedEventArgs e)
        {
        if(Soru6_CheckBox4.Unchecked)
         {  
           TestPageSoru6.Visibility = Visibility.Collapsed;
           };
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T14:25:00.640

**Checked**和**Unchecked**是事件。我想你想检查**[IsChecked](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.controls.primitives.togglebutton.ischecked)**属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T14:26:21.690

如果这是 a 则要使用[IsOn](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/windows.ui.xaml.controls.toggleswitch.ison.aspx)属性，如果这是 a则要`ToggleSwitch`使用[IsChecked](http://msdn.microsoft.com/en-us/library/system.windows.controls.primitives.togglebutton.ischecked.aspx)`ToggleButton`。

# php - PHP memory_get_peak_usage 和 ini_set('memory_limit', '-1')

> ID：13495281
> 
> 赞同：5
> 
> 时间：2012-11-21T14:20:57.403
> 
> 标签：php, memory-management, memory-limit

我最近遇到了内存分配问题，所以我开始`ini_set('memory_limit', value);`尝试尝试增量输入值的指令。现在，通过网络（和 SO）搜索，我发现我可以`-1`将`value`. 所以，我做到了，现在脚本完全运行到最后而没有中断（在我曾经得到内存分配错误之前）。

但是，我不明白的是，鉴于脚本文件末尾的这两行：

```
$mem = memory_get_peak_usage(true);         
echo "Peak mem. usage: <b>" . round($mem / 1024 / 10124, 2) . "</b> MB"; 
```

产生大约**10.8MB**，当我查看时，`/var/log/messages`我可以看到这条线：

```
Nov 21 13:52:26 mail suhosin[1153]: ALERT-SIMULATION - script tried to increase  
memory_limit to 4294967295 bytes which is above the allowed value (attacker  
'xx.xxx.xxx.xxx', file '/var/www/html/file.php', line 5) 
```

这意味着脚本试图分配**4096MB**！

怎么会这样？而且，我最感兴趣的是为什么在这种情况下脚本执行没有停止？`ini_set('memory_limit', '-1');`是不是因为 我的意思是，我确实读过，`-1`因为`value`不推荐，我知道问题出在脚本中（在内存中一次读取过多的数据），我会通过顺序读取来修复它，但我我只是对这些数据差异感到困惑，所以如果有人能对此有所了解，我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-21T09:28:36.407

这是因为 suhosin 补丁使用了自己的“硬”最大内存限制，[`suhosin.memory_limit`](http://www.hardened-php.net/suhosin/configuration.html#suhosin.memory_limit).

从配置参考：

> 当此选项保留为 0 时，Suhosin [...] 不允许将 设置为`memory_limit`大于**脚本开头的值。**

换句话说，如果您将 更改`memory_limit`为大于 suhosin 的上限，那么它将简单地假设您是一个试图做一些可疑事情的“攻击者”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T09:49:05.553

认为您使用了 10MB，但通过放置`-1`您`value`允许您的脚本使用最大可用内存，例如`4GB`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-20T16:50:04.200

使用`ini_set('memory_limit', '-1');`不会对脚本设置限制——当然它仍然会限制在硬件上，但是来自手册；

> 请注意，要没有内存限制，请将此指令设置为 -1

**我最感兴趣的是为什么在这种情况下脚本执行没有停止？**

该脚本没有停止执行，因为它没有达到最大内存限制，因为它设置为`-1`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-21T09:10:25.680

memory_get_peak_usage — 返回 PHP 分配的内存峰值。

memory_limit - 增加最大内存分配

```
<?php 
if(ini_set('memory_limit', '-1'))
{
    echo "memory_limit set to -1B";
}
else
{
    echo "ini_set() failed!"
}
?> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-12-23T13:06:01.817

如此处所述：[http ://www.hardened-php.net/suhosin/configuration.html#suhosin.memory_limit](http://www.hardened-php.net/suhosin/configuration.html#suhosin.memory_limit)

Suhosin 不允许您*设置大于脚本开始时的值*。

如果您将**suhosin.memory_limit**设置为**4096**，那么您将能够增加内存使用量而不会收到此警报

我的猜测是脚本没有尝试分配**4096MB** ，但它是一个错误的 shuosin 警报，显示php 服务器运行的**32 位系统**的最大可寻址内存限制为**2^32**

希望这能解答你的疑惑

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-12-24T00:51:48.047

```
$mem / 1024 / 10124 
```

应该

```
$mem / 1024 / 1024 
```

所以我们谈论的是 100 MB 的峰值。

然后`4,294,967,295 = 4 GB`。我想这就是你所拥有的（即`-1`）。

这意味着这些输出消息彼此无关。如果您希望警告消失，[请将 Suhosin 内存限制设置为](http://www.hardened-php.net/suhosin/configuration.html#suhosin.memory_limit)高于 PHP 内存限制或禁用 Suhosin。

Suhosin 有一个[模拟模式](http://www.hardened-php.net/suhosin/configuration.html#suhosin.simulation)，它似乎是`ON`。如果打开`OFF`，ALERT 应该停止脚本。

# c# - 运算符“*”不能应用于“字符串”和“整数”类型的操作数

> ID：13495282
> 
> 赞同：-4
> 
> 时间：2012-11-21T14:20:58.923
> 
> 标签：c#, visual-studio-2010

```
namespace exer4
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void btnTotal_Click(object sender, EventArgs e)
        {
            int overtime = Convert.ToInt32(txtHours.Text) - 30;
            int salary = Convert.ToInt32(txtHours.Text)*250;
            double tax = (salary + overtime) * .10;
            int deduction = salary - (300 + 400);

            //operator '>' cannot be applied to operands of type 'string' and 'int'
            if Convert.ToInt32(txtHours.Text > 30)
            {
                lblName.Text = txtName.Text;
                lblSalary.Text = Convert.ToString(overtime *120) + (salary - (deduction - tax)); 

            }
            else
            { 
                // //operator '*' cannot be applied to operands of type 'string' and 'int'
                lblSalary.Text = Convert.ToString(txtHours.Text) * 250;
            }
       }
  } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T14:23:46.367

你的 if 语句应该是

```
if (Convert.ToInt32(txtHours.Text) > 30) 
```

而另一行应该是

```
lblSalary.Text = Convert.ToString(Convert.ToInt32(txtHours.Text) * 250); 
```

或者更好地将 txtHours 文本转换为 int 并将其保存在变量中以供重用。

```
 private void btnTotal_Click(object sender, EventArgs e)
    {
        int hours = Convert.ToInt32(txtHours.Text);
        int overtime = hours - 30;
        int salary = hours * 250
        double tax = (salary + overtime) * .10;
        int deduction = salary - (300 + 400);

        if(hours > 30)
        {
            lblName.Text = txtName.Text;
            lblSalary.Text = ((overtime *120) + (salary - (deduction - tax))).ToString(); 
        }
        else
        { 
            lblSalary.Text = salary.ToString();
        }
   } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-21T14:23:52.463

你想做：

```
if (Convert.ToInt32(txtHours.Text) > 30)
{
    //normal code here
}
else
{
    //normal code
} 
```

如果首先需要像您一样将其解析为 int，则进行比较，以便 if 可以测试布尔条件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T14:25:37.490

尝试

```
if (Convert.ToInt32(txtHours.Text) > 30)
{ ... 
```

# c++ - 将光标更改为沙漏/等待/忙碌光标并返回 Qt

> ID：13495283
> 
> 赞同：46
> 
> 时间：2012-11-21T14:21:06.020
> 
> 标签：c++, qt, mouse-cursor

我生成了一个执行冗长操作的进程，并且我想给出正在发生的事情的视觉反馈，所以我想将光标更改为忙，并在收到`QProcess::finished`信号时恢复它。

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2012-11-21T15:11:38.657

Qsiris 解决方案是“widget wide”。如果要更改整个应用程序的光标，请使用

```
QApplication::setOverrideCursor(Qt::WaitCursor); 
```

和

```
QApplication::restoreOverrideCursor(); 
```

**注意：**正如@Ehsan Khodarahmi 所指出的，在触发下一个QT 事件或手动调用 QApplication::processEvents() 之前，光标不会改变。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2012-11-21T14:28:56.440

使用它来设置光标在进程开始时等待：

```
this->setCursor(Qt::WaitCursor); 
```

这可以将光标恢复正常（将其放在 QProcess::finished 的插槽中）

```
this->setCursor(Qt::ArrowCursor); 
```

# python - ImportError：没有名为 vtkCommonPython 的模块

> ID：13495285
> 
> 赞同：20
> 
> 时间：2012-11-21T14:21:10.153
> 
> 标签：python, vtk

我正在尝试在我的计算机上安装带有 VTK 的 Python，但是当我想导入 VTK 时，出现错误：

```
import vtk 
Traceback (most recent call last): 
 File "<stdin>", line 1, in <module>
 File "C:\vtk\Wrapping\Python\vtk\__init__.py", line 41, in <module>
   from vtkCommonPython import * 
ImportError: No module named vtkCommonPython 
```

我已经检查了我的路径，并且在 bin 文件夹中有文件“vtkCommonPython.pyd”。

谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-06-25T14:53:27.313

我遇到了一个非常相似的问题，并通过添加`/usr/local/lib/python2.7/site-packages/vtk/`到 PYTHONPATH 环境变量来修复它。

您的确切修复可能会因您的 python 版本等而异（它会影响路径）。您应该能够通过定位丢失模块的位置然后将路径添加到环境变量来对其进行排序，如下所示。

就我而言，我使用以下方法找到了路径：

```
find / -name vtkCommonCorePython 2>/dev/null 
```

然后将相关路径添加到 ~/.bash_rc 或等效路径。

```
export PYTHONPATH="$PYTHONPATH:usr/local/lib/python2.7/site-packages/vtk/" 
```

请注意附加到路径变量而不是覆盖它 - 您可能已经需要在其中添加一些其他内容，例如“/usr/local/lib/”。不同的 shell 的格式（和你放这个的文件！）是不同的。

重新启动终端以通过更改，然后检查变量是否设置正确：

```
echo $PYTHONPATH 
```

并且要非常小心，任何路径都没有错误！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-02-11T17:48:14.500

我在 MacOSX 上遇到了同样的问题。所以我开始使用 vtk/bin/vtkpython 而不是 python。这让我可以毫无错误地导入 vtk。然后我显式地导入了 vtkCommonCorePython 并打印了位置：

```
$ /home/vtk/bin/vtkpython
vtk version 6.2.0
Python 2.7.5 (default, Mar  9 2014, 22:15:05) 
Type "help", "copyright", "credits" or "license" for more information.
>>> import vtkCommonCorePython 
>>> print vtkCommonCorePython
<module 'vtkCommonCorePython' from '/home/vtk/lib/vtkCommonCorePython.so'> 
```

在终端中，我将 lib 文件夹添加到我的 python 虚拟环境路径中：

```
$ add2virtualenv /home/vtk/lib 
```

我不知道这将如何转换为 Windows，但我希望这会有所帮助！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-05-01T09:08:35.723

我遇到了同样的问题（kubuntu 14.04）。

我意识到指向已编译的 vtkpython 对象的链接`/usr/lib/python2.7/dist-packages/vtk`已损坏。

于是我`/usr/lib/x86_64-linux-gnu`就跑过去`for i in *-6.0.so.6.0; do sudo ln -s $i ${i/-6.0.so.6.0/-6.0.so}; done`。

它似乎解决了这个问题。

希望有帮助。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-09-09T16:18:36.223

除了检查`vtk`你的内部`$PYTHONPATH`，还要注意更新的版本`VTK (6.x)`不再有`vtkCommonPython`模块。相反，它被分成几个子组件。（例如`vtkCommonCorePython`, `vtkCommonMathPython`, `vtkCommonSystemPython`），但这主要是您可能想要使用的外部包的问题（例如`VMTK`，默认情况下编译并[依赖于`VTK 5.10`](http://www.vmtk.org/documentation/installation.html).

要检查和扩展您的`$PYTHONPATH`简单调用：

```
$ echo $PYTHONPATH
/usr/local/lib/python2.7/site-packages
$ export PYTHONPATH=$PYTHONPATH:/usr/local/lib/python2.7/site-packages/vtk
$ echo $PYTHONPATH
/usr/local/lib/python2.7/site-packages:/usr/local/lib/python2.7/site-packages/vtk 
```

要检查`vtk`您安装了哪个版本：

```
$ python
Python 2.7.10
>>> import vtk
>>> print str(vtk.VTK_MAJOR_VERSION) + '.' + str(vtk.VTK_MINOR_VERSION)
6.2 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-21T14:47:39.487

它需要在`sys.path`. 我所做的是创建了一个名为“Modules”的文件夹（在哪里并不重要），其中有我下载/创建的所有模块。说我把它放进去`C:\Users\USER\Modules`。你也可以把这个模块放在那里。

您需要将路径复制到文件夹。

然后，转到控制面板。单击系统，然后在左侧面板上有一个名为“高级系统设置”的选项。点击那个。在弹出的窗口底部，单击“环境变量”。查看您是否创建了一个名为`PYTHONPATH`. 很可能，你不知道。因此，通过按“NEW”创建一个变量（在第二部分中）。命名它`PYTHONPATH`并为变量值输入文件路径。（对于我的示例，文件路径是`C:\Users\USER\Modules`）。希望这可以帮助 ：）

一旦你到达控制面板中的系统（属性）位置，我插入了如何到达那里的屏幕截图： ![蟒蛇路径](../Images/8ac23dc151c2e8d9ecf24c945ffade9f.png)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-02-11T17:54:00.803

您还需要将 vtkCommonPython.pyd 的文件夹添加到系统路径中（就像它是一个 dll 一样）。另见[http://www.vtk.org/Wiki/VTK/Tutorials/PythonEnvironmentSetup](http://www.vtk.org/Wiki/VTK/Tutorials/PythonEnvironmentSetup)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-05-30T00:43:10.000

假设您在[说明](http://www.vtk.org/Wiki/VTK/Configure_and_Build)中使用了建议的路径，将以下行添加到您的 bashrc：

```
export PYTHONPATH=$HOME/projects/VTK-build/lib:$HOME/projects/VTK-build/Wrapping/Python:$PYTHONPATH 
```

如果在使用 sudo 时出现问题，例如

```
sudo yum install mayavi 
```

您可能需要解决[此问题](https://stackoverflow.com/questions/257616/sudo-changes-path-why)。将以下行添加到 bashrc：

```
alias sudo=’sudo env PYTHONPATH=$PYTHONPATH’ 
```

[完整说明](https://lilarieber.wordpress.com/2016/05/03/installing_mayavi/)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-02-21T19:21:34.313

在窗户里，

您应该添加以下路径
将包含 .pyd 和 .dll 文件的文件夹添加到 PYTHONPATH 环境变量。

例子：

D:\VTK\VTK-bin\bin\Release\Lib\site-packages\vtkmodules
D:\VTK\VTK-bin\bin\Release

此外，将 Qt 的 bin 文件夹的路径添加到系统变量 PATH C:\Qt\5.10.0\msvc2017_64\bin

# continuous-integration - 如何在 TeamCity 中启动容器

> ID：13495286
> 
> 赞同：3
> 
> 时间：2012-11-21T14:21:13.097
> 
> 标签：continuous-integration, teamcity, application-server

我正在尝试在与 TeamCity 的持续集成中运行一些集成测试，我的测试目标是验证我是否可以在某个本地容器上正确部署我的 webapp。因此，我需要设置一个具有相同功能的 TeamCity 构建

*   构建所有并打包我的 webapp
*   启动容器
*   运行部署 webapp 的测试并测试部署状态
*   停止容器

TeamCity 如何做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-23T18:47:09.293

如果您设置了 TeamCity，这非常简单。听起来您是 TeamCity 的新手。如果您没有设置服务器和代理以便能够运行[构建配置](http://confluence.jetbrains.net/display/TCD7/Build+Configuration)，则需要先执行此操作。

如果你这样做了，你就准备好了。您需要能够从命令行或内置的 TeamCity 运行器执行您想要执行的所有操作。然后，您只需要设置构建配置来执行每个任务，然后将它们与[完成构建触发器](http://confluence.jetbrains.net/display/TCD7/Configuring+Build+Triggers)连接。

# objective-c - 核心数据迁移和版本控制

> ID：13495288
> 
> 赞同：0
> 
> 时间：2012-11-21T14:21:21.410
> 
> 标签：objective-c, xcode, core-data, core-data-migration

我按照[本](http://www.timisted.net/blog/archive/core-data-migration/)指南在我的非基于文档的应用程序中实施核心数据迁移和版本控制。我按照报告的驾驶做了，但是当我启动应用程序时告诉我不支持我打开的模型。我怎样才能解决这个问题？

```
- (NSPersistentStoreCoordinator *)persistentStoreCoordinator
{
    if (_persistentStoreCoordinator) {
        return _persistentStoreCoordinator;
    }

    NSManagedObjectModel *mom = [self managedObjectModel];
    if (!mom) {
        NSLog(@"%@:%@ No model to generate a store from", [self class], NSStringFromSelector(_cmd));
        return nil;
    }

    NSFileManager *fileManager = [NSFileManager defaultManager];

    NSURL *applicationFilesDirectory = [self applicationFilesDirectory];
    NSURL *storeURL = [[self applicationFilesDirectory] URLByAppendingPathComponent:@"Preventivi.storedata"];

    NSError *error = nil;
    //Turn on automatic store migration
    NSMutableDictionary *optionsDictionary = [NSMutableDictionary dictionary];
    [optionsDictionary setObject:[NSNumber numberWithBool:YES] forKey:NSMigratePersistentStoresAutomaticallyOption];
    NSDictionary *properties = [applicationFilesDirectory resourceValuesForKeys:@[NSURLIsDirectoryKey] error:&error];

    if (!properties) {
        BOOL ok = NO;
        if ([error code] == NSFileReadNoSuchFileError) {
            ok = [fileManager createDirectoryAtPath:[applicationFilesDirectory path] withIntermediateDirectories:YES attributes:nil error:&error];
            NSURL *defaultStoreURL = [[NSBundle mainBundle] URLForResource:@"Preventivi" withExtension:@"storedata"];
            if (defaultStoreURL) {
                [fileManager copyItemAtURL:defaultStoreURL toURL:storeURL error:NULL];
            }
        }
        if (!ok) {
            [[NSApplication sharedApplication] presentError:error];
            return nil;
        }
    } else {
        if (![properties[NSURLIsDirectoryKey] boolValue]) {
            // Customize and localize this error.
            NSString *failureDescription = [NSString stringWithFormat:@"Expected a folder to store application data, found a file (%@).", [applicationFilesDirectory path]];

            NSMutableDictionary *dict = [NSMutableDictionary dictionary];
            [dict setValue:failureDescription forKey:NSLocalizedDescriptionKey];
            error = [NSError errorWithDomain:@"YOUR_ERROR_DOMAIN" code:101 userInfo:dict];

            [[NSApplication sharedApplication] presentError:error];
            return nil;
        }
    }

    NSURL *url = [applicationFilesDirectory URLByAppendingPathComponent:@"Preventivi.storedata"];
    NSPersistentStoreCoordinator *coordinator = [[NSPersistentStoreCoordinator alloc] initWithManagedObjectModel:mom];
    if (![coordinator addPersistentStoreWithType:NSXMLStoreType configuration:nil URL:url options:nil error:&error]) {
        [[NSApplication sharedApplication] presentError:error];
        return nil;
    }
    _persistentStoreCoordinator = coordinator;

    return _persistentStoreCoordinator;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-14T10:23:25.897

你能告诉应用程序在哪里抛出错误吗？如果它在最后几行，您可以尝试将 storeType NSXMLStoreType 更改为 NSSQLiteStoreType 例如。

```
if (![coordinator addPersistentStoreWithType:NSXMLStoreType configuration:nil URL:url options:nil error:&error]) 
```

到

```
if (![coordinator addPersistentStoreWithType:NSSQLiteStoreType configuration:nil URL:url options:options error:&error]) 
```

为此，您还必须将后缀更改为“sqlite”。

```
NSURL *url = [NSURL fileURLWithPath: [applicationFilesDirectory stringByAppendingPathComponent: @"Preventivi.sqlite"]] 
```

和

```
NSURL *defaultStoreURL = [[NSBundle mainBundle] URLForResource:@"Preventivi" withExtension:@"sqlite"]; 
```

或者如果您已经有解决方案，您可以分享这个:) 但是与我的代码相比，没有真正的区别（只有一个选项更多

```
NSDictionary *options = [NSDictionary dictionaryWithObjectsAndKeys:
                         [NSNumber numberWithBool:YES], NSMigratePersistentStoresAutomaticallyOption,
                         [NSNumber numberWithBool:YES], NSInferMappingModelAutomaticallyOption, nil]; 
```

并且您在添加持久存储时不使用选项^^）

我希望这有帮助 ：）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-14T10:34:52.660

您似乎已将 Core Data 堆栈配置为使用自动迁移。并在不使用版本控制的情况下继续更改模型。

您必须使用版本化模型。如果您在修改之前没有创建模型版本，则自动迁移将不起作用。为了在每次修改之前使自动迁移工作，您应该创建一个新的模型版本并修改该新版本。

例如，您想向一个实体添加几个属性并添加另一个实体，您：

1.  创建新模型版本（选择模型文件，编辑器->添加模型版本...）；
2.  选择该新版本并添加属性和实体。

而且您还应该说明是否使用配置，因为自动迁移存在配置问题。

# java - 在java中获得下一个小时

> ID：13495289
> 
> 赞同：2
> 
> 时间：2012-11-21T14:21:22.173
> 
> 标签：java, jdbc, timestamp

请提供从数据库中获取下一小时的代码。例如，我`timestamp` 从数据库中得到一个：

```
 String sqlupdate = "select UploadedDate from CAF_Entry where Status='new' and Reference=0   order by UploadedDate limit 1";
    System.out.println("sql query"+sqlupdate);
    Statement stupdate = con.createStatement();
    ResultSet rsupdate = stupdate.executeQuery(sqlupdate);
    if(rsupdate.next())
    {
      date22=rsupdate.getTimestamp("UploadedDate");
      String stringdate=date22.toString();` 
```

我得到日期`2012-11-12 10:30:00`

我如何获得下一个小时，例如`2012-11-12 11:00:00`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T14:35:03.883

```
Calendar calendar = Calendar.getInstance();
calendar.setTimeInMillis(date22.getTime);
calendar.add(Calendar.HOUR, 1); 
```

之后，您可以使用[SimpleDateFormat](http://docs.oracle.com/javase/1.4.2/docs/api/java/text/SimpleDateFormat.html)将日期格式化为字符串，如果您希望它采用该格式。 如果需要，`Calendar.getTime()`将返回一个对象。`java.util.Date`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T14:37:25.593

```
String sqlupdate = "select UploadedDate from CAF_Entry where Status='new' and Reference=0   order by UploadedDate limit 1";
System.out.println("sql query"+sqlupdate);
Statement stupdate = con.createStatement();
ResultSet rsupdate = stupdate.executeQuery(sqlupdate);
if(rsupdate.next())
{
  DateTime date22=new DateTime(rsupdate.getTimestamp("UploadedDate").getTime()).plusHours(1);

  String stringdate=date22.toString();` 
```

您需要使用[joda-time](http://joda-time.sf.net)，您应该使用它，因为 JDK 日期/日历 clusterfsck 是可怕的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T14:37:37.320

使用以下代码片段

```
Calendar c = Calendar.getInstance();
c.setTimeInMillis(date22.getTime());
c.add(Calendar.HOUR, 1);
Date d = c.getTime(); 
```

# javascript - jQuery javascript按键功能在IE8上不起作用

> ID：13495291
> 
> 赞同：1
> 
> 时间：2012-11-21T14:21:36.357
> 
> 标签：javascript, jquery, internet-explorer-8

我有以下 jquery 函数，可以避免在输入文本中输入“1”：

```
<input id="myId" style="width:50%;" value="0" type="text">​

$("#myId").keypress(function(e) {
   var x=e.charCode;
   if (x == '49'){
       e.preventDefault();
   }
});​ 
```

这是[jsfiddle](http://jsfiddle.net/xqUEV/2/)

这不适用于 IE8。我的错误在哪里？提前致谢！

**编辑 JAVASCRIPT 版本**

```
<input id="myId" style="width:50%;" value="0" type="text"  onkeypress="javascript:checkNumber(event);"/>

function checkNumber(event) {
var x=e.which;
if (x == 49){
    event.preventDefault();
}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T14:25:46.267

`charCode`不是跨浏览器的，可以使用jQuery[`which`](http://api.jquery.com/event.which/)属性：

> 该`event.which`属性归一化`event.keyCode`和`event.charCode`。建议注意`event.which`键盘按键输入。

```
var x = e.which; 
```

如果你不使用 jQuery，你可以编写代码：

```
var x = e.charCode || e.keyCode; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T14:26:18.343

请参阅此对类似问题的[答案。](https://stackoverflow.com/a/492873/1243160)尝试`keydown`代替`keypress`和`keyCode`代替`charCode`：

```
$("#myId").keydown(function(e) {
   var x=e.keyCode;
   if (x == '49'){
      e.preventDefault();
   }
});​ 
```

[keypress](http://api.jquery.com/keypress/)的jQuery 文档列出了一些使用它的好理由`keydown`，其中最重要的是它只触发一次按下并按住，并且 keypress 报告字符，而不是键（这在处理大写锁定等问题时会出现问题.)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T14:26:21.480

请改用`e.which`，因为`e.charCode`并非所有浏览器都支持。

此外，您可以考虑使用`.keyup()`事件而不是`.keypress()`

# ms-access - #Error in Avg([Field]) 重新计算时

> ID：13495294
> 
> 赞同：0
> 
> 时间：2012-11-21T14:21:44.310
> 
> 标签：ms-access, vba

我有三种产品，玉米、豆类和萝卜。我每个都有不同的规格，有些相同......水分，颜色，蛋白质，脂肪......我有一些未绑定的文本框和一些连续形式的标签。还有两个按钮可以让我按在两个文本框中输入的日期进行排序或全部显示。我在表单标题中有标签和文本框，在详细信息部分有文本框。表单标题部分中的文本框正在获取它们排列的每个字段的平均值。

当我打开表单并选择 Beans 时，一切都完美地显示出来了！我可以排序或显示所有，这很好。我可以切换到 Corn 并执行相同操作，但是当我尝试切换回 Beans 时，Average 文本框会显示 #Error。如果我打开表单并先转到 Corn，然后是 Beans 并返回 Corn，Corn 两次都可以，但 beans 不起作用。Beans 仅当它是表单上打开的第一个东西时才会起作用，并且会继续工作，直到您选择另一个产品。无论如何，玉米和萝卜都可以，但是当我切换回 Beans 时，我再次收到 #Error。

两个代码块之间几乎没有区别。还有什么可能导致平均文本框（Text12-Text15）中的#Error？

这是代码的一部分....此代码位于其各自按钮的 OnClick 事件中

对于玉米

```
Me.Label2.Caption = "Moisture"
Me.Label3.Caption = "Starch"
Me.Label4.Caption = "Protein"
Me.Label5.Caption = "Fat"
Me.Text2.ControlSource = " Moisture "
Me.Text3.ControlSource = " Starch "
Me.Text4.ControlSource = " Protein "
Me.Text5.ControlSource = " Fat "
Me.Text12.ControlSource = "=Avg([Moisture])"
Me.Text13.ControlSource = "=Avg([Starch])"
Me.Text14.ControlSource = "=Avg([Protein])"
Me.Text15.ControlSource = "=Avg([Fat])"
Me.RecordSource = "SELECT SampleID.DateCreated, SampleID.SampleLocationID, PertenData.Moisture, PertenData.Starch, PertenData.Protein, PertenData.Fat FROM SampleID INNER JOIN PertenData ON SampleID.SampleID = PertenData.PertenSampleID WHERE ((SampleID.SampleLocationID)=21) ORDER BY SampleID.DateCreated DESC" 
```

豆类

```
Me.Label2.Caption = "Moisture"
Me.Label3.Caption = "Starch"
Me.Label4.Caption = "Protein"
Me.Label5.Caption = "Color"
Me.Text2.ControlSource = " Moisture "
Me.Text3.ControlSource = " Starch "
Me.Text4.ControlSource = " Protein "
Me.Text5.ControlSource = " Color"
Me.Text12.ControlSource = "=Avg([Moisture])"
Me.Text13.ControlSource = "=Avg([Starch])"
Me.Text14.ControlSource = "=Avg([Protein])"
Me.Text15.ControlSource = "=Avg([Color])"
Me.RecordSource = "SELECT SampleID.DateCreated, SampleID.SampleLocationID, PertenData.Moisture, PertenData.Starch, PertenData.Protein, PertenData.Color FROM SampleID INNER JOIN PertenData ON SampleID.SampleID = PertenData.PertenSampleID WHERE ((SampleID.SampleLocationID)=35) ORDER BY SampleID.DateCreated DESC" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T15:25:36.637

Based on the comments...
I would move all the code to one sub and call that sub with a string parameter (Corn or Beans or Radishes) this will help you to narrow down what the bug is in the now Radish button code and will enable easier maintenance later on.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T18:19:22.003

该问题与绑定的文本框直接相关。我的不同样本需要显示不同数量的数据类别，但是通过将文本框的可见属性设置为 false 仍然会导致可见文本框出现问题。要将文本框设置回“未绑定”，我使用了

```
Me.text5.ControlSource = Empty 
```

将文本框更改回未绑定状态后，然后将它们重新绑定到您的新控件源。这已经永久地停止了这个问题。我现在有 5 种产品，这 5 种产品的任何组合都完美无缺。感谢大家的帮助。

# ios - 在 iOS 中让按钮播放声音

> ID：13495298
> 
> 赞同：2
> 
> 时间：2012-11-21T14:22:02.237
> 
> 标签：ios, objective-c, audio, playback

我正在尝试制作一个应用程序，当您触摸按钮（实际上是我导入的 .png 图像）时会播放声音。有人知道怎么做这个吗？我正在使用 xcode 4.5.2

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-21T14:57:26.987

```
NSURL* musicFile = [NSURL fileURLWithPath:[[NSBundle mainBundle] pathForResource:@"your audio file name" ofType:@"wav"]];
AVAudioPlayer *click  = [[AVAudioPlayer alloc] initWithContentsOfURL:musicFile  error:nil];
[click play]; 
```

在您的按钮单击操作上编写此代码。还将 AudioToolbox/AudioToolbox.h 和 AVFoundation/AVFoundation.h 框架添加到您的类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T15:05:58.553

您可以设置按钮触摸事件播放

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T14:24:03.993

[Youtube 教程](http://www.youtube.com/watch?v=TycW9dYuK9A)解释了制作音板应用程序的完整源代码。但是，下次您发布问题时，您的目标应该是针对您遇到的单个问题。Stack Overflow 不是您的个人研究助理，在 Google 上简单搜索“音板应用教程”会发现大量结果，向您展示如何实现目标。

# javascript - Fancybox：无法加载请求的内容。请稍后再试

> ID：13495299
> 
> 赞同：1
> 
> 时间：2012-11-21T14:22:13.330
> 
> 标签：javascript, jquery, fancybox

这个特定的主题有一些关于 SO 的答案，但没有一个能解决我的问题。我不知道在哪里看这里，虽然我怀疑这是非常简单的事情。

*   当我尝试**手动**打开 Fancybox 中的 url （即通过“物理”单击链接）时，它可以工作。
*   但是，如果我尝试在页面加载时**自动**打开它（即假装单击链接），它根本不起作用，并给我在标题中提到的错误。

HTML 很简单：

```
<a href="http://www.mydomain.nl/url/to/whatever" class="fancybox hidden_link">test</a> 
```

我用来自动点击它的 Javascript 也很简单：

```
$(document).ready(function() {              
    $(".hidden_link").fancybox().trigger("click");
}); 
```

事件发生（Fancybox 打开），但它只显示“无法加载内容”消息。当我手动单击链接时，我在 Fancybox 中看到了我自己的页面。

我在这里想念什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T18:24:45.700

有这个链接：

```
<a href="http://www.mydomain.nl/url/to/whatever" class="fancybox hidden_link">test</a> 
```

...这个脚本：

```
$(document).ready(function() {
    $(".fancybox").fancybox({
        type: "iframe",
        width : 380, // or whatever
        height: 280
    }).trigger("click");
});​ 
```

...应该以手动和编程方式完成这两项工作。

见**[JSFIDDLE](http://jsfiddle.net/7dFYQ/1/)**

**请注意**，我使用`type: "iframe"`的是因为内容是外部页面。在任何情况下都应考虑[同源策略。](http://en.wikipedia.org/wiki/Same_origin_policy)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T14:47:11.750

这是我给作者一段时间的解决方案。

```
$(document).ready(function() {
    $.fancybox({
        content: $("#popup"),
        closeClick  : false,
        openEffect  : 'none',
        closeEffect : 'none',
        helpers   : {
            overlay : {
                closeClick: false,
            }
        }
    });
}); 
```

链接：http: [//jsfiddle.net/YkH5G/1/](http://jsfiddle.net/YkH5G/1/)

作者插件：[https ://github.com/fancyapps/fancyBox/issues/410](https://github.com/fancyapps/fancyBox/issues/410)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T14:34:46.877

这是同源政策的一个方面。确切的行为因浏览器而异。请参阅[http://code.google.com/p/browsersec/wiki/Part2#Navigation_and_content_inclusion_across_domains](http://code.google.com/p/browsersec/wiki/Part2#Navigation_and_content_inclusion_across_domains)

这是[每个浏览器版本的摘要](http://screencast.com/t/E2gXXuJ3b7s)。

这里显然存在安全问题，因为单击带有 JavaScript 的链接可能会代表您执行操作。这可能对 GET 请求导致状态更改的站点具有破坏性，因为验证您身份的标头（如 cookie）也将与该 GET 请求一起发送。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-21T14:41:12.800

因为有类似的同源政策。

你从谷歌的回复中得到：[X-Frame-Options SAMEORIGIN](https://developer.mozilla.org/en-US/docs/The_X-FRAME-OPTIONS_response_header)

如果您链接到您域中的子页面，它应该可以工作。

# android - Android onResume 布局问题

> ID：13495309
> 
> 赞同：1
> 
> 时间：2012-11-21T14:22:43.220
> 
> 标签：android, layout, onresume

我的菜单有问题。

我有一个充满按钮的背景布局，垂直和水平。看起来像这样： [http ://s7.directupload.net/file/d/3081/sewg79tr_png.htm](http://s7.directupload.net/file/d/3081/sewg79tr_png.htm)

所以当我开始一个新游戏（新意图）并按下后退按钮时，屏幕布局被打破，看起来真的很糟糕： [http ://s14.directupload.net/file/d/3081/ewfeidya_png.htm](http://s14.directupload.net/file/d/3081/ewfeidya_png.htm)

当我切换到另一个应用程序并切换回菜单时，布局看起来就像它在启动时的样子。一切都很好。

我正在尝试删除所有按钮并重新填充 onResume 中的布局，但它不起作用，我真的不知道为什么。System.out 工作正常，但布局仅在我在应用程序之间切换时重置。

有谁知道这个问题？

编辑：背景按钮的 OnClickListener 改变了点击按钮的背景图片。这个 OnClickListener 仍然在可怕的损坏布局中工作。

```
@Override
public void onResume() {
    super.onResume();
    LinearLayout buttonBackgroundLayout = (LinearLayout) findViewById(R.id.buttonHintergrundLayout);
    //int count = buttonBackgroundLayout.getChildCount();
    //System.out.println(count);
    //for (int i = 0; i < count; i++) {
    //    View child = buttonBackgroundLayout.getChildAt(i);
    //    if (child instanceof View) ((ViewGroup) child).removeAllViews();
    //}
    buttonBackgroundLayout.removeAllViewsInLayout();
    buttonBackgroundLayout.invalidate();

    createButtonImages(breite);
    createBackgroundButtons(breite);
    System.out.println("WOOOHOOO");
} 
```

编辑：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.main);

    buttonBackgroundLayout = (LinearLayout) findViewById(R.id.buttonHintergrundLayout);

    createButtons();        

    DisplayMetrics display = new DisplayMetrics();
    getWindowManager().getDefaultDisplay().getMetrics(display);
    breite = display.widthPixels;

    createButtonImages(breite);
    createBackgroundButtons(breite);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T14:28:18.667

您不需要删除 onResume() 中的所有视图。就布局而言，这应该是您需要做的所有事情。

```
@Override
public void onResume() {
    super.onResume();
    setContentView(R.id.buttonHintergrundLayout);

} 
```

您可能还想在此处设置所有 onClickListner。但是你在这里设置的任何东西，你都应该在 onPause() 中删除。但是，设置视图基本上是免费的，特别是如果您只是使用已经存在的视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T15:39:37.853

嗯，在另一部手机（三星）上恰恰相反。在启动时它看起来很糟糕，从startet游戏恢复后它看起来不错，在不同应用程序之间切换后它看起来很糟糕...... Wtf！？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T14:28:29.137

LinearLayout buttonBackgroundLayout = (LinearLayout) findViewById(R.id.buttonHintergrundLayout);

将此移至 onCreate 并仅制作和使用 buttonBackgroundLayout 的一个实例（全局声明）

我想问题是创建了多个视图实例

# google-chrome-extension - Chrome 扩展程序后台页面窗口变量

> ID：13495313
> 
> 赞同：0
> 
> 时间：2012-11-21T14:23:01.483
> 
> 标签：google-chrome-extension

我正在尝试在我的 javascripts 之间共享对象。在我的 background.html 中，我有：

```
<html>
  <head>
    <script type="text/javascrpt">
      window.Something = {};
    </script>
  </head>

  <body>
    <script type="text/javascript" src="../js/file1.js"></script>
    <script type="text/javascript" src="../js/file2.js"></script>
  </body>
</html> 
```

在 file1.js 我有：

```
alert("1: " + window.Something); 
```

在 file2.js 我有：

```
alert("2: " + window.Something); 
```

当我重新加载我的扩展时，我只会收到 2 个警报：

1：未定义 2：未定义

这是怎么回事？！谢谢大家

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T14:53:55.443

删除在 background.html 中编写的脚本

*请改用以下代码*

```
<html>
  <head>
    <script src="js/file3.js"></script>
 <script  src="js/file1.js"></script>
    <script  src="js/file2.js"></script>
  </head>
  <body>
  </body>
</html> 
```

我假设你有一个名为 js 的文件夹

***文件 3.js***

```
window.Something = {}; 
```

有关更多信息，请参阅以下链接

[http://developer.chrome.com/extensions/contentSecurityPolicy.html#JSExecution](http://developer.chrome.com/extensions/contentSecurityPolicy.html#JSExecution)

# xcode4 - 使用 install_name_tool 更改 dylib 的路径

> ID：13495315
> 
> 赞同：1
> 
> 时间：2012-11-21T14:23:04.513
> 
> 标签：xcode4, dylib, install-name-tool

```
install_name_tool -change /usr/local/lib/testlib.dylib  "$TARGET_BUILD_DIR"/../../testlib.dylib "$PRODUCT_NAME" 
```

上面有人告诉我，在 xcode 中放入运行脚本时会改变动态库的查找路径。然后可以通过在终端窗口中输入以下内容来验证这一点

```
otool -L /drag/the/executable/here/and/its/filepath/will/show/up/testlib 
```

输出将类似于以下内容

```
/previous/filepath:
/usr/local/lib/testlib.dylib (compatibility version 1.0.0, current version 1.0.0)
./anothertestlib.dylib (compatibility version 1.0.0, current version 1.0.0)
/usr/lib/libstdc++.6.dylib (compatibility version 7.0.0, current version 56.0.0)
/usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 169.3.0) 
```

我的问题是为什么 install_name_tool 命令不起作用？现在不是，但当 testlib 项目是客户端项目的目标依赖项时，它确实如此。现在我刚刚将 .dylib 拖到客户端项目中。查找路径保留在 usr/local/lib 中。

还有，什么是usr/local/lib，为什么系统认为我的dylib在里面，它是怎么进去的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T10:38:30.623

install_name_tool 通过覆盖路径字符串来工作，因此任何新的字符串都必须与原始字符串的长度相同或更短。

因为 "/usr/local/lib/testlib.dylib" 是 28 个字符长，而 ""$TARGET_BUILD_DIR"/../../testlib.dylib" 至少是 20 个字符长，如果 $TARGET_BUILD_DIR 变量扩展为字符串9 个字符或更多字符，则替换可能太长而无法使用。

我说可能是因为您可以将标志 -headerpad_max_install_names 添加到链接器，以便它会在每个路径之后添加填充，以便存在空间以允许更长的替换（我相信最多 1,024 个字符）。虽然由于 install_name_tool 失败，但可能没有使用它。

至于 /usr/local/lib 路径，从技术上讲，/usr（/usr/bin、/usr/lib 等）用于适用于任何机器并且可以安装在网络上的软件，而 /usr/本地根目录（/usr/local/bin、/usr/local/lib）仅适用于本地机器的任何特定内容。实际上，通过操作系统分发用户 /usr 提供的软件包和自定义安装使用 /use/local 的情况更多。在大多数情况下，这并不重要。在 Mac 上，Homebrew 包管理器使用 /usr/local 根目录（而 MacPorts 使用 /opt 和 Fink /sw）。

碰巧的是，您最初安装它时所做的一切都使用该位置而不是任何其他选项。但只要它知道在哪里寻找任何需要的东西，它或多或少都不是一个有效的位置。

# oracle - 如何用 /n /r 插入 oracle 数据库字符串？

> ID：13495316
> 
> 赞同：0
> 
> 时间：2012-11-21T14:23:06.610
> 
> 标签：oracle, insert

我有一个带有 /n 和 /r 字符的字符串。我想将它们插入 Oracle 数据库，但插入时没有 /n 或 /r 字符。这是我的代码：

```
public static void SaveToDB(string body)
    {
        string connectionString = "bla bla";
        using (OracleConnection oraConn = new OracleConnection(connectionString))
        {
            oraConn.Open();
            OracleCommand oraCmd = new OracleCommand("CTI_DBA.CTI_DOCUMENT_PACK_TEST.CREATE_DOCUMENT");
            oraCmd.CommandType = CommandType.StoredProcedure;
            oraCmd.Connection = oraConn;
            OracleParameter oraParam;

            oraParam = new OracleParameter("IN_DOC_BODY", body);
            oraParam.OracleType = OracleType.VarChar;
            oraParam.Direction = ParameterDirection.Input;
            oraCmd.Parameters.Add(oraParam);

            oraCmd.ExecuteNonQuery();
        } 
```

IN_DOC_BODY 数据类型是 VARCHAR2(1000)。我还尝试使用 OracleType.NVarChar、OracleType.Char、OracleType.NChar 插入，但没有任何改变。我的问题在哪里？有什么建议么？我

# wordpress - 通过受人尊敬的类别旅行的导航链接

> ID：13495319
> 
> 赞同：0
> 
> 时间：2012-11-21T14:23:17.227
> 
> 标签：wordpress

如何在 Wordpress的**single.php**文件中制作导航链接以穿越受人尊敬的类别

```
<nav id="nav-single">
   <h3 class="assistive-text"><?php _e('Post navigation', 'twentyeleven'); ?></h3>
   <?php previous_post_link('%link', __('<div class="nav-previous"></div>', 'twentyeleven')); ?>
   <?php next_post_link('%link', __('<div class="nav-next"></div>', 'twentyeleven')); ?>
</nav> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T07:50:42.237

好的，我明白了...将第三个参数设置为 TRUE ($in_samecat = TRUE) 将遍历同一类别...谢谢

`<nav id="nav-single"> <h3 class="assistive-text"><?php _e('Post navigation', 'twentyeleven'); ?></h3> <?php previous_post_link('%link', __('<div class="nav-previous"></div>', 'twentyeleven'),TRUE); ?> <?php next_post_link('%link', __('<div class="nav-next"></div>', 'twentyeleven'),TRUE); ?> </nav>`

# ios - 如何删除 UIViewController？

> ID：13495326
> 
> 赞同：2
> 
> 时间：2012-11-21T14:23:47.393
> 
> 标签：ios, uiviewcontroller, ios6

在我的应用程序工作流程的某个时刻，我有一个显示`UIViewController`. 当我按下 Home 按钮时，我会离开应用程序，让它在后台运行。

但是，当我返回应用程序时，我希望该显示`UIViewController`不再出现。我希望它被删除或销毁或类似的东西。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T14:41:17.650

有一个您可以注册接收的通知，称为`UIApplicationDidEnterBackgroundNotification`(also `UIApplicationWillResignActiveNotification`)。如果您在视图控制器中监听它，您可以根据它最初的显示方式安排它被弹出或关闭。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T16:55:17.983

`viewcontroller`您可以在您的班级中向 UIApplicationDidEnterBackgroundNotification 添加观察者。在方法中试试这个`init`：

```
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(enterBackground) name:UIApplicationDidEnterBackgroundNotification object:nil]; 
```

然后在 enterBackground 方法中，您可以弹出或关闭您的`viewcontroller`.

记得叫这个

```
[[NSNotificationCenter defaultCenter] removeObserver:self name:UIApplicationDidEnterBackgroundNotification object:nil]; 
```

在里面`dealloc`

# google-app-engine - Java DrEdit 无法在 Google App Engine 上运行

> ID：13495334
> 
> 赞同：2
> 
> 时间：2012-11-21T14:24:14.957
> 
> 标签：google-app-engine, oauth-2.0, google-drive-api

我无法让 DrEdit 在 Google App Engine 上运行。我收到错误消息：500 服务器错误

我已尝试按照以下页面上的说明进行操作： [https ://developers.google.com/drive/examples/java](https://developers.google.com/drive/examples/java)

但是，当我收到以下说明时：

1.  在项目的 Eclipse 构建路径编辑器中，将 和 目录中的所有 JAR 添加到项目的构建路径中。

我有个问题！

在 Eclipse 中，我使用的是 appengine-java-sdk-1.7.3

当我尝试从 DrEdit 存储库添加 jar 时，DrEdit 似乎是使用 appengine-java-sdk-1.6.3 创建的，我最终得到了两个版本的混合。

所以我以不同的方式添加了 DrEdit。

基本上我从存储库中添加了 API 而不是 jars。

更详细的解释如下：

```
I created an Eclipse App Engine project
then copied the source files from com.google.drive.samples.dredit
to my own com.google.drive.samples.dredit
and I copied the source files from com.google.drive.samples.dredit.model
to my own com.google.drive.samples.dredit.model 
```

我还将静态目录文件结构复制到我自己的war目录中。

我还复制了存储库 web.xml、appengine-web.xml、client_secrets.json 和 logging.properties

我还用 index.jsp 复制了模板目录

然后我添加了 Drive API 和 Google OAuth2 API 以消除源文件上显示的红十字。

我还删除了 index.html

我将正确的详细信息放在 client_secrets.json 文件中，并将我的应用程序标识放在 appengine-web.xml 中

文件结构如下所示

[https://lh5.googleusercontent.com/-3Lh3PoZeTec/UKzXDfCzTlI/AAAAAAAAC98/ELcsRmhiCg0/s789/DrEditFileStructure3.png](https://lh5.googleusercontent.com/-3Lh3PoZeTec/UKzXDfCzTlI/AAAAAAAAC98/ELcsRmhiCg0/s789/DrEditFileStructure3.png)

当我尝试在 Google App Engine 上运行时，我收到 500 服务器错误。在日志中，我得到以下堆栈跟踪

这是堆栈跟踪

```
78.147.107.157 - - [22/Nov/2012:02:50:16 -0800] "GET / HTTP/1.1" 500 0 - "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.64 Safari/537.11" "oauth2dredit.appspot.com" ms=2303 cpu_ms=1039 loading_request=1 instance=00c61b117c1af24ed12b197a737ba95b241e522f
W 2012-11-22 02:50:16.055
Failed startup of context com.google.apphosting.utils.jetty.RuntimeAppEngineWebAppContext@1a02097{/,/base/data/home/apps/s~oauth2dredit/1.363349173399555415}
org.mortbay.util.MultiException[java.lang.UnsupportedClassVersionError: com/google/drive/samples/dredit/AboutServlet : Unsupported major.minor version 51.0, java.lang.UnsupportedClassVersionError: com/google/drive/samples/dredit/FileServlet : Unsupported major.minor version 51.0, java.lang.UnsupportedClassVersionError: com/google/drive/samples/dredit/StartPageServlet : Unsupported major.minor version 51.0, java.lang.UnsupportedClassVersionError: com/google/drive/samples/dredit/UserServlet : Unsupported major.minor version 51.0]
    at org.mortbay.jetty.servlet.ServletHandler.initialize(ServletHandler.java:656)
    at org.mortbay.jetty.servlet.Context.startContext(Context.java:140)
    at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1250)
    at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:517)
    at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:467)
    at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
    at com.google.apphosting.runtime.jetty.AppVersionHandlerMap.createHandler(AppVersionHandlerMap.java:219)
    at com.google.apphosting.runtime.jetty.AppVersionHandlerMap.getHandler(AppVersionHandlerMap.java:194)
    at com.google.apphosting.runtime.jetty.JettyServletEngineAdapter.serviceRequest(JettyServletEngineAdapter.java:134)
    at com.google.apphosting.runtime.JavaRuntime$RequestRunnable.run(JavaRuntime.java:447)
    at com.google.tracing.TraceContext$TraceContextRunnable.runInContext(TraceContext.java:454)
    at com.google.tracing.TraceContext$TraceContextRunnable$1.run(TraceContext.java:461)
    at com.google.tracing.TraceContext.runInContext(TraceContext.java:703)
    at com.google.tracing.TraceContext$AbstractTraceContextCallback.runInInheritedContextNoUnref(TraceContext.java:338)
    at com.google.tracing.TraceContext$AbstractTraceContextCallback.runInInheritedContext(TraceContext.java:330)
    at com.google.tracing.TraceContext$TraceContextRunnable.run(TraceContext.java:458)
    at com.google.apphosting.runtime.ThreadGroupPool$PoolEntry.run(ThreadGroupPool.java:251)
    at java.lang.Thread.run(Thread.java:679)
java.lang.UnsupportedClassVersionError: com/google/drive/samples/dredit/AboutServlet : Unsupported major.minor version 51.0
    at com.google.appengine.runtime.Request.process-b3e6d785ba51dcea(Request.java)
    at java.lang.ClassLoader.defineClass1(Native Method)
    at java.lang.ClassLoader.defineClass(ClassLoader.java:634)
    at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:142)
    at java.net.URLClassLoader.defineClass(URLClassLoader.java:277)
    at sun.reflect.GeneratedMethodAccessor5.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:616)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:266)
    at org.mortbay.util.Loader.loadClass(Loader.java:91)
    at org.mortbay.util.Loader.loadClass(Loader.java:71)
    at org.mortbay.jetty.servlet.Holder.doStart(Holder.java:73)
    at org.mortbay.jetty.servlet.ServletHolder.doStart(ServletHolder.java:242)
    at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
    at org.mortbay.jetty.servlet.ServletHandler.initialize(ServletHandler.java:685)
    at org.mortbay.jetty.servlet.Context.startContext(Context.java:140)
    at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1250)
    at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:517)
    at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:467)
    at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
    at com.google.tracing.TraceContext$TraceContextRunnable.runInContext(TraceContext.java:454)
    at com.google.tracing.TraceContext$TraceContextRunnable$1.run(TraceContext.java:461)
    at com.google.tracing.TraceContext.runInContext(TraceContext.java:703)
    at com.google.tracing.TraceContext$AbstractTraceContextCallback.runInInheritedContextNoUnref(TraceContext.java:338)
    at com.google.tracing.TraceContext$AbstractTraceContextCallback.runInInheritedContext(TraceContext.java:330)
    at com.google.tracing.TraceContext$TraceContextRunnable.run(TraceContext.java:458)
    at java.lang.Thread.run(Thread.java:679)
java.lang.UnsupportedClassVersionError: com/google/drive/samples/dredit/FileServlet : Unsupported major.minor version 51.0
    at com.google.appengine.runtime.Request.process-b3e6d785ba51dcea(Request.java)
    at java.lang.ClassLoader.defineClass1(Native Method)
    at java.lang.ClassLoader.defineClass(ClassLoader.java:634)
    at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:142)
    at java.net.URLClassLoader.defineClass(URLClassLoader.java:277)
    at sun.reflect.GeneratedMethodAccessor5.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:616)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:266)
    at org.mortbay.util.Loader.loadClass(Loader.java:91)
    at org.mortbay.util.Loader.loadClass(Loader.java:71)
    at org.mortbay.jetty.servlet.Holder.doStart(Holder.java:73)
    at org.mortbay.jetty.servlet.ServletHolder.doStart(ServletHolder.java:242)
    at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
    at org.mortbay.jetty.servlet.ServletHandler.initialize(ServletHandler.java:685)
    at org.mortbay.jetty.servlet.Context.startContext(Context.java:140)
    at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1250)
    at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:517)
    at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:467)
    at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
    at com.google.tracing.TraceContext$TraceContextRunnable.runInContext(TraceContext.java:454)
    at com.google.tracing.TraceContext$TraceContextRunnable$1.run(TraceContext.java:461)
    at com.google.tracing.TraceContext.runInContext(TraceContext.java:703)
    at com.google.tracing.TraceContext$AbstractTraceContextCallback.runInInheritedContextNoUnref(TraceContext.java:338)
    at com.google.tracing.TraceContext$AbstractTraceContextCallback.runInInheritedContext(TraceContext.java:330)
    at com.google.tracing.TraceContext$TraceContextRunnable.run(TraceContext.java:458)
    at java.lang.Thread.run(Thread.java:679)
java.lang.UnsupportedClassVersionError: com/google/drive/samples/dredit/StartPageServlet : Unsupported major.minor version 51.0
    at com.google.appengine.runtime.Request.process-b3e6d785ba51dcea(Request.java)
    at java.lang.ClassLoader.defineClass1(Native Method)
    at java.lang.ClassLoader.defineClass(ClassLoader.java:634)
    at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:142)
    at java.net.URLClassLoader.defineClass(URLClassLoader.java:277)
    at sun.reflect.GeneratedMethodAccessor5.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:616)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:266)
    at org.mortbay.util.Loader.loadClass(Loader.java:91)
    at org.mortbay.util.Loader.loadClass(Loader.java:71)
    at org.mortbay.jetty.servlet.Holder.doStart(Holder.java:73)
    at org.mortbay.jetty.servlet.ServletHolder.doStart(ServletHolder.java:242)
    at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
    at org.mortbay.jetty.servlet.ServletHandler.initialize(ServletHandler.java:685)
    at org.mortbay.jetty.servlet.Context.startContext(Context.java:140)
    at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1250)
    at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:517)
    at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:467)
    at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
    at com.google.tracing.TraceContext$TraceContextRunnable.runInContext(TraceContext.java:454)
<continued in next message>
W 2012-11-22 02:50:16.055
<continued from previous message>
    at com.google.tracing.TraceContext$TraceContextRunnable$1.run(TraceContext.java:461)
    at com.google.tracing.TraceContext.runInContext(TraceContext.java:703)
    at com.google.tracing.TraceContext$AbstractTraceContextCallback.runInInheritedContextNoUnref(TraceContext.java:338)
    at com.google.tracing.TraceContext$AbstractTraceContextCallback.runInInheritedContext(TraceContext.java:330)
    at com.google.tracing.TraceContext$TraceContextRunnable.run(TraceContext.java:458)
    at java.lang.Thread.run(Thread.java:679)
java.lang.UnsupportedClassVersionError: com/google/drive/samples/dredit/UserServlet : Unsupported major.minor version 51.0
    at com.google.appengine.runtime.Request.process-b3e6d785ba51dcea(Request.java)
    at java.lang.ClassLoader.defineClass1(Native Method)
    at java.lang.ClassLoader.defineClass(ClassLoader.java:634)
    at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:142)
    at java.net.URLClassLoader.defineClass(URLClassLoader.java:277)
    at sun.reflect.GeneratedMethodAccessor5.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:616)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:266)
    at org.mortbay.util.Loader.loadClass(Loader.java:91)
    at org.mortbay.util.Loader.loadClass(Loader.java:71)
    at org.mortbay.jetty.servlet.Holder.doStart(Holder.java:73)
    at org.mortbay.jetty.servlet.ServletHolder.doStart(ServletHolder.java:242)
    at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
    at org.mortbay.jetty.servlet.ServletHandler.initialize(ServletHandler.java:685)
    at org.mortbay.jetty.servlet.Context.startContext(Context.java:140)
    at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1250)
    at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:517)
    at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:467)
    at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
    at com.google.tracing.TraceContext$TraceContextRunnable.runInContext(TraceContext.java:454)
    at com.google.tracing.TraceContext$TraceContextRunnable$1.run(TraceContext.java:461)
    at com.google.tracing.TraceContext.runInContext(TraceContext.java:703)
    at com.google.tracing.TraceContext$AbstractTraceContextCallback.runInInheritedContextNoUnref(TraceContext.java:338)
    at com.google.tracing.TraceContext$AbstractTraceContextCallback.runInInheritedContext(TraceContext.java:330)
    at com.google.tracing.TraceContext$TraceContextRunnable.run(TraceContext.java:458)
    at java.lang.Thread.run(Thread.java:679)
C 2012-11-22 02:50:16.060
Uncaught exception from servlet
javax.servlet.UnavailableException: Initialization failed.
    at com.google.apphosting.runtime.jetty.AppVersionHandlerMap.createHandler(AppVersionHandlerMap.java:228)
    at com.google.apphosting.runtime.jetty.AppVersionHandlerMap.getHandler(AppVersionHandlerMap.java:194)
    at com.google.apphosting.runtime.jetty.JettyServletEngineAdapter.serviceRequest(JettyServletEngineAdapter.java:134)
    at com.google.apphosting.runtime.JavaRuntime$RequestRunnable.run(JavaRuntime.java:447)
    at com.google.tracing.TraceContext$TraceContextRunnable.runInContext(TraceContext.java:454)
    at com.google.tracing.TraceContext$TraceContextRunnable$1.run(TraceContext.java:461)
    at com.google.tracing.TraceContext.runInContext(TraceContext.java:703)
    at com.google.tracing.TraceContext$AbstractTraceContextCallback.runInInheritedContextNoUnref(TraceContext.java:338)
    at com.google.tracing.TraceContext$AbstractTraceContextCallback.runInInheritedContext(TraceContext.java:330)
    at com.google.tracing.TraceContext$TraceContextRunnable.run(TraceContext.java:458)
    at com.google.apphosting.runtime.ThreadGroupPool$PoolEntry.run(ThreadGroupPool.java:251)
    at java.lang.Thread.run(Thread.java:679)
I 2012-11-22 02:50:16.062
This request caused a new process to be started for your application, and thus caused your application code to be loaded for the first time. This request may thus take longer and use more CPU than a typical request for your application. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T13:15:03.450

我会说你正在使用 Java 7 构建，切换到 6。GAE 只是在 1.7.3 中添加了对 7 的初始支持，但我还没有看到它工作。

# jquery - 当通过 jQuery 更新 ControlToValidate 的值时，导致 ASP.NET RangeValidator 触发

> ID：13495343
> 
> 赞同：0
> 
> 时间：2012-11-21T14:25:13.437
> 
> 标签：jquery, asp.net, .net, validation

我有一组日期范围控件：

```
<div id="CustomDateRow" class="row-fluid" runat="server">
    <label class="span2 FieldLabel">
        Start Date:
    </label>
    <asp:TextBox ID="StartDate" CssClass="datepicker span3" runat="server" ClientIDMode="Static"></asp:TextBox>
    <label class="span2 FieldLabel">
        End Date:
    </label>
    <asp:TextBox ID="EndDate" CssClass="datepicker span3" runat="server" ClientIDMode="Static"></asp:TextBox>
</div> 
```

我正在将这些控件转换为 jQuery UI 日期选择器。

我需要确保用户在任何给定时间都不能选择超过 30 天。最初我计划设置`maxDate`时`EndDate`设置`StartDate`，但是有两个基本问题。

1.  JavaScript 中没有很好的`DateTime.AddMonths()`类似函数。
2.  这篇[SO 文章](https://stackoverflow.com/questions/4419804/restrict-date-in-jquery-datepicker-based-on-another-datepicker-or-textbox/4419824#comment18444599_4419824)让我意识到它对用户的友好程度确实要低得多。

所以，我想我将只使用 a`RangeValidator`并在每次值更改时验证两个日期之间的天数。

所以，我有一个`RangeValidator`这样的：

```
<div class="row-fluid">
    <asp:RangeValidator ID="DateRangeValidator" runat="server" ControlToValidate="DateRange"
        ErrorMessage="The date range must be at least one day and not more than thirty."
        EnableClientScript="true" MinimumValue="1" MaximumValue="30" CssClass="errortext span9 offset2"
        Display="Dynamic" />
</div> 
```

它正在验证一个基本的文本输入控件：

```
<asp:TextBox ID="DateRange" runat="server" ClientIDMode="Static" /> 
```

日期更改时在 JavaScript 中更新：

```
$('.datepicker').change(function () {
    var nDifference = Math.abs(new Date($('#StartDate').val()) - new Date($('#EndDate').val()));
    var one_day = 1000 * 60 * 60 * 24;
    $('#DateRange').val(Math.round(nDifference / one_day));
}); 
```

## 问题

即使当我通过 jQuery 设置它时值确实发生了变化，它`RangeValidator`也没有反应。但是，如果我在文本输入中键入值并使其`RangeValidator`按预期工作。

***我是否需要在控件上触发某种事件`DateRange`以强制`RangeValidator`执行？***

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T19:32:29.860

好吧，我最终做了两件非常简单的事情来解决这个问题，它们都驻留在 JavaScript 方法中来计算范围。这是工作代码。

```
$('.datepicker').change(function () {
    var nDifference = new Date($('#EndDate').val()) - new Date($('#StartDate').val());
    var one_day = 1000 * 60 * 60 * 24;
    $('#DateRange').val(Math.round(nDifference / one_day));
    Page_ClientValidate(null);
}); 
```

请注意，我摆脱`Math.abs`了`nDifference`计算，因为我需要真正的差异，无论是正面的还是负面的。最后，请注意我添加了行`Page_ClientValidate(null);`，这就是`RangeValidator`我设置验证的原因。

完美运行！

# mysql - 将 char 插入 MySQL varchar 值

> ID：13495355
> 
> 赞同：1
> 
> 时间：2012-11-21T14:25:45.583
> 
> 标签：mysql, substring, concat

是否有一个 MySQL 函数可以轻松地将一个或多个字符插入到 varchar 列的值中？

我想设置以下文本：

`B U 1 U 09 2011 Segs 1, 3 - 10 24 hours`

到

`B U 1 U N 09 2011 Segs 1, 3 - 10 24 hours`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T14:33:15.183

对于`SELECT`它的值，您可以使用：

```
select concat(left(col, 8), 'N ', substring(col, 9))
from table1 
```

如果你愿意，`UPDATE`你可以使用：

```
update table1
set col = concat(left(col, 8), 'N ', substring(col, 9)) 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/12b49/1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T14:40:30.063

尝试：

```
SELECT INSERT('B U 1 U 09 2011 Segs 1, 3 - 10 24 hours', 8, 0, ' N'); 
```

SQL小提琴：[http ://sqlfiddle.com/#!2/d41d8/3998](http://sqlfiddle.com/#!2/d41d8/3998)

更多信息：[http ://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_insert](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_insert)

# android - 如何禁用 Android 上的物理音量按钮？

> ID：13495360
> 
> 赞同：3
> 
> 时间：2012-11-21T14:26:05.047
> 
> 标签：android

我正在开发一个Android应用程序，我的应用程序一旦启动就会发出警报，但我想禁用外部音量按钮，这样当手机发出警报时，用户无法调低警报音量。我已经在我的手机上使用 Android 版本 2.3.5 进行了测试，但它无法正常工作。下面是我的编码。希望有人可以帮助我...谢谢。

```
@Override
public boolean onKeyDown(int keyCode, KeyEvent event){

    if (keyCode == KeyEvent.KEYCODE_VOLUME_UP){
        Toast.makeText(this, "Volume Up", Toast.LENGTH_LONG).show();
        return true;
    }

    if (keyCode == KeyEvent.KEYCODE_VOLUME_DOWN){
        Toast.makeText(this, "Volume Down", Toast.LENGTH_LONG).show();
        return true;
    }

    return super.onKeyDown(keyCode, event);
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-21T14:32:04.870

尝试覆盖`dispatchKeyEvent(KeyEvent event)`：

```
@Override
public boolean dispatchKeyEvent(KeyEvent event) {
    boolean result;
     switch( event.getKeyCode() ) {
        case KeyEvent.KEYCODE_VOLUME_UP:
        case KeyEvent.KEYCODE_VOLUME_DOWN:
            result = true;
            break;

         default:
            result= super.dispatchKeyEvent(event);
            break;
     }

     return result;
} 
```

另[见这篇文章](http://android-developers.blogspot.com/2009/12/back-and-other-hard-keys-three-stories.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T14:54:44.887

[最好的方法是在一个音频流（ AudioManager.STREAM_ALARM](http://developer.android.com/reference/android/media/AudioManager.html#STREAM_ALARM) ）上播放警报声音，并使音量按钮与另一个音频流（[`setVolumeControlStream(AudioManager.STREAM_MUSIC);`](http://developer.android.com/reference/android/app/Activity.html#setVolumeControlStream%28int%29)）相关联。[http://developer.android.com/training/managing-audio/volume-playback.html#HardwareVolumeKeys](http://developer.android.com/training/managing-audio/volume-playback.html#HardwareVolumeKeys)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-08-27T21:07:14.653

只需返回 true 即可禁用音量操作。现在您可以通过 onVolumeDown() 和 onVolumeUp() 函数执行其他操作。

```
 @Override
   public boolean onKeyDown(int keyCode, KeyEvent event) {
       if(keyCode==KeyEvent.KEYCODE_VOLUME_DOWN)
          onVolumeDown();
    if(keyCode==KeyEvent.KEYCODE_VOLUME_UP)
        onVolumeUp();

    return true;
    //return super.onKeyDown(keyCode, event);
} 
```

# java - 如何在 Java/Android 中查找两个日期之间的秒数时间间隔？

> ID：13495361
> 
> 赞同：0
> 
> 时间：2012-11-21T14:26:11.010
> 
> 标签：java, android

我认为这个问题可能是重复的，但是从这么多时间以来我一直在寻找这个问题的解决方案并且没有得到满意的结果。我的问题是我想在第二个日期之间找到一个时间间隔。因为我有时间戳值，我可以将时间戳转换为日期，如下所示

`Date newDate = new Date();`

`newDate.setTime(Long.parseLong("-978307200")*1000L);`

我在将时间戳转换为日期后得到这样的日期

`Sun Jan 01 05:30:00 GMT+05:30 1939`

我的问题是我想在这个日期和 1970 年之间以秒为单位找到时间间隔，所以任何小于 1970 的日期我都想以秒为单位计算时间间隔。

如果有人能帮助解决这个问题，我会很高兴

在此先感谢 Aamirkhan I。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T14:47:08.223

如果您在使用标准 Date api 时遇到问题 - 试试 Joda Time - 它更方便。

[乔达时间](http://joda-time.sourceforge.net/)

另请参阅有关类似问题的此堆栈溢出帖子：-

[如何使用 Joda Time 计算从现在开始的经过时间？](https://stackoverflow.com/questions/2179644/how-to-calculate-elapsed-time-from-now-with-joda-time)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-21T14:37:47.400

最好使用 Calendar API 而不是 Date。日历 API 更有用。

无论如何，要从 Date 对象中获取秒数，您可以使用 getTime 方法。

```
Date date = new Date();
(date.getTime()/1000) 
```

获取时间

public long getTime() 返回自 1970 年 1 月 1 日 00:00:00 GMT 以来此 Date 对象表示的毫秒数。返回： 自 1970 年 1 月 1 日 00:00:00 GMT 以来由该日期表示的毫秒数。

参考：[http ://docs.oracle.com/javase/6/docs/api/](http://docs.oracle.com/javase/6/docs/api/)

# jquery - jquery日期选择器日期格式分别获取变量

> ID：13495365
> 
> 赞同：0
> 
> 时间：2012-11-21T14:26:27.213
> 
> 标签：jquery

大家好，我正在尝试使用日期格式与日期选择器分开获取变量。我想获得这些变量的日期、月份和年份，但如何？

这是我的脚本

```
<script type="text/javascript">
    $(function () {
        $('.date').datepicker({ dateFormat: 'dd.MM.yy' });

    });
    </script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T14:40:08.190

要从 datepicker 获取日期，您应该使用`$(".date").datepicker("getDate")`.

代码：

```
var date = $(".date").datepicker('getDate');
alert(date.getDate());         // Day of the month
alert(date.getMonth());        // Month with a zero index
alert(date.getDay());          // Day of the week
alert(date.getFullYear());     // The "full" year, e.g. 2011 
```

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T14:45:09.807

你可以试试这个

```
$(function(){
    $('.date').datepicker({ 
        dateFormat: 'dd.MM.yy', 
        onSelect:function(text, ui){
            var dt=text.split('.');
            var d=dt[0]; m=dt[1]; y=dt[2];
            console.log(d); // day
            console.log(m); // month
            console.log(y);  // year
        }
    });
});​ 
```

每次您从中选择一个日期时，`datepicker`您都会在三个单独的变量中获得您的日、月和年。

[**演示**](http://jsfiddle.net/euzBz/1/)。

**更新：** 还请记住，用户可以通过键入直接从键盘更改/输入日期，因此在这种情况下，您必须使用`$('.date').on('change', function(){...})`来跟踪文本框更改事件。

```
// textbox change
$('.date').on('change', function(){
    var dt=$(this).val();
    if(dt.match(/^(\d{2}).([a-zA-Z]+).(\d{4})$/))
    {
        var dt=dt.split('.');
        var d=dt[0]; m=dt[1]; y=dt[2];
        console.log(d);
        console.log(m);
        console.log(y);
    }
    else alert('Invalid date format !\n\nValid format example: 05.December.2012');
}); 
```

[**演示**](http://jsfiddle.net/euzBz/2/)（带有文本框更改事件）。

# ios - 退出应用后核心数据丢失关系数据

> ID：13495366
> 
> 赞同：0
> 
> 时间：2012-11-21T14:26:30.653
> 
> 标签：ios, core-data, relationship

这对我来说真的很奇怪。我有一个核心数据数据库。我有两个表，我们称它们为 tableA 和 tableB。tableA 有很多数据，可能有数千条记录。tableB 有几条记录。tableB 与 tableA 有 9 个关系。这些关系中的每一个对于 tableB 都是一对多的。

应用程序运行时，这一切正常；但是，如果我终止应用程序（在 xCode 中，停止），许多关系将变为空。而且非常一致。tableB 中的最新记录总是可以的，而旧记录都是某些关系的缺失数据。

表 B 中的关系是一对多的。最初，我从 tableA 创建了反向一对多关系。注意到这个问题后，我删除了反向关系。该应用程序仍然可以正常运行，直到我终止并重新启动它，尽管我确实收到了没有相反的警告。

我确保对上下文进行保存，并且检查了 context.hasChanges 并且它是错误的。

任何帮助，将不胜感激。这是我今天的拔毛器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T14:34:00.010

当您从调试器中硬杀死这样的应用程序时，您不可能期望它通过正常的终止处理。

当您使用 UIManagedDocument 或任何类型的异步保存操作时，这一点更加明显。

当您通过正常的应用程序终止方法终止设备上的应用程序时会发生什么？

# drupal - 如何在drupal 7中呈现评论线程

> ID：13495367
> 
> 赞同：5
> 
> 时间：2012-11-21T14:26:31.723
> 
> 标签：drupal, drupal-7

我创建了一个自定义内容 page.tpl.php 文件，我正在尝试显示整个评论部分。到目前为止，我已经申请显示评论部分的开头，用户可以在其中输入评论，但它没有打印评论线程。我用来打印评论的代码是

`<?php print drupal_render(drupal_get_form("comment_node_{$node->type}_form", (object) array('nid' => $node->nid))); ?>`

但这不显示评论线程，只显示表单。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T15:38:45.080

最好使用[`comment_node_page_additions()`](http://api.drupal.org/api/drupal/modules%21comment%21comment.module/function/comment_node_page_additions/7)：

> 为节点详细信息页面构建评论相关元素。

例如

```
$rendered = render(comment_node_page_additions($node)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T14:41:30.827

在您的使用以下代码`page.tpl.php`

```
<?php print render($content['comments']);?> 
```

# javascript - 带有可扩展日历的 ExtJS 3.4 - 多天事件显示为全天事件

> ID：13495370
> 
> 赞同：1
> 
> 时间：2012-11-21T14:26:41.723
> 
> 标签：javascript, extjs, calendar

我将 ExtJS 3.4 与与我的 extjs 版本兼容的可扩展日历一起使用，但我发现同样的问题也适用于最新的日历：[http ://ext.ensible.com/deploy/dev/examples/calendar/basic .html](http://ext.ensible.com/deploy/dev/examples/calendar/basic.html)。

我的确切意思是什么：我创建了一个为期 3 天的活动（从今天下午 3 点到后天下午 5 点） - 该活动在周视图中显示为全天活动。这在某种程度上是不正确的。我希望它从今天下午 3 点到后天下午 5 点显示为阴影......有没有办法做到这一点？

# xpages - 循环收集会导致锁定

> ID：13495375
> 
> 赞同：0
> 
> 时间：2012-11-21T14:26:55.097
> 
> 标签：xpages

我正在搜索然后遍历结果。这导致我的代码被锁定，更糟糕的是，它锁定了该数据库以防进一步使用。即使在浏览器关闭后。似乎这个“锁定”在一段时间后被清除，直到我再次尝试我的代码。我将改变执行此特定任务的方式，但我很好奇导致此锁定的原因。

```
 var collection = database.search("Form = 'Request01' & Status='Approved'");

if (collection.getCount() == 0)
{
    getComponent("panel1").setRendered(false);
    getComponent("panel2").setRendered(true);
    getComponent("panel4").setRendered(true);
    return; 
}

dBar.info("Approved Requests Found= " + collection.getCount());

var item:NotesItem = document1.replaceItemValue("DocIds","AAAA");

var doc:NotesDocument = collection.getFirstDocument();

while (doc != null)
{   
    try
    {
        var tmpDoc = collection.getNextDocument(doc);
        item.appendToTextList(doc.getNoteID());
        dBar.info("Processing document: " + doc.getNoteID() )
        doc.recycle();
        doc = tmpDoc;

    }
    catch(e)
    {
        dBar.error(e.message);

    }
}
document1.save(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-22T07:28:43.250

以下行...

```
var item:NotesItem = document1.replaceItemValue("DocIds","AAAA"); 
```

...返回*void*，您的变量*item*未定义。用这个的下一个操作

```
item.appendToTextList(doc.getNoteID()); 
```

引发错误并始终在您的*catch* -Block 中结束。然后，下一个文档**永远不会**被提取，你有一个无限循环。

**编辑**：
replaceItemValue方法通常返回 NotesItem，但不返回 NotesXspDocument *！*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T20:19:25.913

我不确定您的数据库中有多少文档。我看到两个潜在的问题：

1) db.search （在我看来）不推荐使用，因为它会导致性能问题。不确定它是否与您的问题有关，而不是使用 db.search 我建议使用其他东西，例如具有与您的查询匹配的选择公式的视图。

2）如果您的数据库有许多与您的查询匹配的文档，则 java 代码可能会导致问题。据我所知，您不应该使用 java 获取超过 10k 的多米诺骨牌对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-22T06:12:20.823

至少有两种调试方法。

在服务器上安装 XPages Toolbox。使用 CPU 分析器查看最耗时的内容。

[http://www.openntf.org/internal/home.nsf/project.xsp?action=openDocument&name=xpages%20toolbox](http://www.openntf.org/internal/home.nsf/project.xsp?action=openDocument&name=xpages%20toolbox)

将代码改写成java，在服务端开启调试，远程调试。这是一个视频，向您展示如何做到这一点：

[http://www-10.lotus.com/ldd/ddwiki.nsf/dx/Debug_Java_for_XPages_in_NSFs](http://www-10.lotus.com/ldd/ddwiki.nsf/dx/Debug_Java_for_XPages_in_NSFs)

# vbscript - 使用 vbscript 将邮件导出到单个文本文件

> ID：13495378
> 
> 赞同：0
> 
> 时间：2012-11-21T14:27:03.063
> 
> 标签：vbscript

如何将Outlook收件箱中的所有电子邮件导出到单个文本文件？到目前为止，我有将邮件导出到文本文件的代码，但每封邮件都保存在单独的文本文件中。我需要单个文本文件

```
Sub saveEmailTxt()
Dim objItem As Object 

Dim iCount As Integer 'iterate over all Items in the current folder and save the body as textfile in c:\' 

For Each objItem In ActiveExplorer.CurrentFolder.Items 
objItem.SaveAs "C:\Mail" & CStr(iCount) & ".txt", olSaveAsText 
iCount = iCount + 1 
Next 

End Sub 
```

这是我之前的代码，它将保存到文本文件中，但它会为每封邮件创建单独的文本文件。

# .net - 位图如何存储在 .NET 的内存中？

> ID：13495382
> 
> 赞同：6
> 
> 时间：2012-11-21T14:27:11.270
> 
> 标签：.net, image, performance, architecture, bitmap

在 .NET 中，您通常使用 Bitmap 类来存储图像。要快速访问它，您需要调用[lock() 和 unlock()](http://www.codeproject.com/Tips/240428/Work-with-bitmap-faster-with-Csharp)将位图的内容复制到内存中。那么，这是否意味着位图在锁定之前没有存储在打包的内存数组中？

究竟需要锁定什么？即为什么平台不能简单地返回指向位图第一个像素的指针，让您直接访问像素？（除了“不安全”的内存访问注意事项）

一些可能的原因：

*   位图以原始压缩形式存储以节省内存（PNG、JPEG 等）
*   位图以 24-bpp 格式存储，因此访问速度比 32-bpp 图像慢
*   位图未存储在打包内存数组中，并且是碎片化的，因此无法快速读取/写入
*   位图以未公开的方式存储，平台不希望您访问实际的位图数据内存 - 迫使您使用 lock() 在内存中创建它的副本

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-21T15:36:30.710

位图以惰性方式读取。实际使用的算法在很大程度上取决于图像格式，.bmp 文件很容易，.jpeg 文件就不那么容易了。在底层，GDI+ 创建一个内存映射文件，在必要时利用操作系统的按需分页虚拟内存映射功能将文件数据映射到 RAM。正是这个 MMF 臭名昭著地在文件上创建了一个锁，并导致您在尝试将图像保存回具有相同名称的文件时遇到异常。

Bitmap.LockBits() 创建一个单独的缓冲区，将像素数据从 MMF 映射到内存中具有请求的像素格式的区域。现在，您拥有了定义明确的格式的数据，该格式独立于文件中的格式。调用 UnlockBits() 将修改后的数据写回（如果有）。文件中的数据如何与修改后的像素重新组合并没有具体说明，并且可能很大程度上取决于编解码器。

当您在其他方法中使用位图时，会发生这种完全相同的锁定，这是看不见的。就像使用 Graphics.DrawImage() 绘制图像一样。当你使用 Bitmap.GetPixel() 时臭名昭著。正如您现在可以猜到的那样，在锁定调用时转换像素数据涉及相当多的开销，原因是 GetPixel() 如此缓慢，因为您对位图中的每个像素而不是只执行一次，因为DrawImage 和 LockBits() 可以。

还应该清楚的是，开销在很大程度上取决于图像文件格式、即时解码像素数据的费用、解码器完成的缓存量、文件的像素格式与您在 LockBits() 中要求的像素格式。这里发生的事情太多了，无法做出可预测的性能猜测，您必须对其进行分析。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-21T14:34:49.527

> 位图以未公开的方式存储，平台不希望您访问实际的位图数据内存 - 迫使您使用 lock() 在内存中创建它的副本

这个，我想。位图存储在 GDI 中，每次调用`GetPixel()`都会变成对`GdipBitmapGetPixel()`in的调用[`gdiplus.dll`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms533798%28v=vs.85%29.aspx)。

[`Bitmap.LockBits()`](http://msdn.microsoft.com/en-us/library/5ey6h79d%28v=vs.100%29.aspx)，在 GDI 中调用`Bitmap::Lockbits`，将立即返回 GDI 为给定图像保存的所有像素，作为托管`BitmapData`对象。

文档[`Bitmap::Lockbits`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms536298%28v=vs.85%29.aspx)说：

> 锁定该位图的一个矩形部分并提供一个临时缓冲区，您可以使用该缓冲区以指定格式读取或写入像素数据。当您调用 Bitmap::UnlockBits 时，您写入缓冲区的任何像素数据都会复制到 Bitmap 对象。

在 GDI 文档中，我找不到任何其他方式来访问“原始”位图，所以我认为这是因为 GDI 的设计方式（可能是因为 GDI 将位图存储在（视频？）内存中的设备依赖方式？） ，因此如果*要*`LockBits`对“原始”位图数据进行操作，则必须调用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T14:48:12.043

> 为什么平台不能简单地返回指向位图第一个像素的指针并让您直接访问像素？

只是一个想法：所有图像数据（“像素”）都可以存储在视频卡的内存（而不是 CPU 的内存）上。因此，无法从 CPU/应用程序直接访问图像数据。因此，应该有一种特殊的方式来通过请求从 CPU 获取对图像数据的访问。像一个`LockBits/UnockBits`.

# linux - Linux着色cp

> ID：13495383
> 
> 赞同：0
> 
> 时间：2012-11-21T14:27:15.457
> 
> 标签：linux, colors, cp

简单的问题，我希望。我更喜欢使用别名为**cp -i的****cp**命令来防止意外破坏文件。有没有办法让“你想覆盖......”的消息打印是彩色的？该消息与其他所有内容的颜色相同，并且作为一个有视力障碍的人，如果该消息是突出显示的颜色会很有帮助。

# c++ - 如何在发布中排除测试用例（gTest）

> ID：13495387
> 
> 赞同：0
> 
> 时间：2012-11-21T14:27:32.743
> 
> 标签：c++, testing, release, googletest

如果我使用 g(oogle)Test，这些 litte google 宏就像`FRIEND_TEST(Test, Proc)`分布在我的代码中的任何地方。是否会自动将它们排除在构建之外，还是我真的必须用 包围它们`#ifdefs`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T14:46:10.800

你不需要做任何这样的事情。`friend`声明是完全无害的，不会在生产代码中产生任何开销。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-28T15:35:00.873

您可以拥有朋友 GTest 案例，如此处所述

[如何让我的课程成为 google-test 课程的朋友？](https://stackoverflow.com/questions/2396370/how-to-make-google-test-classes-friends-with-my-classes)

如前所述，使用这些宏没有开销。

此外，您可以在不使用`FRIEND_TEST`. 其中之一是在夹具类中为测试类的私有成员编写访问器，然后在测试中使用访问器：

```
class Foo {
  friend class FooTest;
  ...
};

class FooTest : public ::testing::Test {
 protected:
  ...
  T1 get_private_member1(Foo* obj) {
    return obj->private_member1_;
  }
};

TEST_F(FooTest, Test1) {
  ...
  get_private_member1(x)
  ...
} 
```

# fortran - 在 Fortran 95 中将任意浮点字符串转换为实数

> ID：13495388
> 
> 赞同：5
> 
> 时间：2012-11-21T14:27:39.700
> 
> 标签：fortran, fortran90, fortran95

是否有任何简单的方法可以将任意浮点字符串转换为 fortran 中的实数？想到类似的东西`strtod`？语句的问题`READ`是所有浮点格式编辑描述符都需要明确的宽度。到目前为止，我做的最好的解决方法是：

```
pure function strtod(s)
  real(kind=8) :: strtod
  character(len=*), intent(in) :: s
  character(len=32) :: fmt
  integer :: dot
  dot = index(s, ".")
  if(dot < 1) then
     write(fmt, '("(F",I0,".0)")'), len_trim(s)
  else
     write(fmt, '("(F",I0,".",I0,")")'), len_trim(s), len_trim(s)-dot
  end if
  read(s,fmt), strtod
end function strtod 
```

但我想知道我是否遗漏了什么，可能有更好的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T14:37:08.367

我肯定错过了什么。用列表指示做这件事有什么问题？

```
[luser@cromer stackoverflow]$ cat char2.f90
Program char2

  Implicit None

  Integer, Parameter :: wp = Selected_real_kind( 12, 70 )

  Real( wp ) :: a

  Character( Len = 32 ) :: s

  s = '0.'
  Read( s, * ) a
  Write( *, * ) a

  s = '1e10'
  Read( s, * ) a
  Write( *, * ) a

End Program char2
[luser@cromer stackoverflow]$ nagfor -C=all -C=undefined char2.f90
NAG Fortran Compiler Release 5.3.1 pre-release(904)
[NAG Fortran Compiler normal termination]
[luser@cromer stackoverflow]$ ./a.out
   0.0000000000000000
   1.0000000000000000E+10 
```

# amazon-s3 - 使用 Aws sdk 从 s3 下载文件时找不到类异常

> ID：13495389
> 
> 赞同：1
> 
> 时间：2012-11-21T14:27:45.680
> 
> 标签：amazon-s3, amazon-web-services, classnotfoundexception

```
I'm using AWS sdk for downloading an object from S3.when i run the program,i keep getting Class not found errors: 
```

java.lang.ClassNotFoundException: org.apache.http.Consts java.lang.ClassNotFoundException: org.apache.hhtp.params.BasicHttpParams java.lang.ClassNotFoundException:org.apache.http.impl.conn.tsccm.ThreadSafeClientConnManager 我已经在我的应用程序中包含 aws-java-sdk 1.3.26 jar 文件和 httpcore 4.1 和 httpclient 4.2.1 jar 仍然出现错误。我在我的程序中编写了以下代码以从 amazon s3 下载文件：

```
AWSCredentials myCredentials = new BasicAWSCredentials(
            credentials);
     AmazonS3Client s3Client = new AmazonS3Client(myCredentials);
     S3Object object = s3Client.getObject(bucket, key);
     InputStream is=object.getObjectContent() 
```

无法解决错误。请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T13:54:15.253

尝试使用 httpclient 4.1.1。

4.2+ 弃用/更改了一些功能

# delphi - Delphi客户端服务器数组发送

> ID：13495395
> 
> 赞同：6
> 
> 时间：2012-11-21T14:28:04.257
> 
> 标签：delphi, delphi-7, object-serialization

我需要将一个动态的对象数组从服务器发送到客户端。一个数组的例子，它包含类对象`Figure`及其坐标、颜色等信息。

我试图使用这样的东西来发送数据：

```
for i := 0 to ServerSocket.Socket.ActiveConnections - 1 do
begin
  ServerSocket.Socket.Connections[i].SendText(some values); // then parsing this text to get values
end; 
```

但我认为这样做真的很糟糕。那么，请您告诉我如何发送和接收某些对象数组的正确方法（使用`IdTCPClient/Server`or `Client/ServerSockets`）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T16:12:23.510

您必须在客户端和服务器之间序列化您的动态数组。

第一次尝试是使用您自己的序列化，例如，如果这是一个字符串数组，则使用#13#10 (CRLF) 分隔的内容，或者使用二进制序列化。

在 Delphi 7（及更高版本）下，您可以使用[我们的动态数组包装器](http://blog.synopse.info/post/2011/03/12/TDynArray-and-Record-compare/load/save-using-fast-RTTI)，它可以序列化为[JSON](http://blog.synopse.info/post/2012/04/12/Custom-JSON-serialization-of-any-dynamic-array-content)或二进制文件。它将使用可用的 RTTI 直接完成所有操作。它适用于所有基本类型：整数、浮点数、字符串、嵌套数组，但不适用于类实例。

对于对象的动态数组（类实例），您需要手动进行序列化。使用`TReader`可能会有所帮助，或者您必须自己编写代码。最好将每一侧的所有项目序列化为一个流，然后一次发送内容，以获得更好的性能。

# php - 库存数据结转至次日

> ID：13495397
> 
> 赞同：1
> 
> 时间：2012-11-21T14:28:08.750
> 
> 标签：php, mysql, stock

我有如下库存表：

```
date         item   new stock    sale  total
1-1-2000     abc      3          2     1
1-1-2000     bcd      4          2     2
1-1-2000     ffs      9          1     8 
```

我需要“每个产品的总价值应该在第二天结转。我如何在 mySQL 中做到这一点。数据结转过程每天进行。如果我在第二天添加条目，它应该计算“总计”的最后一天值。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T15:22:56.500

```
CREATE TABLE items (
itemid int not null AUTO_INCREMENT PRIMARY KEY,
itemname varchar(40) not null,
onhand int not null, # current inv based on sales and inv adjustments
price decimal (10,2) not null   # default price per item
) engine=innodb;

CREATE TABLE sale (
saleid int not null AUTO_INCREMENT PRIMARY KEY, # basically an invoice #
customerid int not null,    # joined to a customer table
saledate timestamp not null
) engine=innodb;

CREATE TABLE sale_detail (
saleid int not null,        # invoice #
lineid int not null,        # lines 1 and up for this invoice
itemid int not null,        # item sold
qty int not null,           # quantity sold
price decimal (10,2) not null   # price per item can be overriden from items table value
) engine=innodb;

CREATE TABLE inventory_adj (
adjid int not null AUTO_INCREMENT PRIMARY KEY,
itemid int not null,
trans_typ int not null,     # 0=purchase stock, 1=inventory adj, 2=shrinkage, 3=return, etc
adjdate timestamp not null, # now()
qty int not null            # amt of change, positive is acquisition, negative is depletion
) engine=innodb; 
```

用现有量为您的项目表准备好。这是您的库存水平。从销售量下降，随着购买量上升到inventory_adj 表中，当你盘点时也在那里得到调整，等等。这是一个规范化的数据模型。诚然，在技术上不需要保留现有项目，它可以即时计算，但这有点慢。只要您创建交易并根据销售等进行即时更新并提交交易，您就是安全的。另外，这可以让您更好地了解发生了什么让您到达那里。当然，添加其他列，例如在销售和库存调整中输入的用户名称。

# php - 只收到第一个推送通知 PHP

> ID：13495398
> 
> 赞同：0
> 
> 时间：2012-11-21T14:28:12.783
> 
> 标签：php, ios, push

我有一个小的 PHP 脚本，可以将推送通知发送到多个设备。内容因设备而异。不知何故，只收到了第一个请求，所以只有队列中的第一个设备正在接收推送通知。有什么错误？

```
$sql = "SELECT * FROM pushdevices";
$query = mysql_query($sql);
$apnsHost = 'gateway.push.apple.com';
$apnsPort = 2195;
$apnsCert = ...;

$streamContext = stream_context_create();
stream_context_set_option($streamContext, 'ssl', 'local_cert', $apnsCert);

$apns = stream_socket_client('ssl://' . $apnsHost . ':' . $apnsPort, $error, $errorString, 2, STREAM_CLIENT_CONNECT, $streamContext);
while($result = mysql_fetch_assoc($query)) {
    [...]
        $deviceToken = $result["deviceToken"]; 
            $alertBody = '...';
        $payload['aps'] = array('alert' => $alertBody, 'badge' => $badge, 'sound' => 'default');
        $payload = json_encode($payload);

        if ($apns)
        {
          $apnsMessage = chr(0) . chr(0) . chr(32) . pack('H*', str_replace(' ', '', $deviceToken)) . chr(0) . chr(strlen($payload)) . $payload;
          $is = fwrite($apns, $apnsMessage);

          echo "sent: $deviceToken<br />";
        }
        else
        {
          echo "Fehler!";
          var_dump($error);
          var_dump($errorString);
        }
    }
}
 fclose($apns);
?> 
```

在输出中它说发送到每个设备，但只有第一个是接收的。如果我取 $is (fwrite) 的返回值，第一次是 140，然后是 155。也许这是一个错误代码？

感谢您的回答！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T18:28:57.553

我发现了问题，我只需要`$payload`在最后重置 -variable 即可。现在它正在工作！

# c# - 时间：2019-05-10 标签：c#chartsbindingsourceupdate

> ID：13495401
> 
> 赞同：0
> 
> 时间：2012-11-21T14:28:19.870
> 
> 标签：c#, data-binding, charts

我对绑定源不太熟悉。简短的问题是：如何将图表绑定到数据源，以便在更改 BindingNavigator 时图表显示会更新？

我冗长的解释如下：

我有一个已导入 C# VS 2010 Express 的数据源。它是一个相关数据集，其中有 2 个表（资产、历史价格），其中每个资产都有一个相关历史价格表。

在 BindingNavigator 的帮助下，我只需将数据源拖放到表单中，就可以创建我想要的视图。我也将 Historical_prices 表的 DataGrid 视图拖到表单中，并在单击 BindingNavigator 时更新

然后我在表单中创建了一个图表，我选择了 DataSource 作为history_pricesBindingSource。它加载

我希望能够在 BindingBavigator 更改但当前没有更改时使用不同的 Historical_prices 更新图表。有任何想法吗？

我尝试添加`chart1.Update();`BindingNavigatorSaveItem_Click 事件，但没有骰子。

非常感谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T15:23:38.090

绑定实际上需要是数据绑定的，而不仅仅是分配的。您所做的实际上是创建了一个一次性绑定，该绑定在运行时在初始化或赋值期间发生。

这意味着当源（数据源）由视图创建时，您的目标（图表）仅更新一次。

您正在寻找的是双向绑定。以便在源被修改时随时更新目标。

要实现这一点，您通常需要使用双向绑定语法将 DataSource 绑定到 TargetProperty。

```
<Toolkit:Chart x:Name="myChart" DataSource="{Binding historical_PricesDataSource, Mode=TwoWay}" /> 
```

您的数据源将需要实现 INotifyPropertyChanged 接口，以便通知 UI 它需要更新。

实现 INotifyPropertyChanged 的​​代码是：

> 公共事件 PropertyChangedEventHandler PropertyChanged = delegate{};

```
 // This method is called by the Set accessor of each property. 
    // The CallerMemberName attribute that is applied to the optional propertyName 
    // parameter causes the property name of the caller to be substituted as an argument. 
    private void NotifyPropertyChanged([CallerMemberName] String propertyName = "")
    {
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
        }
    } 
```

有关 INotifyPropertyChanged 的​​更多信息：http: [//msdn.microsoft.com/en-us/library/ms229614.aspx](http://msdn.microsoft.com/en-us/library/ms229614.aspx)

# scale - 如何在 Kinect 中使用缩放图像进行联合跟踪

> ID：13495402
> 
> 赞同：2
> 
> 时间：2012-11-21T14:28:24.257
> 
> 标签：scale, kinect, kinect-sdk

我试图用 kinect 做一些联合跟踪（只是在我的右手里放一个椭圆）对于默认的 640x480 图像一切正常，我以[这个](http://ak.channel9.msdn.com/ch9/e017/c2943395-cca6-4601-a493-9fea003de017/SkeletalTrackingFundamentals_high_ch9.mp4)channel9 视频为基础。我的代码，更新为使用新的 CoordinateMapper 类在这里

```
 ...
CoordinateMapper cm = new CoordinateMapper(this.KinectSensorManager.KinectSensor);
ColorImagePoint handColorPoint = cm.MapSkeletonPointToColorPoint(atualSkeleton.Joints[JointType.HandRight].Position, ColorImageFormat.RgbResolution640x480Fps30);

Canvas.SetLeft(elipseHead, (handColorPoint.X) - (elipseHead.Width / 2)); // center of the ellipse in center of the joint
Canvas.SetTop(elipseHead, (handColorPoint.Y) - (elipseHead.Height / 2)); 
```

这行得通。问题是：

**如何在缩放图像中进行联合跟踪，例如 540x380？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T20:29:38.423

解决这个问题的方法很简单，我搞定了。

需要做的是找到一些适用于该职位的因素。这个因素可以通过 Kinect 的实际 ColorImageFormat 并除以所需的大小来找到，例如：

假设我正在使用该`RgbResolution640x480Fps30`格式并且我的图像（ColorViewer）有 220x240。因此，让我们找出 X 的因数：

```
double factorX = (640 / 220); // the factor is 2.90909090... 
```

y 的因数：

```
double factorY = (480/ 240); // the factor is 2... 
```

现在，我使用这个因子调整椭圆的位置。

```
Canvas.SetLeft(elipseHead, (handColorPoint.X / (2.909090)) - (elipseHead.Width / 2));
Canvas.SetTop(elipseHead, (handColorPoint.Y / (2)) - (elipseHead.Height / 2)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T17:53:14.377

我还没用过`CoordinateMapper`，现在我的 Kinect 也不在前面，所以我先把这个扔掉。当我再次使用 Kinect 时，我会看到更新。

Coding4Fun [Kinect Toolkit](http://c4fkinect.codeplex.com/)有一个`ScaleTo`扩展作为库的一部分。这增加了获取关节并将其缩放到任何显示分辨率的能力。

缩放函数如下所示：

```
private static float Scale(int maxPixel, float maxSkeleton, float position)
{
    float value = ((((maxPixel / maxSkeleton) / 2) * position) + (maxPixel/2));
    if(value > maxPixel)
        return maxPixel;
    if(value < 0)
        return 0;
    return value;
} 
```

`maxPixel`= 宽度或高度，取决于缩放的坐标。 `maxSkeleton`= 将此设置为 1。 `position`=要缩放的关节的`X`或坐标。`Y`

如果你只包含上面的函数，你可以这样调用它：

```
Canvas.SetLeft(e, Scale(640, 1, joint.Position.X));
Canvas.SetTop(e, Scale(480, 1, -joint.Position.Y)); 
```

... 用不同的比例替换您的 640 和 480。

如果您包含[Coding4Fun Kinect Toolkit](http://c4fkinect.codeplex.com/)，而不是重写代码，您可以像这样调用它：

```
scaledJoin = rawJoint.ScaleTo(640, 480); 
```

...然后插入你需要的东西。

# android - Android 的 BaseAdapter 是适配器模式的一个例子吗？

> ID：13495405
> 
> 赞同：10
> 
> 时间：2012-11-21T14:28:33.163
> 
> 标签：android, design-patterns, adapter, baseadapter

Android 的 BaseAdapter 类的名称中是否有“适配器”是因为它遵循适配器模式，还是只是巧合？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-11-21T14:32:27.223

[来自维基百科](http://en.wikipedia.org/wiki/Adapter_pattern)

> 在计算机编程中，适配器模式（通常称为包装器模式或简称为包装器）是一种将类的一个接口转换为兼容接口的设计模式。[1](http://en.wikipedia.org/wiki/Adapter_pattern) 适配器通过在使用原始接口的同时向客户端提供其接口，使通常由于接口不兼容而无法正常工作的类一起工作。

所以，让我们来分析一下。BaseAdapters 为需要适配器的程序指定一个接口。其实这个接口叫做Adapter。此接口指定获取任意列表所需的信息，并将其转换为任意长度的视图集。因此，BaseAdapter 将您的自定义输入格式（特别是，如果您对其进行扩展）适应 Adapter 接口。因此，它是一种适配器设计模式。

# jquery - jQuery .listview('refresh') 不起作用

> ID：13495406
> 
> 赞同：0
> 
> 时间：2012-11-21T14:28:35.500
> 
> 标签：jquery, jquery-mobile

我在使用 ('refresh') 时遇到问题。我有 dis **listview**

```
<div id="DetallePedidoRegistros" class="ui-collapsible-set" data-role="collapsible-set" data-inset="true" data-filter="true" data-mini="true">
    <div class="ui-collapsible ui-collapsible-inset" data-role="collapsible" data-collapsed="false"><h3 class="ui-collapsible-heading"><a class="ui-collapsible-heading-toggle ui-btn ui-btn-up-a ui-mini ui-btn-icon-left ui-corner-top" href="#" data-theme="a" data-icon="plus" data-corners="false" data-shadow="false" data-iconshadow="true" data-wrapperEls="span" data-iconpos="left" data-mini="true"><span class="ui-btn-inner ui-corner-top"><span class="ui-btn-text">Datos del Pedido<span class="ui-collapsible-heading-status"> click to collapse contents</span></span><span class="ui-icon ui-icon-shadow ui-icon-minus">&nbsp;</span></span></a></h3><div aria-hidden="false" class="ui-collapsible-content ui-corner-bottom">

        Abierto por Model.StrUsuarioGenera<br>
        A las Model.DatFechaDocumento<br>    
        Mesa: Model.IntIdMesa
    </div></div>        
</div> 
```

后来我使用 post 附加元素

```
function actualizarDetallePedido(tcLink) {
   $.post(tcLink,
      function (detallepedido) {
        var id = $(detallepedido).attr('id');
        $("#DetalleDocumento").append(detallepedido);
        $("#DetalleDocumento").listview();
        $(this).listview('refresh');
     }
   );
} 
```

它正确显示了项目，但作为 HTML 代码，它不显示为 jquerymobile 对象，刷新它的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T14:44:09.760

无意间找到了答案，我正在尝试刷新并添加这行代码

```
function actualizarDetallePedido(tcLink) {
  $.post(tcLink,
    function (detallepedido) {
        var id = $(detallepedido).attr('id');
        $("#DetalleDocumento").append(detallepedido);
        $('#' + id).collapsible(); //This line initializes  the object and don't need to refresh it 
    }
  );
} 
```

# c# - 如何优化应用速度+实体框架？

> ID：13495407
> 
> 赞同：0
> 
> 时间：2012-11-21T14:28:35.557
> 
> 标签：c#, winforms, entity-framework, sql-server-ce

我有一个带有 11 个数据库的 Windows 应用程序，其中包含大约 1.5 Gb 的文本信息。

我使用 SQL Server CE 和实体框架。

我的应用程序已经完成，但是对于我的应用程序的新版本，它必须从 DVD 运行。应用程序的每个部分都有一个单独的数据库。

一切都很好，但每个数据库的第一次查询需要大约 40 秒才能运行。我对此进行了很多搜索，并找到了以下解决方案：

1.  预生成视图以避免第一次执行
2.  摆脱 linq，并在 ADO.NET 中重写它
3.  首先分析 Entity Framework 实际发出的 SQL 命令

和 ...

我想问女巫是最好最快的方法吗？

# spring - 如何使用 logback 1.0.0 在经过时间或超出大小时滚动日志？

> ID：13495413
> 
> 赞同：1
> 
> 时间：2012-11-21T14:28:53.583
> 
> 标签：spring, logback

我想**在一分钟过去或超过 1MB 大小后滚动日志**。但是使用下面的配置，只创建第一个日志并考虑大小。让我们说：

myapp.2012-11-21_15-07.log（大小：1026KB - 1MB）
myapp.log（大小：89KB）

假设时间过去了（但我们仍然在那一分钟内）并且日志被填满（超过 1MB），它不会创建另一个文件。仅在超过时间时才创建另一个文件，而不考虑大小。
**这是一个错误还是预期的功能？如何使用 logback 进行配置？我需要自定义实现吗？**

正如我在[当前手册](http://logback.qos.ch/manual/appenders.html)中阅读的那样，当我希望在经过一分钟或超过 1MB 大小后滚动日志时，我将执行以下配置：

```
<configuration>

<appender name="file"
    class="ch.qos.logback.core.rolling.RollingFileAppender">
    <file>${catalina.base}/logs/myapp.log</file>
    <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
        <fileNamePattern>${catalina.base}/logs/myapp.%d{yyyy-MM-dd_HH-mm}.log</fileNamePattern>

        <maxHistory>90</maxHistory>

        <timeBasedFileNamingAndTriggeringPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP">
            <maxFileSize>1MB</maxFileSize>
        </timeBasedFileNamingAndTriggeringPolicy>
    </rollingPolicy>

    <encoder>
        <pattern>%-5level %date{ISO8601} [%thread]: [%class: %method] %message%n</pattern>
    </encoder>
</appender>

<appender name="console" class="ch.qos.logback.core.ConsoleAppender">
    <encoder>
        <pattern>%-5level %date{ISO8601} [%thread]: [%class: %method] %message%n</pattern>
    </encoder>
</appender>
</appender>

<appender name="console" class="ch.qos.logback.core.ConsoleAppender">
    <encoder>
        <pattern>%-5level %date{ISO8601} [%thread]: [%class: %method] %message%n</pattern>
    </encoder>
</appender>

<logger name="org.springframework.core">
    <level value="all"/>
</logger>

<logger name="org.springframework.beans">
    <level value="all"/>
</logger>

<logger name="org.springframework.context">
    <level value="all"/>
</logger>

<logger name="org.springframework.web">
    <level value="all"/>
</logger>
<root level="error,info,debug">
    <appender-ref ref="file"/>
    <!--   <appender-ref ref="console"/>   -->
</root>
</configuration> 
```

依赖项（我不包括使用它来获得 logback 功能的每个依赖项中的 commons-logging - 未在下面显示）：

```
 <!-- LOGGING -->
    <dependency>
        <groupId>ch.qos.logback</groupId>
        <artifactId>logback-core</artifactId>
        <version>1.0.0</version>
    </dependency>
    <dependency>
        <groupId>ch.qos.logback</groupId>
        <artifactId>logback-classic</artifactId>
        <version>1.0.0</version>
    </dependency>
    <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>slf4j-api</artifactId>
        <version>1.6.6</version>
    </dependency>
    <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>jcl-over-slf4j</artifactId>
        <version>1.6.6</version>
    </dependency>
    <!--END LOGGING--> 
```

**一些附加信息：**
我还尝试了 1.0.7 版本（虽然最后一个版本无法通过中央存储库获得 - 必须手动将其包含在本地 maven 存储库中），但同样发生了。
我的项目使用的是 0.9.11 版本的 logback，我无法设置滚动策略，因为我找不到任何有效的文档/手册。也许有人还可以为那些需要处理遗留依赖项的人指出一些旧手册。

亲切的问候，
暴君

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T08:27:19.393

您必须将滚动策略设置为使用 SizeAndTimeBasedFNATP

这是带有示例的文档

[http://logback.qos.ch/manual/appenders.html#SizeAndTimeBasedFNATP](http://logback.qos.ch/manual/appenders.html#SizeAndTimeBasedFNATP)

您缺少 %i:

```
<fileNamePattern>mylog-%d{yyyy-MM-dd}.%i.txt</fileNamePattern> 
```

请注意除“%d”之外的“%i”转换标记。每次当前日志文件在当前时间段结束前达到 maxFileSize 时，都会以递增的索引归档，从 0 开始。

# ajax - 带有自定义验证器和 Omnifaces 的 PrimeFaces 可编辑数据表

> ID：13495417
> 
> 赞同：3
> 
> 时间：2012-11-21T14:29:02.737
> 
> 标签：ajax, jsf, primefaces, myfaces, omnifaces

我最近将 OmniFaces 库引入我的项目以利用其 Ajax 实用程序，但自从这样做后，我的 PrimeFaces 可编辑数据表现在忽略了验证错误。

我目前有带有自定义验证器和过滤器的 ap:datatable，如下所示：

```
<p:dataTable var="ticket" value="#{myBean.tickets}"
    id="ticketTable" widgetVar="ticketTable" editable="true"
    rowKey="#{ticket.idTicket}"
    filteredValue="#{myBean.filteredTickets}"
    paginator="true" rows="20"
    paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
    rowsPerPageTemplate="#{myBean.rowsPerPageTemplate}">

    <p:ajax event="rowEdit" listener="#{myBean.onEdit}"
        />
    <p:ajax event="rowEditCancel"
        listener="#{myBean.onCancel}" />

    <p:column headerText="Title" sortBy="#{ticket.title}"
        filterBy="#{ticket.title}">
        <p:cellEditor>
            <f:facet name="output">
                <h:outputText value="#{ticket.title}" />
            </f:facet>
            <f:facet name="input">
                <p:inputText value="#{ticket.title}" />
            </f:facet>
        </p:cellEditor>
    </p:column>

    <p:column sortBy="#{ticket.start}">
        <f:facet name="header">
            <h:panelGrid columns="1">
                <h:outputText value="Start" />
                <h:panelGrid columns="3">
                    <h:outputLabel value="From:" for="filterTripDateFrom" />
                    <p:calendar id="filterTripDateFrom"
                        value="#{myBean.filterStart}" navigator="true"
                        effect="fadeIn" pattern="MM/dd/yy" size="8">
                        <p:ajax event="dateSelect"
                            listener="#{myBean.filterDates()}"
                            update="ticketTable" />
                    </p:calendar>
                    <p:commandButton value="Clear"
                        action="#{myBean.clearStart()}"
                        update="filterTripDateFrom, ticketTable" />
                </h:panelGrid>
            </h:panelGrid>
        </f:facet>
        <p:cellEditor>
            <f:facet name="output">
                <h:outputText value="#{ticket.start}">
                    <f:convertDateTime pattern="EE, MMM dd, yyyy:  HH:mm z" />
                </h:outputText>
            </f:facet>
            <f:facet name="input">
                <p:calendar value="#{ticket.start}" pattern="MM/dd/yy HH:mm"
                    stepMinute="15">
                    <f:validator validatorId="dateValidator" />
                    <f:attribute name="endDate"
                        value="#{editEndDate}" />
                </p:calendar>
            </f:facet>
        </p:cellEditor>
    </p:column>

    <p:column sortBy="#{ticket.end}">
        <f:facet name="header">
            <h:panelGrid columns="1">
                <h:outputText value="End" />
                <h:panelGrid columns="3">
                    <h:outputLabel value="To:" for="filterTripDateTo" />
                    <p:calendar id="filterTripDateTo"
                        value="#{myBean.filterEnd}" navigator="true"
                        effect="fadeIn" pattern="MM/dd/yyyy" size="8">
                        <p:ajax event="dateSelect"
                            listener="#{myBean.filterDates()}"
                            update="ticketTable" />
                    </p:calendar>
                    <p:commandButton value="Clear"
                        action="#{myBean.clearEnd()}"
                        update="filterTripDateTo, ticketTable" />
                </h:panelGrid>
            </h:panelGrid>
        </f:facet>
        <p:cellEditor>
            <f:facet name="output">
                <h:outputText value="#{ticket.end}">
                    <f:convertDateTime pattern="EE, MMM dd, yyyy:  HH:mm z" />
                </h:outputText>
            </f:facet>
            <f:facet name="input">
                <p:calendar value="#{ticket.end}" pattern="MM/dd/yyyy HH:mm"
                    stepMinute="15" binding="#{editEndDate}" />
            </f:facet>
        </p:cellEditor>
    </p:column>
    <p:column headerText="Options" style="width:50px">
        <p:rowEditor />
    </p:column>

</p:dataTable> 
```

添加 OmniFaces 之前的行为是，如果我的自定义日期验证器（如下提供）抛出`ValidatorException`，则正在编辑的表中的行将保持打开状态，并且页面将显示`FacesMessage`来自异常的。添加 OmniFaces 库后，`FacesMessage`仍然显示，但表中的行关闭，好像没有抛出异常一样。我曾尝试使用 OmniFaces 1.2 和 1.3 SNAPSHOT，两者的行为相同。
无论如何要恢复原始功能，还是我必须从我的项目中删除 OmniFaces？

感谢您的帮助

添加信息：Tomcat 7.0；我的脸 2.1；PrimeFaces 3.4.1；OmniFaces 1.3 快照 20121027

我的自定义日期验证器：

```
public void validate(FacesContext context, UIComponent component,
        Object value) throws ValidatorException
{
    // get the submitted value for the start date
    DateValidator.logger.debug("starting validation");
    Date startDate = (Date) value;

    // get the bound component that contains the end date
    DateValidator.logger.debug("getting UI component");
    UIInput endDateComponent = (UIInput) component.getAttributes().get(
            "endDate");

    // get the value of the bound component
    DateValidator.logger.debug("getting second date");
    String endDateString = (String) endDateComponent.getSubmittedValue();

    // and parse it into a date
    DateValidator.logger.debug("converting date");
    Date endDate = JodaUtils
            .stringToUtil(endDateString, "MM/dd/yyyy HH:mm");

    // if either of the submitted values were empty, let the required tag
    // take care of it
    if (startDate == null || endDate == null)
    {
        DateValidator.logger.debug("a date was null; start: " + startDate
                + "; end: "
                + endDate);
        return;
    }

    // otherwise if the start time is the same as, or before the end time
    else if (startDate.getTime() >= endDate.getTime())
    {
        DateValidator.logger
                .debug("end date was the same as or before start date; start: "
                        + startDate + "; end: " + endDate);

        // set the bound component as invalid
        endDateComponent.setValid(false);

        // update the container containing the components to show that the
        // fields were invalid
        Ajax.update(endDateComponent.getParent().getClientId());

        // and send a notification to the front end
        throw new ValidatorException(new FacesMessage(
                FacesMessage.SEVERITY_ERROR,
                "The end time must be after the start time.",
                "The end time must be after the start time."));
    }
    else
    {
        DateValidator.logger.debug("all clear; start: " + startDate
                + "; end: "
                + endDate);
    }
    Ajax.update(":form:ticketTable");
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T01:06:28.653

我能够重现您的问题。这基本上是由 MyFaces 和`OmniPartialResponseWriter`. MyFaces 的标准[`PartialResponseWriter`](http://docs.oracle.com/javaee/6/api/javax/faces/context/PartialResponseWriter.html)并没有将所有方法委托给`getWrapped()`方法，而是直接委托给局部`wrapped`变量。在 Mojarra 中，所有方法都被委托给`getWrapped()`，因此可以在组件库的特定`PartialResponseWriter`实现中被覆盖。

您的代码在 Mojarra 中运行良好，但在 MyFaces`PartialResponseWriter#getWrapped()`中没有调用该方法（OmniFaces 将返回 PrimeFaces 一个），而是`wrapped`引用了本地实例（如果`OmniPartialResponseWriter`只有 MyFaces 拥有一个而不是 PrimeFaces 一个）这导致`PrimePartialResponseWriter`PrimeFaces 被完全跳过。因此，它无法将以下扩展添加到 XML 响应，其中包含 JSF 验证失败的 PrimeFaces ajax 引擎信息。

```
<extension ln="primefaces" type="args">{"validationFailed":true}</extension> 
```

这是一个相当不幸的问题。此问题已在 OmniFaces 1.3 中修复。解决方案是无论如何都[生成一堆`PartialResponseWriter`委托方法](https://github.com/omnifaces/omnifaces/blob/master/src/org/omnifaces/context/OmniPartialViewContext.java#L372)（这破坏了整个包装器设计模式），即使它们不需要实现。

我不确定我是否必须责怪 MyFaces 没有授权`getWrapped()`。[`PartialResponseWriter`文档](http://docs.oracle.com/javaee/6/api/javax/faces/context/PartialResponseWriter.html)对此不够明确，但对我来说，这种方法在包装器设计模式中很明显是有意义的。它将使您免于在每个实现中编写/生成一堆委托方法。

* * *

**与具体问题无关**，鉴于您已经在使用 OmniFaces，您也​​可以使用它`<o:validateOrder>`来代替自定义验证器。

```
<f:facet name="input">
    <p:calendar id="start" value="#{ticket.start}" pattern="MM/dd/yy HH:mm" stepMinute="15" />
</f:facet>
...
<f:facet name="input">
    <p:calendar id="end" value="#{ticket.end}" pattern="MM/dd/yyyy HH:mm" stepMinute="15" binding="#{editEndDate}" />
    <o:validateOrder components="start end" message="The end time must be after the start time." />
</f:facet> 
```

这基本上就是你所需要的。

至于您`Ajax#update()`在验证失败时的方法，我不确定您为什么需要这样做，PrimeFaces 已经在验证失败的情况下更新了整行。如果验证成功，您可能希望在后面的方法中调用它`#{myBean.onEdit}`。

# javascript - 在消息对话框中输入 [HTML / Javascript]

> ID：13495423
> 
> 赞同：2
> 
> 时间：2012-11-21T14:29:25.650
> 
> 标签：javascript, windows, microsoft-metro

我的问题只是如何在 MessageDialog （文本框 ...）中输入输入。这是一个按钮的代码：

```
var msg = new Windows.UI.Popups.MessageDialog("<div>lol</div>", "Updates available");
enter code here

msg.commands.append(new Windows.UI.Popups.UICommand("Don't install", function (command) {
WinJS.log && WinJS.log("The 'Don't install' command has been selected.", "sample", "status");}));

msg.defaultCommandIndex = 1;
msg.showAsync(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T14:34:46.540

It is not possible, it displays the code in the MessageDialog not the textbox

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T14:33:56.570

您可以更新您的 MessageDialog 以包含这样的文本框吗？

```
 var msg = new Windows.UI.Popups.MessageDialog("<div>lol<br/><input type="text"/></div>", "Updates available"); 
```

# css - 如何在浏览器中模糊图像？

> ID：13495429
> 
> 赞同：0
> 
> 时间：2012-11-21T14:29:56.980
> 
> 标签：css, image, firefox, google-chrome, blur

在 Chrome 中，下面的 CSS 模糊了图像。但是，当我在 Firefox 中查看图像时，图像不再模糊。关于如何让它跨浏览器工作的任何建议？

```
div.wrapper{
    float:left; /* important */
    position:relative; /* important(so we can absolutely position the description div */ 
    padding: 5px;
}

div.imageblur{
    position: relative; 
    top: 0; 
    left: 0; 
    width: 320px; 
    filter: blur(5px);
       -webkit-filter: blur(5px);
       -moz-filter: blur(5px);
       -o-filter: blur(5px);
       -ms-filter: blur(5px);

   margin:-1px;
   padding:1px;
}

div.image_container{
   width:318px;
   overflow:hidden;
} 
```

# html

```
<div class="wrapper">

            <!-- image -->
            <div style="position: relative; left: 0; top: 0;">

                <div class="image_container">
                    <div class="imageblur">     
                        <a href="youtube/IiGW9JA_aPg"> <img src="http://i2.ytimg.com/vi/IiGW9JA_aPg/hqdefault.jpg"></a>
                    </div>
                </div>                  
            </div>
            <!-- end image div -->

</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T14:34:04.367

那是因为 webkit 是唯一支持`filter`. [http://caniuse.com/#feat=css-filters](http://caniuse.com/#feat=css-filters)

另见：[http ://www.html5rocks.com/en/tutorials/filters/understanding-css/](http://www.html5rocks.com/en/tutorials/filters/understanding-css/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T14:37:21.483

Firefox 也支持过滤器，但语法稍微复杂：这是我在小提琴上的一个示例：

```
img{
    filter: url("data:image/svg+xml;utf8,<svg xmlns=\'http://www.w3.org/2000/svg\'><filter id=\'grayscale\'><feColorMatrix type=\'matrix\' values=\'0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0.3333 0.3333 0.3333 0 0 0 0 0 1 0\'/></filter></svg>#grayscale"); /* Firefox 3.5+ */
    filter: grayscale(100%);
} 
```

[**过滤器示例**](http://jsfiddle.net/xDJzU/7/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T16:10:51.690

CSS 过滤器是非常新的，因此几乎没有支持。由于 webkit，Safari（夜间）和 Chrome 目前仅支持它。

# php - PHP未定义索引：上线

> ID：13495430
> 
> 赞同：-3
> 
> 时间：2012-11-21T14:30:01.133
> 
> 标签：php, apache, wamp

我将参数传递给这样的 PHP Web 服务：

```
localhost/webservice1.php?method=browse&reg=001&name=john 
```

但它给出了`Notice Undefined Index: method`

我的 PHP 代码是这样的：

```
$methd = $_POST['method'];

if($methd=="save")
    save();

if($methd=="signup")
    signup();

if($methd=="browse")
    browse(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T14:31:55.167

使用 $_GET 数组访问查询字符串中的参数，因此使用

```
$method = $_GET['method']; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T14:32:11.213

您应该使用 $_GET[] 超全局而不是 $_POST，因为您在 URL 中传递参数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T14:32:28.647

我认为您想使用 $_GET 方法而不是 $_POST

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T14:33:06.990

url参数通过$_GET传递

# c# - 使用 C# .Net 错误 5.7.1 发送电子邮件

> ID：13495444
> 
> 赞同：1
> 
> 时间：2012-11-21T14:30:40.910
> 
> 标签：c#, sendmail, smtpclient, asp.net-mail

我试图创建一个在使用时通过电子邮件发送到目标地址的功能。

我的电子邮件模型：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Net;
using System.Net.Mail;
using System.Security;

namespace myspecial.net.Models
{
    public class EmailModel
    {
        // Sender email and recipient email
        public MailAddress Sender { get; set; }
        public IEnumerable<MailAddress> Recipient { get; set; }
        // Subject and message
        public String Subject { get; set; }
        public String Body { get; set; }
        // Attachment Files
        public String AttachmentPath { get; set; }
        // Login Information
        public String UserName { get; set; }
        public String Password { get; set; }
        // Simple Mail Transfer Protocol (SMTP) provider and port
        public String SmtpServer { get; set; }
        public Int32 SMTPport { get; set; }
        // Post Office Protocol (POP) version 3 provider and port
        public String POP3Server { get; set; }
        public Int32 POP3port { get; set; }
        // Secure Sockets Layer
        public Boolean SSL { get; set; }
    }
} 
```

我的控制器：

```
/// <summary>
/// E-Mail's to the address. Before using this function fill the email model.
/// </summary>
public void Email(EmailModel mailer)
{
    MailMessage mail = new MailMessage();
    // Standart required mail information
    mail.From = mailer.Sender;
    mail.Sender = mailer.Sender;
    // Recipients
    foreach (MailAddress rcpnt in mailer.Recipient.ToList())
    { mail.To.Add(rcpnt); }
    // Subject
    mail.Subject = mailer.Subject;
    // Body
    mail.Body = mailer.Body;
    // Optional Attachment
    if (mailer.AttachmentPath != null || mailer.AttachmentPath.Trim() != "")
    {
        System.Net.Mail.Attachment attachment;
        attachment = new System.Net.Mail.Attachment(mailer.AttachmentPath.Trim());
        mail.Attachments.Add(attachment);
    }
    // Important (Simple Mail Transfer Protocol)
    SmtpClient SmtpServer = new SmtpClient(mailer.SmtpServer,mailer.SMTPport);
    SmtpServer.DeliveryMethod = System.Net.Mail.SmtpDeliveryMethod.Network; 
    SmtpServer.Credentials = new System.Net.NetworkCredential(mailer.UserName, mailer.Password, mailer.SmtpServer);
    SmtpServer.Port = mailer.SMTPport;
    SmtpServer.EnableSsl = mailer.SSL;
    ServicePointManager.ServerCertificateValidationCallback = delegate(object s, X509Certificate certificate, X509Chain chain, SslPolicyErrors sslPolicyErrors) { return true; };
    // Send Mail
    SmtpServer.Send(mail);
} 
```

我如何使用它：

```
 // Send as mail
        EmailModel mail = new EmailModel();
        // Mail addresses to send
        MailAddress[] addressler = new MailAddress[] { new MailAddress("berkeryuceer@yahoo.com") };
        // Options here
        mail.SMTPport = 465; // Port // 465 // 26 // 25 // 366 // 587
        mail.SmtpServer = "smtp.gmail.com"; // Server
        mail.UserName = "MyGmailAddress@gmail.com"; // UserName
        mail.Password = "**********"; // Password 
        mail.SSL = true; // Secure Sockets Layer
        // Mail
        mail.Sender = new MailAddress("MyGmailAddress@gmail.com"); // Sender (From)
        mail.Recipient = addressler; // Recipient (To)
        mail.Subject = "Some subject here..";
        mail.Body = "Some blabla bla blablabla blabla here...";
        // Optional Attachment // Attach excel file. 
        mail.AttachmentPath = ExportToExcelForMail(id).ToString(); 
        Email(mail); 
```

在我的网络项目中，创建一个作为 excel 文件的报告，并希望将其发送给我自己附加到电子邮件中。我不确定有什么问题或我在这里遗漏了什么.. 一切对我来说似乎都是有效的，但我仍然收到这个错误：

![我的错误图片](../Images/9347653ce7f424362d8a6aefe294d1f5.png)

堆栈跟踪：

```
System.Net.Mail.SmtpFailedRecipientException was unhandled by user code
  Message=Posta kutusu kullanılamıyor. Sunucu yanıtı şöyleydi: 5.7.1 <MyGmailAddress@gmail.com> Access to <berkeryuceer@yahoo.com> not allowed
  Source=System
  FailedRecipient=<berkeryuceer@yahoo.com>
  StackTrace:
       konum: System.Net.Mail.SmtpTransport.SendMail(MailAddress sender, MailAddressCollection recipients, String deliveryNotify, SmtpFailedRecipientException& exception)
       konum: System.Net.Mail.SmtpClient.Send(MailMessage message)
       konum: blabla.net.Controllers.OtelFormsController.Email(EmailModel mailer) D:\bla\bla\blabla.net\blabla.net\Controllers\OtelFormsController.cs içinde: satır 753
       konum: blabla.net.Controllers.OtelFormsController.Close(Int32 id) D:\bla\bla\blabla.net\blabla.net\Controllers\OtelFormsController.cs içinde: satır 691
       konum: lambda_method(Closure , ControllerBase , Object[] )
       konum: System.Web.Mvc.ActionMethodDispatcher.Execute(ControllerBase controller, Object[] parameters)
       konum: System.Web.Mvc.ReflectedActionDescriptor.Execute(ControllerContext controllerContext, IDictionary`2 parameters)
       konum: System.Web.Mvc.ControllerActionInvoker.InvokeActionMethod(ControllerContext controllerContext, ActionDescriptor actionDescriptor, IDictionary`2 parameters)
       konum: System.Web.Mvc.ControllerActionInvoker.<>c__DisplayClass15.<InvokeActionMethodWithFilters>b__12()
       konum: System.Web.Mvc.ControllerActionInvoker.InvokeActionMethodFilter(IActionFilter filter, ActionExecutingContext preContext, Func`1 continuation)
  InnerException: 
```

所以我在这里想念什么？怎么了？我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T14:41:39.647

您可以使用以下代码：

```
 /// <summary>
    /// Sends mail with authentification
    /// </summary>
    /// <param name="recipients"></param>
    /// <param name="from"></param>
    /// <param name="subject"></param>
    /// <param name="body"></param>
    /// <param name="isHTMLbody"></param>
    /// <param name="SMTPhost"></param>
    /// <param name="priority"></param>
    /// <param name="credentials"></param>
    /// <param name="port"></param>
    /// <param name="enableSsl"></param>
    static void SendMailWithAuthentication(List<string> recipients, string from, string subject, string body, bool isHTMLbody,
        string SMTPhost, System.Net.Mail.MailPriority priority, System.Net.NetworkCredential credentials, int? port, bool enableSsl)
    {
        System.Net.Mail.MailMessage message = new System.Net.Mail.MailMessage();
        foreach (string recipient in recipients)
        {
            message.To.Add(recipient);
        }
        message.SubjectEncoding = Encoding.UTF8;
        message.BodyEncoding = Encoding.UTF8;
        message.Subject = subject;
        message.From = new System.Net.Mail.MailAddress(from);
        message.IsBodyHtml = isHTMLbody;
        message.Body = body;
        message.Priority = priority;
        System.Net.Mail.SmtpClient client = new System.Net.Mail.SmtpClient();
        client.Credentials = credentials;
        client.Host = SMTPhost;
        if (port != null)
        {
            client.Port = (int)port;
        }
        client.EnableSsl = enableSsl;
        client.Send(message);
        message.Dispose();
    } 
```

这就是你应该如何将它用于 gmail：

```
 string subject = "my subject";
        string body = "my html body";
        int port = 587;
        string SMTPhost = "smtp.gmail.com";
        string sender = "my@email.com";
        System.Net.Mail.MailPriority mPriority = System.Net.Mail.MailPriority.Low;        
        List<string> recipients = new List<string>(){"some@reciever.com"};
        bool enableSSL = true;
        System.Net.NetworkCredential credentials = new System.Net.NetworkCredential("UserName","Password");
        SendMailWithAuthentication(recipients, sender, subject, body, true,
            SMTPhost,
            mPriority, credentials,
            enableSSL); 
```

# java - 如何拆分像字符串这样的命令行？

> ID：13495449
> 
> 赞同：3
> 
> 时间：2012-11-21T14:30:50.533
> 
> 标签：java, regex

基本上，我需要像这样拆分字符串

```
"one quoted argument" those are separate arguments "but not \"this one\"" 
```

得到参数列表

*   “一个引用的论点”
*   那些
*   是
*   分离
*   "但不是\"这个\""

这个正则表达式`"(\"|[^"])*"|[^ ]+`几乎可以完成这项工作，但问题是正则表达式总是（至少在 java 中）试图匹配可能的**最长**字符串。

因此，当我将正则表达式应用于以带引号的参数开头和结尾的字符串时，它会匹配整个字符串并且不会为每个参数创建一个组。

有没有办法调整这个正则表达式或[匹配器](http://docs.oracle.com/javase/7/docs/api/java/util/regex/Matcher.html)或[模式](http://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html)或任何处理它的方法？

注意：不要告诉我我可以使用`GetOpt`或`CommandLine.parse`其他类似的东西。
**我担心的是纯 Java 正则表达式（如果可能，但我对此表示怀疑......）。**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T14:37:28.330

> 正则表达式总是（至少在 java 中）尝试匹配可能的最长字符串。

不。

如果您使用贪婪或非贪婪表达式，则可以控制它。看[一些例子](http://www.roseindia.net/java/example/java/util/GreedyAndNonGreedyMatching.shtml)。使用非贪婪的（通过添加问号）应该做到这一点。这称为[惰性量化](http://en.wikipedia.org/wiki/Regular_expression#Lazy_quantification)。

默认值是贪婪的，但这当然并不意味着它总是这样。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-21T14:40:29.947

您可以使用非贪婪限定符`*?`使其工作：

```
"(\\"|[^"])*?"|[^ ]+ 
```

请参阅此链接以获取实际示例： http://gskinner.com/RegExr/? [32srs](http://gskinner.com/RegExr/?32srs)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-08-29T07:23:45.807

```
public static String[] parseCommand( String cmd )
{
    if( cmd == null || cmd.length() == 0 )
    {
        return new String[]
        {};
    }

    cmd = cmd.trim();
    String regExp = "\"(\\\"|[^\"])*?\"|[^ ]+";
    Pattern pattern = Pattern.compile( regExp, Pattern.MULTILINE | Pattern.CASE_INSENSITIVE );
    Matcher matcher = pattern.matcher( cmd );
    List< String > matches = new ArrayList< String >();
    while( matcher.find() ) {
        matches.add( matcher.group() );
    }
    String[] parsedCommand = matches.toArray(new String[] {});
    return parsedCommand;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-03-18T07:12:57.670

我想出了这个（感谢亚历克斯给了我一个好的起点:)）

```
/**
 * Pattern that is capable of dealing with complex command line quoting and
 * escaping. This can recognize correctly:
 * <ul>
 * <li>"double quoted strings"
 * <li>'single quoted strings'
 * <li>"escaped \"quotes within\" quoted string"
 * <li>C:\paths\like\this or "C:\path like\this"
 * <li>--arguments=like_this or "--args=like this" or '--args=like this' or
 * --args="like this" or --args='like this'
 * <li>quoted\ whitespaces\\t (spaces & tabs)
 * <li>and probably more :)
 * </ul>
 */
private static final Pattern cliCracker = Pattern
    .compile(
       "[^\\s]*\"(\\\\+\"|[^\"])*?\"|[^\\s]*'(\\\\+'|[^'])*?'|(\\\\\\s|[^\\s])+",
       Pattern.MULTILINE); 
```

# java - 在 web-app 目录中创建嵌入式 hsqldb

> ID：13495452
> 
> 赞同：3
> 
> 时间：2012-11-21T14:30:58.313
> 
> 标签：java, tomcat, web-applications, war, hsqldb

有没有办法在我的 web-app 目录中创建嵌入式 HSQLDB（我希望我的数据路径是这样的：“Tomcat/webapps/ROOT/db”，但我不想指定绝对路径）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T14:35:11.850

我不会那样做，因为如果你重新部署你的 web 应用程序，你会炸毁数据库或者可能会发生其他一些奇怪的行为。

您可以做的是使用系统属性`${catalina.base}`并将其放在您的 Tomcat 目录中的某个位置（或者甚至在您想要的 webapps 目录中）。

您如何访问系统属性并应用到 HSQLDB 取决于您如何启动它。如果您使用 Spring，您可以使用 PropertyPlaceholder 来配置 HSQLDB 的位置。

# sql - 使用 Visual Studio 的新手，如何将表添加到数据库？

> ID：13495454
> 
> 赞同：0
> 
> 时间：2012-11-21T14:31:03.780
> 
> 标签：sql, vb.net, visual-studio-2010, database-design

我有一个学校作业，我们要在我们从老师那里得到的代码中填写一些 SQL 语句。我们还将树不同的表变成一个已经存在的数据库。当我尝试创建一个新类来添加这些表时，我认为我做错了什么。这些表从未创建过。为什么？！

数据库连接：

```
Public Class ClassConnection
'Mot citrix
Dim Koppling As New System.Data.SqlClient.SqlConnection("Initial Catalog=EmbeddedVB; Data Source=LUiis02; Integrated Security=true")
'Mot access
'Dim Koppling As New System.Data.OleDb.OleDbConnection("Provider=Microsoft.jet.OLEDB.4.0;Data source=Poster.mdb")
'lokalt mot SQL-server
'Dim Koppling As New System.Data.SqlClient.SqlConnection("Initial Catalog=Testar;Data Source=(local); Integrated Security=true;")

Public ReadOnly Property ReturneraKoppling() As SqlClient.SqlConnection
    Get
        Return Koppling
    End Get
End Property

Sub open()
    Koppling.Open()
End Sub

Sub close()
    Koppling.Close()
End Sub
End Class 
```

表（用于创建）

```
Public Class Tables
Private mySqlConnection As New ClassConnection
Private myAdapter As SqlDataAdapter
Private mySqlCommand As New SqlCommand
Private ds As DataSet
Private gammaltPnr As String

Public Sub fyllDB()
    mySqlCommand.Connection = mySqlConnection.ReturneraKoppling()
    mySqlCommand.CommandType = CommandType.Text

    mySqlConnection.open()
    mySqlCommand.CommandText = "CREATE TABLE IF NOT EXIST Kurs4918(" &
        "kursnamn char(30) NOT NULL PRIMARY KEY " &
        ")"
    myAdapter = New SqlDataAdapter(mySqlCommand)
    mySqlCommand.ExecuteNonQuery()
    mySqlConnection.close()

    mySqlConnection.open()
    mySqlCommand.CommandText = "CREATE TABLE IF NOT EXIST Elev4918 (" &
        "pnr char(11) NOT NULL PRIMARY KEY, " &
        "fornamn char(20), " &
        "efternamn char(20), " &
        "ort char(15) " &
        ") "
    myAdapter = New SqlDataAdapter(mySqlCommand)
    mySqlCommand.ExecuteNonQuery()
    mySqlConnection.close()

    mySqlConnection.open()
    mySqlCommand.CommandText = "CREATE TABLE IF NOT EXIST KursElev4918(" &
        "pnr char(11) NOT NULL PRIMARY KEY, " &
        "kursnamn char(30) " &
        ") "
    myAdapter = New SqlDataAdapter(mySqlCommand)
    mySqlCommand.ExecuteNonQuery()
    mySqlConnection.close()

End Sub 
```

启动 Form1.vb （这应该从表中运行 fyllDB() 对吗？....

```
Public Class frmMain
Inherits System.Windows.Forms.Form
Private db As New Tables

Private Sub fill()
    db.fyllDB()
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T20:45:28.620

您的 CREATE TABLE 和 DROP TABLE 语句不太正确。如果您有 SQL Server Management Studio，则可以使用它来查看如何创建这些语句：右键单击“对象资源管理器”窗格中的现有表并选择“将表编写为...”->“DROP 和 CREATE to”- >“新查询编辑器窗口”。你会得到类似的东西

```
USE [testing]
GO

/****** Object:  Table [dbo].[testTable]    Script Date: 11/21/2012 20:35:02 ******/
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[testTable]') AND type in (N'U'))
DROP TABLE [dbo].[testTable]
GO

USE [testing]
GO

/****** Object:  Table [dbo].[testTable]    Script Date: 11/21/2012 20:35:02 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[testTable](
    [number] [int] NULL,
    [str] [nchar](10) NULL,
    [tim] [time](7) NULL
) ON [PRIMARY]

GO 
```

您应该能够从中挑选出您需要的零件。

要执行 DROP/CREATE 语句，请使用[SqlCommand.ExecuteNonQuery 方法](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.executenonquery.aspx)。

编辑：

因此，您的 FyllDb 方法将更像这样：

```
Public Sub FyllDb()
    Dim sqlCmd As New SqlCommand
    Dim sqlConn = New SqlConnection("Server=.\SQLEXPRESS;Database=testing;Trusted_Connection=True;")
    sqlCmd.Connection = sqlConn

    sqlCmd.CommandText = "IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[testTable2]') AND type in (N'U')) DROP TABLE [dbo].[testTable2]"

    Try
        sqlConn.Open()
        sqlCmd.ExecuteNonQuery()
    Catch ex As Exception
        MsgBox("Error deleting table: " & ex.Message)
    Finally
        sqlConn.Close()
    End Try

    sqlCmd.CommandText = "CREATE TABLE [dbo].[testTable2]( [number] [int] NULL, [str] [nchar](10) NULL, [tim] [time](7) NULL) ON [PRIMARY]"

    Try
        sqlConn.Open()
        sqlCmd.ExecuteNonQuery()
    Catch ex As ArgumentException
        MsgBox("Error creating table: " & ex.Message)
    Finally
        sqlConn.Close()
    End Try

End Sub 
```

-- 经测试可与 VS2012/SQL Server 2008 R2 Express/Windows 7 x64 一起使用。

请根据您的表格定义进行调整。

# algorithm - 逆向工程校验位算法

> ID：13495456
> 
> 赞同：16
> 
> 时间：2012-11-21T14:31:15.683
> 
> 标签：algorithm, reverse-engineering, check-digit

我正在尝试对用于生成校验位的算法进行逆向工程。

数字长 8 位，最后一位是校验位。我有数千个有效数字来测试它。

我尝试了标准的 Luhn、Verhoeff 和 modulo-10 算法（对所有可能的权重进行强力检查），但找不到答案！

可以计算这个吗？有任何想法吗？

以下是一些有效数字的示例：

```
1002784-5
1000514-7
1001602-8
1001255-2
1001707-1
1003355-5
1005579-1
1004535-0
1004273-1
1001695-9
1004565-9
1000541-9
1001291-1
1005866-1
1004352-7 
```

编辑：谢谢大家 - 不幸的是，我无法访问代码。该号码是税号，我需要能够验证该号码是否输入正确。根据我的研究，大多数国家/地区似乎都使用非常标准的模 10 类型系统。我可以访问大约 60 000 个号码。

我知道这个问题可能无法解决，更多的是学术问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T07:57:16.530

首先检查您的上下文：

如果上下文是信用卡、驾照、政府许可号码（不是 SSN），请考虑 Luhn 或 Mod 10。如果是其他行业，该行业是否有事实上的标准？如果不是，那么使用这些数字的系统的开发者是否也是拥有事实上的标准的行业的参与者？

如果没有必要，没有人愿意重新发明轮子。

如果这没有帮助，请记住：

不要假设您正在测试的密钥中的所有数字都用于到达校验位。可能只有 4 位或 8 位数字用于计算校验位（或任何其他组合）。也可能有一些外部前缀号码与其他数字一起使用以到达校验位。所以...用相同的校验位排列你所有的号码，看看有什么相似之处。您可以向它们添加一个数字，然后始终达到校验位吗？你能只测试前几位数字吗？最后几位数？每隔一个数字？

祝你好运。

# algorithm - 如何在weka中预处理数据以进行分类

> ID：13495459
> 
> 赞同：0
> 
> 时间：2012-11-21T14:31:25.683
> 
> 标签：algorithm, classification, weka

我开始使用 WEKA，我想在[这个](http://archive.ics.uci.edu/ml/datasets/Parkinsons)数据集上使用 k-NN 分类器，我可以将数据集导入 weka。但是当我想启动分类器时，它没有向我显示任何关于正确分类的实例和不正确分类的实例的任何信息。我想根据状态栏进行分类。我想我必须在这里进行某种预处理，因为状态属性被解释为数值。？！谁能解释我必须为这种数据集做什么样的预处理？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T16:15:07.583

最简单的做法可能是将状态列中的数值替换为字符串，以便 Weka 识别它们是分类值。

# php - 如何在 jquery 代码中传递数组值？

> ID：13495461
> 
> 赞同：1
> 
> 时间：2012-11-21T14:31:35.357
> 
> 标签：php, javascript, jquery

```
 Array
    (
        [0] => Array
            (
                [price_id] => 1
                [website_id] => 0
                [all_groups] => 1
                [cust_group] => 32000
                [price_qty] => 2
                [price] => 90.0000

            )

        [1] => Array
            (
                [price_id] => 2
                [website_id] => 0
                [all_groups] => 1
                [cust_group] => 32000
                [price_qty] => 5
                [price] => 80.0000

            )
.......
) 
```

如果我想将 [price_qty] 和 [price] 值传递给 jquery 代码，则数组元素可能是一个或两个或更多。我应该怎么做？有人可以给我举个例子吗？谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T14:33:50.187

您应该考虑使用 JSON 字符串以便在 JavaScript 中使用基于键的数组。

[http://php.net/json](http://php.net/json)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T14:42:13.513

好吧，当您要求从 [php]array 移动到 [javascript]array 时，这就是方法。您应该使用 json_encode 上一个答案的说法，但是在您的 javascript 中，您可以使用以下代码将 json 转换为数组：

```
function json2Array = function(json){   
    var a = [];
    for(var o in json){
      a.push(json[o]);
    }   
    return a;
}

var myArray = json2Array(youPhpJsonEncode); 
```

你将在javascript中拥有你的数组

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T14:35:46.277

[`json_encode`](http://php.net/manual/en/function.json-encode.php)你的 php 数组到 json

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T14:36:12.100

使用[json_encode](http://php.net/manual/en/function.json-encode.php)将您的 php 数组转换为 json :)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-21T14:38:39.537

一种可能的解决方案是在将数据传递给客户端之前将 php 数组结构转换为 JSON。

看看[php json](http://php.net/manual/en/book.json.php)。也看看[这个帖子](https://stackoverflow.com/questions/2122233/convert-php-result-array-to-json)。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-21T14:40:46.850

尝试使用 Json：

```
json_encode($array); 
```

这会将数组编码为一个对 javascript（和 Jquery）友好的 json 对象。

如果您通过 ajax 请求传递它，只需在 php 中回显它并将其作为响应返回。

如果它在同一个脚本中，你可以这样做：

```
$object = json_encode($array);
echo "var myObject = $object;"; 
```

要访问 javascript/jquery 中的信息，您可以：

```
alert(myObject[0].price_id); 
```

您可以使用 myObject[0] 访问 php 数组中的位置，并使用 myObject[0] **.name**访问数组中的关联数组键。

有关更多信息，请访问[json 文档页面](http://json.org/)

# php - 限制点击链接的次数

> ID：13495462
> 
> 赞同：0
> 
> 时间：2012-11-21T14:31:38.787
> 
> 标签：php, wordpress

我需要限制人们下载 pdf 的次数（不超过 500 次）。理想情况下，它会将点击计数为 500，然后删除链接。我刚刚想到，我还需要阻止每个人多次点击。基本上我被要求允许前 500 人下载一个文件然后结束它。首选 PHP 或 javascript（在 wordpress 网站上）

问候

富有的

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T14:33:18.797

您不想限制可以单击链接的次数，您想限制特定链接返回 PDF 文件的次数。

换句话说，您的链接不应直接指向所请求的资源（PDF），而应指向一个 PHP 文件，该文件可以断言该文件的下载次数不超过 500 次。

这是[一个](https://stackoverflow.com/a/10834249/1329111)如何将 www 目录之外的文件输出到浏览器的示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T14:36:35.857

链接到将控制访问并在允许的情况下提供 PDF 的 PHP 脚本（例如，[`readfile()`](http://php.net/manual/en/function.readfile.php)使用 .`$_SESSION`来管理单个用户下载的次数 - 下载后更新值。

使用数据库表或其他数据源计算总下载量，当下载量达到 500 次时，您可以拒绝对 PDF 的所有访问。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T14:40:59.430

要扩展 Sherlock 的解决方案，您希望将 PDF 隐藏在 PHP 文件后面。当我说隐藏时，我的意思是把它放在一个不能直接访问的地方：考虑将它移出你的“www root”或使用 .htaccess 来防止直接访问文件。如果文档是可猜测且可公开获得的，大多数高级用户将弄清楚如何访问您的 PDF。

您的 PHP 应该简单地执行以下操作：

*   检查文档的下载次数是否少于 500 次，或者用户的 IP 对文档具有“解锁访问权限”（您可能希望允许一个“窗口”，在此期间用户可以再次下载文档 - 有些人会`open`在他们实际上想要`save`它，并且不知道如何从他们的阅读器保存到磁盘） - 否则显示错误
*   存储此文档的用户 IP 地址
*   发送文件类型的适当标题：`header('Content-type: application/pdf');`
*   发送文件名：`header('Content-Disposition: attachment; filename="the document.pdf"');`
*   发送文件内容：`readfile($pathToPDF);`

# objective-c - 在启用 ARC 的项目中使用 alloc、init

> ID：13495464
> 
> 赞同：7
> 
> 时间：2012-11-21T14:31:47.180
> 
> 标签：objective-c, ios, automatic-ref-counting, init, alloc

实际上我正在开发一个`ARC`启用的项目。我知道使用`alloc`并`init`正在使用`ownership`该对象。我知道，如果我创建这样的字符串

```
NSString *myString = [[NSString alloc]initWithFormat:@"Something"]; 
```

然后我需要`release`对`myString`自己。**如果我使用启用 ARC 怎么办？我无法释放自己。那么它会造成泄漏吗？还是我不应该创建这样的对象？**

我也可以像下面的代码一样创建一个字符串。

```
NSString *myString = [NSString stringWithFormat:@"Something"]; 
```

**但是对于启用 ARC 的项目，我需要使用哪种类型？如果我使用第一种类型会发生什么？**

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-21T14:35:19.527

如果您使用 ARC，`release`编译时会为您添加所有必要的调用。它不会泄漏。

和...之间的不同

```
NSString *myString = [[NSString alloc]initWithFormat:@"Something"]; 
```

和

```
NSString *myString = [NSString stringWithFormat:@"Something"]; 
```

是第一个将`myString`在该块中最后一次引用后自动释放，而第二个是自动释放实例，只会在运行循环结束时释放。差别不大，但如果您使用大量对象，请尽量避免使用自动释放的对象以保持较低的内存使用率。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T14:34:50.090

`release`ARC 负责内存管理，因此您不必担心调用`myString`变量，ARC 会为您完成。另外作为一个建议，我建议使用方便的方法来创建您的对象，例如

`[NSString stringWithFormat:@"Something"];`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T15:09:13.083

将字符串指针设置为 nil 即可释放它。
你也可以做没有 ARC 也能做的事情，但是如果你没有明确地做任何事情，ARC 会（几乎）为你管理一切。

所以要释放它，你将它设置为 nil，让我们看看你还能做什么：

```
 NSString* str= [[NSString alloc]initWithUTF8String: "Hello"];
    // here the retain count of str is 1
    __unsafe_unretained NSString* string= str;
    // again 1 because string is __unsafe_unretained
    void* data= (__bridge_retained void*) string;
    // data retains the string, so the retain count is to 2
    // This is useful in the case that you have to pass an objective-c object
    // through a void pointer.You could also say NSString* data= string;
    str=nil;
    // Here the retain count of str is 1
    NSLog(@"%@",(__bridge NSString*)data); 
```

**更新**

这就是为什么有时你没有注意到一个对象被释放的原因：

```
 NSString* str= [[NSString alloc]initWithString: @"hey"];
    __unsafe_unretained NSString* str2=str;
    str=nil;
    NSLog(@"%@",str2); 
```

在这种情况下str=[[NSString alloc]initWithString:@"hey"]等于str=@"hey"，区别在于str是自动释放而不是释放。但是编译器优化了str=@"hello中的代码"，所以如果你在一个自动释放块内，你不会有任何问题，str2 将被正确打印。
这就是我使用 initWithUTF8String 来避免编译器优化的原因。

# daemon - 使用 Monit 监控自定义守护进程

> ID：13495468
> 
> 赞同：0
> 
> 时间：2012-11-21T14:31:59.457
> 
> 标签：daemon, monit

我使用 System_Daemon pear 包创建了一个守护进程。守护进程失败时如何使用 Monit 重新启动它。

我有以下代码将放置在 monit config gile 中：

```
check process merge with pidfile /var/www/merge/merge.pid
group 1000
start program = "/etc/init.d/merge start"
stop program = "/etc/init.d/merge stop"
if failed host IPADDRESS port 80
then restart
if 5 restarts within 5 cycles then timeout 
```

这是监视自定义守护程序的正确方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T09:31:45.733

我会说它看起来很正确。

如果您问，我想这是因为您面临问题。你能详细说明吗？

# ios - 临时分发失败

> ID：13495469
> 
> 赞同：3
> 
> 时间：2012-11-21T14:32:04.493
> 
> 标签：ios, ad-hoc-distribution, ota

我在一家大公司工作，我正在为 iOS 5+ 开发一个 iOS 应用程序。分发应用程序的唯一方式是通过临时部署。

我拥有自己的服务器已经有一段时间了，由 o2switch（法国主机商）托管。在我开始开发时，我们使用它来部署应用程序以进行 beta 测试。它工作得很好。

随着应用程序进入最后阶段，该公司在 o2switch 购买了相同的（事实上，他们只有一个）计划（因为它在我的服务器上运行良好）。“新”服务器工作正常，我们有 iOS 应用程序所需的文件，我们可以正确访问它们。

我的问题是，当我部署到公司的服务器时，安装不断崩溃！应用程序图标下方的栏是空的，几乎已满（很快），我收到一条错误消息，提示无法安装该应用程序。（经典的）

我有众所周知的崩溃日志：

```
unknown itunesstored[1657] <Notice>: MS:Notice: Installing: com.apple.itunesstored [itunesstored] (690.10)
unknown wifid[23] <Error>: WiFi:[375199765.346102]: Client itunesstored is background application
unknown securityd[1659] <Notice>: MS:Notice: Installing: (null) [securityd] (690.10)

unknown SpringBoard[62] <Warning>: could not save thumbnail for downloading icon: image=(null) path='/var/mobile/Library/SpringBoard/DownloadingIconImageCache/***********'
unknown sandboxd[1661] <Notice>: MS:Notice: Installing: (null) [sandboxd] (690.10)
unknown installd[1663] <Notice>: MS:Notice: Installing: (null) [installd] (690.10)
unknown SpringBoard[62] <Warning>: could not save thumbnail for downloading icon: image=(null) path='/var/mobile/Library/SpringBoard/DownloadingIconImageCache/***********'

unknown keybagd[1665] <Notice>: MS:Notice: Installing: (null) [keybagd] (690.10)

unknown securityd[1667] <Notice>: MS:Notice: Installing: (null) [securityd] (690.10)

unknown SpringBoard[62] <Warning>: Killing *********** for app installation
unknown installd[1663] <Error>: 2ffc1000 extract_package: Could not extract archive
unknown installd[1663] <Error>: 2ffc1000 stage_package: Could not extract /var/tmp/install_staging.I0rwBH/foo.zip to /var/tmp/install_staging.I0rwBH/foo_extracted
unknown com.apple.itunesstored[1657] <Notice>: MobileInstallationInstall: failed with -1
unknown installd[1663] <Error>: 2ffc1000 MobileInstallationInstall: Could not stage the package
unknown installd[1663] <Error>: 2ffc1000 handle_install: API failed
unknown installd[1663] <Error>: 2ffc1000 send_message: failed to send mach message of 71 bytes: 10000003
unknown installd[1663] <Error>: 2ffc1000 send_error: Could not send error response to client 
```

我已经尝试了很多来摆脱这个错误，但似乎没有任何效果。我已经阅读了关于这个问题的每一个答案，并尽我所能。我重新下载了配置文件，更新了内部版本号，检查了 ipa 的 url，还有很多其他的东西.. 没有任何效果。

我必须快速交付应用程序，所以我尝试了最后一件事：把它放在我的服务器上。它工作得很好。第一次尝试，没有问题（也许有一次，栏没有逐步加载而是保持灰色然后很快填充为蓝色，但这不是问题，我知道它下载了在线版本）。然后我重新尝试上传到新服务器，同样的问题。

顺便说一句，我测试过：iPhone4/iOS5、iPhone4S/iOS6、iPhone5/iOS6、iPad3/iOS6 和其他一些设备，超过 3G（3 个不同的提供商）和 Wifi，**每次都出现**同样的问题。

所以，我的问题如下：

**服务器是否/如何影响临时部署？**

如果需要，我可以提供有关服务器配置的信息。请告诉我您需要什么信息。

O2switch 正在调查，但他们对 iOS ad-hoc 部署知之甚少，所以他们真的不知道去哪里寻找、安装调用什么服务等。

所以我（再次）转向你，SO 的社区！有任何想法吗 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T13:17:33.467

Did you edit the `App.plist` file before you moved it to the new server?

The assets url must be absolute, like this: `<string>http://someurl.com/App-1.0.0.ipa</string>`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-01T14:06:59.543

如果您绝对确定服务器返回正确的 mime 类型，请通过以下方式检查：

```
lynx -mime_header http://www.serveraddress/App.plist | head -10 
```

如果您确定 html 文件中的 .plist 文件的链接中没有空格或换行符。
如果您确定已将设备添加到配置文件
并且如果您已阅读：[http](http://www.informit.com/articles/article.aspx?p=1829415&seqNum=16)
://www.informit.com/articles/article.aspx?p=1829415&seqNum= 16 我有所有文件：.plist、.html、 .ipa 在同一文件夹中

然后我不知道是什么问题，建议您从您的工作服务器分发它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-26T10:22:46.697

检查 web-server 中的 mime-type 配置。你需要：

`application/xml`对于`.plist`文件，和

`application/octet-stream`为`.ipa`文件。

# css - CSS：将边距设置为窗口高度的 10%

> ID：13495471
> 
> 赞同：0
> 
> 时间：2012-11-21T14:32:05.613
> 
> 标签：css

我试图将绝对定位元素的高度设置为 80%，并将其顶部和底部边距设置为 10%，以便为元素提供 80% 的窗口高度并在其上方和下方留出 10% 的空间，因为其他元素将出现在那里。

但是正如您在这个小提琴[http://jsfiddle.net/qnLC2/](http://jsfiddle.net/qnLC2/)中看到的那样，并且正如 W3C CSS Box-model 规范中所述，所有边距的宽度实际上都设置为窗口宽度（而不是高度）的 10%（尝试调整输出屏幕的大小并使其更宽以查看效果）。

W3C CSS 盒子模型规范：

```
The percentage is calculated with respect to the width of the generated box's
containing block. Note that this is true for 'margin-top' and 'margin-bottom' as well. 
If the containing block's width depends on this element, then the resulting layout is 
undefined in CSS 2.1. 
```

我想知道是否有任何 CSS 唯一的方法来解决这个问题。

jsfiddle 代码：html：

```
 <div></div> 
```

CSS：

```
div {
 min-width:20px;    
 min-height:20px;
 background:blue;
 position:absolute; 
 height:80%;
 width: 80%;
 margin:10%;
}
body{
 background:red;   
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T14:45:19.943

似乎没有任何方法可以仅使用 CSS 来实现。您将需要 javascript 来详细说明： [我可以根据基于百分比的宽度设置 div 的高度吗？](https://stackoverflow.com/questions/10062811/height-div-based-on-percentage-based-width)

# c - 我在一个函数中将值添加到 C 数组中，在后面的函数中数组仍然是空的，有什么用？

> ID：13495472
> 
> 赞同：-2
> 
> 时间：2012-11-21T14:32:05.633
> 
> 标签：c, arrays, function, pointers, dereference

指针被声明

```
int *v; 
```

并调用这两个函数。

```
createMemObjects(M, N, v, context);
transferToDevice(M, v, commands); 
```

所以在我传递 int *pv 的第一个函数中，我填充了数组：

```
pv = malloc(sizeof(int) * M); 
memset(pv, 0, sizeof(int)*M);

for (int i = 0; i<M; i++) {
        pv[i] = N; //Initialise every element of vector with N.
        printf("Element %d: %d\n", i, pv[i]);
    } 
```

打印显示 pv 已被 N=2 填充。

在稍后将 *pv 作为参数的函数中，我使用了类似的打印循环：

```
for (int i = 0; i<M; i++) {
        printf("Element %d: %d\n", i, pv[i]);
    } 
```

而不是 2s，它显示所有元素都回到 0。我做错了什么？很确定我一直在正确使用指针，但是我错过了什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T14:55:05.727

正如所评论的，您需要传递指针的*地址*`v`，因为 C 按值传递参数，包括指针。正如代码所代表的那样，其中分配了一个*副本*，因此调用者看不到更改：`v``createMemObjects()`

```
/* Invoke as */
createMemObjects(M, N, &v, context); 
```

更改`v`to`int**`和 within的参数类型`createMemObjects()`：

```
*pv = malloc(sizeof(int) * M); 
```

`memset()`紧随其后的`malloc()`是多余的，因为`for`正在初始化每个`int`in `pv`。

# php - 获取共享点数据的网络服务给出错误

> ID：13495473
> 
> 赞同：0
> 
> 时间：2012-11-21T14:32:08.973
> 
> 标签：php, web-services, sharepoint, iis, sharepoint-2007

我正在我的网络服务文件中执行以下操作以获取共享点列表数据：

```
$authParams = array('login' => 'user', 'password' => 'pass');

/* A string that contains either the display name or the GUID for the list.
 * It is recommended that you use the GUID, which must be surrounded by curly
 * braces ({}).
 */
$listName = "TestList1";
$rowLimit = '150';

$wsdl = "http://192.168.1.197:5000/sharepoint/ListsWSDL.wsdl"; 

//Creating the SOAP client and initializing the GetListItems method parameters
$soapClient = new SoapClient($wsdl, $authParams);
$params = array('listName' => $listName, 'rowLimit' => $rowLimit);

//Calling the GetListItems Web Service
$rawXMLresponse = null;
try{
    $rawXMLresponse = $soapClient->GetListItems($params)->GetListItemsResult->any;
}
catch(SoapFault $fault){
    echo 'Fault code: '.$fault->faultcode;
    echo 'Fault string: '.$fault->faultstring;
} 
```

但它会进入 catch 块并出现以下错误：

```
Fault code: HTTPFault string: Not Found 
```

问题是什么。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T01:33:32.323

试试`http://[sharepoint site url]/_vti_bin/lists.asmx?WSDL`wsdl，

但实际的网络服务存在于`http://[sharepoint site url]/_vti_bin/lists.asmx`

这个[web 服务列表](http://msdn.microsoft.com/en-us/library/ms479390%28v=office.12%29.aspx)有一个页面显示每个服务的 url。

# javascript - 如何进行内联验证

> ID：13495482
> 
> 赞同：0
> 
> 时间：2012-11-21T14:32:41.280
> 
> 标签：javascript, jquery, ajax, validation

![在此处输入图像描述](../Images/3e05c72bed13fee5c89f79de875709cc.png) 当我输入名称时，它会在文本框旁边显示“正确的符号”。你能告诉我它的编码吗...我可以使用 javascript 进行这种类型的验证吗

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T14:49:31.080

是的，您可以在 Javascript 中进行此类验证。事实上，Javascript 的主要用途之一是进行表单验证。有多种方法可以做到这一点，甚至还有库和框架（[示例](http://www.javascript-coder.com/html-form/javascript-form-validation.phtml)）来进行表单验证。

这很常见，以至于一些浏览器具有内置的验证算法（例如，如果`<input type="email">`它的内容看起来不像最新的 Google Chrome 中的电子邮件地址，则会抱怨）。

如果您想进行验证，有几个您可能感兴趣的事件。`onblur`当表单元素失去控制时发生。`onkeypress`一旦用户按下一个键就会发生。还有其他事件。但通常您希望在用户将焦点从控件更改为另一个控件时进行验证 ( `onblur`)。

```
<!DOCTYPE html>
<html>
<head>
</head>
<body>
  Enter name then  press tab or click outside the input field:
  <input type="text" name="fname" id="fname" onblur="validate()"/>
</body>
</html> 
```

`validate()`函数可以是这样的：

```
function validate()
{
  var val = document.getElementById("fname").value
  if ( /\d/.test( val ) ) {
    alert( "First name cannot have digits in it: " + val );
  }
} 
```

您可以搜索网络以获取更多信息。

# ios - Adobe AIR：从 iFrame 异步加载数据（iOS-p

> ID：13495485
> 
> 赞同：1
> 
> 时间：2012-11-21T14:33:02.107
> 
> 标签：ios, asynchronous, air

我们有一个 Adob​​e AIR 移动应用程序，它显示一个网页（我们称之为 run.html），其中包含一个 iFrame。run.html-page 是一个本地页面，位于应用程序存储目录中。加载run.html后，将iFrame的src-Attribute设置为一个值，使iFrame加载另一个页面（我们称之为content.html），该页面与run.html位于同一文件夹中

content.html 现在尝试通过 Javascript 异步加载 JSON 文件，这在 Android 设备上运行良好，但在 iOS 设备上似乎不起作用。

这很奇怪，因为我们假设页面是由 AIR 呈现的，并且无论设备如何都应该遵循相同的策略。

那么为什么它可以在 Android 上运行，但不能在 iOS 上运行呢？为什么它不能在 iOS 上运行？

我们花费了无数小时无济于事，因此我们非常感谢您对此的任何支持...

# android - Android：相机预览的屏幕方向/旋转

> ID：13495489
> 
> 赞同：14
> 
> 时间：2012-11-21T14:33:11.840
> 
> 标签：android, camera, orientation

我已经创建了一个相机应用程序，我希望我的应用程序能够以所有 4 个可能的方向打开，并相应地更新相机预览。为此，我使用了从以下方法复制的方法： [Android - Camera preview is sideways](https://stackoverflow.com/questions/3841122/android-camera-preview-is-sideways/5110406#5110406)

```
 public void updateCameraDisplay(int w, int h) {
        // set preview size and make any resize, rotate or
        // reformatting changes here

        Log.i("CameraPreviews", "Updating camera orientation with w=" + w
                + " and h=" + h);
        Parameters parameters = camera.getParameters();
        Display display = getActivity().getWindowManager()
                .getDefaultDisplay();

        int rotation = getActivity().getResources().getConfiguration().orientation;
        Log.i("CameraPreviews", "rotation is " + display.getRotation());
        if (display.getRotation() == Surface.ROTATION_0) {

            parameters.setPreviewSize(h, w);
            camera.setDisplayOrientation(0);
        }

        if (display.getRotation() == Surface.ROTATION_90) {
            parameters.setPreviewSize(w, h);
            camera.setDisplayOrientation(270);
        }

        if (display.getRotation() == Surface.ROTATION_180) {
            parameters.setPreviewSize(h, w);
            camera.setDisplayOrientation(180);
        }

        if (display.getRotation() == Surface.ROTATION_270) {
            parameters.setPreviewSize(w, h);
            camera.setDisplayOrientation(90);
        }

        try {
            camera.setParameters(parameters);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
} 
```

我已经调整了这些值，在三星 Galaxy Tab2 上对其进行了测试，以最终获得正确的方向，并且一切正常。当我在htc one的手机上尝试它时，它根本不起作用！！！！！！！所有的 e 方向都是完全错误的！所以我得出的结论是，必须有 2 种类型的设备（或更多......请不要！）因为旋转表示屏幕从其“默认”位置旋转了多少度，然后某些设备有一个默认位置和其他人。我怎样才能知道这个默认轮换并在我的代码中采取相应的行动？ej: defaultOrientation=some code if(defaultOrientation==0) ... else ...

锁定屏幕方向是不可能的。目标 api>=11 非常感谢

编辑：我已将代码修改为：

```
public void updateCameraDisplay(int w, int h) {
        // set preview size and make any resize, rotate or
        // reformatting changes here

        Log.i("CameraPreviews", "Updating camera orientation with w=" + w
                + " and h=" + h);
        Parameters parameters = camera.getParameters();
        Display display = getActivity().getWindowManager()
                .getDefaultDisplay();

        int rotation = getActivity().getResources().getConfiguration().orientation;
        Log.i("CameraPreviews", "screen rotation is " + rotation);
        Log.i("CameraPreviews", "display rotation is " + display.getRotation());
        if (display.getRotation() == Surface.ROTATION_0) {

            if (rotation == Configuration.ORIENTATION_LANDSCAPE) {
                parameters.setPreviewSize(h, w);
                camera.setDisplayOrientation(0);
            } else {
                parameters.setPreviewSize(h, w);
                camera.setDisplayOrientation(90);
            }
        }

        else if (display.getRotation() == Surface.ROTATION_90) {
            if (rotation == Configuration.ORIENTATION_PORTRAIT) {
                parameters.setPreviewSize(w, h);
                camera.setDisplayOrientation(270);
            } else {
                parameters.setPreviewSize(w, h);
                //camera.setDisplayOrientation(0);
            }
        }

        else if (display.getRotation() == Surface.ROTATION_180) {
            if (rotation == Configuration.ORIENTATION_LANDSCAPE) {
            parameters.setPreviewSize(h, w);
            camera.setDisplayOrientation(180);
            }else {
                parameters.setPreviewSize(h, w);
                camera.setDisplayOrientation(270);
            }
        }

        else if (display.getRotation() == Surface.ROTATION_270) {
            if (rotation == Configuration.ORIENTATION_PORTRAIT) {
                parameters.setPreviewSize(w, h);
                camera.setDisplayOrientation(90);
            } else {
                parameters.setPreviewSize(w, h);
                camera.setDisplayOrientation(180);
            }
        }

        try {
            camera.setParameters(parameters);
        } catch (Exception e) {
            e.printStackTrace();
        }
    } 
```

只要我们不在纵向模式下倒置旋转手机，它在 htc one s 和 samsung galaxy tab 上的效果会更好

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-17T22:22:40.003

the factors you need to think about are: the orientation of the device, the degree between the screen and the camera, assuming you are using the back camera, and whether you enable the activity to sense the orientation change.

And one important thing is whether the Camera HAL code implemented by the manufacturer is compliant with Google's protocol.

# mysql - MySQL 无法启动 - InnoDB：数据库未正常关闭！InnoDB：开始崩溃恢复

> ID：13495492
> 
> 赞同：0
> 
> 时间：2012-11-21T14:33:15.053
> 
> 标签：mysql, xampp, innodb, mediawiki

我在使用 MySQL 时遇到了一些问题 - 服务已停止并且不会重新启动。

我有一个运行 MediaWiki 的 XAMPP 堆栈，它使用 MySQL 数据库。服务器本身是一个运行 Windows 2003 SP2 和 512MB RAM 的 VM。

以下是 mysql_error.log 的摘录

```
121120 16:11:46 [Note] Plugin 'FEDERATED' is disabled.
121120 16:11:46 InnoDB: The InnoDB memory heap is disabled
121120 16:11:46 InnoDB: Mutexes and rw_locks use Windows interlocked functions
121120 16:11:46 InnoDB: Compressed tables use zlib 1.2.3
121120 16:11:46 InnoDB: Initializing buffer pool, size = 16.0M
121120 16:11:46 InnoDB: Completed initialization of buffer pool
121120 16:11:46 InnoDB: highest supported file format is Barracuda.
InnoDB: Log scan progressed past the checkpoint lsn 28821623
121120 16:11:47  InnoDB: Database was not shut down normally!
InnoDB: Starting crash recovery.
InnoDB: Reading tablespace information from the .ibd files...
InnoDB: Restoring possible half-written data pages from the doublewrite
InnoDB: buffer...
InnoDB: Doing recovery: scanned up to log sequence number 28825154
121120 16:11:47  InnoDB: Starting an apply batch of log records to the database...
InnoDB: Progress in percents: 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 
InnoDB: Apply batch completed
121120 16:11:48  InnoDB: Waiting for the background threads to start
121120 16:11:49 InnoDB: 1.1.8 started; log sequence number 28825154
121120 16:11:49 [Note] Server hostname (bind-address): '0.0.0.0'; port: 3306
121120 16:11:49 [Note]   - '0.0.0.0' resolves to '0.0.0.0';
121120 16:11:49 [Note] Server socket created on IP: '0.0.0.0'.
121120 16:11:49 [Note] Event Scheduler: Loaded 0 events
121120 16:11:49 [Note] d:\xampp\mysql\bin\mysqld.exe: ready for connections.
Version: '5.5.25a'  socket: ''  port: 3306  MySQL Community Server (GPL)
121120 16:16:41 [Note] Plugin 'FEDERATED' is disabled.
121120 16:16:41 InnoDB: The InnoDB memory heap is disabled
121120 16:16:41 InnoDB: Mutexes and rw_locks use Windows interlocked functions
121120 16:16:41 InnoDB: Compressed tables use zlib 1.2.3
121120 16:16:41 InnoDB: Initializing buffer pool, size = 16.0M
121120 16:16:41 InnoDB: Completed initialization of buffer pool
121120 16:16:41 InnoDB: highest supported file format is Barracuda.
InnoDB: The log sequence number in ibdata files does not match
InnoDB: the log sequence number in the ib_logfiles!
121120 16:16:41  InnoDB: Database was not shut down normally!
InnoDB: Starting crash recovery.
InnoDB: Reading tablespace information from the .ibd files...
InnoDB: Restoring possible half-written data pages from the doublewrite
InnoDB: buffer...
121120 16:16:42  InnoDB: Waiting for the background threads to start
121120 16:16:43 InnoDB: 1.1.8 started; log sequence number 28841927
121120 16:16:43 [Note] Server hostname (bind-address): '0.0.0.0'; port: 3306
121120 16:16:43 [Note]   - '0.0.0.0' resolves to '0.0.0.0';
121120 16:16:43 [Note] Server socket created on IP: '0.0.0.0'.
121120 16:16:43 [Note] Event Scheduler: Loaded 0 events
121120 16:16:43 [Note] d:\xampp\mysql\bin\mysqld.exe: ready for connections.
Version: '5.5.25a'  socket: ''  port: 3306  MySQL Community Server (GPL) 
```

修复尝试：

*   尝试从服务开始 - 错误 1067 - “进程意外终止”
*   尝试重新启动服务器本身 - 不好
*   尝试从目录中移动 ib_logfile0 和 ib_logfile1 文件并重新启动服务器不好
*   尝试从命令提示符处杀死 MySQL 的 PID，以防它仍在运行但未运行。

如果有人能指出我正确的方向，将不胜感激。

NB> 我也在尝试增加服务器的 RAM，以防万一。目前 512MB 只有大约 90MB 是免费的。

谢谢德韦恩

# python - Sublime Text 2 - 在解释器中运行选定的 python 代码

> ID：13495494
> 
> 赞同：14
> 
> 时间：2012-11-21T14:33:19.027
> 
> 标签：python, interpreter, sublimetext2

在 Sublime Text 编辑器中编辑 python 脚本时，我想逐行运行脚本，或者在嵌入式解释器中逐块运行。

有没有方便的方法来做到这一点？对我来说完美的方式是：

1.  选择几行代码
2.  点击快捷方式，它将在解释器中运行选定的代码

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-21T14:52:33.193

我认为有两种选择，一种可以使用 PdbSublimeTextSupport，可在此处获得：http: [//pypi.python.org/pypi/PdbSublimeTextSupport](http://pypi.python.org/pypi/PdbSublimeTextSupport)

或者你可以试试 SublimeREPL，它可以运行 Python 代码：[https ://github.com/wuub/SublimeREPL](https://github.com/wuub/SublimeREPL)

# css - 在 Internet Explorer 中悬停时背景图像跳跃 1px

> ID：13495496
> 
> 赞同：2
> 
> 时间：2012-11-21T14:33:38.413
> 
> 标签：css, internet-explorer, hover

有一个奇怪的 IE 问题一直困扰着我。它在其他浏览器（Chrome / Firefox）中正常工作。

对于那些想直接深入代码的人来说，这里[有一个 Fiddle](http://jsfiddle.net/JgWzF/1/)。重要部分：

HTML：

```
<a href="#" class="btn">MyButton</a> 
```

CSS：

```
.btn {
    display:block; width:135px; height:58px; text-indent: -9999px;
    background-image:url("http://i47.tinypic.com/e7f4w6.png");
}

.btn:hover { background-position:bottom; } 
```

在小提琴中，我添加了一个箭头来显示图像的正确“中心”。如您所见，这只是一个用于导航的简单**图像精灵。**图片的高度是实际按钮高度的两倍，所以我们可以应用`background-position:bottom`.

但由于某种原因，当鼠标悬停时，IE 无法正确显示图像。不知何故，箭头（黑线）和中心线（悬停状态下的红线）不再对齐：

正常状态： ![正常状态](../Images/26e80ab872bed7937ce3b407f7074117.png)

悬停状态： ![悬停状态](../Images/e19d0f442cf975fe36232ab4e66f388b.png)

因为行“跳跃”，文本也跳跃（在我的示例中几乎看不到，但在我的项目中你会看到它非常好）。在 Win7 上使用 IE9 及更低版本测试并发生。

我希望你能找到这个小脑筋急转弯的解决方案！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T15:09:56.547

上面 jQuerybeast、Miguel-F 和 Billy Moat 的评论把我推向了另一个方向（谢谢大家！），我试图在另一台机器上打开我的 Fiddle。相同的浏览器，相同的操作系统，**运行良好**。

经过进一步调查，我发现是我的屏幕分辨率和/或视频显示和/或任务栏导致了奇怪的效果。这意味着我的代码是正确的，但不知何故 IE 在屏幕上绘制了一些错误的像素（其他浏览器这样做是正确的）。但这可能是一个全新的问题。

再次感谢您的帮助！

# ruby-on-rails-3 - 设计登录rails 3

> ID：13495497
> 
> 赞同：0
> 
> 时间：2012-11-21T14:33:39.357
> 
> 标签：ruby-on-rails-3, devise

这可能是一个简单的问题，但是如果我在设计 User 模型中添加一个名为 name 的列，然后在 User 模型中将 :name 添加到 attr_accessible，我可以允许用户在不指定其名称的情况下登录吗？

所以注册表单看起来像这样

```
<h2>Sign up</h2>

<%= form_for(resource, :as => resource_name, :url => registration_path(resource_name)) do |f| %>
<%= devise_error_messages! %>

<p><%= f.label :name %><br />
<%= f.text_field :name %></p>

<p><%= f.label :email %><br />
<%= f.email_field :email %></p>

<p><%= f.label :password %><br />
<%= f.password_field :password %></p>

<p><%= f.label :password_confirmation %><br />
<%= f.password_field :password_confirmation %></p>

<p><%= f.submit "Sign up" %></p>
<% end %>

<%= render :partial => "devise/shared/links" %> 
```

登录表格看起来像这样

```
<h2>Sign in</h2>

<%= form_for(resource, :as => resource_name, :url => session_path(resource_name)) do |f| %>
<div><%= f.label :email %><br />
<%= f.email_field :email %></div>

<div><%= f.label :password %><br />
<%= f.password_field :password %></div>

<% if devise_mapping.rememberable? -%>
<div><%= f.check_box :remember_me %> <%= f.label :remember_me %></div>
<% end -%>

<div><%= f.submit "Sign in" %></div>
<% end %>

<%= render "devise/shared/links" %> 
```

我只是希望能够在注册时收集他们的姓名，以便稍后在应用程序中使用它，但登录凭据不需要它吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T14:40:50.320

用户默认使用电子邮件和密码登录。您可以在注册表单中添加任意数量的字段。它不会影响登录行为。

# mvvm - 淘汰视图模型和requirejs

> ID：13495498
> 
> 赞同：5
> 
> 时间：2012-11-21T14:33:41.247
> 
> 标签：mvvm, knockout.js, viewmodel, requirejs

我最近开始使用 requirejs，当我尝试创建一个简单的视图模型时，我遇到了一个奇怪的异常。异常来自 knockout-2.1.0.js 文件，异常是“只有可订阅的事物才能充当依赖项”。

```
define("PageViewModel", ["knockout-2.1.0"], function(ko) {
    return function PageViewModel() {
        var self = this;
        self.visiblePage = ko.observable("StartPage");
        self.showPage = function (pageName) {
            self.visiblePage(pageName);
        };
    };
}); 
```

正如您所看到的，viewmodel 非常简单，并且由于错误出现在敲除 js 文件中，因此似乎 requirejs 正在正常工作。我一直在看：[http](http://knockoutjs.com/documentation/amd-loading.html) ://knockoutjs.com/documentation/amd-loading.html 来的时候出现异常：self.visiblePage = ko.observable("StartPage");

关于我做错了什么的任何想法？

谢谢，路德维希

更新：这是包含 pageviewmodel 的模块：

```
define("ViewModelFactory", ["StorageService", "PageViewModel", "AddUnitViewModel", "AddRoomViewModel"],
function (StorageService, PageViewModel, AddUnitViewModel, AddRoomViewModel) {
    //var repositoryStorage = new StorageService();
    var createAddRoomVM = function () {
        var vm = new AddRoomViewModel();
        vm.setRepository = StorageService.getRoomRepository();
        return vm;
    };
    var createAddUnitVM = function () {
        var vm = new AddUnitViewModel();
        vm.setRepository = StorageService.getUnitRepository();
        return vm;
    };
    var createPageVM = function () {
        var vm = new PageViewModel();
        return vm;
    };

    return {
        createPageVM:createPageVM,
        createAddRoomVM: createAddRoomVM,
        createAddUnitVM: createAddUnitVM
    };
}); 
```

以及调用工厂的模块

```
define("ApplicationViewModel", ["ViewModelFactory"],
function (viewModelFactory) {
    mainVM = null;
    var initVM = function () {
        mainVM = {
            page: viewModelFactory.createPageVM(),
            addRoom: viewModelFactory.createAddRoomVM(),
            addUnit: viewModelFactory.createAddUnitVM()
        };
    };

    var getVM = function (viewName) {
        switch (viewName) {
            case "AddRoom":
                return mainVM.addRoom;
            case "AddUnit":
                return mainVM.addUnit;
            default:
                return null;
        }
    };
    var getPageVM = function () {
        return mainVM.page;
    };

    return {
        initVM: initVM,
        getVM: getVM,
        getPageVM: getPageVM,
        mainVM: mainVM
    };
}); 
```

以及包含 applicationViewModel 的类：

```
define("Bootstrapper", ["knockout-2.1.0", "Routing", "ApplicationViewModel"],
function (ko, routing, applicationViewModel) {
    var run = function () {
        applicationViewModel.initVM(); <-- after here mainVM.page is null
        var mainVM = applicationViewModel.mainVM;
        routing.initRouting(applicationViewModel);
        ko.applyBindings(mainVM);
        routing.showView("StartPage");
        alert("Start");
    };

    return {
        run: run
    };
}) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-03T20:32:19.763

您的问题可能是由 Knockout 2.1 引起的，当 ko 不是全局变量时，它无法正常工作。

淘汰赛 2.2 应该可以正常工作，我从您的评论中看到这确实解决了问题。

# iphone - - (void)applicationDidEnterBackground:(UIApplication *)application

> ID：13495500
> 
> 赞同：-1
> 
> 时间：2012-11-21T14:33:43.913
> 
> 标签：iphone, ios, nsurlconnection, appdelegate

我想在`applicationDidEnterBackground`被调用时取消 url 连接。但我不知道如何在整个应用范围内保存连接。我在其他视图控制器中创建了一些 url 连接，但我想在`AppDelegate`. 我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T16:49:06.477

您可以`UIApplicationDidEnterBackgroundNotification`在创建连接的类中添加观察者。尝试这个：

```
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(enterBackground) name:UIApplicationDidEnterBackgroundNotification object:nil]; 
```

记得叫这个

```
[[NSNotificationCenter defaultCenter] removeObserver:self name:UIApplicationDidEnterBackgroundNotification object:nil]; 
```

在你的课上`dealloc`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T14:59:21.643

我相信当您的应用程序进入后台时，您的 NSURLConnections 将被杀死。

如果您想跟踪所有 NSURLConnections，您需要自己跟踪它们，方法是将它们添加到 NSSet、NSArray 或其他一些数据结构中，然后循环关闭它们。您还可以有一个继承或组成 NSURLConnection 的类。此数据结构将处理将自身添加到队列中，并且您可以在应用程序退出时进行清理。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T16:47:29.760

最好在 app 变为非活动状态而不是**applicationDidEnterBackground**之前停止连接。

答案是使用通知：

```
-(void)init
{
//
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(closeConnection) name:UIApplicationWillResignActiveNotification object:nil];
//
}
-(void)closeConnections
{
// [urlConnection cancel];
} 
```

# openlaszlo - 滚动编辑文本 openlaszlo 中的焦点问题

> ID：13495501
> 
> 赞同：1
> 
> 时间：2012-11-21T14:33:43.440
> 
> 标签：openlaszlo, lzx

我在 DHTMl 运行时遇到了 scrolledittext 问题我使用的是 firefox 16.0 当我运行它并触发 onfocus 事件时，我有以下代码，整个文本都被选中了。知道为什么吗？

我正在使用 Openlaszlo 5.0

```
<canvas>
<include href="incubator/scrolledittext.lzx" /> 
<include href="lz/vscrollbar.lzx"/>
<include href="incubator/newvscrollbar.lzx"/>
<include href="incubator/newvscrollbar_resources.lzx"/>

           <button name="text">
           <handler name="onclick">
            canvas.sp.inp.onfocus.sendEvent();

           </handler>
           </button>
  <scrolledittext name="sp" x="50" y="50" 
                                 height="300" 
                                 width="400" 
                                 focusable="true"
                >

           </scrolledittext>

</canvas> 
```

# r - 在 3D 中绘制两点之间的线

> ID：13495502
> 
> 赞同：12
> 
> 时间：2012-11-21T14:33:46.770
> 
> 标签：r, 3d, plot, line

我正在编写一个回归算法，它试图“捕获”盒子内的点。该算法试图使盒子尽可能小，因此盒子的边缘/角通常通过点，这决定了盒子的大小。

问题：我需要 R 中框的图形输出。在 2D 中很容易用 绘制框`segments()`，它在两点之间画一条线。所以，我可以用 4 段画一个框：

```
plot(x,y,type="p")
segments(x1,y1,x2,y2) 
```

然后我尝试了 3D 绘图的`scatterplot3d`和`plot3d`包。在 3D 中，该`segments()`命令不起作用，因为没有额外的 z 分量。我很惊讶显然（对我而言）在 3D 中没有足够的替代品`segments()`

在三维绘图时，是否有一种简单的方法可以在两点之间绘制框/线？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-21T15:03:33.337

该`scatterplot3d`函数返回允许您将 (x,y,z) 点投影到相关平面的信息，如下所示：

```
library(scatterplot3d)
x <- c(1,4,3,6,2,5)
y <- c(2,2,4,3,5,9)
z <- c(1,3,5,9,2,2)
s <- scatterplot3d(x,y,z)

## now draw a line between points 2 and 3
p2 <- s$xyz.convert(x[2],y[2],z[2])
p3 <- s$xyz.convert(x[3],y[3],z[3])
segments(p2$x,p2$y,p3$x,p3$y,lwd=2,col=2) 
```

包`rgl`是另一种方法，也许更容易（注意从向量*中成对*`segments3d`地取点）

 *```
plot3d(x,y,z)
segments3d(x[2:3],y[2:3],z[2:3],col=2,lwd=2) 
```*

# c# - Git从具有不同用户的批处理文件中提取

> ID：13495505
> 
> 赞同：2
> 
> 时间：2012-11-21T14:33:48.820
> 
> 标签：c#, asp.net, git, batch-file

我有一个用户，我们称之为“MyUser”。它有一个密码，假设它是“密码”。这个用户有一个 git 的 SSH 密钥。我尝试从我的 ASP.NET 应用程序运行一个发出 git 命令的批处理文件，它位于作为参数传递的位置。我的功能如下：

```
 private void ExecuteCommand(string path, int timeout)
    {
        Process process = new Process();

        process.StartInfo = new ProcessStartInfo();
        process.StartInfo.FileName = "cmd.exe";
        process.StartInfo.Arguments = "\"" + path + "\"";
        process.StartInfo.CreateNoWindow = true;
        process.StartInfo.UseShellExecute = false;
        //processInfo.WorkingDirectory = Config.GitHubRepoPath;
        process.StartInfo.UserName = "MyUser";
        process.StartInfo.Password = new System.Security.SecureString();
        process.StartInfo.Password.AppendChar('P');
        process.StartInfo.Password.AppendChar('a');
        process.StartInfo.Password.AppendChar('s');
        process.StartInfo.Password.AppendChar('s');
        process.StartInfo.Password.AppendChar('w');
        process.StartInfo.Password.AppendChar('o');
        process.StartInfo.Password.AppendChar('r');
        process.StartInfo.Password.AppendChar('d');
        // *** Redirect the output ***
        process.StartInfo.RedirectStandardError = true;
        process.StartInfo.RedirectStandardOutput = true;

        process.Start();

        // *** Read the streams ***
        string output = process.StandardOutput.ReadToEnd();
        string error = process.StandardError.ReadToEnd();

        if (timeout <= 0)
        {
            process.WaitForExit();
        }
        else
        {
            process.WaitForExit(timeout);
        }

        int exitCode = process.ExitCode;
        process.Close();
        return new ShellCommandReturn { Error = error, ExitCode = exitCode, Output = output };
    } 
```

但是当我运行这个函数时，ExitCode 是 -1073741502 并且错误和输出都是空的。我该如何解决这种行为？

请帮助我，我已经尝试从字面上解决这个问题好几天了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-11T10:44:34.327

我认为重定向标准错误和标准输出并尝试同时使用两者是错误的。请看这个链接： [http://msdn.microsoft.com/en-us/library/system.diagnostics.processstartinfo.redirectstandardoutput%28v=vs.100%29.aspx](http://msdn.microsoft.com/en-us/library/system.diagnostics.processstartinfo.redirectstandardoutput%28v=vs.100%29.aspx)

请允许我复制摘录：

*如果父进程调用 p.StandardOutput.ReadToEnd 后跟 p.StandardError.ReadToEnd 并且子进程写入足够的文本来填充其错误流，则会导致死锁条件。父进程将无限期地等待子进程关闭其 StandardOutput 流。子进程将无限期地等待父进程从完整的 StandardError 流中读取。*

另一件事是……当您调用 cmd.exe 实例时，也请尝试添加“/c”参数。

# .net - CLR 程序集绑定

> ID：13495506
> 
> 赞同：1
> 
> 时间：2012-11-21T14:33:52.680
> 
> 标签：.net, visual-studio-2010, clr, .net-assembly, clr4.0

全部，

我对程序的程序集如何绑定到底层 CLR 版本几乎没有疑问。

1) 是否可以构建/运行引用 .net 4.0 程序集（使用 CLR 4.0）的 .net 2.0 应用程序？如果是这样，怎么做？

2) 我对 .net 框架的理解告诉我，在 .net 4.0 应用程序（即针对 CLR 4.0 构建）中引用 .net 2.0 程序集是可以的。在这种情况下，应用程序是在 CLR 4.0 下构建和运行的，但是当引用的程序集（在 .net 2.0/3.0/3.5 (CLR 2.0) 中构建）被加载并执行时会发生什么？应用程序现在是否加载 CLR 2.0？或者代码是否在旨在运行旧程序集的 CLR 4.0 下执行？

期待您的回复。随意详细说明。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T14:35:41.580

1) 不，不支持前向兼容性，应用程序将无法编译。

2) 代码在旨在运行旧程序集的 CLR 4.0 下执行。出于这个原因，它向后兼容。

# c# - c# 逐字字符串的正则表达式（处理类似“”的转义）

> ID：13495514
> 
> 赞同：5
> 
> 时间：2012-11-21T14:34:04.257
> 
> 标签：c#, .net, regex, escaping, verbatim-string

我正在尝试从 rc 文件中提取信息。在这些文件中，字符串中的“-chars 通过将它们加倍（“”）来转义，类似于 c# 逐字字符串。有没有办法提取字符串？

例如，如果我有以下字符串**"this is a ""test"""**我想获得**this is a ""test""**。它也必须是非贪婪的（非常重要）。

我尝试使用以下正则表达式；

```
"(?<text>[^""]*(""(.|""|[^"])*)*)" 
```

然而表演很糟糕。我基于这里的解释：http: [//ad.hominem.org/log/2005/05/quoted_strings.php](http://ad.hominem.org/log/2005/05/quoted_strings.php)

有没有人知道使用正则表达式来解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T14:37:03.797

你有一些嵌套的重复量词。[这对性能来说可能是灾难性的。](http://www.regular-expressions.info/catastrophic.html)

尝试这样的事情：

```
(?<=")(?:[^"]|"")*(?=") 
```

现在只能同时使用两个引号......或非引号字符。lookbehind 和lookahead 断言，实际匹配在引号之前和之后。

这也让你不必捕捉任何东西。您想要的结果将只是您想要的完整字符串（没有外引号）。

我不断言外部引号没有加倍。因为如果它们是，无论如何都无法将它们与空字符串区分开来。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T15:28:35.003

事实证明这比您预期的要简单得多。带有转义引号的字符串文字看起来就像一堆简单的字符串文字一起运行：

```
"Some ""escaped"" quotes"

"Some " + "escaped" + " quotes" 
```

所以这就是你需要匹配它的全部内容：

```
(?:"[^"]*")+ 
```

您必须在单独的步骤中去掉前导引号和尾随引号，但这没什么大不了的。无论如何，您都需要一个单独的步骤来取消转义引号（`\"`或`""`）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-11T19:33:23.603

*   匹配一个 " 开头的字符串
*   多次匹配一个非“或两个”
*   匹配一个 " 结尾的字符串

`"([^"]|(""))*?"`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T15:20:00.063

试试这个`(?<=^")(.*?"{2}.*?"{2})(?="$)` ，它可能会比前两个更快，而且没有任何错误。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-21T15:05:56.073

如果这比 m.buettner 的更好或更差，请不要（猜测不是 - 他似乎知道他的东西），但我想我会把它扔在那里进行批评。

```
"(([^"]+(""[^"]+"")*)*)" 
```

# vba - 无法从 VBA 代码访问 dll 文件。如何查找 DLL 的问题？

> ID：13495517
> 
> 赞同：2
> 
> 时间：2012-11-21T14:34:39.357
> 
> 标签：vba, dll

我在使用 VBA 代码引用 DLL 时遇到问题。

**我的目标是：** 我有一个 dll 文件，用 C++ 编写的代码（我猜是这样）并编译。我不知道那里编码了什么。我必须从我的 VBA 代码中访问这个 dll，从 dll 中获取结果。我对 dll 的输入是 Excel 表中的 3 个整数值。

我已经像这样声明了 dll Public Declare Function quadratic Lib "C:...\Desktop\Test\quadratic.dll" (ByVal a As Integer, ByVal b As Integer, ByVal c As Integer) As Double (... 三点只是窗口目录）

单击按钮时，我从工作表中读取输入值 a,b,c 并调用传递参数的函数，例如 getvalue = quadratic(a, b, c)

1.  运行脚本时出现 Microsoft Visual Basic 错误，提示“运行时错误 '48'：找不到文件：C:...\Desktop\Test\quadratic.dll”

2.  在此之后，我尝试使用 Tools->Reference->Browse 引用此 dll，然后映射保存在我桌面上的 dll 文件，我收到 Microsoft Visual Basic for Application 错误，提示可以添加对指定文件的引用。

3.  我尝试使用带有命令 regsvr32 C:...\dllname.dll 的 cmd 提示符注册 DLL，它给出以下错误“LoadLibrary("C:\Documents") failed - The specific module could not be found”

4.  我尝试使用命令 rundll32.exe C:...\dllname.dll 在 cmd 提示符下使用第二种方法注册 DLL，它给出以下错误“加载 C:\Documents 时出错。找不到特定模块”

我不知道如何解决这个问题。我通过更改VB代码尝试了各种方法，但没有任何乐趣。

我需要， 1\. 如何使用 VBA 脚本引用它？2\. 如何找到DLL中的问题为什么我不能在VBA中引用它？

请尽快帮助我，因为它非常紧急。

问候， 卡比兰

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T16:03:15.830

如果不了解有关 Dll 和您正在使用的文件结构的更多信息，很难诊断问题，但看起来 Dll 当前位于“我的文档”或类似目录下的目录中。请记住，DOS 不会自动处理空格 - 您需要添加双引号。

尝试再次运行 register 命令，但这次用引号将路径括起来，例如

```
regsvr32 "C:\Documents and Settings\dllname.dll" 
```

假设这可行，应该能够以您在步骤 2 中指定的方式引用 Dll。

# c# - 如何将这个循环写成一行？

> ID：13495528
> 
> 赞同：4
> 
> 时间：2012-11-21T14:35:03.597
> 
> 标签：c#, linq, c#-4.0, for-loop, dataset

我不知道这是否可能，但让我问你。如何使用例如 LINQ 以更短的方式编写以下循环？

```
DataSet dsAllMonsters 
List<string> lstAllMonsters

for (int i = 0; i < dsAllMonsters.Tables[0].Rows.Count; i++)
{
    lstAllMonsters.Add(dsAllMonsters.Tables[0].Rows[i]["pokemonId"].ToString());
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T14:37:04.560

我认为可以。

```
lstAllMonsters = dsAllMonsters.Tables[0].Rows
   .Cast<DataRow>()
   .Select(r => r["pokemonId"].ToString())
   .ToList(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-21T14:37:20.630

是的，它可以在一行中完成：

```
lstAllMonsters = dsAllMonsters.Tables[0].Rows.Cast<DataRow>().Select(row => row["pokemonId"].ToString()).ToList(); 
```

但有时两条线比一条线好。我想你会发现这更具可读性：

```
var rows = dsAllMonsters.Tables[0].Rows.Cast<DataRow>();
lstAllMonsters = rows.Select(row => row["pokemonId"].ToString()).ToList(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T15:02:06.627

在一条线上实现它的另一种方法。

```
dsAllMonsters.Tables[0].AsEnumerable().ToList().ForEach((DataRow a) => lstAllMonsters.Add(a["pokemonId"].ToString())); 
```

# ida - IDA Pro 字符串函数

> ID：13495538
> 
> 赞同：0
> 
> 时间：2012-11-21T14:35:27.123
> 
> 标签：ida

我有这个想要编辑的二进制文件，但是在加载它之后，所有的字符串都是某种乱码。反正有格式化吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-22T18:11:01.993

## 为什么你看到“胡言乱语”：

**字符串可能被混淆了。** 很有可能，在程序中使用每个字符串之前，运行反混淆例程以将内存中的字符串转换回有意义的内容。这是用于防止静态分析工具（例如 GNU“字符串”实用程序或 IDA Pro）正确分析二进制文件的常用技术。这个答案的其余部分假设这对你的二进制文件是正确的。

## 如何去混淆字符串（动态方法）：

如果您能够运行二进制文件，则可以让它为您处理反混淆。您需要做的就是在调试器中运行二进制文件并在对其进行反混淆后分析内存。

一些对其字符串进行模糊处理的二进制文件在使用后永远不会重新混淆它们，因此您可能想首先尝试的一个有趣的捷径是在调试器中运行二进制文件并在它退出之前中断执行。如果字符串仍然经过去混淆处理，您可以对相应部分进行内存转储以保存去混淆处理的字符串。（这不一定会为您去混淆所有的字符串；您只会得到沿着二进制执行路径去混淆的字符串）

如果前面的方法对您不起作用，请尝试在混淆字符串的第一个字节上设置硬件写入断点，然后运行二进制文件。如果断点跳闸，请逐步执行说明以允许对字符串的其余部分进行去混淆处理。如果反混淆总是从一个常见的例程中发生，您可以在该例程的末尾附近放置一个断点，并可能编写您的调试器以在每次执行通过该例程时打印去混淆的字符串。

一旦你有了一个去混淆字符串的列表，你可以将它们直接打补丁到 IDA 数据库中（下面讨论），或者你可以`'`在数据库中每个字符串的地址处留下可重复的注释（使用密钥），这样去混淆的字符串将显示为每条引用它的指令的注释。

对于小型二进制文件，您可以不用手动进行注释，但值得阅读 IDA 脚本，以便您可以自动执行此过程。 [IDA Pro Book](http://www.idabook.com/)对此有很好的参考。

## 如何去混淆字符串（静态方法）：

如果您无法运行二进制文件，或者如果动态方法没有为您对所有字符串进行反混淆，那么您可以自己对它们进行反混淆。

如果您在 IDA Pro 中查看对任何混淆字符串的交叉引用（使用`x`密钥查看它们），则很有可能，您应该进入反混淆例程。如果例程不是太复杂（通常也不是），您应该能够编写一个脚本来模拟去混淆例程。这将允许您用 IDA 数据库中的去混淆字符串替换混淆字符串。

（澄清一点，IDA 数据库与二进制文件本身是完全分开的。你对数据库所做的任何事情都不会影响实际的二进制文件，你对二进制文件所做的任何事情都不会影响数据库）

编写 IDA 脚本的选项是 IDC（IDA 的原始内置脚本语言）和 IDAPython。我强烈推荐使用 IDAPython，因为它更容易使用，并且是一种更强大的语言。我不确定你是否可以在 IDA Free 5.0 上安装 IDAPython，但它应该与所有模糊的 IDA Pro 最新版本捆绑在一起。

概述脚本 IDA 将超出此答案的范围，但这里有一个示例可以帮助您入门。如果您使用 IDA Free，我将在 IDC 中编写它。假设您的反混淆例程只是将每个连续的字节与 0x1F 进行异或运算，直到空字节被解码。然后以下循环可能最终成为您 IDC 脚本的一部分：

```
// *EXAMPLE*
auto addr = 0x00401000; // The address of your string

while(1){
    auto b = Byte(addr) ^ 0x1F;
    PatchByte(addr, b);
    if (b == '\0'){
        break;
    }
    addr = addr + 1;
} 
```

可以从`File > IDC Command...`或运行脚本`File > Script file...`。

正如您可能猜到的，`Byte`返回存储在给定地址的字节，并将字节`PatchByte`写入地址。IDAPython 中的内置函数与其 IDC 对应的函数名称相同，因此 IDAPython 版本几乎相同，没有类似 C 的语法。如前所述，我强烈推荐[IDA Pro Book](http://www.idabook.com/)来了解如何编写 IDA 脚本。一旦掌握了基础知识，就可以使用 IDA 的内置帮助索引和[IDAPython 文档](http://www.hex-rays.com/products/ida/support/idapython_docs/)作为其他参考。

**在运行修补代码的脚本之前，请务必保存您的数据库！**IDA 中没有“撤消”功能，因此一个小的编码错误可能会破坏您的整个数据库。

祝你好运！

# macos - Netbeans 在视网膜显示器上的 mac os x 山狮上看起来很模糊

> ID：13495539
> 
> 赞同：2
> 
> 时间：2012-11-21T14:35:30.167
> 
> 标签：macos, netbeans, java, retina-display

昨天我正在设置我的带有视网膜显示器的新 macbook pro，并意识到 netbeans 看起来非常模糊。这对我来说很重要，因为我每天花费 8 到 10 个小时使用 netbeans。我在网上搜索我发现这是 jre 1.7 的问题，并且可以与苹果提供的 jre 1.6 一起使用。

问题是我已经在我的 mac 上安装了 jre 1.7 并且没有找到将我的 jre 降级到 1.6 的方法，这对我来说并不重要，因为我不是 java 开发人员，我只需要 jre 来运行 netbeans 并做我的喜欢 PHP Web 开发。

请任何关于如何从山狮的 1.7 降级到 jre 1.6 的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T14:42:51.780

您可以尝试[Retinizer](http://retinizer.mikelpr.com)，尽管它不会增加应用程序中任何图标的分辨率，只会增加任何文本以及 Cocoa GUI。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-07T02:43:30.527

我遇到了同样的问题。可以告诉 NetBeans 使用不同版本的 Java： [https ://discussions.apple.com/thread/4470872?start=0&tstart=0#21143742](https://discussions.apple.com/thread/4470872?start=0&tstart=0#21143742)

如果您仍想降级以便所有应用程序的*默认*版本为 Java 6，请在此处查看我的评论： [https ://stackoverflow.com/a/6413600/560114](https://stackoverflow.com/a/6413600/560114)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-16T02:15:21.403

升级到 Mountain Lion 后，我遇到了同样的问题。在升级之前我使用的是 Java 6，现在我使用的是 Java 7，并且看到了丑陋的字体渲染。

但是，有一种方法可以修复 Netbeans 上的字体，而不必恢复到以前的 Java 版本。问题是默认的 Netbeans 字体“Monospaced 13”映射到两个 Java 版本中的不同字体。Java 6 版本将其映射为“Courier 13”，而 Java 7 版本将其映射为丑陋的东西。因此，您只需将 Netbeans+Java 7 中的默认字体更改为**“Courier 13”**（首选项 > 字体和颜色）即可获得漂亮的字体渲染。

更多细节在这里：[https ://netbeans.org/bugzilla/show_bug.cgi?id=229029](https://netbeans.org/bugzilla/show_bug.cgi?id=229029)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-11-07T14:15:26.197

这是难以置信的简单修复，但我很难找到答案。

你必须上传你的 JDK 7。我对 JDK 7u25 也有同样的问题。[并修复了在此处](http://www.oracle.com/technetwork/java/javase/downloads/jdk7-downloads-1880260.html)下载最新版本 7u72 表单的问题

所以，先做一些检查。跑：

`$ java -version`

我使用的是“java版本”1.7.0_25

然后运行以下命令获取路由。

`$ /usr/libexec/java_home -v 1.7`

在升级之前，您应该获得：

`/Library/Java/JavaVirtualMachines/jdk1.7.0_25.jdk/Contents/Home`

然后安装新版本，你应该使用最后一条命令获取新路由：

`$ /usr/libexec/java_home -v 1.7 /Library/Java/JavaVirtualMachines/jdk1.7.0_72.jdk/Contents/Home`

转到您的应用程序文件夹，查找 Netbeans（我有 8.01 版），右键单击“显示包内容”。

然后导航到 Contents/Resources/Netbeans/etc。并编辑 netbeans.conf 在该文件上添加带有值 netbeans_jdkhome 的行并放置您的路线。

`netbeans_jdkhome="/Library/Java/JavaVirtualMachines/jdk1.7.0_72.jdk/Contents/Home"`

完毕。

# iphone - 如何在应用程序中处理 api 令牌到期

> ID：13495543
> 
> 赞同：1
> 
> 时间：2012-11-21T14:35:45.813
> 
> 标签：iphone, ios, api, rest

我们的 API 返回一个用户身份验证代码，该代码具有会话到期（30 分钟不活动）。因此，如果我们使用身份验证令牌进行 api 调用，它会将会话更新到调用时间后的 30 分钟。

在 30 分钟不活动后，api 返回一个错误，指出令牌已过期。此时我们应该请求一个新的身份验证令牌。

但是，这样做的明显方法（向用户显示登录屏幕并让他们再次登录）将意味着在应用程序的某些功能中间切断用户。

例如，我们有各种带有选项和输入的视图控制器，它们在流程结束时聚合并提交一个完整的 API 调用。如果在用户填写这些输入和视图时服务器上的会话到期，那么在进行 API 调用时他们将被注销，并且他们将失去在这些视图中的进度。

有两种可能的解决方法：

1.  我们自己在应用程序中设置了计时器，以确保用户在应用程序不活动 30 分钟后退出。这意味着它们不会在一组输入期间被注销，但这会带来以下问题：即使我们正在运行自己的计时器，服务器 API 仍可能过期。因此这是行不通的。

2.  我们每 10 秒左右轮询一次服务器，询问 API auth 令牌是否仍然有效。这会消耗电池、数据和各种东西，而且不是做这样的事情的合理方式。

有没有人有任何想法？

谢谢汤姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T14:59:35.360

根据您的描述，这听起来像是一个经典的交易失败问题。万一您不熟悉事务处理，“事务处理的基本要素[”](http://www.subbu.org/articles/transactions/NutsAndBoltsOfTP.html)是该主题的入门读物。

如果您有能力修改后端系统，您将需要确保 ACID 后端。

这可能意味着在客户端上构建数据，并且在您完成交易之前不将数据发送到服务器。这样，如果会话超时，客户端仍然拥有完成事务所需的所有数据。（利用原子性）

这可能意味着拥有交易令牌。在创建新会话时，客户端可以向服务器发送事务令牌，并且事务的状态在新会话中恢复。（利用耐用性）

对我来说，这两个选项都比清除现有事务并迫使用户重新开始要好。

希望有帮助。

# android - 异步任务进度对话框显示太晚

> ID：13495547
> 
> 赞同：3
> 
> 时间：2012-11-21T14:35:59.317
> 
> 标签：android, asynchronous, task, progressdialog

进度对话框出现，可能在异步任务完成后延迟，在 doInBackground 中它调用 Web 服务并解析 xml，如果 xml 中的文件更大，则活动必须等待几秒钟

```
@Override
protected void onPreExecute(){
    super.onPreExecute();
    completed=false;
    this.progressDialog.show();

}

@Override
protected Boolean doInBackground(Integer... params) {
    t=HttpHelper.callWebService( url, soapAction,xml);
    if (t.equals("")){  
        return false;
    }
    else {
        try {
            SAXParserFactory spf = SAXParserFactory.newInstance();
            SAXParser sp = spf.newSAXParser();
            XMLReader xr = sp.getXMLReader();
            XMLHelperFile myXmlHelperFile = new XMLHelperFile();
            xr.setContentHandler(myXmlHelperFile);
            InputSource is = new InputSource(new StringReader(CallWebFile.t)); 
            xr.parse(is);
            mesaj = myXmlHelperFile.getParsedData(); 
            completed=true;
    } catch (Exception e) {
            e.printStackTrace();
        }
        return true;
    }

}

@Override
protected void onPostExecute(Boolean result) {
    super.onPostExecute(result);
    if (completed==true && progressDialog.isShowing()) progressDialog.dismiss();
}

@Override
protected void onProgressUpdate(Integer... values) {
    super.onProgressUpdate(values);

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T14:42:49.730

只是一个猜测。在 preExecute() 中初始化进度对话框

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T14:44:32.030

`publishProgress(some int value);`您在 doInBackground()中缺少对 publishProgress 的调用

# php - 如何通过 javascript (jquery) 将 html 元素的内容设置为 php 包含文件

> ID：13495548
> 
> 赞同：0
> 
> 时间：2012-11-21T14:35:59.073
> 
> 标签：php, javascript, jquery, ajax

如何通过javascript（jquery）将html元素的内容设置为php包含文件我的意思是

```
$('#loadTest').append(' <?php include_once "test.php"; ?>'); 
```

我也试过加载

```
$('#loadTest').load('test.php',function(){
            alert("loaded!!")
        }); 
```

但它不起作用:'(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T14:39:00.293

您必须使用 AJAX：

```
$.get('test.php', function(data) {
    $('#loadTest').append(data);
}); 
```

代码必须在服务器上执行，然后将输出返回给您。

# c - 服务器客户端消息验证

> ID：13495551
> 
> 赞同：0
> 
> 时间：2012-11-21T14:36:07.107
> 
> 标签：c, sockets, unix, tcp

我对客户端和服务器之间的通信有疑问。我想通过 TCP unix 套接字发送数据（我知道如何做到这一点），但我不知道测试发送的消息是否可以完全读取（不是每个块的块）的最佳实践是什么。

因此，我在想这个

1.  客户端发送格式化的数据 printf(3)，消息被写入字符串并发送。
2.  服务器收到消息，但如何确定消息是否已满？我需要循环直到消息完成吗？

所以我的想法是使用一个代码（或者可能是校验和？），它将被预先添加并附加到这样的消息中：

**【验证码】** my_long_data_formatted **【验证码】**

然后，服务器尝试读取数据，直到读取第二个验证码并成功检查。

这是客户端/服务器通信的正确解决方案吗？如果是，您对验证边界有何建议？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T14:47:06.173

TCP 已经有一个内置的校验和/验证。因此，如果消息被接收，则它被正确接收。

通常，您唯一需要担心的是弄清楚消息的长度。这可以通过在开头发送消息长度或在结尾放置终止字符或序列来完成。

可以说，为了确保发送者和接收者“在同一页面上”，接收者通常会在收到消息后发回响应，即使该响应只是说“OK”。

这种技术的示例包括 HTTP、SMTP、POP3、IMAP 和许多其他技术。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T15:12:36.737

您需要建立一个**应用程序级协议**，它会以某种方式告诉您应用程序消息在 TCP 提供给您的字节流中的开始和结束位置（以及连接方如何进行对话）。

流行的选择是：

*   固定长度的消息。适用于二进制数据并且非常简单。
*   具有固定格式或大小标头的可变大小消息，可告知消息其余部分的确切大小（可能还有类型）。适用于二进制和文本数据。
*   分隔消息 - 一些字符，如换行符或`\x1`特殊字符，表示消息边界。最好使用文本数据。
*   自描述消息，如 XML、S 表达式或 ASN.1。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-21T14:57:32.807

有几种方法可以做到这一点，所以我认为没有“正确”的解决方案。您的解决方案可能会奏效。需要注意的一点是，您需要确保您选择的验证代码不会作为消息中数据的一部分发送。如果是这种情况，您将检测到消息是完整的，即使它确实不是消息的结尾。如果无法知道数据的外观，您可能需要尝试不同的技术。

根据您的描述，听起来您的消息是可变长度的。另一种方法是使所有消息的长度相同，这样您就知道每次要读取多少数据才能获得完整的消息。

另一种方法是首先发送消息的长度（例如二进制 32 位数字），它指示在消息结束之前要读取的字节数。您首先读取它以获取数据量，然后从套接字读取该量。

如果您有一定数量的消息，每次长度都相同，您可以为每条消息分配一个编号，然后先发送该编号，然后您可以阅读该编号。使用该信息，您可以根据分配给消息的编号确定要读取多少数据。

您选择用于解决方案的内容可能取决于消息是否可变或长度固定和/或您是否需要随数据发送附加信息等因素。在这种情况下，您可能会混合发送一个固定长度的标头，其中包含有关随后数据的信息；无论是长度还是后面的数据类型。

# php - 将变量从 javascript 传递到 php

> ID：13495553
> 
> 赞同：-3
> 
> 时间：2012-11-21T14:36:25.467
> 
> 标签：php, javascript

我通过使用 cookie 使用以下代码从 javascript php 传递变量。

```
<script type="text/javascript">
function gTest() {
               var country = 'hello testing';
    document.cookie = 'name=document.write(country);' ; 
         document.write(country);
}
gTest();
</script>

<?php  
echo "<br>";
     var_dump($_COOKIE['name']);  
?> 
```

如果我们改为

```
 document.cookie = 'name=hello' ; 
```

我想将变量值传递给同一页面中的 php...我不想发送到另一个页面。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T14:37:54.560

`$_COOKIE`填充有从浏览器发送到服务器的数据。

更改 cookie 的 JS 不会运行，直到返回响应并执行 JavaScript。

在您发出新的 HTTP 请求之前，其中的值`$_COOKIE`不会更新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T14:50:13.093

你不能。

好吧，我想我得解释一下了。在您的页面上，首先是 Javascript，然后是 PHP 代码，但它没有按该顺序执行。首先，服务器执行 PHP 代码，将页面作为 HTML 发送，然后在客户端执行 javascript。

如果您真的不想重新加载整个页面，唯一的方法是使用 ajax 请求到您的 PHP 代码所在的页面。只需使用 JQuery 并将您的 PHP 代码替换为：

`$('#result').load('showCookie.php');`

showCookie.php 的内容将是您的 var_dump 并且该页面将完全按照您的意愿执行，除了您使用 JQuery 调用了一个附加页面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T14:40:35.857

您可以使用 XHR。

JavaScript（使用 jQuery）：

```
$.ajax('script.php', { 
    data: { 'name': 'hello' }
}); 
```

PHP：

```
 var_dump($_GET['name']); 
```

# sql - 升级到 Mac OS Lion - 如何备份 Ruby、*SQL 等？

> ID：13495558
> 
> 赞同：0
> 
> 时间：2012-11-21T14:36:56.867
> 
> 标签：sql, ruby, macos, osx-lion, upgrade

在过去的 2 年里，我主要在 Macbook Pro 上使用 Snow Leopard 系统工作，在接下来的几天里，我想升级到 Lion OS X 系统。我的担忧来自我目前在笔记本电脑上使用的设置——我在那里安装并配置了 Ruby、Php、PostgreSQL、MySQL、Heroku-data 等。还有 Mail.app（超过 12k 封电子邮件）、文档、照片库、只是一切...

有什么方法可以安装新的 OS X 并保留我当前的程序+数据+开发工具？如果没有，您能否给我一些提示，如何使升级尽可能地无痛？

到目前为止，我没有升级OSX系统的经验，所以我会欢迎所有的建议。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T16:07:42.447

Mac 上的操作系统升级会保留您的所有文件。Lion 唯一需要的是任何依赖 PowerPC 的应用程序，因为 Rosetta 在 10.7 中不再可用。

# wcf - 无法使用 mod-mono 访问托管在 Apache 中的 WCF 服务

> ID：13495559
> 
> 赞同：0
> 
> 时间：2012-11-21T14:36:57.230
> 
> 标签：wcf, apache, mono, mod-mono

我有一个 WCF 服务，使用托管在 Apache 2.2.15 中的 basicHttpBinding，在 CentOS 中使用 mod_mono。我在 /etc/httpd/conf/httpd.conf 的末尾添加了以下指令以启用 WCF 服务：

```
MonoServerPath default /usr/bin/mod-mono-server4
AddType application/x-asp-net .svc 
```

当我尝试从 Windows 中的客户端调用服务中的操作时：

```
 BasicHttpBinding binding = new BasicHttpBinding();

    IService1 service1 = ChannelFactory<IService1>.CreateChannel(binding, new EndpointAddress(new Uri(`"http://ipaddress/svctest/Service1.svc"`)));

    string test= service1.GetData(1); 
```

抛出以下异常：

> ProtocolException 未处理：响应消息的内容类型 application/x-asp-net 与绑定的内容类型不匹配 (text/xml; charset=utf-8)。如果使用自定义编码器，请确保正确实现 IsContentTypeSupported 方法。响应的前 109 个字节是：'<%@ ServiceHost Language="C#" Debug="true" Service="svcfiletest.Service1" CodeBehind="Service1.svc.cs"% >

当我通过浏览器访问服务时，它会下载文件而不是显示服务描述。

> 当我使用`svcutil`http://ipaddress/svcutil/Service1.svc?wsdl 时，我收到以下消息：
> 
> url 处的文档`http://ipaddress/svctest/Service1.svc`未被识别为已知文档类型。来自每种已知类型的错误消息可能会帮助您解决问题： - 来自“XML 架构”的报告是“名称不能以 '%' 字符开头，十六进制值 0x25。第 1 行，位置 2。'。- 来自“WSDL 文档”的报告是“XML 文档 (1,2) 中存在错误。”。-名称不能以'%'字符开头，十六进制值0x25。第 1 行，位置 2。

似乎它从 Service1.svc 获取文本：

```
<%@ ServiceHost Language="C#" Debug="true" Service="svcfiletest.Service1" CodeBehind="Service1.svc.cs" %> 
```

有什么帮助吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T17:32:04.237

您是否也确实在您的某个地方加载了模块`/etc/httpd/conf/httpd.conf`？

您需要`Include /etc/apache2/mod_mono.conf`（或将其放入包含在您的 config 目录中`http.conf`）和`LoadModule mono_module /usr/lib/httpd/modules/mod_mono.so`

请参阅[http://www.mono-project.com/Mod_mono](http://www.mono-project.com/Mod_mono)。

**我的设置 - 手动启动 mod-mono**

我手动编译了 mod-mono，这是我的 mod_mono.conf：[http://pastebin.com/qp8vxHQ7](http://pastebin.com/qp8vxHQ7)。您需要使用此设置手动启动 mod-mono-server。

我在 中签出了这个[模块](https://github.com/baulig/Provcon-Faust/tree/master/TestWCF)`~/Sites/`，apache 将其选为`http://localhost/~Martin/`.

`~/Sites`然后，我在这样的目录中启动了 mod-mono-server4 ：

```
 mod-mono-server4 --port 9000 --applications /~martin/Service:Service --verbose 
```

这工作正常。

**我的设置 - 自动启动 mod-mono**

还测试了另一种设置： http: [//pastebin.com/tYWk3tC9](http://pastebin.com/tYWk3tC9)。这让 apache 启动 mod-mono。

# javascript - jeditable loadurl：引用css id或只是根据需要传入变量

> ID：13495560
> 
> 赞同：0
> 
> 时间：2012-11-21T14:37:03.653
> 
> 标签：javascript, jquery, flask, jinja2, jeditable

我的页面上有这个：

```
$('.editable-question').editable('{{my_identifier}}/form_item/edit',{
                    //loadurl: 'example/restful/url/in/app/{{???????????????}}',
                    type   : 'textarea',
                    cancel : 'Cancel',
                    submit : 'OK',                  
                    name   : 'edit_this',
                  }); 
```

我在 jinja 模板内的 Flask 应用程序中使用 jeditable。问题是，我需要将信息传递给“loadurl”以检索未格式化的降价文本，但我不知道如何从 css 中获取一些内容到该 loadurl 语句中：

```
<div id="f4d629f9f0" class="editable-question" style="">
    <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit</p>
</div> 
```

在这种情况下，我想将 css id 放入 {{????????}}。这通常是如何完成的？似乎是一个常见问题，但我还没有提出任何问题或答案。更多 rtfm'ing 我想。

一个不太紧迫的问题是我需要在某个时候从 ji​​nja 模板中删除我的 js，但我不确定如何将我需要的变量放入页面然后放入 js：我猜隐藏元素和/或js 根据需要抓取变量的 url 引用。

编辑：

我最终得到了类似的东西：

```
$('.editable-question').editable('/form_item/edit',{
                    id: 'my_id',
                    loadurl: 'node',
                    type   : 'textarea',
                    cancel : 'Cancel',
                    submit : 'OK',                  
                    name   : 'edit_this',
                  }); 
```

并且 my_id 被 jeditable 作为 url 参数 (?my_id={{css id}}) 传递，但感觉很脏，我更喜欢安静的 url，但只需要完成 atm 的工作，所以继续前进。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T16:22:32.697

不知道我理解你的问题是否正确？但我想出了三个答案：

1）如果您在 HTML 模板中包含您的 js，jinja 可以渲染 HTML 和 js。对于 jinja，模板 HTML、TXT、CSS 或 JS 中的数据类型无关紧要。

2) 您可以在 HTML 模板的隐藏字段中传递变量，并使用 dom 操作（如 jquery）从 dom 中获取变量。

3) 你可以在你的 HTML 中包含一个小的 javascript，它只包含一个带有变量的函数。在您的外部 javascript 文件中，您可以访问这些函数来获取变量。

为了得到这个想法，这是一个 HTML 模板的一部分，用于配置 codemirror 编辑器并在 HTML 和内联 js 中使用 jinja：

```
<!DOCTYPE HTML>
<html lang="en">
<head>
<meta charset="UTF-8">
<link type="text/css" rel="stylesheet" href="/jinjacms/static/jinjacms.css"> 
<link type="text/css" rel="stylesheet" href="/codemirror/lib/codemirror.css">
<link type="text/css" rel="stylesheet" href="/codemirror/theme/rubyblue.css">
<script type="text/javascript" src="/codemirror/lib/codemirror.js"></script>
<script type="text/javascript">
function editor(id)
{
        CodeMirror.fromTextArea(document.getElementById(id), {
        theme: "rubyblue", 
        lineNumbers: true, 
        mode: {{ mode }},
        {% if readonly %}readOnly: "nocursor",{% endif %} 
        tabSize: 4,
        indentUnit: 4,
        indentWithTabs: true,
        tabMode: "shift"
      });
}
</script>
<style>.CodeMirror {border-top: 1px solid black; border-bottom: 1px solid black;}</style>
<title>{{ title }}</title>
</head>
<body onload="editor('text_data');"> 
```

# java - 获取, (#803) 你请求的一些别名不存在错误

> ID：13495566
> 
> 赞同：15
> 
> 时间：2012-11-21T14:37:18.180
> 
> 标签：java, facebook, facebook-graph-api

当我尝试使用图形 api 从 facebook 获取数据时，出现此错误，

```
{"error":
{"message":"(#803) Some of the aliases you requested do not exist: 124186682456_10151302011177457&access_token=REMOVED_ACCESS_TOKEN",
"type":"OAuthException",
"code":803}} 
```

谁能帮我解决这个问题。

提前致谢...

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-21T20:07:48.417

如果这是您收到的错误的准确表示，那么您错误地将访问令牌附加在`&`字符而不是`?`. 您需要`?`用于查询字符串的开头，并将查询字符串`&`内的参数分开

例如 `https://graph.facebook.com/124186682456_10151302011177457?access_token=ACCESS_TOKEN`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-08-12T04:01:42.563

紧随其后放置 access_token 参数`?`与问题无关...

可能是您的 URL 中到处都是`%20`或类似的东西。

我在尝试[Facebook API 文档](https://developers.facebook.com/docs/places/web/search#example)中的测试示例时遇到此错误，起初我阅读了投票最高的答案，但在 不起作用`access_token`后立即移动参数，然后我更仔细地检查了 URL 并发现了一些被卡在参数上的编码空间和其他一些，删除它解决了这个问题。`?``%20``fields`

尝试以下 URL（只需将 access_token 参数替换为您的）

[https://graph.facebook.com/search?type=place&fields=name,checkins,picture&q=cafe¢er=40.7304,-73.9921&distance=1000&access_token=[YOUR_ACCESS_TOKEN]](https://graph.facebook.com/search?type=place&fields=name,checkins,picture&q=cafe&center=40.7304,-73.9921&distance=1000&access_token=[YOUR_ACCESS_TOKEN])

如果可行，请在 Facebook 参数名称中查找问题

希望这可以节省您一些时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-06-15T16:29:22.490

Instagram 内容发布 API 也发生在我身上，该 API 也脱离了 facebook graph api。当您尝试通过 GET 请求发送到 Facebook 的 API URL 出现问题时，似乎会发生这种情况。

在我的情况下，我的代码中发生了一些事情，导致在尝试查询图形 API 之前不会将`user_id`and传递给 URL。`access_token`

# javascript - NodeJS的Excel模块

> ID：13495579
> 
> 赞同：5
> 
> 时间：2012-11-21T14:37:44.607
> 
> 标签：javascript, excel, node.js

我想从 NodeJS 创建 .xls .xlsx 文件，但我找不到任何稳定的模块来做到这一点。

是否有任何稳定的 nodejs 模块用于生成简单的 excel 页面？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T17:11:50.530

Excel 格式由 Microsoft 作为[开放规范](http://msdn.microsoft.com/en-us/library/dd208104%28prot.20%29.aspx)发布。[您可以在此处](http://msdn.microsoft.com/en-us/library/cc313154%28v=office.12%29.aspx)以格式精美、令人生畏的 1200 页 PDF 格式获取规范。

我之前使用过 Microsoft 规范文档来弄清楚如何实现仅服务于我的特定用例的部分（不完整）系统。换句话说，如果您能找出您需要的确切位（即只需将二维数组转换为一些 excel 行），那么您通常可以忽略规范的其余部分，因为它不适用于您。

我还发现查看用其他语言编写的解决方案对我有帮助 - 例如，[这里有一个](http://epplus.codeplex.com/)使用 c# 的项目。

根据后端系统上可用的内容，您可以[生成一个](http://nodejs.org/api/child_process.html)处理转换的子进程。

或者，您可以将整个事情卸载到 Web 服务。[Google Documents List API](https://developers.google.com/google-apps/documents-list/)允许您存储和操作 Google Docs 文件，然后使用[Google Spreadsheets API](https://developers.google.com/google-apps/spreadsheets)您可以读取和修改 Google Spreadsheets 中的数据。

我意识到这些都不能真正解决您关于图书馆可用性的问题，但可能会给您一种解决问题的新方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-02-28T20:35:21.570

你试过[sheetjs](https://github.com/SheetJS/sheetjs)吗？这是有史以来最好的库！
如果您需要在 nodejs 服务器端评估某些公式，我还编写了一个简单的公式解析器。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-03-03T00:42:01.800

[OpenXML SDK for javascript](http://openxmlsdkjs.codeplex.com/) 使用这个。

# .net-3.5 - TargetInvocationException：Microsoft.AGL.Common.MISC.HandleAr（PAL_ERROR ar）

> ID：13495581
> 
> 赞同：4
> 
> 时间：2012-11-21T14:37:50.130
> 
> 标签：.net-3.5, windows-mobile, compact-framework, .net-cf-3.5

在我的 .NET Compact Framework 3.5 项目（在 Windows Mobile 6 上运行）中加载资源时，我随机收到 TargetInvocationException。它们看起来类似于此堆栈跟踪：

```
FATAL 2012-11-13 14:17:00,657 [23768895] TargetInvocationException - mobileX.MIP.Post.Presentation.Program
System.Reflection.TargetInvocationException: TargetInvocationException ---> System.Exception: Exception
at Microsoft.AGL.Common.MISC.HandleAr(PAL_ERROR ar)
at System.Drawing.Bitmap._InitFromMemoryStream(MemoryStream mstream)
at System.Drawing.Bitmap..ctor(Stream stream)
at System.Reflection.RuntimeConstructorInfo.InternalInvoke(RuntimeConstructorInfo rtci, BindingFlags invokeAttr, Binder binder, Object parameters, CultureInfo culture, Boolean isBinderDefault, Assembly caller, Boolean verifyAccess, StackCrawlMark& stackMark)
at System.Reflection.RuntimeConstructorInfo.Invoke(BindingFlags invokeAttr, Binder binder, Object[] parameters, CultureInfo culture)
at System.Reflection.ConstructorInfo.Invoke(Object[] parameters)
at System.Resources.ResourceReader.CreateResource(Type objType, Type[] ctorParamTypes, Object[] ctorParameters)
at System.Resources.ResourceReader.LoadBitmap(Int32 typeIndex)
at System.Resources.ResourceReader.LoadObjectV2(Int32 pos, ResourceTypeCode& typeCode)
at System.Resources.ResourceReader.LoadObject(Int32 pos, ResourceTypeCode& typeCode)
at System.Resources.RuntimeResourceSet.GetObject(String key, Boolean ignoreCase)
at System.Resources.ResourceManager.GetObject(String name, CultureInfo culture) 
```

我对这个异常的猜测是有一些我忘记清理的非托管资源。但是，我在项目中有很多表格和资源。

所以这是我的问题：

1.  尚未清理的表单或资源是否会成为此异常的原因？
2.  如何追踪浪费我记忆的确切表格或资源？

*关于 2：我已经使用.NET Compact Framework Power Toys 3.5*中的 CLR Profiler 分析了我的应用程序。大量内存用于 "NATIVE FUNCTION" / `System.Windows.Forms.Control::_InternalWnProc Microsoft.AGL.Common.PAL_ERROR (Microsoft.AGL.Forms.WM int32 int32)`。但是，我看不到这些资源在哪里使用。我怎样才能知道？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T08:05:02.220

1.  是的
2.  我希望（甚至不要试图声称电动玩具分析器会帮助你）

您将不得不检查您的代码。确保对所有 Disposable 对象调用 Dispose，包括所有 GDI 对象、位图、画笔。

其次，如果你曾经调用过 Font.ToHFont，这个调用是非常危险的，因为它需要你 p/invoke DeleteObject 来清理它。（托管调用需要 ap/invoke 不泄漏资源）

我唯一的建议是，出于某种原因，大多数时候我的 AGL 错误发生在问题根源附近。我不记得具体的原因了。在工作中，我们称之为未记录的“加速悲伤层 (AGL)”

最后，我要提出一个更尖锐的问题。您是否一次分配大量位图，然后释放它们，最后尝试创建托管内存对象，也许是缓冲区？Windows Mobile 6 是基于 Windows CE 5.0 而不是 Windows CE 6.0 构建的。因此，每个进程都有 32 MB 的内存限制。如果一次分配大量位图，它们会增加非托管堆的大小。当您处理位图时，会调用 LocalFree 并且堆取消提交但不会释放内存，.NET 将永远不会再看到它。除了避免一次分配大量位图之外，避免这种情况的唯一方法是分配大于或等于 96 KB 的位图，以保留堆外的页面。

可能怀疑这是你的问题，但我会提到它，因为它几乎不可能追踪。但是，我认为在这种情况下您最终会遇到崩溃或 OutOfMemoryException。

无论如何，我会确保您没有泄漏资源或句柄，并仔细检查您的流格式是否正确。

# expressionengine - ExpressionEngine -related_categories_mode 不工作

> ID：13495585
> 
> 赞同：0
> 
> 时间：2012-11-21T14:38:06.680
> 
> 标签：expressionengine

有一个相当基本的模板，可以输出主要文章，然后应该从同一频道输出其他三个，但是当使用以下代码时，“其他合作伙伴”区域没有任何输出，甚至没有“无帖子”，所以我真的没有确定出了什么问题。系统中有 5 篇以上的文章，所以肯定有结果要提取，有什么想法吗？

```
 {exp:channel:entries channel="partner" limit="1" url_title="{segment_3}"}

              <article>
                <h1>{title}</h1>
                {profile_logo:banner wrap="image"}
                {profile_body}
              </article>

{/exp:channel:entries}    

<h2>Other Partners</h2>
{exp:channel:entries channel="partner" related_categories_mode="yes" custom_fields="yes"}
   {if no_results}
     No posts
    {/if}
              <article>
                <a href="{url_title_path='community/partners'}">
                  {profile_logo:thumbnail wrap="image"}
                  <h3>{title}</h3>
                  <p>{profile_body}</p>
                </a>
              </article>
              {/if}
            {/exp:channel:entries} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T15:47:23.827

可能您在这里需要做的就是将`dynamic="no"`参数添加到您正在使用的第二个频道条目循环中`related_categories_mode`。您需要这样做，因为您在单个条目页面上，EE 将尝试使用`url_title`present in`segment_3`专门为该条目加载通道数据。

所以你应该尝试：

```
<h2>Other Partners</h2>
{exp:channel:entries channel="partner" related_categories_mode="yes" custom_fields="yes" dynamic="no"}
    [...]
{/exp:channel:entries} 
```

`dynamic=`该参数的官方文档在[此处](http://expressionengine.com/user_guide/modules/channel/channel_entries.html#dynamic)。

还要确保您在浏览器中加载的条目的分类方式使得该频道中确实存在类似分类的其他条目。如果没有其他共享相同类别的条目，您正在使用的通道循环将不会加载任何条目`related_categories_mode`。

此外，正如@Seibird 所提到的，在您的代码示例中，您`if`在结束标记之后看起来确实有一个额外的结束标记。`article`这很可能会造成干扰。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T17:29:58.447

看起来你有一个 random `{/if}`，不确定这是否会导致结果出现问题。您始终可以将当前类别传递给嵌入并像这样运行它：

```
{exp:channel:entries channel="partner" limit="1" url_title="{segment_3}"}

  <article>
    <h1>{title}</h1>
    {profile_logo:banner wrap="image"}
    {profile_body}
  </article>

  {embed="template_group/_related_partners" category="{categories backspace="1"}{category_id}|{/categories}"}
{/exp:channel:entries} 
```

**嵌入模板：**

```
{exp:channel:entries channel="partner" category="{embed:category}" dynamic="no" url_title="not {segment_3}"}
   {if no_results}
   No posts
   {/if}
   <article>
    <a href="{url_title_path='community/partners'}">
      {profile_logo:thumbnail wrap="image"}
      <h3>{title}</h3>
      <p>{profile_body}</p>
    </a>
   </article>
{/exp:channel:entries} 
```

# magento-1.7 - 我在 before_body_end 中添加了一个自定义块。为什么不显示？

> ID：13495596
> 
> 赞同：0
> 
> 时间：2012-11-21T14:38:37.117
> 
> 标签：magento-1.7

我创建了一个新的自定义块并将其添加到`before_body_end`块中。当我查看页面的源代码时，我的自定义块中没有显示任何内容。你能帮我调试一下吗？

在我的模块布局 XML 文件中：

```
<layout version="0.1.0">
    <default>
        <reference name="before_body_end">
            <block type="tankchat/js_view" name="tankchat.js.view" as="tankchat" template="tankchat/js/view.phtml" />
        </reference>
    </default>
</layout> 
```

我的课没有什么特别的`Company_Tankchat_Block_Js_View`，只有一些“getData”函数。

我的 phtml 位于，`app/design/frontend/company/default/template/tankchat/js/view.phtml`是的，它是很好的包和主题等。

我需要在某处添加 a`echo $this->getChildHtml('tankchat')`吗？我想我不是因为我的自定义块被传递给了`before_body_end`，但也许我错了？

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T15:56:59.347

好的，我终于发现出了什么问题：

我在声明我的布局文件时犯了一个错误，它需要在`frontend`节点中完成，而不是`global`！：

```
<config>
    <frontend>
        <layout>
            <updates>
                <tankchat>
                    <file>tankchat.xml</file>
                </tankchat>
            </updates>
        </layout>
    </frontend>
</config> 
```

该文件甚至没有被应用程序打开...

但我也忘了在我的模块配置文件中声明块前缀：

```
<config>
    <global>
        <blocks>
            <tankchat>
                <class>Company_Tankchat_Block</class>
            </tankchat>
        </blocks>
    </global>
</config> 
```

自动加载器找不到块类...

希望这对将来的人有所帮助...

# ruby-on-rails-3 - 限制索引中显示的数量后需要做一个显示所有新闻的链接

> ID：13495601
> 
> 赞同：0
> 
> 时间：2012-11-21T14:38:45.573
> 
> 标签：ruby-on-rails-3, view, controller

在我的索引视图中，我将显示的新闻数量限制为 2 个最新的

但我也想在数据库中包含所有新闻的链接

在我的新闻控制器中，我有

```
def index
    @news = News.all(:order => "created_at DESC", :limit => 2)
end 
```

我做了另一种方法给我所有的消息

```
def all
  @news_all = News.all(:order => "created_at DESC")
end 
```

我应该改为限制视图中的帖子数量吗？

这是我为显示所有新闻而制作的链接

```
<%= link_to 'All News', all_news_path => 
```

和我的习惯路线

```
match "news/all" => "news#all", :as => "all_news" 
```

`NewsController#show`我遇到了无法找到新闻的错误`id="all"`

我对 ruby​​ 很陌生，我不知道如何做到这一点:)

**更新**

我像 Kien 建议的那样更新了我的代码

在我的路线中使用过的集合

```
resources :news do
  collection do
    get 'all'
  end
end 
```

我的所有新闻的索引链接

```
<%= link_to 'All news', all_news_path, :class => 'btn btn-mini btn-success' %> 
```

我有一个`all.html.erb`看法

```
<% @news_all.each do |news| %>
  <h2><%= news.title %></h2>
  <%= news.created_at.strftime("%Y-%m-%d %H:%M") %><br />
  <%= truncate(news.body, :length => 450) %><%= link_to ' meira', news %>
  <%= news.author %><br />
<% end %> 
```

昨天这很好用，但今天我从 git 中退出，现在我`undefined local variable or method all_news_path`打开了索引文件中的链接..

谁能明白为什么？

**路线**

```
 root        /                                               news#index
             all_news_index GET    /news/all(.:format)                             news#all
                 news_index GET    /news(.:format)                                 news#index
                            POST   /news(.:format)                                 news#create
                   new_news GET    /news/new(.:format)                             news#new
                  edit_news GET    /news/:id/edit(.:format)                        news#edit
                       news GET    /news/:id(.:format)                             news#show
                            PUT    /news/:id(.:format)                             news#update
                            DELETE /news/:id(.:format)                             news#destroy 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T14:43:11.967

如果你这样制作路线，它将与`show`路线冲突：

```
news/:id
news/all 
```

路由会误会`all`是`:id`参数。

你应该使用集合：

```
resources news do
  collection do
    get 'all'
  end
end 
```

你会得到路线：`all_news_path`。您还需要`all.html.erb`在您的`app/views/news`文件夹中制作一个模板，以显示所有新闻。

这是你的错字吗？ `<%= link_to 'All News', all_news_path =>`

应该是`<%= link_to 'All News', all_news_path %>`

# jquery - jQuery使用简单的选择框过滤列表

> ID：13495603
> 
> 赞同：1
> 
> 时间：2012-11-21T14:38:52.420
> 
> 标签：jquery, list, filter, drop-down-menu

我想用 jquery 或 javascript 过滤这个简单的 LIST。我发现的唯一例子是有多个像这样的选择框：http: [//jsfiddle.net/EfEYQ/](http://jsfiddle.net/EfEYQ/)

你能帮我么？提前谢谢

```
<select id="filtercountry">
                    <option value='ALL' selected="selected">Select by Country</option>
                    <option value="1">Australia</option>
                    <option value="2">Austria</option>
                    <option value="3">Brazil</option>
                    <option value="4">Canada</option>
</select>

<ul class="submenu">
    <li class="submenucategory">KIDS</li>
    <li id="Cell1" class="lilist">AAAAAA <span class="country">1</span></li>
    <li id="Cell2" class="lilist">BBBBBB <span class="country">2</span></li>
    <li id="Cell3" class="lilist">CCCCCC <span class="country">2</span></li>
    <li id="Cell4" class="lilist">DDDDDD <span class="country">1</span></li>
    <li id="Cell5" class="lilist">EEEEEE <span class="country">3</span></li>
    <li id="Cell6" class="lilist">FFFFFF <span class="country">4</span></li>
</ul> 
```

​</p>

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T15:18:18.053

给你，伙计 - 与上面的示例几乎相同：

[演示](http://jsfiddle.net/9ezwZ/)​</p>

```
$('#filtercountry').change(function(){
    var criteria = $(this).val();
    if(criteria == 'ALL'){
        $('.lilist').show();
        return;
    }
    $('.country').each(function(i,option){
        if($(this).html() == criteria){
            $(this).parent().show();
        }else {
            $(this).parent().hide();
        }
    });
});​​​​​​​​​​​​​​ 
```

# python - 有哪些好方法可以创建同时请求的 HTTP 会话？

> ID：13495606
> 
> 赞同：1
> 
> 时间：2012-11-21T14:39:01.237
> 
> 标签：python, http, session-state

我有问题，无法解决。也许我把它变得太难或太复杂了，或者我只是走错了方向，思考了一些没有意义的事情。下面是对所发生情况的描述。（例如，在浏览器中打开多个选项卡或同时请求其他一些页面的页面。）

我有一种情况，Web 应用程序同时收到 3 个请求并且必须创建新的用户会话。此会话用于在用户登录时存储通知、XSRF 令牌和登录信息。应用程序使用线程来处理请求（Bottle.py 下的 CherryPy）。

3 个线程（或进程，以防万一或多个应用程序实例）开始处理 3 个请求。他们检查 cookie，不存在会话，并创建一个新的唯一令牌，该令牌存储在 cookie 和 Redis 中。这将同时发生，他们不知道会话是否已经由另一个线程创建，因为所有 3 个令牌都是唯一的。

这些未使用的会话最终会过期，但它并不整洁。这意味着每次客户端同时进行 N 个请求并需要创建一个新会话时，N-1 个会话是无用的。

如果有一个可以用来识别客户端的属性，比如 IP 地址，那会容易很多，但是在这种情况下使用 IP 地址并不安全。此属性可用于在 Redis 中以原子方式存储会话，其他请求只会获取该会话。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T14:48:33.610

如果这是通过浏览器并使用 cookie，那么这根本不是问题。据我所知，cookie 将设置为的最后一个会话值。如果您使用的客户端不使用 cookie，那么它当然会为每个连接打开一个新会话。

# python - 如何获取迭代器的内容？

> ID：13495607
> 
> 赞同：5
> 
> 时间：2012-11-21T14:39:02.060
> 
> 标签：python, beautifulsoup

我非常困惑。我有一块 HTML 是我从一个更大的表格中刮下来的。它看起来像这样：

```
<td align="left" class="page">Number:\xc2\xa0<a class="topmenu" href="http://www.example.com/whatever.asp?search=724461">724461</a> Date:\xc2\xa01/1/1999 Amount:\xc2\xa0$2.50 <br/>Person:<br/><a class="topmenu" href="http://www.example.com/whatever.asp?search=LAST&amp;searchfn=FIRST">LAST,\xc2\xa0FIRST </a> </td> 
```

（实际上，它看起来更糟，但我正则表达式掉了很多换行符）

我需要把这些线弄出来，把日期/金额线分开。开始的地方似乎是找到那个 HTML 块的孩子。该块是一个字符串，因为这就是正则表达式将它还给我的方式。所以我做了：

```
text_soup = BeautifulSoup(text)
text_children = text_soup.find('td').childGenerator() 
```

我发现[我只能迭代`text_children`一次](https://stackoverflow.com/questions/13486036/why-is-this-listiterator-stuck)，但我不明白为什么会这样。这是一种`listiterator`类型，我很难理解。

我习惯于假设如果我可以使用 for 循环遍历某些内容，我可以使用诸如 text_children[0] 之类的内容调用任何一个元素。迭代器似乎并非如此。如果我创建一个列表：

```
my_array = ["one","two","three"] 
```

我可以`my_array[1]`用来查看数组中的第二项。如果我尝试这样做，`text_children[1]`我会收到一个错误：

```
TypeError: 'listiterator' object is not subscriptable 
```

如何获取迭代器的内容？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-21T14:39:54.487

您可以通过以下方式轻松地从迭代器构造一个列表：

```
my_list = list(your_generator) 
```

现在您可以为元素下标：

```
print(my_list[1]) 
```

另一种获取价值的方法是使用`next`. 这将从迭代器中拉出下一个值，但是正如您已经发现的那样，一旦您从迭代器中拉出一个值，您就不能总是将其放回（是否可以放回完全取决于正在迭代的对象及其`next`方法的实际外观）。

这样做的原因是您通常只想要一个可以迭代的对象。迭代器对此**非常**有用，因为它们一次计算元素 1 而不需要存储所有值。换句话说，您一次只有一个来自迭代器的元素消耗系统的内存——与列表或元组相比，所有元素通常在开始迭代之前都存储在内存中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T14:43:41.680

正如我之前所说，简短的回答是从您的生成器创建一个列表。

像这样：`list(generator)`

长答案，以及原因的解释：

当你创建一个生成器，或者在你的情况下是一个“listiterator”，它是一个漂亮的汤使用的生成器，你并没有真正创建一个项目列表。您正在创建一个对象（生成器），它知道如何遍历一定数量的项目，一次一个，（`next()`）

那是什么意思。

而不是你想要的，可以说是一本带页面的书。

你得到一台打字机。

打字机可以创建一本书，但一次只能创建一页。现在，如果你只是从头开始，像 for 循环一样一次看一个，那么是的，这几乎就像阅读一本普通的书。

但与普通书不同的是，一旦打字机打完一页，你就不能倒退，那一页现在已经消失了。

我希望这是有道理的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-21T15:05:49.433

我试图找出一个更一般的答案：

*   可迭代对象是可以迭代的对象。这些包括列表、元组等。根据要求，它们会提供一个迭代器。

*   迭代器是*用于*迭代的对象。它为每个请求提供一个值，如果它结束了，它就结束了。这些是生成器、列表迭代器等，还有例如文件对象。每个迭代器都是可迭代的，并把自己作为它的迭代器。

例子：

```
a = []
b = iter(a)
print a, b # -> [] <listiterator object at ...> 
```

如果你这样做

```
for i in a: ... 
```

a 通过它的方法被请求一个迭代`__iter__()`器，然后这个迭代器被查询下一个元素，直到用完。这通过`.next()`(resp. `__next__()`in 3.x) 方法发生。

索引是完全不同的事情。如果对象没有`.__iter__()`方法，则可以通过索引进行迭代，因此每个可索引对象都是可迭代的，反之则不然。

# javascript - jQuery 晒干功能

> ID：13495611
> 
> 赞同：4
> 
> 时间：2012-11-21T14:39:12.977
> 
> 标签：javascript, jquery, if-statement, refactoring, dry

正如你在下面看到的，我清楚地重复了一遍。我知道这是不好的做法。

那么，如何将 if 和 else 语句中的 4 行重复代码重构为 1 行呢？

一些关于更好实践的指导将不胜感激。此外，您发现有助于学习此技术的任何 DRY 参考/教程。

```
$('.inner_wrap .details').click(function() {
    var index = $('.inner_wrap .details').index(this);

    $('.details').removeClass('here');
    $(this).addClass('here');
    $('.view').removeClass('active');
    $(this).find('.view').addClass('active');
    console.log(index);
    if(index > 2){
        index -= 3;
        **// This and its corresponding else statement is the topic of the question**
        $(this).closest('.outer_wrapper').prev('.outer_wrapper').find('.tabSlide').removeClass('tabShow');
        $(this).closest('.outer_wrapper').prev('.outer_wrapper').find('.tabSlide:eq(' + index + ')').addClass('tabShow');
    } else {
        $(this).closest('.outer_wrapper').prev('.outer_wrapper').find('.tabSlide').removeClass('tabShow');
        $(this).closest('.outer_wrapper').prev('.outer_wrapper').find('.tabSlide:eq(' + index + ')').addClass('tabShow');
    }

    return false;
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T15:01:53.133

请注意，代码在`if`和中都重复，这`else`意味着它总是被执行。只需将其从声明中删除：

```
if (index > 2) {
    index -= 3;
}
var elt = $(this).closest('.outer_wrapper').prev('.outer_wrapper');
elt.find('.tabSlide').removeClass('tabShow');
elt.find('.tabSlide:eq(' + index + ')').addClass('tabShow'); 
```

接下来，请注意 jQuery 对象只是一个数组。您可以因此简化代码：

```
if (index > 2) {
    index -= 3;
}
var elt = $(this).closest('.outer_wrapper').prev('.outer_wrapper').find('.tabSlide');
$(elt.removeClass('tabShow')[index]).addClass('tabShow'); 
```

最后，我们可以消除 aux 变量，它只是用来演示如何调用同一个对象：

```
if (index > 2) {
    index -= 3;
}
$($(this).closest('.outer_wrapper').prev('.outer_wrapper').find('.tabSlide').removeClass('tabShow')[index]).addClass('tabShow'); 
```

请把它分成多行代码：D

[编辑]

好吧，只是为了好玩，这里有一个更极端的宇航员类型代码，去掉了剩下的`if`：

```
$($(this).closest('.outer_wrapper').prev('.outer_wrapper').find('.tabSlide').removeClass('tabShow')[(index <= 2 ? index : index - 3)]).addClass('tabShow'); 
```

但！它非常不可读，IMO，你应该坚持第一步。在它成为性能问题之前，不要过度使用它。以可读性/可维护性为代价来应用 DRY 规则，或者只是将所有内容都放在一行代码中，这与阅读和编写压缩代码一样有意义。即，不要这样做:)。

[编辑 2]

@StuartNelson 让我想起了该`$.eq()`函数的存在，它会将最终代码带到这里（分成几行）：

```
$(this).closest('.outer_wrapper')
    .prev('.outer_wrapper')
    .find('.tabSlide')
    .removeClass('tabShow')
    .eq(index <= 2 ? index : index - 3)
    .addClass('tabShow'); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T14:53:41.973

您可以修改`index`only using`if`语句，并且可以为使用的 jQuery 元素保留一个变量：

```
$('.inner_wrap .details').click(function() {
    var index = $('.inner_wrap .details').index(this);

    $('.details').removeClass('here');
    $(this).addClass('here');
    $('.view').removeClass('active');
    $(this).find('.view').addClass('active');
    console.log(index);
    if(index > 2){
       index -= 3;
    }
    var element = $(this).closest('.outer_wrapper').prev('.outer_wrapper');
    element.find('.tabSlide').removeClass('tabShow');
    element.find('.tabSlide:eq(' + index + ')').addClass('tabShow');   
    return false;
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T14:52:57.317

这两行在 if 和 else 子句中最后执行，因此可以将它们从两者中拉出并放在整个 if/else 语句之后：

```
if(index > 2){
    index -= 3;
}

$(this).closest('.outer_wrapper').prev('.outer_wrapper').find('.tabSlide').removeClass('tabShow');
$(this).closest('.outer_wrapper').prev('.outer_wrapper').find('.tabSlide:eq(' + index + ')').addClass('tabShow'); 
```

这条规则总是正确的。如果它们是 if 和 else 子句中的前两行，则将它们拉出并放在 if 语句之前。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-21T14:55:07.120

由于您真正关心的是设置索引，这是您在 if 语句中唯一需要的，其余的可以出去：

```
if(index > 2){
    index -= 3;
}

$(this).closest('.outer_wrapper').prev('.outer_wrapper').find('.tabSlide').removeClass('tabShow');
$(this).closest('.outer_wrapper').prev('.outer_wrapper').find('.tabSlide:eq(' + index + ')').addClass('tabShow'); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-21T14:55:21.620

```
if(index > 2){ index -= 3; }
**// This and its corresponding else statement is the topic of the question**
$(this).closest('.outer_wrapper').prev('.outer_wrapper')
       .find('.tabSlide').removeClass('tabShow')
       .eq(index).addClass('tabShow') 
```

放弃 else，因为您正在执行该代码，无论您不需要将其包含在语句中。您也可以继续在链上工作，因为您首先使用类定位所有元素，`tabSlide`然后根据其索引仅定位该类的特定实例。

# file-upload - 有没有一种方法可以预测 .doc 的大小？

> ID：13495612
> 
> 赞同：1
> 
> 时间：2012-11-21T14:39:21.673
> 
> 标签：file-upload, ms-word, storage, filesize

我想知道是否有一种方法可以根据它包含的页数来预测 .doc 的大小。

我试图粗略估计在预期 X 个 Y 页长度的 .doc 时需要多少存储空间。

例如：“我需要计划 100 个 .DOC 文件，每个文件有 15 页长。这些 .DOC 将消耗大约 _KB 的空间。”

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T14:59:27.590

并不真地。变数太多了。

例如，一个 .doc (Word 2003) 的页面只包含字符“a”，其中一种字体占用 37kb，在另一种字体中，相同数量的字符占用 32kb，在另一种字体中占用 43kb。

最实用的方法是对样本文件的大小进行平均，然后解决这个问题，但请注意，最小的更改可能会产生相当大的影响。

# c# - 限制 C# 中匿名类型的使用

> ID：13495614
> 
> 赞同：2
> 
> 时间：2012-11-21T14:39:29.050
> 
> 标签：c#, asp.net-mvc, anonymous-types

我想搜索所有使用匿名类型的地方`Controllers`，如下所示。

```
if(success) {
    returnData = JsonConvert.SerializeObject(new { Success = true, Message = "Operation completed successfully" });
}
else {
    returnData = JsonConvert.SerializeObject(new { Success = false, Message = "Operation failed" });
} 
```

在上述情况下，`returnData`是 a `JsonResult`，它在我们的`Razor`视图中用于解析`AJAX`请求的状态。

我想在这种情况下尽量减少匿名类型的使用，因为这可能是维护问题，因为如果任何行被编写为编译器不会引发任何警告/错误，`new { Succes = true, Message = "Operation completed successfully"}`并且会导致客户端脚本中的运行时错误.

任何有关限制此类情况或检测此类情况的见解将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T14:43:46.177

为什么不使用“使用正则表达式”选项在解决方案/项目中搜索呢？

```
\bnew\s*{ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T14:55:11.780

只是不要使用匿名类型。使用您计划使用的数据创建一个新的具体类型：

```
public class JSONMessage
{
    public string Message { get; set; }
    public bool Success { get; set; }
} 
```

然后这些行可以更改为：

```
if(success) {
    returnData = JsonConvert.SerializeObject(new JSONMessage(){ Success = true, Message = "Operation completed successfully" });
}
else {
    returnData = JsonConvert.SerializeObject(new JSONMessage(){ Success = false, Message = "Operation failed" });
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T15:30:26.780

如何结束 json 调用，以便您可以有运行时错误/断言：

首先是从这里检测匿名的扩展：[Determining If a Type is an Anonymous Type](https://stackoverflow.com/questions/1650681/determining-whether-a-type-is-an-anonymous-type)

```
public static class TypeExtension {

    public static Boolean IsAnonymousType(this Type type) {
        var hasCompilerGeneratedAttribute = type.GetCustomAttributes(typeof(CompilerGeneratedAttribute), false).Count() > 0;
        var nameContainsAnonymousType = type.FullName.Contains("AnonymousType");
        var isAnonymousType = hasCompilerGeneratedAttribute && nameContainsAnonymousType;    
        return isAnonymousType;
    }
} 
```

然后使用它作为你的新方法。

```
 public static object JsonSeralize(object obj)
   {
      Debug.Assert(!obj.getType().IsAnonymousType());     
      return JsonConvert.SerializeObject(obj);
   } 
```

现在您可以轻松地直接搜索非法呼叫的地方`JsonConvert.SerializeObject`。

# javascript - jQuery setInterval 给出无效的参数

> ID：13495616
> 
> 赞同：0
> 
> 时间：2012-11-21T14:39:35.133
> 
> 标签：javascript, jquery, html

早上好，我创建了一个函数，它获取所有美国时区时间并将它们返回给我，突出显示您所在的时区。问题是我希望它每分钟运行一次。当我使用 setInterval 函数时，我不断收到一个 javascript 错误，提示“参数无效”。这是我在 jsFiddle [http://jsfiddle.net/Qg2eL/中的代码](http://jsfiddle.net/Qg2eL/)

```
// Timezone
var arrTime = new Array();
var arrZone = new Array("ET","CT","MT","PT");

var getTimeZones = setInterval(timeZone(),60000);

function timeZone(){
    var location = 0;
    var current_date = new Date();
    var offset = parseInt(-current_date.getTimezoneOffset() / 60);

    switch(offset){
        case -5:
            location = 0;
            break;
        case -6:
            location = 1;
            break;
        case -7:
            location = 2;
            break;
        case -8:
            location = 3;
            break;
    }

    arrTime.length = 0;
    for(var x=5; x<9; x++){
        var current_date = new Date();
        var utc_hour = current_date.getUTCHours() - x;
        var utc_minutes = current_date.getUTCMinutes().toString();

        var dd = "AM";
        if(utc_hour >= 12){
            utc_hour = utc_hour - 12;
            dd = "PM";
        }
        if(utc_hour == 0){ utc_hour = 12; }
        utc_minutes = utc_minutes<10?"0"+utc_minutes:utc_minutes;

        var formattedTime = utc_hour+":"+utc_minutes+" "+dd;

        arrTime.push(formattedTime);
    }

    var strHTML = "";
    strHTML += "<ul>";
    for(var x=0; x<arrTime.length; x++){
        strHTML += "<li>"+arrZone[x]+": "+arrTime[x]+"</li>";
    }
    strHTML += "</ul>";

    $('.timezoneHolder').html(strHTML);
    $('.timezoneHolder ul li:nth-child('+(location+1)+')').css({
        "color":"lime",
        "font-weight":"bold"
    });
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T14:42:41.493

非常常见的错误是您没有传递要执行的函数，而是在这一行中实际调用它：

`var getTimeZones = setInterval(timeZone(),60000);`

相当：

`var getTimeZones = setInterval(timeZone,60000);`

PS。在 Chrome 和 IE 中测试。并且没有弹出无效的参数。

***编辑***：您在进行更改后没有看到它弹出的原因是因为它只会在 60 秒后执行，所以您应该在您之后调用该函数，`setInterval`然后每 60 秒执行一次。

```
var getTimeZones = setInterval(timeZone,60000);
timeZone(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T14:43:40.890

setInterval 函数运行它自己的“回调”，你可以说。语法有点不对劲。试试这个：

```
var getTimeZones = setInterval(function() {
    timeZone();
},60000); 
```

这个语法基本上说，每 60000 毫秒（或 60 秒）在间隔内执行一次函数。在这种情况下，setInterval 函数会调用您的函数。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T14:42:45.370

```
var getTimeZones = setInterval(timeZone,60000); 
```

去掉括号！:)

# ruby-on-rails - 如何使用当前用户创建带有泡菜的模型？

> ID：13495618
> 
> 赞同：0
> 
> 时间：2012-11-21T14:39:37.920
> 
> 标签：ruby-on-rails, ruby, cucumber

我刚刚用这样的工厂女孩​​设置了 Pickle (features/support/pickle.rb)：

```
Pickle.configure do |config|
   config.adapters = [:factory_girl]
   config.map 'I', 'myself', 'me', 'my', :to => 'user: "me"'
end 
```

我现在想开始一个这样的黄瓜场景：

```
Given a journal exists with user: me 
```

这样它就创建了一个以当前用户为 user_id 的日志模型实例，但我收到此错误：

```
Pickle::Session::ModelNotKnownError: The model: 'user: "me"' is not known in this
scenario.  Use #create_model to create, or #find_model to find, and store a reference 
in this scenario. 
```

如何让 Pickle 将“我”与 current_user 匹配？错误消息中的提示没有告诉我如何或在哪里存储它。

nb 我所做的登录步骤已经将当前用户存储在`@me`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T15:01:24.617

没关系 - 我找到了。将此添加到“我已登录”步骤：

```
store_model('user', 'me', @me) # Where @me is the logged in user record 
```

# java - CompilationTask.call() 引入了 ClassNotFoundException。在JDK6中工作，而不是在JDK7中

> ID：13495625
> 
> 赞同：0
> 
> 时间：2012-11-21T14:39:54.597
> 
> 标签：java, java-7, java-compiler-api

从 JDK6 迁移到 JDK7 后，下一个代码失败并出现*ClassNotFoundException*

```
CompilationTask task = cSysCompiler.getTask(null, cFileManager, cDiagnosticCollector, null, null, cUnitsToCompile);
boolean mSuccess = task.call();
Analyzer mAnalyzer = new Analyzer(); // Throws ClassNotFoundException 
```

解决方法：

```
ClassLoader mSystemClassLoader = ClassLoader.getSystemClassLoader();
mSystemClassLoader.loadClass("ft.jopc.com.JavaBytecodeObject");
mSystemClassLoader.loadClass("ft.jopc.com.analyzer.Analyzer");
mSystemClassLoader.loadClass("ft.jopc.opccl.ClassLoaderListener");
…
ompilationTask task = cSysCompiler.getTask(null, cFileManager, cDiagnosticCollector, null, null, cUnitsToCompile);
boolean mSuccess = task.call();
Analyzer mAnalyzer = new Analyzer(); // No ClassNotFoundException 
```

有谁知道为什么在调用 task.call() 类之后找不到了？编译任务似乎以某种方式更改了系统类加载器？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-19T15:38:18.050

我们最近在重新定义 JavaFileManager 的自定义实现时遇到了类似的问题（除其他外）

```
public ClassLoader getClassLoader(final Location location)
{
    return getClass().getClassLoader();
} 
```

不知道为什么这样做，但就像你的情况一样，这在 jdk6 下运行良好。我们将 jdk7 问题归咎于这个函数，部分原因是它在单元测试期间失败（类加载器是 Launcher$AppClassLoader），但在“生产模式”（类由自定义类加载器加载）下工作正常。更改此函数以使用 StandardFileManager 版本，甚至只是将其封装在一个空的 URLClassloader 中，例如

```
return new URLClassLoader(new URL[]{}, getClass().getClassLoader()); 
```

解决了这个问题。

显然它与 URLClassloader 的介绍有关，因此 AppClassLoader 在 jdk7 中是“可关闭的”，如下所示：

```
Thread [main] (Suspended (breakpoint at line 282 in URLClassLoader))    
Launcher$AppClassLoader(URLClassLoader).close() line: 282 [local variables unavailable] 
JavacProcessingEnvironment.close() line: 1257   
JavaCompiler.initProcessAnnotations(Iterable<Processor>) line: 1004 
JavaCompiler.compile(List<JavaFileObject>, List<String>, Iterable<Processor>) line: 821 
Main.compile(String[], String[], Context, List<JavaFileObject>, Iterable<Processor>) line: 439  
JavacTaskImpl.call() line: 132 
```

然后，我必须承认我没有发现关于这个主题的 javadoc 真的很清楚，但是看看 jdk6 DefaultFileManager 以及 jdk7 BaseFileManager，似乎很清楚期望是提供一个临时文件管理器（因此需要关闭“如果可能”）而不是“通用用途”。

（无论如何，我很乐意了解有关该主题的其他/最佳实践参考）

# sql - PostgreSQL 表合并

> ID：13495627
> 
> 赞同：0
> 
> 时间：2012-11-21T14:40:03.457
> 
> 标签：sql, postgresql

例如，我有两个数据表：

网络状态

```
ipaddress       time       violation
192.168.1.1     2:00       yes
192.168.1.6     2:00       no
192.168.1.11    2:00       no
192.168.1.1     3:00       no
192.168.1.6     3:00       no
192.168.1.11    3:00       yes 
```

和

防火墙日志

```
ipaddress       machinetype    location
192.168.1.1     computer       London
192.168.1.6     server         New York
192.168.1.11    server         Bejing 
```

并且我希望将防火墙日志中的数据合并到网络状态表中，因此我将拥有以下内容：

网络状态

```
ipaddress       time       violation       machinetype       location
192.168.1.1     2:00       yes             computer          London
192.168.1.6     2:00       no              server            New York
192.168.1.11    2:00       no              server            Bejing
192.168.1.1     3:00       no              computer          London
192.168.1.6     3:00       no              server            New York
192.168.1.11    3:00       yes             server            Bejing 
```

有没有人有任何想法？我假设会有一个命令通过特定的列值合并表，但经过研究，我只遇到了 join 和 select into 命令。但我不知道如何使用这些来实现我想要的。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T14:49:01.633

您如何看待视图？将两个表与一个选择组合并从中创建一个视图

```
CREATE VIEW myView AS SELECT log.*,status.* FROM log, status 
WHERE log.ipaddress=status.ipaddress 

/* OR */
CREATE VIEW myView AS SELECT log.*,status.* FROM log l
INNER JOIN status s ON l.ipaddress=s.ipaddress 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T15:44:43.763

要“合并”此表，您需要：

1）在“网络状态”表中添加“机器类型”和“位置”列：

```
ALTER TABLE "Network Status"
  ADD COLUMN "machinetype" TEXT;
ALTER TABLE "Network Status"
  ADD COLUMN "location" TEXT; 
```

2）用数据填充它们

```
UPDATE "Network Status" NS
SET "machinetype" = FL."machinetype",
    "location" = FL."location"
FROM "Firewall Log" FL
WHERE FL."ipaddress" = NS."ipaddress" 
```

或者您可以创建一个`VIEW`并将其用于`SELECT`数据，就好像它是一个表一样：

```
CREATE VIEW "Status and log" AS
SELECT NS."ipaddress", NS."time", NS."violation", FL."machinetype", FL."location"
FROM "Network Status" NS
JOIN "Firewall Log" FL ON FL."ipaddress" = NS."ipaddress" 
```

# redirect - 如何将重定向添加到 oscommerce 产品页面

> ID：13495633
> 
> 赞同：-1
> 
> 时间：2012-11-21T14:40:10.277
> 
> 标签：redirect, product, cart, oscommerce

我有一个 oscommerce 购物车网站，我正在尝试设置一个具有 30 秒延时的自动重定向，从一个产品页面到另一个产品页面，并包含一条消息，例如“此产品现在已替换为 [新目录number]。您将被自动重定向。” 如何进入每个产品的原始 HTML/PHP 编码，以便可以放入重定向元标记或 javascript 编码？注意：我只想为少数产品页面（不是网站上当前的所有产品）设置重定向。

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-11-21T14:48:23.353

```
<html>
<head>
<script type="text/javascript">
<!--
function delayer(){
    window.location = "productpage.php"
}
//-->
</script>
</head>
<body onLoad="setTimeout('delayer()', 5000)">
<h2>Prepare to be redirected!</h2>
<p>This page is a time delay redirect, please update your bookmarks to our new 
location!</p>

</body>
</html>​ 
```

你可以使用 Js 重定向看起来像上面

从这里检查 > [http://jsfiddle.net/JnUVF/](http://jsfiddle.net/JnUVF/)

# log4cplus - 如何让 log4cplus 将不同级别记录到文件和标准输出？

> ID：13495640
> 
> 赞同：2
> 
> 时间：2012-11-21T14:40:25.677
> 
> 标签：log4cplus

我想将 TRACE 消息记录到 LogFile 并将 INFO 消息记录到 stdout。我还想将特定记录器“SomeLogger”限制为调试。

我的 log4cplus.properties 文件如下，但我没有将 SomeLogger 消息发送到标准输出。关于如何解决这个问题的任何建议？

```
### log4cplus.properties
# root logger
log4cplus.rootLogger=TRACE, LogFile, stdout

# specific logger
log4cplus.logger.SomeLogger=DEBUG, LogFile
log4cplus.additivity.SomeLogger=false

# appender that automatically rolls files
log4cplus.appender.LogFile=log4cplus::RollingFileAppender
log4cplus.appender.LogFile.File=/home/ken/logs/log4cplus.log
log4cplus.appender.LogFile.Append=true
log4cplus.appender.LogFile.MaxBackupIndex=9
log4cplus.appender.LogFile.MaxFileSize=50MB
log4cplus.appender.LogFile.layout=log4cplus::PatternLayout
log4cplus.appender.LogFile.layout.ConversionPattern=%D{%H:%M:%S %Q} %-4r %-5p T%T |%c{2}| %M.%L %x - %m %n

# Direct log messages to stdout
log4cplus.appender.stdout=log4cplus::ConsoleAppender
log4cplus.appender.stdout.Target=System.out
log4cplus.appender.stdout.Threshold=INFO
log4cplus.appender.stdout.layout=log4cplus::PatternLayout
log4cplus.appender.stdout.layout.ConversionPattern=%D{%H:%M:%S.%q} %-5p %m%n 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-22T13:17:32.937

配置中的行`log4cplus.additivity.SomeLogger=false`意味着登录到的任何内容`SomeLogger`都不会在层次结构中进一步向上传播，即`rootLogger`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-15T15:16:17.040

我现在有机会重新审视这个问题，并看到解决方案是更换

```
log4cplus.logger.SomeLogger=DEBUG, LogFile 
```

和

```
log4cplus.logger.SomeLogger=DEBUG, LogFile, stdout 
```

这条线连同

```
log4cplus.rootLogger=TRACE, LogFile, stdout
log4cplus.appender.stdout.Threshold=INFO 
```

现在会给我：

(1.1) 日志文件中的跟踪消息...

(1.2) ...同时限制 SomeLogger 调试日志文件中的消息，并且

(2) 向控制台发送信息消息。

# javascript - 位置：固定为浮动 div

> ID：13495649
> 
> 赞同：0
> 
> 时间：2012-11-21T14:40:49.080
> 
> 标签：javascript, html, css, position

我有一个 div 漂浮在包装容器中。现在我希望 div 在页面滚动时保持在一个位置。所以我尝试了位置：固定，但这破坏了 div 的其他 css 属性。

我也尝试过使用javascript：

```
$(window).scroll(function () { 
    $("#id").css({'top',$(window).scrollTop() + 'px'});
}); 
```

那个javascript什么也没做。有没有其他方法可以做到这一点，我仍然想保持 float:left 属性不变。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T14:50:20.303

查看所有具有不同位置属性的元素形成不同的层。所以当你保持这个元素'位置：固定'时，你必须调整其他元素

你必须永远为这个 div 保留空白空间，即使你滚动页面，它也会保持固定。

请参阅此链接以更好地理解

[http://davidwalsh.name/demo/css-fixed-position.php](http://davidwalsh.name/demo/css-fixed-position.php)

# mongodb - MongoDB - 复合地理多边形索引

> ID：13495652
> 
> 赞同：1
> 
> 时间：2012-11-21T14:40:54.030
> 
> 标签：mongodb

我有几个类似于以下示例的地理查询。它们不仅是 Poly 查询中的一个点，而且还有其他方面。

询问：

```
{
"point": {
    "$within": {
        "$polygon": [
            [
                41.878335,
                -87.627319999999997
            ],
            [
                41.877602000000003,
                -87.627319999999997
            ],
            [
                41.879672999999997,
                -87.627031000000002
            ],
            [
                41.878723999999998,
                -87.627204000000006
            ],
            [
                41.878507999999997,
                -87.627262000000002
            ],
            [
                41.878335,
                -87.627262000000002
            ]
        ]
    }
},
"MYLISTING": {
    "$in": [
        "All"
    ]
},
"SUPPORT": {
    "$in": [
        "Y"
    ]
},
"TYPE": {
    "$in": [
        "Food"
    ]
}
} 
```

为了帮助使这些更快，我将其他每个项目添加到索引中：

```
{   "v" : 1,
    "key" : {
        "point" : "2d",
        "MYLISTING" : 1,
        "SUPPORT" : 1,
        "TYPE" : 1
    },
    "ns" : "mydb.collection",
    "name" : "point_2d_MYLISTING_1_SUPPORT_1_TYPE_1"
} 
```

然而，在对此进行解释时，它似乎从未使用过这个索引，它只是使用我拥有的另一个索引，它只是最初创建的 point:2d 索引。

我在这里有一些误解吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-22T09:22:07.060

您只能有一个地理索引 - 现在您有两个，其中一个部分是复合索引的一部分。文档中提到了限制：http: [//api.mongodb.org/wiki/current/Geospatial%20Indexing.html#GeospatialIndexing-CreatingtheIndex](http://api.mongodb.org/wiki/current/Geospatial%20Indexing.html#GeospatialIndexing-CreatingtheIndex)

解决方案是简单地删除您在空间字段上的索引：

```
db.yourCollection.dropIndex( { point: '2d' }; 
```

然后，当您使用 explain() 运行查询时，您会看到现在再次使用了哪个索引 - 在这种情况下，应该是复合索引。还要确保地理空间字段是复合索引的第一部分，如下所述：http: [//api.mongodb.org/wiki/current/Geospatial%20Indexing.html#GeospatialIndexing-CompoundIndexes](http://api.mongodb.org/wiki/current/Geospatial%20Indexing.html#GeospatialIndexing-CompoundIndexes)

# visual-studio - 为多个版本的 Visual Studio 开发 Visual Studio 插件

> ID：13495654
> 
> 赞同：5
> 
> 时间：2012-11-21T14:41:00.287
> 
> 标签：visual-studio, visual-studio-addins

我的任务是为 Visual Studio 开发一些扩展供我们内部使用。这些将必须支持几个不同版本的 Visual Studio（VS2008、2010 和 2012 - VS2005 会很好，但不是必需的）。我想以尽可能一致的方式开发这些，尽可能多地重用代码，同时将其适应这些工具的现有项目结构，即 Visual Studio 2012 .sln。

开发这种扩展的最好/最简单的方法是什么？VSPackage 项目？我可以制作一个在 VS2012 中开发的兼容 2008 的 VSPackage 吗？

我目前正在编写的扩展所需的功能非常基本 - 我需要创建工具菜单命令，可能是自定义工具窗口。我的要求可能会在以后发生变化，但目前我不需要编辑器装饰或类似的东西。

我看到[这个](https://stackoverflow.com/questions/1886747/making-an-extension-for-multiple-versions-of-visual-studio)问题似乎是重复的，但被接受的答案并没有回答这个问题，所以......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T17:08:03.397

这实际上取决于您的扩展程序要做什么。

VS2008 不支持扩展（.vsix），您需要为它编写部署为 msi 的 VSPackage。您也将无法访问 VS2010 中引入的许多新功能（更容易的编辑器集成和通过 MEF 访问 vs 服务），但是诸如操作解决方案/项目/文件之类的基本内容应该没问题并且适用于所有版本（例如使用[DTE](http://msdn.microsoft.com/en-us/library/envdte.dte.aspx)应该可以）。

据我记得，对于 VS2008，您还需要[获得 PLK](http://blogs.msdn.com/b/vsxfaq/archive/2008/04/23/how-to-create-a-package-load-key-plk-for-a-vspackage.aspx)，而 2010 和 2012 不再需要它。

我没有尝试在VS2012中开发2008包，但你绝对可以在2012年开发2010扩展。

还要记住 VS2008 是 .Net 3.5，所以你的代码应该使用 .net 3.5 和它支持可移植的 c# 版本。

# c# - Microsoft Sync Framework - 将 SQL 同步到/从硬盘驱动器

> ID：13495656
> 
> 赞同：1
> 
> 时间：2012-11-21T14:41:03.953
> 
> 标签：c#, sql, microsoft-sync-framework

我有一个 C# 应用程序，它使用 Microsoft Sync Framework 通过 Internet 将 SQL Server 数据库从服务器同步到客户端。我需要添加一个新功能，以允许客户端在离线时偶尔通过便携式硬盘进行同步。

这意味着有时客户端会通过互联网与服务器同步，有时客户端会从便携式硬盘驱动器中获取数据。

同步框架是否提供了一种将服​​务器数据库导出到文件，然后将该文件同步到客户端（或类似的东西）的方法？

我无法找到有关该主题的任何可靠文档。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T01:48:58.263

如果您想从便携式硬盘同步，请查看生成 SQL CE 快照（通过 GenerateSnapshot），通过便携式媒体发送 SQL CE 数据库，让您的应用程序将 SQL CE 快照同步到本地数据库。

# java - 我想编辑文本文件中的部分行

> ID：13495657
> 
> 赞同：4
> 
> 时间：2012-11-21T14:41:06.323
> 
> 标签：java, text-files, edit

```
BufferedReader br = null;
BufferedWriter bw = null;
try {
  br = new BufferedReader(new FileReader(oldFileName));
  bw = new BufferedWriter(new FileWriter(tmpFileName));
  String line;
  while ((line = br.readLine()) != null) {
    if (line.contains("Smokey")){
      line = line.replace("Smokey;","AAAAAA;");
      bw.write(line+"\n");
    } else {
      bw.write(line+"\n");
    }
  }
}
catch (Exception e) {
  return;
} finally {
  try {
    if(br != null){
      br.close();
      messagejLabel.setText("Error");
    }
  } catch (IOException e) {
  }
}
// Once everything is complete, delete old file..
File oldFile = new File(oldFileName);
oldFile.delete();

// And rename tmp file's name to old file name
File newFile = new File(tmpFileName);
newFile.renameTo(oldFile); 
```

运行上面的代码时，我最终得到一个空文件“tmpfiles.txt”并且文件“files.txt 正在被删除。谁能帮忙？我不想使用字符串来读取文件。我宁愿按照他的方式去做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T14:55:18.447

快速测试证实，没有像我在上面的评论中写的那样关闭作者实际上会产生你描述的行为。

只需添加

```
if (bw != null) {
  bw.close();
} 
```

到你的`finally`街区，你的程序就可以工作了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T14:58:20.163

我在您的代码中发现了一些问题。

首先，这条线似乎不正确：

```
if (line.contains("Smokey")){
      line = line.replace("Smokey;","AAAAAA;");
      bw.write(line+"\n"); 
```

它应该是：

```
if (line.contains("Smokey;")){
      line = line.replace("Smokey;","AAAAAA;");
      bw.write(line+"\r\n"); 
```

并且，您应该在完成后冲洗并关闭 bw。

```
if (bw != null){
    bw.flush();
    bw.close();
} 
```

如我错了请纠正我。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T14:56:18.937

该文件永远不会被写入，因为写入器从未“刷新”过。关闭写入器时，缓冲区中的所有数据都会自动写入文件。习惯使用流的标准，在 try-catch 块中关闭它们。

# email - 资源插件无法使用 https 正确呈现

> ID：13495665
> 
> 赞同：4
> 
> 时间：2012-11-21T14:41:25.473
> 
> 标签：email, grails

我正在尝试使用 groovyPageRenderer.render() 来渲染带有模型的寺庙，这样我就可以使用 sendMail {} 通过电子邮件发送渲染的 HTML。我们拥有的一些横幅包含图像，我们使用以下方式添加它们：

```
${resource(dir: 'images/email', file: 'background_body.gif', absolute: true)} 
```

这一切都很好，并且在开发中运行良好。但是，我们希望通过 https 运行应用程序，尽管将 grails.serverURL 设置为“https://ourwebsite.com”（如 ApplicationTagLib.groovy 中的 Closure 资源文档所示 [来自 grails-plugin-gsp]） ，它仍然尝试通过http（不可用）将资源呈现为可用，仅通过https。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-28T23:09:30.280

根据来自 Resources 插件源的[评论](https://github.com/grails-plugins/grails-resources/blob/master/grails-app/taglib/org/grails/plugin/resource/ResourceTagLib.groovy#L611)`resource()`，插件的标签似乎没有正确支持 attr `absolute`。如果您运行的是 Grails v2.0 或更高版本，Grails`LinkGenerator`可能是一种解决方法。它被注入为`grailsLinkGenerator`，并且可以这样调用：`grailsLinkGenerator.resource(dir: '...', file: '...', absolute: true)`

# php - Codeigniter LongPolling“while(true)”不起作用？

> ID：13495666
> 
> 赞同：2
> 
> 时间：2012-11-21T14:41:26.620
> 
> 标签：php, javascript, html, codeigniter, long-polling

我目前正在 Codeigniter 中实现长轮询功能，但遇到了问题。

假设我有一个普通的 PHP 控制器：

```
function longpolling()
{
    //PHP Timelimit infinite
    set_time_limit(0);

       while(true){  
                    echo "test";

                   //Sleep 3 Seconds
                     sleep(3);
             }
} 
```

该页面只是在调用时说加载并且不返回“test”，而是在一段时间后得到 404 错误。

我究竟做错了什么？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T14:53:58.667

你没有做任何“错误”的事情，只是 php 没有按照你期望的方式工作。

如果你这样做：

```
$i = 0;
while ($i < 10)
{
    echo "Hi There!";
    sleep(2);
    $i++;
} 
```

它最终会输出很多 Hi There，但不是一次输出一个，而是在 while 循环结束时全部显示。

你甚至可以在那里扔一个flush()

```
$i = 0;
while ($i < 10)
{
    echo "Hi There!";
    flush();
    sleep(2);
    $i++;
} 
```

直到最后你仍然不会得到任何东西。

因为你`while(true)`永远不会结束你永远不会看到任何输出，我假设浏览器超时开始了？还是达到了 max_execution_time 设置？

**现在突然出现在我的脑海**中：如果您在无限循环中将一些数据写入文件，它可能会起作用，我自己从未尝试过。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T15:01:33.593

我自己也遇到过这样的问题。您必须考虑将输出刷新为 php 和/或网络服务器可能正在缓冲数据，直到达到某个阈值。我在 IIS 上为此苦苦挣扎，我认为 Apache 更容易管理。另外还有告诉网络服务器该做什么。对于 apache，这是在[php.net](http://ca3.php.net/manual/en/function.flush.php#85382)上找到的一个片段：

> 我只是在使用flush() 和ob_flush() 时遇到了一些问题。我为解决这个问题所做的工作花了我一些时间来弄清楚，所以我想分享我的想法。
> 
> 主要问题是 php 设置“output_buffering”，它可以设置得太大，会阻止你的文本输出。要更改此值，您可以在 php.ini 中设置它，也可以添加该行
> 
> php_value output_buffering "0"
> 
> 到您的 .htaccess 文件。它不适用于 ini_set()，因为它是 PHP_INI_PERDIR。

这与在 sleep() 之前使用的 flush() 函数相结合。在它开始正确刷新之前，我还必须输出多个字符：

```
 public function longpolling()
    {
        echo str_repeat(" ", 1024); flush();
        for( $i = 0; $i < 10; $i++) {
            echo $i."<br/>";
            flush();
            sleep(1);
        }
    } 
```

还。我只是在我的服务器上尝试了这个，直到我将 php_value 行添加到我的 htaccess 文件中才起作用。一旦我这样做了，它就按预期工作了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T16:45:29.140

该页面将继续加载，直到 PHP 文件执行到达文件末尾。PHP 不像 C 或 C++ 那样工作。你提出一个请求，当一切都完成后，你会得到输出。页面加载后，不再执行 PHP。

并且`sleep()`在某些情况下只是用来减慢 PHP 的速度。在这种情况下：

```
echo "Something";
sleep(30);
echo " else"; 
```

“Something”和“else”将同时打印，而总执行时间将增加 30 秒。

# asp.net - 如何禁用 Visual Studio 2012 以打开 STS 服务器（如本地 STS）？

> ID：13495667
> 
> 赞同：0
> 
> 时间：2012-11-21T14:41:27.127
> 
> 标签：asp.net, visual-studio-2012, wif

我已经使用[这个](http://blogs.msdn.com/b/vbertocci/archive/2012/10/23/windows-identity-foundation-tools-for-visual-studio-2012-rtm.aspx)工具启用了 WIF。当我按 F5 时，它允许我打开本地 STS 服务器。如何禁用此功能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T18:21:46.887

目前我找到的唯一解决方案是从“工具”>“扩展和更新”中禁用此扩展

# php - 两个 for 循环在另一个 break 循环中

> ID：13495669
> 
> 赞同：0
> 
> 时间：2012-11-21T14:41:35.507
> 
> 标签：php, for-loop

我在另一个里面有两个 for 循环，如果我想打破循环

```
$i=1 and $ii < 180 
```

（健康）状况

我在 if 语句中声明但它不起作用，它打印小于 180 $ii 值。

```
for ($i=1;$i<6;$i+=2) {

    for($ii=1;$ii<1733;$ii+=3) { 

        if( $i == 1 && $ii < 180 ){ break; }
        echo '--'.$i.'-'.$ii.'--</br>';

    }

} 
```

如何解决这个问题

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-21T14:43:16.453

# 新答案

```
for ($i=1;$i<6;$i+=2) {
    for($ii=1;$ii<1733;$ii+=3) { 
        if( $i == 1 && $ii < 180 ){ continue; }
        echo '--'.$i.'-'.$ii.'--</br>';
    }
} 
```

# 旧答案

你需要使用：

```
break 2; 
```

因为你打破了2个循环。

更多信息： http: [//php.net/manual/en/control-structures.break.php](http://php.net/manual/en/control-structures.break.php)

# ios - 辅助类中的断言被忽略

> ID：13495671
> 
> 赞同：1
> 
> 时间：2012-11-21T14:41:37.947
> 
> 标签：ios, unit-testing, assert, sentestingkit

我有一个测试用例和一个助手类。在助手类中，我也想使用断言，如下所示：

**MainTests.h**

```
#import <SenTestingKit/SenTestingKit.h>

@interface MainTests : SenTestCase

@end 
```

**MainTests.m**

```
#import "MainTests.h"
#import "HelperClass.h"

@implementation MainTests

- (void)testExample {
    HelperClass *helperClass = [[HelperClass alloc] init];
    [helperClass fail];
}

@end 
```

**助手类.h**

```
#import <SenTestingKit/SenTestingKit.h>

@interface HelperClass : SenTestCase

- (void)fail;

@end 
```

**助手类.m**

```
#import "HelperClass.h"

@implementation HelperClass

- (void)fail {
    STFail(@"This should fail");
}

@end 
```

*旁注：*我必须将帮助类作为子类`SenTestCase`才能访问断言宏。

**辅助类的断言被忽略。任何想法为什么？如何在辅助类中使用断言？**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-22T02:56:03.307

我今天遇到了同样的问题，并想出了一个对我有用的破解方法。戳入`SenTestCase`宏，我注意到他们在助手上调用 [self ...] 但没有触发断言。因此，将源类连接到帮助程序使其对我有用。对问题类的更改如下所示：

**MainTests.h**

```
#import <SenTestingKit/SenTestingKit.h>

@interface MainTests : SenTestCase

@end 
```

**MainTests.m**

```
#import "MainTests.h"
#import "HelperClass.h"

@implementation MainTests

- (void)testExample {
    // Changed init call to pass self to helper
    HelperClass *helperClass = [[HelperClass alloc] initFrom:self];
    [helperClass fail];
}

@end 
```

**助手类.h**

```
#import <SenTestingKit/SenTestingKit.h>

@interface HelperClass : SenTestCase

- (id)initFrom:(SenTestCase *)elsewhere;
- (void)fail;

@property (nonatomic, strong) SenTestCase* from;

@end 
```

**助手类.m**

```
#import "HelperClass.h"

@implementation HelperClass

@synthesize from;

- (id)initFrom:(SenTestCase *)elsewhere
{
    self = [super init];
    if (self) {
        self.from = elsewhere;
    }
    return self;
}

- (void)fail {
    STFail(@"This should fail");
}

// Override failWithException: to use the source test and not self
- (void) failWithException:(NSException *) anException {
    [self.from failWithException:anException];
}

@end 
```

更高级的功能完全有可能需要额外的覆盖，但这对我有用。

# jsf-2 - 使用时配置bean

> ID：13495673
> 
> 赞同：1
> 
> 时间：2012-11-21T14:41:44.803
> 
> 标签：jsf-2, scope, javabeans

我试图在一个 JSF 页面之间传递一个参数，从一个 bean 到另一个。我知道这是一个常见的问题，事实上我在写下来之前已经尝试了几种方法。为此，我将两个 bean 都放在了会话范围内，并在第一个 bean 中添加了以下内容：

```
<p:commandButton value="Submit" type="submit"
    actionListener="#{sourceBean.save}" action="success">

    <f:setPropertyActionListener
            target="#{targetBean.foo}" value="#{sourceBean.foo}" />
</p:commandButton> 
```

问题是我不希望这些 bean 在会话范围内，而是在视图范围内。所以我试着把我的第一页：

```
<p:commandButton value="Submit" type="submit"
    actionListener="#{sourceBean.save}" action="success">
    <f:param name="foo" value="#{sourceBean.foo}"/>                     
</p:commandButton> 
```

在第二页：

```
<f:metadata>
<f:viewParam id="foo" name="foo" value="#{targetBean.foo}"
    />
</f:metadata> 
```

问题是传递的字符串是空的，所以很明显，我从转换器中得到一个错误。

我想我在托管 bean 的配置中遗漏了一些东西。我是否必须以某种方式链接目标和源 bean？此刻我有这样的配置：

```
 <managed-bean>
    <managed-bean-name>targetBean</managed-bean-name>
    <managed-bean-class>guiBeans.TargetBean</managed-bean-class>
    <managed-bean-scope>view</managed-bean-scope>
</managed-bean>
<managed-bean>
    <managed-bean-name>sourceBean</managed-bean-name>
    <managed-bean-class>guiBeans.SourceBean</managed-bean-class>
    <managed-bean-scope>view</managed-bean-scope>
</managed-bean> 
```

另一个问题：在我的应用程序中，我在转换期间使用的值 foo.id 在我保存对象时由数据库自动设置，因此当我调用时：

```
actionListener="#{sourceBean.save}" 
```

转换器获取 id 并将其转换为字符串（如果需要，反之亦然）。所以，我想知道在 JSF 中是首先调用 actionListener 还是设置参数的函数。

这可能是我得到空字符串的原因吗？非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T15:01:58.553

`<f:param>`是在呈现表单期间评估的，而不是在提交表单期间。您的问题表明该`#{sourceBean.foo}`值仅在提交表单期间设置，因此在表单呈现期间不可用。

你*基本上*需要替换`action="success"`为`action="#{bean.action}"`

```
public String action() {
    return "success?foo=" + foo.getId();
} 
```

或者，如果您使用的是导航箱

```
<navigation-case>
    <from-outcome>success</from-outcome>
    <to-view-id>/some.xhtml</to-view-id>
    <redirect>
        <view-param>
            <name>foo</name>
            <value>#{sourceBean.foo.id}</value>
        </view-param>
    </redirect>
</navigation-case> 
```

* * *

**与具体问题**无关，**`<f:param>` [根本不](http://docs.oracle.com/javaee/6/javaserverfaces/2.1/docs/vdldocs/facelets/f/param.html)支持该`converter`属性。您必须直接访问所需的属性（`id`在上面的示例中）。**

# jquery - “this.hide(); 不是函数”调用类中的方法

> ID：13495676
> 
> 赞同：2
> 
> 时间：2012-11-21T14:41:53.103
> 
> 标签：jquery

我有以下代码：

```
var Modal = Class.extend({
    //--- Default options
    defaults: {
        width: 300,
        height: 200
        // . . . more options
    },

    //--- Initialize the Modal class
    init: function (options) {
        //--- Extend defaults and options
        this.options = jQuery.extend(this.defaults, options);
    },

    //--- Create the Modal
    create: function () {

            // . . . code removed

            var closeButton = document.createElement("div");
            jQuery(closeButton)
                .attr({ "class": "modal_close" })
                .css({ "cursor": "pointer" })
                .live("click", function () {
                    this.closeModal();
                })
                .appendTo(modalHead);

            // . . . more code
    },

    //--- Hide the Modal
    closeModal: function () {
        // TODO : Code to hide the modal
        jQuery("#modal_container").fadeOut(200).remove();
        jQuery("#lean_overlay").fadeOut(200).remove();
    }
}); 
```

现在，当我在 create 方法中的 click 事件中尝试调用 delete 方法时，我收到此错误：

```
this.closeModal(); is not a function 
```

我在这里想念什么？

**编辑：**将隐藏功能更改为 closeModal 只是为了简化我的问题

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-21T14:44:49.827

替换`this.hide();`为`$(this).hide();`

后期编辑：

`this`输入前保留参考`.live()`

```
create: function () {
        // . . . code removed

        var closeButton = document.createElement("div");
        var myModal = this; 
        jQuery(closeButton)
            .attr({ "class": "modal_close" })
            .css({ "cursor": "pointer" })
            .live("click", function () {
                myModal.closeModal();
            })
            .appendTo(modalHead);

        // . . . more code
}, 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T14:48:15.043

此问题源于 jQuery 已将引发事件的 DOM 元素绑定到`this`. 要解决这个问题，只需使用以下

```
.live('click', this.closeModal) 
```

如果要缓存对`Modal`in 的当前实例的引用，`init` `function`可以执行以下操作：

```
init: function () {
    this.me = this;
} 
```

引用它时只记得使用`this.me`（不仅仅是`me`）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T14:52:48.707

尝试：

```
.live('click', $.proxy(this, 'hide')) 
```

# c++ - 由于 while 循环导致的分段错误错误

> ID：13495678
> 
> 赞同：0
> 
> 时间：2012-11-21T14:42:02.763
> 
> 标签：c++

我正在实现一个小型搜索引擎。信息取自一个文件并返回所有包含该单词的搜索。问题是当我在 while 循环中运行搜索功能时，出现分段错误错误但是当我运行它时没有while循环，它运行顺利..我已经重新检查了很多次代码，但找不到任何问题。任何帮助将不胜感激。

```
 //searches individual words which are given to it.array has some data in it
int search_word(string word,string array)
{
    int counter=0;
    size_t found;
    int i=0;
    for (i=array.find(word,0);i!=string::npos;i=array.find(word,i))
    {
       counter+=1;
       i++;
    }
   return counter;
}

//this is sorting(descending) the linked list of results and storing it in an array
void Rank()
{
   struct results *go;
   go=head;
   int array[54];
   int l=0;
   while (go->next!=0)
   {
       array[l]=go->number;
       array1[l]=go->result;
       go=go->next;
       ++l;
   }
   array[l]=go->number;
   array1[l]=go->result;
   int temp;
   string temp1;
   for (int k=0;k<l;k++)
   {
       for (int j=(k+1);j<l+1;j++)
       {
          if (array[k]<array[j])
          {
             temp=array[k];
             array[k]=array[j];
             array[j]=temp;
             temp1=array1[k];
             array1[k]=array1[j];
             array1[j]=temp1;
          }
        }                  
    }
    cout<<"Following results were found"<<endl;
    for (int a=0;a<l;++a)
    {
       cout<<"Result no."<<a<<endl;
       cout<<array1[a]<<endl;
       cout<<endl;
    }
 }

 //main search function                
 void search(string array[])
 {
    //words like the,a,he,they,would are low rank words
   ifstream fin;
   fin.open("lowRank.txt");
   string lowrank;
   int j=0;
   while (!fin.eof())
   {
       string buffer;
       do
       {
           getline(fin,buffer);
           lowrank+=" ";
           lowrank+=buffer;
           ++j;
       }
       while (!buffer.empty());
   }
   fin.close();
   cout<<"Enter a word or phrase"<<endl;
   //converting the string containing words into seperate strings by tockenisation
   string setofwords[10];
   char phrase[50];
   cin.get(phrase,50);
   int count=0;
   char *pointer= NULL;
   pointer=strtok(phrase," ");
   while (pointer!=NULL)
   {
       char *pointer= NULL;  
       setofwords[count]=pointer;    
       pointer=strtok(NULL," ");
       count+=1; 
       delete [] pointer;
   }      

   for (int i=0;i<54;i++)
   {
       int counter=0;int counter1=0;
       //searching for all words one by one in the below loop       
       for (int k=0;k<count;k++)    
       {         
          //searching if word is low rank
           size_t found;
           found=lowrank.find(setofwords[k]);                 
           if (found!=string::npos)
           {
               counter=search_word(setofwords[k],array[i]);
               if (counter>0)
               {                    
                   counter1+=1;
               }
           }
           else
           {                                        
               counter=search_word(setofwords[k],array[i]);
               counter1+=counter;                   
           }        
        } 
     if (counter1>0)
     {
         add_result(array[i],counter1);
     }
   }
   Rank();
 }

int main()
{
  //reading the data file and copying it into an a linked list 
   ifstream fin;
   fin.open("data.txt");
    while (!fin.eof())
    {      
        string url;
        string data;
        getline(fin,url);
        string buffer;
       do
       {
            getline(fin,buffer);           
            if (!buffer.empty())
            {
               data=buffer;
            }
       }
       while (!buffer.empty());
       add_node(url,data);
   }
  //copying linked list to an array
  string array[54];
  node *conductor;
  conductor=root;
  for (int i=0;i<54;i++)
  {
      array[i]=conductor->url+conductor->data;
      conductor=conductor->next;
  }                   

  fin.close();

  while (1)
  {              

         cout<<"*******************************SEARCH                                  
         ENGINE********************************"<<endl;
        cout<<endl;
        cout<<endl;
        cout<<endl;
        cout<<"1.Press 1 to search a word."<<endl;
      cout<<"5.Press 5 to quit without saving search results"<<endl;

     int ans; 

      cin>>ans;     
      if (ans==1)
      {     
          search(array);
          search(array);
      }

      else if (ans==5)
      {
          quit_without_saving();
      }
      }

system("PAUSE");
return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T14:55:27.927

您的错误出现在以下代码行中：

```
char phrase[50];
cin.get(phrase,50);
int count=0;
char *pointer= NULL;
pointer=strtok(phrase," ");
while (pointer!=NULL)
{
   char *pointer= NULL;  
   setofwords[count]=pointer;    
   pointer=strtok(NULL," ");
   count+=1; 
   delete [] pointer;
} 
```

`strtok`实际上返回一个指向你传入的字符的指针，在这种情况下是`phrase`.

`phrase`在堆栈上创建。

因此你不能调用`delete[]`它。顺便说一句，您也不能`delete[]`在分配块的中间调用，它必须正是从`new[]`调用返回的指针。

顺便说一句，如果您需要更改代码以便`phrase`需要在运行时知道其大小，请不要使用`new[]`而是将短语转换为`std::vector<char>`，您可以使用`&phrase[0]`它来获取其第一个元素。再次，无需调用`delete[]`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-21T14:46:03.177

分段错误可能是由于`delete []`调用未返回的指针上的使用`new[]`：发布的代码中没有关键字的单个实例`new`，但有一个实例`delete`。

# android - 如何在 Android 中设置 String[] 的文本视图？

> ID：13495679
> 
> 赞同：3
> 
> 时间：2012-11-21T14:42:02.057
> 
> 标签：android, string, textview

我是Android的学习者。如果单击按钮，我想`String[]={"Rubin","Android","Steve"}`在 textview 中显示。

我收到空指针异常`onClick`

代码：

```
 TextView tv;
Button b1;
    String question[]={"Rubin","Android","Steve"};

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.ques);
    tv = (TextView) findViewById(R.id.button1);
    b1 = (Button) findViewById(R.id.startExam);
    b1.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {
            // TODO Auto-generated method stub
            tv.setText(question[0]);
        }
    });
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T14:46:22.220

这是错误

```
tv = (TextView) findViewById(R.id.button1); 
```

在 TextView 中，您正在分配命令按钮的 id。请检查您的 ques.xml 并查看您为 TextView 分配的 ID。在 Activity 中分配该 ID，您的问题就解决了。

# caching - 通过消息传递的 Terracotta L2 缓存失效

> ID：13495682
> 
> 赞同：0
> 
> 时间：2012-11-21T14:42:17.693
> 
> 标签：caching, terracotta, invalidation

我正在尝试使用 ehcache 评估 Terracotta 分布式缓存。我有以下查询。有 20 多个应用程序将使用 TAS 分布式缓存。据我了解，这些应用程序中的每一个都将有一个 L1 缓存，而集群中将有一个 L2 缓存。集群缓存数据面向数据库，该数据库将由我们无权访问的不同应用程序更新。所以我们只从这个数据库中读取。但是数据库更新需要流向缓存。

通过数据库触发器的方式，更新的（仅键）存储在临时表中。在特定的时间间隔内，作业会监视此表并收集缓存中需要过期的键。这是一个单独的批处理作业。

从这里我需要帮助。如何通知 TAS L2 缓存过期/驱逐这些密钥？兵马俑有哪些选择？此到期事件是否会从 L2 流向所有单个应用程序？时差是多少？我不想将到期密钥发送到所有单个应用程序。这可以实现吗？

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T13:26:01.633

也许我遗漏了一些东西，但我不确定你为什么要让这些密钥过期/驱逐，而不是简单地调用 cache.removeAll(keys)。此删除将自动传播到在其本地缓存中具有这些条目的所有 L1 节点。

时间延迟取决于分布式缓存的一致性设置。

# wordpress - Wordpress - 将 index.php 用于帖子和自定义帖子类型

> ID：13495685
> 
> 赞同：0
> 
> 时间：2012-11-21T14:42:30.907
> 
> 标签：wordpress, loops, post

我需要将 index.php 文件用于我的标准 wordpress 新闻，但也用于自定义帖子类型。

在我的 index.php 文件中，我使用没有参数或参数的标准循环。

我正在尝试使其与“pre_get_posts”操作一起使用。我一直在尝试更改查询帖子类型，但仍然无法正常工作。

```
$query->set('post_type', 'any') 
```

所以我需要一种方法让 /dossiers/ 使用 index.php，这意味着当在 url 中检测到 /dossiers/ 时，我需要更改循环的查询。

非常感谢！

编辑：

这是我用“pre_get_post”调用的函数：

```
function custom_post_types( $query ) { 
    if( $query->is_main_query() && $query->query['name'] == 'dossiers' ) {
        $query->set('post_type', 'any');

        var_dump($query);
    }   
} 
```

这是 $query 的 var_dump：

```
object(WP_Query)#100 (42) {
  ["query"]=>
  array(2) {
  ["page"]=>
  string(0) ""
  ["name"]=>
  string(8) "dossiers"
}
["query_vars"]=>
array(46) {
  ["page"]=>
  string(0) ""
  ["name"]=>
  string(8) "dossiers"
  ["error"]=>
  string(0) ""
  ["m"]=>
  int(0)
  ["p"]=>
  int(0)
  ["post_parent"]=>
  string(0) ""
  ["subpost"]=>
  string(0) ""
  ["subpost_id"]=>
  string(0) ""
  ["attachment"]=>
  string(0) ""
  ["attachment_id"]=>
  int(0)
  ["static"]=>
  string(0) ""
  ["pagename"]=>
  string(0) ""
  ["page_id"]=>
  int(0)
  ["second"]=>
  string(0) ""
  ["minute"]=>
  string(0) ""
  ["hour"]=>
  string(0) ""
  ["day"]=>
  int(0)
  ["monthnum"]=>
  int(0)
  ["year"]=>
  int(0)
  ["w"]=>
  int(0)
  ["category_name"]=>
  string(0) ""
  ["tag"]=>
  string(0) ""
  ["cat"]=>
  string(0) ""
  ["tag_id"]=>
  string(0) ""
  ["author_name"]=>
  string(0) ""
  ["feed"]=>
  string(0) ""
  ["tb"]=>
  string(0) ""
  ["paged"]=>
  int(0)
  ["comments_popup"]=>
  string(0) ""
  ["meta_key"]=>
  string(0) ""
  ["meta_value"]=>
  string(0) ""
  ["preview"]=>
  string(0) ""
  ["s"]=>
  string(0) ""
  ["sentence"]=>
  string(0) ""
  ["fields"]=>
  string(0) ""
  ["category__in"]=>
    array(0) {
  }
  ["category__not_in"]=>
    array(0) {
  }
  ["category__and"]=>
    array(0) {
  }
  ["post__in"]=>
    array(0) {
  }
  ["post__not_in"]=>
    array(0) {
  }
  ["tag__in"]=>
    array(0) {
  }
  ["tag__not_in"]=>
    array(0) {
  }
  ["tag__and"]=>
    array(0) {
  }
  ["tag_slug__in"]=>
    array(0) {
  }
  ["tag_slug__and"]=>
    array(0) {
  }
  ["post_type"]=>
    string(3) "any"
}
  ["tax_query"]=>
  NULL
  ["meta_query"]=>
  bool(false)
  ["post_count"]=>
  int(0)
  ["current_post"]=>
  int(-1)
  ["in_the_loop"]=>
  bool(false)
  ["comment_count"]=>
  int(0)
  ["current_comment"]=>
  int(-1)
  ["found_posts"]=>
  int(0)
  ["max_num_pages"]=>
  int(0)
  ["max_num_comment_pages"]=>
  int(0)
  ["is_single"]=>
  bool(true)
  ["is_preview"]=>
  bool(false)
  ["is_page"]=>
  bool(false)
  ["is_archive"]=>
  bool(false)
  ["is_date"]=>
  bool(false)
  ["is_year"]=>
  bool(false)
  ["is_month"]=>
  bool(false)
  ["is_day"]=>
  bool(false)
  ["is_time"]=>
  bool(false)
  ["is_author"]=>
  bool(false)
  ["is_category"]=>
  bool(false)
  ["is_tag"]=>
  bool(false)
  ["is_tax"]=>
  bool(false)
  ["is_search"]=>
  bool(false)
  ["is_feed"]=>
  bool(false)
  ["is_comment_feed"]=>
  bool(false)
  ["is_trackback"]=>
  bool(false)
  ["is_home"]=>
  bool(false)
  ["is_404"]=>
  bool(false)
  ["is_comments_popup"]=>
  bool(false)
  ["is_paged"]=>
  bool(false)
  ["is_admin"]=>
  bool(false)
  ["is_attachment"]=>
  bool(false)
  ["is_singular"]=>
  bool(true)
  ["is_robots"]=>
  bool(false)
  ["is_posts_page"]=>
  bool(false)
  ["is_post_type_archive"]=>
  bool(false)
  ["query_vars_hash"]=>
  string(32) "3cd80adcb57d626df6535f6dafb98057"
  ["query_vars_changed"]=>
  bool(false)
  ["thumbnails_cached"]=>
  bool(false)
} 
```

“name”的值设置为“dossiers”，这应该是帖子名称的 slug，如果我将其设置为“”，我会使用我最后一个自定义帖子类型重定向到 single.php。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T15:06:17.937

我怀疑您的条件没有与`$query`对象正确交互。

尝试：

```
if( $query->is_main_query() && $query->query_vars['name'] == 'dossiers' ) 
```

如果这不起作用，也许这会起作用：

```
$query_var_name = get_query_var('name');
if( $query->is_main_query() && $query_var_name == 'dossiers' ) 
```

此外，添加某种测试以确保您的 index.php 实际上是 Wordpress 在您访问 /dossiers 时使用的模板文件

# android - Android 应用程序中的可自定义输入字段

> ID：13495691
> 
> 赞同：1
> 
> 时间：2012-11-21T14:42:51.000
> 
> 标签：android, runtime, customizing

我正在为我的大学开展一个关于在运行时自定义 Android 应用程序的项目。

是否可以包含实际上不在我的 android 项目的 \res\layout\ 文件夹中但在外部网络服务器上的布局 XML 文件？这背后的想法是让我有机会在我的网络服务器上自定义 xml 文件，例如添加新字段，而无需重新安装/更新应用程序。

我将尝试通过以下示例来解释我的想法：

假设我有一个应用程序来保存和显示地址。所有地址都存储在数据库中。我在我的数据库中获得了“姓名”和“姓氏”字段，并在保存或显示地址时显示在应用程序中。

现在我想添加第三个字段“电子邮件”，我可以在其中输入电子邮件地址。

我的想法是在我的数据库中创建这个字段并将其添加到我的 web 服务器上的 layout-xml-file 中。所以我可以“链接”应用程序中的 xml 文件，刷新应用程序后会出现新字段。

希望你们能给我一些关于如何在运行时自定义我的输入表单的信息，我在互联网上的研究根本没有帮助我..

格雷茨

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T15:11:14.417

您不能使用外部 XML 文件来动态调整布局。

的文档[`LayoutInflater#inflate(XmlPullParser, ViewGroup)`](http://developer.android.com/reference/android/view/LayoutInflater.html#inflate%28org.xmlpull.v1.XmlPullParser,%20android.view.ViewGroup%29)解释了原因：

> **重要** 出于性能原因，视图膨胀在很大程度上依赖于在构建时完成的 XML 文件的预处理。因此，目前无法在运行时在纯 XML 文件上使用带有 XmlPullParser 的 LayoutInflater。

但是您可以在代码中动态创建布局，请参阅例如[Android 运行时布局教程](https://stackoverflow.com/questions/2693744/android-runtime-layout-tutorial)

因此，您可以在服务器上放置一个包含布局信息的文件，在您的应用程序中获取它，解析它并动态创建布局。这将是很多工作，因为您基本上会复制 Android 的`LayoutInflater`. 您显然可以将格式简化为您需要的基础知识，但恕我直言，仍然需要做很多工作。

假设您的布局信息只是一个具有字段名称的纯文本文件

```
name
surname
email 
```

然后，您可以逐行阅读并`EditText`以如下方式为每个内容创建一个简单的

```
private View getDynamicLayout(ArrayList<String> lines) {
    LinearLayout ll = new LinearLayout(this);
    for (String line : lines) {
        EditText et = new EditText(this);
        // fill it with some text
        et.setText(line);
        ll.addView(ll);
    }
    return ll;
}

protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    ArrayList<String> layoutConfig = readConfigFromFile();
    View layout = getDynamicLayout(layoutConfig);
    setContentView(layout);
} 
```

但除非您真的需要，否则我建议您以常规方式更新应用程序。使用预处理布局而不是自己构建该信息也更快。

还要注意不要像上面的例子那样在 UI 线程中进行大量磁盘/任何网络访问（读取文件）。这应该在后台任务中完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T09:54:03.277

非常感谢你的帮助。我会努力解决这个问题。

我不能只更新应用程序的原因是我所说的应用程序实际上是许多不同公司使用的 CRM 系统。他们都必须从 google play 商店下载相同的应用程序。

我的工作目标是每个公司都可以自定义他们自己的输入表单，因此可能有许多不同的输入表单（每个公司都适用）但都使用相同的应用程序。

我想到了一个服务器，它存储一个包含布局信息的文件，应用程序可以在运行时访问该文件。

顺便说一句，由于我不是软件工程师，所以我不必编写任何代码，我只需要以抽象的方式描述这个概念.. :)

# java - JPA Merge 和 Remove 不会同时级联到子对象

> ID：13495695
> 
> 赞同：2
> 
> 时间：2012-11-21T14:43:10.540
> 
> 标签：java, jpa, orm, persistence, openjpa

我在商业项目中使用 Open JPA，并希望利用级联的 Parent->Child 删除和合并。

我模拟了一个显示问题的工作代码。

我有一个带有一些孩子的持久父对象。我正在消除其中一个孩子的关系并将分离的父母传递给合并。提交事务时，会发出 UPDATE 语句，尝试使用 NULL 外键更新孤儿。

```
@Entity
public class Parent implements Serializable {
    @Id @GeneratedValue(strategy=GenerationType.IDENTITY)
    private Integer id;
        private String desc;
    //@ElementDependent
    @OneToMany(mappedBy="parent", 
        cascade={CascadeType.PERSIST, CascadeType.MERGE, CascadeType.REMOVE}/*,orphanRemoval=true, fetch=FetchType.EAGER*/)
        private List<Child> childs = new ArrayList<Child>();

@Entity
public class Child implements Serializable {
    @Id private String desc;

    @ManyToOne
    private Parent parent;

    public class StackOverflowTest extends TestCase {
        private EntityManager em;
        private static EntityManagerFactory factory = Persistence.createEntityManagerFactory("SSICTest", System.getProperties());
        private Parent p;
        private Child c;
        private Child c2;

        public void testRemove() {
            prepareObjects();

            startTr();
            em.persist(p);
            commitTr();

            startTr();
            p = em.find(Parent.class, p.getId());
            em.remove(p);
            commitTr();
        }   
        public void testMerge() {
            prepareObjects();

            startTr();
            em.persist(p);
            commitTr();

            //remove on detached
            Child child = p.getChilds().get(0);
            p.getChilds().remove(child);
            child.setParent(null);
            startTr();

            em.merge(p);
            commitTr();

            startTr();
            p = em.find(Parent.class, p.getId());
            assertEquals(1, p.getChilds().size());
            commitTr();
        }
        protected void prepareObjects() {
            p = new Parent();       
            c = new Child();
            c2 = new Child();
            p.setDesc("desc");
            c.setDesc(Math.random()+"");
            c2.setDesc(Math.random()+"");
            p.getChilds().add(c);
            c.setParent(p);
            p.getChilds().add(c2);
            c2.setParent(p);
        }   
        void commitTr() {
            em.getTransaction().commit();
            em.close();
        }
        void startTr() {
            em = factory.createEntityManager();
            em.getTransaction().begin();
        }
    } 
```

在上面的示例中，testRemove 工作正常，但 testMerge 方法不行，正如我在顶部所描述的那样。

如果我删除对 @ElementDependent 的评论，它的工作方式会有所不同。

testRemove 失败，因为 remove 没有级联到 Child 和 db 抛出的引用完整性异常，并且 testMerge 很好。

orphanRemoval=true, fetch=FetchType.EAGER 或 @ForeignKey(deleteAction=ForeignKeyAction.CASCADE) 对孩子的反比关系也无济于事。

请指教。我真的很感谢你的帮助！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-24T08:48:44.713

```
 @OneToMany(mappedBy="parent", 
    cascade={CascadeType.PERSIST, CascadeType.MERGE, CascadeType.REMOVE},
    orphanRemoval=true, fetch=FetchType.EAGER)
 private List<Child> childs = new ArrayList<Child>();

 @ManyToOne
 private Parent parent; 
```

将 orphanRemoval 设置为 true。[查看 orphanRemoval 的目的](http://docs.oracle.com/cd/E19798-01/821-1841/giqxy/index.html)

# c# - json.NET 中的序列化不起作用

> ID：13495710
> 
> 赞同：-1
> 
> 时间：2012-11-21T14:43:58.593
> 
> 标签：c#, .net, json, serialization

```
JsonSerializer serializer = new JsonSerializer();
jw.WritePropertyName("info"); 
serializer.Serialize(jw, res);
if (res[2] == true)
{
    jw.WritePropertyName("healer"); jw.WriteStartObject();
    jw.WritePropertyName("running"); 
    jw.WriteValue(res[1] == true ? (checkBox1.IsChecked == true ? true : false) : false);
    jw.WritePropertyName("main"); jw.WriteStartObject();
    serializer.Serialize(jw, new bool[] { true, true, true, true, true, true });
    jw.WriteEndObject(); // here
    jw.WriteEndObject();
} 
```

有人可以告诉我为什么这段代码不起作用吗？没有线`serializer.Serialize(jw, new bool[] {...}});`一切正常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T15:03:15.207

异常的原因是您告诉 writer 您将编写一个对象并且您正在编写一个数组。试试这样：

```
jw.WritePropertyName("healer");
jw.WriteStartObject();
jw.WritePropertyName("running"); 
jw.WriteValue(res[1] == true ? (checkBox1.IsChecked == true ? true : false) : false);
jw.WritePropertyName("main");
serializer.Serialize(jw, new bool[] { true, true, true, true, true, true });
jw.WriteEndObject(); 
```

或者作为这样的替代方案：

```
jw.WritePropertyName("healer");
jw.WriteStartObject();
jw.WritePropertyName("running"); 
jw.WriteValue(res[1] == true ? (checkBox1.IsChecked == true ? true : false) : false);
jw.WritePropertyName("main");
var myArray = new bool[] { true, true, true, true, true, true };
jw.WriteStartArray();
foreach (bool myValue in myArray)
{
    jw.WriteValue(myValue);
}
jw.WriteEndArray();
jw.WriteEndObject(); 
```

# java - 没有从数组中获取正确的值

> ID：13495714
> 
> 赞同：0
> 
> 时间：2012-11-21T14:44:07.537
> 
> 标签：java, android, arrays, arraylist, settext

我想定义一个包含一堆字符串的数组。

然后我希望能够引用数组中的不同字符串。听起来很简单，但使用以下代码，我将返回变量 onOneClick 的“成为”（即数组中的第二个字符串）（它应该指的是第一个字符串或“暗示”。

有任何想法吗？

```
String hintsList[] = {"to implicate", "to be", "to bite", "to draw", "to run", "to go", "to escape", "to fall", "to accept", "to open", "to laugh", "to listen", "to open", "to dance", "to use", "to save (not waste)", "to create"};

final String onOneClick = hintsList[1];
final EditText box0101 = (EditText)findViewById(R.id.box0101);

        box0101.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {
            txtHint.setText(onOneClick);                
        }
    }); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-21T14:45:22.910

数组从零开始索引。如果您想要第一个元素，请使用`hintsList[0]`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T14:46:00.400

Java 中的数组是从零开始的。你应该使用`final String onOneClick = hintsList[0];`.

# ruby-on-rails - Ruby 的 EXIFR gem 中的纬度/经度不工作

> ID：13495719
> 
> 赞同：0
> 
> 时间：2012-11-21T14:44:27.153
> 
> 标签：ruby-on-rails, rubygems, latitude-longitude, exif

我正在尝试使用 exifr gem 来读取 lat/long 以进行图像上传。

在模型中：

```
attr_accessible :image, :post_process_photo, :width, :height, :model, :datetime, :latitude, :longitude

belongs_to :user

  has_attached_file :image, styles: { medium: "300x300#", thumb: "50x50#", large:"500x500#" }

  after_post_process  :post_process_photo 

    def post_process_photo
      imgfile = EXIFR::JPEG.new(image.queued_for_write[:original].path)
      return unless imgfile

      self.width         = imgfile.width             
      self.height        = imgfile.height            
      self.model         = imgfile.model             
      self.datetime      = imgfile.date_time    
      self.latitude      = imgfile.gps.latitude  
      self.longitude     = imgfile.gps.longitude  

       end 
```

在视图中......宽度/高度的东西正在工作，但纬度/经度不是：

```
<%= @pic.width  %>  #this works!

<%= @pic.height  %> #this works!

<%= @pic.latitude  %> #this doesn't!

<%= @pic.longitude  %> #this doesn't! 
```

...这很奇怪，因为它完全按照[gem docs](https://github.com/remvee/exifr/)中的说明进行标记。

还向数据库添加了适当的迁移，这些迁移应该出现在架构上。

视图呈现`undefined method`纬度'`

非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T05:12:26.330

我认为您想要 imgfile.gps_latitude 和 imgfile.gps_longitude - 下划线而不是点

# ruby-on-rails - 当通过不匹配的 ETag 或更早的修改日期时，Varnish 是否应该命中？

> ID：13495733
> 
> 赞同：1
> 
> 时间：2012-11-21T14:45:16.637
> 
> 标签：ruby-on-rails, http, caching, reverse-proxy, varnish

我们目前正在编写一个 Varnish 实现，看看它是否适合放在我们的 Rails 应用程序前面。

我们希望 Varnish 缓存 API 调用的结果，并且仅在客户端的 ETag 与 Varnish 中存储的不匹配或客户端的修改日期早于 Varnish 的日期时才访问应用程序。

到目前为止，我还没有看到 Varnish 将这些值考虑在内。

当辅助请求在最大期限内时，我们只会获得缓存命中。

这是预期的行为吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T13:58:14.990

这是预期的行为，Varnish 当前不会重新验证缓存的内容。

有一些实验性的工作可以做你想做的事，这可能会也可能不会在 Varnish 4.0 中结束（几个月后）。

与此同时，您可以做的是人为设置一个较短的 TTL，并设置一个`grace`与您想要的 TTL 相等的时间。使用该配置，当请求进入 Varnish 时，会向后端发送一个 IMS 请求（当然，只要缓存的条目有一个 ETag，否则它将是一个普通请求）。

副作用是，如果后端关闭或返回 500，Varnish 也会发送缓存条目——这可能是也可能不是你想要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-21T17:01:57.423

我所做的是将 hash() 函数设置为使用提供的 etag。

这意味着对对象的第一个请求（客户端未提供 etag）将获取对象本身。

任何后续请求，或任何为 etag 提供标头的请求，都将获得一个对象或 304。

# c# - 验证领域是否足够安全？

> ID：13495741
> 
> 赞同：1
> 
> 时间：2012-11-21T14:45:41.670
> 
> 标签：c#, .net, openid, dotnetopenauth

我正在为 SSO 设置开发 OpenId 提供程序 - 它基本上是一个 Web 应用程序门户，与用户有权访问的任何“应用程序”共享凭据。我设置了提供程序，一切正常，但我有一个关于安全性的问题。

我想在 Provider 向 RP 发送肯定断言之前对其进行一些权限检查；即用户实际上对发出请求的应用程序具有权限。

这是我目前得到的 Provider 代码（只是一个片段，如果需要可以添加更多）：

```
private bool AutoRespondIfPossible(out ActionResult response)
    {
        if (ProviderEndpoint.PendingRequest.IsReturnUrlDiscoverable(OpenIdProvider.Channel.WebRequestHandler) == RelyingPartyDiscoveryResult.Success
            && User.Identity.IsAuthenticated && this.RealmIsValid(ProviderEndpoint.PendingAuthenticationRequest.Realm)) {
                if (ProviderEndpoint.PendingAuthenticationRequest != null) {
                    if (ProviderEndpoint.PendingAuthenticationRequest.IsDirectedIdentity
                        || this.UserControlsIdentifier(ProviderEndpoint.PendingAuthenticationRequest)) {
                            ProviderEndpoint.PendingAuthenticationRequest.IsAuthenticated = true;
                            response = this.SendAssertion();
                            return true;
                    }
                }

                //we don't want anon requests
                if (ProviderEndpoint.PendingAnonymousRequest != null) {
                    ProviderEndpoint.PendingAnonymousRequest.IsApproved = false;
                    response = this.SendAssertion();
                    return true;
                }
        }

        response = null;
        return false;
    } 
```

基本上我正在做的是验证请求的领域（在`RealmIsValid`方法中）与我的可接受主机名列表中的主机名匹配，然后我根据主机名比较用户权限。

我想知道的是：准确度如何`ProviderEndpoint.PendingAuthenticationRequest.Realm`？如果我理解正确，领域是由依赖方设置的 - 端点是否有可能从该请求中指定的领域以外的 URI 接收请求？或者我可以安全地假设领域**总是**准确的（即：匹配依赖方的 URI）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T02:10:51.957

是的，OpenID 领域是可靠的，因为 OpenID 2.0 和 DotNetOpenAuth 采取了两个步骤：

1.  OpenID return_to URL 必须是领域 URL 的派生。因此，尽管任何人都可以制定 OpenID 请求，就好像它来自任何依赖方一样，但所谓的依赖方将始终是实际接收响应的一方，因此操作另一个 RP 的攻击者将无法获得响应。
2.  一些“开放重定向器”攻击可能允许攻击者使用基于合法 Realm URL 的 return_to URI，但恰好是重定向到攻击者网站的 URL，从而将断言传递给攻击者。`IsReturnUrlDiscoverable`这可以通过“RP Discovery”得到缓解，您的代码片段在调用该方法时包含该“RP Discovery” 。RP 应在其 RP Discovery XRDS 文档中明确列出允许的 return_to URL，以便不允许打开的重定向器端点。

话虽如此，OpenID 主要是关于识别用户——而不是授权他们使用特定的 RP。因此，虽然您正在做的事情*可能*很好，但对于 OpenID 的使用来说，它有点偏离常规，所以请仔细考虑安全隐患（就像您现在正在做的那样）。

# wpf - 应用程序启动时出现随机 InvalidOperationException

> ID：13495743
> 
> 赞同：1
> 
> 时间：2012-11-21T14:45:52.423
> 
> 标签：wpf, startup, appdomain

我不时在生产机器上的应用程序启动时遇到问题。并非每次应用程序启动时都会发生这种情况，显然它只会在重新启动时发生。应用程序从登录开始，添加到 HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run。

显然，重置机器时问题比重新启动时更频繁。应用程序崩溃后手动启动应用程序成功。

启动过程中会抛出以下异常：

> 'System.Windows.Controls.TextBlock' 的初始化引发了异常。System.Windows.Markup.XamlParseException：“System.Windows.Controls.TextBlock”的初始化引发了异常。---> System.InvalidOperationException：调用线程无法访问此对象，因为不同的线程拥有它。在 System.Windows.Threading.Dispatcher.VerifyAccess() 在 System.Windows.Style.Seal() 在 System.Windows.StyleHelper.UpdateStyleCache(FrameworkElement fe,FrameworkContentElement fce, Style oldStyle, Style newStyle, Style& styleCache) 在 System.Windows .FrameworkElement.OnStyleChanged(DependencyObject d, DependencyPropertyChangedEventArgs e) 在 System.Windows.DependencyObject.OnPropertyChanged(DependencyPropertyChangedEventArgs e) 在 System.Windows.FrameworkElement。 **在 Exception.Occurs.At.Different.Origins.Between.Startup()**

从 StackTrace 中可以看出，更新样式缓存时发生了一些事情。我无法在我自己的电脑上重现这个。启动应用程序时这里不涉及线程，但有几个 AppDomain。异常的来源并不总是相同的，但是从 Application.LoadComponent(Object component, Uri resourceLocator) 来看是完全一样的

因为我们的应用程序需要根据操作系统从与可执行文件 (..\ProgramData....) 不同的位置找到配置文件，所以我们使用单独的 AppDomain 来指示它在哪里查找配置文件，因为我们找不到更好的解决方案来告诉 ConfigurationManager 在哪里查找文件。当然，它可能与此有关，但不一定。编辑： ConfigurationManager.OpenMappedExeConfiguration 似乎不起作用，因为它不会刷新通过 Properties.Settings.Default 等访问的任何用户或应用程序设置。

有没有人对如何处理这个问题有任何建议或建议？抱歉，我无法为您提供重现的样本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T18:21:07.553

该异常是因为您正在从不是可视线程的线程中修改可视元素。我知道这一点，因为在你的例外的第一行它说：

`Initialization of 'System.Windows.Controls.TextBlock' threw an exception. System.Windows.Markup.XamlParseException: Initialization of 'System.Windows.Controls.TextBlock' threw an exception. ---> System.InvalidOperationException: The calling thread cannot access this object because a different thread owns it.`

所有其余的例外都无关紧要。我认为是在加载初始配置时，然后使用其他线程。随机行为可能是有时您在`TextBlock`加载控件之前找到配置，因此这次不会抛出异常。

要解决这个问题，请查看[这个](https://stackoverflow.com/questions/12323405/invalidoperationexception-with-backgroundworker-in-wpf/12324412#12324412)问题，以及我给出的最后一个答案（使用 的`SynchronizationContext`那个，真正适用于使用多个线程的 WPF 应用程序）。如果不清楚评论，我会在这里写下解决方案。

希望这个答案有助于找到随机错误，这是最糟糕的......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T16:27:48.513

摆脱用于指定配置文件的额外 AppDomain 并用[此链接](https://stackoverflow.com/questions/6150644/change-default-app-config-at-runtime/6151688#6151688)中指定的方法替换它可以解决问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-22T23:16:35.130

我不确定是什么导致了这个异常，但我有一个解决你的问题的方法。

`AppDomain`您可以使用[ConfigurationManager.OpenMappedExeConfiguration](http://msdn.microsoft.com/en-us/library/ms134269.aspx)而不是单独创建一个单独的文件来加载不同的配置文件，它允许您从本地文件系统的任何位置加载任何 .config 文件。

你像这样使用它：

```
//Map the new configuration file.
var configFileMap = new ExeConfigurationFileMap() { ExeConfigFilename = @"c:\myOther.config"};

//Get the mapped configuration file
System.Configuration.Configuration config = ConfigurationManager.OpenMappedExeConfiguration(configFileMap, ConfigurationUserLevel.None); 
```

用于`config.GetSection()`获取特定部分以供只读使用或直接`config`对象以在运行时更改配置。

而且您将不需要不同的 AppDomain，这意味着更快的启动时间:)

# java - 如何让模拟方法表现不同取决于它被调用的次数

> ID：13495745
> 
> 赞同：0
> 
> 时间：2012-11-21T14:45:55.143
> 
> 标签：java, mockito, powermock

无论如何，我们可以让一个模拟方法的行为有所不同，具体取决于该模拟方法被调用的次数？

例如。

如果你有一个方法叫做

```
public boolean mockedmMethod() {
    //logic here
} 
```

你希望它以这种方式模拟：

当第一次调用 mockedMethod() 时，返回`true`。

第二次，第三次被调用...，返回`false`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T15:12:28.407

这能满足你的需要吗？

```
given(mock.mockedMethod())
        .willReturn(true, true, false, false)
        .willReturn(true)
        .willThrow(IllegalStateException.class)
        .will(execute_my_custom_answer()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T16:36:16.167

实际上，我发现：

```
Mockito.when(mockedMethod()).thenReturn(true).thenReturn(false); 
```

也可以解决问题。

# jquery - 用s替换 \r\n

> ID：13495748
> 
> 赞同：0
> 
> 时间：2012-11-21T14:46:00.177
> 
> 标签：jquery, regex, json

我已经成功提取了下面的 JSON，但是在将那些讨厌的正则表达式 \r\n\r\n 转换为`<br/>`'s 时遇到了问题。我目前正在使用以下代码，但它只转义了一些。我正在寻找替换正则表达式的所有实例，包括：\r\n、\r\n\r\n。我之前使用的代码是：

```
$('<ul class="job-listing"><li class="job-position"><h2>'+post.m_positionName+'</h2></li><li class="job-description">'+post.m_description.replace('\r\n','<br />')+'</li></ul>').appendTo('body'); 
```

这是JSON：

```
[
  {
    "m_id": 473644,
    "m_positionName": "Application Monitoring Software Engineer",
    "m_positionLocations": [
      {}
    ],
    "m_active": true,
    "m_description": "Job Responsibilities:\r\n\r\n-Create world class application monitoring tools and dashboards for our health care applications\r\n\r\n-Develop business rules to pro actively identify and re-mediate system-level issues before they occur.\r\n\r\n-Create business intelligence reports for internal and external use as a supplement to software products.\r\n\r\n\r\n\r\nJob Requirements:\r\n\r\n-BS or MS Degree in computer science or any engineering discipline.\r\n-4+ years of experience with Java (or other object-oriented programming language).\r\n-Experience in SQL, Struts, Hibernate, Spring, Eclipse, JSP, JavaScript.\r\n-Highly motivated and self-driven personality.\r\n-Excellent interpersonal and leadership skills.\r\n-A vision for the future and a desire to make a difference.\r\n-Experience with Maven, Tomcat, PostgreSql, Jasper Reports,",
    "m_postedDate": "Jun 29, 2012 9:17:19 AM",
    "m_closingDate": "Jun 29, 2013 12:00:00 AM"
  } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-21T14:48:17.633

用这个：

```
post.m_description.replace(/\r\n|\n|\r/g, '<br />'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T14:48:38.597

尝试这个：

```
replace(/\r\n/, '<br/>') 
```

JS中的正则表达式不需要用引号封装

# android - 用泛型解析 json 结果

> ID：13495751
> 
> 赞同：0
> 
> 时间：2012-11-21T14:46:02.167
> 
> 标签：android, json, generics, gson

我有一个应用程序向服务器发送 REST 请求并接收 JSON 响应。但是，我在应用程序上的 REST 客户端服务可能会发送几种不同类型的 REST 请求，这将导致不同的响应，从而导致在客户端 android 应用程序上创建不同类型的对象。每个响应将始终是某种类型的对象的数组。

这是我到目前为止所拥有的：

```
@Override
    protected List<?> doInBackground(String... urls) {    
        requestType = urls[0];
        InputStream source = retrieveStream(Constants.REST_SERVER_URL + requestType);    
        Gson gson = new Gson();         
        Reader reader = new InputStreamReader(source);
        List<?> result = gson.fromJson(reader, List.class);         
        return result;          
    }

    protected void onPostExecute(List<?> result) {
        if(requestType.equals(Constants.GET_OSM_POI_NODES)) {
            Log.v(TAG, String.valueOf(result.size()));

            ArrayList<Node> nodes = new ArrayList<Node>();
            for(Object o : result) {
                // create a node object from the result
            }   
        }       
    } 
```

在 onPostExecute 方法中，我想根据使用的 REST url 创建正确的对象。因此，例如，如果使用与 GET_OSM_POI_NODES 对应的 url，那么它将构造一个节点对象的 ArrayList，该对象由纬度和经度以及 id 组成。以下是此类对象的示例 JSON 响应：

```
[
    {
        "id": 353941,
        "lat": 754030751,
        "lon": -39701762
    }, 
     ... 
```

问题是传递给 onPostExecute 的结果总是一个通用对象列表，因为我希望它是通用的。我不确定如何从这些泛型类型创建 Node 对象。即使我不使用泛型，传递给 onPostExecute 的对象也是 StringMap 的列表，我不知道如何从中创建不同类型的对象。

有任何想法吗？

有人知道吗？谢谢

# jakarta-ee - 在无状态会话 bean 中处理 CDI 事件

> ID：13495757
> 
> 赞同：0
> 
> 时间：2012-11-21T14:46:18.193
> 
> 标签：jakarta-ee, ejb, cdi

我试图了解 CDI 事件是如何工作的，以便在我的应用程序中实现它们的使用，其结构如下：我有一个启动套接字服务器的 JCA 资源适配器。然后我有一个映射为该资源适配器端点的 MDB。现在，当我通过套接字服务器收到一条消息时，我想将此消息通知一个无状态 bean 池。此消息包含无状态会话 Bean 所需的数据，以便对来自 Web 服务的其他一些请求执行某些工作。

我创建了一个实现本地和远程接口的无状态会话 bean。本地的声明了一个listenToRegistration 方法。

```
@Stateless(...)
public class myBean implements MyRemoteInterface,MyLocalInterface{
   ...

   public void listenToEvent(@Observes EventMessage eventMessage){
       logger.info("gotcha!");
   }
} 
```

本地接口是这样定义的

```
@Local
public interface MyLocalInterface {
   public void listenToEvent(@Observes EventMessage eventMessage);
} 
```

从 JCA Resource Adapter 接收的 MDB 是这样的

```
@MessageDriven(...)
public class messagerMDB implements MessageEndpoint {
    @Inject
    Event<EventMessage> events;   

    ...

    @Override
    public void onMessage(String message) throws Exception {
       ...
       events.fire(message);
    }

} 
```

现在，假设在某个时间点，池中有 20 个 myBean 实例。当我收到一条消息时，我希望阅读 20 次“gotcha”。我对吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T07:03:15.387

不，只有一次。服务器将选择一个实例用于通知，而不是所有实例。如果它们是不同的类型，那么您应该收到每种类型的通知。

# ios - IOS：url目录路径中的文件

> ID：13495759
> 
> 赞同：0
> 
> 时间：2012-11-21T14:46:22.127
> 
> 标签：ios, url, directory

我有这段代码，但在 NSLog 中我有一个“空”结果

```
NSString *tmp = @"http://192.168.0.13:8888/dev/";

NSError *error = nil;

    NSURL *url = [NSURL URLWithString:tmp];

    NSArray *properties = [NSArray arrayWithObjects: NSURLLocalizedNameKey,
                           NSURLCreationDateKey, NSURLLocalizedTypeDescriptionKey, nil];

    NSArray *array = [[NSFileManager defaultManager]
                      contentsOfDirectoryAtURL:url
                      includingPropertiesForKeys:properties
                      options:(NSDirectoryEnumerationSkipsHiddenFiles)
                      error:&error];

    NSLog(@"array:%@", array); 
```

为什么？url 是正确的，因为使用浏览器我可以在目录中访问。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T14:54:11.623

尽管这可能有点令人困惑，但您实际上是在使用该 URL 访问文件。当向网络服务器询问没有 index.html 的目录的内容时，它会列出目录，并提供该目录中文件的 HTML 文件。我敢打赌，如果您使用 NSData 访问该文件，您会看到一堆链接。

# elasticsearch - ElasticSearch 在索引中的位置

> ID：13495761
> 
> 赞同：4
> 
> 时间：2012-11-21T14:46:34.247
> 
> 标签：elasticsearch

我正在考虑使用 Elasticsearch 来建立排名。如果我索引根据分数排序的元素列表。我可以通过元素名称查询并获取它在索引上的位置吗？

例如，我建立一个包含两个元素的索引：

“Element1”，得分：8 “Element2”，得分：7 “Element3”，得分：10

当我通过“Element2”查询时，我想获得 position = 3

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-22T02:40:48.037

Elasticsearch 在实际收集结果之前并不知道该位置，它收集结果只是为了将它们发送回客户端。所以，在你找到你正在寻找的文件之前，真的没有办法在不通过结果的情况下获得这个地方。如果将所有这些结果发送到客户端对您不起作用，您可以编写一个插件在服务器端执行此操作。

# wpf - DataGrid.SelectedIndex 的行为如何

> ID：13495763
> 
> 赞同：1
> 
> 时间：2012-11-21T14:46:34.487
> 
> 标签：wpf, datagrid

我有一个带有多选（SelectedMode = Extended）的 WPF 数据网格。每个项目都有一个 IsSelected 绑定，每个[https://stackoverflow.com/a/2615487/284795](https://stackoverflow.com/a/2615487/284795)

```
<DataGrid 
ItemsSource="{Binding Items}"
SelectionUnit="FullRow"
SelectionMode="Extended"
SelectedIndex="{Binding SelectedIndex}"
SelectedItem="{Binding SelectedItem}">
    <DataGrid.RowStyle>
        <Style TargetType="DataGridRow">
            <Setter Property="IsSelected" Value="{Binding IsSelected}" />
        </Style>
    </DataGrid.RowStyle>
</DataGrid> 
```

我很好奇。DataGrid 上的 SelectedIndex 和 SelectedItem 属性现在如何表现？如果在数据网格中选择了两项，SelectedItem 指向哪一项？

另外，如果所有这些绑定都是两种方式，并且我从视图模型更改为一种方式，那么其他方式会更新吗？（我正在观察我的应用程序中的一个错误，也许是因为这个）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-23T18:01:33.667

前段时间我有同样的问题，我检查了：我`DataGrid`用几个项目创建了 a 并设置了`SelectedMode = Extended`，并且我绑定了:`SelectedItem`和`SelectedIndex`属性。

结果是这样的：当您选择一个项目，然后选择其他项目并进行多选时，`SelectedItem`and`SelectedIndex`属性将是您选择的**第一个项目**。因此，当您进行多选时，所选项目将是您选择的第一个项目。

此外，所有其他选定的项目都将在`SelectedItems`集合中，即只读（就像[您指出的问题](https://stackoverflow.com/a/2615487/284795)中所说的那样）并且它不是依赖属性，因此您无法对其进行绑定。因此，如果要获取所有选定项目，则需要处理 的选择更改事件，`DataGrid`然后手动从要保留的集合（选定项目）中添加和删除新旧项目。

希望我的回答足够清楚，它可以帮助你......

# ellipse - 以匀速沿椭圆路径移动多个精灵

> ID：13495766
> 
> 赞同：3
> 
> 时间：2012-11-21T14:46:47.757
> 
> 标签：ellipse, elliptic-curve

我正在尝试在椭圆路径中移动多个精灵（图像），以使距离（弧距）保持一致。

我试过了

*   逐个角度移动每个精灵角度，但问题是围绕主轴移动单位角度时移动的距离与围绕短轴移动单位角度时移动的距离不同 - 因此移动的距离不同。

*   仅通过均匀更改 x 轴来移动精灵，但它再次围绕主轴移动更多。

那么有什么想法如何在不相互追赶/重叠的情况下均匀地移动精灵？

其他信息：

*   它将在 onMouseMove/onTouchMoved 中调用，所以我想它不应该占用太多 CPU。
*   虽然它是一个通用的算法问题，但如果它有帮助，我正在使用 cocos2d-x

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-02T13:28:26.783

所以这就是我最终要做的（这为我解决了）：

我以圆方程移动它并将角度增加了 1 度。使用 sin/cos(angle) * 半径计算 x 和 y。为了使它变成一个椭圆，我将它乘以一个因子。

因子是 yIntercept/xIntercept。

所以最终看起来像这样

```
FACTOR = Y_INTERCEPT / X_INTERCEPT;

//calculate previous angle
angle = atan((prev_y/FACTOR)/prev_x);

//increase angle by 1 degree (make sure its not radians in your case)
angle++;

//new x and y
x =  cos(newangle) * X_INTERCEPT;
y =  sin(newangle) * X_INTERCEPT * FACTOR; 
```

# tinymce - TinyMce 3.5 禁用清理

> ID：13495767
> 
> 赞同：3
> 
> 时间：2012-11-21T14:46:51.563
> 
> 标签：tinymce

使用 html 窗口编辑内容后，tinymce 会删除一些 html 内容。有什么方法可以禁用 tinymce 3.5 中的清理方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T14:58:49.543

不，自 tinymce 版本 3.4 起，此功能已被删除。有关更多信息，请参阅[tinymce 文档](http://www.tinymce.com/wiki.php/Configuration%3acleanup)。如果存在不应该从编辑器中删除的代码，则需要调整编辑器设置 valid_elements 和 valid_children。

# python - 请求一个 URL 并在 Python 中解析响应

> ID：13495772
> 
> 赞同：0
> 
> 时间：2012-11-21T14:47:09.607
> 
> 标签：python

我正在将一个实用工具从 Java 迁移到 Python，而且我是 Python 新手。我想知道在 Python 中完成这些简单而常见的任务的最佳方法：

1.  使用正确编码的所有参数构建一个 URL（使用 UTF8）。
2.  请求 URL 并解析 XML 响应。
3.  查找标签名称为“Foo”的任何节点
4.  查找具有属性 Foo="Bar" 的任何节点

我只需要使用 Python 2.7.3 API 来完成所有这些事情（没有任何第三方模块或库）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T14:49:05.163

查看用于发出请求的[urllib2](http://docs.python.org/2/library/urllib2.html "urllib2")库和用于解析响应的[ElementTree 。](http://docs.python.org/2/library/xml.etree.elementtree.html "元素树")它们都带有 Python 2.7.3。为了对参数进行编码，有一个方法被调用`urlencode`，它是[urllib](http://docs.python.org/2/library/urllib.html "urllib")库的一部分（在这种情况下是原始库，而不是 urllib2）。

# python - numpy.savetxt 可以用于 N>2 的 N 维 ndarray 吗？

> ID：13495777
> 
> 赞同：9
> 
> 时间：2012-11-21T14:47:17.740
> 
> 标签：python, file-io, multidimensional-array, numpy

我正在尝试使用 numpy.savetxt 将 4D numpy 浮点数组输出到纯文本文件

然而 numpy 给出了一个错误，说当我尝试传递这个数组时需要一个浮点参数。尽管如此，numpy doc指定要传递的参数应该只是数组......而不是它应该是最大等级2。我可以使它工作的唯一方法是将数据重塑为2D（这实际上不是出于数据组织的原因总是实用的）

有没有办法解决这个问题？还是必须将 numpy 数组重塑为二维？我期望能够像逐列样式一样读取fortran中的数据（通过维度进行处理）。

还有其他可能性吗？请注意，我不想使用 npy 格式，因为我寻求与另一个需要纯文本格式的程序的兼容性。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T15:23:21.927

如果您查看源代码，`numpy.savetxt`您会发现

```
 for row in X:
        fh.write(asbytes(format % tuple(row) + newline)) 
```

所以`numpy.savetxt`只适用于一维或二维阵列。

对于互操作性，如果您有足够的内存将 numpy 数组转换为列表，则可以使用 JSON：

```
import json
import numpy as np
a = np.arange(24).reshape(-1, 2, 3, 4).astype('float')
a[0,0,0,0] = np.nan
with open('/tmp/out', 'w') as f:
    json.dump(a.tolist(), f, allow_nan = True) 
```

产量

```
[[[[NaN, 1.0, 2.0, 3.0], [4.0, 5.0, 6.0, 7.0], [8.0, 9.0, 10.0, 11.0]], [[12.0, 13.0, 14.0, 15.0], [16.0, 17.0, 18.0, 19.0], [20.0, 21.0, 22.0, 23.0]]]] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-21T15:38:23.333

另一种方法是将数组保存为简单的数字列表（数组的平面版本），并保存有关其形状的信息。

多维数组的问题在于，即使以文本格式将它们从一个程序移动到另一个程序也不是那么简单。

你可以这样做：

```
myarray = rand(5,5,5)
name = 'myarray'+myarray.shape+'.txt'
np.savetxt(name,myarray.flatten()) 
```

并使用文件名中包含的大小信息来恢复初始形状

# maven - 声纳单元测试覆盖百分比未正确显示

> ID：13495781
> 
> 赞同：1
> 
> 时间：2012-11-21T14:47:49.423
> 
> 标签：maven, sonarqube, sonar-runner

我刚刚`Sonar`对我的项目实施了分析。它有 、`java`和`Spring`环境。我已经为业务层编写了一些单元测试用例，使用. 当我尝试执行这些测试用例时，它在以及*Sonar Reports*中都可以正常工作，如下所示：`Hibernate``GWT``Spring-Junit 4``Eclipse``maven install`

 *问题是，尽管成功执行了 11 个测试用例，但在声纳报告中**单元测试覆盖率**仍为**0.0% 。**我已经使用命令在*独立声纳服务器*上生成了这份报告`mvn sonar:sonar`

**示例测试用例**

```
@RunWith(value=SpringJUnit4ClassRunner.class)
@ContextConfiguration(locations = {"classpath:test-context.xml"})
@TransactionConfiguration(defaultRollback=true)
@Transactional
public class ThresholdServicesImplTest {

    @Autowired
    private IThresholdServices thresholdServices;

        @Test
        public void testSomemethods(){
        //testing and validating the methods.
         }

} 
```

**声纳截图（业务层代码）**

![单独业务层模块的声纳屏幕截图](../Images/7e2a02a1e0a1cb2456b52768a6f14012.png)

从上面的截图中，有 11 个测试用例成功执行，但这对单元测试覆盖率没有任何影响。

请提供您的建议以解决此问题。

**笔记：**

1.  对于其他层（数据和服务层），单元测试覆盖率按预期显示。
2.  此业务层中的总行数为 2,995，我将在我的测试覆盖中至少覆盖 500 个 LOC，因此对于这种情况，测试覆盖的百分比不可忽略。*

# shell - Jenkins shell 脚本在 .sh 文件中不起作用

> ID：13495782
> 
> 赞同：4
> 
> 时间：2012-11-21T14:47:54.977
> 
> 标签：shell, jenkins

我有一个运行 shell 脚本的 Jenkins 工作。当脚本直接放在构建命令字段中时，它可以完美运行。但是，如果我将脚本放在 .sh 文件中，然后从 Build 命令字段中调用它：

```
sh $sh_dir/deploy.sh $repo_dir $name $ref $env $site_dir 
```

`$sh_dir`是一个环境变量，其余的是作业参数。它不起作用，它在第一个命令上失败，这很简单

```
cd $1/$2 
```

同样，当直接放在命令字段中时，这非常有效，但在 .sh 文件中时则不行。.sh 文件作业的输出为：

```
Started by user anonymous
Building in workspace /var/lib/jenkins/workspace/deploy
[deploy] $ /bin/sh -xe /tmp/hudson6229756058999358596.sh

+ /var/lib/jenkins/scripts/deploy.sh /home/repos magento master live /home/sites
cd: 1: can't cd to /home/repos/magento 
```

是的，该目录确实存在，是的，它归`jenkins`.

我要疯了，试图弄清楚这一点。

编辑： deploy.sh 的结果`-x`：

```
Started by user anonymous
Building in workspace /var/lib/jenkins/workspace/deploy
[deploy] $ /bin/sh -xe /tmp/hudson3304816709711757032.sh
+ sh -x /var/lib/jenkins/scripts/deploy.sh /home/repos magento develop staging /home/sites
+ cd /home/repos/magento
cd: 1: can't cd to /home/repos/magento 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T16:38:41.200

评论中的讨论被带到了聊天室。

最终发现该问题是由于 Windows 行尾 (CRLF) 引起的混乱。例如，`/home/repos/magento\r`末尾带有 CR 的目录实际上是不存在的。周围有 Windows CIF 共享文件夹。该解决方案将涉及如何将脚本转换为本机 Unix（仅限 LF）行尾。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-12-12T09:11:47.813

在 jenkins shell 脚本中试试这个

```
sh 'pwd'
sh 'cd ..'
sh 'pwd' 
```

其他脚本

```
sh '''pwd
cd ..
pwd''' 
```

在同一个“sh”jenkins 的 cmd 中，工作目录是一样的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-23T19:43:37.270

我遇到了与上面的 Matt 相同的问题，但我 Jenkins（匿名用户）无权更改我试图将目录（cd）更改为的文件夹。当我切换到 /Users/Shared.. 文件夹时，一切正常。

# c - if (!fork) - 这是什么意思？

> ID：13495783
> 
> 赞同：3
> 
> 时间：2012-11-21T14:47:55.390
> 
> 标签：c, unix, fork

这是什么意思`if(!fork())`？我对此有点困惑，我不知道我什么时候在父子进程中：

```
if(!fork())
{
  // is it child or parent process?
}else{
  // is it child or parent process?
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-21T14:51:07.233

从[`fork(2)`手册页](http://linux.die.net/man/2/fork)：

> 返回值
> 
> 成功时，父进程返回子进程的PID，子进程返回0。失败时，在父进程中返回 -1，不创建子进程，并适当设置 errno。

由于`fork()`返回 0 给孩子，if 子句测试它是否是孩子：

```
if (!fork()) // same as: if (fork() == 0)
{
  // child
}else{
  // parent
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-21T14:50:01.600

因为`0`可以在条件中使用，就好像它是一个布尔值一样，这与询问相同：

```
if(fork() == 0) { 
```

文档说：

> 成功时，父进程返回子进程的PID，子进程返回0。失败时，在父进程中返回 -1，不创建子进程，并适当设置 errno。

当编码器只关心“not `0`”或`0`（“true”或“false”）时，直接在条件中使用整数值是一种常见的习惯用法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-21T14:50:54.500

调用`fork`在子进程中返回 0（当然，如果它有效），因此语句的真实（第一）部分在`if`那里运行（因为`!0`它是真实的）。

错误（第二）部分在父进程中执行，无论是`fork`成功（返回子进程的 PID）还是失败（返回`-1`）。

我不是这种特殊方法的忠实拥护者，因为它不能解决所有边缘情况。我更喜欢这样的东西：

```
pid_t pid = fork();
switch (pid) {
    case -1: {
        // I am the parent, there is no child, see errno for detail.
        break;
    }
    case 0: {
        // I am the child.
        break;
    }
    default: {
        // I am the parent, child PID is in pid, eg, for waitpid().
        break;
    }
} 
```

通过该设置，您可以*确切地*知道发生了什么，而不会丢失任何信息。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-21T14:53:42.953

 `````
if(!fork())
{
  /*  its child, as child would only be created on success and return 0 which would have been turned into true by ! operator */
}else{
  /* it is parent because either success or failed, fork would have returned nonzero value and ! would have made it false */
} 
````  `* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-21T15:58:36.680

该代码不检查来自 fork 的错误！当已经有太多进程在运行，或者没有足够的内存时，fork 将失败，您的软件可能会以一种非常奇怪的方式运行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-21T14:49:40.783

做`man fork`，你会知道更多。它实际上返回`pid_t`实际上是`int`

成功返回时，它`0`为子进程和父进程提供正值

实际上是这样的：

```
pid_t pid;
pid=fork();

if(pid <0)
{
 printf("fork failed");
 return -1;
}
else if(pid == 0) 
{
  it  is child process
}
else
{
  It is parent process
} 
```

因此，当您这样做时，这`if(!fork())`绝对意味着`child process`，因为`!0 == 1`即如果条件为真，它将执行内部的语句`if(!fork())`

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-21T14:52:28.140

的值`fork()`可以是：

*   0，这意味着它是一个孩子

*   < 0，这是一个错误

*   > 0 父母，这意味着它是父母

由于`if (!fork())`只是一种简短的写作方式`if (fork() == 0)`，因此意味着：

```
if(!fork()) {
  // it is a child process
}
else {
  // it is a parent process
} 
`````

# symfony - 如何在 Symfony2 中注册多个身份验证提供程序？

> ID：13495794
> 
> 赞同：2
> 
> 时间：2012-11-21T14:48:24.463
> 
> 标签：symfony

我根据以下内容创建了自己的身份验证：[http](http://symfony.com/doc/2.0/cookbook/security/custom_authentication_provider.html) ://symfony.com/doc/2.0/cookbook/security/custom_authentication_provider.html ，效果很好。

但是现在我需要有两个身份验证提供程序。AuthenticationProviderManager 支持这一点，但我不知道如何将第二个身份验证提供程序添加到我的安全工厂。

我的代码：

安全.yml

```
 firewalls:
    wsse_secured:
      pattern:   /api/.*
      wsse:      true 
```

WsseFactory.php

```
class WsseFactory implements SecurityFactoryInterface
{
    public function create(ContainerBuilder $container, $id, $config, $userProvider, $defaultEntryPoint)
    {
        $providerId = 'security.authentication.provider.wsse.'.$id;
        $container
            ->setDefinition(
                $providerId, 
                new DefinitionDecorator(
                    'wsse.security.authentication.provider'
                )
            )
            ->replaceArgument(
                0, 
                new Reference($userProvider)
            );

        $listenerId = 'security.authentication.listener.wsse.'.$id;
        $container->setDefinition(
            $listenerId, 
            new DefinitionDecorator(
                'wsse.security.authentication.listener'
            )
        );

        return array($providerId, $listenerId, $defaultEntryPoint);
    }

    public function getPosition()
    {
        return 'pre_auth';
    }

    public function getKey()
    {
        return 'wsse';
    }

    public function addConfiguration(NodeDefinition $node)
    {
    }
} 
```

服务.yml：

```
wsse.security.authentication.provider:
    class: LD\BinaryBackendBundle\Security\Authentication\Provider\WsseProvider
    arguments: ['', %kernel.cache_dir%/security/nonces]

wsse.security.authentication.listener:
    class:  LD\BinaryBackendBundle\Security\Firewall\WsseListener
    arguments: [@security.context, @security.authentication.manager, @logger] 
```

如您所见，我有一个身份验证提供程序注册。如何添加第二个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T15:06:17.623

您可以添加一个身份验证提供程序，只需将其添加到防火墙配置中，如果一个失败，它将传递给另一个，

例如，在我的应用程序中，我同时使用了 HWIOAuthBundle 中的 form_login 和 oauth [，](https://github.com/hwi/HWIOAuthBundle)这是我在 security.yml 中的防火墙：

```
firewalls:
    main:
        pattern:                    ^/
        logout:                     true
        anonymous:                  true
        form_login:
            csrf_provider:          form.csrf_provider
            login_path:             /login
            check_path:             /login_check
            default_target_path:    /manager/
        logout:
            path:                   /logout
            target:                 /
        oauth:
            resource_owners:
                google:             /login/check-google
                facebook:           /login/check-facebook
                twitter:            /login/check-twitter
            default_target_path:    /manager/
            login_path:             /login
            failure_path:           /login
            oauth_user_provider:
                service: oauth_user_provider 
```

因此，根据 url，它使用一个身份验证提供程序或另一个。

# jsf - 如何从视图范围的 JSF bean 中获取请求参数？

> ID：13495797
> 
> 赞同：7
> 
> 时间：2012-11-21T14:48:28.893
> 
> 标签：jsf, scope, httprequest

我有**视图范围**的bean，它应该在 init (@PostConstruct) 上访问来自请求 URL 的值并将它们存储在其生命周期内。

我了解到，为了从**http request**获取值，我需要以下代码：

```
@ManagedProperty("#{param.x}")
private int x; 
```

这给了我属性 X 的值。但是，我只能在**请求范围**的bean 中做到这一点。通过@ManagedProperty 将这个bean 注入到我的bean 中也不起作用。那么，如何在视图范围的 bean 中访问该 bean？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-21T17:00:25.897

`<f:viewParam>`在视图中使用。

```
<f:metadata>
    <f:viewParam name="x" value="#{bean.x}" />
</f:metadata> 
```

另一个优点是它允许细粒度的转换和验证。

请注意，在构建后设置值不可用。因此，如果您想根据该值执行初始化，请使用转换器或 preRenderView 侦听器。

### 也可以看看：

*   [ViewParam 与 @ManagedProperty(value = "#{param.id}")](https://stackoverflow.com/questions/4888942/viewparam-vs-managedpropertyvalue-param-id)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T14:56:19.567

我遇到了同样的问题，我通过以编程方式从以下位置检索值取得了成功`FacesContext`：

```
@PostConstruct
public void init() {
    String value = FacesContext.getCurrentInstance().getExternalContext().getRequestParameterMap().get(key);
} 
```

# c# - Moq 使用对象参数验证

> ID：13495801
> 
> 赞同：101
> 
> 时间：2012-11-21T14:48:34.220
> 
> 标签：c#, .net, unit-testing, moq

我正在尝试验证作为类的参数。正在测试的代码很好。该错误正在测试中。

我试过两种方法，都失败了。

这是我的尝试：

1：

```
this.MockImageResizeFilter.Verify(m => m.Filter(this.UploadedFileData, new ImageFilterOptions()
    {
        Width = 256,
        Height = 256,
    })); 
```

这总是失败，即使作为第二个参数传递的对象具有相同的属性。第一个参数验证良好。

2：

```
this.MockImageResizeFilter.Setup(m => m.Filter(It.IsAny<byte[]>(), It.IsAny<ImageFilterOptions>()))
    .Callback<byte[], ImageFilterOptions>((data, options) =>
        {
            Assert.AreEqual(this.UploadedFileData, data, "data");
            Assert.AreEqual(filterOptions.Width, options.Width, "Width");
            Assert.AreEqual(filterOptions.Height, options.Height, "Height");
        }
    ); 
```

这总是通过，即使它应该失败。回调中的 Asserts 确实失败了，但异常没有传递给外部上下文，因此测试总是通过。

你能帮我找出我做错了什么吗？

* * *

## 回答 #1

> 赞同：171
> 
> 时间：2012-11-21T15:30:49.307

第一次尝试更接近您想要实现的目标。

它失败的原因是 Moq （可能）`Object.Equals`在封面下使用来测试 `ImageFilterOptions`调用该方法的参数是否与您在调用中提供的参数相同`Verify`。

它们不可能是同一个实例，因为在`Verify`您创建一个`new ImageFilterOptions()`.

`It.Is`您可以使用 Moq 的语法来提供验证参数是否为预期参数的表达式，而不是以这种方式执行参数检查。

在您的情况下，您要检查参数是否为 type`ImageFilterOptions`并且 the`Width`和 the`Height`均设置为`256`。允许您这样做的表达式是：

```
It.Is<ImageFilterOptions>(p => p.Width == 256 && p.Height == 256) 
```

因此，您的调用`Verify`可能如下所示：

```
this.MockImageResizeFilter.Verify(m => m.Filter(
            this.UploadedFileData,
            It.Is<ImageFilterOptions>(p => p.Width == 256 && p.Height == 256))); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2021-11-01T17:45:37.400

Moq 的`Verify`方法只告诉您从未使用您指定的参数调用该方法，而没有解释哪个参数（或参数的哪个属性）是错误的。要获得详细信息，请使用回调将参数保存到变量中，然后对其进行断言：

```
ImageFilterOptions passedOptions = null;
this.MockImageResizeFilter.Setup(m => m.Filter(It.IsAny<byte[]>(), It.IsAny<ImageFilterOptions>()))
    .Callback<byte[], ImageFilterOptions>((data, options) =>
    {
        passedOptions = options
    });

// <exercise the mocked object>

this.MockImageResizeFilter.Verify(m => m.Filter(this.UploadedFileData, It.IsAny<ImageFilterOptions>());
Assert.AreEqual(expectedOptions.Width, passedOptions.Width, "Width");
Assert.AreEqual(expectedOptions.Height, passedOptions.Height, "Height");

// (If you wanted, you could also use the callback technique to check that
// `this.UploadedFileData` was passed in for the first parameter.) 
```

这会准确地告诉您哪个参数/属性是错误的。

您还有机会跳过单独测试每个属性，这在处理具有许多属性的对象时很好：

```
using FluentAssertions;

// ...

passedOptions.Should().BeEquivalentTo(expectedOptions); 
```

（请注意，[BeEquivalentTo](https://fluentassertions.com/objectgraphs/)确实指出了个别属性故障。）

# ruby-on-rails - Rails - Guard 没有加载更改

> ID：13495804
> 
> 赞同：1
> 
> 时间：2012-11-21T14:48:45.203
> 
> 标签：ruby-on-rails, ruby, rspec, guard, spork

我建立了一个新项目：

*   红宝石 1.9.3
*   导轨 3.2.9

我正在尝试按照[Michael Hartl 教程](http://ruby.railstutorial.org/chapters/static-pages#sec-guard)配置 rspec 与 guard 和 spork 。我已经为其他项目做过这个，但效果并不好，但这次我从警卫那里得到了一个奇怪的行为。

在旧项目中，如果我有警卫运行，请在方法“放置“测试””中添加这样的一行并保存文件。Guard 检测到文件已更改，重新运行该文件的测试，并且消息出现在终端上。

如果我在这个新项目上做同样的事情。Guard 还检测到文件已更改，重新运行该文件的测试，**但该消息不会出现在终端上**。看来它仍在使用旧代码库。

我已经比较了两个项目的配置，一切看起来都很相似。有任何想法吗？

我将把配置文件留在这里，看看是否有人发现了一些奇怪的东西。

**宝石文件**

```
...
gem 'rb-fsevent', '~> 0.9.1'

group :development, :test do
  gem 'rspec'
  gem 'rspec-rails'
  gem 'guard-rspec'
  gem 'factory_girl_rails'
end

group :test do
  gem 'capybara'
  gem 'guard-spork'
  gem 'spork'
end 
```

**保护文件**

```
guard 'spork', :cucumber_env => { 'RAILS_ENV' => 'test' }, :rspec_env => { 'RAILS_ENV' => 'test' } do
  watch('config/application.rb')
  watch('config/environment.rb')
  watch('config/environments/test.rb')
  watch(%r{^config/initializers/.+\.rb$})
  watch('Gemfile')
  watch('Gemfile.lock')
  watch('spec/spec_helper.rb') { :rspec }
  watch('test/test_helper.rb') { :test_unit }
  watch(%r{features/support/}) { :cucumber }
end

guard 'rspec', :version => 2, :all_after_pass => false, :cli => '--drb' do
  watch(%r{^spec/.+_spec\.rb$})
  watch(%r{^lib/(.+)\.rb$})     { |m| "spec/lib/#{m[1]}_spec.rb" }
  watch('spec/spec_helper.rb')  { "spec" }

  # Rails example
  watch(%r{^app/(.+)\.rb$})                           { |m| "spec/#{m[1]}_spec.rb" }
  watch(%r{^app/(.*)(\.erb|\.haml)$})                 { |m| "spec/#{m[1]}#{m[2]}_spec.rb" }
  watch(%r{^app/controllers/(.+)_(controller)\.rb$})  { |m| ["spec/routing/#{m[1]}_routing_spec.rb", "spec/#{m[2]}s/#{m[1]}_#{m[2]}_spec.rb", "spec/acceptance/#{m[1]}_spec.rb"] }
  watch(%r{^spec/support/(.+)\.rb$})                  { "spec" }
  watch('config/routes.rb')                           { "spec/routing" }
  watch('app/controllers/application_controller.rb')  { "spec/controllers" }

  # Capybara request specs
  watch(%r{^app/views/(.+)/.*\.(erb|haml)$})          { |m| "spec/requests/#{m[1]}_spec.rb" }

  # Turnip features and steps
  watch(%r{^spec/acceptance/(.+)\.feature$})
  watch(%r{^spec/acceptance/steps/(.+)_steps\.rb$})   { |m| Dir[File.join("**/#{m[1]}.feature")][0] || 'spec/acceptance' }
end 
```

**规范/spec_helper.rb**

```
require 'rubygems'
require 'spork'

Spork.prefork do
  ENV["RAILS_ENV"] ||= 'test'
  require File.expand_path("../../config/environment", __FILE__)
  require 'rspec/rails'
  require 'rspec/autorun'

  Dir[Rails.root.join("spec/support/**/*.rb")].each {|f| require f}

  RSpec.configure do |config|
    config.include Devise::TestHelpers, :type => :controller
    config.extend ControllerMacros, :type => :controller

    config.fixture_path = "#{::Rails.root}/spec/fixtures"
    config.use_transactional_fixtures = true
    config.infer_base_class_for_anonymous_controllers = false
    config.order = "random"
  end
end

Spork.each_run do
  # This code will be run each time you run your specs.

end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T18:32:08.430

当您进行更改时，Spork 没有重新加载您的代码可能是一个问题，看看这个问题它应该可以解决您的问题：

[Spork：如何刷新验证和其他代码？](https://stackoverflow.com/questions/5855587/spork-is-really-great-but-how-can-i-get-it-to-refresh-validations-and-other-cod)

# android - 无论音频播放器如何，都可以更改正在播放的曲目吗？

> ID：13495805
> 
> 赞同：0
> 
> 时间：2012-11-21T14:48:47.330
> 
> 标签：android, media-player

我不认为这是可能的，但我不知道一切，所以我最好只是问...

我是否可以开发一个 Android 应用程序，无论使用哪个音频播放器，我都可以更改为正在播放的特定曲目？我的意思是，他们都使用内置的“媒体服务器”来播放音频文件，对吧？也许这并不意味着什么...

我想开发这个应用程序，其中轨道会根据一些特定的动态信息自动更改为另一个，但我不想为此开发自己的音频播放器，我想使用用户在该领域的偏好。

除了开发音频播放器，我还有其他选择吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T14:52:41.873

不，您不能，除非其他应用程序支持此功能。

如果其他应用程序支持特定的广播或意图，那么您可以。但这样做的唯一方法，考虑到人们使用的知名音频播放器，我认为你必须创建自己的播放器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T15:35:41.893

是什么阻止您使用 MediaPlayer？ [http://developer.android.com/reference/android/media/MediaPlayer.html](http://developer.android.com/reference/android/media/MediaPlayer.html)

如果您的意思是如果他们有另一个播放音乐的应用程序，并且您想更改另一个应用程序正在播放的歌曲，那可能无法正常工作。

可能可以与 AudioManager 交互，但这是值得怀疑的。 [http://developer.android.com/reference/android/media/AudioManager.html](http://developer.android.com/reference/android/media/AudioManager.html)

您最好找到一个开源 meida 播放器应用程序并将您的功能添加到其中。

# php - 当层调用php脚本时会话重置

> ID：13495811
> 
> 赞同：-1
> 
> 时间：2012-11-21T14:49:08.997
> 
> 标签：php, jquery, ajax, session, session-variables

我有一个 php 脚本的问题。该脚本由层服务器调用。我调用的脚本在子域*scripts.mydomain.com上，它在子域**beta.mydomain.com*上调用另一个脚本

 *我已将我的配置设置为在我的域的所有子域之间共享会话。

如果我手动尝试，当我调用调用 beta.mydomain.com 的 scripts.mydomain.com 时，会话值会很好地共享

但是，当调用 scripts.mydomain.com 的是外部服务器时，不会保存会话值。我检查了会话 id，发现外部服务器调用时 scripts.mydomain.com 和 beta.domain.com 上的 id 不同。是我的时候，id是一样的。

我`header("Location: http://beta.mydomain.com");`在*scripts.mydomain.com中使用*

*（PS：我不能用GET来给参数，这是约束）*

之后，我想使用 jquery AJAX 函数来调用我的 scripts.mydomain.com

同样的问题，没有调用javascript函数，但是当我调用脚本时，javascript被很好地使用并且我的ajax函数成功调用了script.mydomain.com。

有人帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T14:54:41.517

会话值存储在每个实例的 PHP 会话临时文件夹中。您的情况听起来像是您正在使用两个单独的服务器或两个 PHP 实例。因此，如果您使用两个 PHP 实例（一个在 beta 上，另一个在脚本上），您的会话值将单独存储，即脚本存储在脚本上，beta 存储在 beta 上。尽管您的会话标识符可以通过 cookie 在两个实例之间共享，但第二个实例无法从第一个实例中找到值。

我的建议是你：

1.  将两个实例的会话临时文件夹指向一个公共文件夹（如果在同一台服务器上）
2.  使用会话数据库驱动程序和单独的数据库服务器，用于存储会话信息*

# java - 使用 Executor 接口而不是显式创建线程

> ID：13495813
> 
> 赞同：2
> 
> 时间：2012-11-21T14:49:15.613
> 
> 标签：java, multithreading, concurrency

我读过使用`Executor`接口比显式创建自己的线程更好的编程实践。在我看来，创建自己的线程并在`Thread`构造函数的参数中初始化它们要容易得多。`Executor`到目前为止，使用而不是创建线程的优点是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T14:53:03.217

创建线程是一项昂贵的操作，因此最好将 Thread 返回到线程池。这在为每个客户端请求分配一个线程的服务器中尤其需要。

每秒有数百个请求并在每次需要时重新创建线程会极大地影响性能。

因此，在需要少量线程的情况下，您可以在没有 Executor 的情况下创建它们。如果您的应用程序可能会创建许多线程，请使用 Executor。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T15:40:16.310

有了一个明确`Thread`的对象，你就可以得到：一个并行运行的线程。`ExecutorService`你得到：

*   在任务执行之间回收的线程池。
*   线程安全的阻塞任务队列，线程自动检查新任务。
*   隐式负载平衡。
*   隐式效率，因为避免了线程创建开销。

这`ExecutorService`允许轻松实现生产者-消费者范式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T14:53:36.400

优点之一是线程将从池中使用，而不是每次都创建。

按照oracle[并发教程](http://docs.oracle.com/javase/tutorial/essential/concurrency/highlevel.html)

> 执行器定义了一个用于启动和管理线程的高级 API。java.util.concurrent 提供的 Executor 实现提供了适合大规模应用的线程池管理

# iphone - 是否有 APNs 的替代品

> ID：13495816
> 
> 赞同：0
> 
> 时间：2012-11-21T14:49:27.397
> 
> 标签：iphone, objective-c, ios, apple-push-notifications

我正在编写的 iOS 应用程序无法访问互联网，只能访问本地网络，但即使应用程序暂停，它仍需要从我们的 LAN 中的服务器接收通知。是否有类似于 APN 的开箱即用解决方案？我听说过pushwoosh，有人有经验吗？

如果我必须自己实施，有没有人有一些关于如何这样做的信息？重新实现它似乎有点疯狂....

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T15:13:54.900

不，如果你想发送推送通知，它们必须通过 APNS。我以前没有使用过 pushwoosh，但假设它们与 UrbanAirship 等其他服务类似，因为它们为您提供了一种设置和管理通知的好方法，但它们仍在通过 APNS。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-16T19:50:48.047

iOS 设备定期检查 APNS 服务（使用未记录的专有 Apple 协议）以生成和维护 devicetoken+pushmagic 对。此行为是设备硬件/操作系统的一部分，无法修改，并且可以执行您的应用程序无法执行的操作。

如果您尝试自己做，您的应用程序将不得不处理 iOS 环境的所有限制和约束，如果不是不可能的话，这将使其变得非常困难。正如 JamesP 所提到的，越狱可能会让您绕过一些限制（但不是全部），但即使在那时，它仍然是一项不平凡的工作。

# python - HTML 中的 Web2py SQLFORM

> ID：13495817
> 
> 赞同：1
> 
> 时间：2012-11-21T14:49:29.190
> 
> 标签：python, web2py

我正在关注 Web2py 关于 HTML 中 SQLFORM 的书。 [http://web2py.com/books/default/chapter/29/07#SQLFORM](http://web2py.com/books/default/chapter/29/07#SQLFORM)

但是，我似乎无法弄清楚。我已将隐藏字段`name="_formname"`及其值设置为`test`. 表格似乎没有被处理。这是我的代码：

测试.html：

```
<form action="" method="post">
    <ul>
       <li>Your name is <input name="name" /></li>
    </ul>
    <input type="submit" />
    <input type="hidden" name="_formname" value="test" />
</form> 
```

控制器/默认/test.py：

```
def test():
form = SQLFORM(db.person)
if form.process(formname='test').accepted:
    session.flash = T('Succeeded.')
    redirect(URL('index'))
elif form.errors:
    response.flash=T('Form has errors.')
return dict() 
```

模型/db.py：

```
db.define_table('person',
Field('name', requires=IS_NOT_EMPTY())) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T18:14:18.237

请注意，本书示例包括以下内容：

```
form.process(session=None, formname='test') 
```

在上面，设置`session=None`禁用隐藏的“_formkey”字段，用于防止CSRF攻击和双重表单提交。但是，在您的代码中，您没有设置`session=None`，这意味着在提交时处理表单时，它期望接收隐藏的“_formkey”值。当未找到该值时，处理失败，尽管它不会生成任何`form.errors`，因此不会触发您的错误条件。要准确复制本书示例，您必须设置`session=None`. 否则，如果您想保留 CSRF 保护（这是一个好主意），您可以在表单 HTML 中添加以下内容：

```
<input name="_formkey" type="hidden" value="{{=formkey}}" /> 
```

您还必须修改控制器函数以返回 formkey 值以在视图中使用：

```
def test():
    ...
    return dict(formkey=form.formkey) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T15:30:06.733

您需要将 HTML 代码放在名为 test.html 的视图中

和代码：

```
 session.flash = T('Succeeded.') 
```

将其更改为：

```
response.flash='Succeeded.' 
```

T() 查找要翻译的已定义字符串，但我没有看到名为 Succeeded 的字符串。关于语言文件。

仅尝试您的视图文件：

```
{{=form}} 
```

这样，web2py 会自动为您生成表单，不需要手动编码表单

# git - 如何返工 git merge 提交？

> ID：13495818
> 
> 赞同：1
> 
> 时间：2012-11-21T14:49:28.503
> 
> 标签：git, git-merge, git-rebase, git-stash, git-reset

我想修改在我们的持续集成服务器上未通过单元测试的合并提交，但我不想留下未通过历史测试的提交。

由于此提交仅由 CI 服务器使用（并且不会被其他任何人拉下），我想修复合并，然后`--force`将其推送以替换现有的失败合并提交。

我的问题是，我无法弄清楚如何轻松地回到原始提交之前的状态，以便我可以修复失败的测试，重新提交合并，然后强制推动该更改。

我真的不想重做整个合并，因为有相当多的文件必须解决冲突，除了一个以外的所有文件都已成功解决。

## 到目前为止我尝试过的

### 尝试1：`git reset`

我的第一次尝试是在合并提交之前对提交进行混合重置，修复合并引入的错误，然后重新提交。

```
git reset HEAD^
# Fix the failing test
git commit 
```

不幸的是，这导致了一个非合并提交，它默默地合并了所有的分支更改——这并不是我真正想要的。*8')

### 尝试 2: `reset`, `stash`, `merge`&`apply`

然后我尝试使用 stash 来保存我在第一次尝试合并时所做的更改：

```
git reset HEAD^
git add .               # Since there were untracked files
git stash
git merge branch
git stash apply         # Fails
git add .
git stash apply         # Merged but with conflicts 
```

不幸的是，当`git stash apply`尝试将我的隐藏更改与现有的冲突合并文件合并时，它失败并出现错误

> 无法应用于脏工作树，请暂存您的更改

如果我尽职尽责地使用`git add .`then`git stash apply`运行使我的工作目录干净，但现在我不仅有冲突，我还与它们中的冲突发生冲突，并且任何应该删除的文件都已重新添加。

### 尝试 3:`amend`和/或`rebase`.

我尝试了qqx[的](https://stackoverflow.com/users/1507392/qqx)[简单建议](https://stackoverflow.com/a/13496331/42473)来解决问题和原始提交，但实际上没有回到中间合并状态，您将无法访问合并工具。`git commit --amend`

一旦我提交，我就失去了运行的能力，`git mergetool {file}`因为它只是返回错误：

> {file}：文件不需要合并

在尝试修复合并冲突时，我真的很喜欢能够使用`kdiff3`.

using`rebase`遇到同样的问题。

* * *

任何可以让我达到我想要的结果的工作流程提示将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T15:19:15.890

由于您只是在重置最近的提交，因此自有问题的提交以来，您似乎没有进行任何其他提交。因此，您应该能够只修复代码，`git add`在更改的文件上使用，然后用于`git commit --amend`替换现有的合并提交。这将保留合并信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T17:14:51.703

```
git branch old_merge
git checkout -b new_merge HEAD~
git merge branch 
```

会让您回到挂起合并状态，您可以在其中使用正常的合并工具。由于旧的合并被保存为`old_merge`分支，您还可以使用`git checkout old_merge {file}`您在之前的尝试中为特定文件所做的选择。完成后，您可以照常提交，然后签出您之前正在处理的分支并用于`git reset --hard new_merge`切换到使用新的合并提交。

# lync-2010 - 显示如何从控制台应用程序发送 Lync 消息的简单示例/教程

> ID：13495820
> 
> 赞同：0
> 
> 时间：2012-11-21T14:49:38.937
> 
> 标签：lync-2010

我有我使用 xmpp 编写的代码给所有用户通过即时消息与我的代码进行通信。由于我现在在 Microsoft 商店，因此我想将此代码转换为使用 Microsoft Lync。问题是我发现的所有示例都只向您展示了如何使用 ui 构建胖客户端。我正在构建一个库，该库将由运行长进程的代码调用，因此不会有用户或 UI。

任何人都可以向我指出一些好的示例或教程，这些示例或教程将使我能够登录帐户并向个人/团体发送/接收消息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T09:45:12.180

对于 Lync 2010，您可能必须创建一个 UCMA 应用程序并公开所需的接口。

对于 Lync 2013，您可以利用 UCWA API。[您可以在此MSDN 频道](http://channel9.msdn.com/posts/Lync-Developer-Roundtable-UCWA-Overview)上找到更多详细信息。

# jquery - jQuery 切换/滑动重置链接

> ID：13495823
> 
> 赞同：1
> 
> 时间：2012-11-21T14:49:42.147
> 
> 标签：jquery, toggle, slidetoggle, slidedown, slideup

我为网站上的一些文本制作了一个切换脚本。我有大约 10 个“头”链接和两个 h3 链接。基本上，如果您单击一个头部链接，它会通过再次单击来打开和关闭。如果你点击h3，它们都打开了。如果已经打开，它会保持打开状态。一个问题是，如果您将它们全部打开然后关闭并仅打开一个然后尝试将它们全部关闭，您必须单击 h3 两次。这是因为当它自己打开时，它会给出一个 active1 类，而当它们一起打开时，它会给出一个 active 类。因此，当我第一次点击 h3 时，它会将 active1 变为活动状态（这样它们就可以在只有一个打开并且您想将它们全部打开的情况下全部关闭或打开），然后第二次它最终关闭了所有活动. 希望这是有道理的。

这是[JFiddle](http://jsfiddle.net/Ry6Nr/)。

```
$(".topics").hide(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T15:26:41.890

请参阅[此](http://jsfiddle.net/Ry6Nr/9/)更新的 jsFiddle。

原始代码：

```
 if( $(".head").hasClass("active1") ){
    $(".head").removeClass("active1").addClass("active").next().slideDown(350);
        } else 
```

更新代码：

```
$("h3").click(function(){
    if( $(".head").hasClass("active1") ){
    $(".head").removeClass("active1").next().slideUp(350);
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T15:19:18.310

当你可以只使用一个类时，为什么还需要使用 2 个类？它只是告诉你哪些是开放的或不开放的。

```
$("h3").click(function() {
    var $div = $(this).siblings('.head'); // cache the relative divs
    var len = $div.filter('.active').length; // get how many are active
    var $topic = $(".topics", $(this).parent()); // topics relative to element
    if (len == $div.length) { // if all are active
        $div.removeClass('active'); // remove class active
        $topic.slideUp(350); // slideup
    } else {
        $div.addClass('active'); // else add active to all
        $topic.slideDown(350) //  slide down
    }
});

$(".head").click(function() {
    var $el = $(this); // cache this
    if ($el.hasClass("active")) {
        $el.removeClass("active").next().slideUp(350);
    } else {
        $el.addClass("active").next().slideDown(350);
    };
}); 
```

[http://jsfiddle.net/pmsJa/](http://jsfiddle.net/pmsJa/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T15:18:24.883

这是您所追求的功能吗：http: [//jsfiddle.net/Ry6Nr/8/](http://jsfiddle.net/Ry6Nr/8/)？

```
$(document).ready(function(){    
    $(".topics").hide();        
    $(".head").click(function(){
        $(this).toggleClass("active").next().slideToggle();
    });
}); 
```

`toggleClass`and`slideToggle`函数做我认为你正在尝试做的事情。

# php - 如何获取没有www、子域和com/net/org/etc的域名

> ID：13495828
> 
> 赞同：4
> 
> 时间：2012-11-21T14:49:56.587
> 
> 标签：php, url, dns

我只需要从 url 中获取域名，（没有 com 和其他所有内容）示例：

我有：

```
http://www.subdomain.domain1.com/
www.subdomain.domain2.net
subdomain.subdomain2.domain3.org/
http://domain4.com 
```

我想使用 PHP：

```
domain1
domain2
domain3
domain4 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-21T14:53:52.770

[parse_url()](http://www.php.net/manual/en/function.parse-url.php)

使用“PHP_URL_HOST”参数

然后在“。”上[爆炸（）](http://www.php.net/manual/en/function.explode.php)并提取结果数组的倒数第二个元素

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-09-26T17:53:11.313

基于[Shyam 的回答](https://stackoverflow.com/users/1918077/shyam)并采用[Mark Ba​​ker](https://stackoverflow.com/users/324584/mark-baker)建议的概念来获取命名空间的倒数第二个元素，我可能会建议使用更简单的正则表达式，该表达式利用如下所示的*锚定前瞻*：

```
function get_domain($url) {
    $matches = [];
    preg_match('/[\w-]+(?=(?:\.\w{2,6}){1,2}(?:\/|$))/', $url, $matches);
    return $matches[0];
} 
```

火柴

*   `names`在`https://www.names.co.uk/`
*   `domain1`在`http://www.subdomain.domain1.com/`
*   `domain2`在`www.subdomain.domain2.net`
*   `domain3`在`subdomain.subdomain2.domain3.org/`
*   `domain4`在`http://domain4.com`
*   `seventymm`在`http://www.seventymm.co.in/browse/buy-home-furnishing-bed-sheets-pack-of-3/2456/1/v2034/0/0/1/2/1/0/go`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-29T06:36:55.060

夏姆的回答是最好的。您只需确保所有 URL 都以 HTTP 开头并在末尾添加 strtok（见下文）。这是另一个使用数组的版本：

```
function get_domain($url)
    {
    $urlobj = parse_url($url);
    $domain = $urlobj['host'];
    if (preg_match('/(?P<domain>[a-z0-9][a-z0-9\-]{1,63}\.[a-z\.]{2,6})$/i', $domain, $regs))
        {
        return $regs['domain'];
        }

    return false;
    }

$urls = array(
    'http://www.subdomain.domain1.com/',
    'http://www.subdomain.domain2.net',
    'http://subdomain.subdomain2.domain3.org/',
    'http://domain4.com'
);

// Using foreach + strtok to remove .[domain extensions]

echo "<ul>";

foreach($urls as $url)
    {
    echo "<li>" . strtok(get_domain($url),'.') . "</li>";
    }

echo "</ul>"; 
```

这将输出：

*   域1
*   域2
*   域3
*   域4

PS你可以将strtok添加到函数中，如下所示：

```
function get_domain($url)
    {
    $urlobj = parse_url($url);
    $domain = $urlobj['host'];
    if (preg_match('/(?P<domain>[a-z0-9][a-z0-9\-]{1,63}\.[a-z\.]{2,6})$/i', $domain, $regs))
        {
        return strtok($regs['domain'], '.');
        }

    return false;
    } 
```

然后：

```
$urls = array(
    'http://www.subdomain.domain1.com/',
    'http://www.subdomain.domain2.net',
    'http://subdomain.subdomain2.domain3.org/',
    'http://domain4.com'
);

// Using foreach

echo "<ul>";

foreach($urls as $url)
    {
    echo "<li>" . get_domain($url) . "</li>";
    }

echo "</ul>"; 
```

减去 ul/li：

```
 $urls = array(
        'http://www.subdomain.domain1.com/',
        'http://www.subdomain.domain2.net',
        'http://subdomain.subdomain2.domain3.org/',
        'http://domain4.com'
    );

    // Using foreach
    foreach($urls as $url)
        {
        echo get_domain($url)."<br>";
        } 
```

输出：

域1
域2
域3 域
4

* * *

## 回答 #4

> 赞同：-5
> 
> 时间：2015-06-01T02:25:00.770

要获取域，您可以使用`$_SERVER["SERVER_NAME"]`.

用您不想包含的子域分解字符串。

例如。subdomain.domain.com

```
<?php
$add=explode('subdomain.',$_SERVER["SERVER_NAME"])[1];
// $add = domain.com
?> 
```

# javascript - 限制表单提交的次数

> ID：13495833
> 
> 赞同：0
> 
> 时间：2012-11-21T14:50:03.987
> 
> 标签：javascript, jquery, html

我有一个文本区域：

```
 <form id='test'>
      <textarea class='test2'> </textarea> <input type='submit' value='send'/>
      </form> 
```

我想知道是否有办法限制用户可以提交 textarea 的次数（例如，每分钟 5 次）。

编辑：我想在客户端，在 Javascript 中做到这一点。

编辑2：

是用来聊天的。我只是不希望人们能够在一小段时间内发布太多消息。因此，如果他们刷新页面以摆脱限制，这不是问题，他们将花费的时间足够长......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T15:14:39.947

您可以存储一些变量：

```
$(function () {
   var timesSubmitted = 0;
   var maxSubmits = 5;
   var intervalMilliseconds = 10000; // for testing   
   var interval;   
    $('input[type=submit]').click(function (event) {
        if (!interval) {
            interval = setTimeout(function () {
                interval = undefined;
                timesSubmitted = 0;
                $('div').append('TIMER RESET. Submit again.<br />')
            }, intervalMilliseconds);
        }
        timesSubmitted ++;
        if (timesSubmitted > maxSubmits) {
            $('div').append('NO GO YO!<br />')
        } else {
            $('div').append('valid<br />')   
        }
        event.preventDefault();        
    });        
});​ 
```

[**例子**](http://jsfiddle.net/5ppLP/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T15:26:48.987

就像他们说的那样，用 javascript 来做这件事既不专业也不安全。更好的服务器端，但是你去：

```
<script type="text/javascript"> 
var flag = false;
function checkTimer(){
    if (flag){
        flag=false;
        return true;
    }
    alert("Don't flood man!");
    return false;
}

//12 seconds, max 5 times per minute
setTimeout(function(){flag=true;},12000);
</script> 
```

在表格上：

```
<form id='test' onSubmit="return checkTimer()"> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T15:27:29.203

[我在jsFiddle](http://jsfiddle.net/4Xh4h/7/)上做了这个快速的小样本。您可能需要在某些 ajax 中对其进行变形，以便您可以提交表单而无需重新加载变量以保留您的信息。

如果您正在寻找 AJAX 版本，它会看起来像

> ```
> // Setup variable for easy tracking!!!
> var timesSubmitted = 0, timeCounter = 60 * 1000, Timer = null;
> 
> // Call function to submit form
> function submitForm() {
>   // Check if user has submitted form more than 5 times
>   if (timesSubmitted < 5) {
>       // Call ajax to submit form. jQuery Ajax: http://api.jquery.com/jQuery.ajax/
>       $.ajax({
>           type: "POST",
>           url: 'ajaxpage.html',
>           data: { test2: $('#test textarea').val() },
>           success: function(data) { // if form is submitted successfully
>               // If timer has yet to be started... Start it! 
>               if (Timer === null) {
>                   Timer = setTimeout(
>                       function() {  
>                           // Setup alert so user knows they can continue to submit form
>                           if (timesSubmitted > 0) { alert('Submissions Reset'); }
>                           timesSubmitted = 0; 
>                       }, 
>                   timeCounter );
>               }
> 
>               // Add for submission to counter
>               timesSubmitted++;
>             }
>       });
>   }else{
>       // Alert user they can not sumbit anymore!
>       alert('You may only submit this from 5 times per minute!');
>   }
> } 
> ```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-21T14:56:48.830

不，没有办法在客户端限制这一点（您可以尝试使用 JavaScript 来强制执行此类限制，但可以通过禁用 JS 轻松忽略）。你可以对你的目标脚本强制执行这样的限制，如果经常出现，你可以拒绝表单处理

# image - 图像处理速度过慢（嵌套 for 循环的矢量化）

> ID：13495839
> 
> 赞同：0
> 
> 时间：2012-11-21T14:50:27.677
> 
> 标签：image, matlab, image-processing, octave, vectorization

我需要 Octave 图像处理方面的帮助。我正在尝试在某些图像上计算本地“滑动窗口”ssd。速度太慢了（嵌套的 for 循环加起来 88*120*41*41 次迭代），因此无法使用它。我使用的版本是 Windows7 64 位上的 3.6.2。(corei5)

我正在启动以下八度脚本

[http://pastebin.com/AjDJSX6e](http://pastebin.com/AjDJSX6e)

到下图

[http://picpaste.com/pattern1-90xYCNZB.bmp](http://picpaste.com/pattern1-90xYCNZB.bmp)

有什么建议吗？预先感谢您的关注

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T16:04:05.327

在函数处循环`filter2`，`ordfilt2`并且`blockproc`（最后一个很可能是您将使用的。它在 2.0.0 之前的包版本中称为 blkproc）。我没有仔细看你的代码试图做什么，但如果这些循环真的是必要的，我会感到非常惊讶。您似乎只在不同的索引处进行简单的算术运算。了解如何矢量化您的代码，您将看到巨大的改进。如果您可以解释代码应该做什么，我们可能会提供更多帮助。

此外，您不需要使用`sum (sum (x))`，您可以并且应该将它们替换为`sum (x(:))`. 而且你也不需要使用`sum (x.^2)`，你可以使用`sumsq (x)`。因此，您的 4 个函数调用`sqrt (sum (sum (curDiff.^2)))`可以替换为`sumsq (curDiff(:))`.

比较以下内容：

```
octave> x = rand (5000, 5000);
octave> t = cputime (); sqrt (sum (sum (x.^2))); cputime () - t
ans =  0.25202
octave> t = cputime (); sumsq (x(:));            cputime () - t
ans =  0.060004 
```

它不仅更短更容易阅读，而且速度也快了 4 倍（在像你这样的巨大循环中会产生巨大的差异）。

# postgresql - postgresql 更新错误“错误：布尔类型的输入语法无效：”

> ID：13495840
> 
> 赞同：21
> 
> 时间：2012-11-21T14:50:28.187
> 
> 标签：postgresql

我正在尝试对 postgresql 进行简单的更新查询。我真的不明白这个错误，因为没有布尔值或列类型。这是日志：

```
cat=> 更新类别 SET epekcategoryid='27af8b1e-c0c9-4084-8304-256b2ae0c8b2' and epekparentcategoryid='root' WHERE categoryId='281' and siteid='0' and categoryparentid='-1';
错误：布尔类型的输入语法无效：“27af8b1e-c0c9-4084-8304-256b2ae0c8b2”
第 1 行：更新类别 SET epekcategoryid='27af8b1e-c0c9-4084-830...

```

表配置：

```
cat=> \d 类别；
                表“public.categories”
        专栏 | 类型 | 修饰符
----------------------+------------+--- --------
 类别ID | 字符变化(32) |
 类别名称 | 正文 |
 网站ID | 整数 |
 类别父ID | 字符变化(32) |
 状态 | 整数 | 默认 0
 epekcategoryid | 正文 |
 epekparentcategoryid | 正文 |
 类别级别 | 字符变化(37) |
 分类路径 | 字符变化(37) |
```

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2012-11-21T15:21:08.720

尝试：

```
UPDATE categories 
SET epekcategoryid='27af8b1e-c0c9-4084-8304-256b2ae0c8b2',
    epekparentcategoryid='root' 
WHERE categoryId='281' 
  and siteid='0' 
  and categoryparentid='-1'; 
```

`SET`您必须用 " "分隔字段`,`，而不是用 " `AND`"

# c++ - Richedit 无窗口操作中的颜色变化

> ID：13495844
> 
> 赞同：0
> 
> 时间：2012-11-21T14:50:44.097
> 
> 标签：c++, highlighting, richedit

我正在尝试实现类似于域突出显示的东西。我希望富编辑框中的部分文本具有不同的颜色，就像我们在 IE 的域突出显示功能中一样。

问题：我知道我们必须先使用`EM_EXSETSEL`来选择所需的文本，然后再应用`EM_SETCHARFORMAT`。

`EM_EXSETSEL`执行所需的操作并正确选择所需的文本。但是，当我执行`EM_SETCHARFORMAT`时，所选文本不会发生任何变化。

窗口是使用 RICHEDIT_CLASS 创建的。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T15:43:36.923

How about something like this (to set bold, red text on the current selection):

```
 // Set up the CHARFORMAT structure
   CHARFORMAT cfm;
   cfm.cbSize = sizeof(cfm);    // Don't forget this!

   // Get char format
   ::SendMessage(hWnd, EM_GETCHARFORMAT, SCF_SELECTION, (LPARAM)&cfm);

   // Set the new effects
   cfm.dwEffects   = CFE_BOLD;
   cfm.crTextColor = RGB(255,0,0);
   cfm.dwMask      = CFM_BOLD | CFM_COLOR;

   // Set the new format
   ::SendMessage(hWnd, EM_SETCHARFORMAT, SCF_SELECTION, (LPARAM)&cfm); 
```

where hWnd is the window handle of the Rich Edit control.

If not... then post some code, so we can see where you might be going wrong...

# xpages - 如何获取应用程序中所有 .properties 文件的列表

> ID：13495847
> 
> 赞同：1
> 
> 时间：2012-11-21T14:51:00.040
> 
> 标签：xpages

我正在寻找一种方法来获取使用 java 的应用程序中所有属性文件的文件名列表。

目标是动态构建语言选择下拉菜单的内容。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T15:57:09.413

此类提供*getPropertFileList()*方法，该方法将当前数据库中的所有属性文件（语言资源文件）作为*java..util.Vector 返回*

```
package ch.hasselba.xpages;

import java.util.Vector;
import javax.faces.context.FacesContext;
import lotus.domino.Database;
import lotus.domino.Document;
import lotus.domino.NoteCollection;
import lotus.domino.NotesException;

public class DesignElements {

    private final String EMPTY_STRING = "";
    private final String FLAG_PROPERTY = "gC~4K2P";
    private final String FIELD_$FLAGS = "$Flags";
    private final String FIELD_TITLE = "$TITLE";

    /**
     * returns Vector containing all property files 
     * of a database
     * 
     * No error handling included!
     * 
     * @category Domino
     * @author Sven Hasselbach
     * @category Tools
     * @version 0.1
     */
    public Vector getPropertFileList() {

        FacesContext fc = FacesContext.getCurrentInstance();

        Vector data = new Vector();
        try {

            // get DB
            Database db = (Database) fc.getApplication().getVariableResolver()
                    .resolveVariable(fc, "database");

            // get all design docs
            NoteCollection nc = db.createNoteCollection(false);
            nc.selectAllDesignElements(true);
            nc.buildCollection();

            // process all notes 
            String noteId = "";
            noteId = nc.getFirstNoteID();

            Document doc = null;
            // 
            while (!(EMPTY_STRING.equals(noteId))) {

                // get design doc
                doc = db.getDocumentByID(noteId);

                // check if its a property file
                if (FLAG_PROPERTY.equals(doc.getItemValueString(FIELD_$FLAGS))) {
                    // add to Vector
                    data.add(doc.getItemValueString(FIELD_TITLE));
                }

                // next one
                noteId = nc.getNextNoteID(noteId);

                // recycle doc
                recycleObject( doc );
            }

        } catch (NotesException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

        return data;

    }
    /**
     * recycles a domino document instance
     *
     * @param lotus.domino.Base
     *           obj to recycle
     * @category Domino
     * @author Sven Hasselbach
     * @category Tools
     * @version 1.1
     */
    public static void recycleObject(lotus.domino.Base obj) {
        if (obj != null) {
           try {
              obj.recycle();
           } catch (Exception e) {}
       }
    }
} 
```

要在 XPage 中使用它，只需像这样调用它：

```
<?xml version="1.0" encoding="UTF-8"?>
<xp:view xmlns:xp="http://www.ibm.com/xsp/core">

   <xp:comboBox id="comboBox1">
      <xp:selectItems>
         <xp:this.value>
            <![CDATA[#{javascript:
               importPackage(ch.hasselba.xpages);
               DesignElements().getPropertFileList()
            }]]>
         </xp:this.value>
      </xp:selectItems>
   </xp:comboBox>
</xp:view> 
```

# ruby-on-rails - slim_tag：slim 中有没有类似haml_tag 的东西？

> ID：13495849
> 
> 赞同：3
> 
> 时间：2012-11-21T14:51:09.040
> 
> 标签：ruby-on-rails, ruby, slim-lang

在 HAML 中，我们有[haml_tag 助手](http://haml.info/docs/yardoc/Haml/Helpers.html#haml_tag-instance_method)。slim 中有 slim_tag 助手吗？有人实施了吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T16:55:52.460

您可以使用 Slim splat 属性来使用 *. 请参阅自述文件。

# java - Spring app对非spring webapp的响应

> ID：13495850
> 
> 赞同：1
> 
> 时间：2012-11-21T14:51:35.130
> 
> 标签：java, spring, http, jakarta-ee, web-applications

我有两个应用程序。一种是基于 servlet 的遗留 web 应用程序。另一个是基于spring的webapp。旧版应用程序的页面包含多个 jquery 选项卡。我希望其中一个选项卡充当基于 spring 的应用程序的 iframe。为了实现这一目标，我做了以下事情：

1.  单击选项卡名称后，向 spring 应用程序触发一个 http post 请求（通过打开和 http url 连接并将打印写入写入器）
2.  该请求包含有关遗留系统中用户的信息，使用在两个系统上共享的生成密钥进行加密
3.  配置spring mvc框架拦截对url的调用，调用一个方法处理请求。

理想情况下，请求处理应该执行以下操作：

1.  使用共享密钥解密请求数据
2.  验证请求、许可证等
3.  如果请求者被认为是真实的并且用户具有有效的许可证（使用 api 进行许可证验证），则为用户设置一个帐户并以编程方式对他们进行身份验证到 spring security
4.  生成随机身份验证密钥（用于将来的通信而不是共享密钥）
5.  将随机密钥发送回遗留系统（使用共享密钥加密）
6.  将用户定向到 spring 应用程序中的特定页面

`1`,`2`并且`3`是完整的，但我正在努力解决`4`and `5`。如何将第二个密钥发送到旧系统并让旧系统使用 a 读取它，`buffered reader`然后在选项卡中打开重定向页面？甚至可能在一个响应中？

我使用`@ResponseBody`返回密钥，但不知道如何发送重定向？ps如果有什么不清楚的可以随时问我

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T21:50:54.877

解决如下：

1.  旧应用程序上的选项卡页预加载了 iframe 但没有源，同时放置了一个带有隐藏字段但没有值的表单，该表单将 iframe 作为其目标，其操作指向 spring app url
2.  打开标签页时，将对遗留应用程序上的 servlet 执行 ajax 调用
3.  servlet 使用参数调用 /spring-url.do 上的 spring 应用程序。调用是通过打开一个 `HttpURLConnection` 来执行的。
4.  `/spring-url.do` 被 spring dispatcher 拦截，一个方法处理它如下：
5.  如果这是用户的第一次，则为他们生成一个新密钥并将其写入响应（它通过将请求转发到另一个返回类型为`@ResponseBody String`的控制器来实现）
6.  响应由旧应用程序 servlet 读取，密钥保存在旧应用程序数据库中以供将来通信
7.  servlet 使用新密钥加密用户数据并将其返回给 ajax 调用
8.  ajax 成功函数读取响应并设置隐藏表单字段的值并以编程方式提交表单
9.  spring 再次拦截 url，但这次是现有用户，因此它不会生成新密钥，而是验证数据并将请求转发到 spring 应用程序上的页面。

# java - 应用服务器和 Spring 上下文加载

> ID：13495854
> 
> 赞同：2
> 
> 时间：2012-11-21T14:52:01.827
> 
> 标签：java, spring, jakarta-ee, websphere

WebSphere Application Server 在其文档之一中有以下注释。我在耳朵级别有应用程序上下文，并使用`ClassPathXmlApplicationContext`它是`AbstractApplicationContext`. 但是，不建议这样做。我有哪些选择？我可以在耳朵级别利用哪些生命周期挂钩？此外，请包括任何陷阱或经验教训。

> 以下场景是要避免的 Spring Framework 场景示例：
> 
> registerShutdownHook
> 
> 避免使用 Spring Framework AbstractApplicationContext 类及其子类。这些类包括公共方法 registerShutdownHook，它创建一个线程并将其注册到 Java 虚拟机 (JVM) 以在关闭时运行以关闭应用程序上下文。作为替代方案，应用程序可以使用从应用程序服务器容器接收到的生命周期通知，在应用程序上下文中显式调用 close 方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T22:04:44.250

我会使用[Singleton Session Bean](http://pic.dhe.ibm.com/infocenter/wasinfo/v8r5/index.jsp?topic=%2Fcom.ibm.websphere.nd.multiplatform.doc%2Fae%2Ftejb_ssb.html)（在 WebSphere 8+ 的情况下）或[Startup Beans](http://pic.dhe.ibm.com/infocenter/wasinfo/v8r5/index.jsp?topic=%2Fcom.ibm.websphere.express.doc%2Fasyncbns%2Ftasks%2Ftasb_confstb.html)（对于较旧的 Websphere 版本），如[相关问题](https://stackoverflow.com/questions/12867743/how-to-create-a-lifecycle-listener-for-an-application-deployed-to-websphere-appl)中所述。

因为`Singleton Session Beans`您可以创建一个带有注释的方法，该方法`@PreDestroy`将[关闭](http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/context/support/AbstractApplicationContext.html#close())[AbstractApplicationContext](http://static.springsource.org/spring/docs/3.0.x/javadoc-api/org/springframework/context/support/AbstractApplicationContext.html)。

因为`Startup Beans`你可以在`stop()`方法中做同样的事情。

# jquery - 占位符在 IE 9 中不起作用，但在 chrome 中可以

> ID：13495861
> 
> 赞同：0
> 
> 时间：2012-11-21T14:52:36.420
> 
> 标签：jquery, html, internet-explorer

> **可能重复：**
> [ie9 中的占位符](https://stackoverflow.com/questions/6366021/placeholder-in-ie9)

[http://jsfiddle.net/zhshqzyc/mGAPs/](http://jsfiddle.net/zhshqzyc/mGAPs/)中的一个非常简单的测试

我的代码：

```
<div id="generatePinsDialog" >
<label for="newCount" style="width: 400px;">
    How many?</label>
<input id="newCount" type="text" size="25" placeholder="Enter the number!" />
<br /> 
```

和：

```
jQuery(function() {
     jQuery.support.placeholder = false;
     test = document.ElementById("newCount");
     if('placeholder' in test) jQuery.support.placeholder = true;
}); 
```

它适用于谷歌浏览器，但适用于 IE 9。

感谢您更正代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T14:59:08.793

placeholder 属性在 IE 中不起作用，仅在现代浏览器中起作用。不过，IE10 现在终于做到了。

大多数情况下，这样的事情可以在现代浏览器中使用，但您需要始终仔细检查它是否可以在 IE 中使用，这通常比其他浏览器晚几年。一个地方是[http://caniuse.com/](http://caniuse.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T15:05:42.727

假设您只想检查`placeholder`浏览器是否支持，您可以使用以下代码：

```
jQuery(function() {
     jQuery.support.placeholder = ( 'placeholder' in (document.createElement( 'input' )) );
}); 
```

除此之外，正如评论中提到的，IE9 不支持`placeholder`（参见[caniuse.com](http://caniuse.com/#feat=input-placeholder)）！

# c - 结构中的字符串始终相同

> ID：13495868
> 
> 赞同：0
> 
> 时间：2012-11-21T14:53:06.263
> 
> 标签：c

我有这个结构：

```
struct match {
    int round;
    int day, month, year;
    int hour, minutes;
    char *home_team;
    char *visitor_team;
    int home_score;
    int visitor_score;
    int number_of_spectators;
}; 
```

我有这个函数可以从文件中加载 som 值。

`struct match matches[198];`

`int get_matches_from_file(struct match *matches)`

我在 for 循环中用这个设置值：

```
int year, month, day, hour, minute;
int m_round;
int home_score, visitor_score;
char home[3], visitor[3];
int spectators;

sscanf(line[i], "%d %d.%d.%d kl.%d.%d %s - %s %d - %d %d", &m_round, &day, &month, &year, &hour, &minute, home, visitor, &home_score, &visitor_score, &spectators);

matches[i].round = m_round;
matches[i].day = day;
matches[i].month = month;
matches[i].year = year;
matches[i].hour = hour;
matches[i].minutes = minute;
matches[i].home_team = home;
matches[i].visitor_team = visitor;
matches[i].home_score = home_score;
matches[i].visitor_score = visitor_score;
matches[i].number_of_spectators = spectators; 
```

但是当我打印出结构时。All`home_team`和`visitor_team`strings 与我加载的文件中的最后一个相同。好像它们在循环结束时都被更改了。

这是`line[]`数组中最后一行的示例

`33 23.05.2012 kl. 20.00 AGF - FCM 0 - 2 12.139`

All `home_team`and`visitor_team`设置为`AGF`and`FCM`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T14:55:19.783

您只`char`为 home_team 和 visitor_team 分配了一个。在结构中使用 char 数组为字符串提供空间：

```
#define MAX_NAME_BYTES(32) /* include space for nul terminator */
struct match {
    int round;
    int day, month, year;
    int hour, minutes;
    char home_team[MAX_NAME_BYTES];
    char visitor_team[MAX_NAME_BYTES];
    int home_score;
    int visitor_score;
    int number_of_spectators;
}; 
```

然后使用`strcpy`将结果复制到结构中：

```
strcpy(matches[i].home_team, home);
strcpy(matches[i].visitor_team, visitor); 
```

或者，在您的结构中使用 char 指针（就像您现在在编辑的问题中所做的那样）并使用以下方式分配它们`strdup`：

```
matches[i].home_team = strdup(home);
matches[i].visitor_team = strdup(visitor); 
```

请注意，当您丢弃结构时，您需要释放这些字符串：

```
free(matches[i].home_team);
free(matches[i].visitor_team); 
```

# c# - 循环浏览文件夹中的 HTML 文件并通过 IE 将它们静默打印到默认打印机

> ID：13495870
> 
> 赞同：0
> 
> 时间：2012-11-21T14:53:16.707
> 
> 标签：c#

我正在尝试拼凑一小段控制台代码，以通过 Internet Explorer 将文件夹中的一些 HTML 文件打印到默认打印机。[我从http://weblogs.asp.net/israelio/archive/2004/06/23/162913.aspx](http://weblogs.asp.net/israelio/archive/2004/06/23/162913.aspx)找到了以下代码，这似乎几乎适合我的需求。

我做了一些改动，但我的编程技能非常有限。我正在寻找一些帮助以确保语法正确，并且有人向我展示如何通过 Internet Explorer 静默打印，而不是像我现在所相信的那样打开 Internet Explorer。

任何帮助将不胜感激...

```
using System
using System.IO

// How much deep to scan. (of course you can also pass it to the method)
const int HowDeepToScan=4; 

public static void ProcessDir(string sourceDir, int recursionLvl) 
{
if (recursionLvl<=HowDeepToScan)
{
// Process the list of files found in the directory. 
string [] fileEntries = Directory.GetFiles(@"C:\fileDump\", "*.html");  
foreach(string fileName in fileEntries)
{
   // do something with fileName
   System.Diagnostics.Process.Start(fileName);
}

// Recurse into subdirectories of this directory.
string [] subdirEntries = Directory.GetDirectories((@"C:\fileDump);
foreach(string subdir in subdirEntries)
   // Do not iterate through reparse points
   if ((File.GetAttributes(subdir) &
        FileAttributes.ReparsePoint) !=
            FileAttributes.ReparsePoint)

        ProcessDir(subdir,recursionLvl+1);
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T15:45:22.830

我有一个类似（但不同）的问题要解决，我使用的代码可能会对您有所帮助。

**我的问题的背景**

创建一个程序，用于打开文件（在本例中为 .MHTML 文件）实际上会用 IE 打开它，立即打印页面并关闭 IE

**代码**

```
 public partial class MainWindow : Window
    {
        const int PRINT_WAITFORCOMPLETION = 2;
        public MainWindow()
        {
            InitializeComponent();

            if (Application.Current.Properties["ArgFileName"] != null)
            {
                string fname = Application.Current.Properties["ArgFileName"].ToString();
                if (String.IsNullOrEmpty(fname))
                {
                    fileLabel.Content = "No File Specified";
                }
                else
                {
                    fileLabel.Content = fname;
                    SHDocVw.InternetExplorer IE = new SHDocVw.InternetExplorer();
                    IE.DocumentComplete +=new SHDocVw.DWebBrowserEvents2_DocumentCompleteEventHandler(IE_DocumentComplete);
                    IE.PrintTemplateTeardown += new SHDocVw.DWebBrowserEvents2_PrintTemplateTeardownEventHandler(IE_PrintTemplateTeardown);
                    IE.Visible = true;
                    IE.Navigate2(fname);    
                }      
            }
        }

       void IE_PrintTemplateTeardown(object pDisp)
        {
            if (pDisp is SHDocVw.InternetExplorer)
            {
                SHDocVw.InternetExplorer IE = (SHDocVw.InternetExplorer)pDisp;               
                IE.Quit();
                System.Environment.Exit(0);
            }
        }

       void IE_DocumentComplete(object pDisp, ref object URL)
        {
            if (pDisp is SHDocVw.InternetExplorer)
            {
                SHDocVw.InternetExplorer IE = (SHDocVw.InternetExplorer)pDisp;               
                IE.ExecWB(SHDocVw.OLECMDID.OLECMDID_PRINT, SHDocVw.OLECMDEXECOPT.OLECMDEXECOPT_DONTPROMPTUSER, 2);

            }
        }
    } 
```

**笔记**

一旦你把它合并到你的文件循环中，你需要改变它`IE.Visible = true;`以`IE.Visible = false;`防止 IE 窗口显示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-22T10:43:45.323

这个想法是让程序成为简单的命令行程序。

我找到了一种更简单的循环文件的方法，我认为您的代码已正确添加。但是，我认为从我得到的两个错误来看，我似乎已经看多了一些东西，你有什么建议吗？

理想情况下，我希望该程序保留为单个类。

我的错误是：

> 'Bulk_Pdf.Main.Main(string)'：静态构造函数必须是无参数的 (CS0132) - C:\Users\Ben\Desktop\bulkPrint_pdf.cs:16,18
> 
> 'Bulk_Pdf.Main.Main(string)'：静态构造函数上不允许访问修饰符 (CS0515) - C:\Users\Ben\Desktop\bulkPrint_pdf.cs:16,18

你有什么建议吗？

```
using System;
using System.IO;

namespace HTML_Print
{
class Main
{
    private static Main(string dirPath)
    {

        // Define Working Directory
        DirectoryInfo dir = new DirectoryInfo(@"C:\fileDump");

        // Define File Type
        foreach (FileInfo finfo in dir.GetFiles("*.html"))

        // Open IE Explorer and Print
        if (Application.Current.Properties["finfo"] != null)
        {
            string fname = Application.Current.Properties["finfo"].ToString();
            if (String.IsNullOrEmpty(fname))
            {
                fileLabel.Content = "No File Specified";
            }
            else
            {
                fileLabel.Content = fname;
                SHDocVw.InternetExplorer IE = new SHDocVw.InternetExplorer();
                IE.DocumentComplete +=new SHDocVw.DWebBrowserEvents2_DocumentCompleteEventHandler(IE_DocumentComplete);
                IE.PrintTemplateTeardown += new SHDocVw.DWebBrowserEvents2_PrintTemplateTeardownEventHandler(IE_PrintTemplateTeardown);
                IE.Visible = true;
                IE.Navigate2(fname);    
            }      
        }
    }

   void IE_PrintTemplateTeardown(object pDisp)
    {
        if (pDisp is SHDocVw.InternetExplorer)
        {
            SHDocVw.InternetExplorer IE = (SHDocVw.InternetExplorer)pDisp;               
            IE.Quit();
            System.Environment.Exit(0);
        }
    }

   void IE_DocumentComplete(object pDisp, ref object URL)
    {
        if (pDisp is SHDocVw.InternetExplorer)
        {
            SHDocVw.InternetExplorer IE = (SHDocVw.InternetExplorer)pDisp;               
            IE.ExecWB(SHDocVw.OLECMDID.OLECMDID_PRINT, SHDocVw.OLECMDEXECOPT.OLECMDEXECOPT_DONTPROMPTUSER, 2);

        }
    }
}

} 
```

# asp.net-mvc - 带循环的异步控制器动作

> ID：13495874
> 
> 赞同：3
> 
> 时间：2012-11-21T14:53:23.297
> 
> 标签：asp.net-mvc, async-await

我将如何编写一个由 1 +n 个异步调用 ( `await`) 组成的异步控制器操作？例如，假设我需要先检索对象`Foo`并且它具有可变数量的`Bars`标识符，并且我需要获取所有这些实体（为了这个问题，没有`fetchBarsByFooId`。我会使用`Task.WaitAll`还是可能`Parallel.For`？

```
public async Task<ActionResult> Bars(int id) {
    Foo foo = await this.FooProvider.GetFooAsync(id);
    var bars = new ConcurrentQueue<Bar>();

    // Sub-optimal version
    foreach (int barId in foo.BarIDs) {
        Bar bar = this.BarProvider.GetBar(barId);
        bars.Enqueue(bar)
    }

    // Fetch each bar asynchronously and pass them to the view.
    ....

    return View(bars.ToArray());
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T14:58:18.110

嗯，首先要解决的是你是否真的想要并行，或者只是异步。只是异步很简单：

```
var bars = new List<Bar>();
foreach (var id in foo.Bars)
{
    bars.Add(await BarProvider.GetBarAsync(id));
}
return View(bars); 
```

对于并行性，您可以使用[`Task.WhenAll`](http://msdn.microsoft.com/en-us/library/hh194766.aspx)：

```
var tasks = foo.Bars.Select(id => BarProvider.GetBarAsync(id));
var bars = await Task.WhenAll(tasks);
return View(bars); 
```

（我意识到这是比非并行版本更短的代码 - 但它在概念上更棘手。）

You should *not* use `Parallel.For` or `Task.WaitAll` as both of those are *blocking* calls - whereas `Task.WhenAll` returns you a task which will complete when all the subtasks have completed.

# regex - Grep 基于一行的前 12 个字符，但输出整行

> ID：13495882
> 
> 赞同：1
> 
> 时间：2012-11-21T14:53:41.667
> 
> 标签：regex, search, grep

我有一个文件（patterns.txt），其中包含一个以换行符分隔的模式列表，例如：

```
AAAA........
....CCCC....
........YYYY
ATCC 
```

我正在搜索的文件（table.txt）包含如下所示（大小为 120gb）：

```
ZZZZAAAAGTGT    0   1   12
AAAAGTGTAAYY    0   9   1
GGGGTTTTCCCC    1   0   0
HHHHHHHHYYYY    1   8   0
AAATCCCHHHHH    0   0   1 
```

我正在使用以下 grep 命令：

```
grep -f patterns.txt table.txt 
```

这将返回我的示例中的所有行。但是，如果我可以强制 grep 只查看前 12 个字符，则不会返回第一行和第三行（这是理想的）。

这个 grep 是一个更大程序的一部分。这意味着模式必须来自文件。但如果需要，我可以更改文件的内容。

我正在考虑用字符类 [ACGTHY] 替换所有点。这意味着模式**AAAA........**将变为：

**AAAA[ACGTHY][ACGTHY][ACGTHY][ACGTHY][ACGTHY][ACGTHY][ACGTHY][ACGTHY]**

这应该提供所需的结果，但它似乎很慢。有没有更好的方法来做到这一点？

编辑：我也在考虑用 \S 替换点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T23:26:04.457

你需要一些更强大的东西。尝试使用`awk`：

```
awk 'FNR==NR { a[$1]++; next } { for (i in a) if ($1 ~ i) print }' patterns table 
```

结果：

```
AAAAGTGTAAYY    0   9   1
HHHHHHHHYYYY    1   8   0
AAATCCCHHHHH    0   0   1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T14:58:08.793

你能修改patterns.txt吗？

在这种情况下，`^`在每行之前添加一个就可以了。只有当它们开始一行时，这才会匹配您的模式。

# c# - System.Data.SQLite.DLL 切换目标框架后不再加载

> ID：13495887
> 
> 赞同：3
> 
> 时间：2012-11-21T14:53:52.097
> 
> 标签：c#, sqlite, .net-4.0, reference, .net-4.5

我不得不从 .net 4.5 切换到 .net 4.0，因为我的一些客户仍在使用 WinXP。现在，切换后，这是我得到的错误：

```
Could not load file or assembly 'System.Data.SQLite, 
Version=1.0.66.0, Culturre-neutral, PublicKeyToken=db937bc2d44ff139' or one of its dependencies.  
An attempt was made to load a program with an incorrect format. 
```

我一直无法找到解决方案，但这是我迄今为止尝试过的：

1.  切换回 4.5 - 无效
2.  再次添加参考 - 无效

有人知道解决方案吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T15:34:07.653

解决此问题的正确方法是从[http://system.data.sqlite.org](http://system.data.sqlite.org)为您的目标框架下载 SQLite 库的更新版本。

您使用的旧 System.Data.SQLite 程序集是针对 .NET 2.0 的混合代码程序集。.NET 4 下的默认策略是不允许加载此类程序集，但您可以通过在 MyApp.exe.config 文件中添加类似内容来明确允许它用于进程：

```
<?xml version="1.0"?>
<configuration>
  <startup useLegacyV2RuntimeActivationPolicy="true">
    <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.0,Profile=Client"/>
  </startup>
</configuration> 
```

请注意，更改可能会破坏其他内容。

[这个 StackOverflow 问题](https://stackoverflow.com/questions/3179028/mixed-mode-assembly-in-net-4)涵盖了类似的基础：

# simplexml - 使用 simplexml 获取子属性

> ID：13495892
> 
> 赞同：1
> 
> 时间：2012-11-21T14:53:58.983
> 
> 标签：simplexml

xml 数据如下所示：

```
<feed>    
    <entry>
        <abc:rank scheme="http://foo.bar">45</abc:rank>
        <abc:rank scheme="http://foo2.bar">88</abc:rank>
    </entry>
    <entry>
        <abc:rank scheme="http://foo.bar">125</abc:rank>
        <abc:rank scheme="http://foo2.bar">32</abc:rank>
    </entry>
</feed> 
```

我可以使用以下代码输出所有这些条目：

```
foreach($xml->entry[$i]->children('abc', true) as $a) {
    echo $a;
} 
```

但是，如果我想在第一个条目中获得内容为“88”的内容，例如

```
foreach($xml->entry[$i]->children('abc', true) as $a) {
    if($a["scheme"] == "http://foo2.bar")
        echo $a;
} 
```

不起作用。

如何根据他们的属性选择这些孩子？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T15:16:41.860

好的，我现在明白了。对于那些对正确解决方案感兴趣的人：

```
 $namespaces = $xml->entry[$i]->getNameSpaces('true');
    $abc= $xml->entry[$i]->children($namespaces['abc']);
    foreach($abc->rank as $a) {
        $scheme = $a->attributes();
        echo $scheme['scheme'];
        echo " - ";
    } 
```

# android - 默认的 Android EditText 突出显示颜色不是橙色

> ID：13495895
> 
> 赞同：2
> 
> 时间：2012-11-21T14:54:12.873
> 
> 标签：android, android-edittext, android-theme

我在 Android 4.1.2 上使用 EditText，没有任何样式，没有属性 android:background，什么都没有。它是使用 Eclipse 布局编辑器创建的纯 EditText：

```
<EditText
    android:id="@+id/editTextCommand"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentBottom="true"
    android:layout_alignParentLeft="true"
    android:layout_alignTop="@+id/Send"
    android:ems="10"
    android:inputType="text" >
</EditText> 
```

But when selected the highlight color is not orange. EditText 的底部只有一条小蓝线。如何激活默认的橙色边框？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T14:56:17.820

这对于 Holo Theme 来说很正常。将您的主题更改为`@android:style/Theme`或`Theme.Light`获得该外观。

# javascript - 通过 Ajax 添加脚本

> ID：13495896
> 
> 赞同：0
> 
> 时间：2012-11-21T14:54:18.420
> 
> 标签：javascript, ajax

我有一个 ajax 脚本，可以下载服务器的拉数据，其中包含一些 javascript 代码。响应被放入`innerHTML`目标 div 中。之后，脚本会扫描包含任何脚本标签的新 html 的 div。

这是它开始停止工作的地方。最初，我尝试将每个脚本添加到头部，它成功了，但没有加载任何外部引用的脚本（即 src="test.js"），也没有运行任何新代码。

我的下一个尝试是运行每个脚本项，然后使用`eval`on `script.text`，它成功执行了已解析的脚本，但仍然没有加载任何外部引用的脚本。

有人对接下来要尝试什么有任何建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T15:04:43.193

我使用 jQuery，你可以使用这个调用：

```
$.getScript("test.js", function(data, textStatus, jqxhr) {
   console.log(data); //data returned
}); 
```

你可以在这里找到文档：http: [//api.jquery.com/jQuery.getScript/](http://api.jquery.com/jQuery.getScript/)

或使用 Mootools：

```
Asset.javascript("test.js"); 
```

您可以在此处找到文档：http: [//mootools.net/docs/more/Utilities/Assets](http://mootools.net/docs/more/Utilities/Assets)

# c# - DataGridView DataError 事件保留无效行

> ID：13495900
> 
> 赞同：5
> 
> 时间：2012-11-21T14:54:56.400
> 
> 标签：c#, winforms, datagridview

我正在开发一个显示绑定到某个数据库表的 DataGridView 的 Winforms 应用程序。

它允许在其中插入新条目，并进行一些数据验证。

当必填列留空或违反其中一个唯一约束时，DataError 事件将调用此函数：

```
protected void _data_error(object sender, DataGridViewDataErrorEventArgs e)
{
    MessageBox.Show(this,e.Exception.Message,"Error");
    e.ThrowException = false;
    e.Cancel = false;
} 
```

当弹出窗口关闭时，正在编辑的新行将被删除。
当对已保存的行（更新操作）执行此操作时，该行将丢失其更改并失去焦点。我认为这意味着我需要向应用程序发出信号以保持行可编辑，但我不知道该怎么做。

矛盾的是，如果我用一个异常替换事件处理程序，`throw(e.Exception)`异常就会被抛到风中并被未捕获的异常处理程序拾取，但在该窗口关闭后新行被保留。

如何在 DataError 事件中保留新行？

编辑：

我的下一个想法是保存该行并在 MessageBox 弹出后将其添加到 DataGridView 的数据源中。这不起作用，因为将数据添加到数据源会将其添加为已*提交*的行，这会因为无效数据而引发异常，而不是将数据保留为*可编辑*行，这样就不会发生验证。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-26T21:11:51.240

花了我几天时间，但这是我修复它的方法，但我仍然愿意寻求更好的方法。

在[DataGridView.RowValidating](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.rowvalidating.aspx)事件中，验证每个单元格的内容。如果无效，请执行以下操作：

```
Grid.Rows[e.RowIndex].ErrorText = "Concisely describe the error and how to fix it";
e.Cancel = true; 
```

并确保在下一次通过事件处理程序时清除错误文本。

对于用户输入无效数据类型的情况，例如将文本输入到仅限数字的列中，您必须在[DataGridView.DataError](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.dataerror.aspx)事件中处理错误。使用相同的代码：

```
Grid.Rows[e.RowIndex].ErrorText... 
```

但无需清除 ErrorText，因为您的行验证事件会处理它。

**注意：**这不会让您有弹出窗口来通知用户出了什么问题，它将使用 DataGridView 错误，这是网格左侧的红色感叹号，鼠标悬停文本显示您填写的 ErrorText。每当您有`MessageBox`弹出窗口时，它就会出现，您将失去对可编辑数据的关注并丢失该行。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-04-01T09:45:34.320

来自 MSDN

```
private void DataGridView1_DataError(object sender, DataGridViewDataErrorEventArgs anError)
{
MessageBox.Show(anError.RowIndex + " " + anError.ColumnIndex);
MessageBox.Show("Error happened " + anError.Context.ToString());

if (anError.Context == DataGridViewDataErrorContexts.Commit)
{
    MessageBox.Show("Commit error");
}
if (anError.Context == DataGridViewDataErrorContexts.CurrentCellChange)
{
    MessageBox.Show("Cell change");
}
if (anError.Context == DataGridViewDataErrorContexts.Parsing)
{
    MessageBox.Show("parsing error");
}
if (anError.Context == DataGridViewDataErrorContexts.LeaveControl)
{
    MessageBox.Show("leave control error");
}

if ((anError.Exception) is ConstraintException)
{
    DataGridView view = (DataGridView)sender;
    view.Rows[anError.RowIndex].ErrorText = "an error";
    view.Rows[anError.RowIndex].Cells[anError.ColumnIndex].ErrorText = "an error";

    anError.ThrowException = false;
}
} 
```

# javascript - 在 Ext JS4 中使用“覆盖”调用

> ID：13495901
> 
> 赞同：0
> 
> 时间：2012-11-21T14:55:00.617
> 
> 标签：javascript, extjs4

带有“覆盖”的调用是什么意思，如下所示：

```
Ext.form.HtmlEditor.overrides.setReadOnly.call(this, readOnly); 
```

这用于：

```
Ext.override(Ext.form.HtmlEditor, {
    setReadOnly: function (readOnly) {
        // some code...
        Ext.form.HtmlEditor.overrides.setReadOnly.call(this, readOnly);
    } 
```

为什么 CallParent 不能在这里使用，“覆盖”是什么意思，我在 Sencha 文档中没有找到该属性？我没有在任何地方定义“覆盖”。

# odata - OData 查询 $filter 条件和区分大小写

> ID：13495905
> 
> 赞同：27
> 
> 时间：2012-11-21T14:55:07.443
> 
> 标签：odata, case-sensitive

OData 是否指定字符串字段上的过滤条件是区分大小写还是不区分大小写？

示例：（来自文档）

```
/Suppliers?$filter=Address/City eq 'Redmond' 
```

这是否需要区分大小写？

如果我想提供两种选择，如何表达？有一个 tolower() 函数可以像这样使用：

```
/Suppliers?$filter=tolower(Address/City) eq 'redmond' 
```

或者

```
/Suppliers?$filter=tolower(Address/City) eq tolower('Redmond') 
```

难道没有更简洁的方式来表达不区分大小写的匹配吗？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-11-21T18:26:07.770

“eq”运算符应该区分大小写。使用 tolower（或 toupper）是目前推荐的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-24T08:05:50.190

我希望这取决于您的数据库排序规则设置，因为 odata 服务只是执行查询。如果 Vitek 的回答是正确的，那么 odata 正在对结果集进行一些查询后过滤，这应该很奇怪，对吧？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-13T10:48:14.933

它不依赖于数据库。即使您以不区分大小写的方式对数据库执行查询，OData 也会自己进行额外的过滤并过滤掉您的数据。

# android - 以编程方式配置外部 android 小部件

> ID：13495907
> 
> 赞同：0
> 
> 时间：2012-11-21T14:55:10.117
> 
> 标签：android, android-widget

我正在尝试将一些外部小部件添加到我的活动中，如此链接中所述 [我可以将已安装应用程序中的小部件添加到我的应用程序活动中吗](https://stackoverflow.com/questions/13481503/can-i-add-widgets-from-installed-apps-to-my-application-activity)

它工作正常，但每次我启动应用程序时，它都会启动小部件的配置屏幕。有没有办法保存一次配置信息或从代码动态配置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T20:17:44.603

最后我想出了如何做到这一点。您只能在系统应用程序中以编程方式添加小部件。否则，您始终必须使用小部件选择器意图。我将我的应用程序作为系统应用程序，并且它有效

# android - 活动通过 onDestroy() 后如何恢复警报对话框？

> ID：13495915
> 
> 赞同：2
> 
> 时间：2012-11-21T14:55:35.040
> 
> 标签：android, android-alertdialog

```
package com.example.test3;

import java.util.HashMap;

import android.os.Bundle;
import android.app.Activity;
import android.app.AlertDialog;
import android.app.DialogFragment;
import android.app.FragmentManager;
import android.content.Context;
import android.content.DialogInterface;
import android.content.SharedPreferences;
import android.util.Log;
import android.view.Menu;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;

public class Test3 extends Activity {

    Button testShowPinDialogButton;
    public AlertDialog alertCreate;
    AlertDialog.Builder alert;
    private HashMap<String, Boolean> pinDialogState;
    EditText input;
    Context context;
    private String tag = "Test3";
    private String click1 = "click1";
    private SharedPreferences sharedPreferences;
    private SharedPreferences.Editor editor;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_test3);
        context = this;
        sharedPreferences = context.getSharedPreferences(click1, MODE_PRIVATE);
        editor = sharedPreferences.edit();
        testShowPinDialogButton = (Button) findViewById(R.id.testShowPinDialogBbutton);
        testShowPinDialogButton.setOnClickListener(showPinDialog);
        pinDialogState = new HashMap<String, Boolean>();
        Log.d(tag, "onCreate()");
    }

    private OnClickListener showPinDialog = new OnClickListener() {

        @Override
        public void onClick(View v) {
            launchDialog();
        }
    };

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.activity_test3, menu);
        return true;
    }

    protected void launchDialog() {
        alert = new AlertDialog.Builder(context);
        alert.setTitle("Title");
        alert.setMessage("Message");

        alert.setPositiveButton("Ok", new DialogInterface.OnClickListener() {
            public void onClick(DialogInterface dialog, int whichButton) {

            }
        });

        alert.setNegativeButton("Cancel",
                new DialogInterface.OnClickListener() {
                    public void onClick(DialogInterface dialog, int whichButton) {
                        dialog.dismiss();
                    }
                });

        Log.d(tag, "launchDialog()");
        alertCreate = alert.create();
        alertCreate.show();
    }

    @Override
    protected void onPause() {
        super.onPause();
        Log.d(tag, "onPause()");
        if (alertCreate != null) {
//          alertCreate.dismiss();
            editor.putBoolean(click1, true);
            editor.commit();
        }
    }

    @Override
    protected void onRestart() {
        super.onRestart();

    }

    @Override
    protected void onResume() {
        // TODO Auto-generated method stub
        super.onResume();
        Log.d("Test3", "onResume()");
        boolean isShown = sharedPreferences.getBoolean(click1, false);
        if (isShown) {
//          alertCreate.show();
//          launchDialog();
        }
    }

    @Override
    protected void onDestroy() {
        super.onDestroy();
        Log.d("Test3", "onDestroy()");
    }

} 
```

如果我回家，警报对话框会留在那里。因此，如果我单击显示对话框按钮，然后返回并返回应用程序，对话框仍然存在。但是，如果我打开开发人员选项下的“不保留活动”选项，则警报对话框不存在。有可能把它留在那里吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T15:29:59.480

执行此操作的最简单方法（但现在已弃用）是使用`showDialog(int)`和覆盖该`onCreateDialog(int)`方法并提供您的自定义实现。如果您的活动被重新创建（例如方向切换），这将显示您的对话框（duh）并重新显示它。

[原始（非片段）对话框教程](http://www.vogella.com/articles/AndroidDialogs/article.html)

一旦你得到这个工作，你可能想尝试使用`DialogFragment`它，这是前进的方式。

[现代片段对话框的文档](http://developer.android.com/guide/topics/ui/dialogs.html)

# php - php 中的 Json_encode/decode

> ID：13495916
> 
> 赞同：0
> 
> 时间：2012-11-21T14:55:45.697
> 
> 标签：php, json, codeigniter, serialization

我在视图上有一个`$all_set`包含一些 id 的数组。现在我想使用表单提交在控制器中传递这个数组。因为我使用了 j 儿子编码和解码。

在我看来：

```
<?php $all_set=json_encode($all_set); ?>

<input type="hidden" name="all_set" value="<?php echo serialize($all_set); ?>"> 
```

上面的值包含（正如我在页面源代码中看到的）：

```
<input type="hidden" name="all_set" value="s:26:"{"0":"1","5":"2","13":"3"}";"> 
```

现在在控制器上：

```
$result=$this->input->post('all_set');

           $result= unserialize($result);
           $result=json_decode($result);
           print_r($result); die; 
```

这给了我错误，我没有在控制器上得到任何数组。错误：

```
Message: unserialize() [function.unserialize]: Error at offset 0 of 5 bytes 
```

为什么会这样？请帮忙。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T14:57:57.017

您必须添加`htmlspecialchars()`到您的序列化中。

```
<input type="hidden" name="all_set" value="<?php echo htmlspecialchars(serialize($all_set)); ?>"> 
```

**编辑**

为什么这能解决问题？让我们先看看 OP 的引用输出：

```
value="s:26:"{"0":"1","5":"2","13":"3"}";">
      ^     ^ 
```

我添加`^`以标记问题来源 - 您的值包含引号，这使浏览器看到此输入的情况更像这样：

```
value="s:26:" {"0" "1" , "5" : "2","13":"3"}";"> 
```

一旦找到匹配，它就简单地关闭字符串`"`。HTML 中有一些特殊字符，包括`<`, `>`, `&`，`"`如果希望它们按字面意思传递，则必须将它们转换为实体。因此，通过调用`htmlspecialchars()`我们转换所有这些字符，标记将如下所示：

```
value="s:26:&quot;{&quot;0&quot;:&quot;1&quot;,&quot;5&quot;..... 
```

浏览器现在可以正确解释、正确显示并正确发送回，但不将其视为标记的一部分。

**编辑 2**

事实上，反序列化在您的代码中非常有用。完全摆脱`serialize()`/ `unserialize()`- 你的 json 编码数据只是纯字符串，所以你只需要`htmlspecialchars()`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T15:01:01.653

尝试

```
<input type="hidden" name="all_set" value="<?php echo base64_encode($all_set); ?>">

$result= base64_decode($result);
$result=json_decode($result); 
```

# javascript - 使用 html 5 缓存清单时如何以编程方式更新页面服务器端而不更改缓存清单？

> ID：13495917
> 
> 赞同：2
> 
> 时间：2012-11-21T14:55:52.607
> 
> 标签：javascript, html, spring, jquery-mobile, cache-manifest

我有一个应用程序，它具有不同角色的不同界面

如果用户更改角色，我想缓存应用程序并更新它

示例：
角色用户 --> www.sample.com/index.jsp（用户版）
角色管理员 --> www.sample.com/index.jsp（管理员版）

案例 1：如果 user1 使用 Role User 访问 www.sample.com/index.jsp 并且他之前的连接是使用 Role User ---> 使用缓存版本

案例 2：如果 user1 使用 Role Admin 访问 www.sample.com/index.jsp 并且他之前的连接是使用 Role User ---> 更新缓存

我正在使用 jquery mobile、html 5、Java/Spring

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T15:09:20.637

你不能。要更新缓存，必须更改清单，文件中至少有一个字节。一旦站点被缓存，客户端只会重新加载清单本身以检查它是否已更改。如果没有，则使用缓存的数据。如果已更改，则“CACHE”下列出的所有资源都将被加载和缓存。

要执行您的计划，您很可能需要一个动态清单，以便您可以将其发送回略有不同，具体取决于管理员是否请求用户。根据管理员或用户动态更改清单的一种可能方法是在服务器端有两个单独的清单文件。将通过单个 URL 请求它们。服务器检查用户是否是管理员（不管你这样做）并返回正确的清单文件。这样，只有当用户从管理员更改为客户端或以其他方式更改时，才会重新加载缓存。

# xml - 使用换行符自动格式化的 XML 文件

> ID：13495919
> 
> 赞同：1
> 
> 时间：2012-11-21T14:56:04.510
> 
> 标签：xml, xml-parsing

我有一个没有输入返回空格的 xml 文件。是否有一个程序可以自动格式化带有返回空格和缩进的 xml 文件，以便 xml 文件更具可读性，并且我不必经历并点击输入一百万次？如果是这样，你如何使用它？目前我正在 Notepad++ 中查看该文件，但找不到任何选项可以为我执行此操作。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-10T15:43:54.670

In Eclipse IDE, you can do ctrl+shift+f, which will format your code, or xml file, to the default formatting. I'm not sure about Notepad++.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T15:01:35.357

为此，我去了“插件”，然后是“插件管理器”，然后是“显示插件管理器”，并浏览了 XML 工具。然后我按照此链接的指示进行操作。[http://sourceforge.net/p/notepad-plus/discussion/813349/thread/77255855](http://sourceforge.net/p/notepad-plus/discussion/813349/thread/77255855)说去插件，XML 工具，Pretty Print XML 只有换行符。

# objective-c - 滑动但没有点击

> ID：13495920
> 
> 赞同：0
> 
> 时间：2012-11-21T14:56:07.083
> 
> 标签：objective-c, xcode, macos, cocoa, nswindow

我有一个透明窗口，我想用它来捕捉滑动。

设置`setAcceptTouchEvents=True`并且`setIgnoreMouseEvents=false`似乎也忽略了滑动。仅注册鼠标进入或离开事件。

我需要的是捕捉滑动的窗口，但让点击通过。

如果有人知道我怎么能意识到这一点，我将不胜感激？（虽然是沙盒）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T20:40:02.570

确保您的视图具有第一响应者，并且您实际上覆盖了正确的方法。

您应该重写该`swipeWithEvent:`方法，如前所述。

# java - Java的字符集/字符编码

> ID：13495924
> 
> 赞同：3
> 
> 时间：2012-11-21T14:56:16.317
> 
> 标签：java, character-encoding, non-ascii-characters

我有一个西班牙语文件，所以它充满了如下字符：

```
 á é í ó ú ñ Ñ Á É Í Ó Ú 
```

我必须阅读文件，所以我这样做：

```
fr = new FileReader(ficheroEntrada);
BufferedReader rEntrada = new BufferedReader(fr);

String linea = rEntrada.readLine();
if (linea == null) {
logger.error("ERROR: Empty file.");
return null;
} 
String delimitador = "[;]";
String[] tokens = null;

List<String> token = new ArrayList<String>();
while ((linea = rEntrada.readLine()) != null) {
    // Some parsing specific to my file. 
    tokens = linea.split(delimitador);
    token.add(tokens[0]);
    token.add(tokens[1]);
}
logger.info("List of tokens: " + token);
return token; 
```

当我阅读令牌列表时，所有特殊字符都消失了，并被这种字符取代：

```
Ó = Ã“
Ñ = Ã‘ 
```

等等...

发生了什么？我从来没有遇到过字符集问题（我假设是字符集问题）。是因为这台电脑吗？我能做些什么？

任何额外的建议将不胜感激，我正在学习！谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T15:00:13.300

您需要指定相关的字符编码。

```
BufferedReader rEntrada  = new BufferedReader(
    new InputStreamReader(new FileInputStream(fr), "UTF-8")); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-21T15:42:28.720

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-21T14:59:23.317

您的默认编码错误。您可能需要阅读 UTF8 或 latin1。请参阅此代码段以设置流的编码。另请参见[Java，默认编码](https://stackoverflow.com/questions/1128617/java-default-encoding)

```
public class Program {

    public static void main(String... args)  {

        if (args.length != 2) {
            return ;
        }

        try {
            Reader reader = new InputStreamReader(
                        new FileInputStream(args[0]),"UTF-8");
            BufferedReader fin = new BufferedReader(reader);
            Writer writer = new OutputStreamWriter(
                       new FileOutputStream(args[1]), "UTF-8");
            BufferedWriter fout = new BufferedWriter(writer);
            String s;
            while ((s=fin.readLine())!=null) {
                fout.write(s);
                fout.newLine();
            }

            //Remember to call close. 
            //calling close on a BufferedReader/BufferedWriter 
            // will automatically call close on its underlying stream 
            fin.close();
            fout.close();

        } catch (IOException e) {
            e.printStackTrace();
        }

    }
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-21T15:07:45.537

根据我的经验，应该根据西方编码读取和写入文本文件：ISO-8859-1。

BufferedReader rEntrada = new BufferedReader(new InputStreamReader(new FileInputStream(fr), "ISO-8859-1"));

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-21T15:07:50.133

其他答案为您提供了正确的方向。只是想用它的[Files.newReader(File,Charset)](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/io/Files.html#newReader%28java.io.File,%20java.nio.charset.Charset%29)辅助方法添加[Guava使得创建这样一个](http://code.google.com/p/guava-libraries/)[BufferedReader](http://docs.oracle.com/javase/7/docs/api/java/io/BufferedReader.html)变得非常可读（请原谅双关语）：

```
BufferedReader rEntrada = Files.newReader(new File(ficheroEntrada), Charsets.UTF_8); 
```

# objective-c - 为什么我的获取请求在使用 NSExpression max: 时会导致异常？

> ID：13495929
> 
> 赞同：1
> 
> 时间：2012-11-21T14:56:21.470
> 
> 标签：objective-c, ios, core-data, nsfetchrequest

我正在执行*获取请求*，使用**NSPredicate**从初始选择中消除一些对象，然后使用**NSExpression仅检索***托管对象*的日期属性的最大值。[我使用的代码与 Apple 在其示例（ Apple Developer](http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CoreData/Articles/cdFetching.html#//apple_ref/doc/uid/TP40002484-SW6) ）中给出的代码完全相同，但是，似乎这个表达式以某种方式考虑了我希望将最大值作为*数组*的属性，所以每次我执行*fetch*时，应用程序因“*无法识别的选择器*”异常而崩溃（尝试将*计数*消息发送到**__NSDate**实例）。如果我将属性名称更改为*字符串属性，那么对于***__NSCFString**实例或等效实例，我会得到相同的异常），这对我来说意味着它正在查找对象并使用正确的属性，但不知何故，该表达式未正确应用。

我的代码是：

```
NSFetchRequest *request = [[NSFetchRequest alloc] init];
NSEntityDescription *entity = [NSEntityDescription entityForName:@"BridgeOpening" inManagedObjectContext:managedObjectContext];
[request setEntity:entity];
request.predicate = [NSPredicate predicateWithFormat:@"lastUpdated != nil && bridge.location == %@", location];

// Specify that the request should return dictionaries.
[request setResultType:NSDictionaryResultType];

// Create an expression for the key path.
NSExpression *keyPathExpression = [NSExpression expressionForKeyPath:@"lastUpdated"];

// Create an expression to represent the maximum value at the key path 'creationDate'
NSExpression *maxExpression = [NSExpression expressionForFunction:@"max:" arguments:[NSArray arrayWithObject:keyPathExpression]];

// Create an expression description using the maxExpression and returning a date.
NSExpressionDescription *expressionDescription = [[NSExpressionDescription alloc] init];

// The name is the key that will be used in the dictionary for the return value.
[expressionDescription setName:@"maxDate"];
[expressionDescription setExpression:maxExpression];
[expressionDescription setExpressionResultType:NSDateAttributeType];

// Set the request's properties to fetch just the property represented by the expressions.
[request setPropertiesToFetch:[NSArray arrayWithObject:expressionDescription]];

// Execute the fetch.
NSError *error = nil;
NSLog(@"executing fetch");
NSArray *objects = [managedObjectContext executeFetchRequest:request error:&error];
NSLog(@"fetch finished");
if (objects == nil) {
    // Handle the error.
}
else {
    if ([objects count] > 0) {
        NSLog(@"Minimum date: %@", [[objects objectAtIndex:0] valueForKey:@"maxDate"]);
        lastUpdate = [[objects objectAtIndex:0] valueForKey:@"maxDate"];
    }
} 
```

永远不会到达“获取完成”日志，因此异常肯定是由执行*获取请求*引起的。

有没有人知道为什么无论表达式正在做什么似乎都期望一个**NSArray**，或者知道我做错了什么？我应该补充一点，如果我在没有*表达式*（和**NSManagedObjectResultType ）的情况下执行***获取请求*，则没有问题，并且如果我的*谓词在应用**表达式*之前没有结果，那么就没有问题。

 *****[我认为这可能与本文](https://stackoverflow.com/questions/1927981/calculating-the-max-value-for-a-core-data-attribute-nscfnumber-error)中遇到的问题相同，但是没有公认的解决方案，并且原始发帖人给出的答案是不可接受的（使用**NSManagedObjectResultType**而不是**NSDictionaryResultType**，我认为这完全绕过了*表达式*，并且几乎可以肯定否定使用*表达式*的记忆优势。

**编辑：** 我最初忘记说明这一点，但无论我是否使用带有*fetch request的**谓词*，我都有同样的问题。*****

# jquery-ui - 用于移动设备的 jQuery Themeroller 库

> ID：13495930
> 
> 赞同：15
> 
> 时间：2012-11-21T14:56:21.823
> 
> 标签：jquery-ui, jquery-mobile, themeroller

是否有一个现有的预制主题库可供 jQuery Mobile 下载，就像它们用于[jQuery UI](http://jqueryui.com/themeroller/)一样？我确实环顾了[jQuery Mobile Themeroller](http://jquerymobile.com/themeroller/index.php)，但找不到它（我知道您可以从 Adob​​e kuler 色板中拖放颜色，但我不太热衷于此）。

# c++ - 作为对象成员或模板参数的不同行为

> ID：13495931
> 
> 赞同：2
> 
> 时间：2012-11-21T14:56:31.263
> 
> 标签：c++, templates

我试图为成员函数指针创建一个模板助手，主要思想是能够做这样的事情：

```
template <typename T, typename R> struct TStruct
{
    typedef T value_type;
    typedef R return_type;

    R Function(T &);
};

struct Struct
{
    int Function(const int &);
};

typedef TStruct<const int &, int> A;

FunctionPointer<A, A::return_type, A::value_type>::pointer p = &A::Function;
typedef FunctionPointer<Struct, int, const int &>::pointer FPointer; 
```

这样做时，我意识到在没有帮助器的情况下声明指针更短（现在这不是问题；）但它使我陷入了一个我不理解的错误。假设我们有两个版本的助手：

```
template <typename Type, typename Return, typename Parameter> struct Good
{
    typedef Return (Type::*pointer)(Parameter);
};

template <typename Type, typename Return, typename Parameter, Return (Type::*Pointer)(Parameter)> struct Bad
{
    typedef Parameter pointer;
}; 
```

一种将`Good`指向成员函数类型的指针定义到结构体中，`Bad`另一种将其定义到模板参数中，然后将`typedef`其定义到结构体中。

使用`Good`struct 我的测试程序编译：

```
int main(int argc, char **argv)
{
    // No compilation errors
    Good<A, A::return_type, A::value_type>::pointer GoodTStructPtr = &A::Function;
    Good<Struct, int, const int &>::pointer GoodStructPtr = &Struct::Function;

    return 0;
} 
```

但是如果使用`Bad`struct，就会出现编译错误：

```
int main(int argc, char **argv)
{
    // invalid initialization of reference of type ‘const int&’
    // from expression of type ‘int (TStruct<const int&, int>::*)(const int&)’
    Bad<A, A::return_type, A::value_type, &A::Function>::pointer BadTStructPtr = &A::Function;

    // invalid initialization of reference of type ‘const int&’
    // from expression of type ‘int (Struct::*)(const int&)’
    Bad<Struct, int, const int &, &Struct::Function>::pointer BadStructPtr = &Struct::Function;

    return 0;
} 
```

AFAIK，`Good::pointer`并且`Bad::pointer`都是这种类型`Return (Type::*)(Parameter)`，因此它们必须能够指向`&A::Function`or `Struct::Function`，但我显然错了，但我不知道为什么。在将类型声明为模板化对象主体以及将其声明为模板参数时，*似乎*存在不同的行为。

所以问题是：**为什么不能使用指向or的`Bad::pointer`as 函数指针`&A::Function``&Struct::Function`**？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T15:07:01.467

你的意思是？

```
template <typename Type, 
          typename Return, 
          typename Parameter, 
          Return (Type::*Pointer)(Parameter)> struct Bad
{
    typedef Pointer pointer;
    //      ^^^^^^^ (not Parameter)
}; 
```

# html - 在 CSS 下拉菜单中单击后，从链接中删除焦点

> ID：13495932
> 
> 赞同：2
> 
> 时间：2012-11-21T14:56:30.950
> 
> 标签：html, css

我有一个 css 下拉菜单（如下），但是，我的问题是，一旦单击了下拉菜单选项（链接），这很讨厌，即。图 7 留下了一个未经处理的矩形细虚线焦点，该焦点在单击菜单选项后很久才出现。单击链接后如何删除链接的焦点？

```
 <div id="menu" style="width: 1001px; height: 20px">
    <ul>
    <li><a href="#nogo"><div id="file">File</div></a>
    <ul>
    <li><a href="#nogo" onclick="window.print()"><div id="print">Print</div></a></li>
    <li><a href="#nogo" onclick="sims_update()"><div id="save">Save</div></a></li>
    <li><a href="#nogo" onclick="sims_update('s');window.close()"><div id="saveandexit">Save & Exit</div></a></li>
    <li><a href="#nogo" onclick="window.close()"><div id="exit">Exit</div></a></li>
    </ul>
    </li>
    <li><a href="#nogo"><div id="edit">Edit</div></a>
    <ul>
    <li><a href="#nogo" onclick="sims_addnew();return false"><div id="addnew">Add new</div></a></li>
    <li><a href="#nogo"><div id="delete">Delete</div></a></li>
    <li><a href="#nogo" onclick="sims_reset()"><div id="clear">Clear Form</div></a></li>
    </ul>
    </li>
    <li><a href="#nogo"><div id="view">View</div></a>
    <ul>
    <li><a href="#nogo"><div id="goto_first">&gt;&gt; Go to First</div></a></li>
    <li><a href="#nogo"><div id="goto_next">&gt;Go to Next</div></a></li>
    <li><a href="#nogo"><div id="goto_prev">Go to Previous&gt;</div></a></li>
    <li><a href="#nogo"><div id="goto_last">Go to Last&gt;&gt;</div></a></li>
    </ul>
    </li>

    <li><a href="#nogo"><div id="reports">Reports</div></a>
    <ul>
    <li><a href="#nogo"><div id="export_excel">Export to Excel Table</div></a></li>
    <li><a href="#nogo"><div id="export_html">Export to HTML Table</div></a></li>
    <li><a href="#nogo" onclick="sims_compile_htmllist()"><div id="export_list">Export to HTML List</div></a></li>
    </ul>
    </li>

    <li><a href="#nogo"><div id="logoff">Logoff</div></a></li>

    </ul>
    <ul>
    </div>

</div> 
```

CSS：

```
/*HORIZONTAL DROP-DOWN MENU */
#menuwrapper{
    position: fixed;
    top: 30px;
    left: 0px;

    background-color: #A9BBD3;
    height: 19px;
    color: #FFFFFF;
    font-size: 8pt;
    padding-top: 1px;
    padding-left: 3px;
    border-top: 1px solid #FFF;
    width: 100%;

}

#menu{
    padding:0;
    margin:0;
    position: fixed;
    top: 31px;
    left: 0px;
    font-size: 8pt;
    width: 1001px;
}
#menu ul{
    padding:0;
    margin:0;
}
#menu li{
    position: relative;
    list-style: none;
    margin: 0;
    padding:0;
    float: left;
    display:inline;

} 

#menu li a{
    width:125px;
    height: 20px;
    display: block;
    text-decoration:none;
    line-height: 20px;
    background-color: #A9BBD3;
    color: #FFF;
} 

#menu li a:hover{
    background-color: #446087;
} 
#menu ul ul {
    position: absolute;
    top: 21px;
    visibility: hidden;
}

#menu ul ul li a {
    width: 120px;
    padding-left: 5px;
    filter:alpha(opacity=85);
}
#menu ul li:hover ul{
    visibility:visible;
}
#menu > ul > li > a {
    text-align:center;
}
#menu > ul > li > a:hover {
    border-bottom: 1px solid #FFF;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T15:01:40.190

您需要`outline:none`在 css 中使用，例如，

```
a:hover, a:active, a:focus {
    outline: none;
    border: 0;
} 
```

更好的是，如果有的话，你需要在你的代码中添加这段代码`reset.css`。

单击输入 type=image 可以产生虚线轮廓（在 Firefox 3.6.8 中这样做，但在 Firefox 4 中没有）。要删除它：

```
input::-moz-focus-inner { border: 0; } 
```

希望能帮助到你..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T15:03:18.550

这里已经回答了同样的问题： [How to remove dotted border around active hyperlinks in IE8 with CSS](https://stackoverflow.com/questions/1142819/how-to-remove-dotted-border-around-active-hyperlinks-in-ie8-with-css)

查看 IE 的注释。

# subclass - 涉及子类和超类的代码错误

> ID：13495934
> 
> 赞同：0
> 
> 时间：2012-11-21T14:56:40.633
> 
> 标签：subclass, superclass

我必须为两个行星物体之间的力（牛顿万有引力定律）编写一个类，然后为两个带电粒子之间的库仑引力定律创建一个子类。对于那些不做物理的人来说，这些是类似的功能（方法）。这是我的代码：

```
class Gravity:
     def __init__(self, m, M):
          self.m=m
          self.M=M
          self.G=6.67428E-11
     def force(self, r):
          G, m, M = self.G, self.m, self.M
          return (G*m*M)/(r**2)
     def visualize(self, r_start, r_stop, n = 100):
          import matplotlib.pyplot as plt
          from numpy import linspace
          r = linspace(r_start, r_stop, n)
          g = self.force(r)
          plt.plot(r,g)
          set_title='Gravity force: m=%g, M=%g' % (self.m, self.M)
          plt.show () 
```

和我的子类

```
class Coulomb(Gravity):
     def __init__(self, q1, q2):
          Gravity.__init__(self, q1, q2)
          self.G= 8.99E+9
     def force(self, r):
          Gravity.force(self, r)
     def visualize(self, r_start, r_stop, n = 100):
          Gravity.visualize(self, r_start, r_stop, n = 100) 
```

然后我尝试使用带有以下代码的可视化方法来绘制这个库仑定律

```
l = Coulomb(2.63E-9, 8.69E-9)   #My two charges q1 and q2
w = l.visualize(0.1, 1)         #My start and end points for the linspace 
```

我是物理系学生，而不是程序员，所以我想这看起来完全一团糟，但是我知道超类可以自行生成一个平方反比图，但是当我在同一个 .py 文件中使用两组代码运行它时（按上面显示的顺序）我收到错误消息“x 和 y 必须具有相同的第一维”，我认为这意味着我的两个绘图参数的大小不同，但我不知道为什么它们不是。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T23:53:04.960

没有得到任何回应，但还是谢谢。我设法写了一些有效的东西。我将在这里发布我的代码，以供任何其他被迫进行编程并且遇到类似问题的可怜的物理学生使用。我想我的解决方案相当丑陋，但它确实让我到达了那里。如果有人想对其进行编辑或进行任何改进以使其更好，请随意。

```
class Gravity:
      """Gravity force between two physical objects."""
      def __init__(self, m, M):
            self.m=m
            self.M=M
            self.G=6.67428E-11
      def force(self, r):
            G, m, M = self.G, self.m, self.M
            return (G*m*M)/(r**2)
      def visualize(self, r_start, r_stop, n = 100):
            import matplotlib.pyplot as plt
            from numpy import linspace
            r = linspace(r_start, r_stop, n)
            g = self.force(r)
            plt.plot(r,g)
            set_title='Gravity force: m=%g, M=%g' % (self.m, self.M)
            plt.show () 
```

和子类

```
class Coulomb(Gravity):
    def __init__(self, q1, q2):
        Gravity.__init__(self, q1, q2)
        self.G= 8.99E+9
    def force(self, r):
        G, m, M = self.G, self.m, self.M
        return (G*m*M)/(r**2)
    def visualize(self, r_start, r_stop, n = 100):
        Gravity.visualize(self, r_start, r_stop, n = 100) 
```

然后我调用了可视化方法

```
l = Coulomb(2.63E-9, 8.69E-9)    #two arbitrary charges
w = l.visualize(0.1, 1)          #start and end points for linspace for r 
```

这导致了一个很好的平方反比图。希望这可以帮助某人。

# android - 再次调用 onCreate 时，Android 动画不会开始

> ID：13495935
> 
> 赞同：1
> 
> 时间：2012-11-21T14:56:40.137
> 
> 标签：android, animation

当开发选项不保留活动打开时，我有一个运行良好的应用程序。

什么时候关闭，

每次应用程序进入后台并恢复时，都会再次调用 onCreate 函数。在那里，我正在重新创建最后一个应用程序状态。

现在的问题是，发生在用户操作上的简单动画不会启动，并且动画处理程序从未调用过。

似乎动画被忽略了。只有当活动被杀死并再次创建时才会发生这种情况。

最奇怪的部分是我有 4 个动画，2 个用于一个图像视图（打开、关闭）和 2 个用于另一个图像视图（打开、关闭）。

这仅发生在开场动画上。

你能帮帮我吗？

动画 xmls（用于打开/关闭动画之一）

红色显示动画

```
<?xml version="1.0" encoding="utf-8"?>
<set xmlns:android="http://schemas.android.com/apk/res/android"
  android:interpolator="@android:anim/linear_interpolator">
  <alpha
      android:fromAlpha="0.1"
      android:toAlpha="1.0"
      android:duration="800"
      /> 
  <scale android:fromXScale="0.0"
      android:toXScale="1.0"
      android:fromYScale="0.0"
      android:toYScale="1.0"
      android:pivotX="50%"
      android:pivotY="50%"
      android:duration="800">

  </scale>
</set> 
```

红色隐藏动画

```
<?xml version="1.0" encoding="utf-8"?>
<set xmlns:android="http://schemas.android.com/apk/res/android"
  android:interpolator="@android:anim/linear_interpolator">
  <alpha
      android:fromAlpha="1.0"
      android:toAlpha="0.0"
      android:duration="300"
      />
  <scale android:fromXScale="1.0"
      android:toXScale="0.0"
      android:fromYScale="1.0"
      android:toYScale="0.0"
      android:pivotX="50%"
      android:pivotY="50%"
      android:duration="300">

  </scale>
</set> 
```

我正在初始化东西的代码（在onCreate）

```
red = (ImageView) findViewById(R.id.red);

redHide = AnimationUtils.loadAnimation(this, R.anim.red_hide);
redHide.setFillAfter(true);
redHide.setAnimationListener(this);

redShow = AnimationUtils.loadAnimation(this, R.anim.red_show);          
redShow.setFillAfter(true);
redShow.setAnimationListener(this); 
```

我正在调用的处理程序和方法

```
private void showRed() {
    red.startAnimation(redShow); //this is the one that is not happening
}

private void hideRed() {
     red.startAnimation(redHide);
}

@Override
public void onAnimationEnd(Animation a) {   
}

@Override
public void onAnimationRepeat(Animation a) {
}

@Override
public void onAnimationStart(Animation a) {
} 
```

G

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T15:48:22.233

Things you could try are:

*   init the animations in onResume() instead.
*   Call clearAnimation() before you start each animation.
*   Try to animate without fillAfter(), maybe the animation has been locked to it's latest state somehow.

Just some ideas..

A blinking red warning lamp went off when you wrote that you are recreating the last app state since the code you are showing to us looks just fine.

# java - Unix 脚本：通过文件名掩码访问所需的 .ear 文件

> ID：13495939
> 
> 赞同：1
> 
> 时间：2012-11-21T14:56:57.627
> 
> 标签：java, unix, scripting, ksh

任务：需要解压ear存档并访问MANIFEST文件以grep Build-version字符串值。当前脚本如下所示：

```
 MESSAGE=`unzip -o -d $APPBIN $APP/Engine_LIVE_1.1.0.1.ear META-INF/MANIFEST.MF >> /dev/null && cat $APPBIN/META-INF/MANIFEST.MF | grep Build-Version && rm -rf $APPBIN/META-INF` 
```

如您所见，ear 版本的更改会导致文件名更改和脚本失败。

是否可以使此脚本命令与版本号无关？是否可以使用某种正则表达式或文件掩码？我知道 $APP 文件夹中只有一个 .ear 文件，其名称以 Engine_LIVE_ 字符串开头。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T15:06:30.977

解决了。需要使用Engine_LIVE_*

# jquery - 尝试在 jquery 上聚焦后将焦点设置在某些输入上

> ID：13495941
> 
> 赞同：0
> 
> 时间：2012-11-21T14:56:59.593
> 
> 标签：jquery

我知道有一些关于此的帖子，但似乎没有一个与我的问题相匹配。

在失去对按钮的关注后，我想将焦点设置在特定输入上。

```
$('#more_button').focusout(function(){
  $('#input-text').focus();
}); 
```

[http://jsfiddle.net/sDnUr/](http://jsfiddle.net/sDnUr/)

这不像我想要的那样。而不是去“输入文本”，焦点放在浏览器地址栏上！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T15:11:28.537

问题是您正在退出小提琴中的最后一个 html 元素。试试这个：

[http://jsfiddle.net/sDnUr/7](http://jsfiddle.net/sDnUr/7)

```
<input type="text" id="input-text" /><br>
<input type="text" /><br>
<a href="#">foo</a><br>
<a href="#">bar</a><br>
<button id="more_button">more</button>
<a href="#" style="text-decoration:none;">&nbsp;</a> 
```

使用您的原始 javascript

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T14:59:45.587

做一个小的超时，也使用模糊：

```
$('#more_button').blur(function(){
    setTimeout(function () { $('#input-text').focus(); }, 10);
}); 
```

我已经更新了你的[小提琴](http://jsfiddle.net/sDnUr/2/)。

# python - 如何使 Python 中的类与 Set 一起运行？

> ID：13495943
> 
> 赞同：2
> 
> 时间：2012-11-21T14:57:00.873
> 
> 标签：python, set

我有一堂课。

```
class Part:
    def __init__(self,name):
        self.name = name
        self.count = 0
    def __hash__(self):
        return hash(self.name)
    def __lt__(self,other):
        return self.count < other.count
    def __eq__(self,other):
        return self.name == self.count 
```

我创建了一堆这样的对象，并用它们填充了一个列表。该列表最终包含重复项。我的代码中的一个段需要它，但是当需要输出时，我只想输出每个部分一次。所以我把它放在一个集合中。

```
uniqueParts = set(parts) 
```

然后我迭代它以将其写入文件。

```
for part in uniqueParts:
    f.write(part.name+": "+str(part.count)+'\n') 
```

这不起作用。它输出每个重复项。由于 uniqueParts 是一个集合，所以我的班级一定有问题，集合无法判断它们是重复的。

现在，我可以用几种不同的方式解决我的具体问题（重写类，这样我就不需要它了（数据可能太简单了，不值得拥有它自己的类）或者迭代并删除重复项，或者重新编写我的代码以便重复从来没有发生过）但是我将来可能会再次遇到这个问题，我想知道我需要做什么才能让 Sets 与我自己编写的类一起工作。

想法/帮助？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-21T14:58:47.263

这看起来不对：

```
def __eq__(self,other):
    return self.name == self.count 
```

也许你的意思是：

```
def __eq__(self,other):
    return self.name == other.name 
```

# android - 单播发送 UDP 不起作用，但广播发送 UDP 起作用

> ID：13495945
> 
> 赞同：1
> 
> 时间：2012-11-21T14:57:14.003
> 
> 标签：android, udp, send

我有一个奇怪的问题，如果我使用广播地址 (192.168.1.255) 发送 UDP 数据包，我***可以***发送和接收它们。如果我使用单播地址 (192.168.1.83) 发送数据包，则不会传输数据包（我已使用 Wireshark 检查过）。

发送函数为：

```
 private void sendPacket(String data) {
        try {
            if (mSocket.isClosed()) {
                Log.e(TAG, "Socket is closed: " + data);
                return;
            }
            Log.d(TAG, "Send: " + data + " - " + myLocalIP.toString()+ " - " + myBcastIP.toString());
            DatagramPacket packet = new DatagramPacket(data.getBytes(),
                    data.length(), myLocalIP, BCAST_PORT);

            mSocket.send(packet);
        } catch (Exception e) {
            Log.e(TAG, "Exception during write", e);
        }
    } 
```

我的清单文件具有以下权限：

```
<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
<uses-permission android:name="android.permission.ACCESS_WIFI_STATE" /> 
```

鉴于广播有效，我想不出我做错了什么。请问有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-29T09:06:15.833

您是否尝试过其他端口？可能多次循环这个方法，UDP 不能保证 100% 的数据包传递

您是否在代码中使用`socket.setBroadcast(true)`somwhere 来发送广播消息？

# python - 如何显示使用 py.test 时跳过某些测试的原因？

> ID：13495950
> 
> 赞同：61
> 
> 时间：2012-11-21T14:57:28.997
> 
> 标签：python, unit-testing, pytest

我使用`skipIf()`from`unittest`在某些情况下跳过测试。

```
@unittest.skipIf(condition), "this is why I skipped them!") 
```

如何告诉`py.test`显示跳过条件？

我知道对于 unittest 我需要启用详细模式（`-v`），但是添加到 py.test 的相同参数会增加详细程度，但仍不显示跳过原因。

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2012-11-21T15:05:24.270

当你运行 py.test 时，你可以通过`-rsx`来报告跳过的测试。

来自`py.test --help`：

```
-r chars            show extra test summary info as specified by chars
                    (f)ailed, (E)error, (s)skipped, (x)failed, (X)passed. 
```

另请参阅有关跳过的文档的这一部分：http: [//doc.pytest.org/en/latest/skipping.html](http://doc.pytest.org/en/latest/skipping.html)

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2020-07-07T22:37:42.617

**简短的回答：**

```
pytest -rs 
```

这将显示跳过测试的额外信息。

**详细解答：**

为了补充@ToddWilson 的回答，添加了以下字符：`p`和`P`( [2.9.0](https://docs.pytest.org/en/latest/changelog.html#id1184) )、`a`( [4.1.0](https://docs.pytest.org/en/latest/changelog.html#pytest-4-1-0-2019-01-05) ) 和`A`( [4.5.0](https://docs.pytest.org/en/latest/changelog.html#pytest-4-5-0-2019-05-11) )。默认情况下不显示有关已跳过和 xfailed 测试的详细信息，以避免使输出混乱。您可以将[`-r`](https://docs.pytest.org/en/latest/skipping.html)标志与以下字符一起使用：

*   ( `f`) 生病了
*   ( `E`)错误
*   ( `s`)跳过
*   ( `x`) 失败
*   ( `X`)通过
*   ( `p`) 评估
*   ( `P`) 评估输出
*   ( `a`)ll 除了通过 (p/P)
*   ( `A`)ll。

默认情况下启用警告，默认值为`fE`.

# .net - Silverlight 中的 Kml 解析问题

> ID：13495951
> 
> 赞同：2
> 
> 时间：2012-11-21T14:57:32.200
> 
> 标签：.net

我正在尝试将 kml 文件解析为 xml 以获取 silverlight 中的坐标。但它没有以特定格式解析，因为根元素与每个元素重复。请提出任何更好的方法，因为我是 Silverlight 的新手。

```
OpenFileDialog openDiag = new OpenFileDialog();
if ((bool)openDiag.ShowDialog())
{
  StreamReader reader = new StreamReader(openDiag.File.OpenRead());
  while (!reader.EndOfStream)
  {
     str = reader.ReadToEnd();
  }
  reader.Close();
  XDocument xdoc = XDocument.Parse(str);
  IEnumerable<POI> list = from p in xdoc.Descendants("Placemark")
                          select new POI
                          {
                            accountID = MainPage.CurrentAccount,
                            Name = (string)p.Element("name").Value,
                            Lat1 = decimal.Parse((string)p.Element("latitude").Value),
                            Long1 = Parse((string)p.Element("longitude").Value),
                          }; 
```

# javascript - 暂停来自多个 a 标签的多个 Vimeo 嵌入

> ID：13495954
> 
> 赞同：1
> 
> 时间：2012-11-21T14:57:41.883
> 
> 标签：javascript, vimeo

所以基本上我有一个单页网站，里面有一大堆隐藏的 Vimeo 视频。我需要所有视频在未显示时暂停。

到目前为止，我可以在单击特定锚标签时暂停一个视频，但我希望能够通过单击任何 a 标签来暂停所有视频。

我尝试了很多不同的东西，但由于我对 JavaScript 的了解有限，我觉得我已经超出了我的深度。

任何指针将不胜感激。

```
<script>
function showonlyone(thechosenone) {
var newboxes = document.getElementsByTagName("div");
for(var x=0; x<newboxes.length; x++) {
name = newboxes[x].getAttribute("name");
if (name == 'newboxes') {
if (newboxes[x].id == thechosenone) {
newboxes[x].style.display = 'block';
}
else {
newboxes[x].style.display = 'none';
}}}}
</script>

<div name="newboxes" id="newboxes0" style="display: block;">
<iframe id="player" src="http://player.vimeo.com/video/53407474?api=1&player_id=player" width="800" height="450" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>
</div>
<div name="newboxes" id="newboxes0" style="display: none;">
<iframe id="player" src="http://player.vimeo.com/video/53855813?api=1&player_id=player" width="800" height="450" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>
</div>
<div name="newboxes" id="newboxes0" style="display: none;">
<iframe id="player" src="http://player.vimeo.com/video/19780095?api=1&player_id=player" width="800" height="450" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>
</div>

<a name="button" id="button1" href="javascript:showonlyone('newboxes0');"><span></span></a>
<a name="button" id="button2" href="javascript:showonlyone('newboxes1');"><span></span></a>
<a name="button" id="button3" href="javascript:showonlyone('newboxes2');"><span></span></a>

<script src="http://a.vimeocdn.com/js/froogaloop2.min.js"></script>
<script>
function ready(player_id) {
var player = $f(player_id);
pauseButton = document.getElementById('button1');
pauseButton.addEventListener('click', function() {
player.api('pause');
});}
window.addEventListener('load', function() {
$f(document.getElementById('player')).addEvent('ready', ready);
});
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T16:07:56.697

好吧，我在后面注意到的一件事是您有多个相同的 ID。ID 应该是唯一的。[查看 jsFiddle](http://jsfiddle.net/ef9BN/14/)。

所以我把你的 html 改写成这样

```
<div name="newboxes" id="newboxes0" style="display: block;">
    <iframe id="player0" src="http://player.vimeo.com/video/53407474?api=1&player_id=player" width="800" height="450" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>
</div>
<div name="newboxes" id="newboxes1" style="display: none;">
    <iframe id="player1" src="http://player.vimeo.com/video/53855813?api=1&player_id=player" width="800" height="450" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>
</div>
<div name="newboxes" id="newboxes2" style="display: none;">
    <iframe id="player2" src="http://player.vimeo.com/video/19780095?api=1&player_id=player" width="800" height="450" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>
</div>

<a name="button" id="button0" href="javascript:showonlyone('newboxes0');"><span>Button1</span></a>
<a name="button" id="button1" href="javascript:showonlyone('newboxes1');"><span>Button2</span></a>
<a name="button" id="button2" href="javascript:showonlyone('newboxes2');"><span>Button3</span></a>​ 
```

比我更新你的 JavaScript 看起来像这样

```
function showonlyone(thechosenone) {
    var newboxes = document.getElementsByName("newboxes"), x=0;

    for(var x = 0; x < newboxes.length; x++) {
        if (newboxes[x].id == thechosenone) {
            newboxes[x].style.display = 'block'; 
            var strPlayerID = newboxes[x].id.replace("newboxes", "player"); 
            var iframe = $('#'+strPlayerID)[0], player = $f(iframe);
            player.api('play');  
        } else {
            newboxes[x].style.display = 'none'; 
            var strPlayerID = newboxes[x].id.replace("newboxes", "player"); 
            var iframe = $('#'+strPlayerID)[0], player = $f(iframe);
            player.api('pause'); 
        }
    }
} 
```

希望这可以帮助！

# powershell - PowerShell 是否不发送非默认端口的身份验证标头？

> ID：13495956
> 
> 赞同：3
> 
> 时间：2012-11-21T14:57:50.493
> 
> 标签：powershell

我注意到一些奇怪的事情......在 Powershell 中，如果我尝试以下操作：

```
$uri = new-object System.Uri("http://builds.strongbadia.egg:8080/builds/package.tar.bz2")
$clnt = new-object System.Net.WebClient
$clnt.Credentials = new-object System.Net.NetworkCredential($username, $password)
$clnt.DownloadFile($uri, "package.tar.bz2") 
```

未发送“授权”标头（通过 Wireshark 确认）。即使我使用凭证缓存并且特别声明应该使用基本身份验证：

```
$cred = new-object System.Net.NetworkCredential($username, $password)
$credcache = new-object System.Net.CredentialCache
$credcache.Add($uri, "Basic", $cred)
$clnt.Credentials = $credcache 
```

它根本不发送标头。相反，我必须执行以下操作：

```
$auth = 'Basic ' + [System.Convert]::ToBase64String([System.Text.Encoding]::UTF8.GetBytes($username+":"+$password ))
$clnt.Headers.Add('Authorization', $auth) 
```

只有这样，“授权”标头才会被发送，这基本上是因为我正在把东西塞进 PowerShell 的喉咙里。

知道这是一个已知的缺陷还是我做错了什么？我似乎无法找到它的参考。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T07:54:54.753

我之前实际上已经看到了这一点，基本上 .Net 库在发送凭据之前等待来自服务器的身份验证挑战。问题是某些服务器永远不会发送请求，这就是为什么您看不到您的标头被添加的原因。您的方式有效的原​​因是您明确地将标头强制到标头集合上。

此外，它不只是 PowerShell，它发生在任何 .Net 语言中。

# visual-c++ - cuda 事件函数的头文件

> ID：13495963
> 
> 赞同：1
> 
> 时间：2012-11-21T14:58:10.210
> 
> 标签：visual-c++, cuda

以下代码片段要包含哪个头文件以使用 cuda 事件方法测量时间？

```
cudaEvent_t start,stop;
cudaEventCreate(&start);
cudaEventCreate(&stop);
float Elapsed=0,Cycle;

for (int p=1; p<=MSG_NUM; p++)
{ 
    cudaEventRecord(start,0);

    add<<<R, (M+R), (M+R)* sizeof(int)>>>( d_msg, d_checkSumArray ); 

    cudaEventRecord(stop,0);
    cudaEventSynchronize(stop);
    cudaElapsedTime(&Cycle,start,stop);
    Elapsed += Cycle;
}

printf("Time = %f",Elapsed); 
```

我的程序显示以下错误，因为没有包含头文件。

> 错误：标识符“cudaElapsedTime”未定义

有人可以提供解决方案吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-21T15:20:57.983

正确的 API 调用是[cudaEventElapsedTime(...)](http://docs.nvidia.com/cuda/cuda-runtime-api/index.html#group__CUDART__EVENT_1g14c387cc57ce2e328f6669854e6020a5)。

除此之外，您的参数看起来正确。

如果您使用 nvcc 进行编译，则不需要任何特殊的包含头文件。

# c# - 如何使用 MySQL 在 C# 中保护用户指定的表名免受 SQL 注入

> ID：13495968
> 
> 赞同：0
> 
> 时间：2012-11-21T14:58:24.787
> 
> 标签：c#, mysql, sql-injection, mysql-connector

作为对[MySqlParameter as TableName](https://stackoverflow.com/q/6041496/1380710)的反应，[MySQL 的 Connector/NET 库](http://dev.mysql.com/downloads/connector/net/)似乎不支持通过以下方式来自用户输入的表名：

```
MySqlCommand cmd = new MySqlCommand("SELECT * FROM @table");
cmd.Parameters.AddWithValue("@table",TableNameFromUserInput); 
```

所以我试图找到另一种方法，但我找不到任何为我做这件事的库。

在搜索如何手动执行此操作时，无论语言如何，我都找不到任何没有告诉您使用某些已定义库中的“准备好的语句”的内容。

就我对 SQL 的有限了解而言，我只认为有必要在用户输入周围加上反引号 (`)，然后检查输入是否有反引号 - 但我想确定一下。

## 问题

当 MySQL 连接器不支持时，如何保护用户指定的表名免受 SQL 注入？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-21T15:03:19.830

检查是否

```
TableNameFromUserInput 
```

是一个现有的表，在执行查询之前。这也可以防止其他错误，例如“表不存在”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T15:02:09.410

您不能在准备好的语句中添加`tableName`（*以及 columnName*）作为参数，因为它只支持一个值。为了您的安全，请添加其他代码来验证 tableName，例如。

```
string tableName = "hello";
tableName = UDFunctionClean(tableName);
string query = String.Format("SELECT * FROM `{0}`", tableName);
MySqlCommand cmd = new MySqlCommand(query); 
```

# java - 如何使用 ftp4j 通过 sftp 连接到 linux

> ID：13495969
> 
> 赞同：2
> 
> 时间：2012-11-21T14:58:29.070
> 
> 标签：java, linux, ssl, ftp

我在使用 ftp4j 时遇到了这个问题：

```
javax.net.ssl.SSLException: Unrecognized SSL message, plaintext connection? 
```

ftp 服务器已启用端口 22 上的连接，我可以毫无问题地连接 filezilla。

这是我的代码：

```
 private boolean copiarArchviosFtp(){

    FTPClient ftpDestino=new FTPClient();

    try{
        TrustManager[] trustManager = new TrustManager[] { new X509TrustManager() {
            public X509Certificate[] getAcceptedIssuers() {
                return null;
            }
            public void checkClientTrusted(X509Certificate[] certs, String authType) {
            }
            public void checkServerTrusted(X509Certificate[] certs, String authType) {
            }
        } };
        SSLContext sslContext = null;
        try {
            sslContext = SSLContext.getInstance("SSL");
            sslContext.init(null, trustManager, new SecureRandom());
        } catch (NoSuchAlgorithmException e) {
            e.printStackTrace();
        } catch (KeyManagementException e) {
            e.printStackTrace();
        }
        SSLSocketFactory sslSocketFactory = sslContext.getSocketFactory();

        ftpDestino.setSSLSocketFactory(sslSocketFactory);
        ftpDestino.setSecurity(FTPClient.SECURITY_FTPS);

        ftpDestino.connect("172.24.1.109",22);
        ftpDestino.login("user","password");
        ftpDestino.changeDirectory("/home/");

        FTPFile[] listFilte=ftpDestino.list();
        for(FTPFile ftpFile:listFilte){
            System.out.println("nameFile: "+ftpFile.getName());
        }

    }
    catch(Exception e){
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

    return false;
} 
```

关于如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T01:29:36.437

我正在研究如何通过 SFTP 复制文件。即使指定了 FTPClient.SECURITY_FTPS，ftp4j 库也无法工作，因为 FTPS 与 SFTP 不同。

我找到了一个使用另一个名为 JSCH 的库的解决方案。

这是一个[JSCH](http://www.jcraft.com/jsch/examples/Sftp.java.html)的例子。我希望这对某人有所帮助。

这是有关[SFTP 与 FTPS的](http://www.eldos.com/sbb/sftp-ftps.net/ftps-vs-sftp.php)[更多信息](http://kodehelp.com/difference-between-ftp-sftp-ftps/)。

# c# - 默认情况下，当我将数据绑定到 Windows 窗体控件时会发生什么。

> ID：13495971
> 
> 赞同：3
> 
> 时间：2012-11-21T14:58:43.613
> 
> 标签：c#, winforms

所以我被要求解决一个已经存在一段时间的旧 Windows 窗体实用程序的问题（至少在我的任何同事出现之前）。该表单有一个数据绑定的 numericUpDown 控件。问题是，当您单击向上或向下箭头时，值会更改并保存确定，但是，如果您只是输入一个数字并单击保存它不会保存。就像数据绑定从来没有看到变化，所以来自 WPF 背景我猜想改变以下

```
TaskDaysToComplete.DataBindings.Add("Value", taskTemplate, "DaysToComplete"); 
```

对此

```
TaskDaysToComplete.DataBindings.Add("Value", taskTemplate, "DaysToComplete", false, DataSourceUpdateMode.OnPropertyChanged); 
```

会解决我的问题，它确实做到了。您现在可以输入一个数字或使用控件上的向上/向下箭头来设置“值”属性。

我的问题是，首先发生了什么？我猜默认的 DataSourceUpdateMode 是 OnValidation ，但是什么时候会发生这种情况，为什么在使用向上/向下箭头时可以，但在输入内容时似乎从未发生过。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T09:30:04.277

[numericUD 验证](http://msdn.microsoft.com/en-us/library/system.windows.forms.numericupdown.validate.aspx)

验证在失去焦点时完成，因此当您按下向上/向下键时，文本框失去焦点 - 触发验证例程。
编辑文本时，您可以通过单击另一个控件使控件失去焦点，这将使其生效。
默认设置为 onValidate 的原因是 on 值更改将导致它对每个键入的字符进行验证，这对于性能和正确验证都是有问题的。

# android - Android zipalign 错误 - 验证失败

> ID：13495972
> 
> 赞同：2
> 
> 时间：2012-11-21T14:58:46.660
> 
> 标签：android, compression, google-play

我正在尝试压缩我的应用程序但总是收到错误：“验证失败”。没有更多信息，只有一些带有 (BAD - 1) 的 *.png 文件，但我不知道这意味着什么。

有人可以告诉我问题是什么吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T17:16:40.730

我认为问题在于，我们自动唱了应用程序，但使用了错误的 sigalg！

安卓注意事项：

> 注意：从 JDK 7 开始，默认签名算法已更改，要求您在签名 APK 时指定签名和摘要算法（-sigalg 和 -digestalg）。

我们在 MD5withRSA 的情况下使用 RSA

# asp.net-mvc - SignalR-向特定客户端发送数据

> ID：13495976
> 
> 赞同：0
> 
> 时间：2012-11-21T14:58:49.933
> 
> 标签：asp.net-mvc, signalr

我想将数据发送到特定的客户端。为此，我正在尝试以下方法；

```
public Task GetWaitingOrdersCount(string id, string clientId)
    {
        DateTime today = Util.getCurrentDateTime();

      var data = 10

      return Clients.Client(Context.ConnectionId).loadOrders(data);

      //return data;
    } 
```

在上面的代码中，我想将“数据”发送到传递给此方法的“clientId”。但我在这一行有一个错误

```
 return Clients.Client(Context.ConnectionId).loadOrders(data); 
```

错误是

```
'System.Threading.Tasks.Task<object>' does not contain a definition for 'loadOrders' 
```

客户端代码

```
con.loadOrders = function (data) {
        loadOrders(data);

    };

function loadOrders(data) {

    $('#totalOrders').html(data);
} 
```

关于错误的任何帮助？？？

**编辑：** 这是我的完整客户端代码..

```
<script type="text/javascript">
var con;
$(document).ready(function () {
    con = $.connection.messagingHub;

    $.connection.hub.start(function () {
        var myClientId = $.connection.hub.id;
        con.getWaitingOrdersCount('<%:ViewBag.rid%>',myClientId).done(function (data) {
            console.log(data);
        });
    });

    con.client.loadOrders = function (data) {
        loadOrders(data);

    };

});
function loadOrders(data) {

    $('#totalOrders').html(data); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T18:01:18.607

我刚刚试用了您的代码（稍作修改），对我来说效果很好。您使用的是什么版本的 SignalR？从你的服务器代码来看，我会说 1.0Alpha1+，但你的客户端代码看起来更像 0.5.3，除非你的 con 对象被分配给 $.connection.yourhub.client;

如果您更新到 SignalR 1.0Alpha2 并将您的客户端代码更改为：

```
var con = $.connection.myCon;// This is arbitrary and would change based on your naming

con.client.loadOrders = function (data) {
    loadOrders(data);

};

function loadOrders(data) {
    $('#totalOrders').html(data);
} 
```

话虽如此，我相信您的问题与您正在使用的 SignalR 版本有关，即服务器端：因为您收到面向任务的错误。另一条可能有用的信息是了解如何调用 GetWaitingOrdersCount。Aka 是直接通过客户端调用：con.server.getWaitingOrdersCount 还是从集线器内部调用。

希望这些信息有帮助！

# javascript - 如何在不更改其他列的大小的情况下调整表列的大小？

> ID：13495978
> 
> 赞同：3
> 
> 时间：2012-11-21T14:58:56.173
> 
> 标签：javascript, html, css

我有一个 HTML 表，我向其中添加了一堆交互行为（可添加、可移动、可移动的列、重命名列等）。最后一块拼图是可调整大小的列。我主要通过允许用户在边框的 5px 内单击然后拖动鼠标来工作。我的问题是，当调整一列的大小时，其他列会增长或缩小以补偿并保持表格的宽度。我想要的行为是按列调整大小的量来增加（或缩小）表格，而不是调整任何其他列宽。这可能与 CSS/JS 吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-21T15:29:53.050

```
table {
  table-layout: fixed;
} 
```

# jsf - 在对 primefaces 使用部分处理时，数据网格的最后一个条目丢失

> ID：13495981
> 
> 赞同：3
> 
> 时间：2012-11-21T14:59:06.967
> 
> 标签：jsf, jsf-2, primefaces

我对部分处理有疑问。（我使用 primefaces 3.4.1。）我有一个 dataGrid 列表服务，并且 dataGrid 的每一行都有一个命令按钮“删除服务”，用于删除服务。我从支持 bean 的服务列表中删除指定的服务，并在单击“删除服务”按钮时更新数据网格。

另外，我在表单中有两个按钮；第一个按钮，“添加服务”，用于添加新服务；我在支持 bean 中的服务列表中添加了一个新对象，并在单击“添加服务”时更新数据网格。第二个“保存”按钮用于保存所有服务。单击“保存按钮”时，将服务列表插入数据库。

顺便说一句，我需要表单验证，因为我的服务对象中有必填字段。因此，应在单击“添加服务”和“保存”时验证表单。但是，单击“删除服务”按钮时不应验证表单。如果我为“删除服务”按钮使用 'process="@form"'，一切正常。我可以从支持 bean 的服务列表中删除指定的服务，并且数据网格已正确更新。但正如您所知，由于所有表单都已处理，因此所有输入组件都已验证。如果我使用 'process="@this"' 或 'immediate="true"' 作为“删除服务”按钮，我无法到达最后一个条目。我的意思是，我无法到达最后一个服务。我想当我点击“删除服务”按钮时它还没有发布。所以我该怎么做？对这种情况有什么建议吗？提前致谢...

我的代码如下；

```
<h:form id="formServicesTab">
        <h:panelGrid id="pnlSvcTab" columns="1" styleClass="valignTop" width="100%">
            <p:dataGrid id="dgServices" var="service"
                value="#{subMerchantOperations.subMerchantServices}"
                columns="1" width="100%" styleClass="valignTop"
                emptyMessage="#{messagebundle.submerc_grdlabel_no_service}" transient="true"
                rowIndexVar="index" >

                <p:toolbar>
                    <p:toolbarGroup align="left">
                        <p:commandButton id="btnRemoveSvc" onclick="loading.show();"
                            oncomplete="loading.hide();"
                            value="#{messagebundle.submerc_btn_delete_service}"                         
                            actionListener="#{subMerchantOperations.removeService}"                     
                            process="@form" update="@form">

                            <f:setPropertyActionListener target="#{subMerchantOperations.serviceRowIndex}" value="#{index}" />
                        </p:commandButton>                      
                    </p:toolbarGroup>
                </p:toolbar>

                <h:panelGrid columns="3" styleClass="valignTop" width="100%" bgcolor="F0F0F0">
                    <p:panel style="background:#F0F0F0;">
                        <h:panelGrid id="pnlDgSvc" columns="1" width="100%" style="height:100%">
                            <h:outputText value="#{messagebundle.submerc_label_svc_shortName}" />
                            <h:panelGrid columns="2">
                                <p:inputText id="txtSvcName" value="#{service.serviceName}"
                                    required="true" transient="true"
                                    requiredMessage="#{messagebundle.submerc_validation_msg_required}"
                                    converter="UpperCaseConverter" />
                                <p:message for="txtSvcName" display="text" />
                            </h:panelGrid>

                            <h:outputText value="#{messagebundle.submerc_label_svc_website}" />
                            <p:inputText value="#{service.serviceUrl}" transient="true"/>                           
                        </h:panelGrid>
                    </p:panel>

                    <p:panel style="background:#F0F0F0;">
                        <h:panelGrid columns="1" width="100%">
                            ..........
                        </h:panelGrid>
                    </p:panel>

                    <p:panel style="background:#F0F0F0;">
                        <h:panelGrid id="pgSvcFiles" columns="1" width="100%">
                            ...........      
                        </h:panelGrid>
                    </p:panel>
                </h:panelGrid>
            </p:dataGrid>
        </h:panelGrid>
        <p:toolbar style="background:white">
            <p:toolbarGroup align="left">               
                <p:commandButton id="btnAddNewSvc"                  
                    value="#{messagebundle.submerc_btn_addSvc}"                  
                    actionListener="#{subMerchantOperations.addNewService}"
                    process="@form" update="@form" />

                <p:commandButton id="btnSaveSubM"                   
                    value="#{messagebundle.submerc_btn_sendApproval}"                   
                    action="#{subMerchantOperations.saveServices}" 
                    process="@form" update="@form" />
            </p:toolbarGroup>
        </p:toolbar>
    </h:form>

@ManagedBean
@ViewScoped
public class SubMerchantOperations implements Serializable {
    private static final long serialVersionUID = 8556103952857187080L;  

    private List<Service> subMerchantServices = new ArrayList<Service>();
    private int serviceRowIndex;    

    // add new empty service to the service list
    public void addNewService() {
        try {
            Service svc = new Service();
            svc.setStartDate(new Date());
            getSubMerchantServices().add(svc);                      
        }
        catch(Exception ex) {
            if (logger.isEnabledFor(Level.ERROR)) {
                ...
            }           
        }       
    }

    // Remove the specified service using index parameter got from the datagrid
    public void removeService() {
        try {
            getSubMerchantServices().remove(serviceRowIndex);   
        }
        catch(Exception ex) {
            ... 
        }                               
    }

    // DB Operations
    public String saveSubMerchant() {       
        ...
    }

    public List<Service> getSubMerchantServices() {
        return subMerchantServices;
    }

    public void setSubMerchantServices(List<Service> subMerchantServices) {
        this.subMerchantServices = subMerchantServices;
    }
    public int getServiceRowIndex() {
        return serviceRowIndex;
    }

    public void setServiceRowIndex(int serviceRowIndex) {
        this.serviceRowIndex = serviceRowIndex;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T17:47:01.840

我不知道该`transient`属性在您的`<p:dataGrid>`. 我已经查看了 Primefaces PDF 文档的最新发布版本，但它没有被列为有效属性。

如果您发现基于 Facelet 的组件验证导致您的空表单在提交其中一个按钮时触发验证错误，您可以考虑在支持 bean 中创建一个由您的提交方法调用的方法，并验证豆子上的元素。这是 Primefaces 的一种流行方法，因为与`Seam`我们不同的是，它没有提供表单级验证。

但是，请检查[您对 immediate=true 的理解](http://www.javacodegeeks.com/2012/01/jsf-and-immediate-attribute-command.html)。

或者，您可以考虑使用[JSR303](http://jcp.org/en/jsr/detail?id=303)注释来注释 POJO 的属性。

由于您使用的是集合，因此请确保您的 Service POJO[覆盖`equals`并`hashcode`](http://jtechies.blogspot.co.uk/2012/07/item-9-always-override-hashcode-when.html)排除您的集合没有发生一些棘手的事情并导致您的问题。

# c# - 重建后难以加载参考

> ID：13495988
> 
> 赞同：0
> 
> 时间：2012-11-21T14:59:39.667
> 
> 标签：c#, .net, vb.net, visual-studio-2010, dll

我同时编写应用程序和库，每当我更新库时，很难在消费者应用程序中识别它。我为每个库和应用程序打开了一个单独的 Visual Studio 实例。重建库后，我在消费者应用程序中收到以下警告/错误。然后我要么必须删除引用并再次添加它。或者我必须清理和构建库解决方案 3-4 次，这样警告/错误才会在消费者应用程序 VS 解决方案中消失。为什么做 4 次与做 1 或 2 次有什么不同..？

想了解为什么会发生这种情况以及是否可以采取一些措施使这项工作更加顺利？

不确定它是否相关，但我的大多数应用程序都是用 VB.NET 和 C# 中的库编写的（因为我正在将所有内容都更改为 C#）。我还在消费者应用程序 VS 中打开了库中的 C# 文件，因为它在调试期间弹出。我还在库项目 /bin/Debug 文件夹中引用了库 dll，因为我在这个开发阶段进行了很多更改。

> 警告 1 在 Imports 'somelibrary' 中指定的命名空间或类型不包含任何公共成员或找不到。确保命名空间或类型已定义并包含至少一个公共成员。确保导入的元素名称不使用任何别名。'本地路径'

..

> 错误 72 无法加载引用的库“path\somelibrary.dll”：该进程无法访问该文件，因为它正被另一个进程使用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T15:29:58.060

> 我同时编写应用程序和库，每当我更新库时，很难在消费者应用程序中识别它。**我为每个库和应用程序打开了一个单独的 Visual Studio 实例。**

这是你问题的根本根源。当超出其控制范围的事物发生变化时，Visual Studio 不喜欢它。您应该打开一个包含所有相关项目的解决方案。然后，当某些事情发生变化时，所有依赖于该项目的项目都将自动重建。（至少，这是默认设置。）

> 重建库后，我在消费者应用程序中收到以下警告/错误。然后我要么必须删除引用并再次添加它。或者我必须清理和构建库解决方案 3-4 次，这样警告/错误才会在消费者应用程序 VS 解决方案中消失。为什么做 4 次与做 1 或 2 次有什么不同..？

我认为这与您清理和重建它的次数没有任何关系，但是自从您上次进行更改以来已经过了多长时间 - 您必须等待足够长的时间才能让构建 dll 的 VS 实例释放锁定该文件，在使用它的 VS 实例能够访问它之前。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T15:28:12.197

当您构建一个项目时，您将 .DLL 文件锁定在您构建它的项目中，因为这是 Visual Studio 的库实例将使用的程序集版本 - 但是您在另一个进程中引用同一个库因此您看到错误的原因。

您有两个选择，继续拥有两个实例，然后关闭这两个实例，再次打开它们就可以了。

您最好做的是将您正在引用的项目本身（并且正在获取错误）添加到您的解决方案中。然后通过选项卡而不是引用`YourProject/bin/debug/assembly.dll`添加对本地项目的引用`Projects`。然后，这将保持一个进程引用它需要的适当程序集。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-21T15:18:45.070

对于解决方案中的每个项目，检查项目设置 -> 编译选项卡 -> 高级编译选项... -> 目标框架（所有配置），查看它们是否都是（例如）.NET 框架 4\. 有不同或错误框架可能会导致您现在遇到的问题

# javascript - Javascript关闭澄清？

> ID：13495991
> 
> 赞同：5
> 
> 时间：2012-11-21T14:59:48.130
> 
> 标签：javascript, closures

*与我阅读的文章一样多，我仍然有一些问题。*

我已经知道（并理解）闭包的用法，例如：

1.  臭名昭著的循环问题*（链接循环，每个链接都带有警报，并保持编号）*

2.  增加的计数器*（继续调用一个函数 -> 提醒增加的数字）*

从[这里](http://robertnyman.com/2008/10/09/explaining-javascript-scope-and-closures/)：

> 引用其外部函数的局部变量的内部函数创建闭包

从[这里](http://www.javascriptkit.com/javatutors/closures.shtml)：

> 闭包是函数的局部变量 - 在函数返回后保持活动状态，或者闭包是在函数返回时未释放的堆栈帧。（好像“堆栈帧”被分配而不是在堆栈上！）

请教3个问题：

**问题 #1**

有人告诉我，JS 中的所有函数都会创建闭包。

**什么**？？？如果我创建一个带有私有变量的普通函数，它只会创建一个范围。不关闭。

我认为关闭是这样的：（[从这里开始](http://sleeplessgeek.blogspot.co.il/2009/12/so-what-are-these-closure-thingys.html)）

> 1.  制作一个外部的“功能制造商”功能。
> 2.  在其中声明一个局部变量。
> 3.  在外部函数内部声明一个内部函数。
> 4.  在内部函数中使用外部函数的变量。
> 5.  让外部函数**返回内部函数**
> 6.  运行该函数，并将其返回值分配给一个变量

示例：

```
function functionMaker(){
   var x = 1;
   function innerFunction(){
     alert(x);
     x++;
   }
   return innerFunction;
} 
```

那么为什么他们说每个 js 函数都会创建闭包呢？

**问题2**

又名IEFA `Self-Invoking Functions`-`Immediately Invoked Function Expression`创建一个闭包吗？

看着

```
(function (a) {
    alert(a);
})(4); 
```

我看不到上面的*6 条规则*这样的模式：这里到底在哪里*`Have the outer function return the inner function`*？我没有看到这个词`return`。

**问题 #3**

```
function myFunction() {
  var myVar = 1;
  var alertMyVar = function () {
    alert('My variable has the value ' + myVar);
  };
  setTimeout(alertMyVar, 1000 * 3600 * 24);
}
myFunction(); 
```

难道`myFunction`在这里活了一整天？或者它在之后就结束了`setTimeout`？如果是这样，如何`SetTimeOut` *记住*该值？

请帮我把它做对。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-21T15:05:01.940

所有函数**调用都会**创建一个闭包。需要注意的重要一点是闭包是否持续超过函数调用的生命周期。

如果我执行立即执行的功能：

```
var value = (function() {
  return 4;
})(); 
```

然后创建一个闭包，但在函数返回时丢弃。为什么？因为没有对闭包中定义的符号的幸存引用。但在这儿：

```
var value = function() {
  var counter = 0;
  return function() {
    return counter++;
  };
}(); 
```

闭包在立即执行的函数之后继续存在，因为它返回*另一个*函数，该函数又包含对原始函数中定义的“计数器”符号的引用。因为返回的函数仍然是“活动的”，所以闭包必须由运行时系统保留。

注意这里：

```
var value = function() {
  return function(a) {
    return "hello " + a;
  };
}(); 
```

即使外部立即执行的函数返回一个函数，该函数也不会引用外部函数的任何符号，因此无需保留闭包。

我想我想说的是，将闭包视为执行函数效果的一部分是有帮助的，而不是严格地作为静态的、结构性的东西。可能有一个函数*有时会*创建一个持久闭包，但并非总是如此。

# groovy - 如何使用groovy脚本在soapUI中为WSDL的所有操作生成请求和响应？

> ID：13495992
> 
> 赞同：3
> 
> 时间：2012-11-21T14:59:51.037
> 
> 标签：groovy, wsdl, soapui

我有一个有多个操作的 WSDL。对于每个操作，我想要一个带有响应和请求的模板 .xml。

我知道如何在soapUI 中手动执行此操作，但我想使用常规脚本生成它们。我已经用谷歌搜索了很多，但似乎我是唯一一个正在寻找这个的人。

我的服务有 16 个操作，所以做这个手册会太多时间。由于该服务每 2 个月更新一次，因此使用测试步骤的自动化将是完美的。

我已经设法为请求做到了：

> 右键单击左侧树中的“服务”，“生成测试套件”，“每个操作都有一个请求的单个测试用例”

然后我遍历这些测试步骤请求并将它们存储在我的磁盘上。

```
 import com.eviware.soapui.impl.wsdl.teststeps.*

    for( testCase in testRunner.testCase.testSuite.getTestCaseList() ) 
    {
        for( testStep in testCase.getTestStepList() ) 
        {
            if( testStep instanceof WsdlTestRequestStep ) 
            {
                log.info "operation name: " +testStep.getName()

                // create file name
                Date startTime = new Date();
                def cur_Time = startTime.getMonth() + "_" + startTime.getDate();
                cur_Time = cur_Time + "_" + startTime.getHours() + startTime.getMinutes() +startTime.getSeconds()
                def fileName = testStep.getName() + "_" + cur_Time

                def inputFileRequest = new File("T:\\"+ "Request_" + fileName+".txt")
                def inputFileResponse = new File("T:\\"+ "Response_" + fileName+".txt")
                // write request to file
                inputFileRequest.write(testStep.getProperty("request").value)
            }
        }
    } 
```

但我还没有想出一种方法来为响应做这件事。如果我使用 getProperty("reponse") 它当然是空的。

有什么提示吗？:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-22T14:49:30.030

赢家是，我自己想出来的：

```
map = context.testCase.testSuite.project.interfaces["services"].operations

for (entry in map)
{
    opName = entry.getKey()
    inputFileRequest = new File("T:\\" + opName + "Request.xml")
    inputFileResponse = new File("T:\\" + opName + "Response.xml")

    inputFileRequest.write(entry.getValue().createRequest(true))
    inputFileResponse.write(entry.getValue().createResponse(true))
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-24T07:31:12.367

这很棒，即使我也在做同样的事情。到目前为止，我正在从文件夹中获取 xml 请求，但我只想从 WSDL 本身获取请求并希望获取它的参数。

尝试{

```
 //Hitting the WSDLs one by one
    wsdlList.each
    {
            wsdl ->
            wsdlToHit=wsdl
            log.info("WSDL To Hit :" + wsdlToHit)

            // Creating an interface
            log.info("Before Interface Creation")
            iface= WsdlInterfaceFactory.importWsdl( project,wsdl, false )[0]
            //iface= WsdlInterfaceFactory.importWsdl( project,WSDLFile, false )[0]
            log.info("After Interface Creation")

                    if(Operation == "xyz")
                    {                   
                    requestXML= requestXML1  
                    responseActual= responseActual1
                    expectedActual=expectedActual1
                    }
                    if(Operation == "abc")
                    {                   
                    requestXML= requestXML2 
                    responseActual= responseActual2
                    expectedActual=expectedActual2
                    }
                        requestXML.each
                    {                       
                    request1 ->
                    def wsdlReqDir=request1
                    log.info("RequestLocation : " + wsdlReqDir)

                    File fl = new File(wsdlReqDir)
                    File[] wsdlDirFiles = fl.listFiles()
                    log.info("XML Files in Request Folder : " + wsdlDirFiles)

                        if(wsdlDirFiles.size()>0)
                        {                           
                            wsdlDirFiles.each
                            {
                                wsdlFile->
                                log.info("Request XML file to Send :" + wsdlFile)

                                //Calling the function to hit the service
                                sendRequest(wsdlFile,iface,Operation,Report_File_LOC,requestXML,responseActual,propData)
                                reportFilewriter.flush()    

                            }   

                        }

                    }   

    //removing Interface created
    removeInterface(wsdl)
    log.info("Removed iface : "  + wsdl)
    reportFilewriter.flush()    

    } 
```

谢谢，哈努曼

# javascript - 使用 json 的 ExtJS 存储初始化失败

> ID：13495994
> 
> 赞同：1
> 
> 时间：2012-11-21T14:59:58.150
> 
> 标签：javascript, json, rest, extjs, extjs4

我有一个这样的商店：

```
Ext.define('app.store.System', {
extend : 'Ext.data.Store',
model : 'app.model.System',
autoLoad: true,
autoSync: true,

proxy: {
    type: 'rest',
    format: 'json',
    url: '/application/appinfo',
    method : "GET",
    reader: {
        type: 'json',
        root: 'System'
    },
    writer: {
        root: 'System',
        allowSingle: false
    }
}
}); 
```

我有一个服务端点来处理与 /application 匹配的请求：

```
@GET
@Path("/{sysinfo}")
public List<SystemInfo> getSystemInfo() {        
    if(sysinfo == null){
        sysinfo = new SystemInfo();

        ...initialize
    }

    List<SystemInfo> resultList = new ArrayList<SystemInfo>();
    resultList.add(sysinfo);

    return resultList;
} 
```

它似乎工作......当我试图到达 localhost:port/application/sysinfo.json 我得到了这个：

```
{ [{"address":"...","feeds":["feed1","feed2"] } ] } 
```

这似乎是正确的，但是当我尝试在视图的 init 方法中从存储中读取数据时：

```
var store = Ext.StoreManager.lookup('System');
    var data = [];

    store.each(function(record) {
        data.push(record.getData());
        console.log("record data: ");
        console.log(record.getData());
    });

    console.log(data[0]); 
```

它说它是未定义的，就好像商店是空的一样。我用调试器试了一下，发现 getSystemInfo() 是在视图的 initcomponent**之后**调用的，但不幸的是我不知道为什么会这样或如何解决它。有任何想法吗？

谢谢你的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T15:09:17.710

您是否尝试过先加载您的商店？

```
var store = Ext.StoreManager.lookup('System');
var data = [];
store.load({
   callback: function(storeVar, records, successful) {
      Ext.each(records, function(record) {
         data.push(record.getData());
         console.log("record data: ");
         console.log(record.getData());
      });
   }
   console.log(data[0]);
}); 
```

鲍里斯说的是真的，你需要在返回的 JSON 中定义你的根属性。

如果您使用的是 chrome 或 firefox，您还可以检查进行了哪个网络调用，以及它返回的内容（JSON 数据...）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T15:09:38.030

尝试这个：

```
return new { success: true, System = resultList}; 
```

# c# - 比较一个类型的成员 - 计算成员之间的差异

> ID：13495995
> 
> 赞同：3
> 
> 时间：2012-11-21T15:00:06.557
> 
> 标签：c#, linq, list

我有以下类型：

```
public class Parts
{
    public string PartNo { get; set; }
    public decimal Price { get; set; }
} 
```

我想做的是将价格或每个零件与最便宜的零件进行比较，并显示百分比差异。

这是我迄今为止尝试过的，它有效：

```
 var part1 = new Part {PartNo = "part1", Price = 10};
        var part2 = new Part {PartNo = "part1", Price = 8};
        var part3 = new Part {PartNo = "part1", Price = 12};

        var parts = new List<Part> {part1, part2, part3};

        var list = from p in parts
                    orderby p.Price ascending 
                   select p;

        var sb = new StringBuilder();

        var counter = 0;
        decimal firstPrice=0;
        foreach (Part p in list)
        {
            if (counter == 0)
            {
                firstPrice = p.Price;
            }

            sb.Append(p.PartNo + ": " + p.Price + "," + ((p.Price/firstPrice)-1)*100 + Environment.NewLine);

            counter++;
        }

        Console.WriteLine(sb.ToString(), "Parts List"); 
```

这将输出以下内容：

```
part1: 8, 0
part1: 10, 25.00
part1: 12, 50.0 
```

这显示了每个部分的价格上涨，这就是我想要实现的目标，但我想知道是否有更好的方法来计算百分比价格差异（例如使用 LINQ 查询）或以任何其他方式。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-21T15:07:25.960

我将计算差异作为第一步。

```
var cheapestPrice = parts.Min(p => p.Price);
var list = parts.Select(p => new { 
    Part = p,
    DiffPercentage = ((p.Price - cheapestPrice) / cheapestPrice) * 100 
});

foreach (var p in list)
    Console.WriteLine("{0}: {1},{2}%", p.Part.PartNo, p.Part.Price, p.DiffPercentage); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-21T15:11:18.870

```
// list defined as sorted by price ascending as per the code
var list = parts.OrderBy(p => p.Price); // less verbose way of saying the same

var firstPrice = list.First().Price;
var differences = list.Skip(1).Select(s => new {Part = s, PercentageDiff = (s.Price/firstPrice - 1)*100}); 
```

`.Skip(1)`是可选的。您可能不想将最便宜的价格与自己进行比较。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-21T15:11:02.687

蒂姆打败了我，但使用选择来创建你的字符串

```
void Main()
{
        var part1 = new Part {PartNo = "part1", Price = 10};
        var part2 = new Part {PartNo = "part1", Price = 8};
        var part3 = new Part {PartNo = "part1", Price = 12};

        var parts = new List<Part> {part1, part2, part3};

        var lowest = parts.Min(p => p.Price );

        var result = parts.Select (p => string.Format("Part #:{0} {1} -> {2}", p.PartNo, p.Price,  ((p.Price/lowest)-1)*100 ));

      result.ToList()
            .ForEach(rs => Console.WriteLine (rs));
        /*
Part #:part1 10 -> 25.00
Part #:part1 8 -> 0
Part #:part1 12 -> 50.0
*/

}

// Define other methods and classes here
public class Part
{
    public string PartNo { get; set; }
    public decimal Price { get; set; }
} 
```

# javascript - 如何在 typescript / javascript 中执行其他函数的函数中包含代码？

> ID：13495998
> 
> 赞同：0
> 
> 时间：2012-11-21T15:00:14.970
> 
> 标签：javascript, typescript

我正在使用以下编码模式：

```
function submit() {

    function submitModalDone() {
        // do something
    }

    function submitModalFail() {
        // do something
    }

    $.ajax(
       {
           url: "xxx"
       })
       .done(submitModalDone)
       .fail(submitModalFail);
} 
```

我将 submitModalDone 和 submitModalFail 放在提交函数中，因为它们仅从 $.ajax 调用。

但是，将我的代码按原样添加到函数末尾和所有子函数之后是否是个好主意。是否有更适合此的设计模式？$.ajax 代码和其他代码只是位于任何容器之外，这似乎很奇怪。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T15:06:02.233

我认为这是一个体面的、描述性的模式。

但是，您可能希望像这样构造它：

```
var submit = (function () {

    function submitModalDone() {
        // do something
    }

    function submitModalFail() {
        // do something
    }

    return function () {
        $.ajax({
            url: "xxx"
        }).done(submitModalDone).fail(submitModalFail);
    };

}()); 
```

这避免了创建`submitModalDone`，并且`submitModalFail`每次都`submit`被调用。

# c++ - LNK1313 视觉工作室错误

> ID：13495999
> 
> 赞同：0
> 
> 时间：2012-11-21T15:00:16.600
> 
> 标签：c++, visual-studio-2005, libraries, managed-c++, libtiff

我正在尝试编译和运行一些代码，部分代码是我使用 Visual Studio 编写的，部分任务需要我使用我下载的库。错误消息显示“致命错误 LNK1313：检测到 ijw/native 模块；无法与纯模块链接”。我猜这与被认为是纯模块的库（libtiff，如果有人想知道是哪个）有关，而 Visual Studio 项目不是？有没有办法处理这样的错误？我有一段时间没有使用 C++（或 Visual Studio）了，如果我能得到任何帮助，我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T15:20:58.803

确保使用 libtiff 库的模块未设置为与 clr:/pure 链接（请参见此处：http: [//msdn.microsoft.com/en-us/library/k8d11d4s.aspx](http://msdn.microsoft.com/en-us/library/k8d11d4s.aspx)）

请参阅项目属性/常规/公共语言运行时支持