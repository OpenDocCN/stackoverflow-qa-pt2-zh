# StackOverflow 问答 14883000-14883999

# java - 为什么不使用 ResourceBundle 而不是 Properties？

> ID：14883000
> 
> 赞同：6
> 
> 时间：2013-02-14T19:59:10.693
> 
> 标签：java

这是一个简单的问题，我找不到结论性的答案。

我可以从文件中加载字符串属性（例如：对准备好的语句的查询）`config.properties`。假设我想连接要连接的数据库连接。

如果我想从文件中获取这些信息，我可以在课堂上执行以下操作：

```
 private static final ResourceBundle BUNDLE = ResourceBundle.getBundle("scheduler");
    private static final String DRIVER  = BUNDLE.getString("bd.driver");
    private static final String CONNECTIONURL  =BUNDLE.getString("bd.url");
.... 
```

但相反，我看到很多人建议使用属性，然后我必须对这样的事情做同样的事情（如果我想保持类静态并且没有适当的构造函数）：

```
static {
        prop = new Properties(); 
        try {                prop.load(ReportsDB.class.getClassLoader().getResourceAsStream("config.properties"));
        } catch (IOException ex) {
            Logger.getLogger(ReportsDB.class.getName()).log(Level.SEVERE, null, ex);
            throw new RuntimeException(ex);
        }
    }

    private static final String DRIVER  = prop.getProperty("bd.driver");
    private static final String CONNECTIONURL  = prop.getProperty("bd.url"); 
```

那么，为什么我不应该使用 the`ResourceBundle`而不是`Properties`当第二个更冗长时呢？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-14T20:14:40.693

> 那么，当第二个更冗长时，为什么我不应该使用 ResourceBundle 而不是 Properties 呢？

因为那不是`ResourceBundle`目的。类的[描述](http://docs.oracle.com/javase/7/docs/api/java/util/ResourceBundle.html)开始于：

> 资源包包含特定于语言环境的对象。当您的程序需要特定于语言环境的资源（例如字符串）时，您的程序可以从适合当前用户语言环境的资源包中加载它。通过这种方式，您可以编写在很大程度上独立于用户语言环境的程序代码，从而将资源包中的大多数（如果不是全部）特定于语言环境的信息隔离开来。

这听起来像你的用例吗？我不这么认为。

听起来问题*纯粹*是加载属性文件的冗长：所以编写一个实用程序方法来做到这一点。那么你的代码可以很简单：

```
private static final Properties CONFIGURATION = PropertyUtil.load("scheduler.properties");
private static final String DRIVER = CONFIGURATION.getString("bd.driver");
private static final String CONNECTIONURL = CONFIGURATION.getString("bd.url"); 
```

诚然，我并不热衷于像这样以依赖于顺序的方式使用静态字段初始值设定项......我很想将所有配置封装在一个单独的类中，因此您可以编写：

```
private static final SchedulerConfiguration CONFIG = 
    SchedulerConfiguration.load("scheduler.properties"); 
```

然后使用`CONFIG.getDriver()`每次都可以从属性中获取的等，或者使用一个字段，或者其他什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-11-23T08:53:06.150

一个具体的区别是`ResourceBundle.getBundle("scheduler")`它将在类路径（例如 src 包文件夹）中搜索文件。如果您调用`ResourceBundle.getBundle("myfile")`外部文件，您将获得`MissingResourceException`.

如果要使用外部文件（例如位于项目根目录中的文件），可以使用 Properties 类：

```
Properties configuration = new Properties();
try (InputStream input = new FileInputStream("configuration.properties")) {
        configuration.load(input);
        System.out.println("Configuration value: " + configuration.getProperty("key"));
    } catch (IOException e) {
        e.printStackTrace();
    } 
```

# java - 数组中的多数元素

> ID：14883003
> 
> 赞同：-2
> 
> 时间：2013-02-14T19:59:15.810
> 
> 标签：java

```
public class rough{
 public static int arrMajority1(int A[]){
  int n = A.length;
  int c = 1;
  for(int i=0;i>A.length;i++){

    for(int j=i+1;j<A.length;j++)
     if (A[i]==A[j])
      c=c+1;
      if (c>(A.length/2)){
      return A[i];
      }
     }
     return -1;
    }
    public static void main(String[] args){
     int A[] = new int [] {5,5,8,7,5};
    // int arrMajority1 = A[0];
     System.out.println(" " + arrMajority1(A));
    }
} 
```

大小为 N 的数组 A 中的多数元素是出现超过 N/2 次的元素。例如 (3,3,4,2,4,4,2,4,4) 有一个多数元素 (4)，而数组 (3,3,4,2,4,4,2,4) 有没有多数元素。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:07:03.020

如果问题是问这段代码有什么问题，我认为主要问题是外`for`循环中的条件。我认为应该是：

```
for(int i = 0; i < A.length; i++) { 
```

（注意`<`而不是`>`）。

另一个问题是您可能需要`c`在外循环的每次迭代之前重置计数器`for`（否则，它不会保留正在检查的*当前*元素的计数）。所以尝试将语句移动到内部循环`int c = 1;`上方的空白行。`for`

# node.js - Node.js 缓冲套接字数据

> ID：14883004
> 
> 赞同：0
> 
> 时间：2013-02-14T19:59:26.913
> 
> 标签：node.js, express, socket.io

我正在使用 node.js、express.js、socket.io 等所有东西的当前版本...我正在尝试连接到一个服务器，该服务器的唯一目的只是发送文本，然后将其发送到通过连接的 Web 客户端套接字.io。文本只是具有标准行结尾的字符串，最大数据速率约为 1024 字节/秒。我的代码，核心位，是这样的

```
var express = require('express')
  , app = express()
  , routes = require('./routes')
  , user = require('./routes/user')
  , server = require('http').createServer(app)
  , io = require('socket.io').listen(server)
  , path = require('path')
  , dataSourcePort = 5000
  , host = "10.0.1.32"
  , dataStream = require('net').createConnection(dataSourcePort, host);

dataStream.setEncoding('utf8');

io.sockets.on('connection', function (socket) {
    dataStream.on('data',function(data){
        socket.emit("stuff",data);
    });  
  });

app.configure(function(){
  app.set('port', process.env.PORT || 3000);
  app.set('views', __dirname + '/views');
  app.set('view engine', 'jade');
  app.use(express.favicon());
  app.use(express.logger('dev'));
  app.use(express.bodyParser());
  app.use(express.methodOverride());
  app.use(app.router);
  app.use(express.static(path.join(__dirname, 'public')));
});

app.configure('development', function(){
  app.use(express.errorHandler());
});

app.get('/', routes.index);
app.get('/users', user.list);

server.listen(app.get('port'), function(){
  console.log("Express server listening on port " + app.get('port'));
}); 
```

这一切都很好而且很花哨，但是每隔一段时间它就会挂起，因为数据停止发送给客户端。我假设缓冲区被塞满了沿线的某个地方，但不确定。有没有更好的方法来做到这一点并避免填充部分？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T03:04:11.480

我看到的主要问题是您永远不会取消绑定您的`data`处理程序，因此当人们连接和断开连接时，您将累积`data`侦听器和内存使用量，并浪费资源尝试将数据发送到断开连接的套接字。

```
io.sockets.on('connection', function (socket) {
  function ondata(data){
    socket.emit("stuff",data);
  }

  function ondisconnect(){
    dataStream.off('data', ondata);
    socket.off('disconnect', ondisconnect);
  }

  dataStream.on('data', ondata);
  socket.on('disconnect', ondisconnect);
}); 
```

# javascript - 将javascript添加到html文件中

> ID：14883005
> 
> 赞同：0
> 
> 时间：2013-02-14T19:59:28.050
> 
> 标签：javascript, html, conditional-statements, noscript

我正在尝试将一个简单的条件添加到 html 文件中作为测​​试。我正在尝试创建一个简单的文件，告诉用户他的 javascript 是否启用。

```
 <Noscript>
        <A>Javascript is disabled</a>
    </noscript>

    <Script type="text/javascript" language="javascript">
        <A>Javascript is enabled</a>
    </script> 
```

运行脚本时，出现语法错误。如果我将类型更改为 javascript，错误就会消失，但代码不起作用。为什么我会收到此错误，任何人都可以推荐一个好的 javascript 编辑工具，因为我正在使用记事本学习。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:10:20.037

要使用 javascript 打印，请使用`document.write('...');`

这是一个可以学习 Javascript 的好网站 -> [http://www.codecademy.com/tracks/javascript](http://www.codecademy.com/tracks/javascript)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T20:07:49.023

noscript 标签将为没有启用 JavaScript 的用户提供帮助。对于启用它的用户，请使用 JavaScript 来显示启用的文本。

```
<noscript>
JavaScript is not available
</noscript>

<p id="enabled">
</p>

<script>
var enabledTag = document.getElementById("enabled").innerHTML = "Javascript is enabled";
enabledTag.appendChild(document.createTextNode("Javascript is enabled"));
</script> 
```

[在 jsFiddle 上试试吧！](http://jsfiddle.net/adamzr/vcDkC/)

# java - Java中的年龄计算

> ID：14883008
> 
> 赞同：1
> 
> 时间：2013-02-14T19:59:31.987
> 
> 标签：java, calendar

我正在尝试创建一个小型命令行 java 应用程序，该应用程序将允许输入日期并将其与当前日期进行比较并返回一个整数，该整数表示输入日期和当前日期之间的年数。这是以年计算一个活人的年龄。到目前为止，我发现我需要使用 Calendar 对象，但我不知道如何从当前年份中减去输入的年份并返回一个整数。你能帮我吗？只需在比较日期的机制上达到最高点。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T20:04:32.177

一旦你`Calendar`用正确的日期初始化了一个对象，你就可以调用该`get(Calendar.YEAR)`值来获取一个表示年份的整数。对两个日期执行此操作并减去。

您还需要获取月份和日期并进行比较，因为如果结束日期的月份/日期低于开始日期，那么您需要从较早的结果中减去 1（该年份尚未完成） .

通常对于生日，您不关心时间组件（小时/分钟/秒），因此某些库可能会为您提供不同的结果（在极少数情况下）——在这种情况下自行推出是合理的。

# r - 如何在x轴和y轴上为R中的散点图制作不同的比例（间隔）

> ID：14883009
> 
> 赞同：0
> 
> 时间：2013-02-14T19:59:26.243
> 
> 标签：r, scatter-plot

我的数据中有两个连续变量（A 和 B）。我想用 R 中的回归线制作散点图。我认为这很容易。但是我怎样才能为 X 轴上的 A 和 y 轴上的 B 制作不同的比例（间隔）？比如 X 轴上的 A：2、4、6、8、10，间隔是 2。如何将其更改为：1、2、3、4、5、6、7、8、9、10 其中间隔为 1。y 轴类似。

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T02:15:27.013

[Robert Kabacoff 的网站上](http://www.statmethods.net/advgraphs/axes.html)有很好的说明。简而言之，您可以使用以下代码：

```
z  =  c(1:10)
plot (A,B) #add whatever specifications you need
axis (1, at=z, labels=z)  #1 indicates the lower horizontal axis;  1=bottom, 2=left, 3=top, 4=right 
```

# javascript - 页面顶部的 JSF 滚动条

> ID：14883010
> 
> 赞同：5
> 
> 时间：2013-02-14T19:59:44.597
> 
> 标签：javascript, jquery, jsf, primefaces, omnifaces

我想知道如何制作浏览器的滚动条。转到页面顶部。我正在开发一个太大的注册屏幕，它包含一些需要的字段。如果未通知必填字段，它会向用户显示错误消息。问题是滚动条上不去，我想让她到页面顶部。我正在使用 Primefaces 和 JQuery，但没有这个工作。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-15T14:15:54.543

```
<div id="msg"> 
```

内容页

```
 onclick="javascript:window.location='#msg'" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T21:13:13.307

我必须说你的问题看起来像是两个人之间的一些讨论，但我会尽力给出答案。我想你有`p:commandButton`提交表格。

首先添加 JavaScript 函数：

```
<script type="text/javascript">
  function handleResponse(xhr, status, args) {
    if (args.validationFailed) {
      window.scrollTo(0, 0);
    }
  }
</script> 
```

`validationFailed`是由 PrimeFaces 隐式添加的回调参数，以防母鸡验证失败。

现在，`commandButton`：

```
<p:commandButton value="Submit" actionListener="#{myBean.submit}" oncomplete="handleResponse(xhr, status, args)"/> 
```

这将在 AJAX 请求完成后调用 JavaScript 函数。

这是我所能建议的，你没有提供太多信息。根据您的需要调整此代码。

# architecture - 人们一直在谈论的这个堆栈是什么？

> ID：14883016
> 
> 赞同：0
> 
> 时间：2013-02-14T20:00:00.520
> 
> 标签：architecture, startup

一段时间以来，我一直在关注科技初创公司的场景，一个让我困扰的词是“堆栈”这个词，很多初创公司都在谈论他们如何为开发人员提供“堆栈”。

谁能解释一下他们在说什么？

堆栈是中间件的新词吗？还是某种虚拟机？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T20:02:50.417

堆栈是一组协同工作的服务。例如，LAMP 是一组使用 Apache、MySql 和 Php（或 python 或 perl）的 linux 机器。它们倾向于一个在另一个之上使用，所以他们称之为堆栈。尽管实际上它们更像是筒仓——一些东西彼此堆得很高（linux/apache/php 和 linux/mysql）。

# jquery - 使用 jQuery Validate 插件确保三个复选框中的至少一个被选中

> ID：14883017
> 
> 赞同：2
> 
> 时间：2013-02-14T20:00:00.707
> 
> 标签：jquery, jquery-validate

使用 jQuery Validate 插件，我如何确保至少三个复选框中的一个已被选中？到目前为止，我能做的最好的事情是使所有三个复选框都成为必需的（这不是我想要的），我的代码如下。

我尝试在 jQuery Validate 演示页面上使用[此示例](http://jquery.bassistance.de/validate/demo/)，但这要求每个复选框字段都具有相同的名称。我无法做到这一点，因为这些字段是从 CMS 中提取的，并且它们每个都需要不同的名称。

我想将其保留在 jQuery validate 中，因为我在这里验证了许多其他字段（已删除以保持此示例干净），这是我可以用我有限的 JS/jQuery 知识验证表单的唯一方法。提前感谢您对此的任何帮助。

这是我的 HTML：

```
<form class="my_form" method="post" action="/" >

  <div><ul class="form_errors"></ul></div>

  <label><input class="my_checkbox_group" id="my_checkbox_1" name="my_checkbox_1[]" type="checkbox" value="Yes"> My checkbox 1</label>
  <label><input class="my_checkbox_group" id="my_checkbox_2" name="my_checkbox_2[]" type="checkbox" value="Yes"> My checkbox 2</label>
  <label><input class="my_checkbox_group" id="my_checkbox_3" name="my_checkbox_3[]" type="checkbox" value="Yes"> My checkbox 3</label>

  <input type="submit" value="Submit" />

</form> 
```

这是我的 JS：

```
$(".my_form").validate({
  errorLabelContainer: ".form_errors",
  wrapper: "li",
  rules: {
    'my_checkbox_1[]': { required: true },
    'my_checkbox_2[]': { required: true },
    'my_checkbox_3[]': { required: true }
  },
  messages: {
    'my_checkbox_1[]': "This field is required",
    'my_checkbox_2[]': "This field is required",
    'my_checkbox_3[]': "This field is required"
  }
}); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-14T20:21:23.280

使用[文件中包含](https://github.com/jzaefferer/jquery-validation/blob/master/additional-methods.js#L337)[的](https://github.com/jzaefferer/jquery-validation/blob/master/additional-methods.js#L337)`require_from_group`规则。[`additional-methods.js`](https://github.com/jzaefferer/jquery-validation/blob/master/additional-methods.js#L337)

```
rules: {
    'my_checkbox_1[]': {
        require_from_group: [1, ".my_checkbox_group"]
    }
} 
```

*   第一个参数是需要的项目数。
*   第二个参数是`class`分配给分组中的所有元素。

*   还可以使用[该`groups`选项](http://docs.jquery.com/Plugins/Validation/validate#toptions)将三条消息合并为一条。

新代码：

```
$(document).ready(function () {

    $(".my_form").validate({
        errorLabelContainer: ".form_errors",
        wrapper: "li",
        groups: {
            names: "my_checkbox_1[] my_checkbox_2[] my_checkbox_3[]"
        },
        rules: {
            'my_checkbox_1[]': {
                require_from_group: [1, ".my_checkbox_group"]
            },
            'my_checkbox_2[]': {
                require_from_group: [1, ".my_checkbox_group"]
            },
            'my_checkbox_3[]': {
                require_from_group: [1, ".my_checkbox_group"]
            }
        }
    });

}); 
```

**工作演示：http: [//jsfiddle.net/ya7Px/](http://jsfiddle.net/ya7Px/)**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T20:12:35.250

使用位于 Additional-methods.js 中的 require_from_group 方法，并将类名作为第一个参数和所需的数字作为第二个参数

```
 <input class="productinfo" name="partnumber">
 <input class="productinfo" name="description"> 
```

...将验证，除非其中至少有一个被填满。

```
partnumber:  {require_from_group: [1,".productinfo"]},
description: {require_from_group: [1,".productinfo"]} 
```

[https://github.com/jzaefferer/jquery-validation/blob/master/additional-methods.js#L337](https://github.com/jzaefferer/jquery-validation/blob/master/additional-methods.js#L337)

# emacs - Emacs：跳回到以前的查询替换位置

> ID：14883022
> 
> 赞同：2
> 
> 时间：2013-02-14T19:41:51.237
> 
> 标签：emacs

我经常这样做：`[M-%]`to `query-replace`，然后点击`[y]`几次，然后我越过了我正在改变事物的区域，所以我点击`[q]`完成。

然后我想让光标回到我原来的位置，所以这就是它变得尴尬的地方。我`[C-_]`到`undo`最后一次替换，然后将光标移到字符上，然后`undo`再次重做最后一次替换。现在光标在我一直在编辑的地方，但必须有更好的方法。

（我很高兴回到我开始替换的地方，或者最后一次替换发生的地方。）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T20:43:20.260

`C-u``C-SPC`跳转到标记（如 Blrfl 指出的那样自动设置），然后从本地标记环中弹出前一个标记（因此您可以重复该过程以移动到前一个标记）。

我认为这比 更可取`exchange-point-and-mark`，因为后者会重新激活标记，以瞬态标记模式突出显示该区域，在这种情况下您不希望这样做。（除非你想在你开始的点和最终替换的位置之间来回跳转，在这种情况下，这`exchange-point-and-mark` *正是*你想要的。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T20:02:44.713

退出后，标记将是您开始的地方，而点将是您停止的地方。 `C-x C-x`将交换两者，把你开始的地方。

# regex - SVN：添加到全局忽略，除非在文件夹内

> ID：14883023
> 
> 赞同：0
> 
> 时间：2013-02-14T20:00:20.947
> 
> 标签：regex, svn, global, svnignore

我正在尝试将一个**全局**过滤器添加到 TortiseSVN 中，它将忽略 Web.config，除非该文件位于“视图”文件夹下。

```
Project
+- Views
|+- Web.config <-- Do not ignore
+-Web.config <-- Ignore 
```

我知道我可以将单个文件添加到忽略列表中。但我不想对我所有的项目都这样做。所以我正在寻找一个可以做到这一点的**GLOBAL过滤器。**

![TortiseSVN 中的全局忽略设置](../Images/f07d3f8bd251ebf1d9f4b098132c3f67.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T20:13:09.537

Project 目录的 svn:ignore 属性必须列出 Web.config，而 Views 目录的属性则不能。svn:ignore 属性是基于每个目录的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T20:29:53.727

服务器将忽略作为 svn 属性（这意味着它们需要与特定*文件*关联，并且目录*是*文件）。

[递归设置忽略列表](http://svnbook.red-bean.com/en/1.7/svn.ref.svn.c.propset.html)

```
svn -R propset svn:ignore -F somefile.txt rootdir 
```

停止忽略特定目录中的某些内容

```
svn propdel svn:ignore path/to/dir 
```

以上的一些组合将允许您忽略整个树中的项目，同时忽略正确目录中的项目。

没有将模式匹配忽略配置到某个目录路径这样的事情，因为当忽略应用/停止应用到实际文件而不触发非用户启动的文件上方目录的修改时，将很难解决。SVN（明智地）决定它是一个修订控制系统，而不是一个修订自动化系统。

基于文件的修订控制系统没有这样的疑虑，但它们有不同的问题，例如无法正确处理文件重命名/复制/移动/等的历史记录。

# java - 最长重复子串后缀树 dfs

> ID：14883030
> 
> 赞同：0
> 
> 时间：2013-02-14T20:00:38.497
> 
> 标签：java, string, algorithm, tree

我在实现这一点时遇到了一些麻烦。我知道我需要进行深度优先搜索以找到最深的路径，该路径将给出子字符串的索引。在实施 dfs 时遇到一些问题，可能是我的理解不佳：

```
int getDeepestPath(TreeNode node)
{
    int maxDistance = 0;
    TreeNode maxNode;
    if(node == null) return 0;
    System.out.println(node.getSuffix());
    if(node.getSuffix() != -1) return 0;  
    else
    {
        TreeNode nextNode = node.getChild();
        while(true)
        {
            int distance = 0;
            if(nextNode != null)
            {
                distance = (nextNode.getRightLabel() -nextNode.getLeftLabel()) + 1;
                System.out.println(distance + " distance");
                distance = getDeepestPath(nextNode,t2Info) + distance;
                if(distance > maxDistance) maxDistance = distance;
                nextNode = nextNode.getSibling();
            }
            else break;
        }
    }

    System.out.println(maxDistance);
    return maxDistance;
} 
```

最终的目的是存储最深的节点和路径的长度——我现在只是想打印路径的长度。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T20:05:49.237

为什么不直接使用堆栈实现 DFS 并将变量添加到`node`被调用的`visited`. 每次将节点推送到堆栈时，标记`visited = true`. 伪代码

```
root.visited = true;
root.push()
while(Stack.isEmpty()) {
  if(!root.next.visited) {
    root.next.push()
  }
} 
```

实现查找叶子、转到下一个分支和弹出的逻辑。这是一个通用逻辑，如果你有一个二叉树，你可以改变它，让它更简单，只有两个孩子（左和右）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T21:56:34.330

你的假设是错误的。

在后缀树中，每个节点都应该包含一个在该节点上终止的字符串的键列表。如果列表为空，则该节点没有定义任何字符串。无需在树中找到长路径。例如，如果树中有三个字符串，“app”（1）、“apple”（2）和（5）以及“apple pie”（3），那么树将如下所示：

```
"app" 1  
  |  
"le" 2, 5  
  |  
" pie" 3 
```

# c++ - 在库中使用 srand() 的问题

> ID：14883035
> 
> 赞同：5
> 
> 时间：2013-02-14T20:00:57.007
> 
> 标签：c++, c, random, software-design

`srand()/rand()`在 3rd 方库中有广泛使用的调用，带有预定义的种子。在同一进程中组合不同的库时会出现问题。有时很难确保正确的调用顺序，混合`srand()`调用`rand()`是可能的。另一个问题是无法在应用程序级别选择种子值。作为一般规则，我们是否应该**避免`srand()`在库**（包括开源）中使用，将播种任务留给应用程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:15:15.247

`boost::random`由于您提到的原因，除其他外，在实际应用程序中使用C++11`random`库是更好的做法

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T20:07:46.257

如果图书馆使用硬编码的种子，那么是的，您应该有办法将这些种子更改为您声明为“足够随机”的种子。

此外，如果您使用的平台具有 /dev/urand 之类的东西，您可能可以使用它，或者如果您必须是多平台的，为什么不使用 OpenSSL 的随机数库之类的东西呢？OpenSSL 应该可以在您所针对的每个平台上使用，并且通常它已经安装，因此您只需要链接它。

# django - Django 的管理员缺少 css、图像等 - 无法在共享主机上正确设置静态文件

> ID：14883036
> 
> 赞同：0
> 
> 时间：2013-02-14T20:01:21.827
> 
> 标签：django, django-admin, web-hosting

在此先感谢您的帮助。

我正在尝试让 Django 在 Bluehost 上工作。Django 的管理站点已启用并可在[http://www.my-domain.com/admin/ 访问](http://www.my-domain.com/admin/)。但是，整个管理站点看起来就像没有样式或图像的纯 html - 与我在使用 Django 自己的服务器（带有`$ python manage.py runserver`）时看到的不同。

在四处寻找解决方案后，我尝试了以下方法：

1.  `STATIC_ROOT`在我的 settings.py中设置正确的值`STATIC_URL`（参见下面的代码）。
2.  跑步：

    ```
    $ python manage.py collectstatic 
    ```

    （由于某种原因，这似乎将文件复制到我项目的根文件夹，而不是我在 settings.py 中指定的 static/ 文件夹）

3.  访问管理站点 - 仍然看起来像普通的 html。

这是我的 settings.py 文件的摘录：

```
import os.path
import sys

# (some more code here)

PROJECT_ROOT = os.path.normpath(os.path.dirname(__ file__))
STATIC_ROOT = os.path.join(PROJECT_ROOT, 'static')
STATIC_URL = '/static/'
STATICFILES_DIRS = (
    # empty
)
STATICFILES_FINDERS = (
    'django.contrib.staticfiles.finders.FileSystemFinder',
    'django.contrib.staticfiles.finders.AppDirectoriesFinder',
) 
```

以下是我的 public_html 文件夹中的 .htaccess 文件的外观：

```
AddHandler fcgid-script .fcgi
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_URI} !=/favicon.ico
RewriteCond %{REQUEST_URI} !^/static/
RewriteRule ^(.*)$ my_fcgi_file.fcgi/$1 [QSA,L] 
```

请注意以下事项：

*   我无权访问 httpd.conf。
*   每当我使用“python manage.py collectstatic”时，它都会将文件复制到我项目的根文件夹中，而不是我项目的静态文件夹（我在 中指定的文件夹`STATIC_ROOT`）中。我尝试将它们手动复制到此文件夹中，但管理站点仍然看起来像纯 html。

如果您需要任何其他信息，请告诉我。

任何帮助都感激不尽 ：）

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:37:19.343

在您的 .htaccess 文件中，您将过滤掉对 ^/static/ 的请求，因此您的重写规则将不适用。如果您将静态文件复制到`public_html/static/`，您应该会看到管理员 css。

否则，如果您想将请求指向您的静态文件目录

尝试删除

```
RewriteCond %{REQUEST_URI} !^/static/ 
```

并添加一条规则以将请求指向您的静态文件所在的位置

```
RewriteRule ^(static/.*)$ path/to/static/files [L] 
```

该`[L]`组件意味着最后一个，是告诉 apache 不要为以静态开头的路径运行其他规则。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-28T16:40:06.957

我也遇到了这个问题并且能够解决它，所以我想分享这个。

> 每当我使用“python manage.py collectstatic”时，它会将文件复制到我项目的根文件夹中，而不是我的项目的静态文件夹（这是我在 STATIC_ROOT 中指定的文件夹）中。

您指定：

```
PROJECT_ROOT = os.path.normpath(os.path.dirname(__ file__))
STATIC_ROOT = os.path.join(PROJECT_ROOT, 'static') 
```

`__`和之间有一个空格`file__`。不确定这是否只是一个复制和过去的问题，但如果 Django 无法读取设置，这可能就是问题所在。

更有趣的部分是如何弄清楚要使用什么 RewriteRule。有些人建议`Alias`将静态文件和`RewriteRule`cgi 结合起来。但是，这不起作用，因为别名是在重写后评估的，并且必须提前处理静态，因此静态 url 不会传递给 cgi。

了解所有内容的位置很重要，因为`.htaccess`文件搜索相对于其自身位置的文件。所以这就是它在我的特定环境中寻找的内容。

我在具有 ssh 访问权限的虚拟服务器上运行 Django，这意味着我无权访问`/srv/www`例如所以一切都在我的主目录中：

```
/home/<user>/ 
```

有我的用户 www root，包括`.htaccess`和静态文件：/home//html /home//html/.htaccess /home//html/static

这是里面的两条重要线`setting.py`。

```
STATIC_URL = '/static/'
STATIC_ROOT = '/home/<user>/html/static/' 
```

我没有`STATICFILES_DIRS`，`STATICFILES_FINDERS`因为我使用 Django 1.6.1 中的默认值。

当我跑

```
python manage.py collectstatic 
```

我的应用程序和项目静态目录中的所有内容都被复制到`STATIC_ROOT`. `STATIC_URL`是引用静态文件的字符串 Django 前缀 url。因此，当 Apache Web 服务器接收到类似的 URL 时`http://www.mydomain.com/static/mystyle.css`，它需要知道不能将其重定向到 Django 以及在哪里查找文件`mystyle.css`。

所以这是我的`.htaccess`：

```
RewriteEngine on
RewriteRule ^static/(.*)$ static/$1 [L]
RewriteRule ^(.*)$ /fcgi-bin/<django-fcgi-file>/$1 [QSA,L] 
```

如您所见，我正在使用 fcgi，其他人可能使用 wsgi，但这不是问题。更重要的是，我添加了这一行`RewriteRule ^static/(.*)$ static/$1 [L]`。

它告诉 Apache，只要 URL 以`static`（没有前缀斜杠！）开头，它应该将后面的所有内容`(.*)`（将被引用为`$1`）重定向到目录`static`并附`$1`加到它。`[L]`正如 Tim Edgar 所解释的那样，它告诉 Apache 更喜欢这条规则。

这对我有用。建议的一些相关答案`/static/$1/`（带有前缀斜杠）不起作用（因为它不是相对路径）。在我的情况下，该`static`目录位于也位于的`html`目录中`.htaccess`。所以相对路径在这里有效。

如果我要根据 Tim 对我的环境的回答使用 RewriteRule，它应该如下所示：

```
RewriteRule ^(static/.*)$ $1 [L] 
```

目标路径很简单`$1`，因为匹配中已经包含单词`static/`。

# knockout.js - 同时使用映射和验证插件的淘汰赛。获取客户端错误

> ID：14883037
> 
> 赞同：1
> 
> 时间：2013-02-14T20:01:27.203
> 
> 标签：knockout.js, knockout-mapping-plugin, knockout-validation

我正在使用淘汰赛 js 在后端使用 asp.net mvc 4 构建我的应用程序。我们正在使用 knockout.mapping 来填充来自 MVC 服务调用的 observables

现在我正在尝试使用 Knockout.Validation 插件添加验证，如下所示：

```
self.sDetail(ko.mapping.fromJS(s));
var validationOptions = { 
                          insertMessages: true, 
                          decorateElement: true,      
                          errorElementClass: 'errorFill' 
                         };
ko.validation.init(validationOptions);
self.sDetail.Year.extend({ required: true }); 
```

当我运行它时，我收到以下错误：

```
Error: Unable to get property 'extend' of undefined or null reference 
```

当我调试时，我发现 sDetail 显示为空。当我 applyBindings 输入正确填充。在什么时候我可以访问 ko 视图模型的属性。有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T00:55:15.860

在这里找到了一个解决方案： [Knockout Mapping Validation](https://stackoverflow.com/questions/13933401/knockout-mapping-validation)

基本上必须在对映射的调用中扩展属性

```
var validationMapping = {
// customize the creation of the name property so that it provides validation
Year: {
    create: function(options) {
        return ko.observable(options.data).extend( {required: true} );
    }
}
};

  self.sDetail(ko.mapping.fromJS(s,validationMapping));
 var validationOptions = { 
                      insertMessages: true, 
                      decorateElement: true,      
                      errorElementClass: 'errorFill' 
                     };
  ko.validation.init(validationOptions); 
```

self.sDetail.Year.extend({ required: true });

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T01:44:25.253

原始代码中的实际问题是您试图访问`Year`保存映射模型的可观察对象上的属性，而不是模型本身（假设`sDetail`是一个可观察`self`对象，我只能假设它是您的实际视图模型）。这就是我在评论中的意思。您映射了observable 持有的*值*，因此您需要读取该值。您尝试了`extend()`一个在可观察对象上不存在的属性，因此出现了错误。

```
self.sDetail; // <- your observable holding the model
self.sDetail.Year; // <- undefined, observables don't have a `Year` property
self.sDetail.Year.extend(...); // <- error 
```

解决方法是调用你的 observable 来获取它持有的模型，然后你可以访问任何你想要的东西。

```
self.sDetail().Year.extend({ required: true }); // this should work 
```

* * *

这并不是要从您的最终解决方案中删除，从映射设置中扩展将是可取的，因为它会导致更清洁的代码（恕我直言）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-15T09:31:06.580

要获得更清洁、更易读的解决方案，请使用显式声明的 VM

```
DetailsViewModel = function(data) {
   this.year = ko.observable().extend({ required: true });
   ko.mapping.fromJS(data, {}, this);
}; 
```

像这样使用

```
new DetailsViewModel(data); 
```

一个好的做法是显式声明执行实际域逻辑的所有成员。ko.mapping 可以自动自动映射仅演示文稿的成员。

**更新：**被一些人否决了，但这个解决方案非常有效且可读

[http://jsfiddle.net/hww8vk1n/1/](http://jsfiddle.net/hww8vk1n/1/)

# javascript - Javascript：onchange 还是 addEventListener？

> ID：14883038
> 
> 赞同：13
> 
> 时间：2013-02-14T20:01:31.500
> 
> 标签：javascript, onchange, addeventlistener

我对 Javascript 完全陌生。但是我之前对 Activescript 有所了解。我被教导使用 addEventListener 来处理事件。

但是当我谈到 JavaScript 时，虽然 addEventListener 是一个选项，但使用 addEventListener 似乎是一种次要的方式。相反，人们使用 onChange()。

除了句法上，是否有任何行为差异？

我还被教导要始终使用 removeEventListener。似乎不是很有必要。如果我使用onChange，是否不需要编码removeEventListener？

谢谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-14T20:03:30.310

两个主要区别：

*   [addEventListener](https://developer.mozilla.org/en/docs/DOM/element.addEventListener)与旧的 IE 浏览器不兼容
*   onchange 不添加事件侦听器：它替换现有的

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-14T20:03:15.083

`addEventListener`您可以附加多个事件侦听器。`onchange`属性不是这样。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-01-15T00:55:09.947

我个人认为 addEventListener 要好很多。您可以在 HTML5 中使用此示例

```
document.addEventListener("input", function(){
  target = window.event.target.value;
  window.event.target.nextSibling.nextSibling.value = target*2;
});
```

```
<input name="1" value="25">
<input name="2" value="50" readonly>
<p>Hello World</p>
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-02-21T11:37:03.677

你们说的都是真的，但是当“通过代码”进行更改时，似乎只有 onchange 才能捕获更改。

# ruby - Sinatra/Ruby 默认一个参数

> ID：14883045
> 
> 赞同：6
> 
> 时间：2013-02-14T20:01:50.333
> 
> 标签：ruby, sinatra

有没有办法在 Sinatra 中默认参数？

我目前正在查看是否`'start'`作为参数传递，但它似乎有点 hacky。如果我可以告诉 Sinatra 如果未指定某些参数，那将是很好的。

```
get '/comments/?' do
   # want to setup page stuff, default to first page if not specified
   params[:start] = 0 if !params[:start] 
end 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T22:22:34.410

确实可以`||=`这样使用，但是获取到params*后*设置params是一件很奇怪的事情。您更有可能*从*参数中设置变量。所以代替这个：

```
params[:start] ||= 0 
```

你肯定更有可能这样做：

```
start = params[:start] || 0 
```

如果你要这样做，那么我建议使用[fetch](http://www.ruby-doc.org/core-1.9.3/Hash.html#method-i-fetch)

```
start = params.fetch :start, 0 
```

如果您*真的*要在路由之前的参数哈希中寻找默认值，请使用[before 过滤器](http://www.sinatrarb.com/intro.html#Filters)

```
before "/comments/?" do
  params[:start] ||= 0
end 
```

* * *

### 更新：

如果您**从路由模式中**获取参数，那么您可以使用块参数给它一个默认参数，因为 Ruby（从 v1.9 开始）可以为块获取默认参数，例如

```
get "/comments/:start/?" do |start=0|
  # rest of code here
end 
```

该`start`参数将通过`start`局部变量（给定块）或通过`params[:captures].first`（[有关路由的更多信息，请参阅文档](http://www.sinatrarb.com/intro#Routes)）提供。

* * *

### 进一步更新：

当您将路由传递给动词方法（例如`get`）时，Sinatra 将使用该路由来匹配传入请求。匹配的请求会触发给定的块，因此明确您想要一些默认值的简单方法是：

```
get "/comments/?" do
  defaults = {start: 10, finish: 20}
  params = defaults.merge params
  # more code follows…
end 
```

如果您希望它看起来更干净，请使用助手：

```
helpers do
  def set_defaults( defaults={} )
    warn "Entering set_defaults"
    # stringify_keys!
    h = defaults.each_with_object({}) do |(k,v),h|
      h[k.to_s] = defaults[k]
    end
    params.merge!( h.merge params )
  end
end

get "/comments/?" do
  set_defaults start: 10, finish: 20
  # more code follows…
end 
```

如果您需要更重量级的东西，请尝试[sinatra-param](https://github.com/mattt/sinatra-param)。

* * *

### Sinatra::DefaultParameters 宝石

我非常喜欢这段代码，所以[我把它变成了 gem](https://rubygems.org/gems/sinatra-default_parameters)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T20:29:13.033

您可以在此处使用“或等于”运算符：`params[:start] ||= 0`

[http://www.rubyinside.com/what-rubys-double-pipe-or-equals-really-does-5488.html](http://www.rubyinside.com/what-rubys-double-pipe-or-equals-really-does-5488.html)

# javascript - Powershell Web 自动化 - 下拉列表问题

> ID：14883046
> 
> 赞同：0
> 
> 时间：2013-02-14T20:01:52.220
> 
> 标签：javascript, html, powershell, powershell-2.0

我正在用 PS 做一些网络自动化（屏幕抓取）。我有很多工作正常。我在使用下拉列表时遇到问题。

当我使用 `$doc.getElementById("ddlExtractName").SelectedIndex = 2`时，在某些列表中它会更改列表中的项目，但页面不会刷新。如果我通过单击手动更改列表框中的值，它会刷新。我不知道为什么有时它会起作用，有时却不起作用（即使在同一个网站上）。

我也无法访问列表 bu 索引中的项目。例如，我应该能够做到这一点：

```
$FF= $doc.getElementById("ddlFixedFileFormat")
$FF.options[$FF.SelectedIndex].text 
```

那返回一个错误`unable to index into an object`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T21:40:09.657

我终于让它工作了。我认为刷新页面时，我需要先将文档重新提取到我的变量中，然后再对其进行操作。

# nginx - Nginx 块 robots.txt 文件

> ID：14883049
> 
> 赞同：0
> 
> 时间：2013-02-14T20:02:10.593
> 
> 标签：nginx, robots.txt

我在 Ubuntu 服务器 12.04 上运行 Nginx 1.1.19 并且在执行 Googlebot 时遇到问题，请参阅 robots.txt 文件。[我使用了这篇文章](https://stackoverflow.com/questions/1090823/how-do-i-configure-nginx-to-redirect-to-a-url-for-robots-txt-sitemap-xml/14882762#14882762)的示例，但没有成功。为了测试该服务，我访问了网站管理员工具，点击“完整性 > 搜索为 Googlebot”...只是收到来自“未找到”、“页面不可用”和“robots.txt 文件不可访问”的消息“……

我还要确认是否应该对 中的文件`nginx.conf`或文件“默认”执行配置`/etc/nginx/sites-enabled`，因为在以后的版本中，我注意到可能会有所不同。这是我的基本设置。

```
root /usr/share/nginx/www;
index index.php;

# Reescreve as URLs.
location / {
    try_files $uri $uri/ /index.php;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T16:16:41.320

我设法通过添加命令“重写”策略服务器来解决我的问题，如下代码所示。在那之后，我回到谷歌网站管理员，用谷歌机器人重新搜索，它工作了。借此机会在这里留下我的代码，它将端口 80 重定向到 443 前缀和非 www 到 www。

```
# Redirect HTTP to HTTPS and NON-WWW to WWW
server {
    listen 80;
    server_name domain.com.br;
    rewrite ^ https://www.domain.com.br$1 permanent;

# Rewrite the URLs.
    location / {
    try_files $uri $uri/ /index.php;
    }
}
server {
    listen 443;
    server_name www.domain.com.br;

# Rewrite the URLs.
    location / {
    try_files $uri $uri/ /index.php;
}

    root /usr/share/nginx/www;
    index index.php;

    [...] the code continued here 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T20:25:50.983

[在这里](https://stackoverflow.com/questions/14860932/nginx-wordpress#comment20831821_14860932)查看我的答案。

关于将其添加到您的主`nginx.conf`文件或`/etc/nginx/sites-available`文件中，这取决于您，无论您希望它分别是全局的还是特定于站点的。

# serial-port - 30 秒延迟/超时后传输字节中的串行 SC16IS752 移位错误

> ID：14883056
> 
> 赞同：2
> 
> 时间：2013-02-14T20:02:44.353
> 
> 标签：serial-port, embedded-linux

我正在我们的嵌入式 Linux 设计中开发 SC16IS752 芯片。在正常的串行活动条件下，该芯片在两个 COM 端口上都能正常工作。然而，我们发现，在串行会话中，当您在大约 30 秒内不发送或接收数据时，TX 线上传输的下一个字节在所有波特率 38400 及以上的情况下都会发生位移。有趣的是，这个问题不会出现在 19k 或更低的波特率（较低的波特率）。

波特率越高，问题就越严重。在 38k 波特率下，发送的字节移动 1 位（尝试发送 0x66 并发送 0xB3）。在 115k 波特率下，发送的字节移动 4 位（尝试发送 0x66 并发送 0xF6）。

此问题仅在现有串行会话中 30 秒不活动后发生。这意味着新串行会话的第一个字节始终正确传输。

如果您等待 30 秒，而是在 NXP 芯片上接收到一个字节，这会以某种方式使 NXP 芯片处于良好状态，从而正确传输后续传输的字节（只要它比接收到的字节晚不到 30 秒） .

我翻阅了 SC16IS752 数据表、应用笔记和勘误表，但无济于事。我调查了睡眠模式、接收超时和所有状态寄存器。我还尝试在传输数据之前清除传输 fifos。我已经用完了可以尝试和调试的东西。我知道我通过 SPI 将正确的字节发送到 NXP 串行芯片，从我的 Linux 驱动程序中的调试。

顺便说一句，我正在使用的 Linux 驱动程序是由 Manuel Stahl 编写的，他在 Linux 内核邮件列表中发布了该驱动程序（未成功），试图将其放入 linux 内核。

后来调查发现：

我们已经连接了一个内联 RS-232 设备，它使用 LED 显示所有引脚的状态。我注意到我们的 SC16 串行芯片（配置为 DTE）在 Tx 或 Rx 事务处理后，其“TD”和“RTS”灯将激活 32 秒，此时 TD 和 RTS 灯都熄灭。

这意味着 SC16 芯片有 32 秒的超时时间，此时它会停用这些引脚。此时，一个 Tx 事务（让 SC16 芯片发送数据）将导致位移问题（和以前一样，它只是位移的第一个字节）。

这是有趣的部分：使用带有 Windows 的调试笔记本电脑和作为 CTE 连接的“RealTerm”（在 SC16 串行连接的另一端），它允许我们切换“CTS”引脚。当我切换此引脚（打开或关闭）时，它会“唤醒”SC16 芯片的 TD 和 RTS 灯，此时 Tx 事务（让 SC16 芯片发送数据）将成功！

所以总结如下：

*   当 SC16 芯片的 TD 和 RTS 灯亮时，后续的 Tx 交易成功。
*   SC16 TD 和 RTS 灯在 32 秒后超时（关闭）。后续的 Tx 交易存在位移问题。
*   当我通过切换 CTE 的 RTS 引脚来触发 SC16 芯片时，它“唤醒”了 SC16 芯片的 TD 和 RTS 灯，随后的 Tx 事务成功。

我在 SC16 数据表中没有看到任何提到这种超时的内容。唯一提到的是我禁用的“睡眠模式”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:02:44.353

我发现了问题。问题是我们使用的是 ISL4270E RS232 电平转换器（而不是 SC16IS752 演示板中使用的 SP3243E），它支持自动断电功能，它会在 30 秒不活动后关闭芯片。当它检测到数据并加电时会出现问题，它的速度不足以以 115k 波特率发送所有位。这就是为什么在较高的波特率下移位问题更严重的原因。

# asp.net - UpdatePanel 中的中继器 - 识别特定的中继器子控件

> ID：14883057
> 
> 赞同：0
> 
> 时间：2013-02-14T20:02:45.033
> 
> 标签：asp.net, vb.net, updatepanel, repeater

问题：如何确定*哪个*控件*触发了部分回发？

*control = 通过Repeater 控件动态生成的文本框。

高级：本质上我有一个封装了Repeater 控件的UpdatePanel。我使用转发器来动态添加文本框和占位符。

OnChange 其中一个文本框，我希望 UpdatePanel.Load Sub 能够确定哪个文本框发出请求，以便我可以将其他控件添加到其适当的占位符（也动态添加）。

目前我收到一个错误：“发现多个控件具有相同的 id 'X'。FindControl 要求控件具有唯一的 ID。

VB

```
Imports System.Data.SqlClient

Partial Class _Default
    Inherits System.Web.UI.Page

    Public RegisteredRows As New List(Of CustomRow)
    Public callbackResult As String = ""
    Public rptCount As Integer = 0

    Public Class CustomRow
        Public desc As String
    End Class

    Protected Sub Page_Load(ByVal sender As Object, ByVal e As EventArgs) Handles dynForm.Load
        Dim i As Integer
        For i = 0 To 3
            Dim cr As CustomRow = New CustomRow
            cr.desc = ""
            RegisteredRows.Add(cr)
        Next
        Repeater1.DataSource = RegisteredRows
        Repeater1.DataBind()

        Dim cm As ClientScriptManager = Page.ClientScript
        dynLit.Text = "<script type='text/javascript' language='javascript'> function HandleDynamic() { __doPostBack('" & btnDynamic.ClientID & "', null);}</script>"

    End Sub

    Protected Sub DataBound(ByVal sender As Object, ByVal e As RepeaterItemEventArgs)
        If Not e.Item.DataItem Is Nothing Then

            'Dim hdnBtn As Button = e.Item.FindControl("btnDynamic")
            Dim tb As TextBox = e.Item.FindControl("asbText")

            tb.Attributes.Add("onchange", "HandleDynamic();")
            'tb.Attributes.Add("onchange", " __doPostBack('" & btnDynamic.ClientID & "', null);")
            Repeater1.Controls.Add(tb)

            If RegisteredRows Is Nothing Then
                RegisteredRows = New List(Of CustomRow)
            End If

        End If

    End Sub

    Protected Sub upDynamic_Load(ByVal sender As Object, ByVal e As EventArgs)
        Dim uPanel As UpdatePanel = CType(sender, UpdatePanel)
        If sender.ID = "upDynamic" Then

            For i As Integer = 0 To uPanel.Controls.Count - 1
                If TypeOf uPanel.Controls(i) Is TextBox AndAlso uPanel.Controls(i).ID = "asbText" Then
                    If CType(uPanel.Controls(i), TextBox).Text <> "" Then
                        Dim lbl As New Label
                        lbl.Text = "Comments"

                        Dim txt As New TextBox
                        txt.Width = 100
                        txt.Text = "Hello World"

                        Dim ph As New PlaceHolder
                        ph = CType(sender.FindControl("phDynamic"), PlaceHolder)

                        ph.Controls.Add(lbl)
                        ph.Controls.Add(txt)
                    End If
                End If
            Next
        End If
    End Sub
End Class 
```

ASPX

```
<%@ Page Language="VB" AutoEventWireup="false" CodeFile="Default.aspx.vb" Inherits="_Default" %>

<%@ Register Assembly="System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"
    Namespace="System.Web.UI" TagPrefix="asp" %>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title>Dyanmic Prototype</title>
</head>
<body>
    <form id="dynForm" runat="server">
    <asp:ScriptManager ID="ScriptManager1" runat="server" EnablePageMethods="true" EnablePartialRendering="true" />
    <div>
        <table cellpadding="0" cellspacing="0">
            <tr>
                <td nowrap="nowrap">
                    <asp:Label ID="lblMain" runat="server" Text="Are we on?" ></asp:Label>
                </td>
            </tr>
            <tr>
                <td>
                    <asp:UpdatePanel ID="upDynamic" runat="server" ChildrenAsTriggers="false" UpdateMode="Conditional"
                        OnLoad="upDynamic_Load">
                        <ContentTemplate>
                            <asp:Repeater ID="Repeater1" runat="server" EnableViewState="false" OnItemDataBound="DataBound">
                                <HeaderTemplate>
                                    <table>
                                        <tr>
                                            <td nowrap="nowrap">
                                                <asp:Label ID="lblText" runat="server"  Text="Offense" />
                                            </td>
                                        </tr>
                                    </table>
                                </HeaderTemplate>
                                <ItemTemplate>
                                    <table>
                                        <tr>
                                            <td>
                                                <tr>
                                                    <td>
                                                        <asp:TextBox ID="asbText" runat="server" AutoComplete="Off" AutoCompleteType="Disabled"
                                                            EnableViewState="false" Width="350px"></asp:TextBox>
                                                    </td>
                                                </tr>
                                                <asp:PlaceHolder ID="phDynamic" runat="server" />
                                            </td>
                                        </tr>
                                    </table>
                                </ItemTemplate>
                            </asp:Repeater>
                            <asp:Button ID="btnDynamic" runat="server" Text="" Visible="false" />
                        </ContentTemplate>
                        <Triggers>
                            <asp:AsyncPostBackTrigger ControlID="btnDynamic" EventName="Click" />
                        </Triggers>
                    </asp:UpdatePanel>
                </td>
            </tr>
        </table>
    </div>
    </form>
</body>
</html>

<asp:Literal runat="server" id="dynLit"></asp:Literal> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T17:30:32.987

您是否尝试为文本框设置 id？

```
Dim txt As New TextBox
txt.Width = 100
txt.Text = "Hello World"
txt.id="textbox"+i 
```

# loops - 方案中的 for 循环

> ID：14883062
> 
> 赞同：1
> 
> 时间：2013-02-14T20:02:51.463
> 
> 标签：loops, lisp, scheme, racket, collatz

我有点困惑如何在方案中构造一个 for 循环。for 循环应该在第二部分中实现。它需要一个数字列表并将每个元素插入到第一部分的列表中以查找长度。我用电缆来获取第一个元素，但我需要一个 for 循环或其他什么来获得这样的输出：'(7 10 5 16 106 37) 这是我的代码：

```
#lang racket
; Part I
(define (sequence n)
(cond  [(= n 1)
      (list n)]
[(even? n)
( cons n(sequence( / n 2)))]
[(odd? n) 
( cons n(sequence (+(* n 3) 1))) ] ))

(sequence 3)

; Part II
(define (find-length items)
( cond [(null? items)
      (list items)]
  [find-length(length(sequence(car items))) ]   
  ))

  (find-length '(10 13 16 22 95 158)) 
```

这是输出：

```
 '(3 10 5 16 8 4 2 1)
 7 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T20:28:04.633

让我直截了当地说，您需要`items`列表中每个数字的 Collat​​z 序列的长度吗？显然这是作业，所以这次我不能直接回答。这是解决方案的一般结构，请填空：

```
(define (find-length items)
  (if (null? items)           ; if the list is null
      <???>                   ; return the empty list
      (cons                   ; otherwise `cons` the
       (length <???>)         ; length of Collatz sequence of first element
       (find-length <???>)))) ; and recur over the rest of the list 
```

测试程序，结果应该如下图：

```
(find-length '(10 13 16 22 95 158))
=> '(7 10 5 16 106 37) 
```

请注意，您的答案几乎是正确的 - 此过程的基本情况只是空列表，您忘记调用递归。在 Scheme 中，至少要知道，尽量不要考虑 while、for 循环：根据递归实现迭代，这是惯用的做法。搞清楚之后，您就可以开始使用Racket 中可用的内置[循环结构之一了。](http://docs.racket-lang.org/guide/for.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-28T09:51:15.973

我不想给出确切的答案，但您可以迭代整个列表并像这样找到这个长度。

```
(define (length lst)
(if (null? items)
'()
(+ 1  (length(cdr lst))))) 
```

通过这种方式，您可以递归地访问列表的所有元素。它找到添加的第一个元素`+1`，然后尝试找到`cdr`等于 的列表长度`length lst-1`。它会这样做，直到到达列表的末尾。

# dhcp - windows mobile force dhcp 更新

> ID：14883063
> 
> 赞同：1
> 
> 时间：2013-02-14T20:02:52.670
> 
> 标签：dhcp, windows-mobile-6.5

我们部署了几台 Windows Mobile 6.5 设备，其中一些设备偶尔会失去连接到 Internet 的能力。通过一次又一次地从 Wi-Fi 切换到 3G，我已经能够重现该问题。

当我重新创建问题时，我收到消息“无法联系 DHCP 服务器。使用缓存的租约信息。”

我搜索了谷歌，但无论如何我都找不到在 Windows Mobile 6.5 设备上强制续订 DHCP 租约。我还检查了连接管理器，但我没有看到任何看起来可以让我做我想做的事的东西。

这里有没有人知道如何或可以指出我正确的方向？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T14:20:12.097

请参阅 iphlpapi.h：IpReleaseAddress 和 IpRenewAddress

OpenNetCF 有一个 .net 包装器，AFAIK 也有一个可用的 MS 包装器。

如果您正在寻找免费工具： http: [//www.cambridgevx.com/vxipconfig.html](http://www.cambridgevx.com/vxipconfig.html)

# http - 通过 ssl/https 加载内部文件

> ID：14883064
> 
> 赞同：0
> 
> 时间：2013-02-14T20:02:49.173
> 
> 标签：http, google-chrome, ssl, https

我遇到了一个严重的问题。我正在尝试通过 https 加载页面，但它失败了。chrome 说类似“...的页面从 http:www.mysite... 运行了不安全的内容...”

Firefox 没有给出这个错误，但问题是即使我在我的页面上强制使用 https .. 我包含在页面中的 css/js/images 出于某种原因正在通过 http 加载.. 当我在本地运行它时版本（我的机器）并创建一个页面 https .. 它还包括 https 上的所有 css/js/images .. 但是当我在实时站点上执行相同操作时.. 它不使用 https ，因此错误..

我所有的包含都是相对的，我没有使用 http:// 包含任何文件

我完全迷失了..任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-03T16:43:50.830

我有同样的问题，但能够通过首先测试连接（如果它是否安全）来解决它：

```
$protocol = 'http://';
if (!empty($_SERVER['HTTPS'])) {
    $protocol = 'https://';
} 
```

然后在每个包含之前添加这个而不是协议：

```
<script type="text/javascript" src="<?php echo $protocol; ?>url.com/jquery-1.7.1.min.js"></script> 
```

# javascript - 调整 Draw2d Touch 的监听器大小

> ID：14883066
> 
> 赞同：0
> 
> 时间：2013-02-14T20:03:01.630
> 
> 标签：javascript, draw2d-js

如果这是一个愚蠢的问题，请原谅我，我是 Draw2d Touch 的新手（[http://www.draw2d.org/](http://www.draw2d.org/)）。我需要将侦听器附加到 Rectangle 以在调整 Rectangle 大小时通知我。我已经搜索了 API，但没有发现任何有用的东西。

我认为它可能位于 DragDropEditPolicy 但没有运气。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-08T10:31:03.450

你解决了这个问题了吗？如果不是，那么[JSON 示例](http://draw2d.org/draw2d_touch/jsdoc/#!/example/io_json_basic)应该会给你一个提示：

您可以添加事件侦听器：

```
canvas.getCommandStack().addEventListener(function(e){
    if(e.isPostChangeEvent()){
    // displayJSON(canvas); OR call your resize-handler-method
    }
}); 
```

这是你在调整大小完成后得到的（类似于 onMouseUpEvent）

或者您可以覆盖重绘方法（所有形状都继承了该方法。

# ios - 如何在 iOS 5 中集成 Facebook？

> ID：14883071
> 
> 赞同：0
> 
> 时间：2013-02-14T20:03:24.183
> 
> 标签：ios, facebook

我知道 Apple 创建了社交框架，但我的应用程序仅适用于 iOS 5，所以我需要知道还有哪些其他方法可以实现它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:05:49.080

一个快速的谷歌搜索把我带到了 facebook api 开发者网站，里面有关于这个主题的信息

[FacebookIOS教程](https://developers.facebook.com/docs/tutorials/ios-sdk-tutorial/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-05T07:13:51.493

用于发布文本和图像的社交框架，用户墙上的 url。有使用它的代码。添加导入语句

```
#import <Social/Social.h>
- (IBAction)postToFacebook
{
 spinner.hidden=YES;
if([SLComposeViewController isAvailableForServiceType:SLServiceTypeFacebook])
{
    SLComposeViewController *controller = [SLComposeViewController  composeViewControllerForServiceType:SLServiceTypeFacebook];

    [controller setInitialText:@"Check this Beautiful App of ASI Delhi Circle"];
   //[controller addImage:imageView1.image];
    [controller addURL:[NSURL URLWithString:@"http://play.google.com/store/apps/details?id=com.asidelhicircle"]];
    [self presentViewController:controller animated:YES completion:Nil];
}else
{
    UIAlertView *alert=[[UIAlertView alloc] initWithTitle:nil message:@"Please Login in Facebook application." delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:nil, nil];

    [alert show];
    [alert release];
} 
```

}

```
 - (IBAction)postToTwitter
{
  if ([SLComposeViewController isAvailableForServiceType:SLServiceTypeTwitter])
  {
    SLComposeViewController *tweetSheet = [SLComposeViewController
                                             composeViewControllerForServiceType:SLServiceTypeTwitter];
         [tweetSheet setInitialText:@"Check this Beautiful App of ASI Delhi Circle http://play.google.com/store/apps/details?id=com.asidelhicircle"];
    [self presentViewController:tweetSheet animated:YES completion:nil];
}else
{
    UIAlertView *alert=[[UIAlertView alloc] initWithTitle:nil message:@"Please Login in Twitter application." delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:nil, nil];

    [alert show];
    [alert release];
} 
```

}

# java - 通过对象序列化流发送具有不同字段的相同对象

> ID：14883073
> 
> 赞同：0
> 
> 时间：2013-02-14T20:03:29.820
> 
> 标签：java, multithreading, sockets, serialization

我有一个客户端/服务器程序，我`ObjectOutputStream`通过`writeObject()`和发送对象`readObject()`。

我发送的对象是由几个字段和另一个内部对象组成的类（让我们调用外部对象`Wrapper`和内部对象`Inner`。两个自定义对象都实现`serializable`.

我第一次发送`Wrapper`过来时，一切正常。存储在两者`Wrapper`中的所有内容，`Inner`所有字段都可以毫无问题地进行序列化和反序列化。

但是，当客户端随后修改`Inner`类，将其放入 中`Wrapper`并再次发送时，`Inner`服务器接收到的实例与第一次接收到的实例相同。

我的客户：

```
Inner inner = new Inner();
inner.setValue("value");

ObjectOutputStream out = new ObjectOutputStream(socket.getOutputStream());
out.writeObject(new Wrapper(inner)); 
```

服务器：

```
ObjectInputStream in = new ObjectInputStream(clientSocket.getInputStream());
Wrapper wrapper = (Wrapper) in.readObject();
String value = wrapper.getInner().getValue(); 
```

`Inner`客户端然后用不同的字符串（即包含其他字母然后第一个）修改类（与以前相同的实例）：

```
inner.setValue("newValue");
out.writeObject(new Wrapper(inner)); 
```

但是，当我查看`inner.getValue()`服务器上的 时，它并没有改变，仍然等于`"value"`.

在发送之前，我通过制作内部类的硬拷贝解决了这个问题：

```
Inner newInner = new Inner();
newInner.setValue("newValue");
out.writeObject(new Wrapper(newInner)); 
```

现在，新值已按应有的方式更新。

为什么序列化以这种方式工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T20:10:15.047

这是预期的行为[`ObjectOutputStream`](http://docs.oracle.com/javase/6/docs/api/java/io/ObjectOutputStream.html)。引用 Javadocs：

> 对单个对象的多个引用使用引用共享机制进行编码，以便对象的图形可以恢复到与原始对象相同的形状。

由于您使用的是相同的内部类引用，它只是发送对先前发送的对象的引用。它不会*检查*所有对象的所有字段以查看它们是否已更改。我怀疑这不仅`inner.getValue()`等于发送的第一个对象，而且`inner`服务器在第二个对象中接收到的对象与来自第一个对象的*对象*( `==`)相同`inner`。

如果您致电：

```
out.reset(); 
```

在发送带有调整`inner`字段的对象之前，您的代码应该可以工作。该`reset()`方法清除了有助于序列化流高效的参考缓存。作为旁注，`reset()`如果您通过流发送*大量*临时对象，则尤其必要，因为否则这些对象会缓存在内存中并可能导致堆耗尽。

# php - 文本格式无法正常工作

> ID：14883076
> 
> 赞同：0
> 
> 时间：2013-02-14T20:03:45.723
> 
> 标签：php, html, css

基本上我所拥有的是一个接受用户评论的讨论论坛。它取自文本区域并放入数据库。当放入数据库时​​，它看起来像这样：

```
<p>This is a paragraph.</p>

<p>This is another paragraph.</p> 
```

查看单个帖子时，它看起来像这样：

```
This is a paragraph.
This is another paragraph. 
```

查看主页时，它看起来像这样：

```
This is a paragraph.This is another paragraph 
```

我想知道的是如何制作，以便单个帖子和查看者可以看到多个帖子的主页的格式相同。如果有帮助的话，我正在使用 PHP。谢谢！

此外，如果它有帮助，这是我用来将文本回显到主页的 php 代码：

```
echo '<div style="padding:4px; style="font-size:9pt;"">';
        if (strlen($blogentryText) > 500) {
                $blogentryText = substr($blogentryText, 0, 500). '...<a href="'.WEBSITE.'projects/commercialize/pipeline/blog/view.php?id='.$blogentryID.'&project='.$coaching.'&cycle='.$cycle.'">[read more]</a>';
                    }
                echo $blogentryText;
            echo '</div>'; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T20:07:29.303

当您提到使用两个段落时，段落标签始终使用下一行...如果在某个页面上您正在查看两个

在同一行中标记文本，这意味着在段落标记上应用了一些 CSS，它覆盖了使用行位置的默认属性。它不是 php 或 html 问题。它与您的 CSS 有关。使用 firebug 或 chrome 或其他东西检查标签上应用的 CSS 并将其删除或在所有页面上使用相同的 CSS，使其看起来相同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T20:34:43.170

你不应该允许将 html 标签插入到你的数据库中，你会被黑客入侵。如果要保留格式，可以使用 htmlentities() 之类的东西，它将任何 html 转换为其相等的实体，即："<" 变为 "<"; 和 ">" 变成 ">";，（分号紧挨着那些，但我把它们省略了，否则你只会看到一个小于和大于号）然后当你显示页面时，你使用 html_entity_decode()

编码 [http://www.php.net/manual/en/function.htmlentities.php](http://www.php.net/manual/en/function.htmlentities.php)

解码 [http://www.php.net/manual/en/function.html-entity-decode.php](http://www.php.net/manual/en/function.html-entity-decode.php)

# java - JSF 错误消息和程序卡住。JSON解析错误和primefaces

> ID：14883077
> 
> 赞同：2
> 
> 时间：2013-02-14T20:03:47.983
> 
> 标签：java, jsf, primefaces, facelets

我在 facelets 中有以下形式：

```
 <h:form styleClass="registrationForm">
            <h:panelGrid columns="3" cellpadding="5" style="width:600px">

                <h:outputLabel for="registerLogin" styleClass="registerLabel" value="Логин: " />
                <p:inputText id="registerLogin" styleClass="registerText" value="#{register.login}" 
                            required="true" requiredMessage="Введите Логин" />  
                <h:panelGrid width="200">
                    <p:message for="registerLogin" />   
                </h:panelGrid>

                <h:outputLabel for="registrationPassword" styleClass="registerLabel" value="Пароль: " />
                <p:password id="registrationPassword"  styleClass="registerText" feedback="true" promptLabel="Введите пароль" weakLabel="Слабый пароль"  
                            goodLabel="Нормальный пароль" strongLabel="Сложный пароль" value="#{register.password}" 
                            required="true" requiredMessage="Введите Пароль" /> 
                <h:panelGrid width="200">
                    <p:message for="registrationPassword" />    
                </h:panelGrid>              

                <h:outputLabel for="registrationMail" styleClass="registerLabel" value="Адрес эл. почты: " />
                <p:inputText id="registrationMail"  styleClass="registerText" value="#{register.email}" 
                        required="true" requiredMessage="Введите Адрес Почты" >
                    <f:validateRegex pattern="^[_A-Za-z0-9-\+]+(\.[_A-Za-z0-9-]+)*@[A-Za-z0-9-]+(\.[A-Za-z0-9]+)*(\.[A-Za-z]{2,})$" />
                </p:inputText>
                <h:panelGrid width="200">
                    <p:message for="registrationMail" />        
                </h:panelGrid>                               

                <h:outputLabel for="registrationSex" styleClass="registerLabel" value="Пол: " />
                <p:selectOneRadio id="registrationSex" value="#{register.sex}">
                    <f:selectItem itemLabel="М" itemValue="male" />
                    <f:selectItem itemLabel="Ж" itemValue="female" />           
                </p:selectOneRadio>             
                <h:outputText value="" />

                <h:outputLabel for="registrationName" styleClass="registerLabel" value="Отображаемое имя: " />
                <p:inputText id="registrationName"  styleClass="registerText" value="#{register.name}" 
                        required="true" requiredMessage="Ведите Имя" />
                <h:panelGrid width="200">
                    <p:message for="registrationName" />            
                </h:panelGrid>              

                <h:outputLabel for="registrationCalendar" styleClass="registerLabel" value="Дата рождения: " />
                <p:calendar id="registrationCalendar" size="24" navigator="true" yearRange="-68" 
                                locale="ru" effect="explode" value="#{register.birthdate}" 
                                required="true" requiredMessage="Введите Дату Рождения" />   
                <h:panelGrid width="200">
                    <p:message for="registrationCalendar" />            
                </h:panelGrid>                          

                <h:outputLabel for="registrationConfirm" styleClass="registerLabel" value="" />
                <p:commandButton id="registrationConfirm" value="Зарегистрироваться" styleClass="registerButton" 
                                actionListener="#{register.processRegistration}" update=":loginField :content :title" onclick="changeHeader()" />

            </h:panelGrid>  
        </h:form> 
```

以及以下支持 bean：

```
@ManagedBean
@RequestScoped
public class Register {

    @PersistenceContext(unitName="EnglishOnline")
    private EntityManager em;
    @Resource
    UserTransaction utx;
    @ManagedProperty(value="#{login}")
    private Login loginbean;
    @ManagedProperty(value="#{navigationBean}")
    private NavigationBean nav;

    private String name;
    private Sex sex;
    private Date birthdate;
    private String email;
    private String login;
    private String password;

    ...getters and setters ...

    public void setLoginbean(Login log) {
        this.loginbean = log;
    }
    public void setNav(NavigationBean nav) {
        this.nav = nav;
    }

    public void processRegistration(ActionEvent event) throws Exception {   

        User user = new User();
        user.setLogin(login);
        user.setPassword(password);
        user.setEmail(email);
        user.setName(name);
        user.setBirthdate(birthdate);
        user.setSex(sex);
        user.setRegistrationdate(new Date());

        TypedQuery<User> query = em.createQuery("SELECT u FROM User u WHERE u.login = :uLogin OR u.email = :mail", User.class);
        query.setParameter("uLogin", user.getLogin());
        query.setParameter("mail", user.getEmail());
        List<User> users = query.getResultList();
        if (users.size() != 0) {
            FacesContext.getCurrentInstance().addMessage(null, new FacesMessage("Ошибка", "Пользователь с таким логином или почтовым адресом уже существует!"));    
        } else {
            utx.begin();
            em.persist(user);
            utx.commit();
            loginbean.setUser(user);        
            nav.setHeader("Главная");
            nav.setAddress("templates/start.xhtml");            
        }       

    }   

} 
```

当我单击一次注册按钮时，某些字段出现错误消息，然后我无法再注册。我的意思是，如果我设法在没有验证错误的情况下立即注册，那么一切都很好......但是如果出现任何验证消息，那么程序将停止响应 - 即使我更改了字段值，也无法单击注册按钮并出现错误消息不再消失。出了什么问题？

当我执行相同操作时：第一次提交表单时，使用空字段，验证继续进行，并且“验证”字样出现在控制台中。但是在随后的请求中，甚至验证器都没有启动——它只是不再打印任何东西。有任何想法吗？至于Javascript错误：

```
Problem: SyntaxError: JSON.parse: unexpected non-whitespace character after JSON data
: http://localhost:8080/EnglishOnline/javax.faces.resource/jquery/jquery.js.jsf?ln=primefaces 
```

其他没什么可疑的。

聚苯乙烯。从服务器返回以下响应：

```
<?xml version='1.0' encoding='UTF-8'?>
<partial-response><changes><update id="loginField"><![CDATA[<div id="loginField">
<form id="j_idt12" name="j_idt12" method="post" action="/EnglishOnline/index.jsf" class="login_form" enctype="application/x-www-form-urlencoded">
<input type="hidden" name="j_idt12" value="j_idt12" />
<span id="j_idt12:j_idt13"></span><script id="j_idt12:j_idt13_s" type="text/javascript">$(function(){PrimeFaces.cw('Growl','widget_j_idt12_j_idt13',{id:'j_idt12:j_idt13',sticky:false,life:1500,escape:true,msgs:[]});});</script><label for="j_idt12:login">
Логин: </label><input id="j_idt12:login" name="j_idt12:login" type="text" value="" class="ui-inputfield ui-inputtext ui-widget ui-state-default ui-corner-all login_field" /><script id="j_idt12:login_s" type="text/javascript">PrimeFaces.cw('InputText','widget_j_idt12_login',{id:'j_idt12:login'});</script><label for="j_idt12:password">
Пароль: </label><input id="j_idt12:password" name="j_idt12:password" type="password" class="ui-inputfield ui-password ui-widget ui-state-default ui-corner-all login_field" /><script id="j_idt12:password_s" type="text/javascript">$(function(){PrimeFaces.cw('Password','widget_j_idt12_password',{id:'j_idt12:password'});});</script><button id="j_idt12:j_idt16" name="j_idt12:j_idt16" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only login_button" onclick="PrimeFaces.ab({source:'j_idt12:j_idt16',update:'loginField'});return false;" type="submit"><span class="ui-button-text">Войти</span></button><script id="j_idt12:j_idt16_s" type="text/javascript">PrimeFaces.cw('CommandButton','widget_j_idt12_j_idt16',{id:'j_idt12:j_idt16'});</script>
</form><a id="j_idt20" href="#" class="ui-commandlink register_link" onclick="changeHeader();PrimeFaces.ab({source:'j_idt20',update:'content title'});return false;">Регистрация</a></div>]]></update><update id="title"><![CDATA[<span id="title">Регистрация</span>]]></update><update id="content"><![CDATA[<span id="content"><div class="registrationPanel">
<form id="registrationForm" name="registrationForm" method="post" action="/EnglishOnline/index.jsf" class="registrationForm" enctype="application/x-www-form-urlencoded">
<input type="hidden" name="registrationForm" value="registrationForm" />
<table cellpadding="5">
<tbody>
<tr>
<td><label for="registrationForm:registrationLogin" class="registerLabel">
Логин: </label></td>
<td><input id="registrationForm:registrationLogin" name="registrationForm:registrationLogin" type="text" value="" class="ui-inputfield ui-inputtext ui-widget ui-state-default ui-corner-all ui-state-error registerText" /><script id="registrationForm:registrationLogin_s" type="text/javascript">PrimeFaces.cw('InputText','widget_registrationForm_registrationLogin',{id:'registrationForm:registrationLogin'});</script></td>
</tr>
<tr>
<td><label for="registrationForm:registrationPassword" class="registerLabel">
Пароль: </label></td>
<td><input id="registrationForm:registrationPassword" name="registrationForm:registrationPassword" type="password" class="ui-inputfield ui-password ui-widget ui-state-default ui-corner-all registerText" /><script id="registrationForm:registrationPassword_s" type="text/javascript">$(function(){PrimeFaces.cw('Password','widget_registrationForm_registrationPassword',{id:'registrationForm:registrationPassword',feedback:true,inline:false,promptLabel:'Введите пароль',weakLabel:'Слабый пароль',goodLabel:'Нормальный пароль',strongLabel:'Сложный пароль'});});</script></td>
</tr>
<tr>
<td><label for="registrationForm:registrationMail" class="registerLabel">
Адрес эл. почты: </label></td>
<td><input id="registrationForm:registrationMail" name="registrationForm:registrationMail" type="text" value="" class="ui-inputfield ui-inputtext ui-widget ui-state-default ui-corner-all registerText" /><script id="registrationForm:registrationMail_s" type="text/javascript">PrimeFaces.cw('InputText','widget_registrationForm_registrationMail',{id:'registrationForm:registrationMail'});</script></td>
</tr>
<tr>
<td><label for="registrationForm:registrationSex" class="registerLabel">
Пол: </label></td>
<td><table id="registrationForm:registrationSex" class="ui-selectoneradio ui-widget"><td><div class="ui-radiobutton ui-widget"><div class="ui-helper-hidden-accessible"><input id="registrationForm:registrationSex:0" name="registrationForm:registrationSex" type="radio" value="male" /></div><div class="ui-radiobutton-box ui-widget ui-corner-all ui-radiobutton-relative ui-state-default"><span class="ui-radiobutton-icon"></span></div></div></td><td><label for="registrationForm:registrationSex:0">М</label></td><td><div class="ui-radiobutton ui-widget"><div class="ui-helper-hidden-accessible"><input id="registrationForm:registrationSex:1" name="registrationForm:registrationSex" type="radio" value="female" checked="checked" /></div><div class="ui-radiobutton-box ui-widget ui-corner-all ui-radiobutton-relative ui-state-default ui-state-active"><span class="ui-radiobutton-icon ui-icon ui-icon-bullet"></span></div></div></td><td><label for="registrationForm:registrationSex:1">Ж</label></td></table><script id="registrationForm:registrationSex_s" type="text/javascript">$(function(){PrimeFaces.cw('SelectOneRadio','widget_registrationForm_registrationSex',{id:'registrationForm:registrationSex'});});</script></td>
</tr>
<tr>
<td><label for="registrationForm:registrationName" class="registerLabel">
Отображаемое имя: </label></td>
<td><input id="registrationForm:registrationName" name="registrationForm:registrationName" type="text" value="" class="ui-inputfield ui-inputtext ui-widget ui-state-default ui-corner-all registerText" /><script id="registrationForm:registrationName_s" type="text/javascript">PrimeFaces.cw('InputText','widget_registrationForm_registrationName',{id:'registrationForm:registrationName'});</script></td>
</tr>
<tr>
<td><label for="registrationForm:registrationCalendar" class="registerLabel">
Дата рождения: </label></td>
<td><span id="registrationForm:registrationCalendar"><input id="registrationForm:registrationCalendar_input" name="registrationForm:registrationCalendar_input" type="text" class="ui-inputfield ui-widget ui-state-default ui-corner-all" size="24" /></span><script id="registrationForm:registrationCalendar_s" type="text/javascript">$(function(){PrimeFaces.cw('Calendar','widget_registrationForm_registrationCalendar',{id:'registrationForm:registrationCalendar',popup:true,locale:'ru',dateFormat:'dd.mm.y',yearRange:'-68',changeMonth:true,changeYear:true,showAnim:'explode',duration:'normal'});});</script></td>
</tr>
<tr>
<td><label for="registrationForm:registrationConfirm" class="registerLabel">
</label></td>
<td><button id="registrationForm:registrationConfirm" name="registrationForm:registrationConfirm" class="ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only registerButton" onclick="PrimeFaces.ab({source:'registrationForm:registrationConfirm',process:'registrationForm',update:'loginField content title registrationForm'});return false;" type="submit"><span class="ui-button-text">Зарегистрироваться</span></button><script id="registrationForm:registrationConfirm_s" type="text/javascript">PrimeFaces.cw('CommandButton','widget_registrationForm_registrationConfirm',{id:'registrationForm:registrationConfirm'});</script></td>
</tr>
</tbody>
</table>
<div id="registrationForm:j_idt46" class="ui-message-error ui-widget ui-corner-all"><span class="ui-message-error-icon"></span><span class="ui-message-error-detail">registrationForm:registrationLogin: Validation Error: Value is required.</span></div>
</form></div></span>]]></update><update id="javax.faces.ViewState"><![CDATA[-7975648054570174914:1199185624285089158]]></update><extension ln="primefaces" type="args">{"validationFailed":true}</extension><extension ln="primefaces" type="args">{"validationFailed":true}</extension></changes></partial-response> 
```

P{3,}S。如果我们看一下这一行：

```
<extension ln="primefaces" type="args">{"validationFailed":true}</extension>
<extension ln="primefaces" type="args">{"validationFailed":true}</extension> 
```

它应该被调用2次吗？这可能是因为在我的部署中的某个地方，primefaces 库被引用了 2 次吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-18T17:57:54.227

终于解决了！问题出在primefaces .jar 文件的部署中。我的 Web 应用程序在 Glassfish v3 上运行，我在 Eclipse 中开发它。当我下载 primefaces jar 文件时，我将它放在 glassfish/lib 文件夹中。之后，我将这个 jar 的副本放入 WEB-INF 并像这样部署它。这是一个问题。我不明白为什么，但在内部，脚本从两个 jar 中收到了 2 个响应，并且由于解析错误而停止工作。

总结：永远不要将 primefaces.jar 的副本放在应用程序的 glassfish/lib 和 WEB-INF/lib 中。希望它可以帮助有同样问题的人。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-31T01:06:27.040

我确认 Artem 对 PrimeFaces 相关错误的解决方案：

```
SyntaxError: JSON.parse: unexpected non-whitespace character after JSON data 
```

我正在使用 Eclipse 和 Weblogic 12 进行开发，并部署了一个包含 6,124 个类和许多其他东西的巨大遗留 EAR，包括一个使用 PrimeFaces 的新 Web 应用程序。

症状是，在 JSF 生命周期阶段 PROCESS_VALIDATIONS 之后，生命周期似乎会跳过 UPDATE_MODEL_VALUES 和 INVOKE_APPLICATION，而是跳转到 RENDER_RESPONSE。该页面将显示 FacesMessage 错误字符串，但浏览器将停留在忙碌光标上。只有重新加载页面才会停止它。

这已通过从 \WEB-INF\lib 中删除重复的 PrimeFeces jar 得到解决。

# eclipse - 无法在eclipse中连接svn

> ID：14883078
> 
> 赞同：0
> 
> 时间：2013-02-14T20:03:47.723
> 
> 标签：eclipse, svn, subclipse, assembla

直到昨天，我还能够在我的 Eclipse 中连接我的 svn 存储库，但不幸的是，今天我无法从 Eclipse 连接到我的 svn。

错误如下：

```
 org.apache.subversion.javahl.ClientException:RA layer request failed
 svn: Unable to connect to a repository at URL https://....
 svn:Server sent unexpected return (500 Internal Server Error) in response to 
 OPTIONS request for ''https://..'

 Keep location anyway? 
```

我已尝试从命令提示符 ping 主机 url，但无法 ping 网站，但我可以在 Web 浏览器中打开和浏览我的项目。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T20:34:23.857

Assembla 有一个临时问题 - 现在尝试 - 我确实为 Assembla 工作，这是一个消耗所有资源的进程 - 在我们评估情况时，该进程现在被禁用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T20:08:24.693

您可以从浏览器访问该项目，因为浏览器会在您的 svn 存储库上触发 HTTP GET 请求。另一方面，至少从您在此处描述的内容来看，Eclipse 会触发 HTTP OPTIONS 请求。您有权访问服务器吗？你能检查一下日志吗？

当您通过浏览器访问 repo 时，您是否收到任何认证错误？

# velocity - 缓存 VelocityEngine？

> ID：14883087
> 
> 赞同：0
> 
> 时间：2013-02-14T20:04:16.397
> 
> 标签：velocity

VelocityEngine 实例的占用空间是否足够小，以便每次我需要处理模板时都可以构建一个新实例，还是最好缓存 VelocityEngine 并重用该实例？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T20:59:25.933

我认为这通常不会有太大的不同，对于我实现的一个项目，我将其设置为可配置的，但最终我们没有缓存对象，而是每次都重新生成它，没有任何性能问题。

请注意，在我的情况下，速度处理很繁重，即渲染本身需要相当长的时间。对于较小的有效载荷，这可能会有所不同。但是由于 Velocity 在内部使用反射，它总是会为其渲染带来一些开销，因此我希望与此相比，创建初始对象应该不会花费太多时间。

因此，除非性能分析表明它会引起麻烦，否则我不会在这里花太多时间来实现某些东西。一般经验法则，测量大部分时间用完的东西，然后尝试修复它！

此外，据我记得（刚刚找不到参考），VelocityEngine 应该是每个定义的线程安全的。但是过去有关于多线程问题的错误报告（现在都已修复！），因此创建新引擎可以避免未来可能出现的线程问题。

# linux - Mac 等效 bless 在 Linux 上

> ID：14883091
> 
> 赞同：1
> 
> 时间：2013-02-14T20:04:34.383
> 
> 标签：linux, macos

Linux中是否有任何等效的mac“bless”命令。我对“--bless-folder”选项特别感兴趣。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:06:53.587

不，您需要进行一些配置，例如`grub`指定它应该在哪里找到您的内核，以及传递给内核的参数。内核的参数通常包括：

*   `root=/dev/sda1`这意味着可以在特定磁盘的特定分区上找到文件系统；
*   `init=/sbin/init`这是内核执行的第一个文件，它加载整个操作系统的其余部分。

# c# - 卡在 xpath 查询上

> ID：14883095
> 
> 赞同：0
> 
> 时间：2013-02-14T20:04:55.830
> 
> 标签：c#, xpath

我有一个`xmlnodelist`导致以下代码段的结果

```
<updi:ProductName xmlns:updi="urn:rosettanet:specification:universal:ProductIdentification:xsd:schema:01.04">Packet Processing Card (PPC) 16GB</updi:ProductName>
<ulc:AlternativeIdentifier xmlns:ulc="urn:rosettanet:specification:universal:Locations:xsd:schema:01.04">
  <ulc:Authority>PID</ulc:Authority>
  <ulc:Identifier>ASR5K-PPC-K9=</ulc:Identifier>
</ulc:AlternativeIdentifier>
<ulc:AlternativeIdentifier xmlns:ulc="urn:rosettanet:specification:universal:Locations:xsd:schema:01.04">
  <ulc:Authority>CPN</ulc:Authority>
  <ulc:Identifier />
</ulc:AlternativeIdentifier> 
```

如何获取两个权限和标识符标签？我尝试添加根元素，但命名空间存在问题。原始命名空间声明非常大。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:39:05.653

好吧，我怀疑您尝试过的 XPath 查询有什么问题 - 更有可能是命名空间让您感到困惑。有几种方法可以补偿/处理这个问题，从“剥离所有命名空间”到使用`XmlNamespaceManager`- 这是一个例子：

```
void Main()
{
    var doc = new XmlDocument();
    var namespaceMgr = new XmlNamespaceManager(doc.NameTable);
    namespaceMgr.AddNamespace("updi", "urn:rosettanet:specification:universal:ProductIdentification:xsd:schema:01.04");
    namespaceMgr.AddNamespace("ulc", "urn:rosettanet:specification:universal:Locations:xsd:schema:01.04");
    doc.LoadXml(xml);

    var authorityTags = doc.SelectNodes("//ulc:Authority", namespaceMgr);
    var identifierTags = doc.SelectNodes("//ulc:Identifier", namespaceMgr);
} 
```

假设 xml 是：

```
 string xml = @"
    <ROOT>
    <updi:ProductName xmlns:updi=""urn:rosettanet:specification:universal:ProductIdentification:xsd:schema:01.04"">
    Packet Processing Card (PPC) 16GB
    </updi:ProductName>
    <ulc:AlternativeIdentifier xmlns:ulc=""urn:rosettanet:specification:universal:Locations:xsd:schema:01.04"">
    <ulc:Authority>PID</ulc:Authority>
    <ulc:Identifier>ASR5K-PPC-K9=</ulc:Identifier>
    </ulc:AlternativeIdentifier>
    <ulc:AlternativeIdentifier xmlns:ulc=""urn:rosettanet:specification:universal:Locations:xsd:schema:01.04"">
    <ulc:Authority>CPN</ulc:Authority>
    <ulc:Identifier />
    </ulc:AlternativeIdentifier>
    </ROOT>"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T20:24:11.303

下面将返回您的示例中的所有四个节点。我确实必须将它包装在根节点中以进行测试。`|`运算符允许联合[功能。](http://msdn.microsoft.com/en-us/library/ms256086.aspx)

```
//ulc:AlternativeIdentifier/ulc:Authority | //ulc:AlternativeIdentifier/ulc:Identifier 
```

我使用[Notepad++](http://notepad-plus-plus.org/)和我强烈推荐的[XPatherizerNPP插件对此进行了测试。](http://code.google.com/p/xpatherizernpp/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T22:40:09.280

像这样的东西可以解决问题：

```
XmlDocument doc = new XmlDocument();
doc.Load("YourXmlFile");

foreach (XmlNode node in doc.SelectNodes("//*[local-name() = \"Authority\"]"))
{
    Console.WriteLine("Authority: " + node.InnerText);
}

foreach (XmlNode node in doc.SelectNodes("//*[local-name() = \"Identifier\"]"))
{
    Console.WriteLine("Identifier: " + node.InnerText);
} 
```

基本上，`SelectNodes("//*[local-name() = \"Identifier\"]")`告诉它使用该名称在 xml 中搜索节点，而不考虑名称空间等。

# android - 以编程方式调整文本大小，超出 Viewbounds，修复？

> ID：14883101
> 
> 赞同：1
> 
> 时间：2013-02-14T20:05:36.870
> 
> 标签：android, interface, resize, textview

我正在尝试调整线性布局中的行大小，具体取决于布局中的行数（布局具有固定高度）。这些行应该总是完全填满父布局。所以 1 行是父级的完整大小，2 行都是大小的一半等。这行得通，我现在也在尝试调整文本的大小，但是当我调整它的大小时它会被切断，即使 textview 很大足够了（我打开了果冻豆的显示视图边界功能）

```
private void setHeightOfRows(ViewGroup parent) {
    int height = parent.getHeight();
    int childCount = parent.getChildCount();
    for (int i = 0; i < childCount; i++) {
        LinearLayout.LayoutParams p = (LayoutParams) parent.getChildAt(i).getLayoutParams();
        p.height = height / childCount;
        parent.getChildAt(i).setLayoutParams(p);
        ((ViewGroup) parent.getChildAt(i)).setClipChildren(false);
        Log.i("FontSize", "Set font size to " + 10 / childCount);
        ((TextView) parent.getChildAt(i).findViewById(R.id.name_text)).setTextScaleX(10 / childCount);// .setTextSize(10/childCount);
    }
} 
```

此方法在 ViewTreeObserver 中执行，因此在呈现 UI 之后。

如何在不切断文本的情况下调整文本大小？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:09:37.807

SetTextScaleX 在 X 方向（水平）拉伸文本。它看起来更像是您想要缩小文本，使其从上到下更小，对吧？在这种情况下，您不需要 setTextScaleX，而是需要 setTextSize。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T20:28:58.640

# 简单的问题。必须存在简单的解决方案。:)

*   您是否考虑过使用`android:padding`and `android:margin`。
*   minHeaight 和 minWidth 怎么样？

**或者**

*   如果您通过代码进行操作，那么`setPadding`Margin 也必须有类似的事情。
*   有一个`setMinHeight`和`setMinWidth`

# browser - 插件、插件和助手应用程序之间的区别

> ID：14883105
> 
> 赞同：0
> 
> 时间：2013-02-14T20:05:45.753
> 
> 标签：browser, definition

我正在尝试理解脚本的分类/命名，
我还没有在网上找到任何我可以阅读的软件词汇，
我有很多自己的脚本，并且来自开源。
我想把我的脚本放到正确的文件夹中。

这些概念在实践中有什么区别？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:15:49.907

插件是完整的程序，它们可以安装在您的系统中并可以在浏览器中使用，而附加组件不是完整的程序，它们用于为您的浏览器添加功能。例如，Flash Player 是一个插件，它可以安装在您的系统中，也可以安装在浏览器中播放视频，InPrivate Filtering 是一个插件，用于某些浏览器中提供隐私保护。因此，附加组件为您的浏览器提供了额外且有限的功能。

# c# - 如何在c#中读取xml

> ID：14883107
> 
> 赞同：0
> 
> 时间：2013-02-14T20:05:48.000
> 
> 标签：c#, xml

无法在 C# 中读取此 xml。如何从此 xml 获取货币和汇率

我用了这段代码

```
XmlTextReader xmlTextReader = new XmlTextReader(new StringReader(xmlfile));
XmlDocument doc = new XmlDocument();
XmlNode node = doc.ReadNode(xmlTextReader); 
```

但没有得到值。

```
 <?xml version="1.0" encoding="UTF-8"?>
 <gesmes:Envelope xmlns:gesmes="http://www.gesmes.org/xml/2002-08-01" xmlns="http://www.ecb.int/vocabulary/2002-08-01/eurofxref">
<gesmes:subject>Reference rates</gesmes:subject>
<gesmes:Sender>
    <gesmes:name>European Central Bank</gesmes:name>
</gesmes:Sender>
<Cube>
    <Cube time='2013-02-14'>
        <Cube currency='USD' rate='1.3327'/>
        <Cube currency='JPY' rate='124.39'/>
        <Cube currency='BGN' rate='1.9558'/>
        <Cube currency='CZK' rate='25.383'/>
        <Cube currency='DKK' rate='7.4604'/>
        <Cube currency='GBP' rate='0.85940'/>
        <Cube currency='HUF' rate='292.52'/>
        <Cube currency='LTL' rate='3.4528'/>
        <Cube currency='LVL' rate='0.6997'/>
        <Cube currency='PLN' rate='4.1765'/>
        <Cube currency='RON' rate='4.3871'/>
        <Cube currency='SEK' rate='8.4492'/>
        <Cube currency='CHF' rate='1.2293'/>
        <Cube currency='NOK' rate='7.3605'/>
        <Cube currency='HRK' rate='7.5863'/>
        <Cube currency='RUB' rate='40.1712'/>
        <Cube currency='TRY' rate='2.3605'/>
        <Cube currency='AUD' rate='1.2879'/>
        <Cube currency='BRL' rate='2.6220'/>
        <Cube currency='CAD' rate='1.3343'/>
        <Cube currency='CNY' rate='8.3062'/>
        <Cube currency='HKD' rate='10.3352'/>
        <Cube currency='IDR' rate='12873.40'/>
        <Cube currency='ILS' rate='4.9036'/>
        <Cube currency='INR' rate='71.8730'/>
        <Cube currency='KRW' rate='1445.93'/>
        <Cube currency='MXN' rate='16.9523'/>
        <Cube currency='MYR' rate='4.1170'/>
        <Cube currency='NZD' rate='1.5715'/>
        <Cube currency='PHP' rate='54.251'/>
        <Cube currency='SGD' rate='1.6491'/>
        <Cube currency='THB' rate='39.728'/>
        <Cube currency='ZAR' rate='11.8588'/>
    </Cube>
</Cube> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T20:10:53.250

您始终可以使用 XML 读取，`XPath`但我强烈建议您尽可能使用 LINQ to XML (.NET 3.5)：

```
XDocument doc = XDocument.Load(url);
XNamespace gesmes = "http://www.gesmes.org/xml/2002-08-01";
XNamespace ns = "http://www.ecb.int/vocabulary/2002-08-01/eurofxref";
var cubes = doc.Descendants(ns + "Cube")
               .Where(x => x.Attribute("currency") != null)
               .Select(x => new { Currency = (string) x.Attribute("currency"),
                                  Rate = (decimal) x.Attribute("rate") });
foreach (var result in cubes)
{
    Console.WriteLine("{0}: {1}", result.Currency, result.Rate);
} 
```

`cubes` 存储您所需的值，即。`Currency`和`Rate`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T00:49:18.460

为了得到一个节点的值或属性，首先需要找到这个节点。
传统方法：

```
string query = "//Cube[@currency and @rate]";//select the cube node that has "currency" and "rate" attributes.
XmlNodeList nodes = doc.SelectNodes(query);
foreach (XmlNode node in nodes)
{
    string currency = node.Attributes["currency"].Value;
    string rate = node.Attributes["rate"].Value;
    Console.WriteLine("currency: {0}, rate: {1}", currency, rate);
} 
```

希望它有帮助。

# jquery - 链接到我网站另一部分的页面部分

> ID：14883110
> 
> 赞同：0
> 
> 时间：2013-02-14T20:06:01.343
> 
> 标签：jquery, html, css

在我的一些页面上，我使用 JQuery 来显示和隐藏不同的内容部分，而无需刷新页面。有没有办法可以从全局导航链接到页面的特定部分？最终，我希望用户单击不同页面上的链接，然后跳回到不同页面上的某个部分。

我有一个我目前在这里的例子，[http://jsfiddle.net/tjaymz/JUJf7/](http://jsfiddle.net/tjaymz/JUJf7/)

```
<nav id="sideNav">
<ul class="noStyle">
    <li><a href="#" name="menu1">Line 1</a></li>
    <li><a href="#" name="menu2">Line 2</a></li>
    <li><a href="#" name="menu3">Line 3</a></li>
</ul> 
```

```
<section id="page_menu1">
    <h1>Some Heading</h1>
    <p>FPO</p>
</section>

<section id="page_menu2" class="hidden">
    <h1>Heading 2</h1>
    <p>FPO</p>
</section>

<section id="page_menu3" class="hidden">
    <h1>Another one</h1>
    <p>FPO</p>
</section> 
```

```
$(function(){
$("#main_content section:not(:first-child)").hide();  //hide all but first
$("#sideNav a").click(function () {
    $('#main_content section').hide('fast');
    $('#page_'+this.name).show('normal');
});}); 
```

使用这个例子，我需要从另一个页面链接到这个例子中的“第 2 行”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T21:39:52.683

您可以查看页面加载时的 url 哈希。尝试以下方式：

```
$(function () {
    $("#main_content section").hide();

    var selected = $(window.location.hash);
    if (selected.length) {
        selected.show();
    } else {
        $("#main_content section:first-child").show();
    }
}); 
```

然后，如果用户`#page_url1`在他们的 url 中链接，该部分将可见。

要获得更全面的解决方案，您可能需要研究[jQuery UI Tabs 之](http://jqueryui.com/tabs/)类的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T20:41:24.497

我相信您可以将锚点用于您要链接到的站点中的页面部分。使您的全球导航上的链接转到锚点，它应该可以工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T21:11:50.590

有两种方法可以做到这一点：

1.  编写一点 javascript 来单击 URI 中某个参数指向的按钮。
2.  分开你的页面。Javascript 很好，但如果你使用太多，它会限制可访问性、妨碍 SEO、使链接变脆等等。`data-remote`如果你仍然喜欢 javascript 的感觉，你可以在服务器收到请求时通过 javascript、json 或 xml 渲染这些单独的页面。从这个意义上说，使用 AJAX 是好的，因为该站点将继续为每个用户运行，并且您最终不会因为您的 UX 而遇到无法预料的问题。

# java - PowerMock：不是接口

> ID：14883116
> 
> 赞同：1
> 
> 时间：2013-02-14T20:06:23.623
> 
> 标签：java, easymock, powermock

我只是想让 PowerMock/EasyMock 工作。我正在使用 PowerMock 1.5：

```
 <dependency>
        <groupId>org.powermock</groupId>
        <artifactId>powermock-easymock-release-full</artifactId>
        <version>1.5</version>
        <type>pom</type>
    </dependency> 
```

这是我的代码：

```
 String text = PowerMock.createMock(String.class); 
```

就是这样。当我运行程序时，我得到：`java.lang.IllegalArgumentException: java.lang.String is not an interface`

我试过做：

```
 String text = EasyMock.createMock(String.class); 
```

并使用 PowerMock 的 RunWith 注释，但无论我尝试什么类，我总是得到这个异常。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T20:22:54.277

此版本的 EasyMock 可以正常工作：

```
<dependency>
  <groupId>org.easymock</groupId>
  <artifactId>easymock</artifactId>
  <version>3.1</version>
</dependency> 
```

您还应该看看如何模拟系统类：

[http://code.google.com/p/powermock/source/browse/trunk/modules/module-test/mockito/junit4/src/test/java/samples/powermockito/junit4/system/SystemClassUserTest.java?spec= svn1714&r=1714](http://code.google.com/p/powermock/source/browse/trunk/modules/module-test/mockito/junit4/src/test/java/samples/powermockito/junit4/system/SystemClassUserTest.java?spec=svn1714&r=1714)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T20:16:36.357

只要我问....使用了错误版本的easymock。需要升级到 3.0 版

String 也是一个最终类，因此它不适用于字符串...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-02T16:37:03.647

低于 3.0 的 EasyMock 版本会抛出这个错误。升级您的 EasyMock 版本。

# javascript - 预期 } 发现成功错误

> ID：14883119
> 
> 赞同：-3
> 
> 时间：2013-02-14T20:06:29.203
> 
> 标签：javascript, jquery, ajax

```
myClickHandler = function(e) {
       var ng = $('#num_groups').val();
       for (var group = 1; group <= ng; group++) {
         if (!validation(group)) return false;
       }
       if (confirm( "Are you sure you want to Proceed?" + "\n")) {
         $.ajax({
           url: "insertpenaltymarks.php",
           data: $("#PenaltyMarks").serialize(),
           async: false,
           type: "POST"
           success:function(result){
            $.ajax({
                 url: "sessioncomplete.php",
                 async: false,
                 type: "POST",
                 success:function(response){
                      window.location = "complete.php";
                  }
               });
        }
         });
         return true;
      } else {
        return false;
      }
    } 
```

使用上面的代码，我试图发送 2 个 ajax 请求，一个去页面，`insertpenaltymarks.php`另一个去页面。但我收到一个我不太明白的错误：`sessioncomplete.php``complete.php`

```
Syntax error at line 57 while loading: expected '}', got 'success'
           success:function(res 
```

这个错误实际上是什么意思，如何解决？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T20:07:18.557

`"POST"`在第一个 Ajax 调用之后设置逗号：

```
// ---------v
type: "POST",
success: function(result) { 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T20:08:40.523

后面需要一个逗号`"POST"`。

# vba - 提取重复的行/标准不起作用？

> ID：14883121
> 
> 赞同：0
> 
> 时间：2013-02-14T20:06:51.120
> 
> 标签：vba, excel

我是一个 VBA 新手，通过修改现有的宏和反复试验来学习，所以如果我所问的似乎是丛林联盟，我深表歉意。

我组合/修改了一些宏，以根据标准将外部工作簿中的行拉到我的工作簿中。问题是我随机得到重复的行，我不知道为什么。任何人都可以看到问题是什么？我遇到的第二个问题是，除了列 AF 标准之外，我还想过滤以使 E 列中的日期落在不同工作表上两个单元格中指定的日期之间。

我一直在尝试使用这条线：

```
If DateValue.Sheets("Control")("B1") < ("E1:E" & B) < DateValue.Sheets("Control")("C1") Then 
```

但我要么不正确地放置它，要么完全关闭编码......有人可以帮我解决这个问题吗？

```
Sub FetchComplaints()
Dim path            As String
Dim FileName        As String
Dim LastCell        As Range
Dim Wkb             As Workbook
Dim WS              As Worksheet
Dim ThisWB          As String

Sheets("Sheet1").Range("A2:S1000").Clear
Sheets("ComplaintsFetched").Activate
Range("A1:AP5000").Clear
ThisWB = ThisWorkbook.Name
Application.EnableEvents = False
Application.ScreenUpdating = False
path = GetFileName

        Set Wkb = Workbooks.Open(FileName:=path)
        For Each WS In Wkb.Worksheets
            WS.Select
            B = Application.CountA(Range("A:A"))
            If B = 0 Then
                            Else
                For Each cell In Range("AF1:A" & B)
                If cell.Value = True Or cell.Value = "Written" Then
                Anum =  Application.CountA(Workbooks(ThisWB).Sheets("ComplaintsFetched").Range("A:A")) + 1
                cell.EntireRow.Copy Workbooks(ThisWB).Sheets("ComplaintsFetched").Range("A" & Anum)
               End If
               Next cell
            End If
        Next WS
        Wkb.Close False
Application.EnableEvents = True
Application.ScreenUpdating = True

Set Wkb = Nothing
Set LastCell = Nothing

Set LastCell = Nothing 
```

GetFileName 是一个检索路径的函数。

感谢您的帮助，如果我遗漏了一些非常简单的东西，我们深表歉意。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:13:59.130

尝试使用以下语法：

```
If Sheets("Control").Range("B1").Value < Sheets("Control").Range("C" & B).Value ... 
```

多个条件应使用`And`.

# jquery - 使用来自 rails 的 json 响应

> ID：14883124
> 
> 赞同：1
> 
> 时间：2013-02-14T20:06:55.333
> 
> 标签：jquery, ruby-on-rails, json

我快到了，但似乎无法调试这个简单的项目。

我有页面：

```
<div id="count"> 
```

我正在使用以下函数从服务器获取计数：

```
$.get("/count?post_id=" + postId, function(post_count) {
    $('#count').html(post_count.count); 
```

来自服务器的响应是：

```
[{"count":0}] 
```

但是，页面不会随着提供的计数而更新。我曾经让响应呈现简单的文本，并且页面正在按预期使用新计数进行更新，但是在使用 json 时我无法让它工作。

有人可以帮忙吗？

编辑 1

当我做

```
alert(post_count) 
```

我收到与 [object][Object] 的警报对话

但是，当我尝试做

```
alert(post_count.count) 
```

我收到与未定义的警报对话。

上面提到的 JSON 格式是否正确？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T20:35:18.907

如果响应是，`[{"count":0}]`那么它看起来像：

```
post_count.count 
```

应该：

```
post_count[0].count 
```

因为它是一个包含对象/哈希的数组。

此外，一旦您超越了像这样的简单调用，请考虑使用现有的框架（如[restful_json](https://github.com/garysweaver/restful_json)和[AngularJS](http://angularjs.org/)）来完成繁重的工作。一起使用这两个项目的一个例子是[员工培训跟踪器](https://github.com/FineLinePrototyping/employee-training-tracker)应用程序。还有其他 Javascript 框架也隐藏了这种复杂性。[TodoMVC](http://addyosmani.github.com/todomvc/)页面中列出了一些示例。而且，如果您编写自己的服务控制器，请考虑使用[rails-api 。](https://github.com/rails-api/rails-api)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T20:18:12.623

确保 Rails 应用程序使用 JSON 响应，不仅在内容中，而且在标头中：

尝试：

```
respond_to do |format|
  format.json { render :json=> whatever.to_json }
end 
```

编辑：之前错过了这个，但是当用 jQuery 调用 JSON 让它自动解析时（而不是使用 JSON.parse(response) 使用：

```
$.getJSON(url, function(){}); 
```

# c++ - Arduino 代码中的继承

> ID：14883128
> 
> 赞同：0
> 
> 时间：2013-02-14T20:07:05.263
> 
> 标签：c++, inheritance, arduino

我正在编写一些 Arduino 代码并尝试在某些类中使用继承。我有一个类“Actor”（我的基类）和一个类“Marble”（继承自 Actor）。以下是头文件：

演员.h：

```
#ifndef Actor_h
#define Actor_h

#include "Arduino.h"

class Actor
{
  public:
    Actor();
    void speak();
  private:
};
#endif 
```

大理石.h：

```
#ifndef Marble_h
#define Marble_h

#include "Arduino.h"
#include "Actor.h"

class Marble : public Actor {
  public:
    Marble();
    virtual void speak();    
  private:
};
#endif 
```

演员.cpp：

```
#include "Arduino.h"
#include "Actor.h"

Actor::Actor()
{
}

void Actor::speak() {
  Serial.println("Actor"); 
} 
```

大理石.cpp：

```
#include "Arduino.h"
#include "Marble.h"

void Marble::speak() {
  Serial.println("Marble"); 
} 
```

最后，在循环函数中我这样做：

```
void loop() {
  Marble marble;
  Actor children[2];
  children[0] = marble;

  children[0].speak(); 
```

这导致打印“演员”。

我发现这个不错的链接似乎与我的问题相似，但该解决方案似乎对我不起作用： [http ://arduino.cc/forum/index.php?topic=41884.0](http://arduino.cc/forum/index.php?topic=41884.0)

所以。似乎当我创建我的“Actor”数组并尝试将 Marble 粘贴在其中时，它会被投射到一个 Actor 或类似的东西上。问题是，我将有几个不同的字符，它们都将继承自“Actor”，我想要一个它们的数组来迭代并在它们上调用覆盖的方法。

所以，也许问题是我如何解决这个问题，或者可能有一些语法错误？我不知道！

谢谢你的帮助，凯文

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T20:10:18.373

您需要在类中声明as `speak`，而不仅仅是在类中；没有它，它是一个*非*虚拟函数，所以你总是会被优先于 virtual 调用。`virtual``Actor``Marble``Actor::speak`*`Marble::speak`*

 *对于它的价值，这与 Arduino 无关：这只是一个直接的 C++ 问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T20:46:42.493

你的问题是这`children`是一个类型的数组`Actor`。该行`children[0] = marble`正在获取一个`Marble`对象，将其转换为一个`Actor`对象并将结果复制到`children[0]`. 由于调用`children[0].speak()`是在 an 上`Actor`，因此您将获得`Actor`版本。

为了让它按照您想要的方式工作，您需要复制指向对象的指针或引用，而不是对象本身。也就是说，你想要类似 `Actor* children[2]' 的东西：

```
Marble marble;
Actor* children[2];
children[0] = &marble;

children[0]->speak(); 
```

当然，如果`children`范围超出`loop`，这将完全失败，您需要使用它`new`来创建弹珠。

更好的是，假设 Arduino 有 STL，你应该使用`vector`和`shared_ptr`或类似的东西。

[更新] 正如 Philip 所指出的，这也需要将`speak`方法`Actor`声明为虚拟的。*

# java - 以前工作的代码出现奇怪的空指针异常

> ID：14883136
> 
> 赞同：0
> 
> 时间：2013-02-14T20:07:42.817
> 
> 标签：java, android, nullpointerexception

非常奇怪和令人沮丧的错误。

一旦我在模拟器上加载我的应用程序并尝试打开它，我就会在 on create 方法中收到一个空指针异常错误。

正如标题中所说，这段代码已经完美运行了数周。

这是日志猫：

```
02-14 20:03:45.813: E/AndroidRuntime(285): FATAL EXCEPTION: main
02-14 20:03:45.813: E/AndroidRuntime(285): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.flybase2/com.example.flybase2.MainActivity}: java.lang.NullPointerException
02-14 20:03:45.813: E/AndroidRuntime(285):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2663)
02-14 20:03:45.813: E/AndroidRuntime(285):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
02-14 20:03:45.813: E/AndroidRuntime(285):  at android.app.ActivityThread.access$2300(ActivityThread.java:125)
02-14 20:03:45.813: E/AndroidRuntime(285):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
02-14 20:03:45.813: E/AndroidRuntime(285):  at android.os.Handler.dispatchMessage(Handler.java:99)
02-14 20:03:45.813: E/AndroidRuntime(285):  at android.os.Looper.loop(Looper.java:123)
02-14 20:03:45.813: E/AndroidRuntime(285):  at android.app.ActivityThread.main(ActivityThread.java:4627)
02-14 20:03:45.813: E/AndroidRuntime(285):  at java.lang.reflect.Method.invokeNative(Native Method)
02-14 20:03:45.813: E/AndroidRuntime(285):  at java.lang.reflect.Method.invoke(Method.java:521)
02-14 20:03:45.813: E/AndroidRuntime(285):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
02-14 20:03:45.813: E/AndroidRuntime(285):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
02-14 20:03:45.813: E/AndroidRuntime(285):  at dalvik.system.NativeStart.main(Native Method)
02-14 20:03:45.813: E/AndroidRuntime(285): Caused by: java.lang.NullPointerException
02-14 20:03:45.813: E/AndroidRuntime(285):  at com.example.flybase2.MainActivity.onCreate(MainActivity.java:33)
02-14 20:03:45.813: E/AndroidRuntime(285):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047)
02-14 20:03:45.813: E/AndroidRuntime(285):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2627)
02-14 20:03:45.813: E/AndroidRuntime(285):  ... 11 more 
```

这是课程：

```
package com.example.flybase2;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;

public class MainActivity extends Activity implements OnClickListener{
Button bContacts;
Button bAppointment;
Button bShopping;
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.appmenus);

     bContacts = (Button) findViewById(R.id.btnCons);
     bAppointment = (Button) findViewById(R.id.btnAppoint);
     bShopping = (Button) findViewById(R.id.btnShop);

    bContacts.setOnClickListener(this);
    bAppointment.setOnClickListener(this);
    bShopping.setOnClickListener(this);

}

@Override
public void onClick(View passedAppChoice) {
    switch(passedAppChoice.getId()){

    case (R.id.btnCons):
    Intent cons = new Intent("com.example.flybase2.contacts");
    startActivity(cons);
    break;

    case (R.id.btnAppoint):
        Intent Appoint = new Intent("com.example.flybase2.appointmantMenu");
        startActivity(Appoint);
        break;

    case (R.id.btnShop):
        Intent shop = new Intent("com.example.flybase2.ShoppingList");
        startActivity(shop);
        break;
    }
  }
} 
```

应用菜单.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical" >

<LinearLayout
android:layout_width="match_parent"
android:layout_height="84dp"
android:orientation="horizontal" >

<ImageView
    android:id="@+id/imgLink"
    android:layout_width="60dp"
    android:layout_height="match_parent"
    android:layout_gravity="center_vertical"
    android:layout_weight="0.91"
    android:src="@drawable/menulist" />

<TextView
    android:id="@+id/textView1"
    android:layout_width="165dp"
    android:layout_height="match_parent"
    android:layout_weight="0.14"
    android:gravity="center"
    android:text="Menu"
    android:textAppearance="?android:attr/textAppearanceLarge"
    android:textSize="40sp" />

</LinearLayout>

<ScrollView
android:layout_width="match_parent"
android:layout_height="fill_parent" >

<LinearLayout
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical" >

<Button
    android:id="@+id/btnCons"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_margin="20dp"
    android:drawableLeft="@drawable/consicon"
    android:src="@drawable/consicon"
    android:text="Contacts " />

<Button
    android:id="@+id/btnToDo"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_margin="20dp"
    android:drawableLeft="@drawable/todo"
    android:src="@drawable/todo"
    android:text="&apos;To Do&apos; List" />

   <Button
       android:id="@+id/btnShop"
       android:layout_width="match_parent"
       android:layout_height="wrap_content"
       android:layout_margin="20dp"
       android:drawableLeft="@drawable/shoppingmenu"
       android:src="@drawable/shoppingmenu"
       android:text="Shopping List" />

       <Button
           android:id="@+id/btnAppoint"
           android:layout_width="match_parent"
           android:layout_height="wrap_content"
           android:layout_margin="20dp"
           android:drawableLeft="@drawable/appointmainicon"
           android:src="@drawable/appointmainicon"
           android:text="Appointment List" />

</LinearLayout>

</ScrollView>
</LinearLayout> 
```

希望有人能看到我哪里出错了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T20:20:58.697

# 一些可能的事情：

*   是否`R.layout.appmenus`包含上述所有按钮（检查 ID）。由于 R.id 是一个应用程序范围的命名空间，它也可以在其他布局中
*   你开始你的意图的方式似乎很奇怪。这不是您开始明确意图的方式。

显式意图应采用以下形式：

```
Intent explicitIntent = new Intent(InvokingActivity.this,InvokedActivity.class);
startActivity(explicitIntent); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T20:25:32.203

在初始化按钮对象后在 onCreate 中添加此日志打印。

```
 Log.d("MainActivityTAG", "bContacts ="+bContacts+ ", bAppointment="+bAppointment+", bShopping="+bShopping); 
```

下面代码中的按钮对象之一似乎是`null`.

```
 bContacts = (Button) findViewById(R.id.btnCons);
 bAppointment = (Button) findViewById(R.id.btnAppoint);
 bShopping = (Button) findViewById(R.id.btnShop); 
```

上面的日志打印将让您知道哪个按钮实例是`null`，并且您将了解您是否获得了错误 ID 的按钮或设置了没有定义这些按钮之一的错误布局。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T22:30:14.210

最终开始了一个新项目并简单地将代码复制过来，所以速度非常快。它现在正在工作。我不知道发生了什么，但我相信这归结为我的 XML appmenu.xml 文件布局中的某种损坏。无论出于何种原因，我认为约会按钮不再被日食“看到”，即使它清楚地存在并由其 ID 引用。非常感谢所有做出贡献的人。

# javascript - 从 Google 搜索结果 URL 获取搜索查询

> ID：14883142
> 
> 赞同：0
> 
> 时间：2013-02-14T20:08:03.923
> 
> 标签：javascript

给定页面的 URL，是否可以从 Google 搜索结果页面获取搜索查询？我注意到搜索查询通常显示在 URL 中，但 URL 的格式有时会有点混乱。

例如，搜索的一个搜索结果 URL`stackoverflow`是

> [https://www.google.com/webhp?hl=en&tab=ww#hl=en&tbo=d&sclient=psy-ab&q=stackoverflow&oq=stackoverflow&gs_l=hp.3..35i39l2j0l2.920.3338.0.3436.13.12.0.0.0.0.310.1216 .10j1j0j1.12.0.les%3B..0.0...1c.1.3.psy-ab.OH00abu0aqs&pbx=1&bav=on.2,or.r_gc.r_pw.r_cp.r_qf.&bvm=bv.42452523,d.dmQ&fp= 8bb62755c027473d&biw=1366&bih=631](https://www.google.com/webhp?hl=en&tab=ww#hl=en&tbo=d&sclient=psy-ab&q=stackoverflow&oq=stackoverflow&gs_l=hp.3..35i39l2j0l2.920.3338.0.3436.13.12.0.0.0.0.310.1216.10j1j0j1.12.0.les%3B..0.0...1c.1.3.psy-ab.OH00abu0aqs&pbx=1&bav=on.2,or.r_gc.r_pw.r_cp.r_qf.&bvm=bv.42452523,d.dmQ&fp=8bb62755c027473d&biw=1366&bih=631)

相同搜索字符串的另一个 URL 是

> [https://www.google.com/search?btnG=1&pws=0&q=stackoverflow](https://www.google.com/search?btnG=1&pws=0&q=stackoverflow)。

是否有任何方法可以使用 JavaScript 从所有类型的 Google 搜索结果 URL 中获取 Google 搜索查询？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T20:11:54.530

通常搜索词是谷歌的 URL 参数“q”。在此处查看如何[在 Javascript 中从 Google 搜索中提取关键字](https://stackoverflow.com/questions/6045477/extract-keyword-from-google-search-in-javascript?rq=1)

# javascript - 将 HTML 元素作为参数传递给函数与使用 getElementById 获取相同元素

> ID：14883155
> 
> 赞同：0
> 
> 时间：2013-02-14T20:08:54.833
> 
> 标签：javascript, function, design-patterns, getelementbyid

在定义一个函数时，您如何决定该函数是获取作为参数传递的 HTML 元素还是使用它`getElementById`？一种方式比另一种更快吗？我知道将事物作为参数传递会增加可重用性，但有时很难看出函数是否会在另一段代码中使用。

只是为了澄清而不是使用`getElementById`我会有这样的东西`<input type="text" name="colour" onkeyup="myFunction(this.value)" />`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T20:13:22.890

为了灵活起见，您可以制作可以采用以下任一功能的函数：

```
 function whatever( element ) {
   if (typeof element === 'string')
     element = document.getElementById( element );
   // ... do stuff ...
 } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T20:14:39.883

从功能上讲，如果您在调用函数之前调用 getElementById 并传递结果，或者从函数内部传递结果，那么这并没有太大区别。通过将元素传递给函数有一点额外的灵活性，因为您还可以使用其他选择器（除了 id）来查找您的元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T20:11:48.960

始终传递对象，而不是 ID。传递对象就像给你一本书。传递 ID 是向您显示一本书的名称，然后将这本书放回图书馆并要求您找到它。

没有理由每次都搜索元素。

# api - 来自 HTTP API 的 CURL 请求的 JSON 响应 - HTML 转换

> ID：14883159
> 
> 赞同：0
> 
> 时间：2013-02-14T20:09:29.583
> 
> 标签：api, parsing, curl, json

我能够将 CURL 请求发送到测试 http API 并获得响应。

我的 CURL 请求是这样的：

```
$request = "";
$param['auth-userid'] = '449735';
$param['api-key'] = 'apikey';
$param['domain-name'] ='sambalpurodisha';
$param['tlds']='com';
foreach ($param as $key => $val) {$request.= $key ."=".urlencode($val);    
$request .="&";}
$request=substr($request,0,strlen($request)- 1 );
$url = "https://test.httpapi.com/api/domains/available.json?".$request;

$ch = curl_init($url);
curl_setopt( $ch, CURLOPT_RETURNTRANSFER, true );
$result = curl_exec( $ch );
curl_close( $ch ); 
```

我收到如下回复：
**{"sambalpurodisha.com":{"status":"available","classkey":"domcno"}}**

现在，我已经尝试了一切以更易读的方式格式化结果，例如 Domain - sambalpurodisha.com 可供购买。

我在堆栈中尝试了许多建议，但没有一个对我有用。我可以寻找的方向

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T18:15:06.660

您需要将返回的 JSON 字符串解码为 JSON 对象或关联数组，然后对其进行迭代：

```
$rawJSON = '{"sambalpurodisha.com":{"status":"available","classkey":"domcno"}}';

$jsonArray = json_decode($rawJSON, true);
foreach($jsonArray as $key => $val) {

    echo 'Domain: ' . $key . '  status: ' . $val['status'] . "\n";

} 
```

# ios - NSNumber 原始值相等与带有 Obj-C 文字的 isEqualToNumber

> ID：14883160
> 
> 赞同：7
> 
> 时间：2013-02-14T20:09:30.963
> 
> 标签：ios, objective-c, objective-c-literals

既然我们在 Objective-C 中有了带有编译器支持的 NSNumber 字面量，有没有一种首选的方法可以将 NSNumber 与已知整数值进行比较？

老办法是 `[myNumber integerValue] == 5`

现在我们`[myNumber isEqualToNumber:@5]`甚至可以做到`[myNumber isEqualToNumber:@(someVariable)]`。

该方法是否有优势`isEqualToNumber:`，或者我们应该坚持使用 integerValue，除非要比较的值已经是 NSNumber？

我可以看到的一个优点是，如果 someVariable 从 NSInteger 更改为 CGFloat，则新方法不需要更改代码。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-14T20:13:30.493

新方式实际上是围绕旧的新语法

```
[myNumber isEqualToNumber:[NSNumber numberWithInt:5]] 
```

这需要额外调用`numberWithInt:`; 本质上，我们正在将具有单个调度和零分配的解决方案与具有两个调度的解决方案进行比较，并且可能是分配/解除分配。

如果您在紧密循环之外进行此比较，则无关紧要。但是如果你在一个非常紧密的循环中进行，也许在绘制某些东西时，你可能会看到速度变慢。这就是为什么我会继续使用旧方法

```
[myNumber integerValue] == 5 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-14T20:13:50.287

“旧方式”是一种方法调用加上针对两种基本类型的比较运算符。

“新方式”是一个方法调用加上一个额外的对象创建。

所以老方法效率更高。但除非这是在高性能循环（或类似的东西）中完成的，否则差异可以忽略不计。

正如您所说，新方法在特定类型的号码方面可能更加灵活。

就个人而言，我会选择您认为更具可读性和可维护性的表单，除非您有明确而具体的性能问题需要处理。

尽管您可能有特定的原因来比较浮点值或整数值，而不管原始值。在这种情况下，旧方法更好，因为比较的类型很清楚。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-15T00:49:04.010

**简短的回答：** `[myNumber integerValue] == 5`仍然是最好的。

**长（但你可能不应该关心）答案：**从 iOS 5 开始，“一些”NSNumbers 是使用标记指针（[快速谷歌](http://objectivistc.tumblr.com/post/7872364181/tagged-pointers-and-fast-pathed-cfnumber-integers-in)）实现的。这意味着只要 NSNumber 值适合 24 位（对于 iPhone/iPad 的 32 位 ARM 处理器），就不会创建实际实例。所以理论上，如果你确定这些值永远不会溢出 24 位，你实际上可以只做`myNumber == @5`.

这不是一个很好的建议。坚持`[myNumber integerValue] == 5`。标记指针可以帮助运行时，而不是程序员。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-04-09T18:18:04.987

```
NSNumber *yourNumber = @(5) 
```

使用 when`yourNumber`不应该是 nil。`yourNumber`变为 nil时会崩溃

```
[myNumber isEqualToNumber:yourNumber] 
```

使用when`yourNumber`可以为nil

```
myNumber.integerValue == yourNumber.integerValue 
```

请注意，您必须了解 yourNumber 可以采用的最大值。

如果 yourNumber 将超过`INT_MAX 2147483647`，请使用`longValue`或`longlongValue`

# requirejs - RequireJs 异步加载，同步 requirejs 和 require 的加载差异

> ID：14883164
> 
> 赞同：2
> 
> 时间：2013-02-14T20:08:46.550
> 
> 标签：requirejs

晚上好，

我是 requireJs 的新手，希望我的问题不是愚蠢的，这是我的第一个 :)。

1.  为什么这家伙在上面的代码中使用 require 和 requirejs，有什么区别？

    ```
        要求（[“配置”]，功能（配置）{
            需要js.config（配置）；
            要求（[“应用程序”，“余烬”]，函数（应用程序，余烬）{
                var app_name = config.app_name || “应用程序”;
                root[app_name] = App = Ember.Application.create(App);
                App.deferUntilDOMReady();
            });
        });
    ```

    1.  不同的代码拼写有区别吗？
    2.  在这两种情况下，脚本资源是异步加载还是同步加载？
    3.  如果我使用 requirejs-jquery 是 jquery（$）而不是全局范围还是仅本地范围（amd 范围）？

    ```
        要求（['script1','script2']，函数（）{}
    ```

    ```
        要求（功能（要求）{
          要求（'script1'）；
          要求（'script2'）；
    }
    ```

2.  是否可以有多个需要配置？例如，我有一堆嵌套结构，例如 /modules/helper/example/js/example。目前我有所有需要的垫片，在 main.js 配置中。我想放置一个 main.js 或配置。

比我不再需要在主目录中放置所有配置和路径。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T18:31:52.297

1.1 RequireJS 在全局范围内注册了自己的**两个**实例——`require`而且`requirejs`——实际上只是出于一个原因——如果一个（很可能）被另一个范围或实现不同的实例`require`覆盖，你仍然拥有——通常总是一个全局的。当您计划使用与您现在所在的模块相关的资源时，这种分离很重要。`require``requirejs`

```
// contents of 'a/b/c.js' module file
define(['require'], function(require){

    // "local scope" require call
    // resolves to 'a/b/d.js' file
    require(['./d'], function(d){})

    // "global scope" require call
    // resolves to 'd.js' file
    requirejs(['./d'], function(d){})
}) 
```

请注意，请求 local require 仅在**定义**调用中才有意义。因为`define`调用是建立“模块”和它的 ID。以上等价于这个**命名**定义：

```
// contents of whatever file
define('a/b/c', ['require'], function(require){

    // "local scope" require call
    // resolves to 'a/b/d.js' file
    require(['./d'], function(d){})

    // "global scope" require call
    // resolves to 'd.js' file
    requirejs(['./d'], function(d){})
}) 
```

James 放在那里的另一个秘密原因`requirejs`是强迫您继续`require`在本地范围内使用，因为他的构建工具会查找该特定字符串`require`以查找 require 调用。你这样做，`r.js`突然不能跟随你的依赖树，因为`myLocalRequire`不是`r.js`预期的：

```
// contents of 'a/b/c.js' module file
define(['require'], function(myLocalRequire){

    // "local scope" require call
    // resolves to 'a/b/d.js' file
    myLocalRequire(['./d'], function(d){})

    // "global scope" require call
    // resolves to 'd.js' file
    require(['./d'], function(d){})
}) 
```

1.2 RequireJS 根本**不做**同步加载。唯一你认为“必须同步！”的地方 - CommonJS 风格`var a = require('a')`的调用就像它仍然不是一样。它将资源从缓存中拉出。换句话说，它从不同步**加载任何东西。**

1.3 不要使用捆绑的RequireJS+jQuery。它使已经很大的 jQuery 变得更大，并干扰浏览器缓存。（而不是使用来自 CDN 的缓存 jQuery，您强制用户再次下载相同的 jQuery - 100k 垃圾）。

请参阅：[Use jQuery as a dependency without loading jQuery with RequireJS?](https://stackoverflow.com/questions/14854046/use-jquery-as-a-dependency-without-loading-jquery-with-requirejs/)

2.0 不要。单独的配置是一个陷阱。一旦你开始“构建”你的应用程序，你就会心甘情愿地进入地狱。我敢于给我一个单独的健全配置的示例，我无法将其表示为命名定义组或主模块加载相关资源的“包”。

唯一必须在 RequireJS 配置中的是“baseUrl”和 2-5 个全局使用的“路径”定义。而已。

# c++ - C++ 为什么这种方式很危险？

> ID：14883171
> 
> 赞同：2
> 
> 时间：2013-02-14T20:10:16.343
> 
> 标签：c++, global-variables

我的同行告诉我，我遵循的实施方式是一种危险的做法。我在主要方法和函数中为变量取了相同的名称。我的意思是只要它有效，不是吗？你会怎么做？

谢谢。

```
#include <iostream>
#include <string>
#include <sstream>
#include "Three.h"

Three::Three(void)
{
}

Three::~Three(void)
{
}

void Three::rect (int& ar, int&vl, int len, int wid, int hgt)
{
    ar = (len * wid) * 2 + (len+wid) * 2 * hgt;
    vl = len * wid * hgt;
    cout << "Area is " << ar << " square feet that contains " << vl << " cubic feet." << endl;
}

char qt;

int main (int, char**) 
{
    int len = 0;
    int wid = 0;
    int hgt = 0;
    int ar = 0;
    int vl = 0;

    do
    {
        cout << "Length of House (ft): " << endl;
        std::cin >> len;
        cout << "Width of House (ft): " << endl;
        std::cin >> wid;
        cout << "Height of House (ft): " << endl;
        std::cin >> hgt;

        Three three;
        three.rect (ar, vl, len, wid, hgt);

        cout << "q, to quit" << endl; //My own quit statement
        std::cin >> qt;
    }
        while (qt != 'q'); 

} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-14T20:12:28.660

*只要它有效，不是吗？*一般来说，这不是一个好的口头禅（特别是在 C/C++ 中，有很多看似工作的未定义行为的空间），但在这种情况下，我没有发现任何问题。

如果您有一个隐藏全局变量之类的局部变量，可能会有一些混淆的可能性，但在这里它不是那样的 - 一个恰好与通过它的参数具有相同名称的参数不会混淆，也不会完全“危险”。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-14T20:11:45.557

这种做法绝对没有任何问题。您的代码有一些小的奇怪之处，但在两个函数中使用相同的变量名不是其中之一。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-14T20:15:29.597

他可能的意思是，如果您在类函数和类本身中使用相同的变量名，这是“危险的”，因为这会导致错误。但这不是这里的情况，代码很好。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-14T20:17:00.390

代码中更危险的做法是，您`std::cin`从不检查是否有任何读取失败的情况下进行读取。如果有的话，你将在无限的等待中`qt`成为`'q'`。

此外，能够使用只是`cout`表明您可能有一个不推荐的做法`using namespace std;`。`Three.h`（也许它只有`using std::cout;`你明确限定`std::cin`？）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-14T20:16:23.710

可以这样做。但请记住给变量起更好的名称。例如，重命名`wid`为`Width`. 通常我更喜欢将函数的输入参数写为`in_Width`. 这样我们就知道它是当前函数的输入。当您开始编写大型项目时，这些事情将很重要。:) 总是尝试有好的做法。

打字时需要时间。但是在审查或调试方面，它可以为您省去很多麻烦。另一方面，它没有其他明显的缺点。

# joomla - Joomla 3 - 用什么代替assignRef？

> ID：14883180
> 
> 赞同：3
> 
> 时间：2013-02-14T20:11:07.440
> 
> 标签：joomla, joomla3.0

在我的项目中，我认为有这种方法：

```
public function elegirSeleccionados(){
    $this->assignRef('pagination', $this->get('pagination'));
    $this->assignRef('items', $this->get('recientes'));
    $this->assignRef('list', $this->get('list'));
    parent::display();
} 
```

`assignRef`在此 Joomla 3 中已弃用/删除。

我应该改用什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-14T20:42:30.420

***不再需要assignRef() 和assign()***，因为Joomla 1.6+ 至少需要PHP 5.2（PHP5 使用通过引用分配）。

在 view.html.php 中使用

`$this->pagination = $this->get('pagination')`

并在模板中调用`$this->pagination`.

要让您的技能保持最新，请查看官方[Joomla！文档](http://docs.joomla.org/Developers)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-16T21:45:08.823

txs，但在我看来（default.tpl）zeh val 不会显示

## **视图.html.php**

```
$this->my_string = "ledl";
<br>
return parent::display($tpl); 
```

## **默认.tpl**

```
<bold>{$this->my_string}</bold> 
```

# matlab - Matlab rgb2gray() 未定义函数错误

> ID：14883181
> 
> 赞同：1
> 
> 时间：2013-02-14T20:11:08.073
> 
> 标签：matlab, licensing

不幸的是，顶着一切阻力，我再次被迫使用 Matlab。我正在尝试使用一些我知道几个月前运行的事实的代码。

这是我的代码：

```
colour_image = imread(filename);
grey_image = rgb2gray(colour_image); 
```

这是我的错误：

```
Undefined function 'rgb2gray' for input arguments of type 'uint8'. 
```

这是 rgb2gray 的文档：

```
% If the input is an RGB image, it can be uint8, uint16, double, or
% single. 
```

因此，该函数允许 uint8 参数，但在给定 uint8 参数时给我一个错误。为什么？

我用谷歌搜索并被引导到这个链接：

```
http://www.mathworks.com/support/solutions/en/data/1-4B6E5E/ 
```

好的，让我们确保我有正确的工具箱（即使我知道它在那里）

我输入：ver

```
Image Processing Toolbox                              Version 8.0        (R2012a) 
```

好的，很好，我有正确的工具箱，许可和所有。

我输入：which -all rgb2gray

```
C:\Program Files\MATLAB\R2012a\toolbox\images\images\rgb2gray.m  % Has no license available 
```

好的，即使我有正确的许可工具箱，这个特定的功能也没有许可....嗯，好吗？

所以让我们试试这个“许可证结帐”，但首先我必须找到我的许可证密钥名。要查找许可证密钥名称，我需要查看许可证文件中的 INCREMENT 行……太好了。

所以我去：

```
http://www.mathworks.com/support/solutions/en/data/1-63ZIR6/index.html 
```

嗯，因为这是通过网络，我在客户端机器上，我有一个“network.lic”，我打开它找到我的 INCREMENT 行，当然它不在那里！

```
If your license.dat file has no INCREMENT lines, refer to your license administrator for these INCREMENT lines. 
```

有人可以让我摆脱痛苦吗？

编辑：所以在运行许可证检查后，我得到：

```
License checkout failed.
License Manager Error -101 
```

根据网站：

```
This error message indicates that the license administrator has reserved all the licenses of the product you are trying to use for other users. 
```

由于我的管理员正在休假，我将尝试说服我的主管让我改用 C/C++ 图像处理库。谢谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T20:41:26.043

许可证文件中 INCREMENT for Image Processing Toolbox 后的简称为：

> Image_Toolbox

**更新：**

或者，也许这可以帮助您：[如何在不使用图像处理工具箱的情况下将我的 RGB 图像转换为灰度图像？](http://mathworks.ch/support/solutions/en/data/1-1ASCU)

# java - 在不同的地方从 socket serval 读取相同的时间

> ID：14883183
> 
> 赞同：0
> 
> 时间：2013-02-14T20:11:27.573
> 
> 标签：java, sockets, connection

我通过 ObjectInputStream 从套接字读取对象。假设我从主服务器将对象 myobjec 发送到客户端。在客户端，有 2 个线程一直在读取对象。两个线程是否有可能读取相同的 myobject？我正在尝试这样做，但我得到“由对等错误连接”。

# ruby-on-rails - 来自 Rails 表单的用户数据不会被 UTF-8 编码吗？

> ID：14883184
> 
> 赞同：2
> 
> 时间：2013-02-14T20:11:30.537
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, character-encoding

我参与的 Rails 3.2 应用程序有一个方法可以将用户输入强制转换为 UTF-8。

```
require "iconv"

def normalize(user_input_text)
  Iconv.new('UTF-8//IGNORE', 'UTF-8').iconv(user_input_text.dup)
end 
```

它基本上以 UTF-8 对字符串进行编码，并忽略无法转码的字符。

但是，不是所有通过表单进入 Rails 的用户数据都会被 UTF-8 编码吗？

换句话说，这段代码难道不是似是而非且不必要的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T01:31:29.733

这些资源表明您确实是对的。

> 现在绝大多数 Web 输入都是 UTF-8，我们将入站参数设置为 UTF-8。这将消除 ASCII-8BIT 和 UTF-8 之间编码不兼容的许多情况。

[https://github.com/rails/rails/commit/25215d7285db10e2c04d903f251b791342e4dd6a](https://github.com/rails/rails/commit/25215d7285db10e2c04d903f251b791342e4dd6a)

> Rails 3 通过做很多事情很好地解决了这个问题，包括将参数解释为 UTF-8 并为 Internet Explorer 添加解决方法

[http://jasoncodes.com/posts/ruby19-rails2-encodings](http://jasoncodes.com/posts/ruby19-rails2-encodings)

# bash - 如何将 bash 变量作为 awk 参数的值传递？

> ID：14883186
> 
> 赞同：2
> 
> 时间：2013-02-14T20:11:34.250
> 
> 标签：bash, scripting, awk

我想用 bash 变量替换 awk 命令中的变量。

例如：

```
var="one two three"    
echo $var | awk "{print $2}" 
```

我想`$2`用`var`变量替换。我已经尝试`awk -v`过以及`awk "{ print ${$wordnum} }`无济于事的事情。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T20:24:32.193

明显不同的方法：

```
$ echo $var
one two three

$ field=3

$ echo $var | awk -v f="$field" '{print $f}'
three

$ field=2

$ echo $var | awk -v f="$field" '{print $f}'
two 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T20:14:59.617

你几乎得到它...

```
$ myfield='$3'
$ echo $var | awk "{print $myfield}"
three 
```

第一行的硬引号阻止`$3`了 shell 的解释。第二行的软引号允许变量替换。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T20:56:29.530

您可以将 awk 语句的一部分与变量连接起来。也许这是您在脚本文件中想要的：

`echo $1|awk '{print($'$2');}'`

在这里`{print($`，局部变量 $2 和的部分和值`);}`​​被连接起来并提供给 awk。

编辑：经过一些建议，不要使用它。也许作为一次性解决方案。最好立即习惯这样做 - 请参阅第一条评论中的链接。

# ruby-on-rails - Heroku 迁移和 Rake 任务在大约 10k SQL 写入后几乎停止

> ID：14883199
> 
> 赞同：0
> 
> 时间：2013-02-14T20:12:11.287
> 
> 标签：ruby-on-rails, heroku

我注意到我的 Migrations 和 Rake Tasks 基本上在创建大约 10k 新记录后停止。有没有其他人注意到这个问题？Heroku 是否在做一些节流？

**除了将 Migration/Rake 任务分解成更小的部分之外，还有什么建议吗？**

**这是 Heroku 的已知问题吗？**

*细节：*

*   Rails 3.1.10 应用程序
*   Heroku 雪松
*   登录到控制台已禁用，但我打印了一个“。” 每次写

*想法：*
起初我认为是通过网络打印了太多的 SQL 语句，从而减慢了连接速度或类似的坏魔法。但是由于我禁用了日志记录，所以什么都没有改变。此外，它与代码无关——当我创建数千条任何类型的记录时，我会注意到它。

## 编辑

我`Suggestion`在调用此代码的循环中创建记录：

```
# in suggestable.rb
# Suggestable polymorphically represents objects which can be suggested

has_many :parent_suggestions, class_name: 'Suggestion', as: :suggestable, dependent: :destroy

# create Suggestion for this suggestable / suggestee
def suggest_to!(suggestee, conf=0)
  get_parent_suggestion_for(suggestee) || 
    parent_suggestions.create(suggestable: self, confidence: conf, suggestee: suggestee)
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T07:37:08.850

如果新创建的（和实例化的）建议都在创建它们的循环中的对象的关联中，那么它们将不会被垃圾收集。您可以尝试定期重新加载根对象以释放引用。

# ios - IOS如果模式被解除，如何在ViewController中调用方法

> ID：14883201
> 
> 赞同：2
> 
> 时间：2013-02-14T20:12:17.617
> 
> 标签：ios, objective-c, modalviewcontroller

在所有视图控制器 `present`中，`ModalViewController`在我关闭模态视图控制器后，我想在当前视图控制器中调用一个方法。

我必须展示ModalViewController 我不能推送它，因为它是一个表单。由于我无法推送它`(void)viewDidAppear:(BOOL)animated`，因此当我关闭表单时不会调用它。

顺便说一句，表单是一个设置菜单，我必须在每个视图控制器中调用它，所以我不能使用通知，因为有超过 20 个视图控制器并且只有一个设置菜单；

```
Navigation controller -> Root- > VC1 - > VC2 - > VC3 ->VC4........... VC20......
                                  |       |       |     |               |
                                 Menu    Menu    Menu  Menu           Menu 
```

我介绍菜单：

```
UIStoryboard*  sb = [UIStoryboard storyboardWithName:@"MainStoryboard"
                                              bundle:nil];
SettingsListViewController *settingsVC = [sb instantiateViewControllerWithIdentifier:@"SettingsListViewController"];
UINavigationController *modalViewNavController= [[UINavigationController alloc] initWithRootViewController:settingsVC];
modalViewNavController.modalTransitionStyle = UIModalTransitionStyleFlipHorizontal;
modalViewNavController.modalPresentationStyle = UIModalPresentationFormSheet;
[self presentModalViewController:modalViewNavController animated:YES]; 
```

我驳回它：

```
 //dissmiss view
 [self.navigationController dismissModalViewControllerAnimated:YES] ; 
```

在我想调用的视图控制器中； `[self.navigationController popToRootViewControllerAnimated:NO];`

当表单被关闭时，有没有办法在 View Controller 中调用方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T23:35:47.977

从 iOS 5 开始，您可以使用`presentingViewController`every 的属性`UIViewController`来查看 1）它们是否首先以模态方式呈现，以及 2）然后以模态方式呈现它们的是谁。因此，如果您通过调用来展示您的表单`[self.navigationController presentModalViewController:modalViewNavController animated:YES]`，展示的视图控制器将成为根导航控制器，您可以告诉它在您关闭模式展示的同时弹出到根。

顺便说一句，`storyboard`每个视图控制器中还有一个源自故事板的属性，因此您可以在按名称实例化新的故事板视图控制器时直接使用该属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T00:20:57.223

制作您自己的委托并设置将视图呈现为委托的视图控制器。当它即将被解除时，从 modalVC 调用。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-14T20:19:37.333

如果您想在关闭之前发送消息，您可以像这样从模态视图控制器设置`modalViewController.parentViewController = self;`然后使用它：

```
- (void)viewWillDisappear:(BOOL)animated {
    [self.parentViewController doSomething];
} 
```

# c# - 根据条件确定 LINQ Enumerable 是否包含对象？

> ID：14883207
> 
> 赞同：3
> 
> 时间：2013-02-14T20:12:30.133
> 
> 标签：c#, linq, ienumerable

我有一个`IEnumerable<Project>`

我想知道这个列表是否有任何元素`Project.ID == someID`。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-14T20:13:58.757

是的，您想使用该`Any`方法（[文档](http://msdn.microsoft.com/en-us/library/bb534972.aspx)）。

```
IEnumerable<Project> projects = SomeMethodReturningProjects();
if(projects.Any(p => p.ID == someID))
{
    //Do something...
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-14T20:14:26.433

您可以使用[Any()](http://msdn.microsoft.com/en-us/library/bb534972.aspx)扩展方法。

```
var hasAny = projectList.Any(proj => proj.ID == someID); 
```

或者，如果您想获取该记录，可以使用[FirstOrDefault()](http://msdn.microsoft.com/en-us/library/bb340482.aspx)：

```
var matchedProject = projectList.FirstOrDefault(proj => proj.ID == someID); 
```

`null`如果它没有找到任何匹配的东西，这将返回，但如果找到它，它将拉出整个对象。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-14T20:14:12.203

使用

```
projects.Any(p => p.ID == someID) 
```

如果谓词与任何元素匹配，则返回 true（布尔值）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-02-14T20:14:00.410

是的，使用`Any`扩展方法：

```
list.Any(p => p.ID == someID); 
```

# python - Heroku python 控制台应用程序模块 ImportError

> ID：14883211
> 
> 赞同：0
> 
> 时间：2013-02-14T20:12:45.107
> 
> 标签：python, postgresql, heroku

我在尝试从 heroku python 控制台访问 PostgreSQL 时遇到了一个问题（第一次尝试）。

首先，我使用启动 python`$ heroku run python`

然后我尝试用 加载 db 模块`>>> from app import db`，此操作返回：

```
Traceback (most recent call last):
    File "<stdin>", line 1, in <module>
ImportError: No module named app 
```

我有一个运行 python 的网络测功机`app = Flask(__name__)`，除此之外，我不知道我应该提供哪些其他细节才能更清楚地了解这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T09:22:14.143

在对终端进行试验之后，很明显，它确实无法知道我`main.py`的 .

```
>>> import os
>>> from flask import Flask, request, session, g, redirect, url_for, abort, render_template, flash
>>> from flask.ext.sqlalchemy import SQLAlchemy

>>> # create the application
>>> app = Flask(__name__)
>>> app.config.from_object(__name__)
>>> app.config['SQLALCHEMY_DATABASE_URI'] = os.environ.get('DATABASE_URL', 'some-url.com')
>>> db = SQLAlchemy(app) 
```

从那时起，我就能够`db`按预期访问该对象。

编辑 - 问题在下面完全解决。

所以我在尝试将我的应用程序代码导入 python shell 时出错的原因有两个：

1.  作为我导入目标的 *.py 不在根目录中，我告诉 shell 查找**错误的位置**。
2.  由于我导入的 *.py 没有命名为 app.py （我要求这样做`from app import db`），我还告诉 shell 查找**错误的文件**。

解决此问题的方法是将我的 *.py 文件的路径附加到 sys.path 而不是`from app import db`, us `from my_filename_without_the_extenssion import db`。总结一下，shell 收到了这些指令：

```
>>> import sys
>>> sys.path.append('path/to/my/file')
>>> from my_filename_without_the_extenssion import db
>>> # to test if everythings ok
>>> db 
```

# c++ - 在 C++ 中删除整个列表

> ID：14883217
> 
> 赞同：2
> 
> 时间：2013-02-14T20:13:14.933
> 
> 标签：c++, list

我在网上找到了一个非常简单的 List 类。在我的程序中，我创建了一个特定类型的列表并将其用于一些计算。现在我想使用相同的列表（相同类型的列表）并将其用于其他事情。为了让事情更清楚：

```
List<Vertex*> vertices;
List<Triangle*> triangles; 
```

我使用两个函数在这些列表中添加信息：

```
void AddVertex(List<Vector> &vertex)
void AddFaces(List<triangle_data> &f) 
```

这是我正在使用的两个基本列表。现在我想对其他顶点和三角形（不同的模型）使用相同的列表。那么我应该如何“删除”两个列表中的所有内容并将它们与不同的顶点和三角形一起使用？

这是我正在使用的典型 list.h：

```
template <class Type> class List {
public:
            List(int s=0);
            ~List();
    void    allocate(int s);
    void    SetSize(int s);
    void    Pack();
    void    Add(Type);
    void    AddUnique(Type);
    int     Contains(Type);
    void    Remove(Type);
    void    DelIndex(int i);
    Type *  element;
    int     num;
    int     array_size;
    Type    &operator[](int i){assert(i>=0); assert(i<num); return element[i];}
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T20:21:31.133

我会使用像 std::list 或 std::vector 这样的 STL 容器并使用[clear()](http://www.cplusplus.com/reference/vector/vector/clear/)成员函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T20:50:39.927

干得好。您的*List*类实际上是一个向量类。

您可以：

*(1) 用std::vector*替换它，然后调用*std::vector::clear*，

(2) 将*Clear*方法添加到您的*List*类中，如下所示：

```
void List::Clear(bool resetSize /* = false */) {
    num = 0;
    if (resetSize) {
         delete [] element; element=0; array_size = 0;
    }
} 
```

然后适当地调用*Clear*。

或者

(3) 你可以这样做：

```
while (list.num) list.DelIndex(list.num-1); 
```

这是假设您有一个名为*list的**List*实例。

 *以下是评论：

(1) 是首选，因为它是规范且易于让下一个人阅读您的代码的。(2) 如果您绝对不想更改代码，则可以。(3) 如果您真的很懒惰并且不关心性能（或者如果您出于任何原因无法更改*List*类 - 例如您只能访问标题），则可以。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T21:33:26.790

我的建议是采用`std::vector<>`，但我从您那里了解到，您的代码严重依赖于“ `List`”。实际上这并不完全是一个问题，您可以`List<>`以`std::vector<>`这种方式“转换”您的（不是最好的方式，这是真的）：

```
template <class Type> class List {
public:
    List(int s=0)
        { v.capacity( s ); }
    ~List()
        { v.clear(); }
    void    allocate(int s)
        { v.reserve( s ); }
    void    SetSize(int s)
        { v.resize( s ); }
    void    Pack()
        {}
    void    Add(Type x)
        { v.push_back( x ); }
    void    AddUnique(Type)
        {}
    int Contains(Type x)
        { std::vector::iterator it = find( v.begin(), v.end(), x );
          return ( it - v.begin() );
        }
    void    Remove(Type x)
        { int pos = Contains( x ); if ( pos < Size() ) { DelIndex( pos ); } }
    void    DelIndex(int i)
        { v.erase( v.begin() + i ); }
    Type    &operator[](int i)
        {assert(i>=0); assert(i<num); return element[i];}
    Type    &operator[](int i) const
        {assert(i>=0); assert(i<num); return element[i];}
    unsigned int Size() const
        { return v.size(); }
private:
    std::vector<T> v;
}; 
```

反正你懂这个意思。我把它们中的一些留空了，因为我不知道它们到底是做什么的。

关于您的问题，您显然是在存储指向`Triangles`and的指针`Vertex`。如果指向该对象的唯一指针是列表对象中的指针，那么您应该遍历列表以删除每个对象，然后再删除*整个*向量。

```
template <typename T>
void ClearList(List<T> &l)
{
    for(unsigned int i = 0; i < l.Size(); ++i) {
        delete l[ i ];
    }

    l.Clear();
} 
```

希望这可以帮助。*

# linux - 无法使用 tc tbf 设置速度限制

> ID：14883224
> 
> 赞同：0
> 
> 时间：2013-02-14T20:13:28.747
> 
> 标签：linux, shell, networking, asterisk, qos

我正在使用 tc 在星号服务器上执行 QOS。我想优先考虑语音和 sip 流量，但还要将所有其他流量限制在一个固定的限制内。

这是我的脚本：

```
#!/bin/bash
IFACE=eth1
UPSPEED=1.5mbit
tc qdisc del dev $IFACE root
tc qdisc add dev $IFACE root handle 1: prio priomap 2 2 2 2 2 2 2 2 1 1 1 1 1 1 1 0
tc qdisc add dev $IFACE parent 1:1 handle 10: sfq perturb 10
tc qdisc add dev $IFACE parent 1:2 handle 20: sfq perturb 10
tc qdisc add dev $IFACE parent 1:3 handle 30: tbf rate $UPSPEED burst 4kb mtu 1500   latency 100ms
tc filter add dev $IFACE protocol ip parent 1: prio 1 u32 match ip tos 0xb8 0xff flowid 1:1
tc filter add dev $IFACE protocol ip parent 1: prio 1 u32 match ip tos 0x60 0xff flowid 1:2 
```

RTP 和 SIP 流量得到很好的管理，被发送到第一个和第二个频段。所有其他流量也得到很好的管理，被发送到第三个频段。但是，由于某些原因，如果我从服务器下载，它始终是 10-16k/sec，而不是我的脚本中指定的 185-190k (1.5mbit)。

最糟糕的是，似乎无论我如何更改 tbf 变量，速度都保持不变。

使用 qdisc -s ls，我设法发现数据包被丢弃：

```
qdisc prio 1: bands 3 priomap  2 2 2 2 2 2 2 2 1 1 1 1 1 1 1 0
Sent 12610974 bytes 45683 pkt (dropped 1147, overlimits 0 requeues 0) 
rate 0bit 0pps backlog 0b 0p requeues 0 
qdisc sfq 10: parent 1:1 limit 126p quantum 1514b perturb 10sec 
Sent 7802180 bytes 36590 pkt (dropped 0, overlimits 0 requeues 0) 
rate 0bit 0pps backlog 0b 0p requeues 0 
qdisc sfq 20: parent 1:2 limit 126p quantum 1514b perturb 10sec 
Sent 181620 bytes 283 pkt (dropped 0, overlimits 0 requeues 0) 
rate 0bit 0pps backlog 0b 0p requeues 0 
qdisc tbf 30: parent 1:3 rate 1500Kbit burst 4Kb lat 100.0ms 
Sent 4627174 bytes 8810 pkt (dropped 1147, overlimits 0 requeues 0) 
rate 0bit 0pps backlog 0b 0p requeues 0 
```

但我不知道为什么。同样，更改 tbf 变量并没有改变任何东西，数据包不断被丢弃。

请注意eth1的mtu是1500。

任何人？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-23T01:11:19.193

添加`mtu 100000`到您的`tc qdisc`创建命令。有关更多信息，请参阅[此帖子](http://timesinker.blogspot.com/2011/02/using-linux-tbf-qdisc-for-rate-limiting.html)。

引用帖子，以防它消失：

> 基本上，如果您的接口启用了[TSO/GSO](https://en.wikipedia.org/wiki/Large_segment_offload)`ethtool -k ethX` （使用 检查），或者您正在使用环回接口 - 那么您可能会遇到问题。事实证明，环回接口默认启用了 GSO/TSO，而且由于它是一个软件接口，其默认 mtu 为 16384（与普通以太网接口的 1500 相比）。这很重要，因为 tbf 队列检查传入“数据包”的大小 - 在 GSO/TSO 的情况下，它比普通的在线数据包大得多 - 相反，它们最多为 iface 的 9 x mtu。因此，对于普通接口，它大约是 12K，但对于环回，它大约是 100k！

这似乎也适用于 Xen 接口：

```
# ethtool -k eth0
eth0 的特点：
rx-checksumming: on [fixed]
tx 校验和：开启
    tx-checksum-ipv4: 开启
    tx-checksum-unneeded：关闭 [已修复]
    tx-checksum-ip-generic：关闭 [已修复]
    tx-checksum-ipv6：关闭 [已修复]
    tx-checksum-fcoe-crc：关闭 [已修复]
    tx-checksum-sctp：关闭 [已修复]
分散聚集：开
    tx-scatter-gather：开
    tx-scatter-gather-fraglist：关闭 [已修复]
tcp-segmentation-offload: on # 这是 TSO
    tx-tcp 分段：开启
    tx-tcp-ecn-segmentation：关闭 [已修复]
    tx-tcp6-segmentation：关闭 [已修复]
udp-fragmentation-offload：关闭 [已修复]
generic-segmentation-offload: on # 这是 GSO
通用接收卸载：开启
large-receive-offload：关闭 [已修复]
rx-vlan-offload：关闭 [已修复]
tx-vlan-offload：关闭 [已修复]
ntuple-filters: 关闭 [已修复]
接收散列：关闭 [已修复]
highdma：关闭 [已修复]
rx-vlan-filter：关闭 [已修复]
vlan-challenged：关闭 [已修复]
tx-lockless：关闭 [已修复]
netns-local：关闭 [已修复]
tx-gso-robust：开启 [已修复]
tx-fcoe-segmentation：关闭 [已修复]
fcoe-mtu：关闭 [已修复]
tx-nocache-copy：打开
环回：关闭[固定]

```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-12-26T02:44:14.207

我遇到过同样的问题。关闭分段卸载将解决问题（您不再需要将 mtu 传递给 tc）。

```
sudo ethtool -K eth1 tso off
sudo ethtool -K eth1 gso off
sudo ethtool -K eth1 gro off
sudo ethtool --offload  eth1  rx off  tx off 
```

# menu - 菜单驱动的回文测试器出现堆栈溢出错误

> ID：14883226
> 
> 赞同：0
> 
> 时间：2013-02-14T20:13:43.113
> 
> 标签：menu, console, stack-overflow, palindrome

我正在为一堂课做这个，我真的不是很厉害，因为我已经十多年没有练习了。我正在尝试编写一个显示菜单的程序，以便用户可以在确定它是否是回文的方法之间进行选择。

完成测试后，它需要重新显示菜单。我在 isPalindrome 方法中遇到堆栈溢出错误，因为我将 2 个类合并为一个类，我认为这可以解决我在输出中遇到的另一个问题！我可以采取任何想法或方向吗？

```
import java.util.Scanner;

public class PalHelper 
{
public String pal;
public void MenuList() 
{
System.out.println("How would you like to check your phrase?");
System.out.println("1\. Check the first letter like it's the last letter - Leave no phrase unturned!");
System.out.println("2\. I Prefer my Palindromes have the gentle treatment");
System.out.println("3\. We're done here");
System.out.print("Selection: ");
}

public PalHelper() 
{
Scanner decision = new Scanner(System.in);
    MenuList();

switch (decision.nextInt()) 
{
    //to access the character by character method of determination
    case 1:
    System.out.print("Enter Phrase to Test, the Hard Way:");
    Scanner keyboard1 = new Scanner(System.in); //declares scanner variable for user entry
    String UserInput1 = keyboard1.next();//Phrase variable
    Boolean test1 = isPalindrome(UserInput1);
            if (test1 == true){
                System.out.println(UserInput1+" is a palindrome. That doesn't make you smart.");    
                        }
            else {
                System.out.println(UserInput1+" is a not palindrome. Why don't you think a little harder and try again.");
                        }
    System.out.println("..\n..\n..\n");
    keyboard1.close();
    new MenuList();
    break;

    //to access the string buffer method of determination
    case 2:
    System.out.print("Thank you for choosing the gentle way, please enter your phrase:");
    Scanner keyboard2 = new Scanner(System.in); //declares scanner variable for user entry
    String UserInput2 = keyboard2.next();
    Boolean test2 = isPalindrome2(UserInput2);
    if (test2 == true){
                System.out.println(UserInput2+" is a palindrome. Congratulations! You are so wonderful!");  
                    }
            else {
                System.out.println(UserInput2+" is a not palindrome. It's ok, I'm sure you'll get it next time.");
                    }
    System.out.println("..\n..\n..\n");
    keyboard2.close();
    new MenuList();
    break;

//exit menu
    case 3:
    System.out.println ( "Too bad – I hid a boot!" );    
    break;

//response to input other than 1,2,3
    default:
    System.out.println ( "No sir! Away! A papaya war is on." );
    System.out.println("..\n..\n..\n");
    new MenuList();
    break;

    }// close switch
}//close pal helper

public void Palindrome(String UserInput) {

}

public boolean isPalindrome(String UserInput) {
pal = UserInput.toUpperCase();   
if (pal.length() <= 1) {//one character, automatically a palindrome
   return true;     
}

char start = pal.charAt(0);
char end = pal.charAt(pal.length()-1);
        if (Character.isLetter(start) &&
            Character.isLetter(end)) {//check if first and last characters match

            if (start != end) {
                return false;     //if the beginning & ending characters are not the same it's not a palindrome      
            }
            else {

            Palindrome subpal = new Palindrome(pal.substring(1,pal.length()-1));
            return subpal.isPalindrome();  //check middle dropping start and end letters
            }
        }
        else if (!Character.isLetter(start)) {
            Palindrome subpal = new Palindrome(pal.substring(1));
            return subpal.isPalindrome(pal);      //check if first letter is a letter, drop if not
        }
        else {
            Palindrome subpal = new Palindrome(pal.substring(0,pal.length()-1));
            return subpal.isPalindrome(pal);      //check if first letter is a letter, drop if not
        }                       

}//close isPalindrome
public boolean isPalindrome2(String UserInput){

 pal = UserInput.toUpperCase();
 pal = pal.replaceAll("\\W", "");//gets rid of space and punctuation
 StringBuffer check = new StringBuffer(pal);//reverses pal string and creates new stringbuffer for check
 check.reverse();

        if (check.toString().equals(pal)){//checks for equality between pal and it's reverse
            return true;
        }
        else {
            return false;
        }

  }//close isPalindrome2

public static void main (String[]args) 
{
new PalHelper();

}//close main
}//close class 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T20:31:46.547

除了我上面的评论之外，我注意到了一个问题：在某些情况下，您使用子字符串构造了一个新的回文实例，但在递归到`isPalindrome()`方法时传递了完整的字符串。这会导致递归永远不会终止（这也使您的代码难以遵循）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T20:34:43.493

1.  您的示例缺少某些内容，以下行缺少右括号：

    回文 subpal = new Palindrome(pal.substring(1,pal.length()-1);

2.  您的评论似乎与代码不符：

    返回 subpal.isPalindrome(pal); //检查第一个字母是否是字母，如果不是则丢弃

3.  尝试将输出添加到方法`isPalindrome()`或调试它。您可能没有使用正确的字符串调用它，并最终一遍又一遍地循环相同的字符串。

    public boolean isPalindrome(String UserInput) { System.out.println(UserInput); ...

编辑：如果您的代码确实像您发布的那样精确，那么 vhallac 是正确的，您可以`isPalindrome()`使用完整的字符串调用。

# linux - gcc 链接错误

> ID：14883228
> 
> 赞同：0
> 
> 时间：2013-02-14T20:13:51.093
> 
> 标签：linux, gcc

我正在尝试构建包含在源代码中的[libvterm 的演示。](http://sourceforge.net/projects/libvterm/?source=dlp)

我有这个文件夹结构：

```
- libvterm/
  ... // all sources are here
  - libvterm.so
  - vterm.h
  - demo/
    - vshell.c 
```

在演示目录中我做了：

```
$ gcc -o vshell `pkg-config --cflags --libs glib-2.0 ncurses` vshell.c -L.. -I.. -lvterm 
```

`undefined reference to`即使在定义**-I**和**-L**指向正确的目录之后，我也会遇到很多错误：

```
/tmp/ccAlNYtQ.o: In function `main':
vshell.c:(.text+0x24): undefined reference to `initscr'
vshell.c:(.text+0x29): undefined reference to `noecho'
vshell.c:(.text+0x2e): undefined reference to `start_color'
vshell.c:(.text+0x33): undefined reference to `raw'
vshell.c:(.text+0x38): undefined reference to `stdscr'
vshell.c:(.text+0x48): undefined reference to `nodelay'
vshell.c:(.text+0x4d): undefined reference to `stdscr'
vshell.c:(.text+0x5d): undefined reference to `keypad'
vshell.c:(.text+0x62): undefined reference to `stdscr'
vshell.c:(.text+0x6b): undefined reference to `stdscr'
vshell.c:(.text+0x84): undefined reference to `stdscr'
vshell.c:(.text+0x8d): undefined reference to `stdscr'
vshell.c:(.text+0xfb): undefined reference to `init_pair'
vshell.c:(.text+0x118): undefined reference to `stdscr'
vshell.c:(.text+0x121): undefined reference to `stdscr'
vshell.c:(.text+0x141): undefined reference to `stdscr'
vshell.c:(.text+0x151): undefined reference to `waddch'
vshell.c:(.text+0x176): undefined reference to `stdscr'
vshell.c:(.text+0x17e): undefined reference to `wrefresh'
vshell.c:(.text+0x1a2): undefined reference to `newwin'
vshell.c:(.text+0x1e1): undefined reference to `mvwprintw'
vshell.c:(.text+0x1ee): undefined reference to `wrefresh'
vshell.c:(.text+0x2ac): undefined reference to `wtouchln'
vshell.c:(.text+0x2b9): undefined reference to `wrefresh'
vshell.c:(.text+0x2be): undefined reference to `stdscr'
vshell.c:(.text+0x2c6): undefined reference to `wrefresh'
vshell.c:(.text+0x2d2): undefined reference to `stdscr'
vshell.c:(.text+0x2da): undefined reference to `wgetch'
vshell.c:(.text+0x308): undefined reference to `endwin'
../libvterm.so: undefined reference to `forkpty'
../libvterm.so: undefined reference to `g_free'
../libvterm.so: undefined reference to `has_colors'
../libvterm.so: undefined reference to `acs_map'
../libvterm.so: undefined reference to `wchgat'
../libvterm.so: undefined reference to `beep'
../libvterm.so: undefined reference to `pair_content'
../libvterm.so: undefined reference to `COLOR_PAIRS'
../libvterm.so: undefined reference to `g_realloc'
../libvterm.so: undefined reference to `g_malloc0'
../libvterm.so: undefined reference to `wmove'
collect2: ld returned 1 exit status 
```

我错过了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T20:16:09.353

尝试重新排序您的链接命令...

```
gcc -o vshell vshell.c -L.. -I.. -lvterm `pkg-config --cflags --libs glib-2.0 ncurses` 
```

在某些时候，gnu 链接器更改为首先需要对象，最后/稍后需要库。

# php - 刷新站点时PHP中的会话将项目重新添加到购物车

> ID：14883229
> 
> 赞同：0
> 
> 时间：2013-02-14T20:13:56.103
> 
> 标签：php, session, browser-refresh

我在 PHP 中有以下函数，每次用户单击“添加到购物车”时，它都会将一个项目添加到购物车中。

问题是，如果有人在将商品添加到购物车后手动重新加载页面，则会添加新商品。

有什么技巧可以避免这种情况吗？

```
function addtocart($pid,$q)
    {
        if($pid<1 or $q<1) return;
        if(is_array($_SESSION['cart']))
        {

            $max=count($_SESSION['cart']);
            $_SESSION['cart'][$max]['itemId']=$pid;
            $_SESSION['cart'][$max]['qty']=$q;
            $max=count($_SESSION['cart']);
        }
        else
        {
            $_SESSION['cart']=array();
            $_SESSION['cart'][0]['itemId']=$pid;
            $_SESSION['cart'][0]['qty']=$q;
            $max=count($_SESSION['cart']);

        }
    } 
```

这就是我调用函数的方式：

用户点击加入购物车：

```
<input type="button" value="<?php echo $lang['ADDTOCART']; ?>" class="addToCart" onclick="addtocart(<?php echo $itemId; ?>)" /> 
```

执行的Javascript：

```
<script language="javascript">
    function addtocart(pid){
        document.cartAdding.itemId.value=pid;
        document.cartAdding.command.value='add';
        document.cartAdding.submit();
    }
</script> 
```

页面重新加载并进入此处：

```
if(isset($_REQUEST['command']) && $_REQUEST['command']=='add' && $_REQUEST['itemId']>0)
{
        $pid=$_REQUEST['itemId'];
        addtocart($pid,1);
} 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T20:19:53.207

您可以放置​​一个 if 语句来检查该元素是否已被添加。在我的头顶上，类似：

```
if (array_key_exists($pid, $_SESSION['cart']['itemId'])){ // check to see if product has already been added
 // put code statments here
} 
```

# r - 在 R 中添加简单的图例

> ID：14883238
> 
> 赞同：40
> 
> 时间：2013-02-14T20:14:20.597
> 
> 标签：r

我想创建一个非常简单的情节。我正在使用[这些数据](https://dl.dropbox.com/u/22681355/a.csv)：

```
a <- read.table("https://dl.dropbox.com/u/22681355/a.csv", sep=',', header=TRUE)

plot(a$X25, type="l",col="red", ylim=c(0,100))
lines(a$X25.1, type="l", col="blue")
lines(a$X25.2, type="l", col="green")
lines(a$X25.3, type="l", col="brown") 
```

现在我想添加一个简单的图例，指示哪个颜色是哪个变量。

我知道我可以使用该`legend()`命令，但我的问题是我不知道如何在图例中的文本旁边放置颜色。

执行此操作的最简单命令是什么？

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2013-02-14T20:21:25.517

看看`?legend`并试试这个：

```
legend('topright', names(a)[-1] , 
   lty=1, col=c('red', 'blue', 'green',' brown'), bty='n', cex=.75) 
```

![在此处输入图像描述](../Images/64f5f96d10bba77b3a8a7b2debf80b79.png)

# c# - SQL Server Azure - 每 x 分钟执行一次存储过程

> ID：14883247
> 
> 赞同：3
> 
> 时间：2013-02-14T20:14:49.287
> 
> 标签：c#, sql-server-2008, azure, azure-sql-database

通常使用 SQL Server，我可以设置一个作业并让它每隔一段时间运行一次。像[这样](https://stackoverflow.com/questions/2348863/how-to-run-a-stored-procedure-in-sql-server-every-hour)的东西。但是 SQL Server Azure 似乎没有这种能力。

我的想法是改为每 x 分钟运行一次此过程的服务。我只是想知道是否有人看到任何问题，或者有更好的建议？

存储过程获取存储在一个表中的一些 xml 数据，并在其他表中对其进行规范化，使其更易于查询。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T21:15:21.823

您可以使用新的调度程序来调度作业：

[http://weblogs.asp.net/scottgu/archive/2012/12/21/great-updates-to-windows-azure-mobile-services-web-sites-sql-data-sync-acs-media-more。 aspx](http://weblogs.asp.net/scottgu/archive/2012/12/21/great-updates-to-windows-azure-mobile-services-web-sites-sql-data-sync-acs-media-more.aspx)

更多详情： http: [//www.windowsazure.com/en-us/develop/mobile/tutorials/schedule-backend-tasks/](http://www.windowsazure.com/en-us/develop/mobile/tutorials/schedule-backend-tasks/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-07T04:46:10.713

如果您愿意使用服务，[Cotega](http://www.cotega.com)提供了从 SQL Azure 中安排存储过程执行的能力。您可以在此处阅读有关[如何安排这些作业的](http://cotega.com/docs/sql_azure_scheduled_job)更多信息。

完全披露，我从事这项服务。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-14T20:56:07.667

您可以使用例如 Quartz 直接从您的应用程序触发计划任务运行过程。

# css - CSS 转换不适用于内联元素

> ID：14883250
> 
> 赞同：73
> 
> 时间：2013-02-14T20:14:59.270
> 
> 标签：css, css-transforms

我想`E`在单词中镜像字母，`WEBLOG`所以我使用了 CSS 转换属性，但如果我将文本包装在一个跨度内它不起作用，但如果我 assing`display: inline-block;`或`display: block;`

**所以转换不适用于内联元素？**

[**示例 1**](http://jsfiddle.net/4hwMm/)（转换失败）

```
<h1>W<span>E</span>BLOG</h1>

h1 span {
    transform:rotate(7deg);
    -ms-transform:rotate(7deg); /* IE 9 */
    -moz-transform:rotate(7deg); /* Firefox */
    -webkit-transform:rotate(7deg); /* Safari and Chrome */
    -o-transform:rotate(7deg); /* Opera */
} 
```

[**示例 2**](http://jsfiddle.net/4hwMm/1/)（有效，如果使用`display: block`OR`display: inline-block`）

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2013-02-14T20:17:15.513

[**在可变形元素**](https://drafts.csswg.org/css-transforms-1/#terminology)下[的官方 W3 规范](https://drafts.csswg.org/css-transforms-1/)中在这里回答：[](https://drafts.csswg.org/css-transforms-1/#terminology)

 **> 一个元素，其布局由 CSS 框模型控制，它是**块级**或**原子内联级元素**，或者其 'display' 属性计算为 'table-row'、'table-row-group'、'table- header-group'、'table-footer-group'、'table-cell' 或 'table-caption' [CSS21]

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2019-01-17T00:20:36.523

[规范](https://drafts.csswg.org/css-transforms/#transform-property)的更新版本说：

> 可变形元素是属于以下类别之一的元素：
> 
> *   **除了不可替换的内联框**、表格列框和表格列组框 [CSS2]之外，其布局由 CSS 框模型控制的所有元素，
>     
>     
> *   所有 SVG 绘制服务器元素、clipPath 元素和 SVG 可渲染元素，文本内容元素 [SVG2] 的任何后代元素除外。

我们应该注意，并非所有`inline`元素都不能转换，只有*未替换*的内联元素才能转换，因此被*替换的内联*元素可以转换。

所以基本上我们可以将转换应用于`img`,`canvas`等而不需要制作它们`inline-block`或`block`

```
var all = document.querySelectorAll('.replaced');

for(var i=0;i<all.length;i++) {
 console.log(window.getComputedStyle(all[i],null).getPropertyValue("display"));
}
```

```
canvas {
  background:red;
}

.replaced {
  transform:rotate(20deg);
}
```

```
<img src="https://picsum.photos/200/200?image=1069" class="replaced">
<canvas class="replaced"></canvas>
```

有关替换元素的更多详细信息：

[https://html.spec.whatwg.org/multipage/rendering.html#replaced-elements](https://html.spec.whatwg.org/multipage/rendering.html#replaced-elements)

[https://developer.mozilla.org/en-US/docs/Web/CSS/Replaced_element](https://developer.mozilla.org/en-US/docs/Web/CSS/Replaced_element)

[什么是不可替换的内联元素？](https://stackoverflow.com/q/12468176/8620333)**

# amazon-ec2 - Puppet 代理守护程序未读取事实事实（EC2，cloud-init）

> ID：14883253
> 
> 赞同：0
> 
> 时间：2013-02-14T20:15:06.930
> 
> 标签：amazon-ec2, environment-variables, puppet, cloud-init, facter

我正在使用 puppet 从 facter 中读取事实，并基于此将不同的配置应用于我的模块。

### 问题：

傀儡特工没有看到这个事实。以交互方式运行`puppet agent --test`按预期工作。即使从脚本以非交互方式运行它似乎也可以正常工作。只有代理本身在搞砸。

### 过程：

我正在 EC2 上部署一个基于 Ubuntu 的应用程序堆栈。使用 userdata (#cloud-config)，我在 /etc/environment 中设置了一个环境变量：

```
export FACTER_tl_role=development 
```

然后立即在#cloud-config 中，我获取/etc/environment。只有那么我 apt-get install puppet （我不再使用 package: puppet 来消除#cloud-config 步骤序列中的歧义）

实例启动后，我确认事实可用：运行`facter tl_role`返回“开发”。然后我检查 /var/log/syslog，显然 puppet 代理没有看到这个事实 - 我知道这一点是因为它无法编译目录，并且没有任何（空白）我应该看到的值变量集取决于这个事实。

但是，`puppet agent --test`交互式运行可以很好地编译和运行目录。即使从#cloud-config 脚本（安装puppet 后立即）运行它也可以正常工作。

我如何让 puppet 代理了解这个事实？重新启动代理服务没有任何区别，它仍然不知道自定义事实。重新启动实例也没有任何区别。

这是一些代码：

EC2 用户数据：

```
#cloud-config

puppet:
  conf:
    agent:
      server: "puppet.foo.bar"
      certname: "%i.%f"
      report: "true"

runcmd:
- sleep 20
- echo 'export FACTER_tl_role=development' >> /etc/environment
- . /etc/environment
- apt-get install puppet
- puppet agent --test 
```

主要木偶清单：

```
# /etc/puppet/manifests/site.pp
node default {
case $tl_role {
    'development':  { $sitedomain = "dev.foo.bar"}
    'production':   { $sitedomain = "new.foo.bar"}
}
class {"code" : sitedomain => $sitedomain}
class {"apache::site" : sitedomain => $sitedomain}
class {"nodejs::grunt-daemon" : sitedomain => $sitedomain} 
```

然后我看到 $sitedomain 应该是失败的地方，所以 $tl_role 似乎没有设置。

有任何想法吗？这让我脑洞大开……

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-10-09T16:23:04.307

另一个简单的选择是将事实放入外部事实中。

将文件放入 /etc/facter/facts.d/* 相当容易，您可以使用文本文件、yaml json 或可执行文件来完成。

[http://docs.puppetlabs.com/guides/custom_facts.html#external-facts](http://docs.puppetlabs.com/guides/custom_facts.html#external-facts)

*这是在开源木偶上，在 unix-y 机器上。查看完整文档的链接。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-20T14:39:20.710

谢谢你，@克里斯托弗。这可能是一个很好的解决方案，我会对其进行测试，并可能从我目前可怕的 hack 中转移到它。我在 Puppet Users Google Group 中得到的答案是，我**不应该**假设 Puppet 代理进程将具有登录 shell 的环境，并且当 Puppet 代理运行时，Facter 也将具有此环境。

这是我解决它的方法（诚然，通过蛮力）：

```
runcmd:
- echo 'export FACTER_tl_role=development' >> /etc/environment
- . /etc/environment
- apt-get install puppet
- service puppet stop
- sed -i '/init-functions/a\. \/etc\/environment' /etc/init.d/puppet
- puppet agent --test
- service puppet start 
```

如您所见，安装 Puppet 后，我​​停止代理，并在 /etc/init.d/puppet 中添加一行到源 /etc/environment。然后我启动代理。不理想......但它的工作原理！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-26T23:02:36.370

我认为不会`. /etc/environment`像 cloud-init 那样正常工作`runcmd`。两种可能的解决方案：

*   使用 puppet agent 命令导出变量：

    `export FACTER_tl_role=development && puppet agent --test`

如果这不起作用：

*   只需将命令放入用户数据脚本并将它们连接在一起作为“多部分输入”（在[cloud-init 文档](https://help.ubuntu.com/community/CloudInit)中描述）。

第二种解决方案将命令作为适当的 shell 脚本执行，并且可能会解决问题。但是，如果第一个有效，那么使用您所拥有的就更容易了。

# c# - 如何在 WPF 应用程序中使用 MVVM 在 ViewModel 类和 ICommand 类之间共享数据？

> ID：14883255
> 
> 赞同：0
> 
> 时间：2013-02-14T20:15:14.483
> 
> 标签：c#, wpf, mvvm

我正在编写一个 WPF 应用程序并尝试自学 MVVM 模式。我正在使用 Samuel Jack 网站上的说明：http: [//blog.functionalfun.net/2008/09/hooking-up-commands-to-events-in-wpf.html](http://blog.functionalfun.net/2008/09/hooking-up-commands-to-events-in-wpf.html)

我已将命令绑定到按钮并将所有内容连接起来。命令类是 ViewModel 类的内部类，它实现了 ICommand。复杂的部分是当从我的按钮运行的命令需要访问我的视图上的数据时。由于 C# 内部类无法访问外部类的成员，因此我发现自己必须在 ViewModel 类中声明公共静态变量才能将数据传递给内部类。这似乎是一个 hackish 和不雅的解决方案。有没有人有更好的方法来做到这一点？

我的视图模型代码：

```
public class ApplicationViewModel
{
    public ObservableCollection<App> AppCollection { get; set; }
    static string searchString;
    static string emailString;
    public App SelectedApp { get; set; }
    public string AppToSearch
    {
        get
        {
            return searchString;
        }
        set
        {
            searchString = value;
        }
    }
    public string AppToRequest
    {
        get
        {
            get emailString;
        }
        set
        {
            // set static email String here
        }
    }
    private SearchButtonCommand searchButtonCmd;
    private ClearButtonCommand clearButtonCmd;
    private EmailButtonCommand emailButtonCmd;

    public ApplicationViewModel()
    {
        this.AppCollection = ApplicationsModel.Current;
    }

    public ICommand SearchButtonPressed
    {
        get
        {
            if (this.searchButtonCmd == null)
            {
                this.searchButtonCmd = new SearchButtonCommand();
            }
            return this.searchButtonCmd;
        }
    }

    public ICommand ClearButtonPressed
    {
        get
        {
            if (this.clearButtonCmd == null)
            {
                this.clearButtonCmd = new ClearButtonCommand();
            }
            return this.clearButtonCmd;
        }
    }

    public ICommand EmailButtonPressed
    {
        get
        {
            if (this.emailButtonCmd == null)
            {
                this.emailButtonCmd = new EmailButtonCommand();
            }
            return this.emailButtonCmd;
        }
    }

    private class SearchButtonCommand : ICommand
    {
        public event EventHandler CanExecuteChanged;

        public void Execute(object parameter)
        {
            string searchkey = ApplicationViewModel.searchString;
            ApplicationsModel.Current.Search(searchkey);
        }

        public bool CanExecute(object parameter)
        {
            return true;
        }
    }

    private class ClearButtonCommand : ICommand
    {
        public event EventHandler CanExecuteChanged;

        public void Execute(object parameter)
        {
            ApplicationsModel.Current.ClearSearch();
        }

        public bool CanExecute(object parameter)
        {
            return true;
        }
    }

    private class EmailButtonCommand : ICommand
    {
        public event EventHandler CanExecuteChanged;

        public void Execute(object parameter)
        {
            string targetEmail = ApplicationViewModel.emailString;
        }

        public bool CanExecute(object parameter)
        {
            return true;
        }
    }
} 
```

我的 XAML：

```
<Window.DataContext>
    <vm:ApplicationViewModel />
</Window.DataContext>

<Grid>
    <Grid.RowDefinitions>
        <RowDefinition Height="Auto" />
        <RowDefinition Height="Auto" />
        <RowDefinition Height="*" />
        <RowDefinition Height="Auto" />
    </Grid.RowDefinitions>
    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="*" />
    </Grid.ColumnDefinitions>
    <Image Grid.Row="0" Height="84" HorizontalAlignment="Left" Margin="0,5,5,5" Name="imgLogo" Stretch="Fill" VerticalAlignment="Top" Width="600" Source="C:\Images\bannerlong.png" />
    <Grid Grid.Row="1" HorizontalAlignment="Center" Margin="0,5,5,5" VerticalAlignment="Center">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="Auto" />
        </Grid.ColumnDefinitions>
        <Label Grid.Row="0" Grid.Column="0" Content="Search for Application">
            <Label.Foreground>
                <SolidColorBrush Color="LightCyan" />
            </Label.Foreground>
        </Label>
        <TextBox Grid.Row="0" Grid.Column="1" Margin="3" Width="500" Text="{Binding AppToSearch}" />
        <Button Grid.Row="0" Grid.Column="2" HorizontalAlignment="Right" Width="100" Height="20" Margin="3" Background="LightCyan" Content="Search" vm:ButtonBehaviour.SearchCommand="{Binding SearchButtonPressed}" />
        <Button Grid.Row="0" Grid.Column="3" HorizontalAlignment="Right" Width="100" Height="20" Margin="3" Background="LightCyan" Content="Clear Search" vm:ButtonBehaviour.ClearCommand="{Binding ClearButtonPressed}"/>
    </Grid>
    <ListView Grid.Row="2" BorderBrush="Black" HorizontalAlignment="Stretch" ItemsSource="{Binding Path=AppCollection}" SelectedItem="{Binding SelectedApp}">
        <ListView.View>
            <GridView>
                <GridViewColumn Header="Application Name" Width="100" DisplayMemberBinding="{Binding Name}"/>
                <GridViewColumn Header="Application Description" Width="800" DisplayMemberBinding="{Binding Description}"/>
                <GridViewColumn Header="Application Owner" Width="100" DisplayMemberBinding="{Binding Owner}"/>
            </GridView>
        </ListView.View>
    </ListView>
    <Button Grid.Row="3" HorizontalAlignment="Center" Width="200" Height="30" Margin="3" Background="LightCyan" Content="Request Application" vm:ButtonBehaviour.EmailCommand="{Binding EmailButtonPressed}" />
</Grid> 
```

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:18:37.930

你可以在你的视图模型中有一个委托或事件，你的命令类用来获取数据

.. 或者您可以通过命令参数将数据从视图传递到命令。

```
Button Command="{Binding SaveCommand}" 
        CommandParameter="{Binding SelectedItem, Element=listBox}" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T20:33:26.143

您可以定义一个`RelayCommand`允许您调用委托的类。使用这种方法，您不需要为每个命令声明一个类。

```
public class RelayCommand : ICommand
{
    #region Miembros

    readonly Action<object> _execute;
    readonly Predicate<object> _canExecute;

    #endregion

    #region Constructor

    public RelayCommand(Action<object> execute)
        : this(execute, null)
    {
    }

    public RelayCommand(Action<object> execute, Predicate<object> canExecute)
    {
        if (execute == null)
        {
            throw new ArgumentNullException("execute");
        }

        _execute = execute;
        _canExecute = canExecute;
    }

    #endregion

    #region Miembros de ICommand

    public bool CanExecute(object parameter)
    {
        return _canExecute == null || _canExecute(parameter);
    }

    public event EventHandler CanExecuteChanged
    {
        add { CommandManager.RequerySuggested += value; }
        remove { CommandManager.RequerySuggested -= value; }
    }

    public void Execute(object parameter)
    {
        _execute(parameter);
    }

    #endregion
} 
```

然后您的 ViewModel 类将类似于：

```
public class ApplicationViewModel
{
    public ObservableCollection<App> AppCollection { get; set; }
    private string searchString;
    private string emailString;
    public App SelectedApp { get; set; }
    public string AppToSearch
    {
        get
        {
            return searchString;
        }
        set
        {
            searchString = value;
        }
    }
    public string AppToRequest
    {
        get
        {
            return emailString;
        }
        set { emailString = value; }
    }

    private ICommand searchButtonCmd;
    private ICommand clearButtonCmd;
    private ICommand emailButtonCmd;

    public ApplicationViewModel()
    {
        this.AppCollection = ApplicationsModel.Current;
    }

    public ICommand SearchButtonPressed
    {
        get
        {
            if (this.searchButtonCmd == null)
            {
                this.searchButtonCmd = new RelayCommand(SearchButtonPressedExecute, c=>CanSearch);
            }
            return this.searchButtonCmd;
        }
    }

    private void SearchButtonPressedExecute(object parameter)
    {
        ApplicationsModel.Current.Search(searchString);
    }

    public bool CanSearch
    {
        get { return true; }
    }

    // TODO: You can figure out the rest of the code
} 
```

不要忘记更新 Button 的 XAML，例如：

```
<Button Grid.Row="0" Grid.Column="2" HorizontalAlignment="Right" Width="100" Height="20" Margin="3" Background="LightCyan" Content="Search" Command="{Binding SearchButtonPressed}" /> 
```

其他按钮也是如此。

希望这可以帮助！

# javascript - 如何使用 X 秒后“到达”的 json 数据？

> ID：14883267
> 
> 赞同：-1
> 
> 时间：2013-02-14T20:16:10.240
> 
> 标签：javascript, jquery

我正在用 json 填写一个列表。然而，那个 json（php 文件）在 X 秒后（未知时间）给了我结果。

外部文件 - 获取 json 数据：

```
$(function(){
                // can't modify this file
                $.getJSON('json.php',
                    function(data) {            
                    items = [];
                    $.each(data, function(key, val) {
                            items.push('<li id="' + key + '">' + val + '</li>');
                    });
                });
    }); 
```

内联代码 - 输出：

```
<script>   
 $(function(){
                $('<ul/>', {
                        'class': 'my-new-list',
                        html: items.join('')
                }).appendTo('#result');
        });
</script> 
```

现在我什么也没看到，`#result`因为两个代码同时加载，所以输出找不到“项目”。

我如何修改**内联代码**以强制它等到外部文件给我 json 数据？也许是观察者？

编辑：看来我解释得不够好。我为我糟糕的英语感到抱歉。我也是一个 Js/Jquery 新手。

编辑 2：如果我们没有延迟获取 json 数据一切正常，但是它取决于通过串行通信连接的一些外部设备，有时需要 2,3 或 5 秒才能获取 json。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T20:20:44.550

看起来您唯一的选择是使用 setInterval 定期检查数据是否可用。理想的方法是需要修改文件 1。

```
function handleData(items) {
    // dostuff with items
}

var itemsInterval = setInterval(function(){
    if (items && items.length) {
        handleData(items);
        clearInterval(itemsInterval);
    }
},250); 
```

# javascript - 使用 JavaScript 从本地 HTML5 Web 应用程序加载 JSON

> ID：14883277
> 
> 赞同：4
> 
> 时间：2013-02-14T20:16:37.853
> 
> 标签：javascript, json, web-applications, local, offline

我正在开发一个小型 HTML5 网络应用程序，用户可以通过浏览器离线使用，跨平台。他们将收到 CD 或 USB 棒上的 wep 应用程序，然后双击 HTML 文件。HTML 文件然后从同一目录/子目录本地加载 CSS、JavaScript 文件等。

到目前为止，一切都很好。但我还想加载一个包含 JSON 的文件（也是本地的，来自同一个目录），并使用该数据构建 DOM 的一部分。

```
 $.getJSON("playlistcontent.json", function (json) {
        //use the data...
    }); 
```

在这里我遇到了著名的

> Access-Control-Allow-Origin 不允许 Origin null

错误。有很多关于这个的资源，甚至是非常[相似的问题](https://stackoverflow.com/questions/13143054/xmlhttprequest-origin-null-is-not-allowed-by-access-control-allow-origin)。但由于这是故意在本地进行的，因此建议的解决方案不起作用。

但是，由于 AJAX 是“异步”的，我认为可能有更“同步”或更好的方法？JSONP 呢？

*注意：我知道我可以在禁用安全检查的情况下启动浏览器（尤其是 Chrome），但这不是我的用户的选项。*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T20:24:37.937

[我在这里](https://stackoverflow.com/a/14740594/2009041)回答了一个类似的问题。

您可以使用 HTML5 的**File API**，其中包含 a `FileReader`，然后调用`JSON.parse`结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T20:23:57.353

我喜欢 Felix Kling 的方法，如果您只需要 JSON 数据，您可以通过设置 JS 变量来加载数据并使用脚本标签加载 JSON 文件。但是，如果这还不足以满足您的需求，您可以使用[http://www.server2go-web.de/](http://www.server2go-web.de/)之类的解决方案，该解决方案将从 CD 运行网络服务器，从而绕过本地文件限制。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-14T20:39:33.680

我会使用 Felix Kling 的 JSONP 方法。将数据文件包装在回调函数中：

```
(function(data) {
  // Do things with your data object here
})(
  // Put your data object here as the argument to the callback
); 
```

当您将此脚本文件包含在标签中时，将自动执行回调函数。

# windows-runtime - 在 WinRT 中克隆 Xaml FramworkElement

> ID：14883278
> 
> 赞同：1
> 
> 时间：2013-02-14T20:16:37.380
> 
> 标签：windows-runtime, clone, frameworkelement, xamlwriter

我需要`FrameworkELement`在 WinRT 中的 CodeBehind 中克隆一个 ...

我确实在互联网上找到了一个解决方案，尽管这种解决方法在 WinRT 中不起作用，因为它`XamlWriter`在 winRT 中不可用！[是否有一种简单/内置的方法来获取 XAML 元素的精确副本（克隆）？](https://stackoverflow.com/questions/1968625/is-there-an-easy-built-in-way-to-get-an-exact-copy-clone-of-a-xaml-element)

还有其他方法可以获取 my 的另一个实例`FrameworkElement`吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T20:38:04.430

我不认为有一种简单的方法可以准确地克隆一个元素 - 例如，我不知道是否有一种方法可以找出设置在一个元素上的任意附加属性，或者找出属性是否由样式、动画、模板、显式值等

如果您有一个要克隆的特定元素树，则有一种方法可能是您的方案的解决方案 - 只需将其放入`DataTemplate`XAML 中，然后在代码后面通过名称或资源键检索该模板并调用`LoadContent()`以生成实例从模板。

如果您的 XAML 中已有原始文件，您不想再放入资源并从后面的代码生成或布局 - 只需将其包装在`ContentControl`/ `ContentTemplate`/`DataTemplate`中。

# javascript - extjs 4：列表视图选择图像ID并在其他面板上显示图像

> ID：14883279
> 
> 赞同：0
> 
> 时间：2013-02-14T20:16:44.447
> 
> 标签：javascript, extjs, extjs4

```
Ext.require([
    'Ext.grid.*',
    'Ext.data.*',
    'Ext.panel.*'
]);
Ext.onReady(function(){
    Ext.define('ImageModel', {
        extend: 'Ext.data.Model',
        fields: ['name', 'url', {name:'size', type: 'float'}, {name:'lastmod', type:'date', dateFormat:'timestamp'}]
    });
    var store = Ext.create('Ext.data.JsonStore', {
        model: 'ImageModel',
        proxy: {
            type: 'ajax',
            url: 'get-images.php',
            reader: {
                type: 'json',
                root: 'images'
            }
        }
    });
    store.load();

    var listView = Ext.create('Ext.grid.Panel', {
        width:425,
        height:250,
        collapsible:true,
        title:'Simple ListView <i>(0 items selected)</i>',
        renderTo: Ext.getBody(),

        store: store,
        multiSelect: true,
        viewConfig: {
            emptyText: 'No images to display'
        },

        columns: [{
            text: 'File',
            flex: 50,
            dataIndex: 'name'
        },{
            text: 'Last Modified',
            xtype: 'datecolumn',
            format: 'm-d h:i a',
            flex: 35,
            dataIndex: 'lastmod'
        },{
            text: 'Size',
            dataIndex: 'size',
            tpl: '{size:fileSize}',
            align: 'right',
            flex: 15,
            cls: 'listview-filesize'
        }]
    });

    // little bit of feedback
    listView.on('selectionchange', function(view, nodes){
        var l = nodes.length;
        var s = l != 1 ? 's' : '';
        listView.setTitle('Simple ListView <i>('+l+' item'+s+' selected)</i>');
    });
}); 
```

我创建了 2 个面板，一个是左面板，第二个是右面板。
列表视图在左侧面板中创建，右侧面板将读取页面 showimage.php
列表视图显示文件详细信息，当用户选择列表视图时，会将文件名作为参数“ `name`”传递给 showimage.php，并且右侧面板将按名称显示从列表视图选择事件传递的图像。（实际上名称字段存储文件的 ID）

## 问题

1)how to create the select list view event,when select a list view passing parameter name to showimage.php,and right panel refresh the page and display the image.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T08:26:00.807

```
//===========================LIST VIEW===============================
    Ext.define('ImageModel', {
        extend: 'Ext.data.Model',
        fields: ['PicID', 'PicUploadedDateTime','PicData']
    });

    var ImgStore = Ext.create('Ext.data.JsonStore', {
        model: 'ImageModel',
        autoLoad: true,
        proxy: {
            type: 'ajax',
            url: 'get-image.php',
            baseParams: {  //here you can define params you want to be sent on each request from this store
                        mainid: 'value1',
                        startdate: 'value2',
                        enddate: 'value3'
                        },
            reader: {
                type: 'json',
                root: 'images'
            }
        }
    });

    var listView = Ext.create('Ext.grid.Panel', {
        region: 'west',
        id : 'imagelist',
        title: 'Select Image',
        width: 200,
        split: true,
        collapsible: true,
        floatable: false,
        title:'Select Image',
        store: ImgStore,
        multiSelect: false,
        viewConfig: {
            emptyText: 'No images to display'
        },

        columns: [
            {
            text: 'Date Time Uploaded',
            //xtype: 'datecolumn',
            //format: 'Y-m-d H:i:s',
            flex: 65,
            width: 100,
            dataIndex: 'PicUploadedDateTime'
        }]
    });

    function hexToBase64(str) {
    return btoa(String.fromCharCode.apply(null, str.replace(/\r|\n/g, "").replace(/([\da-fA-F]{2}) ?/g, "0x$1 ").replace(/ +$/, "").split(" ")));
    }

    listView.on('selectionchange', function(view, nodes){
        /*
        var nodeIdDisplay = "";
        for(var i = 0; i < nodes.length; i++)
        {
            if(nodeIdDisplay.length > 0)
                nodeIdDisplay += ",";
            nodeIdDisplay += nodes[i].get("PicID");
        }
        */
        if (nodes[0].get("PicID") > 0){
            //alert(nodes[0].get("PicData"));
            image=Ext.getCmp('displayimage');
            image.setSrc("data:image/jpeg;base64,"+hexToBase64(nodes[0].get("PicData")));
        //console.log(nodes[0].get("PicData"));
        }
    }); 
```

此代码方法发布到 get-image.php，并获取存储中的所有图像，然后，选择更改事件的列表视图获取图像 id 并在`type : 'image'`组件上显示图像

# php - 提交表单后从控制器发送数据以查看的最佳方式？

> ID：14883280
> 
> 赞同：0
> 
> 时间：2013-02-14T20:16:51.640
> 
> 标签：php, model-view-controller

我正在使用 MVC 架构开发一个基本的 Web 应用程序。我正在构建自己的尝试并完全理解 MVC 架构的工作原理，因此这可以兼作学习练习。

我正在使用 Aura Router 类将我的 URL 映射到控制器和操作，以便将 mysite.com/login 之类的内容映射到 LoginController，如果我向 mysite.com/login/login 提交表单，它将映射到 LoginController- >doAction('登录')。

控制器示例如下所示：

```
class LoginController implements iController {

    public function doAction( PDO $dbh, $action ) {

        switch( $action ) {
            case 'login':
                //login here
                $user = new User();
                $user_id = FALSE;

                if( $user_id = $user->login( $_POST['email'], $_POST['password'] ) ) {
                    //save user id to session
                }
                else {
                    $results = array( 'errors' => array( 'invalid' ) );
                    MembershipFunc::redirect( '/login', $results );
                }

                break;
            case 'logout':
                //logout
                break;
            default:
                break;
        }

    }
} 
```

我面临的问题是，如果登录失败，为了避免人们刷新页面并重新提交数据，我希望将用户转发回登录页面。目前，如果我不转发它们，它们就会出现在 mysite.com/login/login 页面上，我认为它不是特别干净。我的简单登录表单没问题，因为错误可能会重定向到 mysite.com/login?error=email,password&email=user@domain.com 但如果表单很大，那么我会得到一个巨大的 URL 查询，这真的很恶心.

我已经用基本的（但有用的）PHP 代码示例搜索了关于 MVC 如何工作的良好资源，并且我一直在努力寻找任何特别有用的东西。我应该避免将我的 URL 结构映射到操作，而是选择放置一个名为“操作”的 POST 字段吗？我应该以某种方式构建一个系统，通过 SESSION 数据中的数组传递这些数据吗？

有什么建议吗？

*注意：我只想说明我知道这个问题不适合 SO 文化，因为它可能没有正确/错误的答案，但我发现 SO 总是拥有最好/最博学的用户群。如果有人对我应该在哪里提出这些问题有提示，我将非常感激，所以我不会添加混乱！*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:38:53.400

在我的 MVC URL 中看起来像： index.php?c=Controller&m=ControllerMethod&d=slash/sepparated/list/of/stuff

数据 (d=) 在斜杠上展开并作为数组传递给每个控制器方法。自动加载（通过 spl_autoload_register()）用于调用类 (c=)，然后调用该类中的方法 (m=)。

此外，听起来您要么没有在表单上设置 ACTION，要么故意将 ACTION 设置为 GET。作为一般规则，ACTION 应该是 POST 以保持 URL 正常。搜索表单除外。那些可以是具有各种优势的 GET。

重定向以防止刷新时重新提交表单是您的最佳选择（可能是唯一的选择）。但在我的 MVC 中 index.php?c=user&m=login 处理登录页面和登录操作。

**例子**

```
class login extends Controller {

    public function login($data) {

        if(empty($_POST)) {

            $this->view = "login.tpl";

            return TRUE;

        }

        $res = $this->model->auth();

        if($res !== TRUE) {

            $_POST = NULL;

            $this->errorState = 1;
            $this->errorMsg = "Invalid login details";

            $this->login();

            return FALSE;

        }

        Core::setMessage('success', 'user', 'login', '2', 'Logged in successfully');

        $home = new home(); //whatever the main controller is
        $home->index($data);

        //alternatively you can redirect

        header("Location: index.php?c=home&m=index);

        return TRUE;

    }

} 
```

这有意义还是我完全错过了标记？

# ruby - 如何使用带有参数的 lambda 来收集数组？

> ID：14883291
> 
> 赞同：1
> 
> 时间：2013-02-14T20:17:31.237
> 
> 标签：ruby, lambda, mapping, block, proc

我很好奇如何重构这段代码：

```
array.collect{|x| x.some_method}.inject(:+) || 0 
```

我用不同的方法在我的代码中使用了大约十次，所以我认为我应该重构，但是如何重构呢？

我尝试了至少十种块、procs 和 lambdas，此时我什至不确定它是否可以重构。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T20:20:02.983

重构如何/做什么？目标是什么？你想/需要超越：

```
array.collect(&:some_method).inject(:+) || 0 
```

如果唯一改变的是被调用的方法，则将方法符号传递给方法并在收集期间将其发送给每个对象。

你想与有问题的代码沟通什么？看起来像是某种总结；也许是一个`sum`以“属性”名称作为参数的简单方法？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T21:23:44.027

第一次重构：

```
array.collect(&:some_method).inject(0, :+) 
```

第二次重构，摘要：

```
module Enumerable
  def sum(method)
    block_given? ? inject(0) { |acc, x| acc + yield(x) } : inject(0, :+)
  end
end

array.map(&:some_method).sum
array.sum(&:some_method) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T20:21:09.410

Ruby 习惯用法是：

```
array.collect(&:some_method).inject(:+) 
```

in 使用 Symbol#to_proc 方法：[http ://www.ruby-doc.org/core-1.9.3/Symbol.html#method-i-to_proc](http://www.ruby-doc.org/core-1.9.3/Symbol.html#method-i-to_proc)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-14T20:23:02.080

您`array.collect(&:some_method).inject(:+)`用于初学者。您也可以`inject`像这样通过一个电话来做到这一点：

```
def my_method(ary, method_symbol)
  ary.inject (0) do |sum, elem|
    sum + elem.send( method_symbol )
  end
end 
```

# php - 如何通过unix套接字连接到本地主机上的mySQL

> ID：14883295
> 
> 赞同：0
> 
> 时间：2013-02-14T20:17:36.097
> 
> 标签：php, sql, pdo, localhost

我最近将我的托管服务器搬到了另一家公司。而我原来是用db.inc.php连接数据库的，配置如下：

```
<?php
define('DB_INFO', 'mysql:DATABASELOCATION;dbname=NAMEOFTHEDATABASE');
define('DB_USER', 'ADMIN');
define('DB_PASS', 'ADMIN');
?> 
```

但新的托管服务器是“Localhost via UNIX socket”..

我不确定这个连接是如何工作的。我可以使用相同的 php 文件进行连接吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T21:17:06.360

在文档中很容易找到：

```
mysql:dbname=testdb;unix_socket=/path/to/socket 
```

使用套接字时不能指定主机。

# c++ - 是否可以有一个非 const 键类型的 unordered_map？

> ID：14883299
> 
> 赞同：3
> 
> 时间：2013-02-14T20:17:40.777
> 
> 标签：c++, stl, c++11, unordered-map, stdmap

本质上，我想要一个容器，其中一个元素可以通过许多键访问。这可以通过定义一些多键类用作映射的键​​类型来完成，但由于这种解决方案不允许修改已插入元素的键，因此我无法为现有条目。

我很欣赏 with`std::map`键需要保持不变以进行排序，但为什么这个限制应该存在于`std::unordered_map`?

如果需要，我想我可以只使用指针映射，但有没有更好、更优雅的解决方案？

编辑：感谢您清理 Andrei，Xeo。Nicol，关于我应该使用什么容器有什么建议吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-14T20:38:48.617

好吧，`std::unordered_map`不允许您修改密钥的原因与其他关联容器不允许您修改它的原因几乎相同：它会破坏该数据结构的内部组织。

在 an`unordered_map`中，密钥用于获取散列，该散列告诉容器将元素放置在哪个桶中（当然还有从哪个桶中检索它）。如果您修改密钥，则修改哈希，这意味着您的元素应该移动到不同的存储桶。这就像删除它并再次插入它，基本上。

另一方面，关联容器的整个想法是，任何元素都由一个固定的值表示，因此可以根据该值快速计算其在容器中的位置。如果允许使用多个键，您将使用哪一个来快速确定元素的存储位置或将要存储的位置？

您想要的可能是具有与标准库不同的复杂性保证*的临时数据结构。*

但是，就我个人而言，在我看来，您只是在寻找*引用语义*，因为您打算共享一个对象的多个视图。这自然会导致我使用（智能）指针，尤其是当我听到世界“别名”时。我建议您使用`shared_ptr`s 作为值的地图。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T20:46:20.023

在关联容器（例如`map`，`unordered_map`）中， 的值`key`决定了元素在数据结构中的位置。在非多关联容器中，键也必须是唯一的。

如果`key`允许修改，那么这将危及上述设计不变量。

*   中`map`，元素在二叉搜索树中的位置

*   在`unordered_map`，将元素链接到哈希桶

如果我理解 OP 的要求，那么它可以通过在容器上编写一个包装器来实现`insert()`，例如以下 C++-ish 伪代码：

```
Iterator insert_wrapper( Container & cont, Element const & elem ) {

    if elem in cont {
       cont.erase( elem );
    }

    return cont.insert( elem );
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-14T20:45:24.497

你会发现参考地图比指针地图更有品味吗？

```
int value = 6;

std::unordered_map<int, int&> m;

for(int i=0; i<5; ++i)
    m.emplace(i, value);

value = 4;

for(auto const& i: m)
    std::cout<<i.second<<' '; 
```

当然，您必须将实际值存储在其他地方，如示例所示。

# wpf - 在数据模板 wpf 中使用来自不同项目的类时出错

> ID：14883303
> 
> 赞同：2
> 
> 时间：2013-02-14T20:17:49.360
> 
> 标签：wpf, xaml, mvvm, viewmodel, datatemplate

```
<TabControl ItemsSource="{Binding OpenTabs}" Grid.Row="1">
            <TabControl.Resources>
                <DataTemplate DataType="{x:Type viewModel:HomeViewModel}">
                    <views:HomeView />
                </DataTemplate>
                <DataTemplate DataType="{x:Type instructor:CourseManagerViewModel}">
                    <instructorViews:CourseManagerView />
                </DataTemplate>
            </TabControl.Resources>
        </TabControl> 
```

我在项目 A 中的 MainWindow.xaml 中有上面的代码，但是每当我运行它时，它都会出现错误“设置属性 'System.Windows.ResourceDictionary.DeferrableContent' 引发异常。我发现它在我删除时有效

```
<DataTemplate DataType="{x:Type instructors:CourseManagersViewModel}">
                    <instructorViews:CourseManagerView />
                </DataTemplate> 
```

CourseManagersViewModel 和 CourseManagerView 在项目 B 中定义，但在项目 A（主项目）中引用。如何正确引用与 DataTemplate 不同的项目中定义的 ViewModel/View

# c# - WPF Rectangle.Fill 方法响应性

> ID：14883306
> 
> 赞同：0
> 
> 时间：2013-02-14T20:18:11.673
> 
> 标签：c#, wpf, wpf-controls

c#/WPF 的快速性能问题。

我在网格中有一个矩形：

```
<Rectangle Name="NewPage" Grid.Row="1" Width="42" Height="59.4" Stroke="Black" MouseEnter="Rectangle_MouseEnter_1" MouseLeave="NewPage_MouseLeave_1" /> 
```

我使用以下方法对 MouseEnter 和 MouseLeave 执行填充：

```
private void Rectangle_MouseEnter_1(object sender, MouseEventArgs e)
{
   SolidColorBrush blueBrush = new SolidColorBrush();
   blueBrush.Color = Colors.Blue;
   NewPage.Fill = blueBrush;
}

private void NewPage_MouseLeave_1(object sender, MouseEventArgs e)
{
   SolidColorBrush whiteBrush = new SolidColorBrush();
   whiteBrush.Color = Colors.White;
   NewPage.Fill = whiteBrush;
} 
```

期望的目标是在鼠标移到矩形上方时突出显示矩形，并允许稍后单击以进行更多工作。

我遇到的问题是填充方法的响应性。我可以在填充之前将鼠标移过矩形。它也不会在启动应用程序后大约 15 秒内开始填充。

对此的任何提示/指导将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T20:33:04.210

问题将是由于`Rectangle`应用`Null`程序启动时引起的，这意味着您不会收到`MouseOver`事件，因为它是直行的，它只会在`Stroke`拾取时变为蓝色`MouseOver`，请先尝试`White`在 xaml 中将 Rectangle 设置为。

```
<Rectangle Fill="White" Name="NewPage" Grid.Row="1" Width="42" Height="59.4" Stroke="Black" MouseEnter="Rectangle_MouseEnter_1" MouseLeave="NewPage_MouseLeave_1" /> 
```

但更好的选择是`Trigger`在 Xaml 中为此使用 a 。这样，您的代码中就不需要任何事件处理程序，并且您将 UI 逻辑与实际代码库分开。

```
 <Rectangle Name="NewPage" Grid.Row="1" Width="42" Height="59.4" Stroke="Black" >
        <Rectangle.Style>
            <Style TargetType="{x:Type Rectangle}">
                <Setter Property="Fill" Value="White" />
                <Style.Triggers>
                    <Trigger Property="IsMouseOver" Value="True" >
                        <Setter Property="Fill" Value="Blue" />
                    </Trigger>
                </Style.Triggers>
            </Style>
        </Rectangle.Style>
    </Rectangle> 
```

# bash - 我可以让 PATH 变量评估我所在的目录吗？

> ID：14883310
> 
> 赞同：0
> 
> 时间：2013-02-14T20:18:25.343
> 
> 标签：bash, shell, path, command-line-interface

在`linux`使用`bash`时，
假设我制作了两个程序都称为`print_report`.
（它们位于不同的目录中。）

在我的`.bashrc`文件中，我有：

> PATH="路径/到/print_report1/:$PATH"

这使我可以`print_report`在任何地方键入，它将运行其中一个程序。

* * *

**如何让 bash 根据工作目录决定使用其中一个或另一个？**

例如，
如果我当前在`~/project1/`并键入`print_report`它将使用`/bin/foo/print_report`
如果我当前在`~/project2/`并键入`print_report`它将使用`/bin/bar/print_report`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T20:25:05.350

你不能那样做。相反，编写一个包装脚本或函数来检查当前目录并调用正确的命令：

```
#!/bin/bash
if [[ $PWD == $HOME/project1/* ]]
then
    /bin/foo/print_report "$@"
elif [[ $PWD == $HOME/project2/* ]] 
then
    /bin/bar/print_report "$@"
else
    echo "Don't know how to print_report for $PWD"
fi 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T20:25:13.133

这是一场等待发生的安全灾难，（也就是说你真的不想这样做），但你当然可以这样做：

```
cd() {
    dir=${1-.}
    case $dir in)
        path1) PATH=/path/for/working/in/path1;;
        path2) PATH=/path/for/working/in/path2;;
        *) PATH=/bin:/usr/bin;;
    esac
    command cd $dir
} 
```

（把它放在你的 .bashrc 中，或者只是在当前的 shell 中定义它。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-14T20:25:59.990

您可以使用 DEBUG 陷阱模拟[preexec hooks](https://superuser.com/questions/175799/does-bash-have-a-hook-that-is-run-before-executing-a-command) à la zsh。

这样，每次执行命令时，您都可以运行 preexec hook 来检查 $PWD，并相应地调整 $PATH。

你可以在你的 .bashrc 中包含一个 preexec 钩子来做你想做的事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-15T18:03:48.323

到目前为止，这里介绍的所有内容都让我觉得过于复杂和不必要的复杂骇客。我会`Makefile`在每个目录中放置一个

```
report:
        /bin/foo/print_report 
```

在`~/project1/Makefile`, 和

```
report:
        /bin/bar/print_report 
```

在`~/project2/Makefile`. 这很容易扩展到您想要的任意数量的目录和程序。而且您只需要键入`make`而不是那些冗长的命令名称:-)

# python - 如何让我的 epd python 作为我在 ubuntu 中的默认 python？

> ID：14883321
> 
> 赞同：1
> 
> 时间：2013-02-14T20:19:03.047
> 
> 标签：python, linux, ubuntu, python-2.7, enthought

我最近在 ubuntu 中安装了 epd python 发行版。这已安装在文件夹中`/home/jai/Downloads/epd_free-7.3-2-rh5-x86_64`

你能告诉我如何让这条蟒蛇成为我的默认蟒蛇吗？

运行测试程序时出现错误（似乎我的默认 python 不同，它没有 numpy 库，epd python 发行版附带的其他库。）

我的测试程序在这里： http: [//www.southampton.ac.uk/~fangohr/computing/download/python/tests/testall.py](http://www.southampton.ac.uk/~fangohr/computing/download/python/tests/testall.py)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:22:31.643

默认python 是在/usr/bin 目录中找到的名为python 的python。建立一个符号链接：

```
ln -s /home/jai/Downloads/epd_free-7.3-2-rh5-x86_64 /usr/bin/python 
```

假设这是 python 可执行文件的名称，而不是安装程序的名称。安装后，使用安装它的路径。铁`/home/iai/myNewPythonInstallation`

可能会成功。

很可能默认的 2.7 python 占用了该名称，因此您需要删除它，或使用其他名称，如 epdPython。然后运行 ​​python 脚本会发生：

```
epdPython myscript.py 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T20:49:25.833

“默认”python 取决于您如何调用它。

在 Ubuntu 上，python 通常安装为`/usr/bin/python`(not `/bin/python`) -- 这可能是一个符号链接。

如果您调用该`python`命令，例如：

```
$ python myscript.py 
```

它将使用`python`您的`$PATH`. 您可以修改您的`$PATH`, 或者为您当前的外壳：

```
export PATH="/some/dir:$PATH" 
```

或通过更新您的 , 或其他任何内容来用于所有未来的`$HOME/.bashrc`shell `$HOME/.bash_profile`。 `/usr/local/bin`是放置系统特定可执行文件或`$HOME/bin`用户特定可执行文件的常见位置。

如果要执行脚本本身，则需要一个[shebang](http://en.wikipedia.org/wiki/Shebang_(Unix))作为脚本的第一行：

```
$ head -1 myscript.py
#!/usr/bin/python
$ ./myscript.py
... 
```

您可以编辑 shebang 以引用您想要使用的任何 Python 可执行文件。

你*可以*用你喜欢的 Python 可执行文件替换`/usr/bin/python`，但这可能会导致不必要的副作用；假定`/usr/bin/python`为默认值的现有 Python 脚本可能会中断。

另一种选择是将shebang更改为：

```
 #!/usr/bin/env python 
```

`python`这使您可以直接执行脚本，同时仍然使用`$PATH`. 这可能是一个好主意，也可能不是一个好主意；请参阅[我对](https://unix.stackexchange.com/a/29620/10454)[这个问题](https://unix.stackexchange.com/q/29608/10454)的回答以进行进一步讨论。

# regex - 正则表达式匹配域

> ID：14883322
> 
> 赞同：2
> 
> 时间：2013-02-14T20:19:14.880
> 
> 标签：regex, pcre

我需要一个正则表达式来匹配以下域，如下所示：

```
http://www.cnn.com/fred      = www.cnn.com
cnn.com                      = cnn.com
www.cnn.com:8080             = www.cnn.com 
```

我有以下正则表达式（使用 pcre）：

```
([^/]+://)?([^:/]+) 
```

以上在案例 2 和 3 中工作正常，但是对于 1，我仍然将 http:// 附加到匹配的字符串中，是否有一个正则表达式选项可以用来跳过 http 部分？

提前谢谢了

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:27:56.893

这应该适合您的需求：

```
^(?:(?:f|ht)tps?://)?([^/:]+) 
```

第一组将包含您要查找的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T21:48:09.770

这看起来最接近我想要的不完美但似乎完成了工作

```
www?([^/:]+) 
```

# html - onclick() 返回 false 时如何刷新页面？

> ID：14883323
> 
> 赞同：1
> 
> 时间：2013-02-14T20:19:21.743
> 
> 标签：html, onclick

我在表单中有一个提交按钮，我为按钮设置了一个 onclick() 函数，如下所示，

```
 <input type=\"hidden\" name=\"Action\" value=\"chgRole\">\n";
    <input type=\"submit\" class=\"submit\" value=\"Change Role\" onclick=\"return chgConfirm()\">"; 
```

下面是我的 chgConfirm() 的样子：

```
function chgConfirm(){
        var makechg = false;
        var s= "....";
             (some other operation)

        if (!makechg){
              alert(s);
              return false;
             }
        else {
              var r = confirm(s);
              if (r)
                     return true;
              else
                     return false;
             }
       } 
```

我想要做的是，一旦 chgConfirm() 返回 false，我想刷新原始页面。我尝试改变：

```
if(r)
     return true;
else
     window.location(this page); 
```

但它不起作用。

有什么好的建议吗？谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:21:06.997

尝试使用`reload`：

```
window.location.reload(); 
```

[https://developer.mozilla.org/en-US/docs/DOM/window.location](https://developer.mozilla.org/en-US/docs/DOM/window.location)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T20:22:24.963

代替 window.location，使用：

```
 document.location.reload(true); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-14T20:23:50.010

试试这个...

```
 else {
              var r = confirm(s);
              if (r)
                     return true;
              else
                     document.location.reload(true);
             } 
```

# php - 查找符号并将其转换为锚点

> ID：14883330
> 
> 赞同：1
> 
> 时间：2013-02-14T20:19:48.123
> 
> 标签：php, regex, anchor

抱歉，如果这个问题与另一个问题重复，我找不到它：-/

嘿伙计们，我猜这是一个简单的正则表达式问题，但请帮帮我好吗？正则表达式对我来说总是那么复杂:-)

在这个例子中：

> @2 Lorem ipsum dolor sit amet，consectetur adipiscing elit。Praesent sat amet quam ante，sit amet consectetur ante。Ut non urna in quam adipiscing consectetur et sed lorem。Donec venenatis vehicula porttitor。

我想将@2 转换为

```
<a href="#2">@2</a> 
```

但用户可能会像“@2Lorem..”一样输入它，没有空格，或者它可能是@38427。我怎样才能抓住它后面的“@”符号和数字并转换为锚点？

编辑：而且 @ 可能在文本的中间，它可能并不总是在开头。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T20:23:01.047

```
preg_replace('/@(\d+)/', '<a name="#$1">@$1</a>', $string) 
```

样本：

```
php > $x = 'abc @234lorem def';
php > echo preg_replace('/@(\d+)/', '<a name="#$1">@$1</a>', $x);
abc <a name="#234">@234</a>lorem def

\d - any digit
+ - one or more times 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T20:22:19.293

查找：`@([0-9]+)` 替换：`<a href="#$1">@$1</a>`

```
preg_replace('/@([0-9]+)/', '<a name="#$1">@$1</a>', $string); 
```

# javascript - 固定位置和边距顶部的谷歌浏览器问题

> ID：14883333
> 
> 赞同：2
> 
> 时间：2013-02-14T20:20:13.303
> 
> 标签：javascript, jquery, css, html, google-chrome

Chrome中的时髦问题：

`div`我的 Rails 应用程序布局中有这个社交图标：

```
<div class="social_media_icons">
  <ul>
    <li ><a href="http://www.youtube.com/" target="_blank"><img src="/images/yt.jpg" /></a></li>
    <li ><a href="http://www.facebook.com/" target="_blank"><img src="/images/fb.jpg" /></a></li>
    <li ><a href="https://twitter.com" target="_blank"><img src="/images/tw.jpg" /></a></li>
  </ul>
</div> 
```

和相关的CSS：

```
.social_media_icons{
    float: left;
    position: fixed;
    margin-top: -69%;
} 
```

我正在用`@media`查询在屏幕上移动。现在`@media`宽度很好，但高度不太好。因此，当内容发生变化并且页面高度变大或变小时时，我有一个 javascript 函数可以更改以下边距顶部`div`：

```
$(document).ready(function(){
  if(document.documentElement.clientWidth >= 1101){
      if($(".container").height() > 600 && $(".container").height() < 1299){
          $(".social_media_icons").css("margin-top", "-115%"); //problem right here
      } else if($(".container").height() > 1300){
          $(".social_media_icons").css("margin-top", "-273%"); //problem right here
      } else if($(".container").height() <= 500){
          $(".social_media_icons").css("margin-top", "-45%");
      } else{
          $(".social_media_icons").css("margin-top", "-68%");
      }
  }
}); 
```

正如您所看到的`margin-top`，注释行上的 (`-115%`和`-273%`) 的值有点混乱！当然，这些值在 FF 或 IE 中根本不起作用。

**问题：**`margin-top`为什么当页面内容变大时，Chrome 需要如此荒谬的百分比值`600px`？

事实上，为什么我必须改变百分比`margin-top`？它不应该与`fixed`元素上的视图窗口相关吗？这意味着设置`margin-top`一次的值，无论内容如何，​​都应该将其定位在完全相同的位置，因为`view-port`高度永远不会改变。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T20:39:43.227

尝试这样的事情

```
.social_media_icons{
float: left;
position: fixed;
top:0;
left:0;
} 
```

[http://www.w3.org/TR/CSS2/visuren.html#propdef-position](http://www.w3.org/TR/CSS2/visuren.html#propdef-position)

# preprocessor - arduino中的预处理器断言

> ID：14883337
> 
> 赞同：2
> 
> 时间：2013-02-14T20:20:27.517
> 
> 标签：preprocessor, arduino

如果有办法在编译时向 Arduino 预处理器发出停止/中止信号？

一般来说，我对高级预处理器指令不是很熟悉，但我已经看到在某些编译器中存在用于编译时断言的“库”。

背景：

为了防止在代码中分配重复的引脚，我创建了一个枚举来识别每个引脚

```
enum DataPins
{
    /* 00 */ UNUSED_00,
    /* 01 */ UNUSED_01,
    /* 02 */ PIN_IN_SNR0_ECHO,
    /* 03 */ PIN_IN_SNR1_ECHO,
...
    /* 53 */ UNUSED_53,
    /* check */ z_DONOTUSE54
}; 
```

然后我想检查最终名称以确保它在编译时具有正确的值：

```
#define PinsOK  z_DONOTUSE54==54 
```

有没有办法在编译时评估它？如果是这样，那么基于该结果，我可以在 Arduino 中发出编译时错误信号吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T14:55:58.903

我建议查看[http://code.google.com/p/sdfatlib/downloads/list](http://code.google.com/p/sdfatlib/downloads/list)上的 ..\SdFat\utility\DigitalPin.h 。它演示了管脚检查和预编译断言“**属性**（（错误（“管脚号太大或不是常数”））；“ 这类似于 digitalWriteFast.h，但更进一步。在这两个示例中，他们正在测试引脚是静态的还是可变的。与你的目标略有不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T06:55:22.187

预处理器可能会产生错误，但请记住它在编译时间**之前运行。**它只是按照预处理器指令的指示处理源文件进行替换和翻译。严格来说，你的文件甚至是 C++ 源代码都不在乎。

所以不，预处理不能知道 enum {} 定义的内容。

但是，如果您仍然需要问题的错误方面：

```
#define X

#ifdef X
#error ERROR my message
#endif 
```

如果您正在寻找替代方法来节省一些输入并始终如一地构造枚举名称，则可以使用预处理器来构造枚举行。如果您明确分配值，您可能不会关心引脚中的间隙。

```
#define P(no_,name_) Pin##name_ = no_
#define U(no_) PinUnused##no_ = no_

enum {
    P(0,Abc),
    U(1),
    P(2,Something),
    P(15,OutWhatever)
};

int p;
p = PinAbc;
p = PinUnused1;
p = PinSomething; 
```

# python - matplotlib 中的两个条形图以错误的方式重叠

> ID：14883339
> 
> 赞同：6
> 
> 时间：2013-02-14T20:20:30.940
> 
> 标签：python, matplotlib, bar-chart, overlapping

我正在用 Python 中的 matplotlib 创建一个条形图，但重叠条有点问题：

```
import numpy as np
import matplotlib.pyplot as plt

a = range(1,10)
b = range(4,13)
ind = np.arange(len(a))
width = 0.65

fig = plt.figure()
ax = fig.add_subplot(111)

ax.bar(ind+width, a, width, color='#b0c4de')

ax2 = ax.twinx()
ax2.bar(ind+width+0.35, b, 0.45, color='#deb0b0')

ax.set_xticks(ind+width+(width/2))
ax.set_xticklabels(a)

plt.tight_layout() 
```

![条形图](../Images/d927d58f60487e61d1c0cca84daf696b.png)

我希望蓝色条在前面，而不是红色条。到目前为止，我设法做到的唯一方法是切换 ax 和 ax2，但随后 ylabels 也将被反转，这是我不想要的。难道没有一种简单的方法可以告诉 matplotlib 在 ax 之前渲染 ax2 吗？

另外，右边的 ylabels 被 plt.tight_layout() 截断了。有没有办法在仍然使用tight_layout 的同时避免这种情况？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-14T20:40:48.463

也许有更好的方法我不知道；但是，您*可以*交换`ax`并`ax2`交换相应`y`-ticks的位置

```
ax.yaxis.set_ticks_position("right")
ax2.yaxis.set_ticks_position("left") 
```

* * *

```
import numpy as np
import matplotlib.pyplot as plt

a = range(1,10)
b = range(4,13)
ind = np.arange(len(a))
width = 0.65

fig = plt.figure()
ax = fig.add_subplot(111)
ax.bar(ind+width+0.35, b, 0.45, color='#deb0b0')

ax2 = ax.twinx()
ax2.bar(ind+width, a, width, color='#b0c4de')

ax.set_xticks(ind+width+(width/2))
ax.set_xticklabels(a)

ax.yaxis.set_ticks_position("right")
ax2.yaxis.set_ticks_position("left")

plt.tight_layout()
plt.show() 
```

![在此处输入图像描述](../Images/21d16911f32cc662229d80b7752b98f3.png)

* * *

顺便说一句，您可以使用以下`align='center'`参数将条形居中，而不是自己进行数学运算：

```
import numpy as np
import matplotlib.pyplot as plt

a = range(1,10)
b = range(4,13)
ind = np.arange(len(a))

fig = plt.figure()
ax = fig.add_subplot(111)
ax.bar(ind+0.25, b, 0.45, color='#deb0b0', align='center')

ax2 = ax.twinx()
ax2.bar(ind, a, 0.65, color='#b0c4de', align='center')

plt.xticks(ind, a)
ax.yaxis.set_ticks_position("right")
ax2.yaxis.set_ticks_position("left")

plt.tight_layout()
plt.show() 
```

（结果与上述基本相同。）

# jakarta-ee - 想要声明使用一些 EJB 的代码块是事务性的

> ID：14883345
> 
> 赞同：2
> 
> 时间：2013-02-14T20:20:48.137
> 
> 标签：jakarta-ee, transactions, ejb, ejb-3.1

我有一个函数使用几个 EJB 外观，在数据库中创建一些信息。这块数据创建调用应该是原子的，如果失败，则不应提交任何内容。如何使这个调用块具有事务性？

```
public myFunction() {
    ...
    ...
    userFacade.create(user);
    addressFacade.create(address);
    orderFacade.create(order);
    ...
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T06:00:02.017

在 EJB3 中，如果您要使用声明性事务（容器管理事务），那么您可以使用以下任一方式注释这些数据访问调用：

```
@TransactionAttribute(TransactionAttributeType.REQUIRED)

@TransactionAttribute(TransactionAttributeType.MANDATORY) 
```

这意味着如果存在，这些方法将加入当前正在进行的事务。如果 (myFunction) 也是一个 EJB 方法，那么指定`REQUIRES_NEW`将启动一个新事务。当系统异常发生而不是应用程序异常时，事务将回滚。这就是在这种情况下需要使用 setRollbackOnly 的原因。

更多细节在这里：[http ://docs.oracle.com/javaee/6/tutorial/doc/bncij.html](http://docs.oracle.com/javaee/6/tutorial/doc/bncij.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T22:04:57.327

在 Java EE 中，EJB 是处理事务的技术，默认情况下，每个业务方法都是事务性的 - 使用[@TransactionAttribute(REQUIRED)](http://docs.oracle.com/javaee/6/api/javax/ejb/TransactionAttribute.html)注释，除非 bean 提供者更改它。

因此，在您的情况下，将`myFunction`方法设置为业务方法将非常有益，因此事务在进入该方法时开始，并在离开该方法时提交/回滚。这一切都将由 EJB 容器为您处理。当抛出异常时，容器将自动回滚事务，进而回滚其间的所有操作。

# python - 我应该如何在多模块 Python 应用程序中建立和管理数据库连接？

> ID：14883346
> 
> 赞同：17
> 
> 时间：2013-02-14T20:20:55.767
> 
> 标签：python, mysql

我们有一个包含 20 多个模块的 Python 应用程序，其中大部分由多个 Web 和控制台应用程序共享。

我从来没有清楚地了解在多模块 Python 应用程序中建立和管理数据库连接的最佳实践。考虑这个例子：

我有一个为用户定义对象类的模块。它有许多用于在数据库中创建/删除/更新用户的定义。users.py 模块被导入到 a) 基于控制台的实用程序，2) 基于 web.py 的 Web 应用程序和 3) 持续运行的守护进程。

这三个应用程序中的每一个都有不同的生命周期。守护进程可以打开连接并保持打开状态。控制台实用程序连接，确实工作，然后死亡。当然，http 请求是原子的，但是 web 服务器是一个守护进程。

我目前正在打开，使用然后关闭用户类中*每个函数内的连接。*这似乎是最低效的，但它适用于所有示例。另一种用作测试的方法是声明并打开整个模块的全局连接。另一种选择是在顶层应用程序层创建连接并在实例化类时传递引用，但这对我来说似乎是最糟糕的主意。

我知道每个应用程序架构都是不同的。我只是想知道是否有最佳实践，它会是什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-14T20:37:55.537

最好的方法是当你需要做一些操作（比如获取和/或更新数据）时打开连接；操纵数据；**在一个查询**中将其写回数据库（对性能非常重要），然后关闭连接。打开连接是一个相当轻松的过程。

一些性能缺陷包括

*   当您肯定不会与之交互时打开数据库
*   使用比您需要的数据更多的选择器（例如，获取有关所有用户的数据并在 Python 中对其进行过滤，而不是要求 MySQL 过滤掉无用的数据）
*   写入未更改的值（例如，更新用户配置文件的所有值，仅当他们的电子邮件发生更改时）
*   让每个字段单独更新服务器（例如，打开数据库，更新用户电子邮件，关闭数据库，打开数据库，更新用户密码，关闭数据库，打开...你明白了）

最重要的是，打开数据库的次数并不重要，重要的是运行了多少次查询。如果您可以让您的代码加入相关查询，那么您就赢得了这场战斗。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-14T20:45:38.660

MySQL 连接相对较快，所以这可能不是问题（即您应该测量）。大多数其他数据库需要更多的资源来创建连接。

在需要时创建新连接始终是最安全的，也是不错的首选。一些数据库库，例如 SqlAlchemy，有内置的连接池，它将透明地为您正确地重用连接。

如果您决定要保持连接处于活动状态以便可以重复使用它，则需要注意以下几点：

1.  仅用于读取的连接比用于修改数据库数据的连接更易于重用。

2.  当您在连接上启动事务时，请注意在您使用该连接时，没有其他东西可以将该连接用于其他用途。

3.  长时间存在的连接会变得陈旧并且可以从您下方关闭，因此如果您正在重新使用连接，您需要检查它是否仍然“活动”，例如通过发送“select 1”和验证您是否得到结果。

我个人建议不要实现自己的连接池算法。当出现问题时，很难调试。而是选择一个为您完成它的数据库库。

# javascript - 用 object.create 定义的原型的构造函数属性来自哪里？

> ID：14883347
> 
> 赞同：1
> 
> 时间：2013-02-14T20:20:56.550
> 
> 标签：javascript, prototype

```
function myObj(){
    myOtherObj.call(this);
}

myObj.prototype = object.create(myOtherObj.prototype); 
```

myObj.prototype 是否包含指向 myObj 函数的构造函数？如果是这样怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T23:00:13.480

> myObj.prototype 是否包含指向 myObj 函数的构造函数？如果是这样怎么办？

不[`Object.create`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/create)，只会创建一个从给定对象继承的*空*对象。在您的情况下，它`myOtherObj.prototype`很可能具有现在继承的“构造函数”属性（`myObj.prototype.constructor`=== `myOtherObj.prototype.constructor`=== `myOtherObj`）。

这[不是必需](https://stackoverflow.com/questions/12622137/what-is-the-constructor-property-really-used-for)的，但是如果您想调整属性以便`(new myObj).constructor`=== `myObj.prototype.constructor`===`myObj`您可以通过将第二个参数传递给来做到这一点`Object.create`：

```
myObj.prototype = Object.create(myOtherObj.prototype, {
    constructor: {value:myObj, writable:true, enumerable:false, configurable:true}
}); 
```

# focus - 以编程方式使 TextField 失焦？

> ID：14883357
> 
> 赞同：4
> 
> 时间：2013-02-14T20:21:18.993
> 
> 标签：focus, javafx-2, textfield

在我看来，我只有一个可编辑的内容：TextField 中的文本。问题是，一旦 TextField 获得焦点，作为用户就永远不会摆脱焦点（因为没有其他可关注的内容）。当用户按 Enter 时，我想从 TextField 中移除焦点。我知道如何对按下的 Enter 键做出反应，但我不知道如何以编程方式使控件/TextField 失焦？

感谢您的任何提示！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-14T21:51:20.157

我承认我交叉发布了，但我在那里得到了一个回复，我想在这里分享：

调用`requestFocus()`父级，例如在我的例子中是包含 TextField 的 HBox。

[https://forums.oracle.com/forums/thread.jspa?messageID=10852574](https://forums.oracle.com/forums/thread.jspa?messageID=10852574)上的完整示例

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T20:29:28.150

是的，我很抱歉，但我编辑并添加了正确的链接，如果它由于某种原因没有显示在这里：[http ://docs.oracle.com/javafx/2/api/javafx/scene/Node.html #setFocused（布尔值）](http://docs.oracle.com/javafx/2/api/javafx/scene/Node.html#setFocused(boolean))

# c# - 如何对包含 EntityFunctions.AddDays 函数的 GetNewValues() 进行单元测试

> ID：14883360
> 
> 赞同：2
> 
> 时间：2013-02-14T20:21:33.187
> 
> 标签：c#, unit-testing, frameworks, entity

> 下面的示例代码在生产中运行良好，但由于 EntityFunctions 无法进行单元测试。
> 
> 我的单元测试项目使用 InMemoryDatabase 而不是真正的 SQL 数据库。我可以通过在 SQL 数据库中使用计算列 myValue 和 newValue 创建一个视图来轻松解决我的问题。我喜欢在不改变方法和创建新 SQL 视图的情况下找到一种方法来完成单元测试工作

* * *

```
public class EcaseReferralCaseRepository : Repository
{

        public class myType
        {
                public DateTime myValue;
                public DateTime newValue;
        }

        public myType GetNewValues()
        {
                return 
                        (myType)(from o in context.EcaseReferralCases
                        select new myType
                        {
                            // LINQ to Entity
                            myValue = (DateTime)System.Data.Objects.EntityFunctions.AddDays(o.StartDate, 0),
                            newValue = (DateTime)System.Data.Objects.EntityFunctions.AddDays(o.StartDate, 30)

                            // LINQ to Object
                            //myValue = o.StartDate.AddDays(0),
                            //newValue = o.StartDate.AddDays(30)

                        });
        }
} 
```

* * *

[此链接显示了单元测试 EntityFunctions 的一个很好的示例](https://stackoverflow.com/questions/9585203/entityfunctions-truncatetime-and-unit-tests)，我使用该方法解决了我的单元测试困难之一，但不知道如何解决这个问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T23:35:55.130

除非我弄错了，否则您将使用另一个`IQueryable`可能是 LINQ To Objects 可查询源来切换 EcaseReferralCases 的实现。

最健壮的方法可能是使用表达式访问者将调用替换为`EntityFunctions`您自己的、与 L2Objects 兼容的函数。

这是我的实现：

```
using System;
using System.Data.Objects;
using System.Linq;
using System.Linq.Expressions;

static class EntityFunctionsFake
{
    public static DateTime? AddDays(DateTime? original, int? numberOfDays)
    {
        if (!original.HasValue || !numberOfDays.HasValue)
        {
            return null;
        }
        return original.Value.AddDays(numberOfDays.Value);
    }
}
public class EntityFunctionsFakerVisitor : ExpressionVisitor
{
    protected override Expression VisitMethodCall(MethodCallExpression node)
    {
        if (node.Method.DeclaringType == typeof(EntityFunctions))
        {
            var visitedArguments = Visit(node.Arguments).ToArray();
            return Expression.Call(typeof(EntityFunctionsFake), node.Method.Name, node.Method.GetGenericArguments(), visitedArguments);
        }

        return base.VisitMethodCall(node);
    }
}
class VisitedQueryProvider<TVisitor> : IQueryProvider
    where TVisitor : ExpressionVisitor, new()
{
    private readonly IQueryProvider _underlyingQueryProvider;
    public VisitedQueryProvider(IQueryProvider underlyingQueryProvider)
    {
        if (underlyingQueryProvider == null) throw new ArgumentNullException();
        _underlyingQueryProvider = underlyingQueryProvider;
    }

    private static Expression Visit(Expression expression)
    {
        return new TVisitor().Visit(expression);
    }

    public IQueryable<TElement> CreateQuery<TElement>(Expression expression)
    {
        return new VisitedQueryable<TElement, TVisitor>(_underlyingQueryProvider.CreateQuery<TElement>(Visit(expression)));
    }

    public IQueryable CreateQuery(Expression expression)
    {
        var sourceQueryable = _underlyingQueryProvider.CreateQuery(Visit(expression));
        var visitedQueryableType = typeof(VisitedQueryable<,>).MakeGenericType(
            sourceQueryable.ElementType,
            typeof(TVisitor)
            );

        return (IQueryable)Activator.CreateInstance(visitedQueryableType, sourceQueryable);
    }

    public TResult Execute<TResult>(Expression expression)
    {
        return _underlyingQueryProvider.Execute<TResult>(Visit(expression));
    }

    public object Execute(Expression expression)
    {
        return _underlyingQueryProvider.Execute(Visit(expression));
    }
}
public class VisitedQueryable<T, TExpressionVisitor> : IOrderedQueryable<T>
    where TExpressionVisitor : ExpressionVisitor, new()
{
    private readonly IQueryable<T> _underlyingQuery;
    private readonly VisitedQueryProvider<TExpressionVisitor> _queryProviderWrapper;
    public VisitedQueryable(IQueryable<T> underlyingQuery)
    {
        _underlyingQuery = underlyingQuery;
        _queryProviderWrapper = new VisitedQueryProvider<TExpressionVisitor>(underlyingQuery.Provider);
    }

    public IEnumerator<T> GetEnumerator()
    {
        return _underlyingQuery.GetEnumerator();
    }

    IEnumerator IEnumerable.GetEnumerator()
    {
        return GetEnumerator();
    }

    public Expression Expression
    {
        get { return _underlyingQuery.Expression; }
    }

    public Type ElementType
    {
        get { return _underlyingQuery.ElementType; }
    }

    public IQueryProvider Provider
    {
        get { return _queryProviderWrapper; }
    }
} 
```

这是一个使用示例：

```
var linq2ObjectsSource = new List<DateTime?>() { null }.AsQueryable();
var visitedSource = new VisitedQueryable<DateTime?, EntityFunctionsFakerVisitor>(linq2ObjectsSource);
var visitedQuery = visitedSource.Select(dt => EntityFunctions.AddDays(dt, 1));
var results = visitedQuery.ToList();
Assert.AreEqual(1, results.Count);
Assert.AreEqual(null, results[0]); 
```

这样，您将获得所有理想的特征：

*   开发者可以继续使用`EntityFunctions`Entity Framework定义的标准；
*   如果不在数据库上运行，生产实现仍然可以保证引发异常；
*   查询可以针对假存储库进行测试；

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T00:03:27.980

而不是打电话

```
System.Data.Objects.EntityFunctions.AddDays 
```

直接，我会注入一个自定义接口，它将调用转发给该方法，但随后可以为了测试目的而对其进行模拟。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-26T17:15:20.637

我确实喜欢按照 Jean Hominal 的建议实施 ExpressionVisitor。我的困难是如何在我的例子中定义 linq2ObjectsSource、visitedSource 和visitedQuery。所以最后，我只是为方法 IQuerable GetSelectQuery（IQuerable 查询）创建一个接口，然后在生产和测试项目中具有相应的类，该类派生自该接口并具有 GetSelectQuery（IQuerable 查询）的实现。它工作正常。

```
public interface IEntityFunctionsExpressions
{
   IQuerable<myType> GetSelectQuery(IQuerable<EcaseReferralCase> query); 
} 
```

在生产项目中：

```
public class EntityFunctionsExpressions : IEntityFunctionsExpressions
{
    public EntityFunctionsExpressions()
    {
    }

    public IQuerable<myType> GetSelectQuery(IQuerable<EcaseReferralCase> query)
    {
        // Expression for LINQ to Entities, does not work with LINQ to Objects
        return 
                    (myType)(from o in query
                    select new myType
                    {
                        // LINQ to Entity
                        myValue = (DateTime)System.Data.Objects.EntityFunctions.AddDays(o.StartDate, 0),
                        newValue = (DateTime)System.Data.Objects.EntityFunctions.AddDays(o.StartDate, 30)

                    });
    }
} 
```

在单元测试项目中：

```
public class MockEntityFunctionsExpressions : IEntityFunctionsExpressions
{
    public MockEntityFunctionsExpressions()
    {
    }

    public IQuerable<myType> GetSelectQuery(IQuerable<EcaseReferralCase> query)
    {
        // Expression for LINQ to Objects, does not work with LINQ to Entities
        return 
                    (myType)(from o in query
                    select new myType
                    {
                        // LINQ to Object
                        myValue = o.StartDate.AddDays(0),
                        newValue = o.StartDate.AddDays(30)
                    });
    }
} 
```

然后重写 GetNewValues() 方法：

public myType GetNewValues() { return myrepository.EntityFunctionsExpressions.GetSelectQuery(context.EcaseReferralCases);

}

# java - 如何将图表添加到 Hudson

> ID：14883362
> 
> 赞同：0
> 
> 时间：2013-02-14T20:21:42.587
> 
> 标签：java, hudson

我有一个项目需要 Hudson 每天运行某些构建，我想制作一个显示该构建的历史数据的折线图。我在谷歌上搜索过，似乎很少有文档说明如何做到这一点。有人可以提供有关此问题的一些信息吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T15:35:47.480

有一个[Hudson Plot](http://wiki.hudson-ci.org/display/HUDSON/Plot+Plugin)插件

# c++ - 简单代码中的 C++ 语法歧义

> ID：14883364
> 
> 赞同：-5
> 
> 时间：2013-02-14T20:21:45.820
> 
> 标签：c++, syntax

我使用 vs2010 编译器，但我遇到了歧义

下面的代码是什么意思？输出是什么，为什么？

```
 int a;
    cout<<(a=2)+(a=3)+(a=5) 
```

如果这个问题之前被问过或者很明显，我很抱歉！但我对结果感到困惑

```
 output :15 
```

我在这里找不到我的答案：

[为什么这些构造（使用 ++）是未定义的行为？](https://stackoverflow.com/questions/949433/could-anyone-explain-these-undefined-behaviors-i-i-i-i-i-etc)

耐心再看一遍结果（请）

提前谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T20:23:41.253

> 下面的代码是什么意思？

没有什么明智的。

> 输出是什么？

不可预料的。

> 为什么？

因为这段代码调用了未定义的行为。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T20:30:06.893

该标准表示未定义表达式中并行子表达式的评估顺序。在您的示例中，编译器可以自由选择首先评估哪个，因此结果是不可预测的

# php - 远程登录 PHP 页面

> ID：14883370
> 
> 赞同：1
> 
> 时间：2013-02-14T20:22:13.057
> 
> 标签：php, security

好的，让我试着解释一下我想要实现的目标，我想我会为此付出很多。

我已经创建了一个带有 PHP 和登录等的服务器设置。

现在我正在开发一个电话应用程序并尝试利用我已经创建的内容，但是我真的很难想出一种从网站登录的安全方法，因为我能看到的唯一方法是调用 PHP 页面使用密码，例如：

```
http://website/login?password=password 
```

我的密码已经加盐了，但这仍然无济于事，因为虽然在请求中看不到实际密码，但请求可能会被拦截并重复发送。

我可以在这里做些什么来确保这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T21:11:06.253

使用 POST 和 SSL。POST 将防止密码出现在服务器日志中，而 SSL 将防止在传输过程中进行嗅探。

# c++ - 挂在提升邻接列表清除

> ID：14883377
> 
> 赞同：0
> 
> 时间：2013-02-14T20:23:02.467
> 
> 标签：c++, boost, memory-management

我尝试使用用 C++ ( [https://sites.google.com/site/roboticssaurav/strokewidthnokia](https://sites.google.com/site/roboticssaurav/strokewidthnokia) ) 编写的文本检测应用程序，但代码挂起。我发现这个问题的根源是其中一个函数使用了 50 K 顶点和 150 K 边的大图，并且所有代码都挂在调用邻接列表“clear”的位置。

```
std::vector< std::vector<Point2d> >
findLegallyConnectedComponents (IplImage * SWTImage,
                                std::vector<Ray> & rays)
{
...
typedef boost::adjacency_list<boost::vecS, boost::vecS, boost::undirectedS> Graph;
...
Graph g(num_of_vertices);
...
} 
```

离开此函数后，将调用 g.clear()，程序挂起。我怎样才能摆脱这个错误？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T09:46:56.213

所以这个问题在release模式下就消失了，这样就解决了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-11-25T07:18:59.737

此问题仅在调试模式下发生。

如果你不能像我一样使用释放模式。

您可以手动清除 m_edges 然后清除图中的 m_vertices 以避免此问题。

像下面这样：

```
Graph g;
// .......

// clear it on DEBUG mode to avoid hanges
g.m_edges.clear();
g.m_vertices.clear();
g.clear(); 
```

# sql - SQL Server 2012 只读连接

> ID：14883380
> 
> 赞同：5
> 
> 时间：2013-02-14T20:23:07.963
> 
> 标签：sql, sql-server-2012

如何在不需要创建只读用户的情况下设置到 sql server 2012 的只读连接？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T23:56:06.097

连接字符串属性[ApplicationIntent](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlconnection.connectionstring.aspx)

从文档：

> 连接到服务器时声明应用程序工作负载类型。可能的值为 ReadOnly 和 ReadWrite。例如：

```
ApplicationIntent=ReadOnly 
```

# c# - 测试 Linq 查询 EF 和存储库模式

> ID：14883383
> 
> 赞同：3
> 
> 时间：2013-02-14T20:23:18.160
> 
> 标签：c#, entity-framework, unit-testing, repository-pattern

相信我，我在这里阅读了很多关于 SO 的文章和问题。但我还没有找到满意的答案。以[Matt Robert](http://moleseyhill.com/blog/2009/06/29/simple-repository-pattern/)关于存储库模式和单元测试的教程为例：

我不明白.. 两个存储库是否包含完全相同的查询逻辑？似乎是这样，如果是这样，那是一个有用的模式吗？这意味着每当我更改假存储库中的查询时，我都必须更改实际存储库中的查询逻辑——这听起来像是 PITA 和问题的配方。

我想将查询保留在*一种*方法中并测试该方法。后来我想到，我可以这样做：

```
//Student can be from the db or a fake list
public person GetStudent(IEnumerable<Student> students,int studentid)
{
   return students.FirstOrDefault(s =>s.PersonId ==studentid);
}

//unit test
    Assert.IsNull(GetStudent(fakeStudentList, -1))
//actual code
    var student =  GetStudent(entities.students,-1) 
```

有没有模仿上面的模式？如果是这样，它是什么？或者这实际上是存储库模式的工作原理？如果是这样，为什么感觉存储库模式重复了代码？

而且，*努力*..看看这个可怕的**[例子](http://mylifeandcode.blogspot.ie/2012/10/unit-testing-with-mock-entity-framework.html)**：S？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T20:45:47.583

没什么可做的，但我认为您的存储库模式存在缺陷。

您不应将学生收藏传递给`GetStudent()`. `GetStudent`应该是内部了解学生列表的类的一部分 - 无论是文件`List`、数据库还是其他。

因此，您的“假”存储库*可能*具有相同的逻辑，或者它*可能*只是返回一个硬编码的 dummy `Student`。如果您伪造存储库，我假设它是因为您正在测试需要存储库的其他东西，所以它不应该关心它是*如何*获得`Student`.

此外，您引用的文章仅提到了一个存储库，因此我不确定您为什么需要复制它。

# c# - 在 Metroapp 中显示存储在 Storage 文件中的图片

> ID：14883384
> 
> 赞同：3
> 
> 时间：2013-02-14T20:23:22.257
> 
> 标签：c#, windows-8, microsoft-metro, .net-4.5

我想通过绑定显示存储在 StorageFile 中的图片内容，但无论我尝试做什么，它似乎都不起作用。

这是我已经测试过的两种解决方案：

```
string img =( await CompetencesFolder.GetFileAsync(FormatImageNameToFileName(imageName))).Path; 
```

然后通过绑定将获得的路径（文件的完整绝对路径）返回到源属性，并且：

```
 BitmapImage img = await LoadImage(await CompetencesFolder.GetFileAsync(FormatImageNameToFileName(imageName)));

  private static async Task<BitmapImage> LoadImage(StorageFile file)
        {
            BitmapImage bitmapImage = new BitmapImage();
            FileRandomAccessStream stream = (FileRandomAccessStream)await file.OpenAsync(FileAccessMode.Read);

            bitmapImage.SetSource(stream);

            return bitmapImage;

        } 
```

稍后将最终的 bitmapImage 返回到我的绑定属性。

这些方法都不起作用..

有人有想法吗？

**编辑：修复**

这是解决问题的代码：

```
BitmapImage img = new BitmapImage() { UriSource = new Uri( LOCAL_REPOSITORY.Path + "/Assets/gfx/cards/" + FormatImageNameToFileName(imageName) + ".jpg", UriKind.RelativeOrAbsolute) }; 
```

我混合了上面的 2 个示例：我从图片的绝对 URI 创建了我的 bitmapImage（LOCAL_REPOSITORY 包含对本地存储的引用`ApplicationData.Current.LocalFolder`：）

我仍然不明白为什么其他两种方式都失败了：我通常将我的图像直接绑定到 Uri、字符串或 BitmapImage，它可以工作..

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-15T21:38:12.017

下面的代码展示了如何在应用程序中使用 loadimage 方法：创建一个空白应用程序，向主页添加一个图像和一个按钮。

```
 private async void  Button_Click_1(object sender, RoutedEventArgs e)
    {
        // load file from document library. Note: select document library in capabilities and declare .png file type
        string filename = "Logo.png";
        Windows.Storage.StorageFile sampleFile = await Windows.Storage.KnownFolders.DocumentsLibrary.GetFileAsync(filename);
        // load file from a local folder
        //Windows.Storage.StorageFile sampleFile = sampleFile = await Windows.ApplicationModel.Package.Current.InstalledLocation.GetFileAsync("Assets\\Logo.png");

        BitmapImage img = new BitmapImage();
        img = await LoadImage(sampleFile);
        myImage.Source = img;
    }

    private static async Task<BitmapImage> LoadImage(StorageFile file)
    {
        BitmapImage bitmapImage = new BitmapImage();
        FileRandomAccessStream stream = (FileRandomAccessStream)await file.OpenAsync(FileAccessMode.Read);

        bitmapImage.SetSource(stream);

        return bitmapImage;

    } 
```

# java - 通过用户输入插入/删除数组中的元素

> ID：14883386
> 
> 赞同：0
> 
> 时间：2013-02-14T20:23:29.090
> 
> 标签：java, arrays, arraylist

我是 Java 编程的新手。我想问一下如何将用户的某些输入插入/删除到我生成的数组列表中。它应该显示形成的新列表我已经有一个代码..但它不能正常工作..这是我的代码：

```
import java.io.*;
import java.util.ArrayList;
import java.util.Scanner;
import java.util.*;

class New1 {
    public static InputStreamReader r = new InputStreamReader (System.in);
    public static BufferedReader inp = new BufferedReader(r);

    public static void main (String args[]) throws Exception {
        ArrayList employees = new ArrayList();
        employees.add("A");
        employees.add("B");
        employees.add("C");
        employees.add("D");
        employees.add("E");

        Scanner scan1 = new Scanner (System.in);
        System.out.println ("Lists of Employees");
        System.out.println ("What do you want to do?:");
        System.out.println ("1 - Display list. \n2 - Insert New Name. \n3 - Delete an item. \n4 - Nothing." + "\n ");
        int task = scan1.nextInt();

        if (task==1) {
            System.out.println ("Contents of Employees:" + employees);
        } else if (task==2) {
            do {
                System.out.println("Current list is " + employees);
                System.out.println("Add more? (y/n) ");
                if (scan1.next().startsWith("y")) {
                    System.out.println("Enter : ");
                    employees.add(scan1.next());
                } else {
                    break;
                }
            } while (true);

            System.out.println("List is " + employees);
            String[] arr = employees.toArray(new String[0]);
            System.out.println("Array is " + Arrays.toString(arr));
        }
    } 
```

我在这里真的需要帮助。>.<

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T20:54:29.237

首先，您的代码中有一些编译时错误。在最后一行代码中，缺少“}”。类块未关闭。

其次，使用下面的行，String[] arr = (String[]) employees.toArray(new String[0]); 而不是 String[] arr = employees.toArray(new String[0]);

因为 toArray(new String[0]) 将返回一个对象，并且您将其存储在数组中。因此，您必须将其类型转换为数组。现在，它会正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T20:54:54.820

您应该参数化列表初始化，否则以下代码将无法编译：`String[] arr = employees.toArray(new String[0]);`

尽管您可以将右手表达式显式转换为`String[]`，但这不是一个好习惯，并且无视泛型在编译时捕获潜在错误的意图。

我会这样做：

```
List<String> employees = new ArrayList<String>(); 
```

而不是`0`, 将使用列表的大小来初始化正在创建的数组的大小：

```
String[] arr = employees.toArray(new String[employees.size()]); 
```

# ios - 当 segue 样式从 Push 更改为 Modal 时，目标场景上的 UINavigationItem 消失

> ID：14883391
> 
> 赞同：1
> 
> 时间：2013-02-14T20:23:50.977
> 
> 标签：ios, xcode, cocoa-touch

对于`UINavigationController`场景之间的序列，为什么将序列样式从更改`Push`为`Modal`导致`UINavigationItem`目标场景从 IB 和构建的应用程序中消失？有趣的`UINavigationItem`是，仍然在 IB 层次结构中。

如何获得`UINNavigationItem`在目标场景中仍然可见的模态序列？我正在尝试做一些看起来很简单的事情，比如 iPhone 联系人应用程序中的编辑功能。在那里，您有一个在联系人编辑时出现的模态，您可以在完成后导航回联系人详细信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:29:32.660

如果您正在呈现一个模态视图控制器，它将没有呈现控制器中存在的导航栏（假设一个嵌入在导航控制器中）。联系人应用程序的顶部栏可能是一个`UIToolbar`（对象库中的“工具栏”）。您可以将其中之一拖到您的控制器中，并在 IB 中向其中添加条形按钮项目。这些按钮有很多不同的样式可供您选择，包括“完成”和“取消”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T20:33:47.720

任何视图控制器都可以有一个导航项，但只有当您的视图控制器嵌入导航控制器时才会显示。模态视图控制器不继承呈现它们的视图控制器的导航控制器——本质上，它们代表用户通过应用程序的路径中的一个分支，而不是它们来自的导航堆栈的扩展。

如果您想要导航控制器在模态视图控制器中提供的东西，则将该 VC 嵌入到导航控制器中，并以模态方式呈现该导航控制器。

（或者，如果您只想在视图顶部显示一个导航栏，而不关心您从中获得的其他内容`UINavigationController`，您可以将`UINavigationBar`（对象库中的导航栏）拖放到 IB 的视图中。）

# java - 使用抽象类时为 @RequestBody 指定类型

> ID：14883393
> 
> 赞同：1
> 
> 时间：2013-02-14T20:23:52.200
> 
> 标签：java, spring, spring-mvc

我有一个接收抽象类的端点：

```
@RequestMapping(value = URL, method = RequestMethod.POST)
@ResponseBody
public ModelMap update(@RequestBody SomeAbstractClass form) {
      ...
} 
```

当我发布到它时，我得到了错误：

```
Could not read JSON: Can not construct instance of ..., 
problem: abstract types can only be instantiated with dditional type information 
```

我明白为什么我会收到这个错误，但我不知道我会在哪里指定`the additional type information`. 理想情况下，我可以通过其中一个注释来指定具体类的类型，但此时任何解决方案都足够了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T22:13:29.270

我相信您将 Jackson 用作 JSON serailizer。

首先确保你有

```
 <context:annotation-config/> 
```

在你的 spring xml conf 文件中。

我曾经有同样的问题继承类的反序列化我通过注释它解决了它

```
@JsonDeserialize(as=Child.class)
public abstract class AbstractParent { ... } 
```

# python - 如何根据依赖值获取最大项目？

> ID：14883395
> 
> 赞同：1
> 
> 时间：2013-02-14T20:23:55.843
> 
> 标签：python, list, max

我有这个数组：

```
array = ["a\nb", "c", "d"] 
```

我想找出哪个数组的元素有更多行以及有多少行。我想要这个 ruby​​ 代码在 python 中：

```
array.map {|e| e.split("\n").size }.max #=> 2 
```

这行得通，但我想知道是否有更好的方法：

```
bigger = 0
for e in array:
    e_lines = len(e.split('\n'))
    if e_lines > bigger:
        bigger = e_lines 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T20:26:20.920

你可以做：

```
max(array, key=lambda x: x.count('\n')) 
```

然后只需得到`.count('\n')`结果对象的 + 1 也知道有多少

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-14T20:26:32.557

```
In [54]: array = ["a\nb", "c", "d"]
In [56]: max(e.count("\n") for e in array)+1
Out[56]: 2 
```

如果您还想要一个（可能是非唯一的）具有最大行数的元素：

```
In [60]: max((e.count("\n")+1, e) for e in array)
Out[60]: (2, 'a\nb') 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-14T20:47:22.740

如果您想要*确切的*功能，那就是：

```
>>> array = ["a\nb", "c", "d"]
>>> [len(l.split('\n')) for l in array]
[2, 1, 1]
>>> max(len(l.split('\n')) for l in array)
2 
```

但[unutbu 的](https://stackoverflow.com/a/14883436/298607)解决方案可能更快。

# javascript - 一起使用 Javascript 命名空间闭包和原型失败？

> ID：14883399
> 
> 赞同：1
> 
> 时间：2013-02-14T20:24:04.540
> 
> 标签：javascript, prototype-programming

我遵循以下模式在我的项目中使用命名空间：

```
// simply a namespace attic object
// parent to my worker objects
;(function( RoaringSky, undefined ) 
{
    var opt = {
        backend : ""
    },
    name = ""
    ;

    RoaringSky.init = function( options ) {
       jQuery.extend(opt,options);
       console.log( 'RoaringSky.init complete');
    };
    // accessor 
    RoaringSky.opt = opt;

})(window.RoaringSky = window.RoaringSky || {}); 
```

和这个命名空间的一个子对象，所以：

```
RoaringSky.Day = (function() {

    // constructor
    var Day = function(){

        var id = "none";
        var name = "none";
        var date = "none";
        var periods = new Array();

        this.periods = function() {
            return periods;
        };
    };

    // invoking day.time() fails - is not a function message
    Day.prototype.time = function() {
        return this.doSomthingWithDate(date);
    };

    return Day;
})(window.RoaringSky.Day = window.RoaringSky.Day || {}); 
```

我认为，就目前而言，这种模式工作得很好。（欢迎批评）但它似乎阻止了原型属性的使用。

也许我的理解是不完整的（我敢肯定）但是AFAIK，一旦我创建了一个对象 - 就像我上面的 Day 类 - 我应该能够以以下方式编写函数：

```
Day.prototype.time = function() {
    return this.doSomthingWithDate(date);
}; 
```

并且该类的所有实例都将继承该函数，因为它是构造函数的类对象 Day() 的属性；

但是，当我尝试这个时：

```
var day = new Day();
day = new Date();
console.log( 'day.time: '+ day.time() ); 
```

我得到了祝福，“day.time() 不是函数”错误消息。

我究竟做错了什么？这开始让我发疯了。

*   埃里克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T20:39:06.393

几个问题：

```
RoaringSky.Day = (function() {

    // constructor
    var Day = function(){

        var id = "none";
        var name = "none";
        var date = "none";
        var periods = new Array();

        this.periods = function() {
            return periods;
        };
    };

    // invoking day.time() fails - is not a function message
    Day.prototype.time = function() {
        // can't use "date" here since it is not in scope
        return this.doSomthingWithDate(date);
    };

    return Day;
})(window.RoaringSky.Day = window.RoaringSky.Day || {}); 
```

然后：

```
var day = new Day(); // Day is not a member of window, so this will only work when used in the `RoaringSky.Day` declaration.
day = new Date();    // you then override the day variable for some reason
console.log( 'day.time: '+ day.time() ); // time is not a function member of Date 
```

# python - 单个 SQLAlchemy 映射对象导致内存中有许多不同的实例

> ID：14883400
> 
> 赞同：1
> 
> 时间：2013-02-14T20:24:03.030
> 
> 标签：python, sqlalchemy

我知道标题很复杂，所以我将尝试给出一个简化的示例来说明我正在尝试做的事情。请容忍我一会儿。

我正在研究期权价值计算和投资组合风险分析服务器，我遇到了一个问题，我不太确定在加载我的持久对象图然后访问一些我动态添加的缓存属性时如何解决数据库负载。

假设我有以下映射类：

```
Base = declarative_base()

class Portfolio(Base):
    __tablename__ = "portfolios"
    id = Column(Integer, primary_key=True)
    asset_classes = relationship("AssetClass", backref="portfolios")

class AssetClass(Base):
    __tablename__ = "asset_classes"
    id = Column(Integer, primary_key=True)
    portolio_id = Column(Integer, ForeignKey("portfolios.id"))
    assets = relationship("Asset", backref="asset_classes")

class Asset(Base):
    id = Column(Integer, primary_key=True)
    asset_class_id = Column(Integer, ForeignKey("asset_classes.id")) 
```

然后我加载一个投资组合并进行一些初始化，如下所示：

```
session = Session()
# pretend there's only one Portfolio
portfolio = session.query(Portfolio).one()
init_portfolio(portfolio)
while(keep_server_alive):
# session stays open for server life
    gevent.sleep(0)
session.close()

def init_portfolio(p):
    # note that this is a dynamically added property
    portfolio.values_store = ValuesStore()
    for asset_class in p.asset_classes:
        init_asset_class(asset_class)

def init_asset_class(ac):
    for asset in ac.assets:
        init_asset(asset) 
```

初始化所有内容后，我使用一个长时间运行的 gevent 线程来处理价格更新并计算某些衍生值，如下所示：

```
def on_underlying_update(asset, underlying_price):
    # the next line non-deterministically fails with an AttributeError
    values_store = asset.asset_class.portfolio.values_store
    values_store.get_asset_price(asset, underlying_price) 
```

这些计算可能非常昂贵，因此 ValuesStore 对象有一个缓存策略来存储结果。在随机通过 on_underlying_update 函数时，我会得到一个 AttributeError ，说明 Portfolio 对象没有 values_store 属性。

起初这真的让我很困惑，但是当我稍微调试一下这个问题时，我似乎发现引用同一个 Portfolio 的子 AssetClass 对象实际上可能引用了内存中的不同对象。在使用 python 的 id() 函数在每次访问期间检查 Portfolio.id 与内存 id 后，我开始相信这一点。这样做，我经常会发现，虽然我可能只访问过一个 Portfolio.id，但我引用了几个不同的内存地址，具体取决于哪个孩子正在访问。

我知道这很啰嗦，我很感激那些一直坚持我的人。我的问题是，有没有办法让我将整个对象图加载到内存中一次且只有一次？从资源的角度来看，这个 ValuesStore 对象可能很昂贵，我希望尽可能少地实例化它。

作为参考，我正在使用 Python 2.7.3、SQLAlchemy 0.8、gevent 1.0rc2，并且在 Windows 7 和 OS X 10.8 上都遇到了同样的问题。

再次感谢。

** 编辑 **

我花了很多时间浏览我的代码，寻找会导致 Portfolio 对象与当前会话分离并附加到新会话的语句。我找不到任何类似的东西。我尝试监听各种 Instance 和 Session 事件，每次，我都可以看到正在加载的“新”投资组合，但它是由原始 Session 加载的。

投资组合对象是否有可能被垃圾收集？我尝试通过生成一个新的 Gevent 线程来测试这个假设，以保持对 Portfolio 的强引用，如下所示：

```
def keep_portfolio_alive(p):
    portfolio = p
    while True:
        gevent.sleep(0) 
```

这似乎可以解决问题。我再也没有看到 Session 再次加载投资组合。

** 编辑 2 **

所以我不确定，但我相信我找到了我的问题。在定义映射类之间的关系时，我实际上使用了 attribute_mapped_collections 而不是普通列表。初始化类时，我会像这样遍历子对象：

```
for asset_class in portfolio.asset_classes.itervalues():
    # do something 
```

由于其中一些类是多重嵌套的，因此在层次结构中，有一个类已使用此复制迭代器引用，然后它使用另一个复制迭代器引用其自己的子类。我最好的猜测是 Portfolio 类最终在它和它的父对象之间或者它和它的任何子对象之间没有强引用。然后 GC 在某个时候将其标记为收集。

希望这对将来的某人有所帮助。

# z3 - Z3 公式未通过语法检查

> ID：14883403
> 
> 赞同：0
> 
> 时间：2013-02-14T20:24:15.867
> 
> 标签：z3

当 x13 在箭头所在的行中被 av5 替换时，以下 SMT 公式在rise4fun 站点的语法检查失败。

```
(set-info :status unknown) 
;(set-logic QF_BV) 
(declare-fun in3 () (_ BitVec 16)) 
(assert 
(let ((x8 ((_ zero_extend 16) in3))) 
(let ((x13 (ite (not (= x8 (_ bv00000000 32))) (_ bv00045069 32) (_ bv00000174 32)))) 
(let ((av5 (= x13 (_ bv00045069 32)))) 
(= x13 (_ bv4294967295 32)))))) <--------- 
(assert true) 
(check-sat) 
```

错误信息是

*Z3(8, 26)：错误：无效的函数应用，位置 2 的参数排序不匹配*

知道我可能做错了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T20:47:47.693

您使用的是哪个版本？我无法使用 4.3.x 版或不稳定（正在进行中）分支重现此问题。在这两种情况下，我都得到`unsat`. 我也`unsat`上了[rise4fun](http://rise4fun.com/Z3/gO29)。

# r - 方括号子集给出 NA

> ID：14883409
> 
> 赞同：0
> 
> 时间：2013-02-14T20:24:26.483
> 
> 标签：r, subset, states

我正在对状态数据框进行子集化。我想要列子区域中“吐出”的行。但它给了我所有的 NA。我哪里错了？

我最终想添加另一个这样的列

```
states$code[states$subregion=="spit"]="Priority1" 
```

示例代码：

```
states=map_data("state")
states[states$subregion=="spit",]
# long lat group order region subregion
# NA     NA  NA    NA    NA   <NA>      <NA>
# NA.1   NA  NA    NA    NA   <NA>      <NA>
# NA.2   NA  NA    NA    NA   <NA>      <NA>
# NA.3   NA  NA    NA    NA   <NA>      <NA>
# NA.4   NA  NA    NA    NA   <NA>      <NA>
# NA.5   NA  NA    NA    NA   <NA>      <NA> 
```

但这给了我正确的结果`states[states$region=="north carolina",]`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T20:37:27.027

查看 的结构并`states`特别注意`NA`. `subregion`如果您像您正在做的那样使用方括号进行子集化，`NA`则*包含*在子集中。一个小例子：

```
dat <- data.frame(x=1:10, y=c('a', 'b'), z='foo')
dat$y[9:10] <- NA

dat[dat$y == 'a',]

      x    y    z
1     1    a  foo
3     3    a  foo
5     5    a  foo
7     7    a  foo
NA   NA <NA> <NA>
NA.1 NA <NA> <NA> 
```

如果你使用`na.omit`或类似的东西，你会看到你期望的结果：

```
foo <- states[states$subregion=="spit",]
foo[!is.na(foo$subregion),]

#            long      lat group order         region subregion
# 10321 -76.00285 36.55471    40 10321 north carolina      spit
# 10322 -75.93983 36.55471    40 10322 north carolina      spit
# 10323 -75.92837 36.54898    40 10323 north carolina      spit
# 10324 -75.91691 36.52606    40 10324 north carolina      spit
# 10325 -75.91118 36.50887    40 10325 north carolina      spit
# 10326 -75.91118 36.49168    40 10326 north carolina      spit
# 10327 -75.93983 36.49168    40 10327 north carolina      spit
# 10328 -75.96848 36.49741    40 10328 north carolina      spit
# 10329 -75.97421 36.50314    40 10329 north carolina      spit
# 10330 -75.97421 36.52606    40 10330 north carolina      spit
# 10331 -75.98566 36.55471    40 10331 north carolina      spit
# 10332 -76.00285 36.55471    40 10332 north carolina      spit 
```

或者在一行中：

```
states[states$subregion == 'spit' & !is.na(states$subregion),] 
```

# android - Camera.open() 挂在 LG 设备上

> ID：14883414
> 
> 赞同：0
> 
> 时间：2013-02-14T20:24:50.197
> 
> 标签：android, android-camera

我写了一段代码来记录来自相机的视频。没有什么不寻常的。它可以在具有不同 Android 版本的多个 HTC 和三星设备上完美运行。

但是... LG 设备有问题。带有 Android 4.0.4 的 LG-P970 在 Camera.open 呼叫中挂起。我在日志中看到的是：

```
02-14 20:16:48.582: E/CameraProperties(1348): 73: initialize() ENTER
02-14 20:16:48.652: I/LGMDMUICameraAdapter(21106): Camera open, camPid = 21106
02-14 20:16:48.652: I/LGMDMUICameraAdapter(21106): getCameraDisabled = false 
```

就这样。如果我在调试器中运行应用程序，然后在挂起时将其挂起，则表明应用程序在 Camera.native_setup 中挂起

我真的不知道如何解决这个问题。我认为在 Activty.onCreate 中创建 Camera 实例不是一个好主意，并将代码延迟移动到线程，然后移动到可运行并延迟在主线程中执行。它根本不起作用。

有任何想法吗？

# sql - SQL ORDER BY 计算表中的两列

> ID：14883417
> 
> 赞同：3
> 
> 时间：2013-02-14T20:25:06.173
> 
> 标签：sql, sql-order-by

嘿，我想通过计算表中的两列来订购我的 sql 查询。这个计算是`(col1/col2)*100`我将如何去订购？

喜欢按`(col1/col2)*100`DESC 排序？

我在网上找不到任何东西，所以所有的帮助都将不胜感激。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-14T20:34:57.190

```
SELECT col1, col2, (col1/col2)*100 as total
  FROM your table
ORDER BY 3 DESC
/ 
```

# cocoa-touch - 临时存储托管对象上下文中的更改并稍后应用它们

> ID：14883419
> 
> 赞同：1
> 
> 时间：2013-02-14T20:25:05.040
> 
> 标签：cocoa-touch, core-data

我正在使用 CoreData 并将[`AFIncrementalStore`](https://github.com/AFNetworking/AFIncrementalStore/)数据持久化到远程服务器。如果服务器处于离线状态并且我向我的 发送`save`消息`NSManagedObjectContext`，则无法上传这些更改。AFIncrementalStore 本身并不能处理这种情况，因此我需要一种方法`AFIncrementalStore`在与它们联系之前捕获这些更改，这意味着将所有更改存储在本地，并在服务器连接建立后`NSManagedObjectContext`上传/它们。`save`

有没有办法做到这一点？

# jsf - 强制重置另一个 bean 上的值

> ID：14883422
> 
> 赞同：0
> 
> 时间：2013-02-14T20:25:21.027
> 
> 标签：jsf, primefaces

我有一个与一个 bean 关联的父窗口和一个与另一个 bean 关联的子对话框（包含列表）。

我的要求是每当我点击链接打开子对话框时，我需要强制重置列表（对象）清除。

在父 bean 中尝试了以下内容，但没有奏效。

```
FacesContext facesContext = FacesContext.getCurrentInstance();

childBean = (ChildBean) facesContext.getApplication().evaluateExpressionGet(facesContext,
            "#{childBean}", ChildBean.class);   childBean.setEmployeeList(null); 
```

使用 primefaces 3.5 和 jsf 2.0

# c# - 在 C# 应用程序中包含 Powershell 的最佳实践是什么？

> ID：14883424
> 
> 赞同：1
> 
> 时间：2013-02-14T20:25:24.723
> 
> 标签：c#, powershell, office365

我已经启动并运行了我的应用程序，但它似乎不想通过 ClickOnce 正确安装。它使用 Powershell，我在我的应用程序文件中包含了 Microsoft.Management.Infrastructure.DLL、Microsoft.Management.Infrastructure.Native.DLL 和 System.Management.Automation.DLL。我已经尝试了所有这些方式（包括、先决条件、排除）。我还通过将它们从 GAC 复制到该文件夹​​中，将它们手动复制到我的参考文献中。此外，我将它们设置为复制本地。

为此，我遵循了几条指示，告诉我应该将我的 csproj 文件中的引用更改为：

```
<Reference Include="Microsoft.Management.Infrastructure"/> 
```

对于每个参考。这样，它实际上会在计算机上查找最新的 DLL。

问题是，如果它们设置为 prereqs，我会收到一条消息，告诉我它们应该首先安装在 GAC 中。如果它们设置为包含，我相信它会复制文件，让我的应用程序运行，但我得到......

> “加载系统 Windows PowerShell 管理单元时出错。请联系 Microsoft 支持服务。”

现在，我将范围缩小到不同版本的 Powershell 或不同计算机上的自动化 dll。整个应用程序在我的计算机上运行良好，但在（某些）其他计算机上运行良好。

所以！我不知道我是否提供了太多细节，但我希望我的应用程序简单地复制所需的 DLL 或引用已经存在的 DLL（最好是后者）。

有人能帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T21:30:25.377

这些文件由 PowerShell 安装。您不想将它们与您的应用程序一起安装。您正在使用的安装程序应该提供一种“排除”这些依赖项的方法。最好的办法是检查您需要的 PowerShell 版本作为自定义操作，然后在用户不需要适当版本的 PowerShell 时提醒用户。

# javascript - Javascript：如何检查字符串是否以 2 个字母后跟一个整数结尾？

> ID：14883426
> 
> 赞同：2
> 
> 时间：2013-02-14T20:25:44.023
> 
> 标签：javascript, jquery

我想检查一个字符串是否以`ab`一个整数结尾。

给定任何 string `s`，我如何首先检查它是否以`ab1`or`ab2`或 a结尾`b3`，如果是，则返回`ab1`or `ab2`or `ab3`。

例如，对于 string `sdfsadfsab2`，我想返回`ab2`。
对于字符串`asdfase`，我想返回空字符串。

javascript或jquery中是否有任何正则表达式可以做到这一点？谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-14T20:29:38.650

您所追求的正则表达式很可能是：

```
/ab[0-9]$/ 
```

如果你想要一个测试函数，该函数可能看起来像这样：

```
function testABInt(string)
{
    var match = string.match(/ab[0-9]$/);
    return match ? match[0] : '';
} 
```

如果`ab`是小写字符，则仅匹配字符串的结尾，并且如果末尾只有**一个**int，则匹配不区分大小写，添加`i`标志和/或添加 a`+`以匹配所有尾随数字：

```
/ab[0-9]+$/i 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T20:27:37.303

一种使用方式`replace`：

```
str.replace(/.*(ab\d+)$/, "$1"); 
```

另一种使用方式`match`：

```
(str.match(/ab\d+$/) || [""]).pop(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-14T20:27:57.933

```
var regex = /([a-zA-Z]{2}[0-9])$/;
var str = "sdfsadfsab2";
console.log(str.match(regex)[0]); //outputs "ab2" 
```

### 正则表达式的解释：

*   `[a-zA-Z]`- 小写和大写字母 az 的集合
*   `{2}`- 意思是“恰好重复 2 次”
*   `[0-9]`- 从 0 到 9 的数字集合
*   `$`- 意思是“字符串的结尾”

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-14T20:28:07.047

用于`$`匹配字符串的结尾：

```
'foo2'.match(/[a-z]{2}\d$/); 
```

# visual-studio-2010 - 打开场景图

> ID：14883427
> 
> 赞同：-2
> 
> 时间：2013-02-14T20:25:44.737
> 
> 标签：visual-studio-2010, openscenegraph

当我在 Visual stdio 2010 上构建开放场景图 2.8.5 库时，由于这两个错误，构建失败，我无法处理它们，

错误 192 错误 LNK1104：无法打开文件 'C:\Users\win\Desktop\another\OpenSceneGraph-2.8.5\open scene graph\bin\osgPlugins-2.8.5\osgdb_rgbd.dll' C:\Users\win\Desktop \another\OpenSceneGraph-2.8.5\open 场景图\src\osgPlugins\rgb\LINK Plugins rgb

错误 47 错误 LNK1104：无法打开文件 'C:\Users\win\Desktop\another\OpenSceneGraph-2.8.5\open scene graph\bin\osgPlugins-2.8.5\osgdb_plyd.dll' C:\Users\win\Desktop \another\OpenSceneGraph-2.8.5\open 场景图\src\osgPlugins\ply\LINK Plugins ply

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T02:11:44.110

听起来您需要回头看看为什么没有构建这两个二进制文件（osgdb_rgbd.dll 和 plyd.dll）。

# java - java：将二进制字符串转换为int

> ID：14883428
> 
> 赞同：9
> 
> 时间：2013-02-14T20:25:50.060
> 
> 标签：java, casting, binary

我正在尝试将几个二进制字符串转换回 int。但是它不会转换我所有的二进制字符串，给我留下一个**java.lang.NumberFormatException**异常。这是我的带有 3 个二进制字符串的测试代码：

```
public class Bin {

    public static void main(String argvs[]) {
            String binaryString ;
            binaryString = Integer.toBinaryString(~0);
            //binaryString = Integer.toBinaryString(~1);
            //binaryString = "1010" ;
            int base = 2;
            int decimal = Integer.parseInt(binaryString, base);
            System.out.println("INPUT=" + binaryString + " decimal=" + decimal) ;
    }
} 
```

如果我转换“1010”效果很好，但是当我尝试转换另外两个之一时，我得到了异常。有人可以向我解释这是为什么吗？

干杯

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-14T21:35:51.327

如上所述，Integer.toBinaryString() 将 ~0 和 ~1 转换为 unsigned int，因此它们将超过 Integer.MAX_VALUE。

您可以使用 long 来解析并转换回 int，如下所示。

```
int base = 2;
for (Integer num : new Integer[] {~0, ~1}) {
    String binaryString = Integer.toBinaryString(num);            
    Long decimal = Long.parseLong(binaryString, base);
    System.out.println("INPUT=" + binaryString + " decimal=" + decimal.intValue()) ;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-14T20:37:15.600

来自[http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Integer.html#toBinaryString(int)](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Integer.html#toBinaryString(int))：该`toBinaryString()`方法将其输入转换为“*无符号整数值的二进制表示如果参数为负，则参数加 2 ^(32)* "。

来自[http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Integer.html#parseInt(java.lang.String,%20int)](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Integer.html#parseInt(java.lang.String,%20int))：该`parseInt()`方法抛出`NumberFormatException`if "*所代表的值该字符串不是`int`*“类型的值。

注意`~0`和`~1`都是负数（分别为 -1 和 -2），因此将分别转换为 2 ^(32) -1 和 2 ^(32) -2 的二进制表示，两者都不能用 type 的值表示`int`，因此导致`NumberFormatException`你所看到的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-14T20:37:55.137

“~0”的位是 11111111111111111111111111111111（32 个 1）。通常，这表示数字 -1。“~1”的位是 11111111111111111111111111111110（31 个 1 后跟一个零）。通常，这表示数字 -2。

我尝试了“01111111111111111111111111111111”（0 和 31 个 1），它代表最高的有符号整数，`parseInt`没有错误。但是我试了“10000000000000000000000000000000”，代表最小有符号整数，又报错了。

该`parseInt`方法似乎期望输入中的“-”表示需要负数。看起来此方法正在检测整数中的溢出并抛出`NumberFormatException`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-04-30T11:01:09.247

在此处添加所有四种更新的方法和比较，以便于理解

```
public static void binary() {

    // Gives magnitude in binary along with sign for negative values
    System.out.println(Integer.toString(-1,2)); // -1
    // Give the int value of input binary representation along with sign
    System.out.println(Integer.parseInt(Integer.toString(-1, 2),2)); // -1

    // Gives signed binary representation of input value
    System.out.println(Integer.toBinaryString(-1)); // 11111111111111111111111111111111
    // Gives the integer value of signed binary number
    System.out.println(Integer.parseUnsignedInt(Integer.toBinaryString(-1), 2)); // -1
} 
```

# uiviewcontroller - UIModalPresentationCurrentContext - 未调用旋转方法

> ID：14883434
> 
> 赞同：6
> 
> 时间：2013-02-14T20:26:27.657
> 
> 标签：uiviewcontroller, rotation, transparent, uimodalpresentationstyle

我正在尝试使用 UIModalPresentationCurrentContext 在 VC 之上呈现 VC，以便查看其背后的视图。下面的代码有效：

```
UIViewController *transparentViewController = [[UIViewController alloc] init];
self.modalPresentationStyle = UIModalPresentationCurrentContext;
[self presentViewController:transparentViewController animated:NO completion:^{
}]; 
```

但是，当我在 VC 被推动后旋转设备时，旋转看起来完全一团糟。它不是干净地旋转而是尴尬地拉伸视图以适应新的方向。

此外，当我将 transparentViewController 子类化时，我发现它的 viewwillautorotate 方法没有被调用！（即使它以混乱的动画方式旋转）

UIModalPresentationCurrentContext 样式不是要旋转吗？有没有办法解决？有没有其他人遇到过这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T05:23:59.587

我认为这个问题与原始视图控制器无法旋转有关，因此您的模态视图控制器也被阻止旋转。为了解决这个问题，您可以使用该方法将原始`UIViewController`'s渲染`CALAyer`为 a 。然后，您可以将其放置在模态视图控制器中视图层次结构的底部。这将产生视图控制器看起来透明的效果，因为您在假静态图像中看到它背后的内容。然后，当旋转时，您可以手动应用 a以使背景保持在原位，而其顶部的内容可以自由旋转。`UIImage``renderInContext``UIImageView``UIViewController``CGAffineTransform``UIImageView`

# perl - perl中如何使类的成员成为对象

> ID：14883437
> 
> 赞同：1
> 
> 时间：2013-02-14T20:26:33.410
> 
> 标签：perl, oop

您好，基本上这是 perl 中的 OO 编程问题。我想要两个对象 A 和 B，并且 A 包含一个 B 类型的成员变量。我做了一些测试，但似乎它不起作用。任何的想法？

# 下午

```
package a;

sub new{
    my $self = {};
    my $b = shift;
    $self->{B} = $b;
    bless $self;
    return $self;
}

sub doa{
    my $self = shift;
    print "a\n";
    $self->{B}->dob;
}

1; 
```

# 下午

```
package b;

sub new {
    my $self = {};
    bless $self;
    return $self;
}

sub dob{
    my $self = shift;
    print "b\n";
} 

1; 
```

# 测试.pl

```
use a;
use b;

my $b = b->new;
my $a = a->new($b);
$a->doa; 
```

当我运行它时，它显示：

```
a
Can't locate object method "dob" via package "a" at a.pm line 16. 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-14T20:43:35.063

您忘记了该方法的第一个参数。方法的第一个参数始终是调用者。

```
sub new {
    my ($class, $b) = @_;
    my $self = {};
    $self->{B} = $b;
    return bless($self, $class);
} 
```

* * *

我通常是`bless`第一个，虽然

```
sub new {
    my ($class, ...) = @_;
    my $self = bless({}, $class);
    $self->{attribute} = ...;
    return $self;
} 
```

因为它更符合派生类的构造函数。

```
sub new {
    my ($class, ...) = @_;
    my $self = $class->SUPER::new(...);
    $self->{attribute} = ...;
    return $self;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-14T20:42:47.213

您可能希望通过使用[Moose](http://p3rl.org/Moose)或其较轻的表亲[Moo 之](http://p3rl.org/Moo)类的东西来使 Perl OO 更容易。您也可能喜欢（免费）[Modern Perl Book](http://www.onyxneon.com/books/modern_perl/index.html)，以了解更多现代 Perl 必须提供的许多新的和令人兴奋的东西！

```
#!/usr/bin/env perl

use strict;
use warnings;

package ClassA;

use Moo;

has 'b' => (
  is => 'ro',
  isa => sub { shift->isa('ClassB') or die "Need a ClassB\n" },  # not necessary but handy
  required => 1,
);

sub doa {
    my $self = shift;
    print "a\n";
    $self->b->dob;
}

package ClassB;

use Moo;

sub dob {
  my $self = shift;
  print "b\n";
}

package main;

my $b = ClassB->new;
my $a = ClassA->new( b => $b );
$a->doa; 
```

事实上，根据你想要的，也许你甚至可能想要像委托这样的东西：

```
#!/usr/bin/env perl

use strict;
use warnings;

package ClassA;

use Moo;

has 'b' => (
  is => 'ro',
  isa => sub { shift->isa('ClassB') or die "Need a ClassB\n" },  # not necessary but handy
  required => 1,
  handles => ['dob'],
);

sub doa {
    my $self = shift;
    print "a\n";
}

package ClassB;

use Moo;

sub dob {
  my $self = shift;
  print "b\n";
}

package main;

my $b = ClassB->new;
my $a = ClassA->new( b => $b );
$a->doa;
$a->dob; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-14T20:43:45.800

你没有正确地[祝福你的对象](http://perldoc.perl.org/functions/bless.html)。试试这个：

A：

```
sub new {                                                                                                                                                                                               
    my $class = shift;                                                                                                                                                                                 
    my $b = shift;                                                                                                                                                                                     
    return bless { B => $b }, $class;                                                                                                                                                                  
} 
```

乙：

```
sub new {
    my $class = shift;
    return bless {}, $class; 
} 
```

# ios - NSLayoutAttributeBaseline 和 NSLayoutAttributeBottom 有什么区别？

> ID：14883439
> 
> 赞同：16
> 
> 时间：2013-02-14T20:26:40.250
> 
> 标签：ios, objective-c, layout, constraints

Apple 文档有用地说明`NSLayoutAttributeBaseline`与“对象的基线”对齐。什么是基线？和底层有什么区别？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2013-02-14T20:37:07.363

基线适用于诸如`UILabel`. 基线将是大写字母底部出现的位置。对于大多数其他视图（如果不是所有其他视图），基线和底部是相同的。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2015-05-30T07:14:57.130

`NSLayoutAttributeBaseline` ![](../Images/11fc2126cc8832e25a5c2c0cdfa16c00.png)

`NSLayoutAttributeBottom` ![](../Images/33e6e95337d122aac9e79e1f56e8f250.png)

# javascript - 如何将 .js 文件中的 JavsScript 代码作为存储过程存储在 MongoDB 中

> ID：14883441
> 
> 赞同：1
> 
> 时间：2013-02-14T20:26:55.703
> 
> 标签：javascript, mongodb, stored-procedures

有几个关于如何在 MongoDB 中创建“存储过程”的示例（[这里是一个](http://pointbeing.net/weblog/2010/08/getting-started-with-stored-procedures-in-mongodb.html)），但它们只展示了如何直接添加代码，例如在 mongo shell 中。对于任何重要的存储过程，人们都希望将代码存储在 .js 文件中并将文件“导入”到 MongoDB 中。这样就可以轻松地对其进行编辑、版本控制等。

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T22:25:01.900

您可以使用以下语法：

```
$ mongo mydb import.js 
```

并在脚本中编写导入指令，即：

```
var myfunc = function(x, y){ return x + y; }}

db.system.js.save({_id:"myfunc", value: myfunc); 
```

# c# - jQuery 和 ASP.NET 从数据库下载文件

> ID：14883442
> 
> 赞同：2
> 
> 时间：2013-02-14T20:27:03.260
> 
> 标签：c#, jquery, asp.net, webforms

我查看了许多在线资源并构建了我的脚本，但它似乎仍然没有给我文件。它只是加载页面“client-home2.aspx/downloadAttachment”，而不是执行代码并交付文件。

这是我背后的代码：

```
 [WebMethod]
    public void downloadAttachment(string id)
    {

        DbProviderFactory dbf = DbProviderFactories.GetFactory();
        using (IDbConnection con = dbf.CreateConnection())
        {
            string sSQL;
            sSQL = "select top 1                " + ControlChars.CrLf
                 + " FILENAME, FILE_MIME_TYPE, ATTACHMENT" + ControlChars.CrLf
                 + "  from vwATTACHMENTS_CONTENT" + ControlChars.CrLf
                 + " where 1 = 1                    " + ControlChars.CrLf;
            //Debug.Print(sSQL);
            using (IDbCommand cmd = con.CreateCommand())
            {
                cmd.CommandText = sSQL;

                Sql.AppendParameter(cmd, id.ToString(), "ATTACHMENT_ID");

                cmd.CommandText += " order by DATE_ENTERED desc" + ControlChars.CrLf;

                using (DbDataAdapter da = dbf.CreateDataAdapter())
                {
                    ((IDbDataAdapter)da).SelectCommand = cmd;
                    using (DataTable dt = new DataTable())
                    {
                        da.Fill(dt);

                        if (dt.Rows.Count > 0)
                        {

                            foreach (DataRow r in dt.Rows)
                            {
                                string name = (string)r["FILENAME"];
                                string contentType = (string)r["FILE_MIME_TYPE"];
                                Byte[] data = (Byte[])r["ATTACHMENT"];

                                // Send the file to the browser
                                Response.AddHeader("Content-type", contentType);
                                Response.AddHeader("Content-Disposition", "attachment; filename=" + name);
                                Response.BinaryWrite(data);
                                Response.Flush();
                                Response.End();
                            }

                        }
                        else
                        {

                        }
                    }
                }
            }

        }

    } 
```

这是我的 jQuery：

```
$('.attachmentLink').click(function () {
    var id = $(this).attr('id');
    /*
    $.ajax({
    type: "POST",
    url: "client-home2.aspx/downloadAttachment",
    data: '{id:\'' + id + '\'}',
    contentType: "application/json; charset=utf-8",
    dataType: "json",
    success: function (msg) {
    //alert(msg.d);
    }
    });
    */
    $.download('client-home2.aspx/downloadAttachment', 'id=' + id);
    return false;
}); 
```

**我正在使用这个功能[http://filamentgroup.com/lab/jquery_plugin_for_requesting_ajax_like_file_downloads/](http://filamentgroup.com/lab/jquery_plugin_for_requesting_ajax_like_file_downloads/)**

问题是，它从来没有给我文件；它只是导航到`client-home2.aspx/downloadAttachment`.

如何解决此问题以便我可以下载文件？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T20:33:11.503

每个 WebMethod 调用只能发送一个 HTTP 响应。这意味着一次只有一个文件。使用`Response.End()`会阻止其他任何内容返回 Web 浏览器，并且可能会通过 foreach 循环第二次引发异常。解决这个问题的唯一方法是从您的 jQuery 代码中调用 WebMethod 20 次，并且有一个参数来知道如果查询中有多个结果，则每次返回哪个文件。即使这样也可能行不通。

但我怀疑你真的打算让那个 ID 字段只产生一条记录。在这种情况下，您需要注意两件事。第一个是 SqlCommand 类型在您更改`CommandText`属性时重置它的参数集合。因此，您需要在添加 ID 参数*之前*完成创建整个 sql 字符串文本。第二个是您的 ID 参数现在甚至都不重要，因为*您的 sql 代码从不引用该参数*。

我很犹豫是否发布此代码，因为还有其他可能是错误的东西，但这应该是对你所拥有的东西的改进。请注意，我最终也做了同样的工作，但*代码少了很多*：

```
[WebMethod]
public void downloadAttachment(string id)
{

    string SQL =
          "select top 1 FILENAME, FILE_MIME_TYPE, ATTACHMENT" + ControlChars.CrLf
        + "  FROM vwATTACHMENTS_CONTENT" + ControlChars.CrLf
        + " where ID = @ATTACHMENT_ID" + ControlChars.CrLf
        + " order by DATE_ENTERED desc";
    //Debug.Print(SQL);

    DbProviderFactory dbf = DbProviderFactories.GetFactory();
    using (IDbConnection con = dbf.CreateConnection())
    using (IDbCommand cmd = con.CreateCommand())
    {
        cmd.CommandText = SQL;
        Sql.AppendParameter(cmd, id, "ATTACHMENT_ID");

        using (IDataReader rdr = cmd.ExecuteReader())
        {
            if (rdr.Read())
            {
                // Send the file to the browser
                Response.AddHeader("Content-type", r["FILE_MIME_TYPE"].ToString());
                Response.AddHeader("Content-Disposition", "attachment; filename=" + r["FILENAME"].ToString());

                Response.BinaryWrite((Byte[])r["ATTACHMENT"]);

                Response.Flush();
                Context.ApplicationInstance.CompleteRequest();
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T20:37:35.107

这是我过去的做法，但我的做法不同：

看法：

```
foreach (var file in foo.Uploads)
  {
      <tr>
        <td>@Html.ActionLink(file.Filename ?? "(no filename)", "Download", "Upload", new { id = file.UploadId }, null)</td>
      </tr>
  } 
```

我的 UploadConroller 中的代码：

```
public ActionResult Download(Guid id)
{
    var upload = this.GetUpload(id);
    if (upload == null)
    {
        return NotFound();
    }

    return File(upload.Data, upload.ContentType, upload.Filename);
}

private Upload GetUpload(Guid id)
{
    return (from u in this.DB.Uploads
            where u.UploadId == id
            select u).SingleOrDefault();
} 
```

随意运送邪教，这很简单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T21:54:34.680

我想到了。我不得不制作一个单独的文件，因为标题已经被发送。因此，我的单独文件称为“downloadAttachment”，如下所示：

```
using System;
using System.Data;
using System.Data.Common;
using System.Configuration;
using System.Drawing;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Web.UI.HtmlControls;
using System.Xml;
using System.Globalization;
using System.Threading;
using System.Diagnostics;
using System.Net;
using System.Net.Mail;
using System.Data.SqlClient;
using System.Web.Services;
using System.Text;
using System.Web.Script.Services;
using System.Text.RegularExpressions;
using System.IO;

namespace SplendidCRM.WebForms
{
    public partial class downloadAttachment : System.Web.UI.Page
    {
        string HostedSite;
        protected DataView vwMain;

        protected void Page_Load(object sender, EventArgs e)
        {
            if (Sql.IsEmptyGuid(Security.USER_ID))
                Response.Redirect("~/Webforms/client-login.aspx");

            HostedSite = Sql.ToString(HttpContext.Current.Application["Config.hostedsite"]);

            string id = Request.QueryString["ID"].ToString();

            DbProviderFactory dbf = DbProviderFactories.GetFactory();
            using (IDbConnection con = dbf.CreateConnection())
            {
                string sSQL;
                sSQL = "select top 1                " + ControlChars.CrLf
                     + " FILENAME, FILE_MIME_TYPE, ATTACHMENT" + ControlChars.CrLf
                     + "  from vwATTACHMENTS_CONTENT" + ControlChars.CrLf
                     + " where 1 = 1                    " + ControlChars.CrLf;
                //Debug.Print(sSQL);
                using (IDbCommand cmd = con.CreateCommand())
                {
                    cmd.CommandText = sSQL;

                    Sql.AppendParameter(cmd, id.ToString(), "ATTACHMENT_ID");

                    cmd.CommandText += " order by DATE_ENTERED desc" + ControlChars.CrLf;

                    using (DbDataAdapter da = dbf.CreateDataAdapter())
                    {
                        ((IDbDataAdapter)da).SelectCommand = cmd;
                        using (DataTable dt = new DataTable())
                        {
                            da.Fill(dt);

                            if (dt.Rows.Count > 0)
                            {

                                foreach (DataRow r in dt.Rows)
                                {
                                    string name = (string)r["FILENAME"];
                                    string contentType = (string)r["FILE_MIME_TYPE"];
                                    Byte[] data = (Byte[])r["ATTACHMENT"];

                                    // Send the file to the browser
                                    Response.AddHeader("Content-type", contentType);
                                    Response.AddHeader("Content-Disposition", "attachment; filename=" + MakeValidFileName(name));
                                    Response.BinaryWrite(data);
                                    Response.Flush();
                                    Response.End();
                                }

                            }
                            else
                            {

                            }
                        }
                    }
                }

            }

        }

        public static string MakeValidFileName(string name)
        {
            string invalidChars = Regex.Escape(new string(System.IO.Path.GetInvalidFileNameChars()));
            string invalidReStr = string.Format(@"[{0}]+", invalidChars);
            string replace = Regex.Replace(name, invalidReStr, "_").Replace(";", "").Replace(",", "");
            return replace;
        }

    }
} 
```

# objective-c - NSView drawRect 和视网膜图像

> ID：14883443
> 
> 赞同：0
> 
> 时间：2013-02-14T20:27:08.787
> 
> 标签：objective-c, macos, cocoa, core-graphics

因为，我需要一些高级菜单栏项，所以我使用自定义 NSView 子类作为 menubaritem 的视图。

在 drawrect 中，我正在绘制一些简单的 nsimage，它适用于普通显示器，但在视网膜显示器上，它加载较小的图像（是的，我有 @2x 艺术品）。

代码：

```
 - (void)drawRect:(NSRect)dirtyRect
{

    [self.statusItem drawStatusBarBackgroundInRect:dirtyRect withHighlight:self.isHighlighted];
    [icon scalesWhenResized];
    icon = self.isHighlighted ? self.alternateImage : [images objectAtIndex:index];
    NSSize iconSize = [icon size];

    NSRect bounds = self.bounds;
    CGFloat iconX = roundf((NSWidth(bounds) - iconSize.width) / 2);
    CGFloat iconY = roundf((NSHeight(bounds) - iconSize.height) / 2);
    NSPoint iconPoint = NSMakePoint(iconX, iconY);
    [icon drawAtPoint:iconPoint fromRect:bounds operation:NSCompositeSourceOver fraction:1];
} 
```

我用 Quartz Debug 和真正的 Retina Macbook 对其进行了测试，除了菜单栏中的这个小图像外，一切都很好。

更新：

```
self.images = [NSArray arrayWithObjects:[NSImage imageNamed:@"1.png"],[NSImage imageNamed:@"2.png"],[NSImage imageNamed:@"3.png"],[NSImage imageNamed:@"4.png"],[NSImage imageNamed:@"5.png"],[NSImage imageNamed:@"6.png"],[NSImage imageNamed:@"7.png"],[NSImage imageNamed:@"8.png"],[NSImage imageNamed:@"9.png"],[NSImage imageNamed:@"10.png"],[NSImage imageNamed:@"11.png"],[NSImage imageNamed:@"12.png"],[NSImage imageNamed:@"13.png"],[NSImage imageNamed:@"14.png"],[NSImage imageNamed:@"15.png"],[NSImage imageNamed:@"16.png"],[NSImage imageNamed:@"17.png"],[NSImage imageNamed:@"18.png"],[NSImage imageNamed:@"19.png"],[NSImage imageNamed:@"20.png"],[NSImage imageNamed:@"21.png"],[NSImage imageNamed:@"22.png"],[NSImage imageNamed:@"23.png"],[NSImage imageNamed:@"24.png"],[NSImage imageNamed:@"25.png"],[NSImage imageNamed:@"26.png"],
                   nil]; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T13:16:42.040

这可能是在黑暗中拍摄的，但如果您正在加载带有扩展名的图像，请尝试删除它。

代替： `[NSImage imageNamed:@"icon.png"]`做`[NSImage imageNamed:@"icon"]`

Xcode 将“组合高分辨率艺术品”设置为“是”，这会将您的图像组合成 TIFF 文件。因此捆绑包中不存在 PNG 文件，因此未加载。

# javascript - Javascript：显示上次登录时间

> ID：14883445
> 
> 赞同：0
> 
> 时间：2013-02-14T20:27:21.073
> 
> 标签：javascript, login, user-profile

这里的集体思想能否将我指向一个 JavaScript 示例，其中用户上次登录的时间会显示在他们的个人资料中？

更新：我应该指出我正在使用 Node.js，服务器端 JavaScript。对不起，如果我不够清楚。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T20:54:57.820

你可以尝试这样的事情：

```
setCookie = function(name, value) {
   if(document.cookie.length > 0)
        document.cookie += "; ";
   document.cookie += name + ":" + value;
}

getCookie = function(name) {
   var cookies = document.cookie.split(";")
   for(var i in cookies)
       if(name === cookies[i].split(":")[0])
            return cookies[i].split(":")[1];
   return "";
}    

$(document).ready(function() {
  $(".lastLogin").html(getCookie("lastLogin"));
  setCookie("lastLogin",new Date());
}); 
```

# visual-studio-2010 - x86 汇编语言的代码自动完成

> ID：14883451
> 
> 赞同：2
> 
> 时间：2013-02-14T20:27:44.517
> 
> 标签：visual-studio-2010, assembly, masm

Visual Studio 是否支持 x86 汇编语言的代码自动完成？我发现自动完成在使用高级编程语言（如 Java 和 C++）时很有用，我想知道 Visual Studio 中的汇编语言是否有类似的功能（例如，键入`m`可以`mov`作为建议提供，和打字`j`将`j1`作为建议提供）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T21:10:51.260

据我所知，唯一为汇编语言提供自动完成功能的 IDE 是那些专门为汇编语言设计的。

**[RADASM](http://radasm.cherrytree.at/)**就是这种 IDE 的一个示例。

虽然，汇编自动完成的主要目标不是指令，（因为它们很短且易于输入）而是标签和其他标识符。

在大型装配项目中可能有数千个标签，因此该集合内的快速导航确实非常有用。

**[Fresh IDE](http://fresh.flatassembler.net)**中实现了最先进的自动完成引擎之一。

这是我的项目，但我认为我对这个估计没有偏见。

大多数程序集 IDE 使用固定的 API 标签列表，有时会扫描源文件以制作检测到的标签列表。他们被迫使用这些技巧，因为通常它们是通用 IDE，必须支持多种不同的汇编器和 HLL 编译器。

Fresh IDE 不同 - 它使用 FASM 汇编器运行真正的编译，以收集编译后由汇编器检测到的标识符集。这样，所有标签都可以正确检测，即使是在组装过程中由宏生成的标签，以及它们的值、类型和层次结构。

这种解决方案是被迫的，因为 FASM 具有非常复杂和灵活的宏系统，这使得任何其他检测机制都不可靠。

使用固定的 API 列表也是不可能的，因为 Fresh IDE 并不绑定到某个特定的 API，而是针对多个支持的操作系统甚至操作系统开发的应用程序编程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T20:37:43.657

我不知道这是否提供自动完成功能，但是为 X86 使用 REPL 怎么样？ [http://en.wikipedia.org/wiki/Read–eval–print_loop](http://en.wikipedia.org/wiki/Read%E2%80%93eval%E2%80%93print_loop)

GitHub上有一个 [https://github.com/rfw/ex86](https://github.com/rfw/ex86)

# c# - 在模型中保留一个计数器

> ID：14883453
> 
> 赞同：0
> 
> 时间：2013-02-14T20:27:54.973
> 
> 标签：c#, asp.net-mvc, entity-framework

我正在尝试创建一个投票/投票应用程序，并希望跟踪为这些选项所做的投票数量。当进行投票时，会传入一个 id 并根据 id - 计数器加一。但是当我投票时，它会将另一个计数器设置回一个。

```
 // ID of the option selected:
    public int VotedID { get; set; }

    Counters for the options:
    public int BlueCornerPercent { get; set; }
    public int RedCornerPercent { get; set; }

    // Snippet of code - here is where I increase the counters. theFight is an instance of the model/entity.
    public void HandleVotes(Fight fight)
    {

        // Get full fight details:
        Fight theFight = db.Fights.Find(fight.FightId);

        // Get fighters id's in fight:
        var f1 = (from l in theFight.Fighters
                  select l).First();

        var f2 = (from l in theFight.Fighters
                  select l).Last();

        if (theFight.VotedID == f1.FighterID)
        {
            theFight.BlueCornerPercent++;
            db.SaveChanges();
        }

        else if (theFight.VotedID == f2.FighterID)
        {
            theFight.RedCornerPercent++;
            db.SaveChanges();
        }
    } 
```

正如所见，我正在通过正在投票的“战斗”并从那里改变计数器......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T13:26:28.137

您可以尝试使用类似的东西：

```
 if (theFight.VotedID == f1.FighterID)
    {
        theFight.BlueCornerPercent++;
        db.Entry(theFight).Property(p => p.BlueCornerPercent).IsModified = true;
        db.Entry(theFight).Property(p => p.RedCornerPercent).IsModified = false;
        db.SaveChanges();
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T23:10:30.200

我找到了解决方案，我需要在我的视图中包含计数器的隐藏属性，以防止它们重置。

# php - 没有 ALT 属性的 IMG 标签在 PHP 中的负查找 preg_match_all

> ID：14883459
> 
> 赞同：0
> 
> 时间：2013-02-14T20:28:16.753
> 
> 标签：php, regex, html-parsing, preg-match-all, regex-negation

我正在尝试查找`img`不包含`alt`属性的标签，以便对其进行修复以进行 W3C 验证。

我正在尝试使用否定的环视语法：

```
preg_match_all('@<img[^>]*?(?!alt=)[^>]*>@', $text, $matches); 
```

不幸的是，它没有返回任何东西，而肯定有没有属性的`img`标签。`alt`

我认为问题出在负面查找中，但例如我使用了：

```
preg_match_all('@<img[^>]+?http:\/\/(?!mysite\.com)[^>]*?>@', $text, $matches); 
```

从外部资源搜索图像，它工作正常。

任何想法第一个表达式有什么问题？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T21:09:45.640

最后我找到了可行的解决方案：

```
preg_match_all('@<img(?:(?!alt=).)*?>@', $text, $matches); 
```

感谢您的贡献。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T20:52:14.900

使用前瞻语法适用于第一个语法

```
preg_match_all('@<img[^>]*?(?=alt=)[^>]*>@', $text, $matches); 
```

这里的 $matches 将只包含带有 alt 的 img。

```
<?php
$str = <<<EOF
<html>
  <body>
    hello
    <img src="withalt" alt="hi"/>asdf
    <img src="noalt" />
    <img src="withalt2" alt="blah" />
  </body>
</html>
EOF;

if (preg_match_all('@<img[^>]*?(?=alt=)[^>]*>@', $str, $matches)) {
   echo "matches\n";
   print_r($matches);
}

?> 
```

# jms - 将 replyTo 设置为 TMP 队列

> ID：14883460
> 
> 赞同：0
> 
> 时间：2013-02-14T20:28:18.570
> 
> 标签：jms, wso2esb

通过 ESB 仅执行基于 JMS 的消息传递。ESB 有一个专用的 REQUEST 队列，客户端在其中使用 SOAP 包装器发送服务请求。Wrapper 被解释为服务名称和版本、注册表查找、服务 QUEUE 的路由。服务在专用 ESB REPLY 队列上响应 ESB。然后需要关联以更正存储的请求，以在其 TMP 队列上将回复发送回客户端。我不知道如何使用服务 Sent Msg ID 作为键将原始 JMS 请求的 TMP 队列保存到某种缓存中，以便我可以检索原始请求消息 ID 和 TMP QUEUE？

所以两个问题。如何访问代理配置中的 jms msg 标头。如何设置某种缓存或存储用于响应的数据以将它们关联回请求并设置回复。文档中根本没有纯 JMS 示例。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T21:28:34.053

这或多或少是流动的吗？

```
CLIENT --> request-queue --> ESB --> service-queue --> SERVICE
then
SERVICE --> response-queue --> ESB --> tmp-queue --> CLIENT 
```

我提议：

1.  客户端调用[Session](http://docs.oracle.com/javaee/1.4/api/javax/jms/Session.html)。[创建临时队列](http://docs.oracle.com/javaee/1.4/api/javax/jms/Session.html#createTemporaryQueue%28%29)。返回的临时队列可以在使用同一连接时重复使用，因此这将是每个连接一次操作。
2.  [客户端发送请求，通过调用Message](http://docs.oracle.com/javaee/1.4/api/javax/jms/Message.html)将临时队列添加为回复目的地。[setJMSReplyTo](http://docs.oracle.com/javaee/1.4/api/javax/jms/Message.html#setJMSReplyTo%28javax.jms.Destination%29) (tempTopic)。
3.  ESB 接收请求，执行其注册操作并将请求转发到 SERVICE，再次将消息上的 JMSReplyTo 设置到客户端的临时队列。
4.  SERVICE 完成它的工作并将响应直接发送到消息 JMSReplyToHeader 中的目的地。（响应必须通过 ESB 返回的任何具体原因？）

所以流程实际上是：

```
CLIENT --> request-queue --> ESB --> service-queue --> SERVICE
then
SERVICE --> tmp-queue --> CLIENT 
```

我可以立即想到 2 个陷阱（并且按下，我相信我可以想出更多....）

*   SERVICE 在不同的代理上运行，不能直接发送到客户端的临时队列。

在这种情况下，让 ESB 维护以消息 ID 为键的客户端临时队列缓存。当 ESB 向服务发送请求时，将 JMSCorrelationId 标头设置为从客户端接收到的消息的 message-id。SERVICE 应该从它接收到的消息中读取 JMSCorrelationId，并将它添加到它发送回 ESB 的响应消息中。（还感到困惑吗？）现在 ESB 接收到来自 SERVICE 的响应，解包 JMSCorrelationId，查找相应的临时队列并在其上发送响应。

如果您的 CLIENT 始终可以提供唯一的客户端 ID，则不是通过 messageId 缓存临时队列，而是可以通过它来缓存临时队列（粒度较小）。您与 SERVICE 的合同从 JMSCorrelationId 切换到 client-id。不过，根据我的经验，对于请求-响应 JMS 服务来说，始终返回提供的相关 ID 被认为是礼貌的事情，其中​​作为任意标头......不是那么多。

# oracle - Oracle 闪回表重置

> ID：14883461
> 
> 赞同：1
> 
> 时间：2013-02-14T20:28:26.180
> 
> 标签：oracle, reset, flashback

如果表被用户重置，Oracle 中是否有办法检查 sql (pl/sql) 语句？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T21:00:05.577

数据字典中没有任何内容可以告诉您是否`FLASHBACK TABLE`曾经对表执行过操作。（或或取决于您的要求和特权）的`ROW_MOVEMENT`列将告诉您当前是否启用了行移动，这将允许某人执行. `DBA_TABLES``ALL_TABLES``USER_TABLES``FLASHBACK TABLE`

# sql-server - SQL Server Pivots...我可以显示一系列订单类型的最后五个订单吗

> ID：14883465
> 
> 赞同：5
> 
> 时间：2013-02-14T20:28:41.867
> 
> 标签：sql-server, tsql

我有下表：

```
create table myorders(ordertype char(1), orderdate datetime, orderid int) 
```

该表有以下数据：

```
insert into myorders(ordertype, orderdate, orderid) values('P', '2013-02-14 20:04:48:287', 11082360)
insert into myorders(ordertype, orderdate, orderid) values('P', '2013-02-14 20:02:40:407', 40087130)
insert into myorders(ordertype, orderdate, orderid) values('P', '2013-02-14 20:02:07:277', 7990558)
insert into myorders(ordertype, orderdate, orderid) values('C', '2013-02-14 19:58:46:097', 8225181)
insert into myorders(ordertype, orderdate, orderid) values('P', '2013-02-14 19:58:39:740', 40087129)
insert into myorders(ordertype, orderdate, orderid) values('C', '2013-02-14 19:57:33:063', 8225235)
insert into myorders(ordertype, orderdate, orderid) values('C', '2013-02-14 19:56:17:207', 8225233)
insert into myorders(ordertype, orderdate, orderid) values('C', '2013-02-14 19:54:50:630', 8225232)
insert into myorders(ordertype, orderdate, orderid) values('P', '2013-02-14 19:48:07:300', 11082337)
insert into myorders(ordertype, orderdate, orderid) values('P', '2013-02-14 19:47:49:997', 40087128)
insert into myorders(ordertype, orderdate, orderid) values('P', '2013-02-14 19:46:40:667', 40087127)
insert into myorders(ordertype, orderdate, orderid) values('C', '2013-02-14 19:45:32:550', 8225231)
insert into myorders(ordertype, orderdate, orderid) values('P', '2013-02-14 19:45:11:203', 11082326)
insert into myorders(ordertype, orderdate, orderid) values('C', '2013-02-14 19:44:57:990', 8225230)
insert into myorders(ordertype, orderdate, orderid) values('P', '2013-02-14 19:43:52:953', 40087126)
insert into myorders(ordertype, orderdate, orderid) values('C', '2013-02-14 19:43:20:853', 8225229)
insert into myorders(ordertype, orderdate, orderid) values('P', '2013-02-14 19:41:33:740', 11082319)
insert into myorders(ordertype, orderdate, orderid) values('C', '2013-02-14 19:41:19:853', 8225228)
insert into myorders(ordertype, orderdate, orderid) values('P', '2013-02-14 19:40:33:127', 40087125)
insert into myorders(ordertype, orderdate, orderid) values('P', '2013-02-14 19:40:25:537', 40087124) 
```

数据如下所示：

```
OrderType  OrderDate                    OrderId
--------   -----------------------      ---------
P      2013-02-14 20:04:48.287  11082360
P      2013-02-14 20:02:40.407  40087130
P      2013-02-14 20:02:07.277  7990558
C      2013-02-14 19:58:46.097  8225181
P      2013-02-14 19:58:39.740  40087129
C      2013-02-14 19:57:33.063  8225235
C      2013-02-14 19:56:17.207  8225233
C      2013-02-14 19:54:50.630  8225232
P      2013-02-14 19:48:07.300  11082337
P      2013-02-14 19:47:49.997  40087128
P      2013-02-14 19:46:40.667  40087127
C      2013-02-14 19:45:32.550  8225231
P      2013-02-14 19:45:11.203  11082326
C      2013-02-14 19:44:57.990  8225230
P      2013-02-14 19:43:52.953  40087126
C          2013-02-14 19:43:20.853  8225229
P      2013-02-14 19:41:33.740  11082319
C      2013-02-14 19:41:19.853  8225228
P      2013-02-14 19:40:33.127  40087125
P      2013-02-14 19:40:25.537  40087124 
```

我想旋转数据，使其看起来像这样：

```
C_LastFiveOrders  C_OrderDate                  P_LastFiveOrders P_OrderDate
----------------  -----------------------      ---------------- -----------------------
8225181           2013-02-14 19:58:46.097      11082360         2013-02-14 20:04:48.287
8225235           2013-02-14 19:57:33.063      40087130         2013-02-14 20:02:40.407
8225233           2013-02-14 19:56:17.207      7990558          2013-02-14 20:02:07.277
8225232           2013-02-14 19:54:50.630      40087129         2013-02-14 19:58:39.740
8225231           2013-02-14 19:45:32.550      11082337         2013-02-14 19:48:07.300 
```

请注意，订单按 orderdate 降序排列。

我希望能够添加额外的 OrderTypes。我还希望灵活地查看最后 x 个订单。在示例中，我正在查看最后五个订单。我希望能够查看最近的 10 或 20 个订单。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T20:47:41.147

有几种不同的方法可以执行此操作。

**使用 CASE 聚合：**您可以将聚合函数与`CASE`表达式一起使用：

```
select 
  max(case when ordertype = 'c' then orderid end) C_LASTFIVEORDERS,
  max(case when ordertype = 'c' then orderdate end) C_ORDERDATE,
  max(case when ordertype = 'p' then orderid end) P_LASTFIVEORDERS,
  max(case when ordertype = 'p' then orderdate end) P_ORDERDATE
from
(
  select orderid, ordertype, orderdate, rn
  from
  (
    select orderid, ordertype, orderdate,
      row_number() over(partition by ordertype
                        order by orderdate desc) rn
    from myorders
  ) src
  where rn <=5
) s
group by rn 
```

请参阅[SQL Fiddle with Demo](http://www.sqlfiddle.com/#!3/fe2b9/22)。

**多次加入：**您可以多次加入您的表：

```
;with cte as
(
  select orderid, ordertype, orderdate,
      row_number() over(partition by ordertype
                        order by orderdate desc) rn
  from myorders
)
select 
  c1.orderid C_LASTFIVEORDERS,
  c1.orderdate C_ORDERDATE,
  c2.orderid P_LASTFIVEORDERS,
  c2.orderdate P_ORDERDATE
from cte c1
left join cte c2
  on c1.rn = c2.rn
  and c2.ordertype = 'P'
where c1.rn <=5
  and c1.ordertype = 'C' 
```

请参阅[带有演示的 SQL Fiddle](http://www.sqlfiddle.com/#!3/fe2b9/26)

**静态枢轴：**

最后，您可以同时应用[`UNPIVOT`](http://msdn.microsoft.com/en-us/library/ms177410%28v=sql.105%29.aspx)和[`PIVOT`](http://msdn.microsoft.com/en-us/library/ms177410%28v=sql.105%29.aspx)函数来获得结果：

```
select C_LastFiveOrders, C_orderdate,
  P_LastFiveOrders, P_orderdate
from
(
  select rn,
    case 
      when col = 'orderid' then ordertype+'_LastFiveOrders'
      else ordertype+'_'+col end col_name,
    value
  from
  (
    select ordertype,
      convert(varchar(50), orderdate, 121) orderdate,
      cast(orderid as varchar(50)) orderid,
      row_number() over(partition by ordertype 
                        order by orderdate desc) rn
    from myorders 
  )src
  unpivot
  (
    value
    for col in (orderdate, orderid)
  ) un
  where rn <= 5
) s
pivot
(
  max(value)
  for col_name in (C_LastFiveOrders, C_orderdate,
                   P_LastFiveOrders, P_orderdate) 
) piv 
```

请参阅[SQL Fiddle with Demo](http://www.sqlfiddle.com/#!3/fe2b9/14)。

**动态枢轴：**

如果您的`OrderType`值未知，则可以使用动态 SQL：

```
DECLARE @cols AS NVARCHAR(MAX),
    @colsName AS NVARCHAR(MAX),
    @query  AS NVARCHAR(MAX)

select @cols = STUFF((SELECT distinct ',' + QUOTENAME(ordertype +c.col) 
                      from myorders
                      cross apply 
                      (
                        select '_LastFiveOrders' col
                        union all
                        select '_OrderDate'
                      ) c
            FOR XML PATH(''), TYPE
            ).value('.', 'NVARCHAR(MAX)') 
        ,1,1,'')

set @query 
  = 'SELECT ' + @cols + ' 
     from 
     (
      select rn,
        case 
          when col = ''orderid'' then ordertype+''_LastFiveOrders''
          else ordertype+''_''+col end col_name,
        value
      from
      (
        select ordertype,
          convert(varchar(50), orderdate, 121) orderdate,
          cast(orderid as varchar(50)) orderid,
          row_number() over(partition by ordertype 
                            order by orderdate desc) rn
        from myorders 
      )src
      unpivot
      (
        value
        for col in (orderdate, orderid)
      ) un
      where rn <= 5
     ) s
     pivot 
     (
       max(value)
       for col_name in (' + @cols + ')
     ) p 
     '

execute(@query) 
```

请参阅[带有演示的 SQL Fiddle](http://www.sqlfiddle.com/#!3/fe2b9/17)

所有查询都会给出结果：

```
| C_LASTFIVEORDERS |             C_ORDERDATE | P_LASTFIVEORDERS |             P_ORDERDATE |
-------------------------------------------------------------------------------------------
|          8225181 | 2013-02-14 19:58:46.097 |         11082360 | 2013-02-14 20:04:48.287 |
|          8225235 | 2013-02-14 19:57:33.063 |         40087130 | 2013-02-14 20:02:40.407 |
|          8225233 | 2013-02-14 19:56:17.207 |          7990558 | 2013-02-14 20:02:07.277 |
|          8225232 | 2013-02-14 19:54:50.630 |         40087129 | 2013-02-14 19:58:39.740 |
|          8225231 | 2013-02-14 19:45:32.550 |         11082337 | 2013-02-14 19:48:07.300 | 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T20:49:30.407

这可能有效：

```
;WITH myorders_CTE AS
  (
  SELECT ordertype, orderdate, orderid,
    row_number() over (partition BY ordertype ORDER BY orderdate DESC) AS sequence
  FROM myorders
  )

SELECT c.orderid AS C_LastFiveOrders, c.orderdate AS C_OrderDate,
  p.orderid AS P_LastFiveOrders, p.orderdate AS P_OrderDate
FROM myorders_CTE c
JOIN myorders_CTE p ON c.sequence = p.sequence
WHERE c.ordertype = 'C'
  AND p.ordertype = 'P'
  AND c.sequence <= 5
  AND p.sequence <= 5
ORDER BY c.sequence 
```

它使用自联接，但不使用 PIVOT。

# r - CRAN 扩展手册中的 url

> ID：14883466
> 
> 赞同：2
> 
> 时间：2013-02-14T20:28:47.157
> 
> 标签：r, package, cran

关于 CRAN 手册的美学问题。您如何使`Description`字段中的 url 变为红色并在单击时起作用（如`URL`字段中的第一个 url）？手册中唯一显示为红色的是第一个`URL`字段中的第一个 url，并且某些链接（例如`BugReports`字段中）不起作用。

这是我的描述（切碎）：

```
Package: package
Type: Package
Title: stuff
Version: 0.2.1
Date: 2012-05-09
Author: me
Maintainer: bob <bob@gmail.com>
Depends:
    R (>= 2.15),
Imports:
    gridExtra
Suggests:
    plyr
LazyData: TRUE
Description: This package is awesome.
Note: qdap is not compiled for Mac users.  Installation instructions for Mac
    user or other OS users having difficulty installing qdap please visit:
    http://trinker.github.com/qdap_install/installation
License: GPL-2
URL: http://trinker.github.com/qdap/ https://github.com/trinker/qdap
BugReports: https://github.com/trinker/qdap/issues
Collate:
    'adjacency_matrix.R' 
```

和手册： [https ://dl.dropbox.com/u/61803503/qdap.pdf](https://dl.dropbox.com/u/61803503/qdap.pdf)

# javascript - Javascript / NodeJs 不同的异步函数导致一个大的 json 文件

> ID：14883472
> 
> 赞同：0
> 
> 时间：2013-02-14T20:29:03.430
> 
> 标签：javascript, arrays, json, node.js, asynchronous

我根本想不通。我有一个包含文件的文件夹。我想用这些文件的信息创建一个 json。准确地说是文件名、文件名的正则表达式版本以及我从 ajax 调用中获得的其他数据。

各个部分工作完美。事实上，如果我同步运行我的代码，我会得到我想要的结果。像这样的东西：

```
 [
          { 
              "filename" : "first file",
              "regexname" : "first file",
              "ajaxresult" : "first file"
          },
          { 
              "filename" : "second file",
              "regexname" : "second file",
              "ajaxresult" : "second file"
          },
 ] 
```

但是我想异步执行它，因为我使用的 XHR 模块在尝试“同步”执行所有操作时无法正常工作，而且它当然会阻塞，尤其是在处理大量文件时。我的“同步”代码看起来像这样（稍微简化以使其更短）

```
 fs.readdir(datapath, function(err, files) { 
    var data = new Array();
        if(err) throw err;
        files.forEach(function(file){
            var filename = file
            , regex= filename.replace(/regex/)/i, "")
            , filepath = './public/config/dataconfig.js'
            , ajaxResults = getFile(url)
            , mapFiles = null

        mapFiles = { filename:filename, regexname:regex, ajaxcall:ajaxResults}
        data[data.length] = mapfiles;
    }
    var JSONdata= JSON.stringify(data, null, 4);
    fs.writeFile(filepath, JSONdata, function(e) {
        if (!e) {
            console.log('Done')
        }else{ 
            console.log('Failed', e)   
        };
    });
 }); 
```

我尝试将 ajaxcall 包装在一个承诺中，但我在承诺中丢失了文件名和正则表达式名。像这样：

```
 fs.readdir(datapath, function(err, files) { 
    var data = new Array();
        if(err) throw err;
        files.forEach(function(file){
            var filename = file
            , regex= filename.replace(/regex/)/i, "")
            , filepath = './public/config/dataconfig.js'
            , mapFiles = null

        // Make promise for async call with a url composed of the regex
        var promise = getFile(url);
        promise.then( function(result) {
             mapFiles = { filename:filename, regexname:regex, ajaxcall:result}
             data[data.length] = mapfiles;
                 var JSONdata= JSON.stringify(data, null, 4);
                 fs.writeFile(filepath, JSONdata, function(e) {
                    if (!e) {
                          console.log('Done')
                     }else{ 
                          console.log('Failed', e)   
                     };
                  });
            }); 
  }); 
```

这给了我以下结果：

```
 [
          { 
              "filename" : "first file",
              "regexname" : "first file",
              "ajaxresult" : "first file"
          },
          { 
              "filename" : "first file",
              "regexname" : "first file",
              "ajaxresult" : "second file"
          },
 ] 
```

所以我最后的想法是为节点使用类似异步模块的东西。在我从函数返回回调后编写 json。但我也无法让它发挥作用。

提前致谢！

**[编辑-我忘了提]**

我忘了提到的是 AjaxCall url 是用正则表达式构建的。所以是这样的：

```
 url = 'http://www.test.com/'+regex 
```

所以这（如我所见）意味着我在调用 ajaxcall 之前执行正则表达式，但在调用之后我还需要正则表达式以写入 Json。我希望这是有道理的

**[编辑 2 - 更多信息]**

我的 XHR 调用看起来像这样（没有我错误的承诺解决方案。在这种情况下，我返回承诺的结果）：

```
// Get info
function getFile(url) { 
    xhr = new XMLHttpRequest(); 
    xhr.open("GET", url); 
    xhr.onreadystatechange = handler
    var ajaxResult = null
    //Callback
    function handler (){
        // If status is ready
        if (this.readyState == 4 && this.status == 200) {
            ajaxResult = eval(this.responseText);
            console.log('XHR OK')
        };
    };
    xhr.send(null);
    return ajaxResult[0];
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:46:02.343

正如您所提到的，这是一个使用[async](http://github.com/caolan/async)的快速示例：

```
doStuffWithFiles('folder', 'output.json', function () {
  console.log('Done!');
});

function doStuffWithFiles (dirPath, outputFilePath, callback) {
  fs.readdir(dirPath, function (error, files) {
    async.map(
      files,
      function (file, callback) {
        doAjaxStuff(file, function (error, ajaxResults) {
          callback(null, {
            filename:    file,
            regexStuff:  file.replace(/stuff/, ''),
            ajaxResults: ajaxResults
          });
        });
      },
      function (error, results) {
        var data = JSON.stringify(results);
        fs.writeFile(outputFilePath, data, function (error) {
          callback();
        });
      }
    );
  });
} 
```

关键部分`async.map`就像[标准`map`函数](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/map)一样，除了它要求您将结果作为参数返回给传递给您的第一个函数的回调。一旦所有回调都返回，`async.map`调用第二个函数，将结果列表传递给它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T08:21:08.323

基于 Promise 的解决方案可以正常工作，可能如下所示：

```
readdir(datapath).map(function (file) {
  return getFile(url)(function (ajaxresult) {
    return writeFile('./public/config/dataconfig.js', JSON.stringifiy({
      filename: file,
      regexname: file.replace(/regex/i, ""),
      ajaxcall: ajaxResult
    }, null, 4));
  });
}).end(function () {
  console.log("All done");
}, function (e) {
  console.log("Failed", e);
}); 
```

在这个例子中，我使用了[延迟](https://github.com/medikoo/deferred)承诺实现，为了让它工作，你需要确保所有异步函数都返回承诺。使用 deferred.promisify 可以轻松转换典型的回调函数：

```
var promisify = require('deferred').promisify;
var readdir = promisify(fs.readdir);
var writeFile = promisify(fs.writeFile); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T20:38:31.743

如果您的问题是获取文件名和正则表达式，如何将它们绑定到您的回调，例如

```
var callback = function(result) {
         mapFiles = { filename:this.filename, regexname:this.regex, ajaxcall:result}
         data[data.length] = mapfiles;
             var JSONdata= JSON.stringify(data, null, 4);
             fs.writeFile(filepath, JSONdata, function(e) {
                if (!e) {
                 console.log('Done')
                 }else{ 
                  console.log('Failed', e)   
                 };
              } 
```

然后

```
promise.then(callback.bind({'filename':filename,'regex':regex})) 
```

# java - object.notify() 不会唤醒 object.wait()

> ID：14883475
> 
> 赞同：1
> 
> 时间：2013-02-14T20:29:13.083
> 
> 标签：java, multithreading

我正在尝试让用户 ' `synchronized(object) {object.wait()}`' 暂停我的服务器，直到对象准备好。我`synchronized(object) {object.notify() }`在类中调用了“”，它将设置对象值。但似乎我的服务器在`wait()`.

```
public class MyServer {
...
do {
            try {

                message = (String) in.readObject();
                System.out.println("server receive>" + message);

                synchronized (myServerSend) {
                    myServerSend.wait();
                }

                System.out.println("Am I wake up???"); //this never print out

                sendMessage(myServerSend);

            } catch (ClassNotFoundException classnot) {
                System.err.println("Data received in unknown format");
            }
        } while (!message.equals("bye"));

    } catch (IOException ioException) {
        ioException.printStackTrace();
    }
....
} 
```

这是我设置对象值的要求

```
public class Action implements MouseInputListener, MouseMotionListener {

    ....

    public void mouseClicked(MouseEvent e) {

        if (SwingUtilities.isLeftMouseButton(e)) {...
    }

        else {
            ....
            if(MyGame.currentPlayer == MyGame.WHITE) {
                    myServerSend = "" + chosenPieceIndex + "," + moveLocationIndex;
                    synchronized (myServerSend) {

                        myServerSend.notify(); // this seems like fail to wake up myServer

                    }
                    System.out.println(myServerSend);
} 
```

如果我将 myServerSend 声明为公共静态字符串类型会不会有问题？有人可以帮忙吗？提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T20:38:55.363

也许你在等待之前得到了通知代码。出于这个原因，您应该始终将 thread.wait() 放在 while 循环中（也由于虚假唤醒 - 但出于这个原因，while 就足够了）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T21:22:14.850

如果没有看到所有代码，很难给出明确的答案，但问题可能出在此处：

```
myServerSend = "" + chosenPieceIndex + "," + moveLocationIndex;
synchronized (myServerSend) {
    myServerSend.notify(); // this seems like fail to wake up myServer
} 
```

您确定这个对象 (myServerSend) 确实与 MyServer.myServerSend 对象相同吗？看起来 myServerSend 是在 Action 类中创建的，从您描述的预期顺序是 MyServer 然后是 Action，但正如我所说，myServerSend 似乎是在 MyServer 中创建的。

换句话说，如果事件的顺序应该是 MyServer 然后是 Action 我会期望锁定对象在两者之外创建，或者在 MyServer 类中创建。

因此，我猜测我会说您没有在同一个对象上同步，如果这是真的，它将解释您所看到的行为。

但是，如果您确定这是同一个对象，那么事件的顺序**必须**是 Action，然后是 MyServer（或者您会在 MyServer 中获得 NullPointerException），如果是这样，我猜您是在通知您之前等待，因此您的代码将永远停留在等待点，等待它已经错过的通知。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T20:48:21.443

虽然我不确定您编写的代码到底有什么问题，但代码本质上是不安全的。如果没有别的，就不能保证调用`wait()`发生在之前`notify()`——如果先发生通知，则等待将永远持续。此外，[等待可能会被虚假唤醒](http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html#wait%28%29)，因此即使您修复了该问题，您仍然不会有正确的代码：

> 线程也可以在没有被通知、中断或超时的情况下唤醒，即所谓的虚假唤醒。虽然这在实践中很少发生，但应用程序必须通过测试应该导致线程被唤醒的条件来防范它，如果条件不满足则继续等待。换句话说，等待应该总是在循环中发生，就像这样：
> 
> ```
>  synchronized (obj) {
>      while (<condition does not hold>)
>          obj.wait(timeout);
>      ... // Perform action appropriate to condition
>  } 
> ```

您可能会考虑用[CountDownLatch](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/CountDownLatch.html)、[CyclicBarrier](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/CyclicBarrier.html)甚至是[Semaphore](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/Semaphore.html)替换此代码。这些类都更容易使用并且更不容易出错。 `wait`/`notify`级别较低，并且更难正确使用。

# javascript - 从其他控制器调用指令控制器中的方法

> ID：14883476
> 
> 赞同：118
> 
> 时间：2013-02-14T20:29:16.177
> 
> 标签：javascript, jquery, angularjs, angularjs-directive

我有一个指令，它有自己的控制器。请参阅以下代码：

```
var popdown = angular.module('xModules',[]);

popdown.directive('popdown', function () {
    var PopdownController = function ($scope) {
        this.scope = $scope;
    }

    PopdownController.prototype = {
        show:function (message, type) {
            this.scope.message = message;
            this.scope.type = type;
        },

        hide:function () {
            this.scope.message = '';
            this.scope.type = '';
        }
    }

    var linkFn = function (scope, lElement, attrs, controller) {

    };

    return {
        controller: PopdownController,
        link: linkFn,
        replace: true,
        templateUrl: './partials/modules/popdown.html'
    }

}); 
```

这是一个错误/通知/警告的通知系统。我想要做的是从另一个控制器（不是指令控制器）调用`show`这个控制器上的函数。当我这样做时，我还希望我的链接函数能够检测到某些属性发生了变化并执行一些动画。

这是一些代码来举例说明我的要求：

```
var app = angular.module('app', ['RestService']);

app.controller('IndexController', function($scope, RestService) {
    var result = RestService.query();

    if(result.error) {
        popdown.notify(error.message, 'error');
    }
}); 
```

所以在指令控制器上调用`show`时`popdown`，链接函数也应该被触发并执行动画。我怎么能做到这一点？

* * *

## 回答 #1

> 赞同：167
> 
> 时间：2013-02-14T21:46:58.447

这是一个有趣的问题，我开始思考如何实现这样的事情。

我想出了[这个（小提琴）](http://jsfiddle.net/9KX3k/1/)；

基本上，我没有尝试从控制器调用指令，而是创建了一个模块来容纳所有弹出逻辑：

```
var PopdownModule = angular.module('Popdown', []); 
```

我在模块中放了两件事，一个`factory`用于可以在任何地方注入的 API ，另一个`directive`用于定义实际弹出元素的行为：

工厂只定义了几个函数`success`并`error`跟踪几个变量：

```
PopdownModule.factory('PopdownAPI', function() {
    return {
        status: null,
        message: null,
        success: function(msg) {
            this.status = 'success';
            this.message = msg;
        },
        error: function(msg) {
            this.status = 'error';
            this.message = msg;
        },
        clear: function() {
            this.status = null;
            this.message = null;
        }
    }
}); 
```

该指令将 API 注入其控制器，并监视 api 的变化（为了方便，我使用引导 css）：

```
PopdownModule.directive('popdown', function() {
    return {
        restrict: 'E',
        scope: {},
        replace: true,
        controller: function($scope, PopdownAPI) {
            $scope.show = false;
            $scope.api = PopdownAPI;

            $scope.$watch('api.status', toggledisplay)
            $scope.$watch('api.message', toggledisplay)

            $scope.hide = function() {
                $scope.show = false;
                $scope.api.clear();
            };

            function toggledisplay() {
                $scope.show = !!($scope.api.status && $scope.api.message);               
            }
        },
        template: '<div class="alert alert-{{api.status}}" ng-show="show">' +
                  '  <button type="button" class="close" ng-click="hide()">&times;</button>' +
                  '  {{api.message}}' +
                  '</div>'
    }
}) 
```

然后我定义了一个`app`依赖于的模块`Popdown`：

```
var app = angular.module('app', ['Popdown']);

app.controller('main', function($scope, PopdownAPI) {
    $scope.success = function(msg) { PopdownAPI.success(msg); }
    $scope.error   = function(msg) { PopdownAPI.error(msg); }
}); 
```

HTML 看起来像：

```
<html ng-app="app">
    <body ng-controller="main">
        <popdown></popdown>
        <a class="btn" ng-click="success('I am a success!')">Succeed</a>
        <a class="btn" ng-click="error('Alas, I am a failure!')">Fail</a>
    </body>
</html> 
```

我不确定它是否完全理想，但这似乎是一种与 global-ish popdown 指令建立通信的合理方式。

再次，作为参考，[fiddle](http://jsfiddle.net/9KX3k/1/)。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2013-02-28T05:26:16.193

您还可以使用事件来触发 Popdown。

[这是一个](http://jsfiddle.net/LWBsV/5/)基于 satchmorun 解决方案的小提琴。它省去了 PopdownAPI，而顶层控制器则`$broadcast`在作用域链中传递“成功”和“错误”事件：

```
$scope.success = function(msg) { $scope.$broadcast('success', msg); };
$scope.error   = function(msg) { $scope.$broadcast('error', msg); }; 
```

Popdown 模块然后为这些事件注册处理函数，例如：

```
$scope.$on('success', function(event, msg) {
    $scope.status = 'success';
    $scope.message = msg;
    $scope.toggleDisplay();
}); 
```

至少这是可行的，在我看来，这是一个很好的解耦解决方案。如果由于某种原因这被认为是不好的做法，我会让其他人加入。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2013-09-04T13:20:13.910

您还可以将指令的控制器公开给父范围，就像`ngForm`使用`name`属性一样：[http ://docs.angularjs.org/api/ng.directive:ngForm](http://docs.angularjs.org/api/ng.directive:ngForm)

在这里您可以找到一个非常基本的示例如何实现它[http://plnkr.co/edit/Ps8OXrfpnePFvvdFgYJf?p=preview](http://plnkr.co/edit/Ps8OXrfpnePFvvdFgYJf?p=preview)

在此示例中，我`myDirective`使用带有`$clear`方法的专用控制器（指令的一种非常简单的公共 API）。我可以将此控制器发布到父范围并在指令之外使用调用此方法。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-10-20T13:21:27.837

我得到了更好的解决方案。

这是我的指令，我在指令中注入了对象引用，并通过在指令代码中添加调用函数来扩展它。

```
app.directive('myDirective', function () {
    return {
        restrict: 'E',
        scope: {
        /*The object that passed from the cntroller*/
        objectToInject: '=',
        },
        templateUrl: 'templates/myTemplate.html',

        link: function ($scope, element, attrs) {
            /*This method will be called whet the 'objectToInject' value is changes*/
            $scope.$watch('objectToInject', function (value) {
                /*Checking if the given value is not undefined*/
                if(value){
                $scope.Obj = value;
                    /*Injecting the Method*/
                    $scope.Obj.invoke = function(){
                        //Do something
                    }
                }    
            });
        }
    };
}); 
```

在 HTML 中使用参数声明指令：

```
<my-directive object-to-inject="injectedObject"></ my-directive> 
```

我的控制器：

```
app.controller("myController", ['$scope', function ($scope) {
   // object must be empty initialize,so it can be appended
    $scope.injectedObject = {};

    // now i can directly calling invoke function from here 
     $scope.injectedObject.invoke();
}]; 
```

# php - Wordpress - 基于分类选择的条件元框

> ID：14883479
> 
> 赞同：0
> 
> 时间：2013-02-14T20:29:32.193
> 
> 标签：php, wordpress, conditional, custom-taxonomy

我创建了一个自定义帖子类型，其中包含用于设置的自定义元框和该帖子类型的自定义分类类型。现在我正在寻找（即通过 jQuery）根据选择的分类法显示某些元框（每个分类法都有不同的选项需要填写）

关于解决此问题的最佳方法或什至可能的任何建议？

我已经完成了大部分工作，我只需要根据所选的分类有条件地显示（a）特定的元框。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T21:21:17.697

因此，整个目标是为选择不同的分类法显示自定义元框（每个分类法显示具有不同选项的不同元框）。似乎目前还没有办法动态地实现这一点，所以唯一的解决方案就是这个。

1.  为functions.php中的每个分类法编写各种元框
2.  将要隐藏的框分配给某个类以显示：无，并在检查与元框 id 匹配的分类法的 slug 时，显示该框。

在将 JS 注入到 Wordpress 后端以获取特定的内容帖子类型/页面时，这也提供了丰富的信息。 [https://wordpress.stackexchange.com/questions/1058/loading-external-scripts-in-admin-but-only-for-a-specific-post-type](https://wordpress.stackexchange.com/questions/1058/loading-external-scripts-in-admin-but-only-for-a-specific-post-type)

**回答**。

# java - 如何使用 jdbc 在 mysql 中动态传递表名？

> ID：14883483
> 
> 赞同：0
> 
> 时间：2013-02-14T20:29:58.750
> 
> 标签：java, mysql, sql, jdbc

```
String query = "SELECT SUM(totalcost) FROM"+m+""; //where totalcost is my column name

    ResultSet rs=st.executeQuery(query);                  

    while(rs.next())
    {

    System.out.println("SUM(user_id)="+rs.getString(1));                              

    } 
```

这段代码有什么问题？我的例外是：

**com.mysql.jdbc.exceptions.MySQLSyntaxErrorException：“字段列表”中的未知列“总成本”**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T20:40:44.157

`from`尝试在标签后添加一个空格；

```
String query = "SELECT SUM(totalcost) FROM "+m+""; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T20:35:12.270

您能否确认您正在引用的表在数据库中有一个名为“totalcost”的列？如果是这样，我认为当您替换“m”变量时表名可能不正确。

另外，我会使用准备好的语句来构建 MySQL 查询。如果您需要更多帮助，请告诉我。

您无需担心在查询的 SUM(totalcost) 部分使用“AS totalcost”，因为在选择结果时，您选择的是：“rs.getString(1)”，它将在第一个返回值结果集中行的列。

# ios - ios - 执行来自我的联系人的呼叫

> ID：14883484
> 
> 赞同：0
> 
> 时间：2013-02-14T20:30:00.977
> 
> 标签：ios, iphone

我想知道是否可以通过我的应用程序从我的联系人中执行呼叫？我想要做的是执行一个包含“#”的电话。我知道 Apple 不允许这样说 @"tel://#1234"。但是，我想知道如果用户电话上已经存在联系人，是否有解决方法，并让他们从那里执行呼​​叫。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:44:44.190

如您所知，Apple 不会让您使用 URL 方案这样做。我相信你可以做这样的事情的唯一方法是使用地址簿 UI 框架（特别是[ABPersionViewController](http://developer.apple.com/library/ios/#documentation/AddressBookUI/Reference/ABPersonViewController_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40007076)）在你自己的视图中显示一个联系人。查看 Apple 提供的[地址簿编程指南](http://developer.apple.com/library/ios/#documentation/ContactData/Conceptual/AddressBookProgrammingGuideforiPhone/Chapters/UI_Controllers.html#//apple_ref/doc/uid/TP40007744-CH5-SW1)。

确保设置`allowsActions`为 true 以启用呼叫/文本按钮。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T22:31:20.850

这有点小技巧，但如果您在 IB 中选择“检测”下的“电话号码”复选框，UITextView 将突出显示电话号码。这将使电话号码可点击，并且他们将发起电话呼叫（在 iPhone 上）。您可以将 UITextView（只读）合并到自定义表格单元格中——假设您使用表格视图来显示您的联系人。样式可能是一个问题，因为我认为没有办法更改突出显示颜色或删除下划线，但是，这将使您能够从联系人的表格视图发起呼叫。

![在此处输入图像描述](../Images/13198ea13b641233be7351e1e888f47a.png)

# tomcat - solr 3.6 可以与 tomcat 6 一起正常工作吗

> ID：14883492
> 
> 赞同：1
> 
> 时间：2013-02-14T20:30:34.740
> 
> 标签：tomcat, solr

在 tomcat 6 启动后（页面`http://localhost:8080`显示 tomcat 起始页）我在 .../example 目录中调用 java -jar start.jar 。该命令执行良好，没有任何异常，但是当我尝试打开页面时`http://localhost:8080/solr/`，出现 404 异常。我应该怎么做才能解决这个问题？

Ps 我使用[本教程](http://lucene.apache.org/solr/api-3_6_2/doc-files/tutorial.html)来设置 solr。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T20:41:30.593

您正在尝试使用 tomcat 和`java -jar star.jar`. 这听起来不对。你应该做其中之一。在tomcat中安装`war`文件将使用tomcat进行安装。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T20:41:31.443

在该教程中，它看起来像是`java -jar start.jar`使用嵌入式 Jetty 服务器。运行该命令时的输出是什么？它应该告诉您应用程序正在侦听的端口。

如果输出是，`2012-03-27 17:11:32.343:INFO::Started SocketConnector@0.0.0.0:8983`那么您希望将浏览器指向`localhost:8983`.

# wordpress - get_metadata WordPress 功能不起作用

> ID：14883494
> 
> 赞同：-1
> 
> 时间：2013-02-14T20:30:53.987
> 
> 标签：wordpress

```
$transactions = get_metadata( 'post', '', '_pfund_transactions' ); 
```

不知道我做错了什么。我指定了类型和密钥。我也将对象 ID 留空，因为我不确定应该去那里。

这是 meta_value 字段中涉及的数据的示例。

```
a:6:{s:7:"success";s:1:"1";s:6:"amount";s:1:"1";s:11:"donor_email";s:16:"test@test.com";s:16:"donor_first_name";s:4:"adsf";s:15:"donor_last_name";s:3:"dfs";s:17:"transaction_nonce";s:22:"xxxxxx";} 
```

结果似乎为空，因为以下陈述为真

```
if (! empty( $transactions ) ) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T20:22:22.850

帖子 ID 应用作对象 ID。此外，看起来您想要倍数，因此您应该将第四个参数作为 false 传递。

IE; $transactions = get_metadata('post', $post_id, '_pfund_transactions', false);

试试看！

# html - 防止单个单词在 css/html 中环绕浮动

> ID：14883495
> 
> 赞同：5
> 
> 时间：2013-02-14T20:31:01.870
> 
> 标签：html, css, css-float, word-wrap

有什么方法可以防止一个或两个单词环绕浮点数，但如果有更多文本则允许它？这是一个示例，其中第一个文本有问题，但第二个文本很好。

[http://jsfiddle.net/wdPCp/](http://jsfiddle.net/wdPCp/)

```
<div class="wrapper">
<img src="http://lorempixel.com/100/100/animals" />
<div class="text">Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut <span class="last-bit">labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation</span></div>
</div>

<div class="wrapper">
<img src="http://lorempixel.com/100/100/animals" />
<div class="text">Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. <span class="last-text">Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</span></div>
</div> 
```

CSS：

```
img {
    float:left;
    margin:10px;
    width:100px;
    height:100px;
}

.wrapper {
    width:300px;
    margin-bottom:20px;
}

.text {
}

.last-text {
} 
```

更新：请注意，我事先不知道文本将在哪里换行 - 我正在寻找一个通用的解决方案，如果它存在的话。例如，“.last-text”的某些样式会导致它不包裹在浮点数下。

CSS/HTML 解决方案优于 JavaScript。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-14T21:10:12.827

防止单个单词换行很容易：只需在最后两个单词之间使用不间断空格，而不是普通空格（例如，`nostrud&nbsp;exercitation`）。

但是，恐怕这并不能解决真正的问题。在示例案例中，将有一个两个单词换行，最后一行很短。如果文本变大，即使没有必要，这两个词也会粘在一起。

恐怕这个问题需要一些重要的 JavaScript 代码，在初始格式化后，将文本块的高度与图像的高度进行比较，并根据某些标准更改样式。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-14T20:36:22.683

只需添加`padding-bottom: 1px;`到`img`

[**演示**](http://jsfiddle.net/wdPCp/1/)

```
img {
    float:left;
    margin:10px;
    width:100px;
    height:100px;
    padding-bottom: 1px;
} 
```

您也可以使用左右列，是的，我当然使用过内联样式，但如果您想采用这种方法，而不是创建一个清晰的类并摆脱内联样式

[**演示 2**](http://jsfiddle.net/wdPCp/5/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-12T09:39:30.463

抱歉 - 不是一个明确的答案，但我不久前问了同样的问题。我在那里收到的答案之一是有希望的（使用 JS），但到目前为止我还无法解决。我的问题还使用图像来说明可能有帮助的问题。

我在使用 CMS 的响应式布局中一直遇到这个问题

[尴尬的线环绕图像](https://stackoverflow.com/questions/14811049/awkward-line-wrap-around-image)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-14T20:37:17.057

`.wrapper`解决方案是稍微增加类宽度。

这是`.wrapper`课程：

```
.wrapper {
        width:330px;
        margin-bottom:20px;
    } 
```

[http://jsfiddle.net/wdPCp/4/](http://jsfiddle.net/wdPCp/4/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-14T22:34:34.983

如果您不希望文本在浮动下换行，请`overflow: hidden`添加。`.text`

[http://jsfiddle.net/wdPCp/6/](http://jsfiddle.net/wdPCp/6/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-09-12T03:57:55.183

查看不同的显示样式。表格显示（不是标签）不会覆盖浮动元素。

```
.text{
  display:table;
} 
```

# azure - 有没有办法将 TypeScript 编译器作为 Azure Git 部署的一部分运行

> ID：14883496
> 
> 赞同：9
> 
> 时间：2013-02-14T20:31:05.003
> 
> 标签：azure, typescript, azure-git-deployment

我想避免将生成的 JavaScript 文件添加到 git 源代码控制存储库。Azure Git Deploy 是否支持在部署文件之前运行附加命令来运行构建？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T20:47:10.283

[是的，您可以使用自定义部署脚本](http://blog.amitapple.com/post/38417491924/azurewebsitecustomdeploymentpart1)运行任意逻辑。您需要在存储库中包含您需要的工具，或者最好根据需要下载它们（以避免提交二进制文件）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-28T18:48:09.447

现在您可以生成自定义部署脚本[自定义部署脚本](http://blog.amitapple.com/post/38417491924/azurewebsitecustomdeploymentpart1)

然后使用以下命令编辑 npm 命令以使用较新的 node.exe 版本（0.8.2）：

`call "D:\Program Files (x86)\nodejs\0.8.2\node.exe" "D:\Program Files (x86)\nodejs\node_modules\npm\bin\npm-cli.js" install --production`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-12-06T20:20:49.117

以防万一其他人正在寻找，这就是我需要做的才能使其正常工作。

首先，我确保将 TypeScript 安装在 Kudu 构建服务器可以访问的位置，方法是在`deploy.cmd`文件顶部的某处添加以下行：

```
call npm install typescript
IF %ERRORLEVEL% NEQ 0 (
  echo Unable to install TypeScript
  goto error
) 
```

这会将 TypeScript 的 Node 可调用版本放置在`.\node_modules\.bin\tsc.cmd`.

实际执行构建的批处理文件（可通过各种方式调用，但主要作为构建后事件）如下所示：

```
@echo off
if (%1%=="") goto settsc
cd %1%

:settsc
if exist ".\node_modules\.bin\tsc.cmd" (
    set tsc=call ".\node_modules\.bin\tsc.cmd"
    goto build
)
if exist "%ProgramFiles(x86)%\Microsoft Sdks\Typescript\0.9\tsc.exe" (
    set tsc="%ProgramFiles(x86)%\Microsoft Sdks\Typescript\0.9\tsc.exe"
    goto build
)
if exist "%ProgramFiles%\Microsoft Sdks\Typescript\0.9\tsc.exe" (
    set tsc="%ProgramFiles%\Microsoft Sdks\Typescript\0.9\tsc.exe"  
    goto build
)
echo TypeScript compiler not found
exit 999

:build
echo Building TypeScript: Payboard.Site.js (using %tsc%)
%tsc% --sourcemap --out Scripts\Payboard\Payboard.Site.js @tsbuild_Site.txt
echo Building TypeScript: Payboard Widget (using %tsc%)
%tsc% --sourcemap --out Widget\v1.0\Payboard.js @tsbuild_Widget_v10.txt
echo Building TypeScript: App\Payboard.App.js (using %tsc%)
%tsc% --sourcemap --out App\Payboard.App.js @tsbuild_App.txt 
```

希望这可以帮助其他人。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-01-21T06:35:26.337

这是另一种解决方法，不需要自定义部署脚本，不需要批处理文件，只需对项目文件进行少量更改。

包含详细信息的博客文章可在[http://manfredlange.blogspot.co.nz/2014/01/aspnet-mvc-typescript-azure-website-and.html](http://manfredlange.blogspot.co.nz/2014/01/aspnet-mvc-typescript-azure-website-and.html)获得。博客文章中提到的示例项目的源代码可在[https://bitbucket.org/ml_agileutilities/typescript-sample](https://bitbucket.org/ml_agileutilities/typescript-sample)获得。有一个分支可以重现该问题，还有一个包含解决方法的分支。

请注意，据我所知，Microsoft 正在制定适当的解决方案。在您阅读本文时，可能不再需要解决方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-05-18T18:39:13.887

现在可以在没有任何脚本的情况下使用 Typescript。只要确保 TypeScript 可以在 VS 中工作，那么它也可以在 Kudu 构建中工作。请注意，您可能有 TypeScript 版本冲突，请参见例如[这个问题](https://stackoverflow.com/q/23225405/219187)。

# linq - 在 EF 和 Linq 中加入与关联，性能差异？

> ID：14883500
> 
> 赞同：0
> 
> 时间：2013-02-14T20:31:20.917
> 
> 标签：linq, entity-framework

我最近从针对多个实体的 linq 查询中删除了 3 个连接，并改为使用表之间的关联。

似乎查询现在需要更长的时间来执行。我进行了更改，希望能提高性能。

这与其他人观察到的一致吗？这有什么合乎逻辑的原因吗？关于使用哪种策略有一个好的经验法则吗？

带连接的 Linq 查询：

```
from n in db.Names  
            .Where(n.ID = "myID")

            **join d in db.InstitutionDemographics on n.ID equals d.ID
            join m in db.MemberAdhocIds on n.ID equals m.ID
            join ba in db.NameAddresses on n.BillingAddressNumber equals ba.AddressNumber
            join sa in db.NameAddresses on n.ShippingAddressNumber equals sa.AddressNumber
            join ma in db.NameAddresses on n.MailingAddressNumber equals ma.AddressNumber
            join mas in db.MemberAdhocServices on n.ID equals mas.InstitutionID**

            join pn in db.PrimaryContactNames on n.ID equals pn.ID into PrimeName
            from pn in PrimeName.DefaultIfEmpty()
            join cd in currentDuesResults on n.ID equals cd.ID into DuesJoin
            from cd in DuesJoin.DefaultIfEmpty()
            join bd in billingDateResults on n.ID equals bd.ID
            into BillingDate
            from bd in BillingDate.DefaultIfEmpty() 
```

带有 ** 标记的部分是在 EDMX 文件中被关联替换的部分。关系是一对一的，约束基于 ID，就像连接一样。

我还必须提到 SQL 表上没有 FK 关系。（我无法更改的遗留内容）

** 新信息 我已经使用 join -vs- associations 捕获了查询生成的 SQL，并从 SSMS 运行它。性能几乎相同。因此，生成的 sql 似乎不是问题，而是 linq 代码如何工作的其他问题。

# php - 使用 PHP 解析 URL 中的相对路径

> ID：14883501
> 
> 赞同：4
> 
> 时间：2013-02-14T20:31:22.087
> 
> 标签：php, url, relative-path, resolve

示例 1：`domain.com/dir_1/dir_2/dir_3/./../../../`
应该在浏览器中自然解析为 =`domain.com/`

示例 2：`domain.com/dir_1/dir_2/dir_3/./../../../test/././../new_dir/`
应该解析为`domain.com/new_dir/`

示例 3：`domain.com/dir_1/dir_2/dir_3/./../../../test/dir4/../final`
应该解析为`domain.com/test/final`

我怎样才能遍历字符串来做到这一点？我觉得此时`for()`循环会感到困惑。

[Transform relative path into absolute URL using PHP](https://stackoverflow.com/questions/4444475/transfrom-relative-path-into-absolute-url-using-php) and [PHP: How to resolve a relative url](https://stackoverflow.com/questions/1243418/php-how-to-resolve-a-relative-url) don't work for me in this case 中提供的答案。我不应该需要一个参考点（基础），因为目标是清理我已经拥有的东西。

这不是[PHP 的副本 - 无法打开流：没有这样的文件或目录](https://stackoverflow.com/questions/36577020/php-failed-to-open-stream-no-such-file-or-directory)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-14T20:50:25.513

这是一个比您正在考虑的更简单的问题。您需要做的就是`explode()`在`/`角色上，并使用堆栈解析出所有单独的片段。当你从左到右遍历数组时，如果你看到`.`，什么也不做。如果看到`..`，从堆栈中弹出一个元素。否则，将一个元素压入堆栈。

```
$str = 'domain.com/dir_1/dir_2/dir_3/./../../../';
$array = explode( '/', $str);
$domain = array_shift( $array);

$parents = array();
foreach( $array as $dir) {
    switch( $dir) {
        case '.':
        // Don't need to do anything here
        break;
        case '..':
            array_pop( $parents);
        break;
        default:
            $parents[] = $dir;
        break;
    }
}

echo $domain . '/' . implode( '/', $parents); 
```

这将正确解析所有测试用例中的 URL。

请注意，错误检查留给用户作为练习（即，当`$parents`堆栈为空并且您尝试从中弹出一些东西时）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T20:38:36.610

你想要的是一个“replaceDots”功能。

它的工作原理是记住最后一个有效项目的位置，然后如果你得到点然后删除该项目。完整的描述在这里“删除点段” [https://www.rfc-editor.org/rfc/rfc3986](https://www.rfc-editor.org/rfc/rfc3986)。在 RFC 页面上搜索 Remove Dot Segments。

你需要不止一个循环。内部循环向前扫描并查看下一部分，然后如果它是点，则跳过当前部分等，但它可能比这更棘手。或者考虑将其分解为多个部分，然后遵循算法。

2.  当输入缓冲区不为空时，循环如下：

    A. 如果输入缓冲区以“../”或“./”前缀开头，则从输入缓冲区中删除该前缀；否则，

    B. 如果输入缓冲区以前缀“/./”或“/.”开头，其中“.” 是一个完整的路径段，然后在输入缓冲区中将该前缀替换为“/”；否则，

    C. 如果输入缓冲区以前缀“/../”或“/..”开头，其中“..”是完整的路径段，则在输入缓冲区中将该前缀替换为“/”并删除来自输出缓冲区的最后一段及其前面的“/”（如果有）；否则，

    D. 如果输入缓冲区只包含“.” 或“..”，然后将其从输入缓冲区中删除；否则，

    E. 将输入缓冲区中的第一个路径段移动到输出缓冲区的末尾，包括初始“/”字符（如果有）和任何后续字符，直到但不包括下一个“/”字符或末尾的输入缓冲区。

3.  最后，输出缓冲区作为 remove_dot_segments 的结果返回。功能。

它的工作原理是记住最后一个有效项目的位置，然后如果你得到点然后删除该项目。完整的描述在这里

这是我在 C++ 中的版本...

```
ortl_funcimp(len_t) _str_remove_dots(char_t* s, len_t len) {
  len_t x,yy;
  /*
    Modifies the string in place by copying parts back. Not
    sure if this is the best way to do it since it involves
    many copies for deep relatives like ../../../../../myFile.cpp

    For each ../ it does one copy back. If the loop was implemented
    using writing into a buffer, you would have to do both, so this
    seems to be the best technique.
  */
  __checklenx(s,len);
  x = 0;
  while (x < len) {
    if (s[x] == _c('.')) {
      x++;
      if (x < len) {
        if (s[x] == _c('.')) {
          x++;
          if (x < len) {
            if (s[x] == _c('/')) { // ../
              mem_move(&s[x],&s[x-2],(len-x)*sizeof(char_t));
              len -= 2;
              x -= 2;
            }
            else x++;
          }
          else len -= 2;// .. only
        }
        else if (s[x] == _c('/')){ // ./
          mem_move(&s[x],&s[x-1],(len-x)*sizeof(char_t));
          len--;
          x--;
        }
      }
      else --len;// terminating '.', remove
    }
    else if (s[x] == _c('/')) {
      x++;
      if (x < len) {
        if (s[x] == _c('.')) {
          x++;
          if (x < len) {
            if (s[x] == _c('/')) { // /./
              mem_move(&s[x],&s[x-2],(len-x)*sizeof(char_t));
              len -= 2;
              x -= 2;
            }
            else if (s[x] == _c('.')) { // /..
              x++;
              if (x < len) { //
                if (s[x] == _c('/')) {// /../
                  yy = x;
                  x -= 3;
                  if (x > 0) x--;
                  while ((x > 0) && (s[x] != _c('/'))) x--;
                  mem_move(&s[yy],&s[x],(len-yy) * sizeof(char_t));
                  len -= (yy - x);
                }
                else {
                  x++;
                }
              }
              else {// ends with /..
                x -= 3;
                if (x > 0) x--;
                while (x > 0 && s[x] != _c('/')) x--;
                s[x] = _c('/');
                x++;
                len = x;
              }
            }
            else x++;
          }
          else len--;// ends with /.
        }
        else x++;
      }
    }
    else x++;
  }
  return len;
} 
```

# spring - Spring，从 main 方法调用时，自动装配的 jdbcTemplate 为空

> ID：14883503
> 
> 赞同：1
> 
> 时间：2013-02-14T20:31:28.543
> 
> 标签：spring

我的应用程序需要一个从服务器上的 JAR 文件调用的静态 main 方法。如果 main 是静态的，则它调用的方法以及字段必须是静态的。问题是，我的 jdbcTemplate 是自动装配的，并且在静态时为空（我知道这不起作用）。要么我从我的主目录中删除“静态”并且我不能从 JAR 中调用它，或者我将所有内容都放在“静态”类中并且 jdbcTemplate 为空。这个问题的最佳解决方案是什么。

提前致谢。

*请注意，此示例中的 main 不是静态的，当我在服务器上运行它时，它说“main”必须是静态的。对于任何解决方案，请记住这一点。

```
public class Purge {

 @Autowired
 protected JdbcTemplate jdbcTemplate;

 private int PURGE_DAYS = 14;

/**
 * @param args
 */
public void main(String[] args) {
    loadContext();
    purge();
}

ApplicationContext loadContext() {
    return new ClassPathXmlApplicationContext("applicationContext-purge.xml");
}

public void purge() {
    jdbcTemplate.execute("blah blah blah");
}

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T16:06:38.267

谢谢你的帮助。我发现获取 jdbcTemplate bean 更容易，这是我的解决方案。

```
public class Purge {

private static int PURGE_DAYS = 14;

/**
 * @param args
 */
public static void main(String[] args) {
    purge((JdbcTemplate) loadContext().getBean("jdbcTemplate"));
}

static ApplicationContext loadContext() {
    return new ClassPathXmlApplicationContext("applicationContext-purge.xml");
}

public static void purge(JdbcTemplate jdbcTemplate) {
    jdbcTemplate.execute("blah blah blah");
} 
```

}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T21:27:40.873

你别无选择，只能使用 main static，下面是优雅的方法，它是“Spring”的方式。

```
 @Component
    public class Purge{

     @Autowired
     protected JdbcTemplate jdbcTemplate;

        public void purge(){
                  jdbcTemplate.execute("blah blah blah");

        }

        public static void main(String[] args) {
             ApplicationContext context = 
                    new ClassPathXmlApplicationContext("somthing.xml");
            Purge p = context.getBean(Purge.class);
            p.purge();
        }

    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T20:35:37.683

1.  你的`main`方法不是`static`。如果是这样，就不可能调用 non-static `purge()`。您的代码中缺少某些内容。你不是`new Purge()`有机会打电话吗？如果是这样，Spring 不知道该实例并且不会自动装配任何东西。

2.  加载上下文后，您必须`Purge`从该上下文中获取一个实例：

    ```
    Purge purge = loadContext().getBean(Purge.class) 
    ```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-14T20:36:41.137

如果您需要从 main 方法访问 bean，您可以尝试使用`ClassPathXmlApplicationContext#getBean`：

```
ApplicationContext context = loadContext();

this.jdbcTemplate = (JdbcTemplate) context.getBean("myJdbcBeanName"); 
```

# ios - 在 Xcode 中创建自定义模板 - 如何根据复选框制作所需的选项？

> ID：14883506
> 
> 赞同：6
> 
> 时间：2013-02-14T20:31:54.137
> 
> 标签：ios, xcode, cocoa-touch, templates, plist

我正在尝试在 Xcode 中创建自定义模板。在我的 TemplateInfo.plist 中，对于关键选项，我在下面粘贴了代码。这个模板将用于在事件发生时经常（但不总是）使用委托的类。

我遇到的问题是最底层的值，`RequiredOptions`. 我希望**仅**在选中 withProtocol 复选框时才启用文本框。但是，我无法弄清楚要使用什么价值和价值类型。我尝试了以下方法：

*   `<true/>`（如下） - 文本框始终处于启用状态。
*   `<string>YES</string>`- 文本框始终处于禁用状态。
*   `<integer>1</integer>`- 文本框始终启用。

有人对我还可以尝试什么有任何想法吗？更好的是，有人知道 Xcode 模板的不错参考吗？

我已经阅读了 Apple 的 plist 手册页和[该网站上](http://www.bobmccune.com/2012/03/04/creating-custom-xcode-4-file-templates/)的文章。

```
<array>
    <dict>
        <key>Description</key>
        <string>The name of the class to create</string>
        <key>Identifier</key>
        <string>productName</string>
        <key>Name</key>
        <string>Class</string>
        <key>NotPersisted</key>
        <true/>
        <key>Required</key>
        <true/>
        <key>Type</key>
        <string>text</string>
    </dict>
    <dict>
        <key>Default</key>
        <string>false</string>
        <key>Identifier</key>
        <string>withXIB</string>
        <key>Name</key>
        <string>With XIB for user interface</string>
        <key>Type</key>
        <string>checkbox</string>
    </dict>
    <dict>
        <key>Description</key>
        <string>Choose whether or not a delegate skeleton is included.</string>
        <key>Default</key>
        <string>false</string>
        <key>Identifier</key>
        <string>withProtocol</string>
        <key>Name</key>
        <string>With delegate skeleton</string>
        <key>Type</key>
        <string>checkbox</string>
    </dict>
    <dict>
        <key>Description</key>
        <string>The name of the protocol used for delegation.</string>
        <key>Identifier</key>
        <string>protocolName</string>
        <key>Name</key>
        <string>Protocol</string>
        <key>NotPersisted</key>
        <true/>
        <key>Required</key>
        <true/>
        <key>Type</key>
        <string>text</string>
        <key>RequiredOptions</key>
        <dict>
            <key>withProtocol</key>
            <true/>
        </dict>
    </dict>
</array> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T21:13:23.210

我通过替换为解决了我自己的`<true/>`问题`<string>true</string>`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-12-04T11:38:03.340

# asp.net-mvc - simplemembership“记住我”登录失败

> ID：14883507
> 
> 赞同：3
> 
> 时间：2013-02-14T20:32:01.027
> 
> 标签：asp.net-mvc, simplemembership

在访问 [Authorize] 的操作时，我间歇性地遇到以下异常。它似乎有时会起作用，然后有时会失败，但是当我登录并选择“记住我”按钮时，情况肯定更糟。如果我注销，然后立即重新登录，则没有错误，所以下面的文字不能完全准确......这里有一些其他的事情，但我无法识别它。

```
System.Data.SqlClient.SqlException: 
    A network-related or instance-specific error occurred while
    establishing a connection to SQL Server. The server was not
    found or was not accessible. Verify that the instance name
    is correct and that SQL Server is configured to allow remote
    connections. (provider: SQL Network Interfaces, error: 26 - 
    Error Locating Server/Instance Specified) 
```

这是完整的堆栈跟踪

```
System.Web.HttpException (0x80004005): Unable to connect to SQL Server database. ---> System.Web.HttpException (0x80004005): Unable to connect to SQL Server database. ---> System.Data.SqlClient.SqlException (0x80131904): A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: SQL Network Interfaces, error: 26 - Error Locating Server/Instance Specified)
   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection)
   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning()
   at System.Data.SqlClient.TdsParser.Connect(ServerInfo serverInfo, SqlInternalConnectionTds connHandler, Boolean ignoreSniOpenTimeout, Int64 timerExpire, Boolean encrypt, Boolean trustServerCert, Boolean integratedSecurity)
   at System.Data.SqlClient.SqlInternalConnectionTds.AttemptOneLogin(ServerInfo serverInfo, String newPassword, Boolean ignoreSniOpenTimeout, TimeoutTimer timeout, SqlConnection owningObject)
   at System.Data.SqlClient.SqlInternalConnectionTds.LoginNoFailover(ServerInfo serverInfo, String newPassword, Boolean redirectedUserInstance, SqlConnection owningObject, SqlConnectionString connectionOptions, TimeoutTimer timeout)
   at System.Data.SqlClient.SqlInternalConnectionTds.OpenLoginEnlist(SqlConnection owningObject, TimeoutTimer timeout, SqlConnectionString connectionOptions, String newPassword, Boolean redirectedUserInstance)
   at System.Data.SqlClient.SqlInternalConnectionTds..ctor(DbConnectionPoolIdentity identity, SqlConnectionString connectionOptions, Object providerInfo, String newPassword, SqlConnection owningObject, Boolean redirectedUserInstance)
   at System.Data.SqlClient.SqlConnectionFactory.CreateConnection(DbConnectionOptions options, Object poolGroupProviderInfo, DbConnectionPool pool, DbConnection owningConnection)
   at System.Data.ProviderBase.DbConnectionFactory.CreateNonPooledConnection(DbConnection owningConnection, DbConnectionPoolGroup poolGroup)
   at System.Data.ProviderBase.DbConnectionFactory.GetConnection(DbConnection owningConnection)
   at System.Data.ProviderBase.DbConnectionClosed.OpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory)
   at System.Data.SqlClient.SqlConnection.Open()
   at System.Web.Management.SqlServices.GetSqlConnection(String server, String user, String password, Boolean trusted, String connectionString)
   at System.Web.Management.SqlServices.GetSqlConnection(String server, String user, String password, Boolean trusted, String connectionString)
   at System.Web.Management.SqlServices.SetupApplicationServices(String server, String user, String password, Boolean trusted, String connectionString, String database, String dbFileName, SqlFeatures features, Boolean install)
   at System.Web.Management.SqlServices.Install(String database, String dbFileName, String connectionString)
   at System.Web.DataAccess.SqlConnectionHelper.CreateMdfFile(String fullFileName, String dataDir, String connectionString)
   at System.Web.DataAccess.SqlConnectionHelper.CreateMdfFile(String fullFileName, String dataDir, String connectionString)
   at System.Web.DataAccess.SqlConnectionHelper.EnsureSqlExpressDBFile(String connectionString)
   at System.Web.DataAccess.SqlConnectionHelper.GetConnection(String connectionString, Boolean revertImpersonation)
   at System.Web.Security.SqlRoleProvider.GetRolesForUser(String username)
   at WebMatrix.WebData.SimpleRoleProvider.GetRolesForUser(String username)
   at System.Web.Security.RolePrincipal.IsInRole(String role)
   at System.Linq.Enumerable.Any[TSource](IEnumerable`1 source, Func`2 predicate)
   at System.Web.Mvc.AuthorizeAttribute.AuthorizeCore(HttpContextBase httpContext)
   at System.Web.Mvc.AuthorizeAttribute.OnAuthorization(AuthorizationContext filterContext)
   at Glimpse.Mvc3.Plumbing.GlimpseAuthorizationFilter.OnAuthorization(AuthorizationContext filterContext)
   at System.Web.Mvc.ControllerActionInvoker.InvokeAuthorizationFilters(ControllerContext controllerContext, IList`1 filters, ActionDescriptor actionDescriptor)
   at System.Web.Mvc.Async.AsyncControllerActionInvoker.<>c__DisplayClass25.<BeginInvokeAction>b__1e(AsyncCallback asyncCallback, Object asyncState)
   at System.Web.Mvc.Async.AsyncResultWrapper.WrappedAsyncResult`1.Begin(AsyncCallback callback, Object state, Int32 timeout)
   at System.Web.Mvc.Async.AsyncControllerActionInvoker.BeginInvokeAction(ControllerContext controllerContext, String actionName, AsyncCallback callback, Object state)
   at System.Web.Mvc.Controller.<>c__DisplayClass1d.<BeginExecuteCore>b__17(AsyncCallback asyncCallback, Object asyncState)
   at System.Web.Mvc.Async.AsyncResultWrapper.WrappedAsyncResult`1.Begin(AsyncCallback callback, Object state, Int32 timeout)
   at System.Web.Mvc.Controller.BeginExecuteCore(AsyncCallback callback, Object state)
   at System.Web.Mvc.Async.AsyncResultWrapper.WrappedAsyncResult`1.Begin(AsyncCallback callback, Object state, Int32 timeout)
   at System.Web.Mvc.Controller.BeginExecute(RequestContext requestContext, AsyncCallback callback, Object state)
   at System.Web.Mvc.Controller.System.Web.Mvc.Async.IAsyncController.BeginExecute(RequestContext requestContext, AsyncCallback callback, Object state)
   at System.Web.Mvc.MvcHandler.<>c__DisplayClass8.<BeginProcessRequest>b__2(AsyncCallback asyncCallback, Object asyncState)
   at System.Web.Mvc.Async.AsyncResultWrapper.WrappedAsyncResult`1.Begin(AsyncCallback callback, Object state, Int32 timeout)
   at System.Web.Mvc.MvcHandler.BeginProcessRequest(HttpContextBase httpContext, AsyncCallback callback, Object state)
   at System.Web.Mvc.MvcHandler.BeginProcessRequest(HttpContext httpContext, AsyncCallback callback, Object state)
   at System.Web.Mvc.MvcHandler.System.Web.IHttpAsyncHandler.BeginProcessRequest(HttpContext context, AsyncCallback cb, Object extraData)
   at System.Web.HttpApplication.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute()
   at System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) 
```

### 编辑 1

这是请求的 InitializeDatabaseConnection： `WebSecurity.InitializeDatabaseConnection("UserDB", "tblPortalUsers", "ID", "UserName", autoCreateTables: false);`

### 编辑 2

我只是注意到堆栈跟踪中间有一些奇怪的东西：

```
 at System.Web.Management.SqlServices.Install(String database, String dbFileName, String connectionString)
   at System.Web.DataAccess.SqlConnectionHelper.CreateMdfFile(String fullFileName, String dataDir, String connectionString)
   at System.Web.DataAccess.SqlConnectionHelper.CreateMdfFile(String fullFileName, String dataDir, String connectionString)
   at System.Web.DataAccess.SqlConnectionHelper.EnsureSqlExpressDBFile(String connectionString)
   at System.Web.DataAccess.SqlConnectionHelper.GetConnection(String connectionString, Boolean revertImpersonation)
   at System.Web.Security.SqlRoleProvider.GetRolesForUser(String username)
   at WebMatrix.WebData.SimpleRoleProvider.GetRolesForUser(String username)
   at System.Web.Security.RolePrincipal.IsInRole(String role) 
```

为什么这段代码试图创建一个 MDF 文件？我的数据位于 SQL 服务器上，连接字符串名称为 UserDB，在 web.config 中定义为：

```
<connectionStrings>
    <add name="UserDB" connectionString="data source=NORWAY\DEV;initial catalog=SOMEDB;persist security info=True;user id=MYUSER;password=MYPASS" providerName="System.Data.SqlClient" />
    <add name="DALEntities" connectionString="metadata=res://*/DAL.DAL.csdl|res://*/DAL.DAL.ssdl|res://*/DAL.DAL.msl;provider=System.Data.SqlClient;provider connection string=&quot;data source=NORWAY\DEV;initial catalog=SOMEDB;persist security info=True;user id=MYUSER;password=MYPASS;multipleactiveresultsets=True;App=EntityFramework&quot;" providerName="System.Data.EntityClient" />
</connectionStrings> 
```

什么会导致它偏离指定的数据库，并尝试启动一个新的 MDF 来存储会员数据？为什么只有当用户使用他们的“记住我”cookie 重新登录时才会发生这种情况？（我想是的，无论如何......还没有能够证明这一点）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T15:12:30.483

查看您的堆栈跟踪，似乎`SimpleRoleProvider`尚未初始化：

```
at System.Web.Security.SqlRoleProvider.GetRolesForUser(String username)
at WebMatrix.WebData.SimpleRoleProvider.GetRolesForUser(String username) 
```

根据[代码](https://aspnetwebstack.codeplex.com/SourceControl/changeset/view/a19eb63170f9#src/WebMatrix.WebData/SimpleRoleProvider.cs)，您应该获取此堆栈跟踪的唯一方法是`InitializeCalled`属性是否为`false`：

```
public override string[] GetRolesForUser(string username)
{
   if (!InitializeCalled)
   {
       return PreviousProvider.GetRolesForUser(username);
   }
   ... 
```

该内部属性由[类](https://aspnetwebstack.codeplex.com/SourceControl/changeset/view/a19eb63170f9#src/WebMatrix.WebData/WebSecurity.cs)`InitializeRoleProvider`的方法设置，[该`WebSecurity`](https://aspnetwebstack.codeplex.com/SourceControl/changeset/view/a19eb63170f9#src/WebMatrix.WebData/WebSecurity.cs)方法从方法中调用`InitializedDatabaseConnection`。

您确定`WebSecurity.InitializeDatabaseConnection`每次应用程序启动时都会执行您的调用吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T21:16:03.113

我认为您的问题与 InitializeSimpleMembership 有关，因为您的所有页面都需要登录。

尝试这个

[使用 SimpleMembership 的 IsUserInRole 错误](https://stackoverflow.com/questions/14933327/isuserinrole-error-with-simplemembership/14999288#14999288)

不要忘记像这样更改您的设置

```
WebSecurity.InitializeDatabaseConnection("UserDB", "tblPortalUsers", "ID", "UserName", autoCreateTables: true); 
```

因为您将数据库“UserProfile”上的列名更改为“tblPortalUsers”

# jquery - jquery选择所有父母

> ID：14883511
> 
> 赞同：-1
> 
> 时间：2013-02-14T20:32:23.243
> 
> 标签：jquery, parent

我想选择所有父 div 并且这些父 div 里面有子 div，我不想选择子 div。

示例（我只想选择`$('.level0')`div 而不使用类）。

我的意思是： `$('#parent-container div:first-child')`

但这只会选择第一个 div。所以我想在不使用任何类的情况下选择（级别 0）的所有第一个 div。

```
<div id="parent-container">
    <div class="level0">
        <div class="level1"></div>
        <div class="level1"></div>
        <div class="level1"></div>
        <div class="level1"></div>
    </div>
    <div class="level0">
        <div class="level1">
            <div class="level2"></div>
        </div>
        <div class="level1"></div>
    </div>
    <div class="level0">
        <div class="level1">
            <div class="level2"></div>
        </div>
        <div class="level1">
            <div class="level2"></div>
        </div>
        <div class="level1"></div>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:34:22.443

由于所有`level_0`div 都是父容器的子容器，因此只需选择父容器的子容器。

```
$("#parent-container").children() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T20:35:53.943

我猜你正在寻找这个：

```
$('#parent-container > div') 
```

# ios - GKAchievement 报告Achievements:withCompletionHandler: crash

> ID：14883513
> 
> 赞同：-1
> 
> 时间：2013-02-14T20:33:06.517
> 
> 标签：ios, game-center

每个人都会偶尔收到我的应用程序（通过 crittercism）的崩溃报告，其中包含以下 NSInvalidArgumentException 崩溃：

```
+[GKAchievement reportAchievements:withCompletionHandler:]: unrecognized selector sent to class 0x3f940a84 
```

代码如下所示：

```
NSMutableArray *achivementArray = [NSMutableArray arrayWithCapacity:20];

for (NSString *achievementID in achievementsToUpload) // achievementsToUpload is a NSSet
{
    GKAchievement *achievement = [[GKAchievement alloc] initWithIdentifier:achievementID];
    if (achievement)
    {
        ...

        [achivementArray addObject:achievement];
    }
}

[GKAchievement reportAchievements:achivementArray withCompletionHandler:^(NSError *error)
{
    if (error != nil)
    {
        NSLog(@"Error sending achievement: %@", error.localizedDescription);
    }
}]; 
```

如果错误确实在 reportAchievements:withCompletionHandler: 中，据我所知，错误的来源可能来自两个地方：1) achievementArray 不是 NSArray 或 2) 错误不是真正的 NSError。

在 #1 的情况下，我在调用上方几行创建了数组，在 #2 的情况下，我怀疑操作系统是否正在发回一个非 NSError 对象。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T12:03:57.467

标题看起来像：

```
+ (void)reportAchievements:(NSArray *)achievements withCompletionHandler:(void(^)(NSError *error))completionHandler __OSX_AVAILABLE_STARTING(__MAC_NA,__IPHONE_6_0); 
```

所以问题可能出在您正在使用的基础 sdk 中。此方法从 iOS 6.0 开始可用。

希望它会有所帮助

# r - 绘制来自多元 GLM 与响应的每个预测变量（其他预测变量保持不变）

> ID：14883517
> 
> 赞同：1
> 
> 时间：2013-02-14T20:33:23.410
> 
> 标签：r, ggplot2, regression, glm

我可以绘制一个预测变量（来自多变量逻辑、二项式 GLM）与预测响应的关系。我这样做：

```
m3 <- mtcars # example with mtcars
model = glm(vs~cyl+mpg+wt+disp+drat,family=binomial, data=m3)
newdata <- m3
newdata$cyl <- mean(m3$cyl)
newdata$mpg <- mean(m3$mpg)
newdata$wt <- mean(m3$wt)
newdata$disp <- mean(m3$disp)
newdata$drat <- m3$drat
newdata$vs <- predict(model, newdata = newdata, type = "response")
ggplot(newdata, aes(x = drat, y = vs)) + geom_line() 
```

上面，*drat* vs *vs*所有其他预测变量保持不变。但是，我会为每个预测变量执行此操作，并且每次执行上述过程似乎很乏味。有没有更聪明的方法来做到这一点？我想可视化每个不同预测变量的响应，最终，也许是不同的常数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T23:17:59.913

检查 biomod2 包中的 response.plot2 函数。它的开发目的是为物种分布模型创建响应曲线，但它基本上可以满足您的需求 - 它生成一个多面板图，其中包含模型中使用的每个变量的响应。它还将数据输出到数据结构中，然后可以使用该结构以您喜欢的任何方式进行绘图。

# git - 告诉 git 一个文本文件实际上是二进制文件

> ID：14883522
> 
> 赞同：7
> 
> 时间：2013-02-14T20:33:57.460
> 
> 标签：git

我将一些 PDF 文件提交到 git 存储库中，看起来 git 将其视为文本而不是二进制文件。因此，repo 中的内容几乎比源文件大 1k，并且不再正确显示。

我更新了我的 .gitattributes 文件以将 PDF 文件包含为二进制文件，但似乎已经对 repo 中的文件造成了损害。有什么方法可以告诉 git 将 PDF 重新添加为二进制文件？最好的解决方案是从 repo 中删除文件并重新添加它们？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T23:03:04.247

是的，删除并添加回来应该可以工作。

添加文件后在顶部提交新版本就`.gitattributes`足够了。不需要移除步骤。

# latex - 使用 pandoc 从 Markdown 转换为 PDF 时设置双倍间距和行号

> ID：14883525
> 
> 赞同：20
> 
> 时间：2013-02-14T20:34:10.890
> 
> 标签：latex, markdown, pandoc

我正在使用 markdown 和 pandoc 进行科学写作，我知道我可以使用更改最终 pdf 的边距

[使用 pandoc 从 Markdown 转换为 PDF 时设置边距大小](https://stackoverflow.com/questions/13515893/set-margin-size-when-converting-from-markdown-to-pdf-with-pandoc)

但是很多时候期刊要求在投稿中使用双行和行号，问题是如何更改这些，我对 LaTex 了解不多，所以我迷失在那个丛林中。

谢谢！

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2015-04-15T06:42:26.727

在更新的 Pandoc 版本中，您可以使用[YAML 标头](http://pandoc.org/README.html#extension-yaml_metadata_block)并在其中包含一堆元数据，而不是使用命令行上的选项。因此，例如，您可以将其放在`.md`文件的顶部：

```
---
title: The Document Title
author:
    - Your Name
    - Co Author
date: \today{}
geometry: margin=2cm
header-includes:
    - \usepackage{setspace}
    - \doublespacing
    - \usepackage{lineno}
    - \linenumbers
---

Document Text 
```

pandoc 将读取这些选项并自动应用它们。

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2013-02-20T03:54:06.400

也许有一个简单的方法：生成一个包含我们需要的包的文件

```
 \usepackage{setspace}
 \doublespacing
 \usepackage[vmargin=1in,hmargin=1in]{geometry}
 \usepackage{lineno}
 \linenumbers 
```

我将其命名为 options.sty。并使用 -H FILE 选项，该选项在序言末尾包含 FILE 的内容。（在[https://github.com/karthikram/smb_git](https://github.com/karthikram/smb_git)中使用）

```
 pandoc -H options.sty --bibliography mypaper.bib mypaper.md -o mypaper.pdf 
```

优点是我们不需要编辑模板。要添加行号、更改边距和设置间距，它可以工作。

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2013-02-15T01:19:46.680

您需要使用自定义的 LaTeX 模板。首先，使用 pandoc 创建默认模板的副本：

```
pandoc -D latex > mytemplate.latex 
```

现在编辑这个模板。在序言中的某处（在`\documentclass{...}`和之间`\begin{document}`），插入行

```
\usepackage{setspace}
\doublespacing 
```

然后，使用您的自定义模板：

```
pandoc --template mytemplate.latex mypaper.txt -o mypaper.tex 
```

# javascript - Chrome 扩展 - 从弹出窗口执行简单的 javascript

> ID：14883527
> 
> 赞同：0
> 
> 时间：2013-02-14T20:34:13.180
> 
> 标签：javascript, javascript-events, google-chrome-extension

我创建了一个简单的页面，它使用 JavaScript 文件和 onClick 方法来显示不同的 div 标签。我有一个更复杂的程序，它可以让用户使用 ajax，它在浏览器中运行良好，但在弹出窗口中却不行

我读的越多，我在开发者网站上看到的所有内容，我就越感到困惑。Chrome 扩展不允许内联 JavaScript，这很好，但我仍然不确定如何实际编写 JavaScript。我知道这与事件处理程序有关，但即使这只是我的猜测。

任何人都可以使用这个程序并向我展示我需要更改哪些内容才能使用“manifest_version”在弹出窗口中工作：2 并且没有黑客。Google 希望人们如何使用 JavaScript？确实需要一个 hello world 程序来展示如何做到这一点。

HTML：

```
<!DOCTYPE HTML>
<html>
 <head>
  <title> Pop Up </title>

  <script src = "test.js"></script>

<style type = "text/css">

    #signout
    {
        display:none;
    }

</style>

</head>
<body>
    <!-- ///////////////////////////////////////////// -->
    <!-- //////////////// Log In Screen ////////////// -->
    <!-- ///////////////////////////////////////////// -->
    <div id = "login">
        <form method="post" action="">

            Username:
            <input type="text" name = "user" id = "user"><br>
            Password:
            <input type="text" name = "pass" id = "pass"><br>
            <input type="button" value="submit" onClick="logInPHP()" />
        </form>
    </div>

    <!-- ///////////////////////////////////////////// -->
    <!-- //////////////// Sign Out Screen //////////// -->
    <!-- ///////////////////////////////////////////// -->
    <div id = "signout">
        Your are Currently signed in.<br />
        <a href = "#" onclick = "signOutPHP()">Sign Out</a>
    </div>

</body>
</html> 
```

Javascript：

```
function logInPHP(){
            document.getElementById("login").style.display = "none";
            document.getElementById("signout").style.display = "inline";
}
function signOutPHP(){
            document.getElementById("login").style.display = "inline";
            document.getElementById("signout").style.display = "none";
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T21:45:10.663

您不能`onclick`直接在 HTML 文件中使用属性。删除它们并将您的 JavaScript 代码包装到文档`'DOMContentLoaded'`事件侦听器中。

```
document.addEventListener('DOMContentLoaded', function () {
    document.getElementById("login").addEventListener('click', function(){
        document.getElementById("login").style.display = "none";
        document.getElementById("signout").style.display = "inline";
    });

    document.getElementById("signout").addEventListener('click', function(){
        document.getElementById("login").style.display = "inline";
        document.getElementById("signout").style.display = "none";
    });
}); 
```

# sql - SQL Select语句多行

> ID：14883530
> 
> 赞同：0
> 
> 时间：2013-02-14T20:34:24.980
> 
> 标签：sql, select

我有2张桌子如下。

项目表。

```
ID      ProjectID      description      etc. 
1       4849           aaabbbb          etc. 
```

发票表。

```
ID      ProjectID      InvoiceNo      InvoiceDate      amount
1       4898           1234           01.01.01         200
2       4898           5678           02.02.02         475 
```

我需要的是以下内容。

```
ProjectID      Description      Invoicedate      amount
4898           aaabbbb          02.02.02         675 
```

我想我想多了，但需要帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T20:38:00.977

使用带总和的分组：

```
SELECT i.projectId, description, MAX(invoiceDate), SUM(amount)
   FROM invoice i
   JOIN project p ON p.projectId = i.projectId
   GROUP BY i.projectId; 
```

我选择使用`max`来获取每个项目的最新发票日期。假设那是你想要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T20:38:59.017

尝试这样的事情：

```
SELECT Project.ProjectID, Description, MAX(InvoiceDate), SUM(Amount)
FROM Project JOIN Invoice ON Project.ProjectID = Invoice.ProjectID
GROUP BY Project.ProjectID, Description 
```

如果您的 InvoiceDate 不是实际的`DATETIME`，则需要对其进行转换才能使其正常工作或使用另一种方式来获取 max of `InvoiceDate`.

SQL Fiddle[在这里](http://sqlfiddle.com/#!3/fb4f9/2)。请注意，我更改了 Invoice 表中的 ProjectID 以匹配 Invoice 表中的 ProjectID。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T20:40:40.367

我不完全确定你想如何进行分组，但它可能类似于

```
SELECT project.ProjectID, project.description, MAX(invoice.InvoiceDate), SUM(invoice.amount) FROM project JOIN invoice ON project.ProjectID = invoice.ProjectID WHERE project.ProjectID = 4898 GROUP BY project.ProjectID 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-14T20:37:55.350

```
select
  *,
  sum(amount) as amount
from
  Project as p
  inner join Invoice as i
    on p.ProjectID = i.ProjectID
group by ProjectID 
```

发票日期可能会有所不同。

# java - 带有hibernate的Spring MVC项目无法理解在jsp中如何使用

> ID：14883531
> 
> 赞同：0
> 
> 时间：2013-02-14T20:34:27.440
> 
> 标签：java, hibernate, jsp, spring-mvc

我正在学习 Spring MVC，但在理解如何在 jsp 中使用我的类时遇到了问题，这是我的控制器：

```
@Controller
public class BusinessController {
@Autowired
private BusinessService businessService;

@RequestMapping("/index")
public String listContacts(Map<String, Object> map) {

    map.put("business", new Business());
    map.put("businessList", businessService.listBusiness());

    return "business";
}

@RequestMapping("/find/{businessDate}")
public String listContactsByDate(@PathVariable("businessDate") Map<String, Object> map, String businessDate) {

    map.put("businessByDate", new Business());
    map.put("businessByDateList", businessService.listBusinessByDate(businessDate));

    return "businessByDate";
}

@RequestMapping("/")
public String home() {
    return "redirect:/index";
}

@RequestMapping(value = "/add", method = RequestMethod.POST)
public String addBusiness(@ModelAttribute("business") Business business, BindingResult result) {

    businessService.addBusiness(business);

    return "redirect:/index";
}

@RequestMapping("/delete/{businessId}")
public String deleteBusiness(@PathVariable("businessId") Integer businessId) {

    businessService.removeBusiness(businessId);

    return "redirect:/index";
}
} 
```

这是我的jsp：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf8">
<title><spring:message code="label.title" /></title>
</head>
<body>

    <h2>
        <spring:message code="label.title" />
    </h2>

    <form:form method="post" action="add" commandName="business">

        <table>
            <tr>
                <td><form:label path="businessDate">
                        <spring:message code="label.date" />
                    </form:label></td>
                <td><form:input path="businessDate" /></td>
            </tr>
            <tr>
                <td><form:label path="description">
                        <spring:message code="label.description" />
                    </form:label></td>
                <td><form:input path="description" /></td>
            </tr>
            <tr>
                <td colspan="2"><input type="submit"
                    value="<spring:message code="label.addbusiness"/>" /></td>
            </tr>
        </table>
    </form:form>

    <form:form method="post" action="/find/{$businessDate}"
        commandName="businessByDate">
        <table>
            <tr>
                <td><form:label path="businessDate">
                        <spring:message code="label.date" />
                    </form:label></td>
                <td><form:input path="businessDate" /></td>
            </tr>
        </table>
        <c:if test="${!empty businessByDateList}">
        <table class="data">
            <tr>
                <th><spring:message code="label.date" /></th>

                <th><spring:message code="label.description" /></th>
                <th>&nbsp;</th>
            </tr>
            <c:forEach items="${businessByDate}" var="business">
                <tr>
                    <td>${businessByDate.businessDate}</td>
                    <td>${businessByDate.description}</td>
                    <td><a href="delete/${businessByDate.id}"><spring:message
                                code="label.delete" /></a></td>
                </tr>
            </c:forEach>
        </table>
    </c:if>

    </form:form>

    <h3>
        <spring:message code="label.businesses" />
    </h3>
    <c:if test="${!empty businessList}">
        <table class="data">
            <tr>
                <th><spring:message code="label.date" /></th>

                <th><spring:message code="label.description" /></th>
                <th>&nbsp;</th>
            </tr>
            <c:forEach items="${businessList}" var="business">
                <tr>
                    <td>${business.businessDate}</td>
                    <td>${business.description}</td>
                    <td><a href="delete/${business.id}"><spring:message
                                code="label.delete" /></a></td>
                </tr>
            </c:forEach>
        </table>
    </c:if>
</body>
</html> 
```

而且，这是我的服务实现类：

```
@Repository
public class BusinessDAOImpl implements BusinessDAO{

@Autowired
private SessionFactory sessionFactory;

public void addBusiness(Business business){
    sessionFactory.getCurrentSession().save(business);
}

@SuppressWarnings("unchecked")
public List<Business> listBusinessByDate(String businessDate){
    String hql = "from Business B where B.date = :business_date";
    Query query = sessionFactory.getCurrentSession().createQuery(hql);
    query.setParameter("business_date", businessDate);
    return query.list();        
}

@SuppressWarnings("unchecked")
public List<Business> listBusiness(){
    return sessionFactory.getCurrentSession().createQuery("from Business").list();
}

public void removeBusiness(Integer id){
    Business business = (Business) sessionFactory.getCurrentSession().load(
        Business.class, id);
    if (null != business) {
        sessionFactory.getCurrentSession().delete(business);
    }
}
} 
```

如果没有 jsp 的部分，我尝试列出业务的日期一切正常，我可以添加一个业务，它将立即列在下表中，但是如果我添加一个带有 businessByDate 的部分，我会得到

```
Neither BindingResult nor plain target object for bean name 'businessByDate' available as request attribute 
```

我该如何解决？谢谢

```
enter code here 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:46:30.633

这是来自这个表单标签：

```
<form:form method="post" action="/find/{$businessDate}"
    commandName="businessByDate"> 
```

看起来你只做：

```
map.put("businessByDate", new Business()); 
```

在方法中就是这个表单的动作。您需要在实际加载页面的方法中将该对象添加到地图中！

# html - 和 论坛的主题？

> ID：14883535
> 
> 赞同：1
> 
> 时间：2013-02-14T20:34:35.100
> 
> 标签：html, forum, article

我不知道使用此代码显示论坛主题是否是一个好主意：

```
<article>
    <section>First post</section>
    <section>Second post</section>
    <section>etc</section>
</article> 
```

这是正确的还是我应该使用`<div>`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:37:21.743

我愿意（更新）

```
<section>
    <article>First post</article>
    <article>First post</article>
</section>
<section>
    <article>Second post</article>
    <article>Second post</article>
</section>
<section>
    <article>etc</article>
    <article>etc</article>
</section> 
```

# php - PHP代码打开新的调整大小的窗口

> ID：14883538
> 
> 赞同：0
> 
> 时间：2013-02-14T20:32:26.603
> 
> 标签：php, javascript

我不太精通 PHP 代码，但我有一个总体目标，希望有人能帮助我。我的网站上有这个代码片段：

```
$show = false;
if($this->_general['post_ci_linkedin_show'])
{ 
    $url = urlencode(get_permalink($post->ID));
    $title = urlencode($post->post_title);
    $source = urlencode(get_bloginfo('url'));

    $surl = $this->_general['post_ci_linkedin_url'];
    $surl = str_replace('[%url]', $url, $surl);
    $surl = str_replace('[%title]', $title, $surl);                
    $surl = str_replace('[%source]', $source, $surl);

    $out .= '<a class="icon" href="'.$surl.'" rel="LinkedIn"><img class="unitPng" src="'.get_bloginfo('template_url').'/img/icons/community/comm_LinkedIn.png" /></a>'; 
    $show = true;
} 
```

产生：

```
src="http://www.websitename.com/subpage/mypage" 
```

它显然会产生其他东西，比如 rel="blah" 等，但这是我想要调整的部分。

我想更改上面的 PHP 代码片段，以便最终结果是：

```
href="javascript:void window.open('http://www.websitename.com/subpage/mypage','', 'height=700,width=500');" 
```

我只是不确定要更改此代码的哪些部分以获得此结果，我尝试将其粘贴到周围，`.$surl.`但它在整个页面上给了我一个错误。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T20:54:55.950

您可能收到错误的原因是您的引号没有转义。

外面有单引号，里面有双引号。很好，但是现在您正尝试在其中添加更多单引号……那些需要转义的。

```
$out .= '<a class="icon" href="javascript:void window.open(\''.$surl.'\',\'\', \'height=700,width=500\');" rel="LinkedIn"><img class="unitPng" src="'.get_bloginfo('template_url').'/img/icons/community/comm_LinkedIn.png" /></a>'; 
```

# javascript - 自由职业者翻转角的代码是什么？

> ID：14883544
> 
> 赞同：0
> 
> 时间：2013-02-14T20:35:18.937
> 
> 标签：javascript, html, css

我现在正在使用 Chrome 并有兴趣在 freelancer.com 上检查翻转角的代码但我找不到与角图片或任何 CSS 相关的任何 html，除了`<a>`没有嵌入背景图像的 CSS 的标签！ ！

有什么想法吗？我认为一个大问题是，你怎么能像他们那样隐藏你的代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T20:38:46.870

这是附加到正文的背景图像：

```
.ns-sticker {
    background: url(/img/folded-banner.png?v=82d6815ae6517ce07aaa66ad4a678f77&m=1) top right no-repeat;
} 
```

`<a>`标签只是一个可点击的区域：

```
#box-link {
    position: absolute;
    top: 0;
    right: 0;
    width: 130px;
    height: 160px;
    background-color: transparent;
} 
```

我不会这样做。只需给`<a>`元素一个背景图像并绝对定位它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T20:39:16.190

他们没有隐藏他们的代码。

[http://cdn3.f-cdn.com/img/folded-banner.png?v=82d6815ae6517ce07aaa66ad4a678f77&m=1](http://cdn3.f-cdn.com/img/folded-banner.png?v=82d6815ae6517ce07aaa66ad4a678f77&m=1)

# c++ - Windows API - 设置了 OPEN_EXISTING 的 CreateFile() 返回错误代码 ERROR_ALREADY_EXISTS (183)

> ID：14883547
> 
> 赞同：0
> 
> 时间：2013-02-14T20:35:35.760
> 
> 标签：c++, winapi, named-pipes, createfile

我正在尝试使用 CreateFile() 打开命名管道：

```
g_hPipe = CreateFile(szPipeName, 
                    GENERIC_READ | GENERIC_WRITE, 
                    0, 
                    NULL, 
                    OPEN_EXISTING, 
                    FILE_FLAG_OVERLAPPED, 
                    NULL); 
```

其中 szPipeName 看起来像`\\\\.\\pipe\\service_name`，并且我正在返回 INVALID_HANDLE_VALUE。

[根据 MSDN](http://msdn.microsoft.com/en-us/library/windows/desktop/aa363858%28v=vs.85%29.aspx)， OPEN_EXISTING 标志仅在文件不存在时返回错误，但`GetLastError()`显示 ERROR_ALREADY_EXISTS (183)。我知道该文件存在，这就是我使用 OPEN_EXISTING 的原因... MSDN 建议仅在设置 OPEN_ALWAYS 或 CREATE_ALWAYS 时才会发生这种情况。我`SetLastError(0)`之前立即调用`CreateFile()`以确保`GetLastError()`结果是指该`CreateFile()`函数。

我已经搜索了很多，但没有找到任何可以表明我收到此错误的原因。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T20:45:43.897

[文档](http://msdn.microsoft.com/en-us/library/windows/desktop/aa363858%28v=vs.85%29.aspx)表明您只能`CreateFile`在单个客户端中使用一次，之后您必须复制返回的句柄：

> 如果 CreateFile 打开命名管道的客户端，则该函数使用处于侦听状态的命名管道的任何实例。打开进程可以根据需要多次复制句柄，但是打开后，命名管道实例不能被另一个客户端打开。

管道是一种点对点的传输方式。如果您希望其他应用程序连接到您的服务器，它们将需要自己的管道实例，这意味着服务器上的另一个 CreateNamedPipe 调用。

# asp.net-mvc - 在 MVC 中发布表单和上传文件的事件序列

> ID：14883548
> 
> 赞同：0
> 
> 时间：2013-02-14T20:35:37.417
> 
> 标签：asp.net-mvc, post, uploadify

我有一个包含多个字段的表单和 Uploadify 来选择和上传文件。我有一个 javascript Submit 方法（通过单击按钮调用），它具有以下内容：

```
$("#UrIntakeForm").submit();
$("#file_upload").uploadify("upload"); 
```

然后，我的控制器中有两个动作，一个接收表单数据映射到的对象，另一个具有以下签名接收上传的文件：

```
public void UploadFile(HttpPostedFileBase fileData) 
```

我需要做的是：

1.  将表单数据保存到数据库并取回一个 ID
2.  在表格中插入一行，每个上传文件的文件名和指向第一个表格的 FK
3.  将文件保存在某处
4.  返回带有确认号的可打印表单供用户查看

但是，我对如何完成这一系列事件感到有些困惑。首先，控制器中的 FileUpload 动作在控制器中的 SaveForm 动作之前被调用。其次，如果首先调用 SaveForm 操作，返回确认视图不会阻止文件上传吗？有人告诉我 POST 是一举发生的（文件、表单数据和所有），但不明白如果是这种情况，我怎么能有单独的操作来保存表单和文件上传。

有人可以通过此 POST（呃，这些帖子）了解幕后发生的事情以及我如何轻松获取上传的数据并使用它做我需要的事情吗？30,000 英尺的解释应该是完美的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T21:14:45.920

您需要先上传文件，然后传回对文件路径或数据的引用，以供主表单在提交时使用。MVC 中的模型绑定器目前对不存在的文件处理支持非常糟糕，因此很遗憾您不能一次完成所有操作。

# javascript - 控制 HTML5 中显示的 PDF 字体

> ID：14883551
> 
> 赞同：1
> 
> 时间：2013-02-14T20:35:52.357
> 
> 标签：javascript, html

我想在浏览器中显示 PDF 文件并控制 PDF 中使用的字体。例如，我应该能够增加和减少字体大小。

目前，我正在使用一个`<object>`元素来显示 PDF。为了获取此 PDF，我向服务器发出 HTTP 请求并设置`<object>`元素的 URL 属性。但这并没有提供太多控制 PDF 文档内容的能力，比如增加和减少字体大小。

如何控制对象标签中显示的 PDF 的字体（增加和减少）？有没有办法通过javascript来做到这一点？

我的示例代码在这里：

```
<object width="auto"
        height="auto"
        classid="clsid:19DDC62D-DB2C-48BA-88F8-9678DCBE0257"
        url="http://test.net/?doc_id=1212"/> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T20:41:27.397

你可以试试： http: [//pdfobject.com/](http://pdfobject.com/)

“PDFObject 将 PDF 文件嵌入 HTML 文档”

您可以使用他们的生成器[http://pdfobject.com/generator.php](http://pdfobject.com/generator.php)来优化嵌入 pdf 的外观。

# ember.js - 在 Ember 中刷新内容时缓解闪烁的 UI

> ID：14883553
> 
> 赞同：1
> 
> 时间：2013-02-14T20:35:54.943
> 
> 标签：ember.js, handlebars.js

# 问题

我有一个显示工人列表的视图。这个视图有一个按钮，它调用一个名为 的控制器方法`refresh`。最初我将 设置`content`为这个列表，但注意到 UI 会闪烁，一旦在计时器上运行，这将特别烦人。

我设法使一切正常工作而不会使用以下方法闪烁：

```
App.WorkersIndexController = Ember.ArrayController.extend
    refresh: ->
        console.log 'refreshing workers'
        # set a property to a new collection
        @set 'refreshing', App.Worker.find()

    # observer that watches the new collection load
    update: (->
        refreshing = @get 'refreshing'
        return unless refreshing.get('isLoaded')
        # what this question is about...
        Ember.run =>
            @set 'content', refreshing
    ).observes('refreshing.isLoaded') 
```

如您所见，我将刷新的内容设置为临时变量，并观察内容的加载，然后更新内容。内容闪烁较少，直到我添加了一个`Ember.run`完全消除闪烁的调用。

我理解为什么会发生闪烁，并且我理解为什么`Ember.run`会让它消失，但我的问题是不诉诸于解决这个问题的最佳方法是什么`Ember.run`？我觉得打电话给 Ember.run 是最后的手段......任何帮助将不胜感激！

编辑：另外我没有使用 ember 数据。该`find`方法如下所示：

```
App.Worker.reopenClass
    find: ->
        console.log 'loading workers'
        workers = Em.A []
        request = $.getJSON '/api/admin/workers', (data) =>
            console.log ' -> loaded workers'
            data.forEach (d) =>
                worker = App.Worker.create(d)
                worker.set 'isLoaded', true
                workers.pushObject(worker)
        request.error =>
            console.log ' -> failed to load workers'
            workers.set 'isFailed', true
        request.complete =>
            workers.set 'isLoaded', true
        workers 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:50:17.243

我通过有一个固定的列表来避免在类似情况下的闪烁，我只是改变了谁是对象。

在最简单的情况下，假设您正在显示名称，并且知道您知道您可以制作的元素永远不会超过 3 个

```
App.names = [ 
    Ember.Object.create({name:"", active:false}),
    Ember.Object.create({name:"", active:false}),
    Ember.Object.create({name:"", active:false})
] 
```

让你的模板成为

```
{{#each App.names}}
    {{#if active}}
        <li> {{name}} </li>
    {{/if}}
{{/each}} 
```

然后您可以通过运行添加名称

```
 App.names[0].set("name", "Frank");
  App.names[0].set("active", true); 
```

并更新列表没有任何闪烁。一次只更改列表中的一个元素，因此您不会看到整个列表中的闪烁被重绘。

实际上，您可能需要 App.names 成为 ArrayController 以便您可以优雅地处理扩展列表，但其要点将起作用。

# asp.net - 为什么多行文本框（在用户控件内）在回发后没有保持其值？

> ID：14883555
> 
> 赞同：0
> 
> 时间：2013-02-14T20:36:12.613
> 
> 标签：asp.net, user-controls

我有一个用户控件，它有一个网格视图、按钮和一个用于评论的多行文本框。

当页面回发时，Gridview**表现**正常（其控件在回发后保持其值）。但是，无论我做什么，**评论文本框总是空的。**

```
protected void Page_Load(object sender, EventArgs e)
{
   //This code is in the user ciontrol.
  if (!IsPostBack)
   {
     string test = this.txtDepartmentComments.Text;
   }

} 
```

我在那行放了一个断点，值总是空的。我还尝试在后面的代码中设置值，例如：

```
protected void Page_Load(object sender, EventArgs e)
{
   //This code is in the user ciontrol.
   if (!IsPostBack)
   {
     this.txtDepartmentComments.Text = "Test!";
   }
} 
```

但是当页面加载时，控件保持为空。

知道为什么会这样吗？

# 编辑

这是 ascx 代码（即用户控件）

```
<asp:GridView ID="GridView1" runat="server" AutoGenerateColumns = "false" >
</asp:GridView>

<asp:TextBox ID="txtComments" runat="server" Columns="45" TextMode= "MultiLine"/>
 <asp:Button ID="btnComplete" runat="server" Text="Completed"/> 
```

并且 id 是 aspx（即父页面）

```
<asp:Repeater ID="rpNewHire" runat="server">
       <HeaderTemplate>
        <table>            
       </HeaderTemplate>
       <ItemTemplate>
        <tr>
            <td>
                <user:MyUserControl ID = "MyUserControl1" runat = "server" 
                 DepartmentID= '<%# Eval("DepID")%>'><user:MyUserControl />
            </td>
        </tr>
       </ItemTemplate>
       <FooterTemplate>
        </table>
       </FooterTemplate>
    </asp:Repeater> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:40:49.187

if(!IsPostBack) 用于在回发后从控件中读取值，您尝试在初始加载时读取文本框值，该值始终为空，请删除“！” 从你的情况。此外，如果没有 aspx 页面内容，也很难调试您的问题，请尝试在您的问题中发布设计部分。

**编辑**

1.  您的用户标签在中继器内的格式不正确，缺少结束标签和 runat 属性

    ```
    <user:MyUserControl runat="server" ID = "MyUserControl1" DepartmentID= '<%# Eval("DepID")%>'></user:MyUserControl> 
    ```

2.  无法直接访问中继器内的控件，您必须遍历中继器的行并找到您的子控件，然后尝试从它们中读取值，然后将一些数据绑定到中继器。

检查这个[http://msdn.microsoft.com/en-us/magazine/cc163780.aspx](http://msdn.microsoft.com/en-us/magazine/cc163780.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T21:01:55.817

页面`IsPostBack`和每个用户控件`IsPostBack`是不一样的。

当一个用户控件被回发时，该特定控件`IsPostBack`为真，但其他用户控件`IsPostBack`仍然为假。

您可以`!Page.IsPostBack`在用户控件中显式使用来检查其父页面是否被回发。

```
if(!Page.IsPostBack){
   // do something
} 
```

[动态加载的控件不能在 PostBack 处保持值？](http://geekswithblogs.net/chrishan/archive/2007/03/27/109988.aspx) 它与您的问题没有直接关系，但它可能对您有用。

# winapi - 将指针存储在窗口类的额外窗口内存中的示例

> ID：14883556
> 
> 赞同：1
> 
> 时间：2013-02-14T20:36:22.040
> 
> 标签：winapi

我有一个代表文本框的类，在类的构造函数中我调用了`CreateWindow`函数，并且我想在额外的窗口内存中存储指向该对象的指针，所以在`WndProc`函数中我将获取指针，并将使用班级成员。
我试图用这段代码做到这一点，但它不工作，有人可以写一个例子来做到这一点：

*   我应该在结构`cbWndExtra`成员中赋予什么价值`WNDCLASSEX`。
*   怎么打电话`SetWindowLong`。
*   怎么打电话`GetWindowLong`。

我写的代码：

```
 wcex.cbWndExtra   = 4; 
```

我在文本框类的构造函数中写了这个：

```
 hWnd = CreateWindow(...);
  SetWindowLong(hWnd,0,(LONG)this); 
```

这在`WndProc`函数 中

```
 unique_ptr<TextBox> pTextBox;
  pTextBox.reset((TextBox*)GetWindowLong(hWnd,0)); 
```

=== 编辑 ===

现在我看到，如果我将`WndProc`函数中的代码更改为以下代码：

```
 TextBox *pTextBox;
 pTextBox = (TextBox*)GetWindowLong(hWnd,0); 
```

它也可以，但是用`unique_ptr`它不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-07-03T10:21:04.240

来自“SetWindowLong”的 MSDN 文档，关于“索引”参数。

> 要设置的值的从零开始的偏移量。有效值的范围是零到额外窗口内存的字节数减去整数的大小。要设置任何其他值，请指定以下值之一。

只要您在 WNDCLASS 结构中创建了具有至少该数量的“cbWndExtra”的窗口，正偏移量就可以指向任何字节偏移量。

我怀疑这种情况下的问题可能与指针的大小有关。您在窗口结构的末尾显式分配了 4 个额外字节，但如果您在 64 位系统上，则指针大小将为 8。这可以解释它有时有效，有时无效。（如果高位字恰好全为零，即使地址被截断，它也可能起作用。）如果是这种情况，您需要在两个单独的调用中设置高位字和低位字，或者最好使用64 位变体“SetWindowLongPtr”。

这是一个简单的示例，它使用此功能将两个指针存储在 windows 额外数据区域中（注意以下内容适用于 32 位和 64 位）

```
wndclass.cbWndExtra = sizeof(char*) * 2; // Reserve space for 2 pointers. 
```

然后稍后设置一个值：

```
SetWindowLongPtr(hwnd, 0, (LONG_PTR)firstPtr);
SetWindowLongPtr(hwnd, sizeof(char*), (LONG_PTR)secondPtr); // Index is byte offset. 
```

并使用以下方法检索值：

```
LONG_PTR firstPtr = GetWindowLongPtr(hwnd, 0);
LONG_PTR secondPtr = GetWindowLongPtr(hwnd, sizeof(char*)); 
```

但是，如果您只需要存储一个指针，则可以不设置任何额外内存，将 cbWndExtra 保留为零，然后将 GWLP_USERDATA 作为索引传递。与其他预定义值一样，GWLP_USERDATA 是“向后”到类/窗口数据的负偏移量。它是为这种目的保留的空间，但它只能容纳一个指针的数据。

# version-control - 可以在版本控制下的文件中显示作者（支持责备或注释）的合并/差异工具

> ID：14883567
> 
> 赞同：11
> 
> 时间：2013-02-14T20:37:07.860
> 
> 标签：version-control, merge, diff, blame

合并文件时（对我而言）显示每一行的作者会很有帮助。是否有任何差异或合并工具支持它？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-10-22T07:11:02.527

捆绑的 gitk 工具并不是真正的合并工具，但它显示了红色和蓝色的冲突线以及前面的“+”，您可以在其中任何一个上单击右键->“显示该行的来源”，转到引入该行的提交：

![截屏](../Images/7ce23274177faf35d361a51f4b3ff871.png)

你可以运行你的合并工具，或者只是一个并行的带有差异标记的文本编辑器

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T23:54:12.873

所以你真正想要的是一个工具，它可以在合并冲突中轻松识别你的更改相对于其他人的更改，而不是实际识别每一行的作者（这将是实现这一目标的一种手段），对吧？

如果我理解正确的话，我有一些比较好的消息：可以用 git + kdiff3 来完成。对于合并，您可以使用`git mergetool` （您可以将其配置为使用 kdiff3）。但是，如果您在进行交互式变基时遇到合并冲突，则本机不支持它，因此需要一些手动脚本。

[我将使用http://www.gitguys.com/topics/merging-with-a-conflict-conflicts-and-resolutions/](http://www.gitguys.com/topics/merging-with-a-conflict-conflicts-and-resolutions/) 作为基础，而不是编写我自己的简单合并冲突示例 。按照该页面`git merge test`。从合并命令之后，我通过运行不同的命令（但基本上做相同的工作）与该示例有所不同。我将首先执行所有手动步骤。

所以我们有一个合并冲突，git 已经以这种格式将来自两个贡献源的内容插入到文件中`<<<<<<<...>>>>>>>`，我真的一点也不喜欢，甚至从不考虑查看它。相反，我使用我最喜欢的合并工具 kdiff3。

首先，我们需要找到涉及哪些版本。

```
$ git ls-files -u
100644 b0ed415d15862ac5582b51e4de65528e86934cd2 1       README
100644 56300e3ac4e4521c3500618a301bb2ab2d6a52f5 2       README
100644 9585db7d9c2d9ca05075f67a878f2554886d7b1a 3       README
$ 
```

根据这些信息，我们可以执行三路合并：

```
$ git cat-file blob b0ed415d15862ac5582b51e4de65528e86934cd2 > v1
$ git cat-file blob 56300e3ac4e4521c3500618a301bb2ab2d6a52f5 > v2
$ git cat-file blob 9585db7d9c2d9ca05075f67a878f2554886d7b1a > v3
$ kdiff3 -o merge_result v1 v2 v3 &
[2] 18394
$ 
```

它提供了以下视图，您可以在其中选择要合并的祖先。

![kdiff3 截图](../Images/4c3eb3458c90ad6d42930f36f0b9f7d1.png)

后记（如果您对合并结果感到满意）您需要

```
$ rm v1 v2 v3
$ mv merge_result README
$ git add README 
```

上面的所有手动步骤都是使用 自动完成的`git mergetool`。那么为什么要展示所有这些呢？好吧，因为如果您在 期间遇到相应的冲突`git rebase -i`，则必须以这种方式完成（在运行之前`git rebase --continue`）。

在这个小例子中，只有一条冲突线，所以它没有显示自动解决很多线的更典型情况，让您只需手动解决没有自动完成的线。一个更真实的例子可能看起来更像下面这样：

![kdiff3 截图](../Images/c3d99a5a3f3c2615dcef3c9ebffbba56.png)

请注意，在合并结果中，您现在可以清楚地看到`C`自动解析的行的来源。我认为这就是您在要求为每一行获取作者时所要求的，对吗？文本中完全没有该信息`<<<<<<<...>>>>>>>`（并且很难/不可能发现您应该更新 hello 函数中的打印字符串）。

我不能高度推荐 kdiff3。使用这样的图形合并工具，与文件中混合内联的两个源中的一些行相比，就像使用[excavator](https://en.wikipedia.org/wiki/Excavator)与[spade](https://en.wikipedia.org/wiki/Spade)一样。

* * *

## 回答 #3

> 赞同：-5
> 
> 时间：2013-02-15T06:13:29.663

不。而且，我认为，永远不会——当我们合并时，我们考虑的是内容，而不是作者身份

# python - 以编程方式修改某人的 AppDelegate - 类别，子类？

> ID：14883568
> 
> 赞同：1
> 
> 时间：2013-02-14T20:37:07.963
> 
> 标签：python, ios, objective-c

我正在研究框架安装程序脚本。该脚本需要修改用户的AppDelegate文件，并在applicationDidFinishLaunching和applicationWillTerminate方法的开头或结尾处注入几行代码。

我考虑过的一些选项：

*   解析源代码，并在正确的位置插入行。（可能很难正确地为每个人的代码工作，几乎等同于编写编译器......）
*   子类化 AppDelegate 文件（这可能吗？）
*   分类？？

其中哪一个是最佳选择？还有其他建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:53:42.077

如果您确实需要`AppDelegate`在开发人员完全不干预的情况下修改它，并且您可以修改 xcodeproj 和 nib 但不能修改源代码，那么有一种方法可以做到。

首先，确保你的类被编译进去，并且你的类的一个实例被创建在 nib 中。

现在，这就是你要做的：

*   定义一个`-[AHHackClass applicationDidFinishLaunching]`方法来完成你的额外工作，然后调用`[self originalApplicationDidFinishLaunching]`.
*   在`-[AHHackClass awakeFromNib:]`中，使用 objc 运行时调用将`-[AHHackClass applicationDidFinishLaunching]`方法复制到应用程序委托 as `-[originalApplicationDidFinishLaunching]`，然后使用方法调配来交换两个方法的实现。
*   做同样的事情来调酒`applicationWillTerminate`。

参见[`JRSwizzle`](https://github.com/rentzsch/jrswizzle)一些使方法更容易调动的代码，并[`MethodSwizzling`在 CocoaDev](http://cocoadev.com/wiki/MethodSwizzling)获得一些背景知识。

但是，可能有更简单的方法可以做到这一点：您的额外内容真的需要从应用程序委托`applicationDidFinishLaunching`和`applicationWillTerminate`方法中调用吗？难道你不能设置为监听你的通知并在`awakeFromNib`那里处理事情吗？

如果，由于某种原因，您不能这样做，您是否可以在开发人员的说明中添加一行以从他们的方法中调用您的`applicationDidFinishLaunching`方法？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T21:00:11.617

我目前正在考虑的一种解决方案：

1.  添加子类 AppDelegate 的 NewAppDelegate.m/h 文件。
2.  这个子类，做我想做的事，然后调用超级方法。
3.  在 main.m 中用 NewAppDelegate.mh 查找/替换 AppDelegate

这看起来非常简单和强大。对此有什么想法？这适用于所有/大多数项目吗？

# c# - 为什么 typeof(Object[,][]).Name 等于“Object[][,]”？

> ID：14883569
> 
> 赞同：24
> 
> 时间：2013-02-14T20:37:11.663
> 
> 标签：c#, .net, reflection, multidimensional-array

评估`typeof(Object[,][]).Name`给予`Object[][,]`

同样，`typeof(Object[][,]).Name`给出`Object[,][]`

似乎逗号无缘无故地移动。

是什么赋予了？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-02-14T20:45:17.873

混合参差不齐和矩形阵列是一种疯狂的方法。您对给定类型符号含义的直觉几乎总是错误的，或者至少我的直觉是错误的。

阅读我关于该主题的文章，看看这是否有助于您了解这里发生的事情：

[http://blogs.msdn.com/b/ericlippert/archive/2009/08/17/arrays-of-arrays.aspx](http://blogs.msdn.com/b/ericlippert/archive/2009/08/17/arrays-of-arrays.aspx)

基本上：C# 和反射以两种不同的方式表示混合的不规则/矩形数组，每种方式都有自己的原因。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-14T20:51:02.550

撇开您可能想要声明这种奇异数组的目的不谈，看起来反射生成数组名称的方式是递归的：首先，它生成数组元素类型的名称，然后在方括号中附加适当的逗号数。

`Object[,][]`是一维数组的二维数组；二维数组的元素类型是`Object[]`，所以总体结果是`"Object[]"+"[,]"`。

这是算法工作方式的另一个说明：

```
typeof(Object[][,][,,][,,,][,,,,]).Name 
```

是

```
Object[,,,,][,,,][,,][,][] 
```

除了实现的效率，我没有看到它背后的原因：只要它是一致的，语法是否匹配 C# 并不重要。毕竟，C# 并不是 .NET 世界中唯一的语言。

# ios - 模型对象和核心数据

> ID：14883576
> 
> 赞同：0
> 
> 时间：2013-02-14T20:37:21.370
> 
> 标签：ios, objective-c, core-data

我有一个从 Core Data 加载数据的对象。然后我使用用户输入/选择修改对象。

我的第一个想法是重写属性的 setter 方法：

```
-(void)setType:(NSString *)type {
    NSLog(@"setType fired | newType: %@", type);

    _type = type;

    appDelegate *appDelegate = (appDelegate *)[[UIApplication sharedApplication] delegate];

    NSManagedObjectContext *context = [appDelegate managedObjectContext];

    NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] initWithEntityName:DEFAULTS_DB];

    NSError *error;

    NSArray *fetchedObjects = [context executeFetchRequest:fetchRequest error:&error];

    if (fetchedObjects.count == 1) {
        Defaults *defaults = [fetchedObjects objectAtIndex:0];

        defaults.sceneType = type;
    }

    if (![context save:&error]) {
        NSLog(@"Error in saving first run defaults | error: %@", error);
    }
    else {
        NSLog(@"new type was saved to core data");
    }
} 
```

我的另一个想法是在`applicationWillResignActive:`触发时更新核心数据（但该方法在应用程序冻结之前只运行几秒钟）和用户注销时。

我正在创建的应用程序是用户将启动的应用程序，设置他想要的内容，然后将其放下 10-60 分钟，直到他再次使用它，所以我担心我的应用程序在不活动时被杀死并丢失数据。

在 setter 方法中更新核心数据是处理更新的好方法还是一个非常糟糕的主意（资源密集，速度太慢）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T21:34:13.660

这在某种程度上取决于您在每次调用客户设置器时设置和检索的数据量。我会尝试你现在正在做的事情（更新设置器中的核心数据），但在旧设备上进行测试，比如 iPad 1，看看它的性能如何。玩了一段时间后，您可以决定是否要使用每个 setter 更新核心数据。

现在，如果您根本看不到任何性能差异，我不会担心。你很厉害。通过在 setter 中提交数据，您可以放心地保存来自用户的最新操作。但是，当您保存更多数据和/或大文件/图像并且早期设备开始看到性能差异时，可能会出现一个点。

为了提前为这种情况做好准备，我建议在您的程序中设置一个缓冲区（反映您的实体的结构），该缓冲区每隔一段时间就会写入核心数据 - 可能是当应用程序进入某个状态时不活动或应用程序是否进入后台或每个固定时间段。缓冲区必须在设置器中更新。您编写代码的想法可能会打嗝，这`applicationWillResignActive:`源于您在处理崩溃方面的准备程度。崩溃随时可能因任何原因发生，有时可能不是因为您自己的代码错误。这就是为什么拥有缓冲区是个好主意的一个重要原因。您要么在崩溃期间丢失一大块小数据（最坏情况），要么实现性能+一致性（最佳情况）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T21:30:19.270

这不是典型的使用模式。典型的做法是在显示其数据并保存它之前获取您的对象。然后当用户更改某些内容时，更新对象属性并保存上下文。

# javascript - js条件：如果不是false，null或者undefined then

> ID：14883577
> 
> 赞同：0
> 
> 时间：2013-02-14T20:37:29.223
> 
> 标签：javascript, if-statement

我有这个 ！！花药对象的标记并且它有效，但在这里它不起作用（在一种情况下，在其他情况下有效）。

```
if (!!slides) {
        console.log("close view clear slides")
        clearInterval(slides);
    } 
```

在萤火虫我得到这个错误：

```
ReferenceError: slides is not defined 
```

我的条件应该是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:50:51.910

如果未定义变量，则不能使用它。

```
typeof(asdf)
"undefined"

!asdf
ReferenceError: asdf is not defined

if (typeof(asdf) != "undefined") {
    // will only execute if asfd is defined.
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-14T20:45:04.683

改变

```
if (!!slides) { 
```

到

```
if (!slides) { 
```

但是，如果 slides 是 false、null 或 undefined，那么清除它不会做任何事情。所以，也许你的意思是

```
if (slides) { 
```

?

# c++ - 双链表的深拷贝

> ID：14883584
> 
> 赞同：0
> 
> 时间：2013-02-14T20:37:39.297
> 
> 标签：c++, list, deep-copy, doubly-linked-list

我无法对我的双向链表进行深层复制。这是一个家庭作业，所以我想知道为什么我的代码不工作，而不是得到我不理解的工作代码。

这是我的课：

```
#include "textAnalyzer.h"
#include <string>
#include <iostream>
#include <sstream>

TextAnalyzer::Node* TextAnalyzer::createNode(const string& word, const int wordFrequency, 
Node* const previous, Node* const next)
{
return new Node(word, wordFrequency, previous, next);
}
void TextAnalyzer::releaseNodes()
{
Node* del = tail;

while(tail != NULL)
{
    tail = tail->previous;
    tail->next = del;
    delete del;
    del = tail;
}

delete [] head;
delete [] tail;

head = tail = del = NULL;
}

void TextAnalyzer::copyNodes(Node* const copyHead)
{
head = new Node(*copyHead);
Node* iter = head->next;

for(Node* np = copyHead->next; np != NULL; np = np->next)
{
    iter->next = new Node(*np);
    iter = iter->next;
}

iter = NULL;
}

TextAnalyzer::TextAnalyzer():head(createNode("0",0,NULL,NULL)),tail(head)
{}

TextAnalyzer::TextAnalyzer(const TextAnalyzer& copyObject)
{
copyNodes(copyObject.head);
}

TextAnalyzer::~TextAnalyzer()
{
releaseNodes();
}

TextAnalyzer TextAnalyzer::operator=(const TextAnalyzer& assignObject)
{
return TextAnalyzer(assignObject);
}

void TextAnalyzer::insertWord(const string& word)
{
Node* iter = head->next;

while(iter != NULL)
{
    if(iter->word == word)
        iter->wordFrequency++;
    else if(iter->word[0] == word[0] && iter->next != NULL)
    {
        Node* temp = iter->next;
        iter->next = createNode(word, 1, iter, temp);
        iter = iter->next;
        temp->previous = iter;

        temp = NULL;
    }
    else if(iter->word[0] == word[0] && iter->next == NULL)
    {
        iter = createNode(word, 1, tail, NULL);
        tail = iter;
    }
    else
        iter = iter->next;
}

iter = NULL;
}

int TextAnalyzer::wordCount() const
{
Node* iter = head->next;
int count = 0;

while(iter != NULL)
    count++;

return count;
}

int TextAnalyzer::wordCountWithInitialCharacter(const char startsWith)
{
Node* iter = head->next;
int count = 0;

for(int i = 0; i < wordCount(); i++)
{
    if(startsWith == iter->word[0])
        count++;

    iter->previous = iter;
    iter = iter->next;
}

iter = NULL;

return count;
}

string TextAnalyzer::toString() const
{
Node* iter = head->next;
string desc = "List of words: \n";
ostringstream convert;

for(int i = 0; i < wordCount(); i++)
{
    convert << iter->word[0] << " words:\n"
            << iter->word    << "(" 
            << iter->wordFrequency
            << ")\n";
    iter->previous = iter;
    iter = iter->next;
}

iter = NULL;

return desc + convert.str();
} 
```

这是界面：

```
#ifndef TEXTANALYZER_H
#define TEXTANALYZER_H

#include <iostream>
#include <string>

using namespace std;

class TextAnalyzer {
private:

/*
 * Class: Node
 *
 * This class represents a node in a sorted doubly linked list that stores a
 * list of words and their frequency of occurrence.
 */
class Node {
public:
    string word;
    int wordFrequency;
    Node* previous;
    Node* next;

    Node(const string& word,
         const int wordFrequency,
         Node* const previous,
         Node* const next)
    : word(word),
      wordFrequency(wordFrequency),
      previous(previous),
      next(next)
    {}
}; // end ListNode
/*********************************************************************/

Node* head;
Node* tail;

/*
 * Releases all the memory allocated to the list.
 */
void releaseNodes();

/*
 * Makes a deep copy of the object.
 */
void copyNodes(Node* const copyHead);

/*
 * Returns a populated Node.
 * Throws a bad_alloc exception if memory is not allocated.
 */
Node* createNode(const string& word,
                 const int wordFrequency,
                 Node* const previous,
                 Node* const next);

public:
/* 
 * Initializes head and tail, each to a dymmy node.
 */
TextAnalyzer();

/*
 * Makes a deep copy of the object passed in.
 * Calls copyNodes() to do the actual work.     
 */
TextAnalyzer(const TextAnalyzer& copyObject);

/* 
 * Releases all the memory allocated to the object.
 * Calls the releaseNodes() method to do the actual work.
 */
~TextAnalyzer();

/* 
 * Makes a deep copy of the rhs object.
 */
TextAnalyzer operator =(const TextAnalyzer& assignObject);

/*
 * Inserts the word in a sorted order into the list. 
 *
 * If no Node exists with that initial character, one is added in
 * sorted order. If one does exist (same word), then the word frequency
 * of that word is incremented by one.
 */
void insertWord(const string& word);

/*
 * Returns a count of all the words in the list.
 */
int wordCount() const;

/* 
 * Returns a count of all the words with the initial character.
 */
int wordCountWithInitialCharacter(const char startsWith);

/*
 * Returns a description of the object. The string is formatted as:
 * [A words:]
 *     [<word>(<count>)]
 *     [<word>(<count>)]
 *     ...
 *
 * [B words:]
 *     [<word>(<count>)]
 *     [<word>(<count>)]
 *     ...
 *
 *...
 */
string toString() const;

};

#endif 
```

我需要使用上面给出的界面。我的问题是我的复制构造函数中出现错误，说“对象具有不兼容的限定符”或类似的东西。我假设这是因为`copyObject`是恒定的。但是，我不知道如何做到这一点，有人可以告诉我我在这里缺少什么吗？我对 C++ 相当陌生，我对 Java 更有经验，所以这可能就是我感到困惑的原因。

**编辑：**

感谢您的回复。我想我正要弄清楚如何成功地进行深拷贝。我已经更新了我的代码以显示我到目前为止完成的内容。现在我已经编译了代码，我得到了一个新的错误。每次我运行它时都会出现“未处理的异常 0xc0000005”。我用谷歌搜索它并认为这是由于尝试取消引用空指针而导致的错误。调试器显示它是在我的`releaseNodes()`方法中抛出的。

```
void TextAnalyzer::releaseNodes()
{
Node* del = tail;

while(tail != NULL)
{
    tail = tail->previous; //error on this line
    tail->next = del;
    delete del;
    del = tail;
 }

delete [] head;
delete [] tail;

head = tail = del = NULL;
} 
```

以上只是我的`releaseNodes()`方法，带有注释显示调试器说错误的来源。我想看看我的其余代码是否有效，因为我是 C++ 新手，而且很可能我的逻辑在其他地方也存在缺陷，不幸的是，在解决此错误之前，我无法测试任何东西。我仍在跟踪我的代码，试图找出可能导致它的原因。如果有人能指出我正确的方向，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T20:42:34.357

我假设这是它说的那一行

```
void TextAnalyzer::copyNodes(Node* const copyHead)
{
    head->next = new Node(*copyHead);   
} 
```

您只是为 head 中的下一个指针分配一个新的 Node 对象。基本上，您只复制一个节点，即跟随头的节点，而不是整个列表。您对使用 while 循环在 releaseNodes 中应该做什么有了正确的想法。

您也在复制构造函数中错误地调用它。您在定义中给了它一个参数，但您调用的参数在构造函数中不接受任何参数。

# javascript - 将服务器端数据获取到用户控件中的客户端脚本的最佳方法

> ID：14883585
> 
> 赞同：0
> 
> 时间：2013-02-14T20:37:38.447
> 
> 标签：javascript, asp.net, ajax, json

我开始构建一个将存在于某些 SharePoint 2007 PageLayouts 上的 UserControl。UserControl 的目的是根据页面名称显示多个位置的地图。因此，它需要做的是获取页面名称，查询 SharePoint 列表以获取相关的地理坐标集合，然后将它们加载到地图上。除了元素的简单修改和学术 jquery AJAX 调用之外，我从来没有真正做过很多客户端脚本。所以我试图了解传递数据的常见做法。

我在网上看到很多关于 AJAX 调用页面方法的东西，因为这是一个用户控件，所以它已经过时了。另一种方法看起来是对 Web 服务的 ajax 调用。我以前构建过 Web 服务，但供 .NET 客户端使用。这[仍然](http://www.asp.net/web-forms/tutorials/aspnet-ajax/understanding-asp-net-ajax-web-services)是您设置要由脚本调用的 .net Web 服务的方式吗？安全呢？如果我只希望我的页面或我的站点调用 Web 服务而不是公众怎么办？

在这种情况下，我什至不确定是否需要服务。我可以在初始请求期间检索数据并将其放在页面上吗？像json这样的东西在后面的代码中序列化坐标集合并将其写入隐藏字段以供javascript提取？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T21:29:01.463

有几种方法可以将值从用户控件传递到 javascript。

**脚本控制：**

允许您为 Web 控件包含客户端行为。请参阅下面的一些链接：
[创建脚本控件](http://byatool.com/ui/creating-script-controls-and-love/)
[ASP.NET：使用 ScriptControl 基类创建 AJAX 服务器控件](http://pietschsoft.com/post/2008/05/ASPNET_Create_AJAX_Server_Controls_using_the_ScriptControl_base_class.aspx)
[Asp.Net Ajax ScriptControl 教程](http://vincexu.blogspot.com.br/2010/02/aspnet-ajax-scriptcontrol-tutorial.html)

**RegisterStartupScript 和 RegisterClientScriptBlock：**

允许您在页面上包含客户端脚本块。请参阅下面的一些链接：
[使用客户](http://msdn.microsoft.com/en-us/library/aa479302) [端脚本从 ASP.NET 服务器控件注入客户端脚本](http://msdn.microsoft.com/en-us/library/aa478975#aspnet-injectclientsidesc_topic2)

**HtmlGenericControl：**

没有什么能阻止您动态地创建脚本标记并将所有 javascript 逻辑插入到`InnerHtml`属性中。它可以在初始请求期间完成。

例子：

```
HtmlGenericControl script = new HtmlGenericControl("script");
script.ID = "script";
script.Attributes.Add("type", "text/javascript");
script.InnerHtml = "alert('Hey');";

//Insert the script into some asp:Panel
panel.Controls.Add(script); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-31T18:52:48.177

四年后读到这篇文章，我可以告诉过去的自己：

1.  是的，只需在页面上包含 json，隐藏以供 JS 拾取。但请注意，这会增加必须由客户端浏览器下载的响应的大小。这不仅需要更多时间，而且会消耗更多移动用户的昂贵数据。如果有很多数据并且有些数据可能不会被使用，那么根据需要从 Web 服务中检索数据可能是一个更好的选择。

2.  REST 服务是响应 AJAX 请求的常用解决方案。如果您想允许来自匿名用户的客户端脚本获取数据，那么您无法保护匿名用户的数据。

# java - antlr 标识符名称与预定义函数名称相同导致 MismatchedTokenException

> ID：14883587
> 
> 赞同：3
> 
> 时间：2013-02-14T20:37:50.950
> 
> 标签：java, antlr, antlr3

我已经定义了一个 ANTLR 语法：

```
grammar test5;

stats_statement
:   
    STATS IDENT ASSIGN_SYM functions_stats

;

functions_stats 

:   COUNT LPAREN IDENT RPAREN   
;

STATS
:   'STATS'
;   

COUNT
:   'count'
;   

IDENT
:   (LETTER | '_') (LETTER | DIGIT | '_')*
;   

ASSIGN_SYM
: ':='
;

COMMA_SYM
: ','
;

SEMI_SYM
: ';'
;

LPAREN 
: '(' ;

RPAREN 
: ')' ;

fragment 
LETTER : ('a'..'z' | 'A'..'Z') ;

fragment 
DIGIT : '0'..'9'; 
```

它有一个内置函数“count”。但是，如果我使用以下测试字符串：

```
STATS count:=count(col1) 
```

解析器将返回一个错误说：

```
mismatched input 'count' expecting IDENT 
```

有关如何解决此问题的任何线索和/或提示？

谢谢查尔斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:52:49.770

创建一个与and`ident`匹配的规则，并在解析器规则中使用该规则（而不是使用）：`IDENT``COUNT``IDENT`

```
stats_statement
 : STATS ident ASSIGN_SYM functions_stats
 ;

functions_stats 
 :   COUNT LPAREN ident RPAREN   
 ;

ident
 : COUNT
 | IDENT
 ; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T19:28:48.873

你真的需要 COUNT 在词法分析器中被识别吗？考虑定义一个更通用的方法来匹配函数。

```
function 
  :   fn=IDENT LPAREN IDENT (',' IDENT)* RPAREN   
  ; 
```

然后您可以添加一个操作来处​​理您的语义，例如在表中查找函数名称并确保它具有正确数量的参数等。

如果这不符合您需要做的事情，您可以改为消除您的`COUNT`规则并重写您的`functions_stats`规则：

```
functions_stats 
  :   {input.LT(1).getText().equals("count")}? IDENT LPAREN IDENT RPAREN   
  ; 
```

这`{...}?`是一个消除歧义的语义谓词（参见 Terence Parr 的 The Definitive ANTLR Reference 的第 295 页）。只有当它评估为真时才会匹配。ANTLR 3 有一个称为“提升语义谓词”的功能，这基本上意味着将语义谓词放入适当的调用者中，`functions_stats`以便使用信息来决定解析什么。

这本书的第 296 页有一个名为“关键字作为变量”的部分，这是该章的示例代码：http: [//media.pragprog.com/titles/tpantlr/code/predicates/keywords/Pred.g](http://media.pragprog.com/titles/tpantlr/code/predicates/keywords/Pred.g)这可能会给你更好的理解。

如果您正在进行高级 ANTLR 工作，这本书本身就非常有用。在线文档并没有很好地涵盖这些内容。

# php - 使用变量和 htaccess 获取 PHP 表单

> ID：14883595
> 
> 赞同：0
> 
> 时间：2013-02-14T20:38:11.627
> 
> 标签：php, forms, apache, .htaccess, variables

我有一个小型系统设置，表单设置变量，然后从表单中的 URL 回显该变量，因此用户知道他们看到的信息是哪个用户名。

[http://pastie.org/6168045](http://pastie.org/6168045)

目前，htaccess 重定向正在工作，因为我希望 URL 看起来比显示 /?name=x 更好

这已经停止了表单的工作，它现在将变量设置为：[http ://dev.jaycraft.co/banned/test?name=test2](http://dev.jaycraft.co/banned/test?name=test2)

我需要将表单设置为 dev.jaycraft.co/banned/test2。

谢谢，詹姆斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T21:03:52.773

能否请您出示您的 .htaccess 文件？我想我知道您的意思应该如下所示

```
Options +FollowSymLinks
RewriteEngine on

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

RewriteRule ^banned/([^\/]*)\/?$   http://dev.jaycraft.co/banned/test.php?name=$1 [L] 
```

# ajax - 仅有时更新计算的 observable

> ID：14883599
> 
> 赞同：0
> 
> 时间：2013-02-14T20:38:26.147
> 
> 标签：ajax, knockout.js

我有一个计算的 observable，它根据其他数据（在计算的 observable 中）进行 AJAX 调用。生成的数据用于填充 UI 的一部分。有时 UI 的那部分是隐藏的，我想在隐藏时避免 AJAX 调用。现在我有以下内容，但只要`isVisible`变为`true`：

```
this.loadData = ko.computed(function() {
    if (this.isVisible()) {
        this.isProcessing(true);
        var self = this;
        $.when.apply($, ko.utils.arrayMap(this.parent.data.filteredSelectedDatasetLinks(), function(datasetLink) {
            return $.ajax({
                url: datasetLink.getDownloadUrl('.json'),
                success: function(data) {
                    //... do stuff with the data
                }
            });
        }))
        .done(function() {
            self.isProcessing(false);
        });
    }
}, this); 
```

所以很明显我需要以某种方式把它分开，但我还没有想出如何去做。重申一下，当`isVisible`为假时，不应该发生更新。当`isVisible`为真时，只要`filteredSelectedDatasetLinks`发生变化就会发生更新。当`isVisible`变为 true 时，如果`filteredSelectedDatasetLinks`在它为 false 时发生更改，则会发生更新。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T23:48:56.797

大概你想在`filteredSelectedDatasetLinks`改变时调用你的ajax（并且只有在可见的情况下？）。我认为最好的方法是使用函数使依赖项显式`subscribe`化......（我已经稍微简化并修复了你最终的“this”的问题）

```
this.filteredSelectedDatasetLinks.subscribe(function() {
    if (this.isVisible()) {
        this.isProcessing(true);
        var self = this;
        $.when.apply($, ko.utils.arrayMap(this.filteredSelectedDatasetLinks(), function(datasetLink) {
            return $.ajax({
                url: datasetLink.getDownloadUrl('.json'),
                success: function(data) {
                    //... do stuff with the data
                }
            });
        }))
        .done(function() {
            self.isProcessing(false);
        });
    }
}, this); 
```

您最初尝试的问题是 ko.computed 运行该函数一次并自动计算出它需要订阅哪些 observables。在您的情况下，这包括`isVisible`可观察的（这不是您想要的）。但是直接通过 subscribe 调用使其明确，您不再需要担心`isVisible`触发回调。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-16T00:03:29.303

这是我根据 RP Niemeyer 的评论最终使用的内容。

```
this.trackData = ko.computed(function() {
    this.parent.data.filteredSelectedDatasetLinks();    // for notification
    this.isDataDirty(true);
}, this);

this.loadData = ko.computed(function() {
    if (this.isVisible() && this.isDataDirty()) {
        this.isDataDirty(false);
        this.isProcessing(true);
        var self = this;
        $.when.apply($, ko.utils.arrayMap(this.parent.data.filteredSelectedDatasetLinks.peek(), function(datasetLink) {
            return $.ajax({
                url: datasetLink.getDownloadUrl('.json'),
                success: function(data) {
                    //... do stuff with the data
                }
            });
        }))
        .done(function() {
            self.isProcessing(false);
        });
    }
}, this); 
```

# javascript - 如何在选择菜单上显示或隐藏 a？

> ID：14883603
> 
> 赞同：0
> 
> 时间：2013-02-14T20:38:41.283
> 
> 标签：javascript, select

我有两个`<td>`挨着的。它们都是`<select>`下拉菜单。当且仅当第一个具有选项值或 id 时，我想显示一个`scantron`。

我的功能如下：

```
<script type="application/javascript">
    function EnableDisableTD() {
              if ($("#scantron").attr("selected")) {
                  $("#version").show();
              } else {
              $("#version").hide();
              }};
</script> 
```

这是我的html：

```
<td><select>
  <option selected="selected">Computer Based Format</option>
  <option id="scantron">Scantron Format</option>
</select></td>
<td id="version"><select name="version">
  <option selected="selected">1</option>
  <option>2</option>
  <option>3</option>
  <option>4</option>
</select></td> 
```

为什么这对我不起作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:49:05.760

像这样的东西应该工作。您可能没有使用过某个[`.ready()`](http://api.jquery.com/ready/)功能。

```
function EnableDisableTD() {
  $('#version')[$('#scantron').attr('selected')) ? 'show' : 'hide']();
}

// Document ready
$(EnableDisableTD); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T20:39:52.417

您需要隐藏`td`，而不是`select`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T20:43:01.793

尝试将“版本”id 放在 td 中而不是选择中：

```
...   
<td id="version"><select name="version">
      <option selected="selected">1</option>
... 
```

# magento - 如何在将产品添加到购物车之前在 magento 产品视图中应用优惠券

> ID：14883605
> 
> 赞同：2
> 
> 时间：2013-02-14T20:38:49.010
> 
> 标签：magento, magento-1.7

我必须复制优惠券功能，用户可以在其中应用优惠券代码并在将产品添加到购物车之前在产品页面本身中查看折扣价格。

所以我使用ajax调用来加载优惠券代码，它的规则条件如下所示

```
<?php
-----

    $oCoupon = Mage::getModel('salesrule/coupon')->load($couponcode, 'code');
    if($oCoupon){
            $oRule     = Mage::getModel('salesrule/rule')->load($oCoupon->getRuleId());
            $rule_arr       = unserialize($oRule->getConditionsSerialized());
            $actions_serialized = unserialize($oRule->getData("actions_serialized"));
            $conditions = $rule_arr['conditions'];
            foreach($conditions as $condition){
                $conditions1 = $condition['conditions'];
                $type        = $condition['type'];
                foreach($conditions1 as $condition1){
                    $type     = $condition1['type'];
                    $value    = $condition1['value'];

                }
            }
        }
    }

---- 
```

在这里，我验证了所有可能的规则 - 但它仍然没有验证所有定义的规则并且它不稳定。

**无论如何我可以验证产品和优惠券规则 - 或者是否有任何扩展可以针对一个产品和优惠券规则进行验证**。请帮我

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T21:12:58.293

由于您可以像这样将代码应用于购物车/报价，因此我建议查看这些模型以了解它如何实际验证产品上的代码。（向后工作）

```
Mage::getSingleton('checkout/cart')
    ->getQuote()
    ->setCouponCode($couponcode)
    ->collectTotals()
    ->save(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T21:48:47.057

我建议看看这个免费的扩展以获得灵感： http: [//www.magentocommerce.com/magento-connect/estimate-shipping-on-the-product-page.html](http://www.magentocommerce.com/magento-connect/estimate-shipping-on-the-product-page.html)

它允许通过模拟空购物车、添加产品和收集运费来在产品页面中显示运费估计。

您要做的是模拟空购物车，添加产品，应用优惠券（使用 Jared Kipe 的方法）并获取总数。

该模块将激发您的灵感，并为您提供模拟空购物车的方法。

# magento - 获取 Magento 中正在编辑的产品的 productID

> ID：14883607
> 
> 赞同：1
> 
> 时间：2013-02-14T20:38:53.960
> 
> 标签：magento

在 Magento 中，有没有办法在管理后端获取当前正在编辑的产品的 productID？

我找到了这个：

```
Mage::registry('current_product'); 
```

但它似乎没有得到正在编辑的那个。

编辑：如果有任何区别，我正在尝试从监听事件的扩展中获取它：

```
catalog_product_gallery_upload_image_after 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T20:55:42.947

当前产品的 ID 在 URL 中。您可以将其作为参数检索，如下所示：

```
$productId = Mage::app()->getRequest()->getParam('id'); 
```

如果要将产品作为对象加载，请存储该 ID 并使用

```
$product = Mage::getModel('catalog/product')->load($productId); 
```

编辑：看起来你正在使用观察者。我假设观察者文件本身不会扩展 Magento 的任何部分。（这是文件吗？[http://svn.magentocommerce.com/source/branches/1.7/app/code/core/Mage/Adminhtml/controllers/Catalog/Product/GalleryController.php](http://svn.magentocommerce.com/source/branches/1.7/app/code/core/Mage/Adminhtml/controllers/Catalog/Product/GalleryController.php)）尝试获取操作并获取请求那样

```
$action = $observer->getAction();
$productId = $action->getRequest()->getParam('id'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T20:56:38.140

`Mage::registry('product')`只要在调用之后请求它，它就应该起作用`Mage_Adminhtml_Catalog_ProductController::_initProduct()`。

`Mage::app()->getRequest()->getParam('id')`也应该工作。

**根据事件编辑**

被观察的事件是响应 JS 发起的请求而调度的。控制器操作不知道调用上下文，并且注册表中没有注册产品。记录请求参数或可能的引荐来源可能会提供洞察力。

# jquery - 在块元素之间使用 next()

> ID：14883609
> 
> 赞同：0
> 
> 时间：2013-02-14T20:38:53.630
> 
> 标签：jquery, next

我正在尝试使用 jQuery`next()`来抓取所选元素的下一段，但是因为有一个 div 挡住了，似乎 next 不起作用。我应该改用什么选择器？

作品：

```
<div>
   <span class="clickme">A name here</span>
   <p class="showme" style="display:none;">Here's some text! </p>
</div>
$('.clickme').click(function() {
   $(this).next('.showme').slideDown();
}); 
```

不工作：

```
<div>
   <span class="clickme">A name here</span>
   <div></div>
   <p class="showme" style="display:none;">Here's some text! </p>
</div>
$('.clickme').click(function() {
   $(this).next('.showme').slideDown();
}); 
```

为什么会出现这种情况？`next()`指定的类不会超出下一个块元素吗？这就是发生这种情况的原因吗？是否有一个选择器指定`showme`应该选择的“下一个”类？

小提琴 - [http://jsfiddle.net/QespX/](http://jsfiddle.net/QespX/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T20:44:00.713

`.next()`：获取匹配元素集中每个元素的紧随其后的兄弟。如果提供了选择器，则仅当它与该选择器匹配时，它才会检索下一个兄弟。

`.nextAll()`：获取匹配元素集中每个元素的所有后续兄弟，可选地由选择器过滤。

所以这就是你的方式

```
$('.clickme').click(function() { 
    $(this).nextAll('.showme').slideDown();   //as clickme>showme
}); 
```

有关[树遍历](http://api.jquery.com/category/traversing/tree-traversal/)的更多信息可以在 jQuery API 文档中找到。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T20:41:09.500

您可以使用[`.nextAll()`](http://api.jquery.com/nextAll/)：

```
$('.clickme').click(function() {
    $(this).nextAll('.showme').slideDown();
}); 
```

**演示：http: [//jsfiddle.net/QespX/1/](http://jsfiddle.net/QespX/1/)**

这有效的唯一原因是因为`.showme`是`.clickme`. `.nextAll()`将选择您单击的元素之后的*所有*`.showMe`元素，但由于您只有一个，它会起作用。

如果这是一个问题，您可以使用`.first()`来缩小结果范围：

```
$(this).nextAll('.showme').first().slideDown(); 
```

# java - 使用 Google Analytics 跟踪片段

> ID：14883613
> 
> 赞同：30
> 
> 时间：2013-02-14T20:38:59.630
> 
> 标签：java, android, google-analytics

只需要知道实施 Google 分析以实时跟踪用户何时在片段上的正确方法，这就是现在要做的事情

```
@Override
public void onResume() {
    super.onResume();
    Tracker myTracker = parentActivity.getTracker();
    myTracker.setCustomMetric(1, (long) 1);               
    myTracker.sendView("Music View"); 
} 
```

getTracker 类在我的主要活动中，只返回主要活动中的跟踪器实例

任何帮助将非常感激！

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2013-10-09T22:37:06.483

Mochini 的回答使用 Google Analytics V2。您可以在下面看到如何在 V4 和 V3 上执行此操作：

*   **V4**：

**应用：**

```
public class YourApplication extends Application
{
    public synchronized Tracker getTracker() {

        try {
            final GoogleAnalytics googleAnalytics = GoogleAnalytics.getInstance(this);
            return googleAnalytics.newTracker(R.xml.analytics);

        }catch(final Exception e){
            Log.e(TAG, "Failed to initialize Google Analytics V4");
        }

        return null;
    }
} 
```

**res/xml/analytics.xml**（你可以给它起任何名字，它不需要叫“analytics”）

```
<?xml version="1.0" encoding="utf-8" ?>
<resources xmlns:tools="http://schemas.android.com/tools" tools:ignore="TypographyDashes">

  <!--Replace placeholder ID with your tracking ID-->
  <string name="ga_trackingId">UA-XXXXXXXX-X</string>

  <!--Enable automatic activity tracking-->
  <bool name="ga_autoActivityTracking">true</bool>

  <!--Disable automatic exception tracking-->
  <bool name="ga_reportUncaughtExceptions">false</bool>

</resources> 
```

**构建.gradle：**

```
compile 'com.google.android.gms:play-services:7.3.0' 
```

**片段超类：**

```
public abstract class TrackedFragment extends Fragment{

    @Override
    public void onResume() {

        super.onResume();

        final Tracker tracker = yourApplicationInstance.getTracker();
        if(tracker != null){

            tracker.setScreenName(getClass().getSimpleName());
            tracker.send(new HitBuilders.ScreenViewBuilder().build());
        }
    }
} 
```

*   **V3**

    ```
    import android.os.Bundle;
    import android.support.v4.app.Fragment;

    import com.google.analytics.tracking.android.EasyTracker;
    import com.google.analytics.tracking.android.Fields;
    import com.google.analytics.tracking.android.MapBuilder;
    import com.google.analytics.tracking.android.Tracker;

    public abstract class TrackedFragment extends Fragment{

         private Tracker tracker;

         @Override
         public void onActivityCreated(final Bundle savedInstanceState) {

             super.onActivityCreated(savedInstanceState);

             this.tracker = EasyTracker.getInstance(getActivity());
         }

         @Override
         public void onResume() {

             super.onResume();

             this.tracker.set(Fields.SCREEN_NAME, getClass().getSimpleName());
             this.tracker.send( MapBuilder.createAppView().build() );
         }
    } 
    ```

来源：[https ://developers.google.com/analytics/devguides/collection/android/v3/migration](https://developers.google.com/analytics/devguides/collection/android/v3/migration)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-09-06T17:23:46.297

这是一个使用`FragmentActivity`和片段的示例：

1.  在值文件夹 ( ) 中创建 XML 文件`values/analytics.xml`：

    ```
    <?xml version="1.0" encoding="utf-8"?>
    <resources>

        <!-- Replace placeholder ID with your tracking ID -->
        <string name="ga_trackingId">XX-xxxxxxxx-x</string>

        <!-- Enable Activity tracking -->
        <bool name="ga_autoActivityTracking">true</bool>

        <!-- Enable debug -->
        <bool name="ga_debug">true</bool>

        <!-- The screen names that will appear in your reporting -->
        <string name="com.example.myapp.FragmentActivity">Fragment activity</string>

        <!--
            The inverval of time after all the collected data
            should be sent to the server, in seconds.
        -->
        <integer name="ga_dispatchPeriod">20</integer>

    </resources> 
    ```

2.  在您的`FragmentActivity`班级中，添加以下内容：

    ```
    @Override
    protected void onStart() {
        super.onStart();
        EasyTracker.getInstance().setContext(this.getBaseContext());
        EasyTracker.getInstance().activityStart(this); // Add this method
    }

    @Override
    protected void onStop() {
        super.onStop();
        EasyTracker.getInstance().activityStop(this); // Add this method
    } 
    ```

3.  在你的包中创建新类：`TrackedFragment.java`

    ```
    public class TrackedFragment extends Fragment {
        private Tracker tracker;
        private String activityId;
        private String fragmentId;

        @Override
        public void onCreate(final Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            EasyTracker.getInstance().setContext(getActivity().getApplicationContext());
            this.tracker = EasyTracker.getTracker();
            this.fragmentId = getClass().getSimpleName();
            this.activityId = getActivity().getClass().getSimpleName();
        }

        @Override
        public void onResume() {
            super.onResume();
            this.tracker.sendView("/" + this.activityId + "/" + this.fragmentId);
        }
    } 
    ```

4.  最后，您的片段应该从以下扩展`TrackedFragment`：

    ```
    public class NewFragment extends TrackedFragment {

        public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
            return inflater.inflate(R.layout.newfragment, null);
        }

    } 
    ```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-02T01:35:55.093

[跟踪方法部分](https://developers.google.com/analytics/devguides/collection/android/v2/#tracking-methods)建议您只需`EasyTracker.getInstance().setContext(getActivity());`要先调用，然后您可以在“其他类”中使用跟踪器。

[手动屏幕跟踪部分](https://developers.google.com/analytics/devguides/collection/android/v2/screens#manual)建议您可以`Fragment`使用`myTracker.sendView("Home Screen");`

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-01-18T23:27:55.420

V3 的另一种方法（因为`onResume()`与 Activity 而不是 Fragment 相关联。当父/子关系众所周知时，这很有效。

父片段发送初始事件`onStart()`：

```
public class ParentFragment extends Fragment {
    private Tracker mTracker;

    @Override
    public void onActivityCreated(Bundle savedInstanceState) {
        super.onActivityCreated(savedInstanceState);

        mTracker = EasyTracker.getInstance(getActivity());
    }

    @Override
    public void onStart() {
        super.onStart();

        mTracker.set(Fields.SCREEN_NAME, "Parent Fragment");
        mTracker.send(MapBuilder.createAppView().build());
    }
} 
```

子片段覆盖`onStart()`和`onStop()`：

```
public class ChildFragment extends Fragment {
    private Tracker mTracker;

    @Override
    public void onActivityCreated(Bundle savedInstanceState) {
        super.onActivityCreated(savedInstanceState);

        mTracker = EasyTracker.getInstance(getActivity());
    }

    @Override
    public void onStart() {
        super.onStart();

        mTracker.set(Fields.SCREEN_NAME, "Child Fragment");
        mTracker.send(MapBuilder.createAppView().build());
    }

    @Override
    public void onStop() {
        super.onStop();

        mTracker.set(Fields.SCREEN_NAME, "Parent Fragment");
        mTracker.send(MapBuilder.createAppView().build());
    }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-07-15T21:48:21.650

Tiago 的版本不能在新的 goole analytics v4 中使用。相反，请使用[Google 文档中的此代码](https://developers.google.com/analytics/devguides/collection/android/v4/events)

```
package com.google.android.apps.mobileplayground;

import com.google.android.apps.mobileplayground.AnalyticsSampleApp.TrackerName;
import com.google.android.gms.analytics.GoogleAnalytics;
import com.google.android.gms.analytics.HitBuilders;
import com.google.android.gms.analytics.Tracker;

import android.os.Bundle;
import android.support.v4.app.Fragment;
import android.view.LayoutInflater;
import android.view.View;
import android.view.View.OnClickListener;
import android.view.ViewGroup;
import android.widget.Button;

/**
 * Class to exercise Event hits.
 */
public class EventFragment extends Fragment {

  @Override
  public View onCreateView(LayoutInflater inflater, ViewGroup container,
      Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    View view = inflater.inflate(R.layout.event, container, false);

    setupEvent(view, R.id.video1Play, R.string.videoCategory, R.string.videoPlay, R.string.video1);
    setupEvent(view, R.id.video1Pause, R.string.videoCategory, R.string.videoPause,
        R.string.video1);
    setupEvent(view, R.id.video2Play, R.string.videoCategory, R.string.videoPlay, R.string.video2);
    setupEvent(view, R.id.video2Pause, R.string.videoCategory, R.string.videoPause,
        R.string.video2);

    setupEvent(view, R.id.book1View, R.string.bookCategory, R.string.bookView, R.string.book1);
    setupEvent(view, R.id.book1Share, R.string.bookCategory, R.string.bookShare, R.string.book1);

    final Button dispatchButton = (Button) view.findViewById(R.id.eventDispatch);
    dispatchButton.setOnClickListener(new OnClickListener() {
      @Override
      public void onClick(View v) {
        // Manually start a dispatch (Unnecessary if the tracker has a dispatch interval)
        GoogleAnalytics.getInstance(getActivity().getApplicationContext()).dispatchLocalHits();
      }
    });
    return view;
  }

  private void setupEvent(View v, int buttonId, final int categoryId, final int actionId,
      final int labelId) {
    final Button pageviewButton = (Button) v.findViewById(buttonId);
    pageviewButton.setOnClickListener(new OnClickListener() {
      @Override
      public void onClick(View v) {
        // Get tracker.
        Tracker t = ((AnalyticsSampleApp) getActivity().getApplication()).getTracker(
            TrackerName.APP_TRACKER);
        // Build and send an Event.
        t.send(new HitBuilders.EventBuilder()
            .setCategory(getString(categoryId))
            .setAction(getString(actionId))
            .setLabel(getString(labelId))
            .build());
      }
    });
  }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-02-06T13:34:54.580

使用 android 谷歌分析 v4

我试过了，它奏效了

引用此[https://developers.google.com/analytics/devguides/collection/android/v4/events](https://developers.google.com/analytics/devguides/collection/android/v4/events)

```
import java.net.URLEncoder;
import android.os.Bundle;
import android.support.v4.app.Fragment;
import android.util.Xml.Encoding;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.webkit.WebView;
import android.widget.ScrollView;
import android.widget.TextView;
import com.Blog.gkgyan.AnalyticsSampleApp.TrackerName;
import com.Blog.gkgyan.parser.RSSFeed;
import com.google.android.gms.ads.AdRequest;
import com.google.android.gms.ads.AdView;
import com.google.android.gms.analytics.GoogleAnalytics;
import com.google.android.gms.analytics.HitBuilders;
import com.google.android.gms.analytics.Tracker;
public class DetailFragment extends Fragment {
    private int fPos;
    RSSFeed fFeed;
    String country;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        fFeed = (RSSFeed)getArguments().getSerializable("feed");
        fPos = getArguments().getInt("pos");
        Tracker t = ((AnalyticsSampleApp) getActivity().getApplication()).getTracker(
                TrackerName.APP_TRACKER);
            // Build and send an Event.
            t.send(new HitBuilders.EventBuilder()
                .setCategory(fFeed.getItem(fPos).getTitle())
                .setAction("viewpager click")
                .setLabel("viewpager label")
                .build());
    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
    View view = inflater.inflate(R.layout.detail_fragment, container, false);
      // Initializr views
        TextView title = (TextView)view.findViewById(R.id.title);
        WebView desc = (WebView)view.findViewById(R.id.desc);
        // Enable the vertical fading edge (by default it is disabled)
        ScrollView sv = (ScrollView)view.findViewById(R.id.sv);
        sv.setVerticalFadingEdgeEnabled(true);

        // Set the views
        desc.getSettings().setJavaScriptEnabled(true);
        title.setText(fFeed.getItem(fPos).getTitle());

        country = "<html xmlns=\"http://www.w3.org/1999/xhtml\"><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=iso-8859-1\"><style type=\"text/css\">p{text-align:justify;font-size:125%;}</style></head><body>" + "<p>" + fFeed.getItem(fPos).getDescription()+"</p>"+"</body></html>";
        //desc.loadData( country, "text/html", "UTF-8");
        //desc.loadData( country,  "text/html; charset=utf-8", "utf-8");
        desc.loadData( URLEncoder.encode(country).replaceAll("\\+", " "), "text/html", Encoding.UTF_8.toString());
        return view;
      }
} 
```

# java - 更改在另一个包中声明且其变量由其父类构造的类的实例对象的属性

> ID：14883616
> 
> 赞同：-1
> 
> 时间：2013-02-14T20:39:14.147
> 
> 标签：java, swing, inheritance, 2d

好的，所以我有一堆类，我想旋转一个具有对象形状的对象，它是一个二维数组，并且在对象类的父类中构造。我想更改方法 rotate() 中的属性（形状），该方法调用方法 multiplyarray 通过更改形状进行旋转。然而，我意识到我无法使用形状，或者至少我不知道如何改变它。我不认为父类有一个公共的 setShape 方法。无论如何，这是代码：

```
public static int[][] multiplyMatrix(int[][] m1) {

    int[][] m2 = { { 0, 0, 0, 1 }, { 0, 0, 1, 0 }, { 0, 1, 0, 0 },
            { 1, 0, 0, 0 }, };

    int[][] result = new int[4][4];

    // multiply
    for (int i = 0; i < 4; i++)
        for (int j = 0; j < 4; j++)
            for (int k = 0; k < 4; k++)
                if (m1[i][k] * m2[k][j] > 0) {
                    result[i][j] = 1;
                } else {
                    result[i][j] = 0;
                }

    return result;
} 
```

旋转方法：

```
synchronized void rotateClockwise() {
    currentPiece.shape = multiplyMatrix(shape);

    //gives me an error
    updateLocation();
} 
```

构造函数（所有三个方法都在同一个类中）：

```
 public Piece(int shape[][]) {
    super(shape);
    currentX = 7;
    currentY = 2;
    updateLocation();
} 
```

此方法在另一个类中，它包含我要修改其属性的实例对象：

```
public void keyPressed(KeyEvent event) {
    int key = event.getKeyCode();
    switch (key) {
    case KeyEvent.VK_UP: // up arrow
    case KeyEvent.VK_KP_UP:
        currentPiece.rotateCounterclockwise();
        break;
    case KeyEvent.VK_DOWN: // down arrow
    case KeyEvent.VK_KP_DOWN:
        currentPiece.rotateClockwise();
        break;
    case KeyEvent.VK_LEFT: // left arrow
    case KeyEvent.VK_KP_LEFT:
        currentPiece.moveLeft();
        break;
    case KeyEvent.VK_RIGHT: // right arrow
    case KeyEvent.VK_KP_RIGHT:
        currentPiece.moveRight();
        break;
    case KeyEvent.VK_SPACE: //  space bar
        currentPiece.drop();
    }
} 
```

createPiece 方法（我想访问 shape 属性）：

```
public static Piece createPiece() {
    int[][] s = SHAPES[(int) (Math.random() * SHAPES.length)];
    switch ((int) (Math.random() * 10)) {
    case 0:
    case 1:
    case 2:
    case 3:
    default:
        return new Piece(s);
    }
} 
```

整个代码可以在这里找到（没有某些修改）：

[http://mathcs.slu.edu/~fritts/cse131/labs/lab9/index.html](http://mathcs.slu.edu/~fritts/cse131/labs/lab9/index.html)

更新：

我发现 super 在 Grid 中调用了这个构造函数：

```
public Grid(int[][] contents) {
    this.contents = contents;
    Dimension d = new Dimension(getColumns()*Tetris.SQUARE_SIZE,
                                getRows()*Tetris.SQUARE_SIZE);
    setSize(d);
    setPreferredSize(d);
    setOpaque(false);
} 
```

现在，我尝试了这个：

```
synchronized void rotateClockwise() {
Grid.contents = multiplyMatrix(Grid.contents);
updateLocation();

} 
```

它给了我：

不能从静态上下文引用非静态方法 getContents()

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T22:51:21.983

您没有向我们展示超类的代码，但一种方法可能是`shape`在子类中创建字段的镜像，覆盖 getter 并添加一个 setter；例如

```
 public class Super {
      private Shape shape;
      public Super(Shape shape) { this.shape = shape; }
      public Shape getShape() { return this.shape; }
  }

  public class Sub extends Super {
      private Shape myShape;

      public Sub(Shape shape) {
          super(shape);
          this.myShape = shape;
      }

      @Override
      public Shape getShape() { return this.myShape; }

      public void setShape(Shape shape) { this.myShape = shape; }
  } 
```

这种方法只有在`Super`设计允许时才有效。特别是`Super`必须使用`getShape()`取值`Shape`。

（如果不是为了支持扩展而设计的，有一些*可怕*`Super`的解决方法，但我敢肯定你的老师不希望你在这里使用它们......）

# php - PHP-MYSQL：将 Unix 时间戳转换为 DateTime，反之亦然

> ID：14883617
> 
> 赞同：27
> 
> 时间：2013-02-14T20:39:16.333
> 
> 标签：php, mysql, datetime, unix-timestamp

我正在使用 php 5.4.6 和 MySQL 5.5.29，我通过将 UNIX TIMESTAMP 转换为 MYSQL DATETIME 遇到了麻烦，反之亦然。Mysql 和 php 在同一台本地机器上运行。

我有一个简单的 mysql 表

```
CREATE TABLE Entry(
id SERIAL PRIMARY KEY,
created DATETIME NOT NULL); 
```

要插入数据，我使用 php PDO 和 mysql NOW()。这工作正常，正确的日期时间存储在数据库中。

我的计划是在客户端使用 unix 时间戳（在服务器端使用 php 和 mysql）。

所以我想向我的客户提供 unix 时间戳。因此我使用 MySql UNIX_TIMESTAMP() 函数直接在查询中转换它。

因此示例查询如下所示：

```
SELECT created, UNIX_TIMESTAMP(created) AS TS FROM Entry 
```

结果：创建 = 2013-02-14 20:47:35 TS = 1360871255

所以现在我想做另一种方式，我传递一个 UNIX 时间戳，并想将它与我的数据库中的条目进行比较。不幸的是，我无法编写有效的 PHP 脚本。我不知道为什么，但是当我将相同的时间戳 (1360871255) 传递给 PHP 时，我没有使用这种方法得到 2013-02-14 20:47:35：

```
public static function toDateTime($unixTimestamp){
    return date("Y-m-d H:m:s", $unixTimestamp);
} 
```

当我调用 toDateTime(1360871255) 将返回 2013-02-14 20:02:35 这不是原始日期时间。

我知道，我不需要将 1360871255 格式化为 Ymd H:m:s 即可在 MYSQL 中使用它，但 1360871255 似乎不是我预期的时间（并且 MYSQL UNIX_TIMESTAMP 已返回）。

我想做的是一个简单的查询，它向我显示早于某个时间戳的条目，如下所示：

```
SELECT * FROM Entry WHERE created < 1360871255 
```

但正如我之前提到的，查询结果不是预期的，因为 1360871255 似乎不是正确的时间。

我没有为 php.ini 中的 mysql 连接指定任何特殊时区。

有什么建议么？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2013-02-14T20:42:22.903

您的[日期格式](http://php.net/manual/en/function.date.php)错误......`i`是分钟，而不是`m`（月）。

```
return date("Y-m-d H:i:s", $unixTimestamp); 
```

一些旁注：

*   无需重新分配，即`$unixTimestamp = $unixTimestamp;`
*   由于您使用的是 PHP > 5.3。您可能对新的[DateTime](http://php.net/manual/en/class.datetime.php)对象感兴趣。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-14T20:50:42.770

问题在于您编写的函数：

```
return date("Y-m-d H:m:s", $unixTimestamp); 
```

您在日期和时间部分都指定月份（m）。您应该将第二个*m*替换为*i*，在 PHP 中使用 date() 时正确的小时标志。

```
return date("Y-m-d H:i:s", $unixTimestamp); 
```

根据您的需要，您可能会发现 PHP 函数 strtotime() 足够有用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-04-07T09:45:24.077

为什么不简单地使用 mysql 中的 FROM_UNIXTIME 函数呢？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-11-17T12:32:06.687

```
function format_date($str) {
    $month = array(" ", "Jan", "Feb", "Mar", "Apr", "May", "June", "July", "Aug", "Sep", "Oct", "Nov", "Dec");
    $y = explode(' ', $str);
    $x = explode('-', $y[0]);
    $date = "";    
    $m = (int)$x[1];
    $m = $month[$m];
    $st = array(1, 21, 31);
    $nd = array(2, 22);
    $rd = array(3, 23);
    if(in_array( $x[2], $st)) {
            $date = $x[2].'st';
    }
    else if(in_array( $x[2], $nd)) {
            $date .= $x[2].'nd';
    }
    else if(in_array( $x[2], $rd)) {
            $date .= $x[2].'rd';
    }
    else {
            $date .= $x[2].'th';
    }
    $date .= ' ' . $m . ', ' . $x[0];

    return $date;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-12-27T14:59:25.617

两者都没有。您应该将时间戳保存为`INT`or`BIGINT`因为如果您使用`TIMESTAMP`mysql 的格式，您将永远无法将其恢复为`int`. 你只能得到这样的东西`1970-01-01 01:00:00`。

# android - 滑动菜单（库）始终全屏

> ID：14883622
> 
> 赞同：7
> 
> 时间：2013-02-14T20:39:41.593
> 
> 标签：android, layout, menu

我正在尝试在我的应用程序中实现[滑动菜单库](https://github.com/jfeinstein10/SlidingMenu)。我现在的问题是我似乎无法控制菜单的宽度。它始终是全屏的。

谁能告诉我如何解决这个问题？

这是我一直在玩的代码。

```
SlidingMenu menu = new SlidingMenu(this);
menu.setMode(SlidingMenu.LEFT);
menu.setTouchModeAbove(SlidingMenu.TOUCHMODE_MARGIN);
menu.setBehindWidth(10);
menu.attachToActivity(this, SlidingMenu.SLIDING_WINDOW); 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-24T21:39:08.253

对于那些碰巧偶然发现这个问题的人，寻找如何解决它 - 我能够通过在我的`onCreate`方法中使用以下代码来解决我的问题。

```
SlidingMenu sm = getSlidingMenu();
sm.setShadowWidthRes(R.dimen.slidingmenuWidth);
sm.setBehindOffsetRes(R.dimen.slidingmenuOffset);
sm.setFadeDegree(0.35f);
sm.setTouchModeAbove(SlidingMenu.TOUCHMODE_FULLSCREEN);

<dimen name="slidingmenuWidth">15dp</dimen>
<dimen name="slidingmenuOffset">60dp</dimen> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T21:10:28.477

提交日志之一读取`Only behind width not working now [jfeinstein10]`。应该是坏了吧

您可以做的是找到包含所有内容的最大组件并`android:minWidth`对其进行设置。粗略地看了一下，似乎它可能是`menu_frame.xml`。但你可能想检查一些事情。

# .net - Oracle ODP.NET 使用参数调用包过程时出现问题

> ID：14883627
> 
> 赞同：4
> 
> 时间：2013-02-14T20:40:25.787
> 
> 标签：.net, oracle, oracle10g, odp.net, oracle9i

**问题：** 尝试调用打包的存储过程，但调用失败，具体取决于参数的值。

```
ORA-06502: PL/SQL: numeric or value error
ORA-06512: at line 1 
```

**程序定义：**

```
procedure DUP_EXACT (
    SSN in VARCHAR2, 
    LASTNAME in VARCHAR2, 
    FIRSTNAME in VARCHAR2, 
    MASTERRECORD IN VARCHAR2 DEFAULT NULL,
    C_Table out sp_cursor) 
```

**参数创建：**

```
 For Each SearchParameter In SearchParameters
        ValueParameter = New OracleParameter

        ValueParameter.Direction = ParameterDirection.Input
        ValueParameter.OracleDbType = OracleDbType.Varchar2
        ValueParameter.ParameterName = SearchParameter.ParameterFieldName

        If Not SearchParameter.TransformedFieldValue = Nothing Then
            ValueParameter.Value = SearchParameter.TransformedFieldValue
        Else
            ValueParameter.Value = String.Empty
        End If

        ExactMatchSearchParameters.Add(ValueParameter)
    Next

    Dim MasterRecordParameter As New OracleParameter()

    MasterRecordParameter.Direction = ParameterDirection.Input
    MasterRecordParameter.OracleDbType = OracleDbType.Varchar2
    MasterRecordParameter.ParameterName = "MASTERRECORD"
    MasterRecordParameter.Value = DBNull.Value

    ExactMatchSearchParameters.Add(MasterRecordParameter)

    Dim TableParameter As New OracleParameter

    TableParameter.ParameterName = "C_Table"
    TableParameter.OracleDbType = OracleDbType.RefCursor
    TableParameter.Direction = ParameterDirection.Output

    ExactMatchSearchParameters.Add(TableParameter) 
```

**执行：**

```
Using Command As OracleCommand = 
        New OracleCommand(
            QualifiedProcedureName, 
            Me.Database.Connection)

    Command.CommandType = CommandType.StoredProcedure
    'Command.AddToStatementCache = False '

    For Each Parameter In Parameters
        Command.Parameters.Add(Parameter)
    Next

    Command.Connection.Open()

    'Command.Connection.FlushCache() '

    Using Reader As OracleDataReader = Command.ExecuteReader() 
```

**成功与失败示例：**

```
*** SUCCESS ***
[SSN]: "6#######0"
[LASTNAME]: "W_____x"
[FIRSTNAME]: "D______e"
[MASTERRECORD]: ""
[C_Table]: ""

*** FAILURE ***
[SSN]: "2#######_1"
[LASTNAME]: "C____n"
[FIRSTNAME]: "L___e"
[MASTERRECORD]: ""
[C_Table]: ""

*** FAILURE ***
[SSN]: "5#######5"
[LASTNAME]: "C_______s"
[FIRSTNAME]: "R_____o"
[MASTERRECORD]: ""
[C_Table]: ""

*** SUCCESS ***
[SSN]: "6#######0"
[LASTNAME]: "P___a"
[FIRSTNAME]: "N______r"
[MASTERRECORD]: ""
[C_Table]: "" 
```

**附加测试：**

我尝试运行跟踪以查看 ODP.NET 在参数中实际发送到数据库的内容，但跟踪文件没有提供任何有意义的信息（IE：实际参数值）

```
TIME:2013/02/14-14:10:19:678 
TID:231c  
OpsSqlPrepare2(): 
SQL: Begin PACKAGE.DUP_EXACT(:v0, :v1, :v2, :v3, :v4); End; 
```

**示例参数值：**

```
?Command.Parameters(0)
{SSN}
    ArrayBindSize: Nothing
    ArrayBindStatus: Nothing
    CollectionType: None {0}
    DbType: String {16}
    Direction: Input {1}
    InvalidPrecision: 100
    InvalidScale: 129
    InvalidSize: -1
    IsNullable: False
    m_bOracleDbTypeExSet: False
    m_bReturnDateTimeOffset: False
    m_collRef: {Oracle.DataAccess.Client.OracleParameterCollection}
    m_commandText: ""
    m_direction: Input {1}
    m_disposed: False
    m_enumType: ORADBTYPE {4}
    m_modified: False
    m_oraDbType: Varchar2 {126}
    m_paramName: "SSN"
    m_paramPosOrName: ""
    m_saveValue: Nothing
    MaxScale: 127
    MinScale: -84
    Offset: 0
    OracleDbType: Varchar2 {126}
    OracleDbTypeEx: Varchar2 {126}
    ParameterEnumType: ORADBTYPE {4}
    ParameterName: "SSN"
    Precision: 0
    Scale: 0
    Size: 0
    SourceColumn: ""
    SourceColumnNullMapping: False
    SourceVersion: Current {512}
    Status: Success {0}
    UdtTypeName: ""
    Value: "4#######0" {String} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T19:31:48.213

**答案是 Oracle 9.2.0.6.0 中存在一个导致间歇性 VARCHAR2 绑定错误的错误。惊人的。**

[这个论坛帖子终于给了我答案：](https://forums.oracle.com/forums/thread.jspa?messageID=1456123)

> 这种行为是一致的还是间歇性的？如果间歇性，并且您的 db 为 9206，您可能会遇到以下 rdbms 错误：
> 
> Bug.4015165 (74) REGRN SCALAR VARCHAR2 在不同大小的绑定中随机失败并出现 ORA-06502
> 
> 并且应该通过修补您的数据库来解决。
> 
> 我不知道为什么，但 ODP 似乎比其他驱动程序更容易遇到这个错误。
> 
> 如果不是间歇性的，或者如果您使用的是当前补丁级别的数据库，那么完整的测试用例可能是最好的。
> 
> 干杯，格雷格

快速检查确认我们使用的版本受到影响：

```
select * from v$version;
----------------------------------------------------------------
Oracle9i Enterprise Edition Release 9.2.0.6.0 - Production       
PL/SQL Release 9.2.0.6.0 - Production                            
CORE    9.2.0.6.0   Production                                          
TNS for 32-bit Windows: Version 9.2.0.6.0 - Production           
NLSRTL Version 9.2.0.6.0 - Production 
```

幸运的是，我们的生产服务器是 10g，所以我们最终将开发服务器也更新到了 10g，而且 viola，没有更多问题了。

**答案轨迹：**

[Oracle RefCursor 的参数问题](https://stackoverflow.com/questions/1210956/parameter-issue-with-oracle-refcursor)

[Oracle ODP.NET 论坛](https://forums.oracle.com/forums/forum.jspa?forumID=146&start=0)

[ODP.NET 论坛主题“错误 ORA-06502 PL/SQL”](https://forums.oracle.com/forums/thread.jspa?messageID=1456123)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T14:47:49.087

这可能听起来很奇怪，但请确保添加了出现在查询中的 oracle 参数。我过去几次遇到过这个问题（通常是在迁移到 ODP.NET 时）

# css - HTML，禁用代码列表中的突出显示/复制提示

> ID：14883634
> 
> 赞同：1
> 
> 时间：2013-02-14T20:40:50.553
> 
> 标签：css

我想在网页上放一些代码清单。有时它们是要复制的命令列表。我想在这些代码清单中显示提示，但让它们以某种方式不可复制，这样当用户复制文本时，他就不会错误地复制提示。

请注意，我不想“保护”内容，我只是想帮助用户不要犯错。

我尝试应用[CSS 规则来禁用文本选择](https://stackoverflow.com/questions/826782/css-rule-to-disable-text-selection-highlighting)，但似乎即使您一次突出显示并复制多个命令，提示也会与文本一起复制——至少这是我在 Google Chrome 中看到的。[自己试试](http://jsfiddle.net/4TXJs/3/)，进入我的剪贴板的是：

```
def hello(text):
   ....:     print "Hello {}!".format(text)
   ....:     print "Bye, cruel {}!".format(text)
   ....: 

In [24]: def foo(bar):
   ....:     print 'Another helper function.'
   ....:     bar.boom()
   ....: 
```

那么，怎么做才对呢？

# xml - 使用 Parallel.ForEach

> ID：14883638
> 
> 赞同：0
> 
> 时间：2013-02-14T20:41:04.073
> 
> 标签：xml, vb.net, parallel-processing

我正在尝试优化我创建的备份程序。代码很草率，因为它是我的第一个如此规模的程序，但希望你能超越它。

该程序运行良好，但似乎花费的时间比必要的要长。所以我正在玩弄 Parallel.ForEach 来帮助优化压缩过程。

现在，我让程序按以下方式执行压缩任务

```
Dim Destin = JobNode.SelectNodes("Destination")

For Each item As System.Xml.XmlNode In Destin
    Dim time As DateTime = DateTime.Now
    Dim format As String = "MMMddyyyy"
    Dim zpath As String = item.InnerText
    'replaces [date] in destination with actual Date 
    If time.DayOfWeek = 1 Then
        time = time.AddDays(-1)
        item.InnerText = Replace(item.InnerText, "[date]", time.ToString(format) & "_WE")
        zpath = item.InnerText
        zip.ParallelDeflateThreshold = -1
        zip.Save(zpath)
    Else
        Dim time1 As DateTime = DateTime.Now.AddDays(-1)
        item.InnerText = Replace(item.InnerText, "[date]", time1.ToString(format))
        zpath = item.InnerText
        zip.ParallelDeflateThreshold = -1
        zip.Save(zpath)
    End If
Next 
```

我已将所有源位置和目标位置保存到 xml 文件中以供阅读。这对于每个循环都按我想要的方式工作。但是，我无法将此 For each 循环转换为 Parallel.ForEach 循环。

你能帮忙的话，我会很高兴。再说一次，在编程方面我仍然很年轻，所以对我来说是愚蠢的。

是的......我在互联网上寻求帮助，但它要么让我感到困惑，要么在我的上下文中不起作用，要么我无法让它与我的代码一起使用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T20:52:19.660

尝试这个：

```
 Dim Destin = JobNode.SelectNodes("Destination").OfType(Of XmlNode)

    Dim format As String = "MMMddyyyy"
    Parallel.ForEach(Destin, 
      Sub(item)
        Dim time As DateTime = DateTime.Now.AddDays(-1)
        Dim zpath As String = item.InnerText
        'replaces [date] in destination with actual Date 
        Dim timeString = If(time.DayOfWeek = 1, time.ToString(format) & "_WE", time.ToString(format))
        item.InnerText = Replace(item.InnerText, "[date]", timeString)
        zpath = item.InnerText
        zip.ParallelDeflateThreshold = -1
        zip.Save(zpath)
       End Sub) 
```

# ruby-on-rails - 为什么此模型不显示可访问的属性？

> ID：14883639
> 
> 赞同：0
> 
> 时间：2013-02-14T20:41:06.147
> 
> 标签：ruby-on-rails, rails-activerecord

我有两个模型，一个`Person`和一个`Brain`。 `Person` `has_one` `:brain`, 和`Brain` `belongs_to` `:person`. 我想`Brain`通过 /person/ 更新分配属性。

```
class Person < ActiveRecord::Base
  has_one :brain
  attr_accessible :name
  attr_accessible :brain
  accepts_nested_attributes_for :brain

end

class Brain < ActiveRecord::Base
  belongs_to :person
  attr_accessible :weight_kg

  attr_accessible :person
  accepts_nested_attributes_for :person
end 
```

在 Rails 控制台中，我可以分配给`Person.brain`：

```
 > p = Person.first
=> #<Person id: 1, name: "Dave", created_at: "2013-02-14 20:17:35", updated_at: "2013-02-14 20:17:35"> 

 > p.brain.weight_kg = 5.0
  Brain Load (0.2ms)  SELECT "brains".* FROM "brains" WHERE "brains"."person_id" = 1 LIMIT 1
 => 5.0 
 > p.save
   (0.6ms)  begin transaction
   (0.6ms)  UPDATE "brains" SET "weight_kg" = 5.0, "updated_at" = '2013-02-14 20:18:11.010544' WHERE "brains"."id" = 1
   (317.6ms)  commit transaction
=> true 
```

通过网络表单（以及通过控制台）我不能，因为陈旧的错误，“**无法批量分配受保护的属性：brain_attributes** ”。

我有`attr_accessible :weight_kg`，`Brain`而且`Person`我有`accepts_nested_attributes_for :brain`，所以我（错误地）期望这能起作用。

我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T20:45:37.507

将 attr_accessible 更改为：

```
attr_accessible :brain_attributes 
```

# python - 将 Python 记录器的输出重定向到 tkinter 小部件

> ID：14883648
> 
> 赞同：5
> 
> 时间：2013-02-14T20:41:35.763
> 
> 标签：python, tkinter

花了一些时间重定向标准输出并将输出记录到 tkinter 文本小部件，我决定需要一些帮助。我的代码如下：

```
#!/usr/bin/env python
from Tkinter import *
import logging
from threading import Thread

class IODirector(object):
    def __init__(self,text_area):
        self.text_area = text_area

class StdoutDirector(IODirector):
    def write(self,str):
        self.text_area.insert(END,str)
    def flush(self):
        pass

class App(Frame):

    def __init__(self, master):
        self.master = master
        Frame.__init__(self,master,relief=SUNKEN,bd=2)
        self.start()

    def start(self):
        self.master.title("Test")
        self.submit = Button(self.master, text='Run', command=self.do_run, fg="red")
        self.submit.grid(row=1, column=2)
        self.text_area = Text(self.master,height=2.5,width=30,bg='light cyan')
        self.text_area.grid(row=1,column=1)

    def do_run(self):
        t = Thread(target=print_stuff)
        sys.stdout = StdoutDirector(self.text_area)
        t.start()

def print_stuff():
    logger = logging.getLogger('print_stuff')
    logger.info('This will not show')
    print 'This will show'
    print_some_other_stuff()

def print_some_other_stuff():
    logger = logging.getLogger('print_some_other_stuff')
    logger.info('This will also not show')
    print 'This will also show'

def main():    
    logger = logging.getLogger('main')
    root = Tk()
    app = App(root)
    root.mainloop() 

if __name__=='__main__':
    main() 
```

我知道可以基于文本小部件定义一个新的日志记录处理程序，但我无法让它工作。函数“print_stuff”实际上只是许多不同函数的包装器，它们都有自己的记录器设置。我需要帮助定义一个“全局”的新日志处理程序，以便可以从每个具有自己的记录器的函数中实例化它。任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-08-12T18:58:00.943

只是为了确保我理解正确：

您希望将日志消息同时打印到 STDout 和 Tkinter 文本小部件，但日志不会在标准控制台中打印。

如果这确实是你的问题，这里是如何做到的。

首先让我们在 Tkinter 中制作一个非常简单的控制台，它实际上可以是任何文本小部件，但为了完整起见，我将其包括在内：

```
class LogDisplay(tk.LabelFrame):
"""A simple 'console' to place at the bottom of a Tkinter window """
    def __init__(self, root, **options):
        tk.LabelFrame.__init__(self, root, **options);

        "Console Text space"
        self.console = tk.Text(self, height=10)
        self.console.pack(fill=tk.BOTH) 
```

现在让我们重写日志处理程序以重定向到参数中的控制台并仍然自动打印到 STDout：

```
class LoggingToGUI(logging.Handler):
""" Used to redirect logging output to the widget passed in parameters """
    def __init__(self, console):
        logging.Handler.__init__(self)

        self.console = console #Any text widget, you can use the class above or not

    def emit(self, message): # Overwrites the default handler's emit method
        formattedMessage = self.format(message)  #You can change the format here

        # Disabling states so no user can write in it
        self.console.configure(state=tk.NORMAL)
        self.console.insert(tk.END, formattedMessage) #Inserting the logger message in the widget
        self.console.configure(state=tk.DISABLED)
        self.console.see(tk.END)
        print(message) #You can just print to STDout in your overriden emit no need for black magic 
```

希望能帮助到你。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-14T23:09:39.223

这是一个完全修改后的答案，可以满足您的要求。我试图指出您问题中的哪些代码行已更改以及在何处添加了新行。

默认情况下，内置`logger.StreamHandler`处理程序类将消息输出到`sys.stderr`，因此要使它们也重定向`sys.stdout`文本小部件，需要构建一个新的记录器，并设置一个自定义控制台处理程序来执行此操作。由于您希望将其应用于模块中的所有记录器，因此需要将此设置应用于所有其他命名记录器将从其继承其设置的无名“根”记录器。

```
from Tkinter import *
import logging
from threading import Thread

class IODirector(object):
    def __init__(self, text_area):
        self.text_area = text_area

class StdoutDirector(IODirector):
    def write(self, msg):
        self.text_area.insert(END, msg)
    def flush(self):
        pass

class App(Frame):
    def __init__(self, master):
        self.master = master
        Frame.__init__(self, master, relief=SUNKEN, bd=2)
        self.start()

    def start(self):
        self.master.title("Test")
        self.submit = Button(self.master, text='Run', command=self.do_run, fg="red")
        self.submit.grid(row=1, column=2)
        self.text_area = Text(self.master, height=2.5, width=30, bg='light cyan')
        self.text_area.grid(row=1, column=1)

    def do_run(self):
        t = Thread(target=print_stuff)
        sys.stdout = StdoutDirector(self.text_area)
        # configure the nameless "root" logger to also write           # added
        # to the redirected sys.stdout                                 # added
        logger = logging.getLogger()                                   # added
        console = logging.StreamHandler(stream=sys.stdout)             # added
        logger.addHandler(console)                                     # added
        t.start()

def print_stuff():
    logger = logging.getLogger('print_stuff') # will inherit "root" logger settings
    logger.info('This will now show')                                  # changed
    print 'This will show'
    print_some_other_stuff()

def print_some_other_stuff():
    logger = logging.getLogger('print_some_other_stuff') # will inherit "root" logger settings
    logger.info('This will also now show')                             # changed
    print 'This will also show'

def main():
    logging.basicConfig(level=logging.INFO) # enable logging           # added
    root = Tk()
    app = App(root)
    root.mainloop()

if __name__=='__main__':
    main() 
```

# javascript - 为什么不能在javascript中使用int？

> ID：14883651
> 
> 赞同：-1
> 
> 时间：2013-02-14T20:41:47.613
> 
> 标签：javascript, jquery

以下代码引发 javascript 语法错误：

> 未捕获的 SyntaxError：意外的标识符

```
var num1 = 1;
int num2 = 2;
int total1 = num1 + num2;
console.log('total1 is '+total1); 
```

为什么会抛出这个错误？我不能在 javascript 中使用整数吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T20:44:50.930

> JavaScript 是一种**动态类型语言**。这意味着您不必在声明变量时指定变量的数据类型，并且在脚本执行期间会根据需要自动转换数据类型。

-- [Mozilla 开发者网络](https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Values,_variables,_and_literals)

此外，JavaScript 中没有整数数据类型，只有数字。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T20:43:48.760

JavaScript`int`不像 PHP 那样。而是使用`parseInt()`

```
var num1 = 1;
var num2 = 2;
total1 = parseInt(num1,10) + parseInt(num2,10);
console.log('total1 is '+total1); 
```

另请参阅：[https ://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/parseInt](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/parseInt)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T20:43:20.033

Javascript 没有显式类型的变量。

变量类型在“运行时”确定。在 javascript 中，您可以通过以下任一方式定义变量：

1.  （坏）声明它例如`num2 = 2;`
2.  （好）用`var`关键字声明它，例如`var num2 = 2;`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-14T20:43:38.240

JavaScript 中使用[动态类型。](http://www.w3schools.com/js/js_datatypes.asp)因此，您将使用“var”声明所有变量。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-14T20:51:45.527

1) JavaScript 中用于数字的类型是“double”。这是一个 64 位浮点值。2) JavaScript 中没有称为 int 的类型。3）每个变量都是一个“变体”。它可以存储数字、字符串、布尔值和对象。

对于您的问题，如果您只是将诸如“1234”之类的整数文字分配给一个变量，它仍将包含正确的值，因此，正如您的示例所需要的那样，将变量相加仍然会给您正确的答案。

# android - 通过意图获取地图方向时未找到路线

> ID：14883654
> 
> 赞同：1
> 
> 时间：2013-02-14T20:41:53.470
> 
> 标签：android, google-maps, routes, driving-directions

我正在尝试查找两个位置之间的地图方向。源位置是设备位置。目标位置是我维护的数据库。这是我的代码。我可以到达我选择公交、火车、地铁的屏幕，但我得到的结果类似于找不到路线。我可以在 From 字段中看到“我的位置”以及到位置的纬度和经度这是我获取方向的代码。

```
protected void getDirections() {
    // TODO Auto-generated method stub
    double dlongtd =result.get(0).getLongitude() ,dlattd=result.get(0).getLatitude();
    Intent intent = new Intent(Intent.ACTION_VIEW, 
            Uri.parse("http://maps.google.com/maps?f=d&daddr="+dlongtd+","+dlattd));
        intent.setComponent(new ComponentName("com.google.android.apps.maps", 
            "com.google.android.maps.MapsActivity"));
    startActivity(intent);
} 
```

这是我得到的对话框，当我点击任何一个公交时，我没有找到任何路线吐司 ![在此处输入图像描述](../Images/cdef3462cd9b023f8f8a6191877dc6cc.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T20:44:34.390

我上面犯的一个错误是我通过经度而不是纬度，反之亦然。现在一切正常

更新代码：

```
protected void getDirections() {
    // TODO Auto-generated method stub
    double dlongtd =result.get(0).getLongitude() ,dlattd=result.get(0).getLatitude();
    Intent intent = new Intent(Intent.ACTION_VIEW, 
            Uri.parse("http://maps.google.com/maps?f=d&daddr="+dlattd+","+dlongtd));
        intent.setComponent(new ComponentName("com.google.android.apps.maps", 
            "com.google.android.maps.MapsActivity"));
    startActivity(intent);
} 
```

# javascript - 固定 div 中的 div 是否会捕获鼠标点击？

> ID：14883656
> 
> 赞同：0
> 
> 时间：2013-02-14T20:42:00.403
> 
> 标签：javascript, html, css, event-bubbling, stoppropagation

我正在使用这个模态窗口的一个稍微修改过的版本：http: [//blog.avtex.com/2012/01/26/cross-browser-css-only-modal-box/](http://blog.avtex.com/2012/01/26/cross-browser-css-only-modal-box/)

我所做的修改之一是添加`onclick="history.back(-1)"`到覆盖和垂直偏移 div，以便通过单击外部来隐藏模式。但是，将 onclick 事件添加到垂直偏移 div 会捕获发生在 dimBox div 上的点击。

你可以看看这个 jsFiddle 看看发生了什么：http: [//jsfiddle.net/dvrcthewrld/uaP3v/1/](http://jsfiddle.net/dvrcthewrld/uaP3v/1/)

*我怎样才能让dumbBox div捕捉其中发生的那些点击，而不是垂直偏移div捕捉它们？*

[请不要使用 jQuery。]

我真的很想知道为什么内部 div 将点击事件传递给父级以及如何阻止它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:54:29.443

**演示：http: [//jsfiddle.net/cZkn2/](http://jsfiddle.net/cZkn2/)**

html

```
<div class="vertical-offset" onclick="check(this)">
    <div class="dumbBox" id="div">
        Content goes here<br/>
        Content goes here<br/>
        Content goes here<br/>
        Content goes here
    </div>
</div> 
```

javascript

```
function check(e) {
    var target = (e && e.target) || (event && event.srcElement);
    var obj = document.getElementById('div');
    if(target!=obj){history.back(-1);}
} 
```

# c - 如何将二维字符串数组传递给 C 语言中的函数？

> ID：14883657
> 
> 赞同：0
> 
> 时间：2013-02-14T20:42:12.157
> 
> 标签：c, arrays

我不知道如何将`radjectives`（二维字符串数组）传递给`randomizeadj`函数。

```
#include<stdio.h>
#include<stdlib.h>
#include<time.h>
#include<ctype.h>

char randomizenouns(char[][]);
char randomizeadj(char[][]);

int main() // beginning of program.
{
  int a=0, b=0;
  char *answers[5]={'\0'};
  char *rnouns[3][10]={'\0'};
  char *radjectives[2][17]={'\0'};
  char *rcolors[11]={'\0'};

  radjectives[0][0]="intriguing";
  // ...
  radjectives[1][6]="loud";

  rnouns[0][0]="puppies";
  // ...
  rnouns[1][9]="people";

  rcolors[0]="black";
  // ...
  rcolors[10]="orange";

  { srand(time(NULL));

  printf("\n\tProgram Paragrahs\n");
  printf("\tFor this program you will answer several questions which will then be used to     conjure a random story the length of a paragraph.Please Keep your answers clean.Enjoy\n");

  printf("\nWhat is your name?");
  scanf("%s\n",answers[0]);
  printf("\nWhat is your favorite book?");
  scanf("%s",answers[1]);
  printf("\nWhat is your favorite color?");
  scanf("%s",answers[2]);
  printf("\nWhat city do you live in?");
  scanf("%s",answers[3]);
  printf("\nWhat car do you drive?");
  scanf("%s",answers[4]); 
```

* * *

**这就是我迷路的地方**——我不知道如何将`radjectives`数组传递给`randomizeadj`函数。

```
 printf("%s gets lost in their %s %s.\n",answers[0],randomizeadj(radjectives[a][b]),answers[1]);
  printf("%s loves to play with %s %s.\n",answers[0],rcolors[(rand()    %11)],randomizenouns(rnouns[a][b]);.
  printf("%s lives in a(n) %s %s.\n",answers[0],randomizeadj(radjectives[a][b]),answers[3]);
  printf("While living in %s %s drives a(n) %s %s.\n",answers[3],answers[0],rcolors[(rand() %11)],answers[4]);
  printf("%s is a(n) %s person who likes the color  %s.\n",answers[0],randomizeadj(radjectives[a][b]),answers[2]);
} // end of program

char randomizenouns(char nouns[x][y]);
{
     int x=(rand() %3);
     int y=(rand() %10);

     char randomnoun= nouns[x][y];

     return randomnoun;
}

char randomizeadj(char adjectives[x][y]);
{
     int x=(rand() %2);
     int y=(rand() %7);

     char randomadjective= adjectives[x][y];

     return randomadjective;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T20:52:34.483

简单地

```
randomizeadj(radjectives); 
```

例如

```
char *adj = randomizeadj(radjectives);
printf(adj); 
```

目前无法编译，将函数的声明和定义更改为：

```
char *randomizenouns(char *nouns[3][10]);
char *randomizeadj(char *adjectives[2][17]); 
```

或者：

```
char *randomizenouns(char *nouns[][10]);
char *randomizeadj(char *adjectives[][17]); 
```

我改变的事情：

*   将（二维字符数组）更改`char[][]`为二维数组或字符*指针*（另请注意，数组的第一个维度必须始终具有指定的长度）。

*   将你的函数更改为返回`char *`而不是`char`（否则你的函数只返回一个字符，而不是一个字符串（但你仍然只是`return adjectives[x][y]`）。

我改变的其他事情：

更改`answers`为不是`char`指针数组，而是`char`s 的 2D 数组，否则编译器不会为您尝试读入的值分配内存。

```
char answers[5][100]; 
```

还有一个`;`不应该在这里的地方：（对于这两个功能）

```
char randomizeadj(char adjectives[x][y]);
{
  ... 
```

[测试程序](http://ideone.com/p5fOqp)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T20:54:15.010

您可以简单地按照您声明的方式传递它：

将您的函数定义和声明更改为以下内容：

```
 char *randomizenouns(char *nouns[rows][cols]) 
 char *randomizeadj(char *adjectives[rows][cols]) 
```

**注意**：对于二维数组，您需要传递`cols`大小，因此按要求传递

**编辑**

并且在您的代码中，您已将分号（；）放在函数定义
`char randomizeadj(char adjectives[x][y]); { ... }`
`char randomizenouns(char nouns[x][y]); { .... }`
**中，从函数定义中删除分号**

* * *

您之前遇到了该`incompatible pointer type`错误，您可能**没有**使用**匹配的函数定义签名**更改**函数声明**签名。

# c# - 如何重构这些常用快捷键

> ID：14883658
> 
> 赞同：2
> 
> 时间：2013-02-14T20:42:19.030
> 
> 标签：c#, winforms, refactoring

在我的 .NET 应用程序（使用 WinForms）的初始开发过程中，我不得不进入并创建常用的编辑快捷方式，例如 CTRL-A、CTRL-C 和 CTRL-V，因为默认情况下不启用它们。现在我的应用程序已经发展到相当多的文本框，我正试图弄清楚如何重构以下代码。有人可以帮忙吗？

```
private void textBox1_results_KeyDown(object sender, KeyEventArgs e)
{
    if (e.Control && e.KeyCode == Keys.A)
    {
        textBox1_results.SelectAll();
        e.SuppressKeyPress = true;
    }

    if (e.Control && e.KeyCode == Keys.C)
    {
        textBox1_results.Copy();
        e.SuppressKeyPress = true;
    }

    if (e.Control && e.KeyCode == Keys.V)
    {
        textBox1_results.Text = Clipboard.GetText();
        e.SuppressKeyPress = true;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T20:57:30.020

如果您有一个所有表单都继承自的 BaseForm，请尝试将上述代码移至它并从所有文本框事件处理程序中调用它。

```
public partial class Form2 : Form1
{
    public Form2()
    {
        InitializeComponent();
    }

    private void Form2_Load(object sender, EventArgs e)
    {

    }

    private void textBox1_KeyDown(object sender, KeyEventArgs e)
    {
        base.TextKeyDown(sender, e);
    }
}

public partial class Form1 : Form
{
    public Form1()
    {
        InitializeComponent();
    }

    public void TextKeyDown(object sender, KeyEventArgs e)
    {
        if (e.Control && e.KeyCode == Keys.A)
        {
            ((TextBox) sender).SelectAll();
            e.SuppressKeyPress = true;
        }

        if (e.Control && e.KeyCode == Keys.C)
        {
            ((TextBox)sender).Copy();
            e.SuppressKeyPress = true;
        }

        if (e.Control && e.KeyCode == Keys.V)
        {
            ((TextBox)sender).Text = Clipboard.GetText();
            e.SuppressKeyPress = true;
        }
    }

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T21:07:56.793

好吧，有两种主要方法。

1.  通过从 System.Windows.Forms.TextBox 继承并添加您自己的 KeyDown 实现（仍调用 base.KeyDown()）并启用快捷方式来创建您自己的文本框控件
2.  创建一个您在每个表单的 Load 中调用的帮助程序类，即使它遍历表单上的所有控件并向您的代码添加一个处理程序。

选项 1 类似于；

```
public class ShortcutTextBox : TextBox
{
    protected override void OnKeyDown(KeyEventArgs e)
    {
        if (e.Control && e.KeyCode == Keys.A)
        {
            SelectAll();
            e.SuppressKeyPress = true;
        }
        else if (e.Control && e.KeyCode == Keys.C)
        {
            Copy();
            e.SuppressKeyPress = true;
        }
        else if (e.Control && e.KeyCode == Keys.V)
        {
            Text = Clipboard.GetText();
            e.SuppressKeyPress = true;
        }

        base.OnKeyDown(e);
    }
} 
```

尽管这附带了一个警告，即您需要用 ShortcutTextBox 替换每个 TextBox 实例。

选项二仍然涉及重构，但它是每个表单选项一次。创建一个辅助类，如下所示；

```
public abstract class ControlUtilities
{
    public static void AddTextBoxShortcuts(Control.ControlCollection controls)
    {
        foreach (Control c in controls)
        {
            if (c is TextBox)
            {
                TextBox txt = (TextBox)c;
                txt.KeyDown += textBox_KeyDown;
            }
            else if (c.Controls != null && c.Controls.Count > 0)
            {
                // recursively look for text boxes
                AddTextBoxShortcuts(c.Controls);
            }
        }
    }

    private static void textBox_KeyDown(object sender, KeyEventArgs e)
    {
        TextBox txt = (TextBox)sender;
        if (e.Control && e.KeyCode == Keys.A)
        {
            txt.SelectAll();
            e.SuppressKeyPress = true;
        }
        else if (e.Control && e.KeyCode == Keys.C)
        {
            txt.Copy();
            e.SuppressKeyPress = true;
        }
        else if (e.Control && e.KeyCode == Keys.V)
        {
            txt.Text = Clipboard.GetText();
            e.SuppressKeyPress = true;
        }
    }
} 
```

并在表单的 Load 事件中调用它，例如；

```
private void Form1_Load(object sender, EventArgs e)
{
    ControlUtilities.AddTextBoxShortcuts(this.Controls);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-14T20:52:44.550

大概是这样的：

```
private static void Shortcut_KeyDown(object sender, KeyEventArgs e)
{
    var textBox = (TextBox)sender;

    if (e.Control && e.KeyCode == Keys.A)
    {
        textBox.SelectAll();
        e.SuppressKeyPress = true;
    }

    if (e.Control && e.KeyCode == Keys.C)
    {
        textBox.Copy();
        e.SuppressKeyPress = true;
    }

    if (e.Control && e.KeyCode == Keys.V)
    {
        textBox.Text = Clipboard.GetText();
        e.SuppressKeyPress = true;
    }
} 
```

并应用它：

```
textBox1.KeyDown += Shortcut_KeyDown;
textBox2.KeyDown += Shortcut_KeyDown;
// etc... 
```

虽然我不确定你为什么需要写这个 - 据我所知，这种行为是 Winforms TextBox 的标准行为。

# .htaccess - .htaccess 重写规则未触发

> ID：14883661
> 
> 赞同：0
> 
> 时间：2013-02-14T20:42:29.017
> 
> 标签：.htaccess, rewrite, rule

我正在尝试提出一个重写规则，该规则将重写：

oldurl.com/v11/file.ext 到 newurl.com/v11/file.ext

在 oldurl 服务器上，我将以下内容放入文件夹 v11 的 .htaccess 中：

```
Options +FollowSymLinks
RewriteEngine On
RewriteRule ^v11/(.*)$ http://newurl.com/v11/$1 [R=301,L] 
```

但是重定向根本没有触发。我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:47:03.730

将 .htaccess 放入 v11 文件夹时，您的代码应为：

```
Options +FollowSymLinks
RewriteEngine On
RewriteRule ^(.*)$ http://newurl.com/v11/$1 [R=301,L] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T20:46:16.080

检查新服务器是否设置为允许在目录级别读取 .htaccess 文件。

如果 .htaccess 文件在另一台服务器上工作，则很可能是服务器配置问题或文件所有者/权限问题。

# bash - 如何将文字添加到 Unix 'cat' 命令

> ID：14883669
> 
> 赞同：7
> 
> 时间：2013-02-14T20:42:52.750
> 
> 标签：bash, cat

我正在尝试将[一些](http://linux.die.net/man/1/cat)文件放在一起，同时在文件之间添加一些文本。我是一个 Unix 新手，我没有语法的窍门。

这是我失败的尝试：

```
cat echo "# Final version (reflecting my edits)\n\n" final.md echo "\n\n# The changes I made\n\n" edit.md echo "\n\n#Your original version\n\n" original.md > combined.md 
```

我该如何解决？我应该使用管道还是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-14T20:49:54.653

流程替换似乎有效：

```
$ cat <(echo 'FOO') foo.txt <(echo 'BAR') bar.txt
FOO
foo
BAR
bar 
```

您还可以在此处文档中使用命令替换。

```
$ cat <<EOF
FOO
$(< foo.txt)
BAR
$(< bar.txt)
EOF 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-14T20:51:53.283

使用命令组将输出合并到一个流中：

```
{
   echo -e "# Final version (reflecting my edits)\n\n"
   cat final.md 
   echo -e "\n\n# The changes I made\n\n"
   cat edit.md 
   echo -e "\n\n#Your original version\n\n"
   cat original.md
} > combined.md 
```

您可以使用进程替换和命令替换（请参阅 Lev Levitsky 的回答）来使用一个命令（而不是`cat`此处使用的单独进程）来完成所有操作，但是对于这么少的文件，这应该足够有效。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-02-14T20:48:04.860

如果我理解你，它应该是这样的：

```
echo "# Final version (reflecting my edits)\n\n" >> combined.md
cat final.md >> combined.md
echo "\n\n# The changes I made\n\n" >> combined.md
cat edit.md >> combined.md 
```

等等。

# javascript - 在 javascript 中创建一个局部变量来跟踪日历上的月份。

> ID：14883674
> 
> 赞同：1
> 
> 时间：2013-02-14T20:43:09.173
> 
> 标签：javascript, html, function, logic, global-variables

在这里，我在下面有一个用于创建日历的完整 html 页面，将其复制过来以查看它的作用。我在下面有两个按钮，可以将月份递增一。我的问题是因为我可以`var month= date.getMonth()`在页面顶部进行实例化，全局变量`month`只允许我递增和递减 1，我怎样才能`month`将其设置为局部变量，以便我能够递增到不止 1。这里是代码：我确信复制粘贴会起作用：

下面我发布了我的按钮处理程序以增加月份/减少月份。

```
<script type="text/javascript"> 

printCalendar(year,month,divDestination);
function printCalendar(year,mth,divDestination){
var currentmonth = mth;
var myOutput=document.getElementById(divDestination)
myOutput.innerHTML=makeCalendar(year,mth)
}
function prevMonth(m){
    m--;
    var currentmonth = m;
    alert(m);
    if(m < 0)
    {
        m = 11;
        year--;
    }

    printCalendar(year,currentmonth,divDestination);
}
function nextMonth(m){
    m++;    
    var currentmonth = m;
    if(m > 11)
    {
        m=0;
        year++;
    }
    printCalendar(year,currentmonth,divDestination);
}
function test(div){
var myOutput=document.getElementById("divCalendar")
myOutput.innerHTML += eventmonth;
}
</script>

<div align="center" id="divCalendar"></div>
<div align="center" id="myButtons">
<input type="button" onclick="test('divCalendar')" value="Say hi" />
<input type="button" onclick="prevMonth(month,'divCalendar')" value="Previous"/>
<input type="button" onclick="nextMonth(month,'divCalendar')" value="Next" />
<input type="button" onclick="printCalendar(year,month,'divCalendar')" value="Reload Calendar" /> 
```

下面是我的 makeCalendar 函数

```
var myDate = new Date();
    var month = myDate.getMonth();
    var year = myDate.getFullYear();
    var divDestination="divCalendar";

    function leapYear(yr) { 
        if (yr < 1000) yr+=1900
        return((yr%4 == 0) && ((yr%100 == 0) || (yr%400 ==0)))
    }

    function startCol(width, height, color){
        return('<TD WIDTH=' + width + ' HEIGHT=' + height + '>' + '<FONT COLOR="' + color + '">');
    }

    function getHoliday(monthSelected,theday)
    {
        monthSelected = monthSelected + 1
        var holiday = ""
        var HolidayName = new Array (1, 1, "New Year's Day",7, 1, "Canada Day",12, 25, "Christmas Day",12, 26, "Boxing Day", 2,14,"Valentine's Day")
        for(var index = 0; HolidayName.length >= index; index++)
        {   
            if(HolidayName[index] == monthSelected && HolidayName[index+1] == theday)
            {
                holiday = HolidayName[index+2]
            }
        }
        return holiday
    }

    function makeCalendar(yr, mth)
    {
        var monthSelected = mth
        var months    = new Array("Jan", "Feb", "Mar", "Apr", "May", "June", "July", "Aug", "Sept", "Oct", "Nov", "Dec")
        var days      = new Array(31, leapYear(yr)?29:28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31)
        var weekDays  = new Array("Sun", "Mon", "Tues", "Wed", "Thurs", "Fri", "Sat")

        var mthSz         = days[mth]
        var mthName       = months[mth]
        var firstDyofMnth = new Date(yr, mth, 1)
        var firstDay      = firstDyofMnth.getDay() + 1
        var numRows       = Math.ceil((mthSz + firstDay-1)/7)
        var mthNameHeight = 50

        var borderWidth   = 2
        var cellSpacing   = 4 
        var cellHeight    = 80 

        var hdrColor      = "midnightblue" 
        var hdrSz         = "+3" 
        var colWidth      = 100 

        var dayCellHeight = 25 
        var dayColor      = "black" 
        var dayCtr        = 1

        // Build the HTML Table 
        var txt = '<CENTER>'
        txt += '<TABLE BORDER=' + borderWidth + ' CELLSPACING=' + cellSpacing + '>' 

        //Show Month Name and Year
        txt += '<TH COLSPAN=7 HEIGHT=' + mthNameHeight + '>' 
        txt += '<FONT COLOR="' + hdrColor + '" SIZE=' + hdrSz + '>' 
        txt += mthName + ' ' + year + '</FONT>' + '</TH>'

        // Show Days of the Week 
        txt += '<TR ALIGN="center" VALIGN="center">'
        for (var dy = 0; dy < 7; ++dy) {
            txt += startCol(colWidth, dayCellHeight, dayColor) + weekDays[dy] + '</FONT></TD>' 
        }
        txt += '</TR>'

        // Show Dates in Calendar
        for (var row=1; row <= numRows; ++row) 
        {
            txt += '<TR ALIGN="right" VALIGN="top">'
            for (var col = 1; col <= 7; ++col) 
            {
                if (((col < firstDay) && (row==1)) || (dayCtr>mthSz))
                    {txt += '<TD BGCOLOR="Gainsboro"><BR></TD>'}
                else
                    {
                        var event = getHoliday(monthSelected, dayCtr)
                        txt += '<TD HEIGHT=' + cellHeight + '><FONT COLOR="' + dayColor + '"> <B>'
                        txt += dayCtr
                        txt += '</B></FONT><BR>' + event + '</TD>'
                        dayCtr++;
                    }       
            }
            txt += '</TR>'
        }
        // close all basic table tags and output txt string
        txt += '</TABLE></CENTER>'  
        return txt
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T21:07:09.157

让我们尝试将其进一步削减到金钱位。这基本上就是你在做什么。

```
var month = new Date().getMonth()

var nextMonth = function(m) {
  m++;
  setMonthSomewhere(m);
};

nextMonth(month); 
```

所以发生的事情是你将你的全局变量传递给函数，它在任何地方都可以访问`nextMonth()`。函数参数基本上声明了一个局部变量，该变量设置为传入的值。您现在有一个全局`month`变量设置为`1`，并且该函数的一个完全不同`m`的局部`nextMonth()`变量也设置为`1`。然后将局部变量`m`增加到`2`，这对全局变量没有影响。

相反，干脆不要传入。直接操作全局。

```
var month = new Date().getMonth()

var nextMonth = function() {
  month++;
  setMonthSomewhere(month);
};

nextMonth(); 
```

现在直接`nextMonth()`增加全局`month`变量，改变它的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T21:22:46.387

`month`您在处理程序中使用全局变量，`<input type="button" onclick="nextMonth(month,'divCalendar')" value="Next" />`但从未更新该全局变量。

为什么不尝试从 nextMonth 函数中删除第一个参数，而不是`m`使用月份。

```
function nextMonth(){
  month++;    
  if(month > 11)
  {
    month=0;
    year++;
  }
  printCalendar(year,month,divDestination);
} 
```

（请注意您对“currentMonth”变量的使用也可能是错误的，所以我删除了它）

但我认为您的设计有一点缺陷 - 因为您使用全局变量并将它们放在全局命名空间中，如果您需要渲染 2 个日历或者如果其他一些 javascript 想要使用该变量，您将很难名称“月”或“年”。

**编辑（添加更好的解决方案）**

我建议您不要将数字传递给您的函数，而是传递整个日期对象 - 因为这将使代码更简单。

```
function printCalendar(date, divDestination) {
    var myOutput=document.getElementById(divDestination)
    myOutput.innerHTML=makeCalendar(date.getFullYear(), date.getMonth());
}

function nextMonth(date, divDestination) {
    date.setMonth(date.getMonth()+1);
    printCalendar(date, divDestination);
}

function prevMonth(date, divDestination) {
    date.setMonth(date.getMonth()-1);
    printCalendar(date, divDestination);
} 
```

现在因为您传递了一个 Date 对象，nextMonth 和 prevMonth 函数实际上修改了该对象，以便下次调用 Date 时将更新为新的月份。

这是一个使用日期对象显示解决方案的小提琴

[**小提琴**](http://jsfiddle.net/Xmt67/)

# php - 包含其他 3rd 方库时如何进行错误处理

> ID：14883678
> 
> 赞同：0
> 
> 时间：2013-02-14T20:43:22.923
> 
> 标签：php, codeigniter, error-handling

我在我的 php 应用程序中添加了第 3 方开源库。(phpseclib) 我已经用 try / catch 块包装了我对他们方法的所有调用，并且我正在处理所有错误，以便我优雅地处理错误。

但是，因为第 3 方库没有进行错误处理，所以当它死掉时，我会从中得到一个 php 错误 + 另一个我抛出的 codeigniter 消息，假设我尝试连接到设备并且它失败。

除了更改库以包含一些错误处理之外，我只想确保我无法阻止这些“未处理”消息出现在最终用户面前......

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T20:49:01.087

您可以编写自己的错误处理程序，[`set_error_handler()`](http://php.net/manual/en/function.set-error-handler.php)并根据错误级别忽略和/或处理错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T20:46:29.440

大概：

```
// Turn off error reporting
error_reporting(0); 
```

# azure - Azure 计费方案问题揭秘

> ID：14883679
> 
> 赞同：2
> 
> 时间：2013-02-14T20:43:31.217
> 
> 标签：azure, azure-sql-database

关于 Windows azure 的计费，我有 2 个特定的场景我无法忘记。

*场景 1*：如果我有 1 个实例（网络角色、工作角色或保留的网站）闲置了 5 个小时（闲置是指没有请求或处理或任何东西），将为此付费? 还是只在我有活动时才收费？

*场景 2*：我是按我的数据库的实际大小还是我创建它时声明的大小计费的？

这很难跟进，我要提前感谢大家。微软网站对此非常不清楚，也不直截了当。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-14T21:02:20.973

1）每个实例都像租车一样。该容量是为您保留的，如果它停在车道上（停止）、在游行中驾驶或以 60 英里/小时的速度在高速公路上行驶，您将被收费

2）两者兼而有之。网络版和商业版具有您将被计费的最小尺寸。但是，如果您声明一个 150gb 的商业 Db，但只使用 8 个，那么您将只按 10gb（最低）计费。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T21:09:00.793

对于方案 1，您将根据是否分配机器进行计费。因此，如果您设置机器一次并让它运行，只要它在运行，您就会被计费。如果您只有一台需要 24/7 全天候可用的服务器（即使它可能只在白天很短的时间内工作），您需要按该机器的账单费率计算每月大约 720 小时尺寸。

对于方案 2，您将根据特定层级的最低使用量来计费。有关更多信息，请参阅本文档：http: [//www.windowsazure.com/en-us/pricing/details/#data-management/](http://www.windowsazure.com/en-us/pricing/details/#data-management/)

# php - gearman 给我 GEARMAN_COULD_NOT_CONNECT，它肯定在运行

> ID：14883681
> 
> 赞同：8
> 
> 时间：2013-02-14T20:43:36.233
> 
> 标签：php, debian, gearman

我的开发服务器是 Debian Squeeze，我正在运行 Gearman 1.1.5，我从源代码编译它以及 php pecl 扩展 v1.1.1

如果我运行 reverse_client.php 脚本，我会收到 GEARMAN_COULD_NOT_CONNECT 错误。

`PHP Warning: GearmanClient::do(): send_packet(GEARMAN_COULD_NOT_CONNECT) Failed to send server-options packet -> libgearman/connection.cc:430 in /home/bealers/build/gearman-1.1.1/examples/reverse_client.php on line 26`

这里有一些类似的帖子，它们都指向通用汽车没有运行。

它*肯定*在运行。

我从这些参数开始：

`PARAMS="--queue-type=MySQL --mysql-db=test_db --mysql-user=gearman --mysql-password=gearman"`

如果我在 test_db 中删除 gearman_queue 表，然后重新启动守护程序，则重新创建表，因此它的 mysql 连接很好，并且显然正在启动。

我也可以在 localhost 上远程登录到 4730，所以没有防火墙问题。

最初GM启动有问题，因为它是在mysql之前启动的，所以我编辑了init脚本

```
### BEGIN INIT INFO
# Provides:          gearman-job-server
# Required-Start:    $network $remote_fs $syslog mysql 
```

并将其`update-rd.c gearman-job-server defaults`设置为之后启动，现在启动时可以正常启动。

我唯一能想到的另一件事是，最初我是通过 apt 安装的，但版本太旧了，所以我将其删除并从源代码编译。/usr/sbin/gearmand 不再存在，唯一的版本是 /usr/local/sbin/gearmand

`ps ax | grep gearman`仅显示一个正在运行的进程。

Netstat 显示只有一个进程正在运行`

`tcp 0 0 *:4730 *:* LISTEN 2325/gearmand`

PECL 库似乎很好：

`php -i | grep gearman`

```
/etc/php5/cli/conf.d/gearman.ini,
gearman
gearman support => enabled
libgearman version => 1.1.5 
```

我没主意了

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-15T18:10:49.070

我遇到了同样的问题，最近经过几天的挫折后解决了（很难解决，因为要担心三个过程:-)

看来（至少在我的情况下） GearmanClient::addServer() 和 GearmanWorker::addServer() 的 PHP 文档不正确。具体来说，文档似乎暗示主机名和端口号是可选的，如果您不指定它们，它将使用 localhost 和端口 4730 作为默认值。这**永远**行不通 - 今天我突然想到尝试为客户端和工作进程明确指定它们，一切都开始工作了。

尝试指定主机名和端口的所有值，看看这是否适合您。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-04-18T11:43:37.947

如果您使用过类似的东西

> $client->addServers('127.0.0.1', 4730);

或者

> $client->addServers();

使用这样的东西

> ***$client->addServers('127.0.0.1:4730');***

PS - 我使用了 localhost IP，这可以替换为实际的主机 IP。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-01-30T14:00:34.000

在我的情况下，它有点不同。当我将`addServer`代码放入循环中时，我遇到了同样的错误。

```
$client = new GearmanClient();
for ($i=0; $i<100000; $i++) {
  $client->addServer("127.0.0.1", 4730);
  $data = json_encode(array('job_id' => $i, 'task_name' => 'send-email'));
  $client->addTaskBackground('sendEmail', $data);
}
$client->runTasks(); 
```

这为我解决了这个问题：

```
$client = new GearmanClient();
$client->addServer("127.0.0.1", 4730);
for ($i=0; $i<100000; $i++) {
  $data = json_encode(array('job_id' => $i, 'task_name' => 'send-email'));
  $client->addTaskBackground('sendEmail', $data);
}
$client->runTasks(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-05-19T08:05:59.980

可能这可以帮助某人。如果你想使用单个服务器，你可以使用

```
$client->addServer($host, $port)
e.g. $client->addServer('127.0.0.1', 4730) 
```

[http://php.net/manual/en/gearmanclient.addserver.php](http://php.net/manual/en/gearmanclient.addserver.php)

如果你想使用多个服务器，那么你可以使用

```
$client->addServers($host1:$port1, $host2:$port2, $host3:$port3)
e.g. $client->addServers('127.0.0.1:4730', '127.0.0.2:8080') 
```

[http://php.net/manual/en/gearmanclient.addservers.php](http://php.net/manual/en/gearmanclient.addservers.php)

# symfony - 如何在模型设置器中使用 Symfony 2 中的编码器工厂？

> ID：14883688
> 
> 赞同：5
> 
> 时间：2013-02-14T20:43:51.413
> 
> 标签：symfony, models, code-organization

这个关于 Symfony 2.1 的问题

如何对用户密码进行编码：

```
$factory = $this->get('security.encoder_factory');
$user = new Acme\UserBundle\Entity\User();

$encoder = $factory->getEncoder($user);
$password = $encoder->encodePassword('ryanpass', $user->getSalt());
$user->setPassword($password); 
```

和基本配置：

```
# app/config/security.yml
security:
    # ...

    encoders:
        Acme\UserBundle\Entity\User: sha512 
```

在 setter 模型内部：

```
class User implements UserInterface, \Serializable
{
    public function setPassword($password)
    {
       $this->password = $password;
    }
} 
```

我认为加密密码的过程必须按模型处理。如何在模型中使用标准编码器工厂？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-06-23T05:29:33.790

虽然我同意@Vadim 的观点，即您不应该将业务逻辑泄漏到您的模型中，但我会小心地将明文密码的散列推迟到`prePersist`事件发生，例如，除非`persist`您`flush`在`setPassword`. 同时调用将`getPassword`返回纯文本字符串，除非您将其存储在单独的字段中，这可能会产生严重后果。理想情况下，明文密码应在应用程序的生命周期内尽可能短地存在。

我建议使用服务层，其中“用户管理器”为常见任务提供接口，这样您即使暂时不需要污染密码属性：

```
class UserManager
{
    // ...
    public function __construct(EncoderFactoryInterface $encoderFactory)
    {
        // $encoderFactory is injected by the DIC as requested by your service configuration
        // ...
    }

    public function setUserPassword(UserInterface $user, $plaintextPassword)
    {
        $hash = $this->encoderFactory->getEncoder($user)->encodePassword($plaintextPassword, null);
        $user->setPassword($hash);
    }
    // ...
} 
```

在您的注册表单提交控制器中，例如：

```
public function userRegistrationAction()
{
    // ... 
    if ($form->isValid()) {
        $user = new User();
        // ...
        $this->get('my.bundle.user_manager')->setUserPassword($user, $form->get('password')->getData());
        // ...
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-14T21:44:13.917

实体包含数据，而不是处理它。如果您想更改实体的数据，您可以创建事件侦听器并在持久化之前执行一些操作。从官方文档中查看[如何注册事件侦听器和订阅者。](http://symfony.com/doc/2.0/cookbook/doctrine/event_listeners_subscribers.html)

您还可以查看[FosUserBundle](https://github.com/FriendsOfSymfony/FOSUserBundle)及其用户管理。

[FosUserBundle 用户管理器](https://github.com/FriendsOfSymfony/FOSUserBundle/blob/master/Doctrine/UserManager.php)

因此，主要思想是将纯密码从表单传递给用户实体，并在使用事件侦听器持久化之前对其进行编码。

# join - DQL 选择加入

> ID：14883689
> 
> 赞同：0
> 
> 时间：2013-02-14T20:43:56.660
> 
> 标签：join, doctrine, dql

我正在尝试在这些实体上进行 DQL 查询（来自 symfony 2.2 的原则）但没有成功：

有几个课程内容的课程，每个课程内容都链接到一个用户

我想检索用户的所有课程（应该是非常基本的......）。

```
SELECT l, lc FROM MyBundle:LessonContent lc 
JOIN lc.lesson l JOIN lc.modifiedBy u 
WHERE lc.creation=1 AND u.id = :userId 
```

但这会返回 LessonContent 实体。如果我从课程中选择，我将无法加入课程（这可能是我应该做的）。

谁能帮我？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T13:04:01.457

您从中查询的主表是什么学说作为主要对象返回给您，因此以下应该有效（假设 l.content 指向 LessonContent 关联）：

```
SELECT l, lc FROM MyBundle:Lesson l
JOIN l.content lc
JOIN lc.modifiedBy u
WHERE lc.creation=1 AND u.id = :userId 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T20:16:25.920

事实证明，我需要一个 l.content* *s* * 属性才能从课程中进行选择，然后加入其余的课程。

实体：

```
 /**
 * @var ArrayCollection $contentHistory
 * @ORM\OneToMany(targetEntity="AAA\CoreBundle\Entity\LessonContent", mappedBy="lesson", cascade={"persist", "remove"})
 * @ORM\OrderBy({"lastModified" = "DESC"})
 */
private $contentHistory; 
```

询问：

```
SELECT l FROM AAACoreBundle:Lesson l JOIN l.contentHistory lc JOIN lc.modifiedBy u WHERE lc.creation=1 AND u.id = :userId GROUP BY l 
```

有了它，它就像一个魅力！

# linux - 如何选择文件中多次出现的相同行序列？

> ID：14883691
> 
> 赞同：0
> 
> 时间：2013-02-14T20:43:53.083
> 
> 标签：linux, unix, sed, aix

假设我有一个文件如下：

```
101 abcd <time>
106 efgh <time>
107 ijkl <time>
110 pqrs <time>
105 trsf <time>
101 yrte <time>
109 tyti <time>
110 tyui <time> 
```

我想对从 101 开始到 110 结束的行块做一些操作。当文件中只有一次出现 101 和 110 时，我能够解决它。

```
sed -ne 's/101/,/110/p' file1 > file2 
```

使用此命令，我可以取出我想要处理的大量行。请帮助我找到能够将第一个块保存在第一个文件中，第二个匹配行保存在第二个文件中的逻辑，依此类推。

我正在 AIX 中编写脚本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T21:01:52.017

你可以这样做：

```
awk '/^101/ && !i { c++; i=1 } i { print > "file" c } /^110/ { i=0 }' input 
```

`c`每次一行匹配时，这只是增加一个计数器（ ） `^101`，但前提是它还没有在正在打印的块中。如果合适，第二个子句打印到名称中带有计数器的输出文件，第三个子句关闭`i`用于确定当前行是否在要打印的块中的标志 ( )。

另一种选择是简单地做：

```
awk '/^101/,/^110/{ print > "output" c } /^110/{c++}' c=1 input 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T21:07:28.050

您可以尝试使用 awk，这里有一个简短的单行代码来完成这项工作：

```
awk '/101/{++i;f=1} f{print $0>"file"i} /110/{f=0}' file 
```

用你的例子测试：

```
kent$  echo "101 abcd <time>
106 efgh <time>
107 ijkl <time>
110 pqrs <time>
105 trsf <time>
101 yrte <time>
109 tyti <time>
110 tyui <time>"|awk '/101/{++i;f=1} f{print $0>"file"i} /110/{f=0}'

kent$  head *
==> file1 <==
101 abcd <time>
106 efgh <time>
107 ijkl <time>
110 pqrs <time>

==> file2 <==
101 yrte <time>
109 tyti <time>
110 tyui <time> 
```

# android - 清空后堆活动

> ID：14883693
> 
> 赞同：0
> 
> 时间：2013-02-14T20:44:00.777
> 
> 标签：android

我有一些活动 A、B、C、D。不，它的设置方式是这样的。

1.  当用户启动应用程序时，活动 A 开始。
2.  基于首选项，如果设置为 true，则立即启动活动 D
3.  从那里 D 开始 C 和 C 开始 B 然后开始 A

...此时我希望从后堆栈中删除 D、C、B，以便用户无法通过从 A 按下返回来返回它们（但后退按钮应该像在 D、B、C 中一样工作）。

所以总结起来我需要这样的东西 `D <--> C <--> B --> A`

我尝试使用意图标志`Intent.FLAG_ACTIVITY_CLEAR_TOP`&`Intent.FLAG_ACTIVITY_NEW_TASK` 但它们不起作用。我如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T21:03:38.770

然后开始活动 A 并`FLAG_ACTIVITY_TASK_ON_HOME`设置标志。

好的。

启动 A 后在 B 上调用完成怎么样？

# c# - 如何从加载的dll中获取对象

> ID：14883694
> 
> 赞同：1
> 
> 时间：2013-02-14T20:43:57.997
> 
> 标签：c#

我在 SO 上看到了相当多的这个问题，我已经遵循了这个建议，但我似乎做错了什么。dll 似乎可以正常加载，但 CreateInstance 返回的对象为空。

我有这个dll：

```
namespace Backfill
{
public class Module : Kernel.Module
{
    public override void ModuleStart()
    {
        //Stuff
    }
}
} 
```

在另一个具有不同命名空间的 DLL 中

```
namespace Kernel
{

public abstract class Module
{
    public abstract void ModuleStart();
}

public static void KernelStart()
    {
        string load_dll = @"Path to DLL";

        Assembly test_dll = Assembly.LoadFile(load_dll + ".dll");

        Module test_mod = (Module)test_dll.CreateInstance("Kernel.Module");

        test_mod.ModuleStart();
    }
} 
```

`(Module)test_dll.CreateInstance("Kernel.Module");`但是，返回 null。知道为什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T21:03:14.293

```
(Module)test_dll.CreateInstance("Kernel.Module") 
```

这行不通。正如您所指定的，`Module`您尝试实例化的类（我假设是第一个 DLL 中的类）不在`Kernel`命名空间中，而是在`Backfill`命名空间中。因此，您应该有以下几点：

```
(Module)test_dll.CreateInstance("Backfill.Module") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T20:53:31.270

Kernel.Module 是一个抽象类。您不能直接创建它的实例。您需要创建派生类的实例。

编辑：由于提供更多信息：

@Antonijn 有同样的答案。您需要直接指定您想要的类型。BackFill.Module 似乎是正确的。

编辑前：

如果您在多个程序集中具有相同的名称，那么您需要为您想要的类型使用完全限定的（包括程序集名称）。例如：[https](https://stackoverflow.com/a/2300428/30225) ://stackoverflow.com/a/2300428/30225作为可能的答案。

# c# - 过滤的 ObservableCollection 不会更新 WPF UI 上的 ListView

> ID：14883696
> 
> 赞同：1
> 
> 时间：2013-02-14T20:44:10.213
> 
> 标签：c#, wpf, listview, mvvm, observablecollection

我正在尝试在我的 WPF UI 上过滤绑定到 ListView 的 ObservableCollection 数据。但是，当集合刷新时，ListView 变为空白并且不显示任何内容。我也在尝试自学 MVVM 模式。问题可能是我如何不刷新控件，但我怎样才能让它以 MVVM 模式刷新？我习惯于做 Winforms 和代码隐藏，当用户点击 Search 按钮时会发生过滤逻辑 - 这会调用 ApplicationModel.Search 方法。

型号代码：

```
public class AppObject
{
    public string Name { get; set; }
    public string Description { get; set; }
    public string Owner { get; set; }
    public string Email { get; set; }

    public AppObject(string name, string desc, string owner, string email)
    {
        this.Name = name;
        this.Description = desc;
        this.Owner = owner;
        this.Email = email;
    }
}

public class ApplicationsModel : ObservableCollection<AppObject>
{
    private static object threadLocker;
    private static ApplicationsModel current;

    static ApplicationsModel()
    {
        threadLocker = new object();
    }

    public static ApplicationsModel Current
    {
        get
        {
            lock (threadLocker)
            {
                if (current == null)
                {
                    current = new ApplicationsModel();
                }
            }
            return current;
        }
    }

    private ApplicationsModel()
    {
        this.Refresh();
    }

    private ApplicationsModel(IEnumerable<AppObject> collection)
        : base(collection)
    {
    }

    private void Refresh()
    {
                    try
                    {
                            // Query database to get the initial data - this code works fine
                    }
        catch (Exception e)
        {
            string error = String.Format("Could not refresh repository list: {0}", e.Message);
            MessageBox.Show(error, "Error Refreshing", MessageBoxButton.OK, MessageBoxImage.Error);
        }
    }

    public void Search(string key)
    {
        IEnumerable<AppObject> newList = current.Items.Where<AppObject>(t => t.Name.Equals(key));
        foreach (AppObject app in newList)
        {
            Console.WriteLine(app.Name);
            Console.WriteLine(app.Description);
        }
        current.Clear();
        current = null;
        current = new ApplicationsModel(newList);
    }

    public void ClearSearch()
    {
        Console.WriteLine("ClearSearch method called");
    }
} 
```

视图模型代码：

```
public class ApplicationViewModel
{
    public ObservableCollection<AppObject> AppCollection { get; set; }
    static string searchString;
    static string emailString;
    public AppObject SelectedApp { get; set; }
    public string AppToSearch
    {
        get
        {
            return searchString;
        }
        set
        {
            searchString = value;
        }
    }
    public string AppToRequest
    {
        get
        {
            return SelectedApp.Email;
        }
        set
        {
            SelectedApp.Email = value;
        }
    }
    private SearchButtonCommand searchButtonCmd;
    private ClearButtonCommand clearButtonCmd;
    private EmailButtonCommand emailButtonCmd;

    public ApplicationViewModel()
    {
        this.AppCollection = ApplicationsModel.Current;
    }

    public ICommand SearchButtonPressed
    {
        get
        {
            if (this.searchButtonCmd == null)
            {
                this.searchButtonCmd = new SearchButtonCommand();
            }
            return this.searchButtonCmd;
        }
    }

    public ICommand ClearButtonPressed
    {
        get
        {
            if (this.clearButtonCmd == null)
            {
                this.clearButtonCmd = new ClearButtonCommand();
            }
            return this.clearButtonCmd;
        }
    }

    public ICommand EmailButtonPressed
    {
        get
        {
            if (this.emailButtonCmd == null)
            {
                this.emailButtonCmd = new EmailButtonCommand();
            }
            return this.emailButtonCmd;
        }
    }

    private class SearchButtonCommand : ICommand
    {
        public event EventHandler CanExecuteChanged;

        public void Execute(object parameter)
        {
            string searchkey = ApplicationViewModel.searchString;
            ApplicationsModel.Current.Search(searchkey);
        }

        public bool CanExecute(object parameter)
        {
            return true;
        }
    }

    private class ClearButtonCommand : ICommand
    {
        public event EventHandler CanExecuteChanged;

        public void Execute(object parameter)
        {
            ApplicationsModel.Current.ClearSearch();
        }

        public bool CanExecute(object parameter)
        {
            return true;
        }
    }

    private class EmailButtonCommand : ICommand
    {
        public event EventHandler CanExecuteChanged;

        public void Execute(object parameter)
        {
            string targetEmail = ApplicationViewModel.emailString;
        }

        public bool CanExecute(object parameter)
        {
            return true;
        }
    }
} 
```

用户界面 XAML：

```
<Window.DataContext>
    <vm:ApplicationViewModel />
</Window.DataContext>

<Grid>
    <Grid.RowDefinitions>
        <RowDefinition Height="Auto" />
        <RowDefinition Height="Auto" />
        <RowDefinition Height="*" />
        <RowDefinition Height="Auto" />
    </Grid.RowDefinitions>
    <Grid.ColumnDefinitions>
        <ColumnDefinition Width="*" />
    </Grid.ColumnDefinitions>
    <Image Grid.Row="0" Height="84" HorizontalAlignment="Left" Margin="0,5,5,5" Name="imgNexusLogo" Stretch="Fill" VerticalAlignment="Top" Width="600" Source="C:\source\Nexus\NexusShop\Images\nexus1bannerlong.png" />
    <Grid Grid.Row="1" HorizontalAlignment="Center" Margin="0,5,5,5" VerticalAlignment="Center">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="Auto" />
        </Grid.ColumnDefinitions>
        <Label Grid.Row="0" Grid.Column="0" Content="Search for Application">
            <Label.Foreground>
                <SolidColorBrush Color="LightCyan" />
            </Label.Foreground>
        </Label>
        <TextBox Grid.Row="0" Grid.Column="1" Margin="3" Width="500" Text="{Binding AppToSearch}" />
        <Button Grid.Row="0" Grid.Column="2" HorizontalAlignment="Right" Width="100" Height="20" Margin="3" Background="LightCyan" Content="Search" vm:ButtonBehaviour.SearchCommand="{Binding SearchButtonPressed}" />
        <Button Grid.Row="0" Grid.Column="3" HorizontalAlignment="Right" Width="100" Height="20" Margin="3" Background="LightCyan" Content="Clear Search" vm:ButtonBehaviour.ClearCommand="{Binding ClearButtonPressed}"/>
    </Grid>
    <ListView Grid.Row="2" BorderBrush="Black" HorizontalAlignment="Stretch" ItemsSource="{Binding Path=AppCollection}" SelectedItem="{Binding SelectedNexusApp}">
        <ListView.View>
            <GridView>
                <GridViewColumn Header="Application Name" Width="100" DisplayMemberBinding="{Binding Name}"/>
                <GridViewColumn Header="Application Description" Width="800" DisplayMemberBinding="{Binding Description}"/>
                <GridViewColumn Header="Application Owner" Width="100" DisplayMemberBinding="{Binding Owner}"/>
            </GridView>
        </ListView.View>
    </ListView>
    <Button Grid.Row="3" HorizontalAlignment="Center" Width="200" Height="30" Margin="3" Background="LightCyan" Content="Request Application" vm:ButtonBehaviour.EmailCommand="{Binding EmailButtonPressed}" />
</Grid> 
```

同样，当单击搜索按钮时会发生过滤功能，它运行 ApplicationModel.Search(string stringtofilteron) 上的方法。我的 MVVM 类基于本教程： http: [//www.codeproject.com/Articles/81484/A-Practical-Quick-start-Tutorial-on-MVVM-in-WPF](http://www.codeproject.com/Articles/81484/A-Practical-Quick-start-Tutorial-on-MVVM-in-WPF)

谢谢你的帮助！

固定代码：公共类 ApplicationViewModel : INotifyPropertyChanged

```
 #region INotifyPropertyChanged implementation
    public event PropertyChangedEventHandler PropertyChanged;
    private void NotifyPropertyChanged(string propertyName = "")
    {
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs(propertyName));
        }
    }
    #endregion

ApplicationsModel.Current.Search(this.searchString);
NotifyPropertyChanged(); 
```

我更改了模型中的 Refresh 方法以在那里进行过滤。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T20:51:10.700

您的 ViewModel 需要实现`INotifyPropertyChanged`，并`AppCollection`在更改时通知。

参考：http: [//msdn.microsoft.com/en-us/library/ms229614.aspx](http://msdn.microsoft.com/en-us/library/ms229614.aspx)

# java - 自定义 Android 评分栏

> ID：14883698
> 
> 赞同：3
> 
> 时间：2013-02-14T20:44:22.850
> 
> 标签：java, android

我想在我的锻炼应用程序中实现一个自定义 RatingBar。该栏应该有 4 颗星，步长为 1。布局如下所示：

```
<com.example.workouttest.MyBar
    android:id="@+id/rating"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:max="4"
    android:numStars="4"
    android:stepSize="1"
    android:scaleX="0.6"
    android:scaleY="0.6"
    android:layout_gravity="right" /> 
```

我想用自定义图像替换默认星星。但是 4 颗星中的每一颗都应该有不同的图像：

星号 1 = 表示“此项目已禁用”的“X”

星 2 = 拇指向下

星 3 = 代表“中性评级”的东西

星号 4 = 竖起大拇指

此外，例如，当该项目被评为 3（中性评级）时，所有其他星（1,2 和 4）应显示其图像的灰色版本。

我尝试从 RatingBar 扩展并提出以下代码：

```
public class MyBar extends RatingBar {

    private int[] starArrayColor = {
            R.drawable.star_1_color,
            R.drawable.star_2_color,
            R.drawable.star_3_color,
            R.drawable.star_4_color
    };

    private int[] starArrayGrey = {
            R.drawable.star_1_grey,
            R.drawable.star_2_grey,
            R.drawable.star_3_grey,
            R.drawable.star_4_grey
    };

    public MyBar(Context context, AttributeSet attrs, int defStyle) {
        super(context, attrs, defStyle);
    }

    public MyBar(Context context, AttributeSet attrs) {
        super(context, attrs);
    }

    public MyBar(Context context) {
        super(context);
    }

    @Override
    protected synchronized void onDraw(Canvas canvas) {
        int stars = getNumStars();
        float rating = getRating();

        for (int i=0;i<stars;i++) {
            Bitmap bitmap;
            Resources res = getResources();
            Paint paint = new Paint();

            if ((int) rating == i) {
                bitmap = BitmapFactory.decodeResource(res, starArrayColor[i]);
            } else {
                bitmap = BitmapFactory.decodeResource(res, starArrayGrey[i]);
            }
            canvas.drawBitmap(bitmap, 0, 0, paint);
            canvas.save();
        }

        super.onDraw(canvas);
    }
} 
```

可悲的是它没有用。它仅以我的自定义图像为背景绘制普通星星。

这里有人知道如何帮助我解决这个问题吗？

**更新**

感谢 Gabe，我的 onDraw 方法现在看起来像这样：

```
@Override
protected synchronized void onDraw(Canvas canvas) {
    int stars = getNumStars();
    float rating = getRating();
    float x = 0;

    for (int i=0;i<stars;i++) {
        Bitmap bitmap;
        Resources res = getResources();
        Paint paint = new Paint();
        x += 50;

        if ((int) rating-1 == i) {
            bitmap = BitmapFactory.decodeResource(res, starArrayColor[i]);
        } else {
            bitmap = BitmapFactory.decodeResource(res, starArrayGrey[i]);
        }
        Bitmap scaled = Bitmap.createScaledBitmap(bitmap, 48, 48, true);
        canvas.drawBitmap(scaled, x, 0, paint);
        canvas.save();
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T20:46:28.060

不要调用 super.onDraw- 这将绘制正常的星星。从那里，还有什么不工作？

# shake-build-system - 添加系统的操作应该改变规则历史

> ID：14883701
> 
> 赞同：3
> 
> 时间：2013-02-14T20:44:40.933
> 
> 标签：shake-build-system

我有这样的规则：

```
"foo" *> \out do
  need something
  create "foo" somehow 
```

它已正确构建，并且运行构建两次不会构建目标。然后我在这个规则中添加一个系统：

```
"foo" *> \out do
  ...
  system' something 
```

现在运行shake 不会重建“foo”目标，因为没有更改依赖项。总之，规则变了。所以我希望新添加的系统动作会改变规则的历史，进而强制重建“foo”，但事实并非如此。通常在 autoconf/automake 系统中，甚至在非平凡的 makefile 中，规则依赖于 Makefile 本身，因此无论何时更改项目都会重新构建。在 Shake 中，我希望它能够工作并且是细粒度的。

在 system' 的源代码中，我看不到任何对正在运行的命令添加隐式依赖的内容。

难道我做错了什么？是有意不支持这种依赖关系，还是根本没有实现？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T22:41:59.853

您看到的行为是预期的，[ICFP 2012 论文](http://community.haskell.org/~ndm/downloads/paper-shake_before_building-10_sep_2012.pdf)S6.2 概述了一些应对策略。如果每个输出都依赖于用于构建它的规则，那将是理想的，但这需要一些规则上的相等性（它们只是在执行期间源代码不可用的函数）。有一天，我希望 Shake 能像你描述的那样工作，但我认为目前在 GHC 中是不可能的。

为了最大限度地减少构建系统更改的数量，最好将您认为会定期更改的任何内容保留在构建系统之外。任何文件列表（例如链接 C 可执行文件所需的文件）都可以放入配置文件中，或者通过使用 oracle 机制正确依赖。

当然，规则仍会不时更改，您可以采取两种方法：

**如果有任何变化，重建一切**

许多 Makefile 采用的一种简单的保守方法是，如果有任何变化，则重新构建所有内容。实现此策略的一种简单方法是对 Shake 脚本进行哈希处理，并将其用作`shakeVersion`字段。对于重建速度相当快的项目，这可以很好地工作。

**手动控制重建**

对于较大的项目，构建系统通常每天都在变化，但构建系统的大部分部分对大多数规则没有影响。对于某些规则，我在规则中明确`need`了一些源文件，例如，如果文件中有一个大型生成器，我会`need`在规则中生成生成的输出。如果您还使用`writeFileChanged`编写生成的文件，那么对生成器的许多修改只会导致最小的重建。

如果更改更具侵入性，我手动增加shakeVersion 字段，并强制完全重建。在具有适当依赖跟踪的成熟构建系统中，此事件可能每年仅发生几次。

# android - UI 任务期间未显示进度对话框

> ID：14883710
> 
> 赞同：0
> 
> 时间：2013-02-14T20:45:23.200
> 
> 标签：android, progressdialog

我正在编写一个需要列出所有 Active 和 Disabled 包的 Android 应用程序。我想显示一个进度对话框，因为它需要一段时间，而且我不想在过程完成时让屏幕“挂起”。

这是重要的片段：

```
 pm = getPackageManager();

    ProgressDialog pd = ProgressDialog.show(this, "Please Wait", "Loading Packages...");

    pkgsEn = PackageLister.retrievePackageList(pm, getResources(), PackageLister.PACKAGES_ENABLED);
    pkgsDis = PackageLister.retrievePackageList(pm, getResources(), PackageLister.PACKAGES_DISABLED);

    laEn = new PackageAdapter(getBaseContext(), R.layout.packageinfo, pkgsEn);
    laDis = new PackageAdapter(getBaseContext(), R.layout.packageinfo, pkgsDis);

    lvEn = new ListView(getBaseContext());
    lvDis = new ListView(getBaseContext());

    pd.dismiss(); 
```

没有错误消息，它只是冻结屏幕直到列表完成。

谢谢你的时间！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:47:32.457

在进度对话框上调用 show() 不会立即显示它。您需要在 loader 或 asynctask 中检索您的包列表，然后在后台工作完成后关闭您的进度对话框。在主线程上按顺序执行所有工作将不允许显示对话框。

# map - 带有枚举和子类的 SuperCSV Dozer 深度映射图？

> ID：14883715
> 
> 赞同：0
> 
> 时间：2013-02-14T20:45:27.000
> 
> 标签：map, enums, subclass, supercsv

我正在尝试使用 SuperCSV 和 Dozer 是否可以做到这一点，或者我是否应该恢复到 Map 解析。我有一个具有 Map 成员字段的 POJO。幸运的是，在 CSV 解析期间，我知道应该构建 MyInterface 的哪个特定子类，并且 MyEnum 的值也是静态的。但是我将如何在列映射中设置所有这些？谢谢！

目前，我的单元处理器具有这种结构，并且我正在使用 CsvMapReader。

```
private static final CellProcessor[] CELL_PROCESSORS = new CellProcessor[] {
        new NotNull(new Trim(new StrRegEx("^\\d{10,}$"))),  // phone1
        new Optional(new Trim(new StrRegEx("^\\d{10,}$"))), // phone2
        new Optional(new Trim(new StrRegEx("^\\d{10,}$"))), // phone3
        new Optional(new Trim()),                           // callVar1
        new Optional(new Trim()),                           // callVar2
        new Optional(new Trim()),                           // callVar3
        new Optional(new Trim()),                           // callVar4
        new Optional(new Trim()),                           // callVar5
        new Optional(new Trim()),                           // callVar6
        new Optional(new Trim()),                           // callVar7
        new Optional(new Trim()),                           // callVar8
        new Optional(new Trim()),                           // callVar9
        new Optional(new Trim()),                           // callVar10
};

private Contact mapRowToContact(Map<String, Object> row) {
    Contact contact = new Contact();

    MyPhoneContactMethodData methodData = new MyPhoneContactMethodData();

    List<Phone> phones = new ArrayList<>();
    Phone phone = new Phone();
    phone.setPhoneNumber((String)row.get("phone1"));
    phones.add(phone);
    phone = new Phone();
    phone.setPhoneNumber((String)row.get("phone2"));
    if (phone.getPhoneNumber() != null) {
        phones.add(phone);
    }
    phone = new Phone();
    phone.setPhoneNumber((String)row.get("phone3"));
    if (phone.getPhoneNumber() != null) {
        phones.add(phone);
    }
    methodData.setPhones(phones);

    List<String> callVars = new ArrayList<>();
    callVars.add((String)row.get("callVar1"));
    callVars.add((String)row.get("callVar2"));
    callVars.add((String)row.get("callVar3"));
    callVars.add((String)row.get("callVar4"));
    callVars.add((String)row.get("callVar5"));
    callVars.add((String)row.get("callVar6"));
    callVars.add((String)row.get("callVar7"));
    callVars.add((String)row.get("callVar8"));
    callVars.add((String)row.get("callVar9"));
    callVars.add((String)row.get("callVar10"));
    methodData.setEnterpriseCallVarData(callVars);

    Map<ContactMethod, ContactMethodData> methodDataMap = new HashMap<>();
    methodDataMap.put(ContactMethod.PHONE, methodData);
    contact.setContactMethodData(methodDataMap);

    return contact;
} 
```

A`Contact`具有这种结构，还有许多其他不相关的字段：

```
public class Contact {
    private Integer id;
    private Map<ContactMethod, ContactMethodData> contactMethodData;
} 
```

`ContactMethod`是一个枚举，具有值`PHONE`和`EMAIL`. `ContactMethodData`是一个接口，它的超类`MyPhoneContactMethodData`实现。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T23:02:35.373

感谢您的代码 - 现在更容易理解了:)

`MyPhoneContactMethodData`您应该能够通过使用以下 bean 映射来读取 CSV 的每一行作为实例。请确保`configureBeanMapping()`在阅读之前使用此电话（如 Super CSV[网站上](http://supercsv.sourceforge.net/examples_dozer.html)所示）。

然后，您必须手动创建`Contact`并将其添加`MyPhoneContactMethodData`到`contactMethodData`地图中，使用 with`ContactMethod.PHONE`作为键（如代码的最后 3 行中所做的那样）。

```
final String[] beanMapping = new String[]{
    "phones[0].phoneNumber",
    "phones[1].phoneNumber",
    "phones[2].phoneNumber",
    "enterpriseCallVarData[0]",
    "enterpriseCallVarData[1]",
    "enterpriseCallVarData[2]",
    "enterpriseCallVarData[3]",
    "enterpriseCallVarData[4]",
    "enterpriseCallVarData[5]",
    "enterpriseCallVarData[6]",
    "enterpriseCallVarData[7]",
    "enterpriseCallVarData[8]",
    "enterpriseCallVarData[9]"
};

beanReader.configureBeanMapping(MyPhoneContactMethodData.class, beanMapping);

MyPhoneContactMethodData methodData;
while( (methodData = 
    beanReader.read(MyPhoneContactMethodData.class, CELL_PROCESSORS)) != null ) {
    // add to contact
} 
```

# compilation - 雪豹中缺少 /usr/bin/ld 文件

> ID：14883716
> 
> 赞同：0
> 
> 时间：2013-02-14T20:45:35.500
> 
> 标签：compilation, fortran

我正在尝试使用安装在 Mac OSX 上的 gfortran 编译 fortran 程序，但出现以下错误：

```
collect2: cannot find 'ld' 
```

当我尝试

```
ls -l /usr/bin/ld 
```

我明白了

```
ls: /usr/bin/ld: No such file or directory 
```

有人能告诉我如何安装这个文件吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T20:47:38.843

ld 附带 XCode 工具，您需要与 XCode 分开安装：http: [//developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man1/ld.1.html](http://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man1/ld.1.html)

# javascript - 如何将随机数作为数字添加到结果中的存储变量，而不是将 2 个字符串加在一起？

> ID：14883717
> 
> 赞同：0
> 
> 时间：2013-02-14T20:45:35.477
> 
> 标签：javascript

所以这里有一个愚蠢的实验，我把它放在一起，基本上是想用修饰符生成一个 D&D 风格的攻击掷骰。我想添加数字，但 javascript 不断将数字添加为字符串。我不确定如何完成基本数学......这是我的代码 -

```
 function battle()
    {
        var CS = document.battleForm.playerCS.value;
        var D20 =  Math.ceil(Math.round(Math.random() * 20))
        var attackRoll = CS + D20

        if (isNaN(CS))
        {
            alert ("please provide your Combat Score!")
            return
        }
        if (CS != '')
        {
            document.battleForm.enemyCS.value = attackRoll 
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T20:47:46.073

为确保将两个数字相加，请尝试：

```
var num3 = +num1 + (+num2); 
```

这*可能*比使用`parseInt`or更可取，`parseFloat`原因有两个：

*   `+`将转换任何数字（意思是，整数和浮点数不需要不同的方法）
*   `+`如果任一值不可转换，则将失败。`parseInt`并`parseFloat`忽略变量中的任何尾随文本。例如，`parseInt("10px", 10)`结果为`10`，而`(+"10px")`结果为`NaN`。

你想用什么取决于你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T20:47:05.220

```
var CS = parseInt(document.battleForm.playerCS.value, 10); // or parseFloat if you expect float number 
```

任何表单文本的值都是字符串，因此需要将其转换为数字。

# mysql - 批量从 SQL 中检索数据

> ID：14883722
> 
> 赞同：0
> 
> 时间：2013-02-14T20:45:41.363
> 
> 标签：mysql, batch-file

[https://stackoverflow.com/questions/14883158/retrieve-sql-data-with-batch](https://stackoverflow.com/questions/14883158/retrieve-sql-data-with-batch) 旧主题已被关闭，因为它“不可读”。

不久。是否可以使用任何桌面编程语言（如 Batch 或 VBS）向 SQL 数据库发布/检索数据，然后将结果写入文件？

我们拥有的唯一“理论”访问权限是`%HomePath%\AppData\Local`，`H:\` 我们的 UAC 访问权限是`user`. 我希望那个用户什么都看不到。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T21:06:26.953

您可以从批处理文件、vbs 或其他任何东西运行 MySQL 客户端。如果您下载 MySQL zip 包，您应该能够解压缩客户端并从任何地方运行它，以安装/UAC 所需。

# c# - 不应该 ILookup 在 TElement 中是（声明的）协变的？

> ID：14883727
> 
> 赞同：19
> 
> 时间：2013-02-14T20:46:16.380
> 
> 标签：c#, .net, linq, generics, covariance

定义 System.Linq.ILookUp 读取

```
interface ILookup<TKey, TElement> : IEnumerable<IGrouping<TKey, TElement>>, IEnumerable {
    int Count {
        get;
    }

    IEnumerable<TElement> this[TKey key] {
        get;
    }

    bool Contains(TKey key);
} 
```

由于 IEnumerable 在 IGrouping<TKey, TElement> 中是协变的，IGrouping<TKey, TElement> 在 TElement 中是协变的，并且接口仅将 TElement 作为返回类型公开，我假设 ILookup 在 TElement 中也是协变的。确实，定义

```
interface IMyLookup<TKey, out TElement> : IEnumerable<IGrouping<TKey, TElement>>, IEnumerable {
    int Count {
        get;
    }

    IEnumerable<TElement> this[TKey key] {
        get;
    }

    bool Contains(TKey key);
} 
```

编译没有问题。

那么，原始定义中缺少**out**关键字的原因可能是什么？可能会添加 Linq 的未来版本吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-21T09:57:20.550

跟踪 MSDN 文档，.NET Framework 4 中已经引入了[泛型中的协变和逆变，在](http://msdn.microsoft.com/en-us/library/dd799517%28v=vs.100%29.aspx)`IEnumerable<T>`此之前，从 .NET Framework 2.0 一直到 .NET Framework 3.5。然后在 .NET Framework 4.0 中，我们可以看到`IEnumerable<out T>`类型参数`T`作为协方差。

`IGrouping<TKey, TElement>`并且`ILookup<TKey, TElement>`从 .NET Framework 3.5 开始就存在。在 .NET Framework 4.0 中，前者已更新为，`IGrouping<out TKey, out TElement>`但后者已被省略，但未说明原因。

`TKey`不能是协变的，因为实现`Contains(TKey)`并`this[TKey]`防止了这种情况。

关于`TElement`这个问题还不清楚。我不相信设计师只是错过了它。也许原因在于对未来的计划。或者他们想阻止类似下面的事情，但我不知道为什么：

```
string[] strings = new[] {"a", "a", "b", "b", "b", "c"};
ILookup<string, string> lookup = strings.ToLookup(s => s); // Valid.
ILookup<string, object> lookup = strings.ToLookup(s => s); // Now invalid, but would correct if TElement was covariant (out TElement). 
```

还有其他作者关注这个问题：

[查找](http://edulinq.googlecode.com/hg/posts/18-ToLookup.html)：

> 需要注意的一点有点奇怪，虽然 IGrouping 在 TKey 和 TElement 中是协变的，但 ILookup 在它的两个类型参数中都是不变的。虽然 TKey 必须是不变的，但 TElement 是协变的是合理的

# javascript - JQuery DOM 和 .click() 的问题

> ID：14883730
> 
> 赞同：0
> 
> 时间：2013-02-14T20:46:22.957
> 
> 标签：javascript, jquery, dom

这是代码：

```
<html>
<head>
 <script type="text/javascript">
       $(document).ready(function(){
           $("#favorite").click(function(){
                     alert('click!')
           });
       });

 </script>
</head>
<body>

   <h4>Favourites <small><%= photo.fav %></small></h4>  
   <button id="favorite" class="btn btn-inverse">Favorite</button> 

</body>
</html> 
```

当我点击按钮时，我没有得到警告窗口，所以我认为是 DOM 树的问题，我该如何解决这个问题......？

谢谢提前！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T20:48:22.953

或者......你不包括jquery......

**编辑：**除了讽刺之外，在您的代码之前包含 JQuery 库以便能够使用它。

[https://developers.google.com/speed/libraries/devguide](https://developers.google.com/speed/libraries/devguide)

这是它应该看起来如何的一个例子......它工作正常。

**[http://jsbin.com/osijok/1/edit](http://jsbin.com/osijok/1/edit)**

```
<html>
<head>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
 <script type="text/javascript">
       $(document).ready(function(){
           $("#favorite").click(function(){
                     alert('click!')
           });
       });

 </script>
</head>
<body>

   <h4>Favourites <small><%= photo.fav %></small></h4>  
   <button id="favorite" class="btn btn-inverse">Favorite</button> 

</body>
</html> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T20:51:10.877

> 我该如何解决这个...？

使用纯 JavaScript

```
(function(){
  document.getElementById("favorite").onclick = function() { alert('clicked'); }
}()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T20:49:30.967

很简单。在从看起来像的那个库执行方法之前，您没有在页面上加载 JQuery 库。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-14T20:49:52.833

您需要导入 jQuery JS 库才能使用诸如

```
 $(document).ready(function(){ .. etc. 
```

# ironmq - IronMQ 单播推送队列 - 它们是否串行处理？

> ID：14883732
> 
> 赞同：4
> 
> 时间：2013-02-14T20:46:22.237
> 
> 标签：ironmq

[设置为单播的IronMQ PUSH 队列](http://dev.iron.io/mq/reference/push_queues/)是否在推送下一条消息之前等待响应？例如 - 如果我有一个单播队列，并且消息 A、B 和 C 进来......订阅者会消费 A - 发送 200 响应，然后被发送 B - 发送 200 响应，最后被发送 C 并发送200回复​​....

或者订阅者会以 IronMQ 发送它们的速度获得 A、B 和 C（可能在订阅者有机会发送任何响应之前......如果消息的处理需要几秒钟）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T19:43:00.333

IronMQ 推送队列不是串行的，它们都是并行的，因此它不会在发送下一条消息之前等待响应，它会在它们进来时将它们发送出去。不过，在不久的将来会有一种方法来设置速率限制所以你可以限制消息推送的速度。

更新：我只想补充一点，使用“单播”向订阅者发送消息的顺序是随机的。因此，如果您有很多订阅者，他们应该在您的订阅者之间平均分配。

# javascript - 如何使用 Google API 或 Javascript 搜索 Google 电子表格？

> ID：14883739
> 
> 赞同：2
> 
> 时间：2013-02-14T20:46:47.280
> 
> 标签：javascript, database, api

我使用 Weebly 设计了一个基本网站，用户将数据输入到 Google 表单中，该表单将输入保存到 Google 电子表格中。
我打算在 PHP 中使用类似下面的内容来搜索电子表格，但意识到 Weebly 不支持 PHP。
我该如何解决这个问题？

[http://nowlookhear.co.uk/katiepiatt/exampledatabase.php](http://nowlookhear.co.uk/katiepiatt/exampledatabase.php)

# javascript - 带有延迟的jQuery切换类只工作一次

> ID：14883740
> 
> 赞同：3
> 
> 时间：2013-02-14T20:46:51.530
> 
> 标签：javascript, jquery, anonymous-function

当谈到 jQuery、匿名函数和延迟时，我显然遗漏了一些基本的东西。

以下代码在每个页面加载时仅工作一次（它将添加类，然后在 1 秒后将其删除，如果我再次单击，它将添加类，但在页面期间永远不会删除类，除非我重新加载页面）：

```
var jElement = $(currElem);
jElement.addClass("highlight")
.delay(1000)
.queue(function(){
$(this).removeClass("highlight");
}); 
```

然而，

如果我添加（不存在的）函数调用作为参数，并且我在我的匿名函数中调用它，那么添加/删除类组合将无限期地工作。

```
var jElement = $(currElem);
jElement.addClass("highlight")
.delay(1000)
.queue(function(randomFunction){
$(this).removeClass("highlight");
randomFunction(); //this makes it seemingly 'miraculously' work??
}); 
```

边注：

```
var jElement = $(currElem);
jElement.addClass("highlight")
.delay(1000)
.queue(function(randomFunction){
$(this).removeClass("highlight");
// this does NOT work; if I dont actually call the 'randomFunction'
// so that function, even though it does nothing; must somehow cause 
// the implicit call of 'dequeue()' ??
}); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T20:50:53.860

那里没有奇迹。这种行为写在[`.queue()`](http://api.jquery.com/queue/).

> 请注意，在添加带有 的函数时**`.queue()`**，我们应确保**`.dequeue()`**最终调用该函数，以便执行行中的下一个函数。
> 
> ```
> $('#foo').slideUp().queue(function() {
>   alert('Animation complete.');
>   $(this).dequeue();
> }); 
> ```
> 
> **从 jQuery 1.4 开始**，被调用的函数作为第一个参数传递给另一个函数。调用时，它会自动使下一个项目出列并保持队列移动。我们使用它如下：
> 
> ```
> $("#test").queue(function(next) {
>     // Do some stuff...
>     next();
> }); 
> ```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T20:50:06.993

the`randomFunction`实际上被称为`next`和引用`.dequeue`方法。调用它会导致队列继续到队列中的下一个项目。

[http://api.jquery.com/queue/](http://api.jquery.com/queue/)

# html - 如何使用 CSS 将文本相对于其父 div 居中？

> ID：14883747
> 
> 赞同：0
> 
> 时间：2013-02-14T20:47:11.007
> 
> 标签：html, css

我知道我可以`text-align: center;`在父 div 上使用使其所有子元素居中，但如果我不希望所有子元素居中怎么办？我只想说，一个相对于父元素居中的子元素。

假设我在包装器 div 中拥有一切。一些标题、表格等。但在底部，我想将一小行文本居中，以说明某些内容。如果它的层次结构是 body > div.wrapper > div.credit，我将如何实现？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T20:48:58.450

那么为什么你在这里使 CSS 复杂化呢？只需将该文本包装在 div 中并`text-align: center;`用于该特定 div 即可完成

如果你想以 CSS 层次结构的方式声明，只需使用这个

```
body div:last-child {
   text-align: center;
} 
```

> 注意：确保要居中的文本是您使用的最后一个 div 否则不要使用 last-child 选择器，最好声明一个类

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T20:54:38.413

仅通过说出哪个来指定要居中的 div：

```
div {
text-align:/* whatever align for the rest */
}

div:credit {
text-align:center;
} 
```

# ruby-on-rails - Rails 不会上传 CSS 图像

> ID：14883748
> 
> 赞同：2
> 
> 时间：2013-02-14T20:47:11.383
> 
> 标签：ruby-on-rails, heroku, asset-pipeline

我读过其他帖子，但没有一个能解决我的问题。图像已成功上传到 Amazon S3。我已删除

```
config.action_dispatch.x_sendfile_header = "X-Sendfile" 
```

如果我使用，在我的 css 文件中

```
background-image: url('background.jpg'); 
```

该图像将在开发模式下显示，但不会在生产中显示。

如果我使用

```
background-image: url(<%= asset_path 'background.jpg' %>) 
```

该图像不会在开发模式或生产中显示。我正在使用 rails 3.2.9 谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T21:20:32.800

您可能需要配置您的应用程序以设置它的资产主机：`config.action_controller.asset_host`。本指南可能会对您有所帮助：[https ://devcenter.heroku.com/articles/cdn-asset-host-rails31](https://devcenter.heroku.com/articles/cdn-asset-host-rails31)

# html - 我不知道如何将我的网页表转换为 div

> ID：14883750
> 
> 赞同：0
> 
> 时间：2013-02-14T20:47:17.607
> 
> 标签：html, css

我的网站上有这张表，我想将其切换为使用 div，但我仍在研究 HTML，不知道如何去做。我有一个名为 theme.css 的 CSS，我知道其中有一些东西可以使它起作用。

```
<table>
 <tr>
   <td>
     <table>
       <tr>
         <td class="cellWidth">
             <img src="4-cute-cats.jpg" class="centerImage" width="300" height="300" />
             <p class="centerText">They hunt in packs.</p>
         </td>
         <td>

             <img src="cat_sniping.jpg" class="centerImage" width="256" height="192" />
             <p class="centerText">Sniper Cat</p></a>
         </td>
         <td class="cellWidth">
             <img src="LOL1.jpg" class="centerImage" width="300" height="298" />
             <p class="centerText">Sneaking Cat</p>
         </td>
         <td class="cellWidth">
             <img src="hammercat.jpg" class="centerImage" width="300" height="163" />
             <p class="centerText">80s Cat</p>
         </td>
       </tr>
       <tr>
         <td class="cellWidth">
             <img src="kittytrap.jpg" class="centerImage" width="200" height=492 />
             <p class="centerText">It's a trap!</p>
         </td>
         <td class="cellWidth">
             <img src="chop-cats.jpg" class="centerImage" width="300" height="140" />
             <p class="centerText">They can strip a car to the frame in under 2:00 minutes.</p>
         </td>
         <td class="cellWidth">
             <img src="smartkat.jpg" class="centerImage" width="200" height="338" />
             <p class="centerText">Intelligent cat.</p></a>
         </td>
         <td class="cellWidth">
             <img src="narniacat.jpg" class="centerImage" width="200" height="337" />
             <p class="centerText">Once a cat of Narnia always a cat of Narnia.</p>
         </td>
       </tr>
       <tr>
         <td class="cellWidth">
             <img src="lolcats3.jpg" class="centerImage" width="300" height="108" />
             <p class="centerText">Tired cat.</p>
         </td>
         <td class="cellWidth">
             <img src="lol_cats_1.jpg" class="centerImage" width="300" height="142" />
             <p class="centerText">Gollum Cat.</p>
         </td>
         <td class="cellWidth">
             <img src="Magical-Kitty.png" class="centerImage" width="300" height="180" />
             <p class="centerText">Super Cat.</p>
         </td>
         <td class="cellWidth">
             <img src="sad-kitty.jpg" class="centerImage" width="300" height="188" />
             <p class="centerText">Sad Kitty.</p>
         </td>
       </tr>
       <tr>
         <td class="cellWidth">
             <img src="cat-in-your-wallpaper.jpg" class="centerImage" width="300" height="200" />
             <p class="centerText">Wallpaper cat.
         </td>
         <td class="cellWidth">
             <img src="thinking-cat.jpg" class="centerImage" width="300" height="475" />
             <p class="centerText">Thinking cat.</p>
         </td>
         <td class="cellWidth">
             <img src="http://3.bp.blogspot.com/_znuneBeHigk/TSOOr5DuoQI/AAAAAAAABFY/-Rpe8S1uRo8/s1600/000.jpg&w=823&h=618&ei=_A4VUfP7L4Gy2QXJ-oHIDQ&zoom=1&ved=1t:3588,r:79,s:0,i:354&iact=rc&dur=2621&sig=108293906633680688065&page=3&tbnh=172&tbnw=231&start=67&ndsp=38&tx=64&ty=72" class="centerImage" width="300" height="225" />
             <p class="centerText">Gamer Kitty.</p>
         </td>
         <td class="cellWidth">
             <img src="http://www.dumpaday.com/wp-content/uploads/2013/01/funny-lol-cats-playing-with-toilet-paper1.jpg" class="centerImage" width="300" height="504" />
             <p class="centerText">Couch cat.</p>
         </td>
        </tr>
     </table>
   </td>
 </tr>
 <tr>
    <td align="center">
        <a href="morekitties.html">More Kitties</a>
    </td>
 </tr>
</table> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T21:06:36.283

看看使用像[bootstrap](http://twitter.github.com/bootstrap/)这样的框架，它会给你一个基本的 CSS 集来帮助你使用，使过渡更容易一些。

您上面的 html 并不太错，经验法则是不要将表格用于页面布局（如您的外部表格），但可以将其用于表格数据。（如数据列表）

使用引导框架。

您可以轻松地将其更改为：

```
<div class="container"> <--- Would be in your base template

<div class="row">

 <div class="span8">
     <table>
      ... Your tabular data
     </table>
 </div>
 <div class="span4">
        <a href="morekitties.html">More Kitties</a>
 </div>

</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T21:09:09.653

因此，如果您将其分解，HTML 代码包含两个相互嵌套的表格：

```
<table>
    <tr>
        <td>
            <table> ... </table>
        </td>
    </tr>
    <tr>
        <td>
            ...
        </td>
    </tr>
</table> 
```

这似乎是为了控制布局，确保内部表格出现在顶部，以及下方的“更多小猫”链接。

这可以完全删除：

```
<table> <!-- inner table --> </table>
<p class="centered"><a href="...">More Kitties</a></p> 
```

使用 CSS：

```
.centered {
    text-align: center; 
} 
```

我建议将该内表（带有猫图片的表）保留为表，因为它实际上是图像数据。（[演示](http://jsfiddle.net/fzK2N/)）

* * *

如果您真的想将内表转换为`<div>`s，那么我建议以下内容：

1.  获取每个单元格 ( `<td>`) 并将其转换为`<div>`
2.  每个样式都`<div>`带有`display:inline-block;`. 这将导致它们彼此相邻出现（内联），但仍具有明确的大小（块）。

以[这个演示](http://jsfiddle.net/qgCtx/)为例。我只包括了前两行猫图片。请注意，每个“行”中的元素数量取决于可用的水平宽度以及每张图片的宽度。如果您在包装器上指定显式宽度，并在`<div>`s 上指定显式宽度，那么您可以控制每行中出现的数量。

要记住的另一件事是`inline-block`CSS 属性值不适用于较旧的 IE 浏览器。（可以肯定的是 6 和 7。我不确定 IE8 是否支持。）

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-14T21:08:29.390

演示：http: [//jsfiddle.net/kLmpV/](http://jsfiddle.net/kLmpV/)

这是一个起点。看看你是否能理解这一点，并将你的表格转换为类似的布局。

**html**

```
 <div class="wrapper">
        <article>
            <div class="item"></div>
            <div class="item"></div>
            <div class="item"></div>
            <div class="item"></div>
        </article>

        <article>
            <div class="item"></div>
            <div class="item"></div>
            <div class="item"></div>
            <div class="item"></div>
        </article>

        <article>
            <div class="item"></div>
            <div class="item"></div>
            <div class="item"></div>
            <div class="item"></div>
        </article>

        <article>
            <div class="item"></div>
            <div class="item"></div>
            <div class="item"></div>
            <div class="item"></div>
        </article>

        <article>
            <div class="item"></div>
            <div class="item"></div>
            <div class="item"></div>
            <div class="item"></div>
        </article>
    </div> 
```

**css**

```
.wrapper {
    margin: 1%;
    background: #f5f5f5;
    overflow: hidden;
}

.item {
    height: 200px;
    float: left;
    display: inline-block;
    width: 23%;
    position: relative;
    background: pink;
    margin: 1%;
} 
```

# javascript - 从函数中退出以减少激活对象比递归或调用嵌套函数更好吗？

> ID：14883764
> 
> 赞同：4
> 
> 时间：2013-02-14T20:48:11.430
> 
> 标签：javascript, performance, function, optimization, activation

在 JavaScript 和其他语言中，我听说过在调用方法/函数时会创建激活对象。为了优化和保持良好的性能，听起来开发人员应该限制调用的函数数量。

现在，如果没有办法绕过它并且您必须调用多个方法，那么最好一个接一个地调用一个方法，如下所示：

```
myFunc1();
myFunc2();
myFunc3();

// or...
var myFuncs = [myFunc1, myFunc2, myFunc3];
for(var a=0, aLen=myFuncs.length; a<aLen; a++) {
  myFuncs[a]();
} 
```

或者，像这样嵌套它们：

```
function myFunc1() {
  // Do something...
  myFunc2();
}

function myFunc2() {
  // Do Something else...
  myFunc3();
}

function myFunc3() {
  //Do one last thing.
}

//Start the execution of all 3 methods:
myFunc1(); 
```

我假设使用第一种技术更有意义，因为它会回到以前的范围并释放最后一个激活对象......但如果有人能证实这一点，我真的很想知道！

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T22:49:50.920

> 为了优化和保持良好的性能，听起来开发人员应该限制调用的函数数量。

是和不是。函数（或更一般地，子程序）在那里被调用，不这样做是没有意义的。如果您可以通过引入另一个函数来使您的代码更加干燥，那么就这样做。

唯一不使用它们的地方是高性能循环，它运行数千次，几乎没有什么工作，函数调用会增加显着的*开销*。不要试图[过早地优化](http://en.wikipedia.org/wiki/Premature_optimization)！

此外，有些语言不能很好地处理递归，您需要将递归函数调用转换为循环，以防止 stackoverflow 异常。然而，这也是一种罕见的情况。

> 一个接一个地调用一个方法，还是嵌套它们更好？

这取决于，因为这两种技术做不同的事情。使用#1，只有 3 个*独立*的函数，它们相互调用。相比之下，#2 定义了*总是*相互调用的函数——你不能`myFunc2`没有`myFunc3`. 这是故意的吗？

如果是，那么这种嵌套没有任何问题。两个额外的堆栈层不会损害您的性能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T21:12:54.167

有关激活对象的信息，请参阅[http://dmitrysoshnikov.com/ecmascript/chapter-2-variable-object/#more-546](http://dmitrysoshnikov.com/ecmascript/chapter-2-variable-object/#more-546)

然而，这不是优化级别的问题，因为您列出的问题是 EXTREME 预优化的一个示例，您的时间不值得这种类型的投资。实际上，在您上面列出的示例中，当您单独查看激活对象时几乎没有节省。

但是，至于正确使用，我尝试尽可能多地封装。如果一个函数不必进入全局范围，并且可以存在于另一个函数的范围内，那么这就是它应该声明的地方。

例如，为了更好地确定范围。

```
 var f2 = function() {
}

var f1 = function() {
  f2()
}

// is not as nice as:

var f1 = function() {
  var f2 = function()

  f2()
}

// or even better.. 

var f1 = function() {
  function() {
  }()  ; execute
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T20:58:47.693

责任分离：

```
private function myFunc1(): void
{

}

private function myFunc2(): void
{

}

private function myFunc3(): void
{

}

private function doAllFunc(): void
{
     myFunc1();
     myFunc2();
     myFunc3();
} 
```

# javascript - javascript：从window.open页面打开一个URL回到原始页面

> ID：14883765
> 
> 赞同：1
> 
> 时间：2013-02-14T20:48:13.497
> 
> 标签：javascript, target, window.open

我正在从“主”网页打开一个较小的网络浏览器窗口。“子”窗口包含如下链接...

`<a onclick="javascript:window.open('http://someplace.com/','_blank');">Someplace</a>`

但我不想使用目标“_blank”，而是想使用原始“主”网页窗口的名称，并在该窗口中打开链接。任何建议如何做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:54:05.087

您可以使用以下命令代替 window.open：

```
<a onclick="javascript:window.opener.location.href = 'http://someplace.com/';">Someplace</a> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T20:54:07.333

按照这个例子来帮助你解决你的问题：

```
<!DOCTYPE html>
<html>
<head>
<script>
function openWin()
{
myWindow=window.open('','','width=200,height=100');
myWindow.document.write("<p>This is 'myWindow'</p>");
myWindow.focus();
myWindow.opener.document.write("<p>This is the source window!</p>");
}
</script>
</head>
<body>

<input type="button" value="Open 'myWindow'" onclick="openWin()" />

</body>
</html> 
```

# java - Java：当 JTextField 为空时显示错误

> ID：14883771
> 
> 赞同：1
> 
> 时间：2013-02-14T20:48:45.173
> 
> 标签：java

我已经完成了这次期中考试的所有编码，但我遇到了这个障碍。主要是，当他们将一个 JTextField 留空时，我似乎无法让我的代码向用户抛出错误消息。我认为我在这里遇到的问题是我已经为每个 JTextFields（使用 Double.parseDouble）声明了双变量，并且就我所有的搜索而言，没有办法检查空的双精度值。我尝试了一种奇怪的解决方法，我为相同的 JTextfields 声明了另一组 String 变量（即它们已经具有归因于它们的双变量），然后测试 stringVariable.equals("") 但这也不起作用。

我试过直接从 JTextField 开始 - myJTextField.getText().equals("") - 这也不会抛出我的错误消息。

请记住，我正在学习 Java 课程，所以这应该是一个简单的解决方案。

我的相关部分的代码如下：

```
 // IF statement to display error message if no name entered
  // OR no value input for any week's Homework
  // OR no JCheckBox isSelected
  // remember to check against the null string or non-selection of JCheckBox

if ( ( name.equals ( "" ) ) ||

    (homework1JTextField.getText().equals(""))||

    //Test against incorrect range of values for homework grades
    (tut1 < 0 || tut1 > 10)||
    (tut2 < 0 || tut2 > 10)||
    (tut3 < 0 || tut3 > 10)||
    (tut4 < 0 || tut4 > 10)||
    (tut5 < 0 || tut5 > 10)||
    (tut6 < 0 || tut6 > 10)||
    (tut7 < 0 || tut7 > 10)||

    (!discussionBoardZeroJCheckBox.isSelected() &&
     !discussionBoardOneTwoJCheckBox.isSelected() &&
     !discussionBoardThreeFourJCheckBox.isSelected() &&
     !discussionBoardFiveSixJCheckBox.isSelected() &&
     !discussionBoardSevenJCheckBox.isSelected()
    )

   )

  {

  // display error message
  JOptionPane.showMessageDialog( null,
        "Full Name, all homework points and at least one discussion board checkbox are
 all required information!",
        "Missing Information", JOptionPane.ERROR_MESSAGE );
  } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T01:21:02.900

一个简单的测试是：

```
if (homework1JTextField.getText().trim().equals("")) {
    // throw error
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T00:52:20.890

有多种方法可以解决问题。这是一个。将 JTextField 替换为 JTextFieldWithDefault 以在用户未键入内容或仅键入空格时返回超出范围的值 (-1)。您现有的代码保持不变，现在可以按预期工作。

```
public class JTextFieldWithDefault extends JTextField {
    public JTextFieldWithDefault() {
        super();
    }
    @Override
    public String getText() {
        String s = super.getText();
        return s.trim().equals("")?"-1":s;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T20:56:36.910

我会说为什么不为每组比较分配中间布尔变量。在 if 中使用这些布尔值。

打印出布尔值的值，因为你的情况很复杂，这里有很多事情可能出错。

# jquery - jQuery .load() 和缓存图像冲突

> ID：14883773
> 
> 赞同：0
> 
> 时间：2013-02-14T20:48:46.833
> 
> 标签：jquery, ajax, caching, load, image

通过使用下面的自定义函数（loadContent），我遇到了障碍。如果我访问工作页面（下面的 URL），它会等待加载图像然后隐藏叠加层（这很棒！）。如果我离开工作页面（访问项目），然后稍后重新访问工作页面，它将不再有效。Firebug 在第二页访问时显示所有内容都已正确加载，但覆盖层永远不会消失。在 hideOverlay(); 之前似乎有东西挂了；如果 loadContent(); 函数被执行 该功能之前已为该受人尊敬的页面运行过。

当前的 WIP 可以在 [edit: URL has been removed] 中找到

**我的加载函数**

```
function loadContent(link) {
 var loadUrl = $(link).attr("href");
 showOverlay(function () {
    $('#holder').load(loadUrl, function () {
        var imgcount = $('#holder img').length;
        $('#holder img').load(function () {
            imgcount--; if (imgcount == 0) {
                $('#content').scrollTop(0);
                hideOverlay();
            };
         });
      })
  });
} 
```

**叠加函数**

```
function showOverlay(callback) {
   $('html').addClass('overlay-visible');
   $('#overlay').fadeIn(500, callback);
};

function hideOverlay(callback) {
  $('html').removeClass('overlay-visible');
  $('#overlay').delay(100).fadeOut(500, callback);
}; 
```

提前感谢任何可以帮助我的人！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T21:23:47.077

使用图像预加载而不是依赖于 dom 中存在的图像，如果它们已经被缓存，它们可能会在绑定之前触发加载事件。

```
$('#holder').load(loadUrl, function () {

    var defArr = $("#holder img").map(function(){
        var def = $.Deferred();
        var img = new Image();
        // bind to load event before setting src, very important!
        $(img).load(def.resolve);
        img.src = this.src;
        return def.promise();
    });

    $.when.apply($,defArr).done(function(){
        // hide overlay
    });

}); 
```

# android - Android SDK 好友请求返回“抱歉，出了点问题”

> ID：14883774
> 
> 赞同：1
> 
> 时间：2013-02-14T20:48:52.273
> 
> 标签：android, facebook, sdk, request

我正在使用适用于 Android 的 Facebook SDK，当我使用以下代码发送好友请求时，我收到以下错误：“抱歉，出了点问题。我们正在努力尽快解决这个问题。”

这是我的问题还是 Facebook 的问题？几天前，这段代码运行良好。它像往常一样打开一个带有好友请求的弹出窗口。但是当我点击接受时，它会显示错误页面。请帮我。

```
 private void sendRequestDialog(String friendID)
{   
    Bundle params = new Bundle();

    params.putString("id", friendID);

    WebDialog friendDialog = (
            new WebDialog.Builder(context, Session.getActiveSession(), "friends", params))
    .setOnCompleteListener(new OnCompleteListener()
    {
        @Override
        public void onComplete(Bundle values, FacebookException error)
        {
            if(error != null)
            {
                if(error instanceof FacebookOperationCanceledException)
                {
                    Toast.makeText(context, "Friend Request Cancelled", Toast.LENGTH_SHORT).show();
                }
                else
                {
                    //Toast.makeText(getApplication().getApplicationContext(), "Network Error", Toast.LENGTH_SHORT).show();
                }
            }
            else
            {
                final String requestId = values.getString("request");
                if (requestId != null)
                {
                    Toast.makeText(context, "Friend Request Sent", Toast.LENGTH_SHORT).show();

                    removeFriend();
                }
                else
                {
                    Toast.makeText(context, "Friend Request Cancelled", Toast.LENGTH_SHORT).show();
                }
            }   
        }

    })
    .build();
    friendDialog.show();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-01T13:19:30.950

尝试改变

```
params.putString("id", friendID); 
```

至

```
params.putString("to", friendID); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-11-15T12:27:33.427

我在同样的问题上苦苦挣扎。

我的解决方法是仔细检查权限。（first_name、last_name 和 name 等不能正常工作）您应该首先删除所有并只使用“email”，然后相应地添加剩余的权限，这样更容易理解。

```
LoginManager.getInstance().logInWithReadPermissions(
        this,
        listOf("email") //, "name", "first_name", "public_profile"
    ) 
```

# asp.net-mvc - ASP.NET MVC 模型绑定恐怖

> ID：14883778
> 
> 赞同：0
> 
> 时间：2013-02-14T20:49:09.733
> 
> 标签：asp.net-mvc, asp.net-mvc-4, model-binding

关于控制器操作上的模型绑定，我有两个几乎相同的场景。一种有效，一种无效。我不知道为什么。

这有效：

鉴于此 ViewModel 类：

```
Public Class SeasonCreateViewModel
    Public Property Season As Season
End Class 
```

我们有这些动作

```
Function Create() As ActionResult
    Dim seasonVM As New SeasonCreateViewModel()
    Return View("Create", seasonVM)
End Function

<HttpPost()>
<ValidateAntiForgeryToken()>
Function Create(seasonVM As SeasonCreateViewModel) As ActionResult
End Function 
```

一切都完美结合。 `seasonVM.Season`包含从表单发布的值。

但是，这不起作用：

鉴于此 ViewModel 类：

```
 Public Class UserCreateViewModel    
        Public UserPerson As UserPersonModel
 End Class 
```

而这些动作：

```
 Function Create() As ActionResult
        Dim userVM As New UserCreateViewModel()
        Return View("Create", userVM)
    End Function

    '
    ' POST: /Admin/User/Create

    <HttpPost()>
    <ValidateAntiForgeryToken()>
    Function Create(userVM As UserCreateViewModel) As ActionResult
    End Function 
```

`userVM.UserPerson`不以相同的方式绑定到表单值`seasonVM.Season`。事实上，它是`Nothing`（又名。`null`）

有没有人有任何想法？

如果您对视图感到好奇，它们的结构是相同的，如下所示：

```
@Using Html.BeginForm()
    @Html.AntiForgeryToken()
    @Html.ValidationSummary(True)
        <div class="editor-label">
            @Html.LabelFor(Function(model) model.UserPerson.NewUsername)
        </div>
        <div class="editor-field">
            @Html.EditorFor(Function(model) model.UserPerson.NewUsername)
            @Html.ValidationMessageFor(Function(model) model.UserPerson.NewUsername)
        </div>
<p>
            <input type="submit" value="Create" />
        </p>
End Using 
```

和

```
@Using Html.BeginForm()
    @Html.AntiForgeryToken()
    @Html.ValidationSummary(True)
        <div class="editor-label">
            @Html.LabelFor(Function(model) model.Season.SeasonDescription)
        </div>
        <div class="editor-field">
            @Html.EditorFor(Function(model) model.Season.SeasonDescription)
            @Html.ValidationMessageFor(Function(model) model.Season.SeasonDescription)
        </div>
<p>
            <input type="submit" value="Create" />
        </p>
End Using 
```

请注意：我省略了不相关的代码，主要是视图页面上的附加属性。我会说我没有名为“userVM”的属性，`UserPersonModel`就像这里的情况一样：[提交表单时模型为空](https://stackoverflow.com/questions/13968452/model-is-null-when-form-submitted/13969007#13969007)

**更新**

好的。我想我已经准备好放弃弄清楚为什么 Season 可以正确绑定，但 UserPerson 不是。

我以为我已经找到了答案，但实际上似乎并没有什么不同：

我有

```
Public Class SeasonCreateViewModel
    Public Property Season As Season
End Class 
```

我有

```
Public Class UserCreateViewModel    
    Public UserPerson As UserPersonModel
End Class 
```

当这样排列时，差异似乎很明显。在`SeasonCreateViewModel`中，我有一个`Season`与类同名的属性，它是 ( `Season`) 的实例。在其中`UserCreateViewModel`，我有一个属性`UserPerson`，它的名称与它的类稍有不同`UserPersonModel`。因此，我认为模型绑定器不会自动匹配`userVM.UserPerson`到其对应的类。

因此，我将类更改为`UserPersonModel`，`UserPerson`以便表单值以与它们相同的方式匹配`Season`（即与类名匹配），但它仍然没有修复它。

**然而，解决它**的方法是，如果我改变它：

`Function Create(userVM As UserCreateViewModel) As ActionResult`

对此

`Function Create(userPerson As UserPerson) As ActionResult`

为什么这突然正确绑定，以前没有？我不知道。不过，这是否有助于任何人回答这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T21:05:14.953

据我了解，您不是在创建`UserPersonModel`. 不过我可能错了:)

```
Public Class UserCreateViewModel    
    Public UserPerson As UserPersonModel
End Class 
```

我认为在您的行动中，您应该执行以下操作：

```
Function Create() As ActionResult
    Dim userVM As New UserCreateViewModel()

    //userVM.UserPerson = new UserPersonModel() -- in c#
    //userVM.UserPerson As New UserPersonModel() -- in VB?

    Return View("Create", userVM)
End Function 
```

或者只是忽略这个答案：P

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T21:09:26.877

我以前遇到过这个问题，答案一点也不明显，但在你知道之后才有意义。如果您绑定整个模型（而不是静态类型），则该模型的每个成员都必须在表单中发布，否则，模型绑定器不会将发布的值识别为模型的实例。

如果您不想发布每个成员，而只想发布一个子集，那么您需要创建一个仅包含您要发布的字段的视图模型，并使用 AutoMapper 之类的东西，或者只是手动将字段映射到实际模型中您的 POST 操作。

# css - 如何更改这些链接在 div 标头中的位置

> ID：14883784
> 
> 赞同：0
> 
> 时间：2013-02-14T20:49:46.967
> 
> 标签：css

我试图想出一个简单的 css 布局，它应该如下所示：

![在此处输入图像描述](../Images/e2199a48cf39489aad2a14e35fff2447.png)

这是我的标题和导航栏的 html 代码：

```
<div id="header">
<h1>LOGO</h1>
<ul>
<li><a href= ""> Home </a></li>
<li><a href= ""> Logout </a></li>
</ul>
</div>

<div id="navigation">
<ul>
    <li><a href="">Home</a></li> 
    <li><a href="">Help</a>
    <li><a href="">Contact Us</a>
    <li><a href="">Customers</a> 

</div> 
```

而且我已经在导航栏上进行了一些样式设置，但是我希望能够保持标题中的两个链接右对齐并且徽标图像左对齐。当我尝试在标题中编辑这些链接时，一切都变得一团糟，因为我对如何区分导航列表项和标题列表项感到困惑。有人可以帮我定位标题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:57:25.453

```
#header ul { float: left; } 
```

或者

```
#header ul { position: absolute; right: 0; } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T20:52:13.840

在标题中，您需要浮动`h1`左侧和`ul`右侧，然后添加`display: inline`到您的链接（以使它们保持在同一行）。

要定位标题中的列表项，您可以简单地使用父选择器，如下所示`#header li`：

这是您需要的：

```
#header {
    border: 1px solid #ccc;
    overflow: hidden; /* clearfix */
}
#header h1 {
    float: left;
}
#header ul {
    float: right;
}
#header li {
    display: inline;
} 
```

见[演示](http://jsfiddle.net/zaknotzak/hYyAZ/)。

# python - Python：从具有不同类型变量的文件中读取行

> ID：14883789
> 
> 赞同：1
> 
> 时间：2013-02-14T20:49:56.357
> 
> 标签：python, variables, types, try-except

尝试分析具有字典标题行的 2 列（颜色 number_of_occurances）.tsv 文件。尝试以最通用的方式跳过标题行（假设这是通过要求第二列是 int 类型）。以下是我想出的最好的，但似乎必须有更好的：

```
filelist = []
color_dict = {}
with open('file1.tsv') as F:
    filelist = [line.strip('\n').split('\t') for line in F]
for item in filelist:
    try: #attempt to add values to existing dictionary entry
        x = color_dict[item[0]]
        x += int(item[1])
        color_dict[item[0]] = x
    except: #if color has not been observed yet (KeyError), or if non-convertable string(ValueError) create new entry
        try:
            color_dict[item[0]] = int(item[1])
        except(ValueError): #if item[1] can't convert to int
            pass 
```

似乎应该有更好的方法来处理尝试和异常。

请求文件摘录：

`color Observed`
`green 15`
`gold 20`
`green 35`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T20:52:55.333

你不能通过`[1:]`像这样切片列表来跳过列表中的第一个元素：

```
filelist = [line.strip('\n').split('\t') for line in F][1:] 
```

现在，`fileList`将根本不包含第一行的元素，即标题行。

或者，正如@StevenRumbalski 在评论中指出的那样，您可以在*列表理解*`next(F, None)`之前简单地做，以避免在第一个元素之后复制您的列表：

 *```
with open('file1.tsv') as F:
    next(F, None)
    filelist = [line.strip('\n').split('\t') for line in F] 
```

* * *

另外，如果你在`defaultdict`这里使用a会更好。

像这样使用它：

```
from collections import defaultdict
color_dict = defaultdict(int) 
```

这样，您就不必在对其`key`进行操作之前检查 , 是否存在。因此，您可以简单地执行以下操作：

```
color_dict[item[0]] += int(item[1]) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T20:56:39.580

我会`defaultdict`在这种情况下使用。因为，当第一次遇到每个键时，它还没有在映射中；因此会自动创建一个条目。

```
 from collections import defaultdict
 color_dict = defaultdict(int)
 for item in filelist:
       color_dict[item[0]] += int(item[1]) 
```*

# sql - CREATE TABLE 给出错误 4145 和 102

> ID：14883792
> 
> 赞同：0
> 
> 时间：2013-02-14T20:50:01.333
> 
> 标签：sql, sql-server, csv

我正在尝试将 CSV 导入 SQL。CSV 是非常大的 4g，所以我相信这确实是查询数据的唯一选择。

我已经创建了一个新数据库，现在尝试创建将保存信息的表。

我已经运行了以下内容：

```
CREATE TABLE Provider_NPI
(NPI INT,
Entity Type Code INT,
Replacement NPI INT,
Employer Identification Number (EIN) INT, 
```

在 INT 之后，它继续处理 300 多个标题，但在三个不同的标题上出现错误，并出现“MSG 4145，15 级，状态 1，X 行”错误。我已经把它们列出来了

```
Error:
Msg 102, Level 15, State 1, Line 5
Incorrect syntax near 'Code'. 
```

对于这一行： `Replacement NPI INT,`

这上面的行是`Entity Type Code INT,`

```
Error:
Msg 4145, Level 15, State 1, Line 29
An expression of non-boolean type specified in a context where a condition is expected, near 'U'. 
```

对于这一行： `Provider Business Mailing Address Telephone Number VARCHAR(75),`

```
Error:
Provider Business Practice Location Address Telephone Number VARCHAR(75), 
```

对于这一行： `Provider Business Practice Location Address Telephone Number VARCHAR(75),`

谁能帮我确定什么是错的？我相信这可能与某些标题名称有关？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T21:24:14.623

列名中可以包含空格（和括号），但前提是您将它​​们放在括号中。

```
CREATE TABLE Provider_NPI
(NPI INT,
[Entity Type Code] INT,
[Replacement NPI] INT,
[Employer Identification Number (EIN)] INT) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-23T03:13:17.590

Bernie 帮助解决了这个问题，但我在 CSV 文件中遇到了其他问题，并且一直在休假，所以我现在回来努力解决。

我已经成功创建了数据库和表，其中的所有列标题都设置了正确的数据类型和长度。即 varchar(50) 或 INT.. 我现在遇到的问题是从 CSV 文件导入数据。它给了我 msg 4868 错误，我已经指出我正在尝试使用的批量插入问题以及所有数据周围的双引号。

正如我所说，有 300 多个列标题和 100,000 多个行。所有数据、数字、字符串和日期都用双引号“”括起来。看起来需要一个格式文件，我正在创建但遇到了[http://support.microsoft.com/default.aspx?scid=kb;EN-US;132463上的说明的问题](http://support.microsoft.com/default.aspx?scid=kb;EN-US;132463)

数据看起来像 "1231231","name 1","address","zip","555-555-5555","","","2nd address","fax","",""

数据继续，一些字段的数据被包围，而另一些则为空，只有引号。该文章指出使用虚拟行来删除引号，我可以这样做，但似乎在创建格式文件后需要对格式文件进行大量手动编辑。

有没有办法创建格式文件，允许我在导入数据时使用它来删除双引号？我很茫然，真的很想解决这个问题。

# html - 子 div 高度 100% 内部位置：固定 div + 溢出自动

> ID：14883794
> 
> 赞同：6
> 
> 时间：2013-02-14T20:50:00.777
> 
> 标签：html, css, position, overflow, fixed

在尝试以下操作时，我遇到了一些奇怪的行为（请参阅 jsfiddle：http: [//jsfiddle.net/9nS47/](http://jsfiddle.net/9nS47/)）。

HTML：

```
<div id="slider">
    <div id="wrapper">
        <div id="navigation"></div>
        <div id="container">
            <div id="button"></div>
        </div>
    </div>
</div> 
```

CSS：

```
HTML,BODY 
{ width:100%; height:100%; }
* { margin: 0; padding: 0; }
#slider
{
    position: fixed;

    top: 0;
    bottom: 0px;
    left: 100px;

    overflow-y: auto;

    background-color: red;
}

#wrapper
{
    position: relative;

    height: 100%;

    background-color: #000000;

    min-height:400px;
}

#navigation
{
    display: inline-block;
    width: 80px;
    height: 100%;

    background-color: #0000FF;
}

#container
{
display: inline-block;
    height: 100%;

    background-color: #00FF00;
}

#button
{
    width: 22px; height: 100%;
    float:right;

    background-color: #CCFFCC;
    cursor:pointer;
} 
```

我想要做的是制作一个左侧导航栏，它跨越整个可见窗口高度，并且仅在其高度小于例如 400px 时才显示滚动条。由于一些调整大小的问题，该 div 的滚动条似乎始终可见（底部有一个额外的像素，我无法解释 [color:red]）。

当滚动条可见时，Firefox 也会将第二个子元素移到第一个子元素的下方，因为滚动条似乎是内容区域的一部分，因此占用了大约 20px 的空间。如果将溢出：自动替换为溢出：滚动，则不会发生这种情况。

ATM 更改布局（特别是具有位置的容器：固定）不是一种选择。

不要介意绿色和蓝色框之间的空间。似乎是一个空白问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T22:54:18.330

由于您似乎无法更改您的“包装器”代码，因此我尝试尽可能少地更改您的原始代码。事实上，我唯一做的就是添加一些 jQuery。

看看[这个更新的 jsfiddle](http://jsfiddle.net/9nS47/6/)。我已经包含了 jQuery，我添加的 javascript 是这样的：

```
$(window).bind("load resize", function(){  
     //this runs as soon as the page is 'ready'
    if($(window).height() < 400){        
        $("#slider").css("overflow-y","scroll");
    }else{        
        $("#slider").css("overflow-y","hidden");   
    }  
}); 
```

基本上，'onload' 和 'onrezise'，jQuery 会判断你是否应该显示滚动条。

您的“自动”不起作用的原因是`slider`元素的“固定”位置。浏览器无法完美地计算出高度。

# vb.net - 对 IPAddress 执行按位运算

> ID：14883798
> 
> 赞同：1
> 
> 时间：2013-02-14T20:50:11.170
> 
> 标签：vb.net, ip-address, bitwise-operators

当我发现我不能简单地这样做时，我真的很惊讶：

```
 Dim ip = IPAddress.Parse("192.168.1.3")
    Dim mask = IPAddress.Parse("255.255.255.0")

    ' next lines won't compile
    Dim networkAddress = ip And mask ' would produce 192.168.1.0
    Dim broadcastAddress = ip Or (Not mask) ' would produce 192.168.1.255 
```

因此，在我自己在子类上实现此类功能之前：我是否遗漏了一些明显的东西？是否有我忽略的未实施的原因？

我承认我在网络课程中可能没有像我应该关注的那样关注。

**编辑**

我想出了这段代码：

```
 Dim ip = IPAddress.Parse("192.168.1.3")
    Dim mask = IPAddress.Parse("255.255.255.0")

    Dim ipUnsignedInteger = BitConverter.ToUInt32(ip.GetAddressBytes, 0)
    Dim maskUnsignedInteger = BitConverter.ToUInt32(mask.GetAddressBytes, 0)

    Dim networkAddressUnsignedInteger = ipUnsignedInteger And maskUnsignedInteger
    Dim networkAddress = New IPAddress(networkAddressUnsignedInteger)

    Dim broadcastAddressUnsignedInteger = ipUnsignedInteger Or (Not maskUnsignedInteger)
    Dim broadcastAddress = New IPAddress(broadcastAddressUnsignedInteger) 
```

它可以工作，但是对于我来说似乎如此明显的东西，它的额外代码数量令人难以置信！为什么这不是框架的一部分？！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T02:30:14.977

```
Dim networkaddress2 As New IPAddress(ip.Address And mask.Address)
Dim broadcastAddress2 = New IPAddress(CUInt(ip.Address) Or (Not CUInt(mask.Address))) 
```

但是请注意，不推荐使用 IPAddress.Address。

# git - 如何配置 TeamCity 构建代理以通过 SOCKS 代理使用 git 和 git:// 协议？

> ID：14883799
> 
> 赞同：4
> 
> 时间：2013-02-14T20:50:09.857
> 
> 标签：git, github, ssh, teamcity, socks

我正在尝试在具有更严格网络的生产数据中心中设置我们的 TeamCity 构建代理。如何配置构建代理以通过 SOCKS 代理使用 git（客户端签出）？TeamCity（从 6.5 开始）不支持对 github.com 进行身份验证的 https 协议，因此我唯一的选择是通过 git 协议进行默认私钥身份验证。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T10:24:52.357

确保 /.ssh/config 中的私钥（在构建服务器上，并且是运行 Team City 代理的用户的主目录）已在 github 上的项目中注册（这是将用作选择*默认私钥*设置的结果）？

您应该设置 N 个密钥对，全部在 github 中针对您的项目注册，其中 N 是您正在使用的构建服务器的数量（在同一用户下的一台机器上运行多个代理会很好，因为它们都将使用相同的键）。

我首先建议您登录到构建服务器本身并尝试 （如[github 的 ssh 帮助](https://help.github.com/articles/generating-ssh-keys)`ssh -T git@github.com`中的“Test Everything Out”中所建议的那样）。如果这行得通，那么你应该很高兴。如果没有，则使用获取一些详细的输出并进行调查...`ssh -vT git@github.com`

# c++ - Qt Creator“没有这样的文件或目录”

> ID：14883801
> 
> 赞同：2
> 
> 时间：2013-02-14T20:50:19.490
> 
> 标签：c++, qt, dll, qt-creator, libraries

让我首先说我对 Qt 相当陌生。话虽如此，我遇到了依赖性问题。

我正在尝试在 Matlab 目录中使用 mclmcrrt.h。从我的 *.pro 文件中，我右键单击->添加库->外部库->浏览等，我得到以下信息：

```
win32: LIBS += -L$$PWD/../../../Program Files (x86)/MATLAB/MATLAB Compiler Runtime/v714/extern/lib/win32/microsoft/ -lmclmcrrt
INCLUDEPATH += $$PWD/../../../Program Files (x86)/MATLAB/MATLAB Compiler Runtime/v714/extern/include
DEPENDPATH += $$PWD/../../../Program Files (x86)/MATLAB/MATLAB Compiler Runtime/v714/extern/include 
```

这看起来类似于我在其他地方看到的使用 INCLUDEPATH 等。此外，在我包含的调用 mclmcrrt.h 的头文件中，我有：

```
#include "mclmcrrt.h" 
```

无论如何，我都无法摆脱错误：“mclmcrrt.h：没有这样的文件或目录”

我环顾四周，尝试了很多东西。我在 Visual Studio 中得到了这个工作，但似乎无法在这里得到它。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T20:56:43.523

路径中的空格会破坏解析器，试试这个：

```
win32: LIBS += -L$$PWD/../../../"Program Files (x86)/MATLAB/MATLAB Compiler Runtime"/v714/extern/lib/win32/microsoft/ -lmclmcrrt
INCLUDEPATH += $$PWD/../../../"Program Files (x86)/MATLAB/MATLAB Compiler Runtime"/v714/extern/include
DEPENDPATH += $$PWD/../../../"Program Files (x86)/MATLAB/MATLAB Compiler Runtime"/v714/extern/include 
```

# html - 使用 css 将对象简单居中，无需 hack

> ID：14883805
> 
> 赞同：24
> 
> 时间：2013-02-14T20:50:34.247
> 
> 标签：html, css, center

我想使用 CSS 将对象居中而不使用 hack，这可能吗？如何？

我已经尝试过了，但是我的 p 标签不见了。

```
.centered {
  position: fixed;
  top: 50%;
  left: 50%;
} 
```

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2013-02-14T21:02:52.627

有几种方法可以使元素居中。但这取决于您的元素是什么以及我们选择如何显示它：

*   如果你有`{display:inline; }`

    这很简单。您可以只使用“文本对齐：中心；” 使文本、图像和 div 居中。

*   如果你有`{display:block;}`

    这有点困难。这取决于您的对象是如何定位的。您的对象可以是相对的、绝对的或固定的。

    *   如果是相对的；那么你可以使用`"margin:0 auto;"`，但是你需要一个宽度值。

    *   如果它是绝对定位的，那么你需要指定你的`"top:"`和`"left:"`值。你还需要一个宽度。如果您知道元素的宽度，最好的方法是使用`{left:50%; margin-left:-X}`，其中 X = 元素宽度的 1/2。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-14T20:54:33.053

HTML：

```
<div>Centered</div> 
```

CSS：

```
div {
    margin: 0 auto;
    width: 200px;
} 
```

现场示例：http: [//jsfiddle.net/v3WL5/](http://jsfiddle.net/v3WL5/)

请注意，`margin: 0 auto;`只有当`div`具有宽度时才会生效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-14T20:52:28.520

像这样使用`margin: auto`：

```
margin: 0px auto 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-04-07T13:42:46.757

将此用于一般目的。甚至在任何内容中的 span 或 div ：

```
width:inherit; display:block;margin:0 auto; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-01-02T07:17:09.633

用法 ：

1.  在线使用：内容在这里....
2.  CSS 代码：

    `#text-align { text-align:center }`

HTML 代码：

`<div id="text-align">Content goes here....</div>`

[http://www.techulator.com/resources/4299-center-Deprecated-tags-HTML.aspx](http://www.techulator.com/resources/4299-center-Deprecated-tags-HTML.aspx)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-03-26T21:16:57.137

游戏迟到了，但是您尝试过使用**`display:flex`**父母吗？

我有一个有用的类，它很**简单**，**适用于所有类型的元素**：

```
/* apply this on the parent */
.center {
    display:flex;
    align-items: center; /*vertical alignement*/
    justify-content: center; /* horizontal alignement*/
} 
```

这是相对较新的，但[在大约 98% 的主要浏览器中都支持](https://caniuse.com/#feat=flexbox)。

不过我建议你学习一下 flexBox，一开始它可能看起来很复杂，但它对所有类型的布局都非常强大！

* * *

## 回答 #7

> 赞同：-4
> 
> 时间：2013-11-22T10:56:16.413

如果您不需要定位：固定；你可以使用

```
<center>
Hello
</center> 
```

这在 HTML5 中已弃用

# java - 我可以在java中将两个单独的Jframe文件放入一个Jframe文件中吗？

> ID：14883821
> 
> 赞同：0
> 
> 时间：2013-02-14T20:51:26.547
> 
> 标签：java, swing, jframe, jpanel

我正在为我的项目开发图书馆管理系统。我`JFrame`为添加成员、添加书籍、发行书籍创建了不同的表单文件。我还创建了 menu.java 和 header.java。我是否可以将所有这些文件放在一个`JFrame`表单文件或单个文件中。通常在 HTML 中，我们可以使用 FRAMESET 标签将 2 个或多个不同的页面放在一个页面中。有什么我可以在java中使用的东西，以便我可以插入menu.java，header.java。当我单击菜单上的按钮时，文件会在主面板中打开吗？因为我是新手，所以我对java不太熟悉，所以如果我提出一个愚蠢的问题，我想道歉。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T23:14:18.523

这是引用的基本概念。基本上，您需要为应用程序的各个部分提供一个或对应用程序视图/模型的引用。

也就是说，对于您的菜单，您需要传递对主视图的引用，因此当单击菜单项时，它知道可以在哪里显示其结果。

对我来说，我会犹豫是否不必要地公开我的应用程序的某些部分，相反，我会传递给它某种模型/管理器，它能够充当视图和操作之间的过渡。这当然取决于您的基本要求。

**一个非常基本的例子**

```
public class Parent {
    protected static final double BRIBE = 20.00;
    public Parent() {
        Child child = new Parent(child);
    }

    public double getMoney() {
        return wealth - BRIBE;
    }
}

public class Child {
    private Parent parent;
    public Child(Parent parent) {
        double allowance = parent.getMoney();
    }
} 
```

# xml - XQuery 分组和查找最大值

> ID：14883826
> 
> 赞同：1
> 
> 时间：2013-02-14T20:51:34.390
> 
> 标签：xml, group-by, xquery, grouping

我的 XML 文档如下所示：

```
<books>
    <book><author>A</author></book>
    <book><author>B</author></book>
    <book><author>C</author></book>
    <book><author>B</author></book>
    <book><author>C</author></book>
</books> 
```

现在，查询应该返回拥有最多书籍的作者姓名。在这种情况下`B,C`（因为两者都有 2 本书）。问题是，它必须只有一个查询，因此在这种情况下，找到最大值 (2) 然后搜索有 2 本书的作者不是可接受的解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T21:09:38.953

按作者分组并将即时结果与他们的出版物计数一起存储。然后过滤以仅返回发表次数最多的作者。

```
let $authors :=
  for $book in //book
  let $author := $book/author
  group by $author
  return <author count="{ count($book) }">{ $author }</author>
return $authors[@count = max($authors/@count)]/data() 
```

# ruby-on-rails - 嵌套表单不显示字段

> ID：14883828
> 
> 赞同：1
> 
> 时间：2013-02-14T20:51:38.570
> 
> 标签：ruby-on-rails

我有一个`nested form`基于关系的`has_one`关系，但它没有显示字段。

我错过了什么？

新动作

```
 def new
    @doctor = Doctor.new    
    1.times { @doctor.build_schedule }

    respond_to do |format|
      format.html # new.html.erb
      format.json { render json: @doctor }
    end
  end 
```

_形式

```
<%= simple_form_for(@doctor, :html => { class: "form-horizontal"})  do |f| %>

    <%= f.input :name %>

        <%= f.simple_fields_for :schedule do |builder| %>
        <%= render 'days_checkboxes', :f => builder %>

    <%= f.submit %>
<% end %> 
```

模型

```
class Doctor < ActiveRecord::Base

  has_one :schedule, dependent: :destroy

end 
```

我是否必须在其他操作中设置构建？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T22:56:38.963

如果您的模型实例上没有`schedule`关联的对象，是的，您需要`build_schedule`在要引用它的任何地方调用。如果您不这样做，则表单根本不会呈现，因为它没有任何可显示的字段。

# android - 您可以使用 Intent 启动 Adob e Reader 或 Docs Reader 在 Android 机器中打开特定 PDF 吗？

> ID：14883830
> 
> 赞同：0
> 
> 时间：2013-02-14T20:51:45.473
> 
> 标签：android, android-intent, google-docs, adobe-reader

在针对 Android 操作系统的网站上，有没有办法创建一个链接，使操作系统打开从该网站下载的 PDF？也就是说，不需要用户手动打开PDF？

编辑：澄清一下，我想在我的网站上实现类似的东西：

```
<a href="adobe_reader/foo.pdf">Click here to open foo.pdf on your Android!</a> 
```

这应该是我网站上的一个链接，它使 Adob​​e（或另一个）启动`foo.pdf`，它已经存储在 android 设备上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:57:30.027

他们应该。尝试这个：

```
 Intent intent = new Intent(Intent.ACTION_VIEW);
                intent.setDataAndType(path, "application/pdf");
                startActivity(intent); 
```

如果任何应用程序已注册能够查看 PDF（两者都应该具有），它将启动它们。或安装的任何其他声称能够阅读 pdf 的应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T21:21:51.860

您可以结合使用 WebView 和 Google Docs 试试这个：

您可以尝试使用以下组合

```
String docName = "somedoc.pdf"
String PDF_BASE_URL = "http://docs.google.com/gview?embedded=true&url=";
mWebView.loadUrl(PDF_BASE_URL + docName); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T21:22:41.250

# 哦，我知道它是一个网站

我认为你所做的已经足够了，因为浏览器处理他们想要如何处理链接。如果不是 android 上的股票浏览器，您所做的应该适用于大多数浏览器。

# c# - 使用 HashSet 时遇到错误

> ID：14883835
> 
> 赞同：-1
> 
> 时间：2013-02-14T20:51:58.587
> 
> 标签：c#, hashset

我创建了一个类，其中包含一个`HashSet`跟踪 1-10 的整数。我使用该`Contain`方法检查是否在 , 中插入了一个值`HashSet`，并带有一个布尔值。这是我的代码：

```
class BasicIntSet
{
    HashSet<int> intTest = new HashSet<int>() { 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 };

    bool has4 = intTest.Contains(4);    // Returns true
    bool has11 = intTest.Contains(11);  // Returns false
    bool result = intTest.IsSupersetOf(new[] { 4, 6, 7 });
} 
```

我现在的问题是，我收到一条错误消息`"Error 1 A field initializer cannot reference the non-static field, method, or property"`

有人知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T20:53:52.867

您所有的代码都在*类声明*中......您正在声明实例字段。您不能使一个实例字段初始值设定项引用另一个（或以`this`任何其他方式引用），因此会出现错误。

修复它很简单 - 将您的代码放入一个方法中：

```
using System;
using System.Collections.Generic;

class BasicIntSet
{
    static void Main()
    {
        HashSet<int> intTest = new HashSet<int> {1, 2, 3, 4, 5, 6, 7, 8, 9, 10};

        Console.WriteLine(intTest.Contains(4)); // True
        Console.WriteLine(intTest.Contains(11)); // False
        Console.WriteLine(intTest.IsSupersetOf(new[] { 4, 6, 7 })); // True
    }
} 
```

请注意，您的原始错误与根本无关`HashSet<T>`。这是我能想到的最简单的例子：

```
class BadFieldInitializers
{
    int x = 10;
    int y = x;
} 
```

这给出了同样的错误 - 因为同样，一个字段初始化器（for ）隐式`y`引用。`this`

# javascript - 如何从 Rails 向 Fuel UX 数据网格提供数据？

> ID：14883844
> 
> 赞同：3
> 
> 时间：2013-02-14T20:52:31.843
> 
> 标签：javascript, ruby-on-rails, fuelux

我想使用 Fuel UX 数据网格来显示我从数据库中检索的一些数据。该页面由 ruby​​ on rails 服务器提供。

用于构建数据对象的 javascript 示例代码：

```
 var dataSource = new StaticDataSource({
            columns: [{
                property: 'toponymName',
                label: 'Name',
                sortable: true
            }, {
                property: 'countrycode',
                label: 'Country',
                sortable: true
            }, {
                property: 'population',
                label: 'Population',
                sortable: true
            }, {
                property: 'fcodeName',
                label: 'Type',
                sortable: true
            }],
            data: sampleData.geonames,
            delay: 250
        });

        $('#MyGrid').datagrid({
            dataSource: dataSource,
            stretchHeight: true
        });

        $('#datagrid-reload').on('click', function () {
            $('#MyGrid').datagrid('reload');
        }); 
```

如果我理解代码，我将在 dataSource 变量内的列对象中定义我的列和一些属性，并且数据对象由 sampleData.geonames 加载。

样本数据[在这里](https://raw.github.com/ExactTarget/fuelux/2.0.0/sample/data.js)

我可以使用 rails 约定替换 sampleData.geonames 做什么？我尝试调整这几种方法来将 rails 对象加载到这里。

例如，我修改了列的属性字段以对应于我的用户模型的一些属性。我尝试更换

```
data: sampleData.geonames, 
```

至

```
data: <%= @users.to_json %>, 
```

我对 gems 和版本有点限制，目前使用的是 Rails 2.3。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T21:14:04.787

如果您希望数据网格发出后台 AJAX 请求以从您的应用程序加载数据，请参阅本教程，这将更接近您的需要：

[http://dailyjs.com/2012/10/29/fuel-ux](http://dailyjs.com/2012/10/29/fuel-ux)

这样做的好处是立即加载页面，然后异步加载数据。

如果您宁愿坚持使用 StaticDataSource 方法，只需在您的页面上嵌入一个类似于以下内容的小脚本：

```
<script>
  var myData = { ... };
</script> 
```

然后，加载它：

```
var dataSource = new StaticDataSource({
  columns: [ ... ],
  data: myData,
  delay: 250
}); 
```

# javascript - 每个块助手

> ID：14883848
> 
> 赞同：0
> 
> 时间：2013-02-14T20:52:48.427
> 
> 标签：javascript, javascript-framework, handlebars.js

我在使用 Handlerbars.js 的 each 块助手时遇到了麻烦

```
<html>
<head>
    <script>
    </script>

    <script id="entry-template" type="text/x-handlebars-template">
        <div class="entry">
            {{#each people}}
                <p>{{firstName}} &nbsp;{{lastName}}</p>
            {{/each}}
        </div>
    </script>

    <script src="lib/jquery-1.8.2.min.js"></script>
    <script src="lib/handlebars.js"></script>

    <script type='text/javascript'>
        $(document).ready(function(){
          var people = [
            {firstName: "Yehuda", lastName: "Katz"},
            {firstName: "Carl", lastName: "Lerche"},
            {firstName: "Alan", lastName: "Johnson"}
          ] 

          var source   = $("#entry-template").html();
            var template = Handlebars.compile(source);
            var html = template(people);
            $('#content').html(html);
        });
    </script>
</head>
<body>
    <div id="content">
    </div>

</body>
</html> 
```

如果我将模板更改为下面的代码，一切顺利：

```
<script id="entry-template" type="text/x-handlebars-template">
    <div class="entry">
        {{#.}}
            <p>{{firstName}} &nbsp;{{lastName}}</p>
        {{/.}}
    </div>
</script> 
```

如何使用 each 辅助块？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T21:18:29.667

您可以使用`.`or ：`this``{{#each}}`

```
<script id="entry-template" type="text/x-handlebars-template">
    <div class="entry">
        {{#each .}}
            <p>{{firstName}} &nbsp;{{lastName}}</p>
        {{/each}}
    </div>
</script> 
```

或者：

```
<script id="entry-template" type="text/x-handlebars-template">
    <div class="entry">
        {{#each this}}
            <p>{{firstName}} &nbsp;{{lastName}}</p>
        {{/each}}
    </div>
</script> 
```

演示：

*   `.`：http: [//jsfiddle.net/ambiguous/2Y4cF/](http://jsfiddle.net/ambiguous/2Y4cF/)
*   `this`: [http://jsfiddle.net/ambiguous/8Pe2Z/](http://jsfiddle.net/ambiguous/8Pe2Z/)（感谢[Ben](https://stackoverflow.com/users/348314/ben)的提醒）

问题`{{#each people}}`在于模板不知道您为 JavaScript 对象使用的名称。如果您想使用`{{#each people}}`，则必须添加另一层：

```
var html = template({ people: people }); 
```

演示：http: [//jsfiddle.net/ambiguous/3tKET/](http://jsfiddle.net/ambiguous/3tKET/)

# c# - 使用 Task.Factory 时捕获错误

> ID：14883850
> 
> 赞同：21
> 
> 时间：2013-02-14T20:52:51.043
> 
> 标签：c#, .net, multithreading

我正在使用以下

```
Task.Factory.StartNew(() => DoPrintConfigPage(serial)); 
```

然后我调用的函数看起来像这样

```
private void DoPrintConfigPage(string serial) 
{ 
    //do printing work 
} 
```

我的问题是在线程内抛出异常并且没有被处理。

我已经尝试将它包装在 try catch

```
try
{
    Task.Factory.StartNew(() => DoPrintConfigPage(serial));
}
catch (Exception ex) { } 
```

但它仍然没有捕捉到错误，从而导致应用程序崩溃。

如何在主线程中捕获异常以便处理它们？

## 更新

我已经进行了下面建议的更改，但仍然说异常未处理

```
var task =  Task.Factory.StartNew(() => DoPrintConfigPage(serial))
                               .ContinueWith(tsk =>
                               {
                                  MessageBox.Show("something broke");
                               },TaskContinuationOptions.OnlyOnFaulted); 
```

然后在我的`DoConfigPage`我添加了另一个尝试捕获。

在这个捕获中，现在它正在崩溃并说抛出的异常未处理，我错过了什么？

```
private void DoPrintConfigPage(string serial)
{
    try
    {
        //call the print function
    }
    catch (Exception ex)
    {
        throw ex;   //it is crashing here and saying it is unhandled
    }
} 
```

我还尝试了 Eric J. 的建议，结果相同

```
var task = Task.Factory.StartNew(() => DoPrintConfigPage(serial));

try
{
    task.Wait();                  
}
catch (AggregateException ex) { MessageBox.Show("something broke"); } 
```

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2013-02-14T21:01:55.447

或者，您可以链接您的任务创建并添加 ContinueWith：

```
var job = Task.Factory
    .StartNew(...)
    .ContinueWith(tsk => 
         {
              // check tsk for exception and handle
         }); 
```

编辑：这个片段在运行时会为我弹出消息框：

```
void Main()
{
    var serial = "some serial";
    var task =  Task.Factory
        .StartNew(() => DoPrintConfigPage(serial))
        .ContinueWith(tsk =>
        {
            MessageBox.Show("something broke");
            var flattened = tsk.Exception.Flatten();

            // NOTE: Don't actually handle exceptions this way, m'kay?
            flattened.Handle(ex => { MessageBox.Show("Error:" + ex.Message); return true;});
        },TaskContinuationOptions.OnlyOnFaulted);

}

public void DoPrintConfigPage(string serial)
{
    throw new Exception("BOOM!");
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-02-14T20:56:04.067

在您开始新任务后，您的`try`块会立即退出，因为该方法会继续运行。

相反，您可以在等待任务（或多个任务）完成时将异常捕获为[AggregateException ：](http://msdn.microsoft.com/en-us/library/system.aggregateexception.aspx)

```
var task1 = Task.Factory.StartNew(() =>
{
    throw new MyCustomException("I'm bad, but not too bad!");
});

try
{
    task1.Wait();
}
catch (AggregateException ae)
{
    // Assume we know what's going on with this particular exception. 
    // Rethrow anything else. AggregateException.Handle provides 
    // another way to express this. See later example. 
    foreach (var e in ae.InnerExceptions)
    {
        if (e is MyCustomException)
        {
            Console.WriteLine(e.Message);
        }
        else
        {
            throw;
        }
    }

} 
```

[http://msdn.microsoft.com/en-us/library/dd997415.aspx](http://msdn.microsoft.com/en-us/library/dd997415.aspx)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-08-27T16:31:24.503

如果您不等待您的任务，我认为在[Task.Exception](https://msdn.microsoft.com/en-us/library/system.threading.tasks.task.exception(v=vs.110).aspx)中可以找到最简单的解决方案：

> 获取导致 Task 过早结束的 AggregateException。如果 Task 成功完成或尚未抛出任何异常，则返回 null。

我正在使用这样的东西：

```
Task.Factory.StartNew(() => DoStuffHere())
    .ContinueWith(task =>
    {
        if (task.Exception != null)
            Log("log all the exceptions!");
    }); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-02-14T21:01:25.237

您还应该了解 [System.Threading.Tasks.TaskScheduler.UnobservedTaskException](https://msdn.microsoft.com/en-us/library/system.threading.tasks.taskscheduler.unobservedtaskexception(v=vs.110).aspx)。

如果您从事创建“即发即弃”`Task`实例的业务，您将希望在程序开始时订阅该事件。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-03-30T10:50:26.060

也许您正在尝试捕获[Corrupted State Exception](https://msdn.microsoft.com/en-us/magazine/dd419661.aspx)。由于 .NET 4 应用程序默认无法捕获此类异常。您可以尝试将`legacyCorruptedState­­ExceptionsPolicy=true`条目添加到您的配置文件中，如上面链接的 MSDN 文章中所述。

# python - ctypes 从 c 函数返回一个字符串

> ID：14883853
> 
> 赞同：16
> 
> 时间：2013-02-14T20:53:03.423
> 
> 标签：python, c, ctypes, language-binding

我是一名 Python 资深人士，但对 C 的涉猎不多。在互联网上半天没有找到任何适合我的东西后，我想我会在这里提问并获得我需要的帮助。

我想做的是编写一个简单的 C 函数，它接受一个字符串并返回一个不同的字符串。我打算用几种语言（Java、Obj-C、Python 等）绑定这个函数，所以我认为它必须是纯 C？

这是我到目前为止所拥有的。请注意，尝试在 Python 中检索值时出现段错误。

### 你好ç

```
#include <stdlib.h>
#include <stdio.h>
#include <string.h>

const char* hello(char* name) {
    static char greeting[100] = "Hello, ";
    strcat(greeting, name);
    strcat(greeting, "!\n");
    printf("%s\n", greeting);
    return greeting;
} 
```

### 主文件

```
import ctypes
hello = ctypes.cdll.LoadLibrary('./hello.so')
name = "Frank"
c_name = ctypes.c_char_p(name)
foo = hello.hello(c_name)
print c_name.value # this comes back fine
print ctypes.c_char_p(foo).value # segfault 
```

我读到段错误是由 C 释放最初为返回的字符串分配的内存引起的。也许我只是在叫错树？

什么是完成我想要的正确方法？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-02-14T21:08:02.527

您的问题是在堆栈上分配了问候语，但是当函数返回时堆栈被破坏了。您可以动态分配内存：

```
#include <stdlib.h>
#include <stdio.h>
#include <string.h>

const char* hello(char* name) {
    char* greeting = malloc(100);
    snprintf("Hello, %s!\n", 100, name)
    printf("%s\n", greeting);
    return greeting;
} 
```

但这只是战斗的一部分，因为现在您有内存泄漏。你可以用另一个 ctypes 调用 free() 来插入它。

...或者更好的方法是阅读与 python 的官方 C 绑定（http://docs.python.org/2/c-api/ 上的 python 2.x 和[http://docs.python.org/2/c-api/](http://docs.python.org/2/c-api/)[上](http://docs.python.org/3/c-api/)的 python 3.x [/docs.python.org/3/c-api/](http://docs.python.org/3/c-api/)）。让您的 C 函数创建一个 python 字符串对象并将其交还。它将由python自动收集垃圾。由于您正在编写 C 端，因此您不必玩 ctypes 游戏。

...编辑..

我没有编译和测试，但我认为这个 .py 会起作用：

```
import ctypes

# define the interface
hello = ctypes.cdll.LoadLibrary('./hello.so')
# find lib on linux or windows
libc = ctypes.CDLL(ctypes.util.find_library('c'))
# declare the functions we use
hello.hello.argtypes = (ctypes.c_char_p,)
hello.hello.restype = ctypes.c_char_p
libc.free.argtypes = (ctypes.c_void_p,)

# wrap hello to make sure the free is done
def hello(name):
    _result = hello.hello(name)
    result = _result.value
    libc.free(_result)
    return result

# do the deed
print hello("Frank") 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-14T20:58:15.893

在 hello.c 中，您返回一个本地数组。您必须返回一个指向数组的指针，该数组必须使用 malloc 动态分配。

```
char* hello(char* name)
{ 
    char hello[] = "Hello ";
    char excla[] = "!\n";
    char *greeting = malloc ( sizeof(char) * ( strlen(name) + strlen(hello) + strlen(excla) + 1 ) );
    if( greeting == NULL) exit(1);
    strcpy( greeting , hello);
    strcat(greeting, name);
    strcat(greeting, excla);
    return greeting;
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-05-13T17:40:56.620

我今天遇到了同样的问题，发现您必须`int`通过设置方法来覆盖默认返回类型（）`restype`。请参阅[此处](https://docs.python.org/3/library/ctypes.html#return-types)的 ctype 文档中的*返回类型*。

```
import ctypes
hello = ctypes.cdll.LoadLibrary('./hello.so')
name = "Frank"
c_name = ctypes.c_char_p(name)
hello.hello.restype = ctypes.c_char_p # override the default return type (int)
foo = hello.hello(c_name)
print c_name.value
print ctypes.c_char_p(foo).value 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-14T21:00:44.340

这就是发生的事情。以及为什么它会破裂。当调用 hello() 时，C 堆栈指针向上移动，为函数所需的任何内存腾出空间。除了一些函数调用开销外，您所有的函数本地变量都在那里管理。以便`static char greeting[100]`, 表示增加的堆栈的 100 字节用于该字符串。您可以使用一些操作该内存的函数。在您将一个指针放在堆栈上，指向问候语内存。然后你从调用中返回，此时堆栈指针被收回到调用之前的原始位置。因此，在您调用期间位于堆栈上的那 100 个字节，随着堆栈的进一步操作，基本上可以再次获取。包括指向该值并且您返回的地址字段。到那时，谁知道它会发生什么，但它可能设置为零或其他值。当您尝试访问它时，就好像它仍然是可用内存一样，您会遇到段错误。

为了解决问题，您需要以不同的方式管理该内存。你可以让你的函数`alloc`吃掉堆上的内存，但你需要确保它`free()`在以后通过你的绑定得到'ed。或者，您可以编写您的函数，以便绑定语言传递给它一个要使用的内存。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2020-01-03T03:40:09.000

我也遇到了同样的问题，但使用了不同的方法。我想在与某个值匹配的字符串列表中找到一个字符串。

基本上，我用列表中最长字符串的大小初始化了一个 char 数组。然后将其作为参数传递给我的函数以保存相应的值。

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

void find_gline(char **ganal_lines, /*line array*/
                size_t size,        /*array size*/
                char *idnb,         /* id number for check */
                char *resline) {
  /*Iterates over lines and finds the one that contains idnb
    then affects the result to the resline*/
  for (size_t i = 0; i < size; i++) {
    char *line = ganal_lines[i];
    if (strstr(line, idnb) != NULL) {
      size_t llen = strlen(line);
      for (size_t k = 0; k < llen; k++) {
        resline[k] = line[k];
      }
      return;
    }
  }
  return;
} 
```

这个函数被相应的python函数包装：

```
 def find_gline_wrap(lines: list, arg: str, cdll):
    ""
    # set arg types
    mlen = maxlen(lines) # gives the length of the longest string in string list
    linelen = len(lines)
    line_array = ctypes.c_char_p * linelen

    cdll.find_gline.argtypes = [
        line_array,
        ctypes.c_size_t,
        ctypes.c_char_p,
        ctypes.c_char_p,
    ]
    #
    argbyte = bytes(arg, "utf-8")

    resbyte = bytes("", "utf-8")

    ganal_lines = line_array(*lines)
    size = ctypes.c_size_t(linelen)
    idnb = ctypes.c_char_p(argbyte)
    resline = ctypes.c_char_p(resbyte * mlen)
    pdb.set_trace()
    result = cdll.find_gline(ganal_lines, size, idnb, resline)
    # getting rid of null char at the end
    result = resline.value[:-1].decode("utf-8")
    return result 
```

# layout - 在 OpenCart 中未使用 SEO 友好 URL 的自定义信息页面

> ID：14883858
> 
> 赞同：1
> 
> 时间：2013-02-14T20:53:26.450
> 
> 标签：layout, opencart

我在使用 opencart 布局覆盖功能时遇到问题。我创建了一个新的信息页面，并将布局覆盖设置为“ `test`”。此布局的路线是`"information/test"`. 控制器和模板都在正确的位置。我为新页面提供了 .seo 友好的 url `"test-page"`。

我的问题是，如果我输入`"domain.com/test-page"`它会到达那里，但它使用常规信息布局而不是我自定义的测试布局。我可以输入`domain.com/index.php?route=information/test&information_id=119`，它现在将显示具有正确布局的页面。

有没有办法让它进入自定义布局页面（`domain.com/index.php?route=information/test&information_id=119)`当我输入我在创建新信息页面时创建的 seo-frindly URL 时。

我的问题是我试图在一个信息页面上添加一个轮播，同时仍然使用对 seo 友好的 URL。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T05:58:31.873

实际上，您在模板文件`test.tpl`中编码的**不是布局**，它实际上是使用`test.php`控制器访问的页面，并且可以通过访问 url 打开该页面，`domain.com/index.php?route=information/test&information_id=119`如您已经提到的。

**那么如何创建布局呢？**

您已经创建了名为 go to 的布局，现在转到模块`test`和一个模块来测试布局，例如 content-top ，将您的测试页面布局覆盖设置为 test ，现在转到，您将在顶部看到轮播，这是布局如何工作。您之前所做的是通过复制信息控制器和模板来创建一个新页面。`System >> Design >> Layouts``carousel``domain.com/test-page`

关于 opencart 论坛的类似讨论[Here](http://forum.opencart.com/viewtopic.php?t=92308&p=371565)

# .net - 实体数据模型设计器不会打开 edmx 文件

> ID：14883861
> 
> 赞同：27
> 
> 时间：2013-02-14T20:53:36.973
> 
> 标签：.net, ado.net, mapping, entity-framework-5, edmx

奇怪的是，几天前它运行良好。我向表中添加了一个新列，并打算通过设计器更新模型，现在它显示“实体数据模型设计器无法显示您请求的文件。您可以使用 XML 编辑器编辑模型。”

新字段没有什么特别值得注意的，它只是 SQL Server 2008 中的一个不可为空的位字段。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2018-05-30T05:36:42.590

**适用于 Visual Studio 2017、2019**

我搜索了解决方案，但想出了一些 NUGET 包和扩展的安装，但没有任何结果。

**解决方案**（Visual Studio 上缺少实体框架）

1.  我在我的机器上搜索了**Visual Studio Installer**并打开了它。
2.  在**Visual Studio Professional 2017**下。
3.  我单击**更多** 以查看更多选项。我选择了**修改**
4.  选择**单个组件**（第二个选项卡）
5.  **检查SDK、库和框架**下的实体框架
***   然后单击修改 EDMX 文件将在该过程完成后打开。**

 *** * *

## 回答 #2

> 赞同：13
> 
> 时间：2015-08-26T19:59:25.590

这在我身上发生过几次，通常是在从颠覆中提取解决方案时。重建项目一直为我解决了这个问题。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2017-10-20T16:31:06.647

我也遇到了那个烦人的屏幕。不，我不想用 XML 编辑我的模型……我想要漂亮的设计师！就我而言，我添加了一个没有主键的表。修理...

1.  在 XML 中打开 edmx

2.  删除错误的表。应该用“<-- ERROR”注释很好地定义它。

3.  清洁和重建。

4.  关闭并重新打开 Visual Studio（是的，这很烦人但很有必要）

5.  再重建一次，然后打开您的 edmx 文件。应该打开设计师罚款。

希望这可以帮助。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2013-02-14T22:01:28.977

通过删除文件并重新生成它来修复。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2019-07-31T16:24:47.460

这种情况经常发生在我们身上（通常来自错误的合并），并且我们的 EDMX 文件超过 50k 行，这使得目测问题变得不可能。但是，首先，您可以使用其中一个在线 XML 解析器（例如[https://onlinexmltools.com/validate-xml](https://onlinexmltools.com/validate-xml)）来确定 XML 是否正确。一旦 XML 有效，文件至少应该在 XML 编辑器中打开（我假设您使用的是 Visual Studio）：然后您可以使用 Alt+PageDn（编辑 > 转到 > 下一个问题） - 摆动的下划线和相关提示通常是真正的帮助。通过这种方式，我已经成功地多次复活了我们的 EDMX。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2019-08-09T15:14:45.987

在 Visual Studio 2019 中，我可以通过使用内置 XML 编辑器打开 .edmx 文件来解决问题。

Visual Studio 显示带有下划线的错误，如下所示：

[![在此处输入图像描述](../Images/f1b655abb380bdcd24dbfd99d4be10c6.png)](https://i.stack.imgur.com/xX2af.png)

检查错误列表窗口（红色 X 图标）...

一旦消除了所有错误，设计器就会按预期显示。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-09-19T07:05:19.490

当我将一个字段添加到在函数中用作 RETURN (SELECT TableName.* .... ) 的表中时，这发生在我身上

未刷新 EDMX 中该函数的 ReturnType 节点的 CollectionSet 子节点。

要修复它，您只需运行 ALTER FUNCTION（无需实际更改它），然后从 Visual Studio 中的数据库更新模型。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-05-18T20:45:42.597

有时会发生此问题，因为模型的 XML 表示存在一些冲突。在我的例子中，错误是因为模型有一个冲突的引用，换句话说，有一个对在 XML 中手动删除的表的引用并且删除没有正确完成（他们离开了 EntityType 引用但被删除了其他的）。

我刚刚打开 XML 文件，问题被下划线了，我刚刚删除它，它解决了问题，模型显示没有任何问题。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-01-25T11:46:52.740

只是有一个类似的问题：设计器窗口中没有任何内容。

双击模型浏览器中的每个实体使它们重新出现。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2017-02-10T01:52:15.503

我没有删除 edmx 的选项。

我尝试清理，退出 vs，然后构建。

解决方案：将源代码管理中的粘贴复制到 .edmx 和 .edmx.diagram 中，然后重新构建。

*我从一个特别讨厌的合并中得到了这个错误。*

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2018-02-21T12:21:21.337

我通过修改安装和选择 .net 桌面开发模块 + 单个组件解决了这个问题：Entity Framework 6 工具和 .NET Framework 3.5 开发工具。

我不知道 less 是否可以做到这一点。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2018-06-07T08:56:01.750

合并后我也遇到了同样的问题。幸运的是，在签入窗口中撤消对 edmx 和相关文件的更改并重新添加新文件为我解决了这个问题。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-04-20T03:05:08.007

当我们将 Visual Studio 解决方案从旧版本迁移到 VS 2017/2019 时，可能会出现这种情况。因此，我通过执行以下步骤解决了它（更改以粗体突出显示）：

1.  改变：

```
<edmx:Edmx Version="2.0" xmlns:edmx="http://schemas.microsoft.com/ado/2008/10/edmx"> 
```

到

```
<edmx:Edmx Version="3.0" xmlns:edmx="http://schemas.microsoft.com/ado/2009/11/edmx"> 
```

2.  变化（所有发生）：

```
<Schema Namespace="MyModelName" Alias="Self" xmlns="http://schemas.microsoft.com/ado/2008/09/edm"> 
```

到

```
<Schema Namespace="MyModelName" Alias="Self" xmlns="http://schemas.microsoft.com/ado/2009/11/edm"> 
```

完成后，关闭并再次打开 edmx。

这应该可以解决问题。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-09-23T04:38:58.600

我刚刚通过重新安装 Oracle Developer Tools for Visual Studio（我当前的版本是 2019 16.7.4）解决了我的“实体数据模型设计器不会打开 edmx 文件”问题。我在 Visual Studio 的解决方案资源管理器窗口中右键单击 .edmx 文件，选择“打开方式...”选项，然后立即出现重新安装弹出窗口。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-03-03T08:57:36.537

在我的情况下 edmx.diagram 文件在文件末尾有不相关的文本，例如

```
<AssociationConnector Association="MyModel.FK_SomeTable_SomeOtherTable" />&gt;&gt;&gt;&gt;&gt;&gt;&gt; FEATURE/Blahlblah 
```

删除后

```
&gt;&gt;&gt;&gt;&gt;&gt;&gt; FEATURE/Blahlblah 
```

得到它的工作。

编辑您的 xml 文件（edmx，尤其是 edmx.diagram）检查并更正它们

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2021-11-02T00:51:02.860

修复它的最快捷方法是从旧文件中复制整个“模型”文件夹，然后删除（或重命名）模型文件夹的当前内容。

然后打开您的 edmx 并使用“从数据库更新”选项刷新内容。

我用其他方法花了将近 5 个小时，但仍然无法正常工作。使用这种复制粘贴方法只花了 15 分钟，问题就解决了。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2021-11-05T18:50:37.413

我有同样的问题，因为这是一个新安装。

使用 Visual Studio 安装程序，找到突出显示的选项并安装它

[![在此处输入图像描述](../Images/7dafa6913421e79e9bc922f973c77b4b.png)](https://i.stack.imgur.com/w1DX5.png)

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2022-01-21T15:51:07.570

如果您在尝试从两个实体中删除一对多关系时遇到此问题：

*   在 XML 编辑器中打开 edmx（右键单击文件并选择打开方式...）
*   查找`Association`具有表示关系的外键名称的元素并将其删除
*   查找`AssociationSet`具有表示关系的外键名称的元素并将其删除
*   检查`EntityType`关系两边的元素并确保`NavigationProperty`删除相关元素
*   转到`EntityType`关系的多方面的元素。删除`Property`在其上建立外键的 Id 元素

保存文件并在实体数据模型设计器中重新打开它**

# javascript - 禁用 URL 中的 JS 照片库 ID 信息

> ID：14883862
> 
> 赞同：0
> 
> 时间：2013-02-14T20:53:40.173
> 
> 标签：javascript, wordpress

我正在使用在工作中为 Wordpress 网站设置的计时器上设置的 javascript 照片库，并且每次加载新照片时，都会在 URL 中更新更改。我想禁用它。例如，页面会每 5 秒加载一次并使用图库更新 URL。

```
www.example.com/gallery/#image-1

www.example.com/gallery/#image-2

www.example.com/gallery/#image-3 
```

我知道这不会和老板一起飞。特别是如果我们要在家里放一个。我正在使用的照片库是基于此[http://coffeescripter.com/code/ad-gallery/](http://coffeescripter.com/code/ad-gallery/)的插件，而我正在使用的插件是此[http://wordpress .org/extend/plugins/wp-ad-gallery/](http://wordpress.org/extend/plugins/wp-ad-gallery/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T20:58:35.813

您是否尝试`update_window_hash: false`在画廊初始化时设置选项参数？

[http://adgallery.codeplex.com/documentation](http://adgallery.codeplex.com/documentation)

从屏幕截图中似乎有一个设置为 wordpress 中的下拉列表，称为“Windows 哈希” [http://wordpress.org/extend/plugins/wp-ad-gallery/screenshots/](http://wordpress.org/extend/plugins/wp-ad-gallery/screenshots/)

# html - 为什么 Chrome 和 Opera 会忽略我的字母间距：0.03em;？

> ID：14883865
> 
> 赞同：0
> 
> 时间：2013-02-14T20:53:51.840
> 
> 标签：html, css, google-chrome, browser, letter-spacing

所以知道为什么 Chrome (17.0.963.79) & Opera (12.12) 会忽略我的“字母间距：0.03em;” 正文？在 Mozilla 和 IE 中它可以工作。

```
<!DOCTYPE html>

<html>

<head>

    <meta charset="utf-8" />
    <title>test page</title>
    <style>
        html, body {
            margin: 0;
            padding: 0;
            font: normal 100%/1.375  Georgia, serif;
        }
        html { background-color: #333; }
        body { 
            margin: auto; 
            max-width: 75em;
            padding-top: 1.375em;
            background-color: #fff;  
            }
        h1 {
            font-weight: normal;
            word-spacing: -0.05em;
            letter-spacing: 0.03em;
            text-transform: uppercase;
            }
    </style>
</head>

<body>

    <h1>Hello World</h1>

</body>

</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T00:10:30.827

我在具有 1680×1050 屏幕的 Chrome（版本 24.0.1312.57 m）上尝试了您的代码。当我在你的`letter-spacing: 0.03em;`和`letter-spacing: 0.0em;`默认大小之间切换时，它看起来相同，但是当我放大一个级别（CTRL +）时，0.03em 文本呈现出比 0.0em 文本更宽。

所以，我看到你的问题有几个可能的答案：

*   在默认缩放级别 (CTRL 0) 下，0.03em 字母间距不足以显示任何差异，但缩放级别 +1 (CTRL +) 确实显示了差异。
*   也许您的低级 Chrome (17.0.963.79) 无法处理子像素`letter-spacing: [tiny]em;`，而 Chrome (24.0.1312.57 m) 处理它。
*   也许您的屏幕分辨率不够大，无法显示差异。

# wordpress - 在 wordpress 中包含 php 文件

> ID：14883868
> 
> 赞同：0
> 
> 时间：2013-02-14T20:54:15.393
> 
> 标签：wordpress, wordpress-theming

我有一个插件，可以制作自定义内容类型并使该自定义内容类型能够显示其自己的存档页面。也就是说，此自定义内容类型将显示为 archive-customtype.php 而不是 archive.php。

然而，我不想要这个。我希望存档内容以相同的方式显示，无论是帖子还是新内容类型。

我不能只删除archive-customtype.php，因为插件希望它在那里。我可以从该文件中删除所有内容并简单地说：

```
 <?php include("archive.php"); ?> 
```

这行得通，但我想确保这是最好的 wordpress 方法。有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T21:43:33.997

我会使用[`locate_template`](http://codex.wordpress.org/Function_Reference/locate_template)or[`get_template_part`](http://codex.wordpress.org/Function_Reference/get_template_part)而不是`include`. 您应该能够做到`get_template_part( 'archive' );`——请注意，没有文件类型结尾。

它让我担心，如果你只是删除它不起作用`archive-customtype.php`。正如你所意识到的，`archive.php`应该只是工作。它应该是后备模板。插件需要这个文件很奇怪，让我担心有些东西会坏，或者坏了而你没有注意到。

# php - W3 验证帖子。＆ 问题。

> ID：14883876
> 
> 赞同：0
> 
> 时间：2013-02-14T20:54:40.187
> 
> 标签：php, post

我正在尝试 w3 验证我的代码并使用 POST 遇到我的 url 值问题。明显的问题是 & 但我无法替换它并且代码仍然有效。

这是有效的

```
 var string = 'delete_id='+ delete_id+"&owner_id="+owner_id; 
```

这是我认为可行的。

```
 var string = 'delete_id='+ delete_id+"&amp;owner_id="+owner_id; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:58:10.333

如果该代码出现在`<script>`HTML 文档的元素中，那么第一个示例应该可以工作。

如果文档是 XHTML 文档，那么第二个版本应该可以工作，但前提是文档以`application/xhtml+xml`.

如果您正在编写 XHTML，但告诉浏览器它是 HTML，那么您的选择是：

*   改用 HTML（推荐）
*   使用 XHTML 内容类型
*   使用外部 JS 文件
*   使用 CDATA 标记

如需进一步阅读，请参阅[XHTML 的 HTML 兼容性指南](http://www.w3.org/TR/xhtml-media-types/#C_4)。

# git - 如何删除 git 僵尸分支？

> ID：14883884
> 
> 赞同：1
> 
> 时间：2013-02-14T20:55:04.413
> 
> 标签：git, branch

几周前，我将一个 Subversion 存储库转换为 Git。我留下了一堆我不再需要但无法删除的分支。更糟糕的是，在试图摆脱 svn/whatever 分支的过程中，我现在发现自己的分支“原点”重复。这是我的分支列表的片段：

```
% git branch -a | egrep 'svn/partial|master'
* master
  origin/master
  origin/origin/master
  svn/partial
  remotes/origin/master
  remotes/origin/origin/master
  remotes/svn/partial 
```

我似乎能够删除 svn/partial 分支，但不能删除 remotes/svn/partial 分支：

```
% git branch -D svn/partial
Deleted branch svn/partial (was 373a64c).
% git branch -D remotes/svn/partial
error: branch 'remotes/svn/partial' not found. 
```

如果我 git-fetch，svn/partial 被重新创建，我得到另一层“origin/”分支：

```
% git push
Everything up-to-date
% git fetch
From .
...
 * [new branch]      origin/origin/origin/master -> origin/origin/origin/master
...
 * [new branch]      svn/partial -> svn/partial 
```

哎呀！它们像 tribbles 一样繁殖：

```
% git br -a | egrep 'svn/partial|master'
* master
  origin/master
  origin/origin/master
  origin/origin/origin/master
  svn/partial
  remotes/origin/master
  remotes/origin/origin/master
  remotes/origin/origin/origin/master
  remotes/svn/partial 
```

我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T20:57:48.680

`git branch -d <branch>`删除本地分支。远程分支不在您的本地仓库中，因此您无法从本地仓库中删除它。

要从远程仓库中删除它，有一些等效的命令，规范的命令是：

```
git push origin :svn/partial 
```

这表示不向远程分支推送任何内容（即不存在的分支）`svn/partial`，这将导致远程分支变得不存在......这是 Git 的说法删除它:)

最新版本的 Git 支持更友好的语法：

```
git push origin --delete svn/partial 
```

# powershell - 将文本文件中的多行合并/合并为一行（Powershell）

> ID：14883888
> 
> 赞同：2
> 
> 时间：2013-02-14T20:55:30.143
> 
> 标签：powershell

我有一个包含以下内容的文本文件：

```
blah, blah, blah ...

Text : {string1, string2, string3,
        string4, string5, string6,}

blah, blah, blah ...

Text : {string7, string8, string9,
        string10, string11, string12,} 
```

我想只将大括号之间的行合并为一行，如下所示：

```
blah, blah, blah ...

Text : {string1, string2, string3, string4, string5, string6,}

blah, blah, blah ...

Text : {string7, string8, string9, string10, string11, string12,} 
```

但是，我不想将更改应用于整个文本文件，因为它包含其他内容。我只想编辑大括号 { ... } 之间的文本。我搞砸了，`-join`但无法让它工作。我有以下脚本可以打开文件、进行更改并输出到另一个文件中：

```
gc input.txt | 

# Here I have several editing commands, like find/replace.
# It would be great if I could add the new change here.

sc output.txt 
```

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T21:58:47.970

试试这个：

```
$text = (Get-Content .\input.txt) -join "`r`n"
($text | Select-String '(?s)(?<=Text : \{)(.+?)(?=\})' -AllMatches).Matches | % {
        $text = $text.Replace($_.Value, ($_.Value -split "`r`n" | % { $_.Trim() }) -join " ")
}
$text | Set-Content output.txt 
```

它修剪掉每行开头和结尾的多余空格，并用空格连接所有行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T07:39:31.223

罐装大虾：

```
$testdata = @'
blah, blah, blah ...

Text : {string1, string2, string3,
        string4, string5, string6,}

blah, blah, blah ...

Text : {string7, string8, string9,
        string10, string11, string12,}
'@

$testfile = 'c:\testfiles\testfile.txt'
$testdata | sc $testfile
$text = [IO.File]::ReadAllText($testfile)

$regex = @'
(?ms)(Text\s*:\s\{[^}]+)\s*
\s*([^}]+)\s*
'@

$text -replace $regex,'$1 $2' 
```

等等等等等等 ...

文本：{string1，string2，string3，string4，string5，string6，}

等等等等等等 ...

文本：{string7，string8，string9，string10，string11，string12，}

# cocoa-touch - 隐藏IOS键盘

> ID：14883890
> 
> 赞同：0
> 
> 时间：2013-02-14T20:55:33.077
> 
> 标签：cocoa-touch

在我的应用程序中，用户可以编辑一些 UItextViews，按下按钮他可以隐藏键盘。我使用这段代码：

```
[self.view endEditing:YES]; 
```

我在两个不同的 UIViewcotnrollers 中使用此代码。在一个代码中，该代码有效，并隐藏了键盘，而在另一个代码中则无效。有什么理由吗？我错过了像代表这样的东西吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T20:58:53.890

你应该使用：`[textView resignFirstResponder];`

# mysql - 在存储过程中处理多个嵌套游标

> ID：14883891
> 
> 赞同：2
> 
> 时间：2013-02-14T20:55:40.060
> 
> 标签：mysql, stored-procedures

如何在同一个例程中使用两个游标？创建过程时出现“游标或处理程序声明后的变量或条件声明”错误。我必须同时使用整数 outerDone 和 innerDone 来检查光标是否指向空值。我还没有研究过存储过程。有人可以解决这个问题吗？提前致谢！！

```
DELIMITER ##;
create procedure updateStopTimeColumn()
BEGIN
DECLARE outerDone INT DEFAULT 0;
DECLARE vehicle_record CURSOR FOR SELECT `vehicleId` FROM `vehicle`;
DECLARE current_record CURSOR FOR SELECT `id`,`tsTime`,`teTime` FROM `trip` where `vehicleId`=vehId order by `tsTime`;
DECLARE CONTINUE HANDLER FOR NOT FOUND SET outerDone = 1;
DECLARE vehId,tripId CHAR(250);
DECLARE currentTsTime,currentTeTime time;

OPEN vehicle_record;
REPEAT  
    FETCH vehicle_record INTO vehId;

block2 : BEGIN
    DECLARE innerDone INT DEFAULT 0;
    DECLARE tempTripId CHAR(250);
    DECLARE tempTsTime,tempTeTime time;
    DECLARE CONTINUE HANDLER FOR NOT FOUND SET innerDone = 1;

    OPEN current_record;

    FETCH current_record INTO tempTripId, tempTsTime,tempTeTime;

    REPEAT
        FETCH current_record INTO tripId,currentTsTime,currentTeTime;
        UPDATE trip set stopTime=(currentTeTime-tempTsTime) where id=tempTripId and tempTeTime IS NOT NULL;

        SET tempTripId=tempId;
        SET tempTsTime=currentTsTime;
        SET tempTeTime=currentTeTime;

    UNTIL innerDone END REPEAT;
END block2;
CLOSE current_record;
UNTIL outerDone END REPEAT;

CLOSE vehicle_record;
END; ##
DELIMITER; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-31T16:59:48.940

你试过移动

```
DECLARE vehId,tripId CHAR(250);
DECLARE currentTsTime,currentTeTime time; 
```

光标之前的语句？

# ruby-on-rails-3 - Rails3 ActiveRecord，2 级结果访问

> ID：14883893
> 
> 赞同：0
> 
> 时间：2013-02-14T20:55:50.217
> 
> 标签：ruby-on-rails-3, rails-activerecord

我有一些 AR 模型

```
User
 has_many :clients, :through => :users_to_clients
 has_many :files

Client
 has_many :users_to_clients
 has_many :users, :through => :users_to_clients
 has_many :files

File
 belongs_to :client
 belongs_to :user 
```

并尝试通过分配给用户的客户端获取所有文件

```
u = User.includes(:clients => :xls_files).find(1) 
```

此代码触发 3 个 sql 查询。在最终的 sql 看起来像我需要的，他通过用户的客户端检查所有文件。

```
SELECT "files".* FROM "files" WHERE "files"."client_id" IN (1, 2) 
```

但是如何获取这些数据，如果你的变量只包含用户对象？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T09:33:59.243

我没有找到任何解决方案，所以我通过在文件模型中添加范围来手动完成

```
scope :by_user_clients, lambda { |user| where(client_id:
user.clients.pluck(:id)) }

File.by_user_clients(@user) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T00:30:37.107

尝试这个

```
User
    has_many :files
    has_many :clients, :through => :files

Client
    has_many :files
    has_many :users, :through => :files

File
    belongs_to :users
    belongs_to :clients 
```

`@user.clients`然后你可以做类似的事情`@client.users`

我无法从您的帖子中看出，但您可能需要切换客户端和文件模型，因此客户端属于用户和文件，具体取决于您的情况。

# html - 图像上的图像（图像悬停）

> ID：14883895
> 
> 赞同：0
> 
> 时间：2013-02-14T20:55:52.923
> 
> 标签：html, css, image

HTML：

```
 <div class="image"><a href="$ENTRY_URL$" title="$TITLE$ online">
    <img class="avkas rad2" src="$IMG_URL1$" width="130px">
     <img src="/images/star.png" class="img"><div class="text2"> <b> $FILTER1_VALUE$</b>
     </div><div class="text"> <b> $OTHER1$</b>
     </div>
     </a></div> 
```

CSS

```
 .image {
 position:relative;
 float:left; /* optional */

}

 .image .img {
 position:absolute;
 top:-13px; /* in conjunction with left property, decides the text position */
 right:-12px;
 width:45px; /* optional, though better have one */}
 .image .text {
 position:absolute;
 top:0px;
 right:1px;
 color: #000; }  
 .image .text2 {
 position:absolute;
 top:3px;
 left:3px;
  color: white; 
   letter-spacing: -1px;  
   background: rgb(0, 0, 0); 
   background: rgba(0, 0, 0, 0.7);}  
.image  a {text-decoration:none;}
.image  a:hover {color:#FF00FF;} 
```

现在我想要这个图像： [http](http://new-hard.do.am/movie/images/lb-movie-short-poster-hover.png) : //new-hard.do.am/movie/images/lb-movie-short-poster-hover.png 当用户将鼠标悬停在我的主图像上时，它会像悬停一样..我不想..这张图片替换我的主图片只是出现在这张图片上：

```
<img class="avkas rad2" src="$IMG_URL1$" width="130px"> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T21:14:57.563

您需要制作另一个要悬停在此图像上的图像。然后

```
.image:link
{
background-image: "specify the path of the image";
}

.image:hover
{
background-image: "specify path of the image that you want to hover";
} 
```

# c++ - 为什么 std::uint32_t 与 uint32_t 不同？

> ID：14883896
> 
> 赞同：14
> 
> 时间：2013-02-14T20:55:56.250
> 
> 标签：c++, visual-studio-2012

我对 c++ 有点陌生，我已经完成了很多文件的编码任务，但我注意到 VS2012 似乎对以下语句有问题：

`typedef std::uint32_t identifier;`

但是，似乎将其更改为

`typedef uint32_t identifier;`

摆脱错误。没有包含，这是在头文件中。我注意到定义在 stdint.h 中。如果是这种情况，为什么这段代码在 VS 之外可以接受（即使用 g++ 正确编译）但在 VS 中是不可接受的？谁能解释一下？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-14T21:06:21.280

不同之处在于一个在命名空间内，另一个不在。否则它们应该是相同的。第一个应该是 C 版本，第二个应该是 C++ 版本。在 C++11 之前，强制包含前缀版本而不是 C 标准库版本将所有 C 定义引入标准命名空间内。在 C++11 中，此限制已被放宽，因为这并不总是可行的。

可能是您的编译器隐式定义了这种类型。在任何情况下，您都应该包括`cstdint`使命名空间中的版本`std`可用（并且可能是全局命名空间中的版本）。包括`stdint.h`应该只提供不合格的版本。

早期版本的 Visual Studio 没有这个头文件，所以这肯定很麻烦。

由于所有这些疯狂，大多数人将求助于第三方实施，例如`boost/cstdint.hpp`.

**编辑：**它们是相同的并且服务于相同的目的。通常：如果要使用`std`命名空间中的版本，请包含`cstdint`. 如果您想要全局命名空间中的一个，请包含`stdint.h`. 对于 C++，建议使用`std`命名空间中的那个。作为一项规则：始终包含您使用的内容，不要依赖其他标题，包括您的内容。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-02-14T21:19:09.710

`uint32_t`（也`::uint32_t`就是全局命名空间中的那个）在`<stdint.h>`. 该标头也*可能*在 namespace 中声明它`std`， as `std::uint32_t`，但这不是必需的。

`std::uint32_t`（即命名空间中的那个`std`）在`<cstdint>`. 该标头也*可能*在全局命名空间中声明它， as `::uint32_t`，但不是必须这样做。

> 如果是这种情况，为什么这段代码在 VS 之外可以接受（即使用 g++ 正确编译）但在 VS 中是不可接受的？谁能解释一下？

如果你想使用`std::uint32_t`那么你必须`#include <cstdint>`，否则代码可能无法编译。如果它确实使用 G++ 编译，那么可能会间接包含一些其他标头`<cstdint>`，但您不应该依赖它，请为您使用的名称包含正确的标头。

# ruby-on-rails - 未初始化的常量 Rails::Generators (NameError)

> ID：14883897
> 
> 赞同：10
> 
> 时间：2013-02-14T20:55:56.470
> 
> 标签：ruby-on-rails, scaffolding

我正在更新我编写的生成器的代码，但到目前为止一直运行良好。

当我简单地拒绝命令时

```
bundle exec rails g 
```

我收到以下错误

```
/Users/mpierc200/projects/prototype_conflux/vendor/gems/itrc_client_files_generator-1.0.13/lib/itrc_client_files_generator.rb:6:in `<top (required)>':
uninitialized constant Rails::Generators (NameError) 
```

违规行是

```
class ItrcClientFilesGenerator < Rails::Generators::Base 
```

我的 Rails 版本是

```
Rails 3.1.9 
```

红宝石版本是

```
ruby 1.9.3p194 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-14T21:45:35.693

看起来 Rails 生成器模块在 Rails 3 开发过程中的某个时候被拉出并且没有自动加载。这可能是有充分理由的。

您必须将它们包含在自定义生成器中：

```
require 'rails/generators'

class ItrcClientFilesGenerator < Rails::Generators::Base
  # Fancy generator code here
end 
```

# c# - 当缓存过期并通过 Visual Studio 在 IIS 上运行时，网站会被命中，但当它直接在 IIS 上运行时不会

> ID：14883900
> 
> 赞同：0
> 
> 时间：2013-02-14T20:56:00.627
> 
> 标签：c#, asp.net, caching, scheduled-tasks, global-asax

我在 Global.asax 中使用虚拟页面和缓存超时来运行计划任务，就像这里描述的一样：http: [//www.codeproject.com/Articles/12117/Simulate-a-Windows-Service-using- ASP-NET-to-run-sc](http://www.codeproject.com/Articles/12117/Simulate-a-Windows-Service-using-ASP-NET-to-run-sc)

*当我使用本地 IIS Web 服务器（而不是*IIS Express）通过 Visual Studio 运行它时，每两分钟就会点击一次虚拟页面。但是当我直接通过 IIS 运行它时，我的虚拟页面永远不会被击中。

知道为什么会这样吗？它是完全相同的代码，并且站点在 IIS 7.5 上的设置方式相同。

**编辑：** 我的虚拟页面 url 的格式与链接示例中的格式`http://10.1.0.3:8080/Dummy`相反，`http://localhost/Dummy.aspx`因为我使用的是 MVC/Razor ...如果有帮助的话。

# internet-explorer-8 - 如何仅在 IE8 中检索弹出窗口的实际窗口尺寸？（不是视口）

> ID：14883905
> 
> 赞同：2
> 
> 时间：2013-02-14T20:56:26.847
> 
> 标签：internet-explorer-8, popup, dimensions

我有一个脚本，每次都将弹出窗口定位在用户屏幕的右下角。然而，IE8 可能不太关心窗口比视口更多的事实。如何在 IE8 中获得它的大小？

```
var popUpWidth = window.outerWidth; // does not work in IE8!
var popUpHeight = window.outerHeight; // does not work in IE8! 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T17:16:46.177

IE8 没有 outerWidth / outerHeight 属性，请尝试：

```
 document.documentElement.clientHeight;
   document.documentElement.clientWidth; 
```

这是一个示例[http://james.padolsey.com/javascript/get-document-height-cross-browser/](http://james.padolsey.com/javascript/get-document-height-cross-browser/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-02T15:19:08.280

将窗口设置为给定大小。获取客户端窗口的大小。这会因窗口镀铬量而变小。使用差异来计算任何客户端大小的窗口大小。

初始大小是完全任意的，但当前客户端大小加上可选的软糖因子将导致屏幕上的变化最小。

# c# - 通过 OAuth 2 连接到 Google，请求访问令牌时出现“invalid_request”

> ID：14883913
> 
> 赞同：1
> 
> 时间：2013-02-14T20:56:54.413
> 
> 标签：c#, oauth-2.0, google-analytics-api

在 SE 上已经有几个问题，但我已经阅读了所有我能找到的似乎相关的内容，但我仍然不完全在那里。

我得到了一个身份验证码，所以现在我需要用它来交换一个访问令牌和一个刷新令牌。然而，谷歌返回奇妙的非特定错误“invalid_request”。这是我的代码：

```
private const string  BaseAccessTokenUrl = "https://accounts.google.com/o/oauth2/token";
private const string  ContentType        = "application/x-www-form-urlencoded";

public static string  GetRefreshToken(string clientId, string clientSecret, string authCode)
    {
    Dictionary<string, string>  parameters = new Dictionary<string, string>
        {
        { "code",          authCode },
        { "client_id",     clientId },
        { "client_secret", clientSecret },
        { "redirect_uri",  "http://localhost" },
        { "grant_type",    "authorization_code" }
        };
    string  rawJson = WebUtilities.Post(BaseAccessTokenUrl, parameters, ContentType);
    return rawJson;  // TODO: Parse out the actual refresh token
    } 
```

我的`Post()`方法 URL 编码参数键和值并将它们连接起来：

```
public static string  Post(string uri, Dictionary<string, string> properties, string contentType = "application/x-www-form-urlencoded")
    {
    string  content = String.Join("&", from kvp in properties select UrlEncode(kvp.Key) + "=" + UrlEncode(kvp.Value) );
    return Post(uri, content);
    } 
```

双参数`Post()`方法只是处理将内容转换为字节，添加内容长度等，然后返回响应的内容，即使它以`WebException`. 如果有任何兴趣，我可以包括它。

授权码看起来不错，和我见过的其他类似：62个字符，以“4/”开头。我从[Google API 控制台](https://code.google.com/apis/console/)小心复制的客户端 ID、密码和重定向 URL 。该应用程序注册为“其他”应用程序，我正在从 Windows 机器连接。

根据[这篇](https://stackoverflow.com/questions/11863966/google-api-get-token-request-returns-invalid-request)和[这篇文章](https://stackoverflow.com/questions/13066186/google-api-access-token-returning-400-invalid-request)，我尝试了非 URL 编码，没有任何变化。 [OAuth Playground](https://developers.google.com/oauthplayground/)建议 URL 编码是正确的。

根据[这篇文章](https://stackoverflow.com/questions/10799947/google-api-request-for-token-from-oauth2-returns-invalid-request)和[这篇](https://stackoverflow.com/questions/10696584/net-google-oauth-token-webrequest-bad-request-protocol-error)文章，属性连接在一行上。

根据[这篇文章](https://stackoverflow.com/questions/11812459/google-api-request-for-token-from-oauth2-returns-invalid-request)，我已经尝试`approval_prompt=force`过授权请求，但新的身份验证代码并没有更好地工作。授权码会过期吗？我通常会在几秒钟内使用新代码。

根据[Google 文档](https://developers.google.com/accounts/docs/OAuth2InstalledApp)和[这篇文章](https://stackoverflow.com/questions/9759532/google-api-get-access-token-request-returns-invalid-request)，我使用的是内容类型“application/x-www-form-encoded”。

我的授权请求适用于范围“ [https://www.googleapis.com/auth/analytics.readonly](https://www.googleapis.com/auth/analytics.readonly) ”。

根据[这篇文章](https://stackoverflow.com/questions/11833281/how-to-get-access-token-for-google-oauth)，参数中没有前导问号。

有*一个*Google .NET OAuth 库，但我无法让它轻松运行，如果我有选择的话，大约 50,000 行代码比我想学习的要多。我更喜欢从头开始写一些干净的东西，而不是盲目地复制一堆库，货物崇拜风格。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-15T20:16:05.240

找到了。`redirect_uri`用于请求令牌的令牌需要与获取授权码时使用的令牌相匹配。这是我获取身份验证代码的工作代码：

```
private const string  BaseAuthorizationUrl = "https://accounts.google.com/o/oauth2/auth";
public string  GetAuthorizationUrl(string clientId, IEnumerable<string> scopes)
    {
    var  parameters = new Dictionary<string, string>
        {
        { "response_type",   "code" },
        { "client_id",       clientId },
        { "redirect_uri",    RedirectUrl },
        { "scope",           String.Join(" ", scopes) },
        { "approval_prompt", "auto" }
        };
    return WebUtilities.BuildUrl(BaseAuthorizationUrl, parameters);
    } 
```

...这是我获取访问令牌和刷新令牌的代码：

```
private const string  BaseAccessTokenUrl = "https://accounts.google.com/o/oauth2/token";
public void  GetTokens(string clientId, string clientSecret, string authorizationCode, out string accessToken, out string refreshToken)
    {
    var  parameters = new Dictionary<string, string>
        {
        { "code",          authorizationCode },
        { "redirect_uri",  RedirectUrl },  // Must match that used when authorizing an app
        { "client_id",     clientId },
        { "scope",         String.Empty },
        { "client_secret", clientSecret },
        { "grant_type",    "authorization_code" }
        };
    string   rawJson    = WebUtilities.Post(BaseAccessTokenUrl, parameters, "application/x-www-form-urlencoded");
    dynamic  parsedJson = JsonUtilities.DeserializeObject(rawJson);
    accessToken  = parsedJson.access_token;
    refreshToken = parsedJson.refresh_token;
    } 
```

...这是获取新访问令牌的代码：

```
public string  GetAccessToken(string clientId, string clientSecret, string refreshToken)
    {
    var  parameters = new Dictionary<string, string>
        {
        { "client_id",     clientId },
        { "client_secret", clientSecret },
        { "refresh_token", refreshToken },
        { "grant_type",    "refresh_token" }
        };
    string   rawJson    = WebUtilities.Post(BaseAccessTokenUrl, parameters, "application/x-www-form-urlencoded");
    dynamic  parsedJson = JsonUtilities.DeserializeObject(rawJson);
    return parsedJson.access_token;
    } 
```

# php - 使用 iframe 时遇到问题

> ID：14883914
> 
> 赞同：0
> 
> 时间：2013-02-14T20:57:22.490
> 
> 标签：php, javascript, jquery, html, iframe

在使用 iframe 时我失败得很厉害，我需要一些帮助。我以前从未使用过 iframe，这是我第一次。

这是关于我尝试使用 Galleria 滑块生成 iframe 的文档：http: [//galleria.io/docs/references/data/](http://galleria.io/docs/references/data/)

我拥有的是一个 jwplayer，我想使用 iframe 访问视频以检索`video.php`页面中的视频。如果只有一个视频，则只需从 video.php 页面检索正确的视频，但如果有多个视频，则检索正确的多个视频并将它们显示在 Galleria 滑块中。但我的问题是我怎样才能让 iframe 工作才能做到这一点？

下面是显示 jwplayer 的 video.php 页面：

```
 <div id="myElement-<?php echo $key.'-'.$i; ?>">Loading the player...

    <script type="text/javascript">

    jwplayer("myElement-<?php echo $key.'-'.$i; ?>").setup({
        file: "<?php echo 'VideoFiles/'.$v; ?>",
        width: 480,
        height: 270
    });

    <?php $i++; ?> 
```

下面是检查视频是单个还是多个的代码，如果有多个则显示 Galleria 滑块，这是放置 iframe 的位置：

```
if(count($arrVideoFile[$key]) == 1){
    foreach ($arrVideoFile[$key] as $v) { ?>

var data = [
    {

     iframe: 'video.php'

     }
];  

<?php
}
}else if(count($arrVideoFile[$key]) > 1){
?>

<style>
    #galleriavideo_<?php echo $key; ?>{ width: 500px; height: 300px; background: #000 }
</style>

 <div id="galleriavideo_<?php echo $key; ?>">
<?php
foreach ($arrVideoFile[$key] as $v) { ?>

<script type="text/javascript">

var data = [
    {

     iframe: 'video.php'

     }
];
</script>
</div>
<?php } ?>
</div>

         <script type="text/javascript">

            Galleria.loadTheme('jquery/classic/galleria.classic.min.js');
            Galleria.run('#galleriavideo_<?php echo $key; ?>');

          </script>

<?php

        }
    }
        //end:procedure video 
```

**编辑：video.php**

```
<?php

$key = filter_input(INPUT_GET, "key", FILTER_SANITIZE_STRING);
$i = filter_input(INPUT_GET, "i", FILTER_SANITIZE_NUMBER_INT);
$v = filter_input(INPUT_GET, "v", FILTER_SANITIZE_STRING);

?>
<div id="myElement-<?php echo $key.'-'.$i; ?>">Loading the player...

<script type="text/javascript">
jwplayer("myElement-<?php echo $key.'-'.$i; ?>").setup({
    file: "<?php echo 'VideoFiles/'.$v; ?>",
    width: 480,
    height: 270
});

</script>

</div> 
```

**评估.php：**

```
if(count($arrVideoFile[$key]) > 1){
?>

<style>
    #galleriavideo_<?php echo $key; ?>{ width: 500px; height: 300px; background: #000 }
</style>

 <div id="galleriavideo_<?php echo $key; ?>">
<?php
foreach ($arrVideoFile[$key] as $v) { ?>

<a href="video.php?key={$key}&i={$i}&v={$v}"><img class="iframe"></a>

<?php $i++; ?>
<?php } ?>
</div>

         <script type="text/javascript">

            Galleria.loadTheme('jquery/classic/galleria.classic.min.js');
            Galleria.run('#galleriavideo_<?php echo $key; ?>');

          </script>

<?php

        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T22:20:30.997

这是一个关于如何将 Galleria 与 jwplayer 一起使用的简短示例。然后，您可以尝试使其适应您的代码。

首先，有`video.php`一个包含 jwplayer 的文件：

```
<div id="container"></div>
<script type="text/javascript" src="/path/to/jwplayer.js"></script>
<script type="text/javascript">
    jwplayer("container").setup({
        file: "http://content.bitsontherun.com/videos/3XnJSIm4-kNspJqnJ.mp4",
        image: "http://content.bitsontherun.com/thumbs/3XnJSIm4-640.jpg"
    });
</script> 
```

然后是`gallery.php`包含滑块的文件：

```
<div id="galleria" style="height:350px; width:550px;">
    <a href="/path/to/video.php"><img class="iframe"></a>
</div>

<script type="text/javascript" src="/path/to/jquery.js"></script>
<script type="text/javascript" src="/path/to/galleria.js"></script>
<script type="text/javascript">
    Galleria.loadTheme('/path/to/galleria.classic.min.js');
    Galleria.run('#galleria');
</script> 
```

如果你想在滑块中显示多个视频，你可以想象一个解决方案，其中`video.php`需要一个参数并根据它加载一个视频，即`video.php?id=xx`

**编辑：**澄清一下

您的`video.php`文件应采用一些参数：

```
$key = filter_input(INPUT_GET, "key", FILTER_SANITIZE_STRING);
$i = filter_input(INPUT_GET, "i", FILTER_SANITIZE_NUMBER_INT);
$v = filter_input(INPUT_GET, "v", FILTER_SANITIZE_STRING);

<div id="myElement-<?php echo $key.'-'.$i; ?>">Loading the player...
<script type="text/javascript" src="/path/to/jwplayer.js"></script>
<script type="text/javascript">
jwplayer("myElement-<?php echo $key.'-'.$i; ?>").setup({
    file: "<?php echo 'VideoFiles/'.$v; ?>",
    width: 480,
    height: 270
}); 
```

然后在`gallery.php`文件中：

```
<div id="galleria" style="height:350px; width:550px;">
    <a href="/path/to/video.php?key=xxx&i=xxx&v=xxx"><img class="iframe"></a>
    <a href="/path/to/video.php?key=xxx&i=xxx&v=xxx"><img class="iframe"></a>
    <a href="/path/to/video.php?key=xxx&i=xxx&v=xxx"><img class="iframe"></a>
    ...
</div> 
```

# html - html 5 doc 模式仍然在怪癖中开放

> ID：14883915
> 
> 赞同：0
> 
> 时间：2013-02-14T20:57:21.450
> 
> 标签：html, doctype

我正在开发一个 WordPress 网站，即使我将 html5 作为 docmode，该网站仍然强制在 IE9 和 8 中以怪癖打开。网址是：[http ://teknikor.bethmotta.com](http://teknikor.bethmotta.com)

我的 header.php 包含以下代码：

```
<!doctype html>
<html>
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge" /> 
```

关于为什么这仍然在 Quirks 中开放的任何想法？谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T21:06:30.497

我刚刚查看了该站点，您的文档类型上方有大约 38 行 HTML，这看起来与 Google Analytics（分析）有关。我相信 IE 会希望 doctype 成为源代码的第一行。

# objective-c - 过滤日期字符串

> ID：14883919
> 
> 赞同：0
> 
> 时间：2013-02-14T20:57:26.800
> 
> 标签：objective-c, cocoa-touch, cocoa

我有一个看起来像这样的字符串：

> “51403074 0001048713 1302130446 TOMTOM101 订单 51403074-3-278065518：ontvangen”

此字符串是从包含类似字符串的数组中过滤出来的。该字符串包含一些相关数据和一些不相关数据。字符串中唯一相关的部分是：`1302130446`. 此数字表示日期和时间 (yy/mm/dd/hh/mm)。因为这部分是日期和时间，所以每次都不一样。

如何过滤此字符串，以便我将拥有一个仅包含相关部分的字符串。

抱歉还在学习IOS开发。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T21:08:14.437

如果日期字符串始终是第三个单词，您可以将 NSString 拆分为一个单词数组

```
NSString *myString = @"This is a test";
NSArray *myWords = [myString componentsSeparatedByString:@" "]; 
```

然后访问数组中的第三项以获取您想要的字符串。

**编辑（由于评论）：**为确保您从单词数组中获得正确的字符串，您需要一个唯一的字符串标识符。可能是“TOMTOM101”总是跟随日期字符串或其他东西......

**编辑 2（由于需要示例代码）

```
NSUInteger counter = 0;
NSUInteger dateStringIndex = 0;
for(NSString *str in myWords) {
    counter ++;
    if([str isEqualToString:@"TOMTOM101"]) {
        dateStringIndex = counter - 1;

        //We now know which word is the date number, so we can stop looping.
        break;
    }
} 
```

（未编译的代码）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T21:14:09.480

似乎相关字符串的长度为 10 个字符。

如果此相关字符串的位置在您的原始字符串中是固定的（紧跟在 TOMTOM 之后），

然后你可以做这样的事情： -

遍历原始字符串的长度，并查找 = 'TOMTOM' 的块

迭代时为计数添加一个计数器值，将其更新为 1，每当您遇到“空格”时......也就是当您遇到第一个“空格”时，添加一个计数器值，例如 count = 1，然后当您遇到第二个空间，更新计数 = 2.. 等等，

当您找到 TOMTOM 时，您的计数器将有一个值，例如 =4，因此您知道日期字符串位于 count 设置之后 = 3 和 count 设置 = 4 之前。

while count = 3 do: extract 'relevant string from original string'。当您遇到下一个“空格”时，更新计数 = 4，因此停止从原始字符串中提取。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T22:08:55.407

您所要做的就是用一个字母空格分隔原始字符串。

```
NSString *whatever = @"51403074 0001048713 1302130446 TOMTOM101 Order 51403074-3-278065518: ontvangen"
NSString *mydatestring = [self NthString:whatever :@" " :2];

- (NSString *)NthString:(NSString *)source:(NSString *)part:(NSInteger)i {
if (i >= 0) {
    NSArray* components = [source componentsSeparatedByString:part];
    return [components objectAtIndex:i];
}
else {
    return @"";
}
} 
```

# loops - 有效地迭代和存储数千/数百万个对象

> ID：14883921
> 
> 赞同：1
> 
> 时间：2013-02-14T20:57:42.600
> 
> 标签：loops, iteration, quadtree

我正在做一个模拟，我需要能够处理更新每个循环的数千个潜在的数百万个对象。所有对象都需要具有称为（AI）的逻辑功能。但是根据对象的位置决定了逻辑的详细程度。例如：

[使用 100 个对象保持简单]

*   所有对象都有一个位置 (x,y)
*   `20`对象距离“兴趣点”位置 500 点。
*   `50`对象距离对象 500 点`20`（距离 1000 点）。
*   `30`对象距离兴趣点 100 点以内。

现在说这是一个详细的城市模拟，对象是虚拟公民。下午 6 点，每个人都该下班回家睡觉了。

所以我们遍历所有公民，但我希望他们做不同的事情。

*   最远的物体 (50) 下班回家睡觉直到早上。
*   较近的物体 (20) 下班回家，吃点东西，然后睡到早上。
*   最近的物体 (30) 下班回家，吃点东西，刷牙，然后睡到早上。

正如您所看到的，它们越接近兴趣点，逻辑就越详细。

我正在尝试找出迭代所有对象的最佳和最高效的方法是什么。用满手的物体，这将是相对容易的，但由于这需要有效地处理至少 500,000 个物体，我需要一些建议。

此外，我不确定是否应该在每个循环中遍历所有对象，或者最好在每个循环中遍历最近的对象，但每 10 个循环仅遍历更远的对象？

由于需要对象在靠近它们的其他对象之间进行交互的额外要求，我一直在想最好的方法可能是将它们组织成四叉树，但我不确定。似乎四叉树更适合静态内容，但我正在处理的对象，如前所述，有一个位置，需要移动到其他位置。我是否走在正确的思考轨道上？或者，还有更好的方法？

如果有人认为它相关，我也在使用 c++ 工作。

任何建议将不胜感激。

**笔记：**

1.  兴趣点定期变化，将其视为相机视图。
2.  对象是动态创建和销毁的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T21:02:58.460

如果您想从特定点快速选择特定半径内的对象，那么四叉树或简单的方形网格会有所帮助。

如果您的问题是如何存储数百万个对象以有效地通过它们进行迭代，那么您可能可以使用基于列的技术，而不是每个具有 5 个字段的 100 万个对象，而是每个具有 100 万个元素的 5 个数组。在这种情况下，每个对象只是范围 0 .. 999999 中的一个索引。因此，例如，您要存储 100 万个具有以下结构的对象：

```
struct resident
{
    int x;
    int y;
    int flags;
    int age;
    int health; // This is computer game, right?
} 
```

然后，不是声明，而是`resident residents [1000000]`声明 5 个数组：

```
int resident_x [1000000];
int resident_y [1000000];
int resident_flags [1000000];
int resident_age [1000000];
int resident_health [1000000]; 
```

然后，而不是，说，`residents [n].x`你使用`resident_x [n]`. 当您需要遍历相同类型的所有对象并对每个对象中的几个字段（每个对象中具有相同的字段集）执行某些操作时，这种存储对象的方式可能会更快。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T21:13:01.873

您需要将问题分解为“类”，就像在现实世界中一样。每个人的班级都是根据距离计算的。所以下层人远，上层人近。或者更准确地说是“远类”、近类和“这里类”或任何你想命名的东西。

1）为每个班级制作一个带有一个插槽的数组。该插槽将保存该班级中每个人的“链接列表”。当一个人的类别改变者（社交攀登者）时，将对象移动到另一个列表是非常迅速的。

2）所以把每个人都放到适当的类中，只迭代你附近的类。在适当的情况下，有些对象需要关心很远，因此您可以将它们放回磁盘并仅在您靠近时重新加载。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T21:13:19.120

有几个问题嵌入其中： - 如何处理大量的对象？如果有固定数量的固定对象，您可以简单地创建它们的数组，只要您有足够的内存。如果您需要动态地创建和销毁它们，那么如果没有仔细处理被销毁的对象，您就会面临内存泄漏的风险。在某个时候，您可能会问自己，使用其他应用程序（例如数据库）来存储对象并仅执行 C++ 代码中的逻辑是否更好。数据库将提供我将重点介绍的其他功能。

-如何在与他人的给定距离内找到对象。这是地理信息系统（GIS）的经典问题；听起来您正在尝试操作一个简单的 GIS 来存储您的对象和属性，因此它是适用的。在每个点上测试距离公式 SQRT((Xx)^2+(Yy)^2) 需要计算能力。相反，通常使用“窗口函数”来提取包含您想要的所有点的正方形，然后在其中搜索以找到特定位于给定半径内的点。一些数据库经过优化以执行各种 GIS 功能，包括返回给定半径内的点，或返回一些其他几何形状（如多边形）内的点。否则，您必须自己编写此功能。

- 对象的树存储。这可以提高速度，但是如果对象不断地四处移动，您将需要权衡，其中必须经常重组树。这完全取决于事物移动的频率与您希望对其进行计算的频率。

-人工智能代码。如果您尝试对数百万个对象进行 AI，这可能是您对性能的最大使用，而不是用于存储和搜索对象的方法。你是对的，对于更远的点，更简单的代码会提高性能，对于更远的点执行逻辑的频率也会降低。这有时使用蒙特卡洛分析来处理，其中逻辑将在任何给定迭代期间对点的随机子集执行，并且随着与感兴趣点的距离增加，执行的概率可能会降低。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-04-05T19:00:13.550

我会考虑使用带有 Morton 编码/Z-Order 索引的线性四叉树。您可以通过使用位数组来表示包含数据并非常快速地执行计算的节点来进一步优化此结构。

我使用 Javascript 在浏览器中非常有效地完成了这项工作，并且可以在亚秒内遍历 6700 万个节点。一旦我将其缩小到感兴趣的区域，我就会以不同的结构查找数据。所有这一切仍以毫秒为单位。我将它用于空间矢量动画。

# tcp - 如何创建实时 Simulink 传输块

> ID：14883923
> 
> 赞同：0
> 
> 时间：2013-02-14T20:58:01.223
> 
> 标签：tcp, transfer, simulink

我有一个简单的想法，但我想很难在 simulink 上实现它。我使用 C 代码在 BeagleBone 和 simulink 块之间创建了一个 TCP/IP 服务器。我有一个连接到小猎犬骨头的开关作为输入，我的想法是在 simulink 块上显示开关是关闭还是打开。我不能这样做，因为我的客户端（simulink 块）是 ac 代码，它只会执行一次工作，因为 C 代码在返回后结束函数执行以获取开关的值。你们知道在 Simulink 客户端块和显示器之间传输数据的任何 simulink 传输模式或花哨的 C 技巧吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-23T10:06:15.460

在我一直在研究的模拟器中，我们使用带有远程 IP 地址和 IP 端口的 Sink 块将实时计算的数据导出到外部侦听器（这可以在同一台机器上或通过网络连接），在我们的例子中是一台进行图形渲染的计算机，然后由使用 Ogre 3D 编写的 C++ 代码和使用源代码块的另一个 simulink 模型拾取。

我们还有一个交互式海图仪显示屏（如果您愿意，可以显示 GPS 位置）。我们可以随时通过调用以下命令来访问从 simulink 生成的值：

```
variable = get_param('Simulator/Chartplotter/YDot','RuntimeObject'); 
```

您还可以调用“set_param”来修改位于 simulink 模型内的常量值。

我没有使用 beagle 的经验，但我想您可以让您的 C 代码执行 matlab 脚本，该脚本将修改您的 simulink 模型中存在的逻辑常量，以指示开关是否打开。

或者，您可以探索第一个选项，但我们仅使用它来将数据从 simulink 中获取到 C 程序中，而不是像您希望的那样反过来。不幸的是，我无法直接访问接收的 C 代码，但如果你真的被卡住了，我可以让我的同事把重要的部分发给我。

希望这可以帮助。

# r - 如果 function(x) 可以工作，为什么我们需要 function()？

> ID：14883925
> 
> 赞同：1
> 
> 时间：2013-02-14T20:58:11.267
> 
> 标签：r

我了解“function(x)”的工作原理，但“function()”在这里的作用是什么？

```
z <- function() {
  y <- 2
  function(x) {
    x + y
  }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T21:12:57.933

`function`是一个关键字，它是函数创建的一部分（在[Gilles 在他的回答中描述](https://stackoverflow.com/a/14884311/892313)的编程意义上）。其他部分是参数列表（在括号中）和函数体（在大括号中）。

在您的示例中，`z`是一个不带参数的函数。它返回一个带有 1 个参数（名为 ）的函数`x`（因为默认情况下 R 返回最后一个评估的语句作为返回值）。该函数返回其参数`x`加 2。

当`z`被调用（不带参数`z()`：）时，它会将 2 分配给`y`（在函数变量范围内，这是一个我不会涉及的附加概念）。然后它创建一个函数（没有名称），它接受一个名为 的参数`x`，当它自己被调用时，它返回它的参数`x`加 2。该匿名函数从调用返回，`z`并且可能被存储，以便以后可以调用它.

有关将函数作为对象传递的更多讨论，请参见[https://github.com/hadley/devtools/wiki/Functions](https://github.com/hadley/devtools/wiki/Functions)和[https://github.com/hadley/devtools/wiki/Functionals 。](https://github.com/hadley/devtools/wiki/Functionals)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-14T21:24:17.707

[“函数”这个词在数学](http://en.wikipedia.org/wiki/Function_%28mathematics%29)和[编程](http://en.wikipedia.org/wiki/Function_%28computer_science%29)中的含义有些不同。在数学中，函数是参数的每个可能值与结果之间的对应关系。在编程中，函数是从参数计算结果的指令序列。

在数学中，没有参数的函数是常数。在编程中，情况并非如此，因为函数可能有[副作用](http://en.wikipedia.org/wiki/Side_effect_%28computer_science%29)，比如打印一些东西。所以你会在程序中遇到很多没有参数的函数。

Hre 函数`function(x) { x + y }`取决于变量`y`。没有副作用，所以这个函数很像 $f(x) = x + y$ 定义的数学函数。然而，这个定义只对给定的值是完整的`y`。前面的指令设置`y`为 2，所以

```
function() {
  y <- 2
  function(x) {
    x + y
  }
} 
```

相当于

```
function () {
  function(x) {
    x + 2
  }
} 
```

从某种意义上说，当两个定义应用于相同的值时，会产生相同的结果。然而，它们的计算方式略有不同。

该函数被命名为`z`。当你调用`z`（没有参数，所以你写`z()`）时，这会构建函数`function (x) { x + 2 }`，或等效的东西：`z()`是一个参数的函数，它的参数加 2。所以你可以写出类似的东西`z()(3)`——结果是 5。

这显然是一个玩具示例。随着您在讲座中的进步，您将看到越来越复杂的示例，其中此类功能构建与其他功能混合以实现有用的东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-15T15:47:30.770

在[一些帮助下](https://stackoverflow.com/questions/14884346/identify-all-functions-with-an-empty-argument-list/14884347#14884347)，我挑选了一些没有正式参数的函数示例，以帮助您理解它们为什么有用。

**有副作用的函数**

*   `plot.new()`例如，初始化图形设备。
*   想要更新控制台缓冲区？ `flush.console()`支持你。

**用途狭窄的功能**

这可能是大多数情况。

*   想知道日期/时间？打电话`date()`。
*   想知道 R 的版本吗？打电话`getRversion()`。

# ruby - 将 Heroku 用于静态站点：资产不会显示

> ID：14883927
> 
> 赞同：1
> 
> 时间：2013-02-14T20:58:12.540
> 
> 标签：ruby, image, heroku, rack, static-site

我刚刚使用[本教程](https://devcenter.heroku.com/articles/static-sites-ruby)向 Heroku 加载了一个静态应用程序，一切正常，除了我的图像没有显示。当同一个站点作为纯静态站点（不是通过 Heroku）托管在我自己的服务器上时，所有资产都可以毫无问题地加载。

目前，我的存储库中有一个 Gemfile、Gemfile.lock、app.rb、config.ru 和 public（静态站点目录），我通过它们加载到 Heroku`git push heroku master`以推送到 Heroku。

我的图像在 public/img 中，甚至直接从 html 引用的资产也没有显示出来。当我在 Chrome 中使用 firebug lite 检查资产目录时，似乎图像文件在那里，但它们似乎没有图像数据（据我所知）。

我没有更多的 ruby​​/rails 文件。我应该在某个地方有一个 production.rb 文件吗？我错过了什么吗？

目前，我在 Heroku 上的设置是免费包。我是否需要升级到付费套餐才能查看我的资产（我只有 2MB 的资产）？我尝试在“public”目录中创建一个“assets”目录并将 img 目录放在那里，但仍然没有运气。

这是我的 config.ru

```
use Rack::Static, 
  :urls => ["/img", "/js", "/css"],
  :root => "public"

run lambda { |env|
  [
    200, 
    {
      'Content-Type'  => 'text/html', 
      'Cache-Control' => 'public, max-age=86400' 
    },
    File.open('public/index.html', File::RDONLY)
  ]
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-15T19:56:38.827

要诊断这样的问题，您认为您的 dyno 上的文件内容与源中的文件内容不匹配，请使用`heroku run bash`登录到远程[的开关 dyno](https://devcenter.heroku.com/articles/one-off-dynos)。这将使您进入一个 bash shell，您可以在其中探索您的 dyno 所看到的文件系统（尽管您的 shell 所附加的 dyno 不是主动服务您的请求的那个，它将具有相同的文件系统内容）。

```
$ heroku run bash
Running `bash` attached to terminal... up, run.4065
~ $ ls
pubic Gemfile Gemfile.lock app.rb config.ru
~ $ cd public/img
~/public/img $ ls -l
total 40
-rw------- 1 u36831 36831  2743 2013-02-15 18:54 facebook-1652d049.png
-rw------- 1 u36831 36831  2291 2013-02-15 18:54 feed-e8d78a2f.png 
```

从这里你应该能够看到：

*   如果图像文件甚至存在于测功机上
*   如果它们的内容是您所期望的（文件大小是否与您在本地环境中看到的相匹配？）

# sql - 使用 SELECT 的 SQL Server 变量赋值中的执行顺序

> ID：14883930
> 
> 赞同：8
> 
> 时间：2013-02-14T20:58:28.590
> 
> 标签：sql, sql-server, tsql, variable-assignment, operator-precedence

给定以下示例：

```
declare @i int
select @i = 1, @i = 2
select @i 
```

永远`@i`是2？

这是我能想到的最简单的例子，但我正在考虑使用它来交换变量中的值。我也相信这种分配方法（选择）不符合 ANSI（尽管有用），但在这种情况下并不真正关心有可移植代码。

**更新**

感谢@MichaelFredrickson，我们有@MartinSmith 的[回答](https://stackoverflow.com/a/5758032/880904)和对[MSDN](http://msdn.microsoft.com/en-us/library/ms187953.aspx)的参考。我现在正在为本文档中第二句话的确切含义而苦苦挣扎（强调）：

> 如果单个 SELECT 语句中有多个赋值子句，SQL Server 不保证表达式的计算顺序。**请注意，只有在分配之间存在引用时，效果才可见。**

然而，第一句话足以让我远离依赖行为。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-14T21:41:40.160

对于变量赋值， Martin Smith 在这里参考[MSDN](http://msdn.microsoft.com/en-us/library/ms187953.aspx)[回答了这个问题](https://stackoverflow.com/a/5758032/643591)：

> 如果单个 SELECT 语句中有多个赋值子句，SQL Server 不保证表达式的计算顺序。请注意，只有在分配之间存在引用时，效果才可见。

## 但...

如果我们处理的是表格而不是变量，那就是另一回事了。

在这种情况下，Sql Server 使用*All-At-Once*操作，正如[Itzik Ben-Gan 在 T-Sql Fundamentals 中](http://books.google.com/books?id=v_T82PlI3UwC&pg=PT470&dq=t-sql%20fundamentals%20all-at-once%20update&hl=en&sa=X&ei=CFkdUZfGDOHFigLEqICgCA&ved=0CDYQ6AEwAA)所讨论的那样。

这个概念表明，在同一逻辑阶段中的所有表达式都被评估为好像同一时间点......无论它们的从左到右位置如何。

所以在处理相应的`UPDATE`语句时：

```
DECLARE @Test TABLE (
    i INT,
    j INT
)

INSERT INTO @Test VALUES (0, 0)

UPDATE @Test
SET
    i = i + 10,
    j = i

SELECT 
    i, 
    j 
FROM 
    @Test 
```

我们得到以下结果：

```
i           j
----------- -----------
10          0 
```

通过在 Sql Server 中使用*All-At-Once*评估...，您可以在没有中间变量/列的情况下交换表中的列值。

[据我所知，](https://stackoverflow.com/a/10693062/643591)大多数 RBDMS 都以这种方式运行，但 MySql 是一个例外。

* * *

## 编辑：

> 请注意，只有在分配之间存在引用时，效果才可见。

我理解这意味着如果您有`SELECT`如下声明：

```
SELECT
    @A = ColumnA,
    @B = ColumnB,
    @C = ColumnC
FROM MyTable 
```

然后，分配执行的顺序无关紧要……无论如何，您都会得到相同的结果。但是，如果您有类似...

```
SELECT
    @A = ColumnA,
    @B = @A,
    @C = ColumnC
FROM MyTable 
```

现在**在分配**( ) 之间有一个引用，现在分配`@B = @A`和 的顺序很重要。`@A``@B`

# wpf - 为 WPF Datagrid 或 DevexGridcontrol 动态生成动态列和绑定数据

> ID：14883932
> 
> 赞同：3
> 
> 时间：2013-02-14T20:58:38.467
> 
> 标签：wpf, mvvm, datagrid, devexpress

我有以下数据结构：

```
public class StudentScore {
    public string ScoreValue{ get; set; }
}

public class Student {
    public string StudentName { get; set; }
    //Scores.Count will be = EndDate-StartDate
    public ObservableCollection<StudentScore> Scores { get;set; } 
}

ObservableCollection<Student> Students { get; set; }
public DateTime StartDate { get; set; } //Can be changed by user dynamically
public DateTime EndDate { get; set; } //Can be changed dynamically 
```

我有兴趣在 WPF DataGrid/DevExpress GridControl 中实现如下： `Column 1`始终是固定的，即学生姓名，其余列将仅基于数量，`Scores`每行应填充学生姓名和分数。

每个单元格应该有一个双向绑定，用户可以在其中编辑分数以反映在实际的 VM 属性中。

![学生 poc 图像](../Images/76b33a54febf224556424d399271d7da.png)
我试图将`AutoGenerateColumns`属性设置为 true - 它只生成两列，因为我只有`StudentName`和`Scores`属性。所以我需要一些可以为每一行从集合中生成列的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T04:41:25.107

[您可以通过GridControl.ColumnsSource](http://help.devexpress.com/#WPF/DevExpressXpfGridDataControlBase_ColumnsSourcetopic)属性绑定网格列。
请在以下帮助文章中查看此方法的详细说明：[绑定到列集合](http://help.devexpress.com/#WPF/CustomDocument10121)。

# python - 检查时间戳字符串是否在时间范围内

> ID：14883937
> 
> 赞同：3
> 
> 时间：2013-02-14T20:58:51.150
> 
> 标签：python

我需要检查时间戳字符串是否在时间范围内：

```
tt = '26-12-2012 18:32:51'
t1 = datetime.timedelta(0, 28800) #08:00 hrs
t2 = datetime.timedelta(0, 68400) #19:00 hrs 
```

要比较我是否需要将时间戳转换为 timedelta？，我该怎么做，比较像：

```
if tt >= t1 and tt <= t2: 
```

谢谢..

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-14T21:07:15.793

首先，构造一个日期时间对象`datetime.strptime`：

```
>>> t = datetime.datetime.strptime('26-12-2012 18:32:51', '%d-%m-%Y %H:%M:%S')
>>> t
datetime.datetime(2012, 12, 26, 18, 32, 51) 
```

现在，构造第二个仅代表日期部分的日期时间对象：

```
>>> t2 = t.replace(hour=0, minute=0, second=0) 
```

从中您可以得到一个`datetime.timedelta`适合与您的其他`timedelta`s 进行比较的：

```
>>> t - t2
datetime.timedelta(0, 66771)
>>> dt = t - t2
>>> dt1 = datetime.timedelta(0, 28800) #08:00 hrs
>>> dt2 = datetime.timedelta(0, 68400) #08:00 hrs
>>> dt > dt1
True
>>> dt2 > dt > dt1
True 
```

# python - distutils - 如果是 windows，如何添加 .pyw 脚本

> ID：14883938
> 
> 赞同：2
> 
> 时间：2013-02-14T20:59:01.943
> 
> 标签：python, python-2.7, distutils

我正在分发一个简单的库/应用程序，其中包含一个带有 GUI 的脚本。在 Windows 下，我希望它由 pythonw.exe 运行，最好将其设为`.pyw`文件。

```
root/
    lib/
        lib.py

    guiscript.py
    setup.py 
```

我希望用户能够安装`guiscript`在任何路径中。

[我从这个问题](https://stackoverflow.com/questions/1321270/how-to-extend-distutils-with-a-simple-post-install-script)中偷了这个钩子：

```
from distutils.core import setup
from distutils.command.install import install
import os, sys

class my_install(install):
    def run(self):
        install.run(self)
        try:
            if (sys.platform == "win32") and sys.argv[1] != "-remove":
                os.rename("guiscript.py",
                          "guiscript.pyw")
        except IndexError:pass

setup(...
      cmdclass={"install": my_install}) 
```

但这不起作用，因为它更改了源文件夹中 guiscript.py 的名称，因为路径是相对于 setup.py 的。

有没有一种合理的方法来获取脚本安装路径，或者是一种简单的方法来找到 guiscript.py（它不是在 PYTHONPATH 中）。

* * *

所以因为我没有 50 业力，我无法在 7 小时内回复我自己的帖子，但这里是：

好的，我找到了解决方案。如果你愿意，我可以删除这个问题，但现在我会保留它，以防其他人有同样的问题。

```
from distutils.core import setup
from distutils.command.install_scripts import install_scripts
import os, sys

class my_install(install_scripts):
    """Change main script to .pyw after installation.

    If sys.argv == '-remove'; it's ran as uninstall-script.
    Override run() and then call parent."""
    def run(self):
        install_scripts.run(self)
        try:
            if (sys.platform == "win32") and sys.argv[1] != "-remove":
                for script in self.get_outputs():
                    if script.endswith("guiscript.py"):
                        os.rename(script, script+"w")
        except IndexError:pass

setup(...
      cmdclass={"install_scripts": my_install}
     ) 
```

# jquery - Chrome 在 keycode/keypress (JQuery) 上无法正常工作

> ID：14883940
> 
> 赞同：0
> 
> 时间：2013-02-14T20:59:15.997
> 
> 标签：jquery

我正在开发类似 excel 的环境中的数据插入（想法是从 excel 上传数据复制粘贴）。

我为此使用了 JQuery，并且在 Firefox 中运行良好，但 Chrome 在按键上令人头疼，我真的不知道如何让它工作。

这是示例：http: [//jsfiddle.net/j6PgY/](http://jsfiddle.net/j6PgY/)

我正在做的是这样的：

```
$(document).live('keypress', function(e){
if(e.keyCode==38 && y!=1){ // Up
    y--;
}else if(e.keyCode==40 && y!=largo){ // Down
    y++;
} 
```

从第 67 行看

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T21:03:55.477

这似乎有效：

```
$(document).on('keydown', function(e){
    if(e.which==38 && y!=1){ // Up
        y--;
    }else if(e.which==40 && y!=largo){ // Down
        y++;
} 
```

[**小提琴**](http://jsfiddle.net/j6PgY/1/)

替换`keypress`为`keydown`诀窍。也不需要`live()`在文档上使用或其他委托事件处理程序，因为它不是动态的，它实际上总是可用的。并且`e.which`在 jQuery 中被标准化。

# ruby - 如何以相同的方式处理多个变量？

> ID：14883948
> 
> 赞同：1
> 
> 时间：2013-02-14T21:00:09.777
> 
> 标签：ruby, variables

很可能有人问过这个问题，但我找不到答案。

我有四个变量：

```
a,b,c,d = [a,b,c,d].map{|myvar| myvar+1 } 
```

我怎样才能使这条线更干（保持紧凑），即在不重复变量名的情况下实现相同的更改？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T22:19:36.253

不要创建单独的变量，从一开始就将值放在 Array 或 Hash 中。

```
data = []
data << 1
data << 2
data << 3
data << 4
data = data.map { |value| value + 1 }
data.inspect # => [2, 3, 4, 5] 
```

或者

```
data = {}
data[:a] = 1
data[:b] = 2
data[:c] = 3
data[:d] = 4
data.each { |key, value| data[key] = value + 1}
data.inspect # => {:a=>2, :b=>3, :c=>4, :d=>5} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T05:23:31.507

我越来越怀疑简短的答案（对于这个带有整数的特定示例）是“不可能”

由于与我上一个问题的答案中描述的相同原因：

[像 String#replace 一样替换 Ruby 中引用的整数值](https://stackoverflow.com/questions/14139251/replacing-referenced-integer-value-in-ruby-like-stringreplace-does)

更新：

如果我们操作的变量是 Array、Hash 或 String，并且它们在执行操作后保持相同的数据类型，则使用 replace 会更干燥、更紧凑并节省内存

```
[a,b,c,d].each{|v| v.replace(v + [1])} #example for an array 
```

# javascript - JS新手，想显示字符串

> ID：14883950
> 
> 赞同：1
> 
> 时间：2013-02-14T21:00:15.207
> 
> 标签：javascript

假设我有带有这样数据的 JSON 对象（在单独的 .json 文件中）：

```
evidenceStrings = [
{"jokeid": 0, "evidence": ["\My God you're right! I never would've thought of that!", "this look that says \My God you're right! I never would've thought of that!\", " \My God you're right! I never would've thought of that!\"]},
{"jokeid": 1, "evidence": ["the man didn't have to watch"]},
{"jokeid": 2, "evidence": ["knocking down trees with your face", "knocking down trees with your face. ", " knocking down trees with your face. ", "with your face.", "knocking down trees with your face"]}
] 
```

我想在 HTML 文件中显示“证据”。问题是我正在从另一个 .js 文件中读取内容并使用 for 循环显示它的内容。

```
for(var i = 0; i < jokes.length; i++) {
    // display string at index 0 of an array in a .js file 
```

`i`这里指的`jokeid`是JSON对象中的。现在我想要的是，对于给定的`i`，从 JSON 对象中提取 my`evidence`并显示它（最好在每个字符串后面加上一个换行符。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T21:06:51.223

这需要循环`evidenceStrings`查看是否找到了匹配的笑话ID。你可以用 很好地做到这一点`.filter`，但在内部它基本上做同样的事情。

```
for (var x = 0; x < jokes.length; x++) {
    var id = jokes[x];
    evidence = evidenceStrings.filter(function (elem) {
        return +elem.jokeid == id;
    });
    if (evidence.length == 1 && evidence[0].hasOwnProperty('evidence')) {
        console.log(evidence[0].evidence.join("\n"));
    }
} 
```

[http://jsfiddle.net/cFsze/](http://jsfiddle.net/cFsze/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T21:12:38.570

使用下划线来简化这些事情（[http://underscorejs.org/](http://underscorejs.org/)）：

```
var foundJoke = _.find(evidenceStrings,function(item) {
   return item.jokeid === 0;
});

var firstItem = _.first(foundJoke.evidence);    
if(_.isArray(foundJoke.evidence)) alert(foundJoke.evidence.join('\n')); 
```

或者

```
var foundJoke = _.findWhere(evidenceStrings,{jokeid:0}); 
```

# c++ - 当堆中分配的对象变大时会发生什么？

> ID：14883957
> 
> 赞同：1
> 
> 时间：2013-02-14T21:00:47.540
> 
> 标签：c++, qt, heap-memory

假设我有一个名为 Result m_result 的成员变量

```
class Result{
QList<Group *> m_groups
} 
```

和组

```
class Group{
QList<Data> m_data
} 
```

随着程序的继续，每个组的 QList of Data 不断增长。所有组都分配在堆中（因此是指针）。本质上，每个组都在堆中分配一次。每次 QList 增长时，是否都会重新分配特定组？另外，由于 Data 成员的增长，m_testResult 是否会一遍又一遍地被复制？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-14T21:03:59.717

在 QList 内部，将有指向其他一些实际保存数据的对象或数组的指针。随着列表的增长，将分配此支持数据的新对象并删除现有对象。您显示的代码不必担心它，但是如果您要实现自己的集合，那么您会的。对象本身一旦被分配就永远不会增长。

可以在[此处](http://qt-project.org/doc/qt-4.8/qlist.html#details)找到 QList 的详细信息- 它使用指向 的指针数组`<T>`，因此不是链表。由于它使用指向元素的指针，因此在调整数组大小时不必复制元素，只需复制指针（或者如果它以与[VList](http://en.wikipedia.org/wiki/VList)类似的方式实现，则可能不会- 我在文档中没有看到任何内容指示它使用哪种策略），因此每次 QList 增长时*都不会*重新分配特定组。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T21:05:28.557

我不知道`QList`具体，但总的来说，我希望以下内容：

*   添加新元素后，`QList`分配 ( `new`) 更多内存并将最后一个元素链接到新元素。

*   删除（现有）元素后，该元素的前任将链接到其后继元素，并且保存该元素的内存是`delete`-ed。

*   这是任何链表如何工作的一般原则，例如`std::list`或`std::slist`

*   **对象永远不会增长，但内存可以被反复声明和释放。**

# c# - 在 WPF 选项卡控件中打开一个弹出窗口

> ID：14883959
> 
> 赞同：1
> 
> 时间：2013-02-14T21:01:00.810
> 
> 标签：c#, wpf, xaml, wpf-controls

我试图在 WPF 的 TabControl 中打开一个弹出窗口，但是由于某种原因它还没有工作。

我有以下内容：-

```
 <Grid>
    <TabControl>
        <TabItem Header="Header1">
        </TabItem>
        <TabItem Header="Header2">
        </TabItem>
        <StackPanel Name="MyPanel">
            <Popup  Height="Auto" Width="Auto" Name="MyToolTip" StaysOpen="True" AllowsTransparency="False"  />
            <Border BorderThickness="1" Background="Azure" Margin="0,0,378.8,0" >
                <StackPanel Margin="30"  Orientation="Horizontal">
                    <TextBlock Text="My Popup "/>
                    <TextBlock  x:Name="MyFirstPopupTextBlock" />
                </StackPanel>
            </Border>
        </StackPanel>
    </TabControl>
</Grid> 
```

在 .cs 我有以下内容：-

```
 public MainWindow()
    {
        InitializeComponent();
        Show_Popup();
    }

    private void Show_Popup()
    {
        MyToolTip.IsOpen = true;
    } 
```

我究竟做错了什么？

感谢您的帮助和时间

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T21:29:01.993

如果您希望它出现在 all 上`TabItems`，您可能希望将其添加到`Grid`，而不是`TabControl`，这样它就会`TabControl`在打开时位于 顶部。

```
 <Grid>
    <TabControl>
        <TabItem Header="Header1" />
        <TabItem Header="Header2" />
    </TabControl>
    <Popup Height="Auto" Width="Auto" Name="MyToolTip" StaysOpen="True" IsOpen="True" Placement="Center" PlacementTarget="{Binding}" AllowsTransparency="False"  >
        <Border BorderThickness="1" Background="Azure"  >
            <StackPanel Margin="30"  Orientation="Horizontal">
                <TextBlock Text="My Popup "/>
                <TextBlock  x:Name="MyFirstPopupTextBlock" />
            </StackPanel>
        </Border>
    </Popup>
</Grid> 
```

结果：

![在此处输入图像描述](../Images/d0860390cc30043c3de5368c018a5baf.png)

# vb.net - 无法为标识列插入显式值

> ID：14883963
> 
> 赞同：3
> 
> 时间：2013-02-14T21:01:16.230
> 
> 标签：vb.net, entity-framework, ef-code-first

创建新记录时出现上述错误。我不想插入身份——数据库是自动生成的，这很好。

这是确切的例外：

```
[System.Data.UpdateException]
{"An error occurred while updating the entries. See the inner exception for details."}
{"Cannot insert explicit value for identity column in table 'PartRevisions' when IDENTITY_INSERT is set to OFF."} 
```

以下是映射：

```
Public Class PartContext
    Inherits DbContext

    Public Property Parts As DbSet(Of Part)
    Public Property PartRevisions As DbSet(Of PartRevision)

    Protected Overrides Sub OnModelCreating(modelBuilder As DbModelBuilder)
        MyBase.OnModelCreating(modelBuilder)

        modelBuilder.Entity(Of PartRevision)().HasKey(Function(r) r.Id).Property(Function(r) r.Id).HasDatabaseGeneratedOption(DatabaseGeneratedOption.Identity)
    End Sub

End Class

<Table("Parts")>
Public Class Part
    <Key(), DatabaseGenerated(DatabaseGeneratedOption.Identity)>
    Public Property Id As Integer

    Public Property PartNumber As String
    Public Property Owner As String
End Class

<Table("PartRevisions")>
Public Class PartRevision
    Inherits Part

    Public Property OriginalId As Integer
    Public Property RevisionDate As DateTime
    Public Property RevisionNumber As Integer
    Public Property RevisionBy As String

End Class 
```

如果我不使用继承，它可以正常工作。如果我使 Id 可覆盖并且还指定子类的属性，它仍然不起作用。

我做`OnModelCreating`这些只是因为我想让它工作。我觉得没有这个应该可以工作。当然，它甚至不适用于这个......

当我在 SQL Management Studio 中执行以下查询时，它可以正常工作：

```
insert into PartRevisions (originalid, revisiondate, revisionnumber, revisionby, partnumber, owner)
values (1, '1/1/2013', 1, 'eep', '123', 'ME') 
```

这是完整程序的要点。我在一个测试项目中对此进行了尝试，因为我认为在 EF 中进行继承时会遇到一些问题（还没有完成）。

[https://gist.github.com/eyston/4956444](https://gist.github.com/eyston/4956444)

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T21:14:57.283

该`PartRevisions`表不得将`Id`列设置为自动生成的标识，只能将表`Parts`设置为基本类型。这两个表具有共享主键。EF 在查询 a 时连接这两个表，如果插入了实体`PartRevision`，它会将行插入到两个表中。`PartRevision`因为两行必须相同，所以`Id`只有一个可以是一个标识。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-27T11:54:34.540

从“Id”列中删除自动标识属性。或者，您可以在查询/存储过程中使用。即使设置了列上的自动标识，这也可以将显式 Id 值输入到您的表中。（虽然总是使用不是一个好主意，但它有利于修复）

```
SET IDENTITY_INSERT dbo.YourTableName ON;
GO 
```

然后在每个表的插入之后：

```
SET IDENTITY_INSERT dbo.YourTableName OFF;
GO 
```

# angularjs - 在AngularJS中绑定到元素文本

> ID：14883964
> 
> 赞同：0
> 
> 时间：2013-02-14T21:01:18.663
> 
> 标签：angularjs

是否可以在不实际放入链接功能的情况下绑定到元素的文本？

```
<blink>Text Here or {{ controllerText() }}</blink>

// add a namespace for custom directives
angular.module('mydirectives', []);

angular.module('mydirectives').directive('blink', function() {
   return {
      restrict: 'E',
      template: '<marquee scrollamount="100%">{{ can i do it here? }} </marquee>',
      scope: {
         // can i do it here?
      }
   };
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T21:58:38.890

所以这是通过将原始元素的内容与模板合并的嵌入来完成的。模板中的 ng-transclude 标记是使其工作所必需的。

```
<blink>Bring the blink back<blink>

// add a namespace for custom directives
angular.module('mydirectives', []);

angular.module('mydirectives').directive('blink', function() {
    return {
      restrict: 'E',
      transclude: true,
      template: '<marquee scrollamount="100%" ng-transclude></marquee>'
   }
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T21:59:37.093

你绝对可以。

```
scope: {
    text: '='
} 
```

这会将`text`属性添加到隔离范围，该范围链接到`text`元素的属性值。

因此，您需要将 html 稍微更改为：

```
<blink text="fromController"></blink> 
```

然后在封闭的控制器中添加该`fromController`属性。

[这是一个（非常烦人的）小提琴](http://jsfiddle.net/87RhB/)。

# php - 使用 PHP 将 HTML 替换为 HTML

> ID：14883967
> 
> 赞同：2
> 
> 时间：2013-02-14T21:01:27.370
> 
> 标签：php, html, function, replace, find

有没有办法使用 PHP 在页面中查找一些 HTML，并将该 HTML 替换为其他 HTML？我希望此函数位于单独的 functions.php 文件中，并查看页面加载中的每个页面以查找需要替换的 HTML（除非这不如其他方法有效）。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T21:28:49.117

```
//function to add to your function definitions. 
function print_processed_html($string)
{ 
    $search  = Array("--", "*", "\*", "^", "\^");
    $replace = Array("<\hr>", "<b>", "<\b>", "<sup>", "<\sup>");

    $processed_string = str_replace($search, $replace , $string);

    echo $processed_string;
 }

// outputing the string to the page.
<?php 
      $the_content = get_the_content();
      print_processed_html($the_content);
?> 
```

还可以考虑阅读此[http://codex.wordpress.org/Function_Reference/the_content](http://codex.wordpress.org/Function_Reference/the_content)以获取有关使用该`the_content()`功能的一些提示

# sql - 酒店预订系统：用于查询的最佳 SQL 数据库结构

> ID：14883970
> 
> 赞同：3
> 
> 时间：2013-02-14T21:01:36.840
> 
> 标签：sql, design-patterns, database-design, software-design

我即将设计一个酒店预订系统。

每个酒店都分配了一些房间类型。

`RoomType: id | name | hotel_id`

`date_from`每家酒店都为特定时期（给定和`date_to`）提供一定数量的 RoomType 。`date_from`此外，每个客户都可以在指定时期（和`date_to`）内预订一定数量的某些房间类型。

我需要能够找到并显示给定酒店的可用优惠，了解每天每种 RoomType 的免费（提供 - 预订）房间数量，查询免费房间的最低数量等。

我想请教一下，**我应该如何保存数据**。什么解决方案是最优的？我知道除非我使用存储过程，否则使用简单的 SQL 查询无法实现某些查询（例如，显示给定范围内每天给定类型的空闲房间数）。但是，我想让它尽可能快速和易于实施。

到目前为止，我已经考虑过：

1.  `RoomOffer: hotel_id | date_from | date_to | quantity | room_type_id`与预订保持一致

2.  与`RoomOffer: hotel_id | date | quantity | room_type_id`Reservation 相同 - 即在创建 RoomOffer / Reservation 时，为给定范围内的每一天创建单个记录。

有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T14:17:16.833

我假设它`RoomType`指的是一个房间，并且每个房间的主键是 tuple `(hotel_id, room_type_id)`，因为您将这两个字段都用于`RoomOffer`.

但是，我不建议您采用`RoomOffer`and`Reservation`方法。首先，因为你存储了很多冗余信息：当一个房间还没有被预订时，你需要一个房间报价来说明它是可用的（或者更糟糕的是，因为你按时间范围划分了很多），你已经知道的东西。

取而代之的是，我建议使用与此更相似的设计：

![预订系统UML](../Images/2bd2bcb233687d40f9f74e9c9ea5c928.png)

从你的问题我知道你很关心系统的性能，但通常**这种在设计阶段的优化并不是一个好主意**。这样做可能会导致大量冗余数据和耦合类。但是，您可以使用索引甚至使用非 SQL 方法来提高数据库查询的性能。您可以在项目的后期阶段更好地评估这一点。

# sql - Oracle 错误，在数据库之间移动数据

> ID：14883973
> 
> 赞同：0
> 
> 时间：2013-02-14T21:01:47.727
> 
> 标签：sql, oracle, toad

我正在两个数据库之间移动一些数据并且取得了很大的成功，但是在执行与我一直在执行的相同类型的查询时遇到了问题。

查询：

```
INSERT INTO INTERNET.WEBSECURITY@crmtest SELECT * FROM INTERNET.WEBSECURITY; 
```

错误：

```
ORA-06502: PL/SQL: numeric or value error: character string buffer too small 
```

关于这可能是什么的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T21:07:35.580

您正在尝试为 plsql 变量分配一个值，该变量不够大或它的大小大于列数据类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T21:10:02.580

另外：为数字变量/列分配/插入非数字值。可能您的表列在数据类型和大小上有些不同。我在您的示例中看不到任何变量。

# heatmap - FusionTables 热图图层权重

> ID：14883975
> 
> 赞同：1
> 
> 时间：2013-02-14T21:01:44.890
> 
> 标签：heatmap, google-fusion-tables, weighted

`FusionTables`是否可以在热图图层中对结果进行加权？例如，在我的`FusionTable`数据集中，我有纬度、经度和计数。我不确定如何修改我的图层以按我的计数字段加权。

这是我的图层的片段：

```
layer1 = new google.maps.FusionTablesLayer({
    query: {
    select: "'col1'",
    from: 'xxxxxxxxxxxxxxxxxxxxxx'
    },
    heatmap: {
    enabled: true
    }
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T18:42:57.043

目前这对于 FusionTablesHeatMap 是不可能的。您可以使用来自 FusionTable 的数据并创建一个 HeatMap-Layer（支持加权位置），但当然这将取决于数据量是否可实现。

# sql - 高峰计划负荷

> ID：14883977
> 
> 赞同：1
> 
> 时间：2013-02-14T21:01:54.913
> 
> 标签：sql, oracle, oracle10g

我有一张桌子，可以跟踪车辆进出的时间表。

```
Table: Schedule
route  location    v_type    out                  in
===================================================================
a      loc1        10      2/14/2013 08:04:00   2/14/2013 10:03:00
b      loc1        11      2/14/2013 08:06:00   2/14/2013 14:20:00
c      loc2        11      2/14/2013 06:22:00   2/14/2013 07:50:00
d      loc1        10      2/14/2013 11:04:00   2/14/2013 10:03:00
e      loc2        10      2/14/2013 08:06:00   2/14/2013 14:20:00
f      loc2        11      2/14/2013 06:22:00   2/14/2013 07:50:00 
```

想象一下，每天有数千条路线。我正在尝试找出每个位置，以及 v_type 最多车辆在路上行驶的时间（或时间窗口）。

期望的结果，例如

```
location    v_type   time            peak
===========================================
loc1        10       2/14/2013 10:40 110
loc1        11       2/14/2013 10:30 80
loc2        10       2/14/2013 08:05 67
loc2        11       2/14/2013 09:45 107 
```

等等

基本思想是，您可以通过查找已离开的车辆总数并减去当天返回的车辆数量来查找任何时间点上道路上的车辆数量。

这是我到目前为止所拥有的，但它不能完全正确地工作，而且速度很慢。

```
SELECT s.location,
  s.v_type,
  TO_CHAR(TRUNC(s.out, 'mi') - mod(EXTRACT(minute FROM CAST(s.out AS TIMESTAMP)), 10) / (24 * 60), 'YYYY-MM-DD HH24:MI') AS TIME,
  (SELECT
    (SELECT COUNT(*)
     FROM SCHEDULE s2
     WHERE s2.out BETWEEN TRUNC(s.out) AND (TRUNC(s.out, 'mi') - mod(EXTRACT(minute  FROM CAST(s.out AS TIMESTAMP)), 10) / (24 * 60))
    )                                                          
    -
    (SELECT COUNT(*)
     FROM SCHEDULE s2
     WHERE s2.out BETWEEN TRUNC(s.in) AND (TRUNC(s.in, 'mi') - mod(EXTRACT(minute FROM CAST(s.in AS TIMESTAMP)), 10) / (24 * 60))
    )
 FROM dual
 )
 FROM SCHEDULE s
 GROUP BY s.location, s.v_type,
 (TRUNC(s.out, 'mi') - mod(EXTRACT(minute FROM CAST(s.out AS TIMESTAMP)), 10) / (24 * 60)) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T21:54:36.617

我会将其视为累积金额之间的差异：

```
select s.*
from (select s.*, (numout - numin) as onroad,
             row_number() over (partition by loc, vtype order by numout - numin desc) as seqnum
      from (select s.*,
                   (select count(*) from schedule s2 where s2.loc = s.loc and s2.vtype = s.vtype and s2.out <= s.out
                   ) as numout,
                   (select count(*) from schedule s2 where s2.loc = s.loc and s2.vtype = s.vtype and and s2.in <= s.out
                   ) as numin
            from schedule s
           ) s
     ) s
where seq = 1 
```

您也可以使用分析函数执行此操作，但相关子查询可能更容易编写。此外，你开始走这条路。

# java - Java删除转义的双引号

> ID：14883980
> 
> 赞同：5
> 
> 时间：2013-02-14T21:02:06.350
> 
> 标签：java, regex

我有一个很长的 Java 字符串，其中包含许多转义的双引号：

```
// Prints: \"Hello my name is Sam.\" \"And I am a good boy.\"
System.out.println(bigString); 
```

我想删除所有转义的双引号 ( `\"`) 并用正常的双引号 ( ) 替换它们，`"`以便我得到：

```
// Prints: "Hello my name is Sam." "And I am a good boy."
System.out.println(bigString); 
```

我以为这是不费吹灰之力。我最好的尝试：

```
bigString = bigString.replaceAll("\\", ""); 
```

引发以下异常：

> 索引 1 附近出现意外内部错误

有任何想法吗？提前致谢。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-14T21:11:08.853

每个人都在告诉你使用`replaceAll`，更好的答案是真正使用`replace`。

`replaceAll`- 需要正则表达式

`replace`[[javadoc]](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#replace%28java.lang.CharSequence,%20java.lang.CharSequence%29) - 只是一个字符串搜索和替换

所以像这样：

`bigString = bigString.replace("\\\"", "\"");`

请注意，这也更快，因为不需要正则表达式。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-14T21:03:35.993

替换所有使用正则表达式，所以添加另一组`\\`

```
bigString = bigString.replaceAll("\\\\\"", "\""); 
```

解释原因：“\”被 java 解释为普通的`\`. 但是，如果您只在参数中使用它，它就会变成正则表达式`\`。`\`正则表达式中的A转义下一个字符。由于没有找到，它会引发异常。

当您用 Java 编写时`"\\\\\""`，它首先被 java 视为正则表达式`\\"`。然后正则表达式实现将其视为“反斜杠后跟双引号”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-14T21:04:21.060

```
 String str="\"Hello my name is Sam.\" \"And I am a good boy.\"";
  System.out.println(str.replaceAll("\\\"", "\"")); 
```

输出：

```
 "Hello my name is Sam." "And I am a good boy." 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-14T21:05:19.140

replaceAll 的第一个参数是一个正则表达式。您通过 \ 这不是有效的正则表达式。尝试：

```
bigString.replaceAll("\\\\", ""); 
```

# types - (sml/nj) 正确的类型？

> ID：14883981
> 
> 赞同：0
> 
> 时间：2013-02-14T21:02:16.320
> 
> 标签：types, functional-programming, sml

对于我的任务，我必须使用以下类型执行两个功能：

```
 wt: trie -> (char list list -> ’a)-> ’a
 aw: trie list -> (char list list -> ’a)-> ’a 
```

但我所拥有的是这个并且想知道它是否是同一件事：

```
 wt: 'a trie -> ('a list list -> ’a list list)-> ’a list list 
 aw: 'a trie list -> ('a list list -> ’a list list)-> ’a list list 
```

这是我的功能：

```
datatype ’a trie = Node of ’a * (’a trie) list | Empty

fun words_in_trie Empty cont = cont [[]]
    | words_in_trie (Node (c, lis)) cont = all_words lis (fn j => map (fn y => [c]@y) j) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T22:43:46.663

不，那些不一样。对于它们中的每一个，请查看第二个参数，即函数。你的任务说：

```
char list list -> 'a 
```

你的版本说：

```
'a list list -> ’a list list 
```

好的，让我们假设在您的函数中，`'a`是`char`. 这意味着我们可以将其重写为

```
char list list -> char list list 
```

这与作业所说的不同。当然，`'a`作业*中*的 理论上可以是 a `char list list`，但是当它被指定为 时`'a`，这可能意味着你的老师希望它是通用的。

# sql-server - 更新 SQL Server 的语法

> ID：14883988
> 
> 赞同：-1
> 
> 时间：2013-02-14T21:03:00.770
> 
> 标签：sql-server, sql-update

我有一个表，其中包含以下列 Job、Group、Desc、NGNT、2010、2011 我在表中添加了 Current Wages 列，我需要此列中的数据等于 2011 列数据，我知道我必须使用 UPDATE 查询，但我无法弄清楚语法

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T21:05:59.990

这应该这样做

```
update Table
set [Current Wages] = [2011] 
```

您当然可以改用计算列或将 2011 列别名为 Current Wages 的视图

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T21:06:06.527

这应该这样做：

```
UPDATE table
SET [Current Wages] = [2011] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-14T21:06:30.397

更新表集 [当前工资]= [2011]

# uitableview - 单击 UIAlertView 按钮时更改视图

> ID：14883989
> 
> 赞同：2
> 
> 时间：2013-02-14T21:03:04.170
> 
> 标签：uitableview, ios6, hyperlink, uialertview

我有一个以 TableView 开头的测验程序，然后在选择测验时移动到第二个视图。在第二个视图中，顶部有一个导航栏，带有一个返回按钮，可将您带回 tableView。当用户单击 UIAlertView 上的按钮时，我想完成相同的操作，该按钮在每个测验结束时显示他们的最终分数。任何人都可以帮我解决这个问题，或者指导我学习教程吗？这是我的第一个多视图应用程序。

```
-(void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex {
NSString *buttonTitle = [alertView buttonTitleAtIndex:buttonIndex];
if (alertView.tag == 5) {
    if ([buttonTitle isEqualToString:@"Main Menu"]) {
        KHQuizViewController *vc = [[KHQuizViewController alloc] initWithNibName:@"KHViewController" bundle:nil];

        [self.navigationController pushViewController:vc animated:YES];
        [vc release];
    }
} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T22:29:52.877

不要尝试推送主菜单的新实例，只需使用以下行弹回根视图：

```
[self.navigationController popToRootViewControllerAnimated:YES] 
```

此信息由[Apple IOS 开发人员库在此处](https://developer.apple.com/library/ios/#documentation/UIKit/Reference/UINavigationController_Class/Reference/Reference.html#//apple_ref/occ/cl/UINavigationController)提供。

在您的`alertView`选择器的上下文中：

```
-(void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex {
    NSString *buttonTitle = [alertView buttonTitleAtIndex:buttonIndex];
    if (alertView.tag == 5) {
        if ([buttonTitle isEqualToString:@"Main Menu"]) {
            [self.navigationController popToRootViewControllerAnimated:YES];        
        }
    }
} 
```

# git - 在 Xcode 项目中包含 RestKit，将所有更改推送到 Git 远程存储库，克隆到另一台计算机

> ID：14883997
> 
> 赞同：0
> 
> 时间：2013-02-14T21:03:41.797
> 
> 标签：git, clone, xcode4.5, restkit, git-submodules

在我的 Xcode 项目中使用 RestKit，尝试学习如何使用我的远程 git 存储库与朋友分享。还希望能够不时拉出对 RestKit 的最新更改。

*这是我认为它会起作用的方式：*

我假设我可以创建一个项目，将 RestKit 作为子模块添加到其中，并将所有这些更改推送到远程 git 服务器。然后我的朋友可以简单地克隆我的项目，RestKit 已经包含在一个子模块中，就像我在本地存储库中设置它一样。

*这是我尝试过的：*

1.  在 Xcode 中：创建了一个新项目（称为 testRestKit）并包含“为此项目创建本地 git 存储库”的选项。

2.  将 RestKit 添加为子模块，如此处所示[。](https://github.com/RestKit/RestKit/wiki/Installing-RestKit-v0.20.x-as-a-Git-Submodule)

3.  在远程服务器上：创建了一个名为“remoteRepo_RestKitTest”的新远程仓库作为 --bare --shared=all。

4.  在 Xcode 中：File > Source Control > Commit（提交 Xcode 想要的更改）。

5.  在 Xcode 中：File > Source Control > Push：出现一个弹出菜单，显示三个工作副本，如下所示：

> 工作副本：AFNetworking (.../testRestKit/RestKit/Vendor/AFNetworking) 远程：remoteRepo_RestKitTest/(无分支)(创建)
> 
> 工作副本：RestKit (.../testRestKit/RestKit) 远程：remoteRepo_RestKitTest/development（创建）
> 
> 工作副本：testRestKit (.../testRestKit) 远程：remoteRepo_RestKitTest/master

*以下是我尝试将所有更改推送到远程存储库的错误：*

> 推
> 
> 致命：“remoteRepo_RestKitTest”似乎不是 git 存储库
> 
> 致命：无法从远程存储库中读取。
> 
> 请确保您拥有正确的访问权限
> 
> 并且存储库存在。
> 
> 推
> 
> 致命：refspec 的远程部分不是（无分支）中的有效名称：（无分支）_

*问题：*

将 RestKit（作为子模块）添加到 Xcode 项目、将所有更改推送到我的远程存储库并允许我的朋友克隆该项目并让它自动包含 RestKit 的正确方法是什么？

（我已经研究并找到了相关的帖子[here](https://stackoverflow.com/questions/12024345/not-a-git-repository-error-when-trying-to-add-restkit-to-my-repository)、[here](https://github.com/RestKit/RestKit/wiki/Installing-RestKit-v0.20.x-as-a-Git-Submodule)、[here](https://stackoverflow.com/questions/3488667/git-remote-repository-with-files)和[here](https://stackoverflow.com/questions/13875291/git-confusion-with-restkit)。它们都包含有用的信息，甚至可能包含确切的命令，但不清楚它们需要在哪些机器上运行，或按什么顺序。我只需要以简洁、有用的方式将其组合在一起即可。谢谢！