# StackOverflow 问答 13348000-13348999

# node.js - node.js 的二进制序列化框架或库

> ID：13348000
> 
> 赞同：5
> 
> 时间：2012-11-12T17:00:48.557
> 
> 标签：node.js, serialization, frameworks, libraries

我有兴趣找出用于 node.js 的二进制序列化框架/库。

我尝试使用 Apache Thrift，但是文档很差，并且没有提供这方面的任何示例。

有谁知道任何替代方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-09-26T15:39:35.057

[Google 的ProtoBuf](https://developers.google.com/protocol-buffers/docs/overview)怎么样？

[这](https://github.com/dcodeIO/ProtoBuf.js)是一个可用的 JS 端口`npm`。

有关的：

[Google 协议缓冲区 - JavaScript](https://stackoverflow.com/questions/6912981/google-protocol-buffers-javascript)

# c++ - 将主类传递给其他类，以便它们可以访问其功能

> ID：13348002
> 
> 赞同：2
> 
> 时间：2012-11-12T17:00:58.830
> 
> 标签：c++, class, main

所以我需要我的对象能够使用主类中的函数，所以当它们被创建时，我希望它们通过它们的参数来获取它。

```
int main(int argc, char* args[])
    {
    Unit units[3]={{5,5,this},{8,8,this},{12,12,this}};
    units[0].init(true);
    for (int i=1;i<sizeof(units) / sizeof(units[0]);i++) {
        units[i].init(false);
    } 
```

我把“this”放在哪里应该是主类，这就是我在java中的做法，但我不确定如何在这里做。我尝试了“*this”和“this”，但我得到的只是一个错误：在非成员函数中无效使用“this”。由于我对 c++ 的类系统一无所知，因此搜索错误并没有给我任何帮助。

前两个参数用于位置。Init 命令参数设置它们是否是盟友。

我希望 Unit 类能够访问：

```
int getClosestHostileX(int ask_x,int ask_y,bool team) {
    return 55;
} 
```

以后这里应该有更多代码，我只是想让它们返回。

我正在使用 Code::Blocks IDE 和 GNU GCC 编译器。

TL;DR 如何让我的其他类从我的主类访问函数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T17:02:12.590

在 C++ 中，`main`不是类，也不是类的一部分，因此`this`在其上下文中没有意义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T17:05:17.870

你也不能在 Java 中做到这一点。在 Java 中，入口点是一个静态方法并且没有关联的对象实例。

解决方案是一样的——实例化你的类型。

```
int main(int argc, char** argv)
{
   MainClass main_object; // creates an instance
   Unit units[3]={{5,5,&main_object},{8,8,&main_object},{12,12,&main_object}};
   units[0].init(true);
   for (int i=1;i<sizeof(units) / sizeof(units[0]);i++) {
      units[i].init(false);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T17:04:16.053

c++ 不像 java。您不需要在一个类中包含所有方法（或在 c++ 中调用的函数）。

`main`是一个函数，而不是一个类。没有`this`

现在您可以拥有全局变量，或者您可以将变量/对象放在堆上，以便其他类能够使用，但一般来说，c# 实际上并没有 Main 类。

# oracle - oracle 弱类型记录作为参数

> ID：13348007
> 
> 赞同：1
> 
> 时间：2012-11-12T17:01:07.293
> 
> 标签：oracle, parameters, record

假设我在 PLSQL 过程中有这个结构：

```
...
for rec in
  (
  select a, b, c from t;
  )
loop
  process_record(rec);
end loop;
...

procedure process_record(p_rec in ???)
... 
```

如何将作为弱类型游标记录的rec 传递给过程进行处理。我不想为这种类型的记录定义游标和类型。这可能吗？

TIA 金牌

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T17:32:26.400

您必须定义一个游标或一个类型（两者都不需要）才能告诉 oracle 输入的结构（除非您想沿着路线走或定义 AnyData/AnyType 方法。

例如

```
declare
  cursor my_template
  is
    select a,b,c from t;

  procedure process_record(p_rec in my_template%rowtype)
      is
  begin
   null;
  end;
begin
for rec in
  (
  select a, b, c from t
  )
loop
  process_record(rec);
end loop;
end;
/ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T17:32:36.260

我不知道一个简单的方法（并且会很惊讶地看到一个），但我有一个解决方法：

使用 XMLType 作为您的类型：

```
declare

begin
  for rec in (select xmlelement("p_rec", xmlforest(a, b, c)) r from t) loop
    process_record(rec.r);
  end loop;
end; 
```

...

```
create or replace procedure process_record(p_rec in XMLtype) as

BEGIN
dbms_output.put(p_rec.extract('//A/text()').getstringval() || ',');
dbms_output.put(p_rec.extract('//B/text()').getstringval() || ',');
dbms_output.put_line(p_rec.extract('//C/text()').getstringval());
END; 
```

顺便说一句，你为什么要这样做？

# c# - OpenXML 内存泄漏

> ID：13348010
> 
> 赞同：0
> 
> 时间：2012-11-12T17:01:16.383
> 
> 标签：c#, memory-leaks, openxml

我使用 OpenXML 将数据表导出到 Excel 文件。

例如，我使用一个包含大约 250,000 行和大约 10 列的表。将其导出到 Excel 时，需要大约 1.2 GB 的内存，并且有时会抛出`OutOfMemoryException`.

我的问题有什么解决办法吗？

这是我的代码

```
 ExcelDocument excelDocument = new ExcelDocument();
        excelDocument.CreatePackage(exportFile);

        //populate the data into the spreadsheet
        using (SpreadsheetDocument spreadsheet =
            SpreadsheetDocument.Open(exportFile, true))
        {
            WorkbookPart workbook = spreadsheet.WorkbookPart;
            //create a reference to Sheet1
            WorksheetPart worksheet = workbook.WorksheetParts.Last();
            SheetData data = worksheet.Worksheet.GetFirstChild<SheetData>();

            //add column names to the first row
            Row header = new Row();
            header.RowIndex = (UInt32) 5;

            foreach (DataColumn column in table.Columns)
            {
                Stylesheet styleSheet = workbook.WorkbookStylesPart.Stylesheet;

                //build the formatted header style
                UInt32Value headerFontIndex =
                    createFont(
                        styleSheet,
                        "Arial",
                        9,
                        true,
                        System.Drawing.Color.White);
                //set the background color style
                UInt32Value headerFillIndex =
                    createFill(
                        styleSheet,
                        System.Drawing.Color.SlateGray);
                //create the cell style by combining font/background
                UInt32Value headerStyleIndex =
                    createCellFormat(
                        styleSheet,
                        headerFontIndex,
                        headerFillIndex,
                        null);
                Cell headerCell = createTextCell(
                    table.Columns.IndexOf(column) + 1,
                    5,
                    column.ColumnName, headerStyleIndex);

                header.AppendChild(headerCell);
            }
            data.AppendChild(header);

            //loop through each data row
            DataRow contentRow;
            for (int i = 0; i < table.Rows.Count; i++)
            {
                contentRow = table.Rows[i];
                data.AppendChild(createContentRow(contentRow, i + 6));
            }
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T08:13:24.857

问题是在处理 SpreadsheetDocument 时花费了太多时间，似乎在处理时它会将所有数据刷新到 excel 表中，所以我吐出了创建的 excel 表，每个文件只生成 30,000 条记录，并强制垃圾收集器运行并解决了我的问题问题

# java - ORA-12705 使用“空”默认语言环境和驱动程序 10.2.0.4

> ID：13348011
> 
> 赞同：0
> 
> 时间：2012-11-12T17:01:16.837
> 
> 标签：java, oracle, driver, locale, ora-12705

我刚刚发现，当 Locale 设置为空字符串时，使用 JDBC Thin 驱动程序版本 10.2.0.4 创建与 Oracle 的连接失败，例如：

```
Locale.setDefault(new Locale("",""));
DriverManager.registerDriver (new oracle.jdbc.driver.OracleDriver());
con = DriverManager.getConnection(url, userName, password); 
```

上面的代码会产生 ORA-12705: Cannot access NLS data files or invalid environment specified。如果我指定 en US 或仅指定 en，它工作正常。

但是，如果我使用 Oracle 驱动程序 9.2.0.1，则这段代码可以正常工作：NLS 设置为 AMERICAN。

我的问题是：这是正常的、记录在案的行为变化吗？也许将默认语言环境设置为空字符串是一种不好的做法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T23:00:45.147

如果您可以访问 oracle 支持，注释 115001.1 似乎说明从 10g 开始有一些变化：

> 9i 厚 JDBC (=OCI) 驱动程序将利用 NLS_LANG 来确定如何转换字符。不定义 NLS_LANG 将使它使用默认的 US7ASCII 设置，来自/到数据库的任何非 ASCII 数据都将丢失。
> 
> 您无需为 Java 代码指定任何内容，以便 JDBC 获取 NLS_LANG。
> 
> 从 10g 开始，Thick JDBC 驱动程序忽略 NLS_LANG 并使用 JVM 语言环境中的语言、区域和字符集设置。
> 
> 在 11g 中，属性 -Doracle.jdbc.ociNlsLangBackwardCompatible=true 可在命令上设置。如果设置它会导致 JDBC 从 NLS_LANG 获取字符集，而不是从语言环境获取客户端字符集 ID。
> 
> 不管属性如何，语言和领土都取自当地。

# asp.net-mvc - ASP.NET MVC 3 - Guid 验证

> ID：13348012
> 
> 赞同：2
> 
> 时间：2012-11-12T17:01:21.690
> 
> 标签：asp.net-mvc

我在提交表单时检查 Guid 是否为空。

```
public class NotAttribute : ValidationAttribute
    {
        protected override ValidationResult IsValid(object value, ValidationContext validationContext)
        {
            if (value != null)
            {
                if ((Guid) value == Guid.Empty)
                {
                    return new ValidationResult("You must add an image before saving!!!!");
                }
            }

            return null;
        }
    } 
```

HTML：

```
@Html.HiddenFor(m => Model.ImageContentGuid)
@Html.ValidationMessageFor(m => Model.ImageContentGuid, "You must upload an image before saving.") 
```

当用户上传图像时，从控制器生成隐藏的 Guid。如果没有上传图像，则*不会*生成Guid 。

逻辑有效，但不会弹出错误消息。此外，代码继续执行，并且我的程序因 NullReference 而崩溃，因为它应该被拖拽。

谁能帮我这个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T17:06:34.180

Guid.Empty 与 null 不同。Guid.Empty 用 0 填充。Guid 是一种值类型，这意味着它不能为空。但是，您收到一个可以为空的对象，将 GUID 转换为对象会创建所谓的装箱值，使其成为引用类型。

所以你需要先验证它不为空，然后与空进行比较。

# javascript - 在不打开下载对话框的情况下下载文件

> ID：13348013
> 
> 赞同：-1
> 
> 时间：2012-11-12T17:01:32.863
> 
> 标签：javascript, servlets, browser

# 问题：

在下载过程中，我需要强制下载对话框不要在浏览器中打开：

我拥有像任何其他下载*servlet一样的服务器**代码*。 在客户端，我有一个指向*servlet的**链接*，就像任何其他下载*链接*一样。

 ***有没有办法在点击链接而不打开对话框时自动下载？

我认为它可能与以下内容有关：

1.  服务器代码（*Java*）？
2.  客户端代码（*JavaScript*）？
3.  浏览器设置？
4.  浏览器类型？

# 这背后的目的：

有一个属于该公司的网站，该网站设有高安全墙，清除了下载任何病毒的机会。

本站客户端需要点击后自动保存下载链接。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T17:09:22.097

不，您不能在不通知*用户*的情况下从*浏览器与**HDD*上的文件进行交互。这是一个安全策略。

 *** * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-12T17:08:47.913

如果我理解得很好，您希望浏览器将您的文件下载到默认文件夹而不询问您在哪里？

好吧，我认为，这取决于您的浏览器，也许您可​​以自定义配置以设置默认下载文件夹，但是，我认为不可能在服务器端强制它。*****

# c# - 是否可以从控制台应用程序加载 web-config？

> ID：13348016
> 
> 赞同：5
> 
> 时间：2012-11-12T17:01:39.767
> 
> 标签：c#, web-applications, configuration, console-application

我的问题很简单。我有一个第三方库，它假定它将在网站中使用（需要 web.config 中的特殊配置部分）。我想在 C# 控制台应用程序中使用这个库。有可能的？

我已经尝试过 `WebConfigurationManager.OpenWebConfiguration();` ，也只是将所有内容复制到 app.config 中，但它不起作用。我收到的错误是 ConfigurationErrorsException 说明 `An error occurred creating the configuration section handler for ...: Could not load type 'Configuration.RenderingSection' from assembly 'System.Configuration, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a'.`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-06-25T21:24:23.863

您可以通过[AppDomain.CurrentDomain.SetData(string name, Object data)设置](http://msdn.microsoft.com/en-us/library/37z40s1c%28v=vs.110%29.aspx)[APP_CONFIG_FILE](http://msdn.microsoft.com/en-us/library/system.appdomain.getdata%28v=vs.110%29.aspx)。

```
string webconfigPath = "whatever......../web.config");
string webconfigDir = Path.GetDirectoryName(configPath);

AppDomain.CurrentDomain.SetData("APPBASE", webconfigDir);
AppDomain.CurrentDomain.SetData("APP_CONFIG_FILE", webconfigPath); 
```

这很容易，您将获得控制台应用程序 (cron) 和 Web 应用程序的相同设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T17:05:55.850

改为使用`app.config`。

与 web.config 完全相同的语法、选项等，但用于控制台和 WinForms 应用程序。

另外，看[这里](https://stackoverflow.com/questions/513410/open-web-config-from-console-application)，虽然我还没有测试过，但它似乎对这个人有用。但是，如果您的项目与 web 无关，我仍然建议使用 app.config。

# android - 出现错误 - java.lang.UnsupportedOperationException

> ID：13348019
> 
> 赞同：1
> 
> 时间：2012-11-12T17:01:46.377
> 
> 标签：android, arrays, string, listview

我已经编写了一些代码来`listview`从网页设置数据。我已成功阅读网页并将必要的数据存储在`String`数组中。现在我想将其分配给`ListView`using`ArrayAdapter`但数据未设置在`listview`. 请帮我解决错误：

**完整的日志猫**

```
11-07 23:41:40.150: E/AndroidRuntime(3400): FATAL EXCEPTION: main
11-07 23:41:40.150: E/AndroidRuntime(3400): java.lang.UnsupportedOperationException
11-07 23:41:40.150: E/AndroidRuntime(3400):     at java.util.AbstractList.add(AbstractList.java:411)
11-07 23:41:40.150: E/AndroidRuntime(3400):     at java.util.AbstractList.add(AbstractList.java:432)
11-07 23:41:40.150: E/AndroidRuntime(3400):     at android.widget.ArrayAdapter.add(ArrayAdapter.java:178)
11-07 23:41:40.150: E/AndroidRuntime(3400):     at com.air.test.Smscollection$sendMessageAsync.onPostExecute(Smscollection.java:91)
11-07 23:41:40.150: E/AndroidRuntime(3400):     at com.air.test.Smscollection$sendMessageAsync.onPostExecute(Smscollection.java:1)
11-07 23:41:40.150: E/AndroidRuntime(3400):     at android.os.AsyncTask.finish(AsyncTask.java:417)
11-07 23:41:40.150: E/AndroidRuntime(3400):     at android.os.AsyncTask.access$300(AsyncTask.java:127)
11-07 23:41:40.150: E/AndroidRuntime(3400):     at android.os.AsyncTask$InternalHandler.handleMessage(AsyncTask.java:429)
11-07 23:41:40.150: E/AndroidRuntime(3400):     at android.os.Handler.dispatchMessage(Handler.java:99)
11-07 23:41:40.150: E/AndroidRuntime(3400):     at android.os.Looper.loop(Looper.java:130)
11-07 23:41:40.150: E/AndroidRuntime(3400):     at android.app.ActivityThread.main(ActivityThread.java:3683)
11-07 23:41:40.150: E/AndroidRuntime(3400):     at java.lang.reflect.Method.invokeNative(Native Method)
11-07 23:41:40.150: E/AndroidRuntime(3400):     at  java.lang.reflect.Method.invoke(Method.java:507)
11-07 23:41:40.150: E/AndroidRuntime(3400):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
11-07 23:41:40.150: E/AndroidRuntime(3400):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
11-07 23:41:40.150: E/AndroidRuntime(3400):     at dalvik.system.NativeStart.main(Native Method) 
```

logcat 的输出，以验证数据是否存储在`String array`

```
11-07 23:03:47.640: I/NEW VAUES(3192): Happiness is Like a Butterfly, You run after it, It keeps flying away. But if you stand still, It comes and Sits On You Wish you lots of Butterflies
11-07 23:03:47.640: I/NEW VAUES(3192): Happiness is Like a Butterfly, You run after it, It keeps flying away. But if you stand still, It comes and Sits On You Wish you lots of Butterfly
11-07 23:03:47.640: I/NEW VAUES(3192): Happiness is Like a Butterfly, You run after it, It keeps flying away. But if you stand still, It comes and Sits On You Wish you lots of Butterfies
11-07 23:03:47.640: I/NEW VAUES(3192): Happiness is Like a Butterfly, You run after it, It keeps flying away. But if you stand still, It comes and Sits On You Wish you lots of Butterfly
11-07 23:03:47.640: I/NEW VAUES(3192): Happiness is Like a Butterfly, You run after it, It keeps flying away. But if you stand still, It comes and Sits On You Wish you lots of Butterflies
11-07 23:03:47.640: I/VALUES(3192): Happiness is Like a Butterfly, You run after it, It keeps flying away. But if you stand still, It comes and Sits On You Wish you lots of Butterflies<br/>Happiness is Like a Butterfly, You run after it, It keeps flying away. But if you stand still, It comes and Sits On You Wish you lots of Butterfly<br/>Happiness is Like a Butterfly, You run after it, It keeps flying away. But if you stand still, It comes and Sits On You Wish you lots of Butterfies<br/>Happiness is Like a Butterfly, You run after it, It keeps flying away. But if you stand still, It comes and Sits On You Wish you lots of Butterfly<br/>Happiness is Like a Butterfly, You run after it, It keeps flying away. But if you stand still, It comes and Sits On You Wish you lots of Butterflies 
```

**代码**

```
public class Smscollection extends Activity {

private Spinner spinner1;
private ProgressDialog pd;
private StringBuilder response;
private ListView listView;
private String[] values = new String[0];
private ArrayAdapter<String> adapter;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_smscollection);
    listView = (ListView) findViewById(R.id.mylist);
    spinner1 = (Spinner) findViewById(R.id.spinnerCategory);
    spinner1.setOnItemSelectedListener(new OnItemSelectedListener() {

        public void onItemSelected(AdapterView<?> av, View view, int id,
                long ids) {
            new sendMessageAsync().execute();
        }

        public void onNothingSelected(AdapterView<?> av) {
        }
    });

    adapter = new ArrayAdapter<String>(this,
            android.R.layout.simple_list_item_1, android.R.id.text1, values);
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_smscollection, menu);
    return true;
}

private class sendMessageAsync extends AsyncTask<Void, Void, String> {

    @Override
    protected void onPreExecute() {
        pd = ProgressDialog.show(Smscollection.this, null, "Loading...",
                true, true);
    }

    @Override
    protected void onCancelled() {
        Toast.makeText(getApplicationContext(),
                "Message Sending Cancelled", Toast.LENGTH_LONG).show();
    }

    @Override
    protected String doInBackground(Void... arg0) {
        try {
            return doInBg();
        } catch (Exception ex) {
            ex.printStackTrace();
        }
        return null;
    }

    @Override
    protected void onPostExecute(String result) {
        pd.dismiss();
        if (result == null) {
            // request failed!
            // return;
        }
        values = String.valueOf(result).split("<br/>");
        adapter.clear();
        for (String str : values) {
            adapter.add(str);
        }
        adapter.notifyDataSetChanged();
        listView.setAdapter(adapter);
    }
}

public String doInBg() {
    String responseRes = null;
    try {
        final String msgURL = "http://freesmsit.tk/msg/messages.php?category="
                + String.valueOf(spinner1.getSelectedItem().toString()
                        .replace(" ", "%20"));
        URLConnection connection = new URL(msgURL).openConnection();
        connection.setRequestProperty("Accept-Charset", "UTF-8");
        InputStream responseStream = connection.getInputStream();
        BufferedReader br = new BufferedReader(new InputStreamReader(responseStream));
        response = new StringBuilder();
        String line;
        while ((line = br.readLine()) != null) {
            response.append(line);
        }
        responseRes = response.toString();
    } catch (Exception ex) {
        ex.printStackTrace();
    }
    return responseRes;
}
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-12T17:28:47.973

如果您使用 an`array`作为该数组的数据，则`ArrayAdapter`该数组将被转换为未实现and方法的特殊`ArrayList`（不是来自平台的普通数组）（您只能修改该列表中已经存在的项目）。因此，当您尝试使用该方法将项目添加到适配器时，应用程序将失败并出现您看到的异常。`add``remove``add`

解决方案是用a替换`values`您在 中使用的数组，例如（普通的）。`ArrayAdapter``List``ArrayList`

```
private ArrayList<String> values = new ArrayList<String>(); 
```

然后修改其余代码以使用列表而不是数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T17:05:04.587

这应该有效：

```
ArrayAdapter<String> adapter = new ArrayAdapter<String>(this,
                android.R.layout.simple_list_item_1, values);

    listView.setAdapter(adapter); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-03T12:01:36.310

**您正在使用适配器非泛型数组 - String[]**

涉及通用 List 接口方法（添加、删除、清除）的适配器上的任何操作都将失败**

```
private String[] values = new String[0];

adapter = new ArrayAdapter<String>(this,
        android.R.layout.simple_list_item_1, android.R.id.text1, values); 
```

所以：

**解决方案1：**

*   在代码中使用 Arrays.asList([])：

    ```
    adapter = new ArrayAdapter<String>(this,
        android.R.layout.simple_list_item_1, android.R.id.text1, Arrays.asList(values)); 
    ```

**解决方案2：**

*   使用新的数组初始化（构造函数）：

    ```
    List<String> valuesAsArray = newArrayList<String>(values); 
    ```

**解决方案3：**

*   将您的“值变量”声明为实现 List 接口的变量

    ```
    List<String> values = new ArrayList<>(); 
    ```

# visual-studio-2012 - 如何在 Visual Studio 11 / 2012 中突出显示文本中出现的搜索词？

> ID：13348020
> 
> 赞同：1
> 
> 时间：2012-11-12T17:01:48.290
> 
> 标签：visual-studio-2012

如何在 Visual Studio 11 / 2012 中突出显示文本中出现的搜索词？VS 2010 和 2008 中有解决方案，有人知道 VS2012 的解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-17T00:18:44.543

解决方案中提到的修复方法是然后下载 SelectionHighlight.vsix 文件。

1.  将扩展名更改为 .zip
2.  打开 zip 文件并在文本编辑器中编辑清单文件。
3.  将 Visual Studio 版本属性更改为 11。
4.  将文件保存回 zip 后，将扩展名更改回 .vsix

只需继续安装文件即可。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T17:01:48.290

好的...刚刚检查了 VS2010 的插件，他们有 2012 年的“修复”。在此处检查 Q 和 A：http: [//visualstudiogallery.msdn.microsoft.com/4b92b6ad-f563-4705-8f7b-7f85ba3cc6bb](http://visualstudiogallery.msdn.microsoft.com/4b92b6ad-f563-4705-8f7b-7f85ba3cc6bb)

# c# - 确定 NetworkStream 是否已完成读取

> ID：13348022
> 
> 赞同：-1
> 
> 时间：2012-11-12T17:01:56.973
> 
> 标签：c#, networkstream

我正在进行一个与第三方应用程序集成的项目。该第三方使用本地（环回地址）TCP 侦听器来处理请求，并使用 XML 数据进行响应。在 XML 之前没有发送大小标头：传输只是用 \r\n 转义序列关闭。以下是我想出来处理这个问题：

```
byte[] buffer = new buffer[DefaultBufferSize];

do
{
    bytesRead = networkStream.Read(buffer, 0, buffer.Length);
    string response = Encoding.UTF8.GetString(buffer, 0, bytesRead);

    if (response.EndsWith("\r\n"))
    {
        isReading = false;
    }
} while (isReading); 
```

现在，这里的主要问题是，虽然大部分 XML 数据都被转义了，但换行符却没有。所以，我可能会读取一段数据，最后两个字符可能会与终止序列匹配。

有什么办法可以解决这个问题，还是我需要向第三方提出错误请求？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T17:16:58.387

您很幸运拥有一个 XML 文档。XML 文档有一个根节点，当您找到根节点的末尾时，您的文档就完成了。您可以通过尝试使用 解析您的响应来检查您的文档是否格式正确[`XDocument.Parse`](http://msdn.microsoft.com/en-us/library/bb345532.aspx)。如果您没有收到任何异常，则您的回复包含格式良好的文档，因此会被完全接收。

重复调用 XDocument.Parse 效率不是很高，但如果它对您的目的来说足够好，您就有一个简单的实现。

# php - 使用正则表达式从网站的 HTML 源中提取内容

> ID：13348024
> 
> 赞同：3
> 
> 时间：2012-11-12T17:02:01.673
> 
> 标签：php, regex, html-parsing

我有以下代码正在尝试修复。

编码：

```
$pageData = file_get_contents('111234-2.html');
if(preg_match_all('/<a\s+onclick=["\']([^"\']+)["\']/i', $pageData, $links, PREG_PATTERN_ORDER))
     print_r(array_unique($links[1]));
return false; 
```

我希望从中获取的一些示例 HTML：

```
 <a onclick="doShowCHys=1;ShowWindowN(0,'http://www.example.com/home/Player.aspx?lpk4=116031&amp;playChapter=False',960,540,111234);return false;" href="javascript:void(0);">
<span class="vt">Welcome

        </span>
        <span class="dur">1m 10s</span>
        <span class="" id="bkmimgview-116031">&nbsp;</span>
        <br class="clear">
    </a> 
```

我得到的输出：

```
Array ( [0] => doShowCHys=1;ShowWindowN(0, ) 
```

我希望的输出：

```
Array ( [0] => doShowCHys=1;ShowWindowN(0,'http://www.example.com/home/Player.aspx?lpk4=116031&amp;playChapter=False',960,540,111234);return false;) 
```

我如何实现这一目标？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-12T17:08:36.433

您可以使用反向引用来改进这一点，但如果有更多级别的嵌套引号，您几乎注定要失败。

```
'/<a\s+onclick=(["\'])((?:(?!\1).)+)\1/i' 
```

反向引用可让您引用已捕获的组。因此，如果您`"`在第一次捕获中捕获 a，那么您想要找到一串非`"`s，同样，如果您`'`在第一次捕获中捕获到 a，那么您想要找到一串非`'`s，无论哪种方式最终得到相同的报价，`"`或`'`分别。

**编辑：**

@vladr 提供了一个更好的选择：

```
'/<a\s+onclick=(["\'])(.*?)\1/i' 
```

相同的想法，但非贪婪的量词使得没有必要测试每个字符的非引用性。更新了 Rubular 链接：[http](http://rubular.com/r/VXR1nQ4zf5) ://rubular.com/r/VXR1nQ4zf5 。

# javascript - Android 2.3 浏览器中 document.readyState 的值？

> ID：13348029
> 
> 赞同：3
> 
> 时间：2012-11-12T17:02:18.197
> 
> 标签：javascript, html, dom, android-browser

我发现一旦加载了文档，那么在 Android 2.3.5 浏览器中， 的值`document.readyState`是`"loaded"`而不是[标准的`"interactive"`](http://www.whatwg.org/specs/web-apps/current-work/multipage/dom.html#current-document-readiness).

`document.readyState`Android 2.3 浏览器记录的可能值在哪里？

# python - 绑定和未绑定方法对象的 id() --- 有时不同对象相同，有时相同对象不同

> ID：13348031
> 
> 赞同：31
> 
> 时间：2012-11-12T17:02:23.043
> 
> 标签：python, object, methods

我尝试了一些关于绑定和非绑定方法的代码。当我们调用它们时，我认为它们都会返回对象。但是当我`id()`用于获取一些信息时，它会返回一些我不明白的东西。

IDE：日食

插件：pydev

```
Class C(object):
    def foo(self):
        pass

cobj = C()

print id(C.foo)    #1
print id(cobj.foo) #2

a = C.foo
b = cobj.foo

print id(a)        #3
print id(b)        #4 
```

输出是...

```
5671672

5671672

5671672

5669368 
```

为什么 #1 和 #2 返回相同的 id？它们不是不同的对象吗？如果我们将`C.foo`and分配`conj.foo`给两个变量，#3 和 #4 返回不同的 id。

我认为#3 和#4 表明它们不是同一个对象，但是#1 和#2 ......

绑定方法的 id 和未绑定方法的 id 有什么区别？

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2012-11-12T17:12:11.760

`instance.name`每当您通过（以及在 Python 2 中）查找方法时`class.name`，都会创建一个新的方法对象。Python 每次都使用[描述符协议](http://docs.python.org/3/reference/datamodel.html#implementing-descriptors)将函数包装在一个方法对象中。

因此，当您查找时`id(C.foo)`，会创建一个新的方法对象，您检索其 id（内存地址），然后*再次丢弃该方法对象*。然后查找`id(cobj.foo)`，创建了一个新方法对象，该对象重新使用了现在释放的内存地址，您会看到相同的值。然后，该方法再次被丢弃（当引用计数降至 0 时收集垃圾）。

接下来，您将对未绑定方法的引用存储`C.foo`在变量中。现在内存地址没有被释放（引用计数为 1，而不是 0），您通过查找必须使用新内存位置的方法创建*第二个方法实例。*`cobj.foo`因此，您得到两个不同的值。

请参阅[文档`id()`](http://docs.python.org/3/library/functions.html#id)：

> 返回对象的“身份”。这是一个整数（或长整数），保证该对象在其生命周期内是唯一且恒定的。***具有不重叠生命周期的两个对象可能具有相同的`id()`值***。
> 
> **CPython 实现细节**：这是内存中对象的地址。

强调我的。

您可以通过类的属性使用对函数的直接引用来重新创建方法`__dict__`，然后调用[`__get__`描述符方法](http://docs.python.org/2/reference/datamodel.html#object.__get__)：

```
>>> class C(object):
...     def foo(self):
...         pass
... 
>>> C.foo
<unbound method C.foo>
>>> C.__dict__['foo']
<function foo at 0x1088cc488>
>>> C.__dict__['foo'].__get__(None, C)
<unbound method C.foo>
>>> C.__dict__['foo'].__get__(C(), C)
<bound method C.foo of <__main__.C object at 0x1088d6f90>> 
```

请注意，在 Python 3 中，整个未绑定/绑定方法的区别已被删除；你会得到一个函数，在你得到一个未绑定的方法之前，你会得到一个方法，否则，一个方法*总是*被绑定的：

```
>>> C.foo
<function C.foo at 0x10bc48dd0>
>>> C.foo.__get__(None, C)
<function C.foo at 0x10bc48dd0>
>>> C.foo.__get__(C(), C)
<bound method C.foo of <__main__.C object at 0x10bc65150>> 
```

此外，Python 3.7 添加了一个新的[`LOAD_METHOD`](https://docs.python.org/3.7/library/dis.html#opcode-LOAD_METHOD)-操作码对[`CALL_METHOD`](https://docs.python.org/3.7/library/dis.html#opcode-CALL_METHOD)来精确地替换当前的`LOAD_ATTRIBUTE`-`CALL_FUNCTION`操作码对，以避免每次都创建一个新的方法对象。这种优化转换了`instance.foo()`from `type(instance).__dict__['foo'].__get__(instance, type(instance))()`with的执行路径`type(instance).__dict__['foo'](instance)`，因此“手动”将实例直接传递给函数对象。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-11-12T17:20:19.167

添加到@Martijn Pieters 的非常好的[答案](https://stackoverflow.com/a/13348193/846892)：

```
In [1]: class C(object):
   ...:     def foo(self):
   ...:         pass
   ...:

In [2]: c = C()

In [3]: id(c.foo), id(C.foo)
Out[3]: (149751844, 149751844)  # so 149751844 is current free memory address

In [4]: a = c.foo  # now 149751844 is assigned to a

In [5]: id(a)              
Out[5]: 149751844

# now python will allocate some different address to c.foo and C.foo     

In [6]: id(c.foo), id(C.foo)    # different address used this time, and
Out[6]: (149752284, 149752284)  # that address is freed after this step

# now 149752284 is again free, as it was not allocated to any variable

In [7]: b = C.foo  # now 149752284 is allocated to b    

In [8]: id(b)
Out[8]: 149752284                

In [9]: c.foo is C.foo  # better use `is` to compare objects, rather than id()
Out[9]: False 
```

# ms-access - 通过表单输入时如何查找信息的存储位置？

> ID：13348032
> 
> 赞同：0
> 
> 时间：2012-11-12T17:02:23.847
> 
> 标签：ms-access, ms-access-2003

我已经在 MS Access 2003 中创建了一个数据库。它具有用于将数据输入表的表单。我想创建一个显示通过表单输入的值的报告。我试图找到通过表单输入时数据的存储位置，以便我可以在该表上创建报告，但我无法找到它。有人可以告诉我我该怎么做吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-11-12T17:22:00.533

我会在您的后端表中添加一个附加字段，并将表单名称直接写入记录中。这样你以后就可以查询了。

# javascript - 如何为按钮的内容设置动画？

> ID：13348043
> 
> 赞同：1
> 
> 时间：2012-11-12T17:03:10.387
> 
> 标签：javascript, jquery, html

转到谷歌，无需输入任何内容，将鼠标悬停在“手气不错”按钮上。看看它有什么作用？

我想不出该怎么做……on:hover……但是实际的内容和动画本身，怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T17:11:45.440

动画的不是按钮。

他们有一个隐藏的 div，位于按钮上方。它是绝对定位的。它包含许多包含所有消息的跨度。

在悬停时，他们使用一个函数来移动该 div 并使其可见。看起来按钮的内容在移动，但实际上并非如此。

```
<button></button>
<div style="display: none; font-family: Arial,sans-serif; overflow: hidden; text-align: center; z-index: 50; height: 27px; position: absolute; left: 667px; margin: 0px; top: 45px; width: 114px;>
  <div style="left: 0px; position: absolute; right: 0px; white-space: nowrap; top: -29px;">
    <!-- spans go here -->
  </div>
</div> 
```

看到值，-29px？这就是正在改变的一切。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T17:09:15.563

为边框和粗体添加一个类，即：focus，并使用 jQuery 进行切换：

```
$('#button').hover( function () {
  $(this).addClass('focus');
}, function () {     
  $(this).removeClass('focus');
} ); 
```

您可以看到 Google 在 Chrome 中使用的实际规则是：

```
.gbqfba-hvr:focus,.gbqfbb-hvr:focus{
  -webkit-box-shadow:inset 0 0 0 1px #fff,0 1px 1px rgba(0,0,0,.1);
  -moz-box-shadow:inset 0 0 0 1px #fff,0 1px 1px rgba(0,0,0,.1);
  box-shadow:inset 0 0 0 1px #fff,0 1px 1px rgba(0,0,0,.1)
}
.gbqfb-hvr,.gbqfba-hvr,.gbqfbb-hvr{
  -webkit-box-shadow:0 1px 1px rgba(0,0,0,.1);
  -moz-box-shadow:0 1px 1px rgba(0,0,0,.1);
  box-shadow:0 1px 1px rgba(0,0,0,.1)
} 
```

# ios - 无法使用自定义元数据保存图像

> ID：13348044
> 
> 赞同：1
> 
> 时间：2012-11-12T17:03:19.067
> 
> 标签：ios, assetslibrary

我正在尝试在我的 iOS 应用程序中创建自定义图片库。我想让用户能够将某些元数据与图像一起保存，以便稍后可以在应用程序中使用附加信息将其拉出。

首先，当用户拍照时，应用程序将图像保存到应用程序的自定义相册中：

```
UITextField *nameField = [alertView textFieldAtIndex:0];

NSMutableDictionary *metaData = [[NSMutableDictionary alloc] init];

[metaData setObject:currentEvent forKey:kMetaDataEventKey];
[metaData setObject:[AppDelegate getActivePerson].name forKey:kMetaDataPersonKey];
[metaData setObject:nameField.text forKey:kMetaDataNameKey];
NSLog(@"Saving image with metadata: %@", metaData);

NSMutableDictionary *realMetaData = [[NSMutableDictionary alloc] init];
[realMetaData setObject:metaData forKey:kCGImagePropertyTIFFDictionary];
[library saveImage:imageToSave toAlbum:albumName metadata:realMetaData withCompletionBlock:^(NSError *error) {
    if ( error != nil )
    {
        NSLog(@"Error saving picture? %@", error);
    }
    [self.tableView reloadData];
}]; 
```

保存后，我收到以下日志消息：

```
Saving image with metadata: {
    Event = t;
    Person = "George James";
    PictureName = tt;
} 
```

然后当我稍后尝试检索图像时，我使用此功能

```
-(void) loadAssets
{
    self.assets = [NSMutableArray arrayWithCapacity:album.numberOfAssets];
    [album enumerateAssetsUsingBlock:^(ALAsset *result, NSUInteger index, BOOL *stop) {
        if ( result != nil )
        {
            NSDictionary *metaData = result.defaultRepresentation.metadata;
            NSLog(@"Retrieved image metadata: %@", metaData);
        }
        else
        {
            [self.tableView reloadData];
        }
    }];
} 
```

但是日志显示它没有成功保存与图像关联的元数据：

```
Retrieved image metadata: {
    ColorModel = RGB;
    DPIHeight = 72;
    DPIWidth = 72;
    Depth = 8;
    Orientation = 1;
    PixelHeight = 720;
    PixelWidth = 960;
    "{Exif}" =     {
        ColorSpace = 1;
        ComponentsConfiguration =         (
            1,
            2,
            3,
            0
        );
        ExifVersion =         (
            2,
            2,
            1
        );
        FlashPixVersion =         (
            1,
            0
        );
        PixelXDimension = 960;
        PixelYDimension = 720;
        SceneCaptureType = 0;
    };
    "{TIFF}" =     {
        Orientation = 1;
        ResolutionUnit = 2;
        XResolution = 72;
        YResolution = 72;
        "_YCbCrPositioning" = 1;
    };
} 
```

`library`是一个`ALAssetsLibrary`实例，`saveImage: toAlbum:`方法来自[这篇博](http://www.touch-code-magazine.com/ios5-saving-photos-in-custom-photo-album-category-for-download/)文，只是稍作修改，以便我可以这样保存元数据：

```
-(void)saveImage:(UIImage *)image toAlbum:(NSString *)albumName metadata:(NSDictionary *)metadata withCompletionBlock:(SaveImageCompletion)completionBlock
{
    //write the image data to the assets library (camera roll)
    [self writeImageToSavedPhotosAlbum:image.CGImage
                              metadata:metadata
                       completionBlock:^(NSURL* assetURL, NSError* error) {

                           //error handling
                           if (error!=nil) {
                               completionBlock(error);
                               return;
                           }

                           //add the asset to the custom photo album
                           [self addAssetURL: assetURL
                                     toAlbum:albumName
                         withCompletionBlock:completionBlock];

                       }
     ];

} 
```

图像来自`UIImagePickerController`使用相机的图像。图片已成功保存到正确的相册，只是缺少元数据。

我在保存/加载过程中做错了吗？我实际上不允许将自定义元数据保存到图像吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-19T14:20:38.097

我做了一些测试，据我所知，简短的回答是“你不能那样做”。看起来元数据必须符合特定的 EXIF 元数据键。您可以查找可用的 TIFF 元数据键并查看是否有任何您想要设置/覆盖的值。例如，您可以尝试使用`kCGImagePropertyTIFFImageDescription`来存储您的数据。

```
NSMutableDictionary *tiffDictionary= [[NSMutableDictionary alloc] init];
NSMutableDictionary *myMetadata = [[NSMutableDictionary alloc] init];
[tiffDictionary setObject:@"My Metadata" forKey:(NSString*)kCGImagePropertyTIFFImageDescription];
[myMetadata setObject:tiffDictionary forKey:(NSString*)kCGImagePropertyTIFFDictionary]; 
```

...并将 myMetadata 与图像一起保存。

对于其他键，请参阅：http: [//developer.apple.com/library/mac/#documentation/GraphicsImaging/Reference/CGImageProperties_Reference/Reference/reference.html](http://developer.apple.com/library/mac/#documentation/GraphicsImaging/Reference/CGImageProperties_Reference/Reference/reference.html)

否则，我要做的是创建一个使用图像的唯一标识符作为键的 NSDictionary，并将元数据对象存储为值。每当您保存/加载图像时，保存/加载此 NSDictionary。

# php - 最有效的 MySQL 查询？

> ID：13348050
> 
> 赞同：0
> 
> 时间：2012-11-12T17:03:40.563
> 
> 标签：php, mysql, inner-join

我刚刚完成了这个 MySQL 查询，因为我仍然认为自己是新手，想知道我是否以最有效的方式完成了这项工作？

我有 4 个表，前 2 个包含需要相互链接的类别数据和类别关联。第 3 表包含产品信息，第 4 表包含价格；有些产品有不止一个价格，我只需要最低的价格。

```
 **Category Data**
        cat_id        cat_name
    |:-----------|------------:|
    |  21        |  Cat One    |
    |  22        |  Cat Two    |

            **Category Associations**
         ca_id        cat_id        prod_id
    |:-----------|------------:|:------------:|
    |   1        |    21       |     83       |
    |   2        |    22       |     88       |

                **Product Info**
        prod_id      prod_name    brand_name
    |:-----------|------------:|:------------:|
    |   83       |  Prod One   |  Brand One   |
    |   88       |  Prod Two   |  Brand Two   |

             **Prices**
       prod_id      price_id    
    |:-----------|------------:|
    |   83       |  22.15      |
    |   83       |  25.66      |
    |   88       |  47.23      |
    |   88       |  12.22      | 
```

这是我需要作为输出的数据

```
 prod_id     prod_name     brand_name      cat_name     lowest_price
|:-----------|------------:|:------------:|:------------:|:------------:|
|   83       |  Prod One   |  Brand One   |  Brand Two   |  22.15       |
|   88       |  Prod Two   |  Brand Two   |  Brand Two   |  12.22       | 
```

我遗漏了很多数据，只是简单地给出了基础知识。

此查询有效；只是想知道它是否可以改进。数据将存储在一个数组中，并将使用 javascript 进行排序。

```
SELECT `".DB_PREFIX."products`.prod_id, `".DB_PREFIX."products`.prod_name, `" . DB_PREFIX . "products`.prod_brand, `" . DB_PREFIX . "categories`.cat_name, `" . DB_PREFIX . "products`.prod_image, `" . DB_PREFIX . "products`.prod_field_one, `" . DB_PREFIX . "products`.prod_field_two, `" . DB_PREFIX . "products`.prod_field_three, `" . DB_PREFIX . "products`.prod_field_four, `" . DB_PREFIX . "products`.prod_field_five, `" . DB_PREFIX . "products`.prod_field_six, MIN(`" . DB_PREFIX . "prices`.price) as LowestPrice
FROM (`".DB_PREFIX."products` 
INNER JOIN `".DB_PREFIX."category_associations` ON `".DB_PREFIX."products`.prod_id = `".DB_PREFIX."category_associations`.prod_id)
INNER JOIN `".DB_PREFIX."categories` ON `".DB_PREFIX."category_associations`.cat_id = `".DB_PREFIX."categories`.cat_id     
INNER JOIN `" . DB_PREFIX . "prices` 
ON `" . DB_PREFIX . "prices`.prod_id = `" . DB_PREFIX . "products`.prod_id 
GROUP BY `" . DB_PREFIX . "prices`.prod_id` 
```

谢谢，西蒙

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-12T17:09:42.867

[使用EXPLAIN](http://dev.mysql.com/doc/refman/5.0/en/explain.html)调试您的查询。使用 EXPLAIN，您应该能够确定您的查询是否使用了正确的索引。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T17:07:38.047

您可以创建所需数据的[MySQL 视图](http://dev.mysql.com/doc/refman/5.0/en/views.html)，并简单地将该视图查询为表，这将从编码/维护的角度改进......

# wordpress - 用于自定义帖子类型的 Wordpress 自定义搜索页面

> ID：13348054
> 
> 赞同：1
> 
> 时间：2012-11-12T17:03:55.120
> 
> 标签：wordpress, custom-post-type

我有一个自定义帖子类型，它使用模板`recipes`在网站上显示食谱的分页列表。`archive-recipes.php`

我需要能够使用页面顶部的搜索表单来搜索这些食谱：

```
<form role="search" method="get" class="searchbox" action="/recipes/">
    <input type="text" class="textbox strong" name="s" id="s" value="" placeholder="Search..." />
    <input type="hidden" name="post_type" value="recipes" />                     
    <button type="submit" class="button icon"></button>
</form> 
```

搜索完成后是否可以返回此食谱列表页面并以与列表相同的样式显示结果？

我似乎找不到任何可以让我为自定义帖子类型创建自定义搜索页面的东西。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T18:51:36.617

您可以使用“template_include”过滤器。

例如在您的函数文件中。

```
function template_chooser($template)
{
  global $wp_query;
  $post_type = get_query_var('post_type');
  if( $wp_query->is_search && $post_type == 'recipes' )
  {
    return locate_template('archive-recipes.php');
  }
  return $template;
}
add_filter('template_include', 'template_chooser'); 
```

这应该检查“食谱”自定义帖子类型的搜索，并使用您的存档页面模板获取结果。

# sql - 在 oracle sql 查询中使用提示进行调优

> ID：13348055
> 
> 赞同：0
> 
> 时间：2012-11-12T17:03:58.273
> 
> 标签：sql

我正在尝试调整 oracle sql 查询。我的一位朋友建议我使用 HINTS。我没有时间，所以无法检查语法。从现有的 sql 中，我编写了一个查询并与我的领导共享。现在我想知道它是否可以。

现有查询：`select columnName from tableName`

我的查询：`select +columnName from tableName`

我上面提到的示例只是我实现的逻辑。它是 bhi 查询的一部分，在选择条件中的 columnName 之前添加一个加号可以减少查询的运行时间。现在我知道这不是提示的正确实现。我想知道以上是否是对sql代码的一种调优。如果在 columnName 中添加加号无论如何有助于 sql 性能，或者添加加号不会影响 sql 性能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T17:31:47.313

列前面的加号与性能无关。它只是语法糖，完全没有改变。

如果您真的想使用提示，则需要将它们放入评论中。

```
select /*+ some_hint */ columnName
from tableName; 
```

有关提示的详细列表及其工作原理，请参阅手册：
[http ://docs.oracle.com/cd/B28359_01/server.111/b28286/sql_elements006.htm#i35922](http://docs.oracle.com/cd/B28359_01/server.111/b28286/sql_elements006.htm#i35922)

# javascript - 无法检索 window.location.href

> ID：13348063
> 
> 赞同：0
> 
> 时间：2012-11-12T17:04:32.133
> 
> 标签：javascript, location-href

我有以下代码，试图检索新打开的窗口的 url。

```
<script type="text/javascript">
this.windowRef = window.open("http://www.google.com");
console.log(this.windowRef.location.href);
</script> 
```

但是，当我查看浏览器的控制台时，显示的结果是：“about:blank”，而不是“www.google.com”

这是为什么？如何显示 www.google.com？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T17:06:04.730

[同源策略](https://developer.mozilla.org/en-US/docs/Same_origin_policy_for_JavaScript)阻止您从其他域读取数据。

# html - HTML - 当使用 UTF-8 或 ISO-8859-1 时，我还需要输入特殊字符的代码吗？

> ID：13348064
> 
> 赞同：2
> 
> 时间：2012-11-12T17:04:32.940
> 
> 标签：html, xhtml, frontend

正如标题所说：

HTML - 当使用 UTF-8 或 ISO-8859-1 时，我还需要输入特殊字符的代码吗？

或者我可以正常输入它们吗？

例如：我在我的 HTML META 标记中使用 UTF-8。我需要输入 ç 我应该只输入它还是输入它的代码`&ccedil;`

我知道这是一个微不足道的问题，但它是基本的，所以我不能跳过它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T17:10:28.640

不，您只需要在以下情况下使用字符引用：

*   您想要的字符不能在您使用的字符编码中表示，*或者*
*   该字符在 HTML 中具有某些特殊含义（例如`<`或`&`）。

请注意，在元标记中声明您使用 UTF-8 是不够的。您还必须以 UTF-8 对 HTML 源进行编码（好的编辑器将默认使用此编码），而不是在真实的 HTTP 标头中声明一些其他编码来覆盖它。您还应该设置真正的 HTTP 标头以声明正在使用 UTF-8。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T17:23:33.340

是的，您可以直接在 HTML 源代码中包含这些字符，而无需使用该字符的实体。只需确保您保存文件的编码确实与 Web 服务器提供的编码相匹配。

确保编码正确的部分很重要，而且很容易出错。需要注意的一点是，`meta`标签不是浏览器用于解释文档编码的主要信息来源。信息的主要来源是`Content-type`标头，作为 HTTP 标头的一部分发送。该`meta`标签最初应该用于与 Web 服务器通信要`Content-type`使用什么，但大多数 Web 服务器为此使用与文档本身分开的配置。因此，如果您将文档保存为 UTF-8，请确保将 Web 服务器配置为也将页面提供为 UTF-8。

如果未提供标头或不包含有效的编码信息，则浏览器将使用该`meta`标记作为后备。`Content-type`如果您要从不提供`Content-type`信息的源加载，例如使用`file:`URL 在本地计算机上查看页面，则它很有用。

所以，有 3 个地方你应该确保你的编码设置正确；在您的文本编辑器中（以便它使用适当的编码保存文件），在您的 Web 服务器配置中（以便将适当的编码传达给浏览器）和`meta`标签中，以便当您在本地查看页面时，它以正确的编码显示。

最后，您不应该使用 ISO-8859-1。那是一种旧式编码，仅出于兼容性目的仍受支持。到目前为止，每个主要的浏览器和文本编辑器都支持 UTF-8，它涵盖了所有的 Unicode，并且提供了更少的编码问题。

# html - 父 div 容器隐藏下拉菜单

> ID：13348066
> 
> 赞同：5
> 
> 时间：2012-11-12T17:04:44.380
> 
> 标签：html, css, twitter-bootstrap

在 jsfiddle 中重新创建它非常困难，所以我将继续粘贴屏幕截图、HTML 和 CSS：

![在此处输入图像描述](../Images/43eb9b51ff4e630e9e43e2fc28d68068.png)

我在上图中显示下拉菜单时遇到问题。

HTML 和 CSS：

```
<div class="row-fluid profile-gallery-image-container">
    <div class="span12">

        <a href="#"><img src="#"/></a>

        <div class="image-options">

            <div class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="icon-cog icon-white"></i></a>
                <ul class="dropdown-menu">
                    <li><a href="javascript:void(0);">test</a></li>
                </ul>
            </div>

        </div>

        <div class="delete-image">
            <a href="javascript:void(0);"/></a>
        </div>
    </div>
</div>

.profile-gallery-image-container {
max-width: 130px;
max-height: 110px;
margin-bottom: 0px;
display: inline-block;
position: relative;
border: 2px solid rgba(140,140,140,1);
z-index: 0;
}

.image-options {
float: right;
top: 0px;
right: 0px;
position: absolute;
padding-top: 2px;
border-left: 2px solid rgba(255,128,64,1);
border-bottom: 2px solid rgba(255,128,64,1);
width: 15px;
height: 15px;
} 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-12T17:19:47.447

这可能与 z-index 级别有关，也可能是溢出设置。

将父容器设置为“溢出：可见；” 将是一个开始 - 但随后我会查看位置：菜单 CSS 上的相对 - 这通常会有所帮助。

但最终没有看到工作演示，我无法弄清楚。

# sandcastle - 包含来自 xml 文档文件的常见内容

> ID：13348067
> 
> 赞同：0
> 
> 时间：2012-11-12T17:04:44.660
> 
> 标签：sandcastle, xml-documentation

我正在使用 Sandcastle 为项目生成文档。为了引用 xml 文档文件 `include`，使用了标签。

```
///<include file='xml_include_tag.doc' path='MyDocs/MyMembers[@name="test"]/*' />
public class Test 
```

我想从这个 XML 文档文件中引用一些常见的内容。例如：

```
<MyDocs><MyMembers name="test">
        <summary>
           <include file='common.xml' path='MyDocs/MyMembers[@name="test"]/*' />
        </summary>
</MyMembers></MyDocs> 
```

显然它不是这样工作的。做这些事情的正确方法是什么？Sandcastle 可能有一些扩展？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T20:43:43.560

通过使用 MAML 令牌文件解决了该问题。Sandcastle 可以毫无问题地解决它们。

```
/// <summary>
/// <token>Token1</token>
/// </summary> 
```

# c# - 构造函数注入 Win8 App

> ID：13348068
> 
> 赞同：3
> 
> 时间：2012-11-12T17:04:54.710
> 
> 标签：c#, dependency-injection, inversion-of-control, constructor-injection

Win8 App中如何实现DI和IoC？在windows窗体中，如果我需要一个带有依赖项的窗体，我传入构造函数（构造函数注入）但是使用Page你怎么办？如果我用这个构造函数构建一个页面（

```
HomePage myPage = new HomePage (MyService1 ms, MyService2 ms)) 
```

然后

```
Navigate (typeof (HomePage)) 
```

我怎样才能传递论点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T15:36:41.403

您可以使用`Content`of`Frame`而不是解决问题`Source`：

```
myFrame.Content = new HomePage (MyService1 ms, MyService2 ms); 
```

# javascript - 使用 javascript 直接从 PC 源向浏览器显示图像

> ID：13348069
> 
> 赞同：-1
> 
> 时间：2012-11-12T17:05:03.083
> 
> 标签：javascript

我想在浏览器中显示图像，当用户单击按钮时，他们可以从计算机中搜索图片并将该图片显示到浏览器。我怎样才能做到这一点？非常感谢你的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T17:16:49.650

如果您正在本地计算机中寻找浏览器图像，请忘记它。你不能在客户端这样做。

# c++ - g++ 的 std::list::sort 是否使迭代器无效？

> ID：13348070
> 
> 赞同：1
> 
> 时间：2012-11-12T17:05:03.717
> 
> 标签：c++, c++11, iterator, g++

根据 SGI、cplusplus.com 和我拥有的所有其他来源，std::list 的 sort() 成员函数不应使迭代器无效。但是，当我运行此代码（c++11）时，情况似乎并非如此：

```
#include <list>
#include <chrono>
#include <random>
#include <iostream>
#include "print.hpp"
unsigned int seed = std::chrono::system_clock::now().time_since_epoch().count();
std::default_random_engine generator(seed);
std::uniform_int_distribution<unsigned int> distribution(1, 1000000000);
auto rng = std::bind(distribution, generator);
// C++11 RNG stuff. Basically, rng() now gives some unsigned int [1, 1000000000]

int main() {
    unsigned int values(0);
    std::cin >> values;           // Determine the size of the list
    std::list<unsigned int> c;
    for (unsigned int n(0); n < values; ++n) {
        c.push_front(rng());
    }
    auto c0(c);
    auto it(c.begin()), it0(c0.begin());
    for (unsigned int n(0); n < 7; ++n) {
        ++it;     // Offset these iterators so I can print 7 values
        ++it0;
    }
    std::cout << "With seed: " << seed << "\n";
    std::cout << "Unsorted list: \n";
    print(c.begin(), c.end()) << "\n";
    print(c.begin(), it) << "\n\n";
    auto t0 = std::chrono::steady_clock::now();
    c0.sort();
    auto d0 = std::chrono::steady_clock::now() - t0;
    std::cout << "Sorted list: \n";
    print(c0.begin(), c0.end()) << "\n";
    print(c0.begin(), it0) << "\n";  // My own print function, given further below
    std::cout << "Seconds: " << std::chrono::duration<double>(d0).count() << std::endl;
    return 0;
} 
```

在 print.hpp 中：

```
#include <iostream>

template<class InputIterator>
std::ostream& print(InputIterator begin, const InputIterator& end, 
                    std::ostream& out = std::cout) {
    bool first(true);
    out << "{";
    for (; begin != end; ++begin) {
        if (first) {
            out << (*begin);
            first = false;
        } else {
            out << ", " << (*begin);
        }
    }
    out << "}";
    return out;
} 
```

样本输入/输出：

```
11
With seed: 3454921017
Unsorted list: 
{625860546, 672762972, 319409064, 8707580, 317964049, 762505303, 756270868, 249266563, 224065083, 843444019, 523600743}
{625860546, 672762972, 319409064, 8707580, 317964049, 762505303, 756270868}

Sorted list: 
{8707580, 224065083, 249266563, 317964049, 319409064, 523600743, 625860546, 672762972, 756270868, 762505303, 843444019}
{8707580, 224065083}
Seconds: 2.7e-05 
```

一切都按预期工作，除了打印。它应该显示 7 个元素，但实际数字相当随意，前提是“值”设置为大于 7。有时它不给出，有时给出 1，有时给出 10，有时给出 7，等等。所以，有没有我的代码明显有问题，或者这是否表明 g++ 的 std::list （和 std::forward_list ）不符合标准？

提前致谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-12T17:10:26.843

迭代器仍然有效，并且仍然引用列表中的相同元素，这些元素*已重新排序*。

所以我不认为你的代码做你认为它做的事情。它从头开始打印列表，直到列表排序后第 7 个元素结束。因此，它打印的元素数量当然取决于列表中的值。

考虑以下代码：

```
#include <list>
#include <iostream>

int main() {
    std::list<int> l;
    l.push_back(1);
    l.push_back(0);
    std::cout << (void*)(&*l.begin()) << "\n";
    l.sort();
    std::cout << (void*)(&*l.begin()) << "\n";
} 
```

打印的两个地址不同，表明（与 不同`std::sort`）`std::list::sort`通过更改元素之间的链接进行排序，而不是通过为元素分配新值。

我一直认为这是强制性的（同样适用于`reverse()`）。我实际上找不到明确的文字可以这么说，但是如果您查看 的描述`merge`，并认为`list::sort`存在的原因*可能是*因为 mergesort 可以很好地与列表一起使用，那么我认为它“显然”是有意的。`merge`说，“指向 x 的移动元素的指针和引用现在引用那些相同的元素，但作为 *this 的成员”（23.3.5.5./23），并且包含`merge`并`sort`说的部分的开头，“因为列表允许快速从列表中间插入和擦除，某些操作是专门为它们提供的”（23.3.5.5/1）。

# perl - 如何通过 perl 中的多个子例程传递变量？

> ID：13348074
> 
> 赞同：-1
> 
> 时间：2012-11-12T17:05:08.240
> 
> 标签：perl, variables, subroutine

我在子例程中有一个变量 currentUser 。它执行到一个子程序，但不执行到另一个子程序。如何在保持值的同时通过多个子例程传递变量？

```
sub login {
    &app_header;
    print <<EOF;
<form name="macform" method="POST" enctype="application/x-www-form-urlencoded"       action="$fullurl">
    ...stuff
    EOF  
}

sub html_menu {
    $me = $currentUser;
    print $me;
    print <<EOF;
    <form name="menuform" method="POST" enctype="application/x-www-form-urlencoded"     action="$fullurl">
    ..stuff
    EOF
    &app_list_button;
    print "<br>";
    &app_search_button;
    print "<br>";
    &app_edit_button;
    print "</div>";
} 
```

当我尝试在 html_form 之后调用的新子中使用 html_form 子对 currentUser 执行相同操作时，该变量不会显示为用户在登录期间输入的内容。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T17:11:22.463

```
sub first {
    my $currentUser = shift;
    second($currentUser);
}

sub second {
    my $currentUser = shift;
    third($currentUser);
} 
```

...等等。

将变量作为参数传递是通过`@_`变量完成的。您不应该尝试使用全局变量，这不是一个好方法。你可以这样做：

```
my ($arg1, $arg2, @rest) = @_; 
```

或者通过使用`shift`,`pop`和其他操作数组的方法，就像我上面使用的`shift`.

如果您还没有这样做，我强烈建议您使用

```
use strict;
use warnings; 
```

它将帮助您解决许多简单的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-12T17:08:36.713

最安全的方法是使用变量作为参数：

```
sub r1 {
    my $arg = shift;
    r2($arg);
}

sub r2 {
    my $arg = shift;
    print "$arg in r2\n";
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-12T17:55:31.317

> 当我尝试在 html_form 之后调用的新子中使用 html_form 子对 currentUser 执行相同操作时，该变量不会显示为用户在登录期间输入的内容。

首先，这是一个相当复杂的例子。您应该尝试将其分解。为了补充迄今为止其他人所说的内容，我将告诉您`&`子例程名称上的前缀，而不会`()`更改含义。您在示例中使用了它，我不确定您是否知道它的作用。所有这些都有略微不同的含义。

*   `foo()``foo`这只是简单地调用不带参数的sub 。
*   `&foo`这调用了隐式`foo`传入。`@_`重要说明，如果通过引用进行`foo`修改，那么被调用者的也会改变。`@_``@_`
*   `&foo()`这只是perl4的遗物。这`foo`使用显式的 subref sigil 调用。这在所有情况下都已弃用。

*原型和印记也有细微的差异，`&`超出了问题的范围*

有关更多信息，请参阅`perldoc -q "calling a function"`和`perldoc perlsub`

# ios - UIImageView 无法显示图像

> ID：13348080
> 
> 赞同：1
> 
> 时间：2012-11-12T17:05:27.200
> 
> 标签：ios, iphone

`UIImage`不显示图像。我`UIImageView`使用以下方法为表格单元格创建了一个自定义类：

```
imgView = [[UIImageView alloc]init];
frame= CGRectMake(boundsX+10 ,0, 50, 44);
imgView.frame = frame; 
```

然后，我尝试加载每个单元格，但什么也没有。但是，我可以在日志消息中读取图像 url。

```
NSURL *url = [NSURL URLWithString: [dict objectForKey:@"imageAdd"]];
NSData *data = [NSData dataWithContentsOfURL: url];
UIImage * image = [[UIImage alloc] initWithData:[[data copy] autorelease]];
NSLog (@"The image is located at the URL: %@", url);
cell.imgView.image = image; 
return cell; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T18:07:28.627

标准 UITableViewCell 已经包含 UIImageView，如果设置了图像，它会显示在所有标签的左侧。您可以使用 imageView 属性访问它：

```
cell.imageView.image = someImage; 
```

如果由于某种原因标准行为不适合您的需求（请注意，您可以自定义该标准图像视图的属性），那么您可以按照 Aman 在其回答中的建议将您自己的 UIImageView 添加到单元格中。但在这种方法中，您必须自己管理单元格的布局（例如，确保单元格标签不与图像重叠）。并且不要直接将子视图添加到单元格中 - 将它们添加到单元格的 contentView 中：

```
// DO NOT!
[cell addSubview:imageView]; 
// DO:
[cell.contentView addSubview:imageView]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T17:48:37.967

据我从您的代码中可以看出，您从未将 imgView 添加为单元格的子视图。添加行：

```
[cell.contentView addSubview:imgView]; 
```

# javascript - 使用 textarea 中的输入来触发视频事件 - javascript

> ID：13348081
> 
> 赞同：0
> 
> 时间：2012-11-12T17:05:27.287
> 
> 标签：javascript, html, html5-video

我正在开发一个 HTML5 视频记录和转录应用程序。转录员需要能够使用键盘快捷键/加速器而不是单击按钮来开始和停止视频。有没有办法让我在不离开 textarea 框的情况下使用 javascript 来做到这一点？

谢谢， 规范

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T23:00:19.417

试试这个[JSFiddle](http://jsfiddle.net/jLt39/)。停止/开始视频的快捷键是“alt + enter key”。

HTML：

```
<video src="http://v2v.cc/~j/theora_testsuite/320x240.ogg" controls id="video">
  Your browser does not support the <code>video</code> element.
</video>
<textarea></textarea> 
```

Javascript（使用 jQuery）：

```
$(function(e) {
    $('textarea').keydown(function(e) {
        // shortcut for stopping/starting the video
        // is alt + enter
        if (e.altKey && e.keyCode == 13) {
            toggleVideoPlay();
            return false;
        }
    });
});

function toggleVideoPlay() {
    var video = $('#video')[0];
    if (video.paused) {
        video.play();
    } else {
        video.pause()
    }
}​ 
```

# java - JSF 控制器与 Struts 控制器

> ID：13348096
> 
> 赞同：4
> 
> 时间：2012-11-12T17:06:14.443
> 
> 标签：java, model-view-controller, jsf, jakarta-ee, struts

我在某处读过

> 开发人员可以通过创建可以与控制器集成的 Action 对象来访问 struts 控制器，而 Java Server Faces 技术不允许访问控制器。

谁能为我详细说明一下，这是什么意思？任何示例都会有很大帮助。

还

> Struts 控制器可以根据用户角色对每个 Action 进行访问控制等操作。JSF 不提供此功能。

在这一点上我也很困惑。请用一个例子为我解释一下。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T13:06:12.850

我举个例子。假设您有一个格式如下的 jsp 文件：

```
<form name="myform" id="myform" action="<%=formAction%>" method="post">

</form> 
```

其中包含一些输入。在您的 jsp 顶部，您可以定义您的操作，例如：

```
<portlet:actionURL var="formAction">
<portlet:param name="action" value="submitForm"/>
</portlet:actionURL> 
```

因此，当您单击该表单的提交按钮时，控制器的 processAction 方法会执行您为其操作定义的操作，例如：

```
String action = request.getParameter("action");
if ("submitForm".equals(action)) {

   //do something

} 
```

问候 ！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T15:36:16.660

当您为 Struts 2 编码时（也适用于 Struts），您正在扩展控制器本身的框架。Action 是您使用自己的操作扩展的基类，允许您扩展控制器逻辑，通常通过对业务逻辑进行一些调用，然后重定向到您的结果视图之一（在s2 ) 基于该逻辑的结果。当然，您可以对动作进行访问控制等操作；但是你可以对一个动作做任何事情。我猜这个引用片段只是指出 Struts 2 的概念粒度与 Action（控制器）的每个请求实例同步。

至于 JSF，它是一种完全不同类型的框架。它不像 Struts 2 那样面向“请求”，而是“面向组件”。这意味着 JSF 的概念粒度是页面上的组件小部件的概念。这在某种程度上处于不同的级别，或者可能与 struts 2 处理单个请求的方式完全不同。所以，在 JSF 中，框架更深地隐藏了控制器逻辑，主要是因为它更复杂。控制器逻辑必须从请求中获取传入数据，并确保将其映射并传递到与请求关联的页面上的适当组件小部件。开发者 api 都是关于组件合约的。

# javascript - 识别html代码

> ID：13348099
> 
> 赞同：2
> 
> 时间：2012-11-12T17:06:26.873
> 
> 标签：javascript, html

是否有一个 javascript 函数可以识别字符串变量是否包含 HTML 代码？我想避免这种情况，因为如果我使用 innerHTML 并且用户提交了类似的东西，`<img src='link'>`它不会出现字符串而是真实的图像......我希望我解释了谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T17:10:55.640

您可以只替换 3 个非常特殊的字符：：
`&`用于字形符号
`<`：html 标签
`>`的左括号： html 标签的右括号

```
function make_safe(input) {
    return input.replace("&", "&amp;").replace(/(<?)([^<>]*)(>?)/g, function (a,b,c,d) {
        if ((b+c+d).toLowerCase() === "<br>") return "<br>";

        if (b === "<") b = "&lt;";
        if (b === ">") b = "&gt;";

        if (d === "<") d = "&lt;";
        if (d === ">") d = "&gt;";

        return b+c+d;
    }).replace(/\r?\n/g,"<br>");
}

// example:
mydiv.innerHTML = make_safe('<img src="/pic.jpg">'); 
```

我做了一个小魔术，所以 \r\n 变成了换行符，并且`<br>`保留了标签

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T17:08:54.813

并不真地。区分 HTML 和谈论 HTML 的文本并不是一个小问题。

如果您期待文本输入，则处理文本而不是 HTML。不要使用`innerHTML`，使用`createTextNode`和`appendChild`/ `insertBefore`。

# java - 验证 Apple iOS iTunes 收据；从 0 开始或从 1 开始的小时

> ID：13348101
> 
> 赞同：2
> 
> 时间：2012-11-12T17:06:30.890
> 
> 标签：java, ios, itunes, jackson, jodatime

我正在编写一个 Java servlet，它将验证来自 iOS 应用内购买的 Apple 收据日期是否有效，并获取一个收据对象以返回给 iOS 客户端。此验证的规范位于[官方 iOS 文档的此页面中](http://developer.apple.com/library/ios/#documentation/NetworkingInternet/Conceptual/StoreKitGuide/VerifyingStoreReceipts/VerifyingStoreReceipts.html)。

在经过验证和转换的**收据**对象（Apple 通过 HTTP Post 返回给 servlet 的 JSON）中，日期字符串示例如下`2012-01-13 10:14:24 America/Los_Angeles`：我想编写一个[杰克逊 JSON 反序列](http://jackson.codehaus.org/1.0.0/javadoc/org/codehaus/jackson/map/JsonDeserializer.html)化器，它将字符串转换为[Joda DateTime](http://joda-time.sourceforge.net/api-release/org/joda/time/DateTime.html)对象。

**问题**：我不确定时间戳的*小时*字段是从 0 开始还是从 1 开始。如果它是基于 0 的，那么我将创建一个[DateTimeFormatter](http://joda-time.sourceforge.net/api-release/org/joda/time/format/DateTimeFormatter.html)用于`HH`指定小时字段。相反，如果它是基于 1 的，那么我会使用`kk`. 有关如何编写时间戳配置字符串的更多信息，请参阅[DateTimeFormat 的 Javadoc 。](http://joda-time.sourceforge.net/api-release/org/joda/time/format/DateTimeFormat.html)

有谁知道 Apple 的时间戳是从 0 开始还是从 1 开始？由于我还没有活动的 iTunes 应用程序（我的测试时间戳来自示例收据），因此我无法为此编写测试。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T23:00:22.587

来自：[Verifying Store Receipts](http://developer.apple.com/library/ios/#documentation/NetworkingInternet/Conceptual/StoreKitGuide/VerifyingStoreReceipts/VerifyingStoreReceipts.html)你可以得到它`purchase_date`是 a`transactionDate`和`transactionDate` [NSDate](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/DataFormatting/Articles/dfDateFormatting10_4.html#//apple_ref/doc/uid/TP40002369)。从[日期格式化](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/DataFormatting/Articles/dfDateFormatting10_4.html#//apple_ref/doc/uid/TP40002369)程序中，您可以看到使用的小时格式是`HH:mm`.

# wordpress - Wordpress Jetpack 插件 - Wordpress Stats Buggy

> ID：13348102
> 
> 赞同：1
> 
> 时间：2012-11-12T17:06:32.803
> 
> 标签：wordpress, plugins, statistics

我的 Wordpress 网站有问题。我安装了 Jetpack，但它看起来并不正确。

见图片：

![WordPress Jetpack 问题](../Images/27858ffccf0fb47d2e1ec92a33457e35.png)

（[http://indie-wok.de/wp-content/uploads/2012/11/Bildschirmfoto-2012-11-12-um-18.01.08.png](http://indie-wok.de/wp-content/uploads/2012/11/Bildschirmfoto-2012-11-12-um-18.01.08.png)）

有没有其他人也遇到过这个错误？我该如何解决？

# mysql - 在MySQL中使用if语句进行while循环

> ID：13348109
> 
> 赞同：0
> 
> 时间：2012-11-12T17:06:56.100
> 
> 标签：mysql, if-statement, while-loop

由于最后的 while 循环，我收到了一个语法错误。我试过切换它，但在这里找不到问题 - 纯粹是 MySQL 不支持 while 循环中的 if 语句吗？

```
DELIMITER //
CREATE PROCEDURE bLAHbLAHbLAH(p_fromdate datetime, p_todate datetime)
BEGIN

Declare startday datetime;
declare numberofdays int;
declare Counter int;

Set startday = p_fromdate;
Set numberofdays = (select datediff("2012-05-01","2012-11-01"));
Set Counter = 0;

WHILE startday<p_todate DO
    if (select date_format(startday, '%W')) in ('Monday','Tuesday','Wednesday','Thursday','Friday') THEN
        SET Counter = Counter+1;
        SET startday = date_add(startday, INTERVAL 1 DAY);
    else
        SET startday = date_add(startday, INTERVAL 1 DAY);
END WHILE;

select Counter; 

END//

DELIMITER ; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-12T17:09:10.733

你忘了一个

```
end if; 
```

之前`end while`

```
WHILE startday<p_todate DO
    if (select date_format(startday, '%W')) in ('Monday','Tuesday','Wednesday','Thursday','Friday') THEN
        SET Counter = Counter+1;
        SET startday = date_add(startday, INTERVAL 1 DAY);
    else
        SET startday = date_add(startday, INTERVAL 1 DAY);
    end if;                                                   /*add this line*/
END WHILE; 
```

# css - Rails：内联 CSS 从数据库条目中检索样式

> ID：13348110
> 
> 赞同：0
> 
> 时间：2012-11-12T17:06:59.267
> 
> 标签：css, ruby-on-rails, view, model, controller

在我的 HTML 中，我有一个跨度

> ```
> <span style="color:#??????>
>     <h3>Title</h3>
> </span> 
> ```

好的，在我的数据库中，我有一个记录，其中包含一个存储跨度的散列颜色值的字段，例如`#123456`，其中包含散列。

现在我要做的是在 HTML 中，而不是我指定颜色，而是直接从数据库中检索它。该模型称为Sauce。该字段称为title_colour。

我试过了：

> ```
> <span style="color: #{sauce.title_colour}">...</span> 
> ```

问题是当 HTML 被输出时，它与代码中的完全一样。它不提取数据库值。

我认为问题是因为在 Rails 中，当我们在引号中显示对象时，我们以 # 开头，例如 #{sauce.field_name} ，而在 CSS 中，颜色值也以 # 开头。有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T17:08:51.867

您需要使用正确的 erb 插值标签：

```
<span style="color: <%= sauce.title_colour %>">...</span> 
```

# iphone - 使用音量按钮拍照

> ID：13348114
> 
> 赞同：2
> 
> 时间：2012-11-12T17:07:06.807
> 
> 标签：iphone, titanium, titanium-mobile

是否可以使用 iPhone 上的音量控制拍照？

理想情况下，`takePicture()`当按下音量按钮时会调用该方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T17:57:04.977

Add an event listener.

```
Titanium.Media.addEventListener('volume', function(e) {
    Ti.Media.takePicture();    
}); 
```

Make sure the event listener is added when the camera is already shown. Docs here: [http://docs.appcelerator.com/titanium/latest/#!/api/Titanium.Media-method-takePicture](http://docs.appcelerator.com/titanium/latest/#!/api/Titanium.Media-method-takePicture)

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-11-12T17:18:31.657

旧的，但仍然相关：[程序访问 iPhone 音量按钮](https://stackoverflow.com/questions/772832/program-access-to-iphone-volume-buttons)

还可以考虑为您的问题、objective c、ios、xcode 等添加更好的标签。

# iphone - 为 iOS / 替代 2D cad 库编译 CGAL？

> ID：13348116
> 
> 赞同：6
> 
> 时间：2012-11-12T17:07:20.537
> 
> 标签：iphone, ios, geometry, computational-geometry, cgal

我希望在 iOS / iPad 应用程序中使用[CGAL 。](http://www.cgal.org/)我是一位经验丰富的 iOS 开发人员，但我从未尝试过包含像这个这样的 C++ 库，而且我之前也没有真正使用过 CGAL。广泛的研究表明它是我的最佳选择（我需要免费/开源许可证和广泛的 2D 几何方法，包括贝塞尔曲线上任意点的切线/法线向量、贝塞尔曲线偏移、贝塞尔曲线交点等。我特别着迷`CGAL's`“安排”让您可以对封闭空间进行布尔运算，尽管该功能不是成败的功能）。我对其他替代方案持开放态度，但我已经研究了几十个库来得出这个——我更喜欢这个讨论是关于 CGAL 而不是其他建议，除非你有一个特别令人信服的理由来建议另一个方向。

理想情况下，我希望有人能给我一些关于如何进入 iOS 中的“hello world”的分步指导`CGAL`......也许在两点之间生成一条线。我不需要`CGAL`为我做渲染，但我也愿意接受任何以前尝试过类似元素组合的人的建议。我正在使用当前版本的 Xcode，并且想坚持`LLVM`编译（`CGAL`理论上现在支持）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-07T07:31:17.520

CGAL 确实支持 Apple llvm/clang，但目前只在 MacOS X 上。原因是 CGAL 内核的内部需要对浮点单元的特殊支持。迄今为止，对于运行 iOS 的 CPU，从未尝试过这种支持。

# qt4 - 如何为 QTextEdit 设置 PlaceHolderText

> ID：13348117
> 
> 赞同：6
> 
> 时间：2012-11-12T17:07:26.077
> 
> 标签：qt4, qtextedit, qt4.7

我想设置一个占位符文本`QTextEdit`。我知道如何设置它`QLineEdit`，*有一个属性`setPlaceHolderText`*。但此属性不适用于`QTextEdit`。请提出您宝贵的建议来解决这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-11T17:02:16.147

使用QTextEdit 的[setTextCursor(QTextCursor&)](http://doc.qt.digia.com/qt/qtextedit.html#setTextCursor)函数。使用以下逻辑。

```
 QTextCursor textCursor;
  textCursor.setPosistion(0, QTextCursor::MoveAnchor); 
  textedit->setTextCursor( textCursor ); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-12-21T13:26:01.993

自 Qt 5.3 起，添加了该属性，因此您现在只需调用[setPlaceholderText](http://doc.qt.io/qt-5/qplaintextedit.html#placeholderText-prop)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-02-06T12:25:51.093

我发现[Rafe 的答案](https://stackoverflow.com/a/43882058/4936137)有点缺乏，因为它无法正确格式化文本。不过，从[jpo38 的回答](https://stackoverflow.com/a/47925987/4936137)中，我在 Qt5 中找到了它的源代码，并在 Python 中重新实现了我所能做的。

它有一两个变化，但总体上看起来效果很好，它将文本放在正确的位置并支持使用`\n`换行符。

注意：这是在 PySide 中使用[Qt.py](https://github.com/mottosso/Qt.py)进行测试的，如果不使用该文件，则需要重新映射`QtWidgets`回`QtGui`.

```
class QPlainTextEdit(QtWidgets.QPlainTextEdit):
    """QPlainTextEdit with placeholder text option.
    Reimplemented from the C++ code used in Qt5.
    """
    def __init__(self, *args, **kwargs):
        super(QPlainTextEdit, self).__init__(*args, **kwargs)

        self._placeholderText = ''
        self._placeholderVisible = False
        self.textChanged.connect(self.placeholderVisible)

    def placeholderVisible(self):
        """Return if the placeholder text is visible, and force update if required."""
        placeholderCurrentlyVisible = self._placeholderVisible
        self._placeholderVisible = self._placeholderText and self.document().isEmpty() and not self.hasFocus()
        if self._placeholderVisible != placeholderCurrentlyVisible:
            self.viewport().update()
        return self._placeholderVisible

    def placeholderText(self):
        """Return text used as a placeholder."""
        return self._placeholderText

    def setPlaceholderText(self, text):
        """Set text to use as a placeholder."""
        self._placeholderText = text
        if self.document().isEmpty():
            self.viewport().update()

    def paintEvent(self, event):
        """Override the paint event to add the placeholder text."""
        if self.placeholderVisible():
            painter = QtGui.QPainter(self.viewport())
            colour = self.palette().text().color()
            colour.setAlpha(128)
            painter.setPen(colour)
            painter.setClipRect(self.rect())
            margin = self.document().documentMargin()
            textRect = self.viewport().rect().adjusted(margin, margin, 0, 0)
            painter.drawText(textRect, QtCore.Qt.AlignTop | QtCore.Qt.TextWordWrap, self.placeholderText())
        super(QPlainTextEdit, self).paintEvent(event) 
```

如果您需要将文本保留到您开始输入的位置，只需删除该`not self.hasFocus()`部分即可。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-05-10T01:07:59.420

我可以通过子类化和覆盖paint事件来做到这一点：

```
class PlainTextEditWithPlaceholderText(QtGui.QPlainTextEdit):
    def __init__(self, parent=None):
        super(PlainTextEditWithPlaceholderText, self).__init__(parent)
        self.placeholderText = ""  # Qt-style camelCase

    def setPlaceholderText(self, text):
        self.placeholderText = text

    def paintEvent(self, _event):
        """
        Implements the same behavior as QLineEdit's setPlaceholderText()
        Draw the placeholder text when there is no text entered and the widget 
        doesn't have focus.
        """
        if self.placeholderText and not self.hasFocus() and not self.toPlainText():
            painter = QtGui.QPainter(self.viewport())

            color = self.palette().text().color()
            color.setAlpha(128)
            painter.setPen(color)

            painter.drawText(self.geometry().topLeft(), self.placeholderText)

        else:
            super(PlainTextEditWithPlaceholderText, self).paintEvent(event) 
```

# sql-server-2008 - 带有用户输入的 SQL 查询/过程以查看所有符合条件的人

> ID：13348122
> 
> 赞同：0
> 
> 时间：2012-11-12T17:07:53.523
> 
> 标签：sql-server-2008

我有一个 SQL 数据库，我需要创建一个链接到 Web 前端的过程或查询，用户可以在其中键入一个值，该值将位于数据库的一个列中。用户输入值，提交命令（只是网站文本框中的普通文本条目），在后台运行查询以查看在其条目下的列中具有此值的所有人员。用于确定特定人员视图结果的用户条目。

SQL Side 我目前有但不确定它是否正确，可以正常工作但不符合预期！

我有一张桌子，里面有人，还有一个感兴趣的模型价值列。每个感兴趣的模型只是一个数字 1-7，它与另一个表中的产品范围相关。所以 1 = Corsa，2 = Astra，3 = Vectra 等等。所以在persons表中，他们将有纯粹的1或2等。现在我需要将它链接到模型表，所以如果它看到1它看起来为 Corsa 而不是数字 1。

一个用户在前端键入，选择所有对 Corsa 感兴趣的用户，它会查找单词 corsa 并将其匹配到值 1，然后在 person 表的感兴趣的模型列中搜索 1。

到目前为止，我有以下查询。任何建议，因为我今天很难过。明天再试。

```
SELECT TOP 100 [ld_idno]
      ,[ld_company]
      ,[ld_decisionmaker]
      ,[ld_decisionmaker_workphone]
      ,[ld_decisionmaker_mobile]
      ,[ld_decisionmaker_email]
      ,[ld_discussion_model]
  FROM [FMLive204].[dbo].[tblLeads]
SELECT  a.po_word
FROM    dbo.tblPopulation a
            INNER JOIN  dbo.tblLeads b
                ON ld_discussion_model = po_idno
                WHERE [po_word]='Corsa' 
```

SELECT TOP 100 Unique Records company name customer name customer workphone] customer mobile] customer email] [ld_discussion_model] 感兴趣的模型 = 1 FROM [FMLive204].[dbo].[tblLeads] SELECT a.po_word FROM dbo.tblPopulation a（表 a ) INNER JOIN dbo.tblLeads b (table b) ON ld_discussion_model = po_idno （如果感兴趣的模型 1 与另一个表中的条目相同，则选择下一列中的值 (po_word) WHERE [po_word]='Corsa '

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T20:22:01.723

丹尼尔，

下面我概述了需要用户数据（例如从网站输入的 Corsa）并从 tblpopulation 返回所有字段的存储过程，其中 'po_idno' 在与 tblLeads 匹配的列表中。没有 tblpopulation 定义我猜测字段名称“po_idno”是其中具有值 1-7 的字段。

```
Create PROCEDURE [dbo].[sp_find_person] (@UserData varchar(6))
AS
BEGIN

 SELECT Top 100 * FROM [FMLive204].[dbo].tblpopulation
where po_idno in (SELECT po_idno FROM  dbo.tblLeads b
            JOIN   dbo.tblPopulation a
                ON ld_discussion_model = po_idno
                WHERE [po_word]=@UserData) 
```

创建过程后，您必须执行它，可以找到更多信息 @ [http://msdn.microsoft.com/en-us/library/ms189915.aspx](http://msdn.microsoft.com/en-us/library/ms189915.aspx)

# jquery - 使用自动完成检索所选输入的类的 ID

> ID：13348125
> 
> 赞同：0
> 
> 时间：2012-11-12T17:08:04.303
> 
> 标签：jquery, jquery-ui

我有一个页面，我需要多个自动完成插件。我想使用类选择器来初始化自动完成代码。我的问题是，在该代码中，我必须能够选择触发元素的 ID。有没有办法做到这一点 ？

```
//class selected input
$(".autocomplete-class").autocomplete({
    autoSelect: true,
    autoFocus: true,
    delay: 200,
    source: function (request, response) {
        $.ajax({
            url: "/Country/Find", type: "GET", dataType: "json",
            data: { search: request.term, maxResults: 10 },
            success: function (data) {
                if (data.length == 0) {
                    var test = $(this);
                    $(/* ID of the input */).val(function (index, value) {
                        return value.substr(0, value.length - 1);
                    })
                    $(/* ID of the input */).autocomplete("search");
                }
                response($.map(data, function (item) {
                    return { label: item, value: item }
                }))
            }
        })
    }
}); 
```

# javascript - 使用原生 JavaScript 去饱和颜色

> ID：13348129
> 
> 赞同：5
> 
> 时间：2012-11-12T17:08:21.410
> 
> 标签：javascript, colors

我有一个颜色选择器，用户可以在其中指定十六进制颜色。

我还想要一个饱和度滑块，用户可以在其中调整饱和度，并获得新的十六进制颜色作为输出。

有没有办法在 JavaScript 中将饱和度值和十六进制颜色转换为新的十六进制颜色？

因此，例如，我有一个值 #FF0000 和 50 的饱和度（满分 100），我将如何从中确定新的十六进制颜色？

我不能为它使用任何库，因为我将它创建为我网站的插件，并且我试图让它尽可能轻。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-12T17:29:03.170

[http://jsfiddle.net/5sfDQ/](http://jsfiddle.net/5sfDQ/)

```
$("#color, #saturation").change(function(){
    updateColor();
});

function updateColor(){
    var col = hexToRgb($("#color").val());
    var sat = Number($('#saturation').val())/100;
    var gray = col.r * 0.3086 + col.g * 0.6094 + col.b * 0.0820;

    col.r = Math.round(col.r * sat + gray * (1-sat));
    col.g = Math.round(col.g * sat + gray * (1-sat));
    col.b = Math.round(col.b * sat + gray * (1-sat));

    var out = rgbToHex(col.r,col.g,col.b);

    $('#output').val(out);

    $('body').css("background",out);
}

function componentToHex(c) {
    var hex = c.toString(16);
    return hex.length == 1 ? "0" + hex : hex;
}

function rgbToHex(r, g, b) {
    return "#" + componentToHex(r) + componentToHex(g) + componentToHex(b);
}

function hexToRgb(hex) {
    var result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
    return result ? {
        r: parseInt(result[1], 16),
        g: parseInt(result[2], 16),
        b: parseInt(result[3], 16)
    } : null;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-12T17:37:23.993

```
function applySat(sat, hex) {
    var hash = hex.substring(0, 1) === "#";

    hex = (hash ? hex.substring(1) : hex).split("");

    var long = hex.length > 3,
        rgb = [],
        i = 0,
        len = 3;

    rgb.push( hex.shift() + (long ? hex.shift() : "") );
    rgb.push( hex.shift() + (long ? hex.shift() : "") );
    rgb.push( hex.shift() + (long ? hex.shift() : "") );

    for( ; i < len; i++ ) {
        if ( !long ) {
            rgb[i] += rgb[i];
        }

        rgb[i] = Math.round( parseInt(rgb[i], 16)/100*sat).toString(16);

      rgb[i] += rgb[i].length === 1 ? rgb[i] : "";
    }

    return (hash ? "#" : "") + rgb.join("");
} 
```

* * *

```
console.log(applySat(50, "#ff0000")); // "#7f0000";
console.log(applySat(50, "ff0000")); // "7f0000";
console.log(applySat(50, "#fed")); // "#7f776f"
console.log(applySat(50, "fed")); // "7f776f"
console.log(applySat(20, "#addfaa")); // "#232d22" 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-13T03:38:01.153

如果您真的不想使用库，请参阅**[mjijackson 的 RGB 到 HSL 转换页面](http://mjijackson.com/2008/02/rgb-to-hsl-and-rgb-to-hsv-color-model-conversion-algorithms-in-javascript)**。

复制代码以将 RGB 十六进制转换为 HSL（或 HSV）。随着滑块的移动，您需要使用它们在颜色模型之间进行转换以获取饱和度值，对其进行修改，然后返回生成的 rgb 颜色。

注意：[HSL 和 HSV](http://en.wikipedia.org/wiki/HSL_and_HSV)是标准颜色模型。其他一些答案提出了与这些标准颜色模型不对应的“饱和度”定义。用户会感到困惑，因为替代定义不会给出与他们对 GIMP、Photoshop 或其他常见图形应用程序的期望一致的结果。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-10-06T20:50:16.783

真正简单易用的功能，输入您的颜色，并添加您想要去饱和的程度。它做得很好，但它并不完全准确。

```
 function addSaturation(color, amount){
        var color = color.replace('#', '').split('');
        var letters = '0123456789ABCDEF'.split('');
        for(var i = 0; i < color.length; i++){
            var newSaturation = 0;
            if(letters.indexOf(color[i]) + amount > 15) newSaturation = 15;
            else if(letters.indexOf(color[i]) + amount < 0) newSaturation = 0;
            else newSaturation = letters.indexOf(color[i]) + amount;
            color[i] = letters[newSaturation];
        }
        return "#" + color.join('');
    } 
```

您也可以使用正数或负数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-12T17:17:20.250

[您可以利用此解决方案](https://stackoverflow.com/a/5624139/1812984)中提供的 Javascript来满足您的需求

要更改元素的饱和度，请同时移动三个 HEX 值中的每一个，使值更接近 128（256 的一半）。

```
background-color: #FF0000; // rgb(255, 0, 0) 
```

对这个...

```
background-color: #BF4040; // rgb(191, 64, 64) 
```

# android - 手机休眠时服务无法正常运行

> ID：13348134
> 
> 赞同：0
> 
> 时间：2012-11-12T17:08:42.537
> 
> 标签：android, android-service

即使手机处于睡眠状态，我也需要每隔 X 时间收到一次代码通知。

所以，我的设置是一个设置重复警报的服务，当它响起时，它会告诉广播接收器。从那个接收器，我试图启动相同的服务，以便我可以处理一些代码。

当手机唤醒或处于调试模式时，我运行它没有任何问题。但是，当我不调试并且手机处于睡眠状态时，看起来服务没有运行，所以我的警报没有被处理。

我在哪里做错了？我只希望我的应用程序的服务定期处理警报，即使在手机处于睡眠状态时也是如此（在服务中的 Timer 对象遇到相同问题后，我移至警报）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T17:11:12.457

您需要获取唤醒锁。

www.vogella.com/blog/2011/02/07/android-wakelock/

# string - 在目录和所有子目录中查找字符串的批处理脚本

> ID：13348135
> 
> 赞同：3
> 
> 时间：2012-11-12T17:08:43.883
> 
> 标签：string, directory, root

我想编写一个批处理文件，该文件使用 find 命令在父目录和所有子目录中查找字符串，并将该输出打印到文本文件，然后在完成后打开文本文件。到目前为止，我的代码如下所示：

```
@echo off
set /p "var1= Enter the String to Find: "
for /F "delims=" %a in ('dir /B /S *.txt') do @(find /i "%var1" "%a" 1>nul 2>&1 && find /i "%var1" "%a") >> result.txt
start result.txt 
```

但这目前甚至没有向 result.txt 写入任何内容，即使我确信我正在搜索的字符串出现在多个 .txt 文件中。我知道它一定是语法方面的，但我似乎无法弄清楚。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T22:05:47.593

您的脚本中有一些错误：

1.  命令的等号后不应有空格`set`。具体来说，删除`set /p "var1=`.

2.  *要扩展变量，您必须在变量名称之前和之后*放置一个百分号，所以不要`%var`使用`%var%`.

3.  与您的问题没有直接关系，但您为什么要调用`find`两次？

我还使用了一个临时文件，因此`result.txt`不会被`find`.

请注意，如果您从*文件*运行批处理脚本，则在使用循环变量时需要使用双百分号，例如：`%%a`

无论如何，这是固定的脚本，希望能做你想做的事情：

```
@echo off
set RESULT_FILE="result.txt"
set /p "var1=Enter the String to Find: "

pushd %~p0
type NUL > %RESULT_FILE%.tmp
for /f "delims=" %%a in ('dir /B /S *.txt') do (
    for /f "tokens=3 delims=:" %%c in ('find /i /c "%var1%" "%%a"') do (
        for /f "tokens=*" %%f in ('find /i "%var1%" "%%a"') do if %%c neq 0 echo %%f
    )
) >> "%RESULT_FILE%".tmp
move %RESULT_FILE%.tmp %RESULT_FILE% >nul 2>&1

:: Open the file
"%RESULT_FILE%"
popd 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-14T08:28:47.310

只是 findstr abc *

相反， findstr /v 将打印所有没有 abc

# html - 如何使这些 imgs 2 行，溢出浏览器可以看到右滚动？不更改为第 3 行

> ID：13348139
> 
> 赞同：0
> 
> 时间：2012-11-12T17:08:48.910
> 
> 标签：html, css

如何使这些 imgs 2 行，溢出浏览器可以看到右滚动？不更改为第 3 行。

[http://jsfiddle.net/GW3rU/](http://jsfiddle.net/GW3rU/)

```
 <div class="wp">
        <img src="http://guitarcleaning.com/wp-content/uploads/2012/10/black_fender_stratocaster.jpg">
        <img src="http://guitarcleaning.com/wp-content/uploads/2012/10/black_fender_stratocaster.jpg">
        <img src="http://guitarcleaning.com/wp-content/uploads/2012/10/black_fender_stratocaster.jpg">
        <img src="http://guitarcleaning.com/wp-content/uploads/2012/10/black_fender_stratocaster.jpg">
        <img src="http://guitarcleaning.com/wp-content/uploads/2012/10/black_fender_stratocaster.jpg">
        <img src="http://guitarcleaning.com/wp-content/uploads/2012/10/black_fender_stratocaster.jpg">
        <img src="http://guitarcleaning.com/wp-content/uploads/2012/10/black_fender_stratocaster.jpg">
        <img src="http://guitarcleaning.com/wp-content/uploads/2012/10/black_fender_stratocaster.jpg">
        <img src="http://guitarcleaning.com/wp-content/uploads/2012/10/black_fender_stratocaster.jpg">
        <img src="http://guitarcleaning.com/wp-content/uploads/2012/10/black_fender_stratocaster.jpg">
        <img src="http://guitarcleaning.com/wp-content/uploads/2012/10/black_fender_stratocaster.jpg">
        <img src="http://guitarcleaning.com/wp-content/uploads/2012/10/black_fender_stratocaster.jpg">
        <img src="http://guitarcleaning.com/wp-content/uploads/2012/10/black_fender_stratocaster.jpg">
        <img src="http://guitarcleaning.com/wp-content/uploads/2012/10/black_fender_stratocaster.jpg">
    </div> 
```

​</p>

CSS

```
.wp img{
    width:170px;
    height:170px;
}
.wp{
    height: 340px;/*make 2 row?*/
    width: 855px;/*5 column*/

    /*center horizontal*/
    position: absolute;
    margin-top: auto;
    margin-bottom: auto;
    top:0;
    bottom: 0;
} 
```

​</p>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T17:12:49.590

包括`overflow-x: scroll`：

```
.wp{
    height: 340px;/*make 2 row?*/
    width: 855px;/*5 column*/

    /*center horizontal*/
    position: absolute;
    margin-top: auto;
    margin-bottom: auto;
    top:0;
    bottom: 0;
    overflow-x: scroll;
} 
```

**编辑**

好的，现在我得到了你想要的。你的代码之前没问题。您试图将 14 张图片分成 2 行，每行 5 张图片。是对的吗？

您应该将图像数量减少到 10 个，将`.wp`div 的大小增加到 7 个图像，或者在列表中间手动换行。文档会滚动，但 div 不会。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T17:15:59.187

您想在容器上设置溢出以在 x 上滚动。

```
.wp{
height: 340px;/*make 2 row?*/
width: 855px;/*5 column*/

/*center horizontal*/
position: absolute;
margin-top: auto;
margin-bottom: auto;
top:0;
bottom: 0;
overflow-x: scroll;
} 
```

[http://jsfiddle.net/calder12/GW3rU/1/](http://jsfiddle.net/calder12/GW3rU/1/)

# xml - xsl中的递减计数器

> ID：13348143
> 
> 赞同：4
> 
> 时间：2012-11-12T17:09:03.650
> 
> 标签：xml, xslt

如果我使用

```
<xsl:value-of select="position()" /> 
```

在 xsl 中的 for-each 循环中，它非常适用于升序计数器。有什么办法可以将其更改为递减计数器？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-12T17:12:08.013

怎么这么简单...

```
<xsl:value-of select="last()-position()+1" /> 
```

由于[fn:last](http://www.w3.org/TR/xpath-functions/#func-last)返回上下文大小，而[fn:position](http://www.w3.org/TR/xpath-functions/#func-position) - 当前处理的项目的位置，您只需从它们的差中减去 1（因为`position`它的计数从 1 开始，而不是 0）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-13T04:04:39.463

**您可能根本不需要降序计数器**（我猜这个计数器用于索引节点集以以相反的顺序处理它） - 只需使用：

```
<xsl:for-each select="yourNodeSet">
 <xsl:sort select="position()" order="descending" data-type="number"/>

 <!-- Your processing here -->
</xsl:for-each> 
```

# sql-server - SQL Server：删除具有超过 1 条记录的行 (NULL)

> ID：13348150
> 
> 赞同：2
> 
> 时间：2012-11-12T17:09:21.263
> 
> 标签：sql-server, tsql

我有一个包含零件编号和相关组件零件编号和位置的表格。

每个`part_no`可能有多个组件或根本没有。

这是一个例子

```
Part_No | Component_Part_No | Location
-----------------------------------------    
 12345  | NULL              | 001
 50001  | NULL              | 001
 50001  | 4001              | 001
 50001  | 4002              | 001 
```

部件号 5001 以及其他组件具有 NULL 值。我希望能够删除零件 50001 具有 NULL 值的行，但保持零件号 12345 不变。问题是 50001 的 NULL 值在表中不正确，我需要删除这些行。

任何帮助表示赞赏。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-12T17:11:57.530

```
DELETE from table
WHERE component_part_no IS NULL
AND part_no in
    (SELECT part_no 
    FROM table
    WHERE component_part_no IS NOT NULL) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-12T17:11:20.157

```
delete from table where Part_No = 50001 and Component_Part_No IS NULL 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-12T17:31:07.660

可能有更漂亮的编写方式，但这应该可以满足您的要求：

```
delete from Table
where Component_Part_No is null
and Part_No in (select Part_No from Table
                where Component_Part_No is not null) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-14T12:11:20.817

为了做到这一点...零件有组件。如果零件没有已知组件，则存储有关该零件（作为一个整体）位置的信息至关重要，如果零件具有已知组件，则没有组件的记录不正确，是吗？

```
delete parts
from    parts 
    inner join parts selff 
        on parts.Part_no = selff.Part_no 
            and selff.Component_Part_No is not null
where   parts.Component_Part_No is null 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-12T18:16:14.580

```
DECLARE @tab TABLE(Part_No INT,Component_Part_No INT,Location VARCHAR(3))
INSERT INTO @tab
SELECT 12345,NULL,'001' UNION ALL
SELECT 50001,NULL,'001' UNION ALL
SELECT 50001,4001,'001' UNION ALL
SELECT 50001,4001,'001' UNION ALL
SELECT 11111,NULL,'001' UNION ALL
SELECT 11111,5001,'002' UNION ALL
SELECT 22222,NULL,'003' UNION ALL
SELECT 22222,6001,'003' UNION ALL
SELECT 33333,NULL,'003'

SELECT * FROM @tab;

DELETE 
FROM @tab
Part_No IN 
(
SELECT Part_No 
FROM @tab
GROUP BY Part_No
HAVING COUNT(*) > 1
)
AND [@tab].Component_Part_No IS NULL

SELECT * FROM @tab; 
```

SQL 小提琴 - [http://sqlfiddle.com/#!3/613c1/1](http://sqlfiddle.com/#!3/613c1/1)

# php - FROM 处或附近的 PostgreSQL 语法错误

> ID：13348151
> 
> 赞同：1
> 
> 时间：2012-11-12T17:09:25.687
> 
> 标签：php, postgresql

我对这段 PHP 有问题。它的目的是打印从最后一页选择的产品表 - 通过 POST 传递，名称格式为“quantityN”，其中 N 是一个 <150 的数字，表示 CSGames 表中的唯一 ID - 主键。

我知道问题不在于我的 $connection，因为我在最后一页中成功加载了列表。

错误：

```
Warning: pg_query() [function.pg-query]: Query failed: ERROR: syntax error at or near "FROM" LINE 1: ...efnumber,name,platform,price WHERE refnumber='20' FROM CSGam... ^ in /berw/homes1/g/gij2/public_html/cs25010/basket.php on line 102 
```

我的现场项目可以在[这里](http://users.aber.ac.uk/gij2/cs25010/)找到- 索引>目录>篮子。

有谁知道我的代码有什么问题？提前致谢。

```
echo "
<table border='1'>
    <thead>
        <tr>
            <td>
                Title
            </td>
            <td>
                Platform
            </td>
            <td>                                            
                Price
            </td>
            <td>
                Quantity
            </td>
            <td>
                Total price
            </td>
        </tr>
    </thead>
    ";

$id=0;
$sum=0;
while($id<150){ //  Loops through the POST associative array
    if($_POST['quantity'.$id]>0){
        $result=pg_fetch_row(pg_query($connection,"SELECT refnumber,name,platform,price WHERE refnumber='".$id."' FROM CSGames"));
        $total=$result[4]*$_POST['quantity'.$id];
        echo "
            <tr>
                <td>
                    ".$result[1]."
                </td>
                <td>
                    ".$result[2]."
                </td>
                <td>
                    &pound;".$result[3]."
                </td>
                <td>
                    ".$_POST['quantity'.$id]."
                </td>
                <td>
                    &pound;".$total."
                </td>
            </tr>
            ";
        $sum+=$total;
    }
    $id++;
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-12T17:10:54.383

```
SELECT refnumber, name, platform, price FROM CSGames WHERE refnumber='".$id."' 
```

应该管用。SELECT 语句的结构总是这样：

```
SELECT [column names] FROM [table name] WHERE [conditions] 
```

您的查询结构如下：

```
SELECT [column names] WHERE [conditions] FROM [table name] 
```

# java - 在 Jboss 上部署 SIP servlet

> ID：13348152
> 
> 赞同：0
> 
> 时间：2012-11-12T17:09:29.647
> 
> 标签：java, jboss, sip, jain-sip

我是 SIP Servlet 开发的新手，我想知道如何将我的 Sip servlet 部署到我的 Jboss 服务器。我似乎无法通过谷歌搜索找到如何做到这一点。我看到很多关于使用 mobicents 的信息，但我必须这样做吗？我不能像我的 HTTP servlet 一样直接部署吗？

谢谢！

编辑：JAIN sip servlet 和 Sip servlet 之间的确切区别是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T17:30:14.887

Mobicents 为 Jboss 和 tomcat 应用程序服务器提供了部署和运行 sipservlet 应用程序所需的附加模块

如果你下载并解压 jboss 发行版，你会看到部署文件夹中有一些名为 sip-presence、sip-balancer 、 mobicents-media-server-1.0.3.GA.sar 的模块，这些模块很少，你会发现很多附加模块/资源。

您需要做的是从[这里](http://www.mobicents.org/mss-downloads.html)下载 jboss并将您的 sipservlet war 文件部署为正常的 Web 部署。

# c# - 如何在gridview中修剪列

> ID：13348155
> 
> 赞同：0
> 
> 时间：2012-11-12T17:09:44.537
> 
> 标签：c#, gridview, trim

我有一个 gridview，该列有 20 条记录，其值为十进制。比如 5686252.345656 我想修剪这些值。这样我就可以看到 5686252.34。如果我在 c# 代码而不是 SQL 中修剪它会很棒。

我已经绑定了这样的值..

```
<asp:TemplateField HeaderText="Weighted Avg" SortExpression="WT_AVG"
 ItemStyle-HorizontalAlign="Center" HeaderStyle-VerticalAlign="Top" HeaderStyle-Width="70px">
 <ItemTemplate>
  <asp:Label ID="lblWT" runat="server" Text='<%# DataBinder.Eval(Container.DataItem,"WT_AVG") %>' />
 </ItemTemplate>
</asp:TemplateField> 
```

请帮我。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T17:28:19.933

您可以将格式字符串应用于绑定语句：示例：

```
<%# DataBinder.Eval(Container.DataItem, "Price", "{0:c}") %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T17:12:04.397

我会使用 Math.Round(decimal d,int decimals) 例如

```
Math.Round(3.44, 1); //Returns 3.4.
Math.Round(3.45, 1); //Returns 3.4.
Math.Round(3.46, 1); //Returns 3.5.
Math.Round(4.34, 1); // Returns 4.3
Math.Round(4.35, 1); // Returns 4.4
Math.Round(4.36, 1); // Returns 4.4 
```

[http://msdn.microsoft.com/en-us/library/zy06z30k(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/zy06z30k(v=vs.100).aspx)

编辑：或者在 SQL 中执行：

```
SELECT ROUND(123.9994,3), ROUND(123.9995,3)
returns: 123.9990 124.0000 
```

[MSDN 上的四舍五入](http://msdn.microsoft.com/en-us/library/ms175003%28v=sql.100%29.aspx)

# javascript - jQuery 切换在 IE 中不起作用

> ID：13348160
> 
> 赞同：0
> 
> 时间：2012-11-12T17:10:12.000
> 
> 标签：javascript, jquery, wordpress, internet-explorer, cross-browser

我有一些 jQuery 代码在 IE 以外的所有东西上都可以正常工作。切换操作不会触发，也不会隐藏或显示页脚元素。

我尝试使用条件 if 和 else 语句来使用 hide() 和 show() 而不是切换，我还尝试将语言和 src 元素添加到脚本标签，但这些角度都不起作用。我声明了最新的文档类型，并且正在使用最新版本的 wordpress。

谁能看到为什么这在 IE 中不起作用？

```
<script>
$(document).ready(function() {
    $("#clickme").click(function() {
        event.preventDefault()
        $("#footer").toggle(2000);
        $('#menu, #menu2, #menu3, #menu4').hide('slow');
        $(this).html(($('#clickme').text() == 'Show') ? 'Hide' : 'Show');
        $(this).toggleClass("active");
        $(this).attr("title", ($(this).hasClass("active") ? "Show" : "Hide") + " the menu");
    });
});​
</script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T17:19:34.627

您正在使用

```
$("#clickme").click(function() {
    event.preventDefault();//^ event parameter is missing, so causing error
    // ...
}); 
```

它应该是

```
$("#clickme").click(function(event) {
    event.preventDefault(); // ^
    // ...
}); 
```

# java - Spring 在 Tomcat 类路径中找不到属性文件。

> ID：13348161
> 
> 赞同：1
> 
> 时间：2012-11-12T17:10:13.367
> 
> 标签：java, spring, tomcat, properties, classpath

我已将 Spring 配置为查找 conf/database.properties 文件以加载一些配置。这在 Tomcat 和 Junit 测试中运行良好，但在 Tomcat 中，它永远不会加载。下面是这个问题的图片。

***配置：***

![配置1](../Images/cbc9d57780809c8420a58429aa9bd719.png) ***和：***

![配置2](../Images/75cfc145285ebd187753df2833a8a2b2.png)

***项目文件夹中的属性文件：***

![文件夹中的文件](../Images/b57db0ebcb46285891782985df424c5d.png)

***在 Eclipse 中运行 Tomcat 的参数：*** ![运行参数](../Images/a40c8d4017488ee538e2a07636f00aff.png)

***temp0 Tomcat 文件夹，所有正在生成的文件都在哪里 好的：*** ![在 tomcat temp0 文件夹中生成的应用程序](../Images/a4ff5fd534274408639172f3c9c99e0e.png)

***Tomcat 错误日志：***

```
https://gist.github.com/4060538 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-11-12T19:24:37.313

我解决了这个问题。我想我以错误的方式使用弹簧。

我更改了以下内容：

*   在我正在导入/引用的库中，我删除了导入 database.properties 文件的行。
*   我在我的主 Web 应用程序中创建了一个 spring.xml，在该文件中我导入了 database.properties 文件和我需要引用的其他 app-context.xml 文件。

我认为 Spring spring 不会在 jar 之外加载属性文件。您需要在主应用程序中本地加载属性文件，因此需要引用另一个 spring-context.xml 文件。

# android - 在 ListViewItem 的按钮单击中创建 AlertDialog 时，如何从 AlertDialog 的单击处理程序中获取 ListViewItem 的 ViewHolder？

> ID：13348163
> 
> 赞同：3
> 
> 时间：2012-11-12T17:10:18.487
> 
> 标签：android, listview, android-alertdialog

我的 ListViewItems 中有删除按钮。从这些按钮的点击事件中，我想在通过数据库中的 ID 删除项目之前显示一个确认对话框。ID 存储在项目的 ViewHolder 中。

如何从 AlertDialog 的单击处理程序访问项目的 ViewHolder？这是相关的代码。编译器在 onClick(DialogInterface dialog, int whichButton) 内的“V”上阻塞。

我可以将 ID 存储在按钮的标签中，但这感觉很尴尬。

我的目标是最低 API 级别 8，但如果更高的 API 级别对此有解决方案，请告诉我。这是我的第一个 Android 程序，所以很可能有一个明显的解决方案。

```
private static class MyAdapter extends CursorAdapter {
//.....
    @Override
    public View newView(Context context, Cursor cursor, ViewGroup parent) {
        View view = View.inflate(context, R.layout.my_detail, null);
        MyViewHolder holder = new MyViewHolder();
        holder.deleteButton = (Button) view.findViewById(R.id.deleteButton);
        holder.deleteButton.setOnClickListener(deleteButtonClickListener);
        holder.editButton = (Button) view.findViewById(R.id.editButton);
        holder.editButton.setOnClickListener(editButtonClickListener);
        holder.nameTextView = (TextView) view
                .findViewById(R.id.nameTextView);
        holder.itemId = cursor.getLong(cursor
                .getColumnIndex(MyData.ID_COLUMN));
        view.setTag(holder);
        return view;
    } // newView()
//.....
    private OnClickListener deleteButtonClickListener = new OnClickListener() {

        public void onClick(View v) {
            new AlertDialog.Builder(_context)
                    .setTitle("Delete?")
                    .setMessage("Delete item?")
                    .setIcon(android.R.drawable.ic_dialog_alert)
                    .setPositiveButton(android.R.string.yes,
                            new DialogInterface.OnClickListener() {
                                public void onClick(DialogInterface dialog,
                                        int whichButton) {
                                    MyViewHolder holder = (MyViewHolder) ((View) v
                                            .getParent()).getTag();
                                    long itemId = holder.itemId;
                                    _MyData.deleteItem(itemId);
                                }
                            }).setNegativeButton(android.R.string.no, null)
                    .show();
        } // onClick()

    }; // deleteButtonClickListener
//.....
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T17:16:01.580

您的代码实际上看起来不错，唯一需要的更改是`v`需要声明`final`，如下所示：

```
private OnClickListener deleteButtonClickListener = new OnClickListener()
{
    public void onClick(final View v) { }
} 
```

原因在于 Java 如何实现闭包。`v`应该`final`这样我们的`DialogInterface.OnClickListener`in the实现`setPositiveButton()`就可以访问该变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-20T12:17:54.010

```
first implement the onclickevtn

private static class MyAdapter extends CursorAdapte mplements android.view.View.OnClickListener

then set the event for particular 

     holder.editButton.setOnClickListener(this);

then override the class function

    @Override
    public void onClick(View v) {
        if(R.id.editButton==v.getId()){
           ....do something
        }else
}

this will work after struggling i got this way 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T17:22:04.357

在删除按钮中标记 itemid，以便您可以在对话框中检索它

例如

```
holder.deleteButton.setTag(cursor.getLong(cursor
                .getColumnIndex(MyData.ID_COLUMN))); 
```

并在对话框中检索它

```
long itemId = v.getTag(); 
```

# .net - MVC 4 Mocking HttpContext - 如何模拟 DisplayModeProvider

> ID：13348169
> 
> 赞同：10
> 
> 时间：2012-11-12T17:10:38.353
> 
> 标签：.net, asp.net-mvc-4, nunit, moq

我目前正在使用[Scott Hanselmans HTTP 上下文模拟](http://www.hanselman.com/blog/ASPNETMVCSessionAtMix08TDDAndMvcMockHelpers.aspx)进行单元测试。这对 MVC 3 来说效果很好，而且从不回头，我用它来测试对以下代码的调用。

```
public class PartialViewRenderer : IPartialViewRenderer
{
    public string Render(Controller controller, string viewName, object model)
    {
        if (string.IsNullOrEmpty(viewName))
            viewName = controller.ControllerContext.RouteData.GetRequiredString("action");

        controller.ViewData.Model = model;

        using (StringWriter sw = new StringWriter())
        {
            ViewEngineResult viewResult = ViewEngines.Engines.FindPartialView(controller.ControllerContext, viewName);
            ViewContext viewContext = new ViewContext(controller.ControllerContext, viewResult.View,
                                                      controller.ViewData, controller.TempData, sw);
            viewResult.View.Render(viewContext, sw);

            return sw.GetStringBuilder().ToString();
        }
    }
} 
```

当我第一次将我的应用程序转换为 MVC 4 时，我遇到了问题，它出现了运行时异常。因此，我尝试通过并修复需要修复的内容，这使我改变了 Hanselmans MockHelpers 上的以下方法：（我基本上更改了 HttpContext.Items 以获取返回，因为它吹出了“null”异常）

```
 public static HttpContextBase FakeHttpContext()
    {
        var context = new Mock<HttpContextBase>();
        var request = new Mock<HttpRequestBase>();
        var response = new Mock<HttpResponseBase>();
        var session = new Mock<HttpSessionStateBase>();
        var server = new Mock<HttpServerUtilityBase>();
        var cookies = new HttpCookieCollection();
        var items = new ListDictionary();

        request.Setup(r => r.Cookies).Returns(cookies);
        response.Setup(r => r.Cookies).Returns(cookies);

        context.Setup(ctx => ctx.Items).Returns(items);

        context.SetupGet(ctx => ctx.Request).Returns(request.Object);
        context.SetupGet(ctx => ctx.Response).Returns(response.Object);
        context.SetupGet(ctx => ctx.Session).Returns(session.Object);
        context.SetupGet(ctx => ctx.Server).Returns(server.Object);

        return context.Object;
    }

 public static void SetFakeControllerContext(this Controller controller, RouteData route)
    {
        var httpContext = FakeHttpContext();

        ControllerContext context = new ControllerContext(new RequestContext(httpContext, route), controller);

        controller.ControllerContext = context;
    } 
```

这是一个非常简单的 nUnit 测试，我必须尝试确定我需要对这个 http 上下文模拟进行哪些更改（我什至还没有放入断言）

```
 [Test]
    public void test()
    {
        _contactsController = _container.Resolve<ContactsController>();

        var route = new RouteData();

        route.Values.Add("controller", "ContactsController");
        route.Values.Add("action", "GetEditContactDetailsDialog");

        _contactsController.SetFakeControllerContext(route);

        var result = _contactsController.GetEditContactDetailsDialog("1");
    } 
```

现在，当我运行此测试时，它会在 PartialViewRenderer.Render 在线调用上炸毁`ViewEngineResult viewResult = ViewEngines.Engines.FindPartialView(controller.ControllerContext, viewName);` 这是以下堆栈跟踪。

> 在 System.Web.WebPages.DisplayModeProvider.<.ctor>b__2(HttpContextBase context) 在 System.Web.WebPages.DefaultDisplayMode.CanHandleContext(HttpContextBase httpContext) 在 System.Web.WebPages.DisplayModeProvider.<>c__DisplayClass6.b__5(IDisplayMode 模式)在 System.Linq.Enumerable.WhereListIterator `1.MoveNext() at System.Collections.Generic.List`1..ctor(IEnumerable `1 collection) at System.Linq.Enumerable.ToList[TSource](IEnumerable`1 源) 在 System.Web.WebPages.DisplayModeProvider.GetAvailableDisplayModesForContext(HttpContextBase httpContext, IDisplayMode currentDisplayMode) 在 System.Web.Mvc.VirtualPathProviderViewEngine.GetPath(ControllerContext controllerContext, String[ ] 位置，字符串 [] areaLocations，字符串位置属性名称，字符串名称，字符串控制器名称，字符串 cacheKeyPrefix，布尔 useCache，字符串 []& 搜索位置）

看来我无法进入那里并模拟 DisplayModeProvider。 [根据 MVC 源代码](http://aspnetwebstack.codeplex.com/SourceControl/changeset/view/aec4b34a99c0#src/System.Web.WebPages/DefaultDisplayMode.cs)有没有人对此有解决方案？我无法在任何地方找到解决方案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-23T12:14:40.573

首先，init 模拟`MockBehavior.Strict`如下：

```
var context = new Mock<HttpContextBase>(MockBehavior.Strict); 
```

使用它，您可以找到与 DisplayMode 的依赖关系。

其次，DisplayMode 是 asp.net mvc 4 中的新特性：

[http://www.asp.net/whitepapers/mvc4-release-notes#_Toc303253810](http://www.asp.net/whitepapers/mvc4-release-notes#_Toc303253810)

因此，它获取`Request.Browser`用于确定 View 的参数。为浏览器添加 Mock：

```
var browser = new Mock<HttpBrowserCapabilitiesBase>(MockBehavior.Strict);
var context = new Mock<HttpContextBase>(MockBehavior.Strict);
var request = new Mock<HttpRequestBase>(MockBehavior.Strict);
var response = new Mock<HttpResponseBase>(MockBehavior.Strict);
var session = new Mock<HttpSessionStateBase>(MockBehavior.Strict);
var server = new Mock<HttpServerUtilityBase>(MockBehavior.Strict);
var cookies = new HttpCookieCollection();
var items = new ListDictionary();

browser.Setup(b => b.IsMobileDevice).Returns(false);

request.Setup(r => r.Cookies).Returns(cookies);
request.Setup(r => r.ValidateInput());
request.Setup(r => r.UserAgent).Returns("Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.64 Safari/537.11");
response.Setup(r => r.Cookies).Returns(cookies);

request.Setup(r => r.Browser).Returns(browser.Object);
context.Setup(ctx => ctx.Items).Returns(items); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T17:58:45.633

`DisplayMode` implements the interface `IDisplayMode`, so you should be able to (with Moq) create a mock to inject. `DisplayModeProvider` has a `SetDisplayMode` (protected) method you may be able to invoke via Reflection.

# c - 在链接 C 和 Fortran 代码以构建 Matlab mex 文件时打开 Watcom 链接器查找未定义的引用

> ID：13348172
> 
> 赞同：1
> 
> 时间：2012-11-12T17:10:51.230
> 
> 标签：c, matlab, linker, fortran, mex

使用 Windows 7、Matlab R2011a（32 位）和 Open Watcom 版本 1.8，我正在尝试编译调用 Fortran 代码的 C MEX 文件。

按照 Matlab 网站（[支持链接](http://www.mathworks.com/support/solutions/en/data/1-155BQG/?solution=1-155BQG)）上发布的说明，我首先使用以下命令编译了 Fortran 目标文件：

```
wfl386 -c -fpi87 -SC getqpf.f 
```

然后我尝试将目标文件链接到许多 C 文件。所有 C 文件都能正确编译，但我收到以下链接错误。未定义的引用用于 C 文件中从`getqpf.f`. 例如，`QESTM`在其中一个 C 文件中定义为函数，如`int qestm_()`.

该`q_estimate.c`文件包含 MEX 程序的入口点函数。这个想法是让入口点函数调用`getqpf.f`. 中的子例程`getqpf.f`调用其他文件中的 C 代码函数。

我怎样才能摆脱未定义的引用？

```
>> mex q_estimate.c paul2.c paul2_L1.c paul6.c paul6_L1.c runavg.c fit_slope.c getqpf.obj
Open Watcom Linker Version 1.8 
Portions Copyright (c) 1985-2002 Sybase, Inc. All Rights Reserved. 
Source code is available under the Sybase Open Watcom Public License. 
See http://www.openwatcom.org/ for details. 
loading object files 
searching libraries 
Error! E2028: QESTM is an undefined reference 
Error! E2028: QESTM1 is an undefined reference 
Error! E2028: QESTF is an undefined reference 
Error! E2028: QESTF1 is an undefined reference 
creating a Windows NT dynamic link library 
file getqpf.obj(E:\DEVELOPMENT-FINAL\EXPERIMENTS\test-Q-analysis\getqpf.f): undefined symbol QESTM 
file getqpf.obj(E:\DEVELOPMENT-FINAL\EXPERIMENTS\test-Q-analysis\getqpf.f): undefined symbol QESTM1 
file getqpf.obj(E:\DEVELOPMENT-FINAL\EXPERIMENTS\test-Q-analysis\getqpf.f): undefined symbol QESTF 
file getqpf.obj(E:\DEVELOPMENT-FINAL\EXPERIMENTS\test-Q-analysis\getqpf.f): undefined symbol QESTF1 
  C:\PROGRA~2\MATLAB\R2011A~1\BIN\MEX.PL: Error: Link of 'q_estimate.mexw32' failed. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T17:53:42.677

由于 C 的命名区分大小写，您是否尝试过将函数定义为`int QESTM_()`而不是`int qestm_()`？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T20:02:29.273

只是为了完整起见：Open Watcom F77 程序员指南（可[在此处](http://www.openwatcom.org/index.php/Reference_Manuals)获得）指定：

> 默认符号命名约定因编译器而异。在编译过程中，Watcom C/C++ 将下划线字符添加到变量名称的开头，并将下划线添加到函数名称的末尾。Watcom FORTRAN 77 将符号转换为大写。辅助编译指示可用于解决这种不一致。

然后，该文档继续解释如何使 Watcom C/C++ 编译器对外部符号执行相同的转换，以便 C 代码可以调用 Fortran 例程，以及使 Fortran 代码的外部符号类似于 C，所以Fortran 代码可以调用 C 例程。尚不清楚该机制是否可以反向工作，即强制以特定情况导出 Fortran 例程符号。

为此，您可以使用特殊的编译指示，它可用于处理外部符号获取的情况：

```
*$pragma aux cname "!_" 
```

其中`cname`是外部符号的名称，在您的 C 代码中定义。`"!_"`告诉编译器使用带有下划线的小写版本的名称（这假定 C 文件是使用 Open Watcom C/C++ 编译器编译的）。如果 C 编译器不附加下划线，那么您应该使用`"!"`。因此，如果将以下内容添加到 Fortran 代码中，则可能不需要在 C 代码中使用大写名称：

```
*$pragma aux qestm "!_"
*$pragma aux qestm1 "!_"
*$pragma aux qestf "!_"
*$pragma aux qestf1 "!_" 
```

也可以像这样指定外部名称：

```
*$pragma aux qestm "qEsTm_" 
```

或者

```
*$pragma aux qestm "qEsTm" 
```

取决于 C 编译器是否添加下划线。然后 Fortran 代码将引用(or )`qestm`的有趣名称下的符号。当然，您必须使用C 函数的名称。这里的重点是引号内的名称保留了大小写。`qEsTm_``qEsTm``qEsTm`

# debugging - 调试时没有显示 Wp7 背景图像

> ID：13348173
> 
> 赞同：0
> 
> 时间：2012-11-12T17:10:53.333
> 
> 标签：debugging, windows-phone-7

我是 WP7 编程的新手，但在其他平台上使用 XP，我只是在学习所有基础知识，以便了解该语言，但我遇到了一个障碍，我已经为我的背景图像输入了一个来源：

```
<Grid x:Name="LayoutRoot">
    <Grid.Background>
        <ImageBrush ImageSource="C:/users/hypernova/pictures/Background1.jpg">
        </ImageBrush>
    </Grid.Background>
</Grid> 
```

并且图像在 XAML 旁边的设计选项卡中显示为背景，但是当我调试并且模拟器启动它只是一个黑屏没有背景图像时，我错过了什么？我尝试过其他设置背景的方法，例如：

```
<Grid x:Name="LayoutRoot">
  <Canvas>
    <Canvas.Background>
      <ImageBrush ImageSource="C:/users/hypernova/pictures/Background1.jpg">
      </ImageBrush>
    </Canvas.Background>
  </Canvas>
</Grid> 
```

但同样的事情发生了，我也尝试了其他一些方法，但还是没有，我确定我错过了我应该抓住的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T17:27:55.067

路径

> C:/users/hypernova/pictures/Background1.jpg

存在于您的开发机器上，而不是任何 Windows Phone 7+ 设备上。

请记住，用户将从商店下载您的应用程序，然后在他们的手机上运行它。他们将如何访问您的硬盘并获取该图像？

不幸的是，由于设计表面允许您这样做，因此对于新开发人员来说当然会感到困惑。

您应该做的是*将您的图像作为 Resource 添加到您的项目中*，然后*[通过](http://msdn.microsoft.com/en-us/library/aa970069%28v=VS.85%29.aspx)**[URI](http://msdn.microsoft.com/en-us/library/aa970069%28v=VS.85%29.aspx)**引用该资源[`pack`](http://msdn.microsoft.com/en-us/library/aa970069%28v=VS.85%29.aspx)*（除非您想把自己吓傻，否则不要单击该链接）。

要将其添加为资源，只需将图像添加到 WP7 项目的根目录，右键单击它，选择属性，然后将构建操作更改为资源（请注意，不是嵌入式资源）。

接下来，您必须`pack`为此资源构造一个 URI。这……不容易。您可以使用 Visual Studio 中的工具来执行此操作，方法是在设计器中编辑 ImageBrush 的属性。这是最简单且推荐的路线。您所要做的就是在“属性”工具窗口中编辑`ImageSource`您`ImageBrush`的，然后从解决方案中的可用图像列表中选择图像。

另一种方法是手动构造`pack`URI。例如，你可以采取以下

> /[项目程序集名称];component/Background1.jpg

替换`[project assembly name]`为您的程序集的名称（无扩展名），并将其用作您的`ImageSource`值。您可以通过查看项目属性的应用程序部分下的程序集名称来找到正确的项目程序集名称。

```
<ImageBrush ImageSource="/MyWp7Application;component/Background1.jpg"/> 
```

**请注意**，根据您的项目文件夹结构的构建方式，**此 URI 可能会有所不同**。在提供的工具之外构建正确的 URI 是一项值得讨论的任务。

# c# - 将 Lambda 选择器作为参数传递

> ID：13348196
> 
> 赞同：2
> 
> 时间：2012-11-12T17:12:26.847
> 
> 标签：c#, lambda

我正在处理一些报告代码，我发现自己重复了一段代码，其中包含一个 where 和 select cause 一遍又一遍？唯一改变的信息是目标字段。

```
 private static void UpdateResultsListInstructions(List<ManagementInfo> managementInfo, KeyValuePair<int, int> item)
    {
        managementInfo
            .Where(m => m.YearMonthNo == item.Key)
            .Select(m => m.VolumeOfInstructionsReceivedInMonth = item.Value)
            .ToList();
    }

    private static void UpdateResultsListClaims(List<ManagementInfo> managementInfo, KeyValuePair<int, int> item)
    {
        managementInfo
            .Where(m => m.YearMonthNo == item.Key)
            .Select(m => m.VolumeOfClaimsCancelled = item.Value)
            .ToList();
    } 
```

是否可以将选择器作为参数传递，以便我可以重用一种方法？

沿着

```
UpdateCommonResultsList(managementInfo, item, (m => m.VolumeOfClaimsCancelled = item.Value)) 
```

我可能可以重新调整所有代码，这样就没有必要了，但现在我已经想到我想看看它是否可能。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-12T17:17:33.080

虽然我不喜欢使用`Select`更新*列表*- 我误读了这个问题，因为这样做并不常见！- 你*可以*这样做：

```
private static void UpdateCommonResultsList(
    List<ManagementInfo> managementInfo,
    KeyValuePair<int, int> item,
    Action<ManagementInfo, int> action)
{
    managementInfo
        .Where(m => m.YearMonthNo == item.Key)
        .Select(m => { action(m, item.Value); return item.Value; })
        .ToList();
} 
```

调用为

```
UpdateCommonResultsList(
    managementInfo,
    item,
    (m, i) => m.VolumeOfClaimsCancelled = i); 
```

如果您这样做，您的代码将更加传统

```
private static void UpdateCommonResultsList(
    List<ManagementInfo> managementInfo,
    KeyValuePair<int, int> item,
    Action<ManagementInfo, int> action)
{
    foreach (ManagementInfo m in managementInfo
        .Where(m => m.YearMonthNo == item.Key))
    {
        action(m, item.Value);
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-12T17:17:03.617

Select 方法采用类型参数，`Func<TSource, TResult>`因此您可以在方法中使用该类型，然后将其作为 lambda 表达式传入。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-12T17:23:16.400

您可以通过这样的操作来更新方法：

```
UpdateResultsListClaims(managementInfo,
  (m) => m == someItem.Key,
  (m, newData) => m.VolumeOfClaimsCancelled = someItem.Value)

private static void UpdateResultsListClaims(List<ManagementInfo> managementInfo,
Func<bool> updateCondition, Action<ManagementInfo> updateAction)
    {
        managementInfo
            .Where(m => updateCondition(m))
            .ToList()
            .ForEach(m => updateAction(m));
    } 
```

**更新 1** 为了提高可读性，您可以调用：

```
UpdateResultsListClaims(managementInfo,
  updateCondition: (m) => m == someItem.Key,
  updateAction: (m, newData) => m.VolumeOfClaimsCancelled = someItem.Value) 
```

**更新 2**为了在许多地方方便使用，您可以制作这样的扩展方法

```
public static void UpdateResults(this List<ManagementInfo> managementInfo,
Func<bool> updateCondition, Action<ManagementInfo> updateAction)
    {
        managementInfo
            .Where(m => updateCondition(m))
            .ToList()
            .ForEach(m => updateAction(m));
    } 
```

并这样称呼它

```
managementInfo.UpdateResults(
  updateCondition: (m) => m == someItem.Key,
  updateAction: (m, newData) => m.VolumeOfClaimsCancelled = someItem.Value) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-12T17:20:23.440

```
private static void UpdateCommonResultsList<T>(List<ManagementInfo> managementInfo, KeyValuePair<int, int> item, Func<ManagementInfo,T> updateFunc)
    {
        managementInfo
            .Where(m => m.YearMonthNo == item.Key)
            .Select(m => updateFunc(m))
            .ToList();
    } 
```

然后调用为：

```
UpdateCommonResultsList(managementInfo, item, (m => m.VolumeOfClaimsCancelled = item.Value)); 
```

# java - 在用于 Selenium 测试的 Maven 项目中使 System.setProperty 平台独立

> ID：13348201
> 
> 赞同：2
> 
> 时间：2012-11-12T17:12:47.750
> 
> 标签：java, maven, automated-tests, selenium-webdriver, selenium-chromedriver

我目前正在使用 Java 在 Maven 中使用 webdriver 创建 selenium 自动化。现在要初始化 Chrome 和 IE 等浏览器，我必须设置系统属性，例如

`System.setProperty("webdriver.chrome.driver", "F:\\somewhereintheworkingdir\\drivers\chromedriver.exe");`

现在，我的可交付成果是 JAR。我正在使用 maven，所以目前位于 main>resources>drivers>chromedriver.exe

所以打包后它会在 root>drivers>chromedriver.exe 下

那么如何使系统属性在这两种情况下都可以运行呢？

我研究了一些常量，比如`java.class.path`or`java.file.seperator`等​​，但我不确定它们在这种情况下会有什么用处。

我希望有一个人可以帮助我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T15:45:50.257

我建议看看这个：

[https://github.com/Ardesco/Selenium-Maven-Template](https://github.com/Ardesco/Selenium-Maven-Template)

相关部分是使用此插件的 POM：

```
<properties>
    <standalone.binary.root.folder>${project.basedir}/selenium_standalone_binaries</standalone.binary.root.folder>
</properties>

<profiles>
    <profile>
        <id>selenium-tests</id>
        <build>
            <plugins>
                <plugin>
                    <groupId>com.lazerycode.selenium</groupId>
                    <artifactId>driver-binary-downloader-maven-plugin</artifactId>
                    <version>0.9.2</version>
                    <configuration>
                        <rootStandaloneServerDirectory>${standalone.binary.root.folder}</rootStandaloneServerDirectory>
                        <downloadedZipFileDirectory>${project.basedir}/selenium_standalone_zips</downloadedZipFileDirectory>
                        <customRepositoryMap>${project.basedir}/RepositoryMap.xml</customRepositoryMap>
                    </configuration>
                    <executions>
                        <execution>
                            <goals>
                                <goal>selenium</goal>
                            </goals>
                        </execution>
                    </executions>
                </plugin>
            </plugins>
        </build>
    </profile>
</profiles> 
```

并在它拉入二进制文件位置的基类中：

```
private static ResourceBundle _prop = ResourceBundle.getBundle("dev");
//Load standalone executable if required
switch (browserType) {
    case CHROME:
        if (System.getProperties().getProperty("os.arch").toLowerCase().equals("x86_64") || System.getProperties().getProperty("os.arch").toLowerCase().equals("amd64")) {
            if (System.getProperties().getProperty("os.name").toLowerCase().contains("windows")) {
                System.setProperty("webdriver.chrome.driver", _prop.getString("binaryRootFolder") + "/windows/googlechrome/64bit/26/chromedriver.exe");
            } else if (System.getProperties().getProperty("os.name").toLowerCase().contains("mac")) {
                System.setProperty("webdriver.chrome.driver", _prop.getString("binaryRootFolder") + "/osx/googlechrome/64bit/26/chromedriver");
            } else if (System.getProperties().getProperty("os.name").toLowerCase().contains("linux")) {
                System.setProperty("webdriver.chrome.driver", _prop.getString("binaryRootFolder") + "/linux/googlechrome/64bit/26/chromedriver");
            }
        } else {
            if (System.getProperties().getProperty("os.name").toLowerCase().contains("windows")) {
                System.setProperty("webdriver.chrome.driver", _prop.getString("binaryRootFolder") + "/windows/googlechrome/32bit/26/chromedriver.exe");
            } else if (System.getProperties().getProperty("os.name").toLowerCase().contains("mac")) {
                System.setProperty("webdriver.chrome.driver", _prop.getString("binaryRootFolder") + "/osx/googlechrome/32bit/26/chromedriver");
            } else if (System.getProperties().getProperty("os.name").toLowerCase().contains("linux")) {
                System.setProperty("webdriver.chrome.driver", _prop.getString("binaryRootFolder") + "/linux/googlechrome/32bit/26/chromedriver");
            }
        }
        break;
    case IE:
        if (System.getProperties().getProperty("os.arch").toLowerCase().equals("x86_64") || System.getProperties().getProperty("os.arch").toLowerCase().equals("amd64")) {
            System.setProperty("webdriver.ie.driver", _prop.getString("binaryRootFolder") + "/windows/internetexplorer/64bit/2.29.0/IEDriverServer.exe");
        } else {
            System.setProperty("webdriver.ie.driver", _prop.getString("binaryRootFolder") + "/windows/internetexplorer/32bit/2.29.0/IEDriverServer.exe");
        }
        break;
} 
```

您还需要在 src/main/resources 中有一个属性文件（必须在 main 中，而不是在 test 中），maven 可以在构建时更新它以传递在 POM 中设置的属性/在命令行上覆盖。

该文件如下所示：

```
binaryRootFolder=${standalone.binary.root.folder} 
```

最简单的做法是克隆在此答案开头链接到的项目，然后运行：

```
mvn verify -Pselenium-tests 
```

这将向您展示一切正常，并为您提供良好的起点。

# c# - 如何保持按下“控制”按钮？

> ID：13348202
> 
> 赞同：1
> 
> 时间：2012-11-12T17:12:47.577
> 
> 标签：c#, .net, autohotkey

如何从.Net模拟保持按钮“控制”向下的事件？

我正在尝试`SendKeys.SendWait("{Ctrl Down}");`如此处所述：

[http://www.autohotkey.com/docs/commands/Send.htm](http://www.autohotkey.com/docs/commands/Send.htm)

但它不起作用（它说命令无法识别）。

只是澄清我不想执行命令这样`Ctrl`+其他一些键......我只想一直`Ctrl`按下。

有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T17:34:20.260

您不能`Ctrl`一直模拟按下，您必须将 ^ 添加到每个发送命令，如下所示：

```
SendKeys.Send("^{DOWN}"); 
```

在此处查看文档：[SendKeys.Send 方法](http://msdn.microsoft.com/en-us/library/system.windows.forms.sendkeys.send.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T17:28:24.607

在 Autohotkey 中，此脚本执行您想要的操作：

```
Send,{Ctrl DOWN} 
```

您可以通过手动按下和释放来摆脱该状态`Ctrl`。

但是，您似乎将 C# 与 Autohotkey 混为一谈。如果您尝试使用 C# 使用该链接页面上的信息，它将无法正常工作。Autohotkey 脚本不是 C#。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T17:30:46.883

.Net`SendKeys`类不能做 AutoHotkey 能做的所有事情。

它只能执行此处列出的操作：

*   [http://msdn.microsoft.com/en-us/library/system.windows.forms.sendkeys.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.sendkeys.aspx)

您可以实现您想要的，但只能使用更高级的编程技术。

您可能必须使用 Windows UI 自动化：

*   [http://msdn.microsoft.com/en-us/library/ms747327.aspx](http://msdn.microsoft.com/en-us/library/ms747327.aspx)

# booggie - 如何在规则中执行脚本并将值传递回 booggie 2 中的规则？

> ID：13348209
> 
> 赞同：0
> 
> 时间：2012-11-12T17:13:08.633
> 
> 标签：booggie

在 booggie 2 中，如何从规则中执行脚本（用 Python 编程）并将脚本的返回值传递给规则？

请注意：booggie 项目不再存在，但导致开发了涵盖相同功能的[Soley Studio 。](https://www.soley.io/en/pr-soley-studio/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T17:13:08.633

`exec`是从规则中执行规则和脚本的命令。后面是括号，其中包含由规则和脚本组成的序列。

执行规则中的应用程序顺序有严格的顺序，（参见[GrGen.NET 中规则右侧如何执行的固定顺序？](https://stackoverflow.com/questions/13378043)）。`exec`始终是执行的最后一条语句（`return`当然是在此之前）。因此，我们不能从`exec`to传递变量`eval`。因此，脚本执行产生的变量`exec`必须分配给`exec`语句中的节点/边缘属性。为此，我们使用大括号并编写与`eval`语句相同的代码。

在以下示例中，调用了一个脚本，该脚本返回三个给定值（*a.value、b.value、c.value*）中的最大值并将其存储为节点的属性（*d.value*）。

```
 exec ((max_value) = getMaxValue(a.value, b.value, c.value) ;>
            {
                d.value = max_value;
            }
        ); 
```

# android - Nexus 7 上未调用 Android Jellybean onCreateOptionsMenu

> ID：13348213
> 
> 赞同：5
> 
> 时间：2012-11-12T17:13:40.970
> 
> 标签：android

我有一个带有四个选项卡的 TabActivity。当我设置 android:targetSdkVersion="15" 在 Nexus 7 上进行测试时，不会在任何选项卡活动上调用 onCreateOptionsMenu 方法。

它适用于 android:targetSdkVersion="10"。

使用 android:targetSdkVersion="15" 当活动不在 TabActivity 中以及在手机 (Evo) 上进行测试时，它可以正常工作。

这是 onCreateOptionsMenu 的代码。

```
public boolean onCreateOptionsMenu(Menu menu) {
    Log.i("Test","Base In create option menu");
    if( menuId != null ) {
        new MenuInflater(this).inflate(menuId,menu);
    }
    return super.onCreateOptionsMenu(menu);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-10T03:07:39.297

对不起，但这是一个简单的。根据谷歌：

[http://developer.android.com/guide/topics/ui/menus.html](http://developer.android.com/guide/topics/ui/menus.html)

因此，如果您将目标 SDK 设置得较低，则可以显示已弃用的选项栏。对于较新的 SDK，您需要使用操作栏或其他形式的导航。基本上谷歌决定不是所有的设备都有一个“菜单”按钮。

# linq - EF CF Linq-to-Sql，保存附加的子实体？（.NET 4）

> ID：13348214
> 
> 赞同：1
> 
> 时间：2012-11-12T17:13:44.300
> 
> 标签：linq, entity-framework, linq-to-sql, ef-code-first

我得到这个代码来只更新对象的特定字段。

```
var myEntity = new DBEntity { Id = 1, Field1 = true, Field2 = "Test" };
context.DBEntities.Attach(myEntity);
var entry = context.Entry(myEntity);
entry.Property(x => x.Field1).IsModified = true;
entry.Property(x => x.Field2).IsModified = true;
context.SaveChanges(); 
```

这工作完美。现在我想向我的实体对象添加一个日志条目，每次有人进行更新时，我都想在我的日志中跟踪它。

```
var myEntity = new DBEntity { Id = 1, Field1 = true, Field2 = "Test" };
var logEntry = new DBEntityLog { LogText = "Update to field1 and field2" };
myEntity.Logs.Add(logEntry);
context.DBEntities.Attach(myEntity);
var entry = context.Entry(myEntity);
entry.Property(x => x.Field1).IsModified = true;
entry.Property(x => x.Field2).IsModified = true;
// Property does not work on collection objects
context.SaveChanges(); 
```

现在如何将 logEntry 也保存到数据库中？现在它仍然只会更新字段。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T15:47:50.153

通过获取日志条目并将 EntityState 设置为添加解决了问题。

```
var entryLog = cibtext,Entry(logEntry); 
entryLog.State = EntityState.Added; 
```

# java - Java中的自动委托

> ID：13348215
> 
> 赞同：6
> 
> 时间：2012-11-12T17:13:46.997
> 
> 标签：java, delegates

我想为将在运行时生成的对象添加一些功能。但是，这个对象的接口非常大（并且不在我的控制之下）。我想将对象包装在我自己的类中，它添加了我想要的功能并将标准接口功能委托给原始对象 - 有没有办法在 Java 中做到这一点，而无需为每个对象创建 1 行复制粘贴委托方法接口中的方法？

我想避免的：

```
class MyFoo implements Foo {
  Foo wrapped;

  void myMethod() { ... }

  void interfaceMethod1() wrapped.interfaceMethod1();
  int interfaceMethod2() wrapped.interfaceMethod2();
  // etc etc ...
} 
```

我更喜欢什么：

```
class MyFoo implements Foo {
  Foo wrapped;

  void myMethod() { ... }

  // automatically delegate undefined methods to wrapped object
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-12T17:15:09.443

听起来您需要一个[动态代理](https://docs.oracle.com/javase/8/docs/technotes/guides/reflection/proxy.html)并仅拦截您想要覆盖的方法。

> 动态代理类是实现在运行时指定的接口列表的类，这样通过类实例上的一个接口的方法调用将被编码并通过统一接口分派到另一个对象。因此，动态代理类可用于为接口列表创建类型安全的代理对象，而无需预先生成代理类，例如使用编译时工具。*动态代理类实例上的方法调用被分派到实例的调用处理程序中的单个方法*，并且它们使用标识被调用方法的 java.lang.reflect.Method 对象和包含对象类型的数组进行编码论据

（我的重点）

通过实现[InvocationHandler](https://docs.oracle.com/javase/7/docs/api/java/lang/reflect/InvocationHandler.html)您只需创建一个方法来接收对该对象的每个调用（实际上是您上面描述的）

# android - 如何将现有的 Thread.sleep() 更改为警报管理器

> ID：13348216
> 
> 赞同：0
> 
> 时间：2012-11-12T17:13:49.650
> 
> 标签：android, multithreading, handler

现在我使用 thread.sleep(3000) 并每 3 秒打印一次日志中的数据，但现在我想将其更改为 15 分钟。什么最好用？是警报管理器还是处理程序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T17:19:50.290

有什么问题：

```
thread.sleep(1000*60*15) 
```

# ruby - 对 Ruby 中数组中的每个值执行相同的操作

> ID：13348217
> 
> 赞同：0
> 
> 时间：2012-11-12T17:13:54.407
> 
> 标签：ruby

我有一个股票代码的文本文件，每个符号都在自己的行上。在 Ruby 中，我从文本文件中创建了一个数组，如下所示：

```
symbols = []
File.read('symbols.txt').each_line do |line|
  symbols << line.chop!
end 
```

对于数组中的每个符号，我想从一个 json 文件（例如 MSFT.json）中读取并执行一些计算（现在所有这些都在工作），然后对数组中的下一个符号执行相同的操作。

当尝试“调用”并对数组中的第一项执行计算时，我这样做了：

```
json = File.read("#{symbols[0]}.json")
#...calculations come after this 
```

这工作得很好，它确实为第一个符号运行了整个程序，但当然不会继续对剩余的符号执行相同的步骤（我知道那是因为我在数组中指定了一个索引]。

现在我知道该程序适用于单个符号，我现在希望它在数组中的所有符号上运行......所以在第一个块之后，我尝试添加：`symbols.each do`，并`[0]`从`File.read`行中删除（并添加`end`在计算结束）。我希望它会遍历每个符号的“do”和“end”之间的所有内容。那没有用。

然后我尝试在第一个块之后添加它：

```
def page(symbols, i)
  page[i]
end 
```

并将行更改`File.read`为：`json = File.read("#{page[i]}.json)`

但这也没有用。

任何帮助表示赞赏。非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T17:24:51.793

您可以简单地使用`.each`而不是迭代器索引：

```
symbols.each do |symbol|
  json = File.read("#{symbol}.json")
  # do some calculation for symbol
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T20:14:08.363

无需迭代两次：

```
open('symbols.txt').lines.each do |line|
  symbol = line.strip
  json = File.read("#{symbol}.json")
  # process json
end 
```

# c# - 通用参数。如何传递给构造函数然后添加到列表中？

> ID：13348218
> 
> 赞同：3
> 
> 时间：2012-11-12T17:14:06.730
> 
> 标签：c#, generics

我有课

```
class ExpiryList
{
    protected ConcurrentDictionary <GenericType, DateTime> m_list;

    ExpiryList(GenericType obj, DateTime expiryDate)
    {
        m_list.AddOrUpdate(obj, expiryDate, (x, y) => { return expiryDate; });
    }
} 
```

我想知道如何实现这一点？我需要一种方法来创建此类的实例，该实例将 int、string、String、double 等存储到 GenericType 变量中。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-12T17:15:53.187

您可以使您的类通用：

```
class ExpiryList<TAnyType>
{
    protected ConcurrentDictionary <TAnyType, DateTime> m_list;

    ExpiryList(TAnyType obj, DateTime expiryDate)
    {
        m_list.AddOrUpdate(obj, expiryDate, (x, y) => { return expiryDate; });
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-12T17:15:14.023

您正在尝试创建一个通用类：

```
public class ExpiryList<T> 
```

# javascript - 使用 Javascript 的正则表达式中不区分大小写

> ID：13348221
> 
> 赞同：1
> 
> 时间：2012-11-12T17:14:14.790
> 
> 标签：javascript, regex

> **可能重复：**
> [javascript中不区分大小写的正则表达式](https://stackoverflow.com/questions/3939715/case-insensitive-regex-in-javascript)

现在我有这个：

```
my_list.match(new RegExp("(?:^|,)"+my_name+"(?:,|$)"))) 
```

其中，鉴于以下情况：

```
my_list = "dog, cat, boy"
my_name = "dog" 
```

会返回真。

但是，如果我有

```
my_list = "Dog,Cat,boy" 
```

和

```
my_name = "boy" 
```

正则表达式不匹配。我将如何适应以便能够与不区分大小写的匹配？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T17:31:17.847

首先：永远不要从未转义的变量构建正则表达式。使用此函数首先转义所有特殊字符：

```
RegExp.quote = function(str) {
  return str.replace(/[.?*+^$[\]\\(){}|-]/g, "\\$&");
}; 
```

它修改了`RegExp`对象，您只需要包含它一次。现在：

```
function stringContains(str, token) {
  var 
    spaces = /^\s+|\s+$/g,              // matches leading/trailing space
    token = token.replace(spaces, ""),  // trim the token
    re = new RegExp("(?:^|,)\\s*" + RegExp.quote(token) + "\\s*(?:,|$)", "i");

  return re.test(str);
}

alert( stringContains("dog, cat, boy", " Dog ") ); 
```

笔记

*   这`"i"`使得`new RegExp`大小写不敏感。
*   两者添加`\s*`允许逗号之前/之后的空格。
*   事实`"(?:^|,)\\s*"`是正确的，而不是`"(?:^|,)\s*""`（在 JS 字符串中，所有反斜杠都需要转义）。

# haskell - 如何实现除 defaultLayout 以外的布局

> ID：13348222
> 
> 赞同：7
> 
> 时间：2012-11-12T17:14:19.820
> 
> 标签：haskell, yesod

我目前正在玩弄 Yesod 框架，并心想，制作一个有点小的 CMS 将是一个好项目。

目前，我正在努力解决如何实现不同于 defaultLayout 的另一种布局。比如说，对于 CMS 的管理区域，您将拥有一个与 defaultLayout 非常不同的 adminLayout。

有没有办法“复制”默认布局，以及如何？- 或者我应该采取其他方法吗？

此外，我对 Yesod 和 Haskell 都很陌生，但我正在努力解决它:)

编辑：

如您所见，我最终回答了我自己的问题。这就是说，如果有人有更好的方法来解决这个问题，我将非常乐意接受他们的问题。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-12T17:38:19.750

在一位超级好人[1]的帮助下，一个小小的顿悟发生了。对于希望做同样事情的未来谷歌人，我将简要解释一下：

我只是把它放在我需要它的处理程序中，你只需要导入以下内容：

```
import Yesod.Default.Config (appExtra) 
```

然后将 adminLayout 定义为

```
adminLayout :: Widget -> Handler Html
adminLayout widget = do
    master <- getYesod
    mmsg <- getMessage
    pc <- widgetToPageContent $ do
        $(combineStylesheets 'StaticR
            [ css_normalize_css
            , css_bootstrap_css
            ])
        $(combineScripts 'StaticR
            [ js_jquery_js
            , js_bootstrap_min_js
            ])
        $(widgetFile "admin-layout")
    giveUrlRenderer $(hamletFile "templates/admin-layout-wrapper.hamlet") 
```

那么您可以像使用 defaultLayout 一样使用它。希望这会有所帮助，因为我很长一段时间都在盯着自己的错误视而不见-.-' ...

[1] [https://groups.google.com/forum/?fromgroups=#!topic/yesodweb/9KpfYBJBwJE](https://groups.google.com/forum/?fromgroups=#!topic/yesodweb/9KpfYBJBwJE)

# cakephp - CakePHP，根据一天中的时间路由到视图

> ID：13348223
> 
> 赞同：1
> 
> 时间：2012-11-12T17:14:21.487
> 
> 标签：cakephp, date, datetime, time, routing

我正在为一家餐馆开发一个移动网站，并希望根据一天中的时间执行一条路线。

因此，例如，如果它是下午 1 点，默认情况下应用程序会路由到午餐菜单。如果是凌晨 2 点，应用程序会转到深夜菜单。

知道如何在**Cake 2.X 框架**中做到这一点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T17:41:41.900

我会实现一个自定义路由器来处理这个问题，以保持清洁和“蛋糕”。

[http://book.cakephp.org/2.0/en/development/routing.html#custom-route-classes](http://book.cakephp.org/2.0/en/development/routing.html#custom-route-classes)

或者您可以在您的路线配置中添加一些条件。如下所示，但显然我不知道您的确切路线。无论您选择哪种方法，时间逻辑都是相似的。

**应用程序/配置/routes.php**

```
$hour = date('G');

if ($hour >= 13 && $hour < 18) {
    $menu = 'lunch';
} elseif ($hour >= 18 || $hour < 2) {
    $menu = 'dinner';
} elseif ($hour >= 2 && $hour < 6) {
    $menu = 'late';
} else {
    $menu = 'breakfast';
}

Router::connect('/menu', array('controller' => 'menus', 'action' => $menu)); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-13T07:45:28.840

需要考虑的是这个逻辑是否应该在你的路由文件中。对我来说，这个逻辑属于一个模型，即你会有一个`getMenu($hour)`根据时间返回菜单的方法。

# android - SurfaceView 不清除旧照片

> ID：13348224
> 
> 赞同：1
> 
> 时间：2012-11-12T17:14:23.983
> 
> 标签：android, surfaceview

我有这个 SurfaceView，当我拖动一个条时，zoomController 会增加，而当我以另一种方式拖动它时，zoomController 会减少。

效果是放大和缩小照片，我遇到的问题是旧照片会留下来，所以如果我把它变大然后变小，大图像会留在小图像的后面。为什么会这样？

公共 SView（上下文上下文）{ 超级（上下文）；缩放控制器 = 100; x = 100; y = 100；

```
 holder = getHolder();
        holder.setFormat(PixelFormat.TRANSPARENT);
    }
    public void run() 
    {
        while(isItOk)
        {
            if(!holder.getSurface().isValid())
            {
                continue;
            }
            Canvas c = holder.lockCanvas();
            Paint p = new Paint();

            tattoo = this.getResources().getDrawable(R.drawable.sample);
            if(tattoo != null)
            {
                tattoo.setBounds(getWidth() / 2 - zoomController - x, getHeight() / 2 - zoomController - y, getWidth()/ 2 + zoomController - x, getHeight()/ 2 + zoomController - y);
                tattoo.draw(c);
            }
            holder.unlockCanvasAndPost(c);
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T18:28:50.467

就像你说的那样，`SurfaceView`不是清除旧图像。这是故意的。如果要清除它，则需要手动进行。在你（重新）绘制你的图像之前试试这个：

```
Canvas.drawColor(Color.BLACK); 
```

# vb.net - 串行端口的 RS232 通信问题：DataRecieved 事件未触发（VS2008）

> ID：13348225
> 
> 赞同：0
> 
> 时间：2012-11-12T17:14:24.360
> 
> 标签：vb.net, vb6

我正在使用 VS2008 SerialPort V2.0.0.0。绝对没有来回通信。

我知道代码有效，因为相同的应用程序在不同的客户端机器上运行。我知道串行到 USB 电缆的驱动程序可以工作，因为我在 vb6 mscomm 应用程序上设置了它，并且我确实得到了通信。我知道我正在正确设置电缆、零调制解调器和所有东西，因为我在 vb6 应用程序中进行了通信。我认为这是 Windows 7 的问题，所以我在 XP 上安装了我的应用程序，但仍然无法正常工作。

有什么我想念的吗？运行 SerialPort v2.0.0.0 是否需要特定的服务包组件？我应该尝试 VS 2010，它会有所作为吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T06:57:08.730

我不使用 vb.net 但在 c# 中我使用串行端口控件的 datareceived 事件，如下所示：

```
 private void comKAR_DataReceived(object sender, System.IO.Ports.SerialDataReceivedEventArgs e)
    //process incoming RS232 data
    {
        byte[] bytArray;
        int intCount;
        intCount = comKAR.BytesToRead;
        bytArray = new byte[intCount];
        comKAR.Read(bytArray,0,intCount);
        ShowData(bytArray);
        ShowTraffic(bytArray,1);
    } 
```

串行端口控件的属性与放置在表单上时获得的默认属性没有什么不同

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T06:50:39.167

您已将此标记为 vb6，尽管您似乎正在使用 vb.net

如果您使用的是 vb6：mscomm 控件的属性是什么？

确保 RThreshold 和 SThreshold 属性都为 0

# excel - 主表中的 EXCEL 公式

> ID：13348228
> 
> 赞同：1
> 
> 时间：2012-11-12T17:14:40.580
> 
> 标签：excel, excel-formula, vlookup, excel-indirect

我希望能够在“主表”中输入公式。调用该公式时，将在调用该公式的工作表上执行该公式。

例子：

```
Sheet 1 (master sheet)
Col A    Col B
ABC      A1 
DEF      A2xA2
GHI      A3-A1 * .05
JKL      A4+A1

Sheet 2
Col A    Col B     Col C
5        DEF       
10       ABC
15       GHI
20       JKL 
```

所以我想要发生的是我在 Sheet2 上的 Col B 中键入的任何内容，以相对于 Sheet 2 上的相应列执行 Sheet 1（主工作表）上的公式。所以在上面的示例中，Col C 的 Sheet 2 的第 1 行将是 25。我正在尝试`VLOOKUP`和的混合`INDIRECT`。如果它只是 Sheet1 上的单元格引用（例如 ABC），则它可以正常工作。如果我进入任何其他人，它就会爆炸。既然`VLOOKUP`工作正常，有什么东西可以“执行”公式或评估公式吗？或者当不仅仅是一个直接的单元格引用时，如何间接工作。

我对 VBA 解决方案不感兴趣，我想使用直接的 excel 函数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T18:06:17.080

使用 VBA 很容易，因为您可以在调用 Excel 的 Evaluate 函数的模块中创建 UDF，该函数在工作表中不可用：

```
Function Eval(ByVal r As Range)
    Application.Volatile True
    Eval = Evaluate(r.Value)
End Function 
```

然后，如果您将 SUM($A$1:$A$10) 作为单元格 C1 中的文本，例如，要将该文本作为另一个单元格中的公式执行，您只需输入：

```
=Eval(C1) 
```

如果您确实必须避免使用 VBA，则在定义名称时可以使用 Evaluate 功能。因此，对于上面在 C1 中具有 SUM($A$1:$A$10) 的示例，您可以定义一个名为 SumCol 的新名称，该名称引用以下内容：

```
=Evaluate($C$1) 
```

然后您可以将 SumCol 放入一个单元格中：

```
=SumCol 
```

但我想像这样定义一堆名字会变得乏味。

# php - 函数只返回一次，为什么？

> ID：13348229
> 
> 赞同：1
> 
> 时间：2012-11-12T17:14:42.513
> 
> 标签：php, recursion, foreach

在我的编码过程中，我真的陷入了这个问题。我运行了一个`foreach`循环，对于每个项目，我都必须从函数中获取某个值。但我只得到了一个返回。我无法弄清楚发生了什么。我希望你们一定会。下面是我的程序的简短版本。最后给出了数据库结构。

```
<?php

function opendb() {
    mysql_connect("localhost", "root", "root");
    mysql_select_db("something_db");
}

function sql_query($sql) {
    $datas = array();
    if ($res = mysql_query($sql)) {
        $x = 0;

        while ( $data = mysql_fetch_assoc($res) ) {
            $datas[$x] = $data;
            $x += 1;
        }
    }
    return $datas;
}

function get_parent_id($table, $parent, $cid) {

    // cid=>child id
    $sql = "SELECT * FROM $table WHERE id=$cid";
    $datas = sql_query($sql);
    $pid = $datas[0]['parent'];
    $p_id = $datas[0]['id'];
    if ($pid != 0) {
        get_parent_id($table, $parent, $pid);
    } else {

        return $p_id;
    }
}

opendb();

$datas_pkg = sql_query("SELECT * FROM tbl_packages WHERE 1");
foreach ( $datas_pkg as $data_pkg ) {
    echo $data_pkg['destination_id'] . '-->';
    echo $parent_id = get_parent_id('tbl_destinations', 'parent', $data_pkg['destination_id']);
    echo '<br/>';
}
?> 
```

数据库结构..

tbl_destinations

```
+--------+-------------------------+-----------+ 
| id(int)|destination_name(Varchar)|parent(int)| 
+--------+-------------------------+-----------+ 
```

tbl_packages

```
+-------+---------------------+-------------------+
|id(int)|package_name(varchar)|destination_id(int)|
+-------+---------------------+-------------------+ 
```

如果我没有明确我的问题，请告诉我，以便我可以帮助您帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T17:17:15.427

```
 if($pid!=0)
  {
            get_parent_id($table,$parent,$pid);

  } 
```

您调用该函数，但从不使用它的值。

# emacs - 创建缓冲区并立即隐藏它？

> ID：13348230
> 
> 赞同：1
> 
> 时间：2012-11-12T17:14:45.633
> 
> 标签：emacs, elisp

我正在寻找一种创建缓冲区并立即隐藏它的方法。它是技术信息的缓冲区，用户不感兴趣，它用于`shell-command`处理输出。

`kill-buffer`- 不是我需要的，因为我需要那个缓冲区才能生效。

`delete-window`- 也不这样做，因为没有办法确定缓冲区的打开方式（它可能会创建一个新窗口或接管另一个窗口）。

如果我在将缓冲区提供给之前创建缓冲区并没有帮助`shell-command`，无论它之前是否存在，它都会将它带到前面，如果在它执行此操作时只有一个窗口，它将创建一个额外的窗口，但是如果有更多的窗口，那么它基本上会做一些随机的事情。有时它会创建一个新窗口……有时它不会。

编辑：

下面的例子说明了这个问题：

```
(defun haxe-start-waiting-server (&optional compiler host port)
  "Starts Haxe `haxe-compiler' on `haxe-server-host':`haxe-server-port'
with \"--wait\" for the future requests made by autocompletion
or flymake.
This function is bound to \\[haxe-start-waiting-server]"
  (interactive
   (let ((compiler-i
          (read-string "Haxe compiler: "
                       haxe-compiler t haxe-compiler))
         (host-i
          (read-string "Haxe server host: "
                       haxe-server-host t haxe-server-host))
         (port-i
          (read-number "Haxe server port: " haxe-server-port)))
     (list compiler-i host-i port-i)))
  (unless (called-interactively-p 'interactive)
    (unless compiler (setq compiler haxe-compiler))
    (unless host (setq compiler haxe-server-host))
    (unless port (setq compiler haxe-server-port)))
  (save-excursion
    (let ((new-buffer
           (get-buffer-create
            (generate-new-buffer-name
             " *haxe-waiting-server*"))))
      (async-shell-command
       (concat compiler " --wait "
               host ":" (number-to-string port))
       new-buffer)
      (bury-buffer new-buffer)))) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T23:26:54.543

如果您希望一切都在后台发生，您可能需要`save-window-excursion`而不是`save-excursion`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T17:46:41.610

从[Emacs 手册](http://www.gnu.org/software/emacs/manual/html_node/elisp/Buffer-Names.html)：

> 短暂且用户通常不感兴趣的缓冲区的名称以空格开头，因此 list-buffers 和 buffer-menu 命令不会提及它们（但如果这样的缓冲区访问文件，则会提及）。以空格开头的名称最初也会禁用记录撤消信息；请参阅撤消。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T17:50:07.620

为了更好地控制缓冲区行为，您可能希望使用`start-process`而不是`async-shell-command`. 从其文档中：

> 在 Elisp 中，直接调用 `start-process' 通常会为您提供更好的服务，因为它提供了更多控制权并且不强制使用 shell（需要引用参数）。

# objective-c - iOS 动画数组 DESC

> ID：13348232
> 
> 赞同：-1
> 
> 时间：2012-11-12T17:14:49.143
> 
> 标签：objective-c, ios, core-animation

我得到以下代码：

```
test.image = [testArray lastObject];
test.animationImages = testArray;
test.animationDuration = 1;
test.animationRepeatCount = 1;
[test startAnimating]; 
```

我确信有一天我读到可以“倒带”动画，但我再也找不到那个解决方案了 - 有没有比排序（DESC）数组更好的解决方案？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T17:18:07.917

您可以通过访问 reverseObjectEnumerator 的对象来反转动画：

```
testArray = [[testArray reverseObjectEnumerator] allObjects]; 
```

然后，您可以将其传递到动画中：

```
test.image = [testArray lastObject];
test.animationImages = [[testArray reverseObjectEnumerator] allObjects];
test.animationDuration = 1;
test.animationRepeatCount = 1;
[test startAnimating]; 
```

或者您可以查看 UIViewAnimationOptionAutoreverse，但我不确定它是否完全是您正在寻找的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T21:33:51.783

您正在使用`UIImageView`，它具有有限的动画可能性。恢复动画是可能的，但使用基于 CoreAnimation 的动画。您有两种选择，具体取决于您希望对动画进行控制的级别。

*   继续使用`UIImageView`，并按照 max_ 的建议进行操作：修改 images 数组，以便最终播放动画（如果您需要向前然后向后播放，您可以进一步更改数组以获得该效果。每个图像都会有在数组中多次出现以实现此目的）

*   切换到`CALayer`动画。您必须将您的数组转换`UIImages`为数组，并在图层的键路径上`CGImages`创建一个`CABasicAnimation`操作。`content`然后，您将拥有所需的所有控件，包括自动反转动画的选项，因为动画对象实现了`CAMediaTiming`允许此类内容的协议。

# android - Android Canvas：获取画布中画线的 Y 位置

> ID：13348233
> 
> 赞同：1
> 
> 时间：2012-11-12T17:14:49.150
> 
> 标签：android, android-layout, android-canvas

> **可能重复：**
> [二次贝塞尔曲线：计算点](https://stackoverflow.com/questions/5634460/quadratic-bezier-curve-calculate-point)

我在 Canvas 上做一些绘图，我使用 Path.quadTo() 点数很少，并且我的 Paint 具有 CornerPathEffect。那么当 x 可以是任何东西时，我怎样才能得到线的 y 位置呢？CornerPathEffect 背后是否有一些算法可以让我在这里得到精确的计算？

谢谢。

![问题图片](../Images/7a52bbc5e2a34a593eca6949a0af6066.png)

# cordova - 没有使用 Swiftkey 和 Android >4.0 的拼写

> ID：13348240
> 
> 赞同：2
> 
> 时间：2012-11-12T17:15:22.923
> 
> 标签：cordova, jquery-mobile, autocorrect

Android >4.1 设备上的 Jquery Mobile (1.2)、Phonegap (2.2) 和 Swiftkey 似乎存在错误。

正常`<input type="text"/>`且`<textarea>`有效，但即使该属性`autocomplete="on"`存在，Swiftkey 键盘也不提供拼写建议。

有没有人经历过这种情况并知道解决方法？

# php - 将 EXIF 数据转换为应有的样子

> ID：13348241
> 
> 赞同：1
> 
> 时间：2012-11-12T17:15:32.013
> 
> 标签：php, exif

根据 PHP，图像的 EXIF 信息用于`20/10`F 值、`51/10`焦距和`10/150`曝光。这不是这些值的样子！它应该看起来像`F/2`F 值、`5, mm`焦距和`1/150`曝光。这些值只是一些例子！请参阅[此链接](http://www.exiv2.org/sample.html)，了解我真正的意思是它应该是什么样子。请注意，我**不会**使用任何第三方软件！只是纯PHP。

是否可以将这些值（例如）转换为PHP`20/10`中的实际值（例如）？`F/2`如果是，我该如何转换它们？

提前致谢。

**编辑**

以下代码转换`150/10`为 150 秒，即 2 分 30 秒。这是错误的，因为我用 15 秒快门拍摄了照片。我怎样才能让它计算到正确的秒数？

```
list($d1, $d2) = str_split('/', 'P1220379.JPG');

if($d1 > 0 AND $d2 > 0) {
    $e = $d1 / $d2;
} else {
    $e = 'P1220379.JPG';
}

if($e < 1 AND $e > 0) {
    $e = '1/'.round(1 / $e, 0).' sekunder';
} else {
    $e = round($e, 1).' sekunder';
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T17:33:44.380

[此链接](http://www.php.net/manual/en/function.exif-read-data.php)上的“drpain”说

> 请注意，当使用 GD 和大多数图像处理脚本或应用程序调整图像大小时，您将丢失 EXIF 信息。作为一种解决方法，我在重新调整图像大小之前将此信息预订到 MySQL 中。

下面是他的小程序

```
<?php

$camera = cameraUsed("/img/myphoto.jpg");
echo "Camera Used: " . $camera['make'] . " " . $camera['model'] . "<br />";
echo "Exposure Time: " . $camera['exposure'] . "<br />";
echo "Aperture: " . $camera['aperture'] . "<br />";
echo "ISO: " . $camera['iso'] . "<br />";
echo "Date Taken: " . $camera['date'] . "<br />";

?> 
```

*据他说*，确实以正确的格式产生了这些数字

 *将根据数据显示以下内容：

```
Camera Used: SONY DSC-S930
Exposure Time: 1/400
Aperture: f/4.3
ISO: 100
Date Taken: 2010:12:10 18:18:45 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-02-12T17:07:14.290

如果有人需要，这是我在 kotlin 中的解决方案

```
fun convertShutterSpeed(value: String?): String {
    if (value.isNullOrBlank()) {
        return ""
    }
    val split = value.split("/")
    val ed: Float = split[0].toFloat()
    val ed1: Float = split[1].toFloat()

    val fl = ed / ed1

    return if (ed < 0) {
        Math.round(1 / Math.pow(2.toDouble(), fl.toDouble())).toString() + "s"
    } else {
        "1/" + Math.round(Math.pow(2.toDouble(), fl.toDouble()))
    }
} 
```

这里有一些测试

```
@Test
fun convertShutterSpeed() {
    assertEquals("1/8", imageExif.convertShutterSpeed("3/1"))
    assertEquals("1/10", imageExif.convertShutterSpeed("3321928/1000000"))
    assertEquals("1/20", imageExif.convertShutterSpeed("4321928/1000000"))
    assertEquals("1/125", imageExif.convertShutterSpeed("6965784f/1000000"))
    assertEquals("1/250", imageExif.convertShutterSpeed("7965784/1000000"))
    assertEquals("1/320", imageExif.convertShutterSpeed("8321928/1000000"))
    assertEquals("1/400", imageExif.convertShutterSpeed("8643856/1000000"))
    assertEquals("1/640", imageExif.convertShutterSpeed("9321928/1000000"))
    assertEquals("1/800", imageExif.convertShutterSpeed("9643856/1000000"))
    assertEquals("1/1000", imageExif.convertShutterSpeed("9965784/1000000"))
    assertEquals("2s", imageExif.convertShutterSpeed("-1/1"))
    assertEquals("6s", imageExif.convertShutterSpeed("-2584963/1000000"))
} 
```

我得到的值来自佳能图像，但它也适用于其他相机型号。*

# mysql - MYSQL Where 语句第一个数字

> ID：13348242
> 
> 赞同：0
> 
> 时间：2012-11-12T17:15:40.453
> 
> 标签：mysql

谁能帮我在下面的场景中为 MYSQL 构建 where 语句？

我有一个客户表，其中有很多列是帐号。帐号的前三位数字表示分行代码。现在我有一个分支代码为 235 的分支，我想查询该分支中的客户列表。

如何构造 where 语句将读取客户表中每个帐号的前三位数字并将其等同于 235？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T17:19:42.910

你不能只使用通配符来实现吗？

```
 SELECT * FROM tablename where accnumber like '123%' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T17:17:47.737

`SELECT some_field FROM some_table WHERE LEFT(branch_code, 3)=235`

# php - MySQL查询对所有不同的值求和

> ID：13348244
> 
> 赞同：2
> 
> 时间：2012-11-12T17:15:45.667
> 
> 标签：php, mysql, sql

我有一张桌子：

```
uid_from uid_to count
   x1      x2    3 
   x3      x2    5
   x8      x1    99
   x9      x1    1 
```

并想生成一个像这样的求和表：

```
uid_to   sum
  x1     100
  x2      8 
```

我可以在 PHP 中完成，但宁愿直接在 MySQL 查询中完成。我应该注意到该表有 7 亿行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T17:17:26.187

```
select uid_to, sum(count) as sum
from your_table
group by uid_to 
```

# php - php中的array_map与回调OOP

> ID：13348249
> 
> 赞同：1
> 
> 时间：2012-11-12T17:15:53.140
> 
> 标签：php, oop, callback

> **可能重复：**
> [如何使用对象方法作为回调函数](https://stackoverflow.com/questions/3350762/how-to-use-an-object-method-as-a-callback-function)

通常我将 array_map 与程序代码一起使用，但在这种情况下，我在 OOP 中工作，回调应该是“this->id2areas”，但它不起作用。反正有没有把这个回调和 OOP 放在一起？

```
ERROR MESSAGE: array_map() expects parameter 1 to be a valid callback, function 'this->id2area' not found or invalid function name 
```

我的代码 ================================================== ==================================

```
$this->context->assign('user_areas', implode(', ', array_map('id2area',   explode(',', $this->user['areas']))));     
explode(',', $this->user['areas']))));

function id2area($id) {//callback
    if ($id == 0) {
        return 'National';
    }
    $query = "SELECT area FROM area WHERE id = $id";
    return DB::fetch_instance()->slave->fetchColumn($query);
} 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-12T17:18:52.617

在 PHP 中，您可以使用数组将对象和方法调用关联为可调用对象

```
array_map(array($this, 'id2area'), $array); 
```

[http://php.net/manual/en/language.types.callable.php](http://php.net/manual/en/language.types.callable.php)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-12T17:20:49.227

对象的 PHP 回调与全局函数有点不同。

```
//Global function callback
array_map('id2area', $data);

// Object function
array_map(array($object, 'id2area'), $data)
// - or -
array_map(array($this, 'id2area'), $data)

// Static class function
array_map(array('Class_Name', 'id2area'), $data)
// - or -
array_map('Class_Name::id2area', $data) 
```

[http://us1.php.net/manual/en/language.types.callable.php](http://us1.php.net/manual/en/language.types.callable.php)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-12T17:22:02.923

您也可以将其作为匿名函数执行，例如：

```
array_map(
    function($arg) {
        return $this->id2area($arg);
    },
    explode(',', $this->user['areas'])
); 
```

# python - GeoDjango 多边形区域

> ID：13348250
> 
> 赞同：4
> 
> 时间：2012-11-12T17:15:53.897
> 
> 标签：python, django, area, geodjango, units-of-measurement

我已经使用 postgis 实现了 GeoDjango。

这是我的模型：

```
 ...
  geometria = models.PolygonField(srid=4326, null=True)
  ... 
```

当我调用**data.area**时，它返回一个浮点数，但我没有任何关于它的测量单位的线索，这是一个问题，因为我想测试它是否大于以平方米为单位的预设区域。

你能帮助我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T15:14:08.113

如果您正在处理地图上的大面积区域，则应设置

```
geometria = models.PolygonField(srid=4326, null=True, geography=True) 
```

正如 geodjango 的文档中提到的那样[https://docs.djangoproject.com/en/dev/ref/contrib/gis/model-api/#geography](https://docs.djangoproject.com/en/dev/ref/contrib/gis/model-api/#geography)

> 地理类型 在 PostGIS 1.5 中，引入了地理类型——它为用地理坐标（例如，WGS84 经度/纬度）表示的空间特征提供本地支持。[7] 与几何类型使用的平面不同，地理类型使用其数据的球形表示。在地理列上执行的距离和测量操作会自动采用大​​圆弧计算并返回线性单位。换句话说，当在两个地理上调用 ST_Distance 时，将返回一个以米为单位的值（与在 WGS84 中的几何列上调用度数相反）。

如果您没有`geography=True`，我们将事物存储为普通几何图形，我们需要将`square degrees`（您获得的浮点结果）转换为您喜欢的度量单位，因为我们无法根据地理坐标计算面积。我们可以添加一个在投影坐标空间中的辅助方法来进行转换：

```
def get_acres(self): 
    """ 
    Returns the area in acres. 
    """ 
    # Convert our geographic polygons (in WGS84)
    # into a local projection for New York (here EPSG:32118) 
    self.polygon.transform(32118) 
    meters_sq = self.polygon.area.sq_m

    acres = meters_sq * 0.000247105381 # meters^2 to acres

    return acres 
```

我们使用哪种投影取决于数据的范围，以及我们需要结果的准确程度：这里我用纽约部分地区的特定投影进行了说明，但如果您的数据不是特别准确，您可以轻松替换全局投影或仅使用简单的公式。

# razor - 在哪里可以找到 Ext.Net MVC4 Razor 的示例和/或文档？

> ID：13348254
> 
> 赞同：2
> 
> 时间：2012-11-12T17:16:02.010
> 
> 标签：razor, asp.net-mvc-4, ext.net

我找到了[ASP.NET MVC4 Razor的教程和 Ext.Net](http://www.asp.net/mvc/tutorials/mvc-4/getting-started-with-aspnet-mvc4/intro-to-aspnet-mvc-4) [Webforms](http://examples.ext.net/)的示例，并且我一直在尝试从那里自行解决。

但是有什么东西可以向我展示带有 Razor 的 Ext.Net MVC4 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T04:00:34.920

Ext.NET 团队即将发布一个新的 MVC 特定示例资源管理器。应该在一两天内上线，但如果您想运行任何示例，则需要即将发布的 v2.1 版本。

示例将在[http://mvc.ext.net/上提供](http://mvc.ext.net/)

# sql - 如何按日期时间透视表或交叉表？

> ID：13348255
> 
> 赞同：5
> 
> 时间：2012-11-12T17:16:03.403
> 
> 标签：sql, sql-server, datetime, pivot, crosstab

我需要交叉表或数据透视表通过选择日期时间。

**表格文件TA**

```
EmpNo     ChkDate                    ChkIn
00001     2012-10-10 00:00:00.000    2012-10-10 07:22:00.000
00002     2012-10-10 00:00:00.000    2012-10-10 07:30:00.000
00001     2012-10-11 00:00:00.000    2012-10-11 07:13:00.000
00002     2012-10-11 00:00:00.000    2012-10-11 07:34:00.000
00001     2012-10-12 00:00:00.000    2012-10-12 07:54:00.000
00002     2012-10-12 00:00:00.000    2012-10-12 07:18:00.000 
```

我试过以下

```
SELECT tf.EmpNo,tf.ChkDate,tf.ChkIn
FROM (SELECT EmpNo,ChkDate,ChkIn
        ,ROW_NUMBER() OVER(PARTITION BY EmpNo ORDER BY ChkDate) as tfNum
        FROM filesTA) AS tf
    PIVOT(MIN(ChkDate) FOR tfNum IN ('2012-10-10'))
WHERE tf.ChkDate Between '2012-10-10' and '2012-10-12' 
```

但是出现以下错误

```
Incorrect syntax near 'PIVOT'. You may need to set the compatibility
level of the current database to a higher value to enable this feature.
See help for the SET COMPATIBILITY_LEVEL option of ALTER DATABASE. 
```

**期望的输出：**

```
EmpNo     10     11     12
00001     07:22  07:13  07:54
00002     07:30  07:34  07:18 
```

我开始学习枢轴和交叉表。请帮助我让我的查询正常工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-12T19:14:47.340

如果您无法使用该`PIVOT`函数，则可以使用带有`CASE`语句的聚合函数：

```
select empno,
  max(case when datepart(d, chkdate) = 10 
        then convert(char(5), ChkIn, 108) end) [10],
  max(case when datepart(d, chkdate) = 11 
        then convert(char(5), ChkIn, 108) end) [11],
  max(case when datepart(d, chkdate) = 12
        then convert(char(5), ChkIn, 108) end) [12]
from filesTA
where ChkDate Between '2012-10-10' and '2012-10-12'
group by empno 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/c2310/5)

如果您有权访问`PIVOT`，那么您的语法将是：

```
select empno, [10], [11], [12]
from
(
  select empno, datepart(d, chkdate) chkdate, 
    convert(char(5), ChkIn, 108) chkin
  from filesTA
) src
pivot
(
  max(chkin)
  for chkdate in ([10], [11], [12])
) piv 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/c2310/11)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T19:07:38.857

如果您需要在兼容级别低于 90 的数据库上使用 PIVOT，它将无法工作。

阅读此 [ALTER DATABASE 兼容级别](http://msdn.microsoft.com/en-us/library/bb510680.aspx)

修改后的数据库兼容级别后，您的查询将如下所示

```
;WITH cte AS
 (
  SELECT EmpNo, CAST(ChkIn AS time) AS ChkIn, DATEPART(mm, ChkDate) as mm_ChkDate
  FROM filesTA
  WHERE ChkDate Between '2012-10-10' and '2012-10-12'
  )
SELECT EmpNo, [10], [11], [12] FROM cte  
PIVOT(
MIN(ChkIn) FOR cte.mm_ChkDate IN ([10], [11], [12])) x 
```

# programming-languages - a = b 是否有复合赋值运算符 一个（其中 不是可交换的）？

> ID：13348261
> 
> 赞同：5
> 
> 时间：2012-11-12T17:16:41.640
> 
> 标签：programming-languages, compound-assignment, compound-operator

在许多语言中，a = a + b 可以写成 a += b 在数值运算的情况下，a + b 与 b + a 相同，因此单个复合运算符就足够了。

此外， a = a - b 可以写成 a -=b 。

但是，ab 不等于 ba。因此，复合赋值运算符不适用于 a = b - a

那么，是否有用于操作**a = b *op* a**的复合赋值运算符（其中*op*可以是 +、-、*、/、%，并且顺序很重要）？

[*非交换运算*]

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-12T17:22:46.150

不，没有 的简写符号`a = b + a`。如果你需要为字符串做很多事情`a = b + a`，你最好建立一个像这样的列表：

```
lst = []

...

lst.append("a")
lst.append("bb")
lst.append("ccc")
lst.append("dddd")

...

lst.reverse()

return ''.join(lst)   # "ddddcccbba" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-12T17:33:42.770

**不，那里没有。**

* * *

## 简写的由来

~~我怀疑这个速记来自汇编语言，`ADD`指令正是这样做的——接受两个操作数，进行加法并将其存储到第一个操作数。~~

~~我想说人们习惯于这样思考，所以这种模式也出现在 C 语言中作为`a += b`速记。其他语言从 C.~~

~~`a = a + b`我认为拥有或不拥有或没有特别的理由`a = b + a`。我认为编程中更经常需要这两个。原因是历史的。这与我们使用 QWERTY 键盘布局而不是其他键盘布局的原因相同。~~

**更新**：[看到这个](https://stackoverflow.com/a/3654973/325365)，这是一个神话，因为 C 是基于 B 语言而不是来自汇编语言。起源尚不清楚。

## 可能的原因

*   每个运算符[都使语言更加复杂](https://stackoverflow.com/a/3654936/325365)。Python 支持运算符重载，因此要创建一个新的运算符需要做更多的工作。
*   它很少用于与 比较`+=`。
*   人们（被）从汇编语言中更多地用于`+=`某种操作而不是`a = b + a`，因此他们对不存在速记并且没有要求的事实感到满意。
*   可读性问题。
*   缺乏合适的语法。你会如何设计它？

## 可能的解决方案

最好的解决方案是只写`a = b + a`，因为乍一看它是清晰易读的。~~出于同样的原因（可读性）~~（更新：[谁知道？](https://stackoverflow.com/questions/3654830/why-there-are-no-and-operators-in-python/3654973)） Python 不提供`a++`已知的 C 和其他语言。你必须输入`a += 1`. 对于`+=`编程初学者来说，速记的可读性也不是很好，但至少可以以某种方式猜出它是关于什么的。它是传统、懒惰和可读性之间的妥协。

如果没有传统，可读性应该会胜出，至少在 Python 中是这样。因此，一个人应该清楚地多写几个字符，而不是寻找速记。对于`a = b + a`.

## 笔记

如果要连接更多字符串，则应注意`.join()`性能问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T17:26:50.187

我不知道任何语言都内置了这样的快捷方式，但有些语言允许你创建一个。

例如，在 Scala 中，您基本上可以定义自己的运算符。

# ios - 如何将 ALAsset 添加到照片流？

> ID：13348262
> 
> 赞同：1
> 
> 时间：2012-11-12T17:16:43.347
> 
> 标签：ios, icloud, alassetslibrary, alasset

我尝试将 ALAsset 添加到照片流，但看起来这是不可能的。有什么建议么？

我尝试了以下方法：

```
typedef void(^SaveImageCompletion)(NSError* error);

-(void)addAssetURL:(NSURL*)assetURL toPhotoStreamWithCompletionBlock:(SaveImageCompletion)completionBlock
{
    [self enumerateGroupsWithTypes:ALAssetsGroupPhotoStream usingBlock:^(ALAssetsGroup *group, BOOL *stop) {

        if (group) {
            *stop = YES;
            [self assetForURL: assetURL resultBlock:^(ALAsset *asset) {
                if ([group addAsset: asset]) {
                    NSLog(@"Added to photo stream!");
                } else {
                    NSLog(@"ERROR! Adding to photo stream failed!");
                }
                                 completionBlock(nil);

            } failureBlock: completionBlock];
            return;
        }

    } failureBlock: completionBlock];    
} 
```

但是， addAsset: 总是失败。它适用于常规专辑..

提前谢谢了！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-02-01T20:29:19.923

从 iOS 8 开始，Apple 创建了 Photos 框架来做这些事情。

有一个广泛的[照片框架示例项目](https://developer.apple.com/library/ios/samplecode/UsingPhotosFramework/Introduction/Intro.html)。

# python - 映射不同长度的迭代器

> ID：13348263
> 
> 赞同：3
> 
> 时间：2012-11-12T17:16:45.420
> 
> 标签：python, python-2.7, itertools

我正在回答[这个问题](https://stackoverflow.com/a/13341670/862380)并面临以下问题：

```
>>> from operator import add
>>> map(add,[1,2,3],[1,2])

Traceback (most recent call last):
  File "<pyshell#47>", line 1, in <module>
    map(add,[1,2,3],[1,2])
TypeError: unsupported operand type(s) for +: 'int' and 'NoneType' 
```

我想`map`在参数中提供的最小迭代器被消耗后立即停止。

我找到了解决方案：

```
>>> from itertools import imap
>>> list(imap(add,[1,2,3],[1,2]))
[2, 4] 
```

但是，这是为什么呢？他们的行为不应该是一致的吗？

这是我解决问题的最佳方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-12T17:19:30.883

如描述中所述[`itertools.imap`](http://docs.python.org/2/library/itertools.html#itertools.imap)：

> 创建一个迭代器，使用来自每个可迭代对象的参数计算函数。如果 function 设置为 None，则 imap() 将参数作为元组返回。**与 map() 类似，但在最短的可迭代对象用尽时停止，而不是为较短的可迭代对象填充 None。差异的原因是无限迭代器参数通常是 map() 的错误（因为输出已被完全评估），但代表了向 imap() 提供参数的一种常见且有用的方式。**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-12T17:46:41.623

怎么样：`map(sum, zip([1,2,3],[4,5]))`？

# linux - 使用决策逻辑调用 .sql 文件中的外部脚本

> ID：13348269
> 
> 赞同：2
> 
> 时间：2012-11-12T17:16:57.000
> 
> 标签：linux, oracle, plsql, sqlplus, oracle-sqldeveloper

> **可能重复：**
> [SQLplus 解码以执行脚本](https://stackoverflow.com/questions/13345621/sqlplus-decode-to-execute-scripts)

我已经看遍了，似乎找不到我的问题的答案，但我对 oracle 比较陌生，但精通数据库/SQL，所以这可能是我的误解。我正在使用 Oracle .SQL 文件，在 Linux (ubuntu) 中混合使用 PL/SQL 和 SQL*Plus 来填写数据库中的基本表，并且我有许多从一个“主脚本”调用的脚本。

例如，我有一个主脚本，如下所示：

```
@folder1/script1.sql
@folder2/script2.sql 
```

在每个脚本中，我都有 SQL 语句调用我的数据库中的一个包来填充一些字段。我想要做的是提示用户输入以确定环境，然后根据该输入运行某些脚本。我知道如何在我的脚本中获取一个变量，但是当我这样做时，我似乎无法调用外部脚本。

因此，例如，我知道如何使用这样的变量：

```
set define on
def &&env=env1

begin

        if '&&env' = 'env1' then
        .
        . 
        .
        .
        END IF;
END; 
```

这将提示用户输入我想要的变量，但我似乎无法像上面提到的那样在这个块内调用外部脚本。据我所知，这是因为在 Begin/End 块内它正在执行 PL/SQL，而在它之外是 SQL*Plus（我可能是错的，对于 oracle 来说还是比较新的）

在网上搜索，我发现人们建议在脚本中使用 EXECUTE IMMEDIATE 来调用外部脚本，虽然这被认为是不好的做法，但我似乎可以让它工作。我认为这是因为脚本需要在服务器上，因为 PL/SQL 是服务器端（在我的情况下不起作用）。

归根结底，我想要的是起到这种作用的东西，但这样做似乎不起作用。

```
set define on
def &&env=env1

begin

        if '&&env' = 'env1' then
               @folder1\script1.sql
               @folder1\script2.sql
        ELSEIF '&&env' = 'env2'
               @folder2\script1.sql
               @folder2\script2.sql
        END IF;
END; 
```

但是，上面的代码不起作用，尝试调用外部脚本时失败，而且我似乎在网上搜索中找不到任何东西来确定这是否可能。

# mysql - 从 MySQL 复制到 MongoDB 时连接被强制关闭

> ID：13348278
> 
> 赞同：2
> 
> 时间：2012-11-12T17:17:31.187
> 
> 标签：mysql, mongodb

我编写了一个脚本，将我的数据从 MySQL 转换为 MongoDB。在处理一个有 4,000,000 行的表期间，我得到了（几乎完成时）：

```
Traceback (most recent call last):
  File "C:\Python32\lib\site-packages\pymongo\connection.py", line 822, in _send_message
    sock_info.sock.sendall(data)
socket.error: [Errno 10054] An existing connection was forcibly closed by the remote host

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "kolibri_to_mongo.py", line 94, in <module>
    coll.update(..., upsert=True)
  File "C:\Python32\lib\site-packages\pymongo\collection.py", line 411, in update
    _check_keys, self.__uuid_subtype), safe)
  File "C:\Python32\lib\site-packages\pymongo\connection.py", line 837, in _send_message
    raise AutoReconnect(str(e))
pymongo.errors.AutoReconnect: [Errno 10054] An existing connection was forcibly closed by the remote host
Exception mysql.connector.errors.InternalError: InternalError() in <bound method SqlConn.__del__ of SQLConn(?)> ignored 
```

这是 PyMongo 错误还是 SQL 错误？我可以检查 MySQL 或 MongoDB 端的任何限制（大小或超时）吗？还是只是有人杀死了我的查询？

编辑：我注意到现在我无法再连接到 MongoDB 并出现超时错误:( MongoDB 中是否有任何需要更改的限制是否更有可能是另一个 IT/硬件问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T20:43:05.140

这是 MySQL 服务器上的断开连接 - 我想知道您是否遇到查询超时或死锁。

您是否有任何慢查询或长查询，或者您的 MySQL 日志中有任何错误？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T09:35:38.223

然而，这个错误来自 MySQL，至于为什么有点未知。该错误似乎表明远程端，在这种情况下，MongoDB 关闭了连接。

我建议查看 pymongo 日志，看看那里是否有任何进一步的信息。

我还将`tcpdump`在 MySQL 端运行，以查看 MongoDB 服务器是否被拒绝与 RST 的连接尝试，或者 SYN 是否离开 MySQL 服务器并被忽略（对于后者，您应该看到同步间隔相应地基于重传定时器，例如尝试 1@0s、2@+3s、3@+9s、4@+21s）。

在 MongoDB 服务器上，是否`netstat -an | grep LIST`或`sudo lsof -c mongod`显示 MongoDB 仍在侦听端口 27017（假设您没有更改默认值）？

关于 MongoDB 连接错误，典型的情况是`ulimit`设置太低，服务器用完文件描述符。这里有两个很好的链接供您阅读：

*   [生产说明](http://www.mongodb.org/display/DOCS/Production+Notes)
*   [超限](http://docs.mongodb.org/manual/administration/ulimit/)

# c# - 在通用字段上调用通用方法？

> ID：13348281
> 
> 赞同：1
> 
> 时间：2012-11-12T17:17:44.647
> 
> 标签：c#, reflection

我有以下内容，有时我需要`Failures`为`Validations`. 我们假设每个派生自的类型都有`Validation`一个且只有一个派生自上述实现的类型。`Failure<T>``T``Validation`

由于我有越来越多的实现`Validation`，我需要能够实例化派生自的正确类型`Failure<T>,`并`link`在看起来像

```
void recordFailureForValidation(Validation v) {
   Type failureType = dict[v.GetType()];
   Object failure = Activator.CreateInstance(failureType);
       // how do I call failure.link(v) ?
} 
```

在运行时，字典给了我从`Failure<T>`given派生的类型`T`。我能够实例化`Failure<T>`( `Failure1`, `Failure2`, 等...)，但我找不到如何调用我新创建的实例`link`的公共字段（通过使所有对我有意义的使用, ,等... )`reference``Failure``GetMethod``MakeGenericMethod``Invoke`

```
public class MyReferenceClass<T>
  where T : Object, new() {
   public void link(T arg) { ... }
}

public abstract class Failure<T>
   where T : ValidationRule, new() {
...
   public MyReferenceClass<T> reference;
...
}

public class Failure1 : Failure<Validation1> {
}

public class Failure2 : Failure<Validation2> {
}

public abstract class ValidationRule {
   ...
}

public class ValidationRule1 : ValidationRule {
...
}

public class ValidationRule2 : ValidationRule {
...
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T17:34:36.340

让Failures以与和相同的方式实现非通用`IFailure`接口以及通用接口`IEnumerable``IEnumerable<T>`

在其中创建一个抽象工厂方法`ValidationRule`，每个具体的验证都必须实现该方法

```
public ValidationRule1 : ValidationRule
{
    public override IFailure ToFailure()
    {
        return new Failure1(this);
    }

    ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T17:34:50.240

`link`是私有的，因为您没有指定不同的可访问性。做它`public`或`internal`：

```
public class MyReferenceClass<T>
  where T : Object, new() {
   public void link(T arg) { ... }
} 
```

然后你可以`Failure<T>`通过引用属性调用它：

```
public abstract class Failure<T>
   where T : ValidationRule, new()
{
    protected T Validation {get; set;};
    public MyReferenceClass<T> reference;
}

public class Failure1 : Failure<Validation1>
{
    public void Test()
    {
        this.reference.link(Validation);
    }
} 
```

# facebook - 使用 OAuth 附加时强制 Facebook 向我显示登录表单

> ID：13348284
> 
> 赞同：1
> 
> 时间：2012-11-12T17:17:59.873
> 
> 标签：facebook, facebook-graph-api

例如，在 Twitter 中，我可以像这样对他们的 REST API 进行 HTTP 调用：

[https://twitter.com/oauth/authenticate?force_login=true&oauth_token=](https://twitter.com/oauth/authenticate?force_login=true&oauth_token=) .....

这会强制用户登录，即使它已经登录到 Twitter。

Facebook 有一种与他们的 JS SDK 配合使用的类似机制，

[https://developers.facebook.com/docs/howtos/login/client-side-re-auth/](https://developers.facebook.com/docs/howtos/login/client-side-re-auth/)

但在普通 REST API 中没有“&auth_type=reauthenticate”选项的痕迹：

[http://developers.facebook.com/docs/reference/dialogs/oauth/](http://developers.facebook.com/docs/reference/dialogs/oauth/)

有谁知道它是隐藏的还是不存在的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T09:51:29.390

您可以像在 JS 中一样在服务器端身份验证中使用 auth_type=reauthenticate。

```
 $dialog_url = "https://www.facebook.com/dialog/oauth?client_id=" 
   . $app_id . "&redirect_uri=" . urlencode($my_url) . "&state="
   . $_SESSION['state'] . "&scope=user_birthday,read_stream&auth_type=reauthenticate&auth_nonce="
   . $_SESSION['nonce']; 
```

阅读更多 ：

[https://developers.facebook.com/docs/howtos/login/server-side-re-auth/](https://developers.facebook.com/docs/howtos/login/server-side-re-auth/)

它为您提供了关于如何使用它的非常好的文档，以及必要的代码。您还可以检查`$_SESSION['nonce']`发送和接收的返回是否相同。

# ruby-on-rails - 如何向文章控制器添加 blog_id 前缀？

> ID：13348289
> 
> 赞同：0
> 
> 时间：2012-11-12T17:18:15.563
> 
> 标签：ruby-on-rails, shopify

我有一个 Shopify rails 应用程序，在我的文章控制器中，我不确定如何`"prefix_option"`在异常捕获器中添加它所要求的内容。我是一名初学者 Rails 开发人员，所以很可能我遗漏了一些明显的东西。这就是我目前在控制器中的所有内容：

```
class ArticleController < ApplicationController

around_filter :shopify_session

  def show
     @article = ShopifyAPI::Article.find(params[:id])
  end

end 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T18:08:04.457

文章嵌套在博客下，因此您需要指定您正在查看的博客的 ID。

这应该有效：`ShopifyAPI::Article.find(params[:id], :params => {:blog_id => blog_id})`

注意：Shopify API 的 ruby​​ 包装器基于 ActiveResource，所以很多问题可以通过查看 AR 的文档来回答。

find 方法的规格在这里：[http ://api.rubyonrails.org/classes/ActiveResource/Base.html#method-c-find](http://api.rubyonrails.org/classes/ActiveResource/Base.html#method-c-find)

# multithreading - 单处理器系统中的线程

> ID：13348294
> 
> 赞同：0
> 
> 时间：2012-11-12T17:18:36.190
> 
> 标签：multithreading, operating-system

这两个线程在共享内存中同时运行（所有变量在两个线程之间共享）：
**线程 A**

```
for (i=0; i<5; i++) {
  x = x + 1;
} 
```

**线程 B**

```
for (j=0; j<5; j++) {
   x = x + 2;
} 
```

假设一个单处理器系统
a- 给出一个简明的证明为什么当两个线程都完成时 x≤15。
b- 假设我们将线程 B 中的 x = x+2 替换为 x = x-1，那么 X 的值是多少。

我不明白这个问题，我用谷歌搜索它并找到了答案，但我无法得到它我想要一些解释。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-12T17:27:20.240

如果线程工作完美，'x' 可以有的最大值是 15。这完全取决于操作系统的调度程序。

请注意，我假设 x 的初始值为 0！假设线程 A 和线程 B 是序列化的。线程 A 完成后 x 的值为 5。

```
 i | x
-------
 0 | 1
 1 | 2
 2 | 3
 3 | 4
 4 | 5 
```

进入线程 B 的 x 的值为 5，导致 x 的最终值为 15

```
 i | x
-------
 0 | 7
 1 | 9
 2 | 11
 3 | 13
 4 | 15 
```

现在，事情通常不会以这种方式发生，一个线程将读取 x 的初始值并进行加法，然后将修改后的值写回内存。可能会发生以下情况。

```
Thread A reads the value 'x' as 0
Thread B reads the value 'x' as 0
Thread A adds 1 to x making its local copy of x, 1
Thread B adds 2 to x making its local copy of x, 2
Thread A writes its modified value of x as 1
Thread B writes its modified value of x as 2 (overwriting Thread A's modification) 
```

因此，x 不会超过 15，但取决于调度程序，会更少！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-12T17:43:12.300

**a)** 指令`x=x+1`在低级不是单条指令，它由读取 x 的序列组成，然后将 x 加 1，然后更新 x 的内存。因此，可能会发生两个线程读取相同的 x 值。

假设，如果两个线程读取 x 变量的相同值，则更新 x 并写回 x，这导致 x < 15。

**b)** 出于同样的原因，如果您的指令是 ，则 x 的值可能介于 0 到 5 之间`x=x-1`。

* * *

**试试这个你会学到更多！**
用它编译你的c代码`-S option`将为你的程序创建一个编译的汇编代码。然后就可以了`understand x = x + 1 is not a single instruction`。并且在指令完成之前可以在线程之间切换，`x = x + 1` 因此它不是原子的。

# wpf - Caliburn Micro - 使用容器激活项目

> ID：13348307
> 
> 赞同：1
> 
> 时间：2012-11-12T17:19:32.507
> 
> 标签：wpf, mvvm, caliburn.micro

[我在这里](http://caliburnmicro.codeplex.com/wikipage?title=Screens,%20Conductors%20and%20Composition&referringTitle=Documentation)浏览了 Caliburn Micro 文档。同时，我试图提出一些粗略的代码进行实验。我对如何使用容器激活项目以及如何将对象传递给我们正在激活的 ViewModel 感到有些困惑。

让我们考虑一个主/细节场景。主控包含一个列表（比如数据网格），详细信息包含来自主控的特定行以进行更新（比如选项卡控件内的选项卡项）。在文档中（为了便于理解），我相信细节 ViewModel 是使用这样的代码直接实例化的

```
public class ShellViewModel : Conductor<IScreen>.Collection.OneActive {
int count = 1;

public void OpenTab() {
    ActivateItem(new TabViewModel {
        DisplayName = "Tab " + count++
    });
}
} 
```

因此，要将上述基本概念应用到现实世界的应用程序中，我们需要使用容器（例如 MEF）实例化 DetailViewModel（上面的 TabViewModel）。接下来的挑战是要知道特定的 DetailViewModel 是否已经在 TAB 控件中打开。我想到的直接粗略的事情是维护打开的选项卡列表（DetailViewModels）。但随后我们再次在 MasterViewModel 中引用 DetailViewModel 失败了。是否有任何选项可用于解决此问题。

困扰我的第二件事是如何将对象从 MasterViewModel (Selected Detail Item) 传递到 DetailViewModel。如果我们在这里使用 EventAggregator，那么每个打开的 DetailViewModels 都会收到我不确定如何处理的事件。

如果有人能对以上两个问题有所了解，我将不胜感激

**更新：** 大师是这样的指挥

```
public class MainViewModel : Conductor<IScreen>.Collection.OneActive, IShell {
    ....
} 
```

细节是这样定义的

```
public class TabViewModel : Screen {
    ....
} 
```

两者都在同一个窗口中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T11:16:17.750

我不确定到底是什么问题。在你的许多指挥中，你有一个`Items`由 Caliburn.Micro 提供的集合。当您开始显示详细视图时，您可以检查该集合是否存在该详细视图（使用您从主视图中获得的主键）。

如果该项目已经在`Items`集合中，那么只需激活它（使用`ActivateItem`方法）。如果该项目不在集合中，则实例化它（如果您使用 MEF，可能使用工厂），并将其添加到`Items`集合中，然后激活它。

# mysql - 比较和删除特定表中的行

> ID：13348316
> 
> 赞同：2
> 
> 时间：2012-11-12T17:20:07.847
> 
> 标签：mysql, sql, stored-procedures

我正在使用一个数据库表，其中存储了一个 AssociateID 字段和一个 DocumentName 字段。该表用于记录哪些员工缺少哪些文件。

我正在尝试编写一个存储过程，如果无法为同一员工找到“终止声明”的条目，该过程将删除“限制性契约字母”的一行。以下是我目前所拥有的内容：

```
DELETE from tbl_HR_Auditing_Reports
WHERE DocumentName = 'Restrictive Covenant Letters'
AND NOT EXISTS
    (
        SELECT TS.AssociateID
        FROM
            (SELECT AssociateID FROM tbl_HR_Auditing_Reports WHERE DocumentName = 'Termination Statement (*)') TS,
            (SELECT AssociateID FROM tbl_HR_Auditing_Reports WHERE DocumentName = 'Restrictive Covenant Letters') RCL
        WHERE  TS.AssociateID = RCL.AssociateID
    ) 
```

我想我很接近，但 sql 并不是我的强项。如果有人可以提供帮助，我将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T17:25:57.467

根据[MySQL 手册](http://dev.mysql.com/doc/refman/5.0/en/delete.html)：

*目前，您不能在子查询中从表中删除并从同一个表中选择。*

为了解决这个问题，您可以使用临时表，将相关行插入到临时表中，然后在删除语句中引用它。

```
CREATE TEMPORARY TABLE tmp (AssociateID INT);
INSERT INTO tmp (AssociateID)
SELECT  AssociateID
FROM    tbl_HR_Auditing_Reports
WHERE   DocumentName = 'Termination Statement (*)';

DELETE 
FROM    tbl_HR_Auditing_Reports 
WHERE   DocumentName = 'Restrictive Covenant Letters'
AND     NOT EXISTS
        (   SELECT  1
            FROM    tmp
            WHERE   tmp.AssociateID = tbl_HR_Auditing_Reports.AssociateID
        ) 
```

**[SQL Fiddle 示例](http://www.sqlfiddle.com/#!2/dda8e/1)**

# screen - 对于普通 ABAP 屏幕中的 I/O 字段，我可以让它们表现得像 SELECT-OPTIONS 吗？

> ID：13348319
> 
> 赞同：1
> 
> 时间：2012-11-12T17:20:15.813
> 
> 标签：screen, selection, abap

我正在尝试为我的一个常规屏幕内的一个字段提供普通 SELECT-OPTIONS 的功能。

我在 Designer 中检查了该 I/O 字段的所有属性，但我找不到任何东西。

我看到向我提供了一些多项选择功能，但它并不完整，这意味着在提示中我不再能够使用 F4 来直观地选择我的范围。

我正在努力实现的目标是可能的吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-12T17:44:43.913

你可以使用

```
SELECTION-SCREEN BEGIN OF SCREEN 100 AS SUBSCREEN.
SELECT-OPTIONS so_foo FOR baz-baz.
SELECTION-SCREEN END OF SCREEN 100. 
```

然后将生成的屏幕包含在程序的子屏幕区域中。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-13T06:51:22.980

您可以结合使用功能模块`FREE_SELECTIONS_INIT`和`FREE_SELECTIONS_DIALOG`. （您可以通过放在 dynpro 上的按钮触发此功能）。功能模块有点复杂，但都有在线文档。

要扩展您的 dynpro 以模拟报告选择屏幕中的选择选项，您可以显示所选数据第一行的低值和高值。

这是一个让您入门的示例（功能模块的文档`FREE_SELECTIONS_DIALOG`实际上包含一些示例代码）：

```
report  ztest_free_seldiag.

data: lv_selid type RSDYNSEL-SELID.
data: lt_fld type table of RSDSFIELDS.
data: ls_fld type RSDSFIELDS.

ls_fld-tablename = 'T001'.
ls_fld-fieldname = 'BUKRS'.
append ls_fld to lt_fld.

call function 'FREE_SELECTIONS_INIT'
  EXPORTING
    KIND                           = 'F'
  IMPORTING
    SELECTION_ID                   = lv_selid
  TABLES
    FIELDS_TAB                     = lt_fld
 EXCEPTIONS
   FIELDS_INCOMPLETE              = 1
   FIELDS_NO_JOIN                 = 2
   FIELD_NOT_FOUND                = 3
   NO_TABLES                      = 4
   TABLE_NOT_FOUND                = 5
   EXPRESSION_NOT_SUPPORTED       = 6
   INCORRECT_EXPRESSION           = 7
   ILLEGAL_KIND                   = 8
   AREA_NOT_FOUND                 = 9
   INCONSISTENT_AREA              = 10
   KIND_F_NO_FIELDS_LEFT          = 11
   KIND_F_NO_FIELDS               = 12
   TOO_MANY_FIELDS                = 13
   DUP_FIELD                      = 14
   FIELD_NO_TYPE                  = 15
   FIELD_ILL_TYPE                 = 16
   DUP_EVENT_FIELD                = 17
   NODE_NOT_IN_LDB                = 18
   AREA_NO_FIELD                  = 19
   OTHERS                         = 20.
if sy-subrc <> 0.
* Implement suitable error handling here
  exit.
endif.

call function 'FREE_SELECTIONS_DIALOG'
  exporting
    selection_id                  = lv_selid
    TITLE                         = 'Select Company Code'
    AS_WINDOW                     = 'X'
    TREE_VISIBLE                  = ' '
* IMPORTING
*   WHERE_CLAUSES                 =
*   EXPRESSIONS                   =
*   FIELD_RANGES                  =
*   NUMBER_OF_ACTIVE_FIELDS       =
  tables
    fields_tab                    = lt_fld
 EXCEPTIONS
   INTERNAL_ERROR                = 1
   NO_ACTION                     = 2
   SELID_NOT_FOUND               = 3
   ILLEGAL_STATUS                = 4
   OTHERS                        = 5.
if sy-subrc <> 0.
  BREAK-POINT.
  exit.
endif. 
```

# python - 如何格式化使用 logging.captureWarnings 捕获的警告？

> ID：13348324
> 
> 赞同：7
> 
> 时间：2012-11-12T17:20:30.757
> 
> 标签：python, logging, warnings

我使用以下代码来获取要记录的警告：

```
import logging
logging.captureWarnings(True)
formatter = logging.Formatter('%(asctime)s\t%(levelname)s\t%(message)s')
console_handler = logging.StreamHandler()
console_handler.setLevel(logging.DEBUG)
console_handler.setFormatter(formatter) 
```

这行得通，但是，我的日志格式化程序没有应用，并且警告看起来像这样：

```
WARNING:py.warnings:/home/joakim/.virtualenvs/masterload/local/lib/python2.7/site-packages/MySQL_python-1.2.3c1-py2.7-linux-x86_64.egg/MySQLdb/cursors.py:100: Warning: 
InnoDB: ROW_FORMAT=DYNAMIC requires innodb_file_per_table. 
```

而不是预期的格式：

```
2012-11-12 18:19:44,421 INFO    START updating products 
```

如何将我的正常格式应用于捕获的警告消息？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-12T17:57:49.697

[`logging.captureWarnings`](http://docs.python.org/2/library/logging.html#integration-with-the-warnings-module)记录到名为 的记录器`py.warnings`，因此您需要将处理程序添加到该记录器：

```
import logging

logging.captureWarnings(True)
formatter = logging.Formatter('%(asctime)s\t%(levelname)s\t%(message)s')
console_handler = logging.StreamHandler()
console_handler.setLevel(logging.DEBUG)
console_handler.setFormatter(formatter)
py_warnings_logger = logging.getLogger('py.warnings')
py_warnings_logger.addHandler(console_handler) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-12T18:08:04.133

您创建了一个处理程序，但从未将日志记录模块配置为使用它：

```
console_handler = logging.StreamHandler()
console_handler.setLevel(logging.DEBUG)
console_handler.setFormatter(formatter) 
```

您需要将此处理程序添加到记录器；例如根记录器：

```
logging.getLogger().addHandler(console_handler) 
```

或者，您可以仅将处理程序添加到警告记录器；该[`captureWarnings()`文档](http://docs.python.org/2/library/logging.html#logging.captureWarnings)指出它`py.warnings`用于捕获的警告：

```
logging.getLogger('py.warnings').addHandler(console_handler) 
```

除了显式创建处理程序和格式化程序之外，您还可以调用[`basicConfig()`](http://docs.python.org/2/library/logging.html#logging.basicConfig)来配置根记录器：

```
logging.basicConfig(format='%(asctime)s\t%(levelname)s\t%(message)s', level=logging.DEBUG) 
```

上面的基本配置是你设置的处理程序配置的道德等价物。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T17:58:49.033

[文档](http://docs.python.org/2/library/logging.html#integration-with-the-warnings-module)说*如果捕获为真，警告模块发出的警告将被重定向到日志系统*。*具体来说，将使用 warnings.formatwarning() 格式化警告，并将生成的字符串记录到名为 'py.warnings' 的记录器，其严重性为 WARNING。*

因此我会尝试

```
# get the 'py.warnings' logger
log = logging.getLogger('py.warnings')
# assign the handler to it
log.addHandler(console_handler) 
```

# r - 如何将绘图区域的一侧指定为条形图的基础

> ID：13348328
> 
> 赞同：0
> 
> 时间：2012-11-12T17:20:37.670
> 
> 标签：r, graph, data-visualization

在 R 中制作条形图很容易（使用该`barplot()`函数）。默认设置是垂直条从底部开始向上（即，底部位于 side=1）。此外，您可以使用参数制作一个以左侧（side=1）为底的条形图`horiz=T`。我想用*右边*的条形图（side=4）制作一个条形图。

*   **你怎么做到这一点？**
*   **你怎么能把底座放在顶部（边=3）？**

如果可能的话，我希望能够使用基本图形来做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T17:44:33.897

一个快速的选择（可能有点麻烦）是将所有数据乘以 -1，然后条形图将从轴向下或向左移动，而不是向上或向右移动。您可能想要抑制 x 轴并手动输入不带负号的值。

`rect`其他选项是编写您自己的函数，该函数使用或其他命令 从您选择的轴绘制框。

或者使用网格图形并使用旋转的视口（但这需要放弃基本图形）。

**编辑**

实际上，使用基本`barplot`功能的方法不那么笨拙，请参阅此示例（并根据您的情况进行修改）。

```
barplot( 1:5, horiz=TRUE, xlim=c(5,0) ) 
```

您需要`xlim`根据您的数据将参数中的 5 替换为最大值、总和的最大值、之前的 1.04 等。

这仍然会标记左侧的条（如果您给它标签），但是如果您喜欢，您可以抑制该轴并手动将轴放在右侧。

# wpf - WPF 弹出窗口永久显示在 Visual Studio 设计时

> ID：13348330
> 
> 赞同：4
> 
> 时间：2012-11-12T17:20:41.770
> 
> 标签：wpf, visual-studio-2010, popup, design-time, cider

我在 Visual Studio 2010 中遇到了 WPF 设计时的奇怪行为：创建 Popup 类的实例后，我将 Visual Studio 中的代码选项卡切换到不同的文件，Popup 仍然保留在屏幕上！

![在此处输入图像描述](../Images/5836381b9c2f48d20be6c0e9ee2e1633.png)

我有一段代码，可以重现它，但我不确定是否应该将它粘贴在这里（它不是那么短），所以也许我会给出它的链接：[here](http://codeyourself.net/wpf-popup-permanently-displays-in-visual-studio-design-time/)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T18:24:44.247

出于普通人无法理解的未知原因，Microsoft 已决定这是`Popup`WPF 中类的默认行为。您必须自己实现“隐藏”逻辑。我建议处理包含 Popup 的 Window 的`Window.LocationChanged`,`Window.Activated`和`Window.Deactivated`events 并自己关闭它。

编辑：为了澄清自己，您需要处理的 Window 事件是包含 Popup`PlacementTarget`元素的窗口的事件。通常，当您创建一个弹出窗口时，您将其设置为相对于应用程序窗口中包含的某些元素（类似于工具提示的工作方式）。如果这是您的情况，那么我的解决方案是正确的，但我忘了提及有关 PlacementTarget 的这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-10-13T12:49:58.740

在你的代码后面；你可以简单地检查这个布尔值：

```
DesignerProperties.GetIsInDesignMode(this); 
```

“this”表示包含弹出窗口的对象。例如窗口。

如果是真的，你可以说：

```
myPopUp.IsOpen = false; 
```

对于商店应用程序/WinRT：

```
Windows.ApplicationModel.DesignMode.DesignModeEnabled 
```

# selenium - 如何根据文本选择表格中的特定元素

> ID：13348334
> 
> 赞同：0
> 
> 时间：2012-11-12T17:20:45.890
> 
> 标签：selenium, phpunit, selenium-ide

```
<table>
  <tbody>
    <tr>
      <th style="width:200px;">Features</th>
      <th style="width:300px;">Settings for this entry round</th>
      <th style="width:300px;">
    </tr>
    <tr>
      <td style="background-color: rgb(234, 234, 234);"> is_team_round </td>
      <td style="text-align:center;">
      <div>
        <select id="account_3" onchange="changeAccount(3);" style="background-color: rgb(255, 255, 255);">
      <div> </div>
      </div>
      </td>
      <td style="text-align:center;"> Yes </td>
    </tr>
    <tr>
      <td> is_file_uploads </td>
      <td style="text-align:center;">
      <div>
        <select id="account_4" onchange="changeAccount(4);">
      <div> </div>
      </div>
      </td>
      <td style="text-align:center;"> Yes </td>
    </tr>
  </tbody>
</table> 
```

如果文本是is_team_round，如何选择ID帐户3？

我试过`//td[contains(text(), 'is_team_round')]`了，它选择了 is_team_round。

然后我试`//td[contains(text(), 'is_team_round')]//select[@id='account_3']`了，还是不行

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T17:39:10.270

试试 xpath：

```
//tr[./td[contains(text(), 'is_team_round')]]//select 
```

这表示要找到具有带有文本“is_team_round”的单元格（td）的行（tr）。然后在该行内找到选择列表。

注意：您的原始解决方案不起作用，因为它试图在包含文本的单元格内找到一个选择列表。从 HTML 中可以看出，选择列表不在同一个单元格内。因此，需要使用一个共同的祖先（即行）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T17:27:34.237

我会使用 2 个嵌套 jquery 的 .each() 函数来迭代单元格，然后使用 jquery 的 .val() 或 .html() 函数测试值以获取和比较值。检查这些函数的用途和jquery.com 上的语法。希望它有所帮助

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-12T17:29:44.110

```
 $("#table").find("tbody td").eq('is_team_body'); 
```

我试试这样的

# java - 将图标添加到菜单项

> ID：13348349
> 
> 赞同：3
> 
> 时间：2012-11-12T17:21:59.630
> 
> 标签：java, swing, embedded-resource

我想添加`ImageIcon`以`JMenuItem`说明*New*或*save*之类的操作。
为什么以下代码对我不起作用？

```
 JMenu file = new JMenu("File");
   menubar.add(file);
   JMenuItem newgame = new JMenuItem("New");
   file.add(newgame);
   newgame.setIcon(new ImageIcon("/Project1/zkre/new.gif")); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-12T17:54:47.543

从代码的外观来看，您已将其`Image`打包在 jar 文件中，您应该像这样使用[`getResourceAsStream(..)`](http://docs.oracle.com/javase/7/docs/api/java/lang/ClassLoader.html#getResourceAsStream%28java.lang.String%29)或[`getResource(..)`](http://docs.oracle.com/javase/7/docs/api/java/lang/ClassLoader.html#getResource%28java.lang.String%29) 从 jar 中提取它（省略异常处理）：

```
ImageIcon imageIcon=new ImageIcon(ImageIO.read(getClass().getResourceAsStream("/Project1/rawaz/new.gif"))); 
```

**注意**确保您的文件名及其路径的大小写正确（因为 Windows 文件系统不区分大小写，但 jar 中的文件由区分大小写的 JVM 处理）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-12T17:39:57.840

也许确保您获得正确的图像路径：

```
java.net.URL imageURL = this.getClass().getResource("YOUR_IMAGE_PATH");
System.out.println(imageURL); //imageURL is printing correctly in console
ImageIcon image = new ImageIcon(imageURL);
// now add the image to your menubar 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-04-08T18:53:45.360

而不是你写的，这样做并确保你的路径图像。

```
newgame.setIcon(new ImageIcon(getClass().getResource("/Project1/zkre/new.gif"))); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2017-12-13T15:47:38.187

您只需将图像文件移动到主项目文件夹即可。

**例如：**

> \workspace\YOUR_PROJECT_NAME\IMAGES_FILE

# javascript - javascript 正则表达式。替换除单词之外的所有内容

> ID：13348354
> 
> 赞同：-1
> 
> 时间：2012-11-12T17:22:05.403
> 
> 标签：javascript, html, regex

你好我有一个元素类

```
<div class="help_1"></div>
<div class="onemoreclass help_2 twoclass"></div>
<div class="test help_3"></div>
<div class="class1 help_4"></div> 
```

我怎样才能只提取 help_(*) 与 javascript 的匹配项？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T17:26:41.183

此解决方案需要 jQuery 库：

```
var A = [];
$('div').each(function(){
  var B = $(this).attr('class').split(' ');
  for(var i=0;i<B.length;i++){
    var C = B[i];
    if( /^help_/.test(C) ){
      A.push(C);
    }
  }
});

console.log(A); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T17:34:53.733

用于针对属性类的直接 javascript（假设您没有使用 jQuery 并且可以通过 DOM 找到有问题的元素）

```
// Contains array of matches or null if none found
var matches= classAttr.match(/(help_\w)/g); 
```

# javascript - Javascript：使用 new 关键字创建的函数对象内的事件

> ID：13348355
> 
> 赞同：0
> 
> 时间：2012-11-12T17:22:04.717
> 
> 标签：javascript, events, object, com, activexobject

我有一个包含事件的 C# COM DLL（“This.That”），我已经使用 JS 对其进行了测试，它们工作正常。我现在正试图将所有经过测试的代码包装在一个对象中。以下示例工作正常：

```
var oTest = new Test();

function Test()
{
    var oDevice = new ActiveXObject("This.That");

    this.CancelOperation = function()
    {
        try
        {
            oDevice.CancelOperation();
            return "CancelOperation successful.";
        }
        catch (e)
        {
            return e.message;
        }
    };
} 
```

但是一旦我尝试向它添加一个事件，它就不起作用了。看起来它可能是错误的语法。我在网上找不到任何资源来解释这是如何完成的。

```
var oTest = new Test();

function Test()
{
    var oDevice = new ActiveXObject("This.That");

    this.CancelOperation = function()
    {
        try
        {
            oDevice.CancelOperation();
            return "CancelOperation successful.";
        }
        catch (e)
        {
            return e.message;
        }
    };

    oDevice::DeviceStatusUpdate(wasSuccess, message, data) = function()
    {
        document.getElementById("outBox").value += "Success: " + wasSuccess.toString() + "\nMessage: " + message + "\nData:" + data + "\n\n";
    };
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T21:45:05.143

我已经得到了一些工作，但我仍然希望看到其他答案。这会将事件处理程序放在 JS 文件之外并放入文档中，但代码本身仍在 JS 文件中。代码的组织是我最关心的，所以这对我来说是可以接受的。

```
var oTest = new Test();

function Test()
{
    var oDevice = new ActiveXObject("This.That");

    this.CancelOperation = function()
    {
        try
        {
            oDevice.CancelOperation();
            return "CancelOperation successful.";
        }
        catch (e)
        {
            return e.message;
        }
    };

    this.WireEvents = function()
    {
        var script = document.createElement("script");
        script.type = "text/javascript";
        script.text = 'function oTest.oDevice::DeviceStatusUpdate(wasSuccess, message, data) { document.getElementById("outBox").value += "Success: " + wasSuccess.toString() + "\\nMessage: " + message + "\\nData:" + data + "\\n\\n"; }';
        document.body.appendChild(script);
    };
} 
```

# silverlight - Silverlight 使列表框在按钮悬停时可见

> ID：13348361
> 
> 赞同：0
> 
> 时间：2012-11-12T17:22:21.393
> 
> 标签：silverlight, xaml

对于一个简单的问题，我找不到（肯定）简单的解决方案：如果有以下 XAML 代码：

```
<StackPanel>
    <Button Content="Item">
        <i:Interaction.Triggers>
            <i:EventTrigger EventName="MouseEnter"></i:EventTrigger>
            <i:EventTrigger EventName="MouseLeave"></i:EventTrigger>
        </i:Interaction.Triggers>
    </Button>
    <ListBox Visibility="Collapsed"></ListBox>
</StackPanel> 
```

我希望列表框在 MouseEnter 显示并在 MouseLeave 隐藏。它可能只是一个单线，但我找不到它。任何帮助都深表感谢。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T17:08:57.547

我相信这会做你所追求的：

```
<StackPanel xmlns:local="clr-namespace:SilverlightApplication;assembly=SilverlightApplication">
    <StackPanel.Resources>
        <local:BoolToUIElementVisibilityConverter x:Name="BoolToUIElementVisibilityConv"/>
    </StackPanel.Resources>

    <Button Content="Item" x:Name="YourButton">
    </Button>
    <ListBox Visibility="{Binding Path=IsMouseOver, ElementName=YourButton, Converter={StaticResource BoolToUIElementVisibilityConv}}">
        <ListBoxItem>a</ListBoxItem>
        <ListBoxItem>b</ListBoxItem>
        <ListBoxItem>c</ListBoxItem>
    </ListBox>
</StackPanel> 
```

上课：

```
using System.Windows.Data;
using System;
using System.Globalization;
using System.Windows;

namespace SilverlightApplication
{
public class BoolToUIElementVisibilityConverter : IValueConverter
    {

    public object Convert(object value, Type targetType, object parameter, CultureInfo culture)
        {
        if ((bool)value == true)
            return Visibility.Visible;
        else
            return "Collapsed";
        }

    public object ConvertBack(object value, Type targetType, object parameter, CultureInfo culture)
        {
        throw new NotImplementedException();
        }
    }
} 
```

# css - select2 css 加载时间过长

> ID：13348362
> 
> 赞同：2
> 
> 时间：2012-11-12T17:22:28.140
> 
> 标签：css, ruby-on-rails, search, jquery-select2

我在我的网络应用程序搜索页面上为多个选择字段使用了不错的[Select2 。](http://ivaynberg.github.com/select2/)可以按公司/行业/学校搜索人员。因为每个都有数百个可搜索的值，所以加载正确的 select2 css 需要时间（大约 1 秒）。在漂亮的 select2 字段显示之前，可以看到旧的丑陋选择字段闪烁。附件是两个显示转换的屏幕截图。

这是我的视图代码：

```
 <%= form_tag('', :method => :get) do %>
          <div class="row-fluid">  
            <div class="span4">
              <label>What industries have they worked in?</label>
                <%= select_tag "industry_ids", options_for_select((@visible_industries), params[:industry_ids]), { :placeholder => "Type to search...", :multiple => true, :id => "e3", :onchange => 'this.form.submit();' } %>
                <%= hidden_field_tag :&, params[:industry_ids] %>
            </div>
            <div class="span4">
              <label>What companies have they worked at?</label>
                <%= select_tag "company_ids", options_for_select((@visible_companies), params[:company_ids]), { :placeholder => "Type to search...", :multiple => true, :onchange => 'this.form.submit();' } %>
                  <%= hidden_field_tag :&, params[:company_ids] %>           
            </div>
            <div class="span4">
              <label>Where did they go to school?</label>
              <%= select_tag "school_ids", options_for_select((@visible_schools), params[:school_ids]), { :placeholder => "Type to search...", :multiple => true, :onchange => 'this.form.submit();' } %>
                <%= hidden_field_tag :&, params[:school_ids] %>
            </div>
            <div class="row-fluid">
          <% end %>
        </div>
      </div> 
```

和控制器代码：

```
 def people
    @current_user = current_user

    @visible_positions = Position.where{ is_visible.eq('true') }
    @visible_educations = Education.where{ is_visible.eq('true') }

    @visible_companies = @visible_positions.order("LOWER(company)").all.map { |p| [ p.company, p.company ] }.uniq
    @visible_industries = @visible_positions.order("LOWER(industry)").all.map { |p| [ p.industry, p.industry ] }.uniq
    @visible_schools = @visible_educations.order("LOWER(school)").all.map { |e| [ e.school, e.school ] }.uniq

    @c = @visible_positions.where{company.in(my{params[:company_ids]})}.map(&:user_id)
    @i = @visible_positions.where{industry.in(my{params[:industry_ids]})}.map(&:user_id)
    @s = @visible_educations.where{school.in(my{params[:school_ids]})}.map(&:user_id)

    unless @c.empty? && @i.empty? && @s.empty?
      @users = User.find([@c,@i,@s].reject(&:empty?).reduce(:&))
    end

  end 
```

最后，我的资产目录中有这个javascript（除了select2 css）：

```
$(document).ready(function(){

  $('select').select2({
    minimumInputLength: 1
  });
}); 
```

我能做些什么来防止这种闪烁的发生？谢谢你。

![在此处输入图像描述](../Images/406a416b5e96cdc01334c5661066562e.png) ![在此处输入图像描述](../Images/d99649efee4bccae99db6f4347c56753.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-13T17:35:06.623

*我将发表我的评论作为答案，因为它解决了您的问题。*

我的建议是隐藏选择，直到页面完全加载（并应用 select2）。

在样式表中，添加一条`input {display:none;}`规则来隐藏它们（尽管`visibility:hidden`可能更好）。然后用 jQuery 覆盖该规则`$('input').css("display","inline");`。

# c# - 应用程序目录中所有用户的可写.config文件？

> ID：13348367
> 
> 赞同：2
> 
> 时间：2012-11-12T17:22:53.310
> 
> 标签：c#, .net, app-config, configuration-files

我需要有一个通用的应用程序设置文件，并且我需要它可以在运行时由应用程序编辑。

我不想通过将“用户”放在设置范围中来使用内置设置操作，因为它保存在用户本地目录中。

另一方面，我无法将 .config 与“应用程序”一起使用，因为我无法从应用程序内保存到此文件中。

有人可能会说“创建自己的保存设置 XML 文件很容易”。是的，可能是这样，但我想知道使用 MS 内置类的通用可写配置文件的解决方案是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T17:32:42.340

为了让所有用户都可以更新任何格式的数据，那么所有用户都需要能够保存到任何包含该数据的容器中。

这适用于任何格式，从文本文件到 RDBMS。

您管理的文件（例如`.config`（XML）文件）的问题是双重的：

1.  并发。
2.  访问控制。

和关联的`ConfigurationManager`类将写入`.exe.config`具有配置元素和属性的适用声明的文件，但基础文件必须是可写的。您需要：

1.  在安装程序中设置 ACL，以便所有（适用的）用户都具有写入权限。这意味着他们也可以在应用程序之外编写，这是不可避免的，因为无法根据应用程序设置访问控制。

2.  安装在外面`Program Files`。UAC 将写入虚拟化`Program Files`（因此假设所有用户都可以在任何地方写入的应用程序不会中断），但这也意味着它不能用于共享的可修改数据。

并发是另一个问题。什么是两个用户一起修改共享数据？除非您在更改时实施某些锁定和重新加载，否则一个用户将覆盖其他更改。

*考虑改为使用多用户数据库来存储数据*。它们是为这种事情设计的，配置文件*不是*.

* * *

***更新***（基于评论）：

让（非管理员）用户`.exe.config`在 Program Files 中更新 a 仍然会命中 UAC 虚拟化（即，任何写入都将定向到每个用户的位置，并且对其他人不可见）。

更容易使用该[`ConfigurationManager.OpenExeConfiguration(string)`](http://msdn.microsoft.com/en-gb/library/ms224437.aspx)方法从具有适当 ACL的`.config`某个共享位置（例如在`C:\ProgramData`^(1中）加载 a。)返回的对象具有从for和自定义部分`Configuration`隐式加载的所有功能，以及对和的访问权限。`.exe.config``<appSettings>`[`Save`](http://msdn.microsoft.com/en-gb/library/system.configuration.configuration.save.aspx)[`SaveAs`](http://msdn.microsoft.com/en-gb/library/system.configuration.configuration.saveas.aspx)

* * *

¹当然使用正确的方法来获取实际的本地路径，而不是硬编码。

# javascript - 使用 JavaScript 在 Mac 触摸板上禁用双指缩放

> ID：13348370
> 
> 赞同：2
> 
> 时间：2012-11-12T17:23:12.200
> 
> 标签：javascript, zooming, gestures

无论如何禁用桌面上mac的触摸板上可用的捏缩放？

我尝试添加：

```
<meta content='True' name='HandheldFriendly' />
<meta content='width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=0;' name='viewport' /> 
```

但这什么也没做。谢谢！

# html - html5 css3 从文本创建音频声音

> ID：13348379
> 
> 赞同：0
> 
> 时间：2012-11-12T17:23:45.690
> 
> 标签：html, css

是否可以从文本中创建可听见的声音？

这样即使对拼写一无所知，也可以播放页面？

这样我们就可以使用如下标签：

```
<read gender="woman">Read Me in the voice of a robotic woman</read> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T17:31:10.177

如果您只需要一些音频文件，您可以使用语音文本程序创建它（注意版权），然后在客户端播放它..

但是如果您需要包含解决方案，并创建大量音频语音文件，您需要购买这样的东西

[http://www.wizzardsoftware.com/att_server_overview.php](http://www.wizzardsoftware.com/att_server_overview.php)

它只在您的服务器端创建声音文件，然后您需要在客户端播放它

# javascript - 剃刀页面中的 Javascript 语法错误

> ID：13348380
> 
> 赞同：3
> 
> 时间：2012-11-12T17:23:47.020
> 
> 标签：javascript, serialization, razor, asp.net-mvc-4

我在[此链接](https://stackoverflow.com/questions/1503156/accessing-asp-net-mvc-model-data-from-with-javascript)中找到了将一些数据从我的模型传输到 javascript 对象的解决方案。问题是我在 Visual Studio 中有一个错误，表明分号无效，但是当我尝试运行我的应用程序时，它运行良好。

这是显示错误的屏幕截图：

![在此处输入图像描述](../Images/c3167d6f8a5e4d7ce62b27644bba9ad8.png)

但是如果我删除分号，我现在有这个错误：

![在此处输入图像描述](../Images/d8b95ac576ed874353c8a3045791ba70.png)

无论如何，javascript 语句应该始终在行尾有一个分号。

如果当我运行我的应用程序时，一切正常，这个错误意味着什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T17:29:25.617

您可以尝试将其封闭在一个块中：

```
var serializedData = @{ 
    Html.Raw(NewtonSoft.Json.JsonConvert.SerializeObject(Model));
}; 
```

**编辑：**此答案仅适用于 VS 2010。V​​S 2012 中的升级也打破了此解决方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-12T17:31:00.500

我刚从 Razor/MVC4 开始，但你可以这样吗？

```
@{
    var serializedData = Html.Raw(Newtonsoft.Json.JsonConvert.SerializeObject(Model));
}
<script>
    ...
    var serializedData = @serializedData; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-06-02T14:58:10.060

将您的剃须刀代码用引号括起来，如下所示：

```
var myVar = '@serializedData'; 
```

作为 JavaScript 鸭子类型，您在大多数用例中应该没问题。

# sql - SQL 选择最大值（计数（A 列，B 列））

> ID：13348381
> 
> 赞同：1
> 
> 时间：2012-11-12T17:23:53.027
> 
> 标签：sql, oracle

我一直在努力解决这个问题。我想我很接近了。（甲骨文，SQL）

我有一张如下所示的表格。

```
Company    Code
Apple      A
Google     A
Microsoft  B
Apple      C
Google     B
Microsoft  B
Apple      C
Google     C
Microsoft  B 
```

每个公司都可以解析为多个代码。我想要做的是创建一个 SQL 语句，为每个公司提供最常出现的代码的公司。所以在我的例子中我会得到

```
Apple      C
Google     <nothing since there's no clear max>
Microsoft  B 
```

到目前为止，我整理的内容如下。此查询将代码出现最多的公司返回给我，但是如果我在公司的两个代码之间有联系，我会同时返回。对于我的示例中的 Google，我会得到 (Google, A), (Google, B), (Google, C)。我什么都不想要。

我相信我可以再次加入整个事情，并加入一些额外的 where 子句来过滤掉重复的公司，但是我想知道是否有更好的方法来做到这一点。让我丧命的是聚合函数以及 group by，因为有时我会收到 Oracle 单组组错误。任何建议表示赞赏。

```
SELECT m1, c.company sp1, b.code ul1 FROM
  (SELECT MAX(c1) m1, company FROM
    (SELECT COUNT(company||code) c1, company, code FROM table GROUP BY company, code ) a
  GROUP BY company) c
left OUTER JOIN
  (SELECT COUNT(company||code) c1, company, code FROM table GROUP BY company, code ) b
ON c.company=b.company and
m1=b.c1; 
```

米

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T18:03:25.567

你可以这样做：

```
select company, case when c > 1 then null else code1 end code1
  from (select company, code1, recs, count(*) over (partition by company, recs ) c, 
           row_number() over (partition by company order by recs desc) rn
  from (select company, code1, count(*) recs
          from table
         group by company, code1))
 where rn = 1
 order by 1 
```

打破这个：

```
select company, code1, count(*) recs
 from table
 group by company, code1 
```

这让我们每家公司都有他们的代码数量：

```
COMPANY   C       RECS
--------- - ----------
Google    A          1
Google    B          1
Microsoft B          3
Apple     A          1
Apple     C          2
Google    C          1 
```

从这个我们想要最受欢迎的。我们通过分析来做到这一点：

```
select company, code1, recs,
       row_number() over (partition by company order by recs desc) rn
  from (select company, code1, count(*) recs
          from t1
         group by company, code1) 
```

给予：

```
COMPANY   C       RECS         RN
--------- - ---------- ----------
Apple     C          2          1 <- we want all rn= "1" rows
Apple     A          1          2
Google    A          1          1<- we want all rn= "1" rows
Google    B          1          2
Google    C          1          3
Microsoft B          3          1<- we want all rn= "1" rows 
```

但是现在如果有重复（如谷歌所拥有的）..我们计算（*）具有 RN = 1 的行。

```
select company, code1, recs,
       row_number() over (partition by company order by recs desc) rn,
       count(*) over (partition by company, recs ) c
  from (select company, code1, count(*) recs
          from t1
         group by company, code1) 
```

给予

```
COMPANY   C       RECS         RN          C
--------- - ---------- ---------- ----------
Apple     C          2          1          1
Apple     A          1          2          1
Google    A          1          1          3
Google    B          1          2          3
Google    C          1          3          3
Microsoft B          3          1          1 
```

所以我们需要说 RN=1 和 c = 1 （即只有一行有那个数量的记录。所以我们最终得到：

```
select company, case when c > 1 then null else Code1 end Code1
  from (select company, code1, recs, count(*) over (partition by company, recs ) c, 
           row_number() over (partition by company order by recs desc) rn
  from (select company, code1, count(*) recs
          from t1
         group by company, code1))
 where rn = 1 
```

即 rn = 1 并且 c > 1 检查在顶部的情况下（因为我们不想过滤掉行，只需将它们标记为模棱两可。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T18:12:40.940

尝试

```
with
tcount as
(
select t.company, t.code, count(*) c
from table1 t 
group by t.company, t.code) 

select distinct tt.company,
decode(count(tt.company) over(partition by tt.company),
1,
tt.code,
null)
from tcount tt
where tt.c =
(select max(c) from tcount tti where tt.company = tti.company) 
```

[这](http://www.sqlfiddle.com/#!4/95203/1)是一个小提琴

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-06T01:42:44.933

```
SELECT company,CASE WHEN count_ > 1 THEN NULL ELSE code END
(
SELECT company,MAX(code) code,count(1) count_
(SELECT company,code,rank() OVER(PARTITION BY company ORDER BY count_ DESC) rn FROM
(
select
       company,code,count(1) count_
from   table
group by
       company,code
) 
)
where rn = 1
GROUP BY 
   company
) 
```

# c# - HtmlEditorExtender 控件中的自定义按钮？

> ID：13348382
> 
> 赞同：1
> 
> 时间：2012-11-12T17:23:54.913
> 
> 标签：c#, asp.net, ajaxcontroltoolkit, html-editor, htmleditorextender

我急需帮助。

我需要将自定义按钮添加到 HtmlEditorExtender 控件，但我缺乏实际执行此操作的诀窍。

我已经在整个论坛中进行了搜索，但没有任何相关信息或任何信息。

如果有人这么好心帮忙，我需要一个例子来帮助我解决这个问题。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-09T20:39:29.980

一种可能性是使用 javascript 将其添加到包含按钮的 DIV 中。我使用[jQuery](https://jquery.com/)来做。

如果您在 Firefox 中检查 DIV，您会注意到它有一个名为“ajax__html_editor_extender_buttoncontainer”的类。了解此类允许您选择容器并向其添加您自己的自定义按钮。

为此，请在您的 HtmlEditorExtender*下方的 HTML 中添加以下 jQuery 脚本：*

```
<script language="javascript" type="text/javascript">
    // retrieve button container div using its class
    $btnContainer = $(".ajax__html_editor_extender_buttoncontainer");

    if ($btnContainer.length == 1) {
        // append your custom button to the collection of elements within the button container div
        $btnContainer.append("<input id=\"HtmlEditorExtender_YourButtonName\" class=\"ajax__html_editor_extender_YourButtonName\" type=\"button\" name=\"YourButtonName\" title=\"YourButtonName\" style=\"width: 101px; height: 21px;\" unselectable=\"on\"></input>");
    }
</script> 
```

要为按钮设置样式，请为其创建图像并将以下内容添加到样式表中：

```
 /* custom button */
.ajax__html_editor_extender_YourButtonName {
    background: url('/images/YourButtonName_off.png') no-repeat scroll;
    cursor: pointer;
    display: block;
    float: right; /* default is left */
    border: medium none;
}

.ajax__html_editor_extender_YourButtonName:hover {
    background: url('/images/YourButtonName_on.png') no-repeat scroll;
} 
```

按钮的外观当然取决于您，但结果可能如下所示：

[![带有自定义按钮的 HtmlEditorExtender](../Images/1e16d6c1fc5f6d1c32246fe9a340f9c2.png)](https://i.stack.imgur.com/pYBUh.png)

最后，要添加功能，请向具有您指定的类的元素添加单击事件。您可以在外部 .js 文件中执行此操作。

如果要访问文本框的 html，则在该单击中，您将要检索具有属性 contenteditable='true' 的两个 div 中的第一个的 html。这是 HtmlEditorExtender 的设计视图。

将以下内容添加到您的 .js 文件中：

```
// click event for the custom button
$("body").on("click", ".ajax__html_editor_extender_YourButtonName", function (e) {
    var $editorDiv = $("div[contenteditable='true']").first();
    alert($editorDiv.html());
}) 
```

可能有一种更有效的方法来获取设计视图，但它会起作用。

# jquery - jQuery点击页面加载链接

> ID：13348384
> 
> 赞同：0
> 
> 时间：2012-11-12T17:24:04.010
> 
> 标签：jquery, click, onload

我找到了这段代码，它几乎就是我要找的，除了我需要在页面加载时已经选择了第一个链接。

```
function CngClass(obj) {
 if (Lst) Lst.className=' ';
obj.className='selected';
Lst=obj;
}

<style type="text/css"> 
<!-- .selected { font: bold 18px Arial, Helvetica, sans-serif; color:#FF0000; } --> 
</style>  
<ul>  
<li>
<a id="homelink" onclick="CngClass(this);" href="#">Test 1
</a>
</li>  
<li>
<a onclick="CngClass(this);" href="#">Test 2
</a>
</li>  
<li>
<a onclick="CngClass(this);" href="#">Test 3
</a>
</li>  
</ul> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T17:38:08.510

**HTML**

```
<script type="text/javascript" src="http://code.jquery.com/jquery.min.js"></script>
<style type="text/css"> 
    .selected { font: bold 18px Arial, Helvetica, sans-serif; color:#FF0000; }
</style>  
<ul>  
<li>
    <a id="homelink" href="#">Test 1</a>
</li>  
<li>
    <a href="#">Test 2</a>
</li>  
<li>
    <a href="#">Test 3</a>
</li>  
​ 
```

**Javascript**

```
$(function(){
    $("#homelink").addClass("selected"); //adds selected class in the first link
    $("ul a").click(function(e){
        e.preventDefault();
        $("ul a").removeClass("selected");
        $(this).addClass("selected"); 
    });
});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T17:27:12.923

修改代码：[jsfiddle](http://jsfiddle.net/xe4zS/)

1.  将 Selected 类添加到 html 中的第一个“a”。

2.  将 jQuery 单击事件与每个锚点绑定，并从旧的选择类中删除并添加到新的。

    *   测试 1

    *   测试 2

    *   测试 3

    ```
    $("ul a").click(function(){
            $("ul a.selected").removeClass("selected");
            $(this).addClass("selected"); 
            return false;
    }); 
    ```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T17:36:54.000

只需使用它（从`a`标签中删除内联 onclick 事件）

**HTML**

```
<ul>  
<li>
    <a id="homelink" href="#">Test 1</a>
</li>  
<li>
    <a href="#">Test 2</a>
</li>  
<li>
    <a href="#">Test 3</a>
</li> 
```

**​JS** （把它`head`放在用标签包裹的`script`标签之间）

```
$(function(){
    $("ul a:first").addClass("selected"); //adds selected class in the first link
    $("ul a").click(function(e){
        e.preventDefault();
        $("ul a").removeClass("selected");
        $(this).addClass("selected"); 
    });
});​ 
```

[**演示**](http://jsfiddle.net/heera/LApyp/)。

# c# - 使用 C# windows 窗体浏览 sftp 连接上的目录

> ID：13348385
> 
> 赞同：1
> 
> 时间：2012-11-12T17:24:06.647
> 
> 标签：c#, winforms, sftp

我正在创建一个应用程序，以允许用户以类似于 winscp、filezilla 等的方式将文件上传到我们的 sftp 服务器，但该应用程序的目的是为了安全目的过滤每个用户要查看的文件夹。有没有办法像使用 FolderBrowserDialog 浏览我们自己的本地机器一样浏览 sftp 的目录？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T17:45:55.790

通常，您可以在 Explorer 中实现命名空间扩展（在 .NET 中编写命名空间扩展是一个坏主意，请[参阅此处阅读警告](http://msdn.microsoft.com/en-us/magazine/cc188741.aspx)），它将显示连接的 SFTP 服务器的目录内容。然后，您将能够使用普通的 shell 浏览器对话框（文件打开、目录浏览）。

但是从头开始实现自己的对话框似乎也是一个更好的主意，因为它以更低的成本为您提供了更大的灵活性（命名空间扩展编写很棘手，尤其是在 C++ 中）。

# android - 使用 canvas.scale 函数放大画布？

> ID：13348386
> 
> 赞同：11
> 
> 时间：2012-11-12T17:24:07.643
> 
> 标签：android, zooming, scale, android-canvas

我已经实现了一个`onDraw`绘制一组矩形的长方法。矩形太小了，我希望它们看起来更大。但不幸的是，我无法更改矩形坐标，因为它们存储在数据库中。那么有什么方法可以放大画布`canvas.scale()`吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-11-13T18:20:08.280

我将通过说您需要在 0,0 处绘制所有内容然后对其进行缩放，最后将其转换为正常运行来作为这个答案的开头。

只需在 onDraw 方法中执行以下操作：

```
canvas.save();
    canvas.translate(xValue, yValue);
    canvas.scale(xScale, yScale)
    /* draw whatever you want scaled at 0,0*/
canvas.restore(); 
```

xScale 在 X 方向收缩或拉伸，yScale 在 Y 方向收缩或拉伸。

1.0 是这些的默认值，因此 2.0 会将其拉伸两倍，而 0.5 会将其缩小一半。

例子：

```
canvas.save();
    canvas.translate(50, 50);
    canvas.scale(0.5f, 0.5f);
    canvas.drawRect(0.0, 0.0, 5.0, 5.0, paint);
canvas.restore(); 
```

这将绘制一个长度为 5.0，宽度为 5.0 的矩形，将其缩小到长度和宽度的 2.5，然后将其移动到 (50, 50)。

结果将是一个绘制的矩形，就好像你这样做了：

```
canvas.drawRect(50.0, 50.0, 52.5, 52.5, paint); 
```

我希望这有帮助！

# database - 如果我找不到表的候选键（规范化）怎么办？

> ID：13348388
> 
> 赞同：1
> 
> 时间：2012-11-12T17:24:15.567
> 
> 标签：database, database-normalization, surrogate-key, candidate-key

我试图了解规范化的确切工作原理并将其应用于我拥有的某些特定项目中。我在几个视频中看到第一步是定义一个候选键。

我想问，如果我拥有的所有字段（或这些字段的组合）都不是唯一的，会发生什么？例如，我有一个名为 Receiver 的字段。但我知道它是重复的。我想将它与名为 Time_Of_Week 的字段结合起来，但该字段也每周重复一次。最后我想将它与字段 Week_Number 结合起来，但这个字段也每年重复一次。

是定义自动增量主键的唯一解决方案吗？

谢谢 d.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T17:32:25.897

如果表没有列或唯一的逻辑列组，则没有自然键。在这种情况下，您应该创建一个代理键，使用一个可能是简单的自动增量的新列。

# jquery - 无法在移动设备中使用 jquery-mobile 获取屏幕

> ID：13348391
> 
> 赞同：0
> 
> 时间：2012-11-12T17:24:24.820
> 
> 标签：jquery, html, jquery-mobile

我已经使用 html5 和 jQuery，jQuery-mobile 实现了登录屏幕。

应用程序.html

```
 <!DOCTYPE html>
 <html>
 <head>
 <meta charset="ISO-8859-1">
 <meta name="viewport" content="width=device-width, initial-scale=1">
 <title>Application</title> 
<link rel="stylesheet" type="text/css" href="css/jquery.mobile-1.1.1.css" />
<!-- <link rel="stylesheet" type="text/css" href="css/jquery.mobile.structure-1.1.1.css" />
<link rel="stylesheet" type="text/css" href="css/jquery.mobile.theme-1.1.1.css" /> -->
<link rel="stylesheet" type="text/css" href="css/login.css" />  

<script type="text/javascript" src='js/jquery-1.8.2.js'></script>        
<script type="text/javascript" src="js/jquery.mobile-1.1.1.js"></script>
<script type="text/javascript" src="js/login.js"></script>
</head>
<body>  
<div data-role="page" id="pagecontent" class="type-interior">       
</div>  
</body>
</html> 
```

登录.js

```
 var _header = "<div data-role='header' data-theme='b' ><h1 id='pheader'>Mobile Sign On </h1> <a data-role='button' id='logoutbtn' data-theme='b' class='hide'>Logout</a></div>";
  var _content ="<div data-role='content'>" +
          "<div align='center' id='logindiv'>"+
          "<div data-role='fieldcontain'><label for='userid' id='luserid'>User Name *:</label>"+
          "<input type='text' name='userid' id='userid' value='' class='logon required' placeholder='Username' /></div>"+
          "<div data-role='fieldcontain'><label for='password' id='lpassword'>Password *:</label><input type='password' name='password' id='password' class='logon required' value='' placeholder='Password' /></div>"+
          "<div data-role='fieldcontain'><fieldset class='ui-grid-a'><a data-role='button' id='loginbtn' data-theme='b'>Login</a></fieldset></div></div></div>"; 
```

将标题和内容附加到页面。

```
 $(document).ready(function(){
       $('#pagecontent').append(_header).trigger("pagecreate");
       $('#pagecontent').append(_content).trigger("pagecreate");
  } 
```

我可以在 chrome 中获得登录屏幕，但不能在移动设备和 Mozilla firefox 上

你能帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T17:42:07.960

Srikanth，document.ready() 与 JQM 的实现略有不同，也许这样的事情会做？

```
$(document).bind('pageinit',function()
{
    $.mobile.changePage("#pagecontent", { transition: "slide" });
    $('#pagecontent').live('pageshow', function (event, ui) {
        $('#pagecontent').append(_header).trigger("pagecreate");
        $('#pagecontent').append(_content).trigger("pagecreate");    
    });
}); 
```

# c++ - 使用 MySQL C++ 连接器解析未定义的引用

> ID：13348395
> 
> 赞同：2
> 
> 时间：2012-11-12T17:24:46.910
> 
> 标签：c++, mysql, g++, mysql-connector

我正在尝试编译它（也在 mysql c++ 连接器文档中列出）： http: [//pastebin.com/HLv4zR0r](http://pastebin.com/HLv4zR0r)

但我收到这些错误： http: [//pastebin.com/3t0UbeFy](http://pastebin.com/3t0UbeFy)

这就是我尝试编译的方式：

```
g++ -o test test.cpp `mysql_config --cflags --libs` -I./include/cppconn -L./lib -lmysqlcppconn-static 
```

运行的结果`mysql_config --cflags --libs`是：

```
-I/usr/include/mysql -DBIG_JOINS=1  -fno-strict-aliasing  -g
-L/usr/lib/x86_64-linux-gnu -lmysqlclient -lpthread -lz -lm -lrt -ldl 
```

编辑：

在使用正确排序的链接器参数运行 Jonathan Wakely 建议的命令后，

```
g++ -o test test.cpp  -I./include/cppconn -L./lib -lmysqlcppconn-static `mysql_config --cflags --libs` 
```

我得到不同的错误： http: [//pastebin.com/4EWNgy9i](http://pastebin.com/4EWNgy9i)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T22:36:29.500

mysqlcppcon 库依赖于 mysqlclient C 库，因此需要将 mysqlclient 库放在*后面* `-lmysqlcppconn-static`

```
g++ -o test test.cpp  -I./include/cppconn -L./lib -lmysqlcppconn-static `mysql_config --cflags --libs` 
```

链接器参数的顺序很重要。链接器按顺序查看每个文件并决定是否需要其中的任何符号。当它看到`libmysqlcppconn-static.a`它已经查看（并忽略）libmysqlclient.so 库的文件时，不会再回头查看它。

# sql - ORA-00936: 缺少表达式。为什么我收到这条消息？

> ID：13348399
> 
> 赞同：0
> 
> 时间：2012-11-12T17:24:56.597
> 
> 标签：sql, oracle, plsql, case-when

我的意思是我尝试了所有使用方法`begin`，`end`但它不起作用。我怎样才能解决这个问题？

```
select
     case 
    when exists
    (select ORG_UNIT_NAME from aaa.bbb 

    where ORG_UNIT_NAME ='ccc' and created_Date=to_date('01/11/2012','dd/mm/yyyy') )

    then

    update  aaa.bbb 
    set PROJECT_QUOTA=555 where ORG_UNIT_NAME  ='ccc' and created_Date=to_date('01/11/2012','dd/mm/yyyy')

    else
    'asd'

    end as exist_
    from dual 
```

如果我之后使用'ddd'而不是更新它的工作，但为什么更新不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T17:32:58.640

在 SQL 中，`CASE`构造不是流控制结构。想想它的通用版本`COALESCE()`。你不能`UPDATE`在里面放一个完整的查询！

您可能希望您的主要查询是`UPDATE`type 而不是`SELECT`. [您可以在http://psoug.org/reference/update.html](http://psoug.org/reference/update.html)找到一些复杂的示例

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T23:13:04.857

要仅基于条件进行更新，只需将其添加到 WHERE 子句。但你猜怎么着——你已经把它放在那里了。这个查询应该做你想做的事 - 是吗？

```
update  aaa.bbb 
set PROJECT_QUOTA=555 
where ORG_UNIT_NAME  ='ccc' and created_Date=to_date('01/11/2012','dd/mm/yyyy') 
```

# android - 使用小部件打开 Wifi

> ID：13348403
> 
> 赞同：0
> 
> 时间：2012-11-12T17:25:20.807
> 
> 标签：android

当用户单击小部件图标时，我需要打开和关闭 wifi...

```
WifiManager wifiManager = (WifiManager) getApplicationContext().getSystemService(Context.WIFI_SERVICE); 
if(wifiManager.isWifiEnabled())
    wifiManager.setWifiEnabled(false);
else
    wifiManager.setWifiEnabled(true); 
```

我如何使用 pendingIntents 来实现它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T17:30:34.383

步骤#1：创建一个`BroadcastReceiver`包含你的`setWifiEnabled()`逻辑。

`<receiver>`步骤#2：用清单中的元素声明该接收器。

第 3 步：将 a`getBroadcast()` `PendingIntent`与应用小部件中的按钮一起使用，指向 this `BroadcastReceiver`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-27T17:26:34.000

下载下面的例子它会帮助你

[https://github.com/siddhpuraamitr/WIfi-Toggle-Widget](https://github.com/siddhpuraamitr/WIfi-Toggle-Widget)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-09-30T05:40:10.783

**从 Android-10（API 级别 29）**

根据`documentation`，应用程序将无法再以`Wi-Fi OFF/ON`编程方式从`Android-10` `API level 29`**[直到谷歌提供替代解决方案]**。

有关详细信息，请参阅[此答案](https://stackoverflow.com/a/58075794/4854891)。

# ios - IOS：按下按钮的动作

> ID：13348404
> 
> 赞同：0
> 
> 时间：2012-11-12T17:25:24.387
> 
> 标签：ios, button

在我的应用程序中，我想在按下按钮时执行一个操作，当我释放此按钮时，我希望此操作停止执行。我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T17:29:12.097

为两种控制状态添加目标到您的按钮`UIControlEventTouchDown`，`UIControlEventTouchUpInside`或者`UIControlEventTouchUpOutside`

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-11-12T17:29:00.580

除了这是一项被问了 1000 次的基本任务之外，还请阅读一些[Apple 关于目标操作的文档！](https://developer.apple.com/library/mac/#documentation/General/Conceptual/Devpedia-CocoaApp/TargetAction.html)

编辑：我不明白你为什么会投反对票。我提供了一个链接，他可以自己找到答案，而且在 5 分钟内用 google 找到答案并不是超级容易。他没有靠自己的努力提供任何东西。

这不是：“请发布有关如何解决此问题的代码”...

# c# - wcf 服务响应中返回的对象，它们是什么？

> ID：13348409
> 
> 赞同：1
> 
> 时间：2012-11-12T17:26:14.487
> 
> 标签：c#, wcf, dns, poco, domain-object

我正在开发一个 MVC4 应用程序，它与一组 WCF 服务通信以检索数据。我使用 svcutil 从端点生成服务引用。

服务操作接受请求对象并返回响应对象。在这些对象中是“实体”。例如，getproduct 操作返回一个 getproductresponse 对象，该对象具有名为 Product 的属性，该属性是“Product”类型。

我的问题是，“产品”对象、实体、poco 还是域对象？我想创建包含所有此类对象的类库，但不确定应该调用什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T17:35:53.910

对于 MVC 层，它是 DTO。但是，您不应猜测服务是否向您发送实体、poco 或域对象。这些只不过是您的数据容器（作为 MVC 层作者）。

将它们视为 DTO 的另一个论点是，因为服务实现在未来可能会发生变化，您最终可能会拥有其他东西，但您身边的结构相同。

*DTO*表示数据传输对象。

# sql - 为什么这个 oracle 查询返回空结果集？

> ID：13348412
> 
> 赞同：1
> 
> 时间：2012-11-12T17:26:28.153
> 
> 标签：sql, oracle, oracle11g

我有两个带有一些演示数据的数据库表，如下所示

```
Create table demo(uuid int, addressname varchar(50));

insert into demo values(1, 'intersportprofi');
insert into demo values(2, 'intersportprofi');
insert into demo values(3, 'intersportprofi');
insert into demo values(4, 'intersportmarket');
insert into demo values(5, 'intersportmarket');
insert into demo values(6, 'intersportmarket');

create table demo_av(uuid int, testid int, name varchar(50), value varchar(50));

insert into demo_av values(1, 1, 'sport','football basketball cricket');
insert into demo_av values(2, 1, 'brand','reebok  addidas nike');
insert into demo_av values(3, 2, 'sport','football basketball ');
insert into demo_av values(4, 2, 'brand','reebok  addidas '); 
```

我编写了以下查询以从这些表中获取结果，但 oracle 返回空结果集。

```
SELECT  d.addressname  FROM demo d, demo_av dv
WHERE  d.uuid = dv.testid  AND d.addressname='intersportprofi' 
AND REGEXP_LIKE( dv.value, 'reebok') AND REGEXP_LIKE( dv.value, 'cricket') 
```

为什么？我在哪里做错了？任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-12T17:28:39.567

改变这个：

```
AND REGEXP_LIKE( dv.value, 'reebok') AND REGEXP_LIKE( dv.value, 'cricket') 
```

对此：

```
AND (REGEXP_LIKE( dv.value, 'reebok') OR REGEXP_LIKE( dv.value, 'cricket')) 
```

因为：

`"demo_av"`表中没有与`"reebok"` **AND** 匹配的记录`"cricket"`。由于第一个条件的存在，您需要的运算符是`"OR"`并且括号是***必要的。***

**更新**

这是结果的捕获屏幕：

![在此处输入图像描述](../Images/cae6fbead53afad98aac2d26fb982db3.png)

干杯

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-12T19:10:51.843

根据您的评论，我认为您需要一个查询，该查询将搜索具有相同的多行`testid`。这可以通过连接或像这样来完成：

```
SELECT DISTINCT d.addressname  
FROM demo AS d
WHERE d.addressname = 'intersportprofi' 
  AND EXISTS
      ( SELECT *
        FROM demo_av AS dv
        WHERE d.uuid = dv.testid 
          AND dv.value LIKE '%reebok%'
      )
  AND EXISTS
      ( SELECT *
        FROM demo_av AS dv
        WHERE d.uuid = dv.testid 
          AND dv.value LIKE '%cricket%'
      ) ; 
```

# php - OOP 风格编码

> ID：13348416
> 
> 赞同：0
> 
> 时间：2012-11-12T17:26:42.833
> 
> 标签：php

更新根据专家的指示，我以这种方式修改了代码：

```
<?php
//Class Validation
class transaction_validate{

private $val_id;
    function __construct($id) {
        $this->val_id = $id;
    }

public function status(){
    //Call our server and decode json value
    $data = $this->get_data($this->val_id);
    $obj = json_decode($data);

    return $obj->status;
}

public function amount(){
    //Call our server and decode json value
    $data = $this->get_data($this->val_id);
    $obj = json_decode($data);

    return $obj->amount;
}

//Create a function for fetching data
private function get_data($sid){
    $url = 'https://domain.com/verify/process.php?trx='.$sid;
    $ch = curl_init();
    $timeout = 5;
    curl_setopt($ch,CURLOPT_URL,$url);
    curl_setopt($ch,CURLOPT_RETURNTRANSFER,1);
    curl_setopt($ch,CURLOPT_CONNECTTIMEOUT,$timeout);
    $data = curl_exec($ch);
    curl_close($ch);
    return $data;
}
}

$validate = new transaction_validate();
$validate->val_id = '5201211120944';
echo $validate->amount();
echo '<br>';
echo $validate->status(); 
```

输出是

> 警告：transaction_validate::__construct() 缺少参数 1，
> 
> 致命错误：无法访问私有财产 transaction_validate::$val_id

使困惑！

============================上一个问题==================== ===================

我只是在学习 OOP 风格的 PHP 编码。试图编写一个供个人使用的脚本，这似乎是错误的。代码是：

```
<?php
//Class Validation
class transaction_validate{

    var $val_id;

    public function status(){
        //Call our server and decore json value
        $data = get_data();
        $obj = json_decode($data);

        return $obj->status;
    }

    public function amount(){
        //Call our server and decore json value
        $data = get_data();
        $obj = json_decode($data);

        return $obj->amount;
    }

    //Create a function for featching data
    private function get_data($val_id){
        $url = 'https://domain.com/verify/process.php?trx='.$val_id;
        $ch = curl_init();
        $timeout = 5;
        curl_setopt($ch,CURLOPT_URL,$url);
        curl_setopt($ch,CURLOPT_RETURNTRANSFER,1);
        curl_setopt($ch,CURLOPT_CONNECTTIMEOUT,$timeout);
        $data = curl_exec($ch);
        curl_close($ch);
        return $data;
    }
}

$validate = new transaction_validate('5201211120944');
echo $validate->amount();
echo '<br>';
echo $validate->status(); 
```

输出是

> 致命错误：在第 17 行的 /home/userdo/public_html/class.php 中调用未定义函数 get_data()

我需要认识到我做错了什么。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-12T17:31:48.847

您需要告诉 PHP 该函数在类上下文中：

```
$this->get_data() 
```

如评论中所述，您应该添加一个构造函数来设置您传入的 id ...

```
class transaction_validate{

    private $val_id;

    function __construct($id) {
        $this->val_id = $id;
    }

    //... 
```

此外，如果您正在编写 OOP，则验证可能属于表示事务的域实体，而不是验证助手类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T17:39:11.280

这是因为`get_data()`不是在全局范围内而是在`transaction_validate`类中定义的（顺便说一下，我建议将其更改为`TransactionValidate`；这是 OOP 命名约定之一）。

要调用函数（在 OOP 中 – 方法），您需要使用变量`$this`，它基本上指向一个类的当前实例（在本例中是`transaction_validate`.

所以代码应该是这样的：

```
$data = $this->get_data(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-12T17:59:41.527

要调用在类中定义的函数，必须使用类实例调用，即定义函数的类的对象。

在上面的示例中，get_data 是在类中定义的私有函数，根据 OOP 的数据隐藏原则，私有成员只能在同一个类中访问它们隐藏在类之外意味着私有成员不能在类定义之外调用。

因此它将以下列方式调用

```
<?php

   //Class Validation
  class transaction_validate{

var $val_id;

public function status(){
    //Call our server and decore json value
    $data =$this->get_data();
    $obj = json_decode($data);

    return $obj->status;
}

public function amount(){
    //Call our server and decore json value
    $data = $this0get_data();
    $obj = json_decode($data);

    return $obj->amount;
}

//Create a function for featching data
private function get_data($val_id){
    $url = 'https://domain.com/verify/process.php?trx='.$val_id;
    $ch = curl_init();
    $timeout = 5;
    curl_setopt($ch,CURLOPT_URL,$url);
    curl_setopt($ch,CURLOPT_RETURNTRANSFER,1);
    curl_setopt($ch,CURLOPT_CONNECTTIMEOUT,$timeout);
    $data = curl_exec($ch);
    curl_close($ch);
    return $data;
}
}

         $validate = new transaction_validate('5201211120944');
         echo $validate->amount();
          echo '<br>';
         echo $validate->status(); 
```

# ios - XCode 4.5 无法验证应用程序？

> ID：13348417
> 
> 赞同：3
> 
> 时间：2012-11-12T17:26:45.890
> 
> 标签：ios, xcode, app-store

当我尝试验证应用程序时，我收到此错误消息：

```
(null):  Icon specified in the Info.plist not found under the top level app wrapper:  (-19007)
Unable to validate your application. - (null) 
```

这通常是由丢失/损坏的图标文件引起的，但在这种情况下不是。我打开存档并在`IconPath`列表的 info.plist 文件中找到以下行：

```
Applications/xxxxx.app/_CodeSignature 
```

此行未在应用内 plist 文件中指定，我猜这是错误的过程。

知道有什么问题吗？这是一个相当古老的项目，所以 xcode 中可能发生了一些变化。

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-16T10:46:21.960

我们的自定义 XCode 项目模板似乎有问题。该模板可以追溯到 XCode 3.x。使用此模板创建的新项目在 XCode 4.5 中似乎存在此问题。我将文件移动到使用 Apple 标准项目模板之一创建的新项目中，问题就消失了。

# jquery-mobile - jquery mobile：单击内容区域上的标题切换可见/隐藏

> ID：13348420
> 
> 赞同：-1
> 
> 时间：2012-11-12T17:26:50.200
> 
> 标签：jquery-mobile, header, navigation

单击页面内容中的任何位置时，jquery mobile topnavigation 切换开关的开/关（可见不可见）。这怎么能阻止？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T19:18:25.147

如[jQuery Mobile 文档](http://jquerymobile.com/test/docs/toolbars/bars-fixed-options.html)中所见，您可以使用 tapToggle 选项或 data-tap-toggle 数据属性。

> 启用或禁用用户通过点击屏幕（或单击，对于鼠标用户）来切换工具栏可见性的能力。

# c# - C# 从字符串中删除反斜杠“\”

> ID：13348421
> 
> 赞同：0
> 
> 时间：2012-11-12T17:26:54.177
> 
> 标签：c#

我正在使用此方法在 Windows 临时目录上创建 PDF 文件：

```
System.IO.Path.GetTempPath() 
```

而且我将字符串与 DateTime 连接起来，如下所示：

```
string pathPdf = string.Format(System.IO.Path.GetTempPath() + "detalle-{0}{1:yyyyMMddhhmmss}.pdf", txtFolio_detalle_consum.Text, DateTime.Now); 
```

这是字符串的值：

```
C:\\Users\\Admin\\AppData\\Local\\Temp\\detalle-6020121112102343.pdf 
```

但是，当我稍后在代码中尝试使用该值时，一些 c# 如何删除我以下列方式结束字符串的双反斜杠：

```
C:UsersAdminAppDataLocalTempdetalle-6020121112102343.pdf 
```

没有反斜杠。

任何人都知道为什么 c# 会这样做？

提前致谢。

**更新** 我使用以下函数输出带有 Javascript 警报的变量：

```
protected void alerta(string msj)
{
    string script1 = @"<script type='text/javascript'>alert('" + msj + "');</script>";
    ScriptManager.RegisterStartupScript(this, typeof(Page), "Adv", script1, false);
} 
```

我还传递了这个变量以在这样的查询字符串上使用它：

```
string scriptjs = string.Format("<script language='JavaScript'>window.open('emergentes_consum/vista_previa_imprimir.aspx?DocumentUrl={0}', '_blank', 'fullscreen=no')</script>",pathPdf);
    ScriptManager.RegisterStartupScript(this, typeof(Page), "Capturar_Emails", scriptjs, false); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T17:29:02.207

启动调试器，将变量添加到 Watch 窗口，然后逐步通过程序找到删除这些斜杠的代码。C# 本身并不这样做。

旁注 - 用于`System.IO.Path.Combine`连接路径（文件夹和文件）。

正如评论中所证明的那样，有问题的字符串被传递给 JavaScript alert - 所以解决方案是添加一个调用[`HttpUtility.JavaScriptStringEncode`](http://msdn.microsoft.com/en-us/library/dd991914.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T17:28:22.300

那不是字符串的值。
这就是调试器显示字符串的方式。

如果在源代码中编写字符串文字，则需要对`\`s 进行转义，或者使用逐字字符串文字 ( `@"C:\a\b"`)

# javascript - 如何使用书签将自定义 HTML 注入页面？

> ID：13348422
> 
> 赞同：1
> 
> 时间：2012-11-12T17:27:11.367
> 
> 标签：javascript, bookmarklet

我想象一个小书签，它可以让用户将任意一段 HTML 粘贴到页面上。

就像是

```
var html = prompt("Please enter HTML");
$(document).append(html); // jQuery-like syntax - just illustrating what I want to achieve 
```

`prompt()`不太适合这个，因为它是一个衬里 - 我想粘贴多行。这在直接的js中[是不可能的。](https://stackoverflow.com/questions/7255444/javascript-multi-line-textbox-in-prompt)您可以制作一个创建新 div 的小书签，让您在该 div 中输入 HTML，然后将 div 的内容作为原始 HTML 注入。

在构建它之前，我想知道这是否以前做过？

# node.js - Node.js：内存使用量不断上升

> ID：13348424
> 
> 赞同：4
> 
> 时间：2012-11-12T17:27:15.830
> 
> 标签：node.js, memory-management, setinterval, mjpeg

我们正在编写一个脚本，它读取我们服务器上的大量 JPG 文件（无限，因为我们有另一个进程不断将 JPG 文件写入同一目录）并以固定时间间隔将它们作为 MJPEG 流发送到用户的浏览器（下面代码中的变量“frameDelay”）。这类似于 IP 摄像机的功能。

我们发现这个脚本的内存使用量一直在上升，并且总是被系统杀死（Ubuntu）；

我们已经多次检查过这个看似简单的脚本。因此，我在下面发布代码。非常感谢任何意见/建议！

```
app.get('/stream', function (req, res) {
    res.writeHead(200, {
        'Content-Type':'multipart/x-mixed-replace;boundary="' + boundary + '"',
        'Transfer-Encoding':'none',
        'Connection':'keep-alive',
        'Expires':'Fri, 01 Jan 1990 00:00:00 GMT',
        'Cache-Control':'no-cache, no-store, max-age=0, must-revalidate',
        'Pragma':'no-cache'
    });
res.write(CRLF + "--" + boundary + CRLF);

setInterval(function () {
    if(fileList.length<=1){
        fileList = fs.readdirSync(location).sort();
    }else{
        var fname = fileList.shift();
        if(fs.existsSync(location+fname)){
           var data = fs.readFileSync(location+fname);
            res.write('Content-Type:image/jpeg' + CRLF + 'Content-Length: ' + data.length + CRLF + CRLF);
            res.write(data);
            res.write(CRLF + '--' + boundary + CRLF);                   
            fs.unlinkSync(location+fname);
        }else{
            console.log("File doesn't find")
        }
    }
        console.log("new response:" + fname);
    }, frameDelay);
});

app.listen(port);
console.log("Server running at port " + port); 
```

为了便于故障排除过程，下面是一个独立的（没有第 3 方库）测试用例。

它具有完全相同的内存问题（内存使用量不断上升，最终被操作系统杀死）。

我们认为问题出在 setInterval () 循环中——也许这些图像在发送后没有从内存中删除或其他东西（可能仍存储在变量“res”中？）。

非常感谢任何反馈/建议！

```
var http                = require('http');
var fs                  = require('fs');

var framedelay  = 40;
var port                = 3200;
var boundary    = 'myboundary';
var CR                  = '\r';
var LF                  = '\n';
var CRLF                = CR + LF;

function writeHttpHeader(res)
{
        res.writeHead(200,
        {
                'Content-Type': 'multipart/x-mixed-replace;boundary="' + boundary + '"',
                'Transfer-Encoding': 'none',
                'Connection': 'keep-alive',
                'Expires': 'Fri, 01 Jan 1990 00:00:00 GMT',
               'Cache-Control': 'no-cache, no-store, max-age=0, must-revalidate',
                'Pragma': 'no-cache',
        });

        res.write(CRLF + '--' + boundary + CRLF);
}

function writeJpegFrame(res, filename)
{
        fs.readFile('./videos-8081/frames/' + filename, function(err, data)
        {
                if (err)
                {
                        console.log(err);
                }
                else
                {
                        res.write('Content-Type:image/jpeg' + CRLF);
                        res.write('Content-Length:' + data.length + CRLF + CRLF);
                            res.write(data);
                        res.write(CRLF + '--' + boundary + CRLF);
                        console.log('Sent ' + filename);
                }
        });
}
http.createServer(function(req, res)
{
     writeHttpHeader(res)    
     fs.readdir('./videos-8081/frames', function(err, files)
     { 
         var i = -1;
         var sorted_files = files.sort();    
         setInterval(function()
         {
              if (++i >= sorted_files.length)
              {
                i = 0;
              }    
              writeJpegFrame(res, sorted_files[i]);
          }, framedelay);
        });
}).listen(port);
console.log('Server running at port ' + port); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-12T22:44:54.377

当然它会泄漏内存。你做

```
 setInterval(...) 
```

在每个请求上，但您永远不会清理这些间隔。这意味着在（例如）20 个请求之后，您将在后台运行 20 个间隔，即使客户端/连接早已失效，它们也将**永远运行。**解决方案之一如下：

```
var my_interval = setInterval(function() {
    try {
        // all your code goes here
    } catch(e) {
        // res.write should throw an exception once the connection is dead
        // do the cleaning now
        clearInterval( my_interval );
    }
}, frameDelay);

req.on( "close", function() {
    // just in case
    clearInterval( my_interval );
}); 
```

这确保`my_interval`了连接关闭后（以及所有相应的数据）将被清除。

PS我建议使用`setTimeout`而不是`setInterval`，因为加载文件可能需要更多时间`frameDelay`，这会导致问题。

PS2。使用`fs`函数的异步版本。Node.JS 的全部力量在于非阻塞操作，而您在这里失去了主要优势（性能）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-13T03:32:14.370

有几件事导致了这个

*   MJPEG 并非旨在以高频率发送高分辨率运动图片（在您的情况下，25fps 可能适用于 320x240 帧，但不适用于 720p。）只需考虑有效负载的输出吞吐量 25fps*70KB = 1750KBps = 14Mbps，即高于全高清视频。
*   当客户端无法接收时，Node.js 会将输出缓存在缓冲区中。因为您要向客户端发送大量数据，所以节点为您保存了它们。这就是为什么您的内存使用量永远不会下降的原因，这*不是*内存泄漏。要检测输出缓冲区是否已变大，请检查`res.write()`.
*   `setInterval()`可以使用，只要客户端保持连接就不会出现问题。但是当客户端断开连接时，您需要停止它。为此，您需要监视“关闭”事件。
*   您无法通过使用 MJPEG 来保持稳定的 fps，因为它不是为此目的而设计的，因此无论您多么努力，您都无法控制客户端的 fps。但是通过精心设计的代码，您可以*通过*使用`setTimeout()`.

这是固定代码。

```
var http = require('http');
var fs = require('fs');
var framedelay = 40;
var port = 3200;
var boundary = 'myboundary';
var CR = '\r';
var LF = '\n';
var CRLF = CR + LF;

http.createServer(function(req, res) {

  var files = fs.readdirSync('./imgs');
  var i = -1;
  var timer;
  var sorted_files = files.sort();

  res.writeHead(200, {
    'Content-Type': 'multipart/x-mixed-replace;boundary="' + boundary + '"',
    'Transfer-Encoding': 'none',
    'Connection': 'keep-alive',
    'Expires': 'Fri, 01 Jan 1990 00:00:00 GMT',
    'Cache-Control': 'no-cache, no-store, max-age=0, must-revalidate',
    'Pragma': 'no-cache',
  });

  res.write(CRLF + '--' + boundary + CRLF);

  var writePic = function() {

    if (++i >= sorted_files.length)
      i = 0;

    var data = fs.readFileSync('./imgs/' + sorted_files[i]);
    res.write('Content-Type:image/jpeg' + CRLF);
    res.write('Content-Length:' + data.length + CRLF + CRLF);
    res.write(data);
    var ok = res.write(CRLF + '--' + boundary + CRLF);
    console.log('Sent ' + sorted_files[i], ok);

    if (ok)
      timer = setTimeout(writePic, framedelay);
  };

  res.on('close', function() {
    console.log('client closed');
    clearTimeout(timer);
  });

  res.on('drain', function() {
    console.log('drain');
    timer = setTimeout(writePic, framedelay);
  });

}).listen(port);

console.log('Server running at port ' + port); 
```

# excel - VBA在列中添加缺失的数字并在B列中的旁边添加一个零

> ID：13348426
> 
> 赞同：-4
> 
> 时间：2012-11-12T17:27:19.527
> 
> 标签：excel, vba

任何人都可以为以下任务编写代码。

我在 A 列中有一系列数字，在 B 列中有一个相关值。

例如

```
AB

1 144
2 33
5 4
6 56
8 1

```

我需要运行一个宏，在 A 列中添加缺少的连续数字，并在 b 列中添加一个相关的零值。

例如

```
1 144
2 33
3 0
4 0
5 4
6 56
7 0
8 1
```

谁能帮忙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T17:46:44.370

如果您可以在不同的工作表上显示信息，则不需要 vba。

在第二张纸上，将您的数字放在 A 列中，使用自动填充来获取进度，或`=A1+1`用作创建进度的公式。

在 B 列中，用于`=IFERROR(VLOOKUP(A1,Sheet1!$A$1:$B$5000,2,FALSE),0)`查找数字，`0`如果没有找到数字，则使用

（`=IF(ISERROR(VLOOKUP(A1,Sheet1!$A$2:$B$5,2,FALSE)),0,VLOOKUP(A1,Sheet1!$A$2:$B$5,2,FALSE))`如果您的 excel 版本不支持 ISERORR，请使用）

# iphone - 从 CLLocationManager 授权警报中检测按钮按下

> ID：13348429
> 
> 赞同：1
> 
> 时间：2012-11-12T17:27:23.147
> 
> 标签：iphone, ios, uialertview, cllocationmanager

我正在检测用户是否已接受在我的应用程序中使用位置服务的请求，我在 UI 中有一个取决于此接受的切换开关。他们第一次切换开关（打开）时，会触发使用位置的请求。我想知道他们在那个警报中按下了哪个按钮。（接受或拒绝）现在我只是将其关闭并让用户再次按下它（然后检测他们选择了哪个选项）。

这种方式有点草率，所以我想知道是否有办法检测到这个特定的警报，或者因为它是由操作系统而不是应用程序触发的，所以不能这样做？我还没有尝试过，但我想我可以将`UIAlertView`委托方法用于通用按钮按下，但希望有更具体的东西。

*更新*

当我触发位置请求（并显示授权提示）时，只需注册一个通知，我就能够完成这项工作。应用程序处于非活动状态（很像下拉通知栏）。我只是在应用程序激活时触发通知，并且我可以在那里查询授权状态并更新我的 UI。如果他们想即时处理授权状态，我希望这可以帮助其他任何人。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-12T17:54:19.760

没有办法拦截警报。但是，有一个`CLLocationManagerDelegate`方法叫做[didChangeAuthorizationStatus](https://developer.apple.com/library/mac/documentation/CoreLocation/Reference/CLLocationManagerDelegate_Protocol/CLLocationManagerDelegate/CLLocationManagerDelegate.html#//apple_ref/occ/intfm/CLLocationManagerDelegate/locationManager%3adidChangeAuthorizationStatus%3a)。这可能是您最接近拦截警报的方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T17:31:25.907

无法明确知道用户选择了哪个按钮，因为正如您所说，此警报来自操作系统。但是，您可以查明您的应用程序是否已启用位置服务，并以此方式了解。使用这样的方法：

```
-(BOOL)locationServicesIsEnabled
{
    if (![CLLocationManager locationServicesEnabled] || ![CLLocationManager     authorizationStatus])
    return NO;
return YES;
} 
```

# php - 加载图像文件时 print() 和 readfile() 有什么区别？

> ID：13348432
> 
> 赞同：1
> 
> 时间：2012-11-12T17:27:34.703
> 
> 标签：php, readfile

只是想知道以下两个代码示例是否有任何区别：

```
$image = 'http://www.example.com/image.jpg'

$photo = file_get_contents($image);

ob_start();
header("Content-type: image/jpeg");
print($photo);
ob_end_flush(); 
```

或者...

```
$image = 'http://www.example.com/image.jpg'

$photo = file_get_contents($image);

ob_start();
header("Content-type: image/jpeg");
readfile($photo);
ob_end_flush(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T17:29:23.030

`readfile`将文件名作为参数有一个非常显着的区别。

第二个片段应该类似于

```
$image = ...
readfile($image) 
```

这样做的好处是不必将整个文件内容存储在内存（字符串）中，因为`readfile`它会立即发出。当然，如果您缓冲不再正确的输出。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T17:30:58.877

在第一种情况下，您的代码将永远无法工作

```
 readfile($photo);
              ^--------------- Takes file name not string 
```

PHP 文档说

> 读取文件并将其写入输出缓冲区。

您无需重新设置事件并使用多个其他功能复制它，这只是说

```
 readfile = file_get_contents + print 
```

它就像使用`fopen`而不是`file_get_contents`仅仅获取文件中的简单内容

最后`readfile`在同一图像上使用 10000 循环进行更快的测试

```
Single Run
Array
(
    [m1] => 0.0006101131439209
    [m2] => 0.00031208992004395
)
Dual Run
Array
(
    [m1] => 3.4585757255554   
    [m2] => 2.9963381290436   <---- Faster 
) 
```

`m1`&`m2`功能

```
function m1($array) {
    $photo = file_get_contents('a.png');
    ob_start();
    print($photo);
    ob_end_clean();
}

// Array clean copy
function m2($array) {
    ob_start();
    readfile('a.png');
    ob_end_clean();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-12T17:31:39.720

[`readfile`](http://php.net/readfile)的参数是文件名，而不是内容本身。因此，您可以这样称呼它：

```
$image = 'http://www.example.com/image.jpg'
ob_start();
header("Content-type: image/jpeg");
readfile($image);
ob_end_flush(); 
```

由于`readfile`一次读取和写入块，它的内存消耗将是恒定的，而当您将结果存储`file_get_contents`到时`$photo`，您需要有足够的内存来存储图像。

在您的情况下，输出缓冲使`file_get_contents`变体需要*两倍*于图像大小的内存。因此，对于大图像，`readfile`内存需求减半。请注意，您的输出缓冲意味着下载将被延迟。如果您不需要它来做其他任何事情，如果您简单地禁用它，您将获得更好的性能（在实际速度和服务器内存要求方面）：

```
$image = 'http://www.example.com/image.jpg'
header("Content-type: image/jpeg");
if (@readfile($image) === false) {
   // print error image
} 
```

# android - 如何围绕中心轴旋转形状

> ID：13348435
> 
> 赞同：0
> 
> 时间：2012-11-12T17:27:49.620
> 
> 标签：android, android-animation, android-canvas, android-view

当谈到 Android 动画时，我很惊讶地发现这么少的例子。我找到了动画演示，但它们只提供了您可能想要实现的一小部分。

对于我的特殊情况，我只是试图围绕中心点设置形状的动画。我可以从演示中看到，您可以使用以下内容来传递值：

```
ObjectAnimator.ofObject(
      ballHolder
    , "name"
    , new XYEvaluator()
    , position1, position2, position3, position4, positionEtc); 
```

但是我怎样才能传递一个圆圈的所有值呢？我确定您不会以这种方式实现它（如上例所示）。

也许我应该以不同的方式做这件事？任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T12:48:51.810

尝试此代码并根据需要进行调整：

要实现旋转动画，您可以在 XML 中定义该动画：在 /res/anim 文件夹下创建一个名为 :rotate_around_center_point.xml 的动画 xml 文件

```
 <?xml version="1.0" encoding="utf-8"?> 
  <set  xmlns:android="http://schemas.android.com/apk/res/android"
   android:shareInterpolator="false"> 
   <rotate android:toDegrees="360"  
     android:duration="700"  
     android:pivotX="205"    
     android:pivotY="180"
     android:interpolator="@android:anim/linear_interpolator"/>
  </set> 
```

将动画应用于 View ：让我们说它用于旋转图像：

```
 ImageView animationTarget = (ImageView) this.findViewById(R.id.testImage);
     Animation animation = AnimationUtils.loadAnimation(this,
     R.anim.rotate_around_center_point); animationTarget.startAnimation(animation); 
```

或者

在 Java 代码中动态创建动画：

```
 Animation newAnimation = new RotateAnimation(0, 360, 205, 180);
 newAnimation.setDuration(700);
 animationTarget.startAnimation(newAnimation); 
```

希望有帮助。

# c++ - How can you print instruction in llvm

> ID：13348439
> 
> 赞同：13
> 
> 时间：2012-11-12T17:28:07.170
> 
> 标签：c++, c, compiler-construction, llvm

From an llvm pass, I need to print an llvm instruction (Type `llvm::Instruction`) on the screen, just like as it appears in the llvm bitcode file. Actually my compilation is crashing, and does not reach the point where bitcode file is generated. So for debugging I want to print some instructions to know what is going wrong.

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2015-10-29T23:26:56.553

Assuming I is your instruction

```
I.print(errs()); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-12T17:39:34.360

By simply using the `print` method.

# mysql - 关于重构sql查询

> ID：13348443
> 
> 赞同：1
> 
> 时间：2012-11-12T17:28:19.637
> 
> 标签：mysql, sql, database, oracle

我有以下查询，虽然它达到了预期的结果，但它是一个冗长的查询，请告诉我是否有其他方法可以重组我的查询.. 我想将此长查询减少到更小的形式

```
 SELECT final_lines.line_number line_number, 
       final_lines.line_desc   line_desc, 
       Sum(final_lines.value)  value 
FROM   (SELECT main.line_code                          line_number, 
               main.line_desc                          line_desc, 
               ( COALESCE(main.net_sales, 0) 
                 + COALESCE(paid_out.paidout_amt, 0) ) value 
        FROM   (SELECT t.line_num       line_num, 
                       t.line_code      line_code, 
                       t.line_desc      line_desc, 
                       Sum(t.net_sales) net_sales 
                FROM   (SELECT pstl.prgp_id                    AS line_num, 
                               line.prgp_code                  AS line_code, 
                               line.prgp_desc                  AS line_desc, 
                               COALESCE(Sum(txn.txn_sales), 0) AS Net_Sales 
                        FROM   prodgp_str_link pstl 
                               JOIN prodgp_structure pstr 
                                 ON pstl.pstr_id = pstr.pstr_id 
                               JOIN product_group line 
                                 ON line.prgp_id = pstl.prgp_id 
                               LEFT JOIN prod_pgrp_link ppgl 
                                      ON pstl.prgp_child_id = ppgl.prgp_id 
                               LEFT JOIN product prd 
                                      ON prd.prod_id = ppgl.prod_id 
                               LEFT JOIN (SELECT dtl.txde_sku_code sku_code, 
                                                 CASE 
                                                   WHEN dtl.txde_level5_id IN ( 
                                                        'D100-5', 'D100-4', 
                                                        'D100-7', 
                                                        'D100-6', 
                                                        'D11-11', 'D11-1', 
                                                        'D5-1', 
                                                        'D5-5', 
                                                        'D100-10', 'D100-11', 
                                                        'D100-69' 
                                                        , 'D100-9' 
                                                        , 
                                                        'D100-100', 'D5-69', 
                                                        'D100-8', 
                                                        'D11-69', 
                                                        'D100-1', 'D100-3', 
                                                        'D100-2' ) 
                                                              THEN 
                                                   COALESCE (Sum( 
                                                   CASE 
                                                     WHEN dtl.txde_line_refund
= 
                                                          0 THEN 
                                                     dtl.txde_price_sold * 
                                                     dtl.txde_quantity_sold 
                                                     ELSE dtl.txde_price_sold * 
               dtl.txde_quantity_sold *- 1 
               END), 0) 
               ELSE COALESCE(Sum(CASE 
               WHEN dtl.txde_line_refund = 0 
               THEN 
               dtl.txde_value_line 
               ELSE dtl.txde_value_line *- 1 
               END), 0) 
               END               txn_sales 
               FROM   txn_detail dtl 
               JOIN txn_header hdr 
               ON dtl.orgu_code_cmpy = hdr.orgu_code_cmpy 
               AND dtl.orgu_code = hdr.orgu_code 
               AND dtl.till_short_desc = hdr.till_short_desc 
               AND dtl.txhd_txn_nr = hdr.txhd_txn_nr 
               JOIN txn_header_wag txhw 
               ON hdr.orgu_code_cmpy = txhw.orgu_code_cmpy 
               AND hdr.orgu_code = txhw.orgu_code 
               AND hdr.till_short_desc = txhw.till_short_desc 
               AND hdr.txhd_txn_nr = txhw.txhd_txn_nr 
               WHERE  hdr.txhd_txn_type IN ( 3, 8 ) 
               AND dtl.txde_detail_type IN ( 
               '1', '2', '3', '201', 
               '202', '203', '204', '205', 
               '206', '207', '208', '210', 
               '211' ) 
               AND txhw.txhw_processed_date = '20121112' 
               AND hdr.txhd_state = 0 
               AND hdr.txhd_training_mode = 0 
               AND hdr.txhd_voided = 0 
               AND dtl.txde_item_void = 0 
               GROUP  BY dtl.txde_sku_code, 
               dtl.txde_level5_id) txn 
               ON prd.prod_sku = txn.sku_code 
               WHERE  pstl.pstr_id = 3 
               AND pstr.pstr_is_live = 1 
               AND pstl.prgp_parent_id = 0 
               AND line.prgp_code IN ( '30', '50', '60' ) 
               GROUP  BY pstl.prgp_id, 
               line.prgp_code, 
               line.prgp_desc 
               UNION ALL 
               SELECT pstl.prgp_id                     AS line_num, 
               line.prgp_code                   AS line_code, 
               line.prgp_desc                   AS line_desc, 
               COALESCE(Sum(txn5.txn_sales), 0) AS Net_Sales 
               FROM   prodgp_str_link pstl 
               JOIN prodgp_structure pstr 
               ON pstl.pstr_id = pstr.pstr_id 
               JOIN product_group line 
               ON line.prgp_id = pstl.prgp_id 
               LEFT JOIN product_group child 
               ON pstl.prgp_child_id = child.prgp_id 
               LEFT JOIN (SELECT 
               dtl.txde_level5_id level5id, 
               CASE 
               WHEN dtl.txde_level5_id IN ( 
               'D100-5', 'D100-4', 'D100-7', 
               'D100-6', 
               'D11-11', 'D11-1', 'D5-1', 
               'D5-5', 
               'D100-10', 'D100-11', 'D100-69' 
               , 'D100-9' 
               , 
               'D100-100', 'D5-69', 'D100-8', 
               'D11-69', 
               'D100-1', 'D100-3', 'D100-2' ) 
                   THEN 
               COALESCE (Sum(CASE 
               WHEN dtl.txde_line_refund = 0 THEN 
               dtl.txde_price_sold * 
               dtl.txde_quantity_sold 
               ELSE dtl.txde_price_sold * 
               dtl.txde_quantity_sold *- 1 
               END), 0) 
               ELSE COALESCE(Sum(CASE 
               WHEN dtl.txde_line_refund = 0 
               THEN 
               dtl.txde_value_line 
               ELSE dtl.txde_value_line *- 1 
               END), 0) 
               END                txn_sales 
               FROM   txn_detail dtl 
               JOIN txn_header hdr 
               ON dtl.orgu_code_cmpy = hdr.orgu_code_cmpy 
               AND dtl.orgu_code = hdr.orgu_code 
               AND dtl.till_short_desc = hdr.till_short_desc 
               AND dtl.txhd_txn_nr = hdr.txhd_txn_nr 
               LEFT JOIN txn_taxes tax 
               ON dtl.orgu_code_cmpy = tax.orgu_code_cmpy 
               AND dtl.orgu_code = tax.orgu_code 
               AND dtl.till_short_desc = 
               tax.till_short_desc 
               AND dtl.txhd_txn_nr = tax.txhd_txn_nr 
               AND dtl.txde_detail_nr = tax.txtx_detail_nr 
               JOIN txn_header_wag txhw 
               ON hdr.orgu_code_cmpy = txhw.orgu_code_cmpy 
               AND hdr.orgu_code = txhw.orgu_code 
               AND hdr.till_short_desc = txhw.till_short_desc 
               AND hdr.txhd_txn_nr = txhw.txhd_txn_nr 
               WHERE  hdr.txhd_txn_type IN ( 3, 8 ) 
               AND dtl.txde_level5_id IS NOT NULL 
               AND dtl.txde_sku_code IS NULL 
               AND dtl.txde_detail_type IN ( 
               '1', '2', '3', '201', 
               '202', '203', '204', '205', 
               '206', '207', '208', '210', 
               '211' ) 
               AND txhw.txhw_processed_date = '20111212' 
               AND hdr.txhd_state = 0 
               AND hdr.txhd_training_mode = 0 
               AND hdr.txhd_voided = 0 
               AND dtl.txde_item_void = 0 
               GROUP  BY dtl.txde_level5_id) txn5 
               ON child.prgp_code = txn5.level5id 
               WHERE  pstl.pstr_id = 3 
               AND pstr.pstr_is_live = 1 
               AND pstl.prgp_parent_id = 0 
               AND line.prgp_code IN ( '30', '50', '60' ) 
               GROUP  BY pstl.prgp_id, 
               line.prgp_code, 
               line.prgp_desc) t 
                GROUP  BY t.line_num, 
                          t.line_code, 
                          t.line_desc 
                ORDER  BY t.line_code) main 
               LEFT JOIN (SELECT t.line_code      line_code, 
                                 t.line_desc      line_desc, 
                                 Sum(t.net_sales) paidout_amt 
                          FROM   (SELECT pstl.prgp_id                    AS 
                                         line_num, 
                                         line.prgp_code                  AS 
                                         line_code, 
                                         line.prgp_desc                  AS 
                                         line_desc, 
                                         COALESCE(Sum(txn.txn_sales), 0) AS 
                                         Net_Sales 
                                  FROM   prodgp_str_link pstl 
                                         JOIN prodgp_structure pstr 
                                           ON pstl.pstr_id = pstr.pstr_id 
                                         JOIN product_group line 
                                           ON line.prgp_id = pstl.prgp_id 
                                         LEFT JOIN prod_pgrp_link ppgl 
                                                ON pstl.prgp_child_id = 
                                                   ppgl.prgp_id 
                                         LEFT JOIN product prd 
                                                ON prd.prod_id = ppgl.prod_id 
                                         LEFT JOIN (SELECT dtl.txde_sku_code 
                                                           sku_code 
                                                           , 
                                                           COALESCE( 
                                                   Sum(hdr.txhd_value_nett), 0) 
                                                           txn_sales 
                                                    FROM   txn_detail dtl 
                                                           JOIN txn_header hdr 
                                                             ON 
                                                   dtl.orgu_code_cmpy = 
                                                   hdr.orgu_code_cmpy 
                                                   AND 
                                                   dtl.orgu_code =
hdr.orgu_code 
                                                                AND 
                                                   dtl.till_short_desc 
                                                   = 
                                                   hdr.till_short_desc 
                                                                AND 
                                                   dtl.txhd_txn_nr = 
                                                   hdr.txhd_txn_nr 
                                                           JOIN txn_header_wag 
                                                                txhw 
                                                             ON 
                                                   hdr.orgu_code_cmpy = 
                                                   txhw.orgu_code_cmpy 
                                                   AND 
                                                   hdr.orgu_code = 
                                                   txhw.orgu_code 
                                                                AND 
                                                   hdr.till_short_desc 
                                                   = 
       txhw.till_short_desc 
       AND hdr.txhd_txn_nr = 
       txhw.txhd_txn_nr 
       WHERE  hdr.txhd_txn_type = 10 
       AND dtl.txde_detail_type IN ( 
       '1', '2', '3', '201', 
       '202', '203', '204', '205', 
       '206', '207', '208', '210', 
       '211' ) 
       AND txhw.txhw_processed_date = 
       '20111212' 
       AND hdr.txhd_state = 0 
       AND hdr.txhd_training_mode = 0 
       AND hdr.txhd_voided = 0 
       AND dtl.txde_item_void = 0 
       GROUP  BY dtl.txde_sku_code) txn 
       ON prd.prod_sku = txn.sku_code 
       WHERE  pstl.pstr_id = 3 
       AND pstr.pstr_is_live = 1 
       AND pstl.prgp_parent_id = 0 
       AND line.prgp_code IN ( '30', '50', '60' ) 
       GROUP  BY pstl.prgp_id, 
       line.prgp_code, 
       line.prgp_desc) t 
       GROUP  BY t.line_num, 
       t.line_code, 
       t.line_desc 
       ORDER  BY t.line_code) paid_out 
       ON main.line_code = paid_out.line_code) final_lines 
GROUP  BY line_number, 
          line_desc 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T19:50:20.567

您可以将其拆分为您为其创建视图的逻辑组件。

例如 ：

```
 LEFT JOIN
    (SELECT dtl.txde_sku_code sku_code , COALESCE( SUM(hdr.txhd_value_nett), 0) txn_sales FROM txn_detail dtl
    JOIN txn_header hdr ON dtl.orgu_code_cmpy      = hdr.orgu_code_cmpy AND dtl.orgu_code = hdr.orgu_code AND
      dtl.till_short_desc                          = hdr.till_short_desc AND dtl.txhd_txn_nr = hdr.txhd_txn_nr
    JOIN txn_header_wag txhw ON hdr.orgu_code_cmpy = txhw.orgu_code_cmpy AND hdr.orgu_code = txhw.orgu_code AND
      hdr.till_short_desc                          = txhw.till_short_desc AND hdr.txhd_txn_nr = txhw.txhd_txn_nr
    WHERE hdr.txhd_txn_type                        = 10
    AND dtl.txde_detail_type                      IN ( '1', '2', '3', '201', '202', '203', '204', '205', '206',
      '207', '208', '210', '211' )
    AND txhw.txhw_processed_date = '20111212'
    AND hdr.txhd_state           = 0
    AND hdr.txhd_training_mode   = 0
    AND hdr.txhd_voided          = 0
    AND dtl.txde_item_void       = 0
    GROUP BY dtl.txde_sku_code
    ) txn ON prd.prod_sku = txn.sku_code 
```

可以替换为：

```
CREATE OR REPLACE VIEW sum_sales_by_date_sku_code 
AS
SELECT txhw.txhw_processed_date processed_date,dtl.txde_sku_code sku_code , COALESCE( SUM(hdr.txhd_value_nett), 0) txn_sales FROM txn_detail dtl
    JOIN txn_header hdr ON dtl.orgu_code_cmpy      = hdr.orgu_code_cmpy AND dtl.orgu_code = hdr.orgu_code AND
      dtl.till_short_desc                          = hdr.till_short_desc AND dtl.txhd_txn_nr = hdr.txhd_txn_nr
    JOIN txn_header_wag txhw ON hdr.orgu_code_cmpy = txhw.orgu_code_cmpy AND hdr.orgu_code = txhw.orgu_code AND
      hdr.till_short_desc                          = txhw.till_short_desc AND hdr.txhd_txn_nr = txhw.txhd_txn_nr
    WHERE hdr.txhd_txn_type                        = 10
    AND dtl.txde_detail_type                      IN ( '1', '2', '3', '201', '202', '203', '204', '205', '206',
      '207', '208', '210', '211' )
AND hdr.txhd_state           = 0
AND hdr.txhd_training_mode   = 0
AND hdr.txhd_voided          = 0
AND dtl.txde_item_void       = 0
GROUP BY dtl.txde_sku_code; 
```

查询部分将更改为：

```
 LEFT JOIN sum_sales_by_sku_code  tnx ON prd.prod_sku = txn.sku_code
 WHERE tnx.processed_date = '20111212' 
```

# android - 将数据从自定义视图发送到父活动

> ID：13348447
> 
> 赞同：1
> 
> 时间：2012-11-12T17:28:26.717
> 
> 标签：android, android-activity, android-view

我有一个包含自定义视图和几个按钮的活动。

现在，如果单击视图，我将在视图类中使用覆盖的 onTouchEvent 来处理它。

但是，根据用户点击的确切位置，我可能想要更改父活动中按钮中包含的文本。

换句话说：如何让父活动从我的自定义视图接收数据？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T17:45:52.780

定义一个接口并使用回调让活动知道该视图已被触摸。

```
public Interface ViewWasTouchedListener {
    void onViewTouched(float x, float y);
} 
```

在您的自定义视图中

```
ArrayList<ViewWasTouchedListener> listeners = new ArrayList<ViewWasTouchedListener>();

...

public void setWasTouchedListener(ViewWasTouchedListener listener){
    listeners.add(listener);
} 
```

在你的触摸事件中

```
for (ViewWasTouchedListener listener:listeners){
   listener.onViewTouched(x,y);
} 
```

在您的活动中：

```
public class Test extends Activity implements ViewWasTouchedListener {

...

@Override
public void onCreate(Bundle savedInstanceState) 
{
    ...
    MyExtendedView customView = (MyExtendedView)findViewById(R.id.myCustomeView);
    customView.setWasTouchedListener(this);
    ...
}

public void onViewTouched(float x, float y){
   // do whatever you need to do
} 
```

您可以通过添加 removeViewWasTouchedListener 并检查您没有在 setViewWasTouchedListener 中添加两次相同的侦听器来改进视图类。

# javascript - VS2012 智能感知 jQuery.noConflict()

> ID：13348453
> 
> 赞同：2
> 
> 时间：2012-11-12T17:28:51.020
> 
> 标签：javascript, jquery, reference, visual-studio-2012, intellisense

这是我修改后的`jquery 1.6.4`文件结尾：

```
...

    // Expose jQuery to the global object
    window.jQuery = window.$ = jQuery;

})(window);

var $j = jQuery.noConflict(); 
```

`jQuery.intellisense.js`也存在于同一目录中。

我的`_references`文件如下所示：

```
/// <reference path="Libraries/JQuery.js" /> 
```

但仅`$(`出现在智能感知列表中并为我提供参数工具提示，键入`$j(`不会出现在列表中或有工具提示。智能感知没有看到这个`noConflict()`位吗？

# android - 您可以将合并标签与片段一起使用吗？

> ID：13348455
> 
> 赞同：44
> 
> 时间：2012-11-12T17:29:01.127
> 
> 标签：android, android-layout, merge, android-fragments

如果我使用`merge`标签作为片段布局的父标签，我会遇到两个问题：

*   首先，在 中`onCreateView()`，如果我指定不附加到 root，我会收到错误：

    `android.view.InflateException: <merge /> can be used only with a valid ViewGroup root and attachToRoot=true`

*   如果我确实附加到根目录，我会收到错误消息：

    `java.lang.IllegalStateException: The specified child already has a parent. You must call removeView() on the child's parent first.`

我在这里找到了另一个问题的好答案，说片段库会自动将子视图附加到您在替换中指定的父视图组。建议是您需要因此设置`attachToRoot`为`false`. 对于`merge`标签，它是必需的。

是否可以绕过这些规则中的任何一个来将`merge`标签用于片段的布局？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-11-12T20:53:52.343

> 是否可以绕过这些规则中的任何一个来将合并标签用于片段的布局？

不，正如你已经看到的，当你对一个以`merge`标签为根的布局文件进行膨胀时，你**必须**将它附加到一个有效的 parent `ViewGroup`。将其附加到容器中`onCreateView`是不正确的，因为`View`该方法返回的将由框架添加。

您始终可以在`onCreateView`附加膨胀布局的方法中创建一个包装器布局（并返回此包装器布局），但这将使`merge`标签优化无用，因为您可以从一开始就在 xml 布局文件中添加包装器布局：

```
@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
     LinearLayout wrapper = new LinearLayout(getActivity()); // for example
     inflater.inflate(R.layout.layout_with_merge_as_root, wrapper, true);
     return wrapper;
} 
```

# android - 尽管使用了公式，但 Android 应用程序小部件太大

> ID：13348457
> 
> 赞同：3
> 
> 时间：2012-11-12T17:29:01.640
> 
> 标签：android, android-appwidget

我的 Android 应用程序的用户报告包含的应用程序小部件太大。

我用过这个公式：

```
width/height = (number-of-cells * 74) - 2 
```

所以我得到了一个 4x1 小部件的 294dp 宽度和 72dp 高度。但是，正如我所说，用户报告说小部件比 4x1 占据更多的位置。

这怎么可能发生？不同的安卓版本有区别吗？

**编辑：**我已将其设置为最小宽度/高度和调整宽度/高度。我的这个 appwidget 的布局文件使用`fill_parent`，所以它不应该扩展那个大小。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-12T17:42:43.850

[此文档页面](http://developer.android.com/guide/practices/ui_guidelines/widget_design.html#anatomy_determining_size)（我想与 Android 4.x 相关）显示公式为：

```
width/height = `70 * n - 30` 
```

...`n`采取的细胞数量在哪里。它还提到...

> 添加您的小部件时，它将被拉伸以在水平和垂直方向上占据最小数量的单元格，以满足其 minWidth 和 minHeight 约束

根据问题中给出的尺寸，您的应用程序将扩展到 5 个单元格（320dp；250dp 不够）宽度方向和 2 个单元格（110dp；40dp 不够）高度。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-06T11:41:38.843

为不同的 Android 版本支持不同的小部件非常简单。

为了支持 Android 版本 >= 4.0，您必须将小部件的内容放在正确的文件夹中。

*   `/res/xml-v14`
*   `/res/layout-v14`[选修的]

`-v14`表示 API-Level 14 (Android 4.0)。Android 版本高于或等于 4.0 将使用这些文件夹中的文件。不要忘记计算`android:minWidth`和`android:minHeight`使用正确的公式：

```
cell_size in dp = 70 × n − 30 
```

您可以将工作小部件留在现有文件夹中：

*   `/res/xml`
*   `/res/layout`

使用正确的论坛：

```
cell_size in dp = 74 × n - 2 
```

为了保持简单并重复使用计算的尺寸，您还可以在正确的文件夹中创建正确的尺寸并参考尺寸。

*   创建一个`/res/values/widget_size.xml`包含 Android 版本 < 4.0 的尺寸的文件

> ```
> <resources>
>     <dimen name="cell_size_1">72dp</dimen>
>     <dimen name="cell_size_2">146dp</dimen> 
> </resources> 
> ```

*   创建一个`/res/values-v14/widget_size.xml`包含 Android 版本 >= 4.0 的尺寸的文件

> ```
> <resources>
>     <dimen name="cell_size_1">40dp</dimen>
>     <dimen name="cell_size_2">110dp</dimen>
> </resources> 
> ```

*   将小部件的大小引用到新创建的尺寸。

> ```
> android:minWidth="@dimen/cell_size_2"
> android:minHeight="@dimen/cell_size_1" 
> ```

不幸的是，这不适用于运行 Android 4.04 的 Galaxy Tab 7.7。3x1 小部件是 2x1，尽管它在模拟器上显示正确的大小。我认为这是因为

> 虽然单元格的宽度和高度以及应用于小部件的自动边距数量可能因设备而异，但您可以使用下表**粗略估计**小部件的最小尺寸，给定所需的占用网格单元数：

在[App Widget Design Guidelines中说明](http://developer.android.com/guide/practices/ui_guidelines/widget_design.html)

# asp.net - WCF Web 服务 WebInvoke 操作返回 401 Unauthorized

> ID：13348468
> 
> 赞同：1
> 
> 时间：2012-11-12T17:29:33.203
> 
> 标签：asp.net, wcf, web-services, visual-studio

我是 WCF Web 服务的新手，不太了解如何调试 Web 服务...

以下示例，我创建了一个具有如下界面的 Web 服务：

```
public interface IMyService
{
    [OperationContract]
    [WebInvoke(Method = "GET", ResponseFormat = WebMessageFormat.Json, BodyStyle = WebMessageBodyStyle.WrappedRequest)]
    List<MyClass> GetData(string param);
} 
```

以及返回 MyClass 列表的实现。

部署后，我在 Fiddler 中调用了该服务，例如

```
http://localhost/MyService.svc/GetData?keyword=blabla 
```

它返回：

```
HTTP/1.1 401 Unauthorized
Server: Microsoft-IIS/7.5
SPRequestGuid: blabla
WWW-Authenticate: blabla
X-Powered-By: ASP.NET
MicrosoftSharePointTeamServices: 14.0.0.6114
Access-Control-Allow-Origin: *
Access-Control-Allow-Methods: POST, GET, OPTIONS
Date: Mon, 12 Nov 2012 17:24:08 GMT
Content-Length: 0 
```

如果我只是写在作曲家：

```
http://localhost/MyService.svc/GetData 
```

如果没有参数，它会返回状态为 200 的空 json。

当我在 Chrome 中尝试第一个请求时，它连续向服务器要求我的用户名和密码，但输入它们并没有帮助我摆脱循环（要求用户名和密码）。

有没有人遇到过这样的问题？或者你能对调试有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T17:58:17.910

WCF 服务通常不允许开箱即用的 GET 访问。要剽窃我自己的答案（此处：[https](https://stackoverflow.com/a/13229373/1014822) ://stackoverflow.com/a/13229373/1014822 ），您需要在 web.config 中设置一个如下所示的配置部分：

```
<bindings>
  <webHttpBinding>
    <binding name="crossDomain" crossDomainScriptAccessEnabled="true" />
  </webHttpBinding>
</bindings>
<behaviors>
  <endpointBehavior>
    <behavior name="restBehavior">
      <webHttp />
    </behavior>
  </endpointBehavior>
  <serviceBehavior>         
     <behavior name="MyServiceBehavior">
        <serviceMetadata httpGetEnabled="true"  />
        <serviceDebug includeExceptionDetailInFaults="true"/>
     </behavior>
  </serviceBehavior>
</behaviors>
<services>
  <service name="..." behaviorConfiguration="MyServiceBehavior">
    <endpoint address="" binding="webHttpBinding" bindingConfiguration="crossDomain" 
              contract="..." behaviorConfigurations="restBehavior" /> 
  </service>
</services> 
```

您可能不需要跨域元素，但您至少需要允许的端点行为`<webHttp />`和允许的服务行为`<serviceMetadata httpGetEnabled="true" />`。然后您就不能拥有无配置的服务 - 您需要该`<service/>`元素才能绑定这些行为。您将需要`<service/>`使用您的服务名称和合同的接口名称来完成该元素（例如`IMyService`）

如果您只通过 GET 进行测试，因为它更容易做，但会在您的实际应用程序中使用 POST（或 http 以外的其他协议），那么您可以考虑使用 WCF 测试客户端进行调试，而不是浏览器和/或提琴手. 此处客户端的详细信息：http: [//msdn.microsoft.com/en-us/library/bb552364.aspx](http://msdn.microsoft.com/en-us/library/bb552364.aspx)

# c# - 更改 XML 节点的属性值

> ID：13348475
> 
> 赞同：0
> 
> 时间：2012-11-12T17:30:11.653
> 
> 标签：c#, xml, xml-attribute

我正在尝试更改具有子节点的 XML 节点的现有属性值。尝试执行此操作时出现异常。

```
string specificOwnerPath = "Owners/Owner[@id='" + startingOwnerName + startingOwnerZipCode + "']";
XmlNode ownerID = doc.SelectSingleNode(specificOwnerPath);
ownerID.Attributes["id"].Value = ownerNameTextBox.Text + ownerZipCodeTextBox.Text; 
```

我得到的异常说'对象引用未设置为对象的实例，并且发生在上面显示的最后一行代码中。有人对我做错了什么有任何建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T17:33:07.627

添加支票

```
if (ownerID != null) 
```

到最后一行之前。很可能您的 XPath 不正确（或者根本没有任何匹配的元素）。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2021-04-25T16:48:04.880

如果（所有者ID！= null）

Xpath 在最后一行不正确

# scala - 使用枚举器编写函数

> ID：13348479
> 
> 赞同：5
> 
> 时间：2012-11-12T17:30:22.640
> 
> 标签：scala, scalaz, iterate

是否可以使用 Enumerator 或 EnumeratorM 组合任意函数，以便首先通过应用该函数对推入迭代器的每个单独的数据项进行预处理？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T08:24:00.883

至少对于 Scalaz 6，没有 - 如果函数的返回类型与其参数类型不同（而不是子类型），则不会，因为`EnumeratorM`' 的类型不允许它更改迭代的输入类型。

*但是，可以使用iteratee* “预组合”任意函数，所以我认为这是要走的路。也可以使用枚举对象，但 Scalaz 6 中没有提供这种抽象。

# curl - 如何从命令行上传文件作为詹金斯的文件参数

> ID：13348480
> 
> 赞同：16
> 
> 时间：2012-11-12T17:30:24.023
> 
> 标签：curl, jenkins, command-line-interface

我在 Jenkins 的命令行中使用字符串参数触发构建：

```
curl http://jenkins:8080/job/Build/buildWithParameters?PARAM=value&token=token 
```

我现在想从命令行以文件作为文件参数触发构建。

例如，如果我的项目构建 main.c，那么我希望能够触发构建并从命令行上传我的 main.c。

这可能吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-08-05T06:35:41.037

这在[Jenkins 远程访问](https://wiki.jenkins-ci.org/display/JENKINS/Remote+access+API)API 页面中有描述：

```
curl http://jenkins/job/$JOB_NAME/build -F file0=@PATH_TO_FILE -F json='{"parameter": [{"name":"FILE_LOCATION_AS_SET_IN_JENKINS", "file":"file0"}]}' 
```

请注意，您需要使用 URL /build 而不是 /buildWithParameters

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-10-05T01:03:46.323

如果需要同时发送字符串参数和文件参数，可以执行以下操作：

```
json='{"parameter": [{"name": "param1", "value": "value1"},
  {"name": "param2", "value": "value2"},
  {"name":"fileParam", "file":"file0"}]}'

url=http://jenkins/job/My_Remote_Jenkins_Job/build

curl -v $url -F file0=@/some/folder/path/template.zip -F json="$json" --user username:password 
```

我必须确保这些参数`param1`，`param2`并且`fileParm`存在于 Jenkins 工作`My_Remote_Jenkins_Job`中。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-11-15T09:39:37.177

我使用的解决方案（基于 Christophers 关于使用[jenkins-cli](https://wiki.jenkins-ci.org/display/JENKINS/Jenkins+CLI)的建议）是：

```
java -jar jenkins-cli.jar -s http://jenkins:8080 build Build -p main.c=hello.c 
```

带有 main.c 文件参数的哪个文件参数会将您的本地 hello.c 作为 main.c 上传到构建作业的工作区

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-04-09T00:04:14.013

不幸的是，自 Jenkins 2.165 以来， [Russels](https://stackoverflow.com/a/13394763/7571258)对使用 CLI 的回答不再起作用，因为 Jenkins 命令行界面的“远程处理”操作模式已被删除。

从[詹金斯博客](https://jenkins.io/blog/2019/02/17/remoting-cli-removed/)：

> 采用本地文件或 = 用于标准输入/输出（例如 install-plugin、build -p、support）的命令选项或参数现在只接受后者。

这意味着必须像这样更改命令行：

```
java -jar jenkins-cli.jar -s http://jenkins:8080 build Build -p main.c= <hello.c 
```

通过为文件参数“main.c”传递一个空字符串，我们向 CLI 指示该文件应该从标准输入中读取。我们正在使用 shell 重定向运算符“<”将文件“hello.c”重定向到标准输入。

# jquery - jQuery Cycle - 分页拇指中的谷歌分析事件跟踪

> ID：13348481
> 
> 赞同：-1
> 
> 时间：2012-11-12T17:30:27.617
> 
> 标签：jquery, google-analytics, cycle, jquery-cycle, event-tracking

我正在尝试将 Google Analytics 事件标记应用于 jQ Cycle 寻呼机缩略图。

最初，我的主幻灯片使用 ga 事件跟踪脚本可以正常工作，此时缩略图分页也可以正常工作。但是当我将事件跟踪应用到 pagerAnchorBuilder 回调函数时，缩略图会消失，主幻灯片保持可见但停止循环——实际上整个事情都停止了。

我正在使用带有锚链接的幻灯片：http: [//jquery.malsup.com/cycle/anchor.html](http://jquery.malsup.com/cycle/anchor.html) 我通过之前的帖子解决了“未定义”寻呼机怪癖：[jQuery Cycle plugin pagerAnchorBuilder images become undefined](https://stackoverflow.com/questions/2472116/jquery-cycle-plugin-pageranchorbuilder-images-becoming-undefined/13270266#13270266) – 也显示在我的代码如下。

以下是我正在尝试的 pagerAnchorBuilder 回调，它可以完美运行，直到我通过 onClick 事件添加 ga 跟踪器：

```
pagerAnchorBuilder: function(idx, slide) {
  var slideurl = $('#slideshow a', this).attr('href');
  return '<li class="slider-thumb"><a href="'+slide.href+'" title="'+slide.title+'" onClick="_gaq.push(['_trackEvent', 'Home-Slider-Thumb', '+slide.title+', '+slide.href+']);"><img src="'+ $(slide).find('img').attr('src')+'" width="50" height="50" class="thumb-image" /></a><p class="slide-caption">'+ $(slide).find('img').attr('alt')+'</p></li>';
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T18:21:15.597

你没有逃避你的报价。不能在单引号内使用单引号；你需要使用双打或逃避它。

```
return '<li class="slider-thumb"><a href="'+slide.href+'" title="'+slide.title+'" onClick="_gaq.push([\'_trackEvent\', \'Home-Slider-Thumb\', \''+slide.title+'\', \''+slide.href+'\']);"><img src="'+ $(slide).find('img').attr('src')+'" width="50" height="50" class="thumb-image" /></a><p class="slide-caption">'+ $(slide).find('img').attr('alt')+'</p></li>'; 
```

# python - Django 帮助 - 如何从外键获取数据

> ID：13348483
> 
> 赞同：1
> 
> 时间：2012-11-12T17:30:31.953
> 
> 标签：python, django

给定以下模型设置（精简）：

```
class Object(models.Model):
    name = models.CharField(max_length=255)

class ObjectVersion(models.Model):   
    Cabinet = models.ForeignKey(Object) 
```

假设我有一堆`ObjectVersion`我过滤的条目，称为“filteredObjects”。我如何将这些对象的名称放入向量中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T17:37:27.757

所以你是说你有一个名为的列表`filteredObjects`？

```
objNames = [fo.name for fo in filteredObjects] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T17:39:48.113

您可以使用`values_list`或`values`。这些文档可在[此处](https://docs.djangoproject.com/en/dev/ref/models/querysets/#values)的 Django QuerySet API 参考中找到。

```
>>> ObjectVersion.objects.filter(...).values('Cabinet__name')
[{'Cabinet__name':'foo'}, {'Cabinet__name':'foo2'}, ...] 
```

或者

```
>>> ObjectVersion.objects.filter(...).values_list('Cabinet__name')
[('foo',), ('foo2',), ...] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T20:48:50.297

```
result = ObjectVersion.objects.filter(your filters here).values_list('Cabinet__name', flat=True) 
```

输出：

```
 result = ['ver_1', 'ver_2'..] 
```

# android - 从 Web 链接启动现有的 Android 应用程序

> ID：13348487
> 
> 赞同：1
> 
> 时间：2012-11-12T17:30:41.627
> 
> 标签：android

我正在考虑开发一个基于网络的资源，供我们的销售代表在他们的平板电脑上使用。在其他信息中，我想包括可以在平板电脑上启动其他应用程序的链接。例如，指向 Google Drive 应用程序的链接（甚至可能指向特定文件夹）。或者可能是指向 Android 图库的链接。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T17:42:01.540

是的，您可以，您必须为 url 使用意图过滤器和自定义方案。

[https://stackoverflow.com/a/2958870/1552551](https://stackoverflow.com/a/2958870/1552551)

# shell - unix cal 命令特殊字符

> ID：13348490
> 
> 赞同：1
> 
> 时间：2012-11-12T17:30:50.670
> 
> 标签：shell, unix, awk, cal

当我在我的 unix 机器上尝试“ `cal | tail -6`”时，我得到 -

```
 1  2  3
 4  5  6  7  8  9 10 
11 12 13 14 15 16 17 
18 19 20 21 22 23 24
25 26 27 28 29 30 
```

但是当我尝试“ `cal | tail -6 | awk '{print $7}'`”时，我得到-

```
10
17
24 
```

3去哪儿了？`cal`我的要求基本上是所有工作日，即第 2、3、4、5 和 6 列。但是由于“ ” 的奇怪行为，我得到了错误的输出

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-12T17:32:52.980

第一行中只有 3 个空格分隔的列。 `cal`完全按照正确的方式工作，您不了解其`awk`工作原理。就`awk`您而言，第一行中没有第 7 列，因为它会引起对空格分隔列的关注，而不是固定宽度的列。

快速谷歌搜索显示您可以使用

```
BEGIN  { FIELDWIDTHS = "3 3 3 3 3 3 3" } 
```

在你的`awk`脚本中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T21:49:51.007

由于每行中的所有列都是三个字符宽，因此您可以使用它来提取您想要的日期。例如，如果您只想要列中的第 7 天，您可以执行以下操作：

```
cal | sed 's/^\(.\{18\}\).*$/\1/' 
```

此命令将删除该行中的前 18 个字符，它们是一周前 6 天的条目。

要提取特定的一天，例如第四天，您可以这样做：

```
cal | sed 's/^.\{9\}\(.\{3\}\).*$/\1/' 
```

要删除一周的第一天和最后一天，您可以这样做：

```
cal | sed -e 's/^.\{3\}//' -e 's/^\(.\{15\}\).\{3\}$/\1/' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T21:56:30.687

可能是按行提取就可以了。试试ncal。例如：

```
$ ncal
November 2012
Mo     5 12 19 26
Tu     6 13 20 27
We     7 14 21 28
Th  1  8 15 22 29
Fr  2  9 16 23 30
Sa  3 10 17 24
Su  4 11 18 25 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-12T22:07:59.000

或用占位符填写缺席日期（例如，使用“-”）：

```
kent$  cal -s|tail -6|awk 'NR==1&&NF<7{gsub(/^ */,"");for(i=1;i<=(7-NF);i++) x=" - "x;$0=x" "$0;}1'                       
 -  -  -  -  1  2  3
 4  5  6  7  8  9 10
11 12 13 14 15 16 17
18 19 20 21 22 23 24
25 26 27 28 29 30 
```

然后你可以得到列，如果需要，用“”替换'-'。例如对于`$7:`

```
 kent$  cal -s|tail -6|awk 'NR==1&&NF<7{gsub(/^ */,"");for(i=1;i<=(7-NF);i++) x=" - "x;$0=x" "$0;}{print $7}'   
3
10
17
24 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-13T08:53:48.393

请注意，除非您将其关闭 ( `-h`)，否则今天的日期会突出显示。用于`cut`提取想要的列：

```
cal -h | cut -c19-20 
```

输出：

```
Sa
 3
10
17
24 
```

# android - 列出对话框片段 - 找不到资源

> ID：13348492
> 
> 赞同：1
> 
> 时间：2012-11-12T17:30:53.503
> 
> 标签：android, android-layout, android-widget

我有一个内部类来创建和显示一个简单的列表对话框。

```
private static class DisplayListDialogFragment extends DialogFragment 
{
    List<String> list;
    OnClickListener clickListener;

    private static DisplayListDialogFragment newInstance(List<String> list, String title, OnClickListener clickListener)
    {
        DisplayListDialogFragment dldf = new DisplayListDialogFragment();
        dldf.list = (List<String>)list;
        dldf.clickListener = clickListener;
        Bundle bundle = new Bundle();
        bundle.putString("title", title);
        dldf.setArguments(bundle);
        return dldf;
    }

    @Override
    public Dialog onCreateDialog(Bundle savedInstanceState)
    {
        ArrayAdapter<String> ad = new ArrayAdapter<String>(getActivity(), R.id.simpleListItem, this.list);
        AlertDialog.Builder builder = new AlertDialog.Builder(getActivity());
        builder.setTitle(R.string._select_display)
               .setSingleChoiceItems(ad, 1, this.clickListener);
        return builder.create();
    }
} 
```

引用的资源在字符串文件中声明

```
 <string name="_select_display">Select Display</string> 
```

和一个名为 simple_list.xml 的小文件

```
<?xml version="1.0" encoding="utf-8"?>
<TextView
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/simpleListItem"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_gravity="center_horizontal"
    android:textAppearance="?android:attr/textAppearanceMedium"
/> 
```

该应用程序在线路资源膨胀器深处的某处爆炸

```
return builder.create(); 
```

堆栈跟踪是

```
11-12 17:21:01.664: E/AndroidRuntime(1335): android.content.res.Resources$NotFoundException: Resource ID #0x7f040052 type #0x12 is not valid
11-12 17:21:01.664: E/AndroidRuntime(1335):     at android.content.res.Resources.loadXmlResourceParser(Resources.java:1874)
11-12 17:21:01.664: E/AndroidRuntime(1335):     at android.content.res.Resources.getLayout(Resources.java:731)
11-12 17:21:01.664: E/AndroidRuntime(1335):     at android.view.LayoutInflater.inflate(LayoutInflater.java:318)
11-12 17:21:01.664: E/AndroidRuntime(1335):     at android.widget.ArrayAdapter.createViewFromResource(ArrayAdapter.java:332)
11-12 17:21:01.664: E/AndroidRuntime(1335):     at android.widget.ArrayAdapter.getView(ArrayAdapter.java:323) 
```

资源 ID 在 R.java 中定义为

```
 public static final int simpleListItem=0x7f040052 
```

（即上面simple_list.xml文件中声明的TextView）

任何人都可以看到有什么问题吗？我现在正在挠头。

谢谢

安德鲁

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T18:32:11.617

`ArrayAdapter`查看您正在调用的特定构造函数的文档：

```
public ArrayAdapter (Context context, int textViewResourceId, List<T> objects) 
```

特别是，它解释了第二个参数参数：

> textViewResourceId -包含在实例化视图时使用的 TextView 的布局文件的**资源 ID 。**

换句话说，您当前传入了错误的 ID 类型（这也是 LogCat 错误所说的）。您应该提供布局文件的 ID，而不是`TextView`在布局文件中提供 ID。想一想：`TextView`如果你不提及布局，Android 怎么知道从哪里开始？

更改创建`ArrayAdapter`为：

```
ArrayAdapter<String> ad = new ArrayAdapter<String>(getActivity(), R.layout.simple_list, this.list); 
```

或者，传入布局*和* `TextView`ID：

```
ArrayAdapter<String> ad = new ArrayAdapter<String>(getActivity(), R.layout.simple_list, R.id.simpleListItem, this.list); 
```

PS：我同意文档可能会导致一些混乱，因为`textViewResourceId`参数的含义因各种构造函数而异。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-03T13:58:03.523

简单代码：

```
AlertDialog.Builder builder = new AlertDialog.Builder(getActivity());
builder.setTitle("Title");
       .setItems(R.array.colors_array, new DialogInterface.OnClickListener() {
           public void onClick(DialogInterface dialog, int which) {
           // The 'which' argument contains the index position
           // of the selected item
       }
});
return builder.create().show; 
```

# javascript - 将左滚动设置为在刷新时从零开始不起作用

> ID：13348499
> 
> 赞同：3
> 
> 时间：2012-11-12T17:31:12.153
> 
> 标签：javascript, jquery

为什么这在 IE 中不起作用，如果我将滚动条移到中间然后刷新它不会重置为零，而是停留在最后离开的位置？

```
$(document).ready(function(){

    $(window).scrollLeft(0);

}); 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T20:47:15.527

该脚本应该可以根据需要工作

```
$(document).ready(function ()
{
    $(window).bind("scroll", ScrollOnLoad);
    // IE fix, remove scroll handler after 150ms
    setTimeout(UnbindScroll, 150); 
});

function ScrollOnLoad() {
    UnbindScroll();
    $(window).scrollLeft(0);
}

function UnbindScroll() {
    $(window).unbind("scroll", ScrollOnLoad);
} 
```

如您所见，IE 的行为是不同的。它甚至在之后触发`scroll`事件`document.ready`。此脚本将连接此事件并`scrollLeft(0)`在刷新后（在所有浏览器中）。

复杂的部分是，当用户第一次访问该页面时，如何解决新来者。然后 Internet Explorer 不会触发`scroll`事件。而且我们的处理程序仍在运行（当用户第一次向右滚动时会向左滚动）。

我们必须`scrollLeft`手动解除绑定。这就是为什么在 150 毫秒之后无论如何处理程序都是无界的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T14:46:03.683

尝试

```
$(window).load(function(){
    $('body, html').scrollLeft(0);
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T17:49:38.590

尝试

```
$(document).ready(function(){
    $('body, html').scrollLeft(0);
}); 
```

# php - PHP 案例和 GET

> ID：13348501
> 
> 赞同：0
> 
> 时间：2012-11-12T17:31:16.197
> 
> 标签：php, sql, web

我正在尝试使用案例功能在我的网站上进行导航。

但是，当我尝试将它与 php 请求一起使用时，它给了我这个错误：

```
Warning: include(work.php?user=EEN0422) [function.include]: failed to open stream: Operation not permitted in E:\vhosts\example.com\httpdocs\vtlog\browse.php on line 16

Warning: include(work.php?user=EEN0422) [function.include]: failed to open stream: Operation not permitted in E:\vhosts\example.com\httpdocs\vtlog\browse.php on line 16

Warning: include() [function.include]: Failed opening 'work.php?user=EEN0422' for inclusion (include_path='.;./includes;./pear') in E:\vhosts\example.com\httpdocs\vtlog\browse.php on line 16 
```

browse.php 的脚本是：

```
<?php
$status = $_GET['status'];
$user = $_GET['user'];

switch ($status) {
    case "working":
        include("index2.php");
        break;
    case "log":
        include("admin.php");
        break;
    case "admin":
        include("settings.php");
        break;  
    case "users":
        include("work.php?user=$user");
        break;
}
?> 
```

对于 work.php，这是这里的问题：

```
<?php
session_start();

if(!$_SESSION['LoggedIn']) header("location: settingsauth.php");

$host="localhost";
$username="root";
$password="root";
$db_name="db";
$tbl_name="log";

$user=$_GET['user'];

mysql_connect("$host", "$username", "$password")or die("cannot connect");
mysql_select_db("$db_name")or die("cannot select DB");

$sql="SELECT *, (UNIX_TIMESTAMP(end) - UNIX_TIMESTAMP(start)) / 60.0 / 60.0 as hours_difference FROM $tbl_name WHERE user='$user'";
$result=mysql_query($sql);
if ($result === false) { echo "An error occurred."; }

?>
<table width="90%" border="0" align="center" cellpadding="3" cellspacing="1" bgcolor="#CCCCCC">
<tr>
<td width="15%" align="center" bgcolor="#E6E6E6"><strong>Start</strong></td>
<td width="15%" align="center" bgcolor="#E6E6E6"><strong>End</strong></td>
<td width="30%" align="center" bgcolor="#E6E6E6"><strong>Kommentar</strong></td>
<td width="15%" align="center" bgcolor="#E6E6E6"><strong>Tid</strong></td>
<td width="5%" align="center" bgcolor="E6E6E6"></td>
</tr>
<?php
while($rows=mysql_fetch_array($result)){
?>
<title>VTLog - <? echo $rows['user']; ?></title>
<tr>    
<td align="center" bgcolor="#FFFFFF"><? echo $rows['start']; ?></td>
<td align="center" bgcolor="#FFFFFF"><? echo $rows['end']; ?></td>
<td align="center" bgcolor="#FFFFFF"><? echo $rows['comment']; ?></td>
<td align="center" bgcolor="#FFFFFF"><?$var = number_format($rows['hours_difference'],2);
$var = number_format($var,1);
echo $var; ?></td>
<td align="center" bgcolor="#FFFFFF"><a href="editwork.php?editid=<? echo $rows['editid']; ?>"><img src="ret.jpg" alt="Ret"></a><form action="workstatus.php" method="get"><input type="hidden" name="editit" value="<? echo $rows['editid']; ?>" /><input type="submit" value="Slet" /></form></td>
</tr>

<?php
}
mysql_close();
?>
<tr>
<td align="left" bgcolor="#E6E6E6"><a href="settings.php">Tilbage til oversigt</a></td><td colspan="2" align="center" bgcolor="#E6E6E6">Total arbejdstid: <?php $var = number_format($rows['hours_difference'],2);
$var = number_format($var,1);
echo $var;?></td><td bgcolor="#E6E6E6" colspan="2"></td>
</tr>
</table> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T17:33:21.227

您不包括 Web URL 路径之类的 PHP 文件。

```
// Wrong
include("work.php?user=$user"); 
```

而是这样做：

```
include("work.php");
// Which now has access to the current variables including $user 
```

每当您`include()/require()`创建一个新的 PHP 文件时 - 就好像代码被插入到 include 语句所在的位置一样。这个新文件对变量具有相同的访问权限。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T17:35:15.050

include() 包含 php 代码，然后在当前上下文中执行...就好像该文件是它所包含的文件的一部分一样，您无法传递参数

```
include('file.php') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-12T17:33:32.240

您不能将查询字符串传入`include()`或`require()`

错误的：`include("work.php?user=$user");`

正确的做法是，`include("work.php");`

并且`$user`仍然可以访问`work.php`

# c# - 用于进程间通信的 wcf 实现

> ID：13348504
> 
> 赞同：3
> 
> 时间：2012-11-12T17:31:24.480
> 
> 标签：c#, .net, wcf, service, wcf-binding

我开发了一个 .NET UI 和 windows 服务，它们使用 WCF 通过 NetNamedPipeBinding 协议相互通信。我选择 NetNamedPipe 是因为它是在同一台机器上进行进程间通信的最佳且高效的选择。

但是，应用程序的关键要求之一是 UI 应该能够向 Windows 服务发送操作，反之亦然。这意味着 windows 服务应该能够回调 .NET UI 应用程序，而无需 .NET UI 应用程序首先连接到 windows 服务。

牢记这一点，我在 windows 服务中托管了一个 WCF 服务，在 .NET UI 应用程序中托管了一个单独的 WCF 服务，这样它们就可以异步通信，而无需保持通信通道始终处于活动状态。

我想知道这是否具有良好的设计意义。

我会很感激你的评论。

提前致谢。

副部

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T18:01:27.663

在客户端中托管另一个 WCF 服务以接收来自主 WCF 服务的调用不是一个好主意。您需要使用 WCF 双工通信（如 Subbu 发布的那样），也就是 WCF 回调。

[WCF：双工操作和 UI 线程](http://www.codeproject.com/Articles/17704/WCF-Duplex-Operations-and-UI-Threads)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T17:40:35.973

这种方法的问题是您的服务需要作为主机连接到客户端。

更好的选择可能是在您首次启动客户端时设置 WCF 回调。然后，服务可以使用回调为客户端通知提供服务。有关详细信息，请参阅[此 MSDN 文章](http://msdn.microsoft.com/en-us/magazine/cc163537.aspx#S2)，该文章显示使用 WCF 回调。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-07-06T12:39:07.403

**WCF 回调**允许服务器将事件驱动到客户端。在此处查看一个简短的示例：[一个简单的 WCF 回调示例](https://adamprescott.net/2012/08/15/a-simple-wcf-service-callback-example/)

# ruby - 在 RMagick 中创建具有两种颜色的标题

> ID：13348509
> 
> 赞同：3
> 
> 时间：2012-11-12T17:31:41.323
> 
> 标签：ruby, imagemagick, rmagick

我需要使用两种颜色为图片创建标题，所有单词都是黑色的，除了一个是其他颜色的......

我一直在阅读 RMagick 的文档我找不到这样做的方法......我现在用来创建文本的是：

```
txt_name = Draw.new
image.annotate(txt_name, 0,0,0,0, "This RED has to be in red") do
    self.gravity = Magick::NorthGravity
    self.pointsize = 20
    self.fill = '#000000'
    txt_name.font_weight = 100
    self.font_family = 'Arial'
end 
```

任何的想法？？或者读一些东西，这样我就可以完成这项工作？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-12T19:13:36.313

像下面这样的东西应该适合你。（请注意，这只是为了向您展示过程；我不建议将这样的代码投入生产。这是乞求放在自己的类中**编辑：见下文**）：

```
draw               = Magick::Draw.new 
```

设置绘图对象上的所有文本属性：

```
draw.pointsize     = 20
draw.fill          = '#000000'
draw.gravity       = Magick::NorthGravity
draw.font_weight   = 100
draw.font_family   = "Arial"
draw.font_style    = Magick::NormalStyle 
```

获取您的图像对象（这只是一个新的空白图像）：

```
image              = Magick::Image.new(300,200) 
```

设置字符串并使用[get_type_metrics](http://www.imagemagick.org/RMagick/doc/draw.html#get_type_metrics)测量它们：

```
black_text         = "This "
red_text           = "RED"
remainder          = " has to be in red"
black_text_metrics = draw.get_type_metrics(black_text)
red_text_metrics   = draw.get_type_metrics(red_text)
remainder_metrics  = draw.get_type_metrics(remainder) 
```

用黑色文本注释：

```
draw.annotate(image, 
              black_text_metrics.width, 
              black_text_metrics.height,
              10,10,black_text) 
```

将颜色更改为红色并添加红色文本：

```
draw.fill = "#ff0000"
draw.annotate(image,
              red_text_metrics.width,
              red_text_metrics.height,
              10 + black_text_metrics.width, # x value set to the initial offset plus the width of the black text
              10, red_text) 
```

将颜色改回黑色并添加文本的其余部分：

```
draw.fill = "#000000"
draw.annotate(image,
              remainder_metrics.width,
              remainder_metrics.height,
              10 + black_text_metrics.width + red_text_metrics.width,
              10, remainder) 
```

**编辑：**这可能会让您了解如何更好地构建它：

```
TextFragment = Struct.new(:string, :color)

class Annotator
  attr_reader :text_fragments
  attr_accessor :current_color

  def initialize(color = nil)
    @current_color  = color || "#000000"
    @text_fragments = []
  end

  def add_string(string, color = nil)
    text_fragments << TextFragment.new(string, color || current_color)
  end
end

class Magick::Draw
  def annotate_multiple(image, annotator, x, y)
    annotator.text_fragments.each do |fragment|
      metrics   = get_type_metrics(fragment.string)
      self.fill = fragment.color
      annotate(image, metrics.width, metrics.height, x, y, fragment.string)
      x += metrics.width
    end
  end
end 
```

和一个用法示例：

```
image            = Magick::Image.new(300,200)
draw             = Magic::Draw.new
draw.pointsize   = 24
draw.font_family = "Arial"
draw.gravity     = Magick::NorthGravity
annotator        = Annotator.new #using the default color (black)

annotator.add_string "Hello "
annotator.add_string "World", "#ff0000"
annotator.add_string "!"

draw.annotate_multiple(image, annotator, 10, 10) 
```

# c++ - 如何在没有 sprof 的情况下分析动态链接库？

> ID：13348512
> 
> 赞同：1
> 
> 时间：2012-11-12T17:31:51.907
> 
> 标签：c++, profiling, dynamic-linking, shared-libraries, sprof

我在分析动态库时遇到[了一些麻烦](https://stackoverflow.com/questions/13334688/segfault-with-sprof-good-without)，而且我似乎找不到任何使用过 sprof 的人。

有人知道可以为动态链接库提供调用图的替代工具吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T02:52:12.230

答案是使用 valgrind 和[KCachegrind](http://kcachegrind.sourceforge.net/html/Home.html)

# asp.net-mvc - 我可以在 web 表单中使用 mvc 过滤器属性吗？

> ID：13348513
> 
> 赞同：0
> 
> 时间：2012-11-12T17:31:53.497
> 
> 标签：asp.net-mvc, aop, webforms, cross-cutting-concerns

我想用属性ala MVC 处理AOP aka 横切关注点。
我是否必须使用 AOP 框架或类似 Ninject 的具有拦截插件的东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T04:52:41.800

是的，需要框架。我发现如果您的域模型相互引用，则拦截将与 ninject、unity、autofac、structuremap 一起使用。如果您的域模型仅引用接口类库，那么只有结构映射对我有用。

# opengl - 在opengl中绘制弧线

> ID：13348514
> 
> 赞同：-5
> 
> 时间：2012-11-12T17:31:58.287
> 
> 标签：opengl

我需要一个在opengl中绘制弧线的函数。我还需要一个示例代码来使用它。

我可以用线条画一个圆，我也想用线条画圆弧。这是我绘制圆圈的函数：

```
void DrawCircle(float cx, float cy, float r, int num_segments) 
{ 
    glBegin(GL_LINE_STRIP); 
    for(int ii = 0; ii < num_segments; ii++) 
    { 
        float theta = 2.0f * 3.1415926f * float(ii) / float(num_segments);//get the current angle 

        float x = r * cosf(theta);//calculate the x component 
        float y = r * sinf(theta);//calculate the y component 

        glVertex2f(x + cx, y + cy);//output vertex 
    } 
    glEnd(); 
} 
```

我使用 LINE_STRIP for Concert 绘制弧线的代码，但没有奏效。有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T18:46:10.000

不一定是最好的方法，但如果你只是需要一些工作，你可以稍微修改你的圈码。`float arc_length`向函数签名添加参数。替换`2.0f * 3.1415926f`为`arc_length`。如果您需要在给定的偏移量处开始弧线，您可以添加另一个名为`float arc_start`. 然后在循环`arc_start`的`theta`每次迭代中添加`for`。

**根据萨曼的评论进行编辑：**

您真正想要的不是弧线，而是曲线的更一般表示。圆弧是*一种*曲线，但它是一种非常特殊的曲线——即具有恒定半径的曲线。听起来您想绘制任意曲线，可能具有不同的半径。如果是这样，那么我的建议是贝塞尔曲线。这是一个非常可靠的介绍：

[http://devmag.org.za/2011/04/05/bzier-curves-a-tutorial/](http://devmag.org.za/2011/04/05/bzier-curves-a-tutorial/)

请注意教程后面关于绘制它们的部分，作者说“最简单的方法是使用 t 的小增量来计算连续点。” 为了在 OpenGL 中绘制贝塞尔曲线，这几乎是您必须做的。选择 的值`t`，并在 for 循环中递增它，就像您`theta`在原始循环代码中所做的那样。对于每次迭代，画一个点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T12:39:41.370

根据您绘制圆圈的方式，您有不同的解决方案。目前，您正在做的是将它们`2*pi`分成多个`n`部分并将它们连接在一起。嗯，想到的第一个解决方案是改变弧的范围。

例如，要只制作 arc `3*PI/4`，您可以简单地更改您的

```
float theta = 2.0f * PI * float(ii) / float(num_segments); 
```

至

```
float theta = 3.0f * PI / 4.0f * float(ii) / float(num_segments); 
```

或者更一般地说，如果你认为整个圆对应`1`，没有对应的`0`，你可以做一个圆的`s`倍圆的弧（例如 3/8），那么你可以简单地写：

```
float theta = 2.0f * PI * s * float(ii) / float(num_segments); 
```

请注意，您可能不希望弧从角度 0 开始。因此，您可以添加一个常数，这也是该公式的起始角度：

```
float theta = 2.0f * PI * s * float(ii) / float(num_segments) + start; 
```

* * *

另一种解决方案是不计算弧内的角度，而是获得开始和结束角度以及步长。然后你有：

```
for (theta = start; theta < end; theta += step) 
```

并确保最后`GL_LINE_STRIP`你做一个对应的`glVertex2f`角度来正确完成弧线。`theta``end`

* * *

从您的评论到其他答案，您实际上似乎正在寻找其他曲线，例如[贝塞尔曲线](http://en.wikipedia.org/wiki/B%C3%A9zier_curve)或[样条](http://en.wikipedia.org/wiki/Spline_%28mathematics%29)曲线或其他曲线。

# c# - 不同的验证消息和验证摘要消息

> ID：13348515
> 
> 赞同：1
> 
> 时间：2012-11-12T17:32:00.270
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-4

我想向用户显示不同的验证消息。一个在验证消息列表中，另一个在我的编辑框附近。让我们通过代码查看：
我的模型：

```
[StringLength(10, ErrorMessage = "{0} cannot be more than {1} characters.")]
string Name { get; set; } 
```

在视图中：

```
@* in form *@

@*
My long message is here:
"Name cannot be more than 10 characters."
*@
@Html.ValidationSummary(false)

@*
And my short validation message is here:
"*"
*@
@Html.TextBoxFor( m=> m.Name)
@Html.ValidationMessageFor(m => m.Name)
@*
But this validation message must be "*" instead of "Name cannot be more than 10 characters."
*@ 
```

我也用过`@Html.ValidationMessageFor(m => m.Name, "ShortMessage")`，但是没用。一旦页面加载，它就会显示“ShortMessage”。验证失败后不会。

如何实现这一点？我正在使用 MVC4。
任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T18:13:05.430

代替

```
@Html.ValidationMessageFor(m => m.Name) 
```

利用

```
@Html.ValidationMessage("Name", "*") 
```

这允许您直接在视图中指定消息，在本例中为星号。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-06-01T09:27:47.093

需要 site.css 的原因是验证摘要和验证消息被 CSS 隐藏/取消隐藏。打开site.css，你会看到以下内容：

```
/* styles for validation helpers */
.field-validation-error {
color: #e80c4d;
font-weight: bold;
}

.field-validation-valid {
display: none;
}

input.input-validation-error {
border: 1px solid #e80c4d;
}

input[type="checkbox"].input-validation-error {
border: 0 none;
}

.validation-summary-errors {
color: #e80c4d;
font-weight: bold;
font-size: 1.1em;
}

.validation-summary-valid {
display: none;
} 
```

如果您不使用 site.css（就像我所拥有的那样，继承一个项目），您将需要引入这些样式。

如果仍然失败，请在后端检查您的 ModelState。如果 IsValid 属性为 false，您将看到这些消息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T13:44:35.483

```
@Html.ValidationMessageFor(m => m.Name, "*") 
```

这在标题部分包含“Site.css”css 文件后有效。在使用验证之前，您必须确保“site.css”样式类。

# jquery - 如何从 node.js 服务器的 asp.net api restful webservice 获取数据？

> ID：13348517
> 
> 赞同：1
> 
> 时间：2012-11-12T17:31:59.597
> 
> 标签：jquery, asp.net, ajax, node.js, rest

我尝试从我的 node.js 服务器从我的 asp.net restful webservice 获取数据，但我不知道该怎么做。我尝试了一些方法（使用 jquery，但出现了一些错误，我不知道为什么）。从 asp.net restful 获取数据的 url 是这样的：“http://localhost:20034/api/Homepage/friendlist?id=1”

希望可以有人帮帮我。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T18:11:25.247

不确定您在使用 jQuery 时遇到的错误。您需要提供更多详细信息。

不过一般来说，如果你想使用 node.js 发出 HTTP 请求，你可以使用 http.get() 函数。

例如（来自官方 node.js 文档）：

```
var http = require('http');
http.get("http://www.google.com/index.html", function(res) {
  console.log("Got response: " + res.statusCode);
}).on('error', function(e) {
  console.log("Got error: " + e.message);
}); 
```

如果你想在一个单独的函数中使用它，你可以调用它并提供一个回调。由于 http.get() 调用的异步特性，这一点很重要。这是一个例子：

```
var http = require('http');

var callService = function(url, callback) {
    http.get(url, function(res) {
        return callback(null, res);
    }).on('error', function(err) {
        return callback(err);
    });
}

callService("http://www.google.com/index.html", function(err, res){
    if (err) console.log("Got error: " + err.message);
    else console.log("Final result:" + res);
}); 
```

# c# - 获取 C# 字符串的 NON FIRST 段的快速而巧妙的方法

> ID：13348519
> 
> 赞同：19
> 
> 时间：2012-11-12T17:32:10.093
> 
> 标签：c#, string, split

我做`split(' ')`了一个字符串，我想拉出返回字符串的第一个元素以获取字符串的其余部分。

铁`"THIS IS AN AMAZING STRING".split(' ');`

我想得到所有的话，但这个。这是：是一个惊人的字符串

该字符串将始终在第一个和第二个单词之间至少有一个空格，因为我会将其硬编码

有没有一个功能可以做到这一点？谢谢你

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-11-12T17:34:43.163

尝试

```
string X = "THIS IS AN AMAZING STRING";
string Y = (X.IndexOf ( " " ) < 0) ? string.Empty : X.Substring (X.IndexOf ( " " )  + 1); // Y = IS AN AMAZING STRING 
```

根据评论（`X`保证 IF 是一个至少有一个空格的有效字符串）一个更简单的版本，无需检查等：

```
string Y = X.Substring (X.IndexOf ( " " )  + 1); 
```

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2012-11-12T17:37:44.613

一个相当不错的选择是使用：

```
string original = "THIS IS AN AMAZING STRING";
string[] split = original.Split(new []{' '}, 2);
string result = split[1]; 
```

请注意，如果您只想要结果字符串，您可以缩短它：

```
var result = original.Split(new []{' '}, 2)[1]; 
```

通过使用最大拆分数的[string.Split](http://msdn.microsoft.com/en-us/library/c1bs0eda.aspx)的重载，您可以避免加入的需要以及额外的开销。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2012-11-12T17:35:23.207

不要使用该`Split`功能 - a) 它会查找存在的每个`' '`符号，而不仅仅是第一个。b）这种方法将涉及在内存中复制大量数据，这对于字符串来说是相当慢的操作。

```
var a = "THIS IS AN AMAZING STRING";
string result;
var index = a.IndexOf(' ');
if (index == -1)
    result = null;
else
    result = a.Substring(index + 1); 
```

由于问题的标题提到了数组，而不是字符串，因此值得一提的是[`ArraySegment`](http://msdn.microsoft.com/en-us/library/9cc4bx8k.aspx)类 - 这使您能够创建指向数组的一部分的指针（无需创建新数组和复制数据）：

```
var a = new int[] { 0, 1, 2, 3 };
var segment = new ArraySegment<int>(a, 1, a.Length - 1); 
```

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2012-11-12T17:33:59.373

```
var a = "THIS IS AN AMAZING STRING".Split(' ');
string amazing = String.Join(" ", a.Skip(1)); 
```

如果您使用的是 .NET 4 之前的版本，则需要在 Skip 调用的末尾添加一个 .ToArray() - 因为在 .NET 4 中首先添加了将可枚举作为第二个参数的 String.Join 重载。

虽然这在一般情况下效果很好，但如果您总是想删除第一个单词，有一种更好的方法可以做到这一点，正如 Reed 在评论中指出的那样：

```
var a = "THIS IS AN AMAZING STRING".Split(new char[] {' ' }, 2);
string amazing = a[1];  //Perhaps do a length check first if you are not sure there is a space in the original string. 
```

这对于较大的字符串表现得更好，因为 Split 只需要查找直到找到第一个空格，然后就可以只使用两个字符串创建结果 - 它避免了 String.Join 也可能很昂贵，尤其是对于较长的字符串。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-11-13T07:18:57.640

很简单，你可以这样做：

```
string input = "THIS IS AN AMAZING STRING";
string result = input.Substring(input.IndexOf(' ') + 1); 
```

这将适用于您指定的输入类型（字符串中的前两个单词之间总是有空格），但是对于输入字符串根本没有空格的情况，它会将整个字符串返回为 -是。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-12T17:36:32.093

尝试这个

```
 string str = "THIS IS AN AMAZING STRING";
  string firstString = str.Split(' ')[0];  //get the first string
  string newStr = str.Replace(firstString + " ", "");  //remove the first string

  //OR

  string newStr = str.Remove(0, firstString.Length + 1); 
```

# objective-c - EXC_BAD_ACCESS 在启用 ARC 的情况下实现 NSOutlineViewDataSource

> ID：13348524
> 
> 赞同：3
> 
> 时间：2012-11-12T17:32:35.380
> 
> 标签：objective-c, memory-management, automatic-ref-counting, exc-bad-access, nsoutlineview

我正在实现一个简单的文件浏览器（在 an 中`NSOutlineView`），并且`EXC_BAD_ACCESS`在扩展我的根节点时遇到了 an 。我`NSOutlineViewDataSource`返回的孩子如下：

```
- (id)outlineView:(NSOutlineView *)outlineView child:(NSInteger)index ofItem:(id)item {
    if (!item) {
        // Root node
        return @"Files";
    }
    NSFileManager *manager = [NSFileManager defaultManager];

    NSError *error = nil;
    return [[manager contentsOfDirectoryAtPath:@"/" error:&error] objectAtIndex:index];
} 
```

从这个方法返回的`NSString`正在被自动释放，当 AppKit 代码在这里调用时：

```
- (NSView *)outlineView:(NSOutlineView *)outlineView viewForTableColumn:(NSTableColumn *)tableColumn item:(id)item {
    NSString *identifier = [item isEqualToString:@"Files"] ? @"HeaderCell" : @"DataCell";
    NSTableCellView *cell = [outlineView makeViewWithIdentifier:identifier owner:self];
    cell.textField.stringValue = item;
    return cell;
} 
```

`item`已经没了。这是项目生命周期的 Instruments 屏幕截图：

![仪器截图](../Images/7f9133a0168d85fd34c7691fb489aed5.png)

我不确定我做错了什么 - 我不能明确地做`retain`任何事情（我也不应该！）因为 ARC 已启用，但子项仍然丢失。

**编辑：**实际崩溃的堆栈跟踪：

```
 0 CoreFoundation -[__NSCFString retain]
   1 Spark -[SPFileBrowserController outlineView:child:ofItem:] /Users/Craig/projects/Spark/Spark/SPFileBrowserController.m:29
   2 AppKit loadItemEntryLazyInfoIfNecessary
   3 AppKit -[NSOutlineView _rowEntryForChild:ofParent:requiredRowEntryLoadMask:]
   4 AppKit -[NSOutlineView _expandItemEntryChildren:atStartLevel:expandChildren:andInvalidate:]
   5 AppKit -[NSOutlineView _expandItemEntry:expandChildren:startLevel:]
   6 AppKit -[NSOutlineView _batchExpandItemsWithItemEntries:expandChildren:]
   7 AppKit -[NSOutlineView expandItem:expandChildren:]
   8 AppKit -[NSOutlineView _doUserExpandOrCollapseOfItem:isExpand:optionKeyWasDown:]
   9 AppKit -[NSOutlineView _outlineControlClicked:]
  10 AppKit -[NSApplication sendAction:to:from:]
  11 AppKit -[NSControl sendAction:to:]
  12 AppKit -[NSCell _sendActionFrom:]
  13 AppKit -[NSCell trackMouse:inRect:ofView:untilMouseUp:]
  14 AppKit -[NSButtonCell trackMouse:inRect:ofView:untilMouseUp:]
  15 AppKit -[NSControl mouseDown:]
  16 AppKit -[NSWindow sendEvent:]
  17 AppKit -[NSApplication sendEvent:]
  18 AppKit -[NSApplication run]
  19 AppKit NSApplicationMain
  20 libdyld.dylib start 
```

**编辑 2：**项目现已附加。编辑 的返回值`SPFileUtil` `childrenOfFolder:`以使用选项 2 以一致地重现。使用单个时它总是通过，但在使用内容`NSString`时总是失败。`NSFileManager`

[https://www.dropbox.com/s/lqj5r5ndg0qusak/Spark.zip](https://www.dropbox.com/s/lqj5r5ndg0qusak/Spark.zip)

在展开根“文件”项后立即发生崩溃。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T17:37:58.887

直接从文件系统提供大纲视图内容可能有点不安全，例如，如果从文件系统中添加/删除文件会发生什么？更好的方法是让您缓存文件系统内容并直接从中提供内容。然后，您可以确定从以下位置返回的值：

```
– numberOfRowsInTableView: 
```

匹配您存储的内容（并且在请求不再存在的行时不会出现越界异常）。

要真正花哨，您可以*观察*文件系统并刷新缓存，然后在对其进行更改时刷新大纲视图。

更新：除此之外，作为缓存的一部分，您通常使用如下数据结构在大纲视图中构建节点树：

```
@interface OutlineNode : NSObject
{
    id _item;
    OutlineNode * __weak _parentNode;
    NSMutableArray *_childNodes;
} 
```

并且您可以在 OutlineView 中设置特定的节点，例如：

```
- (BOOL)outlineView:(NSOutlineView *)outlineView
   isItemExpandable:(id)item
{
    if (item == nil)
        return YES;

    OutlineNode *node = (OutlineNode *)item;
    return node.parentNode == nil;
} 
```

# symfony - Symfony 2 - 在控制器之外设置 Flash 消息

> ID：13348534
> 
> 赞同：16
> 
> 时间：2012-11-12T17:33:15.180
> 
> 标签：symfony

我有一个注销侦听器，我想在其中设置一条显示注销确认消息的闪存消息。

```
namespace Acme\MyBundle\Security\Listeners;

use Symfony\Component\Security\Http\Logout\LogoutSuccessHandlerInterface;
use Symfony\Component\Security\Core\SecurityContext;
use Symfony\Component\HttpFoundation\Response;
use Symfony\Component\HttpFoundation\Request;
use Symfony\Component\HttpFoundation\RedirectResponse;

class LogoutListener implements LogoutSuccessHandlerInterface
{
  private $security;  

  public function __construct(SecurityContext $security)
  {
    $this->security = $security;
  }

  public function onLogoutSuccess(Request $request)
  {
    $request->get('session')->getFlashBag()->add('notice', 'You have been successfully been logged out.');

    $response = new RedirectResponse('login');
    return $response;
  }
} 
```

这是我的 services.yml（与此相关）：

```
logout_listener:
   class:  ACME\MyBundle\Security\Listeners\LogoutListener
   arguments: [@security.context] 
```

这会产生错误：

```
Fatal error: Call to a member function getFlashBag() on a non-object 
```

如何在这种情况下设置 flashBag 消息？

另外，如何访问路由器，以便生成 url（通过 $this->router->generate('login')）而不是传入硬编码的 url？

**分辨率说明**

要让 flash 工作，您必须告诉您的 security.yml 配置不要在注销时使会话无效；否则，会话将被破坏，您的闪存将永远不会出现。

```
logout:
    path: /logout
        success_handler: logout_listener
        invalidate_session: false 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-11-12T17:35:32.657

您应该将会话和路由器的服务注入 LogoutListener 并使用它们来执行这些任务。这是在 yml 中执行此操作的方法：

```
logout_listener: 
class: ACME\MyBundle\Security\Listeners\LogoutListener 
arguments: [@security.context, @router, @session] 
```

然后在你的课上你写：

```
class LogoutListener implements LogoutSuccessHandlerInterface
{
    private $security;
    private $router;
    private $session;

    public function __construct(SecurityContext $security, Router $router, Session $session)
    {
        $this->security = $security;
        $this->router = $router;
        $this->session = $session;
    }
    [...] 
```

当你现在想使用会话时，你可以说：

```
$this->session->getFlashBag()->add('notice', 'You have been successfully been logged out.'); 
```

并且以同样的方式，您可以使用路由器服务来生成路由。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T18:00:45.327

您可以通过服务容器获取 Session 对象（以及任何其他服务）：

```
$session = $ServiceContainer->get('session');
$session->setFlash('notice', 'Message'); 
```

您可以通过不同方式访问服务容器的方式：

*   从控制器或任何容器感知类：只需使用 $this->get('session');
*   从服务：您必须像 Aldo 所说的那样注入服务容器对象

# html - 可以一个在 HTML 中做一些没有 javascript 的事情？

> ID：13348541
> 
> 赞同：12
> 
> 时间：2012-11-12T17:33:46.007
> 
> 标签：html, button

我有一个带有按钮的网页。目前我正在将此按钮绑定到一个 javascript 处理程序，该处理程序使页面在单击时重定向到给定的 URL。

HTML：

```
<button class="click-me">Clike me to navigate</button> 
```

JS：

```
$('.click-me').on('click', function() { window.location = '/myloc'; }); 
```

我现在正在尝试构建此页面的后备（无 JavaScript）版本。我希望这个按钮做同样的工作，但不使用 javascript。换句话说，即使浏览器的javascript被禁用，我也试图使这个按钮起作用。

我知道这可以通过表单来实现（如下图）。但我正在寻找任何更清洁的实现。

```
<form name="hack" action="/myloc">
  <button type="submit" class="click-me">Click me to navigate</button>
</form> 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-11-12T17:37:38.757

使用一个`a`元素，这就是它们的*用途*：

```
<a class="click-me" href="/path/to/whatever/page">Click me to navigate</a> 
```

然后简单地将其*样式*化为`button`.

例如，使用以下 CSS：

```
.clickMe {
    -moz-appearance: button;
    -ms-appearance: button;
    -o-appearance: button;
    -webkit-appearance: button;
    appearance: button;
    text-decoration: none;
    color: #000;
    padding: 0.2em 0.4em;
}​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/znfDb/)。

（显然，这假定使用支持`appearance`（或供应商前缀版本）CSS 属性的浏览器。）

参考：

*   [`appearance`（尽管它是`-moz-`带有前缀的 MDN 文档）](https://developer.mozilla.org/en-US/docs/CSS/-moz-appearance)。
*   [`appearance`财产，在 W3C](http://www.w3.org/TR/2004/CR-css3-ui-20040511/#appearance)。
*   [不幸地放弃了 CSS3 特性（在 W3C）](http://wiki.csswg.org/spec/css4-ui#dropped-css3-features)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-12T18:38:10.910

要回答标题中提出的问题，是的，[`button`元素](http://www.w3.org/TR/REC-html40/interact/forms.html#edef-BUTTON)可以在没有 JavaScript 的情况下“做事”。使用`type=submit`，它会提交一个表单，如问题末尾的示例所示。使用`type=reset`，它会清除表单中的所有用户输入。它只是`type=button`（当元素在任何形式之外时的默认值）依赖于 JavaScript，并且在没有脚本的情况下不做任何事情。

回答你应该问的问题：使用链接，卢克。如果你愿意的话，你可以设置一个链接看起来很像一个按钮的样式（在类似应用程序的上下文中可能有意义），即使只使用 CSS 2.1 加上可选的 CSS3 增强功能，如圆角。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-08-16T14:58:20.523

`<a>`您可以通过在其前面添加标签来简单地添加按钮单击的实现（如果它引用任何网页） 。例如：

```
<a href="https://www.youtube.com/">
    <button>Youtube</button>
</a> 
```

据我所知，这不需要任何 JavaScript。

# ruby-on-rails - 导轨插入模型和关联

> ID：13348557
> 
> 赞同：0
> 
> 时间：2012-11-12T17:34:45.077
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有一张主桌和一张 bezirk 桌。

当我将数据插入主表时，我也想在我的 bezirk 表中插入数据。我在 bezirk 中创建的条目应该有主表的 id。

主要型号：

```
class Main < ActiveRecord::Base
   attr_accessible :category, :latlon
   has_one :bezirk
   accepts_nested_attributes_for :bezirk
end 
```

贝济克型号：

```
class Bezirk < ActiveRecord::Base
  attr_accessible :beznr, :coordinates, :district_code, :id, :name
  belongs_to :main
end 
```

这就是我尝试这样做的方式...

```
 main = Main.new(:category => "Bezirk", :latlon => 'POINT(1,2)')
    main.save
    bezirk = main.bezirks.new(:name => 'test', :beznr => 2, :district_code => 1160, :coordinates => 'POINT(1,2)')
    bezirk.save 
```

那么......我怎么能插入到bezirk，相应的主ID！？这样我就可以在两个条目之间建立关联...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T18:00:27.700

你可以使用这个：

```
# create main
main = Main.create(:category => "Bezirk", :latlon => 'POINT(1,2)')

# create bezirk belongs to main, so bezirk will have main_id, is id of main
bezirk = main.create_bezirk(:name => 'test', :beznr => 2, :district_code => 1160, :coordinates => 'POINT(1,2)') 
```

# php - 在 while 循环中按列显示表数据

> ID：13348559
> 
> 赞同：2
> 
> 时间：2012-11-12T17:34:48.823
> 
> 标签：php, css, while-loop

我正在尝试从数据库中检索所有这些数据，将其放入一个表中（如有必要，可以使用多个表），并按列显示它们，分成 4 个，分成多个页面。

我想知道如何让表格水平显示，例如

表头 表头 表头
表 数据 表 数据 表
数据 表 数据 表 数据

而不是：

表头
表数据
表数据

表头
表数据等

这是到目前为止的代码：

```
// While loop that will display the results in groups of 4
while($row=sqlsrv_fetch_array($result, SQLSRV_FETCH_ASSOC))
{ $newDate = $row['datenow']->format('d/m/Y'); ?>

<table id="syncresults">
<thead>
    <tr>
        <th scope="col" id="dateheader"> <?php echo $newDate ?></th>
    </tr>
</thead>

<tbody>
    <tr>
        <td><?php echo $row['nbsactive']; ?></td>
    </tr>
    <tr>
        <td><?php echo $row['nbsmanysynced']; ?></td>
    </tr>
    <tr>
        <td><?php echo $row['nbsthreedays']; ?></td>
    </tr>
</tbody> 
```

任何有关如何执行此操作或为我指明正确方向的建议将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T17:38:54.103

在表内使用表。

```
// php fetch data
while($row=sqlsrv_fetch_array($result, SQLSRV_FETCH_ASSOC))
{
    echo'<table>
    <tr><td><table> place data here</table></td></tr>

    <tr><td><table>or here </table></td></tr>

    <tr><td><table>or here, depending on what the data is</table></td></tr>

    </table>';
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T17:57:16.593

将您的代码替换为：

```
 <table>
    <?php
$i=0;
    while($row=sqlsrv_fetch_array($result, SQLSRV_FETCH_ASSOC))
    { $newDate = $row['datenow']->format('d/m/Y'); ?>

    $j=$i%3;
      ?>
      <?php
    if($j==0)
    {
      echo"<tr>";
    }
      ?>
    <td>
    <table id="syncresults">
    <thead>
        <tr>
            <th scope="col" id="dateheader"> <?php echo $newDate ?></th>
        </tr>
    </thead>

    <tbody>
        <tr>
            <td><?php echo $row['nbsactive']; ?></td>
        </tr>
        <tr>
            <td><?php echo $row['nbsmanysynced']; ?></td>
        </tr>
        <tr>
            <td><?php echo $row['nbsthreedays']; ?></td>
        </tr>
    </tbody></table>
    </td>
    <?php
    if($j==2)
    {
      echo"</tr><tr><td colspan='3'>&nbsp;</td></tr>";
    }
    $i++;
    }
    ?>
    </table> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T18:41:31.040

这里没有足够的信息来说明您是否应该使用表格，因为您提供了非数据。

如果我们正在编写一个壁橱组织应用程序，我们的数据可能会像这样从数据库中出来：

```
John | Shoes | 3
John | Pants | 10
Sally | Shoes | 12
Sally | Pants | 8
Billy | Shoes | 4
Billy | Pants | 9
Kate | Shoes | 6
Kate | Pants | 6 
```

但我们想像这样显示它：

```
Member | Shoes | Pants
John | 3 | 10
Sally | 12 | 8
Billy | 4 | 9
Kate | 6 | 6 
```

我们会像这样编写我们的循环：

```
<table>
<tr>
<?
$last = null;
while ($row = sqlsrv_fetch_array($result, SQLSRV_FETCH_ASSOC)) {
    if ($last != $row['member']) {
        if ($last) { // $last is null on our first pass through the loop, so don't print the tr's
?>
</tr>

<tr>
<?
        }
?>
    <td><?=$row['member']?></td>
<?
        $last = $row['member'];
    }
?>
    <td><?=$row['quantity']?></td>
<?
}
?>
</tr>
</table> 
```

标头？好吧，通常我会建议循环两次并重置指针，但我没有看到您正在使用的接口的等价物`mysql_data_seek`或`pg_result_seek`，所以我无法为您提供任何帮助。在结果的第一“行”上使用输出缓冲以及将所有标题作为数组收集的收集器变量可以在无需重置指针的情况下工作。

如果您只是想在 4 列中显示结果，因为您认为它看起来更漂亮，而不是因为它表示表格数据，那么使用 CSS 列将是更好的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-20T08:39:57.897

```
$th1="<tr>";
$td1="<tr>";
$td2="<tr>";
$td3="<tr>";

while($row=sqlsrv_fetch_array($result, SQLSRV_FETCH_ASSOC)) { 

    $newDate = $row['datenow']->format('d/m/Y');

    $th1.="<th scope='col' id='dateheader'>".$newDate."</th>";
    $td1.="<td>".$row['nbsactive']."</td>";
    $td2.="<td>".$row['nbsmanysynced']."</td>";
    $td3.="<td>".$row['nbsthreedays']."</td>";

}

$th1.="</tr>";
$td1.="</tr>";
$td2.="</tr>";
$td3.="</tr>";

$result="<table id='syncresults'>".$th1.$td1.$td2.$td3."</table>"; 
```

# ruby-on-rails - Rails ActiveResource 检测到 HTTP 206 响应代码

> ID：13348561
> 
> 赞同：3
> 
> 时间：2012-11-12T17:34:49.843
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, http, activeresource

如何检测活动资源`find()`调用返回 HTTP 206 而不是典型的 HTTP 200？

我知道 ActiveResource 会为 HTTP 3xx-5xx 响应代码引发各种异常，但是您如何确定您收到了哪些 200 级响应代码？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-12T19:07:34.363

请参阅[活动资源响应，如何获取它们](https://stackoverflow.com/questions/5972429/active-resource-responses-how-to-get-them)以了解如何获取线程的最后响应。然后，您可以根据需要测试响应代码：

```
class MyConn < ActiveResource::Connection
  def handle_response(resp)
    # Store in thread (thanks fivell for the tip).
    # Use a symbol to avoid generating multiple string instances.
    Thread.current[:active_resource_connection_last_response] = resp
    super
  end
  # this is only a convenience method. You can access this directly from the current thread.
  def last_resp
    Thread.current[:active_resource_connection_last_response]
  end
end

class MyResource < ActiveResource::Base
  class << self
    attr_writer :connection
  end
end

myconn = MyConn.new MyResource.connection.site
MyResource.connection = myconn  # replace with our enhanced version
object = MyResource.find(id)
response_code = MyResource.last_resp.code 
```

# sql - 日期列上的 Int 列上的索引

> ID：13348562
> 
> 赞同：0
> 
> 时间：2012-11-12T17:34:50.030
> 
> 标签：sql, sql-server, performance, sql-server-2008

## 背景

*   微软 SQL Server 2008 R2
*   每天有约 10 万条记录的表
*   大多数查询此表的查询按所述列过滤

## 问题

因此，为了给数据库增加一点性能改进，一个选项是在日期列上添加索引，但不是将日期存储为**`date`**类型，而是**`integer`**使用以下格式将其存储为：

```
ddMMyyyy
**Edit: Changed the format to yyyyMMdd after looking at comments** 
```

## 问题

1.  你认为这是个好主意吗？
2.  你会通过这样做获得任何改进吗？
3.  有什么可能的缺点吗？

我们仍处于设计阶段，因此如果我们愿意，我们仍有时间进行更改。

我们希望有很多查询通过此列进行过滤，但是 IMO 这不会带来任何性能改进，如果有一个 Date 列而不指定其中的时间也是一样的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T19:10:27.100

如果您试图提高表的性能，那么添加一个额外的列是一种可疑的开始方式。

首先，如果表已经有一个日期列，那么就使用它。日期是 4 字节，因此它与整数大小相同。更重要的是，它为您提供了数据库中内置的各种日期功能——获取月份名称、按日期排序、计算日期之间的天数等等。

建立索引是提高性能的一种方法。我还建议您考虑对表进行分区。您可能不需要按天拆分表，但按月拆分会产生合理大小的分区（大约 300 万行）。

In fact, if the querying is all on recent data, then I might suggest that you create a history table, which can be queried at leasure. Then keep the most recent data in "current" table. You can have a process that runs every day to remove the oldest day of data from the current data and to put the rows in the history table.

In any case, as the comments suggest, the format `ddMmyyyy` is an unreasonable format. It works for equality, but not for `between` or `order by`.

# android - Android列表添加问题

> ID：13348564
> 
> 赞同：1
> 
> 时间：2012-11-12T17:34:56.480
> 
> 标签：android, list

我正在尝试开发的应用程序有问题。这是一款安卓的音乐游戏，我从 iTunes 获取所有数据。

这是我获取数据的部分。我有 2 个列表：

1.  列出canzoni：大小5，字段：previewUrl、artistName、trackName、artistViewUrl 和artworkUrl100。
2.  List dieciCanzoni：大小为 10，必须包含上述列表的 10 个元素。

这是填充列表的代码：

```
try
    {       
        int randomLookupId;
        JSONObject obj = getJSONObject(url);                            
        JSONArray jsonArray = obj.getJSONArray("resultIds");            

        for(int i = 0; i < 10; i++)
        {
            canzoni.clear();

            randomLookupId = new Random().nextInt(jsonArray.length());  

            JSONObject finalObj = getJSONObject("http://itunes.apple.com/lookup?id="+jsonArray.getString(randomLookupId)); 
            JSONArray finalJsonArray = finalObj.getJSONArray("results");    

            JSONObject returnObj = finalJsonArray.getJSONObject(0);

            canzoni.add(returnObj.getString("previewUrl"));
            canzoni.add(returnObj.getString("artistName"));
            canzoni.add(returnObj.getString("trackName"));
            canzoni.add(returnObj.getString("artistViewUrl"));
            canzoni.add(returnObj.getString("artworkUrl100"));

            Canzone.dieciCanzoni.add(i, canzoni);

        }
    }   
    catch (JSONException ignored)
    {
        ignored.getCause();
    }
    catch (MalformedURLException e) 
    {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    catch (IOException e) 
    {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } 
```

信息的检索效果很好，我只有一个问题：当我清除列表canzoni时，我注意到列表dieciCanzoni也被清除了，显然我不想那样！

如果我评论清除canzoni列表的行，在dieciCanzoni列表中只插入canzoni中的最后一个值，即使之前插入的值也会改变！

你能帮我弄清楚吗？

谢谢你们！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T17:42:43.507

您需要使用深拷贝：

```
Canzone.dieciCanzoni.add(i, canzoni.clone()); 
```

或者：

```
Canzone.dieciCanzoni.add(i, newArrayList<String>(canzoni)); 
```

所发生的`Canzone.dieciCanzoni.add(i, canzoni);`只是指向存储信息的*同一位置。*当您清除任一列表时，您正在清除它们两个的*一个位置*。“深拷贝”复制数据，因此每个列表都有自己的副本。

* * *

更好的是，不要使用`clear()`. `canzoni`只需从一开始就创建一个新列表。代替：

```
canzoni.clear(); 
```

和：

```
canzoni = new ArrayList<String>(); 
```

# jpa - 比较 JPA 中集合的相等性

> ID：13348566
> 
> 赞同：0
> 
> 时间：2012-11-12T17:35:00.790
> 
> 标签：jpa, jpql

首先，我将展示这个问题的背景......

我试图对存储库进行快速且无冗余的实现。有问题的对象如下所示：

```
class SomeObject {
    @Id
    private Long id;
    private List<SomeData>;
    private List<SomeOtherData>;

    ....
} 
```

SomeData 和 SomeOtherData 是实体，它们通常由 JPA 映射。后来我使 SomeObject 实例不可变，这可以进一步优化。SomeObject 变得可互换，我不想在 db 中重复。为了找到可能的重复项，我需要比较这些列表。

出现了主要问题：如何检查 SomeData 中 SomeData 集合的相等性 SomeObject （顺序没有意义）与 SomeData 的一些任意集合（作为参数提供）？

我已经尝试通过结合 JPA SIZEOF 和几十个 MEMBER BY 来确保两个集合相等的解决方法。它有效，但性能绝对可怕。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T15:21:52.400

在你的两个类中使用 HashSet 和实现 hashcode/equals 可能会解决你的问题，你也可以使用 @PrePersist 方法来确保你一致地应用过滤器。如果您需要更复杂的过滤，可以查看 org.apache.commons.collections.CollectionUtils。如果重复是不可接受的，则假定您还在数据库中使用唯一约束。

# asp.net-mvc - 在 IIS7 上部署 ASP.NET Web API 时出错

> ID：13348568
> 
> 赞同：2
> 
> 时间：2012-11-12T17:35:08.617
> 
> 标签：asp.net-mvc, iis, asp.net-mvc-4, asp.net-web-api

我开发了 ASP.NET Web API 应用程序，当我在 Visual Studio 2010 下运行它时它运行良好。它运行起来非常完美。但是当我将它（xcopy）部署到 Web 服务器时，它会崩溃并且无法运行：

![你调用的对象是空的。 System.Web.HttpApplication.ExecuteStep。 System.Web.Http.Dispatcher.HttpRoutingDispatcher.SendAsync](../Images/8df6d0ea0e2a291cbeca2418b0dbcff3.png)

到目前为止，我已经尝试过：使用 IIS (aspnet_regiis.exe -i) 为 x32 和 x64 版本的 .NET 重新注册 ASP.NET 使用 VS 2010 Build deployment package 命令部署应用程序，然后将此包导出到 IIS。

有什么想法吗？

PS 其他 ASP.NET 4.0 应用程序（不是 MVC/Web API）在同一台服务器上运行良好。

更新：我的 web.config 的一部分（不包括连接字符串和应用程序设置）

```
<system.web>
<customErrors mode="Off"/>
<compilation debug="true" targetFramework="4.0" />
<authentication mode="None" />
<pages>
  <namespaces>
    <add namespace="System.Web.Helpers" />
    <add namespace="System.Web.Mvc" />
    <add namespace="System.Web.Mvc.Ajax" />
    <add namespace="System.Web.Mvc.Html" />
    <add namespace="System.Web.Optimization" />
    <add namespace="System.Web.Routing" />
    <add namespace="System.Web.WebPages" />
  </namespaces>
</pages>
<profile defaultProvider="DefaultProfileProvider">
  <providers>
    <add name="DefaultProfileProvider" type="System.Web.Providers.DefaultProfileProvider, System.Web.Providers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" connectionStringName="DefaultConnection" applicationName="/" />
  </providers>
</profile>
<membership defaultProvider="DefaultMembershipProvider">
  <providers>
    <add name="DefaultMembershipProvider" type="System.Web.Providers.DefaultMembershipProvider, System.Web.Providers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" connectionStringName="DefaultConnection" enablePasswordRetrieval="false" enablePasswordReset="true" requiresQuestionAndAnswer="false" requiresUniqueEmail="false" maxInvalidPasswordAttempts="5" minRequiredPasswordLength="6" minRequiredNonalphanumericCharacters="0" passwordAttemptWindow="10" applicationName="/" />
  </providers>
</membership>
<roleManager defaultProvider="DefaultRoleProvider">
  <providers>
    <add name="DefaultRoleProvider" type="System.Web.Providers.DefaultRoleProvider, System.Web.Providers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" connectionStringName="DefaultConnection" applicationName="/" />
  </providers>
</roleManager>
<sessionState mode="InProc" customProvider="DefaultSessionProvider">
  <providers>
    <add name="DefaultSessionProvider" type="System.Web.Providers.DefaultSessionStateProvider, System.Web.Providers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" connectionStringName="DefaultConnection" />
  </providers>
</sessionState> </system.web>  

  <system.webServer>
<validation validateIntegratedModeConfiguration="false" />
<modules runAllManagedModulesForAllRequests="true" />
<handlers>
  <remove name="ExtensionlessUrlHandler-ISAPI-4.0_32bit" />
  <remove name="ExtensionlessUrlHandler-ISAPI-4.0_64bit" />
  <remove name="ExtensionlessUrlHandler-Integrated-4.0" />
  <add name="ExtensionlessUrlHandler-ISAPI-4.0_32bit" path="*." verb="GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS" modules="IsapiModule" scriptProcessor="%windir%\Microsoft.NET\Framework\v4.0.30319\aspnet_isapi.dll" preCondition="classicMode,runtimeVersionv4.0,bitness32" responseBufferLimit="0" />
  <add name="ExtensionlessUrlHandler-ISAPI-4.0_64bit" path="*." verb="GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS" modules="IsapiModule" scriptProcessor="%windir%\Microsoft.NET\Framework64\v4.0.30319\aspnet_isapi.dll" preCondition="classicMode,runtimeVersionv4.0,bitness64" responseBufferLimit="0" />
  <add name="ExtensionlessUrlHandler-Integrated-4.0" path="*." verb="GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS" type="System.Web.Handlers.TransferRequestHandler" preCondition="integratedMode,runtimeVersionv4.0" />
</handlers>  </system.webServer>

<runtime>
<assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
  <dependentAssembly>
    <assemblyIdentity name="System.Web.Helpers" publicKeyToken="31bf3856ad364e35" />
    <bindingRedirect oldVersion="1.0.0.0-2.0.0.0" newVersion="2.0.0.0" />
  </dependentAssembly>
  <dependentAssembly>
    <assemblyIdentity name="System.Web.Mvc" publicKeyToken="31bf3856ad364e35" />
    <bindingRedirect oldVersion="1.0.0.0-4.0.0.0" newVersion="4.0.0.0" />
  </dependentAssembly>
  <dependentAssembly>
    <assemblyIdentity name="System.Web.WebPages" publicKeyToken="31bf3856ad364e35" />
    <bindingRedirect oldVersion="1.0.0.0-2.0.0.0" newVersion="2.0.0.0" />
  </dependentAssembly>
</assemblyBinding>  </runtime>  

<entityFramework>
<defaultConnectionFactory type="System.Data.Entity.Infrastructure.SqlConnectionFactory, EntityFramework" />  </entityFramework> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T14:38:23.613

我 90% 确定这里的问题与您的自定义消息处理程序有关。我相信这是一个错误，但团队坚持认为这不是。不知道他们将如何处理它。这是演习：

如果您在任何消息处理程序中从头开始创建响应，则默认情况下它显然不带有该`RequestMessage`属性。*因此，它以著名的“对象引用未设置为对象的实例”而*惨遭失败。一使用就报错。例如，设置`RequestMessage`属性的打击代码`HttpResponseMessage`解决了问题，但我认为这应该由框架完成：

```
public class TerminatingMessageHandler : DelegatingHandler {

    protected override Task<HttpResponseMessage> SendAsync(
        HttpRequestMessage request, 
        CancellationToken cancellationToken) {

        var response = new HttpResponseMessage(HttpStatusCode.OK);
        response.RequestMessage = request;
        return Task.FromResult(response).ContinueWith(task => {

            var responseMsg = task.Result;

            var httpContext = responseMsg.RequestMessage.Properties["MS_HttpContext"] as HttpContextWrapper;
            if (httpContext != null)
                httpContext.Response.Headers.Remove("Server");

            return responseMsg;
        });
    }
} 
```

这是错误报告：[http](http://aspnetwebstack.codeplex.com/workitem/408) ://aspnetwebstack.codeplex.com/workitem/408如果您是这种情况，如果您也希望修复此问题，您可以投票并在此处发表评论。

# java - 比较两个非常大的列表（不适合内存）的最佳方法是什么？

> ID：13348571
> 
> 赞同：1
> 
> 时间：2012-11-12T17:35:19.577
> 
> 标签：java

我有一个程序，它从列表中获取每个项目并将其与另一个列表中的所有其他项目进行比较。到目前为止它工作正常，但数据越来越大并且将超过系统内存。

我想知道比较两个非常大的列表（每个列表可能 5-10 GB）的最佳方法是什么？

这是我正在做的一个非常简单的示例（除了列表很大并且for循环中的值实际上正在被处理/比较）。

```
import java.util.Collection;
import java.util.HashSet;
import java.util.Arrays;

public class comparelists {
    public static void main( String  [] args ) {
        String[] listOne = {"a","b",
                "c","d",
                "e","f",
                "g","h",
                "i","j",
                "k","l"};

        String[] listTwo = {"one",
                "two",
                "three",
                "four",
                "five","six","seven"};

        for(int listOneItem=0; listOneItem<listOne.length; listOneItem++){
            for (int listTwoItem=0; listTwoItem<listTwo.length; listTwoItem++) {
                System.out.println(listOne[listOneItem] + " " + listTwo[listTwoItem]);
            }
        }

    }
} 
```

我意识到这里必须有一些磁盘 IO，因为它不适合内存，我最初的方法是将两个列表保存为文件并从 listOne 保存一堆行，然后流式传输 listTwo 的整个文件，然后获取更多行从 listOne 等等。有没有更好的办法？或者像我在上面做的那样访问列表的Java方式，但它会根据需要交换到磁盘？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T18:07:29.590

您可以将大数据放在平面文件中，然后一次从文件中流式传输一项数据。这样，在任何给定时间只有两项数据在内存中。

显然这不会赢得任何效率奖，但这里有一个简单的例子，它使用的数据文件在文本文件中每行包含一个项目：

```
BufferedReader readerA = new BufferedReader(new FileReader("listA.txt"));
String lineA;
while ((lineA = readerA.readLine()) != null)
{
    BufferedReader readerB = new BufferedReader(new FileReader("listB.txt"));
    String lineB;
    while ((lineB = readerB.readLine()) != null)
    {
        compare(lineA, lineB);
    }
    // TODO: ensure .close() is called on readerB
}
// TODO: ensure .close() is called on readerA 
```

如果您正在处理的数据太复杂而无法在文本文件中轻松地每行存储一个项目，您可以使用 ObjectInputStream 和 ObjectOutputStream 执行类似的操作，它可以一次读取一个 Java 对象并将其写入文件。

如果您可以设法将 listB 放入内存中，那么显然您会在第一个循环中节省相当多的磁盘访问。如果您有足够的重复数据，记忆化可能会帮助您将 listB 放入内存中。

此外，项目比较是一个教科书示例，一个可以通过使用并行化加速的问题。例如，将数据比较工作交给工作线程，以便文件读取线程可以专注于最大化磁盘的吞吐量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T17:39:03.387

使用享元模式。这是一个链接：

[http://en.wikipedia.org/wiki/Flyweight_pattern](http://en.wikipedia.org/wiki/Flyweight_pattern)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T18:04:58.613

我可以看到您的目标是在2 个非常大的列表的[笛卡尔积上执行某些操作。](http://en.wikipedia.org/wiki/Cartesian_product)

而且我假设您担心的效率低下是将列表从文件读取到主内存的时间。

如何将列表分成可以加载到内存中的块。Say`l1[0]`是其中的前 1000 个项目的列表，`l1`并且`l1[1]`是接下来的 1000 个项目的列表。

然后你想比较：

```
l1[0] with l2[0]
l1[0] with l2[1]
l1[0] with l2[2]
...
l1[0] with l2[0]
l1[1] with l2[1]
l1[2] with l2[2]
... 
```

以更少的文件读取来实现相同的总体效果。

# database - 数据库命名约定决策点列表

> ID：13348578
> 
> 赞同：0
> 
> 时间：2012-11-12T17:35:49.357
> 
> 标签：database, naming-conventions

我正在寻找或创建一个强大的数据库命名约定决策点列表。我将从一个列表开始，并要求人们提出有用的建议。对于这个练习，我不关心表明对任何特定约定的偏好，只是为了创建一个任何组织都可以用来设置其标准的列表。

没有特别的顺序，但编号以供参考：

1.  对象名称使用匈牙利语（前缀或后缀）（“tibbling”）
2.  表的多元化
3.  缩写和标准缩写（“abrvtng”）
4.  使用或避免[转义]
5.  指示词边界（pascal、camel、_等）
6.  资本化方案
7.  键名
8.  关联/连接/多对多表名

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T18:15:47.760

数据库对象命名没有通用形式的约定，但在我的情况下，因为我在标准化框架上工作，所以我使用了这样的东西：

1.  后缀（PROCEDURE->SP, FUNCTION->FN, TRIGGER -> TRG, ETC. ），因为你可以很容易地看到相关的元素。
2.  表名复数；字段名称单数
3.  通常，您有一本包含名称和缩写的字典。
4.  未完结
5.  下划线（_），因为许多数据库不区分大小写。
6.  大写
7.  主键列应该是 ID 。
8.  如果你有一个表名为 ORDERS 的所有订单和一个项目表，那么你的“订单详细信息”表应该被称为 ORDERS_ITEMS

# html - 由于其中一个 div 内的图像元素，无法在两个 div 之间创建相等的间隙

> ID：13348585
> 
> 赞同：0
> 
> 时间：2012-11-12T17:36:15.603
> 
> 标签：html, position, positioning

看这张图可能会让事情变得清楚..

**[小提琴](http://jsfiddle.net/sushanth009/w9vad/)**

![在此处输入图像描述](../Images/89d7f45fb21c3f331b9e213bac4bf40b.png)

![在此处输入图像描述](../Images/1f21b11290719b0e0e57313dddcfe6e0.png)

主容器是一个 div，其中还有 5 个 div，每个 div 都保存一些数据。

如果该数据的计数为 0，则只显示文本。如果计数大于 0 ，则显示计数和图像嵌套在跨度内，并且图像和数字是可点击的...

第二张图片是显示 div 内的文本是如何呈现的。

由于第 3 和第 5 div 中的**图像** ，div 之间的差距不一致。即使将图像设置为`position:relative`and `position:absolute`，设置 left 和 top 属性似乎也没有影响..

有人可以在这种情况下帮助我吗..

**HTML**

```
<div id="prop">
   <div id="lvl1" class="alrt">
      Missing reads within 1 week : <span data-tr="1">0</span>
   </div>
   <div id="lvl2" class="alrt">
      Latest reads 1 Week or older : <span data-tr="2">0</span>
   </div>
   <div id="lvl3" class="alrt">
      Occupied Zero Consumption : <span data-tr="3"><a>39 <img src="../icon1.png" title="" /></a></span>
   </div>
   <div id="lvl4" class="alrt">
      Negative Consumption : <span data-tr="4">0</span>
   </div>
   <div id="lvl5" class="alrt">
      Vacant Consumption: <span data-tr="5"><a>5 <img src="../icon2.png" title="" /></a></span>
   </div>
   <div class="msg">
      *all alerts are based on yesterdays reads
   </div>
</div> 
```

**CSS**

```
#prop
{
    height:55%;
    padding-top:10px;
    border:solid 2px #B2CD48;
    border-radius:10px;
    margin:10px 0 10px 15px;
}

#prop > .alrt 
{
    width:80%;
    float:right;
    height:12%;
    font-weight:700;
    font-size:1em;
    color:#42456B;
    padding:3px;
}

.alrt a 
{
    cursor:pointer;
    position:relative;
}

.alrt > span > a > img 
{
    width:20px;
    height:20px;
    position:relative;
    top:3px;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T17:53:39.243

尝试将其用于 .alrt > span > a > img

```
.alrt > span > a > img
{
    width: 20px;
    height: 20px;
    position: absolute;
    top: -3px;
} 
```

# python - 如何使用 weakref 或 contextlib 关闭打开的文件？

> ID：13348588
> 
> 赞同：2
> 
> 时间：2012-11-12T17:36:30.397
> 
> 标签：python

我有一个对打开文件有强引用的类。如果代码运行时没有任何异常，则文件将正确关闭，因为我在关闭文件的类上显式调用了一个方法。但是，如果随后引发异常，则文件不会正确关闭。

这是我的代码的模拟版本：

```
class MyFile(object):
    def __init__(self, filename, mode):
        self._handle = open(filename, mode)

    @classmethod
    def open(cls, filename, mode):
        return MyFile(filename, mode)

    def close(self):
        self._handle.close()

    def __del__(self):
        self.close()

    def writerow(data):
        # Special write
        pass

    def __enter__(self):
        return self

    def __exit__(self, *exc_info):
        self.close() 
```

现在，如果我在代码的顶层使用这个类，我将使用 with 语句：

```
def get_some_dat():
    return 1

with MyFile.open('foo.txt', 'w') as f:
    # do stuff with f
    data = get_some_data()
    f.writerow(data) 
```

但是，MyFile 是由另一个对象间接打开的。我知道大多数 Pythonistas 会说我应该明确关闭文件，但我想确保在对象被销毁时关闭文件。我编写的代码可以解决问题，但我想知道是否有人对实现此行为的更好方法提出建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T17:57:22.247

这是一个`weakref`用于确保文件已关闭的示例，即使它是在不使用`with ...`语法的情况下打开的：

```
import weakref

class FileHandler:
    def __init__(self, dbf, caller = None):
        if caller is not None:
            self._ref = weakref.ref(caller, self.close)
        self.thefile = open(dbf, 'rb')
    def __enter__(self):
        return self
    def __exit__(self, ext_type, exc_value, traceback):
        self.close()
    def close(self, *args):
        print('closing file')
        self.thefile.close()

class Foo:
    def __init__(self):
        self.fh = FileHandler('/tmp/testfile', caller = self)

def autoclosing_file():
    foo = Foo()

def demo_callback():
    with open('/tmp/testfile', 'w'): pass
    autoclosing_file()

if __name__ == '__main__':
    demo_callback() 
```

印刷

```
closing file 
```

PS：我怀疑这段代码不是我的，但我已经失去了它来自哪里的任何参考。如果有人知道，请告诉我，以便我可以给出适当的归属。

# java - 有没有办法确保将线程分配给一组指定的对象？

> ID：13348592
> 
> 赞同：10
> 
> 时间：2012-11-12T17:36:43.433
> 
> 标签：java, multithreading, threadpool

我们正在开发一个应用程序，其中一组对象可以通过接收来自 3 个不同来源的消息而受到影响。每条消息（来自任何来源）都有一个对象作为其目标。每个消息接收器都将在自己的线程上运行。

我们希望消息的处理（接收后）尽可能高速，因此针对目标对象的消息处理将由线程池中的另一个线程完成。消息的处理将比阅读/接收来自发送者的消息花费更长的时间。

我认为如果池中的每个线程仅专用于一组特定的对象，它会更快，例如：

```
Thread1 -> objects named A-L
Thread2 -> objects named M-Z 
```

每组对象（或线程）都有一个专用的待处理消息队列。

我的假设是，如果唯一需要的线程同步是在每个接收线程和一个处理线程之间，在需要将消息放入阻塞队列的持续时间内，它会比随机分配工作线程来处理更快消息（在这种情况下，可能有 2 个不同的线程为同一对象提供消息）。

我的问题实际上是两部分：

1.  人们是否同意将工作线程专用于一组特定对象是一种更好/更快的方法的假设？

2.  假设这是一种更好的方法，现有的 Java ThreadPool 类是否有办法支持这一点？还是需要我们编写自己的 ThreadPool 实现？

感谢您提供的任何建议。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-12T18:36:51.510

> [是否] 将工作线程专用于一组特定的对象是一种更好/更快的方法吗？

我假设总体目标是尝试最大化这些入站消息的并发处理。您有来自 3 个来源的接收器，它们需要将消息放入将得到最佳处理的池中。因为来自 3 个源中的任何一个的消息可能会处理*无法*同时处理的相同目标对象，所以您希望以某种方式划分消息以便可以同时处理它们，但前提是它们保证不会引用相同的目标对象。

我将`hashCode()`在您的目标对象（可能只是`name.hashCode()`）上实现该方法，然后使用该值将对象放入一个`BlockingQueue`s 数组中，每个对象都有一个使用它们的线程。使用数组`Executors.newSingleThreadExecutor()`就可以了。通过队列数修改哈希值模式并将其放入该队列中。您需要将处理器的数量预先定义为最大值。取决于处理的 CPU 密集程度。

所以类似下面的代码应该可以工作：

```
 private static final int NUM_PROCESSING_QUEUES = 6;
 ...
 ExecutorService[] pools = new ExecutorService[NUM_PROCESSING_QUEUES];
 for (int i = 0; i < pools.length; i++) {
    pools[i] = Executors.newSingleThreadExecutor();
 }
 ...
 // receiver loop:
 while (true) {
    Message message = receiveMessage();
    int hash = Math.abs(message.hashCode());
    // put each message in the appropriate pool based on its hash
    // this assumes message is runnable
    pools[hash % pools.length].submit(message);
 } 
```

这种机制的好处之一是您可以限制有关目标对象的同步。你*知道*同一个目标对象只会被一个线程更新。

> 人们是否同意将工作线程专用于一组特定对象是一种更好/更快的方法的假设？

是的。这似乎是获得最佳并发性的正确方法。

> 假设这是一种更好的方法，现有的 Java ThreadPool 类是否有办法支持这一点？还是需要我们编写自己的 ThreadPool 实现？

我不知道有任何线程池可以做到这一点。但是，我*不会*编写您自己的实现。只需像上面的代码大纲一样使用它们。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-12T18:23:12.403

一般来说，这样的方法是一个坏主意。它属于“[不要及早优化](http://c2.com/cgi/wiki?PrematureOptimization)”的口头禅。

此外，如果实施你的想法可能会*损害*你的表现，而不是帮助它。一个无法正常工作的简单示例是，如果您突然在一种类型上收到大量请求 - 另一个工作线程将处于空闲状态。

最好的方法是使用标准的生产者-消费者模式，并通过在各种负载下进行系统测试来调整消费者线程的数量——最好是通过输入真实交易的记录。

这些情况的“转到”框架是[`java.util.concurrent`](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/package-summary.html)包中的类。我建议使用一个[`BlockingQueue`](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/BlockingQueue.html)（可能是一个[`ArrayBlockingQueue`](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ArrayBlockingQueue.html)）和一个[`ExecutorService`](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ExecutorService.html)从[`Executors`](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/Executors.html)工厂方法之一创建的，可能是[`newCachedThreadPool()`](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/Executors.html#newCachedThreadPool%28%29).

一旦您实施并进行了系统测试，如果您发现已证实的性能问题，请分析您的系统，找到瓶颈并修复它。

你不应该及早优化的原因是大多数时候问题不在你期望的地方

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T17:41:33.583

作为替代方法：我建议为此使用现有框架，例如[RabbitMQ](http://www.rabbitmq.com/)或[ActiveMQ](http://activemq.apache.org/)。尝试发明自己的消息传递框架可能是一个挑战。如果您尝试使用自己的框架增加价值，那是一回事。如果您只需要一个来实现您的目标，那就是另一个。这些框架提出了许多优化消息传递的选项，值得考虑。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-12T18:03:58.757

我的回答是：

*   1 - 是
*   2 -
    *   a) 没有
    *   b) 你不需要

一些解释：

*   您希望一项任务根据某种算法将消息分发到不同的队列，
*   您希望每个消息队列有一个任务从其分配的队列中提取消息并处理它们。

我不认为这些前提与线程池的目的相矛盾，线程池只是将任务与线程相关联。但是在这个模型中，线程池只会将线程与任务关联一次，然后线程将继续运行以轮询其输入消息队列。

线程的摩擦点应该是中间消息队列，可能还有与这些消息处理相关的其他资源。根据您的解释，我想您计划通过巧妙地将消息处理划分为任务来将第二种类型减少到最低限度。每个队列只能由与队列关联的分区任务和处理任务访问，因此它应该是最小的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-12T19:18:54.833

您应该能够为 ThreadPoolExecutor 提供一个特殊的 BlockingQueue。队列会记住哪个线程正在处理哪种类型的消息，以便它可以保留所有相同类型的消息。

```
MyQueue

    ownership relation of thread - msgType 

    take/poll()

        if current thread owns msg type X
            if there is a message of type X
                return that message
            else
                give up ownership

        // current thread does not own any message type
        if there is a messsage of type Y, Y is not owned by any thread
            current thread owns Y
            return that message

        // there's no message belonging to an unowned type
        wait then retry 
```

# php - 仅缓存最新版本的 javascript 文件

> ID：13348594
> 
> 赞同：1
> 
> 时间：2012-11-12T17:36:48.973
> 
> 标签：php, javascript, svn, caching, browser-cache

我在浏览器缓存 javascript 文件时遇到问题，即使我使用

```
FileETag MTime Size 
```

在htaccess中查看修改时间和大小，看是否为最新版本。我目前包括这样的javascript文件：

```
<script src="/code.js" type="text/javascript"></script> 
```

我尝试将 SVN 修订信息添加到文件调用中，如下所示：

```
<script src="/code.js?svn=123" type="text/javascript"></script> 
```

但我找不到一个防弹的方法来做到这一点，因为我无法通过文件名获得修订（任何建议），即使我添加了修订，Smarty 正在预编译和缓存 HTML。

所以我考虑过对模板不使用缓存块，但我还没有尝试过这种方法。由于文件只编译一次，会有什么不同吗？

所以基本上我只是在收集关于如何强制浏览器只缓存文件的最新版本的想法。理想的解决方案是通过实际工作的 htaccess，而不是像 FileETag，因为这样，您总是必须按 CTRL+F5 才能获得最新版本。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T17:42:52.913

在文件路径中添加缓存破坏器是最好的方法。您可以通过`?`像这里一样的方法来完成它，或者将它添加到文件的路径中，例如：`/static/123/code.js`

之后，您在 10 年后添加一个 expires 标头，您就可以开始了。所以你的问题是如何在 url 中生成数字。也许您可以更改部署脚本以在进行部署时替换该数字，这样您就不需要关心版本号

另一个想法是计算 js 文件的 md5 哈希并在路径中使用它。

# javascript - 尝试使用 jquery ui 自动完成来完成一些简单的事情

> ID：13348596
> 
> 赞同：1
> 
> 时间：2012-11-12T17:37:06.317
> 
> 标签：javascript, jquery, autocomplete, jquery-autocomplete

我想将用户输入的值使用到受自动完成小部件影响的输入中，希望以下内容对我想要实现的目标不言自明：

```
source: $(this).val() 
```

我认为`$(this).val()`这行不通，因为 source 需要一个对象？

我是 JavaScript 新手，谢谢。

```
$(".myinput").autocomplete({
    source:$(this).val()
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T18:23:46.037

我认为您`source`错误地使用了 jQuery UI 自动完成的参数。 `$(this).val()`将从 DOM 对象中获取当前值`$(this)`（假设这就是它所指向的）。

相反，该`source`参数应该指向输入可能完成的来源。[作为jQuery UI 网站](http://jqueryui.com/autocomplete/)的示例

```
$(function() {
    var availableTags = ["ActionScript", "AppleScript", "Asp", "BASIC",
        "C", "C++", "Clojure", "COBOL", "ColdFusion", "Erlang"];
    $( "#tags" ).autocomplete({
        source: availableTags
    });
}); 
```

从这个例子中你可以看到，`source`指向一个可能的标签值数组，当用户开始输入时，这些值将自动完成。

**为了解决我对OP问题的新理解：**

要将用户的当前条目添加到自动完成中，您可以使用如下代码：

```
$( "#tags" ).autocomplete("option","source",
    availableTags.concat($("#tags").val())); 
```

每次输入更改时都需要调用它（使用`keypress`事件可能对此有所帮助。）

# jquery - $.getJSON 获取状态

> ID：13348597
> 
> 赞同：8
> 
> 时间：2012-11-12T17:37:09.630
> 
> 标签：jquery, http-status-code-404, getjson

执行跨域查询，如果运行的URL不可用（404），如何执行某个功能？我尝试这样的事情：

```
$.getJSON({
url:'example.php?callback=?',
statusCode: {
404:function(){alert('404');}
},
success :function(data){//do stuff}
}); 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-05-02T15:31:18.243

我发现这种方法可以解决我遇到的类似问题，我想以不同的方式处理特定的状态代码。例如下面的“404”代码。

```
$.getJSON(AJAX_URL, function(data) {
    //On Success do something.

}).fail(function(jqXHR) {
    if (jqXHR.status == 404) {
        alert("404 Not Found");
    } else {
        alert("Other non-handled error type");
    }
}); 
```

有3个参数传递给fail方法：

```
jqXHR.fail(function(jqXHR, textStatus, errorThrown) {}); 
```

> 错误回调选项的替代构造， .fail() 方法替换了已弃用的 .error() 方法。有关实现细节，请参阅 deferred.fail()。

对于 jQuery 文档，请参阅：[http :](http://api.jquery.com/deferred.fail/)
[//api.jquery.com/jQuery.ajax/#jqXHR http://api.jquery.com/deferred.fail/](http://api.jquery.com/jQuery.ajax/#jqXHR)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T17:45:26.897

```
 $.getJSON({
       url:'example.php?callback=?'       
    },
      success :function(data){//do stuff}
    })
    .error(function(e, x) { if (x.status == 404) alert('404 - page was not available'); }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T17:40:13.803

获取 JSONP 请求的状态码本质上是不可能的。

您可以向`$.ajax`调用添加一般错误处理程序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-12T17:47:08.003

[马特](https://stackoverflow.com/users/1048862/matt)在[这个问题](https://stackoverflow.com/questions/309953/how-do-i-catch-jquery-getjson-or-ajax-with-datatype-set-to-jsonp-error-w)中发布了一个很好的[答案](https://stackoverflow.com/a/11799589/1812984)，可以解决您的问题。

您必须`success`在 JSON 对象上添加一个属性

```
var success = false;

$.getJSON(url, function(json) {
    success = true;
    // ... do what you need to do here
});

// Set a 5-second (or however long you want) timeout to check for errors
setTimeout(function() {
    if (!success)
    {
        // Handle error accordingly
        alert("Yup, 404"); // string was "Houston, we have a problem."
    }
}, 5000); 
```

如果您没有预料到超时问题，KeYan 通过检查 XHR 状态属性提出了一个很好的建议。~~我会投票支持他的解决方案，但我缺乏代表点。~~

# java - 在摆动中单击按钮时获取复选框值

> ID：13348601
> 
> 赞同：-1
> 
> 时间：2012-11-12T17:37:34.123
> 
> 标签：java, swing, jbutton, jcheckbox

对于以下场景，我需要一个 Java 中的小代码：

> 按钮应该获取选定的复选框并在我的表单中执行这些复选框的代码。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-12T18:07:30.447

这是我为您制作的示例：

![在此处输入图像描述](../Images/95d74e724bba1a8433739c59b29b0c29.png)

![在此处输入图像描述](../Images/7c8196cd2acd1e5be6c4948d86fbc9cf.png)

```
import java.awt.BorderLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.JButton;
import javax.swing.JCheckBox;
import javax.swing.JFrame;
import javax.swing.JOptionPane;
import javax.swing.SwingUtilities;

public class TestJCheckBox {

    private JFrame frame;
    private JCheckBox jcb;
    private JButton button;

    public TestJCheckBox() {
        initComponents();
    }

    private void initComponents() {
        frame = new JFrame("Test");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setResizable(false);

        jcb = new JCheckBox("JCheckBox1");

        button = new JButton("Is JCheckBox selected?");
        button.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent ae) {
                if (jcb.isSelected()) {
                    JOptionPane.showMessageDialog(frame, "JCheckBox is selected");
                } else {
                    JOptionPane.showMessageDialog(frame, "JCheckBox is NOT selected");

                }
            }
        });

        frame.add(jcb, BorderLayout.CENTER);
        frame.add(button, BorderLayout.SOUTH);

        frame.pack();
        frame.setVisible(true);
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                new TestJCheckBox();
            }
        });
    }
} 
```

# php - 删除目录中的空（0 长度）文件

> ID：13348609
> 
> 赞同：0
> 
> 时间：2012-11-12T17:38:15.073
> 
> 标签：php

下面的 php 脚本会一一选择并详细说明特定目录中包含的所有 .txt 文件。首先，在脚本调用 read.php 之后，将一个文件复制到名为“copy”的子目录中，以便对文件进行分析和阐述。最后，可以从主目录中删除相同的文件。对文件夹中的所有文件执行此操作，直到它们结束。

问题：不幸的是，当找到 0 KB 文件（空）时脚本停止。可能问题是 read.php 但我无法修改它。所以我想自动删除这些不需要的空文件，以便该过程定期进行。

有什么建议吗？TNX

```
 <?php
 $files = glob( '*.txt' );
 array_multisort(
    array_map( 'filemtime', $files ),
    SORT_NUMERIC,
    SORT_ASC,
    $files
 );

 $filename="$files[0]";
 foreach($files as $filename) {

    copy($filename,"./copy/$filename"); 
    echo "<b> $filename </b>File copied<br>";   

    include ("read.php");

    sleep(4);

    unlink($filename);
    echo "$filename elaborated and deleted from the main folder.<br>";  
 }
 ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T17:40:59.623

使用`filesize()`- [http://php.net/manual/en/function.filesize.php](http://php.net/manual/en/function.filesize.php) - 确定文件的大小，并删除任何为零的内容。

```
$filename="$files[0]";
 foreach($files as $filename) {
    if (filesize($filename) > 0)
    {
        copy($filename,"./copy/$filename"); 
        echo "<b> $filename </b>File copied<br>";   

        include ("read.php");

        sleep(4);

        unlink($filename);
        echo "$filename elaborated and deleted from the main folder.<br>";  
    } else {
        unlink($filename);
        echo "$filename is empty and deleted.<br>";  
    }
 } 
```

# .net - 在 Visual Studio 2012 express 上通过 Nuget 的 NUnit.Runners 不起作用

> ID：13348613
> 
> 赞同：7
> 
> 时间：2012-11-12T17:38:31.693
> 
> 标签：.net, nunit, visual-studio-2012, nuget

我正在尝试使用 NuGet 管理器在 Visual Studio 2012 Express 中设置简单的 NUnit 项目。从 PROJECT-> Manage NuGet Packages 我安装了 NUnit（框架）并想要添加 NUnit.Runner 但在安装过程中我收到：

```
'NUnit.Runners 2.6.2' already installed. 
```

好的，但是当我转到 TOOLS->Library Package Manager->Manage nuGet Packages for Solution 时，NUnit（框架）和 NUnit.Runners 都显示为已安装。

我可以在代码中使用 NUnit 框架，但是当我尝试运行测试时，旧的“测试资源管理器”仍然存在并且不显示任何内容。也不调用测试。

我在 VS2012 或 NUnit 配置中遗漏了什么吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-14T13:31:46.670

我发现 Visual Studio Express 不支持项目扩展（微软禁止和禁用）。因此，如果没有一些变通方法，似乎没有选择使用 NUnit。到目前为止，我安装了完整版，并且 NUnit runner 按预期工作。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-28T17:21:48.147

您还可以使用此[博客文章](http://stewartr.blogspot.de/2006/09/debugging-nunit-in-visual-studio.html)评论中提到的方法 sombody ：

1.  在测试程序集中添加对 nunit-console-runner 的引用。

2.  在您的测试程序集中，使用以下一个衬垫创建一个类（*见下文*）

3.  打开测试程序集的属性。例如，右键单击程序集并选择属性。

    1.  在应用程序选项卡上，选择输出类型：Windows 应用程序；和启动对象：NUItConolseRunner（上面的文件）。

    2.  在 Debug 选项卡上，在 Command Line Arguments 中输入 .csproj 文件名；并浏览到工作目录中 .csproj 文件的文件夹。

4.  保存所有内容，设置断点并使用 F5 或绿色箭头按钮运行。

代码：

```
using System;
namespace MotorExampleTests
{     
    // Written by blokeley
   class NUnitConsoleRunner
   {

     [STAThread]
     static void Main(string[] args)
     {
         NUnit.ConsoleRunner.Runner.Main(args);
     }
   }
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-14T19:11:09.387

为什么不使用 VS2012 内置的 testrunner 并通过扩展管理器添加 nunit testadapter？

# c++ - 通过代码触发回调时抑制 GTK 信号

> ID：13348616
> 
> 赞同：4
> 
> 时间：2012-11-12T17:38:51.867
> 
> 标签：c++, callback, gtk, gtkmm

**要点**：

`handler_block`在具体情况下很有用，但我宁愿在程序开始时调用一些东西来抑制所有调用`gtk_entry_set_text`和 gtk_toggle_button_set_active 的信号。有办法吗？

* * *

**背景资料**：

我的程序用于通过具有以下属性的角色创建对话框制作实体：

名称 - 通过 GTKComboBoxes
动画从预先确定的列表中选择 - 也是一个 GTKComboBox
组 - 对实体进行分类的六个单选按钮之一

可以添加实体——从一个空白的添加对话框开始，填写所有字段，然后提交。
实体可以通过编辑对话框进行编辑，上面列出的所有字段最初都是用实体的当前属性填充的。编辑是即时的（编辑对话框上没有提交按钮），一旦选择了组合按钮或单选按钮中的新值，显示的实体就会出现不同。

我有一个连接到 Type 条目并由“更改”信号触发的回调。每当我在代码中手动设置条目文本以显示正在编辑的实体时，回调似乎都会触发：

```
gtk_entry_set_text(GTK_ENTRY(name_entry), entity.name); // name is a char*
gtk_toggle_button_set_active(GTK_TOGGLE_BUTTON (group_button_friendly), TRUE); 
```

是的，有一种方法`g_signal_handler_block`，但这需要

1）`gulong`首先连接信号时创建的。 `g_signal_connect(args);` 对比 `gulong entry_handler_id = g_signal_connect(args);`

2) 每次调用都使用阻止/解除阻止的习惯用法。
`g_signal_handler_block(args, entry_handler_id);`
`gtk_entry_set_text(args);`
`g_signal_handler_unblock(args, entry_handler_id);`
或更糟，
`g_signal_handler_block(args, entry_handler_id);`
`fn_that_calls_gtk_entry_set_text();`
`g_signal_handler_unblock(args, entry_handler_id);`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T23:35:42.290

我想你要找的是`g_signal_handlers_block_matched`. 如果您将掩码设置为仅`G_SIGNAL_MATCH_CLOSURE`使用信号中使用的闭包，它应该可以解决问题。

您必须查找`signal_id`正在发出的信号，但您应该只需要执行一次，因为所有小部件之间的信号 id 都是相同的，这就是调用中也需要实例的原因。

并解除阻止您要使用`g_signal_handlers_unblock_matched`的 .

# jquery - jQuery关于函数相对论

> ID：13348617
> 
> 赞同：0
> 
> 时间：2012-11-12T17:38:52.160
> 
> 标签：jquery, image, function, load, relationship

我有两个功能，仅当我单击某个元素时才起作用。例如：

```
$(".item-image").click(function() {

    $('#close-zoom').show();
    $('.item-image-box').attr('class', 'item-image-box-zoom');
    $('.item-image').attr('class', 'item-image-zoom');
    var main_img_src = document.getElementById('main_image_src').src;
    start_srt_index = main_img_src.lastIndexOf(".");
    main_img_src_ext = main_img_src.substring(start_srt_index, start_srt_index + 4);
    var new_main_img_src;
    if (main_img_src_ext == '.jpg') new_main_img_src = main_img_src.substring(start_srt_index, 0) + '.jpg';
    else if (main_img_src_ext == '.jpe') new_main_img_src = main_img_src.substring(start_srt_index, 0) + '.jpeg';
    else if (main_img_src_ext == '.png') new_main_img_src = main_img_src.substring(start_srt_index, 0) + '.png';
    $('#main_image_src').attr('id', 'draggable')

    $('#draggable').attr("src", new_main_img_src);

    $('#draggable').load(function() {

        if ($("#draggable").width() > 980 && $("#draggable").height() > 480) {
            var width_marg = ($("#draggable").width() - 980);
            var height_marg = ($("#draggable").height() - 480);
            $("#containment-wrapper").width($("#draggable").width() + width_marg);
            $("#containment-wrapper").height($("#draggable").height() + height_marg);
            $("#containment-wrapper").css('marginLeft', -width_marg);
            $("#containment-wrapper").css('marginTop', -height_marg);

            $("#draggable").draggable({
                containment: "#containment-wrapper",
                scroll: false
            });
        }
        else {
            var width_marg = ($("#draggable").width() - 980) / 2;
            var height_marg = ($("#draggable").height() - 480) / 2;
            $("#containment-wrapper").width($("#draggable").width());
            $("#containment-wrapper").height($("#draggable").height());
            $("#containment-wrapper").css('marginLeft', -width_marg);
            $("#containment-wrapper").css('marginTop', -height_marg);
        }
    });

    $('.item-previews-box').attr('class', 'item-big-previews-box');
    $('.preview').attr('class', 'preview-zoom');
    $('.item-big-description').attr('class', 'item-big-description item-big-description-zoom');

});​ 
```

这项工作将图像更改为更大的图像，我有第二个功能具有相反的作用，它加载正常大小的图像

```
$("#close-zoom").click(function() {
    $('#close-zoom').hide();
    $('.item-image-box-zoom').attr('class', 'item-image-box');
    $('.item-image-zoom').attr('class', 'item-image');
    var main_img_src = document.getElementById('draggable').src;
    start_srt_index = main_img_src.lastIndexOf(".");
    main_img_src_ext = main_img_src.substring(start_srt_index, start_srt_index + 4);
    var new_main_img_src;
    if (main_img_src_ext == '.jpg') new_main_img_src = main_img_src.substring(start_srt_index, 0) + '.jpg';
    else if (main_img_src_ext == '.jpe') new_main_img_src = main_img_src.substring(start_srt_index, 0) + '.jpeg';
    else if (main_img_src_ext == '.png') new_main_img_src = main_img_src.substring(start_srt_index, 0) + '.png';
    $('#draggable').attr('id', 'main_image_src')

    $('#main_image_src').attr("src", new_main_img_src);
    $("#containment-wrapper").css('marginLeft', 0);
    $("#containment-wrapper").css('marginTop', 0);

    $('.item-big-previews-box').attr('class', 'item-previews-box');
    $('.preview-zoom').attr('class', 'preview');
    $('.item-big-description-zoom').attr('class', 'item-big-description');

});​ 
```

此功能位于

```
$(document).ready(function(){
}); 
```

对我来说最大的问题是：为什么当我使用函数 close-zoom 时，位于第一个函数中的部分：

```
$('#draggable').load(function() {...}); 
```

正在执行，并在 id #containment-wrapper 中更改我的参数。我认为这个功能是独立的。我可能失去了一些重要的方面吗？我如何使这些功能彼此不相关（在当前情况下，功能 .item-image 与 .close-zoom 相关）。这是我的第一个复杂的（当然对我来说）基于 jQuery 的函数集。感谢关注。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T19:05:48.013

如果您想保留原始功能结构，请执行此操作..

代替

```
$('#draggable').load(function() {}); 
```

这样绑定加载函数

```
$('body').on('load', '#draggable', function() {}); 
```

然后作为第二个函数的第一行，像这样取消绑定 .on('load') 函数..

```
$('body').off('load', '#draggable'); 
```

最终，这将在您的两个主要功能之间切换 .on('load') 功能（打开和关闭）:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T18:14:10.870

这是因为 .load() 绑定到可拖动的。每当重新加载可拖动对象时，它都会再次触发加载功能。

在你的第一个函数中，你有这个......

```
$('#draggable').load(function() {}); 
```

然后在你的第二个函数中，你有这个......它正在触发 $('#draggable').load(function() {}); 再次发挥作用

```
 // This is loading $('#draggable') which is triggering the .load() function again
    $('#draggable').attr('id', 'main_image_src')
    $('#main_image_src').attr("src", new_main_img_src); 
```

不要将 .load() 绑定到可拖动元素。为 .load() 创建一个单独的函数

```
 function resizedraggable() {

    if ($("#draggable").width() > 980 && $("#draggable").height() > 480) {
        var width_marg = ($("#draggable").width() - 980);
        var height_marg = ($("#draggable").height() - 480);
        $("#containment-wrapper").width($("#draggable").width() + width_marg);
        $("#containment-wrapper").height($("#draggable").height() + height_marg);
        $("#containment-wrapper").css('marginLeft', -width_marg);
        $("#containment-wrapper").css('marginTop', -height_marg);

        $("#draggable").draggable({
            containment: "#containment-wrapper",
            scroll: false
        });
    }
    else {
        var width_marg = ($("#draggable").width() - 980) / 2;
        var height_marg = ($("#draggable").height() - 480) / 2;
        $("#containment-wrapper").width($("#draggable").width());
        $("#containment-wrapper").height($("#draggable").height());
        $("#containment-wrapper").css('marginLeft', -width_marg);
        $("#containment-wrapper").css('marginTop', -height_marg);
    }
} 
```

然后在必要时在其他函数中调用此函数

# c - 逐行阅读时用逗号分隔单词。C

> ID：13348627
> 
> 赞同：0
> 
> 时间：2012-11-12T17:39:11.670
> 
> 标签：c, arrays, split

我有这样的文字：（第一个单词）：word2，word3，...

> ab: 1a,2b,3c,4d
> 
> c: 5e,6f,7g

我想将右侧分配到这样的数组中：

```
arr1[4] = {1a,2b,3c,4d}
arr2[3] = {5e,6f,7g} 
```

现在我像这样逐行迭代

```
 while ( fgets ( line, sizeof line, file ) != NULL ){...} 
```

你能建议一种拆分行的方法，这样我就可以在没有第一个单词和逗号的情况下分别取每个单词吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T17:41:42.073

怎么样：

```
while (...) {
    if (!strtok(line, ": ,"))
        continue;

    while ((word = strtok(NULL, ": ,")))
        /* ... */
} 
```

# java - 如何动态生成接口的实现

> ID：13348629
> 
> 赞同：0
> 
> 时间：2012-11-12T17:39:24.147
> 
> 标签：java, dynamic, reflection

假设我有一个为服务器提供连接属性的接口：

```
public interface ServerConfig {
    String getHostname();

    int getPort();
} 
```

有什么方法可以在运行时动态创建所述接口的实现类，该实现类会从某个任意源（应用程序参数、系统属性、外部配置文件等）返回值？

更具体地说，假设有一个`.properties`包含以下内容的文件：

```
hostname = localhost
port = 80 
```

和一个方法

```
ServerConfig fromFile(String filename); 
```

调用此方法应返回动态生成的实现的实例，该实例`ServerConfig`将从参数`.properties`中指定的文件返回值`filename`。

澄清：

目标是能够添加其他接口，其方法将返回在外部源（即`.properties`文件）中指定的值，而无需每次都手动实现它们。一个简单的解决方案是创建接口的实现，这些接口返回的属性值与被调用的接口方法名称相匹配，即调用`getHostname()`将返回`hostname`属性值，`getBla()`从其他接口调用将查找并返回`bla`属性值等.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T17:45:09.767

你不需要做这样的事情。
您可以只编写一个实现接口并将文件名作为构造函数参数的普通类。

# java - MySQL prepareStatement Batch 慢

> ID：13348632
> 
> 赞同：1
> 
> 时间：2012-11-12T17:39:43.590
> 
> 标签：java, mysql, windows

我有以下代码在 MySQL 表中插入行：

```
String sqlInsert = "INSERT INTO test_perf_table ( id, name) VALUES ( ?, ?);";
PreparedStatement sqlInsertSt = connection.prepareStatement(sqlInsert);

for (int i = 0; i < SETSIZE; i++) {
    sqlInsertSt.setInt( 1, ids[i]);
    sqlInsertSt.setString( 2, names[i]);
    sqlInsertSt.addBatch();
}
int[] updateCounts = sqlInsertSt.executeBatch(); 
```

问题是我每秒只归档 21 笔交易，这非常低，预计速度会快 10 倍。

所以我的问题是，我的代码需要改进还是数据库配置问题？

MySQL 服务器在 Win8 中运行 @localhost，使用 my-large.ini 默认配置，使用 mysql-connector-java-5.1.13 驱动程序。

不确定，但我认为引擎是 myisam，因为我没有指定任何内容

编辑：

```
CREATE TABLE test_perf_table (
    id INT,
    name VARCHAR(20) 
); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-15T00:14:55.810

我最近刚刚处理了这个问题。

最大的不同是将参数添加`rewriteBatchedStatements=true`到您的 jdbc 连接 url。

您还可以通过在事务中执行 executeBatch() 来提高性能。

# excel - 当文件在后台打开但未使用时刷新 Excel 2010 中的外部数据

> ID：13348633
> 
> 赞同：0
> 
> 时间：2012-11-12T17:39:43.747
> 
> 标签：excel, excel-2010, excel-addins, exceldatareader, vba

我正在使用 Excel 2010 查询 MS SQL 数据库和其他 Excel 文件以导入数据。我为每个数据连接（10 个连接）设置了不同的间隔。在 excel 中，这些数据被切片和切块以创建在 PowerPoint 中呈现的有意义的图表。

我能够找到一个用于 PowerPoint 的 VB 插件，以便在循环演示文稿时自动更新来自 excel 的数据。

我在后台（在 PowerPoint 后面）保持 excel 文件打开，因为每次刷新图表时 PowerPoint 都会尝试打开 excel 工作表。我的问题出在 Excel 中，因为它没有被积极使用，数据连接不会自动刷新。

我尝试了各种解决方案，但它们需要手动启动 vb / 宏，但是我需要它来根据为数据连接提供的时间自动刷新数据。

是否有一个 VB 代码可以在 Excel 中用于在打开 excel 工作簿但未主动使用时刷新数据连接？

感谢您是否可以将我指向相关帖子或指导我。

先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-05-19T16:45:51.900

如果工作表中的数据发生更改，我找到了刷新 Pivot 缓存的解决方案。我正在更新这篇文章，以防其他人需要解决方案。非常感谢您的帮助。

```
Private Sub Worksheet_Change(ByVal Target As Range) 

Worksheets("Pivot table").PivotTables("PivotTable1").PivotCache.Refresh

End Sub 
```

请点击此链接以获取有关此问题的更多信息 - [http://www.get-digital-help.com/2011/06/13/auto-refresh-a-pivot-table-in-excel/#comment-52745](http://www.get-digital-help.com/2011/06/13/auto-refresh-a-pivot-table-in-excel/#comment-52745)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T21:21:35.090

听起来您已经启用了此功能，但是当您转到数据...连接并选择您的连接/查询之一时，单击属性...，在使用选项卡下，您是否选择了“启用后台刷新”和“刷新每 X 分钟一次”？

即使程序没有焦点，Excel 也应继续更新其查询。在我撰写此回复时，我可以看到 Excel 在后台每分钟更新一次测试查询。

有没有尝试过其他的场景……如果你没有主动使用Excel工作表，但是电脑处于空闲状态，是否会刷新？如果你用IE浏览网页？与铬？即尝试诊断问题是否与 PowerPoint 隔离。

这不应该需要 VBA 才能开始工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T13:37:17.863

在这里查看我的答案：[https ://superuser.com/questions/232656/how-do-you-update-an-excel-file-data-refresh-and-update-formulas-without-openi](https://superuser.com/questions/232656/how-do-you-update-an-excel-file-data-refresh-and-update-formulas-without-openi)

tdlr，使用[http://metacpan.org/pod/Win32::Excel::Refresh](http://metacpan.org/pod/Win32::Excel::Refresh) 如果你不想使用 perl，它会附带一个 Windows EXE。这使您可以从命令行运行 Excel 更新/刷新/宏，并且可以使用任务计划程序来运行它。

# c++ - 显示主窗体 Qt C++ 的另一个窗体

> ID：13348635
> 
> 赞同：1
> 
> 时间：2012-11-12T17:39:48.473
> 
> 标签：c++, forms, qt, graphics, qt-creator

我在 QT creator 中创建了一个表单`mainwindow`类，在 menuBar 中创建了一个动作元素，我希望当我们点击它时，它会显示另一个名为`DataWindow`

这是我的 mainwindow.h

```
private slots:
    void on_actionNouvellesDonnees_clicked(); 
```

这是我的 mainwindow.ccp

```
void MainWindow::on_actionNouvellesDonnees_clicked() {
    DataWindow w;
    w.show();
} 
```

但是当我调试并单击我的操作菜单时，没有显示 DataWindow ......并且调试工具告诉我：

```
QMetaObject::connectSlotsByName: No matching signal for on_actionNouvellesDonnees_clicked() 
```

谢谢你的帮助 ！

完成 mainwindow.ccp ：

```
#include <QtGui/QApplication>
#include <QApplication>
#include <QMessageBox>

#include "mainwindow.h"
#include "ui_mainwindow.h"
#include "datawindow.h"

MainWindow::MainWindow(QWidget *parent) :
    QMainWindow(parent),
    ui(new Ui::MainWindow)
{
    ui->setupUi(this);
    //QObject::connect(ui->actionNouvellesDonnees, SIGNAL(triggered()), this, SLOT(on_actionNouvellesDonnees_clicked()));
}

MainWindow::~MainWindow()
{
    delete ui;
}
void MainWindow::on_actionNouvellesDonnees_triggered() {

    DataWindow w;
    w.show();
} 
```

完成主窗口.h

```
#ifndef MAINWINDOW_H
#define MAINWINDOW_H

#include <QMainWindow>

namespace Ui {
class MainWindow;
}

class MainWindow : public QMainWindow
{
    Q_OBJECT

public:
    explicit MainWindow(QWidget *parent = 0);
    ~MainWindow();

private slots:
    void on_actionNouvellesDonnees_triggered();

private:
    Ui::MainWindow *ui;
};

#endif // MAINWINDOW_H 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-18T01:23:09.803

你说你用

```
 void MainWindow::on_actionNouvellesDonnees_clicked() {
        DataWindow w;
        w.show();
    } 
```

这会在堆栈上构造一个 DataWindow 对象，显示它，然后离开函数，立即销毁该对象。

```
 void MainWindow::on_actionNouvellesDonnees_clicked() {
        DataWindow *w = new DataWindow;
        w->setAttribute(Qt::WA_DeleteOnClose);
        w->show();
    } 
```

应该让它保持活动状态，直到您手动关闭窗口

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T18:05:41.293

你在 on_actionNouvellesDonnees_clicked 上连接哪个信号？如果它是一个动作（如在主菜单中），正确的信号不是“clicked()”，您可以使用“triggered()”。

试试这个

```
QObject::connect(ui->actionNouvellesDonnees, SIGNAL(triggered()), this, SLOT(on_actionNouvellesDonnees_clicked())); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-12T18:05:48.580

看起来您的`actionNouvellesDonnees`is a `QAction`，它没有称为 clicked() 的信号。尝试将您的插槽更改为：

```
on_actionNouvellesDonnees_triggered() 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-12T23:28:57.393

现在您所做的就是显示窗口，然后在离开插槽范围时将其删除。你有很多选择来解决这个问题，这取决于你想要做什么以及`DataWindow`应该是什么样的窗口。

**选项 1** - 简单模式对话框

如果您只是弹出一个需要用户立即注意的窗口，并且在它们完成之前没有其他操作可以继续，请启动一个等待用户输入的模式对话框。[QDialog::exec()](http://doc.qt.digia.com/qt/qdialog.html#exec)应该代替[QDialog::show()](http://doc.qt.digia.com/qt/qwidget.html#show)。

```
void MainWindow::on_actionNouvellesDonnees_triggered() {
    DataWindow w;
    int result = w.exec();
    switch(result){
        case QDialog::Ok: //etc
            break;
        case QDialog::Cancel: //etc
            break;
        default: //etc
    }
} 
```

**选项 2** - 复杂模式对话框

如果其他函数需要以某种方式查询此窗口，则您需要使其成为 MainWindow 的成员，然后在操作期间在堆上创建它。

```
//MainWindow.h
MainWindow {
public:
    MainWindow();
    ...
protected:
    DataWindow* m_datawin;
    ...
}

//mainwindow.cpp
void MainWindow::MainWindow {
    ...
    m_datawin = 0;
}
void MainWindow::on_actionNouvellesDonnees_triggered() {
    if(m_datawin != 0)
        m_datawin->deleteLater(); //you must delete it somewhere. either delete it in the dtor or at the end of this slot, depending on if you need it outside this scope
    m_datawin = new DataWindow();
    m_datawin->setWindowModality(Qt::WindowModal);
    int result = m_datawin->exec();
    switch(result){
        case QDialog::Ok: //etc
            break;
        case QDialog::Cancel: //etc
            break;
        default: //etc
    }
} 
```

非模态对话框（或窗口）还有第三个选项，但如果您正在寻找，我会让您阅读[QDialog 文档。](http://doc.qt.digia.com/qt/qdialog.html#details)希望我能理解主要思想。

第四个选项是`new DataWindow`在 MainWindow 构造函数中，然后`show`/ `hide`it 在触发槽中。

# sql-order-by - SQL Server 2012 中的 group_concat 与 ORDER BY 另一列

> ID：13348638
> 
> 赞同：5
> 
> 时间：2012-11-12T17:39:56.840
> 
> 标签：sql-order-by, sql-server-2012, sql-server-group-concat

我有一个包含〜一百万个这样的条目的表：

```
customer_id | purchased_at     | product
1           | 2012-06-01 00:00 | apples
1           | 2012-09-02 00:00 | apples
1           | 2012-10-01 00:00 | pears
2           | 2012-06-01 00:00 | apples
2           | 2012-07-01 00:00 | apples
3           | 2012-09-02 00:00 | pears
3           | 2012-10-01 00:00 | apples
3           | 2012-10-01 01:00 | bananas 
```

我想将产品连接到一行，DISTINCT 并按照购买的顺序

在 MySQL 中，我只使用

```
select customer_id, min(purchased_at) as first_purchased_at, 
group_concat(DISTINCT product order by purchased_at) as all_purchased_products
from purchases group by customer_id; 
```

要得到

```
customer_id | first_purchased_at | all_purchased_products
1           | 2012-06-01 00:00 | apples, pears
2           | 2012-06-01 00:00 | apples
3           | 2012-09-02 00:00 | pears, apples, bananas 
```

如何在 SQL Server 2012 中做到这一点？

我尝试了以下“hack”，它有效，但它是一种过度杀伤，并且在长桌上表现不佳

```
select
customer_id,
min(purchased_at) as first_purchased_at,
stuff ( ( select  ',' +  p3.product 
          from (select  p2.product, p2.purchased_at, 
          row_number() over(partition by p2.product order by p2.purchased_at) as seq
          from  purchases p2 where
          p2.customer_id = p1.customer_id ) p3 
          where p3.seq = 1 order by p3.purchased_at
          for XML PATH('') ), 1,1,'') AS all_purchased_products  
from purchases p1
group by customer_id; 
```

我能做些什么来解决这个问题？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-12T17:58:01.980

I am not sure if this will be any faster, but here is an alternate version where you don't join on `purchases` twice in the `STUFF()`:

```
select customer_id,
  min(purchased_at) as first_purchased_at,
  stuff ((select ',' +  p2.product 
          from
          (
            select product, customer_id,
                ROW_NUMBER() over(partition by customer_id, product order by purchased_at) rn,
                ROW_NUMBER() over(partition by customer_id order by purchased_at) rnk   
            from purchases
          ) p2 
          where p2.customer_id = p1.customer_id
            and p2.rn = 1
          group by p2.product, rn, rnk
          order by rnk
          for XML PATH('') ), 1,1,'') AS all_purchased_products  
from purchases p1
group by customer_id; 
```

See [SQL Fiddle with Demo](http://sqlfiddle.com/#!6/36f7c/5)

Result:

```
| CUSTOMER_ID |               FIRST_PURCHASED_AT | ALL_PURCHASED_PRODUCTS |
---------------------------------------------------------------------------
|           1 |      June, 01 2012 00:00:00+0000 |           apples,pears |
|           2 |      June, 01 2012 00:00:00+0000 |                 apples |
|           3 | September, 02 2012 00:00:00+0000 |   pears,apples,bananas | 
```

# python - 在 matplotlib 中用两个 y 轴格式化 x 轴标签（条形图和线图）

> ID：13348640
> 
> 赞同：2
> 
> 时间：2012-11-12T17:40:02.010
> 
> 标签：python, matplotlib, pandas

我在一个图中绘制了条形图和线图，并且在正确格式化共享的 x 轴刻度标签时遇到了问题。线上的点与绘制刻度标签的条形中心不同步。

**PS：我正在通过熊猫绘图功能进行绘图**

例子：

A. 单条图（工作正常）

```
libs_summary_pandas_df[['read_count']].plot(kind='bar',ax=axis,color=['#E41A1C']) 
```

![在此处输入图像描述](../Images/5514a02c7bc521b0f39f327dfc0a6608.png)

B. 在次要 y 轴上用线图叠加（**x 轴标签搞砸了**）

```
libs_summary_pandas_df.total_yield.map(lambda x: x/1000000000.0).plot(kind='line',ax=axis) 
```

![在此处输入图像描述](../Images/2595194f66c0b38dbf26688958b94f27.png)

谢谢！-阿比

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T08:33:47.840

# r - xts 错误 - 请帮助解释行为

> ID：13348642
> 
> 赞同：2
> 
> 时间：2012-11-12T17:40:08.557
> 
> 标签：r, xts

我的 R 版本是 2.15.1 我正在关注 Luis Torgo 关于“预测股市回报”的案例研究。当我尝试从 csv 文件或网络导入数据集时，两种方法都失败了

```
Error in as.POSIXlt.character(x, tz, ...) : 
  character string is not in a standard unambiguous format 
```

我继续使用可用的 .RData 文件。但是，当我尝试运行 T.ind 函数时遇到同样的错误

```
> T.ind <- function(quotes, tgt.margin = 0.025, n.days = 10) {
+ v <- apply(HLC(quotes), 1, mean)
+ r <- matrix(NA, ncol = n.days, nrow = NROW(quotes))
+ for (x in 1:n.days) r[, x] <- Next(Delt(v, k = x), x)
+ x <- apply(r, 1, function(x) sum(x[x > tgt.margin | x <
+ -tgt.margin]))
+ if (is.xts(quotes))
+ xts(x, time(quotes))
+ else x
+ } 
```

因此，我手动执行了每个命令，将参数逐行替换为相应的值，并将错误追溯到该行：

```
 >xts(x,time(GSPC)) #'quote' replaced with 'GSPC'
 Error in as.POSIXlt.character(x, tz, ...) : 
   character string is not in a standard unambiguous format 
```

令人惊讶的是，经过多次试验和错误，我发现删除 2 行就可以了**！**：

```
 > GSPC_new<-GSPC[-c(1073,1325),]
 > x_new<-x[-c(1073,1325)]
 > xts_obj<-xts(x_new,time(GSPC_new)) 
```

以前有人遇到过这种现象吗？这可能是什么解释？感谢您花时间阅读并可能回答这个问题！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T17:52:56.950

当字符数据被强制转换为对象（即 R 可以理解为日期时间而不仅仅是字符串的东西）时，错误来自`as.POSIXlt.character`哪个方法调用。`POSIXlt`

这意味着您的日期时间数据向量未以被识别为标准日期时间格式的格式记录：

```
else if (all(!is.na(strptime(xx, f <- "%Y-%m-%d %H:%M:%OS", 
    tz = tz))) || all(!is.na(strptime(xx, f <- "%Y/%m/%d %H:%M:%OS", 
    tz = tz))) || all(!is.na(strptime(xx, f <- "%Y-%m-%d %H:%M", 
    tz = tz))) || all(!is.na(strptime(xx, f <- "%Y/%m/%d %H:%M", 
    tz = tz))) || all(!is.na(strptime(xx, f <- "%Y-%m-%d", 
    tz = tz))) || all(!is.na(strptime(xx, f <- "%Y/%m/%d", 
    tz = tz)))) { 
```

但是，唯一适用的测试是检查IIRC 是否存在s 可以在数据`NA`中出现的其他方式。最可能的罪魁祸首是您或您的计算机正在运行的时区中不存在的日期时间。想想夏令时等或系统的各种变幻莫测的日历和时间从未存在的日期。`NA``POSIXlt`

您已经确定了错误或导致问题的行。去看看那些数据是什么样子的。它们的格式是否正确？如果是，日期/时间对您的时区有意义吗？您可能需要自己对此进行一些检查，以了解您的计算碰巧认为它正在运行的位置。

# ruby-on-rails - Backbone.js：什么是 paramRoot：backbone.model 中的属性？

> ID：13348644
> 
> 赞同：2
> 
> 时间：2012-11-12T17:40:25.750
> 
> 标签：ruby-on-rails, backbone.js, backbone-rails

我使用 rails-backbone gem 并生成了一个 Backbone 模型。该模型包括`paramRoot:`属性。我假设它以某种方式告诉 Backbone 如何连接到相应的 Rails 模型，但我找不到任何关于它的文档。

实际上是做什么的`paramRoot`？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-12T20:16:25.710

Backbone-rails 没有记录`paramRoot`. 我想您应该使用生成器来[构建模型](https://github.com/codebrew/backbone-rails/blob/master/lib/generators/backbone/model/templates/model.coffee)：

```
class <%= model_namespace %> extends Backbone.Model
  paramRoot: '<%= singular_table_name %>'
  #... 
```

盲目地按照你说的去做。

如果您想知道它的作用，那么您必须阅读源代码（像往常一样）。Backbone-rails 中唯一使用`paramRoot`的是标准的替代品[`Backbone.sync`](http://backbonejs.org/#Sync)；他们的替代品包含[以下](https://github.com/codebrew/backbone-rails/blob/master/vendor/assets/javascripts/backbone_rails_sync.js#L44)内容：

```
if(model.paramRoot) {
  data[model.paramRoot] = model.toJSON();
} else {
  data = model.toJSON();
} 
```

所做的只是将模型的序列化属性从标准的`{attr1: v1, attr2: v2, ...}`Backbone 形式更改为`{ model_name: { attr1: v1, ... } }`Rails 想要的形式；那么你可以`params[:model_name]`在你的 Rails 控制器中查看，而不仅仅是查看`params`.

# ruby-on-rails - 如何在 Rails 3.2.8 应用程序的控制器中传递嵌套属性值？

> ID：13348646
> 
> 赞同：0
> 
> 时间：2012-11-12T17:40:40.137
> 
> 标签：ruby-on-rails, ruby-on-rails-3, nested-attributes

`quote`获取`rfq`创建报价时已知的测试项目（在 中`@rfq.test_items`）。表quote_test_items 存储报价（`@quote.quote_test_items`）的所有测试项目。

在`quote`模型中，有：

```
accepts_nested_attributes_for :quote_test_items, :reject_if => proc {|item| item['test_item_id'].blank? }, :allow_destroy => true 
```

我们希望将所有测试项目`rfq`传递到`quote`控制器中`new`，并在用户想要删除一些测试项目时将它们显示给用户。这是我们在报价控制器中所做的`new`：

```
@rfq.test_items.each do |it|
     @quote.quote_test_items.build
     @quote.quote_test_items << it
end 
```

有一个错误：

```
QuoteTestItem(#56736972) expected, got TestItem(#50178372) 
```

我们在控制器中尝试了以下操作`new`：

```
@quote.test_items << @rfq.test_items 
```

它不会在控制器中产生错误。但是下面的代码有一个错误（未定义的方法：test_item_id）：

```
<%= f.fields_for @quote.quote_test_items  do |builder| %>
        <ul>
          <div class="fields">
            <li><%= builder.input :test_item_id, :collection => TestItem.active_test_item.all(:order => 'name'), :label_method => :name, :value_method => :id,
                                  :label => false %><%= link_to_remove_items "remove", f %></li>   
          </div>
        </ul>
    <% end %> 
```

在控制器中传递嵌套属性值的正确方法是什么？谢谢您的帮助。

# python - 当网页有它时，是否可以使该刮板在额外的页面中起作用？

> ID：13348647
> 
> 赞同：-3
> 
> 时间：2012-11-12T17:40:53.057
> 
> 标签：python, beautifulsoup, scraper

```
from twill.commands import *
from bs4 import BeautifulSoup
from urllib import urlopen
import urllib2

with open('urls.txt') as inf:
    urls = (line.strip() for line in inf)
    for url in urls:
        try:
            urllib2.urlopen(url)
        except urllib2.HTTPError, e:
            print e
        site = urlopen(url)   
        soup = BeautifulSoup(site)
        for td in soup.find_all('td', {'class': 'subjectCell'}):
            print td.find('a').text 
```

我的代码只从文件的每个 url 打开一个页面，有时会有更多页面，在这种情况下，下一页的模式将是 &page=x

这是我正在谈论的那些页面：

[http://www.last.fm/user/TheBladeRunner_/library/tags?tag=long+track](http://www.last.fm/user/TheBladeRunner_/library/tags?tag=long+track) http://www.last.fm/user/TheBladeRunner_/library/tags?tag=long+track&page=7

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T23:22:37.100

您可以从 next_page 链接中读取*href*属性并将其添加到您的*urls*列表中（是的，您应该将元组更改为列表）。它可能是这样的：

```
from twill.commands import *
from bs4 import BeautifulSoup
from urllib import urlopen
import urllib2
import urlparse

with open('urls.txt') as inf:
    urls = [line.strip() for line in inf]
    for url in urls:
        try:
            urllib2.urlopen(url)
        except urllib2.HTTPError, e:
            print e
        site = urlopen(url)   
        soup = BeautifulSoup(site)
        for td in soup.find_all('td', {'class': 'subjectCell'}):
            print td.find('a').text

        next_page = soup.find_all('a', {'class': 'nextlink'}):
        if next_page:
            next_page = next_page[0]
            urls.append(urlparse.urljoin(url, next_page['href'])) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T17:46:53.683

你可以创建一些从页面获取所有链接并跟随它们的东西，[scrapy](http://doc.scrapy.org/en/0.16/)免费做的事情

您可以创建一个蜘蛛，它将跟踪页面上的所有链接。假设有其他页面的分页链接，你的爬虫会自动跟随它们。

你可以用beautifulsoup解析页面上的所有链接来完成同样的事情，但是如果scrapy已经免费做到了，为什么还要这样做呢？

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-12T17:54:21.900

我不确定我是否理解您的问题，但您可能会考虑创建一些与您的“下一个”模式匹配的正则表达式（http://www.tutorialspoint.com/python/python_reg_expressions.htm），并在找到的页面上的 URL。当站点内链接高度一致时，我经常使用这种方法。

# c# - 如何设置 azure 以允许特定用户更新/删除/插入特定数据

> ID：13348649
> 
> 赞同：0
> 
> 时间：2012-11-12T17:40:59.623
> 
> 标签：c#, azure, windows-8

我目前正在开发一个使用 Azure 作为其数据库的 Windows 8 应用程序。在这个数据库中，我有 4 个表：

```
PlaceGroup
Places
PlaceComments
PlaceEvents 
```

我想制作某种帐户系统，允许用户只更新/删除他的位置，即只允许带有他的 ID 的记录。例子：

我有一个 id=5 的地方

PlaceComments 表具有以下记录表结构： id PlaceID CommentBody

* * *

```
first record:
1 5 "Some text here" 
```

* * *

```
second record
2 12 "Some text here" 
```

* * *

我应该只能更新/删除第二条记录。我真的不知道该怎么做，所以我正在寻求一些帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T05:58:36.207

查看[移动服务中的身份验证入门](http://www.windowsazure.com/en-us/develop/mobile/tutorials/get-started-with-users-js/)教程和后续内容：[使用脚本在移动服务中授权用户](http://www.windowsazure.com/en-us/develop/mobile/tutorials/authorize-users-in-scripts-js/)。

简而言之，您需要在应用程序中包含身份验证，您也可以通过移动服务来执行此操作。进行身份验证后，您将在表上设置各种脚本以支持“仅经过身份验证的用户”

![WAMS 权限下拉菜单](../Images/77b1a5d79c0368d345414e7ea4035199.png)

作为身份验证的结果，您将获得一个标识经过身份验证的用户的“用户 ID”，然后将该用户信息传递到各种脚本中，因此您可以使用该标识符仅匹配具有指示“所有者”的列的行的各种数据行（本质上是向所有查询添加 WHERE 用户 =）。本质上是创建一个多租户的实现。

![WAMS 脚本](../Images/aa875fe35149cbdad1b4cf8d471f5922.png)

# windows-7 - 在 Xbox Neighborhood 上创建文件的快捷方式

> ID：13348650
> 
> 赞同：1
> 
> 时间：2012-11-12T17:41:09.427
> 
> 标签：windows-7, shortcut, xbox360

我正在尝试在我的 XBox360 devkit 上创建一个特定文件夹的快捷方式。我可以导航到该文件夹​​，然后将快捷方式 alt 拖到 Windows 中，就像任何其他文件夹一样。但是这个快捷方式不起作用。双击它什么也不做。

我发现进入 XBox 文件夹的唯一方法是打开 XBox Neighborhood 并向下导航到该文件夹​​ - 每次重新启动机器时我都必须重做，因为与本地文件夹不同，它不会在 Windows 时保存关闭。这是一个相当长的文件夹系列，很容易迷失在我们设置的深层文件夹树中。有什么方法可以设置从 Windows 到 XBox 文件夹的快捷方式？

或者，我可以放在 XBox 根目录的快捷方式几乎一样好。只是不想总是一遍又一遍地浏览所有这些文件夹。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-22T06:25:00.447

不幸的是，Xbox 360 Neighborhood shell 扩展并不正式支持在控制台上创建文件夹的快捷方式。当我尝试使用附近的快捷方式时，我总是收到一条消息说`Catastrophic failure`。文档中也没有提到创建快捷方式。

我一直在摆弄 shell 扩展和`rundll32.exe`，我偶然发现了这个非官方的解决方案：

```
"C:\Windows\system32\rundll32.exe" "C:\Windows\system32\xeshlext.dll",LaunchExplorer xbox://XDK\DEVKIT\Samples\Dolphin 
```

替换`XDK`为您的 devkit 名称和`DEVKIT\Samples\Dolphin`您要打开的文件夹的路径（请注意，您*必须*在此处使用反斜杠）。

您可以创建一个新的快捷方式并将上面的内容用作路径，也可以创建一个`.bat`文件并将上面的内容放入其中。当然，您也可以从命令提示符运行它。

如果您创建快捷方式并想要正确的图标，您可以在以下位置找到 Xbox 360 文件夹图标`C:\Windows\system32\xeshlext.dll`：

![在此处输入图像描述](../Images/d946dc71009c93cf02d0793a672ec72d.png)

我通过查看注册表并`xeshlext.dll`在十六进制编辑器中检查找到了这个快捷解决方案。

# download - 是否可以下载未嵌入的 .swf 文件

> ID：13348653
> 
> 赞同：0
> 
> 时间：2012-11-12T17:41:18.013
> 
> 标签：download, flash

目前我正在寻找下载 .swf 文件的可能性。我需要它，在媒体设计课程中离线展示页面。问题不是，我不知道如何下载 .swf 文件。问题是，这个页面没有真正的 .swf 文件，它像正常一样嵌入。页面描述只是说“对象”，而不是“嵌入”。有没有可能下载文件？

页面：[http](http://aquacarpatica.com/#/en) ://aquacarpatica.com/#/en 直接 SWF 链接：[http ://aquacarpatica.com/data/main.swf](http://aquacarpatica.com/data/main.swf)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T17:48:36.337

右键单击您的链接（在这个问题中！）。

选择将文件另存为...。

刚刚自己完成了这项工作，并将您的 SWF 文件保存在我的本地计算机上。

我很欣赏嵌入式资源没有显示为您可以右键单击和下载的内容，但您可以在单独的页面中创建指向它们的 href 链接。

因此，创建一个可以在本地查看的新 HTML 文件。

包括：-

```
<a href="http://aquacarpatica.com/data/main.swf">Right click me!</a> 
```

..在您的 HTML 文件中。

打开文件，右键单击链接=作业完成。应该适用于任何静态链接的内容。

# c# - SignalR 向单个 connectionId 发送消息

> ID：13348654
> 
> 赞同：17
> 
> 时间：2012-11-12T17:41:26.730
> 
> 标签：c#, asp.net, signalr, signalr-hub

我有一个 asp.net 经典网站。我让 SignalR 基本功能正常工作（一个客户端向其余客户端发送消息）。但现在我只想将消息发送到特定的连接 ID。

我的集线器：

```
**    [HubName("chatHub")]
    public class ChatHub : Hub 
    {
        public static List<string> messages = new List<string>();

        public void GetServiceState()
        {
            Clients.updateMessages(messages);
        }

        public void UpdateServiceState()
        {
            messages.Add(DateTime.Now.ToString("dd/MM/yyyy HH:mm:ss"));

            Clients.updateMessages(messages);
        }

    }** 
```

ASP代码：

```
 <script type="text/javascript">
            $(function () {
                // creates a proxy to the health check hub

                var healthCheckHub = $.connection.chatHub;
                console.log($.connection.hub)
                // handles the callback sent from the server
                healthCheckHub.updateMessages = function (data) {
                    $("li").remove();

                    $.each(data, function () {
                        $('#messages').append('<li>' + this + '</li>');
                        console.log($.connection);
                    });
                };

                $("#trigger").click(function () {
                    healthCheckHub.updateServiceState();
                });

                // Start the connection and request current state
                $.connection.hub.start(function () {
                    healthCheckHub.getServiceState();
                });

            }); 
```

问题是我真的不知道如何使用集线器发送到一个特定的 ConnectionID，因为 Clients.updateMessages(messages); 向他们所有人发送消息。我该如何解决这个问题？

PS：我已经看过：[Send server message to connected clients with Signalr/PersistentConnection](https://stackoverflow.com/questions/7616983/send-server-message-to-connected-clients-with-signalr-persistentconnection)

和[http://riba-escapades.blogspot.dk/2012/05/signalr-send-messages-to-single-client.html](http://riba-escapades.blogspot.dk/2012/05/signalr-send-messages-to-single-client.html)

那没有用。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-11-12T18:48:16.423

好吧，您可以像这样从 Hub 向单个客户端发送消息：

```
Clients.Client(someConnectionIdIWantToSendToSpecifically).doSomething(); 
```

诀窍是您需要知道要将消息发送到的连接 ID。更具体地说，您可能还想知道要发送消息的事物的逻辑标识，因为该逻辑标识可能有多个连接，或者在完全不同的连接 ID 下断开并重新连接。将连接映射到逻辑标识是 SignalR 留给应用程序本身的事情。

# java - 爪哇。怎么用"while" 那个程序最后问：要不要再搜索一下？

> ID：13348659
> 
> 赞同：0
> 
> 时间：2012-11-12T17:41:39.523
> 
> 标签：java, search, while-loop, find, word

我想问你如何在处理时制作它并再次执行此操作。我的意思是当程序做他的工作时它必须问：你要搜索其他词，是还是否？如果是程序将重新启动，如果没有退出。

我想想：

```
 int searchAgain = 0;
            System.out.println("Do you want search for other word?");
            System.out.println("1=Yes 2=No");
            searchAgain = input.nextInt();}
        else {
            System.out.println("Error...");
            }   
                if (searchAgain == 1) {
                    System.out.println("Write your word: ");
                    .....//I dont know what here

                }
                    else{
                        System.out.println("Program closed.");
                    } 
```

这是我当前的代码：

```
 package lt.kvk.i3_2.kalasnikovas_stanislovas;

import java.io.BufferedReader;
import java.io.FileReader;
import java.io.IOException;
import java.util.ArrayList;
import java.util.Scanner;

public class Miestai {

        public static void main(String args[]) throws Exception {
            String kitasStilius = "";
            while (!"Ne".equalsIgnoreCase(kitasStilius )) {
            Scanner input = new Scanner(System.in);
            System.out.println("Pasirinkite muzikos stiliu is saraso:");
            System.out.println();

            try {

                FileReader fr = new FileReader("src/lt/kvk/i3_2/kalasnikovas_stanislovas/Stiliai.txt");
                BufferedReader br = new BufferedReader(fr);
                String stiliuSarasas;
                while((stiliuSarasas = br.readLine()) != null) {
                    System.out.println(stiliuSarasas);
                }
                fr.close();
                String stilius = input.nextLine();   
                BufferedReader bf = new BufferedReader(new FileReader("src/lt/kvk/i3_2/kalasnikovas_stanislovas/Miestai.txt"));
                int counter = 0;                
                String line;

                System.out.println("Ieskoma informacija apie " + stilius);
                ArrayList<String> miestuSarasas = new ArrayList<String>();
                String miestas = null;

                while (( line = bf.readLine()) != null){
                    if (line.trim().length() == 0) miestas = null;
                       else if (miestas == null) miestas = line;
                       int indexfound = line.indexOf(stilius);
                       if (indexfound > -1) {
                       counter++;
                       miestuSarasas.add(miestas);
                       }                   
                }
                if (counter > 0) {
                    System.out.println(stilius + " turi " + counter + " remejus: " + miestuSarasas);                    
                    System.out.println("Ar norite ieskoti informacijos apie kita stiliu?");
                    System.out.println("Iveskite: Taip arba Ne");
                    kitasStilius = input.next();

                    }
                else {
                    System.out.println("Klaida, nerastas muzikos stilius");
                    break;
                    }   
                        if ("Taip".equalsIgnoreCase(kitasStilius)) {
                        }
                        else if ("Ne".equalsIgnoreCase(kitasStilius)) {
                            System.out.println("Darbas baigtas.");

                        }
                            else{
                                System.out.println("Neteisingai pasirinkta.");
                                break;
                            }
                        bf.close();
                        }

            catch (IOException e) {
                System.out.println("Error:" + e.toString());
            }
        }
        }
        private void searchWord(String textToSearch ){
            //your logic here which performs the search and prints the result
         }
     } 
```

从 file.txt 计算单词（通过键盘输入）并选择谁重复了这个单词，例如：如果我输入单词：`One`它显示：

```
Word One repeated 3 times by John, Elisa, Albert 
```

file.txt 看起来像：

```
John //first line - name
One
Three
Four

Peter //first line - name
Two
Three

Elisa //first line - name
One
Three

Albert //first line - name
One
Three
Four

Nicole //first line - name
Two
Four 
```

谢谢你的回答。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T17:44:29.527

将您的代码（稍作修改）包装在一个`while`循环中，条件`searchAgain`为：

**编辑：**更新以接受选项作为字符串：

```
 public class Testing {

   public static void main(String args[]) throws Exception {
       Scanner input = new Scanner(System.in);
        System.out.println("Select word from list:");
        System.out.println();

        String searchAgain = "";
        while(!"No".equalsIgnoreCase(searchAgain )){
           System.out.println("Do you want search for other word?");
           System.out.println("Enter: Yes or No");
           searchAgain = input.next();
           if ("Yes".equalsIgnoreCase(searchAgain)) {
              System.out.println("Write your word: ");
              String textToSearch = input.next();
              searchWord(textToSearch );
           } else if ("No".equalsIgnoreCase(searchAgain)) {
                 System.out.println("Program closed.");
           } else{
                 System.out.println("Invalid Input.");
           }
        }
     }

     private void searchWord(String textToSearch ){
        //your logic here which performs the search and prints the result
     }
 } 
```

# java - 如何使用 Graphics2D.rotate() 旋转

> ID：13348662
> 
> 赞同：0
> 
> 时间：2012-11-12T17:41:42.183
> 
> 标签：java, graphics, graphics2d

在这个程序中，我想为一列火车制作动画，当火车到达一些 x 坐标时，我想一个接一个地旋转每个火车车厢（矩形）。火车由五辆汽车组成，一个矩形代表一辆汽车。当火车到达某个位置时，我想为轨道变化设置动画（下轨道到上轨道）。所以我想在每辆车到达换轨位置时旋转它。我使用以下代码来执行此操作，但它会一次旋转所有汽车，第一辆汽车 45 度（正确），第二辆汽车 90 和第三辆汽车 135 ......等等。

**代码：**

```
private void drawLineBTrain(Graphics g){

    Graphics2D gg = (Graphics2D) g;

    for(int i = 0; i < b.getSize(); i++){            
        if(rotate){
            gg.rotate(-Math.PI/4, b.getCar(i).getPosX(), b.getCar(i).getPosY());
        }
        gg.fillRect(b.getCar(i).getPosX(), b.getCar(i).getPosY(), 80, 24);
    }
}

public void moveLineBTrain(Train t, boolean goRight){

    if(goRight) {
        b = t;
        int x, y;
        for(int i = 0; i < b.getSize(); i++) {
            x = b.getCar(i).getPosX();
            b.getCar(i).setPosX(++x);
            if(x > ((getWidth() / 2) - 140) && x < ((getWidth() / 2) + 140)){
                y = 490 + (int)( (double) (-100 * x) / 280 );
                b.getCar(i).setPosY(y);
                rotate = true;
            }
        }
    } else {
        b = t;
        int x, y;
        for(int i = 0; i < b.getSize(); i++) {
            x = b.getCar(i).getPosX();
            b.getCar(i).setPosX(--x);
            if(x > ((getWidth() / 2) - 140) && x < ((getWidth() / 2) + 140)){
                y = 490 + (int)( (double) ( -100 * (1344 - x) / 280 ));
                b.getCar(i).setPosY(y);
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T18:20:12.617

我猜你的问题是你错误地旋转了“画布”，旋转了“对象”。你正在做的是：

1.  您将“画布”旋转 45 度，然后在其上绘制第一个矩形。结果：旋转 45 度的矩形。
2.  您将“画布”旋转 45 度（再次！），然后在其上绘制第二个矩形。结果：一个矩形旋转了 45 度，第二个矩形旋转了 90 度。

我的猜测是（我现在无法测试代码）您必须将旋转移出 for 循环并在最后撤消对转换矩阵的更改，以便`draw`不会转换对 Method 的后续调用（旋转）。试试这个并告诉我们它是否有效，如果没有，我会想到更聪明的方法：

```
private void drawLineBTrain(Graphics g){

    Graphics2D gg = (Graphics2D) g;
    AffineTransform aT = gg.getTransform(); // We store the initial transformation matrix

    for(int i = 0; i < b.getSize(); i++){            

    if(rotate){
            gg.rotate(-Math.PI/4, b.getCar(i).getPosX(), b.getCar(i).getPosY());
    }

        gg.fillRect(b.getCar(i).getPosX(), b.getCar(i).getPosY(), 80, 24);
        gg.setTransform(aT); // We restore the transformation matrix
    }
} 
```

这是直接来自 Sun的[关于 Graphics2D Transformations 的好文本。](http://docs.oracle.com/javase/7/docs/technotes/guides/2d/spec/j2d-awt.html)他们是这样说的：

> 要执行其他转换，例如旋转或缩放，您可以将其他转换添加到 Graphics2D 上下文。这些额外的变换成为渲染过程中应用的变换管道的一部分

这意味着如果您调用该`rotate()`方法，Graphics2D 上下文（“画布”）将被旋转**并保持这种状态**，直到您将其旋转回来（或恢复初始转换矩阵）。

# ruby-on-rails - 指定依赖的 gem 版本

> ID：13348665
> 
> 赞同：0
> 
> 时间：2012-11-12T17:41:58.527
> 
> 标签：ruby-on-rails, gem

由于服务器限制，我无权在生产环境中安装特定的 gem 版本。

在开发过程中，我安装了delayed_job_active_record (0.3.3)，它依赖于delayed_job，bundler 使用最新版本3.0.4。不幸的是，在生产中只安装了 v. 3.0.3。因此我手动编辑了 gemfile.lock 。它现在可以用于生产，但我认为，这绝对不是正确的做法。那么，如何指定依赖 gem 的版本呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T17:45:49.453

只需在您的 Gemspec 中声明您所依赖的`"delayed_job", "3.0.3"`. 如果可能，Bundler 将找出一组满足所有要求的依赖项。如果`delayed_job_active_record`依赖于`delayed_job`版本 3 或更高版本（例如），并且您特别依赖于 3.0.3，那么 Bundler 会发现版本 3.0.3 足以满足这两个要求。

此外，您应该能够将适当版本的 gem 与您的应用程序捆绑在一起。Bundler 的要点之一是允许您这样做；将您依赖的所有 gem 收集到您的应用程序中，这样您就不会受到主机上安装的任何东西的摆布。你运行`bundle install --deployment`，它会将你所有的 gem 复制到`vendor/bundle`目录中。[有关详细信息，请参阅使用 Bundler 进行部署](http://gembundler.com/deploying.html)的文档。

# php - Yii URLManager 和动作参数

> ID：13348669
> 
> 赞同：0
> 
> 时间：2012-11-12T17:42:21.467
> 
> 标签：php, yii

当我在配置中关闭 URL 管理器时

```
index.php?r=cars/car_detail&id=2&type=delete 
```

显示预期结果是删除我的控制器代码是：

```
public function actionCar_detail($id = 0, $type = '')
{
     die($type);
     //codes
} 
```

当我打开 URL 管理器时，类型为空，为什么它的行为不同？请帮我解决这个问题已经有一段时间了。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T18:04:32.860

在上述情况下，url 将变为

```
index.php/cars/car_detail/id/2/type/delete 
```

以上将输出`print_r($_GET);`

```
Array
(
    [id] => 2
    [type] => delete
) 
```

根据需要使用变量。

一般来说，语法是：

```
controller/method/param1/value1/param2/value2/...... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T18:47:37.670

在 url 管理器中工作，url 结构默认为 /controller/actionname?params

所以

```
 /index.php?r=cars/car_detail&id=2&type=delete 
```

在 url 管理器中，这意味着只需查询字符串 r
以将其格式化为默认 url

```
/car/car_details?id=2&type=delete 
```

此 url 将转到汽车控制器，然后操作 car_details 并设置参数 id 和 type

# javascript - 获取 twitter 引导单选按钮的值。jQuery

> ID：13348672
> 
> 赞同：12
> 
> 时间：2012-11-12T17:42:30.540
> 
> 标签：javascript, jquery

我正在使用来自 twitter bootstrap 的单选按钮：http: [//twitter.github.com/bootstrap/javascript.html#buttons](http://twitter.github.com/bootstrap/javascript.html#buttons)。

在我的 html 中看起来像这样：

```
 <div class="btn-group" data-toggle="buttons-checkbox">
  <button type="button" class="btn">Left</button>
  <button type="button" class="btn">Middle</button>
  <button type="button" class="btn">Right</button>
  </div>
  <input type="submit" onclick="get_the_value_and_do_something_with_it" 
```

我想知道如何通过 Jquery 或 Javascript 获取用户检查的按钮的值。

我看到了关于这个主题的几个问题，但我认为这种按钮有所不同，因为它们看起来不接受“已检查”属性。

非常欢迎任何帮助

PS：如果有人知道如何默认检查其中一个按钮，那也会对我有很大帮助。谢谢你。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-11-12T17:50:37.213

正如标签所说的那样`button`，为此，您应该按照它的建议进行操作，并使用这些按钮...这是一个简单的示例：

```
<input type="hidden" id="alignment" value="" />
<div class="btn-group alignment" data-toggle="buttons-checkbox">
    <button type="button" class="btn">Left</button>
    <button type="button" class="btn">Middle</button>
    <button type="button" class="btn">Right</button>
</div> 
```

现在是 jQuery：

```
$(".alignment .btn").click(function() {
    // whenever a button is clicked, set the hidden helper
    $("#alignment").val($(this).text());
}); 
```

提交后，您将在`alignment`隐藏字段中找到该值。

这是一个基本示例：http: [//jsbin.com/oveniw/1/](http://jsbin.com/oveniw/1/)

* * *

需要注意的一件好事是，在单击时，元素会发生变化，并且引导程序`active`会在单击的按钮上附加一个类名。

您始终可以使用它来更改`hidden field`，但如果我想自己提交表单，我会继续执行我的示例。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-11-12T17:51:28.463

您可以通过将其类设置为“活动”来“检查”按钮：

```
<div class="btn-group" data-toggle="buttons-checkbox">
  <button type="button" class="btn">Left</button>
  <button type="button" class="btn active">Middle</button>
  <button type="button" class="btn">Right</button>
</div> 
```

要获得一个值，你应该有一个“值”数据，例如：

```
<div class="btn-group" data-toggle="buttons-checkbox" id="my_radiogroup">
  <button type="button" class="btn" data-value="0">Left</button>
  <button type="button" class="btn active" data-value="1">Middle</button>
  <button type="button" class="btn" data-value="2">Right</button>
</div> 
```

这样，您可以通过以下方式获得价值：

```
$("#my_radiogroup .active").data("value");
>>> 1
(but may, of course, be undefined if no button is checked) 
```

`<input type=hidden>`但请记住，除非您有实际存储所选数据的权限，否则该值不会发布在您的表单中。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-03-05T05:05:50.397

没有理由让这变得复杂。

假设您有一个按钮组，用于选择某些东西是活动的还是非活动的......就像这样......

```
<div class="btn-group" data-toggle="buttons-radio">
    <button type="button" class="productStatus btn btn-success" value="1">Yes</button>
    <button type="button" class="productStatus btn btn-danger" value="0">No</button>
</div> 
```

当你运行一个函数或任何东西来收集你选择的按钮时，你会运行这个命令......这会让你得到你选择的单选按钮的值。当您单击一个按钮或更多按钮时，当它被“选中”时，它会像以前的答案一样被赋予“活动”类。这就是你真正需要寻找的。下面这个小片段。

```
var active = $('.productStatus[class*="active"]').val();
alert(active); 
```

基本上它使用通配符选择器寻找这个“productStatus”按钮类，然后返回具有“活动”类的按钮的值。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-07-17T09:46:55.997

当多个 Bootstrap 单选按钮超过一个时，我使用这个钩子

```
$('div[data-toggle="buttons-radio"] .btn').click(function(){
    $('input[name="' + $(this).parent().attr('id') + '"]').val($(this).val());
}); 
```

在 HTML 中：

```
<div class="btn-group" id="rental" data-toggle="buttons-radio">
    <button type="button" class="btn" value="0">Sale</button>
    <button type="button" class="btn" value="1">Rent</button>
</div>

<input type="hidden" name="rental" value="0"> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-12T17:50:50.807

你可以得到如下选择：

```
$('.btn-group button.btn.active') 
```

To, 设置一个按钮激活

```
$(selector).addClass('active') 
```

例如，如果要将第一个按钮设置为活动状态：

```
$('.btn-group button.btn:eq(0)').addClass('active') 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-03-01T12:34:42.790

您可以在函数中提交表单或提交按钮的任何单击事件时检查单选按钮的值

```
alert($('.btn-group > .btn.active').attr("value")); 
```

# bash - 检查 bash 脚本参数不起作用

> ID：13348683
> 
> 赞同：1
> 
> 时间：2012-11-12T17:43:14.533
> 
> 标签：bash, unix

我正在编写一个运行其他命令的 bash 脚本，例如调用 yum 来安装软件包列表，并且我希望我的脚本默认情况下使其他命令静音，但如果我传递 -v 参数则让它们输出。我遇到的问题是检查 $1 的值似乎没有正常工作。鉴于以下代码，我的脚本将始终回显“是”：

```
if [[ "$1"=="-v" ]]; then
    echo "Yes"
else
    echo "No"
fi 
```

如果我只是回显 $1 并将脚本传递给 -v，它会回显 -v。我在这里想念什么？

**编辑：** 找到了。继续使用脚本并将第一行更改为：

```
if [[ $1 == "-v" ]]; then 
```

现在工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T17:46:24.673

您需要在支票周围添加一些空格： `if [[ "$1" == "-v" ]]; then`

# c - scanf() 损坏了 malloc 区域

> ID：13348687
> 
> 赞同：0
> 
> 时间：2012-11-12T17:43:39.333
> 
> 标签：c, malloc

我的代码有问题：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
typedef struct hashTable{
char *data;
struct hashTable *next;
}HASHTABLE;

HASHTABLE **linkedHashTable[100];
void SaveHashTable1(char *str2,char *str3)          //s retazenim---Linked List
{
int hashResult;
HASHTABLE* linkedHashTableNode=NULL, *new_;

hashResult=StringToInt(str2);

if(linkedHashTable[hashResult]==NULL)
{
    linkedHashTableNode=(HASHTABLE*)malloc(sizeof(HASHTABLE));

    linkedHashTableNode->data=(char*)malloc(strlen(str3)*sizeof(char));
    strcpy(linkedHashTableNode->data,str3);

    linkedHashTableNode->next=NULL;
    linkedHashTable[hashResult]=&linkedHashTableNode;
}
else
{
    linkedHashTableNode=*linkedHashTable[hashResult];
    while(linkedHashTableNode->next!=NULL)
        linkedHashTableNode=linkedHashTableNode->next;

    new_=(HASHTABLE*)malloc(sizeof(HASHTABLE));

    new_->data=(char*)malloc(strlen(str3)*sizeof(char));
    strcpy(new_->data,str3);
    new_->next=NULL;
    linkedHashTableNode->next=new_;
}

 }
 int main(void)
 {
char *str1=NULL, *str2=NULL, *str3=NULL;
int i;

while(1)
{
    scanf("%s ", str1);
    if((strcmp(str1, "save"))==0)       //SAVE
    {
        scanf("%s %[^\n]s", str2, str3);

        SaveHashTable1(str2, str3);
    }
}
} 
```

这是代码的一部分，当我尝试执行此操作时，我遇到了问题：

```
linkedHashTableNode->data=(char*)malloc(strlen(str3)*sizeof(char));
strcpy(linkedHashTableNode->data,str3); 
```

我总是在scanf（）的内存区域附近获得内存空间，所以当我再次从控制台读取数据时，原始数据会被重写。我不知道哪里有问题。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T17:46:43.230

您没有在`malloc`通话中请求足够的内存。`strlen`告诉您字符串中有多少个字符，*不包括终止 NUL*，但`strcpy`无论如何都会复制终止 NUL 字符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T18:43:09.117

在我看来，你有几个问题。

首先，scanf() 函数使用起来可能有点冒险，因此您可能需要考虑修改 main 以便使用gets() 一次获取一行，然后解析输入行。然而，这不是一个表演的终结者。

在 main() 中，您需要为 str1、str2 和 str3 分配内存。它们是您问题中指向 NULL 的指针。请参阅[scanf 手册页](http://www.cplusplus.com/reference/clibrary/cstdio/scanf/)。

我建议您查看以下修改后的应用程序版本。仍在使用 scanf() 但是您应该考虑其他一些更改。

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
typedef struct hashTable{
    char  *data;
    struct hashTable *next;
}HASHTABLE;

HASHTABLE *linkedHashTable[100];

// stub version of StringToInt() so that it will compile and I can
// do a couple of simple tests in the debugger.
int StringToInt(char *str2)
{
    return 1;
}

void SaveHashTable1(char *str2,char *str3)          //s retazenim---Linked List
{
    int hashResult;
    HASHTABLE *new_;

    hashResult=StringToInt(str2);

    new_ = (HASHTABLE *)malloc(sizeof(HASHTABLE));
    if(linkedHashTable[hashResult] != NULL)
    {
        // since there is at least one entry in the table, lets traverse the list
        // until we reach the end.  we will then append our new entry onto the end.
        HASHTABLE *linkedHashTableNode;
        HASHTABLE *lastLinkedHashTableNode;

        linkedHashTableNode = linkedHashTable[hashResult];
        while(linkedHashTableNode != NULL) {
            lastLinkedHashTableNode = linkedHashTableNode;
            linkedHashTableNode = linkedHashTableNode->next;
        }
        lastLinkedHashTableNode->next = new_;
    } else {
        linkedHashTable[hashResult] = new_;
    }

    new_->data = (char *)malloc(strlen(str3) + 1);
    strcpy(new_->data, str3);
    new_->next=NULL;
}

int main(void)
{
    char  str1[128], str2[128], str3[128];

    while(1)
    {
        scanf("%s ", str1);
        if((strcmp(str1, "save"))==0)       //SAVE
        {
            scanf("%s %[^\n]s", str2, str3);
            SaveHashTable1(str2, str3);
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T17:47:12.780

您应该注意到，`strlen("hello world") == 11`但是“hello world 需要`char[12]`存储

`strlen(str3)`返回 char 的数量，`str3`但不计算`'\0'`结束时的汽车`strlen3`

因此 strcpy 无法复制结束字符串 caractere

# android - ACTION_REQUEST_ENABLE 意图的 startActivityForResult() 大约需要 6 秒

> ID：13348689
> 
> 赞同：1
> 
> 时间：2012-11-12T17:43:52.267
> 
> 标签：android, android-activity, bluetooth

我需要显示“您要打开蓝牙吗？” 我的 Android 应用程序中的对话框。

为此，我刚刚从[官方 android 文档](http://developer.android.com/guide/topics/connectivity/bluetooth.html)中获取了代码。

从我的活动 OnCreate() 方法中，我执行以下操作：

```
if (!mBluetoothAdapter.isEnabled()) {
    Intent enableBtIntent = new Intent(BluetoothAdapter.ACTION_REQUEST_ENABLE);
    startActivityForResult(enableBtIntent, REQUEST_ENABLE_BT);
} 
```

**有用。但是对话框出现大约需要 6 秒！**

对应的logcat：

```
01-06 06:53:04.789 I/ActivityManager(  313): START {act=android.bluetooth.adapter.action.REQUEST_ENABLE cmp=com.android.settings/.bluetooth.RequestPermissionActivity u=0} from pid 6512
01-06 06:53:04.812 I/ActivityManager(  313): START {act=com.android.settings.bluetooth.ACTION_INTERNAL_REQUEST_BT_ON cmp=com.android.settings/.bluetooth.RequestPermissionHelperActivity u=0} from pid 907
01-06 06:53:09.843 I/ActivityManager(  313): Displayed com.android.settings/.bluetooth.RequestPermissionActivity: +5s36ms (total +5s114ms)
01-06 06:53:09.843 I/ActivityManager(  313): Displayed com.android.settings/.bluetooth.RequestPermissionHelperActivity: +5s28ms 
```

**这种异常缓慢的原因可能是什么？我该如何调试/修复它？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T20:01:19.267

我认为您的问题可能在这里：

1.  `onPause()`，`onStop()`或`onSaveInstanceState()`使重负荷。
2.  您的应用程序正在使用大量内存，因此窗口管理器等待垃圾收集器
3.  您对服务或异步进程造成了沉重的负担
4.  您填充 IPC（进程间通信）内存，但这可能不是您的原因。

我想你的问题可能是第一个。尝试检查并告诉我们您发现了什么。

# javascript - 使用 JavaScript 从给定目录获取图片

> ID：13348692
> 
> 赞同：5
> 
> 时间：2012-11-12T17:44:08.937
> 
> 标签：javascript, microsoft-metro, winjs

我正在使用 JavaScript 开发 Windows 8 应用程序。我需要获取给定目录中存在的所有图片（每张图片的路径）。我该怎么做？

我有以下内容：

```
(function () {
    "use strict";
    var page = WinJS.UI.Pages.define("/html/scenario3.html", {
        ready: function (element, options) {
            document.getElementById("folder").addEventListener("click", pickFolder, false);
        }
    });

    function pickFolder() {
        // Clean scenario output
        WinJS.log && WinJS.log("", "sample", "status");

        // Verify that we are currently not snapped, or that we can 
        // unsnap to open the picker
        var currentState = Windows.UI.ViewManagement.ApplicationView.value;
        if (currentState === Windows.UI.ViewManagement.ApplicationViewState.snapped && !Windows.UI.ViewManagement.ApplicationView.tryUnsnap()) {
            // Fail silently if we can't unsnap
            return;
        }

        // Create the picker object and set options
        var folderPicker = new Windows.Storage.Pickers.FolderPicker;
        folderPicker.suggestedStartLocation = Windows.Storage.Pickers.PickerLocationId.desktop;
        // Users expect to have a filtered view of their folders depending on the scenario.
        // For example, when choosing a documents folder, restrict the filetypes to documents for your application.
        folderPicker.fileTypeFilter.replaceAll(["*"]);
        //folderPicker.fileTypeFilter.replaceAll([".png", ".jpg", ".jpeg"]);

        folderPicker.pickSingleFolderAsync().then(function (folder) {
            if (folder) {
                // Application now has read/write access to all contents in the picked folder (including sub-folder contents)
                // Cache folder so the contents can be accessed at a later time
                Windows.Storage.AccessCache.StorageApplicationPermissions.futureAccessList.addOrReplace("PickedFolderToken", folder);

                var pictures = Windows.Storage.KnownFolders.folder;
                pictures.getFilesAsync().done(function (images) {
                    console.log(images.length + " images found.");
                    WinJS.log && WinJS.log("Total Images: " + images.length, "sample", "status");
                });

            } else {
                // The picker was dismissed with no selected file
                WinJS.log && WinJS.log("Operation cancelled.", "sample", "status");
            }

        });
    }
})(); 
```

如果我使用上面的代码，它会给出以下错误：

`Unable to get property 'getFilesAsync' of undefined or null reference`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-12T18:54:29.080

如果您需要从图片库加载图片，您首先需要检查`package.appxmanifest`项目文件内的“功能”选项卡中是否启用了此功能。

启用后，您可以使用以下内容引用此库：

```
// 'pictures' is a reference to our Pictures Library
var pictures = Windows.Storage.KnownFolders.picturesLibrary; 
```

微软决定任何超过 50 毫秒的操作都需要是异步的，因此要从这个库中获取图像，我们必须使用以下异步方法，并在 promise 解决时处理结果：

```
// Get a list of files ('images') within our Pictures Library
pictures.getFilesAsync().done(function( images ) {
    console.log( images.length + " images found." );
}); 
```

从这里您可以遍历找到的图像并根据需要处理它们。

有关更多信息，请查看[`Window.Storage`](http://msdn.microsoft.com/en-us/library/windows/apps/br227346.aspx)命名空间。

此外，您可能会发现[文件访问示例](http://code.msdn.microsoft.com/windowsapps/File-access-sample-d723e597/view/SourceCode)也很有帮助。

### 更新

从您更新的代码中，我可以看到您允许用户选择他们选择的文件夹。有了这个，你需要设置，然后在承诺解决`fileTypeFiltering`后拉取图像：`pickSingleFolderAsync`

```
// Prompt user to select a folder
var picker = Windows.Storage.Pickers.FolderPicker();

// Which file types will we be showing?
picker.fileTypeFilter.append(".jpg");

// Grab the selected folder, reference as 'folder'
picker.pickSingleFolderAsync().then(function (folder) {
    // Get files within selected folder as 'files'
    folder.getFilesAsync().then(function (files) {
        // Output number of files found
        console.log(files.length + " files found.");
    });
}); 
```

# java - 将依赖项添加到 Android 应用程序后出错

> ID：13348693
> 
> 赞同：1
> 
> 时间：2012-11-12T17:44:09.567
> 
> 标签：java, android, maven, dependencies, dalvik

我正在开发一个 Android 应用程序，我正在尝试向我的 pom.xml 文件添加一个依赖项：

```
 <dependency>
        <groupId>org.simpleframework</groupId>
        <artifactId>simple-xml</artifactId>
        <version>2.6.7</version>
    </dependency> 
```

我什至没有在任何地方使用它，但是在添加该依赖项后，当我尝试运行应用程序时，出现错误：

```
 Conversion to Dalvik format failed with error 1

 Ill-advised or mistaken usage of a core class (java.* or javax.*)
 when not building a core library. 
```

为什么我不能运行它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T17:53:38.763

尝试从简单导入中排除 stax、stax-api 和 xpp3，如下所述： [Android：错误包括/重新打包引用 javax 核心类的依赖项](https://stackoverflow.com/questions/5964668/android-error-including-repacking-dependencies-who-reference-javax-core-classes)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T18:50:48.240

Dalvik/Android 不允许使用 javax.* 包。您必须使用 Maven Shade 插件对所有这些进行遮蔽，或者更好地使用不这样做的依赖项。

可能有一个 android 特定版本的 simple-xml 库可用。如果您需要它用于肥皂网络服务，您可能想看看[ksoap2-android](http://code.google.com/p/ksoap2-android/)。

# windows - 有没有办法在 ms-dos(cmd) 中下移一个目录？

> ID：13348694
> 
> 赞同：0
> 
> 时间：2012-11-12T17:44:14.300
> 
> 标签：windows, batch-file, cmd, command-prompt

有没有办法使用 ms-dos 向下移动一个目录？即脚本和批处理文件。就像我知道您可以使用 ..\ 向上移动一个目录，但我需要在不知道目录名称的情况下向下移动一个目录。有这个命令吗？

所以如果我在 c:\new 我想要一个命令可以让我进入 c:\new\test\testing

不使用名称测试

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T17:48:47.103

当您向上移动目录时，只能有一个父级。所以有一个方便的方法来做到这一点是有意义的——`CD ..`

但是当你向下移动时，可能会有任意数量的孩子要移动。如果你不知道名字，你怎么可能知道要搬到哪一个呢？

迭代子目录很容易，例如，此时您可以 CD。您可以使用 GOTO 跳出循环，以便您任意转到找到的第一个文件夹。

```
for /d %%F in (*) do (
  cd "%%F"
  goto :break
)
:break 
```

# php - facebook 应用程序在非对象错误上调用成员函数 api()

> ID：13348695
> 
> 赞同：0
> 
> 时间：2012-11-12T17:44:16.907
> 
> 标签：php, facebook

我在 facebook 上有一个应用程序，它给了我以下错误：

```
Fatal error: Call to a member function api() on a non-object in 
/public_html/user/fbmin.php on line 7 
```

这是代码：

```
 try{             //here's line 7:
        $userdata= $facebook->api('/me');
        //request for user friends in app
        $frienddata=$facebook->api(array(
'method' => 'fql.query',
'query' => 'SELECT uid, name FROM user WHERE uid IN(SELECT uid2 FROM friend WHERE uid1 = me()) AND is_app_user = 1'
 ));}

catch (FacebookApiException $e) {
error_log($e);
$userdata = null;
$frienddata= null;
} 
```

奇怪的是，我在另一个页面上使用了相同的代码并且一切正常，我尝试通过编写使 $facebook 全球化

```
GLOBAL $facebook; 
```

在 try 语句之前，它仍然给出相同的错误，可能是什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T17:57:07.887

It is clear that `$facebook` is not yet initialized. In the other files (which work), look for a line like this:

```
$facebook = ... 
```

And you need that stuff in this file, too. Or perhaps there is a dedicated fb initialization file that you need to include.

# math - 将 2D 空间顺时针旋转角度“a”的矩阵 A

> ID：13348696
> 
> 赞同：0
> 
> 时间：2012-11-12T17:44:19.123
> 
> 标签：math, matrix, rotational-matrices

附图显示了问题和我的答案。

如果有人能告诉我它是否正确，我将不胜感激。![在此处输入图像描述](../Images/3b67e3aa586286b7495a60eb1e22583c.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T00:19:36.710

实际上要顺时针旋转空间，您需要逆时针旋转向量，这意味着您的答案不正确。您需要切换*α*的符号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-06T05:56:37.173

我认为这还取决于您是否将向量视为行或列。不同之处在于正弦上的符号。网站似乎从来没有讨论过这个。

# c# - 共享连接与个人

> ID：13348697
> 
> 赞同：0
> 
> 时间：2012-11-12T17:44:25.630
> 
> 标签：c#

我有一个支持的旧应用程序，并且遇到了以下共享 SQLConnection：

```
 private static SqlConnection cnSQL = new SqlConnection(ConfigurationManager.ConnectionStrings["SQL"].ConnectionString.ToString());
    private static SqlCommand cmdSQL = new SqlCommand(); 
```

现在，每次需要时都会打开和关闭此连接，但它仍然会出现零星错误，我相信这是因为它在用户之间共享（静态）。我的假设正确吗？我相信我最好在每个需要它的方法中创建一个新连接，而不是每个类都有一个。或者我可以删除静态选项，每页保持一个连接，而不必担心交叉用户污染？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T17:51:19.430

摆脱两者并在需要时声明和定义它们。

```
using (var conn = new SqlConnection(ConfigurationManager.ConnectionStrings["SQL"].ConnectionString.ToString()))
{
    using (var cmd = conn.CreateCommand())
    { ... }
} 
```

阅读[此答案](https://stackoverflow.com/a/9707060/4068)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T17:51:03.190

如果您尝试同时执行两个查询，那`static`肯定会发生坏事。

在您使用它的每种方法中创建一个新连接，`Dispose`最后将是我更喜欢的架构。我还将封装`SqlConnection`在工厂方法中的创建。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-12T17:51:33.703

静态成员在应用程序的实际实例中的代码的所有对象和方法之间共享，但在不同用户之间**绝不会共享。**

我会将连接字符串设为静态，但不会将连接本身设为静态。如您所说，在每种方法中打开一个新连接。连接池将确保物理连接保持打开状态。

```
public static readonly string ConnectionString connString =
    ConfigurationManager.ConnectionStrings["SQL"].ConnectionString.ToString(); 
```

...

```
private void SomeMethod()
{
    using (var conn = new SqlConnection(connString)) {
        string sql = "SELECT ...";
        using (var cmd = new SqlCommand(sql, conn)) {
            ...
        }
    }
} 
```

确保将代码嵌入到`using`-statements 中。这样即使发生异常也会释放资源。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-12T18:26:18.337

先生，恐怕必须在您调用执行函数之前启动连接，并在执行后立即关闭，无论结果是否失败。如果您在正确的时间关闭并处置分配的资源，是否保持静态都没有区别。启动连接的最佳模式是以下代码：

```
SqlCommand command = new SqlConnection("[The connection String goes here]").CreateCommand();

try
{
    command.Parameters.Add(new SqlParameter() { ParameterName = "ParameterA", Direction = ParameterDirection.Input, Value = "Some value" });

    command.Parameters.Add(new SqlParameter() { ParameterName = "ReturnValue", Direction = ParameterDirection.ReturnValue });

    command.CommandText = "[YourSchema].[YourProcedureName]";

    command.CommandType = CommandType.StoredProcedure;

    command.Connection.Open();

    command.ExecuteNonQuery();
}
catch (Exception ex)
{
    //TODO: Log the exception and return the relevant result.
}
finally
{
    if (command.Connection.State != ConnectionState.Closed)

        command.Connection.Close();

    SqlConnection.ClearPool(command.Connection);

    command.Connection.Dispose();

    command.Dispose();
} 
```

希望能帮助到你。

干杯

# c - 将用户输入存储在数组中并在 C 中将其打印回用户

> ID：13348698
> 
> 赞同：0
> 
> 时间：2012-11-12T17:44:25.417
> 
> 标签：c, arrays, string, pointers

我希望能够要求用户输入 12 个字符和整数，然后将其打印回给用户。字符是音符，整数是每个音符的长度，以秒为单位。

这是我的代码：

```
//Include Standard IO
#include <stdio.h>
#include <string.h>

//----------
//----------Main Function----------
//----------

int main()
{

//Request Notes off of the user
printf(" Please enter a musical sequence of 15 notes in capitals: ");
printf("\n Please use the # character if needed");
printf("\n Please enter the time you want each note to last in seconds");

//Declare and initialize a table of notes as chars
int notelist[12];
int*ptr;
ptr = notelist;
//Creating the array for the single notes
char note[3];
//Creating a variable for the beginning of the note
int start;
//Declare and initialize a table of integers for the length of each note
int notelength[20];
//Creating a variable for the length of the note
int time;
//Creating a variable for the loop so that it runs 15 times
int loop;

    //Creating a loop that will run 15 times for the 15 note values
    for(loop=1; loop<4; loop++)

    {
        //Request a note off the user
        printf("\n\n Please enter a note in capitals: ");
        //Taking the input from the user
        scanf("%s", note);

        //Ask the user for the length he/she wants each note to be
        printf("\n Please enter the length you want each note to be in seconds: ");
        //Taking the input from the user
        scanf("%d", &time);
        notelength[time]=time+1;
    }

    //Print the input from the user back
    for(start=1; start<4; start++)
    {
        scanf("%d", &*ptr++);
    }

    for(start=1; start<4; start++)
    {
        printf("%d", *ptr++);
    }

//Return 0 to let the OS know the program finished successfully
return 0;
} 
```

如何存储用户输入的 12 个音符和长度，并在循环结束时将其打印回给他们？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-22T14:50:12.123

您需要一个动态分配的堆栈来存储以后可以打印的所有笔记。任何数据结构书籍或在线教程都会有所帮助。

# java - 正则表达式 - 捕获重复数字（不是数字）

> ID：13348701
> 
> 赞同：2
> 
> 时间：2012-11-12T17:44:33.127
> 
> 标签：java, regex, numbers, repeat

我正在尝试用 Java 编写一个方法来检查字符串并允许它只包含数字和逗号。此外，不能有重复的数字。

例如：

*   `11,22,33`- 还行吧
*   `22,22,33`- 这不行

我已经使用正则表达式和（如下）的组合完成了它的初稿`Set<String>`，但正在寻找更好的东西，最好只使用正则表达式。

```
public boolean isStringOk(String codes) {
    if(codes.matches("^[0-9,]+$")){ 
        Set<String> nonRepeatingCodes = new LinkedHashSet<String>();
        for(String c: codigoRoletas.split(",")){
            if(nonRepeatingCodes.contains(c)){
                return false;
            }
            else{
                nonRepeatingCodes.add(c);
            }
        }
        return true;
     }
    return false;
} 
```

有谁知道这是否可以仅使用正则表达式？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-12T17:59:19.450

我怀疑这是可取的（正如 Jarrod Roberson 所提到的），因为对于您项目中的任何其他编码人员来说，这都很难理解。但仅使用正则表达式绝对是可能的：

```
^(?:(\d+)(?!.*,\1(?!\d)),)*\d+$ 
```

双重否定的前瞻性使其有点难以理解。但这里有一个解释：

```
^                # anchor the regex to the beginning of the string
(?:              # subpattern that matches all numbers, but the last one and all commas
    (\d+)        # capturing group \1, a full number
    (?!          # negative lookahead, that asserts that this number does not occur again
        .*       # consume as much as you want, to look through the whole string
        ,        # match a comma
        \1       # match the number we have already found
        (?!\d)   # make sure that the number has ended (so we don't get false negatives)
    )            # end of lookahead
    ,            # match the comma
)*               # end of subpattern, repeat 0 or more times
\d+              # match the last number
$                # anchor the regex to the beginning of the string 
```

请注意，这只是一般的正则表达式，而不是特定于 Java。在 Java 中，您需要转义每个反斜杠，否则它将无法进入正则表达式引擎：

```
^(?:(\\d+)(?!.*,\\1(?!\\d)),)*\\d+$ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-12T18:10:57.167

请注意，将正则表达式用于技术上的非正则语言可能很危险，尤其是对于大的、不匹配的字符串。如果你不小心，你可以引入指数时间复杂度。此外，正则表达式引擎必须执行一些后门技巧，这些技巧也会减慢引擎的速度。

`Pattern`如果您尝试其他解决方案并且它们给您带来问题，您可以使用捕获组以及和类以这种方式尝试`Matcher`以使您的代码更清晰：

```
private static final Pattern PATTERN = Pattern.compile("([\\d]+),?");

public static boolean isValid(String str) {
    Matcher matcher = PATTERN.matcher(str);
    Set<Integer> found = new HashSet<Integer>();
    while (matcher.find()) {
        if (!found.add(Integer.parseInt(matcher.group(1)))
            return false;
    }
    return true;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-12T19:48:28.943

这是我能想出的最不难看的正则表达式：

```
return codes.matches("^(?:,?(\\d+)(?=(?:,(?!\\1\\b)\\d+)*$))+$"); 
```

分解：

*   `,?`如果有一个逗号，则使用下一个逗号（即，它不是字符串的开头）。

*   `(\d+)`捕获组 #1 中的下一个数字

*   `(?=(?:,(?!\1\b)\d+)*$)`尝试匹配剩余的数字，检查每个数字以确保它与刚刚捕获的数字不同。

`\b`后向引用可防止对`11,111`. 它在其他任何地方都不需要，但`\d+`如果你愿意，你可以在每一个上添加一个，它可能会使正则表达式稍微更有效率。但是，如果您需要调整正则表达式以获得最佳性能，则使所有量词都具有所有格会产生更多效果：

```
"^(?:,?+(\\d++)(?=(?:,(?!\\1\\b)\\d++)*+$))++$" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-12T18:23:28.907

这个正则表达式会做

```
^(?=^\d+(?:,\d+)*$)(?!^.*?((?<=(?:^|,))\d+(?=[,$])).*?\1(?:$|,.*?)).*?$ 
```

`(?=^\d+(?:,\d+)*$)`检查有效格式，如 45 或 55,66,88,33

`(?!^.*?((?<=(?:^|,))\d+(?=[,$])).*?\1(?:$|,.*?))`如果有任何重复的数字，则不匹配..

`.*?`如果上述负前瞻返回 true，则匹配所有内容

在[这里工作](http://fiddle.re/6thp)

# amazon-ec2 - Amazon EC2 AutoScaling CPUUtilization 警报 - 数据不足

> ID：13348705
> 
> 赞同：12
> 
> 时间：2012-11-12T17:44:44.657
> 
> 标签：amazon-ec2, amazon-web-services, boto, autoscaling, amazon-cloudwatch

因此，我一直在 Python 中使用 Boto 来尝试配置基于 CPUUtilization 的自动缩放，或多或少与此示例中指定的完全一致：http: [//boto.readthedocs.org/en/latest/autoscale_tut.html](http://boto.readthedocs.org/en/latest/autoscale_tut.html)

然而，CloudWatch 中的两个警报都只报告：

> 状态详细信息：状态在 2012/11/12 16:30 UTC 更改为“INSUFFICIENT_DATA”。原因：未选中：初始警报创建

自动缩放工作正常，但警报根本没有获取任何 CPUUtilization 数据。对我可以尝试的事情有什么想法吗？

编辑：实例本身报告 CPU 利用率数据，而不是当我尝试在 CloudWatch 中以编程方式在 python 或界面中创建警报时。还启用了详细监控以防万一...

谢谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-12T18:33:35.650

AWS的[官方回答是这样的：](https://forums.aws.amazon.com/message.jspa?messageID=320355)

> 您好，转换到 INSUFFICIENT_DATA 状态（仅）存在固有延迟，因为警报会等待一段时间以补偿指标生成延迟。对于周期为 60 秒的警报，转换到 I_D 状态之前的延迟将在 5 到 10 分钟之间。
> 
> 约翰。

显然这是一个临时状态，很可能会自行解决。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-07-27T02:33:18.250

我不确定后端发生了什么，但是如果您比较警报历史记录，您将看到 AWS 删除了“单位”列，如果您只是修改警报而不进行任何更改，如 at7000ft 所说。所以删除脚本的单位列。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-11-21T15:23:23.293

确保警报的命名空间是“AWS/EC2”。

我知道这是原始问题之后的很长时间，但如果其他人通过谷歌找到这个问题，我遇到了同样的问题，结果证明我设置了警报的命名空间不正确。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-03-02T06:30:12.667

需要使用与创建警报相同的单位发布数据。如果您没有指定一个，它将是一个`<None>`单位。

单位可以在`aws put-metric-data`和`aws-put-metric-alarm`with中指定`--unit <value>`

单位`<value>`可以是：

*   秒
*   字节
*   位
*   百分
*   数数
*   字节/秒（每秒字节数）
*   位/秒（位/秒）
*   计数/秒（每秒计数）
*   无（未指定单位时的默认值）

单位也是区分大小写的，在你的脚本中要小心。

对于 CPUUtilization，您可以使用百分比。

在将第一个数据集发送到您的警报后（对于不详细的受监控实例，最多可能需要 5 分钟），警报将切换到 OK 或 ALARM 状态，而不是 INSUFFICIENT_DATA 状态。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-04-14T16:08:23.703

I had this problem. Make sure the metric name you use to create the alarm matches the actual metric name.

You can list your metrics with:

```
aws cloudwatch list-metrics --namespace=<NAMESPACE, e.g. System/Linux, etc> 
```

Find the metric and the MetricName. Make sure your alarm is configured for that metric.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-02-27T20:16:13.350

对于使用 CloudFormation 创建的 RDS CPUUtilization > 60 警报，我在 CloudWatch 中显示了相同的 INSUFFICIENT_DATA 警报状态。（“原因：未选中：初始警报创建”显示在详细信息下）。这是一个非常粗略的修复，但我发现通过选择警报，单击修改按钮，然后单击保存按钮（不更改任何内容），警报进入 OK 状态并且一切都是文件。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-07-20T13:50:44.883

我遇到了类似的问题，尽管我可以在 GUI 中看到指标，但我的警报一直处于 INSUFFICIENT_DATA 状态。

出现这种情况，因为我在创建警报时为度量指定了错误的单位。没有错误报告，但它从未变成绿色。

如果您不确定，最好避免指定它，AWS 将在后台进行正确匹配。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-03-13T15:23:42.917

据我所知，默认的公制分辨率是 5 分钟（如果你付钱，可以降低到 1 分钟，或者类似的东西），所以如果你的警报的测量周期低于那个，那么它会永久保持在一个`INSUFFICIENT_DATA`状态。就我而言，我有一个 1 分钟的 CPU 利用率测量周期，将其更改为 5 分钟可以解决状态问题。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-02-18T23:12:27.920

也遇到了这个问题，但出于不同的原因：我在 Cloudformation 模板中传递了 ES 集群 ARN 而不是域名。这很令人沮丧

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2015-08-18T18:23:07.593

有一个目录 /var/tmp/aws-mon/ 包含几个文件。一个是实例 ID。我所在的实例是从 AMI 创建的，该文件保留了旧的实例 ID。我刚刚对其进行了编辑并确保 /var/tmp/aws-mon/placement/availability-zone 也是正确的。警报几乎立即变为正常。

# c - 尝试从 getchar() 获取变量以将其值保留在简单的计算程序中

> ID：13348707
> 
> 赞同：1
> 
> 时间：2012-11-12T17:44:45.170
> 
> 标签：c, printf, calculator, scanf, getchar

我正在学习 C，我正在尝试创建这个程序，它要求依次输入一个运算符（+、-、*、%）、一个数字，然后使用 scanf、printf 和 getchar（）输入另一个数字。当我最后一次询问操作员时，它可以工作，但我必须先与操作员联系。

这是我想出的有效代码（但不是按顺序排列的）：

```
char operator;
int numbers[2];
int result;

printf("Enter the first number:");
scanf("%9d", &numbers[0]);
printf("Enter the second number:");
scanf("%9d", &numbers[1]);
printf("Enter operation:");
getchar();
operator = getchar();
if (operator == '+') {
result = numbers[0] + numbers[1];
} 
else if (operator == '-') {
result = numbers[0] - numbers[1];
}
else if (operator == '*') {
result = numbers[0] * numbers[1];
}
else if (operator == '/') {
result = numbers[0] / numbers[1];
}
else {
result = 0;
}

printf("%d", result); 
```

这是没有的代码：

```
printf("Enter operation:");
getchar();
char operator = getchar();
if (operator == '+') {
result = numbers[0] + numbers[1];
} 
else if (operator == '-') {
result = numbers[0] - numbers[1];
}
else if (operator == '*') {
result = numbers[0] * numbers[1];
}
else if (operator == '/') {
result = numbers[0] / numbers[1];
}
else {
result = 0;
}
printf("Enter the first number:");
scanf("%9d", &numbers[0]);
printf("Enter the second number:");
scanf("%9d", &numbers[1]);

printf("%d", result); 
```

这给出了一个随机变量。

如果代码不在一个块中，请原谅我，我尽可能按照说明进行操作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T17:48:52.843

赋值运算符的结果是“立即”计算的：表达式...

```
result = a + b; 
```

...不会`result`改变其值时`a`或`b`改变它们的值。

这就是为什么您的第一个片段按计划工作，而您的第二个片段显示垃圾，因为您首先尝试计算一些垃圾值的一些二进制操作的结果（`numbers`数组元素在分配有用的东西*之前*存储的内容），然后才尝试从用户那里得到一些输入。

到目前为止，该键`result`已经具有一定的价值，并且该值不会改变-当然，除非您进行第二次分配。)

修复这个程序很容易：只需将实际计算与输入部分分开即可。以便...

```
if (operator == '+') {
  result = numbers[0] + numbers[1];
} 
else if (operator == '-') {
  result = numbers[0] - numbers[1];
}
else if (operator == '*') {
  result = numbers[0] * numbers[1];
}
else if (operator == '/') {
  result = numbers[0] / numbers[1];
}
else {
  result = 0;
} 
```

...将*遵循*所有`printf/scanf`部分（显然，打印结果的部分除外）。顺便说一句，您可以`switch`用于相同的目的：

```
switch(operator) {
  case '+':
    result = numbers[0] + numbers[1]; break;
  case '-':
    result = numbers[0] - numbers[1]; break;
  case '*':
    result = numbers[0] * numbers[1]; break;
  case '/':
    result = numbers[0] / numbers[1]; break;
  default:
    result = 0;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-12T17:49:38.807

在第二部分中，您尚未读取 2 个数字的值，但您正在对它们进行操作。

顺便提一句：

而不是所有

```
if (operation == '+') 
// etc 
```

您可以查看 switch 语句。

```
switch(operator) {
   case '+'
       number[0] + number[1];
       break;
   // etc 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T17:48:26.777

看起来你有一个额外的电话`getchar()`

```
printf("Enter operation:");
getchar();
char operator = getchar(); 
```

应该

```
printf("Enter operation:");
char operator = getchar(); 
```

否则您可能会错过运算符，并且在进行数学运算之前您需要先阅读数字。

# java - 用循环存储数组并比较最大值和最小值

> ID：13348708
> 
> 赞同：1
> 
> 时间：2012-11-12T17:44:47.447
> 
> 标签：java, arrays, loops

程序成功编译并运行。但是，最低分数的值是错误的，我再次检查并无法弄清楚为什么请帮我解决这个问题

```
/* import neccessary component for the program*/
import java.util.*;

public class assign4 {

    /* create a input stream*/ 
    static Scanner console = new Scanner(System.in);

    public static void main(String[]args) {

        /* declare variables and strings*/
        int[] score;

        score = new int[10];
        String[] name;

        name = new String[10];
        String header = String.format("%10s%10s%8s%n", "Name", "Score", "Grade");
        int min = score[0];
        int max = score[0];
        char grade[];

        grade = new char[10]; 
        int maxindex = 0;
        int lowindex = 0;

        for (int i = 0; i <= 9; i++) {

            /* Get user's input for student's name and score*/   
            System.out.println("Please enter the student's name.");
            name[i] = console.nextLine();
            System.out.println("Please enter the student's score.( 0-100 )");
            score[i] = console.nextInt();

            if (score[i] > 80) {
                grade[i] = 'A';
            } else if (score[i] > 65) {
                grade[i] = 'B';
            } else if (score[i] > 40) {
                grade[i] = 'C';
            } else if (score[i] > 20) {
                grade[i] = 'D';
            } else {
                grade[i] = 'E';
            } 

            /* when the score is higher than the score, it become maximum score*/
            if (score[i] > max) {
                max = score[i];
                maxindex = i;
            } /* when the score is lower than the score, it become minimum score*/ else if (score[i]
                    < min) {
                min = score[i];
                lowindex = i;
            } /* when the score neither lower or higher than the score, it will be ignored and program         
             do nothing*/ else {} 

            /* avoid scanner skipping in order to capture user's input */
            console.nextLine();
        }

        /* print out the stored information of the students and show higest and lowest score */
        System.out.println();
        System.out.print(header);
        for (int i = 0; i <= 9; i++) {
            System.out.printf("%10s%10d%8s%n", name[i], score[i], grade[i]);
        } 
        System.out.printf("%s obtains lowest score of %d%n", name[lowindex], min);
        System.out.printf("%s obtains higest score of %d%n", name[maxindex], max); 

    }
} 
```

程序目的是收集10个人的分数和姓名，然后打印出姓名、分数、最高分、最低分和等级。另外，我刚加入这个网站，如果我提出和询问的方法是错误的，请告诉我，我很抱歉

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T17:49:29.337

您将其初始化`int min = score[0];`为 0，因为`score`它`int[]`以 0 作为每个条目的默认值。

您可能不会得到任何低于 0 的分数，因此`if(score[i]<min)`仅适用于负值。尝试`min`用初始化`Integer.MAX_VALUE`。

`max`用初始化也是一个好习惯`Integer.MIN_VALUE`，但在你的情况下应该没关系。

# jquery - IE9在jQuery.ajax“完成”方法上抛出错误

> ID：13348713
> 
> 赞同：4
> 
> 时间：2012-11-12T17:45:10.880
> 
> 标签：jquery, internet-explorer-9

我的代码可以在最新的 Chrome 和 Firefox 中运行。
然而，IE9 讨厌我（我也有同样的感觉）。

我得到的具体错误是：
`Object doesn't support property or method 'done'`

有问题的代码：

```
app.$.ajax({
                url: app.baseUrl + "Geos",
                contentType: "application/json",
                dataType: "json"
            }).done(function (data) {
                app.controls.ddlGeos.html('');

                for (var i = 0; i < data.d.length; i++) {
                    var geo = data.d[i];
                    var option = $(document.createElement("option"));

                    option.attr('value', geo.code);
                    option.html(geo.name);

                    app.controls.ddlGeos.append(option);
                };
            }).fail(function (xhr, status) {
                console.log("Error retrieving Geo list", xhr, status);
            }).always(function (data, status, xhr) {
                app.controls.ddlGeos.parent().find('#geo_ajax_image').remove();
                app.setSelectedValues(app.controls.ddlGeos, app.controls.hdnGeo.val());
            }); 
```

使这有点不正常的是，我手动加载了最新版本的 jQuery 1.8.2），如下所示：

```
// The following code allows us to run jQuery 1.8.2 independantly of the main jQuery
    if (!jq) {
        var script = document.createElement("script");
        script.src = 'https://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js';
        script.onload = script.onreadystatechange = function () {
            window.jq18 = jQuery.noConflict(true);
            app.init(window.jq18);
        };
        document.body.appendChild(script);
    } else {
        app.init(jq);
    } 
```

我这样做的原因是因为我正在编写一个非常旧的网络应用程序并且我无法覆盖 window.$ 所以我正在向我的应用程序发送最新的 jQuery 版本。
但是，我已经完成了一些控制台日志记录，并且在 ajax 调用被命中时加载了正确版本的 jQuery IS。 `app.$().jquery`输出`"1.8.2"`

**编辑**
好的，我想我知道部分问题。我在 2 个不同的 ASP.Net UserControls 中执行类似的代码（想想封装的网页）。他们都以这种方式加载 jQuery 1.8.2，因为两者都不能确定另一个存在。似乎 Firefox 和 Chrome 可以处理这个问题，但 IE 不知何故导致我的“onreadystatechange”事件触发两次（并且不知何故其中一个在没有正确版本的 jquery 的情况下发生）。
我可以做些什么来修改该 jquery 加载代码以确保它只发生一次？我这样称呼它：

```
(function (jq) {
    // All my "app" code here
    app = {
        init : function($) {
            app.$ = $ || window.$;
            // Other code
        }
    };

    if (!jq) {
        var script = document.createElement("script");
        script.src = 'https://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js';
        script.onload = script.onreadystatechange = function () {
            window.jq18 = jQuery.noConflict(true);
            app.init(window.jq18);
        };
        document.body.appendChild(script);
    } else {
        app.init(jq);
    }
})(window.jq18); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T18:50:01.393

IE9 好像`readyState`有`"uninitialized"`,`"loading"`和`"complete"`. 这些之间的转换似乎`onreadystatechange`在 IE 中触发。`onload`最终*也被*确定了，因此您要多次初始化所有内容。我不确定这如何导致奇怪的返回值`$.ajax`，但显然删除它可以修复它。

# android - Android - 在 4.0+ 设备 AsyncTask 上下载失败

> ID：13348714
> 
> 赞同：0
> 
> 时间：2012-11-12T17:45:22.043
> 
> 标签：android, android-asynctask

我有一个 AsyncTask 一个一个下载文件，当它在 android 2.x 上运行时，我将它作为一个队列，很好。在 android 4.0+ 中它停止工作。这里我给 AsyncTask 传递了一个 ProgressBar，所以它会更新加载进度条，并指出它在哪里。

奇怪的部分是进度条会很快 100% 不匹配文件的实际大小。而且logcat中文件输出的长度也错误...

所有任务都将串行执行，因此不会损害 SDK 11 以上的并行限制。我想问题可能出在下载部分，只是不知道它在哪里。

```
public function download ()
{
    .....
    if (task != null) {
        task.cancel (true);
    }
    task = new OnlineDownloadTask (progress);
    task.execute (url, path);
    .....
}

class OnlineDownloadTask extends AsyncTask<String, String, String> {

        private final WeakReference<OfflineQueueIndicatorView> progressbarReference;

        public OnlineDownloadTask(OfflineQueueIndicatorView progress) {
            progressbarReference = new WeakReference<OfflineQueueIndicatorView>(
                    progress);
        }

        @Override
        protected void onPreExecute() {
            super.onPreExecute();
        }

        @Override
        protected String doInBackground(String... aurl) {
            int count;

            try {

                URL url = new URL(aurl[0]);
                HttpURLConnection conn = (HttpURLConnection) url
                        .openConnection();
                conn.setConnectTimeout(10000);
                conn.setReadTimeout(10000);
                conn.setRequestMethod("GET");
                conn.setAllowUserInteraction(false);
                conn.setDoInput(true);
                conn.setDoOutput(true);
                conn.connect();

                int lengthOfFile = conn.getContentLength();

                android.util.Log.v("offline.downloader", lengthOfFile + "");
                InputStream input = new BufferedInputStream(url.openStream());
                OutputStream output = new FileOutputStream(aurl[1]);

                try {
                    byte data[] = new byte[1024];

                    long total = 0;

                    while ((count = input.read(data)) != -1) {
                        total += count;
                        publishProgress(""
                                + (int) ((total * 100) / lengthOfFile));

                        if (stopoffline) {
                            android.util.Log.v("file.downloader", "stopped");
                            break;
                        }
                        output.write(data, 0, count);
                    }

                    if (stopoffline) {
                        output.flush();
                        output.close();
                        input.close();
                        conn.disconnect();
                        File file = new File(aurl[1]);

                        if (file.exists()) {
                            file.delete();
                        }

                        stopoffline = false;
                        return null;
                    } else {
                        output.flush();
                        output.close();
                        input.close();
                        conn.disconnect();

                        if (DiskCache.getInstance().offlineDirectoryExist(
                                DiskCache.getInstance().offlineCurrentFolder)) {

                        } else {
                            if (!DiskCache
                                    .getInstance()
                                    .makeOfflineFolder(
                                            DiskCache.getInstance().offlineCurrentFolder)) {
                                return null;
                            }
                        }

                        android.util.Log.v("offline",
                                DiskCache.getInstance().offlineCurrentFolder);
                        unzip(aurl[1],
                                DiskCache.getInstance().offlineCurrentFolder);
                        DiskCache.getInstance().deleteFile(aurl[1]);
                        return "succ";
                    }

                } finally {

                    if (output != null) {
                        output.flush();
                        output.close();
                    }

                    if (input != null) {

                        input.close();
                    }

                    if (conn != null) {
                        conn.disconnect();
                    }
                }
            } catch (Exception e) {

                e.printStackTrace();

            }
            return null;

        }

        protected void onProgressUpdate(String... progress) {
            try {
                if (progressbarReference != null) {
                    OfflineQueueIndicatorView p = progressbarReference.get();

                    if (p != null) {
                        int i = Integer.parseInt(progress[0]);
                        p.setProgress(i);
                    }
                }
            }

            catch (Exception e) {
                e.printStackTrace();
            }
        }

        @Override
        protected void onPostExecute(String ret) {

            try {
                if (progressbarReference != null) {

                    if (ret != null) {
                        queue.get(currentId).put("state", "complete");
                    } else {
                        if (queue != null) {
                            if (currentId != null) {
                                queue.get(currentId).put("state", "failed");
                            }
                        }
                    }

                }
            }

            catch (Exception e) {
                e.printStackTrace();
            }

            download();

        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T18:10:23.567

Android 4.0中的较新版本可能`HttpUrlConnection`导致服务器使用HTTP/1.1 中支持的[Chunked Transfer Encoding 。](http://en.wikipedia.org/wiki/Chunked_transfer_encoding)Android 2.x 版本可能不支持 CTE。当使用 CTE 发送响应时（例如，在文件/视频流传输期间），服务器不会返回内容长度。因此，您可能希望`ProgressBar`在内容长度不可用时显示不确定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T06:41:39.837

删除后我终于发现了问题`conn.setDoOutput(true)`所在，它在 android 2.x 和 4.x 模拟器上运行良好，我认为 acj 也有道理，有时分块传输编码也是原因。

# mysql - 高效地在数据库中添加好友逻辑

> ID：13348715
> 
> 赞同：0
> 
> 时间：2012-11-12T17:45:25.853
> 
> 标签：mysql, database-design

我期待将朋友列表存储在数据库中的逻辑。我正在考虑使用用户 ID 在数组中添加东西

示例：朋友表中用户 a 的数组将包含朋友的用户 ID 数组，例如 1、2、4、6、77、44 等

我想知道这是否是一种有效的方法。如果不是，应该为大型社区理想地实施什么逻辑？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T17:52:22.273

您可能需要一个单独的多对多连接表。为了实现这一点，如果用户和他们的朋友都驻留在同一个用户表中。该表可能如下所示：

user_id - 正在为其查找好友的用户 ID，是用户表中 user_id 字段的外键friend_id - 与用户关联的好友的 ID，也是用户表中 user_id 字段的外键

您将有一个跨两个字段的复合主键，确保每个 user_id 到friend_id 组合都是唯一的。

这将是示例 CREATE TABLE 语句：

```
CREATE TABLE `friends` (
`user_id` INT(11) NOT NULL,
`friend_id` INT(11) NOT NULL,
PRIMARY KEY (`user_id`, `friend_id`)
)
ENGINE = INNODB; 
```

样本数据可能如下所示：

```
INSERT INTO `friends` (`user_id`, `friend_id`)
VALUES
(1, 2), (1, 3), (1, 4), (2, 1), (2, 10), (4, 1), (4, 20); 
```

然后假设您想查找与特定用户（即登录用户）关联的朋友的所有用户表数据。您可以像这样查询该数据：

```
SELECT users.*
FROM users
INNER JOIN friends ON users.user_id = friends.friend_id 
WHERE friends.user_id = [The ID of current user] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T17:46:53.463

不不不！

不要在一个数据库字段中存储多个值。它会给你带来很多问题。

例如，您可以使用这样的结构

```
friends (user_id, user_id) 
```

这表示 2 个朋友。

# ajax - 如何使用 eID 访问 TYPO3 上的本地路径

> ID：13348720
> 
> 赞同：0
> 
> 时间：2012-11-12T17:45:49.193
> 
> 标签：ajax, typo3, fluid, extbase

我的前端有一个图像映射，从那里我需要访问一些存储在 fileadmin 目录下不同文件夹中的图像。我正在尝试使用 eID 来做这件事，按照这个例子：[http://www.alexanderschnitzler.de/2011/06/howto-ajax-requests-with-extbase-and-fluid/][1]

但我的问题是我只能访问一个目录。我无法根据前端的用户选择访问不同的目录。

这是我一直在尝试做的代码： **在我的控制器**上，我有一个 ajaxAction，我需要在其中提供一个目录的完整路径，因为我还没有弄清楚如何将目录 ID 传递给我的 ajaxAction，这可能是我的问题，也许是解决方案：

```
/**
 * @return void
 */
public function ajaxAction() {

    $image_file_path = "fileadmin/Images/Sattic/Amik/small";
    //$image_file_path = "fileadmin/Images/Sattic/'+$id+'";
    $d = dir($image_file_path) or die("Wrong path: $image_file_path");
    while (false !== ($entry = $d ->read())) {
        if($entry != '.' && $entry != '..' && !is_dir($dir.$entry)) 
        $images[] = $entry;
    }
    $d->close();

    rsort($images);
    return json_encode($images);
} 
```

在我的 index.html 上，我有一个 map 标记，当用户单击不同的区域时调用函数 updateImage(id) 并且我的 updataImage(id) 函数如下所示：

```
function updateImageGallery(id) {
console.log(id);

var ajaxUrl = "{f:uri.action(action:'ajax', pageType:'100101')}";

$.getJSON(ajaxUrl, function(data) {
    var items1 = [];
    var items2 = [];
    $data = data;
    console.log('dataLength: ' + $data.length);
    console.log('dataArray: ' + $data);

    $.each($data.slice(0, 4), function(key, val) {
        valLink = val.replace("small.", "");
        items1.push('<td><a href="fileadmin/Images/Sattic/' + id +'/'+ valLink +'" target="_blank"><img width="145" height="145" id="" src="fileadmin/Images/Sattic/' + id +'/small/'+ val +'"/></a></td>');
    });
    $('<tr/>', {
        html: items1.join('')
    }).appendTo('#glRegion');

    $.each($data.slice(4, 8), function(key, val) {
        valLink = val.replace("small.", "");
        items2.push('<td><a href="fileadmin/Images/Sattic/' + id +'/'+ valLink +'" target="_blank"><img width="145" height="145" id="" src="fileadmin/Images/Sattic/' + id +'/small/'+ val +'"/></a></td>');
    });
    $('<tr/>', {
        html: items2.join('')
    }).appendTo('#glRegion');

});
return false; 
```

}

我希望能够从 updateImageGallery(id) 函数传递目录的 id，这样我就可以获得每个目录的图像。

是否有可能做到这一点？我希望如此，我有 30 个不同的区域，如果我以现在的方式解决我的问题，我将需要使用 30 个不同的 eID。我想这可能是解决这个问题的更聪明的方法。

有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T19:11:04.563

您可以使用`t3lib_div::_GET('myid')`来访问`myid`get 变量。

我想你可以用`var ajaxUrl = "{f:uri.action(action:'ajax',**myid:id,** pageType:'100101')}";`它来设置它。

无论如何，请确保在 PHP 脚本中生成有效路径/ID 列表，并再次检查 get 参数。

# c# - 动态 SQL Server 查询以填充数据表

> ID：13348723
> 
> 赞同：-3
> 
> 时间：2012-11-12T17:46:00.427
> 
> 标签：c#, sql, sql-server

您好我需要在 SQL Server 中执行以下查询来填充和 Datatable。

就我而言，我有 3 张桌子：

```
1 - Users
2 - Process
3 - Status 
```

用户

```
id, name 
```

过程

```
id, cod_user, cod_status 
```

地位

```
id, status 
```

我需要进行一个返回下表的查询：

> ```
> 用户名 | 状态。已创建 | 状态。已打开 | 状态.完成
> 汤姆 50 30 20
> 罗杰 22 33 44
> 克里斯11 09 05
> ```

然后，我必须返回这个表来填充和数据表。

谢谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T20:53:45.750

看起来你正在尝试`PIVOT`数据，如果你知道`status`要转换的值，你可以使用这样的东西：

```
select name, [Created], [Opened], [Finalized]
from
(
    select u.name,
        s.status
    from users u
    left join process p
        on u.id = p.cod_user
    left join status s
        on p.cod_status = s.id
) src
pivot
(
    count(status)
    for status in ([Created], [Opened], [Finalized])
) piv 
```

如果您有未知数量的状态要变成列，那么您可以使用动态 sql：

```
DECLARE @cols AS NVARCHAR(MAX),
    @query  AS NVARCHAR(MAX)

select @cols = STUFF((SELECT distinct ',' + QUOTENAME(status) 
                    from status
            FOR XML PATH(''), TYPE
            ).value('.', 'NVARCHAR(MAX)') 
        ,1,1,'')

set @query = 'SELECT name, ' + @cols + ' from 
             (
                select u.name,
                    s.status
                from users u
                left join process p
                    on u.id = p.cod_user
                left join status s
                    on p.cod_status = s.id
            ) x
            pivot 
            (
                count(status)
                for status in (' + @cols + ')
            ) p '

execute(@query) 
```

如果您无权访问该`PIVOT`函数，则可以使用聚合函数和`CASE`语句复制它：

```
select u.name,
    sum(case when s.status = 'created' then 1 else 0 end) created,
    sum(case when s.status = 'opened' then 1 else 0 end) opened,
    sum(case when s.status = 'finalized' then 1 else 0 end) finalized
from users u
left join process p
    on u.id = p.cod_user
left join status s
    on p.cod_status = s.id
group by u.name 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T20:47:48.187

看起来您正在尝试为每个用户显示一条记录，每个状态有一列，并且这些列包含 Process 表中该用户具有该状态的记录数？

如果这是正确的，那么您想使用数据透视表。

# asp.net - 放置一个计时器并监控并在其到期时采取某些行动

> ID：13348728
> 
> 赞同：1
> 
> 时间：2012-11-12T17:46:25.547
> 
> 标签：asp.net, asp.net-mvc-3

我正在开发一个在线测验网站，用户可以在其中进行测试（多项选择）。我需要在测试中放置一个计时器说如果测试的制造商将时间设置为 30 分钟，一个计时器将被放置在页面顶部倒计时，现在我想在服务器端监控计时器到 00:00 测试将停止并显示获得的分数。

**我考虑过的解决方案：**

1) 要使用 JS 插件，并在其到期时执行`location.href`一些`ActionResult`将结束测试的操作。

2）要创建一个会话并在给定时间之后并在呈现每个问题之前将其清除，请检查该会话是否已过期。

我对使用基于 javascript 的解决方案的担忧是它的稳健性，我想实现一个服务器端解决方案。请帮助我找到正确的路径...

问候。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T17:56:39.873

When using the timer in the browser there is no way to verify that it is running as expected. User can disable javascript and get around your restrictions; heck they can even change your javascript. So relying solely on javascript is not an option.

The best solution is to validate postbacks on server side. You can use javascript on Client side to inform the user so that they are aware of how much time is left and server side to verify they have not gone over the time limit. If synchronization is required, then you can have the javscript ping back every so often to resynch the time.

**Expanded Answer** The time of the start of the test should be on the server side. Whenever the user clicks begin test or other start buttton to begin their test. The server should note the current time - perhaps in a session or even in database.

The user should then be informed of the time remaining via javascript and expected end time. These are then updated whenever the user submits a question or perform another postback to the server.

The end time will be the fuzzy part. If the javascript does it's job correctly; you can inform the user their test has ended through this (or window.href etc). If the javascript is not worked; then the user will receive their notification whenever they next attempt to submit something to the server.

Either way, the user should clearly be informed that this is the expected end time, and how much time they have remaining on each page load.

# xaml - 将 XAML 图像渲染到 windows phone 应用程序中

> ID：13348729
> 
> 赞同：0
> 
> 时间：2012-11-12T17:46:31.733
> 
> 标签：xaml, windows-phone-7.1

我想在 Windows Phone 页面中呈现 XAML 图像。

可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T19:06:53.677

你可以把它放在你的视图中，或者使用我最近在[这里](https://stackoverflow.com/questions/13292179/best-way-to-use-a-vector-image-in-wpf)提到的相同方法。简短地说，是的，你可以在你的应用程序中渲染一个 xaml 图像就好了。我通常会尝试留下一两句话的答案，但在这种情况下不需要，希望这会有所帮助:)

# c++ - 如何指定其类被模板化（组合）的成员变量

> ID：13348734
> 
> 赞同：0
> 
> 时间：2012-11-12T17:46:47.207
> 
> 标签：c++, templates

下面的 HandleMessages 类有一个 ProtocolDecoder* 类型的成员变量。当 ProtocolDecoder 不是模板类时，这很好。现在我已经变成了这样，但是现在代码无法编译。

在运行时有一个工厂函数可以创建所需的解码器。

如果我不能有一个成员 m_Decoder 那么我怎样才能达到同样的效果呢？

如果我尝试将成员声明为 ProtocolDecoder* m_Decoder;

我得到编译器错误：错误 C2059：语法错误：'<'

并查看对正在编译的类模板实例化“LogPlayer”的引用

```
template <typename T>
class ProtocolDecoder 
{
public:
  virtual const char* ProtocolName() = 0;
  virtual ProtoWrapper<T>* DecodeMsg(const unsigned char* msg, int length) = 0;
 ...
};

class ABCDecoder : public ProtocolDecoder<ABC_msg>
{
public:
  virtual const char* ProtocolName() {return "ABC"; }

  virtual ProtoWrapper<ABC_msg>* DecodeMsg(const unsigned char* msg, int length);
};

//lots of different decoders derived from ProtocolHandler

class HandleMessages 
{
public:
void Process() {}

private:
//ProtocolDecoder<T>*      m_Decoder;  //Want a Protocol member variable - but don't know type until runtime
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T17:49:06.153

你不能在不指定模板参数的情况下使用模板对象，模板类型只有在所有参数都有值时才存在。

所以虽然`ProtocolDecoder<int>*`是真正的类型，`ProtocolDecoder<T>*`但不是。您在这里可能想要的是创建一个所有模板类都派生自的抽象基类。然后您可以简单地将它们向上转换为基本类型并以这种方式存储它们。

例如，

```
class BaseProtocolDecoder 
{
public:
  virtual const char* ProtocolName() = 0;
  virtual BaseProtoWrapper* DecodeMsg(const unsigned char* msg, int length) = 0;
 ...
};

template <typename T>
class ProtocolDecoder : BaseProtocolDecoder
{
public:
  const char* ProtocolName();
  BaseProtoWrapper* DecodeMsg(const unsigned char* msg, int length);
 ...
};

template<>
ProtocolDecoder<ABC_msg>
{
public:
  const char* ProtocolName() {return "ABC"; }

  BaseProtoWrapper* DecodeMsg(const unsigned char* msg, int length);
}; 
```

`ProtoWrapper<T>`出于同样的原因，您将需要做同样的事情

**注意：** 通常你会想要放弃模板而简单地使用继承，因为模板最终并不是绝对必要的。当然，这取决于情况，但偶尔查看模板代码并思考“我可以撕掉模板吗？”总是好的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T17:56:33.933

Without seeing the full template of ProtocolDecoder I can't sure for sure whether this will work for your application, but I would pull the interface into its own class. Then your HandleMessages() class just has a pointer/reference to the interface and doesn't care about the template.

Program to an interface, not an implementation: [What does it mean to "program to an interface"?](https://stackoverflow.com/questions/383947/what-does-it-mean-to-program-to-an-interface)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T17:57:03.373

```
class BaseWrapper
{
};

template <class T>
class ProtoWrapper: public BaseWrapper
{
};

class BaseDecoder
{
  virtual const char* ProtocolName() = 0;
  virtual BaseWrapper* DecodeMsg(const unsigned char* msg, int length) = 0;
};

template <typename T>
class ProtocolDecoder: public BaseDecoder
{
public:
 ... // template specific code
};

class ABCDecoder : public ProtocolDecoder<ABC_msg>
{
public:
  virtual const char* ProtocolName() {return "ABC"; }

  virtual ProtoWrapper<ABC_msg>* DecodeMsg(const unsigned char* msg, int length);
};

class HandleMessages 
{
public:
void Process() {}

private:
BaseDecoder*      m_Decoder;  //Want a Protocol member variable - but don't know type until runtime
}; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-12T18:08:23.487

补充一点已经说过的其他事情：我认为在这里做出决定的主要问题是模板是在编译时决定的，而您需要多态性或类似的东西才能在运行时做出类似的选择。

# eclipse - 我应该如何在 OSX 上开发 CUDA 以及在 Linux 上进行部署测试

> ID：13348741
> 
> 赞同：0
> 
> 时间：2012-11-12T17:47:35.107
> 
> 标签：eclipse, cuda

1.  我有一个 linux 盒子作为我的 CUDA 机器连线——它里面有 3 个 GPU 卡。
2.  我在 OSX 笔记本电脑上进行所有开发。

我应该如何设置我的开发周期，在我的笔记本电脑上开发并部署到 LINUX 机器上？

我选择的 IDE 是 eclipse，我使用 vi 作为备份。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T13:31:02.080

如果您的 Mac 确实支持 CUDA，那么您应该能够在其上安装 CUDA 并在本地完成大部分开发工作。您可以使用 Git 或 Mercurial 之类的版本控制系统将代码推送到 Linux 机器以进行所有测试（以防您不想在本地运行 CUDA），但这会使测试小的代码更改变得很慢，因为您必须提交并推送所有更改，然后它们才能在 Linux 机器上可用。

就个人而言，我更喜欢尽可能直接在目标机器上开发我的所有代码。我打开了几个 SSH 会话并使用 Vim 编写所有代码。这使我能够以很少的周转时间运行完整的测试。问题是您必须始终与测试盒保持良好的网络连接，否则开发将是一件非常痛苦的事情。

所以，总而言之，你有三个选择。

1.  在 Mac 上编写代码，在 Linux 上运行所有测试。使用 Git 或其他东西来推送更改。测试小的代码更改将是一个巨大的麻烦。
2.  在 Mac 上编写代码，在本地运行基本测试（您必须安装 CUDA）并偶尔针对 Linux 进行测试。测试通常会很有效，但您可能需要为两个平台重新进行性能优化。
3.  在 Linux 上编写代码，方法是从 Mac 打开 SSH 会话并使用 Vim 或任何你喜欢的东西编写代码。您需要与 Linux 机器保持一致、良好的网络连接。如果您有出色的连接，您可以想象使用 X 窗口共享从 Linux 运行 Eclipse。

# javascript - 如何在 Windows Mobile（7 及更高版本）上调试 Web 应用程序

> ID：13348743
> 
> 赞同：1
> 
> 时间：2012-11-12T17:47:37.673
> 
> 标签：javascript, internet-explorer, windows-phone-7, mobile, web

> **可能重复：**
> [如何在 Windows Phone 7 上调试 Internet Explorer？](https://stackoverflow.com/questions/5198808/how-do-i-debug-internet-explorer-on-windows-phone-7)

我已经构建了一个移动网络应用程序。它适用于 android 和 iphone，但不适用于 windows phone 7。我想为 windows phone 7 调试 javascript。我可以使用哪些工具来调试问题？

# node.js - 防止错误出现在 node.js 中的用户面前

> ID：13348750
> 
> 赞同：0
> 
> 时间：2012-11-12T17:47:58.550
> 
> 标签：node.js, error-handling, coffeescript, express

`express.js`当我使用in时，如何防止未捕获的错误被发送给用户`node.js`？

假设我设置了以下路线：

```
app.get "/err", (req, res) ->
  throw new Error "Something went wrong"
  res.send "Hello World", 200 
```

并处理我的异常：

```
process.on "uncaughtException", (err) ->
  console.log "OH NOES: UNCAUGHT EXCEPTION"
  console.log err.message, err.stack
  process.exit(1) #Exit with error 
```

不过，当我`/err`在浏览器中访问时，`Error: Something went wrong`会显示错误的堆栈跟踪。如果我将所有路线都放在`try/catch`-block 中，也会发生同样的事情。

我该如何防止这种情况？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T17:52:37.237

查看此页面以了解如何抑制错误输出：

[http://expressjs.com/guide.html#error-handling](http://expressjs.com/guide.html#error-handling)

# android - 为什么我在使用 OpenGLes/Android/NDK 时会出现奇怪的黑屏错误？

> ID：13348756
> 
> 赞同：1
> 
> 时间：2012-11-12T17:48:29.457
> 
> 标签：android, opengl-es, android-ndk, opengl-es-1.1, spritebatch

自从我从[诺基亚网站](http://projects.developer.nokia.com/spritebatchqt/browser/src_gles11spritebatch/GLES11SpriteBatch.cpp)“移植”了 spritebatch 代码以来，我遇到了一个非常奇怪的错误。它作为 POWERVR 模拟的桌面应用程序运行良好。但是在 Android 上，我只会看到一个空白屏幕（实际上是黑色的）。如果我只是尝试显示图像，就会发生这种情况，但它不会崩溃。

这就是奇怪的部分出现的地方：如果我`glGeterror();`输入更新功能，它就可以正常工作！（缓慢，但显示一切正常）和`geterror`代码返回`0`。我不知道发生了什么或如何调试它，因为我是 OpenGL 的新手，但在源代码中一切看起来都是正确的。我在代码周围吐了 geterrors 但没有任何线索。如果你想看一下，我已经附上[了我的项目。](http://gjteam.com.br/bareproject.zip)您将需要 Visual Studio + vsandroid 进行编译。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T03:29:24.873

显然问题不在于精灵批处理，而在于java代码。我更换了另一个使用表面视图并且不再获得这种深奥行为的人。

# php - PHP 使用 fsockopen/cURL 设置浏览器代理

> ID：13348764
> 
> 赞同：1
> 
> 时间：2012-11-12T17:49:09.757
> 
> 标签：php, curl, fsockopen, web-crawler

我写了一个爬虫，它显然被一些网站阻止了。我想做的是获取带有假用户代理 ID（类似`Mozilla/5.0 (Windows NT 6.1; WOW64; rv:7.0.1) Gecko/20100101 Firefox/7.0.12011-10-16 20:23:00`）的页面。请注意，`fsockopen()`不支持这一点，所以我试图以不同的方式做到这一点。

这是我的代码：

```
$sock = fsockopen($host, 80, $errno, $errstr, 30); 
```

然后在下面，这是我用指针做的事情：

```
 $request  = "HEAD "  . $path . " HTTP/1.1\r\n"; 
    $request .= 'Host: ' . $host . "\r\n"; 
    $request .= "Connection: Close\r\n\r\n"; 
    fwrite($sock, $request); 
```

同样，如何设置假浏览器代理？我可以在`$request`字符串中设置它吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-07-09T04:03:40.370

使用 fsockopen，您可以像添加其他 Headers 选项一样添加用户代理：

```
$sock = fsockopen($host, 80, $errno, $errstr, 30);

$request  = "HEAD "  . $path . " HTTP/1.1\r\n"; 
$request .= 'Host: ' . $host . "\r\n"; 
$request .= "User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:7.0.1) Gecko/20100101 Firefox/7.0.12011-10-16 20:23:00\r\n";
$request .= "Connection: Close\r\n\r\n"; 

fwrite($sock, $request); 
```

用 PHP5.3 测试

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T18:22:03.597

如果您使用 php cURL（如您在标签中建议的那样），您应该能够：

```
curl_setopt($ch, CURLOPT_HTTPHEADER, array('User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:7.0.1) Gecko/20100101 Firefox/7.0.12011-10-16 20:23:00')); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-28T22:41:44.137

这对我有用

```
$cookie = tempnam ("/tmp", "CURLCOOKIE");
$ch = curl_init();
curl_setopt( $ch, CURLOPT_USERAGENT, "Mozilla/5.0 (Windows; U; Windows NT 5.1; rv:1.7.3) Gecko/20041001 Firefox/0.10.1" );
curl_setopt( $ch, CURLOPT_URL, $url );
curl_setopt( $ch, CURLOPT_COOKIEJAR, $cookie );
curl_setopt( $ch, CURLOPT_FOLLOWLOCATION, true );
curl_setopt( $ch, CURLOPT_ENCODING, "" );
curl_setopt( $ch, CURLOPT_RETURNTRANSFER, true );
curl_setopt( $ch, CURLOPT_AUTOREFERER, true );
curl_setopt( $ch, CURLOPT_SSL_VERIFYPEER, false );    # required for https urls
curl_setopt( $ch, CURLOPT_CONNECTTIMEOUT, $timeout );
curl_setopt( $ch, CURLOPT_TIMEOUT, $timeout );
curl_setopt( $ch, CURLOPT_MAXREDIRS, 10 );
$content = curl_exec( $ch );
echo $content;
$response = curl_getinfo( $ch );
curl_close ( $ch ); 
```

# javascript - SecurityError：操作不安全 - window.history.pushState()

> ID：13348766
> 
> 赞同：68
> 
> 时间：2012-11-12T17:49:19.743
> 
> 标签：javascript, html, url, history, pushstate

我在 Firefox 的控制台中收到此错误：`SecurityError: The operation is insecure`而有罪的是 HTML5 功能：`window.history.pushState()`当我尝试使用 AJAX 加载某些内容时。它应该加载一些数据，但 Javascript 因错误而停止执行。

我想知道为什么会发生这种情况。这是一些服务器配置错误吗？任何帮助，将不胜感激。

更新：是的，这是域名不匹配的服务器错误：[http ://en.wikipedia.org/wiki/Same-origin_policy](http://en.wikipedia.org/wiki/Same-origin_policy)

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2012-11-12T17:52:31.950

确保您遵循[同源政策](http://en.wikipedia.org/wiki/Same_origin_policy)。这意味着相同的域、相同的子域、相同的协议（http 与 https）和相同的端口。

[pushState 如何防止潜在的内容伪造？](https://stackoverflow.com/questions/6193983/how-does-pushstate-protect-against-potential-content-forgeries)

编辑：正如@robertc 在他的评论中恰当地指出的那样，一些浏览器在原点为`file:///`. 更不用说`file:///`当页面期望它从不同的来源运行时在本地测试时会遇到问题（因此您`pushState`假设生产来源场景，而不是本地主机场景）

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2016-02-12T07:28:33.510

我们遇到了*SecurityError: The operation is insecure*当用户在访问我们的站点之前禁用了他们的 cookie 时，任何尝试使用会话的后续 XHR 请求显然会失败并导致此错误。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-12-22T18:33:18.613

就我而言，我错过了“www”。从我推的网址。它必须是完全匹配的，如果你正在工作`www.test.com`，你必须推送`www.test.com`而不是`test.com`

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-06-04T16:10:54.290

您应该尝试不使用文件夹资源管理器方法（即`file://`）打开文件，而是从`http://`（即`http://yoursite.com/`从`http://localhost/`）打开该文件

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-02-19T17:27:28.423

当我从一个文件中调用另一个 javascript 文件而不放置 javascript“物理”地址时，我遇到了同样的问题。我通过从 html 中以相同的方式调用它来解决它，例如：“JS / archivo.js”而不是“archivo.js”

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2018-06-12T06:38:30.600

创建 PWA 时，在非 https 服务器上使用的 service worker 也会生成此错误。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-11-18T23:12:21.270

我在 ReactJS 历史推送中遇到了这个问题，结果我试图打开`//link`（用双斜杠）

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-12-30T17:31:01.733

将 index.js 文件中的 serviceWorker.unregister() 替换为 serviceWorker.register()

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-10-22T08:16:54.400

我通过`http`从协议切换到协议来解决它`file`。

*   你可以在 VS 代码中使用“live-server”扩展，
*   或者，在节点上，使用`live-server [dirPath]`

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-03-12T08:20:45.017

我遇到了同样的问题，这是由设置`<base href=>`为裸域引起的，而我的服务器始终为 www 域提供服务。将 www 添加到 url`base href`解决了这个问题。

# multithreading - CFTHREAD 中的范围问题

> ID：13348767
> 
> 赞同：1
> 
> 时间：2012-11-12T17:49:21.927
> 
> 标签：multithreading, coldfusion, scope, cfthread

我有一个应用程序，每晚发送几封 10 万封电子邮件，因此为了加快处理速度，添加了一些 cfthreads。

这导致了一些奇怪的错误，我发现在一个线程中创建的变量正在被另一个线程修改。从我读过的文档中，在一个线程中创建的变量应该只对该线程可见？

做了一个简单的测试，如下所示：

```
<cfthread
    name="thread1"
    action="run">

    <cfsavecontent variable="local.template_body">
        <cfinclude template="templates\6\2\bulletin_template.cfm">
    </cfsavecontent>

    <cfset tmpEmailBody = template_body>
</cfthread>

<cfthread
    name="thread2"
    action="run">

    <cffile action="append"
            file="C:\inetpub\error1.txt"
            output="#tmpEmailBody#">        
</cfthread> 
```

“tmpEmailBody”的内容成功写入文件。

奇怪的是，如果我删除了 cfsavecontent 部分，并且有： `<cfset tmpEmailBody = "test">`，那么第二个线程会引发错误，并且 tmpEmailBody 没有定义，正如我所期望的那样。

有人知道这里发生了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T20:01:52.033

我相信您运行 cfthread 的目的是错误的。似乎线程 2 中的 tmpEmailBody 依赖于线程 1。您不应该在单独的线程中运行相关代码..

更好地使用与邮件有关的 cfthread 可能是

Thread1 {从数据库中选择电子邮件，其中电子邮件从您的列表中开始 }

线程 2 { select Emails from database where emails start from nz} out your list nz }

您的两个线程同时运行。这 2 个查询可以同时发生，但您不能在 1 个线程中保存变量并希望它与您在另一个线程中的调用时间相匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T22:58:31.583

该变量`tmpEmailBody`是在`Variables`范围内创建的，而不是在仅限于线程的范围内。线程将以随机顺序和随机时间执行，因此导致错误是因为在执行第一行`thread1`之前尚未执行最后一行。`thread2`

使用 cfthread 时，所有正常范围都不是线程安全的（与 ColdFusion 请求线程的线程安全相反；又名页面线程）如果您想确保在一个线程中创建/使用的变量与所有其他线程隔离，那么您必须使用线程范围。这在 ColdFusion 文档中被正式记录为[使用线程数据。](http://help.adobe.com/en_US/ColdFusion/10.0/Developing/WSc3ff6d0ea77859461172e0811cbec0c09d-7fee.html)

我猜想您是`tmpEmailBody`在两个线程之外声明的，但是由于将 cfset 更改为静态字符串会产生预期的行为，我会说存在“问题”，`cfsavecontent`并且它正在写入`Variables`范围而不是线程本地范围，这应作为[另一个范围界定问题](https://stackoverflow.com/a/9632799/238592)提交。

由于 ColdFusion 文档示例还有一些不足之处，因此我将重写您的代码，就好像您想将电子邮件正文从一个线程传递到另一个线程一样。您已经说过这不是您的预期用途，但它会显示各种线程范围。以下代码在不需要时将值复制到不同的范围内，但这样做是为了希望使不同的范围更清晰。而且，正如其他人所说，以下任务是线程使用不当。

```
<cfthread
    name="thread1"
    action="run">

    <cfset var template_body = "">

    <cfsavecontent variable="template_body">
        <cfinclude template="templates\6\2\bulletin_template.cfm">
    </cfsavecontent>

    <cfset thread.tmpEmailBody = template_body>
</cfthread>

<cfthread action="join" name="thread1" timeout="60">

<cfset Variables.tmpEmailBody = cfthread["thread1"]tmpEmailBody>

<cfthread
    name="thread2"
    action="run"
    emailBody="#Variables.tmpEmailBody#">

    <cffile action="append"
            file="C:\inetpub\error1.txt"
            output="#Attributes.emailBody#">        
</cfthread> 
```

# c# - 发送 HTTP 标头后，DotNetOpenAuth 授权无法设置状态？

> ID：13348770
> 
> 赞同：0
> 
> 时间：2012-11-12T17:49:29.993
> 
> 标签：c#, asp.net-mvc, facebook, dotnetopenauth

我的 elmah 错误日志充满了异常：

**发送 HTTP 标头后，服务器无法设置状态。**

这些请求中有 70% 是由爬虫（alexa、googlebot）引起的，我不能保证其余请求不是带有假 cookie、代理字符串等的机器人，但其中一些请求看起来确实是合法的。

以下是发生错误的 Facebook 授权方法：

```
 public class FacebookClient : WebServerClient 
    {
        private static readonly AuthorizationServerDescription FacebookDescription = new AuthorizationServerDescription 
        {
            TokenEndpoint = new Uri("https://graph.facebook.com/oauth/access_token"),
            AuthorizationEndpoint = new Uri("https://graph.facebook.com/oauth/authorize"),
        };

        /// <summary>
        /// Initializes a new instance of the <see cref="FacebookClient"/> class.
        /// </summary>
        public FacebookClient() : base(FacebookDescription) 
        {
        }
    } 
```

* * *

```
 private static readonly FacebookClient client = new FacebookClient
    {
        ClientIdentifier = ConfigurationManager.AppSettings["facebookAppID"],

        ClientCredentialApplicator = ClientCredentialApplicator.PostParameter(ConfigurationManager.AppSettings["facebookAppSecret"]),
    }; 
```

* * *

```
 [AllowAnonymous]
    public ActionResult Facebook(string returnUrl)
    {
        IAuthorizationState authorization = client.ProcessUserAuthorization();

        if (authorization == null)
        {
            var scope = new List<string>();

            scope.Add("email");

            client.RequestUserAuthorization(scope);
        }
        else
        {
            try
            {
                var request = WebRequest.Create("https://graph.facebook.com/me?&access_token=" + Uri.EscapeDataString(authorization.AccessToken));

                using (var response = request.GetResponse())

                using (var responseStream = response.GetResponseStream())
                {
                    var graph = FacebookGraph.Deserialize(responseStream);

                    if (Membership.GetUser(graph.Id.ToString()) == null)
                    {
                        MembershipCreateStatus membershipCreateStatus = MembershipCreateStatus.Success;

                        var user = Common.CreateUser(membershipCreateStatus, graph.Id.ToString(), HttpUtility.HtmlEncode(graph.Email));

                        if (membershipCreateStatus != MembershipCreateStatus.Success)
                        {
                            TempData["message"] = "Unsuccessful creation of Account. " + membershipCreateStatus.ToString();

                            return RedirectToAction("Login", "Account");
                        }

                        if (membershipCreateStatus == MembershipCreateStatus.Success)
                        {

                            AddUserShortID((Guid)user.ProviderUserKey, HttpUtility.HtmlEncode(graph.Name));

                            Common.Authorize(graph.Id.ToString());
                        }
                    }
                    else
                    {
                        Common.Authorize(graph.Id.ToString());
                    }
                }
            }
            catch
            {
                TempData["message"] = "Unsuccessful creation of Account. ";

                return RedirectToAction("Login", "Account");
            }
        }

        if (!string.IsNullOrWhiteSpace(returnUrl) && Url.IsLocalUrl(returnUrl))
        {
            return Redirect(returnUrl);
        }

        return RedirectToAction("Index", "Home");
    } 
```

这里可能导致这种行为的代码中最可疑的部分是什么？为什么这种情况大部分时间都发生在机器人身上？有没有办法重现这样的东西？

**更新：**这不仅仅是由机器人引起的，我昨天也遇到了这个异常，只是在日志中，在浏览器中我没有找到 graph.facebook.com/...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T10:52:25.763

我发现当这个异常发生时，当我被重定向到 Facebook 登录页面时，如果你刷新页面或输入登录信息错误，或者如果页面当前不可用，无论出于何种原因，这个异常被记录，但**最重要的是那个用户不会看到任何异常情况发生，也不会出现任何登录问题。**

# android - Android, java listview notifyDataSetChanged(); 不工作

> ID：13348773
> 
> 赞同：0
> 
> 时间：2012-11-12T17:49:42.053
> 
> 标签：android, listview

嗨，有人可以看看这个，看看他们是否知道我哪里出错了。它工作正常，直到 GetTheMoreData() 中的后执行任务我试图将 GetTheMoreData 和 GetTheData 中的条目附加到列表视图中。当我单击加载更多按钮时，我没有收到任何错误，并且列表视图保持不变。Postexecute 确实会触发，因为我可以在日志中看到数据。谢谢

```
SimpleAdapter mAdapter;
String mCurFilter;
List<Map<String, String>> items = new ArrayList<Map<String, String>>();

@Override 
public void onActivityCreated(Bundle savedInstanceState) {
    super.onActivityCreated(savedInstanceState);

    String  letter = getActivity().getIntent().getStringExtra("LETTER");
    new GetTheData().execute(letter);

    final ListView lv = getListView();
    Button btnLoadMore = new Button(getActivity());
    btnLoadMore.setText("Load More");
    lv.addFooterView(btnLoadMore); 
    lv.setTextFilterEnabled(true);         
    btnLoadMore.setOnClickListener(new View.OnClickListener() {
        public void onClick(View arg0) {
            new GetTheMoreData().execute("A");
            Log.i(TAG, "loadmore clicked : ");
        }
    });

    lv.setOnItemClickListener(new OnItemClickListener() {       
        public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
            //room for stuff             
        }   
    });
    setListShown(false);
    getLoaderManager().initLoader(0, null, this);
}

private class GetTheMoreData extends AsyncTask<String, Void, List<Map<String, String>>> {   
    @Override
    protected List<Map<String, String>> doInBackground(String... res) {    
        List<Map<String, String>> items = new ArrayList<Map<String, String>>();  
        start = start +25;  
        JSONObject json = JSONfunctions.getJSONfromURL("http://www.myurl.com/main.php?letter="+res[0]+"&start="+start);        
        try{
            JSONArray  songlist = json.getJSONArray("mainlist");                
            for(int i=0;i<songlist.length();i++){                       
                HashMap<String, String> map = new HashMap<String, String>();    
                JSONObject e = songlist.getJSONObject(i);           
                map.put("id",  String.valueOf(i));
                map.put("Item", e.getString("Item"));               
                items.add(map); 
                Log.i(TAG, "dat:" + items);
            }       
        }catch(JSONException e)        {
            Log.e("log_tag", "Error parsing data "+e.toString());
        }        
        return items;
    }

    @Override
    protected void onPostExecute(List<Map<String, String>> items) { 

        mAdapter.notifyDataSetChanged();
        super.onPostExecute(items);
    }

    @Override
    protected void onProgressUpdate(Void... values) {
        // TODO Auto-generated method stub
        super.onProgressUpdate(values);
    }
}

private class GetTheData extends AsyncTask<String, Void, List<Map<String, String>>> {   
    @Override
    protected List<Map<String, String>> doInBackground(String... res) {         
        JSONObject json = JSONfunctions.getJSONfromURL("http://www.myurl.com/main.php?letter="+res[0]+"&start=0");        
        try{
            JSONArray  songlist = json.getJSONArray("mainlist");

            for(int i=0;i<songlist.length();i++){                       
                HashMap<String, String> map = new HashMap<String, String>();    
                JSONObject e = songlist.getJSONObject(i);           
                map.put("id",  String.valueOf(i));
                map.put("Item", e.getString("Item"));
                items.add(map);         
            }       
        }catch(JSONException e)        {
            Log.e("log_tag", "Error parsing data "+e.toString());
        }        
        return items;
    }

    @Override
    protected void onPostExecute(List<Map<String, String>> items) { 
        String[] from = new String[] { "Item" };
        int[] to = new int[] { android.R.id.text1 };

        mAdapter = new SimpleAdapter( getActivity(), items,
                android.R.layout.simple_list_item_1, from, to );
        setListAdapter( mAdapter );
        super.onPostExecute(items);
    }

    @Override
    protected void onProgressUpdate(Void... values) {
        super.onProgressUpdate(values);
    }
}

@Override 
public void onListItemClick(ListView l, View v, int position, long id) {
    switch( position )
    {}

    Log.i(TAG, "Item clicked: " + id);
}

// These are the rows that we will retrieve.
public void onLoadFinished(Loader<Cursor> loader, Cursor data) {
    // mAdapter.swapCursor(data);

    // The list should now be shown.
    if (isResumed()) {
        setListShown(true);
    } else {
        setListShownNoAnimation(true);
    }
}

public void onLoaderReset(Loader<Cursor> loader) {
    //    mAdapter.swapCursor(null);
}

@Override
public Loader<Cursor> onCreateLoader(int arg0, Bundle arg1) {
    // TODO Auto-generated method stub
    return null;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T19:09:57.513

这是因为在 的方法`doInBackground()`中`GetTheMoreData`，您这样做：
`List<Map<String, String>> items = new ArrayList<Map<String, String>>();`
因此创建了一个新列表，并且您将元素添加到仅存在于此方法中且未链接到您的适配器的列表中。
而不是这一行，把这个： `items.clear();`

# php - PHP节点不通过引用传递

> ID：13348774
> 
> 赞同：3
> 
> 时间：2012-11-12T17:49:45.343
> 
> 标签：php, dom, nodes

我在一个类中有一堆 dom 操作函数。其中一个函数将唯一的 ID 分配给特定的节点。

```
$resource_info_node->setAttribute('id', 'resource_'.$this->ids);
$details['id'] = 'resource_'.$this->ids;
$details['node'] = $resource_info_node;
$this->resource_nodes['resource_'.$this->ids] = $details;
$this->ids += 1; 
```

稍后我想查找并修改这些节点。我努力了 ：

```
$current_node = $this->resource_nodes[$id]['node']; 
```

当我 print_r() 我发现这个节点是原始节点的副本。它具有原始节点的属性，但不是 DOM 树的一部分。我得到相同的结果：

```
$this->content->getElementById($id); 
```

我想我的整个事情都是基于将节点引用存储在数组中。我认为这是一件好事。即使没有，之后使用 getElementByID() 也应该返回 dom 中的节点。

我认为，在 PHP 中，所有对象都是通过引用传递的。包括 DOM 节点。关于如何测试实际情况的任何想法。

**编辑 ：**

好吧，我用过：

```
$this->xpath->query('//*[@id]'); 
```

这返回了正确数量的带有 id 的项目。当我编辑它时，该节点不在 DOM 树中。

和

```
$current_node = &$this->resource_nodes[$id]['node']; 
```

使用参考语法没有影响。

最奇怪的部分是 get elementById() 没有返回 dom 中的节点。除了没有父节点之外，它具有所有正确的属性。

**修复 - 不回答：**

我只是使用 xpath 而不是我的参考或 getElementById()。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T17:51:39.770

明确使用参考：

```
$current_node = &$this->resource_nodes[$id]['node']; 
```

并修改`$current_node`

# javascript - Javascript/jQuery - 是否可以封装并返回异步执行函数的结果？

> ID：13348780
> 
> 赞同：2
> 
> 时间：2012-11-12T17:50:25.950
> 
> 标签：javascript, jquery, asynchronous

我知道这个问题已经以许多不同的方式被问过很多次，但我仍然无法确定以下问题的良好解决方案。

在从外部函数返回之前，如何等待这个异步执行的内部函数的回调完成？

```
function outer() {
    var result = false;
    var innerAsynch = function() {
        result = true;
    }
    setTimeout(innerAsynch, 1000);
    waitForInnerAsynch(); //blocking
    return result;  //true
} 
```

1) 我很清楚这对 99.999% 的用例来说是不好的做法，所以请不要告诉我不应该这样做！

2）请随意完全重构这段代码......我唯一的要求是outer（）返回的东西会阻止浏览器，直到innerAsynch（）完成并通过以下测试：

```
 if(outer()) {
    //1 second later.... yippee!
 } 
```

我也在使用 jQuery，但我宁愿不使用插件，除非这样做真的很有意义。谢谢！

**更新**

我想重申一下，我的目标是将异步执行完全封装在对 external() 的同步调用中，不带参数。

换句话说，这应该有效：

```
<a href="something" onclick="return outer()">A very slow link</a> 
```

也许这实际上是不可能的，在这种情况下我可以使用回调，但我想更好地理解为什么会这样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T18:51:44.430

> 我想重申一下，我的目标是将异步执行完全封装在对 external() 的同步调用中，不带参数。

存在异步执行和回调的唯一原因是不阻塞。如果您真的想阻止，请不要使用异步代码。如果您确实依赖异步函数，请重新构建代码以使用回调。就这么简单。

JavaScript 是单线程的，因此，如果您阻塞，浏览器似乎会冻结，直到您的代码解除阻塞。当您阻止时，您甚至无法更新 UI 以通知用户正在执行某些长时间运行的操作。这就是为什么它很糟糕。请记住，该语言是围绕事件循环和异步事件队列设计的；试图违背这一点只会导致头疼。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T17:55:15.270

标准 js 模式。您只需要使用回调：

```
function outer(callback) 
{
    var innerAsynch = function(innerCallback) {
        var result = true;
        innerCallback(result);
    }

    setTimeout(function()
    {
      innerAsynch(function(result)
      {
        callback(result);
      });

    }, 1000);
} 
```

用法：

```
outer(function(result)
{
  if ( result )
    //true
  else
    //false
}); 
```

# c# - 如何在不同的线程中获取 UI 元素？

> ID：13348781
> 
> 赞同：0
> 
> 时间：2012-11-12T17:50:33.377
> 
> 标签：c#, multithreading, windows-runtime, task

在我的应用程序中，我将数据保存到我的数据库 (SQLite)。我不想阻止我的 UI，所以我将数据保存在不同的任务中

```
 await Task.Run(() => this.SaveTracks(books, filesCollection)); 
```

我从字典中获取带有数据的 TextBox

```
TextBox tmpTextBox = parseData["title_" + i] as TextBox; 
```

当它不在不同的任务中时，它工作得很好，但是当我使用 Task.Run 设置时，我得到了我无法使用它的异常，因为我在不同的线程中调用了元素。如何通过在不同的任务中阻止我的 UI 并从主线程中的 UI 元素获取数据

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T17:52:53.637

两种选择：

*   拆分更大的操作，以便您的循环（我假设有一个循环）仍然在 UI 线程中执行，但每个单独的保存操作都是后台的单独任务
*   在创建任务之前获取您需要的*所有UI 信息，并捕获该信息，以便任务永远不需要访问 UI*

无论哪种方式，结果都是一样的：您只能访问 UI 线程中的 UI 元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T17:53:32.693

在启动任务之前获取`TextBox.Text`值并将该值作为参数传递。

# wpf - 用 Active Directory 用户填充 WPF 组合框花费的时间太长

> ID：13348788
> 
> 赞同：1
> 
> 时间：2012-11-12T17:51:12.913
> 
> 标签：wpf, vb.net, performance, combobox, active-directory

我有一个绑定到数据表的组合框，我用活动目录中的用户名填充该数据表。此代码大约需要一分钟才能完成。我错过了更好的方法吗？

```
Function users() As DataTable
    Dim dt As DataTable
    Dim dr As DataRow
    Dim idCoulumn As DataColumn
    Dim nameCoulumn As DataColumn

    Dim dirEntry As New System.DirectoryServices.DirectoryEntry("LDAP://CN=Users,DC=myDomain,DC=local")

    Dim oSearcher As DirectorySearcher = New DirectorySearcher(dirEntry)
    Dim oResults As SearchResultCollection

    oSearcher.PropertiesToLoad.Add("samAccountName")
    oSearcher.PropertiesToLoad.Add("givenname")
    oSearcher.PropertiesToLoad.Add("sn")
    oSearcher.PropertiesToLoad.Add("cn")
    oSearcher.Filter = "objectCategory=person"
    oResults = oSearcher.FindAll

    dt = New DataTable()
    idCoulumn = New DataColumn("ID", Type.GetType("System.String"))
    nameCoulumn = New DataColumn("Name", Type.GetType("System.String"))

    dt.Columns.Add(idCoulumn)
    dt.Columns.Add(nameCoulumn)

    For Each oResult In oResults
        With oResult.GetDirectoryEntry()
            If .Properties("cn").Value <> "" AndAlso .Properties("samAccountName").Value <> "" AndAlso .Properties("sn").Value <> "" Then
                dr = dt.NewRow()
                dr("ID") = .Properties("samAccountName").Value
                dr("Name") = String.Format("{0},{1} : {2}", .Properties("sn").Value, .Properties("givenname").Value, .Properties("samAccountName").Value)
                dt.Rows.Add(dr)
            End If
        End With
    Next

    dt.DefaultView.Sort = "Name"

    Return dt

End Function 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T18:16:10.023

不要包含 sn 和 cn 属性，请尝试下面的过滤器并删除您的 if。

```
(&(objectCategory=user)(objectClass=user)(samAccountName=*)) 
```

这将查询具有现有 samAccount 名称的所有用户。这应该消除对 if 语句的需要并检查 SN 或 CN。您也可以考虑绑定到比 Datatable 更轻的东西。

除此之外，您的代码看起来很紧凑。你可能只需要把它放在它自己的线程中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T19:17:28.677

@Spevy 通过他提出的答案帮助我找到了这个解决方案。

我将我的目录条目更改为：

```
Dim dirEntry As New System.DirectoryServices.DirectoryEntry("LDAP://myDomain") 
```

我设置了我的搜索过滤器：

```
oSearcher.Filter = "(&(objectCategory=user)(objectClass=user))" 
```

并将我的 if 语句更改为：

```
If .Properties("samAccountName").Value <> "" AndAlso .Properties("sn").Value <> "" Then 
```

我不确定添加这些代码行的真正作用，但无论它们是否存在，我都会得到相同的结果，所以我删除了它们：

```
oSearcher.PropertiesToLoad.Add("samAccountName")
oSearcher.PropertiesToLoad.Add("givenname")
oSearcher.PropertiesToLoad.Add("sn")
oSearcher.PropertiesToLoad.Add("cn") 
```

# php - 使用 str_replace 替换外部文件中的字符串值

> ID：13348796
> 
> 赞同：0
> 
> 时间：2012-11-12T17:51:42.017
> 
> 标签：php, string, file-get-contents, str-replace

我有一个复制文件的脚本，但是在复制该文件后，我需要一个脚本来动态更改该文件中的某些字符串值。

通过四处搜索，我发现`file_get_contents`并`str_replace`为此工作得最好，但由于某种原因，我拥有的脚本不起作用。

这就是我所拥有的：（注意：$wikiname 是正在创建的新 wiki 的名称

```
$template = file_get_contents("/var/www/wiki/". $wikiname ."/LocalSettings.php");

$snReplace = str_replace("templatewiki", $wikiname, $template);
$mnReplace = str_replace("Templatewiki", $wikiname, $template);
$spReplace = str_replace("/iadmin/wikifresh", "/wiki/".$wikiname, $template);
$wgDBname = str_replace("template_wiki", $wikiname, $template); 
```

我正在搜索确切的字符串并尝试用 wiki 名称替换该字符串。但由于某种原因，这根本不起作用。

有没有我遗漏的明显问题？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T17:55:28.447

[`str_replace`](http://www.php.net/manual/en/function.str-replace.php) *返回*修改后的字符串，作为参数传递的字符串保持不变。这是你需要做的：

```
$template = file_get_contents("/var/www/wiki/" . $wikiname . "/LocalSettings.php");
$template = str_replace("templatewiki", $wikiname, $template);
$template = str_replace("Templatewiki", $wikiname, $template);
$template = str_replace("/iadmin/wikifresh", "/wiki/" . $wikiname, $template);
$template = str_replace("template_wiki", $wikiname, $template); 
```

您还可以使用[`strtr`](http://www.php.net/manual/en/function.strtr.php)函数来实现相同的结果：

```
$template = strtr(file_get_contents("/var/www/wiki/" . $wikiname . "/LocalSettings.php"), array(
    "templatewiki"      => $wikiname,
    "Templatewiki"      => $wikiname,
    "/iadmin/wikifresh" => "/wiki/" . $wikiname,
    "template_wiki"     => $wikiname
)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T18:00:38.387

您需要继续将每个替换的输出传递给下一个替换的输入，否则您只是在最终的 str_replace 中进行替换（假设您只在脚本的其余部分使用最后一个变量）。更好的是，您将替换合并到更少的命令中 -

```
$template = file_get_contents('/var/www/wiki/' . $wikiname . '/LocalSettings.php');
$new = str_replace(array('templatewiki', 'Templatewiki', 'template_wiki'), $wikiname, $template);
$new = str_replace('/iadmin/wikifresh', '/wiki/' . $wikiname, $new); 
```

您甚至可以使用数组作为第二个参数将这两条 str_replace 行合并到一个命令中，但是为了便于阅读，我将它们保留为两个。

您还需要保存输出，一种方法是 -

```
file_put_contents('/var/www/wiki/' . $wikiname . '/LocalSettings.php', $new); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T17:58:32.340

尝试：

```
$template = file_get_contents("/var/www/wiki/". $wikiname ."/LocalSettings.php");
$template = str_replace(array("templatewiki", "Templatewiki","template_wiki","/iadmin/wikifresh"), array($wikiname,$wikiname, $wikiname,"/wiki/".$wikiname), $template); 
```

你不需要使用多个`str_replace`，你只需要 1。

也可以`str_ireplace`用于不区分大小写的替换，将参数减1，

```
$template = str_ireplace(array("templatewiki", "template_wiki","/iadmin/wikifresh"), array($wikiname, $wikiname,"/wiki/".$wikiname), $template); 
```

手册：[str_replace](http://php.net/manual/en/function.str-replace.php) [str_ireplace](http://www.php.net/manual/en/function.str-ireplace.php)

# android - 通过蓝牙将应用程序连接到 Mac 涉及什么？

> ID：13348799
> 
> 赞同：0
> 
> 时间：2012-11-12T17:51:47.163
> 
> 标签：android, air, bluetooth, unity3d

我意识到这种问题经常得到很多（当之无愧的）“你试过什么”评论和反对票，但我希望当我问完问题时，我可以避免这种情况。

我一直在环顾四周，但无法找到如何编写包含以下三件事的应用程序的答案：

1.  通过蓝牙连接到主机设备的 Android 应用
2.  在该蓝牙连接上来回发送信号的通信 io 层
3.  一个宿主本地应用程序（最好是 Unity3D，或 AIR），它可以接收/发送消息来回连接到连接的应用程序。

我已经编写了许多 Android 应用程序，因此我不需要任何类型的“入门”手持，而我只需要一些关于如何使用蓝牙的指导（最好以网络链接或书籍教程的方式）以及如何通过它实际进行通信。

提前感谢所有有用的提示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T18:08:13.737

这是我在蓝牙连接方面找到的一些链接

首先是开发指南（我假设您已经看过这里，但如果没有，这是一个很好的起点）

*   [http://developer.android.com/guide/topics/connectivity/bluetooth.html](http://developer.android.com/guide/topics/connectivity/bluetooth.html)

*   [http://developer.android.com/reference/android/bluetooth/BluetoothDevice.html](http://developer.android.com/reference/android/bluetooth/BluetoothDevice.html)

这是一个关于如何在 android 上连接蓝牙的基本教程

*   [http://luugiathuy.com/2011/02/android-java-bluetooth/](http://luugiathuy.com/2011/02/android-java-bluetooth/)

这是一个关于蓝牙编程的长 PDF（我还没有读过它，但从我所看到的深入来看）它涵盖了 java 和 OSX，但不包括 android

*   people.csail.mit.edu/rudolph/Teaching/Articles/BTBook.pdf

这是一个类似的 SO question，可能包含有用的链接

*   [Android蓝牙编程的代码示例](https://stackoverflow.com/questions/5619850/code-samples-for-android-bluetooth-programming)

这是我能为安卓找到的最好的蓝牙开源项目，它不适合你的描述，但无论如何都在这里

*   [http://code.google.com/p/bluetooth-remote-control/source/browse/#svn%2Ftrunk%2Fsrc%2Fpro%2Fapus%2Fblueremote](http://code.google.com/p/bluetooth-remote-control/source/browse/#svn%2Ftrunk%2Fsrc%2Fpro%2Fapus%2Fblueremote)

我意识到很多这些链接比你真正想要的更简单，如果我发现任何更复杂的东西，我会添加。

# c++ - 在while循环中接受用户输入

> ID：13348800
> 
> 赞同：2
> 
> 时间：2012-11-12T17:52:02.700
> 
> 标签：c++, while-loop, user-input

我正在尝试创建一个简单的温度转换程序，该程序允许用户根据需要多次转换温度，直到他们决定通过输入字母“e”来结束程序。除了用户输入字母“e”的部分之外，代码中的其他所有内容都有效。如果我取出最后一个 else 语句，程序将再次从循环的开头开始。如果我将else语句留在里面，当用户输入字母'e'时，else语句认为它是无效输入并且不会结束程序。

```
 #include <iostream>

using namespace std;

float celsiusConversion(float cel){     // Calculate celsius conversion
    float f;

    f = cel * 9/5 + 32;
    return f;
}

float fahrenheitConversion(float fah){  // Calculate fahrenheit conversion
    float c;

    c = (fah - 32) * 5/9;
    return c;

}
int main()
{
    char userInput;

        while (userInput != 'e' or userInput != 'E')    // Loop until user enters the letter e
        {

            cout << "Please press c to convert from Celsius or f to convert from Fahrenheit. Press e to end program." << endl;
            cin >> userInput;

            if (userInput == 'c' or userInput == 'C') // Preform celsius calculation based on user input 
                {
                    float cel;
                    cout << "Please enter the Celsius temperature" << endl;
                    cin >> cel;
                    cout << cel << " Celsius is " << celsiusConversion(cel) <<  " fahrenheit" << endl;
                }
            else if (userInput == 'f' or userInput == 'F')  // Preform fahrenheit calculation based on user input
                {
                    float fah;
                    cout << "Please enter the Fahrenheit temperature" << endl;
                    cin >> fah;
                    cout << fah << " Fahrenheit is " << fahrenheitConversion(fah) << " celsius" << endl;
                }
            else    // If user input is neither c or f or e, end program
                {
                    cout << "Invalid entry. Please press c to convert from Celsius, f to convert from Fahrenheit, or e to end program." << endl;
                }
        }
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T17:56:12.093

你的意思是`while(userInput != 'e' && userInput != 'E')`

'or' 版本总是正确的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T18:05:04.493

我将对您的代码进行 2 处更改：

```
while (userInput != 'e' && userInput != 'E') 
```

并且，就在“else”之前（以防止退出程序时出现错误消息）：

```
else if (userInput == 'e' or userInput == 'E')
             {
                break;
             } 
```

# language-agnostic - 在散点列表中查找路径的算法

> ID：13348803
> 
> 赞同：3
> 
> 时间：2012-11-12T17:52:19.900
> 
> 标签：language-agnostic, graph-algorithm, shortest-path

我有一个从测量模型中获取的点列表。要进行的分析的一个重要部分包括沿着这些点找到“候选路径”，这些路径将被进一步修剪和完善。

下面是显示原始数据图的图像，以及检测到的路径的手绘图。这些路径应该是连续的并且近似垂直，并且输出格式将是点列表的列表（点的颜色与路径查找本身无关）：

![在此处输入图像描述](../Images/0c5c7d42ef7a52f631070c5599fd23eb.png)

我想这可以通过蛮力、详尽的方法来解决，但我想也可以有一些众所周知的算法来解决这个问题。

我使用 Python，因此非常感谢 Numpy/Scipy 示例（`scipy.spatial`听起来像是完美的候选者）

编辑：下面提供了一个示例数据集（[x,y,weight] 点列表）：

```
[[ -0.7898176   -3.35201728   4.36142086]
 [  2.99221402  -3.35201728   1.11907575]
 [  6.97475149  -3.35201728   2.4320322 ]
 [ -4.82443609  -2.35201728   0.6479064 ]
 [ -1.32418909  -2.35201728   1.88004944]
 [  0.07067882  -2.35201728   1.10982834]
 [  3.09169448  -2.35201728   1.8557436 ]
 [  7.10399403  -2.35201728   2.03906224]
 [ -3.07207606  -1.35201728   0.35500973]
 [  2.63202993  -1.35201728   5.32397834]
 [  5.19884868  -1.35201728   1.63816326]
 [  7.65721835  -1.35201728   1.13843392]
 [  2.48172754  -0.35201728   6.65584512]
 [  6.0905911   -0.35201728   1.15552652]
 [  8.62497546  -0.35201728   0.30407144]
 [ -4.7300089    0.64798272   0.31481496]
 [ -3.03274093   0.64798272   0.95337568]
 [  2.19653614   0.64798272  10.3675204 ]
 [  6.20384058   0.64798272   1.42106077]
 [ -4.08636605   1.64798272   0.28875288]
 [  2.03344989   1.64798272  13.04648211]
 [ -4.11717795   2.64798272   0.39713141]
 [  1.93304283   2.64798272  10.41313242]
 [ -4.37994815   3.64798272   0.84588643]
 [  1.66081408   3.64798272  14.96380955]
 [ -4.19024027   4.64798272   0.73216113]
 [  1.60252433   4.64798272  14.72419286]
 [  6.77837359   4.64798272   0.6186005 ]
 [ -4.14362668   5.64798272   0.93673165]
 [  1.55372968   5.64798272  12.9421123 ]
 [ -4.62223541   6.64798272   0.6510101 ]
 [  1.527865     6.64798272  10.80209351]
 [  6.86820685   6.64798272   0.82550801]
 [ -4.68259732   7.64798272   0.45321369]
 [  1.36167494   7.64798272   6.45338514]
 [ -5.19205787   8.64798272   0.23935013]
 [  1.21003466   8.64798272  10.13528877]
 [  7.6689546    8.64798272   0.32421776]
 [ -5.36436818   9.64798272   0.79809416]
 [  1.26248534   9.64798272   7.67036253]
 [  7.35472418   9.64798272   0.92555691]
 [ -5.61723652  10.64798272   0.4741007 ]
 [  1.23101086  10.64798272   7.97064105]
 [ -7.83024735  11.64798272   0.47557318]
 [  1.20348982  11.64798272   8.20694816]
 [  1.14422758  12.64798272   9.26244889]
 [  9.18164464  12.64798272   0.72428381]
 [  1.0827069   13.64798272  10.08599118]
 [  6.80116007  13.64798272   0.4571425 ]
 [  9.384236    13.64798272   0.42399893]
 [  1.04053491  14.64798272  10.48370805]
 [  9.16197972  14.64798272   0.39930227]
 [ -9.85958581  15.64798272   0.39524976]
 [  0.9942501   15.64798272   8.39992264]
 [  8.07642416  15.64798272   0.61480371]
 [  9.55088151  15.64798272   0.54076473]
 [ -7.13657331  16.64798272   0.32929172]
 [  0.92606211  16.64798272   7.83597033]
 [  8.74291069  16.64798272   0.74246827]
 [ -7.20022443  17.64798272   0.52555351]
 [  0.81344517  17.64798272   6.81654834]
 [  8.52844624  17.64798272   0.70543711]
 [ -6.97465178  18.64798272   1.04527813]
 [  0.61959631  18.64798272  10.33529022]
 [  5.733054    18.64798272   1.2309691 ]
 [  8.14818453  18.64798272   1.37532423]
 [ -6.82823664  19.64798272   2.0314052 ]
 [  0.56391636  19.64798272  13.61447357]
 [  5.79971126  19.64798272   0.30148347]
 [  8.01499476  19.64798272   1.72465327]
 [ -6.78504689  20.64798272   2.88657804]
 [ -4.79580634  20.64798272   0.36201975]
 [  0.548376    20.64798272   7.8414544 ]
 [  7.62258506  20.64798272   1.52817905]
 [-10.50328534  21.64798272   0.90358671]
 [ -6.59976138  21.64798272   2.62980169]
 [ -3.71180255  21.64798272   1.27094175]
 [  0.5060743   21.64798272  11.06117677]
 [  4.51983105  21.64798272   1.74626435]
 [  7.50948795  21.64798272   3.46497629]
 [ 11.10199877  21.64798272   1.78047269]
 [-10.15444935  22.64798272   1.47486166]
 [ -6.26274479  22.64798272   4.73707852]
 [ -3.45440904  22.64798272   1.72516012]
 [  0.52759064  22.64798272  12.58470433]
 [  4.22258017  22.64798272   2.63827535]
 [  7.03480033  22.64798272   3.506412  ]
 [ 10.63560314  22.64798272   3.56076386]
 [ -5.95693623  23.64798272   2.97403863]
 [ -3.66261423  23.64798272   2.31667236]
 [  0.52051366  23.64798272  12.5526344 ]
 [  4.21083787  23.64798272   1.95794387]
 [  6.82438636  23.64798272   4.77995659]
 [ 10.18138299  23.64798272   5.21836205]
 [ -9.94629932  24.64798272   0.4074823 ]
 [ -5.74101948  24.64798272   2.60992238]
 [  0.52987226  24.64798272  10.68846987]
 [  6.29981921  24.64798272   3.56204471]
 [  9.96431168  24.64798272   2.85079129]
 [ -9.64229717  25.64798272   0.4503241 ]
 [ -5.579063    25.64798272   0.64475469]
 [  0.52053534  25.64798272  10.05046667]
 [  5.79167815  25.64798272   0.92797027]
 [ 10.05116919  25.64798272   2.52194933]
 [ -8.55286247  26.64798272   0.94447148]
 [  0.45065604  26.64798272  10.97432823]
 [  5.50068393  26.64798272   2.39645232]
 [ 10.08992273  26.64798272   2.77716257]
 [-16.62381217  27.64798272   0.2021621 ]
 [ -9.62146213  27.64798272   0.62245778]
 [ -7.66905507  27.64798272   2.84466396]
 [  0.38656111  27.64798272  10.74369366]
 [  5.76925402  27.64798272   1.13362978]
 [  9.83525197  27.64798272   1.18241147]
 [-15.64874512  28.64798272   0.18279302]
 [ -7.52932494  28.64798272   2.94012191]
 [  0.32171219  28.64798272  10.73770466]
 [  9.4062684   28.64798272   1.41714298]
 [-12.71287717  29.64798272   0.70268073]
 [ -7.59473877  29.64798272   2.16183026]
 [  0.20748772  29.64798272  12.97312987]
 [  3.92952496  29.64798272   1.54987681]
 [  9.05148017  29.64798272   2.40563748]
 [ 14.96021523  29.64798272   0.55258241]
 [-12.14428813  30.64798272   0.36365363]
 [ -7.12360666  30.64798272   2.54312163]
 [  0.40594038  30.64798272  12.64839117]
 [  4.59465757  30.64798272   1.23496581]
 [  8.54333134  30.64798272   2.18912857]
 [-10.6296531   31.64798272   1.4839259 ]
 [ -7.09532763  31.64798272   2.0113838 ]
 [  0.37037733  31.64798272  12.2071139 ]
 [  3.01253349  31.64798272   3.01591777]
 [  4.64523695  31.64798272   3.50267541]
 [  8.39369696  31.64798272   2.53195817]
 [ -7.07947026  32.64798272   1.01324147]
 [  0.39269437  32.64798272   9.67368625]
 [  8.58669997  32.64798272   1.00475646]
 [ 12.02329114  32.64798272   0.50782399]
 [-10.13060786  33.64798272   0.31475653]
 [ -7.30360407  33.64798272   0.35065243]
 [  0.49556923  33.64798272   9.66608818]
 [ -5.37822311  34.64798272   0.38727401]
 [  0.4958055   34.64798272   7.5415026 ]
 [  6.07719006  34.64798272   0.63012453]
 [ -4.64579055  35.64798272   0.39990249]
 [  0.46323666  35.64798272   4.60449213]
 [  4.72819312  35.64798272   0.98050594]
 [ -4.62418372  36.64798272   0.64160709]
 [  0.48866236  36.64798272   4.29331656]
 [  5.06493722  36.64798272   0.59888608]
 [  0.49730481  37.64798272   1.32828464]
 [ -1.31849217  38.64798272   0.70780886]
 [  1.70966455  38.64798272   0.88052135]
 [  0.06305774  39.64798272   0.47366487]
 [  2.13639356  39.64798272   0.67971461]
 [ -0.84726354  40.64798272   0.63787522]
 [  0.55723562  40.64798272   0.62855097]
 [  2.22359779  40.64798272   0.33884894]
 [  0.77309816  41.64798272   0.4605534 ]
 [  0.56144565  42.64798272   0.43678788]] 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T09:41:01.430

您可以为您的点找到[Delaunay 三角剖分。](http://en.wikipedia.org/wiki/Delaunay_triangulation)这给出了一个图，其中点相互连接。

然后，您可以删除该图的所有边，这些边要么太长，要么方向错误。

最后，您可以找到该图的所有未形成正确链的顶点（具有 2 个以上的入射边或两个入射边之间的角度与 2*pi 相差太远）。并且只保留最合适的边缘。

# google-chrome - Chrome 和 Safari 在将内容可编辑 DIV 的可见区域留在 DIV 中时会跟随插入符号并溢出：隐藏

> ID：13348809
> 
> 赞同：4
> 
> 时间：2012-11-12T17:52:40.837
> 
> 标签：google-chrome, safari, scroll, contenteditable, caret

自从将近 2 天以来，我一直在遇到这些麻烦，并将这是我在放弃之前获得 2 页编辑器的简洁解决方案的最后机会。

请先使用**Firefox**并查看： [http ://twopageeditor.bastianschulz.com/](http://twopageeditor.bastianschulz.com/)

脚步：

1.  将插入符号设置到最后一行“流放者，明喻和辱骂；”
2.  按“向下箭头”键

结果：插入符号位于第 2 页的第一行

关于实现的简短说明： - 编辑器包含两个单独的 contenteditable DIV 元素。- 如果通过在内容可编辑的 DIV 元素中移动光标来离开页面，我们只需交换 DIV 元素的位置和位置，但插入符号保持在同一个 DIV 元素中。左侧的第 2 页仍然是我们仍在第 1 页时在右侧的 DIV 元素。 - 对文本进行更改后，未选中的 DIV 元素会变得模糊，因为它可能是过时的。当再次取消选择选定的 DIV 元素时，其内容将完全复制到另一个 DIV 元素中，以便保留已完成的所有更改并因此与另一个 DIV 元素同步。

现在使用**Chrome**或**Safari**（根本没有 IE，这将是我的下一个问题......）步骤：

1.  将插入符号设置到最后一行“流放者，明喻和辱骂；”
2.  按“向下箭头”键

结果：插入符号位于第 2 页的第一行 1

但是：这一行是不可见的。再次按向下箭头键，它出现在第 2 页的第二行。当您现在按向上箭头键时，内容再次移动，插入符号在第 1 行，第 2 页按原样显示（就像 Firefox 一样正确）。

原因：在您按下第一页上的向下箭头键后，您会在片刻间看到此 DIV 中的内容会被浏览器自动滚动，因此插入符号的位置仍然可见。这会导致 DIV 元素的 CSS 顶部属性位移 20 像素。此后设置 top:-520px 的新绝对值时，例如（页面/视口的高度为 520px），这种奇怪的 20px 偏移仍然存在。

我还没有想出一种方法，当它不再可见时如何停止内容的自动滚动。或者至少能够将可内容编辑的 DIV 重置回其正常状态。

任何人的想法？

干杯!

# hibernate - JPA 实体管理器未正确更新具有 OneToMany 关系的字段

> ID：13348810
> 
> 赞同：0
> 
> 时间：2012-11-12T17:52:44.877
> 
> 标签：hibernate, jpa, merge, entity, one-to-many

我正在使用 Hibernate 4.1.0.Final 和 hibernate-jpa-2.0-api。我在使用实体管理器更新具有 OneToMany 关系的实体时遇到问题。这是实体：

```
@GenericGenerator(name = "uuid-strategy", strategy = "uuid.hex")
@Entity
@Table(name = "cb_organization", uniqueConstraints = {@UniqueConstraint(columnNames={"organization_id"})})
public class Organization implements Serializable
{

    …
    @OneToMany(fetch = FetchType.EAGER, cascade = CascadeType.PERSIST)
    @JoinTable(name = "cb_organization_address",
              joinColumns = @JoinColumn(name = "organization_id"),
              inverseJoinColumns = @JoinColumn(name = "address_id"))
    private List<Address> addresses; 
```

当我尝试使用新的一对多列表更新实体（使用实体管理器的合并方法）时，地址没有得到保存。我像这样创建列表...

```
 List<Address> addresses = new ArrayList<Address>();
    addresses.add(address);
    ...
    org.setAddresses(addresses);
    m_orgDao.save(org); 
```

这是相关的DAO代码......

```
@Autowired
private EntityManager entityManager;

@Override
public Organization save(Organization organization)
{
    if(StringUtils.isEmpty(organization.getId()))
    {
        entityManager.persist(organization);
    }
    else 
    {
        organization = entityManager.merge(organization);
    }

    return organization;
} 
```

返回的组织有一个地址，其中所有字段都为空。我可以对我的实体管理器和实体做些什么来确保数据正确保存？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T17:58:02.967

```
 @OneToMany(fetch = FetchType.EAGER, cascade = {CascadeType.PERSIST, CascadeType.MERGE}) 
```

代替

```
@OneToMany(fetch = FetchType.EAGER, cascade = CascadeType.PERSIST) 
```

# java - 以字符集安全的方式获取 Windows 上的进程列表

> ID：13348811
> 
> 赞同：9
> 
> 时间：2012-11-12T17:52:45.477
> 
> 标签：java, list, character-encoding, process

[这篇文章](https://stackoverflow.com/questions/54686/how-to-get-a-list-of-current-open-windows-process-with-java)提供了一个在 Windows 下检索正在运行的进程列表的解决方案。本质上它确实：

```
String cmd = System.getenv("windir") + "\\system32\\" + "tasklist.exe";
Process p = Runtime.getRuntime().exec(cmd);
InputStreamReader isr = new InputStreamReader(p.getInputStream());
BufferedReader input = new BufferedReader(isr); 
```

然后读取输入。

它看起来和工作都很棒，但我想知道 tasklist 使用的字符集是否有可能不是默认字符集并且此调用可能会失败？

例如[，关于不同可执行文件的另一个问题](https://stackoverflow.com/questions/457655/java-charset-and-windows)表明它可能会导致一些问题。

如果是这种情况，有没有办法确定合适的字符集是什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-20T23:01:35.080

可以把它分成两部分：

1.  windows部分
    从java你正在执行一个windows命令——在“windowsland”中的jvm外部。当 java Runtime 类执行 windows 命令时，它使用控制台的 DLL & 所以在 windows 中看起来好像命令在控制台中运行
    **Q：当我在控制台中运行 C:\windows\system32\tasklist.exe 时，什么是结果的字符编码（Windows 术语中的“代码页”）？**

    *   不带参数的 windows "chcp" 命令给出控制台的活动代码页号（例如，多语言拉丁语 1 为 850，拉丁语 1 为 1252）。请参阅[Windows Microsoft 代码页](http://msdn.microsoft.com/en-us/goglobal/bb964654.aspx)、 [Windows OEM 代码页](http://msdn.microsoft.com/en-us/goglobal/bb964655)、 [Windows ISO 代码页](http://msdn.microsoft.com/en-us/goglobal/bb964656)
        默认系统代码页最初是根据您的系统区域设置设置的（键入 systeminfo 以查看此内容或控制面板-> 区域和语言）。
    *   Windows OS/.NET 函数[getACP()](http://msdn.microsoft.com/en-us/library/dd318070%28VS.85%29.aspx)也提供此信息
2.  java部分：
    **如何从“x”的windows代码页（例如850或1252）解码java字节流？**

    *   Windows 代码页号和等效的 java 字符集名称之间的完整映射可以从[这里派生 - Code Page Identifiers (Windows)](http://msdn.microsoft.com/en-us/library/windows/desktop/dd317756%28v=vs.85%29.aspx)
    *   但是，实际上可以添加以下前缀之一来实现映射：
        “”（无）用于 ISO，“IBM”或“x-IBM”用于 OEM，“windows-”或“x-windows-”用于 Microsoft /视窗。
        例如 ISO-8859-1 或 IBM850 或 windows-1252

完整解决方案：

```
 String cmd = System.getenv("windir") + "\\system32\\" + "chcp.com";
    Process p = Runtime.getRuntime().exec(cmd);
    // Use default charset here - only want digits which are "core UTF8/UTF16"; 
    // ignore text preceding ":"
    String windowsCodePage = new Scanner(
        new InputStreamReader(p.getInputStream())).skip(".*:").next();

    Charset charset = null;
    String[] charsetPrefixes = 
        new String[] {"","windows-","x-windows-","IBM","x-IBM"};
    for (String charsetPrefix : charsetPrefixes) {
        try {
            charset = Charset.forName(charsetPrefix+windowsCodePage);
            break;
        } catch (Throwable t) {
        }
    }
    // If no match found, use default charset
    if (charset == null) charset = Charset.defaultCharset();

    cmd = System.getenv("windir") + "\\system32\\" + "tasklist.exe";
    p = Runtime.getRuntime().exec(cmd);
    InputStreamReader isr = new InputStreamReader(p.getInputStream(), charset);
    BufferedReader input = new BufferedReader(isr);

    // Debugging output
    System.out.println("matched codepage "+windowsCodePage+" to charset name:"+
            charset.name()+" displayName:"+charset.displayName());
    String line;
    while ((line = input.readLine()) != null) {
           System.out.println(line);
    } 
```

谢谢你的Q！- 很好玩。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-19T21:45:34.513

实际上，所使用的字符集`tasklist`总是与系统默认*值*不同。

另一方面，只要输出限制为[ASCII](http://en.wikipedia.org/wiki/ASCII) ，使用默认值是非常安全的。通常可执行模块的名称中只有 ASCII 字符。

因此，要获得正确的字符串，您必须将 (ANSI) Windows 代码页转换为 OEM 代码页，并将后者作为字符集传递给`InputStreamReader`.

这些编码之间似乎没有全面的映射。可以使用以下映射：

```
Map<String, String> ansi2oem = new HashMap<String, String>();
ansi2oem.put("windows-1250", "IBM852");
ansi2oem.put("windows-1251", "IBM866");
ansi2oem.put("windows-1252", "IBM850");
ansi2oem.put("windows-1253", "IBM869");

Charset charset = Charset.defaultCharset();
String streamCharset = ansi2oem.get(charset.name());
if (streamCharset) {
    streamCharset = charset.name();
}
InputStreamReader isr = new InputStreamReader(p.getInputStream(),
                                              streamCharset); 
```

这种方法对我`windows-1251`很有效`IBM866`。

要获取 Windows 使用的当前 OEM 编码，可以使用[`GetOEMCP`](http://msdn.microsoft.com/en-us/library/windows/desktop/dd318114%28v=vs.85%29.aspx)function。返回值取决于**区域和语言**控制面板中**管理**选项卡上**非 Unicode 程序**的语言设置。需要重新启动才能应用更改。

 ***** * *

Windows 上有两种编码：[**ANSI**](http://en.wikipedia.org/wiki/Windows_code_page#ANSI_code_page)和[**OEM**](http://en.wikipedia.org/wiki/Windows_code_page#OEM_code_page)。

前者由在 GUI 模式下运行的非 Unicode 应用程序使用。
后者由控制台应用程序使用。控制台应用程序无法显示当前 OEM 编码中无法表示的字符。

由于`tasklist`是控制台模式应用程序，其输出始终采用当前的 OEM 编码。

对于英文系统，这对通常是[Windows-1252](http://en.wikipedia.org/wiki/Windows-1252)和[CP850](http://en.wikipedia.org/wiki/Code_page_850)。

由于我在俄罗斯，我的系统具有以下编码：[Windows-1251](http://en.wikipedia.org/wiki/Windows-1251)和[CP866](http://en.wikipedia.org/wiki/Code_page_866)。
如果我将输出捕获`tasklist`到文件中，则文件无法正确显示西里尔字符：

> 在记事本中查看时，我得到`ЏаЁўҐв`而不是`Привет` *（嗨！） 。*
> 并`µTorrent`显示为`зTorrent`。

您不能更改`tasklist`.

* * *

但是，可以更改`cmd`. 如果您将`/u`switch 传递给它，它将以 UTF-16 编码输出所有内容。

```
cmd /c echo Hi>echo.txt 
```

的大小`echo.txt`为 4 个字节：两个字节用于`Hi`换行，两个字节用于换行（`\r`和`\n`）。

```
cmd /u /c echo Hi>echo.txt 
```

现在 的大小`echo.txt`是 8 个字节：每个字符用两个字节表示。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-20T17:28:31.723

为什么不通过[JNA](https://github.com/twall/jna)使用 Windows API ，而不是生成进程？像这样：

```
import com.sun.jna.platform.win32.Kernel32;
import com.sun.jna.platform.win32.Tlhelp32;
import com.sun.jna.platform.win32.WinDef;
import com.sun.jna.platform.win32.WinNT;
import com.sun.jna.win32.W32APIOptions;
import com.sun.jna.Native; 

public class ListProcesses {
    public static void main(String[] args) {
        Kernel32 kernel32 = (Kernel32) Native.loadLibrary(Kernel32.class, W32APIOptions.UNICODE_OPTIONS);
        Tlhelp32.PROCESSENTRY32.ByReference processEntry = new Tlhelp32.PROCESSENTRY32.ByReference();          

        WinNT.HANDLE snapshot = kernel32.CreateToolhelp32Snapshot(Tlhelp32.TH32CS_SNAPPROCESS, new WinDef.DWORD(0));
        try  {
            while (kernel32.Process32Next(snapshot, processEntry)) {             
                System.out.println(processEntry.th32ProcessID + "\t" + Native.toString(processEntry.szExeFile));
            }
        }
        finally {
            kernel32.CloseHandle(snapshot);
        }
    } 
} 
```

[我在其他地方](https://stackoverflow.com/a/13478508/1205867)发布了类似的答案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-12T19:00:46.237

有一种更好的方法可以检查正在运行的进程，甚至可以通过 java 运行 OS 命令：[Process](http://docs.oracle.com/javase/7/docs/api/java/lang/Process.html)和[ProcessBuilder](http://docs.oracle.com/javase/7/docs/api/java/lang/ProcessBuilder.html)。

关于 Charset，您可以随时查询操作系统支持的 charset，根据需要获取[Encoder](http://docs.oracle.com/javase/1.4.2/docs/api/java/nio/charset/CharsetEncoder.html)或[Decoder 。](http://docs.oracle.com/javase/1.4.2/docs/api/java/nio/charset/CharsetDecoder.html)

[编辑]让我们分解一下；无法知道给定 String 的字节在哪种编码中，因此您唯一的选择是获取这些字节，根据需要改变顺序（如果您曾经处于这样的环境中，其中一个进程可以为您提供一个数组不同顺序的字节，使用 ByteBuffer 处理），并使用支持的多个 CharsetDecoder 将字节解码为合理的输出。

这太过分了，需要您估计给定的输出可能是 UTF-8、UTF-16 或任何其他编码。但*至少*您可以使用其中一种可能的字符集解码给定的输出，然后尝试使用处理后的输出来满足您的需要。

由于我们讨论的是由运行 JVM 本身的同一操作系统运行的进程，因此您的输出很可能是 availableCharsets() 方法返回的字符集编码之一。****

# asp.net-mvc - 如何使用 Automapper 从简单对象和方法调用创建复杂的视图模型对象

> ID：13348812
> 
> 赞同：1
> 
> 时间：2012-11-12T17:52:48.170
> 
> 标签：asp.net-mvc, entity-framework-4, viewmodel, automapper

我的应用程序需要显示一个客户数据表，其中包括有关客户的数据以及他从给定仓库中的最新订单的数据。客户域对象包含一个 GetLatestOrder(warehouseId) 方法。

我有一个 CustomerView 视图模型，并希望能够使用来自客户对象的一些字段以及来自最新订单对象的一些字段来填充它。我可以使用 Automapper 执行此操作吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T05:08:21.327

尝试这个，

在`Global.asax.cs`[ `Application_Start`] 中，`public static void AppInitialize()`

```
 protected void Application_Start(object sender, EventArgs e)
    {
        Mapper.CreateMap<Order, CustomerViewModel>()
             .ForMember(destination => destination.OrderId, options => options.MapFrom(source => source.Id))
             .ForMember(destination => destination.OrderName, options => options.MapFrom(source => source.Name));
        Mapper.CreateMap<Customer, CustomerViewModel>()
             .ForMember(destination => destination.CustmerId, options => options.MapFrom(source => source.Id))
             .ForMember(destination => destination.CustmerName, options => options.MapFrom(source => source.Name))
             .ForMember(destination => destination.OrderId, options => options.MapFrom(source => Mapper.Map<IEnumerable<Order>, IEnumerable<CustomerViewModel>>(source.Orders).FirstOrDefault().OrderId))
             .ForMember(destination => destination.OrderName, options => options.MapFrom(source => Mapper.Map<IEnumerable<Order>, IEnumerable<CustomerViewModel>>(source.Orders).FirstOrDefault().OrderName));
    } 
```

在您的代码中调用映射器，如下所示，

```
 var lstCustomers = new List<Customer>
        {
            new Customer { Id = 1, Name="Name", Orders = new List<Order> { new Order { Id = 1000, Name ="Some Name"}}},
        };

        var result = Mapper.Map<IEnumerable<Customer>, IEnumerable<CustomerViewModel>>(lstCustomers); 
```

我推测你的课程如下所示，

```
public class Customer
{
    public int Id { get; set; }
    public string Name { get; set; }
    public List<Order> Orders { get; set; }
}

public class Order
{
    public int Id { get; set; }
    public string Name { get; set; }
}

public class CustomerViewModel
{
    public int CustmerId { get; set; }
    public string CustmerName { get; set; }
    public int OrderId { get; set; }
    public string OrderName { get; set; }
} 
```

另请参阅此[帖子](https://stackoverflow.com/questions/13338262/automapper-and-flattening-nested-arrays/13338523#13338523)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T17:54:59.867

是的你可以：

```
var vm = new CustomerViewModel();
Mapper.Map(customer, vm);
Mapper.Map(order, vm); 
```

每个映射将填充它配置的属性并保留其余部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-13T10:13:26.137

最后，我采取了简单的方法，找不到另一种方法：

在 Application_start 中：

```
 Mapper.CreateMap<Customer, CustomerView>();
    Mapper.CreateMap<Order, CustomerView>(); 
```

在控制器方法中：

```
 IEnumerable<Customer> customers = GetCustomers(false)
                                               .OrderBy(c => c.Name);
    IEnumerable<CustomerView> viewData = Mapper.Map<IEnumerable<Customer>, IEnumerable<CustomerView>>(customers);
    foreach (Customer customer in customers)
    {
        CustomerView view = viewData.Where(cv => cv.CustomerId == customer.CustomerId).First();
        Mapper.Map(customer.GetLatestOrder(WarehouseId), view);
    } 
```

# java - 输入不带扩展名的文件名(java)

> ID：13348819
> 
> 赞同：0
> 
> 时间：2012-11-12T17:53:15.677
> 
> 标签：java, servlets

请帮助解决问题，有一个表格，这里是代码：

```
<form action="test" method="Post">
<input type="text" name="text" autofocus >
<input type="submit" value="">
</form> 
```

我在其中输入文件的名称，然后将名称传递给 servlet。这是一段servlet代码：

```
protected void doPost(HttpServletRequest request, HttpServletResponse response) 
            throws ServletException, IOException{
        request.setCharacterEncoding("UTF-8");
        response.setContentType("text/html; charset=UTF-8");

        String myName = request.getParameter("text"); 
```

我有一个表格可以输入这样的文件名：test.txt，你可以只输入一个测试，没有txt？我会非常感谢答案，如果你给他们一段代码）我只输入扩展名为 txt 的文件，不需要

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T18:03:45.403

我不明白你想要什么。你能解释得更好吗？

您想从 HTML 调用 servlet 吗？如果是这样，那么您必须将地址放在

```
<form action="servlet_url" method="post"> 
```

其中 servlet_url 是 servlet 地址。如果 servlet 在您的项目中带有 html 网页，那么很容易找到 URL，如果不是这样，您应该使用 servlet 部署应用程序并在应用程序服务器中查看最终 url（tomcat、weblogic、jboss ， ETC）。

您谈论在代码中附加“.text”，像这样？

```
String myName = request.getParameter("text");
if (myName != null && myName.length() > 0) {
    myName += ".txt";
} 
```

如果您想查看名称中是否已包含“.txt”，您可以使用任何 String api 进行验证，例如：

```
if(!myName.endsWith(".txt")) myName += ".txt"; 
```

或者你可以加入这两种方法！

何塞·克鲁兹

# excel - 向下拖动公式并更改 COLUMN 引用而不是 ROWS

> ID：13348825
> 
> 赞同：10
> 
> 时间：2012-11-12T17:53:39.700
> 
> 标签：excel, drag

我在 Excel 中的 E5 行中有这个公式：

```
=SUM(Banco!H$5;Banco!H$6;Banco!H$8;Banco!H$9;Banco!H$10;Banco!H$11) 
```

当我向下拖动它时，我需要它来更改 COLUMN 引用而不是 ROWS （基本上就像我拖动它一样）......例如：

```
=SUM(Banco!I$5;Banco!I$6;Banco!I$8;Banco!I$9;Banco!I$10;Banco!I$11)
=SUM(Banco!J$5;Banco!J$6;Banco!J$8;Banco!J$9;Banco!J$10;Banco!J$11)
=SUM(Banco!K$5;Banco!K$6;Banco!K$8;Banco!K$9;Banco!K$10;Banco!K$11) 
```

有什么线索吗？

非常感谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-12T18:00:34.160

...使用偏移功能。

例如 - 假设您在第 1 行有一个公式并且您想引用`Banco!H5`，您可以执行以下操作：

```
=OFFSET(Banco!$G$5,0,ROW()) 
```

现在，当您向下拖动它时，它将被您向下移动的行数抵消。

因此，您的新公式如下所示：

```
=SUM(OFFSET(Banco!$G$5,0,ROW()),OFFSET(Banco!$G$6,0,ROW()),OFFSET(Banco!$G$8,0,ROW()),OFFSET(Banco!$G$9,0,ROW()),OFFSET(Banco!$G$10,0,ROW()),OFFSET(Banco!$G$11,0,ROW())) 
```

同样，这假设您将此公式粘贴到第 1 行（我知道这很丑，但您指定了特定的单元格，因此您必须分别指定每个单元格）

希望这是有道理的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-07-27T14:12:52.000

使用 OFFSET 和 COUNTA 函数的组合。每次向下一行时，OFFSET 函数都会给出 COUNTA 列的偏移量。使 counta 函数计算将整个函数拖入的行上方的行数（也就是每次将函数拖到额外的行时，它都会加 1）

# advantage-database-server - Code First 的 Advantage Database Server 11 连接字符串

> ID：13348827
> 
> 赞同：1
> 
> 时间：2012-11-12T17:53:41.910
> 
> 标签：advantage-database-server

我首先遇到代码的 ADS11 连接字符串问题，

我尝试了很多方法，但我无法做到。

有谁知道，请指教。

这是我的工作环境。

* * *

服务器：优势数据库服务器 11

路径：\ADS_DB:6262\DB\DBB.ADD（端口：62​​62）

测试访问表：WEBORDERLN（ADT 类型）

PK：PK（字符（36））

* * *

我下载了 Advantage.Data.Provider v11 和 Advantage.Data.Entity v11。并添加参考。

网页配置

```
<connectionStrings>
    <add name="Ads_Context" connectionString="Data Source=\\ADS_DB:6262\DB\DBB.ADD;User ID=xxx;Password=xxx;ServerType=REMOTE;" providerName="Advantage.Data.Provider" />
</connectionStrings> 
```

控制器，

```
public class Ads_Context : DbContext
{
    public Ads_Context(): base("name=Ads_Context")
{   
}
public DbSet<WebOrderLN> webOrderLns { get; set; }
}

public class HomeController : Controller
{
    //
    // GET: /Home/

    public string Index()
    {
        var context = new Ads_Context().webOrderLns.ToList(); // Source error point to here

        return "A";
    }

}
[Table("WEBORDERLN")]
public class WebOrderLN
{
    [Key]
    public string PK {get; set;}
    public string FK { get; set; }
    public string pickno { get; set; }
} 
```

当我运行上面的代码时，我收到一条错误消息，

```
Server Error in '/' Application.
Error 7200:  AQE Error:  State = HY000;   NativeError = 5174;  [iAnywhere Solutions][Advantage SQL][ASA] Error 5174:  Advantage failed to open the specified link.  dbo: Error 7041:  File not found.  Verify the specified path and file name is correct. Table name: WEBORDERLN  AdsCommand query execution failed. 
```

有谁知道，我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T15:07:36.757

尝试将 ::this 的模式名称添加到代码中的表中。

```
[Table( "WEBORDERLN", Schema = "::this" )]
public class WebOrderLN
{
    [Key]
    public string PK {get; set;}
    public string FK { get; set; }
    public string pickno { get; set; }
} 
```

请参阅此知识库项目 [http://devzone.advantagedatabase.com/dz/content.aspx?Key=17&RefNo=120423-2510](http://devzone.advantagedatabase.com/dz/content.aspx?Key=17&RefNo=120423-2510)

# php - PHP & MySQL 从数据库中选择

> ID：13348828
> 
> 赞同：0
> 
> 时间：2012-11-12T17:53:42.167
> 
> 标签：php, mysql, select

我正在从我的数据库中选择数据，但它仍然在说我在游戏中。当我不在时，我会检查。

任何线索如何解决这个问题？

```
 $moneda = (CMS == 'uber' ? $users->GetUserVar(USER_ID, moneda) : $myrow[moneda]);
        $isonline = mysql_query("SELECT `online` FROM `users` WHERE `username` = ".$_POST['Naam']."");
        $error = array();
        if($isonline == 1)
                $error[] = "De ander moet uit het hotel gaan voordat je belpixels kunt overschrijven."; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T17:57:39.353

```
$isonline = mysql_query("SELECT `online` FROM `users` WHERE `username` =".$_POST['Naam'].""); 
```

$isonline is not your answer..dude it contains the result object, not the result.

```
$row=mysql_fetch_assoc($isonline);
if($row['online']==1){} 
```

and use of mysql_query is long deprecated, switch to PDO

and

`$isonline = mysql_query("SELECT online FROM` ..

sql you never put quotations around column names...get rid of the ones around username too.and get one around the username value this one here:

```
$isonline = mysql_query("SELECT online FROM users WHERE username ='".$_POST['Naam']."'"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T18:02:34.483

mysql_query 从不返回单个用户记录；它返回一个 PHP 资源，即使您知道 SQL 查询只会返回一条记录。

换句话说： $isonline 不是该变量的正确名称。将其命名为 $online_query_results，然后调用

```
$user_record = mysql_fetch_array($online_query_results); 
```

这将返回第一个（仅在这种情况下）结果行。然后，不是测试 $isonline，而是测试

```
$user_record['online'] 
```

# c# - 指数数组的边界之外

> ID：13348833
> 
> 赞同：0
> 
> 时间：2012-11-12T17:53:47.473
> 
> 标签：c#

朋友们

我有一个错误，它告诉“索引超出了数组的范围”我不知道它正在发生，因为在完成 for 循环并再次进入循环之后，它在之前从循环退出时显示了变量值。

```
 int[,] arrScr = new int[lstTest.Count, cnt2 + 3];
        string[,] arrName = new string[lstTest.Count, cnt2 + 3];
        int p;

        for (i = 0; i < lstTest.Count; i++)
        {
            using (DataTableReader dtr3 = ds.Tables["scord_mark_table" + (i + 1).ToString()].CreateDataReader())
            {
                p = 0;
                while (dtr3.Read())
                {
                    arrName[i, 2 + p] = dtr3[15].ToString();
                    for (int k = 2; k < 12; k++)
                    {
                        arrScr[i, 2 + p] += Convert.ToInt32(dtr3[k].ToString());
                    }
                    p++;
                }
            } 
```

![在此处输入图像描述](../Images/f24ae6af140a450a3445649f932f300e.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T17:55:23.977

更改`k <= 12`为 `k < 12`。

如果这不是你的问题的原因，你应该重写`k <= 12`， `k < 13`因为这是大多数编码器用来读写的约定。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-12T18:44:37.903

里面有什么`dtr3[12]`？它回来了`null`吗？
的价值是`cnt2`多少？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-12T17:55:32.747

这意味着您的数组不包含您尝试访问的那么多元素。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-12T17:58:01.080

它将以 k = 13 退出循环，因为 k 的最后一个有效值是 12，然后它通过循环，执行 k++（使其变为 13）。此时它不符合条件，因为 13 > 12 并且那是它实际退出的时间。

# c++ - 从二维向量中移除向量

> ID：13348839
> 
> 赞同：0
> 
> 时间：2012-11-12T17:54:19.703
> 
> 标签：c++, vector

我有一个包含 600 个值的 96 个块的 2D 向量，这就是我想要的。

我需要删除不包含足够能量的（块）。我已经设法计算了能量，但不知道哪种方法可以更好地去除不包含足够能量的（块）。

在您看来，创建一个临时 2D 向量会更好，它会推回确实包含足够能量的块，然后从内存中删除原始向量，或者......

我应该从该特定位置的向量中删除块吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T19:06:46.757

我假设你有这个：

```
typedef std::vector<value> Block;
typedef std::vector< Block > my2dVector; 
```

你有这样的功能：

```
bool BlockHasInsufficientEnergy( Block const& vec ); 
```

并且您想删除没有足够能量的块。

删除，您的意思是您希望之后的块数少于 96 个吗？我会这样假设。

那么正确的做法是：

```
void RemoveLowEnergyBlocks( my2dVector& vec )
{
  my2dVector::iterator erase_after = std::remove_if( vec.begin(), vec.end(), BlockHasInsufficientEnergy );
  vec.erase( erase_after, vec.end() );
} 
```

以上可以在一行中完成，但是通过两行完成，发生的事情应该更清楚。

`remove_if`找到通过第三个参数条件的所有内容，并将其过滤到范围之外。`vector`它返回生命尽头的“垃圾”点。然后我们清除垃圾。这称为remove-erase idiom。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T18:01:40.733

也许您想使用链表，或者只是将过滤掉的项目设置为 NULL，或者用 bool 成员标志标记它们，或者保留一个单独的过滤项目索引向量（如果您同时有多个过滤器，这可以节省内存） .

解决方案因约束条件而异。你需要随机访问吗？对象复制需要多少？等等。

您还可以查看 STL 代码（这是 STL 的向量，对吗？）并检查它是否符合您的要求 - 即复制向量数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T18:02:26.107

这部分取决于在这种情况下如何更好地定义。任何一种方法都可能有优势，但很难确切地知道它们是什么。最有可能的是，就内存和处理性能而言，从向量中删除您不想要的确切位置而不是分配一个全新的位置可能会稍微“更好”。为此目的考虑使用双端队列或列表可能会更好，因为它们可以避免向量在尝试保持连续的内存段时可能进行的大量重新分配。

# php - 使用 php 在不更改 config.ini 的情况下包含外部 .php 文件

> ID：13348841
> 
> 赞同：1
> 
> 时间：2012-11-12T17:54:22.847
> 
> 标签：php

您好我想在我的 php 文件中包含一个外部 .php 文件。

这个 .php 文件在我的页面中需要一些变量声明。

我尝试使用 file_get_contents 但它只是呼应里面的行。

试过：

```
function getter($url) {
    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL, $url);
    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    curl_setopt($ch, CURLOPT_HEADER, 0);
    $data = curl_exec($ch);
    curl_close($ch);
    return $data;
}

echo getter('www.somehting.com/phpfile.php'); 
```

-还是行不通

也试过：

```
$code = file_get_contents($url);
eval($code); 
```

无论如何我可以在不更改 config.ini 的情况下执行此操作吗？

我可以在应该包含该文件的页面上访问 .htaccess。

该文件位于不同的服务器“机架空间”上。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T17:57:27.623

You cannot include an external php file, unless the .php file is outputing the php source. Otherwise you will just get the interpreted php file from the external source.

The only thing you can do is output the .phps (source) so that you can access the actually code. Like I said above, you would be accessing the *processed / interpreted* php file, which would do you no good.

If you have access to the other server, you can try outputing the file.phps instead of file.php

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T18:04:26.667

如果您通过网址在外部服务器上加载文件，Apache 将在 php 完成*后显示该页面。*

所以它会返回

```
Hello world! 
```

代替

```
<?php
echo 'Hello world!';
?> 
```

但是，您可以尝试使用[ftp 连接](https://www.google.nl/#hl=nl&safe=off&sclient=psy-ab&q=php+ftp_connect&oq=php+ftp&gs_l=hp.3.1.0l4.151954.155743.0.156968.9.7.1.0.0.0.1381.2104.6-1j1.2.0...0.0...1c.1.8d0lLArG1RQ&pbx=1&bav=on.2,or.r_gc.r_pw.r_qf.&fp=fc8346b0e954a46f&bpcl=38093640&biw=1680&bih=930)连接到外部服务器并检索您想要的文件。这将要求您具有对其托管服务器的管理员访问权限。

# windows-runtime - WebAuthenticationBroker 可以使用持久性 cookie 吗？

> ID：13348842
> 
> 赞同：2
> 
> 时间：2012-11-12T17:54:26.173
> 
> 标签：windows-runtime, single-sign-on

从[`WebAuthenticationBroker`](http://msdn.microsoft.com/en-us/library/windows/apps/windows.security.authentication.web.webauthenticationbroker.aspx)该类的文档中，该对象似乎存在以支持单点登录方案以及我尝试使用它的 OAuth2 流程。作为其行为的一部分，它似乎创建了一个与系统其余部分完全分离的浏览环境，并主动清除通过登录过程生成的所有持久性 cookie。

这导致我的问题是每次我的用户进入我的应用程序时，都会提示他们使用他们的凭据登录。这与我对 SSO 的期望背道而驰，并且似乎使此类不适合大多数情况。

是否有某种方法可以使 cookie 持续存在，就像它们在普通浏览器中所做的那样，这样我就不必再次登录我的 Google 帐户了？

# clojure - 在 Clojure 中，当您在另一个 sql/with-connection 中调用 sql/with-connection 时会发生什么？

> ID：13348843
> 
> 赞同：1
> 
> 时间：2012-11-12T17:54:26.297
> 
> 标签：clojure, database-connection

```
(sql/with-connection *db-atom* (insert-data value1 value2)
 (sql/with-connection *db-atom* (read-tuple-as-map))) 
```

从上面的示例中，嵌套是否`sql/with-connection`打开了与数据库的新连接？还是使用之前创建的那个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T22:33:37.147

我一般建议使用 clojure.java.jdbc 而不是 clojure.contrib.sql，因为后者不应该与 1.2.0 之后的 clojure 一起使用。

在 clojure.java.jdbc 中，使用绑定将连接添加到*db*`with-connection` var中的连接映射以用于任何包装的调用，因此第二个将覆盖第一个。

 *来自：[jdbc.clj](https://github.com/clojure/java.jdbc/blob/master/src/main/clojure/clojure/java/jdbc.clj#L297)

```
(defn with-connection*
  "Evaluates func in the context of a new connection to a database then
  closes the connection."
  [db-spec func]
  (with-open [^java.sql.Connection con (get-connection db-spec)]
    (binding [*db* (assoc *db* :connection con :level 0 :rollback (atom false))]
      (func)))) 
```*

# php - 当命名空间和类在 PHP 中共享名称时会发生什么？

> ID：13348844
> 
> 赞同：7
> 
> 时间：2012-11-12T17:54:26.393
> 
> 标签：php, namespaces

当使用 PEAR 和 Zend 的伪命名空间模式时，通常会遇到如下所示的类层次结构：

```
Zend/
    Db.php
    Db/
        Expr.php 
```

其中 DB.php 包含一个名为的类`Zend_Db`，而 Expr.php 包含一个名为 的类`Zend_Db_Expr`。但是，当您尝试将旧的 5.2 伪命名空间转换为 PHP 5.3 命名空间时，您会遇到命名空间和类共享名称的情况。由于 use 运算符可以导入命名空间或类名，这会导致歧义。

这是我正在转换的应用程序示例：

```
App/
    Core.php
    Core/
        Autoloader.php 
```

这里的基本目录和命名空间是 App。在名称空间的顶层是一个`Core`类：

```
namespace App;
class Core { } 
```

在 Core 目录中是其他各种核心类，其中一些使用 main `Core`. 在伪命名空间模式下，这不是问题。但在实际命名空间模式中，它会产生这种情况：

```
namespace App\Core;
use App\Core as Core;  // What is this importing?  Namespace or class?

class Autoloader {
    public function __construct(Core $core) {}
} 
```

这是定义的吗？这里实际导入的是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T18:33:47.703

两者兼而有之。这不是真正的导入，只是对编译器的提示，在类相关操作中每次遇到此别名都应扩展为此声明。在 php 中，命名空间只是类的一部分，所以可以这样想

```
$alias = 'Zend_Db';
$zendDB = new $alias;
$aliasExpr = $alias . '_Expr';
$expr = new $aliasExpr; 
```

# android - 解释不同的导航类型，Android

> ID：13348845
> 
> 赞同：4
> 
> 时间：2012-11-12T17:54:31.133
> 
> 标签：android, navigation

我已经设置了一段时间的应用程序，现在我确切地知道我在做什么，我已经准备好重新启动并制作一个更加用户友好的新版本。在创建应用程序时，Eclipse 想知道我想要什么导航类型。

```
None
Tabs
Tabs+Swipe
Swipe View+Title Strip
Dropdown 
```

有人可以解释（或给出解释的链接）底部四个选项的外观以及如何使用它们吗？到目前为止，我使用的只是“无”选项，我只是使用按钮和菜单进行导航。我想了解使我的应用程序尽可能时尚的其他选项。

--这部分已回答：[http ://android-er.blogspot.com/2012/06/various-navigation-type-provided-in-new.html](http://android-er.blogspot.com/2012/06/various-navigation-type-provided-in-new.html)

但是这个问题的第二部分：是否有可能在一个时间点有一种导航，而在不同的时间有另一种类型的导航？

示例：启动启动屏幕，转到登录屏幕。登录后，转到菜单。如果他们选择“编辑表单”，它会将他们带到一个`Swipe Views + Title Strip`设置，其中每个不同的视图都是不同的表单。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-12T17:58:12.347

这是你想要的吗？这是第一个搜索结果。[http://android-er.blogspot.com/2012/06/various-navigation-type-provided-in-new.html](http://android-er.blogspot.com/2012/06/various-navigation-type-provided-in-new.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T17:58:17.553

那是你要找的吗？ [安卓开发者](http://developer.android.com/training/design-navigation/index.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-27T19:57:02.797

由于您的问题的第一部分已经回答，我还不能发表评论，我会认为这是您第二个问题的“答案”：

在 Stack Overflow 上发布多部分问题通常被认为是不合适的。为什么你可能会问？对于与这种情况完全相同的情况。您的问题已回答了一半，并认为该答案是正确的，但是……第二个问题呢？如果有人决定回答它并给出一个好的答案怎么办。只有一个人的答案可能被标记为正确。考虑到这些评分会改变您在 Stack Overflow 上的互动水平，仅仅因为它们是由 2 个不同的人给出的，就接受一半而不是另一半是错误的。

如果您有一个问题在某种程度上是您第一个问题的子集，请对您需要详细说明的答案发表评论。即：（问题 1 =“什么是类？”；问题 2 =“我为什么需要这样的功能？”；）

如果您的第一个想法是分叉问题，请创建一个新问题。即：（问题1 =“什么是类？”；问题2 =“实例化对象意味着什么？”；）

如果核心主题不同，您应该创建一个新问题。否则你发表评论。但除非他们有相同的问题/解决方案，否则切勿将 2 个问题放在 1 中。

无论如何...最好的祝愿，在一年前的帖子上=P

# jquery - 动态 jQuery 滑块未出现

> ID：13348847
> 
> 赞同：0
> 
> 时间：2012-11-12T17:54:37.377
> 
> 标签：jquery

我想加载一个带有 AJAX 调用结果的页面，它工作正常，但对于每个结果，还应该有一个 jQuery 滑块。如果我创建一个静态 php 页面并显示结果，则代码可以正常工作。但是当我将结果加载到另一个页面时，滑块没有出现。它的位置有效，并`console.log(s)`告诉我滑块正在更新，但视觉上没有实际的滑块。

我在 Stackoverflow 上发现了一些帖子提到您需要使用`.page()`，但我在 jQuery 的网站上找不到关于此的信息。

有没有人通过 AJAX 请求动态创建滑块的经验？有没有更好的方法？

滑块用于自定义音频播放器。

提前致谢。

**编辑：**添加代码

**编辑：** `$('.slider').slider();`添加

**编辑：**不需要响应页面

**主页：**

```
function showInfoTracks(){
    ajaxConnection.onreadystatechange = function(){
        if (ajaxConnection.readyState == 4 && ajaxConnection.status == 200) {
AJAX RESPONSE               
        }
    }
    ajaxConnection.open("GET", "file.php, true);
    ajaxConnection.send();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T18:06:48.467

您的代码可能`.page()`会导致无限循环。这就是为什么它只是继续加载日志而不给出结果的原因。

这是一个链接。[JQuery Mobile .page() 函数导致无限循环？](https://stackoverflow.com/questions/6624664/jquery-mobile-page-function-causes-infinite-loop)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T03:05:15.163

答案最终是在 AJAX 响应部分中定义滑块。

```
 $(document).ready(function() {

                $(document).on('mouseenter', '.playButton', function() {    
                    var newSliderID = this.id;
//Run this if so that you dont reload the same slider over and over again
                    if($("#sliderActivated"+newSliderID).val() == 0){
                        $("#sliderActivated"+newSliderID).val(1);
                        $( "#slider"+newSliderID ).slider({ 
                            animate: true ,
                            value: 0,
                            min: 0,
                            start: function( event, ui ) {
                                ...
                            },
                            slide: function( event, ui ) {
                                ...
                            },
                            stop: function( event, ui ) {
                                ...
                            }

                        });
                    }

                }); 
            }); 
```

# mysql - SQL 查询使用其动态行数据作为列名重建表

> ID：13348850
> 
> 赞同：1
> 
> 时间：2012-11-12T17:54:39.550
> 
> 标签：mysql, sql, dynamic, pivot

我现有的表是这样的：

```
ID 授予小计月份
1 孵化 144.56 Nov-2012
2 NIH 240.9 Nov-2012
3 NSF 100.7 Nov-2012
4 其他 276.67 Nov-2012
5 NSF 234.53 Oct-2012
6 DOE 214.35 Oct-2012
7 孵化 321.54 Oct-2012
8 其他 312.35 Oct-2012
9 NSF 156.89 Sep-2012
10 孵化 147.99 Sep-2012
11 其他 245.67 Sep-2012
12 州 148.66 Sep-2012

```

该表列出了每笔赠款的每月费用。随着时间的推移，行数越来越多。在授权列中，名称大部分时间保持不变。当有新的赠款可用时，它会出现在这里。这种情况并不经常发生。

现在我想将数据绘制成图表，这样人们就可以看到每个月花费了多少资金。为此，我想像这样重塑表格：

```
ID 月 DOE Hatch NIH NSF 其他州
2012 年 11 月 1 日 144.56 240.9 100.7 276.67  
2012 年 10 月 2 日 214.35 321.54 234.53 312.35  
2012 年 9 月 3 日 147.99 156.89 245.67 148.66

```

所需的新表保留了 Month 列（distinct），但会将原始表中 Grant 列（distinct）的所有数据值用作列名（动态）。这些新列将 Subtotal 列的相应数据值作为其数据。

有人可以帮助构建查询吗？非常感谢。

顺便说一句：我正在使用 MySQL/PHP。我是新手。任何示例代码都非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T18:36:16.573

这基本上是一个`PIVOT`但 MySQL 没有 PIVOT 功能。因此，您将希望使用聚合函数和`CASE`语句来复制它。如果您知道`Grant`您拥有的值的数量，那么您可以对查询进行硬编码，如下所示：

```
select 
  Month,
  sum(case when `grant`='DOE' then subtotal else 0 end) DOE,
  sum(case when `grant`='Hatch' then subtotal else 0 end) Hatch,
  sum(case when `grant`='NIH' then subtotal else 0 end) NIH,
  sum(case when `grant`='NSF' then subtotal else 0 end) NSF,
  sum(case when `grant`='Other' then subtotal else 0 end) Other,
  sum(case when `grant`='State' then subtotal else 0 end) State
from yourtable
group by month 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/1c410/1)

现在，如果您有未知数量的值`Grant`，那么您可以使用准备好的语句来生成此查询的动态版本：

```
SET @sql = NULL;
SELECT
  GROUP_CONCAT(DISTINCT
    CONCAT(
      'sum(case when `Grant` = ''',
      `Grant`,
      ''' then Subtotal else 0 end) AS `',
      `Grant`, '`'
    )
  ) INTO @sql
FROM yourtable;

SET @sql = CONCAT('SELECT month, ', @sql, ' 
                  FROM yourtable 
                  group by month');

PREPARE stmt FROM @sql;
EXECUTE stmt;
DEALLOCATE PREPARE stmt; 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/1c410/3)

两者都产生相同的结果：

```
|    MONTH |  HATCH |   NIH |    NSF |  OTHER |    DOE |  STATE |
-----------------------------------------------------------------
| Nov-2012 | 144.56 | 240.9 |  100.7 | 276.67 |      0 |      0 |
| Oct-2012 | 321.54 |     0 | 234.53 | 312.35 | 214.35 |      0 |
| Sep-2012 | 147.99 |     0 | 156.89 | 245.67 |      0 | 148.66 | 
```

# google-app-engine - 如何在 GAE 中实现自动建议（自动完成）功能

> ID：13348861
> 
> 赞同：7
> 
> 时间：2012-11-12T17:55:30.617
> 
> 标签：google-app-engine

我想在 Google App Engine (GAE/GWT) 中实现自动建议功能。

实现的客户端与 GWT SuggestBox 和 RPC 配合得很好。我的主要问题是实现的服务器端。我尝试了 Google 搜索 API，但似乎总索引数据有 250MB 的限制，并且可以对完整的单词而不是每个单词的一部分执行搜索！

我应该如何处理这个？我读到 GAE 不支持 lucene 或 solr。我会很感激你对此的想法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-12T18:15:13.553

您可以使用此处描述的这些技术实现基本文本搜索：http: [//googlecode.blogspot.com.br/2010/05/google-app-engine-basic-text-search.html](http://googlecode.blogspot.com.br/2010/05/google-app-engine-basic-text-search.html)

简而言之：

使用 构建查询`content >= yourQuery && content < yourQuery + "\ufffd"`，其中`content`实体的属性可以是字符串或字符串列表。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-12T19:32:29.643

我采用了这种方法，对我来说效果很好：

1.  将文本拆分为单独的单词。摆脱重复、特殊字符和短词（in、of 和等）。

2.  将此单词列表作为列表属性添加到实体。

3.  通过[文本范围查询搜索](https://stackoverflow.com/questions/11902019/what-is-the-best-filter-to-query-a-full-name-datastore-property-using-only-the-f/11902668#11902668)：`listProperty >= wordPart && listProperty < wordPart + "\ufffd"`

# normalization - 我在理解 1NF 时错过了什么

> ID：13348863
> 
> 赞同：0
> 
> 时间：2012-11-12T17:55:39.437
> 
> 标签：normalization

我有一个关于 1NF 的问题。当我从不同的来源读到一个表时，如果它不包含重复组，它就在 1NF 中。我通过在线给出的示例（通常是客户和联系人姓名等）来理解这一点，但是当涉及到我的具体数据时，我会遇到困难。

我有以下字段：

```
 ID  TOW  RECEIVER Phi01_L1 Phi01_L2 Phi01_L3
  1  4353  gpo1     0.007   0.006     0.4
  2  4353  gpo1     0.9     0.34      0.3 
```

那么，这里的这张表不是在1NF吗？应该怎样才能成为？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T18:15:00.867

## 什么是拳头范式（1NF）？

1NF-不允许`composite attributes, multivalued attributes, and nested relations`；单个元组的值是非原子的属性

## 如何将关系转换为 1NF？

**展开关系：**

*   增加相关的冒号数量（就像你做的那样）
*   增加行并更改主键值。（PK 将包括非原子属性）

因此，**您** `relation looks in 1-NF`处于**当前的关系状态。**您提出的解决方案是扩展。

**断关系：**

*   将关系分解为两个关系 - 例如从基本关系中删除非原子 col 并创建一个新关系并使用 PK 添加到新关系。

[范式在Elmasri/Navath](http://www.google.co.in/url?sa=t&rct=j&q=1%20normal%20navathe%20dbms&source=web&cd=2&cad=rja&ved=0CCUQFjAB&url=http://www.cse.hcmut.edu.vn/~ttqnguyet/DatabaseSystem/Reference/ENCh08.ppt&ei=bzmhUPOjJofMrQf8wYGABQ&usg=AFQjCNEEBCUcGOxgCSBCUVTKMGa2KGve0A)书中 得到了最好的解释

# windows - Opening cmd using psexec to a specific remote directory

> ID：13348865
> 
> 赞同：1
> 
> 时间：2012-11-12T17:55:53.360
> 
> 标签：windows, internet-explorer, psexec

The goal is to delete the temporary internet files on a remote computer.

```
start psexec -u domain\username  -p password  -s \\xxx.xxx.xxx.xxx
cmd cd C:\Documents and Settings\USERACCOUNT\Local Settings\Temporary Internet Files 
```

Which is connecting to the remote computer but just opening to `c:windows\system`. I am then able to `cd` to that directory and use `del /f /s /q *.*` to delete all the problem files.

I tried using `psexec \\computer cmd /c del fileName` but had even less luck with that.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T17:04:15.273

Why bother cd'ing to directory first? This should work:

```
psexec \\1.2.3.4 -u "domain\username" -p "password" cmd /c del /f /s /q "C:\Document and Settings\USERACCOUNT\Local Settings\Temporary Internet Files" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-15T22:39:25.870

I finally got it to work using

```
psexec -u domain\user  -p password \\xxx.xxx.xxx.xxx -s cmd /c rd "C:\Documents and Settings\%USERACCOUNT%\Local Settings\Temporary Internet Files\Content.IE5\" /s /q 
```

which connects to the remote server, goes straight to the directory I want and proceeds to delete the particular temp internet files folder that's causing issues without bothering me at all.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-27T15:51:40.247

Your command is okay but missing the server name

```
psexec \\\servername -u ... 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-05-07T07:13:11.750

Use the below command to create a directory in remote location.

`psexec \\\IPAddress -u username -p Password cmd /c mkdir c:\testfolder`

# mysql - MySQL 只收到一条记录

> ID：13348866
> 
> 赞同：1
> 
> 时间：2012-11-12T17:56:06.737
> 
> 标签：mysql

我不确定这是否可能。我的问题是从数据库中只获取一行。下表描述：

```
CREATE TABLE IF NOT EXISTS `t_translate_content_pages` (
  `translate_content_page_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `content_page_id` int(10) unsigned NOT NULL,
  `language_code` varchar(3) NOT NULL,
  `content_page_title` varchar(255) NOT NULL,
  `content_page_text` text NOT NULL,
  PRIMARY KEY (`translate_content_page_id`),
  KEY `content_page_id` (`content_page_id`),
  KEY `language_id` (`language_code`)
) ENGINE=InnoDB  DEFAULT CHARSET=latin1 AUTO_INCREMENT=6 ;

INSERT INTO `t_translate_content_pages` 
(`translate_content_page_id`, `content_page_id`, `language_code`, `content_page_title`, `content_page_text`) VALUES
(3, 1, 'en', 'About', 'some text'),
(5, 1, 'ie', 'about', 'text'); 
```

我只需要得到一排。如果数据库中有`language_code`='ru' 的记录，则结果有该记录，如果没有`language_code`='en' 的记录。在Sql查询的WHERE子句中设置这个子句会很好。

向所有人致敬。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T17:57:57.897

```
select * from t_translate_content_pages
where language_code in ('ru', 'en')
order by case when language_code = 'ru' then 1 else 2 end
limit 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T18:12:09.537

在查询中使用 LIMIT 参数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T17:59:07.740

```
 SELECT * from language_code 
     WHERE language_code = (
          SELECT DISTINCT language_code from t_translate_content_pages
          WHERE language_code in ('en', 'ru')
          ORDER BY language_code DESC
          LIMIT 1)
     LIMIT 1 
```

子查询首先获取语言代码，然后获取它的匹配记录。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-12T18:02:03.243

为此，您需要根据语言偏好（而不是语言本身）进行排序。CASE 是一个很好的工具。

```
select * from t_translate_content_pages
ORDER BY CASE language_code
  WHEN 'ru' THEN 2
  WHEN 'en' THEN 1
  ELSE 0
END
DESC
LIMIT 1 
```

请注意，我故意不将查询限制为这些语言，原因有两个：

1.  我相信你知道怎么做
2.  值得考虑这一点，以便返回一些语言。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-12T23:22:32.037

我认为我找到了更好的解决方案。它在这里描述： [Best way to test if a row exists in a MySQL table](https://stackoverflow.com/questions/1676551/best-way-to-test-if-a-row-exists-in-a-mysql-table)

SQL 查询看起来像这样

```
SELECT * 
FROM `t_translate_content_pages`
WHERE content_page_id = 1 AND language_code = IF(EXISTS(
  SELECT `translate_content_page_id` 
  FROM `t_translate_content_pages` 
  WHERE language_code = 'ru' AND `content_page_id` = `t_translate_content_pages`.`content_page_id`
), 'ru', 'en') 
```

在这种情况下，我不使用 LIMIT 或 ORDER 子句。

# php - 从纬度/经度和“半径”创建边界框

> ID：13348869
> 
> 赞同：0
> 
> 时间：2012-11-12T17:56:15.203
> 
> 标签：php, latitude-longitude

我一直在寻找一段代码（最好在 PHP 中），它可以采用纬度、经度和加/减值（以公里为单位）并返回最小和最大纬度和经度。

我似乎找不到任何东西既能用简单的术语解释它的作用，又能考虑到地球的“臃肿”曲率。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T07:58:50.303

这很棘手，因为纬度/经度是一个角量，而您的半径距离是一个不相容的线性量。

以下是一些解决它的方法，按照准确度递减顺序和编码简单性递增顺序。

1.  使用投影库首先在投影坐标 (x,y) 中进行计算，然后重新投影回 (lat,lon)。有一个备受推崇的[proj4 库](http://proj4php.sourceforge.net/)的 php 端口，我看到[PEAR](http://pear.php.net/pepr/pepr-proposal-show.php?id=165)也有一个投影库。
2.  通过具有 WGS84 参数的椭球近似地球。[请参阅此问题](https://stackoverflow.com/questions/1125144/how-do-i-find-the-lat-long-that-is-x-km-north-of-a-given-lat-long)的已接受答案。
3.  用球体近似地球并使用球面三角法。[请参阅此问题](https://stackoverflow.com/questions/238260/how-to-calculate-the-bounding-box-for-a-given-lat-lng-location)的已接受答案。
4.  为您感兴趣的区域使用简单比例的近似转换因子。[请参阅此问题](https://stackoverflow.com/questions/1253499/simple-calculations-for-working-with-lat-lon-km-distance)的已接受答案。

我建议不要。1.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T14:24:21.553

为了让事情变得更容易，我已经切换到 MongoDB 的系统，目前正在使用 MongoHQ 的 REST API 来通过他们的地理 API 访问数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T18:03:54.683

不知道为什么要在纯 PHP 中执行此操作，但要`MySQL`支持`MongoDB`地理空间索引，它比任何纯 PHP 实现都具有巨大的性能优势。

我个人更喜欢这个`MongoDB`版本，因为它默认安装，你可以很容易地搜索

*   靠近
*   半径
*   盒子
*   多边形
*   距离

请参见

*   [MongoDB 中的地理空间索引](http://www.mongodb.org/display/DOCS/Geospatial+Indexing)
*   [12.16。空间扩展](http://dev.mysql.com/doc/refman/5.0/en/spatial-extensions.html)

# c# - Windows 商店中的 ComboBox 属性自动完成

> ID：13348870
> 
> 赞同：0
> 
> 时间：2012-11-12T17:56:15.980
> 
> 标签：c#, xaml, windows-8, windows-runtime, winrt-xaml

我在 Windows 商店应用程序中使用组合框控件，我需要具有搜索的自动完成属性，但我找不到它。知道如何使用它吗？纳克斯

玛丽亚

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T08:30:21.960

我已经编写了自己的 AutoCompleteBox 控件，可在[https://github.com/igorkulman/AutoCompleteBox获得](https://github.com/igorkulman/AutoCompleteBox)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T21:09:57.897

我认为没有内置任何东西，但是您检查过开源吗？这是当我在 google 上为它狂欢时出现的第一件事：

[http://autocompleteboxwinrt.codeplex.com/SourceControl/changeset/view/19567](http://autocompleteboxwinrt.codeplex.com/SourceControl/changeset/view/19567)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-26T23:49:41.887

Windows 应用商店应用没有内置的 AutoCompleteBox 控件。您可以考虑第三方控制，例如：

[http://www.telerik.com/products/windows-8/controls/auto-complete.aspx](http://www.telerik.com/products/windows-8/controls/auto-complete.aspx)

# c# - scrollable content page

> ID：13348876
> 
> 赞同：0
> 
> 时间：2012-11-12T17:56:35.913
> 
> 标签：c#, asp.net, html, css

I was trying to recreate a website which for now uses iframe without the iframe. But one of the main advantage of using the iframe is we have a fixed header and scrollable rest of the page and it remains like that for any screen size.

Now I am trying to recreate it using master page and the content page nested inside a scrollbale panel. It works only if I specify fixed height. So when the screen resolution is changed or someone minimizes the website window it doesn't look as good as the site with iframe. My master page is like this:

```
<body>
<form id="form1" runat="server">
<div>
 <table width=100%><tr><td>Test</td></tr><tr><td>Test</td></tr><tr><td>Test</td></tr><tr><td>Test</td></tr>
  <asp:Panel ID="panel1" runat="server"  height="100" Width="100%" ScrollBars="Auto">
    <asp:ContentPlaceHolder ID="main" runat="server">              
    </asp:ContentPlaceHolder>  
  </asp:Panel>
</td></tr></table>             
</div>
</form> 
```

My page load inside the content page is like this

```
 protected void Page_Load(object sender, EventArgs e)
    {
        for (int rowNum = 0; rowNum < 151; rowNum++)
        {

                TableRow tempRow = new TableRow();
                for (int cellNum = 0; cellNum < 11; cellNum++)
                {
                    TableCell tempCell = new TableCell();
                    tempCell.Text =
                        String.Format("({0}, {1})", rowNum, cellNum);
                    tempRow.Cells.Add(tempCell);
                }
                Table1.Rows.Add(tempRow);

        }
    } 
```

It works fine for maximized screen but if i minimize my screen i see two scroll bars. I want to see just one scroll bar for any screen resolution/size. How do i achieve that. Any inputs will be appreciated.

Thanks

# java - adding JAR class path in UBUNTU

> ID：13348877
> 
> 赞同：6
> 
> 时间：2012-11-12T17:56:36.760
> 
> 标签：java, ubuntu, classpath

This is might be a common question but I am not able to add class path for a JAR file in UBUNTU. I have given below all the details I know:

java is located here: the o/p of `which java` command is - `/usr/bin/java`

```
sudo vim /etc/bash.bashrc  
export CLASSPATH=$CLASSPATH:/downloads/aws-java-sdk-1.3.24/lib/aws-java-sdk-1.3.24.jar 
```

ps: downloads folder is directly under the root

```
sudo vim /etc/environment
CLASSPATH="/usr/lib/jvm/jdk1.7.0/lib: /downloads/aws-java-sdk-1.3.24/lib/aws-java-sdk-1.3.24.jar:" 
```

As you can see, I have added the class path in bashrc and etc/environment... but still I am getting an error while trying to run the `S3Sample.java` which comes with awssdk for java.

when I compile the java file, I get the following errors:

```
ubuntu@domU-12-31-39-03-31-91:/downloads/aws-java-sdk-1.3.24/samples/AmazonS3$ javac S3Sample.java

S3Sample.java:25: error: package com.amazonaws does not exist
import com.amazonaws.AmazonClientException; 
```

Now, I clearly understand that the JAR file is not added to the class path and so I am not getting the error. I've also tried `javac` with the class path option - but it does not work :(

PS: JAVA home is set correctly as other java programs work properly.

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-08-05T22:11:25.163

要设置类路径，在大多数情况下，最好在调用and时使用`-cp`or参数。它使您可以更灵活地为不同的 Java 应用程序使用不同的类路径。`-classpath``javac``java`

使用`-cp`and`-classpath`参数，您的类路径可以包含多个 jar 和多个位置，并用`:`（冒号）分隔

```
javac -cp ".:/somewhere/A.jar:/elsewhere/B.jar" MyClass.java
java -cp ".:/somewhere/A.jar:/elsewhere/B.jar" MyClass 
```

示例中的类路径条目将类路径设置为包含当前工作目录 ( `.`) 以及两个 jar 文件`A.jar`和`B.jar`.

如果你想使用`CLASSPATH`环境变量，你可以这样做

```
export CLASSPATH=".:/somewhere/A.jar:/elsewhere/B.jar"
javac MyClass.java
java MyClass 
```

# python - Can't find Python.h header in path

> ID：13348880
> 
> 赞同：0
> 
> 时间：2012-11-12T17:56:43.393
> 
> 标签：python

I am trying to compile the source codes for a simulator which uses C++ and Python. However, it gives me this error:

```
Error: can't find Python.h header in ['path-to-my-python/include/python2.6']
Install Python headers (package python-dev on Ubuntu and RedHat) 
```

However, I can see that the header file is there and I have set the path to it. How can I fix or diagnosis the problem?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T04:54:11.190

当我在谷歌搜索[Error: can't find Python.h header in 时](https://www.google.com/search?q=%22Error%3a%20can%27t%20find%20Python.h%20header%20in%22&oq=%22Error%3a%20can%27t%20find%20Python.h%20header%20in%22)，第一个链接将我带到：

[http://comments.gmane.org/gmane.comp.emulators.m5.users/10463](http://comments.gmane.org/gmane.comp.emulators.m5.users/10463)

回到 5 月份，有人遇到了与您完全相同的问题，并且有人解释了如何解决它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T04:58:24.410

你的 path-to-my-python 是相对路径吗？如果是这样，也许编译器/make/builder 正试图转到不同的目录，因此找不到它。

你在用什么？制作？缺点？查看编译器/链接器标志是什么，并查看该路径的执行位置。这会给你一个想法。

# java - 使用 assertTrue 与其他人进行单元测试

> ID：13348883
> 
> 赞同：4
> 
> 时间：2012-11-12T17:57:04.200
> 
> 标签：java, unit-testing, junit

我在 TDD 环境中工作，我经常使用 assertTrue，而还有许多其他方法，例如 assert equals 等。我有一个类，我有 40 多个测试用例，它们都是 assertTrue。这是可以接受的吗？

我想问作为一种风格，这样合适吗？

有什么建议么？

如果你认为这个问题不合适，请告诉我我会删除它。

编辑：

```
 assertTrue(targetSpecifiers.size() == 2);
    assertTrue(targetSpecifiers.get(0).getPlacementId().compareTo(new BigInteger("1")) ==0);
    assertTrue(targetSpecifiers.get(1).getPlacementId().compareTo(new BigInteger("2")) ==0); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-12T18:00:57.900

使用其他断言的主要好处是它们可以更好地传达意图，并且在失败时可能会提供更有意义的默认消息。

例如

如果你写`assertEquals(2, x)`if`x`实际上是 1 那么失败消息将是：

```
java.lang.AssertionError: expected:<2> but was:<1> 
```

这比你写`assertTrue(x == 2)`的地方只有`AssertionError`堆栈跟踪更有帮助。

当您使用 TDD 时，这一点更为重要，因为当您首先编写失败的测试时，您希望确信测试失败的原因是您所期望的，并且不会发生任何意外行为。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-12T18:02:09.223

在适当的情况下，您应该使用正确的 assertXXX 方法，因为它们可以改进故障报告。例如，如果您正在测试让我们说 2 个字符串“abc”（预期）和“abxy”（实际）的相等性，那么使用**assertEquals**

```
assertEquals("abc", "abxy") 
```

**将提供比使用assertTrue**更容易推理的更好的输出，如下所示

```
assertTrue("abc".equals("abxy")) 
```

注意：还要注意指定**实际**参数和**预期**参数的位置。我看到很多开发人员没有遵循约定（junit 的约定），即预期应该是 assertXXX 方法的第一个参数。使用不当也会导致很多混乱

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-12T18:01:12.003

我的猜测是你有这样的东西：

```
assertTrue(expectedValue.equals(actualValue)); 
```

*那仍然会测试正确的事情*——但是当失败时，它只能告诉你断言失败了。如果你改用这个：

```
assertEquals(expectedValue, actualValue); 
```

......然后失败会说“预期：5；曾经：10”或类似的东西，这使得弄清楚发生了什么变得相当容易。

除非您断言方法返回的结果`boolean`或类似的东西，否则我发现`assertTrue`它很少有用。

如果你能举出你的断言的例子，我们也许可以把它们翻译成更惯用的断言。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-13T10:11:22.757

这些断言完全有效，但其他断言更容易阅读并提供更好的失败消息。

我建议查看 Hamcrest——它提供了最易读的断言和失败消息形式。你的例子

```
assertTrue(targetSpecifiers.size() == 2);
assertTrue(targetSpecifiers.get(0).getPlacementId().compareTo(new BigInteger("1")) ==0);
assertTrue(targetSpecifiers.get(1).getPlacementId().compareTo(new BigInteger("2")) ==0); 
```

可以改写为

```
assertThat(targetSpecifiers, hasSize(2));
assertThat(targetSpecifiers.get(0).getPlacementId(), equalTo(BigInteger.valueOf(1));
assertThat(targetSpecifiers.get(1).getPlacementId(), equalTo(BigInteger.valueOf(1)); 
```

或者更简洁地说

```
assertThat(targetSpecifiers, contains(
    hasProperty("placementId", equalTo(BigInteger.valueOf(1)),
    hasProperty("placementId", equalTo(BigInteger.valueOf(2))
); 
```

`contains`验证完整性和顺序，因此这涵盖了所有三个断言。

# opengl - 为什么禁用顶点属性数组零时OpenGL绘图失败？

> ID：13348885
> 
> 赞同：11
> 
> 时间：2012-11-12T17:57:05.813
> 
> 标签：opengl, opengl-3, vertex-shader, vertex-attributes

我在让我的顶点着色器在 ATI 驱动程序上的 OpenGL 3.3 核心下运行时遇到了极大的麻烦：

```
#version 150

uniform mat4 graph_matrix, view_matrix, proj_matrix;
uniform bool align_origin;

attribute vec2 graph_position;
attribute vec2 screen_position;
attribute vec2 texcoord0;
attribute vec4 color;
varying vec2 texcoord0_px;
varying vec4 color_px;

void main() {
    // Pick the position or the annotation position
    vec2 pos = graph_position;

    // Transform the coordinates
    pos = vec2(graph_matrix * vec4(pos, 0.0, 1.0));

    if( align_origin )
        pos = floor(pos + vec2(0.5, 0.5)) + vec2(0.5, 0.5);

    gl_Position = proj_matrix * view_matrix * vec4(pos + screen_position, 0.0, 1.0);
    texcoord0_px = texcoord0;
    color_px = color;
} 
```

我使用 glVertexAttrib4f 来指定颜色属性，并关闭属性数组。根据 3.3 核心规范的第 33 页，应该可以：

> 如果与顶点着色器所需的通用属性对应的数组未启用，则从当前通用属性状态中获取相应的元素（参见第 2.7 节）。

但是（大多数情况下，取决于配置文件和驱动程序）如果我访问禁用的颜色属性，着色器要么根本没有运行，要么使用黑色。用常量替换它可以运行。

大量搜索产生了[这个关于 WebGL 的提示页面](https://developer.mozilla.org/en-US/docs/WebGL/WebGL_best_practices)，其中有以下内容：

> 始终启用顶点属性 0 数组。如果您在禁用顶点属性 0 数组的情况下进行绘制，则在桌面 OpenGL（例如 Mac OSX）上运行时，您将强制浏览器进行复杂的模拟。这是因为在桌面 OpenGL 中，如果顶点属性 0 未启用数组，则不会绘制任何内容。您可以使用 bindAttribLocation() 强制顶点属性使用位置 0，并使用 enableVertexAttribArray() 使其启用数组。

果然，不仅颜色属性被分配给索引零，而且如果我将一个不同的、启用数组的属性强制绑定为零，代码就会运行并产生正确的颜色。

我在任何地方都找不到任何其他提及此规则的内容，当然也不是在 ATI 硬件上。有谁知道这条规则来自哪里？或者这是 Mozilla 人员注意到并警告的实现中的错误？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2012-11-12T18:24:05.223

**tl；博士：**这是一个驱动程序错误。核心 OpenGL 3.3 应该允许您不使用属性 0，但兼容性配置文件不允许，并且某些驱动程序没有正确实现该开关。只需确保使用属性 0 即可避免任何问题。

**实际内容：**

让我们来上一堂关于 OpenGL 规范是如何形成的历史课。

在最古老的 OpenGL 时代，只有一种渲染方式：立即模式（即：）`glBegin/glVertex/glColor/glEtc/glEnd`。显示列表存在，但它们总是被定义为简单地再次发送捕获的命令。因此，虽然实现实际上并没有进行所有这些函数调用，但实现仍然会表现得像他们那样。

在 OpenGL 1.1 中，客户端顶点数组被添加到规范中。现在请记住：规范是指定*行为*而不是实现的文档。因此，ARB 简单地定义了客户端数组的工作方式与立即模式调用完全一样，使用对当前数组指针的适当访问。显然实现实际上并不会这样做，但它们的行为就像他们那样。

基于缓冲区对象的顶点数组以相同的方式定义，尽管语言稍微复杂，因为从服务器存储而不是客户端存储中提取。

然后发生了一些事情：ARB_vertex_program（不是 ARB_vertex_shader。我说的是汇编程序）。

看，一旦有了着色器，您就希望开始能够定义自己的属性，而不是使用内置属性。这一切都说得通。但是，有一个问题。

即时模式的工作原理如下：

```
glBegin(...);
glTexCoord(...);
glColor(...);
glVertex(...);
glTexCoord(...);
glColor(...);
glVertex(...);
glTexCoord(...);
glColor(...);
glVertex(...);
glEnd(); 
```

每次调用 时`glVertex`，都会将所有当前属性状态用于单个顶点。所有其他立即模式函数只是将值设置到上下文中；这个函数实际上*将*顶点发送到 OpenGL 进行处理。这在即时模式下非常重要。而且由于每个顶点都必须在固定函数区域中具有位置，因此使用此函数来决定何时处理顶点是有意义的。

一旦不再使用 OpenGL 的固定函数顶点语义，立即模式就会出现问题。即，您如何决定何时实际*发送*顶点？

按照惯例，他们将其固定在属性 0 上。因此，所有即时模式渲染都必须使用属性 0 或 glVertex 来发送顶点。

但是，因为*所有其他渲染*都是基于立即模式渲染的语言，所以所有其他渲染都具有与立即模式渲染相同的*限制*。立即模式需要属性 0 或 glVertex，因此客户端数组等也是如此。尽管这对他们来说没有意义，但他们需要它，因为规范如何定义他们的行为。

然后 OpenGL 3.0 出现了。他们弃用了立即模式。已弃用并不意味着*已删除*；规范中仍然包含这些函数，并且所有顶点数组渲染仍然*是根据*它们定义的。

OpenGL 3.1 实际上淘汰了旧的东西。这带来了一些语言问题。毕竟，每个阵列绘制命令总是以立即模式定义的。但是一旦立即模式不再存在......你如何定义它？

所以他们必须为核心 OpenGL 3.1+ 提供新的语言。在这样做的同时，他们消除了需要使用属性 0 的无意义限制。

但兼容性配置文件*没有。*

因此，OpenGL 3.2+ 的规则是这样的。如果您有核心 OpenGL 配置文件，则不必使用属性 0。如果您有兼容性 OpenGL 配置文件，则必须使用属性 0（或`glVertex`）。这就是规范所说的。

但这不是实现所实现的。

一般来说，NVIDIA 从不关心“必须使用属性 0”规则，只是按照您的预期去做，即使在兼容性配置文件中也是如此。从而违反规范的字母。AMD 通常更有可能坚持规范。但是，他们忘记了正确实现*核心*行为。所以 NVIDIA 对兼容性过于宽容，而 AMD 对核心的限制过于严格。

要解决这些驱动程序错误，只需始终使用属性 0。

BTW, if you're wondering, NVIDIA won. In OpenGL 4.3, the compatibility profile uses the same wording for its array rendering commands as core. Thus, you're allowed to not use attribute 0 on both core and compatibility.

# coldfusion - 如何处理 CFLOCK 超时错误？

> ID：13348890
> 
> 赞同：2
> 
> 时间：2012-11-12T17:57:17.813
> 
> 标签：coldfusion

我正在使用 ColdFusion 8 和 jQuery。

我正在处理一个通过 jQuery 执行多个 ajax 调用的页面。我经常在通过 ajax 调用的页面之一上看到应用程序超时错误。我没有在每个 ajax 调用中得到错误。我每次都没有在同一个电话中收到错误。

据我了解，该错误是由每个尝试同时访问同一应用程序变量的不同页面引起的。我不确定解决问题的最佳方法是什么。

该代码似乎设置了两秒超时。这似乎太过分了。cflock 是否应该设置为只读？还有什么建议吗？

```
 A timeout occurred while attempting to lock the Application scope.

 The error occurred in E:/INETPUB/WWWROOT/DEV/AVCAT/Application.cfm: line 53
 Called from E:/INETPUB/WWWROOT/DEV/Application.cfm: line 1
 Called from E:/INETPUB/WWWROOT/DEV/Application.cfm: line 53
 Called from E:/INETPUB/WWWROOT/DEV/Application.cfm: line 1

 51 : 
 52 : <!---<cfif NOT IsDefined("application.datasource")>--->
 53 :   <cflock timeout="#CreateTimeSpan(0,0,2,0)#" SCOPE="Application"> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T18:15:36.563

标记的`timeout`属性`cflock`是预计秒数。因此，如果您想要两分钟的超时时间，则该`timeout`属性应设置为 120。像这样（我同意这似乎过分）：

```
<cflock timeout="120" SCOPE="Application"> 
```

该`CreateTimeSpan()`函数返回一个日期/时间对象。我不确定您`cflock`是如何解释超时值的。

至于使用`exclusive`锁与`readonly`锁。如果您的代码仅读取应用程序范围变量而不是使用`readonly`锁。如果您的代码正在设置应用程序范围变量而不是使用`exclusive`锁。使用`exclusive`未指定`type`属性而使用的锁将导致该代码是单线程的。那可能是你的问题。

# sql-server - 如何仅获取今天的日期而不是使用 sql 的时间

> ID：13348892
> 
> 赞同：9
> 
> 时间：2012-11-12T17:57:23.683
> 
> 标签：sql-server, tsql

> **可能重复：**
> [SQL Server 中从日期+时间获取日期的最有效方法？](https://stackoverflow.com/questions/133081/most-efficient-way-in-sql-server-to-get-date-from-datetime)

我只想用今天的日期更新一个字段，但我现在遇到的问题是它给了我日期和时间。我想用这样的特定格式更新：11/09/2012 我怎么能做到这一点？这是我当前的代码：

```
UPDATE MyTable  
        SET Field1 = GETDATE() 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-12T18:35:05.593

一种方法是更新并仅选择日期（不是时间）

```
 UPDATE @tab SET dates=(CONVERT(VARCHAR(10),GETDATE(),103));
 SELECT CONVERT(VARCHAR, GETDATE(), 23) FROM @tab 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-12T18:31:15.957

除了细微的语法差异外，这里没有太大区别，但是我建议将其包装在一个函数中。

```
CREATE FUNCTION [dbo].[GetDateOnly] (@Datetime datetime) 

RETURNS datetime  

AS  

BEGIN  
    RETURN CONVERT(Datetime, FLOOR(CONVERT(float,@Datetime)))  
END 
```

# ruby-on-rails - Spree - Selecting a Product without Variants, works fine in the console, not so much in the Application

> ID：13348893
> 
> 赞同：1
> 
> 时间：2012-11-12T17:57:25.943
> 
> 标签：ruby-on-rails, spree

When I have a Product without any Variants, I am trying to select it by itself to add it as a Line Item to my Cart. Im doing this via the following:

My Params I'm sending in:

```
Parameters: {"utf8"=>"✓", "authenticity_token"=>"cYWaQT2T3V8huhPaZZO0A2PIuEp2/hO3ar9svRTKKG8=", "product_id"=>"1060500594", "variants"=>{"1013589418"=>"1"}}

@order = current_order(true)
@size = Spree::OptionValue.find(params[:size]) if params[:size]
@color = Spree::OptionValue.find(params[:color]) if params[:color]

@prod_id = params[:product_id]

if @size && @color
  @variant = Spree::Variant.joins(:option_values).where("spree_option_values.id in (?) AND product_id = ?", [@size, @color], @prod_id).first
else
  @variant = Spree::Product.find(@prod_id).master
end 
```

It seems to not find the Variant in the Else-Portion of the Statement. It works perfectly fine, if the @size/@color is being passed in on a Product with Variants. The confusing part is - If I execute exactly this code in the console, it works as it should.

# c# - 使用 MediaPlayer (WPF) 读取音频文件以进行流式传输

> ID：13348897
> 
> 赞同：3
> 
> 时间：2012-11-12T17:57:47.930
> 
> 标签：c#, .net, wpf

我`MediaPlayer`用来播放音频文件

```
var mediaPlayer = new MediaPlayer(); 
mediaPlayer.Open(new Uri(s));
mediaPlayer.Play(); 
```

有时我需要删除`MediaPlayer`仍在播放的文件。我想我已经以某种方式读取文件以流式传输以免费访问它以删除它。我的意思是我有办法读取文件以进行流式传输，或者我必须创建一些临时文件。要播放的文件，在这种情况下我可以删除原始文件还是有其他选项？

如何实施？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-12T18:19:07.567

实际上，当您调用 MediaPlayer.Open 时，它会自动通过流读取文件。问题是当您尝试删除文件时流仍然打开。

MediaPlayer 上有一个**.Close**方法。调用它会关闭正在文件中读取的流。

这是 MediaPlayer 类的文档，因此您可以查看可以使用的其他方法：http: [//msdn.microsoft.com/en-us/library/system.windows.media.mediaplayer.aspx](http://msdn.microsoft.com/en-us/library/system.windows.media.mediaplayer.aspx)

编辑：如果您不介意在您调用 Close 时播放器停止播放，那么您可以关闭然后删除您的文件。如果您确实需要播放才能继续，那么您将需要一种不同的方法。

如果您使用的是 Silverlight，那么您可以直接将流加载到 MediaElement 中：

```
var bytes = File.ReadAllBytes(@"c:\yourfile.ext");
var mStream = new MemoryStream(bytes);
mediaElement1.SetSource(mStream); 
```

遗憾的是，WPF 没有相同的流支持。我试图通过将流写入资源包来获取 MemoryStream 的 Uri。虽然，我无法让它在我的测试中正确播放。我将包括我的来源，以防你想摆弄它并让它工作：

```
 var bytes = File.ReadAllBytes(@"C:\Bill\TestWaveFiles\14043.wav");

  MemoryStream packStream = new MemoryStream()
  Package pack = Package.Open(packStream, FileMode.Create, FileAccess.ReadWrite);
  Uri packUri = new Uri("bla:");
  PackageStore.AddPackage(packUri, pack);
  Uri packPartUri = new Uri("/MemoryResource", UriKind.Relative);
  PackagePart packPart = pack.CreatePart(packPartUri, "Media/MemoryResource");
  packPart.GetStream().Write(bytes, 0, bytes.Length);
  var inMemoryUri = PackUriHelper.Create(packUri, packPart.Uri);

  mediaElement1.LoadedBehavior = MediaState.Manual;
  mediaElement1.Source = inMemoryUri;
  mediaElement1.Play(); 
```

另一种选择是在打开文件之前简单地复制文件。这样你就可以随时删除原件。不过，您也可以只“标记”要删除的文件。当用户播放完文件后，您可以关闭并删除它。

另一种选择是使用名为 BoxedApp 的第 3 方库。它似乎允许您拥有一个包含内存流的“虚拟文件”。然后，您可以获得指向此虚拟文件的 Uri 并将其加载到媒体播放器中。查看 user1108125 的这个答案，了解如何使用这个 BoxedApp 库（我从未使用过）。[https://stackoverflow.com/a/8587166/1721136](https://stackoverflow.com/a/8587166/1721136)

# python - 按图像大小对图像矩阵（Numpy nd 数组）列表进行排序

> ID：13348899
> 
> 赞同：2
> 
> 时间：2012-11-12T17:57:52.100
> 
> 标签：python, sorting, image-processing, numpy, multidimensional-array

我有一组矩阵作为列表中的 numpy 2d 数组。它们有不同的尺寸（19x19 到 63x63）。现在，我必须从最小的尺寸开始排列它们。我输入的矩阵如下：

```
pics=[]
templates=[]

c1=0
for c1 in range(1,31):
    i1=Image.open("data/"+str(c1)+".gif")
    pmat = numpy.asarray(i1)
    pics.append(i1)
    templates.append(pmat) 
```

因此，模板是包含所有图像矩阵的列表。pmat 当然，包含图像本身。有什么简单的方法可以解决这个问题吗？......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T18:07:46.233

你想要做的是排序`size`...

```
templates.sort(key=numpy.size) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T18:04:06.197

您可以按长度对图像列表进行排序，见下文：

```
>>> import numpy 
>>> a = numpy.array([1,2,3])
>>> b = numpy.array([1,3])
>>> c = [a,b]
[array([1, 2, 3]), array([1, 3])]
>>> sorted(c,key=len)
[array([1, 3]), array([1, 2, 3])] 
```

如果您的图像数组都是正方形的（即 x-len = y-len），那么这对于您的目的应该没有问题。

编辑：如果您需要更大的灵活性（对于非方形图像），您可以使用`key=numpy.size`.

# entity-framework - Are there any situations where EntityCollection<>.Attach is also useful with non-POCO entities?

> ID：13348900
> 
> 赞同：0
> 
> 时间：2012-11-12T17:57:52.607
> 
> 标签：entity-framework

FRom [MSDN](http://msdn.microsoft.com/en-us/library/bb896408.aspx):

> The EntityCollection<>.Attach method is used to define a relationship between an object and a related object when both objects are already exist in the object context

Since with non-POCO entities relationships are automatically handled by Object Services, are `EntityCollection<>.Attach ( EntityReference<>.Attach )` only relevant with POCOs or are there also situations where they are useful even when using non-POCO entities?

thank you

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T11:03:58.790

`Attach`当实体在上下文之外创建时，该函数还用于将实体链接到上下文。

# mysql - Trouble in creating Trigger in MySQL

> ID：13348901
> 
> 赞同：0
> 
> 时间：2012-11-12T17:57:56.353
> 
> 标签：mysql, triggers

I have a database with some tables. I want to create a trigger to 'Delete a record in tblplayersfield with "pID" of the record which was deleted in tblplayers'

```
CREATE TRIGGER delete_from AFTER DELETE on tblplayers
FOR EACH ROW
BEGIN
DELETE FROM tblplayerfields
    WHERE 'tblplayerfields'.'pID' = OLD.'pID';
END 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T18:00:24.843

您需要先添加分隔符更改

```
delimiter |

CREATE TRIGGER delete_from AFTER DELETE on tblplayers
FOR EACH ROW
BEGIN
DELETE FROM tblplayerfields
    WHERE 'tblplayerfields'.'pID' = OLD.'pID';
END
|
delimiter ; 
```

定界符向数据库引擎发出语句结束的信号。通常是`;`. 但这将首先结束存储过程`;`。它的定义是不完整的。

您可以更改分隔符并将其添加到程序的末尾。之后将分隔符改回`;`

# python - 输出 Python 字典的内容

> ID：13348911
> 
> 赞同：0
> 
> 时间：2012-11-12T17:58:20.157
> 
> 标签：python, csv

这里有很多关于输出字典内容的帖子。我实际上想出了一个非最佳解决方案来解决我的问题（如下所示），但我最感兴趣的是为什么我的非最佳解决方案有效。

这是我的代码：

```
import csv

keys = ("Ev", "E1", "E2", "E3", "I", "B", "O", "T")
p = input("P")
e = input("e")
e2 = input("e2")
e3 = input("e3")
it = input("it")
b = input("b")
o = input("o")
t = input("t")

dictionary = {"Ev": p, "E1": e, "E2": e2, "E3": e3, "I": it, "B":b, "O": o, "T": t}
dictionary2 = {"Ev": p, "E1": e, "E2": e2, "E3": e3, "I": it, "B":b, "O": o, "T": t}

with open("infile.csv", "a") as f:
    w = csv.DictWriter(f, keys)
    w.writeheader()
    for answer in (dictionary, dictionary2):
        w.writerow(answer) 
```

我的目标是只有一本字典。但是当我尝试输出字典的内容时，我不断收到关于“B”的 ValueError。我尝试了一些解决方案，最好的一个似乎是添加第二个字典，它只打印两次完全相同的输出，当我打开它时，我可以从输出文件中删除完全相同的重复项。我知道这是一种糟糕的做法，但这是我所拥有的最快的解决方案，而且在一段时间内陷入这种状态真是太可惜了。

为什么在这种情况下添加第二个字典有效？如果只使用一个字典，我不明白为什么这段代码会抛出 ValueError ，但是当两个字典工作正常时（除了重复的行，我必须删除）。

**编辑**

非工作代码是以下行：

```
for answer in (dictionary): 
```

正如 Martijn 亲切地指出的那样，它只是循环遍历一个字典的键。

**编辑2**

而且，回溯错误是：

```
Traceback (most recent call last):
  File "file.py", line 41, in <module>
    w.writerow(answer)
  File "/Library/Frameworks/Python.framework/Versions/3.2/lib/python3.2/csv.py", line 153, in writerow
    return self.writer.writerow(self._dict_to_list(rowdict))
  File "/Library/Frameworks/Python.framework/Versions/3.2/lib/python3.2/csv.py", line 149, in _dict_to_list
    + ", ".join(wrong_fields))
ValueError: dict contains fields not in fieldnames: B 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-12T18:02:57.267

您创建了一个要循环的元组：

```
for answer in (dictionary, dictionary2): 
```

之前，您可能尝试过遍历字典：

```
for answer in dictionary: 
```

也许：

```
for answer in (dictionary): 
```

这是行不通的；然后你只循环一个字典的键。由于您没有包含不起作用的代码，我们只能推测这一点。

要么直接写一本字典而不循环：

```
w.writeheader()
w.writerow(dictionary) 
```

或使用单元素元组：

```
for answer in (dictionary,):
    w.writerow(answer) 
```

请参阅[元组语法](http://wiki.python.org/moin/TupleSyntax)以了解*为什么*额外的逗号在那里是必不可少的。在 Python 中，表达式周围的括号是可选的，只是将该表达式分组为跨行或表示优先级；您至少需要一个逗号才能使其成为元组。

另一方面，a`NameError`几乎总是指向一个简单的错字。也许您忘记引用`"B"`字典中的键。同样，没有追溯，这纯粹是猜测。

# c++ - 获取要在排序中使用的数组的值？

> ID：13348920
> 
> 赞同：-2
> 
> 时间：2012-11-12T17:58:38.893
> 
> 标签：c++

我需要从 K （学生人数）得到结果，但如果 2 ...程序用（如果 K = 2）两个数字填充数组中的所有 30 个位置，其他 28 个是某种 38392839238 .. .some像这样，这是我的代码：

```
int main()
  {
int i,n,k;
unsigned int m[30], a[30], b[30];
int ch=0, nech=0;
cout<<"Number of students (max30)";cin>>k;
for(i=0; i<k; ++i)
{
    cout<<i+1<<". Student number: ";
    do
    {
        cin>>m[i];
    }
    while(!(m[i]>=1e7 && m[i]<1e8));
    if(m[i]%2==0)
    {
        a[ch]=m[i]; ch++;
    }
    else 
    {
        b[nech]=m[i]; nech++;
    }
}
cout<<endl;
cout<<"\nAll numbers: "<<endl;
for(i=0; i<k; ++i)
    cout<<m[i]<<"\t";
    loop:
cout<<endl;
cout<<"\nChoose 1 to see Even and Odd numbers: ";
cout<<"\nChoose 2 to see ascending order: ";
cout<<"\nChoose 3 to exit: ";
cout<<"\nEnter Your choise: "; cin>>n;
switch(n)
{

case 2:
    {
        {
        int e=sizeof(m) / sizeof(m[0]);
        sort(m,m+e);
        for(i=0;i<e;++i)
            cout<<"\n"<<m[i]<<' ';
        }
    }
    goto loop;

}
 } 
```

这个程序想要输入班级学生的人数，然后它想输入他们的班级人数，在案例 2 中，它需要按升序排列。例如：班级学生人数：2 1.学生人数：12345678 2.学生人数：55555555

当你为 case2 打 2 时，它需要按升序排列，所以结果必须是：12345678 55555555（从最小值到最大值）。我的程序成功了，但在其他 28 个地方（我的数组必须最大为 30）它放置了另一个数字 = 3435973836

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T18:04:52.403

您看到的问题与读取尚未初始化的数组元素有关，因此包含垃圾值。

您的第一个循环将值分配给顶部`k`元素，但在其中`case '2'`您有一个循环对整个数组进行排序和输出。这是未定义的行为，因为您正在从数组的未分配元素中读取。

使用`k`代替`e`将解决此问题：

```
sort(m, m+k);
for(i=0;i<k;++i)
    cout<<"\n"<<m[i]<<' ';
} 
```

# php - PHP注销问题

> ID：13348925
> 
> 赞同：-1
> 
> 时间：2012-11-12T17:58:58.297
> 
> 标签：php

我有一个管理面板和用户面板。两者都有注销链接。当我登录到管理面板时，同时我以用户身份登录。所以两者都有一个会话。

但是当我从管理面板注销时，它也会从用户面板登录。为什么它是从用户注销。我做了单独的登录会话。

**管理员和用户的登录会话：**

```
$_SESSION['admin_u'] = $admin_uname;
$_SESSION['admin_pass'] = $admin_pass2; 
```

和

```
$_SESSION['uname'] = $uname;
$_SESSION['pass'] = $pass; 
```

**管理员注销代码：**

```
<?php
if(isset($_SESSION['admin_u']) && isset($_SESSION['admin_pass'])) {
    session_unset($_SESSION['admin_u']);
    session_unset($_SESSION['admin_pass']);
    session_destroy();
    header( "Location:../index.php" );
    exit();     
} else {
    header("Location:../membersignin.php");
    exit();
}
?> 
```

**用户注销代码：**

```
<?php
if(isset($_SESSION['uname']) && isset($_SESSION['pass'])) {
    session_unset($_SESSION['uname']);
    session_unset($_SESSION['pass']);
    session_destroy();
    header( "Location:../../index.php" );
    exit();     
} else {
    header("Location:../../membersignin.php");
}
?> 
```

我的代码有什么问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T18:00:48.773

**[`session_destroy()`](http://php.net/manual/en/function.session-destroy.php)**

> session_destroy — 销毁注册到会话的**所有数据**

这个被调用意味着会话，用户和管理员都被破坏了。如果您不想同时退出会话，您应该简单地**取消设置您不想要的会话变​​量并且不要破坏会话。**

* * *

另外，您使用**[`session_unset()`](http://php.net/manual/en/function.session-unset.php)**不正确。**session_unset()**函数释放当前注册的所有会话变量。改用普通的**[`unset()`](http://php.net/manual/en/function.unset.php)**。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T18:01:32.337

session_unset 清除所有会话...不仅仅是一个变量..使用

```
unset($_SESSION['admin']) 
```

更多：

[http://php.net/manual/en/function.session-unset.php](http://php.net/manual/en/function.session-unset.php)

# android - Heatmaps layer on OSMdroid mapview

> ID：13348927
> 
> 赞同：2
> 
> 时间：2012-11-12T17:59:01.450
> 
> 标签：android, google-maps, google-maps-api-3, android-mapview, osmdroid

Is it possible to display a Google Maps heatmap layer like this [https://google-developers.appspot.com/maps/documentation/javascript/examples/layer-heatmap](https://google-developers.appspot.com/maps/documentation/javascript/examples/layer-heatmap) as a layer onto a custom OSMdroid Mapview?

Or is there a simple way to directly plot the heatmap-geopoints [{lat, lon, weight-value},..] as a layer onto the map?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T23:31:36.937

我发现了 Seth Golub 的这个不错的 Python 脚本 [https://github.com/sethoscope/heatmap/blob/master/heatmap.py](https://github.com/sethoscope/heatmap/blob/master/heatmap.py) 将 lat、lon [weight] 值或 .gpx 列表转换为热图 - 很好自定义选项。

最重要的是，有一个 Andrew Harvey 的包装器，用于从您的文件中渲染图块 [https://github.com/andrewharvey/OpenStreetMap-User-Edits-Heatmap/blob/master/render-heatmap-to-tiles.pl](https://github.com/andrewharvey/OpenStreetMap-User-Edits-Heatmap/blob/master/render-heatmap-to-tiles.pl)

我的第一次测试表明，我能够使用这些脚本在 Google 地图上创建类似的结果。

# visual-studio-2012 - 无法在 Visual Studio 2012 Express 中添加新的 SpecFlow 项

> ID：13348934
> 
> 赞同：0
> 
> 时间：2012-11-12T17:59:24.647
> 
> 标签：visual-studio-2012, nuget, specflow

我在 VS2012 Express 版本中通过 NuGet 为我的类库项目安装了 SpecFlow 包。但是当我想添加一个新的 SpecFlow 项目时，我在列表中找不到任何 SpecFlow 模板。我在项目引用中看到添加了 TechTalk.SpecFlow。

我为 VS2010 Express 找到了一些解决方法：[https](https://stackoverflow.com/a/5041703/1037754) ://stackoverflow.com/a/5041703/1037754但如果可能的话，我希望它以“正常”方式工作:)

如果这很重要，我的机器上有 .Net 4.5。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T18:22:09.060

Visual Studio Express 不支持项目扩展（Microsoft 禁止和禁用）。

这意味着您不能使用 SpecFlow Gherkin 编辑器（语法突出显示、表格格式化、步骤的自动完成、步骤之间的导航和步骤定义代码），也不能在 IDE（单文件生成器）中使用从功能文件到可执行场景的代码生成。

但是，您可以将功能文件编辑为普通文本文件，并且可以使用 SpecFlow 命令行工具生成可执行场景（就像您在构建服务器上所做的那样）。

# c# - 将 eval 传递给 javascript

> ID：13348938
> 
> 赞同：1
> 
> 时间：2012-11-12T18:00:00.013
> 
> 标签：c#, javascript, asp.net, eval, numeric

我正在尝试将此 eval 传递给 javascript，但不断出现以下错误：

```
<input type="submit" value="Send" id="btnPDf" onclick='<%# "openLink( " +   Eval("ID" )  +  "  );" %>' runat="server" /> 
```

萤火虫中的错误：

```
Timestamp: 12/11/2012 17:59:16
Error: SyntaxError: identifier starts immediately after numeric literal
Line: 1, Column: 24
Source Code:
openLink( b690d0c5-9269-424a-ac57-02f3359c982f ); 
```

我试过用双引号和反斜杠（如'\'）传递它，但仍然没有乐趣

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-12T18:05:37.393

您的字符串连接已损坏。您需要使用转义序列将参数括在引号中 -

```
onclick='<%# "openLink(\"" + Eval("ID" ) + "\" );" %>' 
```

# c++ - 如何在 QuickFIX 中制作登录部分

> ID：13348939
> 
> 赞同：5
> 
> 时间：2012-11-12T18:00:09.010
> 
> 标签：c++, login, quickfix

如何在 C++ 中制作 QuickFIX 中的登录部分？我找到了大量关于如何在 c# 或 java 上执行此操作的教程和文章，但在 c++ 上却一无所获。

我有一个服务器（接受者）和一个客户端（发起者）。客户端的用户名和密码存储在设置文件中，并在服务器程序中硬编码。

从我在客户端中读取的内容中，我设置了用户名和密码，`fromAdmin()`并在服务器中读取并检查了`toAdmin()`，但是我该怎么做呢？

这是我到目前为止所尝试的：

*   使用：`message`_`FIX44::Logon&`

    ```
    FIX44::Logon& logon_message = dynamic_cast<FIX44::Logon&>(message); 
    ```

*   将用户名和密码设置为登录对象，如下所示：

    ```
    if(session_settings.has("Username"))
    {
        FIX::Username username = session_settings.getString("Username");
        logon_message.set(username);
    } 
    ```

*   并像这样发送消息：

    ```
    FIX::Message messageToSend = logon_message;
    FIX::Session::sendToTarget(messageToSend); 
    ```

但是我在演员阵容中遇到了这个错误：

```
cannot dynamic_cast 'message' (of type 'class FIX::Message') to type 'struct FIX44::Logon&' (target is not pointer or reference to complete type) 
```

我尝试过的东西是从[http://niki.code-karma.com/2011/01/quickfix-logon-support-for-username-password/comment-page-1/](http://niki.code-karma.com/2011/01/quickfix-logon-support-for-username-password/comment-page-1/)中获得的。

我仍然不清楚如何制作客户端和服务器。

谁能帮我？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-12T21:22:16.660

可能的错误：

1）我认为你有`fromAdmin()`/`toAdmin()`落后。 `toAdmin()`在传出的管理消息`fromAdmin()`上调用，在传入时调用。对于发起者，您必须在`toAdmin()`回调中设置字段。您的 Acceptor 将检查用户/传入`fromAdmin()`。

2）您是否尝试`dynamic_cast`不先检查它是否是登录消息？`toAdmin()`回调处理*所有*管理消息；该消息可能是 Heartbeat、Logon、Logout 等。这可能会解释您的转换错误。

至于代码应该是什么样子，我的 C++ 生锈了，但基本模式是这样的：

```
void YourMessageCracker::toAdmin( FIX::Message& message, const FIX::SessionID& sessionID)
{
    if (FIX::MsgType_Logon == message.getHeader().getField(FIX::FIELD::MsgType))
    {
        FIX44::Logon& logon_message = dynamic_cast<FIX44::Logon&>(message);
        logon_message.setField(FIX::Username("my_username"));
        logon_message.setField(FIX::Password("my_password"));
    }
} 
```

从那里，我认为您可以看到如何编写类似`fromAdmin()`的方法来获取字段而不是设置字段。

以上使用硬编码的用户/密码，但您可能想从配置文件中提取它。我认为你的呼吁`session_settings.getString(str)`是正确的。

（请原谅任何编码错误。尽管基本原理相同，但我对 QF 引擎的 Java/C# 版本更流利。）

我看到[您的第一个网络参考](http://niki.code-karma.com/2011/01/quickfix-logon-support-for-username-password/)使用了`FIELD_GET_REF`宏。它可能比 好`message.getHeader().getField()`，但我不熟悉它。

**编辑：**我希望你在我完成 45 次编辑之前不要开始阅读这篇文章。我觉得现在很好。

# android - 如何调整列表视图的图像大小

> ID：13348942
> 
> 赞同：0
> 
> 时间：2012-11-12T18:00:11.953
> 
> 标签：android

我正在从 web 服务文本加载列表视图的图像和标题，但图像太大。如何调整它的大小，我想在列表视图的每一行中设置右侧的文本和左侧的图像。我正在使用这种方法位图调整大小 = Bitmap.createScaledBitmap(bitmap, 70, 70, true); 但模拟器上什么也没有出现这是我正在加载图像的成本类

```
public static Bitmap loadPhotoBitmap(URL url) {
Bitmap bitmap = null ;
InputStream in = null;
BufferedOutputStream out = null;
BufferedOutputStream bfs = null;

try {
FileOutputStream fos = new FileOutputStream("/sdcard/photo-tmp.jpg");
bfs = new BufferedOutputStream(fos);

in = new BufferedInputStream(url.openStream(),8192);

final ByteArrayOutputStream dataStream = new ByteArrayOutputStream();
out = new BufferedOutputStream(dataStream, 8192);
copy(in, out);                    
out.flush();
final byte[] data = dataStream.toByteArray();

bfs.write(data, 0, data.length);
bfs.flush();

BitmapFactory.Options opt = new BitmapFactory.Options();
bitmap = BitmapFactory.decodeByteArray(data, 0, data.length, opt);

//System.out.println(resized);
Bitmap resized = Bitmap.createScaledBitmap(bitmap, 70,70, true);
    return  resized;
} catch (IOException e) {
// android.util.Log.e("message", "Could not load photo: " + this, e);
System.out.println("Exception while loading image");
} finally {
closeStream(in);
closeStream(out);
closeStream(bfs);
}
System.out.println("returning");
return  bitmap;
} 
```

LazyAdapter.class

```
public View getView(int position, View convertView, ViewGroup parent) {

System.out.println("Exception before..");
String strUrl = Constants.vctrImagePath.elementAt(counter).toString();// getting imgurl  
System.out.println("Urls...." + strUrl);
URL url =null;
try {
url = new URL(strUrl);
} catch (MalformedURLException e) {
    // TODO Auto-generated catch block
e.printStackTrace();
}

Bitmap bitmap = Constants.loadPhotoBitmap(url);
//Bitmap resized = Bitmap.createScaledBitmap(bitmap, 70, 70, true);

RelativeLayout layout = new RelativeLayout(mContext);
RelativeLayout.LayoutParams(LayoutParams.FILL_PARENT,LayoutParams.FILL_PARENT);        

TextView text1 = new TextView(mContext);
text1.setText(Constants.vctrCategory.elementAt(counter).toString());
LayoutParams params1 = new       LayoutParams(LayoutParams.WRAP_CONTENT,LayoutParams.WRAP_CONTENT);
params1.addRule(RelativeLayout.ALIGN_PARENT_RIGHT);
text1.setLayoutParams(params1);
text1.setTextSize(20);
text1.setGravity(Gravity.RIGHT);
layout.addView(text1);
ImageView img = new ImageView(mContext);
img.setImageBitmap(bitmap);

layout.setGravity(Gravity.CENTER_VERTICAL | Gravity.CENTER_HORIZONTAL);
layout.addView(img);
counter++;
return layout;
}

private void setContentView(ImageView image) {
// TODO Auto-generated method stub

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T19:19:59.323

代替

```
BitmapFactory.Options opt = new BitmapFactory.Options();
bitmap = BitmapFactory.decodeByteArray(data, 0, data.length, opt); 
```

将其替换为

```
BitmapFactory.Options opts = new BitmapFactory.Options();               
opts.inPreferredConfig = Bitmap.Config.ARGB_8888;
bitmap = BitmapFactory.decodeByteArray(data, 0, data.length, opts); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T18:51:13.457

> 问题不在我的这个 bitmapfactory 类中。我已经解决了我的问题。我只是在我的惰性适配器类中更改代码。

```
Bitmap bitmap = Constants.DownloadImage(strUrl);
    Bitmap resized=null;
    if(bitmap!=null){
    resized = Bitmap.createScaledBitmap(bitmap, 100, 100, true);
}else{
    System.out.println(strUrl+ "no image here");
} 
```

> 在我在列表视图中调整图像大小之前。它会在列表视图的适配器类中调整大小。

# ios - Bullied by the EventKit framework on iOS 6

> ID：13348947
> 
> 赞同：6
> 
> 时间：2012-11-12T18:00:27.017
> 
> 标签：ios, cocoa-touch, ios6, eventkit

At first I though I had left my self this message, but then I started seeing more comments like this one. I just want to ask if Im the only one seeing messages like this ? I think its funny in some way, but it left me wondering if I'd got a rogue SDK

```
 2012-11-10 13:15:53.736 myApp[1419:907] *** -[__NSCFCalendar components:fromDate:]: date cannot be nil
I mean really, what do you think that operation is supposed to mean with a nil date?
An exception has been avoided for now.
A few of these errors are going to be reported with this complaint, then further violations will simply silently do whatever random thing results from the nil. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T18:14:31.680

You are not the only one who has seen this. That's an official SDK message; programmer who wants to tell you what you're doing wrong, straight! You're safe to continue.

# dapper - 从 System.Double 到 System.Nullable 的无效转换

> ID：13348956
> 
> 赞同：1
> 
> 时间：2012-11-12T18:01:06.687
> 
> 标签：dapper

我的数据库中有一个浮点列。我的数据库是巴西葡萄牙语，因此，此列的小数分隔符是逗号 (,)。

我不知道这是否是原因，但 Dapper 抛出异常“从 'System.Double' 到 'System.Nullable 的无效转换 ...”（我的实体在此列中使用 Nullable）。

你能帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T23:14:41.343

这与文化无关——返回的数据是原始的，而不是字符串化的。`double`简单地说，从to 转换是不开心的`decimal?`。由于数据库正在返回`double`，`double?`因此属性可以正常工作。核心*尝试*允许尽可能多的实用转换，但它不支持*所有*映射。

# c - 警告 LNK4092：共享可写部分包含重定位

> ID：13348959
> 
> 赞同：2
> 
> 时间：2012-11-12T18:01:10.020
> 
> 标签：c, windows, visual-studio-2008, mfc, shared-memory

我使用 Visual Studio 2008 并且对此警告有疑问。

在我们的一个库中，我们设置了“固定基址”标志 (/FIXED) 并定义了一个固定基址。

我们用命令声明一个共享部分

```
#pragma comment(linker,"/SECTION:FOO,RWS") 
#pragma data_seg("FOO") 
```

当我删除 /FIXED 标志时，我收到警告

> 链接：警告 LNK4092：共享可写部分“FOO”包含重定位；图像可能无法正常运行

我了解，使用此标志，从可执行文件加载时，dll 可能会被重新定位。现在我不明白。为什么不重新定位这些共享部分很重要？这些地址不是每个进程的虚拟地址吗？

有没有办法允许搬迁并有一个共享的部分？我们在更改库接口后遇到了这个问题，如果任何开发人员在不知道这些后果的情况下更改此库，我想在将来避免这种情况。

我也很好奇这是如何工作的。/SECTION 标志的 MSDNA 页面和 4092 警告在这里不是很有帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-12T20:25:18.273

我相信[KB137235](http://support.microsoft.com/kb/137235)在这里是相关的。基本上，错误告诉您该部分包含取决于加载该部分的地址的数据，例如指向该部分中其他数据的指针。如果该部分是可重定位的，则不同的实例可能不在同一个虚拟地址上，因此指针不能同时对所有实例都有效。

从中长期来看，正确的解决方案是*不使用共享部分*。参见，例如：

*   [附录 G：SDL 要求：无共享部分](http://msdn.microsoft.com/en-us/library/windows/desktop/cc307397.aspx)
*   [旧事物：为什么 .shared 部分是一个安全漏洞](http://blogs.msdn.com/b/oldnewthing/archive/2004/08/04/208003.aspx)
*   [KB147136：DLL 中的共享数据部分存在问题](http://support.microsoft.com/kb/147136)

# c# - 首先在实体框架代码中加入两个具有一对多关系的表

> ID：13348963
> 
> 赞同：1
> 
> 时间：2012-11-12T18:01:21.030
> 
> 标签：c#, .net, linq, entity-framework, code-first

我有

```
 public class Menu
    {  
       public int ID { get; set;} 
       public List<Task> Tasks { get; set; }
    }

 public class Task
    {
        public int ID { get; set; }
        public byte[] Image { get; set; }
        public string Name { get; set; }  
    } 
```

我想知道所有使用 LINQ 查询具有特定列表 ID 的任务

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T10:37:07.077

尝试

```
var result = Menus.Where(menu => menu.ID == id)
                  .Select(menu => menu.Tasks)
                  .FirstOrDefault(); 
```

此外，您可能需要仔细阅读[http://code.msdn.microsoft.com/101-LINQ-Samples-3fb9811b](http://code.msdn.microsoft.com/101-LINQ-Samples-3fb9811b)，因为这将回答您的大部分查询，如上述。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T18:07:00.063

您可以使用[Enumerable.Where](http://msdn.microsoft.com/en-us/library/bb534803.aspx)

```
var list = Tasks.Where(l=>l.ID ==x); 
```

或者

```
 var list = from t in Tasks
              where t.ID == x
              select t; 
```

***x***将是您需要比较的 id

# html - 如果页面很短，则将 HTML 页脚保持在窗口底部

> ID：13348965
> 
> 赞同：12
> 
> 时间：2012-11-12T18:01:30.493
> 
> 标签：html, css, sticky-footer

我的一些网页很短。在这些页面中，页脚可能最终位于窗口的中间，而页脚下方是空白（白色）。那看起来很难看。我希望页脚位于窗口的底部，并且有限的内容主体会被拉伸。

但是，如果网页很长并且您必须滚动才能看到页脚（或全部），那么事情应该会正常运行。

使用 CSS 执行此操作的正确方法是什么？我需要 Javascript/jQuery 来实现这一点吗？

我只关心 IE9+ 和其他浏览器的现代版本。页脚的高度也可以从一页到另一页，所以我不想依赖高度。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-12T18:33:56.207

看看[这个网站](http://matthewjamestaylor.com/blog/keeping-footers-at-the-bottom-of-the-page)。他有一个关于如何使用 css 执行此操作的很好的教程。

我复制了他的 CSS 以防万一 Matthew 的网站被删除。

```
html,
body {
   margin:0;
   padding:0;
   height:100%;
}
#container {
   min-height:100%;
   position:relative;
}
#header {
   background:#ff0;
   padding:10px;
}
#body {
   padding:10px;
   padding-bottom:60px;   /* Height of the footer */
}
#footer {
   position:absolute;
   bottom:0;
   width:100%;
   height:60px;   /* Height of the footer */
   background:#6cf;
} 
```

**编辑**

由于页脚的高度因页面而异，您可以获取页脚的高度，然后使用javascript调整#body padding-bottom。这是一个使用 jquery 的示例。

```
$(function(){
    $('#body').css('padding-bottom', $('#footer').height()+'px');   
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-12T18:37:49.723

试试[这个](http://codepen.io/anon/pen/skCyr)。

它是 Github 用来将页脚保留在页面底部的样式的副本。这有点hacky，需要您知道页脚的高度（这可能不适用于您的用例）

# 标记

* * *

```
<div class="wrapper">
<div class="content"><p>Page Content</p></div>
<div class="footer-push"></div>
</div>

<footer>
  <p>footer-text</p>
  <img src="http://placekitten.com/100/100" alt="footer image">
</footer> 
```

# CSS（好吧，scss）

* * *

```
// our page element

html {
height:100%;
}

body {
height:100%;
}
.wrapper {
background:gray;
min-height:100%;
height: auto !important; // the magic!
height:100%;
margin-bottom:-158px; // the height of our footer + margin
}

.footer-push {
clear:both;
height:158px; // the height of our footer + margin
}

footer {
background:rgba(#a388a3,0.8);
margin-top:20px;
height:138px;
} 
```

这里重要的事情似乎是：

*   设置高度：包含元素（esp`html`和`body`）的 100%
*   知道你的页脚的高度，并用“push”元素来解释它
*   使用和的`min-height` `height: auto !important`组合`height:100%`

希望有帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-07T22:54:24.047

HTML

```
<body>
    <div class="example">
        <p>Lorem ipsum dolor sit amet consectetur...</p>
    </div>

    <footer>
        <ul>
            <li>One</li>
            <li>Two</li>
            <li>Three</li>
        </ul>
    </footer>
</body> 
```

CSS

```
body {
    min-height: 100%;
}

footer {
    position: absolute;
    bottom: 0;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-05-21T18:49:46.697

考虑到您所有的页脚都在`<footer>` *html*标记内，这是一个使用 jQuery 的简单解决方案。

JS：

```
$(document).ready(function(){
    $('body').css('padding-bottom', $('footer').height()+'px');
}); 
```

CSS：

```
footer {
    position:absolute;
    bottom:0;
} 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-11-12T18:06:20.483

不，很容易为您的身高设置一个最小值。

像这样：最小高度：500px；那么最小高度是500px。

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2012-11-12T18:10:45.090

使用 min-height 属性，虽然不完全可靠，因为某些旧版本可能不支持它。如果您不介意，请输入一些 javascript。

# java - 使用 jython 运行 python

> ID：13348969
> 
> 赞同：2
> 
> 时间：2012-11-12T18:01:38.620
> 
> 标签：java, python, jython, apache-pig

我想使用 jython 运行 python 函数..

以本网站为例。

[http://sundaycomputing.blogspot.com/2011/01/python-udfs-from-pig-scripts.html](http://sundaycomputing.blogspot.com/2011/01/python-udfs-from-pig-scripts.html)

现在当我运行脚本时（pig -f myscript.pig

它返回给我这个错误

```
 Pig Stack Trace
---------------
ERROR 2998: Unhandled internal error. org/python/core/PyException

java.lang.NoClassDefFoundError: org/python/core/PyException
    at org.apache.pig.scripting.jython.JythonScriptEngine.registerFunctions(JythonScriptEngine.java:127)
    at org.apache.pig.PigServer.registerCode(PigServer.java:567)
    at org.apache.pig.tools.grunt.GruntParser.processRegister(GruntParser.java:421)
    at org.apache.pig.tools.pigscript.parser.PigScriptParser.parse(PigScriptParser.java:419)
    at org.apache.pig.tools.grunt.GruntParser.parseStopOnError(GruntParser.java:188)
    at org.apache.pig.tools.grunt.GruntParser.parseStopOnError(GruntParser.java:164)
    at org.apache.pig.tools.grunt.Grunt.exec(Grunt.java:81)
    at org.apache.pig.Main.run(Main.java:427)
    at org.apache.pig.Main.main(Main.java:108)
Caused by: java.lang.ClassNotFoundException: org.python.core.PyException
    at java.net.URLClassLoader$1.run(URLClassLoader.java:202)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:306)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:247)
    ... 9 more
================================================================================ 
```

我猜是因为第一行..`REGISTER udf.py USING jython AS udf;`

并且我必须指定 jython 路径？（因为我在集群上运行这个代码..我不认为我已经设置了这个东西）..现在......因为我不太了解java..因此打开了python......但是我如何制作这个代码跑？？

我必须在我的环境上做什么样的设置......来调试这个问题。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T09:07:23.097

添加`$PIG_HOME/lib/jython.jar`到您的`PIG_CLASSPATH`环境变量。

# delphi - 在OTL中使用时如何通过匿名方法捕获变量？

> ID：13348970
> 
> 赞同：6
> 
> 时间：2012-11-12T18:01:38.180
> 
> 标签：delphi, closures, delphi-2009, anonymous-methods, omnithreadlibrary

我想做的事：

我在通用列表中有一些对象。我想以匿名方法捕获每个对象，并将此方法作为单独的 OTL 任务执行。

这是一个简化的例子：

```
program Project51;

{$APPTYPE CONSOLE}

uses
  SysUtils, Generics.Collections, OtlTaskControl, OtlTask;

type
  TProc = reference to procedure;

type
  TMyObject = class(TObject)
  public
    ID: Integer;
  constructor Create(AID: Integer);
  end;

constructor TMyObject.Create(AID: Integer);
begin
  ID := AID;
end;

var
  Objects: TList<TMyObject>;
  LObject: TMyObject;
  MyProc: TProc;
begin
  Objects := TList<TMyObject>.Create;
  Objects.Add(TMyObject.Create(1));
  Objects.Add(TMyObject.Create(2));
  Objects.Add(TMyObject.Create(3));
  for LObject in Objects do
  begin
    //This seems to work
    MyProc := procedure
    begin
      Writeln(Format('[SameThread] Object ID: %d',[LObject.ID]));
    end;
    MyProc;
    //This doesn't work, sometimes it returns 4 lines in console!?
    CreateTask(
      procedure(const Task: IOmniTask)
      begin
        Writeln(Format('[Thread %d] Object ID: %d',[Task.UniqueID, LObject.ID]));
      end
    ).Unobserved.Run;
  end;
  Sleep(500); //Just wait a bit for tasks to finish
  Readln;
end. 
```

这是结果：

![捕获的对象 ID](../Images/8f97b72ec04e1951d0a35b7893d0ee79.png)

如您所见，捕获似乎在主线程中运行良好。但是，我不知道是否已捕获指向对象的指针或仅捕获其 ID 字段？

当我尝试捕获对象并将匿名方法传递给`CreateTask`函数时，事情变得很奇怪。

首先，`TMyObject`似乎只有第三个实例被捕获。其次，尽管我在通用列表中只有三个对象，但我在控制台日志中有四条消息。第二种行为不一致，有时我在控制台中收到三条消息，有时我有四条消息。

请解释我上面提到的两个问题的原因，并提出一个解决问题的解决方案，并允许我将每个对象实例传递给一个单独的 OTL 任务。（我不想使用普通`TThread`课程。）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-12T18:41:32.120

[The documentation describes what's happening](http://docwiki.embarcadero.com/RADStudio/XE2/en/Anonymous_Methods_in_Delphi#Variable_Binding_Mechanism):

> Note that variable capture captures *variables*—not *values*. If a variable's value changes after being captured by constructing an anonymous method, the value of the variable the anonymous method captured changes too, because they are the same variable with the same storage.

In your code, there is only one `LObject` variable, so *all* the anonymous methods you construct refer to it. As your loop makes progress, the value of `LObject` changes. The tasks haven't gotten a chance to start running yet, so when they do finally run, the loop has terminated and `LObject` has its final value. Formally, that final value is undefined after the loop.

To capture the *value* of the loop variable, wrap creation of the task in a separate function:

```
function CreateItemTask(Obj: TMyObject): TOmniTaskDelegate;
begin
  Result := procedure(const Task: IOmniTask)
            begin
              Writeln(Format('[Thread %d] Object ID: %d',[Task.UniqueID, Obj.ID]));
            end;
end; 
```

Then change your loop code:

```
CreateTask(CreateItemTask(LObject)).Unobserved.Run; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T18:38:07.167

匿名过程捕获变量而不是值。因此，您正在捕获变量 LObject。由于这是一个循环变量，因此 LObject 的值会发生变化。匿名过程在执行时而不是在创建匿名过程时评估 LObject。

我可能只使用 TMyObject 的方法，而不是使用匿名过程。尝试以这种方式编写代码，我预测您会发现它更容易理解。

```
procedure TMyObject.TaskProc(const Task: IOmniTask);
begin
  Writeln(Format('[Thread %d] Object ID: %d', [Task.UniqueID, Self.ID]));
end; 
```

获得 4 行而不是 3 行输出的原因可能只是 WriteLn 不是线程安全的。将对 WriteLn 的调用包裹在一个锁中以清除它。

# javascript - 为什么这个while循环是无限的？JavaScript appendChild

> ID：13348976
> 
> 赞同：1
> 
> 时间：2012-11-12T18:01:51.097
> 
> 标签：javascript, while-loop, infinite-loop, appendchild

我发誓这几天前工作得很好......

```
elm = document.querySelectorAll(selector);
var frag = document.createDocumentFragment();
while (elm[0]){
    frag.appendChild(elm[0]);
} 
```

对，所以，这应该从我们的`elm`节点列表中附加每个节点。当第一个被附加时，第二个“移动”到节点列表中的第一个位置，因此下一个总是`elm[0]`. 当nodeList 完全附加时它**应该**停止。`elm`但是，这给了我一个无限循环。想法？

**编辑**- 因为我多次得到相同的答案...... A`nodeList`不是一个数组，它是一个实时参考。当一个节点被“移动”（此处为附加）时，它应该自动从节点列表中删除。答案都说“你一遍又一遍地附加相同的元素” - 这就是正在发生的事情，它*不应该*是。for 循环*不应该*工作，因为当第一个节点被附加时，下一个节点将获取它的索引。

**第二次编辑**

所以现在的问题是“为什么`nodeList`表现得像一个数组？”。每次将节点附加到某个地方时，节点列表都**应该更新。**最奇特的。

**解决方案**（以防有人需要处理实时+非实时节点列表）

```
elm = (/*however you're getting a node list*/);
var frag = document.createDocumentFragment();
var elength = elm.length;
for (var b = 0; b<elength; b++){
    if (elm.length === elength){
        frag.appendChild(elm[b]);
    } else {
        frag.appendChild(elm[0].cloneNode());
    }
} 
```

基本上，只是检查节点列表是否改变了长度。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-12T18:25:12.950

来自[MDN 文档](https://developer.mozilla.org/en-US/docs/DOM/Document.querySelectorAll)

## Element.querySelectorAll

## 概括

返回调用它的元素的所有元素的***非活动 NodeList ，这些元素与指定的 CSS 选择器组匹配。***

## 句法

```
elementList = baseElement.querySelectorAll(selectors); 
```

在哪里

*   `elementList`是元素对象的非活动列表。
*   `baseElement`是一个元素对象。
*   `selectors`是一组要匹配的选择器。

* * *

从上面的文档中您可以看到，当您将其附加到另一个元素时，它不会自动删除它，因为它是非活动的。运行演示以显示该功能。

```
var selector = "div";
elm = document.querySelectorAll(selector);
var frag = document.createDocumentFragment();
console.log("before",elm.length);
frag.appendChild(elm[0]);
console.log("after",elm.length); 
```

当上面的代码运行时，在你得到的控制台中。

```
before    3
after     3 
```

如果要执行 while 循环，请转换为数组并 shift() 关闭项目

```
var selector = "div";
var elmNodeLIst = document.querySelectorAll(selector);
var frag = document.createDocumentFragment();
var elems = Array.prototype.slice.call(elmNodeLIst );
while (elems.length) {
    frag.appendChild(elems.shift());
}
console.log(frag); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T18:06:48.623

您一遍又一遍地附加节点列表中的第一项。您永远不会从数组中删除任何项目，而是始终将第一个项目添加到片段中。第一个总是一样的。

```
elm = document.querySelectorAll(selector);
var frag = document.createDocumentFragment();
while (elm.length){
    frag.appendChild(elm.shift());
} 
```

这可能更接近您的意图。我们可以使用`while (elm.length)`，因为随着项目从数组中删除，最终长度将为零，这是一个不稳定的值并且循环将停止。

我们使用`elm.shift()`从数组中获取项目，因为该方法将返回索引为零的项目并将其从数组中删除，这为我们提供了我们需要的原始数组的突变。

* * *

我认为您认为这可能有效，因为节点只能有一个父节点。意味着添加某处会将其从前一个父级中删除。但是，`elm`它*不是*DOM 片段。它只是一个包含对元素的引用的数组（或者可能是 NodeList）。该数组不是这些元素的父节点，它只是保存引用。

如果你有这样的循环，你的循环可能会起作用，因为你每次都在查询父节点的子节点，一个节点列表实际上会随着你的移动而改变：

```
elm = document.getElementById(id);
var frag = document.createDocumentFragment();
while (elm.children[0]){
    frag.appendChild(elm.children[0]);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T18:05:56.853

这是一个无限循环，因为它`elm[0]`总是引用同一个元素，并且该元素永远不会为空（任何非空/非零结果都是真的）。您也不会对元素本身做任何事情以使其遍历列表。您应该使用 for 循环而不是 while 或至少使用某种索引器来尝试遍历集合。

```
elm = document.querySelectorAll(selector);
var frag = document.createDocumentFragment();
for (i= 0; i < elm.length; i++)
{
    frag.appendChild(elm[i]);
} 
```

**编辑：**

从[文档](https://developer.mozilla.org/en-US/docs/DOM/NodeList)中：

> 一个“活”的集合
> 
> 在大多数情况下，NodeList 是一个实时集合。这意味着 DOM 树上的更改将反映在集合上。
> 
> var links = document.getElementsByTagName('a'); // links.length === 2 例如
> 
> document.body.appendChild( links[0].cloneNode(true) ); // 另一个链接被添加到文档中
> // 'links' NodeList 会自动更新
> // links.length === 3 现在。如果 NodeList 是 document.querySelectorAll 的返回值，则它**不是**实时的。

继续阅读本文档，您当前对该方法的使用表明您没有实时 NodeList。因此追加永远不会修改原始列表。您将需要在循环中修改您的用法以反映此用法`.cloneNode(true)`或手动迭代。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-12T18:07:40.243

elm[0] 是静态的并且在上面的代码修复中不变如下

```
elm = document.querySelectorAll(".container");
var frag = document.createDocumentFragment();
console.log(elm);
var i=0;
while (elm[i]){
    frag.appendChild(elm[i++]);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-12T18:08:01.840

我实际上并没有过多关注代码（如果它有意义 - 从评论判断 - 或不）；但如果这在几天前有效，那么问题出在您提供给代码选择器的输入中。

这时候单元测试就派上用场了。如果你能记住代码工作的输入，那么你可以让它再次工作并从那里开始调试。

否则，你只是在欺骗自己。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-12T18:05:09.317

我一开始没想到它会起作用。

您的`elm`数组已初始化，并且永远不会更新。即使运行的结果`document.querySelectorAll(selector);`会返回不同的结果，这也不会改变数组中的当前引用。

您要么需要重新运行选择器，要么在添加后手动删除数组中的第一个元素。

# android - 从 asynchTask 调用 runonuithread

> ID：13348979
> 
> 赞同：0
> 
> 时间：2012-11-12T18:02:09.597
> 
> 标签：android, android-asynctask, android-relativelayout

我对一个问题有点难过，请原谅我，因为我对 android 开发非常陌生。我做了一些搜索，发现了很多不同的意见。我有一个调用 web 服务并返回一堆 json 结果的 AsynchTask。我必须（并且想要）异步运行我的网络服务。结果集将需要在 RelativeLayout 内内联呈现。我试图在我的异步线程中执行此操作，但 Android 不允许从非主线程的任何内容更新 UI。

我看到了 Runonuithread，但我无法从我的 ui 线程调用我的 asynchtask。

异步调用我的 web 服务，获取结果，然后在原始线程上更新 mainUI 的最佳方法是什么。从架构的角度来看是否有最佳实践。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T18:41:10.650

onPostExecute() 在 ui 线程上运行，因此请尝试使用该方法来完成您的工作。否则，您可以使用 Handler 类在线程之间进行通信。

# ruby-on-rails-3.2 - 在 Rails 3.2.9 中删除了 ActiveRecord to_i 方法

> ID：13348980
> 
> 赞同：7
> 
> 时间：2012-11-12T18:02:22.520
> 
> 标签：ruby-on-rails-3.2

今天从 3.2.7 升级到 Rails 3.2.9，似乎方法“to_i”已从 ActiveRecord 中删除。

这是设计使然吗？或者它是一个错误？我在更改说明中找不到任何提及。这将影响很多代码。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T17:37:00.977

该`#to_i`方法从未存在，但是[在 Rails 3.2.8 中将对象分配给值的方式发生了变化](https://github.com/rails/rails/commit/96a13fc7)。

鉴于以下情况：

```
class Lecture < ActiveRecord::Base
  has_one :professor
end 
```

以前，您可以将教授分配给这样的讲座：

```
@lecture.professor = Professor.find_by_id(1) 
```

或者像这样：

```
@lecture.professor_id = Professor.find_by_id(1) 
```

在第一种情况下，一切都很简单，因为`professor`关联需要一个教授对象。在第二种情况下，尽管 ActiveRecord 执行了一些魔法来强制从教授那里获取 id，因为它`professor_id`需要一个整数。

在 Rails 3.2.8 及更高版本中，这种魔法不再有效。这在某种程度上很好，因为它暗示你可能做错了什么。例如，如果`professor_id`数据库中没有列，而只是`professor`需要一个整数，则这样的分配将不再有效。

看起来这将[恢复到 Rails 3.2.11 中的先前行为](https://github.com/rails/rails/commit/e842dbbdf74c1aec904a6325f1e5d84924b90e94)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-13T21:38:01.367

我遇到了同样的错误。不是 ActiveRecord 缺少 #to_i 而是其他东西，在我的例子中涉及 factory_girl gem。

```
factory_girl (4.1.0)
factory_girl_rails (4.1.0) 
```

这是差异的一个孤立案例：

```
rails _3.1.0_ new rails31
cd rails31
bundle install
rails g scaffold note title:string contents:text
rails g scaffold user name:string
rails g migration add_user_id_to_notes user_id:integer
rake db:migrate 
```

然后在控制台中：

```
require 'factory_girl'
FactoryGirl.define { factory :note }
Factory(:note, :user_id => User.first, :title => 'foo')
  User Load (0.1ms)  SELECT "users".* FROM "users" LIMIT 1
  SQL (0.5ms)  INSERT INTO "notes" ("contents", "created_at", "title", "updated_at", "user_id") VALUES (?, ?, ?, ?, ?)  [["contents", nil], ["created_at", Sun, 13 Jan 2013 21:29:36 UTC +00:00], ["title", "foo"], ["updated_at", Sun, 13 Jan 2013 21:29:36 UTC +00:00], ["user_id", 1]]
 => #<Note id: 3, title: "foo", contents: nil, created_at: "2013-01-13 21:29:36", updated_at: "2013-01-13 21:29:36", user_id: 1> 
```

但是，如果我执行相同的步骤序列：

```
rails _3.2.11_ new rails3211 
```

然后在控制台中我看到：

```
1.9.2-p290 :001 > require 'factory_girl'
 => true 
1.9.2-p290 :002 > FactoryGirl.define { factory :note }
 => [] 
1.9.2-p290 :003 > Factory(:note, :user_id => User.first, :title => 'foo')
  User Load (0.1ms)  SELECT "users".* FROM "users" LIMIT 1
   (0.0ms)  begin transaction
  SQL (24.5ms)  INSERT INTO "notes" ("contents", "created_at", "title", "updated_at", "user_id") VALUES (?, ?, ?, ?, ?)  [["contents", nil], ["created_at", Sun, 13 Jan 2013 21:33:03 UTC +00:00], ["title", "foo"], ["updated_at", Sun, 13 Jan 2013 21:33:03 UTC +00:00], ["user_id", nil]]
   (2.4ms)  commit transaction
 => #<Note id: 1, title: "foo", contents: nil, created_at: "2013-01-13 21:33:03", updated_at: "2013-01-13 21:33:03", user_id: nil> 
```

注意 Rails 3.2.11 的 nil user_id

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-04T23:10:08.497

Rails 3.2.9 中的“to_i”方法有一个变化，但它处理的是列而不是表。见[这里](https://github.com/rails/rails/pull/7509)。

因此，在您的代码中，如果您传递的是整个对象而不是列值，那么它之前会默默地失败。但现在它实际上会调用对象上的“to_i”方法并引发异常。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-01T20:23:48.210

我不相信该`to_i`方法在他们自己的 AR 对象上可用。您能否更具体地了解该方法的早期用途，但现在失败了？

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-21T16:18:51.853

是的，当我将 rails 3.2.3 版升级到 rails 3.2.11 时，我也遇到了同样的问题。

这是一些代码片段有什么确切的问题

在 Rails 3.2.3中，
医生 = Doctor.first
patient = Patient.new
patient.doctor_id =doctor （右侧对象分配有效）
Patient.save！（有效）

在 rails 3.2.11
中医生 = Doctor.first
患者 = Patient.new 患者.doctor_id
= 医生（右侧对象分配无效）
Patient.save！（无效）
NoMethodError: undefined method 'to_i' error 我们得到了这种分配。

结论是我们只使用 _ID = INTEGER 而不是像对象分配一样。
[更多细节](http://madhan-tech-updates.blogspot.in/2013/01/undefined-method-toi-in-rails-3211.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-09T11:54:03.687

为了跟进 Luca，我使用的是 Rails 3.2.11，我不确定我是否有这样的代码，但我确实发现它不再起作用：

```
@lecture.update_attribute(:professor_id, Professor.find_by_id(1)) 
```

# c - C中的连接作为金字塔

> ID：13348984
> 
> 赞同：2
> 
> 时间：2012-11-12T18:02:46.053
> 
> 标签：c, string, concatenation

我曾在 Python 上工作过，我知道要将字符串连接为 --- 你可以简单地用字符“-”“乘”一个整数，所以在这种情况下，我们可以像 result=3*“-”一样简单地做到这一点. 我一直试图用 C 语言来做这件事。

如何在 C 中执行此操作，例如：

```
#include <stdio.h>
int main (void)
{

    int height=0;
    int n=0;
    char symbol='#';
    printf("Height: ");
    scanf("%d",&height);
    n=height+1;
    while (n>=2)
        {
        printf("symbol*n");
        n=n-1;
        }
    return 0;
} 
```

所以它打印一个高度为 5 的倒金字塔：

```
#####
####
###
##
# 
```

先感谢您！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T18:06:51.327

没有内置的方法可以重复这样的输出。你必须自己编码。

```
void multiputchar(char c, size_t count)
{
    for (int i = 0; i < count; i++)
        putchar(c);
} 
```

对于库函数，您可能关心是否`putchar()`失败，因此您最好编写：

```
int multiputchar(char c, size_t count)
{
    for (int i = 0; i < count; i++)
    {
        if (putchar(c) == EOF)
            return(EOF);
    }
    return (unsigned char)c;
} 
```

但如果返回值总是被忽略，第一个更简单。强制转换是必要的，以确保如果您的`char`类型已签名，您可以区分 ÿ 的失败和成功输出（y-变音符号，U+00FF，LATIN SMALL LETTER Y WITH DIAERESIS，8859-1 中的 0xFF 和相关代码套）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T18:12:29.937

在 C 中，您还需要处理您使用的内存。因此，如果您想要一个“---”字符串，您还需要为该字符串*分配空间。*一旦分配了空间，您将用给定的字符填充它。

之后，您必须释放该区域。

所以：

```
char *charmul(char c, int n)
{
    int i;
    char *buffer; // Buffer to allocate
    buffer = malloc(n+1); // To store N characters we need N bytes plus a zero
    for (i = 0; i < n; i++)
        buffer[i] = c;
    buffer[n] = 0;
    return buffer;
} 
```

然后我们需要添加错误检查：

```
char *charmul(char c, int n)
{
    int i;
    char *buffer; // Buffer to allocate
    buffer = malloc(n+1); // To store N characters we need N bytes plus a zero
    if (NULL == buffer)
         return NULL;
    for (i = 0; i < n; i++)
        buffer[i] = c;
    buffer[n] = 0;
    return buffer;
} 
```

您的来源将变为：

```
#include <stdio.h>

// charmul here

int main (void)
{

    int height=0;
    int n=0;
    char symbol='#';
    printf("Height: ");
    scanf("%d",&height);
    n=height+1;
    while (n>=2)
        {
            char *s;
            s = charmul(symbol, n);
            printf("%s\n", s);
            free(s); s = NULL;
            n=n-1;
        }
    return 0;
} 
```

另一种实现将寻求减少`malloc`' 的数量，以提高性能。为此，您还需要向函数传递一个指向前一个缓冲区的指针，如果更短，则可以回收而无需进一步`malloc`的 ，如果更长，将被`free`'d 并重新分配（或者可以使用`realloc`）。然后，您将`free()`只执行最后一个未回收的值：

```
char *charmul_recycle(char c, int n, char *prevbuf)
{
    int i;
    if (prevbuf && (n > strlen(*prevbuf)))
    {
        free(prevbuf); prevbuf = NULL;
    }
    if ((NULL == prevbuf)
    { 
        prevbuf = malloc(n+1); // To store N characters we need N bytes plus a zero
        if (NULL == prevbuf)
            return NULL;
    }
    for (i = 0; i < n; i++)
        prevbuf[i] = c;
    prevbuf[n] = 0;
    return prevbuf;
}

char *buffer = NULL;

while(n > 2)
{
     buffer = charmul_recycle(symbol, n, buffer);
     if (NULL == buffer)
     {
         fprintf(stderr, "out of memory\n");
         abort();
     }
     printf("%s\n", buffer);
     n--;
} 
```

当然，整个事情可以通过单个直接分配和逐步缩短字符串（通过设置`s[n]`为零）来完成，但是我们不会使用“生成多个字符”功能：

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

int main (void)
{
    char *string;
    int height=0;
    int n=0;
    char symbol='#';
    printf("Height: ");
    scanf("%d",&height);
    n=height+1;
    string = malloc(n);        // allocate just enough memory (n is height+1)
    memset(string, symbol, n); // fill string with symbols

    while (--n) // with n ever decreasing...
    {
        string[n] = 0;            // Truncate string after n characters
        printf("%s\n", string);   // output string
    }
    free(string); // string = NULL; // finally free the string
    return 0;
} 
```

**更新**（感谢 Jonathan Leffler）：上面，有一个潜在的危险“过度优化”。在每次使用 之前`string`，`string`正确地以零结尾（“ `string[n] = 0;`”）。*但是*，我已经分配了一个字符串变量并用东西填充它，并且没有立即零终止它，这仍然是事实。在上面的代码中，一切都很完美。这仍然是不好的编码实践，因为如果代码被重用并删除了循环，并且字符串用于其他目的（在*这种*情况下不太可能，但仍然......），未终止的`string`可能会成为一个微妙的错误。

最快的解决方法是在分配后终止：

```
 string = malloc(n);        // allocate just enough memory (n is height+1)
    memset(string, symbol, n-1); // fill string with symbols
    string[n-1] = 0;           // zero-terminate string 
```

我现在偏离了原始主题，但这意味着在这种情况下，字符串正确地以零结尾*两次*。为避免这种情况，可以将代码重写为“剪切和粘贴安全”版本，还可以更清楚地显示额外的零作为 n 的添加：

```
 n=height;                   // Number of characters
    string = malloc(n+1);       // Allocate memory for characters plus zero
    memset(string, symbol, n);  // Store the characters
    string[n] = 0;              // Store the zero
    while (n)                   // While there are characters
    {
        printf("%s\n", string); // Print the string
        string[--n] = 0;        // Reduce it to one character less than before
    } 
```

该循环现在接受任何具有有意义的有效字符串`n`，如果将其删除，则该字符串将保持可用状态。

# c++ - 如何在c ++中找出数字的位数？

> ID：13348986
> 
> 赞同：3
> 
> 时间：2012-11-12T18:02:54.903
> 
> 标签：c++

我想找出 C++ 中数字的位数，但我不知道该怎么办？例如位数 7676575。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-12T18:03:53.017

取以 10 为底的对数的上限。（或更一般地，“ base- *N ”表示以**N*为底的位数。）

在代码中：`std::ceil(std::log10(n + 1))`，并确保`#include <cmath>`.

`0`（作为特殊情况，您将得到输入的答案`0`。如何处理负数取决于您。）

@Knaģis 的答案中的代码可能更有效，因为除以常数 10 可以被编译器转换为乘法并且相当便宜。您必须分析和比较这是否对性能至关重要，以及这是否仅适用于整数类型。对数方法还允许您计算非常大的浮点数的假设十进制扩展中的位数。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-12T18:04:21.407

```
int i = 7676575;
int digits = i == 0 ? 1 : 0;
i = abs(i); // handle negative numbers as well
while (i > 0)
{
    digits++;
    i /= 10;
}

// -or- if you prefer do/while then a shorter sample (by Kerrek SB)

int i = 7676575;
int digits = 0;
i = abs(i); // handle negative numbers as well
do { digits++; } while (i /= 10); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-12T18:08:15.373

把它放在一个字符串中并得到它的长度；

```
int number = getNumberFromSomewhere();

stringstream ss;

ss << number;
size_t numDigits = ss.str().length(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-12T18:12:06.667

```
template <typename T>
int getdigits(T v)
{
T i = std::abs(v);
if (i < 10) return 1;
else if (i < 100) return 2;
...
else if (i < 100000000) return 8;
else if (i < 1000000000) return 9;
} 
```

依此类推，您可以扩展到包括长范围，而不仅仅是 int。我不确定这是否比除法更快，但为什么不 - 这只是 10 次比较。

我想模板黑魔法可以用来生成只需要几个 if 的函数，但谁真的在乎呢。但是您可以使用 std::enable_if<std::is_integer<T>::value> 确保 T 是整数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-02-22T00:15:09.580

您可以转换为字符串并检查字符串的长度：

```
std::to_string(number).size() 
```

# iphone - 有没有办法在iOS 6.0 上关闭音频输入的自动低频过滤？

> ID：13348988
> 
> 赞同：12
> 
> 时间：2012-11-12T18:03:12.830
> 
> 标签：iphone, ipad, audio, audiounit

我正在开发一个应用程序，该应用程序使用 iOS 6.0 SDK 分析来自 iPhone/iPad 上内置麦克风的传入音频。

我一直在用非常低的较低频率（即低于 200 赫兹）挣扎一段时间，我（在网上）发现其他人有同样的问题，但没有任何问题的答案。

使用 iOS 音频工具的多家公司表示（在 iOS 6.0 之前）有一个内置的低频滚降滤波器会在较低频率上导致这些低信号，但这些消息来源还指出，**从 iOS 6.0 开始，它应该是可以关闭输入音频信号的这种自动低频过滤**。

我浏览了音频单元头文件、Xcode 中的音频文档以及与音频相关的示例代码，但均未成功。我玩过 AudioUnit 的不同参数和属性（其中提到了低通滤波器等），但没有解决问题。

**有人知道如何在 iOS 6.0 中关闭 RemoteIO 输入的自动低频滚降滤波器吗？**

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-20T14:13:45.733

在 iOS 6.0 下，可以将当前的 AVAudioSession 设置为 AVAudioSessionModeMeasurement，如下所示：

```
[[AVAudioSession sharedInstance] setMode: AVAudioSessionModeMeasurement error:NULL]; 
```

这消除了低频滤波。

关联：

[http://developer.apple.com/library/ios/#documentation/AVFoundation/Reference/AVAudioSession_ClassReference/Reference/Reference.html](http://developer.apple.com/library/ios/#documentation/AVFoundation/Reference/AVAudioSession_ClassReference/Reference/Reference.html)

我希望这有帮助。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-24T19:09:03.777

我不确定是否有任何方法可以*在*这些设备上完成此操作。**大多数麦克风在低于200 HZ**的频率（以及高于**20 kHZ**的范围内）都有困难。事实上，许多扬声器也*几乎无法*在该范围内播放音频。为了在**<200 HZ**范围内获得干净的信号，您需要足够好的硬件，我认为这有点超出 iPhone/iPad 的内置麦克风的能力。这可能就是 Apple 过滤掉这些低频声音的原因，因为它们不能保证足够好的录音*或*足够好的回放。[这里是](http://blog.faberacoustical.com/2010/ios/iphone/iphone-4-audio-and-frequency-response-limitations/)一个链接更好地描述了旧设备（iPhone 4、iPhone 3GS 和 iPad 1）的情况。

苹果对他们会和不会让你玩的东西也非常挑剔。即使您确实发现了此过滤发生的位置，中断该代码也很可能会导致您的应用被应用商店拒绝。而且由于硬件限制，您可能无论如何都无法实现您想要的。

希望有帮助！

# python - 使用列表理解和集合

> ID：13348991
> 
> 赞同：3
> 
> 时间：2012-11-12T18:03:23.220
> 
> 标签：python, set, list-comprehension

创建并打印同时满足以下两个条件的单词列表：

*   该单词至少有 8 个字符长；
*   由奇数字母组成的单词在小写单词集合中；和
*   由偶数字母组成的单词在小写单词的集合中。

例如，单词“ballooned”应该包含在您的列表中，因为由奇数字母组成的单词“金发”和由偶数字母组成的单词“aloe”都在小写单词。类似地，“triennially”分为“tinily”和“renal”，两者都在词表中。

我的老师告诉我们应该使用一套：`s=set(lowers)`因为这样会更快。

到目前为止我所拥有的：

```
s=set(lowers)
[word for word in lowers if len(word)>=8
                        and list(word)(::2) in s
                        and list(word)(::-2) in s] 
```

我不认为我正在使用正确的设置。有人可以帮我让它工作吗

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T18:08:47.013

问题是您`word`转换为一个列表（不必要），您的切片不在括号中（您使用了括号），并且您的第二个切片使用了错误的索引（应该是`1::2`，不是`::-2`）。

以下是正确完成的切片：

```
>>> word = "ballooned"
>>> word[::2]
'blond'
>>> word[1::2]
'aloe' 
```

请注意，这`s`是一组小写单词的奇怪名称。一个更好的名字将是`words`。

你的使用`set`是正确的。您的老师希望您使用集合的原因是测试集合的成员资格比测试列表要快得多*。*

把它放在一起：

```
words = set(lowers)
[word for word in words if len(word) >= 8
                        and word[::2] in words
                        and word[1::2] in words] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-12T18:09:11.117

以下是如何在列表理解中构建条件检查的快速示例：

```
>>> word = 'ballooned'
>>> lowers = ['blond', 'aloe']
>>> s = set(lowers)
>>> len(word) >= 8 and word[::2] in s and word[1::2] in s
True 
```

**编辑：**刚刚意识到它`lowers`同时包含有效词和“搜索”词，如“气球”和“三年一次”，无论如何，您应该能够在列表理解中使用上述条件来获得正确的结果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-12T18:10:54.797

```
list(word)(::2) 
```

首先，访问索引范围的语法是使用方括号，另外，您不需要先`word`转换为列表，您可以直接在字符串上执行此操作：

```
>>> 'ballooned'[::2]
'blond' 
```

此外，`[::-2]`不会给你不均匀的词，而是另一个词的颠倒版本。您需要使用`[1::2]`（即跳过第一个字符，然后每隔一个字符）：

```
>>> 'ballooned'[::-2]
'dnolb'
>>> 'ballooned'[1::2]
'aloe' 
```

一般来说，单独测试某些部分以查看它们是否真的按照您认为的那样做总是一个好主意。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-12T18:09:09.133

这应该这样做：

```
s=set(lowers)
[word for word in lowers if len(word)>=8 and word[::2] in s and word[1::2] in s] 
```

或使用`all()`：

```
In [166]: [word for word in lowers if all((len(word)>=8,
                                               word[::2] in s,
                                               word[1::2] in s))] 
```

使用`[::]`not `(::)`，这里没有必要`list()`，加上获得由放置在奇数位置的字母组成的单词 use `[1::2]`。

```
In [151]: "ballooned"[::2]
Out[151]: 'blond'

In [152]: "ballooned"[1::2]
Out[152]: 'aloe' 
```

# mysql - 条件下的 MySQL 组

> ID：13348994
> 
> 赞同：2
> 
> 时间：2012-11-12T18:03:31.287
> 
> 标签：mysql

假设我有下表：

```
 time_recorded        |   room   | num_occupied
 ----------------------------------------------
 2012-11-05 00:00:00       a          10
 2012-11-05 00:00:00       b          20
 2012-11-05 00:00:00       c          30
 2012-11-05 00:00:00       d          40

 2012-11-05 00:30:00       a          100
 2012-11-05 00:30:00       b          200
 2012-11-05 00:30:00       c          300
 2012-11-05 00:30:00       d          400
                     ... 
```

当房间 = 'b' 和 'c' 时，我需要对行进行分组，以便生成的输出为

```
 time_recorded        |   room   | num_occupied
 ----------------------------------------------
 2012-11-05 00:00:00       a          10
 2012-11-05 00:00:00       bc       (20+30)
 2012-11-05 00:00:00       d          40

 2012-11-05 00:30:00       a          100
 2012-11-05 00:30:00       bc      (200+300)
 2012-11-05 00:30:00       d          400
                     ... 
```

我尝试了*juergen d*建议的以下查询：

```
SELECT 
    *
FROM 
    usage
WHERE 
    DATE(time_recorded) = '2012-11-05'
    GROUP BY CASE WHEN room IN ('b', 'c') THEN 'bc' ELSE room END; 
```

由于某种原因，我得到以下返回：

```
 time_recorded        |   room   | num_occupied
 ----------------------------------------------
 2012-11-05 00:00:00       a          10
 2012-11-05 00:00:00       b          20 
```

我究竟做错了什么？

先感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T18:13:26.710

您正在按计算值分组，但不显示该值。

您还需要将`CASE`表达式`SELECT`以及计算字段放在子句中以显示`num_occupied`. 像这样的东西：

```
SELECT 
   time_recorded, CASE WHEN room IN ('b', 'c') THEN 'bc' ELSE room END, 
    SUM(num_occupied)
FROM 
   usage
WHERE 
    DATE(time_recorded) = '2012-11-05'
   GROUP BY 1, 2; 
```

（根据评论编辑）

# php - 检查数组中的值的速记

> ID：13348996
> 
> 赞同：5
> 
> 时间：2012-11-12T18:03:34.750
> 
> 标签：php, arrays, compare

有没有捷径可以做到这一点？

```
if ((isset($a['key']) && ($a['key'] == 'value')) {
  echo 'equal';
  // more code
}
else {
  echo 'not equal';
  // more code
} 
```

我需要在一个可以存在或不存在的数组上测试很多值。我觉得这个方法太冗长了。

我可以删除`isset()`通知并将通知静音...但是我觉得很脏。

**编辑：**

回答 Jack 的问题：*“你能举个例子，你将如何测试数组中的大量值吗？”*

例子：

```
if (isset($_GET['action']) && $_GET['action'] == 'view') {
  //code
}
if (isset($_GET['filter']) && $_GET['filter'] == 'name') {
  //code
}
if (isset($_GET['sort']) && $_GET['sort'] == 'up') {
  //code
}
if (isset($_GET['tag']) && $_GET['tag'] == 'sometag') {
  //code
}
etc... 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2020-09-04T12:34:34.107

*对于任何仍然绊倒这个问题的人......*

您可以使用[PHP 的合并运算符](https://www.php.net/manual/en/migration70.new-features.php#migration70.new-features.null-coalesce-op)：

```
if ( $a['key'] ?? false) {
  echo 'equal';
  // more code
}
else {
  echo 'not equal';
  // more code
} 
```

看到这个问题：[using PHP's null coalescing operator on an array](https://stackoverflow.com/questions/53342617/using-phps-null-coalescing-operator-on-an-array)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-12T18:35:36.367

我不喜欢回答自己的问题，但我觉得进行这种检查的最好和更干净的方法是编写一个“帮助函数”，例如：

```
function iskeyval(&$a, $k, $v) {
  return isset($a['key']) && ($a['key'] == 'value');
} 
```

进而：

```
if (iskeyval($a, 'key', 'value')) {
  ...
}
else {
  ...
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-12T18:16:23.063

简单地说（也就是只删除括号可以使其更短）非常好并且被接受为足够短：

```
if (isset($a['key']) && $a['key'] == 'value') { 
```

但是，当这样编写时，测试数组键的存在在技术上更正确：

```
if (isset($a) && is_array($a) && array_key_exists('key', $a) && $a['key'] == 'value') { 
```

*注意：仅针对`'value'`它进行测试时并不重要，但是如果您要与也可能`null`存在的变量进行比较，则和之间[的行为会有所不同](http://au1.php.net/array_key_exists#example-4628)`isset()``array_key_exists()`*

不幸的是，除非您可以根据现有谓词对其进行优化，否则这也会使表达式变得相当长。

最后，黑客的做法是这样的（我强烈建议**不**要这样做）：

```
if (@$a['key'] == 'value') { 
```

**更新**

要测试多个值并且可能的键有限，您可以使用变量变量：

```
foreach (array('action', 'filter', 'sort', 'tag') as $var) {
    $$var = isset($x[$var]) ? $x[$var] : '';
}

if ($action == 'view') {
}
if ($filter == 'name') {
}
// etc. 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-12T19:14:06.880

我添加了注释来解释代码。这是[代码](https://gist.github.com/4061240)：

```
//this array maps the function with the get parameters
$functions = array (
"action" => "do_actions" ,
"filter" => "do_filters"
);

foreach ($_GET as $key=>$value) {
    //check if this field is corresponding functions or not  
    if ( array_key_exists($key , $functions) ) {
        call_user_func($functions[$key] , $key,$value);
    }
}

function do_actions ($key , $value) {
    //place your code here to play with this value
    echo 'do_actions is called with ' . $key . 'and' . $value . "</br>";
}

function do_filters ($key , $value) {
    //place your code here to play with this value
    echo 'do_filters is called with ' . $key . ' and ' . $value .  "</br>";
}

?> 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-11-12T18:22:27.217

```
$list = array(
0 => 'one',
1 => 'two',
2 => 'one',
3 => 'three',
4 => 'one',
);

if( @$list['xxx'] !== 'three')
    echo 'Not ';

echo 'Equal'; 
```

禁止错误报告。

# c - linux内核代码“>>”运算符

> ID：13348997
> 
> 赞同：3
> 
> 时间：2012-11-12T18:03:36.433
> 
> 标签：c, linux, linux-kernel, operating-system

我们被分配了对 Linux 内核代码进行一些修改并重新编译它的任务。我很难弄清楚这段代码行是做什么的：

```
p->time_slice = (current->time_slice + 1) >> 1; 
```

更确切地说，为什么最后有“>> 1”？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-12T18:04:44.183

“>>”表示将值按位向右移动。"x >> y" 与除以 2^y 并截断结果相同。截断结果意味着在几乎所有情况下四舍五入，但是对于负数，可能存在替代实现。如果您认为这发生在您身上，请查看评论。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-12T18:05:20.313

这是一个按位移位运算符。将值视为位数组，它将所有内容向右移动一位（向最低有效位）。对于正数，这相当于除以 2，向下取整。移位用作除以 2 的幂的快速方法；如果移位 1 ( `>> 1`)，则除以 2，如果移位 2 ( `>> 2`)，则除以 4，依此类推。

例如，如果您使用 4 位整数，这里有几个例子说明这将如何工作：

```
6 >> 1
  0110  ->  0011 
               3

7 >> 1
  0111  ->  0011
               3

6 >> 2
  0110  ->  0001
               1 
```

对于负数，它有点复杂。C 标准没有指定负数的格式。在大多数现代机器上，它们以[二进制补码](http://en.wikipedia.org/wiki/Two%27s_complement)形式存储；也就是说，要表示一个负数，你取正表示，反转每一位，然后加 1。然后取最高有效位来表示符号位。如果你右移一个负数，有两种可能的解释；一种总是将 0 移入最高有效位，一种将匹配值移入已经存在的值，称为“符号扩展”。

```
-2 >> 1
   1110  ->  0111
                7
   1110  ->  1111
               -1 
```

C 标准没有指定实现必须使用这些解释中的哪一个。GCC 做了更令人期待的一个，符号扩展，这相当于除以二并向下舍入，就像正例一样。请注意，向下舍入意味着“向负无穷大”，而不是您可能假设的“向零”。

```
-3 >> 1
   1101  ->  1110
               -2 
```

# facebook - Facebook 应用程序：不重定向到 iFrame 中的 OAuth

> ID：13348998
> 
> 赞同：1
> 
> 时间：2012-11-12T18:03:36.790
> 
> 标签：facebook, iframe, canvas, oauth

我目前正在使用 php sdk 和 js sdk 开发一个 facebook 应用程序。（我两个都需要）

当用户尚未授权应用程序并加载画布页面 (https://apps.facebook.com/app_name/) 时，什么也没有发生，他只是得到一个顶部有 facebook 栏的空白页面。但如果他加载应用程序的直接 url (https://my_app.mydomain.com)，它工作正常，他被重定向到 OAuth 对话框。如果他授权该应用程序，则他会被重定向到[https://apps.facebook.com/app_name/](https://apps.facebook.com/app_name/)并且 iframe 会正确加载。

如果用户已经授权应用程序，则两个链接都可以正常工作（https://apps.facebook.com/app_name/ 和[https://my_app.mydomain.com](https://my_app.mydomain.com)）。

这是我的验证码：

```
<?php

require 'php-sdk/facebook.php';

$facebook = new Facebook(array(
  'appId'  => '327991330620101',
  'secret' => '79asecretcc4300',
  'cookie' => true
));

$user = $facebook->getUser();

if ($user) {
  try {
    $user_profile = $facebook->api('/me');
  } catch (FacebookApiException $e) {
    $user = null;
  }
}

if ($user) {
  $logoutUrl = $facebook->getLogoutUrl();
} else {

    $params = array(
      'scope' => 'publish_stream',
      'redirect_uri' => 'https://apps.facebook.com/quiet_quies/'
    );

  $loginUrl = $facebook->getLoginUrl($params);
  header('Location: ' . $loginUrl);
} 
```

有人对此有任何想法吗？这真的让我发疯......谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-12T19:42:17.740

是的，@CBroe 是对的，在您的`php`代码中尝试将`header('Location: ' . $loginUrl);`行替换为

```
echo "<script language=javascript>top.location.href ='".$loginUrl."'</script>"; 
```

它应该可以工作。