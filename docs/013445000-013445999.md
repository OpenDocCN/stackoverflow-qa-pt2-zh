# StackOverflow 问答 13445000-13445999

# iphone - iPad上的iPhone App在第一次启动时没有响应触摸

> ID：13445001
> 
> 赞同：5
> 
> 时间：2012-11-18T21:50:44.617
> 
> 标签：iphone, ios, ipad, touch, orientation

如果我的 iPhone 应用程序（非通用）在我的 iPad（第 3 代）上以横向模式启动，它不会响应任何触摸，直到我按下 1x/2x 按钮或更改方向。之后它可以正常工作。如果我在 iPhone 5 上以横向模式启动它，它就像一个魅力。

shouldAutorotateToInterfaceOrientation 在每个视图中都给出 YES，所以我认为这不是问题所在。

第一个视图是标签栏视图。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T03:15:53.097

我在 iOS6.0.1 的 iPad mini 上也有同样的问题。

我解决这个问题的方法是在 info.plist 中将支持的界面方向设置为全部关闭。

接下来，在 info.plist 中添加支持的界面方向 (iPad)，并且只在其中添加 Potrait（底部主页按钮）。

只要您在视图控制器中正确设置它，它应该对应用程序方向没有影响。此外，请确保设置正确的初始界面方向。

然后它解决了我的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-08T08:17:37.120

上面的答案有点难，尤其是在使用 Xamarin 时。这个答案确实有效：

来自另一个问题： [在 iPad 上以横向启动后，iphone 应用程序没有响应](https://stackoverflow.com/questions/13445452/iphone-app-doesnt-respond-after-starting-in-landscape-orientation-on-ipad)

Daniel Sandland 的评论确实为我解决了这个问题：

[[UIApplication sharedApplication] setStatusBarHidden:NO withAnimation:UIStatusBarAnimationNone];

在 didFinishLaunchingWithOptions 中，

（Xamarin 的 C# 变体）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-28T05:41:58.710

我认为这可能是屏幕上存在的 UI 控件的定位问题。控件可能具有自动定位参数（在 XIB 中）可能已设置为控件超出屏幕的方式。尝试更正 XIB 中的调整大小参数。

# md5 - 已知输入的 MD5 冲突

> ID：13445002
> 
> 赞同：8
> 
> 时间：2012-11-18T21:50:48.110
> 
> 标签：md5, collision

是否可以根据已知输入值创建 MD5 冲突？

因此，例如，我输入`abc`了带有 MD5的字符串`900150983cd24fb0d6963f7d28e17f72`。现在我想向字符串添加字节以`def`获得相同的 MD5 `900150983cd24fb0d6963f7d28e17f72`。

（我知道这可以通过暴力破解和等待很长时间来实现；我想知道是否有更有效的方法来做到这一点）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-19T00:48:22.070

Unitl 现在没有发现允许您找到将生成给定 md5 哈希的匹配输入的算法。

已经证明的是，您可以很容易地创建 md5 冲突，例如使用所谓的*selected-prefix-collision*：您可以通过将不同的数据附加到指定文件来创建两个产生相同 md5 哈希的文件。如果您想了解更多信息或让程序尝试一下，请看[这里](http://www.win.tue.nl/hashclash/)。

# objective-c - 自动调整 NSTableView 的大小

> ID：13445003
> 
> 赞同：4
> 
> 时间：2012-11-18T21:50:50.680
> 
> 标签：objective-c, xcode, macos, cocoa, nstableview

我有一个 NSTableView，它应该在添加一行时调整它的框架。我会创建 2 个属性，maxHeight 和 minHeight，如果要添加或删除任何行，我会调整表格视图的大小以适应它的内容，如果它没有超过限制。

就像 Safari 下载面板（10.7 或更高版本）。有谁知道如何做到这一点？我想在一个子类中处理这个。所以不要搞乱委托类中的调整大小。

我至少需要知道在重新加载表视图时调用了哪个方法。reloadTable 只调用真正的重新加载方法，所以那里没有成功。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-18T22:07:01.320

不久前我做了类似的事情，我在控制器上做了，而不是在子类上（对不起，如果它不是你要找的东西）。基本上我写了一个方法，通过添加所有行的高度来计算 tableview 的高度。每次我从表中添加或删除一行时，我都会调用该方法。这里有一些让你开始的东西：

```
- (void)adjustTableSize
{
    NSInteger minHeight = ...
    NSInteger maxHeight = ...

    NSInteger tViewHeight = 0;
    for (int i = 0; i < [tableView numberOfRows]; i++) {
        NSView* v = [tableView viewAtColumn: 0 row: i makeIfNecessary: YES]; // Note that this is for view-based tableviews
        tViewHeight += v.frame.size.height;
    }

    NSInteger result = MIN(MAX(tViewHeight, minHeight), maxHeight);

    // Do something with result here
} 
```

如果你*真的*想在子类上使用它应该是可能的，但是弄清楚如何......

## 编辑：

如果您不介意使用未记录的 API，这里有一个更简单的版本：

```
- (void)adjustTableSize
{
    NSInteger minHeight = ...
    NSInteger maxHeight = ...
    NSInteger result = MIN(MAX([tableView _minimumFrameSize].height, minHeight), maxHeight);

    // Do something with result here
} 
```

由于这是未记录的，我不能保证它会起作用，但从我目前的测试来看，它确实有效。它*可能*比仅仅为了获得它们的高度而创建视图要快，特别是如果你有很多行**。**

# emacs - defmacro 的主体没有被执行

> ID：13445008
> 
> 赞同：5
> 
> 时间：2012-11-18T21:51:02.063
> 
> 标签：emacs, lisp, elisp

我注意到我的代码中有一种`(with-current-buffer ....`一遍又一遍地重复相同内容的趋势，所以我决定根据该宏定义定义一个宏`with-current-buffer`——这就是我目前所拥有的：

```
(defmacro with-assembla-buffer(asm-buffer-name heading-str &rest body)
  "Create buffer with name of ASM-BUFFER-NAME, or uses it if exists,                                                                                                      
   preps it with readonly/erase/heading - executes `body' - then puts                                                                                                     
   readonly back on, goes to beginning of buffer, and switches to it."
  (with-current-buffer (get-buffer-create asm-buffer-name)
    (assembla-mode)
    (toggle-read-only -1)
    (erase-buffer)
    (insert (format "-- %s --------------------" heading-str))
    (newline)
    `(progn ,@body)
    (toggle-read-only 1)
    (goto-char (point-min))
    (switch-to-buffer (current-buffer)))) 
```

this 的主体永远不会被执行，但是当它切换到`defun`而不是`defmacro`is 时，它确实可以完美地工作。因此，除了**为什么 body 从未执行**之外，我的另一个问题是 -**这作为宏比 defun 更有意义吗？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-18T21:57:11.770

请记住，宏会生成代码。你的宏看起来不像。查看示例调用的宏扩展。调试宏的第一步是检查某些代码的宏扩展。

……

```
(with-current-buffer (get-buffer-create asm-buffer-name) 
```

上图：为什么这是宏中的代码而不是源代码？此代码将在宏展开时执行，不会出现在生成的代码中。你可能想反引号它。

```
 (assembla-mode)
  (toggle-read-only -1)
  (erase-buffer)
  (insert (format "-- %s --------------------" heading-str))
  (newline)

   `(progn ,@body) 
```

上图：这不会做你想要的。您需要反引号您要生成的所有代码 - 不仅仅是这个表格。

# linux - 带有克隆和信号的 Linux/GCC 线程

> ID：13445015
> 
> 赞同：0
> 
> 时间：2012-11-18T21:51:51.007
> 
> 标签：linux, multithreading, gcc, clone

一个简单的问题，如果我克隆一个线程，并且我设置了打开文件描述符以生成 SIGIO 信号，并保持相同的描述符表，那么在克隆后与信号相关时会发生什么？他们只是去原始线程，还是发生了一些不太明显的事情？

另外，我正在使用克隆来实现线程（我想编写自己的线程函数/库），还有其他陷阱或我应该注意的任何事情吗？随意链接到您认为我应该看的其他帖子。

我没有任何运气找到任何关于使用克隆实现线程的优质文章，所以如果知道任何好的信息通常在哪里，我将不胜感激。

# asp.net - Windows Azure 上不同域中的会话管理

> ID：13445019
> 
> 赞同：0
> 
> 时间：2012-11-18T21:52:07.613
> 
> 标签：asp.net, session, azure

我已经使用这篇[文章实现了会话状态管理](http://msdn.microsoft.com/en-us/wazplatformtrainingcourse_buildingappswithcacheservice_topic3.aspx)

只要我在同一个域中，它就可以正常工作，但是当我更改域时它失败了。你能告诉我如何在域之间共享会话。

在

[http://simpletix.cloudapp.net/Default.aspx](http://simpletix.cloudapp.net/Default.aspx)

我正在设置会话，这就是您可以`<h1>Default.aspx</h1>`在此页面上阅读的原因。

现在，如果我去[http://simpletix.cloudapp.net/Contact.aspx](http://simpletix.cloudapp.net/Contact.aspx) 我可以再次看到该标题，因为它已经在默认页面中设置。

现在我有另一个指向同一个站点但不同域的域。当我打开上面的链接后打开时，我希望 racreg.com 上的联系页面也会向我显示示例会话值`<h1>Default.aspx</h1>`，但它没有显示

[http://test.racereg.com/Contact.aspx](http://test.racereg.com/Contact.aspx)

你能告诉我在域之间实现会话的解决方法吗

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T06:40:42.627

正如 f0x 指出的那样，您不能在这些顶级域上共享 cookie。这意味着您需要恢复到无 cookie 会话（会话 ID 将存储在 url 中）。为此，您需要修改 web.config ( `<sessionState cookieless="true" />`)。

# mysql - 在子查询中使用串联分组依据

> ID：13445020
> 
> 赞同：2
> 
> 时间：2012-11-18T21:52:34.987
> 
> 标签：mysql, group-by

我正在尝试编写一个 SQL 查询，它将返回一列 ID 号作为结果，其中每个团队的人只出现在他们最好的时间。

本质上，它是一个允许人们为接力赛（例如有 4 个团队成员的游泳比赛）输入时间的系统，并且只会显示该团队的最佳时间。

[SQL小提琴：](http://www.sqlfiddle.com/#!2/ffff3)

我唯一能想到的就是在 result.id 上进行 Group By 并有一个字段 GROUP_CONCAT(member_result.member_id ORDER BY member_result.member_id)。然后我可以对此进行分组，但后来我被卡住了。

非常欢迎提出建议。

* * *

顺便说一句，对于非中继事件，这是我正在使用的代码：

```
SELECT result_id FROM ( 
    SELECT member_id,MIN(time) AS mintime 
    FROM result 
    JOIN member_result ON result.id = member_result.result_id 
    WHERE event_id = ? 
    GROUP BY member_id 
    ORDER BY mintime
) AS x 
JOIN result ON result.time = x.mintime 
JOIN member_result ON member_result.result_id = result.id AND member_result.member_id = x.member_id AND event_id = ? 
GROUP BY member_result.member_id ORDER BY mintime 
```

# java - 带有测试的 Java 代码 - 无限循环？

> ID：13445021
> 
> 赞同：0
> 
> 时间：2012-11-18T21:52:40.140
> 
> 标签：java

我试图理解人与人之间的关系。但是，当我运行单元测试时，测试会永远运行，它没有得到结果，而且我的 CPU 使用率很高。有人可以看到我的代码有什么问题吗？

字符串关系是字符串的多行输入，格式为`"A , B C , D"`where `A`is parent of`B`和`C`is parent of `D`。

这是代码的默认构造函数和字符串格式的输入。我们不需要检查格式是否正确：

```
public SeeRelations(String relations){
    this.relations = relations;
} 
```

这是从格式化输入中获取字符串的每一行的辅助函数：

```
//helper function to get each line of the string
private ArrayList<String> lineRelations(){
    int i;
    ArrayList<String> lineRelations = new ArrayList<String>();
    String[] lines = relations.split("\n");
    for(i = 0; i < lines.length; i++){
        lineRelations.add(lines[i]);
    }
    return lineRelations;
} 
```

这是将输入格式化字符串中的所有关系放入数组列表的函数：

```
//helper function to put each of the relationship in arraylists
private ArrayList<ArrayList<String>> allRelations(){
    int i;
    ArrayList<ArrayList<String>> allRelations = new ArrayList<ArrayList<String>>();
    ArrayList<String> lineRelations = lineRelations();
    for(i = 0; i < lineRelations.size(); i++){
        ArrayList<String> eachLine = new ArrayList<String>(Arrays.asList(lineRelations.get(i).split("\\s*,\\s*")));
        allRelations.add(eachLine);
    }
    return allRelations;
} 
```

这是检查输入名称是否存在的方法：

```
//helper function to see if the name exist for seeRelations()
private boolean hasThisName(String name){
    ArrayList<ArrayList<String>> allRelations = allRelations();
    int i;
    int j;
    for(i = 0; i < allRelations.size(); i++){
        for(j = 0; j < allRelations.get(i).size(); j++){
            if(name.equals(allRelations.get(i).get(j))){
                return true;
            }
        }
    }
    return false;
} 
```

这是获取两个人之间代号的函数：

```
//helper function to get Generation number of seeRelations()
private int getGenerationNum(String person, String ancestor){
    ArrayList<ArrayList<String>> allRelations = allRelations();
    String name;
    int i;
    int j;
    int generationNum = 0;
    for(i = 0, j = 0, name = ancestor; i < allRelations.size(); i++){
        if(name.equals(allRelations.get(i).get(0)) && !person.equals(allRelations.get(i).get(1))){
            generationNum++;
            ancestor = allRelations.get(i).get(1);
            i = 0;
            j = 1;
        }
        else if(ancestor.equals(allRelations.get(i).get(0)) && person.equals(allRelations.get(i).get(1))){
            generationNum++;
            j = 1;
            break;
        }
    }
    if(j == 0){
        return 0;
    }
    else{
        return generationNum;
    }
} 
```

`"great"`这是为最终输出获取倍数的方法：

```
private String great(int num){
    int i;
    String great = "";
    for(i = 0; i < num; i++){
        great += "great";
    }
    return great;
} 
```

这是我检查两个人之间关系的最后一种方法：

```
public String SeeRelations(String person, String ancestor){
    int generationNum = getGenerationNum(person, ancestor);
    String great = great(generationNum  - 2);
    if(!(hasThisName(person) && hasThisName(ancestor))){
        return null;
    }
    else{
        if(generationNum == 0){
            return null;
        }
        else if(generationNum == 1){
            return ancestor + " is the parent of " + person;
        }
        else if(generationNum == 2){
            return ancestor + " is the grandparent of " + person;
        }
        else{
            return ancestor + " is the" + " " +  great +"grandparent of " + person;
          }
    }
} 
```

这是我的测试用例，它永远运行，无法得到结果

```
public class FamilyTreeTest {

    @Test
    public void testSeeRelations() {
        FamilyTree relation2 = new FamilyTree("John Doe ,   Mary Smith" + "\n" + "Martin Weasel ,  John Doe");
        assertEquals("Martin Weasel is the grandparent of Mary Smith", familyTree2.SeeRelations("Mary Smith", "Martin Weasel"));
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T10:09:20.987

```
 for(i = 0, j = 0, name = ancestor; i < allRelations.size(); i++){
            if(name.equals(allRelations.get(i).get(0)) && !person.equals(allRelations.get(i).get(1))){
                generationNum++;
                ancestor = allRelations.get(i).get(1);
                i = 0;
                j = 1;
            }
            else if(ancestor.equals(allRelations.get(i).get(0)) && person.equals(allRelations.get(i).get(1))){
                generationNum++;
                j = 1;
                break;
            }
        } 
```

在这里，您的案例中有错误的行，您的祖先/名字是“Martin Weasel”，因为马丁的关系是“John Doe”，但是您正在寻找玛丽史密斯，所以`name.equals(allRelations.get(i).get(0)) && !person.equals(allRelations.get(i).get(1)))`这是这样`true`，这 `i = 0;`使您的循环从头开始

你可以做什么，尝试创建对象 person 即 class Person{ String name; 列出孩子；列出父母；... } 然后只做简单的tree walker

```
int SearchDown(Person person, String searchedRelation,int generation)
{
if person.getName().equals(searchedRelation())
return generation;
for (Person child: person.getChildren())
{
int generation = SearchDown(child, searchedRelation, generation+1);
if (generation!=-1) return generation;
}
return -1;
} 
```

ETC...

我真的发现这种方式更容易处理所有类型的树

# jsp - 请求的资源 (/BulkAccess/Download) 不可用

> ID：13445027
> 
> 赞同：1
> 
> 时间：2012-11-18T21:53:30.950
> 
> 标签：jsp, servlets

单击链接后，我正在尝试从服务器下载 excel 文件。我编写了以下 JSP 和 Servlet 代码。JSP 和 Servlet 都在同一个文件夹中。`The requested resource (/BulkAccess/Download) is not available`单击超链接下载 excel 文件后出现错误“ ”。

JSP 页面

```
 <body>

  <a href="Download"> Sample Excel File </a>

  </body> 
```

小服务程序

```
import javax.servlet.*;
import javax.servlet.http.*;
import java.io.*;

@SuppressWarnings("serial")
public class Download extends HttpServlet {
    public void doGet(HttpServletRequest request,HttpServletResponse response)
            throws ServletException, IOException {

        String filename = "C:\\excelFile.xls";

        ServletOutputStream out = response.getOutputStream();
        FileInputStream in = new FileInputStream(filename);

        response.setContentType("application/vnd.ms-excel");
        response.addHeader("content-disposition",
                "attachment; filename=" + filename);

        int octet;
        while((octet = in.read()) != -1)
            out.write(octet);

        in.close();
        out.close();
    }

    public void doPost(HttpServletRequest request,HttpServletResponse response)
            throws ServletException, IOException {
        doGet(request,response);
    }
} 
```

我在 web.xml 中有映射。下面是代码。

```
<servlet>
<servlet-name>Download</servlet-name>
<servlet-class>com.abc.bulk.Download</servlet-class>
</servlet>

<servlet-mapping>
<servlet-name>Download</servlet-name>
<url-pattern>/Download</url-pattern>
</servlet-mapping> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T06:05:53.560

您似乎在调用 Servlet 时遇到问题。

这应该有效。

```
 <a href="<%=request.getContextPath() %>/Download"> Sample Excel File </a> 
```

另外，你提到

> JSP 和 Servlet 都在同一个文件夹中

一般来说，JSP 属于`/webapp`or`/WebContent`和 Servlets 属于`/src/mypackage`.

与问题无关：使用小写 URL 映射是一种好习惯。

# jquery - jQuery 淡入淡出切换不会停止切换

> ID：13445032
> 
> 赞同：0
> 
> 时间：2012-11-18T21:54:07.477
> 
> 标签：jquery, toggle, fade

在我的项目中，切换功能会切换多次。我认为这是因为绝对定位的 div 应该淡入淡出。我解决不了那个...

这里是 jQuery 代码：

```
var $j = jQuery.noConflict();

$j(document).ready(function(){
$j('.grit_1_3_1').hover(
    function(){$j('.grit_1_3_1_hover').fadeIn()}, 
    function(){$j('.grit_1_3_1_hover').fadeOut()}
);
}); 
```

这里是 div 的 css：

```
.grit_1_3_1 {
color: #ffffff;
width: 33%;
float: left;
background: #bdbdbd;
vertical-align: center;
text-align: center;
height: 296px;
margin-bottom: 30px;
}
.grit_1_3_1_hover {
    color: #ffffff;
    position: absolute;
    width: 296px;
    display: none;

    float: left;
    background: #bdbdbd;
    vertical-align: center;
    text-align: center;
    height: 296px;
    margin-bottom: 30px;
} 
```

3 个预告片中的第一个应该切换，但不会停止！

谢谢你的帮助！

最好的祝福

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T21:55:13.993

```
$j(document).ready(function() {
    $j('.grit_1_3_1').hover(function() {
        $j('.grit_1_3_1_hover').stop.fadeTo(1);
    }, function() {
        $j('.grit_1_3_1_hover').stop().fadeTo(0);
    });
});​ 
```

## 编辑，

实际上，当鼠标悬停时，您的 HTML/CSS 也不正确`.grit_1_3_1`，`.grit_1_3_1_hover`完全重叠`.grit_1_3_1`。因此，这意味着鼠标现在已经退出`.grit_1_3_1`并且它会淡出。

`grit_1_3_1_hover`我建议您在子级别创建 2 个 div，`grit_content`然后`grit_content_hover`将代码修改为，而不是显示/隐藏

```
$j(document).ready(function() {
    $j('.grit_1_3_1').hover(function() {
        $j('.grit_content_hover', $(this)).stop.fadeTo(1);
    }, function() {
        $j('.grit_content_hover', $(this)).stop.fadeTo(0);
    });
});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T22:02:59.163

当您`.fadeIn()`使用`_hover`div 时，它会替换屏幕上的原始`<div>`内容，这会导致您的鼠标离开该 div，`<div>`从而触发调用的第二部分`.hover()`。

*与交换 div 相比，只交换这些 div 的文本内容*可能更简单。

或者，在两个交替的 div 之上使用`absolute`定位覆盖。`<div>`让*该*div 处理该`hover`操作，然后通过它显示下面所需的 div。

# css - Bootstrap 在纯 html 和 rails 中具有不同的行为

> ID：13445033
> 
> 赞同：0
> 
> 时间：2012-11-18T21:54:13.707
> 
> 标签：css, ruby-on-rails, twitter-bootstrap

我使用引导网格创建了一个网页。正如预期的那样，当我用浏览器打开它时，这个页面就完美呈现了。bootstrap 中的容器比屏幕还小，一切都很完美。

但是，如果我在 rails 中呈现与 application.html.erb 布局完全相同的页面，它总是会将此消息发送到浏览器：@media (min-width: 1200px)。这使我的页面变得比我的屏幕大一点。其余的都很好。Bootstrap 有效，但容器宽度太大！在普通页面中，它是 960px，非常完美！

为什么？

我不希望这种事情发生！这真的很奇怪。我读了一些帖子，人们说它发生在他们身上，但我有两个页面并排，“检查元素”在 rails 页面的“row”类的 css 中显示 @media (min-width: 1200px) 和其他什么都没有！

我完全不愿意破解引导 css。我只是想弄清楚发生了什么并解决它！我真的很想将它用作样式表而不是宝石......

提前非常感谢！

PS： *在 Rails 中，我将 bootstrap 文件夹复制到了 /assets/stylesheets/ 目录中*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T04:53:16.693

在文件'bootstrap_and_overrides.css.less'（或您拥有的任何其他）中添加您自己的样式怎么样？在我自己的 CSS 中，我有这个：

```
.container {
    width: 960px;
} 
```

问题就解决了。:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T12:12:12.287

也许我关于 Bootstrap 和 Rails 的问题的答案可以为您提供一些见解：

[如何单独访问引导文件](https://stackoverflow.com/questions/13379746/how-to-access-bootstrap-files-individually)

[如何在 Rails 中传递引导变量](https://stackoverflow.com/questions/13396380/how-to-pass-bootstrap-variables-in-rails)

# c# - 在 cshtml 页面上动态添加多个轮播 jquery 滑块

> ID：13445041
> 
> 赞同：0
> 
> 时间：2012-11-18T21:55:07.520
> 
> 标签：c#, jquery, asp.net, razor, webmatrix

我想使用数据库中的数据在 cshtml 页面上添加多个 jquery 滑块。基本上，我有一组选项卡，当它们处于活动状态时，它们会动态填充包含在数据库中的数据的滑块。

### 带有 Razor C# 钩子的 cshtml 代码：

```
<div class="tabbable">
    <ul id="myTab" class="nav nav-tabs">
        @foreach(var row in db.Query(queryCategory))
        {
            <li><a href="#@row.Food_Category" data-toggle="tab">@row.Food_Category</a></li>
        }
    </ul>
    <div class="tab-content">
        @{bool first = true;}
        @foreach(var row in db.Query(queryCategory))
        {
            var ids= @row.Food_Category;
            <div class="@{if (first){<text>tab-pane active</text> first = false;}else{<text>tab-pane</text>}}" id=@ids>
                <p>I'm in @row.Food_Category.</p>
                <div class="list_carousel">
                <ul id="foo">
                    @foreach(var row1 in db.Query("SELECT * FROM Food WHERE Food_Category = @0", ids))
                    {
                        <li>@row1.Food_ID</li>
                    }  
                </ul>
                <div class="clearfix"></div>
                <a id="prev2" class="prev" href="#">&lt;</a>
                <a id="next2" class="next" href="#">&gt;</a>
                <div id="pager2" class="pager"></div>
                </div>
            </div>
        }
    </div>
</div><!--tabbable--> 
```

**我认为需要重点关注的一点：** 除了这一点之外，其余的代码都是动态的。我不确定如何根据数据库列中的项目数为每个无序列表（例如 foo1、foo2、foo3 动态）获取唯一 ID。

```
<ul id="foo">
    @foreach(var row1 in db.Query("SELECT * FROM Food WHERE Food_Category = @0", ids))
    {
        <li>@row1.Food_ID</li>
    }  
</ul> 
```

**Jquery 位：** 这里我不确定，但我认为我需要将此选项设置为 true 以动态指定的#id 范围。

```
<script>
//Carousel
    $('#foo').carouFredSel({
        width: '100%',
        scroll: 2,          
        auto: false,
        prev: '#prev2',
        next: '#next2',
        pagination: "#pager2",
        mousewheel: true,
        swipe: {onTouch: true}
    });
</script> 
```

我刚开始使用 webmatrix 和 jquery，请多多包涵。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T22:19:55.343

如果您只想获取每个无序列表的唯一 ID，您可以这样做

```
 @int inc=0;
 @foreach(var row in db.Query(queryCategory))
    {
        var ids= @row.Food_Category;
        <div class="@{if (first){<text>tab-pane active</text> first = false;}else{<text>tab-pane</text>}}" id=@ids>
            <p>I'm in @row.Food_Category.</p>
            <div class="list_carousel">
            <ul id="foo@inc++">
                @foreach(var row1 in db.Query("SELECT * FROM Food WHERE Food_Category = @0", ids))
                {
                    <li>@row1.Food_ID</li>
                }  
            </ul>
            <div class="clearfix"></div>
            <a id="prev2" class="prev" href="#">&lt;</a>
            <a id="next2" class="next" href="#">&gt;</a>
            <div id="pager2" class="pager"></div>
            </div>
        </div>
    } 
```

但是，如果您只想在列表中动态地获得 carousal for-each，您可以将其用于 jquery foreach 中的每个函数

```
$('ul').each(function(index) {
     $('this').carouFredSel({
        width: '100%',
        scroll: 2,          
        auto: false,
        prev: '#prev2',
        next: '#next2',
        pagination: "#pager2",
        mousewheel: true,
        swipe: {onTouch: true}
    });
}); 
```

# webmatrix-2 - 如何在 WebMatrix 2 上升级 Nuget 包管理器

> ID：13445048
> 
> 赞同：1
> 
> 时间：2012-11-18T21:55:58.467
> 
> 标签：webmatrix-2

我试图在 WebMatrix 上安装一个包，但收到一个错误，提示我必须升级我的 Nuget 包管理器，并且该消息给了我一个访问链接。但是该链接不起作用，并且在尝试多次升级 Nuget 包管理器后我失败了。如何在 WebMatrix 2 上简单地升级 Nuget 包管理器？

# php - 警告：in_array() [function.in-array]：第二个参数的数据类型错误

> ID：13445051
> 
> 赞同：0
> 
> 时间：2012-11-18T21:56:11.233
> 
> 标签：php, mysql

在几年没有使用这种语言编程之后，我对 PHP 有点生疏了。

我正在使用 PHP 从 mySQL 中的数组中获取数据。

我的问题是，在某些时候我从表中获取数据，使用这个：

```
$myArray = mysql_fetch_array( $data ); 
```

但在某些时候，数据库可能为空，因此 $myArray 将为空或不包含任何元素。

然后我必须检查动态生成的特定字符串是否在 $myArray 上。如果是，则必须生成另一个字符串并验证它是否已存在于 $myArray 上。

```
$myString = generateString();
if (in_array($myString, $myArray)) {
    $myString = generateString();
} 
```

这段代码给了我这个错误：

**警告：in_array() [function.in-array]：第二个参数的数据类型错误**

为了防止 in_array 在 $myArray 为空时运行，我这样做了：

```
if (count($myArray) > 0) {
    if (in_array($myString, $myArray)) {
        $myString = generateString();
    }
} 
```

但是当数组为空（？）时，count 给了我 1...

我该如何解决？

只是另一个问题： $myString 在已经在测试它的 IF 中被修改。这在PHP中可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T21:59:28.033

好吧，如果您的查询失败，您将不得不......等待它......没有数组！

所以这个`in_array`调用会给你一个关于`$myArray`不是数组（但是`false`）的警告。

您需要检查查询是否有错误，更好的是：

> [**请不要`mysql_*`在新代码中使用函数**](https://stackoverflow.com/q/12859942/)。它们不再被维护，并且已经开始[弃用过程。](http://news.php.net/php.internals/53799)看到[**红框**](https://www.php.net/manual/en/function.mysql-connect.php)了吗？改为了解[*准备好的语句*](https://en.wikipedia.org/wiki/Prepared_statement)，并使用[PDO](http://php.net/pdo)或[MySQLi](http://php.net/mysqli) -[本文](https://php.net/manual/en/mysqlinfo.api.choosing.php)将帮助您决定使用哪个。如果您选择 PDO，[这里有一个很好的教程](http://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers)。

# c++ - C++ 序列化：用 write() 重载插入运算符

> ID：13445052
> 
> 赞同：2
> 
> 时间：2012-11-18T21:56:12.033
> 
> 标签：c++, serialization, operator-overloading, class-design, iostream

我有一个简单的类，其中包含一个动态分配的数组，我需要对其进行序列化，以便将其存储在二进制文件中。由于数组的原因，我不能使用 sizeof(MyClass) 来简单地分配缓冲区。

该类如下所示：

```
class ReplayFrame
{
public:
    // ...

private:
    int dataType_;
    int timeStamp_;
    int frameNumber_;
    size_t dataSize_;
    char* data_;
}; 
```

这是我想出的一个解决方案：

```
std::ostream& operator<< (std::ostream& out, const ReplayFrame& frame)
{
    out.write((char *) &frame.dataType_, sizeof(int));
    out.write((char *) &frame.timeStamp_, sizeof(int));
    out.write((char *) &frame.frameNumber_, sizeof(int));
    out.write((char *) &frame.dataSize_, sizeof(size_t));
    out.write(frame.data_, frame.dataSize_);

    return out;
} 
```

这对我来说似乎很好，但它在某种程度上改变了 << 运算符的含义。所以也许类似的东西`std::ostream& ReplayFrame::serialize(std::ostream& out, const ReplayFrame& frame)`会更好？

或者也许我应该有一个`serialize()`不使用流的方法，而是返回大小和指向序列化对象的指针，然后我自己编写，比如：

```
ReplayFrame replayFrame;
int size;

char *frameSerialized = replayFrame.serialize(size);
fileStream.write(frameSerialized, size);

delete frameSerialized; // or frameSerialized.release() ? 
```

正如你所看到的，我很困惑，所以我愿意接受任何好的建议。（注意：我使用 Qt，没有 boost，也没有 c++11）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T22:20:59.460

首先是重要的事情：只是将二进制数据转储到任何地方，无论是文件、另一个进程还是任何一个坏主意。您**总是**希望*格式化*数据，尽管格式可以是二进制的，并且它可能与您当前正在开发的系统的内部表示相匹配。但是，您应该意识到，任何勉强成功的程序都将比不同的编译器世代更长寿，可能是处理器升级，并被移植到另一个平台。如果您的二进制格式取决于编译器现在如何表示数据，那么所有这些都会令人头疼。如果该计划最终成功，那将是一个更大的麻烦。

您要注意的二进制格式的方面是

*   单个单词的大小
*   字内字节的排序
*   单词之间的潜在填充
*   写入数据项的顺序

例如，仅使用`sizeof()`来确定转储或读取的字节数在 32 位和 64 位平台之间不起作用。仅仅按照它们来的顺序转储字节是行不通的，例如，在 PowerPC 和 x86 系统之间。现在只是转储字节可能很容易，但在中期它会产生更多问题。

重载输出操作符是可以的，只要你**不**使用这个操作符的文本格式流类！您可以使用`std::streambuf`与读取和写入字节有关的层，例如，`std::filebuf`读取或写入文件，但是对于二进制格式的流，您希望在重载时使用专用的二进制流系统`operator<<()`。当然，这意味着类需要重载相应的操作才能在这个序列化系统中工作，但是混合文本和二进制格式的想法几乎肯定会引起很多麻烦。

# vim - 如何删除/添加引号？

> ID：13445054
> 
> 赞同：2
> 
> 时间：2012-11-18T21:56:20.457
> 
> 标签：vim

我想要一个删除/添加引号的命令

```
"This is a text" ->  This is a text
 This is a text  -> "This is a text" 
```

有吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-18T22:10:46.040

您可以使用流行的[环绕.vim 插件](http://www.vim.org/scripts/script.php?script_id=1697)：

*   `yss"`用引号包围一行。
*   `ds"`删除最近的周围引号。

另请参阅[本教程](http://www.catonmat.net/blog/vim-plugins-surround-vim/)以获取有关您可以使用此插件做什么的更多示例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-18T22:02:00.757

是的，进入*命令模式*，然后输入：

```
:%s/\(^"\|"$\)//g 
```

引用行：

```
:%s/\(^\|$\)/"/g 
```

这会在所有行上执行替换，如果需要，可以根据您的需要进行调整。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-03-19T21:51:38.187

要删除引号，您可以模拟一个新对象，`o"`意思是“外部引号”：

```
nnoremap do" di"viwp 
```

输入`do"`带引号的文本，您将获得不带引号的文本。

要添加引号，您可以这样做（尽管这只适用于行）：

```
nnoremap yo" I"<end>"<esc> 
```

如果您使用环绕.vim，您可以使用 yss" 引用整行，而无需为其映射新命令。

# java - URL 非法字符

> ID：13445055
> 
> 赞同：3
> 
> 时间：2012-11-18T21:56:40.263
> 
> 标签：java, android, url, uri

这是我的代码：

```
HttpClient client = new DefaultHttpClient();
            client.getParams().setParameter(CoreProtocolPNames.USER_AGENT, "android");
            HttpGet request = new HttpGet();
            request.setHeader("Content-Type", "text/plain; charset=utf-8");
            Log.d("URL", convertURL(URL));
            request.setURI(new URI(URL));
            HttpResponse response = client.execute(request);
            bufferedReader = new BufferedReader(new InputStreamReader(response.getEntity().getContent()));
            StringBuffer stringBuffer = new StringBuffer("");
            String line = "";
            String NL = System.getProperty("line.separator"); 
```

我不知道我的网址中有哪个错误：

> `http://localhost/CyborgService/chatservice.php?action=recive_game&nick_sender=mkdarkness&pass=MV030595&date_last=2012-11-18 09:46:37&id_game=1`

我已经使用了一个函数来转换 URL，但没有奏效。但是，如果我尝试在浏览器中打开此 URL，它会成功打开。

这是我的错误：

> ```
> 11-18 21:46:37.766: E/GetHttp(823): java.net.URISyntaxException: Illegal character in query at index 127: http://192.168.0.182/CyborgService/chatservice.php?action=recive_game&nick_sender=mkdarkness&pass=MV030595&date_last=2012-11-18 09:46:37&id_game=1 
> ```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-18T22:01:03.717

您的 URL 中有一个空格，在位置 127。日期生成为“date_last=2012-11-18 09:46:37”，这会在打开 URL 时导致错误。

URL 中不正式接受空格，但您的浏览器会很乐意将其转换为“%20”或“+”，这两者都是 URL 中空格的有效表示。您应该转义所有字符：您可以用“+”替换空格，或者只是通过[URLEncoder](http://docs.oracle.com/javase/1.5.0/docs/api/java/net/URLEncoder.html)传递字符串并完成它。

要使用 URLEncoder，请参见[这个问题](https://stackoverflow.com/questions/724043/http-url-address-encoding-in-java)：仅使用 URLEncoder 编码参数值，而不是完整的 URL。或者使用具有几个参数而不是单个参数的 URI 构造函数之一。您没有显示构造 URL 的代码，因此我无法明确评论它。但是，如果您有参数映射，`parameterMap`它将类似于：

```
String url = baseUrl + "?";
for (String key : parameterMap.keys())
{
  String value = parameterMap.get(key);
  String encoded = URLEncoder.encode(value, "UTF-8");
  url += key + "&" + encoded;
} 
```

有一天我们可以讨论为什么 Java 需要设置编码，然后要求编码是“UTF-8”，而不是仅仅使用“UTF-8”作为默认编码，但现在这段代码应该可以解决问题.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-18T21:59:24.433

有一个空格字符：

`...2012-11-18 09:46:37...`（在索引 127 处，就像错误消息所说的那样）。

尝试将其替换为`%20`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-29T06:46:59.530

这样做肯定会帮助你

```
 HttpClient myClient = new DefaultHttpClient();

            HttpPost myConnection = new HttpPost("http://192.168.1.2/AndroidApp/SendMessage");

            try {

    //Your parameter should be as..

                List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(2);
                nameValuePairs.add(new BasicNameValuePair("messageText", msgText));
                nameValuePairs.add(new BasicNameValuePair("senderUserInfoId", loginUserInfoId));

//set parameters to ur URL

                myConnection.setEntity(new UrlEncodedFormEntity(nameValuePairs));
//execute the connection
                HttpResponse response = myClient.execute(myConnection);
    }
    catch (ClientProtocolException e) {

                //e.printStackTrace();
            } catch (IOException e) {
                //e.printStackTrace();
            } 
```

# java - 使用 GSON 解析复杂的 JSON 对象，由于 OOP 导致内容发生变化

> ID：13445062
> 
> 赞同：0
> 
> 时间：2012-11-18T21:57:57.837
> 
> 标签：java, android, oop, interface, parent-child

我从服务器获得了这样的 JSON，并希望将其解析为我的对象：

```
"product":{
"product_type":"assignment",
"id":717,
    "product_profile":{
    "title":"new Order from java",
    "info":"Some special info",
    "dtl_expl":true,
    "special_info":""
    }
} 
```

取决于“product_type”值，我从服务器获得不同的“product_profile”值。“product_profile”可以是三种类型之一。我为他们每个人创建了课堂演示。但问题是，由于 OOP 原则，如何将 JSON 对象的正确解析组织到我的 Product 类中？我应该创建接口并在我的三个类中的每一个中实现它，还是我应该创建一个父类并在我的三个类中扩展它以使其正常工作？

我的班级结构。首先是 Product 类，我应该从 json 得到它的对象：

```
 public class Product {
    ProductAssignment prodAss;
    ProductWriting prodWr;
    ProductType returnState;

    @SerializedName("id")
    int id;
    @SerializedName("product_type")
    String product_type;
    @SerializedName("product_profile")
    ProductType product_profile;

    public Product()
    {}
    public Product(int id, String product_type, ProductType product_profile)
    {
        this.id = id;
        this.product_type = product_type;
        this.product_profile = product_profile.returnObject(product_type);
    }

    public int getProductId() 
    {

         return this.id;
    }
    public String getProductType() 
    {
         return this.product_type;
    }
    public ProductType getProduct() 
    {
         return product_profile.returnObject(product_type);
    }
    public void setProductId(int id) 
    {
        this.id = id;
    }
    public void setProductTitle(String product_type) 
    {
        this.product_type = product_type;
    }
    public void setProduct(ProductType product_profile) 
    {
        this.product_profile = product_profile;
    }
    @Override
    public String toString() {
        return "id=" + id + " " + "title=" + product_type
                + " " + "profile=" + product_profile  +  "}";
    }

} 
```

现在父类 ProductType 有两个子类：

```
 public class ProductType extends ProductType{
    String product;

    static ProductType productType;
    static ProductAssignment productAssignment;
    static ProductWriting productWriting;
    IProductType component;

    private ProductType returnState;
    ProductAssignment prodAss;
    ProductWriting prodWr;
    public ProductType()
    {       
    }
    public ProductType(IProductType c)
    {
         component = c;
    }
   // implemented method of interface
    @Override
    public ProductType returnObject(String product_type) 
    {
        System.out.println("ProductType");
        if (product_type.equals("assignment"))
            returnState =  prodAss.returnObject(product_type);
        else if  (product_type.equals("writing"))
            returnState =  prodWr.returnObject(product_type);
        System.out.println(returnState.getClass().getName());
        return returnState;
    }
} 
```

子类之一：

```
public class ProductWriting extends ProductType{

    @SerializedName("id")
    int id;
    @SerializedName("title")
    String title;
    @SerializedName("pages_number")
    int pages_number;
    @SerializedName("number_of_references")
    String number_of_references;
    @SerializedName("dtl_expl")
    boolean dtl_expl;
    @SerializedName("info")
    String info;

public ProductWriting()
        {}
        public ProductWriting(String title, String info, boolean dtl_expl, 
                int pages_number ,
                int id,String number_of_references)
        {
            this.title = title;
            this.info = info ;
            this.dtl_expl = dtl_expl;
            this.id = id;
            this.pages_number = pages_number;
            this.number_of_references = number_of_references;

        }
        public ProductWriting(IProductType c){
            super(c);
        }
        // getters and setters

         @Override
         public ProductType returnObject(String res) {
             System.out.println("Writing");    
               super.returnObject(res);
                 return new ProductWriting();
         }

} 
```

另一个 ：

```
public class ProductAssignment extends ProductType{
ProductAssignment thisObj;
@SerializedName("title")
String title;
@SerializedName("info")
String info;
@SerializedName("dtl_expl")
boolean dtl_expl;
@SerializedName("special_info")
String special_info;
@SerializedName("shoot_exclusive_video")
boolean shoot_exclusive_video;
@SerializedName("shoot_common_video")
boolean shoot_common_video;
public ProductAssignment()
{}
public ProductAssignment(String title, String info, boolean dtl_expl, String special_info,
        boolean shoot_common_video, boolean shoot_exclusive_video)
{

    this.title = title;
    this.info = info ;
    this.dtl_expl = dtl_expl;
    this.special_info = special_info;
    this.shoot_common_video = shoot_common_video;
    this.shoot_exclusive_video =shoot_exclusive_video;
}
// getters and setters

 @Override
 public  ProductType returnObject(String res) {
     System.out.println("Assignment");
     super.returnObject(res);
         return new ProductAssignment();
 }
@Override
public String toString()
{
    return "title=" + title + "info " + "=" + info
            + " " + "profile=" + dtl_expl +  "}";
} 
```

}

绑定我的类的接口：

```
 public interface IProductType 
{
     ProductType returnObject(String parse);
} 
```

我试图以这种方式实现，但它现在不起作用。

# mongodb - 使用 GORM MongoDB 持久化动态 groovy 属性

> ID：13445063
> 
> 赞同：2
> 
> 时间：2012-11-18T21:58:09.740
> 
> 标签：mongodb, grails, dynamic, properties, groovy

我目前正在尝试使用 Grails 的 GORM MongoDB 插件来保留以下类：

```
class Result {

    String url

    def Result(){

    }

    static constraints = {
    }

    static mapWith="mongo"

    static mapping = {
        collection "results"
        database "crawl"
    }
} 
```

我正在运行以保留此类的代码如下：

```
class ResultIntegrationTests {

    @Before
    void setUp() {

    }

    @After
    void tearDown() {

    }

    @Test
    void testSomething() {
        Result r = new Result();

        r.setUrl("http://heise.de")

        r.getMetaClass().setProperty("title", "This is how it ends!")

        println(r.getTitle())

        r.save(flush:true)
    }
} 
```

这是 MongoDB 中的结果：

```
{ "_id" : NumberLong(1), "url" : "http://heise.de", "version" : 0 }# 
```

现在 url 正确地保存在 MongoDB 中，但是映射器看不到动态属性——尽管 println(r.getTitle()) 工作得很好。

我是 groovy 的新手，所以我认为有更多经验的人可以帮助我解决这个问题。有没有办法让这个动态添加的属性对映射工具可见？如果是，我该怎么做？

非常感谢任何建议...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T09:39:23.480

与其将随机属性添加到元类并希望 Grails 会扫描元类以查找您的随机属性然后将它们持久化，不如将 Map 添加到您的域类（或 Result 可以的新键/值域类）`hasMany`) 所以你可以根据需要添加随机的额外属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T03:25:29.840

试试这个[文档](http://springsource.github.com/grails-data-mapping/mongo/manual/guide/3.%20Mapping%20Domain%20Classes%20to%20Mongo%20Collections.html#3.4%20Dynamic%20Attributes)

```
@Test
void testSomething() {
    Result r = new Result();

    r.url = "http://heise.de"

    r.['title'] = "This is how it ends!"  //edit: forgot the subscript 

    println r.['title']

    r.save(flush:true)
} 
```

顺便说一句，您总是可以直接使用 java api / [gmongo](https://github.com/poiati/gmongo)而不是使用 gorm 或 hibernate 。

# c++ - 从 Xcode 链接到 Boost

> ID：13445064
> 
> 赞同：5
> 
> 时间：2012-11-18T21:58:11.737
> 
> 标签：c++, xcode, boost, linker

我想使用 Boost-library 编译一个 Xcode（4.5.2 版）项目。我已经在我的 Mac 上成功安装了 Boost，并收到以下消息：

```
The following directory should be added to compiler include paths:
XXX/boost_1_52_0
The following directory should be added to linker library paths:
XXX/boost_1_52_0/stage/lib 
```

如何在 Xcode 中添加编译器包含路径和链接器库路径？非常感谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-18T23:17:11.037

我应该提到以下内容适用于 Xcode 4.5.2。您可能应该在问题中提及您使用的 Xcode 版本。

1.  在 Project Navigator 中选择您的项目文件（通常在顶部）
2.  给定 Basic 或 All 两个视图选项，在视图窗格中选择 All。
3.  在设置列表中找到“**搜索路径”部分**
4.  找到搜索路径下的**标题搜索路径子部分**
5.  添加路径（绝对或相对于源文件夹）。您可以为 Debug、Release 或 Both 执行此操作。

如果您没有看到它，您也可以在此处添加其他库搜索路径，相同区域，**库搜索路径小节**

* * *

**针对 Xcode 5.0.2 更新**

1.  在 Project Navigator 中选择您的项目文件（通常在顶部）
2.  右侧窗格中是项目配置面板。左上角是两组可选择的单选选项。一个说基本或全部，选择**全部**。第二个说 Combined 或 Levels，选择**Combined**。
3.  在设置列表中找到“**搜索路径”部分**
4.  找到搜索路径下的**标题搜索路径子部分**
5.  添加路径（绝对或相对于源文件夹）。您可以为 Debug、Release 或 Both 执行此操作。

# ios - 在选项卡内的 zbar didFinishPickingMediaWithInfo 之后更改视图（故事板）

> ID：13445076
> 
> 赞同：0
> 
> 时间：2012-11-18T21:59:59.477
> 
> 标签：ios, storyboard, xcode4.5, zbar-sdk, uitabcontroller

我对在 iPhone 上进行编程还是很陌生，并且已经研究了我的问题，但对任何解决方案都没有运气。

我已经设法遵循[ZBar SDK 集成教程](http://zbar.sourceforge.net/iphone/sdkdoc/tutorial.html)，最后在选项卡控制器中拥有一个工作应用程序。

我想要做的是，将结果移动到单独的 ViewController。

```
- (void) imagePickerController: (UIImagePickerController*) reader
 didFinishPickingMediaWithInfo: (NSDictionary*) info
{
    // ADD: get the decode results
    id<NSFastEnumeration> results =
    [info objectForKey: ZBarReaderControllerResults];
    ZBarSymbol *symbol = nil;
    for(symbol in results)
        // EXAMPLE: just grab the first barcode
        break;

    ProductViewController *product = [self.storyboard instantiateViewControllerWithIdentifier: @"ProductView"];

    product.resultImage = [info objectForKey: UIImagePickerControllerOriginalImage];
    product.resultText = symbol.data;

    [reader dismissModalViewControllerAnimated:YES];
    [self presentModalViewController:product animated:YES];
} 
```

我遇到的代码问题是产品视图控制器从未显示。

使用 Xcode 4.5、iOS 6 SDK。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-12T18:57:29.107

你试过了吗

```
UIViewController *newTopViewController = [self.storyboard instantiateViewControllerWithIdentifier:@"ProductView"];
[reader presentViewController:newTopViewController animated:YES completion:nil]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-13T21:52:08.370

我最终放弃了上述方法，而是在我的导航控制器上添加了处理显示的功能。

显示扫描：

`[[self targetController] displayNewObject:scan];`

在接收端：

```
- (void)displayNewObject:(_Scan *)scan
{
    self.scan = scan;
    self.tabBarController.selectedViewController = [self.tabBarController.viewControllers objectAtIndex:1];
    [[self navigationController] popToRootViewControllerAnimated:NO];
    [self performSegueWithIdentifier: @"ShowScanDetail" sender: self];
    self.scan = nil;
} 
```

# java - 传承计划。我从哪里开始？

> ID：13445078
> 
> 赞同：0
> 
> 时间：2012-11-18T22:00:40.123
> 
> 标签：java, class, inheritance, polymorphism, subclass

这是我得到的项目：

> 设计和实现一组定义各种类型电子设备（计算机、手机、寻呼机、数码相机等）的类。包括描述电子设备各种属性的数据值，例如重量、成本、用电量和制造商名称。包括为每个类适当命名并打印适当消息的方法。创建一个驱动程序类来实例化和练习几个类。

我以前做过一个，但我不知道从哪里开始设计这个。如果我能得到任何关于如何在这个项目中合并继承的提示，那将有很大的帮助。如果我可以有人概述代码/类的第一部分以帮助我入门，那我将是完美的。另外，如果你们对未来的参考有任何提示，可以帮助我完成这种性质的项目。就像我应该先创建所有课程还是一个接一个地完成一个课程。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T22:05:27.503

**设计和实现一组定义各种类型电子设备（计算机、手机、寻呼机、数码相机等）的类。**

从这里你知道你的班级的名字。如果您想使用超类并在类之间使用类似的方法，那将是一个好主意。也许是技术设备。

**包括描述电子设备各种属性的数据值，例如重量、成本、用电量和制造商名称。**

这里提供了一些示例实例变量，您可以在超类或子类中使用它们。如果在超类中，请确保包含这些属性的修改器和访问器。

**包括为每个类适当命名并打印适当消息的方法。创建一个驱动程序类来实例化和练习几个类。**

这将只是一个具有 main 方法的类，用于从超类和子类实例化您的对象

至于回答这个问题的方法，我将从弄清楚我想要什么类开始。所以想想一个有限的超类，然后是几个子类。然后开始考虑超类和子类的属性。

**编辑：**

这是一个非常艰难的开始。您将不得不使用更多的属性修改器和访问器来扩展类似的东西。然后添加您的子类。

```
public class TechnologyEquipment
{
    private double price;
    private String name;
    private String description;

    public TechnologyEquipment
    {
        this.price = 0.0;
        this.name = "";
        this.description = "";
    }

    public void setPrice(double price)
    {
        this.price = price;
    }
    public void setName(String name)
    {
        this.name = name;
    }
    public void setDesription(String description)
    {
        this.description = description;
    }

    public double getPrice()
    {
        return this.price;
    }
    public String getName()
    {
        return this.name;
    }
    public String getDescription()
    {
        return this.description;
    }
} 
```

# android - FOR 循环中的代码未执行

> ID：13445081
> 
> 赞同：0
> 
> 时间：2012-11-18T22:01:02.967
> 
> 标签：android, gson, progressdialog

我有一个 ProgressDialog，它通过执行 php 脚本从数据库中检索后台数据。我正在使用 gson Google 库。从浏览器执行时，php 脚本运行良好：

```
{"surveys":[{"id_survey":"1","question_survey":"Are you happy with the actual government?","answer_yes":"50","answer_no":"20"}],"success":1} 
```

但是，ProgressDialog 后台处理效果不佳：

```
@Override
        protected Void doInBackground(Void... params) {
            String url = "http://192.168.1.4/tn_surveys/get_all_surveys.php";

            HttpGet getRequest = new HttpGet(url);
            Log.d("GETREQUEST",getRequest.toString());

            try {

                DefaultHttpClient httpClient = new DefaultHttpClient();
                Log.d("URL1",url);

                HttpResponse getResponse = httpClient.execute(getRequest);
                Log.d("GETRESPONSE",getResponse.toString());
                final int statusCode = getResponse.getStatusLine().getStatusCode();
                Log.d("STATUSCODE",Integer.toString(statusCode));
                Log.d("HTTPSTATUSOK",Integer.toString(HttpStatus.SC_OK));
                if (statusCode != HttpStatus.SC_OK) { 
                    Log.w(getClass().getSimpleName(), "Error " + statusCode + " for URL " + url); 
                    return null;
                }

                HttpEntity getResponseEntity = getResponse.getEntity();
                Log.d("RESPONSEENTITY",getResponseEntity.toString());
                InputStream httpResponseStream = getResponseEntity.getContent();
                Log.d("HTTPRESPONSESTREAM",httpResponseStream.toString());
                Reader inputStreamReader = new InputStreamReader(httpResponseStream);

                Gson gson = new Gson();
                this.response = gson.fromJson(inputStreamReader, Response.class);

            } 
            catch (IOException e) {
                getRequest.abort();
                Log.w(getClass().getSimpleName(), "Error for URL " + url, e);
            }

            return null;
        }
    @Override
            protected void onPostExecute(Void result) {
                super.onPostExecute(result);
                Log.d("HELLO","HELLO");
                StringBuilder builder = new StringBuilder();
                Log.d("STRINGBUILDER","STRINGBUILDER");
                for (Survey survey : this.response.data) {
                    String x= survey.getQuestion_survey();
                    Log.d("QUESTION",x);
                    builder.append(String.format("<br>ID Survey: <b>%s</b><br> <br>Question: <b>%s</b><br> <br>Answer YES: <b>%s</b><br> <br>Answer NO: <b>%s</b><br><br><br>", survey.getId_survey(), survey.getQuestion_survey(),survey.getAnswer_yes(),survey.getAnswer_no()));

                }

                Log.d("OUT FOR","OUT");
                capitalTextView.setText(Html.fromHtml(builder.toString()));
                progressDialog.cancel();
            } 
```

显示 HELLO 日志。显示 STRINGBUILDER 日志。问题日志不显示。显示 OUT FOR 日志。

调查类：

```
public class Survey {

    int id_survey;
    String question_survey;
    int answer_yes;
    int answer_no;

    public Survey() {

        this.id_survey = 0;
        this.question_survey = "";
        this.answer_yes=0;
        this.answer_no=0;
    }

    public int getId_survey() {
        return id_survey;
    }

    public String getQuestion_survey() {
        return question_survey;
    }

    public int getAnswer_yes() {
        return answer_yes;
    }

    public int getAnswer_no() {
        return answer_no;
    }

} 
```

响应类：

```
public class Response {

    ArrayList<Survey> data;

    public Response() {
        data = new ArrayList<Survey>();
    }
} 
```

关于为什么不执行 FOR 循环的任何帮助。谢谢你的帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T22:03:21.657

> 关于为什么不执行 FOR 循环的任何帮助。

简单地说：`data`是空的。（所以循环没有什么可以迭代的......）

[从GSON 的文档](http://google-gson.googlecode.com/svn/trunk/gson/docs/javadocs/com/google/gson/Gson.html)中尝试这样的事情：

```
 Type listType = new TypeToken<List<String>>() {}.getType();
 List<String> target = new LinkedList<String>();
 target.add("blah");

 Gson gson = new Gson();
 String json = gson.toJson(target, listType);
 List<String> target2 = gson.fromJson(json, listType); 
```

我自己没有使用过 GSON，但是还有其他关于如何阅读列表的示例：

*   [Android gson 反序列化成列表](https://stackoverflow.com/q/7959157/1267661)
*   [GSON：自定义对象反序列化](https://stackoverflow.com/q/8533020/1267661)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T22:05:55.203

您的 onPostExecute 接受一个名为`result`. 您的 for 循环遍历名为 的实例变量中的元素`response`。他们应该是一样的吗？

# arrays - 是否有在 vb.net 中创建字符串数组的更短方法

> ID：13445091
> 
> 赞同：0
> 
> 时间：2012-11-18T22:02:18.440
> 
> 标签：arrays, vb.net, string

目前我正在使用它来创建一个字符串数组

```
New String() {" ", ".", ";"} 
```

有没有另一种不需要这么多字符的方法，比如没有 New String() 部分？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T22:08:07.630

编译器通常可以从其元素中推断出数组的类型，例如

```
Dim stringArray = {" ", ".", ";"} 
```

注意 - 当数组为空时这不起作用，因为没有要检查的元素。

```
Dim stringArray = New String() {} ' specify the source type, infer the destination type
Dim stringArray As String() = {}  ' specify the destination type, infer the source type 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T22:26:20.260

```
Dim stringArray = " . ".Cast(Of String)().ToArray() 
```

# ms-access - 将表单字段值分配给子表单中的所有记录

> ID：13445101
> 
> 赞同：2
> 
> 时间：2012-11-18T22:03:16.743
> 
> 标签：ms-access, ms-access-2007

我对 Access 很陌生，所以这对某些人来说可能非常容易或显而易见，或者根本无法完成。我已经搜索过这个网站，但我什至可能没有使用正确的关键字。到目前为止，我还没有找到任何可以帮助我做我想做的事情的东西。

我有一个表格，里面有一个连续的子表格。我在名为 txtPO_num 的主表单上有一个未绑定的 txt 字段。在这个表单中，我运行一个查询，显示在连续子表单中满足指定条件的所有记录。我在名为 PO_Num 的子窗体中也有一个控件。我的问题是，如何获取 txtPO_num 中的主表单字段值以仅在子表单中显示的记录中填充 PO_Num 控件？

如果有另一种方法可以做到这一点，我也会有兴趣知道这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T22:34:56.303

执行`UPDATE`针对子表单中包含的相同记录的语句。

您有一个`SELECT`带有子句的查询，该`WHERE`子句标识子表单记录集中包含的记录。`UPDATE`使用相同的子句构建语句`WHERE`。例如，如果`SELECT`是...

```
SELECT field1, field2
FROM YourTable
WHERE field2 = 'foo'; 
```

...`UPDATE`可能是...

```
UPDATE YourTable
SET field1 = 'new value'
WHERE field2 = 'foo'; 
```

`UPDATE`使用 DAO 数据库对象的`.Execute`方法执行语句。

# java - DataOutputStream 在内部保存整个缓冲区？

> ID：13445106
> 
> 赞同：0
> 
> 时间：2012-11-18T22:04:32.717
> 
> 标签：java, stream, applet

在下面的代码中。我正在将文件读入一个小缓冲区（len=CHUNK_SIZE），我只是想将此缓冲区写入输出流。但是即使我在每个块之后都刷新，我也会得到一个堆溢出异常。好吧，如果我想流式传输小文件，一切都很好。但是不应该刷新也删除流中的所有数据吗？

```
URL url = new URL(built);
HttpURLConnection con = (HttpURLConnection)url.openConnection();
con.setDoOutput(true);
con.setDoInput(true);
con.setUseCaches(false);
//con.setChunkedStreamingMode(CHUNK_SIZE);
con.setRequestProperty("Content-Type", "multipart/form-data; boundary="
                                + Boundary);

FileInputStream is = new FileInputStream(m_FileList.get(i));
DataOutputStream os = new DataOutputStream(con.getOutputStream());

 // .....

 while((read = is.read(temp, 0, CHUNK_SIZE)) != -1) {
      bytesTotal += read;

      os.write(temp, 0, read); // heap overflow here if the file is to big
      os.flush();                             
 } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T22:16:58.487

`DataOutputStream`根本不缓冲，但`HttpURLConnection`的输出流默认缓冲所有内容，因此可以设置`Content-Length`标头。使用分块传输模式来防止这种情况。

您实际上根本不需要 DataOutputStream：只需写入连接的输出流。

也不要在循环内刷新（）。

# ios - ios - 显示消息会导致崩溃吗？

> ID：13445108
> 
> 赞同：0
> 
> 时间：2012-11-18T22:04:41.993
> 
> 标签：ios, ios5, nsurlconnection

我有这个代码：

```
[NSURLConnection sendAsynchronousRequest:urlRequest queue:queue completionHandler:^(NSURLResponse *response, NSData *data, NSError *error)
 {         
     NSHTTPURLResponse *httpResponse = (NSHTTPURLResponse *)response;

     if ( error != nil )
     {
         // Display a message to the screen.
         UIAlertView *message = [[UIAlertView alloc] initWithTitle:@"There was a server error getting your business plan. We use a remote server to backup your work." 
                    message:@"Please make sure your phone is connected to the Internet. If the problem persists, please let us know about this." 
                delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:nil];

         [message show]; 
```

但它在 NSUrlConnection 从服务器返回时执行。它在极少数情况下会造成崩溃。是否可以？这似乎是一段无害的代码。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T22:10:41.387

NSURLConnection 是否在某个奇怪的线程上返回结果？我不知道，但我怀疑 UIAlertView 仅适用于 UI 线程，因为它从 UI 开始。

```
 (dispatch_async(dispatch_get_main_queue(), ^{ 
    UIAlertView *message = [[UIAlertView alloc] initWithTitle:@"There was a server error getting your business plan. We use a remote server to backup your work." 
                message:@"Please make sure your phone is connected to the Internet. If the problem persists, please let us know about this." 
            delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:nil];

     [message show];
 });) 
```

抱歉，还没整理好，可能有错别字。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T22:16:51.650

如果它进入条件块显示错误不是因为UIAlert，那是因为NSURLConnection遇到了错误。我会将错误信息输出到控制台，以便您在遇到这些罕见情况时可以看到错误是什么，并使用 NSURLConnection 解决问题

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-19T04:16:17.810

问题是，您没有在主线程中显示 alertView 。所有与 UI 相关的代码都需要在主线程上工作。

当我在另一个线程上显示 alertView 时，我遇到了类似的崩溃。

您需要更改方法，例如：

```
[NSURLConnection sendAsynchronousRequest:urlRequest queue:queue completionHandler:^(NSURLResponse *response, NSData *data, NSError *error)
 {         
     NSHTTPURLResponse *httpResponse = (NSHTTPURLResponse *)response;

     if ( error != nil )
     {
         // Display a message to the screen.
        dispatch_async(dispatch_get_main_queue(), ^{

          UIAlertView *message = [[UIAlertView alloc] initWithTitle:@"There was a server error getting your business plan. We use a remote server to backup your work." 
                    message:@"Please make sure your phone is connected to the Internet. If the problem persists, please let us know about this." 
                delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:nil];

          [message show];
       });
     }
} 
```

**或**将其更改为：

```
 [NSURLConnection sendAsynchronousRequest:urlRequest queue:queue completionHandler:^(NSURLResponse *response, NSData *data, NSError *error)
 {         
     NSHTTPURLResponse *httpResponse = (NSHTTPURLResponse *)response;

     if ( error != nil )
     {
         // Display a message to the screen.
          UIAlertView *message = [[UIAlertView alloc] initWithTitle:@"There was a server error getting your business plan. We use a remote server to backup your work." 
                    message:@"Please make sure your phone is connected to the Internet. If the problem persists, please let us know about this." 
                delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:nil];
         [message performSelectorOnMainThread:@selector(show) withObject:nil waitUntillDone:NO];

     }
} 
```

# impactjs - ImpactJS 碰撞

> ID：13445109
> 
> 赞同：2
> 
> 时间：2012-11-18T22:04:51.587
> 
> 标签：impactjs

我有几个关于使用“正确”进行图层碰撞的问题。

*   是否可以使用可用的碰撞图块从 A 点制作机器人？对于每张地图，我想制作一个从 A 点到 B 点的机器人。但是为了轻松添加关卡，我想整合我的起点和终点。

*   机器人/播放器是否可以将一块瓷砖与另一块瓷砖区分开来？例如，允许用户可以放置他的角色，但不能放置机器人。

*   我想确定机器人的方向。在带有碰撞系统的机器人的四种运动（上、下、左、右）中，我不知道是否有可能知道当其他 3 个被阻止时唯一可能的方法，除了一只手测试解决方案，但在这种情况下，我们看到字符测试每个解决方案（即切换位置）。有没有办法在机器人做正确的解决方案之前模拟最糟糕的旅行？

预先感谢您的回答

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-24T07:01:23.217

我认为您正在寻找寻路，也许您可​​以尝试[为 Impactjs 进行 Astar 寻路](https://gist.github.com/Hareesun/1058682)

没有时间自己尝试，但我认为它的工作原理

# c# - 在 WP7 隔离存储中存储堆栈

> ID：13445111
> 
> 赞同：0
> 
> 时间：2012-11-18T22:05:02.230
> 
> 标签：c#, windows-phone-7, isolatedstorage

在 WP7 开发中存储 Stack 类型对象的最简单方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T22:45:29.430

你能不能把它序列化成一个独立的文件，即：

```
public static class IsolatedSerializer
{
    public static void Save<T>(string filename, T t)
    {
        XmlSerializer xmlSerializer = new XmlSerializer(t.GetType());
        using (var store = IsolatedStorageFile.GetUserStoreForApplication())
        using (var stream = store.CreateFile(filename))
        {
            xmlSerializer.Serialize(stream, t);
        }
    }

    public static T Load<T>(string filename)
    {
        XmlSerializer xmlSerializer = new XmlSerializer(typeof(T));
        using (var store = IsolatedStorageFile.GetUserStoreForApplication())
        using (var stream = store.CreateFile(filename))
        {
            return (T)xmlSerializer.Deserialize(stream);
        }
    }   
} 
```

或者由于某种原因这在 WP7 上不起作用？

*   我假设您不会序列化实际`event`- 这非常棘手，并且不适用于 xml 序列化程序。

# gnuplot - 绘图中的自定义 y 比例

> ID：13445112
> 
> 赞同：1
> 
> 时间：2012-11-18T22:05:21.300
> 
> 标签：gnuplot

我有一个数据文件，看起来像

```
550 1.436e+00 7.857e-01 5.906e-01 4.994e-01 4.574e-01 4.368e-01 4.260e-01 4.273e-01 4.296e-01 4.406e-01 4.507e-01 4.639e-01 4.821e-01 5.008e-01 5.156e-01 5.378e-01 5.589e-01 5.768e-01 5.970e-01 6.196e-01 6.422e-01 6.642e-01 
```

第一列是x轴，其余是y轴，总共22条曲线。

我想绘制数据，以便 y tic 表示值的立方根。实际上，我希望我的三次曲线变成线性的，以显示它们在法线坐标中是三次的（并且使用这些坐标由我的任务固定）。

我尝试使用以下命令：

```
plot for [i=2:23] datafile using 1:(i ** .333) smooth cspline 
```

它期望列号代替 i。我知道，以下是正确的：

```
plot datafile using 1:($2 ** .333) smooth cspline 
```

为我的第一行提供所需的情节。但是我该如何修改`plot for`呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T22:11:55.490

如果你想用列号代替`i`，你应该`column(i)`在使用规范中使用。

```
plot for [i=2:23] datafile using 1:(column(i) ** .333) smooth cspline 
```

# knockout.js - 升级到 knockoutjs 2.2 破坏了映射插件

> ID：13445114
> 
> 赞同：1
> 
> 时间：2012-11-18T22:05:30.373
> 
> 标签：knockout.js, knockout-mapping-plugin

我的页面中有这个淘汰赛代码：

```
 $.get('@Url.DataAction("Parameters", "Service")', { Id: newRun }, function (result) {
             self.MappedParameters(ko.mapping.fromJS(result));
  }); 
```

其中 self.MappedParameters 是一个淘汰的 observableArray。

这在淘汰赛 2.1 中工作正常，但在 2.2 中停止工作（映射插件 2.3.2 和 2.3.3 已尝试），没有错误只是没有绑定。

这是一个错误还是我用错了？在淘汰赛网站上找不到任何发行说明。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T15:25:44.650

使用这种语法，它又开始工作了：

```
 $.get('@Url.DataAction("Parameters", "Service")', { Id: newRun }, function (result) {
         ko.mapping.fromJS(result, {}, self.MappedParameters);
  }); 
```

在（我的）理论中是相同的..

显然，问题中的那个适用于 2.1 而不是 2.2，而这个适用于 2.2 和 2.1。

# php - 从数据库中选择图片

> ID：13445116
> 
> 赞同：0
> 
> 时间：2012-11-18T22:05:33.650
> 
> 标签：php, html, database, image, select

好的，伙计们，我需要一些帮助。我正在尝试设计一个页面，用户可以在其中提出问题并上传最多 4 张图片。我有 2 个数据库表、问题和 image_table。我已经正确上传了所有内容，所以这不是我的问题。我遇到的麻烦是从 image_table 数据库中选择仅对应于该问题的图像。我不知道该怎么做。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T22:16:36.390

您需要`question_id`在您的列中`image_table`包含图像所属问题的 ID。具有引用另一个表的列的表的概念称为**外键**。

您可以`image_table`使用以下 SQL 命令添加现有的外键：

```
ALTER TABLE image_table
ADD question_id integer DEFAULT NULL; 
```

添加*外键约束*：

```
ALTER TABLE image_table
ADD CONSTRAINT image_question_fk 
    FOREIGN KEY (question_id) 
    REFERENCES questions(question_id); 
```

然后适当地填写（使用 phpMyAdmin 之类的工具，假设您使用 MySQL）所有`question_id`字段`image_table`。

然后您可以按问题查询图像。假设您想获取问题 #5 的图像。那么查询将是：

```
SELECT image_table.*
FROM image_table, questions
WHERE image_table.question_id = question.question_id
    AND questions.question_id = 5; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T22:24:30.983

您的表格图像中有一个 FOREIGN KEY，它引用了您的表格问题的 PRIMARY KEY。它被称为关系...

拥有它真的很好，您可以添加一个删除级联，每次删除一个问题时，相应的图像都会被删除。

外键示例

```
CREATE TABLE questions (
questionid INT AUTO_INCREMENT,
question TEXT,
PRIMARY(questionid)
)

CREATE TABLE images (
imagesid INT AUTO_INCREMENT,
questionid INT NOT NULL,
path VARCHAR(255),
PRIMARY KEY (imageid),
FOREIGN KEY (questionid) REFERENCES questions(questionid)
) 
```

可以使用 GROUP_CONCAT 将所有图像路径放入结果集中的数组中。所以查询将只产生 1 行。

```
SELECT *, GROUP_CONAT(i.path) AS images
FROM questions q
INNER JOIN images i ON i.questionid = q.questionid
WHERE q.questionid = $xy
GROUP BY q.questionid 
```

- - - 编辑 - -

你描述的过程看起来像这样：

1.  用户提交上传表单
2.  你用 php 捕获表单数据
3.  你上传图片和东西
4.  您将问题和图像插入数据库 <-- $xy = mysql_insert_id() to var
5.  您使用上述查询选择图像
6.  回显结果

- 编辑 -

好的，您的图片上传表单与问题分开。不需要 sql 选择...您知道将要上传的路径，并且您知道要上传的图像的名称

```
//uploading the image
if(!isset($_SESSION['questionImages'])) {
$_SESSION['questionImages'] = array();
}

$_SESSION['questionImages'][] = $dir.'/'.$_FILE['name']; 
```

稍后当您想要回显图像时，只需使用 $_SESSION['questionImages'] 数组

如果用户提交了您必须重置会话变量 questionImages 的问题

# iphone - 向核心数据添加新实体并填充一些值

> ID：13445119
> 
> 赞同：0
> 
> 时间：2012-11-18T22:06:11.463
> 
> 标签：iphone, ios, cocoa-touch, core-data, migration

我正在下一个版本的应用程序中更新我的核心数据模型。我按照[此处](https://stackoverflow.com/questions/1830079/iphone-core-data-automatic-lightweight-migration)的说明为“部门”添加了一个新实体。

我想为新用户和更新到最新版本的用户添加一些示例部门。到目前为止，我的方法是在 'HasLaunchedOnce' 中存储一个布尔值`[NSUserDefaults standardDefaults]`，如果缺少它会添加一些参考数据并将其自身设置为 YES 以供下次启动。

我应该添加一个类似的标志（hasLaunchedV1.1Once）来添加我的部门吗？我还可以采取哪些其他方法？我的目标是让未来的版本尽可能简单。我宁愿简单地检查是否存在任何部门，但是如果用户手动删除了所有部门，这当然会触发。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T09:31:17.110

你的方法原则上是有效的。

只要考虑到`NSManagedObjectModel`该类有一个实例方法`versionIdentifiers`。您也可以使用它来找出最新版本是什么。

# asp.net - asp .net查询字符串编码和解码

> ID：13445121
> 
> 赞同：7
> 
> 时间：2012-11-18T22:06:37.353
> 
> 标签：asp.net, query-string, url-encoding, urldecode

我在我的网络浏览器中输入以下网址，然后按 Enter。

```
http://localhost/website.aspx?paymentID=6++7d6CZRKY%3D&language=English 
```

现在在我的代码中，当我执行 HttpContext.Current.Request.QueryString["paymentID"] 时，

我得到 6 7d6CZRKY=

但是当我做 HttpContext.Current.Request.QueryString.ToString() 我看到以下内容：

支付ID=6++7d6CZRKY%3D&语言=英文

我想提取用户在 Web 浏览器 URL 中输入的实际付款 ID。我不担心 url 是否被编码。因为我知道这里 %3D 和 + 符号同时发生了一件奇怪的事情！但我确实需要实际的 + 号。当我执行 HttpContext.Current.Request.QueryString [“paymentID”] 时，它以某种方式被解码到空间。

我只想提取用户输入的实际付款 ID。最好的方法是什么？

谢谢你。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-18T23:40:16.593

您需要先使用 URLEncode() 对 URL 进行编码。**URL 中的+**等于空格，因此需要编码为 %2b。

```
string paymentId = Server.UrlEncode("6++7d6CZRKY=");
// paymentId = 6%2b%2b7d6CZRKY%3d 
```

现在

```
string result = Request.QueryString["paymentId"].ToString();
//result = 6++7d6CZRKY= 
```

然而

```
string paymentId = Server.UrlEncode("6  7d6CZRKY=");
//paymentId looks like you want it, but the + is a space -- 6++7d6CZRKY%3d

string result = Request.QueryString["paymentId"].ToString();
//result = 6 7d6CZRKY= 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-18T22:41:15.077

这里有一些关于此的信息：[加号登录查询字符串](https://stackoverflow.com/questions/6855624/plus-sign-in-query-string)。

但我想您也可以使用正则表达式从查询字符串中获取参数。像这样的东西：

```
string queryString = HttpContext.Current.Request.QueryString.ToString();
string paramPaymentID = Regex.Match(queryString, "paymentID=([^&]+)").Groups[1].Value; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-08-31T12:22:07.677

我在查询字符串中发送了一个阿拉伯语文本

[![我的查询字符串中的阿拉伯语文本](../Images/c2a166a8301cc12ffa2fb03a7437cd10.png)](https://i.stack.imgur.com/ZADJu.png)

当我重新筛选这个字符串时，它被编码了 [![在此处输入图像描述](../Images/90320b21aa81c198ef900e9ac65aae1b.png)](https://i.stack.imgur.com/hviD5.png)

后`Server.UrlDecode`

```
 departmentName = Server.UrlDecode(departmentName); 
```

它又回到了阿拉伯语 [![在此处输入图像描述](../Images/819ab49eb2dc9d1652b857be7b8a6009.png)](https://i.stack.imgur.com/J7zk1.png)

我希望这对你有帮助

# python - Python 代码有效，但 Hadoop Streaming 产生 part-00000 “空文件”

> ID：13445126
> 
> 赞同：4
> 
> 时间：2012-11-18T22:07:57.420
> 
> 标签：python, hadoop, mapreduce, hadoop-streaming

[在一个 Ubuntu 虚拟机上，我按照 Michael Noll 的教程](http://www.michael-noll.com/tutorials/writing-an-hadoop-mapreduce-program-in-python/#test-your-code-cat-data-map-sort-reduce)设置了一个单节点集群，这是我编写 Hadoop 程序的起点。

另外，作为参考，[this](http://www.cs.brandeis.edu/~rshaull/cs147a-fall-2008/hadoop-example/) .

我的程序是 Python 并使用 Hadoop Streaming。

我编写了一个简单的向量乘法程序，其中`mapper.py`接受输入文件`v1`和`v2`，每个文件都包含表单中的向量`12,33,10`并返回乘积。然后`reducer.py`返回产品的总和，即：

**映射器**：`map(mult,v1,v2)`

**减速机**：`sum(p1,p2,p3,...,pn)`

**映射器.py：**

```
import sys

def mult(x,y):      
    return int(x)*int(y)

# Input comes from STDIN (standard input).

inputvec = tuple()

for i in sys.stdin:
    i = i.strip()

    inputvec += (tuple(i.split(",")),)

v1 = inputvec[0]
v2 = inputvec[1]

results = map(mult, v1, v2)

# Simply printing the results variable would print the tuple. This
# would be fine except that the STDIN of reduce.py takes all the 
# output as input, including brackets, which can be problematic

# Cleaning the output ready to be input for the Reduce step:

for o in results:
    print ' %s' % o, 
```

**减速器.py：**

```
import sys

result = int()

for a in sys.stdin:

    a = a.strip()
    a = a.split()

for r in range(len(a)):
    result += int(a[r])

print result 
```

在`in`子目录中，我有`v1`contains`5,12,20`和`v2`contains `14,11,3`。

在本地测试，事情按预期工作：

```
hduser@ubuntu:~/VectMult$ cat in/* | python ./mapper.py
 70  132  60

hduser@ubuntu:~/VectMult$ cat in/* | python ./mapper.py | sort
 70  132  60

hduser@ubuntu:~/VectMult$ cat in/* | python ./mapper.py | sort | python ./reducer.py
262 
```

当我在 Hadoop 中运行它时，它似乎成功了，并且没有抛出任何异常：

```
hduser@ubuntu:/usr/local/hadoop$ bin/hadoop jar contrib/streaming/hadoop-*streaming*.jar -mapper python /home/hduser/VectMult3/mapper.py -reducer python /home/hduser/VectMult3/reducer.py -input /home/hduser/VectMult3/in -output /home/hduser/VectMult3/out4
Warning: $HADOOP_HOME is deprecated.

packageJobJar: [/app/hadoop/tmp/hadoop-unjar2168776605822419867/] [] /tmp/streamjob6920304075078514767.jar tmpDir=null
12/11/18 21:20:09 INFO util.NativeCodeLoader: Loaded the native-hadoop library
12/11/18 21:20:09 WARN snappy.LoadSnappy: Snappy native library not loaded
12/11/18 21:20:09 INFO mapred.FileInputFormat: Total input paths to process : 2
12/11/18 21:20:09 INFO streaming.StreamJob: getLocalDirs(): [/app/hadoop/tmp/mapred/local]
12/11/18 21:20:09 INFO streaming.StreamJob: Running job: job_201211181903_0009
12/11/18 21:20:09 INFO streaming.StreamJob: To kill this job, run:
12/11/18 21:20:09 INFO streaming.StreamJob: /usr/local/hadoop/libexec/../bin/hadoop job  -Dmapred.job.tracker=localhost:54311 -kill job_201211181903_0009
12/11/18 21:20:09 INFO streaming.StreamJob: Tracking URL: http://localhost:50030/jobdetails.jsp?jobid=job_201211181903_0009
12/11/18 21:20:10 INFO streaming.StreamJob:  map 0%  reduce 0%
12/11/18 21:20:24 INFO streaming.StreamJob:  map 67%  reduce 0%
12/11/18 21:20:33 INFO streaming.StreamJob:  map 100%  reduce 0%
12/11/18 21:20:36 INFO streaming.StreamJob:  map 100%  reduce 22%
12/11/18 21:20:45 INFO streaming.StreamJob:  map 100%  reduce 100%
12/11/18 21:20:51 INFO streaming.StreamJob: Job complete: job_201211181903_0009
12/11/18 21:20:51 INFO streaming.StreamJob: Output: /home/hduser/VectMult3/out4

hduser@ubuntu:/usr/local/hadoop$ bin/hadoop dfs -cat /home/hduser/VectMult3/out4/part-00000
Warning: $HADOOP_HOME is deprecated.

hduser@ubuntu:/usr/local/hadoop$ bin/hadoop dfs -ls /home/hduser/VectMult3/out4/
Warning: $HADOOP_HOME is deprecated.

Found 3 items
-rw-r--r--   1 hduser supergroup          0 2012-11-18 22:05 /home/hduser/VectMult3/out4/_SUCCESS
drwxr-xr-x   - hduser supergroup          0 2012-11-18 22:05 /home/hduser/VectMult3/out4/_logs
-rw-r--r--   1 hduser supergroup          0 2012-11-18 22:05 /home/hduser/VectMult3/out4/part-00000 
```

但是当我检查输出时，我发现的只是一个 0 字节的空文件。

我无法弄清楚出了什么问题。任何人都可以帮忙吗？

* * *

编辑：回复@DiJuMx

*解决此问题的一种方法是从 map 输出到临时文件，然后在 reduce 中使用临时文件。*

不确定 Hadoop 是否允许这样做？希望有更了解的人可以纠正我。

*在尝试此操作之前，请尝试编写一个更简单的版本，该版本只是直接传递数据而不进行处理。*

我认为这是一个好主意，只是为了检查数据是否正确流过。我为此使用了以下内容：

**mapper.py 和 reducer.py 都**
导入 sys

```
for i in sys.stdin:
    print i, 
```

出来的应该就是进去的。仍然输出一个空文件。

*或者，如果输入为空白，则在 reduce 中编辑现有代码以将（错误）消息输出到输出文件*

**映射器.py**

```
import sys

for i in sys.stdin:
    print "mapped",

print "mapper", 
```

**减速器.py**

```
import sys

for i in sys.stdin:
    print "reduced",

print "reducer", 
```

如果收到输入，它应该最终输出`reduced`。无论哪种方式，它至少应该输出`reducer`. 实际输出仍然是一个空文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T16:00:35.140

我没有任何使用hadoop（或python）的经验，但是，我注意到你正在指定输出去，`/home/hduser/VectMult3/out4`但期望它在`/home/hduser/VectMult3/out/part-00000`.

您是否检查过该`out4`文件是否存在以及它的内容是什么？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-22T15:04:44.600

您是否尝试过替换`python mapper.py`为`"python mapper.py"`？我想映射器运行`python`而不是`python mapper.py`. 它可以解释你的空输出。此外，您的文件 mapper.py 不应位于 HDFS 上，而应位于本地某处。然后，使用命令行中的选项将其发送到作业 jar 文件 ( [doc](http://wiki.apache.org/hadoop/HadoopStreaming) ) ：`-file <path_to_local_file>`

```
/bin/hadoop jar contrib/streaming/hadoop-*streaming*.jar -mapper "python mapper.py" -file <path_to_your_local_mapper.py> -reducer "python reducer.py" -file <path_to_your_local_reducer.py> -input /home/hduser/VectMult3/in -output <output_dir_name> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-03T15:09:09.290

我知道这个问题已经很老了，但我仍然想帮忙。我看到在您的 reducer.py 和 mapper.py 示例中，您只是输出一个值。我相信（我刚开始使用 Hadoop，但到目前为止这是我的经验）它需要一个由选项卡分隔的键值对。

例如，您的映射器的输出可能与此类似：
`print "%s\t%s" % (str(random.randint(0,100000)), "mapped")`

我不确定，但减速器可能可以输出任何东西。如果这仍然不起作用，请按照此博客[http://www.michael-noll.com/tutorials/writing-an-hadoop-mapreduce-program-in-python/](http://www.michael-noll.com/tutorials/writing-an-hadoop-mapreduce-program-in-python/)上的说明创建一个测试用例我的环境，所以希望它会为你做同样的事情。如果此示例不起作用，则很可能是您的 Hadoop 设置存在问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-25T14:08:29.623

遇到过与此类似的问题，并发现确保以下行位于我的 Python 脚本的顶部已修复它：

`#!/usr/bin/python`

也许试一试，看看它是否有帮助？

ps 此外，仅查看我们的 Python 映射器和化简器，我们在行尾使用没有注释的 print 语句。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-20T22:52:49.653

假设您的代码完全正确（如您的问题的第一部分所示，我将假设如此），问题可以缩小到您正在工作的环境。在这种情况下，我会说这是因为输出来自映射器的不是通过管道传输到减速器（就像您手动运行命令时一样）

解决此问题的一种方法是从 map 输出到临时文件，然后在 reduce 中使用临时文件。

在尝试此操作之前，请尝试编写一个更简单的版本，该版本只是直接传递数据而不进行处理。如果您仍然没有任何结果，请尝试临时文件。

或者，如果输入为空白，则在 reduce 中编辑现有代码以将（错误）消息输出到输出文件

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-07-11T02:04:53.267

我有同样的问题。mapper.py和**reducer.py工作****正常**，但 Hadoop 流返回空文件，没有任何错误！

 **我通过使用 Hadoop Streaming 代码解决了这个问题，如下所示：（*注意我用于 -mapper 和 -reducer 的格式！）*

`hadoop jar /usr/lib/hadoop-0.20-mapreduce/contrib/streaming/hadoop-*streaming*.jar -file /home/training/Desktop/mapper.py -mapper 'python mapper.py' -file /home/training/Desktop/reducer.py -reducer 'python reducer.py' -input /user/training/sales.csv -output /user/training/output18`

我希望这对其他有同样问题的人有所帮助。**

# c# - 如何在 asp.net 中添加 onclick 处理程序

> ID：13445127
> 
> 赞同：0
> 
> 时间：2012-11-18T22:07:58.793
> 
> 标签：c#, javascript, asp.net

我在我的 asp.net 应用程序中使用[广告库代码。](http://coffeescripter.com/code/ad-gallery/#ad-image-0)我把它改成了通用的，因为我想从我的数据库中下载图片。这意味着所有的实现都在后面的代码中（这是我的一段 C# 代码）：

```
ul.Attributes.Add("class", "ad-thumb-list");
            tabs.Controls.Add(ul);
            int i = 1;
                foreach (Products item in _PicturesPage)
                {
                    ul.Controls.Add(li);
                    anchor.Attributes.Add("href", item.ImagePath);
                    image.Attributes.Add("src", "../Images/pictures/thumbs/"+i+".jpg");
                    image.Attributes.Add("title","A title for 12.jpg");
                    image.Attributes.Add("alt", "This is a nice, and incredibly descriptive, description of the image");
                    image.Attributes.Add("class","image3");
                    li.Controls.Add(anchor);
                    anchor.Controls.Add(image);
                    i++;
                } 
```

我想知道是否可以拦截其中一个超链接（）中的点击？谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T23:49:57.363

只需添加一个 JavaScript 事件处理程序：

```
anchor.Attributes.Add("onclick", "YourJavaScriptFunction();"); 
```

如果您想`false`阻止导航到链接的`href`.

如果`anchor`是`HtmlAnchor`您可以使用的实例：

```
anchor.ServerClick += (sender, args) =>
    {
        // do stuff
    }; 
```

# javascript - 使用 jquery 移动导航栏链接提交表单

> ID：13445129
> 
> 赞同：0
> 
> 时间：2012-11-18T22:08:09.277
> 
> 标签：javascript, jquery-mobile

我在一个页面上有两个表单，我想使用来自查询移动导航栏的相应链接单独提交表单。表单提交正常，但页面的内容部分变为空白（我相信 jquery mobile ajax 正在尝试转换到未指定的页面）。有没有办法阻止它尝试转换并提交表单数据？

HTML：

```
<div class="ui-grid-a">
            <div class="ui-block-a">
            <form name="adminform" id="adminform">
                  <legend>Administrator</legend>

                  <input type="text" name="user_id" id="user_id" value="<?php echo $user_data['user_id'];?>" />

                  <label for="first_name">First name*:</label>
                  <input type="text" name="first_name" id="first_name" value="<?php echo $user_data['first_name'];?>" placeholder="First name" />

                  <label for="last_name">Last Name*:</label>
                  <input type="text" name="last_name" id="last_name" value="<?php echo $user_data['last_name'];?>" placeholder="Last Name" />

                  <label for="email">E-Mail*:</label>
                  <input type="email" name="email" id="email" value="<?php echo $user_data['email'];?>" placeholder="E-Mail" />

            </form>

            </div><!--end block a-->
            <div class="ui-block-b">
              <form name="companyform" id="companyform" action="" method="post">

                  <legend>Billing Address</legend>

                  <!--<label for="companyid">Company Id:</label>-->
                  <input type="hidden" name="companyid" id="companyid" value="<?php echo $company_data['company_id'];?>" />

                  <label for="company_name">Company Name*:</label>
                  <input type="text" name="company_name" id="company_name" value="<?php echo $company_data['company_name'];?>" />

                  <label for="company_website">Website:</label>
                  <input type="text" name="company_website" id="company_website" value="<?php echo $company_data['company_website'];?>" />

                  <label for="company_address">Address*:</label>
                  <input type="text" name="company_address" id="company_address" value="<?php echo $company_data['company_address'];?>" />

                  <label for="company_suite">Suite:</label>
                  <input type="text" name="company_suite" id="company_suite" value="<?php echo $company_data['company_suite'];?>" />

                  <label for="company_city">City*:</label>
                  <input type="text" name="company_city" id="company_city" value="<?php echo $company_data['company_city'];?>" />

                  <label for="company_state">State*:</label>
                  <input type="text" name="company_state" id="company_state" value="<?php echo $company_data['company_state'];?>" />

                  <label for="company_postal_code">Postal Code*:</label>
                  <input type="text" name="company_postal_code" id="company_postal_code" value="<?php echo $company_data['company_postal_code'];?>" />

                  <label for="company_telephone">Telephone*:</label>
                  <input type="text" name="company_telephone" id="company_telephone" value="<?php echo $company_data['company_telephone'];?>" />

                  <label for="company_fax">Fax:</label>
                  <input type="text" name="company_fax" id="company_fax" value="<?php echo $company_data['company_fax'];?>" />

              </form>

              <div id="companyupdatestatus"></div>
            </div><!--end block b-->  
        </div><!--end grid a-->

        <div data-role="navbar">
            <ul>
                <li><a id="updateadmin" data-icon="check" data-ajax="false">Update Admin</a></li>
                <li><a id="updatecompany" data-icon="check" data-ajax="false">Update Company Info</a></li>
                <li><a href="passwordchangeform.php" data-role="button" data-icon="check" data-transition="pop" data-rel="dialog">Change Password</a></li>
            </ul>
        </div>        

       </div> 
```

Javascript：

```
$('#updatecompany').click(function() {
var company = $('#companyform').serializeArray();
/*$('#companyupdatestatus').html(company);*/

$.ajax({
type: "POST",
url: 'companyupdate.php',
data: company,
success: function(company) {
    $('#companyupdatestatus').html(company);
}   

}); 
}); 
```

在此先感谢，非常感谢您的帮助！！！亚当

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T22:11:42.527

试试`return false`这样：

```
 $('#updatecompany').click(function() {
       var company = $('#companyform').serializeArray();
       /*$('#companyupdatestatus').html(company);*/

    $.ajax({
    type: "POST",
    url: 'companyupdate.php',
    data: company,
    success: function(company) {
        $('#companyupdatestatus').html(company);
    }   

    }); 

         return false;
    }); 
```

# facebook - 脸书私人讯息

> ID：13445131
> 
> 赞同：1
> 
> 时间：2012-11-18T22:08:22.987
> 
> 标签：facebook

1.  据说，仅通过 API 发起新的对话是不可能的，除非使用 Facebook 自己的应用程序中集成的 Form。这是正确的，还是有一些新的 API 可以让我发起新的对话？

2.  为了回复现有对话，我使用以下 FQL 查询“SELECT thread_id, . WHERE viewer_id={0} AND folder_id=0”检索了对话 ID。之后，我使用我的用户访问令牌检索了我的应用程序页面的 PageAccessToken，并尝试使用此调用：*您可以通过使用以下参数向 /CONVERSATION_ID/messages 发出 HTTP POST 来回复用户的消息 [conversation id, message] . 对话 ID 看起来像 t_id.216477638451347。* 我的 POST 调用看起来像这样（这不是有效的线程 ID）：/t_id.2319203912/messages 填充了消息参数。但它总是说“未知方法”。你能帮我解决这个问题吗？是否缺少参数？我传入了页面的访问令牌来调用这个。

是否有一些我缺少的 API（Facebook 的聊天 API 除外）可以向用户发送私人消息？

编辑：

我想知道的是，下面的代码只返回一个页面，即应用程序的页面。这是正确的，还是需要另一个页面令牌？这是返回页面最让我烦恼的地方。

FacebookClient 使用我的 UserToken 来执行下一个任务。这是检索我的页面访问令牌的代码：

```
dynamic pageService =  FacebookContext.FacebookClient.GetTaskAsync("/"+UserId+"/accounts").Result;
dynamic pageResult = pageService.data[0];
_pageId = pageResult["id"].ToString();
return pageResult["access_token"].ToString(); 
```

现在检索我的 ConversationÍd 的代码：

```
dynamic parameters = new ExpandoObject();
parameters.q = string.Format("SELECT thread_id, folder_id, subject, recipients,     updated_time, parent_message_id, parent_thread_id, message_count, snippet, snippet_author,     object_id, unread, viewer_id FROM thread WHERE viewer_id={0} AND folder_id=0",     FacebookContext.UserId);
dynamic conversations =     FacebookContext.FacebookClient.GetTaskAsync("/fql",parameters).Result; 
```

下面的代码是使用从上面的代码中检索到的访问令牌（页面访问令牌请求）执行的。现在用于发送回复的代码：

```
dynamic parameters = new ExpandoObject();
parameters.message = CurrentAnswer;
string taskString = "/t_id." + _conversationId + "/messages";
dynamic result =    FacebookContext.FacebookClient.PostTaskAsync(taskString,parameters).Result;
return true; 
```

我还使用我的第一部分代码返回的令牌尝试了 facebook 的图形 API 调试器。但同样的错误信息。

# objective-c - 简单的除法没有发生

> ID：13445132
> 
> 赞同：1
> 
> 时间：2012-11-18T22:08:39.837
> 
> 标签：objective-c, ios

我正在尝试使用以下被调用的方法来计算 UITableViewCell 和 UIImageView 的适当高度：

```
-(void)ratioCalculator
{
picH = image.size.height;
picW = image.size.width;

NSLog(@"%d = width %d = height", picW, picH);
picRatio = (picW/picH);
NSLog(@"%F", picRatio);
imageViewH = (260/picRatio);
NSLog(@"%d int", imageViewH);

return;
} 
```

问题是，当它被调用时，`picRatio = (picW/picH);`似乎并没有像控制台所说的那样发生：

```
2012-11-18 21:56:48.787 Name[5374:c07] 640 = width 360 = height
2012-11-18 21:56:48.788 Name[5374:c07] 1.000000
2012-11-18 21:56:48.788 Name[5374:c07] 260 int 
```

1.000000 是浮点数`picRatio`，260 是`imageViewH`. 显然，这意味着 UITableViewCell 和 UIImageView 都使用了不正确的高度，计算如下：

```
else {
        [self ratioCalculator];
        return (imageViewH + 20);
     } 
```

和

```
- (void)showImage:(UIImage *)theImage
{
    self.imageView.image = theImage;
    self.imageView.hidden = NO;
    [self ratioCalculator];
    self.imageView.frame = CGRectMake(10, 10, 260, imageViewH);
    self.photoLabel.hidden = YES;
} 
```

这可能是一个愚蠢的问题，为什么这个简单的除法不起作用？再次，对不起，如果这是一个愚蠢的问题，但它让我难住了。我觉得我快要疯了。

任何帮助将不胜感激，
问候，
迈克

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T22:42:23.083

```
picRatio = ((float)picW/(float)picH); 
```

Objective-c 在划分之前需要正确的 iVar 类型分配。当您将 2 个整数相除时，输出不是浮点数，而是整数。

所以 640/360 = 1.777 这被视为一个整数，所以十进制值被忽略，这给你 1，你得到。

如果你按照我写的去做，实际上会产生一个浮点数，并给你 1.777 的输出。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-18T22:45:03.843

您缺少的是将整数转换为浮点数以进行浮点除法

```
picRatio = (picW/picH); // gives an int division if picW and picH are declared integers

picRatio = (float)(picW)/picH; // gives you a floating point division 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-18T22:44:57.250

由于没有人发布官方答案，我想我会这样做以帮助处于类似位置的任何人。对我的问题的评论使我走上了正轨，经过进一步调查，我发现编译器根据操作数的类型计算输出。因此，如果所有操作数都是整数，它会将一个整数转换为目标，无论它是否为浮点数。解决方案：至少将您的一个操作数设为浮点数。

希望这可以帮助任何处于类似位置的人。

# javascript - 停止将鼠标单击事件传播到父 div

> ID：13445137
> 
> 赞同：1
> 
> 时间：2012-11-18T22:09:33.183
> 
> 标签：javascript, jquery

我有一个 HTML 结构，如：

```
<div class="container">
    <div id="bg">   
        <img src="#"/>
        <div id="screen">
         <img src="#" id="draggable"/>
        </div>
    </div>   

</div> 
```

“bg” div 位于“screen” div 上方（使用 z-index 属性），当我单击“bg” div 时，我想将图像拖到屏幕 div 中。

我可以这样做，但问题是我收到错误：`Uncaught RangeError: Maximum call stack size exceeded`。

我相信这是由于来自“bg”的点击事件，我使用触发器传递到“屏幕”。如何阻止我传递给“屏幕”的事件在“bg”上再次触发。

为了清楚起见，这是我的代码的 JSFiddle：[单击此处](http://jsfiddle.net/LPK4E/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T23:45:15.413

我相信你已经解决了你的问题，因为你的 jsFiddle 现在正在工作，所以我将为其他人解释，所以我们可以将此问题标记为已解决。
只需将您`div#screen`移出`div#bg`以防止事件冒泡的递归。

注意：为防止混淆，您不应在发布链接后更新链接的内容。

# vb.net - 一旦我的 Kinect 应用程序开始发送串行数据，用户界面就会在 Visual Basic 中冻结

> ID：13445140
> 
> 赞同：0
> 
> 时间：2012-11-18T22:09:44.637
> 
> 标签：vb.net, arduino, kinect

我用 Visual Basic 编写了这个程序来控制一个小型机器人。程序本身基本上只是将我手的 X 和 Y 坐标发送到控制机器人的 Arduino 微处理器。

出于某种原因，当波特率设置为 115200（我正在使用的 arduino 蓝牙板要求）时，应用程序一开始发送串行数据就会冻结。然而，当我将它设置为 9200 并使用我的 arduino diecimilia 时，应用程序并没有冻结。

我需要波特率为 115200，因为我想使用我的 arduino 蓝牙与我的机器人进行无线通信。关于如何阻止它冻结的任何想法？

向 Arduino 发送数据的代码

```
Private Sub ArduinoSetSerial()
     Dim ArduinoCom As String = ComPort.text
     _serialPort = New SerialPort()
     _serialPort.PortName = "COM" + Trim(ComPort.Text) 'Gets the ComPort from the Text box in the GUI of the App
     _serialPort.BaudRate = 9200 'When using any other Arduino PLC, this should be set to 9600\. In this case, it is set to 115200 as the specififc Arduino PLC we are using requires it.
     _serialPort.DataBits = 8
     _serialPort.Handshake = 0
     _serialPort.ReadTimeout = 500
     _serialPort.WriteTimeout = 500

End Sub

Private Sub ArduinoOpenSerial()
     If Not _serialPort.IsOpen Then 'Opens the serial port if it isn't already open.
          _serialPort.Open()
     Else
          MsgBox("ARDUINO: SERIAL PORT CANNOT BE OPENED")
     End If
     _continue = True
End Sub

Private Sub ArduinoCloseSerial() 'Defines the CloseSerial Action executed on shutdown
     If _serialPort.IsOpen Then
          _serialPort.Close()
     End If
End Sub

Private Sub ArduinoSendByte(ByVal kinect_x As Single, ByVal kinect_y As Single, ByVal kinect_z As Single, ByVal kinect_j As Integer)
     Dim x, y, z, j As Byte
     Dim sx, sy As Single
     Dim HowOften As Integer
     ComStatus.Text = "NA" 'Set ComStatus Text to NA when not sending data

     x = Math.Abs(CByte(kinect_x)) 'The X co-ordinate of the requested JointID
     y = Math.Abs(CByte(kinect_y)) 'The Y co-ordinate of the requested JointID
     z = CByte(kinect_z) 'The Z co-ordinate of the requested JointID (Not used in this particular application)
     j = CByte(kinect_j) 'JointID
     x = x
     Dim ArduinoBuffer() As Byte = {x, y, z, j}
     If _serialPort.IsOpen Then
          ComStatus.Text = "OK" 'Write OK inthe ComStatus text box in the GUI
          _serialPort.Write(ArduinoBuffer, 0, ArduinoBuffer.Length) 'Actually sends all the information to the Arduino on the specified Serial Port
     End If
End Sub 
```

# c# - 在图片框中平滑移动位图（a la google maps）

> ID：13445143
> 
> 赞同：0
> 
> 时间：2012-11-18T22:09:59.410
> 
> 标签：c#, bit-manipulation, picturebox

我在图片框中加载了一个位图。我的问题是我希望它在使用鼠标时移动顺畅。是否有一些超级重复功能可以非常快速地移动某些像素并成像？

还是每次我移动一个像素时都必须完全重新绘制图片框（不知何故使用 LockBits 方法）？

我需要它快速运行而没有闪烁。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T22:23:50.417

显然你每次移动时都必须重新绘制整个框，诀窍是你不重新计算你看到的整个区域，你保持整个（或至少一大块）图片的加载，只指定其中的一部分画。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T23:06:20.243

这里描述了一个有趣的概念，它可能满足您的需求 - 假设您的位图没有平铺，即可以一次全部加载：

[将 PictureBox 放入面板中，使用面板作为视口。](https://stackoverflow.com/a/7680598/897326)

# asp.net-mvc-3 - 命名空间“Plugin1”中不存在类型或命名空间名称“ViewModels”

> ID：13445145
> 
> 赞同：0
> 
> 时间：2012-11-18T22:10:01.860
> 
> 标签：asp.net-mvc-3, plugins, mef

我正在使用[这种方法在概念验证应用程序（ASP.NET MVC 3，使用 Razor](http://blog.maartenballiauw.be/post/2009/06/17/Revised-ASPNET-MVC-and-the-Managed-Extensibility-Framework-%28MEF%29.aspx)**和强类型视图**）中实现可插拔架构。

所以：我有一个普通的 ASP.NET MVC3 项目和一个 Classlibrary 项目（插件）。

一切都很好，但是当我使用强类型视图（在插件项目中）时，我得到了以下错误：

```
CS0234: The type or namespace name 'ViewModels' does not exist in the namespace 'Plugin1' (are you missing an assembly reference?) 
```

命名空间存在于这个程序集中，但我有轻微的感觉......不知何故它没有加载......

我想念什么？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T22:12:51.180

您需要在`Web.config`.

# c++ - Keil：虚拟或受保护的析构函数和堆

> ID：13445147
> 
> 赞同：2
> 
> 时间：2012-11-18T22:10:12.407
> 
> 标签：c++, keil, virtual-destructor

我正在将 Keil 4 与 ARM 工具集一起用于 Cortex M3（如果这很重要的话）。我尝试了这个简单的代码：

```
class Base
{
    public:
    virtual ~Base() {}
};

class Derived : public Base
{

    public:
    int b;

    virtual ~Derived() {}
}; 
```

如果我在本地（在 main 内部）创建 Derived 的实例，一切都很好：调试工作正常，程序大小约为 300 字节。

如果我创建 Derived 的静态或全局实例，程序大小会增加到 1000 字节，并且调试会话会在 BKPT 指令上停止。

我整理出这是因为堆大小设置为其默认值（零）。当我添加一些堆时，调试开始工作。

使析构函数受保护但非虚拟会导致相同的行为。使通常的方法 virtual 没有。

所以，我的问题是：为什么编译器在这种情况下需要堆？

Vtab 是静态创建的（我检查过），全局对象也应该是静态的。当我不需要动态分配时，再浪费 700 个字节用于堆分配代码（以及堆本身的空间）有点愚蠢。

（我将析构函数设为虚拟以防止出现警告。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-03T12:48:02.597

答案就在这里，在 Keil 论坛 - [http://www.keil.com/forum/21859/](http://www.keil.com/forum/21859/)上。原因是生成函数“__aeabi_atexit”，该函数在 main 返回后调用。这有点好笑，因为这种回报永远不会在嵌入式系统中发生。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-01T16:34:11.020

当实例在函数之外定义时，会发生两件事。首先，在调用 main 之前调用对象的构造函数。程序员必须小心，构造函数不会执行任何可能需要稍后进行初始化的操作。其次，实例的内存是在堆上分配的，因为在 main 之前没有本地范围。嵌入式系统程序员在实例化全局对象时必须特别小心。如果构造函数依赖于一些在 main 之前未初始化的硬件，则可能会发生不好的事情。熟悉Keil提供的C启动文件（初始化heap后调用main，拷贝flash到ram，调用全局构造函数的汇编语言模块）。

# python - 将代码从 Python 缓冲区发送到从 Mx ansi-term 运行的 IPython 会话

> ID：13445153
> 
> 赞同：3
> 
> 时间：2012-11-18T22:10:57.350
> 
> 标签：python, emacs, ipython

假设我在 Emacs 中使用`M-x ansi-term`. 这将使用我选择的 shell 在 Emacs 中打开一个缓冲区。假设我然后`ipython`从这个 shell 运行。`ipython`我可以在 Emacs 中使用 Python 代码从另一个缓冲区向该会话发送代码吗？如果有怎么办？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-19T08:08:51.567

为此，我有一个次要模式（除了它不是特定于 IPython 的，我主要将它用于 shell 脚本）：[isend-mode](https://github.com/ffevotte/isend-mode.el)。

以下是您将如何使用它：

1.  打开`ansi-term`缓冲区：

    `M-x``ansi-term``RET``/usr/bin/ipython``RET`

2.  使用要执行的代码打开缓冲区，并将其关联到解释器缓冲区：

    `M-x``isend-associate``RET``*ansi-term*``RET`

3.  在 python 缓冲区中点击`C-RET`以将当前行发送到`ansi-term`缓冲区中的解释器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-18T23:31:57.707

```
(defun send-buffer-to-ipython ()
  "Send current buffer to the running ipython process."
  (interactive)
  (let* ((ipython-buffer "*ansi-term*") ; the buffer name of your running terminal
         (proc (get-buffer-process ipython-buffer)))
    (unless proc
      (error "no process found"))
    (save-buffer)
    (process-send-string proc
                         (format "execfile(\"%s\")\n" (buffer-file-name)))
    (pop-to-buffer ipython-buffer)      ; show ipython and select it
    ;; (display-buffer ipython-buffer)  ; show ipython but don't select it
    )) 
```

然后将命令绑定`send-buffer-to-ipython`到您喜欢的任何键。我把它绑定到`C-c C-c`

```
(define-key python-mode-map [?\C-c ?\C-c] 'send-buffer-to-ipython) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-19T09:59:21.183

使用 python-mode.el

Mx 自定义变量 RET py-shell-name RET ansi-term

Mx ansi-term RET ipython RET

Cc Cc 来自 Python 缓冲区而不是在 IPython shell 中执行

警告：shebang 在默认 py-shell-name 之前

[https://launchpad.net/python-mode/trunk/6.0.12/+download/python-mode.el-6.0.12.tar.gz](https://launchpad.net/python-mode/trunk/6.0.12/+download/python-mode.el-6.0.12.tar.gz)

# c# - 如何检查表单是否打开，如果打开关闭表单？

> ID：13445155
> 
> 赞同：5
> 
> 时间：2012-11-18T22:11:09.123
> 
> 标签：c#, winforms, form-control

如何检查表单是否打开，以及是否打开以关闭表单？

我尝试了以下方法，测试了一些代码，但它一直说表单没有打开，即使我知道它是：

```
 foreach(Form a in Application.OpenForms) 
 {
     if (a is YouLikeHits_Settings) 
     {
         // About form is open
         MessageBox.Show("form open");
         break;
     }
     // About form is not open...
     MessageBox.Show("form not open");
     break;
 } 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-11-18T22:13:10.417

[Application.OpenForms](http://msdn.microsoft.com/en-us/library/system.windows.forms.application.openforms.aspx)包含打开的表单。如果表单在此集合中，则将其打开。否则它不会打开（可能是关闭的）。

```
if (Application.OpenForms.OfType<YouLikeHits_Settings>().Any())
    MessageBox.Show("Form is opened");
else
    MessageBox.Show("Form is not opened"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-06-30T06:00:19.153

这肯定会奏效

```
 if (Application.OpenForms.OfType<frm_YouLikeHits_Settings>().Any())
            {
                Application.OpenForms.OfType<frm_YouLikeHits_Settings>().First().Close();
            }
            frm_YouLikeHits_Settings f1= new frm_YouLikeHits_Settings();
            f1.MdiParent = this;
            f1.Show(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-05-26T01:15:22.190

```
try
{
    if (Application.OpenForms.OfType<talkForm>().Any())
    {
        talkForm frm = new talkForm();
        frm.Close();
        MessageBox.Show("Form is opened");
    }
    else
    {
        talkForm frm = new talkForm();
        frm.Show();
        MessageBox.Show("Form is not opened");
    }
}
catch(Exception ex)
{

} 
```

# c++ - 在 C++ 中的方法中使用引用和返回值？

> ID：13445159
> 
> 赞同：0
> 
> 时间：2012-11-18T22:11:58.017
> 
> 标签：c++, reference, return-value

假设您正在 C++ 中实现一个列表数据类型。你的这个列表会将项目保存在一个简单的数组中，并将保存类型为：“动物”的实例。

例如，addItem 方法将是这样的：

```
void MyAnimalList::insertAnimal(Animal a){
    animalArray[currentPosition] = a;
    currentPosition++;
 } 
```

因此，我们在 List 实现中只是有一个 currentPosition，当我们向其中添加一个新 Animal 时，Animal a 现在在“currentPosition”中的 animalArray 中被引用，然后 currentPosition 增加。

我的问题是关于retrieveItem。这两个之间有什么区别：

```
void MyAnimalList::getTheLastAddedAnimal(Animal &a){
    a = animalArray[currentPosition-1];
}

Animal MyAnimalList::getTheLastAddedAnimal(){
    return animalArray[currentPosition-1];
} 
```

显然，第二种方法将被称为：

```
Animal lastAddedAnimal = myAnimalList.getTheLastAddedAnimal(); 
```

第一个应该被称为：

```
Animal someAnimal;
myAnimalList.getTheLastAddedAnimal(someAnimal); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T22:14:01.930

区别在于语义。如果一个方法被调用`getXXXXX`，你期望它**返回**那个东西。

Most decent compilers implement NRVO, so efficiency isn't really an issue here. I'd go with the second version.

I would however change the definition of `insertAnimal(Animal a)` to `insertAnimal(const Animal& a)`.

# c++ - 数字输入的 C++ 输入验证

> ID：13445160
> 
> 赞同：0
> 
> 时间：2012-11-18T22:12:08.207
> 
> 标签：c++, validation

我正在创建自己的非常简单的程序，允许用户输入数值。目前代码工作得很好，但我需要一个验证 if else 语句。这就是我目前所拥有的；

```
#include <iostream>
#include <string>

using namespace std;

int main()
{

    unsigned __int64 input = 0;
    char str[] = "qwertyuiopasdfghjklzxcvbnm[]{};'#:@~,./<>?|!£$%^&*()";

    cout << "Insert a number" << endl;
    cin >> input;

    if (input % 2 == 0) 
    {
        cout << "Even!" << endl;
    }
    else 
    {
        if (input% 2 == 1)
        {
            cout << "Odd" << endl;
            cout << "Lets make it even shall we? " << "Your new number is... " << input + 1 << endl;
        }
        else if (isdigit(str[0]))
        {
            cout << "That isn't a number!" << endl;
        }
    }

    system("pause");
    return 0;

} 
```

我遇到的问题是，如果用户输入的不是数字，它返回的值是“偶数”。

希望各位小伙伴们帮帮忙！约翰

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-18T22:19:20.877

不要将令牌提取 ( `>>`) 用于主解析。一旦提取失败，您的主要输入将处于未指定状态，这很糟糕。相反，逐行读取输入，然后处理每一行。

此外，**永远不要**忽略输入操作的结果。这只是一个简单的错误。

所以，把所有这些放在一起，你可以这样处理：

```
#include <iostream>
#include <sstream>
#include <string>

int main()
{
    for (std::string line; std::cout << "Input: " && std::getline(std::cin, line); )
    {
        std::cout << "We're parsing your line '" << line << "'\n";

        int n;
        std::istringstream iss(line);

        if (iss >> n >> std::ws && iss.get() == EOF)
        {
            std::cout << "It was a number: " << n << "\n";
        }
        else if (line.empty())
        {
            std::cout << "You didn't say anything!\n";
        }
        else
        {
            std::cout << "We could not parse '" << line << "' as a number.\n";
        }
    }

    std::cout << "Goodbye!\n";
} 
```

请注意，所有输入操作（即`>>`and `getline`）都出现在直接布尔上下文中！

# objective-c - 访问受密码保护的服务器上的文件

> ID：13445163
> 
> 赞同：0
> 
> 时间：2012-11-18T22:12:45.207
> 
> 标签：objective-c, authentication, html-parsing, hpple, mknetworkkit

我一直在通过访问 URL 并使用 TFHpple 解析 HTML 树来从公共 Web 服务器检索文档，如下所示：

```
NSData *documentsHTMLData = [NSData dataWithContentsOfURL:myURL];
TFHpple *documentsParser = [TFHpple hppleWithHTMLData:documentsHTMLData];
....
.... 
```

服务器现在受到密码保护，我希望仍然能够访问它，也许使用 MKNetworkKit。我已经做到了：

```
MKNetworkEngine *myEngine = [[MKNetworkEngine alloc] init];
MKNetworkOperation *user = [myEngine operationWithURLString:myURL];
[user setUsername:@"test" password:@"test"];
[myEngine enqueueOperation:user]; 
```

但是不知道如何使用 MKNetworkKit 从那里去了解如何访问目录结构。

我希望这里的某个人能够指出我正确的方向。任何想法都非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T02:07:51.520

如果您的服务器受密码保护，您需要知道使用的身份验证方案。如果您的服务器使用 HTTP Basic/Digest 身份验证，则上面的代码应该可以正常工作。如果您的服务器为您提供 HTML 页面并要求您输入用户名/密码（又名，基于 HTTP+HTML 表单的身份验证），那么您就不走运了，除非您进行逆向工程并找到解决方法。

# mysql - SELECT 语句中的 select_expr 子句适用于什么？

> ID：13445165
> 
> 赞同：0
> 
> 时间：2012-11-18T22:12:51.260
> 
> 标签：mysql, sql

> **可能重复：**
> [不使用 select * 的原因是什么？](https://stackoverflow.com/questions/321299/what-is-the-reason-not-to-use-select)

你能解释一下`select_expr`语句中的哪个子句`SELECT`有好处吗？我一直这样`*`用`select_expr`

```
SELECT * FROM table_name WHERE ... 
```

这已经足够了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T00:01:14.497

一个比其他例子更重要的例子：

*   您需要使用聚合函数：

    ```
    SELECT ID, COUNT(*) AS Num_Total
      FROM OrderItem
     GROUP BY OrderID; 
    ```

*   您需要从 UNION 查询的两个部分获取信息。我最近在[回答另一个问题时使用了它：](https://stackoverflow.com/a/13445856/15168)

    ```
    SELECT v1.ID AS OrderID_1, v1.NA AS NS, v2.ID AS OrderID_2, v2.NB AS NL, v3.NC AS NC
      FROM (SELECT ID, COUNT(*) AS NA
              FROM OrderItem
             WHERE OrderID = <specified order ID>
             GROUP BY OrderID
           ) AS v1
      JOIN (SELECT ID, COUNT(*) AS NB
              FROM OrderItem
             WHERE OrderID != <specified order ID>
             GROUP BY OrderID
           ) AS v2
        ON v1.NA <= v2.NB
      JOIN (SELECT I1.ID, COUNT(*) AS NC
              FROM OrderItem AS I1
              JOIN OrderItem AS I2 ON I2.ItemID = I1.ItemID AND I2.OrderID = <specified order ID>
             WHERE I1.OrderID != <specified order ID>
             GROUP BY I1.ID
           ) AS v3
        ON v3.ID = v2.ID
    UNION
    SELECT v2.ID AS OrderID_1, v2.NB AS NS, v1.ID AS OrderID_2, v2.NA AS NL, v3.NC AS NC
      FROM (SELECT ID, COUNT(*) AS NA
              FROM OrderItem
             WHERE OrderID = <specified order ID>
             GROUP BY OrderID
           ) AS v1
      JOIN (SELECT ID, COUNT(*) AS NB
              FROM OrderItem
             WHERE OrderID != <specified order ID>
             GROUP BY OrderID
           ) AS v2
        ON v1.NA > v2.NB
      JOIN (SELECT I1.ID, COUNT(*) AS NC
              FROM OrderItem AS I1
              JOIN OrderItem AS I2 ON I2.ItemID = I1.ItemID AND I2.OrderID = <specified order ID>
             WHERE I1.OrderID != <specified order ID>
             GROUP BY I1.ID
           ) AS v3
        ON v3.ID = v1.ID 
    ```

在该查询中，`Quantity`OrderItem 表中的列与我正在执行的计算没有任何关系。如果不使用“select_expr”而不是“SELECT *”，就无法编写该查询。您可能会注意到，最初的“聚合函数”建议是这个较大查询中的子查询之一（它出现了两次——您相信优化器会准确优化）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T22:23:17.360

有几个原因：

*   您可以*添加*计算列：`select a, b, a+b FROM table`
*   您可以限制传输的数据量。
*   您可以为各个列指定一个新名称。
*   您可以更安全、更高效地进行编程。

补充第一点和第二点：特别是通常需要列限制。

添加到第四点：在进行临时查询时，我几乎总是使用`*`. 但是程序应该总是枚举列。这可以防止令人惊讶的列重新排序，并且还可以明确实际使用了哪些数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-18T22:16:41.500

想象一下，您的表有一百万列，您只对其中一个感兴趣，并且您正在通过网络通过 30 波特连接与您的数据库通信。

# iphone - 从 IBAction 方法获取变量或对象

> ID：13445166
> 
> 赞同：-1
> 
> 时间：2012-11-18T22:13:00.060
> 
> 标签：iphone, ios, xcode, ipad, ios6

在过去的几天里，我一直在阅读、谷歌搜索和观看 Lynda 视频以找到答案。我还没有找到好的答案。

这看起来应该很简单。使用普通方法，我可以传递变量。但是由于 IBAction 是（void），我无法弄清楚如何将变量传递给另一种方法。

以下是我想做的一些简单示例：

```
- (IBAction)treeButton:(id)sender {
    int test = 10;
}

-(void)myMethod{
     NSLog(@"the value of test is %i",test);
} 
```

这是我真正想要的工作。我试图让一个按钮设置我想要存储并以另一种方法使用的初始位置。

```
- (IBAction)locationButton:(id)sender {
    CLLocation *loc1 = [[CLLocation alloc]
       initWithLatitude:_locationManager.location.coordinate.latitude
       longitude:_locationManager.location.coordinate.longitude];
}

-(void)myMethod{
     NSLog(@"the value of test is %i",test);
     NSLog(@"location 1 is %@",loc1);
} 
```

任何能引导我走向正确方向的建议都会很棒。我已经阅读并观看了有关变量范围、实例变量等的视频。只是不明白我需要在这里做什么

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T22:15:19.747

更改`myMethod`以接受您需要的参数：

```
- (void)myMethod:(CLLocation *)location {
    NSLog(@"location 1 is %@", location);
} 
```

像这样调用它：

```
- (IBAction)locationButton:(id)sender {
    CLLocation *loc1 = [[CLLocation alloc]
       initWithLatitude:_locationManager.location.coordinate.latitude
       longitude:_locationManager.location.coordinate.longitude];
    [self myMethod:loc1];
} 
```

* * *

如果您需要通过多种方法或在代码中的不同点访问它，我建议`loc1`在您的`@interface`声明中创建一个实例变量。

```
@interface MyClass : NSObject {
    CLLocation *loc1;
} 
```

在您的方法中，您只需设置它，而不是重新声明它：

```
loc1 = [[CLLocation alloc]
       initWithLatitude:_locationManager.location.coordinate.latitude
       longitude:_locationManager.location.coordinate.longitude]; 
```

在`myMethod`中，只需访问它：

```
- (void)myMethod{
    NSLog(@"location 1 is %@", loc1);
} 
```

# graph - 如何在八度音阶的函数下着色区域？

> ID：13445168
> 
> 赞同：2
> 
> 时间：2012-11-18T22:13:13.600
> 
> 标签：graph, numpy, scipy, octave

我想展示阈值对 FAR 和 FRR 的影响（基本上是 x 范围有界时曲线下的区域）。为此，我需要做这样的事情！

![图冒名顶替者与真实尝试](../Images/a332c90d4f8317b7b8b16e5baaf2a9a3.png)

如果阈值移动，则由端点和阈值界定的相应区域也会移动。我也想让两个对应的区域用不同的颜色。有没有办法在 octave/python/任何其他工具中做到这一点。最简单的方法是什么？

还有教科书作者如何绘制这些图表。这些肯定不是标准功能。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-19T04:32:21.123

在 python 中，您可以使用 matplotlib 的[fill_between](http://matplotlib.org/api/pyplot_api.html#matplotlib.pyplot.fill_between)：

```
import numpy as np
import matplotlib.pyplot as plt

# Create some fake data
x = np.arange(0, 20, 0.01)
y1 = np.exp(-(x - 6)**2 / 5.)
y2 = 2 * np.exp(-(x - 12)**2 / 8.)

plt.plot(x, y1, 'r-')
plt.plot(x, y2, 'g-')
plt.fill_between(x, 0, y1, color='r', alpha=0.6)
plt.fill_between(x, 0, y2, color='g', alpha=0.6) 
```

![分布](../Images/36ea6e497d1f85723fe40a86ba150673.png)

在这里，alpha 用于创建透明度并在交叉区域中组合两种颜色。您也可以只用不同的颜色为该区域着色：

```
idx_intsec = 828
plt.fill_between(x[:idx_intsec], 0, y2[:idx_intsec], color='y')
plt.fill_between(x[idx_intsec:], 0, y1[idx_intsec:], color='y') 
```

![分布_黄色](../Images/5d2bb5ee3c95e89a01b50b8aa9b4dc7a.png)

如果只想要图形的底部（即阈值前后的功能区），也很简单。让我们将我的情节中的阈值定义为`x = 7`：

```
thres = 7.
idx_thres = np.argmin(np.abs(x - thres))
plt.plot(x[:idx_thres], y2[:idx_thres], 'g-')
plt.plot(x[idx_thres:], y1[idx_thres:], 'r-')
plt.plot([thres, thres], [0, y1[idx_thres]], 'r-')
plt.fill_between(x[:idx_thres], y2[:idx_thres], color='g', alpha=0.6)
plt.fill_between(x[idx_thres:], y1[idx_thres:], color='r', alpha=0.6) 
```

![distributions_small](../Images/866520044dfbbd77f2eb937fc87730da.png)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-22T17:15:42.553

这在 Octave 中实际上非常容易。对另一个示例使用相同的代码（转换为 Octave）：

```
## create same fake data as other example
x = 0:0.1:20;
y1 = exp(-(x-6).**2 / 5);
y2 = 2 * exp(-(x-12).**2 / 8);

area (x, y1, "FaceColor", "blue");
hold on;
area (x, y2, "FaceColor", "red");
area (x, min ([y1; y2]), "FaceColor", "green");
hold off 
```

我得到下图![面积图](../Images/26a4ab325dc7c9f118c7d22f0f17a8a1.png)

应该可以更改区域的透明度，`FaceAlpha`但显然尚未在 Octave 中实施（尽管有一天）。同时，您可以传递 RGB 值作为解决方法

```
area (x, y1,             "FaceColor", [0.0  0.0  0.8]);
hold on;
area (x, y2,             "FaceColor", [0.0  0.8  0.0]);
area (x, min ([y1; y2]), "FaceColor", [0.0  0.8  0.8]);
hold off 
```

# facebook - 调用 getUserAccessToken() 返回错误

> ID：13445169
> 
> 赞同：1
> 
> 时间：2012-11-18T22:13:18.420
> 
> 标签：facebook

我正在使用可以在用户墙上发布消息的 facebook 应用程序，我的错误消息：

```
Fatal error: Call to protected method BaseFacebook::getUserAccessToken() from context '' in /home/tillaf/public_html/facebook/login_facebook2.php on line 61

My file :

<?php 

         require_once("facebook.php");

       @session_start();
       $app_id = "********";
       $app_secret = "*********";
       $my_url = "http://t.****.net/**/login.php/";

    ///
       $config = array();
      $config['appId'] = '408682199198463';
      $config['secret'] = 'd5b3c0ddfbd673dd94494f28524c1a84';
      $config['fileUpload'] = false; // optional

        $facebook = new Facebook($config);
       ///

    ////

    ////

      $code = $_REQUEST["code"];

       if(empty($code)) {
         $_SESSION['state'] = md5(uniqid(rand(), TRUE)); // CSRF protection
         $dialog_url = "https://www.facebook.com/dialog/oauth?client_id=" 
           . $app_id . "&redirect_uri=" . urlencode($my_url) . "&state="
           . $_SESSION['state'] . "&scope=user_birthday,read_stream,publish_stream,email,user_status,offline_access";

         echo("<script> top.location.href='" . $dialog_url . "'</script>");
       }
       else{

         $user_id = $facebook->getUser();
         echo $user_id;
         echo "<br/>";

    ////////// Get Access Token 

    /*
    $app_token_url = "https://graph.facebook.com/oauth/access_token?"
            . "client_id=" . $app_id
            . "&client_secret=" . $app_secret 
            . "&grant_type=client_credentials";

            $response = file_get_contents($app_token_url);
            $params = null;
        parse_str($response, $params);

        echo("This app's access token is: " . $params['access_token']);

    */
    ///-------------

    $user_access_token = $facebook->getUserAccessToken();

    ////////     

         ////// Start publish on wall

         //$facebook->getAccessTokenFromCode($_GET['code']);

         $message='ssss';
         $link='http://www.google.com';
         $name='Samilox';
         $caption='s';
         $description='Descrption...';

        $facebook->api("/me/feed",'POST',
                   array( 'access_token' =>$user_access_token,
                     'message' => 'Hello World!',
                     'link' => 'www.example.com'
                        )
                );
         ///
       }

     ?> 
```

对不起代码:)因为我在发布这个问题之前尝试了很多解决方案。

请问有人可以帮忙吗？提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-24T14:24:33.100

我修复它使用：

//// 为当前会话添加 AccessToken

```
 function getAccessToken() {
    if ($this->accessToken !== null) {
      return $this->accessToken;
    }

    $this->setAccessToken($this->getApplicationAccessToken());
    $user_access_token = $this->getUserAccessToken();
    if ($user_access_token) {
      $this->setAccessToken($user_access_token);
    }

    return $this->accessToken;
  }

   function getApplicationAccessToken() {
    return $this->appId.'|'.$this->appSecret;
} 
```

////

# python - Pandas 中的日期范围

> ID：13445174
> 
> 赞同：25
> 
> 时间：2012-11-18T22:14:06.220
> 
> 标签：python, pandas, datetime, time-series

在与 NumPy 和 dateutil 斗争了几天之后，我最近发现了令人惊叹的 Pandas 库。我一直在研究文档和源代码，但我不知道如何`date_range()`在正确的断点处生成索引。

```
from datetime import date
import pandas as pd

start = date('2012-01-15')
end = date('2012-09-20')
# 'M' is month-end, instead I need same-day-of-month
date_range(start, end, freq='M') 
```

我想要的是：

```
2012-01-15
2012-02-15
2012-03-15
...
2012-09-15 
```

我得到什么：

```
2012-01-31
2012-02-29
2012-03-31
...
2012-08-31 
```

我需要一个月大小的块来说明一个月中可变的天数。这可以通过 dateutil.rrule 实现：

```
rrule(freq=MONTHLY, dtstart=start, bymonthday=(start.day, -1), bysetpos=1) 
```

丑陋且难以辨认，但它有效。我怎么能用熊猫做到这一点？我都玩过`date_range()`和`period_range()`，到目前为止没有运气。

我的实际目标是使用`groupby`,`crosstab`和/或`resample`根据期间内各个条目的总和/均值/等计算每个期间的值。换句话说，我想从以下位置转换数据：

```
 total
2012-01-10 00:01    50
2012-01-15 01:01    55
2012-03-11 00:01    60
2012-04-28 00:01    80

#Hypothetical usage
dataframe.resample('total', how='sum', freq='M', start='2012-01-09', end='2012-04-15') 
```

至

```
 total
2012-01-09          105 # Values summed
2012-02-09          0   # Missing from dataframe
2012-03-09          60
2012-04-09          0   # Data past end date, not counted 
```

鉴于 Pandas 最初是一种财务分析工具，我几乎可以肯定有一种简单快捷的方法可以做到这一点。帮助表示赞赏！

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-11-19T00:47:38.977

`freq='M'`用于月末频率（请参见[此处](http://pandas.pydata.org/pandas-docs/stable/timeseries.html#offset-aliases)）。但是您可以使用`.shift`任何天数（或任何频率）来改变它：

```
pd.date_range(start, end, freq='M').shift(15, freq=pd.datetools.day) 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-11-19T14:16:57.763

实际上没有“月中的某天”频率（例如“DOM09”之类的“DOMXX”），但我看不出有什么理由不加一个。

[http://github.com/pydata/pandas/issues/2289](http://github.com/pydata/pandas/issues/2289)

我目前没有适合您的简单解决方法，因为`resample`需要通过已知的频率规则。我认为应该增强它以能够将任何日期范围用作任意 bin 边缘。只是时间问题和黑客行为......

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2016-08-23T17:24:20.327

尝试

```
date_range(start, end, freq=pd.DateOffset(months=1)) 
```

# iphone - 在服务器数据库上存储 iPhone 应用程序的登录凭据

> ID：13445178
> 
> 赞同：1
> 
> 时间：2012-11-18T22:14:38.693
> 
> 标签：iphone, sql, database

我正在构建一个应用程序，并希望将用户的登录凭据存储在服务器上的某种数据库中。我认为这应该是一个 SQL 服务器，但我不知道什么是最好的。你知道有什么很棒的教程可以让我开始吗？

# menu - 单击时制作菜单栏调用方法？

> ID：13445180
> 
> 赞同：2
> 
> 时间：2012-11-18T22:14:51.397
> 
> 标签：menu, javafx-2

我想向`javafx.scene.control.Menu`MenuBar 添加一个空，并在单击它时让它调用一个方法。

我试过使用`menu.setOnShowing(new EventHandler<Event>(){});`没有运气。

这是我目前正在使用的内容：

```
public MenuBar createMenuBar() {
    MenuBar menuBar = new MenuBar();
    Menu file = new Menu("File");

    Menu addAccountTab = new Menu("Add Tab");
    addAccountTab.setOnShowing(new EventHandler<Event>() {
        public void handle(Event e) {
            System.out.println("addAccountTab Menu clicked.");
        }
    });
    menuBar.getMenus().add(addAccount);
    return menuBar;
} 
```

但是，单击菜单不会调用 onShowing 事件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T22:31:11.453

您`Menu`需要至少包含一个`MenuItem`事件才能触发。

```
public class MenuApplication extends Application {

    @Override
    public void start(Stage primaryStage) {
        MenuBar menuBar = new MenuBar();
        Menu file = new Menu("File");

        Menu addAccountTab = new Menu("Add Tab");

        addAccountTab.setOnShowing(new EventHandler<Event>() {
            @Override
            public void handle(Event e) {
                System.out.println("addAccountTab Menu clicked.");
            }
        });

        MenuItem NewMenuItem = new MenuItem("New");
        addAccountTab.getItems().add(NewMenuItem);

        menuBar.getMenus().addAll(file, addAccountTab);

        StackPane root = new StackPane();
        root.getChildren().add(menuBar);

        Scene scene = new Scene(root, 300, 250);

        primaryStage.setTitle("Hello World!");
        primaryStage.setScene(scene);
        primaryStage.show();
    }

    public static void main(String[] args) {
        launch(args);
    }
} 
```

我得到的输出如下所示：

![在此处输入图像描述](../Images/091b6aadb125f29e7f58ca086b220f8c.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T03:16:28.460

尽管 API 另有建议，`onShowing`但当菜单中没有 MenuItem 或它们都被隐藏时，不会调用该事件。

我能够通过在这样的事件中使用菜单的`hide()`方法来解决这个问题。`onShown`

```
public MenuBar createMenuBar() {
    MenuBar menuBar = new MenuBar();
    Menu addAccount = MenuBuilder.create()
        .onShown(new EventHandler<Event>() {
            public void handle(Event e) {
                ((Menu)e.getSource()).hide();
                System.out.println("addAccount Clicked");
            }
        }).items(new MenuItem())
        .text("Add Account").build();
    menuBar.getMenus().addAll(addAccount);

    return menuBar;
} 
```

# java - 有人能帮我找出我的代码无法运行的原因吗

> ID：13445184
> 
> 赞同：-1
> 
> 时间：2012-11-18T22:15:37.103
> 
> 标签：java

> **可能重复：**
> [带有测试的 Java 代码 - 无限循环？](https://stackoverflow.com/questions/13445021/java-code-with-tests-infinite-loop)

这是我想要获取人与人之间关系的代码，但是，当我运行单元测试时，测试永远运行并且无法得到结果，并且我的 cpu 使用率很高。这是我的代码。有人能看出它有什么问题吗？字符串关系是字符串的多行输入，格式为 "A , B" +\n" + "C , D" 其中 A 是 B 的父级，C 是 D 的父级。

这是代码的默认构造函数，是字符串的输入格式，我们不需要检查格式是否正确

```
 public SeeRelations(String relations){
                this.relations = relations;
            } 
```

//帮助函数获取字符串的每一行

```
 private ArrayList<String> lineRelations(){
            int i;
            ArrayList<String> lineRelations = new ArrayList<String>();
            String[] lines = relations.split("\n");
            for(i = 0; i < lines.length; i++){
                lineRelations.add(lines[i]);
            }
            return lineRelations;
        } 
```

//帮助函数将每个关系放入arraylists

```
 private ArrayList<ArrayList<String>> allRelations(){
                int i;
                ArrayList<ArrayList<String>> allRelations = new ArrayList<ArrayList<String>>();
                ArrayList<String> lineRelations = lineRelations();
                for(i = 0; i < lineRelations.size(); i++){
                    ArrayList<String> eachLine = new ArrayList<String>(Arrays.asList(lineRelations.get(i).split("\\s*,\\s*")));
                    allRelations.add(eachLine);
                }
                return allRelations;
            } 
```

这是检查输入名称是否存在的方法 //帮助函数查看名称是否存在用于seeRelations()

```
 private boolean hasThisName(String name){
        ArrayList<ArrayList<String>> allRelations = allRelations();
        int i;
        int j;
        for(i = 0; i < allRelations.size(); i++){
            for(j = 0; j < allRelations.get(i).size(); j++){
                if(name.equals(allRelations.get(i).get(j))){
                    return true;
                }
            }
        }
        return false;
    } 
```

这是获取两个人之间代数的函数 //帮助函数获取seeRelations()的代数

```
 private int getGenerationNum(String person, String ancestor){
        ArrayList<ArrayList<String>> allRelations = allRelations();
        String name;
        int i;
        int j;
        int generationNum = 0;
        for(i = 0, j = 0, name = ancestor; i < allRelations.size(); i++){
            if(name.equals(allRelations.get(i).get(0)) && !person.equals(allRelations.get(i).get(1))){
                generationNum++;
                ancestor = allRelations.get(i).get(1);
                i = 0;
                j = 1;
            }
            else if(ancestor.equals(allRelations.get(i).get(0)) && person.equals(allRelations.get(i).get(1))){
                generationNum++;
                j = 1;
                break;
            }
        }
        if(j == 0){
            return 0;
        }
        else{
            return generationNum;
        }
    } 
```

这是为最终输出获得多个“伟大”的方法

```
 private String great(int num){
        int i;
        String great = "";
        for(i = 0; i < num; i++){
            great += "great";
        }
        return great;
    } 
```

这是我检查两个人关系的最后方法

```
 public String seeRelations(String person, String ancestor){
        int generationNum = getGenerationNum(person, ancestor);
        String great = great(generationNum  - 2);
        if(!(hasThisName(person) && hasThisName(ancestor))){
            return null;
        }
        else{
            if(generationNum == 0){
                return null;
            }
            else if(generationNum == 1){
                return ancestor + " is the parent of " + person;
            }
            else if(generationNum == 2){
                return ancestor + " is the grandparent of " + person;
            }
            else{
                return ancestor + " is the" + " " +  great +"grandparent of " + person;
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T22:35:28.850

这段代码在我看来很可疑。它在一个循环内，该循环依赖于增加 i 的终止，但有条件地将 i 重置为零。什么保证我会超过 1？

```
 if(name.equals(allRelations.get(i).get(0)) && !person.equals(allRelations.get(i).get(1))){
            generationNum++;
            ancestor = allRelations.get(i).get(1);
            i = 0;
            j = 1;
        } 
```

一般来说，我建议简化你的代码直到它工作，然后逐渐添加，这样你一次只需要调试一小段代码。

# c++ - 尝试重载输出运算符时出错

> ID：13445185
> 
> 赞同：2
> 
> 时间：2012-11-18T22:15:38.727
> 
> 标签：c++, linker-errors, outputstream

我正在学习 C++，并且在构建我的项目时遇到了链接错误。

该错误与我的代码有关，该代码使输出 << 运算符重载。

这是我得到的错误：

```
1>lab4.obj : error LNK2019: unresolved external symbol "class std::basic_ostream<char,struct std::char_traits<char> > & __cdecl operator<<(class std::basic_ostream<char,struct std::char_traits<char> > &,class Matrix<2,2> const &)" (??6@YAAAV?$basic_ostream@DU?$char_traits@D@std@@@std@@AAV01@ABV?$Matrix@$01$01@@@Z) referenced in function _main
1>c:\users\matt\documents\visual studio 2010\Projects\lab4\Debug\lab4.exe : fatal error LNK1120: 1 unresolved externals 
```

如何修复此错误？我在下面附上了我的代码

```
#include <iostream>
#include <string>
#include <stdio.h>
using namespace std;

template <int m, int n> 
class Matrix{
public:
    int data[m][n];
public:
    Matrix(){};

    void setup(){
        for(int i=0;i<m;i++){
            for(int j=0;j<n;j++){
                data[i][j] = 0;
            }
        }
    }

    void setAll(int integer){
        for(int i=0;i<m;i++){
            for(int j=0;j<n;j++){
                data[i][j] = integer;
            }
        }
    }

    void output(){
        for(int i=0;i<m;i++){
            cout << "[ ";
            for(int j=0;j<n;j++){
                cout << data[i][j] << " ";
            }
            cout<<"]"<<endl;
        }
    }

    Matrix<m,n> operator+ (const Matrix<m,n> &rhs)
    {
        Matrix<m,n> result;

        for(int i=0;i<m;i++){
            for(int j=0;j<n;j++){
                result.data[i][j] = this->data[i][j] + rhs.data[i][j];
            }
        }

        return result;
    }

    Matrix<m,n> operator- (const Matrix<m,n> &rhs)
    {
        Matrix<m,n> result;

        for(int i=0;i<m;i++){
            for(int j=0;j<n;j++){
                result.data[i][j] = this->data[i][j] - rhs.data[i][j];
            }
        }

        return result;
    }

    template <int l>
    Matrix <m,l> operator*(const Matrix<n,l> &rhs) //const
    {
        //only if number of columns in the first matrix equals the number of rows in the second matrix. 
        Matrix<m,l> result;
        for(int i = 0; i < m; i++){
            for(int j = 0 ; j < l ; j++){
                result.data[i][j] = 0;
                for(int k = 0; k < n; k++){
                    result.data[i][j] += this->data[i][k] * rhs.data[k][j];
                }
            }
        }
        return result;
    };

    Matrix <m,n> operator*(int scalar){
        Matrix <m,n> result;
        for(int i= 0; i < m; i++){
            for(int j = 0; j < n; j++){
                result.data[i][j] = this->data[i][j] * scalar;
            }
        }
        return result;
    };

    friend ostream& operator<<(ostream &os, const Matrix<m,n> &rhs);
    friend Matrix <m,n> operator++(const Matrix<m,n> &rhs, int);
    friend Matrix <m,n> operator--(const Matrix<m,n> &rhs, int);
};

template <int m, int n> 
ostream& operator<< (ostream &os, const Matrix<m,n> &rhs){
    for(int i=0;i<m;i++){
        os << "[ ";
        for(int j=0;j<n;j++){
            os << rhs.data[i][j] << " ";
        }
        os<<"]"<<endl;
    }
    return os;
}

template <int m, int n> 
 Matrix <m,n> operator++(const Matrix<m,n> &rhs, int){
    for(int i=0;i<m;i++){
        for(int j=0;j<n;j++){
            rhs.data[i][j]++;
        }
    }
}

template <int m, int n> 
 Matrix <m,n> operator--(const Matrix<m,n> &rhs, int){
    for(int i=0;i<m;i++){
        for(int j=0;j<n;j++){
            rhs.data[i][j]--;
        }
    }
}

int main(){
    Matrix<2,2> m = Matrix<2,2>();
    m.setup();
    //m.output();

    Matrix<2,2> p = Matrix<2,2>();
    p.setup();

    Matrix<2,2> z = Matrix<2,2>();
    z = m + p;
    //z.output();

    z = z * z;
    cout << z;
    string stopper;
    getline(cin, stopper);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T22:29:27.283

您的整个源代码是否真的位于一个文件中，如此处发布的？您是否知道，您必须在其标头中定义模板类的函数成员？（其实这只是最简单的解决方案，有一些变通方法）

参考： http: [//www.parashift.com/c++-faq/separate-template-fn-defn-from-decl.html](http://www.parashift.com/c++-faq/separate-template-fn-defn-from-decl.html)

如果不是，则可能是错误的原因。

顺便说一句，这个来源是错误的：

```
template <int m, int n> 
ostream& operator<< (ostream &os, const Matrix<m,n> &rhs){
    for(int i=0;i<m;i++){
        os << "[ ";
        for(int j=0;j<n;j++){
            os << data[i][j] << " ";
        }
        os<<"]"<<endl;
    }
    return os;
} 
```

`data`这里没有声明，它必须被引用为`rhs.data`，因为它`operator<<`不是类的成员`matrix`。

更新。

您必须将类中的所有朋友函数声明为

```
template <int f_m, int f_n> 
friend ostream& operator<<(ostream &os, const Matrix<f_m,f_n> &rhs); 
```

它们是单独的模板，它们的模板参数必须是单独的。奇怪的是，MSVC++ 没有发出那个错误。gcc 说：

```
matrix.cc:91:67: warning: friend declaration «std::ostream& operator<<(std::ostream&, const Matrix<m, n>&)» declares a non-template function [-Wnon-template-friend]
matrix.cc:91:67: note: (if this is not what you intended, make sure the function template has already been declared and add <> after the function name here) 
```

# c# - java enums vs C# enums - 缺少功能

> ID：13445186
> 
> 赞同：10
> 
> 时间：2012-11-18T22:15:39.777
> 
> 标签：c#, java, enums

在 java 中，我可以很容易地用附加数据描述一个枚举。
我可以这样描述

```
public enum OperatorType
{
    GreaterOrEqual  (">=", "GreaterOrEqual"),
    Greater         (">" ,"Greater"),
    Less            ("<", "Less"),
    LessOrEqual     ("<=", "LessOrEqual"),
    Equal           ("==", "Equal"),
    Between         ("Between", "Between"),
    Around          ("Around","Around");

    private final String symbol;
    private final String name;

    private OperatorType(final String symbol, final String name) {
        this.symbol = symbol;
        this.name = name;
    }
} 
```

然后添加一个迭代 values() 的静态方法，将所有数据添加到 hashmap 并允许通过其属性之一作为键从映射中检索完整枚举数据。

简而言之，枚举是java中一个非常发达的类型。

现在，
转移到 c#，我有什么选择？
我想保存一个枚举及其属性，将其加载到地图中，并在需要时按键检索。我有什么可以帮助的吗（例如，每个枚举都有一个单音 - 这不是一个好主意）。
谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-18T22:33:45.560

我只会创建一个包含`public static readonly`每种类型实例的类，然后完全放弃枚举。您可以将它们用作字典键或做任何您喜欢的事情。如果您仍打算将它们映射到基础数据类型 ( `int`)，那么您也可以为此创建隐式运算符。

```
public class OperatorType
{
    private static readonly Dictionary<int, OperatorType> OperatorMapping = new Dictionary<int, OperatorType>();

    public static readonly OperatorType GreaterOrEqual  = new OperatorType(0, ">=", "GreaterOrEqual");
    public static readonly OperatorType Greater         = new OperatorType(1, ">", "Greater");

    public readonly String symbol;
    public readonly String name;
    private readonly int underlyingValue;

    private OperatorType(int underlyingValue, string symbol, string name) {
        this.underlyingValue = underlyingValue;
        OperatorMapping[underlyingValue] = this;

        this.symbol = symbol;
        this.name = name;
    }

    public static implicit operator int(OperatorType operatorType)
    {
        return operatorType.underlyingValue;
    }

    public static implicit operator OperatorType(int value)
    {
        return OperatorMapping[value];
    }
} 
```

示例用法：

```
Dictionary<OperatorType, string> operators = new Dictionary<OperatorType, string>();

operators.Add(OperatorType.GreaterOrEqual, "Greater or equal");

Console.WriteLine(operators[OperatorType.GreaterOrEqual]); //"Greater or equal"

OperatorType operatorType = 1;

Console.WriteLine(operatorType.name); //"Greater" 
```

如果您不关心潜在价值，请不要包含它。还要考虑映射对于您的使用是否`Dictionary`应该是线程安全的。您还可以公开一个静态`IEnumerable<OperatorType>`（或其他集合）以定义所有运算符。

编辑：再想一想，`explicit`运算符可能比 . 更可取`implicit`，既符合典型的 .NET 最佳实践，又能更好地匹配典型`enum`转换。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-18T22:33:38.193

最方便的解决方法可能是为您的枚举类型创建一个扩展方法，并返回相关的符号。

像这样的东西：

```
namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {
            tester t = tester.x;
            t.testenums();
            Console.ReadKey();
        }

    }

    public static class ext
    {
        public static void testenums(this tester x)
        {
            Console.WriteLine(x.ToString());
        }
    }

    public enum tester
    {
        x,
        y
    }
} 
```

当然你可以写一个更复杂的扩展方法，有返回值等等，这只是一个例子。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-18T22:32:53.430

C# 并没有真正具有相同的功能。然而，有几种可能性可以真正接近（并且可能更灵活）。

坚持常规枚举，您可以使用属性来丰富额外的信息。当然，这需要反思才能解决

```
public enum OperatorType
{
    [DisplayName(">=")]
    GreaterOrEqual,
    // ...
} 
```

有几种模式可以解决这个问题，例如[http://www.codeproject.com/Articles/28087/DisplayNameAttribute-for-Enumerations](http://www.codeproject.com/Articles/28087/DisplayNameAttribute-for-Enumerations)，谷歌了解更多。

另一种方法是使用常规类来增强您的枚举类型：

```
public class OperatorType
{
   public static OperatorType GreaterOrEqual = new OperatorType(">=", "GreaterOrEqual");
   // ...

   string symbol;
   string name;
   private OperatorType(string symbol, string name)
   {
       this.symbol = symbol;
       this.name = name;
   }
} 
```

[本文](http://www.devx.com/enterprise/Article/28246)介绍了在 C# 中使用类枚举类型的其他一些方法

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-18T22:59:49.447

您可以创建一个属性：

```
public class EnumKeyAttribute : Attribute
{
    public string Key { get; set; }

    public string Description { get; set; }

    public EnumKeyAttribute(string key, string description)
    {
        this.Key = key;
        this.Description = description;
    }
} 
```

然后将其应用于您的枚举

```
public enum OperatorType
{
    [EnumKey(">=", "GreaterOrEqual")]
    GreaterOrEqual,

    [EnumKey(">", "Greater")]
    Greater,

    [EnumKey("<", "Less")]
    Less,

    [EnumKey("<=", "LessOrEqual")]
    LessOrEqual,

    [EnumKey("==", "Equal")]
    Equal,

    [EnumKey("Between", "Between")]
    Between,

    [EnumKey("Around", "Around")]
    Around
} 
```

要获取属性数据，您可以使用反射。下面是获取“Less”属性的示例

```
 MemberInfo memberInfo = typeof(OperatorType).GetMember(OperatorType.Less.ToString()).FirstOrDefault();

        if(memberInfo != null)
        {
            EnumKeyAttribute attribute = (EnumKeyAttribute)memberInfo.GetCustomAttributes(typeof(EnumKeyAttribute), false).FirstOrDefault();

            Console.WriteLine(attribute.Key);
            Console.WriteLine(attribute.Description);
        } 
```

但是因为这些枚举不是在运行时创建的，所以您可以通过创建一个在字典中查找值的静态方法来提高效率。将此作为易于使用的扩展方法

```
public static class KeyFinder
{
    private static Dictionary<OperatorType, EnumKeyAttribute> lookupTable =
        new Dictionary<OperatorType, EnumKeyAttribute>();

    public static EnumKeyAttribute GetKey(this OperatorType type)
    {

        if (lookupTable.ContainsKey(type))
        {
            return lookupTable[type];
        }

        MemberInfo memberInfo = typeof(OperatorType).GetMember(type.ToString()).FirstOrDefault();

        if (memberInfo != null)
        {
            EnumKeyAttribute attribute = (EnumKeyAttribute)memberInfo.GetCustomAttributes(typeof(EnumKeyAttribute), false).FirstOrDefault();

            if (attribute != null)
            {
                lookupTable.Add(type, attribute);
                return attribute;
            }
        }

        // add a null value so next time it doesn't use reflection only to find nothing
        lookupTable.Add(type, null);

        return null;
    }
} 
```

因此，现在要获取值，您只需执行以下操作：

```
OperatorType.Less.GetKey().Key
OperatorType.Less.GetKey().Description 
```

请注意空引用异常（因为如果找不到属性，它将返回空）。如果您想按键查找，您可以简单地创建使用字符串值作为键的其他扩展方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-18T22:32:43.280

如果你真的需要 C# 中 Java 风格的枚举的功能，我看到了三种合理的方法来实现它：

1.  使用 C# 枚举和辅助方法的静态类。你失去了类型安全，但这是一个非常可行的解决方案。

2.  使用 C# 枚举和一组扩展方法。可能是最惯用的 C# 解决方案，但您仍然必须处理类型安全性的损失（您的扩展方法应该能够处理超出范围的值，即使只是通过抛出异常）。

3.  在 Java 5中获得关键字之前，使用 Java 中常见的[类型安全枚举模式](https://stackoverflow.com/questions/5092015/advantages-of-javas-enum-over-the-old-typesafe-enum-pattern)`enum`。如果您对每个枚举值都有非平凡的逻辑，这将是我的首选。

# git - 在 git 存储库中包含一个外部文件夹来引用它

> ID：13445187
> 
> 赞同：1
> 
> 时间：2012-11-18T22:15:50.723
> 
> 标签：git

我有一个具有以下结构的源文件夹（子文件夹）：

*   MAIN_FOLDER
    *   程序1
    *   程序2
    *   通用模块
    *   程序3
    *   程序4

`COMMONMODULE`每个程序都使用一些包含在`COMMONMODULE`.

什么是最好的方法 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T22:19:20.890

[子模块](http://git-scm.com/book/en/Git-Tools-Submodules)是您正在寻找的。

# mysql - mysql 删除表并级联删除对表的所有引用

> ID：13445188
> 
> 赞同：2
> 
> 时间：2012-11-18T22:15:58.370
> 
> 标签：mysql, drop-table

我正在从旧系统开发新系统。新系统使用 MySQL 和 java。我想从减少表格数量开始。当我删除一个表让我们说 X 时，我怎样才能导致对 X 的所有引用也被删除，所以如果表 Y 对表 X 有一个 FK，那么在表 Y 上，FK 和 FK 中使用的列也会被删除?

简化示例：

```
CREATE TABLE `Y` (
    `yID` int(11) NOT NULL AUTO_INCREMENT,
    `yName` varchar(50) NOT NULL,
    ...
   ) ENGINE=InnoDB;

CREATE TABLE `user` (
    `userID` int(11) NOT NULL AUTO_INCREMENT,
    `userName` varchar(50) NOT NULL,
    `givenName` varchar(50) DEFAULT NULL,
    `sourceYID` int(11) NOT NULL,
    CONSTRAINT `USER_FK_sourceYID` FOREIGN KEY (`sourceYID`) REFERENCES `Y` (`yID`)
    ) ENGINE=InnoDB; 
```

我想最好发出一个命令

```
DROP TABLE `Y` 
```

在用户表上

*   删除约束`USER_FK_sourceYID`
*   删除列`sourceYID`
*   如果包含，则删除任何 KEY/INDEX 定义`sourceYID`（未包含在此示例中）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T19:52:43.113

没有一个命令可以做到这一点。处理此问题的最简单方法是删除约束，然后删除父表。没有约束，你可以自由地做到这一点。

```
ALTER TABLE `user` DROP FOREIGN KEY `USER_FK_sourceYID`;
DROP TABLE `Y`; 
```

删除该列会自动将其从它所属的任何索引中删除。即使它是一个复合索引，它也会留下一个包含剩余列的索引。以下是一些假设的示例索引，我们将看看删除列时会发生什么：

```
CREATE INDEX y1 ON `user` (sourceYID);
CREATE INDEX y2 ON `user` (userID, sourceYID);
CREATE INDEX y3 ON `user` (sourceYID, userID);

ALTER TABLE `user` DROP COLUMN `sourceYID`; 
```

结果是索引`y1`消失了，并且两者都`y2`被`y3`简化为仅包含 userID 列的单列索引：

```
SHOW CREATE TABLE `user`\G

CREATE TABLE `user` (
  `userID` int(11) NOT NULL AUTO_INCREMENT,
  `userName` varchar(50) NOT NULL,
  `givenName` varchar(50) DEFAULT NULL,
  PRIMARY KEY (`userID`),
  KEY `y2` (`userID`),
  KEY `y3` (`userID`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1 
```

因此，这两个现在是相同的索引，您应该运行[pt-duplicate-key-checker](http://www.percona.com/doc/percona-toolkit/2.1/pt-duplicate-key-checker.html)来分析您的架构以应对这种情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-08-10T09:55:43.737

```
SET FOREIGN_KEY_CHECKS = 0;
drop table if exists <your_1st_table>;
drop table if exists <your_2nd_table>;
SET FOREIGN_KEY_CHECKS = 1; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-19T07:20:44.087

如果您有外键，那么您将无法删除父表，外键关系将不允许这样做。为此，您应该执行以下步骤：

*   删除所有子记录，有两种方法：使用ON DELETE CASCADE 外键选项，或使用多表DELETE 语句。
*   如果存在，则删除外键。
*   删除父表。

# xaml - 将 DataTemplate 中的 ListBox 绑定到父控件 DataMemberBinding - Silverlight XAML

> ID：13445189
> 
> 赞同：1
> 
> 时间：2012-11-18T22:16:04.420
> 
> 标签：xaml, data-binding, silverlight-5.0

只是想知道是否可以将下面 XAML 中的列表框以相对方式绑定到 GridViewDataColumn - 我可以明确地做到这一点，但我想动态添加列，并想在列的转换器中设置一些逻辑。

```
 <navigation:Page.Resources>
    <converters:DebugConverter x:Key="DebugConverter"/>
    <converters:DebugInnerConverter x:Key="DebugInnerConverter"/>
    <DataTemplate x:Key="ChemistryResultsTemplate">
        <ListBox><!-- Bind this to parent GridViewDataColumn data -->
            <ListBox.ItemTemplate>
                <DataTemplate>
                    <TextBlock Text="{Binding ProfileResult}"></TextBlock>
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>
    </DataTemplate>
</navigation:Page.Resources>
<Grid x:Name="LayoutRoot">
    <telerik:RadGridView x:Name="LabReportGrid" AutoGenerateColumns="True">
        <telerik:RadGridView.Columns>
            <telerik:GridViewDataColumn DataMemberBinding="{Binding ChemistryResults, Converter={StaticResource DebugConverter}}"
                                        CellTemplate="{StaticResource ChemistryResultsTemplate}"
                                        x:Name="Testing">
            </telerik:GridViewDataColumn>
        </telerik:RadGridView.Columns>
    </telerik:RadGridView>
</Grid> 
```

# uitextview - 从另一个类访问 UITextView

> ID：13445200
> 
> 赞同：-1
> 
> 时间：2012-11-18T22:17:05.447
> 
> 标签：uitextview, viewcontroller

我目前有两个视图控制器 A 和 B，A 使用 segue 来推动 B，这可以很好地来回工作，但是基于视图控制器 B 中的一些按钮按下，我想更改控制器 A 中 UITextView 中的文本。

我看过以前的帖子，但目前我是新手，对我应该如何做这件事感到困惑。

我希望能够了解如何最好地在应用程序的各个部分之间进行交互。另外我想知道是否有一种方法可以利用 segue 返回来触发其他代码。

谢谢

编辑：好吧，也许我的信息有点有限，从我可以收集到的阅读其他帖子，他们在视图控制器（B）中手动为视图控制器（A）创建一个变量，然后在第二个视图控制器（B）中访问它并设置一个变量（属性和合成）以这种方式进行编辑，但是我将视图控制器嵌入在导航控制器中并在情节提要（GUI系统）中使用推送设置。我不确定我是否必须创建一个变量来执行此操作，或者是否因为它们存在于情节提要中有另一种方式，如果有人可以将我指向有助于解释这一点的帖子的方向（我正在看时刻）我将非常感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T22:50:06.353

好的，这就是我如何让它工作但我想有：

答：更好的方法来做到这一点。B：根据您的设置进行更改。

我将两个视图控制器嵌入到导航控制器中，并使用 segue push 来访问第二个视图控制器，每个控制器都有一个不同的类（所有设置都在情节提要中）。

为了让它为我工作，我做了以下事情：

我有一个单例（一个存储我所有数据的类，但对应用程序是全局的，因此可以从应用程序中的任何位置访问变量）这允许我拥有可以从任何视图控制器访问的变量。可以在[这里找到一个很棒的教程](http://sree.cc/iphone/global-functions-and-variables-in-objective-c)

然后，当我按下按钮时，我创建了一个 NSString 变量（passedNote）并从 ViewController B 更新了这个变量的值。

接下来，当加载 viewController A（在 viewWillAppear: (BOOL)animated 方法中）时，我用全局变量（passedNote）附加或替换 textview 的值（取决于某些逻辑）。

希望这对遇到问题的人有所帮助。

# java - 是否有用于查询 HTML 表的 SQL 包装器

> ID：13445201
> 
> 赞同：2
> 
> 时间：2012-11-18T22:17:08.987
> 
> 标签：java, c++, sql, html-parsing

关于如何将 SQL 查询的结果格式化为 HTML 表有很多问题，但我想换一种方式 - 给定一个带有标题行的任意 HTML 表，我希望能够提取信息使用 SQL（或类似 SQL 的语言）形成一个或多个行。说起来很简单，但显然实现起来并不那么简单。

最终，我更喜欢使用 libtidy 或 JSoup 之类的东西正确解析 HTML，但是虽然 API 文档通常是合理的，但当涉及到实际*使用*它们的示例或教程时，您通常会找到一个提取 <title> 的示例标签（可以使用正则表达式完成），没有关于如何使用该库的真实示例。因此，为现有的已建立库之一提供一个好的资源或示例代码也很好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T00:06:27.357

[使用JSoup](http://jsoup.org/)将表转换为元组列表的简单代码如下所示：

```
public class Main {
    public static void main(String[] args) throws Exception {
        final String html = 
            "<html><head/><body>" +
                "<table id=\"example\">" +
                    "<tr><td>John</td><td>Doe</td></tr>" +
                    "<tr><td>Michael</td><td>Smith</td>" +
                "</table>" +
            "</body></html>";

        final List<Tuple> tuples = parse (html, "example");
                    //... Here the table is parsed
    }

    private static final List<Tuple> parse(final String html, final String tableId) {
        final List<Tuple> tuples = new LinkedList<Tuple> ();

        final Element table = Jsoup.parse (html).getElementById(tableId);
        final Elements rows = table.getElementsByTag("tr");
        for (final Element row : rows) {
            final Elements children = row.children();
            final int childCount = children.size(); 
            final Tuple tuple = new Tuple (childCount);
            for (final Element child : children) {
                tuple.addColumn (child.text ());
            }
        }

        return tuples;
    }
}

public final class Tuple {
    private final String[] columns;

    private int cursor;

    public Tuple (final int size) {
        columns = new String[size];
        cursor = 0;
    }

    public String getColumn (final int no) {
        return columns[no];
    }

    public void addColumn(final String value) {
        columns[cursor++] = value;
    }
} 
```

从这里开始，您可以例如使用[H2](http://www.h2database.com)创建一个内存表并使用常规 SQL。

# javascript - 仅在轴上显示整数步长

> ID：13445204
> 
> 赞同：0
> 
> 时间：2012-11-18T22:17:17.397
> 
> 标签：javascript, highcharts

我有这张图。

![IMG](../Images/77eeace57db2957ac6daebcac317c311.png)

我只在 y 轴上显示整数步长。所以不是`[0, 0.5, 1, 1.5, 2, 2.5]`我想要的`[0,1,2]`。

那可能吗？我不确定要在官方 API 中寻找什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T22:39:21.790

您正在寻找的答案是`allowDecimals`布尔值：

```
yAxis: {
    allowDecimals : false,
    /* completely irrelevant stuff follows... */
    title: {
        text: 'It\'s the y-axis'
    },
    plotLines: [{
        value: 0,
        width: 1,
        color: '#808080'
    }]
}, 
```

与[`allowDecimals: false`](http://jsfiddle.net/davidThomas/PcrDz/1/).

```
yAxis: {
    allowDecimals : true, // though it defaults to 'true' anyway...
    /* other stuff... */
}, 
```

和同一张图[`allowDecimals: true`](http://jsfiddle.net/davidThomas/PcrDz/)。

参考：

*   [Highcharts API 参考`allowDecimals`](http://api.highcharts.com/highcharts#yAxis.allowDecimals).

# kendo-ui - kendoui - 弹出编辑 - v 2012.3.1114

> ID：13445209
> 
> 赞同：0
> 
> 时间：2012-11-18T22:18:20.387
> 
> 标签：kendo-ui

当我以弹出模式插入新记录时，对于某些字段不改变状态（红色三角形），值不会更新并且数据“空”传输到 web 服务。如果我按“退格”，该字段将状态更改为“已修改”（红色三角形）并发送到 Web 服务。在“2012.2.814”中运行良好。我附上一个示例程序（在 htm 中重命名 png）谢谢。米歇尔。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T22:38:12.870

如果您使用的是 MVC 包装器，请确保您已更新 DLL。无论哪种情况，请确保您已将所有 .js 文件更新为 2012.3.1114。在我们的项目中，我们将删除 Scripts 目录中的所有 kendo*.js 文件，然后将它们替换为最新版本。这也处理了偶尔被弃用的 js 文件。检查您的布局并确保您没有以错误的顺序调用它们（如果您使用的是 MVC-4，我强烈建议您使用 CDN 和/或捆绑选项）。还要更新您的内容并检查几个浏览器（Chrome 的开发人员工具、Fiddler、Firebug 以及），看看是否有任何错误/警告可能有助于解释它。最后，Kendo 现在支持 jQuery 1.8.2 - 以前的版本需要 jQuery 1.7。我发现迁移到 jQuery 1.8。

# google-app-engine - GAE MapReduce 大查询

> ID：13445214
> 
> 赞同：0
> 
> 时间：2012-11-18T22:18:45.877
> 
> 标签：google-app-engine, mapreduce, entity, syndication

摘要：在处理来自数据库的数据集合时，MapReduce 是一个好主意，而不是为一个有点复杂（或只是大）问题找到一些答案？

我想同步一组联合源（例如[http://xkcd.com/rss.xml](http://xkcd.com/rss.xml)之类的 url ），它们作为集合/表存储在 GAE 的数据存储中。我看到两种选择，一种是直截了当的。制作您放入队列中的简单任务，其中每个任务句柄的 100 或 1000 或任何自然数似乎适合每个任务。另一个选项是 MapReduce。

在后一种情况下，Map 做所有事情，而 Reduce 什么都不做。此外，地图没有结果，它只是改变了（数据存储的）“状态”。

```
@Override public void map(Entity entity) {
    String url = (String)entity.getProperty("url");
    for(Post p : www.fetchPostsFromFeed(url)) {
        p.save();
    }
} 
```

如您所见，一个来源可以映射到许多帖子，所以我的地图还不如称为“爆炸”。

所以没有排放，也没有什么可以减少的。我喜欢这种地图方法的原因是我告诉谷歌：在这里，拿我的收藏/表格，按照你认为适合不同的映射器的方式将其拆分，然后将帖子存储在你喜欢的任何地方。数据存储使用“高复制”。因此，数据的可用性很高，并且是“计算单元”做什么实体并没有真正减少网络通信的最佳选择。保存帖子也是如此，因为它们需要转到所有数据存储单元。我喜欢的是，mapreduce 对卡住的地图计算有某种故障恢复方式，并且它知道有多少任务要发送到哪个节点，而不是在某处排队一些实体，希望它有意义。

可能我这里的思路不对，请指正。无论如何，由于缺少 reduce 和 map 是“爆炸”，这种方法是否“错误”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T16:10:31.013

不，Map 的作用与手动排队任务相同。

# vim - 禁用所有命令以重新映射它们

> ID：13445215
> 
> 赞同：1
> 
> 时间：2012-11-18T22:18:50.887
> 
> 标签：vim

是否可以禁用/删除所有映射/命令以便从头开始重新映射它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T22:28:06.917

从 vim 帮助：

```
:mapc[lear]  (nvo modes)
:nmapc[lear] (n mode)
:cmapc[lear] (c mode)
... and so on

Remove ALL mappings from the modes where the map command applies. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T08:39:42.647

要禁用所有内置命令，您必须使用*无操作*映射 ( `:help <Nop>`) 覆盖它们，如下所示：

```
:noremap w <Nop> 
```

但是，如果您打算稍后重新映射它们，无论如何都不需要这样做，因为重新映射无论如何都会覆盖命令。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-19T08:42:57.667

阐明以下行为和文档`:mapclear`：

内置的东西（例如`w`正常模式移动）称为*commands*。可以更改触发它们的键；这是一个*映射*。Vim 带有一些开箱即用的插件和设置；这些被称为*默认映射*。

# python - Python中列表的极端模式

> ID：13445218
> 
> 赞同：2
> 
> 时间：2012-11-18T22:19:06.110
> 
> 标签：python

我应该使用“节点的极端模式”在节点列表中找到最小值。我不允许使用该`min()`功能。我想我需要使用某种循环或递归。这是数组的“极端模式”：

```
 largest = items[0]
    for i in range(0,len(items),1):
        if (items[i] > largest):
            largest = items[i] 
```

但是这种模式不适用于像这样包含节点的列表：

```
 [1, [23, [53, [54, [5, None]]]]] 
```

如何实现类似的模式以在上面的列表中找到最小值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T22:29:17.427

```
curList = items
if curList:
    largest = items[0]
    while curList is not None:
        if (curList[0] > largest):
            largest = curList[0]
        curList = curList[1]
    print largest 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-18T22:31:18.740

```
def myMin(mylist):
    smallest = float('inf')
    for l in mylist:
        if isinstance(l,list):
            tmp = myMin(l)
            if tmp < smallest:
                smallest = tmp
        elif l < smallest:
            smallest = l
    if smallest == float('inf'):
        return None
    return smallest 
```

修复了@Blckknght 的评论。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-18T23:00:31.040

这是@aw4lly 答案的一个变体，它可以在 Python 3 中使用。

```
def myMin(lst):
    smallest = None
    for i in lst:
        if isinstance(i, list):
            i = myMin(i)
        if smallest is None or i is not None and i < smallest:
            smallest = i
    return smallest 
```

这可以处理任何类型的嵌套列表，包括部分或完全空的列表（对于我们的目的，空列表是指除了其他“空”列表之外没有其他成员的列表）。空列表`None`作为它们的最小值返回，这与 Python 的标准函数不完全相同`min`（但它使递归更容易一些）。

```
>>> print(myMin([1, 2, 3, [4, [5], [], 0, [6, 7]], [[8], 9]]))
0
>>> print(myMin([[[],[[],[],[[],[]],]],[],[[]]]))
None 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-20T06:36:24.757

```
car = lambda lst: lst[0]  # value
cdr = lambda lst: lst[1]  # next list

lst = items
if lst:  # not empty
   largest = car(lst)
   while lst is not None:
         if largest < car(lst):
            largest = car(lst)
         lst = cdr(lst)
   print(largest) 
```

[例子](http://ideone.com/NuNcV0)

# c++ - 错误：非静态引用成员 'std::ostream& Student::out'，不能使用默认赋值运算符

> ID：13445219
> 
> 赞同：1
> 
> 时间：2012-11-18T22:19:06.937
> 
> 标签：c++

我是一个新手 C++ 程序员，在编写代码时遇到了这个错误：

```
C:\Users\Matt\Desktop\C++ Projects\OperatorOverload\students.h|8|error: non-static reference member 'std::ostream& Student::out', can't use default assignment operator| 
```

错误出现在此头文件的第 8 行：

```
#ifndef STUDENTS_H 
#define STUDENTS_H

#include <string>
#include <vector>
#include <fstream>

class Student {
private:
  std::string name;
  int credits;
  std::ostream& out;

public:
  // Create a student with the indicated name, currently registered for
  //   no courses and 0 credits
  Student (std::string studentName);

  // get basic info about this student
 std::string getName() const;
  int getCredits() const;

  // Indicate that this student has registered for a course
  // worth this number of credits
  void addCredits (int numCredits);
  void studentPrint(std::ostream& out) const;

};
inline
  std::ostream& operator<< ( std::ostream& out, const Student& b)
  {
      b.studentPrint(out);
      return out;
  }
  bool operator== ( Student n1, const Student&  n2)
  {

      if((n1.getCredits() == n2.getCredits())&&(n1.getName() == n2.getName()))
      {
          return true;
      }
      return false;
  }
  bool operator< (Student n1, const Student& n2)
  {
      if(n1.getCredits() < n2.getCredits()&&(n1.getName() < n2.getName()))
      {
          return true;
      }
      return false;
  }

#endif 
```

问题是我不太确定错误的含义，也不知道如何修复它。有没有人有可能的解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T22:40:26.387

显然，代码的问题`std::ostream&`在于您班级中的成员。从语义上讲，我怀疑拥有这个成员是否真的有意义。但是，让我们假设您想保留它。有几个含义：

1.  任何用户定义的构造函数都需要在其成员初始化列表中显式初始化引用。否则编译器将拒绝接受构造函数。
2.  编译器将无法创建赋值运算符，因为它不知道在分配引用时会发生什么。

错误消息似乎与赋值运算符有关。您可以通过显式定义赋值运算符来解决此问题，例如

```
Student& Student::operator= (Student const& other) {
    // assign all members necessary here
    return *this;
} 
```

但是，更好的解决方案是删除参考参数。无论如何，您可能都不需要它：存储`std::ostream&`成员的类很少。大多数情况下，任何流都是短暂的实体，临时用于将对象发送到对象或从中接收对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T22:34:10.277

在您的代码中的某处，您在其中一个`Student`对象上使用了赋值运算符。但是您没有专门定义赋值运算符，您只是使用编译器生成的运算符。但是当您有引用成员时，编译器生成的赋值运算符不起作用。禁用赋值运算符（通过使其私有或删除它），或使 ostream 成员成为指针，而不是引用。这一切都假设您在课堂上确实需要这个 ostream 对象，我觉得这很可疑。

# c - 将数组的元素“复制”到“int”中？C

> ID：13445222
> 
> 赞同：-4
> 
> 时间：2012-11-18T22:19:36.810
> 
> 标签：c, arrays, integer

这可能是一个非常简单的问题，但我需要将 array[0] 和 array[1] 中的两个 int 值复制到一个整数中。

例如，如果 array[0]=1 和 array[1]=6，我需要整数等于“16”。数组的任何元素的范围都是从 0 到 9。

我有什么机会？十分感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T22:23:02.993

array[0] 总是代表 10 的位置，而 array[1] 总是代表 1 的位置吗？array[0] 或 array[1] 的值是否会大于 9 或小于 0？会有一个数组[2] 或一个数组[3] 来表示一个 3 位或 4 位数字吗？

如果上述问题的答案是“是”、“否”和“否”，那么答案不就是简单的算术吗？

```
int result = (array[0] * 10) + array[1]; 
```

如果数据没有预先检查范围，那么您需要添加该步骤。即使数据已预先进行范围检查，您仍应考虑添加该步骤以确保更加确定。

在上面的例子中，'10' 也是一个幻数。不硬编码 10 可能是明智的，而是基于数组的大小。考虑存在数组[2] 的情况。. . 数组[n]。然后怎样呢？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T22:29:34.533

一种简单的方法是将整数转换为字符串，联系比，然后再次转换，这次是从字符串转换为整数。

```
char s1[30]; // String that will hold the first integer
char s2[15]; // String that will hold the second integer

int intResult; 
```

首先将int转换为字符串：

```
sprintf(s1, "%d", array[0]);
sprintf(s2, "%d", array[1]); 
```

比将 2 个字符串连接在一起：

```
s1 = strcat(s1,s2); 
```

然后将字符串结果转换为整数。intResult = atoi(s1);

# bash - bash sh 特殊参数$@ "$@"，将"$@" 保存到变量中

> ID：13445225
> 
> 赞同：4
> 
> 时间：2012-11-18T22:19:56.077
> 
> 标签：bash, sh

当我在编写 shell 脚本时，我对 $@ 和 "$@" 问题有点沮丧。所以，我写了一个shell脚本来做一些测试。喜欢以下。

```
func()
{
    local a="$@"
    for i in "$a";  do
        echo "$i ****"
    done
}

func000()
{
    local a="$@"
    for i in $a;  do
        echo "$i ****"
    done
}

func0()
{
    local a=$@
    for i in "$a";  do
            echo "$i ****"
    done
}

func00()
{
    local a=$@
    for i in $a;  do
        echo "$i ****"
    done
}

func1()
{
    for i in "$@";  do
        echo "$i ****"
    done
}

func2() 
{
    for i in $@;  do
        echo "$i ****"
    done
}

func "a b c"
func a b c 

echo "-----------"
func0 "a b c"
func0 a b c 

echo "-----------"
func00 "a b c"
func00 a b c 

echo "-----------"
func000 "a b c"
func000 a b c 

echo "-----------"
func1 "a b c"
func1 a b c 

echo "-----------"
func2 "a b c"
func2 a b c 

a b c ****
a b c ****   func
-----------
a b c ****   func0
a b c ****
-----------
a ****       func00
b ****
c ****
a ****
b ****
c ****
------------
a ****   func000
b ****
c ****
a ****
b ****
c ****

-----------
a b c ****     func1   //this has the result that I want. 
a **** 
b ****
c ****
----------- 
a ****      func2
b ****
c ****
a ****
b ****
c **** 
```

据我记得，在使用 $@ 时，我们必须使用双引号，否则会出现问题。因此，我知道某些功能肯定无法正常工作。（无论如何我仍然测试它）

**只有 func1 给了我一个期望的结果，但是，我想将“$@”分配给一个变量。通过查看 func0、func000、func0、func00 结果，这些结果都没有给我正确的东西。所以，我希望有人可以帮助我。**

另外，我知道 sh 和 bash 是有区别的。如果有人能指出我在什么情况下可能会破裂，我会很高兴。谢谢。

* * *

更新

我应该说，这个脚本的这个结果，它涉及到 bash 或 sh 的版本，或者 freebsd sh vs linux sh。

我可能是错的，如果是这样，请指出，非常感谢。

在旧的 sh，freebsd sh 中，我们没有数组，显然，数组赋值无法正常工作，另一种方法是像我在 func000 中所做的那样使用字符串，local a="$a"; 对于我在 $a 中；做 ...

如果使用 linux sh 4.5（已测试）或 bash，请参阅下面的答案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-18T23:05:27.343

* * *

更新，感谢@jordanm，我意识到这是 bash 和旧 sh 版本之间的区别。

这是 bash 或 sh 4.2 中的解决方案。在旧的 sh 中，这可能不起作用。

```
 33 func3()                                                                         
  34 {                                                                               
  35     local a=("${@}")                                                            
  36                                                                                 
  37     for i in "${a[@]}"; do                                                      
  38         echo "$i ****"                                                          
  39     done                                                                        
  40 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-20T01:42:50.807

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-11-18T23:02:19.027

如果您想将所有内容都保留在引号中，可以尝试以下操作：

```
test() {
    local args="$@"
    for i in `echo "$args"`;  do
        echo "$i ****"
    done
}

test 1 2 3 4 
```

输出：

```
~ $ ./test.sh 
1 ****
2 ****
3 ****
4 **** 
```

# php - 某些东西正在取消我的数据库类

> ID：13445226
> 
> 赞同：0
> 
> 时间：2012-11-18T22:20:04.893
> 
> 标签：php, mysql, session

我将会话存储在 MySQL 数据库中。

我有一个具有多种功能的 SessionManager 类。但是，在课堂的某个地方，我的数据库类正在被卸载，我似乎无法找出原因。

我使用以下方法测试了该类是否存在：

```
echo (class_exists('database') === TRUE ? 'Yes' : 'No'); 
```

这是产生致命错误的函数，告诉我`database`找不到该类。请注意，上面的测试在测试所在的位置返回 true，`__construct`并且在此方法中特别失败：

```
public static function writeSession($sessionId, $sessionData)
{
    $sessionId = session_id();
    session_write_close();
    session_id($sessionId);
    $expiry = time() + ini_get('session.gc_maxlifetime') - 1;
    $sessionId = database::getInstance()->real_escape_string($sessionId);
    $sessionData = database::getInstance()->real_escape_string($sessionData);
    $result = database::getInstance()->query("SELECT sessionid FROM sessions WHERE sessionid='$sessionId'");
    ($result->num_rows > 0) ?
        database::getInstance()->query("UPDATE sessions SET sessionid='$sessionId',expiry='$expiry',sessiondata= '$sessionData' WHERE sessionid='$sessionId'")
        : database::getInstance()->query("INSERT INTO sessions (sessionid,expiry,sessiondata) VALUES ('$sessionId','$expiry','$sessionData')") ;
} 
```

即使我尝试实例化一个新的数据库对象，也找不到该类，就好像它消失了一样。

该课程有效，并且在以前的方法中很好：

```
 public static function readSession($sessionId)
{

    $sessionId = session_id();
    $sessionId = database::getInstance()->real_escape_string($sessionId);
    $time = time();
    $result = database::getInstance()->query("SELECT sessiondata FROM sessions WHERE sessionid='$sessionId' AND expiry > $time");
    if ($result->num_rows > 0) {
        $row = $result->fetch_array();
        return $row['sessiondata'];
    }
    return "";
} 
```

谁能看到这里发生了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T22:58:44.810

开头只有两个重点：

1.  致命错误没有说谎。所以`database`类在某些（和那个）点丢失（不是未设置）。
2.  您在会话类中使用静态方法。这只需要在调用相关函数时会话类存在。没有任何设置可以确保`database`实际加载类定义。

这导致您应该需要该`database`函数调用的类定义的解决方案。把它放进去，`database`类就定义好了。实际上，我不明白您对问题的哪一部分感到好奇。

类，尤其是静态函数相当简单，您也可以在一定程度上用标准函数替换它们，这可能会使您的使用类型更加明显和更加直接。在您使用之前不要使用您觉得不常用的语言功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T22:24:25.543

`class_exists()`检查您的类是否可以加载。如果返回 false，则无法定位您的类代码。

如果你使用自动加载，你必须检查你的自动加载器。

如果不这样做，则必须添加一个`require_once "Path/To/The/File/With/The/Code/For/The/DatabaseClass.php`（带有类代码的文件路径）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-18T22:50:00.093

虽然这可能并不能真正回答这个问题，但我发现了两件有趣的事情。

1，APC导致我的数据库类出现问题，但我还没有找到原因。我已在待调查的服务器上全局禁用此功能。

2，检查 MySQL 配置是否确实相同，都以相同的方式处理查询等。

# c# - Restful 服务返回 - 检查 System.Byte[] 类型对象的开始元素时出错。遇到意外的字符“ÿ”

> ID：13445227
> 
> 赞同：0
> 
> 时间：2012-11-18T22:20:12.240
> 
> 标签：c#, .net, wcf, exception-handling, wcf-rest

所以我试图将图像从客户端发送到服务。

服务定义看起来像这样（实现没有什么花哨的，它没有到达那里，所以排除了该代码）：

```
[OperationContract]
[WebInvoke(Method = "POST", UriTemplate = "Image")]
Stream Image(byte [] Image); 
```

调用客户端如下所示：

```
public static byte[] ImageToByte(Image img)
{
    ImageConverter converter = new ImageConverter();
    return (byte[])converter.ConvertTo(img, typeof(byte[]));
}

string uri = "http://localhost:8000/RestfulService/Image";

Bitmap img = new Bitmap("Random.jpg");
byte[] byteArray = ImageToByte(img);

var request = WebRequest.Create(uri) as HttpWebRequest;

if (request != null)
{
    request.ContentType = "application/json";
    request.Method = "POST";
}

if (request.Method == "POST")
{
    request.ContentLength = byteArray.Length;
    Stream postStream = request.GetRequestStream();
    postStream.Write(byteArray, 0, byteArray.Length);
    postStream.Close();
}

if (request != null)
{
    var response = request.GetResponse() as HttpWebResponse; 
```

它在最后一行抛出异常

> 远程服务器返回错误：(400) 错误请求。

我已经尝试了我能想到的所有可能的事情：

> 请求内容类型

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T22:37:16.950

在我做类似的事情（发布原始文件）的地方，我接受输入作为流（不是字节 []）。

此外，我希望请求的内容类型是 application/octet-stream，尽管“application/json; charset=utf-8”可能会起作用。

当我对此进行测试时，使用 Stream 作为 WebInvoke 方法的输入参数类型或返回值是获取请求/响应的原始主体的技巧。

# json - 从 Json Array 在 UITableView 上显示图像

> ID：13445230
> 
> 赞同：0
> 
> 时间：2012-11-18T22:20:28.300
> 
> 标签：json, image, uitableview

我有一个使用 JSON 创建的数组的 UITableView，但我不知道如何显示数组中的图像。这些图像是一个字符串 url，但我无法在 UITableView 上显示它。

我知道显示文本的代码是下一个代码：

```
cell.textLabel.text = [[lista objectAtIndex:indexPath.row]objectForKey:@"title"]; 
```

但我不能将它用于带有图像的网址，因为“图像”是一个字符串数据：

```
 cell.imageView.image = [[lista objectAtIndex:indexPath.row] objectForKey:@"Images"]; 
```

如何显示来自 URL 的图像？

谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T22:36:31.710

您需要实际下载图像。

由于您是初学者，我建议您下载并使用[AFNetowrking](https://github.com/AFNetworking/AFNetworking)，

AFNetworking 有一个简单的类来从 URL 下载 UIImages：

```
UIImageView *imageView = [[UIImageView alloc] initWithFrame:CGRectMake(0.0f, 0.0f, 100.0f, 100.0f)];
[imageView setImageWithURL:[NSURL URLWithString:@"http://i.imgur.com/r4uwx.jpg"] placeholderImage:[UIImage imageNamed:@"placeholder-avatar"]]; 
```

如果您在 Tableview 单元格中，您只需使用 TableView 的 cellImageView，而不是创建新的 UIImageView，例如：

```
[cell.imageView setImageWithURL:[NSURL URLWithString:[[lista objectAtIndex:indexPath.row] objectForKey:@"Images"]] placeholderImage:[UIImage imageNamed:@"myplaceholderimage.png"]]; 
```

# ios - iOS PhoneGap jQuery Mobile App 中的可见滚动条

> ID：13445237
> 
> 赞同：3
> 
> 时间：2012-11-18T22:21:24.127
> 
> 标签：ios, cordova, jquery-mobile, scrollbar, mobile-safari

我第一次使用 JQueryMobile + PhoneGap 开发 iPhone 应用程序。我有一个 div 容器，它的作用就像一个弹出窗口，我给它一个最大高度，带有溢出：自动和 -webkit-溢出滚动：触摸。

我想让滚动条始终可见并尝试了这个 css 规则（为了测试，我在元素和全局样式上都使用了相同的 psedu。但不确定它是否以这种方式工作！）..

```
.info-wrapper-content::-webkit-scrollbar, ::-webkit-scrollbar {
-webkit-appearance: none;width: 8px;
height: 13px;
}
.info-wrapper-content::-webkit-scrollbar-thumb:vertical{
height: 50px;
    background-color: #D95649;
    -webkit-border-radius: 0px;
    visibility: visible;
} 
```

它在桌面 Safari 或 Chrome 上运行良好，并且始终可见！但在移动 Safari 或 Phonegap 应用程序上却不行！Mobile Safari 是否支持 ::-webkit-scrollbar？

我真的不想使用任何额外的滚动插件，如 iScroll。有什么问题？为什么相同的代码表现不同？请做一些建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T02:49:02.043

我想你应该看看这个..这是以前有人问过的[类似问题..](https://stackoverflow.com/questions/4168974/iphone-safari-not-showing-scroll-bars)

似乎移动 safari 不支持溢出属性，因此未显示滚动条。

我确实为您找到了一个可能会有所帮助的链接，但我自己没有测试过，[您可以尝试一下](http://hicksdesign.co.uk/journal/forcing-scrollbars-now-even-better)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T03:55:57.560

这些属性基本上告诉浏览器采用标准的、始终可见的滚动条并稍微调整其外观。iOS 上根本不存在永久可见的滚动条，因此它们什么也不做。

虽然有些插件会使用常规的 html 元素创建一个假滚动条，但您真的想构建一些在 iOS 上看起来不合适的东西吗？

如果滚动条的原因只是告诉用户可以滚动，请尝试调整元素高度，使列表中的最后一项仅显示一半。

# python - 在熊猫中用 NaN 替换空白值（空格）

> ID：13445241
> 
> 赞同：219
> 
> 时间：2012-11-18T22:22:39.203
> 
> 标签：python, pandas, dataframe

我想在 Pandas 数据框中查找包含空格（任意数量）的所有值，并将这些值替换为 NaN。

有什么想法可以改进吗？

基本上我想把这个：

```
 A    B    C
2000-01-01 -0.532681  foo    0
2000-01-02  1.490752  bar    1
2000-01-03 -1.387326  foo    2
2000-01-04  0.814772  baz     
2000-01-05 -0.222552         4
2000-01-06 -1.176781  qux 
```

进入这个：

```
 A     B     C
2000-01-01 -0.532681   foo     0
2000-01-02  1.490752   bar     1
2000-01-03 -1.387326   foo     2
2000-01-04  0.814772   baz   NaN
2000-01-05 -0.222552   NaN     4
2000-01-06 -1.176781   qux   NaN 
```

我已经设法用下面的代码来做到这一点，但人是丑陋的。它不是 Pythonic，我敢肯定它也不是对 pandas 的最有效使用。我遍历每一列，并对通过应用对每个值进行正则表达式搜索的函数生成的列掩码进行布尔替换，匹配空白。

```
for i in df.columns:
    df[i][df[i].apply(lambda i: True if re.search('^\s*$', str(i)) else False)]=None 
```

它可以通过仅遍历可能包含空字符串的字段来进行一些优化：

```
if df[i].dtype == np.dtype('object') 
```

但这并没有太大的改善

最后，此代码将目标字符串设置为 None，这适用于 Pandas 的函数，例如`fillna()`，但如果我实际上可以`NaN`直接插入 a 而不是`None`.

* * *

## 回答 #1

> 赞同：283
> 
> 时间：2014-02-21T18:48:53.760

我认为`df.replace()`这项工作，因为[pandas 0.13](https://pandas.pydata.org/pandas-docs/version/0.13/generated/pandas.DataFrame.replace.html?highlight=replace#pandas.DataFrame.replace)：

```
df = pd.DataFrame([
    [-0.532681, 'foo', 0],
    [1.490752, 'bar', 1],
    [-1.387326, 'foo', 2],
    [0.814772, 'baz', ' '],     
    [-0.222552, '   ', 4],
    [-1.176781,  'qux', '  '],         
], columns='A B C'.split(), index=pd.date_range('2000-01-01','2000-01-06'))

# replace field that's entirely space (or empty) with NaN
print(df.replace(r'^\s*$', np.nan, regex=True)) 
```

产生：

```
 A    B   C
2000-01-01 -0.532681  foo   0
2000-01-02  1.490752  bar   1
2000-01-03 -1.387326  foo   2
2000-01-04  0.814772  baz NaN
2000-01-05 -0.222552  NaN   4
2000-01-06 -1.176781  qux NaN 
```

* * *

正如[Temak](https://stackoverflow.com/users/1351629/temak)指出的那样，`df.replace(r'^\s+$', np.nan, regex=True)`在您的有效数据包含空格的情况下使用。

* * *

## 回答 #2

> 赞同：93
> 
> 时间：2017-12-14T10:20:12.177

如果你想用空格替换一个空字符串和记录，**正确的答案是**！：

```
df = df.replace(r'^\s*$', np.nan, regex=True) 
```

接受的答案

```
df.replace(r'\s+', np.nan, regex=True) 
```

不替换空字符串！，您可以尝试使用稍微更新的给定示例：

```
df = pd.DataFrame([
    [-0.532681, 'foo', 0],
    [1.490752, 'bar', 1],
    [-1.387326, 'fo o', 2],
    [0.814772, 'baz', ' '],     
    [-0.222552, '   ', 4],
    [-1.176781,  'qux', ''],         
], columns='A B C'.split(), index=pd.date_range('2000-01-01','2000-01-06')) 
```

请注意，'fo o' 也不会被 Nan 替换，尽管它包含一个空格。进一步注意，一个简单的：

```
df.replace(r'', np.NaN) 
```

也不起作用 - 试试看。

* * *

## 回答 #3

> 赞同：39
> 
> 时间：2012-11-18T23:15:17.407

怎么样：

```
d = d.applymap(lambda x: np.nan if isinstance(x, basestring) and x.isspace() else x) 
```

该`applymap`函数将一个函数应用于数据帧的每个单元格。

* * *

## 回答 #4

> 赞同：28
> 
> 时间：2016-04-29T09:34:48.197

我这样做了：

```
df = df.apply(lambda x: x.str.strip()).replace('', np.nan) 
```

或者

```
df = df.apply(lambda x: x.str.strip() if isinstance(x, str) else x).replace('', np.nan) 
```

您可以剥离所有 str，然后将空 str 替换为`np.nan`.

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2018-01-07T16:07:39.943

如果您要从 CSV 文件中导出数据，它可以像这样简单：

```
df = pd.read_csv(file_csv, na_values=' ') 
```

这将创建数据框并将空白值替换为 Na

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2018-03-22T14:44:17.380

**最简单的解决方案：**

```
df = df.replace(r'^\s+$', np.nan, regex=True) 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2017-11-03T22:48:51.003

对于检查单个值是否相等的非常快速且简单的解决方案，您可以使用该`mask`方法。

```
df.mask(df == ' ') 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2020-05-08T00:49:01.253

这对我有用。当我导入我的 csv 文件时，我添加了 na_values = ' '。默认 NaN 值中不包含空格。

```
df= pd.read_csv(filepath,na_values = ' ') 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2019-05-12T04:05:16.230

这些都接近正确答案，但我不会说任何解决问题的方法，同时保持对阅读您代码的其他人的可读性。我想说这个答案是[BrenBarn 的答案](https://stackoverflow.com/a/13445630/10583199)和 tuomastik 在该[答案](https://stackoverflow.com/a/13445630/10583199)下方的评论的组合。BrenBarn 的答案利用`isspace`内置，但不支持删除空字符串，正如 OP 要求的那样，我倾向于将其归因于用 null 替换字符串的标准用例。

我用 重写了它，所以你可以用或`.apply`来调用它。`pd.Series``pd.DataFrame`

* * *

***蟒蛇 3：***

*要替换空字符串或完全由空格组成的字符串：*

```
df = df.apply(lambda x: np.nan if isinstance(x, str) and (x.isspace() or not x) else x) 
```

*要替换完全空格的字符串：*

```
df = df.apply(lambda x: np.nan if isinstance(x, str) and x.isspace() else x) 
```

* * *

要在 Python 2 中使用它，您需要将其替换`str`为`basestring`.

***蟒蛇2：***

*要替换空字符串或完全由空格组成的字符串：*

```
df = df.apply(lambda x: np.nan if isinstance(x, basestring) and (x.isspace() or not x) else x) 
```

*要替换完全空格的字符串：*

```
df = df.apply(lambda x: np.nan if isinstance(x, basestring) and x.isspace() else x) 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2018-09-29T20:31:29.010

```
print(df.isnull().sum()) # check numbers of null value in each column

modifiedDf=df.fillna("NaN") # Replace empty/null values with "NaN"

# modifiedDf = fd.dropna() # Remove rows with empty values

print(modifiedDf.isnull().sum()) # check numbers of null value in each column 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-01-14T05:02:20.313

这不是一个优雅的解决方案，但似乎可行的是保存到 XLSX，然后将其导入回来。此页面上的其他解决方案对我不起作用，不知道为什么。

```
data.to_excel(filepath, index=False)
data = pd.read_excel(filepath) 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2020-10-08T10:54:27.460

这应该工作

```
df.loc[df.Variable == '', 'Variable'] = 'Value' 
```

或者

```
df.loc[df.Variable1 == '', 'Variable2'] = 'Value' 
```

* * *

## 回答 #13

> 赞同：-3
> 
> 时间：2018-02-01T10:14:45.387

你也可以使用过滤器来做到这一点。

```
df = PD.DataFrame([
    [-0.532681, 'foo', 0],
    [1.490752, 'bar', 1],
    [-1.387326, 'foo', 2],
    [0.814772, 'baz', ' '],     
    [-0.222552, '   ', 4],
    [-1.176781,  'qux', '  '])
    df[df=='']='nan'
    df=df.astype(float) 
```

# bash - 这个 bash 脚本实际上是做什么的？

> ID：13445243
> 
> 赞同：0
> 
> 时间：2012-11-18T22:22:49.083
> 
> 标签：bash, shell, solr, wget

```
#!/bin/bash

# Setup Variables
hostName=localhost
portNum=8080
SOLRPATH=/solr
SOLR='delta-import&clean=false'
STATUS='dataimport?command=status'
urlCmd='http://${hostName}:${portNum}${SOLRPATH}/dataimport?command=${SOLRCMD}"
statusCmd='http://${hostName}:${portNum}${SOLRPATH}/dataimport?command=${STATUS}"
myStdErrLog=/tmp/myProject/myProg.stderr.$(/bin/date +%Y%m%d.%H%M)
outputDir=. 

# Operations
wget -O $outputDir/check_status_update_index.txt ${statusCmd} 2> ${myStdErrLog}
status=$(fgrep idle $outputDir/check_status_update_index.txt) 
case "${status}" in 
    *idle* ) .... ;; 
    * ) echo "unknown status = ${status} or similar" 1>&2 ;; 
 esac 
```

我真正理解的是，我们从变量中获得了 urlcmd 和 statuscmd，但我不明白该操作的作用。任何人都可以解释一下吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T22:33:54.970

首先，行中有错误

```
urlCmd='..."
statusCmd='..." 
```

由于它们以双引号结尾并包含变量，因此它们也需要以双引号开头。

`urlCmd`从不使用变量。不是错误，但也不是很好。

`wget`通过 检索状态`statusCmd`并`fgrep`尝试提取状态。然后在 case 语句中评估此状态。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T22:34:11.113

一般来说，它看起来像是尝试从网站下载数据并将状态传输到 myStdErrLog。

# wpf - 树视图项节点的上下文菜单命令

> ID：13445255
> 
> 赞同：-1
> 
> 时间：2012-11-18T22:25:26.917
> 
> 标签：wpf, xaml, command, contextmenu

在下面的标记中，我将上下文菜单用于分层模板中的树视图节点。问题是我想将上下文菜单项绑定到单个命令，但是由于我使用的是上下文菜单项样式，因此没有其他方法可以将命令绑定到菜单项。我如何将它们绑定到视图模型根目录中定义的命令。

```
 <HierarchicalDataTemplate  x:Key="NodeTemplate">
            <StackPanel Orientation="Horizontal">
                <StackPanel.ContextMenu>
                    <ContextMenu>
                        <MenuItem Header="Copy">
                        </MenuItem>
                        <MenuItem Header="Paste">
                        </MenuItem>
                        <ContextMenu.ItemContainerStyle>
                            <Style TargetType="MenuItem">
                                <Setter Property="Command" Value="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type UserControl}}, Path=DataContext.Copy}"/>
                                <Setter Property="CommandParameter" Value="{Binding Tag}"/>
                            </Style>
                        </ContextMenu.ItemContainerStyle>
                    </ContextMenu>
                </StackPanel.ContextMenu>
                <TextBlock Text="{Binding Path=Label}" Style="{StaticResource TreeTextStyle}" ToolTip="{Binding Path=Description}" Tag="{Binding Path=Tag}">
                </TextBlock>
            </StackPanel>
</HierarchicalDataTemplate> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T01:39:06.953

为什么不只是：

```
<MenuItem Header="Copy" Command="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type UserControl}}, Path=DataContext.Copy}> 
```

编辑：你是对的，它不起作用，因为它是一个 ContextMenu，并且一个 ContextMenu 被绘制在其`PlacementTarget`元素的可视树之外，因此`FindAncestor`不起作用。尝试以下操作：

```
Command="{Binding Path=DataContext.Copy, Source={x:Reference view}"/> 
```

确保您给出`x:Name="view"`实际视图。

# javascript - IE8 不处理 Flickr 提要

> ID：13445256
> 
> 赞同：0
> 
> 时间：2012-11-18T22:25:36.240
> 
> 标签：javascript

我有一个 Flickr Image feed 在这里运行：

[http://rational-animal.co.uk/lewis](http://rational-animal.co.uk/lewis) -- 但是当我在 IE8 中查看它时，它拒绝加载 Flickr 提要。有什么理由会出现这种情况？

谢谢！

# python - 没有得到 xml 文件输出

> ID：13445258
> 
> 赞同：0
> 
> 时间：2012-11-18T22:26:03.063
> 
> 标签：python

我正在尝试`email.xml`使用下面提供的 python 代码读取 xml 文件（下面的数据），我无法打印 xml 文件中存在的实际数据，但得到下面的输出。我哪里错了？

**电流输出**：

```
xmlfile
<open file 'email.xml', mode 'r' at 0x0226AF98>
[<DOM Element: to at 0x231d620>]
[<DOM Element: cc at 0x231d6c0>]
[<DOM Element: bcc at 0x231d760>] 
```

**蟒蛇代码**：

```
import xml.dom.minidom as minidom

def getemaildata():
    # Open the XML file
    xmlfile = open('email.xml','r')
    print "xmlfile"
    print xmlfile
    dom = minidom.parse(xmlfile)
    email=dom.getElementsByTagName('email')
    for node in email:
        toemail=dom.getElementsByTagName('to')
        print toemail
        ccemail=dom.getElementsByTagName('cc')
        print ccemail
        bccemail=dom.getElementsByTagName('bcc')
        print bccemail
return (toemail,ccemail,bccemail)

def main ():
(To,CC,BCC)=getemaildata()

 if __name__ == '__main__':
main() 
```

**`email.xml`文件**：

```
<email>
    <to>data@company.com;data.stability@company.com; 
         data.sns@company.com;data.pes@company.com;</to> 
    <cc> data.team </cc>
    <bcc>data@company.com</bcc>     
</email> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T22:47:32.237

您正在从 XML 解析器中获取“元素”对象的列表。您需要进一步迭代以到达实际的“文本”节点。

例如：

```
# this returns a list of all Elements that have the tag "to"
toemail=dom.getElementsByTagName('to')

# Here we take the first node returned with tag 'to', then it's first child node
textnode = toemail[0].childNodes[0]

# print the data in the textnode
print textnode.data 
```

要清除文本节点中的地址：

```
for address in textnode.data.split(';'):
    if address == '':
        # Catch empty entries as a result of trailing ;
        continue
    email = i.strip().strip('\n')
    print email 
```

# ruby - 在 Espresso 中，如何使用 `render` 作为动作名称？

> ID：13445264
> 
> 赞同：2
> 
> 时间：2012-11-18T22:27:09.773
> 
> 标签：ruby

开始将我的网站从 Rails 转移到[Espresso](http://e.github.com/)

我的旧网站有很多页面，例如`/render/TYPE/ID`在 Google 中编入索引。

但是在 Espresso`render`中是用来渲染模板的，不能用它作为动作吗？

```
class CMS < E
  map :/

  # other actions

  def render
    # this is overriding Espresso's `render` method
    # and i'm unable to render my templates?
  end
end 
```

请指教。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T22:35:09.927

在 Espresso 中定义操作的推荐方法是：`http verb + action name`

所以你的渲染动作看起来像`get_render`GET 请求、`post_render`POST 请求等。

为了方便起见，允许“无动词”动作。

你的控制器：

```
class CMS < E
  map :/

  # other actions

  def get_render
    # use `render` to render your templates
  end
end 
```

# php - symfony 2 中奇怪的路由行为

> ID：13445271
> 
> 赞同：0
> 
> 时间：2012-11-18T22:27:50.873
> 
> 标签：php, symfony, routing, multilingual

在我的 symfony 2.1.3 项目中，我有一个规则：

```
#app\config\routing.yml
acme:
resource: "@AcmeDemoBundle/Resources/config/routing_acme.yml"
prefix:   /

#src\Acme\DemoBundle\Resources\config\routing_acme.yml
acme_homepage:
pattern:  /{_locale}
defaults: { _controller: AcmeDemoBundle:Default:index, _locale:kz }
requirements:
    _locale: kz|ru|en 
```

但是，工作链接：

```
http://example.com/
http://example.com/en 
```

其他变体抛出**404“未找到“GET /ru/”的路线”**和**404“未找到“GET”/kz/ 的路线**

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T22:33:46.413

终于自己找到了，问题在于规则中缺少“/”符号：

```
pattern:  /{_locale}/ 
```

但是，现在下面的这个链接不起作用：

```
http://example.com/ 
```

我认为，重定向到默认语言环境也可以解决这个问题，但我认为路由 /kz 和 /ru 根本不匹配很奇怪

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T00:22:44.687

查看 [https://github.com/servergrove/KnowledgeBase/blob/master/src/ServerGrove/KbBundle/Controller/DefaultController.php](https://github.com/servergrove/KnowledgeBase/blob/master/src/ServerGrove/KbBundle/Controller/DefaultController.php)

也许他们的实施可以帮助你

# opengl - 顶点着色器中的正交透视，原点左下方

> ID：13445272
> 
> 赞同：0
> 
> 时间：2012-11-18T22:27:58.933
> 
> 标签：opengl, orthographic

我正在尝试使用正交投影显示我的场景，屏幕左下角的位置为 0,0。到目前为止，我已经得到了一个正交投影，但是当我试图移动原点（使用 glViewport）时，我只得到了屏幕渲染的四分之一。

这是我的代码

[http://pastebin.com/BUSuy9fs](http://pastebin.com/BUSuy9fs)

任何人都可以帮忙吗？

# javascript - Android：element.click() 不工作

> ID：13445274
> 
> 赞同：0
> 
> 时间：2012-11-18T22:28:13.987
> 
> 标签：javascript, android

我试图通过隐藏它并创建一个链接来单击输入元素来设置输入 type="file" 元素的样式。我的代码适用于 iPhone 5，但不适用于我的 Galaxy Nexus (Android)。

我的代码：

```
<input id="files" type="file" accept="image/*;" class="hidden" />
<div id="button" onclick="files.click();">Take picture</div> 
```

我必须做些什么才能使其在 Android 上运行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T23:32:15.567

我会评论你的问题，但我没有足够的声誉。在那里您可能会找到问题的答案（或者更确切地说是解释，为什么它不起作用 - 安全原因）：
[在 JavaScript 中，我可以通过编程方式为文件输入元素触发“点击”事件吗？](https://stackoverflow.com/questions/210643/in-javascript-can-i-make-a-click-event-fire-programmatically-for-a-file-input)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T22:30:10.963

```
onclick="files.click();" 
```

应该：

```
onclick="document.getElementById('files').click();" 
```

但是你最好使用不显眼的 javascript，避免在 html 中编写内联 javascript 代码。

# jquery - 基于发送者的 jQuery 选择器

> ID：13445276
> 
> 赞同：0
> 
> 时间：2012-11-18T22:28:31.323
> 
> 标签：jquery

我有 4 个`select`具有相同选项的输入。我正在尝试禁用从这些选择之一中选择的任何选项。

```
<select name="homeTeams[]" onchange="check()">
    <option value="1">Team1</option>
    <option value="2">Team2</option>
    <option value="3">Team3</option>
    <option value="4">Team4</option>
</select>

<select name="homeTeams[]" onchange="check()">
    <option value="1">Team1</option>
    <option value="2">Team2</option>
    <option value="3">Team3</option>
    <option value="4">Team4</option>
</select>

<select name="awayTeams[]" onchange="check()">
    <option value="1">Team1</option>
    <option value="2">Team2</option>
    <option value="3">Team3</option>
    <option value="4">Team4</option>
</select>

<select name="awayTeams[]" onchange="check()">
    <option value="1">Team1</option>
    <option value="2">Team2</option>
    <option value="3">Team3</option>
    <option value="4">Team4</option>
</select> 
```

我正在尝试禁用从这些选择器之一中选择的选项。我正在使用 jQuery 来执行此操作，但我无法根据发件人获取值。

例如：如果用户从 Select 1 中选择了 Team1，则`jQuery`代码将禁用 Select2 和 Select3 和 Select4 中的选项 Team1。

```
 function check()
  {
      var a = $('select option:selected').val();
      alert(a);
  } 
```

它给了我第一个选择的价值。

有任何想法吗 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T22:57:37.440

这是我的解决方案 - 请注意“- select -”的“0”值，它允许取消选择任何值：

```
$('select').on('change', function() {
    var vals = {};
    $('select').each(function(i, el) {
        vals[el.value] = 1;
    });
    delete vals[0];

    $('option').prop('disabled', function() {
        return this.value in vals && this.value !== this.parentElement.value;
    });
});​ 
```

演示在[http://jsfiddle.net/alnitak/Qq33g/](http://jsfiddle.net/alnitak/Qq33g/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T22:37:48.397

使用 jQuery 注册事件处理程序，如下所示：

```
$('select').change(function() {
    $(this).siblings('select')
           .find('option[value="' + $(this).val() + '"]')
           .attr('disabled', 'disabled');
    $(this).siblings('select')
           .find('option[value!="' + $(this).val() + '"]')
           .removeAttr('disabled');
}); 
```

这可能有效。我没有测试过。

# asp.net-mvc - 在使用 ModelBinder 之前更改文化

> ID：13445278
> 
> 赞同：11
> 
> 时间：2012-11-18T22:28:49.483
> 
> 标签：asp.net-mvc, localization, action-filter, custom-model-binder

我想创建一个不同语言的网站。我已经读到我可以创建一个[ActionFilter](https://stackoverflow.com/a/1561583/1394336)，但我有一个小问题：
我必须创建一个自定义 ModelBinder 才能使用英语和德语数字格式（`123,456,789.1`vs. `123.456.789,1`）

```
public class DecimalModelBinder : DefaultModelBinder
{
    public override object BindModel(ControllerContext controllerContext, ModelBindingContext bindingContext)
    {
        string key = bindingContext.ModelName;
        var v = ((string[])bindingContext.ValueProvider.GetValue(key).RawValue)[0];
        float outPut;
        if (float.TryParse(v, NumberStyles.Number, System.Globalization.CultureInfo.CurrentCulture, out outPut))
            return outPut;
        return base.BindModel(controllerContext, bindingContext);

    }
} 
```

此 ModelBinder 使用当前区域性来决定使用哪种格式。但不幸的是，ModelBinder 是在 ActionFilter 改变文化之前使用的。

如何在 ModelBinder 激活**之前更改文化？**

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-18T22:40:55.663

您可以实现 IHttpModule 并在 BeginRequest 中设置文化，如此[处所示](http://www.manas.com.ar/smedina/2008/12/17/internationalization-in-aspnet-mvc/)。

```
void context_BeginRequest(object sender, EventArgs e)
{
    // eat the cookie (if any) and set the culture
    if (HttpContext.Current.Request.Cookies["lang"] != null)
    {
        HttpCookie cookie = HttpContext.Current.Request.Cookies["lang"];
        string lang = cookie.Value;
        var culture = new System.Globalization.CultureInfo(lang);
        Thread.CurrentThread.CurrentCulture = culture;
        Thread.CurrentThread.CurrentUICulture = culture;
    }
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-21T14:20:04.883

我通常通过处理事件来设置`CurrentCulture`and （你也可以按照 barry 的建议处理这个事件）。`CurrentUICulture``PreRequestHandlerExecute``Global.asax.cs``IHttpModule`

关键是在模型绑定发生之前发生的事件中执行此操作。在此之前还发生了其他几个事件，您可以利用这些事件。

查看[HttpApplication 类](http://msdn.microsoft.com/en-us/library/system.web.httpapplication.aspx)以获取有关可用事件及其引发顺序的信息。

```
 public class MvcApplication : HttpApplication
    {
        protected void Application_PreRequestHandlerExecute(object sender, EventArgs e)
        {
            var culture = new CultureInfo("en-GB"); // Get the culture name from the route values / request querystring / form / cookie
            Thread.CurrentThread.CurrentCulture = culture;
            Thread.CurrentThread.CurrentUICulture = culture;
        }
    } 
```

你也可以通过处理你的`OnActionExecuting`事件来做到这一点`Controller`（你可能想创建一个基本控制器并在那里做，然后让你的所有控制器都继承自这个基本控制器）。

```
 public class MyBaseController : Controller
    {
        protected override void OnActionExecuting(ActionExecutingContext filterContext)
        {
            var culture = new CultureInfo("en-GB"); // Get the culture name from the route values / request querystring / form / cookie
            Thread.CurrentThread.CurrentCulture = culture;
            Thread.CurrentThread.CurrentUICulture = culture;

            base.OnActionExecuting(filterContext);
        }
    }

    public class MyController : MyBaseController
    {
        public ActionResult Index()
        {
            return View();
        }
    } 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-01-15T15:48:23.827

在模型绑定之前执行 get的实例`IAuthorizationFilter`，从而允许您设置所需的文化

# php - 检查一个字符是否在 URL 中出现一次

> ID：13445279
> 
> 赞同：0
> 
> 时间：2012-11-18T22:28:58.713
> 
> 标签：php

**我的问题**

`?`如果为真，我想检查 URL 是否包含一个，`do something`

**我的 PHP**

我目前正在使用这个脚本。

```
$lp_uri = $_SERVER['REQUEST_URI']; // or taken from another source //
    if( strpos($lp_uri, '?') !== false ){
    echo '<script>alert("one question mark");</script>';
} 
```

**我的问题**

我不知道如何检查是否只`?`发生**一次**。你能帮忙吗？非常感谢

**原因**

我的网站上有一个联系表格，一旦有人提交它，它就会在 url 中添加一个参数，所以它看起来像`website.com?msgsent=1`. 这意味着消息已发送。但有时如果该`email`字段不正确，它仍然会`?`在 url 中添加一个，因此 url 看起来像`website.com?`.

现在，我`slideDown`在我的联系表单上使用 jQuery 延迟来吸引客户的注意力，每次页面刷新时，都需要几秒钟的时间`slideDown`。如果 url 中有一个，我想克服这个`?`问题，因为如果 url 看起来`website.com?`意味着，电子邮件地址是错误的。

希望这是有道理的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-18T22:33:44.433

最初问题的解决方案（以防有人会在谷歌上找到这个问题）是使用`substr_count`：

```
if(substr_count($text, '?') == 1){
    // do something
} 
```

您的问题的解决方案是检查是否`msgsent`设置了参数：

```
if(!isset($_GET['msgsent'])){
    // message not sent - do something
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T22:33:40.060

使用偏移可选参数的可能解决方案

```
<?php
if( strpos($lp_uri, '?') !== false ){ 
   //1 or more question marks
   $pos = strpos($lp_uri, '?');  //Grab the position of it
   if(strpos($lp_uri, '?',$pos) === false) {
      //No more after the first, hence only 1
   }
} 
```

# c# - 如何将事件传递给方法然后订阅它？

> ID：13445285
> 
> 赞同：2
> 
> 时间：2012-11-18T22:29:50.147
> 
> 标签：c#, .net, events, delegates

## 事件处理程序

```
public void DeliverEvent(object sender, EventArgs e)
{

} 
```

## #1：这行得通

```
public void StartListening(Button source)
{
    source.Click += DeliverEvent;
} 
```

## #2：这也是..

```
public void StartListening(EventHandler eventHandler)
{
    eventHandler += DeliverEvent;
} 
```

但是在 #2 中，您不能调用该方法，因为如果您尝试这样的操作：

```
StartListening(button.Click); 
```

你得到这个错误：

`The event 'System.Windows.Forms.Control.Click' can only appear on the left hand side of += or -=`

有没有办法解决这个错误？我希望能够将事件而不是包含事件的对象传递给`StartListening`方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T22:44:09.603

您不能将事件作为参数传递，因为它不是委托类型的对象。事件是一对两个方法 -`add`和`remove`。

即`Click`按钮类的事件实际上看起来像

```
public void add_Click(EventHandler value) 
{
   // combine delegate
}

public void remove_Click(EventHandler value) 
{
   // remove delegate
} 
```

如果要订阅事件，则应传递整个对象，然后`add`为该特定事件调用方法（使用`+=`语法）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T22:47:19.820

您正在与代表混合事件。您可能应该阅读Jon Skeet 的[这篇](http://csharpindepth.com/Articles/Chapter2/Events.aspx)文章，它将解释两者之间的差异。

第二个选项不起作用的原因是该方法需要一个参数，该参数是符合`EventHandler`签名的委托。`Button.Click`指事件而不是委托。事件只是封装了委托。

我不确定你正在尝试什么可以完成。从概念上讲，您想做的事情实际上没有意义；这是您要传递的*处理程序*的逻辑，而不是*事件*本身。

看看[这篇](https://stackoverflow.com/q/293007/577417)文章，它着眼于一些模拟你想要的效果的方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-18T23:03:21.477

Microsoft [Reactive Extensions](http://social.msdn.microsoft.com/Forums/en-US/rx/threads)或[Rx](http://social.msdn.microsoft.com/Forums/en-US/rx/threads)框架提供了一种将事件转换为可观察对象的方法。事件不能作为参数传递，但 observables 可以。当订阅 observables 时，它们会为底层事件设置处理程序。

（其中一个重载的）签名如下所示：

```
IObservable<EventPattern<TEventArgs>> FromEventPattern<TDelegate, TEventArgs>(
        Action<TDelegate> addHandler, Action<TDelegate> removeHandler
    ) where TEventArgs: EventArgs 
```

例如，`MouseMove`要从事件定义可观察对象，可以使用以下代码：

```
 IObservable<EventPattern<MouseEventArgs>> mouseMoves =
            Observable
                .FromEventPattern<MouseEventHandler, MouseEventArgs>(
                    h => richTextBox1.MouseMove += h,
                    h => richTextBox1.MouseMove -= h); 
```

然后，您可以像这样传递对它的引用`IObservable<EventPattern<MouseEventArgs>> mouseMoves`并订阅它：

```
 var subscription = 
            mouseMoves
                .Subscribe(ep =>
                {
                    var x = ep.EventArgs.X;
                    var y = ep.EventArgs.Y;
                    // etc
                }); 
```

从可观察/事件中分离变得像这样简单：

```
 subscription.Dispose(); 
```

您可以通过 Nuget 获得 Rx。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-19T22:49:43.623

不幸的是，尽管 .net 中的事件和属性存在于类型系统中，虽然 Microsoft 将它们作为具体类型存在是可能且有用的（每个实例将包含一对委托，用于添加/删除或对于 get/set），微软没有创建任何这样的具体类型，也似乎不太可能这样做。因此，没有远程漂亮的方式将属性或事件传递给例程。相反，对于事件，要么必须传递一对委托——一个用于`Add`方法，一个用于`Remove`方法，或者可能传递一个包含有问题的两个委托的类或结构，或者传递应该使用其事件的对象以及事件的名称，并让被调用的例程使用反射来定位添加/删除处理程序与命名事件相关联。

# php - # hash 之后的 mod_rewrite URL 部分

> ID：13445286
> 
> 赞同：-1
> 
> 时间：2012-11-18T22:29:54.043
> 
> 标签：php, .htaccess, mod-rewrite, url-rewriting

我有一个看起来像这样的 URL

```
mysite.com/#!/~/category/id=2925536&offset=0&sort=priceAsc 
```

我怎样才能把它改成这样？

```
mysite.com/#category/2925536/0/priceAsc 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T22:31:17.380

片段标识符（散列标签是用来识别 Twitter 上的搜索词的东西，不是 URI 的一部分）在客户端处理，永远不会传递给服务器。因此它们不能用 mod_rewrite 读取。您将需要使用运行客户端的东西（例如 JavaScript）来处理它。

您可能希望考虑[不使用 hashbang URI 技术](http://isolani.co.uk/blog/javascript/BreakingTheWebWithHashBangs)，即使 Twitter 正在放弃它。

# android - 在 Android 上推送通知 - 不是 GCM

> ID：13445290
> 
> 赞同：0
> 
> 时间：2012-11-18T22:30:33.027
> 
> 标签：android, push-notification

我需要一个关于安卓系统推送通知的教程。我不需要 GCM 的实现，我只需要应用程序的警报管理器调用的推送通知。

这可能吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T22:36:38.037

另请参阅[schedule-repeatable-android-notification-in-different](http://blog.essencework.com/post/3622739193/scheduling-repeatable-android-notification-in-different)

要使用 AlaramManager，首先我们需要在 Manifest 文件中将 BroadcastReceiver 声明为，

接收者 android:name=".TimeAlarm" />

```
public class CustomAlarm extends Activity {

     AlarmManager am;

     @Override
     public void onCreate(Bundle savedInstanceState) {
      super.onCreate(savedInstanceState);
      setContentView(R.layout.main);
      am = (AlarmManager) getSystemService(Context.ALARM_SERVICE);
      setOneTimeAlarm();
     }

     public void setOneTimeAlarm() {
      Intent intent = new Intent(this, TimeAlarm.class);
      PendingIntent pendingIntent = PendingIntent.getBroadcast(this, 0,
        intent, PendingIntent.FLAG_ONE_SHOT);
      am.set(AlarmManager.RTC_WAKEUP,
        System.currentTimeMillis() + (5 * 1000), pendingIntent);
     }

     public void setRepeatingAlarm() {
      Intent intent = new Intent(this, TimeAlarm.class);
      PendingIntent pendingIntent = PendingIntent.getBroadcast(this, 0,
        intent, PendingIntent.FLAG_CANCEL_CURRENT);
      am.setRepeating(AlarmManager.RTC_WAKEUP, System.currentTimeMillis(),
        (5 * 1000), pendingIntent);
     }

    }

    public class TimeAlarm extends BroadcastReceiver {

     NotificationManager nm;

     @Override
     public void onReceive(Context context, Intent intent) {
      nm = (NotificationManager) context
        .getSystemService(Context.NOTIFICATION_SERVICE);
      CharSequence from = "Nithin";
      CharSequence message = "Crazy About Android...";
      PendingIntent contentIntent = PendingIntent.getActivity(context, 0,
        new Intent(), 0);
      Notification notif = new Notification(R.drawable.icon,
        "Crazy About Android...", System.currentTimeMillis());
      notif.setLatestEventInfo(context, from, message, contentIntent);
      nm.notify(1, notif);
     }
    } 
```

# sql - 将复杂的用户权限与一张表相关联

> ID：13445292
> 
> 赞同：1
> 
> 时间：2012-11-18T22:30:36.713
> 
> 标签：sql, database, database-design, relational-database

我有以下表结构：

```
Entity
---------------------
id | name

Users
---------------------
id | name | password 

UserGroups
---------------------
id | parent_id | name

Users_UserGroups
---------------------
user_id | user_group_id

Roles
---------------------
id | parent_id | name

Users_Roles
--------------------
user_id | role_id 
```

主要目标是创建`Entity`具有以下条件的行级访问限制：

1) 用户创建`Entity`- 他可以看到它（他是所有者）
2) 用户组成员也可以看到它（但如果其他定义 - 看不到 - 它将是用户私有的）。所以记录可以是用户或组私有的，也可以是公共的——所有人都可以看到记录。例如，用户在销售团队 A 中，有记录可以看到所有组成员，但可能有一个或多个记录只能看到用户 - 可能是潜在客户。
3) 例如，用户 A 是角色`salesman`，并且该角色是父角色的子角色`sales managers`。然后作为`sales manager`角色的用户可以看到用户 A 实体。角色的层次结构。老板可以看到他的直接员工在做什么:)
4) 也会有`profile`表格，可以将配置文件添加到角色，如果需要，也可以添加到用户。

主要问题是如何将用户/组/角色/配置文件与实体相关联？以及如何定义权限？我的想法是在`Entity`. 查询`Entity`记录时，查找用户，查看用户属于哪个角色、组、个人资料等。但我认为它太复杂了，也许有更简单的方法，不需要很多额外的表。我将不胜感激：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T22:54:10.483

标准模式是将 Principal 定义为您可以分配权限的任何内容。那么用户、用户组和角色都是主体的例子。一种实现方法是使用 principal_id 作为主键的主体表，然后通过 user_id 将用户表关联到它，通过 role_id 关联角色表，通过 user_group_id 关联组表。

然后，您将在实体上有一个 entity_owner_principal_id 列，以及一个带有 entity_id、principal_id 的 entity_permissions 表。您可以在此表中添加诸如“读取”、“删除”、“更新”之类的列，或者使用更灵活的内容。

您可能还想考虑组和角色之间是否存在任何真正的区别，它们都是对用户进行分组的方式，而且您似乎在这两种方式中也有层次结构。

# android - 果冻豆锁屏小部件

> ID：13445298
> 
> 赞同：1
> 
> 时间：2012-11-18T22:31:33.450
> 
> 标签：android, widget, locking, android-4.2-jelly-bean

我试图在 4.2 android 模拟器上添加锁屏小部件，每次我尝试添加它都会像这张图片一样被切断：

![在此处输入图像描述](../Images/bd34bf980fcd977723cf75543ef58ad8.png)

小部件布局：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/mainWidgetLayout"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="#000" /> 
```

提供者：

```
<appwidget-provider xmlns:android="http://schemas.android.com/apk/res/android"
    android:initialKeyguardLayout="@layout/fragment_widget_lock"
    android:label="BatteryWidgetLockScrProvider"
    android:updatePeriodMillis="1800000"
    android:minWidth="300dp"
    android:minHeight="300dp"
    android:widgetCategory="keyguard"
     /> 
```

我尝试使用 minHeight 和 minWidth 的各种值，甚至按照文档中的说明省略它们。似乎没有什么能把它拉到底部。我还尝试对小部件使用相对布局。您可以看到图片右侧旁边的小部件支架正在正确显示系统小部件，直到支架底部。我还设置了几个模拟器，认为这可能是错误的。

清单没问题，接收器设置正确。

我没主意了。欢迎任何帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-18T22:37:36.640

添加`android:resizeMode="vertical"`到您的`<appwidget-provider>`元素。[应用程序小部件文档](http://developer.android.com/guide/topics/appwidgets/index.html#lockscreen-sizing)建议这将使其填充可用的垂直空间。

# objective-c - 关闭时应用程序崩溃（？）？

> ID：13445302
> 
> 赞同：0
> 
> 时间：2012-11-18T22:32:36.797
> 
> 标签：objective-c, ios6, ios-simulator, xcode4.5

我是 iPhone 开发的新手，所以我真的不知道这是否是一个愚蠢的问题......我在模拟器中运行我的应用程序，一切都很好。然后我按下模拟器中的主页按钮。然后我双击 home 并从多任务栏中关闭我的应用程序。然后会弹出 xcode 窗口并以绿色文本显示`lldb`. 附带说明一下，除非我从 xcode 运行该应用程序，否则该应用程序将无法在 ios 模拟器上运行。有什么想法吗？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T22:38:23.043

这没什么好担心的，伙计。

`1)It happens only whenever you delete the running instance (app) of the app from the Home panel of the simulator/device.`

`2)It will also happen if you unplug your`iphone 设备`from the`Mac`during the debug Mode application.`

所以不用担心，这不是错误！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T02:36:44.927

IOS是正确的，正常的。如果您在测试期间从 Mac 上拔下 iphone，它也会执行此操作。:)

# php - 识别PHP中的图片？

> ID：13445305
> 
> 赞同：1
> 
> 时间：2012-11-18T22:32:39.207
> 
> 标签：php, imagemagick, gdlib

是否可以使用 PHP 将上传的图片与数据库中的其他图片进行比较？

*例如：*通过将酒瓶图片与标签目录进行比较来搜索葡萄酒

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T22:35:57.400

这是可能的，但您必须自己编写大部分代码。我强烈建议您阅读特征识别，因为您需要从那里借用一些算法。

其基本思想是在一张图片中找到可识别的“地标”（比如瓶子上图片的顶点），然后在此基础上进行匹配，同时考虑到图片可能不是从同一角度拍摄的，在相同的亮度，或相同的色调。

有一个非常好的 C 库叫做 openCV，我想知道是否有人从它移植到 PHP。它具有您想要的大多数算法（我将它用于我最后一年的研究项目映射晶体结构），因此值得一看，即使只是为了它背后的数学。

# android - 存储会话 ID 的推荐方法是什么

> ID：13445322
> 
> 赞同：5
> 
> 时间：2012-11-18T22:34:05.423
> 
> 标签：android, session, setcookie

我正在构建一个 android 应用程序，我很好奇在会话管理方面什么是“最佳实践”。

我设置我的应用程序进行身份验证（到 google-play-services）。我想存储一个会话 ID 并在用户离开应用程序时让它过期。cookie 是最好的方法吗？有更好的选择吗？任何示例代码都会非常有帮助。

谢谢，克雷格

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-01-16T10:44:45.350

通常，会话 ID 保存在共享首选项中，除非您关心安全性；在这种情况下，您应该加密并保存它，然后每次在到达端点之前对其进行解密。

会话 id 由服务器为每个会话维护，即会话 id 对于会话保持相同。成功登录标志着会话的开始，成功的注销标志着会话的结束。另一种方法是通过超时结束会话。超时值取决于应用程序的重要性，即如果它是银行应用程序，那么服务器将在几分钟内使会话超时，而电子商务应用程序可以有更长的超时时间（超出范围：服务器缓存会话）

例如，当您登录时，您会收到一个会话 ID。现在，您可以使用此会话 ID 发出其他请求。此会话 ID 在您注销或超时时过期。

在您的情况下，请检查您是否正在超时或注销。请记住，服务器为每个会话生成一个唯一的会话 ID。

# google-app-engine - 为什么 Google App Engine 搜索只返回“最佳”结果？

> ID：13445324
> 
> 赞同：0
> 
> 时间：2012-11-18T22:34:06.990
> 
> 标签：google-app-engine, full-text-search

GAE[全文搜索](https://developers.google.com/appengine/docs/python/search/overview "全文检索")，索引中的3个测试数据条目：

名称(1):test1
名称(2):test1 test2
名称(3):test1 test2 test3

查询1 ：名称：test1
结果1：名称（1），名称（2），名称（3）

查询2 ：名称：test1 test2
结果2：名称（2），名称（3）

查询3：名称：test1 test2 test3
结果3：名称（3）

我想从所有 3 个查询中返回所有 3 个条目（并按相关性对它们进行排序）。我检查了所有的 search.QueryOptions 设置，但我无法达到预期的结果。

目前我看到自己从输入构建查询表达式作为唯一选项（解决方案1：名称：test1 OR test2 OR test3；解决方案2：名称：test1 OR（test1 test2）OR（test2 test3）OR（test1 test3）OR（ test1 test2 test3)) 但很难相信这会是建议的方法。

Python 2.5，也使用 SDK 和生产环境进行了测试。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-20T11:16:24.943

API 不会返回那些其他结果，因为它们*与查询不匹配*。默认操作是“和”而不是“或”——任何理智的搜索工具都应该如此。在现实世界中使用 or 作为默认值会返回大量不相关的结果：当我搜索“应用程序引擎”时，我不想了解应用程序或引擎。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T01:41:28.300

你的问题对我来说并不完全清楚，但这个查询：

```
(name: test1 OR (test1 test2) OR (test1 OR test2 OR test3)) 
```

真的没有意义。这就是你所需要的：

```
name:(test1 OR test2 OR test3) 
```

从您列出的查询示例中，我认为您缺少的只是所有 3 个查询中的值之间的 OR 运算符：

查询1 ：查询2 `name:test1`
：`name:(test1 OR test2)`
查询3：`name:(test1 OR test2 OR test3)`

您将获得所有 3 个查询的所有 3 个文档。

# c - sscanf 从头开始 读取

> ID：13445327
> 
> 赞同：0
> 
> 时间：2012-11-18T22:34:13.230
> 
> 标签：c, string, scanf

```
int main(){
    int i,j;
    char *data = "1\n2\n";
    sscanf(data, "%d", &i);
    sscanf(data, "%d", &j);
    printf("i=%d, j=%d\n", i, j);
    return 0;
} 
```

如果你[运行代码](http://codepad.org/6mGWfWO0)你会看到这个

```
i=1, j=1 
```

为什么`j=1`在这里？不应该`2`吗？我错过了一些非常基本的东西吗？

如果我使用`sscanf(data, "%d\n%d", &i, &j);`它会显示正确的输出。但是现在下一个 sscanf 调用会重新从头开始读取吗？**为什么是这样？如何正确阅读？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-18T22:36:32.193

您的两`sscanf`行可以重写为：

```
sscanf("1\n2\n", "%d", &i);
sscanf("1\n2\n", "%d", &j); 
```

现在应该很明显为什么两者都有`i`和`j`具有价值`1`。`sscanf`无法修改 where`data`点。

使用单个`sscanf`调用来提取两个令牌：

```
sscanf(data, "%d\n%d", &i, &j); 
```

# php - 正确转义 & 在动态 PHP 到 XML 脚本中

> ID：13445328
> 
> 赞同：0
> 
> 时间：2012-11-18T22:34:21.780
> 
> 标签：php, mysql, xml, rss

我有一个动态生成的 XML 文件，除了生成的 RSS 在

示例网址： [http ://tinyurl.com/bbhnpg6](http://tinyurl.com/bbhnpg6)

http://tinyurl.com/crbuny5 的实际工作 URL

如何正确转义 $URL 变量以便正确写入 &？有人可以显示此示例已正确更新吗？

```
// selecting data from "mytable"
// mytable = your article table name
$query = @mysql_query("SELECT * FROM TABLE1 ORDER BY EntryDate ASC LIMIT 0,5");
while($row = @mysql_fetch_array($query)){
// [title] = change it to your article title
$title = $row['MLNumber'];
$link = $row['ListingRid'];
$url = "http://www.domain.com/residential?frame=TAL&amp;MLNO=";
$Unit= $row['Unit'];
$City= $row['City'];
$ZipCode= $row['ZipCode'];
$price = $row['SearchPrice'];
$description = $row['MarketingRemarks'];
$SubdivisionDisplay = $row['SubdivisionDisplay'];

echo '<item>';
echo '<title>' . $Unit . ' ' . $City . ', ' . $ZipCode . ' -' . $SubdivisionDisplay . '</title>';
echo '<link>' . $url . '' . $title . '</link>';
echo '<description><![CDATA[<p><strong>$' . $price . '.00</strong><BR> ' . $description . '<BR> ]]></description>';
//echo '<pubDate>' . date("D, d M Y H:i:s O", time()) . '</pubDate>';
echo '</item>';
}
echo '</channel>';
echo '</rss>';
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T23:01:47.480

```
$url = str_replace('&','&amp;', $url); 
```

# matlab - matlab中的3x3平均滤波器

> ID：13445334
> 
> 赞同：3
> 
> 时间：2012-11-18T22:34:51.260
> 
> 标签：matlab, image-processing

我编写了代码来使用 3x3 平均滤波器来平滑图像，但是输出很奇怪，几乎全是黑色的。这是我的代码。

```
function [filtered_img] = average_filter(noisy_img)
    [m,n] = size(noisy_img);
    filtered_img = zeros(m,n);
    for i = 1:m-2
        for j = 1:n-2
            sum = 0;
            for k = i:i+2
                for l = j:j+2
                    sum = sum+noisy_img(k,l);
                end
            end
            filtered_img(i+1,j+1) = sum/9.0;
        end
    end
end 
```

我调用函数如下：

```
img=imread('img.bmp');
filtered = average_filter(img);
imshow(uint8(filtered)); 
```

到目前为止，我在代码逻辑中看不到任何错误，如果有人能发现问题，我将不胜感激。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-18T22:43:47.957

假设您正在使用灰度图像，您应该将内部两个 for 循环替换为：

```
filtered_img(i+1,j+1) = mean2(noisy_img(i:i+2,j:j+2)); 
```

它有什么改变吗？

编辑：不要忘记将其重新转换为 uint8！

```
filtered_img = uint8(filtered_img); 
```

编辑 2：它在您的代码中不起作用的原因是因为`sum`在 255 处饱和，即 uint8 的上限。`mean`似乎可以防止这种情况发生

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-18T22:56:31.370

另外一个选项：

```
 f = @(x) mean(x(:));
 filtered_img = nlfilter(noisy_img,[3 3],f); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-19T00:09:48.163

```
img = imread('img.bmp');
filtered = imfilter(double(img), ones(3) / 9, 'replicate');
imshow(uint8(filtered)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-05-11T14:29:18.650

在图像和大小为 3x3 的滤波器之间实现乘积运算和的邻域运算，滤波器应该是平均滤波器。然后使用相同的函数/代码计算拉普拉斯算子（二阶导数，prewitt 和 sobel 运算（一阶导数）。使用简单的 10*10 矩阵执行这些操作需要 matlab 代码

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-05-11T15:18:38.687

与问题相切：

特别是对于 5x5 或更大的窗口，您可以考虑先在一个方向上平均，然后在另一个方向上平均，这样可以节省一些操作。因此，点 3 将是 (P1+P2+P3+P4+P5)。点 4 将是 (P2+P3+P4+P5+P6)。最后除以5。因此，点 4 可以计算为 P3new + P6 - P2。等等第5点等等。在其他方向重复相同的过程。确保先除，然后求和。

我需要为此计时，但我相信它对于更大的窗户可能会更快一些。每行是连续的，这可能看起来不是最好的，但是你有很多行可以并行工作，所以这应该不是问题。

如果你有整数，这个第一个除法，然后求和也可以防止饱和，所以即使在 3x3 的情况下你也可以使用这种方法，因为两次除以 3 比一次除以 9 错误更少（虽然更慢）。但请注意，你总是用它低估最终值，所以你不妨添加一些偏差（比如步骤之间的所有值+1）。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2015-09-14T05:22:25.223

```
img=imread('camraman.tif');
nsy-img=imnoise(img,'salt&pepper',0.2);
imshow('nsy-img');
h=ones(3,3)/9;
avg=conv2(img,h,'same');
imshow(Unit8(avg)); 
```

# android - 自定义操作栏

> ID：13445337
> 
> 赞同：0
> 
> 时间：2012-11-18T22:35:22.470
> 
> 标签：android, android-ui

我尝试自定义 ActionBar。这是我的尝试：![在此处输入图像描述](../Images/1c95ebf48d4197e43880024c0f986bc4.png)

我覆盖了背景，我想覆盖底部边框并禁用操作栏下的阴影。

```
<layer-list xmlns:android="http://schemas.android.com/apk/res/android" >

    <item>
        <bitmap
            xmlns:android="http://schemas.android.com/apk/res/android"
            android:src="@drawable/actionbar_bg"
            android:tileMode="repeat" />
    </item>

</layer> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T22:40:02.567

参考这个[网址](http://android-developers.blogspot.com/2011/04/customizing-action-bar.html)，我认为它对你有帮助

```
<?xml version="1.0" encoding="utf-8"?>
<layer-list xmlns:android="http://schemas.android.com/apk/res/android">
    <!-- Bottom Line -->
    <item>
        <shape android:shape="rectangle">
             // you can change here
            <solid android:color="@color/action_bar_line_color" />
        </shape>
    </item>

    <!-- Color of your action bar -->
    <item android:bottom="2dip">
        <shape android:shape="rectangle">
            <solid android:color="@color/action_bar_color" />
        </shape>
    </item>
</layer-list> 
```

# objective-c - NSComboBoxCell 在列表中，总是改变所有行

> ID：13445339
> 
> 赞同：0
> 
> 时间：2012-11-18T22:35:33.160
> 
> 标签：objective-c, cocoa, cocoa-bindings

我有员工列表，创建为 NSTableView，有两列。第一个是员工姓名，第二个是员工角色，应该从组合框中选择。我添加到此列 NSComboBoxCell，并将列绑定设置为：

```
Content - RolesController.arrangedObjects
Content Values - RolesController.arrangedObjects.roleName
Value - EmployeesController.selection.role.roleName

RolesController is NSArrayController based on Role entity
EmployeesController is NSArrayController based on Employee entity. 
```

这几乎可以正常工作，显示角色，允许选择角色，但是当我在一行中选择角色（对于一名员工）时，所有行中的角色都会更改（对于所有员工）。我一直在寻找解决方案，但在所有已建立的示例中，绑定与我的情况完全相同。

有谁知道我在哪里犯了错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T12:41:59.983

我真蠢。我应该连接：

```
Value -> EmployeesController.arrangedObjects.role.roleName 
```

现在，一切正常。

# loops - 为什么这个循环会打印上一次迭代的值？

> ID：13445341
> 
> 赞同：3
> 
> 时间：2012-11-18T22:35:52.463
> 
> 标签：loops, lisp, common-lisp

我有一个循环：

```
(defun echo-lines ()
  (loop while 
        (let ((line (read-line)))
           (if (equal line "done")
               nil
               (print line))))) 
```

我希望它在用户结束行后回显用户的输入，除非他们输入了“完成”，在这种情况下它会停止。相反，它第一次回显一个空行，之后，它回显前一个的输入。例子：

```
* (echo-lines)
Hello, loop.

This is my second line.
"Hello, loop." 
This is my third.
"This is my second line." 
I'm almost done.
"This is my third." 
done
"I'm almost done." 
NIL 
```

预期的：

```
* (echo lines)
Hello, loop.
"Hello, loop."
done
NIL 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-18T22:46:23.283

该效果是由缓冲输出和`PRINT`.

`PRINT`如果底层输出流被缓冲，则不会导致立即写入输出。另请注意，*首先*`PRINT`打印换行符。请注意，对于可移植代码，您应该假设输出流是缓冲的。这意味着您需要确保在需要时写入缓冲输出。使用（不等待）和（等待）。*`FORCE-OUTPUT``FINISH-OUTPUT`*

 *这是一个稍微改写的版本。

```
(defun echo-lines ()
  (loop for line = (read-line)
        until (equal line "done")
        do
        (write-line line)
        (finish-output))) 
```*

# objective-c - 如何从 prepareForSegue 调用“自我”属性：？

> ID：13445343
> 
> 赞同：1
> 
> 时间：2012-11-18T22:35:59.100
> 
> 标签：objective-c, ios, properties, ios6, nsarray

我`@property`的应用程序的模型类中有一个将调用`prepareForSegue:`. 在我的`CalculatorBrain`课堂上是这样公开宣布的。

```
@property (readonly) id program. 
```

吸气剂看起来像这样：

```
- (id)program
{
    return [self.programStack copy];
} 
```

如果您需要知道，其中`programStack`一个存储用户输入的所有操作和操作数。`NSMutableArray @property``CalculatorBrain`

计算器的控制器是`CalculatorViewController`，我有一个大脑的私有财产（一个 CalculatorBrain）。在我所有的 CalculatorViewController 方法中，我都可以完美地调用`self.brain.program`. 但是当我尝试从我的`prepareForSegue:`方法中调用这个 getter 时，它会返回一个空数组。这是我在 CalculatorViewController 中的一个方法示例，它可以完美地调用 self.brain.program：

```
- (IBAction)enterPressed
{
    [self.brain pushOperand:[self.display.text doubleValue]];
    self.userIsInTheMiddleOfEnteringANumber = NO;

    // update history label
    NSArray *stack = self.brain.program; //This is to test self.brain.program
    self.history.text = [CalculatorBrain descriptionOfProgram:self.brain.program];
} 
```

如果我们在 self.history.text... 行设置断点检查值，我们会得到：

![在此处输入图像描述](../Images/711c99d9a542bd0aa04b5ba192544369.png)

没错，当时程序有 2 个对象。

现在这是我的`prepareForSegue:`方法：

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if ([segue.identifier isEqualToString:@"Graph"]) {
        GraphingCalcViewController *newController = segue.destinationViewController;
        // send program to newController
        NSArray *stack = self.brain.program; //This is to test self.brain.program
        newController.program = self.brain.program;
    }
} 
```

如果我们在 newController.program... 行设置断点，我们会得到：

![在此处输入图像描述](../Images/686c61f099d585373fc242ba40d4c9dc.png)

两个快照都来自同一次运行。所以我的问题是，为什么 self.brain.program 的值在 prepareForSegue: 调用时会有所不同？也许这是一个非常愚蠢的错误，但我无法发现它。我会很感激这里的一些帮助。我对iOS开发很陌生。

**更新：**问题似乎出在 programStack 上。在该方法发挥作用`niling`之前，它以某种方式出现了。`prepareForSegue:`所以当这个运行时，我们会得到新的空程序堆栈。其他一些方法（据我所知不是我的）正在清除它。

有人知道什么可能会在这里清理我的财产吗？我有两个`strong`指向`brain`（CalculatorViewController 中的CalculatorBrain *）和（CalculatorBrain 中的`programStack`NSMutableArray *）的指针。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T23:03:44.637

程序的 getter 使用您的`programStack`for 分配的复制方法，这需要`programStack`遵守`NSCopying`协议。真的`programStack`只是`NSMutableArray`吗？因为那确实服从`NSCopying`并且应该起作用。试试把副本拿出来？

更新：`self.brain`你的两个电话之间改变的价值是什么？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T05:04:10.220

我的 CS193 代码非常相似，我看到的主要区别是我传递了程序的副本而不是对同一对象的引用。所以试试这个：

```
newController.program = [self.brain.program copy]; 
```

# java - 如何在java中将文件读/写到硬盘驱动器排队？

> ID：13445345
> 
> 赞同：1
> 
> 时间：2012-11-18T22:36:02.303
> 
> 标签：java, multithreading, file-io, java-server

我有一台服务器，它接收来自数千个连接 tcp 套接字的客户端的请求，以从一个硬盘读取或写入数据。

我知道在这种情况下我需要一个线程来执行所有 HD file.IO 但是我如何将所有这些请求从套接字连接线程传递给一个主硬盘驱动器管理器，该管理器将按某种顺序完成这项工作并将数据转换为连接的套接字线程？

有没有办法以这种方式排队任务？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T22:40:47.697

当然，看看[生产者/消费者模式](http://javarevisited.blogspot.com/2012/02/producer-consumer-design-pattern-with.html)和`BlockingQueue`.

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-19T09:28:50.340

我不同意这里所说的，与使用数据并将其写入硬盘的管理器一起使用另一层是更好且更具可扩展性的方法，您将释放连接线程以完成其自然工作，并且您有一个管理器可以给出任何所需的命令，例如停止写入磁盘或写入分布式其他源，如果您只想完成任务，您可以选择每种方法，每次写入磁盘时内核明智，这些命令被解释为系统调用，这些系统调用将通过缓存检查现有数据块，直到它到达实际请求然后此请求与系统中的所有其他请求一起排队，并且其他一些磁盘线程将获取您的请求，这意味着您的连接线程可能不可用如果它正在等待响应，在那个时候，那个线程可以做一些工作。

# c# - WPF 中的 JSON 和二进制文件

> ID：13445355
> 
> 赞同：2
> 
> 时间：2012-11-18T22:37:02.313
> 
> 标签：c#, json, json.net

我通过以下代码在 WPF 中保存带有 JSON 的文本文件：

```
using (JsonWriter file = new JsonTextWriter(new StreamWriter("Test.txt")))
{
   file.Formatting = Formatting.Indented;
   file.WriteStartObject();
   file.WritePropertyName("TEST");
   file.WriteValue("test");
   file.WriteEndObject();
} 
```

该文件保存在以下结构中：

```
{
  "TEST": "test"
} 
```

我想将文件保存为二进制文件。

我需要在代码中添加/更改什么？

我尝试使用“JsonSerializer”对象和“Serialize()”函数而不是“WriteValue()”函数，但没有任何改变。

我会很高兴得到一个有效的示例代码。

谢谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T03:00:27.350

如果您想使用 JSON.NET 以二进制格式（例如 BSON，或“Binary JSON”）序列化 JSON，您可以使用[`BsonWriter`](http://james.newtonking.com/projects/json/help/index.html?topic=html/T_Newtonsoft_Json_Bson_BsonWriter.htm#)类而不是`JsonTextWriter`：

```
using (JsonWriter file = new Newtonsoft.Json.Bson.BsonWriter(new StreamWriter("Test.txt")))
{
   file.WriteStartObject();
   file.WritePropertyName("TEST");
   file.WriteValue("test");
   file.WriteEndObject();
} 
```

您还可以使用`JsonSerializer`该类，再次将`BsonWriter`代替传递`JsonTextWriter`给`Serialize`方法。

# google-app-engine - GAE 样板如何添加条款和隐私页面

> ID：13445357
> 
> 赞同：1
> 
> 时间：2012-11-18T22:37:09.173
> 
> 标签：google-app-engine, boilerplate

我正在尝试将使用条款和隐私页面添加到谷歌应用引擎样板。

我不知道如何在页脚上添加链接到新页面；我可以在其中粘贴条款和隐私文本。

我试图创建一个指向privacy.txt文件的下载链接（将txt文件放在样板/静态/img上）并且无法让它工作，我想我需要将链接添加到routes.py文件但是一个新的我无法让它工作。对此的任何帮助将不胜感激，谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T00:12:53.607

看看你的应用程序 yaml。在那里，您可以找到为什么您的 .txt 文件不会从 static/img 文件夹中提供的答案。

只需稍作改动，就可以从您的静态文件夹中提供它：

```
- url: /(privacy\.txt|robots\.txt|humans\.txt|crossdomain\.xml)
  static_files: static/\1
  upload: static/(privacy\.txt|robots\.txt|humans\.txt|crossdomain\.xml) 
```

或者创建您自己的静态文件夹来提供 txt 文件。请参阅 app.yaml 中的 img 示例

# ruby-on-rails - 为什么 SimpleForm 不适用于日期字段？

> ID：13445359
> 
> 赞同：2
> 
> 时间：2012-11-18T22:37:23.370
> 
> 标签：ruby-on-rails, ruby-on-rails-3, forms, date, simple-form

我正在使用 lasted `simple_form`gem 并遵循 simple_form 表单渲染错误：

`cant`t convert Symbol into String`

![在此处输入图像描述](../Images/a6cf29b8b06e49069ffbbc57af552864.png)

```
= simple_form_for @student, html: { multipart: true, class: 'form-horizontal' } do |f|
  = f.input :email, disabled: true
  = f.input :birthdate
  = f.input :address_number
  = f.input :address_street
  = f.button :submit, class: "btn btn-primary pull-right"

# == Schema Information
#
# Table name: students
#
#  address_number          :string(255)
#  address_postalcode      :string(255)
#  address_street          :string(255)
#  approved                :boolean          default(FALSE), not null
#  ask_counter             :integer          default(0)
#  authentication_token    :string(255)
#  birthdate               :date 
```

这是`edit`视图和`Student`：[https ://gist.github.com/ccbef8a0fb67a164efee](https://gist.github.com/ccbef8a0fb67a164efee)

我的 Gemfile：[https ://gist.github.com/00ec5a897a6cb88e0bab](https://gist.github.com/00ec5a897a6cb88e0bab)

gem github页面上的问题：[https ://github.com/plataformatec/simple_form/issues/695#issuecomment-10495237](https://github.com/plataformatec/simple_form/issues/695#issuecomment-10495237)

导轨：`3.2.8` SF：`2.0.3`

如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T00:58:17.483

该问题的解决方案在这里： [https ://github.com/plataformatec/simple_form/issues/695#issuecomment-10495237](https://github.com/plataformatec/simple_form/issues/695#issuecomment-10495237)

# javascript - Javascript textarea onclick

> ID：13445360
> 
> 赞同：-1
> 
> 时间：2012-11-18T22:37:29.193
> 
> 标签：javascript, jquery, dom

我正在尝试在 javascript 中创建一个文本区域，默认情况下显示三个随机的三位数字，并具有 onclick highlight all 属性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T22:49:44.507

使用 jquery，假设您的文本区域有 id txtArea：

```
$(document).ready(function() {

   var dig1 = Math.floor(100 + Math.random() * 899);
   var dig2 = Math.floor(100 + Math.random() * 899);
   var dig3 = Math.floor(100 + Math.random() * 899);
  $('#txtArea').val(dig1 + ' ' + dig2 + ' ' + dig3);

  $('#txtArea').unbind('click').click(function() {
     $(this).select();
  });
}); 
```

# python - Python - Kivy 框架 - Spinner 值列表

> ID：13445362
> 
> 赞同：2
> 
> 时间：2012-11-18T22:37:36.297
> 
> 标签：python, list, templates, spinner, kivy

我很难添加从数据库中提取的值（语言）列表，并希望它可以作为 Spinner 小部件中的值列表使用。

蟒蛇部分：

```
 def get_langs(self):
        session = Session()
        Base.metadata.create_all(engine)
        # get active language as text label:
        result1 = session.query(Language).filter_by(active = 1).first()
        self.label_lang.text = str(result1)
        # get all other languages as list of values:
        result2 = session.query(Language).filter_by(active = 0).all()
        self.label_lang.values = str(result2) 
```

kv模板部分：

```
Spinner:
    id: settings_lang
    size_hint: (None, None)
    width: 200
    height: 40
    padding_left: 20
    self: root.get_langs() 
```

我正在从我的数据库中提取一个值列表（通过 sqlalchemy），但是 kv 模板中的“值”属性只接受 str/unicode，因此是 str(result2)。但是，我得到的不是语言列表，而是该列表中的字符列表。

[ 英语 ，

德律风]

但我想将这些视为价值观：English Deutsch

任何人都可以建议吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T08:19:31.080

您正在将结果转换为单个字符串，而不是字符串列表。

```
self.label_lang.values = map(str, result2) 
```

可能是您想要的。

# ruby-on-rails - 搭建脚手架时建立关系

> ID：13445367
> 
> 赞同：39
> 
> 时间：2012-11-18T22:38:24.047
> 
> 标签：ruby-on-rails, ruby, scaffolding

嗨，我是 Ruby on Rails 的新手。我正在尝试创建一个小型博客站点。我有两张表帖子和评论。每个帖子都会有很多评论。我使用这些命令生成表。

```
rails g scaffold Post title:string body:text author:string
rails g scaffold Comment body:string author:string 
```

现在我想将关系添加到模型类。我添加`has_many :comments`到 Post 类和`belongs_to :post`Comment 类。但是，当我尝试调用时，`post.comments`我会收到运行时错误消息`SQLException: no such column: comments.post_id`。我应该创建一个迁移并在 Comment 下添加 post_id 还是有办法在搭建脚手架时实现这一点？

* * *

## 回答 #1

> 赞同：152
> 
> 时间：2014-10-03T10:07:21.320

Scaffold 实际上提供了一种生成关系的方法，你应该使用`:references`数据类型

```
rails g scaffold Comment body:string author:string post:references 
```

这将为带有 post_id 字段和索引的评论表生成迁移。生成器还将添加`belongs_to :post`到 Comment 模型中。

但是，它不会生成关系的反面，因此您需要添加

```
has_many :comments 
```

自己到 Post 模型。如果这是您需要的，您还需要添加嵌套资源路由，因为生成器无法处理此问题。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-11-18T22:44:50.607

你绝对是在正确的轨道上。如果您`post_id`在生成`Comment`脚手架时添加列，那么您的关系将起作用（尽管您仍然需要添加`has_many :comments`and `belongs_to :post`）

所以更新后的生成器调用如下所示：

```
rails g scaffold Comment body:string author:string post_id:integer 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-12-19T06:32:59.827

你也可以`belongs_to`这样使用：

```
rails g scaffold Comment body:string author:string post:belongs_to 
```

# excel - excel sum if string

> ID：13445368
> 
> 赞同：0
> 
> 时间：2012-11-18T22:38:27.683
> 
> 标签：excel

我有一个类似的表：

```
102938 bob
038128 Marc
398401 Tom
298421 Jim
102938 Alex
102938 Junior
209381 Rex
398401 Oby 
```

我想做一些`=sumif(A:A, 102938,B:B)`应该返回“bobAlexJunior”作为结果的东西。但这不起作用，因为`sum`适用于数字而不是字符串。如果我进行查找，它适用于字符串，但只找到第一行，而不是所有行。

你知道如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T23:00:27.823

这不一定特别优雅，但它可能是一个很好的起点。如果我正确理解您的要求，则可以归结为以下目标：

1.  确定特定行是否应包含在连接字符串中（例如，如果左列 = 102938）

2.  将第 2 列中的文本连接在一起（但仅适用于与条件匹配的那些行）

似乎 Excel 的 CONCATENATE 函数不接受范围（每个参数只有一个单独的单元格引用）。对于大量行，必须手动输入每个单元格显然会很烦人，因此我会考虑添加另一列以增量方式起作用。

例如，使用 A 列中的数字和 B 列中的名称创建第三列，该列将是累积连接字符串。

单元格 C1：

```
=IF(A1=102938,B1,"") 
```

单元格 C2：

```
=IF(A2=102938,CONCATENATE(C1, B2),C1) 
```

单元格 C3、C4 等向下重复 C2 的公式。

所以表格看起来像这样：

```
102938      bob     bob
38128       Marc    bob
398401      Tom     bob
298421      Jim     bob
102938      Alex    bobAlex
102938      Junior  bobAlexJunior
209381      Rex     bobAlexJunior
398401      Oby     bobAlexJunior 
```

然后只需选择最后一行作为您的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T22:56:00.103

有两个简单的解决方案：

1）在第三列写一个简单的VLOOKUP公式并拖动它。然后您可以选择全部然后您可以使用第 4 列并通过使用对当前元素的第 3 列的引用来连接所有元素，并与第 4 列的前一个元素连接。

2) 使用 VBA，在第一列上使用 Range.Find() 并将其右侧的单元格添加到临时变量并返回它。

如果可能的话，使用单一公式会更加困难。我已经使用数组公式快速尝试了它并且无法成功（尽管我没有说这是不可能的）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-19T00:59:36.840

这是另一种方法，考虑到您对我的另一个答案的评论（您在其中描述有两张纸，一张包含带有代码的名称列表，一张包含唯一代码列表，每张都有一个串联的名称列表） .

您可以创建一个自定义函数，该函数接受范围和代码并返回连接的名称字符串。

将以下 VBA 粘贴到模块中（如果您不熟悉创建自定义函数，请参阅[此链接）：](http://office.microsoft.com/en-gb/excel-help/creating-custom-functions-HA001111701.aspx)

```
Function NamesWithCode(PeopleCodes As Range, CodeToMatch As String)
    Dim Result As String
    For Each Row In PeopleCodes.Rows
        If Row = CodeToMatch Then
            Result = Result & Row.Offset(0, 1)
        End If
    Next
    NamesWithCode = Result
End Function 
```

假设您的第一个工作表称为“名称”，并且有两列，如您指定的：

```
102938  bob
38128   Marc
398401  Tom
298421  Jim
102938  Alex
102938  Junior
209381  Rex
398401  Oby 
```

在第二个工作表（例如“代码”）中，您可以使用新的 NamesWithCode 函数来查找每个代码的名称列表，方法是传入第一个工作表中的完整表以及查找每一行的代码：

```
=NamesWithCode(Names!$A$1:$A$8, A2) 
```

所以输出将是：

```
Code    Names With Code
102938  bobAlexJunior
38128   Marc
398401  TomOby
298421  Jim 
```

# php - 使用简单的 HTML DOM 循环遍历表

> ID：13445371
> 
> 赞同：2
> 
> 时间：2012-11-18T22:38:42.987
> 
> 标签：php, dom, web-scraping, html-table, simple-html-dom

我正在使用 Simple HTML DOM 从 HTML 文档中提取数据，并且有几个问题需要帮助。

1.  在以我想分别提取href和锚节点的内容开头的行上`if ($td->find('a'))`，并将它们放在单独的变量中。但是该代码不起作用（请参阅下面代码中的回显输出）。

    做这个的最好方式是什么？请注意，我的目的是稍后根据这些信息创建一个 XML 文档，因此我需要以正确的顺序获取信息。

2.  这些链接指向包含有关不同汽车的详细信息（例如“最大速度”、“价格”等）的页面，我还想提取这些信息并将其放入单独的变量中。如何获取这些页面上的数据？

    ```
    <?php
    include 'simple_html_dom.php';

    $html = new simple_html_dom();
    $html = file_get_html('http://www.example.com/foo.html');

    $items = array();

    foreach ($html->find('table') as $table) {
        foreach ($table->find('tr') as $tr) {

            foreach ($tr->find('td') as $td) {

                if ($td->find('a')) {
                    $link = $td->find('a.href');
                    echo $link;  // empty

                    $text = $td->find('a.text');
                    echo $text; // Array
                }
                else {
                    echo 'Name: ' . $td;
                }
            }
        }
    } 
    ```

HTML 文档如下所示：

```
<div>
    <table>
        <tr>
            <td>
                <a href="car1.html" target="_blank">Car 1</a>
            </td>
            <td>
                Porsche
            </td>
        </tr>
        <tr>
            <td>
                <a href="car2.html" target="_blank">Car 2</a>
            </td>
            <td>
                Chrysler
            </td>
        </tr>
        ... and so on... 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-18T22:43:16.177

在第一种情况下使用`$td->find('a', 0)->href`and`$td->find('a', 0)->innertext`访问元素属性，在第二种情况下使用内容。此外，如果可能要找到多个锚点，请使用 0 作为安全防护，以始终获取第一个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-18T22:43:40.503

`'a.href'`是用于查找具有 CSS 类的锚标记的选择器`href`。不获取锚标签的 href 属性。你可以这样做：

```
$link = $td->find('a', 0);
$href = $link->href; 
```

# google-maps-api-3 - 使用数组在谷歌地图中添加监听器

> ID：13445372
> 
> 赞同：0
> 
> 时间：2012-11-18T22:39:03.593
> 
> 标签：google-maps-api-3

我有一个关于使用数组将侦听器添加到谷歌地图 api 中的标记的问题。似乎我们不能直接使用迭代来添加监听器，但可以调用一个函数来做到这一点。我在互联网上搜索，发现这是一个范围问题。但我不明白这是什么原因。谁能给我一个清楚的解释？谢谢！

```
works version
function updateM(m) {
google.maps.event.addListener(m, 'click', function() {
  infowindow.open(map,m);
  });
}
for(i=0;i<2;i++)
{
marker[i].setMap(map);
updateM(marker[i]);
}

and 

do not work version
for(var i=0;i<2;i++)
{
marker[i].setMap(map);
google.maps.event.addListener(marker[i], 'click', function() {
  infowindow.open(map,marker[i]);
  });
}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T08:16:23.883

在 JavaScript 中没有`block`作用域，只有`function scope`存在。因此，通过将代码包装`addListners`在一个新函数中，您可以确保 的值`"i"`保持您的预期。

# objective-c - 无法为 UIImage 创建新的插座连接

> ID：13445373
> 
> 赞同：1
> 
> 时间：2012-11-18T22:39:17.047
> 
> 标签：objective-c, ios, xcode4.5

我有一个 iPad 应用程序，使用 Storyboards，XCode 4.5。在我的一个场景中，我有一个 UIImage，我正在尝试创建一个 @property 并与之建立连接。所以我做了一个从 UIImage 到 .h 文件的 CTRL 拖动。我已经多次清理了应用程序（CMD+OPTION+K），并收到以下消息： ![在此处输入图像描述](../Images/d28a3807e824a5bb5ea2b638a74f16d9.png)

我以前从来没有遇到过这个问题。首先，这是什么原因造成的，其次，我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T22:51:57.780

尝试删除此应用的派生数据。

1) 关闭项目，但保持 Xcode 处于打开状态。

2) 转到 Xcode 的 Organizer 并选择 Projects 窗格。

3）删除项目的派生数据（如果第一次删除后它没有消失，请再试一次）。

4) 关闭/重启 Xcode，再做一次“清理”，然后再试一次。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T22:45:33.613

发生在我身上一次。

1.  关闭并重新打开 Xcode
2.  确保将 Nib 文件类正确设置为适当的类名

# javascript - 您可以将哪些库用于 ViewModel 与 Backbone.js 的绑定？

> ID：13445375
> 
> 赞同：0
> 
> 时间：2012-11-18T22:39:43.207
> 
> 标签：javascript, backbone.js

我想使用一个库来自动绑定 Backbone.js 中的视图和模型。当输入元素被修改时，我希望它修改视图中的相应属性等。你喜欢什么库来做这件事？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T03:58:10.427

这正是`ModelBinder`它的用途。我经常使用它，对这个项目非常满意。你可以在[这里](https://github.com/theironcook/Backbone.ModelBinder)找到它。

# python - 忽略 Python 中返回的元组的一部分？

> ID：13445377
> 
> 赞同：1
> 
> 时间：2012-11-18T22:40:09.783
> 
> 标签：python, tuples

使用以下代码，有没有办法指定我不关心返回的元组的“地址”部分？

```
(data, address) = socket.recvfrom(512) 
```

理想情况下，我想做这样的事情：

```
data = socket.recvfrom(512) 
```

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T22:42:02.953

```
data = socket.recvfrom(512)[0] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-18T22:43:01.297

选项一，只需抓住您感兴趣的元素：

```
data = socket.recvfrom(512)[0] 
```

选项二，使用一个告诉读者你不在乎的词：

```
data, dummy = socket.recvfrom(512) 
```

# gnuplot - 将关键标签放在行尾旁边

> ID：13445379
> 
> 赞同：3
> 
> 时间：2012-11-18T22:40:34.240
> 
> 标签：gnuplot

对于一个参数的不同值，我的绘图中有很多行，从 2 到 23 不等。发明不同的线条样式并将它们放在图例中是相当不方便且难以阅读的。

相反，我想在它们的结尾处标记线条，以便清楚地知道什么线是什么参数编号以及参数增长方向是什么。然后可以将所有线条绘制成纯黑色线条并打印黑白，而不会造成任何可读性损失。

在gnuplot中可以吗？任何版本都可以使用，没关系。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-18T23:08:00.877

这可以在 gnuplot 的[cvs 版本（4.7.0）](http://gnuplot.sourceforge.net/development/index.html)中使用命令

```
plot file title 'my beautiful data' at end 
```

之后调整边距可能会有所帮助

```
set rmargin XX 
```

因为标签将位于绘图区域的右侧，并且可能会超出图像的边缘。（gnuplot 还没有非常智能的标签放置/边距调整。）

另请参阅我的类似问题/答案[here](https://stackoverflow.com/questions/12409068/titles-next-to-lines-in-gnuplot)和[here](https://stackoverflow.com/questions/12808910/gnuplot-print-legend-directly-next-to-individual-graphs/12809441#12809441)。

# c# - asp.net asp:DropDownList onSelectedIndexChanged 未在数据绑定 asp:GridView 中触发

> ID：13445390
> 
> 赞同：0
> 
> 时间：2012-11-18T22:43:14.253
> 
> 标签：c#, asp.net, events, gridview, databound

我遇到了麻烦，我无法弄清楚。我有一个数据绑定的 asp:gridview (sqldatasource)，在 itemtemplate 中有一个 asp:dropdownlist。下拉列表有一个 onSelectedIndexChanged 事件侦听器，但它不会触发。

这是标记：

```
<asp:ScriptManager ID="ScriptManager1" runat="server">

</asp:ScriptManager>
<asp:UpdatePanel runat="server" ID="UpdatePanel1">
    <ContentTemplate>
    <asp:GridView ID="GridView1" runat="server" AutoGenerateColumns="False" 
        EmptyDataText="There are no data records to display." EnableViewState="True" >
        <Columns>
            <asp:TemplateField HeaderText="Delete user">
                <ItemTemplate>
                    <asp:Button runat="server" ID="btnDelete" CommandName="Delete" CommandArgument='<%# Eval("UserId") %>'
                        Text="Delete" OnCommand="DeleteUser" />
                </ItemTemplate>
            </asp:TemplateField>
            <asp:TemplateField HeaderText="Block users">
                <ItemTemplate>
                    <asp:Button runat="server" ID="btnBlock" CommandName="Block" CommandArgument='<%# Eval("UserId") %>'
                        Text="Block" OnClick="btnBlock_Click" Visible='<%# !Convert.ToBoolean(Eval("IsLockedOut")) %>' />
                    <asp:Button runat="server" ID="btnDeblock" CommandName="Deblock" CommandArgument='<%# Eval("UserId") %>'
                        Text="Deblock" OnClick="btnBlock_Click" Visible='<%# Convert.ToBoolean(Eval("IsLockedOut")) %>' />
                </ItemTemplate>
            </asp:TemplateField>
            <asp:TemplateField HeaderText="Change role">
                <ItemTemplate>
                    <asp:DropDownList ID="ChangeRole" runat="server" EnableViewState="false"
                        OnSelectedIndexChanged="ChangeRole_SelectedIndexChanged" AutoPostBack="true"
                        ToolTip='<%# Bind("UserName") %>' >
                        <asp:ListItem Text="Choose a role" Value="" Selected="True" />
                        <asp:ListItem Text="Admin" Value="" />
                        <asp:ListItem Text="Member" Value="" />
                        <asp:ListItem Text="Visitor" Value="" />
                    </asp:DropDownList>
                </ItemTemplate>
            </asp:TemplateField>
            <asp:BoundField DataField="RoleName" HeaderText="Current role" ReadOnly="true" SortExpression="RoleName" />
            <asp:BoundField DataField="UserName" HeaderText="Username" ReadOnly="True" SortExpression="UserName" />
            <asp:BoundField DataField="Email" HeaderText="Email" SortExpression="Email" />
            <asp:BoundField DataField="LastLoginDate" HeaderText="Last login" 
                SortExpression="LastLoginDate" />
            <asp:CheckBoxField DataField="IsLockedOut" HeaderText="Locked" 
                SortExpression="IsLockedOut" />
            <asp:BoundField DataField="FailedPasswordAttemptCount" 
                HeaderText="Failed logins" 
                SortExpression="FailedPasswordAttemptCount" />
            <asp:BoundField DataField="Comment" HeaderText="Comments" 
                SortExpression="Comment" />
        </Columns>
    </asp:GridView>
    <asp:Label ID="lblSuccess" runat="server" Text="Database updated successfully." Visible="false" meta:resourcekey="success" />
    <asp:Label ID="lblError" runat="server" Text="An error occured, database was not updated." />
    </ContentTemplate>
</asp:UpdatePanel> 
```

我添加了更新面板代码，因为我认为它可能是相关的。在后面的代码中，我确保仅在 !Page.IsPostBack

```
protected void Page_Load(object sender, EventArgs e)
{

    if (!Page.IsPostBack)
    {
        GridView1.DataSourceID = "SqlDataSource1";
        GridView1.DataKeyNames = new String[] {"UserId"};
        GridView1.DataBind();
    }
} 
```

然后我为下拉列表制作了一个动作监听器

```
protected void ChangeRole_SelectedIndexChanged(object sender, EventArgs e)
{
    Logger.Info("it's alive!", "Chaning role");
} 
```

我已经在两个方向上尝试了 enableViewState="True || False" （对于 gridview 和下拉列表）和 autoPostBack="True || False" 但日志文件没有显示“它还活着”消息。更改索引时未触发该事件。

有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-19T02:00:21.083

好的，

我终于找到了解决方案。搜索互联网表明这不是一个不常见的问题。然而，解决方案永远不会太远。

首先，我将页面上的所有内容（包括页面指令、gridview、updatetemplate 和下拉列表）更改为 EnableViewState="true"，然后在下拉列表中设置 AutoPostBack="true"，最后，我需要确保我不是在 page_load 方法中将 gridview 与其数据绑定，因为生命周期中的这个阶段已经重新绑定下拉列表并将其 selectedindex 设置回默认值，然后才能触发 onselectedindexchanged 事件。

我只是让gridview像往常一样通过设置它的datasourceid来进行绑定。在我的搜索过程中，我看到很多人有类似的问题，我认为这应该可以解决很多问题。或者至少值得一试:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-09-12T09:03:20.513

就像你说的，这不是一个罕见的问题。我自己也遇到了同样的问题，因此我想提供一份清单以排除一些更常见的问题：

*   确保 ViewState 已激活，`EnableViewState="True"`
*   如果上述点不起作用，还请检查是否有任何父元素禁用了 ViewState
*   激活回帖`AutoPostBack="True"`
*   确保您的 dababining***仅***在它不是回发时发生`if(!Page.IsPostBack)`，ViewState 将保存所选选项并为您的表单（如果您有一个）

这就是我现在能想到的：）希望它对任何人都有帮助！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-19T01:06:36.733

您是否尝试过将 DropDownList 的视图状态更改为“true”：

`<asp:DropDownList ID="ChangeRole" runat="server" EnableViewState="true" OnSelectedIndexChanged="ChangeRole_SelectedIndexChanged" AutoPostBack="true" ...`

如果在回发之间忘记下拉状态，则索引不会更改，因此 SelectedIndexChange 事件不会触发。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-19T13:24:54.117

为 DropDownList设置`AutoPostBack="true"`。

并将更新面板的更新模式设置为总是这样

```
<asp:UpdatePanel runat="server" ID="UpdatePanel1" UpdateMode="Always"> 
```

或者设置一个触发器来处理 DropDownList 的 SelectedIndexChanged 事件。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-02-10T13:49:33.470

这解决了我的问题：`CausesValidation="False"` [这](https://i.stack.imgur.com/6CpH3.png)是详细信息。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-18T23:05:12.413

**尝试像这样更改 GridView**

```
<asp:GridView ID="GridView1" runat="server" AutoGenerateColumns="False" EmptyDataText="There are no data records to display." EnableViewState="True" DataSource="SqlDataSource1" DataKeyNames="UserId" > 
```

**清除 Page_Load 函数**

```
protected void Page_Load(object sender, EventArgs e)
{
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-06-28T08:03:22.423

虽然这是一篇旧文章，但我希望它仍然有帮助。

我遇到了同样的问题，对我来说，解决方案是为 ListItems 的“Value”属性设置值。所以修改代码如下：

```
<asp:DropDownList ID="ChangeRole" runat="server" EnableViewState="false" 
OnSelectedIndexChanged="ChangeRole_SelectedIndexChanged" AutoPostBack="true"                       ToolTip='<%# Bind("UserName") %>' >
<asp:ListItem Text="Choose a role" Value="0" Selected="True" />
<asp:ListItem Text="Admin" Value="1" />
<asp:ListItem Text="Member" Value="2" />
<asp:ListItem Text="Visitor" Value="3" />
</asp:DropDownList> 
```

希望这会对某人有所帮助。

# r - 如何使用 stargazer 或 xtable 省略交互？

> ID：13445400
> 
> 赞同：5
> 
> 时间：2012-11-18T22:44:11.693
> 
> 标签：r, latex, regression, knitr, xtable

`omit`是否可以使用该选项省略观星者中的交互？通常我会将变量名写入 中，`omit=c('varname')`但在交互的情况下我不知道该写什么。有什么提示吗？你如何在其他包中解决这个问题`xtable`？

```
\documentclass{article}   
\begin{document}   
%Load dataset and run regression    

 << lm, echo=FALSE >>=   
 load('dataset.RData')  
 library(stargazer)  
 lm1 <- lm(y~ x + factor(v)*z ,data=dataset)  
 @

 << table_texstyle, echo=FALSE, comment=NA, results='asis' >>=  
 stargazer(lm1 ,omit=c('???'), omit.labels=c('Omitted interactions'),
      omit.yes.no = c("Yes", "No")))  
  @  
   \end{document} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-19T10:56:56.950

如果您想省略所有交互，请尝试

```
stargazer(m1, omit = ":") 
```

这是有效的，因为`omit`参数需要一个正则表达式。这是过滤字符串时非常强大的工具。在 Stackoverflow 上查看`?regexpr`或浏览此处的选项卡。`regex`

# algorithm - 具有 2 个属性的背包算法。如何在 3d 数组中实现它？

> ID：13445402
> 
> 赞同：6
> 
> 时间：2012-11-18T22:44:36.637
> 
> 标签：algorithm, dynamic-programming, knapsack-problem

当有超过 1 个财产时，我在理解背包问题时遇到了问题。当有 1 个属性时，

我必须编写一个使用具有 2 个属性的背包算法的程序。老师告诉我们，它必须在一个 3d 数组中完成。错误的实现将导致 O(2^n) 处理时间。我无法想象这样的阵列会是什么样子。

假设这是我的输入：

```
4 3 4 // number of records below, 1st property of backpack, 2nd property  of backpack
1 1 1 // 1st property, 2nd property, cost
1 2 2 // 1st property, 2nd property, cost
2 3 3 // 1st property, 2nd property, cost
3 4 5 // 1st property, 2nd property, cost 
```

输出看起来像这样：

```
4    // the cheapest sum of costs of 2 records
1 3  // numbers of these 2 records 
```

输出说明： 2 组记录适合第一行输入：

(1) - 记录号 1 和记录号 3

```
 1 1 1
+ 2 3 3
-------
  3 4 4 
```

(2) - 记录号 4

```
 3 4 5 
```

因为第一组记录是最便宜的（4 < 5），所以我们选择了它。我不仅要查明是否存在这样的记录集，还要找到我总结的记录。

但现在，我只需要了解 3d 数组会是什么样子。你们中的一些人能帮我解决这个问题，并像我的形象一样，一层一层地展示，这会是什么样子？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T02:14:57.317

从用动态规划求解一约束背包问题的算法转换为求解二约束问题是很容易的。对于有人绘制 3d 图像来向您展示那里正在发生的事情，我想这有点困难。另一方面，该算法非常简单：

我假设您想要一个精确匹配的解决方案，并且您想要最小化成本，而不是最大化价值（我从您的示例中得出）。我以前没有做过这些变化，所以我不能保证没有错误。

**1-约束**

1-约束背包问题的矩阵`(item x weight)`存储每个位置的值。

该算法基本上是：

```
// WL = backpack weight limit
A[0, 0] = 0
for w = 1, 2, ..., WL // weight
  A[0, w] = INFINITY
for i = 1, 2, ..., n // items
  for w = 0, 1, ..., WL // weight
    // wi and ci are the weight and cost of the item respectively
    // A[i-1, w-wi] + ci = 0 when wi > w
    A[i, w] = min(A[i-1, w], A[i-1, w-wi] + ci) 
```

**2-约束**

现在将此扩展到包含另一个约束只是：（假设`size`是另一个约束）

矩阵将是`(item x weight x size)`。

```
// WL = backpack weight limit
// SL = backpack size limit
for w = 0, 1, ..., WL // weight
  for s = 0, 1, ..., SL // size
    A[0, w, s] = INFINITY
A[0, 0, 0] = 0
for i = 1, 2, ..., n // items
  for w = 0, 1, ..., WL // weight
    for s = 0, 1, ..., SL // size
      // wi, si and ci are the weight, size and cost of the item respectively
      // A[i-1, w-wi, s-si] + ci = 0 when wi > w or si > s
      A[i, w, s] = min(A[i-1, w, s], A[i-1, w-wi, s-si] + ci) 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-11-27T09:14:49.653

你正在尝试做一些不可能的事情——那是你的问题。

当您增加维度数量时，您的项目将获得额外的属性。`prop1`因此，您可以使用矩形边 ( `prop1`x `prop2`) 或块边`(prop1`x `prop2`x`prop3`等等，而不是表格的左侧列边 ( )。但是现有的约束，定义表的上排侧，应该具有相同的维度数。**不止一维！**. 因此，您**永远**无法将二属性问题放入 3 维块中，而需要 4D 块。3 个属性的 6D 块等等。

# ruby-on-rails - DragonFly 附件和 BackBone.js

> ID：13445404
> 
> 赞同：0
> 
> 时间：2012-11-18T22:44:46.947
> 
> 标签：ruby-on-rails, ruby-on-rails-3, backbone.js, dragonfly-gem

我正在尝试使用 BackBone.js 将图像附加到模型中，在 Rails 中一切正常。

但是对于 BackBone.js，我不知道如何附加图像，例如在显示模板中显示它。

正如你将在我得到的要点中看到的那样 `None of the functions registered with #<Dragonfly::Analyser:0x000000028e2d60> were able to deal with the method call format(<Dragonfly::TempObject data="img2.jpg" >). You may need to register one that can.`

这是我在 BB.js 模板中使用的形式：

```
<form id="new_album" enctype="multipart/form-data">
  <input type="text" name="name" id="new_album_name">
  <input type="file" name="cover_image" id="new_album_cover_image" >
  <input type="submit" value="Add">
</form> 
```

这就是我得到的：[https ://gist.github.com/4105311](https://gist.github.com/4105311)

这是 GitHub 上的完整仓库：[https ://github.com/enricostano/FullstackAlbum](https://github.com/enricostano/FullstackAlbum)

编辑

添加[remotipart](https://github.com/JangoSteve/remotipart) gem并像这样更改表格

```
<form id="new_album" method="post" enctype="multipart/form-data" data-remote="true" data-type="json">
  <input type="text" name="name" id="new_album_name">
  <input type="file" name="cover_image" id="new_album_cover_image" >
  <input type="submit" value="Add">
</form> 
```

我现在得到这个 Rails 日志

```
Started POST "/api/albums" for 127.0.0.1 at 2012-11-19 11:06:20 +0100
Processing by AlbumsController#create as JSON
  Parameters: {"name"=>"caricati", "cover_image"=>"img2.jpg", "album"=>{"cover_image"=>"img2.jpg", "name"=>"caricati"}}
   (0.1ms) begin transaction
None of the functions registered with #<Dragonfly::Analyser:0x0000000265c550> were able to deal with the method call format(<Dragonfly::TempObject data="img2.jpg" >). You may need to register one that can.
  SQL (0.5ms) INSERT INTO "albums" ("cover_image_uid", "created_at", "name", "updated_at") VALUES (?, ?, ?, ?) [["cover_image_uid", "2012/11/19/11_06_20_434_file"], ["created_at", Mon, 19 Nov 2012 10:06:20 UTC +00:00], ["name", "caricati"], ["updated_at", Mon, 19 Nov 2012 10:06:20 UTC +00:00]]
   (256.8ms) commit transaction
Completed 201 Created in 303ms (Views: 1.8ms | ActiveRecord: 257.4ms)
cache: [POST /] invalidate, pass

Started POST "/" for 127.0.0.1 at 2012-11-19 11:06:20 +0100
Processing by AlbumsController#index as JSON
  Parameters: {"cover_image"=>#<ActionDispatch::Http::UploadedFile:0x007f95e878c1b8 @original_filename="img2.jpg", @content_type="image/jpeg", @headers="Content-Disposition: form-data; name=\"cover_image\"; filename=\"img2.jpg\"\r\nContent-Type: image/jpeg\r\n", @tempfile=#<File:/tmp/RackMultipart20121119-5822-hq8kbi>>, "name"=>"caricati", "remotipart_submitted"=>"true", "X-Requested-With"=>"IFrame", "X-Http-Accept"=>"application/json, text/javascript, */*; q=0.01"}
WARNING: Can't verify CSRF token authenticity
  Album Load (0.2ms) SELECT "albums".* FROM "albums"
Completed 200 OK in 2ms (Views: 1.0ms | ActiveRecord: 0.2ms) 
```

当我上传文件时 DragonFly 在文件系统 2 文件中创建： `12_37_59_129_file`和`12_37_59_129_file.meta`

第一个（应该是我上传的文件）包含我刚刚上传的文件的名称。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T23:52:21.640

看起来实际的文件数据没有被提交，因为您通过 Backbone 使用 AJAX 而不是常规的表单提交。如果您想以这种方式提交文件数据，您应该考虑使用`FileReader`API 之类的东西或`iframe`模拟 AJAX 的方法。

# android - 有没有办法获取安卓应用的通话/短信统计信息？

> ID：13445408
> 
> 赞同：2
> 
> 时间：2012-11-18T22:45:11.163
> 
> 标签：android

我和我的团队正在制作一个基本上是地址簿的 Android 应用程序。我们想添加很酷的统计信息，例如您收到的最长文本，以及您收到/发送的所有文本中有多少条文本，以及与通话相同的文本。我找不到访问信息的方法。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T02:17:14.467

您可以在 SMS/MMS ContentProvider 中找到所有文本统计信息。并且所有通话统计数据也可以在各自的提供商中找到。如果您想实时了解任何更新，请使用内容观察器来侦听相应数据库中的更新。否则，只需在需要时读取数据。

[http://developer.android.com/reference/android/content/ContentProvider.html](http://developer.android.com/reference/android/content/ContentProvider.html)

[http://developer.android.com/reference/android/database/ContentObserver.html](http://developer.android.com/reference/android/database/ContentObserver.html)

此信息应该可以帮助您入门：

```
ContentResolver cr = getContext().getContentResolver();
Cursor cur = null;
//This is a query for SMS database
cur = cr.query(Uri.parse("content://sms"), projection, where,values, sortOrder);

//Do whatever you want with the result 

cur.close();
// This query works with MMS data
cur = cr.query(Uri.parse("content://mms"), projection, where, values, sortOrder);

//Process MMS results

cur.close();

//Ask for Call statistics
cur = cr.query(CallLog.Calls.CONTENT_URI, projection, where,values, sortOrder);

//Process the call statistics
cur.close(); 
```

数据库包含许多不同的字段，您可以使用这些字段来计算所需的统计数据。我建议先转储数据库的内容，然后查看字段以了解给出的信息。然后，您可以开始创建复杂的 SQL 查询并进行必要的计算。

# c++ - 如何将整数存储在字符数组的单个索引中？

> ID：13445409
> 
> 赞同：-2
> 
> 时间：2012-11-18T22:45:15.200
> 
> 标签：c++, arrays, visual-c++, atoi, itoa

我想将单个整数存储在字符数组的单个索引中。在这种情况下，该`itoa`功能不起作用。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-18T22:50:01.523

如果您的意思是要将整数用作字符值并将其放入数组中，那么它只是

```
array[index] = number; 
```

如果您的意思是要将一位数的值写入数组的特定索引，那么

```
if (number >= 0 && number < 10) {
    array[index] = '0' + number;
} else {
    // not representable by a single digit
} 
```

**更新**：根据您的评论，这可能是您想要的。

如果您的意思是要将数字的十进制表示形式写入数组（涵盖多个字符元素，而不仅仅是一个），请不要使用`itoa`，因为这是不标准且危险的。`snprintf`可以更安全地做到这一点：

```
if (snprintf(array, array_size, "%d", number) >= array_size) {
    // the array was too small
} 
```

或者，由于这是 C++，您可以使用它`std::string`来为您管理内存并确保数组足够大：

```
std::string string = std::to_string(number); 
```

或者，如果您遇到过时的 C++ 库

```
std::ostringstream ss;
ss << number;
std::string string = n.str(); 
```

如果你的意思是别的，那么请澄清。

# java - 如何制作安卓下载事件？

> ID：13445414
> 
> 赞同：0
> 
> 时间：2012-11-18T22:45:48.693
> 
> 标签：java, android

我想制作在浏览器尝试开始新下载时看到的应用程序。我怎样才能做到这一点？在他这样做之前，我想获取 url 下载链接，保存链接，然后取消下载。

我试图搜索，但我没有找到任何东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T02:35:59.880

你不能强迫这一点，你也不应该这样做。您可以做的是让您的应用程序可以打开文件类型。用户得到标准的“你希望使用什么程序”对话框，用户可以选择一些默认值。

但下载将始终在下载对话框中进行。控制它的唯一方法是在您的应用程序中进行

# java - 读取外部日志文件而不创建文件锁

> ID：13445415
> 
> 赞同：2
> 
> 时间：2012-11-18T22:46:03.000
> 
> 标签：java, file, filelock, randomaccessfile

尝试逐行读取日志文件（在 Java 中）。另一个进程（非 java 程序）正在同时写入此日志文件。

我有两种方法-

1.  BufferedReader (BufferedReader br = new BufferedReader(new FileReader(logFile));)
2.  RandomAccessFile (RandomAccessFile accessFile = new RandomAccessFile(logFile.getAbsolutePath(), "r");)

这两种方法是否都会导致文件被锁定，直到我在 BufferedReader/RandomAccessFile 对象上调用“关闭”方法？

是否有任何其他方式（Java）以不为其他进程/程序锁定/阻止文件的方式读取文件？

PS - 在我所有的搜索中，我遇到了这个问题的多个答案/解决方案（旧的和新的）。我只是想就这个问题寻求澄清/结束。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-18T23:12:09.297

看看这个：[Java：打开和读取文件而不锁定它](https://stackoverflow.com/questions/2537306/java-opening-and-reading-from-a-file-without-locking-it)

如果非 Java 进程在写入时对文件具有排他锁，则其他进程可能无法读取它。当然，这可能会因操作系统而略有不同。当非 Java 进程运行时，您可能想查看操作系统对文件锁定的说明。

如果共享锁可用，则 java.nio 可能允许对锁定行为进行更多控制：http: [//docs.oracle.com/javase/7/docs/api/java/nio/channels/FileChannel.html](http://docs.oracle.com/javase/7/docs/api/java/nio/channels/FileChannel.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T23:43:16.743

BufferedReader 在性能方面比 RandomAccessFile 更可取，但它们都不会锁定文件，除非操作系统为您这样做，在这种情况下关闭文件将释放它。

但是，如果其他人正在写入文件，操作系统也可能会完全阻止您读取文件。

在另一个进程写入时读取顺序文件不是好的设计。您根本不应该真正阅读日志文件。日志文件是供人类使用的。您应该使用数据库。

# css - 将 div 扩展到页面底部

> ID：13445417
> 
> 赞同：4
> 
> 时间：2012-11-18T22:46:11.310
> 
> 标签：css

当浏览器视口高于页面内容时，我在将具有渐变背景（嵌套在 body 标记中）的 div 扩展到页面底部时遇到问题。

我知道我可以将我的 html、body 和相应的 div 标签设置为 100%，但是当我这样做时，div 标签的高度等于 html 和 body 标签的高度，这是由视口的大小设置的。这要么在其中包含的内容下方的 div 中创建太多空间（如果视口太大），即使视口不高于页面。或者它会切断 div 中的内容，并且视口不会向下滚动（如果视口的大小太小）。

您可以在[matthewelliot.com](http://www.matthewelliot.com)上查看该问题。如果你缩小到 25%，一旦内容填充了#addition-gradient div，你会看到底部的白色渐变会进入背景图像。你可能会问，那么谁会缩小这么远呢？但是当我在 iPhone 上拿着它“肖像”访问该网站时，我注意到了这个问题，我相信很多其他人都会有同样的经历。

如果您需要更多代码来帮助诊断，请告诉我！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T03:33:21.797

您正在寻找的是一个粘性页脚：

```
* {
    margin: 0;
}
html, body {
    height: 100%;
}
.wrapper {
    min-height: 100%;
    height: auto !important;
    height: 100%;
    margin: 0 auto -142px; /* the bottom margin is the negative value of the footer's height */
}
.footer, .push {
    height: 142px; /* .push must be the same height as .footer */
} 
```

请看看这个：[https ://stackoverflow.com/a/3525675/1700554](https://stackoverflow.com/a/3525675/1700554)

**编辑：**

尝试这个：

在 body 标记之后创建一个新的 DIV，如下所示：

```
<body>
<div class="body2">
PUT ALL OTHER DIVs AND CONTENT IN HERE.
</div>
</body> 
```

对于这样的 CSS：

```
body {
    background-color: #FFFFFF;
}   
.body2 {
    background-image: url(../_images/bg/bedge_grunge.png);
    background-repeat: repeat;
    background-attachment: fixed;
} 
```

正如您在此 jsfiddle 中看到的结果（使用您的原始内容减去 css 和图像）： http: [//fiddle.jshell.net/zbaBZ/show/](http://fiddle.jshell.net/zbaBZ/show/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T22:54:26.470

快速而肮脏的解决方法是将您的高级 div（title_bar、nav_bar 等）放在包装器 div 中，将背景应用于包装器，并将主体背景设为白色。但我确信有一个纯粹的 CSS3 解决方案。我会试着找到它。

# oop - Infinite recursion when instantiating object

> ID：13445422
> 
> 赞同：0
> 
> 时间：2012-11-18T22:47:51.543
> 
> 标签：oop, recursion

I have two classes, Class A and Class B.

Class A has an ArrayList of objects Class B.

Each Class B object has an attribute that stores a Class A object.

So when I create a Class A object, it populates the ArrayList of objects Class B. Each object Class B creates an object Class A (same as the one that is being populated), which creates an ArrayList of objects Class B... and so on.

What should I do to avoid this infinite recursion?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T22:53:36.740

**This should fix infinite recursion:** (Java assumed)

```
Class A {

  private ArrayList<B> list = new ArrayList<B>();
  A(){ 
    while(someCondition) {
      list.add(new B(this));
    }
  }
}

Class B {

  private A attribute;
  B(A inRef){ 
    attribute = inRef;
  }
} 
```

Note that `B`'s `attribute` field is not assigned using `new` but by passing in a reference to `A`. By not using `new` we do not create a new instance of the `A` class and avoid recursion.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T23:04:25.497

I think, you misunderstand difference between class (as type) and object.

`...So when I create a Class A object, it populates the ArrayList of objects Class B. Each object Class B creates an object Class A (same as the one that is being populated)...` -- not exact `same` as object, but same as class. Each object `B` stores objects of class `A`. And once created object `A` is might not be the same object like `A->B->A`.

But if you want to have reference to parent object `A` from object `B`, you may use references (for example. you want to use its public methods and so on). So in this case you must not create new entities of object `A` in `B`, but, when you create your object `B` -- in constructor of `B` you must use as parameter reference to parent object `A`.

In C++ this trick is fairly common.

# android - 为什么 AlarmManager.INTERVAL_HALF_HOUR 仅每 45 分钟触发一次？

> ID：13445426
> 
> 赞同：1
> 
> 时间：2012-11-18T22:49:18.350
> 
> 标签：android

我通过以下方式启动闹钟：

```
protected void onHandleIntent(Intent intent) {
    Log.v("alarm", "onHandleIntent");

    int alarmType = AlarmManager.ELAPSED_REALTIME_WAKEUP;
    long interval = AlarmManager.INTERVAL_HALF_HOUR;
    long timeToRefresh = SystemClock.elapsedRealtime() + interval;

    alarmManager.setInexactRepeating(alarmType, timeToRefresh, interval, alarmIntent);

    updateService();
} 
```

但是警报不是每 30 分钟触发一次，而是每 45 分钟触发一次。为什么？setInexactRepeating 的容差是 15 分钟吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T20:30:37.530

从文档中，“您的警报的第一次触发不会在请求的时间之前，但它可能不会在该时间之后的几乎整个间隔内发生。此外，虽然重复警报的整个周期将按照要求，但之间的时间任何两次连续触发的警报可能会有所不同。如果您的应用程序需要非常低的抖动，请改用 setRepeating(int, long, long, PendingIntent)。”

来源：[AlarmManager](http://developer.android.com/reference/android/app/AlarmManager.html#setInexactRepeating%28int,%20long,%20long,%20android.app.PendingIntent%29)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T20:33:50.257

你应该使用`RTC_WAKEUP`，因为这基本上更有意义。它是`now`（如在挂钟上，而不是自启动等）并且您希望在“ `now`+ 30 分钟”内唤醒。

# jquery - 在 Rails 控制器中呈现 JSON 数据

> ID：13445428
> 
> 赞同：0
> 
> 时间：2012-11-18T22:49:46.787
> 
> 标签：jquery, ruby-on-rails, heroku

当我将本地主机和同一个应用程序上传到 Heroku 时，我感到很困惑。

我通过控制器方法即时渲染 JSON，并使用 AJAX 请求在 Javascript 中获取它。

在本地主机上，它运行良好。但是，当我上传到 Heroku 时，它根本不起作用。不知道为什么会这样。这是否与 Heroku 访问我的模型的方式和我的本地主机的方式之间的差异有关？

以下是来自同一时间戳的两个调试输出：

在职的：

> 之前是 106.944877，现在是 0，增量为 -84.07055608611111

不工作：

> 以前是 0，现在是 0，增量为 0

这是代码：

控制器方法#1：

```
# present data to grab for view work
# get/user_data
def user_inst_data
timestamp = params[:time_now]
user_id = params[:user_id]

before = fetch_data_at_time(user_id, timestamp)
after = fetch_data_at_time(user_id, (timestamp.to_i+3600))

response = Hash.new

response['before'] = before
response['after'] = after

render json: response.to_json
end 
```

控制器方法#2：

```
def fetch_data_at_time(user_id, time_at)
  # convert time to object
  timestamp = Time.at(time_at.to_i)
  # break down timestamp right now
  year = timestamp.year
  month = timestamp.month
  day = timestamp.day
  hour = timestamp.hour+1 #we're 1-indexed

  # find data
  response = UserData.where(:user_id=>user_id, :year=>year, :month=>month, :day=>day, :hour=>hour).select('power')

  return response
end 
```

的JavaScript：

```
function real_time_update(){
  //this function will fake "real-time" updates by grabbing simulated data from the DB
  //continue to update component every 5 seconds
  setTimeout(real_time_update,5000);
  var time = Math.round(((new Date()).getTime())/1000);

  var targetURL = "get/user_data?time_now="+time+"&user_id="+<%= @user.id %>;

  var power_before = 0;
  var power_after = 0;

  // GET data with AJAX request, set function for successful return
  $.get(targetURL, function(data){
    power_before = data.before[0].power;
    power_after = data.after[0].power;

    // after getting data before and after, find increment between them, delta-naught
    var delta = power_after - power_before;

    // scale before power by a percentage based on how much time has elapsed since last hour
    var current_time = new Date();
    var minutes_passed = (current_time.getMinutes())*60;
    var seconds_passed = minutes_passed + (current_time.getSeconds());
    var percent_hour = seconds_passed/3600;

    // calculate increment
    var delta_change = delta*percent_hour;

    // DEBUG----
    console.log("Before it was "+power_before+", now it is "+power_after+" with increments of "+delta_change)

    //add to power_before and update html component
    var power_update = power_before + delta_change;

    // redraw component
    drawChart(power_update);
  })
} 
```

# r - ggplot2 aes_string() 无法处理以数字开头或包含空格的名称

> ID：13445435
> 
> 赞同：15
> 
> 时间：2012-11-18T22:50:13.137
> 
> 标签：r, ggplot2

如果 a 的列名`data.frame`以数字开头，或者有空格，则`aes_string()`无法处理它们：

```
foo=data.frame("1st Col"=1:5, "2nd Col"=5:1, check.names=F)
bar=colnames(foo)
ggplot(foo, aes_string(x=bar[1],y=bar[2])) + geom_point()
# Error in parse(text = x) : <text>:1:2: unexpected symbol
# 1: 1st
#     ^

foo=data.frame("First Col"=1:5, "Second Col"=5:1, check.names=F)
bar=colnames(foo)
ggplot(foo, aes_string(x=bar[1],y=bar[2])) + geom_point()
# Error in parse(text = x) : <text>:1:7: unexpected symbol
# 1: First Col
#          ^

foo=data.frame("First_Col"=1:5, "Second_Col"=5:1, check.names=F)
bar=colnames(foo)
ggplot(foo, aes_string(x=bar[1],y=bar[2]))+geom_point()
# Now it works 
```

![在此处输入图像描述](../Images/f29be0f3c693e5176e9a0bb419d20c9a.png)

有什么办法可以在列名中有空格，或者它们以数字开头，我们可以在ggplot2中使用它们吗？请考虑我们可能不知道列名，因此请避免提供具有恒定列名的示例 - 如下所示：

```
aes_string(x=`1st Col`, y=`2nd Col`) 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-18T23:50:50.500

据我所知，这种方法应该以编程方式工作：

```
foo=data.frame("1st Col"=1:5, "2nd Col"=5:1, check.names=F)

#Save the colnames
bar=colnames(foo)

#change the names to something usable
names(foo) <- c("col1", "col2")

#Plot with arbitrary labs
ggplot(foo, aes(x=col1, y=col2)) + geom_point()+
  labs(x=bar[1], y=bar[2]) 
```

![在此处输入图像描述](../Images/11f8e6eddd249ab205cc5eefd6ae7a1b.png)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-05-10T13:40:25.310

最初的问题询问如何修改变量的值，以便在事先不知道该值时 ggplot() 可以接受。

编写一个函数，将反引号添加到变量值的开头和结尾：

```
# ggName -> changes a string so it is enclosed in back-ticks.
#   This can be used to make column names that have spaces (blanks)
#   or non-letter characters acceptable to ggplot2.
#   This version of the function is vectorized with sapply.
ggname <- function(x) {
    if (class(x) != "character") {
        return(x)
    }
    y <- sapply(x, function(s) {
        if (!grepl("^`", s)) {
            s <- paste("`", s, sep="", collapse="")
        }
        if (!grepl("`$", s)) {
            s <- paste(s, "`", sep="", collapse="")
        }
    }
    )
    y 
} 
```

例子：

```
ggname(12) 
```

[1] 12

```
ggname("awk ward") 
```

“`awk 病房`”

```
l <- c("awk ward", "no way!")
ggname(l) 
```

"`awk ward`" "`不可能！`"

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-09-08T11:37:10.980

您可以使用以下函数`aes_string2`代替`aes_string`：

```
aes_string2 <- function(...){
  args <- lapply(list(...), function(x) sprintf("`%s`", x))
  do.call(aes_string, args)
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-11-10T03:35:16.250

我有类似的情况，我用``来使它理解：

```
mydf$ROIs <- row.names(mydf)
df.long <- melt(mydf)
colnames(df.long)[3] <- "Methods"
colnames(df.long)[4] <- "Mean L2 Norm Error"
variable.name="Variable", na.rm=TRUE)
ggplot(df.long, aes(ROIs, `Mean L2 Norm Error`, fill=Methods))+  
geom_bar(stat="identity",position="dodge")+
theme(axis.text.x=element_text(angle=45,hjust=1,vjust=1)) 
```

# python - 为什么将其保留在列表中？

> ID：13445437
> 
> 赞同：1
> 
> 时间：2012-11-18T22:50:24.817
> 
> 标签：python

```
def test(x,theList): 
    theList.append(x) 
    if x < 2: 
        x = x + 1 
        test(x,theList) 
        print x 
        print theList 

test(1,[]) 
```

为什么结果是[1,2]？不仅[1]？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T22:51:39.303

`print`因为你在递归调用`test()`returns之后执行语句。

Python 对象总是通过引用传递，因此当第二次调用 test 调用`theList.append(x)`时，它会附加到传入的原始列表中，然后打印出来。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T22:53:31.733

```
def test(x,theList): 
    if x < 2: 
        theList.append(x) 
        x = x + 1 
        test(x,theList) 
        print x 
        print theList 

test(1,[]) 
```

# c - fgets 是做什么的？

> ID：13445441
> 
> 赞同：0
> 
> 时间：2012-11-18T22:51:11.370
> 
> 标签：c, fgets

它不相等：

```
fgets (answer, 256, stdin);

if (strncmp(answer, "sta", 4) == 0)
  printf("omg, it's equal"); 
```

这段代码是：

```
fgets (answer, 4, stdin);

if (strncmp(answer, "sta", 4) == 0)
  printf("omg, it's equal"); 
```

为什么？这是因为首先，我猜第四位的答案没有 \0（如果我将其更改为 3 而不是 4 它可以工作）。但是 fgets 是做什么的呢？第一个字符串答案是`str \whitespace*253\0"`？在第二个是`str\0`？谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-18T22:54:04.637

`fgets`（与 不同`gets`）包括与`\n`在行尾按下的回车相对应的尾随。如果您将`3`其作为限制，它将截断字符串，丢弃`\n`.

从手册页：

> `fgets()`从流中最多读入一个小于 size 的字符并将它们存储到 指向的缓冲区中`s`。在 EOF 或换行符后停止读取。如果读取了换行符，则将其存储到缓冲区中。终止的空字节 ( `'\0'`) 存储在缓冲区中的最后一个字符之后。

# jquery - jQuery多次运行总计

> ID：13445442
> 
> 赞同：0
> 
> 时间：2012-11-18T22:51:24.003
> 
> 标签：jquery, asp.net-mvc-3

0我正在使用 jQuery 计算多个文本框的运行总计。几天前刚刚找到了一个关于如何让它工作的很棒的回复，但现在我遇到了另一个问题。使用一个选择器时，GetTotal 的总数可以完美计算。但是，当我包含第二个选择器时，总数开始相互冲突，并且不再正确计算。我一直在寻找解决这个问题的方法有一段时间了，有人有什么想法吗？

这是我目前使用的选择器：

```
function GetTotal(txtBox) {
        var total = 0;
        $('input:text').each(function(index, value) {
            total += parseInt($(value).val() || 0);
        });

        $("#chkTotal").html(total);
    } 
```

我的视图使用这些 txt 框

```
<div class="editor-field">
        @Html.TextBox("Field1", String.Empty, new {InputType = "text", id = "field1", onchange = "GetTotal(this)" })

    </div>

    <div class="editor-field">
        @Html.TextBox("Field2", String.Empty, new {InputType = "text",  id = "field2", onchange = "GetTotal(this)" })

    </div>
    <div>
        <h3>Total Checked</h3>
    </div>

<div id="chkTotal"></div> 
```

现在我正在尝试实现另一个选择器，它将总共有两个额外的编辑器字段......

```
function GetTotal1(txtBox) {
        var total1 = 0;
        $('input:text').each(function (index, value) {
            total1 += parseInt($(value).val() || 0);
        });

        $("#disTotal").html(total1);
    } 
```

看法：

```
<div class="editor-field">
        @Html.TextBox("Field3", String.Empty, new {InputType = "text", id = "field3", onchange = "GetTotal1(this)" })

    </div>

    <div class="editor-field">
        @Html.TextBox("Field4", String.Empty, new {InputType = "text", id = "field4", onchange = "GetTotal1(this)" })

    </div>
    <div>
        <h3>Total Distributed</h3>
    </div>
    <div id="disTotal"></div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T22:57:26.340

无论您是否定义了两个不同的函数，您的 each() 函数都会运行所有输入字段...

```
$('input:text').each(... 
```

在这两个函数中获取所有 4 个输入字段。

一种方法是为每个周围的 div 设置一个类，即：

```
 <div class="editor-field group1"> 
```

然后在你的函数中有

```
 $('.group1 input:text').each(function( ... 
```

一个更有用的方法是使用函数参数来传递类：

```
function GetTotal(group) {
    var total = 0;
    $('.'+group+' input:text').each(function(index, value) {
        total += parseInt($(value).val() || 0);
    });

    $("#chkTotal"+group).html(total);
} 
```

您需要重命名每个组的总 div：

```
<div id="chkTotalgroup1"></div> 
```

然后将 onChange 处理程序中的“this”更改为要汇总的每个组。（组 1、组 2 等等...）

```
onchange = "GetTotal1(group1)" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T23:07:53.127

对两个总和使用不同的 HTML 类，例如

```
<div class="editor-field">
    @Html.TextBox("Field1", String.Empty, new {@class = "total0", InputType = "text", id = "field1", onchange = "GetTotal(this)" })
</div>
<div class="editor-field">
    @Html.TextBox("Field2", String.Empty, new {@class = "total0", InputType = "text",  id = "field2", onchange = "GetTotal(this)" })
</div>
<div>
    <h3>Total Checked</h3>
</div>
<div id="chkTotal"></div>
<div class="editor-field">
    @Html.TextBox("Field3", String.Empty, new {@class = "total1", InputType = "text", id = "field3", onchange = "GetTotal1(this)" })
</div>
<div class="editor-field">
    @Html.TextBox("Field4", String.Empty, new {@class = "total1", InputType = "text", id = "field4", onchange = "GetTotal1(this)" })
</div>
<div>
    <h3>Total Distributed</h3>
</div>
<div id="disTotal"></div> 
```

Javascript：

```
function GetTotal(txtBox) {
    var total = 0;
    $('input:text.total0').each(function(index, value) {
        total += parseInt($(value).val() || 0);
    });

    $("#chkTotal").html(total);
}

function GetTotal1(txtBox) {
    var total1 = 0;
    $('input:text.total1').each(function (index, value) {
        total1 += parseInt($(value).val() || 0);
    });

    $("#disTotal").html(total1);
} 
```

# php - 如何让 PREG_SPLIT_DELIM_CAPTURE 与 utf-8 中文一起使用？

> ID：13445446
> 
> 赞同：2
> 
> 时间：2012-11-18T22:51:55.830
> 
> 标签：php

> **可能重复：**
> [unicode 模式下的 preg_split：delim_capture 不起作用？](https://stackoverflow.com/questions/9114166/preg-split-in-unicode-mode-delim-capture-not-working)

我有这段文字：

> 一个自己忠心的女人喜欢我这样的女人，甚至很自卑，她说：“耶和华对了如指掌，他肯定不会指望我？”不值得吗？那么，尼希米记13:31可能会让你这样做。</p>

这个：

```
$array = preg_split('/[。？！?!]/u', $str, PREG_SPLIT_DELIM_CAPTURE);
print_r($array); 
```

给我这个：

```
Array
(
    [0] =>  一个 忠心 的 基督徒 女子 曾经 十分 自卑 , 她 这样 说 : “ 耶和华 既然 对 我 了如指掌 , 他 肯定 不会 爱 我 、 悦 纳 我 
    [1] =>  ” 你也 曾有 类 似的 感觉 , 认为 自己 不配 得到 上帝 悦 纳 , 甚至 不值得 他 关心 吗 ? 那么 , 尼 希 米 记 13 : 31 的话 也许 能够 安慰 你 。
) 
```

请注意，它不会在问号处拆分，也不会捕获数组[0] 末尾的第一个分隔符（。）。

我该如何解决？

# vb.net - WCF 和返回的对象名称

> ID：13445447
> 
> 赞同：1
> 
> 时间：2012-11-18T22:52:11.263
> 
> 标签：vb.net, wcf, namespaces

我是 WCF 的新手，遇到了一个我似乎找不到答案的问题。

我有两个项目。一个是简单的登录应用程序，另一个是连接到数据库的托管 IIS WCF 服务 (.svc)。这两个项目都是 .NET 4。

WCF 服务有两种方法：“Administrator_Login”和“User_Login”。

每当调用每个方法时，它们都会执行与该方法相关的一些代码：Administrator.Login.Execute 和 User.Login.Execute（我将我的代码组织到命名空间中，Administrator.Login 和 User.Login 是类名和 Execute是方法的名称）。

这两个操作都返回存在于 User.Login 类或 Administrator.Login 类中的不同“LoginOut”对象。

我的问题是：虽然每个操作都组织到 WCF 服务上的命名空间中，但是当我将客户端应用程序的服务引用添加到服务并查看返回的对象类型的名称时，我看到“LoginOut 和“LoginOut1” .

有没有办法通过命名空间引用 WCF 服务返回的客户端应用程序中返回的对象？

我目前必须这样做：

```
Dim loginOut As Service.LoginOut = Service.Administrator_Login().Execute() 
Dim loginOut As Service.LoginOut1 = Service.User_Login().Execute() 
```

但我希望能够做到：

```
Dim loginOut As Service.Administrator.Login.LoginOut = Service.Administrator_Login().Execute() 
Dim loginOut As Service.User.Login.LoginOut = Service.User_Login().Execute() 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T15:19:01.443

如果您将“LoginOut”的定义分离到一个类库中，然后从您的客户端项目中引用该类库，并更新服务引用，那么您应该得到您正在寻找的行为。如果不执行 configureServiceReference，请单击高级并确保选中“在所有引用的程序集中重用类型”。

请注意，这不是执行 SOA 的“纯粹”方式。这会将您的客户端和 Web 服务绑定在一起，这可能会给您带来麻烦。但是，我自己在不同的小规模情况下完成了这项工作，并没有遇到任何问题。

此解决方案可能有点繁重，具体取决于所需的行为。它涉及将库 DLL 的副本分发给每个客户端。这可能非常强大，因为您正在使用数据有效地分配行为，但对于手头的问题可能有点过分了。

# iphone - 如何让 UISearch 视图将 switch 语句中的值返回到 DVC？

> ID：13445450
> 
> 赞同：0
> 
> 时间：2012-11-18T22:52:27.960
> 
> 标签：iphone, objective-c, xcode, ipad

我想知道是否`searchcontroller`可以将结果推送到`detailviewcontroller`from a switch 语句。

这是我当前设置应用程序的方式。

。H

```
@interface MOVTableViewController : UITableViewController {

    NSMutableArray* filteredList;

    IBOutlet UISearchBar *search;
}

@property(strong, nonatomic) NSArray *lodgeList;
@property(strong, nonatomic) NSArray *cityname;

@end 
```

.m

```
 #import "MOVTableViewController.h"
    #import "MOVDetailViewController.h"

    @interface MOVTableViewController ()

    @end

    @implementation MOVTableViewController

    @synthesize lodgeList, cityname;

    - (id)initWithStyle:(UITableViewStyle)style
    {
        self = [super initWithStyle:style];
        if (self) {
            // Custom initialization
        }
        return self;
    }

    - (void)viewDidLoad
    {
        [super viewDidLoad];

        //Start of Lodge List

        lodgeList = [[NSArray alloc]initWithObjects:

                     //Abingdon
                     @"Abingdon Lodge No. 48",
                     @"York Lodge No. 12",

                     //Alberene
                     @"Alberene Lodge No. 277",

                     // Alexandria
                     @"A. Douglas Smith, Jr. No. 1949",
                     @"Alexandria-Washington Lodge No. 22",
                     @"Andrew Jackson Lodge No. 120",
                     @"Henry Knox Field Lodge No. 349",
                     @"John Blair Lodge No. 187",
                     @"Mount Vernon Lodge No. 219",......

    filteredList = [[NSMutableArray alloc] initWithArray:lodgeList];

    //end of list

}
    - (void)viewDidUnload
{

    [super viewDidUnload];
    // Release any retained subviews of the main view.
    // e.g. self.myOutlet = nil;
}

- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation
{
    return (interfaceOrientation == UIInterfaceOrientationPortrait);
}

#pragma mark - Table view data source

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{

    // Return the number of sections.
    return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{

    // Return the number of rows in the section.
    return [filteredList count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:CellIdentifier];
    }

    cell.detailTextLabel.text =[cityname objectAtIndex:indexPath.row];
    cell.accessoryType = UITableViewCellAccessoryDisclosureIndicator;
    cell.textLabel.text = [filteredList objectAtIndex:indexPath.row];

    return cell;
}

- (void) searchTableView
{

    filteredList = nil;

    filteredList = [[NSMutableArray alloc] initWithArray:lodgeList];
    NSPredicate *predicate = [NSPredicate predicateWithFormat:@"SELF like[c] %@",[NSString stringWithFormat:@"%@*",search.text]];
    [filteredList filterUsingPredicate:predicate];
}

- (void)searchBar:(UISearchBar *)searchBar textDidChange:(NSString *)searchText
{
    [self searchTableView];

}

- (void)searchBarCancelButtonClicked:(UISearchBar *) searchBar
{
    [self searchTableView];
    [search resignFirstResponder];
}

- (void)searchBarSearchButtonClicked:(UISearchBar *)searchBar
{
    [self searchTableView];
    [search resignFirstResponder];
}

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    if (tableView == self.searchDisplayController.searchResultsTableView) {
        [self performSegueWithIdentifier: @"lodgedetail" sender:self];
    }
}

- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender

{
    if ([segue.identifier isEqualToString:@"lodgedetail"]) {
        MOVDetailViewController *MDVC = segue.destinationViewController;

        NSIndexPath * path = [self.tableView indexPathForSelectedRow];
        NSString * thelodge = [filteredList objectAtIndex:path.row];

        MDVC.lodgeName = thelodge;
        MDVC = [segue destinationViewController];
        MDVC.lodgeNumber = path.row;

        NSIndexPath *indexPath = nil;

        if ([self.searchDisplayController isActive]) {
            indexPath = [self.searchDisplayController.searchResultsTableView indexPathForSelectedRow];
            MDVC.lodgeName = [filteredList objectAtIndex:indexPath.row];

        } else {
            indexPath = [self.tableView indexPathForSelectedRow];
            MDVC.lodgeName = [filteredList objectAtIndex:indexPath.row];

        }
    }

}

@end 
```

.h（详细视图）

```
@interface MOVDetailViewController : UIViewController
@property (strong, nonatomic) IBOutlet UITextView *address;
@property (strong, nonatomic) IBOutlet UITextView *website;
@property (strong, nonatomic) IBOutlet UITextView *statedc;
@property (strong, nonatomic) IBOutlet UITextView *lodgehistory;
@property (strong, nonatomic) NSString * lodgeName;
@property int lodgeNumber;

@end 
```

.m（详细视图）

```
#import "MOVDetailViewController.h"

@interface MOVDetailViewController ()

@end

@implementation MOVDetailViewController

@synthesize address, lodgeName, lodgeNumber, lodgehistory, statedc, website;

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];

    self.title = lodgeName;

    switch (lodgeNumber) {
        case 0:
            //Abingdon Lodge No. 48
            address.text = @"325 W Main Street Abingdon, Virginia 24210";
            website.text = @"http://www.grandlodgeofvirginia.org/lodges/48/";
            statedc.text = @"Abingdon Lodge No. 48 holds it's stated communication on the 2nd Monday of the month at 7:30 PM. If there are any exceptions to the regular meeting day or time, they are posted on the Lodge website.";

            lodgehistory.text = @"According to the earliest records the Abingdon Lodge had its origin “At a meeting held at the house of James White in the town of Abingdon, on October 3, 1796.” The record states that a dispensation had been given by the Grand Master of Masons in Virginia and the following were present: William King, Master; Daniel Murphy, Past Master; Robert Johnson, Past Master; Charles Carson, Past Master, and William Preston Skillern. For more information on the Lodge History please see the Lodge website.";

            break;

            //York Lodge No. 12
        case 1:
            address.text =@"14411 Black Hollow Road Abingdon, Virginia 24210";

            website.text = @"http://www.grandlodgeofvirginia.org/lodges/12/";

            statedc.text = @"York Lodge No. 12 holds it's stated communication on the 4th Monday of the month at 7:30 PM. If there are any exceptions to the regular meeting day or time, they are posted on the Lodge website.";

            lodgehistory.text = @"York Lodge No. 12 was chartered on December 16, 1885\. This Lodge was formed from a disturbance in Spring Creek Lodge No. 173, which was disbanded. The meetings were held in a schoolhouse at Maple Grove, Virginia on the second floor. The second floor caved in at some time and the meetings were then held on the first floor. In 1957 the Lodge voted to remodel the building for the cost of approximately five thousand dollars. In 1979 the December stated meeting was held in a new building that cost twenty thousand dollars. The fellowship hall is used by the Lodge, its members and the community for Church meetings, family functions, wedding dinners, arts and crafts and more. York Lodge is a part of its community and the community is a part of York Lodge.For more information on the Lodge History please see the Lodge website.";
            break;

            //Alberene Lodge No. 277
        case 2:
            address.text = @"2722 Plank Road Alberene, Virginia 22959";

            website.text = @"http://www.grandlodgeofvirginia.org/lodges/277";

            statedc.text = @"Alberene Lodge No. 277 holds it's stated communication on the 2nd Monday of the month at 7:30 PM. If there are any exceptions to the regular meeting day or time, they are posted on the Lodge website.";

            lodgehistory.text = @"Alberene Lodge No. 277 was chartered in 1900\. The Lodge was destroyed by fire September 20, 1933, and the charter was reissued October 6, 1933\. The 1 3/4 acres of land was purchased from Alberene Store Co. deeded August 25, 1937\.  The first meeting place was over a store building about two miles from the present location.  Membership ranges from 40 to 60 members. The Lodge has remained small in number, but large in fellowship and real meaning in Masonry. It seems the Lodge will never go anywhere, by that it is meant never grow big or do anything great. By what all of the members have gained, the members will keep the Lodge in the best of Masonic health. For more information on the Lodge History please see the Lodge website.";
            break;

            //A. Douglas Smith, Jr. Lodge of Research No. 1949
        case 3:
            address.text = @"101 Callahan Drive Alexandria, Virginia 22301";

            website.text = @"http://www.grandlodgeofvirginia.org/lodges/1949/index.asp";

            statedc.text = @"A. Douglas Smith, Jr. Lodge of Research No. 1949 holds it's stated communication on the 5th Saturday of the month at 10:00 AM. If there are any exceptions to the regular meeting day or time, they are posted on the Lodge website.";

            lodgehistory.text = @"This Lodge of Research, the second in Virginia, was established in 1982\. While there were several distinguished Masons in Northern Virginia who were instrumental in establishing the Lodge, the primary organizer was Most Worshipful Stewart W. Miner, Past Grand Master. He was most ably assisted in this effort by the District Deputy Grand Master of Masonic District No. 1A, Right Worshipful Werner H. Morlock, and Right Worshipful John H. King, Chairman of the Grand Lodge Committee on Lodge Development. Right Worshipful Christopher Dains and Worshipful William A. Myers, Past Master of Springfield Lodge No. 217 also provided assistance. Brother Morlock eventually served as Grand Master of Masons in Virginia in 1993-1994, but died in office before his term was completed. Worshipful Brother Myers became the first Worshipful Master of this Lodge. For more information on the Lodge History please see the Lodge website.";
            break; 
```

我问的原因是因为在我执行搜索并单击其中一个结果后，`detailviewcontroller`它不会更新`IBOulets` `UItextview`地址、网站、静态或历史记录。它继续显示第一个小屋。但是，如果我不执行搜索，则 DVC 执行良好并相应地更新所有信息。

![在此处输入图像描述](../Images/daea28a81665cd6717fba4f42b10f527.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T01:07:20.037

在`prepareForSegue`方法中，为什么要重新初始化视图控制器变量？尝试删除以下代码中提到的行：

```
MOVDetailViewController *MDVC = segue.destinationViewController;
NSIndexPath * path = [self.tableView indexPathForSelectedRow];
NSString * thelodge = [filteredList objectAtIndex:path.row];

MDVC.lodgeName = thelodge;
MDVC = [segue destinationViewController];  // REMOVE THIS LINE
MDVC.lodgeNumber = path.row; 
```

* * *

请尝试这个更新的`prepareForSegue`方法：

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if ([segue.identifier isEqualToString:@"lodgedetail"]) {
        MOVDetailViewController *MDVC = segue.destinationViewController;

        NSIndexPath *indexPath = nil;
        if (self.searchDisplayController.isActive) {
            indexPath = [self.searchDisplayController.searchResultsTableView indexPathForSelectedRow];
            NSLog(@"filteredList = %@", filteredList);
            MDVC.lodgeName = [filteredList objectAtIndex:indexPath.row];

            // ******* Find row from the "lodgeList" array *******
            for(int i = 0; i < [lodgeList count]; i++) {
                if([MDVC.lodgeName isEqualToString: [lodgeList objectAtIndex: i]]) {
                    MDVC.lodgeNumber = i;
                    break;
                }
            }  

        } else {
            indexPath = [self.tableView indexPathForSelectedRow];
            MDVC.lodgeName = [lodgeList objectAtIndex:indexPath.row];
            MDVC.lodgeNumber = indexPath.row;
        }
        NSLog(@"indexPath = %@", indexPath);
    }
} 
```

# java - deprecated readLine() What to change?

> ID：13445451
> 
> 赞同：1
> 
> 时间：2012-11-18T22:52:46.063
> 
> 标签：java, httpurlconnection, datainputstream

I'm a Java beginner, trying to get this to work in Eclipse. However, the `readLine` is struck through and a notice says it is deprecated. The code works, albeit not the `while ((var2 = var5.readLine()) != null) {` bit ... So I'm wondering how to fix it.

```
final class ScreenShotHelper$1 implements Runnable
{
    public void run()
    {
        try
        {
            String var1 = ScreenShotHelper.access$000().getAbsolutePath();
            String var2 = "";
            HttpURLConnection var3 = null;
            DataOutputStream var4 = null;
            DataInputStream var5 = null;
            String var6 = "\r\n";
            String var7 = "--";
            String var8 = "*****";
            String var9 = "";
            int var10 = 1048576;
            String var11 = "";
            var9 = Minecraft.getMinecraft().thePlayer.username;
            String var12 = "http://localhost/screenupload/index.php?playername=" + var9;
            try
            {
                FileInputStream var13 = new FileInputStream(new File(var1));
                URL var14 = new URL(var12);
                var3 = (HttpURLConnection)var14.openConnection();
                var3.setDoInput(true);
                var3.setDoOutput(true);
                var3.setUseCaches(false);
                var3.setRequestMethod("POST");
                var3.setRequestProperty("Connection", "Keep-Alive");
                var3.setRequestProperty("Content-Type", "multipart/form-data;boundary=" + var8);
                var4 = new DataOutputStream(var3.getOutputStream());
                var4.writeBytes(var7 + var8 + var6);
                var4.writeBytes("Content-Disposition: form-data; name=\"file\";filename=\"" + var1 + "\"" + var6);
                var4.writeBytes(var6);
                int var15 = var13.available();
                int var16 = Math.min(var15, var10);
                byte[] var17 = new byte[var16];

                for (int var18 = var13.read(var17, 0, var16); var18 > 0; var18 = var13.read(var17, 0, var16))
                {
                    var4.write(var17, 0, var16);
                    var15 = var13.available();
                    var16 = Math.min(var15, var10);
                }
                var4.writeBytes(var6);
                var4.writeBytes(var7 + var8 + var7 + var6);
                System.out.println("File is written");
                var13.close();
                var4.flush();
                var4.close();
            }
            catch (MalformedURLException var20)
            {
                System.out.println("error1: " + var20.getMessage());
            }
            catch (IOException var21)
            {
                System.out.println("error2: " + var21.getMessage());
            }

            try
            {
                var5 = new DataInputStream(var3.getInputStream());

                while ((var2 = var5.readLine()) != null) {
                    System.out.println("Server Response " + var2);
                    ScreenShotHelper.mc.thePlayer.addChatMessage("\u00a7aSuccessfully uploaded screenshot!  Direct link:");
                    ScreenShotHelper.mc.thePlayer.addChatMessage("\u00a7a" + var2);
                }
                var5.close();
            }
            catch (IOException var19)
            {
                System.out.println("error3: " + var19.getMessage());
            }
        }
        catch (Exception var22)
        {
            var22.printStackTrace();
            ScreenShotHelper.mc.thePlayer.addChatMessage("\u00a74failed to save");
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-18T23:11:35.960

*   Give your variables meaningful names.
*   Declare your variables in the smallest possible scope.
*   Don't assign dummy values (like `null` or `""`) to variables.
*   Avoid side-effects in tests.
*   Use automatic resource management to cleanly ensure that streams are closed.
*   Determine and use the correct character encoding when converting bytes to characters.

Here is an example of your code that applies these points:

```
try (InputStream is = connection.getInputStream()) {
  BufferedReader lines = new BufferedReader(new InputStreamReader(is, "UTF-8"));
  while (true) {
    String line = lines.readLine();
    if (line == null)
      break;
    System.out.println("Server Response " + line);
    ...
  }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-18T22:56:01.383

Use this code instead:

```
BufferedReader var5 = null;
try
{
    var5 = new BufferedReader(new InputStreamReader(var3.getInputStream()));
    // or perhaps
    // new BufferedReader(new InputStreamReader(var3.getInputStream(), "UTF-8"));
    while ((var2 = var5.readLine()) != null) {
        System.out.println("Server Response " + var2);
        ScreenShotHelper.mc.thePlayer.addChatMessage("\u00a7aSuccessfully uploaded screenshot!  Direct link:");
        ScreenShotHelper.mc.thePlayer.addChatMessage("\u00a7a" + var2);
    }

} finally {
    if (var5 != null) {
        try { var5.close(); }
        catch (IOException ignored) {}
    }
} 
```

The reason for this (and the suggestion) can be found in the [docs for `DataInputStream.readLine()`](http://docs.oracle.com/javase/6/docs/api/java/io/DataInputStream.html#readLine%28%29):

> This method does not properly convert bytes to characters. As of JDK 1.1, the preferred way to read lines of text is via the `BufferedReader.readLine()` method.

(If you're using Java 7, you can dispense with the `finally` clause by using a [try-with-resources](http://docs.oracle.com/javase/tutorial/essential/exceptions/tryResourceClose.html) construct.)

# ios - 在 iPad 上以横向启动后，iphone 应用程序没有响应

> ID：13445452
> 
> 赞同：14
> 
> 时间：2012-11-18T22:52:52.673
> 
> 标签：ios, objective-c, ipad, uiviewcontroller

我的 iPhone 应用程序在 iPad 上以横向模式启动时没有响应。

如果它以纵向模式启动，一切正常。在横向模式下，直到应用程序旋转或按下 1x 2x 按钮后才能正常工作。

我已经尝试使用断点调试应用程序并单步执行代码，但它表明该应用程序在调试控制台中正常运行。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-26T04:06:24.663

我发现这是 iOS 6 设备独有的，但是如果您删除应用程序 plist 中“支持的界面方向”下的所有条目，这个问题就会消失。或者，如果您在目标设置的摘要屏幕上选中“状态栏”设置的“应用程序启动期间隐藏”选项，这也可以修复它：

![在应用程序启动期间隐藏](../Images/414aa84bc27805c79399b92022180a3a.png)

没有合乎逻辑的理由我可以看到这些选项中的任何一个都*应该*修复这个错误，但它们都可以。

如果您在 iOS 6 中使用支持的方向设置，您仍然可以通过编程方式控制允许的界面方向[`supportedInterfaceOrientations`](http://developer.apple.com/library/ios/documentation/uikit/reference/UIViewController_Class/Reference/Reference.html#//apple_ref/occ/instm/UIViewController/supportedInterfaceOrientations)（或者在 iOS 5 中，您仍然可以使用该[`shouldAutorotateToInterfaceOrientation:`](http://developer.apple.com/library/ios/documentation/uikit/reference/UIViewController_Class/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/occ/instm/UIViewController/shouldAutorotateToInterfaceOrientation:)方法）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-08-26T02:14:47.120

似乎只需`[[UIApplication sharedApplication] setStatusBarHidden:NO withAnimation:UIStatusBarAnimationNone];`在 didFinishLaunchingWithOptions: 函数的开头添加就可以了。无需更改 plist 设置文件。

# python - 蟒蛇类型错误

> ID：13445454
> 
> 赞同：2
> 
> 时间：2012-11-18T22:53:29.967
> 
> 标签：python, string, int, concatenation, typeerror

即使所有部分都是字符串，我也收到以下 python 错误

```
 request = str(self.SETUP) + " " + str(self.fileName) + "RTSP/1.0";
TypeError: unsupported operand type(s) for +: 'int' and 'str' 
```

整个代码部分：

```
if requestCode == self.SETUP and self.state == self.INIT:
    threading.Thread(target=self.recvRtspReply).start()
    # Update RTSP sequence number.
    self.rtspSeq = self.rtspSeq + 1

    # Write the RTSP request to be sent.
    request = str(self.SETUP) + " " + str(self.fileName) + "RTSP/1.0"

    # Keep track of the sent request.
    self.requestSent = request 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T00:51:28.473

尝试这个：

```
if requestCode == self.SETUP and self.state == self.INIT:
    threading.Thread(target=self.recvRtspReply).start()
    # Update RTSP sequence number.
    self.rtspSeq = int(self.rtspSeq) + 1 

    # Write the RTSP request to be sent.
    rtps_req = "RTSP/1.0"
    request = "%s %s %s" % (str(self.SETUP),str(self.fileName), rtps_req)

    # Keep track of the sent request.
    self.requestSent = request 
```

# java - XML 膨胀错误

> ID：13445457
> 
> 赞同：0
> 
> 时间：2012-11-18T22:53:46.777
> 
> 标签：java, android, xml, inflate-exception

尝试运行我的应用程序时出现这个非常奇怪的错误。由于我的标签，我认为。这是错误：

```
11-18 14:45:27.093: E/AndroidRuntime(680): FATAL EXCEPTION: main
11-18 14:45:27.093: E/AndroidRuntime(680): java.lang.RuntimeException: Unable to start   activity ComponentInfo{com.laytproducts.bytes/com.laytproducts.bytes.MainActivity}:      java.lang.RuntimeException: Unable to start activity ComponentInfo{com.laytproducts.bytes/com.laytproducts.bytes.MainActivity}: java.lang.RuntimeException: Unable to start activity ComponentInfo{com.laytproducts.bytes/com.laytproducts.bytes.MainActivity}: java.lang.RuntimeException: Unable to start activity ComponentInfo{com.laytproducts.bytes/com.laytproducts.bytes.MainActivity}: java.lang.RuntimeException: Unable to start activity ComponentInfo{com.laytproducts.bytes/com.laytproducts.bytes.MainActivity}: java.lang.RuntimeException: Unable to start activity ComponentInfo{com.laytproducts.bytes/com.laytproducts.bytes.MainActivity}: java.lang.RuntimeException: Unable to start activity ComponentInfo{com.laytproducts.bytes/com.laytproducts.bytes.MainActivity}: java.lang.RuntimeException: Unable to start activity ComponentInfo{com.laytproducts.bytes/com.laytproducts.bytes.MainActivity}: java.lang.RuntimeException: Unable to start activity ComponentInfo{com.laytproducts.bytes/com.laytproducts.bytes.MainActivity}: java.lang.RuntimeException: Unable to start activity ComponentInfo{com.laytproducts.bytes/com.laytproducts.bytes.MainActivity}: java.lang.RuntimeException: Unable to start activity ComponentInfo{com.laytproducts.bytes/com.laytproducts.bytes.MainActivity}: java.lang.RuntimeException: Unable to start activity ComponentInfo{com.laytproducts.bytes/com.laytproducts.bytes.MainActivity}: java.lang.RuntimeException: Unable to start activity ComponentInfo{com.laytproducts.bytes/com.laytproducts.bytes.MainActivity}: java.lang.RuntimeException: Unable to start activity ComponentInfo{com.laytproducts.bytes/com.laytproducts.bytes.MainActivity}: java.lang.RuntimeException: Unable to start activity ComponentInfo{com.laytproducts.bytes/com.laytproducts.bytes.MainActivity}: java.lang.RuntimeException: Unable to start activity ComponentInfo{com.laytproducts.bytes/com.laytproducts.bytes.MainActivity}: java.lang.RuntimeException: Unable to start activity ComponentInfo{com.laytproducts.bytes/com.laytproducts.bytes.MainActivity}: android.view.InflateException: Binary XML file line #14: Error inflating class <unknown>
11-18 14:45:27.093: E/AndroidRuntime(680):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2663)
11-18 14:45:27.093: E/AndroidRuntime(680):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
11-18 14:45:27.093: E/AndroidRuntime(680):  at android.app.ActivityThread.access$2300(ActivityThread.java:125)
11-18 14:45:27.093: E/AndroidRuntime(680):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
11-18 14:45:27.093: E/AndroidRuntime(680):  at android.os.Handler.dispatchMessage(Handler.java:99)
11-18 14:45:27.093: E/AndroidRuntime(680):  at android.os.Looper.loop(Looper.java:123)
11-18 14:45:27.093: E/AndroidRuntime(680):  at android.app.ActivityThread.main(ActivityThread.java:4627)
11-18 14:45:27.093: E/AndroidRuntime(680):  at java.lang.reflect.Method.invokeNative(Native Method)
11-18 14:45:27.093: E/AndroidRuntime(680):  at java.lang.reflect.Method.invoke(Method.java:521)
11-18 14:45:27.093: E/AndroidRuntime(680):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
11-18 14:45:27.093: E/AndroidRuntime(680):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
11-18 14:45:27.093: E/AndroidRuntime(680):  at dalvik.system.NativeStart.main(Native Method)
11-18 14:45:27.093: E/AndroidRuntime(680): Caused by: java.lang.RuntimeException: Unable to start activity ComponentInfo{com.laytproducts.bytes/com.laytproducts.bytes.MainActivity}: java.lang.RuntimeException: Unable to start activity ComponentInfo{com.laytproducts.bytes/com.laytproducts.bytes.MainActivity}: java.lang.RuntimeException: Unable to start activity ComponentInfo{com.laytproducts.bytes/com.laytproducts.bytes.MainActivity}: java.lang.RuntimeException: Unable to start activity ComponentInfo{com.laytproducts.bytes/com.laytproducts.bytes.MainActivity}: java.lang.RuntimeException: Unable to start activity ComponentInfo{com.laytproducts.bytes/com.laytproducts.bytes.MainActivity}: java.lang.RuntimeException: Unable to start activity ComponentInfo{com.laytproducts.bytes/com.laytproducts.bytes.MainActivity}: java.lang.RuntimeException: Unable to start activity ComponentInfo{com.laytproducts.bytes/com.laytproducts.bytes.MainActivity}: java.lang.RuntimeException: Unable to start activity ComponentInfo{com.laytproducts.bytes/com.la 
```

这是我的xml文件：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <LinearLayout
        android:id="@+id/linearLayout1"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentTop="true"
        android:layout_centerHorizontal="true"
        android:background="#ccc" >

        <TextView
            android:id="@+id/titleTV"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginBottom="5dp"
            android:layout_marginLeft="10dp"
            android:layout_marginTop="5dp"
            android:text="Bytes"
            android:textSize="20dp" />
    </LinearLayout>

    <TabHost
        android:id="@android:id/tabhost"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:layout_below="@id/linearLayout1" >

        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:orientation="vertical" >

            <TabWidget
                android:id="@android:id/tabs"
                android:layout_width="match_parent"
                android:layout_height="wrap_content" >
            </TabWidget>

            <FrameLayout
                android:id="@android:id/tabcontent"
                android:layout_width="match_parent"
                android:layout_height="match_parent" >

                <LinearLayout
                    android:id="@+id/tab1"
                    android:layout_width="match_parent"
                    android:layout_height="match_parent" >
                </LinearLayout>

                <LinearLayout
                    android:id="@+id/tab2"
                    android:layout_width="match_parent"
                    android:layout_height="match_parent" >
                </LinearLayout>

                <LinearLayout
                    android:id="@+id/tab3"
                    android:layout_width="match_parent"
                    android:layout_height="match_parent" >
                </LinearLayout>
            </FrameLayout>
        </LinearLayout>
    </TabHost>

</RelativeLayout> 
```

还有我的 OnCreate 方法：

```
super.onCreate(savedInstanceState);
setContentView(R.layout.activity_main);

tabHost = (TabHost)findViewById(android.R.id.tabhost);
tabHost.setup();

TabSpec ts = tabHost.newTabSpec("Home").setIndicator("Home").setContent(new Intent().setClass(this,MainActivity.class));
tabHost.addTab(ts);
ts = tabHost.newTabSpec("Quests").setIndicator("Quests").setContent(new Intent().setClass(this,Jobs.class));
tabHost.addTab(ts);

tabHost.setCurrentTab(0); 
```

我以前从未见过这个错误。出于某种原因，我的 xml 文件出现膨胀问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T23:03:43.690

您正在通过尝试加载来创建无限循环：
MainActivity[与 MainActivity 在选项卡中，[在选项卡中[使用 MainActivity，在选项卡中使用 MainActivity，在选项卡中[使用 MainActivity，在选项卡中[使用 MainActivity，在选项卡中[使用 MainActivity，在选项卡中[使用 MainActivity在选项卡中，在选项卡中[使用 MainActivity，在选项卡中[使用 MainActivity，]]]]]]]]]

这是麻烦的线：

```
TabSpec ts = tabHost.newTabSpec("Home").setIndicator("Home").setContent(new Intent().setClass(this,MainActivity.class)); 
```

我感觉您的完整 LogCat 显示根本原因是 StackOverflowException ...

无论如何，您需要创建一个新类，将其命名为“Home”，其中 MainActivity 加载选项卡，而 Home 是您的默认屏幕。

# c# - 将 TPL 与 ConcurrentDictionary 与“addValueFactory”一起使用有什么风险？MSDN 暗示线程问题

> ID：13445461
> 
> 赞同：3
> 
> 时间：2012-11-18T22:54:14.690
> 
> 标签：c#, .net, multithreading, concurrency, concurrentdictionary

[MSDN 对](http://msdn.microsoft.com/en-us/library/ee378675.aspx)多线程环境中的 addValueFactory 进行了以下说明：

> **评论**
> 
> 如果您在不同的线程上同时调用 AddOrUpdate，则 addValueFactory 可能会被多次调用，但它的键/值对可能不会在每次调用时都添加到字典中。

[对此有一个关闭的连接问题](http://connect.microsoft.com/VisualStudio/feedback/details/693563/concurrentdictionary-tkey-tvalue-addorupdate-tkey-func-tkey-tvalue-func-tkey-tvalue-tvalue)，但似乎没有做任何事情。当我阅读上面的摘录时，我**猜想***可能*会发生以下其中一件事情：

1.  Update() 方法被连续调用，直到它成功（可能会变成在高负载下应该避免的缓慢/争用。）

2.  更新被丢弃，应用程序认为它成功了。（腐败）

3.  数据在变量的线程本地副本上更新，而不是在其他线程上更新。（这可能有点牵强，但由于没有记录任何可能发生的事情）

谁能解释一下这句话是什么意思？

* * *

**第2部分**

@Douglas 共享我修改的代码。有趣的是，每个“添加”与每个“更新”被调用了多少次。输出很有趣，因为只有一个返回值中有一个“添加”值。尽管 Add 被多次调用，但所有其他人都“更新”了。

我想以某种方式阻止更新方法被调用。

```
 ConcurrentDictionary<int, string> numbers = new ConcurrentDictionary<int, string>();
        Parallel.For(0, 30, x =>
        {
           var returned = numbers.AddOrUpdate(1,
                i =>
                {
                    Console.WriteLine("addValueFactory has been called");
                    return i.ToString() + "AAA" + x;
                },
                (i, s) =>
                {
                    Console.WriteLine("updateValueFactory has been called");
                    return i.ToString() + "u" + x;
                });

           Console.WriteLine(returned);
        }); 
```

*输出*

```
addValueFactory has been called
addValueFactory has been called
addValueFactory has been called
addValueFactory has been called
addValueFactory has been called
addValueFactory has been called
updateValueFactory has been called
addValueFactory has been called
updateValueFactory has been called
addValueFactory has been called
1u15
updateValueFactory has been called
addValueFactory has been called
1u24
updateValueFactory has been called
1u25
updateValueFactory has been called
updateValueFactory has been called
1AAA0
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
1u26
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
1u18
updateValueFactory has been called
1u19
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
1u21
1u20
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
1u22
updateValueFactory has been called
1u16
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
1u1
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
1u3
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
1u4
1u2
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
1u6
1u27
updateValueFactory has been called
updateValueFactory has been called
1u23
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
1u9
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
1u10
updateValueFactory has been called
1u12
updateValueFactory has been called
updateValueFactory has been called
1u17
1u7
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
1u28
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
1u11
updateValueFactory has been called
updateValueFactory has been called
1u8
updateValueFactory has been called
updateValueFactory has been called
1u5
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
1u29
1u13
updateValueFactory has been called
1u14 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T23:07:48.937

在实践中，它唯一的意思是你的`addValueFactory`方法应该是线程安全的*和*幂等的，这意味着如果多次（可能同时）调用相同的值，它不会给出错误的结果。

考虑以下人为设计的示例：

```
ConcurrentDictionary<int, string> numbers = new ConcurrentDictionary<int, string>();
Parallel.For(0, 10, x =>
{
    numbers.AddOrUpdate(1,
        i =>
        {
            Console.WriteLine("addValueFactory has been called");
            return i.ToString();
        },
        (i, s) =>
        {
            Console.WriteLine("updateValueFactory has been called");
            return i.ToString();
        });
}); 
```

如果该`AddOrUpdate`方法完全同步，那么您会期望输出记录一个`addValueFactory`调用，然后是九个`updateValueFactory`调用。但是，由于提到的条款，您可能会收到多个`addValueFactory`电话。

```
addValueFactory has been called
addValueFactory has been called
addValueFactory has been called
addValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called 
```

在大多数情况下，这是一种良性竞争条件，特别是因为大多数`addValueFactory`代表不需要更改任何状态。

# javascript - 谷歌地图 api 跟踪设备

> ID：13445464
> 
> 赞同：0
> 
> 时间：2012-11-18T22:54:25.157
> 
> 标签：javascript, google-maps-api-3

基本上，我每次移动时都会尝试跟踪我的位置。

我已经设法让以下代码与`'click'`侦听器事件一起工作，只是为了测试它，我只是不确定我会动态使用正确的事件侦听器以及如何使用：

```
function mapRoute(showPosition3, position){

var routeCoordinates = [new google.maps.LatLng(53.388639, -1.4785248000000002)];

  var polyOptions = {
    path: routeCoordinates,
    strokeColor: "#FF0000",
    strokeOpacity: 1.0,
    strokeWeight: 2
  }

 flightPath = new google.maps.Polyline(polyOptions);

 flightPath.setMap(map);

google.maps.event.addListener(map, 'click', addLatLng);

}

/**
 * Handles click events on a map, and adds a new point to the Polyline.
 * @param {MouseEvent} mouseEvent
 */
function addLatLng(event) {

  var path = flightPath.getPath();

  // Because path is an MVCArray, we can simply append a new coordinate
  // and it will automatically appear
  path.push(event.latLng);

  // Add a new marker at the new plotted point on the polyline.
  var marker = new google.maps.Marker({
    position: event.latLng,
    title: '#' + path.getLength(),
    map: map
  });

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T00:10:11.103

我建议使用[geolocation.watchPosition()](https://developer.mozilla.org/en-US/docs/Using_geolocation)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T14:10:42.670

这涉及到很多细节。如果您不想从头开始编写自己的代码，可以使用[GeolocationMarker](http://google-maps-utility-library-v3.googlecode.com/svn/trunk/geolocationmarker/)，它是[Google Maps API v3 Utility Library](https://code.google.com/p/google-maps-utility-library-v3/wiki/Libraries)的一部分。它为您处理了很多小细节。由于它是开源的，因此您也可以对其进行修改以满足您的需求。

# html - 移除命中区域的蓝色边框

> ID：13445469
> 
> 赞同：0
> 
> 时间：2012-11-18T22:55:06.377
> 
> 标签：html, css, focus

我正在尝试解决如何删除这个手风琴打击区域的蓝色边框。我确信它是一个快速修复，但对于我的生活来说，它无法解决在哪里取消它。

**实时示例** [http://bradfrost.github.com/this-is-responsive/patterns/fluid-accordion.html](http://bradfrost.github.com/this-is-responsive/patterns/fluid-accordion.html)

您会注意到单击标题会使蓝色焦点框出现在其周围。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T22:57:56.903

您需要`outline:none`标题框。但是，[出于可访问性的原因，有些人建议不要这样做](http://outlinenone.com/)

# java - 如何在这个游戏中添加保存选项和其他一些东西？

> ID：13445470
> 
> 赞同：-2
> 
> 时间：2012-11-18T22:55:21.313
> 
> 标签：java, android

我已经问过这个问题，但因为不清楚，我猜人们正在回避它。我不希望所有这些事情一起完成，我只想要其中之一，特别是存档游戏之一。我需要知道编码是怎样的，这样我才能研究它并从中学习。

我想编辑这个游戏以获得一些编程经验。我想添加保存游戏，总输赢，并使用游戏的默认选项以及更改球的速度和允许的时间。

请告诉我你会怎么做，这样我在做的时候可以参考，以确保我做对了。

安卓清单

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.deitel.cannongame" android:versionCode="1"
android:versionName="1.0">
<application android:icon="@drawable/icon" 
  android:label="@string/app_name" android:debuggable="true">
  <activity android:name=".CannonGame" 
     android:label="@string/app_name"
     android:screenOrientation="portrait">
     <intent-filter>
        <action android:name="android.intent.action.MAIN" />
        <category android:name="android.intent.category.LAUNCHER" />
     </intent-filter>
  </activity>
</application>
<uses-sdk android:minSdkVersion="8" android:targetSdkVersion="10"/>
</manifest> 
```

Cannongame java

```
// CannonGame.java
// Main Activity for the Cannon Game app.
package com.deitel.cannongame;

import android.app.Activity;
import android.media.AudioManager;
import android.os.Bundle;
import android.view.GestureDetector;
import android.view.GestureDetector.SimpleOnGestureListener;
import android.view.MotionEvent;

public class CannonGame extends Activity
{
 private GestureDetector gestureDetector; // listens for double taps
 private CannonView cannonView; // custom view to display the game

 // called when the app first launches
 @Override
 public void onCreate(Bundle savedInstanceState)
 {
  super.onCreate(savedInstanceState); // call super's onCreate method
  setContentView(R.layout.main); // inflate the layout

  // get the CannonView
  cannonView = (CannonView) findViewById(R.id.cannonView);

  // initialize the GestureDetector
  gestureDetector = new GestureDetector(this, gestureListener);

  // allow volume keys to set game volume
  setVolumeControlStream(AudioManager.STREAM_MUSIC);
 } // end method onCreate

 // when the app is pushed to the background, pause it
 @Override
 public void onPause()
 {
  super.onPause(); // call the super method
  cannonView.stopGame(); // terminates the game
 } // end method onPause

 // release resources
 @Override
 protected void onDestroy()
 {
  super.onDestroy();
  cannonView.releaseResources();
} // end method onDestroy

// called when the user touches the screen in this Activity
 @Override
  public boolean onTouchEvent(MotionEvent event)
  {
  // get int representing the type of action which caused this event
  int action = event.getAction();

  // the user user touched the screen or dragged along the screen
  if (action == MotionEvent.ACTION_DOWN ||
     action == MotionEvent.ACTION_MOVE)
  {
     cannonView.alignCannon(event); // align the cannon
  } // end if

  // call the GestureDetector's onTouchEvent method
  return gestureDetector.onTouchEvent(event);
 } // end method onTouchEvent

 // listens for touch events sent to the GestureDetector
 SimpleOnGestureListener gestureListener = new SimpleOnGestureListener()
 {
  // called when the user double taps the screen
  @Override
  public boolean onDoubleTap(MotionEvent e)
  {
     cannonView.fireCannonball(e); // fire the cannonball
     return true; // the event was handled
   } // end method onDoubleTap
}; // end gestureListener
} // end class CannonGame 
```

CannonView java

```
 // CannonView.java
    // Displays the Cannon Game
    package com.deitel.cannongame;

    import java.util.HashMap;
    import java.util.Map;

    import android.app.Activity;
    import android.app.AlertDialog;
    import android.content.Context;
    import android.content.DialogInterface;
    import android.graphics.Canvas;
    import android.graphics.Color;
    import android.graphics.Paint;
    import android.graphics.Point;
    import android.media.AudioManager;
    import android.media.SoundPool;
    import android.util.AttributeSet;
    import android.view.MotionEvent;
    import android.view.SurfaceHolder;
    import android.view.SurfaceView;

    public class CannonView extends SurfaceView 
       implements SurfaceHolder.Callback
    {
       private CannonThread cannonThread; // controls the game loop
       private Activity activity; // to display Game Over dialog in GUI thread
       private boolean dialogIsDisplayed = false;   

       // constants for game play
       public static final int TARGET_PIECES = 7; // sections in the target
       public static final int MISS_PENALTY = 2; // seconds deducted on a miss
       public static final int HIT_REWARD = 3; // seconds added on a hit

       // variables for the game loop and tracking statistics
       private boolean gameOver; // is the game over?
       private double timeLeft; // the amount of time left in seconds
       private int shotsFired; // the number of shots the user has fired
       private double totalElapsedTime; // the number of seconds elapsed

       // variables for the blocker and target
       private Line blocker; // start and end points of the blocker
       private int blockerDistance; // blocker distance from left
       private int blockerBeginning; // blocker distance from top
       private int blockerEnd; // blocker bottom edge distance from top
       private int initialBlockerVelocity; // initial blocker speed multiplier
       private float blockerVelocity; // blocker speed multiplier during game

       private Line target; // start and end points of the target
       private int targetDistance; // target distance from left
       private int targetBeginning; // target distance from top
       private double pieceLength; // length of a target piece
       private int targetEnd; // target bottom's distance from top
       private int initialTargetVelocity; // initial target speed multiplier
       private float targetVelocity; // target speed multiplier during game

       private int lineWidth; // width of the target and blocker
       private boolean[] hitStates; // is each target piece hit?
       private int targetPiecesHit; // number of target pieces hit (out of 7)

       // variables for the cannon and cannonball
       private Point cannonball; // cannonball image's upper-left corner
       private int cannonballVelocityX; // cannonball's x velocity
       private int cannonballVelocityY; // cannonball's y velocity
       private boolean cannonballOnScreen; // is the cannonball on the screen
       private int cannonballSpeed; // cannonball speed
       private int cannonBaseRadius; // cannon base radius
       private int cannonLength; // cannon barrel length
       private Point barrelEnd; // the endpoint of the cannon's barrel
       private int cannonballRadius; // cannonball radius
    private int screenWidth; // width of the screen
       private int screenHeight; // height of the screen

       // constants and variables for managing sounds
       private static final int TARGET_SOUND_ID = 0;
       private static final int CANNON_SOUND_ID = 1;
       private static final int BLOCKER_SOUND_ID = 2;
       private SoundPool soundPool; // plays sound effects
       private Map<Integer, Integer> soundMap; // maps IDs to SoundPool

       // Paint variables used when drawing each item on the screen
       private Paint textPaint; // Paint used to draw text
       private Paint cannonballPaint; // Paint used to draw the cannonball
       private Paint cannonPaint; // Paint used to draw the cannon
       private Paint blockerPaint; // Paint used to draw the blocker
       private Paint targetPaint; // Paint used to draw the target
       private Paint backgroundPaint; // Paint used to clear the drawing area

       // public constructor
       public CannonView(Context context, AttributeSet attrs)
       {
          super(context, attrs); // call super's constructor
          activity = (Activity) context; 

          // register SurfaceHolder.Callback listener
          getHolder().addCallback(this); 

          // initialize Lines and points representing game items
          blocker = new Line(); // create the blocker as a Line
          target = new Line(); // create the target as a Line
          cannonball = new Point(); // create the cannonball as a point

          // initialize hitStates as a boolean array
          hitStates = new boolean[TARGET_PIECES];

          // initialize SoundPool to play the app's three sound effects
          soundPool = new SoundPool(1, AudioManager.STREAM_MUSIC, 0);

          // create Map of sounds and pre-load sounds
          soundMap = new HashMap<Integer, Integer>(); // create new HashMap
          soundMap.put(TARGET_SOUND_ID,
             soundPool.load(context, R.raw.target_hit, 1));
          soundMap.put(CANNON_SOUND_ID,
             soundPool.load(context, R.raw.cannon_fire, 1));
          soundMap.put(BLOCKER_SOUND_ID,
             soundPool.load(context, R.raw.blocker_hit, 1));

          // construct Paints for drawing text, cannonball, cannon,
          // blocker and target; these are configured in method onSizeChanged
          textPaint = new Paint(); // Paint for drawing text
          cannonPaint = new Paint(); // Paint for drawing the cannon
          cannonballPaint = new Paint(); // Paint for drawing a cannonball
          blockerPaint = new Paint(); // Paint for drawing the blocker
          targetPaint = new Paint(); // Paint for drawing the target
          backgroundPaint = new Paint(); // Paint for drawing the target
       } // end CannonView constructor

       // called by surfaceChanged when the size of the SurfaceView changes,
       // such as when it's first added to the View hierarchy
       @Override
       protected void onSizeChanged(int w, int h, int oldw, int oldh)
       {
          super.onSizeChanged(w, h, oldw, oldh);

          screenWidth = w; // store the width
          screenHeight = h; // store the height
          cannonBaseRadius = h / 18; // cannon base radius 1/18 screen height
          cannonLength = w / 8; // cannon length 1/8 screen width

          cannonballRadius = w / 36; // cannonball radius 1/36 screen width
          cannonballSpeed = w * 3 / 2; // cannonball speed multiplier

          lineWidth = w / 24; // target and blocker 1/24 screen width

          // configure instance variables related to the blocker
          blockerDistance = w * 5 / 8; // blocker 5/8 screen width from left
          blockerBeginning = h / 8; // distance from top 1/8 screen height
          blockerEnd = h * 3 / 8; // distance from top 3/8 screen height
          initialBlockerVelocity = h / 2; // initial blocker speed multiplier
          blocker.start = new Point(blockerDistance, blockerBeginning);
          blocker.end = new Point(blockerDistance, blockerEnd);

          // configure instance variables related to the target
          targetDistance = w * 7 / 8; // target 7/8 screen width from left
          targetBeginning = h / 8; // distance from top 1/8 screen height
          targetEnd = h * 7 / 8; // distance from top 7/8 screen height
          pieceLength = (targetEnd - targetBeginning) / TARGET_PIECES;
          initialTargetVelocity = -h / 4; // initial target speed multiplier
          target.start = new Point(targetDistance, targetBeginning);
          target.end = new Point(targetDistance, targetEnd);

          // endpoint of the cannon's barrel initially points horizontally
          barrelEnd = new Point(cannonLength, h / 2);

          // configure Paint objects for drawing game elements
          textPaint.setTextSize(w / 20); // text size 1/20 of screen width
          textPaint.setAntiAlias(true); // smoothes the text
          cannonPaint.setStrokeWidth(lineWidth * 1.5f); // set line thickness
          blockerPaint.setStrokeWidth(lineWidth); // set line thickness      
          targetPaint.setStrokeWidth(lineWidth); // set line thickness       
          backgroundPaint.setColor(Color.WHITE); // set background color

          newGame(); // set up and start a new game
       } // end method onSizeChanged

       // reset all the screen elements and start a new game
       public void newGame()
       {
          // set every element of hitStates to false--restores target pieces
          for (int i = 0; i < TARGET_PIECES; ++i)
             hitStates[i] = false;

          targetPiecesHit = 0; // no target pieces have been hit
          blockerVelocity = initialBlockerVelocity; // set initial velocity
          targetVelocity = initialTargetVelocity; // set initial velocity
          timeLeft = 10; // start the countdown at 10 seconds
          cannonballOnScreen = false; // the cannonball is not on the screen
          shotsFired = 0; // set the initial number of shots fired
          totalElapsedTime = 0.0; // set the time elapsed to zero
          blocker.start.set(blockerDistance, blockerBeginning);
          blocker.end.set(blockerDistance, blockerEnd);
          target.start.set(targetDistance, targetBeginning);
          target.end.set(targetDistance, targetEnd);

          if (gameOver)
          {
             gameOver = false; // the game is not over
             cannonThread = new CannonThread(getHolder());
             cannonThread.start();
          } // end if
       } // end method newGame

       // called repeatedly by the CannonThread to update game elements
       private void updatePositions(double elapsedTimeMS)
       {
          double interval = elapsedTimeMS / 1000.0; // convert to seconds

          if (cannonballOnScreen) // if there is currently a shot fired
          {
             // update cannonball position
             cannonball.x += interval * cannonballVelocityX;
             cannonball.y += interval * cannonballVelocityY;

             // check for collision with blocker
             if (cannonball.x + cannonballRadius > blockerDistance && 
                cannonball.x - cannonballRadius < blockerDistance &&
                cannonball.y + cannonballRadius > blocker.start.y &&
                cannonball.y - cannonballRadius < blocker.end.y)
             {
                cannonballVelocityX *= -1; // reverse cannonball's direction
                timeLeft -= MISS_PENALTY; // penalize the user

                // play blocker sound
                soundPool.play(soundMap.get(BLOCKER_SOUND_ID), 1, 1, 1, 0, 1f);
             } // end if

             // check for collisions with left and right walls
             else if (cannonball.x + cannonballRadius > screenWidth || 
                cannonball.x - cannonballRadius < 0)
                cannonballOnScreen = false; // remove cannonball from screen

             // check for collisions with top and bottom walls
             else if (cannonball.y + cannonballRadius > screenHeight || 
                cannonball.y - cannonballRadius < 0)
                cannonballOnScreen = false; // make the cannonball disappear

             // check for cannonball collision with target
             else if (cannonball.x + cannonballRadius > targetDistance && 
                cannonball.x - cannonballRadius < targetDistance && 
                cannonball.y + cannonballRadius > target.start.y &&
                cannonball.y - cannonballRadius < target.end.y)
             {
                // determine target section number (0 is the top)
                int section = 
                   (int) ((cannonball.y - target.start.y) / pieceLength);

                // check if the piece hasn't been hit yet
                if ((section >= 0 && section < TARGET_PIECES) && 
                   !hitStates[section])
                {
                   hitStates[section] = true; // section was hit
                   cannonballOnScreen = false; // remove cannonball
                   timeLeft += HIT_REWARD; // add reward to remaining time

                   // play target hit sound
                   soundPool.play(soundMap.get(TARGET_SOUND_ID), 1,
                      1, 1, 0, 1f);

                   // if all pieces have been hit
                   if (++targetPiecesHit == TARGET_PIECES)
                   {
                      cannonThread.setRunning(false);
                      showGameOverDialog(R.string.win); // show winning dialog
                      gameOver = true; // the game is over
                   } // end if
                } // end if
             } // end else if
          } // end if

          // update the blocker's position
          double blockerUpdate = interval * blockerVelocity;
          blocker.start.y += blockerUpdate;
          blocker.end.y += blockerUpdate;

          // update the target's position
          double targetUpdate = interval * targetVelocity;
          target.start.y += targetUpdate;
          target.end.y += targetUpdate;

          // if the blocker hit the top or bottom, reverse direction
          if (blocker.start.y < 0 || blocker.end.y > screenHeight)
             blockerVelocity *= -1;

          // if the target hit the top or bottom, reverse direction
          if (target.start.y < 0 || target.end.y > screenHeight)
             targetVelocity *= -1;

          timeLeft -= interval; // subtract from time left

          // if the timer reached zero
          if (timeLeft <= 0.0)
          {
             timeLeft = 0.0;
             gameOver = true; // the game is over
             cannonThread.setRunning(false);
             showGameOverDialog(R.string.lose); // show the losing dialog
          } // end if
       } // end method updatePositions

       // fires a cannonball
       public void fireCannonball(MotionEvent event)
       {
          if (cannonballOnScreen) // if a cannonball is already on the screen
             return; // do nothing

          double angle = alignCannon(event); // get the cannon barrel's angle

          // move the cannonball to be inside the cannon
          cannonball.x = cannonballRadius; // align x-coordinate with cannon
          cannonball.y = screenHeight / 2; // centers ball vertically

          // get the x component of the total velocity
          cannonballVelocityX = (int) (cannonballSpeed * Math.sin(angle));

          // get the y component of the total velocity
          cannonballVelocityY = (int) (-cannonballSpeed * Math.cos(angle));
          cannonballOnScreen = true; // the cannonball is on the screen
          ++shotsFired; // increment shotsFired

          // play cannon fired sound
          soundPool.play(soundMap.get(CANNON_SOUND_ID), 1, 1, 1, 0, 1f);
       } // end method fireCannonball

       // aligns the cannon in response to a user touch
       public double alignCannon(MotionEvent event)
       {
          // get the location of the touch in this view
          Point touchPoint = new Point((int) event.getX(), (int) event.getY());

          // compute the touch's distance from center of the screen
          // on the y-axis
          double centerMinusY = (screenHeight / 2 - touchPoint.y);

          double angle = 0; // initialize angle to 0

          // calculate the angle the barrel makes with the horizontal
          if (centerMinusY != 0) // prevent division by 0
             angle = Math.atan((double) touchPoint.x / centerMinusY);

          // if the touch is on the lower half of the screen
          if (touchPoint.y > screenHeight / 2)
             angle += Math.PI; // adjust the angle

          // calculate the endpoint of the cannon barrel
          barrelEnd.x = (int) (cannonLength * Math.sin(angle));
          barrelEnd.y = 
             (int) (-cannonLength * Math.cos(angle) + screenHeight / 2);

          return angle; // return the computed angle
       } // end method alignCannon

       // draws the game to the given Canvas
       public void drawGameElements(Canvas canvas)
       {
          // clear the background
          canvas.drawRect(0, 0, canvas.getWidth(), canvas.getHeight(), 
             backgroundPaint);

          // display time remaining
          canvas.drawText(getResources().getString(
             R.string.time_remaining_format, timeLeft), 30, 50, textPaint);

          // if a cannonball is currently on the screen, draw it
          if (cannonballOnScreen)
             canvas.drawCircle(cannonball.x, cannonball.y, cannonballRadius,
                cannonballPaint);

          // draw the cannon barrel
          canvas.drawLine(0, screenHeight / 2, barrelEnd.x, barrelEnd.y,
             cannonPaint);

          // draw the cannon base
          canvas.drawCircle(0, (int) screenHeight / 2,
             (int) cannonBaseRadius, cannonPaint);

          // draw the blocker
          canvas.drawLine(blocker.start.x, blocker.start.y, blocker.end.x,
             blocker.end.y, blockerPaint);

          Point currentPoint = new Point(); // start of current target section

          // initialize curPoint to the starting point of the target
          currentPoint.x = target.start.x;
          currentPoint.y = target.start.y;

          // draw the target
          for (int i = 1; i <= TARGET_PIECES; ++i)
          {
             // if this target piece is not hit, draw it
             if (!hitStates[i - 1])
             {
                // alternate coloring the pieces yellow and blue
                if (i % 2 == 0)
                   targetPaint.setColor(Color.YELLOW);
                else
                   targetPaint.setColor(Color.BLUE);

                canvas.drawLine(currentPoint.x, currentPoint.y, target.end.x,
                   (int) (currentPoint.y + pieceLength), targetPaint);
             } // end if

             // move curPoint to the start of the next piece
             currentPoint.y += pieceLength;
          } // end for
       } // end method drawGameElements

       // display an AlertDialog when the game ends
       private void showGameOverDialog(int messageId)
       {
          // create a dialog displaying the given String
          final AlertDialog.Builder dialogBuilder = 
             new AlertDialog.Builder(getContext());
          dialogBuilder.setTitle(getResources().getString(messageId));
          dialogBuilder.setCancelable(false);

          // display number of shots fired and total time elapsed
          dialogBuilder.setMessage(getResources().getString(
             R.string.results_format, shotsFired, totalElapsedTime));
          dialogBuilder.setPositiveButton(R.string.reset_game,
             new DialogInterface.OnClickListener()
             {
                // called when "Reset Game" Button is pressed
                public void onClick(DialogInterface dialog, int which)
                {
                   dialogIsDisplayed = false;
                   newGame(); // set up and start a new game
                } // end method onClick
             } // end anonymous inner class
          ); // end call to setPositiveButton

          activity.runOnUiThread(
             new Runnable() {
                public void run()
                {
                   dialogIsDisplayed = true;
                   dialogBuilder.show(); // display the dialog
                } // end method run
             } // end Runnable
          ); // end call to runOnUiThread
       } // end method showGameOverDialog

       // stops the game
       public void stopGame()
       {
          if (cannonThread != null)
             cannonThread.setRunning(false);
       } // end method stopGame

       // releases resources; called by CannonGame's onDestroy method 
       public void releaseResources()
       {
          soundPool.release(); // release all resources used by the SoundPool
          soundPool = null; 
       } // end method releaseResources

       // called when surface changes size
       public void surfaceChanged(SurfaceHolder holder, int format,
          int width, int height)
       {
       } // end method surfaceChanged

       // called when surface is first created
       public void surfaceCreated(SurfaceHolder holder)
       {
          if (!dialogIsDisplayed)
          {
             cannonThread = new CannonThread(holder);
             cannonThread.setRunning(true);
             cannonThread.start(); // start the game loop thread
          } // end if
       } // end method surfaceCreated

       // called when the surface is destroyed
       public void surfaceDestroyed(SurfaceHolder holder)
       {
          // ensure that thread terminates properly
          boolean retry = true;
          cannonThread.setRunning(false);

          while (retry)
          {
             try
             {
                cannonThread.join();
                retry = false;
             } // end try
             catch (InterruptedException e)
             {
             } // end catch
          } // end while
       } // end method surfaceDestroyed

       // Thread subclass to control the game loop
       private class CannonThread extends Thread
       {
          private SurfaceHolder surfaceHolder; // for manipulating canvas
          private boolean threadIsRunning = true; // running by default

          // initializes the surface holder
          public CannonThread(SurfaceHolder holder)
          {
             surfaceHolder = holder;
             setName("CannonThread");
          } // end constructor

          // changes running state
          public void setRunning(boolean running)
          {
             threadIsRunning = running;
          } // end method setRunning

          // controls the game loop
          @Override
          public void run()
          {
             Canvas canvas = null; // used for drawing
             long previousFrameTime = System.currentTimeMillis(); 

             while (threadIsRunning)
             {
                try
                {
                   canvas = surfaceHolder.lockCanvas(null);               

                   // lock the surfaceHolder for drawing
                   synchronized(surfaceHolder)
                   {
                      long currentTime = System.currentTimeMillis();
                      double elapsedTimeMS = currentTime - previousFrameTime;
                      totalElapsedTime += elapsedTimeMS / 1000.00; 
                      updatePositions(elapsedTimeMS); // update game state
                      drawGameElements(canvas); // draw 
                      previousFrameTime = currentTime; // update previous time
                   } // end synchronized block
                } // end try
                finally
                {
                   if (canvas != null) 
                      surfaceHolder.unlockCanvasAndPost(canvas);
                } // end finally
             } // end while
          } // end method run
       } // end nested class CannonThread
    } // end class CannonView 
```

线java

```
 // Line.java
    // Class Line represents a line with two endpoints.
    package com.deitel.cannongame;

    import android.graphics.Point;

    public class Line
    {
       public Point start; // starting Point
       public Point end; // ending Point

       // default constructor initializes Points to (0, 0)
       public Line()
       {
          start = new Point(0, 0); // start Point
          end = new Point(0, 0); // end Point
       } // end method Line
    } // end class Line 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-11-18T23:35:36.057

要保存分数，您必须保留它。我在我的游戏中所做的是将它保存在 SharedPreferences 中，更多信息在这里：

[http://developer.android.com/reference/android/content/SharedPreferences.html](http://developer.android.com/reference/android/content/SharedPreferences.html)

我进行分数跟踪的方法是创建一个名为`GameData`（从 Object 派生，没有 Activity）的类，并为分数实现一个静态 setter 和 getter，如下所示：

```
public class GameData{
    private static final String GAME_DATA_FILE_NAME = "GAME_DATA_FILE_NAME";
    private static final String GAME_DATA_WINS = "GAME_DATA_WINS";
    private static final String GAME_DATA_LOSSES = "GAME_DATA_LOSSES";
    public static void updateGameWinResults(Context ctx, Boolean gameWon){
        if(gameWon){
            ctx.getSharedPreferences(GAME_DATA_FILE_NAME, Context.MODE_PRIVATE).edit().putInt(GAME_DATA_WINS, getGameWins(ctx) + 1).commit();
        } else {
            ctx.getSharedPreferences(GAME_DATA_FILE_NAME, Context.MODE_PRIVATE).edit().putInt(GAME_DATA_WINS, getGameLosses(ctx) + 1).commit();
        }
    }
    public static int getGameWins(Context ctx)
        SharedPreferences sp = c.getSharedPreferences(GAME_DATA_FILE_NAME, Context.MODE_PRIVATE);
            return sp.getInt(GAME_DATA_WINS, 0);
    }
    public static int getGameLosses(Context ctx){
        SharedPreferences sp = c.getSharedPreferences(GAME_DATA_FILE_NAME, Context.MODE_PRIVATE);
            return sp.getInt(GAME_DATA_LOSSES, 0);
    }
} 
```

当然，在您的代码中，从活动中的任何地方（尽管我建议您在游戏结束并尝试保存数据时将保存部分粘贴在某处），您只需调用：

```
GameData.updateGameWinResults(this,false); // if they lost... give it a true if they won 
```

并获得胜利，请执行以下操作：

```
int wins = GameData.getGameWins(this); 
```

或为损失做：

```
int losses = GameData.getGameLosses(this); 
```

甚至获得总游戏数（假设只有输赢）：

```
int gamesPlayed = GameData.getGameWins(this) + GameData.getGameLosses(this); 
```

至于保存选项，使用相同的机制也很容易实现。说得通？

但是这个答案开始变得很长了。如果您对其他部分感到困惑（在您尝试了 ppl 的解决方案之后，我建议您将其作为一个单独的问题提出，就其他选项而言。这样，您就有机会给 Stack Overflow 用户更多积分，通过投票和接受）

# jquery - Embedly (JQuery-Preview) 结果的位置

> ID：13445474
> 
> 赞同：3
> 
> 时间：2012-11-18T22:55:58.323
> 
> 标签：jquery, ruby-on-rails

Embedly/Jquery-Preview 非常棒。但是，我正在尝试更改预览结果的位置，但遇到了麻烦。现在，结果出现在输入字段的正下方......但我宁愿将它放在页面的单独部分中。有没有办法做到这一点？

我尝试更改选择器的位置并加载 div，但这并没有帮助。它似乎忽略了那些 div 并将其放在提交按钮的正下方。

下面是我的代码：

```
 <form accept-charset="UTF-8" action="private" class="new_comment" data-remote="true" id="new_comment" method="post">
   <input class="photo_comm" id="comment_comment" name="comment[comment]" placeholder="add a comment or link..." size="30" type="text" /><span type="text" id="counter">1000</span>
   <input class="btn btn-primary btn-mini" data-disable-with="Submitting..." name="commit" type="submit" value="Post" />
   </form>

   <!-- Placeholder that tells Preview where to put the loading icon-->
   <div class="loading">
        <img src='http://embedly.github.com/jquery-preview/images/loading-rectangle.gif'>
   </div>

   <!-- Placeholder that tells Preview where to put the selector-->
   <div class="selector"></div> 
```

```
$('#comment_comment').preview({ key:'60f1dcdf3258476794784148a6eb65e7', // Sign up for a key: http://embed.ly/pricing
  selector : {type:'rich'},
  preview : {
    submit : function(e, data){
      e.preventDefault();
      $.ajax({
        dataType: 'script',
        url: this.form.attr('action'),
        type: 'POST',
        data: data
      });
    },
  },
  autoplay : 0,
  maxwidth : 400,
  display : {display : 'rich'}
}); 
```

*更新*

我可以在表单内上下移动选择器（）......但不能将它移到表单之外，或者在选择器 div 和表单末尾之间放置一个。我需要将选择器移到表单之外，这就是问题所在。任何帮助都会很棒。谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-21T20:11:00.377

我相信您实际上必须在选择器对象上设置选择器，而不是在显示上。

尝试：

```
...
selector : {type:'rich', selector: '#show_me'},
... 
```

请注意，选择器需要位于表单元素内。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T01:59:36.750

显示选项有`selector`选项

来自[文档](http://embedly.github.com/jquery-preview/demo/index.html)

**显示**
为给定对象创建一个 Feed 项。
.....
选择器
    告诉创建将Feed项html添加到的位置。默认值为#feed。

使用您的样品：

HTML：

```
<div id="show_here"></div>
<form accept-charset="UTF-8" action="private" class="new_comment" data-remote="true" id="new_comment" method="post">
   <input class="photo_comm" id="comment_comment" name="comment[comment]" placeholder="add a comment or link..." size="30" type="text" /><span type="text" id="counter">1000</span>
   <input class="btn btn-primary btn-mini" data-disable-with="Submitting..." name="commit" type="submit" value="Post" />
   </form>

   <!-- Placeholder that tells Preview where to put the loading icon-->
   <div class="loading">
        <img src='http://embedly.github.com/jquery-preview/images/loading-rectangle.gif'>
   </div> 
```

JS：

```
$('#comment_comment').preview({ key:'60f1dcdf3258476794784148a6eb65e7', // Sign up for a key: http://embed.ly/pricing
  selector : {type:'rich'},
  preview : {
    submit : function(e, data){
      e.preventDefault();
      $.ajax({
        dataType: 'script',
        url: this.form.attr('action'),
        type: 'POST',
        data: data
      });
    }
  },
  autoplay : 0,
  maxwidth : 400,
  display : {display : 'rich',selector : "#show_here"}
}); 
```

# oracle - Oracle：表正在变异

> ID：13445477
> 
> 赞同：0
> 
> 时间：2012-11-18T22:56:14.673
> 
> 标签：oracle

我创建了一个没有错误的触发器，并且我有一个变异表，我以前从未遇到过这个问题，这似乎是什么问题？

以下是截图 ![在此处输入图像描述](../Images/d5ed31a852e536a3b2a81963287ef11b.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T23:00:02.487

行不会立即更改，更改是逐行进行的，每次更改后都会调用触发器。

当它被调用时 - 它从同一个半更改的表中选择。这是不一致的，因此 - oracle 会阻止您这样做。

您可能可以将其更改为`FOR EACH STATEMENT`并按您想要的方式处理一堆行，甚至重新考虑该任务（您可能会错误地解决它）

# css - 在较小的 div 中居中大图像

> ID：13445482
> 
> 赞同：1
> 
> 时间：2012-11-18T22:57:11.893
> 
> 标签：css

我正在尝试在滑块 div 的中心对齐图像。顺便说一下，我正在调整 FlexSlider css。这是我的 CSS 代码：

```
.flexslider {margin: 0; padding: 0; width: 600px; height:480px; overflow:hidden;margin-left:auto;margin-right:auto;}
.flexslider .slides > li {display: none; -webkit-backface-visibility: hidden;} /* Hide the slides before the JS is loaded. Avoids image jumping */
.flexslider .slides img {width:auto;height:100%; display: inline-block; text-align:center;} 
```

一切都按我的意愿工作，除了我希望更宽的图像在 div 中居中。现在它是左对齐的。顺便说一句，我不能使用背景图像。有任何想法吗？

我还尝试申请 .flexslider .slides img ：

`margin-left:-50%`...不工作 `margin-left:auto`和`margin-right:auto`......不工作 `left:50%`和`right:50%`......也不工作

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T23:47:17.287

我自己发现的。我只需要添加`text-align:center`到`.flexslider .slides > li`行中就可以了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T23:10:21.430

**像这样试试**

**HTML**

```
<div class="imageContainer">
    <span style="width: 1000px; margin-left: -450px;"><img src="http://dummyimage.com/100x100/f0f/fff" /></span>
</div> 
```

**CSS**

```
.imageContainer {
    border: 1px solid #444;
    overflow: hidden;
    width: 100px;
    height: 100px;
    margin: 15px;
    text-align: center;
}
.imageContainer > span {
    display: block;
}
.imageContainer > span > img {
    display: inline-block;
} 
```

这将适用于所有浏览器，IE6 可能除外。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-18T23:08:16.227

要将图像以宽度居中，您可以这样做：

```
<!-- The place you want the "centered image" -->
<div style="position: relative;width: 600px;height: 480px;overflow: hidden;">
    <div style="position: absolute;left: -700px;width: 2000px;height: 480px;">
        <img src="image.jpg" style="margin: 0 auto;" />
    </div>
</div> 
```

要以高度居中，您将遇到与每个人相同的问题，但您可以创建一个只有一个单元格的表格并使用`vertical-align: middle;`

```
<!-- The place you want the "centered image" -->
<div style="position: relative;width: 600px;height: 480px;overflow: hidden;">
    <table style="position: absolute;left: -700px;top: -760px;width: 2000px;height: 2000px;">
        <tr><td style="vertical-align: middle;"><img src="image.jpg" style="margin: 0 auto;" /></td></tr>
    </div>
</div> 
```

希望这可以帮助！

# java - JAVA MySql 多词搜索

> ID：13445489
> 
> 赞同：-1
> 
> 时间：2012-11-18T22:58:12.057
> 
> 标签：java, mysql, search

我在 MySql 中有一个数据库，其中有一个名称列，其中包含几个单词（描述）。我通过eclipse用java连接到数据库。我有一个搜索，如果只有名称字段包含一个单词，则返回结果。id：........姓名：........信息：............ ..........类型：>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> >> 1........气球............大红色气球...... ..大>>>>>>>>>>>>>>>>>>>>> 2........房子...... ....昂贵美丽............豪华>>>>>>>>>>>>>>>>>>>>>>>>>>> 3..... ......鸡翅............炸翅......美味

这些只是随机词，但作为一个例子，我的搜索只能看到 ex。气球然后显示信息，但如果我输入鸡翅，它什么也不做。所以有可能以某种方式从包含多个单词的列中搜索？这是我下面的搜索代码

```
import java.io.*;
import java.sql.*;
import java.util.*;

class Search {

public static void main(String[] args) {
    Scanner inp``ut = new Scanner(System.in);

    try {
        Connection con = DriverManager.getConnection(
                "jdbc:mysql://example/mydb", "user", "password");
        Statement stmt = (Statement) con.createStatement();

        System.out.print("enter search: ");
        String name = input.next();

            String SQL = "SELECT * FROM menu where name LIKE '" + name + "'";

        ResultSet rs = stmt.executeQuery(SQL);

        while (rs.next()) {
            System.out.println("Name: " +rs.getString("name"));
            System.out.println("Description:  " + rs.getString("info") );
            System.out.println("Price: " + rs.getString("Price"));

        }

    } catch (Exception e) {
        System.out.println("ERROR: " + e.getMessage());
    }
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T23:05:27.560

您现在执行搜索的方式，一开始您很容易受到[sql 注入](http://en.wikipedia.org/wiki/SQL_injection)的攻击，并且可能希望使用 JDBC 的 PreparedStatement 而不是普通语句。

其次，我建议在空格处拆分用户输入并使用“OR”单独搜索所有术语。

示例：用户输入`house expensive beautiful`

搜索将是：

```
SELECT * FROM menu where name LIKE '%house%' OR name LIKE '%expensive%' OR name LIKE '%beaufitful%' 
```

我放了百分号，因为如果您要搜索“房屋”，则只会匹配确切的术语“房屋”。通过使用“%house%”搜索，还会找到字符串“somethingbeforehouse”和“houseandsomethingafter”。

希望这对你有帮助！

# macos - Flex AIR 3.4 应用程序在 OSX 上崩溃：*** 警告：方法 setMnemonicLocation：在类 AIR_PlayerContentMenuItem 中已过时

> ID：13445490
> 
> 赞同：2
> 
> 时间：2012-11-18T22:58:16.890
> 
> 标签：macos, apache-flex, air

有人在 OSX 上遇到过 FlexNativeMenu 的问题吗？我的应用程序已准备好沙盒，并已获得 Mac App Store 的批准。我正在使用 Flash Builder 4.6 和 AIR 3.4 SDK。崩溃不会发生在所有计算机上，但控制台警告会发生。

我尝试使用 xml/e4x 和对象数组作为数据提供者。我尝试过使用和不使用 keyEquivalents。即使是最简单的菜单也会导致错误。Mac 控制台中报告的完整错误消息是：

" *** 警告：方法 setMnemonicLocation：在类 AIR_PlayerContentMenuItem 中已过时，将在版本 GM 中删除 *** "

如果从源中删除 FlexNativeMenu，应用程序将在沙箱中运行而不会出错。

///

我确实在 Mac 开发人员库中找到了以下似乎相关的内容：这让我认为 AIR 3.4 SDK 正在调用已弃用的方法。

setMnemonicLocation：已弃用。在要加下划线的位置设置菜单项标题的字符。（在 OS X v10.6 中已弃用。）

*   (void)setMnemonicLocation:(NSUInteger)location 参数 location 标题字符数组的整数索引。location 必须是从 0 到 254。 讨论 此字符标识用户可以访问菜单项的访问键。

可用性 在 OS X v10.0 及更高版本中可用。在 OS X v10.6 中已弃用。另见——在 NSMenuItem.h 中声明的 mnemonicLocation

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T16:26:00.103

我发现的唯一解决方法是使用 NativeMenu 而不是 FlexNativeMenu 来实现菜单。这完全消除了 OS X 控制台中的 setMmemonicLocation WARNING。

# sqlite - 在 C++ 中使用 SQLite 执行查询时出错

> ID：13445494
> 
> 赞同：0
> 
> 时间：2012-11-18T22:58:58.110
> 
> 标签：sqlite

好的，我的代码中有两种方法：一种用于创建数据库，另一种用于插入记录。他们来了：

```
void DatabaseManager::insert_entry_into_database() {
ostringstream ss;
int choice;

do {
    cout << "Press 1 to add a teacher or 2 for student";
    cin >> choice;
} while (choice != 1 && choice != 2);       

if (choice == 1) {
    Teacher t;
    ss << "INSERT INTO Teachers ('" << t.get_firstName() << "', '" << t.get_lastName() << "', " << t.get_NID() 
        << ", " << t.get_avg_horarium() << ");";
}

const string tmp = ss.str();
const char *query = tmp.c_str();

cout << query;

sqlite3_open("Database.sqlite", &database);
if (sqlite3_prepare_v2(database, query, -1, &statement, 0) == SQLITE_OK) {
    cout << "A new record has been added to the database!" << endl;
}
else {
    cout << "Error adding new record!";
}   
sqlite3_finalize(statement);
sqlite3_close(database); 
}

void DatabaseManager::create_database() {
sqlite3_open("Database.sqlite", &database);

char * query = "CREATE TABLE Students (firstName STRING, lastName STRING, NID BIGINT, grade DOUBLE);";

if (sqlite3_prepare_v2(database, query, -1, &statement, 0) == SQLITE_OK) {
    cout << "Empty database with students created!" << endl;
}

query = "CREATE TABLE Teachers (firstName STRING, lastName STRING, NID BIGINT, avg_horarium INT);";

if (sqlite3_prepare_v2(database, query, -1, &statement, 0) == SQLITE_OK) {
    cout << "Empty database with teachers created!" << endl;
}

sqlite3_finalize(statement);
sqlite3_close(database); 
```

}

我在主函数中测试它们：

```
int _tmain(int argc, _TCHAR* argv[])
{
DatabaseManager m;
m.create_database();
m.insert_entry_into_database();
return 0;
} 
```

创建表查询似乎成功并且确认消息显示在控制台上，但插入查询被视为无效。我添加了一个 cout << 查询调用以确保它是正确的并且它是百分百有效的。这有什么问题？

* * *

选择方法

```
vector<vector<string>> DatabaseManager::select_entry() {
vector<vector<string>> results;
sqlite3_open("Database.sqlite", &database);

char* query = "SELECT firstName FROM Teachers WHERE firstName = 'Ivan';";
cout << query;

if (sqlite3_prepare_v2(database, query, -1, &statement, 0) == SQLITE_OK) {
    int cols = sqlite3_column_count(statement);
    int result = 0;

    while (true) {
        result = sqlite3_step(statement);

        if (result == SQLITE_ROW) {
            cout << "test"; 
            vector<string> values;
            for (int i=0; i<cols; i++) {
                cout << (char*)sqlite3_column_text(statement, i);
                values.push_back((char*)sqlite3_column_text(statement, i));
            }
            results.push_back(values);
        }
        else break;
    }

    sqlite3_finalize(statement);
    string error = sqlite3_errmsg(database);
    if(error != "not an error") cout << query << " " << error << endl;

    return results;
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T15:02:42.057

[INSERT 语句](http://sqlite.org/lang_insert.html)的有效语法是

```
INSERT INTO MyTable(Col1, Col2, ...) VALUES (value1, value2, ...) 
```

或者

```
INSERT INTO MyTable VALUES (value1, value2, ...) 
```

您省略`VALUES`了 ，因此 SQLite 认为括号内的内容是列名列表。

* * *

数据库文件由`sqlite3_open`.

* * *

您需要调用[`sqlite3_step`](http://www.sqlite.org/c3ref/step.html)以实际执行您的命令。

# sql - 寻找最常被击中的人

> ID：13445495
> 
> 赞同：2
> 
> 时间：2012-11-18T22:59:11.980
> 
> 标签：sql, oracle, sqlplus

我是 SQL 新手，正在努力学习它。我遇到的一个问题是如何在表格中找到一个人的最大特定事件数。我不确定查询如何将每个 ID 与另一个 ID 进行比较并跟踪计数。不好的解释，但这里有一个数据集，希望能让它更清楚。

```
players:
+--------+--------+
| pid    | name   |
+--------+--------+
| 1      | Tom    |
| 2      | Sam    |
| 3      | Dan    |
+--------+--------+

scores:
+--------+--------+--------+
| sid    | pid    | result |
+--------+--------+--------+
| 1      | 1      | miss   |
| 2      | 1      | hit    |
| 3      | 3      | hit    |
| 4      | 2      | miss   |
| 5      | 3      | hit    |
| 6      | 3      | hit    |
+--------+--------+--------+ 
```

预期的答案是 pid = 3, name = Dan，因为他在所有其他玩家中的命中率最高。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T23:03:42.980

```
Select
  p.pid,
  p.name
From (
  Select
    p.pid,
    p.name,
    count(*)
  From
    players p
      inner join
    scores s On
      p.pid = s.pid
  Where
    result = 'hit'
  Group By
    p.pid,
    p.name
  Order By
    count(*) Desc
  ) p
Where 
  rownum = 1; 
```

[http://sqlfiddle.com/#!4/03ba0/22](http://sqlfiddle.com/#!4/03ba0/22)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T23:05:08.393

试试这个： [**SQLFiddle 演示**](http://sqlfiddle.com/#!4/3a2d8/26)

```
select  pid, hits from(
    Select p.pid, count(*) as hits FROM players p
    JOIN scores s
         ON p.pid = s.pid AND s.result = 'hit'
    GROUP BY p.pid
    ORDER By count(*) DESC
)
Where rownum <= 1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-18T23:41:21.070

这也可能是一个解决方案：

```
select
  players.pid,
  players.name
from
  scores inner join players
  on scores.pid = players.pid
  and scores.result = 'hit'
group by players.pid, players.name
having count(*)=(select max(cnt)
                 from
                   (select pid, count(*) as cnt
                    from scores
                    where result='hit'
                    group by pid) t) 
```

请注意，如果他们都具有相同的命中数，这将返回多个玩家。还要注意，如果一名球员出现在分数表中但不在球员表中，它将不会显示。

# r - 数值分类器 (?) Weka / R

> ID：13445496
> 
> 赞同：3
> 
> 时间：2012-11-18T22:59:17.980
> 
> 标签：r, weka, numerical, classification

我有一个具有“n 到 m”关系的数字数据集（作为数据库表）。例如：

```
A | B
-----
1 | 1
1 | 2
1 | 9
4 | 2
7 | 8
7 | 11 
```

而且我想“训练”一个分类器（使用 weka？）来告诉我哪个 A 最有可能成为一组 B。举个例子：[1,2,8] 应该告诉我一些类似于 {1:2, 4:1, 7:1} 的内容，即：“集合是在 AN 时代找到的”

我当然可以用 sql 和我最喜欢的脚本语言来实现它。但是，我想知道是否有更多 - 我猜是“正式的” - 方式来做到这一点。我有 weka 正在运行，并且我的数据库已连接，但是我迷失了要采用哪个分类器（许多拒绝服务），我也非常感谢一些理论背景的链接（例如，它叫什么我喜欢做的事情和存在哪些改进）。

如果您在 R 中更通用，我也会欣赏“R”方式。（但是，我不仅对解决我的问题感兴趣，而且对了解这是什么类型的问题感兴趣——我会通过 weka 解决方案。）我很抱歉如果这是一个重复的问题，但遗憾的是我缺乏信息来指定我在这里寻找什么。可视化和其他学习和研究的输出会很棒，你。

我提前感谢您，只是为了阅读并希望您能提供帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T23:05:04.440

在 R 中，您可以执行以下操作：

```
foo = data.frame(A=c(1,1,1,4,7,7),B=c(1,2,9,2,8,11))
foo
#   A  B
# 1 1  1
# 2 1  2
# 3 1  9
# 4 4  2
# 5 7  8
# 6 7 11

table(foo[foo$B %in% c(1,2,8),]$A)

# 1 4 7 
# 2 1 1 
```

你还需要什么吗？

# matlab - 2幅图像之间的相关性

> ID：13445497
> 
> 赞同：5
> 
> 时间：2012-11-18T22:59:32.613
> 
> 标签：matlab, image-processing, matrix, correlation

我试图在图像大小为 PXP 的两个图像 f1 和 f2 之间找到以下相关性。

我已经为此编写了一个 for 循环程序，但我认为内置函数会更快。

![在此处输入图像描述](../Images/5e11fb53d7ca9b83bd2d5677b509bb1a.png)

matlab 中的哪个函数可以帮助我计算这个？

此外，如果两个图像的大小都是 MXN，有人可以告诉我这个公式将如何变化，或者函数是否能够处理它。

编辑：

有没有比**xcorr2**更快的函数可以帮助我看到当我只需要具有关联未移位图像的值时花费太多时间......

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-18T23:04:40.333

这是用于在两个图像（矩阵）之间进行相关（系数）的函数：

r = corr2(A,B) 计算 A 和 B 之间的相关系数，其中 A 和 B 是相同大小的矩阵或向量。

而 xcorr2 (A, B) 解决交叉相关问题。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-18T23:02:31.460

MATLAB[`xcorr2`](http://www.mathworks.com/help/signal/ref/xcorr2.html)正是为此目的。我想你的代码看起来像：

```
r = xcorr2(f1, f2) / (P .^ 2) 
```

这两个图像在哪里`f1`和是。`f2`得到的矩阵`r`是 ( *2P-1* )×(2P-1) 矩阵，当两幅图像偏移对应于该元素与中心的偏移量的偏移量时，其每个元素都反映了 f1 和 f2 之间的相似性度量.

请注意，如果您只对两个未移位图像之间的相关性感兴趣，那么您应该节省执行时间并使用[`corr2`](http://www.mathworks.com/help/images/ref/corr2.html)，就像@TheByzantine 在他的回答中所建议的那样。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-11-18T23:02:18.980

使用 [xcorr2](http://www.mathworks.com/help/signal/ref/xcorr2.html)函数。例如：

```
 C=xcorr2(A,B) 
```

# python - 当正文中有 unicode 字符时，使用 python 解析 Gmail 电子邮件

> ID：13445498
> 
> 赞同：2
> 
> 时间：2012-11-18T22:59:39.417
> 
> 标签：python, email, unicode

我写了一个脚本来解析一封电子邮件。从 Mac OS X Mail 客户端接收信件时它工作正常（到目前为止仅测试过这个），但是当信件的正文部分包含 unicode 字母时，我的解析器会失败。

例如，我发送了一条带有 content 的消息`ąčę`。

这是我的脚本部分，它同时解析正文和附件：

```
p = FeedParser()
p.feed(msg)
msg = p.close()
attachments = []
body = None
for part in msg.walk():
  if part.get_content_type().startswith('multipart/'):
    continue
  try:
    filename = part.get_filename()
  except:
    # unicode letters in filename, set default name then
    filename = 'Mail attachment'

  if part.get_content_type() == "text/plain" and not body:
    body = part.get_payload(decode=True)
  elif filename is not None:
    content_type = part.get_content_type()
    attachments.append(ContentFile(part.get_payload(decode=True), filename))

if body is None:
    body = '' 
```

好吧，我提到它适用于来自 OS X Mail 的信件，但不适用于 Gmail 信件。

追溯：

> Traceback（最近一次调用最后一次）：文件“/Users/aemdy/virtualenvs/django1.5/lib/python2.7/site-packages/django/core/handlers/base.py”，第 116 行，在 get_response response = callback （请求，*callback_args，**callback_kwargs）文件“/Users/aemdy/virtualenvs/django1.5/lib/python2.7/site-packages/django/views/decorators/csrf.py”，第 77 行，在 Wrapped_view 返回view_func(*args, **kwargs) 文件“/Users/aemdy/virtualenvs/django1.5/lib/python2.7/site-packages/django/views/decorators/http.py”，第 41 行，内部返回 func （请求，*args，**kwargs）文件“/Users/aemdy/PycharmProjects/rezervavau/bms/messages/views.py”，第 66 行，接受 Message.accept(request.POST.get('msg'))文件“/Users/aemdy/PycharmProjects/rezervavau/bms/messages/models.py”，第 261 行，在接受线程=线程文件“/Users/aemdy/virtualenvs/django1.5/lib/python2.7/site-packages/django/db/models/manager.py”，第 149 行，在创建返回 self.get_query_set() .create(**kwargs) 文件“/Users/aemdy/virtualenvs/django1.5/lib/python2.7/site-packages/django/db/models/query.py”，第 391 行，创建 obj.save( force_insert=True, using=self.db) 文件“/Users/aemdy/virtualenvs/django1.5/lib/python2.7/site-packages/django/db/models/base.py”，第 532 行，保存 force_update =force_update, update_fields=update_fields) 文件“/Users/aemdy/virtualenvs/django1.5/lib/python2.7/site-packages/django/db/models/base.py”，第 627 行，在 save_base 结果 = 管理器中。 _insert([self], fields=fields, return_id=update_pk, using=using, raw=raw) 文件“/Users/aemdy/virtualenvs/django1.5/lib/python2.7/site-packages/django/db/models/manager.py”，第 215 行，在 _insert 返回 insert_query(self.model, objs, fields, **kwargs) 文件“/Users/aemdy/virtualenvs/django1.5/ lib/python2.7/site-packages/django/db/models/query.py”，第 1633 行，在 insert_query 返回 query.get_compiler(using=using).execute_sql(return_id) 文件“/Users/aemdy/virtualenvs/django1 .5/lib/python2.7/site-packages/django/db/models/sql/compiler.py”，第 920 行，在 execute_sql cursor.execute(sql, params) 文件“/Users/aemdy/virtualenvs/django1\. 5/lib/python2.7/site-packages/django/db/backends/util.py”，第 47 行，在执行 sql = self.db.ops.last_executed_query(self.cursor, sql, params) 文件“/Users /aemdy/virtualenvs/django1.5/lib/python2.7/site-packages/django/db/backends/postgresql_psycopg2/operations.py”，第 201 行，在 last_executed_query 返回 cursor.query.decode('utf-8') 文件“/Users/aemdy/virtualenvs/django1.5/lib/python2.7/encodings/utf_8.py”，第 16 行，在 decode 返回 codecs.utf_8_decode （输入，错误，真）UnicodeDecodeError：'utf8'编解码器无法解码位置 115 中的字节 0xe0：无效的继续字节

我的脚本给了我以下 body `����`。我怎样才能解码它`ąčę`回来？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-18T23:42:19.330

好吧，我自己找到了解决方案。我现在会做一些测试，如果有任何失败，我现在就让你们看看。

我需要再次解码身体：

```
body = part.get_payload(decode=True).decode(part.get_content_charset()) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T11:48:44.600

您可能想尝试使用这个：

```
from email.Iterators import typed_subpart_iterator

def get_charset(message, default="ascii"):
    """Get the message charset"""

    if message.get_content_charset():
        return message.get_content_charset()

    if message.get_charset():
        return message.get_charset()

    return default

def get_body(message):
    """Get the body of the email message"""

    if message.is_multipart():
        #get the plain text version only
        text_parts = [part
                      for part in typed_subpart_iterator(message,
                                                         'text',
                                                         'plain')]
        body = []
        for part in text_parts:
            charset = get_charset(part, get_charset(message))
            body.append(unicode(part.get_payload(decode=True),
                                charset,
                                "replace"))

        return u"\n".join(body).strip()

    else: # if it is not multipart, the payload will be a string
          # representing the message body
        body = unicode(message.get_payload(decode=True),
                       get_charset(message),
                       "replace")
        return body.strip() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-18T23:14:34.063

您可能想看看[`email.iterators`](http://docs.python.org/2/library/email.iterators.html)（虽然不确定它会解决您的编码问题）。

# c# - 我应该如何在 ConcurrentDictionary 中“取消” AddOrUpdate？

> ID：13445505
> 
> 赞同：3
> 
> 时间：2012-11-18T23:00:59.073
> 
> 标签：c#, .net, multithreading, concurrency, concurrentdictionary

我已经阅读了 MSDN 文档和[这个博客](http://blogs.msdn.com/b/pfxteam/archive/2010/01/08/9945809.aspx)，我需要以下逻辑：

为一个`ConcurrentDictionary<string,bool>`

1.  如果字符串不存在，添加它，并确保我`True`在添加时将bool 设置为
2.  如果字符串确实存在，则仅将 bool 更改为`True`false 。否则**取消更新**

**我的用例**

我有几个 DNS 域来扫描恶意软件。我实时检索的列表中很可能会有重复项。我以 100 个或更少的批次收到 DNS 域列表，并且将有超过 10,000 个域进行扫描。

我只想在每次迭代 10,000 个域时扫描一次 DNS 主机。A`bool == true`表示它当前正在被扫描，我应该在继续之前取消该任务。有`bool == false`或没有条目意味着我应该立即将条目更新为`bool==true`或尽快创建一个新条目。

**记住...**

AddOrUpdate 将独立于 .NET4 的 TPL 中的许多独立线程调用。每个线程都需要决定它是否需要处理 Dictionary's `key`... 中提到的值或继续下一个。只有一个“钥匙”应该对其进行处理。

我需要向调用线程发出更新成功或失败的信号。另外[根据这个答案](https://stackoverflow.com/a/13445574/328397)，AddOrUpdate 的函数似乎会被调用很多次。我认为这可能意味着我的调用线程会因为取消工作`key`或继续工作而感到困惑。（记住只有一个线程可以积极工作`key`

可能混淆调用线程的并发更新示例

```
ConcurrentDictionary<int, string> numbers = new ConcurrentDictionary<int, string>();
Parallel.For(0, 10, x =>
{
    numbers.AddOrUpdate(1,
        i =>
        {
            Console.WriteLine("addValueFactory has been called");
            return i.ToString();
        },
        (i, s) =>
        {
            Console.WriteLine("updateValueFactory has been called");
            return i.ToString();
        });
}); 
```

输出

```
addValueFactory has been called
addValueFactory has been called
addValueFactory has been called
addValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called
updateValueFactory has been called 
```

**问题**

我应该如何将此“取消更新”功能添加到 AddOrUpdate？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-19T00:58:48.520

如果我了解您要实现的目标，我认为您不能`ConcurrentDictionary<string, bool>`为此使用 a 。

一种可能的解决方案是拥有一个封装给定主机扫描的类：

```
public class Scanner
{
    private static _syncRoot = new object();

    public Scanner(string host)
    {
        Host = host;
        StartScanning();
    }

    public string Host {get; private set; }

    public bool IsScanning {get; private set; }

    public void StartScanning()
    {
        lock(_syncRoot)
        {
            if (!IsScanning)
            {
                IsScanning = true;
                // Start scanning Host asynchronously
                ...
            }
        }
    }

    private void EndScanning()
    {
        // Called when asynchronous scanning has completed
        IsScanning = false;
    }
} 
```

然后是字典`ConcurrentDictionary<string, Lazy<Scanner>>`。

您可以按如下方式使用它：

```
Scanner s = dictionary.GetOrAdd(host, new Lazy<Scanner>(() => new Scanner(host));
s.StartScanning(); 
```

该`Lazy<Scanner>`实例将使用默认`LazyThreadSafetyMode.ExecutionAndPublication`模式，这意味着只有一个线程会调用工厂委托来实例化给定主机的 Scanner。

根据我对您的问题的理解，在我看来这就是您要实现的目标，即不要多次扫描同一主机。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T23:20:15.400

使用该博客文章中提到的 AddOrUpdate 方法。在您的 add delgate 中，将 bool 设置为 true。在您的更新委托中，让它检查作为参数传递给委托的布尔值并始终返回 true。我这么说是因为你在说

*   如果为假，则设置为真
*   如果为真，则取消更新（即保留为真）。所以你不妨将它设置为 true

如果缺少其他条件，请详细说明。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-19T00:11:45.567

您可以按照以下方式做一些事情：

```
if (dic.TryAdd(domain, true)) || (dic.TryUpdate(domain, true, false)) {
   // this thread just added a new 'true' entry, 
   // or changed an existing 'false' entry to 'true'
} 
```

当然，它会导致两倍的键查找。但我看不出有一种方法可以在`ConcurrentDictionary`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-08T21:51:23.633

尝试使用 ConcurrentDictionary>。

创建 Lazy 时，传入一个在站点上运行扫描的委托。第一次访问您的 Lazy.Value 属性时，将运行扫描。任何后续调用者都将被阻止，直到第一次扫描完成。扫描完成后，访问 Lazy.Value 的任何人都将获得该值，但永远不会运行第二次扫描。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-03-26T03:09:07.100

的并发性`ConcurrentDictionary`使这不起作用。

您真正必须对字典中已有的值采取行动的唯一机会是在 中`updateValueFactory`，但该工作将*在*更新实际发生并且值设置为之前进行`true`。在此期间，另一个线程也可能会尝试`AddOrUpdate`，在这种情况下，它仍然会看到 的旧值`false`，并再次启动更新逻辑。

这是一个示例程序来演示这一点：

```
using System;
using System.Collections.Concurrent;
using System.Threading.Tasks;

namespace ConcurrentDictionaryCancelTest {
    class Program {
        static void Main( string[] args ) {
            var example = new ConcurrentDictionary<string, bool>();

            for( var i = 0; i < 3; i++ ) {
                example.AddOrUpdate( i.ToString(), false, ( key, oldValue ) => false );
            }

            Parallel.For( 0, 8, x => {
                example.AddOrUpdate(
                    ( x % 3 ).ToString(),
                    ( key ) => {
                        Console.WriteLine( "addValueFactory called for " + key );
                        return true;
                    },
                    ( key, oldValue ) => {
                        Console.WriteLine( "updateValueFactory called for " + key );
                        if( !oldValue ) {
                            var guid = Guid.NewGuid();
                            Console.WriteLine( 
                                key + " is calling UpdateLogic: " + guid.ToString() 
                            );
                            UpdateLogic( key, guid );
                        }
                        return true;
                    }
                );
            } );
        }

        public static void UpdateLogic( string key, Guid guid ) {
            Console.WriteLine( 
                "UpdateLogic has been called for " + key + ": " + guid.ToString()
            );
        }
    }
} 
```

还有一些示例输出：

```
updateValueFactory called for 0
updateValueFactory called for 1
updateValueFactory called for 2
updateValueFactory called for 0
updateValueFactory called for 1
0 is calling UpdateLogic: cdd1b1dd-9d96-417d-aee7-4c4aec7fafbf
1 is calling UpdateLogic: 161c5f35-a2d7-44bf-b881-e56ac713b340
UpdateLogic has been called for 0: cdd1b1dd-9d96-417d-aee7-4c4aec7fafbf
updateValueFactory called for 1
1 is calling UpdateLogic: 6a032c22-e8d4-4016-a212-b09e41bf4d68
UpdateLogic has been called for 1: 6a032c22-e8d4-4016-a212-b09e41bf4d68
updateValueFactory called for 0
updateValueFactory called for 2
2 is calling UpdateLogic: 76c13581-cd55-4c88-961c-12c6d277ff00
UpdateLogic has been called for 2: 76c13581-cd55-4c88-961c-12c6d277ff00
1 is calling UpdateLogic: d71494b6-265f-4ec8-b077-af5670c02390
UpdateLogic has been called for 1: d71494b6-265f-4ec8-b077-af5670c02390
UpdateLogic has been called for 1: 161c5f35-a2d7-44bf-b881-e56ac713b340
updateValueFactory called for 1
updateValueFactory called for 1
0 is calling UpdateLogic: f6aa3460-444b-41eb-afc6-3d6afa2f6512
UpdateLogic has been called for 0: f6aa3460-444b-41eb-afc6-3d6afa2f6512
2 is calling UpdateLogic: d911dbd1-7150-4823-937a-26abb446c669
UpdateLogic has been called for 2: d911dbd1-7150-4823-937a-26abb446c669
updateValueFactory called for 0
updateValueFactory called for 2 
```

请注意，第一次`updateValueFactory`调用为 0，何时`UpdateLogic`调用，然后它实际执行之间的延迟。在此期间，即在值更新为 之前`true`，`updateValueFactory`再次调用 0，这`UpdateLogic`也会导致再次为 0 运行。

您需要某种锁来确保读取值、调用更新逻辑和设置新值都是一个原子操作。

# php - 从经度、纬度、速度和航向计算坐标

> ID：13445508
> 
> 赞同：2
> 
> 时间：2012-11-18T23:01:05.023
> 
> 标签：php, math, latitude-longitude, coordinate-systems

在过去的 24 小时里，我一直在努力解决这个问题......

以下是假设：

* * *

当前经度（十进制格式）：53.3205556

当前纬度（十进制格式）：-1.7297223

行驶距离（公里）：1400km

航向度数：45°

* * *

我想在 1400 公里后以小数形式计算新坐标。这是我的代码（在 PHP 中）。

```
function calc_position($latitude, $longitude, $distance, $heading){

    $r = 6378;
    // Earth circonference
    // Convert heading in degres to radians
    $bearing = deg2rad($heading); 

    // Compute new latitude and longitude
    $latitude2 =  asin( (sin($latitude) * cos($distance/$r)) + (cos($latitude) * sin($distance/$r) * cos($bearing)) );
    $longitude2 = $longitude + atan2( sin($bearing)*sin($distance/$r)*cos($latitude), cos($distance/$r)-(sin($latitude)*sin($latitude2)) );

    return (object) array(
        'latitude' => $latitude2,
        'longitude' => $longitude2
    );
} 
```

不幸的是，新经度和纬度的结果是错误的（地图上显示的不一致）。我已经彻底按照[这里的教程](http://www.movable-type.co.uk/scripts/latlong.html)来尝试这个公式，但是尽管有这个网站，我还是找不到解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T23:05:18.497

如果记忆是几年前的事，那么假设您使用的是 WGS84 坐标，您需要一个称为半[正弦公式的东西来解决这个问题。](http://en.wikipedia.org/wiki/Haversine_formula)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T00:04:39.703

除非您在此函数之外执行此操作，否则您还需要将初始纬度/经度转换为弧度，并将公式的结果转换回度数。

# c# - PayPal 日期时间 (payment_date) 解析问题

> ID：13445510
> 
> 赞同：9
> 
> 时间：2012-11-18T23:01:37.923
> 
> 标签：c#, .net

PayPal 发送付款方式`datetime`如下：

> 09%3A37%3A22+11 月+18%2C+2012+太平洋标准时间

我尝试通过此代码对其进行转换，但出现异常。

关于如何解析它的任何线索？

谢谢！

```
DateTime paymentDate;
DateTime.TryParse(WebUtility.HtmlDecode(r["payment_date"]), out paymentDate);
n.PaymentDate = paymentDate; // payment_date=09%3A37%3A22+Nov+18%2C+2012+PST 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-09-25T12:16:58.457

PayPal 的文档中有多种日期时间格式。我使用此方法对其进行解析，并将其转换为 UTC：

```
/// <summary>
/// Tries to parse PayPal formatted date and time and converts it to an UTC.
/// </summary>
public static bool TryParsePaypalDatetimeToUtc(this string paypalDatetime, out DateTime retValue)
{
    DateTime paymentDate;

    // PayPal formats from docs
    string[] formats = new string[] { "HH:mm:ss dd MMM yyyy PDT", "HH:mm:ss dd MMM yyyy PST", 
                                      "HH:mm:ss dd MMM, yyyy PST", "HH:mm:ss dd MMM, yyyy PDT", 
                                      "HH:mm:ss MMM dd, yyyy PST", "HH:mm:ss MMM dd, yyyy PDT" };
    if (false == DateTime.TryParseExact(paypalDatetime, formats, CultureInfo.InvariantCulture, DateTimeStyles.None, out paymentDate))
    {
        retValue = DateTime.MinValue;
        return false;
    }

    retValue = TimeZoneInfo.ConvertTimeToUtc(paymentDate, TimeZoneInfo.FindSystemTimeZoneById("Pacific Standard Time"));

    return true;
} 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-11-18T23:12:35.037

这应该可以解决问题：

```
DateTime paymentDate;
DateTime.TryParseExact(HttpUtility.UrlDecode(r["payment_date"]),
    "HH:mm:ss MMM dd, yyyy PST", CultureInfo.InvariantCulture,
    DateTimeStyles.None, out paymentDate); 
```

# python - 在 Python 中创建连接对象

> ID：13445512
> 
> 赞同：0
> 
> 时间：2012-11-18T23:01:39.413
> 
> 标签：python

在我正在开发的 Python 软件中，我有许多对象需要能够“连接”到其他对象（此处连接的术语指的是它只需要指向它所连接的对象） ）。

我曾想过创建一个连接类，它可以创建此链接并存储有关连接属性的信息。如下所示，当我创建一个新对象时，我有一个方法允许我向它添加一个特定类型的新连接。

```
class ConnectableObject()
    def addNewConnection(self, connectiontype)
        self.connections.append(NewConnection(connectiontype)) 
```

这个想法是每个对象都应该有自己的连接类型......并且这些都是可连接的。即对象A有一个与之关联的连接对象，对象B有一个与之关联的连接对象，为了连接这两个对象，我只需连接它们的连接。这使我可以在连接对象中存储有关每个连接的信息。一旦这个连接对象被实例化，我想将它存储在连接对象'谁'创建它，即对象A...对象B。在Python中有没有办法从一个对象请求它是在哪个类中创建的？

此外，更一般地说，是否有一种更简洁的方法来实现对象之间的连接，其中每个对象连接都可以存储自己的属性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T23:20:10.027

> Python中有没有办法从对象请求它在其中创建的类？

您的问题中有太多“连接”，所以我不确定我的理解是否正确，但我认为您需要`ConnectableObjectInstance.__class__`作为`NewConnection`构造函数的参数传递，然后将其存储为连接对象的属性。

**编辑：**

您不需要知道对象实例的名称，因为它可以通过`self`. 此外，您可能不需要将类存储为连接属性，而是对对象的引用。像这样的东西：

```
>>> class Connection(object):
...  def __init__(self, parent):
...   self.parent = parent
...
>>> class ConnectableObject(object):
...  def __init__(self):
...   pass
...  def connect(self):
...   return Connection(self)
...
>>> conobj = ConnectableObject()
>>> con = conobj.connect()
>>> con.parent
<__main__.ConnectableObject object at 0x01FDEC70> 
```

# python - Django AllAuth 给出 SSLError

> ID：13445515
> 
> 赞同：4
> 
> 时间：2012-11-18T23:02:01.360
> 
> 标签：python, django, ssl, oauth-2.0

我正在尝试使用 AllAuth 对不同的站点进行身份验证。我现在尝试了 Google 和 Facebook，在成功登录网站后，我都遇到了同样的错误：

```
SSLError at /allauth/google/login/callback/
[Errno 185090050] _ssl.c:340: error:0B084002:x509 certificate routines:X509_load_cert_crl_file:system lib 
```

有人可以进一步帮助我吗？谢谢和最良好的祝愿。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T00:59:57.660

原来 ca_certs 不见了。问题已通过更换解决

```
client = httplib2.Http() 
```

在 allauth/socialaccount/requests.py 的第 42 和 52 行中

```
client = httplib2.Http(ca_certs=PATH_TO_YOUR_CERT_FILE) 
```

CERT_FILE 将是 certifi（可以通过 pip 或 macports 等安装）模块中的 cacert.pem 文件。

似乎是一个丑陋的黑客，希望有更好的解决方案。

# ios - 如何为我的 iOS Cocos2d 游戏保存游戏数据？

> ID：13445516
> 
> 赞同：4
> 
> 时间：2012-11-18T23:02:16.383
> 
> 标签：ios, cocoa-touch, cocos2d-iphone, iphone-sdk-3.0

我有一堆与关卡相关的杂项数据，因此我需要保存，即使玩家关闭/打开手机、重新启动设备、退出游戏等，这些数据也会被保存。基本上是持久数据。我查看了很多选项，但没有找到一种简单、清晰的方法来满足我的需求，希望有人能帮助我，并给出一个清晰的例子来说明如何实现满足我需求的最佳方法的基础。

我查看了以下 NSUSerDefaults （显然不是最好的，因为它是为了偏好，所以我理解） NSCoder / NSKeyedArchiver （无法找到一种明确的方法来从 1 个单个类中保存简单数据类型，所有数据都已保存作为属性）SQLite3（完全丢失）

任何帮助和指导将不胜感激。

我需要在整个程序中保存和轻松访问的数据类型是...... NSStrings、NSArrays、Ints、Bools。

感谢您的帮助，我希望得到一个明确的答案！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-19T00:25:44.053

保存到 NSUserDefaults 肯定没有错，但是如果您想将属性保存到磁盘，我已经为您整理了一些代码，用于保存到 .plist 文件，然后再检索它。你也可以在这个[gist](https://gist.github.com/4108317)中找到它。

# 保存

```
// We're going to save the data to SavedState.plist in our app's documents directory
NSString *rootPath = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:0];
NSString *plistPath = [rootPath stringByAppendingPathComponent:@"SavedState.plist"];

// Create a dictionary to store all your data
NSMutableDictionary *dataToSave = [NSMutableDictionary dictionary];

// Store any NSData, NSString, NSArray, NSDictionary, NSDate, and NSNumber directly.  See "NSPropertyListSerialization Class Reference" for more information.
NSString *myString = @"Hello!"
[dataToSave setObject:myString forKey:@"MyString"];

// Wrap primitives in NSValue or NSNumber objects.  Here are some examples:
BOOL someBool = YES;
NSNumber *boolValue = [NSNumber numberWithBool:someBool];
[dataToSave setObject:boolValue forKey:@"SomeBoolValue"];
int someInteger = 99;
NSInteger *integerValue = [NSNumber numberWithInteger:someInteger];
[dataToSave setObject:integerValue forKey:@"SomeIntegerValue"];

// Any objects that conform to NSCoding can be archived to an NSData instance.  In this example, MyClass conforms to NSCoding.
MyClass *someObject = [[MyClass alloc] init];
NSData *archivedStateOfSomeObject = [NSKeyedArchiver archivedDataWithRootObject:someObject];
[dataToSave setObject:archivedStateOfSomeObject forKey:@"SomeObject"];

// Create a serialized NSData instance, which can be written to a plist, from the data we've been storing in our NSMutableDictionary
NSString *errorDescription;
NSData *serializedData = [NSPropertyListSerialization dataFromPropertyList:dataToSave
                                                                    format:NSPropertyListXMLFormat_v1_0
                                                          errorDescription:&errorDescription];
if(serializedData) 
{
    // Write file
    NSError *error;
    BOOL didWrite = [serializedData writeToFile:plistPath options:NSDataWritingFileProtectionComplete error:&error];

    NSLog(@"Error while writing: %@", [error description]);

    if (didWrite)
        NSLog(@"File did write");
    else
        NSLog(@"File write failed");
}
else 
{
    NSLog(@"Error in creating state data dictionary: %@", errorDescription);
} 
```

# 正在加载

```
// Fetch NSDictionary containing possible saved state
NSString *errorDesc = nil;
NSPropertyListFormat format;
NSString *plistPath;
NSString *rootPath = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory,
                                                          NSUserDomainMask, YES) objectAtIndex:0];
plistPath = [rootPath stringByAppendingPathComponent:@"SavedState.plist"];
NSData *plistXML = [[NSFileManager defaultManager] contentsAtPath:plistPath];
NSDictionary *unarchivedData = (NSDictionary *)[NSPropertyListSerialization
                                      propertyListFromData:plistXML
                                      mutabilityOption:NSPropertyListMutableContainersAndLeaves
                                      format:&format
                                      errorDescription:&errorDesc];

// If NSDictionary exists, look to see if it holds a saved game state
if (!unarchivedData)
{
    NSLog(@"Error reading plist: %@, format: %d", errorDesc, format);
} 
else 
{
    // Load property list objects directly
    NSString *myString = [unarchivedData objectForKey:@"MyString"];

    // Load primitives
    NSNumber *boolValue = [unarchivedData objectForKey:@"SomeBoolValue"];
    BOOL someBool = [boolValue boolValue];
    NSNumber *integerValue = [unarchivedData objectForKey:@"SomeIntegerValue"];
    BOOL someBool = [integerValue integerValue];

    // Load your custom objects that conform to NSCoding
    NSData *someObjectData = [unarchivedData objectForKey:@"SomeObject"];
    MyClass *someObject = [NSKeyedUnarchiver unarchiveObjectWithData:someObjectData];
} 
```

如需进一步阅读，请查看[档案和序列化编程指南](http://developer.apple.com/library/ios/#documentation/cocoa/Conceptual/Archiving/Archiving.html#//apple_ref/doc/uid/10000047i)。

# ruby - 在数据库中存储 object_id 数组及其坐标的方法是什么？

> ID：13445521
> 
> 赞同：2
> 
> 时间：2012-11-18T23:02:38.477
> 
> 标签：ruby, ruby-on-rails-3, postgresql

我在 Rails 3 上有一个带有 PostgreSQL 数据库的应用程序。

问题是：我想用 object_id 存储坐标来访问它，例如：

```
Post1 -> Coordinates [100,200] -> Attachment1
Post1 -> Coordinates [400,400] -> Attachment2
Post1 -> Coordinates [200,500] -> Attachment3

Post2 -> Coordinates [150,310] -> Attachment1

Post3 -> Coordinates [50,710] -> Attachment1
Post1 -> Coordinates [430,430] -> Attachment2 
```

我想将所有附件存储在一个地方（即协调模型），以免使事情变得混乱。是否可以？

我从未遇到过任何解决此问题或类似问题的方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-19T01:39:33.973

这看起来像一个简单的 m:n 关系，具有两部分键。使用联合表对其进行建模。`(post, attachment)`为了给你这个想法，假设每个坐标位置只能有一对，SQL 措辞将是：

```
CREATE TABLE post (
    post_id serial primary key,
    blah_other_data text
);

CREATE TABLE attachment (
    attachment_id serial primary key,
    blah_other_data text
);

CREATE TABLE post_attachment (
    post_id integer not null REFERENCES post(post_id),
    attachment_id integer not null REFERENCES attachment(attachment_id), 
    coordinate_x integer not null,
    coordinate_y integer not null,
    PRIMARY KEY (coordinate_x, coordinate_y)
); 
```

我相信您可以将其转换回 Rails 模型和查询。

`(post,attachment)`如果每个坐标位置可以有多个对，那么您必须通过将坐标列添加到键来调整`PRIMARY KEY`of以允许这样做。`post_attachments`

演示数据设置：

```
INSERT INTO post (blah_other_data)
VALUES ('Post1'),('Post2'),('Post3');

INSERT INTO attachment(blah_other_data)
VALUES ('Attachment1'),('Attachment2'),('Attachment3');

INSERT INTO post_attachment (post_id, attachment_id, coordinate_x, coordinate_y)
SELECT post_id, attachment_id, x, y
FROM (VALUES
    ('Post1', 100,200, 'Attachment1'),
    ('Post1', 400,400, 'Attachment2'),
    ('Post1', 200,500, 'Attachment3'),
    ('Post2', 150,310, 'Attachment1'),
    ('Post3', 50,710,  'Attachment1'),
    ('Post1', 430,430, 'Attachment2')
) rows(post_data,x,y,attachment_data)
INNER JOIN post ON (post.blah_other_data = rows.post_data)
INNER JOIN attachment ON (attachment.blah_other_data = rows.attachment_data); 
```

使用连接访问数据：

```
SELECT p.post_id, p.blah_other_data AS post_data, 
       a.attachment_id, a.blah_other_data AS attachment_data, 
       c.coordinate_x, c.coordinate_y 
FROM post_attachment c 
INNER JOIN post p ON (c.post_id = p.post_id) 
INNER JOIN attachment a ON (c.attachment_id = a.attachment_id);
 post_id | post_data | attachment_id | attachment_data | coordinate_x | coordinate_y 
---------+-----------+---------------+-----------------+--------------+--------------
       3 | Post3     |             1 | Attachment1     |           50 |          710
       2 | Post2     |             1 | Attachment1     |          150 |          310
       1 | Post1     |             1 | Attachment1     |          100 |          200
       1 | Post1     |             2 | Attachment2     |          400 |          400
       1 | Post1     |             2 | Attachment2     |          430 |          430
       1 | Post1     |             3 | Attachment3     |          200 |          500
(6 rows) 
```

# java - 从存储库访问 XML 文件的问题

> ID：13445524
> 
> 赞同：2
> 
> 时间：2012-11-18T23:03:02.397
> 
> 标签：java, android, xml, eclipse

嗨，我正在使用 eclipse 为 Android 开发，我最近克隆了一个存储库，但无法访问 XML 文件。当我尝试打开它们时，eclipse给了我以下错误：

无法打开编辑器：Android XML 编辑器无法处理此输入。

然后我转到 Window -> Preferences -> General -> File Associations 并将 XML 编辑器从默认的 Android Common XML 编辑器更改为 XML Editor。

这让我看到了 XML 的来源，但看不到图形布局。它只给了我设计和来源两个选项。

如何以图形布局查看 XML 文件？

谢谢，彼得

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T23:05:04.447

您使用的是什么版本的 Eclipse？

我在 Mac 上使用 Juno，在 XML 布局的底部，有两个选项 - XML 布局和图形布局。点击图形的

这是一张图片：

![在此处输入图像描述](../Images/f38a00ca441268e8e84a9cdd8f98a968.png)

**编辑**

哎呀，我没有意识到这比这更复杂。这是另一个人所说的有效：

```
"Just rename the file which shows erorr in the eclipse itself and open it. then agin close it and rename back to its original name." 
```

所以尝试一下，希望它有效吗？希望您没有要处理的大量文件（如果有，也许可以编写一个脚本来完成）。如果您想关注该线程，这是链接（它真的很长，所以我只看了一半......也许底部有更好的东西）

[http://code.google.com/p/android/issues/detail?id=15003](http://code.google.com/p/android/issues/detail?id=15003)

# php - 您可以从 IMAP 获取附件文件名而不下载它们吗？

> ID：13445530
> 
> 赞同：3
> 
> 时间：2012-11-18T23:03:28.070
> 
> 标签：php, python, email, imap, attachment

有没有办法检查电子邮件是否有附件，并且只获取文件名而不下载它？在 PHP 中， imap_fetchstructure() 下载附件以检查它。这可以用 PHP 或 Python 完成吗？

# macos - 链接到框架

> ID：13445531
> 
> 赞同：0
> 
> 时间：2012-11-18T23:03:32.933
> 
> 标签：macos, cocoa, frameworks, linker, dyld

我有许多框架链接到我的主项目，但由于某种原因，每当我在 Xcode 之外运行整个东西时，可执行文件根本找不到框架。

框架将动态安装路径设置为@loader_path/../Frameworks。我试过简单地放@rpath，但也没有用。主可执行文件上的 Runpath Search Paths 为空。

有没有一种简单的方法来调试这个？我想我已经浏览了所有关于框架链接的网站和博客文章，但没有任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T23:17:02.047

例如，如果您有一个构建阶段，您可以将框架复制到您的应用程序包中……</p>

![构建阶段示例](../Images/a6aa6acd133075f1a611a58f20627b91.png)

在您的应用程序中构建设置.. **运行路径搜索路径** `@executable_path/../Frameworks`

在您的框架构建设置中.. **动态库安装名称** `@rpath/$(EXECUTABLE_PATH)`

（其中宏 $(EXECUTABLE_PATH) 应扩展为 AFramework.framework/Versions/A/AFramework）

如果你弄错了，你的应用程序应该在启动时崩溃。崩溃报告应该说类似

```
Dyld Error Message:
  Library not loaded: @rpath/TestyFramework.framework/Versions/A/TestyFramework
  Referenced from: /path/to/TestyApp.app/Contents/MacOS/TestyApp
  Reason: image not found 
```

这应该可以帮助您确定值应该是什么以及框架应该在哪里

即在我的情况下，完整的运行路径搜索路径是..

```
/path/to/TestyApp.app/Contents/MacOS/TestyApp/../Frameworks 
```

因此图书馆应该在..

```
/path/to/TestyApp.app/Contents/MacOS/TestyApp/../Frameworks/TestyFramework.framework 
```

# java - Java 应用程序在启动全屏应用程序时崩溃

> ID：13445532
> 
> 赞同：3
> 
> 时间：2012-11-18T23:03:38.253
> 
> 标签：java, jetty, fullscreen, runtime-error

我有一个启动小型 Jetty 服务器的小型 Java 应用程序。这通常效果很好。

不幸的是，当我启动一个完全不相关的、非 Java 的全屏游戏（我尝试使用魔兽世界和 SW：TOR）时，应用程序立即崩溃。它不会留下 hs_err 日志文件来告诉我原因。它只是随着 Windows“此应用程序已停止工作”对话框而死。游戏本身继续运行良好。它在我尝试过的任何游戏上都会崩溃，但不会在全屏视频播放器上崩溃。如果从 Eclipse 和命令行启动，它都会崩溃。我无法用另一个 Java 应用程序重现这一点，从简单到非常大的应用程序。当我以全屏（窗口）模式启动 WoW 时，该应用程序继续运行良好，因此这似乎是由一个控制整个桌面的全屏应用程序触发的。

似乎由于某种原因，当我的视频卡开始做某事时，JVM 崩溃了。

有谁知道为什么会发生这种崩溃，或者我怎么能弄清楚它为什么会发生？我不确定如何启动一个完全不相关的应用程序（可能是视频驱动程序？）会干扰我的 JVM。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T21:36:05.230

您可以尝试使用可视化虚拟机对其进行监控。还可以尝试在 vm 崩溃时编写堆转储并在之后进行分析。也许那时你会知道会发生什么。

[JVM 崩溃时，Sun JDK 能否生成核心/堆转储文件？](https://stackoverflow.com/questions/10944082/can-sun-jdk-generate-core-heap-dump-files-when-jvm-crashes)

尝试过任何更新的 Java 版本吗？

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-28T11:59:21.057

您的游戏魔兽争霸和 SW：TOR 游戏是否同时运行？你的意思是你在java下运行你的游戏构建，然后你开始了另一个游戏魔兽和SW：TOR？您使用的是哪个操作系统和哪个版本的JVM？可能是两个不同的程序对图形资源的优先级不同。不清楚游戏魔兽和SW：TOR是在哪个平台下构建的。可能是操作系统默认优先级线程调度的工作落后于使用图形资源。似乎 JVM 因找不到资源并终止而引发系统异常。可能您应该检查资源的可用性，如果可用，请继续前进。

# vbscript - 在 Windows 上使用 VBS 处理 MS Word

> ID：13445538
> 
> 赞同：3
> 
> 时间：2012-11-18T23:03:51.130
> 
> 标签：vbscript, ms-word

一般问题：如何将由 Microsoft Office 中的“录制”创建的 VBA 宏中的功能“翻译”为可能位于 .vbs 文件中的 Windows 可执行 VBScript？

具体问题：如何批量创建Word文档的缩略图以便在Windows资源管理器中查看？

替代问题：我在哪里可以找到有关使用 VBS 操作 MS Word 文档的文档？

* * *

我的最终目标是批处理为 MS Word 文档创建缩略图的过程。

我的人工方法是：

*   打开 Word 文档
*   按“另存为”
*   勾选“保存缩略图”
*   保存和替换

我[从一个小网站上](http://www.activexperts.com/activmonitor/windowsmanagement/scripts/msoffice/word/#CNWD.htm)发现，VBS 以 .vbs 文件的形式可以操作 Word 文档。可以通过在 Windows 资源管理器中双击 .vbs 文件来执行的示例：

```
'in a file called "something.vbs"
Set objWord = CreateObject("Word.Application")

objWord.Visible = True
Set objDoc = objWord.Documents.Add()
Set objSelection = objWord.Selection

objSelection.Font.Name = "Arial"
objSelection.Font.Size = "18"
objSelection.TypeText "Network Adapter Report"
objSelection.TypeParagraph()

objSelection.Font.Size = "14"
objSelection.TypeText "" & Date()
objSelection.TypeParagraph() 
```

我还发现通过“录制宏”，我可以获得一些用缩略图保存文档的 VBA 代码。这是我录制的一个宏：

```
Sub save_with_thumbnail()
'
' save_with_thumbnail Macro
'
'
    ChangeFileOpenDirectory _
        "E:\"
    ActiveDocument.SaveAs2 FileName:="as90520.doc", FileFormat:= _
        wdFormatDocument, LockComments:=False, Password:="", AddToRecentFiles:= _
        True, WritePassword:="", ReadOnlyRecommended:=False, EmbedTrueTypeFonts:= _
        False, SaveNativePictureFormat:=False, SaveFormsData:=False, _
        SaveAsAOCELetter:=False, CompatibilityMode:=0
End Sub 
```

这两种方法中的每一种都解决了我的*部分*问题，但我无法将它们两者结合起来。因此我问是否有人-

*   可以通过将 VBA 宏所做的转换为 Windows 可执行脚本来帮助集成/组合/无论这两种方法，*或者*
*   可以就*如何在 Windows 资源管理器中为 MS Word 文档批量创建缩略图*提供建议，*或者*
*   知道某处存在一些参考文档，这些参考文档提供了更多关于这个`CreateObject.("Word.Application")`和`.Documents.Add()`和`.Selection`和`..SaveAs`- 无论如何，各种各样的信息。

希望我对这个问题的措辞足够好。提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-19T00:12:06.053

最初的出发点不同。VBA 通常由另一个应用程序托管，该应用程序提供一组内置对象；例如，如果您的 VBA 托管在 Word 中，您将可以访问`Application`指向当前运行的 Word 应用程序的 Word。在 VBS 中，您必须创建一个新的 Application 对象并将其保存在变量中：

```
Dim wdApp
Set wdApp = CreateObject("Word.Application") 
```

或获取对已经运行的 Word 应用程序的引用：

```
Set wdApp = GetObject(,"Word.Application") 
```

完成此操作后，它们之间的代码实际上是可以互换的：

```
Dim wdDoc
Set wdDoc = wdApp.Open("path\to\document.docx") 
```

* * *

请记住，在 VBA 中变量可以有一个类型。而不是之前的变量声明 ( `Dim wdDoc`)，在 VBA 中您可以看到：

```
Dim wdDoc As Word.Document
'alternatively:
'Dim wdDoc As Document 
```

此外，VBA 通常可以访问枚举常量，例如`wdFormatDocument`. 在 VBScript 中，您可以手动定义常量：

```
Const wdFormatDocument = 0 
```

或者直接使用常量的值：

```
wdApp.ActiveDocument.SaveAs2 FileName:="as90520.doc", FileFormat:= 0 
```

* * *

可以在[此处](http://msdn.microsoft.com/en-us/library/office/ff837519.aspx)找到 Word 对象模型的参考。

* * *

就您的具体问题而言，`ActiveDocument`是`Application`对象的属性，（请参见[此处](http://msdn.microsoft.com/en-us/library/office/bb179183%28v=office.12%29.aspx)）。所以在 VBS 中，对应的代码可能是这样的：

```
Dim wdApp
Set wdApp = CreateObject("Word.Application")

'When you open Word from the Start menu, it automatically adds a blank document for you
'When manipulating Word in a program, we need to do this by hand
'Generally we would store this in a variable, but we don't need to store it in order
'to use the ActiveDocument property; it just has to exist
wdApp.Documents.Add

'copied and pasted from before
wdApp.ActiveDocument.SaveAs2 FileName:="as90520.doc", FileFormat:= _
    wdFormatDocument, LockComments:=False, Password:="", AddToRecentFiles:= _
    True, WritePassword:="", ReadOnlyRecommended:=False, EmbedTrueTypeFonts:= _
    False, SaveNativePictureFormat:=False, SaveFormsData:=False, _
    SaveAsAOCELetter:=False, CompatibilityMode:=0 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-03T08:59:11.903

这个答案并不是一个完整的答案。

通过录制宏创建的 VBA 代码根本无法解决“部分问题”。它不能解决问题的*任何*部分。我进行了实验，发现无论是否选中“另存为”对话框中的“保存缩略图”复选框，宏都是相同的。

“使 VBA 代码适应 VBScript”的想法是行不通的，因为 VBA 本身甚至都行不通。甚至微软似乎都不关心缩略图： http: [//msdn.microsoft.com/en-us/library/office/ff836084](http://msdn.microsoft.com/en-us/library/office/ff836084(v=office.14).aspx) (v=office.14).aspx 。

提问者的预期方法无法满足“特定问题”中的要求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-13T13:46:51.053

[![Registry](../Images/6b879f66ea529aa48dee82cb663a4f18.png)](https://i.stack.imgur.com/vOWlE.png)

There is a registry setting to enable saving thhumbnails at "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Office\16.0\Common" of type DWORD named *SaveThumbnails* (1 to save; 0 to NOT save).

# html - 为什么 IE9 支持 command 元素而 IE10 不支持？

> ID：13445539
> 
> 赞同：3
> 
> 时间：2012-11-18T23:04:04.273
> 
> 标签：html, internet-explorer

我喜欢这个`command`元素的想法，但似乎在任何（？）浏览器中都不支持它，除了 IE9。但不是在 IE10 中。我很好奇为什么，有什么特别的原因吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-05T03:30:25.630

据我所知`command`，任何浏览器都不支持该元素。Firefox 15-19 确实支持`menu`标签[http://caniuse.com/#search=command](http://caniuse.com/#search=command)，但不使用`command`HTML5 官方推荐的元素[http://www.w3.org/TR/html5/interactive-elements .html#the-menu-element](http://www.w3.org/TR/html5/interactive-elements.html#the-menu-element)

我没有看到`command`IE9 中支持的元素。你在什么地方看到的吗？它未列在 MSDN IE9 开发人员指南文档[http://msdn.microsoft.com/en-us/ie/hh410106#_HTML5_Semantic_Elements](http://msdn.microsoft.com/en-us/ie/hh410106#_HTML5_Semantic_Elements)

至于为什么它没有在 Firefox 以外的浏览器中实现，我不确定为什么会这样。也许浏览器还没有准备好回答`menu`元素及其复杂性以及可用性、可访问性等......

好消息是您可以使用 Polyfill`menu`并`command`使用以下库[https://github.com/medialize/jQuery-contextMenu](https://github.com/medialize/jQuery-contextMenu)我自己没有使用过它，但它已在 Modernizr 的 HTML5 Cross Browser Polyfills wiki [https中列出://github.com/Modernizr/Modernizr/wiki/HTML5-Cross-Browser-Polyfills](https://github.com/Modernizr/Modernizr/wiki/HTML5-Cross-Browser-Polyfills)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-26T11:59:32.090

如[https://stackoverflow.com/a/19606400/1331956](https://stackoverflow.com/a/19606400/1331956)中所述，该`command`元素已被删除以支持`menuitem`. 这可能就是为什么它已从 IE 中删除。

# facebook - FQL - 原始高分辨率 Facebook 图像的尺寸有时不正确

> ID：13445540
> 
> 赞同：2
> 
> 时间：2012-11-18T23:04:04.237
> 
> 标签：facebook, facebook-fql, photos

不确定这是否是一个错误，或者我需要调整我的 FQL 查询。有时，照片记录的宽度和高度尺寸不准确。

从 Facebook[自己的例子](https://developers.facebook.com/docs/reference/fql/photo/)：

`SELECT pid FROM photo WHERE aid="20531316728_324257`

如果我跑

`SELECT pid, images FROM photo WHERE aid="20531316728_324257"`

在第一条记录中，在图像的 [0] 位置（最大），我得到

> {“高度”：1373，“宽度”：2048，“来源”：“https://fbcdn-sphotos-ga.akamaihd.net/hphotos-ak-ash3/s2048x2048/168119_10150146071831729_5116892_n.jpg”}，

您会注意到 URL 中的图像不是 2048x1373。但是，对于其他照片，有时这*是*准确的。

**如何始终如一地检索照片的最大副本及其正确的宽度和高度？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T23:19:47.643

> 您会注意到 URL 中的图像不是 2048x1373。但是，对于其他照片，有时这是准确的。

如果上传的图片较小，则没有这些尺寸的图片。

> 如何始终如一地检索照片的最大副本及其正确的宽度和高度？

您可以从同一张表中查询 src_big_width 和 src_big_height，在本例中，这两个值分别为 720 和 483——这些是这张照片可用的最大尺寸。

但是文档说，这些字段可能是空的，因此它们也可能在每种情况下都不可靠。

# lucene - 通过 IndexWriter 提交用户数据需要至少一次文档更新？

> ID：13445554
> 
> 赞同：0
> 
> 时间：2012-11-18T23:05:45.240
> 
> 标签：lucene, lucene.net

看起来有一种非常方便的方法可以通过以下方法推送一些关于索引的元数据（最后一个索引更新的时间戳）：

```
IndexWriter.Commit(commitUserData) 
```

我观察到的是，这仅在提交包含至少一个文档指令（添加/删除或更新）时才有效，而在我的情况下，*即使*我没有要更新的文档，我也想推送用户数据。我总是通过更新“临时文档”来解决这个问题，但我觉得很脏。

还有其他方法可以更好地做到这一点吗？使用 Lucene.NET 2.9.4.1。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T14:31:46.727

提交用户数据映射用于保存有关提交的信息，如果没有要提交的内容，则 lucene 不存储元数据是有意义的。（没有承诺将信息与）

如果您要存储的日期代表您最后一次检查索引是否需要更新（即最后一次抓取网站），您应该将此信息存储在其他位置。（数据库/配置文件/等）

您还可以使用`FSDirectory.TouchFile` `FSDirectory.ListAll`和`FSDirectory.FileModified`方法的组合，并使用 lucene 索引文件时间戳。

[http://lucene.apache.org/core/old_versioned_docs/versions/2_9_4/api/all/org/apache/lucene/store/FSDirectory.html](http://lucene.apache.org/core/old_versioned_docs/versions/2_9_4/api/all/org/apache/lucene/store/FSDirectory.html)

# perl - GraphViz - 将节点添加到现有集群

> ID：13445555
> 
> 赞同：1
> 
> 时间：2012-11-18T23:05:47.327
> 
> 标签：perl, graphviz

我正在使用 Perl[`GraphViz`](https://metacpan.org/module/GraphViz)模块来创建依赖关系树图。假设我有两个类，A 类和 B 类。我希望 A 类中的所有节点成为一个集群，B 类中的所有节点成为另一个集群。

在 Perl 中，我获取每个节点的类并按照以下方式执行操作：

```
if ($currentClass ne $lastClass) {
    $classCluster = {name => "class B"};
}
else {
    $classCluster = {name => "class A"};
}

$graph->add_node($currentNode, cluster => $classCluster); 
```

但是，这似乎并没有产生预期的结果。它创建了一个图，其中所有节点都正确绘制图形，但它们没有被分配到适当的集群，它们看起来好像它们不是任何集群的一部分。此外，“A 类”和“B 类”也出现在图中，但其中没有节点。

换句话说，我正在尝试将节点动态分配给集群。有什么想法可以做到吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T03:39:37.943

我不知道该`GraphViz`模块，但我怀疑问题是您正在创建多个匿名哈希来定义相同的集群。

Perl 每次执行`{name => "class B"}`时都会创建一个*新*的散列，因此您正在为每个恰好具有相同名称的节点创建一个新集群。

我建议你试着写

```
my $clusterA = { name => 'Class A' };
my $clusterB = { name => 'Class B' }; 
```

在主循环之外，然后将您显示的代码替换为

```
if ($currentClass ne $lastClass) {
    $cluster = $clusterB;
}
else {
    $cluster = $clusterA;
}

$graph->add_node($currentNode, cluster => $cluster); 
```

你应该得到一些更好的结果。

我担心您在集群 A 和集群 B 之间进行选择的方式。您拥有它的方式，除非它的类与前一个节点的类不同，否则所有内容都将进入集群 A，这似乎不正确。但是如果没有看到更多您的程序，特别是您的数据的性质和向图中添加节点的循环，我无法正确判断。

# asp.net - 在 asp.net MVC Javascript 事件中没有命中断点

> ID：13445558
> 
> 赞同：8
> 
> 时间：2012-11-18T23:05:55.873
> 
> 标签：asp.net, asp.net-mvc, visual-studio, debugging, visual-studio-2012

这似乎是关于 SO 的一个常见问题，我已经尝试了所有建议的解决方案，但没有用。

我的问题是，在我的 asp.net mvc 网站（在 VS2012 中）中，断点“是”在我的所有控制器代码中被击中，但它们“不是”在 aspx 页面中的实际 javascript 代码中被击中。javascript 中的断点显示旧的“此断点不会被命中。符号尚未加载”。

我检查了所有 pdb 文件，它们都在那里，模块窗口显示符号已加载。

任何想法为什么实际的标记断点不会被击中？

谢谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-18T23:50:00.487

您是否尝试过在 javascript 代码中添加“调试器”命令？我知道这通常是不受欢迎的。

例如：

```
 $(document).ready(function() {

         ....
         debugger;
         ....

}); 
```

您还可以尝试通过取消选中从 IE => 选项 => 高级中的**禁用脚本调试来在 IE 中启用 javascript 调试。**

参考：

*   [http://www.mayanksrivastava.com/2010/02/debugging-java-script-in-visual-studio.html](http://www.mayanksrivastava.com/2010/02/debugging-java-script-in-visual-studio.html)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-01-06T17:26:16.623

经过大量的战斗和研究，没有找到正确的答案，我发现了问题所在。由于我正在使用 RAZOR 编写 CSHTML 文件，因此在其中编写 javascript 似乎是一个问题。我不得不从文件中提取我所有的 javascript 并将它们放入一个 .js 文件中。我从这样的脚本声明中将这些文件加载​​到 cshtml 文件的顶部

```
<script src="~/Scripts/Users/Users.js"></script>
...<body></body>... 
```

现在我的断点被击中......这是我的答案，它奏效了。让我知道它是否适合您，如果可以，请批准此答案，以便其他人可以解决此问题。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-09-27T21:18:28.467

Javascript 中的断点仅在使用 Internet Explorer 进行调试时被命中，其他浏览器不起作用。（无论如何我都试过 Chrome + Firefox，不确定其他的）。

# javascript - 在 JavaScript 中检查变量是否只是整数的最佳方法

> ID：13445559
> 
> 赞同：0
> 
> 时间：2012-11-18T23:06:12.643
> 
> 标签：javascript

> **可能重复：**
> [如何检查数字是浮点数还是整数？](https://stackoverflow.com/questions/3885817/how-to-check-if-a-number-is-float-or-integer)

检查变量是否为整数的最佳方法是什么？

在 Python 中，您可以执行以下操作：

```
 if type(x) == int 
```

JS 中是否有同样优雅的等价物？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T23:07:59.630

我没有测试，但我建议：

```
if (Math.round(x) == x) {
    // it's an integer
} 
```

[简单的JS 小提琴](http://jsfiddle.net/davidThomas/hzNrQ/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T23:16:46.763

整数的 parseFloat() 和 parseInt() 等效项的数值将相同。因此你可以这样做：

```
function isInt(value){ 
    return (parseFloat(value) == parseInt(value)) && !isNaN(value);
} 
```

然后

```
if (isInt(x)) // do work 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-18T23:10:11.803

Javascript 提供 typeof

[https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/typeof](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/typeof)

```
 // Numbers
   typeof 37 === 'number';
   typeof 3.14 === 'number';
   typeof Math.LN2 === 'number';
   typeof Infinity === 'number';
   typeof NaN === 'number'; // Despite being "Not-A-Number"
   typeof Number(1) === 'number'; // but never use this form! 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-18T23:07:36.247

使用[isNaN](http://www.w3schools.com/jsref/jsref_isnan.asp)（不是数字 - 但要注意逻辑是否定的）并与 parseInt 结合使用：

```
function is_int(x)
{
    return (!isNaN(x) && parseInt(x) == x)
} 
```

正如[这里](https://stackoverflow.com/questions/3885817/how-to-check-if-a-number-is-float-or-integer)所建议的，以下内容也可以：

```
function isInt(n) {
   return n % 1 === 0;
} 
```

# c++ - Python ctypes：如何释放内存？获取无效指针错误

> ID：13445568
> 
> 赞同：17
> 
> 时间：2012-11-18T23:06:48.783
> 
> 标签：c++, python, c, ctypes

我想从带有 ctypes 的 C/C++ 库中获取一些字符串到 python 中。我的代码如下所示：

库中的代码：

```
const char* get(struct something *x) 
{
    [...]
    // buf is a stringstream
   return strdup(buf.str().c_str());
}

void freeme(char *ptr)
{
    free(ptr);
} 
```

Python代码：

```
fillprototype(lib.get, c_char_p, POINTER(some_model)])
fillprototype(lib.freeme, None, [c_char_p])

// what i want to do here: get a string into python so that i can work
// with it and release the memory in the lib.
c_str = lib.get(some_model)
y = ''.join(c_str)
lib.freeme(c_str) 
```

如果我 print() c_str，一切都在那里。问题出在（或似乎是）在 Python 的最后一行。我无法释放内存 - 库得到了错误的指针。我在这里做错了什么？（请不要建议 boost::python 左右）。

```
*** glibc detected *** python2: munmap_chunk(): invalid pointer: 0x00000000026443fc *** 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-11-19T11:04:45.980

正如 David Schwartz 指出的那样，如果将 restype 设置为`c_char_p`， ctypes 将返回一个常规的 Python 字符串对象。解决此问题的一种简单方法是使用 a`void *`并转换结果：

字符串.c：

```
#include <stdlib.h>
#include <string.h>
#include <stdio.h>

char *get(void)
{
    char *buf = "Hello World";
    char *new_buf = strdup(buf);
    printf("allocated address: %p\n", new_buf);
    return new_buf;
}

void freeme(char *ptr)
{
    printf("freeing address: %p\n", ptr);
    free(ptr);
} 
```

Python用法：

```
from ctypes import *

lib = cdll.LoadLibrary('./string.so')
lib.freeme.argtypes = c_void_p,
lib.freeme.restype = None
lib.get.argtypes = []
lib.get.restype = c_void_p

>>> ptr = lib.get()
allocated address: 0x9facad8
>>> hex(ptr)
'0x9facad8'
>>> cast(ptr, c_char_p).value
'Hello World'
>>> lib.freeme(ptr)
freeing address: 0x9facad8 
```

* * *

您也可以使用`c_char_p`. 事实证明，ctypes 不会`getfunc`为简单类型的子类调用 。

```
class c_char_p_sub(c_char_p):
    pass

lib.get.restype = c_char_p_sub 
```

该`value`属性返回字符串。您可以将参数 for 保留`freeme`为更通用的`c_void_p`。它接受任何指针类型或整数地址。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2018-03-20T23:53:42.277

释放内存的一个便宜的技巧是在 C 中静态分配它并且从不释放它。当然，只有当你知道你需要的最大数量，并且你知道在第二次调用你的例程之前你已经完成了它时，它才会起作用。

```
static char _externalStringBuffer[MAX_BUFFER_SIZE];
char *get() {
    // put characters in _externalStringBuffer
    return _externalStringBuffer;
} 
```

# google-maps - 地图 javascript api 中心问题

> ID：13445571
> 
> 赞同：1
> 
> 时间：2012-11-18T23:07:20.730
> 
> 标签：google-maps, google-maps-api-3

我的问题很简单。使用以下代码创建地图后，地图的中心位置没有很好。

```
var myOptions = {
  center: new google.maps.LatLng(47.000059, 2.06543),
  zoom: 9,
  mapTypeId: google.maps.MapTypeId.ROADMAP,
  scaleControl: false,
  streetViewControl: false,
  mapTypeControl: false,
};
var activity_map = new google.maps.Map(document.getElementById("activity-map"), myOptions); 
```

这一点是法国的中部。我的 div 是一个 200x200px 的块，具有隐藏的溢出和相对位置。似乎预期的中心位于 div 的左上角和角落。我已经尝试更改缩放级别，在初始化地图后设置中心，但它没有用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T23:28:33.367

问题不在您提供的代码中。“左上角”问题是当地图初始化时包含地图的 div 没有大小。您没有提供 HTML/CSS 来指定地图的大小（或者如果它最初是隐藏的则显示它）。

另一种可能性是您在 DOM 完全呈现之前初始化地图，您应该在 DOM 准备好或主体 onload 事件触发之后对其进行初始化。

# algorithm - 与正交二维网格相交平行线

> ID：13445572
> 
> 赞同：0
> 
> 时间：2012-11-18T23:07:32.860
> 
> 标签：algorithm, geometry, intersection

我有两条平行线，可以向任何方向移动。他们保证不一样。

我有一个二维网格（非整数坐标从 0.0 到 1.0，但我怀疑这可以通过缩放整个问题来解决），以通常的方式正交对齐。

我需要一种算法来生成所有正方形的列表，其中两条线之间有任何区域。

我目前的算法效率极低（将两条线表示为一个旋转的矩形，然后在每个正方形上测试多边形-多边形相交）。它有效，但速度非常慢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T23:22:46.850

如果您知道两条线的方向和位置，那么您可以使用[Bresenham 线算法](https://en.wikipedia.org/wiki/Bresenham%27s_line_algorithm)来计算将被任何一条线“触及”的所有“正方形”。添加中间方块将是一项简单的工作。如果两条线被整数个“正方形”隔开，那么您只需要为其中之一求解 Bresenham，但如果它们具有非整数分隔，则必须为它们求解（后者也可以即使线条不平​​行）。

# android - 大型应用程序如何处理网络可扩展性？

> ID：13445576
> 
> 赞同：0
> 
> 时间：2012-11-18T23:07:55.043
> 
> 标签：android, networking, scalability, enterprise

所以，基本上我正在寻找的是对大型应用程序如何处理/创建其用户数据库和网络连接的彻底解释？也许您自己创建了一个大型应用程序？他们使用套接字还是其他技术？压缩包？JSON？

我问的原因是因为我目前正在编写一个应用程序，该应用程序需要服务器端的用户数据库，当然还有来自客户端的某种套接字连接或 HTTPRequests。我知道很多人会使用该应用程序，我只是不知道如何使其可扩展..

我认为这是一个可以帮助更多人的问题，而不仅仅是我=）

任何帮助深表感谢！

// 亚历山大

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T14:10:16.413

除了使用可扩展性良好的 Web 服务器（如果配置正确，apache 可以很好地做到这一点），还有一些技术可以帮助您快速处理尽可能多的客户端。

为静态内容使用单独的服务器（即 nginx）。这是一个专门用于尽可能快地提供静态内容的特殊服务器。用于访问图像、js 文件、css 文件等......任何不会随着一个 Web 请求对另一个 Web 请求而改变的东西。

使用 memcached 限制数据库调用。当您的数据库调用成为瓶颈时，这将有所帮助（如果您在每个 Web 请求上多次 ping 数据库（动态内容），可能会很快发生）。这本质上是一个非常快的内存（读取：临时）位置，用于放置不会快速变化的数据。您必须修改您的代码以首先检查 memcached 以查看信息是否可用（即未过期......使用 memcached 您设置了一个过时的时间，该字段将被删除），如果是您使用此数据而不是ping 数据库。如果数据不可用，则 ping 数据库并将数据放入 memcached 中，并为下一个请求设置超时。

这个[博客](http://highscalability.com/)也有很好的信息。
其他人也提到[这本书](http://shop.oreilly.com/product/9780596102357.do)是一个很好的整体位置，以获得一些洞察力。

# sublimetext2 - 如何更改与 Sublime Text 2 中的选择匹配的单词的边框颜色？

> ID：13445577
> 
> 赞同：8
> 
> 时间：2012-11-18T23:07:56.647
> 
> 标签：sublimetext2, sublimetext

例如，双击一个词将其选中，然后该词的所有匹配项也会突出显示。

我应该在我的主题中更改哪些键来更改匹配单词的背景、前景和/或边框颜色？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-03-04T20:45:34.000

Sublime Text 2中未选中的找到文本周围的边框颜色没有配置键：*找到的文本*边框的颜色是光标颜色。如果你想改变它，你必须改变光标颜色。

要更改光标和*找到的文本*边框颜色，请设置文件中命名的键的`caret`值`.thTheme`。

换句话说，如果你想要一个黄色的*文本*边框，你还必须有一个 hello 光标。例如：

```
<key>caret</key>
<string>#ffff00</string> 
```

这是 Monokai Bright 主题中带有黄色*找到的文本边框和光标的外观：*

![在此处输入图像描述](../Images/98e04f66d8aeea11b0ecd43aa2740227.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-19T17:27:18.547

我想你正在寻找`findHighlight`和`inactiveSelection`

```
 <key>selection</key>
            <string>#C5DFE980</string>

            <key>findHighlight</key>
            <string>#ffe792</string>

            <key>inactiveSelection</key>
            <string>#ff7e00</string> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-07-05T14:38:22.713

在 Sublime Text 3`highlight`选项中更改匹配元素的边框颜色

```
<key>highlight</key>
<string>#ff00ff</string> 
```

# c++ - 编写 C++11 LINQ 风格的选择

> ID：13445582
> 
> 赞同：0
> 
> 时间：2012-11-18T23:08:10.703
> 
> 标签：c++, linq, select, c++11, where

我正在尝试为我的基类 Iterator 编写 LINQ 样式的方法，List 和 Sequence 将从该基类继承，但是这两个容器将有自己的这些方法的实现。“Where”方法非常简单。“选择”方法非常棘手；你不能有虚拟模板方法。

```
 template <typename T>
  class Iterator {
  public:
    virtual ~Iterator() {};

    // This is illegal, but if it weren't, it would be the functionality I want.
    template <typename R>
    virtual shared_ptr<IIterator<R>> Select(const function<R(T)>& func) = 0;

    virtual shared_ptr<IIterator<T>> Where(const function<bool(T)>& func) = 0;
  }; 
```

例如，“选择”将允许您将“火腿三明治”类型的迭代器转换为“生菜”类型的迭代器。

> HamSandwiches->Select<'Lettuce'>([] (shared_ptr<'HamSandwich'> hs) { return hs->Lettuce; });

忽略单引号。

因为我们不能有虚拟模板函数，所以我当然不能把函数设为虚拟。在这种情况下，我们有一个普通的旧函数，与虚函数相比，我们永远不应该通过在 List 和 Sequence 中编写实现来“隐藏”它的实现；这将被视为设计缺陷。

```
 template <typename T>
  class Iterator {
  public:
    virtual ~Iterator() {};

    template <typename R>
    shared_ptr<Iterator<R>> Select(const function<R(T)>& func);

    virtual shared_ptr<Iterator<T>> Where(const function<bool(T)>& func) = 0;
  };

  template <typename T>
  template <typename R>
  shared_ptr<Iterator<R>> Iterator<T>::Select(const function<R(T)>& func) {
    //Implementation - What would it be?
  } 
```

现在我们必须在我们的基类中有实现，这个实现需要特定于 List 和 Sequence。从我所见，您将开始创建受保护的“实现函数”以在“选择”中执行某些可能被列表或序列覆盖的操作。

我不是在这里寻找确切的答案，我正在寻找可以帮助我到达我可能/应该想去的地方的东西。有没有人发现任何常见的陷阱或我可能做错的事情？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T03:09:24.553

## 选项1

我看到的在 C++ 中实现 LINQ 的想法根本不依赖于虚拟方法。相反，每个结果都被包装在一个模板类中，大致如下：

```
template <class T>
class RangeWrapper
{
public:
    template <class U>
    Select(U u) -> decltype(...) {
        return RangeWrapper<SelectRange, U>(_myRange, u);
    }

private:
    T& _myRange;
}; 
```

如果你链接其中的一些，返回类型可能会变得非常大，但这是在编译时完成所有事情的代价。

## 选项 2

您可以实现类型擦除以始终返回 type 的迭代器`Iterator<T>`。这应该很容易使用网络上的类型擦除迭代器库来实现（有很多，你可以看看 boost.TypeErasure 已被接受但尚未发布）。或者，您可以在 boost 中使用 any_range，如果您可以使用范围（它们比迭代器更自然地映射到 LINQ）。

## 选项 3

如果您不将此作为培训练习，那么已经实施了几种解决方案。使用谷歌。值得注意的是，[Microsoft 本身正在开发 C++ Linq 以在其之上实现响应式扩展](http://rx.codeplex.com/SourceControl/changeset/view/ef6a42709f49#Ix%2b%2b%2fsrc%2fcpplinq%2flinq.hpp)。

# python - Scrapy Python Crawler - 每个都有不同的蜘蛛？

> ID：13445585
> 
> 赞同：1
> 
> 时间：2012-11-18T23:08:31.047
> 
> 标签：python, search, scrapy, web-crawler

我有很多不同的网站我想用 scrapy 抓取。我想知道这样做的最佳方法是什么？

您是否为要抓取的每个站点使用不同的“项目”，还是使用不同的“蜘蛛”，或者两者都不使用？

任何输入将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T09:50:13.857

每个站点的不同项目是最**糟糕**的想法。

为每个站点设置不同的 SPIDER 是个**好**主意。

如果您可以在一个 SPIDER 中调整多个站点（基于那里的性质）是一个**最好**的主意。

但又完全取决于您的**要求**。

# python - 通过 Python comtypes 库使用带有初始化 OUT 参数的 COM 接口

> ID：13445587
> 
> 赞同：3
> 
> 时间：2012-11-18T23:08:37.390
> 
> 标签：python, com, comtypes

我正在通过[comtypes](http://pypi.python.org/pypi/comtypes)模块从 Python 使用第 3 方 C++ 库（通过 COM 导出类型库）。

可用调用之一定义了一个 OUT 参数，如下所示：

```
COMMETHOD([helpstring(u'method GetPacket')], HRESULT, 'GetPacket',
          ( ['in'], comtypes.gen._00020430_0000_0000_C000_000000000046_0_2_0.GUID, 'guid' ),
          ( ['in'], c_int, 'lSize' ),
          ( ['out'], POINTER(c_ubyte), 'pData' )), 
```

库作者提供的 C++ 示例代码在调用 之前初始化`pData`为长度为字节的数组，如下所示：`lSize``GetPacket()`

```
pPacket = new BYTE[lSize];
HRESULT hr = pData->GetPacket(guid, lSize, pPacket); 
```

但是，Python 的 comtypes 库不提供传递初始值的方法`pData`-- 并且，在调用没有初始值的库时，解释器会立即出现段错误。

是否可以从 Python 与这个库进行互操作——理想情况下，从`comtypes`?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-01T22:40:13.170

对生成的`GetPacket`.

资料来源：[[comtypes-users] 使用指向数组的指针调用方法的正确方法？](http://sourceforge.net/mailarchive/forum.php?thread_name=4F1D33F9.2030304%40tudelft.nl&forum_name=comtypes-users)

```
# change GetPacket so the second argument is in, not out
packet = (c_ubyte * size)()
data.GetPacket(guid, size, packet) 
```

但是，请注意，类型库不包含有关`size_is`的信息`length_is`以及[其他一些内容](http://support.microsoft.com/kb/236970/en-us)。这意味着跨单元和进程边界使用的通用类型库编组器代理和存根不会查看`lSize`确定要序列化的元素数量`pData`，它总是（尝试）序列化单个指向的项目。

换句话说，那种代码，无论是 C++ 还是 Python，都只能在同一个公寓里工作。

# java - jsoup 线程安全

> ID：13445589
> 
> 赞同：7
> 
> 时间：2012-11-18T23:08:51.503
> 
> 标签：java, jsoup

Jsoup`parse(String html)`不是线程安全的。如何同时使用 Jsoup 解析多个文档？谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-18T23:13:36.350

通过使用`Joup.parse`.

只要您不在同一个文档上工作，它就会在内部创建新对象。

[https://groups.google.com/forum/?fromgroups=#!topic/jsoup/QIij7DEhj8E](https://groups.google.com/forum/?fromgroups=#!topic/jsoup/QIij7DEhj8E)

这不时出现；可能值得为此提出文档问题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-18T23:22:15.647

查看[Jsoup.java](http://grepcode.com/file/repo1.maven.org/maven2/org.jsoup/jsoup/1.6.1/org/jsoup/Jsoup.java?av=f)源代码，它没有任何状态，两个*parse()*方法都委托给[Parser.parse()](http://grepcode.com/file/repo1.maven.org/maven2/org.jsoup/jsoup/1.6.1/org/jsoup/parser/Parser.java#Parser.parse%28java.lang.String,java.lang.String%29)，后者在内部创建并委托给[TreeBuilder.parse()](http://grepcode.com/file/repo1.maven.org/maven2/org.jsoup/jsoup/1.6.1/org/jsoup/parser/TreeBuilder.java#TreeBuilder.parse%28java.lang.String,java.lang.String%29)。Jsoup*和**Parser*类都没有状态，只持有静态方法。*TreeBuilder*类虽然有一个状态并且似乎正在完成所有工作，但它是从一个方法中创建的，因此整个操作由于堆栈/线程限制是线程安全的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-18T23:20:59.787

只是从经验证据中补充前面的答案：在性能测试期间，我们使用了 JSoup 1.6.1，每秒 20 个请求，没有不良结果。

# c++ - 从 x86 代码返回的 C/C++

> ID：13445590
> 
> 赞同：0
> 
> 时间：2012-11-18T23:09:00.673
> 
> 标签：c++, assembly, return

我目前正在研究在 C/C++ 中使用一些 ASM

我有以下

```
__declspec(naked) unsigned long 
someFunction( unsigned long inputDWord )
{
    __asm
    {
    }
} 
```

在 asm 中，我将如何返回 unsigned long？

我需要将一些东西压入堆栈然后调用 ret 吗？我很长时间没有使用过 Asm，以前也从未使用过 C++。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T23:11:31.900

**编辑：**感谢@Matteo Italia，我更正了`ret`.

将 retval 放入`eax`寄存器中，这是根据`__cdecl`和`__stdcall`约定的。

然后，根据调用约定，您应该使用适当的`ret`指令变体：

*   在`__cdecl`约定（或类似）的情况下 - 使用`ret`. 在机器级别上，这意味着`pop`从堆栈返回地址并返回`jmp`到它。调用者负责从堆栈中删除所有函数参数。
*   在`__stdcall`约定（或类似）的情况下 - 使用`ret X`, 而是`X`所有函数参数的大小。

# mongoose - 使用猫鼬插入/更新记录

> ID：13445593
> 
> 赞同：8
> 
> 时间：2012-11-18T23:09:30.137
> 
> 标签：mongoose

我正在尝试使用 mongoose 将记录插入 mongodb，但是当记录已经在数据库中时，记录不会更新。有什么我做错了吗？mongoose 的文档对我来说并不是最容易理解的。

```
models.fg_records.update({email:clean_email}, inactive_user, {update: true}, function (err) {
    if(err){
        throw err;
        console.log(err);
    } else {

        // send mail with defined transport object
        transport.sendMail(message, function(err, response) {
            if(err) {
                console.log(err);
                view('<ul><li>There was a problem sending an email to this user. Make sure you types it correctly.</li></ul>');
            } else {
                res.redirect('/records');
            }
        });

    }
}); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-18T23:13:49.610

尝试将选项“upsert”传递给更新函数，而不是“更新”，这不是有效的选项[文档](http://mongoosejs.com/docs/api.html#model_Model-update)。

```
models.fg_records.update({email:clean_email}, inactive_user, {upsert: true}, function (err) { ... }): 
```

# android - Android 中 Fragments 和 Activity 之间的数据共享

> ID：13445594
> 
> 赞同：34
> 
> 时间：2012-11-18T23:09:29.813
> 
> 标签：android, android-fragments, android-activity, data-sharing

我之前问过类似的问题，但没有得到答案，似乎许多其他人都在寻找答案。所以我发布这个问题是希望得到一个明确的答案，每个人都可以从中受益。

我有一个包含 2 个片段的活动。我希望 fragment2 在选中复选框时在 Activity 中设置一个布尔变量，以便 fragment1 可以知道复选框是否已选中。

这是我的代码：

活动：

```
public class modestab extends Activity{
    public static Context appContext;

    public boolean lf=false;

    public void onCreate(Bundle savedInstanceState){
        appContext=this;
super.onCreate(savedInstanceState);
ActionBar tabbar= getActionBar();
        tabbar.setNavigationMode(ActionBar.NAVIGATION_MODE_TABS);
        ActionBar.Tab ModesTab =tabbar.newTab().setText("Modes");
        ActionBar.Tab CatTab =tabbar.newTab().setText("Categories");

        Fragment ModesFragment =new modes();
        Fragment CatFragment =new cats();

        ModesTab.setTabListener(new MyTabsListener(ModesFragment));
        CattTab.setTabListener(new MyTabsListener(CatFragment));

        tabbar.addTab(ModesTab);
        tabbar.addTab(CatTab);

    } 
```

片段 1：（我想阅读上面 Acitivity 中设置的布尔 lf：

```
@TargetApi(11)
public class tabmodes extends Fragment{
@Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState)
    {
View V=inflater.inflate(R.layout.tab_modes, container, false);
button1.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View v) {
                // TODO Auto-generated method stub
                if(lf==false) //lf here is the lf in Activity which I want to get 
```

片段 2：我想在 Activity 中设置 lf 的位置

```
.....
lifecheck.setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener(){
              @Override
                public void onCheckedChanged(CompoundButton buttonView,
                        boolean isChecked) {
                  if(lifecheck.isChecked())
                      getActivity().lf=true;//Where I want to set the lf flag in Activity
                  ;
              }
          }); 
```

该代码无法编译，我不知道如何在 Activity 中设置 lf 也不知道如何阅读它。有人建议我做 getActivity() 但我看不到变量。

我试图创建一个函数 setlf(boolean jk) 但我也看不到它......

欢迎任何帮助:)

* * *

## 回答 #1

> 赞同：119
> 
> 时间：2013-12-11T14:32:27.177

很多种方法 ：

1)**活动 -> 片段**

*   *在您的活动中*：创建一个包并使用**片段。[设置参数（包）](http://developer.android.com/reference/android/app/Fragment.html#setArguments%28android.os.Bundle%29)**
*   *在你的片段中* ：使用**Bundle bundle = [getArguments()](http://developer.android.com/reference/android/app/Fragment.html#getArguments%28%29)**

2)**活动 -> 片段**

*   *在您的 Fragment 中*：创建一个公共方法

*   *在您的活动中*：调用**活动**片段公共方法：

    [获取支持片段管理器](http://developer.android.com/reference/android/support/v4/app/FragmentActivity.html#getSupportFragmentManager%28%29)（）。[findFragmentById](http://developer.android.com/reference/android/app/FragmentManager.html#findFragmentById%28int%29) (R.id.your_fragment).publicMethod(args)

3)**片段 -> 活动**

*   *在您的片段*中：使用 getter 和 setter 方法（[回调方法](http://developer.android.com/guide/components/fragments.html#CommunicatingWithActivity)）创建 un 接口
*   *在您的活动*中：实现接口

4)**片段 -> 活动**

*   *在您的活动中*：创建公共 getter 和 setter 或其他方法
*   *在您的 Fragment*中：使用以下方法调用公共活动 getter、setter 或其他方法：

    [getActivity()](http://developer.android.com/reference/android/support/v4/app/Fragment.html#getActivity%28%29) .getSomething()、[getActivity()](http://developer.android.com/reference/android/support/v4/app/Fragment.html#getActivity%28%29) .setSomething(args) 或[getActivity()](http://developer.android.com/reference/android/support/v4/app/Fragment.html#getActivity%28%29) .someMethod(args)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-18T23:43:59.717

您可以通过两种方式在片段之间传递数据，

首先，您可以使用[setArguments(...)](http://developer.android.com/reference/android/app/Fragment.html#setArguments%28android.os.Bundle%29)和[getArguments(....)](http://developer.android.com/reference/android/app/Fragment.html#getArguments%28%29)

其次，您可以使用[回调来做到这一点](http://developer.android.com/guide/components/fragments.html#EventCallbacks)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-01-18T11:47:19.990

您也可以使用**EventBus**。这真的很简单。 [https://github.com/greenrobot/EventBus](https://github.com/greenrobot/EventBus)

绝对不要像我的旧答案那样使用静态方法:)

# wpf - 等待 itemcontrol 渲染

> ID：13445595
> 
> 赞同：-1
> 
> 时间：2012-11-18T23:09:51.730
> 
> 标签：wpf, data-binding, itemscontrol, itemrenderer, itemtemplate

我的 ItemControl 通过 ItemsSource 绑定到 ObservableCollection<...>。当我填充集合时，程序需要一些（一点，但仍然需要一些）时间来创建正确的 ItemTemplate 对象并将它们呈现在我的 ItemsControl 中。如果我的 ItemsControl 已经结束创建（渲染、显示）通过 ItemsSource 绑定的集合，有什么方法可以知道吗？请帮忙。我真的很需要这个答案。在填充 ObservableCollection 之后，我想处理这个集合的对象。不幸的是，一些信息正在丢失，因为 ItemsControl 仍在创建它的项目（ItemTemplates）。

***编辑** 为了更好地理解： ObservableCollection<...> MyCollection 绑定到 MyItemsControl 的 ItemsSource。

我运行代码：

```
for(int i = 0; i < ...; i++)
{
    MyCollection.Add(MyItem);
}

// await Task.Delay(100) // If this line is not commented, everything works fine...
// ..but I don't think it's a good idea to solve that problem in this way.

foreach(Object o in MyCollection)
{
    // The line under, is faster that the ItemsControl rendering...
    // ...so the Work is not displayed.
    o.DoSomeWorkThatShouldBeDisplayedInItemTemplateOfMyItemsControl
} 
```

***编辑 2** 已解决：LayoutUpdated 事件

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T13:08:03.383

我知道了。LayoutUpdated 事件是我需要的。在另一个论坛上找到，但希望将来能帮助某人。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-19T01:13:09.940

尝试`System.Windows.Forms.Application.DoEvents();`

# android - 幸运的修补程序，我该如何保护它？

> ID：13445598
> 
> 赞同：29
> 
> 时间：2012-11-18T23:10:10.077
> 
> 标签：android, android-lvl

我知道这个话题已经被打开了很多次，我学到了很多，但我偶然发现了一个我真的需要建议的问题。

我正在使用带有混淆的 LVL。我更改了默认的 LVL ALOT，以便反 LVL 不会破坏它。然而，幸运补丁一键破解！我试图查看新损坏的 APK。是的，它简单地称为我的“允许方法”。

我的问题是，是否有人可以推荐一种方法来防止 Lucky Patcher 破坏它？我知道我不能让它防弹，但我希望它至少对于一键式软件来说不是那么容易。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2013-02-06T22:50:25.533

检查您的证书的代码：

```
public void checkSignature(final Context context) {
    try {
        Signature[] signatures = context.getPackageManager().getPackageInfo(context.getPackageName(), PackageManager.GET_SIGNATURES).signatures;

        if (signatures[0].toCharsString() != <YOUR CERTIFICATE STRING GOES HERE>) {
            // Kill the process without warning. If someone changed the certificate
            // is better not to give a hint about why the app stopped working
            android.os.Process.killProcess(android.os.Process.myPid());
        }
    } 
    catch (NameNotFoundException ex) {
        // Must never fail, so if it does, means someone played with the apk, so kill the process
        android.os.Process.killProcess(android.os.Process.myPid());
    }
} 
```

接下来如何找到哪个是您的证书。您必须在发布模式下生成 APK，因为调试证书与发布证书不同。将您的证书输出到您的 Logcat 中：

```
signatures[0].toCharsString(); 
```

请记住，当您返回调试模式时，证书再次不同。为避免调试问题，请使用下一行跳过验证：

```
if ((context.getApplicationContext().getApplicationInfo().flags &= ApplicationInfo.FLAG_DEBUGGABLE) != 0)
    return; 
```

接下来是幸运的修补程序检查器。我反编译了 Lucky Patcher 的所有版本，我发现它的创建者在所有版本之间使用了 2 个包名。所以你只需要跟踪新版本并不断添加未来的包名称。

```
private boolean checkLuckyPatcher() {
    if (packageExists("com.dimonvideo.luckypatcher"))
        return true;

    if (packageExists("com.chelpus.lackypatch"))
        return true;

    if (packageExists("com.android.vending.billing.InAppBillingService.LACK"))
        return true;

    return false;
}

private boolean packageExists(final String packageName) {
    try {
         ApplicationInfo info = this.getPackageManager().getApplicationInfo(packageName, 0);

        if (info == null) {
            // No need really to test for null, if the package does not
            // exist it will really rise an exception. but in case Google
            // changes the API in the future lets be safe and test it
            return false;
        }

        return true;
    }
    catch (Exception ex) {
        // If we get here only means the Package does not exist
    }

    return false;
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2017-04-12T14:07:16.253

在当前版本 (6.4.6) 中，Lucky Patcher 生成非常短的令牌。例如，真正的购买令牌：

```
felihnbdiljiajicjhdpcgbb.AO-J1OyQgD6gEBTUHhduDpATg3hLkTYSWyVZUvFwe4KzT3r-O7o5kdt_PbG7sSUuoC1l6dtqsYZW0ZuoEkVUOq5TMi8LO1MvDwdx5Kr7vIHCVBDcjCl3CKP4UigtKmXotCUd6znJ0KfW 
```

那就是幸运令牌：

```
kvfmqjhewuojbsfiwqngqqmc 
```

非常直接的解决方案是检查令牌的字符串长度

```
@Override public void onIabPurchaseFinished(IabResult result, Purchase info) {
    if (info.getToken().length < 25) {
        Log.wtf("PIRATE", "PIRATE DETECTED");
        return;
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T14:28:56.007

实现一个在某些操作下被调用的函数，该函数检查设备中是否安装了 LuckyPatcher 包。

如果找到，则退出您的应用程序。不管有没有付费，都不允许使用，差评胜过千千万万的盗版。或者，您可以显示一条消息，指出已找到 LuckyPatcher 并且该应用程序无法运行。

如果您的应用程序被 LuckyPatcher 修补，这意味着它已经入侵了您的 LVL 实现，那么由于 LuckyPatcher 包检测，至少您的应用程序不会执行。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-05T19:35:40.020

一种方法是检查是否安装了幸运补丁程序，如果是，则向用户显示一条消息，然后终止您的进程。如果用户拥有它，则意味着他正试图破解您的软件或其他开发人员的软件。所以最好不要允许在安装了它的手机中使用你的应用程序。打击盗版。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2016-12-18T15:05:56.177

每当 Lucky Patcher 创建一个修改后的 APK 文件时，它总是以不同的包名称结束，因为您不能以相同的包名称运行两个应用程序。

这是一个简单的解决方案，用于检查您的代码是否在错误的包名称下运行：

```
PackageManager pm = getPackageManager();

try {
    PackageInfo packageInfo = pm.getPackageInfo("YOUR_PACKAGE_NAME",PackageManager.GET_ACTIVITIES);
} catch (PackageManager.NameNotFoundException e){
    finish(); 
    //If you get here, your code is running under a different package name... Kill the process!
} 
```

我只是调用`finish();`我的应用程序，但无法破坏它，但最好`android.os.Process.killProcess(android.os.Process.myPid());`按照@PerracoLabs 的建议使用。

# java - 泛型和类转换

> ID：13445600
> 
> 赞同：1
> 
> 时间：2012-11-18T23:10:23.560
> 
> 标签：java, generics, wrapper, primitive, unchecked

我正在尝试生成旧代码，并且有一些代码在给定类似`Integer.class`的情况下返回`Integer.TYPE`（反之亦然），以此类推其他包装器（如果输入不是包装器，则返回输入类）。这似乎是转换的候选者（如果它在某处尚不存在）。所以，我有这样的事情：

```
public static <T> Class<T> convert(Class<T> type) {
    if (type == Integer.class) return Integer.TYPE;
    // and so on
    return type;
} 
```

这段代码的问题在于，编译器本身并不知道在 if 块中我们已经确定了`T == Integer`，因此不知道返回`Integer.TYPE`是可以的，因此令人讨厌。当然，我们总是可以显式转换为`Class<T>`. 问题是，这个演员表是否安全，因此我可以放心添加`@SuppressWarnings("unchecked")`注释？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T23:18:51.160

`@SuppressWarnings("unchecked")`在这里应该没问题：我们知道每个包装类都`W`将其`TYPE`字段声明为`Class<W>`, - 可能只是添加注释来解释这一点。

请注意，[Guava](https://code.google.com/p/guava-libraries/)已经必须[`Primitives.unwrap`](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/primitives/Primitives.html#unwrap%28java.lang.Class%29)为您处理这个问题，以防您使用它。

# sql - 有没有办法使用 INNER JOIN 解决“多值字段 '[Table X].[Field Y]' 在指定的 Join 子句中无效”？

> ID：13445603
> 
> 赞同：2
> 
> 时间：2012-11-18T23:10:38.443
> 
> 标签：sql, ms-access, ms-access-2007

当我尝试在行源中为我正在使用的字段应用以下 SELECT 语句时出现错误。

```
SELECT [Poems].[ID],
   [Poems].[Title],
   [Poems].[Year Completed],
   [Poem Types].[Poem Type],
   [Poems].[Blog Location]
FROM Poems 
INNER JOIN [Poem Types] 
   ON [Poems].[Poem Type]=[Poem Types].[ID] 
ORDER BY [Title]; 
```

错误是：

> 多值字段 '[Poems].[Poem Type]' 在指定的 Join 子句中无效。

表 [诗歌类型] 是在我知道如何创建值列表之前创建的。但是，实际上我现在对此很满意，因为我最终对列表进行了一些更改，它会自动更新使用该表的所有记录，如果我必须对值列表执行相同操作，我会必须单独或通过查找和替换来查看和更新​​记录。所以，小键表实际上是有用的。

如错误所示，[Poems] 中引用该表的字段是多值字段。但是，我无法从逻辑上看出这意味着什么，因为它应该只列出现有值，即使它们不止一个。不是问题。我已经确认语法是正确的，而是使用非多值字段并观察列表框很好地填充了正确的值。

所以，我的问题。我可以利用这个限制吗？例如，整个 Poems 表中只有几个条目在该字段中使用了多个值。我只允许多个值，因为在极少数情况下，一首多部分诗包含多种诗歌类型。因此，例如，如果有必要并且 Access 允许它，也许我可以过滤掉那些包含多个值的条目？或者也许还有其他方法？

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T01:50:20.360

长话短说，`[Table].[MultiValuedField].Value`当您的查询针对（以一种或另一种方式）存储在该字段中的特定值时，您需要使用语法。[本文](http://office.microsoft.com/en-us/access-help/using-multivalued-fields-in-queries-HA010149297.aspx)详细解释了它将产生的差异。

# javascript - 如何将 jQuery 滑块值乘以定义的变量？

> ID：13445606
> 
> 赞同：0
> 
> 时间：2012-11-18T23:11:12.957
> 
> 标签：javascript, jquery, html

我想将每天的分钟数（其值由滑块定义）乘以指定的数字（如 0.05）。然后我想将它乘以 30，这样就可以得到粗略的每月估计。然后我想在底部附近的“估计每月账单”段落旁边显示该值。

前任。

```
monthlyEstimate = slidervalue * .05 * 30 
```

滑块是从 jQuery UI 网站借来的。这是代码：

```
 <head>
    <script>
$(function() {
    $( "#slider-range-min" ).slider({
        range: "min",
        value: 1,
        min: 1,
        max: 150,
        slide: function( event, ui ) {
            $( "#amount" ).val( "" + ui.value );
        }
    });
    $( "#amount" ).val( "" + $( "#slider-range-min" ).slider( "value" ) );
     });
</script>

</head>

<body>
    <style>
    #slider-range-min{
    width: 200px;
    height:10px;
    }
    </style>
     <div id="estimate">

    <p>
        <label for="amount">Minutes Per Day:</label>
        <input type="text" id="amount" style="border: 0; color: #B01D63; font-family: Signika;" />
    </p>

    <div id="slider-range-min"></div>
    <br />

 <p>
    Estimated Monthly Bill:     
 </p> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T23:25:17.833

在您估计的每月账单文本下方添加一个跨度，以便我们可以将值放入指定位置：

**HTML**

```
<p>
    Estimated Monthly Bill:
    <span id="EstimatedMonthlyBill"></span>
</p> 
```

然后更改您的滑块幻灯片属性以进行计算并插入值：

**Javascript**

```
$(function() {
    $("#slider-range-min").slider({
        range: "min",
        value: 1,
        min: 1,
        max: 150,
        slide: function(event, ui) {
            $("#amount").val("" + ui.value);

            var estimatedMonthlyBill = Math.round(100 * (parseFloat(ui.value)  * .05 * 30)) / 100;

            $("#EstimatedMonthlyBill").text(estimatedMonthlyBill);
        }
    });
    $("#amount").val("" + $("#slider-range-min").slider("value"));
}); 
```

**演示**
[http://jsfiddle.net/2FMRU/](http://jsfiddle.net/2FMRU/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T23:25:44.017

改变

```
 <p>
  Estimated Monthly Bill:     
 </p> 
```

到

```
<p>
 Estimated Monthly Bill: <span id='estimate'></span>
</p> 
```

当滑块移动时，我们将使用 jQuery 更新名为estimate 的跨度。`*`是 javascript 中的乘法运算符。在下面的代码中，替换`SOME_CONSTANT`为您需要的任何内容。大多数十进制数字，例如。`100.234`，`0.00005`应该可以正常工作。

改变

```
slide: function( event, ui ) {
        $( "#amount" ).val( "" + ui.value );
    } 
```

对于这样的事情：

```
slide: function( event, ui ) {
        $( "#amount" ).val( "" + ui.value );
        $("#estimate").val("" + (ui.value*SOME_CONSTANT*30) );
} 
```

当滑块移动时，`<span id='estimate'>`将更新以显示计算值。

我希望这就是你要找的。

# sql - 像我一样使用事务回滚整个数据库

> ID：13445608
> 
> 赞同：1
> 
> 时间：2012-11-18T23:11:26.377
> 
> 标签：sql, sql-server, transactions, sql-server-2008-r2

我正在对开发数据库进行一些测试。我想要一种简单的方法来回滚到已知状态，但是由于数据库的大小，从备份恢复需要 5 分钟才能执行。

我想要“回滚”的工作分布在许多连接上，我无法修改某些连接的 sql，因为它们来自我无权访问源的应用程序（所以我不能只用一个巨人`BEGIN TRANSACTION`）

有没有比从备份恢复更轻的东西，但我不需要显式启用 like`BEGIN TRANSACTION`并且还可以回滚由已打开、执行其工作并在创建回滚到的点后关闭的连接完成的工作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T23:17:45.557

您可以在开始时使用[数据库快照](http://msdn.microsoft.com/en-us/library/ms190467%28v=sql.105%29.aspx)并在结束时恢复到它。但是，您必须关闭所有连接，因为它与 BACKUP/RESTORE 非常相似，尽管它肯定更轻量级。一种方法是在恢复之前终止所有连接。如果您的应用程序可以在连接失败后重新连接到数据库，这应该涵盖了您想要实现的目标。

```
----To create a snapshot
create database SrcDbSnapshot
on ( name = LogicalFileNameFromSrcDB, 
    filename = 'E:\SrcDB.ss')
AS SNAPSHOT OF SrcDB
go

----To roll back
--Kills all connections and performs the rollback
ALTER DATABASE [SrcDB] SET SINGLE_USER WITH ROLLBACK IMMEDIATE
RESTORE DATABASE [SrcDB] FROM DATABASE_SNAPSHOT = 'SrcDbSnapshot'
go

----To remove the snapshot
drop database SrcDbSnapshot
go 
```

# c# - BDD、SpecFlow 和 Gherkin 在一起

> ID：13445615
> 
> 赞同：9
> 
> 时间：2012-11-18T23:13:07.650
> 
> 标签：c#, .net, bdd, specflow, gherkin

我最近才听说[BDD](http://dannorth.net/introducing-bdd/)（行为驱动开发），我很喜欢这个想法。因为我主要使用 C# 和 .NET，所以我找到了[SpecFlow](http://www.specflow.org)，然后得知 SpecFlow 使用[Gherkin](https://github.com/cucumber/cucumber/wiki/Gherkin)，现在我感到迷茫。您在哪里可以找到官方文档，告诉您您需要了解的有关 SpecFlow 的所有信息，对于 Gherkin 也是如此。

简而言之：有没有关于使用这些工具开发现实生活（实际）应用程序的书（不是博客和文章）？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-19T00:18:59.420

不确定是否有很多书涵盖了这一点。这本书：**使用 SCRUM 进行 Pro Agile .NET 开发**确实在其中一章中介绍了 BDD。

*   [http://www.amazon.com/Agile-Development-SCRUM-Professional-Apress/dp/1430235330](https://rads.stackoverflow.com/amzn/click/com/1430235330)

我个人是通过以下文章/视频了解到的：

*   [http://msdn.microsoft.com/en-us/magazine/gg490346.aspx](http://msdn.microsoft.com/en-us/magazine/gg490346.aspx)
*   [http://channel9.msdn.com/Series/mvcConf/mvcConf-2-Brandom-Satrom-BDD-in-ASPNET-MVC-using-SpecFlow-WatiN-and-WatiN-Test-Helpers](http://channel9.msdn.com/Series/mvcConf/mvcConf-2-Brandom-Satrom-BDD-in-ASPNET-MVC-using-SpecFlow-WatiN-and-WatiN-Test-Helpers)
*   [http://www.codeproject.com/Articles/82891/BDD-using-SpecFlow-on-ASP-NET-MVC-Application](http://www.codeproject.com/Articles/82891/BDD-using-SpecFlow-on-ASP-NET-MVC-Application)
*   [http://blog.stevensanderson.com/2010/03/03/behavior-driven-development-bdd-with-specflow-and-aspnet-mvc/](http://blog.stevensanderson.com/2010/03/03/behavior-driven-development-bdd-with-specflow-and-aspnet-mvc/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-19T03:30:11.523

官方文档在 github 上：[https ://github.com/techtalk/SpecFlow/wiki/Documentation](https://github.com/techtalk/SpecFlow/wiki/Documentation)

小黄瓜文档：[https ://github.com/cucumber/cucumber/wiki/Gherkin](https://github.com/cucumber/cucumber/wiki/Gherkin)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-19T06:02:08.733

我强烈推荐黄瓜书（http://pragprog.com/book/hwcuc/the-cucumber-book）。

这与 C# 和 SpecFlow 无关，但所有概念都适用。爱它

# java - 如何将 jPanel 中的所有 jPanel 向左对齐？

> ID：13445621
> 
> 赞同：2
> 
> 时间：2012-11-18T23:14:06.147
> 
> 标签：java, swing, jpanel, layout-manager, boxlayout

嘿，我正在尝试将面板内的所有面板对齐到较大面板的左侧。

这是我目前面临的图片：

![框面板布局](../Images/2dac0730fa8bdbc26174c038b5725dd3.png)

对于主面板（包含所有其他面板的面板 - 我将其称为主面板！）我在创建它时使用以下代码：

```
 JPanel panel = new JPanel();
    panel.setLayout(new BoxLayout(panel, BoxLayout.Y_AXIS)); 
```

对于其中的每个面板，我也在使用 BoxLayout，但我已经在每个面板上尝试了 [jpanel].setAlignmentX(Component.LEFT_ALIGNMENT) 之类的东西，但这似乎不起作用。

任何帮助，将不胜感激！

:)

编辑：对于“框（m）的尺寸：”标签，有没有办法将它与它所在的面板顶部对齐？它在自己的面板中。

编辑：一旦固定：

![JPanel 问题一旦修复](../Images/8dd653bb0f116a40ed0d778cd924df2d.png)

下面的解决方案，谢谢大家的帮助:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-19T00:16:51.487

您有多种可能性，具体取决于您的所有需求。

我在这里所做的只是使用复合面板并`GridBagLayout`用于调整布局

![在此处输入图像描述](../Images/c849c40eac7df6f201e7dda326b295b4.png)

```
public class BadLayout03 {

    public static void main(String[] args) {
        new BadLayout03();
    }

    public BadLayout03() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException | InstantiationException | IllegalAccessException | UnsupportedLookAndFeelException ex) {
                }

                JFrame frame = new JFrame();
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(new MasterPane());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }

    public class MasterPane extends JPanel {

        public MasterPane() {
            setLayout(new GridBagLayout());
            GridBagConstraints gbc = new GridBagConstraints();
            gbc.gridx = 0;
            gbc.gridy = 1;
            gbc.weightx = 1;
            gbc.fill = GridBagConstraints.HORIZONTAL;
            gbc.insets = new Insets(4, 4, 4, 4);
            gbc.anchor = GridBagConstraints.WEST;
            add(new DimensionsPane(), gbc);
            gbc.gridy++;
            add(new ColorPane(), gbc);
            gbc.gridy++;
            add(new ReinforementPane(), gbc);
            gbc.gridy++;
            add(new SealableTopPane(), gbc);
            gbc.gridy++;
            add(new CardGradePane(), gbc);
            gbc.gridy++;
            add(new QuantityPane(), gbc);
            gbc.gridy++;
            add(new OrderPricePane(), gbc);
        }

    }

    public class DimensionsPane extends JPanel {

        public DimensionsPane() {
            setLayout(new GridBagLayout());
            GridBagConstraints gbc = new GridBagConstraints();
            gbc.gridx = 0;
            gbc.gridy = 1;
            gbc.weightx = 1;
            gbc.anchor = GridBagConstraints.WEST;
            add(new JLabel("Dimensions of box (m):"), gbc);

            gbc.gridx = 1;
            gbc.gridy = 0;
            gbc.anchor = GridBagConstraints.EAST;
            add(new JLabel("Length: 33.0"), gbc);
            gbc.gridy++;
            add(new JLabel("Width: 3.0"), gbc);
            gbc.gridy++;
            add(new JLabel("Height: 3.0"), gbc);
        }

    }

    public class ColorPane extends JPanel {

        public ColorPane() {
            setLayout(new GridBagLayout());
            GridBagConstraints gbc = new GridBagConstraints();
            gbc.gridx = 0;
            gbc.gridy = 0;
            gbc.weightx = 1;
            gbc.anchor = GridBagConstraints.WEST;
            add(new JLabel("Colour :"), gbc);

            gbc.gridx = 1;
            gbc.gridy = 0;
            gbc.anchor = GridBagConstraints.EAST;
            add(new JLabel("0"), gbc);
        }

    }

    public class ReinforementPane extends JPanel {

        public ReinforementPane() {
            setLayout(new GridBagLayout());
            GridBagConstraints gbc = new GridBagConstraints();
            gbc.gridx = 0;
            gbc.gridy = 0;
            gbc.weightx = 1;
            gbc.anchor = GridBagConstraints.WEST;
            add(new JLabel("Reinforcement :"), gbc);

            gbc.gridx = 1;
            gbc.gridy = 0;
            gbc.anchor = GridBagConstraints.EAST;
            add(new JLabel("None"), gbc);
        }

    }

    public class SealableTopPane extends JPanel {

        public SealableTopPane() {
            setLayout(new GridBagLayout());
            GridBagConstraints gbc = new GridBagConstraints();
            gbc.gridx = 0;
            gbc.gridy = 0;
            gbc.weightx = 1;
            gbc.anchor = GridBagConstraints.WEST;
            add(new JLabel("Selable top :"), gbc);

            gbc.gridx = 1;
            gbc.gridy = 0;
            gbc.anchor = GridBagConstraints.EAST;
            add(new JLabel("No"), gbc);
        }

    }

    public class CardGradePane extends JPanel {

        public CardGradePane() {
            setLayout(new GridBagLayout());
            GridBagConstraints gbc = new GridBagConstraints();
            gbc.gridx = 0;
            gbc.gridy = 0;
            gbc.weightx = 1;
            gbc.anchor = GridBagConstraints.WEST;
            add(new JLabel("Grade of card:"), gbc);

            gbc.gridx = 1;
            gbc.gridy = 0;
            gbc.anchor = GridBagConstraints.EAST;
            add(new JLabel("1"), gbc);
        }

    }

    public class QuantityPane extends JPanel {

        public QuantityPane() {
            setLayout(new GridBagLayout());
            GridBagConstraints gbc = new GridBagConstraints();
            gbc.gridx = 0;
            gbc.gridy = 0;
            gbc.weightx = 1;
            gbc.anchor = GridBagConstraints.WEST;
            add(new JLabel("Quantity:"), gbc);

            gbc.gridx = 1;
            gbc.gridy = 0;
            gbc.anchor = GridBagConstraints.EAST;
            add(new JLabel("1"), gbc);
        }

    }

    public class OrderPricePane extends JPanel {

        public OrderPricePane() {
            setLayout(new GridBagLayout());
            GridBagConstraints gbc = new GridBagConstraints();
            gbc.gridx = 0;
            gbc.gridy = 0;
            gbc.weightx = 1;
            gbc.anchor = GridBagConstraints.WEST;
            add(new JLabel("Order price:"), gbc);

            gbc.gridx = 1;
            gbc.gridy = 0;
            gbc.anchor = GridBagConstraints.EAST;
            add(new JLabel("$558.9"), gbc);
        }

    }

} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-18T23:38:44.407

您可以使用[MigLayout](http://www.miglayout.com/)：

```
import java.awt.Color;
import javax.swing.BorderFactory;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.SwingUtilities;
import net.miginfocom.swing.MigLayout;

public class PanelAlignment extends JFrame {
    JPanel contentPane = new JPanel();
    JPanel firstPanel = new JPanel();
    JPanel secondPanel = new JPanel();
    JPanel thirdPanel = new JPanel();

    JLabel dimOfBox, rein, seaTop;

    public PanelAlignment() {
        contentPane.setLayout(new MigLayout());

        firstPanel.add(dimOfBox = new JLabel("Dimensions of box (m): "));
        firstPanel.setBorder(BorderFactory.createLineBorder(Color.BLACK));
        contentPane.add(firstPanel,"wrap");

        secondPanel.add(rein = new JLabel("Reinforcement: "));
        secondPanel.setBorder(BorderFactory.createLineBorder(Color.BLACK));
        contentPane.add(secondPanel,"wrap");

        thirdPanel.add(dimOfBox = new JLabel("Sealable top: "));
        thirdPanel.setBorder(BorderFactory.createLineBorder(Color.BLACK));
        contentPane.add(thirdPanel,"wrap");
        add(contentPane);
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                PanelAlignment pa = new PanelAlignment();
                pa.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);
                pa.pack();
                pa.setVisible(true);
            }
        });
    }

} 
```

你会得到这样的东西：

![在此处输入图像描述](../Images/e0ea77ca1697a533a7b1e5481ddafb39.png)

[我最近在这里](https://stackoverflow.com/questions/13434888/new-line-between-swing-components/13436241#13436241)回答了类似的问题

祝你好运！:)

# graphics - 颜色混合 - 变暗模式

> ID：13445623
> 
> 赞同：2
> 
> 时间：2012-11-18T23:14:13.110
> 
> 标签：graphics, colors, blending

我正在尝试模拟 Adob​​e Photoshop 的混合模式 - 变暗。

我了解基本的 Darken 原则：Darken(a,b) = min(a,b)。例如：

```
Darken( (.2, .3, .8), (.5, .1, .4) ) = (.2, .1, .4)   // (r, g, b) 
```

但我有它的透明度。在 Photoshop 中，Darken 是这样工作的：

```
Darken( (0, 1, 0, .5), (0, 0, 0, .5) ) = (0, .3, 0, .75)   // (r, g, b, a) 
```

在黑色上加深绿色是绿色。我明白了，输出 alpha 以经典方式计算：ao = aa + ab * (1-aa)。你知道其他值是如何计算的吗？

顺便提一句。变暗模式是可交换的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T17:06:28.037

所以最后我发现了。

在 Darken 模式下，合成与 Normal 模式下相同，但如果后通道较暗，则前后通道会翻转。

对于每个通道： **Darken(a, b) = a < b ? 范数（a，b）：范数（b，a）；**

所以在我的顶级示例中，对于绿色和 alpha：

```
Darken( (1, .5), (0, .5) ) =  Norm( (0, .5), (1, .5) ) 
alpha = (.5 + .5*(1-.5)) = .75
green = (0*.5 + 1*.5*(1-.5)) / .75 = (0 + .25) / .75 = 0.333333 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T23:20:25.620

好吧，实际上，它涉及的更多一些。这里还有其他类似的问题，可以回答这个问题。最好使用的可能是恰当命名的：

[RGB 值的加色混合算法](https://stackoverflow.com/questions/726549/algorithm-for-additive-color-mixing-for-rgb-values)

# php - 如何反转 simplexmlelement 列表的顺序？

> ID：13445624
> 
> 赞同：0
> 
> 时间：2012-11-18T23:14:16.560
> 
> 标签：php, xml

我有一个这样的 simplexml 对象

```
<aaaa>
    <bbbb>0000</bbbb>
    <cccc>0000</cccc>
    <dddd>
        <eeee>
          <gggg>1111</gggg>
          <hhhh>2222</hhhh>
          <mmmm>3333</mmmm>
        </eeee>
        <eeee>
          <gggg>4444</gggg>
          <hhhh>5555</hhhh>
          <mmmm>6666</mmmm>
        </eeee>
        <eeee>
          <gggg>7777</gggg>
          <hhhh>8888</hhhh>
          <mmmm>9999</mmmm>
        </eeee>
    </dddd>
</aaaa> 
```

我怎样才能获得如下的新结构？（新元素 ffff 包含以相反顺序排列的 dddd 的相同子级列表）

```
<aaaa>
    <bbbb>0000</bbbb>
    <cccc>0000</cccc>
    <dddd>
        <eeee>
          <gggg>1111</gggg>
          <hhhh>2222</hhhh>
          <mmmm>3333</mmmm>
        </eeee>
        <eeee>
          <gggg>4444</gggg>
          <hhhh>5555</hhhh>
          <mmmm>6666</mmmm>
        </eeee>
        <eeee>
          <gggg>7777</gggg>
          <hhhh>8888</hhhh>
          <mmmm>9999</mmmm>
        </eeee>
    </dddd>
    <ffff>
        <eeee>
          <gggg>7777</gggg>
          <hhhh>8888</hhhh>
          <mmmm>9999</mmmm>
        </eeee>
        <eeee>
          <gggg>4444</gggg>
          <hhhh>5555</hhhh>
          <mmmm>6666</mmmm>
        </eeee>
        <eeee>
          <gggg>1111</gggg>
          <hhhh>2222</hhhh>
          <mmmm>3333</mmmm>
        </eeee>
    </ffff>
</aaaa> 
```

我试图迭代 dddd 的子级并将它们插入到要使用 array_reverse 反转的对象数组中......但是当我尝试将对象插入回主结构中时，结果被破坏/不完整

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T23:27:41.623

您可以遍历这些子元素并将它们`<ffff>`以正确的顺序插入到新元素中。

这很容易通过将您现有的`SimpleXMLElement`使用与[**DOM 扩展**](http://php.net/dom)提供的额外功能混合在一起来完成。不需要中间数组或对它们进行排序。

```
$aaaa = simplexml_load_string($xml_string);

// Add new <ffff> element
$ffff = $aaaa->addChild('ffff');

// Get DOMElement instance for <ffff>
$ffff_dom = dom_import_simplexml($ffff);

// Loop over <dddd> children and prepend to <ffff>
foreach ($aaaa->dddd->children() as $child) {
    $child_copy = dom_import_simplexml($child)->cloneNode(TRUE);
    $ffff_dom->insertBefore($child_copy, $ffff_dom->firstChild);
}

// Go back to SimpleXML-land and see the result
echo $aaaa->saveXML(); 
```

（[见这个在线运行的例子。](http://codepad.viper-7.com/ra8cYR)）

# python - 是否可以在不创建本地端口的情况下在 Ruby 或 Python 中创建 SSH 隧道？

> ID：13445625
> 
> 赞同：3
> 
> 时间：2012-11-18T23:14:23.227
> 
> 标签：python, ruby, ssh-tunnel

我想创建一个 SSH 隧道以用于与远程旧应用程序安全地通信，但我不希望其他本地应用程序能够使用它。这对于 Python 和/或 Ruby 是否可行，也许使用可以像普通套接字句柄一样写入和读取的隧道的内存句柄？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T09:23:15.060

最新版本的 OpenSSH 支持`-W`将 stdio 连接到远程 tcp 端口的标志：

```
ssh ssh_host -W host:port 
```

我不知道是用 Python 还是 Ruby，但在 Perl 中，您可以轻松地将这个功能与[Net::OpenSSH](https://www.metacpan.org/module/Net%3a%3aOpenSSH)一起使用。例如：

```
use Net::OpenSSH;
my $ssh = Net::OpenSSH->new($host);
my $out = $ssh->capture({tunnel => 1,
                         stdin_data => "GET / HTTP/1.0\n\n" },
                        'www.google.com', 80);

print $out; 
```

# jquery - ajax 请求行为奇怪

> ID：13445631
> 
> 赞同：1
> 
> 时间：2012-11-18T23:15:26.523
> 
> 标签：jquery, ajax

我很难将变量与 ajax 请求一起发送。这是我的 html/js 代码：

```
 <input id="login-username" class="input" type="text" placeholder="Username"/>

<input id="login-password" class="input" type="password" placeholder="Password"/>

<a href="javascript:void(0);" id="submit-login" class="btn btn-small btn-info"><strong>sign in</strong></a>

$("#submit-login").click(function(e){
    e.preventDefault();
    var usernameReg = /^[a-zA-Z0-9]+$/;
    var username = $("#login-username").val();
    var password = $("#login-password").val();
    alert(username);
    alert(password);
    if(!usernameReg.test(username)){
        $("#input-login-username").html("some html");
        return false;
    } else if(!usernameReg.test(password)){
        $("#input-login-password").html("some html");
        return false;
    } else if((username == "") || (password = "")){
        $("#input-login-username").html("<strong><small>Empty field(s)</small></strong>");
        return false;
    } else {
        $.ajax({
            type: 'POST',
            url: '?a=validate',
            data: {
                "password" : password,
                "username" : username
            },
            success: function(data){
                some statements
            }
        });
    }
}); 
```

![在此处输入图像描述](../Images/c0a632ddb0f22c1a7a6f2add91086639.png)

![在此处输入图像描述](../Images/62b2bc45227f84e419c6b95d9be038d8.png)

接收到密码元素的值，如第一张图像中所示。使用 ajax 发送的对象文字中没有拼写错误。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T23:18:12.627

`=`≠ `==`:

```
} else if((username == "") || (password = "")){ 
```

# msmq - 使用 NServiceBus 处理消息时 MSMQ 消耗大量内存

> ID：13445632
> 
> 赞同：5
> 
> 时间：2012-11-18T23:15:31.057
> 
> 标签：msmq, nservicebus3

我有两个使用 NserviceBus 的 Windows 服务。一个将消息写入队列，另一个从队列中读取并进行一些处理。所有队列都是事务性的，NserviceBus 端点配置如下。

```
.IsTransactional(true)
.IsolationLevel(IsolationLevel.ReadCommitted)
.MsmqTransport()
.RunTimeoutManager()
.UseInMemoryTimeoutPersister()
.MsmqSubscriptionStorage()
.DisableRavenInstall()
.JsonSerializer() 
```

问题是当大量消息 (170,000+) 排队时，MSMQ 服务 (mqsvc.exe) 会占用相当多的内存 (1.5 - 2.0 GB)，并且至少 5 - 6 内存没有被释放小时。平均消息大小约为 5 - 10 KB。似乎您排队的消息越多，它使用的内存就越多。基于 NServiceBus 的 Windows 服务内存消耗在完全可以接受的范围内 (50 - 100 MB)，并且无论它们处理多少消息都不会增加。

关于为什么 MSMQ 会使用这么多内存并且需要很长时间才能释放它的任何想法？多谢了。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-20T00:00:20.523

这是完全正常的。MSMQ 使用 4MB 内存块中的存储，这些内存块映射到 Storage 文件夹中的文件。170,000 条 5-10kb 的消息是 0.85-1.7GB，因此您看到分配了如此多的虚拟内存也就不足为奇了。为了减少在消息被删除或到达时删除和创建文件的开销，存储文件将保留 6 小时。在此期间之后，将删除空文件。您可以配置它，如我的博客文章中所述：

[强制 MSMQ 清理其存储文件](https://docs.microsoft.com/en-us/archive/blogs/johnbreakwell/forcing-msmq-to-clean-up-its-storage-files)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-16T15:02:17.417

很有可能它会帮助任何人——msmq 传奇人物 John Breakwell 在谷歌群组上的这篇文章记录了如何真正彻底清理存储中的所有消息，这有时是可取/必要的

[https://groups.google.com/d/msg/microsoft.public.msmq.performance/jByfXUwXFw8/i1hVP1WJpJgJ](https://groups.google.com/d/msg/microsoft.public.msmq.performance/jByfXUwXFw8/i1hVP1WJpJgJ)

我有 8GB 的​​文件，但在任何队列中都没有消息，而且 msmq 服务大约需要 2 个小时才能进入启动状态。清除任何队列将花费 10 分钟并导致大量内存峰值，然后几天都没有释放，如果有的话。

如果您遇到这种情况，您可以按照以下步骤操作，而不是重新安装消息队列：

1.  停止消息队列服务
2.  转到 MSMQ 存储位置（通常是 C:\Windows\System32\msmq\storage）
3.  仅删除 P*.MQ、J*.MQ、R*.MQ 和 L*.MQ 文件

# java - 用卡尺强制固定列顺序

> ID：13445638
> 
> 赞同：1
> 
> 时间：2012-11-18T23:16:41.693
> 
> 标签：java, benchmarking, caliper

我正在使用多种方法和两个参数运行[卡尺](http://code.google.com/p/caliper)基准测试，最后得到一个不错的表格，例如`time*`

```
parameter1 parameter2 benchmark 
```

在对方法体进行小改动后，我得到了另一个不错的表格，例如

```
parameter2 benchmark parameter1 
```

这使我的[emacs](http://www.gnu.org/software/emacs/manual/html_node/emacs/Rectangles.html)技能保持更新，但我更愿意获得固定的列顺序。可能吗？

* * *

一个附带问题：订单是如何实际确定的？恕我直言，最好使用声明，因为这允许通过简单的代码更改来获得所需的顺序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T15:31:22.360

您关心列排序的事实表明您正在使用它来解释给定运行的结果。这通常是不鼓励的。

对于每次运行，都会进行几次测量（它们本身就是每次代表的平均运行时间），但只报告测量的平均值。它不会告诉您数据的分布、异常值的存在等。在当前版本的 Caliper webapp 中，条形末尾的箱线图有助于显示一些此类信息，并且在即将发布的完整版本中将提供汇总统计数据。

# html - 两个相邻的 div，全宽

> ID：13445640
> 
> 赞同：3
> 
> 时间：2012-11-18T23:16:51.560
> 
> 标签：html, css

我想做以下事情：

A 列，与最大列表项一样宽 | B列，与左边一样宽，重叠时有水平滚动框。

宽度：自动 | 宽度：100%；

```
list1   | adklajd lkasjdlk ajs kldajlkjd kalsd 
list222 | sdfsf
list33  | sdfsdffds
        | xxx 
```

这该怎么做？它甚至不容易。

编辑： http: [//jsfiddle.net/Y3p9F/](http://jsfiddle.net/Y3p9F/) 和 B 列换行，我不想要它

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-18T23:26:21.323

您可以使用`float`和的组合`margin`来实现此目的：

```
<div id="colA">
    <!-- completely irrelevant mark-up -->
</div>
<div id="colB">
    <p><!-- Completely irrelevant text... --></p>
</div>​ 
```

和CSS：

```
div {
    padding: 0.2em 0.5em;
}
#colA {
    float: left;
    margin-bottom: 100%; /* to prevent the #colB text wrapping beneath #colA */
}

#colB {
    clear: right;
} 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/7nyY7/)。

（仅在 Chromium 22/Ubuntu 12.10 中测试。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-18T23:31:01.607

唔

两个部分

1.  HTML
2.  文件的 CSS

HTML

```
<html>
 <div id='col1'> </div>
 <div id='col2'> </div>
</html> 
```

CSS

```
#col1 {
 float: left;
 width: auto;
}
#col2 {
 float: left;
 clear: right;
 width: 100%;
} 
```

**解释** Float 基本上将 div 对齐到视口（或屏幕）的左侧，并清除从第二列右侧删除任何浮动项目。

这与设置为 100% 相结合可确保您的两个 div 彼此相邻，并且第一个仅与需要的一样宽，第二个填充第一列右侧的其余空间.

# php - 在方法/函数中需要 2 个参数中的 1 个（两个参数之一可选）

> ID：13445641
> 
> 赞同：1
> 
> 时间：2012-11-18T23:16:54.093
> 
> 标签：php, methods, arguments

我有一个正在调用的方法/函数（在一个类中），我想传递 id 或 url。然后该方法在 mysql WHERE 查询中使用这些参数之一。它只能使用其中一种。

我怎样才能要求两个参数之一？或者换句话说，我怎样才能只将两个参数之一设为可选？

有没有比只使两个参数可选并使用多个 if else 语句更好的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T01:17:32.487

最后，我使用了一个非常简单的方法，该方法不会导致代码重复，并且实际上如果需要，将来可以在不更改方法的情况下传递更多参数。

```
public function getMovie($argType, $arg) {
    $movieQuery =  "SELECT 
        id, rt_id, imdb_id, url, rt_url, type, adult, 
        DATE_FORMAT(release_date, '%Y') AS year, date_added,
        title, runtime, budget, revenue, homepage, rating,
        tagline, overview, popularity, image, backdrop, trailer
        FROM movies
        WHERE " . $argType . " =  ?";

    $movieResult = $this->_query($movieQuery, $arg);
    $movies      = array();

    if ($movieResult->fetch_array(MYSQLI_ASSOC)) {
        while ($m = $movieResult->fetch_array(MYSQLI_ASSOC)) {
            $movies[] = array(
                'title'        => $m['title'],
                'duplicate'    => $m['duplicate'],
                'url'          => $m['url'],
                'rt_url'       => $m['rt_url'],
                'release_date' => $m['release_date'],
                'date_added'   => $m['date_added'],
                'type'         => 'movie',
                'adult'        => $m['adult'],
                'id'           => $id,
                'rt_id'        => $m['rt_id'],
                'imdb_id'      => $m['imdb_id'],
                'rating'       => $m['rating'],
                'tagline'      => $m['tagline'],
                'overview'     => $m['overview'],
                'popularity'   => $m['popularity'],
                'runtime'      => $m['runtime'],
                'budget'       => $m['budget'],
                'revenue'      => $m['revenue'],
                'homepage'     => $m['homepage'],
                'image'        => $m['image'],
                'backdrop'     => $m['backdrop'],
                'trailer'      => $m['trailer'] 
            );
        }
        return $movies;
    } else {
        return false;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T23:19:51.270

如果你想从字面上*要求*一个论点：

```
public function fetchRow($where)
{
    if (empty($where['id']) && empty($where['url'])) {
        throw new Exception('WHERE clause must be supplied');
    }

    // proxy to specific method
    if (!empty($where['id'])) {
        return $this->fetchById((int) $where['id']);
    } elseif (!empty($url)) {
        return $this->fetchByUrl((string) $where['url']);
    }
}

public function fetchById($id) 
{
    if ($stmt = $mysqli->prepare('SELECT * FROM table WHERE id = ?')) {
        $stmt->bind_param('i', $id);
        // ...
    }
}

// ...
$object = new MyClass();
try {
    $object->fetchRow(); // would throw exception
    $object->fetchRow(array('id' => 10)); // would work
} catch (Exception $ex) {
    // do something, for example:
    echo $ex->getMessage(); // echoes 'at least one argument must be supplied'
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-18T23:24:21.697

如果它只能使用一个或另一个，那么你有状态。如果您有状态，则需要多态性，或者在这个非常小的用例中，需要两种不同的方法。

```
public function getById($id) {}
public function getByUrl($url) {} 
```

这就是它的结束。这是你能为自己做的最好的事情。

**当且仅当**您事先不知道传入的是哪个（如用户输入的情况），您可以使用*第三种*方法来解析和验证输入字符串，确定它是哪种类型，然后调用适当的方法。

# jquery-mobile - MVC4 jQueryMobile 不会显示自定义错误页面 OnException

> ID：13445643
> 
> 赞同：0
> 
> 时间：2012-11-18T23:17:02.383
> 
> 标签：jquery-mobile, asp.net-mvc-4

我正在尝试从 MVC4 移动应用程序显示自定义错误页面，但只显示“错误加载页面”黄色消息而不是我的自定义页面。

我已尝试在操作和控制器上使用如下**HandleErrorAttribute ，但没有成功**

```
[HandleError(ExceptionType = typeof(SqlException), View = "DatabaseError")] 
```

我也尝试过覆盖我的基本控制器的 OnException 方法，但这似乎也没有任何效果。

```
 protected override void OnException(ExceptionContext filterContext)
        {
            if (filterContext == null)
                base.OnException(filterContext);

            Logger.LogException(filterContext.Exception);

            if (filterContext.Exception is SqlException)
                {
                filterContext.Result = new ViewResult { ViewName = "DatabaseError" };
                }

            if (filterContext.Exception is SomeOtherException)
                {
                filterContext.Result = new ViewResult { ViewName = "Error" };
                }

            if (filterContext.HttpContext.IsCustomErrorEnabled)
                {
                filterContext.ExceptionHandled = true;
                filterContext.Result.ExecuteResult(this.ControllerContext);
                }
        } 
```

如果我在非 jQueryMobile MVC4 应用程序上尝试这些方法，它们会按预期工作，只是不在我的移动应用程序中！

任何人都对为什么以及如何使这项工作有任何见解？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T19:32:05.050

好的，通过禁用 Ajax，现在会显示相应的错误页面！

在我的 _layout.cshtml 页面中，我添加了以下 javascript：

```
 $.mobile.ajaxEnabled = false; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-04T21:37:15.937

`JsonResult`如果请求是通过 AJAX 并返回 a而不是 a ，您可能需要检查您的过滤器`ViewResult`，例如：

```
public class TypeSwitchingHandleErrorAttribute : HandleErrorAttribute
{
    private static readonly string[] AJAX_ACCEPT_TYPES = new[] { "application/json", "application/javascript", "application/xml" };

    private bool IsAjax(ExceptionContext filterContext)
    {
        return filterContext.HttpContext.Request.Headers["X-Requested-With"] == "XMLHttpRequest"
            ||
            filterContext.HttpContext.Request.AcceptTypes.ContainsAny(AJAX_ACCEPT_TYPES);
    }

    private void setResult(ExceptionContext filterContext, object content)
    {
        if( IsAjax(filterContext) )
        {
            filterContext.Result = new JsonResult { Data = content, JsonRequestBehavior = JsonRequestBehavior.AllowGet };
        } else
        {
            filterContext.Result = new ViewResult { ViewName = (string)content };
        }
    }

    public override void OnException(ExceptionContext filterContext)
    {
        // your code...then where you set the result...
        setResult(filterContext, "DatabaseError etc");
    }
} 
```

然后，您必须在客户端适当地解释 ajax 响应。如果是 ajax 请求，您还可以发送不同的内容，例如标准`{success: t/f, message: Exception.Message }`对象，并适当地设置响应状态代码。

# zip - 使用 7z 压缩目录中的所有内容，除了一个文件或一种文件类型

> ID：13445648
> 
> 赞同：15
> 
> 时间：2012-11-18T23:17:18.820
> 
> 标签：zip, cmd, 7zip

我想压缩除一个文件以外的所有内容

```
7z a -tzip files.zip * 
```

这将压缩我当前目录中的所有文件..有没有办法告诉它不要压缩一个文件或一种文件类型？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-11-19T23:39:04.440

根据 7za 命令行帮助，您可以使用 -x 开关来执行此操作：

```
-x[r[-|0]]]{@listfile|!wildcard}: eXclude filenames 
```

要排除文件 foo.txt，您将添加：

```
-x!foo.txt 
```

要排除所有 .html 文件 (*.html)，您需要添加：

```
-x!*.html 
```

您可以添加多个 -x 条目以在一个 zip 命令中排除多个文件名和/或通配符。添加以下内容将排除 foo.txt 和 *.html：

```
-x!foo.txt -x!*.html 
```

因此，对于您的示例，这会将所有文件添加到 files.zip 中，但名为“FILENAME”或与 *.extension 通配符匹配的文件除外：

```
7za a -tzip files.zip * -x!FILENAME -x!*.extension 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2017-03-14T15:45:26.013

如果您使用的是批处理脚本，请不要忘记转义！标记。

```
7z a -xr^^!*.xml "dest_dir.zip" "Source_dir" 
```

我花了很长时间才知道:)

谢谢你。

# python - 当网站以某种方式发生变化时，如何编写程序来通知我？

> ID：13445650
> 
> 赞同：-3
> 
> 时间：2012-11-18T23:17:26.440
> 
> 标签：python, webserver

我正在寻找朝着正确方向迈出的一步——也许我需要哪些语言，或者其他任何东西。

我想知道如何编写脚本来监视网站并通知我（可能通过电子邮件）该网站何时进行特定更改。例如，我想要的具体更改是当网站发布带有某个关键字的职位时。

因此，我希望在网站发布带有特定关键字（例如“实习生”）的工作时向我发送一封电子邮件。即，我对我可以使用什么语言来制作一个可以为我访问网站的爬虫感兴趣，并在找到一些东西后做其他事情。什么语言/工具最好？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T23:19:38.247

Python 是一个不错的选择。如果我是你，我会研究[urllib2](http://docs.python.org/2/library/urllib2.html)、 BeautifulSoup4 和[smtplib](http://docs.python.org/2/library/smtplib.html)。这些，也许结合一些正则表达式应该是你完成项目所需要的。

# svg - 如何在 d3.svg.arc() 中设置大弧或扫标志

> ID：13445652
> 
> 赞同：2
> 
> 时间：2012-11-18T23:18:00.923
> 
> 标签：svg, d3.js

我正在使用 d3 绘制圆弧。这适用于绘制从 10 度到 20 度甚至 300-350 度开始的零件，但是：

有时我需要绘制从 350 度到 5 度的圆弧，所以用 15 度的圆弧代替从 5 一直延伸到 350 的圆弧。有没有办法指定大圆弧标志或扫掠标志时使用 d3.svg.arc()？（注意，交换开始和结束对 d3.svg.arc() 没有影响

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T10:45:17.610

我是 d3 的新手，所以也许有更简单的方法。

您可以将角度定义为 0 -> 扫掠，然后逆时针旋转。因此，对于您的 350 到 5：

```
var arc = d3.svg.arc()
    .innerRadius(50)
    .outerRadius(70)
    .startAngle(0)
    .endAngle(15 * (Math.PI/180));

svg.append("path")
    .attr("d", arc)
    .attr("transform", "rotate(-10)"); 
```

这是一个[jsFiddle](http://jsfiddle.net/jobigoud/ecdWq/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T22:36:20.790

虽然 d3 是低级别的，`d3.svg.arc`但您不必是*那么*低级别；想想你想画的角度范围，并把它表达为一个开始和结束的数字，你可以在没有间断的情况下交叉（0° -> 360° 是典型的间断）。您可以同时使用正角和负角，因此将 -10° 用于 350° 会产生连续范围 [5…-10] ( [jsfiddle](http://jsfiddle.net/ecmanaut/hswcx/) )：

```
var svg = d3.select("body").append("svg")
  , r2d = Math.PI / 180
  , arc = d3.svg.arc()
    .innerRadius(50)
    .outerRadius(70)
    .startAngle(5 * r2d)
    .endAngle(-10 * r2d);

svg.append("g")
    .attr("d", arc)
    .attr("transform", "translate(200,200)"); 
```

# css - HTML5中具有相对大小的表格列

> ID：13445653
> 
> 赞同：8
> 
> 时间：2012-11-18T23:18:09.380
> 
> 标签：css, html, html-table

我有一张有四列的表。第一列需要是适合内容的最小大小，其他三列需要大小相等并占用表格中的其余空间。我的表格和内容都不是已知大小。（这是一个非常标准的可变大小标签和固定大小数据布局。）

在 HTML4 的过去，我可以通过使用“相对大小”功能将每列的大小指定为整体的比例来做到这一点：

```
<colgroup>
  <col width="0*"/>
  <col width="1*"/>
  <col width="1*"/>
  <col width="1*"/>
</colgroup> 
```

但是，现在不推荐使用 width 属性，我们应该改用 CSS。但我还没有找到任何用 CSS 复制它的方法；CSS 大小说明符只允许我将宽度指定为固定大小或整体的一小部分，我真正需要的是第一列被取走后剩下的一小部分。

有没有办法使用现代技术来做到这一点？（请注意，我不能使用 CSS3。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T10:41:16.720

我会使用一点 JavaScript 来解决您的问题：http: [//jsfiddle.net/qR9g2/](http://jsfiddle.net/qR9g2/)

```
var tableSize = 400; // example of size
var firstCol = document.getElementById('firstCol_01');
var sizeOfFirstCol = firstCol.offsetWidth;
var myOtherCols = document.getElementsByTagName('td');
var nbcols = myOtherCols.length;
var sizeOtherCols = (tableSize-sizeOfFirstCol)/(nbcols-1);
for(var i=0;i<nbcols; i++)
{
    if(myOtherCols[i].className === 'otherCols')
    {
        myOtherCols[i].style.width = sizeOtherCols+'px';
    }
} 
```

首先给出整体表的大小。然后去获取第一列的大小，并将其余的宽度分配给其他列。

编辑：这是一个 CSS 解决方案。它并不完美，但总比没有好：http: [//jsfiddle.net/qR9g2/2/](http://jsfiddle.net/qR9g2/2/)

在css中，主要思想如下：

```
.col1{
    display:table;
    float:right;
} 
```

为第一列添加标签`display:table`。这将像`fit-content`所有浏览器一样工作。添加 a`float:right`会将第一列推到右侧并将其“粘贴”到表格的其余部分。

视觉效果正是您想要的。不利的一面是，问题在于您的桌子比看起来（在左侧）占据的位置更多。（基本上，如果您有一个 400px 的表格，它有 4 列，它会自动为每列提供 4*100px。添加上部 CSS 解决方案只会将 col1 移动到为该列提供的 100px 的右侧）。

您总是可以尝试使用负左边距（我不推荐），以便将您的桌子移到左边。

# javascript - 在点击时添加一个 html 元素

> ID：13445655
> 
> 赞同：2
> 
> 时间：2012-11-18T23:18:21.510
> 
> 标签：javascript, jquery

我有一个非常简单的函数可以将输入“文本”的值呈现到 html 中。

```
<form>
    <input type="text" class='test'><input type='submit' value='send'>
</form>
<div class='test2'> </div>

<script>   
    $("form").submit(function() {
        var value = $('.test').val();
        $('.test2').html(value);
    });
</script> 
```

问题是每次我们按下“发送”，新值都会替换旧值。我想在不删除旧消息的情况下显示新消息。即，每次单击按钮发送时，我都想添加一个“DIV”或“P”。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-18T23:21:02.780

像这样试试

```
$("form").submit(function() {
    var value = $('.test').val();
    $('.test2').append('<p>' + value + '</p>');
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T23:32:12.637

## *[jsBin 演示](http://jsbin.com/azulux/4/edit)*

```
$("form").submit(function(e) { 
  e.preventDefault();
  $('<div>',{ text: $('.test').val() }).appendTo('.test2');
  $('form').get(0).reset();
}); 
```

# python - ObjectListView 不显示零

> ID：13445657
> 
> 赞同：0
> 
> 时间：2012-11-18T23:18:35.730
> 
> 标签：python, wxpython, integer, objectlistview

我正在使用 ObjectListView 1.2 (Python)，并且对奇怪的行为感到非常困惑。我有一个具有双字段的对象。如果该值非零（无论是 int 还是 double），OLV 将显示该值，但只要该值为零，它就不会在该列中显示该对象的任何内容。

SSCCE：

```
# -*- coding: utf-8 -*-
#!/usr/bin/env python

import wx

from ObjectListView import ObjectListView, ColumnDefn

class MyObj:
    def __init__(self, name, id):
        self.name = name
        self.id = id

    @staticmethod
    def getObjects():
        objList = []
        for i in range(0,5):
            objList.append(MyObj("item" + str(i), i))
        return objList

class MyFrame(wx.Frame):
    def __init__(self, *args, **kwds):
        wx.Frame.__init__(self, *args, **kwds)
        self.Init()

    def Init(self):
        self.InitModel()
        self.InitWidgets()
        self.InitObjectListView()

    def InitModel(self):
        self.songs = MyObj.getObjects()

    def InitWidgets(self):
        panel = wx.Panel(self, -1)
        sizer_1 = wx.BoxSizer(wx.VERTICAL)
        sizer_1.Add(panel, 1, wx.ALL|wx.EXPAND)
        self.SetSizer(sizer_1)

        self.myOlv = ObjectListView(panel, -1, style=wx.LC_REPORT|wx.SUNKEN_BORDER)
        sizer_2 = wx.BoxSizer(wx.VERTICAL)
        sizer_2.Add(self.myOlv, 1, wx.ALL|wx.EXPAND, 4)
        panel.SetSizer(sizer_2)

        self.Layout()

    def InitObjectListView(self):
        self.myOlv.SetColumns([
            ColumnDefn("Title", "left", 120, "name"),
            ColumnDefn("ID", "left", 120, "id")
        ])
        self.myOlv.SetObjects(self.songs)

if __name__ == '__main__':
    app = wx.PySimpleApp(1)
    wx.InitAllImageHandlers()
    frame_1 = MyFrame(None, -1, "ObjectListView Simple Example1")
    app.SetTopWindow(frame_1)
    frame_1.Show()
    app.MainLoop() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-11-18T17:08:51.140

正如 Blckknght 的回答所提到的，当您没有设置 stringConverter 时会发生这种情况。

我没有编辑库，而是`stringConverter="%.0f"`在我将列出整数的任何列的末尾使用。

例子：

```
self.myOlv.SetColumns([
  ColumnDefn("Title", "left", 120, "name"),
  ColumnDefn("ID", "left", 120, "id", stringConverter="%.0f")
]) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-19T01:26:22.617

这似乎是`ObjectListView`. 每当您使用 no 设置列时`stringConverter`，它将忽略所有“错误”值（包括零）。代码中的注释表明它应该是 ignoring `None`，但它也会捕获所有其他错误值。

我通常会建议在上游报告此错误，但鉴于该项目似乎在近四年内没有更新，我不确定这是否会很有成效。

相反，您可以通过编辑`ObjectListView.py`. 相关方法在`ColumnDefn`类中：

```
def _StringToValue(self, value, converter):
    """
    Convert the given value to a string, using the given converter
    """
    try:
        return converter(value)
    except TypeError:
        pass

    if converter and isinstance(value, (datetime.datetime, datetime.date, datetime.time)):
        return value.strftime(self.stringConverter)

    # By default, None is changed to an empty string.
    if not converter and not value:                # THE ERROR IS HERE!!!!
        return ""

    fmt = converter or "%s"
    try:
        return fmt % value
    except UnicodeError:
        return unicode(fmt) % value 
```

解决方法是将指示的行更改为：

```
if not converter and value is None: 
```

# html - 随机边框颜色 CSS

> ID：13445658
> 
> 赞同：3
> 
> 时间：2012-11-18T23:18:48.363
> 
> 标签：html, css, random, html-lists, border-color

我的页面上有 5 个列表项，应用了以下 CSS：

```
#content .gallery_work ul li {
    background-color: #FEF5D6 !important;
    border-right: 15px solid blue;
    color: #373C46;
    float: left;
    font-size: 13px;
    height: 250px !important;
    margin: 10px !important;
    text-align: center;
    width: 225px !important;
} 
```

我想要的是 5 种可能的边框颜色，并为每个 li 随机应用一种颜色。

有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-18T23:25:34.907

只需在 JavaScript 或您选择的服务器端语言中生成一个数字。

你可以用JavaScript来做......

```
var color = "#" + Math.floor(Math.random() * 0xFFFFFF).toString(16); 
```

...或 PHP ...

```
$color = "#" . dechex(rand(0, 0xFFFFFF)); 
```

你的评论...

> 有没有一种方法可以声明一个数字，然后让它从它们中随机选择，而不是使用完全随机的颜色？

是的，例如...

```
$colors = array("#000", "#fff");

$randomColor = $colors[array_rand($colors)]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T00:06:51.933

涵盖所有边缘情况的解决方案，如添加适当的零填充：

```
function randomColor() {
    return (function(h) {
         return '#000000'.substr(0, 7 - h.length) + h;
    })((~~(Math.random() * (1 << 24))).toString(16));
} 
```

最初由雷米夏普： http: [//paulirish.com/2009/random-hex-color-code-snippets/#comment-34878](http://paulirish.com/2009/random-hex-color-code-snippets/#comment-34878)

# download - 如何控制 OSMDroid 中每个缩放级别的下载地图区域的大小？

> ID：13445661
> 
> 赞同：0
> 
> 时间：2012-11-18T23:19:28.307
> 
> 标签：download, maps, size, offline, osmdroid

我在我的 Android 应用程序上使用从 OpenStreetMaps 下载的离线地图。

当我移动地图时，一些图块没有出现。

我想选择 n 公里乘 m 公里的区域或其他区域。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-20T09:11:50.487

您目前只是在 osmdroid 的缓存中获取磁贴。它在下载时自动缓存切片。如果不首先尝试在启用在线的情况下显示它们，就没有简单的方法将切片放入缓存中。

如果您真的需要离线支持，您必须准备一个包含所需磁贴的文件并将其放入 sdcard/osmdroid/ 目录。创建文件的最简单方法是使用[Mobile Atlas Creator](http://mobac.sourceforge.net/)之类的工具， 我会推荐 GEMF 格式而不是 .zip，它的工作原理要好得多，过程相同，只需复制文件并自动找到它。

# html - 将 HTML/RTF 字符串写入 RTF 文件

> ID：13445664
> 
> 赞同：1
> 
> 时间：2012-11-18T23:19:43.083
> 
> 标签：html, rtf, text-parsing, file-conversion

有人知道如何将一些格式化的文本字符串插入到一些 RTF 文件中吗？我可以将任何纯文本插入到 RTF 文件中（插入到我想要的文档中的任何位置），但不能插入格式化的字符串。

我知道当这样的字符串添加到 RTF 文件时，还必须更新一些 RTF 标题。这是一个问题。我需要找出应该放在 RTF 标题中的内容以及确切的位置。也许有一些现成的解决方案。到目前为止，我无法在任何地方找到它。通常我使用Java，但这个问题与任何语言都无关。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-27T21:11:57.957

[他们在.rtf 规范](http://www.biblioscape.com/rtf15_spec.htm#Heading6)中谈论使用有效的标题。我希望这将帮助您获得有效的格式结果。

.rtf 文件中的纯文本，没有任何有效的“格式化语法”，除了给定的纯文本外，不会返回任何其他结果。

另一种方法是使用 .rtf 编辑器或某些 .rtf 编译器来获得整洁的富文本格式文档，以用于您正在使用的编程语言。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-13T01:36:40.003

您可以使用 Text 属性，而不是处理 rtf 属性。将光标设置到要插入文本的位置。然后从另一个富文本框中粘贴格式化文本，或粘贴普通文本并更改其格式。

# formatting - 在文本框中格式化数字输出

> ID：13445679
> 
> 赞同：-1
> 
> 时间：2012-11-18T23:21:41.847
> 
> 标签：formatting, vb.net-2010

嘿伙计们，我正在对文本框的输出进行格式化，该命令是否 `variable = variable(format("""###########,"""))` 只接受数字，还是字母也可以工作？任何帮助将不胜感激，并提前感谢所有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T23:07:17.013

是的，该格式仅适用于数字，请使用代码 `variable_array = Split(variable, vbCrLf) For i As Integer = 0 To variable_array.Length - 1' loop through the array "variable_array" and do something with each array member variableformatted = variableformatted & """" & name_array(i) & """," & vbCrLf Next`

# javascript - 你可以在没有 eval 的情况下拦截闭包中的局部变量吗？

> ID：13445680
> 
> 赞同：2
> 
> 时间：2012-11-18T23:21:42.767
> 
> 标签：javascript

我正在编写一些 JavaScript 分析位，并且需要能够拦截闭包内的方法。

我设法让这个工作：

```
var t = (function() {

  var echo = function(v) { console.log("calling echo with " + v); }; 

  return {
    intercept: function(n, f) {
      var old = eval(n);
      var newFunction = (function(that, old){
        return f(that, old);
      })(this, old);
      eval(n + " = newFunction ");
    },
    getEchoFunction: function() { return echo; }
  };  
})(); 

var c = t.getEchoFunction();

c("hello");

t.intercept("echo", function(that,old){
  return function() {
    console.log("before echo");
    old.apply(that,arguments);
    console.log("after echo");
  };
});

c = t.getEchoFunction();

c("world"); 
```

输出是：

```
“用你好呼唤回声”
“回声前”
“与世界呼应”
“回声后”

```

所以，这个“拦截”API 让我可以拦截并重写隐藏在闭包中的函数声明。

然而，世界上有很多关于 eval 的抱怨。

有什么方法可以编写相同的 API 而无需`eval`在`intercept`函数中使用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T23:23:39.060

不，不幸的是，没有办法访问类似于`window[...]`工作方式的非全局范围。

但是，根据您需要做什么，使用对象而不是本机范围将是一个好主意。

# perl - 如何将数组更改为哈希表？

> ID：13445681
> 
> 赞同：2
> 
> 时间：2012-11-18T23:21:56.320
> 
> 标签：perl, hashmap

我正在尝试制作一个程序，在其中读取包含一堆文本的文件。然后我取出标点符号，然后读入一个包含停用词的文件。两者都被读入并放入数组中。我正在尝试将通用文本文件的数组放入哈希中。我不确定我做错了什么，但我正在努力。我想这样做，这样我就可以生成关于重复多少单词和不重复单词的统计信息，但我必须去掉停用词等。

无论如何，到目前为止，我已经发表了评论#WORKING ON MERGING ARRAY INTO HASH，这就是我正在工作的地方。我不认为我试图将数组放入哈希的方式是正确的，但我在网上查看了 %hash{array} = "value"; 不编译。所以不知道该怎么做。

谢谢，如果您有任何问题要问我，我会尽快回复。

```
#!/usr/bin/perl
use strict;
use warnings;

#Reading in the text file
my $file0="data.txt";
open(my $filehandle0,'<', $file0) || die "Could not open $file0\n";
my@words;
while (my $line = <$filehandle0>){
    chomp $line;
    my @word = split(/\s+/, $line); 
    push(@words, @word);
}
for (@words) {
    s/[\,|\.|\!|\?|\:|\;]//g;
}
my %words_count;  #The code I was told to add in this post. 
    $words_count{$_}++ for @words; 
```

接下来，我读入了另一个数组中的停用词。

```
#Reading in the stopwords file
my $file1 = "stoplist.txt"; 
open(my $filehandle1, '<',$file1) or die "Could not open $file1\n";
my @stopwords;
while(my $line = <$filehandle1>){
    chomp $line;
    my @linearray = split(" ", $line);
    push(@stopwords, @linearray);
}
for my $w (my @stopwords) {
    s/\b\Q$w\E\B//ig; 
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-18T23:50:53.463

Perl 中关于哈希的一些注释... 问题描述：

> 无论如何，到目前为止，我已经发表了评论#WORKING ON MERGING ARRAY INTO HASH，这就是我正在工作的地方。我不认为我试图将数组放入哈希的方式是正确的，但我在网上查看了 %hash{array} = "value"; 不编译。所以不知道该怎么做。

首先，问问自己*为什么*要“将数组放入散列”。数组表示值列表，而哈希表示一组键值对。所以你必须定义键和值应该是什么。不仅为我们，也为您。它通常有助于[解释甚至简单的事情以更好地理解](http://en.wikipedia.org/wiki/Rubber_duck_debugging)。

在这种情况下，您可能想要计算给定单词`$word`在`@words`数组中出现的频率。这可以通过遍历所有单词并`$count{$word}`每次增加一个来完成。这就是@raina77ow 在他的回答中所做的。这里重要的是，您正在访问*单个*`$`哈希值，这些值在 Perl中用标量符号表示。因此，如果您有一个名为 的散列，则可以将键的`%count`值增加`'foo'`

```
$count{foo}++; 
```

您在 ( ) 上方“在线查找”的结果`%hash{array} = "value"`没有意义。将值存储在哈希中的三种有效方法：

**通过将偶数大小的列表分配给整个哈希来**设置所有键值对：****

 **```
%count = (hello => 42, world => 17); 
```

**通过为定义的键分配单个值来为给定键设置单个**值（这是我们之前所做的）：

```
$count{hello} = 42; 
```

**使用所谓的**哈希切片****为给定的键列表设置值列表**：**

 **```
@count{qw(hello world)} = (42, 17); 
```

请注意此处使用`%`sigils：用于混合的键和值的哈希偶数列表，`$`用于单个（标量）值和`@`值列表。在您的示例中，您使用的是`%`，但在键大括号中定义一个数组`{...}`并分配一个标量值。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-18T23:25:34.003

好吧，如果您有一个数组中的单词列表`@words`，并且想要获得一个哈希，其中每个键都指向特定单词，并且每个值是该单词在源数组中出现的数量，那么它就像...

```
my %words_count;
$words_count{$_}++ for @words; 
```

换句话说（没有双关语），您迭代`@words`数组，对于每个成员将哈希的相应元素增加 1，`%words_count`或者，当该元素尚未定义时，本质上是使用值 1 创建它（所谓的[auto-vivification](http://www.effectiveperlprogramming.com/blog/1247)）。

作为旁注，`keys`在数组上调用函数几乎没有意义：在 5.12+ 中，它会为您提供所使用的*索引*列表，在此之前，会向您抛出语法错误。****

# css - CSS - 如何在滚动图像上制作固定背景图像？

> ID：13445685
> 
> 赞同：0
> 
> 时间：2012-11-18T23:22:32.323
> 
> 标签：css, html, background, background-image

我在顶部有一个带有图像的导航栏。理想情况下，此导航栏图像将位于背景图像的顶部，并在向下滚动时消失。使这成为可能的任何方式（2个背景图像1滚动另一个固定）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T23:34:12.223

HTML

```
<div id="scroll" class="nav">Scrolling</div>
<div id="fixed" class="nav">Fixed</div> 
```

CSS：

```
.nav {
    top: 0; 
      left: 0; 
      height: 100px; // position and size only example, adjust to your needs
      width: 100%;
}
#scroll { 
      position: absolute; 
      background: url(yourimage.png); 
      z-index:1;  
 }
#fixed { 
     position: fixed; 
     background: url(your2ndimage.png); 
     z-index:0; 
  } 
```

这将使#fixed 背景仅在窗口向下滚动后显示...

# c++ - 如何在 C++ 中生成随机数？

> ID：13445688
> 
> 赞同：216
> 
> 时间：2012-11-18T23:23:09.180
> 
> 标签：c++, random

我正在尝试用骰子制作游戏，并且我需要在其中包含随机数（以模拟骰子的侧面。我知道如何使其介于 1 和 6 之间）。使用

```
#include <cstdlib> 
#include <ctime> 
#include <iostream>

using namespace std;

int main() 
{ 
    srand((unsigned)time(0)); 
    int i;
    i = (rand()%6)+1; 
    cout << i << "\n"; 
} 
```

不能很好地工作，因为当我运行程序几次时，我得到的输出如下：

```
6
1
1
1
1
1
2
2
2
2
5
2 
```

所以我想要一个每次都会生成*不同随机数的命令，而不是连续 5 次相同的随机数。*有没有命令可以做到这一点？

* * *

## 回答 #1

> 赞同：271
> 
> 时间：2012-11-18T23:33:50.383

根据随机数生成器的不同，使用模数可能会在随机数中引入偏差。[有关更多信息，请参阅此问题。](https://stackoverflow.com/questions/7114043/random-number-generation-in-c11-how-to-generate-how-do-they-work)当然，完全有可能获得随机序列中的重复数字。

尝试一些 C++11 特性以获得更好的分布：

```
#include <random>
#include <iostream>

int main()
{
    std::random_device dev;
    std::mt19937 rng(dev());
    std::uniform_int_distribution<std::mt19937::result_type> dist6(1,6); // distribution in range [1, 6]

    std::cout << dist6(rng) << std::endl;
} 
```

[有关 C++11 随机数的更多信息，请参阅此问题/答案。](https://stackoverflow.com/questions/7114043/random-number-generation-in-c11-how-to-generate-how-do-they-work)以上不是唯一的方法，而是一种方法。

* * *

## 回答 #2

> 赞同：130
> 
> 时间：2012-11-19T00:09:42.257

您的测试应用程序最根本的问题是您调用`srand`一次，然后调用`rand`一次并退出。

函数的重点是用随机种子`srand`初始化**伪随机数序列。**

这意味着如果您将*相同的值*传递给`srand`两个不同的应用程序（具有相同的`srand`/`rand`实现），那么*您将在两个应用程序中获得完全相同的*值`rand()`序列。

但是，在您的示例应用程序中，伪随机序列仅包含一个元素 - 从种子生成的伪随机序列的第一个元素等于当前`1 sec`精度时间。你期望在输出上看到什么？

显然，当您碰巧在同一秒运行应用程序时-您使用相同的种子值-因此您的结果当然是相同的（正如 Martin York 在对该问题的评论中已经提到的那样）。

实际上，您应该调用`srand(seed)`一次，然后调用`rand()` **多次**并分析该序列-它应该看起来是随机的。

**修正 1 - 示例代码：**

好的我明白了。显然口头描述是不够的（可能是语言障碍之类的...... :)）。

`srand()/rand()/time()`基于问题中使用的相同函数的老式 C 代码示例：

```
#include <stdlib.h>
#include <time.h>
#include <stdio.h>

int main(void)
{
    unsigned long j;
    srand( (unsigned)time(NULL) );

    for( j = 0; j < 100500; ++j )
    {
        int n;

        /* skip rand() readings that would make n%6 non-uniformly distributed
          (assuming rand() itself is uniformly distributed from 0 to RAND_MAX) */
        while( ( n = rand() ) > RAND_MAX - (RAND_MAX-5)%6 )
        { /* bad value retrieved so get next one */ }

        printf( "%d,\t%d\n", n, n % 6 + 1 );
    }

    return 0;
} 
```

^^^**单**次运行的程序应该看起来是随机的。

**请注意**，出于下面解释的原因，我不建议在生产中使用`rand`/`srand`函数，并且我绝对不建议将函数`time`用作随机种子，因为 IMO 已经很明显了。这些对于教育目的很好，有时也可以说明这一点，但对于任何严肃的用途，它们大多是无用的。

**修正案 2 - 详细说明：**

重要的是要理解，到目前为止，还**没有**C 或 C++ 标准特性（库函数或类）最终确定地产生实际随机数据（即由标准保证实际上是随机的）。解决这个问题的唯一标准特性是[std::random_device](https://en.cppreference.com/w/cpp/numeric/random/random_device)，遗憾的是它仍然不能保证实际随机性。

根据应用程序的性质，您应该首先确定您是否真的需要真正随机（不可预测的）数据。**当你确实需要真正的随机性时，**值得注意的情况是信息安全——例如生成对称密钥、非对称私钥、盐值、安全令牌等。

然而，安全级随机数是一个独立的行业，值得单独写一篇文章。我在我的[这个答案](https://stackoverflow.com/questions/39288595/why-not-just-use-random-device/#68382489)中简要讨论了它们。

在大多数情况下[，伪随机数生成器](https://en.wikipedia.org/wiki/Pseudorandom_number_generator)就足够了——例如用于科学模拟或游戏。在某些情况下，甚至需要一致定义的伪随机序列——例如在游戏中，您可以选择在运行时生成完全相同的地图，以避免在您的分布中存储大量数据。

最初的问题和反复出现的大量相同/相似的问题（甚至许多被误导的“答案”）表明，首先重要的是区分随机数和伪随机数，并了解什么是伪随机数序列首先并要意识到伪随机数生成器的使用方式与使用真随机数生成器的方式不同。

> *直观地*，当您请求随机数时 - 返回的结果不应依赖于先前返回的值，不应依赖于之前是否有人请求过任何东西，也不应依赖于什么时候、通过什么过程、在什么计算机上、来自什么生成器和在它被要求的星系。毕竟，这就是**“随机”**这个词的含义——不可预测且独立于任何事物——否则它不再是随机的，对吧？有了这种直觉，在网络上搜索一些魔法咒语以在任何可能的情况下获得这样的随机数是很自然的。

^^^这种直观的期望在涉及[伪随机数生成器的所有情况下都是](https://en.wikipedia.org/wiki/Pseudorandom_number_generator)**非常错误和有害**的——尽管对于真正的随机数是合理的。

虽然存在“随机数”的有意义的概念（有点） - 没有“伪随机数”这样的东西。伪[随机数生成器](https://en.wikipedia.org/wiki/Pseudorandom_number_generator)实际上产生伪随机数**序列**。

伪随机序列实际上总是**确定性**的（由它的算法和初始参数决定）——也就是说，它实际上没有任何随机性。

当专家谈论 PRNG 的质量时，他们实际上谈论的是生成序列（及其显着的子序列）的统计特性。例如，如果您通过轮流使用它们来组合两个高质量的 PRNG - 您可能会产生不好的结果序列 - 尽管它们分别生成好的序列（这两个好的序列可能只是相互关联，因此组合不好）。

具体来说`rand()`/`srand(s)`一对函数提供了一个单一的每进程非线程安全（！）伪随机数序列，使用实现定义的算法生成。函数`rand()`产生范围内的值`[0, RAND_MAX]`。

引用 C11 标准 (ISO/IEC 9899:2011)：

> 该`srand`函数使用该参数作为一个新的伪随机数序列的种子，这些伪随机数将由后续调用返回`rand`。如果 `srand`然后以相同的种子值调用，则应重复伪随机数序列。如果`rand`在进行任何调用之前调用`srand`，则应生成与`srand`第一次调用时相同的序列，种子值为 1。

许多人合理地期望这`rand()`将产生一系列半独立均匀分布的数字，范围`0`为`RAND_MAX`。好吧，它当然应该（否则它没用），但不幸的是，不仅标准不需要这样做 - 甚至还有明确的免责声明指出*“无法保证产生的随机序列的质量”*。在某些历史案例`rand`/`srand`实施中确实质量很差。即使在现代实现中它很可能已经足够好 - 但信任被打破并且不容易恢复。除了它的非线程安全特性之外，它在多线程应用程序中的安全使用也变得棘手和有限（仍然可能——您可以只从一个专用线程中使用它们）。

新的类模板[std::mersenne_twister_engine<>](https://en.cppreference.com/w/cpp/numeric/random/mersenne_twister_engine)（及其便利的 typedefs - `std::mt19937`/`std::mt19937_64`具有良好的模板参数组合）提供了在 C++11 标准中定义的**每个对象的**伪随机数生成器。使用相同的模板参数和相同的初始化参数，不同的对象将在使用符合 C++11 标准库的任何应用程序中的任何计算机上生成完全相同的每个对象输出序列。此类的优势在于其可预测的高质量输出序列和跨实现的完全一致性。

在 C++11 标准中还定义了更多 PRNG 引擎 - [std::linear_congruential_engine<>](https://en.cppreference.com/w/cpp/numeric/random/linear_congruential_engine)（历史上在某些 C 标准库实现中用作公平质量`srand/rand`算法）和[std::subtract_with_carry_engine<>](https://en.cppreference.com/w/cpp/numeric/random/subtract_with_carry_engine)。它们还生成完全定义的参数相关的每个对象输出序列。

上面过时的 C 代码的现代 C++11 示例替换：

```
#include <iostream>
#include <chrono>
#include <random>

int main()
{
    std::random_device rd;
    // seed value is designed specifically to make initialization
    // parameters of std::mt19937 (instance of std::mersenne_twister_engine<>)
    // different across executions of application
    std::mt19937::result_type seed = rd() ^ (
            (std::mt19937::result_type)
            std::chrono::duration_cast<std::chrono::seconds>(
                std::chrono::system_clock::now().time_since_epoch()
                ).count() +
            (std::mt19937::result_type)
            std::chrono::duration_cast<std::chrono::microseconds>(
                std::chrono::high_resolution_clock::now().time_since_epoch()
                ).count() );

    std::mt19937 gen(seed);

    for( unsigned long j = 0; j < 100500; ++j )
    /* ^^^Yes. Generating single pseudo-random number makes no sense
       even if you use std::mersenne_twister_engine instead of rand()
       and even when your seed quality is much better than time(NULL) */    
    {
        std::mt19937::result_type n;
        // reject readings that would make n%6 non-uniformly distributed
        while( ( n = gen() ) > std::mt19937::max() -
                                    ( std::mt19937::max() - 5 )%6 )
        { /* bad value retrieved so get next one */ }

        std::cout << n << '\t' << n % 6 + 1 << '\n';
    }

    return 0;
} 
```

使用[std::uniform_int_distribution<>的先前代码的版本](https://en.cppreference.com/w/cpp/numeric/random/uniform_int_distribution)

```
#include <iostream>
#include <chrono>
#include <random>

int main()
{
    std::random_device rd;
    std::mt19937::result_type seed = rd() ^ (
            (std::mt19937::result_type)
            std::chrono::duration_cast<std::chrono::seconds>(
                std::chrono::system_clock::now().time_since_epoch()
                ).count() +
            (std::mt19937::result_type)
            std::chrono::duration_cast<std::chrono::microseconds>(
                std::chrono::high_resolution_clock::now().time_since_epoch()
                ).count() );

    std::mt19937 gen(seed);
    std::uniform_int_distribution<unsigned> distrib(1, 6);

    for( unsigned long j = 0; j < 100500; ++j )
    {
        std::cout << distrib(gen) << ' ';
    }

    std::cout << '\n';
    return 0;
} 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2020-06-14T22:21:36.337

每当您使用 C++ 编程语言进行基本的网络搜索时，`random number generation`通常会首先出现这个问题！我想把我的帽子扔进戒指，希望更好地阐明 C++ 中*伪随机数生成*的概念，以供将来不可避免地在网络上搜索相同问题的编码人员使用！

## 基础

伪随机数生成涉及利用[确定性算法](https://en.wikipedia.org/wiki/Deterministic_algorithm)的过程，该算法产生一系列数字，其属性近似于*随机数*。我说**近似相似**，因为真正的随机性在数学和计算机科学中是一个相当[难以捉摸的谜团。](https://engineering.mit.edu/engage/ask-an-engineer/can-a-computer-generate-a-truly-random-number/)因此，为什么使用**伪随机**这个术语在学究上更正确！

在您可以实际使用 PRNG 之前，即 ，`pseudo-random number generator`您必须为算法提供一个通常也称为**种子**的初始值。但是，在使用算法本身*之前*，种子只能设置**一次！**

 *```
/// Proper way!
seed( 1234 ) /// Seed set only once...
for( x in range( 0, 10) ):
  PRNG( seed ) /// Will work as expected

/// Wrong way!
for( x in rang( 0, 10 ) ):
  seed( 1234 ) /// Seed reset for ten iterations!
  PRNG( seed ) /// Output will be the same... 
```

因此，如果您想要一个好的数字序列，那么您必须为 PRNG 提供充足的种子！

## 旧 C 方式

C++ 具有的向后兼容的 C 标准库使用头文件中的所谓[线性同余生成器](https://en.wikipedia.org/wiki/Linear_congruential_generator)`cstdlib`！此 PRNG 通过使用模运算的不连续分段函数（即喜欢使用`modulo operator '%'`. 以下是此 PRNG 的常见用法，关于 @Predictability 提出的原始问题：

```
#include <iostream>
#include <cstdlib>
#include <ctime>

int main( void )
{
  int low_dist  = 1;
  int high_dist = 6;
  std::srand( ( unsigned int )std::time( nullptr ) );
  for( int repetition = 0; repetition < 10; ++repetition )
    std::cout << low_dist + std::rand() % ( high_dist - low_dist ) << std::endl;
  return 0;
} 
```

C 的 PRNG 的常见用法包含一系列问题，例如：

1.  的整体界面`std::rand()`对于在给定范围之间正确生成伪随机数不是很直观，例如，按照@Predictability 想要的方式生成 [1, 6] 之间的数字。
2.  [由于鸽洞原理](https://en.wikipedia.org/wiki/Pigeonhole_principle)，的常见用法`std::rand()`消除了伪随机数*均匀分布*的可能性。
3.  `std::rand()`通过技术播种的常见方式`std::srand( ( unsigned int )std::time( nullptr ) )`是不正确的，因为`time_t`被认为是[受限制的类型](https://stackoverflow.com/questions/776283/what-does-the-restrict-keyword-mean-in-c)。因此，**不能保证**`time_t`从to的转换！`unsigned int`

 **有关使用 C 的 PRNG 的总体问题以及如何规避这些问题的更多详细信息，请参阅[使用 rand() (C/C++)：对 C 标准库的 rand() 函数的建议](https://eternallyconfuzzled.com/using-rand-c-c-advice-for-the-c-standard-librarys-rand-function)！

## 标准 C++ 方式

自 ISO/IEC 14882:2011 标准（即 C++11）发布以来，该`random`库已经成为 C++ 编程语言的一部分。这个库配备了*多个*PRNG，以及不同的**分布类型**，例如：[均匀分布](http://www.cplusplus.com/reference/random/uniform_int_distribution/)、[正态分布](http://www.cplusplus.com/reference/random/normal_distribution/)、[二项分布](http://www.cplusplus.com/reference/random/binomial_distribution/)等。以下源代码示例演示了该`random`库的一个非常基本的用法，关于 @Predictability 的原始问题：

```
#include <iostream>
#include <cctype>
#include <random>

using u32    = uint_least32_t; 
using engine = std::mt19937;

int main( void )
{
  std::random_device os_seed;
  const u32 seed = os_seed();

  engine generator( seed );
  std::uniform_int_distribution< u32 > distribute( 1, 6 );

  for( int repetition = 0; repetition < 10; ++repetition )
    std::cout << distribute( generator ) << std::endl;
  return 0;
} 
```

在上面的示例中使用了具有**整数值***均匀分布*的32 位[Mersenne Twister](https://en.wikipedia.org/wiki/Mersenne_Twister)引擎。（源代码中引擎的名称听起来很奇怪，因为它的名称来自它的 2^19937-1[时期](https://softwareengineering.stackexchange.com/questions/273105/why-is-the-period-of-a-pseudorandom-number-generator-important)）。该示例还使用种子引擎，该引擎从操作系统获取其值（如果您使用的是 Linux 系统，则从 中返回一个值）。***`std::random_device``std::random_device``/dev/urandom`***

 ***请注意，您不必使用*任何引擎*`std::random_device`播种。您可以使用*常量*甚至库！您也不必使用 32 位版本的引擎，还有**其他选择**！有关该库功能的更多信息，请参阅[cplusplus.com](http://www.cplusplus.com/reference/random/)**`chrono``std::mt19937`**`random`****

 ****总而言之，C++ 程序员不应该再使用`std::rand()`了，不是因为它*不好*，而是因为当前标准提供了更好的替代方案，更*直接*、更*可靠*。希望你们中的许多人都觉得这很有帮助，尤其是那些最近在网上搜索过的人`generating random numbers in c++`！

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2015-02-03T17:07:06.437

如果您使用的是[boost](http://www.boost.org/)库，您可以通过以下方式获得随机生成器：

```
#include <iostream>
#include <string>

// Used in randomization
#include <ctime>
#include <boost/random/mersenne_twister.hpp>
#include <boost/random/uniform_int_distribution.hpp>
#include <boost/random/variate_generator.hpp>

using namespace std;
using namespace boost;

int current_time_nanoseconds(){
    struct timespec tm;
    clock_gettime(CLOCK_REALTIME, &tm);
    return tm.tv_nsec;
}

int main (int argc, char* argv[]) {
    unsigned int dice_rolls = 12;
    random::mt19937 rng(current_time_nanoseconds());
    random::uniform_int_distribution<> six(1,6);

    for(unsigned int i=0; i<dice_rolls; i++){
        cout << six(rng) << endl;
    }
} 
```

该函数`current_time_nanoseconds()`以纳秒为单位给出当前时间，用作种子。

* * *

这是一个更通用的类，用于获取范围内的随机整数和日期：

```
#include <iostream>
#include <ctime>
#include <boost/random/mersenne_twister.hpp>
#include <boost/random/uniform_int_distribution.hpp>
#include <boost/random/variate_generator.hpp>
#include "boost/date_time/posix_time/posix_time.hpp"
#include "boost/date_time/gregorian/gregorian.hpp"

using namespace std;
using namespace boost;
using namespace boost::posix_time;
using namespace boost::gregorian;

class Randomizer {
private:
    static const bool debug_mode = false;
    random::mt19937 rng_;

    // The private constructor so that the user can not directly instantiate
    Randomizer() {
        if(debug_mode==true){
            this->rng_ = random::mt19937();
        }else{
            this->rng_ = random::mt19937(current_time_nanoseconds());
        }
    };

    int current_time_nanoseconds(){
        struct timespec tm;
        clock_gettime(CLOCK_REALTIME, &tm);
        return tm.tv_nsec;
    }

    // C++ 03
    // ========
    // Dont forget to declare these two. You want to make sure they
    // are unacceptable otherwise you may accidentally get copies of
    // your singleton appearing.
    Randomizer(Randomizer const&);     // Don't Implement
    void operator=(Randomizer const&); // Don't implement

public:
    static Randomizer& get_instance(){
        // The only instance of the class is created at the first call get_instance ()
        // and will be destroyed only when the program exits
        static Randomizer instance;
        return instance;
    }
    bool method() { return true; };

    int rand(unsigned int floor, unsigned int ceil){
        random::uniform_int_distribution<> rand_ = random::uniform_int_distribution<> (floor,ceil);
        return (rand_(rng_));
    }

    // Is not considering the millisecons
    time_duration rand_time_duration(){
        boost::posix_time::time_duration floor(0, 0, 0, 0);
        boost::posix_time::time_duration ceil(23, 59, 59, 0);
        unsigned int rand_seconds = rand(floor.total_seconds(), ceil.total_seconds());
        return seconds(rand_seconds);
    }

    date rand_date_from_epoch_to_now(){
        date now = second_clock::local_time().date();
        return rand_date_from_epoch_to_ceil(now);
    }

    date rand_date_from_epoch_to_ceil(date ceil_date){
        date epoch = ptime(date(1970,1,1)).date();
        return rand_date_in_interval(epoch, ceil_date);
    }

    date rand_date_in_interval(date floor_date, date ceil_date){
        return rand_ptime_in_interval(ptime(floor_date), ptime(ceil_date)).date();
    }

    ptime rand_ptime_from_epoch_to_now(){
        ptime now = second_clock::local_time();
        return rand_ptime_from_epoch_to_ceil(now);
    }

    ptime rand_ptime_from_epoch_to_ceil(ptime ceil_date){
        ptime epoch = ptime(date(1970,1,1));
        return rand_ptime_in_interval(epoch, ceil_date);
    }

    ptime rand_ptime_in_interval(ptime floor_date, ptime ceil_date){
        time_duration const diff = ceil_date - floor_date;
        long long gap_seconds = diff.total_seconds();
        long long step_seconds = Randomizer::get_instance().rand(0, gap_seconds);
        return floor_date + seconds(step_seconds);
    }
}; 
```

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2015-01-13T22:16:04.263

```
#include <iostream>
#include <cstdlib>
#include <ctime>

int main() {
    srand(time(NULL));
    int random_number = std::rand(); // rand() return a number between ​0​ and RAND_MAX
    std::cout << random_number;
    return 0;
} 
```

[http://en.cppreference.com/w/cpp/numeric/random/rand](http://en.cppreference.com/w/cpp/numeric/random/rand)

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2018-12-21T15:57:28.803

[可以`Randomer`从这里获得用于生成随机数的完整类代码！](https://gist.github.com/VjGusev/e51429658c596672458137c57efb71e3#file-random_string-h-L11)

如果您在项目的不同部分需要随机数，您可以创建一个单独的类`Randomer`来封装其中的所有`random`内容。

像这样的东西：

```
class Randomer {
    // random seed by default
    std::mt19937 gen_;
    std::uniform_int_distribution<size_t> dist_;

public:
    /*  ... some convenient ctors ... */ 

    Randomer(size_t min, size_t max, unsigned int seed = std::random_device{}())
        : gen_{seed}, dist_{min, max} {
    }

    // if you want predictable numbers
    void SetSeed(unsigned int seed) {
        gen_.seed(seed);
    }

    size_t operator()() {
        return dist_(gen_);
    }
}; 
```

这样的类以后会很方便：

```
int main() {
    Randomer randomer{0, 10};
    std::cout << randomer() << "\n";
} 
```

您可以查看[此链接作为示例，我如何使用](https://gist.github.com/VjGusev/e51429658c596672458137c57efb71e3#file-random_string-h-L11)此类`Randomer`生成随机字符串。`Randomer`如果您愿意，也可以使用。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2017-11-07T11:33:08.333

> ***每次生成不同的随机数，而不是连续六次相同的随机数。***

**用例场景**

我将Predictability 的问题比作一袋六张纸，每张纸上都写有0 到5 的值。每次需要新值时，都会从袋子中抽出一张纸。如果袋子是空的，则将数字放回袋子中。

...由此，我可以创建一种算法。

**算法**

一个包通常是一个`Collection`. 我选择了一个`bool[]`（也称为布尔数组、位平面或位图）来扮演包的角色。

我之所以选择a `bool[]`，是因为每一项的索引已经是每张纸的价值。如果文件需要写在上面的任何其他内容，那么我会使用 a`Dictionary<string, bool>`来代替。布尔值用于跟踪数字是否已被绘制。

一个被调用的计数器`RemainingNumberCount`被初始化为`5`在选择一个随机数时倒计时。这使我们不必在每次希望绘制新数字时计算还剩下多少张纸。

为了选择下一个随机值，我使用 a`for..loop`来扫描索引包，并在调用an`index`时使用计数器来计数。`false``NumberOfMoves`

`NumberOfMoves`用于选择下一个可用号码。`NumberOfMoves`首先设置为`0`和之间的随机值`5`，因为我们可以通过袋子进行 0..5 个可用步骤。在下一次迭代`NumberOfMoves`中，设置为 和 之间的随机值`0`，`4`因为现在我们可以通过袋子进行 0..4 步。随着数字的使用，可用数字减少，因此我们改为使用`rand() % (RemainingNumberCount + 1)`来计算 的下一个值`NumberOfMoves`。

当`NumberOfMoves`计数器达到零时，`for..loop`应该如下：

1.  将当前值设置为与`for..loop`的索引相同。
2.  将袋子中的所有数字设置为`false`。
3.  从`for..loop`.

**代码**

上述解决方案的代码如下：

（将以下三个块依次放入主 .cpp 文件中）

```
#include "stdafx.h"
#include <ctime> 
#include <iostream>
#include <string>

class RandomBag {
public:
    int Value = -1;

    RandomBag() {
        ResetBag();

    }

    void NextValue() {
        int BagOfNumbersLength = sizeof(BagOfNumbers) / sizeof(*BagOfNumbers);

        int NumberOfMoves = rand() % (RemainingNumberCount + 1);

        for (int i = 0; i < BagOfNumbersLength; i++)            
            if (BagOfNumbers[i] == 0) {
                NumberOfMoves--;

                if (NumberOfMoves == -1)
                {
                    Value = i;

                    BagOfNumbers[i] = 1;

                    break;

                }

            }

        if (RemainingNumberCount == 0) {
            RemainingNumberCount = 5;

            ResetBag();

        }
        else            
            RemainingNumberCount--; 

    }

    std::string ToString() {
        return std::to_string(Value);

    }

private:
    bool BagOfNumbers[6]; 

    int RemainingNumberCount;

    int NumberOfMoves;

    void ResetBag() {
        RemainingNumberCount = 5;

        NumberOfMoves = rand() % 6;

        int BagOfNumbersLength = sizeof(BagOfNumbers) / sizeof(*BagOfNumbers);

        for (int i = 0; i < BagOfNumbersLength; i++)            
            BagOfNumbers[i] = 0;

    }

}; 
```

**控制台类**

我创建了这个 Console 类，因为它可以很容易地重定向输出。

在下面的代码...

```
Console::WriteLine("The next value is " + randomBag.ToString()); 
```

……可以换成……

```
std::cout << "The next value is " + randomBag.ToString() << std::endl; 
```

...然后`Console`可以根据需要删除此类。

```
class Console {
public:
    static void WriteLine(std::string s) {
        std::cout << s << std::endl;

    }

}; 
```

**主要方法**

示例用法如下：

```
int main() {
    srand((unsigned)time(0)); // Initialise random seed based on current time

    RandomBag randomBag;

    Console::WriteLine("First set of six...\n");

    randomBag.NextValue();

    Console::WriteLine("The next value is " + randomBag.ToString());

    randomBag.NextValue();

    Console::WriteLine("The next value is " + randomBag.ToString());

    randomBag.NextValue();

    Console::WriteLine("The next value is " + randomBag.ToString());

    randomBag.NextValue();

    Console::WriteLine("The next value is " + randomBag.ToString());

    randomBag.NextValue();

    Console::WriteLine("The next value is " + randomBag.ToString());

    randomBag.NextValue();

    Console::WriteLine("The next value is " + randomBag.ToString());

    Console::WriteLine("\nSecond set of six...\n");

    randomBag.NextValue();

    Console::WriteLine("The next value is " + randomBag.ToString());

    randomBag.NextValue();

    Console::WriteLine("The next value is " + randomBag.ToString());

    randomBag.NextValue();

    Console::WriteLine("The next value is " + randomBag.ToString());

    randomBag.NextValue();

    Console::WriteLine("The next value is " + randomBag.ToString());

    randomBag.NextValue();

    Console::WriteLine("The next value is " + randomBag.ToString());

    randomBag.NextValue();

    Console::WriteLine("The next value is " + randomBag.ToString());

    Console::WriteLine("\nThird set of six...\n");

    randomBag.NextValue();

    Console::WriteLine("The next value is " + randomBag.ToString());

    randomBag.NextValue();

    Console::WriteLine("The next value is " + randomBag.ToString());

    randomBag.NextValue();

    Console::WriteLine("The next value is " + randomBag.ToString());

    randomBag.NextValue();

    Console::WriteLine("The next value is " + randomBag.ToString());

    randomBag.NextValue();

    Console::WriteLine("The next value is " + randomBag.ToString());

    randomBag.NextValue();

    Console::WriteLine("The next value is " + randomBag.ToString());

    Console::WriteLine("\nProcess complete.\n");

    system("pause");

} 
```

**示例输出**

当我运行程序时，我得到以下输出：

```
First set of six...

The next value is 2
The next value is 3
The next value is 4
The next value is 5
The next value is 0
The next value is 1

Second set of six...

The next value is 3
The next value is 4
The next value is 2
The next value is 0
The next value is 1
The next value is 5

Third set of six...

The next value is 4
The next value is 5
The next value is 2
The next value is 0
The next value is 3
The next value is 1

Process complete.

Press any key to continue . . . 
```

**结束语**

该程序是使用**Visual Studio 2017**编写的，我选择`Visual C++ Windows Console Application`使用`.Net 4.6.1`.

我在这里没有做任何特别的事情，所以代码也应该适用于早期版本的 Visual Studio。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2018-07-07T10:24:37.167

此代码产生从`n`到 的随机数`m`。

```
int random(int from, int to){
    return rand() % (to - from + 1) + from;
} 
```

例子：

```
int main(){
    srand(time(0));
    cout << random(0, 99) << "\n";
} 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2014-05-08T20:44:16.533

**这是一个解决方案。创建一个返回随机数的函数并将其放在主函数之外以使其全局化。希望这可以帮助**

```
#include <iostream>
#include <cstdlib>
#include <ctime>
int rollDie();
using std::cout;
int main (){
    srand((unsigned)time(0));
    int die1;
    int die2;
    for (int n=10; n>0; n--){
    die1 = rollDie();
    die2 = rollDie();
    cout << die1 << " + " << die2 << " = " << die1 + die2 << "\n";
}
system("pause");
return 0;
}
int rollDie(){
    return (rand()%6)+1;
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2016-02-01T11:49:41.910

随机每个 RUN 文件

```
size_t randomGenerator(size_t min, size_t max) {
    std::mt19937 rng;
    rng.seed(std::random_device()());
    //rng.seed(std::chrono::high_resolution_clock::now().time_since_epoch().count());
    std::uniform_int_distribution<std::mt19937::result_type> dist(min, max);

    return dist(rng);
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-12-24T17:41:39.730

我知道如何在不使用任何头文件、编译器内在函数或其他任何东西的情况下在 C++ 中生成随机数。

```
#include <cstdio> // Just for printf
int main() {
    auto val = new char[0x10000];
    auto num = reinterpret_cast<unsigned long long>(val);
    delete[] val;
    num = num / 0x1000 % 10;
    printf("%llu\n", num);
} 
```

运行一段时间后，我得到了以下统计信息：

```
0: 5268
1: 5284
2: 5279
3: 5242
4: 5191
5: 5135
6: 5183
7: 5236
8: 5372
9: 5343 
```

看起来很随意。

这个怎么运作：

*   [现代编译器使用ASLR](https://en.wikipedia.org/wiki/Address_space_layout_randomization)（地址空间布局随机化）保护您免受缓冲区溢出。
*   所以你可以在不使用任何库的情况下生成一些随机数，但这只是为了好玩。不要像那样使用 ASLR。

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2018-06-13T13:06:48.513

这是一个简单的随机生成器，大约。在 0 附近产生正值和负值的概率相等：

```
 int getNextRandom(const size_t lim) 
  {
        int nextRand = rand() % lim;
        int nextSign = rand() % lim;
        if (nextSign < lim / 2)
            return -nextRand;
        return nextRand;
  }

   int main()
   {
        srand(time(NULL));
        int r = getNextRandom(100);
        cout << r << endl;
        return 0;
   } 
```**********

# python - 在 Mac OS X 10.8 上安装 MySQLdb 以在 Pydev 中运行

> ID：13445692
> 
> 赞同：1
> 
> 时间：2012-11-18T23:23:56.487
> 
> 标签：python, macos, pydev, 32-bit, mysql-python

几天来，我在尝试在 Mac OS X 10.8 中安装 mysql-python 时遇到了一些不兼容的冲突。在查看了一些论坛后，我找到了强制 Python 以 32 位运行的解决方案，因为 mysql-python (MySQLdb) 只有 32 位版本：

`export VERSIONER_PYTHON_PREFER_32_BIT=yes`

该命令有助于在终端中很好地运行 MySQLdb。但是，当我安装 PyDev 并尝试运行一个只有一行代码的简单程序时：`import MySQLdb`. 在强制 Python 以 32 位运行之前，我在终端中运行它时遇到了同样的错误： `....mach-o, but wrong architecture`

我猜 PyDev 还是选择了 64 位 python。如何强制 PyDev 运行 Python 32 位？

文件夹`/System/Library/Frameworks/Python.framework/Versions/2.7/bin/`中没有 32 位 python。我尝试安装另一个具有 32/64 位 Python 的 Python（我找不到仅适用于我的 Mac 的 32 位 Python），但不知道如何让 Mac OS X 选择新的 32 位 Python，以便我可以用它安装mysql-python。

有什么想法可以帮助解决这个问题吗？

# java - 链表上的选择排序输出不正确

> ID：13445693
> 
> 赞同：0
> 
> 时间：2012-11-18T23:24:15.707
> 
> 标签：java

我在下面的链接列表选择排序中遇到了问题：

```
public static void selectionSort(LN l) {
    for (LN r = l; r != null; r = r.next) {
        LN min = r;
        for (LN s = r; s != null; s = s.next)
            if (min.value > s.value)
                min = s;
        LN temp = r;
        r.value = min.value;
        min.value = temp.value;
    }
} 
```

所以对于输入：10, 4,6,2,1,7,9,8,5,3 我得到输出：1,1,1,1,1,3,3,3,3,3

这里的排序有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T23:27:55.710

这：

```
 LN temp = r;
        r.value = min.value;
        min.value = temp.value; 
```

是错的。通过设置`temp`equal `r`，您实际上是在使它们引用同一个对象；所以修改`r.value`等价于修改`temp.value`。所以上面的结果并没有真正修改`min.value`；它只是设置`min.value`为它已经是什么。

相反，你应该写：

```
 int temp = r.value;
        r.value = min.value;
        min.value = temp; 
```

# asp.net-mvc - Asp.net Mvc 的通用控制器

> ID：13445695
> 
> 赞同：0
> 
> 时间：2012-11-18T23:24:25.120
> 
> 标签：asp.net-mvc

我讨厌违反 DRY 规则。

对于 url：/student/charles /Views/Student/Show.cshtml 将使用学生模型呈现。

如何使用 asp.net mvc 实现它？

（我可以从 URL 获取相关模型）

我想我已经解决了。我正在通过此代码捕获所有请求：

```
 routes.MapRoute("CatchAll", "{*url}",
            new { controller = "Base", action = "Dispatch" }
        ); 
```

现在我正在尝试在调度程序中调用 CustomView。

瞧：

```
 public class BaseController : Controller
{

    public ActionResult Dispatch(string url)
    {
        object model = null;
        .....
        return View("~/Views/Student/Show.cshtml", model);

    }
} 
```

看起来很脏但很有效:) 我愿意接受任何更好的实施。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T03:20:11.737

我承认我不确定您要完成什么。我首先不明白如果您以正常的 MVC 方式实现它，您将如何违反 DRY。

你会做这样的事情。

模型：Student.cs

```
public class Student {
  public string StudentId { get; set; }
  public string Name { get; set; }
} 
```

控制器：StudentController.cs

```
public class StudentController : Controller {

  public ActionResult Student(string id) {
    // TODO: Get the student by ID and return the view displaying the student.
    return View(student);
  }
} 
```

视图：Student.cshtml - 为学生模型（或视图模型）创建一个强类型视图。

很简单也很直接。您不需要弄乱路由（我不建议您不要全部捕获 - 我什至不确定这会给您带来什么）。当然，如果您想获取 URL/Student/StudentName，则需要稍微处理一下路由，但这也很简单。

同样，我只是在说明基本的 MVC 设置。我不确定您要保持 DRY 什么 - 我没有看到您重复代码的任何地方。也许你可以澄清一下？

# java - 堆优先级队列如何记住它在数组中的索引？

> ID：13445700
> 
> 赞同：0
> 
> 时间：2012-11-18T23:25:21.323
> 
> 标签：java

什么是我实现此队列的最简单方法，以便我可以在每个相应的 MyEntry 对象中保存每个索引（条目在 ArrayList 堆中的位置），而不使用键或值来执行此操作？

```
public class HeapPriorityQueue<K,V> {

protected ArrayList<Entry<K,V>> heap;
protected Comparator<K> comp;

protected static class MyEntry<K,V> implements Entry<K,V> {
    protected K key;
    protected V value;
    public MyEntry(K k, V v) {key = k; value = v;}
    public K getKey() {return key;}
    public V getValue() {return value;}
    public String toString() {return "(" + key + "," + value + ")";}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T00:19:09.540

您是否正在寻找与此类似的东西？

```
public class HeapPriorityQueue<K,V> {

  protected ArrayList<Entry<K,V>> heap;
  protected TreeMap<Entry<K,V>, Integer> index;
  protected Comparator<K> comp;

  public synchronized void addEntry(K key, V value) {
    // requires O(log(n))
    Entry<K, V> entry = new Entry<K, V>(key, value);
    int insertionPos = heap.size();
    heap.add(entry);
    index.put(entry, insertionPos);
  }

  public int indexOfEntry(Entry<K,V> entry ) {
    // requires O(log(n))
    return index.get(entry);
  }

  protected static class MyEntry<K,V> implements Entry<K,V> {
    protected K key;
    protected V value;
    public MyEntry(K k, V v) {key = k; value = v;}
    public K getKey() {return key;}
    public V getValue() {return value;}
    public String toString() {return "(" + key + "," + value + ")";}
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-03-02T12:31:42.020

只需使用 One`Map<int,int>`存储数组的索引和值即可解决。而 One Priority 又`Queue<Pair<int,int>> pq`存储了对应于priority Queue中优先级的索引和值。

C++ 代码：

```
#include<bits/stdc++.h>
using namespace std;

// Author : @devangs

int main(){
    int i,j;
    vector<int> v ={1,2,3,4,5,2,5,4};
    int n=v.size();

    unordered_map<int,int> mp;
    for (i=0; i<n; i++)
    {
        mp[i]=v[i];
    }

    cout<<"Map With Index and Values Are: "<<endl;
    for (auto it:mp)
        cout<<it.first<<" "<<it.second<<endl;

    cout<<endl;

    cout<<"Map With Index and PQ Value Are: " <<endl;           
    priority_queue<pair<int,int>> pq; 
    for(auto it = mp.begin(); it != mp.end(); it++)
    {
        pq.push(make_pair(it->second, it->first));
    }

    while (!pq.empty()){
        cout<<pq.top().second<<" "<<pq.top().first<<endl;  
        pq.pop();
    }
    return 0;
} 
```

# java - 如何创建 String -> Array 的静态 Map

> ID：13445701
> 
> 赞同：13
> 
> 时间：2012-11-18T23:25:33.190
> 
> 标签：java, map, static

我需要创建一个静态`Map`映射给定`String`的数组`int`。

换句话说，我想定义类似：

```
"fred" -> {1,2,5,8}
"dave" -> {5,6,8,10,11}
"bart" -> {7,22,10010}
... etc 
```

有没有一种简单的方法可以在 Java 中做到这一点？

如果可能的话，我想对 the和值`static`都使用常量。`String``int`

**编辑：**为了澄清我所说`static`的值常量的含义，并给出我认为正确的代码，这是我对解决方案的第一次尝试：

```
public final static String FRED_TEXT = "fred";
public final static String DAVE_TEXT = "dave";

public final static int ONE = 1;
public final static int TWO = 2;
public final static int THREE = 3;
public final static int FOUR = 4;

public final static HashMap<String, int[]> myMap = new HashMap<String, int[]>();
static {
    myMap.put(FRED_TEXT, new int[] {ONE, TWO, FOUR});
    myMap.put(DAVE_TEXT, new int[] {TWO, THREE});
} 
```

请注意，这些名称不是我实际使用的名称。这只是一个人为的例子。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-11-19T01:25:12.103

您*不需要*将声明和初始化分开。如果你知道怎么做，这一切都可以在一条线上完成！

```
// assumes your code declaring the constants ONE, FRED_TEXT etc is before this line
private static final Map<String, int[]> myMap = Collections.unmodifiableMap(
    new HashMap<String, int[]>() {{
        put(FRED_TEXT, new int[] {ONE, TWO, FOUR});
        put(DAVE_TEXT, new int[] {TWO, THREE});
    }}); 
```

我们这里有一个带有[初始化块](http://docs.oracle.com/javase/tutorial/java/javaOO/initial.html)的匿名类，它是在构造函数之后执行的代码块，我们在这里使用它来加载地图。

这种语法/结构有时被错误地称为“双括号初始化”——我想是因为有两个相邻的括号——但实际上没有这样的事情。

关于这个的两个很酷的事情是：

*   它将声明与内容结合起来，并且
*   因为初始化是内联的，您也可以对 进行内联调用`Collections.unmodifiableMap()`，从而产生整洁的单行声明、初始化和转换为不可修改。

如果您不需要/不希望地图不可修改，请忽略该调用：

```
private static final Map<String, int[]> myMap = new HashMap<String, int[]>() {{
    put(FRED_TEXT, new int[] {ONE, TWO, FOUR});
    put(DAVE_TEXT, new int[] {TWO, THREE});
}}; 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-11-18T23:28:02.253

您需要单独声明和初始化静态地图。

这是声明部分：

```
private static final Map<String,int[]> MyMap; 
```

这是初始化部分：

```
static {
    Map<String,int[]> tmpMap = new HashMap<String,int[]>();
    tmpMap.put("fred", new int[] {1,2,5,8});
    tmpMap.put("dave", new int[] {5,6,8,10,11});
    tmpMap.put("bart", new int[] {7,22,10010});
    MyMap = Collections.unmodifiableMap(tmpMap);
} 
```

不幸的是，数组在 Java 中总是可写的。您将无法分配`MyMap`，但您将能够从访问地图的程序的其他部分添加或删除值。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2015-02-10T19:12:41.020

为了完整起见，因为这是 google 中“java static define map”的第一个结果，在 Java 8 中，您现在可以执行此操作。

```
Collections.unmodifiableMap(Stream.of(
            new SimpleEntry<>("a", new int[]{1,2,3}),
            new SimpleEntry<>("b", new int[]{1,2,3}),
            new SimpleEntry<>("c", new int[]{1,2,3}))
            .collect(Collectors.toMap((e) -> e.getKey(), (e) -> e.getValue()))); 
```

这个很好的部分是我们不再使用双括号语法（`{{ }}`）创建匿名类

然后我们可以用一些代码来扩展它来清理模式，就像这个人在这里所做的那样 [http://minborgsjavapot.blogspot.ca/2014/12/java-8-initializing-maps-in-smartest-way.html](http://minborgsjavapot.blogspot.ca/2014/12/java-8-initializing-maps-in-smartest-way.html)

```
public static <K, V> Map.Entry<K, V> entry(K key, V value) {
    return new AbstractMap.SimpleEntry<>(key, value);
}

public static <K, U> Collector<Map.Entry<K, U>, ?, Map<K, U>> entriesToMap() {
    return Collectors.toMap((e) -> e.getKey(), (e) -> e.getValue());
}

public static <K, U> Collector<Map.Entry<K, U>, ?, ConcurrentMap<K, U>> entriesToConcurrentMap() {
    return Collectors.toConcurrentMap((e) -> e.getKey(), (e) -> e.getValue());
} 
```

最后结果

```
Collections.unmodifiableMap(Stream.of(
            entry("a", new int[]{1,2,3}),
            entry("b", new int[]{1,2,3}),
            entry("c", new int[]{1,2,3}))
            .collect(entriesToMap())); 
```

这会给我们一个并发不可修改的地图。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-18T23:27:02.560

```
static Map<String, int[]> map = new HashMap<>(); 
```

该映射是静态的，您可以在不创建它定义的类的实例的情况下访问它。我不知道您的键和值也静态是什么意思，因为这对我来说毫无意义。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-09-09T16:07:43.557

```
public class ExampleClass {
    public final static HashMap consts = new HashMap();
    static
    {
        constants.put("A", "The Letter A");
        constants.put("B", "The Letter B");
        constants.put("C", "The Letter C");
    }
    /* Rest of your class that needs to know the consts */
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-07-13T22:39:49.107

您还可以使用：`ImmutableMap.of(key, val)`

[https://guava.dev/releases/23.0/api/docs/com/google/common/collect/ImmutableMap.html#of--](https://guava.dev/releases/23.0/api/docs/com/google/common/collect/ImmutableMap.html#of--)

# c# - Windows 应用商店，从存储在 GridView 项的 DataTemplate 中的代码访问 Canvas

> ID：13445706
> 
> 赞同：0
> 
> 时间：2012-11-18T23:26:07.137
> 
> 标签：c#, xaml, gridview, windows-store-apps

如何从我的 C# 代码访问存储在 GridView 项目的 DataTemplate 中的 Canvas 控件？

```
<DataTemplate x:Key="250x250ItemTemplate">
    <Grid HorizontalAlignment="Left" Width="250" Height="250">
        <Border Background="{StaticResource ListViewItemPlaceholderBackgroundThemeBrush}">
            <Canvas x:Name="Canv"/>  <------ I WANT ACCESS THIS CANVAS FROM C# CODE
        </Border>
    </Grid>
</DataTemplate>
<Grid Background="{StaticResource ApplicationPageBackgroundThemeBrush}">
    <GridView x:Name="GridViewData" ItemTemplate="{StaticResource 250x250ItemTemplate}"/>
</Grid> 
```

我正在从 C# 代码填充 GridViewData 项，使用来自远程加载的 XML 的数据设置 GridViewData.ItemsSource。

然后我需要分别修改每个元素的画布（通过添加子元素）。

但我不明白我该怎么做。

有人可以帮我吗？先感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T17:01:47.877

每个有兴趣回答这个问题的人！我在这里找到了解决方案：http: [//www.wiredprairie.us/blog/index.php/archives/1730](http://www.wiredprairie.us/blog/index.php/archives/1730)

太可怕了，我不明白为什么我们需要在这里做这么多魔法，但它确实有效。

```
namespace Extension
{
    public static class FrameworkElementExtensions
    {
        public static FrameworkElement FindDescendantByName(this FrameworkElement element, string name)
        {
            if (element == null || string.IsNullOrWhiteSpace(name))
            {
                return null;
            }
            if (name.Equals(element.Name, StringComparison.OrdinalIgnoreCase))
            {
                return element;
            }
            var childCount = VisualTreeHelper.GetChildrenCount(element);
            for (int i = 0; i < childCount; i++)
            {
                var result = (VisualTreeHelper.GetChild(element, i) as FrameworkElement).FindDescendantByName(name);
                if (result != null)
                {
                    return result;
                }
            }
            return null;
        }
    }
} 
```

和

```
for (int i = 0; i<GridViewTickers.Items.Count; i++)
{
    var element = GridViewTickers.ItemContainerGenerator.ContainerFromIndex(i) as FrameworkElement;
    if (element != null)
    {
        var tb = element.FindDescendantByName("Canv") as Canvas;
        if (tb != null)
        {
            TextBlock tb1 = new TextBlock();
            tb1.Text = "hello";
            tb.Children.Add(tb1);
        }
    }
} 
```

If anyone can explain for me what we're doing in this bunch of code - please do this, 'cause my brain is exploding right now :)

Thank you all!

# java - 映射内部的休眠参数注入，可能吗？

> ID：13445713
> 
> 赞同：0
> 
> 时间：2012-11-18T23:27:03.960
> 
> 标签：java, mysql, hibernate, hibernate-mapping

我在许多项目中使用 Hibernate。从那时起，我就开发了我的项目，包括一个翻译表，其中包含每种语言的文本值，供其他需要它的表使用。

转换表的映射文件

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN" "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<hibernate-mapping>
  <class dynamic-insert="false" dynamic-update="false" mutable="true" name="com.spectotechnologies.website.common.helper.TranslationValue" optimistic-lock="version" polymorphism="implicit" select-before-update="false" table="common_translations">
    <id name="keyTranslation">
      <generator class="native"/>
    </id>
    <property name="keyLanguage"/>
    <property name="tableName"/>
    <property name="fieldName"/>
    <property name="keyRow"/>
    <property name="value"/>
  </class>
</hibernate-mapping> 
```

一个需要翻译的对象的例子：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN" "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<hibernate-mapping>
  <class dynamic-insert="false" dynamic-update="false" mutable="true" name="com.spectotechnologies.website.common.helper.Category" optimistic-lock="version" polymorphism="implicit" select-before-update="false" table="common_categories">
    <id name="keyCategory">
      <generator class="native"/>
    </id>
    <property name="keyParent"/>
    <property name="tag"/>
    <property name="name" insert="false" update="false"/>
    <property name="description" insert="false" update="false"/>
  </class>
</hibernate-mapping> 
```

目前，我使用这种 SQL 查询来加载对象

```
"SELECT" +
    " c.keyCategory," +
    " c.keyParent," +
    " c.tag," +
    " tn.value AS name," +
    " td.value AS description" +
" FROM common_categories c" +
// name
" LEFT JOIN common_translations tn" +
    " ON tn.tableName = 'common_categories'" +
    " AND tn.fieldName = 'name'" +
    " AND tn.keyRow = c.keyCategory" +
    " AND tn.keyLanguage = ?" +
// description
" LEFT JOIN common_translations td" +
    " ON td.tableName = 'common_categories'" +
    " AND td.fieldName = 'description'" +
    " AND td.keyRow = c.keyCategory" +
    " AND td.keyLanguage = ?" +
" ORDER BY" +
    " c.keyCategory ASC" 
```

我想知道是否可以在映射中传输这种左连接，因为我需要包含参数：tableName、fieldName、语言。

非常感谢您的帮助，我将能够简化很多查询！

**编辑 ：**

这是我期望的一个例子：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN" "http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<hibernate-mapping>
  <class dynamic-insert="false" dynamic-update="false" mutable="true" name="com.spectotechnologies.website.common.helper.Category" optimistic-lock="version" polymorphism="implicit" select-before-update="false" table="common_categories">
    <id name="keyCategory">
      <generator class="native"/>
    </id>
    <property name="keyParent"/>
    <property name="tag"/>
    <one-to-many class="com.spectotechnologies.website.common.helper.TranslationValue"
  formula="tableName = 'common_categories' AND fieldName = 'name' AND keyLanguage = @language AND keyRow = keyCategory" name="name" />
    <one-to-many class="com.spectotechnologies.website.common.helper.TranslationValue"
  formula="tableName = 'common_categories' AND fieldName = 'description' AND keyLanguage = @language AND keyRow = keyCategory" name="description" />
  </class>
</hibernate-mapping> 
```

在这种情况下，我需要创建一个可以在查询时注入的变量@language。这个解决方案有两个问题：

1.  我不知道是否可以将变量发布到映射范围。

2.  该公式暂时不存在：[https ://hibernate.onjira.com/browse/HHH-944](https://hibernate.onjira.com/browse/HHH-944)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T06:58:33.517

对我来说，您只需要定义两个实体之间的一对多和多对一关系。例如，每个类别都应该有翻译列表（或集合）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-06T07:00:47.770

由于使用“自定义键”（tableName 和 fieldName）处理表很复杂，因此我反转了键。现在需要多语言文本的对象具有所需文本的外键。对于所有多语言数据，它只需要两个表：

```
CREATE TABLE `common_multilingualtexts` (
  `keyMultilingualText` int(11) NOT NULL auto_increment,
  PRIMARY KEY  (`keyMultilingualText`)
) ENGINE=MyISAM AUTO_INCREMENT=0 DEFAULT CHARSET=utf8;

CREATE TABLE `common_multilingualtexts_values` (
  `languageCode` varchar(5) NOT NULL,
  `keyMultilingualText` int(11) NOT NULL,
  `value` text,
  PRIMARY KEY  (`languageCode`,`keyMultilingualText`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8; 
```

**MultilingualText**现在是这样的：

```
@Entity
@Table(name = "common_multilingualtexts")
public class MultilingualText implements Serializable
{
    private Integer m_iKeyMultilingualText;
    private Map<String, String> m_lValues = new HashMap<String, String>();

    public void setKeyMultilingualText(Integer p_iKeyMultilingualText)
    {
        m_iKeyMultilingualText = p_iKeyMultilingualText;
    }

    @Id
    @GeneratedValue
    @Column(name = "keyMultilingualText")
    public Integer getKeyMultilingualText()
    {
        return m_iKeyMultilingualText;
    }

    public void setValues(Map<String, String> p_lValues)
    {
        m_lValues = p_lValues;
    }

    @ElementCollection(fetch = FetchType.EAGER)
    @MapKeyColumn(name = "languageCode")
    @CollectionTable(name = "common_multilingualtexts_values", joinColumns = @JoinColumn(name = "keyMultilingualText"))
    @Column(name = "value")
    public Map<String, String> getValues()
    {
        return m_lValues;
    }

    public void put(String p_sLanguageCode, String p_sValue)
    {
        m_lValues.put(p_sLanguageCode,p_sValue);
    }

    public String get(String p_sLanguageCode)
    {
        if(m_lValues.containsKey(p_sLanguageCode))
        {
            return m_lValues.get(p_sLanguageCode);
        }

        return null;
    }
} 
```

每个需要多语言的字段只需声明如下：

```
@OneToOne(cascade = CascadeType.ALL)
@JoinColumn(name = "keyTitle")
public MultilingualText getTitle()
{
    return m_oTitle;
} 
```

**笔记 ：**

唯一的缺点是每个多语言字段都会生成一个 N + 1 选择，一旦找到解决方案，我将更新我的答案。

# asp.net - 是否可以像在 SharePoint 中一样显示活动目录信息弹出窗口

> ID：13445714
> 
> 赞同：1
> 
> 时间：2012-11-18T23:27:06.033
> 
> 标签：asp.net, sharepoint, active-directory

在 SharePoint 中，当您将鼠标悬停在用户名上时，会出现一个弹出窗口，其中包含他们来自 AD 的详细信息，例如在 Outlook 中，像这样...

![广告弹出](../Images/6a38855f3e3f7fef9dc23fe2ade44c5a.png)

这是如何完成的，是否可以在我自己的 ASP.NET 网站中使用 SharePoint 必须执行的任何操作来执行此操作？我们有一个员工内部网，我想在其中执行此操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T03:35:44.793

You can copy the [javascript directly from the SharePoint page](http://geekswithblogs.net/jacobladams/archive/2011/05/03/use-hmtl-and-javascript-to-display-presence-controls-in-sharepoint.aspx), e.g.

```
<script type="text/javascript" src="http://sharepointsite/_layouts/1033/init.js">
</script>
<script type="text/javascript" src="http://sharepointsite/_layouts/1033/core.js">
</script>
<style type="text/css">
img.presenceIndicator
{
   border-style:None;
   height:12px;
   width:12px;
   border-width:0px;
   vertical-align: middle
}
</style>
<span>
   <img id="uniqueID" onload="IMNRC('jadams@example.com', 
   getElementById('uniqueID'))" ShowOfflinePawn="1" 
   src=http://sharepointsite/_layouts/images/blank.gif 
   class="presenceIndicator"/>

   <a href="someCustomUserProfilePage.aspx?UserID=adamsjl">Adams, Jacob L.</a>
</span> 
```

, or use [these codeplex controls](http://htmlpresencecontrols.codeplex.com/).

# jquery - 使用 jqPlot 的实时图表：性能问题

> ID：13445716
> 
> 赞同：0
> 
> 时间：2012-11-18T23:27:12.500
> 
> 标签：jquery, charts, live, jqplot

对于一个项目，我需要使用 jqPlot 实现实时更新图表。

请参阅以下 jsFiddle： http: [//jsfiddle.net/fracu/HrZcj/242/](http://jsfiddle.net/fracu/HrZcj/242/) （为简单起见，这些值是随机生成的）

我成功地完成了这项工作，但我遇到了性能问题：在图表运行几分钟后，浏览器开始变慢，直到我关闭图表的选项卡。（用 Firefox 和 Chrome 测试）

我看不出问题出在哪里，因为我没有做任何特别的事情，只是每隔 n 秒使用存储图表值的数组重新绘制图表。

我遇到的另一个问题是，当我调整 x 轴的大小时，“刻度”位于图表的左侧，并且它们沿轴分布不均。

你能给我一个关于可能发生的事情的线索吗？

提前致谢！

Javascript：

```
 var plot1 = $.jqplot('chart1', [new Array(1)], {
        series: [{yaxis:'y2axis',showMarker:true,fill:false,neighborThreshold:3,rendererOptions:{smooth:true}}],
        axes: {
            xaxis: {renderer: $.jqplot.DateAxisRenderer,tickOptions:{formatString:'%H:%M:%S'}},
            y2axis:{tickOptions:{formatString:'%.2f'}}
        },
    });

    var myData = [], x, y, samples = 0, secsBuffer = 60, refreshInterval = 1, sampleWindow = secsBuffer / refreshInterval;

    $("#refreshInterval").change(function () {
        clearInterval(cInt);
        cInt = window.setInterval(updateSeries, $("#refreshInterval").val() * 1000);
        refreshInterval = $("#refreshInterval").val();
        sampleWindow = secsBuffer / refreshInterval;
    });

    $("#secsBuffer").change(function () {
        secsBuffer = $("#secsBuffer").val();
        sampleWindow = secsBuffer / refreshInterval;
    });

    function updateSeries() {
        if (samples > sampleWindow) {
            var diff = samples - sampleWindow;
            myData.splice(0, diff);
            samples -= diff;
        }
        x = (new Date()).getTime();
        y = Math.floor(Math.random() * 100);
        myData.push([x, y]);

        plot1.resetAxesScale();
        plot1.axes.xaxis.numberTicks = 15;
        plot1.axes.y2axis.numberTicks = 15;
        plot1.axes.xaxis.min = x - (secsBuffer * 1000);
        plot1.axes.xaxis.max = x;
        plot1.series[0].data = myData;
        plot1.replot();
        samples++;
    }
    cInt = window.setInterval(updateSeries, refreshInterval * 1000); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-07T14:34:26.277

我相信这是因为绘图涉及一些处理，更多的数据意味着更多的处理，这就是为什么它会在一段时间后减慢浏览器的速度。

我可以建议您在绘图达到特定时间范围后从数据数组的开头开始移动。

```
if(time limit has reached) myData.shift(); 
```

这可能不是最好的解决方案。但是您仍然可以在绘图上查看最后 10 分钟（或您决定开始修剪数组的任何时间段）的数据，而不会导致浏览器崩溃。

# redmine - 如何在 EC2 上安装 Redmine 电子邮件提醒插件？

> ID：13445718
> 
> 赞同：0
> 
> 时间：2012-11-18T23:27:30.953
> 
> 标签：redmine, reminders, ec2-ami

我已经在 Ubuntu 上的 EC2 上运行了一个 Redmine 实例。现在我想通过电子邮件在我的 EC2 实例上安装 Redmine 提醒。怎么做到呢？非常感谢，丹尼尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T12:14:25.470

我用过这个并为我工作！

[http://redminecrm.com/boards/4/topics/448-installing-redmine-2-2-passenger-nginx-rvm-on-ubuntu-12-04](http://redminecrm.com/boards/4/topics/448-installing-redmine-2-2-passenger-nginx-rvm-on-ubuntu-12-04)

在遵循本教程之前不要忘记更新和更新 apt-get

# ios - 从 AppDelegate 影响视图

> ID：13445725
> 
> 赞同：0
> 
> 时间：2012-11-18T23:28:22.277
> 
> 标签：ios, view, storyboard, appdelegate

我知道这是一个初学者的问题，但我找不到解决方案。我有一个带有故事板的应用程序。那是一个选项卡式视图应用程序，每个选项卡都指向一个导航视图控制器，而不是一个根视图控制器。在导航视图控制器中，我有一个登录按钮。按下它会向应用程序代表发送一条消息，以处理与 Facebook 的会话。我想在与 facebook 的会话打开后，将按钮的标题设置为注销，因为如果我再次按下它，这就是它要做的事情。这一切都是视觉编程的，没有硬编码，所以很多代码都丢失了。现在我知道只有一个应用程序委托实例，因此很容易从视图中访问它，但是我如何从应用程序委托到视图的活动会话？我尝试将它放在 viewDidLoad 方法中，但显然来自 Facebook API 的回调不会重新加载视图（它也不应该重新加载，因为系统不会再次工作）

任何想法如何让应用程序代表向视图的活动会话发送消息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T00:35:19.790

这里有几种方法可以做到这一点：

1.  您可以使用 get your app delegate 在用户登录/注销时发布通知（Facebook 库可能已经发布通知？），并且您的视图控制器可以注册此通知，以便他们可以在 Facebook 会话时更改其状态改变状态。你还需要对你的`viewDidLoad`方法做一些事情，这样如果用户有一个来自先前登录的会话，控制器就会让自己进入正确的初始状态。查看[https://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/Notifications/Introduction/introNotifications.html#//apple_ref/doc/uid/10000043i](https://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/Notifications/Introduction/introNotifications.html#//apple_ref/doc/uid/10000043i)了解有关通知编程的更多信息。
2.  您可以在视图控制器中实现代码，`viewWillAppear:animated`以便在用户登录后显示视图时，控制器会查询应用程序委托以确定您的会话状态。我怀疑这是您通过将代码放入尝试做的事情`viewDidLoad`，但是视图已经加载，因此登录后不会调用此代码。`viewWillAppear:animated`在视图出现之前被调用。

# tidesdk - HTML5 服务器发送事件在 TideSDK 中不起作用

> ID：13445727
> 
> 赞同：0
> 
> 时间：2012-11-18T23:28:33.190
> 
> 标签：tidesdk

我正在尝试使用 TideSDK 1.3.1-beta 在我的桌面应用程序中使用服务器发送事件。通过基于 webkit 的浏览器查看的代码在 localhost 上运行完美，但是通过 TideSDK 运行程序时，什么也没有发生。

我正在使用的 Javascript 是这样的：

```
<script>
var source=new EventSource("demo_sse.php");
source.onmessage=function(event)
{
 document.getElementById("result").innerHTML+=event.data + "<br>";
 alert(event.data);
}
</script> 
```

demo_sse.php 页面如下所示：

```
<?php
header('Content-Type: text/event-stream');
header('Cache-Control: no-cache');

$time = date('r');
echo "data: The server time is: {$time}\n\n";
flush();
?> 
```

我知道这不仅仅是一些愚蠢的错误，因为就像我说的，它在浏览器中完美运行，但是当通过 TideSDK 运行时，什么也没有发生。我解决这个问题非常重要。如果有人可以提供任何见解，请告诉我。

PS：我注意到一些奇怪的事情：如果我在 EventSource 中使用“app”作为协议，例如`EventSource("app://demo_sse.php");`程序在控制台输出有关预处理`demo_sse.php`文件的行之前立即崩溃。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-24T11:26:23.860

```
<?php

header('Content-Type: text/event-stream');

header('Cache-Control: no-cache');

$time = date('r');

echo "data: The server time is: {$time}\n\n";

flush();

?>
<script>

var source=new EventSource("demo_sse.php");

source.onmessage=function(event)

{

 document.getElementById("result").innerHTML+=event.data + "<br>";

 alert(event.data);

}

</script> 
```

# java - 从表面视图切换到主要活动类

> ID：13445728
> 
> 赞同：2
> 
> 时间：2012-11-18T23:28:54.567
> 
> 标签：java, android, android-intent, surfaceview

我有一个活动，它使用surfaceview作为其内容视图来绘制一些位图并执行动画，控制开始新一轮事件以在该surfaceview线程中为下一轮加载一组新位图的最佳方法是什么？是从 SurfaceView 线程切换回主游戏活动的最佳方式。到目前为止，我已经尝试过，下面是绘制所有内容的 surfaceview 类的片段。

```
 if(isCollided(i)){

            if(imgList.indexOf(imgList.get(i)) == 0){

                    activity.runOnUiThread(new Runnable() {
                        public void run() {
                            Toast.makeText(context, "Correct!", Toast.LENGTH_SHORT).show();
                            Intent i = new Intent(context, AnimeAction.class);
                            context.startActivity(i);
                        }});

            } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T13:43:40.440

你不应该这样做：

```
MainActivity activity = new MainActivity(); 
```

而是试试这个：

```
MainActivity activity = MainActivity.this; 
```

就发布一组新的位图而言，我在我的应用程序中这样做了：

```
public class OurView extends SurfaceView implements Runnable
    {
        Thread t=null;
        SurfaceHolder holder;
        boolean ok;

        public OurView(Context context)
        {
            super(context);
            holder=getHolder();

        }
        public void run()
        {
                  //draw the bitmaps
                } 
            public void pause()
        {
            ok=false;
            Log.v("pause()", "ok=false");
            while(true)
            {
                try{

                    t.join();

                }
                catch(InterruptedException e)
                {
                    Log.v("pause()",e.toString());
                }

                break;
            }
           t=null;

        }
        public void resume()
        {
            ok=true;
            if(t==null)
            {
             t=new Thread(this);
               t.start();
               Log.v("resume()", "new thread started");
            }
            else
            {
                Log.v("resume()", "new thread not started as t!=null");
            }
        }
} 
```

在活动的`onResume()`和`onCreate()`：

```
@Override
    protected void onPause() {
        // TODO Auto-generated method stub
        super.onPause();
        Log.v("onPause()", "super.onPause()");
        v.pause();  //V IS AN OBJECT OF THE CLASS OurView

    }
    @Override
    protected void onResume() {
        // TODO Auto-generated method stub
        super.onResume();
        Log.v("onResume()", "super.onResume()");
        v.resume();
      } 
```

我是从这个视频中学到的（以及随后的 1.28 -1.33） - [http://youtube.com/watch?v=Z2YogvILjvo](http://youtube.com/watch?v=Z2YogvILjvo)

# xcode4.5 - 尝试在 Xcode 4.5 中添加视频时收到 SIGABERT 消息

> ID：13445729
> 
> 赞同：0
> 
> 时间：2012-11-18T23:29:04.610
> 
> 标签：xcode4.5

首先要说我是一个完全编码的菜鸟，所以我可能正在尝试做一些超出我知识水平的事情。我上网并寻找将视频添加到 x-code 程序的代码。我尝试了各种不同的在线教程，但都没有奏效。我起初尝试将它编程到 Xcode 4.2 中，但无济于事。然后我下载了最新版本 4.5

构建在 iphone6 模拟器中成功，但随后无法实际运行。

我收到的错误消息是 SIGABERT：- *** 由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“*** -[NSURL initFileURLWithPath:]: nil string parameter”

我的头文件是：-

```
#import UIkit/UIkit.h (with the smaller than larger than symbols)

#import MediaPlayer/MediaPlayer.h (with the smaller than larger than symbols)

@interface ViewController :UIViewController {

}

-(IBAction)playvideo;

@end 
```

我的实现文件是：-

```
#import "ViewController".h
#import <UIKit/UIKit.h>

@implementation ViewController

-(IBAction)playvideo {
 NSURL *url = [NSURL fileURLWithPath:
              [[NSBundle mainBundle] pathForResource:@"jamcookvid1" ofType:@"mv4"]];

 MPMoviePlayerViewController *playercontroller =
 [[MPMoviePlayerViewController alloc] initWithContentURL:url];

[[self navigationController]presentMoviePlayerViewControllerAnimated:
 playercontroller];
playercontroller.moviePlayer.movieSourceType = MPMovieSourceTypeFile;

[playercontroller.moviePlayer play];
// [playercontroller release];
playercontroller = nil;

}

@end 
```

如果你们中的任何人可以帮助我 - 将不胜感激。JB

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T23:48:54.937

您的文件可能不存在于应用程序包中……或者拼写不准确。尝试记录`[[NSBundle mainBundle] pathForResource:@"jamcookvid1" ofType:@"mv4"]`. 您可能会发现它`nil`可以解释该消息。

# java - AndEngine 致命错误

> ID：13445730
> 
> 赞同：0
> 
> 时间：2012-11-18T23:29:10.807
> 
> 标签：java, android, andengine

刚从 Andengine 开始。我使用[这个博客](http://jimmaru.wordpress.com/2012/04/23/setting-up-andengine-gles2-0/#comment-358)来安装基本的`AndEngine`，一切似乎都可以正常工作，直到我尝试从博客运行我的基本 Hello world 应用程序。这是代码和错误日志。任何帮助表示赞赏。

**日志**

```
11-18 14:18:26.484: E/AndroidRuntime(19380): FATAL EXCEPTION: main
11-18 14:18:26.484: E/AndroidRuntime(19380): java.lang.RuntimeException: Unable to   instantiate activity ComponentInfo{com.example.and/com.example.and.MainActivity}: java.lang.ClassNotFoundException: com.example.and.MainActivity in loader dalvik.system.PathClassLoader[/data/app/com.example.and-2.apk]
11-18 14:18:26.484: E/AndroidRuntime(19380):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1569) 
```

**代码**

```
package com.example.and;

 import org.andengine.engine.camera.Camera;
 import org.andengine.engine.options.EngineOptions;
 import org.andengine.engine.options.ScreenOrientation;
 import org.andengine.engine.options.resolutionpolicy.RatioResolutionPolicy;
 import org.andengine.entity.scene.Scene;
 import org.andengine.entity.scene.background.Background;
 import org.andengine.ui.activity.SimpleBaseGameActivity;

public class TestActivity extends SimpleBaseGameActivity {

static final int CAMERA_WIDTH = 800;
static final int CAMERA_HEIGHT = 480;

@Override
public EngineOptions onCreateEngineOptions() {
    Camera mCamera = new Camera(0, 0, CAMERA_WIDTH, CAMERA_HEIGHT);
    return new EngineOptions(true, ScreenOrientation.LANDSCAPE_SENSOR,
        new RatioResolutionPolicy(CAMERA_WIDTH, CAMERA_HEIGHT), mCamera);
}

@Override
protected void onCreateResources() {
    // TODO Auto-generated method stub
}

@Override
protected Scene onCreateScene() {
    Scene scene = new Scene();
    scene.setBackground(new Background(0.09804f, 0.6274f, 0));
    return scene;
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T23:41:30.383

确保您的活动在您的清单文件中声明

# javascript - 文本鼠标上的javascript图像弹出

> ID：13445731
> 
> 赞同：1
> 
> 时间：2012-11-18T23:29:19.433
> 
> 标签：javascript, jquery

当我使用 JavaScript 和 jQuery 将鼠标悬停在一些 HTML 文本上时，我希望弹出图像。有多行，每行应该弹出一个不同的图像。我不是指实际的弹出窗口，只是在屏幕上弹出或爆炸的图像。

因此，如果我的 html 代码如下所示：

```
<p id="item1">item1 text</p>
<p id="item2">item2 text</p>
<p id="item3">item3 text</p> 
```

当我将鼠标悬停在 HTML 页面上的文本“item1 text”上时，我希望在文本上弹出一个名为“image1”的图像。我还希望弹出窗口在图片上方包含一些文本。当我将鼠标指针从 item1 文本上移开时，弹出窗口应该消失。同样，当我将鼠标悬停在“item2 text”上时，应该会弹出 image2。

我如何使用 JavaScript 做到这一点，那么我将如何使用 jQuery 做得更好？

我是一个完整的 JavaScript 和 jQuery 新手，对于我缺乏知识提前抱歉。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-19T01:47:08.517

嗨，我找到了这个优秀的教程：[jQuery for Absolute Beginners](http://blog.themeforest.net/screencasts/jquery-for-absolute-beginners-video-series/)，他使用`<a>`了 html 代码的标签，他是这样做的：http: [//jsfiddle.net/k2E7W/2/](http://jsfiddle.net/k2E7W/2/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T23:33:43.927

看看优秀的[jQuery 插件 Powertip](http://stevenbenner.github.com/jquery-powertip/)，它将为您省去很多麻烦。通常，这种 mouseover / mouseout - 关于跨浏览器兼容性和定位的事情有点棘手。

然后代码看起来像

```
$('#element')
    .data('powertipjq', $('<p>Some text</p><img src="yourImage.png" />'));
    .powerTip({
        placement: 'e',
        mouseOnToPopup: true
    }); 
```

# java - Java - 方法与构造函数参数

> ID：13445733
> 
> 赞同：5
> 
> 时间：2012-11-18T23:30:22.767
> 
> 标签：java

我最近一直在考虑以下设计考虑：假设我有一个能够读取文件并返回一些结果的对象。你会说这个对象应该暴露一个接口吗：

```
void readFromFile(File file); 
```

或者你会设计它有一个方法

```
void readFromFile(); 
```

并在构造函数中提供必要的值？如果我们想为构造函数设置多个参数并使用构建器根据某些用户偏好构建文件读取器，则第二个选项似乎很好......你怎么看？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-18T23:34:57.450

这取决于对象的更广泛的上下文。

如果您的对象是高度内聚的，即它的目的范围很窄，主要是从特定文件中读取，那么它应该在构造函数中定义。就 OO 设计而言，高内聚通常是一件好事——所以我通常倾向于这个选项。如果您的应用程序是多线程的，因此您的对象需要是线程安全的，那么我肯定会倾向于这一点——我认为这种方法可以更容易地构建粒度、不可变的对象，这在试图避免时很有帮助种族危险。

如果您的对象负责许多其他任务，那么您真的不需要担心并发性，并且将文件作为实际对象状态的一部分包含在内没有任何意义，那么采用的方法该参数可以说是最佳选择。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-18T23:37:11.667

我认为这是一个关于你的对象代表什么的问题。

您应该想知道在没有文件的情况下拥有对象模型的实例是否有任何意义。

想想你的对象的责任，使用“把对象带到沙漠”的方法：试着想想你的对象是什么，它应该知道什么。到时候你就会有答案了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-18T23:47:55.420

第一个解决方案是最干净的。

但是，在处理多线程时有很大的不同。

两种情况：

**你的类应该被实例化一次：**

如果您的对象不是不可变的并且拥有`file`作为字段的对象，则必须进行大量同步（锁定）以避免意外。

**你的类应该被实例化 N 次**

N 次线程 => 可能需要大量内存，具体取决于您的要求和实例的权重。

* * *

因此，API`void readFromFile(File file);`更适合，因为`file`它对每个线程都是本地的。

实际上，如果您的类拥有很多操作`file`对象的方法，并且并发和内存空间不是主要优先级，那么请`file`创建实例的字段。这将清理您的代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-18T23:37:21.890

这真的取决于这个对象将被用在哪里——如果这是一个只有一个或两个文件被读取的程序，并且它们被读取了很多次，那么第二个选项会更好；在几乎所有其他情况下，第一个会占上风，因为您可以使用单个对象来读取多个文件。

再说一次，如果您打算在许多程序中使用这个类（甚至分发它），因此事先不确定哪种方法是最好的，那么没有理由不能同时包含两个 - 有两个构造函数（一个默认一个，一个带文件的），然后包含上面列出的两种方法-这样该类就可以在任何一种类型的程序中有效地使用。

IE

```
public class YourFileReader() {
    File defaultFile;

    public YourFileReader() {
        //initialize
    }

    public YourFileReader(File aDefault) {
        defaultFile = aDefault;
        //initialize
    }

    public void readFromFile() {
        if(defaultFile!=null) {
            //read from defaultFile
        }
        else {
            //exception?
        }
    }

    public void readFromFile(File file) {
        //read from file
    }
} 
```

# regex - 使用一系列“else”参数创建正则表达式

> ID：13445735
> 
> 赞同：0
> 
> 时间：2012-11-18T23:30:55.867
> 
> 标签：regex, firefox, firefox-addon

我想创建一个匹配一个单词的正则表达式，如果它找到它。如果它没有找到我希望它尝试匹配第二个单词的单词。我想对第三个和第四个单词重复这个过程。

我需要一个“其他”指令。我尝试`(?(?=regex)then|else)`了在[http://www.regular-expressions.info/conditional.html](http://www.regular-expressions.info/conditional.html)找到的方法，但没有成功。我把它写成，`(?(?=1080)1080|720)`但它甚至不被认为是一个有效的表达。

注意：我正在从网站下载视频，我想下载最高质量的视频。我正在使用 Firefox 附加组件 DownThemAll，它允许用户使用正则表达式创建自定义过滤器。具体来说，我想要一个匹配单词的表达式`1080`，如果没有找到它尝试匹配`720`，如果它没有找到它尝试匹配`540`，如果它没有找到它尝试匹配`480p/download`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T23:34:51.847

你所需要的只是[交替](http://www.regular-expressions.info/alternation.html)：

```
1080|720|540|480p/download 
```

引擎将尝试匹配最左边的模式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T23:35:27.573

我猜 DownThemAll 使用的正则表达式引擎（可能是 JavaScript）不支持此功能（正如您在链接的文章中看到的那样，只有 Perl、PCRE 和 .NET 支持）。

但是，在大多数引擎中，应从左到右尝试[替代方案。](http://www.regular-expressions.info/alternation.html)所以这应该这样做：

```
(1080|720|540|480)p/download 
```

# mysql - Rails Simple_Form 在数据库中将值保存为 NULL

> ID：13445739
> 
> 赞同：0
> 
> 时间：2012-11-18T23:31:49.733
> 
> 标签：mysql, ruby-on-rails, devise, simple-form

所以我是 Rails 的新手，我一直在尝试根据当前用户创建一个非常简单的待办事项列表。到目前为止，我已经使用 Devise 处理了身份验证，并使用 simple_form gem 呈现了表单。在我尝试向数据库添加新任务之前，一切正常。出于某种原因，当我提交表单时，它会将 NULL 输入到 db 列中（当然除了增加的 id 列）......这就像值在传输中丢失或一些奇怪的东西一样。无论如何，这就是我所拥有的：

控制器：

```
class TodoController < ApplicationController
  before_filter :authenticate_user!

  def index
    @todo_list = Todo.where("user_id = ?", current_user.id).all
    @task = Todo.new
  end

  def create
    @todo_list = Todo.all
    @task = Todo.new(params[:task])
    if @task.save
      flash[:notice] = "Task Added"
      redirect_to todos_path
    else
      render :action => 'index'
    end
  end

  def destroy
    @todo_list = Todo.find(params[:id])
    @task.destroy
    flash[:notice] = "Task Deleted"
    redirect_to todos_path
  end
end 
```

模型：

```
class Todo < ActiveRecord::Base
  belongs_to :users
  attr_accessible :user_id, :task_name, :task_description
end 
```

看法：

```
<h2>To Do List</h2>
<%= render :partial => 'form' %>

<div class="span11">
<table class="table table-condensed table-striped">
      <thead>
      <tr>
          <th>Task</th>
          <th>Description</th>           
      </tr>
  </thead>   
  <tbody>
  <% @todo_list.each do |todo| %>
    <tr>
        <td><%= todo.task_name %></td>
        <td><%= todo.task_description %></td>
        <td><%= link_to("Delete", todos_path, :confirm => 'Delete task?', :method => :delete, :class => 'btn btn-mini') %></td>
    </tr>
  <% end %>
</table>
</div> 
```

_form.html.erb：

```
<%= simple_form_for @task, :url => todos_path, :method => :post do |f| %>
    <%= f.error_notification %>
    <%= f.input :task_name, :as => :string %>
    <%= f.input :task_description, :as => :string  %> 
    <%= f.button :submit, :class => 'btn btn-success' %>
<% end % 
```

这可能是非常简单的事情，我似乎无法发现它。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T05:35:33.323

在控制器的创建方法中，参数不应该是

```
params[:todo] 
```

而不是

```
params[:task] 
```

该参数的名称由您的实例的模型名称决定，而不是您为变量命名的名称。

没有什么是致命的，但命名具有不同模型的实例变量并不是最好的做法，以后可能会导致很多混乱。

# java - Java构造函数中的最终参数

> ID：13445740
> 
> 赞同：3
> 
> 时间：2012-11-18T23:31:56.320
> 
> 标签：java, constructor, final

我正在学习 Java 中的类和构造函数。我在一个示例程序中弄乱了代码，似乎无法弄清楚到底发生了什么。

这段代码无法编译，这对我来说很有意义：

```
class Line {
Point start;
Point end;

Line(final Point start, final Point end) {

    this.start = new Point(start);
    this.end = new Point(end);
    start = new Point(0.4, 0.4);

}... 
```

我试图通过调用 Point 对象的构造函数将原始起始点对象引用分配给另一个 Point 对象。final 关键字与此冲突。

但是，当我从 Point start 参数中删除 final 关键字时...

```
class Line {
Point start;
Point end;

Line(Point start, final Point end) {

    this.start = new Point(start);
    this.end = new Point(end);
    start = new Point(0.4, 0.4);

} 
```

它似乎并没有真正改变引用，传递给 Line 构造函数的 Point 对象似乎仍然指向原始对象，并且 Line 构造函数的代码没有改变。那么给了什么？这是否与所指的“开始”在 Line 构造函数的范围内是本地的事实有关？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-18T23:36:20.987

Java 不使用按引用传递，它始终使用按值传递。实际上，Java 中的引用类型只是指针，与 C# 中的引用完全不同。

因此，当您在构造函数中执行此语句时：

```
start = new Point(0.4, 0.4); 
```

原始`Point`传入参数没有改变。但是，局部变量（即参数）将指向新`Point`定义的坐标：`0,4, 0,4`。

为了更好地理解，请阅读这篇文章：[Java is Pass-by-Value, Dammit！](http://javadude.com/articles/passbyvalue.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T23:36:35.673

该变量是构造函数的本地变量。因此，在构造函数之外为其分配一个新的引用没有意义，因为它在构造函数之外不存在。

实现这种效果的一种方法是将其包裹在另一个对象中。并传递对可变包装器的引用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-18T23:36:39.363

> 它似乎并没有真正改变参考

您不能更改用于在该方法本身内部调用方法的参数的引用。参数的值（它是对对象的引用）被复制到方法参数中，因此您对同一对象有第二个引用。在方法内部，您只能修改第二个引用，而不能更改原始引用。您唯一能做的就是修改引用的对象。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-18T23:38:28.493

当您执行“start = new Point(0.4, 0.4);”时，您将引用在构造函数中接收到的开始。由于构造函数将其定义为 final，因此为变量分配新值是非法的。

细节是，由于java使用按值传递的方法，即使您不使用final并更改构造函数内部的值，原始值（您作为参数传递给方法的值）的值仍然是相同。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-19T00:30:39.847

当您在从“Line(Point start, final Point end) {”初始化后通过执行“this.start = new Point(start)”来修改“start”时，您并没有替换“start”指向的堆上的实际对象到但在与现有的不同区域的堆上分配新的 Point 对象，并修改现有的指针“start”（STACK 上的标量类型）以指向新分配的。

构造函数是一种特殊用途的方法（函数），在java堆上分配对象后由java的new操作符调用。所以当一个方法被调用时，堆栈被分配并且任何标量类型（在java中它是原始类型，如int，double，char ...）和方法中的REFERENCE被分配在堆栈（而不是堆）上。当您将语句编写为“final Object o = new Object()”时，您已经在内存上分配了两件事。
首先，Java 堆上的“new Object()”。（HEAP）
其次，指向堆栈中的上方的指针，即“Object o”。（堆栈）
在您的情况下，您只是试图覆盖标量类型的“final Object o”，并且只在 jvm 内存（堆栈）上读取。

```
class Line {
Point start;
Point end;

// On the first line "Line(Point start, Point end) {",
// two references and two actual Objects that references point to
// are already allocated in memory.  
// So you've allocated four things.
Line(Point start, final Point end) { // "start" initialized on stack as final
    this.start = new Point(start); // tried to modify final variable on stack.
    this.end = new Point(end);
    start = new Point(0.4, 0.4);

} 
```

# c++ - 苹果和 shared_ptr

> ID：13445742
> 
> 赞同：15
> 
> 时间：2012-11-18T23:31:59.217
> 
> 标签：c++, macos, shared-ptr

我似乎在这里遗漏了一些东西。我从`boost::shared_ptr`搬到`std::shared_ptr`. `shared_ptr`早在 2000 年代中期，它就是 TR1 的一部分，它应该在 2012 年随处可见。

尝试`shared_ptr`在 Apple 下使用会得到大量未定义的引用：

```
SecureArray.h:26:12: error: no member named 'shared_ptr' in
      namespace 'std'
using std::shared_ptr;
      ~~~~~^
SecureArray.h:27:12: error: no member named 'tr1' in namespace
      'std'
using std::tr1::shared_ptr;
      ~~~~~^
SecureArray.h:487:5: error: unknown type name 'shared_ptr'
    shared_ptr<SecureVector> m_vector; 
```

一个典型的编译器命令如下（GCC 和 Clang 都失败）：

```
clang++ -g2 -ggdb -O0 -fcatch-undefined-cxx0x-behavior
  -DSAFEINT_DISALLOW_UNSIGNED_NEGATION=1 -pipe -std=c++0x -Wall -Wextra
  -Wno-unused-parameter -Wno-tautological-compare 
  -I. -I./esapi -I./deps -I/usr/local/include -I/usr/include -fpic
  -c src/DummyConfiguration.cpp -o src/DummyConfiguration.o 
```

我试图将它包括如下（我相信我需要对此进行调整，但我不记得 C++ 语法说“看这里，或者看那里”）：

```
#include <memory>
using std::shared_ptr;
using std::tr1::shared_ptr; 
```

Apple 的手册页没有显示任何内容：

```
$ man shared_ptr
No manual entry for shared_ptr
$ man -k shared_ptr
shared_ptr: nothing appropriate 
```

我安装了 Mac OS X 10.8（完全补丁）、Xcode（完全补丁）和命令行工具。

那么如何在 Apple 平台上使用 std::shared_ptr 呢？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-11-19T01:33:36.413

`#include <tr1/memory>`将与使用 libstdc++ 的任一编译器一起使用。或者，使用 Clang：

```
#include <memory>
using std::shared_ptr; 
```

并用`c++ -std=c++11 -stdlib=libc++ ...`. 我不知道为什么 Clang 默认使用 libstdc++；大概是为了 GCC 兼容性。

您找不到手册页，因为 libstdc++ 没有手册页。有帮助，不是吗。源代码分发中有 HTML 文档。

# php - Facebook if($user) 命令不了解用户的状态

> ID：13445747
> 
> 赞同：0
> 
> 时间：2012-11-18T23:33:02.403
> 
> 标签：php, facebook, wordpress

我正在尝试检查用户是否在 wordpress 上接受了我的应用程序，并且正在使用默认的 wordpress 链接，例如：example.com/?p=15 但不在 seo 网址中，例如：example.com/postname

我在用着：

```
$user = $facebook->getUser(); 
if ($user) {........ 
```

但似乎使用 wordpress 永久链接它无法检查用户的状态，知道吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T08:04:43.913

首先检查您的 wordpress 生成的所有 url 是否都在 app canvas url 下。然后检查您是否将 $facebook 变量作为 facebook 库的实例启动，如下所示：

```
 require_once("facebook.php");

  $config = array();
  $config[‘appId’] = 'YOUR_APP_ID';
  $config[‘secret’] = 'YOUR_APP_SECRET';
  $config[‘fileUpload’] = false; // optional

  $facebook = new Facebook($config); 
```

# c# - 如何制作公共数组？

> ID：13445748
> 
> 赞同：-3
> 
> 时间：2012-11-18T23:33:17.627
> 
> 标签：c#, arrays, sqlite

我在将数组 Energy[] 设置为 public 时遇到问题。我需要在 Timer_Tick 事件中使用数组。我已将数组设置为 int 并试图将它们公开但没有成功。

这是代码：

```
using System;
using System.Windows.Forms;
using System.Collections.Generic;
using System.Linq;
using System.Data;
using System.Data.SQLite;

namespace Project
{
    public partial class FrmGame : Form
    {
        private string team;
        private string p;
        private List<DataGridViewRow> selected;
        public FrmPartida(string team, List<DataGridViewRow> selected)
        {
            this.selected = selected;
            InitializeComponent();
            this.team = team;

            this.ProgressBar.Value = 0;
            this.timer1.Interval = 100;
            this.timer1.Enabled = true;

            try
            {
                SQLiteConnection ocon = new SQLiteConnection(Config.stringConnect);
                dataSet1.Clear();
                SQLiteDataAdapter a = new SQLiteDataAdapter("Select * From players WHERE Teamplayers = '" + team + "'", ocon);
                a.Fill(dataSet1, "players");
            }
            catch (SQLiteException)
            {
                MessageBox.Show("There was an error");
            }

            Statistics(dataSet1, time);
        }

        public void Statistics(DataSet dataset, string team)
        {
            SQLiteConnection ocon = new SQLiteConnection(Config.stringConnect);
            DataTable table1 = dataset.Tables[0];

            string[] PlayerName = new string[6];
            int[] Strength = new int[6];
            int[] Energy = new int[6];
            try
            {
                if (tabela1.Rows.Count != 0)
                {
                    players = selected.Select(r => r.Cells[1].Value.ToString()).Take(6).ToArray();
                }
                if (table1.Rows.Count != 0)
                {
                    Strength = selected.Select(r => int.Parse(r.Cells[3].Value.ToString())).Take(6).ToArray();
                }
                if (table1.Rows.Count != 0)
                {
                    Energy = selected.Select(r => int.Parse(r.Cells[3].Value.ToString())).Take(6).ToArray();
                }

                int time = int.Parse(timer1.Interval.ToString());
                int count = int.Parse(ProgressBar.Value.ToString());
                int Strength1 = Strength[0], Strength2 = Strength[1], Strength3 = Strength[2], Strength4 = Strength[3], Strength5 = Strength[4], Strength6 = Strength[5];
                int Energy1 = Energy[0], Energy2 = Energy[1], Energy3 = Energy[2], Energy4 = Energy[3], Energy5 = Energy[4], Energy6 = Energy[5];
                int PlayerStatistics1, PlayerStatistics2, PlayerStatistics3, PlayerStatistics4, PlayerStatistics5, PlayerStatistics6;

                if ((count / 4) == time)
                {
                    for (Energy1 = 100; Energy1 > 1; Energy1--)
                    {
                        PlayerStatistics1 = Strength1 * Energy1 * time;
                    }
                }
                PlayerStatistics1 = Strength1 * Energy1 * time;
                PlayerStatistics2 = Strength1 * Energy1 * time;
                PlayerStatistics3 = Strength1 * Energy1 * time;
                PlayerStatistics4 = Strength1 * Energy1 * time;
                PlayerStatistics5 = Strength1 * Energy1 * time;
                PlayerStatistics6 = Strength1 * Energy1 * time;

                if (this.ProgressBar.Value == 180)
                {
                    MessageBox.Show(""+Energy1+"");
                }
            }
            catch (SQLiteException)
            {
                MessageBox.Show("There was an error");
            }
        }

        public void timer1_Tick(object sender, EventArgs e) 
        {
            if (this.BarraTempo.Value < 180)
            {
                this.BarraTempo.Value++; 
                if (BarraTempo.Value == 180)
                {
                    MessageBox.Show(""+Energy1+"" ); //"Energy1" needs to appear on this messagebox. 
                    FrmBreak f1 = new FrmBreak(this.time, selected);
                    f1.ShowDialog();
                    this.Hide();
                }
            }
            else
            {
                ProgressBar.Enabled = false;
            }
        }    
    }
} 
```

如果有人知道如何解决这个问题，请告诉我。

谢谢，

詹卢卡。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T23:37:42.993

它看起来像`Energy`一个局部变量。局部变量没有访问修饰符，因为只有方法执行才能访问它们。考虑将其改为一个字段，`team`例如`selected`。

一些旁注：遵循命名约定，变量以小写字母开头，例如`energy`. 此外，一旦您将其设为字段，则无需将其设置为其他任何内容，`private`除非您只需要类中的另一个方法来访问它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T11:00:04.860

因为您的`Energy`数组是在函数内部声明的，所以它只能从该函数内部访问，即它不存在于`public void Statistics`.

要使数组公开，您需要在类的开头声明它，如下所示：

```
using System;
using System.Windows.Forms;
using System.Collections.Generic;
using System.Linq;
using System.Data;
using System.Data.SQLite;

namespace Project
{
    public partial class FrmGame : Form
    {
        private string team;
        private string p;
        private List<DataGridViewRow> selected;

        //Declare the array here with the public access modifier***
        public int[] Energy = new int[6];

        public FrmPartida(string team, List<DataGridViewRow> selected)
        {
            //Code removed for clarity
        }

        public void Statistics(DataSet dataset, string team)
        {
            //Code removed for clarity
        }

        public void timer1_Tick(object sender, EventArgs e) 
        {
            //Code removed
        } 
    }
} 
```

也就是说，与其将其声明为公共字段，不如考虑使用[访问器](http://msdn.microsoft.com/en-gb/library/ms228503.aspx)（“get”方法）。

# c# - smtp 服务器需要身份验证，但我相信它已经拥有它

> ID：13445751
> 
> 赞同：4
> 
> 时间：2012-11-18T23:33:45.863
> 
> 标签：c#, asp.net-mvc

当我到达以下代码块的最后一行时，我收到一条消息说服务器需要身份验证。

```
MailMessage message = new MailMessage();
message.From = new MailAddress("me@myemail.co.uk");

message.To.Add(new MailAddress("me@myToAddress.co.uk"));

message.Subject = "Message subject";
message.Body = "This is the content";

SmtpClient client = new SmtpClient();
client.Send(message); 
```

但是，我认为我已经在 webconfig 中提供了它所需的信息，如下所示：

```
<mailSettings>
  <smtp from="me@myemail.co.uk">
    <network host="mySMTPserver" port="25" userName="myEmail" password="myPass" />
  </smtp>
</mailSettings> 
```

非常感谢任何建议，我在这里阅读了很多帖子，他们似乎都以相同的方式提供登录。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T23:56:43.563

有两件事要尝试：

SET client.UseDefaultCredentials = false

设置端口：

```
 client.Port = 587 
```

这些属性也可以在 .config 文件中设置

要了解为什么 587，请参阅 [http://mostlygeek.com/tech/smtp-on-port-587/](http://mostlygeek.com/tech/smtp-on-port-587/)

# r - 强制 ggplot2 散点图为方形

> ID：13445753
> 
> 赞同：59
> 
> 时间：2012-11-18T23:33:53.327
> 
> 标签：r, ggplot2, scatter-plot

`xlim()`我可以使用and强制 ggplot2 散点图为方形，具有相同的 x 和 y 缩放比例`ylim()`，但它需要手动计算限制。有没有更方便的方法呢？

方形我的意思是两个要求：

1.  x 和 y 轴上的比例相同。
2.  x 和 y 轴的长度相等。

* * *

## 回答 #1

> 赞同：66
> 
> 时间：2012-11-19T01:18:20.623

如果要使距离刻度点相同，请使用[coord_fixed()](http://docs.ggplot2.org/current/coord_fixed.html)：

```
p <- ggplot(...)
p <- p + coord_fixed() # ratio parameter defaults to 1 i.e. y / x = 1 
```

如果要确保结果图是正方形的，则还需要将 x 和 y 限制指定为相同（或至少具有相同的范围）。`xlim`并且`ylim`都是`coord_fixed`. 因此，您可以使用这些参数手动执行此操作。或者您可以使用函数从数据中提取限制。

* * *

## 回答 #2

> 赞同：64
> 
> 时间：2016-03-10T09:29:20.887

注意：对于*正方形*（与绘制的数据无关），

```
ggplot() + theme(aspect.ratio=1) 
```

[![在此处输入图像描述](../Images/93bcb4d191e7d33d9586ab2fd8eff522.png)](https://i.stack.imgur.com/XL1wk.png)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2016-01-28T22:55:38.123

可能是您今天看到的最丑陋的代码，但它确实有效。

您的 x 和 y 轴的范围可从以下位置访问`ggplot_build`：

```
r<-max(abs(ggplot_build(your_plot)$panel$ranges[[1]]$x.range))
s<-max(abs(ggplot_build(your_plot)$panel$ranges[[1]]$y.range))
t<-round(max(r,s),1)
your_plot<-your_plot+coord_equal(xlim=c(-t,t),ylim=c(-t,t)) 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2019-11-07T14:31:21.300

之前答案中提供的所有解决方案都不适用于我的 R 版本：R 版本 3.6.1。

```
ggplot_build(pot)$panel$ranges[[1]]$x.range # return NULL value 
```

@Gerhard Burger 在[链接 URL](https://stackoverflow.com/questions/7705345/how-can-i-extract-plot-axes-ranges-for-a-ggplot2-object/35372274#35372274)中提到的解决方案适用于我的情况：

```
r<-max(abs(layer_scales(plt)$x$range$range))
s<-max(abs(layer_scales(plt)$y$range$range))
t<-round(max(r,s),1)
plt<-plt+coord_equal(xlim=c(0,t),ylim=c(0,t)) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-10-26T12:01:08.640

基于拉蒙斯的回答，这个函数对我来说很好用，我认为它并不难看，因为可以隐藏函数定义......

```
squarePlot <- function(plt){
    return(plt+coord_equal()+
            expand_limits(x=ggplot_build(plt)$panel$ranges[[1]]$y.range,
                          y=ggplot_build(plt)$panel$ranges[[1]]$x.range))
} 
```

只是将 Ramon 的代码包装在一个函数中对我来说不起作用，因为 t 变量是在“错误”环境中定义的。

# layout - 防止并排文本块重叠

> ID：13445756
> 
> 赞同：0
> 
> 时间：2012-11-18T23:34:09.200
> 
> 标签：layout, grid, textblock, windows-store-apps, overlapping

我正在尝试开发一个 Windows 商店应用程序，但我遇到了问题。请记住，我是新手。

在标题部分，我试图让我的标题在左边，在右边（在同一行）有一个小文本。我放置了一个两列网格，并在每列中放置了一个文本块。这里的结果是两个文本块重叠，这不是我想要的。这是代码：

```
<Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="600*" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            <TextBlock Text="{StaticResource AppName}" Style="{StaticResource txtHeaders}" />
            <TextBlock Text="Text on the right" Style="{StaticResource txtHeaders}" />
</Grid> 
```

谁能帮我吗？

此外，样式 txtHeaders 仅定义文本颜色，仅此而已。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T21:11:52.033

只是为了记录，第二个文本块被放置在与第一个相同的列中。要将其移至第二个，请使用 grid.column = "1"。因此，第二个文本块将如下所示：

# c# - 检查两个 URL 是否相等

> ID：13445758
> 
> 赞同：6
> 
> 时间：2012-11-18T23:34:16.360
> 
> 标签：c#, url

> **可能重复：**
> [检查 2 个 URL 是否相等](https://stackoverflow.com/questions/1222610/check-if-2-urls-are-equal)

有时输入网址的方式有所不同，但最后它们是等效的。例如，可以将大写字母转换为小写字母并在末尾添加正斜杠，或者可以删除 url。例如，这两个 URL 是等效的：

*   www.myUrl.com
*   [http://www.myURL.com/](http://www.myURL.com/)

我想知道确保两个 URL 等效的最佳方法是什么？什么条件足以确保两个 url 指向同一个文档？（我正在用 C# 编码，所以很高兴看看是否有一个库也可以做到这一点）

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T23:59:10.840

看看 Uri 库。例如，您可以通过执行以下操作进行比较：

*   [http://msdn.microsoft.com/en-us/library/system.uri.aspx](http://msdn.microsoft.com/en-us/library/system.uri.aspx)

例如：

```
Uri uri1 = new Uri(url1);
Uri uri2 = new Uri(url2);

// Check urls
if (uri1.AbsolutePath == uri2.AbsolutePath)
{
    // Urls match
} 
```

您可能还需要首先考虑进行 URL 规范化：

*   [http://en.wikipedia.org/wiki/URL_normalization](http://en.wikipedia.org/wiki/URL_normalization)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T23:46:57.997

我会使用 Uri 类来检查等效项。

[http://msdn.microsoft.com/en-us/library/system.uri.aspx](http://msdn.microsoft.com/en-us/library/system.uri.aspx)

你`Host`有财产

# wicket - Uploadify 在 Wicket 1.5.8 中损坏（使用 JQWicket）

> ID：13445761
> 
> 赞同：2
> 
> 时间：2012-11-18T23:34:30.230
> 
> 标签：wicket, uploadify, wicket-1.5

这可能对其他人有帮助...

[https://issues.apache.org/jira/browse/WICKET-4715](https://issues.apache.org/jira/browse/WICKET-4715)

在上传任何文件时导致以下错误：

```
ERROR - MultipartFormInputStream   - Error while reading servlet request multi-part data:    
Stream ended unexpectedly. boundary='------------Ij5KM7Ij5Ij5KM7cH2gL6Ef1GI3GI3I3';    
bufSize=4096 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T23:34:30.230

解决方案：升级到 Wicket 1.5.9！

# python - 如何抓取由破折号分隔的句子

> ID：13445769
> 
> 赞同：-4
> 
> 时间：2012-11-18T23:35:37.480
> 
> 标签：python, regex, csv

如果它们被破折号分隔，什么正则表达式会抓住句子（代表语音）？问题是有时这样的句子被插入到正常的句子中，因此两边都用破折号隔开。但其他时候，它们用破折号打开，用句号关闭。更重要的是，破折号并不总是用于衬托口语句子。我需要捕捉的部分放在括号中（对不起，句子是立陶宛语）。

```
[- Dilze, -] šaukė ji be jokios intonacijos, pabrėžtinumo ar skubos, tarsi nesitikėdama atsakymo. [- Dilze!]
Dilzė atsakė ir liovės barškinusi rykais, stovinčiais ant krosnies, bet dar nespėio pereit per virtuvę, kai ponia Kompson pašaukė dar kartą, o kol ji perėjo per valgomąjį ir kyštelėjo galvą į tą pilką lango šviesą, - dar vieną kartą.
[- Einu, einu, -] atsakė Dilzė. [- Aš čia. Pripilsiu ją, kai tik vanduo sušils, -] pasikaišė sijoną ir ėmė kopti laiptais, visai užstodama tą pilką šviesą. [- Padėkit ją antžemės ir grįžkite į lovą.] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T23:47:21.087

在 Python`re`中不支持 Unicode 字符属性，但支持[`regex`](http://pypi.python.org/pypi/regex)。

`regex.findall`与图案一起使用

```
(?m)-\s*\p{Lu}.*?(?:-|[.,!?]\s*$) 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-19T01:34:10.240

在带括号的情况下，我喜欢使用字符串操作而不是正则表达式。

```
>>> text = '''[- here is some text -] here is some not text [- that i want to get -]'''

>>> [sent.split('-]')[0] for sent in text.split('[-') if '-]' in sent]
[' here is some text ', ' that i want to get '] 
```

`text.split('[-')`分割字符串`[-`。列表理解将这些结果输入到第二个拆分中，在对立的括号上拆分。请注意，如果您有“浮动”括号，这将不起作用，但如果您正在操作某人手动输入的标记，这是一个很好、便宜（正则表达式很昂贵）的解决方案。这样，您不必担心安装模块。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-18T23:48:50.707

据我了解，您正在寻找一个匹配任何以点可以是任何行结尾的开头`[-`和结尾的正则表达式。`.]`

正则表达式`\[\-.*?[\-\.\!]\]`执行此操作。该部分`[\-\.\!]`定义了所有可以作为结尾前缀的字符`]`。中间的问号确保正则表达式不是贪婪的，但如果这对您有用，它是特定于正则表达式实现的。

# ruby-on-rails - 如果我正在管理异常，我应该使用中央日志记录吗？

> ID：13445771
> 
> 赞同：0
> 
> 时间：2012-11-18T23:35:56.170
> 
> 标签：ruby-on-rails, logging

我正在运行一些 Rails 应用程序，并且正在使用 exception_notification gem。但我最近发现了一些其他工具，如 Logstash 和 Graylog2 作为中央日志服务器。

我的问题是，这对于小型应用程序来说是否过大，或者无论如何它是一种好的做法（考虑到我已经在管理异常）？

编辑：最终使用[Airbrake](http://airbrake.io/)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T23:37:42.803

如果不是很多努力，我会添加日志记录。这绝对是一种很好的做法，并且是服务的必需品。如果您的应用程序要持续运行，则需要记录日志，以便在发生故障时有一些信息可以使用。

# mysql - 不确定 SQL Select 查询

> ID：13445773
> 
> 赞同：0
> 
> 时间：2012-11-18T23:36:10.657
> 
> 标签：mysql, sql, sql-server

我有 3 个表关系，称为 tblCluster、tblServer 和 tblDatabase。服务器在集群下，数据库在服务器下。tblCluster 中的 PK 是 ClusterName。tblServer 中的 Pk 是 ServerName，FK 是 ClusterName。tblDatabase 中的 PK 是 DatabaseName，FK 是 Servername。如果我想查看 ClusterName 下/来自 ClusterName 的所有 ServerName 和 DatabaseName 是 Cluster5。我应该像这样写查询吗

```
SELECT tblCluster.ClusterName, tblServerName.ServerName, tblDatabase.DatabaseName 
FROM tblCluster 
JOIN tblServer 
ON tblCluster.ClusterName = tblServer.ClusterName 
INNER JOIN tblDatabase 
ON tblServer.ServerName = tblDatabase.ServerName 
WHERE tblCluster.ClusterName = Cluster5; 
```

如果发现 servername 即使数据库为空，我仍然希望它显示 datbasename 为空的结果表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T23:38:27.457

您是否尝试过使用`LEFT JOIN`而不是`INNER JOIN`- 这通常是此类要求的解决方案。[在此处](http://www.tizag.com/mysqlTutorial/mysqlleftjoin.php)查看包含一些示例的更详细说明。

# python - Python 编程 - 抛硬币

> ID：13445774
> 
> 赞同：-2
> 
> 时间：2012-11-18T23:36:12.290
> 
> 标签：python

我正在尝试编写应用程序，该应用程序将模拟抛硬币一定次数，最多 200 次。它必须记录正面的数量和抛的反面的数量，并向用户显示最高数量的正面连续投掷，连续投掷的尾巴数量最多，以及除了所示的正面和反面的百分比。

请不要发表负面评论-刚开始学习python，下面是我的尝试！

```
import random as rn

rolls=int(raw_input("Enter the number of rolls: "))

for rolls in range(rolls): 
    print rn.choice(['H', 'HH', 'HHH', 'T', 'TT', 'TTT']), 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T23:50:54.237

使用`random.choice`每次折腾生成折腾：

```
tosses = ''.join(random.choice('HT') for i in range(rolls)) 
```

您可以简单地计算结果字符串中 H 和 T 的出现次数，以分别获得正面和反面的数量：

```
heads = tosses.count('H')
tails = tosses.count('T') 
```

*最后，您可以通过在另一个*符号上拆分字符串并找到最大的结果子字符串来找到连续的最大正面/反面数量：

```
heads_in_a_row = max(len(s) for s in tosses.split('T'))
tails_in_a_row = max(len(s) for s in tosses.split('H')) 
```

效率不是很高，但它可能会帮助您了解这个想法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T02:34:00.870

令我惊讶的是，到目前为止，这两个答案都采取了一种非常繁重的方法，这种方法非常低效地做很多事情，尤其是在内存使用方面：

*   构造和处理字符串
*   存储输入的冗余副本
*   为计数目的创建多个临时列表和/或字符串。

此外，从运行时的角度来看，这些解决方案都不是特别优雅，也不能很好地解释真正发生或需要通过算法完成的程序方面，这是初学者教学的一个重要方面。

以下方法允许您使用任意大的输入（卷数），因为它不需要保留任何副本。因此，它可以很容易地转换为生成器函数或类似的流处理函数。它也更直接，程序更干净。

```
import random

rolls=int(raw_input("Enter the number of rolls: "))

desc = {0: "H", 1: "T"}
total = [0, 0]
running = [0, 0]
running_max = [0, 0]
last_rolled = None

for roll in xrange(rolls):
    # we use 0 for heads and 1 for tails
    # this will be the index to the relevant list element for our counters
    rolled = random.randint(0,1)
    total[rolled] += 1

    if last_rolled == rolled:
        # we are continuing the run, flipped the same as last time
        running[rolled] += 1
    else: 
        # there has been a break in the run
        if not last_rolled is None: 
            # as long as this isnt the first iteration
            print running[last_rolled] * desc[last_rolled], 
            running[last_rolled] = 0
        running[rolled] = 1

    # update the max count
    running_max[rolled] = max(running_max[rolled], running[rolled])
    last_rolled = rolled

print running[last_rolled] * desc[last_rolled]
print "total rolls: H=%d, T=%d" % tuple(total)
print "running max: H=%d, T=%d" % tuple(running_max) 
```

示例输出：

```
Enter the number of rolls: 20
HH TTTT HH TT HHHHHHH T H T
total rolls: H=12, T=8
running max: H=7, T=4 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-19T01:25:08.280

每当您需要查找连续的事物时，最好考虑`itertools.groupby`. 无论卷数如何，这种方法都需要很少的额外内存

```
from itertools import groupby
import random

rolls = int(raw_input("Enter the number of rolls: "))

tosses = (random.choice('HT') for x in range(rolls))

maxes = {'H': 0, 'T': 0}
sums = {'H': 0, 'T': 0}

for g, v in groupby(tosses):
    n = sum(1 for x in v)
    maxes[g] = max(maxes[g], n)
    sums[g] += n

print maxes['H']
print maxes['T']
print sums['H']*100.0/rolls
print sums['T']*100.0/rolls 
```

# c - 对于我们在 C 中使用 time(NULL) 来生成 =random 值的内容

> ID：13445779
> 
> 赞同：2
> 
> 时间：2012-11-18T23:36:26.150
> 
> 标签：c, time, random

我们在 C 中使用 time(NULL) 来生成随机值是为了什么？`time(NULL)`这段代码中的含义是什么？

```
 int i, zarodek;
    zarodek= time(NULL);
    srand(zarodek);
    int r = rand() % 49 + 1;
    printf("%d",r); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-18T23:39:59.137

它正在获取系统时间（以秒为单位）。您可以选择提供一个指向将接收时间的值的指针，但由于该值无论如何`time_t`都是从函数返回的，您可以改为传递（并且该函数不会尝试分配给空指针）。[`time`](http://en.cppreference.com/w/c/chrono/time)`NULL`

使用的目的`time`是播种随机数生成器（将其传递给`srand`）。使用时间很常见，因为每次运行程序时它通常都不同。

请注意，您应该只播种一次（而不是每次调用`rand`）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-18T23:39:59.573

那就是用当前时间播种随机数生成器。如果不这样做，那么每次运行程序时，都会得到相同的随机数序列。

尝试一下！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-18T23:39:56.317

您可以让 time 返回当前时间，也可以将[指针](http://www.cplusplus.com/time)传递给目标 struct `time_t`。

# android - 意图过滤器中的这个类别是什么意思？

> ID：13445784
> 
> 赞同：3
> 
> 时间：2012-11-18T23:37:10.347
> 
> 标签：android, android-intent, categories

我总是不明白类别在意图过滤器中真正做了什么，尤其是在这种情况下。

```
 <intent-filter>

            <!-- Receives the actual messages. -->
            <action android:name="com.google.android.c2dm.intent.RECEIVE" />
            <!-- Receives the registration id. -->
            <action android:name="com.google.android.c2dm.intent.REGISTRATION" />

            <category android:name="com.androidhive.pushnotifications" />
        </intent-filter> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-19T01:00:11.983

重点`<category>`是根据您的应用程序/包名称过滤传入的 GCM 通知。

GCM 的文档显示`<category android:name="my_app_package" />`并且您必须注册特定的应用程序才能允许 GCM，这是有道理的。

如果您考虑一下，Android 设备上可能有任意数量的已注册 GCM 的应用程序。他们都将使用相同的核心软件接收消息的事实意味着必须有某种方法将消息“路由”到正确的应用程序 - 如果没有办法做到这一点，所有 GCM 注册的应用程序都会收到每个别人的消息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T23:45:35.717

这些是[Google Cloud Messaging](http://developer.android.com/guide/google/gcm/gs.html)服务使用的意图。有关这些过滤器的信息，请参阅 CGM 入门指南中的主题[“编写 Android 应用程序” 。](http://developer.android.com/guide/google/gcm/gs.html#android-app)这是主要信息（尤其是最后一部分）：

> 这个广播接收器负责处理可以由 GCM (`com.google.android.c2dm.intent.RECEIVE`和`com.google.android.c2dm.intent.REGISTRATION`) 发送的 2 个意图，并且应该在清单中定义（而不是以编程方式），以便即使应用程序没有运行也可以接收这些意图。通过设置`com.google.android.c2dm.permission.SEND`权限，您可以确保只有 GCM 系统框架发送的意图被发送到接收者（常规应用程序无法发出具有该权限的意图）。
> 
> 请注意，类别标记中的 android:name 必须替换为应用程序的包名称（并且针对 minSdkVersion 16 及更高版本的应用程序不需要类别标记）。

# ruby-on-rails - 在 Publify 中获取正确的文章 ID 以合并文章

> ID：13445790
> 
> 赞同：1
> 
> 时间：2012-11-18T23:37:57.783
> 
> 标签：ruby-on-rails, ruby, publify

我正在实现一个允许[发布](https://github.com/fdv/publify/)合并两篇文章的功能。在管理页面上，我创建了以下表单（我不确定这是否适合我所追求的），最终应该允许输入另一篇文章的 ID 并将其与当前正在查看的文章合并（应保留评论但应该只有一位作者）。

这个表单应该只有管理员可以查看，但我还没有实现这个逻辑。

```
<%= form_tag({:controller => "admin/content", :action => "merge"}, :method => "put", :class => 'article') do %>
  <%= label_tag(:merge_with, "Article ID") %>
  <%= text_field_tag(:merge_with) %>
  <%= submit_tag("Merge") %>
<% end %> 
```

我还在 admin/content_controller.rb 中创建了以下方法

```
def merge
  @current_article = Article.find(params[:id])
  #(this variable should grab the article ID from the form) @input_article =
  @merged_article = @current_article + @input_article
  return @merged_article  
end 
```

问题是我不确定如何获取从表单输入的文章 ID 并在我的控制器中使用它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T06:07:39.903

它应该在你的参数哈希中，在 params[:merge_with]

无论您想从提交的表单中访问什么字段，它都会显示在您的 params 哈希中，键值是表单上该输入字段的 id。

**编辑：**

根据您那里的代码，当您调用控制器的合并方法时，您的 params[:id] 值也将为 nil，因为当您的 URI 实际需要为“admin”时，它只会是“admin/content/merge” /内容/合并/：id'。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-24T18:35:42.300

由于合并文章表单位于编辑文章页面上，因此 URI 应该已经包含正在编辑的当前文章的 id。

所以你可以像这样从参数哈希中获取它`params[:id]`

# amazon-web-services - cloudControl 插件作为单独的服务

> ID：13445796
> 
> 赞同：2
> 
> 时间：2012-11-18T23:38:55.277
> 
> 标签：amazon-web-services, paas, cloudant, iron.io, cloudcontrol

我在欧洲，正在考虑使用 cloudControl 作为我的云托管平台。在插件方面，我想使用 IronWorker、IronMQ 和 Cloudant。由于使用计量的差异，我的偏好是直接订阅 Iron.io 和 Cloudant，而不是作为插件订阅，前提是我可以将 cloudControl、Iron.io 服务和 Cloudant 正确连接在一起。

我想这不会有任何管理障碍，即如果我单独购买所有这些平台而不是作为 cloudControl 插件购买，所有这些平台都将允许将它们连接到另一个（这是正确的吗？）

我对这些不同服务使用的数据中心（作为插件或单独使用）感到有些困惑。如果我单独订阅这些服务，我担心会失去数据中心的位置。尤其是：

*   我了解 cloudControl 托管在都柏林的 AWS 上。

*   Cloudant 的欧洲数据中心是位于阿姆斯特丹的 SoftLayer。用于 cloudControl 的 Cloudant 插件是托管在那里还是部署在都柏林的 AWS 上，特别是用于 cloudControl？如果我在阿姆斯特丹订阅 Cloudant，我会失败吗？

*   Iron.io 的数据中心位置在哪里？我知道他们在 AWS 和 Rackspace，但没有更多细节我想他们在美国。同样，cloudControl 的插件是否托管在都柏林的 AWS 上，尤其是 cloudControl？我可以订阅 Iron.io 并要求将我的工作人员和队列托管在都柏林吗？或者其他“接近”Cloudant 数据中心的地方？

最终，单独购买这些服务是否可行？

非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T09:37:33.607

从我们这边 (cloudControl) 来看，规则是延迟关键的附加组件必须在欧洲，并且当它们离开 beta 状态时最好在同一个欧盟西部 AWS 区域。

通常您总是可以直接“购买”服务，并且仍然可以结合我们的平台使用它们。唯一的区别是您不会获得合并发票，并且由于缺乏信息，cloudControl 一级支持大多无法真正回答有关未通过附加市场购买的第三方服务的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-19T05:18:14.540

在撰写本文时，IronMQ 托管在 aws-us-east 和 rackspace-dfw 上。IronWorker 托管在 aws-us-east。

我们有其他区域和云的计划，但无法提供明确的时间表。

您可以在我们开发中心的以下页面中找到有关云位置的信息。

*   IronMQ：[http ://dev.iron.io/mq/reference/clouds/](http://dev.iron.io/mq/reference/clouds/)
*   IronWorker：[http ://dev.iron.io/worker/reference/api/](http://dev.iron.io/worker/reference/api/)

您可以直接订阅 Iron.io，尽管我们感谢我们所有的平台合作伙伴。如果您有任何问题，请随时通过我们的实时聊天室或我们的支持渠道与我们联系。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-22T00:49:11.140

我是OP。有趣的是，来自 cloudControl 和 iron.io 的答案让我意识到我一直在做出错误的假设，即 cloudControl 插件必须在 AWS EU-West 上“本地”运行。Iron.io 和 cloudant 附加组件在不同的数据中心上运行的事实是我没想到的。既然这一点很清楚，那么单独购买它们或作为附加组件购买它们不会改变它们的托管位置（并且附加组件的论点确实是支持和共同计费）是完全合理的。

我认为一般来说，PaaS 明确他们的附加组件是否在“本地”运行是有意义的，因为这是一个重要的选择标准。

目前，通过 cloudControl 的 IronWorker+Cloudant 可能不是我的应用程序中数据提升工作人员的理想组合（如果他们都在同一个地方，他们会是完美的！）所以我会以不同的方式托管工作人员。

# jquery - javascript没有在jquery移动页面中加载

> ID：13445799
> 
> 赞同：1
> 
> 时间：2012-11-18T23:39:45.503
> 
> 标签：jquery, ajax, jquery-mobile

我最近通过链接的单独 html 文件构建了我的第一个 jquery 移动网站。按照 jquery mobile 文档中的说明，我在第一页的 head 标记之间加载了所有脚本：

```
<script type="text/javascript" src="http://maps.google.com/maps/api/js?v=3.exp&sensor=true&libraries=places"></script><!--needed only on map.htm-->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
<script src="js/ladot.js"></script><!--all custom script for pages in same js file-->  
<script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>
<script src="http://ajax.aspnetcdn.com/ajax/jquery.validate/1.10.0/jquery.validate.min.js"></script><!--needed only on the two pages with forms that are to be validated--> 
```

我还只加载了每个页面所需的脚本，以便在该页面的头部运行。如果我导航到第一页，然后链接到其他页面，我的所有 javascript 函数都可以工作；表单经过验证，输入字段根据下拉选择显示/隐藏。

问题是，如果我刷新页面或直接转到地址栏中的该页面，这些功能将不起作用。在阅读了 jquery mobile 之后，我认为如果我在每个页面的头部包含脚本，如果用户碰巧首先通过 HTTP 加载该页面而不是从第一页与 ajax 链接，它们就会加载。

我知道我可以在 data-role="page" 之间包含我需要的脚本。那是最好的选择吗？这是我拥有的自定义 ladot.js 脚本，我可以将其分解为单独的 js 文件，这些文件在相关页面的 data-role="page" 中加载必要的功能。

ladot.js：

```
 // JavaScript Document
  //-------------Javascript for map.htm -- first page that is loaded------------------------------
function initialize() {
var map = new google.maps.Map(document.getElementById('map_canvas'), {
  zoom: 14,
  //center: new google.maps.LatLng( 34.05221496568917, -118.24334979057312 ),
  mapTypeId: google.maps.MapTypeId.TERRAIN 
});

var bikeLayer = new google.maps.BicyclingLayer();
    bikeLayer.setMap(map);

existingbikewaysMap = new google.maps.FusionTablesLayer({
  query: {
    select: 'geometry',
    from: '5294232'
  }
});
existingbikewaysMap.setMap(map);

//add the bicycle parking fusion table layer
BikeParkingMap = new google.maps.FusionTablesLayer({
  query: {
    select: 'Full Address',
    from: '1A5fsPE8B8eJfV4jwji29sebnY1QiAVjL2pTjzOk'
  }
});
BikeParkingMap.setMap(null);

toggle = function(layer) {
   if (layer == 'Bike') {
     if (existingbikewaysMap.getMap() == null) existingbikewaysMap.setMap(map);
     else existingbikewaysMap.setMap(null);
   } else if (layer == 'Park') {
     if (BikeParkingMap.getMap() == null) BikeParkingMap.setMap(map);
     else BikeParkingMap.setMap(null);
   }
}
    google.maps.event.addDomListener(document.getElementById('Bike'), 'click', function() { toggle('Bike'); });
    google.maps.event.addDomListener(document.getElementById('Park'), 'click', function() { toggle('Park'); });

centerLocation = function( position ) {
    map.setCenter( new google.maps.LatLng( 34.05221496568917, -118.24334979057312 ) );
}

myMarker = 0,
    displayLocation = function( position ) {
        // create a new LatLng object for every position update
        var myLatLng = new google.maps.LatLng( position.coords.latitude, position.coords.longitude );

        // build entire marker first time thru
        if ( !myMarker ) {
            // define our custom marker image
            var image = new google.maps.MarkerImage(
                'img/bluedot_retina.png',
                null, // size
                null, // origin
                new google.maps.Point( 8, 8 ), // anchor (move to center of marker)
                new google.maps.Size( 17, 17 ) // scaled size (required for Retina display icon)
            );
            map.setCenter( myLatLng );

            // then create the new marker
            myMarker = new google.maps.Marker({
                flat: true,
                icon: image,
                map: map,
                optimized: false,
                position: myLatLng,
                title: 'You are here',
                visible: true
            });

        // just change marker position on subsequent passes
        } else {
            myMarker.setPosition( myLatLng );
        }

        // center map view on every pass
        //map.setCenter( myLatLng );
    },
    handleError = function( error ) {
        var errorMessage = [ 
            'Sorry. Permission to find your location has been denied.',
            'Sorry. Your position could not be determined.',
            'Sorry. Timed out.'
        ];

        alert( errorMessage[ error.code ] );
    },
    // cache the userAgent
    //useragent = navigator.userAgent;

// allow browser to track movement
    navigator.geolocation.watchPosition( 
        displayLocation,
        centerLocation,
        handleError, 
        { 
            enableHighAccuracy: true, 
            maximumAge: 30000, 
            timeout: 27000 
        }
    );          

var input = document.getElementById('target');
var searchBox = new google.maps.places.SearchBox(input);
var markers = [];

google.maps.event.addListener(searchBox, 'places_changed', function() {
  var places = searchBox.getPlaces();

  for (var i = 0, marker; marker = markers[i]; i++) {
    marker.setMap(null);
  }

  markers = [];
  var bounds = new google.maps.LatLngBounds();
  for (var i = 0, place; place = places[i]; i++) {
    var image = new google.maps.MarkerImage(
        'img/pin_blue.png',
        new google.maps.Size(15,29),
        new google.maps.Point(0,0),
        new google.maps.Point(8,29)
      );

      var shadow = new google.maps.MarkerImage(
        'img/pin_shadow.png',
        new google.maps.Size(33,29),
        new google.maps.Point(0,0),
        new google.maps.Point(8,29)
      );

      var shape = {
        coord: [11,1,12,2,13,3,14,4,14,5,14,6,14,7,14,8,14,9,14,10,14,11,14,12,13,13,12,14,11,15,8,16,8,17,8,18,8,19,8,20,8,21,8,22,8,23,8,24,11,25,11,26,11,27,3,27,3,26,3,25,6,24,6,23,6,22,6,21,6,20,6,19,6,18,6,17,6,16,3,15,2,14,1,13,0,12,0,11,0,10,0,9,0,8,0,7,0,6,0,5,0,4,1,3,2,2,3,1,11,1],
        type: 'poly'
      };

    var marker = new google.maps.Marker({
      map: map,
      icon: image,
      shadow: shadow,
      shape: shape,
      title: place.name,
      position: place.geometry.location
    });

    markers.push(marker);

    bounds.extend(place.geometry.location);
  }

  map.fitBounds(bounds);
});

  google.maps.event.addListener(map, 'bounds_changed', function() {
  //var bounds = map.getBounds();
  searchBox.bindTo('bounds', map);
});
  }

  //Function that toggles CSS styles so that navbar buttons go on and off
$(function() {

  $("#nav1,#nav2,#nav3").off('click').on('click', function() {
    setTimeout(function() {
    $(this).removeClass('');
  }, 500);

    $(this).toggleClass("custom-btn-active");
  });
});

//Function to toggle search div
$(function() {
  $("#Find").click(function(){
    $("#searchfield").slideToggle();
  });
});

  google.maps.event.addDomListener(window, 'load', initialize);

  //-------------Javascript for bss-request.htm--------------------------------------------  
 //Function that controls form validation errors for BSS form
$(document).on("#bss-request", "pagecreate", function() {
    $("#bssForm").validate({

        rules: {
                name: "required",
                phone: {
                    required: false,
                    minlength: 10
                },
                email: {
                    required: true,
                    email: true
                },
                problem: "required",
                description: {
                    required: true,
                    minlength: 15
                },
                location: {
                    required: true,
                    minlength: 15
                }
                },
                messages: {
                name: "Please enter your name",
                phone: {
                    minlength: "Please enter at least 10 digits"
                },
                email: "Please enter a valid email address",
                problem: "Please select a problem",
                description: {
                    required: "Please describe the problem",
                    minlength: "We need a longer description"
                },
                location: {
                    required: "Please tell us where the problem is",
                    minlength: "We need a more detailed location"
                },
            },

        errorPlacement: function(error, element) {
            if (element.attr("name") === "problem") {
                error.insertAfter($("#problem").parent());
            } else {
                error.insertAfter(element);
            }
        }
    });
});

  //-------------Javascript for bike-rack-request.htm--------------------------------------------    
 //Function that controls form validation errors for Bike rack request form
$(document).delegate("#bike-rack-request", "pagecreate", function() {
    $("#rackForm").validate({

        rules: {
                Business_Name: "required",
                Contact_Name: "required",
                Phone_Number: {
                    required: false,
                    minlength: 10
                },
                email: {
                    required: true,
                    email: true
                },
                Street_Address: {
                    required: true,
                    minlength: 8
                },
                Number_of_Racks: "required",
                description: {
                    required: false,
                },
            },
            messages: {
                Business_Name: "Which business needs a bike rack?",
                Contact_Name: "Please enter your name",
                Phone_Number: {
                    minlength: "Please enter at least 10 digits"
                },
                email: "Please enter a valid email address",
                Street_Address: {
                    required: "Where to install or repair the rack(s)?",
                    minlength: "We need a more detailed location"
                },
                Number_of_Racks: "How many racks you are requesting?"      
            },

        errorPlacement: function(error, element) {
            if (element.attr("name") === "Number_of_Racks") {
                error.insertAfter($("#Number_of_Racks").parent());
            } else {
                error.insertAfter(element);
            }
        }

    });
    //Function that shows/hides form fields
    $('#Number_of_Racks').change(function() {
    var value = $(this).val();
    if (value in {'Seperating from concrete':1,
                  'Missing footing screws':1, 
                  'Rack has been cut':1,
                  'Rack has been smashed':1,
                  'Rack was stolen':1,
                  'Other damage':1}) {
        $('#damage_div').slideDown('');
    }
    else {
        $('#damage_div').slideUp('');
    }
  });
});

//-------------Javascript that runs on all pages--------------------------------------------    
//Function that sets sticky footer
$(document).on( 'pagebeforechange', function() {
  // hide footer
  $('[data-role=footer]').hide();
});
$(document).on( 'pagechange', function() {
  // show footer
  $('[data-role=footer]').show();
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-20T09:39:39.233

通过 AJAX 加载页面时，Jquery mobile 只会加载目标页面的正文。这意味着标题中的任何内容都将被忽略，包括任何指向脚本或样式的链接。因此，您将需要

1.  链接到您将在访问的第一页的后续页面上使用的所有脚本和样式。重要的是要记住，这必须在用户可能直接访问（或刷新）的每个页面上完成
2.  停用 ajax 导航（我不推荐）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-22T06:39:31.180

我猜问题是 jquery mobile 在 ajax 加载期间/之后无法访问窗口对象。问题在于：**google.maps.event.addDomListener(window, 'load', initialize);**

你不需要这个。所有这些都是加载初始化函数。

我正在做一个简单的自动完成并删除了 addDomListener 并从初始化函数中提取了代码。请参阅下面删除的代码。这完美地工作。

**function initialize(){** //移除

```
 var input = /** @type {HTMLInputElement} */(document.getElementById('text-basic'));
     var autocomplete = new google.maps.places.Autocomplete(input);

    google.maps.event.addListener(autocomplete, 'place_changed', function() {
        var place = autocomplete.getPlace();
        if (!place.geometry) {
      // Inform the user that the place was not found and return.
        input.className = 'notfound';
        return;
        }
    }); 
```

**}** //删除

**google.maps.event.addDomListener(this.window, 'load', 初始化);** //删除

# ruby-on-rails - 如何防止在设计中登录许多资源？

> ID：13445807
> 
> 赞同：0
> 
> 时间：2012-11-18T23:40:33.910
> 
> 标签：ruby-on-rails, ruby-on-rails-3, devise

我有三个设计模型`Student`，，，`Employer`。`Admin`我希望不能同时以学生、管理员和雇主身份登录。

最好的方法是如何做到这一点？

我的路线

```
devise_for :admins, only: :sessions

  devise_for :employers,
    controllers: {
      sessions: 'devise/employers_sessions'
    }

  authenticated :employer do
    match 'dashboard' => 'employers#dashboard'
  end

  devise_for :students,
    controllers: {
      registrations: 'devise/students_registrations',
      sessions: 'devise/students_sessions'
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T23:57:39.313

将它们映射到单个warden 范围。这个术语有点糟糕，因为设计范围显然与守望者范围不同。太糟糕了，他们没有写相应的维基条目。然而，有一条短线：

> Warden 允许多个用户同时登录。见范围

我想设计为每个模型使用不同的范围。如果您深入研究源代码并查看他们在设计和守望者之间的映射中使用的范围设置的位置，您应该能够将其更改为三个模型中的每个模型的一个。这会让你到达你想去的地方。

去试试

```
devise_for :employers, :singular => :user
devise_for :students, :singular => :user 
```

# java - GWT java.lang.NoClassDefFoundError：com/google/gwt/util/tools/Utility

> ID：13445808
> 
> 赞同：1
> 
> 时间：2012-11-18T23:40:54.280
> 
> 标签：java, gwt, tomcat

当我将系统部署到 Tomcat 时，它显示以下错误信息：

```
org.apache.catalina.core.ApplicationContext log
SEVERE: Exception while dispatching incoming RPC call
com.google.gwt.user.server.rpc.UnexpectedException: Service method 'public abstract com.google.gwt.user.client.rpc.XsrfToken com.google.gwt.user.client.rpc.XsrfTokenService.getNewXsrfToken()' threw an unexpected exception: java.lang.NoClassDefFoundError: com/google/gwt/util/tools/Utility
        at com.google.gwt.user.server.rpc.RPC.encodeResponseForFailure(RPC.java:385)
        at com.google.gwt.user.server.rpc.RPC.invokeAndEncodeResponse(RPC.java:588)
        at com.google.gwt.user.server.rpc.RemoteServiceServlet.processCall(RemoteServiceServlet.java:208)
        at com.google.gwt.user.server.rpc.RemoteServiceServlet.processPost(RemoteServiceServlet.java:248)
        at com.google.gwt.user.server.rpc.AbstractRemoteServiceServlet.doPost(AbstractRemoteServiceServlet.java:62)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:641)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:306)
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:240)
        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:161)
        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:164)
        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:100)
        at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:541)
        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:383)
        at org.apache.coyote.http11.Http11AprProcessor.process(Http11AprProcessor.java:284)
        at org.apache.coyote.http11.Http11AprProtocol$Http11ConnectionHandler.process(Http11AprProtocol.java:322)
        at org.apache.tomcat.util.net.AprEndpoint$SocketWithOptionsProcessor.run(AprEndpoint.java:1648)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
        at java.lang.Thread.run(Thread.java:636)
Caused by: java.lang.NoClassDefFoundError: com/google/gwt/util/tools/Utility
        at com.google.gwt.user.server.rpc.XsrfTokenServiceServlet.generateTokenValue(XsrfTokenServiceServlet.java:198)
        at com.google.gwt.user.server.rpc.XsrfTokenServiceServlet.getNewXsrfToken(XsrfTokenServiceServlet.java:163)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:616)
        at com.google.gwt.user.server.rpc.RPC.invokeAndEncodeResponse(RPC.java:569)
        ... 20 more 
```

这是什么问题？此应用程序在 Eclipse 中运行良好。我的谷歌 SDK 版本是 2.5。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T09:27:54.693

这个类 ( )在 GWT [2.4.0](https://code.google.com/p/google-web-toolkit/source/browse/tags/2.4.0/user/src/com/google/gwt/user/server/rpc/XsrfTokenServiceServlet.java)或[2.5.0](https://code.google.com/p/google-web-toolkit/source/browse/tags/2.5.0/user/src/com/google/gwt/user/server/rpc/XsrfTokenServiceServlet.java)`Utility`中都没有使用，它只在[2.3.0](https://code.google.com/p/google-web-toolkit/source/browse/tags/2.3.0/user/src/com/google/gwt/user/server/rpc/XsrfTokenServiceServlet.java)中使用，确实是一个错误。`XsrfTokenServiceServlet`

您说您使用的是 GWT 2.5.0，所以`gwt-servlet.jar`您的版本肯定是`WEB-INF/lib`GWT 2.3.0 的过时版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T23:44:13.960

您确定包含 com.google.gwt.util.tools.Utility 的 jar 位于项目的 WEB-INF/lib 或 tomcat/lib 文件夹中吗？看起来tomcat无法找到包含该类的jar。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-19T08:54:25.393

com/google/gwt/util/tools/Utility 类在 gwt-dev.jar 中。但是您不需要将 gwt-dev.jar 添加到 WEB-INF/lib，因为 GWT-DEV.jar 仅用于开发模式。您不得在服务器端代码上使用此类或依赖类。

# javascript - 如何处理同时的 javascript xmlhttprequests？

> ID：13445809
> 
> 赞同：5
> 
> 时间：2012-11-18T23:41:02.177
> 
> 标签：javascript, xmlhttprequest, simultaneous-calls

> **可能重复：**
> [将索引从 for 循环传递到 ajax 回调函数（javascript）](https://stackoverflow.com/questions/6077357/passing-index-from-for-loop-to-ajax-callback-function-javascript)

为了获取一些内容，我对向不同的服务器发出 xmlhttprequests 有点困惑。这是我写的，但似乎我在某些时候弄错了。

```
var URL = new Array();
URL[0] = "http://www.example1.com";
URL[1] = "http://www.example2.com";
URL[2] = "http://www.example3.com";
var nRequest = new Array();
for (var i=0; i<3; i++) {
    nRequest[i] = new XMLHttpRequest();
    nRequest[i].open("GET", URL[i], true);
    nRequest[i].onreadystatechange = function (oEvent) {
        if (nRequest[i].readyState === 4) {
            if (nRequest[i].status === 200) {
                console.log(nRequest[i].responseText);
                alert(nRequest[i].responseText);
            } else {
                console.log("Error", nRequest[i].statusText);
            }
        }
    };
    nRequest[i].send(null);
} 
```

使用 IE10 上的此代码，我在控制台上被拒绝访问..

如果我删除数组并使用简单的请求，它会按预期运行..

```
wRequest = new XMLHttpRequest();
wRequest.open("GET", "http://www.example1.com", true);
wRequest.onreadystatechange = function (oEvent) {
    if (wRequest.readyState === 4) {
        if (wRequest.status === 200) {
            console.log(wRequest.responseText);
            alert(wRequest.responseText);
        } else {
            console.log("Error", wRequest.statusText);
        }
    }
};
wRequest.send(null); 
```

但是我应该如何触发多个 2-3 个请求，并且仍然没有数据处理问题..？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-18T23:50:47.550

问题（忽略 slebetman 涵盖的跨域问题）是，当您的就绪状态更改回调被触发时，它使用的`i`是包含范围内的变量，该变量将`3`在循环完成后。一种解决方法如下：

```
for (var i=0; i<3; i++){
   (function(i) {
      nRequest[i] = new XMLHttpRequest();
      nRequest[i].open("GET", URL[i], true);
      nRequest[i].onreadystatechange = function (oEvent) {
         if (nRequest[i].readyState === 4) {
            if (nRequest[i].status === 200) {
              console.log(nRequest[i].responseText);
              alert(nRequest[i].responseText);
            } else {
              console.log("Error", nRequest[i].statusText);
            }
         }
      };
      nRequest[i].send(null);
   })(i);
} 
```

这为每个循环迭代引入了一个立即调用的函数表达式，使得函数内部的代码有自己的`i`- JS 闭包的魔力意味着当`onreadystatechange`函数被调用时，它将访问`i`匿名函数的参数（即使该函数已经完成)，而不是`i`外部作用域的，所以`nRequest`每次都会处理正确的元素。

`.open()`此外，您在说`wURL[i]`但应该有的行上有错字`URL[i]`。

根据您打算如何处理响应文本，我不确定您是否需要一组请求：您可以将 Ajax 代码封装到一个函数中，该函数将 URL 和回调函数作为参数，然后调用它循环中的函数...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T23:50:18.220

> 向**不同的服务器发出 xmlhttprequests**

你不能这样做。XMLHttpRequest 只允许连接到页面所属的同一个域。这就是所谓的*“同源政策”*。

谷歌“同源政策”或在 SO 上搜索以了解更多信息。

# android - 为什么我看不到图？（图像视图）

> ID：13445814
> 
> 赞同：0
> 
> 时间：2012-11-18T23:41:32.643
> 
> 标签：android, dynamic, android-imageview

我想创建动态ImageView，但它没有出现，有什么帮助吗？

```
@Override public boolean onTouchEvent(MotionEvent event) {
    RelativeLayout myLayout = new RelativeLayout(this);

    ImageView stone = new ImageView(this);
    stone.setImageResource(R.drawable.pedra);
    stone.setVisibility(View.VISIBLE);

    RelativeLayout.LayoutParams lp = new RelativeLayout.LayoutParams(
            RelativeLayout.LayoutParams.WRAP_CONTENT,
            RelativeLayout.LayoutParams.WRAP_CONTENT);

    myLayout.addView(stone, lp);

    return true;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T23:54:50.017

试试这个，它会帮助你

## 主要的.xml

```
 <RelativeLayout 
       android:id="@+id/relativelayout"....>
 </RelativeLayout> 
```

## 在 MainActivity.java

```
public class MainActivity extends Activity {

   private RelativeLayout rLayout;

   @Override
   protected void onCreate(Bundle savedInstance) {

       super.onCreate(savedInstance);
       setContentView(R.layout.main);

       rlayout = (RelativeLayout) findViewById(R.id.relativeLayout);

   }

   @Override 
   public boolean onTouchEvent(MotionEvent event) {

      ImageView stone = new ImageView(this);
      stone.setImageResource(R.drawable.pedra);
      stone.setVisibility(View.VISIBLE);

      rLayout.addView(stone);

     return true;
   }
 } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T00:27:39.917

您的代码是正确的，但没有太大影响，因为它是为艺术而艺术。您创建`RelativeLayout`，然后创建`ImageView`，然后添加`ImageView`到您的`RelativeLayout`. 这很有效，但要使其显示您的布局，必须将其添加到显示的层次结构中。因此，我将添加`RelativeLayout`到您的 xml 布局文件中，使用 分配`id`给它`android:id`，然后在您的触摸中执行`findViewById()`并添加在`ImageView`那里创建。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-18T23:48:03.970

你忘了给你充气`myLayout`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-03-25T07:42:27.537

对于某些设备，也将所有图像放在**drawable-xhdpi**目录中。

# r - 如何在R中制作交互图？

> ID：13445816
> 
> 赞同：-1
> 
> 时间：2012-11-18T23:41:39.167
> 
> 标签：r, plot

我陷入困境。我正在尝试创建一些变量之间的交互图，以确定它们对响应的影响。

数据位于[http://faculty.chicagobooth.edu/nicholas.polson/teaching/41000/election2012.txt](http://faculty.chicagobooth.edu/nicholas.polson/teaching/41000/election2012.txt)

我不知道如何在**R**中制作交互图，但我发现一个网站展示了一个用户定义的函数执行交互图：- [http://alumni.media.mit.edu/~tpminka/courses/36-350.2001/ Lectures/day30/](http://alumni.media.mit.edu/~tpminka/courses/36-350.2001/lectures/day30/) 用户自定义函数位于[此处](http://alumni.media.mit.edu/~tpminka/courses/36-350.2001/code/rtable.r)

使用这个用户定义的函数，我正在尝试使用响应创建一个交互图：VP 预测变量：G 和 P（我也想包括 Z，但是我在 2 个变量上遇到了很多麻烦，所以我把它放在了次要位置) （VP、G 和 P 是上述初始数据集中的列。）

每次我尝试插入我的值时，**R**都会向我抛出错误，声称找不到对象 G 和 P 等。我也尝试使用interaction.plot 函数，但它会为我绘制一个空白图表，并且当我更改参数时，我会收到一个错误，声称一个变量是一个原子向量，但是当我将相同的变量插入 predict.plot 函数（用户从 MIT 站点定义一个）时，**R**抛出了一个错误，因为同一个变量据说不是原子。

我怎样才能用我的数据制作一个像麻省理工学院网站上的那样的 2 变量交互图（如果有人这么倾向于，我怎么能用 3 个变量制作它）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T01:00:30.793

在运行任何其他命令之前尝试执行以下操作：

```
attach( df ) 
```

...假设您的数据框与您的数据被调用`df`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-20T03:13:59.207

已解决：问题是我试图将数据框中的列名传递给 predict.plot 和 interaction.plot 函数。

我必须将列转换为矩阵，然后将这些矩阵传递给函数。现在一切正常。

要将数据帧转换为矩阵，请使用

MatrixVari = as.matrix(listColumni) 其中每个 listColumni 是数据框中的一列，然后您将其读入其自己的 matrixVari。

# java - 计算数组中字符出现的次数

> ID：13445819
> 
> 赞同：0
> 
> 时间：2012-11-18T23:42:03.463
> 
> 标签：java, arrays, for-loop

这就是我所拥有的，但它不起作用，这让我感到困惑。如果您向下滚动，我评论了某人发布了我遇到的确切问题以及我正在尝试做的事情。我在想也许问题是我生成随机字符的代码：

```
public void add (char fromChar, char toChar){
    Random r = new Random(); //creates a random object
    int randInt;
    for (int i=0; i<charArray.length; i++){
        randInt = r.nextInt((toChar-fromChar) +1);
        charArray[i] = (char) randInt; //casts these integers as characters
    }
}//end add
public int[] countLetters() {
int[] count = new int[26];
char current;

     for (int b = 0; b <= 26; b++) {
         for (int i = 97; i <= 123; i++) {
             char a = (char) i;
             for (int ch = 0; ch < charArray.length; ch++) {
                 current = charArray[ch];
                if (current == a) {
                count[b]++;
                }
             }
         }
     }
return count;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T00:14:23.303

不知道是否还有其他错误，但您正在`b`从 0 到 26 进行迭代，并使用它作为`count[]`长度为 26 的索引。该数组具有从 0 到 25 的有效索引，您将`IndexOutOfBoundsException`在访问它时收到26.

它应该是：

```
...
for (int b = 0; b < 26; b++) 
... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T00:16:59.303

不确定这是否是答案，因为我们不知道发生了什么。但这里有一些东西，你的 int[] 计数数组有 26 个索引，但你数到 27： for (int b = 0; b <= 26; i++) -> 这将产生 27 个索引。试试这个：

```
public int[] countLetters() {
    int[] count = new int[26];
    char current;

    for (int b = 0; b < 26; b++) {
        for (int i = 97; i < 123; i++) {
            char a = (char) i;
            for (int ch = 0; ch < charArray.length; ch++) {
                current = charArray[ch];
                if (current == a) {
                    count[b]++;
                }
             }
         }
     }
    return count;
} 
```

小错误，感谢Fabian

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T17:41:52.677

这是你想要的：

这是文件 charCounter.java

```
import java.util.*;
import java.awt.*;

public class charCounter
{
    char[] charArray = new char[50];
    int randInt;
    Random r = new Random();

    public charCounter()
    {}

    public void create ()
    {
            for (int i=0; i<charArray.length; i++)
        {
                randInt = 97+r.nextInt(26);
                charArray[i] = (char) randInt; //casts these integers as characters
            }
    }

    public void printCharArray()
    {
        for(int i=0; i<charArray.length; i++)
        {
                System.out.println(charArray[i]);
        }
    }

    public int[] countLetters() 
    {
        int[] count = new int[26];
        int index = 0;
            for(int i=0; i<charArray.length; i++)
        {
            index = ((int)charArray[i])-97;
            count[index]++;
        }
        return count;
    }
} 
```

这是我制作的驱动程序：

```
public class driver
{
    public static void main(String args[])
    {
        charCounter c = new charCounter();
        int[] printThis;

        c.create();
        printThis = c.countLetters();

        for(int i=0; i<printThis.length; i++)
        {
            System.out.println(printThis[i]);
        }
    }
} 
```

# javascript - Django Admin 弹出窗口损坏

> ID：13445820
> 
> 赞同：3
> 
> 时间：2012-11-18T23:42:13.190
> 
> 标签：javascript, django, django-admin, cross-domain, cross-domain-policy

我正在开发一个 Django 项目，作为良好实践的一部分，我的静态内容和媒体是从无 cookie 域提供的。当然，为了做到这一点并仍然使用 Google Analytics 等工具，我提供来自 www.domain.tld 的所有文档，而媒体来自 media.domain.tld，静态来自 static.domain.tld。

这最初会导致 TinyMCE（我选择的所见即所得编辑器）出现问题，但这很容易通过编辑`tiny_mce.js`并`tiny_mce_popup.js`包含以下行来解决：

```
document.domain=window.location.hostname.split('.').splice(-2).join('.'); 
```

在顶部。这基本上将`document.domain`我的主编辑窗口和 TinyMCE 弹出窗口设置为 domain.tld，无论它们来自多深的子域。效果很好（并且是便携式的）。（我不关心 Array.splice() 可能在客户端浏览器中不可用，因为 TinyMCE 仅用于管理，我们控制浏览器）。

无论如何，我离题了。

一切都很好，直到我尝试使用 Django Admin 弹出窗口来创建一个新的 M2M 项目。弹出窗口显示正常，但无法正确完成工作，因为弹出窗口的文档域设置为，在本例中为 www.domain.tld，而主编辑窗口中的 document.domain 为`domain.tld`（根据上述）。

很简单，我想，我只需将相同的 JS 片段添加到管理员的 base.html 文件的正文中即可。不去。弹出的 document.domain 确实在 JS 控制台中`domain.tld`根据我包含的代码段进行测试时被设置，但是一旦我尝试保存新对象，它就会被重置回`www.domain'tld`（也经过测试，在 JS 控制台中提交后） ，当然，窗口间通信失败：

```
Uncaught TypeError: Property 'dismissAddAnotherPopup' of object \
[object Window] is not a function` 
```

在弹出窗口中，并且：

```
Unsafe JavaScript attempt to access frame with URL \
http://www.domain.tld/admin/project/object/16/ from frame with URL \
http://www.domain.tld/admin/project/object/add/?_popup=1\. The frame being \
accessed set 'document.domain' to 'domain.tld', but the frame requesting access \
did not. Both must set 'document.domain' to the same value to allow access. 
```

检查`document.domain`两个窗口揭示了这个事实：

主窗口：`domain.tld` 弹出窗口：（`www.domain.tld`请记住，提交时已更改）

那么，向所有大师提出问题，在将结果发布回主窗口之前，是否有一些 Django JS 代码正在重置弹出框的 document.domain？或者，重置是使用主窗口的窗口对象进行通信的副作用吗？如果是先前的，你能指出我在哪里吗？我似乎无法找到它可能在哪个文件中。如果是后者，拥有 cookieless 域 + TinyMCE + Django Admin 弹出窗口的解决方案是什么？

非常感谢您考虑这个问题！

# unit-testing - 在 Lithium 中测试环境敏感代码

> ID：13445821
> 
> 赞同：0
> 
> 时间：2012-11-18T23:42:15.950
> 
> 标签：unit-testing, lithium

在测试中，有没有办法临时覆盖`Environment::get()`扩展类中的返回值`StaticObject`？

我正在为 Lithium 编写一个[功能切换](http://martinfowler.com/bliki/FeatureToggle.html)插件。我想根据环境测试打开和关闭功能。例如，该功能`new_ui`应该在暂存中打开，但在生产中关闭。

在我的测试中，我希望能够做这样的事情：

```
Features::add('new_ui', array('production' => false, 'staging' => true));
// Magic that makes Environment::get() in the Features class return 'staging'
$this->assertTrue(Feature::check('new_ui'));
// Magic that makes Environment::get() in the Features class return 'production'
$this->assertFalse(Feature::check('new_ui')); 
```

我可能可以使用 a 来破解一些东西，`MockEnvironment`但是有没有更纯的锂方法来实现这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T12:45:24.903

如果您正在编写测试，那么模拟将是正确的方法，或者是用于返回环境状态的可注入闭包。

# python - 获取计数器结果时出现 AttributeError，但不是纯整数

> ID：13445824
> 
> 赞同：0
> 
> 时间：2012-11-18T23:42:23.903
> 
> 标签：python, attributeerror

我正在尝试使用下面的代码来获取文本文件中的总行数。

```
totallines = 0
for line in infile:
    totallines += 1 
```

它可以工作，并且可以将正确的数字打印到外壳上。但是，当我将结果分配给：

```
item = [0]*totallines 
```

将给定的行强制为小写时出现 AttributeError：

```
item[i] = item[i].lower() 
```

但是，如果我删除行计数器，并将其替换为文本文件中的行数。它完美地工作。

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T23:53:16.553

听起来您想将输入文件的行转换为小写并将结果存储在数组中。你可以这样做：

```
with open('myfile.txt', 'r') as infile:
    items = [line.lower() for line in infile] 
```

或者（在某种程度上）等效地，（这个在每一行的末尾删除“\n”）：

```
with open('myfile.txt', 'r') as infile:
    items = infile.read().lower().splitlines() 
```

*注意：不要`file`用作变量名，因为它会掩盖内置`file`类型。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T23:56:12.783

`item = [0]*totallines`将创建一个长度等于 的 0 列表`totallines`。

如果您想将文件复制到列表中并访问给定的行（例如第六行），您可以这样做：

```
item = []
for line in infile:
    item.append(line)

print(item[5].lower()) 
```

或者，更简洁地说，使用文件对象的内置方法：

```
item = infile.readlines()
print(item[5].lower()) 
```

# php - JOIN 表不重复但需要列的所有不同值

> ID：13445826
> 
> 赞同：2
> 
> 时间：2012-11-18T23:42:37.493
> 
> 标签：php, sql, sqlite

我有 3 张桌子，正在恢复它们：

```
 :::NEWS:::
ID  |  TITLE 
 1  |  New A  
 2  |  New B  

:::TAGTONEW:::
NEWID |  TAGID
  1   |  1 
  1   |  2
  2   |  2
  2   |  3 

:::TAGS:::
ID  |  TAG
 1  |  religion 
 2  |  sport
 3  |  politic 
```

这样做的目的是搜索与给定标签列表匹配的新闻（例如带有标签运动和宗教的新闻）。行。问题是当我做类似的事情时：

```
SELECT * FROM news JOIN tagtonew ON news.id = newid JOIN tags ON tagid = tags.id
WHERE tag IN ('religion','sport'); 
```

结果将是 3 行，其中 2 行重复`New A`. 好的，我可以使用`GROUP BY news.id`只获取一行，但问题是我需要返回与 New A 匹配的所有标签（我需要返回 New A 与体育和宗教有关），我该怎么做？请求新人？提前致谢。

*编辑*

上面的结果将是：

```
New A - religion
New A - sport
New B - sport 
```

如果我组会是这样的：

```
New A - religion
New B - sport 
```

但我需要知道 A 也与运动有关，因为我需要以 JSON 格式返回它。所以我需要输出是这样的：

```
New A - (religion, sport)
New B - sport 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T23:45:36.470

你只需要使用`GROUP BY`and`HAVING`子句。

```
SELECT  a.Title
FROM    news a
        INNER JOIN tagtonew b
            ON a.id = b.newid 
        INNER JOIN tags c 
            ON b.tagid = c.id
WHERE   c.tag IN ('religion','sport')
GROUP BY a.Title
HAVING COUNT(*) = 2 
```

*   [SEE Previous SO Answer ( *(匹配多个条件的行)*](https://stackoverflow.com/a/12586263/491243)

**更新 1**

采用`GROUP_CONCAT`

```
SELECT  a.MovieName, '(' || GROUP_CONCAT(b.CategoryName) || ')' AS List
FROM    MovieList a
        INNER JOIN CategoryList b
            ON a.ID = b.MovieID
WHERE   b.CategoryName IN ('Comedy','Romance')
GROUP BY a.MovieName 
```

*   [SQLFiddle Demo（*记录可能不同但可能有相同的想法*）](http://sqlfiddle.com/#!7/b60cb/1)

# php - 将文件类型、带有 PHP 回显的日期传递到表中

> ID：13445828
> 
> 赞同：0
> 
> 时间：2012-11-18T23:42:52.080
> 
> 标签：php, uploadify

我还是 PHP 新手，我正在尝试将文件夹中的文件回显到表格行。我可以成功地在服务器上回显文件，但我为文件类型尝试的所有内容都不起作用。到目前为止，我的代码如下所示：

```
<?PHP 

$folder = "uploads/"; 
$handle = opendir($folder); 

# Making an array containing the files in the current directory: 
while ($file = readdir($handle)) 
{ 
    $files[] = $file; 
} 
closedir($handle); 

#echo the files 
$path_parts = pathinfo($file);
foreach ($files as $file) { 
    echo "

    <tr><td><a href=$folder$file>$file</a></td><td>$path_parts['extension']</td><td>date</td>   </tr>"
    ; 
} 
?> 
```

按照这种方式设置，它给了我一个服务器错误。当我取出路径部分/路径信息代码时，它工作正常，但当然它不会回显文件类型。对此的任何帮助将不胜感激，如果有人知道实现文件上传日期的最佳方法，那就太好了。顺便说一句，如果有任何区别，请使用 uploadifive 作为上传者。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T23:52:02.353

如前所述，`$path_parts`变量赋值需要在你的 foreach 循环内。为了节省一些代码行，您应该将[scandir](http://php.net/scandir)视为读取文件夹中文件的 while 循环的替代品。

以下是您的代码在进行这些更改后的外观：

```
<?PHP 

$folder = "uploads/"; 

# Making an array containing the files in the current directory: 
$files = scandir($folder); 

#echo the files 
foreach ($files as $file) { 
    $path_parts = pathinfo($folder.$file);
    echo "<tr><td><a href={$folder}{$file}>{$file}</a></td><td>{$path_parts['extension']}</td><td>date</td></tr>"; 
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T23:45:14.320

我对您的代码做了一些细微的修改：

```
<?php
$folder = "uploads/"; 
$handle = opendir($folder); 

# Making an array containing the files in the current directory: 
while ($file = readdir($handle)) 
{ 
    $files[] = $file; 
} 
closedir($handle); 

foreach ($files as $file) 
{
    #echo the files 
    $path_parts = pathinfo($file);
    echo "<tr><td><a href='" . $folder . $file . "'>" . 
         $file . "</a></td><td>" . $path_parts['extension'] . 
         "</td><td>date</td></tr>";
} 
```

大多数情况下，`$path_parts = pathinfo($file);`必须在循环本身中。否则，您仅在`$file`循环的最后一个执行路径信息。

# validation - 按下回车键时不会显示验证摘要？

> ID：13445829
> 
> 赞同：3
> 
> 时间：2012-11-18T23:43:05.663
> 
> 标签：validation, validationsummary

我对编程很陌生，这是我的第一篇文章，所以请多多包涵。

当我按下回车键并显示适当的验证摘要时，我正在尝试验证多个文本框。当我按下回车键时，表单会进行验证，但当我更改信息并再次按下回车键时，验证摘要不会更新。但是，当我按下“提交”按钮时它会更新。

我正在使用 2 个不同的验证摘要来显示用户是否未输入文本或已输入但密码不匹配（因为如果用户将项目留空，我想使用标题文本属性仅显示一条消息）。

我已经搜索了一个多小时，我能找到的最好的是：

[http://weblogs.asp.net/sahannet/archive/2011/01/22/asp-net-validation-summary-control-and-enter-key-submit.aspx](http://weblogs.asp.net/sahannet/archive/2011/01/22/asp-net-validation-summary-control-and-enter-key-submit.aspx)

但我不明白如何使用它。

# c - 完美方形功能无法正常工作？

> ID：13445836
> 
> 赞同：0
> 
> 时间：2012-11-18T23:44:40.323
> 
> 标签：c, root, perfect-square

当数字不具有完全平方时，它应该返回 false，否则返回根。但在这段代码中，它一直返回根。例如输入 5，根 2。

```
main()
{

int i;
int number=0;
int result=0;

for(i=0; i<10; i++){
    printf("Testing:");
    scanf("%i",&number);

    result = isSquare(number);

    if(result==0)
        printf("Fail\n");
    else
        printf("%i\n",result);

}
}

int isSquare(int n)
{
float root = sqrt(n);
if (n == (int) n)
    return root;

else
    return 0;

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T23:46:38.070

代替：

```
if (n == (int) n) // n is an integer (not necessarily a perfect square) 
```

你的意思是：

```
if (root == (int) root) // root is an integer (so n is a perfect square) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-18T23:48:35.520

不应该是这样吗？

```
int isSquare(int n)
{
float root = sqrt(n);
if (n == ((int) root)*((int) root)) //Better use floor() function
    return root;
else
    return 0;
} 
```

# latex - 让 Sublime Text 更像 TextMate

> ID：13445838
> 
> 赞同：0
> 
> 时间：2012-11-18T23:45:02.853
> 
> 标签：latex, textmate, sublimetext2, code-snippets, textmate2

好吧，我在 Mac OS X 下，我使用 TextMate 1.5.11 来编译 LaTeX 文档。但是我发现 Sublime Text 2 有一些我比 TextMate 更喜欢的功能（还有 TM v2，它处于测试阶段）。TextMate 2 有一些这样的功能，但它仍然有问题。

所以，我想搬到 ST2，但只有一件事阻止了我。在 TM 中有四种非常不同的方式来理解片段：

*   `tab`写完单词后用键介绍的真实片段。（即如果你写`mat`然后按`tab`你得到基本的矩阵环境）
*   基于单词的命令（即如果你写`frac`，那么你得到`\frac{$0}{$1}`）
*   基于当前单词的 LaTeX 符号（即，如果你写`a`，你会得到`\alpha`，如果你再次按下，在某些情况下，它会变成带有多个符号的循环）
*   基于当前单词的环境（即，如果您编写`document`并按下分配给您的键 get `\begin{document} $0 \end{document}`）

但在 ST2 中，您只能按`tab`。我想区分这四种情况。有没有一种简单的方法可以以这种方式设置 Sublime Text？（我对编程一无所知）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-17T07:49:56.757

我刚刚从 TM 切换到 ST2，我主要使用它来编写 LaTeX。首先，您需要安装包安装程序[Package Control - Sublime Text 包管理器](https://sublime.wbond.net/)。安装后，您可以使用模糊搜索“安装包”按 Enter 调用包控制`cmd+shift+p`，搜索“LaTeXTools”并安装它。现在，您从 TextMate 中的 LaTeX 包中了解了很多内容。研究开发人员了解所有不同关键命令的自述文件。

*   `mat+TAB`开箱即用。还有很多其他你期望的东西。
*   基于单词的命令称为键绑定，可以在`Preferences > Package Settings > LaTeXTools > Key Bindings User`. 我自己不太确定那里的语法。但是您可以使用您能想到的每个组合键来调用命令。只需键入一个单词，使用触发器之类的`TAB`或任何让您的船漂浮的东西。
    （顺便说一句。我不确定您是否必须将只想在 LaTeX 中使用的键绑定放在 LaTeSTools 包内的键绑定文件中。可能是您可以在全局键绑定 - 用户文件中定义范围。）
*   我不知道 TM 中的这种行为。我用 TextExpander 做到这一点。只需点击`a+TAB`=`\alpha`但我相信您也可以在 Key Bindings 中执行此操作
*   LaTeXTools 中有一个环境命令。只需输入您的环境名称，然后点击`CMD+l,e`。那就是`CMD+l`留下`CMD`钥匙，然后输入字母`l`。是的，ST可以做到这一点。

因此，如果您想放置一个枚举环境，您至少有两个选择。

`enum+TAB`给你

```
\begin{enumerate}
     \item 
\end{enumerate} 
```

`enumerate CMD+l,e`给你

```
\begin{enumerate}

\end{enumerate} 
```

还有另一个方便的命令。`CMD+l,c`将前一个单词变成一个命令。所以`hat CMD+l,c`给你`\hat{}`。

# opengl - PlayN中的图像/纹理过滤器（可能使用opengl），如何处理？

> ID：13445843
> 
> 赞同：4
> 
> 时间：2012-11-18T23:45:14.753
> 
> 标签：opengl, playn, fragment-shader, convolution

[我目前正在尝试 PlayN 并且第一个测试平台已经启动并正在运行，所以现在我正在做一些更高级的事情：在使用 AS3 和 box2d 模拟液体](http://www.emanueleferonato.com/2012/05/16/simulating-mudslime-with-box2d-bitmaps-and-filters/)的炫耀示例之后，我已经设法让它全部工作，除了模糊。幸运的是，PlayN 附带了一个 LWJGL-hook，所以我想试一试，但即使我对 OpenGL 有一些了解，但我的智慧还是走到了尽头。我有一些关于如何在 OpenGL 中做到这一点的基本想法，当然我知道如何改变颜色和一般的顶点 - 任何人都想要一些关于过滤器的提示，特别是卷积？问题是 PlayN 并没有真正为其内部图像表示提供快速的 API……除了 OpenGL。

我的“游戏”已经全部设置好了……有好几层；其中之一，“动态层”不断地被提供映射到物理身体的小图像纹理点（只是一个小 gif）。他们都倒下，消失并被适当地摧毁。我现在需要的是一些相当高效的方法来在这个动态层上设置模糊过滤器。

有没有人对 OpenGL 着色器有任何经验并且可以为我提供任何开始的东西？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-14T15:26:34.410

没有看到你的代码，我不确定我是否可以回答你的问题，但是着色器子系统并没有很好地暴露为 api，但它并非不可能挂钩。如果您查看此页面，它可能会为您提供一些关于如何将着色器附加到图层的提示：[https ://github.com/dmg46664/playn/wiki/GLShader](https://github.com/dmg46664/playn/wiki/GLShader)

# html - 如何确保仅在通过浏览器按钮上传完成后才发布表单

> ID：13445844
> 
> 赞同：1
> 
> 时间：2012-11-18T23:45:22.790
> 
> 标签：html, forms, file, post, submit

我有一个 HTML 表单，其中包含一个名为“name”的文本输入、一个名为“myFile”的文件上传输入（显示“浏览”按钮）和一个提交按钮（名为“Upload”）。

在选择文件之前不小心按了回车，一个长度为0的文件被上传到了servlet。如果未选择文件或文件名为空，如何确保浏览器不发布...谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T20:53:44.330

大卫，你的评论是正确的。答案是如果需要手动输入，则使用javascript检查文本输入是否填充了信息。我也可以使用 javascript 来放置没有路径的文件名来自动填写表格。

# c - 在 C 中最容易使用的 int 数组排序函数

> ID：13445845
> 
> 赞同：2
> 
> 时间：2012-11-18T23:45:25.717
> 
> 标签：c, arrays, sorting

我正在寻找在 C 中最容易使用的数组排序功能。我将教一些人一点 C（实际上这些是每种语言的通用基础）。有没有像 Java 这样的 int 数组的函数

```
Arrays.sort(arr); 
```

我见过 qsort，但正如我所见，它需要额外的比较功能。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-18T23:48:45.310

所以......实现该功能并完成它......

```
int compare_int( const void* a, const void* b )
{
    if( *(int*)a == *(int*)b ) return 0;
    return *(int*)a < *(int*)b ? -1 : 1;
}

const size_t num_elem = 10;
int elements[num_elem] = { 3, 6, 1, 9, 8, 2, 0, 5, 7, 4 };
qsort( elements, num_elem, sizeof(int), compare_int ); 
```

* * *

现在你关于排序的课程变成了“这是如何工作的”？

首先解释内存布局和数组。无论如何，在您知道这一点之前，您无法在 C 中做很多事情。

然后你解释什么是`void`指针以及为什么`qsort`函数需要知道：

1.  数组的起始地址
2.  元素数量
3.  每个元素的大小
4.  如何比较元素

这自然会导致比较函数本身......如何转换和取消引用类型。

最后，如果他们很好地掌握了这些概念，您可以指出第四个参数 to`qsort`并不是特例。您可以说拥有一个指向函数的指针并将其作为参数传递给另一个函数是完全可以的。这一切都是为了让指针的*类型*正确，然后编译器会为你整理出剩下的部分。

```
int (*comparator)(const void*, const void*) = compare_int;
int a = 1, b = 2;
printf( "comparator(%d, %d) = %d\n", a, b, comparator(&a, &b) ); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-19T00:02:52.860

最简单的方法，在我的第一个 C 编程课程中，我在没有在线查找任何算法的情况下编写了这个：

```
for(int i=0; i<N;i++)
{
    for(int j=0;j<N-1;j++)
    {
        if(array[j]<array[j+1])
        {
            int temp=array[j];
            array[j]=array[j+1];
            array[j+1]=temp;
        }
    }
} 
```

我知道它可以在少于 N*(N-1) 次迭代中完成，但我不知道如何计算确切的迭代次数，所以为了确保对所有元素进行排序，我以这种方式制作了它。
如果您愿意，您可以通过知道在每次迭代中对一个元素进行排序来减少迭代次数，第二个循环也可以从 0 变为 Ni-1。但是我懒得计算这个数字，而且教授还可以:-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-19T00:00:55.370

如果您只是出于教学目的而这样做，为什么不根据 编写自己的易于使用`sort()`的`qsort()`？没有像您正在寻找的那样简单的标准功能，因此实现您自己的功能是最佳选择。

```
int compare(const void *a, const void *b) {
    return (*(int *)a > *(int *)b) - (*(int *)a < *(int *)b);
}

void sort(int *arr, size_t len) {
    qsort(arr, len, sizeof(int), compare);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-08-03T08:13:30.517

**如果您正在阅读本文，您将对排序有所了解 **

```
package com.alindal.sort;
import java.util.Scanner;

public class Sort {

    public static void main(String[] args) {

        // TODO Auto-generated method stub

        int[] numers;
        System.out.println("Enter the number of elements: ");

        Scanner n=new Scanner(System.in);
        int x=n.nextInt();
        int[] srt=new int[10];
        for(int i=0;i<x;i++)
        {
            srt[i]=n.nextInt();
            }

        System.out.println("The sorted numbers :");
        for(int i=0;i<x-1;i++)
        {
            for(int j=i+1;j<x;j++)
            {

                if(srt[i]>srt[j])
                {
                    int temp=srt[i];
                    srt[i]=srt[j];
                    srt[j]=temp;

                }
                else{
                    srt[i]=srt[i];
                srt[j]=srt[j];
            }

        }

        for(i=0;i<x;i++)
        {
        System.out.println(srt[i]);
        }
        }
    }
} 
```

# ios - renderInContext 翻转 colorWithPatternImage 的原点

> ID：13445850
> 
> 赞同：7
> 
> 时间：2012-11-18T23:46:37.883
> 
> 标签：ios

我有`UIView`with `backgroundColor`set with `colorWithPatternImage`。正如预期的那样，背景图像从**左上角**开始绘制。

当我`renderInContext`在该视图上进行操作时出现问题：背景图像是从左下角开始绘制**的**。其他一切似乎都很好。

这是源图像和目标图像：

![在此处输入图像描述](../Images/c4ebe3739105692b39ab12e8aff719ce.png)

这是代码：

```
// here is the layer to be rendered into an image
UIView *src = [[UIView alloc] initWithFrame:(CGRect){{0, 0}, {100, 100}}];
src.backgroundColor = [UIColor colorWithPatternImage:[UIImage imageNamed:@"background.png"]];
[self.view addSubview:src];

// here we'll display the image
UIImageView *dest = [[UIImageView alloc] initWithFrame:(CGRect){{110, 0}, src.bounds.size}];
[self.view addSubview:dest];

// render `src` to an image in `dest`
UIGraphicsBeginImageContext(src.bounds.size);
CGContextRef context = UIGraphicsGetCurrentContext();
[src.layer renderInContext:context];
dest.image = UIGraphicsGetImageFromCurrentImageContext();
UIGraphicsEndImageContext(); 
```

有没有办法让图像以正确的方向平铺，就像在`src`视图中一样？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-03T11:19:35.130

我设法通过调用高度为 modf(viewHeight, patternHeight) 的 CGContextSetPatternPhase 来解决这个问题

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T11:51:09.320

[https://developer.apple.com/library/ios/#documentation/GraphicsImaging/Conceptual/drawingwithquartz2d/dq_overview/dq_overview.html#//apple_ref/doc/uid/TP30001066-CH202-CJBBAEEC](https://developer.apple.com/library/ios/#documentation/GraphicsImaging/Conceptual/drawingwithquartz2d/dq_overview/dq_overview.html#//apple_ref/doc/uid/TP30001066-CH202-CJBBAEEC)

该文档解释了为什么会发生这种情况，特别是这一部分：

重要提示：如果您打算在 iOS 上编写直接针对 Quartz 的应用程序，上述讨论对于理解这些内容是必不可少的，但这还不够。在 iOS 3.2 及更高版本中，当 UIKit 为您的应用程序创建绘图上下文时，它还会对上下文进行额外的更改以匹配默认的 UIKIt 约定。特别是，不受 CTM 影响的图案和阴影被单独调整，以便它们的约定与 UIKit 的坐标系相匹配。在这种情况下，没有与 CTM 等效的机制，您的应用程序可以使用它来更改 Quartz 创建的上下文以匹配 UIKit 提供的上下文的行为；您的应用程序必须识别它正在绘制的上下文类型并调整其行为以匹配上下文的期望。

# javascript - EaselJS、Canvas、位图图像质量低且注册点不起作用

> ID：13445852
> 
> 赞同：4
> 
> 时间：2012-11-18T23:46:37.030
> 
> 标签：javascript, canvas, bitmap, coffeescript, easeljs

我刚开始在我正在处理的项目中使用 EaselJS，但我对位图类有点卡住了。我所做的是将 3000 x 4000 图像添加到画布/舞台，并让用户缩放和旋转它。我主要使用以下功能：

```
@width = 3000
@height = 4000
@scale = 0.2

@bitmap.setTransform( 0, 0, @scale, @scale, 200, 0, 0, @width*@scale/2, @height*@scale/2 ) 
```

除了注册点之外，这一切都有效。给函数的数字是图像宽度/高度的一半，所以应该不错。但旋转仍然不是从中心..

此外，我正在寻找一种方法来提高此位图或舞台的质量。当位图缩放到 0.2 时，图像根本不可见，只有一堆大块/像素。

希望有人可以在这里帮助我，

提前致谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-19T13:50:23.417

愚蠢的错误，我的画布被放大了，所以即使图像没有被缩放，质量也很低。

width 和 height**属性**定义了画布**分辨率**。

**css 样式**的宽度和高度定义了画布的**大小**。

对于每个有质量问题的人，您可以对画布进行过采样：

```
<style>
  canvas {
    width:200px;
    height:100px;
  }
</style>

<canvas width='400' height='200' /> 
```

来源： [http ://blog.headspin.com/?p=464](http://blog.headspin.com/?p=464)

# java - 摩尔斯电码 - 二叉树

> ID：13445853
> 
> 赞同：0
> 
> 时间：2012-11-18T23:46:46.990
> 
> 标签：java, binary-tree, binary-search-tree, morse-code

如何确定字母的摩尔斯电码表示？

“E”=“。” “T”=“-”

为什么不是字母？如 let "A" = ".", "B" = "-", "C" =".-" 等等。

我正在尝试为充满这些字母的遍历二叉树开发一种算法。

我的主要目标是搜索一个字母，例如“A”，但我不知道使用什么条件来确定何时分支到右侧或左侧节点。

编辑

这就是我试图做的。在这里，我试图跟踪路径。但是当我用像“E”这样的字母尝试它时，它说根是空的。

```
static boolean treeContains( Node root, String item ) {
     // Return true if item is one of the items in the binary
         // sort tree to which node points.   Return false if not.
     if ( root == null ) {
           // Tree is empty, so it certainly doesn't contain item.
         System.out.print("Is null");
        return false;
     }
     else if ( item.equals(root.element) ) {
           // Yes, the item has been found in the root node.
        return true;
     }
     else if ( item.compareTo(root.element) < 0 ) {
           // If the item occurs, it must be in the left subtree.
           // So, return the result of searching the left subtree.
        res = res.concat(".");
        return treeContains( root.right, item );
     }
     else {
           // If the item occurs, it must be in the right subtree.
           // So, return the result of searching the right subtree.
        res = res.concat("-");
        return treeContains( root.left, item );
     }
  }  // end treeContains() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T23:53:05.493

如果你有一个带有字母的二叉树，那么让左边是一个点 (.)，右边是一个破折号 (-)。当您遍历树时，通过跟踪路径，您就知道每个字母的二进制代码是什么。

编辑

查看您的代码，您没有正确遍历树。首先，我不确定变量`res`是什么，但我敢打赌它是静态的，这不是好的编码习惯。

您真正的问题是您的比较`item.compareTo(root.element) < 0`不是这棵树的有效比较。相反，您应该使用递归调用作为测试，`treeContains( root.right, item )`. 只有当这返回 true 时，您才能将点 (.) 附加到您的`res`字符串。如果它返回 false，那么您可以使用`root.left`并附加破折号 (-) 进行递归调用。

就个人而言，我会从此方法返回一个字符串。到目前为止，该字符串将是该字母的莫尔斯电码，如果未找到该字母，则为 null。当您从正确的树遍历返回时，构建正确的字符串（您现在用于 res 的字符串）。

要测试的是，您可能必须连接到字符串的前面而不是字符串的后面才能使事情正确。

这棵树的真正用处在于解码莫尔斯电码，将点划线字符串转换为正确的字母。这变成了一个简单的树遍历。

# vb.net - Visual Basic 两个面板全屏显示？

> ID：13445854
> 
> 赞同：0
> 
> 时间：2012-11-18T23:46:49.867
> 
> 标签：vb.net, layout, size, panel

如图所示制作这些布局时我感到很尴尬（[预览链接](http://dl.dropbox.com/u/8961569/misc/vb-layout-panel-neeedhelp.png)）

我有4个面板。红色面板是外部。我使用 FlowLayout。黑色面板是我使用普通面板的内部面板。然后，我有绿色面板，它实际上是蓝色面板的新容器。

现在，我的问题是......

1.  如果我想让 Panel-4 增长（拉伸）直到屏幕的边缘（右），有什么解决方案。
2.  如果我使用 TableLayout 面板作为 Panel-4 和 Panel-3 的基本面板，是否合适？但是，如果我为该 TableLayout 应用 Dock : FIll，它似乎只拉伸垂直尺寸，而不是所有（V 和 H）尺寸。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T00:23:33.030

我会移除外部的红色面板，让一个面板停靠在左侧，然后做一个填充右侧的拆分面板，然后修改上面板（拆分面板的面板 1 属性）如何增长的设置。您基本上会说底部面板（拆分面板的面板 2）是固定面板。

# php - time() 以及 PHP 如何解析脚本

> ID：13445859
> 
> 赞同：0
> 
> 时间：2012-11-18T23:47:29.587
> 
> 标签：php

我放在`$START_TIME = time();`代码的开头和代码`$END_TIME = time();`的末尾。然后我做了`echo ($END_TIME - $START_TIME);`并收到了〜的差异`4`。

我的问题是，*这种测量解析/处理时间的方法有多不准确？为什么？*

编辑：我拿出了我的问题的愚蠢部分:) 剩下的问题仍然存在！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-18T23:49:16.557

`time()`自“unix big bang”以来，给了你几秒钟的时间。您想要的是`microtime(true)`（[请参阅此处的文档](http://www.php.net/manual/en/function.microtime.php)），它为您提供微秒。

# php - 网站的 PHP 和 MYSQL 登录系统，卡在用户创建上

> ID：13445863
> 
> 赞同：1
> 
> 时间：2012-11-18T23:48:13.953
> 
> 标签：php, mysql, pdo

我正在尝试为我的网站编写用户登录系统。我在笔记本电脑上运行 WAMP 并使用 Aptana 进行开发。我一直试图让用户创建功能工作大约 3 天。这个功能在这里：

```
function create_new_user($email, $pass, $level){
$db = new PDO('mysql:host=localhost;dbname=jadams', 'root', '');
$insertQuery = "INSERT INTO jadams.user VALUES ($email, $pass, $level);";
$db->query($insertQuery);
return TRUE;
} 
```

我已经多次重写了这个函数，使用准备好的语句和各种形式的条件检查，这只是最简单的一个，希望能弄清楚。无论我尝试什么，我都无法将插入到数据库中。我已经通过 phpMyAdmin 强行插入用户来获得这个登录功能：

```
function is_pass_correct($email, $pass){
$db = new PDO('mysql:host=localhost;dbname=jadams', 'root', '');
$email = $db->quote($email);
$selectQuery = "SELECT password FROM jadams.user WHERE email = $email;";
$rows = $db->query($selectQuery);
$db=NULL;
if($rows) {
    foreach ($rows as $row) {
        if($pass === $row["password"]) {return TRUE;}   //MD5
    }
}
return FALSE;
} 
```

我的数据库的结构是 email varchar(256) not null primary, password varchar(256) not null, access int; 我也尝试过使用和不使用分号的查询。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-18T23:57:47.907

您缺少要在其中插入值的列名。

```
"INSERT INTO jadams.user (email, password, level) VALUES ($email, $pass, $level);" 
```

此外，由于您使用的是 PDO 库，请考虑使用准备好的语句来转义不受信任的数据。

```
$insertQuery = "INSERT INTO jadams.user (email, password, level) 
                VALUES (:email, :password, :level)";
$db = $conn->prepare($insertQuery);
$db->execute(array(':email'=>$email,
                   ':password'=>$pass,
                    ':level'=>$level)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T23:59:17.360

你有错误吗？

如果不知道完整的数据库结构，就很难诊断，但乍一看，该表中的列可能与您提供的值不匹配。

从技术上讲，列名不是必需的，但如果您不提供它们，那么您必须按顺序为每列提供适当的值。如果`userID`您未设置某个或其他字段，则可能是问题所在。

[从手册](http://dev.mysql.com/doc/refman/5.5/en/insert.html)：

> 如果您没有为 INSERT ... VALUES 或 INSERT ... SELECT 指定列名列表，则表中每一列的值必须由 VALUES 列表或 SELECT 语句提供。

为了安全起见，我建议明确设置列名，如下所示：

```
INSERT INTO 
   jadams.user (email, password, level) 
VALUES ($email, $pass, $level) 
```

我个人更喜欢 INSERT INTO ... SET 语法。它感觉更具可读性并且不太容易混淆列。

```
INSERT INTO 
    jadams.user 
SET 
    email = $email, 
    password = $password 
    level = $level 
```

当然，这不涉及[参数绑定](http://php.net/manual/en/pdostatement.bindparam.php)、[密码存储](http://php.net/manual/en/faq.passwords.php)以及您还想考虑的其他一大堆问题。

查询末尾的分号也可能导致问题。我知道对于旧的 mysql_* 函数，手册明确指出您不应该**在**查询末尾使用分号。但是，在 PDO 中没有任何内容。我*认为*现在在末尾有一个分号很好，但我会尝试删除它，看看会发生什么。（可能什么都没有）。

# java - 用于在 URI 模板 (RFC 6570) 中提取值的独立 Java 实现？

> ID：13445870
> 
> 赞同：10
> 
> 时间：2012-11-18T23:48:52.243
> 
> 标签：java, parsing, jax-rs, restlet, uritemplate

是否有 Java 独立实现来提取 URI 中由 URI-Template (RFC 6570) 定义的参数值？

我发现的最佳实现是 ruby​​ 实现（[https://github.com/sporkmonger/addressable](https://github.com/sporkmonger/addressable)）

通过[http://code.google.com/p/uri-templates/wiki/Implementations](http://code.google.com/p/uri-templates/wiki/Implementations)我找到了一个 Java 实现：Handy-URI-Templates

它支持将带有参数值的 URI-Template 解析为最终 URI。不幸的是，它不能做相反的事情：根据 URI-Template 提取 URI 中的参数值。

JAX-RS（或 Restlet）的实现在内部具有此功能。但似乎没有人能够独立使用这个可以独立使用的功能模块。

有人有其他想法吗？

* * *

这是使用 spring-Web 的示例：

```
import org.springframework.web.util.UriTemplate;

public class UriParserSpringImpl implements UriParser {

  private final UriTemplate uriTemplate;
  private final String uriTemplateStr;

  public UriParserSpringImpl(final String template) {
    this.uriTemplateStr = template;
    this.uriTemplate = new UriTemplate(template);
  }

  @Override
  public Map<String, String> parse(final String uri) {
    final boolean match = this.uriTemplate.matches(uri);
    if (!match) {
      return null;
    }
    return uriUtils.decodeParams(this.uriTemplate.match(uri));
  }

  @Override
  public Set<String> getVariables() {
    return Collections.unmodifiableSet(new LinkedHashSet<String>(this.uriTemplate.getVariableNames()));
  }
} 
```

另一个泽西岛（JAX-RS 实现）：

```
import com.sun.jersey.api.uri.UriTemplate;
public class UriParserJerseyImpl implements UriParser {

  private final UriTemplate uriTemplate;

  private final Map<String, String> valuesMaps;

  public UriParserJerseyImpl(final String template) {
    this.uriTemplate = new UriTemplate(template);
    final Map<String, String> valuesMaps = new HashMap<String, String>();
    for (final String prop : this.uriTemplate.getTemplateVariables()) {
      valuesMaps.put(prop, null);
    }
    this.valuesMaps = Collections.unmodifiableMap(valuesMaps);
  }

  @Override
  public Map<String, String> parse(final String uri) {
    final Map<String, String> values = new HashMap<String, String>(this.valuesMaps);
    final boolean match = this.uriTemplate.match(uri, values);
    if (!match) {
      return null;
    }
    return values;
  }

  @Override
  public Set<String> getVariables() {
    return this.valuesMaps.keySet();
  }
} 
```

带接口：

```
public interface UriParser {
  public Set<String> getVariables();
  public Map<String, String> parse(final String uri);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-12-17T20:23:30.673

该死的[uri 模板库](https://github.com/damnhandy/Handy-URI-Templates)有一个针对此功能的[未解决问题。](https://github.com/damnhandy/Handy-URI-Templates/issues/2)我已经获得了合并功能的 PR，它应该在 2.2 版中发布！去那里，让维护人员知道你感兴趣。

此外，如果您等不及，您可以[在这里](https://github.com/damnhandy/Handy-URI-Templates/pull/54)查看我是如何做到的，并为自己使用它。

* * *

## 回答 #2

> 赞同：-5
> 
> 时间：2015-04-03T15:05:15.377

java.net.URI

实例化后无法设置参数，但它有一组很好的 getter，您可以构建一个新的来更改它。

# debugging - 为什么黄色箭头不应该返回nemiver？

> ID：13445875
> 
> 赞同：0
> 
> 时间：2012-11-18T23:49:51.460
> 
> 标签：debugging, gdb, gnome

我使用 Nemiver 0.9.2，但我不明白为什么“当前执行的行”（由黄色箭头标记）在我点击`F6`（下一步）时经常返回。

这是在 sshd 上使用 nemiver 的示例：

1）我从以下内容开始： `nemiver $(pwd)/build-deb/sshd -p 1234 -d`

2) Nemiver 启动并到达 main() 上的断点： ![第 1322 行的黄色箭头](../Images/6dba30df5c95d80725eea4062ab3e406.png)

3）我点击`F6`，nemiver 跳过所有变量声明并在第一条指令处停止： ![第 1340 行的黄色箭头](../Images/10ccc2cac9e169370a102726e3578d4e.png)

4）我`F6`第二次击中，我又回到了 main() ！ ![回到第 1322 行的黄色箭头](../Images/de8108dab1d863a1c24d6af832fd0716.png)

你知道为什么 nemiver 会这样吗？它是“正常的”还是一个错误？调试的时候很烦

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T00:38:10.563

您应该寻找的一件事是优化。如果编译后的代码经过优化，那么源代码并不总是匹配，您最终会得到一个跳线标记。

# c# - Monodroid 和 adMob 插页式广告

> ID：13445876
> 
> 赞同：0
> 
> 时间：2012-11-18T23:49:57.273
> 
> 标签：c#, android, xamarin.android, admob

我在 Monodroid 中看到了将 admob 横幅用于使用 JNI 环境的应用程序以与 java 对象通信的示例。

是否有示例如何实施和使用 admob 插页式全屏广告？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T00:20:07.657

您将使用更新和更简单的 Java 绑定库而不是 JNI。[这](http://docs2.xamarin.com/android/Samples/Details/AdMob)是来自 Xamarin 的示例，介绍了如何在 Mono for Android 中使用 Admob。Java 绑定库使您能够创建可以从 Mono for Android 项目调用的 Java 库版本。有关绑定 Java 库的更多信息，请点击[此链接](http://docs.xamarin.com/Android/Guides/Advanced_Topics/Java_Integration_Overview/Binding_a_Java_Library_%28.jar%29)。

# r - 尽管有 NA，我如何将拟合（gamm4.model）值与 DF 匹配？

> ID：13445880
> 
> 赞同：1
> 
> 时间：2012-11-18T23:50:28.597
> 
> 标签：r, merge

我正在尝试使用[gamm4](http://cran.r-project.org/web/packages/gamm4/gamm4.pdf)模型中的拟合值，并需要它们与我正在使用的数据框中的正确行匹配。
这是我运行的模型：

```
gam.outcome <- gamm4(formula = outcome ~ male + s(gpa),
                    random = ~ (1|school),
                    data=avr, na.action="na.exclude") 
```

对于 lmer 对象，“na.exclude”选项将 NA 保留在拟合值中，以便 fit(lmer.output) 调用返回与数据帧具有相同长度和顺序的向量。但是在 gamm4 中我已经尝试过`fitted(gam.outcome$gam)`，`fitted(gam.outcome$mer)`但不知道如何处理两者的结果。后者省略了所有的 NA，尽管有“na.exclude”选项。前者包含两倍于 lmer 的 NA 值，这应该是某种线索，但我太厚了，无法理解。我所知道的是，无论哪种方式，向量都不符合原始数据。

我想有不止一种方法可以解决我的问题。我非常感谢帮助改进或标记我的问题以及回答它。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T00:27:14.847

大约（未经测试）：

```
myfitted <- numeric(nrow(avr))
myfitted[!complete.cases(avr)] <- NA
myfitted[complete.cases(avr)] <- fitted(gam.outcome$mer) 
```

或者（也未经测试）

```
avrframe <- model.frame(outcome~male+gpa+school,na.action=na.exclude)
napredict(attr(avrframe,"na.action"),fitted(gam.outcome$mer)) 
```

第一个解决方案假定其中的所有`NA`值`avr`都在您感兴趣的列中，或者与`NA`您感兴趣的列中的值在同一行中。第二个尝试自动解决这个问题。

# android - 在 android eclipse 中，我如何运行第二个类来执行一些命令？

> ID：13445882
> 
> 赞同：0
> 
> 时间：2012-11-18T23:50:39.053
> 
> 标签：android, eclipse, class

例如，mainActivity.java 文件确实是集群的，为了保持它干净，我创建了第二个 .java(class)，我将在按下按钮时执行一些代码。我根本不知道该怎么做。而且我也不确定要使用什么搜索词，因此如果已涵盖，我深表歉意。

这是我在“测试”应用程序中的内容。

我有一个主要活动，上面有一个按钮。

```
package com.test.secondclass;

import android.os.Bundle;
import android.app.Activity;
import android.content.Intent;
import android.view.Menu;
import android.view.View;
import android.widget.Button;

public class MainActivity extends Activity {

    Button startButton;
    final Intent second = new Intent(getApplicationContext(), testClass.class);

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        startButton = (Button)findViewById(R.id.button1);

        startButton.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View v) {
                // TODO Auto-generated method stub
                startActivity(second);

            }
        });
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

} 
```

现在这是我制作的“第二”类，现在记住这很短，我只是将它用于锻炼计划，然后再将其实施到我的实际程序中。

```
package com.test.secondclass;

import android.app.Activity;
import android.widget.Toast;

public class testClass extends Activity{

    public void onCreate(){
        Toast.makeText(getApplicationContext(), "Second class thinger started", Toast.LENGTH_LONG).show();
    }
} 
```

如果我尝试这个，我会立即关闭。如果我在我的主要活动开始时注释掉“意图”部分，那么程序就会运行。但它没有做我想要的。明显地。感谢大家

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T23:58:46.600

添加一个[OnClickListener](http://developer.android.com/reference/android/view/View.OnClickListener.html)以向 testClass 发送任何信息，如下所示（未经测试）：

```
button.setOnClickListener(new OnClickListener() {
    public void onClick(View v) {
        Intent secondIntent = new Intent();
        secondIntent.setClassName(myPackageName, "testClass");
        startActivityForResult(secondIntent, REQUEST_CODE);
}); 
```

参考[这里](https://stackoverflow.com/questions/3545007/button-setonclicklistener-error)和[这里](https://stackoverflow.com/questions/3343432/how-do-i-programmatically-launch-a-specific-application-in-android)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T00:22:56.587

这是我的观点：**由于您试图在没有上下文的情况下打开用户界面方法（例如 Toast），因此您正在接收强制关闭。**

**重要提示：**我假设您已经在 manifest.xml 文件中定义了这两个类！

在解释之前，我先做一个简短的说明： **Toast**：这个类打开一个快速消息，接收上下文、消息和显示时间作为主要参数； **上下文**：它是显示的“环境”。类似于视觉范围的东西，它定义了您拥有的资源。在大多数情况下，您可以使用**setContentView**方法进行设置。

**在我看来，问题解释：** “崩溃”发生是因为您在没有上下文的情况下打开 Toast 消息。活动是与视图页面非常相似的 UI 控件。如果你调用一个新的活动，它就像调用一个新的页面，所以，一个新的上下文。在第二个活动中，我没有看到任何上下文。我认为您假设上下文是从第一个活动中保留下来的，但这并不是因为它是一项新活动。

**怎么修：**

*   在第二个类中，使用**setContentView**定义布局视图，或者...
*   将您的第二个类重新实现为[Service](http://developer.android.com/reference/android/app/Service.html)，并通过**startService**调用它，或者...
*   定义一个[AIDL](http://developer.android.com/guide/components/aidl.html)机制（类似于以前的修复，但更复杂和复杂，因为它支持异步方法调用）。

希望它在某种程度上有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-19T03:47:56.070

谢谢大家的回答！！在显示 Toast 消息后，我实际上能够通过使用“stopSelf()”命令来做我想做的事。我实现了一个服务类，当我按下按钮时，testClass.java 类被调用并运行“toast”消息，然后立即通过“stopSelf()”命令退出。我通过包含一个“onDestroy()”方法来确保这一点，该方法还显示了一个简单的 toast 消息，确认服务正在停止:)。我通常使用线程来做这样的事情，但无论我做了多少格式化，它都会让主要活动变得非常混乱。所以我想有一个单独的班级我可以使用。

对于评论者 EfEs，我来自 C# 语言的 windows 编程。Android 对我来说是一个新的游乐场，我还在学习。我认为我做得很好，但不知道该怎么做。但我当时想通了。并感谢您澄清 android 中的 Activity 就像 C# 中的“WindowsForm”，它对用户来说是全新的 GUI。我不知道。但感谢大家帮助我写你的帖子！

# ruby-on-rails - Rails 授权：我可以为所有操作添加一个 before_filter 吗？不使用康康

> ID：13445885
> 
> 赞同：2
> 
> 时间：2012-11-18T23:50:50.547
> 
> 标签：ruby-on-rails, authorization, cancan

我即将为我的 Rails 应用程序实施授权。我知道我可以使用 Cancan，但就我而言，我拥有的所有角色都是：用户和管理员。我看到人们总是用角色保护模型（就像 cancan 一样）。

我对授权的看法是添加：

```
 before_filter :redirect_if_not_admin :only => :create, ... 
```

进而：

```
def redirect_if_not_admin

       if !@user.is_admin?
            redirect_to :root  
end 
```

在我所有的控制器和我想限制被访问的操作中。

Q1。这是否比限制对模型属性的访问更不安全？

Q2。有没有办法让某人绕过 before_filter 和重定向并访问我的控制器代码？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T01:53:08.277

当然——只需`before_filter`在`application_controller.rb`. 只要你的用户模型有一个方法“is_admin?” 这将正常工作。

它与任何其他方法一样安全（实际上，它*是*大多数情况下使用的方法）。绕过 before 过滤器的唯一方法是您的代码允许它。实际上，有时您希望允许特定的控制器方法，在这种情况下，您可以使用or条件覆盖`application_controller.rb`特定控制器中的过滤器。`:except``:only`

# monodevelop - 在 Windows 上的 MonoDevelop 2.8 中设置 Mono 3.0.1

> ID：13445887
> 
> 赞同：1
> 
> 时间：2012-11-18T17:45:24.810
> 
> 标签：monodevelop

我现在已经使用 windows .Net 运行时安装了 MonoDevelop 2.8.2。我想改用最新的 Mono 二进制文件 (3.0.1)。为了实现这一点，我从这里为 Windows 安装了 Mono 3.0.1

我已经通过 Tools->Options->Preferences->.NET Runtimes 在 MonoDevelop 中添加了运行时，以便它正确显示在列表中并将其设置为默认值。我确保我的项目使用这个运行时（Project->Active Runtime->Mono 3.0.1）。当我现在构建一个简单的控制台项目时，我收到以下错误：

> 构建失败。指定的可执行文件不是此操作系统平台的有效应用程序。

任何人都可以阐明这里出了什么问题吗？

# javascript - Backbone.js 与 express.js - 仅使用 POST 和 GET 同步

> ID：13445890
> 
> 赞同：0
> 
> 时间：2012-11-18T23:51:08.563
> 
> 标签：javascript, ajax, node.js, backbone.js, express

我的应用是客户端的 Backbone.js，后端的 Express.js。

我在使用主干模型和集合（他们使用 urlRoot:"/users"）与我的 API 的所有部分同步时遇到问题。 *我只能使用 GET 或 POST，不能使用 PUT 或 DELETE。* *我不允许使用更多模型* *不允许使用 jQuery ajax*

**我的 API**

**添加新用户：** 我需要使用新数据的 JSON 对 /users 进行 POST。所以我做得很好 -`this.model.save({new data...})`

**列出所有用户：** 我的 API，对 GET /users 的响应，使用正确的处理程序 - 所以，`this.collection.fetch()`- 工作正常。

**登录：** 我的 API 为此接受 POST 到 /users/login。如何向我的模型添加一个函数“logIn”，它将使用自定义同步/传递 options.url 来同步 - 或任何其他方式 - 将 POST 到 /users/login ？

**注销：** API 接受 POST 到 /users/logout - 如何使用我的骨干模型发送此请求？

**用户 ID：** 这里对于 GET /users/:id 有同样的问题

**更新用户：** POST /users/:id - 再次提出同样的问题。

***--- 所以实际上，简而言之，问题是 ---***

**实现骨干模型方法的最佳方法（或最“正确”）是什么，类似于“model.save()” - 但只是 POST/GET 到与 urlRoot 稍有不同的路径？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T23:59:52.433

您可能在这里有几个选择。一种是以支持您想要的网址的方式构建您的模型。例如，有一个`User`模型和一个`Session`模型分别处理更新用户和管理登录状态。

您可能应该做的另一件事是`url`在模型中使用该方法。

`User`你的模型中有这样的东西。（注意：使用`urlRoot`而不是在`url`这里是相同的，但对于 url 中需要的任何更复杂的东西，这是正确的方法）

```
url : function() {
  var base = "/users/";
  if(this.isNew()) {
    return base;
  } else {
    return base + this.get("id");
  }
} 
```

您可以将相同的概念扩展到您的`Session`模型中，以根据是否`Session`是新的来处理注销与登录。

**更新：**

如果您必须使用相同的模型，最好的办法是完全绕过该`Backbone.sync`方法并使用知道如何清理的成功/错误处理程序编写自定义 AJAX 调用。

```
login : function() {
  $.post("/users/login", {success: function (response) {
      // Update user as needed
    }, error: function (xhr, response) {
      // Handle errors
    }
  }
} 
```

# r - 带有制表符分隔文件的“read.table”错误

> ID：13445891
> 
> 赞同：0
> 
> 时间：2012-11-18T23:51:11.390
> 
> 标签：r

我有一个由制表符分隔的文本文档。我确实注意到文本文档中的数据后面有一堆标签，我不确定这是否是这里的问题。

我已经设置了工作目录：

> setwd("D:/Classes/CSC/gmcar_price")

然后我尝试使用

> data=read.table("gmcar_price.txt", header=T)

但是这个错误即将出现：

> 扫描错误（文件，内容，nmax，sep，dec，quote，skip，nlines，na.strings，：第 11 行没有 13 个元素

知道这里发生了什么吗？我查看了第 11 行，所有数据都在那里。

编辑：

这是数据的格式

价格，里程，制造，型号，装饰，类型，气缸，升，门，巡航，声音，皮革

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T00:01:01.927

```
 data=read.table("gmcar.price.txt", header=T, sep = "\t") 
```

感谢 shujaa，这解决了我遇到的问题。

# mysql - 为 Node JS 安装 MySQL 支持

> ID：13445897
> 
> 赞同：0
> 
> 时间：2012-11-18T23:52:56.127
> 
> 标签：mysql, node.js

我正在尝试在 Ubuntu 上安装对 NodeJS (v0.6.9) 的 MySQL 支持。我发出以下命令：

```
sudo apt-get install libmysqlclient-dev 
```

我没有错误。然后我为 Node 安装模块：

```
sudo npm install -g db-mysql 
```

再次。没有错误。但是，我确实收到了警告：

```
Checking for node path                   : not found 
```

但安装结束于：

```
'build' finished successfully (1.504s)
db-mysql@0.7.6 /usr/local/lib/node_modules/db-mysql 
```

在我的程序源中，我现在添加：

```
var mysql = require("db-mysql"); 
```

但是当我运行它时，我收到以下错误：

```
node.js:201
        throw e; // process.nextTick error, or 'error' event on first tick
              ^
Error: Cannot find module 'db-mysql'
    at Function._resolveFilename (module.js:334:11)
    at Function._load (module.js:279:25)
    at Module.require (module.js:357:17)
    at require (module.js:373:17)
    at Object.<anonymous> (/home/me/projects/node/test.js:4:13)
    at Module._compile (module.js:444:26)
    at Object..js (module.js:462:10)
    at Module.load (module.js:351:31)
    at Function._load (module.js:310:12)
    at Array.0 (module.js:482:10) 
```

它显然找不到`db-mysql`模块。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T01:24:45.537

`/usr/local/lib`默认情况下，Node.js 不会在全局模块文件夹 ( ) 中查找模块。

您需要在本地安装您的模块`npm install db-mysql`。

您可以在此处阅读有关模块解析策略的更多信息：[http ://nodejs.org/api/modules.html#modules_loading_from_node_modules_folders](http://nodejs.org/api/modules.html#modules_loading_from_node_modules_folders)

# c++ - 如何为将回调作为参数的函数编写单元测试？

> ID：13445900
> 
> 赞同：1
> 
> 时间：2012-11-18T23:53:33.120
> 
> 标签：c++, unit-testing, callback

如何为以回调函数作为参数的函数编写单元测试？

```
unsigned __int32 
MyStream::DoThis(callBackFunction in_Function, 
                 unsigned __int32 in_Length)
{
    //some code
    //some code
    return readStream->DoThis(in_Function, dataLength);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T00:01:36.140

1.  创建一个存根回调函数，该函数在其主体内引发标志。
2.  调用您的 UT 并将存根作为参数传递给您的函数。
3.  执行完成后断言该标志已升起。

# sql - 非标准排序顺序

> ID：13445902
> 
> 赞同：0
> 
> 时间：2012-11-18T23:53:41.907
> 
> 标签：sql, ruby-on-rails, ruby

我在 SQL 列中有以下数据。列类型为字符串。当我从数据库中查询这些数据时，我更愿意对其进行排序，但我想在 SQL 查询完成后，它可以用一些 Ruby 魔法来组织。还有其他列被拉出，所以这只是需要排序的列之一。

```
Expenses
$3500/MONTH
$1,000.00
STANDARD CONTRACTOR
$5,000.00 
```

数据不能更改，必须存储在同一列中（上面的示例只是测试数据）。

我想通过增加数量然后增加其余（字符串）值来组织数据。预期的结果应该是：

```
$1,000.00
$5,000.00
$3500/MONTH
STANDARD CONTRACTOR 
```

或者

```
$1,000.00
$5,000.00
STANDARD CONTRACTOR
$3500/MONTH 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T01:06:02.293

选项1（[在这里小提琴）](http://www.sqlfiddle.com/#!7/f580b/1)：

```
select expenses from table1
order by
  replace(replace(expenses, "$", ""), ",", "") regexp "[0-9.]*" desc,
  case when replace(replace(expenses, "$", ""), ",", "") regexp "[0-9.]*"
    then cast(replace(replace(expenses, "$", ""), ",", "") as real)
    else 0
  end 
```

选项2（[在这里小提琴](http://www.sqlfiddle.com/#!7/f580b/2)）：

```
select expenses from (
    select expenses,
      replace(replace(expenses, "$", ""), ",", "") expensesNormalized
    from table1
) s
order by
  expensesNormalized regexp "[0-9.]*" desc,
  case when expensesNormalized regexp "[0-9.]*"
    then cast(expensesNormalized as real)
    else 0
  end 
```

选择跑得更快的那个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T00:04:17.253

在 SQL Server 中，您可以执行以下操作：

```
order by (case when isnumeric(col) = 1 then 1 else 0 end) desc,
         (case when isnumeric(col) = 1 then cast(col as money) end),
         col 
```

对于其他数据库，您可以使用正则表达式匹配而不是 isumeric 来确定哪些是数字。

由于您使用的是 SQLite，而且我似乎能够假设所有数字都以“$”开头，所以这样的事情几乎可以工作：

```
order by (case when substr(col, 1, 1) = '$' then 1 else 0 end) desc,
         (case when substr(col, 1, 1) = '$' then cast(col as numeric) end),
         col 
```

问题是“3,500 美元/月”被视为一个数字。你可以用一个正则表达式来解决这个问题，如果你有的话。或者，如果“/”定义了这些情况，您可以使用特定的内容，例如：

```
order by (case when substr(col, 1, 1) = '$' and col not like '%/%' then 1 else 0 end) desc,
         (case when substr(col, 1, 1) = '$' and col not like '%/%' then cast(col as numeric) end),
         col 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-19T02:03:32.260

如果现有的答案在 SQLlite 中有效，那么也许它们会为您工作。因为数据非常……混乱……我倾向于尝试将其丑陋的部分封装在一个返回排序数组的方法中。

如果您有少量这样的行（例如少于 500 行），那么更简洁的排序方法是包含 Comparable 并编写一个自定义比较器，正如[在这个 SO answer 中很好地记录的那样](https://stackoverflow.com/questions/4622206/ruby-how-to-pass-a-custom-comparator-to-sort)。

# c++ - C ++：使用结构或枚举重载构造函数之间的区别？

> ID：13445903
> 
> 赞同：1
> 
> 时间：2012-11-18T23:54:03.643
> 
> 标签：c++, constructor, struct, enums, overloading

我可以使用结构或枚举来重载构造函数，它们似乎都在做同样的工作。实际上，从一个更改为另一个甚至在使用每个来区分两个可执行文件时都不会显示任何差异。但是，哪个合适？

这：

```
enum PointLocalCoord{ local };
enum PointGlobalCoord{ global };

class Point {
    Point( const PointLocalCoord, const int x, const int y )
        {  /* something */  }
    Point( const PointGlobalCoord, const int x, const int y )
        {  /* something else */  }
}; 
```

或这个：

```
struct local{};
struct global{};

class Point {
    Point( const local, const int x, const int y )
        {  /* something */  }
    Point( const global, const int x, const int y )
        {  /* something else */  }
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-18T23:57:58.430

两者都可以编译，但您应该根据逻辑选择一个。在你的情况下，我认为它应该是一个`enum`，但略有不同：

```
enum PointCoordType
{
    local,
    global
};
class Point {
    Point( PointCoordType, const int x, const int y )
        {  /* something */  }
}; 
```

甚至有两种类型的`Point`类：

```
LocalPoint : Point 
```

和

```
GlobalPoint : Point 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T00:06:13.113

两者都不好。您应该具有强语义类型，即使对于相同维度的数量，以及它们之间的*转换函数*：

```
struct LocalPoint { int x; int y; };
struct GlobalPoint { int x; int y; };

LocalPoint getLocal(GlobalPoint const & gp) { /* remainder? */ }
GlobalPoint getGlobal(LocalPoint const & lp, int offset_x, int offset_y); 
```

现在您可以直接为每个点类型创建构造函数。

这里的结果是语义点类比两个随机的、无意义的整数要好得多。

# xslt - 按顺序交换项目

> ID：13445906
> 
> 赞同：0
> 
> 时间：2012-11-18T23:54:19.757
> 
> 标签：xslt, xpath, xslt-1.0, xslt-2.0

我正在尝试使用 XSLT 编写堆排序算法。但是努力交换用于存储标记化值的变量的值。我创建了方法 heapify 用于比较值并将较大的值交换为当前索引。请任何人帮助指导我交换父列表的值。

```
<xsl:template match="/">

      <xsl:variable name="tokenizedSample" select="tokenize(.,' ')">             
    </xsl:variable>
    <!--<xsl:value-of select="."/>-->
    <xsl:call-template name="BuildHeap">
      <xsl:with-param name="intList" select="$tokenizedSample"/>
    </xsl:call-template>
  </xsl:template>

  <xsl:template name="BuildHeap">
   <xsl:param name="intList"/>
      <xsl:for-each select="$intList">
        <xsl:call-template name="Heapify">
          <xsl:with-param name="newintList" select="$intList"/>
          <xsl:with-param name="index"  select="position()"/>
        </xsl:call-template>
      </xsl:for-each>
 </xsl:template>

  <xsl:template name="Heapify">    
    <xsl:param name="newintList"/>
    <xsl:param name="index"/>
    <xsl:variable name="stringval">
      <xsl:text></xsl:text>
    </xsl:variable>
    <xsl:variable name="vIndex">
      <xsl:number value="$index" />
    </xsl:variable>

    <xsl:variable name="stringval" select="concat(($stringval),'is')"/>
    <xsl:if test="$newintList[$vIndex*2] &gt; $newintList[$vIndex*1]  and $newintList[$vIndex*2] &gt; $newintList[($vIndex*2)+1] ">

    <!—swap the values of ith position with 2ith position-->

      <xsl:for-each select="$newintList">
        <xsl:if test="position()=$vIndex">
          <xsl:value-of select="$newintList[$vIndex*2]"/>
          <xsl:value-of select="$stringval"/>
          <xsl:variable name="stringval" select="concat(($stringval),'is',$newintList[$vIndex*2])"/>
          <xsl:value-of select="$stringval"/>
        </xsl:if>

        <xsl:if test="position()=($vIndex*2)">
          <xsl:value-of select="$stringval"/>
          <xsl:variable name="stringval" select="concat(($stringval),'is')"/>
          <xsl:value-of select="$stringval"/>
          <xsl:variable name="stringval" select="concat(($stringval),'is',$newintList[$vIndex*1])"/>
        </xsl:if>

      </xsl:for-each>

<xsl:value-of select="$stringval"/>
    </xsl:if>

    <xsl:if test="$newintList[($vIndex*2)+1] &gt; $newintList[$vIndex*1]  and $newintList[($vIndex*2)+1] &gt; $newintList[$vIndex*2] ">
    <!—swap the values of ith position with 2i+1th position-->

    </xsl:if>

  </xsl:template> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T01:18:15.057

**I. 这是一个 XSLT 2.0 解决方案**：

```
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:my="my:my" xmlns:xs="http://www.w3.org/2001/XMLSchema">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:template match="/">
  <xsl:sequence select="my:swap(/*/*, 3, 7)"/>
 </xsl:template>

 <xsl:function name="my:swap" as="item()*">
  <xsl:param name="pSeq" as="item()*"/>
  <xsl:param name="pPos1" as="xs:integer"/>
  <xsl:param name="pPos2" as="xs:integer"/>

  <xsl:sequence select=
   "$pSeq[position() lt $pPos1],
    $pSeq[$pPos2],
    $pSeq[position() gt $pPos1 and position() lt $pPos2],
    $pSeq[$pPos1],
    $pSeq[position() gt $pPos2]
   "/>
 </xsl:function>
</xsl:stylesheet> 
```

**当此转换应用于以下 XML 文档时：**

```
<nums>
  <num>01</num>
  <num>02</num>
  <num>03</num>
  <num>04</num>
  <num>05</num>
  <num>06</num>
  <num>07</num>
  <num>08</num>
  <num>09</num>
  <num>10</num>
</nums> 
```

**产生了想要的正确结果**：

```
<num>01</num>
<num>02</num>
<num>07</num>
<num>04</num>
<num>05</num>
<num>06</num>
<num>03</num>
<num>08</num>
<num>09</num>
<num>10</num> 
```

* * *

**二、等效的 XSLT 1.0 解决方案**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:template match="/">
  <xsl:call-template name="swap">
   <xsl:with-param name="pSeq" select="/*/*"/>
   <xsl:with-param name="pPos1" select="3"/>
   <xsl:with-param name="pPos2" select="7"/>
  </xsl:call-template>
 </xsl:template>

 <xsl:template name="swap">
  <xsl:param name="pSeq"/>
  <xsl:param name="pPos1"/>
  <xsl:param name="pPos2"/>

  <xsl:copy-of select="$pSeq[$pPos1 > position()]"/>
  <xsl:copy-of select="$pSeq[$pPos2]"/>
  <xsl:copy-of select="$pSeq[position() > $pPos1 and $pPos2 > position()]"/>
  <xsl:copy-of select="$pSeq[$pPos1]"/>
  <xsl:copy-of select="$pSeq[position() > $pPos2]"/>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于同一个 XML 文档（如上）时，会产生相同的正确结果**：

```
<num>01</num>
<num>02</num>
<num>07</num>
<num>04</num>
<num>05</num>
<num>06</num>
<num>03</num>
<num>08</num>
<num>09</num>
<num>10</num> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T03:33:07.617

这是 Dimitre 的 XSLT 2.0 解决方案的一个调整。它在规模上效率不高，但有些人可能更喜欢提高的可读性

将 xsl:sequence 指令修改为...

```
 <xsl:sequence select="
    for $i in $pSeq,
        $p in index-of( $pSeq, $i) return
      $pSeq[
           if ($p eq $pPos1) then
               $pPos2
           else if ($p eq $pPos2) then
               $pPos1
           else
               $p]" />
   </xsl:function> 
```

## 警告：

为此，它需要 $pSeq 完全由独特的项目组成。如果序列包含重复节点或相同值的原子项，它将不起作用。但是从问题的上下文来看，这可能是一个安全的假设。

## 更新：

这是一个更好的。

```
 <xsl:sequence select="
    for $p in 1 to count($pSeq) return
      $pSeq[
           if ($p eq $pPos1) then
               $pPos2
           else if ($p eq $pPos2) then
               $pPos1
           else
               $p]" />
   </xsl:function> 
```

* * *

## 更新#2

Dimitre 和我自己对 OP 问题的解决方案都是绝对正确的。OP已经回答说他的答案*以某种方式没有给出想要的结果？*但一直无法阐明与此结果错误有关的任何相关细节。很难帮助不愿意澄清的发帖者，所以我认为我在这里能做的最有帮助的事情就是为 OP 正在尝试开发的 HeapSort 提供一个完整的解决方案。

正如其他人所说，在现实环境中，只需使用 xsl:sort。事实上，即使作为一个学术问题，它也不是一个好的学术问题，因为它与现实世界的解决方案有必要的距离，很可能会误导和混淆学生。不过，我向您展示了 Heapsort 的 XSLT 2.0 实现（使用此[维基百科页面](http://en.wikipedia.org/wiki/Heapsort)上的算法）。

## （更新说明）

请参阅 Dimitre 关于效率的评论。与本机排序 (xsl:sort) 相比，任何自定义构建的排序都将非常低效。确实没有充分的理由这样做，除非作为学术活动被迫这样做。

由于 OP 忘记提供用例，我将在这里提供一个。

**用例 1：**

**有了这个输入...**

```
<t>6 5 3 1 8 7 2 4</t> 
```

**目标是对整数进行排序并产生这个输出......**

```
<t>
   <n>1</n>
   <n>2</n>
   <n>3</n>
   <n>4</n>
   <n>5</n>
   <n>6</n>
   <n>7</n>
   <n>8</n>
</t> 
```

**此 XSLT 2.0 样式表将使用堆排序算法对整数数组进行排序...**

## （更新说明）

此样式表中有错误。我正在纠正它。

```
<xsl:stylesheet version="2.0"
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  xmlns:xs="http://www.w3.org/2001/XMLSchema"
  xmlns:fn="http://www.w3.org/2005/xpath-functions"
  xmlns:so="http://stackoverflow.com/questions/13445906"
  exclude-result-prefixes="xsl xs fn so">
<xsl:output omit-xml-declaration="yes" indent="yes" />

<xsl:template match="/*">
  <xsl:copy>
    <xsl:for-each select="so:heapsort( for $x in tokenize(.,' ') return xs:integer($x))">
      <n><xsl:value-of select="." /></n>
    </xsl:for-each>
  </xsl:copy>   
</xsl:template>

<xsl:function name="so:heapsort" as="xs:integer*">
  <xsl:param name="a" as="xs:integer*" />
  <xsl:sequence select="so:one-heapsort( so:heapify( $a, count($a) idiv 2), count($a))" />
</xsl:function>

<xsl:function name="so:one-heapsort" as="xs:integer*">
  <xsl:param name="a" as="xs:integer*" />
  <xsl:param name="end" as="xs:integer" />
  <xsl:choose>
    <xsl:when test="$end gt 0">
      <xsl:sequence select="so:one-heapsort(
        so:siftDown( so:swap( $a, 1, $end), 1, $end - 1),
        $end - 1)" />
    </xsl:when>
    <xsl:otherwise>
      <xsl:sequence select="$a" />
    </xsl:otherwise>
  </xsl:choose>
</xsl:function>

<xsl:function name="so:heapify" as="xs:integer*">
  <xsl:param name="a" as="xs:integer*" />
  <xsl:param name="start" as="xs:integer" />
  <xsl:choose>
    <xsl:when test="$start gt 0">
      <xsl:sequence select="so:heapify(
        so:siftDown( $a, $start, count($a)),
        $start - 1)" />
    </xsl:when>
    <xsl:otherwise>
      <xsl:sequence select="$a" />
    </xsl:otherwise>
  </xsl:choose>
</xsl:function>

<xsl:function name="so:siftDown" as="xs:integer*">
  <xsl:param name="a" as="xs:integer*" />
  <xsl:param name="start" as="xs:integer" />
  <xsl:param name="end" as="xs:integer" />

  <xsl:sequence select="
    subsequence( $a, 1, $start - 1),
    so:one-siftDown( subsequence( $a, $start, $end - $start + 1), 1),
    subsequence( $a, $end+1, count($a)-$end)
    " />
</xsl:function>

<xsl:function name="so:swap" as="xs:integer*">
  <xsl:param name="a" as="xs:integer*" />
  <xsl:param name="x" as="xs:integer" />
  <xsl:param name="y" as="xs:integer" />

  <xsl:sequence select="
    for $p in 1 to count($a) return $a[
        if ($p eq $x) then $y
        else if ($p eq $y) then $x
        else $p]" />
</xsl:function>

<xsl:function name="so:one-siftDown" as="xs:integer*">
  <xsl:param name="a" as="xs:integer*" />
  <xsl:param name="root" as="xs:integer" />

  <xsl:variable name="left-child" select="$root * 2" as="xs:integer" />
  <xsl:variable name="right-child" select="$left-child + 1" as="xs:integer" />
  <xsl:variable name="palette" select="($a[$root], $a[$left-child], $a[$right-child])" />
  <xsl:choose>
    <xsl:when test="exists( $palette)">
      <xsl:variable name="max-pos" select="index-of($palette,max($palette))[1]" />
      <xsl:choose>
        <xsl:when test="($left-child le count($a)) and ($max-pos eq 2)">
          <xsl:sequence select="so:one-siftDown(
            so:swap( $a, $root, $left-child),
            $left-child)" />
        </xsl:when>
        <xsl:when test="($right-child le count($a)) and ($max-pos eq 3)">
          <xsl:sequence select="so:one-siftDown(
            so:swap( $a, $root, $right-child),
            $right-child)" />
        </xsl:when>
        <xsl:otherwise>
          <xsl:sequence select="$a" />
        </xsl:otherwise>
      </xsl:choose>
    </xsl:when>
    <xsl:otherwise>
      <xsl:sequence select="$a" />
    </xsl:otherwise>
  </xsl:choose>
</xsl:function>

</xsl:stylesheet> 
```

# 笔记

1.  swap() 函数是 OP 在问题中要求的交换函数，除了它专门用于整数，而不是项目。
2.  您可以使用 Dimitre 的 swap 或 mine 实现。我很想知道 OP 对哪个更具可读性的意见。甚至还有第三种方法——您可以结合 subsequence() 和连接运算符 ( `,`) 。
3.  作为学术讨论点，这个样式表在 2012 年 7 月 10 日的 XSLT 3.0 工作草案中会非常简单，因为该算法非常适合新的[fn:fold-left() 函数](http://www.w3.org/TR/xpath-functions-30/#func-fold-left)。如果这个问题被概括为按任何功能对任何事物进行排序，那么这个任务将是 XSLT 3.0 草案的一个很好的展示案例。恕我直言，XSLT 3.0 草案的展示任务非常稀缺。我一直在努力[收集它们](http://seanbdurkin.id.au/pascaliburnus2/archives/10)。

# c# - Monotouch C# 通过音量控制同时播放多种声音

> ID：13445909
> 
> 赞同：2
> 
> 时间：2012-11-18T23:55:04.647
> 
> 标签：c#, xamarin.ios, avaudioplayer, system-sounds

我正在使用 Monotouch 和 C# 为 iOS 制作战争游戏。我在音频音效方面遇到了一些问题。

**这就是我需要**的：同时播放许多音效的能力（一次可能多达 10-20 个）和调节音量的能力（例如，如果用户在战场上放大，枪声音量会变大）。

**这是我的问题：**

使用 AVAudioPlayer，我可以调整音量，但每个线程只能播放 1 个声音。所以如果我想播放多个声音，我必须有几十个线程，以防它们重叠......这是一个战争游戏，想象战场上的 20 名士兵。每个士兵在射击时都会有一个“声音线程”来播放枪声，因为每个士兵都可能恰好在同一时间开火。制作大量线程没有问题，但我的游戏已经有几十个线程一直在运行，再添加几十个线程可能会给我带来麻烦……对吗？所以我宁愿不走这条增加几十个线程的路，除非我也有......

使用 SystemSound，我可以在同一个线程中播放任意数量的声音，但我无法调节音量....所以我在这里的工作是，对于我拥有的每种声音效果 - 在 4 处保存 4 次不同的卷。这是一个很大的痛苦......有什么方法可以使用 SystemSounds 调整音量？

这两个都回答了我的一些要求，但似乎都不是天衣无缝的。我应该走 AVAudioPlayer 多线程噩梦之路吗？还是 SystemSound 多文件、不同音量级别的噩梦之路？还是有更好的方法来做到这一点？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T02:30:23.860

终于找到了解决我的问题的方法。AVAudioPlayer 能够一次播放多种声音，但只能使用某些文件格式……详细信息可在此链接中找到。我无法同时播放音效的原因是因为文件格式被压缩，而iphone只有1个硬件解压缩器。

[http://brainwashinc.wordpress.com/2009/08/14/iphone-playing-2-sounds-at-once/](http://brainwashinc.wordpress.com/2009/08/14/iphone-playing-2-sounds-at-once/)

# ios - 如何在 LLDB 中找到无法识别的选择器的发送者？

> ID：13445910
> 
> 赞同：0
> 
> 时间：2012-11-18T23:55:07.263
> 
> 标签：ios, xcode, lldb

我收到一个令我困惑的“无法识别的选择器”错误。

我知道我可以“po” LLDB 中的指针来了解接收器。但是有没有办法推断出哪个对象正在发送此消息？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-20T11:28:39.960

如果您正在处理多个线程，回溯并不总是有帮助 - 您最终会在主线程上获得异常处理程序的回溯，这不一定是导致错误的那个。

但是，由于您知道特定类不存在特定的选择器，因此您可以通过使用类别将选择器添加到类中来作弊，然后在其上放置一个断点。

例如，对于这个错误：

```
-[__NSCFDictionary isEqualToString:]: unrecognized selector sent to instance 0x10004fb0 
```

我们知道有些东西试图用“isEqualToString”调用“NSDictionary”。因此，将其添加到您喜欢的任何文件的末尾，在任何其他“@implementation”块之外：

```
@implementation NSDictionary(debug)
- (BOOL)isEqualToString:(NSString*)theString {
    return FALSE;
}
@end 
```

在此设置断点，重新运行您的代码，您将获得真正的堆栈跟踪。发现错误后不要忘记删除类别！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T00:26:29.157

调试器中的命令`bt`将向您显示一个回溯（stacktrace），它应该为您提供在该输出中某处启动消息的类。

# php - Obj-C 中的 AES 加密和 PHP 中的解密

> ID：13445911
> 
> 赞同：1
> 
> 时间：2012-11-18T23:55:28.057
> 
> 标签：php, objective-c, encryption, aes

我对此很陌生。我的 PHP 回声返回垃圾。我认为我缺少一个编码步骤。

我的 OBJ-C 代码

```
NSString *key = @"12345678901234561234567890123456";

    //main path for account login PHP file
    NSString *accountURL = [NSString stringWithFormat:configManager.accountURL, username, password];

    //convert password to data and encrypt
    NSData *crypt = [[[password stringValue]dataUsingEncoding:NSUTF8StringEncoding]AES256EncryptWithKey:key];

    NSString *variables = [NSString stringWithFormat:@"?username=%@&access=%@&page=%ld",[username stringValue], crypt, [sender tag]];

    // get rid of spaces in encoded URL
    NSString *niceURLString = [variables stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding];

    //tack niceURL on to end of base URL
    NSString *goToURL = [accountURL stringByAppendingString:niceURLString];
    NSLog(@"%@", goToURL);

    [[NSWorkspace sharedWorkspace] openURL:[NSURL URLWithString:goToURL]]; 
```

PHP

```
$upswd = $_GET['access'];
    $key = "12345678901234561234567890123456";
$upswd = trim($upswd, "<>"); //remove these brackets from url

$result = mcrypt_decrypt(MCRYPT_RIJNDAEL_256, $key, $upswd, 'ecb');
//$result = utf8_decode($result);
echo ($result); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T00:29:44.510

```
 mcrypt_create_iv(
            mcrypt_get_iv_size(
                MCRYPT_RIJNDAEL_256,
                MCRYPT_MODE_ECB
            ) 
```

您正在创建一个新的 IV，您需要使用原始 IV。它通常与加密文本一起传递，由分隔符分隔，常用的分隔符是。或 | 然后，您让 PHP 在分隔符处拆分加密字符串，使用 IV 作为解密函数，并将另一部分用作加密数据。

# c# - 使用 Xdocument 进行简单的 Xml 解析

> ID：13445912
> 
> 赞同：3
> 
> 时间：2012-11-18T23:55:34.800
> 
> 标签：c#, xml-parsing, linq-to-xml

我想用 Xdocument 在 Windows 商店应用程序中解析 xml。

我试过这个，但返回null：

```
XDocument xDoc;
string title= "";

xDoc = XDocument.Load(url);

var elements = from x in xDoc.Descendants()
               select new
               {
                   title = x.Descendants("title").First().Value,
               };

foreach (var el in elements)
    _title = title; 
```

xml内容：

```
<title type='text'>tiitle</title>
<content type='text'> gfgdgdggd</content>
<link rel='related' type='application/atom+xml' href='http....'/> 
```

如何从属性中检索文本？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-20T06:05:58.537

正如 ZevSpitz 已经提到的，您的 XML 无效。我对其进行了一些修改，以便能够测试我的代码：

```
<root>
    <title type="text">title</title>
    <content type="text">gfgdgdggd</content>
</root> 
```

`type`您可以使用以下代码从属性中检索值：

```
XDocument xDoc = XDocument.Parse(xml);

var types =
    from x in xDoc.Root.Descendants()
    select x.Attribute("type").Value; 
```

在我的情况下`xml`，声明如下：

```
private string xml =
    @"<root>
        <title type=""text"">title</title>
        <content type=""text"">gfgdgdggd</content>
    </root>"; 
```

如果文件内容相同，您仍然可以使用您的代码从 URL 加载 XML。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-18T23:59:52.400

尝试：

```
var types =
    from e in xDoc.Descendants()
    select (string)e.Attribute("type");

foreach (string type in types) {
    Console.WriteLine(type);
} 
```

# c - “uint8_t”类型的参数与“uint8_t *”类型的参数不兼容

> ID：13445917
> 
> 赞同：2
> 
> 时间：2012-11-18T23:57:09.580
> 
> 标签：c, pointers, embedded, keil

我正在尝试在 Keil 上为 STM32F4-Discovery编译[USB HID 示例代码。](http://translate.google.fr/translate?hl=fr&sl=cs&tl=en&u=http%3A%2F%2Fmcu.cz%2Fcomment-n2848.html)这段代码允许我向一个名为“USB HID Demonstrator”的软件发送和接收消息。

但是我的`USBD_HID_DataOut`功能有问题。该行：

`USB_OTG_ReadPacket((USB_OTG_CORE_HANDLE*)pdev, *Buffer, HID_OUT_PACKET);`

给我一个错误：

> 错误 #167：“uint8_t”类型的参数与“uint8_t *”类型的参数不兼容

当我抑制`*`of`Buffer`时，代码编译但似乎不起作用（收到的缓冲区值与预期不匹配，但我可能错了）实际上第二个参数 of`USB_OTG_ReadPacket`必须是指针所以我不'不明白为什么会发生此错误。

`Buffer`变量定义如下：`uint8_t Buffer[6];`

那么编译器有问题吗？自从它首次为 Atollic 创建以来，我是否必须处理将此项目代码复制到 Keil 中的特殊问题？

或者只是链接中有错误？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-19T00:27:56.457

通过 没有意义`*Buffer`，因为这意味着与 相同`Buffer[0]`。你为什么要写作`*Buffer`而不是`Buffer[0]`一开始？`Buffer`甚至没有声明为指针，那么为什么要取消引用它呢？（你可以，但它看起来不正确。）

如果函数需要一个指针，那么传递`Buffer`是正确的，因为它的含义与`&Buffer[0]`.

试着澄清你的问题。*你*想传递给函数的是什么？您想将 Buffer 数组中的第一个 uint8_t 元素传递给它吗？在这种情况下，你想传递`Buffer[0]`or `*Buffer`（两者的意思相同）或者你想传递一个指向数组的指针？在这种情况下，通过`Buffer`或`&Buffer[0]`（两者都是等价的。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T14:01:43.967

如果您查看文件`usbd_hid_core.c.bak`的同一行，您可以看到作者正确地调用了该函数：

`USB_OTG_ReadPacket((USB_OTG_CORE_HANDLE*)pdev, Buffer, HID_OUT_PACKET);`

由于它被声明为数组，因此您只需要传递变量名称，原因 Nikos C. 提到。有关将指针传递给函数的更多信息，请参阅[此 Daniweb 线程帖子](http://www.daniweb.com/software-development/c/threads/11705/c-language-problm-how-to-pass-pointer-to-a-function#post57647)。

如果您没有收到预期值，则需要调试该信息的流程。我建议添加`Buffer`到 Watch 窗口并单步执行您的程序，以查看您的`Buffer`实际值是什么，以及它是否在某个意外点发生变化。

# javascript - 初始数据加载和后续添加之间的流星不同

> ID：13445927
> 
> 赞同：0
> 
> 时间：2012-11-18T23:57:59.157
> 
> 标签：javascript, meteor

我有一个一次加载 50 章的应用程序。在查看章节时，我希望应用程序在加载新章节时播放声音。这就是我认为应该这样做的方式

```
Chapters.find().observe({
  added: function (user) {
    playSound()
  }
}); 
```

但是，这会在初始加载时发出垃圾声音，而不仅仅是后续的新章节。如何让它只在新章节中响起？

编辑：寻找流星的答案，而不是 setTimeout 什么的。虽然如果我必须这样做，我会这样做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T11:07:34.397

`observe`在添加回调之前，您可以等待第一个完整的章节加载。

```
Meteor.subscribe("chapters", someParam, function(){
    Chapters.find().observe({
      added: function (user) {
        playSound()
      }
    }); 
}); 
```

当然，您应该只添加一次观察者，而不是每次触发订阅回调时。

# liferay - 如何判断门户页面上是否有 portlet？

> ID：13445928
> 
> 赞同：1
> 
> 时间：2012-11-18T23:58:05.393
> 
> 标签：liferay, portlet, liferay-6

我需要根据 portlet 组范围首选项为组织的所有组运行一些**cron作业。**

如果我将 portlet 添加到组织页面，为 portlet 设置一些首选项，然后删除 portlet，则不会删除首选项并且 cron 作业继续执行任务。

有什么方法可以确定一个 portlet 已被删除，或者没有具体`id`连接到特定portlet 的 portlet `groupId`？

环境：Liferay 6.1

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T00:36:05.163

您可以使用`PortalUtil.getPlidFromPortletId(long groupId, String portletId)`它将返回`plid`portlet 所在的那个，或者`0`如果它不在任何页面上。

# javascript - 单击带有数据属性的JQuery

> ID：13445929
> 
> 赞同：20
> 
> 时间：2012-11-18T23:58:06.243
> 
> 标签：javascript, jquery

> **可能重复：**
> [按数据属性选择元素](https://stackoverflow.com/questions/2487747/selecting-element-by-data-attribute)

我正在尝试收听具有特定数据属性的元素何时被单击，但我似乎无法让 on click 工作，而且我确信这对我来说很容易，我错过了。我有

```
<a href="/home" data-spinner="true" /> 
```

```
$.data('record').click(function() {
         //Do Action
}); 
```

我有变化。我的问题是，如何在点击时使用数据属性？

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2012-11-19T00:01:35.480

轻松解决您的问题：（未测试）

```
$('a[data-spinner="true"]').click(function(event) {

}); 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-11-19T04:51:30.250

这将选择所有具有 data-spinner 属性的元素，而不管该属性的值如何。

```
 $( "[data-spinner]" ).live( "click", function () {
        console.log('clicked');
    } ); 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-11-18T23:59:59.957

以下代码将`click`事件绑定到[属性等于的](http://api.jquery.com/attribute-equals-selector/)`<a>`所有元素：`data-spinner` `true`

```
$("a[data-spinner='true']").click(function() {
    //Do Acction
}); 
```

# linux - PHP fopen“无法打开流：资源暂时不可用”

> ID：13445932
> 
> 赞同：4
> 
> 时间：2012-11-18T23:58:17.863
> 
> 标签：linux, apache, php

编辑：评论中的奥斯汀解决了我的问题。既然这是答案，我该如何结束这个问题？

我有以下简单的代码来打开/写入服务器上的查询文件。我已经检查了权限，甚至为查询文件上的所有用户设置了 +rw，但我仍然收到错误

> 无法打开流：资源暂时不可用

在我的 apache 错误日志中。

我不确定我能做些什么来缓解这个问题，想法？

```
<?php 
// filepaths
$queryFile = '../query/query.txt';

// get query
$query = $_GET['searchBox'];

// open and write query to query file
$fh = fopen($queryFile, 'X') or die("Can't open file");
fwrite($fh, $query);
fclose($fh); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T00:02:13.050

它只能是以下几件事之一：

*   PHP 进程内存不足、文件句柄不足或类似情况
*   不知何故超出了 PHP 环境自身的限制
*   该文件本身有一些限制，例如 SELinux（安全增强型 Linux）限制。

要确定它是什么，请尝试在 PHP 之外打开该文件。临时更改脚本以打开不同的文件。查看脚本还做了什么来验证它是否可能用完文件句柄等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-19T00:01:18.447

`is_file($queryFile)`和`is_writable($queryFile)`揭示什么？也许您不在正确的工作目录中？

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2019-06-18T18:52:14.773

参数`'X'`应为小写。

# c++ - For循环设置变量为条件

> ID：13445936
> 
> 赞同：1
> 
> 时间：2012-11-18T23:58:59.773
> 
> 标签：c++, variables, for-loop

我的 for 循环中的计数器变量在第一次进入循环时被设置为条件的值。我从来没有听说过这种情况，一个月前我在同一个系统上写了一个非常相似的代码版本，没有这个问题。

这是由 Microsoft Visual Studio 6.0 Visual C++ 在 64 位 Windows Vista 计算机上编译和构建的。我已经注释掉了所有不必要的代码，但它仍然导致了这个错误。删除所有注释的代码如下：

主.cpp：

```
#include "stdafx.h"

using namespace std;

int main(int argc, char* argv[])
{ 

cout<<"Simple Watch Region Test\n";
cout<<"-----------------------\n";

//get number of tracks
cout<<"  Enter Number of Tracks to Run: ";
unsigned int totalNumberOfTracksToRun;
cin>>totalNumberOfTracksToRun;

unsigned short currentTrack = 0;
cout<<"currentTrack starts at "<<currentTrack<<endl;

for( currentTrack; currentTrack < totalNumberOfTracksToRun; currentTrack++);
{

    cout<<"current is "<<currentTrack<<endl;

     }

    return 0; 
```

}

stdafx.h：

```
#if !defined(AFX_STDAFX_H__9455C912_1697_486F_A680_AAE1D0B22611__INCLUDED_)
#define AFX_STDAFX_H__9455C912_1697_486F_A680_AAE1D0B22611__INCLUDED_

#if _MSC_VER > 1000
#pragma once
#endif // _MSC_VER > 1000

#include <iostream>
#include <fstream>
#include <math.h>
#include <string> 
```

输出是：

```
Simple Watch Region Test
-----------------------
  Enter Number of Tracks to run: 5
currentTrack starts at 0
current is 5
Press Any Key to continue 
```

谢谢你的想法。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-19T00:01:11.180

您的 for 语句末尾有一个分号：

```
for( currentTrack; currentTrack < totalNumberOfTracksToRun; currentTrack++);
                                                     // get rid of this ---^ 
```

这意味着 for 循环运行，什么也不做，直到`currentTrack`等于，`totalNumberOfTracksToRun`然后才执行以下块。这就是为什么它似乎`currentTrack`立即跃升至 5。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-19T00:01:16.797

你有一个流浪者`;`：

```
for( currentTrack; currentTrack < totalNumberOfTracksToRun; currentTrack++);
//                                                                         |
//                                                                       here 
```

这意味着只有在到达下一行之前`for`才会增加。`currentTrack``totalNumberOfTracksToRun`

# sql-server - 使用 aspnet 架构和 UserRepository/EF ASPNET MVC 4 创建用户

> ID：13445942
> 
> 赞同：1
> 
> 时间：2012-11-18T23:59:46.710
> 
> 标签：sql-server, asp.net-mvc, linq, repository, entity-framework-mapping

我有一个关于在我的 bd 中创建用户的问题。我使用 userRepository 在 aspnet 模式中创建用户。

所以为了创建一个用户，我必须在 aspnet_user 和 aspnet_membership 表中创建一行

userId 是一个身份密钥，所以是我的 bdd 管理这个......所以现在，我的 UserRepository 类中有这个代码：

```
 public aspnet_User CreateUser(string username, string password, string email)
    {
        using (WebsiteEntities db = new WebsiteEntities())
        {
            aspnet_User user = new aspnet_User();

            user.UserName = username;
            user.Email = email;

            db.aspnet_User.Add(user);
            db.SaveChanges();

            **User u = GetUser(username);**

            Aspnet_Membership member = new Aspnet_Membership();

            member.UserId = u.UserId;
            member.PasswordSalt = CreateSalt();
            member.Password = CreatePasswordHash(password, user.PasswordSalt);
            member.CreateDate = DateTime.Now;
            member.IsApproved = false;
            member.IsLockedOut = false;
            member.LastLockoutDate = DateTime.Now;
            member.LastLoginDate = DateTime.Now;

            db.aspnet_Membership.Add(member);
            db.SaveChanges();

            return u;
        }
    } 
```

但是，我不认为这是使用 aspnet_User 和 aspnet_Membership 之间的外键创建用户的好方法......在这里，我有一个唯一的用户名，但如果不是，我不知道我会怎么做完毕 ...

有人可以帮助我吗？感谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T03:22:46.300

您应该通过成员资格框架添加新成员。完成后获取 UserId 用作外键。

这就是我所做的，它可能并不理想，但它对我有用：

```
 var createStatus = MembershipService.CreateUser(model.UserName, model.Password, model.Email);

  if (createStatus == System.Web.Security.MembershipCreateStatus.Success)
  {
    var newUser = new User();

    newUser.DisplayName = model.DisplayName;
    newUser.Email = model.Email;
    newUser.UserUnits.Add(new UserUnit { UnitId = model.UnitId, Status = (int)UserUnitStatus.Request });

    using(var db = new Entities())
    {

    var temp = db.aspnet_Membership.Single(a => a.LoweredEmail == newUser.Email.ToLower());

    newUser.GUID = temp.UserId;

    db.Users.AddObject(newUser);

    try
    {
      db.SubmitChanges()
    }
    catch
    {
      MembershipService.DeleteUser(model.UserName);
      throw;
    }

    return RedirectToAction("Welcome");
  } 
```

# python - 在 Python 中使用 GTK 和 Xlib

> ID：13445945
> 
> 赞同：4
> 
> 时间：2012-11-18T23:59:55.147
> 
> 标签：python, gtk, xlib

我正在编写一些需要从 GTK+ 下拉到 Xlib 的代码。具体来说，我想将顶层窗口的图标设置为窗口本身，而不是像素图，以便编写 GTK+ Window Maker dockapp。

我让它在 C 中工作如下：

```
gdkDockapp = gtk_widget_get_window(dockapp);
xDockapp = GDK_WINDOW_XID(gdkDockapp);

gdkDisplay = gdk_window_get_display(gdkDockapp);
xDisplay = GDK_DISPLAY_XDISPLAY(gdkDisplay);

wmhints.icon_window = xDockapp;
wmhints.flags = IconWindowHint;
XSetWMHints(xDisplay, xDockapp, &wmhints); 
```

但是，我希望在 Python 中实际编写我的应用程序。当我尝试转换代码时，例如，

```
gdkDockapp = dockapp.get_window()
xDockapp = gdkDockapp.get_xid() 
```

返回的是 long 而不是 Window，所以我不能执行任何 Xlib 函数。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T19:30:57.240

您可以`Xlib.Display.Window`使用此函数获取对象：`d.create_resource_object("window", xid)`，对象在`d`哪里`Xlib.display.Display`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T09:22:29.713

不确定使用 Xlib 在 X 服务器注定要消失以支持 Wayland 合成器的时候是明智之举。

# forms - XCode 4.5 表单验证

> ID：13445953
> 
> 赞同：1
> 
> 时间：2012-11-19T00:01:13.957
> 
> 标签：forms, validation

我在 xcode 4.5 中有一个单视图应用程序，试图学习表单验证。2 个文本框，1 个标签，总共 2 个按钮，计算（乘）和 1 个清除按钮将文本和标签设置为“”，我尝试测试“”但得到一些奇怪的结果。我是一个视觉工作室用户，我习惯于设置一个断点，然后将鼠标悬停在一个变量上并查看它的值，但 xcode 不是那么好。我试过测试 ==nil，但没有运气。第一次通过如果我点击计算并且从未输入任何我的测试不起作用的东西。它既不是 nil 也不是 ""，可能是未定义的。然后我在 text1 中输入 3，在 text2 中没有任何内容，然后我收到警报，我清除并执行 text2，但不是 text1，我的测试工作正常。我输入 text1，点击计算，获取警报，然后擦除 text1 并输入 text2 并且没有警报。除非我在两次尝试之间清除，否则警报不起作用。因为我最终需要检查我试过的数字

```
 float a=([text1.text floatValue]);
 float b=([text1.text floatValue]);
 if(a==NaN||b==NaN){
 } 
```

但这对任何一个都不起作用，我得到错误。我知道我是新手，但这很痛苦......下面是我的代码，请放轻松......

```
//
//  ViewController.m
//  calc2
//
//  Created by russell on 11/18/12.
//  Copyright (c) 2012 russell. All rights reserved.
//

#import "ViewController.h"

@interface ViewController ()

@end

@implementation ViewController

- (IBAction)button1{

if (text1.text==@""||text2.text==@"") {

    UIAlertView *alert = [[[UIAlertView alloc] initWithTitle:@"Blank Values"
                                                     message:@"You cannot multiply blanks"
                                                    delegate:self
                                                    cancelButtonTitle:@"Ok"
                                                    otherButtonTitles:nil]
                                                    autorelease];
    // optional - add more buttons:

    [alert show];

} else {
    float x=([text1.text floatValue]);
    float c=x*([text2.text floatValue]);
    label1.text=[[NSString alloc]initWithFormat:@"%.2f",c];
}

}

- (IBAction)button2{
text1.text=@"";
text2.text=@"";
label1.text=@"";
}

- (void)viewDidLoad
{
[super viewDidLoad];
// Do any additional setup after loading the view, typically from a nib.
}

- (void)didReceiveMemoryWarning
{
[super didReceiveMemoryWarning];
// Dispose of any resources that can be recreated.
}

@end 
```

# javascript - Spring MVC - 反序列化 JSON 数组

> ID：13445964
> 
> 赞同：0
> 
> 时间：2012-11-19T00:02:56.807
> 
> 标签：javascript, json, serialization, spring-mvc

我正在尝试使用 Ajax 和 JSON 将数据传递给我的控制器。

我有一个 HTML 表格，我必须将该表格的多个坐标发送到我的控制器。所以我制作了一个包含此类匿名对象的 Javascript 数组：

```
{ 
    DAY: someIndex, 
    HOUR: someOtherIndex 
} 
```

并让这个数组被调用`coordinates`，我像这样序列化它：

```
JSON.stringify(coordinates) 
```

所以然后在我使用的 ajax 调用 ( `type: POST`) 中`data: JSON.stringify(coordinates)`。

在我准备好的文件中，我使用了：

```
$.ajaxSetup({
    headers : {
        Accept : "application/json; charset=utf-8"
    }
}); 
```

我的控制器看起来像这样：

```
@RequestMapping(value = "/{id}", method = RequestMethod.POST)
public @ResponseBody
String update(@PathVariable int id, @RequestBody String coordinates, HttpServletResponse response) {

    // Do something here to convert it in my complex structure

} 
```

但是我不知道参数的类型应该是什么`coordinates`。

我正在使用`GSON`. 而且我无法轻松反序列化它。我尝试使用[此](https://stackoverflow.com/a/10292824/505810)解决方案，但它不起作用。（出于某种原因一直要求转换类型。）

由于我认为不可能正确反序列化，因此我尝试将坐标序列化为另一种格式（只是一个 JSON 字符串数组，其中坐标由令牌分割（`;) here`

所以我的数组中的javascript对象是这样创建的`foreach`：

```
coordinates.push( someIndex.toString() + ";" + someOtherIndex.toString() ); 
```

我保留了字符串化部分。

所以现在当我`POST`将数据发送到我的控制器时，我输出的值`System.out.println(coordinates)`和输出看起来很奇怪。

```
%5B%220%3B8%22%5D= 
```

对于 Javascript 控制台中的这个对象：`["0;8"]`。

所以我的问题：

1.  这是一个好方法吗？
2.  是否可以将 JSON 数组反序列化为某些 java 类型？比如`List<Coordinate>`？（我尝试过使用这种类型而不是`String`在我的控制器中，但它会给我一个错误`415 - Unsupported media type`）
3.  如果我使用 String 方法，有没有办法将这些乱码翻译成我想要的东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T00:25:43.790

你`%5B%220%3B8%22%5D=`在服务器端，导致 jQuery 默认将数据序列化为查询字符串。

您需要将请求的内容类型设置为`application/json`使用`contentType`jQuery 选项。

然后你可能想看看 GsonHttpMessageConverter 的一些实现，以便更简单的 RequestBody 转换。这是[一个](https://stackoverflow.com/questions/5019162/custom-httpmessageconverter-with-responsebody-to-do-json-things)，看起来[春天有一个适用于 android](http://static.springsource.org/spring-android/docs/1.0.x/api/org/springframework/http/converter/json/GsonHttpMessageConverter.html)，所以也许你可以使用它。

# php - 每添加 10 个项目创建一个新数组

> ID：13445965
> 
> 赞同：1
> 
> 时间：2012-11-19T00:03:00.800
> 
> 标签：php, arrays

我有以下代码显示在数据库的产品表中添加的项目，我想让它每 10 个项目创建一个新数组，这样它就不会是一长串项目。

```
$dynamicList = "";
$sql = mysql_query("SELECT * FROM products ORDER BY date_added DESC");
$productCount = mysql_num_rows($sql); // count the output amount
if ($productCount > 0) {
    while($row = mysql_fetch_array($sql)){ 
             $id = $row["id"];
             $product_name = $row["product_name"];
             $price = $row["price"];
             $date_added = strftime("%b %d, %Y", strtotime($row["date_added"]));
             $dynamicList .= '<table width="100%" border="0" cellspacing="0" cellpadding="6">
        <tr>
          <td width="10%" valign="top"><a href="product.php?id=' . $id . '"><img style="border:#666 1px solid;" src="inventory_images/' . $id . '.jpeg" alt="' . $product_name . '" width="93" height="102" border="1" /></a></td>
          <td width="90%" valign="top">' . $product_name . '<br />
            €' . $price . '<br />
            <a class="provoli" href="product.php?id=' . $id . '">Προβολή Λεπτομεριών</a></td>
        </tr>
      </table>'; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T00:15:30.300

您的代码风格可能需要一些工作，因为它不是很漂亮，但是，为了使这项工作，您可以尝试将您的列表放入一个数组中。

这需要两个步骤，第一个是记录索引。第二个是将值添加到新数组中。

```
$index = 0;
while(<your condition>) {
    $index++;
    <more code>
    $list[((int)$index/10)] .= <string>
} 
```

更好的方法是在打印包含所有项目的数组时实现这一点。但我不知道你是如何进一步实施的。

# javascript - 获取当前焦点输入文本字段的索引

> ID：13445967
> 
> 赞同：1
> 
> 时间：2012-11-19T00:03:31.457
> 
> 标签：javascript, jquery

如何获取我当前所在的当前输入文本字段的索引？按下回车后，我试图跳转到下一个输入字段。这就是我所拥有的：

```
 var index = $('input:text').index(this); 
 $('input:text')[nextIndex].focus(); 
```

但是不会去下一个..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T00:08:56.033

以下代码应该可以正常工作：

```
$("input").keypress(function(e) {
    if (e.which == 13) {
        var index = $("input[type='text']").index(this);
        $("input[type='text']").eq(index + 1).focus();
        e.preventDefault();
    }
});​ 
```

**演示：http:** [//jsfiddle.net/uJsMQ/](http://jsfiddle.net/uJsMQ/)

# html - VBA 运行时错误 13：类型不匹配 - HTMLElementCollection

> ID：13445968
> 
> 赞同：1
> 
> 时间：2012-11-19T00:03:32.113
> 
> 标签：html, vba, variables

我正在尝试遍历页面上的所有表格元素，但出现上述错误。这是我的代码：

```
Dim ie As InternetExplorer
Dim ieDOC As HTMLDocument
Dim tableElements As HTMLElementCollection
Dim tableElement As HTMLTable

Set ie = New InternetExplorer
ie.Visible = True
eURL = "url_of_site_to_visit"
ie.navigate ieURL
Do While ie.Busy Or ie.readyState <> 4
    DoEvents
Loop
Set ieDOC = ie.Document
Set tableElements = ieDoc.getElementsByTagName("table") 
```

出于某种原因，我在`Set tableElements = ieDoc.getElementsByTagName("table")`代码行上收到“类型不匹配”。

另外，调试时，它告诉我`tableElements = Nothing`

我添加了对“Microsoft HTML 对象库”和“Microsoft Internet 控件”的引用。

任何关于导致错误的原因或如何修复错误的方向都将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T01:22:02.667

认为应该是`IHTMLElementCollection`（注意`I`开头的），因为这是`getElementsByTagName`返回的对象类型

# multilingual - 语法错误，意外的 T_CONSTANT_ENCAPSED_STRING，期待 ')'

> ID：13445969
> 
> 赞同：0
> 
> 时间：2012-11-19T00:03:38.813
> 
> 标签：multilingual, php

我已经按照[这些](http://www.youtube.com/watch?v=v7vCp_TFcdU) [YT 视频](http://www.youtube.com/watch?v=vI4NkAERO0E)中的教程在 PHP（无框架）中构建了一个语言切换器和双语网站。但是，当我尝试在 WAMP 中对其进行测试时，出现以下错误：

**解析错误：语法错误，意外的 T_CONSTANT_ENCAPSED_STRING，在第 6 行的 C:\wamp\www\skydoll\lang\f​​rancais.php 中需要 ')'**

我通过搜索这个站点发现这通常是由报告的错误行上方的行引起的，但是对于 PHP 来说，我似乎找不到代码有什么问题。

```
<?php

$lang = array(
'hello' => 'Bonjour',
'goodbye' => 'Au revoir'
);

?> 
```

有什么看起来不合时宜的吗？

然而，在我到达这一点之前，我在文件 init.php 中遇到了其他语法错误，该文件是调用 francais.php 的文件。错误可能来自那里吗？我将包括代码，以防万一：

```
<?php 
session_start();

$allowed_lang = array('english', 'francais');

if (isset($_GET['lang']) === true && in_array($_GET['lang'], allowed_lang) === true) {
$_SESSION['lang'] = $_GET['lang'];
} else if (isset($_SESSION['lang']) === false) {
$_SESSION['lang'] = 'francais';
}

include 'lang/' . $_SESSION['lang'] . '.php';
?> 
```

预先感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T00:06:34.753

```
if (isset($_GET['lang']) === true && in_array($_GET['lang'], allowed_lang) === true) { 
```

应该：

```
if (isset($_GET['lang']) === true && in_array($_GET['lang'], $allowed_lang) === true) { 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T00:09:56.877

你之前忘记了地方`$`字符`allowed_lang`

# python - 根据另一列中的值有条件地替换值

> ID：13445973
> 
> 赞同：5
> 
> 时间：2012-11-19T00:04:20.250
> 
> 标签：python, pandas

我有一个非常大的数据框（~1.7MM 行 x 6 列）。相关数据的简化示例是：

```
City        Borough

Brooklyn    Brooklyn
Astoria     Queens
Astoria     Unspecified
Ridgewood   Unspecified
Ridgewood   Queens 
```

因此，我尝试根据“城市”列中的信息填充“未指定”值。例如，City Ridgewood 在一个实例中位于未指定的自治市镇，但在数据集中的其他地方正确地将自治市镇列为皇后区。

我已经探索过 Panda 的 fillna，但它似乎不能满足我的需求。我也考虑过 np.where 方法，但我不确定它在这种情况下是如何工作的。我对 Pandas 很陌生，但也许地图/应用功能是我需要的？这可能可以通过一千种不同的方式来完成，但是在考虑到数据大小的情况下寻找不会爬网的东西。

编辑：我能够创建一个字典，其中包含城市和行政区之间出现频率最高的“对”，代码如下：

```
specified = data[['Borough','City']][data['Borough']!= 'Unspecified']
paired = specified.Borough.groupby(specified.City).max()
paired = paired.to_dict() 
```

成对的字典以城市为键，以自治市镇为值。现在最后一步是将其应用/映射回自治市镇列......我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-19T00:54:59.203

这是一种方法：

```
>>> d
         City      Borough
0   Brooklyn     Brooklyn
1    Astoria       Queens
2    Astoria  Unspecified
3  Ridgewood  Unspecified
4  Ridgewood       Queens
>>> realData = d[d.Borough != "Unspecified"]
>>> realData = pandas.Series(data=realData.Borough.values, index=realData.City)
>>> d['Borough'] = d.City.map(realData)
>>> d
         City   Borough
0   Brooklyn  Brooklyn
1    Astoria    Queens
2    Astoria    Queens
3  Ridgewood    Queens
4  Ridgewood    Queens 
```

这假设每个城市都只有一个未指定的自治市镇值。（如果城市没有价值但未指定，则自治市镇将显示为 NA。）

编辑：如果您已经在编辑后的帖子中创建了字典，只需使用`d['Borough'] = d.City.map(paired['Borough'])`将每个城市从您的字典映射到自治市镇。 `map`是一种有用的了解方法。它可以使用 Pandas 系列、dict 或返回给定键的映射值的函数映射值。

# asp.net - 我的 ASP.NET 网站引发错误，因为引用的程序集缺少依赖程序集

> ID：13445976
> 
> 赞同：1
> 
> 时间：2012-11-19T00:04:35.193
> 
> 标签：asp.net, .net, dependencies, .net-assembly

我的 ASP.NET 网站在第一次请求时抛出异常 - 这是应用程序首次启动时。

![在此处输入图像描述](../Images/22c9c042aa17c8225a93b2961b8112e8.png)

所以它说某个程序集依赖于另一个程序集（在这种情况下，Json v 4.5）并且缺少该依赖项。

我怎样才能弄清楚父程序集是什么？

# android - 是否可以指定 TableRow 高度？

> ID：13445980
> 
> 赞同：6
> 
> 时间：2012-11-19T00:04:46.357
> 
> 标签：android, android-tablelayout, row-height

我有一个里面`TableLayout`有多个`TableRow`视图。我希望以编程方式指定行的高度。例如

```
int rowHeight = calculateRowHeight();
TableLayout tableLayout = new TableLayout(activity);
TableRow tableRow = buildTableRow();
TableLayout.LayoutParams rowLp = new TableLayout.LayoutParams(
                                         LayoutParams.FILL_PARENT, rowHeight);
tableLayout.addView(tableRow, rowLp); 
```

但这不起作用，默认为 WRAP_CONTENT。在[Android 源代码](https://github.com/android/platform_frameworks_base/blob/master/core/java/android/widget/TableLayout.java)中四处挖掘，我在`TableLayout`（由 onMeasure() 方法触发）中看到了这一点：

```
private void findLargestCells(int widthMeasureSpec) {
    final int count = getChildCount();
    for (int i = 0; i < count; i++) {
        final View child = getChildAt(i);
        if (child instanceof TableRow) {
            final TableRow row = (TableRow) child;
            // forces the row's height
            final ViewGroup.LayoutParams layoutParams = row.getLayoutParams();
            layoutParams.height = LayoutParams.WRAP_CONTENT; 
```

似乎任何设置行高的尝试都将被 TableLayout 覆盖。有人知道解决这个问题的方法吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-19T23:21:37.000

好吧，我想我现在已经掌握了窍门。设置行高的方法不是摆弄`TableLayout.LayoutParams`附加到`TableRow`，而是`TableRow.LayoutParams`附加到*任何*单元格。只需将一个单元格设置为所需的高度，并且（假设它是最高的单元格）整行将是该高度。在我的情况下，我添加了一个额外的 1 像素宽的列设置为所需的高度，这起到了作用：

```
View spacerColumn = new View(activity);
//add the new column with a width of 1 pixel and the desired height
tableRow.addView(spacerColumn, new TableRow.LayoutParams(1, rowHeight)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T00:11:18.723

首先，您应该使用显示因子公式将其从 dps 转换为像素。

```
 final float scale = getContext().getResources().getDisplayMetrics().density; 

  int trHeight = (int) (30 * scale + 0.5f);
  int trWidth = (int) (67 * scale + 0.5f); 
  ViewGroup.LayoutParams layoutpParams = new ViewGroup.LayoutParams(trWidth, trHeight);
  tableRow.setLayoutParams(layoutpParams); 
```

# php - 单选按钮不起作用

> ID：13445982
> 
> 赞同：-5
> 
> 时间：2012-11-19T00:05:03.683
> 
> 标签：php, mysql, forms

查看一些教程，我添加了单选按钮，但由于某些原因它不起作用。当我提交表单时，值没有输入到数据库中

这是我的代码案例“添加”：

```
 if( $_POST['addbtn'] == 'Save' )
        {    
            $name = '';
            if(isset($_REQUEST['name']))
            {
                $name = $_REQUEST['name'];
            }

            $imageName = '';
            $field = 'banner_images';

            if($_FILES[$field ]['error'] == 0)
            {
                if($_FILES[$field]['tmp_name'] != '')
                {

                        $uploaddir =  "../inner_page_banner_images/";
                        $banner_images = $_FILES[$field]['name'];
                        $tag     = "";
                        $Twidth  = 980;
                        $Theight = 420;

                        @move_uploaded_file($_FILES[$field]['tmp_name'],$uploaddir.$_FILES[$field]['name']);

                }

        $site = '';

            if(isset($_REQUEST['site']) == 'hino')
            {
                $site = $_REQUEST['checked'];
            }
            elseif(isset($_REQUEST['site']) == 'storm')
            {
                $site = $_REQUEST['checked'];
            }
            }

            //--------------------------------------------------------------------------------------------------------

            $Query  = "INSERT INTO inner_banner  SET ";

            $Query .= "name             = '".$name."',";
            $Query .= "banner_images    = '".$banner_images."'";
            $Query .= "site     = '".$site."'";
            //echo $Query; die();
            mysql_query($Query);

            $_SESSION['msg']    = " New banner image uploaded successfully ";
            @header("Location: inner_banner.php? module=inner_banner&action=view");
            die();
}

    include "add_banner.php";
    break; 
```

我的 HTML 代码

```
<form method="post" name="frm1" id="frm1" action="" autocomplete="off" enctype="multipart/form-data" onsubmit="return ValidateForm(this);" >
<table cellspacing="0" cellpadding="3" border="0" align="center" width="100%">

  <tr>
    <td width="18%">Banner Title</td>
    <td width="1%">:</td>
    <td><input type="text" name="name" id="name"  size="40" value="" />
      &nbsp;<span class="required">*</span> </td>
  </tr>

  <tr>
    <td colspan="3" style=" background-color: #FFFFFF;">&nbsp;</td>
  </tr>
  <tr>
    <td valign="top">Banner Image </td>
    <td valign="top">:</td>
    <td><input type="file" name="banner_images"  id="banner_images" size="20"  />
    </td>
  </tr>

  <tr>
    <td colspan="3" style=" background-color: #FFFFFF;">&nbsp;</td>
  </tr>

   <tr>
    <td valign="top">Select:</td>
    <td valign="top">:</td>
    <td><input type="radio" value="hino" name="site" id="site"  />
          HINO
          <input type="radio" value="storm" name="site" id="site" />
          Storm

          &nbsp;<span class="required">*</span>
    </td>
  </tr>

  <tr>
    <td colspan="3" style=" background-color: #FFFFFF;">&nbsp;</td>
  </tr>

  <tr>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td><input type="submit" name="addbtn" value="Save" />
      &nbsp;
      <input type='button' value='Cancel' onclick="document.location.href='inner_banner.php?module=inner_banner'" />
        <input type="hidden" name="Validation" id="Validation" value="
        Field=name|Alias=Banner Title|Validate=BLANK^                            
        Field=banner_images|Alias=Banner Image|Validate=BLANK" /> 
```

somebosy 可以调查一下为什么这些值没有输入到数据库中

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T00:08:49.350

此行缺少逗号：

```
$Query .= "banner_images    = '".$banner_images."'"; 
```

应该

```
$Query .= "banner_images    = '".$banner_images."',"; 
```

作为旁注，您的代码容易受到[sql 注入](http://en.wikipedia.org/wiki/SQL_injection)的影响，您可能希望使用准备好的语句或至少[mysql_real_escape_string](http://www.php.net/manual/en/function.mysql-real-escape-string.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T00:10:35.657

这不应该：

```
 if(isset($_REQUEST['site']) == 'hino')
    {
        $site = $_REQUEST['checked'];
    }
    elseif(isset($_REQUEST['site']) == 'storm')
    {
        $site = $_REQUEST['checked'];
    } 
```

是：

```
 if(isset($_REQUEST['site']) == 'hino')
        {
            $site = $_REQUEST['site'];
        }
        elseif(isset($_REQUEST['site']) == 'storm')
        {
            $site = $_REQUEST['site'];
        } 
```

如果是这样，更好的编码方法是：

```
if(isset($_REQUEST['site']) && ($_REQUEST['site'] == 'hino' || isset($_REQUEST['site']) == 'storm') {
    $site = $_REQUEST['site'];
} 
```

还：

```
 $Query .= "name             = '".$name."',";
        $Query .= "banner_images    = '".$banner_images."',";
        $Query .= "site     = '".$site."'"; 
```

# java - 输入 no 时进程不会终止

> ID：13445987
> 
> 赞同：1
> 
> 时间：2012-11-19T00:05:56.987
> 
> 标签：java, arrays, object, boolean

```
package homework4;
import java.util.Scanner;
public class Prog4 {
static Scanner scanner = new Scanner(System.in);
public static void main(String[] args)
{   CreditCardNumber[] cred1;
    CreditCardNumber cred2 = getInput();
    Display("The complete number from your input:", cred2);
    cred1 = getInputArray();
    DisplayArray(cred1);
    TryAnother(cred1);
}

public static CreditCardNumber getInput() {
    String ID;
    String accNum;
    CreditCardNumber tempCred;      
    System.out.printf("Please enter issuer ID:");
    ID = scanner.next();
    System.out.printf("Please enter account number:");
    accNum = scanner.next();
    tempCred = new CreditCardNumber(ID, accNum);

    return tempCred;
}
public static void Display(String ch, CreditCardNumber cred2)
{

    System.out.println(ch);
    System.out.println(cred2.toString().replaceAll(".{4}", "$0   "));       
}

public static CreditCardNumber[] getInputArray()
{
    CreditCardNumber[] tempArray;
    String tempID;
    int size;       
    System.out.printf("Please enter size of the aray:");
    size = scanner.nextInt();
    if(size < 1)
    {
        size = 1;
    }
    tempArray = new CreditCardNumber[size];
    System.out.printf("Please enter issuer ID:");
    tempID = scanner.next();
    for(int i = 0; i < tempArray.length; i++)
    {
        tempArray[i] = new CreditCardNumber();
        tempArray[i].CreateCred(tempID);
    }

    return tempArray;
}

public static void DisplayArray(CreditCardNumber[] cred1)
{
    for(int i = 0; i< cred1.length; i++)
    {
        Display("Credit Card # " + i+":" + '\n', cred1[i]);
    }
    System.out.println();
}

public static boolean TryAnother(CreditCardNumber[] cred1)   
{
    String s;
    System.out.printf("Get more credit card numbers? (n for no):");
    s = scanner.next();
    while(s.charAt(0) != 'N' && s.charAt(0) != 'n')
    {                                       
            cred1 = getInputArray();
            DisplayArray(cred1);    
            if(s.charAt(0) != 'N' && s.charAt(0) != 'n')
            TryAnother(cred1);
    }       

    return false;   
}
} 
```

嗨，当我回答“否”时，Tryanother 方法有问题，进程不会终止，而是提示用户再次输入数组的大小，如下所示：

```
Please enter issuer ID:321321
Please enter account number:654654654
The complete number from your input:
3213   2165   4654   6549   
Please enter size of the aray:7
Please enter issuer ID:789789
Credit Card # 0:

7897   8987   8895   1653   
Credit Card # 1:

7897   8935   5880   5197   
Credit Card # 2:

7897   8997   8152   8134   
Credit Card # 3:

7897   8996   1605   8067   
Credit Card # 4:

7897   8953   2006   5521   
Credit Card # 5:

7897   8964   3319   8191   
Credit Card # 6:

7897   8986   1830   7068   

Get more credit card numbers? (n for no):y
Please enter size of the aray:3
Please enter issuer ID:345345
Credit Card # 0:

3453   4590   2392   9734   
Credit Card # 1:

3453   4549   5025   1905   
Credit Card # 2:

3453   4504   2989   0927   

Get more credit card numbers? (n for no):n
Please enter size of the aray: 
```

正如您所看到的，当我输入“y”时程序工作，它提示用户输入数组的大小，但是当我输入“n”而不是终止程序时提示用户输入数组的大小

我该如何解决这个问题？

先感谢您

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-19T00:10:34.587

刚刚注意到您`s.charAt(0) != 'N' && s.charAt(0) != 'n'`在 while 循环中，并且还在循环中递归地调用了相同的函数。

将其更改为`if(s.charAt(0) != 'N' && s.charAt(0) != 'n')`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T00:14:53.267

使用 String.startsWith() 方法。

```
while(!s.startsWith("n") && !s.startsWith("N")) 
```

但它仍然应该适用于您的方法，我正在查看它。:)

# c++ - 将代码移动到头文件

> ID：13445990
> 
> 赞同：0
> 
> 时间：2012-11-19T00:06:17.407
> 
> 标签：c++, header-files

我正在处理的程序涉及大量用户输入数据。出于这个原因，我有很多函数，其目的仅仅是验证输入并确保它的格式/正确的类型。

首先，将代码移动到外部文件的最佳方法是什么？当我为我的项目设计自定义类时，我使用了 .h 和 .cpp 文件对来声明和实现函数；是否同样适用于这些其他随机函数？

其次，什么情况下应该将代码移出文件？我可以很容易地将它全部包含在主文件中，但它看起来很混乱。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T00:44:05.947

如果`main`文件太大，请移出一些。

如果这些功能可以重复使用，请将它们分开到单独的文件中。一个文件包含函数的定义或内容。另一个文件包含文件的声明（又名原型、标题）。

将代码提取到单独文件中的一个原因是，当您完成测试时，不需要重新编译单独的文件。链接器可以引用它们的目标文件状态。这加快了构建过程（和开发过程）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T00:51:22.713

如果这些“随机”函数是逻辑连接的（即它们都进行输入验证），那么我将创建一个`InputValidator`类（您必须创建一个 .h 和 .cpp 文件）。在您的应用程序主（或您获得输入的任何地方）中创建一个`InputValidator`实例并调用它的方法来验证您的输入。如果您实际上对实例没有任何用途，则可以创建方法`static`，然后您可以调用它们`InputValidator.MyMethod()`而无需创建实例。

# ios - iOS 应用程序：打开文件，将其发送到网络位置，然后退出到调用应用程序

> ID：13445991
> 
> 赞同：0
> 
> 时间：2012-11-19T00:06:17.607
> 
> 标签：ios, file, app-store

有没有办法让执行此操作（并且不需要 UI）的应用程序被 Apple 的 App Review 流程接受？

我知道简单地`exit(0)`输入`applicationDidFinishLaunching:withOptions:`会被拒绝，但是如果`exit(0)`仅在完成 ​​TCP 事务时才调用呢？Apple 是否拒绝任何退出您的应用程序的尝试？

这就是我要找的东西。我在一些 iOS 应用程序中创建了一个文件（例如图片），然后在我的应用程序中使用“打开方式...”打开它。我希望我的应用程序执行不需要用户输入的功能（即，将其发送到预配置的网络位置）。然后我想让我的应用程序退出，返回到我使用“打开方式...”功能的应用程序。

我认为，如果我完全被禁止退出，那么最优化的工作流程可能是 4 指滑动回调用应用程序。我的应用程序在定期打开时（从主屏幕）会做什么也不是很清楚，但这并不是一个大问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T00:11:42.067

假设您拥有这两个应用程序，您根本不必退出您的应用程序。事实上，这样做无论如何都不会将其他应用程序带回前台。

只需在两个方向上使用标准链接技术。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-19T00:51:35.440

你想做的事做不到，而且没有意义。苹果永远不会批准这样的应用程序。所有应用程序本身必须有一个有用的目的。如果您的应用程序的唯一用途是将文件从其他应用程序发送到某个服务器，那么它本身是没有用的。Apple 希望每个应用程序都具有功能齐全且有用的用户界面。

但除此之外，这就是为什么不能这样做 - 您无法重新启动呼叫应用程序。当您的应用程序启动时，最终将调用该`UIApplicationDelegate`方法。`application:openURL:sourceApplication:annotation:`这会告诉您要处理的文件，并为您提供请求应用程序的包 ID。但是没有信息可以让您启动启动您的应用程序。没有 API 可以让您返回到以前的应用程序。

唯一的可能性是调用应用程序显式启动您的应用程序并提供返回 URL。但这消除了一般用途。任何可以与您的应用一起使用的应用都需要特定的代码来支持您的应用。显然，这远非通用解决方案。

顺便说一句 - 让您的应用程序简单地退出没有任何好处，因为这不会将用户返回到以前的应用程序。

# sourcegear-vault - 如何在 Vault 中按版本或标签提取项目中的所有文件？

> ID：13445994
> 
> 赞同：1
> 
> 时间：2012-11-19T00:06:41.857
> 
> 标签：sourcegear-vault

我是 Vault 新手，到目前为止还不是一个超级粉丝，但我需要做一些在 SVN 或 Mercurial 中很容易的事情，但我不知道如何在 Vault 中操作。

我需要获取存储库文件的副本，因为它们处于特定版本。我已经尝试列出他们的历史并获取一个版本，但这似乎只获取在该版本中签入的文件。

如何获得该版本的整个存储库？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T15:40:17.287

您可以使用文件夹和文件上的标签来设置“版本”，然后在 Vault 中右键单击文件夹/文件，选择“显示标签”，然后“签出”此标签。如需更多阅读，请参阅位于[http://download.sourcegear.com/misc/vaultpro/help/client/vaultprohelp.html的标签上的保险库文档](http://download.sourcegear.com/misc/vaultpro/help/client/vaultprohelp.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-27T13:03:35.123

在 Vault 客户端中：

1.  右键单击您希望在给定时间点完整拥有的目录

2.  “显示历史”

3.  选择单选按钮“按版本查看文件夹历史记录”

4.  进行其他设置，例如您希望返回多远，点击“确定”

5.  标记您想要的“版本”，选择“获取树”

唯一可行的选择是就地覆盖，因此此时您可能需要更改工作目录。