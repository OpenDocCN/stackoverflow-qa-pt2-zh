# StackOverflow 问答 15141000-15141999

# javascript - 添加初始化功能时 Sencha xtype 导航失败

> ID：15141000
> 
> 赞同：3
> 
> 时间：2013-02-28T16:45:54.363
> 
> 标签：javascript, extjs, sencha-touch-2

我有一个 Home.js 视图，其中包含一些嵌入式 xtype 用于底部栏中的子页面。首先，我在配置中添加了其他视图，一切都很好，但现在我需要使用 initalize 方法设置一些其他内容（即用户名）。

但是，现在导航到其他视图不再触发。什么都没有发生，没有任何动作被触发或任何错误。视图仍然正确显示。

**风景**

```
Ext.define('MyApp.view.Home', {
extend : 'Ext.tab.Panel',
id : 'home',
xtype : 'homeview',
requires : ['Ext.TitleBar', 'Ext.Video', 'MyApp.view.Profile'],

initialize : function() {

    console.log('Initializing Home');
    var me = this
    var config = me.getInitialConfig();
    var username = config.username;
    var items = [];

    items.push({
        xtype : 'titlebar',
        docked : 'top',
        title : 'Hello ' + username
    }, {
        xtype : 'updatesview',
    }, {
        xtype : 'searchview',
    }, {
        xtype : 'profileview'
    }, {
        xtype : 'messagesview'
    }, {
        xtype : 'sensesview'
    });

    me.setItems(items);

    console.log('Initializing Home');
},
config : {
    title : 'Home',
    iconCls : 'home',
    tabBarPosition : 'bottom'

}

}); 
```

切换回这个作品（？？？？？？）

**旧视图，仅使用配置**

```
Ext.define('MyApp.view.Home', {
extend : 'Ext.tab.Panel',
id : 'home',
xtype : 'homeview',
requires : ['Ext.TitleBar', 'Ext.Video', 'MyApp.view.Profile'],

config : {
    title : 'Home',
    iconCls : 'home',
    tabBarPosition : 'bottom',
    items : [{
        xtype : 'updatesview',
    }, {
        xtype : 'searchview',
    }, {
        xtype : 'profileview'
    }, {
        xtype : 'messagesview'
    }, {
        xtype : 'sensesview'
    }]
}

}); 
```

**更新**

我都试过了

```
me.setItems(items);
me.addItems(items); 
```

没有工作。

**更新 2**

好的，问题在于初始化函数。任何初始化都会禁用导航 (??)

```
initialize : function() {
    console.log('init home');
}, 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T20:22:53.150

我认为您需要在 init 中调用父 init 方法：

```
...
initialize : function() {
  this.callParent(arguments);
  ...
  // Rest of your code...
},
... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T06:11:14.950

在初始化函数内部尝试先创建对象，然后像这样将它们添加到容器中

```
var items = [];
items.push(Ext.create("SecretSensation.view.Updatesview"));
items.push(Ext.create("SecretSensation.view.searchview"));
items.push(Ext.create("SecretSensation.view.profileview"));
items.push(Ext.create("SecretSensation.view.messagesview"));
items.push(Ext.create("SecretSensation.view.sensesview"));
me.add(items); 
```

# database - 阅读我的文件与自定义手册页以获取硬盘驱动器中的研究数据

> ID：15141003
> 
> 赞同：0
> 
> 时间：2013-02-28T16:46:02.380
> 
> 标签：database, bash, unix

我不确定在哪里发布这个问题，所以我想我会尝试 stackoverflow。

作为一名完成博士生，我在 350 GB 的硬盘驱动器中积累了千兆字节的研究数据。作为毕业和过渡的一部分，我需要将这个研究硬盘交给我的部门，并确保它有足够的描述性信息供下一个人介入并接管我的研究。

没有为`README`硬盘驱动器中的每个文件夹和子文件夹编写文件，我可以使用什么 unix 实用程序/bash 脚本我可以编写可能会模拟`apropos`命令或`man`命令来告诉下一个研究人员文件夹内容及其内容的详细信息利用？我可以从硬盘驱动器中的数据创建一些数据库吗？

**编辑 1**

好吧，[这](https://superuser.com/a/166639/161114)似乎有帮助！将尝试一下并很快附加结果。

**编辑 2**

`tree -H ./ | gedit &`管道当前目录的树结构，`gedit`您可以将其保存为 html 文件。现在只要我可以向这个 html 文件添加更多功能。关于如何使它变得更好的任何建议？你会怎么做`:)`？

**编辑 3**

我也许应该在我的硬盘驱动器中为示例程序（可以在其上构建/解释其他程序）[创建一个手册页？](http://linux.omnipotent.net/article.php?article_id=12493)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-01T20:24:40.353

就个人而言，当我看到正确制作的手册页时，我总是很高兴。您可以找到它们，`apropos`并且可以将它们格式化为 ascii 或布局精美的可打印文本或 html。您可以通过 链接它们`SEE ALSO`，它给整个事物带来“大男孩”的感觉。

每个目录（甚至每个文件）的描述都很好，但是新手将无法单独使用它。她需要一个明确的起点，找到关于

*   这些数据是关于什么的
*   目录结构背后的基本原理
*   任何其他信息开始

然后你可能想附加一个关于个别目录的索引。是的，因此我会使用类似的东西`tree`（我不知道），或者`find`其他一些目录遍历技术。

唯一需要注意的是，您必须学习`groff`格式化手册页（这是造成大男孩感觉的原因）。

# javascript - 组合多个 .removeAttr() 语句

> ID：15141004
> 
> 赞同：1
> 
> 时间：2013-02-28T16:46:02.457
> 
> 标签：javascript, jquery

我有多个`removeAttr()`有没有办法可以组合它们？

**我所拥有的：（**这行得通）

```
checkboxes.removeAttr("checked",'checked');
checkboxes.removeAttr("indeterminate", false);
checkboxes.removeAttr("role", 'checkbox');
checkboxes.removeAttr("aria-checked", false); 
```

**我尝试过的：（**这不起作用）

```
checkboxes.removeAttr({
    checked: 'checked',
    indeterminate: false,
    role: 'checkbox',
    'aria-checked': false
}); 
```

当我尝试这个时，我得到以下控制台错误。所以要么我的语法错误，要么这不起作用。

```
Uncaught TypeError: Object #<Object> has no method 'toLowerCase'  jquery.min.js:2 
```

任何帮助表示赞赏。谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-28T16:50:37.943

只需`$.each`与阵列一起使用，快速、简短且可扩展。

```
$.each(["checked","indeterminate"],function(i,attrName){
    checkbox.removeAttr(attrName);
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-28T16:47:52.767

根据***[removeAttr()](http://api.jquery.com/removeAttr/)***文档，它不接受对象。所以

`checkboxes.removeAttr({});`不管用。它还接受一个参数 [thx @RocketHazmat] 进行更正，您想删除它。

您可以进行如下链接：

```
checkboxes
   .removeAttr("checked")
   .removeAttr("indeterminate")
   .removeAttr("role")
   .removeAttr("aria-checked"); 
```

但是如果你想设置属性，那么你必须使用`attr()`如下方法：

```
checkboxes
  .attr("checked", 'checked')
  .attr("indeterminate",false )
  .attr("role",'checkbox')
  .attr("aria-checked", false); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-28T16:52:08.813

我不确定您为什么将键和值都传递给`removeAttr`，但如果您只想从元素中删除这 4 个属性，请传递以空格分隔的键列表，如下所示：

```
checkboxes.removeAttr("checked indeterminate role aria-checked"); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-28T16:52:16.803

@RocketHazmat 是对的，所以它会是这样的：

```
checkboxes.removeAttr("checked indeterminate role aria-checked"); 
```

但是你需要 jQuery 的 1.7 或更高版本。

# java - 链表的大小方法未返回正确响应的奇怪错误，Java，Euler #2

> ID：15141009
> 
> 赞同：1
> 
> 时间：2013-02-28T16:46:11.677
> 
> 标签：java, linked-list

我的程序给了我一个索引越界异常，它想要索引 4 并且由于某种原因在循环的早期迭代之一中具有 1 的大小。

我意识到我可以使用不同的数据结构，但这让我疯狂地试图确定它为什么不起作用。

调试语句的打印输出是 3,3

```
package euler2;
import java.util.LinkedList;

public class Euler2 {

    public static void main(String[] args) {
        LinkedList fibNumbers = new LinkedList<>();
        fibNumbers.add(0,1);
        fibNumbers.add(1,2);
        System.out.println(fibNumbers.size() + (int) fibNumbers.indexOf(fibNumbers.getLast()));
        while ((int) fibNumbers.getLast() < 4000000) {
            System.out.println(fibNumbers.size() + (int) fibNumbers.indexOf(fibNumbers.getLast()));
            fibNumbers.addLast(fibNumbers.get((int)(fibNumbers.size()) + (int) fibNumbers.get(fibNumbers.size() - 1)));
        }

        fibNumbers.removeLast();

        int sum = 0;

        for (int x = 0; x < fibNumbers.size(); x++) {
            sum = sum + (int) fibNumbers.get(x);
        }

        System.out.println(sum);
    }
} 
```

# c# - 如何在 c# 中使用 process.start 运行嵌入式批处理文件

> ID：15141010
> 
> 赞同：1
> 
> 时间：2013-02-28T16:46:12.390
> 
> 标签：c#, wpf, cmd

我添加了一个批处理文件。让我们在我的 WPF 应用程序中说“batch.cmd”。我右键单击我的项目并添加现有项目，在项目中添加我的批处理文件。我选择了我的批处理文件并将构建操作更改为嵌入式资源。在我构建它之后，我看到这个文件添加到项目中。

现在我需要在我的代码中启动我的批处理文件，我试过`Process.Start("batch.cmd")`了，它不起作用，我确实喜欢：

```
Process p = new Process();
p.StartInfo.FileName = "batch.cmd";
p.Start(); 
```

它也不起作用。我怎样才能让我的代码理解这个批次存在于我的项目中以及 \bin 中的某个位置。我不想硬编码它，因为路径总是会改变。

先谢谢了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T16:54:49.113

您需要在运行时将文件从资源保存到磁盘，然后从该位置调用它（如果它希望从特定文件夹开始，可能需要调整“当前目录”）。

链接：

*   [如何嵌入和访问资源](http://support.microsoft.com/kb/319292)
*   [Path.GetTempFileName](http://msdn.microsoft.com/en-us/library/system.io.path.gettempfilename.aspx) - 获取保存文件的位置（完成后不要忘记删除）。
*   [ProcessStartInfo.WorkingDirectory](http://msdn.microsoft.com/en-us/library/system.diagnostics.processstartinfo.workingdirectory.aspx)

以下未经验证的代码：

```
 var tempFileName = Path.GetTempFileName();

  Assembly.GetExecutingAssembly()
    .GetManifestResourceStream("my.cmd")
    .CopyTo(File.OpenWrite(tempFileName);

  Process.Start(tempFileName);
  File.Delete(tempFileName); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T16:54:27.553

你的意思是这样吗？

```
Process p = new Process();
p.StartInfo.FileName = AppDomain.CurrentDomain.BaseDirectory + "\\batch.cmd";
p.Start(); 
```

# java - 大量内存溢出导致堆大小在大约 8 秒内从大约 64mb 变为 1.5gb。垃圾收集器的问题？

> ID：15141011
> 
> 赞同：32
> 
> 时间：2013-02-28T16:46:15.447
> 
> 标签：java, memory-leaks, garbage-collection, jvm

## 这是问题所在：

![内存使用膨胀失控](../Images/43a6c4f910b0f97ef9262e19230d086f.png)

如您所见，内存使用膨胀失控！我不得不向 JVM 添加参数以增加堆大小，以避免在我弄清楚发生了什么时出现内存不足错误。不好！

## 基本应用总结（上下文）

这个应用程序（最终）将用于基本的屏幕简历和模板匹配类型的东西，以实现自动化目的。我想实现尽可能高的帧速率来观看屏幕，并通过一系列单独的消费者线程处理所有处理。

我很快发现库存的 Robot 类在速度方面真的很糟糕，所以我打开了源代码，去掉了所有重复的工作和浪费的开销，并将它重新构建为我自己的名为 FastRobot 的类。

## 班级代码：

```
public class FastRobot {
    private Rectangle screenRect;
    private GraphicsDevice screen;
    private final Toolkit toolkit;
    private final Robot elRoboto;
    private final RobotPeer peer;
    private final Point gdloc;
    private final DirectColorModel screenCapCM;
    private final int[] bandmasks;

    public FastRobot() throws HeadlessException, AWTException {
        this.screenRect = new Rectangle(Toolkit.getDefaultToolkit().getScreenSize());
        this.screen = GraphicsEnvironment.getLocalGraphicsEnvironment().getDefaultScreenDevice();
        toolkit = Toolkit.getDefaultToolkit();
        elRoboto = new Robot();
        peer = ((ComponentFactory)toolkit).createRobot(elRoboto, screen);

        gdloc = screen.getDefaultConfiguration().getBounds().getLocation();
        this.screenRect.translate(gdloc.x, gdloc.y);

        screenCapCM = new DirectColorModel(24,
                /* red mask */    0x00FF0000,
                /* green mask */  0x0000FF00,
                /* blue mask */   0x000000FF);
        bandmasks = new int[3];
        bandmasks[0] = screenCapCM.getRedMask();
        bandmasks[1] = screenCapCM.getGreenMask();
        bandmasks[2] = screenCapCM.getBlueMask();

        Toolkit.getDefaultToolkit().sync();
    }

    public void autoResetGraphicsEnv() {
        this.screenRect = new Rectangle(Toolkit.getDefaultToolkit().getScreenSize());
        this.screen = GraphicsEnvironment.getLocalGraphicsEnvironment().getDefaultScreenDevice();
    }

    public void manuallySetGraphicsEnv(Rectangle screenRect, GraphicsDevice screen) {
        this.screenRect = screenRect;
        this.screen = screen;
    }

    public BufferedImage createBufferedScreenCapture(int pixels[]) throws HeadlessException, AWTException {
//      BufferedImage image;
        DataBufferInt buffer;
        WritableRaster raster;

        pixels = peer.getRGBPixels(screenRect);
        buffer = new DataBufferInt(pixels, pixels.length);

        raster = Raster.createPackedRaster(buffer, screenRect.width, screenRect.height, screenRect.width, bandmasks, null);
        return new BufferedImage(screenCapCM, raster, false, null);
    }

    public int[] createArrayScreenCapture() throws HeadlessException, AWTException {
            return peer.getRGBPixels(screenRect);
    }

    public WritableRaster createRasterScreenCapture(int pixels[]) throws HeadlessException, AWTException {
    //  BufferedImage image;
        DataBufferInt buffer;
        WritableRaster raster;

        pixels = peer.getRGBPixels(screenRect);
        buffer = new DataBufferInt(pixels, pixels.length);

        raster = Raster.createPackedRaster(buffer, screenRect.width, screenRect.height, screenRect.width, bandmasks, null);
    //  SunWritableRaster.makeTrackable(buffer);
        return raster;
    }
} 
```

从本质上讲，我对原来所做的更改只是从函数体中移动了许多分配，并将它们设置为类的属性，这样它们就不会每次都被调用。这样做实际上对帧速率产生了*重大*影响。即使在我的电源严重不足的笔记本电脑上，它也从库存机器人类的约 4 fps 到我的 FastRobot 类的约 30 fps。

## 第一次测试：

当我在主程序中开始出现内存不足错误时，我设置了这个非常简单的测试来监视 FastRobot。注意：这是生成上述堆配置文件的代码。

```
public class TestFBot {
    public static void main(String[] args) {
        try {
            FastRobot fbot = new FastRobot();

            double startTime = System.currentTimeMillis();
            for (int i=0; i < 1000; i++)
                fbot.createArrayScreenCapture();
            System.out.println("Time taken: " + (System.currentTimeMillis() - startTime)/1000.);

        } catch (AWTException e) {
            e.printStackTrace();
        }
    }
} 
```

## 检查：

它不会*每次都*这样做，这真的很奇怪（而且令人沮丧！）。事实上，它很少用上面的代码做到这一点。但是，如果我有多个 for 循环背靠背 ，则内存问题*很容易重现。*

# 测试 2

```
public class TestFBot {
    public static void main(String[] args) {
        try {
            FastRobot fbot = new FastRobot();

            double startTime = System.currentTimeMillis();
            for (int i=0; i < 1000; i++)
                fbot.createArrayScreenCapture();
            System.out.println("Time taken: " + (System.currentTimeMillis() - startTime)/1000.);

            startTime = System.currentTimeMillis();
            for (int i=0; i < 500; i++)
                fbot.createArrayScreenCapture();
            System.out.println("Time taken: " + (System.currentTimeMillis() - startTime)/1000.);

            startTime = System.currentTimeMillis();
            for (int i=0; i < 200; i++)
                fbot.createArrayScreenCapture();
            System.out.println("Time taken: " + (System.currentTimeMillis() - startTime)/1000.);

            startTime = System.currentTimeMillis();
            for (int i=0; i < 1500; i++)
                fbot.createArrayScreenCapture();
            System.out.println("Time taken: " + (System.currentTimeMillis() - startTime)/1000.);

        } catch (AWTException e) {
            e.printStackTrace();
        }
    }
} 
```

## 检查

失控的堆现在可以重现我会说大约 80% 的时间。我已经查看了分析器的所有内容，最值得注意的事情（我认为）是垃圾收集器似乎在第四个也是最后一个循环开始时停止了*。*

上述代码的输出给出了以下时间：

```
Time taken: 24.282    //Loop1
Time taken: 11.294    //Loop2
Time taken: 7.1       //Loop3
Time taken: 70.739    //Loop4 
```

现在，如果将前三个循环相加，它加起来是 42.676，这可疑地对应于垃圾收集器停止的确切时间，以及内存峰值。

![在此处输入图像描述](../Images/b3c37fcc174adf88016b1ba7a0f51f44.png)

现在，这是我第一次进行性能分析，更不用说我第一次想到垃圾收集——它总是在后台神奇地工作——所以，我不确定是什么，如果有的话，我已经发现了。

## 其他个人资料信息

![在此处输入图像描述](../Images/71379d5c9fc33361166ecdd275871ac4.png)

Augusto 建议查看内存配置文件。有 1500 多个`int[]`被列为“无法访问，但尚未收集”。这些肯定是创建的`int[]`数组`peer.getRGBPixels()`，但由于某种原因，它们没有被破坏。不幸的是，这些附加信息只会增加我的困惑，因为我不确定*为什么*GC 不会收集它们

* * *

## 使用小堆参数 -Xmx256m 的配置文件：

在声名狼藉和 Hot Licks 的建议下，我将最大堆大小设置为明显更小。虽然这*确实*阻止了它在内存使用量上的 1gb 跳跃，但它仍然没有解释*为什么*程序在进入第 4 次迭代时会膨胀到其最大堆大小。

![在此处输入图像描述](../Images/5fd686a0c7239334198a68c56adecdbb.png)

如您所见，确切的问题仍然存在，只是变小了。;) 这个解决方案的问题是，由于某种原因，程序仍在消耗它所能消耗的所有内存——从第一次迭代开始，fps 性能也有显着变化，消耗的内存非常少，并且最后一次迭代，它会消耗尽可能多的内存。

问题仍然是*为什么*它会膨胀？

* * *

## 点击“强制垃圾收集”按钮后的结果：

在 jtahlborn 的建议下，我点击了*强制垃圾收集*按钮。它工作得很好。它从 1gb 的内存使用量下降到 60mb 左右的基线。

![在此处输入图像描述](../Images/6e2591fbc98df56210dd540e921712ed.png)

所以，这似乎是治疗方法。现在的问题是，我如何以编程方式强制 GC 执行此操作？

* * *

## 将本地 Peer 添加到函数范围后的结果：

在 David Waters 的建议下，我修改了该`createArrayCapture()`函数，使其拥有一个本地`Peer`对象。

不幸的是，内存使用模式没有变化。

![在此处输入图像描述](../Images/c90f747b1392a7f044a93cc45eca31ba.png)

在第 3 次或第 4 次迭代中仍然会变得很大。

* * *

# 内存池分析：

### 来自不同内存池的屏幕截图

## 所有游泳池：

![所有游泳池](../Images/43941eca97a2c8c4411b00fcbe42dee4.png)

## 伊甸池：

![伊甸园池](../Images/2005b9e592fc2dd972f99a7c69ee07a1.png)

## 老一代：

![老一代](../Images/dcd41d35de57d336bb71784de693e98a.png)
几乎所有的内存使用似乎都在这个池中。

注意：PS 幸存者空间（显然）使用率为 0

* * *

## 我有几个问题：

(a) Garbage Profiler 图的意思是我认为的意思吗？还是我混淆了因果关系的相关性？正如我所说，我在这些问题的未知领域。

(b) 如果*是*垃圾收集器……我该怎么办……？为什么它完全停止，然后在程序的其余部分以降低的速度运行？

(c) 我该如何解决这个问题？

这里发生了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-02T11:13:31.267

尝试手动指定垃圾收集器。

Concurrent Mark Sweep 是一种很好的通用型，它在低暂停和合理的吞吐量之间提供了良好的平衡。

如果您使用的是 Java 7 或更高版本的 Java 6，G1 收集器可能会更好，因为它还能够防止内存碎片。

您可以查看[Java SE Hotspot Virtual Machine Garbage Collection Tuning](http://www.oracle.com/technetwork/java/javase/gc-tuning-6-140523.html)页面以获取更多信息和指针：-D

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-28T17:46:46.133

您说您将对象创建从方法转移到类上的字段。您移动的依赖项之一是“对等”吗？例如

```
peer = ((ComponentFactory)toolkit).createRobot(elRoboto, screen); 
```

很可能对等点会保留在对象生命周期内拍摄的所有屏幕截图，当对等点超出范围、Robot 中的方法结束、FastRobot 类的生命周期时，这将被清除。

尝试将 peer 的创建和范围移回您的方法，看看有什么不同。

```
public int[] createArrayScreenCapture() throws HeadlessException, AWTException {
        RobotPeer localPeer = ((ComponentFactory)toolkit).createRobot(elRoboto, screen);
        return localPeer.getRGBPixels(screenRect);
} 
```

* * *

**尝试 2**

> 所以，这似乎是治疗方法。现在的问题是，我如何以编程方式强制 GC 执行此操作？

您可以调用 System.gc() 来请求垃圾回收。请注意，这是一个请求，而不是一个要求。JVM 只会在认为值得时才运行垃圾收集。

> 如您所见，确切的问题仍然存在，只是变小了。;) 这个解决方案的问题是，由于某种原因，程序仍在消耗它所能消耗的所有内存——从第一次迭代开始，fps 性能也有显着变化，消耗的内存非常少，并且最后一次迭代，它会消耗尽可能多的内存。
> 
> 问题仍然是为什么它会膨胀？

JVM 将尝试仅在绝对必要时（使用大部分堆）运行主要垃圾收集。（阅读年轻一代与老一代以及在年轻一代、伊甸园空间和幸存者空间内）。因此，期望长期存在或需要内存的 Java 应用程序位于最大堆大小附近。值得注意的是，要让内存进入老一代，它必须在 3 次次要 GC 运行中幸存下来（Eden => Survivor 1 => Survivor 2 => Old Generation [取决于您正在运行的 JVM 和您选择的 GC 方案在命令行参数上。]）

至于为什么这种行为会发生变化，可能是很多事情。最后一个循环是最长的，System.getCurrentTimeMillis() 是否阻塞足够长的时间让 GC 在不同的线程上运行？所以问题只显示在更长的循环中？截屏过程对我来说听起来很低级，我假设通过调用操作系统内核来实现，这是否会阻止内核空间中的进程阻止其他线程运行？（这将停止 gc 在后台线程中运行）。

查看[http://www.javacodegeeks.com/2012/01/practical-garbage-collection-part-1.html](http://www.javacodegeeks.com/2012/01/practical-garbage-collection-part-1.html)了解垃圾收集世界。或[Java 内存解释 (SUN JVM)](https://stackoverflow.com/questions/858250/java-memory-explained-sun-jvm)以获得更多链接。

希望有帮助。

# c# - C# 局部变量

> ID：15141016
> 
> 赞同：1
> 
> 时间：2013-02-28T16:46:23.137
> 
> 标签：c#, variables, local

有人可以解释为什么我得到：

> “使用未分配的局部变量 number_of_column”用于： if (i < number_of_column -1)

处理这个问题的最佳方法是什么？

```
static void Main(string[] args)
{ 
    int number_of_column;
    if (Directory.Exists(path))
    {
        var file = dir.GetFiles().OrderByDescending(f => f.LastWriteTime).First();
        string file1 = file.ToString();
        Console.WriteLine(file1);
        StreamReader sr = new StreamReader(path + "\\" + file1);
        string line;
        while ((line = sr.ReadLine()) != null)
        {
            if (start == true)
            {
                string[] line1 = line.Split(',');
                number_of_column = line1.Count();
                i = 0;
                foreach (string s in line1)
                {
                    if ((s != "0") || (!string.IsNullOrEmpty(s)))
                    {
                        col[i] = "checked";

                    }
                    i++;
                }
            }
            else
            {
                if (line.Contains("Timestamp") && line.Contains("LiveStandby") && line.Contains("peak"))
                {
                    start = true;

                }
            }
        }
        sr.Close();

        i=0;
        foreach (string s in col)
        {
            if (i < number_of_column -1)
            { 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-28T16:48:42.843

如果您从未进入 while 循环，则该变量没有赋值。

如果您在 if 中点击 else 分支，则该变量没有赋值。

这些是您收到此错误消息的原因。

您可以通过在声明变量时分配一个值来解决此问题。

C# 要求您在使用局部变量之前对其进行初始化。对于成员变量，这不是必需的，它们会自动分配默认值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-28T17:18:28.300

完全精炼您的代码

1.  `file`then`file1`只是多余的，语句可以合并并且在语义上更有意义。

2.  `if (start == true)`是不必要的复杂，只是`if(start)`

3.  使用[`using Statement`](http://msdn.microsoft.com/en-us/library/yh598w02.aspx)woule更好保证`IDisposable`like的正确使用`StreamReader`。

4.  将[`Path.Combine Method`](http://msdn.microsoft.com/en-us/library/fyy7a5kt.aspx)两个字符串组合成一条路径。

5.  两个`foreach`s 最好是`for`，因为您正在按顺序迭代数组。

6.  不难发现`number_of_column`没有必要使用您只是存储数组迭代的计数。

* * *

代码：

```
static void Main(string[] args) {
    int number_of_column; // never used

    if(Directory.Exists(path)) {
        var file1=(
            from f in dir.GetFiles()
            orderby f.LastWriteTime
            select f
            ).First().ToString();

        Console.WriteLine(file1);

        using(var sr=new StreamReader(Path.Combine(path, file1)))
            for(String line; null!=(line=sr.ReadLine()); ) {
                if(start) {
                    var line1=line.Split(',');

                    for(var i=0; i<line1.Length; ++i) {
                        var s=line1[i];

                        if("0"!=s||!String.IsNullOrEmpty(s))
                            col[i]="checked";
                    }

                    continue;
                }

                if(
                    line.Contains("Timestamp")
                    &&
                    line.Contains("LiveStandby")
                    &&
                    line.Contains("peak"
                    ))
                    start=true;
            }

        for(var i=0; i<col.Length; ++i) {
            // following lines are no more needed
            // if(i<number_of_column-1) {
            // }
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T16:49:39.507

尝试将您的第一行更改为：

```
static void Main(string[] args){ int number_of_column = 0;if (Directory.Exists(path)) 
```

或格式化：

```
static void Main(string[] args)
{
    int number_of_column = 0;
    if (Directory.Exists(path)) ... 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-28T16:49:39.787

这意味着您没有为其分配任何初始值。

替换这个

```
int number_of_column; 
```

和

```
int number_of_column = 0; 
```

这将解决您的问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-28T16:52:37.023

作为一种防止副作用的机制，C# 不允许使用未初始化的变量——已声明但没有明确设置值的变量。这就是你得到错误的原因。将其初始化为零可以解决问题。

# powershell - 是否可以在用户 cd-ing 到目录时运行脚本

> ID：15141017
> 
> 赞同：2
> 
> 时间：2013-02-28T16:46:28.247
> 
> 标签：powershell

是否可以在 PowerShell 中设置脚本以在某人`cd`访问目录时自动运行？

我理解为什么这是一个糟糕、可怕、不好的主意的所有原因，但是是否有一种机制来支持它而不涉及一些深入的文件系统黑客攻击？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T18:19:11.860

`cd`只是 Set-Location 的别名。您可以删除`cd`别名（您需要使用 -Force IIRC），然后创建一个 CD 函数。这就是[PSCX](http://pscx.codeplex.com)所做的。但是，如果要处理直接使用 Set-Location 的情况，则需要为 Set-Location 创建[代理函数](http://blogs.technet.com/b/heyscriptingguy/archive/2011/03/01/proxy-functions-spice-up-your-powershell-core-cmdlets.aspx)，以便注入自定义代码。

# redirect - CQ5 - 虚 URL 的 Google 分析问题

> ID：15141020
> 
> 赞同：1
> 
> 时间：2013-02-28T16:46:30.033
> 
> 标签：redirect, google-analytics, adobe, aem, vanity-url

在我们的项目中，我们配置了虚 URL，以便用户可以在地址栏中输入虚 URL，这会将他们重定向到原始 URL。

例如：

如果用户输入“ [http://www.abc.com/partner](http://www.abc.com/partner) ”，它会将他们重定向到“ [http://www.abc.com/us/en/partners/become-a-partner.html](http://www.abc.com/us/en/partners/become-a-partner.html) ”。这个映射是从 Felix 控制台配置的，CQ 负责重定向。

但是当 CQ 发生这种重定向时，请求标头没有“referer”字段（谷歌分析中的引用 URL 为空白），因此谷歌分析报告将虚 URL 重定向视为直接流量。

**基本上，我们希望看到虚荣流量与其他直接流量分开处理。**

有任何解决方法可以实现这一目标吗？请分享您的详细信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T16:42:52.443

内置的 CQ5 虚 URL 功能可能正是您想要的。在基本选项卡上设置此[页面属性](http://dev.day.com/docs/en/cq/5-5/wcm/page_create_edit.html#Basic)。我认为您需要取消选中 Redirect Vanity URL 复选框以获取您想要的引荐来源标头。 ![在此处输入图像描述](../Images/a4706fb0f327ddbc580221f55a2ad0b8.png)

# objective-c - 在类别中被覆盖的方法是否总是优先于原始实现？

> ID：15141026
> 
> 赞同：3
> 
> 时间：2013-02-28T16:46:52.960
> 
> 标签：objective-c, methods, overriding, objective-c-category

我知道通过使用类别来覆盖方法是一种不鼓励的做法。尽管如此，我必须处理一些执行此操作的代码。当我运行以下代码时，我最初对在这两种情况下都调用了我的类别方法感到惊讶，尽管考虑链接器必须如何在链接时为任何给定符号做出决定让我感觉更好。

我的问题：假设除了我创建的类别之外没有其他类别在起作用，我是否保证只要从某个地方导入它的标头，我的类别中的实现将始终是被调用的逻辑？

**一些对象.h**

```
#import <Foundation/Foundation.h>

@interface SomeObject : NSObject

- (void)doSomething;

@end 
```

**一些对象.m**

```
#import "SomeObject.h"

@implementation SomeObject

- (void)doSomething
{
    NSLog(@"Original");
}

@end 
```

**someObject+Cat.h**

```
#import <Foundation/Foundation.h>

#import "SomeObject.h"

@interface SomeObject (SomeObject)

- (void)doSomething;

@end 
```

**someObject+Cat.m**

```
#import "SomeObject+Cat.h"

@implementation SomeObject (SomeObject)

- (void)doSomething
{
    NSLog(@"New!");
}

@end 
```

**一些ObjectUser.h**

```
#import <Foundation/Foundation.h>

@interface SomeObjectUser : NSObject

- (void)useSomeObject;

@end 
```

**一些ObjectUser.m**

```
#import "SomeObjectUser.h"

#import "SomeObject.h"

@implementation SomeObjectUser

- (void)useSomeObject
{
    [[SomeObject new] doSomething];
}

@end 
```

**测试.m**

```
- (void)testExample
{
    [[SomeObject new] doSomething];
    [[SomeObjectUser new] useSomeObject];
} 
```

**结果**

```
2013-02-28 11:32:37.417 CategoryExample[933:907] New!
2013-02-28 11:32:37.419 CategoryExample[933:907] New! 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-28T16:58:40.393

> 假设除了我创建的类别之外没有其他类别在起作用，我是否保证只要从某个地方导入它的标头，我的类别中的实现将始终是被调用的逻辑？

我怀疑是否导入类别标题是否重要。头文件是编译器的信息；在运行时将类别添加到类中，并且在运行时选择用于给定方法的实现。更重要的是...

来自[Objective-C 编程指南](http://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/ProgrammingWithObjectiveC/CustomizingExistingClasses/CustomizingExistingClasses.html#//apple_ref/doc/uid/TP40011210-CH6-SW4)：

> 如果在一个类别中声明的方法的名称与原始类中的方法相同，或者与同一类（甚至是超类）上的另一个类别中的方法相同，则对于在哪个方法实现中使用**的行为是不确定**的运行。如果您将类别与您自己的类一起使用，这不太可能成为问题，但在使用类别向标准 Cocoa 或 Cocoa Touch 类添加方法时可能会导致问题。

（强调我的。）

鉴于使用了*undefined*这个词，我会说这个问题的答案是否定的，当你重新实现一个类别中的现有方法时，**不能保证将使用哪个实现。**实际上，如果该类是您自己的，那么您的类别的方法很可能会被选中，如果它在测试给定版本的编译器和运行时工作，我相信它是可靠的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T16:57:35.253

**更新**：

在下面链接的 SO 答案中，指向 Objective-C 类别文档的链接已失效。[这是更多最新版本](http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/ProgrammingWithObjectiveC/CustomizingExistingClasses/CustomizingExistingClasses.html)。有一节是关于避免名称冲突的。

* * *

是的，根据this [SO answer](https://stackoverflow.com/a/5272612/620197)，（我会在找到它时发布官方Apple链接）。

一些警告，原始方法将无法访问，但您始终可以通过 to `super`，不能保证在另一个类别（在同一类上）声明的方法将被覆盖。

# ios - Interface Builder 自动将 UIImageView 添加到我的视图中

> ID：15141027
> 
> 赞同：0
> 
> 时间：2013-02-28T16:46:52.503
> 
> 标签：ios, uiview, uiimageview, interface-builder

我像这样创建界面构建器树

```
myScrollview
    UIView 
```

当我运行时，滚动视图似乎有 3 个这样的子视图

```
myScrollview
   UIView
   UIImageView
   UIImageView 
```

此结果由此代码（带有断点和监视面板）测试，该代码在 super viewDidLoad 之前添加

```
for(int i = 0 ; i < myScrollview.subviews.count ; i++){  
    id temp = [myScrollview.subviews objectAtIndex:i];  
} 
```

删除某些属性后出现错误，并且我已经检查了界面生成器，没有与此删除相关的警告

我应该怎么做才能获得有关此错误的更多线索？

* * *

> 解决了

我将第三个滚动视图移到后面。这个视图加载了 loadNib，我想我没有将它设置为隐藏（已经设置但它没有消失）。不知道应该在哪里设置 ThridScrollView.hidden = TRUE。〜__〜'

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T17:04:41.780

那个代码是错误的。您正在寻找 myScrollview 中的对象，而不是 myScrollview.subviews

它应该是：

```
for(int i = 0 ; i < myScrollview.subviews.count ; i++){  
    id temp = [myScrollview.subviews objectAtIndex:i];  
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T17:07:50.387

这是完全正常的，我可以自己在 IB 中重现它。A`UIScrollView`包含许多您无权访问的子视图。这包括一些`UIImageViews`，用于显示反弹/滚动`UIScrollView`越过其边缘时出现的“渐变”。

您看到的是 Apple 在滚动视图实现中使用的“私有”视图。您应该忽略它们，并记住，对于 Apple 提供的大多数视图类（滚动视图、表格视图、集合视图等），还有其他未记录的子视图，Apple 内部正在使用它们。作为一般规则，您应该记住这可能具有欺骗性，因为您通常不知道的子类中`subviews`正在发生一些事情。`UIView`

如果您遇到您认为可能涉及这些私人图像视图的问题，请告诉我们 - 或许提供有关问题究竟是什么的更多详细信息？屏幕截图可能非常有用。

# gwt - GWT 中的 Google+ 登录按钮

> ID：15141029
> 
> 赞同：2
> 
> 时间：2013-02-28T16:46:54.423
> 
> 标签：gwt, google-plus

我想在GWT中使用新的[Google+ 登录按钮。](https://developers.google.com/+/web/signin/)我找到[了这篇](https://stackoverflow.com/questions/11691624/how-to-make-gwt-widget-from-html-and-javascript) 关于如何从 html 制作小部件的帖子，但我还没有成功。

```
public class GooglePlusSignIn extends Widget{

private final String googleHtml="<span id=\"signinButton\">"
+"<span"
+"class=\"g-signin\""
+"data-callback=\"signinCallback\""
+"data-clientid=\"clientID\""
+"data-cookiepolicy=\"single_host_origin\""
+"data-requestvisibleactions=\"http://schemas.google.com/AddActivity\""
+"data-scope=\"https://www.googleapis.com/auth/plus.login\">"
+"</span>"
+"</span>";

 public GooglePlusSignIn(String params) {
     Document document = Document.get();
     DivElement divElement = document.createDivElement();
     divElement.setInnerHTML(googleHtml);
     setElement(divElement); //important, widget needs to know it's root element
 }

 private static native void doJsMagic(Element element)/*-{ //notifies js about element
 }-*/;

 private static native void undoJsMagic(Element element)/*-{ 
    //notifies js that it should do some cleanup (if needed)
    //since it is unaware of GWT widget lifecycle

 }-*/;

 @Override
 public void onAttach() {
    super.onAttach();
    doJsMagic(getElement());
 }

 @Override
 public void onDetach() {
    super.onDetach();
//        undoJsMagic(getElement());
     }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-08-21T03:44:28.903

您的字符串中需要空格。span 和 class、\"g-signin\" 和 data-callback 等之间的空间。

另外，我假设您知道这一点，但您必须将 clientID 替换为开发人员控制台中的实际客户端 ID。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T16:58:24.867

看起来你需要打电话[`$wnd.gapi.signin.go(element)`](https://developers.google.com/+/web/signin/#javascript_api)，`doJsMagic`但只做一次，在第一次*附加*。您无需在`undoJsMagic`.

# testing - 具有多种 Sampler Sender 模式的 JMeter 分布式测试

> ID：15141030
> 
> 赞同：2
> 
> 时间：2013-02-28T16:46:56.013
> 
> 标签：testing, jmeter, distributed

我正在尝试使用 JMeter 2.9 运行分布式测试：

*   **1个客户端**（主JMeter开始测试并收集结果）
*   **2 个服务器**（执行实际请求并将数据发送回客户端的从属服务器）

问题是关于**采样器发送器模式**配置：我想使用**DiskStore**将结果存储在每个从站中，并在测试结束后收集它们。我已经成功地测试了这个。

但是我想**在执行过程中**获得一些数据，以在测试结束之前查看测试的进展情况。

我的第一次尝试是配置`sample_sender_client_configured=false`应该强制使用从配置。然后将一台从机配置为 DiskStore，另一台配置为**标准**模式。我了解到，使用此配置，Standard 中的 slave 将**在测试期间**向 master 发送数据，而具有 DiskStore 的 slave 将**在测试**完成后发送数据。

但是，在执行期间，侦听器中没有显示任何数据。当测试完成结果正确绘制时（我假设来自两个奴隶）。

关于如何解决这个问题的任何想法？在分布式测试中是否可以有**多个样本发送者模式**？是否有任何其他选项可以使用 DiskStore 模式进行分布式测试并且在测试期间仍然有一些数据？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-03T10:48:10.567

你不应该混合模式。最新的 2.9 版本附带最佳配置。

要在测试期间获得结果，请将其添加到客户端中的 user.properties：

```
 summariser.name=summary 
 # 
  # interval between summaries (in seconds) default 3 minutes 
  summary.interval=20 
  # 
  # Write messages to log file 
  summariser.log=false 
  # 
  # Write messages to System.out 
  summariser.out=true 
```

# python - Python Turtle，在屏幕上用更大的字体绘制文本

> ID：15141031
> 
> 赞同：16
> 
> 时间：2013-02-28T16:47:01.957
> 
> 标签：python, turtle-graphics

我正在使用 python turtle 的 write 方法在屏幕上写文本，如下所示：

```
turtle.write("messi fan") 
```

字体大小太小。如何增加字体的大小？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-02-28T16:50:23.450

使用可选`font`参数 to [`turtle.write()`](http://docs.python.org/2/library/turtle.html#turtle.write)，来自文档：

> `turtle.write(`*arg* , *move=False* , *align="left"* , *font=("Arial", 8, "normal")*`)`
>  **参数：**
> 
> *   **arg** – 要写入 TurtleScreen 的对象
> *   **移动**——真/假
> *   **align** – 字符串“left”、“center”或right”之一
> *   **字体**- 三元组（字体名称、字体大小、字体类型）

所以你可以做一些事情，比如`turtle.write("messi fan", font=("Arial", 16, "normal"))`将字体大小更改为 16（默认为 8）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-03-14T16:29:37.127

您也可以在这里使用“粗体”和“斜体”而不是“正常”。“Verdana”可用于字体名称..

但另一个问题是：你如何设置你写的文本的颜色？

答：您使用turtle.color() 方法或turtle.fillcolor()，如下所示：

```
turtle.fillcolor("blue") 
```

要不就：

```
turtle.color("orange") 
```

这些调用必须在turtle.write() 命令之前。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-08-23T16:30:16.983

要添加粗体、斜体和下划线，只需将以下内容添加到字体参数：

`font=("Arial", 8, 'normal', 'bold', 'italic', 'underline')`

# wpf - 绑定到 ComboBox 的 SelectedItem 的属性

> ID：15141032
> 
> 赞同：0
> 
> 时间：2013-02-28T16:47:02.127
> 
> 标签：wpf, xaml, binding, combobox, selecteditem

我很难找到正确的语法来绑定到 ComboBox 的 SelectedItem 的属性。这是我尝试用于绑定的 XAML。您在哪里看到 SelectedItem.Mode 是我遇到困难的想法。请注意，CurrentMode 在 ViewModel 中，并且与 SelectedItem.Mode 具有相同的类型

```
<ComboBox SelectedItem.Mode="{Binding Path=CurrentMode, Mode=TwoWays}">
            <ComboBox.ItemTemplate>
                <DataTemplate>
                    <Image Source="{Binding ImageSource}"/>
                </DataTemplate>
            </ComboBox.ItemTemplate>
            <local:ModeItem Mode="Free" ImageSource="pencil.png"/>
            <local:ModeItem Mode="Arrow" ImageSource="arrow.png"/>

        </ComboBox> 
```

本地：ModeItem 看起来像这样

```
 public class ModeItem : DependencyObject, INotifyPropertyChanged
{
    public static readonly DependencyProperty ModeProperty = DependencyProperty.Register("Mode", typeof(AnnotationMode), typeof(ModeItem));
    public AnnotationMode Mode
    {
        get { return (AnnotationMode)GetValue(ModeProperty); }
        set { SetValue(ModeProperty, value); }
    }
    public string ImageSource { get; set; }

    public event PropertyChangedEventHandler PropertyChanged;
} 
```

我正在使用 MVVM 并尝试将 ViewModel 的 AnnotationMode (CurrentMode) 绑定到 ComboBox 的 SelectedItem 的 AnnotationMode (Mode)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T17:54:47.777

只需这样做 SelectedItem="{Binding CurrentMode}

你不必做你正在做的所有这些额外的事情。注意您确实需要使组合框的数据上下文指向您的视图模型。

编辑： - 你应该能够做到这一点

```
SelectedValue="{Binding CurrentMode, Mode=TwoWay}" 
SelectedValuePath="Mode" 
```

# c++ - 将矩形转换为梯形以进行透视

> ID：15141039
> 
> 赞同：6
> 
> 时间：2013-02-28T16:47:24.270
> 
> 标签：c++, math, opencv, perspective

我有正面的照片。我想把它变成鸟瞰图。现在我想计算矩形 (x,y) 中的每个点将在梯形中转换 x,y 的内容。 ![在此处输入图像描述](../Images/229efdc0b652ad24050d7df07e8f7e06.png)

对于给定的 x 和 y 以及梯形 (a) 的角度，这种变换必须有一个公式。

我正在用 C 编程并使用 opencv。

提前非常感谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-28T16:51:44.200

您是否考虑过[单应性](http://en.wikipedia.org/wiki/Homography)变换。您使用它来创建或纠正图像中的透视，我认为这正是您想要的。

使用 OpenCV，您可以使用方法[cv::findHomography()](http://docs.opencv.org/modules/calib3d/doc/camera_calibration_and_3d_reconstruction.html?highlight=homography#findhomography)。参数是 4 个初始点（矩形的顶点）和 4 个最终点（梯形的顶点）。您将获得一个转换矩阵，然后您可以将其与[cv::warpPerspective()](http://docs.opencv.org/modules/imgproc/doc/geometric_transformations.html#warpperspective)或[cv::perspectiveTransform()](http://docs.opencv.org/modules/core/doc/operations_on_arrays.html#perspectivetransform)一起使用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-01-20T16:48:50.793

我能够找到解决您问题的方法。

这是我用于相同的代码：

导入所需的包：

```
import cv2
import numpy as np 
```

读取要使用的图像：

```
filename = '1.jpg'
img = cv2.imread(filename)
cv2.imwrite('img.jpg',img) 
```

[![在此处输入图像描述](../Images/334aec58e9e69564f2d7e778ef7dca45.png)](https://i.stack.imgur.com/dwOuI.jpg)

将图像的高度和宽度存储在单独的变量中：

```
ih, iw, _ = img.shape 
```

创建一个大小大于图像大小的黑色窗口，并将其高度和宽度存储在单独的变量中：

```
black = np.zeros((ih + 300, iw + 300, 3), np.uint8)
cv2.imwrite('black.jpg',black)
bh, bw, _ = black.shape 
```

[![在此处输入图像描述](../Images/ec5257e97cdfa2ecc09a4c069bad8404.png)](https://i.stack.imgur.com/OxUGo.jpg)

将图像的 4 个角点存储在数组中：

```
pts_src = np.array([[0.0, 0.0],[float(iw), 0.0],[float(iw), float(ih)],[0.0,float(ih)]]) 
```

存储要获得的梯形的4个角点：

```
pts_dst = np.array([[bw * 0.25, 0],[bw * 0.75, 0.0],[float(bw), float(bh)],[0.0,float(bh)]]) 
```

`pts_src`使用和 计算单应矩阵`pts_dst`：

```
h, status = cv2.findHomography(pts_src, pts_dst) 
```

将给定的矩形图像变形为梯形：

```
im_out = cv2.warpPerspective(img, h, (black.shape[1],black.shape[0]))
cv2.imwrite("im_outImage.jpg", im_out) 
```

[![在此处输入图像描述](../Images/782da5c97680e5239595ac3833f9cd22.png)](https://i.stack.imgur.com/yRy9W.jpg)

```
cv2.waitKey(0)
cv2.destroyAllWindows() 
```

如果您更改数组中的值，`pts_dst`您将能够获得不同类型的四边形。

# java - java-pretty print sql查询

> ID：15141040
> 
> 赞同：8
> 
> 时间：2013-02-28T16:47:27.207
> 
> 标签：java

有人在java中有用于打印SQL查询的pretty_print函数吗？

给定字符串，如：

**从 person_table 中选择 person_table.name 加入 person_person ON person_table.name=person_person WHERE person_table.name=dan**

该函数将打印：

**选择 person_table.name**

**FROM 人表**

**加入 person_person**

**ON person_table.name=person_person**

**WHERE person_table.name=dan**

或更好？

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T16:59:14.533

您可以查看[org.apache.openjpa.lib.jdbc.SQLFormatter](http://ci.apache.org/projects/openjpa/trunk/javadoc/index.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-02-03T05:12:44.647

If you work with Hibernate try `org.hibernate.jdbc.util.FormatStyle.BASIC.getFormatter().format(yourNonFormattedSqlQueryString);`

# facebook - 如何将图片发布到 Facebook 群组

> ID：15141041
> 
> 赞同：-7
> 
> 时间：2013-02-28T16:47:30.280
> 
> 标签：facebook, post, sdk, facebook-group

我正在尝试将图片发布到群组。发布带有链接的消息没有问题，使用外部图像也没有问题。但我不能在群组中发布“实习生”（Facebook 图片）。我收到错误“(#100) FBCDN 图像不允许在流中：[http://www.facebook.com/photo.php?](http://www.facebook.com/photo.php?fbid=) fbid= {picture-id}”

是否有可能将照片发布到群组或发布上传的 Facebook 图片？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-05T21:52:50.513

您不能将图像发布到 Facebook 自己的 CDN 上托管的 Facebook，您需要从您自己的服务器上传。

原因是当您尝试这样做时，您会收到一条错误消息，告诉您无法使用 FBCDN 图像；fbcdn 是 Facebook 的 CDN 的 URL 的一部分。

解决方法是附加托管在您自己/另一台服务器上的图像

# php - Facebook SDK CSRF 错误

> ID：15141047
> 
> 赞同：0
> 
> 时间：2013-02-28T16:47:55.137
> 
> 标签：php, facebook, sdk, request, csrf

我对 Facebook SDK 有疑问。我不断收到以下错误：

> CSRF 状态令牌与提供的不匹配

我没有之前建议的任何 RewriteRule 规则，所以这不是问题。为了知道问题出在哪里，我将 getCode() 函数更改为以下内容：

```
 protected function getCode() {
if (isset($_REQUEST['code'])) {
  if ($this->state !== null &&
      isset($_REQUEST['state']) &&
      $this->state === $_REQUEST['state']) {

    // CSRF state has done its job, so clear it
    $this->state = null;
    $this->clearPersistentData('state');
    return $_REQUEST['code'];
  } else {
    $add = "";
    if ($this->state == null)
        $add .= " State is null";
    if (!isset($_REQUEST['state']))
        $add .= " State is not set";
    if ($this->state !== $_REQUEST['state'])
        $add .= " States are not that same";
    self::errorLog('CSRF state token does not match one provided. problem:' . $add);
    return false;
  }
}

return false; 
```

}

现在重新运行登录脚本后，出现以下错误：

> CSRF 状态令牌与提供的不匹配。问题：状态为空状态不一样

有谁知道如何解决这个问题？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-19T17:26:01.237

通过确保我发送请求的域与我得到答案的域相同，我的问题得到了解决。换句话说，www.website.com 与 website.com 不同。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-28T19:59:46.473

将`getCode`函数替换为：

```
protected function getCode() {
  $server_info = array_merge($_GET, $_POST, $_COOKIE);

  if (isset($server_info['code'])) {
  if ($this->state !== null &&
  isset($server_info['state']) &&
  $this->state === $server_info['state']) {

// CSRF state has done its job, so clear it
    $this->state = null;
    $this->clearPersistentData('state');
    return $server_info['code'];
} else {
    self::errorLog('CSRF state token does not match one provided.');
    return false;
  }
}

return false;
} 
```

该代码简单地结合了 $_GET、$_POST 和 $_COOKIE 数组，就像在 PHP 5.3.0 之前 $_REQUEST 的工作方式一样。希望能帮助到你。

# android - 在 LazyList 中显示之前裁剪图像

> ID：15141049
> 
> 赞同：1
> 
> 时间：2013-02-28T16:47:58.770
> 
> 标签：android, bitmap, crop, lazylist

我正在使用[LazyList](https://github.com/thest1/LazyList)将图像加载到列表视图中。但我只想在 ListView 中显示 Rect(8, 8, 16, 16)。这是否可以将 drawbitmap 与以前下载的图像一起使用？那么将图像下载到临时目录，然后对其进行裁剪，然后在 ListView 中显示？如何使用 Lazylist 做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T03:17:55.197

您可以在 ImageLoader 中添加一些图像处理。它应该在下载后在显示之前完成。

# bash - 替换属性名称中的点，而不是属性值中的点

> ID：15141057
> 
> 赞同：2
> 
> 时间：2013-02-28T16:48:26.340
> 
> 标签：bash, shell, sed, awk, properties-file

我有一个包含以下内容的文件（它是`.properties`来自 java 的文件）：

```
product.company.url=http://www.example.com/
product.version=1.3.2 
```

我需要替换属性名称中的所有点，而不是属性值中的点。所以，我想要的输出是：

```
product_company_url=http://www.example.com/
product_version=1.3.2 
```

我已经尝试过`sed -r 's/\.(\w+)([^=]*)/_\1\2/' product.default.properties`，但这只会替换第一个点。我想我可能不得不使用前瞻或后瞻，但我不知道这是否可能，因为断言的长度是可变的。属性名称中也可能有可变数量的点。

可以用单线做到这一点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T16:51:49.003

试试这一行：

```
awk -F= -vOFS="=" 'gsub(/\./,"_",$1)+1' file.properties 
```

用你的例子测试：

```
kent$  echo "product.company.url=http://www.example.com/
product.version=1.3.2"|awk -F= -vOFS="=" 'gsub(/\./,"_",$1)+1'
product_company_url=http://www.example.com/
product_version=1.3.2 
```

# php - PHP 为某些用户正确访问 MySQL 数据库，其他用户缺少某些列

> ID：15141059
> 
> 赞同：1
> 
> 时间：2013-02-28T16:48:34.513
> 
> 标签：php, mysql, missing-data

我对这里发生的事情感到茫然——因为根据我检查的用户，根本不一定有什么问题。这是相关数据库的结构：

```
userID       password      salt
VARCHAR(7)   VARCHAR(64)   VARCHAR(64) 
```

注意：**密码**和**盐**是 sha256 哈希。

以及相关代码（所有数据都通过 SSL 传输）：

```
$pass     = $_POST['pass'];
$user     = $_POST['user'];

$query    = 'SELECT password, salt FROM `Passwords` WHERE userID="'.$user.'";';
$result   = mysql_query($query);

$passHash = mysql_result($result,0,"password");
$salt     = mysql_result($result,0,"salt");

$pass     = hash("sha256",$salt.$pass);

if($pass==$passHash) {/*Allow Login*/} 
```

并非所有用户都选择了密码，而且我的组织历来使用邮政编码（我知道...）代替正确的密码，因此该代码确实为此设置了一些例外，但所有这些用户都可以正常登录. （只有一些）成员的密码无法登录，因为**$salt**由于某种原因返回空白（但我也没有收到任何 MySQL 错误）。我在运行调试尝试时通过 phpMyAdmin 检查了数据库，但没有明显的错误。

知道为什么它对某些用户来说是空白的，而对其他用户却不是吗？这是 PHP 问题、MySQL 问题还是我是个盲人白痴问题？

# php - floatval 返回 1 个 php 错误

> ID：15141060
> 
> 赞同：1
> 
> 时间：2013-02-28T16:48:38.507
> 
> 标签：php, variables, types, floating-point

我有一个带有浮点变量的 mysql 表。我想将它们传递给 mongodb 集合，但是当我这样做时，php 将我的浮点变量转换为字符串。我尝试使用此代码将变量类型设置为浮点数，但它在每个字段中返回 1：

```
foreach( $mytables as $table => $struct ) {
  $sql = mysql_query("SELECT num_auto FROM XL_10331_EXPLOIT_251012 where flightid like '191622'") or die( mysql_error() );
  $count = mysql_num_rows( $sql );
  // If it has content insert all content
  if( $count > 0 ) {
    while($info = mysql_fetch_row($sql)) {
        $int_info=intval($info);
          $mosql[]=($int_info);
  }

   // Starts new collection on mongodb
  $collection = $modb->floatdb;

  $collection->insert(array('num_auto'=>$mosql)); 
```

我找不到我的错误，任何帮助将不胜感激！谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T16:50:29.413

`intval`将仅返回数字的整数部分（或字符串中的数字）。尝试将值转换为浮点数

```
$float_value = (float) $sql_number; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-28T16:52:29.927

`mysql_fetch_row`返回一个数组，而不是一个值。所以你必须使用：

```
$int_info = (float)$info[0]; 
```

# asp.net-web-api - Web.API 部署 URL 不起作用？

> ID：15141064
> 
> 赞同：1
> 
> 时间：2013-02-28T16:48:39.600
> 
> 标签：asp.net-web-api, iis-7.5, web-deployment

在我的 Web.API 项目中，为了在 Web 设置中进行开发，我使用`http://localhost/reporter`本地 IIS Web 服务器上的“项目 URL：”。该站点使用 asp.net mvc4 提供了一些页面，这些页面使用 javascript 调用发布到诸如“api/getdata/”之类的 url。

出于某种原因，这些已经停止工作——例如，我会在 'api/getdata' 上发布一个 jQuery 帖子，并且完整的 URL`http://localhost/reporter/api/getdata`是正确的。生活很好。

但是现在有些事情发生了变化——同样的 jQuery 帖子，我所知道的代码中没有什么不同，但我的完整 URL 现在是`http://localhost/api/getdata`——我失去了那个“记者”部分。我认为当我将它部署到另一台内部服务器时可能发生了一些事情——它在本地运行良好——然后我部署并注意到它在新服务器上不起作用。然后我发现我不再在本地工作了。

我已经仔细检查过，我的项目配置似乎和以前一样......？

我确定我弄坏了一些东西，但我不知道是什么。想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T17:14:04.013

首先，我建议使用诸如 Fiddler 之类的工具或您的 Web 浏览器的开发工具来进行网络跟踪并查看失败的请求是什么。

在我看来，最可能的罪魁祸首是虚拟目录不同，或者浏览器的 URL 不同，导致相对路径解析不正确。在客户端上使用相对路径通常是一件非常糟糕的事情，因为客户端通常不知道相对于URL 是*什么。*

我建议只添加一些客户端代码，如下所示：

```
<script>
    var baseUrl = '@Url.Content("~/")';
</script> 
```

这将声明一个包含应用程序“根”的 JavaScript 变量。然后，在页面的其他地方，您可以拥有使用基本 URL 并附加相对路径的其余部分的代码：

```
<script>
    $.ajax(...., baseUrl + "api/getdata", ...);
</script> 
```

# azure - 如何在 IIS 而不是 IISExpress 上部署 WebRole？

> ID：15141065
> 
> 赞同：1
> 
> 时间：2013-02-28T16:48:39.283
> 
> 标签：azure

解决方案中有一个 Azure WebRole 和相应的服务。解决方案是 unser 源代码控制。问题是我的队友将源获取到他的工作站，在 Visual Studio 中打开它们，运行服务并将 WebRole 部署在本地 IIS 上，而我只能在同一工作流中的 IISExpress 上看到它。

我们比较了 Visual Studio 中项目的设置，没有发现差异。我们从 Visual Studio 运行后比较了源文件，没有发现差异，

谁能告诉我们有没有办法显式设置目标 IIS 引擎以在 Visual Studio 中部署 Web 角色？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T18:27:34.520

查看 Azure 项目的属性

![Azure 设置屏幕截图](../Images/6e6bf1e250d9f80ac132370e8d6bdd3f.png)

您应该能够将其设置为使用 IIS 而不是 express。

# actionscript-3 - Flex 发布到 php 页面

> ID：15141070
> 
> 赞同：0
> 
> 时间：2013-02-28T16:48:46.057
> 
> 标签：actionscript-3, apache-flex, flex3

我正在尝试将一些数据从我的 flex 应用程序发布到要保存的 PHP 脚本。

作为一个简单的测试，我已经制作了这样的 php 脚本

```
<?php
if ($_POST) {

    $message = "Text:" . $_POST['Text'];

    mail('vince@myemailaddress.com', 'POSTED!', $message);

} else {
    mail('vince@myemailaddress.com', 'No Post Test', 'Testing..');
}

?> 
```

如果我在浏览器中点击脚本，我会收到一封电子邮件。但是当我调用我的 flex 函数时，我什么也没得到？我做错了吗？

```
private function onTextMessageRecv(event:AsyncDataEvent):void
{
  var dialogID:String = event.data;
  var strFrom:String = event.data2;
  var strTime:String = event.data3;
  var MessageStr:String = event.data4;

  var variables:URLVariables = new URLVariables()
  variables.From = strFrom;
  variables.To = m_strUserDisplayName;
  variables.Text = MessageStr;
  saveIMdata( variables);

}

private function saveIMdata( variables:URLVariables):void 
{
    LogAddItem( LOG_CATEGORY_MAIN_DEBUG, "Saving IM...");
    var myData:URLRequest = new URLRequest("http://im.vlowe.co.uk/save.php")
    myData.method = URLRequestMethod.POST
    myData.data = variables
    var loader:URLLoader = new URLLoader()
    loader.dataFormat = URLLoaderDataFormat.VARIABLES
    loader.load(myData)
} 
```

我确实看到“正在保存 IM...”的日志条目，但没有电子邮件？

谢谢你的帮助。

**更新：** 试过这个..但两个事件似乎都没有触发？

```
private function saveIMdata( variables:URLVariables):void 
{
    LogAddItem( LOG_CATEGORY_MAIN_DEBUG, "Saving IM...");
    var myData:URLRequest = new URLRequest("http://im.vlowe.co.uk/save.php");
    myData.method = URLRequestMethod.POST;
    myData.data = variables;
    LogAddItem( LOG_CATEGORY_MAIN_DEBUG, variables.Text);
    var loader:URLLoader = new URLLoader();

    LogAddItem( LOG_CATEGORY_MAIN_DEBUG, "Loaded?...");
    loader.addEventListener(Event.COMPLETE, onLoadComplete);
    loader.addEventListener(IOErrorEvent.IO_ERROR, onLoadError);

    loader.dataFormat = URLLoaderDataFormat.VARIABLES;
    loader.load(myData);
}

private function onLoadComplete(e:Event):void
{
    var loader:URLLoader = URLLoader(e.target);
    trace(loader.data);
    LogAddItem( LOG_CATEGORY_MAIN_DEBUG, "Load completed");
    LogAddItem( LOG_CATEGORY_MAIN_DEBUG, loader.data.toString());
}

private function onLoadError(e:IOErrorEvent):void
{
    trace(e.text);
    LogAddItem( LOG_CATEGORY_MAIN_DEBUG, "Error " + e.text);
} 
```

**更新 2：** 我的 crossdomain.xml

```
<?xml version="1.0"?>
<!DOCTYPE cross-domain-policy SYSTEM
"http://www.adobe.com/xml/dtds/cross-domain-policy.dtd">

<cross-domain-policy>
    <site-control permitted-cross-domain-policies="all"/>
    <allow-access-from domain="*" to-ports="80,843,8080,8081,8082" secure="false"/>
</cross-domain-policy> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T19:40:27.250

对我来说听起来像是一个跨域安全问题。

```
 loader.addEventListener(SecurityErrorEvent.SECURITY_ERROR, securityErrorHandler);
    private function securityErrorHandler(event:SecurityErrorEvent):void {
       trace("securityErrorHandler: " + event);
    } 
```

[编辑]

这不存在[http://im.vlowe.co.uk/crossdomain.xml](http://im.vlowe.co.uk/crossdomain.xml)

您的 crossdomain.xml 应该如下所示。删除文档类型

```
<?xml version="1.0" encoding="UTF-8"?>
<cross-domain-policy>
    <allow-access-from domain="*.someDomain.com"/>
</cross-domain-policy> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T18:33:29.413

将错误和完整的处理程序添加到您的 URLLoader 并测试是否加载了 php 文件：

```
loader.addEventListener(Event.COMPLETE, onLoadComplete);
loader.addEventListener(IOErrorEvent.IO_ERROR, onLoadError);

private function onLoadComplete(e:Event):void
{
    var loader:URLLoader = URLLoader(e.target);
    trace(loader.data);
}

private function onLoadError(e:IOErrorEvent):void
{
    trace(e.text);
} 
```

在您的 php 文件中回显某些内容，您应该在 onLoadComplete 函数中看到它。

# html5-video - Chrome 和 IE 的 Video.js 问题）

> ID：15141081
> 
> 赞同：-2
> 
> 时间：2013-02-28T16:49:08.497
> 
> 标签：html5-video

我在我的计算机上使用 video-js 脚本，它工作正常，但是当我检查服务器时，视频没有启动。为什么？

检查视频链接：[在此处输入链接描述](http://www.webplustest.com/videos.html)

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T17:43:01.187

链接的视频文件返回 404。它可能没有上传到您的服务器或链接错误。这看起来正确吗？

[http://www.webplustest.com/images/realisations/video/PUB_GRANIT_EXCLUSIF.MP4](http://www.webplustest.com/images/realisations/video/PUB_GRANIT_EXCLUSIF.MP4)

# c# - 在 wpf 中做一个自定义菜单

> ID：15141094
> 
> 赞同：-4
> 
> 时间：2013-02-28T16:49:50.143
> 
> 标签：c#, wpf, wpf-controls, menubar

我需要完成一个软件，作为我职业生涯的最后工作在大学展示。截止日期非常接近，我想做一个漂亮的主菜单窗口。我正在使用带有一些 WPF 用户控件（按钮和所有小东西）的 winforms。现在，由于 winform 不能像 WPF 那样可定制，我正在考虑在 WPF 中制作主窗口。但是我有一个大问题，我对 WPF 和 XAML 知之甚少。

我使用 Expression blend，但也很难在那里做我需要的事情。

我想做的是这样的：

![在此处输入图像描述][1]

我需要一个顶部的菜单，但它必须有一个下面有标题的图像。然后，当鼠标进入那里时，它将打开并显示菜单项。

为了实现这一目标，我这样做了：

*   创建了一个用户控件，其中包含图像和文本所在的矩形，以及下面带有一些菜单项的菜单。我还使用故事板制作动画。

![在此处输入图像描述][2]

无论如何，我认为我做错了。我认为可能有一种方法可以更轻松地做到这一点。例如，我必须创建如下事件：当鼠标进入矩形时，菜单可见，如果不可见，则隐藏。另外，我必须为每个菜单项创建一个故事板。我的意思是，当它被选中时改变背景颜色等等。

我在这里真的需要帮助。如果有人可以帮助我至少编写菜单结构，那将是很棒的。

**问题已关闭**我终于设法用 Windows 窗体做到了

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T17:44:08.353

此链接向您展示如何为按钮制作上下文菜单。您可能必须手动编辑 XAML 和代码隐藏，但这会让您开始：

[http://dotnetlearning.wordpress.com/2011/02/20/dropdown-menu-in-wpf/](http://dotnetlearning.wordpress.com/2011/02/20/dropdown-menu-in-wpf/)

从网站复制：

这里的代码：

```
<Button Content="Click Me"  
    Click="Button_Click" 
    ContextMenuService.IsEnabled="False"  
    Margin="42,40,89,72">  
    <Button.ContextMenu>  
        <ContextMenu >  
            <MenuItem Header="Menu 1"/>  
            <MenuItem Header="Menu 1"/>  
            <MenuItem Header="Menu 1"/>  
            <MenuItem Header="Menu 1"/>  
        </ContextMenu>  
    </Button.ContextMenu>  
</Button> 
```

第二步是在单击按钮时显示 ContextMenu。这是通过几行代码实现的：

```
private void Button_Click(object sender, RoutedEventArgs e)  
{  
    (sender as Button).ContextMenu.IsEnabled = true;  
    (sender as Button).ContextMenu.PlacementTarget = (sender as Button);  
    (sender as Button).ContextMenu.Placement = System.Windows.Controls.Primitives.PlacementMode.Bottom;  
    (sender as Button).ContextMenu.IsOpen = true;  
} 
```

如果您想查看其他文章以提供帮助，我使用的 google 搜索是`how to make pull down menu in wpf`Good lucky！

# image - 如何在整个背景网页上添加文本内容滑块

> ID：15141100
> 
> 赞同：0
> 
> 时间：2013-02-28T16:50:01.377
> 
> 标签：image, text, slider, screen

我想在全屏背景网站上添加一个文本内容滑块。我的css很差。所以请帮我添加一个漂亮的文本内容滑块来描述每个背景图像。以下是我的后台页面 [http://alampady.tk/fullbg/testbackground.html](http://alampady.tk/fullbg/testbackground.html)

问候阿什拉夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T17:09:28.723

将此添加到您的

```
<link href='http://fonts.googleapis.com/css?family=Open+Sans:300,600' rel='stylesheet' type='text/css'> 
```

这是你的样式表

```
.colorbag {
   position: absolute;
   top: 300px;
   left: 900px;
   width: 500px;
   border: thin dotted;
   height: 200px;
   background-color: #ccc;
   opacity: 0.6;
   -webkit-border-radius: 3px;
   -moz-border-radius: 3px;
   border-radius: 3px;
   padding: 10px;
   font-family: 'Open Sans', sans-serif;
   line-height: 22px;
}

.colorbag span.subtext {
   font-weight: 600;
   font-size: 22px;
}
.colorbag font {
   font-weight: 300;
   font-size: 14px;
} 
```

然后我认为它会好 10 倍 =)

# prolog - SWI-Prolog 控制台代码完成？

> ID：15141102
> 
> 赞同：1
> 
> 时间：2013-02-28T16:50:10.587
> 
> 标签：prolog, swi-prolog

代码完成在 SWI Prolog 编辑器窗口中工作正常：Meta+/。如何从 SWI Prolog 控制台窗口（出现 ?- 提示的窗口）调用代码完成？（赢得 x64 构建）

**编辑：**如下所示，TAB 仅完成*最大公共前缀*。它不会显示所有（或最常见的）可能性，也不会循环显示它们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T17:01:06.090

应该是TAB，但我对此并不完全满意。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T06:45:17.750

这对我也不起作用。我从来没有找到一种方法让它在 Windows 的 UI 中的任何地方工作。

# ruby-on-rails - 从 Rails 中的 Activerecord::Relation 生成记录数组

> ID：15141103
> 
> 赞同：1
> 
> 时间：2013-02-28T16:50:14.493
> 
> 标签：ruby-on-rails, activerecord, relation

Rails 的新手，构建电子商务系统。

我有一个树状的产品结构 -> skus -> line_items

在哪里：

```
class LineItem < ActiveRecord::Base
  belongs_to :sku
  belongs_to :cart

class Sku < ActiveRecord::Base
  belongs_to :product

class Product < ActiveRecord::Base
  has_many :skus
  has_many :line_items, :through => :skus 
```

Product 模型有一个布尔字段，用于确定特定产品是否需要许可证。

将多个 line_items 添加到购物车中，以便：

```
@cart.line_items 
```

返回一个订单项数组。

在订单阶段，我需要确定是否有任何订单项需要许可证，如果需要，则显示许可证以供接受。

我试过链接范围：

```
 class LineItem < ActiveRecord::Base
  scope :license?, joins(:sku) & Sku.license?

class Sku < ActiveRecord::Base
  scope :license?, joins(:product) & Product.license?

class Product < ActiveRecord::Base
  scope :license?, where(:license => true)

@cart.line_items.license? 
```

导致一个空数组，即使 @cart.line_items 包含 product.license 为 true 的项目。

我试过了：

```
@cart.line_items.joins(:sku).joins(:product).where(:license => true) 
```

它返回一个 ActiveRecord::Relation，但是

```
@cart.line_items.joins(:sku).joins(:product).where(:rct => true).empty?
@cart.line_items.joins(:sku).joins(:product).where(:rct => true).to_a
@cart.line_items.joins(:sku).joins(:product).where(:rct => true).all 
```

在后两种情况下，所有都无法给出布尔值（在第一种情况下）或数组。

我可以循环：

```
<% @cart.line_items.each do |item| %>
    <h4><%= item %></h4>
    <h4><%= item.sku.product.license %></h4>
<% end %> 
```

并查看所有正确的布尔值，但必须有更好的方法来执行此操作，而不是在我的订单视图中使用此循环的变体，或者必须创建一个类方法来循环并生成布尔值。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T16:58:29.953

该产品似乎是了解它是否需要许可证的产品。在这种情况下，您需要从 line_item 一直上链到产品以获取该信息。您可以在委托给其 Sku 的类上添加一个`needs_license?`方法，该方法`LineItem`委托给其产品，然后像这样过滤掉 LineItems：

```
class LineItem
  def needs_license?
    sku.needs_license?
  end
end
class Sku
  def needs_license?
    product.needs_license?
  end
end

class Product
  def needs_license?
    license
  end
end 
```

最后，

```
@cart.line_items.select(&:needs_license?) 
```

# asp.net-mvc-4 - 在 mvc4 中编写路由以消除查询字符串

> ID：15141109
> 
> 赞同：0
> 
> 时间：2013-02-28T16:50:29.863
> 
> 标签：asp.net-mvc-4, routes

我有一种情况，我正在重定向到一个接受 3 个参数的操作。我正在这样做 -

```
RedirectToAction("ProductSpecific", routeValues: new { partId = m.partId, categoryId= m.categoryId, categoryName = m.categoryName}); 
```

但是，当页面加载时，它包含所有这些参数作为查询字符串。

```
Parts/ProductSpecific?partId=38&categoryId=1&categoryName=Monitor 
```

我试着写了一条路线，但是没有用。有人可以指导如何在这种情况下编写路线吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T06:19:44.657

RedirectToAction 的第二个参数是 routeValues，因此这些将附加到查询字符串中。创建额外的路由仍然需要您传递查询字符串中的值，但是像这样：parts/productspecific/{partId}/{categoryId}/{categoryname} 我认为您不需要。

如果您不想要查询字符串中的值，请查看 TempData 对象，该对象类似于会话，但将持续到下一个请求。

像这样的东西：

```
public ActionResult DoSomething()
{
  TempData["partId"] = partId;
  TempData["catId"] = catId;
  TempData["catName"] = catName;
  return RedirectToAction("ProductSpecific");
}

public ActionResult ProductSpecific()
{
  var partId = TempData["partId"];
  var catId = TempData["catId"];
  var catName = TempData["catName"];

  var model = service.LoadProduct(partId, catId, catName);

  return View(model);
} 
```

更新：

对于路线：

```
 routes.MapRoute(
     name: "ProductRoute",
     url: "{controller}/{action}/{partId}/{categoryId}/{categoryname}",
     defults: new { controller = "product", action = "productspecific"}
 ); 
```

在您的默认路由之前的 app_start 中的 route.config 类中添加该路由，并更改您的产品特定方法签名以接受 partid、catid 和类别名称参数。您还可以使用 phil hack 中的此功能来分析您的路线：[Route Debugger](http://haacked.com/archive/2008/03/13/url-routing-debugger.aspx)

# java - 递归调用的 Spring 事务

> ID：15141113
> 
> 赞同：0
> 
> 时间：2013-02-28T16:50:37.673
> 
> 标签：java, spring, transactions

我有一个使用 Spring 中的事务模板以编程方式启动事务的方法。

```
Void methodA() {
    TransactionTmeplate..........

    Setpropgation to requires new....

    /// do my stuff in trasaction

} 
```

因此，如果我有另一个调用此方法的类，它会创建一个事务，正如我所期望的那样。但是如果从同一个调用线程再次进入这个方法会发生什么。是否创建了另一个事务？

例子：

```
MethodCaller -> methodA (transaction created) -> methodD -> methodA(??) 
```

继：

此外，如果 class is `@autowired`，考虑到一个实例存在，两个调用线程是否会共享同一个事务？

我不会假设他们在该方法的堆栈上有自己的条目。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T17:01:58.343

上的 javadoc[`Propagation.REQUIRES_NEW`](http://static.springsource.org/spring/docs/current/javadoc-api/org/springframework/transaction/annotation/Propagation.html#REQUIRES_NEW)很清楚，我不确定是否可以更好地解释。

至于调用您的方法的不同线程：这`TransactionManager`将确保线程不会在事务方面相互交错。

但是拥有一个可重入且总是启动新事务的方法表明您的应用程序没有正确分层。尝试进行一些重构，并确保负责启动新事务的方法永远不会被递归调用。

# ios - 如何在 JSONRequestOperation 上向 AFNetworking 添加自定义标头

> ID：15141115
> 
> 赞同：19
> 
> 时间：2013-02-28T16:50:39.520
> 
> 标签：ios, objective-c, json, afnetworking, nsurlrequest

嗨，我有以下代码访问 URL：

```
NSString * stringURL = [NSString stringWithFormat:@"%@/%@/someAPI", kSERVICE_URL, kSERVICE_VERSION];
NSURLRequest * request = [NSURLRequest requestWithURL:[NSURL URLWithString:stringURL]];

AFJSONRequestOperation * operation = [AFJSONRequestOperation JSONRequestOperationWithRequest:request success:^(NSURLRequest *request, NSHTTPURLResponse *response, id JSON) {
    completionHandler(JSON, nil);
} failure:^(NSURLRequest *request, NSHTTPURLResponse *response, NSError *error, id JSON) {
    completionHandler(nil, error);
}]; 
```

但我想将用户令牌作为参数传递给`HEADER`，例如`X-USER-TOKEN`.

找不到`AFNetworking documentation`，要不要改操作类型？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-02-28T16:55:20.073

使用`AFHTTPClient`或继承它！

您可以像这样设置默认标题`-setDefaultHeader:value:`：

```
[self setDefaultHeader:@"X-USER-TOKEN" value:userToken]; 
```

您可以查看[文档](http://cocoadocs.org/docsets/AFNetworking/1.3.3/Classes/AFHTTPClient.html#//api/name/setDefaultHeader:value:)

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2013-02-28T16:58:57.963

```
NSMutableURLRequest* request = [[NSMutableURLRequest alloc] initWithURL:url];

[request setValue: @"X-USER-TOKEN"  forHTTPHeaderField:@"< clientToken >"];

[AFJSONRequestOperation JSONRequestOperationWithRequest: request ...] 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2015-05-21T03:28:36.430

我这样做了:)

```
[manager.requestSerializer setValue:[NSString stringWithFormat:@"Token token=\"%@\"", _userObj.oAuth] forHTTPHeaderField:@"Authorization"]; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-09-24T23:56:00.443

如果你有一个抽象层，比如说 APIManager，那么你应该在一个特定的方法中执行以下操作

```
 [[HTTPClient sharedHTTPClient].requestSerializer setValue:YOUR_KEY forHTTPHeaderField:@"X-Register"]; 
```

# javascript - JavaScript 函数是异步的吗？

> ID：15141118
> 
> 赞同：16
> 
> 时间：2013-02-28T16:50:52.190
> 
> 标签：javascript, jquery

考虑正在执行以下函数，

```
function loadPage()
{
    takeInput();
    processInput();
    outputInput();
} 
```

它们将以什么顺序执行（我已经[读过](http://www.slideshare.net/clutchski/writing-asynchronous-javascript-101)它遵循堆栈，所以选项 2 将是答案）？

**选项1**

1.  采取输入（）；
2.  进程输入（）；
3.  输出输入（）;

**选项#2**

1.  输出输入（）;
2.  进程输入（）；
3.  采取输入（）；

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-02-28T16:51:40.347

JavaScript 函数**不是**异步的。一些非常有限的函数集具有异步 API：

`addEventListener`, `setTimeout`, `setInterval`. 这些是仅有的 3 个（我认为这非常令人惊讶）。

它们允许您传入最终*可能会被调用的回调。*例如，当计时器到期时，或者当用户点击某物时，或者当 AJAX 请求完成时。

JavaScript 有一个事件循环。事件循环会在每个事件进入时对其进行处理。如果您单击按钮 3 次，然后计时器到期，这也是处理事件的顺序。这一切都非常明确和确定。

此外，JavaScript 没有线程，它完全运行一个事件，直到在开始下一个事件之前没有任何事情要做（你返回）。所以事件永远不会以任何方式干扰。这使您可以对数据的状态做出非常强有力的假设。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-02-28T16:53:31.253

> JavaScript 函数是异步的吗？

有些是，大多数不是。

> 他们将按什么顺序执行

它们将按照它们被调用的顺序执行。因为它们都是从同一个函数中调用的，所以这将是一个简单的线性顺序。

如果它们中的任何一个是以异步方式编写的，那么它们可能不会以相同的顺序完成所有活动。例如：[_](http://jsbin.com/anakak/1/edit)

```
function a() {
   console.log('a'); 
}
function b() {
   console.log('b'); 
}
function c() {
   console.log('c'); 
}
function aAsync() {
  setTimeout(a, 500); 
}

function load() {
   aAsync();
   b();
   c();
}
load(); 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-10-20T19:43:42.970

Javascript 不是**异步**的。
它同步工作，即一次运行一行代码。当 javascript 代码运行时，首先创建一个**全局执行上下文**，如果您从全局执行上下文调用一个函数，另一个执行上下文由 javascript 引擎创建并放置在执行堆栈的顶部（全局执行上下文已经在堆栈中）并且如果从该函数内部调用另一个函数，则会创建另一个执行上下文并且堆栈大小不断增加。

因此，javascript 引擎一次一行地运行此代码，并且在该过程中，如果有任何事件/ http 请求触发，浏览器会将它们放在**EVENT QUEUE**中。所以，关键是javascript引擎不会处理队列中的事件，直到执行堆栈为空。当引擎完成执行堆栈时，它会定期查看队列中是否有当前事件的任何事件处理程序，并类似地为该处理程序创建执行上下文并运行其中的代码。因此，整个过程只是同步的，异步只是由浏览器的其他部分（渲染引擎或 http 引擎）处理，而 javascript 引擎继续同步运行代码。

因此，在您的情况下，无论从哪个上下文函数**loadpage**被调用，它的执行上下文都会被创建并放置在堆栈的顶部。然后，它调用**takeinput**函数，它的 exec。context 被创建，并且其他函数 context 不会被创建并放入堆栈中，直到从执行堆栈中弹出 takeinput 上下文。因此，正确的顺序将是 takeinput、processinput 和 outputinput。

我希望它能回答你的问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-28T16:53:46.270

JavaScript 通常不是异步的，但它确实具有异步和事件驱动的方法。

Ajax 调用是主要的异步方法。

对于事件，我不确定您是否可以保证执行顺序，但我可能错了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-28T16:55:18.630

Javascript 是一个单线程的野兽，所以严格来说，任务并不是像人们想象的那样是异步的，因为它会产生子线程来执行代码。提供这种机制的机制会产生异步的错觉，但它仍然是单线程的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-28T16:52:11.090

不，不是默认/标准，尽管有*异步*方法。jQuery 更多地利用了异步行为。但在每种情况下，它都是主观的，不能说“所有的 JavaScript 都是*这个*或*那个*”。

方法总是按照它们被调用的顺序执行；它们的异步性意味着任何一个都可以在另一个之前完成，即使是在之后调用。

# c - 如何解决“未定义的函数引用”错误？

> ID：15141122
> 
> 赞同：4
> 
> 时间：2013-02-28T16:50:57.507
> 
> 标签：c, gcc, undefined-reference

我必须为学校项目建立一个图书馆，并在一个小应用程序中使用该图书馆。现在，我制作了 XPM_lib.h 和 XPM_lib.c 文件以及我的 test.c 文件。但是当我尝试编译我的 test.c 文件时，我得到一个“未定义的 initXPM_image 引用”错误。

我的文件是（XPM_lib.h）：

```
#ifndef LIBRARYXPM_H_INCLUDED
#define LIBRARYXPM_H_INCLUDED

#include<stdio.h>
#include<stdlib.h>
#include<malloc.h>
#define HEADER "/*XPM*/"
#define STRING_BEGIN "static char *egc[] = {\n\n /*width ,  height , ncolors ,        charsperpixel */ \n "
#define STRING_END "\n }"
#define STRING_SEPARATOR ","
#define STRING_COLORS "/* colors #RRGGBB */"
#define STRING_PIXELS "/* pixels */"

struct Color{

        unsigned char r,g,b;
        char *color_char;
        char key[2];
};   

struct XPM_image {

        unsigned int width;
        unsigned int height;
        unsigned int no_colors; // number of colors used

        unsigned char char_per_pixel; // number of characters to describe a pixel

        struct Color *color_table; // table containing the colors
        unsigned int **image_data; // contains indices from color_table

} ;

// functions first problem , lab 1

extern void initXPM_image (struct XPM_image *image, unsigned int width, unsigned int      height, unsigned char char_per_pixel, unsigned int no_colors );

extern void freeXPM_image (struct XPM_image *image);

extern void setXPMpixel (struct XPM_image *image, unsigned int poz_x, unsigned int poz_y, unsigned int index );

extern void setXPMcolor (struct XPM_image *image, unsigned int index, unsigned char r, unsigned char g, unsigned char b, char *pattern);

extern void writeToFile (struct XPM_image *image , char *pathname);

#endif // LIBRARYXPM_H_INCLUDED 
```

和 (XPM_lib.c) ：

```
 #include "XPM_lib.h"

// initializeaza spatiul pentru imagine si tabela de culori si seteaza proprietatiile de baza
void initXPM_image (struct XPM_image *image, unsigned int width, unsigned int height, unsigned char char_per_pixel, unsigned int no_colors )
{
    image->width = width;
    image->height = height;
    image->char_per_pixel = char_per_pixel;
    image->no_colors = no_colors;

    if ( ( image->color_table =(struct Color*) malloc ( image->no_colors * sizeof(struct Color)) == NULL ))
        {
            printf("Eroare in initXPM_image la alocarea color_table");
            exit (0);

        }

    if ( ( image->image_data = (unsigned int **) malloc (height * sizeof(unsigned int *))) == NULL )
    {

        printf("Eroare in initXPM_image la alocarea image_data (height)");
        exit (0);

    }

    int i;
    for (  i = 0 ; i < height ; i++ )
    {
        if ( (image->image_data[i] = (unsigned int *) malloc (width * sizeof (unsigned int ))) == NULL )
        {
            printf( "Eroare in initXPM_image la alocarea image_data (width)");
            exit (0);
        }

    }

}

void setXPMcolor (struct XPM_image *image, unsigned int index, unsigned char r, unsigned char g, unsigned char b, char *pattern)
{

    image->color_table[index].r = r;
    image->color_table[index].g = g;
    image->color_table[index].b = b;

    image->color_table[index].color_char = pattern;

}

void setXPMpixel (struct XPM_image *image, unsigned int poz_x, unsigned int poz_y, unsigned int index )
{

    image->image_data[poz_x][poz_y] = index; // pun index-ul culorii din tabela de culori din imagine

}

void writeToFile (struct XPM_image *image , char *pathname)
{

    FILE *f;

    if (( f = fopen(pathname,"wt")) == NULL)
    {
        printf("Eroare la deschiderea fisierului!");
        exit(0);

    }

    fprintf( f ,"%s\n%s",  HEADER , STRING_BEGIN);

    fprintf( f , "\" %d %d %d %d\"", image->width, image->height , image->no_colors , image->char_per_pixel);

    // colors
    fprintf( f, "%s \n" , STRING_COLORS);
    int i;
    for ( i = 0 ; i < image->no_colors ; i++ )
        {
            printf("\"%s c #%.02X%.02X%.02X\",\n" , image->color_table[i].color_char , image->color_table[i].r , image->color_table[i].g , image->color_table[i].b);
        }

} 
```

test.c 文件是：

```
#include "lib/XPM_lib.h"

#define WIDTH 50
#define HEIGHT 50
#define COLORS 50

int main ()
{

    char first_char = 'a';
    struct XPM_image *image;

    if ((image = (struct XPM_image*) malloc (sizeof(struct XPM_image))) == NULL )
    {
        printf("Eroare la alocarea XPM_image\n");
        exit(0);

    }

    initXPM_image (image, WIDTH, HEIGHT,1, COLORS);

    int i,j;
    for (  i = 0 ; i < COLORS; i++ )
    {
        setXPMcolor(image, i, 255*i/(COLORS-1),0,0,&first_char);
        first_char++;
    }

    for ( i = 0 ; i < WIDTH ; i++ )
        for ( j = 0 ; j < HEIGHT ; j++ )
            setXPMpixel(image,i,j,i);

    writeToFile(image,"imagine.xpm");
    return 0;

} 
```

现在，我不能使用 IDE 来为此设置一个项目，所以我必须使用 gcc 手动编译它。为了编译，我做了：

```
gcc -c .\lib\XPM_lib.c
gcc -c test.c
gcc -o program .\lib\XPM_lib.o test.o 
```

（我忘了提！）我的目录结构：

```
.\lib\XPM_lib.h 
.\lib\XPM_lib.c
.\test.c 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-28T16:58:52.583

您需要确保 gcc 可以“看到”所有必需的头文件以确保正确编译。为此，您应该`lib`在构建时将目录包含到您的路径中：

```
gcc -I ./lib -c XPM_lib.c test.c
gcc -o program XPM_lib.o test.o 
```

笔记：

“未定义对...的引用”意味着即使您包含了头文件，但您没有告诉编译器链接到库。这些不是“未声明的”，而是“未定义的”。这就是它找不到符号的原因。

# jquery - 结合 Jquery 语句

> ID：15141123
> 
> 赞同：1
> 
> 时间：2013-02-28T16:50:58.577
> 
> 标签：jquery

我想知道是否有人可以帮助我！

我的网站上有两个单独的 jQuery 语句，它们基本上作用于一个 div，当单击该 div 时，将展开一个内容区域，该区域被屏幕右侧的负边距隐藏。

我想做的是在每个页面上都有几个这样的元素，但我想要尽可能简化的东西，我不必继续为每个元素添加全新的语句！

这是相关网站的链接（元素在右侧 - 一个带有加号，另一个带有 Twitter 图标）

[沙洲地产](http://www.sandbanksproperty.co.uk/)

下面是我的代码：

//设置函数：

```
function extraOn() {
var w = $('.homeplus-expanded').width();
$('.homeplus-expanded').animate ({
    right : '0',
    'margin-right':'0px'
    }, 'fast');
}

function extraOff() {
var ws = $('.homeplus-expanded').innerWidth();
$('.homeplus-expanded').animate({
    right : '0',
    'margin-right':-ws
    },'fast'); 
}

function shareOn() {
var w = $('.homeplus-expanded').width();
$('.shareplus-expanded').animate ({
    right : '0',
    'margin-right':'0px'
    }, 'fast');
}

function shareOff() {
var sp = $('.shareplus-expanded').innerWidth();
$('.shareplus-expanded').animate({
    right : '0',
    'margin-right':-sp
    },'fast'); 
} 
```

//然后在点击时调用这些函数：

```
$('.homeplus').click(function(){
extraOn();
});

$('.homeplus-expanded span.close').click(function(){
extraOff();
    });

$('.shareplus').click(function(){
shareOn();
});

$('.shareplus-expanded span.close').click(function(){
shareOff();
    }); 
```

正如你所看到的，我确信有一些交叉和一些空间可以使代码更整洁和更模块化......

感谢您的任何帮助，您可以提供...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T16:56:41.750

使用使用选择器的单个函数`$(this)`，并从`click`事件处理程序中调用它。所以例如：

```
function turnOn() {
  var w = $(this).width();
  $(this).animate ({
    right : '0',
   'margin-right':'0px'
  }, 'fast');
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T16:57:59.750

您可以将已单击元素的引用传递到“extraOn”和其他功能上，然后将此引用用作jquery选择器

```
// Call it like this 
extraOn(this);

function extraOn(elem) {
  var w = $(elem).width(); // No idea what this is for
  $(elem).animate ({
    right : '0',
    'margin-right':'0px'
    }, 'fast');
  }
} 
```

或者您可以使用 extraOn 函数内容作为实际回调，这样您也可以使用事件，如下所示：

```
$('.homeplus').click(function (ev) {
  ev.preventDefault(); // if it is a <a> element or has some other default behaviour
  var w = $(this).width(); // No idea what this is for
  $(this).animate ({
    right : '0',
    'margin-right':'0px'
    }, 'fast');
  }
}); 
```

如果您希望通过 ajax 加载这些元素，您可能更喜欢使用延迟事件处理程序：

```
$(document).on('click','.homeplus',function (ev) {
  ev.preventDefault(); // if it is a <a> element or has some other default behaviour
  var w = $(this).width(); // No idea what this is for
  $(this).animate ({
    right : '0',
    'margin-right':'0px'
    }, 'fast');
  }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T17:08:47.000

您应该重构您的重复代码并将其移动到功能。然后将相应的处理程序传递给函数以绑定点击事件。由于绑定的点击事件函数在函数范围内，所以对点击事件可见。尝试对您的代码进行更多重构:)。代码重构很有趣，重构后的代码可以重用且易于维护。

简化版如下。

```
function InitContentZone(turnOnElement, turnOffElement, expandElement)
{
    var expandEle = expandElement;
    function extraOn() {
        $(expandEle).animate ({
            right : '0',
            'margin-right':'0px'
        }, 'fast');
    }

    function extraOff() {
        var ws = $(expandEle).innerWidth();
        $(expandEle).animate ({
            right : '0',
            'margin-right':-ws
        }, 'fast');
    }

    $(turnOnElement).click(extraOn);
    $(turnOffElement).click(extraOff);
}

$(document).ready(function()
{
    InitContentZone('.homeplus', '.homeplus-expanded span.close', '.homeplus-expanded');
    InitContentZone('.shareplus', '.shareplus-expanded span.close', '.shareplus-expanded');
}); 
```

# asp.net - 强制 Windows 身份验证 IID

> ID：15141132
> 
> 赞同：1
> 
> 时间：2013-02-28T16:51:28.287
> 
> 标签：asp.net, security

我遇到了 ASP.net 应用程序的身份验证问题。这是有效的，现在由于某种原因已经停止。我有一个连接到 SQL 数据库以进行简单数据输入的 Web 表单。我正在尝试在后台捕获用户名和时间以包含在条目中。我在 web.config 文件中有以下代码：

```
<authentication mode="Windows"/> 
```

这是在 system.web 分组中。

我在 Web 表单的 .cs 文件中设置了以下例程：

```
protected void btnUpdate_Click(object sender, EventArgs e)
{

    using (SqlConnection con = new SqlConnection("server=(local);database=InvoiceSHC;Trusted_Connection=Yes"))
    {

        // Get the UserId of the logged in user 

        string UserName = "";
        if (HttpContext.Current.User.Identity.IsAuthenticated)
       {
           UserName = HttpContext.Current.User.Identity.Name.ToString();
       }
        else
       {
           UserName = "UnauthenticatedUser";
       } 

        string Timestamp = DateTime.Now.ToString();
        //Not sure why you need a SqlDataAdapter unused here.
        //SqlDataAdapter DA = new SqlDataAdapter("UpdateSHCInvoice", con);
        SqlCommand cmd = new SqlCommand("UpdateSHCInvoice", con);
        cmd.CommandType = CommandType.StoredProcedure;

        cmd.Parameters.AddWithValue("@Ref", dlRef.SelectedItem.Value);
        cmd.Parameters.AddWithValue("@PhaseName", dlPhase.SelectedItem.Value);
        cmd.Parameters.AddWithValue("@PageType", dlPageType.SelectedItem.Value);
        cmd.Parameters.AddWithValue("@Page", tbPage.Text);
        cmd.Parameters.AddWithValue("@Percent", dlPercent.SelectedItem.Value);
        cmd.Parameters.AddWithValue("@ChngType", dlChngType.SelectedItem.Value);
        cmd.Parameters.AddWithValue("@UserName", UserName);
        cmd.Parameters.AddWithValue("@Timestamp",Timestamp);
        con.Open();
        cmd.ExecuteNonQuery();

        GridView1.DataBind(); 
```

在 IIS 中，我禁用了匿名身份验证。我已启用 asp.net 模拟和 Windows 身份验证。

当我第一次设置它时，我正在为用户获取一个域和 id。现在，当我访问该站点时，不会提示我输入用户名和密码。这种身份验证的东西真的很痛苦。

我使用 Firefox 作为浏览器。我也在 Safari 上尝试过，结果相同。

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T17:25:19.977

您是否在 web.config 文件中添加了授权部分？

```
<system.web>
    <authorization>
        <allow users="*" />
        <deny users="?" />
    </authorization>
</system.web> 
```

它的作用是告诉 Web 服务器您希望在根级别允许任何经过身份验证的用户 ( `users="*"`) 并拒绝任何匿名用户 ( `users="?"`)，然后在整个站点中进行。

如果您需要对不同的页面或文件夹进行不同的授权设置，您可以使用该`location`元素：

```
<configuration>
    <location path="members">
        <system.web>
            <authorization>
                <allow users="*" />
                <deny users="?" />
            </authorization>
        </system.web>
    </location>
    <location path="AnonymousPage.aspx">
        <system.web>
            <authorization>
                <allow users="?" />
            </authorization>
        </system.web>
    </location>
</configuration> 
```

这可以添加到您的根 web.config 文件中，也可以按照与第一个示例相同的方式添加到所需文件夹内的 web.config 文件中。

# xml - XML Schema 解析 [新手]

> ID：15141133
> 
> 赞同：0
> 
> 时间：2013-02-28T16:51:27.890
> 
> 标签：xml, xsd

```
<log sessions="5" complete="5" timeouts="5" incomplete="5">
  <session>
    <event date="Fri Feb 1 05:31:18 GMT+0000 2013">LANDING_PAGE_CLICK</event>
    <event date="Fri Feb 1 05:31:39 GMT+0000 2013">TIMEOUT</event>
  </session>
</log> 
```

我有上面的 XML。我将如何提取日期和“事件”节点？这是我第一次写 XSD 我遇到了这个：

```
var dateString : String = response.status.@date;
var date : Date = DateFormatter.parseDateString (dateString); 
```

但不知道这甚至如何适合 XSD。

帮助将不胜感激。

谢谢，詹姆斯。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T17:30:20.150

```
<xs:attribute name="lang" type="xs:string"/> 
```

以上是用于解决此问题的代码。

编辑：我必须下班赶回家，但这里记录了 [http://www.w3schools.com/schema/schema_simple_attributes.asp](http://www.w3schools.com/schema/schema_simple_attributes.asp)

# android - 安卓传感器控制游戏

> ID：15141134
> 
> 赞同：1
> 
> 时间：2013-02-28T16:51:28.880
> 
> 标签：android, accelerometer, sensors, android-sdk-2.1

我正在尝试设置我的 android 游戏以使用 android 传感器来控制游戏。

当手机稍微向前倾斜时，我希望推进器启动。

向左或向右倾斜手机可使其沿相应方向旋转。

目前，我正在使用 TYPE_ORIENTATION 如下：

```
public void onSensorChanged(SensorEvent event) {
        if(mMode == STATE_RUNNING) {    

            synchronized (mSurfaceHolder) {

                //rotation
                float pitch = event.values[2]; // pitch
                if(pitch <= 15 & pitch >= -15) {
                    mRotating = 0;
                } else if(pitch < -15) {
                    mRotating += 1;
                } else if(pitch > 15) {
                    mRotating -= 1;
                }

                //thrust by tilting forward!
                if(event.values[0] > 0) {
                    thrusterFiring = true;
                } else {
                    thrusterFiring = false;
                }
            }
        }
    } 
```

但我不确定这是否完全正确？此外，您必须将手机向前过滤一点，以便推进器发射 - 我想要它，所以您只需稍微倾斜一下！

任何帮助表示赞赏！

# j - 在 J 中查找可被 x 和 y 整除的整数

> ID：15141135
> 
> 赞同：0
> 
> 时间：2013-02-28T16:51:29.470
> 
> 标签：j, tacit-programming

编写我的第一个 J 程序来求解[欧拉问题 #1](http://projecteuler.net/problem=1)（找到所有低于 1000 且是 3 或 5 的倍数的自然数之和），我得到了以下解决方案：

```
+/(+./0=3 5|/n)#n=.i.1000 
```

但是，我很确定有一种巧妙的方法可以做到这一点，而无需使用变量。我尝试使用 fork 重写它，但我不知道如何将 () 之间的表达式替换为应用于`3 5`and的动词`i.1000`。有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T20:22:56.723

为了参数化这两个值，从而泛化为二元动词，我们需要将每个参数传递到需要它们的地方。从这个分叉开始，我们可以专注于`3 5`实际需要的唯一点：

```
 3 5 ([ |/ i.@]) 1000 
```

在整个程序中，我们需要两个地方的整数列表。名称 ( `n`) 为我们提供了在两个地方使用该列表的简单方法。为了快速完成整个程序，在写这篇文章时，我最初计算了两次列表：

```
 3 5 ([: +/ i.@] # [:+./ 0= [ |/ i.@]) 1000 
```

`i.`这成功地将整个程序表述为二元动词，但出现两次也有缺点。我们可以通过将其设为正确的叉齿，将其提取为仅发生一次。那个叉子的中心是一个新的、内在的动词。

```
 3 5 ([: +/ [ (] # [:+./ 0= [ |/ ]) i.@]) 1000
NB.              ___________________             new "inner" verb, parenthesized 
```

这个内在动词需要接收`3 5`作为参数，所以我通过最外层动词的左参数作为这个内在动词的左参数。这意味着内部动词中的 Left ( `[`) 与之前版本中的值相同，当它引用最外层参数时。在这个新动词中 Right ( `]`) 指的是整数列表，`i.@]`出现在之前出现的两个地方。

后记：正如您在评论中显示的那样，`[ |/ ]`简化为`|/`

# mfc - 带有 tabControl 的 MFC 界面

> ID：15141144
> 
> 赞同：0
> 
> 时间：2013-02-28T16:51:51.333
> 
> 标签：mfc

我有一个带有不同控件的窗口和一个包含一些 TabPage 的 TabControl。每个 TabPage 都与一个类相关联。此类的代码必须能够作用于主窗口的控件。

我尝试在 TabPage 类中创建指向主窗口的指针和关联的 set 方法，但我无法创建主窗口的元素类型。

我应该怎么做？

> 类 CMedialexieDlg：公共 CDialogEx { 公共：

```
CTabCtrl        m_TabControl; /*!< TabControl de la fenetre */
TabPage1        tabPage1; /*!< Onglet des contacts */
TabPage2        tabPage2; /*!< Onglet des groupes */
TabPage3        tabPage3; /*!< Onglet des ventes */
CTreeCtrl       m_TreeControlContact; /*!< TreeControl regroupant les differents contacts */
CTreeCtrl   m_TreeControlGroupe; /*!< TreeControl regroupant les differents groupes et contacts */ 
```

... }

在类 TabPage1

> 无效 TabPage1::OnClickedTbp1ButtonAnuler() { m_TreeControlGroupe.EnableWindows(false); }

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T17:45:30.633

首先，你真的应该展示一些代码来展示你试图做什么，而不是（糟糕地）向我们描述它并让我们猜测。

话虽如此，你为什么不能`AfxGetMainWnd()`用来获取指向主窗口的指针？

需要注意的一件事：您应该小心，因为直接操作其他窗口可能会导致难以追踪的细微问题/错误；如果您稍后尝试使您的应用程序多线程，它也可能会导致头痛。您应该更喜欢交换消息。

# linux - lib/lib64 文件夹在 red hat linux 中重命名。无论如何要修复它？

> ID：15141146
> 
> 赞同：0
> 
> 时间：2013-02-28T16:52:04.477
> 
> 标签：linux, redhat

我们有一个基于 linux 的服务器，并且 lib/lib64 文件夹被重命名（lib64 -> lib 和 lib -> lib2）。做这件事的人已经知道它有多愚蠢，但这对我们其他人来说真的搞砸了，因为现在我们不能使用任何功能，或者以 root 身份登录来解决问题。

有任何想法吗？我们希望我们可以从 red hat 安装 cd/DVD/usb 启动，并从那里运行我们需要的命令，而不会覆盖已经安装的实际操作系统（将它恢复到我们需要相当长的时间现在）但我不知道在我们目前的情况下是否可能。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-08-25T03:13:51.703

```
export LD_LIBRARY_PATH=/lib
/lib/ld-linux-x86-64.so.2 /bin/mv /lib /lib3
/lib/ld-linux-x86-64.so.2 /bin/mv /lib /lib64
mv /lib3 /lib 
```

主要问题是 mv 不能工作，因为它找不到加载器，但是如果你知道它的路径，你可以直接运行加载器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T16:53:49.097

是的，这绝对是一种方法。从安装盘启动并选择救援模式。然后挂载系统的根文件系统并将文件夹放回去。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T16:55:59.193

从任何 Linux 发行版的 Live CD/DVD 或闪存驱动器启动，然后打开文件管理器。从那里您可以单击以安装内部驱动器，导航到正确的文件夹并重命名它们。

这是Linux，像这样的简单错误没什么好兴奋的，只要放松一下，它就会解决的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-16T13:54:19.917

如果您的系统上有busybox：

```
busybox mv /lib /lib64
busybox mv /lib2 /lib 
```

我遇到了同样的问题，但是将文件夹重命名为busybox`/lib64`并`/lib`使用busybox救了我。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-04-20T12:32:38.103

您仍然可以`mv`通过以下方式调用该命令：

```
/lib64/ld-linux-x86-64.so.2 --library-path /lib64.bak /bin/mv /lib /lib64
/lib64/ld-linux-x86-64.so.2 --library-path /lib64.bak /bin/mv /lib2 /lib 
```

# jquery - 如何用 Javascript 解析字符串看起来像对象

> ID：15141147
> 
> 赞同：-3
> 
> 时间：2013-02-28T16:52:08.707
> 
> 标签：jquery, json, salesforce

我得到一个这样的字符串。
我做了 type of ，我把它当作**string**。
字符串非常大，所以我发布了它的一部分。

```
[System.SelectOption[value="account__c", label="Account", disabled="false"], System.SelectOption[value="account_owner__c", label="Account Owner", disabled="false"], System.SelectOption[value="accountname__c", label="Business Name", disabled="false"]] 
```

我需要的是一个 Json 或它的数组。请帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T17:42:44.710

这是你想要的？
此代码实质上将字符串转换为键值对数组。

JSFiddle 链接：http: [//jsfiddle.net/Dap6C/2/](http://jsfiddle.net/Dap6C/2/)

```
var x = '[System.SelectOption[value="account__c", label="Account", disabled="false"], System.SelectOption[value="account_owner__c", label="Account Owner", disabled="false"], System.SelectOption[value="accountname__c", label="Business Name", disabled="false"]]';

x = x.substring(0, x.length - 1).substring(1, x.length).replace(/System.SelectOption/g,"");
var xp = x.substring(0, x.length - 1).substring(1, x.length).replace(/, /g,",");
var y = xp.split('],[');

var mainarray = [];
for(var i=0;i<y.length;i++){
 var z = y[i].split(',');
    var elements = [];
    for(var j=0;j<z.length;j++){
        var m = z[j] ;
        m =m.split('=');
        elements[m[0]] = m[1];
    }
    mainarray.push(elements);
}

var samplelement = mainarray[0];
document.write("<b>Sample output saved as key-value pairs = </b><br/>"+ "<b>value is </b> " + samplelement.value +  "<b>and label is </b> "+ samplelement.label + ' '); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-06-23T12:04:33.863

我知道这是旧的，我猜你已经解决了你的问题，但我只需要做类似的事情并给出这个 HTML 和 jQuery（只是因为）：

```
<p><strong>Raw SF SelectOption data:</strong></p>
<div id="sfData"></div>
<p><strong>SF data converted to string with an array of objects using Regex:</strong></p>
<div id="sfDataToStr"></div>
<p><strong>SF data converted to proper array of Objects:</strong></p>
<div id="strToObj"></div> 
```

而这个JavaScript：

```
var sfData = 
    '[System.SelectOption[value="-- None --", label="-- None --", disabled="false"],' + 
    ' System.SelectOption[value="Special 1", label="Special 1", disabled="false"],' + 
    ' System.SelectOption[value="Special 2", label="Special 2", disabled="false"],' + 
    ' System.SelectOption[value="Special 3", label="Special 3", disabled="false"]]';
$(function(){
    $("#sfData").
        append(sfData).
        prepend($("<p></p>", {
            "text": "TYPE: " + typeof sfData}));
    var sfDataToStr = sfData.
        replace(/System.SelectOption\[(\w+)=/g, "{\"$1\":").
        replace(/\],\s?/g, "},").
        replace(/\",\s?(\w+)=/g, "\",\"$1\":").
        replace(/\]\]/g, "}]");
    $("#sfDataToStr").
        append(sfDataToStr).
        prepend($("<p></p>", {
            "text": "TYPE: " + typeof sfDataToStr}));
    var strToObj = JSON.parse(sfDataToStr);
    $("#strToObj").
        append(JSON.stringify(strToObj)).
        prepend($("<p></p>", {
            "text": "TYPE: " + typeof strToObj}));
}); 
```

我设法以我乐于使用的形式获取数据。

我猜您是在呼应一组 SalesForce SelectOption 对象并希望在 JavaScript 中使用它们？我不确定 SalesForce 是否有一种本机方式来回显正确的 JSON，但这种方法适用于我的目的......希望它有所帮助。

工作 JSFiddle 链接：http: [//jsfiddle.net/annoyingmouse/02668Ld4/](http://jsfiddle.net/annoyingmouse/02668Ld4/)

# c# - 在表 OpenXML C# 中格式化字体

> ID：15141157
> 
> 赞同：1
> 
> 时间：2013-02-28T16:52:37.533
> 
> 标签：c#, openxml

我想使用 OpenXML WordProcessing 制作表格。我想格式化单元格内的字体。这是我的代码

```
MainDocumentPart mainDocumentPart = doc.AddMainDocumentPart();
mainDocumentPart.Document = new Document();
Body body = mainDocumentPart.Document.AppendChild(new Body());

RunProperties runHeader = new RunProperties();
RunFonts runFont = new RunFonts();
runFont.Ascii = "Lucida Sans";
runHeader.Append(runFont);                    
runHeader.Append(new Bold());
runHeader.Append(new FontSize() { Val = "16" }); 

//// Create a new table
Table tbl = new Table();

tr = new TableRow();
tc = new TableCell();

Paragraph paraHeader = new Paragraph();
Text heading_text = new Text("Company Name");
runHeader.Append(heading_text);
paraHeader.Append(runHeader);
tc.Append(paraHeader);
tr.Append(tc);
tbl.Append(tr);

body.AppendChild(tbl); 
```

但是当我打开 Microsoft Word 时，我得到了错误。它说该文件的内容有问题

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T17:31:19.813

您正在将文本附加到运行属性，它需要附加到运行。尝试：

```
Text heading_text = new Text("Company Name");

////create the run
Run runHeaderRun = new Run();

////append the run properties and text to the run
runHeaderRun.Append(runHeader);
runHeaderRun.Append(heading_text);

////append the run to the paragraph
paraHeader.Append(runHeaderRun);

tc.Append(paraHeader); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-08-26T08:35:05.947

```
RunProperties rp = new RunProperties();
RunFonts runFont = new RunFonts() { Ascii = "Calibri Light" };
rp.Append(runFont);
rp.Append(new Color() { Val = "#2E74B5" });

body.Append(new DocumentFormat.OpenXml.Wordprocessing.Paragraph(new Run(rp, new Text("3\. Risk Assessment")))); 
```

使用起来非常简单，试试这个。

# vba - 拆分主题行以导出到 Excel 中的单独列

> ID：15141158
> 
> 赞同：1
> 
> 时间：2013-02-28T16:52:42.633
> 
> 标签：vba, outlook, export-to-excel

我有将电子邮件主题从我选择的文件夹导出到 Excel 工作簿的代码。我需要将主题中第一个“空格”之后的文本导出到另一列（最好是 C 列）。以下是主题行的几个示例：

> “ 321-654321 已批准 后面还有更多话要说”

和

> “ APR#987-123456 CONTIGENT 后面有更多文字”

我希望将主题中第一个空格之前的数字（或）所有内容放在一个列中，并将数字之后的所有内容（第一个空格）放在不同的列中。

这是我想要的输出示例

> A 列 - B 列 - C 列
> 
> XXX-XXXXX - DateOf Email - 事件状态

这是我目前正在使用的代码，我相信我在 Stackoverflow 上找到了这个宏。另外，我不能跳过让用户选择文件夹并将我希望这个宏在代码中起作用的文件夹吗？

```
 Sub ExportToExcel()

    On Error GoTo ErrHandler

    Dim appExcel As Excel.Application
    Dim wkb As Excel.Workbook
    Dim wks As Excel.Worksheet
    Dim rng As Excel.Range
    Dim strSheet As String
    Dim strPath As String
    Dim intRowCounter As Integer
    Dim intColumnCounter As Integer
    Dim msg As Outlook.MailItem
    Dim nms As Outlook.Namespace
    Dim fld As Outlook.MAPIFolder
    Dim itm As Object

    strSheet = "spreadhsheet.xlsx"
    strPath = "C:\MyOutlookMacro\"
    strSheet = strPath & strSheet

    Debug.Print strSheet
    'Select export folder
    Set nms = Application.GetNamespace("MAPI")
    Set fld = nms.PickFolder
    'Handle potential errors with Select Folder dialog box.
    If fld Is Nothing Then
        MsgBox "There are no mail messages to export", vbOKOnly, "Error"
        Exit Sub
    ElseIf fld.DefaultItemType <> olMailItem Then
        MsgBox "There are no mail messages to export", vbOKOnly, "Error"
        Exit Sub
    ElseIf fld.Items.Count = 0 Then
        MsgBox "There are no mail messages to export", vbOKOnly, "Error"
        Exit Sub
    End If
    'Open and activate Excel workbook.
    Set appExcel = CreateObject("Excel.Application")
    appExcel.Workbooks.Open (strSheet)
    Set wkb = appExcel.ActiveWorkbook
    Set wks = wkb.Sheets(1)
    wks.Activate
    appExcel.Application.Visible = True
    'Copy field items in mail folder.
    For Each itm In fld.Items
        intColumnCounter = 1
        Set msg = itm
        intRowCounter = intRowCounter + 3
        intColumnCounter = intColumnCounter + 1
        Set rng = wks.Cells(intRowCounter, intColumnCounter)
        rng.Value = msg.Subject
        intColumnCounter = intColumnCounter + 1
        Set rng = wks.Cells(intRowCounter, intColumnCounter)
        rng.Value = msg.SentOn
    Next itm

    Set appExcel = Nothing
    Set wkb = Nothing
    Set wks = Nothing
    Set rng = Nothing
    Set msg = Nothing
    Set nms = Nothing
    Set fld = Nothing
    Set itm = Nothing
    Exit Sub

    ErrHandler: If Err.Number = 1004 Then
        MsgBox strSheet & " doesn't exist", vbOKOnly, "Error"
    Else
        MsgBox Err.Number & "; Description: ", vbOKOnly, "Error"
    End If

    Set appExcel = Nothing
    Set wkb = Nothing
    Set wks = Nothing
    Set rng = Nothing
    Set msg = Nothing
    Set nms = Nothing
    Set fld = Nothing
    Set itm = Nothing
    End Sub

-------------------------------

Sub ExportToExcel()

    On Error GoTo ErrHandler

    Dim appExcel As Excel.Application
    Dim wkb As Excel.Workbook
    Dim wks As Excel.Worksheet
    Dim rng As Excel.Range
    Dim strSheet As String
    Dim strPath As String
    Dim intRowCounter As Integer
    Dim intColumnCounter As Integer
    Dim msg As Outlook.MailItem
    Dim nms As Outlook.NameSpace
    Dim fld As Outlook.MAPIFolder
    Dim itm As Object
    Dim Words As String

    strSheet = "spreadhsheet.xlsx"
    strPath = "C:\MyOutlookMacro\"
    strSheet = strPath & strSheet

    Debug.Print strSheet
    'Select export folder
    Set nms = Application.GetNamespace("MAPI")
    Set fld = nms.PickFolder
    'Set fld = Set fld = myNamespace.GetDefaultFolder(olFolderInbox).Folders("SpreadsheetItems")

  'Handle potential errors with Select Folder dialog box.
    If fld Is Nothing Then
        MsgBox "There are no mail messages to export", vbOKOnly, "Error"
        Exit Sub
    ElseIf fld.DefaultItemType <> olMailItem Then
        MsgBox "There are no mail messages to export", vbOKOnly, "Error"
        Exit Sub
    ElseIf fld.Items.Count = 0 Then
        MsgBox "There are no mail messages to export", vbOKOnly, "Error"
        Exit Sub
    End If

   'Open and activate Excel workbook.
    Set appExcel = CreateObject("Excel.Application")
    appExcel.Workbooks.Open (strSheet)
    Set wkb = appExcel.ActiveWorkbook
    Set wks = wkb.Sheets(1)
    wks.Activate
    appExcel.Application.Visible = True

   'Copy field items in mail folder.

For Each itm In fld.Items
    intColumnCounter = 1
    Set msg = itm

    Words = Split(msg.Subject, " ")

    intRowCounter = intRowCounter + 3

    intColumnCounter = intColumnCounter + 1
    Set rng = wks.Cells(intRowCounter, intColumnCounter)
    rng.Value = Words(0)

    intColumnCounter = intColumnCounter + 1
    Set rng = wks.Cells(intRowCounter, intColumnCounter)
    rng.Value = msg.SentOn

    intColumnCounter = intColumnCounter + 1
    Set rng = wks.Cells(intRowCounter, intColumnCounter)
    rng.Value = Words(2)

Next itm

    Set appExcel = Nothing
    Set wkb = Nothing
    Set wks = Nothing
    Set rng = Nothing
    Set msg = Nothing
    Set nms = Nothing
    Set fld = Nothing
    Set itm = Nothing
    Exit Sub

ErrHandler:     If Err.Number = 1004 Then
        MsgBox strSheet & " doesn't exist", vbOKOnly, "Error"
    Else
        MsgBox Err.Number & "; Description: ", vbOKOnly, "Error"
    End If

    Set appExcel = Nothing
    Set wkb = Nothing
    Set wks = Nothing
    Set rng = Nothing
    Set msg = Nothing
    Set nms = Nothing
    Set fld = Nothing
    Set itm = Nothing
    End Sub 
```

** 我收到“编译错误：预期的数组 @ rng.Value = Words(0) **

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T21:33:37.290

回复：拆分主题

使用拆分

```
Dim Words() As String ' not Dim Words as String

For Each itm In fld.Items
    intColumnCounter = 1
    Set msg = itm

    Words = Split(msg.Subject, " ")

    intRowCounter = intRowCounter + 3

    intColumnCounter = intColumnCounter + 1
    Set rng = wks.Cells(intRowCounter, intColumnCounter)
    rng.Value = Words(0)

    intColumnCounter = intColumnCounter + 1
    Set rng = wks.Cells(intRowCounter, intColumnCounter)
    rng.Value = msg.SentOn

    intColumnCounter = intColumnCounter + 1
    Set rng = wks.Cells(intRowCounter, intColumnCounter)
    rng.Value = Words(2)

Next itm 
```

回复：“......跳过让用户选择文件夹并放置我想要的文件夹......”

如果源文件夹位于默认收件箱中，则

设置 fld = myNamespace.GetDefaultFolder(olFolderInbox).Folders.("Source")

如果 Source 文件夹更深，则根据需要添加尽可能多的 .Folders("...") 。

如果源文件夹不在默认收件箱中，则 [获取对其他收件箱的引用](https://stackoverflow.com/questions/9076634/outlook-2007-vba-to-get-reference-to-additional-inbox)

# java - 有没有人尝试在 Guava 中创建不可变转发装饰器

> ID：15141159
> 
> 赞同：0
> 
> 时间：2013-02-28T16:52:46.237
> 
> 标签：java, collections, guava

我刚开始尝试装饰器。我还没有看到的一件事是不可变转发装饰器。我正在处理的示例代码在[这里](https://stackoverflow.com/q/15140195/532548)

似乎我可以为装饰器指定一个 ImmutableSet，但如果 ImmutableSet 是 ForwardingSet 的“委托”，则没有编译时警告。

我是否需要扩展 ForwardingSet 并创建 ForwardingImmutableSet 然后将其用作我的装饰器？

有没有人试过这个？

任何意见将是有益的。

使用上面提供的代码链接试试这个：

```
public void test1()
    {
        final ImmutableSet<String> stringsA = ImmutableSet.of("A1", "A2", "A3");

        final ISetA a = SetA.of(stringsA);

        a.add("A0");                // Run-time error
        stringsA.add("A0");     // Compile time warning, Run-time error
    } 
```

我只想查看“a.add("A0");”的编译时警告

当然我可以选择创建一个更受限制的接口，我可能只是从那里开始，但我想知道我是否必须做一个 ForwardingImmutableSet 我从哪里开始？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T18:06:47.207

如果您想对不可变集合上的突变方法发出警告，则必须通过将突变方法标记为`@Deprecated`转发装饰器来自己添加它们。

一般来说，Guava 不可变集合是故意不可子类化的，因此您不能`ImmutableSet`使用实际上不是不可变的实现进行子类化。

# cakephp - CakePHP DebugKit 是否具有对更改工具栏位置的内置支持？

> ID：15141164
> 
> 赞同：-1
> 
> 时间：2013-02-28T16:53:14.250
> 
> 标签：cakephp

我很喜欢使用 CakePHP 的 DebugKit 工具栏，但是有没有一种简单的方法可以将其位置从右上角更改到屏幕上的任何其他位置，而不必摆弄代码？

如果这个问题的答案就像从 top:0px 更改 CSS 一样简单；到底部：0px；对于#debug-toolkit-bar，我已经完成了，我一开始就不会问问题。答案肯定没有记录在 github 上的 9k readme.md 文件中，除非您指的是**Toolbar Configuration Settings**部分：

> 工具栏有一些配置设置。设置像普通组件配置一样在组件声明中传递。
> 
> public $components = array( 'DebugKit.Toolbar' => array(/* 设置数组 */) );

这就是关于“设置数组”的全部内容 - 没有太多帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T18:02:40.517

它没有对更改其位置的内置支持。

> **OP：**如果这个问题的答案就像从 top:0px 更改 CSS 一样简单；到底部：0px；对于#debug-toolkit-bar，我已经完成了，我一开始就不会问问题。

其实就是这么简单。要更改它的位置，只需查看 the`debug-kit-toolbar`和 the的 CSS 并将 s`panel-tabs`覆盖`float-left`到右侧，并将位置覆盖到左侧而不是右侧......等等 - 所有简单的 CSS 内容。

至于设置，您可以通过查看[Github 中 DebugKit 工具栏的代码](https://github.com/cakephp/debug_kit/blob/master/Controller/Component/ToolbarComponent.php)来查看任何/所有设置。

# ruby - 格式化数组以在 ruby 中显示多维数组中的每个替代项

> ID：15141171
> 
> 赞同：0
> 
> 时间：2013-02-28T16:53:28.967
> 
> 标签：ruby, arrays

这是我的数组

```
a = [["A", "B"], ["323", "32"]] 
```

现在我希望能够以它显示的方式格式化这个数组

```
A = 323
B = 32 
```

我该怎么做 ？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T16:58:29.300

您正在寻找`Array#transpose`，我相信：

```
> a = [["A", "B"], ["323", "32"]]
=> [["A", "B"], ["323", "32"]]
>> a.transpose
=> [["A", "323"], ["B", "32"]] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T18:34:44.497

```
(0...a.first.length).each{|i| puts "#{a[0][i]} = #{a[1][i]}"} 
```

# json - 发布 json.request 参数

> ID：15141172
> 
> 赞同：0
> 
> 时间：2013-02-28T16:53:29.813
> 
> 标签：json

我有一个项目（在线机票），在这个项目中我需要一个 Json 方法（或其他方法）来检查航班详细信息。我必须向 URL 发布请求，如下所示。(curl -XPOST -H "Content-Type: application/json" [http://testapi.xxx.com/rest/flightSearch/YOUR_CODE_HERE](http://testapi.xxx.com/rest/flightSearch/YOUR_CODE_HERE) -d @request.json) 如何将参数发布到 url 并获取回答是否有可用的航班？json格式如下。“fromAirport”：“ESB”，“toAirport”：“IST”，“fromDate”：“2013-02-01”，“adult”：1 }

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T17:00:27.460

这是一个例子：

```
function PostMyRequest(from, to, date, adult) {
         $(document).ready(function () {

             $.ajax({
                 url: 'http://testapi.xxx.com/rest/flightSearch/YOUR_CODE_HERE',
                 contentType: "application/json; charset=utf-8",
                 dataType: "json",
                 data: { 'fromAirport': from, 'toAirport': to, 'fromDate': date, 'adult': adult },
                 responseType: "json",
                 success: function(data){
                    alert( data );
                 error: OnFail  //call some function if you want
             });
             return false;
         })
     }; 
```

# jquery-ui - jQuery 手风琴 - 快速显示/隐藏

> ID：15141187
> 
> 赞同：1
> 
> 时间：2013-02-28T16:54:27.163
> 
> 标签：jquery-ui, jquery

我有一个包含搜索条件的手风琴页面。一旦有人单击搜索按钮，条件就会关闭（我模拟了对手风琴标题的单击）。这很好用。

问题是当用户提供无效输入时，我的 AJAX 调用返回并且我尝试在手风琴完成关闭之前再次显示搜索条件（再次模拟点击手风琴标题）。这当然无法打开搜索条件。

一个简单的例子是双击手风琴标题。如果在此双击期间手风琴处于过渡状态，则不会发生任何事情。

在我的情况下如何避免这种情况？注意：Chrome/FF 中的问题似乎比 IE 中的问题更大，因为 IE 不会为手风琴打开/折叠设置动画。

#section1 代表手风琴标题的代码中的基本思想：

```
$("#section1").click();
//some very fast AJAX.
$("#section1").click(); 
```

JS 小提琴：http: [//jsfiddle.net/mikeyfreake/gGaJn/2/](http://jsfiddle.net/mikeyfreake/gGaJn/2/)

谢谢，迈克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-17T16:23:40.180

呼吁`stop`手风琴的孩子们：

```
$("#accordion").children().stop(true, true); 
```

[http://jsfiddle.net/gGaJn/9/](http://jsfiddle.net/gGaJn/9/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-17T16:21:55.690

`async: false`在您的 Ajax 调用中使用参数。这将使 Ajax 调用在第二次单击之前完成执行。

[http://api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

或者您可以在`success`函数中执行第二次单击：

```
$.ajax({
    success: function (data) {
        $("#section1").click();
    },
   ...
}); 
```

# jquery - Jquery中的函数调用

> ID：15141189
> 
> 赞同：3
> 
> 时间：2013-02-28T16:54:33.267
> 
> 标签：jquery, function, call

我在一个调用函数的网站中看到了一个 jquery 函数调用，例如

```
var exampleFunction = function() {
    console.log ( " running " );
}

$(exampleFunction); 
```

它被称为 $(exampleFunction); 用这个可以吗？虽然它工作，但我还没有看到这种类型的编码风格。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-28T16:56:44.237

是的`$(function)`缩写`$(document).ready(function)`。so`exampleFunction`会在加载 dom 时调用

见[http://api.jquery.com/ready/](http://api.jquery.com/ready/)

# asp.net - 在 ASP.NET 中使用成员变量进行缓存时的并发问题

> ID：15141193
> 
> 赞同：1
> 
> 时间：2013-02-28T16:54:42.157
> 
> 标签：asp.net, vb.net, caching, concurrency, static

我正在使用静态成员来缓存一些数据，并且我*相信*在首次填充缓存数据时我遇到了某种并发问题。这个问题是零星的，似乎跟app pool的回收有关（虽然很多时候不会有问题）。

最初我的 _CachedData 成员为空。当调用 FindAll() 方法时，它将在 _CachedData 不为空时使用缓存的数据，否则它将从数据库中加载数据。每当对数据执行插入、更新或删除操作时，_CachedData 成员都会设置为 null，尽管在应用程序池回收后首次加载应用程序时绝不应该发生这种情况。

当我将 TestClass 对象添加到 _CachedData 的结果时，我得到的错误是对象引用错误。我只是不明白这是怎么可能的，因为我在进入 for each 循环之前对 _CachedData 执行了空检查。

```
Public Class TestClass

    Private Shared _CachedData As Collection(Of TestClass) = Nothing

    Sub New()

    End Sub

    Public Shared Function FindAll() As Collection(Of Content.TestClass)
        Dim result As New Collection(Of TestClass)()

        If _CachedData IsNot Nothing Then
            ' retrieve from cache
            For Each tc As TestClass In _CachedData
                result.Add(CType(tc.MemberwiseClone(), TestClass))
            Next
        Else
            result = GetFromDatabase()

            ' save to cache
            _CachedData = New Collection(Of TestClass)()
            SyncLock _CachedData
                ' make sure the cache wasn't populated while we were aquiring the lock
                If _CachedData.Count = 0 Then
                    For Each tc As TestClass In result
                        _CachedData.Add(CType(tc.MemberwiseClone(), TestClass))
                    Next
                End If
            End SyncLock
        End If

        Return result
    End Function 
```

法夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T17:42:58.127

对于初学者，您实际上不应该锁定对象本身，因为您将对该对象进行更改。您应该这样更新您的代码：

```
Private Shared _CachedData As Collection(Of TestClass) = Nothing
Private Shared ReadOnly _CachedDataLock As Object = New Object()

Public Shared Function FindAll() As Collection(Of Content.TestClass)
    Dim result As New Collection(Of TestClass)()

    If _CachedData IsNot Nothing Then
        ' retrieve from cache, using a local instance to avoid race-conditions
        Dim localCachedData As Collection(Of TestClass) = _CachedData
        For Each tc As TestClass In localCachedData 
            result.Add(CType(tc.MemberwiseClone(), TestClass))
        Next
    Else
        result = GetFromDatabase()

        ' save to cache
        SyncLock _CachedDataLock
            ' make sure the cache wasn't populated while we were aquiring the lock
            If _CachedData Is Nothing Then
                _CachedData = New Collection(Of TestClass)()
                For Each tc As TestClass In result
                    _CachedData.Add(CType(tc.MemberwiseClone(), TestClass))
                Next
            End If
        End SyncLock
    End If

    Return result
End Function 
```

# forms - Coldfusion 8 中的 MSXML2.ServerHTTP 无法发布数据

> ID：15141198
> 
> 赞同：2
> 
> 时间：2013-02-28T16:54:50.980
> 
> 标签：forms, com, coldfusion, serverxmlhttp

在尝试解决有缺陷的`<cfhttp>`SSL 实现时，我转而直接使用 COM 和 MSXML2.ServerHTTP。不幸的是，POST 数据未能到达目标页面。GET 工作，但我宁愿不使用它，因为我不知道是否记录了请求 url，如果我能提供帮助，我不想传递敏感数据。（我是不是太担心了？）

我的问题与此类似：http: [//objectmix.com/xml-soap/87408-sending-post-variables-using-msxml2-serverxmlhttp-3-0-a.html](http://objectmix.com/xml-soap/87408-sending-post-variables-using-msxml2-serverxmlhttp-3-0-a.html)

这是我的代码：

```
<cfset querystring = "?CustomerID=#CustomerID#&OrderDelRecipient=#OrderDelRecipient#&OrderCompany=#OrderCompany#&OrderTelephone=#OrderTelephone#&OrderNotes=#OrderNotes#&OrderDelStreet=#OrderDelStreet#&OrderDelCity=#OrderDelCity#&OrderDelState=#OrderDelState#&OrderDelZip=#OrderDelZip#">
<cfobject type="COM" action="Create" name="objSrvHTTP" class="MSXML2.ServerXMLHTTP.3.0">
    <cfset urlstring = "http://www.pascaltechnologies.com/saveorder.cfm">
<cfset temp = objSrvHTTP.open("post", urlstring, false)>
<cfset temp = objSrvHTTP.setRequestHeader("Content-Type", "application/x-www-form-
urlencoded")>
<cfset temp = objSrvHTTP.send("#querystring#")>
<cfset FileContent = objSrvHTTP.responsetext>
<cfoutput>
    #filecontent#
</cfoutput> 
```

**当我在被调用**页面（saveorder.cfm）上检查表单变量时

```
<cfif Not IsDefined("CustomerID") OR NOT IsNumeric(CustomerID)>
    ERR 609 - INVALID PARAMETERS PASSED.
    <cfabort>
</cfif> 
```

它们是空的，所以上面的代码被触发了。

这是因为我需要将响应复制到表单 var 吗？例如`<cfset FORM.CustomerID = objSrvHTTP.CustomerID>`（您认为它没有必要，因为 GET 不需要它。）或者我只是没有正确实现某些东西？

# ruby-on-rails - 当用户登录和 current_user 时在设计中渲染部分

> ID：15141200
> 
> 赞同：1
> 
> 时间：2013-02-28T16:54:54.013
> 
> 标签：ruby-on-rails, devise

我只想在有人登录并且当前用户正在设计时才呈现部分内容。如果我们正在检查 current_user 是否是页面查看，则检查用户是否登录可能是多余的。

例如：我以用户 1 的身份登录。我想在转到 /users/1 时显示一条消息，但在转到 /users/2 时不显示它。

反向也是如此：用户 2 应该能够转到 /users/1 并且看不到消息，但会在 /users/2 上

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T17:00:12.107

我会使用设计方法`current_user`。在您的控制器中，设置一个变量，您可以在视图中检查该变量，该变量说明该用户页面属于哪个用户。然后只需检查它是否与`current_user`.

例如，在您的用户控制器中：

```
@user = User.find(params[:id]) 
```

那么在你看来：

```
if (user_signed_in? && current_user == @user)
   ... render your partial 
```

# android - SlidingMenu Left and Right - 你能做出不同的尺寸吗？

> ID：15141201
> 
> 赞同：2
> 
> 时间：2013-02-28T16:54:55.583
> 
> 标签：android

我正在尝试设置双重`slidingmenus`（使用 jfeinstein10 流行的一种）。

我希望左侧滑出比右侧“更短”（它应该占据我应用程序屏幕的 95%）。通常我使用这个：

`sMenu.setBehindOffsetRes(R.dimen.slidingmenu_offset)`;

**简单的问题：**

但这为两者设置了大小。我可以分开做吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-05-29T10:55:13.260

***编辑：***

伙计们，我可以看到你仍然对这个答案投赞成票，但即使在 Navigation Drawer 发布后已经过时了。目前，您可以使用 Material Design 指南来执行此操作。让自己跟上潮流，不要偷懒。

**老一：**

实际上，您也可以使用[all_sides](https://github.com/jfeinstein10/SlidingMenu/tree/all-sides)分支来执行此操作。

用于设置在视图后面使用

```
getSlidingMenu().setMenu(resID, side) 
```

EG **BaseActivity** :

```
SlidingMenu sm = getSlidingMenu();
sm.setMenu(R.layout.menu_frame_two, SlidingMode.RIGHT);
sm.setShadowDrawable(R.drawable.shadowright, SlidingMode.RIGHT);
sm.setBehindWidthRes(R.dimen.slidingmenu_width_right, SlidingMode.RIGHT);
sm.setBehindWidthRes(R.dimen.slidingmenu_width_left, SlidingMode.LEFT);
sm.setMode(SlidingMode.LEFT_RIGHT); 
```

xml **/values/dimen.xml**：

```
<!-- SlidingMenu right width-->
<dimen name="slidingmenu_width_right">150dp</dimen>
<!-- SlidingMenu left width-->
<dimen name="slidingmenu_width_left">60dp</dimen> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-28T17:12:02.943

并非没有子类化他的滑动菜单。您也不能应用任何一方都不同的动画/变换。这是图书馆令人沮丧的限制。

# grails - 如何迭代groovy中的列表并为每个对象添加属性

> ID：15141202
> 
> 赞同：0
> 
> 时间：2013-02-28T16:54:56.473
> 
> 标签：grails, grails-orm

我有一个这样的事件列表：

事件 = Events.all

`Events`与模仿[spring-security-plugin 方法的](https://github.com/grails-plugins/grails-spring-security-core/blob/master/src/templates/PersonAuthority.groovy.template)`Users`via 类具有多对多关系：`UserEvents`

我想知道 a 是否`User`正在参加 an `Event`，我可以通过运行以下命令来做到这一点：

```
UserEvent.get(currentUserId, eventId) 
```

**问题**

如何对列表中的所有元素执行此操作，`events`以便在我的视图层中我可以轻松找出是否`currentUserId`参加活动？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T19:07:32.793

您可以像这样查询所有关联`User`的 s `Event`：

```
def user = ...
def events = UserEvent.findAllByUser(user).event 
```

这是一个相当有效的查询，因为它执行的 SQL 类似于

```
select * from user_event where user_id=? 
```

然后加载每个`Event`. 这是 N+1 ，因为它单独加载每个事件，因此您可以通过以下方式更有效地执行此操作：

```
def eventIds = UserEvent.findAllByUser(user).eventId
def events = Event.getAll(eventIds) 
```

第一行使用与上面相同的 SQL 获取事件 ID，然后第二行运行 SQL

```
select * from event where id in (?, ?, ?, ...) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T20:18:21.600

如果您只需要用户参加的活动的一个子集，那么就按照 Burt Beckwith 的建议去做。

但是，如果您需要整个事件集并且只添加一个属性，您应该使用 metaClass。

```
event.metaClass.userAttends= ... 
```

*[你可以在这里](http://groovy.codehaus.org/JN3525-MetaClasses)看到关于 metaClass 的解释*

具体来说，在您的情况下，我会像 Burt Beckwith 所说的那样获得所有 id，并检查每个事件的 id 是否在列表中：

```
def eventIds = UserEvent.findAllByUser(user).eventId
expandedEvents = events.collect {event-> 
   event.metaClass.usetAttends = eventIds.contains(event.id)
   return event} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T17:45:05.670

您可以使用[`grep()`](http://groovy.codehaus.org/groovy-jdk/java/util/Collection.html#grep%28java.lang.Object%29)是否`UserEvent.get()`返回项目来过滤事件列表。

```
events.grep { UserEvent.get(currentUserId, it.id) } 
```

# c# - WPF C# DynamicDataDisplay - 更改 DateTimeAxis 颜色

> ID：15141204
> 
> 赞同：2
> 
> 时间：2013-02-28T16:55:03.430
> 
> 标签：c#, wpf, charts, dynamic-data-display

我想知道如何更改 d3 海图仪的日期时间轴的颜色。

![在此处输入图像描述](../Images/0db747d79390f92555db55e8ad499dc1.png)

我要更改的颜色是两个条之间的棕色和白色背景色。

如果我这样做：

它只会改变第一个棕色条上方的东西。

![在此处输入图像描述](../Images/b4ceb3e21f1a9a1f0791f469ca3219ca.png)

是否可以更改这两个条的颜色？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-07T16:25:20.597

奇怪的是，我碰巧也在尝试做同样的事情。事实证明，这些颜色是硬编码的`MayorDateTimeLabelProvider.cs`（我在下面的评论中注意到了这些行）。如果您使用的是已编译的 DLL，则无法更改这些值。就个人而言，D3 是如此不成熟，以至于我保留了自己的构建并根据需要进行更改以扩展它（例如在这种情况下！）。

```
public override UIElement[] CreateLabels(ITicksInfo<DateTime> ticksInfo)
{
    object info = ticksInfo.Info;
    var ticks = ticksInfo.Ticks;
    UIElement[] res = new UIElement[ticks.Length - 1];
    int labelsNum = 3;

    if (info is DifferenceIn)
    {
        DifferenceIn diff = (DifferenceIn)info;
        DateFormat = GetDateFormat(diff);
    }
    else if (info is MayorLabelsInfo)
    {
        MayorLabelsInfo mInfo = (MayorLabelsInfo)info;
        DifferenceIn diff = (DifferenceIn)mInfo.Info;
        DateFormat = GetDateFormat(diff);
        labelsNum = mInfo.MayorLabelsCount + 1;

        //DebugVerify.Is(labelsNum < 100);
    }

    DebugVerify.Is(ticks.Length < 10);

    LabelTickInfo<DateTime> tickInfo = new LabelTickInfo<DateTime>();
    for (int i = 0; i < ticks.Length - 1; i++)
    {
        tickInfo.Info = info;
        tickInfo.Tick = ticks[i];

        string tickText = GetString(tickInfo);

        Grid grid = new Grid
        {
            Background = Brushes.Beige // **** HARD CODED HERE
        };
        Rectangle rect = new Rectangle
        {
            Stroke = Brushes.Peru,     // **** AND HERE
            StrokeThickness = 2
        };
        Grid.SetColumn(rect, 0);
        Grid.SetColumnSpan(rect, labelsNum);

        for (int j = 0; j < labelsNum; j++)
        {
            grid.ColumnDefinitions.Add(new ColumnDefinition());
        }

        grid.Children.Add(rect);

        for (int j = 0; j < labelsNum; j++)
        {
            var tb = new TextBlock
            {
                Text = tickText,
                HorizontalAlignment = HorizontalAlignment.Center,
                Margin = new Thickness(0, 3, 0, 3)
            };
            Grid.SetColumn(tb, j);
            grid.Children.Add(tb);
        }

        ApplyCustomView(tickInfo, grid);

        res[i] = grid;
    }

    return res;
} 
```

# c# - 动态添加到表单的按钮不会出现

> ID：15141205
> 
> 赞同：0
> 
> 时间：2013-02-28T16:55:03.940
> 
> 标签：c#, winforms, button

当我单击 时，我试图在我的表单上创建 4 个按钮`button1`，但这些按钮没有显示出来。为什么不？

```
private void button1_Click(object sender, EventArgs e)
{
   Button[] b = new Button[4];
   for (int i=0; i < 4; i++)
   {
      b[i] = new Button();
      b[i].Name = "button" + i;
      b[i].Location = new Point(43, 39 + 10 * i);
      b[i].Size = new Size(158, 48);
   }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-28T16:56:13.323

您只创建了它们，但您还需要将它们添加到您的表单中：`this.Controls.Add(b[i]);`

```
private void button1_Click(object sender, EventArgs e)
{
   Button[] b = new Button[4];
   for (int i=0; i < 4; i++)
   {
       b[i] = new Button();
       b[i].Name = "button" + i;
       b[i].Location = new Point(43, 39 + 10 * i);
       b[i].Size = new Size(158, 48);

       this.Controls.Add(b[i]);
   }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T16:57:45.637

您所做的就是创建一个按钮数组，并在索引处分配按钮。您的表单对这些按钮一无所知，它们可能是整数数组或此时任何重要的东西。您需要将它们放入表单的容器中：

```
Controls.Add(b[i]); 
```

现在您的表单将拥有它们的所有权，在容器被处置时管理处置。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-28T17:03:53.137

试试这个：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Windows.Forms;

namespace winFormButtons
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void button1_Click(object sender, EventArgs e)
        {
            Button[] b = new Button[4];
            for (int i = 0; i < 4; i++)
            {
                b[i] = new Button();
                b[i].Name = "button" + i;
                b[i].Location = new Point(43, 39 + 10 * i);
                b[i].Size = new Size(158, 48);    
                b[i].Click += new EventHandler(OnClick);
                this.Controls.Add(b[i]);
            }
        }

        public void OnClick(object sender, EventArgs e)
        {    
            MessageBox.Show("Hello Handler:" + ((Button)sender).Name);    
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-28T16:59:38.853

`Panel`在您的表单上创建一个。并在您的代码中添加这一行

```
panel1.Controls.Add(b[i]) 
```

# entity-framework - 实体框架将所有字段放在 Firebird 表的主键中

> ID：15141213
> 
> 赞同：4
> 
> 时间：2013-02-28T16:55:34.683
> 
> 标签：entity-framework, orm, firebird, dd, firebird2.1

我将 Firebird 2.1 数据库与 VS2010 (.NET 4.0) 一起使用，并试图让它与实体框架一起正常工作。

问题是，当我从数据库表生成实体时，框架检测到所有列都是主键的一部分。该表非常简单，有两个整数列，其中一个被设置为主键。

我什至将“#PK_GEN#”设置为主键列的注释。

在 EF 编辑器中，我无法修改存储对象的主键属性，并且由于我将不得不处理可为空的列，这是一个问题。我可以编辑模型文件的 XML 代码，但是更新模型时所做的更改是非持久的，所以这是一个显示停止器。

由于我只阅读了有关视图而不是表的类似问题，因此我显然做错了，但我无法弄清楚。

*编辑：*顺便说一句，我刚刚用 VS 2012 测试了它的行为，它保持不变。

这是创建脚本。由于我是 Firebird 的新手，所以这里也可能有一些问题，但我真的不这么认为。

```
CREATE GENERATOR GEN_TESTTABLE_ID;
CREATE TABLE TESTTABLE (
    TESTTABLE_ID  INTEGER NOT NULL,
    VALUE         INTEGER
);
ALTER TABLE TESTTABLE ADD CONSTRAINT PK_TESTTABLE PRIMARY KEY (TESTTABLE_ID);
COMMENT ON COLUMN TESTTABLE.TESTTABLE_ID IS '#PK_GEN#';

SET TERM ^ ;
CREATE OR ALTER TRIGGER TESTTABLE_BI_GEN_ID FOR TESTTABLE
ACTIVE BEFORE INSERT POSITION 0
AS
begin
  if ((new.testtable_id is null) or (new.testtable_id = 0) ) then
    begin
      new.testtable_id = gen_id(gen_testtable_id, 1);
    end
end
^
SET TERM ; ^ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-03T07:17:03.227

问题是，Firebird 2.1 包含一个导致此问题的错误。使用 Firebird 2.5 生成模型，你会没事的。

一些参考[在这里](https://blog.cincura.net/232051-firebird-2-5-final-released/)，[这里](http://tracker.firebirdsql.org/browse/CORE-1246)，[这里](http://blog.cincura.net/227904-another-progress-on-entity-framework-provider-for-firebird/)。

# r - 如何在 R 包的 html 帮助页面中显示 NEWS？

> ID：15141214
> 
> 赞同：5
> 
> 时间：2013-02-28T16:55:35.847
> 
> 标签：r

`news()`R函数的帮助页面说：

> 它试图从文件“inst/NEWS.Rd”、“NEWS”或“inst/NEWS”（按此顺序）中以结构化形式读取其新闻。

这样做并安装软件包，我们（在 windows 下）在命令打开的 html 页面顶部获得 NEWS 文件的链接 `help(package=packagename)`。举个例子，假设你已经安装了`party`，你可以试试

```
help(package="party") 
```

但是，这仅适用于名为 NEWS 的文件。当我们提供 NEWS.Rd 文件时，没有指向新闻的链接。尝试

```
help(package="survival") 
```

当我们提供 NEWS.Rd 文件时，有没有办法获得这个链接？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-08T12:12:36.773

自 R 3.0.0 以来，该问题已得到解决。

`\code{}`然而，在 html 中呈现 NEWS.Rd 时，似乎会忽略一系列 Rd 格式化代码，例如。

# backbone.js - 骨干僵尸视图解决方案

> ID：15141216
> 
> 赞同：1
> 
> 时间：2013-02-28T16:55:44.840
> 
> 标签：backbone.js

因此，我已经与 Backbone 合作了一段时间，没有任何重大问题。虽然我已经阅读了很多关于 Zombie Views 的问题以及它们产生的内存泄漏。经过一些研究，我实现了一种显示视图的方法，希望可以防止这个问题。我目前有两个应用程序使用这种方法，一切似乎都进展顺利，但我想确保这种方法有效。

所有这些函数都在一个名为“App”的主应用程序对象上工作，其中定义了应用程序的命名空间，初始化并启动了应用程序。

首先，我当前的解决方案是这样工作的：当 Backbone 路由器捕获一个 url 时，它会实例化显示该页面所需的所有模型、集合和视图，但路由器不会呈现视图。它所做的只是将视图附加到 App 对象内的“contentView”数组，并使用该`App.setAndRenderContentViews`函数将页面的呈现也委托给 App。

在 App 对象上，我有两个数组，其中包含当前处于活动状态的所有视图。它们被称为“contentViews”和“appendedViews”。第一个是主视图，它们可能有一些“附加视图”来显示一些模型或集合。这些最后的视图存储在 appendedViews 数组中。

每次路由器调用`App.setAndRenderContentViews`函数时，应用程序都会运行一系列方法来正确关闭所有“旧视图”，然后渲染新视图。所以，这是我目前使用的代码：

```
window.App =
  Models: {}
  Collections: {}
  Views: {}
  Routers: {}

  contentViews: []
  appendedViews: []

  setContentViews: (views) ->
    @closeViews() unless @contentViews == []
    @closeAppendedViews() unless @appendedViews == []
    for view in views
      @contentViews.push view
    return @contentViews

  closeViews: ->
    for oldView in @contentViews
      @closeView(oldView)
    @contentViews = []

  closeAppendedViews: ->
    for oldView in @appendedViews
      @closeView(oldView)
    @appendedViews = []

  closeView: (view) =>
    view.unbind()
    view.remove()
    view.model.off unless view.model == undefined
    view.collection.off unless view.collection == undefined

  renderContentView: (view) =>
    $('#content-layout').append(view.render().el)

  renderContentViews: (renderViews) ->
    for view in renderViews
      @renderContentView(view)
    return 1

  setAndRenderContentViews: (views, everybody = false) ->
    if everybody == false
      return Backbone.history.navigate('', trigger: true) unless @session.load().authenticated()
    renderViews = @setContentViews(views)
    @renderContentViews(renderViews)

  pushToAppendedViews: (view) ->
    @appendedViews.push view 
```

我不知道这是否是处理这个问题的好方法。此外，也许有更好的方法来处理僵尸视图。我希望你们中的一个可以帮助我解决这个问题。谢谢！

# android - Android 应用小部件大小问题

> ID：15141220
> 
> 赞同：4
> 
> 时间：2013-02-28T16:55:51.543
> 
> 标签：android, android-widget

我在获取我正在设计的主屏幕小部件的大小时遇到​​了一些问题。我已经阅读了 sdk 文档并进行了一些搜索，但我并没有真正找到任何有用的东西。无论如何，我正在使用小部件提供程序的 onAppWidgetOptionsChanged 方法来获取 API 16 以上设备上的小部件大小，并且它在某些设备上报告不正确。它在 Nexus S 和 Transformer Prime 上运行正常，但它在我的 S3 上给出的值小于我从屏幕截图中测得的值。我已经解释了它以 dp 而不是像素报告的事实。我猜三星的启动器会添加某种类型的边距，但我找不到任何相关性。例如，当我使用 2x2 小部件时，onAppWidgetOptionsChanged 报告 154dp (~293px) 宽度和 193dp (~355px) 高度，但我在 Photoshop 中测量了约 340 像素 x 420 像素。这是三星唯一的问题，还是我要在许多非香草平台上面对这个问题。该代码非常基本，但我发布任何以防万一。

```
@Override
public void onAppWidgetOptionsChanged(Context context, AppWidgetManager appWidgetManager, int appWidgetId, Bundle newOptions) {
    int minWidth = newOptions.getInt(AppWidgetManager.OPTION_APPWIDGET_MIN_WIDTH);
    int maxWidth = newOptions.getInt(AppWidgetManager.OPTION_APPWIDGET_MAX_WIDTH);
    int minHeight = newOptions.getInt(AppWidgetManager.OPTION_APPWIDGET_MIN_HEIGHT);
    int maxHeight = newOptions.getInt(AppWidgetManager.OPTION_APPWIDGET_MAX_HEIGHT);

    Log.i("WidgetProvider","Widget size changed");
    Log.i("WidgetProvider","minWidth: " + minWidth);
    Log.i("WidgetProvider","minHeight: " + minHeight);
    Log.i("WidgetProvider","maxWidth: " + maxWidth);
    Log.i("WidgetProvider","maxHeight: " + maxHeight);
} 
```

我正在使用报告的大小在我的小部件更新服务中生成位图。我需要使用自定义位图，因为我想为我的小部件使用自定义字体和背景。在 API 16 以下的设备上，我只是将位图设置为小部件信息 xml 中定义的 minWidth 和 minHeight。在某些设备上，这会在小部件周围留下比我更喜欢的填充，但图像不会失真。据我了解，无法在早期设备中获取小部件大小。另外，我不相信自定义字体可以在应用小部件的 TextView 中使用。这个对吗？我曾尝试将 fitXY 与图像一起使用，但它在某些设备上看起来很糟糕。有没有更可预测的方式在小部件上完成自定义背景和自定义字体？任何建议将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T05:52:39.973

看来我有 samr 问题。Galaxy Note 上的小部件 4*4。onAppWidgetOptionsChanged 返回我 426*384 的最大尺寸，但如果你在屏幕上看到高度大于宽度......

# java - 关于hibernate中的一对一映射

> ID：15141222
> 
> 赞同：0
> 
> 时间：2013-02-28T16:55:57.320
> 
> 标签：java, hibernate, orm

我是hibernate世界的新手，请您指教，我在Hibernate中经历了一对一的关系，根据我的分析，可以通过三种方式建立一对一的hibernate关系。

```
1)Through Join concept
2)Same primary key in both the tables
3)Primary key and foriegn key relationship in both the tables 
```

**请指教，以上三种实现一对一映射的方法是正确的，或者我遗漏了什么，请指教，也请指教我使用的以下hbm映射文件是正确的。如果不是，请指教**。

1）通过加入概念：-
实现一对一关系的一种方法是通过加入概念，以下xml被用于

```
<hibernate-mapping>

<class name="mypack.Person" table="person21">
<id name="personId" type="int">
<generator class="increment">
</generator>
</id>
<property name="name"/>

<join table="personAddress">
<key column="personId"/>
<many-to-one name="address" class="mypack.Address" column="addressId" unique="true" cascade="all"/>
</join>
</class>

<class name="mypack.Address" table="address21">
<id name="id" column="addressId" type="int">
<generator class="increment"/>
</id>
<property name="city"/>
<property name="state"/>
</class>
</hibernate-mapping> 
```

2）两个表中的主键相同：-

在两个表中使用相同的主键，以下 hbm 被用于

```
 <class name="mypack.Address" table="address31">
<id name="id" column="addressId" type="int">
<generator class="increment"/>
</id>
<property name="city"/>
<property name="state"/>
</class>

<class name="mypack.Person" table="person31">
<id name="personId" type="int">
<generator class="foreign">
<param name="property">address</param>
</generator>
</id>
<property name="name"/>
<one-to-one name="address" class="mypack.Address"/>
</class>
</hibernate-mapping> 
```

3）两个表中的主键和外键关系：-

一个表中的主键和另一个表中的外键。下面是这个的hbm

```
<hibernate-mapping>
<class name="mypack.Person">
<id name="personId" type="int">
<generator class="increment"/>
</id>
<property name="name"/>

<many-to-one name="address" class="mypack.Address" column="addressId" unique="true" cascade="all"/>
</class>

<class name="mypack.Address">
<id name="id" column="addressId" type="int">
<generator class="increment"/>
</id>
<property name="city"/>
<property name="state"/>
</class>
</hibernate-mapping> 
```

请大家指教。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T09:57:36.920

我真的认为连接表对于一对一映射来说太过分了。对于其他 2 个解决方案，请查看以下 Hibernate 文档，所有内容均已解释：[http ://docs.jboss.org/hibernate/orm/3.3/reference/en/html/mapping.html#mapping-declaration-一对一](http://docs.jboss.org/hibernate/orm/3.3/reference/en/html/mapping.html#mapping-declaration-onetoone)。

对于您的第二个映射（主键关联），两个实体都需要定义一对一映射，并且关系的一侧也需要指定属性`constrained="true"`。

这就是我编写第二个映射的方式：

```
<class name="mypack.Person" table="PERSONS">
    <id name="id" type="int" column="PERSON_ID">
        <generator class="increment"/>
    </id>
    <property name="name" type="string" column="NAME"/>
    <one-to-one name="address" class="mypack.Address" cascade="all"/>
</class>

<class name="mypack.Address" table="ADDRESSES">
    <id name="id" type="int" column="ADDRESS_ID">
        <generator class="foreign">
            <param name="property">address</param>
        </generator>
    </id>
    <property name="city" type="string" column="CITY"/>
    <property name="state" type="string" column="STATE"/>
    <one-to-one name="person" class="mypack.Person" constrained="true"/>
</class> 
```

# javascript - 访问远程nodejs应用程序中的窗口对象

> ID：15141223
> 
> 赞同：0
> 
> 时间：2013-02-28T16:55:58.797
> 
> 标签：javascript, node.js

嗨，我想在远程包含的 nodejs 应用程序中访问客户端 JS 代码。很像谷歌分析。

```
<script type="text/javascript">
    var someID = 123456;
    (function() {
      var zx = document.createElement('script'); zx.type = 'text/javascript'; zx.async = true;
      zx.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'example.com/';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(zx, s);
    })();
</script> 
```

在上述场景中，包含的脚本是 nodejs，我想获取一些 ID。

如果我将它指向的不是我的节点应用程序而是一个静态 JS 文件，那很好，但我想将它和其他变量直接使用到 nodejs 中。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-28T16:59:10.547

您混淆了事物的客户端和服务器端。

您引用的谷歌分析代码**都**发生在客户端。（它最终会触发某种服务器端代码，但这无关紧要。）

您的 NodeJS 代码是**服务器**端的。您不能让服务器代码直接调用客户端代码、访问其变量等；你也不能反过来做。您必须向服务器*发送*信息（通过在 URL 中加载带有标识符的资源、通过[ajax](http://en.wikipedia.org/wiki/Ajax_%28programming%29)、使用[web sockets](http://dev.w3.org/html5/websockets/)等）并向客户端发送信息（通过响应 ajax 和其他请求、发送 web socket 消息等） .)。

因此，例如，您可以做一些几乎与 Google 分析一样的事情：

```
(function() {
    var someVariabletoPassToTheServer = "foo";
    var s = document.createElement('script');
    s.src = "//example.com/your/script?data=" + encodeURIComponent(someVariabletoPassToTheServer);
    document.getElementsByTagName('script')[0].parentNode.appendChild(s);
})(); 
```

然后，您的 NodeJS 代码可以`/your/script`在您的`example.com`服务器上处理请求、接收`data` `GET`参数并对其进行处理。（这就是谷歌分析所做的，但比上述更间接。）

# android - 为什么没有立即发送来自与 DatagramSocket 连接的 MediaRecorder 的 android 视频数据？

> ID：15141225
> 
> 赞同：2
> 
> 时间：2013-02-28T16:56:03.093
> 
> 标签：android, udp, android-mediarecorder

我正在编写一个创建 MediaRecorder 设置输出文件的 Android 应用程序

```
final ParcelFileDescriptor pfd = ParcelFileDescriptor.fromDatagramSocket(socket); 
```

套接字是数据报套接字。我可以启动记录器，但它只发送这个（或服务器接收这个）

```
server got: ftypisomisom3gp4 from 192.168.1.12:51433
server got:  from 192.168.1.12:51433 
```

DatagramSocket 关闭后，它会发送另外几条消息，可能是视频。有人知道为什么 DatagramSocket 不立即发送视频吗？

在此实现之前，我使用标准 TCP 套接字并且一切正常（延迟除外）。

在服务器上运行 Nodejs。在此先感谢您的任何建议。

# spring - Spring - 使用多动作控制器调用的@modelattribute 方法的顺序是什么

> ID：15141226
> 
> 赞同：3
> 
> 时间：2013-02-28T16:56:03.427
> 
> 标签：spring

我有一个控制器，它有多个动作和相应的@modelattribute 方法。其中一个方法输出是下一个方法的输入。然而，价值从未被设定。调试的时候发现调用方法的顺序不是我想的那样。它是否与命令名称 @ModelAttribute("nominationCommand") 或方法名称有关。是什么驱动了这个？

```
@ModelAttribute("awardCommand")
public AwardCommand getAwardList(HttpServletRequest request, HttpSession session, Model model) {

@ModelAttribute("associateDetails")
public List<AssociateDetailsCommand> getAssociateList (HttpServletRequest request, HttpSession session, Model model) {

@ModelAttribute("achievementCommand")
public AchievementDetailsCommand getAchievementDetails(HttpServletRequest request, Model model) {

@ModelAttribute("departmentCommand")
public List<DepartmentCommand> getDepartmentList(HttpServletRequest request,HttpSession session, Model model) { 
```

我需要按照上面列出的顺序调用这些方法。但是在第二种方法之前调用了第三种方法。需要你的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-28T17:05:25.347

Spring 使用 Java 反射来获取方法列表。在大多数情况下，就 JDK 而言，这是非常不可预测的。

最常见的解决方法是将 @ModelAttribute 替换为控制器处理程序中的相应模型。

```
@RequestParam("/example/view")
public ModelAndView view(HttpServletRequest request, Model model /*probably some more parameters*/){
       model.put("awardCommand", getAwardCommand());
       model.put("achievementCommand", getAchievementCommand());
       ///... TODO put other
} 
```

# postgresql - postgresql中的日期比较不起作用

> ID：15141231
> 
> 赞同：4
> 
> 时间：2013-02-28T16:56:13.100
> 
> 标签：postgresql

我的 postresql 数据库中的查询有问题。我试图在某个日期时间之后获取最后 100 条日志，但是当我使用此查询时：

```
select * from log_entry WHERE array['MESSAGE'] && tags AND CAST(last_updated AS DATE) >= '2013-02-28T16:47:26.394213' ORDER BY last_updated DESC LIMIT 100 
```

这里 last_updated 列的类型是：timestamp without time zone

有时我会从 '2013-02-28T16:47:26.394213' 之前获取日志，我做错了什么吗？有没有更好的方法来代替使用强制转换？

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-28T17:30:00.003

（应要求从评论中重新发布。）

好吧，这就是您的问题：当您将时间戳（带或不带时区）转换为日期时，您会截断时间戳的时间部分。为什么不`'2013-02-28T16:47:26.394213'`转换为时间戳并直接与它进行比较`last_updated`？

```
select * from log_entry 
WHERE array['MESSAGE'] && tags 
AND last_updated 
  >= '2013-02-28T16:47:26.394213'::timestamp without time zone
ORDER BY last_updated DESC LIMIT 100 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-02-12T23:06:50.343

使用这个。这应该工作。

select * from log_entry WHERE array['MESSAGE'] && tags AND age(last_updated)

> = age(now()) 按 last_updated DESC LIMIT 100 排序

# d3.js - 如何调整 D3 中某个点的缩放大小？

> ID：15141232
> 
> 赞同：7
> 
> 时间：2013-02-28T16:56:15.387
> 
> 标签：d3.js, zooming, transform

这可能是“你做错了”的经典案例，但我迄今为止的所有搜索都没有得到任何帮助。

这是我的场景：

我正在使用albersUSA 地图投影以及国家和县GeoJson 文件来绘制所有内容。

我还有一个自己创建的“城市”文件，其中包含每个州的主要城市。坐标是准确的，一切看起来都很好。

![在此处输入图像描述](../Images/18e33fb4e818169e22d1eac1a554f234.png)

当用户点击给定的州时，我会隐藏所有州的形状，然后计算使该州的县形状适合我的视口所需的变换。然后我将该变换应用于所有必要的县形状，以获得“缩放”视图。我的代码如下：

```
function CalculateTransform(objectPath)
{
   var results = '';

   // Define bounds/points of viewport
   var mapDimensions = getMapViewportDimensions();
   var baseWidth = mapDimensions[0];
   var baseHeight = mapDimensions[1];

   var centerX = baseWidth / 2;
   var centerY = baseHeight / 2;

   // Get bounding box of object path and calculate centroid and zoom factor
   // based on viewport.
   var bbox = objectPath.getBBox();
   var centroid = [bbox.x + bbox.width / 2, bbox.y + bbox.height / 2];
   var zoomScaleFactor = baseHeight / bbox.height;
   var zoomX = -centroid[0];
   var zoomY = -centroid[1];

   // If the width of the state is greater than the height, scale by
   // that property instead so that state will still fit in viewport.
   if (bbox.width > bbox.height) {
      zoomScaleFactor = baseHeight / bbox.width;
   }

   // Calculate how far to move the object path from it's current position to
   // the center of the viewport.
   var augmentX = -(centroid[0] - centerX);
   var augmentY = -(centroid[1] - centerY);

   // Our transform logic consists of:
   // 1\. Move the state to the center of the screen.
   // 2\. Move the state based on our anticipated scale.
   // 3\. Scale the state.
   // 4\. Move the state back to accomodate for the scaling.   
   var transform = "translate(" + (augmentX) + "," + (augmentY) + ")" +
                 "translate(" + (-zoomX) + "," + (-zoomY) + ")" +
                 "scale(" + zoomScaleFactor + ")" +
                 "translate(" + (zoomX) + "," + (zoomY) + ")";

   return results;
} 
```

...和绑定功能

```
// Load county data for the state specified.
d3.json(jsonUrl, function (json) {
    if (json === undefined || json == null || json.features.length == 0) 
    {
       logging.error("Failed to retrieve county structure data.");
       showMapErrorMessage("Unable to retrieve county structure data.");
       return false;
    }
    else 
    {
       counties.selectAll("path")
                .data(json.features)
                .enter()
                   .append("path")
                      .attr("id", function (d, i) {
                         return "county_" + d.properties.GEO_ID
                      })
                      .attr("data-id", function (d, i) { return d.properties.GEO_ID })
                      .attr("data-name", function (d, i) { return countyLookup[d.properties.GEO_ID] })
                      .attr("data-stateid", function (d, i) { return d.properties.STATE })
                      .attr("d", path);

        // Show all counties for state specified and apply zoom transform.
        d3.selectAll(countySelector).attr("visibility", "visible");
        d3.selectAll(countySelector).attr("transform", stateTransform);

        // Show all cities for the state specified and apply zoom transform
        d3.selectAll(citySelector).attr("visibility", "visible");
        d3.selectAll(citySelector).attr("transform", stateTransform);
    }
}); 
```

![在此处输入图像描述](../Images/b7d2662e56e38c6cfdd37e1e94ddfcd2.png)

这在这里工作得很好，除了非常小的状态，缩放因子要大得多，并且圆圈会失真。

![在此处输入图像描述](../Images/5bd0293acce6bbc874df7b3b35ba94bb.png)

即使在变换发生后，有没有办法强制点的大小为固定大小（比如 15px 半径）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-08-09T04:35:23.783

对于您不想缩放的东西，只需将它们除以 'scale' 。就我而言，

```
var zoom = d3.behavior.zoom()
    .on("zoom",function() {
        g.attr("transform","translate("+d3.event.translate.join(",")+")scale("+d3.event.scale+")");

        g.selectAll(".mapmarker")  
        .attr("r",6/d3.event.scale)
        .attr("stroke-width",1/d3.event.scale);

}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-28T18:48:27.897

发生这种情况是因为您正在设置缩放变换而不是缩放位置。您可以在[这里](http://jsfiddle.net/superboggly/eWW6s/)看到区别基本上它是以下之间的区别：

```
// Thick lines because they are scaled too
var bottom = svg.append('g').attr('transform', 'scale('+scale+','+scale+')');
bottom.selectAll('circle')
    .data(data)
    .enter().append('circle')
    .attr('cx', function(d) { return d.x; })
    .attr('cy', function(d) { return d.y; }); 
```

和

```
// line thicknesses are nice and thin
var top = svg.append('g');
top.selectAll('circle')
    .data(data)
    .enter().append('circle')
    .attr('cx', function(d) { return d.x * scale; })
    .attr('cy', function(d) { return d.y * scale; }); 
```

使用映射可能你最好的解决方案是计算你的偏移量和比例，然后将它们添加到你的投影函数中——你想直接修改投影后的 x 和 y 值。如果您正确更新投影功能，则无需执行任何其他操作即可对地图应用适当的缩放。

# mysql - 获取 mysql 的最后一个插入 ID 如何处理事务？+ 交易问题

> ID：15141233
> 
> 赞同：23
> 
> 时间：2013-02-28T16:56:26.673
> 
> 标签：mysql, codeigniter, transactions, pdo

一个两部分的问题：

1.  在我的 CodeIgniter 脚本中，我开始一个事务，然后插入一行，将 insert_id() 设置为一个 php 变量，使用新 ID 作为外键将更多行插入另一个表，然后我提交所有内容。

    所以我的问题是：如果在结束事务之前一切都没有提交，如果没有插入任何东西，mysql如何能够返回最后一个插入 ID？我的脚本（几乎）完美地工作，在后续查询中使用了新 ID。

    （我说“几乎”是因为，使用 PDO mysql 驱动程序，有时应该返回 insert_id() 的第一个插入是重复的——它被插入了两次。知道为什么会这样吗？这与获取最后一个有关吗ID？如果使用 mysqli 或 mysql 驱动程序，它永远不会发生。）

2.  我首先编写了没有事务的脚本，所以我有一些代码可以一路检查 mysql 错误，例如：

    ```
    if(!$this->db->insert($table, $data)) {
        //log message here
    } 
    ```

    一旦我将所有 mysql 代码包装在事务中，这将如何影响 mysql 进程？它不会导致任何可见的错误（希望与上述问题无关），但应该将其删除吗？

谢谢你。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-03-14T05:21:42.170

要回答你的第一个问题...

使用事务时，就您的连接而言，您的查询会正常执行。您可以选择提交、保存这些更改，或者回滚、还原所有更改。考虑以下伪代码：

```
insert into number(Random_number) values (rand()); 
select Random_number from number where Number_id=Last_insert_id(); 
```

//php

```
if($num < 1)
   $this->db->query('rollback;'); // This number is too depressing.
else
   $this->db->query('commit;'); // This number is just right. 
```

生成的随机数可以在提交之前读取，以确保它在保存之前适合所有人查看（例如，提交和解锁行）。

如果 PDO 驱动程序不起作用，请考虑使用 mysqli 驱动程序。如果这不是一个选项，您始终可以使用查询“select last_insert_id() as id;” 而不是 $this->db->insert_id() 函数。

要回答您的第二个问题，如果您要插入或更新其他模型将要更新或读取的数据，请务必使用事务。例如，如果将“Number_remaining”列设置为 1，则可能会出现以下问题。

```
Person A reads 1
Person B reads 1
Person A wins $1000!
Person A updates 1 to be 0
Person B wins $1000!
Person B updates 0 to be 0 
```

在相同情况下使用事务将产生以下结果：

> 人 A 开始事务
> 人 A 从 Number_remaining 读取“1” （如果使用[select for update](http://dev.mysql.com/doc/refman/5.6/en/innodb-locking-reads.html)
> ，则 该行现在被锁定）人 B 尝试读取 Number_remaining - 被迫等待人 A 赢得 $1000人 A 将 1 更新为 0人 A 提交人B 读到 0人 B 没有赢得 $1000人 B 哭

您可能还想阅读[事务隔离级别](http://dev.mysql.com/doc/refman/5.6/en/set-transaction.html)。

小心死锁，在这种情况下可能会发生：

> A 读取第 1 行 ( `select ... for update`)
> B 读取第 2 行 ( `select ... for update`)
> A 尝试读取第 2 行，被迫等待
> B 尝试读取第 1 行，被迫等待
> A 达到[innodb_lock_wait_timeout](http://dev.mysql.com/doc/refman/5.0/en/innodb-parameters.html#sysvar_innodb_lock_wait_timeout)（默认 50 秒）并断开连接
> B 读取第 1 行并正常继续

最后，由于 Person B 可能已经到达 PHP 的`max_execution_time`，当前查询将独立于 PHP 完成执行，但不会收到进一步的查询。如果这是一个 autocommit=0 的事务，当与您的 PHP 服务器的连接被切断时，查询将自动回滚。

# java - java.lang.ClassCastException：com.sun.proxy.$Proxy0 无法转换为 org.andrea.myexample.myDeclarativeTransactionSpring.StudentJDBCTemplate

> ID：15141237
> 
> 赞同：5
> 
> 时间：2013-02-28T16:56:39.103
> 
> 标签：java, spring, spring-mvc, spring-aop, spring-transactions

我正在尝试在 Spring Framework 应用程序中实现有关声明性事务的本教程，但它不起作用，因为当我尝试执行**MainApp**类来测试应用程序行为时，我收到一个错误：

[http://www.tutorialspoint.com/spring/declarative_management.htm](http://www.tutorialspoint.com/spring/declarative_management.htm)

所以我有**StudentDAO**接口，我只定义了我想要的 CRUD 方法：

```
package org.andrea.myexample.myDeclarativeTransactionSpring;

import java.util.List;

import javax.sql.DataSource;

/** Interfaccia che definisce i metodi che implementano le operazioni di CRUD
 *  che vogliamo implementare nel nostro DAO:
 */
public interface StudentDAO {

    /**
     * Questo metodo viene usato per inizializzare le risorse del database cioè
     * la connessione al database:
     */
    public void setDataSource(DataSource ds);

    /**
     * Questo metodo serve a creare un record nella tabella Student e nella
     * tabella Marks:
     */
    public void create(String name, Integer age, Integer marks, Integer year);

    /**
     * Questo metodo serve ad elencare tutti i record all'interno della tabella
     * Studend e della tabella Marks
     */
    public List<StudentMarks> listStudents();
} 
```

然后我有**StudentMark**类，它可以将我的**实体**保存在数据库的 2 表上：

```
package org.andrea.myexample.myDeclarativeTransactionSpring;

// Rappresenta l'entity:
public class StudentMarks {

    // Proprietà:
    private Integer age;
    private String name;
    private Integer id;
    private Integer marks;
    private Integer year;
    private Integer sid;

    // Metodi Getter & Setter:
    public void setAge(Integer age) {
        this.age = age;
    }

    public Integer getAge() {
        return age;
    }

    public void setName(String name) {
        this.name = name;
    }

    public String getName() {
        return name;
    }

    public void setId(Integer id) {
        this.id = id;
    }

    public Integer getId() {
        return id;
    }

    public void setMarks(Integer marks) {
        this.marks = marks;
    }

    public Integer getMarks() {
        return marks;
    }

    public void setYear(Integer year) {
        this.year = year;
    }

    public Integer getYear() {
        return year;
    }

    public void setSid(Integer sid) {
        this.sid = sid;
    }

    public Integer getSid() {
        return sid;
    }
} 
```

然后我有实现**RowMapper**接口的**StudentMarksMapper类：**

 **```
package org.andrea.myexample.myDeclarativeTransactionSpring;

import java.sql.ResultSet;
import java.sql.SQLException;
import org.springframework.jdbc.core.RowMapper;

/** Classe che implementa l'interfaccia RowMapper. Si tratta di un'interfaccia
 *  usata da JdbcTemplate per mappare le righe di un ResultSet (oggetto che 
 *  contiene l'insieme delle righe restituite da una query SQL) riga per riga.
 *  Le implementazioni di questa interfaccia mappano ogni riga su di un oggetto
 *  risultante senza doversi preoccupare della gestione delle eccezioni poichè
 *  le SQLException saranno catturate e gestite dalla chiamata a JdbcTemplate.
 */
public class StudentMarksMapper implements RowMapper<StudentMarks> {

    /** Implementazione del metodo dell'interfaccia RowMapper che mappa una 
     *  specifica riga della tabella su di un oggetto Student
     * 
     *  @param Un oggetto ResultSet contenente l'insieme di tutte le righe
     *         restituite dalla query
     * 
     *  @param L'indice che indentifica una specifica riga
     * 
     *  @return Un nuovo oggetto Student rappresentante la riga selezionata
     *          all'interno dell'oggetto ResultSet
     * 
     *  @see org.springframework.jdbc.core.RowMapper#mapRow(java.sql.ResultSet, int)
     */
    public StudentMarks mapRow(ResultSet rs, int rowNum) throws SQLException {

        StudentMarks studentMarks = new StudentMarks();

        studentMarks.setId(rs.getInt("id"));
        studentMarks.setName(rs.getString("name"));
        studentMarks.setAge(rs.getInt("age"));
        studentMarks.setSid(rs.getInt("sid"));
        studentMarks.setMarks(rs.getInt("marks"));
        studentMarks.setYear(rs.getInt("year"));

        return studentMarks;
    }
} 
```

旁边是StudentDAO 接口的**StudentJDBCTemplate**类：

```
package org.andrea.myexample.myDeclarativeTransactionSpring;

import java.util.List;
import javax.sql.DataSource;
import org.springframework.dao.DataAccessException;
import org.springframework.jdbc.core.JdbcTemplate;

/**
 * Classe che fornisce l'implementazione per il nostro DAO le cui funzionalità
 * di CRUD sono state definite tramite l'interfaccia StudentDAO
 */
public class StudentJDBCTemplate implements StudentDAO {

    // Utility per l'accesso alla sorgente dati
    private JdbcTemplate jdbcTemplateObject;

    /**
     * Metodo Setter per l'Injection della dipendenza relativa alla sorgente
     * dati. Tale metodo inoltre costruisce anche l'oggetto istanza di
     * JdbcTemplate usato per interagire con i dati nel database.
     * 
     * @param la sorgente dati
     */
    public void setDataSource(DataSource dataSource) {
        this.jdbcTemplateObject = new JdbcTemplate(dataSource);
    }

    /**
     * Metodo relativo all'operazione di CREATE che inserisce un nuovo record
     * all'interno della tabella Student ed un correlato nuovo record nella
     * tabella Marks.
     */
    public void create(String name, Integer age, Integer marks, Integer year) {

        try {
            // Query che inserisce nome ed età nella tabella Student:
            String SQL1 = "insert into Student (name, age) values (?, ?)";
            // Esegue la query passandogli anche i valori effettivi da inserire:
            jdbcTemplateObject.update(SQL1, name, age);

            // Seleziona l'ultimo studente inserito nella tabella Marks:
            String SQL2 = "select max(id) from Student";
            // Esegue la query e mette il risultato (l'ID) in sid:
            int sid = jdbcTemplateObject.queryForInt(SQL2);

            /**
             * Query che inserisce un nuovo record nella tabella Marks. Il
             * record rappresenta il voto per l'ultimo studente inserito nella
             * tabella Student:
             */
            String SQL3 = "insert into Marks(sid, marks, year) "
                    + "values (?, ?, ?)";
            // Esegue la query passandogli anche i valori effettivi da inserire:
            jdbcTemplateObject.update(SQL3, sid, marks, year);

            System.out.println("Created Name = " + name + ", Age = " + age);

            // SIMULA UNA RuntimeExceptio:
            throw new RuntimeException("Simulazione di una condizione d'errore");
        } catch (DataAccessException e) {       // GESTIONE DELL'ECCEZIONE
            System.out.println("Errore nella creazione dei record, esegue rollback");
            throw e;
        }
    }

    /**
     * Metodo relativo all'operazione di READ che recupera la lista degli
     * studenti e dei relativi voti
     * 
     * @return La lista di oggetti che rappresentano uno studente ed i suoi voti
     *         correlati
     */
    public List<StudentMarks> listStudents() {

        /**
         * Query che estrae la lista di tutti i record nella tabella Student e
         * che per ogni record in tale tabella estrae i relativi record
         * correlati nella tabella Marks
         */
        String SQL = "select * from Student, Marks where Student.id=Marks.sid";

        /**
         * Ottengo la lista degli oggetti StudentMarks, corrispondenti ognuno ad
         * un record della tabella Student con i correlati vori rappresentati
         * dai record della tabella Marks, invocando il metodo query 
         * sull'oggetto JdbcTemplate passandogli i seguenti parametri.
         * 
         * @param La query per creare il preparated statement
         * @param Un oggetto che implementa RowMapper che viene usato per
         *        mappare una singola riga della tabella su di un oggetto Java
         */
        List<StudentMarks> studentMarks = jdbcTemplateObject.query(SQL,
                                                     new StudentMarksMapper());
        return studentMarks;
    }
} 
```

然后这是测试应用程序的**MainApp**类：

```
package org.andrea.myexample.myDeclarativeTransactionSpring;

import java.util.List;
import org.springframework.context.ApplicationContext;
import org.springframework.context.support.ClassPathXmlApplicationContext;

// Classe principale:
public class MainApp {

    public static void main(String[] args) {

        /**
         * Crea il contesto in base alle impostazioni dell'applicazione definite
         * nel file Beans.xml
         */
        ApplicationContext context = new ClassPathXmlApplicationContext("Beans.xml");

        /**
         * Recupera un bean avente id="studentJDBCTemplate" nel file di
         * configurazione Beans.xml
         */
        StudentJDBCTemplate studentJDBCTemplate = (StudentJDBCTemplate) context.getBean("studentJDBCTemplate");

        System.out.println("------Creazione dei record--------");
        // Creo i record nelle tabelle Studend e Marks:
        studentJDBCTemplate.create("Zara", 11, 99, 2010);
        studentJDBCTemplate.create("Nuha", 20, 97, 2010);
        studentJDBCTemplate.create("Ayan", 25, 100, 2011);

        System.out.println("------Elenca tutti i record--------");
        // Recupera la lista degli studenti con i voti ad essi associati:
        List<StudentMarks> studentMarks = studentJDBCTemplate.listStudents();

        for (StudentMarks record : studentMarks) {      // e li stampa
            System.out.print("ID : " + record.getId());
            System.out.print(", Name : " + record.getName());
            System.out.print(", Marks : " + record.getMarks());
            System.out.print(", Year : " + record.getYear());
            System.out.println(", Age : " + record.getAge());
        }
    }
} 
```

最后这是我的**Beans.xml**配置文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:tx="http://www.springframework.org/schema/tx"
    xmlns:aop="http://www.springframework.org/schema/aop"
    xsi:schemaLocation="http://www.springframework.org/schema/beans
   http://www.springframework.org/schema/beans/spring-beans-3.0.xsd 
   http://www.springframework.org/schema/tx
   http://www.springframework.org/schema/tx/spring-tx-3.0.xsd
   http://www.springframework.org/schema/aop
   http://www.springframework.org/schema/aop/spring-aop-3.0.xsd">

    <!-- Initializazione della sorgente dati: -->
    <bean id="dataSource"
        class="org.springframework.jdbc.datasource.DriverManagerDataSource">
        <property name="driverClassName" value="com.mysql.jdbc.Driver" />
        <property name="url" value="jdbc:mysql://localhost:3306/SpringTestDb" />
        <property name="username" value="root" />
        <property name="password" value="aprile12" />
    </bean>

    <tx:advice id="txAdvice" transaction-manager="transactionManager">
        <tx:attributes>
            <tx:method name="create" />
        </tx:attributes>
    </tx:advice>

    <aop:config>
        <aop:pointcut id="createOperation"
            expression="execution(* org.andrea.myexample.myDeclarativeTransactionSpring.StudentJDBCTemplate.create(..))" />
        <aop:advisor advice-ref="txAdvice" pointcut-ref="createOperation" />
    </aop:config>

    <!-- Inizializzazione del Transaction Manager: -->
    <bean id="transactionManager"
        class="org.springframework.jdbc.datasource.DataSourceTransactionManager">
        <property name="dataSource" ref="dataSource" />
    </bean>

    <!-- Definizione del bean che rappresenta il DAO studentJDBCTemplate: -->
    <bean id="studentJDBCTemplate" class="org.andrea.myexample.myDeclarativeTransactionSpring.StudentJDBCTemplate">
        <property name="dataSource" ref="dataSource" />
    </bean>

</beans> 
```

问题是当我尝试运行我的**MainApp**类时，我收到以下错误消息：

```
INFO: Loaded JDBC driver: com.mysql.jdbc.Driver
Exception in thread "main" java.lang.ClassCastException: com.sun.proxy.$Proxy0 cannot be cast to org.andrea.myexample.myDeclarativeTransactionSpring.StudentJDBCTemplate
    at org.andrea.myexample.myDeclarativeTransactionSpring.MainApp.main(MainApp.java:22) 
```

在此错误消息中说问题出在 MainApp 类的第 22 行...这只是当我尝试获取具有 ID="studentJDBCTemplate: 的 bean 时：

```
StudentJDBCTemplate studentJDBCTemplate = (StudentJDBCTemplate) context.getBean("studentJDBCTemplate"); 
```

问题出在哪里？我该如何解决？

肿瘤坏死因子

安德烈亚

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-28T17:16:53.737

选项 1，更改您的配置以在接口级别注入事务：

```
<aop:config>
    <aop:pointcut id="createOperation"
        expression="execution(* org.andrea.myexample.myDeclarativeTransactionSpring.StudentDAO.create(..))" />
    <aop:advisor advice-ref="txAdvice" pointcut-ref="createOperation" />
</aop:config> 
```

并获取 bean 作为该接口的实例：

```
StudentDAO studentDao = (StudentDAO) context.getBean("studentJDBCTemplate"); 
```

选项 2，指示代理应使用`proxy-target-class`属性扩展目标类：

```
<aop:config proxy-target-class="true">
    ...
</aop:config> 
```

第一个选项是更简洁的选项，但坦率地说，我更喜欢`@Transactional`在 Spring bean XML 中使用注释而不是 AOP 声明。有时很难使后者正确，如果您没有对组件进行特定的事务性测试，您*不一定会注意到事情不正确*。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-28T17:25:06.623

您应该在 aop 切入点表达式中使用接口类型，即在以下行中：-

```
expression="execution(* org.andrea.myexample.myDeclarativeTransactionSpring.StudentJDBCTemplate.create(..))" /> 
```

使用下面的代码： -

```
expression="execution(* org.andrea.myexample.myDeclarativeTransactionSpring.StudentDAO.create(..))" /> 
```

Spring 通过代理支持 AOP，代理有两种类型：基于接口（代理实现目标类实现的所有接口）和基于类（通过子类化目标类来实现）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-12-03T21:02:17.513

`<aop:config>`只需从 StudentDAO 接口获取 bean 实例，我就能够在不更改 的情况下执行。

```
<aop:config>
      <aop:pointcut id="createOperation" 
      expression="execution(* com.tutorialspoint.StudentJDBCTemplate.create(..))"/>
      <aop:advisor advice-ref="txAdvice" pointcut-ref="createOperation"/>
</aop:config>

 StudentDAO studentJDBCTemplate = (StudentDAO)context.getBean("studentJDBCTemplate"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-07-03T13:03:38.830

就我而言，它已解决如下：

```
Util.clobToString((Clob)item[index]) 
```**

# javascript - 获取 HTML 中选定文本的准确参考

> ID：15141244
> 
> 赞同：3
> 
> 时间：2013-02-28T16:56:48.543
> 
> 标签：javascript, css

假设我在单个文本中有以下文本`<p>... </p>`

当用户在文本中选择几个单词时，假设第**一个** `Quisque vestibulum`被选中，我得到选定的文本，`window.getSelection().toString();`然后应用一些 CSS 技巧，假设我在文本下划线。

当用户一个月后回来时，我想再次在相同的文本下划线。如何获得所选文本的准确参考以供将来参考？我不想强调**第二个** `Quisque vestibulum`。

> Lorem ipsum dolor sit amet, consectetur adipiscing elit。dolor 的前庭坐在 amet augue tempor venenatis vitae et nibh。Donec dignissim fringilla 发酵。在 facilisis consectetur risus 中。Nam vel mauris magna，一个 feugiat nisl。Quisque vestibulum, neque eu tristique tristique, tortor mauris ornare magna, at ultricies augue orci sed enim。Nulla magna ligula，dapibus vel commodo ac，sodales ut sem。Duis lorem massa，consectetur sed molestie eget，posuere eu magna。Pellentesque sollicitudin mattis facilisis。Nunc pulvinar metus et diam dignissim 坐在 amet pellentesque metus pretium。Quisque 前庭，maecenas vel leo 坐在 amet diam iaculis sollicitudin。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T04:58:02.730

您可以使用 search() 或 indexOf() 并存储字符串的位置以及实际选择的文本。

# oracle - 两个任务共同与 TWO_TASK 变量

> ID：15141247
> 
> 赞同：2
> 
> 时间：2013-02-28T16:56:55.397
> 
> 标签：oracle

[Two Task Common](http://docs.oracle.com/cd/A57673_01/DOC/net/doc/NWUS233/ch2.htm#twotask)和环境变量[TWO_TASK](http://asktom.oracle.com/pls/asktom/f?p=100:11:0%3a%3a%3a%3aP11_QUESTION_ID:89412348059)之间是否存在关系？

TTC 是整个 Oracle*Net 堆栈的一部分，“在客户端和服务器之间提供不同字符集或格式之间的字符集和数据类型转换”

Oracle 环境变量 TWO_TASK 用于通过 SQL Net 连接到远程数据库。

对于名称如此相似并且都涉及到 Oracle 网络架构，我觉得一定有某种关系。TTC 是否也管理这个远程连接件？

# c++ - 枚举前向声明

> ID：15141248
> 
> 赞同：10
> 
> 时间：2013-02-28T16:56:58.203
> 
> 标签：c++, enums, forward-declaration

我正在尝试正确使用枚举的前向声明。因此我搜索了互联网，但我找不到有效的东西。

我在标题中使用它：

```
// Forward declaration
enum myEnumProcessState; 
```

然后我在结构中使用这个枚举：

```
struct myStruct {
    [...]
    myEnumProcessState osState;
    [...]
}; 
```

在另一个标题中：

```
enum myEnumProcessState {
    eNotRunning,
    eRunning
}; 
```

我发现类型应该放在枚举前向声明中才能被接受。但是，我不知道应该为流程状态输入哪种“类型”。这些不起作用：

```
enum myEnumProcessState : unsigned int;
enum myEnumProcessState : String; 
```

我想跳过前向声明，但我的*结构*正在哭泣，因为它再也找不到它了......

所以我有点困惑。有解决办法吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-02-28T19:33:13.313

在 C++11 之前，C++ 根本不支持枚举的前向声明！但是，一些编译器（如 MS Visual Studio）为此提供了语言扩展。

如果您的编译器不支持 C++11，请查看其有关枚举前向声明的文档。

如果你可以使用 C++11，那就是`enum class`语法（你几乎是对的，但要注意附加`class`关键字：

```
// Forward declaration
enum class myEnumProcessState: unsigned int;

// Usage in a struct
struct myStruct {myEnumProcessState osState;};

// Full declaration in another header
enum class myEnumProcessState: unsigned int {
    eNotRunning,
    eRunning
};

// Usage of symbols (syntax may seem slightly unusual)
if (myObject.osState == myEnumProcessState::eNotRunning) {
    ...
} 
```

# tomcat - 在运行时重新加载tomcat日志记录？

> ID：15141249
> 
> 赞同：1
> 
> 时间：2013-02-28T16:56:59.327
> 
> 标签：tomcat, tomcat7, java.util.logging

我们目前正在使用 Tomcat 7，其中使用 -Djava.util.logging.config.file 指定单个日志配置，默认 ClassLoaderLogManager 使用 -Djava.util.logging.manager="org.apache.juli.ClassLoaderLogManager"。这对于一次性启动配置非常有用。

我们有几个 servlet 和其他在 servlet 上下文之外运行的代码。我们在我们完全控制的专用 tomcat 服务器上运行，并且我们希望所有代码使用相同的日志配置。我们使用 java.util.logging API 进行日志记录。这意味着 LogManager.getLogManager().getLogger(name) 需要工作，而 Logger.isLoggable(Level) 需要工作。

ClassLoaderLogManager 似乎与我们的情况相反：允许 servlet 指定单独的日志设置。我们希望将所有日志控制在一个地方。但是，我们*确实*想要其他 JULI 的好处，比如改进的 FileHandlers。

现在的问题是：如何在运行时从文件中*重新加载*这些设置而不重新加载应用程序？

我试过的：

*   LogManager.getLogManger.readConfiguration()：在 ClassLoaderLogManager 中产生有效的 NOOP，因为 Thread.currentThread.getContextClassLoader() 不是系统类加载器。
*   显式设置 Thread.setContextClassLoader(ClassLoader.getSystemClassLoader()) 然后调用上面的。这确实读取了配置文件（在调试器中逐步执行），但它没有将更改传播到包含的 ClassLoaders 中的现有记录器。Logger.setLevel() 从未在现有记录器上调用。
*   在这些调用之前调用 reset() 似乎没有任何改变。
*   JMX 似乎只公开单个 ClassLoader（可能是系统 ClassLoader）的记录器

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T20:48:11.143

我找到了一个解决方案。将启动脚本中的日志管理器替换为默认的 java.util.logging.LogManager 或简单地删除命令行参数会导致使用常规的 LogManager。当调用 readConfiguration() 时，此 LogManager 将完全重新加载所有 ClassLoaders 中所有 Logger 的配置，这正是我需要的行为。

但是，这确实涉及修改 tomcat 启动脚本。如果有人可以在不这样做的情况下找到更好的解决方案，那就太好了，否则我会接受这个答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T18:21:34.173

如果您没有与 Tomcat JULI 结婚，您可能需要考虑使用 Logback，因为恕我直言，它是唯一能够在运行时可靠地处理日志配置重新加载的方法。

我自己没有这样做，但是有人写了一个指南：[**Logging with SLF4J and Logback in Tomcat and TomEE**](http://hwellmann.blogspot.com/2012/11/logging-with-slf4j-and-logback-in.html)，它基本上使用了一堆桥接 jar。

您可能会考虑的另一件事是仅将每个 Web 应用程序日志记录与 Logback 一起使用，而忽略 Tomcat 的 JULI 日志（这就是我所做的）。

**警告：[http :](http://www.slf4j.org/legacy.html#jul-to-slf4j) **//www.slf4j.org/legacy.html#jul-to-slf4j** ...因此请不要直接使用 JUL .... [Guava](https://stackoverflow.com/questions/1953380/lightweight-message-bus-library#comment17688612_11989692)和 Tomcat 在我使用 JUL 的 $hit 列表中。**

# javascript - Knockoutjs 选择值更改不会更新 observable

> ID：15141250
> 
> 赞同：2
> 
> 时间：2013-02-28T16:57:01.423
> 
> 标签：javascript, knockout.js

我有一个选择选项，它从 EmailField 获取其初始值，从 allEmailFields 获取其选项：

```
<select data-bind="options: $parent.allEmailFields, value: EmailField()"></select> 
```

当我更改选择的值时，我的模型不会更新。这不是双向绑定应该处理的事情吗？或者我需要为更改事件编写处理程序？

模块在这里：

```
 define('mods/fieldmapping', ["knockout", "libs/knockout.mapping", "datacontext", "mods/campaigner", "text!templates/fieldmapping.html", "text!styles/fieldmapping.css"],
function (ko, mapping, datacontext, campaigner, html, css) {
    'use strict';
    var
        fieldMappingItem = function (data) {
            var self = this;
            self.CrmField = ko.observable(data.CrmField);
            self.EmailField = ko.observable(data.EmailField);
        },
        dataMappingOptions = {
            key: function (data) {
                return data.PlatformFieldName;
            },
            create: function (options) {
                return new fieldMappingItem(options.data);
            }
        },
        fieldMappingViewModel = {
            contentLoading: ko.observable(false)
        },
        showFieldMapping = function () {
            campaigner.addStylesToHead(css);
            campaigner.addModalInnerPanel(html);
        },
        init = function (connectionId, connectionName) {            
            fieldMappingViewModel.fieldMappings = mapping.fromJS([]);
            fieldMappingViewModel.allEmailFields = mapping.fromJS([]);            
            fieldMappingViewModel.originatorConnectionName = ko.observable();
            fieldMappingViewModel.originatorConnectionName(connectionName);
            fieldMappingViewModel.saveFieldMappings = function () {
                console.log(ko.toJSON(fieldMappingViewModel.fieldMappings));
                amplify.request("updateExistingFieldMappings", 
                    {
                        cid: connectionId,
                        RequestEntity: ko.toJSON(fieldMappingViewModel.fieldMappings)
                    },
                    function (data) {
                        console.log(data);
                    });
            };
           showFieldMapping();

            amplify.request('getExistingFieldMappings', { cid: connectionId }, function (data) {
                amplify.request("getCampaignerFields", function (breezerData) {
                    mapping.fromJS(breezerData.ResponseEntity, fieldMappingViewModel.allEmailFields);
                });                
                mapping.fromJS(data.ResponseEntity, dataMappingOptions, fieldMappingViewModel.fieldMappings);                
                ko.applyBindings(fieldMappingViewModel, $('#fieldMapping')[0]);
            });
        };
    return {
        init: init,
        fieldMappingViewModel: fieldMappingViewModel,
        html: html,
        css : css
    }
}); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-28T16:59:44.683

代替：

```
<select data-bind="options: $parent.allEmailFields, value: EmailField()"></select> 
```

和：

```
<select data-bind="options: $parent.allEmailFields, value: EmailField"></select> 
```

如果你想创建双向依赖，那么你应该传入绑定 observable。

*PS*： http: [//knockoutjs.com/documentation/observables.html#observables](http://knockoutjs.com/documentation/observables.html#observables)

# c++ - undeclared identifier 和 identifier is undefined 是什么意思？如何修复错误？

> ID：15141254
> 
> 赞同：0
> 
> 时间：2013-02-28T16:57:10.407
> 
> 标签：c++

```
#include "stdafx.h"
#include <stdio.h>
#include <conio.h>
#include <string.h>
#include <stdlib.h>
#include <iostream>

using namespace std;

#define TIMEQUANTUM 1;
#define MAXPROCTIME 100;

struct SortList
{
    int pid;
    int arrivalTime;
    int burstTime;
    SortList *nxt;
};

struct JobList {
    int pid;
    int ct_arrival;
    int ct_service;
    int vt_served;
    int vt_residence;
    int vt_wait;
    int vt_completion;
    JobList *nxt;
};

bool initJobList(JobList *&,int *,int);
bool deinit(JobList *&);
bool doFCFS (JobList *&);
bool doRR (JobList *&);
bool doSJF(JobList *&, SortList *&);
bool doNPSJF (JobList *&);
bool doPSJF (JobList *&);
bool sortJob (JobList *&, SortList *&);

int _tmain(int argc, _TCHAR* argv[])
{

    JobList *ptrJobStart;
    // arrivaltime , bursttime
    int arrJobs[][2] = {
                        {0,7},
                        {2,4},
                        {4,1},
                        {5,4}
    };   
    SortList *ptrList;
    initJobList (ptrJobStart,(int *)&arrJobs, (sizeof(arrJobs) / (sizeof(int)*2)));
    printf("\ndoFCFS\nCPU\t\tPROCESS\n");
       doFCFS (ptrJobStart);
    deinit(ptrJobStart);

    initJobList (ptrJobStart,(int *)&arrJobs, (sizeof(arrJobs) / (sizeof(int)*2)));
    printf("\n\ndoSJF\nCPU\t\tPROCESS\n");
        doSJF(ptrJobStart, ptrList);
    deinit(ptrJobStart);

    initJobList (ptrJobStart,(int *)&arrJobs, (sizeof(arrJobs) / (sizeof(int)*2)));
    printf("\ndoRR\nCPU\t\tPROCESS\n");
    doRR(ptrJobStart);
    deinit(ptrJobStart);

    initJobList (ptrJobStart,(int *)&arrJobs, (sizeof(arrJobs) / (sizeof(int)*2)));
    printf("\ndoPSJF\nCPU\t\tPROCESS\n");
    doRR(ptrJobStart);
    deinit(ptrJobStart);

    getch();
    return 0;   
}

bool doRR(JobList *&ptrJobStart)
{

    if(ptrJob==NULL) return false;
    JobList *ptrJobStart, *tempJobList;
    ptrJobStart = ptrJob;
    int maxTime = MAXPROCTIME;
    int timeQuantum = TIMEQUANTUM;
    bool flag = false;
    ptrJobStart->vt_served = 0;
    for(int processTime = 0; (processTime < maxTime) && !flag ;)
    {
        //check if all jobs are finished
        flag = true;
        tempJobList = ptrJob;
        while(tempJobList!=NULL)
        {
            if(tempJobList->vt_served!=tempJobList->ct_service)
            {
                flag = false;
            }
            tempJobList = tempJobList->nxt;
        }
    }
    //logic
    return true;
}

bool doSJF(JobList *&ptrJobStart, SortList *&ptrList)
{
    if(ptrJobStart==NULL) return false;
    sortJob(ptrJobStart, ptrList); 
    doFCFS (ptrJobStart);
    return true;
}

bool sortJob (JobList *&ptrJob, SortList *&ptrList)
{
    JobList *ptrJobStart = ptrJob;
    if(ptrJobStart==NULL) return false;
    int maxTime = MAXPROCTIME;
    SortList *newList;
    ptrList = NULL;
    for(; ptrJobStart!=NULL; ptrJobStart = ptrJobStart->nxt) // accumulate all arrival time = 0
    {
        if(ptrJobStart->ct_arrival==0)
        {
            if(ptrList==NULL)
            {
                ptrList = new SortList;
                ptrList->pid = ptrJobStart->pid;
                ptrList->arrivalTime = ptrJobStart->ct_arrival;
                ptrList->burstTime = ptrJobStart->ct_service;
                ptrList->nxt = NULL;
            }
            else
            {
                newList = new SortList;
                newList->pid = ptrJobStart->pid;
                newList->arrivalTime = ptrJobStart->ct_arrival;
                newList->burstTime = ptrJobStart->ct_service;
                newList->nxt = NULL;
                ptrList->nxt = newList;
            }
        }
    }
    SortList *tempList;
    tempList = ptrList;
    for(int processTime = 1 ; processTime < maxTime ; processTime++) // accumulate all burst time from 1 to 100
    {
        ptrJobStart = ptrJob;
        do
        {
            if((ptrJobStart->ct_arrival!=0) && (processTime == ptrJobStart->ct_service))
            {
                newList = new SortList;
                newList->pid = ptrJobStart->pid;
                newList->arrivalTime = ptrJobStart->ct_arrival;
                newList->burstTime = ptrJobStart->ct_service;
                newList->nxt = NULL;
                tempList->nxt = newList;
                tempList = tempList->nxt;
            }
            ptrJobStart = ptrJobStart->nxt;
        }while(ptrJobStart!=NULL);
    }
    //sort jobs
    ptrJobStart = ptrJob;
    JobList *tempJobList;
    tempJobList = ptrJobStart;
    for(; ptrList!=NULL; ptrList = ptrList->nxt)
    {
        tempJobList->pid = ptrList->pid;
        tempJobList->ct_arrival = ptrList->arrivalTime;
        tempJobList->ct_service = ptrList->burstTime;
        tempJobList = tempJobList->nxt;
    }
    return true;
}

bool doFCFS (JobList *& ptrJob)
{
    JobList *ptrJobStart = ptrJob;
    if(ptrJobStart==NULL) return false;
    int maxTime = MAXPROCTIME;
    ptrJobStart->vt_served = 0;
    for(int processTime = 0; processTime < maxTime; processTime++)
    {
        if(ptrJobStart->vt_served!=ptrJobStart->ct_service)
        {
            ptrJobStart->vt_served+=1;
        }
        else
        {
            ptrJobStart->vt_completion = processTime;
            ptrJobStart->vt_residence = processTime - ptrJobStart->ct_arrival;
            ptrJobStart->vt_wait = processTime - ptrJobStart->vt_served;
            cout<<"\n/* vt_served:"<<ptrJobStart->vt_served<<"\tvt_residence:"<<ptrJobStart->vt_residence
                <<"\tvt_wait:"<<ptrJobStart->vt_wait<<"\tvt_completion:"<<ptrJobStart->vt_completion<<" */";
            ptrJobStart = ptrJobStart->nxt;
            if(ptrJobStart==NULL) break;
            else
                ptrJobStart->vt_served = 1;
        }
        cout<<"\n "<<processTime<<"\t>>\t P"<<ptrJobStart->pid;
    }
    return true;
}

bool deinit (JobList *& ptrJobStart) {

    JobList *ptrJobDel = NULL;
    do {

        ptrJobDel = ptrJobStart;
        ptrJobStart = ptrJobStart->nxt;
        delete ptrJobDel;
    }while (ptrJobStart != NULL);
    return true;
}

bool initJobList(JobList*& ptrJobStart,int *pJob,int nJobs){

    JobList * ptrJobs = NULL;
    int i;
    int j=1;

    for (i=0; i<nJobs*2; i+=2) {
        if (ptrJobs == NULL) {
            ptrJobs = new JobList;
            memset(ptrJobs,0,sizeof(JobList));
            ptrJobStart = ptrJobs;
        }
        else {
            ptrJobs->nxt = new JobList;
            memset(ptrJobs->nxt,0,sizeof(JobList));
            ptrJobs = ptrJobs->nxt;
        }
        ptrJobs->ct_arrival = *(pJob+i);
        ptrJobs->ct_service = *(pJob+(i+1));
        ptrJobs->pid = j;
        ptrJobs->nxt = NULL;
        j++;
    }
    return true; 
```

此代码用于调度算法。最短的 Job Next (SJN) / Shortest Job First (SJF)（即 doSJN）正在工作。但是当我包含 doRR（做循环）时，会发生很多错误。

错误 C2065：“ptrJob”：未声明的标识符 错误 C2082：重新定义形式参数“ptrJobStart 错误 C2065：“ptrJob”：未声明的标识符

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T17:01:01.333

在`doRR`中，参数被命名为`ptrJobStart`。应该是`ptrJob`。

您得到的错误表明 , 的第一行`doRR`尚未`ptrJob`声明。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T17:02:53.587

第一个错误（形式参数'ptrJobStar'的重新定义）发生在这里：

```
bool doRR(JobList *&ptrJobStart)
{

    if(ptrJob==NULL) return false;
    JobList *ptrJobStart, *tempJobList; 
```

您正在定义一个参数 ptrJobStart，然后在代码中声明同名参数。

我*相信*第二个错误（'ptrJob'：未声明的标识符）发生在这里：

```
bool doRR(JobList *&ptrJobStart)
{

    if(ptrJob==NULL) return false; 
```

这是因为'ptrJob' 似乎没有在doRR() 中声明。

希望有帮助。

# actionscript-3 - AS3 打印作业不适用于 Chrome

> ID：15141265
> 
> 赞同：0
> 
> 时间：2013-02-28T16:57:36.993
> 
> 标签：actionscript-3, google-chrome

因此，我在 Chrome 上遇到了一个奇怪的问题，我无法在网上找到任何与类似问题相关的帖子。我在一个 AS3 应用程序中有一个脚本，它将屏幕截图作为位图数据并将其与 PrintJob 对象一起发送到打印机。它可以在 Flash 中、在我的桌面本地以及除 Chrome 之外的所有浏览器中正常工作。

当我使用 Chrome 打印时，位图图像仅显示为灰色框，而不是实际图像本身。如果我将位图添加到舞台并从 Chrome 中查看它，我可以看到位图实际上包含除 50% 灰色填充之外的图像数据，但是一旦将其发送到 PrintJob，Chrome 似乎就会将其从这些数据中删除。

这是我正在使用的代码：

```
function printImage(clip:Sprite){
      var printJob:PrintJob = new PrintJob();
      printJob.start();                 
      printJob.addPage(clip);           
      printJob.send();
};

var clip:Sprite = new Sprite();
clip.addChild(bitmap);
printImage(clip); 
```

另外值得注意的是，当我将 PrintJobOptions.printAsBitmap 设置为 true 时，灰色框开始出现在所有实例中，而不仅仅是 Chrome

非常感谢您的帮助！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-06T15:21:19.700

Chrome 的一个已知问题是任何被分配用于打印的 DisplayObject 都需要在舞台上。

只需将其添加到舞台并在之后将其删除，您就可以走了。

但是，我通常喜欢在所有东西后面设置一个容纳容器，以防止添加/删除孩子的眨眼。

# jquery - jQuery旋转 - 多点

> ID：15141266
> 
> 赞同：1
> 
> 时间：2013-02-28T16:57:38.057
> 
> 标签：jquery, rotation

我如何让这个插件像这样旋转：移动 45 度，停止，再移动 45*度*，停止等。

默认情况下，它的行为方式是移动 45 度并回到起点。

这是一个基本的连续旋转

```
var rotation = function (){
   $("#img").rotate({
      angle:0, 
      animateTo:360, 
      callback: rotation
   });
}
rotation(); 
```

[https://code.google.com/p/jqueryrotate/](https://code.google.com/p/jqueryrotate/)

# c++ - C++ hash_map 具有非专业模板作为值

> ID：15141269
> 
> 赞同：4
> 
> 时间：2013-02-28T16:57:44.550
> 
> 标签：c++, templates, hashmap

我想要一个`std::hash_map`将（例如）常规`std:string`s 映射到另一个模板类的**多个不同专业化**。

这个例子是我想要实现的（虽然它是错误的并且不能编译）：

```
template<typename T>
class Foo {
public:
  Foo(T _value)
  {
    this-> value = _value;
  }

private:
  T value;
};

int main() 
{
  hash_map<string, Foo> various_foos;
  various_foos["foo"] = Foo<int>(17);
  various_foos["bar"] = Foo<double>(17.4);
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-28T17:02:42.293

map只能存储单一的值类型，所以不能直接存储不同类型的对象；并且类模板的不同特化是不同的类型。

常见的解决方案是：

*   存储指向多态基类型的指针，并通过虚函数或 RTTI 访问真实类型。您需要小心管理对象本身 - 要么存储智能指针，要么将它们保存在其他一些数据结构中。
*   存储有区别的联合类型，例如[`boost::variant`](http://www.boost.org/doc/libs/release/doc/html/variant.html)或[`boost::any`](http://www.boost.org/doc/libs/release/doc/html/any.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-28T17:02:34.040

您的散列中通常不能有不完整类型的元素。你能做一个其他人可以继承的非模板基类吗？

其原因很大程度上归结为编译器将如何解释您的请求。如果它无法计算`Foo`结构的大小，则无法为`hash_map`.

# ruby - 红宝石捆绑程序openssl错误

> ID：15141275
> 
> 赞同：1
> 
> 时间：2013-02-28T16:57:53.237
> 
> 标签：ruby, openssl, bundler

我在 debian 挤压机上有捆绑 1.3.0、rubygems 2.00、ruby 1.9.3p392 和 rvm 1.18.15

在`bundle install`Gemfile 中使用以下源时：

`source 'https://rubygems.org' source 'https://ourgemserver.ourcompany.com'`

我明白了

`.../.rvm/gems/ruby-1.9.3-p392@global/gems/bundler-1.3.0/lib/bundler/vendor/net/http/persistent/ssl_reuse.rb:70:in 'connect': SSL_connect returned=1 errno=0 state=SSLv3 read server certificate B: certificate verify failed (OpenSSL::SSL::SSLError)`

虽然`gem install <one of the gems in gemfile>`工作没有任何问题

我尝试将[http://curl.haxx.se/ca/cacert.pem](http://curl.haxx.se/ca/cacert.pem)中的证书放入 .rvm/usr/ssl/cert.pem 中，但没有任何效果。

此外，bundler 似乎并不尊重`:ssl_verify_mode: 0`用户主页的 .gemrc

任何进一步的提示？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T22:40:11.887

在 OS X 10.7.5 上，我通过更新 openssl 并将以下内容添加到 .bash_profile 解决了同样的错误：

```
export SSL_CERT_FILE=/path/to/ca-bundle.crt 
```

# django - 扩展的 django 用户配置文件数据覆盖问题

> ID：15141279
> 
> 赞同：0
> 
> 时间：2013-02-28T16:58:00.210
> 
> 标签：django, user-profile

我创建一个用户配置文件如下：

```
class UserProfile(models.Model):
    # This field is required:
    user = models.OneToOneField(User, related_name="User can view study permission")  
    # Other fields:
    phone = models.CharField(max_length=20)
    disease = models.ManyToManyField(Disease) 
    date_assigned = models.DateTimeField("Date Assigned")
    query = models.ManyToManyField(Query, blank=True) 

    def __unicode__(self):
        studies = ', '.join(study.name for study in self.disease.all())
        return "%s can view %s" % (self.user, studies) 
```

它是用户的扩展信息。现在我正在自己创建一个管理页面，以允许管理员更新包含上述用户配置文件的用户帐户信息。其形式和代码如下：

```
def edit(request, user_id):
"""Edit a user's details"""
try:
  user = User.objects.get(id=user_id)
except User.DoesNotExist:
  user = None

# user exists:    
if user:
# Initial form field data:
  initial={'user_id': user_id,
         'username': user.username,
         'fname': user.first_name,
         'lname': user.last_name,
         'email': user.email,
         'phone': user.get_profile().phone,
         'groups': user.groups.all(),
         'studies': user.get_profile().disease.all(),
         'is_admin': user.is_staff,
         'is_active': user.is_active
         }

request.breadcrumbs(
  (_("Home"), reverse('home')),
  (_("All Users"), reverse('all users')),
  (_("User Details"), reverse('user details', args=[user_id])), 
)

if request.method == "GET":
  form = UserProfileEditForm(initial=initial,extra=request.user.id)
  response = {'heading': 'Edit', 'form': form}
  return render_to_response('accounts/edit.html',
                            response,
                            context_instance=RequestContext(request)
                            )
elif request.method == "POST":
  form = UserProfileEditForm(request.POST,extra=request.user.id)
  if form.is_valid():
    Log().add(request, "Edit", "W", "userprofile", user_id)

    if form.cleaned_data['password1'] and form.cleaned_data['password2']:
      user.set_password(form.cleaned_data['password1'])
    user.username = form.cleaned_data['username']
    user.first_name = form.cleaned_data['fname']
    user.last_name = form.cleaned_data['lname']
    user.email = form.cleaned_data['email']
    user.groups = form.cleaned_data['groups']
    user.is_staff = form.cleaned_data['is_admin']
    user.is_active = form.cleaned_data['is_active']
    user.save()

    # Oddly to make the extra fields found in UserProfile are saved, you
    # have to call get_profile().ATTRIBUTE, assign a value, then call
    # get_profile().save(). Calling user.save() as the last step won't 
    # save any changes made to UserProfile:
    disease_pks = form.cleaned_data['studies']
    user.get_profile().disease = Disease.objects.filter(pk__in=disease_pks)
    user.get_profile().phone = form.cleaned_data['phone']
    user.get_profile().save()

    return HttpResponseRedirect("/accounts/view/%s" % user_id)
  else:
    # form is not valid:
    return render_to_response("accounts/edit.html",
                              {'form': form, 'heading': 'Edit'},
                              context_instance=RequestContext(request)
                              )
# user does not exist:
else:
  error = "User #%s cannot be found. Press the 'BACK' button on your browser." % user_id 
  return HttpResponseRedirect(reverse('DigitalRecords.views.error', args=(error,)))

class UserProfileEditForm(forms.Form):
user_id = forms.IntegerField(widget=forms.HiddenInput())
username = forms.CharField(label=_("Username"))
password1 = forms.CharField(label=_("Password"), 
                          widget=forms.PasswordInput(),
                          required=False
                          )
password2 = forms.CharField(label=_("Password (again)"), 
                          widget=forms.PasswordInput(),
                          required=False
                          )  
fname = forms.CharField(label=_("First name"))
lname = forms.CharField(label=_("Last name"))
email = forms.EmailField()
phone = forms.CharField(label=_("Phone"))
is_admin = forms.BooleanField(label=_("Is an administrator?"), required=False)
is_active = forms.BooleanField(label=_("Is an active user?"), required=False)
groups = forms.ModelMultipleChoiceField(queryset=Group.objects.all(),
                                      widget=forms.CheckboxSelectMultiple()
                                      )
#Attach a form helper to this class
helper = FormHelper()
helper.form_id = "edituserprofile"
helper.form_class = "userprofile"

#Add in a submit and reset button
submit = Submit("Save", "Save Changes")
helper.add_input(submit)
reset = Reset("Reset", "Reset")
helper.add_input(reset)

def __init__(self, *args,**kwargs):
  extra = kwargs.pop('extra')
  super(UserProfileEditForm, self).__init__(*args, **kwargs)
  self.fields["studies"] =        forms.ModelMultipleChoiceField(queryset=User.objects.get(id=extra).get_profile().disease.all(),
                                       widget=forms.CheckboxSelectMultiple()
                                       ) 

def clean_username(self):
  """Check if the username does not already exist"""
  username = self.cleaned_data['username']
  user_id = self.cleaned_data['user_id']

  # handle:
  try:
    user = User.objects.get(username=username)
  except User.DoesNotExist:
    return self.cleaned_data['username']
  else:
    if user.id == user_id:
      return self.cleaned_data['username']
    else:  
      raise forms.ValidationError('User "%s" already exists' % username)

def clean_fname(self):

  fname = self.cleaned_data['fname']
  # Remove any diacritics/accented characters:
  fname = strip_diacritic(fname).strip()
  # Match names that may have hyphens, apostrophes, or periods in them.
  # example: John Doe, O'Brien, Leroy-Brown, Cpt. James T. Kirk
  pattern = '^([a-zA-Z]+(?:\.)?(?:[\-\' ][a-zA-Z]+(?:\.)?)*)$'

  # match the regex to the input string.
  results = re.match(pattern, str(fname))

  if results == None:
    raise ValidationError(u'%s is not a valid name' % fname)
  return fname

def clean_lname(self):
  """
  Determine if the patient's name is valid. It removed any accented/diacritic 
  characters and replaces them with the base character for simplicity. Names with 
  hyphens and/ore apostrophes like Hanna-Barbara and O'Brien are allowed. If the 
  check fails a validation error is raised.
  """ 
  lname = self.cleaned_data['lname']    
  # Remove any diacritics/accented characters:
  lname = strip_diacritic(lname).strip()    
  # Match names that may have hyphens, apostrophes, or periods in them.
  # example: John Doe, O'Brien, Leroy-Brown, Cpt. James T. Kirk
  pattern = '^([a-zA-Z]+(?:\.)?(?:[\-\' ][a-zA-Z]+(?:\.)?)*)$'

  # match the regex to the input string.
  results = re.match(pattern, str(lname))

  if results == None:
    raise ValidationError(u'%s is not a valid name' % lname)
  return lname

def clean(self):
  """Check if password1 and password2 match"""
  cleaned_data = self.cleaned_data
  password1 = cleaned_data.get('password1')
  password2 = cleaned_data.get('password2')

  # Notice it's an 'or' condition because a password change is optional:
  if password1 or password2:
    if password1 != password2:
      msg = "Passwords do not match"
      self._errors['password1'] = self.error_class([msg])
      self._errors['password2'] = self.error_class([msg])
      del cleaned_data['password1']
      del cleaned_data['password2']
      return cleaned_data
  return self.cleaned_data 
```

如果管理员试图编辑其他用户的帐户信息，它可以正常工作。但是，当管理员尝试更新他自己的帐户时。无论此字段是否更改，疾病字段将始终为空白。

有谁知道原因以及我应该如何更改我的代码？非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T17:06:43.970

我不确定其他代码，但您认为这些行似乎不合适。

```
user.get_profile().disease = Disease.objects.filter(pk__in=disease_pks)
user.get_profile().phone = form.cleaned_data['phone']
user.get_profile().save() 
```

您每次都通过调用`user.get_profile()`和更新它来获取新的配置文件对象。不保存它，而是一个新对象。所以改成

```
profile = user.get_profile()
profile.disease = Disease.objects.filter(pk__in=disease_pks)
profile.phone = form.cleaned_data['phone']
profile.save() 
```

# file-upload - 使用 CKEditor 的上传功能上传文件，但脱离了编辑器本身的上下文

> ID：15141280
> 
> 赞同：0
> 
> 时间：2013-02-28T16:58:08.957
> 
> 标签：file-upload, ckeditor

我目前正在使用 CKEditor 并让它与图像上传和浏览功能一起使用。在我的应用程序的另一个区域，我想让用户将图像上传到服务器，但此时不需要文本区域。是否可以创建一个简单的链接或按钮，从 CKEditor 启动上传功能，而无需在我想要按钮的空间中实际放置 textarea/html 编辑器？

即这将是完美的（当然也有javascript）

```
<a href="#" class="btn upload-button"><i class="icon-picture"></i> Upload</a> 
```

# php - 2个问题。无法将表单数据保存到数据库中（有一个动态下拉框）&我需要两个文本字段来根据下拉框选择进行更新

> ID：15141283
> 
> 赞同：0
> 
> 时间：2013-02-28T16:58:16.357
> 
> 标签：php, html, mysql, phpmyadmin, xampp

好的，谢谢您查看我的帖子，我想说我对 mysql 和 php 还很陌生，非常感谢您的帮助！

我有两张桌子。员工（Employee_ID、First_name、Last_name、Address 等）和培训（Training_ID、Employee_ID、First_name、Last_name、Training_type）。

对于培训表，我有一个表格，用于为员工分配培训类型。

在培训表格中，我刚刚设法插入了一个下拉框，其中包含员工表中的“employee_id”值。但是，自从我添加了这个，它不会让我提交表单并将数据保存到我的数据库中。所以如果你能告诉我我的代码有什么问题那就太好了。

最后，当表单下拉框中的用户 id 发生变化时，是否可以从表单中更新两个文本字段（first_name、Last_name）？我到处搜索，正在努力找到这个。下面是我的 PHP 代码。

```
<html>
<?php
$con = mysql_connect("localhost","root","");
if (!$con)
{
die('Could not connect: ' . mysql_error());
}

mysql_select_db("hrmwaitrose", $con);
?>
<head>
<link type="text/css" rel="stylesheet" href="style.css"/>
<title>Training</title>
</head>

<body>
<div id="content">  
<h1 align="center">Add Training</h1>

<form action="inserttraining.php" method="post">
<div>
<p>Training ID: <input type="text" name="Training_ID"></p>
<p>Employee ID:<select id="Employee_ID">
<?php
$result = mysql_query("SELECT Employee_ID FROM Employee");
while ($row = mysql_fetch_row($result)) {
    echo "<option value=$row[0]>$row[0]</option>";
}
?>
</select>
<p>First name: <input type="text" name="First_name"></p>
<p>Last name: <input type="text" name="Last_name"></p>
<p>
Training required?
<select name="Training">
<option value="">Select...</option>
<option value="Customer Service">Customer Service</option>
<option value="Bailer">Bailer</option>
<option value="Reception">Reception</option>
<option value="Fish & meat counters">Fish & meat counters</option>
<option value="Cheese counters">Cheese counters</option>
</select>
</p>
<input type="submit">
</form>
</div>

</body>
</html> 
```

这是我按下提交按钮时的 php 代码。

```
<?php
$con = mysql_connect("localhost","root","");
if (!$con)
{
die('Could not connect: ' . mysql_error());
}

mysql_select_db("hrmwaitrose", $con);

$sql="INSERT INTO training (Training_ID, Employee_ID, First_name, Last_name, Training)
VALUES
 ('$_POST[Training_ID]','$_POST[Employee_ID]','$_POST[First_name]','$_POST[Last_name]','$_POST[Training]')";

if (!mysql_query($sql,$con))
{
die('Error: ' . mysql_error());
}
echo "1 record added";

mysql_close($con);
?> 
```

自从我将员工 ID 更改为动态下拉框后，它就没有将数据发送到数据库，所以我认为这与此有关。抱歉，如果我的代码到处都是，正如我所说，我对此很陌生！！！我要提前感谢你，因为我在这方面遇到了很多麻烦！！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T17:05:19.180

您忘记在选择中添加名称属性，因此表单未发送输入（选择）值。

```
<select id="Employee_ID" name="Employee_ID"> 
```

# objective-c - 理解协议和子分类

> ID：15141284
> 
> 赞同：2
> 
> 时间：2013-02-28T16:58:19.173
> 
> 标签：objective-c, xcode, protocols

我正在创建一个 UITableViewController 子类（称为“MyTableViewClass”，最终将针对特定的表视图控制器进行子类化（称为“MySpecificTableViewClass”。理想情况下，我希望 MySpecificTableViewClass 中的一些方法是“必需”，即让开发人员界面说“实现不完整”。有没有办法做到这一点而不必在 MyTableViewClass 的协议中声明？

MyTableViewClass.h

```
#import <UIKit/UIKit.h>

@class MyTableViewClass;
@protocol MyTableViewClassProtocol <NSObject>;

-(void) fooBar;
@end

@interface MyTableViewClass : UITableViewController <NSFetchedResultsControllerDelegate, MyTableViewClassProtocol>
.... 
```

这将在我的 MyTableViewClass 实现中表明我“忘记”了实现 fooBar。我想我可以用存根方法来处理它（这是最好的方法吗？）。

MySpecificTableViewClass.h

```
....
#import "MyTableViewClass.h"

@interface MySpecificTableViewClass : MyTableViewClass
.... 
```

在 MySpecificTableViewClass 的实现中 - 没有警告表明我错过了

```
-(void) fooBar 
```

如果我将 MySpecificTableViewClass.h 更改为

```
....
#import "MyTableViewClass.h"

@interface MySpecificTableViewClass : MyTableViewClass <MyTableViewClassProtocol>
.... 
```

然后我确实收到了警告，但是**记住**定义协议似乎违反直觉，或者我完全错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T17:33:45.323

除了放入存根并调用`NSAssert()`它们以捕获（在运行时）任何未实现的方法之外，我还没有找到实现此功能的好方法。Objective-C 没有抽象类的概念。

也就是说，虽然我自己使用过这种模式，但通常最好重新考虑您的设计并使用策略模式和协议。也就是说，不要创建一个 abstract ，而是`MyTableViewClass`创建一个`MyTableViewHandler`它的子类`NSObject`并包含您需要的任何特殊逻辑。然后，您的表视图控制器可以`UITableViewController`是`MyTableViewHandler`. 作为代表，可以强制执行协议。这创建了一个更简单、更灵活的对象模型。这并不总是合适的，抽象类也有自己的位置，但在跳到纯继承之前请考虑策略模式。它通常效果更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T17:20:58.213

由于 MyTableViewClass 已经在实现该协议，它的子类将获得对它们可用的那些实现，这意味着子类也可以实现它们。您可以更改/扩展子类中的实现。

# java - Ant 使用带有命名空间的 antlib

> ID：15141285
> 
> 赞同：2
> 
> 时间：2013-02-28T16:58:23.587
> 
> 标签：java, ant, ant-contrib

我正在使用以下演示脚本：

```
<?xml version="1.0" encoding="UTF-8"?>
<project name="test" basedir="." xmlns:deploy="antlib:net.sf.antcontrib">
    <target name="default">
        <taskdef resource="net/sf/antcontrib/antlib.xml">
            <classpath>
                <pathelement location="lib/ant-contrib-1.0b3.jar"/>
            </classpath>
        </taskdef>
        <deploy:if>
            <isset property="defaultprop"/>
            <then>
                <echo message="it's set!"/>
            </then>
        </deploy:if>
    </target>
</project> 
```

当我运行此构建脚本（使用 target `default`）时，错误是

```
build.xml:9: Problem: failed to create task or type antlib:net.sf.antcontrib:if 
```

pathelement`lib/ant-contrib-1.0b3.jar`存在，而 ant 正在拾取它。我在想问题是我如何使用 xmlns。我从另一个对我也不起作用的例子中得到这个（不过，它适用于特定的服务器！），并试图弄清楚魔法酱是什么。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-28T17:16:12.867

添加 ant-contrib 的 taskdef 需要声明一个与您在项目中定义和前缀的名称空间相同的 URI。类似于[此处的 taskdef 的](https://stackoverflow.com/questions/12860024/the-prefix-sonar-for-element-sonarsonar-is-not-bound)工作方式。

```
<project name="test" basedir="." xmlns:deploy="antlib:net.sf.antcontrib">
    <target name="default">
        <taskdef uri="antlib:net.sf.antcontrib" resource="net/sf/antcontrib/antlib.xml">
            <classpath>
                <pathelement location="lib/ant-contrib-1.0b3.jar"/>
            </classpath>
        </taskdef>
        <deploy:if>
            <isset property="defaultprop"/>
            <then>
                <echo message="it's set!"/>
            </then>
        </deploy:if>
    </target>
</project> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T17:08:22.763

好吧，错误`if`在最后，它在谈论第9行。我认为这是这个标签的语法有问题：

```
 <deploy:if> 
```

我在“deploy:if”标签甚至“deploy”标签上找不到任何文档。**我认为 Ant 中没有“部署”任务 - 你需要创建一个“部署”*目标***。

试试这个怎么样：

```
 <if>
    <isset property="defaultprop"/>
    <then>
      <antcall target="deploy" />
    </then>
  </if> 
```

当我阅读它时，这将检查 isset，然后调用“部署”目标（如果已设置）。当然，您现在需要制定“部署”目标 :)

# php - 防止 apache 自动更改 mime 类型

> ID：15141292
> 
> 赞同：0
> 
> 时间：2013-02-28T16:58:35.847
> 
> 标签：php, apache, mime-types

我用 PHP 生成了一个 Wave-File。数据从服务器上的 wav 文件中读取、操作并最终发送给用户。

现在的问题：Apache 将此文件作为 Content-Type: application/x-wave 提供。即使我使用 header('Content-Type: audio/wave') 并且脚本具有扩展名 .php。

乍一看，Apache 无法知道我正在发送一个 wav 文件。所以我猜它会从正在发送的内容中自动检测 mime 类型。有没有办法阻止这种行为并强制 Apache 使用 header(...) 指定的 mime 类型？

这个 mime 类型问题导致问题的原因是：Firefox 不接受 application/x-wave，但它接受 audio/wave。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T12:18:57.290

原来服务器上安装了mod_mime_magic。这个mod会根据离开服务器的数据流自动设置mime类型。所以我可以做任何我想做的事情，该文件将始终以 application/x-wave 的形式离开服务器。

由于我无权访问 mod_mime_magic 配置，因此我目前正在与我的提供商核实他们可以做什么。

# eclipse - 在 Eclipse 中交换选项和命令键（emacs 样式）

> ID：15141295
> 
> 赞同：1
> 
> 时间：2013-02-28T16:58:46.093
> 
> 标签：eclipse, macos, emacs

在 OS X 上的 Eclipse 中选择 emacs 键绑定很好，但 Option 和 Command 键需要交换以方便。

这是OS X下emacs本身的问题。emacs下的解决方法很简单。（查看*Mac OS X*下的[Meta-key questions](http://www.emacswiki.org/emacs/MetaKeyProblems#toc15)。）

在 Eclipse 下选择 emacs 键绑定后，如何交换 Option 和 Command（即不一一进行）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T18:36:18.337

您可以在“系统偏好设置”、“键盘”、“键盘”选项卡、“修改键...”中全局交换这些键。我不知道任何特定于 Eclipse 的解决方案。

您可能还想查看[emacs-eclim](https://github.com/senny/emacs-eclim)，它使 Eclipse 命令在 Emacs 中可用。

# node.js - 避免 500 TypeError

> ID：15141296
> 
> 赞同：0
> 
> 时间：2013-02-28T16:58:45.497
> 
> 标签：node.js, undefined

在 node.js 上，假设我有一个像这样的对象：

```
var users = {
  '1': { name: 'john' },
  '2': { name: 'jack' },
  '3': { name: 'hal' },
}; 
```

如果我尝试访问`users['4'].name`，我显然会得到一个`500 TypeError: Cannot read property 'name' of undefined`.

完全可以理解，但是，让它保持沉默呢？node.js 开发人员实现这样的功能是否太难了？还是我错过了一些“安全”或任何问题？

无论如何，有没有一种简单的方法可以消除错误？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T17:01:16.567

你需要修复你的代码。而不是 write ，而是`users['4'].name`编写如下内容：

```
if ('4' in users)
    { users['4'].name; } 
```

您需要检查代码中影响代码的每个条件。Node.js 运行时无法知道您是否犯了错误，或者您是否根本不关心实际执行某些语句。

# jquery - 在backbone.js 视图中，如何从jquery 事件调用同一视图中的函数？

> ID：15141300
> 
> 赞同：1
> 
> 时间：2013-02-28T16:58:58.377
> 
> 标签：jquery, backbone.js, backbone-views

在下面的示例中，我试图从 jquery 事件中调用 myfunction。这个不对。我的事件触发了，但我不确定如何从事件中调用此函数。想法？

```
registerSliderControlEvents: function(){
    $("#slider-fill").on('slidestop', function (event) {
            //...some code

            this.myfunction(size);
        }
},

myfunction: function(size){
      //....some code
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-28T17:01:32.720

因为你在一个闭包中，所以范围`this`已经改变了。`this`预先存储在变量中是常见的做法。类似于：

```
registerSliderControlEvents: function(){
    var self = this;
    $("#slider-fill").on('slidestop', function (event) {
            //...some code

            self.myfunction(size);
        }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T17:25:14.837

您可以使用`Backbone.View`事件哈希来避免任何范围问题（请参阅[此处](http://backbonejs.org/#View)的文档）。类似于以下内容：

```
events: {
    'slidestop #slider-fill': 'handleSlideStop' 
},

handleSlideStop: function() {
      // Not sure where size param is coming from, but assuming
      // you can set it as a property of the view somewhere.
      console.log('Size', this.size);
} 
```

另一种选择是使用下划线的绑定方法，它允许您将回调委托给视图中的命名函数并指定调用它的范围。这看起来像这样：

```
registerSliderControlEvents: function(){
    $("#slider-fill").on('slidestop', _.bind(this.myFunction, this));
},

myfunction: function(size){
      //....some code
} 
```

当我不得不求助`that`或`self`解决范围问题时，我总是觉得有点脏，如果可能的话，我会尽量避免。然而，我对 JavaScript 还是很陌生，也许只需要接受它是一种必要的邪恶；）

# filepicker.io - 使用 filepicker.io，有没有办法获取原始文件路径？

> ID：15141307
> 
> 赞同：0
> 
> 时间：2013-02-28T16:59:14.677
> 
> 标签：filepicker.io

我正在使用 filepicker.io 和特别是计算机作为主要服务。

我想获取通过 API 上传的文件的原始文件路径。例如，如果我上传位于 的文件`/my/path/in/my/computer/file.zip`，我将在`FPFile`对象中获取 filepicker.io URL，而不是原始文件路径。

有没有办法得到它？

PS：我也尝试过检索文件的统计信息但没有成功。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T20:12:44.897

由于浏览器安全限制，文件的真实本地路径永远不会暴露给 javascript 应用程序。有关详细信息，请参阅[http://davidwalsh.name/fakepath](http://davidwalsh.name/fakepath)

# c# - 我的 Form1 上有一个用户控件，但是当我添加控件的鼠标事件时，它什么也没做，为什么？

> ID：15141308
> 
> 赞同：0
> 
> 时间：2013-02-28T16:59:15.100
> 
> 标签：c#

```
private void lineGraph1_MouseEnter(object sender, EventArgs e)
        {
            MessageBox.Show("test");
        } 
```

我希望当我将鼠标移到控制区域上/上时它会显示消息。我从这里下载了控制 dll：

```
http://www.codeproject.com/Articles/274318/Line-Graph-Component-in-Csharp 
```

下载了演示并在那里使用了 dll 文件。所以我现在有了 Form1 上的控件，然后我在 Form1 设计器中的控件上右键单击鼠标属性事件并双击 Mouse Enter 但是当我将鼠标移到控件上时什么也没有发生。

我做错了什么 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T17:08:42.650

添加该方法本身不会执行任何操作。您必须将其添加为事件处理程序，例如使用

```
lineGraph1.MouseEnter += new EventHandler(lineGraph1_MouseEnter); 
```

当您从右上角的事件下拉列表中选择 MouseEnter 事件时，表单编辑器会为您执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T17:24:50.970

我认为这是因为 LineGraph 对自己有一些控制。例如，如果您将 onmouseenter 事件直接放在 PlotArea 控件上，它可能会正常工作。

```
 public PlotArea()
    {
        this.SetStyle(ControlStyles.ResizeRedraw, true);
        this.SetStyle(ControlStyles.OptimizedDoubleBuffer, true);
        this.SetStyle(ControlStyles.AllPaintingInWmPaint, true);
        this.SetStyle(ControlStyles.UserPaint, true);
        this.MouseEnter += new EventHandler(PlotArea_MouseEnter);
    }

    void PlotArea_MouseEnter(object sender, EventArgs e)
    {
        MessageBox.Show("test");
    } 
```

# python - getattr 和多个类

> ID：15141316
> 
> 赞同：1
> 
> 时间：2013-02-28T16:59:54.360
> 
> 标签：python, python-2.7

大家好，我有两个类 A 和 B，我想从 B 中获取一个方法以在 A 中使用。

我的代码大致如下：

```
class A(object):
    __init__(self, args):
         'blah'

    def func2(self, args):
        #method = B.func1(args)
        # method = getattr(B, 'func1')

class B(object):
    __init__(self):
        'do stuff'

    def func1(self, args):
        'Do stuff here'
        return 
```

有没有办法在不从 func1 中删除 self 属性的情况下将 func1 放入 A 中？

这两个方法调用都不适合我，而且我不断收到类型错误

```
TypeError: unbound method func1 must be called with B instance as
first argument (got NoneType instance instead) 
```

编辑：找到我的解决方案

我找到了我的问题的解决方案。当我将值从 B 传递给 AI 时，我也需要将我的实例传递给 B。所以在我的初始化 A

```
class A(object):
    __init__( args, B_arg): 
```

在B级

```
class B(object):

    def passattributes():
         c = A( args, self ) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T17:06:19.380

您可以在 A 类中创建 B 的实例：

```
class A(object):
    def __init__(self):
        'blah'
         self.bInst = B()

    def func2(self, args):
        method = self.bInst.func1('func1')

class B(object):
    def __init__(self):
        'do stuff'

    def func1(self, args):
        print 'Do stuff here'
        return

aInst = A()
aInst.func2('some arg') 
```

结果：

```
Do stuff here 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T17:05:39.720

我猜想，既然您正在尝试做您想做的事情，那么在您的情况下要做的适当事情是将 B.func1 定义为类方法，因为您不希望它需要B类的实例。

```
@classmethod
def func1(cls, args):
   'blah 
```

# php - Android：HTTPS 连接到我的数据库

> ID：15141317
> 
> 赞同：0
> 
> 时间：2013-02-28T16:59:58.783
> 
> 标签：php, android, mysql, ssl, https

我曾经使用 HTTP 连接到 mysql 的 php，现在我被要求使用 HTTPS，因为它更安全。但我尝试了很多方法，但无法让平板电脑发布或获取任何信息，我制作了一个自签名证书并添加到本地计算机受信任区域，所以我不会被问到它未验证我是否要继续，我尝试通过浏览器连接，它工作正常并打印了我需要的所有信息，但不是通过应用程序。我附上了我需要更改为 HTTPS 的以前的 HTTP 代码。需要一些帮助来将此连接更改为 HTTPS。

```
 httpclient = new DefaultHttpClient();
        httppost = new HttpPost ("http://xx.xx.xx.xx/E-MENU/login.php");        
        username = etUser.getText().toString();
        password = etPass.getText().toString();
        password = md5(SHA1(password));

    try{
        nameValuePairs = new ArrayList<NameValuePair>();
        nameValuePairs.add(new BasicNameValuePair("username", username));
        nameValuePairs.add(new BasicNameValuePair("password", password));
        httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
        response = httpclient.execute(httppost);

    if(response.getStatusLine().getStatusCode() == 200){
        entity = response.getEntity();
            if (entity!= null){

    InputStream instream = entity.getContent();
    JSONObject jsonResponse = new JSONObject (convertStreamToString(instream)); 
```

谢谢前期。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T17:31:58.607

所以当你使用 HTTP 而不是 HTTPS 时它可以工作吗？该问题是由于服务器上的自签名证书不受 Android 信任造成的。

请参阅此问题的公认答案：[Android 上的自签名 SSL 接受](https://stackoverflow.com/questions/1217141/self-signed-ssl-acceptance-android)

# grails - Grails控制器在渲染模板时测试关于模型的断言？

> ID：15141319
> 
> 赞同：5
> 
> 时间：2013-02-28T17:00:01.707
> 
> 标签：grails

使用 Grails 2.1.0

似乎从控制器执行此操作：

```
render(view: "someView", model: [modelEntry: "hello"]) 
```

允许我在该控制器的单元测试中执行此操作：

```
controller.method() 
assert model.modelEntry == "hello" 
```

但是，如果我更改控制器来执行此操作：

```
render(template: "someTemplate", model: [modelEntry: "hello"]) 
```

现在测试中的模型实例是一个空数组。我已经对此进行了大量搜索，大多数解决方案似乎都是针对 Grails 1 的，通常涉及`modelAndView`对象（在我的测试中不存在）或`renderArgs`（同上）。

我发现的唯一解决方案是手动覆盖测试中的视图，如下所示：

```
views['_someTemplate.gsp'] = '${modelEntry}' 
```

然后对字符串进行断言。但我不喜欢这个解决方案，因为它：

1.  要求测试知道模板的文件名
2.  使测试没有好的 toString() 方法的模型条目变得困难
3.  使得对相关模型条目做出多个断言变得困难。

当控制器呈现模板时，有什么方法可以更直接地从测试用例中获取模型中的条目？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-28T20:15:51.730

在 render 方法 () 的代码中挖掘一点，`org.codehaus.groovy.grails.web.metaclass.RenderDynamicMethod`我可以看到`modelAndView`只有在渲染`view`.

渲染模板确实会返回一个 null modelAndView。

要在这种情况下检查模型，我认为您可以使用 Groovy `metaClass`。思路是截取原方法，存储值，然后调用他。

基于[这个问题](https://stackoverflow.com/questions/8349077/how-do-i-reset-a-mocked-static-method-in-groovy)，我构建了这个（未经测试，可能需要调整）：

```
@TestFor(MyController)
class MyControllerTests

  def templateModel

  @Test
  void inspectTemplateModel() {
    def originalMethod = MyController.metaClass.getMetaMethod('render', [Map] as Class[])
    controller.metaClass.render = { Map args ->
      templateModel = args.model
      originalMethod.invoke(delegate, args)
    }

    controller.method()
    assert templateModel.modelEntry == 'foo'

} 
```

# javascript - 设置变量并传递给函数或重新设置变量？

> ID：15141320
> 
> 赞同：1
> 
> 时间：2013-02-28T17:00:05.003
> 
> 标签：javascript, jquery, design-patterns, modular

哪个最好？设置一个变量并将其传递给调用，或者每次都重新设置 var。我想要`self = this`（即 Slider obj）以保持一致性。

**编辑**答案：我知道我可以使用`this`，但我与其他团队成员一起工作，并同意`self`在任何时候引用对象时使用的一致性。

这样更好吗：

```
Slider = {
    init: function() {
        var self = this,
        foo = $('.someElement');

        self.bindEvent(self);
    },

    bindEvent: function(self) {
        self.foo.on('click', self.wasClicked(self));
    },

    wasClicked: function(e, self) {
        e.doSomething();
        self.done();
    }
}; 
```

或这个：

```
Slider = {
    init: function() {
        var self = this,
        foo = $('.someElement');

        self.bindEvent();
    },

    bindEvent: function() {
        var self = this;
        self.foo.on('click', self.wasClicked);
    },

    wasClicked: function(e) {
        var self = Slider;
        e.doSomething();
        self.done();
    }
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T17:40:33.690

根据您的第一个示例，如果您为绑定目标使用参数，则您的代码更可重用。例如：

```
bindEvent: function(target) {
    target.onclick = function() { alert(target + " was clicked"); };
} 
```

`bindEvent()`现在可以被其他函数调用，并且可以针对`self`. 虽然在您当前的 Slider 对象中，它只需要由 调用`init()`，但将来您可能最终会向 Slider 添加功能，这将受益于该功能的增加的可重用性。在那个时候，您可以避免重写函数，或者更糟的是为新用例创建一个本质上重复的函数。

在`self`不是目标的情况下，仅仅是对父级的引用，任何一个例子都可以。如果你的函数已经有一个很长的参数列表，那么`self`在函数内部设置而不是将其作为参数传递通常是一个好主意。大量的争论使代码更难理解、重构和测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T17:07:21.813

您只需要`self`in `wasClicked`，在其他情况下使用`this`：

```
Slider = {

    init: function() {
        foo = $('.someElement');
        this.bindEvent();
    },

    bindEvent: function() {
        this.foo.on('click', this.wasClicked);
    },

    wasClicked: function(e) {
        var self = Slider;
        e.doSomething;
        self.done();
    }

}

Slider.init(); 
```

关于您的编辑：在第一个选项中，事件处理程序将不起作用，因为您立即调用它而不是传递引用。您必须修改方法以返回函数。

# php - 下拉列表保留选择的最后输入的值 php

> ID：15141329
> 
> 赞同：1
> 
> 时间：2013-02-28T17:00:40.340
> 
> 标签：php, drop-down-menu

我在 php 中创建了一个用户个人资料页面。用户插入性别和电话号码，所有这些都存储在数据库中的一个名为 profile 的表中。我的问题是如何制作下拉列表以保留用户上次输入的选定值。例如，如果用户选择男性，下拉列表应将男性保持为选中选项，并且仅在用户决定再次更改时才更改。

这是代码：

```
<form   action=""   method="POST"  >      
<?php

if ( isset($_GET['success']) === true && empty($_GET['success'])===true ){
    echo'Profile Updated Sucessfuly';
}else{
    if( empty($_POST) === false  &&  empty($errors) === true ){
        $update_data_profile = array('gender' => $_POST['gender'],
                                                 'telephone' => $_POST['telephone']);

        update_user_profile($session_user_id, $update_data_profile);
        header('Location: profile_update.php?success');                             
        exit();
    }else if ( empty($errors) === false ){
        echo output_errors($errors);
    }
?>

Gender<select name="gender"  id="gender"> 
    <option value=" "> EMPTY </option> 
    <option value="Male">Male</option> 
    <option value="Female">Female</option> 
</select>

Telephone <input name="telephone" type="text" size="25" />

<input type="submit" value="" name="submit"/></br> 
```

这是我用来在数据库中插入数据的函数：

```
function update_user_profile($user_id, $update_data_profile){

   $result = mysql_query("select user_id from profile where user_id = $user_id limit 1");

     $user_id = $update_data_profile['user_id'] ;

    if(count($update_data_profile)){

    $columns = array();
    $values = array();

    foreach($update_data_profile as $field => $data){
    $columns[] = $field;
    $values[] = $data;
    } 
    }

mysql_query(" INSERT INTO `profile` (" . implode(",", $columns) .") values ('" . implode("','", $values) . "')" ) or die (mysql_error()); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T17:16:14.483

从这里你会得到逻辑

```
<select name="gender" id="gender">
<?php
  if($_POST['gender'] == 'male' {
    echo '<option value="Male" selected>Male</option>';
  } else {
    echo '<option value="Female" selected>Female</option>';
?> 
</select> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T17:22:24.763

您可以在页面加载期间检索最后一个性别并添加所选选项。

```
<?php
    result = mysql_fetch_array(mysql_query("SELECT user_id FROM profile ORDER BY user_id DESC LIMIT 1"));
    $gender = $result['gender'];  //you need to change the ['gender'] with what your column name is for gender.
?>
<select name="gender"  id="gender"> 
    <option value=" "> EMPTY </option> 
    <option value="Male" <?php if($gender == "Male") echo "selected='selected'"; ?>>Male</option> 
    <option value="Female" <?php if($gender == "Female") echo "selected='selected'"; ?>>Female</option> 
</select> 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-28T17:12:46.927

您可以像这样更改代码：

```
<select name="gender"  id="gender" default="Male"> 
```

# ios - 不知从何而来的不需要的动画

> ID：15141335
> 
> 赞同：0
> 
> 时间：2013-02-28T17:00:46.417
> 
> 标签：ios, animation, uiview, addsubview

在我的 iOS 应用程序中，我有一些动画似乎不知从何而来。它们一开始不会发生，只有在稍微使用该应用程序后才会发生。这是一个有更好描述的 Youtube 视频：

[http://www.youtube.com/watch?v=whfG67EP6kk](http://www.youtube.com/watch?v=whfG67EP6kk)

我不太确定为什么这些元素会以它们（或根本）的方式进行动画处理。我调用的代码只是一个简单的 [view addSubView:viewname]。关于这种情况如何发生以及如何防止它的任何帮助都会很棒。

**编辑** 这是从看似四面八方飞来的文本的代码：

```
-(void)displayPublicDataForEntry:(PFObject *)entry likes:(unsigned long)likesCount comments:(unsigned long)commentsCount
{
    [indicator stopAnimating];
    [indicator removeFromSuperview];
    [zippingLabel removeFromSuperview];

    entryStatus.text = @"This entry is public";
    entryStatus.backgroundColor = [UIColor clearColor];
    entryStatus.frame = CGRectMake(10, 3, 200, 20);
    [shareView addSubview:entryStatus];

    // Display a UILabel of number of likes
    if (likesCount == 1)
        numberOfLikes.text = [NSString stringWithFormat:@"%lu like", likesCount];
    else
        numberOfLikes.text = [NSString stringWithFormat:@"%lu likes", likesCount];

    CGSize stringsize = [numberOfLikes.text sizeWithFont:[UIFont systemFontOfSize:14]];

    numberOfLikes.frame = CGRectMake(10, 22, stringsize.width, 20);
    numberOfLikes.backgroundColor = [UIColor clearColor];
    [shareView addSubview:numberOfLikes];

    // Display a UILabel of number of comments
    if (commentsCount == 1)
        numberOfComments.text = [NSString stringWithFormat:@" / %lu comment", commentsCount];
    else
        numberOfComments.text = [NSString stringWithFormat:@" / %lu comments", commentsCount];

    numberOfComments.frame = CGRectMake(numberOfLikes.frame.size.width + 10, 22, 100, 20);
    numberOfComments.backgroundColor = [UIColor clearColor];
    [shareView addSubview:numberOfComments];

    viewEntry.frame = CGRectMake(self.view.frame.size.width - 95, 12, 100, 40);
    [viewEntry addTarget:self
                  action:@selector(viewPublicEntry)
        forControlEvents:UIControlEventTouchUpInside];
    [shareView addSubview:viewEntry];
} 
```

那里没有任何东西（至少我认为没有）会导致这些奇怪的动画。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-12T21:02:07.967

我有这个问题。原因最终是调用开始动画而没有调用提交。我以某种方式调用了 [UIView beginAnimations:Nil context:nil] 两次。

# angularjs - ngSanitize 删除相对 IMG

> ID：15141337
> 
> 赞同：0
> 
> 时间：2013-02-28T17:00:50.483
> 
> 标签：angularjs

为什么 ngSanitize 会删除具有相对路径的图像源，例如`<img src="/img/lol.jpg>` 从 html 文本中删除，但它不会触及具有绝对路径的图像，例如`<img src="http://site.com/img/lol.jpg">`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-10-03T03:36:59.310

[图片 URL 白名单](https://github.com/angular/angular.js/blob/b7e82a33eee03fc683f982c6ee13d15d88b07f67/src/ng/sanitizeUri.js)正则表达式`/^\s*((https?|ftp|file|blob):|data:image\/)/`与相对 URL 不匹配。

您可以根据[编译提供者文档](https://docs.angularjs.org/api/ng/provider/$compileProvider#!)覆盖白名单。

```
app.config(function($compileProvider) {
    $compileProvider.imgSrcSanitizationWhitelist(<your regexp here>);
}); 
```

# c# - 在 .Net dll 中嵌入 git commit hash

> ID：15141338
> 
> 赞同：123
> 
> 时间：2013-02-28T17:00:53.163
> 
> 标签：c#, git

我正在构建一个 C# 应用程序，使用 Git 作为我的版本控制。

当我构建我的应用程序时，有没有办法在可执行文件中自动嵌入最后一个提交哈希？

例如，将提交哈希打印到控制台看起来像：

```
class PrintCommitHash
{
    private String lastCommitHash = ?? // What do I put here?
    static void Main(string[] args)
    {
        // Display the version number:
        System.Console.WriteLine(lastCommitHash );
    }
} 
```

请注意，这必须在**构建**时完成，而不是在**运行时**完成，因为我部署的可执行文件将无法访问 git repo。

可以在[此处](https://stackoverflow.com/questions/13428403/how-to-embed-an-updated-git-hash-into-version-hpp)找到 C++ 的相关问题。

**编辑**

根据@mattanja 的要求，我发布了我在项目中使用的 git hook 脚本。设置：

*   这些钩子是 linux shell 脚本，它们位于：*path_to_project\.git\hooks*
*   如果您使用的是[msysgit](http://msysgit.github.io/)，则*hooks*文件夹已经包含一些示例脚本。为了让 git 调用它们，请从脚本名称中删除“.sample”扩展名。
*   挂钩脚本的名称与调用它们的事件相匹配。就我而言，我修改*了 post-commit*和*post-merge*。
*   我的*AssemblyInfo.cs文件直接位于项目路径下（与**.git*文件夹相同级别）。它包含 23 行，我使用 git 生成第 24 行。

由于我的 linux-shelling 有点生疏，脚本只是将*AssemblyInfo.cs*的前 23 行读取到一个临时文件中，将 git 哈希回显到最后一行，然后将文件重命名为*AssemblyInfo.cs*。我敢肯定有更好的方法来做到这一点：

```
#!/bin/sh
cmt=$(git rev-list --max-count=1 HEAD)
head -23 AssemblyInfo.cs > AssemblyInfo.cs.tmp
echo [assembly: AssemblyFileVersion\(\"$cmt\"\)] >> AssemblyInfo.cs.tmp
mv AssemblyInfo.cs.tmp AssemblyInfo.cs 
```

希望这可以帮助。

* * *

## 回答 #1

> 赞同：87
> 
> 时间：2013-02-28T20:33:27.620

您可以将***version.txt***文件嵌入到可执行文件中，然后从可执行文件中读取***version.txt***。要创建***version.txt***文件，请使用`git describe --long`

以下是步骤：

## 使用构建事件调用 git

*   右键单击项目并选择属性

*   在 Build Events 中，添加 Pre-Build 事件，其中包含（注意引号）：

    "C:\Program Files\Git\bin\git.exe" 描述 --long > "$(ProjectDir)\version.txt"

    这将在您的项目目录中创建一个***version.txt***文件。

## 在可执行文件中嵌入 version.txt

*   右键单击项目并选择添加现有项目
*   添加***version.txt***文件（更改文件选择器过滤器以让您查看所有文件）
*   ***添加version.txt***后，在解决方案资源管理器中右键单击它并选择属性
*   将构建操作更改为嵌入式资源
*   将复制到输出目录更改为始终复制
*   将***version.txt***添加到您的***.gitignore***文件中

## 读取嵌入的文本文件版本字符串

下面是一些读取嵌入文本文件版本字符串的示例代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.IO;
using System.Reflection;

namespace TryGitDescribe
{
    class Program
    {
        static void Main(string[] args)
        {
            string gitVersion= String.Empty;
            using (Stream stream = Assembly.GetExecutingAssembly()
                    .GetManifestResourceStream("TryGitDescribe." + "version.txt"))
            using (StreamReader reader = new StreamReader(stream))
            {
                gitVersion= reader.ReadToEnd();
            }

            Console.WriteLine("Version: {0}", gitVersion);
            Console.WriteLine("Hit any key to continue");
            Console.ReadKey();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：80
> 
> 时间：2017-07-21T23:23:54.723

更新：

自从我最初回答这个问题以来，事情已经发生了变化。如果满足某些条件，`Microsoft.NET.Sdk`（意味着您必须使用 sdk 样式的项目）现在包括支持将提交哈希添加到程序集信息版本以及 nuget 包元数据：

1.  `<SourceRevisionId>`必须定义属性。这可以通过添加这样的目标来完成：

```
<Target Name="SetSourceRevisionId" BeforeTargets="InitializeSourceControlInformation">
    <Exec 
      Command="git describe --long --always --dirty --exclude=* --abbrev=8"
      ConsoleToMSBuild="True"
      IgnoreExitCode="False"
      >
      <Output PropertyName="SourceRevisionId" TaskParameter="ConsoleOutput"/>
    </Exec>
  </Target> 
```

此目标执行将设置`SourceRevisionId`为缩写（8 个字符）哈希的命令。BeforeTargets 导致它在创建程序集信息版本之前运行。

2.  要在 nuget 包元数据中包含哈希，`<RepositoryUrl>`还必须定义 。

3.  `<SourceControlInformationFeatureSupported>`property must be `true`，这会导致 nuget pack 任务也获取 SourceRevisionId。

我会引导人们远离使用 MSBuildGitHash 包，因为这种新技术更干净且最一致。

原来的：

我创建了一个简单的 nuget 包，您可以将其包含在您的项目中，它将为您解决这个问题：[https ://www.nuget.org/packages/MSBuildGitHash/](https://www.nuget.org/packages/MSBuildGitHash/)

这个 nuget 包实现了一个“纯”的 MSBuild 解决方案。如果您不想依赖 nuget 包，您可以简单地将这些目标复制到您的 csproj 文件中，它应该包含 git 哈希作为自定义程序集属性：

```
<Target Name="GetGitHash" BeforeTargets="WriteGitHash" Condition="'$(BuildHash)' == ''">
  <PropertyGroup>
    <!-- temp file for the git version (lives in "obj" folder)-->
    <VerFile>$(IntermediateOutputPath)gitver</VerFile>
  </PropertyGroup>

  <!-- write the hash to the temp file.-->
  <Exec Command="git -C $(ProjectDir) describe --long --always --dirty &gt; $(VerFile)" />

  <!-- read the version into the GitVersion itemGroup-->
  <ReadLinesFromFile File="$(VerFile)">
    <Output TaskParameter="Lines" ItemName="GitVersion" />
  </ReadLinesFromFile>
  <!-- Set the BuildHash property to contain the GitVersion, if it wasn't already set.-->
  <PropertyGroup>
    <BuildHash>@(GitVersion)</BuildHash>
  </PropertyGroup>    
</Target>

<Target Name="WriteGitHash" BeforeTargets="CoreCompile">
  <!-- names the obj/.../CustomAssemblyInfo.cs file -->
  <PropertyGroup>
    <CustomAssemblyInfoFile>$(IntermediateOutputPath)CustomAssemblyInfo.cs</CustomAssemblyInfoFile>
  </PropertyGroup>
  <!-- includes the CustomAssemblyInfo for compilation into your project -->
  <ItemGroup>
    <Compile Include="$(CustomAssemblyInfoFile)" />
  </ItemGroup>
  <!-- defines the AssemblyMetadata attribute that will be written -->
  <ItemGroup>
    <AssemblyAttributes Include="AssemblyMetadata">
      <_Parameter1>GitHash</_Parameter1>
      <_Parameter2>$(BuildHash)</_Parameter2>
    </AssemblyAttributes>
  </ItemGroup>
  <!-- writes the attribute to the customAssemblyInfo file -->
  <WriteCodeFragment Language="C#" OutputFile="$(CustomAssemblyInfoFile)" AssemblyAttributes="@(AssemblyAttributes)" />
</Target> 
```

这里有两个目标。第一个，“GetGitHash”，将 git 哈希加载到名为 BuildHash 的 MSBuild 属性中，*只有*在尚未定义 BuildHash 时才会这样做。如果您愿意，这允许您在命令行上将其传递给 MSBuild。您可以像这样将它传递给 MSBuild：

`MSBuild.exe myproj.csproj /p:BuildHash=MYHASHVAL`

第二个目标“WriteGitHash”会将哈希值写入名为“CustomAssemblyInfo.cs”的临时“obj”文件夹中的文件。该文件将包含如下所示的一行：

`[assembly: AssemblyMetadata("GitHash", "MYHASHVAL")]`

此 CustomAssemblyInfo.cs 文件将编译到您的程序集中，因此您可以使用反射`AssemblyMetadata`在运行时查找。`AssemblyInfo`以下代码显示了当类包含在同一个程序集中时如何做到这一点。

```
using System.Linq;
using System.Reflection;

public static class AssemblyInfo
{
    /// <summary> Gets the git hash value from the assembly
    /// or null if it cannot be found. </summary>
    public static string GetGitHash()
    {
        var asm = typeof(AssemblyInfo).Assembly;
        var attrs = asm.GetCustomAttributes<AssemblyMetadataAttribute>();
        return attrs.FirstOrDefault(a => a.Key == "GitHash")?.Value;
    }
} 
```

这种设计的一些好处是它不会触及项目文件夹中的任何文件，所有变异的文件都在“obj”文件夹下。您的项目也将在 Visual Studio 中或从命令行以相同方式构建。它也可以轻松地为您的项目定制，并将与您的 csproj 文件一起进行源代码控制。

* * *

## 回答 #3

> 赞同：68
> 
> 时间：2013-02-28T19:14:54.387

我们在 git 中使用标签来跟踪版本。

```
git tag -a v13.3.1 -m "version 13.3.1" 
```

您可以通过以下方式从 git 获取带有哈希的版本：

```
git describe --long 
```

我们的构建过程将 git 哈希放在 AssemblyInfo.cs 文件的 AssemblyInformationalVersion 属性中：

```
[assembly: AssemblyInformationalVersion("13.3.1.74-g5224f3b")] 
```

编译后，您可以从 windows 资源管理器中查看版本：

![在此处输入图像描述](../Images/e672c72118498d49d8182ae34feeadfc.png)

您还可以通过以下方式以编程方式获取它：

```
var build = ((AssemblyInformationalVersionAttribute)Assembly
  .GetAssembly(typeof(YOURTYPE))
  .GetCustomAttributes(typeof(AssemblyInformationalVersionAttribute), false)[0])
  .InformationalVersion; 
```

其中 YOURTYPE 是程序集中具有 AssemblyInformationalVersion 属性的任何类型。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2015-03-23T12:04:37.627

另一种方法是使用带有一些 On-Board Visual Studio 魔法的[NetRevisionTool 。](https://github.com/dg9ngf/NetRevisionTool)我将在此处为 Visual Studio 2013 专业版展示这一点，但这也适用于其他版本。

所以首先下载NetRevisionTool。您将 NetRevisionTool.exe 包含在您的 PATH 中或将其签入您的存储库并创建一个 Visual Studio 预构建和构建后操作并更改您的 AssemblyInfo.cs。

将您的 git-hash 添加到您的 AssemblyInformationVersion 的示例如下：在您的项目设置中：

![在此处输入图像描述](../Images/6bccab5225ca39f832e9e5bec2cf6012.png)

在您项目的 AssemblyInfo.cs 中，您更改/添加以下行：

[程序集：AssemblyInformationalVersion("1.1.{dmin:2015}.{chash:6}{!}-{branch}")]

在显示的屏幕截图中，我在 External/bin 文件夹中检查了 NetRevisionTool.exe

构建后，如果您然后右键单击二进制文件并转到属性，那么您应该会看到如下内容：

![在此处输入图像描述](../Images/590c79184642b1075455a69c13d9a192.png)

希望这可以帮助那里的人

* * *

## 回答 #5

> 赞同：14
> 
> 时间：2016-09-22T20:50:47.883

我认为这个问题值得一步一步给出完整的答案。这里的策略是从预构建事件中运行一个 powershell 脚本，该脚本接受一个模板文件并生成一个 AssemblyInfo.cs 文件，其中包含 git 标记 + 提交计数信息。

**第 1 步：**在 Project\Properties 文件夹中创建一个 AssemblyInfo_template.cs 文件，基于您原来的 AssemblyInfo.cs，但包含：

```
[assembly: AssemblyVersion("$FILEVERSION$")]
[assembly: AssemblyFileVersion("$FILEVERSION$")]
[assembly: AssemblyInformationalVersion("$INFOVERSION$")] 
```

**第 2 步：**创建一个名为 InjectGitVersion.ps1 的 powershell 脚本，其来源为：

```
# InjectGitVersion.ps1
#
# Set the version in the projects AssemblyInfo.cs file
#

# Get version info from Git. example 1.2.3-45-g6789abc
$gitVersion = git describe --long --always;

# Parse Git version info into semantic pieces
$gitVersion -match '(.*)-(\d+)-[g](\w+)$';
$gitTag = $Matches[1];
$gitCount = $Matches[2];
$gitSHA1 = $Matches[3];

# Define file variables
$assemblyFile = $args[0] + "\Properties\AssemblyInfo.cs";
$templateFile =  $args[0] + "\Properties\AssemblyInfo_template.cs";

# Read template file, overwrite place holders with git version info
$newAssemblyContent = Get-Content $templateFile |
    %{$_ -replace '\$FILEVERSION\$', ($gitTag + "." + $gitCount) } |
    %{$_ -replace '\$INFOVERSION\$', ($gitTag + "." + $gitCount + "-" + $gitSHA1) };

# Write AssemblyInfo.cs file only if there are changes
If (-not (Test-Path $assemblyFile) -or ((Compare-Object (Get-Content $assemblyFile) $newAssemblyContent))) {
    echo "Injecting Git Version Info to AssemblyInfo.cs"
    $newAssemblyContent > $assemblyFile;       
} 
```

**第 3 步：**将 InjectGitVersion.ps1 文件保存到 BuildScripts 文件夹中的解决方案目录中

**第 4 步：**将以下行添加到项目的 Pre-Build 事件中

```
powershell -ExecutionPolicy ByPass -File  $(SolutionDir)\BuildScripts\InjectGitVersion.ps1 $(ProjectDir) 
```

**第 5 步：**构建您的项目。

**第 6 步：（**可选）将 AssemblyInfo.cs 添加到您的 git 忽略文件

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2020-01-24T16:48:48.597

现在，使用[.NET Revision Task for MSBuild](https://unclassified.software/en/apps/netrevisiontask)和使用 Visual Studio 2019 非常容易。

只需安装[NuGet](https://www.nuget.org/packages/Unclassified.NetRevisionTask)包**Unclassified.NetRevisionTask**，然后按照[GitHub 文档](https://github.com/jeromerg/NGitVersion)`AssemblyInfo.cs`中的说明在文件中配置所需的信息。

如果您只想要最后一次提交的哈希（长度=8）：

```
[assembly: AssemblyInformationalVersion("1.0-{chash:8}")] 
```

构建您的项目/解决方案，您将拥有如下内容：

[![在此处输入图像描述](../Images/284f3241c854b1dded6658d450371217.png)](https://i.stack.imgur.com/6Z5Rd.jpg)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-02-28T18:46:42.870

由于另一个答案已经提到了 git 位，一旦您拥有 SHA，您可以考虑`AssemblyInfo.cs`在预构建挂钩中生成项目文件。

一种方法是创建一个`AssemblyInfo.cs.tmpl`模板文件，在 $$GITSHA$$ 中为您的 SHA 提供一个占位符，例如

```
[assembly: AssemblyDescription("$$GITSHA$$")] 
```

然后，您的预构建挂钩必须替换此占位符并输出 AssemblyInfo.cs 文件以供 C# 编译器拾取。

要了解如何使用 SubWCRev for SVN 完成此操作，请参阅[此答案](https://stackoverflow.com/questions/1621663/assemblyinfo-cs-subversion-and-tortoisesvn)。为 git 做类似的事情应该不难。

如前所述，其他方式将是“制作阶段”，即编写一个执行类似操作的 MSBuild 任务。另一种方法可能是以某种方式对 DLL 进行后处理（ildasm+ilasm 说），但我认为上面提到的选项可能是最简单的。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2016-12-17T15:18:59.993

对于完全自动化和灵活的方法检查[https://github.com/Fody/Stamp](https://github.com/Fody/Stamp)。我们已经成功地将它用于我们的 Git 项目（以及用于 SVN 项目的[这个版本）](https://github.com/krk/Stamp)

**更新：这是过时的，因为 Stamp.Fody 不再维护**

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2016-12-02T08:10:29.450

您可以使用 powershell one-liner 使用提交哈希更新所有 assemblyinfo 文件。

```
$hash = git describe --long --always;gci **/AssemblyInfo.* -recurse | foreach { $content = (gc $_) -replace "\[assembly: Guid?.*", "$&`n[assembly: AssemblyMetadata(`"commithash`", `"$hash`")]" | sc $_ } 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2013-02-28T18:30:12.443

1.  我希望您知道如何在构建时调用外部程序并拦截输出。
2.  我希望你知道如何在 git 的工作目录中忽略未版本控制的文件。

正如@learath2 所指出的，输出`git rev-parse HEAD`将为您提供纯哈希。

如果您在 Git-repository 中使用标签（并且您使用标签，是不是比 更具描述性和可读性[`git rev-parse`](http://www.kernel.org/pub/software/scm/git/docs/git-rev-parse.html)），可能会收到输出[`git describe`](http://www.kernel.org/pub/software/scm/git/docs/git-describe.html)（同时也可以在稍后成功使用`git checkout`）

您可以在以下位置调用 rev-parse|describe：

*   一些制作舞台
*   在提交后挂钩中
*   在涂抹过滤器中，如果您选择[涂抹/清洁过滤器](http://git-scm.com/book/ch7-2.html)的实现方式

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2021-09-22T14:12:18.113

*   打开`.csproj`并添加`<GenerateAssemblyInfo>false</GenerateAssemblyInfo>`到第一个`PropertyGroup`
    *   您可能希望复制文件夹中已经生成的内容，`AssemblyInfo.cs`这样`obj`您就不必自己编写所有内容。
*   在属性文件夹中创建`AssemblyInfo.tt`（T4 模板）。
*   粘贴以下内容+您之前自动生成的旧内容`AssemblyInfo.cs`

```
<#@ template debug="true" hostspecific="True" language="C#" #>
<#@ assembly name="System.Core" #>
<# /*There's a bug with VS2022 where you have to be real specific about envDTE.*/ #>
<#@ assembly name="./PublicAssemblies/envdte.dll" #>  
<#@ import namespace="System.IO" #>
<#@ import namespace="System.Text.RegularExpressions" #>
<#@ import namespace="System.Globalization" #>
<#@ output extension=".cs" #>
<#
    var dte = ((IServiceProvider)this.Host).GetService(typeof(EnvDTE.DTE)) as EnvDTE.DTE;
    string buildConfig = dte.Solution.SolutionBuild.ActiveConfiguration.Name;
    string solutionDirectory = Path.GetDirectoryName(dte.Solution.FullName);

    var (gitRevision, gitBranch, gitCompactRevision) = ("", "", "");

    using(var process = new System.Diagnostics.Process() {
        StartInfo = new System.Diagnostics.ProcessStartInfo() {
            WorkingDirectory = solutionDirectory,
            FileName = @"cmd.exe",
            Arguments = "/C git rev-parse HEAD & git rev-parse --abbrev-ref HEAD",
            RedirectStandardError = true,
            RedirectStandardOutput = true,
            UseShellExecute = false,
            CreateNoWindow = true
        }
    }) {
        process.Start();
        string[] lines = process.StandardOutput.ReadToEnd().Split();
        gitRevision = lines[0].Trim();
        gitBranch = lines[1].Trim();
        gitCompactRevision = gitRevision.Substring(0, 6);
    }
    string appPurpose         = "Launcher"; // & Updater
    string companyShort       = "todo";
    string companyFull        = "todo";
    string productNameShort   = "todo";
    string productName        = $"{companyShort} {productNameShort}";
    string fileName           = $"{companyShort}{productNameShort}";
    string exeNAME            = $"{fileName}Launch";
    string originalFilename   = $"{exeNAME}.exe";
    string CALLEXE            = $"{fileName}.exe";
    string BROWSEREXE         = $"{fileName}Browser.exe";
    string FULLINSTALLER      = $"{fileName}Setup.exe";

    DateTime dtBuiltDate      = DateTime.UtcNow;
    string cBuildYear         = dtBuiltDate.Year.ToString();
    string cBuildDay          = dtBuiltDate.ToString("dd");
    string cBuildMonth        = dtBuiltDate.ToString("MM");
    string cBuildTime         = dtBuiltDate.ToString("T", DateTimeFormatInfo.InvariantInfo);
    string assemblyVersion    = $"3.0.{cBuildYear}.{cBuildMonth}{cBuildDay}";

    string JOB_NAME           = System.Environment.GetEnvironmentVariable("JOB_NAME") ?? "0.0";
    string buildVersion       = System.Environment.GetEnvironmentVariable("BUILD_NUMBER") ?? "0-dev";
    string buildSeries        = Regex.Replace(JOB_NAME, @"[^0-9\.]+", "");
    string buildNumber        = Regex.Replace(buildVersion, @"[^0-9\.]+", "");
    string InternalVersion    = $"{JOB_NAME}.{buildVersion}";
    string fileVersion        = Regex.Replace(InternalVersion, @"[^0-9\.]+", "");
#>
using System.Reflection;

[assembly: System.Runtime.InteropServices.ComVisible(false)]
[assembly: System.Resources.NeutralResourcesLanguageAttribute("en")]
[assembly: AssemblyConfigurationAttribute("<#= buildConfig #>")]
[assembly: AssemblyProduct("<#= productName #>")]
[assembly: AssemblyTitle("<#= $"{companyShort}{productNameShort}" #>")]
[assembly: AssemblyCompany("<#= companyFull #>")]
[assembly: AssemblyDescription("<#= $"{companyShort} {productNameShort} .... {appPurpose} - ...... by {companyFull}" #>")]
[assembly: AssemblyCopyright("<#= $"© 1983-{cBuildYear} {companyFull}" #>")]
[assembly: AssemblyTrademark("<#= $"{productName} is a trademark of {companyFull}, Inc." #>")]
[assembly: AssemblyInformationalVersion("<#= InternalVersion #>")]
[assembly: AssemblyVersion("<#= assemblyVersion #>")]
[assembly: AssemblyFileVersion("<#= fileVersion #>")]
[assembly: AssemblyMetadataAttribute("OriginalFilename",    "<#= originalFilename #>")]
[assembly: AssemblyMetadataAttribute("NAME",                "<#= $"{productName} {appPurpose}" #>")]
[assembly: AssemblyMetadataAttribute("EXENAME",             "<#= exeNAME #>")]
[assembly: AssemblyMetadataAttribute("DIRNAME",             "<#= productNameShort #>")]
[assembly: AssemblyMetadataAttribute("CALLEXE",             "<#= $"{fileName}.exe" #>")]
[assembly: AssemblyMetadataAttribute("BROWSEREXE",          "<#= $"{fileName}Browser.exe" #>")]
[assembly: AssemblyMetadataAttribute("FULLINSTALLER",       "<#= $"{fileName}Setup.exe" #>")]
[assembly: AssemblyMetadataAttribute("COMPANY",             "<#= companyFull #>")]
[assembly: AssemblyMetadataAttribute("License",             "<#= $"Contains copyrighted code and applications ..." #>")]
[assembly: AssemblyMetadataAttribute("TermsOfUse",          "<#= "https://www.company.com/en-us/terms-of-use/" #>")]
[assembly: AssemblyMetadataAttribute("Website",             "<#= "https://www.company.com/en-us" #>")]
[assembly: AssemblyMetadataAttribute("UpdateURL",           "https://subdomain.product.net/version_check")]

[assembly: AssemblyMetadataAttribute("BuildYear",           "<#= cBuildYear #>")]
[assembly: AssemblyMetadataAttribute("BuildDay",            "<#= cBuildDay #>")]
[assembly: AssemblyMetadataAttribute("BuildMonth",          "<#= cBuildMonth #>")]
[assembly: AssemblyMetadataAttribute("BuildTime",           "<#= cBuildTime #>")]
[assembly: AssemblyMetadataAttribute("DateModified",        "<#= $"{dtBuiltDate.ToString("MMM dd, yyyy", DateTimeFormatInfo.InvariantInfo)} at {cBuildTime}" #>")]

[assembly: AssemblyMetadataAttribute("BuildSeries",         "<#= buildSeries #>")]
[assembly: AssemblyMetadataAttribute("BuildNumber",         "<#= buildNumber #>")]
[assembly: AssemblyMetadataAttribute("BuildDate",           "<#= dtBuiltDate.ToString("s") #>")]
[assembly: AssemblyMetadataAttribute("BuildMachine",        "<#= Environment.MachineName #>")]
[assembly: AssemblyMetadataAttribute("BuildMachineUser",    "<#= Environment.UserName #>")]
[assembly: AssemblyMetadataAttribute("BuildOSVersion",      "<#= Environment.OSVersion #>")]
[assembly: AssemblyMetadataAttribute("BuildPlatform",       "<#= Environment.OSVersion.Platform #>")]
[assembly: AssemblyMetadataAttribute("BuildClrVersion",     "<#= Environment.Version #>")]

[assembly: AssemblyMetadataAttribute("BuildBranch",         "<#= gitBranch #>")]
[assembly: AssemblyMetadataAttribute("BuildRevision",       "<#= gitCompactRevision #>")]
[assembly: AssemblyMetadataAttribute("CommitHash",          "<#= gitRevision #>")]
[assembly: AssemblyMetadataAttribute("RepositoryUrl",       "")]
[assembly: AssemblyMetadataAttribute("RepositoryType",      "")]
<#+

#> 
```

您现在可以使用 C# 的全部功能来生成您想要的任何内容，例如您当前所在的 git 分支和修订版。一些技巧：

*   变量可以在`<# #>`块内的任何地方声明
*   您希望使用的任何方法都必须在文件末尾的`<#+ #>`块中声明。（`+`标志很重要，必须是文件末尾的最后一件事））
*   块之外的所有内容`<# #>`都只是纯文本。
*   VS2019 没有语法高亮或智能感知。该`.tt`文件是纯文本。我建议在安装`T4 Support`扩展后使用 vscode 编辑它（在 vs2019 中不可用...）

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2017-05-31T07:34:49.537

我正在使用已接受的答案和一个小补充的组合。我安装了 AutoT4 扩展（[https://marketplace.visualstudio.com/items?itemName=BennorMcCarthy.AutoT4](https://marketplace.visualstudio.com/items?itemName=BennorMcCarthy.AutoT4)）以在构建之前重新运行模板。

# 从 GIT 获取版本

我`git -C $(ProjectDir) describe --long --always > "$(ProjectDir)git_version.txt"`在项目属性中的预构建事件中有。将 git_version.txt 和 VersionInfo.cs 添加到 .gitignore 是一个不错的主意。

# 在元数据中嵌入版本

我`VersionInfo.tt`在我的项目中添加了一个模板：

```
<#@ template debug="false" hostspecific="true" language="C#" #>
<#@ assembly name="System.Core" #>
<#@ import namespace="System.Linq" #>
<#@ import namespace="System.Text" #>
<#@ import namespace="System.Collections.Generic" #>
<#@ import namespace="System.IO" #>
<#@ output extension=".cs" #>

using System.Reflection;
using System.Runtime.CompilerServices;
using System.Runtime.InteropServices;

<#
if (File.Exists(Host.ResolvePath("git_version.txt")))
{
    Write("[assembly: AssemblyInformationalVersion(\""+ File.ReadAllText(Host.ResolvePath("git_version.txt")).Trim() + "\")]");
}else{
    Write("// version file not found in " + Host.ResolvePath("git_version.txt"));
}

#> 
```

现在我在“ProductVersion”中有我的 git 标签 + 哈希。

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2018-08-01T11:00:45.563

另一种方法是从 Pre-Build 步骤生成一个 Version.cs 文件。我在一个小的概念验证项目中对此进行了探索，该项目打印出其当前的提交哈希。

Tha 项目已上传到[https://github.com/sashoalm/GitCommitHashPrinter](https://github.com/sashoalm/GitCommitHashPrinter)。

创建 Version.cs 文件的批处理代码是这样的：

```
@echo off

echo "Writing Version.cs file..."

@rem Pushd/popd are used to temporarily cd to where the BAT file is.
pushd $(ProjectDir)

@rem Verify that the command succeeds (i.e. Git is installed and we are in the repo).
git rev-parse HEAD || exit 1

@rem Syntax for storing a command's output into a variable (see https://stackoverflow.com/a/2340018/492336).
@rem 'git rev-parse HEAD' returns the commit hash.
for /f %%i in ('git rev-parse HEAD') do set commitHash=%%i

@rem Syntax for printing multiline text to a file (see https://stackoverflow.com/a/23530712/492336).
(
echo namespace GitCommitHashPrinter
echo {
echo     class Version
echo     {
echo         public static string CommitHash { get; set; } = "%commitHash%";
echo     }
echo }
)>"Version.cs"

popd 
```

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2017-07-04T22:20:40.310

参考另一个答案（[https://stackoverflow.com/a/44278482/4537127](https://stackoverflow.com/a/44278482/4537127)），我还利用`VersionInfo.tt`文本模板在`AssemblyInformationalVersion`没有 AutoT4 的情况下生成。

（至少在我的 C# WPF 应用程序中工作）

问题是预构建事件是在模板转换之后运行的，所以在克隆之后，`git_version.txt`文件不存在并且构建失败。在手动创建它以允许转换通过一次之后，它在转换后被更新，并且总是*落后于*.

我必须对 .csproj 文件进行两次调整（这至少适用于 Visual Studio Community 2017）

1）导入文本转换目标并进行模板转换以在每个构建上运行：（参考[https://msdn.microsoft.com/en-us/library/ee847423.aspx](https://msdn.microsoft.com/en-us/library/ee847423.aspx)）

```
<PropertyGroup>
    <VisualStudioVersion Condition="'$(VisualStudioVersion)' == ''">15.0</VisualStudioVersion>
    <VSToolsPath Condition="'$(VSToolsPath)' == ''">$(MSBuildExtensionsPath32)\Microsoft\VisualStudio\v$(VisualStudioVersion)</VSToolsPath>
    <TransformOnBuild>true</TransformOnBuild>
    <TransformOutOfDateOnly>false</TransformOutOfDateOnly>
</PropertyGroup> 
```

之后`<Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />`

```
<Import Project="$(VSToolsPath)\TextTemplating\Microsoft.TextTemplating.targets" /> 
```

2）`git describe`在模板转换之前运行（以便在转换`git_version.txt`时存在`VersionInfo.tt`）：

```
<Target Name="PreBuild" BeforeTargets="ExecuteTransformations">
  <Exec Command="git -C $(ProjectDir) describe --long --always --dirty &gt; $(ProjectDir)git_version.txt" />
</Target> 
```

..以及获取的 C# 代码`AssemblyInformationalVersion`（参考[https://stackoverflow.com/a/7770189/4537127](https://stackoverflow.com/a/7770189/4537127)）

```
public string AppGitHash
{
    get
    {
        AssemblyInformationalVersionAttribute attribute = (AssemblyInformationalVersionAttribute)Assembly.GetExecutingAssembly().GetCustomAttributes(typeof(AssemblyInformationalVersionAttribute), false).FirstOrDefault();

        return attribute.InformationalVersion;
    }
} 
```

..并将生成的文件添加到 .gitignore

```
VersionInfo.cs
git_version.txt 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-08-18T14:56:24.373

受到@John Jesus 回答的极大启发，我创建了一个在每个 Build 上运行的 Powershell v1 脚本，以将 Assembly Version 调整为当前的 Git 标签。

## Powershell 脚本

```
# Get build running directory
$scriptPath = split-path -parent $MyInvocation.MyCommand.Path
try {
    $v = git describe --tags
}
catch [System.Management.Automation.CommandNotFoundException] {
    # Git not found
    exit
}

# Letters are incompatible with AssemblyVersion.cs so we remove them
$v = $v -replace "v", ""
# Version format is major[.minor[.build[.revision]] so we remove them
$v = $v -replace "-(\D.*)", ''
$v = $v -replace "-", '.'

# We replace versions inside AssemblyInfo.cs content
$info = (Get-Content ($scriptPath + "/properties/AssemblyInfo.cs"))
$av = '[assembly: AssemblyVersion("'+$v+'")]'
$avf = '[assembly: AssemblyFileVersion("'+$v+'")]'
$info = $info -replace '\[assembly: AssemblyVersion\("(.*)"\)]', $av
$info = $info -replace '\[assembly: AssemblyFileVersion\("(.*)"\)]', $avf
Set-Content -Path ($scriptPath + "/properties/AssemblyInfo.cs") -Value $info -Encoding UTF8 
```

将其放置在您的解决方案文件夹中并设置一个 Prebuild Event 来启动它： [![预建事件](../Images/ff58c36d2488f7fe4cf129959a4921d0.png)](https://i.stack.imgur.com/k82Uk.png)

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2020-02-17T06:15:09.143

地方

```
<Target Name="UpdateVersion" BeforeTargets="CoreCompile">
  <Exec Command="php &quot;$(SolutionDir)build.php&quot; $(SolutionDir) &quot;$(ProjectDir)Server.csproj&quot;" />
</Target> 
```

在`YOUR_PROJECT_NAME.csproj`

```
<?php

function between(string $string, string $after, string $before, int $offset = 0) : string{
    return substr($string, $pos = strpos($string, $after, $offset) + strlen($after),
        strpos($string, $before, $pos) - $pos);
}

$pipes = [];
$proc = proc_open("git rev-parse --short HEAD", [
    0 => ["pipe", "r"],
    1 => ["pipe", "w"],
    2 => ["pipe", "w"]
], $pipes, $argv[1]);

if(is_resource($proc)){
    $rev = stream_get_contents($pipes[1]);
    proc_close($proc);
}

$manifest = file_get_contents($argv[2]);
$version = between($manifest, "<Version>", "</Version>");
$ver = explode("-", $version)[0] . "-" . trim($rev);
file_put_contents($argv[2], str_replace($version, $ver, $manifest));

echo "New version generated: $ver" . PHP_EOL; 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2022-03-04T13:26:26.080

我将这些文件部署在我们的开发/登台系统上以快速查看：

```
git.exe -C "$(ProjectDir.TrimEnd('\'))" describe --long > "$(ProjectDir)_Version.info": 
```

我的结果：10.02.0.3-247-gbeeadd082

```
git.exe -C "$(ProjectDir.TrimEnd('\'))" branch --show-current > "$(ProjectDir)_Branch.info" 
```

我的结果：功能/JMT-3931-jaguar

（Visual Studio PreBuild 事件）

# java - Android 创建目录层次结构

> ID：15141342
> 
> 赞同：2
> 
> 时间：2013-02-28T17:01:00.343
> 
> 标签：java, android, file, directory

我以编程方式创建了一个目录并插入了照片：

```
File dirGallery = context.getDir("Gallery", Context.MODE_PRIVATE);
File fileWithinMyDir = new File(dirGallery, photo);
... 
```

这是有效的！

但现在我想在我现有的目录“画廊”中创建一个目录并插入其他照片。我试过了 ：

```
File dirGallery = context.getDir("Gallery/Gallery2", Context.MODE_PRIVATE); 
```

但我得到“文件...包含路径分隔符”。

我也试过：

```
File dirGallery = context.getDir("Gallery", Context.MODE_PRIVATE);
dirGallery.mkdir();
File dirGallery2 = new File(dirGallery,"Gallery2");
dirGallery2.mkdir();
File fileWithinMyDir = new File(dirGallery2, nomPhoto); 
```

当我得到我的文件时：

```
File dirGallery = context.getDir("Gallery", Context.MODE_PRIVATE);
File dirGallery2 = new File(dirGallery,"Gallery2");
File[] listImages = dirGallery2.listFiles(filter); 
```

但是 listImages 是空的。我在哪里失败了？

泰

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T18:34:26.230

而不是这样写：

```
File dirRecipe = context.getDir("Gallery/Gallery2", Context.MODE_PRIVATE); 
```

尝试这个：

```
File dirRecipe = context.getDir("Gallery"+File.separator+"Gallery2", Context.MODE_PRIVATE); 
```

这应该根据需要在文件夹内创建文件夹。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-05-21T17:13:25.433

您不能将目录结构（例如 a/b/c）传递给 GetDir()，但以下内容将起作用：

```
 File dir = getFilesDir();
    File dir2 = new File(dir, "test1/test2");
    dir2.mkdirs(); 
```

这将创建目录结构

/data/data/com.somename.someclass/files/test1/test2

# timeout - 使用毫秒计时器的Arduino“超时”功能

> ID：15141344
> 
> 赞同：1
> 
> 时间：2013-02-28T17:01:03.610
> 
> 标签：timeout, arduino

我编程的时间不长，我只想使用 Arduino UNO 板扩展电子工程。

我已经开始了一个基于 Steve Hoefer 在 Grathio 上的 Secret Knock Detecting Door Lock 的新项目，我想实现以下内容：

( [http://grathio.com/2009/11/secret_knock_detecting_door_lock/](http://grathio.com/2009/11/secret_knock_detecting_door_lock/) ) ( [http://grathio.com/assets/secret_knock_detector.pde](http://grathio.com/assets/secret_knock_detector.pde) )

### 执行

如果全局值等于 0 并且有效的敲击模式为真，则使用毫秒而不是延迟使黄色 LED 闪烁 4 次，以便它仍然可以“收听”。

如果在 6 秒内未听到另一个有效的爆震模式，它将超时并将全局重置为 0，以便它可以确认初始真实模式并闪烁黄色 LED。

如果在 6 秒内听到另一个有效的敲击模式，则增加一个计数器。

如果计数器等于 1，则等待另一个有效的敲击模式，如果在 6 秒内为真，则再次增加计数器并且不闪烁黄色 LED。

否则，超时并重置所有值。

依此类推，直到计数器大于或等于 4 时触发主 LED 阵列。

一旦成功敲击 4 次，我希望它触发我构建的主 LED 阵列。

### 问题

该项目的灵感来自客机上使用的测试面板。我见过他们很多，并认为这将是一个开始和了解时间的好地方。

有一些问题，因为我不希望每次都重置 millis() 并且我使用的是按钮而不是爆震检测脚本中的布尔值，所以我不会迷失在代码中。

我知道这不会在 50 秒后响应，这是一个初学者的错误，但如果我按住按钮证明了我所拥有的。下面的代码在第一次 digitalRead HIGH 或 true boolean 之后也没有超时（我正在为此苦苦挣扎）。

### 阿杜诺素描

```
 int inPin = 2;         // input pin switch
    int outPin = 3;       // output pin LED

    long currentTime = 0; // counter
    long nextTime = 0; // counter
    long lastTime = 0; // counter

    int patternCounter = 0; // build up 
    int globalValue = 0; // lock out
    int breakIn = 0; // waste of time?

    void setup()
    {
      pinMode(inPin, INPUT);
      pinMode(outPin, OUTPUT);
      Serial.begin(9600);
      Serial.println("GO");
    }

    void loop(){

      // boolean true, switch just for testing
      if (digitalRead(inPin)==HIGH&&globalValue==0&&breakIn==0) { 
        Serial.println("CLEARED 1st");
        delay (500); // flood protection
        globalValue++;
        breakIn++;
        if (globalValue>0&&breakIn>0){ 
          currentTime = millis(); // start a 'new' counter and 'listen'
          if (currentTime<6000) { // less than
            if (digitalRead(inPin)==HIGH) { // and true
              Serial.println("CLEARED 2nd"); // cleared the stage
              delay (500); // flood protection 
              patternCounter++;
            } // if counter less
          } // if true or high
          if (currentTime>6000) {
            Serial.println("TIMEOUT waiting 2nd"); // timed out
            globalValue = 0;
            patternCounter = 0;
            breakIn = 0;
          } // if more than
        } // global master
      }

      // 3rd attempt
      if (globalValue==1&&patternCounter==1){ // third round
        nextTime = millis(); // start a 'new' counter and 'listen'
        if (nextTime<6000) { // less than
          if (digitalRead(inPin)==HIGH) { // and true
            Serial.println("CLEARED 3rd");
            delay (500); // flood protection
            patternCounter++;
          } // if counter less
        } // if true or high
        if (nextTime>6000) {
          Serial.println("TIMEOUT waiting 3rd"); // timed out
          globalValue = 0;
          patternCounter = 0;
        } // if more than
       } // global master

      // 4th attempt and latch
      if (globalValue==1&&patternCounter==2){ // last round 
        lastTime = millis(); // start a 'new' counter and 'listen'
        if (lastTime<6000) { // less than
          if (digitalRead(inPin)==HIGH) { // and true
            digitalWrite(outPin, HIGH); // LED on
            Serial.println("CLEARED 4th ARRAY"); // cleared the stage
            delay(500); // flood protection
          } // true or high
        } // counter
        if (lastTime>6000) {
          Serial.println("TIMEOUT waiting 4th"); // timed out
          globalValue = 0;
          patternCounter = 0;
        } // if more than
       } // global and alarm

       } // loop end 
```

这是当前的草图，我知道我使用的计数器几乎毫无意义。

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T17:40:33.053

这是一个很大的问题，所以我可能不明白你的问题，但下面的代码是一个问题：

```
 currentTime = millis(); // start a 'new' counter and 'listen'
      if (currentTime<6000) { // less than

      .....
      } 
```

您是否了解没有`millis()`可能的“重置”，而这仅仅是一个返回程序启动以来毫秒数的函数？只要程序正在运行，它就会继续增加（直到它翻转，但这是一个单独的问题）。因此，在上面的代码中，'currentTime' 只会非常非常短暂地小于 6000（6 秒），然后再也不会（除了毫秒重置的翻转条件）。

`millis()`因此，一种用于跟踪时间的典型方法是`setup`将其当前值存储到一个变量中，并将您的超时时间值添加到其中：

```
// timeoutAmount is defined at head of program. Let's say it is 6000 (6 seconds)
nextUpdate = millis() + timeoutAmount; 
```

然后`loop`你可以做检查：

```
if (millis() >= nextUpdate){
  nextUpdate = millis() + timeoutAmount; // set up the next timeout period

 // do whatever you want to do

} 
```

还要小心使用`delay()`- 它很容易用于流量控制，但对于任何有不止一件事的程序，它可能会导致混乱和难以解决的问题。

哦 - 使用芯片上的内置计时器触发中断有更复杂的计时方法，但最好先掌握事情的窍门。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T18:08:36.317

在你的帮助下，我想出了下面的草图。

草图几乎可以完成我想要的一切......

当它在第 1 次、第 2 次（inCount = 1）或第 3 次（inCount = 2）按钮按下后超时（T/O）时，我希望它恢复到开始，而不必再次按下它并循环 triggerFlash 两次.

要么在超时内实施另一个“等待和倾听”，以​​将其移动到第二个（inCount = 1）等，但我认为这可能会导致问题。

我知道闪光灯中使用了延迟，但将更改为millis（），我只是想获得基本功能和理解。
常量 int switchPin = 2; // 输入引脚的编号 const int BswitchPin = 4; // 输入引脚的编号 const int outPin = 3; const int thePin = 5;

```
long startTime; // the value returned from millis when the switch is pressed
long escapeTime; // the value returned from millis when in time out
long duration;  // variable to store the duration

int inCount = 0;
int dupe = 0;

void setup()
{
  pinMode(switchPin, INPUT);
  pinMode(outPin, OUTPUT);
  pinMode(thePin, OUTPUT);
  digitalWrite(switchPin, HIGH); // turn on pull-up resistor
  Serial.begin(9600);
  Serial.println("Go");
  digitalWrite(outPin, HIGH);
}

void loop()
{
  if(inCount==0&&digitalRead(switchPin) == LOW)
  {
    // here if the switch is pressed
    startTime = millis();
    while(inCount==0&&digitalRead(switchPin) == LOW)
      ; // wait while the switch is still pressed
    long duration = millis() - startTime;
    if (duration<4000) {
      Serial.println("1");
      triggerFlash();
      inCount++;
    }
  } // master 1

  if (inCount>0&&inCount<4&&digitalRead(switchPin) == LOW) 
  {
    // here if the switch is pressed
    startTime = millis();
    while(inCount>0&&inCount<4&&digitalRead(switchPin) == LOW)
      ; // wait while the switch is still pressed
    long duration = millis() - startTime;
    delay(500); // flood protection
    if (duration>4000) { // script an escape here - formerly if (while will loop the condition)

      Serial.println("T/O");
      triggerFlash();
      inCount = 0;      
    }

    if (duration<4000) {
      dupe = inCount + 1;
      Serial.println(dupe);
      inCount++;
    }
  }
  if (inCount>=4) {
    digitalWrite(thePin, HIGH);
  }
} // loop

void triggerFlash() {
  int i = 0;
  for (i=0; i < 8; i++){   
    digitalWrite(outPin, LOW);
    delay(100);
    digitalWrite(outPin, HIGH);
    delay(100);
  } 
} 
```

任何想法都非常感谢！（用改进的计数进行了编辑）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-11-21T12:14:22.070

上面的代码实际上是错误的。请小心millis()，因为它们会在一段时间后翻转。它只是长型。因此，如果 millis+timeout 接近 max(long) 并且 millis() 将翻转并从零开始计数，即使实际发生超时，millis()>=nextupdate 也会为假。

正确的方法是：

```
unsigned long start = millis();
unsigned long timeout = MY_TIMEOUT_HERE; 
...
//check if timeout occured
unisgned long now = millis();
unsigned long elapsed = now - start;
if(elapsed > timeout)
   //do whatever you need to do when timeout occurs 
```

# javascript - IE JavaScript & CSS 问题

> ID：15141345
> 
> 赞同：0
> 
> 时间：2013-02-28T17:01:05.007
> 
> 标签：javascript, html, css

我似乎无法找到为什么其他一切都在工作但JS处于低分辨率的问题。我已经扫描了与 JS 和资源管理器相关的问题。我正在运行 ie 10，并将我的一个屏幕上的分辨率降低到 800 x 600。我的 chrome 可以在两个屏幕上工作，即响应高分辨率屏幕，但我的较低分辨率屏幕遵循高分辨率设置，就像它跳过一样较低的分辨率。

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
    "http://www.w3.org/TR/html4/strict.dtd"
    >
<html lang="en">
<head>
    <title></title>

    <!--[if IE]>
    <script type="text/JavaScript">
        if (screen.height <= 800) {
            document.write('<link rel="stylesheet" type="text/css" href="ie_low.css" />');
        }
        else {
            document.write('<link rel="stylesheet" type="text/css" href="ie.css" />');
        }
    </script>
    <![endif]-->

    <script type="text/JavaScript">
        var screenheight = screen.height;
        if (screenheight <= 800) {
            document.write('<link rel="stylesheet" type="text/css" href="style_low.css">');
        }
        else {
            document.write('<link rel="stylesheet" type="text/css" href="style.css">');
        }
    </script>

<style>

</style>
</head>
<body>
    <div class="container">
        <div class="header">

        </div>
        <div class="title">
            <img src='logo.png' class="logo" alt='logo'>
        </div>
        <div class="main">

        </div>
    </div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T17:12:59.913

我建议对高分辨率图像和不同分辨率使用媒体查询。您需要做的是创建一个两倍于您想要显示的大小的图像，然后在高分辨率媒体查询中将其缩小到原始大小的 50%。

**高分辨率图像：**

```
@media only screen and (-moz-min-device-pixel-ratio: 1.5),
   only screen and (-webkit-min-device-pixel-ratio: 1.5),
   only screen and (min-device-pixel-ratio: 1.5) {

    // half the size of image - assuming your image is 200 x 200
    .selector {background-size:100px 100px;} 

} 
```

这将进入您现有的样式表。您还可以使用媒体查询设置断点，这些查询将为不同的分辨率应用不同的 css。像这样的东西。

**断点/不同的屏幕分辨率：**

```
/* Smartphones (portrait and landscape) ----------- */
@media only screen 
and (min-device-width : 320px) 
and (max-device-width : 480px) {
/* Styles */
}

/* iPads (portrait and landscape) ----------- */
@media only screen 
and (min-device-width : 768px) 
and (max-device-width : 1024px) {
/* Styles */
}

/* Desktops and laptops ----------- */
@media only screen 
and (min-width : 1224px) {
/* Styles */
}

/* Large screens ----------- */
@media only screen 
and (min-width : 1824px) {
/* Styles */
} 
```

**元标签：**

也不要忘记元标记。

```
<meta name="viewport" content="width=device-width"> 
```

**大量资源：**

那里有很多信息。

[http://www.quirksmode.org/blog/archives/2010/09/combining_meta.html](http://www.quirksmode.org/blog/archives/2010/09/combining_meta.html) [http://css-tricks.com/snippets/css/retina-display-media-query/](http://css-tricks.com/snippets/css/retina-display-media-query/) [http://mobile.smashingmagazine .com/2012/10/24/beyond-common-media-query-breakpoints/](http://mobile.smashingmagazine.com/2012/10/24/beyond-common-media-query-breakpoints/) [http://www.w3.org/TR/css3-mediaqueries/](http://www.w3.org/TR/css3-mediaqueries/) [http://mobile.smashingmagazine.com/2010/07/19 /how-to-use-css3-media-queries-to-create-a-mobile-version-of-your-website/](http://mobile.smashingmagazine.com/2010/07/19/how-to-use-css3-media-queries-to-create-a-mobile-version-of-your-website/) [https://developer.mozilla.org/en-US/docs/CSS/Media_queries](https://developer.mozilla.org/en-US/docs/CSS/Media_queries)

# c# - 在某些计算机上使用虚拟化路径的临时目录

> ID：15141349
> 
> 赞同：10
> 
> 时间：2013-02-28T17:01:11.623
> 
> 标签：c#, silverlight, internet-explorer, silverlight-oob, protected-mode

在我的 Silverlight 应用程序中，我使用常规 SaveFileDialog 提示用户保存一些文件。

问题是在某些 Windows 7 计算机上，如果用户在保护模式下使用 IE，并尝试保存到例如桌面上，则保存路径最终如下所示：

```
C:\Users\<user>\Appdata\Local\Microsoft\Windows\Temporary Internet Files\Virtualized\C\Users\<user>\Desktop 
```

有谁知道我在哪里可以找到指示此路径将在 Windows 上使用而不是常规路径的标志或值？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-06T10:32:00.327

因此，经过一番研究，恐怕没有指示虚拟化路径的标志或值...

我知道它有点俄语，但假设这是静态的

> \Microsoft\Windows\Temporary Internet Files\Virtualized\

你可以做这样的事情来检查路径是否指向虚拟化文件夹

```
public static bool IsPathVirtualized(string path)
{
        bool isVirtualized = false;
        string pathToVirtualizedUserFolder = Path.Combine
        (
            Environment.SpecialFolder.LocalApplicationData + 
            @"Microsoft\Windows\Temporary Internet Files\Virtualized\"
        );

        if(path.StartsWith(pathToVirtualizedUserFolder))
        {
            isVirtualized = true;
        }
        return isVirtualized;
} 
```

# facebook - 可索引列上的 FQL NoIndexFunctionException 错误 605

> ID：15141355
> 
> 赞同：4
> 
> 时间：2013-02-28T17:01:25.383
> 
> 标签：facebook, facebook-fql

我正在尝试：

```
SELECT developer_id FROM app_role WHERE application_id='MY APP ID' 
```

使用有效令牌，使用[https://developers.facebook.com/tools/explorer检查](https://developers.facebook.com/tools/explorer)

我收到这个回复：

```
{
  "error": {
    "message": "Invalid application_id in WHERE clause", 
    "type": "NoIndexFunctionException", 
    "code": 604
  }
} 
```

现在。application_id 绝对正确。检查身份验证令牌并将其与该应用程序 ID 相关联，据我所知，application_id 是完全可索引的。

知道这里有什么悲伤吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-02T13:24:10.773

那是因为您需要一个应用访问令牌。以这种方式获取它：

```
GET https://graph.facebook.com/oauth/access_token?
            client_id=YOUR_APP_ID
           &client_secret=YOUR_APP_SECRET
           &grant_type=client_credentials 
```

来源：[https ://developers.facebook.com/docs/opengraph/howtos/publishing-with-app-token/](https://developers.facebook.com/docs/opengraph/howtos/publishing-with-app-token/)

然后，使用相同的 FQL 请求：

```
SELECT developer_id FROM app_role WHERE application_id='MY APP ID' 
```

你去吧：

```
{
  "data": [
    {
      "developer_id": "1234567890"
    }, 
    {
      "developer_id": "9876543210"
    }
  ]
} 
```

# php - 使用 jQuery 和 Ajax 同时执行 2 个后台任务

> ID：15141357
> 
> 赞同：1
> 
> 时间：2013-02-28T17:01:31.383
> 
> 标签：php, jquery, ajax, process, background-process

**在下面更新了我的问题**

我制作了一个脚本，用户可以在其中导入大量数据。提交表单并验证数据后，我添加了 2 个后台任务：1 是导入所有数据的脚本。这个脚本还让数据库知道总共有多少，他做了多少。第二个是一个脚本，它从数据库中读取完成了多少，并将其显示在一个漂亮的进度条中。

代码：

```
$.ajax({
    type: "GET",
    url: "import-process.php",
    success: function(data) {}
});

var process = 0;
var checkPercentage = function() {
    $.ajax({
        type: "GET",
        url: "get-process-status.php",
        data: "importcode=123456",
        success: function(data) {
            if (!data.indexOf("ERROR") !== -1) {
                process = data;
                $("#process_balk").css('width', process + '%');
            }
        }
    });

    if (process != 100) {
        setTimeout(checkPercentage, 1000);
    } else {
        window.location.href = "import-finished.php";
    }
}

checkPercentage(); 
```

两个脚本都可以正常工作。除了第二个脚本（获取进程状态）在第一个脚本（导入数据）完成后没有启动。这使得完整的东西有点没用。

任何想法如何解决这个问题？

**更新：** 我发现后台进程只被调用一次。那就是问题所在。我只是不知道如何解决它..

```
var checkPercentage = function() {
    alert("Is this function getting called every second?");
    $.ajax({
        type: "GET",
        async: true,
        url: "required/get-process-status.php",
        data: "importcode=123456",
        success: function(data) {
            alert(data);
        }
    });
    setTimeout(checkPercentage, 1000);
} 
```

上面的代码警告“这个函数是否每秒钟都被调用一次？” 每一秒。应该的。但是，值“数据”只被调用一次。这不是我所期望的......有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T17:06:54.953

将您的回调函数设置为：

```
success: function(data) {
        if (!data.indexOf("ERROR") !== -1) {
            process = data;
            $("#process_balk").css('width', process + '%');
            if (process != 100) {
               setInterval(checkPercentage, 1000);
            } else {
               window.location.href = "import-finished.php";
            }
        }
    } 
```

首先，if 语句必须在回调函数中才能按照您想要的方式工作。其次，您应该使用`setInterval()`而不是，`setTimeout()`因为它会在每个间隔时间重新检查它。

此外，yabol 说得对，您的代码顶部应该如下所示：

```
$.ajax({
type: "GET",
url: "import-process.php",
success: function(data) {
    checkPercentage();
}
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T17:05:39.860

你的意思是这样吗？：

```
$.ajax({
    type: "GET",
    url: "import-process.php",
    success: function(data) {
        checkPercentage();
    }
});

var process = 0;
var checkPercentage = function() {
    $.ajax({
        type: "GET",
        url: "get-process-status.php",
        data: "importcode=123456",
        success: function(data) {
            if (!data.indexOf("ERROR") !== -1) {
                process = data;
                $("#process_balk").css('width', process + '%');
            }
        }
    });

    if (process != 100) {
        setTimeout(checkPercentage, 1000);
    } else {
        window.location.href = "import-finished.php";
    }
} 
```

我刚刚将 checkPercantage 函数调用从脚本末尾移动到`success`第一个 ajax 函数。`complete`如果您希望在出现错误的情况下运行它，您也可以将其移动到功能。

# sql - SQL SELECT with GROUP BY，指回组

> ID：15141362
> 
> 赞同：3
> 
> 时间：2013-02-28T17:01:35.107
> 
> 标签：sql, sqlite, group-by

我是一个相对的 SQL 初学者，我不完全确定如何问我在问什么（所以我也不完全确定如何搜索它的帮助）。

我想使用一个`SELECT`语句，该语句使用`GROUP BY`子句按某个属性进行分组，同时引用该组选择的行。有没有办法做到这一点？（我使用的是 FWIW、SQLite3，但我认为这更多是通用 SQL 语法的问题。）

我有一张表格`population`，里面有关于人和家庭的数据。每排是一个人，每个人都被分成从一到十几个的家庭。

每户一人（一般为第一人，by `uid`）为户主，并有`head`列集。我想要`GROUP BY`列`household_id`，并且还选择`uid`组中每个成员的“头”。有没有办法用一个语句来做到这一点？

这是我所拥有的：

```
SELECT DISTINCT household_id,
    COUNT(uid) AS members   /* The number of members in each household; it works */,
    (SELECT uid FROM "group" WHERE head == 1) /* Only I don't know how to do this */
    FROM population GROUP BY household_id; 
```

我尝试了这样的事情，但它没有给我想要的东西：

```
SELECT DISTINCT household_id,
    COUNT(uid) AS members,
    (SELECT uid FROM population WHERE household_id == household_id AND head == 1) /* <-- here */
    FROM population GROUP BY household_id; 
```

但这当然会选择第一行`household_id`是`household_id`; 即表中的第一行。我如何仅引用该特定组中的`household_id`那个？`DISTINCT`

有小费吗？提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-28T17:05:19.830

试试这个，

```
SELECT  household_id,
        COUNT(uid) AS members, 
        MAX(CASE WHEN head = 1 THEN uid ELSE NULL END) headID
FROM    population 
GROUP   BY household_id; 
```

*   [SQLFiddle 演示](http://www.sqlfiddle.com/#!7/6d7ef/2)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T17:08:34.347

你本可以走在正确的轨道上

```
SELECT DISTINCT household_id,
COUNT(uid) AS members,
(SELECT uid FROM population WHERE household_id == household_id AND head == 1) /* <-- here */
FROM population GROUP BY household_id; 
```

但是您需要为人口表起别名，因为它在查询中使用了两次。

```
SELECT DISTINCT household_id,
COUNT(uid) AS members,
(SELECT uid FROM population gr_head WHERE pop.household_id = gr_head.household_id AND head == 1) /* <-- here */
FROM population pop GROUP BY household_id; 
```

# android - 使用 FragmentActivity 中的 viewPager 更改方向

> ID：15141363
> 
> 赞同：8
> 
> 时间：2013-02-28T17:01:45.230
> 
> 标签：android, android-fragments, android-viewpager, fragment, screen-orientation

我正在尝试构建一个以纵向和横向模式显示书籍的应用程序。所以很明显有1页以纵向显示，2页以横向显示。每种模式都很好，但是当我将方向从纵向更改为横向时，viewPager 尝试从纵向模式获取 2 个页面，而不是尝试从横向模式获取 2 个双页......实际上**FragmentStatePagerAdapter 保留了 2 个片段以纵向创建并在为横向模式创建 2 个双页之前使用它们**. 如果我在纵向模式下再次切换，FragmentStatePagerAdapter 使用之前在横向模式下创建的 2 个片段，所以我再次看到 1 个双页而不是 1 个单页等。如果我继续切换方向，我得到一个 OutOfMemoryError，因为 FragmentStatePagerAdapter 从来没有在方向改变时刷新它的碎片。

这里有 2 个用例，便于理解：

*   我以纵向模式启动 viewPager
*   我看到了第 1 页
*   我向右滑动，我看到了第 2 页
*   我向右滑动，我看到第 3 页 ok
*   我将屏幕旋转到横向模式
*   我看到第 3 页错了
*   我向右滑动，我看到第 4 页错误
*   我向右滑动，我看到第 5 页和第 6 页 ok

*   我以纵向模式启动 viewPager

*   我看到了第 1 页
*   我向右滑动，我看到了第 2 页
*   我向右滑动，我看到第 3 页 ok
*   我向右滑动，我看到第 4 页 ok
*   我向右滑动，我看到第 5 页 ok
*   我将屏幕旋转到横向模式
*   我看到第 5 页错了
*   我向左滑动，我看到第 4 页错误
*   我向左滑动，我看到第 2 页和第 3 页 ok

    ```
    public class PlayerFragmentActivity extends FragmentActivity {
    private Intent mIntent;
    private ViewPager mPortraitPager;
    private ViewPager mLandscapePager;
    private Boolean mIsLandscape;
    private String mKey;
    private int mNbPages;
    private int mNbDoublePages;
    private PageFactory mPageFactory;
    private DoublePageFactory mDoublePageFactory;
    private PagerAdapter mPagerAdapter;

    @Override
    protected void onStop(){
        super.onStop();
        mPagerAdapter = null;
        mDoublePageFactory = null;
        mPageFactory = null; 
    }

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.fragment_activity_player);
        mIntent = getIntent();
        mKey = mIntent.getStringExtra("key");
        mNbPages = mIntent.getIntExtra("nbPages", 0);
        mNbDoublePages = DoublePageFactory.getDoublePageNumFromPageNum(mNbPages);

        Resources res = getResources();
        mIsLandscape = (res.getConfiguration().orientation == 1) ? false : true;
        mPortraitPager = (ViewPager) findViewById(R.id.portraitPager);
        mLandscapePager = (ViewPager) findViewById(R.id.landscapePager);

        mPagerAdapter = new MyPagerAdapter(getSupportFragmentManager());

        if (mIsLandscape) {
            mDoublePageFactory = new DoublePageFactory(this, mKey, mNbPages, res.getInteger(R.integer.nb_page_columns), res.getInteger(R.integer.nb_page_columns));
            mPortraitPager.setVisibility(View.GONE);
            mLandscapePager.setAdapter(mPagerAdapter);
            mPortraitPager.setAdapter(null);
        } else {
            mPageFactory = new PageFactory(this, mKey, this.mNbPages, res.getInteger(R.integer.nb_page_columns), res.getInteger(R.integer.nb_page_columns));
            mLandscapePager.setVisibility(View.GONE);
            mPortraitPager.setAdapter(mPagerAdapter);
            mLandscapePager.setAdapter(null);
        }
    }

    public class MyPagerAdapter extends FragmentStatePagerAdapter {

        public MyPagerAdapter(FragmentManager fm) {
            super(fm);
        }

        @Override
        public Fragment getItem(int position) {
            Bundle args = new Bundle();
            if(mIsLandscape){
                Fragment doublePageFragment = new DoublePageFragment();
                args.putInt(DoublePageFragment.ARG_DOUBLEPAGE_NUM, position + 1);
                doublePageFragment.setArguments(args);
                return doublePageFragment;
            }else{
                Fragment pageFragment = new PageFragment();
                args.putInt(PageFragment.ARG_PAGE_NUM, position + 1);
                pageFragment.setArguments(args);
                return pageFragment;
            }
        }

        @Override
        public int getCount() {
            return (mIsLandscape) ? mNbDoublePages:mNbPages;

        }

                /* j'ai essayé cette méthode mais ça ne fonctionne pas :( */
        @Override
        public void destroyItem(ViewGroup container, int position, Object object) {
                FragmentManager manager = ((Fragment) object).getFragmentManager();
                FragmentTransaction trans = manager.beginTransaction();
                trans.remove((Fragment) object);
                trans.commit();

            super.destroyItem(container, position, object);
        }

        @Override
        public int getItemPosition(Object object){
            return PagerAdapter.POSITION_NONE;
        }

        @Override
        public CharSequence getPageTitle(int position) {
            return "p." + position + 1;
        }
    }

    public boolean isLandscape() {
        return mIsLandscape;
    }

    public ImageView getSinglePage(int position) {
        return mPageFactory.getPage(position);
    }

    public LinearLayout getDoublePage(int position) {
        return mDoublePageFactory.getDoublePage(position);
    }
    }

    public class PageFragment extends Fragment {    
    private PlayerFragmentActivity mPlayerFragmentActivity;
    public static final String ARG_PAGE_NUM = "page_number";
    public static final String ARG_WOBOOK_DIRECTORY = "book_directory";
    public static final String ARG_NB_PAGE_COLUMNS = "nb_page_columns";
    public static final String ARG_NB_PAGE_ROWS = "nb_page_rows";

    @Override
    public ImageView onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {
        mPlayerFragmentActivity = ((PlayerFragmentActivity) getActivity());
        return mPlayerFragmentActivity.getSinglePage(getArguments().getInt(ARG_PAGE_NUM));
    }

    @Override
    public void onStop(){
        super.onStop();
        mPlayerFragmentActivity = null;
    } 
    ```

    }

    ```
    public class DoublePageFragment extends Fragment {
    private PlayerFragmentActivity mPlayerFragmentActivity;
    public static final String ARG_DOUBLEPAGE_NUM = "double_page_number";
    public static final String ARG_WOBOOK_DIRECTORY = "book_directory";
    public static final String ARG_NB_PAGE_COLUMNS = "nb_page_columns";
    public static final String ARG_NB_PAGE_ROWS = "nb_page_rows";

    @Override
    public LinearLayout onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {
        mPlayerFragmentActivity = ((PlayerFragmentActivity) getActivity());
        return mPlayerFragmentActivity.getDoublePage(getArguments().getInt(ARG_DOUBLEPAGE_NUM));
    }

    @Override
    public void onStop(){
        super.onStop();
        mPlayerFragmentActivity = null;
    }
    } 
    ```

我读过框架中的 FragmentManager 负责保存状态并恢复寻呼机制作的任何活动片段。所以我猜当方向改变时，FragmentManager 说

> 嘿 ！我已经创建了 2 个项目，所以我不需要创建新闻，让我们获取它们

但实际上它从旧的方向模式中获取了 2 个项目（页面/双页）。所以我需要找到一种方法来在发生方向变化时删除 FragmentManager 保存的片段。

我也测试过[这种方法](https://stackoverflow.com/questions/10396321/remove-fragment-page-from-viewpager-in-android)。问题似乎与[这个有关](https://code.google.com/p/android/issues/detail?id=19001)

此致

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-07-02T12:20:19.887

尝试将方向限制为纵向或横向模式。因为我们只能在精确模式下使用视图寻呼机。

# javascript - jsp中多个文本区域的通用滚动条

> ID：15141365
> 
> 赞同：-3
> 
> 时间：2013-02-28T17:02:01.667
> 
> 标签：javascript, html, textarea, scrollbar

我在一个jsp中有8个文本区域。如何为所有 8 个文本区域启用公共滚动条（水平滚动条）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T17:19:24.040

这与 JSP 无关。您可以使用 javascript 实现类似的效果，将 textareas 中的滚动条同步到给定值。您可以通过该`scrollLeft`属性设置文本区域的水平滚动量。该`scrollWidth`属性将为您提供每个文本区域的总可滚动长度。

例如，您可以使用[jQuery](http://jqueryui.com/slider/)创建一个滑块组件，并使用其`slide()`方法将每个文本区域的滚动量动态更改为百分比。

```
<textarea id="textarea1" 
    onscroll="document.getElementById('textarea2').scrollLeft = this.scrollLeft;">
    ... some text ... 
</textarea>

<textarea id="textarea2" 
    onscroll="document.getElementById('textarea1').scrollLeft = this.scrollLeft;">
    ... some text ... 
</textarea>

<div id="slider"></div>

<script>
$(function() {
    $( "#slider" ).slider({
        slide: function( event, ui ) {
        var val = ui.value/100;
        var t1 = document.getElementById('textarea1');
        t1.scrollLeft = val*t1.scrollWidth;
        var t2 = document.getElementById('textarea2');
        t2.scrollLeft = val*t2.scrollWidth;
        }
    });
});
</script> 
```

看到它在这个[JSFiddle](http://jsfiddle.net/UA4Nx/4/)中工作。

如果您不想使用 jQuery，也可以尝试使用 HTML5`<input type="range">`元素。[请参阅 this other fiddle](http://jsfiddle.net/UA4Nx/2/)中的示例。

# ruby-on-rails - 如何在 Rails 中进行发票文本库报告？

> ID：15141370
> 
> 赞同：0
> 
> 时间：2013-02-28T17:02:12.177
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, templates, report

我想建立发票文本库以具有以下格式：

[https://gist.github.com/samnang/9d35a8622af5779a9228](https://gist.github.com/samnang/9d35a8622af5779a9228)

但是当我尝试从我的控制器呈现为文本格式时，我发现控制它的外观非常重要，因为这些文本是动态的，就像公司名称可以短或长一样。我不希望其他文本移动位置取决于其他内容，因为这些格式将被发送给印刷公司以匹配打印出的纸张。

是否有任何示例、宝石或建议如何构建发票文本库？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T17:11:12.903

您将不得不截断一些字段以适应定义的选项卡区域。如果您分配 20 个字符的描述数据，那么您只需要在输出上允许 20 个字符`your_text[0..19]`

我认为这种类型的工作在文本中工作会过于复杂，您应该考虑将输出转换为 pdf 以获得更多控制。看看[https://github.com/prawnpdf/prawn](https://github.com/prawnpdf/prawn)

# ruby-on-rails - 参考查找

> ID：15141371
> 
> 赞同：0
> 
> 时间：2013-02-28T17:02:12.657
> 
> 标签：ruby-on-rails

所以我有2个模型：

```
create_table "holders", :force => true do |t|
 t.string   "faceid"
 t.integer  "badges_id"
 t.datetime "created_at", :null => false
 t.datetime "updated_at", :null => false
end
add_index "holders", ["badges_id"], :name => "index_holders_on_badges_id"

create_table "badges", :force => true do |t|
 t.string   "name"
 t.text     "description"
 t.datetime "created_at",  :null => false
 t.datetime "updated_at",  :null => false
end 
```

我需要两件事：

1.  获取某个faceid持有者的所有徽章

2.  获得某个徽章的所有持有者。

我知道它真的是菜鸟问题，但直到现在我还没有使用参考资料，所以我从文献中并没有真正理解如何建立联系。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T23:48:37.917

实际上，您的持有者和徽章模型需要多对多关联。所以你必须选择 use`has many :through`或 use `has_and_belongs_to_many`。两者的区别可以在[这里](http://guides.rubyonrails.org/association_basics.html#choosing-between-has_many-through-and-has_and_belongs_to_many)找到。我以`has_many :through`.

您需要创建三个模型。

```
 class Holder < ActiveRecord:Base
   has_many :badges_holders
   has_many :badges, :through => :badges_holders
 end

 class Badge < ActiveRecord:Base
   has_many :badges_holders
   has_many :holders, :through => :badges_holders
 end

 class BadgesHolder < ActiveRecord:Base
   belongs :badge
   belongs :holder
 end 
```

您的迁移文件需要：

```
create_table "holders", :force => true do |t|
  t.string   "faceid"
  t.timestamps
end
add_index "holders", ["badges_id"], :name => "index_holders_on_badges_id"

create_table "badges", :force => true do |t|
  t.string   "name"
  t.text     "description"
  t.timestamps
end

create_table "badges_holders", :force => true do |t|
  t.integer  "holder_id"
  t.integer  "badge_id"
  t.timestamps
end 
```

现在，您可以轻松`Holder.find_by_faceid('xyz').badges`地找到面为 xyz 的持有人持有的所有对冲。并`Badge.first.holders`让所有持有者获得第一张床。

对于您的问题，HABTM 将是一个不错的选择，因为您不需要连接表中的任何额外字段，因此您可以`has_and_belongs_to_many`在两个模型中使用，并且在这种情况下不需要`BadgesHolder`模型。对于连接表的迁移，将第一行替换为`create_table "badges_holders", :id => false, :force => true do |t|`a 并删除`t.timestamps`，因为 HABTM 的连接表不应该有任何其他列而不是外键。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T17:11:50.050

如果是一些 Ruby on Rails，你必须有 2 个模型：

```
class Holder < ActiveRecord:Base
  has_many :badges
end

class Badge < ActiveRecord:Base
  belongs_to :holder
end 
```

您的条目`badges_id`不应该在您的`holders`表中；`holder_id`你的“徽章”表上应该有一个。

然后，您可以简单地调用

```
Holder.find_by_faceid('foobar').badges 
```

和

```
Badge.find(1337).holder 
```

如果你的`badge`罐头属于许多持有者，那么你必须写一个`has_and_belongs_to_many`关系。

# .net - 从 vb.net 按钮运行 cmd 命令

> ID：15141372
> 
> 赞同：1
> 
> 时间：2013-02-28T17:02:23.090
> 
> 标签：.net, vb.net, cmd

我有一个简单的问题，我无法找到答案。我有一个命令行程序（点击）。我已经在环境变量中设置了路径，所以我可以从 cmd 提示符下运行它而不会出现问题。

它看起来像这样：

> 点击 -u 加载文件 1 文件 2

我如何通过在 vb.net 中单击按钮来运行它？

这是我到目前为止所拥有的...

```
 Private Sub Flash_Click(sender As Object, e As EventArgs) Handles flashBundle.Click
        'If (String.Compare(imageTextBox.Text, "") <> 0) And (String.Compare(radioTextBox.Text, "") <> 0) Then
        Dim pi As New ProcessStartInfo("C:\p4\main\armos\common\tools\tap.exe")
        pi.WorkingDirectory = "C:\p4\main\armos\common\tools\"
        pi.Arguments = ("-u load " + imageTextBox.Text + " " + radioTextBox.Text)
        Process.Start(pi)
        'End If
    End Sub 
```

cmd窗口闪烁，程序不执行。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T18:01:15.203

放

```
pi.UseShellExecute = True 
```

如果您想通过命令行启动此过程。您现在的操作方式是启动它，就像您双击它一样。

有点相关 - stackoverflow.com/q/2382683/16391

# javascript - 打开一个子列表时上滑子列表

> ID：15141378
> 
> 赞同：1
> 
> 时间：2013-02-28T17:02:41.200
> 
> 标签：javascript, jquery, html

我希望当我点击一个子列表时，如果它之前打开过，另一个会自动向上滑动。我尝试使用 .siblings 没有运气。这是我的代码和标记：

```
 /* Shop Filter */
    function shopfilter(that) {
        $(that).toggleClass('active');
        $(that).next('.color:first').slideToggle();
    }

                <ul id="filter_box">
                    <li>
                        <a href="javascript:void(0)" onclick="shopfilter(this);">COLOR</a>
                        <ul class="color">
                            <li>
                                <img src="img/color1.png" alt="color1" width="14" height="15">
                                <span>Color 1</span>
                            </li>
                            <li>
                                <img src="img/color2.png" alt="color1" width="14" height="15">
                                <span>Color 2</span>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <a href="javascript:void(0)" onclick="shopfilter(this);">PRECIO</a>
                        <ul class="color">
                            <li>
                                <span>>50</span>
                            </li>
                            <li>
                                <span>100</span>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <a href="javascript:void(0)" onclick="shopfilter(this);">TALLA</a>
                        <ul class="color">
                            <li>
                                <span>XS</span>
                            </li>
                            <li>
                                <span>S</span>
                            </li>
                        </ul>
                    </li>
                </ul> 
```

关于如何实现它的任何想法？

**编辑**： toggleClass('active') 只是用来改变箭头的方向......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T17:38:01.327

我对 Sylvanus 有类似的想法（re: using `slideUp()`and `slideDown()`），但方法略有不同，在打开新菜单之前重置所有菜单。

```
function shopfilter(that) {
    //check to see if the current menu is already open
    var isOpen = ($(that).hasClass('active')) ? true : false;

    //reset the menus
    $('.active').removeClass('active');
    $('.color').slideUp();

    // display the selected menu if it was closed
    if (!(isOpen)) {
        $(that).addClass('active');
        $(that).next('.color:first').slideDown();
    }
} 
```

已经关闭的菜单不会受到影响，但当前打开的菜单将被关闭。该`isOpen`检查可确保您在再次单击菜单以将其关闭时不会重新打开它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T17:14:48.590

尝试这样的事情。我将 slideToggle 更改为 slideUp/Down 以确保它与活动类同步​​。

```
function shopfilter(that) {
    $('.active').slideUp();
    if ($(that).hasClass('active')) {
        $(that).slideUp().removeClass('active');
    } else {
        $(that).slideDown().addClass('active');
    }
} 
```

我为此做了一个小提琴：http: [//jsfiddle.net/dnvaL/](http://jsfiddle.net/dnvaL/)

# c# - 从面板保存图像

> ID：15141385
> 
> 赞同：2
> 
> 时间：2013-02-28T17:02:58.850
> 
> 标签：c#, winforms, visual-studio, bitmapimage

我正在尝试从面板中保存位图，但保存的图像与程序的栏...

如何仅使用指定面板保存图像？

这是我的代码：

```
 Bitmap bitmap = new Bitmap(panel1.Width, panel1.Height);
  this.DrawToBitmap(bitmap, panel1.ClientRectangle);
  bitmap.Save("C:\\" + pagAtual + ".bmp", ImageFormat.Bmp); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-28T17:11:56.903

尝试改用 Panel 控件（另外，使用 ClientSize 属性并在完成后处理位图）：

```
using (Bitmap bitmap = new Bitmap(panel1.ClientSize.Width, 
                                  panel1.ClientSize.Height)) {
  panel1.DrawToBitmap(bitmap, panel1.ClientRectangle);
  bitmap.Save("C:\\" + pagAtual + ".bmp", ImageFormat.Bmp);
} 
```

# ios - 使用 Mac OSX 编程遵循 iOS 设计模式

> ID：15141386
> 
> 赞同：3
> 
> 时间：2013-02-28T17:03:00.253
> 
> 标签：ios, xcode, macos

我一直在开发 iOS 应用程序，并且熟悉使用 AppDelegate 和带有关联 xib 文件的 ViewController 启动我的应用程序。

我刚刚创建了一个 OSX 应用程序，开始时我得到了一个 AppDelegate 和一个窗口。

我想让我的应用程序设计与我熟悉的相似，所以我创建了一个 NSViewController 对象并创建了一个关联的 xib。

现在我不知道从这里去哪里。我可以在我的应用程序委托中构造我的 NSViewController，但是如何将它的 xib 添加到我的窗口中？

更进一步 - 我试图做事的方式是“正确的”吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T17:06:31.283

如果您要求更改文件的所有者，您需要与 ios 类似，从 Interface Builder 中选择 Class 值，将其更改为所需的类。现在这将是您的所有者类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T17:18:40.587

虽然 iOS 和 OS X 的 Interface Builder 可能有许多相同的概念，但 Cocoa 和 Cocoa-Touch 的基本设计有一些显着的差异。NSViewController 在 API 方面不如 UIViewController 有用（例如，`-viewDidLoad`它不是 NSViewController 的方法）。视图通常归窗口所有，NSWindowController 在 OS X 中提供相同的基本功能，特别是因为它们确实会通知您其窗口的创建和释放，以及它们的视图。我觉得它们会更适合替代您习惯的 UIViewController。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T17:04:44.540

在 Mac OS X GUI 编程中，它与为 iPhone 创建 GUI 有点不同。您应该将 GUI 元素拖入窗口（您也可以使用顶栏），并将这些元素链接到代码中的公共变量（由 NSObjects 表示）。

# java - 删除中点后在数组中移动数字

> ID：15141392
> 
> 赞同：0
> 
> 时间：2013-02-28T17:03:19.793
> 
> 标签：java, arrays

我正在使用一个从文件中输入数字的数组。我必须删除中点数字并将中点后的所有其他数字向左移动以填充空间。除非数组没有足够的数字来填充数组，否则这是有效的，因此它只会打印最后一个数字两次而不是一次。当文件中没有数字时，如何让它停止打印。（对不起，如果这听起来很复杂）我的代码如下

```
 for (int i = mid; i < array.length -1 ; i++){

            array[i] = array[i+1];

        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T17:19:44.590

除非这是家庭作业，否则不要重新发明轮子。 `java.utils.ArrayList`已经为你做了这个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T17:06:16.147

> 它只是保持打印最后一个数字两次而不是一次

移动元素后，可能需要实际删除最后一个元素，因为它不再使用。为此，您可以使用[`Arrays.copyOfRange()`](http://docs.oracle.com/javase/7/docs/api/java/util/Arrays.html#copyOfRange%28int%5B%5D,%20int,%20int%29).

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T17:20:46.627

运行你的循环`array.length -2`。因为您`Last`和`Second Last`数组中的项目是相同的。这就是为什么它要写两次。

# jquery - Jquery - 使用顶部的框滚动到顶部插件

> ID：15141395
> 
> 赞同：0
> 
> 时间：2013-02-28T17:03:29.007
> 
> 标签：jquery

我正在寻找一个 jQuery 插件，它通过单击一个框将页面滚动到顶部（我在 godaddy.com 上播种了一个 - 不喜欢该框位于页面底部的想法，该框需要它严格位于页面顶部）

这是一个例子： http: [//lenta.ru/](http://lenta.ru/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T17:04:54.963

您不需要插件：

```
$('button').click(function(){
    $('html,body').animate({ scrollTop: 0 }, 1000);
}); 
```

您还可以使用：

```
$('html,body').animate({ scrollTop: $("element").offset().top }, 1000); 
```

`element`页面上的元素在哪里。然后它将滚动到该元素的位置。更改`1000`为您希望动画跨越的毫秒数。`1000`= 1 秒。

# c# - 模态形式的奇异窗口计算和绘制

> ID：15141396
> 
> 赞同：0
> 
> 时间：2013-02-28T17:03:36.333
> 
> 标签：c#, winforms, skinning

我的模态表单在显示时有时可能看起来像[这样](http://321.tv/i?8bbc9fd8e732bec12b328ed6ce47b9b7.png)（橙色块除外）。当重复打开和关闭模态表单时，会间歇性地发生这种情况。

这发生在具有两台显示器的系统上，一台连接到板载显卡，另一台连接到专用显卡，并启用了 Windows 7 Aero 主题。

如果我从板载显卡上拔下另一台显示器，则不会出现问题。

此外，该问题不会发生在具有较少 UI 控件的旧版本的模态表单中。

[我在这里](http://forums.codeguru.com/showthread.php?264785-How-to-force-the-window-to-ReCalculate-the-client-area&p=817433#post817433)读到了类似的问题并尝试了解决方案，但问题仍然存在。

**更新**：如果我在 中设置`AllowTransparency = false`，`OnShown`那么模态表单显示大部分都可以，除了角落有红色，w/c 是在 中设置的颜色`TransparencyKey`。

**第二次更新**：增加`Width`1 也解决了这个问题。

请让我知道我在这里可能缺少什么或我需要研究什么。

谢谢。

# javascript - 无法通过 Firefox 阻止默认设置 试图在 <select>上阻止默认的 Firefox 中的 keydown 事件，但它不起作用。任何解决方法？这一次，即使是 IE 也能处理，但 Firefox 不能！请参阅此处的代码：http://jsfiddle.net/p8FNv/1/</select> <option value="1">星期一</option> <option value="2">星期二&</option>

> ID：15141398
> 
> 赞同：7
> 
> 时间：2013-02-28T17:03:36.860
> 
> 标签：javascript, jquery, firefox

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-08-07T16:07:32.897

这不是很优雅但有效：

```
$("select").keydown(function(e){
    e.preventDefault();
    var elem = this;
    elem.disabled=true;
    setTimeout(function() { elem.disabled = false; }, 0);
}); 
```

问候。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T17:46:22.520

这似乎在 Firefox 19 上对我有用。我假设您的意图是防止在用户输入值时通过键盘输入更改选择值。

```
$(document).ready(function() {
    var valueToKeep;
    $("#select").keypress(function (event) {
        $(this).val(valueToKeep);
    });
    $("#select").keydown(function (event) {
        event.preventDefault();
        event.stopPropagation();
        valueToKeep = $(this).val();

    });         
}); 
```

[JSFiddle](http://jsfiddle.net/p8FNv/11/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T17:51:35.093

我假设您不希望在按下某个键时选择另一个选项。我相信这是特定于浏览器的实现，不会触发事件。您可能需要做的是使用常规元素和 jquery 构建自己的选择模仿。这可能会变得非常复杂，具体取决于您想要获得的疯狂程度，但这是一个小小的开始。

HTML：

```
<div class="imitateSelect>
     <div class="item"></div>
     <div class="item"></div>
     <div class="item"></div>
</div> 
```

CSS：

```
.imitateSelect div{
    display:none;
} 
```

JS：

```
$('.imitateSelect div').first().show();

$('.imitateSelect div').on('click', function(){
    $(this).siblings().slideDown();
}); 
```

等等等等

另一种选择是使用像[Chosen](http://harvesthq.github.com/chosen/)这样的插件。看看他们做了什么。如果您删除输入栏，您将获得选择功能，并且按键不会更改所选选项。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-17T07:34:31.717

关于 keydown 上的选择更改，请尝试在标签前添加实体`&shy;`（[软连字符）。](http://en.wikipedia.org/wiki/Soft_hyphen)

这可能不是最优雅的解决方案，但可以解决问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-11-06T12:34:11.520

```
<!DOCTYPE html>
<html>
<head>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
</head>
<body>

<select id="select">
    <option value="1">1</option>
    <option value="2">2</option>
    <option value="3">3</option>
</select>

<script>
// working fine in PC and mobile
$('#select').on('focus', function() {
    $(this).hide();
    setTimeout(function(self) {
        self.show();
    }, 0, $(this))
});
</script>
</body>
</html> 
```

# mysql - MySQL查看选择未来N天

> ID：15141404
> 
> 赞同：1
> 
> 时间：2013-02-28T17:03:54.583
> 
> 标签：mysql, select, view

我有一个 mySQL 视图，我希望能够找到所有具有从现在起正好 N 天的 expireDate 的记录。例如，我想查找从现在起正好是 90 天的 expireDate 的所有记录，这样我就可以通过电子邮件通知该人，让他们知道他们的课程即将到期。dateCompleted 和 expirationDate 都是 datetime 类型。

结构：

```
id  can firstName   lastName    email   course  curriculum  group   stageNum    stage   dateCompleted   expirationDate 
```

数据示例：

```
1   123456789   John    Smith   jsmith@gmail.edu    PHS Conflict of Interest    Conflict of Interest mini-course    Conflict of Interest    1   Stage 1 2012-12-07 02:52:24 2015-12-07 02:52:24 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T17:11:07.333

这应该会在`expirationDate`90 天后为您提供结果：

```
SELECT * FROM courses WHERE DATE(expirationDate) = DATE_ADD(CURRENT_DATE(), INTERVAL 90 DAY) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T17:06:10.587

您应该能够使用一些[日期和时间函数](https://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html)来执行此操作，例如`DATE_ADD`：

```
SELECT * FROM courses WHERE expirationDate BETWEEN CURDATE() AND DATE_ADD(CURDATE(), INTERVAL 90 DAY); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T17:12:20.933

这应该可以解决问题：

```
SELECT * FROM courses 
WHERE DATE(DATE_ADD(expirationDate, INTERVAL -90 DAY)) = CURRENT_DATE 
```

# android - 如何在以编程方式添加到 LinearLayout 的按钮之间添加边距空间？

> ID：15141405
> 
> 赞同：2
> 
> 时间：2013-02-28T17:03:54.713
> 
> 标签：android, android-layout, runtime, android-linearlayout, margin

我在运行时将按钮添加到`LinearLayout`（垂直方向）...

```
private void addButtons(String[] titles) {
    for (String title : titles) {
        Button button = ButtonBuilder.getButton(getActivity());
        button.setText(title);
        mButtonsLayout.addView(button);
    }
} 
```

每个按钮都有一个用 XML 定义的样式。

```
<!-- styles.xml -->
<style name="Button">
    <item name="android:layout_width">match_parent</item>
    <item name="android:layout_height">wrap_content</item>
    <item name="android:gravity">center</item>
    <item name="android:layout_margin">8dp</item>
</style> 
```

虽然我定义了一个`layout_margin`所有按钮都彼此相邻，没有任何间距。如何在它们之间添加边距？

* * *

正如*nmw*所建议的，我正在尝试将父布局引入充气机。

```
private void addButtons(String[] titles) {
    for (String title : titles) {
        Button button = ButtonBuilder.getButton(getActivity(), mButtonsLayout);
        button.setText(title);
        mButtonsLayout.addView(button);
    }
} 
```

..

```
// ButtonBuilder.java
public static Button getButton(Activity activity, ViewGroup parent) {
    return (Button)activity.getLayoutInflater().inflate(R.layout.custom_button, 
                                                        parent);
} 
```

这导致异常..

```
java.lang.ClassCastException: android.widget.LinearLayout cannot be \
   cast to android.widget.Button 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-28T17:12:04.533

由于在实例化时没有父 ViewGroup，布局膨胀时 layout_margin 将被忽略。框架无法创建布局参数，因为它不知道父 ViewGroup 类型。

要解决此问题，您可以：

**1/**也以编程方式创建布局参数，就在添加视图之前，您可以在其中设置边距。

或者

**2/**将 ViewGroup 参数添加到 getButton 构建器并传入 mButtonsLayout。然后，当您膨胀 XML 时，将其用作父 ViewGroup（inflate() 上的最后一个参数）。

使用方法**2/** inflate() 将返回 ViewGroup 而不是 View （在您的情况下为按钮），因此您需要使用`parent.getChildAt(parent.getChildCount()-1)`.

有关膨胀，请参阅[LayoutInflater 文档](http://developer.android.com/reference/android/view/LayoutInflater.html#inflate%28org.xmlpull.v1.XmlPullParser,%20android.view.ViewGroup%29)。

* * *

**编辑：**

请注意，Builder 将不再作为一种`getButton()`方法工作。使用 ViewGroup 参数时，按钮会立即**添加**到父视图。

```
public static Button addButton(Activity activity, ViewGroup parent) {
    activity.getLayoutInflater().inflate(R.layout.custom_button, parent);
    return (Button) parent.getChildAt(parent.getChildCount() - 1);
} 
```

因此，您不能再在主类中添加视图。

```
// mButtonsLayout.addView(button); // Remove this 
```

否则将导致以下错误：

```
java.lang.IllegalStateException: The specified child already has a parent. \
    You must call removeView() on the child's parent first. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T17:18:21.980

尝试这样的事情：

```
FrameLayout.LayoutParams layoutParams = 
   new FrameLayout.LayoutParams(LayoutParams.WRAP_CONTENT, 
                                 LayoutParams.WRAP_CONTENT);
layoutParams.setMargins(0, 0, 0, 0);
mButtonsLayout.setLayoutParams(layoutParams); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T17:53:20.490

使用它来动态发送保证金

```
MarginLayoutParams marginParams = new MarginLayoutParams(backToMainScreenImageView.getLayoutParams());
marginParams.setMargins(0, 0, (int) UIUtil.getRadialButtonMainMargin(this), 0);
LinearLayout.LayoutParams layoutParams = new LinearLayout.LayoutParams(marginParams);
backToMainScreenImageView.setLayoutParams(layoutParams); 
```

# c# - c#中的objectdisposedexception

> ID：15141407
> 
> 赞同：0
> 
> 时间：2013-02-28T17:04:00.480
> 
> 标签：c#, winforms, objectdisposedexception, windows-mobile-6.1

各位程序员好！

我正在为具有条形码阅读器硬件的 Windows Mobile 6.1 设备开发 Windows Forms .NET Compact Framework 2.0。

我可以使用条形码阅读器读取条形码，也可以激活和停用它。除了当我尝试阅读某些内容并转到下一个表单时，我得到一个 objectdisposedexception。发生这种情况（我猜）是因为我必须处理条形码阅读器的实例，然后在下一个表单中创建一个新实例。

问题是：当我使用按钮转到下一个表单时，使用相同的代码来处理条形码阅读器我没有 objectdisposedexception。当我简单地将表单加载到 textchanged 事件时，错误会上升，但不会被任何 try/catch 语句捕获，从而导致应用程序崩溃。

我也无法调试它，因为 Windows Mobile 的 VS 模拟器不适用于设备条形码阅读器 DLL。

有人能帮我吗？

这是代码：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Text;
using System.IO;
using System.Windows.Forms;

//DLL that controls the barcodereader
using Intermec.DataCollection;

namespace WOPT_Coletor.view.ConsultarPosicao
{
    public partial class frmConsultarPosicao_2 : Form
    {

        public BarcodeReader leitor;

        public frmConsultarPosicao_2()
        {
            InitializeComponent();
            ShowHide.ShowTopStatusbar(false);

            //code to work with the barcode reader
            model.LeitorCodigoDeBarras classeLeitor = new model.LeitorCodigoDeBarras();
            leitor = classeLeitor.LerCodigoDeBarras();
            leitor.BarcodeRead += new BarcodeReadEventHandler(this.eventoLeitorCodigoDeBarrasArmazenagem1);
        }    

        //Event to receive the barcode reading information
        void eventoLeitorCodigoDeBarrasArmazenagem1(object sender, BarcodeReadEventArgs e)
        {
            tbCodMaterial.Text = e.strDataBuffer.Trim();
        }

        private void tbCodMaterial_TextChanged(object sender, EventArgs e)
        {
            try
            {
                if (tbCodMaterial.Text.Length == 23)
                {                        
                    Cursor.Current = Cursors.WaitCursor;
                    Cursor.Show();

                    //disposal of the barcodereader instance
                    leitor.ScannerOn = false;
                    leitor.ScannerEnable = false;
                    leitor.Dispose();
                    leitor = ((BarcodeReader)null);

                    //processing of the information read.
                    char[] auxcodMaterial = new char[9];

                    using (StringReader str = new StringReader(tbCodMaterial.Text))
                    {
                        str.Read(auxcodMaterial, 0, 8);
                    }    
                    string codMaterial = new string(auxcodMaterial);

                    //loads next form
                    Form destino = new frmConsultarPosicao_3(codMaterial);
                    destino.Show();

                    Cursor.Current = Cursors.Default;
                    Cursor.Show();

                    //closes and dispose of the current form
                    this.Close();
                    this.Dispose(true);
                }    
            }

            catch (ObjectDisposedException ex)
            {
                MessageBox.Show(ex.Message);
            }
        }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T17:56:11.237

在不了解您的条形码阅读器的 API 和行为的更多信息的情况下，我猜您有一个竞争条件，当您在 tbCodMaterial_TextChanged 中时，您的 BarCodeRead 事件可能会触发。我建议在禁用扫描器的代码周围放置一个同步块，并且在该块内仅在扫描器为非空时执行关闭：

```
private readonly Object mySynchronizationObject = new Object;
...
lock (mySynchronizationObject)
{
    if (leitor != null)
    {
         //disposal of the barcodereader instance
         ...
    }
} 
```

在关闭之前（在上述锁内）断开与事件的连接也没有什么坏处：

```
leitor.BarcodeRead -= new BarcodeReadEventHandler(this.eventoLeitorCodigoDeBarrasArmazenagem1); 
```

# ms-access - Window 7 任务计划程序失败，0x80 运行 MS Access Query

> ID：15141408
> 
> 赞同：0
> 
> 时间：2013-02-28T17:04:03.867
> 
> 标签：ms-access, scheduled-tasks

我已经安排了一个任务来运行一个 .DAT 文件，该文件打开并执行一个 MS Access 宏，然后终止 MS Access 任务。脚本如下：

```
"C:\Program Files (x86)\Microsoft Office\Office14\MSACCESS" "\\net\group\sales.accdb" /x "Refresh - 03 - Refresh and Archive"
taskkill /f /im MSACCESS.EXE 
```

请注意，此数据库文件位于网络驱动器上。

当我运行脚本文件（双击它）时，数据库打开，查询被执行，MS Access 关闭。当我将任务安排为测试时，脚本执行并且一切正常。

任务安排在早上 6:00。我在运行任务时登录到计算机但计算机被锁定。我已确认我拥有管理员权限，并且管理员组拥有“批处理作业”权限。有关我找到/关注的参考资料，请参见[此处](http://forums.techguy.org/windows-xp/878784-0x80-error-scheduled-tasks.html)、[此处](http://www.eventid.net/display.asp?eventid=7901&eventno=113&source=Schedule&phase=1)、[此处](http://technet.microsoft.com/en-us/library/cc957131.aspx)和[此处。](http://www.brooksnet.com/faq/117-02.html)这似乎是一些人在收到此错误时面临的问题。该任务在选项中设置为运行“用户是否登录”。我知道数据库至少正在打开，因为锁定文件 (.LACCDB) 是在同一目录中生成的，并且最后修改的日期和时间是计划任务的日期和时间。

最后，我在另一个成功运行的数据库上使用任务调度程序运行了一个宏。此任务在任务属性中具有相同的设置，并且 .DAT 文件与失败并显示 0x80 的任务相同。

为什么这个任务失败了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-17T17:53:36.253

发现我的宏在写入时试图读取文本文件。这当然打破了宏。

# php - wamp 上的 php mssql 扩展

> ID：15141415
> 
> 赞同：5
> 
> 时间：2013-02-28T17:04:27.497
> 
> 标签：php, sql-server, database, wamp, wampserver

我正在尝试让 wamp php 与 MsSQL DB 进行通信，但我似乎无法使其工作。我在浏览器（Chrome）上收到的当前错误消息是：

```
Warning: mssql_connect() [function.mssql-connect]: Unable to connect to server: (...) Couldn't connect to SQL Server 
```

1.  ntwdblib.dll 是正确的版本 (2000.80.194.0)

2.  我不能使用 php_sqlsrv（部署服务器仅限 linux，sqlsrv 仅限 Windows），尽管使用 sqlsrv 我可以得出访问信息正确的结论（服务器、用户、密码）

3.  我已经降级回 wampserver 2.1e 和 php 5.3.1（有些人让它像这样工作）

4.  当我重新启动 wamp 服务器时，apache_error.log 上没有错误

5.  在我的机器上安装 freetds 会挂起 apache

6.  远程机器成功使用php_mssql.dll（linux服务器）

我正在使用的代码：

```
<?php
$dbhandle = mssql_connect($ip,$user,$pass) or die("Couldn't connect to SQL Server on $ip"); 
$selected = mssql_select_db($dbname,$dbhandle) or die("Couldn't open database at SQL server: $ip");
?> 
```

我现在要尝试一个 linux 虚拟机，但即使这样肯定会很痛苦（速度慢且功能少）。

我的系统：Windows 7、Wampserver 2.1e、PHP 5.3.1

我还能尝试什么？:(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-17T22:10:37.123

假设您已尝试从此处安装驱动程序/扩展：http: [//www.microsoft.com/en-gb/download/details.aspx?id=20098](http://www.microsoft.com/en-gb/download/details.aspx?id=20098) 并且您已更改`php.ini`*AMP 堆栈的`PHP`文件夹..; 并将 mssql 扩展名放在`php/ext`文件夹中...

经过几个小时的查找，本指南成功地将我连接到 MS SQL 数据库。 [http://webcheatsheet.com/php/connect_mssql_database.php](http://webcheatsheet.com/php/connect_mssql_database.php)

编辑：此外，我的连接类将 DB Uname PW 和 serverIP 作为构造函数参数，并且**构造函数调用函数 setCon()**，因此在创建对象时也是如此。然后我可以以 OOP 样式调用对连接对象的查询

```
 function setCon(){
    $conn = mssql_connect($this->server, $this->UName, $this->pw);
    if ($conn){
        echo "Connection established @ $this->server.$this->DB (Connected to MS SQL DB)\n";
    }
    else{
        echo "Connection could not be established.";
        die( print_r( sqlsrv_errors(), true));
    } 
```

然后稍后需要访问创建的连接

```
function getCon(){
    return mssql_connect($this->server, $this->UName, $this->pw);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T17:06:55.560

你安装了 MsSQL 吗？因为 WAMP 的 M 是 MySQL 而不是 MSSQL。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-29T13:16:53.220

实际上，默认情况下 wampserver 不附带 php_mssql.dll，扩展是在 php_pdo_mssql 或 php_dblib 之上创建的。在 x64 wampserver 2 PHP 5.3.13 上测试

*   使用 php_pdo_mssql

    1.  安装 wampserver
    2.  激活 php_pdo_mssql
    3.  激活 php_mssql
    4.  将 ntwdblib.dll 复制到 bin/php/php{version}/ext/ 和 bin/apache/{version}/bin
    5.  重启所有服务
*   使用 php_dblib

    1.  而不是 php_pdo_mssql 激活 php_dblib。

**警告**不要同时激活 php_pdo_mssql 和 php_dblib。

在不同版本的 php wampserver 上，在 5.3.1 第一个解决方案对我有效，但在 5.3.13 第二个。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-28T17:08:55.107

> 无法连接到服务器：(...) 无法连接到 SQL Server"

您是否在 PHP 中为 MS-SQL 安装了任何驱动程序模块？

此外，虚拟机不一定很慢而且没有特色——至少它可以工作:)

MDB2 或 PDO 可能最适合抽象数据库 I/O。

问：你能打开一个终端到 MS-SQL，例如 Telnet 吗？

（这至少可以解决任何类型的连接问题）。

你可能需要这个模块：PECL odbtp >= 1.1.1 (open database transport protocol)

```
extension=php_mssql.dll 
```

^ 此外，如果此扩展已加载，请检查 phpinfo() 一次。

[http://www.php.net/manual/en/mssql.installation.php](http://www.php.net/manual/en/mssql.installation.php)

好吧 - 在 Windows 上安装 mySQL 不会有任何问题（以防万一）。

# gwt - 如何为每个项目设置 CellList 项目的样式？

> ID：15141416
> 
> 赞同：0
> 
> 时间：2013-02-28T17:04:37.190
> 
> 标签：gwt, celllist

我在 GWT 2.5 中有一个 CellList。每个单元格项都是一个基于 AbstractCell 的类，并在 UiBinder 文件中定义。

如何为每个项目设置不同的样式？我希望一些以“禁用”风格出现，而另一些以“活跃”风格出现。

这是我的 .ui.xml 文件中的内容。我没有包含样式定义或 UiBinder 脚手架。

```
<div class="{style.contact}">
    <div>
        <div>
            <img class="{style.photo}" src="{photo}"/>
        </div>
        <div class="{style.names}">
            <div>
                <p><ui:text from="{name}"/></p>
                <p><ui:text from="{jobTitle}"/></p>
                <p><ui:text from="{company}"/></p>
            </div>
        </div>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T03:37:13.597

您可以通过覆盖单元格的 render() 方法来添加样式名称，如下所示 -

```
@Override
public void render( com.google.gwt.cell.client.Cell.Context context, T value, SafeHtmlBuilder sb )
{   
    if( disable condition met )
    {
            // Apply disabled style
        sb.appendHtmlConstant( "<div class='css-style-disabled' >"+ value+" </div>" 
    } 
    else
    {
            super.render( context, value, sb );
    } 
} 
```

因此，将`css-style-disabled`类添加到您的 css 文件开始设置样式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T04:00:12.650

使用`CellList.getRowElement()`：

```
cellList.getRowElement(3).addClassName("css-disabled");
cellList.getRowElement(4).addClassName("css-active"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T16:37:16.843

texasbruce 的答案是解决方案，但如果您使用的是 ListDataProvider，那么您需要修改对 addClassName() 的任何调用的时间，因此：

```
new Timer() {
    @Override
    public void run() {
        << call cellList.getRowElement(0).addClassName("css-disabled") here >>;
    }
}.schedule(1); 
```

# visual-studio-2010 - Visual Studio 不会释放我的 dll

> ID：15141419
> 
> 赞同：1
> 
> 时间：2013-02-28T17:04:42.507
> 
> 标签：visual-studio-2010

每隔一段时间，当我尝试重建我的项目时，我会收到 DLL 仍在使用中的消息。从 Windows 资源管理器中，我无法删除有问题的 dll。我运行 Handle 来查看使用 dll 的内容，它让我回到 devenv.exe。

有谁知道为什么会发生这种情况，有什么方法可以防止它，或者有什么方法可以在不关闭并重新打开 Visual Studio 的情况下释放 DLL？

如果您需要更多详细信息，请向他们索取。

# python - python程序的Apache服务器文件权限

> ID：15141422
> 
> 赞同：0
> 
> 时间：2013-02-28T17:04:46.323
> 
> 标签：python, apache, file, permissions

我的网站有一个奇怪的问题。首先，我有一个收集一些数据的站点，然后将它们存储在 MySQL 数据库中，然后调用 Python 程序。虽然一切运行良好，但由于文件权限，Python 程序无法正常工作。当 python 代码创建一些文件夹并将一些文件放入其中时，问题就开始了。在创建文件时，没有任何内容写入其中。当我查找文件的权限时，它们似乎是由“www-data”用户创建的。为什么 Python 程序对其创建的文件没有权限？

PS我应该指出，当我从终端作为普通用户或我的本地主机配置运行它时，一切正常！

# html - html跨平台动画库

> ID：15141424
> 
> 赞同：0
> 
> 时间：2013-02-28T17:04:51.787
> 
> 标签：html, animation, cross-platform

我很难找到一个跨平台库来构建一些小型 html 游戏，平台包括：IE8+、FF、Chrome、Safari、Android、IOS

好吧我不想用Flash，也不能用Flash因为反正有IOS

第一眼我发现了 Kinetic.js，试用后似乎真的很方便，但我在 IE8 上找不到任何画布后备

第二次瞥见我找到了Raphael，也确实不错，但是Android不支持SVG

我不认为 jQuery 动画是正确的方法，毕竟它不是为游戏而设计的

所以..有什么建议吗？

请不要告诉我我必须自己写一大堆过渡..

提前致谢！

# msbuild - 如何将 PreProcessorDefinitions 设置为 msbuild 任务的任务属性

> ID：15141429
> 
> 赞同：12
> 
> 时间：2013-02-28T17:05:03.120
> 
> 标签：msbuild

以下内容来自一个常规的 VS2010 C++ 项目。

```
 <ClCompile>
      <WarningLevel>Level3</WarningLevel>
      <PrecompiledHeader>Use</PrecompiledHeader>
      <Optimization>MaxSpeed</Optimization>
      <FunctionLevelLinking>true</FunctionLevelLinking>
      <IntrinsicFunctions>true</IntrinsicFunctions>
      <PreprocessorDefinitions>WIN32;NDEBUG;_CONSOLE;%(PreprocessorDefinitions)</PreprocessorDefinitions>
    </ClCompile> 
```

如果我编辑`PreprocessorDefinitions`我可以设置预处理器使用的定义。我可以通过`#ifdef`等在我的代码中看到这一点。

但是，如果我使用以下

```
 <Target Name="NormalBuild" Condition=" '$(_InvalidConfigurationWarning)' != 'true' " DependsOnTargets="_DetermineManagedStateFromCL;CustomBeforeBuild;$(BuildDependsOn)" Returns="@(ManagedTargetPath)">
    <ItemGroup>
        <ManagedTargetPath Include="$(TargetPath)" Condition="'$(ManagedAssembly)' == 'true'" />
    </ItemGroup>
      <Message Text="PreprocessorDefinitions: $(PreprocessorDefinitions)" Importance="High" />
  </Target>

  <Target Name="TestBuild" Returns="@(ManagedTargetPath)">
    <MSBuild Projects="demo.vcxproj" Targets="NormalBuild" Properties="PreprocessorDefinitions=THISGETSSETBUTDOESNOTHING"/>
  </Target> 
```

我还可以通过`PreprocessorDefinitions`包含我设置的值的消息看到，`Properties="PreprocessorDefinitions=THISGETSSETBUTDOESNOTHING"`但我无法使用`#ifdef`等控制我的构建。如果我使用常规设置并尝试`PreprocessorDefinitions`使用`<Message Text="PreprocessorDefinitions: $(PreprocessorDefinitions)"`该字段进行输出，该字段实际上是空白的，并且不包含预期的内容，`<PreprocessorDefinitions>WIN32;NDEBUG;_CONSOLE;%(PreprocessorDefinitions)</PreprocessorDefinitions>`尽管我可以使用使用这些键中的任何一个来控制我的构建`#ifdef`等等。

1.  这是为什么？
2.  我可以做些什么来通过任务`Properties`元素传递 PreprocessorDefinitions für VS2010 C++ 项目？

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2013-07-03T11:22:51.607

这可以在不修改原始项目的情况下完成：在 中完成的第一件事`Microsoft.Cpp.Targets`，通常是在普通 C++ 项目中导入的最后一件事，是检查是否有一个属性被调用`ForceImportBeforeCppTargets`，如果有，则导入它。

因此，假设您要添加`ADDITIONAL`到预处理器定义中，您创建一个像这样的文件“override.props”（为了完全自动化，请使用`WritelinesToFile`任务来创建文件）：

```
<?xml version="1.0" encoding="utf-8"?> 
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

  <ItemDefinitionGroup>
    <ClCompile>
      <PreprocessorDefinitions>%(PreprocessorDefinitions);ADDITIONAL</PreprocessorDefinitions>
    </ClCompile>
  </ItemDefinitionGroup>

</Project> 
```

并打电话

```
<MSBuild Projects="demo.vcxproj" 
         Properties="ForceImportBeforeCppTargets=override.props"/> 
```

或从命令行

```
msbuild demo.vcxproj /p:ForceImportBeforeCppTargets=override.props 
```

*请注意*，正如richb 在评论中指出的那样，上述方法仅在 msbuild 的查找规则可以找到 override.props 时才有效。为确保始终找到它，只需指定完整路径。

**更新**

几年后，在 msbuild 15 及更高版本中，出现[了自定义构建的新方法](https://docs.microsoft.com/en-us/visualstudio/msbuild/customize-your-build?view=vs-2019)。与上面的原理相同，但更简单：msbuild 将自动`Directory.Build.props`获取项目文件目录中命名的文件，甚至是上面的所有目录，而不需要额外的命令行选项（因此，在 VS 中也可以正常工作）。项目文件也变得不那么冗长了：

```
<Project>
  <ItemDefinitionGroup>
    <ClCompile>
      <PreprocessorDefinitions>%(PreprocessorDefinitions);ADDITIONAL</PreprocessorDefinitions>
    </ClCompile>
  </ItemDefinitionGroup>
</Project> 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-28T17:25:33.453

如果不进行修改，则无法执行此操作，`demo.vcxproj`因为您需要访问`PreprocessorDefinitions`of `CLCompile`，它不是 a `PropertyGroup`，因此无法通过 MSBuild 命令行传递。

**您可以通过Project Properties -> Configuration Propertis -> C/C++ -> Preprocessor**在 GUI 中修改预处理器定义，或直接编辑 XML：

```
 <ClCompile>
    ....
    <PreprocessorDefinitions>$(MyMacro);%(PreprocessorDefinitions)</PreprocessorDefinitions>
  </ClCompile> 
```

在您的 MSBuild 项目中：

```
 <Target Name="TestBuild" Returns="@(ManagedTargetPath)">
    <MSBuild Projects="demo.vcxproj" Targets="NormalBuild" Properties="MyMacro=THISGETSSETBUTDOESNOTHING"/>
  </Target> 
```

这相当于将 MSBuild.exe 运行为：

```
 MSBuild demo.vcxproj /p:MyMacro=THISGETSSETBUTDOESNOTHING 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-04-07T12:42:03.693

根据@Kevin 的回答，您需要在 PropertySheet 中定义用户定义的宏。然后创建一个引用用户定义宏的预处理器。您现在可以在代码中使用新的预处理器值。最后，对于构建，您可以使用`/p`标志更改用户定义的宏的值。在这里，我定义了一个用户定义的值`mymacro`和一个预处理器值，比如`VAL`. 现在您可以简单地使用`/p:mymacro="\"some thing new\""`.

```
#include <iostream>

int main() {
    std::cout << VAL << std::endl;

    getchar();
} 
```

`yourproject.vcxproj`：

```
<ClCompile>
  ...
  <PreprocessorDefinitions>VAL=$(mymacro);%(PreprocessorDefinitions)</PreprocessorDefinitions>
</ClCompile> 
```

`msbuild yourproject.vcxproj /p:mymacro="\"some thing new\""`

# c# - Selenium 将文本粘贴到 textarea

> ID：15141430
> 
> 赞同：2
> 
> 时间：2013-02-28T17:05:04.710
> 
> 标签：c#, .net, selenium

使用 Selenium，我想编辑`textarea`. 调用`textarea.SendKeys("My text")`有效，但它逐个字母地键入它，这对于较长的字符串显然很慢。

我发现的一种解决方法 ( [http://code.google.com/p/selenium/issues/detail?id=2876](http://code.google.com/p/selenium/issues/detail?id=2876) ) 建议我将字符串复制到剪贴板并将其粘贴到`textarea`. 他们给出的参考在和`Keys`之间是模棱两可的，所以我两个都试过了。这是我的代码：`OpenQA.Selenium.Keys``System.Windows.Forms.Keys`

```
Clipboard.SetDataObject("My  text");
textarea.SendKeys(OpenQA.Selenium.Keys.Control + "v"); 
```

这会冻结应用程序。如果我改用`System.Windows.Forms.Keys.Control`它，它会输入 controlv，这显然不是我想要的。

有谁知道问题可能是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-09-04T19:33:07.777

将剪贴板设置为文本时，我可以使用相同的 SendKeys：

```
Clipboard.SetText(trgt);
myTextArea.SendKeys(OpenQA.Selenium.Keys.Control + "v"); 
```

所以也许 SetDataObject 是一个问题

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-05-11T12:28:12.033

希望这个 CopyPaste 方法有帮助：

```
using OpenQA.Selenium.Interactions;
     public void CopyPaste(string copy)
    {
        Clipboard.SetText(copy);
        new Actions(driver).SendKeys(OpenQA.Selenium.Keys.LeftShift + OpenQA.Selenium.Keys.Insert).Perform();
//because it switch to uppercase we do one more click
        new Actions(driver).SendKeys(OpenQA.Selenium.Keys.LeftShift).Perform();
    }

texarea.Click;
// if driver refuse to click textarea you can force it with:
//((IJavaScriptExecutor)driver).ExecuteScript("arguments[0].click();", driver.FindElement(By.XPath("//*[@id='MyTextareaId']")));
// not proven, but I think textarea.SendKeys(""); Will click inside the textarea

//Call the method
CopyPaste("Text Appear In the Textarea"); 
```

# java - 通过访问来自 2 个文件的数据并使用不同颜色显示文件 1 和文件 2 的数据，使用 jfreechart 创建条形图

> ID：15141434
> 
> 赞同：0
> 
> 时间：2013-02-28T17:05:18.300
> 
> 标签：java, jfreechart, bar-chart

这是我用于显示特定值的代码，例如。平均一个文件。现在我想为这两个文件中的值创建条形图，并用不同的颜色表示。请帮助：

公共 JFreeChart createBarChartFromCSV() {

```
 CSVFileReader csvReader = new CSVFileReader();
    List<String[]> csvData = null; 
    int indexOfAverage = 0;

    csvData = csvReader.getDataFromCSV(CSVFileReader.CSVFILENAME);

    for(String[] columnArray : csvData)
        for(int i = 0; i< columnArray.length; i++)
            if(columnArray[i].equalsIgnoreCase("average")){
                indexOfAverage = i;
                break;
            }

    if(indexOfAverage == 0){
        System.err.println("Error retrieving data from CSV File !!");
        System.exit(0);
    }
    JFreeChart barChart = generateBarChart(csvData, indexOfAverage);

    return barChart;
}

private JFreeChart generateBarChart(List<String[]> csvData, int columnIndex){

    DefaultCategoryDataset dataSet = new DefaultCategoryDataset();

    final String YAXIS_NAME = csvData.get(0)[columnIndex]; //value returned is "average"
    final String XAXIS_NAME = csvData.get(0)[0]; //value returned is "sampler_label"

    for(int i = 1; i < csvData.size() - 1; i++){

        long averageValue = Long.parseLong(csvData.get(i)[columnIndex]);
        String columnKey = csvData.get(i)[0];

        dataSet.setValue(averageValue, YAXIS_NAME, columnKey); // plot the graph
    }

    JFreeChart chart = ChartFactory.createBarChart("Comparison between the average of 2 values", XAXIS_NAME, YAXIS_NAME, dataSet, PlotOrientation.VERTICAL, false, true, false);
    return chart;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T17:49:21.310

您似乎正在为每个系列制作一个单独的数据集，并为每个数据集制作一个单独的图表。相反，您希望一个数据集在一个图表中包含两个系列。A`DefaultCategoryDataset`可以有多个系列；每个系列由`rowKey`改变数据集的方法中的参数标识。一个很好的例子是，[这里](http://www.jfree.org/jfreechart/api/javadoc/org/jfree/chart/renderer/category/BarRenderer.html)用三个系列[`BarChartDemo1`](http://www.jfree.org/jfreechart/api/javadoc/org/jfree/chart/demo/BarChartDemo1.html)描绘；[源代码](http://www.jfree.org/jfreechart/api/javadoc/src-html/org/jfree/chart/demo/BarChartDemo1.html#line.65)随发行版一起提供。

顺便说一句，您可能还会查看是否[`org.jfree.data.io.CSV`](http://www.jfree.org/jfreechart/api/javadoc/org/jfree/data/io/CSV.html)满足您的要求。

# javascript - Chrome 未运行 D3.js

> ID：15141439
> 
> 赞同：4
> 
> 时间：2013-02-28T17:05:27.833
> 
> 标签：javascript, google-chrome, d3.js

我知道这是某种安全问题，chrome 没有运行它不信任的文件，但有人知道有没有办法解决这个问题？

除了在服务器上运行我的代码。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T17:08:56.573

我假设您正在使用本地文件运行。启动 Chrome 时，您可以使用该`--allow-file-access-from-files`标志使其加载本地 JSON（例如）或`--disable-web-security`完全禁用安全机制。

请注意，根据您的 Chrome 版本，这些标志可能有效，也可能无效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-08-31T19:14:49.167

`http-server`全局安装：

[https://www.npmjs.com/package/http-server](https://www.npmjs.com/package/http-server)

这是一种非常快速的本地开发方式。使用标志禁用文件访问会导致其他不良做法和意外情况。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2018-08-31T18:51:46.593

如果使用 Windows，您可以创建一个快捷方式，其中“目标”包含命令（而不必从命令行运行 Chrome：

```
"C:\Program Files (x86)\Google\Chrome\Application\chrome.exe" --allow-file-access-from-files 
```

# c - SystemC 中的 OpenCV

> ID：15141441
> 
> 赞同：5
> 
> 时间：2013-02-28T17:05:29.133
> 
> 标签：c, opencv, systemc

我在几个应用程序中都使用了 OpenCV 和 SystemC，非常满意。

现在，我有了这个应用程序，我需要在 SystemC 仿真环境中使用 OpenCV 显示图像。然而，出于某种原因，这两个包似乎“在运行时”不兼容：

*   `cvNamedWindow`当我调用或`cvShowImage`在 SystemC 类中调用之前没有问题`sc_start()`。
*   但是，当在 a 中调用`cvNamedWindow`or时，程序的执行将被中止： `cvShowImage``sc_thread`

    > 线程 1：EXC_BAD_ACCESS（代码=2，地址=0x7c91ad70）。

查询框架（ ）没有问题，`cvQueryFrame`似乎只有与窗口相关的功能会导致问题。如果有人知道可能导致此问题的原因，并且对此问题有解决方案或解决方法，那就太好了。

PS我正在使用Xcode，但我认为问题与编码环境无关。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-28T17:32:19.097

**它不起作用**，**[SystemC](http://en.wikipedia.org/wiki/SystemC)**不支持**GUI**（图形用户界面）。

有人对这个主题做了一些研究：[为 SystemC 实现图形用户界面](http://www.iro.umontreal.ca/~tsikhana/HDLCon2001.pdf)

> SystemC 是一个开源库，用于开发软件算法模型、硬件架构和系统级设计。尽管 SystemC 对硬件描述的可能性非常丰富，但模拟是通过控制台应用程序进行的，因此只有文本，因此查看结果很麻烦。我们的目标是为 SystemC 开发一个 GUI，以提供更直观的模拟结果表示。我们将记录我们的实验并比较我们的解决方案在模拟时间方面的成本。

# facebook - 致命错误：未捕获的 OAuthException：验证访问令牌时出错

> ID：15141442
> 
> 赞同：-2
> 
> 时间：2013-02-28T17:05:31.130
> 
> 标签：facebook

```
require ('facebook.php');

define('FACEBOOK_APP_ID',"My_ID");
define('FACEBOOK_SECRET',"My_Secret");
define('REDIRECT_URI',"My_Website");
define('PERMISSIONS_REQUIRED', "publish_stream");
$facebook = new Facebook(array(
    'appId' => FACEBOOK_APP_ID,
    'secret' => FACEBOOK_SECRET,
    'cookie' => true
));
    $access_token = $facebook->getAccessToken();

    $query = mysql_query("SELECT `title` FROM `tentego_img` WHERE `id` = ".intval($_GET['id'])."");
    $r = mysql_fetch_array($query);
    $link = $_SERVER['SERVER_NAME'].$_SERVER['REQUEST_URI'];

    $facebook->api('/me/feed', 'POST',
                                    array(
                                      'link' => $link,
                                      'message' => $r[0]
                                 )); 
```

错误：致命错误：未捕获 OAuthException：必须使用活动访问令牌来查询有关当前用户的信息。

请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T20:18:57.727

试试`getAccessTokenFromCode($_GET['code'],REDIRECT_URI)`吧，它应该可以工作。这个对我有用。您修改后的代码：

```
require ('facebook.php');

define('FACEBOOK_APP_ID',"My_ID");
define('FACEBOOK_SECRET',"My_Secret");
define('REDIRECT_URI',"My_Website");
define('PERMISSIONS_REQUIRED', "publish_stream");
$facebook = new Facebook(array(
    'appId' => FACEBOOK_APP_ID,
    'secret' => FACEBOOK_SECRET,
    'cookie' => true
));
if(isset($_GET['code']))
{
    $access_token = $facebook->getAccessTokenFromCode($_GET['code'],REDIRECT_URI);
     $facebook->setAccessToken($access_token);
    $query = mysql_query("SELECT `title` FROM `tentego_img` WHERE `id` = ".intval($_GET['id'])."");
    $r = mysql_fetch_array($query);
    $link = $_SERVER['SERVER_NAME'].$_SERVER['REQUEST_URI'];

    $facebook->api('/me/feed', 'POST',
                                    array(
                                      'link' => $link,
                                      'message' => $r[0]
                                 ));
}else
{
    $login_url = $facebook->getLoginUrl($params =array('redirect_uri'=>REDIRECT_URI,'scope' => PERMISSIONS_REQUIRED));
 echo ("<script> top.location.href='".$login_url."'</script>");
} 
```

# javascript - javascript中的父文件夹不起作用

> ID：15141444
> 
> 赞同：1
> 
> 时间：2013-02-28T17:05:39.273
> 
> 标签：javascript, jquery, ajax

我有一个结构旧的网站，我需要改变它的结构。

[http://localhost/enc/pdfs/](http://localhost/enc/pdfs/)：其中包含我通过 ajax 上传的一些 html 文件，以便使用选项卡式 div。

```
 var Tabs = {
                'part1' : 'http://www.bsafer.com/enc/pdfs/part1.html',
...
            } 
```

js 文件在文件夹中： ...enc/wp-content/themes/twentyten/

这个结构一切正常。

我需要制作这个新结构：

......./enc/wp-content/themes/twentyten/pdfs/ 用于 htmls 文件。

......./enc/wp-content/themes/twentyten/js/ 用于 js 文件。

所以我将js代码更改为：

```
 var Tabs = {
                'part1' : '../pdfs/part1.html',

....
            } 
```

脚本的 url 设置正确，我可以在代码源中看到它。

为什么它甚至无法正常工作 ../ 意味着返回父文件夹？

感谢您在这个问题上帮助我，URL 真的让我浪费时间。

请注意，我在 localhost 中工作，并且不允许在我的地址中使用 localhost，并且我需要 15 个声望才能发布超过 2 个链接。

最好的祝福

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T17:20:24.220

欢迎来到 SO！

您可能想要使用`BASE`标签，然后提供完整地址 ( [http://www.w3.org/TR/html-markup/base.html](http://www.w3.org/TR/html-markup/base.html) )。当然，如果您这样做，您需要将所有 URL 更改为相对 URL，因为它会将基础添加到页面上的每个 URL 链接。

如果不查看您的代码，很难判断，但 Javascript ajax 可能无法与`BASE`标记一起使用。（我之前没有用 AJAZ 尝试过）。`attr`但是，如果您使用 javascript拉锚，它应该可以工作。

# ruby-on-rails - 如何组织 Rails 集成/功能规范

> ID：15141448
> 
> 赞同：2
> 
> 时间：2013-02-28T17:05:51.993
> 
> 标签：ruby-on-rails, ruby, rspec, tdd, capybara

对于控制器，我测试了每个动作，例如：

```
describe PostsController do
  describe "GET #new"
  describe "GET #edit"
  describe "DELETE #destroy"
  ... 
```

如何组织我的集成/功能测试？遵循控制器结构或用户故事或其他什么？我正在使用水豚。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T17:42:27.097

我首先根据动作来组织它。然后在每个动作中，我在好用户和坏用户之间组织我的测试。我相信有人会更深入，但那是我的两分钱。

好用户 - 做所有事情的用户，将正确的信息放入表单等。

不良用户 - 潜在的黑客，或只是将不良信息插入您的网站的人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-11-30T22:25:21.030

使用 Capybara 时，通常希望为每个用户故事创建一个文件，因为这样可以更轻松地重用任何背景设置。

将它们保持小（不超过 3 或 4`scenario`个方块）通常是有益的，否则它们可能难以遵循。

如果您需要一种组织测试代码的方法，以便不将集成测试与 UI 耦合，您可以尝试使用[**Capybara Test Helpers**](https://capybara-test-helpers.netlify.app/)，它允许您封装与组件和页面的交互。

# c - int *ptr = (int*)(&a + 1);

> ID：15141450
> 
> 赞同：6
> 
> 时间：2013-02-28T17:05:54.850
> 
> 标签：c, pointers

```
#include <stdio.h>

int main(void)
{
   int a[5] = { 1, 2, 3, 4, 5 };

   int *ptr = (int*)(&a + 1);  // what happens here ?

   printf("%d %d\n", *(a + 1), *(ptr - 1));

   return 0;
} 
```

我预计答案是 1 但得到 5 .. 为什么？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-28T17:09:05.473

```
int *ptr = (int*)(&a + 1);  // what happen here ? 
```

获取数组的地址，然后将 1 添加到其中，这会产生一个指针，该指针`sizeof a`指向`a`. 然后将该指针强制转换为`int*`，并将其分配给`ptr`。同样可以实现

```
int *ptr = &a[5]; 
```

在这种情况下。

然后`ptr - 1`是一个指针，指向`sizeof(int)`之前的字节`ptr`，即指向`&a[4]`，并且`*(ptr - 1)`是`a[4]`。

指针运算以“指针大小”为单位进行。由于`&a`是指向 5 `int`- an 数组的指针`int (*)[5]`，因此向它添加 1 会移动它的`5*sizeof(int)`字节。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-28T17:08:44.333

`&a`是指向指针的指针`int[5]`，因此`&a + 1`又是指向 的指针`int[5]`。松开`&`并且一切都应该没问题（而且你将不再需要演员表）：

```
int *ptr = a + 1; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-01T02:25:29.070

```
int *ptr = (int*)(&a + 1);  // what happen here ? 
```

a= 数组第一个元素的地址：a[0]（int 的地址）

&a = 数组 a 的地址，与 "a" 的值相同，但类型是数组的地址，因此表达式 "(&a + 1)" 是指向下一个数组 "a" 的指针。(ptr - 1)：指向ptr的前一个int的指针，即数组“a”的最后一个元素的指针。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-12-08T06:42:32.653

数组名称保存数组的基地址。因此，*(a+1) 给出索引位置 1 处的元素，即 2。表达式 (&a + 1) 保存数组末尾之后的地址，并将其存储在指针变量“ptr”中。因此，*(ptr-1) 给出了存储在最后一个索引位置 5 的元素。

# jquery - 从表格文本创建多维数组

> ID：15141456
> 
> 赞同：2
> 
> 时间：2013-02-28T17:06:06.893
> 
> 标签：jquery, arrays, multidimensional-array, html-table

我试图将文本从 a`<table>`放入一个数组中，作为一个文本数组。

示例 HTML：

```
<table class="sort">
    <caption>Census Data</caption>
    <tr>
        <th class="alpha">First Name:</th>
        <th class="alpha">Last Name:</th>
        <th class="date">Date of Birth:</th>
        <th class="numeric">Age:</th>
        <th class="alpha">Gender:</th>
    </tr>
    <tr>
        <td>Peter</td>
        <td>Parker</td>
        <td>12/23/1975</td>
        <td>36</td>
        <td>Male</td>
    </tr>
    <tr>
        <td>John</td>
        <td>Doe</td>
        <td>06/09/1982</td>
        <td>30</td>
        <td>Male</td>
    </tr>
</table> 
```

最终目标是拥有这样的数组：

```
var array = [
             ["Peter", "Parker", "12/23/1975", "36", "male"], 
             ["John", "Doe", "06/09/1982", "30", "male"]
            ]; 
```

这就是我目前所拥有的，我的问题似乎与我的内部返回在到达外部地图时实际上不是一个数组有关。当我`alert(innerArray.toString());`给我逗号分隔的字符串时，就好像它是内部的字符串，但在外部，它似乎`join`将数组合二为一，而不是使其成为多维的。

```
var outerArray = $(".sort tr").not(":first-child").map(function(){
    var innerArray = $(this).children().map(function(){
       return $(this).text();
    }).toArray();           
    return innerArray;
}).toArray(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T17:29:48.010

使用 map 可能有一些花哨的方法，但我更喜欢循环，`each`因为它更容易理解和维护。

```
var resultArray = [];

$(".sort tr").not(":first-child").each(function () {
    var innerArray = [];

    $(this).find('td').each(function () {
        innerArray.push($(this).text());
    });

    resultArray.push(innerArray);
}); 
```

[工作示例](http://jsfiddle.net/R8VAK/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T17:14:17.670

试试这个 ：

```
var outerArray = new Array() ;

$('.sort').children('tr').each(function(i,elem) {
     outerArray.push(elem.children('td')) ;
}); 
```

# java - java中SSLEngine和SSLEngineResults中getHandShakeStatus()的区别

> ID：15141463
> 
> 赞同：1
> 
> 时间：2013-02-28T17:06:26.357
> 
> 标签：java, handshake, sslengine

我正在尝试在 java 中创建与 SSLEngine 的客户端/服务器连接。我想问一下有什么区别`SSLEngine.getHandshakeStatus()`，`SSLEngineResults.getHandshakeStatus().`我找到了 Nuno Santos 的关于`SSLEngine`NIO API 和多路复用的示例代码。

**我参考的代码是：**

```
 //some code here
                    SSLEngineResult.HandshakeStatus hs = engine.getHandshakeStatus();
                    String clientString = "";

                    while (hs != SSLEngineResult.HandshakeStatus.FINISHED && hs != SSLEngineResult.HandshakeStatus.NOT_HANDSHAKING)
                    {
                        switch (hs)
                        {
                        case NEED_UNWRAP:
                            if (socketChannel.read(peerNetData)< 0)
                            {
                                engine.closeInbound();
                            }
                            peerNetData.flip();
                            SSLEngineResult res = engine.unwrap(peerNetData, peerAppData);
                            peerNetData.compact();
                            hs = res.getHandshakeStatus();
                            switch (res.getStatus())
                            {
                            case OK:
                            //TODO something
                                break;
                            case BUFFER_UNDERFLOW:
                        //TODO something
                                break;
                            case BUFFER_OVERFLOW:
                            //TODO something
                                break;
                            case CLOSED:
                            //TODO something
                                engine.closeInbound();
                                break;
                            }
                            break;
                            //more code here 
```

**我找到的代码链接是：** [http ://onjava.com/pub/a/onjava/2004/11/03/ssl-nio.html?page=last&x-order=date](http://onjava.com/pub/a/onjava/2004/11/03/ssl-nio.html?page=last&x-order=date)

示例代码在参考资料部分

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-26T04:07:37.193

他们不一样。`SSLEngineResult.getHandshakeStatus()`通过调用返回的状态`wrap()`或`unwrap()`可以包括 FINISHED，但您永远不会从存储在状态中的状态中得到它，`SSLEngine.`原因是它是一个临时状态。

注意质量差的代码。在您刚刚阅读完流的结尾之后，尝试展开或其他任何事情没有多大意义。

# error-handling - ServiceStack - 如何从 RequestFilter 返回 ResponseDTO？

> ID：15141469
> 
> 赞同：1
> 
> 时间：2013-02-28T17:06:47.177
> 
> 标签：error-handling, request, servicestack

我正在使用 RequestFilter 将一些消息预处理到 Web 服务，如果有错误我想返回一个 ResponseDTO，然后终止对请求的进一步处理。我怎样才能实现该功能？

此外，我通过在 RequestDTO 类上使用 [RequestFilter] 装饰器来实现这一点。如果我想拥有多个请求过滤器，如何选择要用于给定 RequestDTO 的过滤器？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T18:19:59.177

**如果有错误我想返回一个 ResponseDTO，然后终止对请求的进一步处理。我怎样才能实现该功能？**不完全确定您将如何确定错误，因此这是一个非常基本的解决方案。

```
public class RequestFilterAttribute : Attribute, IHasRequestFilter
{
    public void RequestFilter(IHttpRequest req, IHttpResponse res, object requestDto)
    {
        if(requestDto.GetType() == typeof(YourRequestType))
        {
            //code to check for errors - if error throw exception 
            throw new Exception("Exception for your request type");
        }
    }
} 
```

**如果我想拥有多个请求过滤器，如何选择要用于给定 RequestDTO 的过滤器？**

您可以创建几个不同的 RequestFilter 实现，并用不同的实现装饰您的每个 DTO。

```
public class FilterOneAttribute : Attribute, IHasRequestFilter
{
    //Code
}

public class FilterTwoAttribute : Attribute, IHasRequestFilter
{
    //Code
}

[FilterOne]
public class OneClass 
{
    //Code
}

[FilterTwo]
public class TwoClass
{
    //Code
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-10T15:57:19.590

上面的答案告诉了如何选择过滤器以及如何失败，但没有告诉如何返回成功的替代响应。[How to find Service from ServiceStack RequestFilter](https://stackoverflow.com/questions/15317540/how-to-find-service-from-servicestack-requestfilter/15319620#15319620)展示了如何创建合适的 ResponseDTO。关键是您将 ResponseDTO 序列化为响应流，然后关闭该流。我猜 ServiceStack 将此作为不运行服务或任何其他过滤器的提示。

# sql - 使用 IN 运算符时选择半径内的所有邮政编码非常慢

> ID：15141472
> 
> 赞同：0
> 
> 时间：2013-02-28T17:06:54.613
> 
> 标签：sql, google-maps

我有一张包含美国所有邮政编码的表格，我的查询是选择邮政编码边界坐标和每个邮政编码的分开计数。现在，如果我指定某个邮政编码，则此操作非常快。问题是当我添加 IN 运算符时，我可以获得一定半径内的所有邮政编码。我使用此处显示的大圆函数[http://www.sqlteam.com/forums/topic.asp?TOPIC_ID=81360](http://www.sqlteam.com/forums/topic.asp?TOPIC_ID=81360)来执行此操作。我现在认为的问题是，对于从大圆圈函数返回的每个邮政编码，整个操作都在运行。最终结果是谷歌地图，但这与改进 sql 查询无关。应如何修改此查询以提高性能？我已经在索引邮政编码。任何帮助，将不胜感激！

```
select s.ZipCode, count(a.[Apartment_Complex]) apartCount, b.Longitude, b.Latitude from ZipCodeServiceAvailability s  
                left join pdx_apart_view a on s.ZipCode = left([Zip Code], 5)  
                left join ZipCodeBoundaries b on s.ZipCode = b.ZipCode 
                Where Ordering % 10 = 0 and s.zipcode in 
                                      (Select zipcode from ZipCodeServiceAvailability 
                                       Where AzumaWebInput.dbo.F_GREAT_CIRCLE_DISTANCE
                                             ((Select Latitude from ZipCodeServiceAvailability where ZipCode = '78745'), --latitude
                                              (Select Longitude from ZipCodeServiceAvailability where ZipCode = '78745'), --longitude
                                              Latitude,
                                              Longitude) <  200) -- get all zips within 200 miles of 78745
                Group By s.ZipCode, IsServiced, b.Longitude, b.Latitude, b.Ordering  
                Order by s.ZipCode, b.Ordering 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T17:13:31.633

是的，您正在计算表中每条记录的大圆距离。

更快的查询是在两个纬度和两个经度之间的矩形中获取所有邮政编码。

确保 ZipCodeServiceAvailability 表上有一个包含纬度和经度字段的索引。

编辑：

代替

```
(Select zipcode from ZipCodeServiceAvailability 
                                   Where AzumaWebInput.dbo.F_GREAT_CIRCLE_DISTANCE
                                         ((Select Latitude from ZipCodeServiceAvailability where ZipCode = '78745'), --latitude
                                          (Select Longitude from ZipCodeServiceAvailability where ZipCode = '78745'), --longitude
                                          Latitude,
                                          Longitude) <  200) 
```

和

```
(Select zipcode from ZipCodeServiceAvailability
 Where Latitude between @Latitude - 100 and @Latitude + 100
   and Longitude between @Longitude - 100 and @Longitude + 100) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T18:26:19.987

我想你是对的。但是你为什么要使用子查询呢？子查询是说“原始表中的邮政编码是否在另一个位置 200（英里？）范围内的邮政编码列表中？”。

这与询问：“此邮政编码是否在该位置 200（英里？）范围内？”

你会这样说：

```
select s.ZipCode, count(a.[Apartment_Complex]) apartCount, b.Longitude, b.Latitude
from ZipCodeServiceAvailability s left join
     pdx_apart_view a
     on s.ZipCode = left([Zip Code], 5) left join
     ZipCodeBoundaries b
     on s.ZipCode = b.ZipCode 
Where Ordering % 10 = 0 and
      AzumaWebInput.dbo.F_GREAT_CIRCLE_DISTANCE((Select Latitude from ZipCodeServiceAvailability where ZipCode = '78745'), --latitude
                                                (Select Longitude from ZipCodeServiceAvailability where ZipCode = '78745'), --longitude
                                                Latitude,
                                                Longitude
                                               ) <  200)
Group By s.ZipCode, IsServiced, b.Longitude, b.Latitude, b.Ordering  
Order by s.ZipCode, b.Ordering 
```

# postgresql - 在不中断当前连接的情况下重新加载 postgreSQL？

> ID：15141475
> 
> 赞同：6
> 
> 时间：2013-02-28T17:06:59.010
> 
> 标签：postgresql, command-line, redhat

我想知道我是否向 Postgres 发出了重新加载命令，以便它可以重新读取 pg_hba.conf 文件（在此处进行一些更改并需要它们在实时系统上立即生效）会破坏或断开当前连接吗？

/etc/init.d/postgreSQL83 重新加载

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-28T18:52:40.953

我交叉手指并自己尝试了这个。而且，它奏效了！没有断开连接。所以你实际上可以在命令提示符下发出 postgreSQL reload 命令，它只读取配置文件。它不会重新启动 PostgreSQL 服务器，也不会断开连接。

# web-services - 使用基于肥皂的 Web 服务以编程方式从多个云应用程序（如 salesforce、sap 和 oracle）获取所有数据

> ID：15141476
> 
> 赞同：1
> 
> 时间：2013-02-28T17:07:03.337
> 
> 标签：web-services, soap, salesforce, integration

我需要以编程方式从多个应用程序（如 salesforce、sap 和 oracle）中获取几乎所有数据。大多数这些应用程序通过 Web 服务提供基于肥皂的 API。我使用 Apache Axis (wsdl2java) 编写了一些客户端代码，以从一个实体（表）（例如联系人）中获取记录。大多数应用程序中有数十或数百个实体。我想我必须编写大量代码来获取所有数据。有没有更好的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T17:39:38.947

我意识到您说过您需要以编程方式访问数据，但请查看 salesforce 的[数据导出](http://login.salesforce.com/help/doc/en/admin_exportdata.htm)功能。

对于使用 SOAP API 的程序化导出，如果您希望保持松散类型而不是硬编码您支持的实体列表，您可能需要使用[Partner API](http://www.salesforce.com/us/developer/docs/api/index_Left.htm#StartTopic=Content/sforce_api_quickstart_intro.htm#enterprise_wsdl)。您将执行[describeGlobal()](http://www.salesforce.com/us/developer/docs/api/index_Left.htm#StartTopic=Content/sforce_api_calls_describeglobal.htm#topic-title)以获取支持的实体列表，即对象。然后你可以做一个[describeSObjects()](http://www.salesforce.com/us/developer/docs/api/index_Left.htm#StartTopic=Content/sforce_api_calls_describesobjects.htm)来获取一个对象的字段列表。此时，您可以从该对象中查询并检索记录。

您可能还想查看[Bulk API](http://www.salesforce.com/us/developer/docs/api_asynch/index.htm)，它是为处理大型数据集而设计的。有效载荷是 CSV，这可能对您来说更容易处理。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T16:10:45.537

如果您想定期提取数据，可以使用 Talend Open Studio (Opensource) 提取所有数据；我们在几个 SF 项目中使用 Talend 来做到这一点。它生成 java 代码，您可以将其部署在任何运行 java 的服务器上，并将 cron 用作调度程序。

我们还编写了一个基于 Java 的应用程序，它使用元数据动态获取所有 SF 自定义对象，以便自动从每个对象中提取每日更改以进行每日（增量）备份。

克劳斯

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T06:01:19.837

好的。这是试图回答我自己的问题。我刚刚有了一个想法：我想我可以通过找出 Axis 或 jax-ws 生成的所有对象及其对应的包装类之间的映射，然后创建元数据（object_type、class_name、method_name、 data_types 等），然后有一个元数据驱动的代码来获取所有记录。你认为这是一个好方法吗？

如果我能从社区中获得更多想法和评论，我真的很感激。非常感谢。

# actionscript-3 - 如何使用 ActionScript 3 将变量发送到 Flash 中的其他帧？

> ID：15141477
> 
> 赞同：0
> 
> 时间：2013-02-28T17:07:07.550
> 
> 标签：actionscript-3, flash

我已经构建了一个简单的 Flash 游戏，它只要求用户根据他们从多项选择问题中选择的答案，将鼠标光标从起始位置导航到四个结束位置之一。

我想在游戏中加入一种计分方法。到目前为止，这是我的代码，评分系统不起作用，因为当用户撞墙或得到错误答案时，他们将被引导到另一个框架，该框架向他们显示“不正确”的屏幕并允许他们单击一个按钮，上面写着重试。重试按钮将它们带回主框架，最终将分数重置为 0。如果可能，我将如何将变量传递给其他框架？

```
import flash.events.Event;
import flash.net.*;

var isStart = false; 
var score:Number = 0; 

mc_wall.addEventListener(MouseEvent.MOUSE_OVER,overWall);
function overWall(e:Event) {
if (isStart == true){
gotoAndStop(5);
score -= -2;
}
}

mc_start.addEventListener(MouseEvent.MOUSE_OVER,overStart);
function overStart(e:Event) {
isStart = true;
}

mc_blue.addEventListener(MouseEvent.MOUSE_OVER,overBlue);
function overBlue(e:Event) {
if (isStart == true){
gotoAndStop(4);
score += 10;
isStart = false;
}
}

mc_red.addEventListener(MouseEvent.MOUSE_OVER,overRed);
function overRed(e:Event) {
if (isStart == true){
gotoAndStop(6);
score -= -2;
isStart = false;
}
}

mc_green.addEventListener(MouseEvent.MOUSE_OVER,overGreen);
function overGreen(e:Event) {
if (isStart == true){
gotoAndStop(6);
score -= -2;
isStart = false;
}
}

mc_yellow.addEventListener(MouseEvent.MOUSE_OVER,overYellow);
function overYellow(e:Event) {
if (isStart == true){
gotoAndStop(6);
score -= -2;
isStart = false;
}
} 
```

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T17:59:21.317

在我看来，在创建 Flash 游戏时，最好使用外部类。

一种解决方法是在主代码之前添加一个帧，并将该帧中的分数变量设置为零。这种方式分数只设置为零一次，当回到你的主框架时，它会保持相同的分数。（你可能想在减去分数时添加一个 if 语句，更少你想允许一个负分）

更好的方法是使用外部类并将主代码保存在 Main 类中。此类将有一个构造函数，并且只将分数初始化为零一次。

-特拉维斯

# objective-c - 如何使用objective-chipmunk物理引擎制作自定义空间边框？

> ID：15141480
> 
> 赞同：0
> 
> 时间：2013-02-28T17:07:24.567
> 
> 标签：objective-c

我在使用 Objective-chipmunk 自定义 2D 物理引擎的边界时遇到问题：

```
[space addBounds:self.view.bounds thickness:10.0f elasticity:0.5f friction:0.5f layers:CP_ALL_LAYERS group:CP_NO_GROUP collisionType:borderType]; 
```

如何自定义边界？（我想要的是在整个屏幕的一部分模拟物理对象）

我试过使用：

```
[space addBounds:CGRECMake(50.0f,50.0f,100.0f,100.0f) thickness:10.0f elasticity:0.5f friction:0.5f layers:CP_ALL_LAYERS group:CP_NO_GROUP collisionType:borderType]; 
```

但它根本不起作用......

任何答案将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T03:02:03.660

这是一种比较简单的方法。我真的只是为你添加了 4 个段形状并设置了它们的碰撞属性和位置。它被添加为 Objective-Chipmunk 中的库例程，因为它是所有游戏的一半最终都会做的事情之一。

这是一种比较简单的方法。我真的只是为你添加了 4 个段形状并设置了它们的碰撞属性和位置。它被添加为 Objective-Chipmunk 中的库例程，因为它是所有游戏的一半最终都会做的事情之一。

原文来源如下。它只是在盒子的所有角落之间添加段。

```
static ChipmunkStaticSegmentShape *
boundSeg(ChipmunkBody *body, cpVect a, cpVect b, cpFloat radius, cpFloat elasticity,cpFloat friction, cpLayers layers, cpGroup group, cpCollisionType collisionType)
{
    ChipmunkStaticSegmentShape *seg = [ChipmunkStaticSegmentShape segmentWithBody:body from:a to:b radius:radius];
    seg.elasticity = elasticity;
    seg.friction = friction;
    seg.layers = layers;
    seg.group = group;
    seg.collisionType = collisionType;

    return seg;
}

- (void)addBounds:(CGRect)bounds thickness:(cpFloat)radius
    elasticity:(cpFloat)elasticity friction:(cpFloat)friction
    layers:(cpLayers)layers group:(cpGroup)group
    collisionType:(cpCollisionType)collisionType;
{
    cpFloat l = bounds.origin.x - radius;
    cpFloat r = bounds.origin.x + bounds.size.width + radius;
    cpFloat b = bounds.origin.y - radius;
    cpFloat t = bounds.origin.y + bounds.size.height + radius;

    [self add:boundSeg(_staticBody, cpv(l,b), cpv(l,t), radius, elasticity, friction, layers, group, collisionType)];
    [self add:boundSeg(_staticBody, cpv(l,t), cpv(r,t), radius, elasticity, friction, layers, group, collisionType)];
    [self add:boundSeg(_staticBody, cpv(r,t), cpv(r,b), radius, elasticity, friction, layers, group, collisionType)];
    [self add:boundSeg(_staticBody, cpv(r,b), cpv(l,b), radius, elasticity, friction, layers, group, collisionType)];
} 
```

另外，当你说它根本不起作用时，你是什么意思？好像在任何地方似乎都没有任何界限，或者它们没有出现在您期望的地方？你确定你的渲染坐标是你期望的吗？- (void)addBounds:(CGRect)bounds thickness:(cpFloat)radius

另外，当你说它根本不起作用时，你是什么意思？好像在任何地方似乎都没有任何界限，或者它们没有出现在您期望的地方？你确定你的渲染坐标是你期望的吗？- (void)addBounds:(CGRect)bounds thickness:(cpFloat)radius

# sql - PostGIS：在多边形中选择点的功能

> ID：15141481
> 
> 赞同：1
> 
> 时间：2013-02-28T17:07:29.560
> 
> 标签：sql, postgresql, geospatial, postgis, postgresql-8.4

我已经为此努力了几个小时，但由于我对 PostgreSQL 和 PostGIS 比较陌生，所以我找不到解决方案。我正在尝试创建一个存储过程（函数），它将返回其指定点几何在指定多边形内的所有位置。

这是我的 PostgreSQL 函数：

```
CREATE OR REPLACE FUNCTION public.spGeoPoly(polystring text) RETURNS setof locations
AS $$
BEGIN
RETURN QUERY
SELECT * FROM locations
WHERE ST_Contains(ST_GeomFromText('POLYGON((polystring))', 4326), point_geom);
END;
$$ LANGUAGE plpgsql; 
```

我已经使用硬编码的多字符串对此进行了测试，它可以工作，但作为带有输入字符串的函数，例如：

```
SELECT spGeoPoly('50.4 8.2,50.3 9.3,49.9 9.5,49.7 8.8,49.9 7.8,50.4 8.2'); 
```

我收到一个错误：

```
ERROR:  parse error - invalid geometry
HINT:  "polygon((" <-- parse error at position 9 within geometry 
```

我假设我的输入文本没有正确转换为创建多边形所需的格式，因为位置 9 是多边形参数字符串的开始。如何修复文本参数？

我正在使用 PostgreSQL 8.4.13 和 PostGIS 1.5.8。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-01T15:17:33.483

如您所知，这是一个简单的解决方法。我写信是为了解释修复。

你的功能是：

```
CREATE OR REPLACE FUNCTION public.spGeoPoly(polystring text) RETURNS setof locations
AS $$
BEGIN
RETURN QUERY
SELECT * FROM locations
WHERE ST_Contains(ST_GeomFromText('POLYGON((polystring))', 4326), point_geom);
END;
$$ LANGUAGE plpgsql; 
```

麻烦的部分是：

```
ST_GeomFromText('POLYGON((polystring))', 4326) 
```

这告诉 PostgreSQL 要做的是获取字符串`Polygon((polystring))`并将其传递给`ST_GeomFromText`函数的第一个参数。这当然不是你的意思。您想使用的值构造多边形`polystring.`

要更正此问题，只需连接字符串：

```
ST_GeomFromText('POLYGON((' || polystring || '))', 4326) 
```

然后 PostgreSQL 会很高兴。

# c++ - QScrollArea 在我的自定义小部件中不起作用

> ID：15141484
> 
> 赞同：0
> 
> 时间：2013-02-28T17:07:38.983
> 
> 标签：c++, qt

我是使用 qt 的新手，我的第一个应用程序是设计简单的 UI，UI 必须有一个自定义小部件（一个标签和一个 qsliser 和一个旋转）来控制我的视频应用程序，所以我写了这样的东西

```
class Controls : public QWidget
{

private:

    QHBoxLayout *Layout ;
    string Controlname;
    QLabel *Label ;

    QSpinBox *Spin ;

public:

    QSlider *Slider ;
    Controls(QLayout &Parent , string name , const int &Default_value);
    Controls(const Controls &copy);
    explicit Controls();
    ~Controls(){}

    QLabel * Get_Label() const { return Label ; }
    QSlider *Get_Slider() const { return Slider ; }
    QSpinBox *  Get_Spin()const  { return Spin ; }
    QHBoxLayout *  Get_Layout() {return Layout;}

    void SetValue(const int &newvalue);

    Controls &operator= (const Controls &copy);

}; 
```

并从这个小部件创建一个对象，我这样做：

```
QVBoxLayout layout ;
 Controls *gg   =new Controls (layout ,  "test", 1);
 Controls *gg2   =new Controls (layout ,  "test2", 4); 
```

现在我想在 qsliderarea 中创建这个对象，所以我这样做

```
QScrollArea gt ;
 gt.setVerticalScrollBarPolicy(Qt::ScrollBarAlwaysOn);
 gt.setWidget(gg);
 gt.setWidget(gg2);
 gt.show(); 
```

但是当我运行我的应用程序时，我看到了滑块区域，但里面没有控件；我的代码有什么问题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T10:14:00.233

您需要一个父小部件，其中包含应包含控件的布局。此外，您不应该在堆栈上创建布局，因为它会在创建它的方法返回时被删除。

这些方面的东西：

```
// It is not sufficient to set the layout as a parent, you need to add the 
// widgets to the layout. Note that this won't compile unless you change your
// constructor to accept a QLayout* instead of a QLayout&.
QVBoxLayout* layout = new QVBoxLayout();
layout->addWidget( new Controls( layout, "test1", 1 );
layout->addWidget( new Controls( layout, "test2", 4 );

// A parent widget 'scrollWidget' is required which contains the layout.
QWidget* scrollWidget = new QWidget( /* maybe assign a parent here
    so you don't have to worry about deletion */ );
scrollWidget->setLayout( layout );

// Your scrollArea can now include that 'scrollWidget' which itself contains 
// everything else.
QScrollArea* scrollArea;
scrollArea->setVerticalScrollBarPolicy( Qt::ScrollBarAlwaysOn );
scrollArea->setWidget( scrollWidget );
scrollArea.show();   // Note it is more common to have the scroll area as part of
                     // another widget and show that instead 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T10:28:40.797

你的代码有很多奇怪的东西。那些`const int &`没有意义，您的构造函数不反映 Qt 编码标准。
QWidget 的赋值操作符是非常大的 WTF，所有的 QObjects 都有私有赋值操作符是有原因的。
看到这些奇怪的事情，我怀疑您的代码存在更多问题，而 QScrollArea 的错误只是这些问题的表现。

滚动区域可以通过两种方式控制子窗口小部件的大小。小部件本身具有布局集（这是您需要的），或者 sizeHint 已正确实现。

# image - 在drupal 6中，上传图片的问题

> ID：15141488
> 
> 赞同：1
> 
> 时间：2013-02-28T17:07:54.027
> 
> 标签：image, drupal

我启用了图像模块，我在站点/默认/文件中设置了文件系统路径（用于附加包括图像在内的项目）和临时目录为 /tmp，下载方法 Public

在站点配置中： image 是默认的图像路径 images/image attach 我启用了图像附加（虽然我不太明白这一点）

在内容管理配置文件中，我启用了附加图像（并启用了附件），它使用图像附加模块表单

当我尝试将图片添加到我的个人资料时，我得到：

```
The selected file /tmp/xxx.gif could not be uploaded, because the destination /picture-131.gif is not properly configured.
Failed to upload the picture image; the directory doesn't exist or is not writable. 
```

当我转到个人资料并尝试上传图片时，我得到“无法复制所选文件，因为不存在该名称的文件。请检查您提供的文件名是否正确。” （我确实提供了一个）

我在现有图像列表中看到它，如果我尝试使用它，我只会看到“没有照片”

有任何想法吗？

# c# - 正则表达式忽略模式

> ID：15141492
> 
> 赞同：2
> 
> 时间：2013-02-28T17:08:17.673
> 
> 标签：c#, .net, regex, pattern-matching

我有一个带有一些注释标记的文本。方括号“（”和“）”或“[”和“]”用于确定注释的一部分（就像在普通文本中一样，就像这句话一样）。我想对其执行正则表达式以搜索输入中的某些内容，但是...它应该忽略所有注释。

问题是：

*   它们可以出现在任何地方（我不知道在哪里以及有多少）
*   我不能轻易剥离它们（执行替换正则表达式来杀死所有出现），因为在原始文本中执行我的搜索正则表达式后我需要知道索引和长度
*   它必须在巨大的输入文本上尽可能快

注释不能嵌套，不会出现“123（Hello（World））”之类的东西。如果注释括号是字符串的一部分（在引号中），它们是文本的一部分，因此没有注释。

这是一个例子：

```
Input Text: "Hello, my (real) name is John. I worked in England (near London) on a real german restaurant.".

Search Regex: "my.*?real"

Output: "my (real) name is John. I worked in England (near London) on a real" (index=7, length=67) 
```

解决这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T17:24:41.477

您可以使用

```
my.*?real(?![^(\[]*[\)\]]) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T17:25:22.827

试试下面的代码它可能是我们

```
 public string output { get; set; }

  string input="Hello, my [FirstName] name is John. I worked in England [nearLondon] on a real german restaurant.".
  static readonly Regex re = new Regex(@"\{([^\}]+)\}", RegexOptions.Compiled);

  StringDictionary fields = new StringDictionary();
  fields.Add("FirstName", yourname);
  fields.Add("nearLondon", yournearLondon);

  output = re.Replace(input, delegate(Match match)
        {
            return fields[match.Groups[1].Value];
        }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T17:35:12.377

```
 string source =
            @"Hello, my (real) name is John. I worked in England (near London) on a real  german restaurant.";

        Regex regex=new Regex(@"\(.*?\)");

        MatchCollection matchCollection= regex.Matches(source);

        foreach (Match match in matchCollection)
        {
            source = source.Replace(match.Groups[0].Value, GetPlaceholderString(match.Groups[0].Length));
        }
        MessageBox.Show(source); 
```

在哪里`GetPlaceholderString`制作所需长度的 plactholder 字符串。

之后，您可以搜索您的单词忽略和所有注释

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-28T18:14:36.193

我想知道 RegEx 在这种情况下是否不是你的朋友。特别是因为您想要尽可能快的算法，也许您应该将其实现为状态机。

本质上，一次翻开字符串一个字符，并保留一堆匹配的注释分隔符。只要您不在注释中，也要注意您尝试匹配的字符串。

澄清问题：您是否能够假设您正在搜索的文本是固定文字？你关心空格的数量吗？我问是因为，一旦您消除了“注释”问题，您可能不需要 RegExes 的所有功能来完成其余的搜索。

# javascript - 用于 highcharts 的 YQL 财务数据 JSON 格式

> ID：15141495
> 
> 赞同：0
> 
> 时间：2013-02-28T17:08:29.770
> 
> 标签：javascript, ajax, json, highcharts, yql

我使用 jQuery 和 highcharts.js 在我的网页上构建了一个折线图，显示用户请求的任何公司的历史财务数据。我一直在玩 YQL 并使用此语句以 JSON 格式检索一些引号：

select * from yahoo.finance.historicaldata where symbol = "AAPL" and startDate = "2013-02-01" and endDate = "2013-02-25"

下面是带有我的查询的 YQL 控制台的链接：

[http://developer.yahoo.com/yql/console/?q=show%20tables&env=store://datatables.org/alltableswithkeys#h=select%20](http://developer.yahoo.com/yql/console/?q=show%20tables&env=store://datatables.org/alltableswithkeys#h=select%20) *%20from%20yahoo.finance.historicaldata%20where%20symbol% 20%3D%20%22AAPL%22%20and%20startDate%20%3D%20%222013-02-01%22%20and%20endDate%20%3D%20%222013-02-25%22

它返回一堆关于执行开始时间和执行结束时间的信息，然后最后它给了我下面的引号：

```
"results": {
"quote": [
{
 "date": "2013-02-25",
 "Date": "2013-02-25",
 "Open": "453.85",
 "High": "455.12",
 "Low": "442.57",
 "Close": "442.80",
 "Volume": "13306400",
 "Adj_Close": "442.80"
}, 
```

我无法从结果中提取收盘价信息，我尝试了以下代码，但遇到了问题。

```
 $.getJSON('http://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20yahoo.finance.historicaldata%20where%20symbol%20%3D%20%22AAPL%22%20and%20startDate%20%3D%20%222013-02-01%22%20and%20endDate%20%3D%20%222013-02-25%22&format=json&diagnostics=true&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys&callback=cbfunc', function(data){

    console.log(data);

    var close = data.query.results.quote.close;
    document.write(close);

}) 
```

有人可以告诉我我哪里出错了，因为我是 jquery、yql 和 json 的新手。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T09:14:57.503

在我看来，返回的报价对象是一个数组？你有没有尝试过

```
var close = data.query.results.quote[0].Close;
document.write(close); 
```

如果没有，请尝试在该行设置断点并检查数据对象（例如在 firebug 中）。

# qt - QObject 可以从 Java 脚本调用吗

> ID：15141508
> 
> 赞同：3
> 
> 时间：2013-02-28T17:09:07.063
> 
> 标签：qt, qml, qt5, qt-quick, qtquick2

是否可以从 Java 脚本中调用 QObject？我的意思是像这样注册 QObject 派生类实例：

```
QObject* obj = new MyObject();
QJSValue js_value = js_engine.newQObject(obj);

js_engine.globalObject().setProperty("myFunction", js_value); 
```

然后能够从 Java Script调用**myFunction**

```
myFunction() 
```

环境：Qt 5.0.1

编辑：此操作的主要目的是在 Java 脚本引擎中注册 C++ 函数或仿函数，并使其不是作为对象的属性而是作为独立函数可用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2016-01-29T22:04:01.803

我认为不可能直接从 C++ 向 QJSEngine globalObject 添加函数。虽然这个技巧有效：

1.  使用要公开给 QJSEngine 的 Q_INVOKABLE 函数定义基于 QObject 的类。

    ```
    class MyObject : public QObject 
    {
        Q_OBJECT
    public:
        Q_INVOKABLE int myFunction(int x) 
        {
            return x + 3;
        }
    }; 
    ```

2.  创建此对象的实例并从 C++ 定义其父对象。（为对象实例定义父对象很重要。没有父对象，QJSEngine 会认为它拥有该对象并可以删除它！）

    ```
    MyObject *obj = new MyObject();
    obj->setParent(QCoreApplication::instance()); 
    ```

3.  将您的对象公开给 QJSEngine。

    ```
    js_engine.globalObject().setProperty("myObject", js_engine.newQObject(obj)); 
    ```

4.  将对象的函数从 JavaScript 转移到全局对象。

    ```
     engine.evaluate("this.myFunction = myObject.myFunction"); 
    ```

5.  从 JavaScript 环境中删除 myObject。

    ```
     engine.evaluate("delete myObject"); 
    ```

完毕！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-01T14:24:29.303

我花了太多时间试图做同样的事情。现在我 99.9% 确信当前的 Qt 版本（5.0.1）不可能做到这一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-27T21:57:57.110

如果您使用的是 Qt5，您可以使用：

```
QObject* obj = new MyObject();
js_engine.globalObject().setProperty("myFunction", js_engine.toScriptValue(&obj::myFunction)); 
```

并且您需要您的 QObject 派生类具有必须公开的`Q_OBJECT`宏和每个方法。`Q_INVOKABLE`

如果您使用的是 QML，则最好使用`QQmlContext::setContextObject`：

```
youQmlContext.setContextObject(new MyObject()); 
```

因此，MyObject 类的所有 Q_PROPERTY、Q_INVOKABLE 和 Q_SLOT 成员都将作为上下文本身的成员提供给 QML/JS 引擎。

# php - Opencart 1.5 中的自定义运输下拉框

> ID：15141514
> 
> 赞同：2
> 
> 时间：2013-02-28T17:09:21.790
> 
> 标签：php, mysql, opencart

我一直在尝试添加我自己的运输方式的下拉框，我将在下订单后自行处理。我已经修改了统一费率 php 来创建它。我正在查询每个商店的自定义运输方式表。有人知道可以为我做这件事的扩展程序吗？我已经搜索并找不到它，或者有人知道如何做到这一点吗？我不需要为船舶方法计算任何东西。用户只需从下拉列表中选择一种发货方式并下订单。我在下订单后手动处理。

当我尝试继续下订单时，我收到一条警告：警告：需要运输方式！

我找不到我需要更改或修改的内容以允许我通过此步骤。我认为它必须这样做，所有的运输都是用单选按钮完成的，不能处理下拉菜单。任何人都可以阐明或有任何想法来解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-27T22:37:14.640

它之所以给您回复是因为，该网站是为处理运费而建立的，从客户的角度来看，您真的认为他们会在不清楚运费的情况下继续为一件商品付款吗？无论如何，有一个用于处理运输方式的插件可能会在[http://www.opencart.com/index.php?route=extension/extension&path=4](http://www.opencart.com/index.php?route=extension/extension&path=4)但是你应该认真考虑为每个国家或地区设置适当的数量.

# jquery - 如何在页面的特定高度为固定 div 设置动画

> ID：15141515
> 
> 赞同：0
> 
> 时间：2013-02-28T17:09:23.237
> 
> 标签：jquery, html, css

HTML：

```
<div id="fixed">
    fixed
</div> 
```

CSS：

```
 body{
        height: 1000px;
    }
    #fixed{
        background-color:yellow;
        width:100%;
        left:0;
        top:0;
        height:50px;
        position : fixed;
    } 
```

我想让 div 的不透明度在第一次向下滚动后等于 0.1。我在网上搜索过它，但不确定使用 css 或 jquery 来完成此操作。

这是我的小提琴：http: [//jsfiddle.net/44qEr/](http://jsfiddle.net/44qEr/)

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T17:10:51.667

如果你使用 CSS 不透明度，你仍然需要一个 javascript 后备，因为旧版本的 IE 不支持它。所以我会选择 CSS 和 javascript 后备，或者只是 javascript。

**完整编辑**

```
$(window).scroll(function() {
    var scrollYpos = $(document).scrollTop();
    if (scrollYpos > 10) {
        $('#fixed').css('opacity', .1);
        $('#fixed').addClass('scrolled');
    } else {
        $('#fixed').css('opacity', 1);
        $('#fixed').removeClass('scrolled');
    }
}); 
```

根据您的评论添加此 JS：

```
$(document).on('mouseenter','.scrolled',function(){
    $('#fixed').toggleClass('hover'); 
   $('#fixed').css('opacity',1);
});
$(document).on('mouseleave','.scrolled',function(){
   $('#fixed').toggleClass('hover'); 
   $('#fixed').css('opacity',.1);
}); 
```

还有这个 CSS；

```
#fixed.hover {
    background-image: url(http://i.imgur.com/XiawICH.png);
    background-color: transparent;
} 
```

[http://jsfiddle.net/44qEr/7/](http://jsfiddle.net/44qEr/7/)

我更新了我的 javascript，因此代码在不滚动时可以工作。您不能使用悬停元素。我确信一些 jquery 专业人士可以简化我的代码，因为我通常不会以尽可能最短的方法编写东西。

为了确定您是否没有滚动，我可以`scrollYpos`在悬停语句中添加一个检查，这也可以。也许更好实际上我不知道。但是，我认为这段代码更具可读性，但可能更长。

下面的代码可以在没有类的情况下工作，但是如果滚动时鼠标悬停在 div 上，顶部仍然会有些错误，我没有完成它，因为我认为另一种方式更好。

```
$(window).scroll(function() {
    var scrollYpos = $(document).scrollTop();
    if (scrollYpos > 10) {
        $('#fixed').css('opacity', .1);
    } else {
        $('#fixed').css('opacity', 1);
    }
});
$('#fixed').hover(function(){
   var scrollYpos = $(document).scrollTop();
   if(scrollYpos > 0){
       $('#fixed').addClass('hover'); 
       $('#fixed').css('opacity',1);
   } 
}, function(){
  var scrollYpos = $(document).scrollTop();
   if(scrollYpos > 0){
       $('#fixed').removeClass('hover'); 
       $('#fixed').css('opacity',.1);
   }
}); 
```

[http://jsfiddle.net/44qEr/8/](http://jsfiddle.net/44qEr/8/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T17:31:42.323

只是为了扩展@Leeish的答案，使用该`animate`属性会更好，如下所示：此外，添加该`.stop`属性将防止排队动画阻碍效果。

```
$(window).scroll(function() {
    var scrollYpos = $(document).scrollTop();
    if (scrollYpos > 10) {
        $('#fixed').stop(true);
        $('#fixed').animate({'opacity': .3},500);
    } else {
        $('#fixed').stop(true);
        $('#fixed').animate({'opacity': 1},500);
    }
}); 
```

演示：http: [//jsfiddle.net/44qEr/4/](http://jsfiddle.net/44qEr/4/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T17:20:01.240

您可以使用计时器来检查窗口滚动是否已更改并根据需要设置不透明度。

```
(function(){
    var $fixed = $('#fixed');
    var $window = $(window);
    var old = 0;
    setInterval(function(){
        var _new = $window.scrollTop();
        if (old == 0 && _new > 0){
            $fixed.css({opacity:0.1});
        }
        else if (old > 0 && _new == 0){
            $fixed.css({opacity:1});
        }
        old = _new;
    }, 50);                
})() 
```

[**演示**](http://jsfiddle.net/mowglisanu/44qEr/2/)

# mysql - 在 SQL 查询中显示行或 NULL

> ID：15141520
> 
> 赞同：0
> 
> 时间：2013-02-28T17:09:42.337
> 
> 标签：mysql, sql, join

我试图在一个查询中从三个表中获取信息。我不知道是否有可能做到这一点......到目前为止我尝试过的方法没有奏效，但我对 SQL 也不是很了解。

我有三个表：`registration`保存注册信息，`experience`保存客户的活动选择（如果他们选择晚餐、午餐、单日等），以及`additionalInfo`保存其他活动信息，例如他们对特定研讨会的选择活动期间。`registration`并且`experience`将始终具有值，但`additionalInfo`不能保证具有值。我想要得到的是，在一个查询中，获取注册和事件选择，如果有东西`additionalInfo`可以检索，或者返回`NULL`。

我正在尝试这个查询：

```
SELECT registration.firstName, registration.lastName, registration.phone, experience.options, additionalInfo.workshops
FROM registration, experience, additionalInfo
WHERE registration.identifier = experience.identifier
AND experience.paid = 'Yes'
AND registration.eventName = 'march2013'
AND additionalInfo.identifier = registration.identifier
ORDER BY registration.lastName ASC 
```

此查询仅返回`additionalInfo.identifier`存在的值，但正如我所说，这不能保证存在。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-28T17:11:44.240

采用`LEFT JOIN`

```
SELECT  registration.firstName, 
        registration.lastName, 
        registration.phone, 
        experience.options, 
        additionalInfo.workshops
FROM    registration
        INNER JOIN experience
            ON registration.identifier = experience.identifier
        LEFT JOIN additionalInfo
            ON additionalInfo.identifier = registration.identifier
WHERE   experience.paid = 'Yes' AND 
        registration.eventName = 'march2013'
ORDER   BY registration.lastName ASC 
```

要进一步了解有关联接的更多信息，请访问以下链接：

*   [SQL 连接的可视化表示](http://www.codeproject.com/Articles/33052/Visual-Representation-of-SQL-Joins)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T17:20:11.890

除了使用左连接

您还可以检查返回的数据库结果集是否有

结果集.eof

我总是用它来检查数据库是否返回任何东西

# javascript - JavaScript 中的 Razor 语法

> ID：15141521
> 
> 赞同：3
> 
> 时间：2013-02-28T17:09:43.387
> 
> 标签：javascript, asp.net-mvc, razor

考虑一下 JavaScript 中的 Razor 语法：

```
@{
   int badgeCount = ViewBag.badgeCount;
 }

<script type="text/javascript">
    for (var i = 0; i < @badgeCount; i++) {
        TrackWonBadge('@CurrentMember.Name');
    }
</script> 
```

我尝试在循环中使用徽章计数，但存在语法错误。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-28T17:14:30.307

你应该使用这样的东西：

```
<script type="text/javascript">
    var badgeCount = Number('@ViewBag.badgeCount');

    for (var i = 0; i < badgeCount; i++) {
        TrackWonBadge('@CurrentMember.Name');
    }
</script> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-28T17:26:07.477

我认为更好的方法是尽量避免动态 JavaScript。这样的事情会更好：

```
@{
    int badgeCount = ViewBag.badgeCount;
    string memberName = "Some Name";
}

<input type="hidden" id="BadgeCount" value="@badgeCount" />
<input type="hidden" id="MemberName" value="@memberName" />

<script type="text/javascript">
    var badgeCount = document.getElementById('BadgeCount').value;
    var memberName = document.getElementById('MemberName').value;
    for (var i = 0; i < badgeCount; i++) {
        TrackWonBadge(memberName);
    }
</script> 
```

这样做的好处是，如果脚本变得更复杂，您将能够将脚本迁移到自己的文件中。

事实上，我根本不会构建内联脚本。我会将其移动到单独的 .js 文件中，以使标记与客户端的逻辑分开。这类似于 ASP.NET MVC 强制您在服务器端执行的操作；您的视图使用与控制器不同的语言，因此位于单独的文件中。即使您现在不想进行这种文件分离，编写动态 JavaScript 也会使这种最终分离变得更加困难，因为您的代码正在生产和维护中。

# php - AJAX：单页应用程序结构/安全性

> ID：15141525
> 
> 赞同：6
> 
> 时间：2013-02-28T17:09:54.497
> 
> 标签：php, javascript, ajax, security, xmlhttprequest

我正在使用 AJAX 开发网络/移动应用程序。该应用程序有 4 个页面：登录 1 和 3 个受保护页面仅显示给登录用户。

我计划使用单页应用程序模式，因此所有 4 个页面都将立即加载，每个页面都在其自己的 DIV id 中，并且最初只有登录页面可见。

一旦用户输入他的用户/密码，我创建一个 XMLHttpRequest 并与一个内部 PHP 脚本通信，该脚本反过来使用准备好的语句来检查用户/密码是否存在于数据库中，并向 XMLHttpRequest 返回一个真或假。

如果结果为真，我将使受保护的 DIV 可见并从服务器加载必要的数据，创建另一个 XMLHttpRequest 并通过另一个 PHP 脚本与数据库交互。当用户在其他受保护的页面之间导航时，将重复此步骤。我还计划使用 XMLHttpRequest/内部 PHP 脚本实现 cookie 以保持用户登录。

下面是描述该过程的图像。

**问题**：

*   这个结构看起来好吗？我没有预见到可能出现的任何问题？
*   结构安全吗？有什么方法可以进一步强化它吗？

![在此处输入图像描述](../Images/b1236bf9626889373414b3f48cedfbc9.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-28T17:18:22.223

只要您确保每个数据请求都受到登录系统的保护，这种结构就可以了，以防止将数据提供给未经身份验证的用户。

此外，您需要确保当用户注销时，将所有数据从 DOM 中清除。这可以通过强制刷新页面`window.location.reload()`或手动删除所有包含数据的 DOM 节点并覆盖任何变量来轻松完成。考虑使用您的应用程序的用户，然后注销，然后另一个用户开始使用同一设备。如果您在注销时不刷新数据，则未经身份验证的第二个用户可以打开任何 DOM 工具（例如 Firebug/Chrome 开发工具）并查看最后一个用户的敏感数据。

不要忘记关注 SQLi、XSS（包括基于 DOM 的 XSS——不仅仅是反射/存储的 XSS）和会话安全（会话劫持等）方面的一般 Web 应用程序安全性。

# c# - 选择具有别名的列时出现 SQL 异常

> ID：15141527
> 
> 赞同：2
> 
> 时间：2013-02-28T17:10:05.130
> 
> 标签：c#, alias, sqlexception

我的 SQL 查询是

```
cmd = new OleDbCommand("select vchr_No as voucher No, vchr_Date as Date, 
                        vchr_Acnthd as Debit, vchr_Prtynm as Paid to 
                        from cshvchrs  
                        where vchr_No like '%" + vchno + "%' ", con); 
```

当我尝试检索数据时出现异常：

> *SELECT 语句包含拼写错误或丢失的保留字或参数名称，或者标点符号不正确。*

请任何人帮助我

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-28T17:12:16.983

您的 SQL 无效 - 包含空格的别名需要转义，作为关键字的别名也是如此。

```
cmd = new OleDbCommand("select vchr_No as [voucher No] ,vchr_Date as [Date] ,vchr_Acnthd as Debit ,vchr_Prtynm as Paid to from cshvchrs  where vchr_No like '%" + vchno + "%' ", con); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-28T17:11:18.230

您正在使用`Date`别名 ( `vchr_Date as Date`)。`Date`是保留关键字，请尝试：

```
vchr_Date as [Date] 
```

或更改`Date`为其他别名。

您还需要使用`[]`带空格的别名。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-28T17:12:15.177

一方面`vchr_Date as Date`，

`Date`是[`reserved keyword`](http://msdn.microsoft.com/en-us/library/ms189822.aspx)关于 Transact-SQL 的。

> 保留关键字是 SQL Server 用来解析和理解 Transact-SQL 语句和批处理的 Transact-SQL 语言语法的一部分。

您可以将它与方括号一起使用，`[]`例如；

```
vchr_Date as [Date] 
```

将您的完整查询用作；

```
cmd = new OleDbCommand("select vchr_No as [voucher No] ,vchr_Date as [Date] ,vchr_Acnthd as Debit ,vchr_Prtynm as Paid to from cshvchrs  where vchr_No like '%" + vchno + "%' ", con); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-28T17:13:27.827

您错误地指定了列名。例如，片段：

```
vchr_No as voucher No 
```

应表示为

```
vchr_No as [voucher No] 
```

否则您将没有有效的 SQL。

通常，您需要将 [ 和 ] 放在包含空格、标点、关键字或 SQL 列标识符中不允许的任何其他字符的列名周围。

# winapi - 在服务中接收 Windows 消息

> ID：15141529
> 
> 赞同：4
> 
> 时间：2013-02-28T17:10:07.703
> 
> 标签：winapi, visual-c++, service, windows-messages

我用 VC++ 编写了一个服务。我按照[教程here](http://www.codeproject.com/Articles/499465/Simple-Windows-Service-in-Cplusplus)。现在，我正在尝试了解如何接收 DBT_DEVICEARRIVAL、DBT_DEVICEREMOVECOMPLETE、WM_COPYDATA 等消息，就像具有顶级窗口的常规应用程序一样。在搜索它时，我遇到了[这篇 MSDN 文章](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644927%28v=vs.85%29.aspx)

在“广播消息”部分的最后几段中：

> 应用程序通过其顶层窗口的窗口过程接收消息。消息不会发送到子窗口。**服务可以通过窗口过程或其服务控制处理程序接收消息。**

但是几乎不可能找到任何如何做到这一点的例子。

1.  如何将 WndProc 与我的服务相关联，以便它接收消息？

2.  或者，我怎样才能让我的服务控制处理函数接收 Windows 消息？我的服务控制处理程序只有一个 DWORD 参数，而不是 WndProc 的 UINT、WPARAM、LPARAM 等。

我已经阅读了 1) 使用隐藏窗口和 2) 仅消息窗口等，但我认为我不能在服务中使用它们；不想。如果我能以 MSDN 提到的这两种方式中的任何一种方式完成它，我会很高兴。

**服务说明：**

该服务将检测 USB 设备插入并将一些文件复制到它。它还必须跟踪对某些目录和文件的更改，以便知道要复制哪些。

将来，此基本功能可能会扩展到包括其他内容。因此，我可能必须能够接收许多我现在不知道的其他 Windows 消息。

上面提到的示例消息只是取自我在开发常规 Windows 应用程序时所习惯的。在编写服务时，我了解它们是否不合适或不安全。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T18:12:08.540

嗯，您只需创建一个普通的消息循环，就像您编写 Win32 窗口应用程序的纯 C 实现一样 - 不涉及任何框架。

例子：

```
while(GetMessage(...)) ... 
```

您可以使用`PeekMessage`或[`GetMessage`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644936.aspx)（请参阅链接的文档）。但后者更传统，并将其从消息队列中删除。

即你甚至不需要窗户。每个线程都可以有一个消息循环。所以它会阻塞，但只有当前线程。您必须自己弄清楚如何将信息传递给需要它的其他线程。

## *不过*大

 *但是，与其努力妥协 MS 为你设置的东西，以免你的下半身被炸掉，你应该[在 Wikipedia 上阅读有关 Shatter Attacks 的信息，](http://en.wikipedia.org/wiki/Shatter_attack)并为服务使用适当的[IPC](http://en.wikipedia.org/wiki/Inter-process_communication)技术（从 MMF 到管道，有很多可用的技术）与信号量、互斥体和事件的组合）。

如果您打算在用户桌面上接收窗口消息但使用您的特权上下文（无论如何都应该阻止会话分离），这部分是相关的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T18:14:00.320

使用带有[HandlerEx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms683241%28v=vs.85%29.aspx)回调函数的[RegisterServiceCtrlHandlerEx函数。](http://msdn.microsoft.com/en-us/library/windows/desktop/ms685058%28v=vs.85%29.aspx)

是的，正如**0xC0000022L**所指出的，最好使用 IPC 技术，例如命名管道——我最喜欢的。:)*

# jquery - 获取属于选中单选按钮的标签文本

> ID：15141530
> 
> 赞同：13
> 
> 时间：2013-02-28T17:10:09.463
> 
> 标签：jquery

我正在尝试获取`text`属于`checked`单选按钮的标签，但似乎不太可能。

```
$(document).ready(function(){
  $("body").on("click", "#btn", function(){

    var radios = $("input[type='radio']");

    $.each(radios, function(index, element){
      if ($(this).prop("checked") === true){

        var radioID = element.id;
        $("label").each(function(ind, elm){

          if ($(elm).prop("for") == radioID){
            console.log($(elm)); 
          }

        });
      }
    });
  });
}); 
```

[jsbin](http://jsbin.com/uniwum/2/edit)

无论出于何种原因打印出来

> > > -- [11:07:13.834] ({0:({}), context:({}), length:1}) @ [http://jsbin.com/uniwum/2/edit:71](http://jsbin.com/uniwum/2/edit:71)

在控制台中。我做错了什么？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-02-28T17:29:53.827

这样做： -

```
$('#btn').click(function() {
    $("input[type='radio']:checked").each(function() {
        var idVal = $(this).attr("id");
        alert($("label[for='"+idVal+"']").text());
    });
}); 
```

参考**[现场演示](http://jsfiddle.net/SivaCharan/EmpWV/)**

## 更新：

以下是文档参考：-

*   **[类别：选择器](http://api.jquery.com/category/selectors/)**
*   **[属性等于选择器 [name="value"]](http://api.jquery.com/attribute-equals-selector/)**

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-28T17:14:54.580

试试这个：

```
$('#btn').click(function(){
    $('table input[type="radio"]').each(function(){
        if($(this).is(':checked')){
        console.log($(this).parent().next().find('label').text());
        }
    });
}); 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/rQX7H/)**

更新：由于它们是单选按钮，因此更快的方法是：

```
$('#btn').click(function(){
    console.log( $('table input[type="radio"]:checked').parent().next().find('label').text() );
}); 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/rQX7H/1/)**

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-02-09T18:01:07.337

```
$("input[type='radio']:checked").parent().text() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-28T17:13:53.703

选择元素后，您需要调用该`.text()`函数来获取元素的文本，如下所示`$(elm).text()`：

在这种情况下，由于`elm`已经是一个 DOM 节点，因此您可以调用 plain`elm.innerHTML`以获得相同的结果。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-28T17:14:06.603

试试这个代码：

```
$("td",$(":checked").parent().parent()).text() 
```

jsFiddle 的链接[http://jsfiddle.net/rQX7H/2/](http://jsfiddle.net/rQX7H/2/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-08-21T11:13:05.080

您可以通过多种方式做到这一点，具体取决于为单选按钮编写的 HTML 和单选按钮的文本，我看到了两种可以用很少的努力完成的方法。

***方法 1***：将自定义数据属性分配给具有要显示的相同文本的单选按钮。

```
 <input id="radio4" name="radios1" type="radio" value="4" data-value="radio 4" /> radio 4
    <input id="radio5" name="radios1" type="radio" value="4" data-value="radio 5"/> radio 5
    <input id="radio6" name="radios1" type="radio" value="4" data-value="radio 6"/> radio 6
    <input type="button" id="btn" value="Get from data-value" /> 
```

有关自定义数据属性的详细信息，请访问：[自定义数据-* 属性](http://www.w3schools.com/tags/att_global_data.asp)

获取文本的脚本：

```
$(document).on("click", "#btn", function () {
            var value = $("input[name=radios1]:checked").attr("data-value");
            alert(value);
        }); 
```

***方法 2***：转换单选按钮的 html 以便为所有单选按钮分配相同的 [name] 属性，然后为单选按钮放置“标签”字段，如下所示

```
<input id="radio1" name="radios" type="radio"/>
        <label for="radio1"> radio 1</label>
    <input id="radio2" name="radios" type="radio"/>
        <label for="radio2"> radio 2</label>
    <input id="radio3" name="radios" type="radio"/>
        <label for="radio3"> radio 3</label>
    <input type="button" id="btn1" value="Get from Label" /> 
```

获取文本的脚本：

```
$(document).on("click", "#btn1", function () {
        var idVal = $('input[name=radios]:checked').attr("id");
        $("label[for='"+idVal+"']").text();
        //If you have the radio button in HTML table structure write it as below
        $('input[name=radios]:checked').parent().find('label').text();
    } 
```

希望这可以帮助 ：）

# c++ - 不间断循环请求字符串

> ID：15141532
> 
> 赞同：-3
> 
> 时间：2013-02-28T17:10:21.700
> 
> 标签：c++, string, loops

好的，所以我需要一个代码来询问日期并将它们保存在一个数组中，格式是 (DAY HH:MM:SS) 我必须使用类所以这里是代码：

主程序

```
typedef TempsSet Setmana[50];

struct Dies {
    Setmana t;
    int n;
};

int main() {
    Dies e;
    int valors;
    cout << "QUANTS VALORS TENS (>0):" << endl;
    cin >> valors;
    cout << "ENTRA ELS VALORS:" << endl;
    e.n=0;
    for(int n=0;n<valors;n++){
        e.t[n].llegir();
        e.n++;
    }
    cout << "-------------------" << endl;
    for(int n=0;n<valors;n++)
        e.t[n].mostrar();
    cout << "ELS VALORS ORDENATS:";
    e.n=0;
     /*for(int n=0;n<valors;n++)
        e.t[n].mostrar();*/
    return 0;
} 
```

TEMPSSET.CPP

```
TempsSet::TempsSet() {
    a_d = "DL"; a_h = 0; a_m = 0; a_s = 0;
}
TempsSet::TempsSet(string d, int h, int m, int s) {
    a_d = d; a_h = h; a_m = m; a_s = s;
    if (d!="DL"||d!="DILLUNS"||d!="DT"||d!="DIMATRS"||d!="DC"||d!="DIMECRES"||d!= "DJ"||d!="DIJOUS"||d!="DV"||d!="DIVENDRES"||d!="DS"||d!="DISSABTE"||d!="DG"||d!="DIUMENGE"||h<0||m<0||m>=60||s<0||s>=60)
        a_d = "DL"; a_h = 0; a_m = 0; a_s = 0;
}
void TempsSet::llegir() {
    char c;
    do {
        cin >> a_d;
        cin.ignore(1); // o cin >> c;
        cin >> a_h;
        cin.ignore(1); // o cin >> c;
        cin >> a_m;
        cin.ignore(1); // o cin >> c;
        cin >> a_s;
    } while(a_d!="DL"||a_d!="DILLUNS"||a_d!="DT"||a_d!="DIMATRS"||a_d!="DC"||a_d!="DIMECRES"||
            a_d!="DJ"||a_d!="DIJOUS"||a_d!= "DV"||a_d!="DIVENDRES"||a_d!="DS"||a_d!="DISSABTE"||
            a_d!="DG"||a_d!="DIUMENGE"||a_h<0||a_m<0||a_m>59||a_s<0||a_s>59);
} 
```

该程序询问我要输入多少个日期并将数字保存在“valors”，但它并没有停止要求我介绍日期。如果我说我只介绍 1 也没关系。这可能是 TempsSet.cpp 中的一段时间，我猜有些东西编码错误

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T18:03:06.587

尝试对有效字符串使用数组。
我改变了你的循环检查：

```
void TempSet::llegir()
{
    static const char * a_d_strings[] =
        {
            {"DILLUNS"},
            {"DT"},
            {"DIMATRS"},
            {"DC"},
            {"DIMECRES"},
            {"DJ"},
            {"DIJOUS"},
            {"DV"},
            {"DIVENDRES"},
            {"DS"},
            {"DISSABTE"},
            {"DG"},
            {"DIUMENGE"},
        };
    static const unsigned int STRING_QUANTITY =
        sizeof(a_d_strings) / sizeof(a_d_strings[0]);

    bool    invalid_input = true;
    while (invalid_input)
    {
        cin >> a_d;
        cin.ignore(1); // o cin >> c;
        cin >> a_h;
        cin.ignore(1); // o cin >> c;
        cin >> a_m;
        cin.ignore(1); // o cin >> c;
        cin >> a_s;
// Here you should convert a_d to all uppercase.
// Search SO for "transform toupper" to find out how.

       unsigned int i = 0;
        for (i = 0; i < STRING_QUANTITY; ++i)
        {
            if (a_d == a_d_strings[i])
            {
                break;
            }
        }
        if (i >= STRING_QUANTITY)
        {
            cout << "Invalid text. Enter data again.\n";
            continue;
        }
        if (a_h < 0)
        {
            cout << "Invalid hours. Enter data again.\n";
            continue;
        }
        if ((a_m < 0) || (a_m > 59))
        {
            cout << "Invalid minutes.  Enter data again.\n";
            continue;
        }
        if ((a_s < 0) || (a_s > 59))
        {
            cout << "Invalid seconds.  Enter data again.\n";
            continue;
        }
        invalid_data = false;
    }
} 
```

# c++ - 双三次图像大小调整算法

> ID：15141534
> 
> 赞同：0
> 
> 时间：2013-02-28T17:10:23.567
> 
> 标签：c++, algorithm, bicubic

我一直在尝试学习图像大小调整算法，例如最近邻、双三次和双线性插值算法。我对数学进行了一些研究，现在我正在研究现有的实现以了解和欣赏它们的工作原理。

我从使用 OpenCV 并提供测试和示例代码的 Google 代码中找到的 Bi-Cubic Resize 的**[实现开始。](http://code.google.com/a/eclipselabs.org/p/bicubic-interpolation-image-processing/source/browse/trunk/libimage.c)**我用它作为我自己的实现的起点，它不使用 OpenCV，而只是对包含在一个原始位图上进行操作`std::vector<unsigned char>`：

```
std::vector<unsigned char> bicubicresize(const std::vector<unsigned char>& in, std::size_t src_width,
    std::size_t src_height, std::size_t dest_width, std::size_t dest_height)
{
    std::vector<unsigned char> out(dest_width * dest_height * 3);

    const float tx = float(src_width) / dest_width;
    const float ty = float(src_height) / dest_height;
    const int components = 3;
    const int bytes_per_row = src_width * components;

    const int components2 = components;
    const int bytes_per_row2 = dest_width * components;

    int a, b, c, d, index;
    unsigned char Ca, Cb, Cc;
    unsigned char C[5];
    unsigned char d0, d2, d3, a0, a1, a2, a3;

    for (int i = 0; i < dest_height; ++i)
    {
        for (int j = 0; j < dest_width; ++j)
        {
            const int x = int(tx * j);
            const int y = int(ty * i);
            const float dx = tx * j - x;
            const float dy = ty * i - y;

            index = y * bytes_per_row + x * components;
            a = y * bytes_per_row + (x + 1) * components;
            b = (y + 1) * bytes_per_row + x * components;
            c = (y + 1) * bytes_per_row + (x + 1) * components;

            for (int k = 0; k < 3; ++k)
            {
                for (int jj = 0; jj <= 3; ++jj)
                {
                    d0 = in[(y - 1 + jj) * bytes_per_row + (x - 1) * components + k] - in[(y - 1 + jj) * bytes_per_row + (x) * components + k];
                    d2 = in[(y - 1 + jj) * bytes_per_row + (x + 1) * components + k] - in[(y - 1 + jj) * bytes_per_row + (x) * components + k];
                    d3 = in[(y - 1 + jj) * bytes_per_row + (x + 2) * components + k] - in[(y - 1 + jj) * bytes_per_row + (x) * components + k];
                    a0 = in[(y - 1 + jj) * bytes_per_row + (x) * components + k];
                    a1 = -1.0 / 3 * d0 + d2 - 1.0 / 6 * d3;
                    a2 = 1.0 / 2 * d0 + 1.0 / 2 * d2;
                    a3 = -1.0 / 6 * d0 - 1.0 / 2 * d2 + 1.0 / 6 * d3;
                    C[jj] = a0 + a1 * dx + a2 * dx * dx + a3 * dx * dx * dx;

                    d0 = C[0] - C[1];
                    d2 = C[2] - C[1];
                    d3 = C[3] - C[1];
                    a0 = C[1];
                    a1 = -1.0 / 3 * d0 + d2 -1.0 / 6 * d3;
                    a2 = 1.0 / 2 * d0 + 1.0 / 2 * d2;
                    a3 = -1.0 / 6 * d0 - 1.0 / 2 * d2 + 1.0 / 6 * d3;
                    Cc = a0 + a1 * dy + a2 * dy * dy + a3* dy * dy * dy;
                    out[i * bytes_per_row2 + j * components2 + k] = Cc;
                }
            }
        }
    }

    return out;   
} 
```

现在，据我所见，这个实现存在***致命缺陷***，因为这行：

```
d0 = in[(y - 1 + jj) * bytes_per_row + (x - 1) * components + k] - in[(y - 1 + jj) * bytes_per_row + (x) * components + k]; 
```

在我看来，当is时，这条线*总是*会访问越界的数组索引。并且将始终是初始值，因为 y 是用 初始化的，并且是一个从 开始的迭代器变量。因此，由于将始终从 开始，因此表达式（用于计算 ARRAY INDEX）将始终为负数。而且......显然，负数组索引是无效的。`y``0``y``0``y = ty * i``i``0``y``0``(y - 1 + jj) * bytes_per_row + (x - 1) * components + k`

**问题：**在我看来，这段代码不可能工作。我错了吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T18:13:52.363

一种方法是定义一个 GetPixel() 函数：

```
GetPixel(int x, int y, int channel)
{
   if (x >= 0 && x <= width-1)
      if (y >=0 && y <= height-1)
         return QueriedPixelFromImage(x,y,channel);
   return 0; // out of bounds
} 
```

你将更换

```
d0 = in[(y - 1 + jj) * bytes_per_row + (x - 1) * components + k] 
```

经过

```
d0 = GetPixel(x-1,y-1+jj,k) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T17:53:38.367

我运行了一些测试代码以确保我没有遗漏任何内容，但据我所知，您确实是正确的：

```
#include <iostream>

int main()
{

  int components = 3;

  const float tx = 200/50;
  const float ty = 200/50 ;
  int bytes_per_row = 1000 ;

  for (int i = 0; i < 5; ++i)
  {
    for (int j = 0; j < 5; ++j)
    {
         const int x = int(tx * j);
         const int y = int(ty * i);

        for (int k = 0; k < 3; ++k)
        {
            for (int jj = 0; jj <= 3; ++jj)
            {
               std::cout << "calc: " << (y - 1 + jj) * bytes_per_row + (x - 1) * components + k << std::endl ;
            }
        }
     }
   }
} 
```

我查看了您提供的网站上的代码，它看起来不是一个很大的项目。因此，也许您应该联系项目维护人员，看看他们是否可以提供一些帮助。首页上有一个联系电子邮件[http://code.google.com/a/eclipselabs.org/p/bicubic-interpolation-image-processing/](http://code.google.com/a/eclipselabs.org/p/bicubic-interpolation-image-processing/)

# c++ - 为什么要调用构造函数和析构函数？他们实际上在做什么？C++

> ID：15141535
> 
> 赞同：2
> 
> 时间：2013-02-28T17:10:42.323
> 
> 标签：c++, memory-management, reference, constructor, destructor

我对构造函数和析构函数的技术原因有点陌生。我编写了一个程序，其中包含显示对象开始状态、结束状态、内存位置、值以及何时调用构造函数和析构函数的函数。

我无法理解为什么在他们被调用时调用它们以及它们实际上在做什么。我将发布测试运行的结果和我正在使用的代码 - 以及我所知道的哈哈。

* * *

**结果：**

```
Constructor called on 0x7fffc053f070

Initial state: 
Location: 0x7fffc053f070
  Value: 0

--- FOO ----
Location: 0x7fffc053f070
  Value: 1

--- BAR ----
Location: 0x7fffc053f080
  Value: 2

Destructor called on 0x7fffc053f080

--- BAZ ----
Location: 0x7fffc053f070
  Value: 2

Final state: 
Location: 0x7fffc053f070
  Value: 2

Destructor called on 0x7fffc053f070 
```

* * *

* * *

**代码：**

```
#include <iostream>
#include <vector>

using namespace std;

//Short memory addresses are on the heap
//Long memory addresses are on the stack

class A {

public:

A(){
    m_iValue = 0;
    cout << "Constructor called on " << this << endl;
}

/*      A(const A & a){
            m_iValue = a.m_iValue;
            cout << "Copy constructor called on " << this << endl;
    }
*/
void increment(){
    m_iValue++;
}

void display(){
    cout << "Location: " << this << endl;
    cout << "  Value: " <<m_iValue << endl;
    cout << endl;
}

virtual ~A(){
    cout << "Destructor called on " << this << endl;
}

private:
    int m_iValue;
};

void foo(A & a){
    a.increment();
    a.display();
}

void bar(A a){
    a.increment();
    a.display();
}

void baz(A * a){
    a->increment();
    a->display();
}

void blah(vector<A*> vA){
    vA.back()->display();
    delete vA.back();
    vA.pop_back();
}

int main(int argc, char * argv[]){

    A a;

    cout << "Initial state: " << endl;
    a.display();

    cout << endl;

    foo(a);
    bar(a);
    baz(&a);
    cout << endl;
    cout << "Final state: " << endl;
    a.display();

    return 0;
} 
```

* * *

**我相信正在发生的事情：**

因此，构造函数被调用一次，而析构函数被调用两次。在 main 中创建对象时调用构造函数。在 foo() 中，m_iVariable 通过引用传递，并且函数在内存中的该位置为对象增加 m_iValue。因此程序将值显示为 1（从 0 递增。）

这就是我感到困惑的地方。第三个位置与前两个位置不同。该对象被直接传递给 bar()。我不明白如果不调用构造函数，位置会如何不同，或者为什么在它递增后调用析构函数，使值 2。

但是 baz 也会增加值。所以这意味着 bar 实际上没有做任何事情？我仍然不明白 bar 如何显示新的内存位置并破坏，但从不构造。

* * *

对不起所有的文字，但任何事情都会有所帮助。谢谢！

哦，注释掉的代码，函数 blah 用于其他事情，与这个问题无关。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T17:19:34.673

当您将值传递给 时`bar()`，您正在创建一个新对象，该对象是该函数的本地对象。该对象在`bar()`返回时被销毁。它由复制构造函数初始化，`A(A const &)`因为您自己没有声明它，所以它是隐式生成的。如果您取消注释复制构造函数，那么您将看到它正在发生。

通常，在允许复制具有非平凡析构函数的对象时必须小心。此类类通常管理在析构函数中释放的资源，并且您必须注意副本不要尝试管理相同的资源。做这样的课程时，永远记住[三法则。](https://stackoverflow.com/questions/4172722)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-28T17:16:01.353

一般而言，当您像在`main`例程中那样通过在堆栈上创建对象来隐式初始化对象时，或者当您使用`new`. 需要注意的是，*按值*向方法传递参数具有使用*复制构造函数*创建对象副本的效果，这是一种初始化类型。

当分配在堆栈上的对象超出范围时，或者当动态分配的对象被释放时，将调用析构函数`delete`。

您在这里看到两个析构函数调用，因为您的方法之一是按值传递，并创建了它的副本，然后在方法完成后销毁。这两个对象的内存地址是不同的。

如果您按值传递，对副本所做的任何修改都不会反映在原始文件中。这就是为什么在许多 C++ 应用程序中，方法通过*引用*传递事物，比如`foo(A& a)`允许修改，或者通过*const*引用来明确不允许更改，比如`foo(const A& a)`. 指针有时用于相同的目的。

您在这里遇到问题的原因是您不了解关于析构函数、复制构造函数和复制赋值运算符[的三法则。](http://en.wikipedia.org/wiki/Rule_of_three_(C%2B%2B_programming))

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T17:15:49.173

首先，您的输出显示不同数量的构造函数和析构函数调用的原因是它没有显示所有此类调用。在您的情况下，这是您尝试检测代码的失败，而不是考虑所有构造函数。一般来说，它也可能是由构造函数抛出异常引起的，因为只有*成功*的构造函数 cakks 的数量与析构函数调用的数量相匹配，并且它可能是由于对象没有被销毁（例如动态分配而不是删除）引起的。

* * *

忽略（ab）使用非常低级的语言特性，C++ 规则旨在确保

*   对于每个 T 类型的对象，只有一个 T 构造函数调用，它发生在任何其他调用之前。

*   对于每个*成功*的构造函数调用，都有一个相应的析构函数调用（如果对象被销毁）。

这些规则递归地保留在对象层次结构中。具有子对象（数据成员）的对象就是这种层次结构的一个示例。子对象可以是基类子对象，而不是数据成员。

从技术上讲，构造函数的职责是将一块原始内存转换为类型化且有意义的对象（将其与复制赋值运算符进行比较，它将现有值替换为新值，可能会释放早期分配的内存）。在设计级别，构造函数的主要职责是建立**类 invariant**，无论您可以假设调用公共方法之间的对象状态如何。析构函数的工作是清理，例如释放资源。

从语言的角度来看，构造失败是指构造函数抛出异常。

-`new`表达式在内存分配和构造之间提供了一种类似于事务的非常强的耦合。它允许您提供两组参数：分配函数的第一组参数和构造函数的第二组参数。除了下面提到的情况，如果构造函数失败，那么内存会自动释放并传播异常。即通常要么都成功，要么取消任何副作用，并且调用代码通知失败。

未完成清理的唯一例外是您定义了自定义分配函数，即所谓的“放置新”运算符，但未能提供相应的解除分配函数。我不知道为什么需要自定义释放函数，事实上，这是唯一隐式调用它的情况。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-28T17:56:27.960

只需将 print 语句放在构造函数和析构函数中以查看它们在运行时运行，这总是很有趣。上面有很多很好的答案，所以我不会说什么，但是这样做在我编程生涯的早期帮助了我。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-28T17:16:18.217

在您的方法中， 调用`bar(A a)`的是复制构造函数。`A(const A& a)`如果您没有声明它，它会由编译器隐式创建并为每个成员调用复制构造函数。

只需添加此方法：

```
A(const A& a){
  m_iValue = a.value;
  cout << "Copy constructor called on " << this << endl;
} 
```

# c++ - OS.walk 的 C++ 替代品

> ID：15141536
> 
> 赞同：7
> 
> 时间：2013-02-28T17:10:43.010
> 
> 标签：c++, python, file-io

我想编写一个从目录中读取多个文件的 C++ 程序，文件的数量是不确定的。我知道一个 Python 实现 - OS.walk，它完美地完成了这项工作：

[Python OS.walk](http://docs.python.org/2/library/os.html#os.walk)

有人对此 OS.walk 功能的 C++ 实现有任何想法吗？

提前致谢

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-28T17:17:26.983

```
#include <boost/filesystem.hpp>
#include <iostream>

int main()
{
 boost::filesystem::path path = boost::filesystem::current_path();
 boost::filesystem::recursive_directory_iterator itr(path);
 while (itr != boost::filesystem::recursive_directory_iterator())
 {
   std::cout << itr->path().string() << std::endl;
   ++itr;
 }
} 
```

直接取自[http://www.deanwarrenuk.com/2012/09/how-to-recursively-walk-folder-in-c.html](http://www.deanwarrenuk.com/2012/09/how-to-recursively-walk-folder-in-c.html)

这很好地解释了为什么需要 boost 库来隐藏文件系统中的差异。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-28T17:16:30.537

使用标准 C++，目前这是不可能的。

但是您可以使用[Boost.Filesystem](http://www.boost.org/libs/filesystem)（查找`recursive_directory_iterator`），它可能会包含在未来的 C++ 版本中。

# python - Python-Twitter API 获取位置

> ID：15141538
> 
> 赞同：0
> 
> 时间：2013-02-28T17:10:45.727
> 
> 标签：python, twitter

我正在尝试使用 python-twitter API ( [http://code.google.com/p/python-twitter/](http://code.google.com/p/python-twitter/) ) 从 Twitter 个人资料中获取位置信息。文档（[http://static.unto.net/python-twitter/0.5/doc/twitter.html](http://static.unto.net/python-twitter/0.5/doc/twitter.html)）指出有一个 GetLocation 调用，但我似乎无法让它工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-19T18:31:01.017

使用[Twython 库](https://github.com/ryanmcgrath/twython)，您可以获得具有特定用户名的用户的位置信息，如下所示：

```
from twython import Twython
twitter = Twython(APP_KEY, APP_SECRET,OAUTH_TOKEN, OAUTH_TOKEN_SECRET)
print twitter.show_user(screen_name=USER_NAME)["location"] 
```

其他库应该类似。

我希望这有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T17:48:38.483

python-twitter 最高版本为 1.9，您使用的是古老的文档！由于 python-twitter 是对 Twitter API 的精确映射，如果您想获取位置信息，请参阅[Twitter 文档。](https://dev.twitter.com/docs/api/1.1#103)

# java - 如何通过 BufferedImage 将巨大的图像加载到 Java？

> ID：15141539
> 
> 赞同：7
> 
> 时间：2013-02-28T17:10:46.100
> 
> 标签：java, image, image-processing, java-2d

我想将大图像 (18000 x 18000) 加载到我的应用程序中。如果我使用`BufferedImage`type `int_rgb`，我需要大约 1235mb 的堆内存来加载。这是一个非常大的内存量，最终用户的内存可能会更少（1GB 或更少）。

在我的开发 PC 上，当我从 MyEclipse IDE 加载图像时，它会抛出内存不足`Exception`。当我将代码打包到可执行 jar 并在 Eclipse 外部的 PC 上运行时，它仍然会引发异常。

如何在不使用 1235mb 内存的情况下使用缓冲图像将如此大的图像加载到我的应用程序中？有没有技巧，比如将图像分割成更小的部分，比如图像分割？

我[在 SO 上找到了这个帖子](https://stackoverflow.com/questions/6691915/out-of-memory-problem-saving-large-bufferedimage)，但它对我没有用；我想将图像加载到`BufferedImage`其中，然后`Panel`使用`Graphics`该类将其绘制在 a 上。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-01T02:20:34.433

[您可以使用包中的ImageReadParam](http://docs.oracle.com/javase/6/docs/api/javax/imageio/ImageReadParam.html)读取和显示图像的片段`ImageIO`。`ImageReadParam`这是一个基本示例，说明了如何在不读取整个图像的情况下读取单个片段：

```
import java.awt.Image;
import java.awt.Rectangle;
import java.awt.image.BufferedImage;
import java.io.IOException;
import java.io.InputStream;
import java.net.URL;

import javax.imageio.ImageIO;
import javax.imageio.ImageReadParam;
import javax.imageio.ImageReader;
import javax.imageio.stream.ImageInputStream;
import javax.swing.*;

public class TestImageChunks {
    private static void createAndShowUI() {
        try {
            URL url = new URL(
                    "http://duke.kenai.com/wave/.Midsize/Wave.png.png");
            Image chunk = readFragment(url.openStream(), new Rectangle(150,
                    150, 300, 250));
            JOptionPane.showMessageDialog(null, new ImageIcon(chunk), "Duke", 
                    JOptionPane.INFORMATION_MESSAGE);
        } catch (IOException e) {
            JOptionPane.showMessageDialog(null, e.getMessage(), "Failure",
                    JOptionPane.ERROR_MESSAGE);
            e.printStackTrace();
        }
    }

    public static BufferedImage readFragment(InputStream stream, Rectangle rect)
            throws IOException {
        ImageInputStream imageStream = ImageIO.createImageInputStream(stream);
        ImageReader reader = ImageIO.getImageReaders(imageStream).next();
        ImageReadParam param = reader.getDefaultReadParam();

        param.setSourceRegion(rect);
        reader.setInput(imageStream, true, true);
        BufferedImage image = reader.read(0, param);

        reader.dispose();
        imageStream.close();

        return image;
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                createAndShowUI();
            }
        });
    }
} 
```

结果如下所示：

![在此处输入图像描述](../Images/0ce4b5c84bd9e1be924676db39150a28.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-28T18:26:26.860

通常，您需要执行以下操作：

*   将图像分解为可管理大小的图像文件，并将它们与您的应用程序一起存储在磁盘上。
*   显示此图像的特定部分时，仅加载和显示与视口重叠的图像片段。
*   当您平移图像时，适当地更新加载和显示的图像片段。
*   要么让 GC 收集不必要的图像片段，要么以覆盖旧图像的方式加载新的图像片段。（这最后主张加载到池化内存缓冲区中的相同大小的图像片段。）

# java - 存储大型对象的 Java Web 应用程序可用的最佳选项

> ID：15141544
> 
> 赞同：0
> 
> 时间：2013-02-28T17:11:00.147
> 
> 标签：java, web-applications, object-persistence

Java - 春天 - 网络应用程序

我有一个 Web 应用程序，它具有基于向导的流程来创建复杂实体，并且至少有 10 个屏幕来完成一个流程，但问题是在 1 到 10 个用户之间的任何步骤都可以在不完成流程的情况下出来，我们想要存储该数据这样当用户想要恢复进程时它应该能够做到，这个过程涉及多个表。

我担心在每个向导步骤中将数据保存到数据库中，因为一段时间后数据会聚集并孤立到数据库中，并且会变成垃圾。

我想和你们讨论解决方案，请指教。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T17:14:16.437

您可以将数据序列化为 XML 或 JSON 并将其临时存储在数据库中的某个位置。这将避免处理多个表。您可以使用超时并在一段时间后删除这些条目（可能有几天）。完成后，进行真正的保存并成功删除临时数据。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-28T17:13:19.963

> 一段时间后，数据将聚集并孤立到数据库中

嗯？

当用户成功完成该过程时，删除临时/不完整的数据。

# python - 运行 matpplotlib 的 specgram 命令时，Ubuntu 上的 Python MemoryError 问题但 Windows 上没有

> ID：15141546
> 
> 赞同：0
> 
> 时间：2013-02-28T17:11:04.877
> 
> 标签：python, matplotlib, ubuntu-12.04

我真诚地感谢您在以下方面的帮助：

我正在尝试在双启动笔记本电脑（-Ubuntu 12.04 LTS，64 位和 MS Windows 7 64 位）上运行一些 python 代码（使用 Ipython，Python 版本 2.7.3）。在 Windows 中运行代码可以正常工作，但由于某种原因，我在 Ubuntu 中出现了内存错误。我不确定这是python问题还是操作系统问题。我会坚持在 MS windows 上运行代码，但这有它自己的问题，我正在努力解决，包括导入库等我在 Ubuntu 中运行代码时没有。

代码相当简单。作为参考，我有一个大型二进制文件，它代表实验室中 3 个通道的 16 位有符号数字。乐器。数据以 10 MS/s 采样。该文件约为 1.G GB，代表大约 25 秒的数据。在下面的代码中，我将数据读入“数据”，现在想使用 Matplotlib 的 specgram 函数绘制频谱图。这部分在 Windows 中运行良好，但在 Ubuntu 中运行良好。

一些代码...

```
import os
import sys
import numpy as np
import matplotlib.pyplot as plt
import matplotlib.mlab as mlab
file = "data_stream.srm"
with open(file,'rb') as fd:
fd.seek(0)
data = np.fromfile(fd,dtype=[('ch0','<i2'),('ch1','<i2'),('ch2','<i2')]) 
```

数据内容（原始信号值）如下所示：

```
array([(-1, 5, -3), (-4, 3, -4), (-6, 0, -3), ..., (-1, -2, 0),
   (-2, -1, -2), (-2, -2, -1)], 
  dtype=[('ch0', '<i2'), ('ch1', '<i2'), ('ch2', '<i2')]) 
```

可能不是最好的方法，但它可以正常工作到这里（在 Ubuntu 和 Windows 上）。数据大小（使用 data.shape）给出（261144000，）。本来希望看到形状是 (261144000,3)，因为这个大数字是每个通道的行数（因此是值的数量），其中有 3 个。例如键入：

```
len(data'ch0']) 
```

返回，261144000

下一个问题是使用matplotlib的specgram函数的频谱图

```
 specgram(x, NFFT=256, Fs=2, Fc=0, detrend=mlab.detrend_none,
    window=mlab.window_hanning, noverlap=128,
    cmap=None, xextent=None, pad_to=None, sides='default',
    scale_by_freq=None, **kwargs) 
```

一些代码...

```
ADCR = 12        # ADC Resolution in bits
    VOLT = 5.0       # Voltage range
    SF = VOLT/(2**ADCR)  # scaling factor to convert raw ADC values to volts  

    w_length= 512 
    nFFT=2 * w_length
    n_overlap=np.fix(w_length/2)
    p_to = 4 *w_length
    cmap=plt.cm.seismic
    Fs = 10E6 # Sampling Frequency
    fig=plt.figure()
    ax=fig.add_subplot(111)
    Pxx, freqs, bins,im =    

plt.specgram((data['ch1'])*SF,NFFT=nFFT,Fs=Fs,noverlap=n_overlap,pad_to=p_to,cmap=cmap) 
```

运行最后一个命令适用于 Windows，但不适用于 Ubuntu。我收到以下消息：

内存错误...“无法发布图片，因为我需要 10 个声望才能发布”

```
MemoryError                               Traceback (most recent call last)
/media/IomegaHDD/<ipython-input-28-5144fe0c6918> in <module>()
----> 1 Pxx, freqs, bins, im = plt.specgram((data['ch1'])*SF,NFFT=nFFT,Fs=Fs,detrend=mlab.detrend_linear,noverlap=n_overlap,pad_to=p_to,scale_by_freq=True,cmap=cmap)

/usr/lib/pymodules/python2.7/matplotlib/pyplot.pyc in specgram(x, NFFT, Fs, Fc, detrend, window, noverlap, cmap, xextent, pad_to, sides, scale_by_freq, hold, **kwargs)
   2609         ax.hold(hold)
   2610     try:
-> 2611         ret = ax.specgram(x, NFFT, Fs, Fc, detrend, window, noverlap, cmap, xextent, pad_to, sides, scale_by_freq, **kwargs)
   2612         draw_if_interactive()
   2613     finally:

/usr/lib/pymodules/python2.7/matplotlib/axes.pyc in specgram(self, x, NFFT, Fs, Fc, detrend, window, noverlap, cmap, xextent, pad_to, sides, scale_by_freq, **kwargs)
   8146 
   8147         Pxx, freqs, bins = mlab.specgram(x, NFFT, Fs, detrend,
-> 8148              window, noverlap, pad_to, sides, scale_by_freq)
   8149 
   8150         Z = 10\. * np.log10(Pxx)

/usr/lib/pymodules/python2.7/matplotlib/mlab.pyc in specgram(x, NFFT, Fs, detrend, window, noverlap, pad_to, sides, scale_by_freq)
    458 
    459     Pxx, freqs, t = _spectral_helper(x, x, NFFT, Fs, detrend, window,
--> 460         noverlap, pad_to, sides, scale_by_freq)
    461     Pxx = Pxx.real #Needed since helper implements generically
    462 

/usr/lib/pymodules/python2.7/matplotlib/mlab.pyc in _spectral_helper(x, y, NFFT, Fs, detrend, window, noverlap, pad_to, sides, scale_by_freq)
    256     ind = np.arange(0, len(x) - NFFT + 1, step)
    257     n = len(ind)
--> 258     Pxy = np.zeros((numFreqs, n), np.complex_)
    259 
    260     # do the ffts of the slices

MemoryError: 
```

正如我所说，也许这是一个我不知道的 Ubuntu 问题，因为我在 Windows 中运行代码时没有遇到这个问题。然而，这与代码的其他后续部分有其自身的问题。

您的帮助将不胜感激。

谢谢你。

问候，

将要。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T17:24:05.173

您确定您正在运行 32 位 Ubuntu 发行版吗？您还必须运行 64 位版本的 python。

如果这是问题所在，则归结为 32 位操作系统（和程序）无法处理 64 位系统可以处理的大内存块。

要判断您是否有 64 位 Linux，请运行（在 Ubuntu 中）

```
$ uname -a 
```

并寻找

*   `x86_64 GNU/Linux`-- 64位
*   `ia64 GNU/Linux` -- 64位
*   `i386 GNU/Linux` -- 32 位

要查看您是否有 32 位 python 可执行文件，请查看

```
$ file -L `which python` 
```

并注意 64s 或 32s。

# c++ - 如何计算向量中每个值出现的频率？

> ID：15141548
> 
> 赞同：0
> 
> 时间：2013-02-28T14:25:44.943
> 
> 标签：c++, vector

我已经模拟了 10 个骰子，并将这些数字存储在一个名为`data`. 我需要按顺序对这 10 个数字进行排序，或者以让我的程序知道每个骰子面有多少的方式排序。一位朋友建议我使用一个数组，该数组遍历 10 个数字，并根据它是哪个骰子面，在六列之一中添加一个数字，但我不确定如何执行此操作。

```
void Game::sort_hands()
{
    vector<int> data;
    for(int i = 0; i < player.hand.size(); ++i){
        data.push_back(player.hand[i]);
        data.push_back(opponent.oppHand[i]);        
    }

    for(int i = 0; i < data.size(); ++i){
        cout<<data[i]<<"  ";
    }
} 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-28T15:15:30.037

好吧，如果您正在寻找某人来回答您的家庭作业，我会说这是错误的地方，但我们可以为您指明正确的方向。有许多常见且易于实现的排序算法，但请注意，考虑到数据集的大小，与许多排序算法相关的开销可能不值得。研究算法，并了解您正在使用的数据结构 std::vector 的功能。

# c# - 在 C# 中从 DB 的列表框中显示数据的最佳方法

> ID：15141553
> 
> 赞同：0
> 
> 时间：2013-02-28T17:11:14.957
> 
> 标签：c#, database, winforms

我有一个本地数据库，它保存汽车的记录，它有字段 ID（ai、primary）、plateNumber、Comments 等。我还有一个带有 ListBox 的表单、“Checked”按钮和许多文本字段。

我使用的是winforms，每次运行应用程序时，构造函数都会从数据库中检索所有具有名为“checked”== null 的bool 字段的记录，并在Listview 中显示车牌号。单击该列表框中的特定车牌号时，所选车牌的其他列数据应出现在文本字段中，但

问题是可能有更多具有相同 plateNumber 的记录，其中 "Checked" == null（否则为 true）。

问题：如何在“幕后”保留有关特定车牌号的信息，当人们单击从列表框中选择车牌号时，它会在表单中显示有关当前（按id）车牌号的数据。请注意，如果用户单击表单上的“已检查”按钮，它会将“TRUE”存储在数据库“已检查”字段中并从列表框中删除特定的 carPlate，并且下次启动应用程序时，它不会显示该特定的ID。在网络中，我使用带有 javascript 的隐藏字段来实现这一点，在 C# 中，我不知道你如何保存这样的信息，我倾向于数组？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T17:16:14.690

ListViews 由 ListViewItems 填充。ListViewItem 类有一个 Tag 属性，您可以在其中存储您想要的任何内容。您的“隐藏”或“幕后”数据可以存储在那里。

# dependencies - 如何配置 ivy 来解决 htmlunit 的依赖

> ID：15141555
> 
> 赞同：0
> 
> 时间：2013-02-28T17:11:19.283
> 
> 标签：dependencies, ivy, htmlunit

ivy 可以解决依赖项的依赖关系，文档说可以使用模块配置来告诉 ivy 配置依赖于依赖项的给定配置。

我想在一个项目中使用 htmlunit，在它的[sourceforge 页面](http://htmlunit.sourceforge.net/dependency-info.html)依赖信息中我找到了依赖设置，我将 maven 规范翻译为 ivy：

```
<dependency org="net.sourceforge.htmlunit" name="htmlunit" rev="2.11"/> 
```

我写了一个测试，编译它，当试图运行它时，我有一个 ClassNotFoundException，我再次回到 sourceforge，并查找有关 htmlunit 依赖项的信息，在此[页面](http://htmlunit.sourceforge.net/dependencies.html)中我找到了我要查找的内容，所以我认为一切都是我的需要使用模块配置的魔力，所以我补充说：

```
<dependency org="net.sourceforge.htmlunit" name="htmlunit" rev="2.11" conf="test->compile; test->test"/> 
```

但我有这个错误告诉我在 net.sourceforge.htmlunit#htmlunit;2.11, 'compile' 中找不到配置

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T23:47:18.607

编译配置确实存在....

尝试重现您的问题时，我发现了以下错误消息：

```
[ivy:resolve]       ::::::::::::::::::::::::::::::::::::::::::::::
[ivy:resolve]       ::          UNRESOLVED DEPENDENCIES         ::
[ivy:resolve]       ::::::::::::::::::::::::::::::::::::::::::::::
[ivy:resolve]       :: net.sourceforge.htmlunit#htmlunit;2.11: 
    configuration not public in net.sourceforge.htmlunit#htmlunit;2.11: 'test'...... 
```

当 ivy 将 Maven 模块转换为配置时，它以不允许解析传递测试依赖项的方式进行。

这种推理有一些逻辑，毕竟所有测试依赖项都是为了支持 htmlunit 模块的测试而设计的。你的模块应该明确声明它自己的测试依赖项......

我通常建议将您的“测试”配置映射到远程“运行时”Maven 范围，以便获取额外的 jar：

```
<dependency org="net.sourceforge.htmlunit" 
            name="htmlunit" 
            rev="2.11" 
            conf="compile->default;test->runtime"/> 
```

问题是 htmlunit 模块中没有“运行时”依赖项，这意味着这没有任何帮助。

总之，您没有指出缺少哪个课程。如果它像 junit 一样明显，那么我建议这是应该在你的常春藤文件中明确声明的东西。

# git - 在 Github 上监控库的正确流程

> ID：15141559
> 
> 赞同：0
> 
> 时间：2013-02-28T17:11:34.913
> 
> 标签：git, github

在 Github 上监视对库所做更改的正确方法是什么？

我有一个在 Github 上使用多个库的项目，我想知道如何监控这些库的更新。如果我将项目标记为正在观看，我想我也会收到所有关于问题等的电子邮件，我只是在寻找更改通知。

目前，它们是从 Github 以 zip 格式下载的项目/库，并手动附加到我的项目中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T17:23:21.787

我总是将 git 托管的库添加为子模块。然后，如果它在 github 上，我会继续关注它。我的手机和桌面上都有 RSS 提要，所以我可以看到有人何时将提交推送到任何这些库。之后它就像进入子模块和`git fetch`&一样简单`git merge`。如果我想更新它们，我只是`git submodule foreach git pull`

* * *

## 子模块

[从文档](http://jk.gs/git-submodule.html)中直接引用：

> 子模块允许将外部存储库嵌入到源树的专用子目录中，始终指向特定的提交。

子模块绝对是在您的项目中使用 git 托管库的方式。

添加子模块：`git submodule add <repository> [<path>]`路径是可选的，如果未定义，将使用存储库的名称。

当你添加一个子模块时，如果你检查`git status`你会看到这样的东西。

```
$ git status
# On branch master
# Changes to be committed:
#   (use "git reset HEAD <file>..." to unstage)
#
#      new file:   .gitmodules
#      new file:   submodule 
```

正如您注意到的那样，整个文件夹被作为一个文件进行跟踪，并且有一个名为`.gitmodules`added 的文件。`.gitmodules`file 是一个配置文件，用于存储远程存储库和您拉入的本地子目录之间的映射。您在 git 中看到的子模块本身。如果您`git diff --cached`在子模块文件本身上运行 a，您将看到它只是子模块存储库上最新提交的提交 SHA。

git 中的子模块是实际的存储库，因此您可以进入它们并执行您可以使用普通存储库执行的任何操作。Git 实际上并不跟踪子模块的内容，而是将其记录为来自子模块本身的特定提交。因此，如果需要，您可以在子模块上使用特定的提交。

解释子模块的一个很好的资源是[git book](http://git-scm.com/book/en/Git-Tools-Submodules)。

# python - python netcdf：复制所有变量和属性，但一个

> ID：15141563
> 
> 赞同：16
> 
> 时间：2013-02-28T17:11:52.270
> 
> 标签：python, netcdf

我需要处理 netcdf 文件中的单个变量，该文件实际上包含许多属性和变量。我认为不可能更新 netcdf 文件（请参阅问题[如何删除 Scientific.IO.NetCDF.NetCDFFile 中的变量？](https://stackoverflow.com/questions/6816613)）

我的方法如下：

1.  从原始文件中获取要处理的变量
2.  处理变量
3.  将所有数据从原始 netcdf 但处理后的变量复制到最终文件
4.  将处理后的变量复制到最终文件

我的问题是编写第 3 步的代码。我从以下内容开始：

```
def  processing(infile, variable, outfile):
        data = fileH.variables[variable][:]

        # do processing on data...

        # and now save the result
        fileH = NetCDFFile(infile, mode="r")
        outfile = NetCDFFile(outfile, mode='w')
        # build a list of variables without the processed variable
        listOfVariables = list( itertools.ifilter( lamdba x:x!=variable , fileH.variables.keys() ) )
        for ivar in listOfVariables:
             # here I need to write each variable and each attribute 
```

如何在少量代码中保存所有数据和属性，而无需重建整个数据结构？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2018-03-31T21:23:24.713

这是我刚刚使用和工作的。@arne 的答案针对 Python 3 进行了更新，还包括复制变量属性：

```
import netCDF4 as nc
toexclude = ['ExcludeVar1', 'ExcludeVar2']

with netCDF4.Dataset("in.nc") as src, netCDF4.Dataset("out.nc", "w") as dst:
    # copy global attributes all at once via dictionary
    dst.setncatts(src.__dict__)
    # copy dimensions
    for name, dimension in src.dimensions.items():
        dst.createDimension(
            name, (len(dimension) if not dimension.isunlimited() else None))
    # copy all file data except for the excluded
    for name, variable in src.variables.items():
        if name not in toexclude:
            x = dst.createVariable(name, variable.datatype, variable.dimensions)
            dst[name][:] = src[name][:]
            # copy variable attributes all at once via dictionary
            dst[name].setncatts(src[name].__dict__) 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-08-14T04:42:34.797

如果您只是想复制文件并挑选出变量，`nccopy`这是@rewfuss 提交的一个很棒的工具。

这是一个 Pythonic（更灵活）的解决方案，带有[`python-netcdf4`](https://pypi.python.org/pypi/netCDF4/1.1.9). 这允许您在写入文件之前打开它以进行处理和其他计算。

```
with netCDF4.Dataset(file1) as src, netCDF4.Dataset(file2) as dst:

  for name, dimension in src.dimensions.iteritems():
    dst.createDimension(name, len(dimension) if not dimension.isunlimited() else None)

  for name, variable in src.variables.iteritems():

    # take out the variable you don't want
    if name == 'some_variable': 
      continue

    x = dst.createVariable(name, variable.datatype, variable.dimensions)
    dst.variables[x][:] = src.variables[x][:] 
```

这没有考虑变量属性，例如`fill_values`. 您可以按照文档轻松完成此操作。

请注意，以这种方式写入/创建的 netCDF4 文件将无法撤消。修改变量的那一刻，它会在 with 语句的末尾写入文件，或者如果您调用`.close()`.`Dataset`

当然，如果您希望在编写变量之前对其进行处理，则必须注意要创建哪些维度。在新文件中，切勿在未创建变量的情况下写入变量。此外，切勿在未定义维度的情况下创建变量，如[的文档中](http://unidata.github.io/netcdf4-python/#netCDF4.Dataset.createVariable)[所述`python-netcdf4`](http://unidata.github.io/netcdf4-python/#netCDF4.Dataset.createVariable)。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2017-03-13T09:49:22.067

这个答案建立在 Xavier Ho ( [https://stackoverflow.com/a/32002401/7666](https://stackoverflow.com/a/32002401/7666) ) 的答案之上，但是我需要修复它来完成它：

```
import netCDF4 as nc
import numpy as np
toexclude = ["TO_REMOVE"]
with nc.Dataset("orig.nc") as src, nc.Dataset("filtered.nc", "w") as dst:
    # copy attributes
    for name in src.ncattrs():
        dst.setncattr(name, src.getncattr(name))
    # copy dimensions
    for name, dimension in src.dimensions.iteritems():
        dst.createDimension(
            name, (len(dimension) if not dimension.isunlimited else None))
    # copy all file data except for the excluded
    for name, variable in src.variables.iteritems():
        if name not in toexclude:
            x = dst.createVariable(name, variable.datatype, variable.dimensions)
            dst.variables[name][:] = src.variables[name][:] 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-04-16T21:50:04.667

C netCDF 4.3.0 及更高版本中的 nccopy 实用程序包括一个选项，用于列出要复制的变量（连同它们的属性）。不幸的是，它不包括排除哪些变量的选项，这是您需要的。

但是，如果要包含的（以逗号分隔的）变量列表不会导致 nccopy 命令行超出系统限制，那么这将起作用。此选项有两种变体：

```
nccopy -v var1,var2,...,varn input.nc output.nc
nccopy -V var1,var2,...,varn input.nc output.nc 
```

第一个 (-v) 包括*所有*变量定义，但仅包含命名变量的数据。第二个 (-V) 不包括未命名变量的定义或数据。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-08-15T22:26:31.903

我知道这是一个老问题，但作为替代方案，您可以使用库[netcdf](https://pypi.python.org/pypi/netcdf/0.1.3)和[shutil](https://docs.python.org/2/library/shutil.html)：

```
import shutil
from netcdf import netcdf as nc

def processing(infile, variable, outfile):
    shutil.copyfile(infile, outfile)
    with nc.loader(infile) as in_root, nc.loader(outfile) as out_root:
        data = nc.getvar(in_root, variable)
        # do your processing with data and save them as memory "values"...
        values = data[:] * 3
        new_var = nc.getvar(out_root, variable, source=data)
        new_var[:] = values 
```

# ruby-on-rails - Ruby on Rails 的初学者..需要帮助将框架整合到我的应用程序中

> ID：15141568
> 
> 赞同：-5
> 
> 时间：2013-02-28T17:12:12.073
> 
> 标签：ruby-on-rails, ruby

我对使用 Ruby on Rails 几乎是全新的，我正在尝试为我的一个类创建一个包含 3 个表的应用程序。
我最初的计划是使用汽车经销商应用程序。在这个经销店里，我有我的三个模型车辆、评论和推销员。我开始对我真正想要我的应用程序做什么感到困惑。我的关系是车辆有_许多销售员和销售员有_和_属于_许多车辆。然后我关联了我的 Vehicles has_many 评论和评论 belongs_to_vehicle。现在我正在考虑放弃这个想法并重新开始。我认为使用 Customer 模型而不是 Salesman 可能会更好。我什至不知道我的问题是什么，但客户会在这个应用程序中更有意义。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T17:15:30.247

当我第一次开始使用 Rails 时，我使用了两个站点作为我的主要参考点。

我从本教程开始。它让我了解了 MVC 框架的基本概念。

[http://ruby.railstutorial.org/ruby-on-rails-tutorial-book](http://ruby.railstutorial.org/ruby-on-rails-tutorial-book)

这个网站帮助我完成了我试图完成的任何特定任务。

[http://www.railscasts.com](http://www.railscasts.com)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T17:15:02.860

首先，想想你的应用程序应该做什么。

其次，考虑如何使用 Rails 进行建模。

您跳过了第一步，现在您显然在第二步中遇到了问题:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T17:48:04.157

作为一个刚接触 Rails 的人（我一直在学习 Rails，作为我使用了几年的 HTML + CSS 的升级版）：我强烈建议您阅读一些指导性教程，例如 Michael Hartl 的教程这里：[http](http://ruby.railstutorial.org/ruby-on-rails-tutorial-book) ://ruby.railstutorial.org/ruby-on-rails-tutorial-book 。

当您宁愿构建您脑海中的应用程序时，通过指导教程工作并不总是很有趣，但您需要先学习基础知识，然后才能自己动手。在完成教程时，尝试使用教程提供的代码，尝试一些不同的东西，并思考如何将您所学的概念应用到您自己的应用程序创意中。

这种方法将比仅仅试图在你去的时候弄清楚事情要成功得多——你必须了解 Rails 框架的基本概念，否则你永远不会到达你想要去的地方。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-28T17:27:39.483

听起来你在走路之前就想跑步。Rails 是/可能非常复杂和复杂；需要考虑诸如数据建模、控制器和视图之类的东西。如果您不了解 MVC 的工作原理、面向对象设计和面向对象编程的一般工作原理，那么您将在这个项目上遇到非常困难的时间。

如果我是你，我会从博客开始。做一个汽车经销商网站比你现在准备的要先进得多。我不是说侮辱，只是说实话。

从这里开始：[http ://ruby.learncodethehardway.org/book/](http://ruby.learncodethehardway.org/book/)

这应该让你继续前进。这些教程很棒，应该可以帮助您到达需要去的地方。祝你好运。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-01T08:04:13.117

这是一个非常人为的例子，你可以玩弄……我添加了评论来解释这些片段。

```
# This represents a given car dealer
class Dealer < ActiveRecord::Base
  has_many :vehicles
  has_many :salesmen
  has_many :sales

  # Example attributes might be:
  # dealer's name
  # dealer address
  # company etc
end

# The car/truck etc
class Vehicle < ActiveRecord::Base
  belongs_to :dealer
  has_many :sales

  # Example attributes might be:
  # dealer_id (so you know what dealer has the car)
  # make
  # model
  # color etc
end

# The person who's selling
class Salesman < ActiveRecord::Base
  belongs_to :dealer
  has_many :sales
  has_many :vehicles_sold, :through => :sales

  # Example attributes might be:
  # dealer_id (so you know what dealer he works for)
  # name
  # address
  # employee number
end

# This is the join table/model between a vehicle & salesman.
# Each row represents the sale of a car.
class Sale < ActiveRecord::Base
  belongs_to :vehicle
  belongs_to :salesman

  # vehicle_id (so you know which car was sold)
  # salesman_id (so you know who sold the car)
  # sales price
  # date sold
  # etc
end 
```

# openerp - 新菜单项未显示

> ID：15141571
> 
> 赞同：1
> 
> 时间：2013-02-28T17:12:19.293
> 
> 标签：openerp

我正在使用 OpenERP 7.0，并`products`使用表格进行了扩展，并且在销售 - 配置 - 产品下`products_available_at`添加了一个菜单选项。`Locations`如果我以管理员身份登录，则菜单项显示得很好，但其他任何人都没有。

任何想法如何使菜单项显示给每个人？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T11:05:12.357

这将是一个安全问题。请检查您是否为新型号和菜单提供了安全保障。

设置 -> 技术 -> 安全 -> [记录规则 | 访问控制列表]

# r - 将堆栈转换为数据框

> ID：15141574
> 
> 赞同：0
> 
> 时间：2013-02-28T16:41:20.200
> 
> 标签：r, dataframe

堆叠几个数据集后，我需要再次将堆栈转换为数据框以生成箱线图。获得有关此任务的可能命令的建议会很棒。非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T04:30:04.830

我假设您的意思是 R（您应该始终清楚您的意思是什么软件！）

如果您有一个变量来指示他们来自哪个组，则无需取消堆叠。

例如，请参阅[?boxplot](http://stat.ethz.ch/R-manual/R-devel/library/graphics/html/boxplot.html)下的示例- 将它们粘贴并尝试它们

这是一个例子：

```
boxplot(count ~ spray, data = InsectSprays, col = "lightgray",boxwex=.4) 
```

![InsectSprays 数据的箱线图](../Images/7f8f5df6cd0826086e1186d15a5cfc64.png)

该数据是堆叠的：

```
> head(InsectSprays,15)
   count spray
1     10     A
2      7     A
3     20     A
4     14     A
5     14     A
6     12     A
7     10     A
8     23     A
9     17     A
10    20     A
11    14     A
12    13     A
13    11     B
14    17     B
15    21     B
... 
```

# php - CodeIgniter 在另一个函数中为空 $_FILES

> ID：15141575
> 
> 赞同：0
> 
> 时间：2013-02-28T17:12:23.643
> 
> 标签：php, file, codeigniter, file-upload

我的multi-part form的流程基本上是**Answer form -> Preview form -> Upload to database**

现在我在预览步骤中上传我的文件，因为`POST`数据是来自实际表单的新数据。`$_FILES`我的问题是在 Upload to database 函数中访问一次，因为在内部`var_dump($_FILES)`返回`array(0) {}`一次`upload_to_database()`。

**我想在`upload_to_database()`函数中而不是在预览步骤中进行文件上传。**

我想实际上在 Preview 步骤中隐藏`input[type=file]`，以便我`upload_to_database()`会收到`$_FILES`，但由于安全原因，这是不可能的。

如何`$_FILES`从 Preview 获得完整且持久的到`upload_to_database()`?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T17:33:23.040

您可以将文件存储在服务器上，然后在 $_SESSION 中传递文件的位置。然后只需设置一个 cron 作业来做家务，并删除任何已放置超过合理时间的文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T17:18:51.020

也许您可以输入“预览步骤”并在“上传步骤”中`$_FILES`获取`$_SESSION`

# java - 我在一种方法中创建了一个对象，并尝试在其他方法中使用它

> ID：15141577
> 
> 赞同：0
> 
> 时间：2013-02-28T17:12:32.707
> 
> 标签：java

所以我的代码看起来像这样：

```
class Pozadina extends JPanel implements MouseListener {
  ArrayList<Pozicija> list;
  public Pozicija _11;

    public void paintComponent(Graphics g){

                ArrayList<Pozicija> list=new ArrayList<Pozicija>();
                Pozicija _11=new Pozicija();
                _11.setCoords(korak,korak);
                list.add(_11);

                //lots of drawing here

                for (Pozicija p:list) {
                    if (p.getBelongsTo()==1){
                        g.setColor(Color.blue);
                    }

                    g.fillOval(p.getX(), p.getY(), 20, 20;
                    g.setColor(Color.black);
                }//for loop
       }//paintComponent method 
```

然后我的 main 看起来像这样：

```
public static void main(String[] args) {
            JFrame frame = new JFrame();
            frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
            frame.setSize(630,630);
            Pozadina pozadina= new Pozadina();
            frame.getContentPane().add(pozadina);
            frame.addMouseListener(pozadina);
            frame.setVisible(true);
        } 
```

在点击事件看起来像这样：

```
public void mouseClicked(MouseEvent e) {
            _11.setPlayer1();
            pozadina.repaint();
        } 
```

所以问题是我在图形中创建 _11 对象，所以鼠标 Clicked 方法返回空指针异常。我确实有 Pozicija _11；设置为类的实例变量，但它不起作用。我试图弄清楚如何避免这种情况，但我对 java 还很陌生，而且我的想法已经用完了。

编辑：即使我这样做，我也会收到 Null Point Exception 错误。:S

```
public void mouseClicked(MouseEvent e) {
                /*_11.setPlayer1();
                pozadina.repaint();*/
            } 
```

它告诉我它的行“/*_11.setPlayer1();”。不知道发生了什么。

我确实尝试了 2 个发布的建议，我总是将 _11 作为类中的实例变量，我只是没有在这里复制它。

EDIT2：首先，感谢所有答案。:D 我已经更新了我的代码以显示我有 list 和 _11 作为实例变量，它总是这样，我只是在复制我的代码时没有复制它。请检查最后的编辑，它可能会帮助你。我假设我因为其他原因而出错，因为即使我对我认为导致错误的部分发表评论，我仍然会出错。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T17:16:01.653

您必须像这样在类环境中定义 _11 ，否则如果不直接作为输入传递，则无法从另一个方法访问方法中定义的变量。

```
class Pozadina extends JPanel implements MouseListener {

     public Pozicija _11;

     public void paintComponent(Graphics g){

            ArrayList<Pozicija> list=new ArrayList<Pozicija>();
            _11=new Pozicija();
            _11.setCoords(korak,korak);
            list.add(_11);

            //lots of drawing here

            for (Pozicija p:list) {
                if (p.getBelongsTo()==1){
                    g.setColor(Color.blue);
                }

                g.fillOval(p.getX(), p.getY(), 20, 20;
                g.setColor(Color.black);
            }//for loop
      }//paintComponent method 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T17:16:59.483

我没有看到在哪里`_11`声明为实例变量，但我确实看到了你在方法中声明`_11`的`paintComponent`位置

```
Pozicija _11=new Pozicija();
_11.setCoords(korak,korak);
list.add(_11); 
```

现在，如果这不会使您的代码无法编译，那么唯一合乎逻辑的结论是它将任何现有的实例变量置于`_11`该方法的其余部分的范围之外，并且如果您对该方法执行任何操作，它将不会被更改.

* * *

为了让它成为一个实例字段，它必须像这样在你的方法之外声明

```
class Pozadina extends JPanel implements MouseListener {

    public /*or private*/ Pozicija _11;

    public void paintComponent(Graphics g){
        ArrayList<Pozicija> list=new ArrayList<Pozicija>();
        _11=new Pozicija();
        _11.setCoords(korak,korak);
... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T17:23:10.423

在您的 Pozina 构造函数中实例化您的 _11 变量并将其从 paint() 方法中删除。

您的代码可能如下所示：

```
class Pozadina extends JPanel implements MouseListener {
    private Pozicija _11;
    ArrayList<Pozicija> list=new ArrayList<Pozicija>();            

    public Pozadina(){
        _11=new Pozicija();
    }

    public void paintComponent(Graphics g){

        _11.setCoords(korak,korak);
        list.add(_11);

        //lots of drawing here

        for (Pozicija p:list) {
            if (p.getBelongsTo()==1){
                g.setColor(Color.blue);
            }

         g.fillOval(p.getX(), p.getY(), 20, 20;
         g.setColor(Color.black);
            }//for loop
   }//pa

     public void mouseClicked(MouseEvent e) {
         _11=new Pozicija();
         _11.setPlayer1();
         pozadina.repaint();
     }
} 
```

# java - drawBitmap() 绘制虚假部分

> ID：15141578
> 
> 赞同：1
> 
> 时间：2013-02-28T17:12:36.107
> 
> 标签：java, android, bitmap, android-canvas

我正在尝试在`ImageView`. 我试过了，`canvas.drawBitmap()`但似乎显示了图像的错误部分。我的代码：

主要活动：

```
 this.drawCharacter = new DrawCharacter(1);
    this.bm = Bitmap.createBitmap(16, 32, Bitmap.Config.ARGB_8888);
    this.c = new Canvas(this.bm);
    this.c = this.drawCharacter.drawCharacter(this.c, this.characterBitmap);
    this.bm = Bitmap.createScaledBitmap(this.bm, this.imgWidth, this.imgHeight, isChild());

    this.imgv.setImageBitmap(this.bm); 
```

绘制字符：

```
[...]
  Paint localPaint = new Paint();
  paramCanvas.drawBitmap(paramBitmap, new Rect(8, 8, 16, 16), new Rect(4, 0, 12, 8), localPaint);
  return paramCanvas;
[...] 
```

最后显示了图像的一些奇怪部分。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T17:26:37.477

在您的`drawBitmap()`调用中，您将第一个 Rect 参数设置为 8、8、16、16，这是要绘制的位图中的源矩形，将其设置为 null 以绘制整个位图。

[见文档](http://developer.android.com/reference/android/graphics/Canvas.html#drawBitmap%28android.graphics.Bitmap,%20android.graphics.Rect,%20android.graphics.RectF,%20android.graphics.Paint%29)

如果您想根据初始位图比例应用此边界，您可能需要在您的 src 矩形上应用相同的比例。（尝试删除比例部分，`createScaledBitmap()`看看你的 src 矩形是否没有比例好；））

# php - PHP命令行失败，完整路径没有错误

> ID：15141581
> 
> 赞同：-1
> 
> 时间：2013-02-28T17:12:42.637
> 
> 标签：php, linux, cron, command-line-interface

基本上就是这个

```
>php /full/path/to/php/file.php
```

失败，在任何日志中的任何地方都没有输出、警告和错误。看起来它运行良好，但它实际上并没有运行。但是，将工作目录更改为 /full/path/to/file/php

```
> php 文件.php
```

按预期工作。

这个 php 脚本的特别之处在于：

1.  从 NFS 挂载读取文件

2.  解析内容

3.  将文件内容加载到本地 MySQL 表中

4.  重命名已成功加载的文件。

    操作系统为 CentOS 6。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T17:28:51.117

根据您的编辑，在您的脚本中，您应该更改为正确的目录。您可以使用以下方法做到这一点[`chdir`](http://php.net/manual/en/function.chdir.php)：

```
chdir('/full/path/to/php/'); 
```

现在 php 可能在错误的地方寻找符号链接。

您可以使用`getcwd()`查看您所在的目录。

# jquery - 当我使用 Jquery 为元素设置动画时出现条形图

> ID：15141585
> 
> 赞同：1
> 
> 时间：2013-02-28T17:13:00.497
> 
> 标签：jquery, jquery-animate

当我使用 Jquery 为元素设置动画时，其中的一部分位于较旧的位置。很难解释，所以我上传了一张图片。你认为这是浏览器的问题，Jquery 还是我的问题？

[我试图解释的图像](http://i.stack.imgur.com/ElEVm.jpg)

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T19:39:42.467

我看了看，如果您删除 ul.MenuMaisons 上的剩余边距，它似乎可以正常工作。它在 Internet Explorer 中运行良好。这一定是 Chrome 的浏览器问题。

```
ul.MenuMaisons {
   width: 250px;
   position: fixed;
   top: 100px;
   left: 50%;
   /*margin-left: -427.5px;*/
} 
```

遗憾的是，我不知道删除左边距会对您的网站产生什么影响。您可以尝试使用填充代替。

# android - 错误：未检测到文档的语法约束（DTD 或 XML 模式）

> ID：15141586
> 
> 赞同：3
> 
> 时间：2013-02-28T17:13:02.170
> 
> 标签：android, eclipse

如标题中所述，我对这个 xml 文件有疑问。我不知道如何解决这个问题，因为我已经搜索了很多，并且只找到了使用这种类型的清理或更改验证来忽略上述任何一个的答案，因为我想解决这个问题，以便我的 R 将在根文件夹。

希望有人能尽快看到问题，因为这是我正在处理的考试项目，如果不解决此错误就无法进一步解决:)

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".Dekrypter" >

    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerHorizontal="true"
        android:layout_centerVertical="true"
        android:text="@string/hello_world" />

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-08-03T12:03:47.970

使用以下命令开始您的 XML：

```
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE RelativeLayout> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-09T21:02:04.377

解决办法就是把这段代码放在xml上面。它识别要编码的文档的类型！

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE xml> 
```

重新验证项目！

再见！！！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-10-11T09:02:48.787

我从错误问题中检索解决方案：

1.  单击窗口 > 首选项 > XML > XML 文件 > 验证
2.  将设置“验证文件”>“未指定语法”从警告更改为忽略。
3.  重新验证您的项目。现在没有更多警告了。

这个对我有用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-28T17:15:10.237

添加

```
<?xml version="1.0" encoding="utf-8"?> 
```

到 XML 文件的顶部。这告诉解析器您的文件确实是 XML，它应该使用 XML 版本 1.0，并且您正在使用 utf-8 编码。

没有它，解析器不知道它应该如何解析您的 XML。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-11-27T09:53:21.963

首先放这个：
`<?xml version="1.0" encoding="UTF-8"?> <!DOCTYPE xml>`
然后做这个结构：
单击窗口>首选项> XML> XML文件>验证
将设置“验证文件”>“未指定语法”从警告更改为忽略。
重新验证您的项目。现在没有更多警告了。
谢谢 AntoineP 和 TecnoHelp83
[https://stackoverflow.com/a/19314230/3117196](https://stackoverflow.com/a/19314230/3117196)
[https://stackoverflow.com/a/22973854/3117196](https://stackoverflow.com/a/22973854/3117196)
也很好用

# linux - 排除来自“du”的所有权限被拒绝消息

> ID：15141588
> 
> 赞同：60
> 
> 时间：2013-02-28T17:13:13.223
> 
> 标签：linux, shell, warnings, suppress-warnings, du

我正在尝试评估一些 Unix 用户帐户的磁盘使用情况。简单地说，我正在使用以下命令：

```
du -cBM --max-depth=1 | sort -n 
```

但是我看到了很多如下错误消息。如何从显示中排除所有此类“权限被拒绝”消息？

```
du: `./james/.gnome2': Permission denied 
```

**通过将“find”替换为“du”，我的请求可能与以下列表非常相似。**

[如何从“查找”中排除所有“权限被拒绝”消息？](https://stackoverflow.com/q/762348)

以下线程不起作用。我想我正在使用bash。

[使用 --exclude、grep -v 或 sed 从 du 命令输出中排除隐藏文件](https://stackoverflow.com/q/5463884)

* * *

## 回答 #1

> 赞同：95
> 
> 时间：2013-02-28T17:38:53.003

```
du -cBM --max-depth=1 2>/dev/null | sort -n 
```

或者在 bash 中更好（只是过滤掉这个特定的错误，而不是像最后一个片段一样）

```
du -cBM --max-depth=1 2> >(grep -v 'Permission denied') | sort -n 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-25T18:53:37.737

2> /dev/nul 仅隐藏错误消息。

命令 du 总是尝试遍历目录。想象一下，您有数千个目录？

du 需要 eval，如果您有权限运行，如果没有，请按照下一个目录...

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2017-09-24T23:31:29.523

我会使用一些简洁的东西，只排除你不想看到的行。将 stderr 重定向到 stdout，并用 grep 排除所有“拒绝”：

```
du -cBM --max-depth=1 2>&1 | grep -v 'denied' | sort -n 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-11-02T15:40:21.827

如果`2>/dev/null`不起作用，可能您使用的 shell 不是`bash`.

要检查您使用的外壳，您可以尝试`ps -p $$`（请参阅[https://askubuntu.com/a/590903/130162](https://askubuntu.com/a/590903/130162)）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2021-08-12T13:03:26.290

为了消除来自 du 命令的所有错误，我使用了这个：

```
du -sh 2>&1 | grep -v  '^du:' 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-05-27T23:16:43.980

您可以将其通过管道传输到一个临时文件，例如 -

杜... **> temp_file**

错误会打印在终端上，只有磁盘使用信息会打印到 temp_file 中。

# java - 运行测试套件集次数的自定义 BlockJUnit4ClassRunner

> ID：15141593
> 
> 赞同：1
> 
> 时间：2013-02-28T17:13:24.613
> 
> 标签：java, junit, annotations

我做了以下自定义[BlockJUnit4ClassRunner](http://junit.sourceforge.net/javadoc/org/junit/runners/BlockJUnit4ClassRunner.html)

```
 public class RepeatEachTest extends BlockJUnit4ClassRunner {

  private int repeats;

  public RepeatEachTest(Class<?> klass) throws InitializationError {
    super(klass);
    Repeat r = klass.getAnnotation(Repeat.class);
    if (r == null) {
        throw new InitializationError("A @Repeat annonation must also be suplied to class, for example @Repeat(5) to repeat 5 times");
    }
    repeats = r.value();
  }

  @Override
  protected void runChild(FrameworkMethod method, RunNotifier notifier) {
    for (int i = 0; i < repeats; i++) {
        super.runChild(method, notifier);
    }
  }

  @Override
  public int testCount() {
    return repeats * super.testCount();
  }
} 
```

和

```
@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.TYPE)
public @interface Repeat {  
 int value();
} 
```

执行*每个*测试`@Repeat.value()`的次数。试运行

```
@RunWith(RepeatEachTest.class)
@Repeat(2)
public class RepeatEachTestTest {

  @Test
  public void first() {
    System.out.println("ran first");
  }

  @Test
  public void second() {
    System.out.println("ran second");
  }
} 
```

好像

```
ran first
ran first
ran second
ran second 
```

但现在我想实现第二个[BlockJUnit4ClassRunner](http://junit.sourceforge.net/javadoc/org/junit/runners/BlockJUnit4ClassRunner.html)运行*整个测试类* `@Repeat.value()`的次数。从该设置运行看起来像

```
ran first
ran second
ran first
ran second 
```

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T08:03:29.090

这取决于你想要什么。如果您希望多次调用`@BeforeClass`and方法和类规则，您可以覆盖：`@AfterClass``classBlock()`

```
protected Statement classBlock(final RunNotifier notifier) {
  return new Statement() {
    @Override
    public void evaluate() throws Throwable {
      for (int i = 0; i < repeats; i++) {
        super.classBlock(notifier).evaluate();
      }
    }
  };
} 
```

如果您希望一次调用`@BeforeClass`and方法和类规则，请覆盖（代码类似）。`@AfterClass``childrenInvoker()`

但是请注意，其中任何一个都会导致侦听器多次收到测试已经开始和完成的通知。在这种情况下，某些侦听器的行为可能不正确。

# flash - Adobe AIR 和 swf 反编译器

> ID：15141596
> 
> 赞同：1
> 
> 时间：2013-02-28T17:13:32.183
> 
> 标签：flash, air, adobe

对于我的工作，我从一个客户那里获得了一个应用程序“Adobe AIR”。我用“Swf DEcompiler”分析了该软件，因为我无法访问源代码。在分析过程中，我发现 valeure 静态阻止了连接“应用程序/服务器”。我无法使用 SWF Decompiler 更改该值，因此我导出了应用程序的全部内容。“作为”。

我的问题是，如何在 Adob​​e Air 中重新编译整个应用程序？

提前致谢。

# javascript - 使用 underscore.js 展平 javascript 对象数组

> ID：15141599
> 
> 赞同：1
> 
> 时间：2013-02-28T17:13:38.010
> 
> 标签：javascript, jquery, arrays, object, underscore.js

我有一个 javascript 对象数组，如下所示：

```
"partners":[{"username":"fangonk","profileImg":"fangonk.jpg"},
            {"username":"jane","profileImg":"jane.jpg"},
            {"username":"tom_jones","profileImg":"tom.jpg"}] 
```

我想使用下划线库输出每个数组键的值。因此，对于每个对象，我想输出如下所示的内容：

```
<h1>Username Value</h1><img src="profileImg Value here" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T17:25:05.073

对你的“来源”有点困惑，但我认为你只是想这样做：

```
_.each(partners, function(p) { document.write('<h1>' + p.username + '</h1>\
  <img src="' + p.profileImg + '" alt="' + p.username + '" />'); }
//substitute some DOM method (e.g. jquery().append) for document.write 
```

这是你要找的结果吗？

这仅适用于您的来源看起来更像：

```
var partners = [{"username":"fangonk","profileImg":"fangonk.jpg"},
                {"username":"jane","profileImg":"jane.jpg"},
                {"username":"tom_jones","profileImg":"tom.jpg"}]; 
```

编辑：

```
var someBiggerObject = { 
  partners: [
    {"username":"fangonk","profileImg":"fangonk.jpg"},
    {"username":"jane","profileImg":"jane.jpg"},
    {"username":"tom_jones","profileImg":"tom.jpg"}
  ]
};

_.each(someBiggerObject.partners, function(p) { document.write('<h1>' + p.username + '</h1>\
  <img src="' + p.profileImg + '" alt="' + p.username + '" />'); }
//substitute some DOM method (e.g. jquery().append) for document.write 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T06:43:00.530

正确的方法是 _.template

[例子](http://codepen.io/anon/pen/kqvzB)

如果你的结构是这样的：

```
var list = {"partners":[ 
    {"username":"fangonk","profileImg":"fangonk.jpg"},
    {"username":"jane","profileImg":"jane.jpg"},
    {"username":"tom_jones","profileImg":"tom.jpg"}
]}; 
```

您可以创建重复项模板（注`type="text/html"`）

```
<script type="text/html" id="userItemTemplate">
    <h1><%= username %></h1><img src='<%= profileImg %>' />
</script> 
```

并通过循环将每个项目放入模板中

```
var uIT = $("#userItemTemplate").html();
_.each(list.partners,function(user){
    $("#target").append(_.template(uIT,user));        
}); 
```

**或者**

将循环放入您的模板

```
<script type="text/html" id="userTemplate">
    <% _.each(partners,function(user,key,list){ %>
    <h1><%= user.username %></h1><img src='<%= user.profileImg %>' />
    <% }); %>
</script> 
```

然后将整个数组推入

```
var uT = $("#userTemplate").html();
$("#target2").html(_.template(uT,list)); 
```

请注意，我使用的是 lodash 而不是下划线。它在很大程度上是兼容的，但我更喜欢 lodash，因为基准测试更快并且库维护得很好。

# google-app-engine - 生产服务器上的搜索 api 的 per_document 一致性如何？

> ID：15141606
> 
> 赞同：1
> 
> 时间：2013-02-28T17:13:56.483
> 
> 标签：google-app-engine

我们正在将我们的应用程序从**Amazon+ElasticSearch**移植到**GAE+FTS。**

在编写测试时，我习惯于处理**Lucene 索引的最终一致性。**

在本地开发服务器上，似乎所有文档索引都是完全一致的。我创建、更新或删除文档并立即搜索它并始终获得正确的结果。HRD 本地行为正确（如果配置为）模拟生产环境的最终行为。

从**FTS 引擎**的本地行为，我可以假设生产环境吗？我还不能尝试它，但是从全局一致选项的弃用来看，我将假设生产中的最终一致性达到一定程度。

有人有一些指标或经验可以分享吗？

谢谢！

# html - HTML/CSS：100% 带有背景图片的容器 - 可点击的链接应该定位在图片上吗？

> ID：15141610
> 
> 赞同：2
> 
> 时间：2013-02-28T17:14:16.463
> 
> 标签：html, css, background-image

我只是希望有任何创造性的解决方案来解决以下问题：

我有一个`#containter`应用了背景图像

```
#container {
   height:400px;
   width:100%;
   background-image: url(http://cl.ly/NEvg/kv.jpg);
   background-repeat:no-repeat;
   background-size: 1000px;
   background-position:center 0px;
} 
```

我拥有的图像中有一个区域，我想在其中放置一个可点击的链接。

![在此处输入图像描述](../Images/a4ec092213da6909bd226d418a59c7df.png)

在此示例图像中，我想`a#square`在绿色正方形顶部放置一个不可见的位置，以便当我仅单击该正方形时触发链接。

但是问题是缩放浏览器窗口时背景图像正在移动（我希望它移动，所以这不是问题本身），但链接不是。

看到这个活的例子：http: **[//jsfiddle.net/KDag7/](http://jsfiddle.net/KDag7/)**

有没有创意的 CSS 方式让链接随着图片中的正方形移动？

感谢您的提示和技巧。

问候， 马特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T17:26:48.580

使用您问题中的图像示例（防火墙阻止了 jsFiddle 中的图像），如果我了解您要查找的内容，则可以使用此 css：

```
 position:absolute;
 top:158px;
 left:50%;
 margin-left:64.5px; 
```

看到这个jsFiddle：http: [//jsfiddle.net/KDag7/21/](http://jsfiddle.net/KDag7/21/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T17:27:58.910

这是一个更新[小提琴](http://jsfiddle.net/KDag7/19/)。我添加`position:relative;`到主图像和`position:absolute;`链接中，使其与其父级对齐。链接的定位可以通过以下方式实现：

```
position:absolute;
top:153px;
left:50%;
margin-left:63px; 
```

# php - 将 &ct_= 替换为 %2c 或逗号

> ID：15141613
> 
> 赞同：0
> 
> 时间：2013-02-28T17:14:23.400
> 
> 标签：php, wordpress, function, mod-rewrite, urlencode

我一直在努力解决这个功能，我希望我有足够的尊重来提供赏金。帮助将不胜感激。

```
// Advanced Search Check
function ct_search_form_check($name, $taxonomy_name = null) {
global $search_values;

    if (!$taxonomy_name) {
        $taxonomy_name = $name;
    } ?>
    <?php foreach( get_terms($taxonomy_name, 'hide_empty=0') as $t) : ?>
        <?php if ($search_values[$name] == $t->slug) { $selected = 'checked="checked"'; } else { $selected = ''; } ?>
            <div><input id="ct_<?php echo $name; ?>" name="ct_<?php echo $name; ?>" type="checkbox" style="margin-right:5px; margin-left:5px" <?php echo $selected; ?>value="<?php echo $t->slug; ?>"><?php echo $t->name; ?><span style="margin-left:10px"></span></input></div>

           //recently added this part to replace duplicate taxonomy_name in url
           <?php $data = array();
                while (list($name, $t->slug) = each($arr)) {
                   $data[] = "$name";
                }
                echo implode($data); ?>

    <?php endforeach; ?>

<?php
} 
```

如何更改我的输出

> ?ct_zipcode=&ct_event_type=校友&ct_=anneverisy&​​ct_setting=ballroom&ct_=酒吧&场地搜索=true

至

> ?ct_zipcode=&ct_event_type=alumni%2canneverisy&​​ct_setting=ballroom%2cbar&Venue-search=true

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-03T06:26:08.047

这行得通。希望它会帮助别人

```
function ct_search_form_check($name, $taxonomy_name = null) {
global $search_values;

    if (!$taxonomy_name) {
        $taxonomy_name = $name;
    } ?>

<input type="hidden" value=""  name="ct_<?php echo $name; ?>" />
    <?php foreach( get_terms($taxonomy_name, 'hide_empty=0') as $t) : ?>
        <?php if ($search_values[$name] == $t->slug) { $selected = 'checked="checked"'; } else { $selected = ''; } ?>
            <div><input id="ct_<?php echo $name; ?>" name="ct_<?php echo $name; ?>" type="checkbox" style="margin-right:5px; margin-left:5px" <?php echo $selected; ?>value="<?php echo $t->slug; ?>"><?php echo $t->name; ?><span style="margin-left:10px"></span></input></div>
           <?php 
           $data = array();
                while (list($name, $t->slug) = each($arr)) {
                   $data[] = "$name";
                }
                echo implode($data); 
                if (!empty($_GET['ct_'])) { 
                    $url = str_replace('&ct_=', '%2c', $_SERVER['QUERY_STRING']);
                    header("Location: ?$url");
                } ?>
    <?php endforeach; ?>
<?php 
} 
```

# windows - 可能的符号链接攻击

> ID：15141616
> 
> 赞同：6
> 
> 时间：2013-02-28T17:14:32.007
> 
> 标签：windows, windows-7, pear

每次我想升级或安装 PEAR 包时，都会收到以下一系列错误消息：

> C:>pear upgrade
> 从 pear.php.net 获取频道信息时出错：安全错误：不会写入 C:\Users\ALVARO.GONZALEZ\AppData\Local\Temp\pear\cache\6d1f6e892384ae452db9a1bd59ee95f5rest.cacheid，因为它符号链接到C:\Users\ALVARO.GONZALEZ\AppData\Local\Temp\pear\cache\6d1f6e892384ae452db9a1bd59ee95f5rest.cacheid - 可能的符号链接攻击
> [...]

它在说什么符号链接？当我复制并粘贴两条路径并将它们并排放置时，老实说，我看不出区别：

```
C:\Users\ALVARO.GONZALEZ\AppData\Local\Temp\pear\cache\6d1f6e892384ae452db9a1bd59ee95f5rest.cacheid
C:\Users\ALVARO.GONZALEZ\AppData\Local\Temp\pear\cache\6d1f6e892384ae452db9a1bd59ee95f5rest.cacheid 
```

当我清空缓存目录时，错误消失了：

```
C:\>pear clear-cache
reading directory C:\Users\ALVARO.GONZALEZ\AppData\Local\Temp\pear\cache
74 cache entries cleared 
```

...直到下一次我需要安装东西。

我的问题是：

1.  为什么会触发这些错误？
2.  有什么方法可以防止他们一开始就出现吗？

**编辑：**在 2011 年底有一张关于此文件的[公开票。该问题是由](https://pear.php.net/bugs/bug.php?id=18834)[PEAR install 中的 Symlink 攻击](https://pear.php.net/bugs/bug.php?id=18056)的安全修复引起的。我会报告任何结果。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-07-22T09:38:05.873

问题是 PEAR 错误：

*   [错误 #18056 Windows 上的回归](https://pear.php.net/bugs/bug.php?id=18834)

该错误已在2014 年 7 月 12 日发布的[PEAR 1.9.5中修复。](https://pear.php.net/package/PEAR/download/1.9.5)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-01-15T22:04:40.727

删除用户目录 C:\Users\ALVARO.GONZALEZ\AppData\Local\Temp\pear\cache\ 中 pear\cache 目录的全部内容

然后你应该能够进行梨安装

# emacs - Emacs slime mini 缓冲区接管

> ID：15141617
> 
> 赞同：3
> 
> 时间：2013-02-28T17:14:35.173
> 
> 标签：emacs, buffer, slime

没有明显的原因在 Emacs 中启动 slime 会在迷你缓冲区中产生以下消息：

> 轮询“/tmp/slime.5000 .. 25（使用 `Mx slime-abort-connection' 中止。）[730 次]

那 [730 次] 不断增长。据说，这意味着史莱姆无法启动，但不，它工作正常。

这是我的消息缓冲区，从粘液初始化开始：

> ../../quicklisp/dists/quicklisp/software/slime-20130217-cvs/contrib/slime-package-fu.el: `flet' is an obsolete macro (as of 24.3); use either`cl-flet' 或 `cl-letf'. [4 times] Starting Emacs daemon. When done with this frame, type C-x 5 0 Polling "/tmp/slime.5080" .. 1 (Abort with`Mx slime-abort-connection'.) 轮询"/tmp/slime .5080" .. 2 (Abort with `M-x slime-abort-connection'.) Polling "/tmp/slime.5080" .. 3 (Abort with`Mx slime-abort-connection'.) Polling "/tmp/slime.5080" .. 4 (Abort with `M-x slime-abort-connection'.) Polling "/tmp/slime.5080" .. 5 (Abort with`Mx slime-abort-connection'.) Polling "/tmp/slime.5080 " .. 6 (使用`M-x slime-abort-connection'.) Polling "/tmp/slime.5080" .. 7 (Abort with`Mx slime-abort-connection' 中止。) 轮询 "/tmp/slime.5080" .. 8 (使用 `M-x slime-abort-connection'.) Polling "/tmp/slime.5080" .. 9 (Abort with`Mx slime-abort-connection' 中止。) 轮询 "/tmp/slime.5080" 。 . 10 (Abort with `M-x slime-abort-connection'.) Polling "/tmp/slime.5080" .. 11 (Abort with`Mx slime-abort-connection'.) 轮询 "/tmp/slime.5080" .. 12 (Abort with `M-x slime-abort-connection'.) Polling "/tmp/slime.5080" .. 13 (Abort with`Mx slime-abort-connection'.) 轮询 "/tmp/slime.5080" .. 14（使用`M-x slime-abort-connection'.) Polling "/tmp/slime.5080" .. 15 (Abort with`Mx slime-abort-connection 中止。）轮询“/tmp/slime.5080”.. 16（使用中止`M-x slime-abort-connection'.) Polling "/tmp/slime.5080" .. 17 (Abort with`Mx slime-abort-connection'.) Polling "/tmp/slime.5080" .. 18 (Abort with `M-x slime-abort-connection'.) Polling "/tmp/slime.5080" .. 19 (Abort with`Mx slime-abort-connection'.) Polling "/tmp/slime.5080" .. 20 (Abort with `M-x slime-abort-connection'.) Polling "/tmp/slime.5080" .. 21 (Abort with`Mx slime -abort-connection'.) Polling "/tmp/slime.5080" .. 22 (Abort with `M-x slime-abort-connection'.) Polling "/tmp/slime.5080" .. 23 (Abort with`Mx slime-abort-connection'.) Polling "/tmp/slime.5080" .. 24 (Abort with `M-x slime-abort-connection'.) Polling "/tmp/slime.5080" .. 25 (Abort with`Mx slime-abort -connection'.) 在端口 39808 上连接到 Swank.. 轮询“/tmp/slime.5080”.. 25（使用`M-x slime-abort-connection'.) [2 times] Source file` /home/lawrence/.emacs.d/elpa/clojure-mode-1.11.5/clojure-中止） mode.el' 比字节编译文件更新 已连接。让黑客开始！轮询“/tmp/slime.5080”.. 25（使用`M-x slime-abort-connection'.) [297 times] Mark set Polling "/tmp/slime.5080" .. 25 (Abort with`Mx slime-abort-connection 中止'。）[207 次] 标记保存在搜索开始的位置轮询”/tmp/slime.5080" .. 25（中止`M-x slime-abort-connection'.) [58 times] Cancelled connection attempt. Polling "/tmp/slime.5080" .. 25 (Abort with`Mx slime-abort-connection'。）[1159 次] 字节码：缓冲区轮询“/tmp/slime.5080”.. 25 （使用`M-x slime-abort-connection'.) [2 times] byte-code: Beginning of buffer [2 times] Polling "/tmp/slime.5080" .. 25 (Abort with`Mx slime-abort-connection 中止。）[2 次] 字节-代码：缓冲区轮询开始“/tmp/slime.5080”.. 25（使用`M-x slime-abort-connection'.) byte-code: Beginning of buffer Polling "/tmp/slime.5080" .. 25 (Abort with`Mx slime-abort-connection 中止。）[202 次]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-29T15:50:10.080

清理你的 .cache/common-lisp/

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-19T02:53:57.247

The infinite polling may be due to the missing of file `swank-loader.lisp`. Check the variable `slime-backend` to see whether it contains the right path to `swank-loader.lisp`.

On my computer I don't even have a `swank-loader.lisp` file(I noticed that if you install the *slime* using elpa, this may happen). So I downloaded the entire *slime* from [here](http://common-lisp.net/project/slime/#downloading) and got it right.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-08T01:55:08.377

对我来说，问题是我的 .emacs.d/ 文件夹中没有 /tmp 文件夹。添加 /tmp 文件夹解决了问题

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-05T10:44:56.757

安装emacs 24.3后，我也有同样的问题，你可以这样

```
cd /path/slime/contrib
find ./ -name '*.elc' | xargs rm -f 
```

然后，重启你的emacs

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-08-24T14:20:24.083

我的 Emacs + Slime + CCL/SBCL/CLISP/ECL 也出现了同样的错误，我有一个解决方案，在我的系统上，没问题！你可以试试。

错误的原因可能是 slime 和 swank 的版本不匹配。所以解决方案是使用相同版本的 slime 和 swank。

我的系统是 Raspbian（一种 debian）。我使用命令“apt-get install slime”安装了slime，然后slime和emacs会自动安装到路径“/usr/share/common-lisp/source/slime/”。但我认为该版本不是最新的。

解决方法： 1、获取最新的 slime 到你的 home 路径： 命令：

cd ~/ sudo git clone [https://github.com/slime/slime](https://github.com/slime/slime) slime cd slime make

2、在~/.emacs中添加tmp path和load-path：

(setq 临时文件目录 "/tmp") (add-to-list 'load-path "/home/pi/slime/")

3、将/usr/share/common-lisp/source/slime/重命名为/usr/share/common-lisp/source/slime-back/命令：

sudo mv /usr/share/common-lisp/source/slime/ /usr/share/common-lisp/source/slime-back/

4、使用最新的slime创建符号链接命令：

sudo ln -s /home/pi/slime //usr/share/common-lisp/source/slime

5、删除缓存和临时文件命令：

sudo mv ~/.cache/common-lisp ~/.cache/common-lisp-back

OK，现在你可以尝试启动emacs和slime了。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-03-14T19:02:03.063

对于 Debian 10 上的我来说，安装`cl-swank`软件包解决了这个问题。

```
This package contains the Lisp-side server, needed by the Emacs client (see package slime). 
```

（我`slime`的也来自 Debian 存储库。）

# php - html_entity_decode 到纯文本或不是 utf（省略号到 ... 等）

> ID：15141620
> 
> 赞同：0
> 
> 时间：2013-02-28T17:14:40.317
> 
> 标签：php, html-entities

试图弄清楚这个解码。我想以最通用的文本结束。省略 '...' 单引号或双引号的花式引号，常规旧的 '-' 而不是 emdash。除了 str_replace 之外，还有其他方法可以使用花式与常规字符串的表吗？

```
$str = 'Hey,&#8230;I came back&#8230;.ummm,&#8230;OK,&#8230;cool';

echo htmlspecialchars_decode($str, ENT_QUOTES) ;
// Hey,&#8230;I came back&#8230;.ummm,&#8230;OK,&#8230;cool

echo html_entity_decode($str, ENT_QUOTES, 'ISO-8859-15')  ;
// Hey,&#8230;I came back&#8230;.ummm,&#8230;OK,&#8230;cool

echo html_entity_decode($str, ENT_QUOTES, 'UTF-8')  ;
//this works, but changes to the elipse character 
// Hey,…I came back….ummm,…OK,…cool

echo str_replace("&#8230;", "...", $str)  ;
//Hey,...I came back....ummm,...OK,...cool
//desired result 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T17:42:09.280

我不确定你的规格，但我觉得你想要这样的东西：

```
$str = 'Hey,&#8230;I came back&#8230;.ummm,&#8230;OK,&#8230;cool';
echo iconv('UTF-8', 'ASCII//TRANSLIT', html_entity_decode($str, ENT_QUOTES, 'UTF-8')); 
```

这基本上使任何 Unicode 字符都适合 7 位 ASCII。可能会出现意想不到的结果。

**更新：**意外结果示例：

```
$str = '&Aacute;lvaro Espa&ntilde;a €&amp;pound;&yen;&cent;&copy;&reg;';
echo iconv('UTF-8', 'ASCII//TRANSLIT', html_entity_decode($str, ENT_QUOTES, 'UTF-8'));
# 'Alvaro Espa~na EURlbyenc(c)(R)

$str = 'Test: &#xb89;&#xba4;&#xbbe;&#xbb0;&#xba3;';
echo iconv('UTF-8', 'ASCII//TRANSLIT', html_entity_decode($str, ENT_QUOTES, 'UTF-8'));
# Notice: iconv(): Detected an illegal character in input string

$str = 'Test: &#xb89;&#xba4;&#xbbe;&#xbb0;&#xba3; End Test';
echo iconv('UTF-8', 'ASCII//TRANSLIT//IGNORE', html_entity_decode($str, ENT_QUOTES, 'UTF-8'));
# Test:  End Test 
```

您应该注意，HTML 实体之类`&#8230;`的只是一个技巧，它允许浏览器显示不属于文档编码的字符。它们与数据库无关！如果您将它们放入数据库，可能是因为您的应用程序没有使用 UTF-8（UTF-8 允许表示*任何*字符），但用户无论如何都在输入这些字符，并且浏览器会尽力将它们放入文档中。最简单的修复方法是切换到 UTF-8，正如[UTF-8 一直到](https://stackoverflow.com/questions/279170/utf-8-all-the-way-through).

> Fb 不喜欢这些 字符，我认为也不喜欢省略号字符

HTML 实体是 HTML，而不是纯文本。如果 Facebook 需要纯文本，则 HTML 实体将按原样显示，而不是被解码。至于«...»，我真的怀疑 Facebook（使用 UTF-8）是否会特别对待它们。您可能以错误的编码发送它们。

# nhibernate - NHibernate 一对多生成插入和更新

> ID：15141628
> 
> 赞同：2
> 
> 时间：2013-02-28T17:15:09.357
> 
> 标签：nhibernate, one-to-many, insert-update

您好我有包含文档一对多映射的请求类。

请求类

```
public class Request
{
virtual public int Id
    {
        get;
        set;
    }
...
virtual public Iesi.Collections.Generic.ISet<Document> Documents
  {
       get;
       set;
  }
} 
```

文档类

```
public class Document
{
public virtual int Id
{
    get;
    set;
}

public virtual int ParentEntityId
{
    get;
    set;
}
} 
```

XML 映射如下所示：请求

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2"
    assembly="xxxx"
    namespace="xxxx.Domain">
<class name="Request" table="tbl_Req">
    <id name="Id" column="req_id">
    <generator class="native"></generator>
        </id>
    <set name="Documents" cascade="all-delete-orphan"  inverse="false">
        <key column="doc_parent_ent_id" not-null="true"/>
            <one-to-many class="xxxx.Domain.Document"/>
    </set>
</class>  
</hibernate-mapping> 
```

文档看起来像这样：

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2"
    assembly="xxxx"
    namespace="xxxx.Domain">
<class name="Document"  table="tbl_doc">
<id name="Id" column="doc_id">
    <generator class="native"></generator>
</id>
</class>
</hibernate-mapping> 
```

现在在此配置下，当我保存 NHibernate 创建的文档时

```
INSERT INTO tbl_doc (doc_digimage_code, doc_lnk_filename, doc_lnk_filepath, doc_timestamp, doc_author, doc_parent_ent_id) VALUES (@p0, @p1, @p2, @p3, @p4, @p5); select SCOPE_IDENTITY()',N'@p0 nvarchar(4000),@p1 nvarchar(4000),@p2 nvarchar(4000),@p3 datetime,@p4 int,@p5 int',@p0=N'1',@p1=NULL,@p2=NULL,@p3='2013-02-28 18:05:45',@p4=7353,@p5=174 
```

和

```
UPDATE tbl_doc SET doc_parent_ent_id = @p0 WHERE doc_id = @p1',N'@p0 int,@p1 int',@p0=174,@p1=32 
```

我不明白为什么 NHibernate 在其更新字段已经具有正确值时会生成 INSERT 和 UPDATE。

我还发现这篇文章[NHibernate insert generate updates for collection items](https://stackoverflow.com/questions/4285386/nhibernate-insert-generates-updates-for-collection-items) which isSuggested using inverse，但是当我将它添加到映射时，ParentEntityId 填充为 0。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T18:01:15.853

更改您的 Document 类以引用 Request 类而不是 ParentEntityId。

```
public class Document
{
  public virtual int Id
  {
    get;
    set;
  }

  public virtual Request ParentEntity
  {
    get;
    set;
  }
} 
```

`inverse = true`在您尝试插入新请求时不会发出额外更新语句的文档上设置。

```
 <set name="Documents" cascade="all-delete-orphan"  **inverse="true"**>
        <key column="doc_parent_ent_id" not-null="true"/>
            <one-to-many class="xxxx.Domain.Document"/>
    </set> 
```

但是指定`inverse = true`意味着 Document 对象应该自己处理关系，即，每当将新文档添加到请求文档列表时，请务必设置 ParentEntity 属性。

```
Request objRequest = new Request();    
objRequest.Documents = new Iesi.Collections.Generic.ISet<Document>() 
                            { 
                                 new Document() { Id = 1, ParentEntity = objRequest }  
                            }; 
```

默认`inverse=false`情况下，不需要设置 ParentEntity 属性，NHibernate 会自动检测关系。但它附带了额外的更新声明，我们试图在这里避免。

最后，在文档映射中包含多对一关系。

```
<?xml version="1.0" encoding="utf-8" ?>
<hibernate-mapping xmlns="urn:nhibernate-mapping-2.2"
    assembly="xxxx"
    namespace="xxxx.Domain">
<class name="Document"  table="tbl_doc">
<id name="Id" column="doc_id">
    <generator class="native"></generator>
</id>

**<many-to-one cascade="none" class="xxx.Request" name="ParentEntity">
  <column name="doc_parent_ent_id" not-null="true" />
</many-to-one>**

</class>
</hibernate-mapping> 
```

# python - 带有图标和文本的 Gtk.RadioToolButton？

> ID：15141632
> 
> 赞同：0
> 
> 时间：2013-02-28T17:15:20.647
> 
> 标签：python, gtk, radio-button, toggle, gnome

这是我的工具按钮代码（在工具栏中）：

```
self.mainWindow.mainBox.mainToolbar.overviewRadio = Gtk.RadioToolButton(stock_id=Gtk.STOCK_ABOUT)
self.mainWindow.mainBox.mainToolbar.overviewRadio.set_label("Overview")
# self.mainWindow.mainBox.mainToolbar.overviewRadio.show_label() (No such function)
self.mainWindow.mainBox.mainToolbar.overviewRadio.connect("clicked", self.on_overviewRadio_clicked) 
```

这是输出的屏幕截图：

![截图](../Images/2e9d475eaad447c55659e8c11e3d7cb9.png)

如您所见，没有标签 - 我如何设置要显示的标签？

这是我的代码，有兴趣的朋友可以看看：

```
#! /usr/bin/env python3

###    Copyright (c) 2013 - Marco Scannadinari

###    This program is free software: you can redistribute it and/or modify
###    it under the terms of the GNU General Public License as published by
###    the Free Software Foundation, either version 3 of the License, or
###    (at your option) any later version.
###
###    This program is distributed in the hope that it will be useful,
###    but WITHOUT ANY WARRANTY; without even the implied warranty of
###    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
###    GNU General Public License for more details.
###
###    You should have received a copy of the GNU General Public License
###    along with this program.  If not, see <http://www.gnu.org/licenses/>.

# gcustomiser - A visual customiser for the GNOME desktop using GTK+.

from gi.repository import Gtk
import sys

class gcustomiser:
    def __init__(self):
        ## Main window
        self.mainWindow = Gtk.Window(Gtk.WindowType.TOPLEVEL)
        self.mainWindow.set_size_request(512, -1)
        self.mainWindow.set_resizable(False)
        self.mainWindow.set_title("GNOME Customiser")
        self.mainWindow.connect("destroy", self.on_mainWindow_destroy)

        ## Main box
        self.mainWindow.mainBox = Gtk.VBox(
            homogeneous = False,
            spacing = 8)

        ## Toolbar
        self.mainWindow.mainBox.mainToolbar = Gtk.Toolbar()
        self.mainWindow.mainBox.mainToolbar.get_style_context().add_class(Gtk.STYLE_CLASS_PRIMARY_TOOLBAR)
        self.mainWindow.mainBox.mainToolbar.set_style(Gtk.ToolbarStyle.BOTH)

        ## Left toolbar separator
        self.mainWindow.mainBox.mainToolbar.leftSeparator = Gtk.SeparatorToolItem(draw = False)
        self.mainWindow.mainBox.mainToolbar.leftSeparator.set_expand(True)

        ## Overview toggle button
        self.mainWindow.mainBox.mainToolbar.overviewRadio = Gtk.RadioToolButton(Gtk.STOCK_ABOUT)
        self.mainWindow.mainBox.mainToolbar.overviewRadio.set_is_important(True)
        self.mainWindow.mainBox.mainToolbar.overviewRadio.set_label("Overview")
        self.mainWindow.mainBox.mainToolbar.overviewRadio.connect("clicked", self.on_overviewRadio_clicked)

        ## Basic settings toggle button
        self.mainWindow.mainBox.mainToolbar.basicRadio = Gtk.RadioToolButton(label = "Overview")
        self.mainWindow.mainBox.mainToolbar.basicRadio.set_label("Overview")
        a = self.mainWindow.mainBox.mainToolbar.basicRadio.get_label()
        print(a)
        ## Right toolbar separator
        self.mainWindow.mainBox.mainToolbar.rightSeparator = Gtk.SeparatorToolItem(
            draw = False)
        self.mainWindow.mainBox.mainToolbar.rightSeparator.set_expand(True)

        ## Add everything to self.mainWindow
        self.mainWindow.add(self.mainWindow.mainBox)

        self.mainWindow.mainBox.pack_start(
            self.mainWindow.mainBox.mainToolbar,
            expand = False,
            fill = True,
            padding = 0)

        self.mainWindow.mainBox.mainToolbar.add(self.mainWindow.mainBox.mainToolbar.leftSeparator)
        self.mainWindow.mainBox.mainToolbar.add(self.mainWindow.mainBox.mainToolbar.overviewRadio)
        self.mainWindow.mainBox.mainToolbar.add(self.mainWindow.mainBox.mainToolbar.rightSeparator)

    def on_mainWindow_destroy(self, *args):
        print("destroy: mainWindow")
        print("\nGoodbye.\n")

        Gtk.main_quit()

        sys.exit()

    def on_overviewRadio_clicked(self, *args):
        print("clicked: mainWindow.mainBox.mainToolbar.overviewRadio")

    def show_all(self):
        self.mainWindow.show_all()

window = gcustomiser()
window.show_all()

Gtk.main() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T01:33:28.813

您可以使用：

```
self.mainWindow.mainBox.mainToolbar.overviewRadio.show_all() 
```

虽然，您可能需要考虑：

```
self.mainWindow.show_all() 
```

这将显示 mainWindow() 中的每个小部件。通常在您定义了主 UI 并希望使所有小部件可见之后使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T20:05:07.517

我建议您使用**Glade**界面编辑器并以非常简单的方式完成您想做的事情。**ToolButton**的标签是一个默认可见的属性，只要**小部件**具有标签标签就意味着它必须在图标下方显示文本，即使那样我们也不应该进一步说明**show_label**，**show_label** not function defined for `gtk.RadioToolButton`。此外，我建议您检查这些您离开这里的链接，您可能会有用

> [http://valadoc.org/gtk+-3.0/Gtk.RadioToolButton.html.content.tpl%20](http://valadoc.org/gtk+-3.0/Gtk.RadioToolButton.html.content.tpl%20) [http://nullege.com/codes/search/gtk.RadioToolButton.set_label](http://nullege.com/codes/search/gtk.RadioToolButton.set_label) [http://pascal.rigaud4.free。 fr/Programmation/GTK/GTKMMDoc/GTKMM/www.gtkmm.org/docs/gtkmm-2.4/docs/reference/html/classGtk_1_1RadioToolButton.html](http://pascal.rigaud4.free.fr/Programmation/GTK/GTKMMDoc/GTKMM/www.gtkmm.org/docs/gtkmm-2.4/docs/reference/html/classGtk_1_1RadioToolButton.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T16:50:23.020

问题是**我没有设置工具栏样式**。为此，我应该使用：

```
self.mainWindow.mainBox.mainToolbar.set_style(Gtk.ToolbarStyle.*) 
```

如果我希望标签显示在图标的一侧，而不是在其下方，我需要使单选按钮变得重要：

```
self.mainWindow.mainBox.mainToolbar.set_style(Gtk.ToolbarStyle.BOTH_HORIZ)
self.mainWindow.mainBox.mainToolbar.overviewRadio.set_is_important(True) 
```

对于`Gtk.ToolbarStyle`s 的列表，`dir(Gtk.ToolbarStyle)`请在 Python 解释器中使用，或转到[此页面](http://www.pygtk.org/docs/pygtk/gtk-constants.html#gtk-toolbar-style-constants "样式常量")。

# zend-framework2 - zf2&zfc2 和路由

> ID：15141635
> 
> 赞同：0
> 
> 时间：2013-02-28T17:15:31.957
> 
> 标签：zend-framework2

我想使用 ZfcAdmin 模块创建管理面板。我想创建路由，管理用户。就这个：

```
<?php
    return array(
        'controllers' => array(
            'invokables' => array(
                'AdminUser\Controller\AdminUser' => 'AdminUser\Controller\AdminUserController',
            ),
        ),
        'view_manager' => array(
            'template_path_stack' => array(
                'admin-user' => __DIR__ . '/../view',
            ),
        ),

        'router' => array(
            'routes' => array(
                'zfcadmin' => array(
                    'may_terminate' => true,
                    'child_routes' => array(
                        'user' => array(
                            'type' => 'segment',
                            'options' => array(
                                'route' => '/user',
                                'defaults' => array(
                                    'controller' => 'AdminUser\Controller\AdminUser',
                                    'action'     => 'index',
                                ),
                            ),
                            'may_terminate' => true,
                            'child_routes' =>array(
                                'edit' => array(
                                    'type' => 'segment',
                                    'options' => array(
                                        'route' => '/edit/:user_id',
                                        'defaults' => array(
                                            'controller' => 'AdminUser\Controller\AdminUser',
                                            'action'     => 'edit',
                                        ),
                                    ),
                                ),
                            ),
                        ),
                    ),
                ),
            ),
        ),
    ); 
```

我基于来自 zfcadmin github 页面的信息：[https](https://github.com/ZF-Commons/ZfcAdmin) ://github.com/ZF-Commons/ZfcAdmin 。我只是复制并粘贴示例，然后更改以解决我的需求。但是，我收到一条错误消息：“致命错误：未捕获的异常 'Zend\Mvc\Router\Exception\RuntimeException' 并带有消息'部分路由可能不会终止'”

怎么了？

编辑： 我请求：`/admin/user`没关系，但是当我想接收 URL 时：`/admin/user/edit/1`我总是`/admin/user`这样创建链接：

`<?php $this->url('zfcadmin/user/edit', array( 'action' => 'edit', 'user_id' => $user['user_id'], )) ?>`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-26T05:02:06.837

您创建的 URL 不正确。请创建这样的链接。

```
<?php $this->url('zfcadmin/user/edit', array( 'user_id' => $user['user_id'], ) ?> 
```

# python - Python：将帮助结果保存到变量中

> ID：15141636
> 
> 赞同：1
> 
> 时间：2013-02-28T17:15:33.253
> 
> 标签：python, nltk

使用 python 和 NLTK 我想将帮助结果保存到一个变量中。

```
x = nltk.help.upenn_tagset('RB') 
```

例如。

**x**变量被赋值为 None。控制台会打印帮助函数的结果，但不会将其保存到 var x。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T17:21:17.073

查看[help.py](https://github.com/nltk/nltk/blob/master/nltk/help.py)的源文件，它使用该`print`语句并且不返回任何内容。`upenn_tagset`调用`_format_tagset`，将所有内容传递给`_print_entries`使用`print`.

所以，我们真正想做的是重定向打印语句。

快速搜索，我们有[https://stackoverflow.com/a/4110906/1210278](https://stackoverflow.com/a/4110906/1210278) - replace `sys.stdout`。

正如@mgilson 链接的问题中所指出的，这是对临时问题的永久解决方案。那么我们该怎么办？这应该很容易 - 只需将原件保存在某个地方即可。

```
import sys
print "Hello"
cons_out = sys.stdout
sys.stdout = (other writable handle you can get result of)

do_printing_function()

sys.stdout = cons_out
print "World!" 
```

这实际上正是[https://stackoverflow.com/a/6796752/1210278](https://stackoverflow.com/a/6796752/1210278)上公认的答案所做的，除了它使用可重用的类包装器 - 这是一个一次性的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2022-01-20T20:10:35.770

获得标签解释输出的最简单方法是加载整个标签集，然后仅提取所需标签的解释。

```
tags = nltk.data.load('help/tagsets/upenn_tagset.pickle')

tags['RB'] 
```

# html - 如何使用伪类：active :visited :hover 使用背景图像设置 div 的样式？

> ID：15141639
> 
> 赞同：0
> 
> 时间：2013-02-28T17:15:48.610
> 
> 标签：html, css, background-image, pseudo-class

我有 4 个 div 并希望像这样设置它们的样式：

[http://jsfiddle.net/AcvbG](http://jsfiddle.net/AcvbG)

HTML：

```
<a href="http://test" id="topleftbox"></a> 
```

CSS：

```
#topleftbox {
  background: red;
  background-repeat: no-repeat;
  width: 229px;
  height: 228px;
  float: left;
  }

 #topleftbox:hover {
  background: blue;
  }

 #topleftbox:active {
  background: green;
  }

 #topleftbox:visited {
  background: yellow;
  } 
```

但是用背景图像替换颜色。:hover 有效，但 :visited 和 :actived 没有生效。

有人知道解决方案吗？我对javascript的了解有限，所以我希望有办法解决这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T17:22:55.570

由于 href="http://test"，您的 :visited 和 :actived 伪类在 jsFiddle 中不可见。因此，您需要访问页面测试以查看 :visited in action .. 并且您需要在测试页面上查看 :active 实际操作。

在这里我为你[做了一个小提琴](http://jsfiddle.net/AcvbG/3/)

您可以看到 .css 的不同之处

```
.topleftbox:hover {
    background: blue;
}
.topleftbox:visited {
    background: yellow;
}
.topleftbox:visited:hover {
    background: pink;
}
.topleftbox:active {
    background: green;
} 
```

此外，您应该在定义样式时检查 ORDER。

> a:link { color: red } /* 未访问的链接 */
> 
> a:visited { color: > blue } /* 访问过的链接 */
> 
> a:hover { color: yellow } /* 用户悬停 */
> 
> a:active { color:lime } /* 活动链接 */
> 
> 注意 A:hover 必须放在 A:link 和 A:visited 规则之后，否则级联规则将隐藏 A:hover 规则的 'color' 属性。同样，因为 A:active 放置在 A:hover 之后，所以当用户激活并将鼠标悬停在 A 元素上时，将应用活动颜色（石灰）。
> 
> 一个结合动态伪类的例子：
> 
> a:focus { 背景：黄色 } a:focus:hover { 背景：白色 }
> 
> 最后一个选择器匹配伪类 :focus 和伪类 :hover 中的 A 元素。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T17:41:30.160

在现代浏览器中，CSS 可以在不使用 javascript 的情况下处理您想要的内容。

[http://jsfiddle.net/CWkdY/10/](http://jsfiddle.net/CWkdY/10/)

需要注意的一件事是，您的标识符可以通过在您的 id 声明前添加“a”来识别您的 ID 是一个链接。您的初始定义也将受益于“显示：块”。像这样：

```
a#topleftbox {
  background: url('http://d241yswl6yg9sc.cloudfront.net/linen-texture2/top-new.jpg');
  width: 229px;
  height: 228px;
  float: left;
  display:block;
  } 
```

如果您发现您的图像最初没有显示，请尝试使用这个小技巧缓存您需要使用的所有图像。你有一个包含所有图像的 div，在侧面，但隐藏。

[http://perishablepress.com/css-image-caching/](http://perishablepress.com/css-image-caching/)

# shopify - 如何在 Shopify 中显示元字段

> ID：15141652
> 
> 赞同：2
> 
> 时间：2013-02-28T17:16:17.077
> 
> 标签：shopify, variant

我们有一组产品希望免费送货。为此，我将它们的重量设为 0，并为 0 磅创建了基于重量的运输。

这样，运输通过购物车。但是...我想在产品页面上显示实际重量。

我为运输重量创建了一个元字段，我试图将该值调用到产品页面，但没有任何运气......

这是我正在尝试的代码....

```
//------SHIPPING WEIGHT-------------------------//

{% if product.vendor == 'American Chains' %}

 $('.wt').text((variant.ShippingWeight)+'lb'); 

// {{ variant.metafields.ShippingWeight.shipping_weight }}

{% else %}

$('.wt').text(parseInt(variant.weight * 0.0022046, 10) + 'lb');

{% endif %}

//------SHIPPING WEIGHT-------------------------// 
```

感谢您对此提供任何帮助或指导。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-01T07:54:01.440

在[Product.liquid](http://wiki.shopify.com/Product.liquid)中，您只能访问产品。如果您想访问特定的产品变体，您必须遍历产品变体。在循环中，您可以访问变体的[元字段](http://api.shopify.com/metafield.html)。

```
{% for variant in product.variants %}
  // to display the variant metafields use {{resource.metafields.namespace.key}}
  {{ variant.metafields.ShippingWeight.shipping_weight }}
{% endfor %} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-12-04T07:29:17.457

[http://docs.shopify.com/themes/liquid-documentation/objects/metafield](http://docs.shopify.com/themes/liquid-documentation/objects/metafield) 用这个链接简单地扔掉......

```
{% for field in product.metafields.instructions %}
{{ field | first }}: {{ field | last }}
{% endfor %} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-05-31T06:14:13.700

> 1.  元字段是通过使用（元字段或 shopify FD）shopify 应用程序为产品编辑页面创建的
>     
>     
> 2.  然后在表单字段中输入以下值（命名空间、键、值）
>     
>     
> 3.  输入值后，您可以像下面的代码一样检索值..，

命名空间 = metafield_values，

键=颜色，

值=红色，

```
{% assign value = product.metafields.metafield_values%}

<p>{{ value.color }}</p> 
```

输出：红色

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-06-02T10:25:48.467

```
 ------------------------------
         {{metafields.namespace.key}}
        ------------------------------ 
```

命名空间 = prod_video，

{{ product.metafields.prod_video.prod_video }}

{{ collection.metafields.prod_video.prod_video }}

---------具有相同命名空间和不同键的元字段循环------------

```
<div class="prod_add_img">  
    {% for collection in product.collections %}
        {% for field in collection.metafields.additional_images %}
            <img src="{{ field | last | asset_url }}"> 
        {% endfor %}
    {% endfor %}
</div> 
```

# c# - Evernote AuthToken 通过 OAuth

> ID：15141655
> 
> 赞同：3
> 
> 时间：2013-02-28T17:16:30.730
> 
> 标签：c#, api, oauth, evernote

我以前使用过 OAuth（使用 Twitter 和 PHP），这很简单。我正在尝试让 OAuth 与 EverNote API 示例[https://github.com/evernote/evernote-sdk-csharp](https://github.com/evernote/evernote-sdk-csharp)一起使用（因为正如他们所说，“真正的应用程序使用 OAuth 通过 Evernote 进行身份验证”）。我看了这些：

[简单的 C# Evernote API OAuth 示例或指南？](https://stackoverflow.com/questions/3794245/simple-c-sharp-evernote-api-oauth-example-or-guide)

[https://github.com/sethhitch/csharp-oauth-sample](https://github.com/sethhitch/csharp-oauth-sample)

[http://blog.stevienova.com/2008/04/19/oauth-getting-started-with-oauth-in-c-net/](http://blog.stevienova.com/2008/04/19/oauth-getting-started-with-oauth-in-c-net/)

但是，我仍然不知道该怎么做......这是我的代码：

```
 // Real applications authenticate with Evernote using OAuth, but for the
    // purpose of exploring the API, you can get a developer token that allows
    // you to access your own Evernote account. To get a developer token, visit 
    // https://sandbox.evernote.com/api/DeveloperToken.action
    String authToken = "myAuthCode";

    if (authToken == "your developer token") {
      Console.WriteLine("Please fill in your developer token");
      Console.WriteLine("To get a developer token, visit https://sandbox.evernote.com/api/DeveloperToken.action");
      return;
    } 
```

如何将 OAuth 添加到此以获取我的`authToken`?

谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-28T18:17:39.367

检查这个示例项目：[http](http://discussion.evernote.com/topic/30584-here-is-a-net-oauth-assembly/) ://discussion.evernote.com/topic/30584-here-is-a-net-oauth-assembly/ 。我认为这将帮助您了解 oauth 的工作原理。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-09-28T17:38:27.283

对于任何试图让它在 MVC 中工作的人，我今天早上正在玩 Evernote、OpenAuth 和 C#，并设法让它全部工作。我已经整理了一篇博客文章/库，解释了经验并概述了如何使用 MVC 在这里 - [http://www.shaunmccarthy.com/evernote-oauth-csharp/](http://www.shaunmccarthy.com/evernote-oauth-csharp/) - 它使用 AsyncOAuth 库：[https://github .com/neuecc/AsyncOAuth](https://github.com/neuecc/AsyncOAuth)

我围绕 AsyncOAuth 编写了一个包装器，您可能会在这里发现它很有用：[https ://github.com/shaunmccarthy/AsyncOAuth.Evernote.Simple](https://github.com/shaunmccarthy/AsyncOAuth.Evernote.Simple)

需要注意的一件棘手的事情 - Evernote 端点（/oauth 和 /OAuth.action）区分大小写

```
// Download the library from https://github.com/shaunmccarthy/AsyncOAuth.Evernote.Simple

// Configure the Authorizer with the URL of the Evernote service,
// your key, and your secret. 
var EvernoteAuthorizer = new EvernoteAuthorizer(
    "https://sandbox.evernote.com", 
    "slyrp-1234", // Not my real id / secret :)
    "7acafe123456badb123");

// First of all, get a request token from Evernote - this causes a 
// webrequest from your server to Evernote.
// The callBackUrl is the URL you want the user to return to once
// they validate the app
var requestToken = EvernoteAuthorizer.GetRequestToken(callBackUrl);

// Persist this token, as we are going to redirect the user to 
// Evernote to Authorize this app
Session["RequestToken"] = requestToken;

// Generate the Evernote URL that we will redirect the user to in
// order to 
var callForwardUrl = EvernoteAuthorizer.BuildAuthorizeUrl(requestToken);

// Redirect the user (e.g. MVC)
return Redirect(callForwardUrl);

// ... Once the user authroizes the app, they get redirected to callBackUrl

// where we parse the request parameter oauth_validator and finally get
// our credentials
// null = they didn't authorize us
var credentials = EvernoteAuthorizer.ParseAccessToken(
    Request.QueryString["oauth_verifier"], 
    Session["RequestToken"] as RequestToken);

// Example of how to use the credential with Evernote SDK
var noteStoreUrl = EvernoteCredentials.NotebookUrl;
var noteStoreTransport = new THttpClient(new Uri(noteStoreUrl));
var noteStoreProtocol = new TBinaryProtocol(noteStoreTransport);
var noteStore = new NoteStore.Client(noteStoreProtocol);
List<Notebook> notebooks = client.listNotebooks(EvernoteCredentials.AuthToken); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-01T03:33:04.237

您还可以尝试在此处找到的 OAuth 库：[https](https://code.google.com/p/devdefined-tools/wiki/OAuth) ://code.google.com/p/devdefined-tools/wiki/OAuth并按照[此处](http://dev.evernote.com/start/core/authentication.php)提到的步骤进行操作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-28T19:12:58.183

要添加的简单代码是：

```
EvernoteOAuth oauth = new EvernoteOAuth(EvernoteOAuth.HostService.Sandbox, myConsumerKey, myConsumerSecret);
        string errResponse = oauth.Authorize();
        if (errResponse.Length == 0)
        {
            Console.WriteLine(string.Format("Token: {0}\r\n\r\nExpires: {1}\r\n\r\nNoteStoreUrl: {2}\r\n\r\nUserId: {3}\r\n\r\nWebApiUrlPrefix: {4}", oauth.Token, oauth.Expires, oauth.NoteStoreUrl, oauth.UserId, oauth.WebApiUrlPrefix));
        }
        else
        {
            Console.WriteLine("A problem has occurred in attempting to authorize the use of your Evernote account: " + errResponse);
        } 
```

您将需要使用此程序集：

```
using EvernoteOAuthNet; 
```

可在此处获得：

[http://www32.zippyshare.com/v/98249023/file.html](http://www32.zippyshare.com/v/98249023/file.html)

# c# - 如何在 C# 中从类中访问类的属性

> ID：15141658
> 
> 赞同：4
> 
> 时间：2013-02-28T17:16:32.693
> 
> 标签：c#

我有这个类的这些属性，我想知道如何从类中访问它们。`ServedClassName`是一个自定义属性，这就是我实际尝试访问的属性。

```
[Guid("24889af6-e174-460b-ab52-7fb5a925926e")]
[ServedClassName("ASCOM ProxyClient Telescope")]
[ProgId("ASCOM.DeviceProxyClient.Telescope")]
[ClassInterface(ClassInterfaceType.None)]
public class Telescope : ReferenceCountedObjectBase, ITelescopeV3 
```

要访问 ProgID，我使用这个：`Marshal.GenerateProgIdForType(this.GetType());`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-28T17:18:38.057

```
object [] attrs = GetType().GetCustomAttributes(typeof(ServedClassNameAttribute), true); 
```

将为您提供类上 ServedClassNameAttribute 类型的自定义属性的列表。然后，您可以像这样遍历属性实例：

```
foreach (ServedClassNameAttribute attr in attrs)
{
    // Do something with attr
} 
```

# c# - 仅在当前线程中检查服务器/SSL 证书 (.NET)

> ID：15141659
> 
> 赞同：0
> 
> 时间：2013-02-28T17:16:33.857
> 
> 标签：c#, .net, httpwebrequest, ssl-certificate, webclient

我有一个连接到许多 URL 的多线程应用程序，并且只需要在某些线程上检查 SSL 证书。

我知道我可以使用`ServicePointManager.ServerCertificateValidationCallback`，但它可以在异步模式下同时跨所有线程工作。

我需要在连接到 URL 的函数的同步执行中的当前线程中进行检查。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T19:17:49.547

您可以像这样定义请求和证书函数之间的映射：

```
// delegate definition for cert checking function
private delegate bool CertFunc(X509Certificate certificate, X509Chain chain, SslPolicyErrors sslPolicyErrors);

// mapping between outbound requests and cert checking functions
private static readonly ConcurrentDictionary<HttpWebRequest, CertFunc> _certFuncMap = new ConcurrentDictionary<HttpWebRequest, CertFunc>();

// global cert callback
private static bool ServerCertificateValidationCallback(object sender, X509Certificate certificate, X509Chain chain, SslPolicyErrors sslPolicyErrors)
{
  // call back into the cert checking function that is associated with this request
  var httpWebRequest = (HttpWebRequest)sender;
  CertFunc certFunc = _certFuncMap[httpWebRequest];
  return certFunc(certificate, chain, sslPolicyErrors);
} 
```

然后在发出请求的代码中：

```
// register the global cert callback
ServicePointManager.ServerCertificateValidationCallback += ServerCertificateValidationCallback;

// create the request object
var httpWebRequest = (HttpWebRequest)WebRequest.Create(requestUri);

// cert checking function
CertFunc certFunc = (certificate, chain, sslPolicyErrors) =>
{
  // perform cert logic here
  return true;
};
_certFuncMap[httpWebRequest] = certFunc;

using (var webResponse = httpWebRequest.GetResponse())
{
  // process the response...
}

// clean up the mapping
_certFuncMap.TryRemove(httpWebRequest, out certFunc); 
```

# javascript - 将 Groovy DSL 移植到 Clojure

> ID：15141662
> 
> 赞同：2
> 
> 时间：2013-02-28T17:16:41.100
> 
> 标签：javascript, groovy, clojure, dsl, nashorn

我有几个用 FactoryBuilderSupport 制作的“builder”Groovy DSL（[SwingBuilder](http://groovy.codehaus.org/Swing+Builder)是典型的例子），主要是因为性能问题（也因为我担心 Groovy 的未来，例如 Groovy 3 会包含一个新的 MOP 吗？），我寻找基于 JVM 的内部 DSL 的替代框架。

由于 Clojure 有闭包和宏，它是一个值得的候选者，但我不知道使用 Clojure 操作动态绑定的 Java 对象有多么容易，比如在 Groovy 脚本中（顺便说一句，我熟悉 LISP 语言家族，但不熟悉 Clojure 的具体功能）。

另外，我猜如果我等待的时间足够长，Java 8 的 Nashorn 会添加 Javascript 作为另一个可能的候选者。

那么，与 Groovy 相比，Clojure（甚至可能是 JavaScript）在支持这种 DSL 方面有多好？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-11T16:00:53.880

Clojure 可能是用于创建 DSL 的最佳 JVM 语言，因为它具有宏。一些可能会启发您的示例（取自[https://stackoverflow.com/a/3968289/476116](https://stackoverflow.com/a/3968289/476116)）：

*   [激活](http://github.com/cgrand/enlive/)（HTML 模板）
*   [LazyTest](http://github.com/stuartsierra/lazytest)（单元测试）
*   [fnparse](http://github.com/joshua-choi/fnparse)（解析器生成器）
*   [Midje](http://github.com/marick/Midje)（测试和模拟）
*   [字节规范](http://github.com/rosejn/byte-spec)（二进制格式）
*   [Vijual](http://github.com/drcode/vijual)（图形布局）
*   [Trammel](http://github.com/fogus/trammel)（约束编程）
*   [Cascalog](http://github.com/nathanmarz/cascalog)（具有数据日志语法的 Hadoop）
*   [Incanter](http://github.com/liebke/incanter)（类 R 环境）
*   [沙条](http://github.com/brentonashworth/sandbar)（HTML 会话、表单、身份验证）
*   [ClojureQL](https://github.com/LauJensen/clojureql) (SQL)
*   [mini-kanren](http://github.com/jduey/mini-kanren)（嵌入式逻辑编程）
*   [Leiningen](http://github.com/technomancy/leiningen)（构建工具）
*   [sexpbot](http://github.com/Raynes/sexpbot)（带有插件拱的 IRC 机器人）

当然，[跷跷板](https://github.com/daveray/seesaw)是摇摆 DSL 的一个例子。

# svn - 是否可以在不更改我的工作副本的情况下撤消 SVN 提交？

> ID：15141664
> 
> 赞同：3
> 
> 时间：2013-02-28T17:16:49.693
> 
> 标签：svn

我不小心将文件签入到 SVN。

我想撤消这个。

我知道我可以`svn merge -r COMMITTED:PREV`。然后签入我的工作副本。

但现在我失去了在本地完成的工作。

有没有更好的办法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T20:04:29.160

查看另一个工作副本并在那里执行反向合并。或者将您的更改复制到其他地方，执行合并，然后将您的更改复制回来。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T21:31:04.693

如果你修改了工作副本，你可以（除了注明的食谱）

*   稍后在干净的 WC 中提交更改并反向合并
*   发现分支和合并：将修改后的 WC 保存为新分支，反向合并主干，将分支合并到主干
*   将更改保存到补丁 ( `svn diff`)，恢复原始 WC ( `svn revert`)，反向合并，应用补丁

# android - 为什么我的 runOnUiThread 不起作用

> ID：15141668
> 
> 赞同：0
> 
> 时间：2013-02-28T17:16:58.960
> 
> 标签：android, android-asynctask

为什么这在我的 aSyncTask 中不起作用？我的应用程序崩溃。我正在尝试从 mysql 表中更新我的列表

```
protected void onPostExecute(String result){
            // dismiss dialog
            pDialog.dismiss();      
            runOnUiThread(new Runnable(){
                public void run(){
                    // Add adapter to the list
                    MenuAdapter adapter = new MenuAdapter(Albums.this, itemList);
                    ListView list = (ListView)findViewById(R.id.list);
                    adapter.notifyDataSetChanged();
                    list.setAdapter(adapter);   
                    }
                });

        } 
```

* * *

日志猫：

```
02-28 18:21:09.013: E/AndroidRuntime(10600): FATAL EXCEPTION: main
02-28 18:21:09.013: E/AndroidRuntime(10600): java.lang.NullPointerException
02-28 18:21:09.013: E/AndroidRuntime(10600):    at com.example.whs.Albums$LoadAllItems.onPostExecute(Albums.java:149)
02-28 18:21:09.013: E/AndroidRuntime(10600):    at com.example.whs.Albums$LoadAllItems.onPostExecute(Albums.java:1)
02-28 18:21:09.013: E/AndroidRuntime(10600):    at android.os.AsyncTask.finish(AsyncTask.java:631)
02-28 18:21:09.013: E/AndroidRuntime(10600):    at android.os.AsyncTask.access$600(AsyncTask.java:177)
02-28 18:21:09.013: E/AndroidRuntime(10600):    at android.os.AsyncTask$InternalHandler.handleMessage(AsyncTask.java:644)
02-28 18:21:09.013: E/AndroidRuntime(10600):    at android.os.Handler.dispatchMessage(Handler.java:99)
02-28 18:21:09.013: E/AndroidRuntime(10600):    at android.os.Looper.loop(Looper.java:137)
02-28 18:21:09.013: E/AndroidRuntime(10600):    at android.app.ActivityThread.main(ActivityThread.java:4898)
02-28 18:21:09.013: E/AndroidRuntime(10600):    at java.lang.reflect.Method.invokeNative(Native Method)
02-28 18:21:09.013: E/AndroidRuntime(10600):    at java.lang.reflect.Method.invoke(Method.java:511)
02-28 18:21:09.013: E/AndroidRuntime(10600):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:1006)
02-28 18:21:09.013: E/AndroidRuntime(10600):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:773)
02-28 18:21:09.013: E/AndroidRuntime(10600):    at dalvik.system.NativeStart.main(Native Method) 
```

这是我从 mysql 表中创建 itemList 的地方。

```
items = json.getJSONArray(TAG_ITEMS);

                    // loop through the items
                    for (int i = 0; items.length() > i; i++){
                        // Get the item in variable c
                        JSONObject c = items.getJSONObject(i);

                        // Store in a variable
                        String id = c.getString(TAG_ID);
                        String name = c.getString(TAG_NAME);
                        String username = c.getString(TAG_USERNAME);
                        if(username == ""){
                            username = "onbekend";
                        }

                        // Create the HashMap
                        HashMap<String, String> map = new HashMap<String, String>();

                        // add it
                        map.put(TAG_ID, id);
                        map.put(TAG_USERNAME, username);
                        map.put(TAG_NAME, name);
                        map.put(THUMBNAIL, "updates");

                        // to arraylist
                        itemList.add(map);                      
                    } 
```

我应该为列表视图使用什么 ID，我有“@android:id/list”

编辑：这是使用 Albums.this.getListView() 后的最新日志；

```
02-28 18:35:10.718: E/AndroidRuntime(23103): FATAL EXCEPTION: main
02-28 18:35:10.718: E/AndroidRuntime(23103): java.lang.ArrayIndexOutOfBoundsException: length=2; index=2
02-28 18:35:10.718: E/AndroidRuntime(23103):    at com.example.whs.MenuAdapter.getView(MenuAdapter.java:58)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at android.widget.AbsListView.obtainView(AbsListView.java:2461)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at android.widget.ListView.makeAndAddView(ListView.java:1775)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at android.widget.ListView.fillDown(ListView.java:678)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at android.widget.ListView.fillFromTop(ListView.java:739)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at android.widget.ListView.layoutChildren(ListView.java:1628)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at android.widget.AbsListView.onLayout(AbsListView.java:2296)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at android.view.View.layout(View.java:14055)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at android.view.ViewGroup.layout(ViewGroup.java:4604)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at android.widget.LinearLayout.setChildFrame(LinearLayout.java:1655)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at android.widget.LinearLayout.layoutVertical(LinearLayout.java:1513)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at android.widget.LinearLayout.onLayout(LinearLayout.java:1426)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at android.view.View.layout(View.java:14055)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at android.view.ViewGroup.layout(ViewGroup.java:4604)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at android.widget.FrameLayout.onLayout(FrameLayout.java:448)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at android.view.View.layout(View.java:14055)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at android.view.ViewGroup.layout(ViewGroup.java:4604)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at android.widget.LinearLayout.setChildFrame(LinearLayout.java:1655)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at android.widget.LinearLayout.layoutVertical(LinearLayout.java:1513)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at android.widget.LinearLayout.onLayout(LinearLayout.java:1426)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at android.view.View.layout(View.java:14055)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at android.view.ViewGroup.layout(ViewGroup.java:4604)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at android.widget.LinearLayout.setChildFrame(LinearLayout.java:1655)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at android.widget.LinearLayout.layoutHorizontal(LinearLayout.java:1644)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at android.widget.LinearLayout.onLayout(LinearLayout.java:1428)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at android.view.View.layout(View.java:14055)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at android.view.ViewGroup.layout(ViewGroup.java:4604)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at android.widget.LinearLayout.setChildFrame(LinearLayout.java:1655)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at android.widget.LinearLayout.layoutVertical(LinearLayout.java:1513)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at android.widget.LinearLayout.onLayout(LinearLayout.java:1426)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at android.view.View.layout(View.java:14055)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at android.view.ViewGroup.layout(ViewGroup.java:4604)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at android.widget.FrameLayout.onLayout(FrameLayout.java:448)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at android.view.View.layout(View.java:14055)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at android.view.ViewGroup.layout(ViewGroup.java:4604)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at android.widget.FrameLayout.onLayout(FrameLayout.java:448)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at android.view.View.layout(View.java:14055)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at android.view.ViewGroup.layout(ViewGroup.java:4604)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at android.view.ViewRootImpl.performLayout(ViewRootImpl.java:2000)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at android.view.ViewRootImpl.performTraversals(ViewRootImpl.java:1821)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at android.view.ViewRootImpl.doTraversal(ViewRootImpl.java:1118)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at android.view.ViewRootImpl$TraversalRunnable.run(ViewRootImpl.java:4550)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at android.view.Choreographer$CallbackRecord.run(Choreographer.java:725)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at android.view.Choreographer.doCallbacks(Choreographer.java:555)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at android.view.Choreographer.doFrame(Choreographer.java:525)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at android.view.Choreographer$FrameDisplayEventReceiver.run(Choreographer.java:711)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at android.os.Handler.handleCallback(Handler.java:615)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at android.os.Handler.dispatchMessage(Handler.java:92)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at android.os.Looper.loop(Looper.java:137)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at android.app.ActivityThread.main(ActivityThread.java:4898)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at java.lang.reflect.Method.invokeNative(Native Method)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at java.lang.reflect.Method.invoke(Method.java:511)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:1006)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:773)
02-28 18:35:10.718: E/AndroidRuntime(23103):    at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-28T17:18:51.707

因为[onPostExecute](http://developer.android.com/reference/android/os/AsyncTask.html#onPostExecute%28Result%29)总是在 UI 线程上调用，所以不需要`runOnUiThread`在 onPostExecute 中访问或更新 UI 元素。将您的代码更改为：

```
protected void onPostExecute(String result){
            // dismiss dialog
            pDialog.dismiss();      

            // access or update UI here without runOnUiThread

        } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T17:29:50.623

> 我应该为列表视图使用什么 ID，我有“@android:id/list”

您需要使用`findViewById(android.R.id.list)`，因为它位于 Android 命名空间中，与`"@id/list"`您简单使用的常规 id 不同`findViewById(R.id.list)`。

* * *

**加法** 这个新错误可能在您的 MenuAdapter 的`getCount()`方法中，但我知道它崩溃了`getView()`……我怎么知道？让我们来看看 LogCat：

```
java.lang.ArrayIndexOutOfBoundsException: length=2; index=2
    at com.example.whs.MenuAdapter.getView(MenuAdapter.java:58)
    at android.widget.AbsListView.obtainView(AbsListView.java:2461)
    at android.widget.ListView.makeAndAddView(ListView.java:1775) 
```

上面的行是例外，您正在尝试读取数组中不存在的值。下一行显示您的代码运行的最后一个位置以及引发错误的位置。 `MenuAdapter.java:58`是文件名和行号，另外它也会告诉你方法名：`getView()`. 典型适配器中使用的唯一数组是您传递给构造函数的数组...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T17:20:34.347

不是`runOnUiThread()`多余的吗？ `onPostExecute()`已经在 UI 线程上运行，您应该不需要它。试着把它拿出来看看会发生什么！

来源：http: [//developer.android.com/reference/android/os/AsyncTask.html](http://developer.android.com/reference/android/os/AsyncTask.html)

# php - easyXDM、AJAX 和 Enjin

> ID：15141671
> 
> 赞同：0
> 
> 时间：2013-02-28T17:17:07.313
> 
> 标签：php, javascript, ajax, easyxdm

这将与我之前的问题（[Loading a php file into cross domain page with dynamic element height](https://stackoverflow.com/questions/15092103/loading-a-php-file-into-cross-domain-page-with-dynamic-element-height)）大致相同，但现在尝试使用新方法。

我找到了一种将我的脚本加载到本地 ajax div 的方法，但仍然存在跨域安全问题，不允许 xmlhttprequest 调用我的其他服务器。

这里的问题仍然是在站点 A 上，这是我可以完全访问并托管我的脚本文件的 Web 服务器，我可以对脚本做任何我想做的事情并使其工作。在 Enjin 服务器上的站点 B 上，我无权访问主机脚本。我可以将 .js 脚本放在那里并运行它们，但我不能从他们的服务器上使用 php，这会产生我的问题。为了立即解决这个问题，我使用了 iframe，至少可以说效率低下。它无法从它从站点 A 调用的 php 文件生成的内容中加载动态高度。我计划通过 AJAX 将其加载到 div 中来解决这个问题，但我遇到了一些问题。

我的 AJAX 脚本是这样的：

```
<pre><code>function Ajax(){
    var xmlHttp;
        try{    
            xmlHttp=new XMLHttpRequest();// Firefox, Opera 8.0+, Safari
        }
        catch (e){
            try{
                xmlHttp=new ActiveXObject("Msxml2.XMLHTTP"); // Internet Explorer
            }
            catch (e){
                try{
                    xmlHttp=new ActiveXObject("Microsoft.XMLHTTP");
                }
                catch (e){
                    alert("No AJAX!?");
                    return false;
                }
            }
        }

    xmlHttp.onreadystatechange=function(){
        if(xmlHttp.readyState==4){
            document.getElementById('ReloadThis').innerHTML=xmlHttp.responseText;
            setTimeout('Ajax()',10000);
        }
    }
    xmlHttp.open("GET","http://sitea.com/twitch_api/stream_header.php",true);
    xmlHttp.send(null);
    }

    window.onload=function(){
        setTimeout('Ajax()',10000);
    }
</code></pre> 
```

那么显然 div 正在遵循脚本。

这是调用的脚本是这样的：

[http://pastebin.com/mC8kakKJ](http://pastebin.com/mC8kakKJ)

抱歉，无法在代码块中正确解析所有代码，但我制作了脚本的 pastebin 副本

我这里的问题变成了。我的脚本需要什么样的外观才能与 easyXDM 一起使用？我没有像这样或 cors 的库的经验，所以一个示例标记会很棒。

我也不是很精通 javascript/ajax，这导致了我的第二个问题。我上面列出了我的 ajax 代码，我将如何让该 div 立即填充所需的文件，然后每 300000 毫秒（5 分钟）更新一次。

任何帮助表示赞赏。在 Enjin 论坛上有一个帖子，但没有太多人有这种深度的经验。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-17T02:08:43.133

您可以使用 $.getJSON()，Enjin 页面使用 jQuery。只需确保您的服务器响应包含在回调函数中，以便允许跨站点请求。

# html - 使用 angularJS 在 html 中显示动态时间表

> ID：15141672
> 
> 赞同：0
> 
> 时间：2013-02-28T17:17:10.977
> 
> 标签：html, angularjs

这是一个项目管理应用程序，有很多项目都有开始日期和结束日期。

我希望有一个时间表页面，其中显示项目及其时间表，例如甘特图聊天。每个项目占用表格的一行，并且时间表（持续时间）在年历中突出显示。

我正在使用 html 和 agularJS。我使用 ng-repeat 检索包含项目名称、开始日期和结束日期的项目列表。

我不知道如何做年历并在日历上显示动态时间表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T17:22:19.457

有一个名为[AngularUI](http://angular-ui.github.com/)的很棒的项目，它专门使用 UI 元素构建，用于您尝试做的事情。其中之一是日历。您可以按照自己的意愿使用他们的日历 UI 元素来显示项目。

你说你正在使用 ng-repeat；因此，您的 $scope 中已经有一个列表。您可以简单地转换数据，使其具有所需的属性（标题、开始和其他一些可选属性，如结束日期）并将其传递到日历元素，例如：

```
$scope.events = [
      {title: 'All Day Event',start: new Date(y, m, 1)},
      {title: 'Long Event',start: new Date(y, m, d - 5),end: new Date(y, m, d - 2)},
      {id: 999,title: 'Repeating Event',start: new Date(y, m, d - 3, 16, 0),allDay: false},
      {id: 999,title: 'Repeating Event',start: new Date(y, m, d + 4, 16, 0),allDay: false},
      {title: 'Birthday Party',start: new Date(y, m, d + 1, 19, 0),end: new Date(y, m, d + 1, 22, 30),allDay: false},
      {title: 'Click for Google',start: new Date(y, m, 28),end: new Date(y, m, 29),url: 'http://google.com/'}
    ]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-07T10:11:37.840

您可以尝试将 dhtmlxGantt（一个 JavaScript 甘特图库）与 AngularJS 一起使用。这是一个教程：[http ://www.dhtmlx.com/blog/?p=2200](http://www.dhtmlx.com/blog/?p=2200)

dhtmlxGantt 具有可自定义的时间刻度。

（免责声明：我是 DHTMLX 团队的一员）。

# firefox - 如何将面板锚定到小部件（Firefox Addon-SDK）

> ID：15141674
> 
> 赞同：0
> 
> 时间：2013-02-28T17:17:12.053
> 
> 标签：firefox, widget, panel, firefox-addon-sdk, add-on

Helo，我尝试开发一个（我的第一个）firefox 插件。它应该在几个定义的 url 上显示一个面板，其中包含一些内容。如果我点击小部件符号就好了。现在我想要，如果用户加载页面，则显示面板。

面板.show(); 显示面板居中。我想将面板映射/锚定到小部件，以便面板显示在右下角。

解决方案[https://gist.github.com/azu/4413137](https://gist.github.com/azu/4413137)和[Mozilla "Jetpack" Add-On: Anchor Panel to Widget](https://stackoverflow.com/questions/5478434/mozilla-jetpack-add-on-anchor-panel-to-widget)对我不起作用。（带有附加构建器的 SDK 1.13.2）

**我的代码：**

```
thePanel = panel.Panel({
    width: 320,
    height: 170,
    contentScriptFile: [self.data.url('jquery.js'), self.data.url('panel.js')],
    contentScriptWhen: "ready",
    contentScript: "SOMESCRIPT",
    contentURL: self.data.url('thecontent.html'),
    onMessage: function (item) {
      console.log('message : "' + item + '"');
      tabs.open(item);   
    }
});

var widget = widgets.Widget({
    id: "my-id",
    label: ".de",
    panel: thePanel,
    contentURL: self.data.url("favicon.ico"),
    onClick: function() {
        /*blabla*/
    }
});

tabs.on('ready', function(tab) {
  check_content(); // loads thecontent.html for panel content
  thePanel.show(); // Shows panel at center
}); 
```

有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-15T06:19:38.893

```
thePanel = panel.Panel({
    width: 320,
    height: 170,
    contentScriptFile: [self.data.url('jquery.js'), self.data.url('panel.js')],
    contentScriptWhen: "ready",
    contentScript: "SOMESCRIPT",
    contentURL: self.data.url('thecontent.html'),
    onMessage: function (item) {
      console.log('message : "' + item + '"');
      tabs.open(item);   
    }
});

var widget = widgets.Widget({
    id: "my-id",
    label: ".de",
    //panel: thePanel,
    contentURL: self.data.url("favicon.ico"),
    onClick: function(view) {
        /*This will work*/
       view.panel = thePanel;
       /*This will work*/
    }
});

Instead of using panel.show(), use view.panel = thePanel; 
```

# php - 在php中相对于url重定向301

> ID：15141675
> 
> 赞同：0
> 
> 时间：2013-02-28T17:17:16.733
> 
> 标签：php, redirect, seo

我正在迁移到一个新域名，我需要将所有传入链接重定向到新域名。所有页面都在两个网站上。

（例如：www.oldsite.com/services.php 和 www.exemple.com/services.php 都是活动的并且相同。）

我想知道我的代码是否对 SEO 友好而不会弄乱 .htaccess 文件。

```
<?php
$referer = $_SERVER['SERVER_NAME'];
$domain = "www.exemple.ca";
$uri = $_SERVER['REQUEST_URI'];

if(strpos($referer,$domain) === false) {
    header( "HTTP/1.1 301 Moved Permanently" );
    header( "Status: 301 Moved Permanently" );
    header( "Location: http://www.exemple.ca$uri" );
    exit(0);
} ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T17:22:45.873

几点：

*   您可能想要`HTTP_HOST`（请求的主机名），而不是`SERVER_NAME`.
*   假设您没有使用任何子域，则无需使用`strpos`，我只会比较两个主机名并在它们不相等时重定向
*   您只需要一个 301 标头
*   htaccess 会比使用 PHP 快得多，特别是如果你已经有一个 htaccess 文件

考虑到这一点，我可能会将您的代码重写为：

```
<?php
$referer = $_SERVER['HTTP_HOST'];
$domain = "www.exemple.com";
$uri = $_SERVER['REQUEST_URI'];

if($referer != $domain) {
    header( "Location: http://www.exemple.ca$uri" true, 301);
    exit(0);
} ?> 
```

您可能也只想对 GET 请求执行此操作。

htaccess 版本（假设 mod_rewrite 已启用）将是：

```
RewriteEngine On

RewriteCond %{HTTP_HOST} !(^www.exemple.ca)
RewriteRule (.*) http://www.exemple.ca/$1 [R=301,L] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T17:19:51.490

`301`与 SEO 一样友好。它向蜘蛛表明该页面已永久移动。

# asp.net - asp.net 中的 TextChange 事件失去焦点

> ID：15141677
> 
> 赞同：0
> 
> 时间：2013-02-28T17:17:31.403
> 
> 标签：asp.net, textbox

我正在尝试一件非常简单的事情。我有 3 个文本框和 3 个标签。在文本更改时，我正在设置标签的内容。

问题是当我在第一个文本框（例如 50）中插入一些值时，将焦点更改为另一个文本框，标签中的值会完美反映。但是我在第二个文本框上设置的焦点丢失了。焦点在某处丢失。我需要再次单击第二个文本框才能获得焦点。

如果单击 TAB 以更改焦点，则会重现相同的问题。

我已经为此制作了一个小型演示项目并附上。您可以从以下链接中使用它

[https://skydrive.live.com/redir?resid=A716D678775EEF95!115&authkey=!ABp6kAon_ZNDLBU](https://skydrive.live.com/redir?resid=A716D678775EEF95!115&authkey=!ABp6kAon_ZNDLBU)

请有人帮助我......我做错了什么？

提前致谢...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T19:17:38.217

这是 ASP.NET 中相当常见的问题，如下所述：http: [//www.codeproject.com/Articles/17571/Maintain-focus-between-postbacks-in-ASP-NET-2-0-al](http://www.codeproject.com/Articles/17571/Maintain-focus-between-postbacks-in-ASP-NET-2-0-al)或此处:[如何在页面部分回发后保持 UpdatePanel 中的焦点位置](https://stackoverflow.com/questions/2703079/how-do-i-maintain-focus-postition-after-page-partial-post-back)。这些链接还包含有关如何解决此问题的一些建议。

一种可能的解决方案是使用焦点跟踪控制，将有关它的信息放入隐藏字段并在回发后手动恢复焦点。此方法在提到的第一个链接中进行了描述。

# design-patterns - UML 类图中的菱形表示什么？

> ID：15141678
> 
> 赞同：81
> 
> 时间：2013-02-28T17:17:37.913
> 
> 标签：design-patterns, uml, class-diagram

考虑下面的两个图表。顶部的右端包含一个普通箭头，底部的左端包含一个带有菱形的箭头，右端包含一个普通箭头。伟大的[书 GoF](https://rads.stackoverflow.com/amzn/click/com/0201634988)使用了这两种图表。

我想了解**钻石**在第二种情况下表示什么，以及这两种情况中的哪一种在`Customer`和之间给出了更强的关联`Order`。

在这两种情况下，类是否`Customer`负责类的生命周期？`Order`

![在此处输入图像描述](../Images/e39c67e3ebe30a77aea0bcbc0dc9de47.png) ![在此处输入图像描述](../Images/7e3c5d6ba88eb4d8fbce7acf9bce245d.png)

* * *

## 回答 #1

> 赞同：117
> 
> 时间：2013-02-28T17:35:34.553

如果**没有钻石**，那么我们就有了一个简单的**关联**。

如果菱形为**空**，则表示它是一个**聚合**。这种关系比简单的关联要强。在这种情况下，客户聚合订单。

如果菱形是**黑色**的，则表示它是一个**组合**，它比聚合还要强，因为聚合的类不能被其他类聚合。它的“生命”取决于容器。

我认为它解释得更清楚一点，在：

*   Ezra, Aviad（2009 年 5 月 28 日）“ *[UML 类图：关联、聚合和组合](http://aviadezra.blogspot.be/2009/05/uml-association-aggregation-composition.html)*”

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2014-08-10T15:57:24.487

客户和订单是一种“有”的组合关系，因为如果客户不复存在，他/她的订单也会不复存在。因此，容器（客户）和该容器内的实例（订单）之间存在生命周期依赖关系。当容器不再存在时，它的所有实例也不再存在。

另一方面，如果我们说客户有一本书。在这种情况下，我们有一个“has-a”聚合关系。因为如果客户不复存在，这本书仍然可用。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-02-28T17:20:46.790

它表示聚合。来自维基百科：

> 在 UML 中，它以图形方式表示为树的包含类末端上的空心菱形，用一条线将包含类连接到包含类。聚合在语义上是一个扩展对象，在许多操作中被视为一个单元，虽然它在物理上是由几个较小的物体组成的。

[http://en.wikipedia.org/wiki/Class_diagram](http://en.wikipedia.org/wiki/Class_diagram)

# javascript - 如何在数据位置上使用 remove.attr 然后打印？

> ID：15141679
> 
> 赞同：0
> 
> 时间：2013-02-28T17:17:37.547
> 
> 标签：javascript, jquery

我正在尝试编写一个函数来删除页脚的数据位置固定属性，然后打印页面。我将此与 onclick 事件相关联，但它对页面没有影响。

```
function printpage(){
    $('#footer').removeAttr('data-position');
    javascript:window.print()
} 
```

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T17:20:59.163

里面不应该有一个`javascript`字...

```
function printpage(){

    $('#footer').removeAttr('data-position');

    window.print()
} 
```

我希望您是从`href`页面元素中复制和粘贴的，其中实际的 javascript 代码以它为前缀，`javascript:`但在执行 javascript 时会产生错误。

# android - android搜索多个关键字

> ID：15141681
> 
> 赞同：3
> 
> 时间：2013-02-28T17:17:46.957
> 
> 标签：android, search, tags

我的应用程序包含搜索功能，它将搜索数据库内的内容。我搜索的弱点是，我只能使用一个标签进行搜索，例如我只能搜索“cat”，它会在我的数据库中返回包含单词“cat”的内容，因为我`LIKE`在 select 语句期间使用查询。如何使用多个标签进行搜索？例如“带黄球的猫”。这样，它将返回与插入的字符串相关的结果，如果数据库中不存在某些标签，它将忽略。为了更清楚，我`AboutCat`在我的数据库中创建了一个示例表。它包含 3 列，即 id、c_question 和 c_keyword。

**编号 = 1**

**c_question = 如果我们拉猫的胡子会发生什么？**

**c_keyword = 猫胡子拉**

如果我使用列中的任何关键字进行搜索，`c_keyword`例如“cat”或“cat mustache”或“mustache pull”，它将显示`c_question`。但如果我搜索“猫拉”或“小胡子猫”，它就不会显示。那么，我如何通过忽略单词的顺序来搜索它，只要它匹配并存在于 c_keyword 列中？下面是我的代码...问我我的解释是否不清楚..

```
btnWanita.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {

            results.clear();

            if(txtWnta.getText().toString().matches(""))
            {
                Toast.makeText(WanitaActivity.this, "Sila masukkan kata kunci", Toast.LENGTH_SHORT).show();

            }

            else
            {
            OpenHelper helper = new OpenHelper(getApplicationContext());
            database = helper.getWritableDatabase();

            try{                    

                String sql = "select * from " +
                            OpenHelper.DB_TABLE_WANITA + " where " + OpenHelper.KEY_WANITA +
                            " like " + "'%" + txtWnta.getText().toString() + "%';";
                Cursor c = database.rawQuery(sql, null);

                if(c!= null)
                {
                    c.moveToFirst();
                    int soalanColumn = c.getColumnIndex(OpenHelper.MASALAH_WANITA);
                    int getId = c.getColumnIndex(OpenHelper.ID_WANITA);
                    if(c.isFirst())
                    {
                        do
                        {
                            idList.add(c.getLong(getId));
                            results.add(c.getString(soalanColumn));

                        }while(c.moveToNext());
                    }

                    adapter.updateList(results);
                }

            }

                catch(SQLException e)
                {
                    Log.v("caer ", e.toString());   
                }
            } 
```

我的搜索在这里...

```
String sql = "select * from " +
                            OpenHelper.DB_TABLE_WANITA + " where " + OpenHelper.KEY_WANITA +
                            " like " + "'%" + txtWnta.getText().toString() + "%';"; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T17:34:52.180

您需要将字符串拆分为单独的单词，然后动态构建 WHERE 子句以匹配每个单词。像这样的东西：

```
String sql = 
"select * from " 
+ OpenHelper.DB_TABLE_WANITA 
+ " where " 
+ OpenHelper.KEY_WANITA + " like " + "'%cat%'" 
+ " or "
+ OpenHelper.KEY_WANITA + " like " + "'%mustache%'"
+ " or "
+ OpenHelper.KEY_WANITA + " like " + "'%pull%'"
+";"
; 
```

# android - 将 iOS 应用程序移植到 Android，使用 phonegap 跨平台是更好的选择？

> ID：15141683
> 
> 赞同：-1
> 
> 时间：2013-02-28T17:17:53.360
> 
> 标签：android, ios, cordova, mobile

我需要为我的网站开发一个适用于 iOS 和 Android 的移动应用程序。

现在我想知道，使用 phonegap 是否是加速该过程的好主意，因为无论平台如何，它都使用 html5。我目前正计划编写一个原生 iOS 应用程序，然后为 Android 重写一个“副本”。

此外，我希望应用程序具有原生应用程序的感觉，也就是首先对应用程序本身原生的感觉，然后再与它运行的平台兼容。我听说过一些关于移动应用程序的不好的事情，感觉就像是一个网络应用程序，它们通常一开始就配不上一个应用程序。

那么使用 html5 作为应用程序的基础会是一个好主意吗？否则，是否有任何其他技巧可以同时为 iOS 和 Android 编写代码，这将使应用程序在操作系统运行之前首先感受到我的网站原生的感觉。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T17:42:50.077

我想你的选择很清楚。尝试原生，因为应用程序的感觉更好（在原生之前记住 facebook）。

# linq - 将 Linq 查询转换为列表时出错

> ID：15141685
> 
> 赞同：0
> 
> 时间：2013-02-28T17:18:12.303
> 
> 标签：linq, list, entity-framework-4

这是我的代码。我想将列表保存在会话变量中以供以后进行身份验证（它是用户有权访问的对象列表......）我收到一条错误消息，指出它无法将 System.Collections.Generic.List 隐式转换为'System.集合.通用.列表。帮助？

```
 protected void Session_Start(object sender, EventArgs e)
    {
        string strUserName = User.Identity.Name;
        string strShortUserName = strUserName.Replace("WINNTDOM\\", string.Empty).ToUpper();
        System.Web.HttpContext.Current.Session["strShortUserName"] = strShortUserName;
        System.Web.HttpContext.Current.Session["strUserName"] = strUserName;
        List<string> authorizedObjects = new List<string>();
        using (CPASEntities ctx = new CPASEntities())
        {
            var w = (from t in ctx.tblUsers
                     where (t.UserPassword == strUserName)
                     select t).FirstOrDefault();
            if (!(w==null))
            {
                authorizedObjects = (from t in ctx.qryUserObjectAuthorization
                                         where (t.UserPassword == strUserName)
                                         select new {  n = t.ObjectName }).ToList();

            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T17:20:18.397

`authorizedObjects`是`List<string>`，但您试图将其用作匿名类型的列表：

```
List<string> authorizedObjects = new List<string>(); 
```

(...)

```
authorizedObjects = (from t in ctx.qryUserObjectAuthorization
                     where (t.UserPassword == strUserName)
                     select new {  n = t.ObjectName, i = t.ObjectID }).ToList() 
```

将您的查询更改为：

```
authorizedObjects = (from t in ctx.qryUserObjectAuthorization
                     where (t.UserPassword == strUserName)
                     select t.ObjectName).ToList() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T17:21:56.557

您正在初始化一个`List<string>`对象但填充不同的对象。

```
List<string> authorizedObjects = new List<string>();

select new {  n = t.ObjectName, i = t.ObjectID } <--construct a class with these properties and initialize `List<WithNewClassName>` 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-28T17:22:20.427

要将其生成为字符串列表，请使用

```
authorizedObjects = (from t in ctx.qryUserObjectAuthorization
                     where (t.UserPassword == strUserName)
                     select t.ObjectName).ToList(); 
```

# cryptoapi - CryptDecryptMessage 失败

> ID：15141691
> 
> 赞同：0
> 
> 时间：2013-02-28T17:18:24.267
> 
> 标签：cryptoapi

我一直在尝试编写一些代码来使用 Microsoft CryptoAPI。目标很简单：加密然后解密一个字符串。我似乎几乎可以正常工作，但是对 CryptDecryptMessage 的最后一次调用失败了。

因此，我能够成功加密我的字符串。然后，当我获取加密的二进制字符串并尝试对其进行解密时，除了最后一次调用 CryptDecryptMessage 之外，一切正常。我正在使用的解密代码如下。

就代码而言，第一次调用 CryptDecryptMessage 以获取所需的输出缓冲区大小成功，但它总是返回等于明文字符串大小加 6 的大小。然后我调整输出缓冲区的大小，下一次调用到 CryptDecryptMessage 失败（返回值为零，`dwSizeRequired`设置为零，输出缓冲区中没有任何内容，并`GetLastError`返回 NTE_BAD_KEY）。

另一方面，如果我取消注释该`#define TESTING_INCORRECT`行，行为会略有不同。对 CryptDecryptMessage 的第一次调用成功。它的返回值为 0，但`GetLastError`返回`ERROR_MORE_DATA`，这是人们所期望的，最重要`dwSizeRequired`的是，它设置了编码的原始明文字符串的大小。然后我第二次分配并调用 CryptDecryptMessage，它再次像上面一样失败。

最后，我的密钥库中确实有私有证书密钥。

有谁知道这里出了什么问题？？？？谢谢。

```
void decrypt(std::string& sClearTextString , const std::vector<T_Byte>& sEncryptedBinaryString, const std::string& sKey)
{
    BOOL bResult;

    HCRYPTPROV hProv;
    bResult = CryptAcquireContext( &hProv, NULL, MS_DEF_PROV, PROV_RSA_FULL, 0); 
    CHECK_CRYPT_ERR( !bResult , "Unable to find crypto context");

    HCERTSTORE hStore(NULL);
    const char* const pcKey = sKey.empty()? "MY" : sKey.c_str();
    hStore = CertOpenSystemStore( 0, pcKey);
    CHECK_CRYPT_ERR( hStore==NULL, "unable to open certificate store.");

    HCERTSTORE CertStoreArray[] = {hStore};

    CRYPT_DECRYPT_MESSAGE_PARA  DecryptParams;
    DWORD  DecryptParamsSize = sizeof(DecryptParams);
    memset(&DecryptParams, 0, DecryptParamsSize);
    DecryptParams.cbSize = DecryptParamsSize;
    DecryptParams.dwMsgAndCertEncodingType = (PKCS_7_ASN_ENCODING | X509_ASN_ENCODING);
    DecryptParams.cCertStore = sizeof(CertStoreArray)/sizeof(HCERTSTORE);
    DecryptParams.rghCertStore = CertStoreArray;

    const BYTE* const pbContent = &sEncryptedBinaryString[0];
    DWORD dwSize = STATICCAST<DWORD>(sEncryptedBinaryString.size());
    DWORD dwSizeRequired = 0;

    BYTE* pbOutBuffer = NULL;
//#define TESTING_INCORRECT
#ifdef TESTING_INCORRECT
    std::string sDummyBuffer(2,'\0');
    pbOutBuffer = (BYTE*)(&sDummyBuffer[0]);
#endif

    // Get required buffer size.
    bResult = CryptDecryptMessage( &DecryptParams, pbContent, dwSize, pbOutBuffer, &dwSizeRequired, NULL);
    CHECK_CRYPT_ERR( !bResult && ERROR_MORE_DATA != GetLastError() , "Unable to get buffer length");

    //Allocate buffer
    sClearTextString.clear();
    sClearTextString.resize(dwSizeRequired+1,0);
    pbOutBuffer = (BYTE*)(&sClearTextString[0]);

    //Now actually decryt
    bResult = CryptDecryptMessage( &DecryptParams, pbContent, dwSize, pbOutBuffer, &dwSizeRequired, NULL);
    CHECK_CRYPT_ERR( !bResult , "Unable to decrypt");

    CertCloseStore(hStore, CERT_CLOSE_STORE_CHECK_FLAG);
    CryptReleaseContext(hProv, 0);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T18:22:36.280

我会调查正在使用的密钥。2148073475的返回码实际上转化为0x80090003，也就是NTE_BAD_KEY。234 的 GetLastError 是 ERR_MORE_DATA，表示缓冲区大小不足。

我*认为*问题在于期望对 CryptDecryptMessage 的第一次调用将接收 NULL 作为指向 pbDecrypted 的指针，因为它是一个大小调用，但由于它的非 null 删除了注释，它给出了 234 结果，认为它试图解密某些东西已经确定*了*尺寸。

如果大小（第一次）调用上的接收缓冲区应该为空的假设是正确的，那么这导致我建议密钥可能在某种程度上根据 NTE_BAD_KEY 错误代码受到怀疑。

希望能激起一些对你有帮助的想法。

# monitoring - ITM 报告不同情况

> ID：15141694
> 
> 赞同：0
> 
> 时间：2013-02-28T17:18:27.630
> 
> 标签：monitoring, tivoli

我正在尝试获取有关 ITM 6.2.1 的报告，其中涉及使用某些配置信息运行的每个设备和情况。

我需要列出每个设备，每个情况，公式和系统命令与邮件发送。有没有办法获得这些信息而不必手动进入每个设备、情况等？

例子：

装备：equip01 代理：LinuxOS 情况：LINUX_FILE_SIZE、LINUX_UNIX_FS_CRITICAL 等 公式：文件：'/local/file.err' 大小：!=0,000 操作：系统命令：usr/bin/mail oper@mail.com

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T01:33:57.940

我认为有很多方法可以做到这一点，但我会使用 tacmd 命令研究一些 shell 脚本，例如“tacmd listit -m AGENT”和“tacmd viewsit -s SITUATION”，您可以通过组合这些命令的输出来自动化工作并以这种方式创建报告。

此外，还有一个很酷的工具叫做“ITMSUPER”，它通过 SOAP 调用连接到您的 ITM 环境并创建关于整个环境的非常有用的报告，您一定要看看：

[https://www.ibm.com/developerworks/mydeveloperworks/wikis/home/wiki/Use%20ITMSUPER%20to%20Solve%20ITM%20Issues/page/Some%20Useful%20Examples%20of%20ITMSUPER%20for%20Beginners?lang= zh](https://www.ibm.com/developerworks/mydeveloperworks/wikis/home/wiki/Use%20ITMSUPER%20to%20Solve%20ITM%20Issues/page/Some%20Useful%20Examples%20of%20ITMSUPER%20for%20Beginners?lang=en)

# extjs - 离开单元格时如何防止 Ext.js 滚动

> ID：15141702
> 
> 赞同：2
> 
> 时间：2013-02-28T17:19:01.037
> 
> 标签：extjs

我实际上遇到了与[单击单元格时如何防止 extjs 网格滚动的相反问题？](https://stackoverflow.com/questions/6061392/how-to-prevent-extjs-grid-from-scrolling-when-clicking-on-a-cell) 当我选择一个网格单元格时，在我的情况下是一个下拉列表，选择一个选项，然后单击页面上的其他位置，它会向上滚动页面，以便该行位于页面顶部。

这是使用 Ext 4.1.1a。

# jquery - 如何更改 jquery text() 的样式？

> ID：15141703
> 
> 赞同：1
> 
> 时间：2013-02-28T17:19:01.420
> 
> 标签：jquery, css

假设我有：

`<span id="spanny"><strong>some default text</strong></span>`

我得到：**一些默认文本**

然后我打电话：

```
$("#spanny").text("<strong>new text</strong>"); 
```

我得到：

```
<strong>new text</strong> 
```

我想要什么：

**新文本**

如何设置文本样式以具有 STRONG attr？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-28T17:19:40.407

使用`html`代替`text`：

```
$("#spanny").html("<strong>new text</strong>"); 
```

[`html`](http://api.jquery.com/html/#html2)用于设置 HTML 内容，而[`text`](http://api.jquery.com/text/#text2)将转义字符串。

# java - 使用 itextpdf 进行条码定制

> ID：15141704
> 
> 赞同：0
> 
> 时间：2013-02-28T17:19:05.890
> 
> 标签：java, barcode, itextpdf

在我的 java 代码中，我以事实上的标准方式使用 itextpdf 生成 Code 39：

```
Barcode39 code39 = new Barcode39();
code39.setCode(getMySuperDuperCodeInStringRepresentation());
code39.setFont(null);
code39.setBarHeight(Utilities.millimetersToPoints(13f));
code39.setExtended(true);
Image image = Image.getInstance(code39.createAwtImage(Color.BLACK, Color.WHITE), null); 
```

代码 39 的适当文档“窄线和宽线之间的宽度比可以在 1:2 和 1:3 之间选择”。有没有办法设置窄线和纵横比？或者这超出了 itextpdf 中 Barcode 类的范围，我需要使用另一个库来生成条形码？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T04:34:29.190

ISO/IEC 16388 Code 39 规范指出了 2:1 到 3:1 的有效“宽/窄比”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T19:02:47.367

经过一番阐述，我会回答自己：这很容易......

只需缩放生成的 Image 对象：

```
image.scalePercent(__your_scale_in_percent__); 
```

还有更多缩放方法，请查看文档：http: [//api.itextpdf.com/itext/com/itextpdf/text/Image.html](http://api.itextpdf.com/itext/com/itextpdf/text/Image.html)

只需注意条形码中宽线和窄线之间的纵横比，它就会很好地工作。

# debugging - 如何使用 DbgHelp 访问转储中的 PEB（进程环境块）

> ID：15141706
> 
> 赞同：1
> 
> 时间：2013-02-28T17:19:13.703
> 
> 标签：debugging, minidump, dbghelp

我找到了一个使用调试器引擎 API 在转储中获取 PEB的[示例。](https://github.com/okigan/CrashInsight/blob/master/crashinsightlib/crashinsight.cpp)这可以使用 DbgHelp 吗？拥有使用 DbgHelp 提取注释和异常信息的现有代码。如果可能的话，想从 PEB 获取一些信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-04-20T16:11:42.017

您可以使用[MiniDumpReadDumpStream](https://msdn.microsoft.com/en-us/library/windows/desktop/ms680359(v=vs.85).aspx)函数从转储文件中读取流。只需将转储文件读入内存或映射到内存中，即可使用此功能。

访问 PEB。从转储文件中读取 ThreadListStream。MINIDUMP_THREAD_LIST 结构将包含一个 MINIDUMP_THREAD 结构数组，其中有一个 Teb 字段，其中包含该线程的 TEB 地址。

32 位和 64 位上的 TEB 和 PEB 的区别在于 64 位上的指针是 8 个字节。

这意味着对于 32 位进程，PEB 的地址可以在 TEB 的 0x30 偏移处找到。对于 64 位进程，PEB 的地址可以在 TEB 的 0x60 偏移处找到。

从小型转储文件中读取内存时，您需要滚动自己的内存读取器功能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-21T13:12:26.177

WinDbg 中有一个 !peb 命令，适用于转储。另请参阅：[http ://windbg.info/doc/1-common-cmds.html](http://windbg.info/doc/1-common-cmds.html)

# ruby-on-rails - 画廊 id 的未定义方法

> ID：15141707
> 
> 赞同：0
> 
> 时间：2013-02-28T17:19:23.267
> 
> 标签：ruby-on-rails

我正在关注 CarrierWave (#253) 的 Railscast 教程。但是立即注意到创建者已经制作了画廊模型/控制器。这从未在视频中显示或在不同的教程中解释过。我一直在创建画廊，除了这个页面 /photos/new?gallery_id=3 之外，几乎所有东西都在工作，它应该向我展示一个上传照片的字段。

我可以去 /galleries，它会列出所有创建的画廊。然后我可以单击其中一个画廊并被带到 /galleries/3，它将显示添加、删除和查看画廊的链接。

我收到的错误是“未定义的方法‘键？’ 对于零：NilClass”。PhotosController#new 中的 NoMethodError 是页面的标题。

有人可以看看并指出我正确的方向吗？谢谢。

照片控制器：

```
class PhotosController < ApplicationController
  def new
    @photo = Photo.new(:gallery_id => params[:gallery_id])
  end

  def create
    @photo = Photo.new(params[:photo])
    if @photo.save
      flash[:notice] = "Successfully created photos."
      redirect_to @photo.gallery
    else
      render :action => 'new'
    end
end

  def edit
    @photo = Photo.find(params[:id])
  end

  def update
    @photo = Photo.find(params[:id])
    if @photo.update_attributes(paramas[:photo])
      flash[:notice] = "Successfully updated photo."
      redirect_to @photo.gallery
    else
      render :action => 'edit'
    end
  end

  def destroy
    @photo = Photo.find(params[:id])
    @photo.destroy
    flash[:notice] = "Successfully destroyed photo."
    redirect_to @photo.gallery
  end
end 
```

视图/照片中的 _form.html

```
<%= form_for @photo, :html => {:multipart => true} do |f| %>
    <%= f.error_messages %>
    <%= f.hidden_field :gallery_id %>
    <p>
        <%= f.label :name %><br/>
        <%= f.text_field :name %>
        </p>
        <p>
            <%= f.file_field :image %>
            </p>

            <p><%= f.submit %></p>
<% end %> 
```

新的.html

```
<% title "New Photo " %>

<%= render 'form' %>

<p><%= link_to "Back to Gallery", @photo.gallery %></p> 
```

路线.rb

```
Dating::Application.routes.draw do
  get 'signup' => 'users#new'
  get 'login' => 'sessions#new'
  get 'logout' => 'sessions#destroy'
  get 'edit' => 'users#edit'
  get "/profile/:id" => "users#show"

  resources :users
  resources :sessions
  resources :password_resets
  resources :galleries
  resources :photos

  root to: 'users#new'
  root to: 'galleries#index' 
```

# vb.net - VB.NET 2010 Web 请求刷新

> ID：15141710
> 
> 赞同：0
> 
> 时间：2013-02-28T17:19:38.260
> 
> 标签：vb.net, visual-studio-2010, timer, webrequest

嘿，我是 VB 的新手，我正在尝试每 30 秒刷新一次 Web 请求，并且一直坚持如何在其中实现计时器。这是我到目前为止生成的代码，我将不胜感激正确的解决方案：

```
Public Class main

Dim boatid As Integer

Sub googlemaps()
    Dim url As String = "http://www.google.com"
    Me.WebRequest.Navigate(New Uri(url))
    'Implement timer here? (me.refresh)?

End Sub

Private Sub NumericUpDown1_ValueChanged(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles SelectBoat.ValueChanged
    boatid = SelectBoat.Value

    SelectBoat.Maximum = 10
    SelectBoat.Minimum = 1

    Lbboatid.Text = boatid
End Sub

Private Sub btnsequence_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnsequence.Click
    Dim i As Integer
    boatid = i

End Sub
Private Sub Timer1_Tick(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles RefreshTimer.Tick
    RefreshTimer.Enabled = True
    RefreshTimer.Interval = 30000
End Sub

Private Sub main_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
    Datetime.Text = Now.ToString

    googlemaps()
End Sub 
```

结束类

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T17:42:45.600

每隔一定时间必须执行的方法也应该放在 `Timer1_Tick`事件上。这是一个小的实现尝试一下，看看它是否可以相应地调整您的代码：

设置所需的 Timer 属性：

单击设计视图上的计时器及其属性框列表集：

*   30000 上的间隔属性（事件将每 30 秒触发一次）
*   启用 True（加载表单后计时器将开始工作）

然后在你的代码隐藏

```
private void ShowMessage() 
{           
  MessageBox.Show("Hello Timer");
}

private void timer1_Tick(object sender, EventArgs e)
{
  ShowMessage();
} 
```

根据您发布的代码，这里还有一个工作实现，至于我从您的代码中理解的内容，您希望浏览器每隔特定秒刷新一次，并且数字上下控件显示在boatId 上设置的变量的值，这段代码是这样做的：

在它的“属性”框中设置数字上下控件的最小和最大属性（右键单击设计视图中的控件并搜索这两个属性）

然后尝试以下操作；

```
Public boatid As Integer

Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
    Me.lblDate.Text = Now.ToString()
    ''Set a bigger winform to show the browser page better
    Me.Width = 800
    Me.Height = 600
    googlemaps()
End Sub

''The browser will be refreshed every n seconds) according to what you have set on interval property of the timer control
Sub googlemaps()
    Dim url As String = "http://www.google.com"
    Me.WebBrowser1.Navigate(New Uri(url))
End Sub

''Loop over this method using the Tick event, while doing that verify the value 
''of the boatid variable and if its less than the maximun value allowed by the numeric
''updown control increment it in one unit, then show it on the numeric selected value
''as well on the label control
Private Sub ChangeBoatIdValueCycling()

    If boatid < 10 Then
        boatid += 1
    Else
        boatid = 1
    End If

    Me.NumericUpDown1.Value = boatid
    Me.lblBoatId.Text = boatid.ToString()

End Sub

''This wil show the id on the label text when you click up and down the numeric control
Private Sub NumericUpDown1_ValueChanged(ByVal sender As System.Object, ByVal e As System.EventArgs)
    Me.lblBoatId.Text = Me.NumericUpDown1.Value.ToString()
End Sub

''This will set a variable with value 5 that will get shown selected on the numeric
''control as well as visible on the label text, the value will be shown because 
''it exists in the range of 1 to 10 that is your requeriment.
Private Sub btnsequence_Click_1(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnsequence.Click
    Dim i As Integer = 5
    boatid = i
    Me.NumericUpDown1.Value = boatid
    Me.lblBoatId.Text = boatid.ToString()
End Sub

''Needed to repeat the form refresh and boatid cycling every n seconds according to  your Interval property
''value
Private Sub RefreshTimer_Tick(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles RefreshTimer.Tick
    googlemaps()
    ChangeBoatIdValueCycling()
End Sub 
```

我希望它有所帮助。让我知道事情的后续。

# php - UPS Soap Tracking API 但出现错误...故障代码 VersionMismatch

> ID：15141712
> 
> 赞同：1
> 
> 时间：2013-02-28T17:19:43.360
> 
> 标签：php, api, soap, ups

我正在尝试向 UPS 跟踪 API 发送测试，但我不断收到以下错误

```
SoapFault: Wrong Version in... 
```

以下是我发送的请求文件

```
 <?xml version="1.0" encoding="UTF-8"?>
<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" 
    xmlns:ns1="http://www.ups.com/XMLSchema/XOLTWS/Common/v1.0" 
    xmlns:ns2="http://www.ups.com/XMLSchema/XOLTWS/Track/v2.0" 
    xmlns:ns3="http://www.ups.com/XMLSchema/XOLTWS/UPSS/v1.0">
        <SOAP-ENV:Header>
            <ns3:UPSSecurity>
                <ns3:UsernameToken>
                    <ns3:Username>username</ns3:Username>
                    <ns3:Password>password</ns3:Password>
                </ns3:UsernameToken>
                <ns3:ServiceAccessToken>
                    <ns3:AccessLicenseNumber>855566598C34</ns3:AccessLicenseNumber>
                </ns3:ServiceAccessToken>
            </ns3:UPSSecurity>
        </SOAP-ENV:Header>
        <SOAP-ENV:Body>
            <ns2:TrackRequest>
                <ns1:Request>
                    <ns1:RequestOption>15</ns1:RequestOption>
                    <ns1:TransactionReference>
                        <ns1:CustomerContext>Add description here</ns1:CustomerContext>
                    </ns1:TransactionReference>
                </ns1:Request>
                <ns2:InquiryNumber></ns2:InquiryNumber>
                <ns2:TrackingOption>02</ns2:TrackingOption>
            </ns2:TrackRequest>
        </SOAP-ENV:Body>
    </SOAP-ENV:Envelope> 
```

以下是我的 xml 响应

```
<?xml version="1.0"?>
<TrackResponse>
    <Response>
        <ResponseStatusCode>0</ResponseStatusCode>
        <ResponseStatusDescription>Failure</ResponseStatusDescription>
        <Error>
            <ErrorSeverity>Hard</ErrorSeverity>
            <ErrorCode>10002</ErrorCode>
            <ErrorDescription>The XML document is well formed but the document is not valid</ErrorDescription>
        </Error>
    </Response>
</TrackResponse> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T21:17:46.653

它现在给了我一个无效的跟踪号，所以我想我明白了。问题是无效的端点。我正在使用跟踪 API，所以端点应该是

> [https://wwwcie.ups.com/webservices/Track](https://wwwcie.ups.com/webservices/Track)

# wordpress - Wordpress 为登录设置自定义 URL。不可能？

> ID：15141719
> 
> 赞同：0
> 
> 时间：2013-02-28T17:20:03.860
> 
> 标签：wordpress, .htaccess, mod-rewrite, url-rewriting

我不是 mod_rewrite 的专家，所以我需要大量的帮助。这是场景：

域名：*www.example.com*
指向：`/www/public_html/`

我在以下位置安装了 wordpress：

```
/www/public_html/subfolder/ 
```

现在我有两个 htaccess 文件，让我们调用它们`.h1`和`.h2`. 到目前为止，我已经设法做到这一点：

当用户键入 www.example.com 时，他们将被带到子目录中的 wordpress 主页（甜蜜）。事实上，除了：

**主要问题：**

我想创建一个自定义登录 URL，比如：www.example.com/mylogin

我可以通过在我的`.h2`

```
 RewriteRule ^mylogin$ wp-login.php 
```

但是当我使用这个 URL 时，它把我带到了登录屏幕，但是浏览器中的 url 更改为[http://example.com/subfolder/wp-login.php](http://example.com/subfolder/wp-login.php)

我希望显示登录屏幕时显示的 URL 与以前相同，即[http://example.com/mylogin](http://example.com/mylogin)

更准确地说，不应显示子文件夹名称和 wp-login。我如何实现这一目标？任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T17:50:50.433

您的解决方案不会隐藏默认登录 url。它只会添加一个更容易记住的 url，该 url 重定向到默认 url /wp-login。

无需编码，您可以轻松安装插件[自定义登录和管理 URL](http://wordpress.org/extend/plugins/custom-login-and-admin-urls/)，以修复此弱点。

> **注意：**此插件已在新安装的 WordPress 上进行了测试，并且运行良好。但是，大多数免费插件不受支持，这意味着它们有时会与其他插件发生冲突，具体取决于您安装的内容。如果您有任何问题，请登录 cPanel 或 FTP 并删除插件或联系您的网络托管服务提供商。

您可能想要查看的另一个 WordPress 安全插件名为[Better WP Security](http://wordpress.org/extend/plugins/better-wp-security/)。这个 WordPress 插件为 WordPress 登录、注册和管理页面提供安全设置以及许多其他反黑客功能来保护您的网站。

# c - 在 cmocka 单元测试框架的上下文中解释 mock()

> ID：15141724
> 
> 赞同：1
> 
> 时间：2013-02-28T17:20:14.553
> 
> 标签：c, unit-testing

我正在学习 cmocka 单元测试框架。我对 mock() 函数的使用有点困惑。有人可以清楚地解释它为什么以及如何与合适的例子一起使用吗？也请说明什么时候应该使用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-03T09:54:26.067

您应该阅读[https://lwn.net/Articles/558106/](https://lwn.net/Articles/558106/)以了解 mock() 功能。

# html - 增加 DOM 元素或改用 http 请求

> ID：15141734
> 
> 赞同：0
> 
> 时间：2013-02-28T17:20:38.167
> 
> 标签：html, css, optimization

我想知道快速加载网站的最佳方法。我知道，

*   更多的http请求，网站会变慢
*   更多 DOM 元素，网站会变慢

现在，我对以下方法感到困惑：

首先，我使用额外的`div`元素来显示这样**的阴影**效果

```
<div style="height:100px;width:100px;border:1px solid #eee">
  <div style="height:100px;width:100px;border:1px solid #ccc">
    <div style="height:100px;width:100px;border:1px solid #aaa">
      <div style="height:98px;width:98px;border:1px solid #999">
        <div style="height:96px;width:96px;border:1px solid #777">
       hello world
        </div>
      </div>
    </div>
  </div>
</div> 
```

其次，我曾经像这样`background image`显示**阴影**效果

```
<div style="background-image=url(drop-showdow.png)">
  hello world
</div> 
```

越来越`http-request`多`dom element`的不利于优化网站。该怎么办？为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T18:38:05.143

为什么不直接使用 CSS？

```
box-shadow: 0 0 5px 3px #777; 
```

对于这样的东西，它增加了外观而不是必需的功能，只需使用纯 CSS。如果人们仍在使用不支持它的足够旧的浏览器，那么对他们来说是艰难的突破。如果我们每天都在担心仍处于石器时代的人们，那么整个互联网就无法发展。

# r - 递归地重复向量元素 N 次

> ID：15141735
> 
> 赞同：36
> 
> 时间：2013-02-28T17:20:43.517
> 
> 标签：r

我想重复一个向量 N 次，但要逐个元素，而不是整个向量。

例如，我有：

```
v <- c('a', 'b') 
```

假设我想重复 n 次：

```
n <- 3 
```

我想：

```
vfill <- c(rep(v[1], n), rep(v[2], n))
print(vfill)
[1] "a" "a" "a" "b" "b" "b" 
```

我迄今为止最好的解决方案：

```
ffillv <- function(i) rep(v[i], n)
c(sapply(seq_len(length(v)), ffillv)) 
```

我对快速且可扩展的解决方案感兴趣，例如使用 rbind、plyr 等。

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2013-02-28T17:24:49.810

```
rep(v, each=3) 
```

或者

```
rep(v, each=n) 
```

您在哪里定义了 n

# ruby-on-rails-3.1 - bundler 不在 proup 中安装新的 gem

> ID：15141746
> 
> 赞同：0
> 
> 时间：2013-02-28T17:22:00.333
> 
> 标签：ruby-on-rails-3.1, sass, bundler

我正在将 rails3.0 应用程序升级到 Rails3.1 我正在关注 railscast 282

我决定不使用 sass

```
group :assets do
  gem 'uglifier'
end 
```

我运行捆绑安装

现在我不会将 sass-rails gem 添加到资产中，所以我更改了 gemfile

```
group :assets do
  gem 'sass-rails', "3.1.0"
  gem 'uglifier'
end 
```

gem 不安装

```
bundle install
Fetching gem metadata from http://rubygems.org/........
Fetching gem metadata from http://rubygems.org/..
Could not find gem 'sass-rails (= 3.1.0) ruby' in the gems available on this machine. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T18:54:13.290

我不知道为什么，但只是删除 gem 版本有效

```
group :assets do
  gem 'sass-rails'
  gem 'uglifier'
end 
```

# java - Java 泛型类作为方法参数

> ID：15141748
> 
> 赞同：1
> 
> 时间：2013-02-28T17:22:03.547
> 
> 标签：java, android, generics

我在 Android 中有一个 TabListener 以这种方式定义：

```
public static class TabListener<T extends Fragment> 
    implements ActionBar.TabListener { ... } 
```

我有这个源代码：

```
Tab myTab = myActionBar.
                newTab().
                setText("Home").
                setTabListener(new TabListener<MyFragment>(
                    this, 
                    "Home", 
                    MyFragment.class
                ));
... 
```

现在我想把它放到一个方法中：

```
addTab("Home", ???);

private void addTab(String text, ???) {
    Tab myTab = myActionBar.
                newTab().
                setText(text).
                setTabListener(new TabListener<???>(
                    this, 
                    text, 
                    ???.class
                ));
    ...
} 
```

我必须填写什么而不是`???`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-28T17:54:50.613

您的选项卡侦听器需要 type 参数是`Fragment`

```
public static class TabListener<T extends Fragment> 
```

因此，您需要确保代码中的情况如此

```
addTab("Home", ???);

private <T extends Fragment> void addTab(String text, Class<T> clazz) {
    Tab myTab = myActionBar.
                newTab().
                setText(text).
                setTabListener(new TabListener<T>(
                    this, 
                    text, 
                    clazz
                ));
    ...
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-28T17:49:47.613

```
addTab("Home", MyFragment.class);

private void addTab(String text, Class<? extends Fragment> clazz) {
    Tab myTab = myActionBar.
            newTab().
            setText(text).
            setTabListener(new TabListener<>(
                this, 
                text, 
                clazz
            ));
    ...
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-28T17:25:41.247

像这样的东西可能是你正在寻找的东西：

```
private <T> void addTab(String text, Class<T> clazz) {
    Tab myTab = myActionBar.
            newTab().
            setText(text).
            setTabListener(new TabListener<T>(
                this, 
                text, 
                clazz
            ));
    ...
} 
```

# javascript - 如何确保在调用 js 函数之前将动态生成的 div 加载到 DOM 中？

> ID：15141749
> 
> 赞同：0
> 
> 时间：2013-02-28T17:22:07.593
> 
> 标签：javascript, jquery, ajax, dom

我正在提交一个带有 ajax 的表单并打开一个带有响应数据的 Colorbox：

```
$("#submitB").click(function () {
    $.post("/previewproposal", $("#proposal-form").serialize(), function(data){$.colorbox({html:data});}, "html");
}); 
```

渲染出来的html是这样的：

```
<script type="text/javascript">
    $(document).ready(function(){

        function plotData()
        {
            var dataArray = ...;
            var options = ...;

            $.plot($("#placeholder"), dataArray, options);
        }

        plotData();
    });
</script>

<div id="placeholder" style="float:left;margin:0;font-size:8pt;width:540px;height:180px;"></div> 
```

动态生成的 div 之一是 Flot 图占位符。我目前收到以下错误：

```
uncaught exception: Invalid dimensions for plot, width = null, height = null 
```

Flot 绘图功能需要绘图占位符 div 的宽度和高度才能工作。所以我在想我的情节占位符 div 在情节函数被绑定/调用时没有加载到 DOM 中？经过大量谷歌搜索并找到与此类似的问题后，我找不到如何完成这项工作的示例。如何在这里进行故障排除？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T17:40:42.790

您需要使您的 ajax 同步，但使用包装器 $.post() 是不可能的。所以将其更改为：

```
$.ajax({
  type: "POST",
  async:false,
  url: "/previewproposal",
  data: $("#proposal-form").serialize(),
  success: function(data){
         $.colorbox({html:data});
  },
  dataType: 'html'
});

//you can call plotData() here... 
```

# python - 语法错误 Python

> ID：15141756
> 
> 赞同：2
> 
> 时间：2013-02-28T17:22:23.303
> 
> 标签：python

我是 Python 新手，并试图让以下简单程序运行。在第一个 if 子句中的冒号后出现语法错误。

有人可以告诉我为什么以及如何修复它以及其他程序。

尝试了很多不同的东西，没有任何效果。

谢谢！！！

```
# calculate salary

yearly = rate * 40 * 52
weekly1 = rate * 40
weekly2 = rate / 52
hourly = (rate / 52) / 40

print "Welcome to Salary Calculator"
calc = raw_input ("Convert hourly (h) or yearly (y) wage? "

# yearly wage
if calc == "y":
    raw_input ("Hourly wage: ") % rate  
    print "Weekly wage: " % weekly1
    print "Yearly wage: " % yearly

# hourly wage
elif calc == "h":
    raw_input("Yearly wage: ") % rate
    print "Weekly wage: " % weekly2
    print "Hourly wage: " % hourly

else:
    print "That is not a valid response, try again." 
```

返回

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-28T17:23:19.693

您忘记了右括号：

```
calc = raw_input ("Convert hourly (h) or yearly (y) wage? "
                                                 -----------^ 
```

如有疑问，请查看上一行以获取不平衡的右括号或括号。

# android - 摩托罗拉仿生 - 输入类型 textPersonName 和 textCapWords 不起作用

> ID：15141757
> 
> 赞同：7
> 
> 时间：2013-02-28T17:22:24.717
> 
> 标签：android, input, android-softkeyboard

我无法在我的应用程序中获得 EditText 字段以在 Droid Bionic 上实际使用 inputType="textCapWords" 或 "textPersonName"。我测试过的其他手机似乎没问题。大写输入类型似乎都不起作用。我也尝试过不推荐使用的大写属性。并以编程方式设置。

有没有其他人遇到过这个问题？除了使用 TextWatcher 实现自定义功能之外，还有什么建议吗？

```
<EditText
        android:id="@+id/last_name_editor"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:hint="@string/last_name"
        android:inputType="textCapWords"/> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-05-21T13:41:44.190

你能检查你的设备键盘设置吗？在某些设备（三星注 2）中，它们提供自动大写检查/UN-check 选项。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-11-24T06:35:42.467

对于仍然面临此问题的任何人，这是 TextWatcher 的方式：

```
TextWatcher capitalizeTW = new TextWatcher() {
    @Override
    public void beforeTextChanged(CharSequence charSequence, int i, int i1, int i2) {

    }

    @Override
    public void onTextChanged(CharSequence charSequence, int i, int i1, int i2) {
        try{
            String inputString = ""+YOUR_TEXT_VIEW.getText().toString();
            String firstLetterCapString = WordUtils.capitalize(inputString);
            if(!firstLetterCapString.equals(""+YOUR_TEXT_VIEW.getText().toString())){
                YOUR_TEXT_VIEW.setText(""+firstLetterCapString);
                YOUR_TEXT_VIEW.setSelection(YOUR_TEXT_VIEW.getText().length());
            }
        }catch (Exception e){
            e.printStackTrace();
        }
    }

    @Override
    public void afterTextChanged(Editable editable) {

    }
}; 
```

//将TextWatcher添加到你的TextView

```
YOUR_TEXT_VIEW.addTextChangedListener(capitalizeTW); 
```

//WordUtils

```
public final class WordUtils {

private WordUtils(){

}

public static String capitalize(String str) {
    return capitalize(str, (char[]) null);
}

public static String capitalize(String str, char... delimiters) {
    int delimLen = delimiters == null ? -1 : delimiters.length;
    if (!TextUtils.isEmpty(str) && delimLen != 0) {
        char[] buffer = str.toCharArray();
        boolean capitalizeNext = true;

        for (int i = 0; i < buffer.length; ++i) {
            char ch = buffer[i];
            if (isDelimiter(ch, delimiters)) {
                capitalizeNext = true;
            } else if (capitalizeNext) {
                buffer[i] = Character.toTitleCase(ch);
                capitalizeNext = false;
            }
        }

        return new String(buffer);
    } else {
        return str;
    }
}

private static boolean isDelimiter(char ch, char[] delimiters) {
    if (delimiters == null) {
        return Character.isWhitespace(ch);
    } else {
        char[] arr$ = delimiters;
        int len$ = delimiters.length;

        for (int i$ = 0; i$ < len$; ++i$) {
            char delimiter = arr$[i$];
            if (ch == delimiter) {
                return true;
            }
        }

        return false;
    }
}
} 
```

我希望这有帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-09-20T10:49:24.983

可以试试这个……对我有用……

```
android:inputType="textCapWords" 
```

或者

```
android:inputType="textCapSentences" 
```

或者

```
android:inputType="textCapWords" 
```

对于**三星 S5/S7 ，在名为****“Auto Capitalize”**的设置中有额外的设置，用于在 Caps 中制作第一个租船人。

如果设置关闭，则需要选择在 Caps 中键入第一个字符

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-13T17:34:56.460

要么这是我特有的问题，要么似乎没有人有解决方案。使用 TextWatcher 解决方案。如果其他人提出解决方案，将改变这一点。

# python - 区域：IOError：[Errno 22] 无效模式 ('w') 或文件名

> ID：15141761
> 
> 赞同：21
> 
> 时间：2013-02-28T17:22:29.727
> 
> 标签：python, ioerror

我不知道为什么，但由于某种原因，每当我在输出文件的文件名中有“区域”时，它都会给我这个错误：

**IOError: [Errno 22] 无效模式 ('w') 或文件名：'path\regionlog.txt'**

它为**"region.txt"**、**"logregion.txt"**等执行此操作。

```
class writeTo:
    def __init__(self, stdout, name):
       self.stdout = stdout
       self.log = file(name, 'w') #here is where it says the error occurs

output = os.path.abspath('path\regionlog.txt')
writer = writeTo(sys.stdout, output) #and here too 
```

为什么是这样？我真的很想将我的文件命名为“regionlog.txt”，但它不断出现该错误。有办法解决吗？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-02-28T17:24:53.957

使用正斜杠：

```
'path/regionlog.txt' 
```

或原始字符串：

```
r'path\regionlog.txt' 
```

或者至少避开你的反斜杠：

```
'path\\regionlog.txt' 
```

* * *

`\r`是回车。

* * *

另一种选择：使用`os.path.join`，您根本不必担心斜线：

```
output = os.path.abspath(os.path.join('path', 'regionlog.txt')) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-03-14T11:29:41.530

在 C 标准语言中，`\t`, `\n`,`\r`是转义字符。`\t`是下一个 TAB 位置的横向。`\n`是换行符，`\r`是回车符。您应该使用`\\r`or `/r`，您将解决问题！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-11-21T13:20:41.537

此外，当尝试从 SharePoint 共享驱动器打开大于 50 MB 的文件时，Python 也会给出此消息。

[https://support.microsoft.com/en-us/help/2668751/you-cannot-download-more-than-50-mb-or-upload-large-files-when-the-upl](https://support.microsoft.com/en-us/help/2668751/you-cannot-download-more-than-50-mb-or-upload-large-files-when-the-upl)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2018-01-10T07:20:46.580

另一个简单的解决方案是将文件名路径中的“\r”实例更改为“\R”

# javascript - 如何将 JavaScript 日期初始化为特定时区

> ID：15141762
> 
> 赞同：459
> 
> 时间：2013-02-28T17:22:33.200
> 
> 标签：javascript, timezone

我在特定时区有日期时间作为字符串，我想将其转换为本地时间。但是，我不知道如何在 Date 对象中设置时区。

例如，我有`Feb 28 2013 7:00 PM ET,`然后我可以

```
var mydate = new Date();
mydate.setFullYear(2013);
mydate.setMonth(02);
mydate.setDate(28);
mydate.setHours(7);
mydate.setMinutes(00); 
```

据我所知，我可以设置 UTC 时间或本地时间。但是，如何在另一个时区设置时间？

我尝试使用加/减 UTC 的偏移量，但我不知道如何应对夏令时。我不确定我是否朝着正确的方向前进。

如何在javascript中将时间从不同时区转换为本地时间？

* * *

## 回答 #1

> 赞同：633
> 
> 时间：2013-03-02T05:17:45.367

## 背景

JavaScript 的`Date`对象在内部跟踪 UTC 时间，但通常接受输入并在运行它的计算机的本地时间产生输出。它几乎没有在其他时区处理时间的设施。

对象的内部表示`Date`是单个数字，表示自 以来经过的毫秒数`1970-01-01 00:00:00 UTC`，不考虑闰秒。

### Date 对象本身没有存储时区或字符串格式。

当使用对象的各种功能时`Date`，计算机的本地时区将应用于内部表示。如果该函数产生一个字符串，则可以考虑计算机的区域信息以确定如何产生该字符串。细节因功能而异，有些是特定于实现的。

该`Date`对象可以对非本地时区执行的唯一操作是：

*   它可以解析包含来自任何时区的数字 UTC 偏移量的字符串。它使用它来调整正在解析的值，并存储等效的 UTC。结果`Date`对象中不保留原始本地时间和偏移量。例如：

    ```
     var d = new Date("2020-04-13T00:00:00.000+08:00");
      d.toISOString()  //=> "2020-04-12T16:00:00.000Z"
      d.valueOf()      //=> 1586707200000  (this is what is actually stored in the object) 
    ```

*   在已实现[ECMASCript 国际化 API](https://www.ecma-international.org/ecma-402/)（又名“Intl”）的环境中，`Date`对象可以生成调整为给定时区标识符的特定于语言环境的字符串。这是通过`timeZone`选项 to`toLocaleString`及其变体来实现的。大多数实现将支持 IANA 时区标识符，例如`'America/New_York'`. 例如：

    ```
     var d = new Date("2020-04-13T00:00:00.000+08:00");
      d.toLocaleString('en-US', { timeZone: 'America/New_York' })
      //=> "4/12/2020, 12:00:00 PM"
      // (midnight in China on Apring 13th is noon in New York on April 12th) 
    ```

    大多数现代环境都支持全套 IANA 时区标识符（[请参阅此处的兼容性表](https://kangax.github.io/compat-table/esintl/#test-DateTimeFormat_accepts_IANA_timezone_names)）。但是，请记住，Intl*需要*`'UTC'`支持的唯一标识符是，因此您应该仔细检查是否需要支持较旧的浏览器或非典型环境（例如，轻量级 IoT 设备）。

### 图书馆

有几个库可用于处理时区。尽管它们仍然无法使`Date`对象的行为有所不同，但它们通常实现标准 IANA 时区数据库并提供在 JavaScript 中使用它的函数。现代库使用由 Intl API 提供的时区数据，但较旧的库通常会产生开销，尤其是在 Web 浏览器中运行时，因为数据库可能会变得有点大。其中一些库还允许您有选择地减少数据集，无论是支持哪些时区和/或您可以使用的日期范围。

以下是要考虑的库：

**国际图书馆**

新开发应该从这些实现中选择一种，它们依赖于 Intl API 来获取时区数据：

*   [Luxon](https://moment.github.io/luxon/index.html)（Moment.js 的继任[者](https://momentjs.com/)）
*   [date-fns-tz](https://github.com/marnusw/date-fns-tz)（[date](https://date-fns.org/) -fns 的扩展）

**非国际图书馆**

这些库得到维护，但承担着打包自己的时区数据的负担，这些数据可能非常大。

*   [js-joda/timezone](https://github.com/js-joda/js-joda/tree/master/packages/timezone)（[js-joda 的](https://js-joda.github.io/js-joda/)扩展）
*   [moment-timezone](https://momentjs.com/timezone/) *（[Moment.js](https://momentjs.com/)的扩展）
*   [date-fns-timezone](https://github.com/prantlf/date-fns-timezone)（旧 1.x 的[date-fns](https://date-fns.org/)的扩展）
*   [BigEasy/时区](https://github.com/bigeasy/timezone)
*   [tz.js](https://github.com/dbaron/tz.js)

** 虽然之前推荐 Moment 和 Moment-Timezone，但 Moment 团队现在更喜欢用户选择 Luxon 进行新开发。*

**停产的图书馆**

这些库已正式停产，不应再使用。

*   [WallTime-js](https://github.com/sproutsocial/walltime-js)
*   [时区JS](https://github.com/mde/timezone-js)

### 未来提案

[TC39 时间提案](https://github.com/tc39/proposal-temporal)旨在提供一组新的标准对象，用于在 JavaScript 语言本身中处理日期和时间。这将包括对时区感知对象的支持。

* * *

## 回答 #2

> 赞同：165
> 
> 时间：2018-12-06T13:05:07.763

正如马特约翰逊所说

> 如果您可以限制对现代 Web 浏览器的使用，您现在可以在没有任何特殊库的情况下执行以下操作：
> 
> `new Date().toLocaleString("en-US", {timeZone: "America/New_York"})`

> 这不是一个全面的解决方案，但它适用于许多只需要输出转换的场景（从 UTC 或本地时间到特定时区，而不是另一个方向）。

因此，尽管浏览器在创建日期时无法读取 IANA 时区，或者有任何方法可以更改现有 Date 对象上的时区，但似乎有一个 hack：

```
function changeTimezone(date, ianatz) {

  // suppose the date is 12:00 UTC
  var invdate = new Date(date.toLocaleString('en-US', {
    timeZone: ianatz
  }));

  // then invdate will be 07:00 in Toronto
  // and the diff is 5 hours
  var diff = date.getTime() - invdate.getTime();

  // so 12:00 in Toronto is 17:00 UTC
  return new Date(date.getTime() - diff); // needs to substract

}

// E.g.
var here = new Date();
var there = changeTimezone(here, "America/Toronto");

console.log(`Here: ${here.toString()}\nToronto: ${there.toString()}`);
```

* * *

## 回答 #3

> 赞同：48
> 
> 时间：2019-09-08T13:06:30.280

这应该可以解决您的问题，请随时提供修复。此方法还将考虑给定日期的夏令时。

```
dateWithTimeZone = (timeZone, year, month, day, hour, minute, second) => {
  let date = new Date(Date.UTC(year, month, day, hour, minute, second));

  let utcDate = new Date(date.toLocaleString('en-US', { timeZone: "UTC" }));
  let tzDate = new Date(date.toLocaleString('en-US', { timeZone: timeZone }));
  let offset = utcDate.getTime() - tzDate.getTime();

  date.setTime( date.getTime() + offset );

  return date;
}; 
```

如何使用时区和当地时间：

```
dateWithTimeZone("America/Los_Angeles",2019,8,8,0,0,0) 
```

* * *

## 回答 #4

> 赞同：44
> 
> 时间：2016-02-04T09:33:00.020

您可以在 上指定时区偏移量`new Date()`，例如：

```
new Date('Feb 28 2013 19:00:00 EST') 
```

或者

```
new Date('Feb 28 2013 19:00:00 GMT-0500') 
```

由于`Date`存储UTC时间（即`getTime`以UTC返回），javascript会将时间转换为UTC，并且当您调用诸如`toString`javascript之类的东西时会将UTC时间转换为浏览器的本地时区并返回本地时区中的字符串，即如果我正在使用`UTC+8`：

```
> new Date('Feb 28 2013 19:00:00 GMT-0500').toString()
< "Fri Mar 01 2013 08:00:00 GMT+0800 (CST)" 
```

您也可以使用普通`getHours/Minute/Second`方法：

```
> new Date('Feb 28 2013 19:00:00 GMT-0500').getHours()
< 8 
```

（这`8`意味着将时间转换为我的本地时间`UTC+8`后，小时数是`8`。）

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2018-12-06T03:49:27.103

`getTimezoneOffset`我发现最受支持的方法是通过使用计算适当的时间戳，或更新时间然后使用常规方法获取必要的日期和时间，而不用担心第三方库。

```
var mydate = new Date();
mydate.setFullYear(2013);
mydate.setMonth(02);
mydate.setDate(28);
mydate.setHours(7);
mydate.setMinutes(00);

// ET timezone offset in hours.
var timezone = -5;
// Timezone offset in minutes + the desired offset in minutes, converted to ms.
// This offset should be the same for ALL date calculations, so you should only need to calculate it once.
var offset = (mydate.getTimezoneOffset() + (timezone * 60)) * 60 * 1000;

// Use the timestamp and offset as necessary to calculate min/sec etc, i.e. for countdowns.
var timestamp = mydate.getTime() + offset,
    seconds = Math.floor(timestamp / 1000) % 60,
    minutes = Math.floor(timestamp / 1000 / 60) % 60,
    hours   = Math.floor(timestamp / 1000 / 60 / 60);

// Or update the timestamp to reflect the timezone offset.
mydate.setTime(mydate.getTime() + offset);
// Then Output dates and times using the normal methods.
var date = mydate.getDate(),
    hour = mydate.getHours(); 
```

**编辑**

我以前`UTC`在执行日期转换时使用了方法，这是不正确的。通过将偏移量添加到时间，使用本地`get`函数将返回所需的结果。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2019-10-22T17:38:50.763

对于 Ionic 用户，我对此感到很痛苦，因为`.toISOString()`必须与 html 模板一起使用。

这将获取当前日期，但当然可以添加到选定日期的先前答案中。

我用这个修复了它：

```
date = new Date();
public currentDate: any = new Date(this.date.getTime() - this.date.getTimezoneOffset()*60000).toISOString();
```

*60000 表示 UTC -6，即 CST，因此无论需要什么时区，都可以更改数字和差异。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2017-10-06T15:56:16.227

我在单元测试中遇到了类似的问题（特别是当单元测试在本地运行以创建快照，然后 CI 服务器在（可能）不同的时区运行导致快照比较失败时）。我嘲笑了我们的`Date`和一些支持方法，如下所示：

```
describe('...', () => {
  let originalDate;

  beforeEach(() => {
    originalDate = Date;
    Date = jest.fn(
      (d) => {
        let newD;
        if (d) {
          newD = (new originalDate(d));
        } else {
          newD = (new originalDate('2017-05-29T10:00:00z'));
        }
        newD.toLocaleString = () => {
          return (new originalDate(newD.valueOf())).toLocaleString("en-US", {timeZone: "America/New_York"});
        };
        newD.toLocaleDateString = () => {
          return (new originalDate(newD.valueOf())).toLocaleDateString("en-US", {timeZone: "America/New_York"});
        };
        newD.toLocaleTimeString = () => {
          return (new originalDate(newD.valueOf())).toLocaleTimeString("en-US", {timeZone: "America/New_York"});
        };
        return newD;
      }
    );
    Date.now = () => { return (Date()); };
  });

  afterEach(() => {
    Date = originalDate;
  });

}); 
```

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2019-06-30T13:48:41.503

基于上面的答案，我正在使用这个原生的 one 班轮将长时区字符串转换为三个字母的字符串：

```
var longTz = 'America/Los_Angeles';
var shortTz = new Date().
    toLocaleString("en", {timeZoneName: "short", timeZone: longTz}).
    split(' ').
    pop(); 
```

这将根据提供的日期提供 PDT 或 PST。在我的特定用例中，在 Salesforce（Aura/Lightning）上开发，我们能够从后端获取长格式的用户时区。

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2018-11-01T06:13:47.553

尝试使用 npm 中的 ctoc。 [https://www.npmjs.com/package/ctoc_timezone](https://www.npmjs.com/package/ctoc_timezone)

它具有更改时区的简单功能（大多数时区在 400 左右）以及您希望它显示的所有自定义格式。

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2021-01-03T23:30:55.330

我有同样的问题，但我们可以使用我们想要使用的时
区`.toLocaleDateString()`

例如：

```
var day=new Date();
const options= {day:'numeric', month:'long', year:"numeric", timeZone:"Asia/Kolkata"};
const today=day.toLocaleDateString("en-IN", options);
console.log(today);
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2017-06-02T07:32:34.100

尝试：[date-from-timezone](https://github.com/medikoo/date-from-timezone)，它在 natively available 的帮助下解析预期日期`Intl.DateTimeFormat`。

我已经在我的一个项目中使用了这种方法几年了，但现在我决定将它作为小型操作系统项目发布:)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2021-12-03T15:35:16.197

我在运行 GCP 云功能时遇到了这个问题。当然它可以在本地机器上运行，但是在云中运行会使操作系统默认（本地）变得 `new Date()`无关紧要。就我而言，来自云端的 api 调用需要东部标准时间，采用 ISO 格式（不带“Z”），偏移量为“-0500”或“-0400”，具体取决于 DST，例如：

`2021-12-01T00:00:00.000-0500`

同样，这不是浏览器格式问题，因此我被迫采用这种格式以使 api 调用正常工作。

使用@chickens 代码作为开始，这是有效的：

```
var date = new Date(); 
var now_utc =  Date.UTC(date.getUTCFullYear(), date.getUTCMonth(), date.getUTCDate(),
date.getUTCHours(), date.getUTCMinutes(), date.getUTCSeconds());

var dt = new Date(now_utc);

let utcDate = new Date(dt.toLocaleString('en-US', { timeZone: "UTC" }));
let tzDate = new Date(dt.toLocaleString('en-US', { timeZone: "America/New_York" }));
let offset1 = utcDate.getTime() - tzDate.getTime();
let offset2 = offset1/60000;
let o1 = Math.abs(offset2);
console.log(offset2)
var offsetValue1 =  (offset2 < 0 ? "+" : "-") + ("00" + Math.floor(o1 / 60)).slice(-2) + ("00" + (o1 % 60)).slice(-2);
console.log(offsetValue1)
dt.setTime(dt.getTime() - offset1);

console.log(dt.toISOString());
console.log(dt.toISOString().slice(0,-1)+offsetValue1); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2016-04-14T13:18:49.560

我知道它为时已晚 3 年，但也许它可以帮助其他人，因为除了时刻时区库之外，我没有找到类似的东西，这与他在这里要求的不完全相同。

我为德国时区做了类似的事情，这有点复杂，因为夏令时和闰年你有 366 天。

它可能需要使用“isDaylightSavingTimeInGermany”函数进行一些工作，而不同的时区在夏令时的不同时间会发生变化。

无论如何，请查看此页面： [https ://github.com/zerkotin/german-timezone-converter/wiki](https://github.com/zerkotin/german-timezone-converter/wiki)

主要方法有： convertLocalDateToGermanTimezone convertGermanDateToLocalTimezone

我已经努力记录它，所以它不会那么混乱。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2022-02-02T11:32:48.950

试试这样的，

```
public static getTimezoneOffset(timeZone: string, date = new Date()): number {
    const localDate = date.toLocaleString('fr', { timeZone, timeZoneName: 'long' });
    const tz = localDate.split(' ');
    const TZ = localDate.replace(tz[0], '').replace(tz[1], '').replace(' ', '');
    const dateString = date.toString();
    const offset = (Date.parse(`${dateString} UTC`) - Date.parse(`${dateString}${TZ}`)) / (3600 * 1000);
    return offset;
} 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2021-09-11T17:53:10.633

感谢@commonpike 的回答，我编写了一个函数，它接受一个 ISO 字符串日期（例如`2020-10-10T08:00:00.000`输入）并发送一个包含 2 个主要属性的对象。

第一个是`fromUtc`与作为参数输入的时区相对应的日期。

第二个是`toUtc`允许您格式化源自`fromUtc`.

```
const timeZoneTransformer = (stringDate, timeZone = "Europe/Paris") => {
  const now = new Date();
  const serverDate = new Date(stringDate);
  const utcDate = new Date(
    Date.UTC(
      serverDate.getFullYear(),
      serverDate.getMonth(),
      serverDate.getDate(),
      serverDate.getHours(),
      serverDate.getMinutes(),
      serverDate.getSeconds()
    )
  );
  const invdate = new Date(
    serverDate.toLocaleString("en-US", {
      timeZone,
    })
  );
  const diff = now.getTime() - invdate.getTime();
  const adjustedDate = new Date(now.getTime() - diff);
  return {
    toUtc: utcDate,
    fromUtc: adjustedDate,
  };
};
const fromUtc = timeZoneTransformer("2020-10-10T08:00:00.000").fromUtc;
console.log(fromUtc);
const toUtc = timeZoneTransformer(fromUtc).toUtc;
console.log(toUtc);
```

* * *

## 回答 #16

> 赞同：-1
> 
> 时间：2021-01-31T19:05:53.740

```
//For Mumbai time difference is 5.5 hrs so
city_time_diff=5.5; //change according to your city

let time_now = Date.now();
time_now = time_now + (3600000 * city_time_diff); //Add our city time (in msec);
let new_date = new Date(time_now);
console.log("My city time is: ", new_date); 
```

* * *

## 回答 #17

> 赞同：-4
> 
> 时间：2018-06-14T06:04:47.373

遇到同样的问题，用过这个

Console.log(Date.parse("2018 年 6 月 13 日 10:50:39 GMT+1"));

它将返回您可以检查的毫秒数有 +100 时区初始化英国时间希望它有帮助！

# visual-studio-2010 - 签名时出错：未知错误“-2147012894”

> ID：15141763
> 
> 赞同：4
> 
> 时间：2013-02-28T17:22:40.380
> 
> 标签：visual-studio-2010, vsto, clickonce, digital-certificate, pfx

我有从[https://www.globalsign.co.uk/](https://www.globalsign.co.uk/)购买的 .pfx 证书。我已经用它签署了我的 VSTO（Visual Studio 中的 Excel 加载项项目类型）项目的 ClickOnce 清单，并且一切正常。使用一个月后，我尝试重建我的项目（以前可以工作），现在它给了我一个错误：

> 签名时出错：未知错误“-2147012894”

证书完全有效且未过期，并且手动签名如下完美：SignTool sign /f mycert.pfx /p password somefile.exe

我尝试删除 Personal/Certificates 路径下 certmgr.msc 中的所有证书，但没有帮助。

**以前有人遇到过这种错误吗？有什么建议么？**

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-01T09:47:32.747

令人惊讶的是，修复比预期的要容易......我只需要打开项目文件并删除与签署程序集相关的所有 xml 标记。例如：

```
 <PropertyGroup>
    <SignManifests>true</SignManifests>
  </PropertyGroup>
  <PropertyGroup>
    <ManifestKeyFile>mycert.pfx</ManifestKeyFile>
  </PropertyGroup>
  <PropertyGroup>
    <ManifestCertificateThumbprint>AB3S6</ManifestCertificateThumbprint>
  </PropertyGroup>
  <PropertyGroup>
    <ManifestTimestampUrl>http://timestamp.globalsign.com/scripts/timstamp.dll</ManifestTimestampUrl>
  </PropertyGroup> 
```

之后，我只是转到签名选项卡并重新添加了证书。这奏效了。希望这将有助于将来的某人。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-28T22:17:05.150

我猜想您构建项目时使用的证书与手动签名时使用的证书不同，否则它会起作用。

转到项目的项目属性，然后单击“签名”选项卡并查看。如果您仍然认为它是正确的，请单击“从文件中选择”并再次选择 pfx 文件以强制重新加载，然后再试一次。

# android - 在 Google Play 上销售适用于 Android 的插件

> ID：15141774
> 
> 赞同：2
> 
> 时间：2013-02-28T17:23:33.833
> 
> 标签：android, plugins, google-play

我是开发 Android 应用程序的新手，我对一个项目有一个想法，该项目涉及一个免费的基础应用程序和一些用户必须购买的插件。据我所知，我应该将插件打包为主应用程序将访问的服务，我对如何实现这一点有一个模糊的概念。

这是我的问题。

是否可以出售这些`plugins`，`Google Play store`更重要的是，我如何确保用户只有在安装了基本应用程序后才能购买插件？

或者有没有办法指定基础应用程序将与`plugin`?

我已经阅读了有关过滤器的信息，但不知何故，我似乎无法为该任务找到合适的过滤器。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T17:34:48.933

> 是否可以在 Google Play 商店中出售这些插件

是的。GO Launcher 正是为主题做的。主题可以由第三方开发者搭建，用户可以下载使用

> 一旦安装了基本应用程序，我将如何确保用户只能购买插件？

没有选项可以执行此操作。您可以做的最好的事情是在安装和运行您的应用程序时检查您的基本应用程序，如果未安装，则提示用户安装它。

# android - PhoneGap Android - 来自现有代码的 Android 项目导致以下项目名称 __PACKAGE__.__ACTIVITY__

> ID：15141776
> 
> 赞同：2
> 
> 时间：2013-02-28T17:23:38.287
> 
> 标签：android, cordova

经过PhoneGap Android 教程后，我终于得到了“创建”命令的工作。现在，当我通过“现有代码中的 Android 项目”向导将项目添加到 Eclipse 时，它​​没有正确的项目名称或包名称。

**包装**._*活动*_

但是我使用了下面的创建命令，所以项目名称不应该是那个。

C:\Users\kyle.jones\Downloads\cordova-2.4.0-src\cordova-2.4.0\cordova-android\bin>创建 C:\Users\kyle.jones\Downloads\cordova-2.4.0-src \cordova-2.4.0\cordova-android\kyle\adcraffle com.25k.adcraffle adcraffle

编辑 - 当我运行 create 命令时，我意识到控制台输出中隐藏了一个错误。如果这是罪魁祸首，我将调查此错误并删除此问题。

Microsoft (R) Windows Script Host 版本 5.8 版权所有 (C) Microsoft Corporation。版权所有。

```
Creating new android project...
Building jar and js files...
Copying template files...
Copying js, jar & config.xml files...
Creating appinfo.jar...
Copying cordova command tools...
Updating AndroidManifest.xml and Main Activity...
C:\Users\kyle.jones\Downloads\cordova-2.4.0-src\cordova-2.4.0\cordova-android\bi
n\create.js(31, 5) Microsoft JScript runtime error: Path not found 
```

# erlang - to_erl 程序输出

> ID：15141778
> 
> 赞同：2
> 
> 时间：2013-02-28T17:23:50.197
> 
> 标签：erlang, erlang-shell

当我尝试使用以下命令连接到 Erlang shell 时：

```
to_erl /tmp/erlang.pipe.1 
```

该命令的输出是这样的：

```
Attaching to /tmp/erlang.pipe.1 (^D to exit)

(search)`':     
(node@mypc)1> 
```

那个“（搜索）`'：”是什么？

我使用以下命令启动要附加到的 Erlang 节点：

```
run_erl -daemon /tmp/ /tmp "erl -sname node" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T08:45:42.633

我认为这是 OTP-10739 项中提到的 shell 搜索[历史](http://www.erlang.org/doc/apps/kernel/notes.html#id79834)。我认为这应该被视为一个错误并报告给 erlang-patches 邮件列表。

# android - 在列表视图中显示数据库中的数据

> ID：15141780
> 
> 赞同：0
> 
> 时间：2013-02-28T17:24:00.410
> 
> 标签：android, sqlite

这是我的数据库代码，我想从我的数据库中检索名称并将其显示在 listview 中，该名称在下面发布为 profilelist.jar 的另一个 java 文件中。但我无法做到，请告诉我这段代码是否正确？

```
package a.vaccination;

import android.annotation.TargetApi;
import android.content.ContentValues;
import android.content.Context;
import android.database.Cursor;
import android.database.SQLException;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteOpenHelper;
import android.os.Build;
import android.util.Log;

@TargetApi(Build.VERSION_CODES.JELLY_BEAN)
public class datahandler {

    public static final String KEY_ROWID = "id";
    public static final String KEY_name = "name";
    public static final String KEY_dob = "dob";
    public static final String KEY_contact = "contact";
    public static final String KEY_email = "email";
    private static final String TAG = "DBAdapter";

    private static final String DATABASE_NAME = "profile";
    private static final String DATABASE_TABLE = "baby";
    private static final int DATABASE_VERSION = 2;

    private static final String DATABASE_CREATE = "create table if not exists"
            + DATABASE_TABLE
            + "(id integer primary key autoincrement, "
            + "name VARCHAR not null, dob date, contact VARCHAR, email  
VARCHAR);";
    private final Context context;

    private DatabaseHelper DBHelper;
    private SQLiteDatabase db;

    public datahandler(Context ctx) {
        this.context = ctx;
        DBHelper = new DatabaseHelper(context);
    }

    protected static class DatabaseHelper extends SQLiteOpenHelper {
        DatabaseHelper(Context context) {
            super(context, DATABASE_NAME, null, DATABASE_VERSION);
        }

        @Override
        public void onCreate(SQLiteDatabase db) {
            // TODO Auto-generated method stub
            try {
                db.execSQL(DATABASE_CREATE);
                // db = DBHelper.getWritableDatabase();
                Log.i(DATABASE_NAME, "create");
            } catch (SQLException e) {
                e.printStackTrace();
            }
        }

        @Override
        public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
            // TODO Auto-generated method stub
            Log.w(TAG, "Upgrading database from version " + oldVersion + " to "
                    + newVersion + ", which will destroy all old 
data");
            db.execSQL("DROP TABLE IF EXISTS contacts");
            onCreate(db);
        }
    }

    // ---opens the database---
    public datahandler open() throws SQLException {
        db = DBHelper.getWritableDatabase();
        return this;
    }

    // ---closes the database---
    public void close() {
        DBHelper.close();
    }

    // ---insert a record into the database---
    public long insertRecord(String name, String dob, String contact,
            String email) {
        ContentValues initialValues = new ContentValues();
        initialValues.put(KEY_name, name);
        initialValues.put(KEY_dob, dob);
        initialValues.put(KEY_contact, contact);
        initialValues.put(KEY_email, email);
        Log.i(DATABASE_NAME, "values added");
        return db.insert(DATABASE_TABLE, null, initialValues);

    }

    // ---updates a record---
    public boolean updateRecord(long rowId, String name, String dob,
            String contact, String email) {
        ContentValues args = new ContentValues();
        args.put(KEY_name, name);
        args.put(KEY_dob, dob);
        args.put(KEY_contact, contact);
        args.put(KEY_email, email);
        return db.update(DATABASE_TABLE, args, KEY_ROWID + "=" + rowId, null) > 0;
    }

    public Cursor getAllTitles() {
        return db.query(DATABASE_TABLE, new String[] { KEY_ROWID, KEY_name,
                KEY_dob, KEY_contact, KEY_email }, null, null, null, null,
                null, null);
    }

    // ---retrieves a particular title---

    public Cursor getTitle(long rowId) throws SQLException {
        Cursor mCursor = db.query(true, DATABASE_TABLE, new String[] {
                KEY_ROWID, KEY_name, KEY_email, KEY_dob, KEY_contact },
                KEY_ROWID + "=" + rowId, null, null, null, null, null, 
null);
        if (mCursor != null) {
            mCursor.moveToFirst();
        }
        return mCursor;
    }

    public void getReadableDatabase() {
        // TODO Auto-generated method stub
        Cursor cur = db
                .rawQuery("select rowid _id,* from DATABASE_TABLE", null);
    }
} 
```

profilelist.java

```
package a.vaccination;

import android.app.Activity;
import android.content.Intent;
import android.database.Cursor;
import android.os.Bundle;
import android.support.v4.widget.SimpleCursorAdapter;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemClickListener;
import android.widget.Button;
import android.widget.ListView;
import android.widget.Toast;

//this shows profies of baby and option of add new one
public class profilelist extends Activity implements OnItemClickListener {

    datahandler db = new datahandler(this);
    SimpleCursorAdapter adapter = null;
    Cursor c;

    @SuppressWarnings("deprecation")
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.child);

        Button add = (Button) findViewById(R.id.button1);
        add.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View v) {
                // navigate to create profile
                Intent it = new Intent(profilelist.this, 
createprofile.class);
                startActivity(it);

            }
        });

        db.open();
        Cursor c = db.getAllTitles();
        if (c.moveToFirst()) {
            do {
                DisplayRecord(c);
            } while (c.moveToNext());
        }
        db.close();

        // ---get a Record---
        db.open();
        c = db.getTitle(2);
        if (c.moveToFirst())
            DisplayRecord(c);
        else
            Toast.makeText(this, "No Assignments found", Toast.LENGTH_LONG)
                    .show();
        db.close();

    }

    public void DisplayRecord(Cursor c) {
        // TODO Auto-generated method stub
        Toast.makeText(
                this,
                "id: " + c.getString(0) + "\n" + "name: " + c.getString(1)
                        + "\n" + " dob: " + c.getString(2) + 
"contact"
                        + c.getString(3) + "email" + 
c.getString(4),

                Toast.LENGTH_SHORT).show();
        String[] columns = new String[] { datahandler.KEY_name };
        int[] to = new int[] { R.id.name };
        adapter = new SimpleCursorAdapter(this, R.layout.child, c, columns,
                to, 0);
        ListView names = (ListView) findViewById(R.id.listView1);
        names.setAdapter(adapter);
        names.setOnItemClickListener(this);

    } 
```

我在 a.vaccination.datahandler.getTitle(datahandler.java:115) 和 a.vaccination.profilelist.onCreate(profilelist.java:67) java.lang.NoSuchMethodError: android.database.sqlite.SQLiteDatabaseb.query我在上面提供了 profilelist.java 和 datahandler.java

请帮助我，我严重卡在这里 @Override public void onItemClick(AdapterView arg0, View arg1, int arg2, long arg3) { // TODO 自动生成的方法存根

```
 Intent i = new Intent(profilelist.this, vaccination.class);
        startActivity(i);
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T18:06:25.100

您想使用像[SimpleCursorAdapter](http://developer.android.com/reference/android/widget/SimpleCursorAdapter.html)这样的 CursorAdapter 。您将列映射传递给视图 ID 以及它处理的绑定等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T17:35:46.420

我最近实现了这种类型的功能。基本上，您必须创建一个自定义 BaseAdapter 才能在 ListView 中显示您的数据。在适配器构造函数中，您传入包含数据的对象数组。我过去的教程是： [http](http://www.vogella.com/articles/AndroidListView/article.html) ://www.vogella.com/articles/AndroidListView/article.html 。希望这可以帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T17:57:50.983

要回答您的第一个和第二个问题：“不，此代码确实不好”。你真的*必须*考虑使用加载器。虽然您所写的内容可能在大多数情况下都有效，但您很可能会产生 Application Not Responding 错误，这些错误会突然终止您的应用程序。不要在 UI 线程上做这些事情。

有许多令人惊讶的 Android 编程。我真的建议你在把自己画到一个角落之前，先阅读一本关于如何做到这一点的标准书籍。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-10-03T19:18:29.493

您需要创建 SimpleCursorAdapter 并将其附加到从您的数据库自定义查询选择返回的光标。然后将从光标返回的数据列映射到您的自定义视图以进行显示。要了解更多信息，请**单击** [此处](http://www.mysamplecode.com/2012/07/android-listview-cursoradapter-sqlite.html)，这为您的问题提供了正确的实施

# php - Joomla PHP elseif将页面重定向回自身

> ID：15141781
> 
> 赞同：0
> 
> 时间：2013-02-28T17:24:00.273
> 
> 标签：php, joomla

由于某些 php 代码不断将其重定向到自身，我无法弄清楚如何让一个页面在不重定向到自身的情况下单击它的链接。

```
$option = $_GET[option];
$view = $_GET[view];

if (!$option) {
    include "include/index_main.php"; // INDEX MAIN TOP FILE
} 
elseif ($option == 'com_newsfeeds' and $view == 'newsfeed') {
    include "include/news.php"; // NEWS FILE
} 
elseif ($option == 'com_content' and $view == 'category') {
    switch($_GET[id]) {
        case '75':
            include "include/children_list.php"; // Children List FILE
            break;
        case '77':
            include "include/food_for_kids.php"; // Food 4 Kids page
            break;
        case '76':
            include "include/water_for_life.php"; // Water for Life page
            break;
        default:
            if (empty($_GET[listing_id]) || $_GET[listing_id] == '') {
                include "include/projects.php"; // Projects FILE
                break;  
            }
            else {
                include "include/project_list.php"; // Project Listing FILE 
                break;
            }
    }   
}
elseif... ... ... 
```

当页面没有任何指向它自己的类别的链接时，这很有效，但是带有标记的地图都有似乎被重定向回页面而不是它们应该去的地方的链接。

问题在于*案例'76'：*部分

据我所知，当类别 id 为 76 时，php 调用 water_for_life.php 包含。不幸的是，它没有区分：

```
.org/index.php?option=com_content&view=category&id=76 
```

和

```
.org/index.php?option=com_content&view=category&id=76&listing_id=76&sid=dl94q3tlfqr2s58c3u1mfnf1t1 
```

所以毕竟，我想我的问题是：

****一旦有人单击具有如下链接的链接，有****没有办法将其一直跳过到**include/project_list.php ：**

 ****```
.org/index.php?option=com_content&view=category&id=76&listing_id=76&sid=dl94q3tlfqr2s58c3u1mfnf1t1 
```

?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T17:31:22.073

你的意思是这样的？请注意，它适用于与 id 无关的所有情况，无论是 76 还是 77 或其他

```
...
elseif ($option == 'com_content' and $view == 'category') {
if (!empty($_GET['listing_id'])) {
    include "include/project_list.php"; // Project Listing FILE 
}
else {
  switch($_GET['id']) {
    case '75':
        include "include/children_list.php"; // Children List FILE
        break;
    case '77':
        include "include/food_for_kids.php"; // Food 4 Kids page
        break;
    case '76':
        include "include/water_for_life.php"; // Water for Life page
        break;
    default:
        include "include/projects.php"; // Projects FILE
        break;  
    } 
}
... 
```****

# c++ - Matlab和c ++矩阵乘积：相同的输入，不同的输出

> ID：15141784
> 
> 赞同：0
> 
> 时间：2013-02-28T17:24:09.157
> 
> 标签：c++, matlab, double-precision

我在 x86 计算机上的 ubuntu 12.04 和 g++ 4.6.3 中使用 Matlab 2010。这就是我进行生产和输入的方式：

```
 #include <Src/Tools/Math/Matrix_nxn.h>
   #include <iostream>
   using namespace std;
   int main()
   {
      Matrix_nxn<double,4> A1,A2,Tb,aa;
      A1[0][0] = 0.99958087959447828;   A1[0][1] = 1.7725781974830023e-18;A1[0][2] = 0.028949354900049871;  A1[0][3] = 0;
      A1[1][0] = -0.028949354900049871; A1[1][1] = 6.1204654815537932e-17;A1[1][2] = 0.99958087959447828;   A1[1][3] = 0;
      A1[2][0] = 0,           A1[2][1] = -1;            A1[2][2] = 6.1230317691118863e-17;A1[2][3] = 0.21129000000000001;
      A1[3][0] = 0,           A1[3][1] = 0;         A1[3][2] = 0;             A1[3][3] = 1;

      A2[0][0] = 0.90634806393366396;   A2[0][1] = -0.42253187690835708;A2[0][2] = 0;A2[0][3] = 0;
      A2[1][0] = 0.42253187690835708;   A2[1][1] = 0.90634806393366396; A2[1][2] = 0;A2[1][3] = 0;
      A2[2][0] = 0;           A2[2][1] = 0;           A2[2][2] = 1;A2[2][3] = 0;
      A2[3][0] = 0;           A2[3][1] = 0;           A2[3][2] = 0;A2[3][3] = 1;

      Tb[0][0] = 0.99956387949834924; Tb[0][1] = -0.00016363183229951183;   Tb[0][2] = -0.029530052943282908; Tb[0][3] = 0;
      Tb[1][0] = 0;         Tb[1][1] = 0.99998464792303143; Tb[1][2] = -0.0055411116439683869;Tb[1][3] = 0;
      Tb[2][0] = 0.029530506297888514;Tb[2][1] = 0.0055386950515785164; Tb[2][2] = 0.99954853411673616;   Tb[2][3] = 0;
      Tb[3][0] = 0;         Tb[3][1] = 0;           Tb[3][2] = 0;             Tb[3][3] = 1;

   aa = Tb*A1*A2;
   cout.precision(25);
   cout <<aa[0][0]<<'   '<<aa[0][1]<<'  '<<aa[0][2]<<'  '<<aa[0][3]<<endl
        <<aa[1][0]<<'   '<<aa[1][1]<<'  '<<aa[1][2]<<'  '<<aa[1][3]<<endl
        <<aa[2][0]<<'   '<<aa[2][1]<<'  '<<aa[2][2]<<'  '<<aa[2][3]<<endl
        <<aa[3][0]<<'   '<<aa[3][1]<<'  '<<aa[3][2]<<'  '<<aa[3][3]<<endl;
} 
```

这是 的定义`operator*`：

```
Matrix_nxn<T, N> res;
size_t i, j, k;
for (i = 0; i < N; ++i)
{
  for (j = 0; j < N; ++j)
  {
    for (k = 0; k < N; ++k)
    {
      res[i][j] += m1[i][k] * m2[k][j];
    }
    if (MVTools::isNearInf(res[i][j]))
    {
      if (MVTools::isNearPosInf(res[i][j]))
        throw MVException(MVException::PosInfValue);
      else
        throw MVException(MVException::NegInfValue);
    }
  }
}
return res; 
```

奇怪的是，我在 Matlab 中制作了具有相同值的相同矩阵，但得到了不同的结果。这是 Matlab 代码：

```
Tb = [0.99956387949834924,-0.00016363183229951183,-0.029530052943282908,0;0,0.99998464792303143,-0.0055411116439683869,0;0.029530506297888514,0.0055386950515785164,0.99954853411673616,0;0,0,0,1];
A1 = [0.99958087959447828,1.7725781974830023e-18,0.028949354900049871,0;-0.028949354900049871,6.1204654815537932e-17,0.99958087959447828,0;0,-1,6.1230317691118863e-17,0.21129000000000001;0,0,0,1];
A2 = [0.90634806393366396,-0.42253187690835708,0,0;0.42253187690835708,0.90634806393366396,0,0;0,0,1,0;0,0,0,1];
aa = Tb*A1*A2;
aa - aaa

ans =

   1.0e-16 *

               0  -0.555111512312578                   0                   0
               0                   0                   0                   0
               0                   0                   0                   0
               0                   0                   0                   0 
```

而 aaa 是 c++ 实现的输出。我知道错误很小，但我想知道导致问题的原因！我想调试很多代码，我需要零差异才能进行良好的调试。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T17:36:26.740

不同值的原因（无论它可能多么微不足道）是matlab使用的算法和你*不*一样。

您的算法是简单的`O(N^3)`矩阵乘法。有一些特殊算法可以有效地计算小尺寸矩阵，也有一些复杂算法具有比 更好的渐近行为`O(N^3)`。

如果你有兴趣，请看：

*   [Laderman 的 3x3 矩阵乘法只有 23 次乘法，值得吗？](https://stackoverflow.com/questions/10827209/ladermans-3x3-matrix-multiplication-with-only-23-multiplications-is-it-worth-i)
*   [http://en.wikipedia.org/wiki/Strassen_algorithm](http://en.wikipedia.org/wiki/Strassen_algorithm)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T17:30:01.917

我看到您期望 C++ 代码的精度为 25 位。这不太可能使用该`double`类型。使用 25 位数字可以获得更好的精度，`long double`但可能不如 25 位数字。

请参阅：[C++ 中 long double 的精度是多少？](https://stackoverflow.com/questions/476212/what-is-the-precision-of-long-double-in-c)

# google-api - 使用适用于 Python 的 Google API 客户端库通过批处理请求插入权限

> ID：15141786
> 
> 赞同：2
> 
> 时间：2013-02-28T17:24:29.750
> 
> 标签：google-api, google-drive-api, google-api-python-client, google-drive-realtime-api

我从适用于 Python 的 Google API 客户端库开始。我正在使用 Drive API 进行开发。我正在将我的 Web 应用程序从已弃用的 Document List API v3 迁移到 Drive API V2。

当我通过 BatchHttpRequest 在文档上添加一些权限时，只有其中一个权限被有效地添加到文档中。其他的被忽略。

下面是一个示例代码：

```
def callback(request_id, response, exception):
    if exception is not None:
        logger.debug(exception)
    else:
        logger.debug(response)

batch = BatchHttpRequest(callback)  # from apiclient.http
batch.add(drive_client.permissions().insert(body=permission_1))
batch.add(drive_client.permissions().insert(body=permission_2))
...
batch.add(drive_client.permissions().insert(body=permission_n))
batch.execute() 
```

仅添加用户权限。默认条目（“任何人”）被忽略。响应总是被记录下来，所以一切似乎都运行良好。

如果我分别执行每个调用，则会添加所有权限。

# mysql - 使用 Where 进行 SQL 查询时出错

> ID：15141788
> 
> 赞同：0
> 
> 时间：2013-02-28T17:24:33.863
> 
> 标签：mysql, sql, where

我试图进行查询，显示**ZIP 为 1391、1393、1396、1426、1427 的地址以及 3400 和 3433 之间的所有 zip。**

```
SELECT ZIP, HOUSE_NR, APPARTMENT_NR, VerzBedrag
FROM werkelijke_inboedels
WHERE ProductLine = 'inboedel'
AND Product_Option = 'Inboedel All Risk' OR 'Inboedel Extra Uitgebreid'
AND ZIP = %'1391'% OR %'1393'% OR %'1396'% OR %'1426'% OR %'1427'%
AND ZIP > %'3400'%
AND ZIP < %'4133'% 
```

有人可以更改正确的查询吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-28T17:26:38.377

您只需要按预期使用`IN`和处理查询。*这里不需要模式匹配。*`BETWEEN`

 *```
SELECT  *
FROM    tableName
WHERE   ProductLine = 'inboedel' AND 
        Product_Option IN ('Inboedel All Risk','Inboedel Extra Uitgebreid') AND
        (
            ZIP IN (1391, 1393, 1396, 1426, 1427) OR
            ZIP BETWEEN 3400 AND 3433
        ) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-28T17:27:08.957

```
AND ZIP IN ('1391', '1393', '1396', '1426', '1427')
OR  ZIP BETWEEN  '3400' AND '4133' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T17:27:23.713

通配符放在引号内：

```
'%1391%' 
```

这些与 LIKE 运算符一起使用。*

# python - pandas 和文件系统可以替代数据库吗？

> ID：15141789
> 
> 赞同：3
> 
> 时间：2013-02-28T17:24:34.420
> 
> 标签：python, database, pandas

我使用熊猫来处理数据。我喜欢这种方法，因为在 pandas 中操作数据非常容易（选择行、添加行、删除列、分组依据、连接表等）。

我的问题是，如果数据量很大，pandas 是否也是一个好方法。特别是我担心修改和提取数据。在我可以修改数据或从数据中提取某些内容之前，我需要从文件中读取（加载）数据，然后，在完成我想做的事情（选择或修改）之后，我需要将数据保存回文件中。恐怕数据的这种“加载”和“保存”对于大数据来说可能会很慢。通过大量数据，我了解数亿行。

特别是，我的问题是熊猫是否可以用作数据库的替代品（例如 SQLite 或 MySQL）。或者，与在保存为文件的相应数据框中查找相同行相比，使用 MySQL 的 python 接口在巨大的表（保存在 MySQL 数据库中）中查找特定行会更快吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-01T02:15:52.567

由于 pandas 0.10.1 可以使用 HDFStore 预选磁盘：

```
import pandas as pd
import numpy.random as rd

df = pd.DataFrame(rd.randn(int(1e6)).reshape(int(1e5), 10), columns=list('abcdefghij'))
store = pd.HDFStore('newstore.h5')

# only data columns can serve as indices to select for on-disk, but there's a 
# speed penalty involved, so it's a conscious decision what becomes data_column!
store.append('df', df, data_columns=['a','b']) 
```

以下事情发生在“磁盘上”（并且非常酷！;）

```
In [14]: store.select('df', ['a > 0', 'b > 0'])
Out[14]: 
<class 'pandas.core.frame.DataFrame'>
Int64Index: 24747 entries, 2 to 99998
Data columns:
a    24747  non-null values
b    24747  non-null values
c    24747  non-null values
d    24747  non-null values
e    24747  non-null values
f    24747  non-null values
g    24747  non-null values
h    24747  non-null values
i    24747  non-null values
j    24747  non-null values
dtypes: float64(10)

In [15]: store.select('df', ['a > 0'])
Out[15]: 
<class 'pandas.core.frame.DataFrame'>
Int64Index: 50043 entries, 0 to 99999
Data columns:
a    50043  non-null values
b    50043  non-null values
c    50043  non-null values
d    50043  non-null values
e    50043  non-null values
f    50043  non-null values
g    50043  non-null values
h    50043  non-null values
i    50043  non-null values
j    50043  non-null values
dtypes: float64(10) 
```

因此，您现在要做的就是增加数据框的维度数量，并亲自查看它是否足够快以满足您的需求。这很容易玩！

# ruby-on-rails - 将对象保存到会话之前的验证

> ID：15141790
> 
> 赞同：0
> 
> 时间：2013-02-28T17:24:39.870
> 
> 标签：ruby-on-rails, validation

我有一个想要保存到的 Post 对象`session[:post].`

在我的**Post.rb**中，我有：

```
class Post < ActiveRecord::Base
  validates :link, presence: true, url: true 
```

我想在将我**的帖子对象保存到会话**（而不是数据库）之前使用此验证。有没有办法做到这一点？

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T17:26:32.220

```
post = Post.new(args)
if post.valid?
  # save to session
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T17:27:05.203

`post.valid?`在将对象保存到会话之前调用对象的方法？

# opencv - 如何使用实时摄像头分割盲文文字？

> ID：15141796
> 
> 赞同：0
> 
> 时间：2013-02-28T17:24:50.473
> 
> 标签：opencv, image-processing, image-segmentation, braille

我是一名本科生，目前正在使用实时相机进行光学盲文识别的最终项目。我已成功将图像处理为 HSV 格式并仅提取 HSV 图像的值以防止环境光影响图像，执行二进制阈值、canny 边缘检测、腐蚀和膨胀以仅从相机中获取盲文点.

我想问的是如何在每个点之间的距离总是随着相机靠近或远离盲文文字而变化的问题中执行分割？

任何援助将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T18:08:12.573

您的问题没有简单、通用的解决方案。当然，如果*我*不能立即理解这些盲文字母是如何隔开的，那么简单的算法也不会轻易解决。

![在此处输入图像描述](../Images/d1a51583fc3ff95d3cb20db2315ab0a0.png)

最好的办法是阅读有关盲文文本的文献，与您的教授交谈，并让盲人向您解释他们是如何阅读盲文的。

除此之外，您必须找到盲文文本行的基线并查看它们的不同之处，然后运行 ​​cvPerspectiveTransform 以理顺图像，这样您就可以在不考虑透视的情况下分割点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T17:26:52.337

为此，您将检测某种相对坐标对，使您能够检测图像中盲文书写的“比例”。这可以是文字两端的一对识别点，甚至只是一些特征点。使用比例，您可以将图像转换为统一大小，具体取决于相机的距离。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T18:41:06.337

这个挑战与我在条形码系统中遇到的问题非常相似。我的回答是对我使用的方法的概括描述。

我首先将图像划分为一个网格，其中单个字符单元格将适合单个网格单元格。这将保证任何字符都适合 2x2 网格单元格，无论网格如何覆盖图像。

将图像转换为点。通过使用小区域像素的局部识别来识别点。

为每个点分配一个网格单元编号。这应该很简单，例如 x/y 位置除以 32 像素单元 ((y/32)*(width/32))+(x/32)

保留每个网格单元格的点数，当所有点都被识别时，按网格数对点表进行排序，并根据表中的位移和元素数建立索引。

如果分辨率不同，请对一些带有大量点的细胞进行采样，以确定细胞对之间的距离。

逐行查看单元格，但使用 2x2 单元格组检查每个单元格。这样，被测试单元格中的任何点都可以保证与成对的点匹配（如果存在的话）。通过使用网格点只需要匹配到彼此局部的点，因此虽然图像可能有数千个点，但单个点只需要尝试匹配到 1-10 个点。

配对点将创建重复，可以在匹配时防止或稍后清除。

此时，您需要将点与盲文匹配。水平对和垂直对应该能够开始排列盲文文本。

一旦线条对齐，斑点表将旋转到确定的文本对齐方式。这些对将被对齐，然后从对的位置，可以通过将对的网格位置匹配到点表中的未配对点来添加未匹配的斑点。

# gdb - gdb: malloc(): 内存损坏（快速）：

> ID：15141800
> 
> 赞同：0
> 
> 时间：2013-02-28T17:24:55.280
> 
> 标签：gdb

执行 gdb> core-file 时，gdb 给出以下错误，然后在创建核心文件时崩溃：

```
Reading symbols from ./libtcmalloc_minimal.so.0...
*** glibc detected *** gdb: malloc(): memory corruption (fast): 0x0000000000ec04a0 *** 
```

我没有发现任何关于 gdb 因此错误而崩溃的参考。有没有人遇到过这个？如果是这样，可以做些什么。

GDB的版本是：GNU gdb (GDB) SUSE (6.8.50.20090302-1.5.18)

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T17:37:37.477

> 可以做些什么

GDB 本身的任何崩溃*都是*一个错误。

但是，没有人会关心这个错误，除非它可以用*当前的*GDB 重现（你的 GDB 已经 5 岁了）。

因此，[下载](http://www.gnu.org/software/gdb/download/)当前版本的 GDB（当前为 7.5.1）并构建它。

如果它有效，请使用它来调试您的问题。

如果它不起作用，请在 GDB [bugzilla](http://sourceware.org/bugzilla/enter_bug.cgi?product=gdb)中提交错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-03T19:50:40.000

如果您因调用而收到此错误

```
ptr = (ptr_t*)malloc(sizeof(ptr_t)); 
```

在您的程序中，可能是由于缺少 stdlib.h 标头。

# c++ - 有序双链表

> ID：15141806
> 
> 赞同：0
> 
> 时间：2013-02-28T17:25:10.617
> 
> 标签：c++, list, struct

我正在尝试按其姓氏字段排序记录列表，该字段类型为 char 数组，我在我的算法中使用 strcmp() 函数，但我无法找出出错的地方.. 该函数添加到前面并添加到返回功能工作正常，这只是中间的添加，我得到像这样的输出

输入顺序 0 - 升序，1 - 降序：0 2 5 3 4 6

如果这里的任何人都可以看到问题，请给我留言！

Main.cpp（基本上只是菜单）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T17:46:10.293

您忘记在查找列表的 while 循环中更新 s2 和 s3 （据我所知，s1 没有变化）。

移动

```
while(current!=last && x!=1)
{ 
```

增加两到三行可能会奏效。

您还应该检查循环后的 if 块是否是必要的。

# vb.net - VB.net 游戏使用图片框功能

> ID：15141807
> 
> 赞同：-6
> 
> 时间：2013-02-28T17:25:11.127
> 
> 标签：vb.net, function, image

我正在尝试使用图片框开发一个简单的游戏

例如，如果您有 3 个不同的图片框，每个图片框都包含一个独特的图片 当加载表单时，一个框可见，而另外两个不可见 玩家必须在可见的图片框变为不可见之前单击它（为框指定时间保持可见）

示例：框 1 保持可见 5 秒，如果在 5 秒内没有单击框，框 1 变为不可见，另一个随机框将变为可见。当然，如果用户点击图片成功，他的分数就会被更新，可以通过缩短时间来制作不同的级别。

该代码可能是放置在表单加载中的一个代码有帮助吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T17:48:06.893

我可能会使用秒表 - 计时器会很困难，因为我不知道当用户成功点击时将计数重置回 0 的方法。

像这样声明一个秒表：

```
Private maxWaitTimer As New Stopwatch 
```

然后，也许可以在您的表单加载事件中使用“游戏循环”类型的东西......也许是这样的：

```
maxWaitStopwatch.Start()

While(GameIsRunning)
    If maxWaitStopwatch.ElapsedMilliseconds > 5000 Then
        Losses = Losses + 1
        selectNewPictureBox()
        maxWaitStopwatch.Restart()
    Else
        Application.DoEvents() 'this gives the program a chance to execute the picture box click event, among other things (resize, drag, etc... since we are spinning in a loop)    
    End If
    'System.Threading.Thread.Sleep(100) 'uncommenting this line will prevent it from maxing out your processor, although it will be slightly less responsive
End While 
```

你的图片框可以实现这样的东西：

```
Wins = Wins + 1
selectNewPictureBox()
maxWaitStopwatch.Restart() 
```

基本上，您的程序在一个循环中旋转，检查计时器是否已过，如果是，则移动图片。

点击事件增加分数 - 它有机会在循环的“application.doevents()”部分运行。

添加 sleep(100) 会稍微减慢它的速度（并使它稍微不准确，大约 100 毫秒），但它会阻止它使用大量的 CPU。您可能不会注意到速度的差异。

不过，可能有更好的方法来做到这一点......

* * *

编辑 - 反映史蒂文所说的，如果你使用计时器而不是循环会更好：

用户点击图片时使用stop()，之后调用start()。

（我没有意识到这会重置它，但显然它确实如此）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T19:53:30.217

使用间隔为 5000 的计时器，然后在经过的事件处理程序中

```
Timer.stop()
Losses = Losses + 1
selectNewPictureBox()
Time.start() 
```

然后在图片框处理程序中

```
Timer.stop()
Wins = Wins + 1
selectNewPictureBox()
Timer.start() 
```

# tmux - tmux 中的 Ctrl-C 关闭窗口窗格但不退出 tail -F

> ID：15141809
> 
> 赞同：2
> 
> 时间：2013-02-28T17:25:16.400
> 
> 标签：tmux

我有以下脚本可以根据我的开发环境启动和设置 tmux：

```
#!/bin/bash

ENV="Test"
TMUX_SESSION="${ENV}LogMonSes"
TMUX_WINDOW="${ENV}LogMonWin"

tmux new-session -d -n "$TMUX_WINDOW" -s "$TMUX_SESSION" "ssh server1 tail -F /var/log/tomcat/application.log"
tmux split-window -v "ssh server2 sudo tail -F /var/log/postgresql/postgresql.log"
tmux attach-session -d -t "$TMUX_SESSION" 
```

当我想退出 tmux 时，我按 Control-C 来杀死尾巴。这似乎会关闭窗格，但不会终止尾部进程。如果我重新登录到服务器，我会看到一堆没有被杀死的尾进程，我被迫手动执行。关于如何让 Control-C 杀死尾部进程的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T17:43:18.543

“问题”在于 ssh - 而不是 tmux。

请参阅[为什么我的远程进程在终止 ssh 会话后仍然运行？](https://superuser.com/questions/20679/why-does-my-remote-process-still-run-after-killing-an-ssh-session)

添加`-t`到 ssh，现在一切正常：

```
tmux new-session -d -n "$TMUX_WINDOW" -s "$TMUX_SESSION" "ssh -t server1 tail -F /var/log/tomcat/application.log"
tmux split-window -v "ssh -t server2 sudo tail -F /var/log/postgresql/postgresql.log"
tmux attach-session -d -t "$TMUX_SESSION" 
```

# xcode - MIDIThruConnection创建xcode

> ID：15141810
> 
> 赞同：1
> 
> 时间：2013-02-28T17:25:17.393
> 
> 标签：xcode, coremidi

我用 coreMIDI 和 Xcode 对“MIDIThruConnectionCreate”进行了尝试，但它不起作用。MIDI In 和 MIDI Out 工作正常，但 MIDI Thru 不工作。感谢您的帮助。

```
- (void) midiThru
{
    MIDIThruConnectionParams params;
    CFDataRef dataRef;

    #if __LP64__
        typedef MIDIObjectRef MIDIThruConnectionRef;
    #else
        typedef struct OpaqueMIDIThruConnection * MIDIThruConnectionRef;
    #endif

    MIDIThruConnectionRef thru;

    MIDIThruConnectionParamsInitialize(&params);
    params.numSources = 1;
    params.sources[0].endpointRef = sourceMIDI;
    params.numDestinations = 1;
    params.destinations[0].endpointRef = destMIDI;
    dataRef = CFDataCreate(NULL, (unsigned char*) &params,
                                 sizeof(MIDIThruConnectionParams));
    s = MIDIThruConnectionCreate(NULL, dataRef, &thru);

    CFRelease(dataRef);
} 
```

# vb.net - VB.NET：System.Speech 给出 System.PlatformNotSupportedException

> ID：15141814
> 
> 赞同：0
> 
> 时间：2013-02-28T17:25:26.257
> 
> 标签：vb.net, windows-8, speech-recognition

我正在尝试在 VB.NET 上进行语音识别。

代码中没有错误，但是当我测试我的程序时，我得到：

**System.Speech.dll 中出现“System.PlatformNotSupportedException”类型的未处理异常**

附加信息：**未安装识别器。**

我在荷兰设备上。这有关系吗，如果有，我可以将语音识别设置为英语吗？

运行 Windows 8 专业版。

PS*进入我的控制面板/语音识别告诉我您的屏幕语言不支持语音识别。*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T14:32:46.273

如果您正在执行进程识别并且不需要听写语法，您可以尝试使用 Microsoft 语音平台中的服务器识别器。有关 SDK 和下载，请参阅：

1.  语言包 - [http://www.microsoft.com/en-us/download/details.aspx?id=27224](http://www.microsoft.com/en-us/download/details.aspx?id=27224)
2.  运行时引擎 - [http://www.microsoft.com/en-us/download/details.aspx?id=27225](http://www.microsoft.com/en-us/download/details.aspx?id=27225)
3.  SDK - [http://www.microsoft.com/en-us/download/details.aspx?id=27226](http://www.microsoft.com/en-us/download/details.aspx?id=27226)

语言包包括我认为是荷兰语的识别器和 TTS 语音：

1.  MSSpeech_TTS_nl-NL_Hanna.msi
2.  MSSpeech_SR_nl-NL_TELE.msi

# vb.net - parallel.foreach 将多个变量传递给函数

> ID：15141817
> 
> 赞同：0
> 
> 时间：2013-02-28T17:25:35.013
> 
> 标签：vb.net, task-parallel-library, parallel.foreach

我有以下代码读取多个 CSV 文件，然后使用线程将数据传递给一个类。我必须将 CSV 路径和一个字符串传递给函数（两者都必须是动态的）。

```
 Dim MyThread1 As PassResourceDataToClassDelagate = AddressOf PassResourceDataToClass
    Dim FileTypes() As String = {".HOURLY", ".INTERVAL", ".EDSOLUTION", ".MCECTRL", ".PNODE"}
    Dim TextBoxValues() As String = {RTBMHourlyTextBox.Text, RTBMIntervalTextBox.Text, _
                                    RTBMEDSolutionTextBox.Text, RTBMMCECTRLTextBox.Text, _
                                    RTBMPNodeTextBox.Text}
    For K As Integer = 0 To 4
        MyThread1.BeginInvoke(DirectCast(ReadCSVFile(TextBoxValues(K)), Object()()), FileTypes(K), Nothing, Nothing)
    Next 
```

我正在尝试学习 Parallel.ForEach 来做同样的事情。搜索互联网让我得到了这个（这不起作用）：

```
 Parallel.ForEach(TextBoxValues, FileTypes, Sub(ByRef TBName As String, ByRef FleType As String) _
                                                PassResourceDataToClass(DirectCast(ReadCSVFile(TBName), _
                                                                        Object()()), FleType)) 
```

有人有更好的主意吗？

# pip - 点、PIL 和枕头

> ID：15141823
> 
> 赞同：3
> 
> 时间：2013-02-28T17:25:49.117
> 
> 标签：pip, virtualenv, python-imaging-library, django-hvad

我运行以下命令将项目依赖项安装到 virtualenv 中`novacek`：

```
(novacek) $ pip install -r reqs.txt 
```

`reqs.txt`看起来像这样：

```
Django==1.4.4
Pillow==1.7.8
South==0.7.6
django-bootstrap-toolkit==2.8.0
django-debug-toolbar==0.9.4
django-filebrowser==3.5.1
-e git+https://github.com/ir4y/django-flatblocks.git@4f8b2c86fe94e19dc7aa86b80a204918e2142aff#egg=django_flatblocks-dev
django-generic-flatblocks==0.9.1
django-grappelli==2.4.3
django-hvad==0.2
django-photologue==2.5
docutils==0.10
psycopg2==2.4.6
wsgiref==0.1.2 
```

如您所见，没有 PIL 包，只有 Pillow，但在安装过程结束时我得到了这个：

```
--------------------------------------------------------------------
PIL 1.1.7 SETUP SUMMARY
--------------------------------------------------------------------
version       1.1.7
platform      linux2 2.7.3 (default, Feb 21 2013, 13:39:24)
              [GCC 4.4.6 20120305 (Red Hat 4.4.6-4)]
--------------------------------------------------------------------
*** TKINTER support not available
*** JPEG support not available
*** ZLIB (PNG/ZIP) support not available
*** FREETYPE2 support not available
*** LITTLECMS support not available
-------------------------------------------------------------------- 
```

这很奇怪。我之前还获得了 Pillow 的设置摘要（启用了对 jpeg 和 zlib 的支持。因为 Pillow 实际上可以找到我的库）。

如果我在安装后从 virtualenv 运行 pip freeze ，我会得到：

```
Django==1.4.4
PIL==1.1.7
Pillow==1.7.8
South==0.7.6
django-bootstrap-toolkit==2.8.0
django-debug-toolbar==0.9.4
django-filebrowser==3.5.1
-e git+https://github.com/ir4y/django-flatblocks.git@4f8b2c86fe94e19dc7aa86b80a204918e2142aff#egg=django_flatblocks-dev
django-generic-flatblocks==0.9.1
django-grappelli==2.4.3
django-hvad==0.2
django-photologue==2.5
docutils==0.10
psycopg2==2.4.6
wsgiref==0.1.2 
```

PIL 已陷入依赖关系。为什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-28T17:29:57.417

这是完全正确的。Pillow 是 PIL 的一个分叉，替代重新包装。

从[Pillow 的 PyPI 页面](https://pypi.python.org/pypi/Pillow/#introduction)：

> fork 作者的目标是通过以下方式促进包装改进：
> 
> *   公开发展和征求社区支持。
> *   探索 fork 中的打包问题，最引人注目的是通过添加 setuptools 支持以及通过清理和重构打包代码。

在包内部，这仍然是 PIL 项目，并且在编译时仍会以该名称发出消息。

不幸的是，Pillow 并没有声称满足 PIL 要求，所以任何依赖 PIL 的东西仍然会拉入 PIL。

# highcharts - 列间隔和工具提示错误

> ID：15141825
> 
> 赞同：0
> 
> 时间：2013-02-28T17:25:56.290
> 
> 标签：highcharts

前几天我在柱形图中发布了一个有问题的问题： [双轴线vs列和缩放工具提示坏了](https://stackoverflow.com/questions/14849445/dual-axes-line-vs-column-and-zoom-tooltip-broke)

我不想重新浮动这个线程。对此感到抱歉。

我认为这个问题是一个包含许多“空值”的系列，而 Fusher 用一个“解决方案”回答了我。好吧，我认为我的这个错误不仅仅发生在许多“空值”上。目前，即使没有“空值”值，我的一些图表也会失败。这个 jdfiffle 是一个带有官方 jdfiffle 代码的快速示例：

```
[code]
http://jsfiddle.net/revor44/D2vLX/
[/code] 
```

如果您放大最终系列并尝试查看工具提示，您将看到工具提示如何固定到图表内的左侧区域。甚至，当您有一个“复杂”的工具提示（带有大系列名称和 html）时，它会被替换。我已经截图了。

当系列有许多每日值时，就会发生这种情况。如果我使用日期列间隔... 30 天，则不会发生。作为回报，例如，当我有 90 个值时，就会出现问题。

没有使用日期间隔列的许多值的解决方案吗？根据我的程序架构，我需要使用此配置。事实上，在过去版本的 highcharts 中它不会发生（或 2 更早版本）。问题？我不能回来，因为这个版本修复了其他错误。

很抱歉我的坚持，但这对我和公司发展很重要。

非常感谢和最好的问候。

截图我发不出来。如果有人能告诉我该怎么做，我将不胜感激。

* * *

几个小时前我已经看到该错误已修复并关闭......这里： [https ://github.com/highslide-software/highcharts.com/issues/1526](https://github.com/highslide-software/highcharts.com/issues/1526)

我一直在测试新版本，它至少在 Highcharts 中没有修复错误。我从这里下载了主文件： [https ://github.com/highslide-software/highcharts.com](https://github.com/highslide-software/highcharts.com)

使用这些文件，我尝试从 jsdfiddle 放大同一张图表。我做错了什么？

谢谢你的时间！！。

# c# - 数据源未添加到 ReportViewer

> ID：15141831
> 
> 赞同：2
> 
> 时间：2013-02-28T17:26:23.623
> 
> 标签：c#, asp.net, datatable, dataset, reportviewer

我正在尝试配置 ReportViewer，但无法使其正常工作

我有以下数据集：

![数据集](../Images/7898c568267a1a989bfc16423be91244.png)

这是数据集中的查询：

```
SELECT        DataTime, DataValue
FROM            PointValue
WHERE        (DataTime >= @FromDate) AND (DataTime <= @ToDate) 
```

我也有一个报告rdlc：

![报告表](../Images/cf38fcc67a19a33229299a3bcb685971.png)

我有一个在单击时运行此代码的按钮：

```
var myDataTable = new i96X_dataDataSet.PointValueDataTable();
var myTableAdapter = new PointValueTableAdapter();
myTableAdapter.Fill(myDataTable, Convert.ToDateTime("2010-01-20T00:00:00.000"), Convert.ToDateTime("2010-01-21T00:00:00.000"));
var rds = new ReportDataSource("i96X_dataDataSet_PointValue", myDataTable as DataTable);
ReportViewer1.LocalReport.DataSources.Clear();
ReportViewer1.LocalReport.DataSources.Add(rds);
ReportViewer1.LocalReport.Refresh(); 
```

但是，当我运行它时，ReportViewer 里面写着：

尚未为数据源“DataSet1”提供数据源实例。

看起来正在收集正确的数据，因为当我调试时，我看到计数为 5990：

![调试](../Images/b9561329dfffb00c16fe35746c241c8a.png)

似乎没有添加数据源。

显然我做错了什么。另外，有没有更简单的方法来实现这一点？看起来工作量很大，我整天都在阅读这方面的文章。我想做的就是能够以某种方式调整附加到 SQL 数据库的 SELECT 语句，并将该数据检索到报表查看器中。

感谢您的任何指导，

朱利安

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T18:05:12.167

听起来好像您的报告是建立在一个名为`DataSet1`.

尝试更改此行....

```
var rds = new ReportDataSource("i96X_dataDataSet_PointValue", myDataTable as DataTable); 
```

...到这条线...

```
var rds = new ReportDataSource("DataSet1", myDataTable as DataTable); 
```

或者，您可以修改报告并在报告定义中重命名数据源。如果您有很多报告希望使用相同的数据源，那可能更有意义。

# java - 难以将 JQuery Slide Menu 与现有移动网站集成

> ID：15141833
> 
> 赞同：0
> 
> 时间：2013-02-28T17:26:34.250
> 
> 标签：java, jquery, mobile

我有一个用 Java 编写并托管在 Tomcat 上的现有移动站点，我正在尝试为其集成此幻灯片菜单

[https://github.com/tegansnyder/JQuery-Mobile-Slide-Menu](https://github.com/tegansnyder/JQuery-Mobile-Slide-Menu)

但是我遇到了一个非常奇怪的问题，这似乎是我的三星 Galaxy S3 浏览器特有的，因为我在 Chrome 或 Firefox 上没有看到相同的问题。

当我单击滑块菜单中的一个菜单链接时，它会将我重定向到我指定的 URL，但会添加一个 # 符号。例如

domain.mobi/#/help.jsp?helpsource=index.jsp

而它应该是

domain.mobi/help.jsp?helpsource=index.jsp

这有效地破坏了页面，因为该页面上的滑块菜单不再起作用。

有任何想法吗？

这是我的 index.jsp 上的代码

```
<?xml version="1.0"?>
<!DOCTYPE html PUBLIC "-//WAPFORUM//DTD XHTML Mobile 1.0//EN" 
                   "http://www.wapforum.org/DTD/xhtml-mobile10.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<%@taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>
<%@taglib uri="http://java.sun.com/jsp/jstl/fmt" prefix="fmt" %>
<c:set var="locale" value="en"/>
<c:if test="${not empty param.locale}">
  <c:set var="locale" value="${param.locale}"/>
</c:if>
<fmt:setLocale value="${locale}"/>
<fmt:setBundle basename="chale"/>
<%@taglib uri="/WEB-INF/tld/chale.tld" prefix="chale" %>

<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320"/>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta http-equiv="cleartype" content="on">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">

 <link href="css/themes/jqmfb.min.css" rel="stylesheet" type="text/css">
 <link href="css/chale_style.css" rel="stylesheet" type="text/css">
 <link href="css/jquery.mobile.structure.min.css" rel="stylesheet" type="text/css">

<!--Include JQM and JQ-->

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.1/jquery.min.js">    </script>
 <script src="js/jquery.animate-enhanced.min.js"></script>

        <!--JQM globals you can edit or remove file entirely... note it needs to be loaded     before jquerymobile js -->
<script src="js/jqm.globals.js"></script>

<script src="http://code.jquery.com/mobile/latest/jquery.mobile.min.js"></script>

<!--JQM SlideMenu-->
<link rel="stylesheet" href="css/jqm.slidemenu.css" />
<script src="js/jqm.slidemenu.js"></script>  
<title><fmt:message key="index.pagetitle"/></title>
</head>
<body>
<c:set var="pageVal" value="0"/>
<c:if test="${not empty param.page}">
<c:set var="pageVal" value="${param.page}"/> 
</c:if>

<div id="slidemenu">

    <div id="profile">

        <div class="profile_info"><strong>Chale</strong></div>
    </div>

    <h3>MENU</h3>

    <ul>
        <c:url var="finder" value="m/browse.jsp"/>
        <li><a href="${finder}"><img src="../img/smico4.png"><fmt:message key="index.optionflirtfinder"/></a></li>

        <c:url var="fav" value="m/favourites.jsp"/>
        <li><a href="${fav}"><img src="../img/smico4.png"><fmt:message key="general.favourites"/></a></li>

        <c:url var="message" value="m/messaging.jsp"><c:param name="messagesource" value="../index.jsp"/></c:url>
        <li><a href="${message}"><img src="../img/smico4.png"><fmt:message key="general.messages"><fmt:param value="${unreadMessages}"/></fmt:message></a></li>

        <c:url var="chat" value="chat/checkdetailsservlet"/>
        <li><a href="${chat}"><img src="../img/smico4.png"><fmt:message key="index.optionchatcentral"/></a></li>

        <c:url var="prof" value="m/profile.jsp"/>
        <li><a href="${prof}"><img src="../img/smico4.png"><fmt:message key="index.optionmyprofile"/></a></li>

        <c:url var="help" value="help.jsp"><c:param name="helpsource" value="index.jsp"/></c:url>
        <li><a href="${help}"><img src="../img/smico4.png"><fmt:message key="general.helpcentre"/></a></li>

    </ul>

</div>

<div data-role="page" id="main_page" data-theme="a">

    <div data-role="header" data-position="fixed" data-tap-toggle="false" data-   update-page-padding="false">
        <a href="@" data-slidemenu="#slidemenu" data-slideopen="false" data-icon="smico" data-corners="false" data-iconpos="notext">Menu</a>
        <h1>Chale</h1>
    </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T17:54:36.263

得到你所面临的。`<a>`标签将被 jquery mobile 拦截以使用 AJAX 获取 HTML/导航页面，而不是直接更改页面。

它将生成带有哈希 (#) 的 url 以导航页面。
参考： http: [//jquerymobile.com/demos/1.2.0/docs/api/methods.html](http://jquerymobile.com/demos/1.2.0/docs/api/methods.html)
搜索关键字：hash

`domain.mobi/#/help.jsp?helpsource=index.jsp`

要解决此问题，您需要在 url 中添加 data-ajax="false"。

```
<a href="${finder}" data-ajax="false"><img src="../img/smico4.png"><fmt:message key="index.optionflirtfinder"/></a> 
```

如果链接链接到另一个站点或域，您还必须添加`rel="external"`。
参考：http: [//jquerymobile.com/demos/1.2.0-alpha.1/docs/pages/page-links.html](http://jquerymobile.com/demos/1.2.0-alpha.1/docs/pages/page-links.html)

# javascript - jasmine.js expect() 在异步回调中不起作用

> ID：15141834
> 
> 赞同：19
> 
> 时间：2013-02-28T17:26:34.527
> 
> 标签：javascript, ajax, bdd, jasmine

我开始熟悉 Jasmine ( [http://pivotal.github.com/jasmine/](http://pivotal.github.com/jasmine/) ) 并发现一些相当莫名其妙的东西：

```
it("should be able to send a Ghost Request", function() {
  var api = fm.api_wrapper;

  api.sendGhostRequest(function(response) {
    console.dir('server says: ', response);
  });

  expect(true).toEqual(false);
}); 
```

按预期失败。

但是，在回调中移动期望调用：

```
it("should be able to send a Ghost Request", function() {
  var api = fm.api_wrapper;

  api.sendGhostRequest(function(response) {
    console.dir('server says: ', response);
    expect(true).toEqual(false);
  });
}); 
```

不知何故通过：O

经过一番调试： api.sendGhostRequest() 做了一个异步ajax请求，在请求完成之前jasmine就冲过去了。

因此问题是：

在确定测试结果之前，如何让 jasmine 等待 ajax 执行？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-28T17:34:42.270

**茉莉花 2 编辑**

在 Jasmine 2 中，异步测试变得更加简单。任何需要处理异步代码的测试都可以使用回调来编写，这将指示测试的完成。请参阅标题*异步支持下的*[Jasmine 2 文档](https://jasmine.github.io/2.0/introduction.html#section-Asynchronous_Support)

 *```
it('should be able to send a ghost request', (done) => {
    api.sendGhostRequest((response) => {
        console.log(`Server says ${response}`);
        expect(true).toEqual(false);
        done();
    });
}); 
```

**茉莉花 1**

查看[Jasmine 站点](http://jasmine.github.io/1.3/introduction.html#section-Asynchronous_Support)上*Asynchronous Support*标题下的**waitsFor()**和**runs()**。

 *使用运行和等待应该强制 Jasmine 等待 ajax 调用完成或超时。

代码如下所示：

```
it("should be able to send a Ghost Request", function() {
    runs(function() {
        api.sendGhostRequest(function(response) {
            console.dir('server says: ', response);
            flag = true;
        });
    }, 500);

    waitsFor(function() {
        return flag;
    }, "Flag should be set", 750);

    runs(function() {
        expect(true).toEqual(false);
    });
} 
```

在这种情况下，期望会失败。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-01-04T05:39:59.130

正如@pkopac 评论的那样，`runs()`并且`waitsFor()`在 v2 中已被弃用，有利于使用`done()`记录在案的回调：[https ://jasmine.github.io/2.0/introduction.html#section-Asynchronous_Support](https://jasmine.github.io/2.0/introduction.html#section-Asynchronous_Support)

```
it("should be able to send a Ghost Request", function(done) {
    var api = fm.api_wrapper;

    var success = function(response) {
        console.dir('server says: ', response);
        expect(response).toEqual('test response')
        done();
    };

    api.sendGhostRequest(success);
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-28T17:36:18.387

查看运行（）和等待（）

具体来说，您可以调用 waitfor 来检查回调是否以某种方式运行（也许使用布尔值作为检查？），然后运行期望。

运行允许您等到等待完成。

[异步茉莉花文档](https://github.com/pivotal/jasmine/wiki/Asynchronous-specs)**

# javascript - 回溯异步 JavaScript

> ID：15141840
> 
> 赞同：0
> 
> 时间：2013-02-28T17:26:45.437
> 
> 标签：javascript, jquery

我正在尝试**回溯**下面的代码。到目前为止，我知道该`getResults()`函数使用**异步 JavaScript**，但我仍然无法理解变量的值`res`和调用函数的人 `success: function(res)`。请指导。谢谢

```
function getResults(u) {                                    // function called from index page
// alert("Inside get results");                             // show that we are in
    $.ajax({                                                // asynchrounous javascript starts to run 
        dataType: "jsonp",                                  // 
        url: u,
        success: function(res) {                            // 
              $("#status").hide();                          //
              if (res.data.length) {                        //
                nexturl = res.paging.next;                  //
                  $.each(res.data, function(i,item){        //
                    if (item.id != lastid) {                //
                        lastid = item.id;                   //
                        var html ="<div class=\"post\">";   //
                        html += "<div class=\"message\"><a href=\"http:\/\/www.facebook.com\/profile.php?id="+item.from.id+"\">"+item.from.name+"</a> ";
                        if (item.message) {                 //
                            html += item.message+"<\/div>"; //
                        } else {                            //
                            html += "<\/div>";              //
                        }
                        if (item.picture) {                 //
                            html += "<div class=\"image\"><img src=\""+item.picture+"\"></div>";    //
                        } else {                            //
                            html += "<div class=\"image\"><\/div>";                                 //
                        };
                        if (item.link) {                    //
                            html += "<div class=\"link\"><a href=\""+item.link+"\">"+item.name+"</a></div>";    //

                            if (item.caption) {             //
                                    html += "<div class=\"caption\">"+item.caption+"</div>";                    //
                            };
                            if (item.description) {         //
                                    html += "<div class=\"description\">"+item.description+"</div>";            //
                            };  

                        };

                        html += "<div class=\"meta\">";                                                         //

                        if (item.icon) {                                                                        //
                            html += "<span class=\"icon\"><img src=\""+item.icon+"\"></span> ";                 //
                        };
                        var t = item.created_time;                                                              //
                        var time = t.substring(0,19)+"\+00:00";                                                 //
                        html += "<span class=\"time\">"+$.cuteTime({},time)+"<\/span> ";                        //
                        html += " <\/div>";                                                                     //

                        html +="</div>";                                                                        //
                        $("#data").append(html) ;                                                               //
                    }
                  });
                    $("#more").appendTo("#data");                                                               //
                    $("#more").show();                                                                          //
                    $("#status").appendTo("#data");                                                             //

            } else {                                                                                            //
                $("#data").append("<h3 class=\"none\">No entries found. Please try another search.</h3>");      //
            }; 
        } 

    });
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T17:33:01.040

如果 ajax 调用结束并成功结束（代码 200），则会自动调用 success。res 是服务器返回给您的调用的字符串。在这种情况下，是 jsonp 格式。在这种情况下，结果。

如您所见， res 用作对象，就像任何其他 json 响应一样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T17:33:16.110

ajax 请求成功返回时自动调用success。该函数被传回 3 个参数：

> 成功：函数（PlainObject 数据，字符串 textStatus，jqXHR jqXHR）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-28T17:33:39.493

这是一个标准的 JQuery AJAX 调用。一旦ajax调用成功返回，就会调用success函数。`res`是ajax调用的结果。

查看 JQuery 文档了解更多信息： http: [//api.jquery.com/jQuery.ajax/](http://api.jquery.com/jQuery.ajax/)

# r - 因子每个水平的自相关

> ID：15141845
> 
> 赞同：1
> 
> 时间：2013-02-28T17:26:55.917
> 
> 标签：r, correlation, levels

我想自相关不同级别的数据，为每个级别生成图。但是，我似乎找不到将数据帧拆分到不同 ID 级别的方法：

```
##My data is:
*data.1*
 ID   y.var.1
1   1  2.284620
2   1  2.820829
3   1  3.889701
4   1  5.180010
5   1  6.080572
6   2  6.972568
7   2  8.082126
8   2  9.075686
9   2  9.864694
10  2 10.942456
11  3 11.853353
12  3 13.112986
13  3 13.893405
14  3 15.037400
15  3 16.015836

## I use dlply (from the plyr package) to split the dataframe by the level ID
data_ID<-dlply(data.1, .(ID), function(X) acf(y.var.1, na.action = na.pass))
head(data_ID)

##and although this produces three groups, they all have the same values which are the same as when I do autocorrelation on the entire dataframe..
> head(data_ID)
$`1`
Autocorrelations of series ‘y.var.1’, by lag
 0      1      2      3      4      5      6      7      8      9     10     11 
 1.000  0.804  0.600  0.409  0.230  0.071 -0.075 -0.194 -0.293 -0.370 -0.409 -0.418 
$`2`
Autocorrelations of series ‘y.var.1’, by lag
 0      1      2      3      4      5      6      7      8      9     10     11 
 1.000  0.804  0.600  0.409  0.230  0.071 -0.075 -0.194 -0.293 -0.370 -0.409 -0.418 
$`3`
Autocorrelations of series ‘y.var.1’, by lag
 0      1      2      3      4      5      6      7      8      9     10     11 
 1.000  0.804  0.600  0.409  0.230  0.071 -0.075 -0.194 -0.293 -0.370 -0.409 -0.418 

> dput(data.1)
structure(list(ID = c(1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 
3, 3), y.var.1 = c(2.28462022795481, 2.82082936729163, 3.88970139114628, 
5.18001014821836, 6.08057215599522, 6.97256785426474, 8.08212595903149, 
9.07568620628701, 9.8646935842879, 10.9424555128125, 11.8533529745958, 
13.1129856348251, 13.8934049954063, 15.0374003752388, 16.0158355330431
)), .Names = c("ID", "y.var.1"), row.names = c(NA, -15L), class = "data.frame") 
```

任何人都对如何解决这个问题有任何想法，那就太好了！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T17:33:49.760

你得到了这个奇怪的行为，因为变量`y.var.1`是在你的会话中定义的（也许你使用了函数`attach()`或者只是将它定义为单独的向量）。如果您只是`y.var.1`在函数中使用，`acf()`则使用会话中的这个变量。您应该在`X$`里面添加`acf()`使用`y.var.1`定义为一列数据框的内容`data.1`。

```
 dlply(data.1, .(ID), function(X) acf(X$y.var.1, na.action = na.pass))
$`1`
Autocorrelations of series ‘X$y.var.1’, by lag   
     0      1      2      3      4 
 1.000  0.446 -0.142 -0.447 -0.357     
$`2`    
Autocorrelations of series ‘X$y.var.1’, by lag    
     0      1      2      3      4 
 1.000  0.373 -0.084 -0.373 -0.416     
$`3`    
Autocorrelations of series ‘X$y.var.1’, by lag   
     0      1      2      3      4 
 1.000  0.377 -0.086 -0.381 -0.411 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-28T17:37:53.703

可能使用`by`或`tapply`功能：

```
R > a <- by(dat$y.var.1, dat$ID, function(x) acf(x)$acf)
R > a
dat$ID: 1
, , 1

        [,1]
[1,]  1.0000
[2,]  0.4457
[3,] -0.1424
[4,] -0.4467
[5,] -0.3566

------------------------------------------------------------ 
dat$ID: 2
, , 1

         [,1]
[1,]  1.00000
[2,]  0.37311
[3,] -0.08434
[4,] -0.37320
[5,] -0.41557

------------------------------------------------------------ 
dat$ID: 3
, , 1

         [,1]
[1,]  1.00000
[2,]  0.37742
[3,] -0.08618
[4,] -0.38068
[5,] -0.41057 
```

# java - Java，奇怪的 switch 语句行为

> ID：15141846
> 
> 赞同：7
> 
> 时间：2013-02-28T17:27:04.307
> 
> 标签：java, switch-statement

浏览了一些编程任务（第一年），我想出了这个。当我运行它时，程序直接进入 switch 语句的默认值。现在已经连续工作了大约 24 小时，所以我几乎不知道，但我就是找不到出了什么问题。

谁能指出我的写作方向。我不想让你为我做

```
// Practical 5B - Question 1
// Nathan Griffin
// 28/02/2013
// Program to simulate a continuos system of deposits and withdraw for a bank account until user exits.

import java.util.Scanner;
public class SingleAccountSim
{
    public static void main(String [] args)
    {
        Scanner keyboardIn = new Scanner(System.in);

        BankAccount account = new BankAccount();

        int menuSelect = 0;
        double depositIn, withdrawalOut;

        do
        {
            System.out.println("*_*_*Monopoly Bank*_*_*");
            System.out.println("1\. Deposit money");
            System.out.println("2\. Withdraw money");
            System.out.println("3\. Get balance");
            System.out.println("4\. Quit");

            menuSelect = keyboardIn.nextInt();

            switch(menuSelect)
            {
                case '1':   System.out.print("Please enter the deposit amount: ");
                                depositIn = keyboardIn.nextDouble();
                                account.deposit(depositIn);
                                break;              
                case '2': System.out.print("Please enter the withdrawl amount: ");
                                withdrawalOut = keyboardIn.nextDouble();
                                account.withdraw(withdrawalOut);
                                break;
                case '3': System.out.print("Your current balance is " + account.getBalance());
                                break;
                case '4': System.out.print("Quitting.....");
                                break;
                    default: System.out.println("Invalid selection. Please try again");
            }
        }while(menuSelect !=4);

    }
} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-28T17:28:30.760

好吧，您正在比较 a `int`(due to `menuSelect = Scanner.nextInt()`) 和 a `char`，所以它当然不匹配。在 switch 语句中，当分配给 int 时，字符`'1'`相当于一个值。`49`从[Java 语言规范中的 switch 语句中](http://docs.oracle.com/javase/specs/jls/se7/html/jls-14.html#jls-14.11)，一个鲜为人知的事实是

> `case`与语句关联的每个常量表达式都`switch`必须可分配（第 5.2 节）到`switch`表达式的类型。

例如，以下（有效，令人惊讶）代码打印`49`：

```
int a = '1';
System.out.println(a); 
```

所以 the`case constant`和 the`switch(expression)`不需要是相同的类型，这不会对原始类型产生编译错误。您可以通过使用解决此问题

```
switch(menuSelect) {
    case 1:
    ...
    case 2:
    ...
} 
```

您还可以阅读 a `char`in 而不是 a `int`，并保持原样。但是 Scanner 没有`nextChar()`方法，所以你必须使用`nextByte()`并转换它。

```
char menuSelect = (char) keyboardIn.nextByte() 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-02-28T17:28:59.197

您正在获取一个`int`值，然后将其与一个`char`值进行比较。语句中的`char`值`switch`被提升为相应的`int`.

所以实际上，如果您输入 49（'1' 的 Unicode 值），它将打印“请输入存款金额”等。

只是改变

```
case '1': 
```

到

```
case 1: 
```

等等

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-28T17:28:52.500

`menuSelect`is an `int`while `'1'`is a `char`which，一旦转换为`int`is `49`...只需删除引号，它应该可以按预期工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-28T17:30:50.530

您将输入作为 int 类型提取，但在您的情况下使用字符串参数。

将您的案例更改为：

```
case 1:
    // do something
    break;
case 2:
    // do something
    break;
//etc.. 
```

# emacs - 如何在 Emacs 邪恶模式非插入状态下启用 shift-select-mode

> ID：15141848
> 
> 赞同：0
> 
> 时间：2013-02-28T17:27:05.430
> 
> 标签：emacs, evil-mode

如何配置 Emacs 以便在 evil-mode 的非插入状态下使用 shift 和箭头键选择文本成为可能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-07T15:52:05.033

这不完全是您要问的问题，但我认为这可以解决您的问题。

按下`v`并输入`visual-mode`。这允许您使用箭头键或`hjkl`选择文本。

# objective-c - Mac App Sandbox Group Container 问题

> ID：15141853
> 
> 赞同：5
> 
> 时间：2013-02-28T17:27:25.137
> 
> 标签：objective-c, xcode, cocoa, appstore-sandbox

我在一个应用程序组中的两个沙盒应用程序中遇到了一些问题。在我的权利文件中，我有以下内容：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/    PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
     <key>com.apple.security.app-sandbox</key>
     <true/>

     <key>com.apple.security.application-groups</key>
     <array>
          <string>TEAM_ID.com.Company.AppName</string>
     </array>
</dict>
</plist> 
```

其中“公司”和“应用程序名称”替换为我的公司，应用程序名称和 TEAM_ID 替换为我的团队 ID。这两个应用程序具有完全相同的权利。

现在，当我构建并启动这两个应用程序时，一切似乎都很顺利。除了在我的 ~/Library 文件夹中找不到“Group Containers”文件夹这一事实之外……有一个“Containers”文件夹，其中包含两个应用程序的文件夹。但没有 Group Containers 文件夹。

我正在运行 10.8.2，我的应用程序的部署目标是 10.8。

根据开发人员库，它应该从 10.7.4 开始可用。我用过这个：[https](https://developer.apple.com/library/mac/#documentation/Miscellaneous/Reference/EntitlementKeyReference/Chapters/EnablingAppSandbox.html#//apple_ref/doc/uid/TP40011195-CH4-SW19) ://developer.apple.com/library/mac/#documentation/Miscellaneous/Reference/EntitlementKeyReference/Chapters/EnablingAppSandbox.html#//apple_ref/doc/uid/TP40011195-CH4-SW19来创建我的权利。

我究竟做错了什么？

谢谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T16:22:20.623

官方 Apple Developer Forums 上的某个人建议以编程方式创建文件夹，这就是我的问题的解决方案！

```
NSString *groupContainer = [@"~/../../../Group Containers/TEAM_ID.com.Company.AppName" stringByExpandingTildeInPath];

[[NSFileManager defaultManager] createDirectoryAtPath:groupContainer withIntermediateDirectories:YES attributes:nil error:NULL]] 
```

我将 Group Container 文件夹用于 plist 文件，我的主应用程序可以在其中写入我的助手（守护程序）应用程序可以读取的设置（使用 NSMutableDictionary 的 initWithContentsOfFile: 和 writeToFile: 方法）。这现在完美无缺:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-12-28T20:57:22.833

作为@jeppeb 的更新，我也不得不手动创建文件夹。在 Swift、Mac OSX 10.14 中，我发现使用：

```
let appSupport: String = NSString(string: "~/Library/Group Containers/com.myCo.myAppName/Library/Application Support").expandingTildeInPath
try fileMan.createDirectory(atPath: appSupport, withIntermediateDirectories: true, attributes: nil)

let caches: String = NSString(string: "~/Library/Group Containers/com.myCo.myAppName/Library/Caches/myCacheFolder").expandingTildeInPath
try fileMan.createDirectory(atPath: caches, withIntermediateDirectories: true, attributes: nil)

let prefs: String = NSString(string: "~/Library/Group Containers/com.myCo.myAppName/Library/Preferences").expandingTildeInPath
try fileMan.createDirectory(atPath: prefs, withIntermediateDirectories: true, attributes: nil) 
```

我不敢相信这是正确的做事方式，但到目前为止我还没有找到任何其他答案，这就是我需要做的来创建一个 Groups Container 文件夹以及一个 Preferences 文件夹来存储任何套件我使用的偏好....

# python - 返回指数头寸

> ID：15141856
> 
> 赞同：0
> 
> 时间：2013-02-28T17:27:34.543
> 
> 标签：python, python-3.x

来自 PHP 背景，我正在学习如何使用 Python。

`haystack`如果在from中找到内容，我正在尝试返回 Index Position`needle`

```
haystack= open("haystack.wav",'r')
needle = open("needle.wav",'r')
nedOffset = needle.read()[:46]

print(haystack.index(nedOffset)) 
```

它似乎不起作用，我收到一个错误：

```
Traceback (most recent call last):
  File "test.py", line 5, in <module>
    print(haystack.index(ned[:46]))
AttributeError: '_io.TextIOWrapper' object has no attribute 'index' 
```

怎么修？

在 PHP 中，我会这样做：

```
$needle = file_get_contents("needle.wav", false, null, 46);
$haystack = file_get_contents("heystack.wav");
echo strpos($haystack,$needle); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T17:29:27.510

您需要从 中读取字符串`haystack`，而不仅仅是`needle`. 就像是：

```
haystack= open("haystack.wav",'r').read() 
```

或者

```
with open("haystack.wav",'r') as inf:
    haystack = inf.read() 
```

# android - 显示 .obb 中的图像而不提取 - Apk 扩展文件

> ID：15141857
> 
> 赞同：1
> 
> 时间：2013-02-28T17:27:39.217
> 
> 标签：android, apk, expansion

我已经成功实现了 Google 在示例 sdk 中给出的项目，我有一个 .obb 文件，其中包含 2 个文件夹，其中包含图像。

这是我的路

```
/Android/obb/com.ss.aa/main.1.com.ss.aa.obb 
```

我的 .obb 文件有以下 2 个文件夹

```
(1)birthdays (2)photos 
```

现在，当我运行它时，它将下载我与 .apk 文件一起上传的扩展文件，但是如何显示文件夹中的图像？

以下是我的代码：

```
public class SampleDownloaderActivity extends Activity implements IDownloaderClient {
    private static final String LOG_TAG = "LVLDownloader";
    private ProgressBar mPB;

    private TextView mStatusText;
    private TextView mProgressFraction;
    private TextView mProgressPercent;
    private TextView mAverageSpeed;
    private TextView mTimeRemaining;
    private View mDashboard;
    private View mCellMessage;
    private Button mPauseButton;
    private Button mWiFiSettingsButton;
    private boolean mStatePaused;
    private int mState;
    private IDownloaderService mRemoteService;
    private IStub mDownloaderClientStub;

    private void setState(int newState) {
        if (mState != newState) {
            mState = newState;
            mStatusText.setText(Helpers.getDownloaderStringResourceIDFromState(newState));
        }
    }

    private void setButtonPausedState(boolean paused) {
        mStatePaused = paused;
        int stringResourceID = paused ? R.string.text_button_resume :
                R.string.text_button_pause;
        mPauseButton.setText(stringResourceID);
    }

    /**
     * This is a little helper class that demonstrates simple testing of an
     * Expansion APK file delivered by Market. You may not wish to hard-code
     * things such as file lengths into your executable... and you may wish to
     * turn this code off during application development.
     */
    private static class XAPKFile {
        public final boolean mIsMain;
        public final int mFileVersion;
        public final long mFileSize;

        XAPKFile(boolean isMain, int fileVersion, long fileSize) {
            mIsMain = isMain;
            mFileVersion = fileVersion;
            mFileSize = fileSize;
        }

    }

    /**
     * Here is where you place the data that the validator will use to determine
     * if the file was delivered correctly. This is encoded in the source code
     * so the application can easily determine whether the file has been
     * properly delivered without having to talk to the server. If the
     * application is using LVL for licensing, it may make sense to eliminate
     * these checks and to just rely on the server.
     */
    private static final XAPKFile[] xAPKS = {
            new XAPKFile(
                    true, // true signifies a main file
                    6, // the version of the APK that the file was uploaded
                       // against
                    23232840L // the length of the file in bytes

    };

    /**
     * Go through each of the APK Expansion files defined in the structure above
     * and determine if the files are present and match the required size. Free
     * applications should definitely consider doing this, as this allows the
     * application to be launched for the first time without having a network
     * connection present. Paid applications that use LVL should probably do at
     * least one LVL check that requires the network to be present, so this is
     * not as necessary.
     * 
     * @return true if they are present.
     */
    boolean expansionFilesDelivered() {
        for (XAPKFile xf : xAPKS) {
            String fileName = Helpers.getExpansionAPKFileName(this, xf.mIsMain, xf.mFileVersion);
            if (!Helpers.doesFileExist(this, fileName, xf.mFileSize, false)) {
                return false;
            }
        }
        return true;
    }

    /**
     * Calculating a moving average for the validation speed so we don't get
     * jumpy calculations for time etc.
     */
    static private final float SMOOTHING_FACTOR = 0.005f;

    /**
     * Used by the async task
     */
    private boolean mCancelValidation;

    /**
     * Go through each of the Expansion APK files and open each as a zip file.
     * Calculate the CRC for each file and return false if any fail to match.
     * 
     * @return true if XAPKZipFile is successful
     */
    void validateXAPKZipFiles() {
        AsyncTask<Object, DownloadProgressInfo, Boolean> validationTask = new AsyncTask<Object, DownloadProgressInfo, Boolean>() {

            @Override
            protected void onPreExecute() {
                mDashboard.setVisibility(View.VISIBLE);
                mCellMessage.setVisibility(View.GONE);
                mStatusText.setText(R.string.text_verifying_download);
                mPauseButton.setOnClickListener(new View.OnClickListener() {
                    @Override
                    public void onClick(View view) {
                        mCancelValidation = true;
                    }
                });
                mPauseButton.setText(R.string.text_button_cancel_verify);
                super.onPreExecute();
            }

            @Override
            protected Boolean doInBackground(Object... params) {
                for (XAPKFile xf : xAPKS) {
                    String fileName = Helpers.getExpansionAPKFileName(
                            SampleDownloaderActivity.this,
                            xf.mIsMain, xf.mFileVersion);
                    if (!Helpers.doesFileExist(SampleDownloaderActivity.this, fileName,
                            xf.mFileSize, false)) {
                        return false;
                    }
                    fileName = Helpers
                            .generateSaveFileName(SampleDownloaderActivity.this, fileName);
                    ZipResourceFile zrf;
                    byte[] buf = new byte[1024 * 256];
                    try {
                        zrf = new ZipResourceFile(fileName);
                        ZipEntryRO[] entries = zrf.getAllEntries();
                        /**
                         * First calculate the total compressed length
                         */
                        long totalCompressedLength = 0;
                        for (ZipEntryRO entry : entries) {
                            totalCompressedLength += entry.mCompressedLength;
                        }
                        float averageVerifySpeed = 0;
                        long totalBytesRemaining = totalCompressedLength;
                        long timeRemaining;
                        /**
                         * Then calculate a CRC for every file in the Zip file,
                         * comparing it to what is stored in the Zip directory.
                         * Note that for compressed Zip files we must extract
                         * the contents to do this comparison.
                         */
                        for (ZipEntryRO entry : entries) {
                            if (-1 != entry.mCRC32) {
                                long length = entry.mUncompressedLength;
                                CRC32 crc = new CRC32();
                                DataInputStream dis = null;
                                try {
                                    dis = new DataInputStream(
                                            zrf.getInputStream(entry.mFileName));

                                    long startTime = SystemClock.uptimeMillis();
                                    while (length > 0) {
                                        int seek = (int) (length > buf.length ? buf.length
                                                : length);
                                        dis.readFully(buf, 0, seek);
                                        crc.update(buf, 0, seek);
                                        length -= seek;
                                        long currentTime = SystemClock.uptimeMillis();
                                        long timePassed = currentTime - startTime;
                                        if (timePassed > 0) {
                                            float currentSpeedSample = (float) seek
                                                    / (float) timePassed;
                                            if (0 != averageVerifySpeed) {
                                                averageVerifySpeed = SMOOTHING_FACTOR
                                                        * currentSpeedSample
                                                        + (1 - SMOOTHING_FACTOR)
                                                        * averageVerifySpeed;
                                            } else {
                                                averageVerifySpeed = currentSpeedSample;
                                            }
                                            totalBytesRemaining -= seek;
                                            timeRemaining = (long) (totalBytesRemaining / averageVerifySpeed);
                                            this.publishProgress(
                                                    new DownloadProgressInfo(
                                                            totalCompressedLength,
                                                            totalCompressedLength
                                                                    - totalBytesRemaining,
                                                            timeRemaining,
                                                            averageVerifySpeed)
                                                    );
                                        }
                                        startTime = currentTime;
                                        if (mCancelValidation) {
                                            return true;
                                        }
                                    }
                                    if (crc.getValue() != entry.mCRC32) {
                                        Log.e(Constants.TAG,
                                                "CRC does not match for entry: "
                                                        + entry.mFileName);
                                        Log.e(Constants.TAG,
                                                "In file: " + entry.getZipFileName());
                                        return false;
                                    }
                                } finally {
                                    if (null != dis) {
                                        dis.close();
                                    }
                                }
                            }
                        }
                    } catch (IOException e) {
                        e.printStackTrace();
                        return false;
                    }
                }
                return true;
            }

            @Override
            protected void onProgressUpdate(DownloadProgressInfo... values) {
                onDownloadProgress(values[0]);
                super.onProgressUpdate(values);
            }

            @Override
            protected void onPostExecute(Boolean result) {
                if (result) {
                    mDashboard.setVisibility(View.VISIBLE);
                    mCellMessage.setVisibility(View.GONE);
                    mStatusText.setText(R.string.text_validation_complete);
                    mPauseButton.setOnClickListener(new View.OnClickListener() {
                        @Override
                        public void onClick(View view) {
                            finish();
                        }
                    });
                    mPauseButton.setText(android.R.string.ok);
                } else {
                    mDashboard.setVisibility(View.VISIBLE);
                    mCellMessage.setVisibility(View.GONE);
                    mStatusText.setText(R.string.text_validation_failed);
                    mPauseButton.setOnClickListener(new View.OnClickListener() {
                        @Override
                        public void onClick(View view) {
                            finish();
                        }
                    });
                    mPauseButton.setText(android.R.string.cancel);
                }
                super.onPostExecute(result);
            }

        };
        validationTask.execute(new Object());
    }

    /**
     * If the download isn't present, we initialize the download UI. This ties
     * all of the controls into the remote service calls.
     */
    private void initializeDownloadUI() {
        mDownloaderClientStub = DownloaderClientMarshaller.CreateStub
                (this, SampleDownloaderService.class);
        setContentView(R.layout.main);

        mPB = (ProgressBar) findViewById(R.id.progressBar);
        mStatusText = (TextView) findViewById(R.id.statusText);
        mProgressFraction = (TextView) findViewById(R.id.progressAsFraction);
        mProgressPercent = (TextView) findViewById(R.id.progressAsPercentage);
        mAverageSpeed = (TextView) findViewById(R.id.progressAverageSpeed);
        mTimeRemaining = (TextView) findViewById(R.id.progressTimeRemaining);
        mDashboard = findViewById(R.id.downloaderDashboard);
        mCellMessage = findViewById(R.id.approveCellular);
        mPauseButton = (Button) findViewById(R.id.pauseButton);
        mWiFiSettingsButton = (Button) findViewById(R.id.wifiSettingsButton);

        mPauseButton.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View view) {
                if (mStatePaused) {
                    mRemoteService.requestContinueDownload();
                } else {
                    mRemoteService.requestPauseDownload();
                }
                setButtonPausedState(!mStatePaused);
            }
        });

        mWiFiSettingsButton.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View v) {
                startActivity(new Intent(Settings.ACTION_WIFI_SETTINGS));
            }
        });

        Button resumeOnCell = (Button) findViewById(R.id.resumeOverCellular);
        resumeOnCell.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View view) {
                mRemoteService.setDownloadFlags(IDownloaderService.FLAGS_DOWNLOAD_OVER_CELLULAR);
                mRemoteService.requestContinueDownload();
                mCellMessage.setVisibility(View.GONE);
            }
        });

    }

    /**
     * Called when the activity is first create; we wouldn't create a layout in
     * the case where we have the file and are moving to another activity
     * without downloading.
     */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        /**
         * Both downloading and validation make use of the "download" UI
         */
        initializeDownloadUI();

        /**
         * Before we do anything, are the files we expect already here and
         * delivered (presumably by Market) For free titles, this is probably
         * worth doing. (so no Market request is necessary)
         */
        if (!expansionFilesDelivered()) {

            try {
                Intent launchIntent = SampleDownloaderActivity.this
                        .getIntent();
                Intent intentToLaunchThisActivityFromNotification = new Intent(
                        SampleDownloaderActivity
                        .this, SampleDownloaderActivity.this.getClass());
                intentToLaunchThisActivityFromNotification.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK |
                        Intent.FLAG_ACTIVITY_CLEAR_TOP);
                intentToLaunchThisActivityFromNotification.setAction(launchIntent.getAction());

                if (launchIntent.getCategories() != null) {
                    for (String category : launchIntent.getCategories()) {
                        intentToLaunchThisActivityFromNotification.addCategory(category);
                    }
                }

                // Build PendingIntent used to open this activity from
                // Notification
                PendingIntent pendingIntent = PendingIntent.getActivity(
                        SampleDownloaderActivity.this,
                        0, intentToLaunchThisActivityFromNotification,
                        PendingIntent.FLAG_UPDATE_CURRENT);
                // Request to start the download
                int startResult = DownloaderClientMarshaller.startDownloadServiceIfRequired(this,
                        pendingIntent, SampleDownloaderService.class);

                if (startResult != DownloaderClientMarshaller.NO_DOWNLOAD_REQUIRED) {
                    // The DownloaderService has started downloading the files,
                    // show progress
                    initializeDownloadUI();
                    return;
                } // otherwise, download not needed so we fall through to
                  // starting the movie
            } catch (NameNotFoundException e) {
                Log.e(LOG_TAG, "Cannot find own package! MAYDAY!");
                e.printStackTrace();
            }

        } else {
            validateXAPKZipFiles();
        }

    }

    /**
     * Connect the stub to our service on start.
     */
    @Override
    protected void onStart() {
        if (null != mDownloaderClientStub) {
            mDownloaderClientStub.connect(this);
        }
        super.onStart();
    }

    /**
     * Disconnect the stub from our service on stop
     */
    @Override
    protected void onStop() {
        if (null != mDownloaderClientStub) {
            mDownloaderClientStub.disconnect(this);
        }
        super.onStop();
    }

    /**
     * Critical implementation detail. In onServiceConnected we create the
     * remote service and marshaler. This is how we pass the client information
     * back to the service so the client can be properly notified of changes. We
     * must do this every time we reconnect to the service.
     */
    @Override
    public void onServiceConnected(Messenger m) {
        mRemoteService = DownloaderServiceMarshaller.CreateProxy(m);
        mRemoteService.onClientUpdated(mDownloaderClientStub.getMessenger());
    }

    /**
     * The download state should trigger changes in the UI --- it may be useful
     * to show the state as being indeterminate at times. This sample can be
     * considered a guideline.
     */
    @Override
    public void onDownloadStateChanged(int newState) {
        setState(newState);
        boolean showDashboard = true;
        boolean showCellMessage = false;
        boolean paused;
        boolean indeterminate;
        switch (newState) {
            case IDownloaderClient.STATE_IDLE:
                // STATE_IDLE means the service is listening, so it's
                // safe to start making calls via mRemoteService.
                paused = false;
                indeterminate = true;
                break;
            case IDownloaderClient.STATE_CONNECTING:
            case IDownloaderClient.STATE_FETCHING_URL:
                showDashboard = true;
                paused = false;
                indeterminate = true;
                break;
            case IDownloaderClient.STATE_DOWNLOADING:
                paused = false;
                showDashboard = true;
                indeterminate = false;
                break;

            case IDownloaderClient.STATE_FAILED_CANCELED:
            case IDownloaderClient.STATE_FAILED:
            case IDownloaderClient.STATE_FAILED_FETCHING_URL:
            case IDownloaderClient.STATE_FAILED_UNLICENSED:
                paused = true;
                showDashboard = false;
                indeterminate = false;
                break;
            case IDownloaderClient.STATE_PAUSED_NEED_CELLULAR_PERMISSION:
            case IDownloaderClient.STATE_PAUSED_WIFI_DISABLED_NEED_CELLULAR_PERMISSION:
                showDashboard = false;
                paused = true;
                indeterminate = false;
                showCellMessage = true;
                break;

            case IDownloaderClient.STATE_PAUSED_BY_REQUEST:
                paused = true;
                indeterminate = false;
                break;
            case IDownloaderClient.STATE_PAUSED_ROAMING:
            case IDownloaderClient.STATE_PAUSED_SDCARD_UNAVAILABLE:
                paused = true;
                indeterminate = false;
                break;
            case IDownloaderClient.STATE_COMPLETED:
                showDashboard = false;
                paused = false;
                indeterminate = false;
                validateXAPKZipFiles();
                return;
            default:
                paused = true;
                indeterminate = true;
                showDashboard = true;
        }
        int newDashboardVisibility = showDashboard ? View.VISIBLE : View.GONE;
        if (mDashboard.getVisibility() != newDashboardVisibility) {
            mDashboard.setVisibility(newDashboardVisibility);
        }
        int cellMessageVisibility = showCellMessage ? View.VISIBLE : View.GONE;
        if (mCellMessage.getVisibility() != cellMessageVisibility) {
            mCellMessage.setVisibility(cellMessageVisibility);
        }

        mPB.setIndeterminate(indeterminate);
        setButtonPausedState(paused);
    }

    /**
     * Sets the state of the various controls based on the progressinfo object
     * sent from the downloader service.
     */
    @Override
    public void onDownloadProgress(DownloadProgressInfo progress) {
        mAverageSpeed.setText(getString(R.string.kilobytes_per_second,
                Helpers.getSpeedString(progress.mCurrentSpeed)));
        mTimeRemaining.setText(getString(R.string.time_remaining,
                Helpers.getTimeRemaining(progress.mTimeRemaining)));

        //mAverageSpeed.setText("" + Helpers.getSpeedString(progress.mCurrentSpeed));
      //  mTimeRemaining.setText("" + Helpers.getTimeRemaining(progress.mTimeRemaining));

        progress.mOverallTotal = progress.mOverallTotal;
        mPB.setMax((int) (progress.mOverallTotal >> 8));
        mPB.setProgress((int) (progress.mOverallProgress >> 8));
        mProgressPercent.setText(Long.toString(progress.mOverallProgress
                * 100 /
                progress.mOverallTotal) + "%");
        mProgressFraction.setText(Helpers.getDownloadProgressString
                (progress.mOverallProgress,
                        progress.mOverallTotal));
    }

    @Override
    protected void onDestroy() {
        this.mCancelValidation = true;
        super.onDestroy();
    }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-22T10:33:04.707

您可以使用 StorageManager 挂载 OBB 文件：

```
StorageManager storageManager = (StorageManager)app.getSystemService(Context.STORAGE_SERVICE);
boolean queued = storageManager.mountObb(<path>, null, new OnObbStateChangeListsner() {...}); 
```

只要您有对 StorageManager IIRC 的引用，OBB 就会一直挂载。安装后，您可以使用以下方式获取路径：

```
storageManager.getMountedObbPath(...); 
```

您可以使用此路径来构造文件的路径：返回的路径是 OBB 的根目录：

```
File f = new File(storageManager.getMountedObbPath(...) + "/myimage.png"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-18T09:43:45.653

我找到了一些解决方案如下，但用户应该知道图像的名称：-

```
public static Bitmap getBitmapImage(Context mContext)
    {
        String packageName = mContext.getPackageName();
        File root = Environment.getExternalStorageDirectory();

        File expPath = new File(root.toString() + "/Android/obb/"+ packageName);

        try
        {
            if (expPath.exists()) {
               String   strMainPath = expPath
                        + File.separator
                        + "main."
                        + mContext.getPackageManager().getPackageInfo(
                                mContext.getPackageName(), 0).versionCode + "."
                        + packageName + ".obb";

                File f=new File(strMainPath);

                if(f.exists()){
                    Log.e("Path ", "=====>Exists");
                }
                else{
                    Log.e("Path ", "=====> Not Exists");
                }

                ZipResourceFile zip = new ZipResourceFile(strMainPath);
                InputStream iStream = zip.getInputStream("img1.jpg");

                BitmapFactory.Options option = new BitmapFactory.Options();
                option.inPurgeable = true;

                return BitmapFactory.decodeStream(iStream, null, option);
             }
         }
        catch(Exception e)
        {

        }
        return null;
    } 
```

谢谢！！

# java - Tomcat 6 线程问题

> ID：15141861
> 
> 赞同：0
> 
> 时间：2013-02-28T17:27:54.173
> 
> 标签：java, unix, tomcat, tomcat6

您好 frnds，我们已经在 java 1.6、tomcat 6、oracle 11g 上迁移了我们的 java web 应用程序，但是现在我们在一段时间站点关闭后遇到了问题：我们遇到了 java heap out of memory 错误并且许多线程处于等待状态。tomcat 被挂了，我们的网站正在崩溃

信息：为地址为空且端口为 80 的连接器创建的最大线程数 (200) 2013 年 2 月 21 日晚上 9:56:04 以下是线程日志：

日志

```
"main" prio=10 tid=0x09f67c00 nid=0x2d51 runnable [0xf7622000]
       java.lang.Thread.State: RUNNABLE
        at java.net.PlainSocketImpl.socketAccept(Native Method)
        at java.net.PlainSocketImpl.accept(PlainSocketImpl.java:390)
        - locked <0xc5078c60> (a java.net.SocksSocketImpl)          
    "VM Thread" prio=10 tid=0x09f8ac00 nid=0x2d52 runnable     
    "VM Periodic Task Thread" prio=10 tid=0x09f9cc00 nid=0x2d58 waiting on condition     
    JNI global references: 1074    
    Heap
     def new generation   total 78656K, used 78533K [0xbf760000, 0xc4cb0000, 0xc4cb0000)
      eden space 69952K, 100% used [0xbf760000, 0xc3bb0000, 0xc3bb0000)
      from space 8704K,  98% used [0xc4430000, 0xc4c91428, 0xc4cb0000)
      to   space 8704K,   0% used [0xc3bb0000, 0xc3bb0000, 0xc4430000)
     tenured generation   total 174784K, used 174783K [0xc4cb0000, 0xcf760000, 0xcf760000)
       the space 174784K,  99% used [0xc4cb0000, 0xcf75fff8, 0xcf760000, 0xcf760000)
     compacting perm gen  total 33792K, used 33647K [0xcf760000, 0xd1860000, 0xd3760000)
       the space 33792K,  99% used [0xcf760000, 0xd183be68, 0xd183c000, 0xd1860000)
        ro space 10240K,  61% used [0xd3760000, 0xd3d86298, 0xd3d86400, 0xd4160000)
        rw space 12288K,  60% used [0xd4160000, 0xd4896cb8, 0xd4896e00, 0xd4d60000) 
```

结尾

请指导。

谢谢，阿鲁

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T17:36:27.417

根据您发布的日志，您`JAVA_OPTIONS`在上面的评论中提到的 jvm 设置（在 中定义）根本没有得到尊重/使用。
（例如`32m`for permgen 用于代替指定的`512m`）。

我的猜测是您只是为环境变量使用了错误的名称：
在 tomcat 中指定 JVM 设置的正确环境变量名为`JAVA_OPTS`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T17:31:52.177

看起来 perm gen 空间已全部使用。您是否尝试过使用 -XX:MaxPermSize=128M 来增加它？

# ruby-on-rails - 在数据库中设计重置密码？

> ID：15141868
> 
> 赞同：1
> 
> 时间：2013-02-28T17:28:24.760
> 
> 标签：ruby-on-rails, devise

我想直接在数据库中重置用户的密码。我可以看到密码通常存储为加密哈希 - 我的选择是什么？

我正在使用设计。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T17:37:58.340

刚刚注意到您说“直接在数据库中”。然后你得到的第一条评论效果最好。

如果你仍然可以通过 rails 来实现（例如在迁移中），你可以试试这个：

```
user = User.find(...)
# set plain text password, it will run 'encrypted_password=' under the hood
user.password = "new password" 
user.save 
```

之后，您可能需要发送电子邮件通知或重置 authentication_token，具体取决于您的情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T18:19:52.460

@cjm2671，简短的回答是否定的，你不应该。[在https://github.com/plataformatec/devise/blob/master/lib/devise/models/database_authenticatable.rb#L4](https://github.com/plataformatec/devise/blob/master/lib/devise/models/database_authenticatable.rb#L4)中查看 Devise 是如何做到的

```
 # Verifies whether an password (ie from sign in) is the user password.
  def valid_password?(password)
    return false if encrypted_password.blank?
    bcrypt   = ::BCrypt::Password.new(encrypted_password)
    password = ::BCrypt::Engine.hash_secret("#{password}#{self.class.pepper}", bcrypt.salt)
    Devise.secure_compare(password, encrypted_password)
  end 
```

为什么要直接在数据库上做呢？

如果必须，您将需要数据库上的 BCrypt（例如 PostgreSQL 的 pgcrypto）和`self.class.peper`. 我假设`bcrypt.salt`将由 BCrypt 提供。

**更新：**

我开始怀疑是否有可能，我很快跳到 pgcrypto，但它似乎没有做你想做的事。

# python - Python - trml2pdf 生成空白 PDF

> ID：15141871
> 
> 赞同：1
> 
> 时间：2013-02-28T17:28:40.470
> 
> 标签：python, pdf, rml

我在 Python 中使用 trml2pdf 库，但即使我使用示例，我也会得到一个空白的 PDF 文件。我按如下方式运行它：trml2pdf.py ex5.rml > out.pdf

当我在 Acrobat 中打开文件时，它是空白/空的。但是当我在文本编辑器中分析内容时，我看到以下内容。

生成的PDF：

```
%PDF-1.4

%“Œ‹ž ReportLab Generated PDF document http://www.reportlab.com

% 'BasicFonts': class PDFDictionary 

1 0 obj

% The standard fonts dictionary

<< /F1 2 0 R

 /F2 3 0 R

 /F3 4 0 R >> 
```

示例 PDF：

```
%PDF-1.3
%“Œ‹ž ReportLab Generated PDF document http://www.reportlab.com
% 'BasicFonts': class PDFDictionary 
1 0 obj
% The standard fonts dictionary
<< /F1 2 0 R
 /F2 3 0 R
 /F3 4 0 R
 /F4 5 0 R
 /F5 6 0 R >> 
```

我究竟做错了什么？为什么我在输出中得到空行？

谢谢！

这是也返回空白 PDF 的基本 RML：

```
<!DOCTYPE document SYSTEM "rml_1_0.dtd">
<document filename="example_1.pdf">
<stylesheet>
</stylesheet>
<pageDrawing>
     <drawCentredString x="4.1in" y="5.8in">
       Hello World.
 </drawCentredString>
</pageDrawing>
</document> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-04-07T08:04:13.187

在过去的 6-8 个月里，我一直[`z3c.rml`](https://pypi.python.org/pypi/z3c.rml)在许多网络应用程序中使用，从未遇到任何重大问题。`rml2pdf`此包中的命令能够为您共享的 rml 生成 PDF。

你应该试一试。

```
#Install z3c.rml
[sudo] pip install z3c.rml

# create a new rml document
vim example.rml

# rum rml2pdf command to convert this rml to pdf
rml2pdf example.rml

# You should have desired PDF file now 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-12-08T18:01:35.950

我正在使用 trml2pdf 并且它正在成功运行，我在这里发布我的代码，以便您查看

```
from django.template.loader import get_template
from django.template.context import Context
import trml2pdf
def invoicepdf(request):
    template = get_template('invoice.rml')
    context = Context({
        'name': "XXXXXXXXXX", 
        'date':_date, 
        'subtotal':1909201,
        'total': 345789

     })
    xmlstring = template.render(context)
    pdfstr = trml2pdf.parseString(xmlstring)
    response = HttpResponse(mimetype='application/pdf')
    response.write(pdfstr)
    response['Content-Disposition'] = 'attachment; filename=invoice.pdf'
    return response 
```

RML 代码

发票.rml

```
<!-- This is very Invoice RML template for illustrative purposes.  -->
<!-- A basic RML template has three sections.  The 'template'     --> 
<!-- section is where you define fixed position elements, along   -->
<!-- with 'frames' containing  flowing text.  The 'stylesheet'    -->
<!-- section contains re-useable text style definitions.  The     -->
<!-- 'story' section contains the text and graphics which fill    -->
<!-- up the frames defined in the template section.               -->
<!-- For more information, please read the documentation at       -->
<!-- http://www.reportlab.com/software/documentation/             -->

<!DOCTYPE document SYSTEM "rml.dtd">
<document filename="invoice.pdf">
    <!-- left margin -->
<template title="Invoices" author="Atul jain" allowSplitting="20">
<pageTemplate id="first">
  <frame id="first" x1="34.0" y1="28.0" width="530" height="786"/>
  <pageGraphics>
    <lines>0.3cm 27.0cm 20cm 27.0cm</lines>
  </pageGraphics>
</pageTemplate>
 </template> 
 <story>
<para>
  <font color="white"> </font>
</para>
<para><b>Name:- {{name}} </b></para>
<para><b>Date:- {{date}} </b></para>
  <blockTable colWidths="385.0,60.0,85.0">
  <tr>
    <td>
      <para>
        <font color="white"> </font>
      </para>
    </td>
    <td>
      <para>Net Total:</para>
    </td>
    <td>
      <para>{{subtotal}} INR;</para>
    </td>
  </tr>
  <tr>
    <td>
      <para>
        <font color="white"> </font>
      </para>
    </td>
    <td>
      <para><b>Total:</b></para>
    </td>
    <td>
      <para><b>{{total}} INR;</b></para>
    </td>
  </tr>
</blockTable>   
 </story>
</document> 
```

# class - VBA：字典内存问题？填充 dict、.removeall、填充问题

> ID：15141872
> 
> 赞同：2
> 
> 时间：2013-02-28T17:28:44.607
> 
> 标签：class, vba, object, excel, dictionary

所以我在这里使用了一些代码，我使用一个字典来填充两个不同的字典，这些字典作为自定义类中的属性保存。我这样做是为了提高效率。

注意：我通过为要设置的每个属性使用字典来解决此问题，但这并不太有效。

所以大致这是我的代码：

```
for iKey = 1 to class.maxnumber ' 8
    dTempDict.add iKey, cdbl(24)   ' enforce to 24 for calcs later
next iKey

Set class.dict1 = dTempDict ' commit to class.dict1

dTempDict.removeall 'wipe temp dictionary

for iKey = 1 to class.maxnumber ' 8
    dTempDict.add iKey, "word"   ' something other than 24 to test
next iKey

Set class.dict2 = dTempDict 
```

所以上面的工作正常。然后我尝试循环并打印 class.dict1 的键没有问题。然后，当我尝试将值分配给预先声明的 dbl 时，我遇到了麻烦。然后我在不同的子传递类byref中循环遍历每个键：

```
dim dTempDict as scripting.dictionary
Set dTempDict = class.dict1 
for each iKey in dTempDict
 msgbox typename(dTempDict.Item(iKey))
next iKey 
```

这带来了结果......“字符串”......令人困惑。然后我将我的值持有者更改为一个字符串并且它起作用了。我已经检查了类中的访问器，并且它们没有循环回错误的字典属性，因此看起来即使我将它们分配到第二个甚至执行了 .removeall，我的第二个字典的值也会填充到第一个字典中。

有任何想法吗？

如上所述，对 class.dict1 和 class.dict2 使用不同的临时字典，它们被正确分配，但这仍然令人困惑。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T22:14:49.470

一般来说，我不喜欢在课堂上放字典，除非是为了开其他课。我不知道你的情况，所以无法评论。但无论 '24' 是什么，您可能会认为它应该是它自己的对象，并且您的类将包含另一个集合类。顺便说一句，我为此目的使用集合而不是字典。然后你访问像

```
clsDepartment.Employees.Count 
```

代替

```
clsDepartment.mydict(1) 
```

无论如何，对于你所拥有的，你应该在类中填充字典而不是创建临时字典。如果你的班级看起来像这样

```
Private mdcTwentyFour As Scripting.Dictionary
Private mdcNotTwentyFour As Scripting.Dictionary

Public Property Get TwentyFour() As Scripting.Dictionary
    Set TwentyFour = mdcTwentyFour
End Property

Public Property Get NotTwentyFour() As Scripting.Dictionary
    Set NotTwentyFour = mdcNotTwentyFour
End Property

Public Property Get MaxNumber() As Long
    MaxNumber = 8
End Property

Private Sub Class_Initialize()

    Set mdcTwentyFour = New Scripting.Dictionary
    Set mdcNotTwentyFour = New Scripting.Dictionary

End Sub 
```

那么你的潜艇可能看起来像这样

```
Sub FillClassDicts()

    Dim clsClass As CClass
    Dim i As Long

    Set clsClass = New CClass

    For i = 1 To clsClass.MaxNumber
        clsClass.TwentyFour.Add i, 24
        clsClass.NotTwentyFour.Add i, "word"
    Next i

    Debug.Print clsClass.TwentyFour.Count, clsClass.NotTwentyFour.Count
    Debug.Print TypeName(clsClass.TwentyFour(1)), TypeName(clsClass.NotTwentyFour(5))

End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T19:37:14.690

当你这样做...

```
Set class.dict1 = dTempDict 
dTempDict.removeall 
'...
Set class.dict2 = dTempDict 
```

... 然后两者都`dict1`指向`dict2`同一个 Dictionary 对象 ( `dTempDict`)。

将一个对象变量分配给另一个对象变量不会创建该对象的副本，而只会导致指向同一对象的附加“指针”。

您应该创建一个新的 Dictionary 而不是重新使用同一个来分配给`dict2`.

# apache - 字节范围不在 HTML5 音频的请求标头中

> ID：15141874
> 
> 赞同：0
> 
> 时间：2013-02-28T17:28:50.857
> 
> 标签：apache, google-chrome, audio-streaming, html5-audio

我正在通过 read_file.php 流式传输 *.mp3 文件，由 listen.php 请求。

read_file.php - 正确处理字节范围，并提供具有正确标题的文件的正确字节范围。

listen.php - 包含一个 HTML5 音频元素，其中 read_file.php?id=XX 作为 src

XX.mp3 - 我希望分块提供的大型 mp3 文件。

HTML5 Audio 元素触发的请求似乎并不总是在请求标头中发送 Requested 字节范围。在首次加载时，标头包含“字节范围：0-”。响应标头看到了这一点，并提供了文件的一部分。

结果是：

提前搜索按预期工作。回溯（1）被取消，或者（2）从文件的开头重新开始，这取决于我如何选择 read_file.php 中的逻辑来处理 NULL 字节范围。

任何指示/想法，或者我敢说...答案？

相关的 Chrome 错误：[http ://pastebin.com/raw.php?i=2pBjnF00](http://pastebin.com/raw.php?i=2pBjnF00)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-07-31T20:35:23.030

对于后代，这里是最终（工作）形式的标题：

```
header("Content-Type: audio/mpeg");
header('Cache-Control: '); //blank for IE
header('Pragma: ');   // blank for IE
header('Accept-Ranges: bytes');
header('Content-Length:'.$length);
header("Content-Range: bytes $begin-".$end."/$length");
header("Content-Disposition: inline; filename=$filename");
header("Content-Transfer-Encoding: binary");
header("Last-Modified: $time");

header('Connection: close'); 
```

# antlr4 - 如何匹配 ANTLR4 中的任何字符？

> ID：15141879
> 
> 赞同：2
> 
> 时间：2013-02-28T17:29:07.740
> 
> 标签：antlr4

我想匹配 \u0000 到 \uFFFF 范围内的任何字符，以下代码是不够的：

```
grammar CharacterClass;

start   :       CH* EOF;
CH      :       [\u0000-\uFFFF]; 
```

**编辑：**

我在问，因为我想在类似 XML 的结构中插入二进制数据：

```
<binary:key>uhihahdudi    some binary data, that should be ignored by ANTLR
izgizgio</binary:key> 
```

当然可以将自己限制在 [\u0000-\u00FF] 范围内，并且我的 Inputstream 只输出已处理数据的字节值，但是我必须实现额外的逻辑才能使用我的实际文本数据。

对我来说最好的解决方案是，ANTLR 以某种方式跳过二进制部分，所以我可以处理文本数据（要处理二进制部分，我只需要这些部分的开始和结束位置）；

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-28T18:40:35.377

ANTLR 4 只能匹配范围`[\u0000-\uFFFE]`。如果您确实需要匹配所有可能的输入，则需要匹配`[\u0000-\u00FF]`输入并将其作为字节而不是 UTF-16 字符提供给解析器。

编辑：另见[`Lexer.MIN_CHAR_VALUE`和`Lexer.MAX_CHAR_VALUE`](http://antlr.org/api/Java/constant-values.html#org.antlr.v4.runtime.Lexer.MAX_CHAR_VALUE)常量。

# android - 如何获取在android中更新值的特定行

> ID：15141883
> 
> 赞同：3
> 
> 时间：2013-02-28T17:29:40.890
> 
> 标签：android, sqlite, cursor

我正在使用 SQLite 数据库。每次更新 1 或 2 行值时，表中会持续更新。

例如：现在 TABLE1 中有 20 行，其中一些行值得到更新。

**我们能知道 TABLE1 中哪些行得到了更新吗？**

我有解决方案，但性能对我很重要。游标使用选择所有行的选择查询注册数据观察者，当有更新时，我检索具有更新值的整个 20 行，做我的编码。因此，如果有 100 行，我需要循环所有行，这对于低端设备来说是一项乏味的任务。

请协助解决方案，即如何使用游标检索 Android 表中的更新行。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-28T17:39:10.817

如果您可以更改表，则添加一个 TIMESTAMP 类型的新列“modified_time”。每当更新行时更新此列。

现在，当您想知道更新了哪些行时，请运行以下 SQL 查询：

`select _id from table2 where modified_time = (select max(modified_time) from table2)`

此查询的结果给出了最新更新的所有行的 id。

**编辑：** 正如您在评论中提到的“...*服务器将数据推送到具有更改值的表中。我需要获取更新值并更新到其他表*”，您最好的选择是在数据库中创建一个触发器将根据第一个表的更新更新第二个表。这是方法。

假设服务器将数据推送到“table1”并且您想要监控更新的行。创建另一个 table2（或使用现有的），它将自动更新。

现在，创建一个触发器，如下所示：

```
CREATE TRIGGER trigger1 AFTER UPDATE ON table1
 BEGIN
  update table2 SET modified_time = datetime('now') WHERE row_id = old._id;
 END; 
```

当然，您的 table2 会有所不同，但想法是您可以使用触发器自动在 table2 中插入或更新行。您可以参考这些 SO 帖子以获取更多详细信息：

[sqlite3 是否支持自动更新“updated_on”日期时间字段的触发器？](https://stackoverflow.com/questions/1964233/does-sqlite3-support-a-trigger-to-automatically-update-an-updated-on-datetime)

[使用 SQLite 触发器更新“LastModified”字段](https://stackoverflow.com/questions/10804892/using-sqlite-trigger-to-update-lastmodified-field)

**示例应用程序：** 我创建了一个示例应用程序，以根据您描述的场景演示在 Android 应用程序中使用 Trigger。您可以在此处下载 Eclipse 项目 - [trigger_example_eclipse_project.zip](http://www.appsrox.com/shared/trigger_example_eclipse_project.zip)

简而言之，示例应用程序有一个*产品*表，它接收产品价格的更新。因此，我们创建了另一个*更新*表，它将通过触发器根据*产品表上的更新自动更新。*

有一个 UI 可以通过 EditText 字段和按钮来模拟*产品表的更新。*为了显示最近的更新，我们有一个 ListView，它使用 Cursor 从*更新*表中获取数据。

这里有一些来自 DbHelper.java 的相关代码片段

```
public class DbHelper extends SQLiteOpenHelper {

    public static final String TABLE1 = "product";
    public static final String TABLE2 = "updates";

    public static final String COL_ID = "_id";
    public static final String COL_NAME = "name";
    public static final String COL_PRICE = "price";
    public static final String COL_MODIFIED_TIME = "modified_time";

    public static final String KINDLE = "Kindle";

    private static final String SQL_CREATE_TABLE1 = 
            "CREATE TABLE product (_id INTEGER PRIMARY KEY AUTOINCREMENT, name TEXT, price INTEGER);";

    private static final String SQL_CREATE_TABLE2 = 
            "CREATE TABLE updates (_id INTEGER PRIMARY KEY AUTOINCREMENT, name TEXT, price INTEGER, modified_time TIMESTAMP);";

    private static final String SQL_CREATE_TRIGGER = 
            "CREATE TRIGGER price_update AFTER UPDATE OF price ON product"+
            "   BEGIN" +
            "       INSERT INTO updates(name,price,modified_time) VALUES(old.name,new.price,datetime('NOW'));"+
            "   END;";

    public DbHelper(Context context) {
        super(context, "sampledb", null, 1);
    }

    @Override
    public void onCreate(SQLiteDatabase db) {
        db.execSQL(SQL_CREATE_TABLE1);
        db.execSQL(SQL_CREATE_TABLE2);
        db.execSQL(SQL_CREATE_TRIGGER);

        ContentValues cv = new ContentValues();
        cv.put(COL_NAME, KINDLE);
        cv.put(COL_PRICE, 99);
        db.insert(TABLE1, null, cv);
    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int arg1, int arg2) {
    }

} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-06T13:15:40.103

您可以保留 LAST_UPDATE_TIME 之类的列，在更新时使用当前时间进行更新。

然后，您可以查询 LAST_UPDATE_TIME > 所需时间的所有行。

如果您不能更改表，您可以创建一个具有相同列的新表吗？然后，您可以在两个表中进行更新，并在需要时从新表中获取值，并在完成后仅从新表中删除它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-10T22:55:32.410

如果您正确实现 ContentProvider，则插入或更新可能会返回该行的 id。

这有点复杂，但是看看[Google 的 IOSchedule 应用程序](http://code.google.com/p/iosched/source/browse/#git/android/src/com/google/android/apps/iosched/provider)，查看**Provider**和**Contract**类，查看 Contracts 中的**Room**类以及插入或更新方法中 Provider 中的“Room”案例。
您会看到将返回一个 Uri，在这种设计方法中，最后一个元素（在最后一个斜杠之后）是插入/更新行的**id**。

我这种方法可以帮助你，并且你可以理解谷歌的源代码来完成你的工作（我发现它有点难以理解）

# python - 从 Python 开发开始：抛硬币循环

> ID：15141890
> 
> 赞同：0
> 
> 时间：2013-02-28T17:30:00.673
> 
> 标签：python, coin-flipping

整个下午，

作为一个想要自学编程的人，我遇到了你的道路。因此，我开始使用 Python。作为免责声明，我已经在问题中搜索了一些 Python 掷硬币的示例，但我并没有真正理解以前的提问者提出的任何代码。

**我的任务** 我的教育材料要求我设计一个应用程序，将虚拟硬币翻转 100 次，然后打印结果。我的想法是使用无限循环，当掷硬币达到 100 时爆发，然后打印结果。

我还没有完全做到这一点，我没有发现我所写的错误。它似乎实现了 100 次翻转，但随后只打印出 50 次正面/反面；因此我的错误在计数逻辑的某个地方？

任何解释（记住我是初学者，而不是白痴！）都会得到我的感谢和我的支持

谢谢阅读

```
# Exercise 3.2
# Heads and Tails coin flip

#import random
import random

#declare variables
heads = 0
tails = 0
cointoss = 0
coinresult = random.randint(1,2)

#start the loop
while True:
    cointoss +=1

    #end the loop if cointoss is greater than 100
    if cointoss > 100:
        break
    if coinresult == 1:
        heads +=1
        cointoss +=1
    elif coinresult == 2:
        tails +=1
        cointoss +=1

  print("Heads came up", heads, "times")
  print("Tails came up", tails, "times") 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-28T17:32:28.813

你`cointoss`每循环增加两次。

```
while True:
    cointoss +=1      # You already incremented here, therefore...
    if cointoss > 100:
        break
    if coinresult == 1:
        heads +=1
        cointoss +=1  # ...get rid of this...
    elif coinresult == 2:
        tails +=1
        cointoss +=1  # ...and this. 
```

此外，正如所指出的，您应该`coinresult`在循环内的某个地方获得一个新的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-28T17:32:05.317

把这一行：

```
coinresult = random.randint(1,2) 
```

在while循环内。否则，您将获得一次价值，然后在循环内一遍又一遍地使用它，并且您在每个循环的两个地方添加了硬币。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-28T17:34:18.463

[通过使用range](http://docs.python.org/2/library/functions.html#range)方法，您可能会更轻松地编写循环，如下所示：

```
for i in range(0, 100):
    coinresult = random.randint(1, 2)
    if coinresult == 1:
        heads += 1
    else:
        tails += 1
print("Heads came up", heads, "times")
print("Tails came up", tails, "times") 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-28T17:36:02.363

```
# Exercise 3.2
# Heads and Tails coin flip

#import random
import random

#declare variables
heads = 0
tails = 0
cointoss = 0
coinresult = random.randint(1,2)

#start the loop
while True:
   cointoss +=1

#end the loop if cointoss is greater than 100
   if cointoss > 100:
       break
   if coinresult == 1:
       heads +=1
   elif coinresult == 2:
       tails +=1
   coinresult = random.randint(1,2)

print("Heads came up", heads, "times")
print("Tails came up", tails, "times") 
```

你从来没有回忆起你的随机化，因此这个数字永远不会改变，并且你在每个循环的两个地方添加了投币。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-28T17:38:23.583

如果您想冒险，请查看[生成器表达式](http://www.python.org/dev/peps/pep-0289/)和内置[sum](http://docs.python.org/2/library/functions.html#sum)以及 random.randint

```
heads = sum(random.randint(0,1) for _ in range(100))
print("Heads came up {} times".format(heads))
print("Tails came up {} times".format(100 - heads)) 
```

# php - 让其他人在服务器外使用我的表单 java script 或 php

> ID：15141896
> 
> 赞同：0
> 
> 时间：2013-02-28T17:30:17.137
> 
> 标签：php, javascript

我想知道是否有人可以就完成以下任务的最佳方法向我提供一些建议：

我有一些 html 表单，它们只是发布一个用于处理数据的 php 页面。

让其他人在我的服务器之外的网站上实现我的表单的最佳方法是什么？（很重要，因为我尝试了一个简单的 php 包含，但是在服务器之外执行此操作是一个问题。）

我试过 file_get_contents 但这种方法不尊重 css。

我正在寻找最简单、最优雅的解决方案，为会员提供一种通过一行代码将我的表单添加到他们网站的方法。

这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T17:42:01.697

这是可能的，但这是一个巨大的安全问题；黑客有可能将该位置的内容更改为错误的位置。

您可以通过设置来做到这一点

```
allow_url_include = 1
allow_url_fopen = 1 
```

（因此允许通过互联网进行 require 和 include ）。

我还读到 PEAR HTTP_Request2 模块或 curl 函数可用于获取网页。

但是您应该考虑不这样做，只需允许人们将表单复制/粘贴到他们的网站。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-28T17:34:41.013

您可以：

1.  给他们 HTML/CSS 和 Javascript 以放在他们自己的网站上，或者；
2.  为您的表单创建一个 iframe，他们可以将其放入他们的网站或；
3.  创建一个 javascript 文件，该文件将构建 HTML 并根据需要包含所有相关的 CSS/JS 文件。然后你可以给他们一些这样的代码，让他们把它放在他们想要表单的网站上。

> <script type="text/javascript" src="http://url.to/your/website/and/the/script.js"></script>
> 
> <script type="text/javascript"> runBuildFormFunction(); </脚本>

# android - 图像视图调整大小在 2.3.6 和 4.1.2 中的行为不同

> ID：15141899
> 
> 赞同：2
> 
> 时间：2013-02-28T17:30:26.930
> 
> 标签：android, android-layout, android-widget

我正在创建一个从网络下载图片并在 ImageView 中显示它们的应用程序。我想按比例调整 imageview 中的图像大小，所以我在 2.3.6 中使用了这个代码来完成这个：

```
mImage.setLayoutParams(new LayoutParams(LayoutParams.MATCH_PARENT, LayoutParams.MATCH_PARENT));
mImage.setAdjustViewBounds(true);
mImage.setScaleType(ScaleType.FIT_CENTER ); 
```

这工作得很好，但在 4.1.2（我没有其他版本的 android 4.x）上这似乎没有效果。图片保留在屏幕的顶部/左侧，并且没有应用任何调整大小。有人知道发生了什么吗？对 4.1.2 有什么改变吗？文档没有说明任何关于它的内容。

提前致谢。

# unix - 使用 sub 时 awk 保留字段分隔符

> ID：15141901
> 
> 赞同：0
> 
> 时间：2013-02-28T17:30:29.533
> 
> 标签：unix, awk

我正在尝试“混淆”javascript代码（使其不可读以避免盗版）我正在使用awk来执行此操作。这适用于长词，但不适用于单字符词。

输入文本 ：

```
var t=document.getElementById(u) 
```

预期输出：

```
var b7=document.getElementById(b8) 
```

实际输出：

```
var b7 document getElementById b8 
```

awk 代码：

```
${cor_var} is a unix variable which contains "t" in our example
${obf_var} is a unix variable which contains "b7" (the obfuscated variable)

awk -v AWK_COR_VAR="${cor_var}" -v AWK_OBF_VAR="${obf_var}" '

      # We use Non-word characters as field separator
      # Like this we can extract var/func
      BEGIN {FS="[^A-Za-z0-9_]+"}
      {
        if ($0 ~ AWK_COR_VAR) {
          # On a line containing our word, we go through each field till we find our word
          # and then we replace it with sub
          for ( x = 1; x < NF; x++ ) {
            # Output fields with space as delimiter
            if ($x == AWK_COR_VAR) {sub($x, AWK_OBF_VAR, $x)};
          }
          print $0;
        } else {print $0}
      }' $file 
```

似乎子函数摆脱了字段分隔符。我还尝试了没有第三个参数的 sub ，它保留了字段分隔符，但也在不应该的地方更改了“t”：

```
if ($x == AWK_COR_VAR) {sub($x, AWK_OBF_VAR)}; 
```

输出 ：

```
b7=documenb7.getElementById(t) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T19:30:37.453

`sub`没有摆脱你的字段分隔符。正在发生的事情是：

1.  awk 在将每一行解析为字段时会固有地丢弃字段分隔符文本`$1`。最初保留为原始行文本。`$NF``$0`
2.  当您重新分配一个字段（例如`$1`）时，awk将*重新生* `$0`成为所有字段的串联，由`OFS`输出字段分隔符分隔。`OFS`是一个空格，默认情况下。

因此，当 you 时`print $0`，您有两种情况：（1）您没有修改任何字段，因此您看到的是原始完整行。(2) 您*确实*修改了一个字段，因此您看到一行被删除了任何标点符号。

如果你继续沿着这条路走下去，你需要做的是保留原来的标点符号。这意味着*不*使用`FS`to 进行标记化。您需要做一些更像是迭代扫描单词边界、检测触发标记以及在进行过程中构建结果行的事情。或类似的东西。

但要小心！您还需要注意，如果您不够老练，您可能会在带引号的字符串 ( `"I want a t-shirt."`) 和 Javascript 属性名称 ( `blort = foo.t.bar`) 中找到变量名称。

我*真正的*建议是只使用几个现有的 Javascript 混淆器之一。Google 的 Closure [https://developers.google.com/closure/](https://developers.google.com/closure/)是一个包含混淆的工具包，是一个不错的选择。

# c# - 可以在没有内部浏览器的 Windows Phone 7 上执行 Oauth 2 吗？

> ID：15141904
> 
> 赞同：0
> 
> 时间：2013-02-28T17:30:38.633
> 
> 标签：c#, windows-phone-7, google-api, oauth-2.0

我想使用一些来自 google api 的 api。但是，要获取私有数据，我需要使用 oAuth v2。

从我从使用 oAuth（forfoursquare）的人的教程中看到的是，他们使用的是内部浏览器。我想知道是否有

a）一种绕过这个并做其他方式的方法

b) 或者我怎样才能让内部浏览器看起来不错。

我所说的选项“b”的意思是，当用户进入我的应用程序时，他们会看到内部浏览器加载了 Google 登录。在他们进行身份验证后，我会获得短暂的令牌，然后访问他们的私人数据。

对我来说，这意味着每次用户登录我的应用程序时，他们都必须看到那个丑陋的内部浏览器。即使我将 Google 身份验证设置为一次（在他们第一次登录后），下次我仍然需要再次向他们展示内部浏览器以获取新令牌。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-17T06:51:42.373

您**必须**为 OAuth 身份验证显示 Web 浏览器。这是一般 OAuth 的要求。

# xpath - 使用 XPath 从 html 页面获取标题标签？

> ID：15141910
> 
> 赞同：2
> 
> 时间：2013-02-28T17:30:55.043
> 
> 标签：xpath, domdocument, domxpath, xpathquery

我有两个页面试图从使用 Xpath 查询中提取标题标签。此页面有效： http: [//www.hobbyfarms.com/farm-directory/category-home-and-barn-resources-1.aspx](http://www.hobbyfarms.com/farm-directory/category-home-and-barn-resources-1.aspx)

此页面没有： [http ://cattletoday.com/links/Barns_and_Metal_Buildings/page-1.html?s=A](http://cattletoday.com/links/Barns_and_Metal_Buildings/page-1.html?s=A)

这是我的代码：

```
$dom = new DOMDocument();
@$dom->loadHTMLFile($href);
$xpath = new DOMXPath($dom);

$titleNode = $xpath->query("//title");
foreach ($titleNode as $n) {
    $pageTitle = $n->nodeValue;
} 
```

我也试过这个：

```
$xpath->query('//title')->item(0)->textContent 
```

但它也不适用于一个 URL。

有谁知道为什么会这样？并希望有一个解决方案。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-01T18:48:44.607

文件已压缩，以下脚本有效：

```
$href = 'http://cattletoday.com/links/Barns_and_Metal_Buildings/page-1.html?s=A';
$dom = new DOMDocument();
$file = gzdecode(file_get_contents($href));
$dom->loadHTML($file);
$xpath = new DOMXPath($dom); 
$titleNode = $xpath->query('//title');
var_dump($titleNode->item(0)); 
```

（注意使用的 gzdecode 函数）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-28T19:52:34.057

第二个页面使用 XHTML 命名空间，因此您必须使用具有该命名空间的 XPath 限定：

```
$xpath->registerNamespace("xhtml", "http://www.w3.org/1999/xhtml");
$titleNode = $xpath->query("//xhtml:title|//title"); 
```

# java - For循环正在崩溃

> ID：15141913
> 
> 赞同：1
> 
> 时间：2013-02-28T17:31:07.813
> 
> 标签：java, android, for-loop, crash

请检查给定的代码，我在 C++ 中使用了相同的代码，并进行了细微的更改，它运行得很好。我也期待着为 android 制作它。但是我只是按下计算按钮就崩溃了。请告诉我这里有什么问题。PS我是初学者。

**我的 main.xml：**

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:id="@+id/main"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical" >

<TextView
    android:id="@+id/textView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_gravity="center"
    android:text="Optimum Tilt Angle Calculator"
    android:textAppearance="?android:attr/textAppearanceLarge" />

<Button
    android:id="@+id/button1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_gravity="center"
    android:text="Calculate" />

<TextView
    android:id="@+id/beta"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_gravity="center"
    android:text="Beta = "
    android:textAppearance="?android:attr/textAppearanceLarge" />

<TextView
    android:id="@+id/rad"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_gravity="center"
    android:text="H = "
    android:textAppearance="?android:attr/textAppearanceLarge" /> 
```

* * *

**我的 Tilt.java：**

```
 package com.ned.tilt;

    import android.app.Activity;
    import android.os.Bundle;
    import android.view.View;
    import android.widget.Button;
    import android.widget.EditText;
    import android.widget.TextView;

    public class Tilt extends Activity implements android.view.View.OnClickListener {
private static final double PI = 3.142;
private static final double PHI = 24.8508 * (PI / 180);
private static final double Gsc = 1367;
private static final double RO = 0.2;
int i, beta, ang;

double delta, ws, wss, Hom[], Gon[], Kt[], Hd[], Rb, Rb_num, Rb_den, Ra,
        Htm, Ht;
int nbar[] = { 17, 47, 75, 105, 135, 162, 198, 228, 258, 288, 318, 344 };
int N[] = { 31, 28, 31, 30, 31, 30, 31, 30, 31, 30, 31, 30 };
double Hm[] = { 4.38, 5.18, 5.93, 6.65, 6.67, 6.40, 5.44, 5.27, 5.62, 5.24,
        4.5, 4.11 };
Button cal;
TextView radiation, angle;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    initialize();
    cal.setOnClickListener(this);

}

private void initialize() {
    // TODO Auto-generated method stub
    cal = (Button) findViewById(R.id.button1);
    radiation = (TextView) findViewById(R.id.rad);
    angle = (TextView) findViewById(R.id.beta);
}

@Override
public void onClick(View v) {
    // TODO Auto-generated method stub
    for (i = 0; i <= 11; i++) {
        Htm = 0;
        delta = 23.45 * (Math.sin((0.986301369) * (PI / 180)
                * (284 + (nbar[i]))));

        ws = Math.acos(-(Math.tan(PHI)) * (Math.tan(delta * (PI / 180))));
        ws = ws * (180 / PI);

        Gon[i] = Gsc
                * (1 + (0.033 * Math.cos(0.986301369 * (nbar[i])
                        * (PI / 180))));

        Hom[i] = (86400 / PI)
                * Gon[i]
                * (((Math.cos(PHI)) * (Math.cos(delta * (PI / 180))) * (Math
                        .sin(ws * (PI / 180)))) + ((ws * (PI / 180)) * (Math
                        .sin(PHI) * (Math.sin(delta * (PI / 180))))));
        Hom[i] = Hom[i] / 3600000;

        Kt[i] = Hm[i] / Hom[i];

        Hd[i] = (0.96268) - ((1.45200) * (Kt[i]))
                + ((0.27365) * (Kt[i]) * (Kt[i]))
                + ((0.04279) * (Kt[i]) * (Kt[i]) * (Kt[i]))
                + ((0.000246) * (ws))
                + ((0.001189) * (90 - (PHI * (180 / PI)) + delta));
        Hd[i] = Hd[i] * Hm[i];
        for (beta = 0; beta <= 90; beta++) {
            wss = Math.acos(-(Math.tan((PHI) - (beta * (PI / 180))) * (Math
                    .tan(delta * (PI / 180)))));
            wss = wss * (180 / PI);
            if (wss > ws) {
                wss = ws;
            }

            Rb_num = ((Math.cos((PHI) - (beta * (PI / 180))))
                    * (Math.cos(delta * (PI / 180))) * (Math.sin(wss
                    * (PI / 180))))
                    + (((PI / 180) * wss)
                            * ((Math.sin((PHI) - (beta * (PI / 180))))) * ((Math
                                .sin(delta * (PI / 180)))));
            Rb_den = ((Math.cos(PHI)) * (Math.cos(delta * (PI / 180))) * (Math
                    .sin(ws * (PI / 180))))
                    + (((PI / 180) * (ws) * (Math.sin(PHI)) * (Math
                            .sin(delta * (PI / 180)))));
            Rb = Rb_num / Rb_den;
            Ra = ((1 - (Hd[i] / Hm[i])) * (Rb))
                    + ((Hd[i] / (2 * Hm[i])) * (1 + (Math.cos(beta
                            * (PI / 180)))))
                    + ((RO / 2) * (1 - (Math.cos(beta * (PI / 180)))));

            Ht = Ra * Hm[i];
            if (Ht > Htm) {
                Htm = Ht;
                ang = beta;
            }
        }

        break;
    }
    radiation.setText("H = " + Htm);
    angle.setText("Beta =" + ang);

}
 } 
```

* * *

**日志猫：**

```
02-28 17:25:10.344: W/Trace(773): Unexpected value from nativeGetEnabledTags: 0
02-28 17:25:10.344: W/Trace(773): Unexpected value from nativeGetEnabledTags: 0
02-28 17:25:10.344: W/Trace(773): Unexpected value from nativeGetEnabledTags: 0
02-28 17:25:10.434: W/Trace(773): Unexpected value from nativeGetEnabledTags: 0
02-28 17:25:10.434: W/Trace(773): Unexpected value from nativeGetEnabledTags: 0
02-28 17:25:10.894: W/Trace(773): Unexpected value from nativeGetEnabledTags: 0
02-28 17:25:10.894: W/Trace(773): Unexpected value from nativeGetEnabledTags: 0
02-28 17:25:10.924: W/Trace(773): Unexpected value from nativeGetEnabledTags: 0
02-28 17:25:10.944: W/Trace(773): Unexpected value from nativeGetEnabledTags: 0
02-28 17:25:11.144: D/libEGL(773): loaded /system/lib/egl/libEGL_emulation.so
02-28 17:25:11.154: D/(773): HostConnection::get() New Host Connection established 0x2a186bf0, tid 773
02-28 17:25:11.184: D/libEGL(773): loaded /system/lib/egl/libGLESv1_CM_emulation.so
02-28 17:25:11.193: D/libEGL(773): loaded /system/lib/egl/libGLESv2_emulation.so
02-28 17:25:11.335: W/EGL_emulation(773): eglSurfaceAttrib not implemented
02-28 17:25:11.383: D/OpenGLRenderer(773): Enabling debug mode 0
02-28 17:25:11.394: W/Trace(773): Unexpected value from nativeGetEnabledTags: 0
02-28 17:25:11.403: W/Trace(773): Unexpected value from nativeGetEnabledTags: 0
02-28 17:25:11.415: W/Trace(773): Unexpected value from nativeGetEnabledTags: 0
02-28 17:25:11.444: W/Trace(773): Unexpected value from nativeGetEnabledTags: 0
02-28 17:25:11.444: W/Trace(773): Unexpected value from nativeGetEnabledTags: 0
02-28 17:25:11.464: W/Trace(773): Unexpected value from nativeGetEnabledTags: 0
02-28 17:25:11.464: W/Trace(773): Unexpected value from nativeGetEnabledTags: 0
02-28 17:25:11.464: W/Trace(773): Unexpected value from nativeGetEnabledTags: 0
02-28 17:25:11.464: W/Trace(773): Unexpected value from nativeGetEnabledTags: 0
02-28 17:25:11.474: W/Trace(773): Unexpected value from nativeGetEnabledTags: 0
02-28 17:25:11.514: W/Trace(773): Unexpected value from nativeGetEnabledTags: 0
02-28 17:25:11.524: W/Trace(773): Unexpected value from nativeGetEnabledTags: 0
02-28 17:25:11.524: W/Trace(773): Unexpected value from nativeGetEnabledTags: 0
02-28 17:25:11.524: W/Trace(773): Unexpected value from nativeGetEnabledTags: 0
02-28 17:25:11.724: W/Trace(773): Unexpected value from nativeGetEnabledTags: 0
02-28 17:25:11.774: W/Trace(773): Unexpected value from nativeGetEnabledTags: 0
02-28 17:25:11.864: W/Trace(773): Unexpected value from nativeGetEnabledTags: 0
02-28 17:26:49.747: W/Trace(773): Unexpected value from nativeGetEnabledTags: 0
02-28 17:26:49.747: W/Trace(773): Unexpected value from nativeGetEnabledTags: 0
02-28 17:26:49.747: W/Trace(773): Unexpected value from nativeGetEnabledTags: 0
02-28 17:26:49.767: W/Trace(773): Unexpected value from nativeGetEnabledTags: 0
02-28 17:26:49.767: W/Trace(773): Unexpected value from nativeGetEnabledTags: 0
02-28 17:26:49.767: W/Trace(773): Unexpected value from nativeGetEnabledTags: 0
02-28 17:26:49.777: W/Trace(773): Unexpected value from nativeGetEnabledTags: 0
02-28 17:26:49.777: W/Trace(773): Unexpected value from nativeGetEnabledTags: 0
02-28 17:26:49.910: W/Trace(773): Unexpected value from nativeGetEnabledTags: 0
02-28 17:26:49.910: W/Trace(773): Unexpected value from nativeGetEnabledTags: 0
02-28 17:26:51.397: W/Trace(773): Unexpected value from nativeGetEnabledTags: 0
02-28 17:26:51.397: W/Trace(773): Unexpected value from nativeGetEnabledTags: 0
02-28 17:26:51.473: W/Trace(773): Unexpected value from nativeGetEnabledTags: 0
02-28 17:26:51.473: W/Trace(773): Unexpected value from nativeGetEnabledTags: 0
02-28 17:26:51.473: W/Trace(773): Unexpected value from nativeGetEnabledTags: 0
02-28 17:26:51.477: W/Trace(773): Unexpected value from nativeGetEnabledTags: 0
02-28 17:26:51.477: W/Trace(773): Unexpected value from nativeGetEnabledTags: 0
02-28 17:26:51.477: W/Trace(773): Unexpected value from nativeGetEnabledTags: 0
02-28 17:26:51.477: W/Trace(773): Unexpected value from nativeGetEnabledTags: 0
02-28 17:26:51.477: W/Trace(773): Unexpected value from nativeGetEnabledTags: 0
02-28 17:26:51.497: W/Trace(773): Unexpected value from nativeGetEnabledTags: 0
02-28 17:26:51.497: W/Trace(773): Unexpected value from nativeGetEnabledTags: 0
02-28 17:26:51.497: W/Trace(773): Unexpected value from nativeGetEnabledTags: 0
02-28 17:26:51.497: W/Trace(773): Unexpected value from nativeGetEnabledTags: 0
02-28 17:26:51.527: D/AndroidRuntime(773): Shutting down VM
02-28 17:26:51.527: W/dalvikvm(773): threadid=1: thread exiting with uncaught exception (group=0x40a70930)
02-28 17:26:51.537: E/AndroidRuntime(773): FATAL EXCEPTION: main
02-28 17:26:51.537: E/AndroidRuntime(773): java.lang.NullPointerException
02-28 17:26:51.537: E/AndroidRuntime(773):  at com.ned.tilt.Tilt.onClick(Tilt.java:53)
02-28 17:26:51.537: E/AndroidRuntime(773):  at android.view.View.performClick(View.java:4202)
02-28 17:26:51.537: E/AndroidRuntime(773):  at android.view.View$PerformClick.run(View.java:17340)
02-28 17:26:51.537: E/AndroidRuntime(773):  at android.os.Handler.handleCallback(Handler.java:725)
02-28 17:26:51.537: E/AndroidRuntime(773):  at android.os.Handler.dispatchMessage(Handler.java:92)
02-28 17:26:51.537: E/AndroidRuntime(773):  at android.os.Looper.loop(Looper.java:137)
02-28 17:26:51.537: E/AndroidRuntime(773):  at android.app.ActivityThread.main(ActivityThread.java:5039)
02-28 17:26:51.537: E/AndroidRuntime(773):  at java.lang.reflect.Method.invokeNative(Native Method)
02-28 17:26:51.537: E/AndroidRuntime(773):  at java.lang.reflect.Method.invoke(Method.java:511)
02-28 17:26:51.537: E/AndroidRuntime(773):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
02-28 17:26:51.537: E/AndroidRuntime(773):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
02-28 17:26:51.537: E/AndroidRuntime(773):  at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T17:38:53.000

您没有初始化 Hom[]、Gon[]、Kt[]、Hd[] 数组，但您正在尝试访问并在循环中设置它。一个例子是这样的：

```
 Hd[i] = Hd[i] * Hm[i]; 
```

由于您正在处理长度为 12 的循环，因此您可以为它们初始化空数组。

# azure - 使用 JWT 保护 WebAPI

> ID：15141914
> 
> 赞同：6
> 
> 时间：2013-02-28T17:31:08.167
> 
> 标签：azure, wif, azure-acs

我正在尝试编写一个移动应用程序，该应用程序将从基于 webapi 的站点获取数据。

该站点应通过 ACS 保护（因为可以有多个身份提供者）。

我的移动应用程序目前正在查询以下网址[https://xx.accesscontrol.windows.net/v2/metadata/IdentityProviders.js?protocol=javascriptnotify&realm=http://xx.azurewebsites.net/&version=1.0](https://xx.accesscontrol.windows.net/v2/metadata/IdentityProviders.js?protocol=javascriptnotify&realm=http://xx.azurewebsites.net/&version=1.0)以获取列表的 IP。

然后我允许用户选择一个 IP，然后使用 Web 浏览器控件向他们显示登录信息。

用户登录后，我会捕获响应并提取令牌，但现在我不确定我应该做什么。令牌如下所示：-

```
{"appliesTo":"http://****.azurewebsites.net/",
"context":null,
"created":1362069383,
"expires":1362072983,
"securityToken":"... a lot of text:-)",
"tokenType":"urn:ietf:params:oauth:token-type:jwt"} 
```

所以，我猜我应该使用 securityToken 部分并将它的 Authorization 标头的一部分添加到 get 请求中？

问题 1 是我应该如何附加令牌 - 我只是附加安全令牌位，还是必须对批次进行 base 64 编码并再次将其附加为授权标头？

问题 2 如何配置 webapi 来处理 JWT？在我修改 ACS 以发出 JWT 令牌并安装 JWTSecurityTokenHandler 后，我仍然收到以下错误（这是被动身份验证）：

```
 JWT10310: Unable to validate signature. validationParameters.SigningTokenResolver type: 'System.IdentityModel.Tokens.IssuerTokenResolver', was unable to resolve key to a token.
 The SecurityKeyIdentifier is: 
 'SecurityKeyIdentifier
    (
    IsReadOnly = False,
    Count = 1,
    Clause[0] = X509ThumbprintKeyIdentifierClause(Hash =  0x2FEE3EE96B019D4BA0C046124B77C652EEF768E5)
    )
 '. validationParameters.SigningToken was null. 
```

谢谢

罗斯

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-09T03:18:59.217

尽管您没有使用 Azure 身份验证库，[但此 AAL 代码示例有助于](http://code.msdn.microsoft.com/AAL-Native-Application-to-fd648dcf "此代码示例很有帮助")展示如何使用新的[JWT 令牌处理](https://nuget.org/packages/Microsoft.IdentityModel.Tokens.JWT "JWT 令牌处理程序")程序通过请求管道中的 HTTP 消息处理程序对 Web API 的请求进行身份验证。该代码显式处理 ACS 发布的 JWT。特别是查看`TokenValidationHandler`. `Global.asax.cs`流程是这样的：

1.  来自客户端应用程序的传入请求由消息处理程序检查。
2.  使用 JWTTokenHandler 检查和验证授权标头。
3.  如果 JWT 令牌有效，则 JWTTokenHandler 实例化一个新的 ClaimsPrincipal 对象。如果令牌无效，则返回 HTTP 401 Unauthorized 响应。

回到您的第一个问题，您只需要该`"securityToken"`值（类似于`eyJ0eXAiOiJK...`）来创建一个授权标头，例如`Authorization: Bearer eyJ0eXAiOiJK...`. 当它在请求中传递给您的 Web API 时，JWTTokenHandler 将通过消息处理程序对其进行验证。当然，这假设您的 Web API 已正确配置，以了解您用于从 ACS 获取令牌的 ACS 租户和安全域。

编辑：查看有关保护 REST 服务并从移动应用程序访问它们的模式和实践指南 - 非常相似的场景可能有助于为您提供更多上下文。

*   [从 Windows Phone 设备访问 REST 服务](http://msdn.microsoft.com/en-us/library/hh446533.aspx "从 Windows Phone 设备访问 REST 服务")
*   [保护 REST 服务](http://msdn.microsoft.com/en-us/library/hh446531.aspx "保护 REST 服务")

# maven - 使用 Cobertura 和 Jacoco 运行代码覆盖率

> ID：15141915
> 
> 赞同：5
> 
> 时间：2013-02-28T17:31:18.637
> 
> 标签：maven, sonarqube, cobertura, jacoco

我在为 Maven 插件项目（它使用调用程序插件进行集成测试）获取 Sonar 中的集成测试和单元测试的代码覆盖率报告时遇到了一点问题。

我不能对单元测试使用默认的 Jacoco 覆盖工具，因为它们使用 Powermock，这导致使用它的类的覆盖率为 0%。另一方面，如果不使用 Jacoco，我找不到可靠的方法来获得基于 Groovy 的集成测试的结果。

所以我需要的是让 Cobertura 生成一个单元测试报告，让 Jacoco 生成一个集成测试报告，并且让 Sonar 能够读取很多内容。

我尝试使用此处的示例[https://github.com/Godin/sonar-experiments/tree/master/jacoco-examples/maven-invoker-plugin-example](https://github.com/Godin/sonar-experiments/tree/master/jacoco-examples/maven-invoker-plugin-example)但消除了绑定到测试阶段的执行，但我得到了Sonar 中“-”的单元测试覆盖率。我认为这样做的原因是为了让这种方法起作用，我需要将 Jacoco 指定为 Sonar 的核心覆盖工具。

有什么想法可以解决这个问题吗？我的 pom.xml 如下：

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>

  <groupId>com.acme.myproj.plugins</groupId>
  <artifactId>slice2java-maven-plugin</artifactId>
  <version>0.1-SNAPSHOT</version>
  <packaging>maven-plugin</packaging>

  <name>Slice2Java Maven Plugin</name>

  <properties>
    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
    <sonar.exclusions>**/generated*/*.java</sonar.exclusions>
    <sonar.java.coveragePlugin>jacoco</sonar.java.coveragePlugin>
    <sonar.dynamicAnalysis>reuseReports</sonar.dynamicAnalysis>
    <sonar.jacoco.itReportPath>${project.basedir}/target/jacoco-it.exec</sonar.jacoco.itReportPath>
  </properties>

  <dependencies>
    <dependency>
      <groupId>org.apache.maven</groupId>
      <artifactId>maven-plugin-api</artifactId>
      <version>2.0</version>
    </dependency>
    <dependency>
      <groupId>org.apache.maven.plugin-tools</groupId>
      <artifactId>maven-plugin-annotations</artifactId>
      <version>3.2</version>
      <scope>provided</scope>
    </dependency>
    <dependency>
      <groupId>org.codehaus.plexus</groupId>
      <artifactId>plexus-utils</artifactId>
      <version>3.0.8</version>
    </dependency>
    <dependency>
      <groupId>junit</groupId>
      <artifactId>junit</artifactId>
      <version>4.11</version>
      <scope>test</scope>
    </dependency>
      <dependency>
          <groupId>org.mockito</groupId>
          <artifactId>mockito-all</artifactId>
          <version>1.9.5</version>
          <scope>test</scope>
      </dependency>
      <dependency>
          <groupId>org.powermock</groupId>
          <artifactId>powermock-core</artifactId>
          <version>1.5</version>
          <scope>test</scope>
      </dependency>
      <dependency>
          <groupId>org.powermock</groupId>
          <artifactId>powermock-module-junit4</artifactId>
          <version>1.5</version>
          <scope>test</scope>
      </dependency>
      <dependency>
          <groupId>org.powermock</groupId>
          <artifactId>powermock-api-mockito</artifactId>
          <version>1.5</version>
          <scope>test</scope>
      </dependency>
  </dependencies>

  <build>
    <plugins>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-plugin-plugin</artifactId>
        <version>3.2</version>
        <configuration>
          <goalPrefix>slice2java</goalPrefix>
          <skipErrorNoDescriptorsFound>true</skipErrorNoDescriptorsFound>
        </configuration>
        <executions>
          <execution>
            <id>mojo-descriptor</id>
            <goals>
              <goal>descriptor</goal>
            </goals>
          </execution>
          <execution>
            <id>help-goal</id>
            <goals>
              <goal>helpmojo</goal>
            </goals>
          </execution>
        </executions>
      </plugin>
    </plugins>
  </build>
  <profiles>
    <profile>
      <id>run-its</id>
      <build>
        <plugins>
          <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-invoker-plugin</artifactId>
            <version>1.8</version>
            <configuration>
              <debug>true</debug>
              <cloneProjectsTo>${project.build.directory}/it</cloneProjectsTo>
              <pomIncludes>
                <pomInclude>*/pom.xml</pomInclude>
              </pomIncludes>
              <postBuildHookScript>verify</postBuildHookScript>
              <localRepositoryPath>${project.build.directory}/local-repo</localRepositoryPath>
              <settingsFile>src/it/settings.xml</settingsFile>
              <goals>
                <goal>clean</goal>
                <goal>test-compile</goal>
              </goals>
            </configuration>
            <executions>
              <execution>
                <id>integration-test</id>
                <goals>
                  <goal>install</goal>
                  <goal>integration-test</goal>
                  <goal>verify</goal>
                </goals>
              </execution>
            </executions>
          </plugin>
            <plugin>
                <groupId>org.jacoco</groupId>
                <artifactId>jacoco-maven-plugin</artifactId>
                <version>0.5.3.201107060350</version>
                <configuration>
                    <includes>com.acme.*</includes>
                </configuration>
                <executions>
                    <execution>
                        <id>pre-integration-test</id>
                        <phase>pre-integration-test</phase>
                        <goals>
                            <goal>prepare-agent</goal>
                        </goals>
                        <configuration>
                            <destFile>${project.build.directory}/jacoco-it.exec</destFile>
                            <propertyName>invoker.mavenOpts</propertyName>
                        </configuration>
                    </execution>
                    <execution>
                        <id>post-integration-test</id>
                        <phase>post-integration-test</phase>
                        <goals>
                            <goal>report</goal>
                        </goals>
                        <configuration>
                            <dataFile>${project.build.directory}/jacoco-it.exec</dataFile>
                            <outputDirectory>${project.reporting.outputDirectory}/jacoco-it</outputDirectory>
                        </configuration>
                    </execution>
                </executions>
            </plugin>
        </plugins>
      </build>
    </profile>
  </profiles>

</project> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T07:31:56.070

由于您已将 Sonar 配置为

```
 <sonar.dynamicAnalysis>reuseReports</sonar.dynamicAnalysis>
 <sonar.jacoco.itReportPath>
     ${project.basedir}/target/jacoco-t.exec
 </sonar.jacoco.itReportPath> 
```

这意味着您要告诉 Sonar 重***​​用来自******sonar.jacoco.itReportPath***的现有报告。如果没有现有报告，则没有任何覆盖范围。

就我而言，我使用 Cobertura 并使用以下配置属性重用其来自*Maven 站点生成的报告：*

```
<sonar.java.coveragePlugin>cobertura</sonar.java.coveragePlugin>
<sonar.dynamicAnalysis>reuseReports</sonar.dynamicAnalysis>
<sonar.surefire.reportsPath>
    ${project.build.directory}/surefire-reports
</sonar.surefire.reportsPath>
<sonar.cobertura.reportPath>
    ${project.build.directory}/site/cobertura/coverage.xml
</sonar.cobertura.reportPath> 
```

我可以通过使用以下命令获得重用：

```
mvn clean install site sonar:sonar 
```

我可以使用以下命令重现您的问题：

```
mvn clean install sonar:sonar 
```

覆盖率为 0%。***由于报告路径***中没有现有报告。

那么请确保在执行 Sonar 之前有一个名为*“jacoco-t.exec”的报告。*

由于我不熟悉 JaCoCo 并且不知道生成报告文件的 Maven 阶段，我建议执行如下命令：

```
mvn clean test sonar:sonar 
```

或者

```
mvn clean install sonar:sonar 
```

或者和我的一样

```
mvn clean install site sonar:sonar 
```

我希望这可能会有所帮助。

# c - 用户在 C 中将 int 输入到文件中获取“访问冲突”

> ID：15141916
> 
> 赞同：0
> 
> 时间：2013-02-28T17:31:19.700
> 
> 标签：c, file, exception, input, int

好的，所以我正在尝试将数据添加到此文本文件中，并且我想添加一个 int，每次尝试此操作时，我都会输入 int，然后按 enter，并收到此错误消息...

“homework2.exe 中 0x77ac15de (ntdll.dll) 的未处理异常：0xC0000005：访问冲突写入位置 0x00000000。”

使用一个只允许我中断或继续的窗口，在我关闭我的 cmd 窗口之前，这两者都不会真正做任何事情。如果没有添加 int 的行，它就可以正常工作，当它只添加用户输入的字符串时，它就可以正常工作。代码看起来像这样......

```
//printf("Enter the term: "); scanf("%d", input);
//THIS STUFF DOESNT WORK!
    //fprintf(inputf, "%d, ", input);

    printf("Enter last name: "); scanf("%s", name);

    fprintf(inputf, "%s,", name);

    printf("Enter first name: "); scanf("%s", name);

    fprintf(inputf, "%s,", name); 
```

当我打开它时，我希望文件中的文本像这样读取......

" 1301,"Doe","John J." "

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T17:33:24.630

函数 scanf() 具有以下原型：

```
int scanf(const char *format, ...); 
```

如果要更改变量本身，则需要指向变量的指针，因此您必须使用地址操作符将指针传递给函数。

你必须使用`scanf("%d", &input);`而不是`scanf("%d", input);`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T17:33:16.310

需要更改`scanf("%d", input);`为`scanf("%d", &input);`

# c# - 如何避免在 ListBox 更改数据模板中进行选择？

> ID：15141918
> 
> 赞同：0
> 
> 时间：2013-02-28T17:31:26.000
> 
> 标签：c#, wpf, templates, listbox, selecteditem

我在 WPF 应用程序中使用 VS2012。我在主窗口中有一个列表框。列表框的 background = null - 这意味着背景等于主窗口背景。

列表框有一个数据模板，但我有一个问题，对于列表框中的最后一个选定项目，它会将背景颜色更改为白色？我怎样才能避免这种情况？

我上传了一张图片作为说明。

*编辑-这张图片说明了问题 [http://i57.photobucket.com/albums/g202/RolleKn/pic2_zps94f2907a.jpg](http://i57.photobucket.com/albums/g202/RolleKn/pic2_zps94f2907a.jpg)

问候。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T17:36:25.750

要删除 SelectedItem 的背景更改，您必须覆盖 listboxitem 的控件模板。

试试这个

```
<Style  TargetType="{x:Type ListBoxItem}">
<Setter Property="Background" Value="Transparent"/>
<Setter Property="HorizontalContentAlignment" Value="{Binding HorizontalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}"/>
<Setter Property="VerticalContentAlignment" Value="{Binding VerticalContentAlignment, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}"/>
<Setter Property="Padding" Value="2,0,0,0"/>
<Setter Property="Template">
    <Setter.Value>
        <ControlTemplate TargetType="{x:Type ListBoxItem}">
            <Border x:Name="Bd" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" Background="{TemplateBinding Background}" Padding="{TemplateBinding Padding}" SnapsToDevicePixels="true">
                <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
            </Border>
            <ControlTemplate.Triggers>

                <Trigger Property="IsEnabled" Value="false">
                    <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
                </Trigger>
            </ControlTemplate.Triggers>
        </ControlTemplate>
    </Setter.Value>
</Setter>
</Style> 
```

# xslt - XSLT 换行符显示为十六进制符号

> ID：15141922
> 
> 赞同：1
> 
> 时间：2013-02-28T17:31:47.673
> 
> 标签：xslt

我一直在尝试用换行符替换 schemaLocation 属性中出现的所有空格字符。我发现了很多关于如何做到这一点的变化。最简单的是类似

```
 <xsl:variable name='nl'><xsl:text>
</xsl:text></xsl:variable> 
```

然后代替我，

```
<xsl:value-of select(replace($data,' ',$nl) /> 
```

但是，无论我尝试哪种方式，它都会打印文字'#x0A;' 在文件中

我尝试将 XSL:OUTPUT 更新为 method="text" 但这会产生许多其他奇怪的结果

我只是想出现一个换行符，而不是“#x0A;” 这个的字符串表示

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T02:50:30.610

嗯，从你发布的内容来看，我不确定你做错了什么。当您以十六进制键入换行符时，您是否忘记了与号？一个简单的错误。从设计的角度来看，我建议使用十六进制代码作为换行符，因为它更干净且难以意外删除。

此代码有效：

```
<?xml version="1.0" encoding="UTF-8"?>
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
<xsl:output method="text"/>

<xsl:variable name="newline">
  <xsl:text>&#xa;</xsl:text>
</xsl:variable>

<xsl:template match="/">
  <xsl:variable name="data">
    <xsl:text>This is a string</xsl:text>
  </xsl:variable>
  <xsl:value-of select="replace($data,' ', $newline)" />
</xsl:template>

</xsl:stylesheet> 
```

输出正是我们所期望的：

```
This
is
a
string 
```

# android - httpget无限期地调用foursquare循环

> ID：15141925
> 
> 赞同：0
> 
> 时间：2013-02-28T17:31:58.653
> 
> 标签：android, json, foursquare, http-get

我正在使用 Foursquare 的 API 列出所有类别，代码如下

```
 HttpGet httpGet = new HttpGet(FOURSQUARE_CAT);
        HttpClient client = new DefaultHttpClient();
        HttpResponse response;
        StringBuilder stringBuilder = new StringBuilder();
        JSONObject jsonObject = new JSONObject();
        JSONArray jsonArray = null;
        try {

            response = client.execute(httpGet);

            HttpEntity entity = response.getEntity();

            InputStream stream = entity.getContent();

            BufferedReader r = new BufferedReader(new InputStreamReader(stream));
            String line;
            while ((line = r.readLine()) != null) {
                stringBuilder.append(line);
            }

            jsonObject = new JSONObject(stringBuilder.toString());
            String str = "";
            if(jsonObject !=null){
                Log.d("cat0", stringBuilder.toString());
                jsonObject = jsonObject.getJSONObject("response");
                jsonArray = ((JSONArray)jsonObject.get("categories"));//.getJSONObject(0).getString("formatted_address");
                Log.d("cat1", jsonArray.toString());
                Log.d("cat2length", jsonArray.length() + "");
                for(int i = 0; i < jsonArray.length(); i++){
                    if(jsonArray.getJSONObject(i).get("name").toString().equalsIgnoreCase("food")){
                        str = jsonArray.getJSONObject(i).get("id").toString();
                        Log.d("cat loop ", i + " out of " + jsonArray.length());
                        break;
                    }
                }
                    Message.obtain(mHandler, UPDATE_ADDRESS, str).sendToTarget();
            }

        } catch (ClientProtocolException e) {
            e.printStackTrace();
            Log.d("cpe", e.toString());
        }
          catch (IOException e) {
              e.printStackTrace();//  Log.d("ioe", "");
             Log.d("ioe", e.toString());
          } catch (JSONException e) {
                // TODO Auto-generated catch block
              e.printStackTrace();
             Log.d("jsone", e.toString());
            } 
```

我输入了这些日志命令以查看我的输入和输出是否符合预期，并且由于某种原因，整个 try catch 块一直在循环。我尝试取出 for 循环，但已确认这不是原因

我使用更新代码的堆栈跟踪如下，请注意，它不会返回完整的 JSON 数据，我通过比较从代码和浏览器中获得的信息来验证这一点：

```
03-01 18:50:46.463: I/global(316): Default buffer size used in BufferedReader constructor. It would be better to be explicit if an 8k-char buffer is required.
03-01 18:50:47.433: D/dalvikvm(316): GC_FOR_MALLOC freed 18169 objects / 1570256 bytes     in 57ms
03-01 18:50:47.442: D/NativeCrypto(316): Freeing OpenSSL session
03-01 18:50:47.752: D/dalvikvm(316): GC_FOR_MALLOC freed 1530 objects / 711792 bytes in 39ms
03-01 18:50:48.042: D/dalvikvm(316): GC_FOR_MALLOC freed 6921 objects / 486480 bytes in 47ms
03-01 18:50:48.072: D/cat0(316): {"meta":{"code":200},"response":{"categories":    [{"id":"4d4b7104d754a06370d81259","name":"Arts & Entertainment","pluralName":"Arts & Entertainment","shortName":"Arts & Entertainment","icon":{"prefix":"https:\/\/foursquare.com\/img\/categories_v2\/arts_entertainment\/default_","suffix":".png"},"categories":[{"id":"4fceea171983d5d06c3e9823","name":"Aquarium","pluralName":"Aquariums","shortName":"Aquarium","icon":{"prefix":"https:\/\/foursquare.com\/img\/categories_v2\/arts_entertainment\/aquarium_","suffix":".png"},"categories":[]},{"id":"4bf58dd8d48988d1e1931735","name":"Arcade","pluralName":"Arcades","shortName":"Arcade","icon":{"prefix":"https:\/\/foursquare.com\/img\/categories_v2\/arts_entertainment\/arcade_","suffix":".png"},"categories":[]},{"id":"4bf58dd8d48988d1e2931735","name":"Art Gallery","pluralName":"Art Galleries","shortName":"Art Gallery","icon":{"prefix":"https:\/\/foursquare.com\/img\/categories_v2\/arts_entertainment\/artgallery_","suffix":".png"},"categories":[]},{"id":"4bf58dd8d48988d1e4931735","name":"Bowling Alley","pluralName":"Bowling Alleys","shortName":"Bowling Alley","icon":{"prefix":"https:\/\/foursquare.com\/img\/categories_v2\/arts_entertainment\/bowling_","suffix":".png"},"categories":[]},{"id":"4bf58dd8d48988d17c941735","name":"Casino","pluralName":"Casinos","shortName":"Casino","icon":{"prefix":"https:\/\/foursquare.com\/img\/categories_v2\/arts_entertainment\/casino_","suffix":".png"},"categories":[]},{"id":"4bf58dd8d48988d18e941735","name":"Comedy Club","pluralName":"Comedy Clubs","shortName":"Comedy Club","icon":{"prefix":"https:\/\/foursquare.com\/img\/categories_v2\/arts_entertainment\/comedyclub_","suffix":".png"},"categories":[]},{"id":"5032792091d4c4b30a586d5c","name":"Concert Hall","pluralName":"Concert Halls","shortName":"Concert Hall","icon":{"prefix":"https:\/\/foursquare.com\/img\/categories_v2\/arts_entertainment\/musicvenue_","suffix":".png"},"categories":[]},{"id":"4bf58dd8d48988d1f1931735","name":"General Entertainment","pluralName":"General Entertainment","shortName":"Other - Entertainment","icon":{"prefix":"https:\/\/foursquare.com\/img\/categories_v2\/arts_entertainment\/default_","suffix":".png"},"categories":[]},{"id":"4deefb944765f83613cdba6e","name":"Historic Site","pluralName":"Historic Sites","shortName":"Historic Site","icon":{"prefix":"https:\/\/foursquare.com\/img\/categories_v2\/arts_entertainment\/historicsite_","suffix":".png"},"categories":[]},{"id":"4bf58dd8d48988d17f941735","name":"Movie Theater","pluralName":"Movie Theaters","shortName":"Movie Theater","icon":{"prefix":"https:\/\/foursquare.com\/img\/categories_v2\/arts_entertainment\/movietheater_","suffix":".png"},"categories":[{"id":"4bf58dd8d48988d17e941735","name":"Indie Movie Theater","pluralName":"Indie Movie Theaters","shortName":"Indie Theater","icon":{"prefix":"https:\/\/foursquare.com\/img\/categories_v2\/arts_entertainment\/movietheater_indietheater_","suffix":".png"}},{"id":"4bf58dd8d48988d180941735","name":"Multiplex","pluralName":"Multiplexes","shortName":"Cineplex","icon":{"prefix":"https:\/\/foursquare.com\/img\/categories_v2\/arts_entertainment\/movietheater_cineplex_","suffix":".png"}}]},{"id":"4bf58dd8d48988d181941735","name":"Museum","pluralName":"Museums","shortName":"Museum","icon":{"prefix":"https:\/\/foursquare.com\/img\/categories_v2\/arts_entertainment\/museum_","suffix":".png"},"categories":[{"id":"4bf58dd8d48988d18f941735","name":"Art Museum","pluralName":"Art Museums","shortName":"Art Museum","icon":{"prefix":"https:\/\/foursquare.com\/img\/categories_v2\/arts_entertainment\/museum_art_","suffix":".png"}},{"id":"4bf58dd8d48988d190941735","name":"History Museum","pluralName":"History Museums","shortName":"History Museum","icon":{"prefix":"https:\/\/foursquare.com\/img\/categories_v2\/arts_entertainment\/museum_history_","suffix":".png"}},{"id":"4bf58dd8d48988d192941735","name":"Planetarium","pluralName":"Planetariums","shortName":"Planetarium","icon":{"prefix":"https:\/\/foursquare.com\/img\/categories_v2\/arts_entertainment\/museum_planetarium_","suf 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T16:52:14.787

我设法发现我应该只使用以下代码

```
urlCat = new URL(FOURSQUARE_CAT);
            Log.d("url", FOURSQUARE_CAT);
             URLConnection httpGet = urlCat.openConnection();
             httpGet.setConnectTimeout(1000);
             httpGet.setDoInput(true);
             httpGet.setDoOutput(true);
             httpGet.connect(); 
```

但我在不同的问题中提出了不同的问题

# php - PHP 字符串差异和动态限制

> ID：15141928
> 
> 赞同：2
> 
> 时间：2013-02-28T17:32:07.670
> 
> 标签：php, mysql, match

**例A【简化版】：------------------------------------------ --------------------------**

> **MODEL** : 字符串***{1}***和 keeeeeep 在***{2}***和 oooon...
> 
> **CASE_A :*****两个单词***上的字符串***hello***和 keeeeeep和 oooon...
> 
>  ***CASE_B** :把***其他任何东西***串起来，然后继续开，***只是为了好玩***和 oooon...*

 *我需要得到一个列表，其中包含*n 个*名为`$v1`, `$v2`, `$vn`... 的变量及其各自的匹配值：

**编辑**：
请注意，变量名称是根据占位符给出的。占位符始终是 INT。*（数字只是索引而不是字数）*

对于**案例A**：
`$v1`=*你好*
`$v2`=*两个词*
`$vn`=*等*...

对于**案例B**：
`$v1`=*其他任何东西*
`$v2`=*只是为了好玩*
`$vn`=*等*...

您可以看到获取这些值的参考是两个字符串的“*常量*”部分。

**示例 B [几乎是真实的]：---------------------------------------- ----------------------------**

现在我们假设每个*可能的匹配*都保存在一个数组中*（实际情况是一个长数据库）*，像这样：

**possible_matches** {
[0] *string three* <<<<
[1] *Oneword* <<<<
[2] *Other stuff*
[3 ] *Harry Poppotter*
[4]*两个字*<<<<
[5]*魔语魔幻情怀*
}

在前面的例子中没有必要，因为每个**{n}** “*占位符*”被“*常量*”字符串分隔。但是在某些情况下，这些“*占位符*”在一起......所以我必须发明一种新方法来匹配**可能的匹配项**（固定列表）。

> 字符串***{1}***和 keeeeeep 在***{2}*** ***{3}***和 oooon...
> 
> 字符串***Oneword***和 keeeeeep***两个单词*** ***字符串 3***和 oooon...

如您所见*（基于上面显示的数组）*，结果应该是：
`$v1`= *hello*
`$v2` =*两个词*
`$v3`=*字符串三*

但是 PHP 怎么知道我希望我的字符串如何***分隔***？

**我的想法**是做下一个：

1）将 {2}{3} 块作为一个**单独**的块。
2）如果这个块*（两个字和三个字）*是`in_array()`
3）如果不是：
4）删除它的最后一个字
5）再次检查新的*（两个字和三个字）*。
6）如果不是：
<<<<
4'）删除它的最后一个单词
5'）再次检查新的*（两个字和）*。
4'') 删除它的最后一个单词
5'') 再次检查新的*（两个单词）*。
<<<<
7) 重复 4 和 5 直到它是一个**可能的匹配**项( `in_array()`)
8) 匹配的一个将是**{2}**而字符串的其余部分将是**{3}**

**我的问题**：我怎样才能做到这一点，在 PHP ?
我试图以最简单的方式解释它，我希望你能理解我想要问什么。如果有人需要更多示例，我会将它们写下来，请告诉我。谢谢阅读。

**编辑 - - - - - - - - - - - - - - - - - - - - - - - - - -------------------**
一个真实的例子：

Array: **possible_matches**{
[0]*克里斯托弗·约翰逊*
[1]*麦坎德利斯*
[2]*电影院*
[3]*明天晚上*
}

> **模型**：我的名字是***{1}*** ***{2}***，我要去***{3}{4}***
> 
> **案例**: 我 的 名字 是***克里斯托弗 约翰逊*** ***麦坎德利斯***, 我***明天 晚上 要去 电影院 .***

**期望**的结果：
`$v1`= *Christopher Johnson*
`$v2` = *McCandless*
`$v3` =*电影院*
`$v4`=*明天晚上*

**创建可能的组合数组**

```
function get_possible_groups($string_of_words, $groups_count){
$words=explode(' ',$string_of_words);
$total=count($words);
$group_1=array(array());
$group_2=array(array());
//We can create TOTAL-1 combinations
for($i=0;$i<$total;$i++){
$lim=$total-$i-1;
    for($j=0;$j<$total;$j++){
        if($j<$lim){
            $group_1[$i][]=$words[$j];
        }else{
            $group_2[$i][]=$words[$j];
        }
    }
}
return array($group_1,$group_2);
} 
```

***已接受*答案的评论中引用的更新**

```
$model="Damn you {1}, {2} will kill you. {3}{4}{5}";
//Array => Save how many single placeholders are in each "placeholder block"
$placeholder_count{
[0]=1, //first block contains one placeholder
[1]=1, //second block contains one placeholder
[2]=3  //third block contains three placeholders
}
//Simplify all blocks into ONE SINGLE regex placeholder
$pattern="/Damn you (.*), (.*) will kill you. (.*)/";

//Match in string
$string="Damn you Spar, Will will kill you. I Love it man.";
preg_match($pattern,$string,$matches);

//View in array which placeholders have to be checked
$block_0=$matches[1]; //Array shows it was 1 p.holder. No check needed
$block_1=$matches[2]; //Array shows it was 1 p.holder. No check needed
$block_2=$matches[3]; //It shows it were 3 p.holders. Possible grouping (n=3)

//Result
$v1=$matches[1];
$v2=$matches[2];

$v3,$v4,$v5=(Result of grouping and querying the $matches[3] with groups_count=3) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T18:35:10.727

何时`Christopher Johnson McCandless`映射到`{1}{2}`：

形成两组的可能组合是：

*   **`Christopher Johnson`** 和 **`McCandless`**
*   **`Christopher`**和**`Johnson McCandless`**

何时`cinema tomorrow at night`映射到`{3}{4}`

形成两组的可能组合是：

*   **`cinema`** 和 **`tomorrow at night`**
*   **`cinema tomorrow`**和**`at night`**
*   **`cinema tomorrow at`**和**`night`**

编写一个 PHP 函数以 `get_possible_groups($string_of_words, $group_count)`返回组组合数组的数组。

和如下 SQL 语句：

```
SELECT count(*), 'cinema' firstWordGroup, 'tomorrow at night' secondWordGroup
  FROM possibleMatchTable
 WHERE possible_match IN ('cinema', 'tomorrow at night')
UNION
SELECT count(*), 'cinema tomorrow', 'at night'
  FROM possibleMatchTable
 WHERE possible_match IN ('cinema tomorrow', 'at night')
UNION
SELECT count(*), 'cinema tomorrow at', 'night'
  FROM possibleMatchTable
 WHERE possible_match IN ('cinema tomorrow at', 'night'); 
```

一种可能的输出可以是：

```
+----------+--------------------+-------------------+
| count(*) | firstWordGroup     | secondWordGroup   |
+----------+--------------------+-------------------+
|        2 | cinema             | tomorrow at night |
|        0 | cinema tomorrow    | at night          |
|        0 | cinema tomorrow at | night             |
+----------+--------------------+-------------------+ 
```

以计数 2（两个词组）为准，这就是您的答案。

如果`MODEL`text 是`fulltext`索引列，那么对于任何给定的随机字符串，您可以获得最相关的模型，例如：

```
SELECT * FROM model_strings 
WHERE MATCH(model) AGAINST ('Damn you Spar, Kot will kill you.'); 
```

查询可能会返回类似：

```
+----------------------------------+
| model                            |
+----------------------------------+
| Damn you {1}, {2} will kill you. |
+----------------------------------+ 
```

使用来自的占位符提取随机字符串的单词`Model`：

```
<?php 

$placeholder_pRegEx = '#\{\d+\}#';

$model = 'Damn you {1}, {2} will kill you. {3}{4}{5}';
$string = 'Damn you Spar, Will will kill you. I Love it man.';

$model_words = explode(' ', $model);
$string_words = explode(' ', $string);

$placeholder_words = array();

for ($idx =0, $jdx=0; $idx < count($string_words); $idx ++) {

    if ($jdx < count($model_words)) {
        if (strcmp($string_words[$idx], $model_words[$jdx])) {
            $placeholder_words[] = $string_words[$idx];

            //Move to next word in Model only if it's a placeholder
            if (preg_match($placeholder_pRegEx, $model_words[$jdx]))
                $jdx++;

        } else
            $jdx++; //they match so move to next word
    } else
        $placeholder_words[] = $string_words[$idx];
}

//Even status will have the count
$status = preg_match_all ($placeholder_pRegEx, $model, $placeholders);

$group_count = count($placeholders[0]);

var_dump(get_defined_vars());
?> 
```

上面的代码将为您提供如下值：

```
'placeholder_words' => array (size=6)
  0 => string 'Spar,' (length=5)
  1 => string 'Will' (length=4)
  2 => string 'I' (length=1)
  3 => string 'Love' (length=4)
  4 => string 'it' (length=2)
  5 => string 'man.' (length=4)

'placeholders' => array (size=1)
  0 => 
    array (size=5)
      0 => string '{1}' (length=3)
      1 => string '{2}' (length=3)
      2 => string '{3}' (length=3)
      3 => string '{4}' (length=3)
      4 => string '{5}' (length=3)

'group_count' => int 5 
```

*   从那里你可以打电话`get possible groupings`
*   然后 SQL 查询检查允许的可能匹配
*   所需分组中的实际单词。

唉，这是个问题，嗯！*

# java - 数组列表 到数组文件[]

> ID：15141932
> 
> 赞同：9
> 
> 时间：2013-02-28T17:32:17.860
> 
> 标签：java, arrays, file, arraylist

我必须将 ArrayList 形成一个“正常”的 Array File[]。

```
File[] fSorted = (File[]) x.toArray(); 
```

错误：`Cast Exception`

```
Exception in thread "Thread-5" java.lang.ClassCastException: [Ljava.lang.Object; cannot be cast to [Ljava.io.File; 
```

如何将列表`x`作为 File[ ]-List 返回？

--

我的功能：

```
private File[] sortFiles(File[] files){;

    ArrayList<String> allFiles = new ArrayList<String>() ;
    for (int index = 0; index < files.length; index++)  
    {  
        File afile = new File(files[index].toString());
        allFiles.add(afile.getPath().toString());

    } 
    java.util.Collections.sort(allFiles);

    ArrayList<File> x = new ArrayList<File>();
    for(int i = 0; i< allFiles.size(); ++i){
        x.add(new File(allFiles.get(i)));
    }
    File[] fSorted = (File[]) x.toArray();

    return fSorted;

} 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-02-28T17:34:21.660

采用：

```
File[] fSorted = x.toArray(new File[x.size()]); 
```

# visual-studio-2012 - 如何从 VS 管理 Web 资源？

> ID：15141936
> 
> 赞同：0
> 
> 时间：2013-02-28T17:32:33.693
> 
> 标签：visual-studio-2012, dynamics-crm-2011

使用开发人员工具包，我可以将实体列表放入我的 Visual Studio。不过，我也想发表。当我尝试这样做时，我收到错误消息，告诉我无法连接。是否可以在 VS 解决方案中设置 CRM 解决方案的“镜像”并对其进行编辑？然后，完成后，只需将所有更改上传到服务器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T17:56:30.743

我想您正在谈论 Javascript Web 资源并在 Visual Studio 中管理此 Web 资源，没有任何默认工具可以做到这一点。但是存在很好的工具来帮助解决这个问题：

*   [智能感知](http://crm.vdsnickt.eu/ms-crm-javascript-intellisense-generator/)
*   [JS 文件](http://jswebresourcemanager.codeplex.com/)
*   [片段](http://crm2011snippets.codeplex.com/)
*   [Visual Studio 中的工具](http://crm2011vstools.codeplex.com/)

如果您使用的是 VS 2012，请检查此[工具](http://webresourcelinker.codeplex.com/)。

# php - WEB SERVER MOVE 共享到专用的页面之间的会话变量丢失

> ID：15141939
> 
> 赞同：0
> 
> 时间：2013-02-28T17:32:40.680
> 
> 标签：php, session

我刚刚从共享主机包转移到专用云服务器，并将我的完全正常工作的网站上传到了新的专用服务器，会话变量在页面之间传递得很好，现在突然间会话变量丢失了。谁能解释为什么会发生这种情况？

如果需要，我可以从页面中提供更多代码，但我认为这应该足够了。

此外，我确实尝试在页面上设置一个变量，然后在同一页面上显示它并且有效，但是如果该值甚至保存在会话中，因为它在同一页面上，我不会这样做。

我知道 PHP 的版本已从 5.2.17（共享）更改为 5.3.3（专用），但我已经在我的本地机器上使用这些不同的 PHP 版本进行了测试，并且会话变量没有任何问题。这是我给你的两页。

**page1.php**

```
<?php

session_start(); 

if (!isset($_SESSION['initiated']))
{
session_regenerate_id();
$_SESSION['initiated'] = true;
}

include_once "header_selector.php";

$_SESSION['duper'] = "Active sessions variable"; 
```

**page2.php**

```
<?php

ob_start();

session_start(); 

include_once "header_selector.php";

$duper = $_SESSION['duper'];
echo "Model: " . $duper; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T17:57:36.567

1) 很可能您的 $_SESSION 存储不可写。

2) 你在调用 ob_start() 时没有对应的 ob_end_flush()。当您移动主机和 PHP 版本时，您可能已经更改了 php.ini 文件，并且可能会通过设置将其搞砸。

3）你没有在 header_selector.php 中调用 ob_end_flush() 是吗？

# symfony - 使用 Composer 时 Symfony2 项目的大小太大

> ID：15141940
> 
> 赞同：4
> 
> 时间：2013-02-28T17:32:53.440
> 
> 标签：symfony, composer-php

首先我从官网下载了 Symfony2 框架（标准版），安装之后，整个 Symfony 项目总共有**16MB**左右。
之后，我想使用 Composer 和`create-project`命令启动另一个 Symfony2 项目。安装后，该应用程序有**~130MB**！
这两个项目之间存在巨大的规模差异。
我想我在使用 Composer 时下载了一些额外的捆绑包，但超过 100MB 的大小差异似乎很大。
我检查了两个项目，它们具有相同的目录结构（即我没有在更大的项目中找到一些额外的目录）。
那么，当我使用 Composer 时，为什么会有这么大的差异以及我做错了这么大的项目。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-28T18:16:14.160

可能是您有项目的 git 克隆，在这种情况下，大小确实会大得多。尝试删除供应商目录，然后运行`composer install --prefer-dist`以确保您只获取包文件而没有 git 信息。如果它没有区别，我想这只是它的文件大小。

另一个差异可能是由于 symfony.com 上的 zip 文件从供应商目录中删除了很多东西。供应商的测试和文档被剥离，而作曲家不会这样做。

但无论如何，它只是文件。磁盘很便宜。我不会担心太多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-10T05:57:29.390

一些 Node 社区现在有 250mb 的 emberjs ......

# python - 在 matplotlib 中使用 bbox_inches='tight' 时，如何获得以像素为单位的精确尺寸的图像？

> ID：15141944
> 
> 赞同：1
> 
> 时间：2013-02-28T17:33:03.430
> 
> 标签：python, matplotlib

我想将图形绘制为精确的分辨率（例如 800x600），但是当使用`bbox_inches='tight`' 时，绘图不是全分辨率，它们更小。我可以手动将图像尺寸（以英寸为单位）设置为（9.2、6.5）左右，结果为 799 x 601，但我希望有更好的解决方案。可以`bbox_inches='tight'`在调整大小之前设置吗？

```
import matplotlib as mlp
import matplotlib.pyplot as plt
import numpy as np

fig = plt.figure()
ax = fig.add_subplot(111)
x = y = np.arange(0, 1, 0.1)
plt.plot(x, y, label='my function')
plt.title('title')
ax.set_xlabel('xAxis')
ax.set_ylabel('yAxis')

#print fig.get_size_inches()
#fig.set_size_inches(9.2, 6.5)

plt.savefig('exact_size_test.png', bbox_inches='tight', dpi=100) 
```

[https://img707.imageshack.us/img707/2192/exactsizetest.png](https://img707.imageshack.us/img707/2192/exactsizetest.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T20:25:44.623

您想在调用之前使用`tight_layout`[(doc)](http://matplotlib.org/api/figure_api.html#matplotlib.figure.Figure.tight_layout)`savefig`

```
import matplotlib as mlp
import matplotlib.pyplot as plt
import numpy as np

fig = plt.figure()
ax = fig.add_subplot(111)
x = y = np.arange(0, 1, 0.1)
plt.plot(x, y, label='my function')
plt.title('title')
ax.set_xlabel('xAxis')
ax.set_ylabel('yAxis')

#print fig.get_size_inches()
fig.set_size_inches(8, 6, forward=True)
fig.tight_layout()
plt.savefig('exact_size_test.png', dpi=100) 
```

# ios - 了解 CATransform3D 围绕所有三个轴的旋转

> ID：15141946
> 
> 赞同：3
> 
> 时间：2013-02-28T17:33:11.997
> 
> 标签：ios, macos, catransform3d

我想以 3 个不同的角度围绕三个轴旋转视图：rx、ry、rz。

这是我所做的：

```
_tx = CATransform3DMakeRotation(rx*M_PI/360, 1, 0, 0);
_ty = CATransform3DMakeRotation(ry*M_PI/360, 0, 1, 0);
_tz = CATransform3DMakeRotation(rz*M_PI/360, 0, 0, 1);
view.layer.transform = CATransform3DConcat(_tx, CATransform3DConcat(_ty, _tz)); 
```

当我尝试反转串联顺序时，我虽然它正在工作。例如，

```
view.layer.transform = CATransform3DConcat(_tx, CATransform3DConcat(_ty, _tz)); 
```

和

```
view.layer.transform = CATransform3DConcat(_tz, CATransform3DConcat(_tx, _ty)); 
```

不要给出相同的结果！

1.  有没有办法用一个绕3轴旋转`CATransform3DMakeRotation`？
2.  或者更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-28T18:29:52.273

矩阵运算不可交换，更改将它们相乘的顺序将为您提供不同的结果变换矩阵。

您想按哪个顺序应用 3 种不同的旋转？这就是您应该连接变换矩阵的顺序。

# r - 纵向数据

> ID：15141952
> 
> 赞同：9
> 
> 时间：2013-02-28T17:33:27.937
> 
> 标签：r, lme4

我一直在使用“nlme”包中的 R Orthodont 数据集。只是用来`install.packages("nlme");library(nlme);head(Orthodont)`看看。该数据集包含随时间推移在 27 名儿童中测量的垂体和翼上颌裂之间的距离。 ![在此处输入图像描述](../Images/a5884752a1f7e066dfb4b7d71a92b9bb.png) 使用 lme4 包，我可以使用逻辑曲线作为我的函数形式来拟合非线性混合效应模型。我可以选择将渐近线和中点作为随机效应输入

```
nm1 <- nlmer(distance ~ SSlogis(age,Asym, xmid, scal) ~ (Asym | Subject) + (xmid | Subject), Orthodont, start = c(Asym =25,xmid = 11, scal = 3), corr = FALSE,verb=1) 
```

我真正想知道的是性别是否会改变这些参数。不幸的是，在线示例不包括主题和组示例。这甚至可以使用 lme4 包吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-06-01T02:18:37.237

我相信可以通过为自定义模型公式及其梯度创建一个函数来做这样的事情。标准*SSlogis*函数使用以下形式的逻辑函数：

```
f(input) = Asym/(1+exp((xmid-input)/scal)) # as in ?SSlogis 
```

您可以修改上述语句以满足您的需要，而不是调用*SSlogis 。*我相信你会想看看性别是否对固定效应有影响。*这是在Asym2*中修改特定性别的*Asym 子*群效果的示例代码：

 *```
# Just for loading the data, we will use lme4 for model fitting, not nlme
library(nlme)
library(lme4)
# Careful when loading both nlme and lme4 as they have overlap, strange behaviour may occur

# A more generalized form could be taken e.g. from http://en.wikipedia.org/wiki/Generalised_logistic_curve
# A custom model structure:
Model <- function(age, Asym, Asym2, xmid, scal, Gender) 
{
    # Taken from ?SSlogis, standard form:
    #Asym/(1+exp((xmid-input)/scal))
    # Add gender-specific term to Asym2
    (Asym+Asym2*Gender)/(1+exp((xmid-age)/scal))
    # Evaluation of above form is returned by this function
}

# Model gradient, notice that we include all 
# estimated fixed effects like 'Asym', 'Asym2', 'xmid' and 'scal' here,
# but not covariates from the data: 'age' and 'Gender'
ModelGradient <- deriv(
    body(Model)[[2]], 
    namevec = c("Asym", "Asym2", "xmid", "scal"), 
    function.arg=Model
) 
```

引入性别效应的一种相当典型的方式是使用二进制编码。我会将*Sex* -变量转换为二进制编码的*Gender*：

```
# Binary coding for the gender
Orthodont2 <- data.frame(Orthodont, Gender = as.numeric(Orthodont[,"Sex"])-1)
#> table(Orthodont2[,"Gender"])
# 0  1 
#64 44 
# Ordering data based on factor levels so they don't mix up paneling in lattice later on
Orthodont2 <- Orthodont2[order(Orthodont2[,"Subject"]),] 
```

然后我可以拟合自定义模型：

```
# Fit the non-linear mixed effects model
fit <- nlmer(
    # Response
    distance ~ 
    # Fixed effects
    ModelGradient(age = age, Asym, Asym2, xmid, scal, Gender = Gender) ~ 
    # replaces: SSlogis(age,Asym, xmid, scal) ~ 
    # Random effects
    (Asym | Subject) + (xmid | Subject), 
    # Data
    data = Orthodont2, 
    start = c(Asym = 25, Asym2 = 15, xmid = 11, scal = 3)) 
```

发生的情况是，当*Gender==0*（男性）时，模型实现了值：

```
(Asym+Asym2*0)/(1+exp((xmid-age)/scal)) = (Asym)/(1+exp((xmid-age)/scal)) 
```

这实际上是标准的 SSlogis 函数形式。但是，现在有一个二进制开关，如果*Gender==1*（女性）：

```
(Asym+Asym2)/(1+exp((xmid-age)/scal)) 
```

所以我们随着年龄的增长达到的渐近水平实际上是*Asym + Asym2*，而不仅仅是*Asym*，对于女性个体。

另请注意，我没有为*Asym2*指定新的随机效应。由于*Asym*对性别没有特异性，因此女性个体的个人渐近水平也会因*Asym*项而有所不同。模型拟合：

```
> summary(fit)
Nonlinear mixed model fit by the Laplace approximation 
Formula: distance ~ ModelGradient(age = age, Asym, Asym2, xmid, scal,      Gender = Gender) ~ (Asym | Subject) + (xmid | Subject) 
   Data: Orthodont2 
   AIC   BIC logLik deviance
 268.7 287.5 -127.4    254.7
Random effects:
 Groups   Name Variance Std.Dev.
 Subject  Asym 7.0499   2.6552  
 Subject  xmid 4.4285   2.1044  
 Residual      1.5354   1.2391  
Number of obs: 108, groups: Subject, 27

Fixed effects:
      Estimate Std. Error t value
Asym    29.882      1.947  15.350
Asym2   -3.493      1.222  -2.859
xmid     1.240      1.068   1.161
scal     5.532      1.782   3.104

Correlation of Fixed Effects:
      Asym   Asym2  xmid  
Asym2 -0.471              
xmid  -0.584  0.167       
scal   0.901 -0.239 -0.773 
```

看起来可能存在性别特定效应（t -2.859），因此随着“年龄”的增加，女性患者的“距离”值似乎会降低：29.882 - 3.493 = 26.389

我不一定建议这是一个好的/最好的模型，只是展示了如何继续自定义*lme4*中的非线性模型。如果要提取非线性固定效应，模型的可视化需要一些修改（与[如何通过观察提取 lmer 固定效应中的线性模型的可视化类似？](https://stackoverflow.com/questions/8682865)）：

```
# Extracting fixed effects components by calling the model function, a bit messy but it works
# I like to do this for visualizing the model fit
fixefmat <- matrix(rep(fixef(fit), times=dim(Orthodont2)[1]), ncol=length(fixef(fit)), byrow=TRUE)
colnames(fixefmat) <- names(fixef(fit))
Orthtemp <- data.frame(fixefmat, Orthodont2)
attach(Orthtemp)
# see str(Orthtemp)
# Evaluate the function for rows of the attached data.frame to extract fixed effects corresponding to observations
fix = as.vector(as.formula(body(Model)[[2]]))
detach(Orthtemp)

nobs <- 4 # 4 observations per subject
legend = list(text=list(c("y", "Xb + Zu", "Xb")), lines = list(col=c("blue", "red", "black"), pch=c(1,1,1), lwd=c(1,1,1), type=c("b","b","b")))
require(lattice)
xyplot(
    distance ~ age | Subject, 
    data = Orthodont2,
    panel = function(x, y, ...){
        panel.points(x, y, type='b', col='blue')
        panel.points(x, fix[(1+nobs*(panel.number()-1)):(nobs*(panel.number()))], type='b', col='black')
        panel.points(x, fitted(fit)[(1+nobs*(panel.number()-1)):(nobs*(panel.number()))], type='b', col='red')
    },
    key = legend
)

# Residuals
plot(Orthodont2[,"distance"], resid(fit), xlab="y", ylab="e")

# Distribution of random effects
par(mfrow=c(1,2))
hist(ranef(fit)[[1]][,1], xlab="Random 'Asym'", main="")
hist(ranef(fit)[[1]][,2], xlab="Random 'xmid'", main="")
# Random 'xmid' seems a bit skewed to the right and may violate normal distribution assumption
# This is due to M13 having a bit abnormal growth curve (random effects):
#           Asym       xmid
#M13  3.07301310  3.9077583 
```

图形输出：

![模型适合](../Images/69b05bdda73f7d85409cb5060d736ace.png)

请注意上图中女性 (F##) 个体如何略低于男性 (M##) 对应物（黑线）。例如，中间区域面板中的 M10 <-> F10 差异。

![残差](../Images/08fa233dd135a70be5b39aa65617306f.png)

![随机效应](../Images/cf21765857a58a840f07695f04fd6f8d.png)

用于观察指定模型的某些特征的残差和随机效应。个别的 M13 似乎有点棘手。*

# c# - 将列表绑定到数据源

> ID：15141953
> 
> 赞同：9
> 
> 时间：2013-02-28T17:33:32.170
> 
> 标签：c#, winforms, datasource

我希望能够将列表绑定到列表框数据源，并且在修改列表时，列表框的 UI 会自动更新。（Winforms 不是 ASP）。这是一个示例：

```
private List<Foo> fooList = new List<Foo>();

    private void Form1_Load(object sender, EventArgs e)
    {
        //Add first Foo in fooList
        Foo foo1 = new Foo("bar1");
        fooList.Add(foo1);

        //Bind fooList to the listBox
        listBox1.DataSource = fooList;
        //I can see bar1 in the listbox as expected
    }

    private void button1_Click(object sender, EventArgs e)
    {
        //Add anthoter Foo in fooList
        Foo foo2 = new Foo("bar2");
        fooList.Add(foo2);
        //I expect the listBox UI to be updated thanks to INotifyPropertyChanged, but it's not
    }

class Foo : INotifyPropertyChanged
{
    private string bar_ ;
    public string Bar
    {
        get { return bar_; }
        set 
        { 
            bar_ = value;
            NotifyPropertyChanged("Bar");
        }
    }

    public Foo(string bar)
    {
        this.Bar = bar;
    }

    public event PropertyChangedEventHandler PropertyChanged;

    private void NotifyPropertyChanged(string info)
    {
        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs(info));
        }
    }

    public override string ToString()
    {
        return bar_;
    }
} 
```

如果我更换`List<Foo> fooList = new List<Foo>();`，`BindingList<Foo> fooList = new BindingList<Foo>();`那么它的工作原理。但我不想改变原来的傻瓜类型。我想要这样的工作：`listBox1.DataSource = new BindingList<Foo>(fooList);`

编辑：另外，我刚刚在这里阅读了Ilia Jerebtsov 的[List<T> vs BindingList<T> 的优点/缺点](https://stackoverflow.com/questions/2243950/listt-vs-bindinglistt-advantages-disadvantages)：“当您将 Bi​​ndingSource 的 DataSource 设置为 List<> 时，它会在内部创建一个 BindingList 来包装您的列表”。我认为我的示例只是表明这是不正确的：我的 List<> 似乎没有在内部包装到 BindingList<> 中。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-28T19:43:18.183

您的示例中没有[BindingSource](http://msdn.microsoft.com/en-us/library/system.windows.forms.bindingsource.aspx)。

您需要像这样修改它以使用 BindingSource

```
 var bs = new BindingSource();
   Foo foo1 = new Foo("bar1");
   fooList.Add(foo1);

     bs.DataSource = fooList; //<-- point of interrest

    //Bind fooList to the listBox
    listBox1.DataSource = bs; //<-- notes it takes the entire bindingSource 
```

**编辑**

请注意（正如评论中指出的那样） - bindingsource 不适用于`INotifyPropertyChanged`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-28T17:58:59.173

尝试

```
listBox1.DataSource = new BindingList<Foo>(fooList); 
```

然后

```
private void button1_Click(object sender, EventArgs e)
{
    Foo foo2 = new Foo("bar2");
    (listBox1.DataSource as BindingList<Foo>).Add(foo2);
} 
```

这将更新 fooList 而无需更改其原始类型。此外，当您更改 Bar 成员时，它会更新 ListBox`fooList[1].Bar = "Hello";`

但是，您必须将`DisplayMember`ListBox 的属性设置为“Bar”，**或者**保持 .ToString() 覆盖与 Foo 类定义中的一样。

为了避免每次都必须强制转换，我建议您使用与 List 定义相同级别的 BindingList 变量：

```
private List<Foo> fooList;
private BindingList<Foo> fooListUI;

fooListUI = new BindingList<Foo>(fooList);
listBox1.DataSource = fooListUI; 
```

并在按钮中：

```
Foo foo2 = new Foo("bar2");
fooListUI.Add(foo2); 
```

# macos - 如何擦除 Cocoa 中绘制的对象？

> ID：15141958
> 
> 赞同：3
> 
> 时间：2013-02-28T17:33:37.590
> 
> 标签：macos, cocoa, drawing, nsview, quartz-graphics

我创建了一个绘图程序。它效果很好，您可以导入图像并使用不同的颜色和画笔配置对其进行注释。

我的问题是我不知道如何允许擦除。我为 android 编写了同样的应用程序，并使用 PorterDuffXferMode 对象进行擦除。我无法在 Cocoa 中找到类似的东西。

我错过了一些明显的东西吗？我是可可豆。

我正在使用 NSBezierPath 和 NSRectFill 的组合来绘制 NSView。

更新：

在阅读这里的回复之前，我修改了我的代码以在原始 NSView 下方使用嵌套的 NSView。所以我的想法是在底部的 Z 顺序视图上绘制背景图像，并在顶部的 NSView 上完成所有图形。它画得很好，但是在我的顶视图中，我在要擦除的区域上调用 NSClearRect 并且它是白色的，而不是擦除到底层。

为什么不显示到底层？

我将研究使用 CALayers，但您必须给我一些时间来消化您所写的内容。就像我之前说的，我是 Objective C 和 Cocoa 的菜鸟。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T19:07:12.263

我不确定绘图环境（传输模式）如何在 Android 上准确运行，但 Core Graphics 提供了所有标准和 Photoshop 风格的混合模式等。

您对预期的“擦除”行为实际上不是很具体。要清除上下文中的矩形，请使用`CGContextClearRect()`. 如果要清除其他形状，请设置一个剪贴蒙版，如[本问题](https://stackoverflow.com/questions/14755840/cgcontextclearrect-with-circle)所示。

如果您想做一些比清除区域更复杂的事情（例如，想要重新绘制背景颜色或图像或图案），那么您可以查看图像蒙版和混合模式。

# c# - 关闭最后一个连接后，如何通过套接字侦听传入连接？

> ID：15141961
> 
> 赞同：1
> 
> 时间：2013-02-28T17:33:40.063
> 
> 标签：c#, sockets, listener

我正在设置一个套接字来监听传入的连接：

```
public Socket Handler;

public void StartListening()
{
    // Establish the locel endpoint for the socket
    IPEndPoint localEndPoint = new IPEndPoint(IPAddress.Any, Port);

    // Create a TCP/IP socket
    Socket listener = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);

    try
    {
        // Bind the socket to the local endpoint and listen
        listener.Blocking = false;
        listener.Bind(localEndPoint);
        listener.Listen(100);

        // Start an asynchronous socket to listen for connections
        listener.BeginAccept( new AsyncCallback(AcceptCallback), listener);
    }
    catch (Exception e)
    {
        invokeStatusUpdate(0, e.Message);
    }            
}

private void AcceptCallback(IAsyncResult ar)
{
    // Get the socket that handles the client request
    Socket listener = (Socket) ar.AsyncState;
    Socket handler = listener.EndAccept(ar);
    Handler = handler;

    // Create the state object
    StateObject state = new StateObject();
    state.workSocket = handler;
    handler.BeginReceive(state.buffer, 0, StateObject.BufferSize, 0, new AsyncCallback(ReceiveCallback), state);
} 
```

正如您在上面看到的，一旦建立连接，我就会设置我的 BeginReceive 回调。这工作正常。

最终，我想关闭当前连接，然后再次开始侦听我的套接字以进行传入连接尝试：

```
public void CloseNode(bool restart)
{
    try
    {
        if (Handler != null)
        {
            Handler.Shutdown(SocketShutdown.Both);
            Handler.Close();
            Handler.Dispose();
            Handler = null;
        }

        if (restart)
            StartListening();
    }
    catch (Exception e)
    {
        invokeStatusUpdate(0, e.Message);
    }
} 
```

我的 close 方法需要一个布尔值来知道它是否应该开始监听更多的传入连接。

问题是，当我回到我的`StartListening`方法时，我在一行上得到一个异常，`listener.Bind(localEndPoint);`说**“每个套接字地址（协议/网络地址/端口）通常只允许一次使用”**。

如何设置我的听力以再次开始聆听？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T17:36:10.140

将其分为两种方法：`startListening()`和`continueListening()`

开始收听将初始化所有内容，然后调用继续收听。你现在打电话的地方开始收听，改为继续收听。

或者，如果您想一次允许多个，只需将`BeginAccept`调用置于`while(true)`循环中即可。这将永远接受所有传入的连接，即使其他人已经连接。这就是为什么它毕竟是异步的！

这是你的成员变量

```
public Socket Handler;
private socket listener; // added by corsiKa 
```

这是你的新开始方法

```
public void StartListening()
{
    // Establish the locel endpoint for the socket
    IPEndPoint localEndPoint = new IPEndPoint(IPAddress.Any, Port);

    // Create a TCP/IP socket
    listener = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);

    try
    {
        // Bind the socket to the local endpoint and listen
        listener.Blocking = false;
        listener.Bind(localEndPoint);
        listener.Listen(100);

        // Start an asynchronous socket to listen for connections
        performListen(listener); // changed by corsiKa
    }
    catch (Exception e)
    {
        invokeStatusUpdate(0, e.Message);
    }            
} 
```

这是你的执行监听方法

```
// added by corsiKa
private void performListen(Socket listener) {
    listener.BeginAccept( new AsyncCallback(AcceptCallback), listener);
} 
```

这是您的新关闭方法

```
// variable name changed by corsiKa
public void CloseNode(bool acceptMoreConnections)
{
    try
    {
        if (Handler != null)
        {
            Handler.Shutdown(SocketShutdown.Both);
            Handler.Close();
            Handler.Dispose();
            Handler = null;
        }
        // changed by corsiKa
        if (acceptMoreConnections)
            performListen(listener);
    }
    catch (Exception e)
    {
        invokeStatusUpdate(0, e.Message);
    }
} 
```

# android - android - 使用 JSONArray 中的数据填充 ListView

> ID：15141963
> 
> 赞同：0
> 
> 时间：2013-02-28T17:33:43.957
> 
> 标签：android, android-listview

情况：我`JSONObject`从服务器获取包含用户的播放列表。我想在一个中显示这个数据`ListView`，我的测试用例中有 288 个音频文件。JSON 被正确解析，大小等于 288。我创建了一个帮助类并`ArrayList`使用它的对象参数化。问题：我的条目中正好有 288 个项目，`ListView`但正确的条目 Artist - Title 上升到索引 13（不知道为什么），然后它们被*重复*。所以我在列表中没有 288 个不同的条目，但我只有 14 个条目重复到列表末尾。

**更新：**我删除了 if 语句，它解决了问题，但 RAM 消耗增加了 3MB。有什么优化建议吗？

```
 public class AudioList extends ListActivity {

private ListView lv;
private JSONObject usersPlaylist, singleJSONItem;
private JSONArray responseJSONArray;
private SharedPreferences prefs;
private PlaylistItem audioList;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_audio_list);
    init();

    ArrayList<PlaylistItem> playlist = new ArrayList<PlaylistItem>();
    try {
        usersPlaylist = Utils.retrieveJsonObjectFromUrl(new URL(
                APP_CONSTANTS.REQUEST_AUDIO_LIST(prefs)), this);
        responseJSONArray = usersPlaylist.getJSONArray("response");

        for (int i = 0; i < responseJSONArray.length(); i++) {
            singleJSONItem = responseJSONArray.getJSONObject(i);
            audioList = new PlaylistItem(singleJSONItem);
            playlist.add(audioList); 
        }

        Toast.makeText(getApplicationContext(),
                Integer.toString(playlist.size()), Toast.LENGTH_LONG)
                .show(); //there are 288 entries, JSONArray parsed correctly

    } catch (MalformedURLException e) {

        e.printStackTrace();
    } catch (JSONException e) {

        e.printStackTrace();
    } catch (IOException e) {

        e.printStackTrace();
    }

    AudioListAdapter adapter = new AudioListAdapter(this,
            R.layout.playlist_item, playlist);
    lv.setAdapter(adapter);

}

private void init() {
    lv = getListView();
    lv.setTranscriptMode(0x00000000);
    lv.setDividerHeight(1);
    lv.setSmoothScrollbarEnabled(true);
    prefs = PreferenceManager.getDefaultSharedPreferences(this);

} 
```

播放列表项类：

```
 public class PlaylistItem {

private String artist, title;
private JSONObject obj;

public PlaylistItem(JSONObject obj) {
    this.obj = obj;
}
public PlaylistItem(){

}

public String getArtist() {
    try {
        artist = obj.getString("artist");
    } catch (JSONException e) {

        e.printStackTrace();
    }
    return artist;

}

public String getTitle() {
    try {
        title = obj.getString("title");
    } catch (JSONException e) {

        e.printStackTrace();
    }
    return title;
}
    } 
```

适配器：

```
 public class AudioListAdapter extends ArrayAdapter<PlaylistItem> {

private Context context;
private int layoutResourceId;
private PlaylistItem aud;
private ArrayList<PlaylistItem> data = null;

public AudioListAdapter(Context context, int layoutResourceId,
        ArrayList<PlaylistItem> data) {
    super(context, layoutResourceId, data);
    this.layoutResourceId = layoutResourceId;
    this.context = context;
    this.data = data;

}

@Override
public View getView(int position, View convertView, ViewGroup parent) {
    View row = convertView;
    ViewHolder holder = new ViewHolder();
    aud = data.get(position);
            //it's giving a CORRECT position if I hardcode the index, like data.get(99);
    if (row == null) {

        LayoutInflater inflater = ((Activity) context).getLayoutInflater();
        row = inflater.inflate(layoutResourceId, parent, false);
        holder.play = (Button) row.findViewById(R.id.btn_list_play);
        holder.imgSaved = (ImageView) row
                .findViewById(R.id.img_list_audio_saved);
        holder.tvArtist = (TextView) row
                .findViewById(R.id.tvListItemArtist);
        holder.tvTitle = (TextView) row.findViewById(R.id.tvListItemSong);

        holder.tvArtist.setText(aud.getArtist());
        holder.tvTitle.setText(aud.getTitle());

    }

    return row;
}

static class ViewHolder {
    Button play;
    ImageView imgSaved;
    TextView tvArtist, tvTitle;

}

    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-28T18:11:58.480

在 getView 方法中，如果 View 是回收的，则不会再次填充 View。因此，一旦您滚动到屏幕外，它将开始显示旧的。您也没有设置/检索 ViewHolder。请尝试以下实现（未经测试）。

```
@Override
public View getView(int position, View convertView, ViewGroup parent) {
   View row = convertView;
   ViewHolder holder = null;
   aud = data.get(position);
        //it's giving a CORRECT position if I hardcode the index, like data.get(99);
   if (row == null) {
       holder = new ViewHolder();
       LayoutInflater inflater = ((Activity) context).getLayoutInflater();
       row = inflater.inflate(layoutResourceId, parent, false);
       holder.play = (Button) row.findViewById(R.id.btn_list_play);
       holder.imgSaved = (ImageView) row
            .findViewById(R.id.img_list_audio_saved);
       holder.tvArtist = (TextView) row
            .findViewById(R.id.tvListItemArtist);
       holder.tvTitle = (TextView) row.findViewById(R.id.tvListItemSong);          
       row.setTag(holder);
} else {
    holder = (ViewHolder)row.getTag();
}
holder.tvArtist.setText(aud.getArtist());
holder.tvTitle.setText(aud.getTitle());

return row;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T17:59:52.197

如果要删除此行：

```
 View row = convertView; 
```

并且每次都膨胀视图，那么这个问题就会消失。如此处所述，我也遇到过几次这种影响：

[从屏幕上消失后，如何在 Listview 行中保存更改后的 ImageView 的状态？](https://stackoverflow.com/questions/14390948/how-to-save-state-of-changed-imageview-in-listview-row-after-it-has-disappeare)

实际上我不知道为什么会发生这种情况，因为建议使用 convertView。

**更新：**

试试这个：

```
@Override
public View getView(int position, View convertView, ViewGroup parent) {
View row;
ViewHolder holder = new ViewHolder();
LayoutInflater inflater = (LayoutInflater)getSystemService(Context.LAYOUT_INFLATER_SERVICE);
row = inflater.inflate(layoutResourceId, parent, false);
holder.play = (Button) row.findViewById(R.id.btn_list_play);
holder.imgSaved = (ImageView) row.findViewById(R.id.img_list_audio_saved);
holder.tvArtist = (TextView) row.findViewById(R.id.tvListItemArtist);
holder.tvTitle = (TextView) row.findViewById(R.id.tvListItemSong);
holder.tvArtist.setText(aud.getArtist());
holder.tvTitle.setText(aud.getTitle());

return row; 
```

}

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-28T18:08:37.363

我对您的 getView 方法进行了一些修改。替换它并检查它。

```
 @Override
        public View getView(int position, View convertView, ViewGroup parent) {
            View row = convertView;
            ViewHolder holder;
            aud = data.get(position);
                    //it's giving a CORRECT position if I hardcode the index, like data.get(99);
            if (row == null) {
                holder = new ViewHolder();
                LayoutInflater inflater = ((Activity) context).getLayoutInflater();
                row = inflater.inflate(layoutResourceId, parent, false);
                holder.play = (Button) row.findViewById(R.id.btn_list_play);
                holder.imgSaved = (ImageView) row.findViewById(R.id.img_list_audio_saved);
                holder.tvArtist = (TextView) row .findViewById(R.id.tvListItemArtist);
                holder.tvTitle = (TextView) row.findViewById(R.id.tvListItemSong);
                row.setTag(holder);
        }
    else
    {
                    holder = (ViewHolder ) row.getTag();

    }
                holder.tvArtist.setText(aud.getArtist());
                holder.tvTitle.setText(aud.getTitle());

            return row;
        } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-28T18:14:18.603

```
 if (convertView == null)// if null

       {
        convertView = mInflater.inflate(R.layout.list, null);//inflate view
       } else 
       {
        holder = (ViewHolder) convertView.getTag();// set tag to holder.
       } 
```

做出这些改变。

# php - $name 和 $screenshot 不起作用 php-mysql

> ID：15141964
> 
> 赞同：-5
> 
> 时间：2013-02-28T17:33:44.437
> 
> 标签：php, mysql

完成 PHP 表单后，我在数据库中插入了这一行：

```
INSERT INTO guitarwars VALUES (0, NOW(), '$name', '$score'); 
```

问题是在我的 PHP 页面中我看到的是 $name，而不是我输入的表单中的名称。

LE：我有 2 个文件：index.php，addscore.php： **index.php**

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Guitar Wars - High Scores</title>
<link rel="stylesheet" type="text/css" href="style.css" />
</head>
<body>
<h2>Guitar Wars - High Scores</h2>
<p>Welcome, Guitar Warrior, do you have what it takes to crack the high score list? If so, just <a href="addscore.php">add your own score</a>.</p>
<hr />

<?php
// Connect to the database 
$dbc = mysqli_connect('localhost', 'root', '', 'guitar');

// Retrieve the score data from MySQL
$query = "SELECT * FROM guitarwars";
$data = mysqli_query($dbc, $query);

// Loop through the array of score data, formatting it as HTML 
echo '<table>';
while ($row = mysqli_fetch_array($data)) { 
// Display the score data
echo '<tr><td class="scoreinfo">';
echo '<span class="score">' . $row['score'] . '</span><br />';
echo '<strong>Name:</strong> ' . $row['name'] . '<br />';
echo '<strong>Date:</strong> ' . $row['date'] . '</td></tr>';
if(is_file($row['screenshot']) && filesize($row['screenshot'])>0) {
echo '<td><img src="'.$row['screenshot'].'" alt="Score image" /></td></tr>';
}
else {
echo '<td><img src="unverified.gif" alt="Unverified score" /></td></tr>';
}
}
echo '</table>';

mysqli_close($dbc);
?>

</body> 
</html> 
```

并**添加core.php**

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Guitar Wars - Add Your High Score</title>
<link rel="stylesheet" type="text/css" href="style.css" />
</head>
<body>
<h2>Guitar Wars - Add Your High Score</h2>

<?php
if (isset($_POST['submit'])) {
// Grab the score data from the POST
$name = $_POST['name'];
$score = $_POST['score'];

if (!empty($name) && !empty($score)) {
  // Connect to the database
  $dbc = mysqli_connect('localhost', 'root', '', 'guitar');

  // Write the data to the database
  $query = "INSERT INTO guitarwars VALUES (0, NOW(), '$name', '$score')";
  mysqli_query($dbc, $query);

  // Confirm success with the user
  echo '<p>Thanks for adding your new high score!</p>';
  echo '<p><strong>Name:</strong> ' . $name . '<br />';
  echo '<strong>Score:</strong> ' . $score . '</p>';
  echo '<p><a href="index.php">&lt;&lt; Back to high scores</a></p>';

  // Clear the score data to clear the form
  $name = "";
  $score = "";

  mysqli_close($dbc);
}
else {
  echo '<p class="error">Please enter all of the information to add your high score.</p>';
}
}
?>

<hr />
<form enctype="multipart/form-data" method="post" action="<?php echo $_SERVER['PHP_SELF']; ?>">
<input type="hidden" name="MAX_FILE_SIZE" value="32768" />
<label for="name">Name:</label>
<input type="text" id="name" name="name" value="<?php if (!empty($name)) echo $name; ?>" /><br />
<label for="score">Score:</label>
<input type="text" id="score" name="score" value="<?php if (!empty($score)) echo $score; ?>" />
<input type="file" id="screenshot" name="screenshot" />
<hr />
<input type="submit" value="Add" name="submit" />
</form>
</body> 
</html> 
```

在我完成了addscore.php的表格并放了一张乐谱的照片后，我使用了 INSERT INTO guitarwars VALUES (0, NOW(), '$name', '$score'); 在数据库中插入来自 PHP 脚本的值。然后，在 index.php 中，我应该看到我在表单中输入的名称，而不是 $name。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-28T17:38:17.617

变量没有被插值，这意味着您的查询使用单引号或 NOWDOC（或其他原因）。最好通过 PDO/mysqli 使用正确的参数化查询。我更喜欢前者。

```
$pdo = new PDO('mysql:host=localhost;dbname=dbname', 'user', 'pass');
$stmt = $pdo->prepare("INSERT INTO guitarwards VALUES (0, NOW(), ?, ?)");
$stmt->execute(array($name, $score)); 
```

此外，您可以列出要插入的列，并可能省略前两个。

# ios - 从后台进入前台时无法显示 admob 插页式广告

> ID：15141968
> 
> 赞同：2
> 
> 时间：2013-02-28T17:33:56.390
> 
> 标签：ios, objective-c, xcode, uiviewcontroller, admob

使用 iOS 示例项目 2.5：http: [//google-mobile-dev.googlecode.com/files/InterstitialExample_iOS_2.5.zip](http://google-mobile-dev.googlecode.com/files/InterstitialExample_iOS_2.5.zip)

在 中`MainController.m`，我添加了两个方法来调用`showInterstitial`这样的方法，每次当应用程序从后台进入前台时，例如

```
- (void) viewDidLoad {
       [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(appWillEnterForegroundNotification) name:UIApplicationWillEnterForegroundNotification object:nil];
}

- (void) appWillEnterForegroundNotification{        
    [self showInterstitial:nil];
} 
```

第一种方法是为视图控制器注册回调以接收进入前台通知，第二种方法`showInterstitial`在发生这种情况时调用该方法。我可以看到该方法`showInterstitial`确实被调用并且请求确实被触发，但是没有调用成功或错误回调。

任何的想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-28T22:12:24.220

这可能不是展示插页式广告的合适时机。您希望应用程序再次处于活动状态，而不是即将处于活动状态。

尝试从`- (void)applicationDidBecomeActive:(UIApplication *)application`

# asp.net - asp.net mvc 路由规则

> ID：15141970
> 
> 赞同：0
> 
> 时间：2013-02-28T17:33:59.023
> 
> 标签：asp.net, asp.net-mvc-3, asp.net-mvc-routing

我在 asp.net mvc 项目中定义了以下路由

```
//Products/Category/SubCategory/Page 
routes.MapRoute(
    "ProductCategoryTypePaging", 
    "Products/{Category}/{subCategory}/Page{page}", 
    new { controller = "Products", action = "Index" }, new { page = @"\d+" }
);

//Products/Category/Page 
routes.MapRoute(
    "ProductCategoryPaging", 
    "Products/{Category}/Page{page}", 
    new { controller = "Products", action = "Index" }, new { page = @"\d+" }
);

//Products/Category/SubCategory 
routes.MapRoute(
    "ProductCategoryType", 
    "Products/{Category}/{subCategory}", 
    new { controller = "Products", action = "Index", page = 1 }
);

//Products/Category 
routes.MapRoute(
    "ProductCategory", 
    "Products/{Category}", 
    new { controller = "Products", action = "Index" }
);

routes.MapRoute(
    "Default", // Route name
    "{controller}/{action}/{id}", // URL with parameters
    new { controller = "Home", action = "Index", id = UrlParameter.Optional } // Parameter defaults
); 
```

这些似乎工作正常，但如果我尝试查看产品详细信息，它就会中断。要查看详细信息，Url 是这样的：

/产品/详情/18

在 Products/Category/SubCategory 路线上运行匹配

我需要做些什么不同的事情来完成这项工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T18:20:03.763

有多种方法可以做到这一点：

1.  将路由的静态部分更改为不同，例如将 Products/Category/SubCategory 路由更改为具有以下模板（或类似的唯一模板）：“ProductCategory/{Category}/{subCategory}”
2.  将约束添加到仅允许有效类别的同一路由，并允许非类别的事物通过。

根本问题是这个应用程序中的路由结构不明确。如果有一个名为“详细信息”的类别有一个名为“18”的子类别，您会期望发生什么？它应该映射哪条路线？

在我上面列出的选项 #2 的脉络中，您可以添加到类别/子类别路由的约束将是例如 RegEx 约束，它不允许类别名称为“详细信息”。这将导致路由被跳过，但它也会阻止应用程序拥有一个名为“详细信息”的类别。如果该应用程序没问题，它应该可以正常工作。

# parameter-passing - “通过引用”是糟糕的设计吗？

> ID：15141973
> 
> 赞同：30
> 
> 时间：2013-02-28T17:34:10.793
> 
> 标签：parameter-passing, pass-by-reference

所以，我刚开始学习Java，发现根本没有“引用传递”这回事。我正在将应用程序从 C# 移植到 Java，原始应用程序具有整数和双精度值，它们是“ref”或“out”参数。

起初我以为我可以传入“整数”或“双精度”，因为那是引用类型，所以值会改变。但后来我了解到这些引用类型是不可变的。

所以，然后我创建了一个“MutableInteger”类和一个“MutableDouble”类，并将它们传递给我的函数。它有效，但我想我必须违背该语言的原始设计意图。

一般糟糕的设计是“通过引用传递”吗？我应该如何改变我的思维方式？

有这样的功能似乎是合理的：

```
bool MyClass::changeMyAandB(ref int a, ref int b)
{
    // perform some computation on a and b here

    if (success)
        return true;
    else return false;
} 
```

这是糟糕的设计吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-28T17:37:53.237

在适当支持的语言中，它的设计还不错，(*) 但是当您必须定义一个`MutableInt`类只是为了在两个方法之间进行通信时，肯定有问题。

您发布的示例的解决方案是返回一个包含两个整数的数组，并通过`null`返回或异常表示失败。这并不总是有效，所以有时你必须...

*   在当前对象上设置属性（当类中的两个方法通信时）；
*   传入该方法可能修改的整数数组（当有很多整数要多次传递时）；
*   创建一个辅助类，例如`Result`，封装计算结果（当您处理一个`int`和一个`float`而不是两个整数时），并且可能将实际计算作为方法或构造函数；
*   [使用您建议的习语，然后考虑在Apache Commons](http://commons.apache.org/proper/commons-lang//api/org/apache/commons/lang3/mutable/MutableObject.html)或其他好的库中使用对它的支持。

(*) 只是糟糕的语言设计。在 Python 或 Go 中，您将返回多个值并不必担心。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2013-02-28T17:46:38.753

如果您将代码构造成干净、可理解的抽象，那么面向对象的编程是最好的。

数字，作为一种抽象，是**不可变**的并且**没有身份**（即“五”总是一个“五”，并且不存在“五的多个实例”这样的东西）。

您试图发明的是一个“可变数字”，它是可变的并且具有身份。这个概念有点笨拙，你可能最好用**更有意义的抽象**（对象）来建模你的问题。

考虑代表某物并具有特定界面的对象，而不是单个值块。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-02-28T17:38:26.210

通过引用传递**值对象**通常是一个糟糕的设计。

它适用于某些场景，例如用于高性能排序操作的数组位置交换。

您需要此功能的原因很少。在 C# 中，使用 OUT 关键字通常本身就是一个缺点。out 关键字有一些可接受的用法，例如，`DateTime.TryParse(datetext, out DateValue)`但 out 参数的标准用法是糟糕的软件设计，通常希望模仿使用标志来表示所有状态的不良做法。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-02-28T17:49:08.090

## “通过引用”是糟糕的设计吗？

一般不会。您需要了解您的特定场景并问自己一个函数的作用。而且您需要正确定义您的编码风格，特别是如果您正在为他人编码（分发库）。

当您的函数返回多个输出时，通常会通过引用传递。`ResultContainer`返回一个包含函数返回的所有信息的对象通常是个好主意。以以下 C# 示例为例：

```
bool isTokenValid(string token, out string username) 
```

VS

```
AuthenticationResult isTokenValid(string token)

class AuthenticationResult {
    public bool AuthenticationResult;
    public string Username;
} 
```

不同之处在于带有引用（在本例中为`out`put）参数的方法清楚地强调了它只能用于验证令牌或可选地用于提取用户信息。因此，即使您有义务传递一个参数，如果您不需要它，您也可能会丢弃它。第二个示例代码更冗长。

当然如果你有这样的方法，第二种设计是更可取的

```
bool doSomething(object a, ref object b, ref object c, ref object d, ... ref object z); 
```

因为您会将它们全部包装到一个容器中。

现在让我澄清一下：在 Java 和 C# 中，非原始类型**始终作为克隆引用传递**。这意味着`object`s 不会自己克隆，而只会将对它们的引用克隆到堆栈中，然后您不能指望在返回后指向完全不同的对象。相反，您总是希望该方法修改对象的状态。否则你只是`clone()`对象，瞧。

所以这里有诀窍：`MutableInteger`或者更好的`Holder`模式，是通过引用传递原始值的解决方案。

`idl2java`当您的 IDL 具有引用参数时，CORBA 编译器当前使用它。

在您的具体情况下，我无法就设计的好坏回答您，因为您展示的方法太通用了。所以想想吧。就像输入一样，如果我对多媒体信息应用某种后处理功能，甚至像加密一样，我会使用引用传递。对我来说，以下看起来不错的设计

```
encrypt(x); 
```

VS

```
x = encrypt(x); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-28T17:38:30.003

您参与的糟糕设计是使用`MutableInteger`类。2 永远是 2。明天就是 2。

标准的 Java/OO 模式通常是让这些项目成为一个类的实例，并让该类操作/管理它们。

接下来是`AtomicInteger`. 同样，我从来没有遇到过需要传递它的情况，但是如果您不想重构大量代码（您的问题是“好习惯”，所以我不得不对您很苛刻），那就更好了选项。原因是如果你让一个整数转义到另一个函数，从封装的角度来看，*你不知道另一个函数将在同一个线程上运行。* 因此，并发性存在问题，您可能希望原子引用类提供的并发性。（另见`AtomicReference`。）

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-02-28T17:42:23.360

在调用者堆栈中修改 var 的方法可能会非常令人困惑。

理想情况下，语言应该支持返回多个值，这将解决这类问题。

但在此之前，如果*必须*使用“out”参数，则必须这样做。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-02-28T18:19:58.073

一般糟糕的设计是“通过引用传递”吗？我应该如何改变我的思维方式？无需制作一个 POJO bean 来保存您的值，将该 bean 发送到函数并取回新值。当然，在某些情况下，您调用的函数可以返回值（如果它总是只有一件事您想要返回，但您谈论的是输出变量，所以我认为它不止一个）。

传统上制作具有需要更改的属性的 bean 示例：

```
class MyProps{
int val1;
int val2;//similarly can have strings etc here
public int getVal1(){
return val1;
}
public void setVal1(int p){ 
val1 = p;
}// and so on other getters & setters

} 
```

或者可以使用泛型创建一个类来保存任何对象

```
class TVal<E>{
E val;
public E getValue(){
return val;
}
public void setValue(E p){
val = p;
}
} 
```

现在使用您的类通过容器的引用传递：

```
public class UseIt{
    void a (){
      TVal<Integer> v1 = new TVal<Integer>();
      v1.setValue(1);//auto boxed to Integer from int
      TVal<Integer> v2 = new TVal<Integer>();
      v2.setValue(3);
      process(v1,v2);
      System.out.println("v1 " + v1 + " v2 " + v2);
    }

    void process(TVal<Integer> v,TVal<Integer> cc){
        v.setValue(v.getValue() +1);
        cc.setValue(cc.getValue() * 2);
    }
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-02-28T17:45:51.900

当然，这取决于您正在处理的特定问题，但我会说，在大多数情况下，如果您需要这样的功能，您的设计就不是非常面向对象的。
你想达到什么目的？如果这个数字 a 和 b 必须一起操作，可能它们属于 MyClass 类，你需要的是一个实例方法。就像是：

```
class MyClass{
     private int a;
     private int b;
     //getters/setters/constructors
     public boolean dothings(){
     // perform some computation on a and b here
        if (success)
             return true;
        else return false;
        //why not just return success?
     } 

} 
```

# macos - webgl 可以在 Mac 上的 chrome 上运行吗？

> ID：15141974
> 
> 赞同：24
> 
> 时间：2013-02-28T17:34:14.913
> 
> 标签：macos, google-chrome, webgl, osx-mountain-lion

我让 webgl 在 safari 上工作，但无法让它在 chrome 上工作。我用这个来测试

[http://get.webgl.org/](http://get.webgl.org/)

在 safari 上，它只有在启用 webgl 后才能工作，请参阅[http://support.apple.com/kb/PH11926](http://support.apple.com/kb/PH11926)

在 chrome 上，它显示“嗯。虽然您的浏览器似乎支持 WebGL，但它已被禁用或不可用。如果可能，请确保您运行的是最新的显卡驱动程序”

我希望可能有一种方法可以在 chrome 中启用 webgl，就像在 safari 中启用它一样。

我在 Mac OS X 10.8.2 上，使用 Macbook pro Retina (NVIDIA GeForce GT 650M)，Chrome 版本 24.0.1312.57。我的视频卡不在黑名单上（但也不在任何白名单上）www.khronos.org/webgl/wiki/BlacklistsAndWhitelists

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2015-04-17T23:06:10.757

在 Chrome 设置中启用“可用时使用硬件加速”。

我在 2012 年中期的 Macbook Air 上遇到了同样的问题。这是我修复它的方法。

*   转到铬：//设置/
*   “显示高级设置”（底部链接）
*   系统（底部倒数第二个）
*   启用“在可用时使用硬件加速”复选框。
*   重新启动 Chrome（我需要）

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-07-18T01:50:48.683

今天在装有 OSX 1.7.5 的 MB 上遇到同样的问题。我想 Webgl 不被支持的原因有很多。更新您的操作系统/浏览器并不意味着您的系统（即您的显卡）确实支持 webgl。尝试`chrome://gpu/`在 Chrome 中打开并阅读检测到的问题。

更多关于这个[here](https://support.google.com/chrome/answer/1220892?hl=en)。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2016-11-04T18:21:17.290

时间过去了，Chrome 到了 54 版，所以我想我可以添加一个更新（并将一些答案分组在这里）：

1.  首先，确保在高级设置中启用了硬件加速（如[Paul](https://stackoverflow.com/a/29710846/4375377)所述）。
2.  检查`chrome://gpu`以了解问题可能是什么。在**Problems detected**下，您会获得一些可以为您指明正确方向的信息。
3.  如果您再也找不到`#Disable-WebGL`旗帜，请不要惊慌，因为他们已经摆脱了它。
4.  如果你发现类似

    > GPU 进程无法启动：所有 GPU 功能都被列入黑名单。
    > 禁用功能：全部

    在**检测到的问题**下，并且您确定它曾经在早期版本的 chrome 中工作，您可能会考虑非常谨慎地启用`#ignore-gpu-blacklist`下！`chrome://flags`

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2014-10-14T15:58:00.250

也许只是启用“覆盖软件渲染列表”（#ignore-gpu-blacklist）：

[https://apple.stackexchange.com/questions/150212/hardware-acceleration-for-flash-videos-in-google-chrome](https://apple.stackexchange.com/questions/150212/hardware-acceleration-for-flash-videos-in-google-chrome)

它在 OS X 10.9.5、Chrome v38.0.2125.101 上为我修复了这个错误

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-03-01T15:48:32.277

Chrome 绝对支持 OSX 上的 WebGL，我可以确认您的 Mac 应该可以正常工作。（我用一个在 Chrome 中开发 WebGL！）

听起来好像您可能不小心以某种方式禁用了它？检查 chrome://flags 并查看是否已设置“禁用 WebGL”标志。此外，查看 chrome://gpu 并查看它是否显示任何指示 WebGL 可能被禁用的消息。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2015-12-04T20:44:53.500

“也许只需启用“覆盖软件渲染列表”（#ignore-gpu-blacklist）”

这在带有 OS X 10.7.5（2007 Mac Pro）的 Chrome 版本 47.0.2526.73（64 位）中对我有用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-10-15T19:00:54.127

如果当前未启用 WebGL，您可以前往浏览器中的 Chrome 标志设置：chrome://flags/

将覆盖软件渲染列表更新为启用。这应该在列表顶部附近

# c - 释放内存时出现奇怪的 C 错误？

> ID：15141976
> 
> 赞同：0
> 
> 时间：2013-02-28T17:34:16.000
> 
> 标签：c, free, pointer-to-pointer

我仍在尝试让我的遗传算法工作（昨天我遇到了内存分配问题，因此在尝试释放它时出现了一个可怕的错误）但今天我有这段代码

```
while (iCurrentGen <= data->m_iMaxGenerations)
{
    arrfSelectedChromosomes = selection(&data[0], szChromosomes);
    iSelectedLen = order_descending_grid(arrfSelectedChromosomes);
    szAuxGen = crossover(&data[0], arrfSelectedChromosomes, szChromosomes, iSelectedLen);
    //szChromosomes is what I need to free after that call returns
    free_generation(&data[0], szChromosomes);//Code Explotion
    szChromosomes = szAuxGen;
    szAuxGen = NULL;
    ++iCurrentGen;
} 
```

`free_generation()`我在函数调用之前检查了它的内容，如下图所示：

（变量前四个值）

![变量前四个值](../Images/d660bf3171324b710b087987b9f96810.png)

但是在`free_generation()`函数内部，同一个变量会丢失一些值（特别是当`i`取值为 2 时，`i`即 for 循环索引），如下所示：

（函数内部的变量值）

![函数内部的变量值](../Images/17486a46b8d29bb54b839444dcfe87e5.png)

我在下面发布了 free_generation 代码：

```
void free_generation(struct INPUT_DATA* d, char** szChromosomes)
{
    int i;

    for (i = 0; i < d->m_iPopulationSize; ++i)
    {
        free(szChromosomes[i]);
    }

    free(szChromosomes);
    szChromosomes = NULL;
} 
```

的定义`szChromosomes`如下：

```
char** szChromosomes = (char**)malloc(d->m_iPopulationSize * sizeof(char*));

srand(time(NULL));
for (i = 0; i < d->m_iPopulationSize; ++i)
{
    szChromosomes[i] = (char*)malloc((d->m_iBitsPChromosome + 1) * sizeof(char));
    for (j = 0; j < d->m_iBitsPChromosome; ++j)
    {
        szChromosomes[i][j] = rand_1_0(0.0, 1.0) == 1? '1' : '0';
    }
    szChromosomes[i][j] = '\0';
} 
```

我需要澄清的是，这个值的丢失仅发生在顶部发布的 while 循环的第二次迭代之后。我的意思是在第一次运行时一切正常，但在这次迭代之后，第二次运行的行为如上所述。

编辑：

我忘了包括循环控制变量的增量（感谢指出！不，它不是全局 xD）。我包括部分交叉代码：

```
 char** crossover(struct INPUT_DATA* d, float** arrfSelectedChromosomes, char** arrszChromosomes, int iChromosomesInGrid)
{
    int i;
    int iTIndex = 0, iRPos = 0;
    char* szFirstChromosome = NULL;
    char* szSecondChromosome = NULL;
    char* szFirstNewChrom = (char*)malloc((d->m_iBitsPChromosome + 1) * sizeof(char));
    char* szSecondNewChrom = (char*)malloc((d->m_iBitsPChromosome + 1) * sizeof(char));

    char** arrszNewPop = (char**)malloc(d->m_iPopulationSize * sizeof(char*));

    int iSplitPoint = (int)(d->m_iBitsPChromosome / 4);

    float fCrossOverProb = CROSSOVER_PROBABILITY; 

    srand(time(NULL));
    for (i = 0; i < d->m_iPopulationSize; i += 2)
    {
        iRPos = rand() % iChromosomesInGrid;
        iTIndex = (int)arrfSelectedChromosomes[iRPos][0];
        szFirstChromosome = arrszChromosomes[iTIndex];
        iRPos =  rand() % iChromosomesInGrid;
        iTIndex = (int)arrfSelectedChromosomes[iRPos][0];
        szSecondChromosome = arrszChromosomes[iTIndex];

        if (is_same_chromosome(szFirstChromosome, szSecondChromosome))
        {
            i -= 2;
            continue;
        }

        if (fCrossOverProb < CROSSOVER_PROBABILITY)
        {
            //if probability is lower than the defined prob. we keep both chromosomes
            strcpy(szFirstNewChrom, szFirstChromosome);
            strcpy(szSecondNewChrom, szSecondChromosome);
        }
        else
        {

            strcpy(szFirstNewChrom, szFirstChromosome);
            szFirstNewChrom[iSplitPoint] = '\0';
            strcat(szFirstNewChrom, &szSecondChromosome[iSplitPoint]);

            //Para crear el segundo hijo se realiza una operacion similar
            strcpy(szSecondNewChrom, szSecondChromosome);
            szSecondNewChrom[iSplitPoint] = '\0';
            strcat(szSecondNewChrom, &szFirstChromosome[iSplitPoint]);
        }

        arrszNewPop[i] = szFirstNewChrom;
        arrszNewPop[i + 1] = szSecondNewChrom;
    }

    return arrszNewPop;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-06-03T11:40:08.790

*[由于将评论标记为答案的](https://meta.stackexchange.com/questions/82099/answering-comment-answered-questions)功能请求仍然被拒绝，因此我在此处复制上述解决方案。*

纳米你是男人！非常感谢.. 这是重复指针的问题，这是由于交叉函数中的内存分配错误。我在函数开始时为 szFirstNewChrom 和 szSecondNewChrom 分配内存，但该内存用于 30 个不同的字符串。由于那个可怕的错误，free_generation 函数一直失败，因为它试图释放先前释放的指针。谢谢你们！——豪尔赫·塞斯佩德斯

# vim - 在vim中切换一个空白屏幕，以通过透明窗口查看

> ID：15141979
> 
> 赞同：2
> 
> 时间：2013-02-28T17:34:22.850
> 
> 标签：vim, command-line

我在 Vim 中工作（不是 GVim 或 MacVim 等），我使用了一个非透明终端，所以我可以看到它背后的背景（这是[这个运动备忘单](http://naleid.com/blog/2010/10/04/vim-movement-shortcuts-wallpaper/)）

我想要一种方法，让 vim 的实例成为一个空白屏幕，然后能够像以前一样重新绘制它。也许我只是在我的网络搜索中失败了，但我找不到任何关于这个问题的东西。

我对任何事情都非常感激，即使只是指向一些可以让我从兔子洞开始的文档方法的链接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T17:40:45.820

如果您编辑一个新缓冲区（在一个不存在的文件中），您将看到一个空白屏幕

```
:ed foo 
```

完成后，您可以将其删除

```
:bd 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-28T18:28:48.960

我通过点点滴滴、一个相关问题以及@Ken 和@Prince Goulash 的帮助实现了我想要的效果。这是我的 .vimrc 中的 vimscript 的功能部分：

```
function! TabIsEmpty()
    " From Stackoverflow: http://stackoverflow.com/a/5026456/212307
    " Remember which window we're in at the moment
    let initial_win_num = winnr()

    let win_count = 0
    " Add the length of the file name on to count:
    " this will be 0 if there is no file name
    windo let win_count += len(expand('%'))

    " Go back to the initial window
    exe initial_win_num . "wincmd w"

    " Check count
    if win_count == 0
        " Tab page is empty
        return 1
    else
        return 0
    endif

endfunction
function! ToggleBlankTab()
    if TabIsEmpty() == 1
        tabc
    else
        tabe
    endif
endfunction
nnoremap <leader>m :call ToggleBlankTab()<cr> 
```

# csv - D3.js 中的多个基于数据的转换

> ID：15141980
> 
> 赞同：0
> 
> 时间：2013-02-28T17:34:26.953
> 
> 标签：csv, d3.js, transitions

假设我在 age.csv 中有这些数据。六列包含三个不同年份的人的姓名和年龄。

```
"name","1990","1992","1993","1994","1995"
"Rob",0,1,2,3,4,5
"Angie",15,16,17,18,19
"Chris",41,42,43,44,45 
```

假设我想用一个圆圈代表每个人。

```
var svg = d3.select("body").append("svg")
            .attr("width", 1000)
            .attr("height", 1000);

d3.csv("age.csv", function (data) {
       var people = svg.selectAll("circle")
                       .data(data)
                       .enter()
                       .append("circle")
                           .attr("cx", function(d) {return d[1990] * 10;})
                           .attr("cy", function(d, i) {return i*40; })
                           .attr("r", 20)
                           .attr("fill", "red");
}); 
```

此外，我希望圆圈沿着 x 轴移动，从每个人 1990 年的年龄到 1995 年的年龄。要创建从一年到另一年的动画，我只需使用`transition().attr("x", function (d) {return d[1991] * 10;})`.

但是，如果我想重复这个过程来过渡到每年的数据呢？我尝试了使用`.each("end", changeYear())`with`changeYear()`作为递归函数的不同方法，但是在每个元素的 x 位置折叠并默认为 0 之前，我只能进行一到两次转换。

我完全糊涂了，真的可以找人指点我正确的方向。

**编辑：** 很抱歉让这篇文章很长，但这是我错误的`changeYear()`递归函数。使用它，我还添加了上面变量`.each(changeYear());`的最后一行。`people`

```
var x = 0;
var years = [1990,1991,1992,1993,1994,1995);

function changeYear() { 
        return function() {
            x++;
            d3.select(this)
            .transition()
            .duration(1000)
            .attr("x", function (d) {return d[years[x]] * 10;})
            .each("end",change());
        }
    } 
```

# ios - iOS 模拟器 (Xcode 4.2)

> ID：15141986
> 
> 赞同：0
> 
> 时间：2013-02-28T17:34:48.880
> 
> 标签：ios, ios-simulator

我有一些对方向变化作出反应的代码，经过大量调试和挫折后，我意识到虽然在硬件上测试我的代码工作正常，但在模拟器中测试时，虽然模拟器是面向横向的，但代码读取它的当前方向作为肖像。这有什么原因吗？令人沮丧。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T17:40:03.017

在模拟器上，您可以在 2 轴上进行更改。在 3 轴设备上。

使用真机调试时会遇到一些有趣的案例，强烈推荐。你可以得到一个大约 100-200 美元（二手）。

# java - 在 Rally 中，无法将测试结果添加到某些测试用例

> ID：15141989
> 
> 赞同：0
> 
> 时间：2013-02-28T17:34:53.630
> 
> 标签：java, rally, testcase

最近，当我尝试将结果添加到一些测试用例（来自拉力赛网页）时，我看到以下错误。

“无法保存测试用例结果 2013-02-28 Pass。请更正下面发现的错误，然后单击“保存”按钮之一。”

我已经在这些测试用例中添加了一些结果，但现在我不能再添加任何结果了。我不认为我做错了什么，因为如果我对其他测试用例尝试相同的过程，我可以毫无问题地向它们添加结果。

此外，如果我使用 java 应用程序将结果添加到这些测试用例，应用程序会引发 Nullpointer 异常。

任何人对此有任何想法...？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T18:40:54.830

听起来有些不太对劲。请向 Rally 支持 (rallysupport@rallydev.com) 提交案例 - 我们可以与 Rally 的开发和运营团队一起调查，以帮助找出问题所在。

# ruby - 为什么像 $& 这样的 Ruby 全局字符串会无误地忽略突变？

> ID：15141990
> 
> 赞同：6
> 
> 时间：2013-02-28T17:34:57.477
> 
> 标签：ruby, pseudo-globals

我正在学习 Ruby (2.0)，这让我很惊讶：

```
s = "1234"
s =~ /\d+/
$&  ==> "1234"       # as expected, $& contains the matched string
$&.slice!(-2..-1)    # should mutate string
$&  ==> "1234"       # what?
s.slice(-2..-1) 
s  ==> "12"          # as expected 
```

该`slice!`方法应该改变字符串。其他 mutator 方法的行为方式相同。我的问题：为什么这不会引发错误，这是我所期望的，当一个函数不能做它说它会做的事情时？这是在某处记录的吗？有道理吗？

**更新**

所以，我看到它`$&`不像一个全局变量。对它的每个引用都会给出一个新对象，就好像它真的是一个无参数函数一样：

```
irb> $foo = "1234"
=> "1234"
irb> $foo.object_id
=> 70205012205980
irb> $foo.object_id
=> 70205012205980   # the same
irb> $&.object_id
=> 70205003531300
irb> $&.object_id   
=> 70205011619040   # different object 
```

所以......我的问题变成了：这只是解释器的“魔法”，还是`$&`实际上是一个无参数函数，就像我可以在 Ruby 中使用`def ... end`? 而且，我怎么能分辨出来呢？`foo`在 Python 中，我可以通过使用它的名称来引用一个函数：

```
>>> foo
<function foo at 0x10d3117d0> 
```

有没有办法在 Ruby 中做到这一点？然后我可以看看 $& “真的”是什么（如果它不是魔法的话）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-28T21:08:18.007

Ruby C API 包括*挂钩*变量和*虚拟*变量。从[README.EXT](https://github.com/ruby/ruby/blob/v2_0_0_0/README.EXT#L532-557)：

> 您可以定义挂钩变量。在访问挂钩变量时调用访问器函数（getter 和 setter）。
> 
> ```
> void rb_define_hooked_variable(const char *name, VALUE *var,
>            VALUE (*getter)(), void (*setter)()) 
> ```
> 
> 如果您需要提供 setter 或 getter，只需为不需要的钩子提供 0。如果两个钩子都是 0，rb_define_hooked_variable() 就像 rb_define_variable() 一样工作。
> 
> getter 和 setter 函数的原型如下：
> 
> ```
> VALUE (*getter)(ID id, VALUE *var);
> void (*setter)(VALUE val, ID id, VALUE *var); 
> ```
> 
> 您也可以定义一个没有相应 C 变量的 Ruby 全局变量。变量的值只能通过钩子来设置/获取。
> 
> ```
>  void rb_define_virtual_variable(const char *name,
>             VALUE (*getter)(), void (*setter)()) 
> ```
> 
> getter 和 setter 函数的原型如下：
> 
> ```
> VALUE (*getter)(ID id);
> void (*setter)(VALUE val, ID id); 
> ```

`$&`是一个虚变量的例子，它定义在 中[`re.c`](https://github.com/ruby/ruby/blob/v2_0_0_0/re.c#L3532)，对应的 getter 是[`last_match_getter`](https://github.com/ruby/ruby/blob/v2_0_0_0/re.c#L1562-1566)并且没有 assocoat setter。

在某种意义上，一个无参数函数也是如此`$&`，只是它是在 C 中实现的。你不能（据我所知）在纯 Ruby 中定义你自己的虚拟全局变量（如果你创建你的自己的 C 扩展）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-28T17:43:59.453

由于 的目的`$&`是告诉您匹配了什么，因此匹配应该是唯一可以更新它的操作是有意义的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-28T18:49:11.633

这是个有趣的问题。jeconner 的回答和对该问题的许多评论只是说这样做没有用，但这并没有回答问题。无论是否应该在实际代码中完成，OP 的问题仍然存在。

问题的答案是，这看起来像是只读字符串的功能。当您对只读字符串应用破坏性操作时，它会返回一个不同的字符串对象。我同意 OP 这很奇怪。它应该引发错误。

除非有人提出令人信服的解释，否则我建议您在 Ruby 核心上询问它，和/或请求一个功能来引发错误。

# typo3 - 以编程方式持久化模型时更改存储 pid

> ID：15141992
> 
> 赞同：0
> 
> 时间：2013-02-28T17:35:04.563
> 
> 标签：typo3, extbase

我对 Extbase 很陌生，我正在尝试以编程方式持久化一个新模型。以下代码有效：

```
$testModel = $this->objectManager->create('Tx_MyExtension_Domain_Model_Test');
$testModel->setName('testing');
$this->TestRepository->add($testModel);
$this->persistenceManager->persistAll(); 
```

但是，我想更改它所在的存储文件夹（因此；更改记录在数据库中的 pid 字段）。我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T09:58:20.140

您可以在扩展的打字稿设置中为特定模型的新条目设置默认存储 pid：

```
plugin.tx_your_extension {
    persistence {
        classes {
            Tx_YourExtension_Domain_Model_YourModel.newRecordStoragePid = 74
        }
    }
} 
```

现在所有新模型都保存在这个位置。