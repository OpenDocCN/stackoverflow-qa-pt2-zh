# StackOverflow 问答 14356000-14356999

# class - 如何通过反射在 None 上获取 Option[_] 的类

> ID：14356001
> 
> 赞同：0
> 
> 时间：2013-01-16T10:16:50.120
> 
> 标签：class, scala, reflection, option

我有这个设置，我想从 XML NodeSeq 填充对象字段。显示了我的设置的缩减版本。它运作良好，但是当我输入`None`时`testObj`，我得到一个`java.util.NoSuchElementException: None.get`.

我相信的问题是我无法找到一种方法来获取`Option[_]`当它是时的类`None`。我已经被困在这个问题上很久了，我看不到出路。我觉得当原始值为 时，必须有一种方法来分支和填充对象字段`None`，但是如何？

```
import xml.NodeSeq
object test {
  case class TestObject(name: Option[String] = None, value: Option[Double] = None)
  def main(args: Array[String]): Unit = {
  val testObj = TestObject(Some("xxx"), Some(12.0))
//    val testObj = TestObject(None, Some(12.0))
    val nodeSeq = <test> <name> yyy </name> <value> 34.0 </value> </test>
    val result = getObject[TestObject](nodeSeq, Option(testObj))
    println("result = " + result) // result = Some(TestObject(Some(yyy),Some(34.0)))
  }
  def getObject[A](nodeSeq: NodeSeq, obj: Option[A]): Option[A] = {
    if ((nodeSeq.isEmpty) || (!obj.isDefined)) None else {
      for (field <- obj.get.getClass.getDeclaredFields) {
    field.setAccessible(true)
    val fieldValue = field.get(obj.get)
    if (fieldValue == null || !fieldValue.isInstanceOf[Option[_]]) None
    var newValue: Option[_] = None
    fieldValue.asInstanceOf[Option[_]].get match {    // <---- None.get is the error here
      case x: Double => newValue = Some((nodeSeq \ field.getName).text.trim.toDouble)
      case x: String => newValue = Some((nodeSeq \ field.getName).text.trim)
    }
    val decField = obj.get.getClass.getDeclaredField(field.getName)
    decField.setAccessible(true)
    decField.set(obj.get, newValue)
   }
    obj
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T15:53:11.207

我忽略了此代码中我不喜欢的其他一些部分，但是，您不能调用`.get`None。你可以调用 map ，它会返回我认为你想要的。这是修改后的代码：

```
 def getObject[A](nodeSeq: NodeSeq, obj: Option[A]): Option[A] = {
    if (nodeSeq.isEmpty || obj.isEmpty) {
      None
    }
    else {
      for (field <- obj.get.getClass.getDeclaredFields) {
        field.setAccessible(true)
        val fieldValue = field.get(obj.get)
        if (fieldValue == null || !fieldValue.isInstanceOf[Option[_]]) None

        val newValue = fieldValue.asInstanceOf[Option[_]].map(a => {
          a match {
            case x: Double => Some((nodeSeq \ field.getName).text.trim.toDouble)
            case x: String => Some((nodeSeq \ field.getName).text.trim)
          }
        })

        val decField = obj.get.getClass.getDeclaredField(field.getName)
        decField.setAccessible(true)
        decField.set(obj.get, newValue)
      }
      obj
    }
  } 
```

在实践中，我通常避免调用`.get`选项，因为它经常导致错误。

**更新：**

这个版本更实用一些，尽管它仍然会改变您发送的 obj：

```
 def getObject[A](nodeSeq: NodeSeq, obj: Option[A]): Option[A] = {
    obj.map(o => {
      for {
        field <- o.getClass.getDeclaredFields
        _ = field.setAccessible(true)
        fieldValue <- Option(field.get(o))
      } yield {
        val newValue = fieldValue match {
          case Some(a) => {
            a match {
              case x: Double => Some((nodeSeq \ field.getName).text.trim.toDouble)
              case x: String => Some((nodeSeq \ field.getName).text.trim)
            }
          }
          case _ => None
        }
        val decField = o.getClass.getDeclaredField(field.getName)
        decField.setAccessible(true)
        decField.set(o, newValue)
      }
      o
    })
  } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T03:10:02.973

实际上，这可能更接近您想要的：改为检查字段的类型。

```
import xml.NodeSeq
object test {
  case class TestObject(name: Option[String] = None, value: Option[Double] = None)
  def main(args: Array[String]): Unit = {
  val testObj = TestObject(Some("xxx"), Some(12.0))
//    val testObj = TestObject(None, Some(12.0))
    val nodeSeq = <test> <name> yyy </name> <value> 34.0 </value> </test>
    val result = getObject[TestObject](nodeSeq, Option(testObj))
    println("result = " + result) // result = Some(TestObject(Some(yyy),Some(34.0)))
  }
  def getObject[A](nodeSeq: NodeSeq, obj: Option[A]): Option[A] = {
    if ((nodeSeq.isEmpty) || (!obj.isDefined)) None else {
      for (field <- obj.get.getClass.getDeclaredFields) {
    field.setAccessible(true)
    val newValue = field.getGenericType match {
      case t: ParametrizedType if (t.getActualType == classOf[Option[_]]) => 
        val paramType = t.getActualTypeArguments()(0)
        if (paramType == classOf[java.lang.Double]) // since Double can't be a generic type parameter on JVM
          // from your original code, but it probably needs to be modified
          // to handle cases where field isn't in nodeSeq or not a number
          Some((nodeSeq \ field.getName).text.trim.toDouble) 
        else if (paramType == classOf[String])
          Some((nodeSeq \ field.getName).text.trim)
        else None
      case _ => None
    }
    if (newValue.isDefined)
      field.set(obj.get, newValue)
   }
    obj
    }
  }
} 
```

版本创建一个新对象（可能需要根据您的要求进行修改）：

```
 def getObject[A](nodeSeq: NodeSeq, objClass: Class[A]): Option[A] = {
    if (nodeSeq.isEmpty) None else {
      try {
        val fieldValues = objClass.getDeclaredFields.flatMap { field =>
          field.setAccessible(true)
          field.getGenericType match {
            case t: ParametrizedType if (t.getActualType == classOf[Option[_]]) => 
              val paramType = t.getActualTypeArguments()(0)
              if (paramType == classOf[java.lang.Double])
                Some(Some((nodeSeq \ field.getName).text.trim.toDouble))
              else if (paramType == classOf[String])
                Some(Some((nodeSeq \ field.getName).text.trim))
              else None
            case _ => None
          }
        }
        // assumes only one constructor, otherwise get the desired one
        val ctor = objClass.getConstructors()(0)
        Some(ctor.newInstance(fieldValues))
      } catch {
        case _ => None
      }
    }
  } 
```

# mysql - 如何使用一个条件查询对多列求和？

> ID：14356012
> 
> 赞同：1
> 
> 时间：2013-01-16T10:17:10.120
> 
> 标签：mysql, grails, criteria

例如，假设一个表“值”包含 4 列 A、B、C 和 D。现在，我想添加 B、C、D，其中 A = 10。

对于单列，它是这样的：

```
def c=values.createCriteria{
eq("A",10)
projections{
sum("B")
}
} 
```

如何在 A=10 的地方添加 B、C 和 D？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-03-05T04:53:47.147

尝试这样的事情

```
def c=values.createCriteria().get{
eq("A",10)
 projections{
  sum("B","b")
  sum("C","c")
  sum("D","d")
 }
 resultTransformer(AliasToEntityMapResultTransformer.INSTANCE)
} 
```

然后你可以构建一个地图或列表 [sumB:cb,sumbC:cc,sumD:cd] 类似的东西或

```
def bcd=c.b+c.c+c.d 
```

得到你的最终价值，对不起，如果这甚至不接近你想要的，但这就是我从你的解释中得到的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T10:31:31.197

你可以这样做：
`SELECT B,C,D,(B+C+D) AS sum FROM values WHERE A=10;`或
`SELECT (B+C+D) AS sum FROM values WHERE A=10;`

认为它会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-03-05T19:19:33.977

你可以简单地在控制器中这样写：

`def sumList = Values.executeQuery("SELECT (B+C+D) AS sum FROM Values WHERE A=10") println(sumList)`

参考链接： http: [//grails.asia/grails-hql-count-examples](http://grails.asia/grails-hql-count-examples)

# java - java.lang.NoSuchMethodError: org.hibernate.SessionFactory.getCurrentSession()Lorg/hibernate/classic/Session；

> ID：14356013
> 
> 赞同：2
> 
> 时间：2013-01-16T10:17:13.757
> 
> 标签：java, hibernate

这是我的配置。

它说没有找到这样的方法，但在 Java 文档和我的 Util 文件中都存在。我在某处读到它与休眠 3 和 4 交叉配置。无法得到这个......</p>

```
 <!DOCTYPE hibernate-configuration SYSTEM
        "http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd">
        <hibernate-configuration>
            <session-factory>   

                <property name="connection.driver_class">com.mysql.jdbc.Driver</property>
                <property name="connection.url">jdbc:mysql://localhost/datacenter</property>
                <property name="connection.username">root</property>
                <property name="connection.password">admin</property>  

                <property name="dialect">org.hibernate.dialect.MySQLDialect</property>      
                <property name="current_session_context_class">thread</property>
                <property name="show_MySql">TRUE</property>
                <property name="format_sql">TRUE</property>
                <property name="jboss.as.jpa.providerModule">hibernate3-bundled</property>

                <property name="hibernate.hbm2ddl.auto">update</property>
                <property name="hibernate.cache.use_second_level_cache">true</property>
               <property name="hibernate.query.factory_class">org.hibernate.hql.classic.ClassicQueryTranslatorFactory</property> 

                <!-- List of annotated classes-->
                <!-- Associations -->
                <!-- One to one -->
                <mapping class="Emp_Timecard" />
                <mapping class="maindoor" />
                <mapping class="serverroom" />
                <mapping class="timesheet" />
                <mapping class="hibernatepojos.Resource_list"/>

            </session-factory>
        </hibernate-configuration> 
```

这是我的 Util 文件：

```
package hibernatedata;

import org.hibernate.Session;
import org.hibernate.SessionFactory;
import org.hibernate.cfg.AnnotationConfiguration;

public class HibernateUtil {

    private static SessionFactory sessionFactory;
    private static AnnotationConfiguration config1;

    static {
        config1 = (AnnotationConfiguration) new AnnotationConfiguration()
                .configure("hibernate.cfg.xml");

    }

    public static SessionFactory getSessionFactory() {
        if (sessionFactory == null) {

            createSessionfactory();
        } 
        return sessionFactory;

    }

    private static void createSessionfactory() {
        sessionFactory = config1.buildSessionFactory();

    }

    public static Session openSession() {

        return getSessionFactory().getCurrentSession();
    }

    public static void closeSessionFactory() {

        // getSessionFactory().close();
    }

    public static void save(Object o) {
        Session s = openSession();
        System.out.println("kejrkvg");
        s.beginTransaction();
        s.save(o);
        s.getTransaction().commit();
        // s.close();
        // s.clear();
        if (s.isOpen()) {

            s.close();
        }
        closeSessionFactory();
    }

    public static void delete(Object o) {
        Session s = openSession();
        s.beginTransaction();
        s.delete(o);
        s.getTransaction().commit();
        // s.close();
    }

    public static <T> T load(Class<T> clazz, int id) {
        Session s = openSession();
        s.beginTransaction();
        T t = clazz.cast(s.load(clazz, id));
        // s.getTransaction().commit();

        return t;

    }

    public static void update1(Object o) {
        Session s = openSession();
        s.beginTransaction();
        s.update(o);
        s.getTransaction().commit();
        // s.close();
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T13:18:09.813

> 它说没有找到这样的方法，但在 Java 文档中确实存在

错误是在运行时生成的，而不是在编译代码时生成的。所以 t 看起来你的一些代码是针对一个版本的代码编译的，但是会被另一个不同的并且可能是旧版本执行。完整的堆栈跟踪将包含有关不兼容性所在位置的更多信息。

如果有疑问，您可以使用`javap`来查看从给定系统上的给定类路径加载的类是否实际上包含该方法。如果您希望使用的类路径不提供该方法，您可能需要将正确版本的库安装到该路径中。另一方面，如果它在那里看起来也正确，那么这很好地表明加载了与您期望的不同的类。然后，您可以添加调试代码来确定用于加载该类的类加载器，以查看它的实际来源。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-11T17:29:33.523

[问题java.lang.NoSuchMethodError: org.hibernate.SessionFactory.openSession()Lorg/hibernate/classic/Session](https://stackoverflow.com/questions/8799121/java-lang-nosuchmethoderror-org-hibernate-sessionfactory-opensessionlorg-hibe)的公认答案也可能提供一些见解 - “在 Hibernate 3.6 中，SessionFactory.openSession 不再返回 org.hibernate.classic .Session，而不是它返回一个 org.hibernate.Session。这是一个破坏客户端代码的重构..”

# extjs - 包装时指南针错误

> ID：14356015
> 
> 赞同：-1
> 
> 时间：2013-01-16T10:17:16.877
> 
> 标签：extjs

我生成了一个包如下： sencha generate app GS e:\bhushan\GS7

之后，我尝试使用“sencha app build package native”命令打包项目。

我收到如下消息： [INF] [shellscript] E:\bhushan\GS7\resources\sass>compass compile --bo ring --force [INF] [shellscript] '''compass''' is not known as内部或外部命令

我需要安装指南针吗？如果是，我在哪里可以找到在 Windows XP 上安装的安装程序及其安装步骤。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T18:07:57.670

要安装指南针，请查看他们的网站：- [http://compass-style.org/install/](http://compass-style.org/install/)

# java - Alfresco REST api 'groups/children?level="ALL"'，是否存在类似的东西？

> ID：14356017
> 
> 赞同：0
> 
> 时间：2013-01-16T10:17:20.543
> 
> 标签：java, rest, alfresco

如 alfresco wiki [here](http://wiki.alfresco.com/wiki/3.2_REST_API_Group_Service)`level`中所述，使用 REST api 调用 alfresco 的 webscripts，我可以使用带有 value的 GET 参数调用所有组、它们的显式子级、父级，甚至隐式父级`"ALL"`。碰巧我需要隐含的孩子而不是父母，但找不到类似的方法。它或使用相同技术的替代方案是否存在？如果不是，为什么不呢？

我的这个项目的开发环境是 GWT/GXT 结合使用 OpenCMIS 和 alfresco REST api 访问的 Alfresco 共享。

**结论：**

存在：

```
/services/api/groups/<groupname>/parents?level="ALL" 
```

我需要：

```
/services/api/groups/<groupname>/children?level="ALL" 
```

或类似的功能。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T17:07:31.393

我不相信有一个 REST API 可以返回一个授权的所有用户，包括间接成员，只有直接成员调用。

但是，[底层 Java 服务确实支持这一点](http://dev.alfresco.com/resource/docs/java/repository/org/alfresco/service/cmr/security/AuthorityService.html#getContainedAuthorities%28org.alfresco.service.cmr.security.AuthorityType,%20java.lang.String,%20boolean%29)- 只需将该`immediate`标志设置为 false。如果你真的需要这个，它会很快敲出一个新的 webscript 来公开它。（它需要是一个 Java 支持的 webscript，因为它看起来不像 ScriptGroup 或 ScriptAuthorityService 公开它）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T15:30:11.863

`/api/groups/<groupname>/children`

这将为您提供该组的直系子级。我不相信有一个 REST API 可以递归地检索一个组的所有孩子——你需要打几个电话。

# objective-c - ObjectiveC - 构造函数，内存管理

> ID：14356021
> 
> 赞同：1
> 
> 时间：2013-01-16T10:17:23.943
> 
> 标签：objective-c, memory

我是 ObectiveC 的初学者，所以请保持可能的答案简单。我在 C 和 C++ 方面有几年的经验。

现在，使用 ObjectiveC 我想创建两个对象，而不是使用属性。我的问题是“这里出了什么问题”而不是“如何以不同的方式做”。所以有我的代码：

```
@implementation News

NSString *_title;
NSString *_excerpt;
NSString *_content;
NSString *_thumbnailURL;
NSString *_date;

-(id)initWithTitle:(NSString *)title excerpt:(NSString *)excerpt content:(NSString*)content thumbnail:(NSString *)thumbnailURL date:(NSString *)date {
    self = [super init];
    if (self) {
        _title = [[NSString alloc] initWithString:title];
        _excerpt = [[NSString alloc] initWithString:excerpt];
        _content = [[NSString alloc] initWithString:content];
        _thumbnailURL = [[NSString alloc] initWithString:thumbnailURL];
        _date = [[NSString alloc] initWithString:date];
    }
    return self;
}

-(void)showData {
    NSLog(@"    title:%@", _title);
    NSLog(@"    excerpt:%@", _excerpt);
    NSLog(@"    thumbnailURL:%@", _thumbnailURL);
    NSLog(@"    date:%@",  _date);
    NSLog(@"    getContent:%@", _content);
}
@end 
```

现在我想创建两个对象：

```
News *nws = [[News alloc] initWithTitle:@"title1" excerpt:@"excerpt1" content:@"content1" thumbnail:@"thumbnail1" date:@"date1"];
News *nws2 = [[News alloc] initWithTitle:@"title3" excerpt:@"excerpt3" content:@"content3" thumbnail:@"thumbnail3" date:@"date3"]; 
```

之后想显示这个对象里面有什么：

```
[nws showData];
[nws2 showData]; 
```

结果是两个对象内部具有相同的值。全部以“3”结尾。我认为 nws 对象将包含以“1”结尾的值，而 nws2 将包含以“3”结尾的值。但它不是那样工作的。为什么？哪里有错误？请帮忙，谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T10:45:11.247

您的变量被定义为`global variables`（而不是实例变量），这就是为什么它们具有从您的实例中引用的相同值的原因。

在您的情况下，将它们嵌入 {} 是一种可能的解决方案。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T14:02:16.797

我在推特上提问并从@Bavarious 得到以下评论：

[https://gist.github.com/11c22c0edea5391a3799](https://gist.github.com/11c22c0edea5391a3799)（加粗）

> **任何在`@interface … {}`或之外声明的变量`@implementation … {}`都被视为常规 C 变量**。在您的示例中，`_excerpt` 是一个具有静态存储持续时间的全局（文件范围）变量，并且可以等效地放置在文件的顶部 before `@interface`或 between `@interface`and`@implementation`或在两个方法的实现之间 - 它与文件范围变量的机制相同C 在功能块之外定义。
> 
> 具有静态存储时长的变量可以用来实现类变量，这是Objective-C中不存在的概念。

# html - 限制恶意 html 但允许 < 或 > 符号

> ID：14356022
> 
> 赞同：2
> 
> 时间：2013-01-16T10:17:27.323
> 
> 标签：html, asp.net-mvc

我想限制用户输入的恶意html，但应该允许用户使用大于（>）或小于（<）符号。

只禁止以下两个字符串是否安全？

```
"/>" and "</" 
```

可以在没有结束标签的情况下执行任何恶意 html 吗？

更多信息：这是 ASP.Net MVC，用户在文本框中输入一些文本，文本存储在数据库中，然后显示在页面上。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T10:21:10.473

这种情况也可以通过转义用户在用户界面上显示时输入的输入来处理。这将导致所有用户输入在 ui 上显示为文本。在这种情况下，标签不会在浏览器上呈现以供用户输入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T10:25:06.703

必须在不删除任何数据的情况下处理每个用户输入。如果您知道伤害，则应在向用户展示时使用转义。

有很多技术可以绕过愚蠢的查找/替换过滤器。阅读有关 xss 漏洞和 sql 注入的信息。

# ruby - 在 Ruby 中创建 Regexp 时 %r(..) 与 /../ 有何不同？

> ID：14356026
> 
> 赞同：0
> 
> 时间：2013-01-16T10:17:39.153
> 
> 标签：ruby, regex, ruby-1.9.3

我正在使用 Ruby1.9.3。我是这个平台的新手。

从我了解到的文档中，我们可以`Regexp`使用以下内容：

*   `%r{pattern}`
*   `/pattern/`

现在，在模式匹配符号、区域细节（）等方面`styles`，上述两者之间有什么区别吗？`fast``***can use/can't use restrictions***`

*我找到了一个如下：*

```
irb(main):006:0> s= '2/3'
=> "2/3"
irb(main):008:0> /2\/3/ =~ s
=> 0
irb(main):009:0> %r(2/3) =~ s
=> 0
irb(main):010:0> exit 
```

`%r(..)`在这里，我发现和之间的一个区别`/../`是我们不需要使用`\`来逃避`/`。你的实践经验还有什么？

***编辑***

根据***@akashspeaking 的***建议，我尝试了这个并找到了他所说的：

```
> re=%r(2/3)­
=> /2\/3/   # giving the pattern /../. Means Ruby internally converted this %r(..) to /../, which it should not if we created such regexp pattern manually.
> 
```

从上面很清楚理论上`%r(..)`是比 `/../`.

***`quickbm(10000000) { /2\­/3/=~s }`任何人都可以通过执行和`quickbm(10000000) { %r(2/3) =~ s }`测量执行时间来帮助我。我没有在此处安装所需的 gem 基准测试。但是古玩要知道这两个的输出。如果有的话-您可以在终端上尝试并在此处粘贴详细信息吗？***

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-17T04:49:25.687

`%r/foo/`和绝对没有区别`/foo/`。

```
irb(main):001:0> %r[foo]
=> /富/
irb(main):002:0> %r{foo}
=> /富/
irb(main):003:0> /foo/
=> /富/

```

源脚本将在启动时由解释器分析，两者都将转换为正则表达式，在运行时将是相同的。

唯一的区别是源代码，而不是可执行文件。试试这个：

```
require 'benchmark'

str = (('a'..'z').to_a * 256).join + 'foo'
n = 1_000_000

puts RUBY_VERSION, n
puts

Benchmark.bm do |b|
  b.report('%r') { n.times { str[%r/foo/] } }
  b.report('/') { n.times { str[/foo/] } }
end 
```

哪个输出：

```
1.9.3
1000000

      user     system      total        real
%r  8.000000   0.000000   8.000000 (  8.014767)
/  8.000000   0.000000   8.000000 (  8.010062) 
```

这是在运行 10.8.2 的旧 MacBook Pro 上。想一想，这是 6,656,000,000 (26 * 256 * 1,000,000) 个字符被搜索并且都返回了基本相同的值。巧合？我想不是。

在机器上运行此程序并获得在该 CPU 上的两个测试之间显着不同的答案将表明指定同一事物的两种语法不同的方式在运行时性能方面存在差异。我严重怀疑这会发生。

* * *

编辑：

多次运行它显示了行动的随机性。我稍微调整了代码，让它在今天早上的基准测试中执行五个循环。系统在运行测试时正在扫描磁盘，因此它们花费了更长的时间，但它们仍然显示出两次运行之间的微小随机差异：

```
require 'benchmark'

str = (('a'..'z').to_a * 256).join + 'foo'
n = 1_000_000

puts RUBY_VERSION, n
puts

regex = 'foo'
Benchmark.bm(2) do |b|
  5.times do
    b.report('%r') { n.times { str[%r/#{ regex }/] } }
    b.report('/')  { n.times { str[/#{ regex }/] } }
  end
end 
```

结果：

```
 # user     system      total        real
%r  12.440000   0.030000  12.470000 ( 12.475312)
/   12.420000   0.030000  12.450000 ( 12.455737)
%r  12.400000   0.020000  12.420000 ( 12.431750)
/   12.400000   0.020000  12.420000 ( 12.417107)
%r  12.430000   0.030000  12.460000 ( 12.467275)
/   12.390000   0.020000  12.410000 ( 12.418452)
%r  12.400000   0.030000  12.430000 ( 12.432781)
/   12.390000   0.020000  12.410000 ( 12.412609)
%r  12.410000   0.020000  12.430000 ( 12.427783)
/   12.420000   0.020000  12.440000 ( 12.449336) 
```

大约两秒钟后运行：

```
 # user     system      total        real
%r  12.360000   0.020000  12.380000 ( 12.390146)
/   12.370000   0.030000  12.400000 ( 12.391151)
%r  12.370000   0.020000  12.390000 ( 12.397819)
/   12.380000   0.020000  12.400000 ( 12.399413)
%r  12.410000   0.020000  12.430000 ( 12.440236)
/   12.420000   0.030000  12.450000 ( 12.438158)
%r  12.560000   0.040000  12.600000 ( 12.969364)
/   12.640000   0.050000  12.690000 ( 12.810051)
%r  13.160000   0.120000  13.280000 ( 14.624694) # <-- opened new browser window
/   12.650000   0.040000  12.690000 ( 13.040637) 
```

速度没有一致的差异。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T10:24:57.937

> `%r(..)`在这里，我发现和之间的一个区别`/../`是我们不需要使用`\`来逃避`/`。

这是它们的主要用途。与分隔符改变其语义的字符串不同，正则表达式文字之间唯一真正的区别是分隔符本身。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-16T10:37:14.490

还请查看此线程[Ruby %r{ } 表达式](https://stackoverflow.com/questions/12384704/the-ruby-r-expression)和此文档的 2 段[http://www.ruby-doc.org/core-1.9.3/Regexp.html](http://www.ruby-doc.org/core-1.9.3/Regexp.html)

除了在 %r 而不是 // 之后使用*任何*符号作为分隔符之外，没有什么区别

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-16T13:00:42.600

如果使用 %r 表示法，则可以使用任意符号作为分隔符。例如，您可以将正则表达式编写为以下任何一种（以及更多）：

```
%r{pattern}
%r[pattern]
%r(pattern)
%r!pattern! 
```

如果您的正则表达式包含大量“/”，这将很有用

> 注意：无论您使用什么，它将以默认形式保存。即 %r:pattern: 将默认为 /pattern/

# ruby-on-rails - 301永久重定向脚本？

> ID：14356027
> 
> 赞同：0
> 
> 时间：2013-01-16T10:17:39.373
> 
> 标签：ruby-on-rails, ruby-on-rails-3, routes, ruby-on-rails-3.2

我的网址结构是这样的。

```
domain/locale/villas/villa-name/summary
domain/locale/villas/villa-name/photos
domain/locale/villas/villa-name/location
ect

domain/locale/apartmens/villa-name/summary
domain/locale/apartmens/villa-name/photos
domain/locale/apartmens/villa-name/location
ect 
```

我想在 url 中添加 2 个新参数（已经添加了 db 关系），像这样

```
domain/locale/italy/umbria/villas/villa-name/summary 
```

如何将“旧”网址重定向到新的网址结构？使用脚本（我可以在每个 url 的路由文件中手动执行此操作，但我有 2000 个 url，因此不推荐使用此方法）

谢谢..remco

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T10:20:31.393

```
redirect_to path_or_url, :status => :moved_permanently 
```

# iphone - 授予日历隐私访问问题

> ID：14356033
> 
> 赞同：0
> 
> 时间：2013-01-16T10:18:08.373
> 
> 标签：iphone, ios, ekevent, ekeventstore

在我的代码中，我正在处理 ios 6 日历隐私的所有情况，如果用户允许访问日历，我调用了一些方法，如下所示：

```
[self performSelector:@selector(reloadData) withObject:nil afterDelay:0.1]; 
```

问题是选择器中指定的方法永远不会被调用，但是如果我将调用机制更改为：

```
[self reloadData]; 
```

方法调用成功。

你怎么看这个案子？这个问题有什么原因吗？

如果在 iOS 6 中授予对日历的访问权限后使用预制件选择器，为什么它不起作用？

任何帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T10:29:40.407

尝试删除 afterDelay？请参阅：[stackoverflow.com/questions/7219131/performselector-not-working](https://stackoverflow.com/questions/7219131/performselector-not-working)。

另外，如果你使用它会起作用`performSelectorInBackground`吗？

# android - 取消我的 android 应用程序上的锁定/解锁事件

> ID：14356036
> 
> 赞同：0
> 
> 时间：2013-01-16T10:18:17.623
> 
> 标签：android, onresume, unlock

当我解锁设备以查看我的应用程序时，将`onResume()`启动该过程。如何取消解锁事件，以避免`onResume()`处理？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T10:22:46.343

`OnResume`当您的 Activity 在后台时（例如，显示其他应用程序、锁屏、主屏幕...），总是会调用它。
查看[活动生命周期](http://techstub.co.uk/wp-content/uploads/2012/11/activity_lifecycle.png)以检查您是否可以将代码从`onResume()`可能移动到`onStart()`以解决您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T10:22:10.547

为防止解锁您的设备，请在您的活动中使用以下标志。

```
WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON 
```

**代码**

```
getWindow().addFlags(WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON); 
```

**笔记 ：**

如 Activity 生命周期文档中所述，onCreate 和 onResume 将始终在第一次启动 Activity 时被调用。回到Activity时，至少会调用onResume

# javascript - 随光标位置移动

> ID：14356037
> 
> 赞同：0
> 
> 时间：2013-01-16T10:18:17.673
> 
> 标签：javascript, html, html5-canvas, 2d-games

我正在制作一个桨球游戏，我在边界下设计和编写了球。我想制作更多的桨，并随着当前鼠标位置移动。我怎么得到那个？这是我的球在边界下移动的代码，我需要一个底部的桨。

```
<!doctype html>
<html>
<body onload="init();">
<script>
var context;
var x=150;
var y=150;
var dx=2;
var dy=4;

function init()
{
  context= myCanvas.getContext('2d');
  setInterval(draw,10);
}

function draw()
{
  context.clearRect(0,0, 300,300);
  context.beginPath();
  context.fillStyle="#98bf26";
  // Draws a circle of radius 20 at the coordinates 100,100 on the canvas
  context.arc(x,y,10,0,Math.PI*2,true);
  context.closePath();
  context.fill();

  // Boundary Logic
if( x<0 || x>300) dx=-dx;
if( y<0 || y>300) dy=-dy;
x+=dx;
y+=dy;
}

</script>

  <canvas id="myCanvas" width="300" height="300" style="border:1px dotted #111;" >
  </canvas>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T10:29:29.770

尝试添加到您的代码中

```
myCanvas.onmousemove = mouse_move_callback 
```

`mouse_move_callback`像这样的功能在哪里

```
function mouse_move_callback(ev) {
  // Get mouse position
  if (ev.offsetX) {
    c_x = ev.offsetX;
    c_y = ev.offsetY;
  }
  if (ev.layerX) {
    c_x = ev.layerX;
    c_y = ev.layerY;
  }
  // Update paddle position
  update_paddle(c_x,c_y);
} 
```

# blackberry - BlackBerry Simulator 未反映代码更改 - 每次更改都需要重新启动

> ID：14356046
> 
> 赞同：2
> 
> 时间：2013-01-16T10:18:43.567
> 
> 标签：blackberry, blackberry-simulator

我`SDK 5.0.0.36`在*Eclipse上使用 BlackBerry*

每当我进行任何更改时，我都需要重新启动模拟器

我只想运行一次模拟器，不想再次重新启动它

我在stackoverflow.com中引用了这个线程->“[查看更改而不重新启动黑莓模拟器？](https://stackoverflow.com/questions/2072928/view-changes-without-restarting-blackberry-simulator) ”

我按照上面线程中的给定程序，但我的模拟器仍然没有成功

我也在黑莓上试过`SDK 6.0 and 7.1`。. .但我仍在与同样的问题作斗争

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T23:01:34.557

正如史密斯先生所说，这个功能不是很可靠。有时它有效，有时则无效。

但是，我经常遇到的一个可修复问题是 JDE 插件文件夹的权限受到限制，因此 BlackBerry 模拟器无法写出正确的文件来执行热交换。

我通常可以在 Windows 资源管理器中通过转到 Eclipse 的根文件夹来解决此问题（如果您担心过多地打开权限，您可能只需转到 JDE 插件文件夹）。在 Windows 资源管理器中，右键单击并选择**Properties**。然后我取消选中**只读**复选框。然后，使用**安全**选项卡并确保您的用户帐户对该目录**及其**所有子目录具有**完全控制权。**

 **我通常也会将整个 Eclipse 目录树的所有权转移到我的用户帐户（例如 HOSTNAME\username）。使用“**安全”选项卡上的“****高级**”按钮执行此操作。

 **另外，[请查看此问题/答案](https://stackoverflow.com/a/12101394/119114)以及[有关热交换文件权限主题的 BlackBerry 支持论坛线程](http://supportforums.blackberry.com/t5/Testing-and-Deployment/Can-t-use-Hot-swap-even-on-latest-BB-Eclipse-plugin/td-p/1651419)****

# c# - API交互设计

> ID：14356058
> 
> 赞同：0
> 
> 时间：2013-01-16T10:19:13.850
> 
> 标签：c#, design-patterns, architecture

我目前正在设计一个系统组件（在 c# 中）以与 api 交互。api 调用的格式为：

```
http:// <name of api site>\< JSP page name>?<parameter set> 
```

该调用返回一个包含调用结果或错误消息的 xml 文档。我最终希望组件返回以下类型的对象：

```
 public readonly class APIResult<T>
 {
     public bool Success {get; set;}
     public T Details {get; set;}
 } 
```

我目前的计划是创建一个创建 URL 的类，然后将其传递给另一个通用类（T 类型）以使用该 url 调用 API，该 API 询问响应，该响应返回一个新的 APIResult，其中详细信息从Xml 结果反序列化。

我有两个问题要问 SO 的专家。

1）任何人都可以看到这种方法的问题或提出更好的方法来实现我的意图。

2) 是否有一种创建 URL 的优雅方法，而不是简单地使用带有传递给函数的参数的 string.format。

非常感谢，

番茄酱

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T18:18:14.597

三个建议：

1.  避免使用 Success 属性。每次点击 API 时，该属性都会强制您检查它。您将结束在任何地方都有这样的代码：

    if(result.Success) { // 做点什么 } else { // 这里...什么！？}

    在 OOP 中，异常比错误代码/标志更可取。

2.  使用属性（装饰）自动反序列化 API 响应（无需代码）。

3.  使用 UriBuilder 来......好吧，构建 uri：http: [//msdn.microsoft.com/en-us/library/system.uribuilder.scheme.aspx](http://msdn.microsoft.com/en-us/library/system.uribuilder.scheme.aspx)

# node.js - 将 ActiveX Com 组件与 nodejs 一起使用。是否可以

> ID：14356064
> 
> 赞同：6
> 
> 时间：2013-01-16T10:19:26.340
> 
> 标签：node.js, activex

有没有办法将任何 ActiveX com 组件与 nodejs 一起使用？

实际上，我永远不需要这个，但我在 Windows 上运行 nodejs 并尝试在不分叉新进程的情况下发送 ping 请求（Windows 不存在这样的模块）。

由于存在一些用于使用原始套接字发送 ping 请求的 Activex 组件，也许我可以使用它们。

* * *

如何从 JavaScript 创建 COM 对象的示例如下：

```
var rs = new ActiveXObject("ADODB.Recordset"); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-05T14:07:08.933

有 node-win32ole ( npm install win32ole )。

编辑：不再积极维护 win32ole。你可以试试[winax](https://www.npmjs.com/package/winax)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T10:37:14.420

（更新）

您可以尝试使用 node-ffi 绑定到 Win32 并启动 COM/ActiveX 组件 (CoCreateInstance) 或直接访问 winsock/icmp。见[https://github.com/rbranson/node-ffi](https://github.com/rbranson/node-ffi)

或者尝试通过 WMI ping，例如“select * from win32_pingstatus where Address='...'”。见[https://npmjs.org/package/wmi](https://npmjs.org/package/wmi)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-11T22:26:03.077

Node.js 的 ICMP ping 模块现在存在：

[https://npmjs.org/package/net-ping](https://npmjs.org/package/net-ping)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-09-06T15:47:34.720

多年后：

[节点winax](https://www.npmjs.com/package/winax)

node win32ole 不再适用于最新的 node.js 版本

# wpf - WPF TextBlock在文本换行后获取行

> ID：14356065
> 
> 赞同：5
> 
> 时间：2013-01-16T10:19:36.747
> 
> 标签：wpf, textblock, fixeddocument, line-count

我有`FixedDocument`页面，我想`TextBlock`放在它上面，但它可能`Textblock`不适合页面的高度。
所以我想从生成`TextBlock`的 with中取出线条`TextWrapping`，然后创建新`TextBlock`的，按高度拟合并将其放在页面上。
`TextBlock`有`LineCount`私有财产，这意味着它`TextLines`在包装后有，我可以以某种方式得到它。使用运行
创建：`TextBlock`

```
public TextItem(PageType pageType, Run[] runs, Typeface typeFace, double fontSize)
        : base(pageType)
{
     this.TextBlock = new TextBlock();
     this.TextBlock.Inlines.AddRange(runs);
     if (typeFace != null)
          this.TextBlock.FontFamily = typeFace.FontFamily;

     if (fontSize > 0)
           this.TextBlock.FontSize = fontSize;
     this.TextBlock.TextWrapping = TextWrapping.Wrap;   //wrapping
} 
```

`TextBlock`用文字创作：

```
public TextItem(PageType pageType, String text, Typeface typeFace, double fontSize)
        : base(pageType)
{
    if (typeFace == null || fontSize == 0)
        throw new Exception("Wrong textitem parameters");

    this.TextBlock = new TextBlock();
    this.TextBlock.Text = text;
    this.TextBlock.FontFamily = typeFace.FontFamily;
    this.TextBlock.FontSize = fontSize;
    this.TextBlock.TextWrapping = TextWrapping.Wrap;
    this.TextBlock.TextAlignment = TextAlignment.Justify;

    this.TypeFace = typeFace;
} 
```

将宽度设置为`TextBlock`并获得`DesiredSize`：

```
this.TextBlock.Width = document.CurrentPage.Content.ActualWidth;
this.TextBlock.Measure(new Size(double.PositiveInfinity, double.PositiveInfinity)); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-10-20T08:21:43.677

我遇到了完全相同的问题，有一段时间，我失去了希望，我认为没有解决办法。
但是，我错了，有很多解决方案（至少三个）
你是对的，其中一个`LineCount`通过反射来使用属性。
第二个使用它是自己的算法来获取线条。
第三个，这是我更喜欢的，有非常优雅的方式来获得你想要的结果。

请参考这个问题，看看这个问题的三个答案。
[根据TextWrapping属性获取TextBlock的行数？](https://stackoverflow.com/questions/30378441/)

* * *

这是最佳解决方案的副本（在我看来）

```
public static class TextUtils
{
    public static IEnumerable<string> GetLines(this TextBlock source)
    {
        var text = source.Text;
        int offset = 0;
        TextPointer lineStart = source.ContentStart.GetPositionAtOffset(1, LogicalDirection.Forward);
        do
        {
            TextPointer lineEnd = lineStart != null ? lineStart.GetLineStartPosition(1) : null;
            int length = lineEnd != null ? lineStart.GetOffsetToPosition(lineEnd) : text.Length - offset;
            yield return text.Substring(offset, length);
            offset += length;
            lineStart = lineEnd;
        }
        while (lineStart != null);
    }
} 
```

# ruby-on-rails - 页面重新加载后，collection_select 不重新加载项目

> ID：14356068
> 
> 赞同：0
> 
> 时间：2013-01-16T10:19:46.157
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有以下collection_select的代码

```
<%= f.collection_select :customer_id, Customer.all, :id, :name, options ={:prompt => "-Select a Customer"}, :style=>'width:210px;'%><br /> 
```

问题：- 如果我选择一个客户然后刷新页面，collection_select 不会刷新列表，但会显示先前选择的项目。我如何确保当我刷新/重新加载页面时，即使 collection_select 也会刷新？需要指导（抱歉英语不好）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T10:31:55.973

这是特定于浏览器的。现代浏览器可以在软刷新时记住您的选择并预先选择它们。通常，重新提交 url 应该足以确保显示一个干净的表单。

Ctrl+F5，就像 Sachin 要求您做的那样，通常会在刷新之前删除该特定页面的浏览器缓存，因此可以正常工作。

# mongodb - Mongoexport 返回计算列

> ID：14356070
> 
> 赞同：0
> 
> 时间：2013-01-16T10:19:51.667
> 
> 标签：mongodb

我可以使用 mongoexport 导出计算列吗？我想在返回时将“分数”加倍。我可以在我的 csv 上使用 Excel 执行此操作。但我想知道 mongoexport 是否本机支持这一点。我尝试了以下但没有奏效。它返回 Score 本身：

`mongoexport -d MyDB -c MyCollection -f _id, FirstName , Score*2 --csv --out f:\NewScores.csv`

我发现[了这个](https://stackoverflow.com/questions/11909760/is-it-possible-to-return-a-calculated-field-from-a-mongodb-query)类似的问题。但这是关于`find()`我可以在哪里使用`$project`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T05:17:30.490

我真的怀疑 mongoexport 可以在导出数据时执行任何数据计算或操作。它只是将数据从数据库转储/导出到文件。直而简单。

# java - Spring & Hibernate c3p0 错误无法完成模式验证

> ID：14356082
> 
> 赞同：0
> 
> 时间：2013-01-16T10:20:37.977
> 
> 标签：java, spring, hibernate, caching, c3p0

在我们的项目中，我们使用 Spring & Hibernate。在服务器和其他开发者机器上项目运行成功。但是，在我通过 SVN 更新我的项目后，我得到了一个错误列表，并且我无法解决它长达两天的时间。我已经阅读了很多关于它的文章，并尝试但问题没有解决。甚至，我已经完全删除了项目并再次结帐，恢复数据库但没有任何改变。MySql 已检查并正常工作，

**这是错误：**

```
Unable to find org.hibernate.search.event.FullTextIndexEventListener on the classpath. Hibernate Search is not enabled.
2013-01-16 04:36:22,512 ERROR [org.hibernate.tool.hbm2ddl.SchemaValidator] - could not complete schema validation
java.sql.SQLException: Connections could not be acquired from the underlying database!
...
2013-01-16 04:36:22,526 WARN [net.sf.ehcache.hibernate.AbstractEhcacheRegionFactory] - Couldn't find a specific ehcache configuration for cache named [org.hibernate.cache.StandardQueryCache]; using defaults.
2013-01-16 04:36:33,475 WARN [com.mchange.v2.async.ThreadPoolAsynchronousRunner] - com.mchange.v2.async.ThreadPoolAsynchronousRunner$DeadlockDetector@10dba0d -- APPARENT DEADLOCK!!! Creating emergency threads for unassigned pending tasks!
2013-01-16 04:36:33,476 WARN [com.mchange.v2.async.ThreadPoolAsynchronousRunner] - com.mchange.v2.async.ThreadPoolAsynchronousRunner$DeadlockDetector@10dba0d -- APPARENT DEADLOCK!!! Complete Status:
    Managed Threads: 1
Active Threads: 1
Active Tasks: 
    com.mchange.v2.resourcepool.BasicResourcePool$AcquireTask@3128482b (com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread-#0)
Pending Tasks: 
    com.mchange.v2.resourcepool.BasicResourcePool$AcquireTask@4b9a1843
Pool thread stack traces:
Thread[com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread-#0,5,main]
    java.lang.Thread.sleep(Native Method)
    com.mchange.v2.resourcepool.BasicResourcePool$AcquireTask.run(BasicResourcePool.java:1805)
    com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread.run(ThreadPoolAsynchronousRunner.java:547)
2013-01-16 04:36:51,878 WARN [com.mchange.v2.resourcepool.BasicResourcePool] - com.mchange.v2.resourcepool.BasicResourcePool$AcquireTask@3128482b -- Acquisition Attempt Failed!!! Clearing pending acquires. While trying to acquire a needed new resource, we failed to succeed more than the maximum number of allowed acquisition attempts (30). Last acquisition attempt exception: 
java.sql.SQLException: No suitable driver
at java.sql.DriverManager.getDriver(DriverManager.java:264)
at com.mchange.v2.c3p0.DriverManagerDataSource.driver(DriverManagerDataSource.java:223)
at com.mchange.v2.c3p0.DriverManagerDataSource.getConnection(DriverManagerDataSource.java:134)
at com.mchange.v2.c3p0.WrapperConnectionPoolDataSource.getPooledConnection(WrapperConnectionPoolDataSource.java:182)
at com.mchange.v2.c3p0.WrapperConnectionPoolDataSource.getPooledConnection(WrapperConnectionPoolDataSource.java:171)
at com.mchange.v2.c3p0.impl.C3P0PooledConnectionPool$1PooledConnectionResourcePoolManager.acquireResource(C3P0PooledConnectionPool.java:137)
at com.mchange.v2.resourcepool.BasicResourcePool.doAcquire(BasicResourcePool.java:1014)
at com.mchange.v2.resourcepool.BasicResourcePool.access$800(BasicResourcePool.java:32)
at com.mchange.v2.resourcepool.BasicResourcePool$AcquireTask.run(BasicResourcePool.java:1810)
at com.mchange.v2.async.ThreadPoolAsynchronousRunner$PoolThread.run(ThreadPoolAsynchronousRunner.java:547) 
```

**这是 Hiernate > c3p0 conf**

```
<bean id="dataSource" class="com.mchange.v2.c3p0.ComboPooledDataSource" destroy-method="close">
    <property name="jdbcUrl" value="${jdbc.url}" />
    <property name="user" value="${jdbc.username}" />
    <property name="password" value="${jdbc.password}" />
    <property name="initialPoolSize" value="1" />
    <property name="minPoolSize" value="1" />
    <property name="maxPoolSize" value="5" />
    <property name="idleConnectionTestPeriod" value="500" />
    <property name="acquireIncrement" value="1" />
    <property name="maxStatements" value="50" /> <!-- I tried this value = 0 it does not work -->
    <property name="numHelperThreads" value="1" />
</bean> 
```

**数据库属性**

```
hibernate.hbm2ddl.auto=validate
hibernate.hbm2ddl.import_files=/import_standard.sql
hibernate.show_sql=false
hibernate.format_sql=true
hibernate.generate_statistics=false
hibernate.use_sql_comments=true
hibernate.query.factory_class=org.hibernate.hql.ast.ASTQueryTranslatorFactory
hibernate.cache.use_query_cache=true
hibernate.cache.region.factory_class=net.sf.ehcache.hibernate.SingletonEhCacheRegionFactor
hibernate.cache.use_second_level_cache=true

jdbc.driverClassName=com.mysql.jdbc.Driver
jdbc.url=jdbc:mysql://localhost:3306/asd?autoReconnect=true
jdbc.username=asd
jdbc.password=asdasd

hibernate.dialect=org.hibernate.dialect.MySQL5Dialect 
```

**ehcahce.xml**

```
<?xml version="1.0" encoding="UTF-8"?> 
```

```
<cache
    name="org.hibernate.cache.UpdateTimestampsCache"
    maxElementsInMemory="50000"
    eternal="true"
    overflowToDisk="true"/>

<defaultCache
    maxElementsInMemory="10000"
    eternal="false"
    timeToIdleSeconds="120"
    timeToLiveSeconds="120"
    overflowToDisk="true"
    maxElementsOnDisk="10000000"
    diskPersistent="false"
    diskExpiryThreadIntervalSeconds="120"
    memoryStoreEvictionPolicy="LRU"/>

<cache
    name="ncStandardElements"
    maxElementsInMemory="100000"
    eternal="false"
    overflowToDisk="true"
    timeToLiveSeconds="600"/>

<cache
    name="ncOrderElements"
    maxElementsInMemory="100000"
    eternal="false"
    overflowToDisk="true"
    timeToLiveSeconds="60"/>

<cache
    name="ncAdminElements"
    maxElementsInMemory="100000"
    eternal="false"
    overflowToDisk="true"
    timeToLiveSeconds="60"/> 
```

我是 Spring 和 Hibernate 的新手，在阅读文章时，这些​​代码块很重要，应该加以管理。如果需要任何其他代码块，请评论它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T11:27:36.983

您应该将以下行放入您的 dataSource bean

```
<property name="driverClass" value="${jdbc.driverClassName}" /> 
```

# c# - 处理主窗体并创建一个新的 c#

> ID：14356088
> 
> 赞同：0
> 
> 时间：2013-01-16T10:20:59.270
> 
> 标签：c#, forms

> **可能重复：**
> [Windows 窗体：在运行时更改应用程序主窗口](https://stackoverflow.com/questions/1028843/windows-forms-change-application-mainwindow-at-runtime)

我想创建新表单，并在 C# 中销毁主表单。我怎么能这样做？

```
var fw2 = new Form2();
fw2.Show();
this.Dispose(); 
```

此代码仅显示第二种形式一秒钟并关闭我的程序。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T10:35:51.800

我在 Program 课上做过这种事情。我只是将以下通常在 Main 方法中看到的代码放入一个循环中。

```
Application.EnableVisualStyles();
Application.SetCompatibleTextRenderingDefault(false);
Application.Run(new frmMain()); 
```

一旦主窗体关闭，代码就会离开“运行”方法并进入一个循环，该循环检查应用程序全局变量以查看它是否需要呈现新窗体。

如果您只是想打开一个新表单，这太过分了，但如果您经常“交换”主表单，它似乎工作得很好。

我的代码看起来（有点）像这样......

```
while (true)
{
    if (AppSettings.SomeFormSettng = FormSetting.ShowAnotherForm)
    {
        Form showThisForm = AppSettngs.TheForm;
        if (ThisIsTheFirstRun)
        {
            Application.EnableVisualStyles();
            Application.SetCompatibleTextRenderingDefault(false);
            ThisIsTheFirstRun = false;
        }
        Application.Run(new showThisForm ());
    }
    else
    {
        return;
    }
} 
```

# c++ - 提升进程间锁持久性

> ID：14356089
> 
> 赞同：1
> 
> 时间：2013-01-16T10:21:00.770
> 
> 标签：c++, boost, locking, ipc, boost-interprocess

我有以下崩溃的代码。我怀疑这是因为分配了对我有这个问题的堆栈的引用。但我想避免每次都必须堆栈分配互斥锁和范围锁的成本

```
 class Cache { 
  public:
    void createCacheLock(const char* name) { 
       named_mutex mutex_(open_only, name);
       mutex = &mutex_;
       scoped_lock<named_mutex> cache_lock_(mutex_, defer_lock);
       cache_lock=&cache_lock_ ; 

   }

 void updateCache(const char* name, int newvalue) { 
             cache_lock->lock()  ; 
             /* Do update work */
             cache_lock->unlock() ; 
 }

 private: 
     named_mutex* mutex ;  
     scoped_lock<named_mutex>* cache_lock; 

 } 
```

然后我存在该函数（cache_lock 是一个类字段），当尝试从不同的类方法中调用 cache_lock.lock 时，我的程序崩溃（在这种情况下 updateCache 在 cache_lock->lock() 部分崩溃）

我有两个问题：我怎样才能创建一个“持久的”cache_lock，这样我就可以在不调用named_mutex（open_only等）的情况下重用它？ak 我想避免每次都这样做

```
void updateCache(const char* name, int newvalue) { 
        named_mutex mutex_(open_only, name);
        scoped_lock<named_mutex> cache_lock_(mutex_, defer_lock);  
        /* Do update work */
         cache_lock->unlock() ; 
```

}

其次，重复上述过程（即找到互斥体并从中创建锁）是一项昂贵的操作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T11:11:23.837

您有指向局部变量的指针。局部变量仅在函数运行时存在于堆栈中，当函数返回时，这些对象被销毁并调用它们的析构函数。这些对象占用的内存将在函数返回后被下一个要调用的函数重用。这意味着您拥有的指针不仅指向可能被破坏的对象，还可以指向用于完全不同的东西的内存。当然，参考也是如此。

而是在堆上分配这些对象`new`，或者使用[智能指针](http://en.cppreference.com/w/cpp/memory)。

* * *

您可以在构造函数*初始化列表*中调用类中对象的特定构造函数：

```
class cache
{
public:
    cache(const std::string& lock_name)
        : mutex_(open_only, lock_name),
          cache_lock_(mutex_, defer_lock)
        {}

    // ...

private:
    named_mutex mutex_;
    scoped_lock<named_mutex> cache_lock_;

    // ...
}; 
```

# iphone - 当光标悬停在 UILabel 上时显示一条消息

> ID：14356093
> 
> 赞同：0
> 
> 时间：2013-01-16T10:21:09.317
> 
> 标签：iphone, uilabel, xcode4.5

点击标签时如何显示一些文本消息？我有一个标签`(Address).Now`，当我点击它时，我需要在一个小弹出窗口中显示相应的地址。

我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T10:34:35.033

**我从您的评论中发现您实际上希望在点击事件**时弹出一个窗口。

 **你需要做的就是

在 UILabel 上有一个按钮（您要在其上显示弹出窗口）。制作自定义类型的按钮（它会使按钮消失）。之后编写一个显示弹出窗口的方法，并将其连接到该自定义按钮。

要创建弹出窗口，您可以使用所需大小和位置的 UIView 并使其在自定义按钮点击事件（内部修饰）上出现/消失。

希望这可以帮助。**

# actionscript-3 - 通过将实例从阶段中删除并将其归零来删除实例的函数不会将其从内存中删除

> ID：14356096
> 
> 赞同：0
> 
> 时间：2013-01-16T10:21:12.253
> 
> 标签：actionscript-3, events, event-listener

我用于删除实例并将其替换为另一个实例的函数存在问题。基本上，无论如何它都会将项目保存在内存中。在对象内部，我的侦听器很弱，并且在它被删除后我将所有内容都归零，但是我运行以检查它是否仍然处于活动状态的函数告诉我它是（只是一个 Event.ENTER_FRAME 跟踪一些文本，带有一个弱链接）。

即使我从正在加载的实例中删除了所有内容，它似乎仍然留在内存中，根据我的跟踪它仍然是。如何从内存中完全删除某些内容，而不是在将其从舞台上删除后将其清空？我没有看到什么吗？

这是功能：

```
private function loadArea(inputArea:String)
            {                      
                    //This is for a checker to make sure that areas only get loaded once.
                    currentRoom = inputArea;

                    //If the area currently loaded is not null, make it null now.
                    if(selectedArea != null) selectedArea = null;

                    //Null any data inside of the reference used to create the name of the new area.
                    areaReference = null;
                    //Grab the class using the input.
                    areaReference = getDefinitionByName(inputArea + "Area") as Class;

                    //Null the sprite used to house the class
                    areaSprite = null;
                    //Set the holder as a new instance of the desired class.
                    areaSprite = new areaReference() as Sprite;

                    //If the selected area is still not null for some reason,
                    if(selectedArea != null)
                    {
                            //Remove the area from the container...
                            areaContainer.removeChild(selectedArea);
                            //...and nullify it.
                            selectedArea = null;
                    }

                    //Set the current area as the newly created instance.
                    selectedArea = areaSprite;

                    //If the area is not the "Game", load in the assets one way,                   
                    if(inputArea != "Game") selectedArea.construct(areaAssets);
                    //otherwise do it another way.
                    else selectedArea.construct(newScreenData,apiServer,cdnServer,areaAssets);

                    //This is for a checker that fades out the screen, which it needs to fade back in soon.
                    newScreenData = null;

                    //While the container for areas has any areas inside of it, remove them.
                    while(areaContainer.numChildren) areaContainer.removeChildAt(0);

                    //...then add the new instance area to the container.
                    areaContainer.addChild(selectedArea);

                    //...then let all the parts of the game know that a new area has been laoded in.
                    Global.echoEvent.echo("gameBootUp","playAreaIn");
            } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T11:24:48.287

当垃圾收集器找到并擦除您的孤立实例时，实际上会释放内存。在此之前，您的内存使用情况将表明内存中有一个实例。没有办法强制垃圾回收，`System.gc()`只调用“指示”Flash 运行它，它可能不服从。所以，你已经做了你该做的，顺其自然吧。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T11:13:25.220

删除所有引用（包括阶段和清空对象）是释放内存所需的全部内容。

如果对象没有被释放，那么你错过了一些东西或做错了事或不按顺序。

仔细检查您的代码，确保您确定对象被引用的位置，以便您可以删除它们。

查看您的示例代码：

```
if(selectedArea != null) selectedArea = null; 
```

在这里，您要确保 selectedArea 为空。但是在你再次测试 selectedArea 之后立即（你知道它是 null 所以这个块永远不会使用）

```
if(selectedArea != null){
//Remove the area from the container...
areaContainer.removeChild(selectedArea);
//...and nullify it.
selectedArea = null;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T17:11:37.137

在每种语言中，“清除”内存都非常困难……甚至是 HTML。话虽这么说...尝试减少您的内存占用。

```
Correct Null:
1\. remove all event listeners
2\. remove all children
3\. remove all mapped/referenced methods/parameters
4\. set the class object to null 
```

在大多数情况下，这就是您需要做的所有事情，您执行此操作的方式将确定对象是否被清除。考虑以下情况。

您有一个具有映射属性的自定义精灵类（MEMORY FOOTPRINT #1）（当一个类对象引用另一个类对象时发生映射）。一旦您将一个对象映射/引用到另一个对象 = MEMORY FOOTPRINT #2。添加事件 = MEMORY FOOTPRINT #3 等等。

自定义精灵

```
import flash.display.Sprite;

class CustomSprite extends Sprite{

    private var _mappedProperty:Object;

    public function addMapping(map:Object):void{
        _mappedProperty = map;
    }

    public function finalize():void{
        _mappedProperty = null;
    }
} 
```

假设我们在许多其他方法中使用 CustomSprite，让我们看看一些删除 ojbect 的常用方法。

**错误**- 在这种情况下 [objToRemove] 未设置为 null 以释放其内存：

```
var objToRemove:CustomSprite = new CustomSprite;

function doSomething(referenceObj:CustomSprite):void{

    var methodObj:CustomSprite = referenceObj;

    //CRAZY LINES OF CODE

    methodObj = null;       //frees memory from [doSomething::methodObj]
    referenceObj = null;    //frees memory from [doSomething::referenceObj]

    //objToRemove is not cleared and will remain in memory
} 
```

**错误**- 在这种情况下 [objToRemove] 有一个引用对象，因此在删除引用之前它不会清理：

```
var objToRemove:CustomSprite = new CustomSprite;
var mappedObject:Sprite = new Sprite;

objToRemove.addMapping(mappedObject);       
objToRemove.addEventListener(Event.ENTER_FRAME,onEnterFrame);

//CRAZY LINES OF CODE

//remove all children
while(objToRemove.numChildren > 0){
    objToRemove.removeChildAt(0);
}

//remove all event listeners
objToRemove.removeEventListener(Event.ENTER_FRAME,onEnterFrame);

//this will NOT work
objToRemove = null;

//reason is objToRemove has a reference object of [mappedObject]
//[mappedObject] is not a child so it needs to be removed manually
//from WHITIN the CustomSprite class using [CustomSprite::finalize()] 
```

好吧……呼吸……正确的方法其实很简单。

**正确**- 这里我们使用 [Dynamic] 对象而不是 [Static] 类对象，这被认为是对象映射：

```
//think of this as a global list of objects
var objPool:Dictionary = new Dictionary;

//create a pool reference
objPool['poolObj'] = new CustomSprite;

//CRAZY LINES OF CODE;

//do the normal [null] process

//both of these will work
objPool['poolObj'] = null;
//or
delete objPool['poolObj']; 
```

**超高级正确**- 没有提供示例，我必须回去工作，哈哈...

```
1\. Take a ByteArray clone of the class
2\. User a Loader to construct the ByteArray as the class, rather than using "new"
3\. When finished... unload/remove the loader
4\. EVERYTHING will clear... thats how a Loader works! 
(Not getting into why and how... too long of an explanation) 
```

尽管这可以完美运行……但在工作环境中并未普遍接受或建议。

# c# - 如何使用 asp.net c# 应用程序将 MySql 数据库转换为 MsSQL 数据库

> ID：14356099
> 
> 赞同：0
> 
> 时间：2013-01-16T10:21:16.840
> 
> 标签：c#, asp.net, mysql, sql-server

我正在将网站转换为新网站`CMS`，但德国网站数据库都是`MySQL databases`，但`CMS`可以通过`SQLServer`。因此我不得不进行数据库转换，我已经完成了一个伪代码，并且还使用 Microsoft Visual Studio 在 C# 中启动了该程序，但是由于我只使用`c# in asp.net`了 cms 格式，这是我第一次真正的 C# 编程尝试，所以请原谅我的代码中可能已经存在的一些可怕错误，即使没有我错过的部分。

nb 我知道数据库对于某些表方面有不同的名称，例如数据和时间，但数据库中没有会导致冲突的名称。

伪：

```
 /*start loop 
                         *connect to MYSQL
                         * is there a table to use? if yes begin loop, else Exit, & disconnect from MYSQL;
                         * begin iteration on Table N
                         * Read table list 
                            SELECT COUNT(*)
                            FROM INFORMATION_SCHEMA.COLUMNS
                            where Table_name ='Current selected table' 
                         *  execute
                         * Disconnect from MYSQL 
                         * 
                         * Connect to MS SQL
                         * create new table in MS SQL USing read data
                         * Create Table [same name as other table, with columns from      other place]
                         * (all column names in here,sfg, bgfgb,dgb)
                         * ececute command, creating a new table
                         * Disconnect from MSSQL
                         * 
                         * Connect to MySQl
                         *  return all data within table n,
                         *  
                         * Select * From [table name];
                         * Disconnect MySQL
                         *  
                         * Connect MS SQL 
                         * INSERT INTO (table name)
                         * VALUES ( columsn 1, 2, 3, 4 etc)
                         * 
                         * execute
                         * Disconnect MS SQL, 
                         * 
                         * Table N +1 //next itteration
                         *  
                         * insert into new table Values (data from mySQL)
                         * once all have been complete loop until ended
                         * program will leave when no tables left
                         */ 
```

到目前为止，这是我在 C# 中创建的：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Data;
using System.Data.SqlClient;
using MySql.Data.MySqlClient;
using System.Configuration;

namespace dbconverter
{
    public class program
    {
        public static void Main(string[] args)
        {
            MySqlDataAdapter _Myadp = new MySqlDataAdapter();
            int i = 0; i < _Table.Count; i++;
        }
        public static void ConnectMySQL()
        {
            string cs = @"MYSQLconnectionstring";

            MySqlConnection conn = null;

            try
            {
                conn = new MySqlConnection(cs);
                conn.Open();

                if (conn == null)
                {
                    Console.WriteLine("connection could not be established");
                }
                else
                {
                    Console.WriteLine("connection was successful");
                }
            }
        }

        public static void SearchTables()
        {
            MySqlDataAdapter _Myadp = new MySqlDataAdapter();

            _Myadp.SelectCommand.CommandText = "show tables;";
        }
        public static void ChooseTable()
        {

            //Show all tables,
            //have loop internal of main()

        }
        public static void CopyTable()
        {
            MySqlDataAdapter _Myadp = new MySqlDataAdapter();

            _Myadp.Fill(_Table);

        }
        public static void connectMsSQL()
        {
            SqlConnection _con = new SqlConnection(ConfigurationManager.ConnectionStrings["MSconnectionstring"].ConnectionString);

            _con.Open();

        }
        public static void CreateTable()
        {

            if (_Table != null)
            {
                if (_Table.Rows.Count > 0)
                {
                    _return= new List<>();

                    for (int a = 0; a< _Table.Count; a++)
                    {
                        _return.Add(new_Table());
                        _Return[a].List<> = Convert.ToString(_table[int][" *-(ALL) "]);
                    }
                }
            }
        }

        public static void CopyMySQLTableData()
        {
            MySqlDataAdapter _Myadp = new MySqlDataAdapter();
            _Myadp.SelectCommand.CommandText = "SELECT (*) FROM [_Table];";
            //return to table
        }
        public static void InsertDataMsSQL()
        {
            if (_Table != null)
            {
                if (_Table.Rows.Count > 0)
                {
                    _return= new List<>();

                    for (int a = 0; a< _Table.Count; a++)
                    {
                        _return.Add(new_Table());
                        _Return[a].List<> = Convert.ToString(_table[int][" *-(ALL) "]);
                    }
                }
            }
        }

    }
} 
```

如果有人有时间，我基本上需要一些关于我现在如何处理我创建的类的建议，`[ Main() class ]` 以便将它们全部组合成一个遵循伪结构的工作程序。

提前谢谢了

# iphone - NSPredicate 下划线崩溃

> ID：14356103
> 
> 赞同：-1
> 
> 时间：2013-01-16T10:21:32.227
> 
> 标签：iphone, ios, objective-c, cocoa-touch

```
fetchRequest.predicate = [NSPredicate predicateWithFormat:@"identifer==1_12"]; 
```

给我 ：

```
Unable to parse the format string "identifier==1_12"' 
```

我尝试过使用 MATCHES、LIKE、=、带空格 ==、不带空格等。不知何故，我觉得下划线是某种保留符号。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T10:25:02.233

如果要与字符串“1_12”进行比较，则必须将其括在单引号中：

```
[NSPredicate predicateWithFormat:@"identifer == '1_12'"] 
```

或者：

```
[NSPredicate predicateWithFormat:@"identifer == %@", @"1_12"] 
```

# c - 如何测试遗留 C 代码并检查命中的分支

> ID：14356110
> 
> 赞同：0
> 
> 时间：2013-01-16T10:21:59.270
> 
> 标签：c, visual-studio-2010, unit-testing, legacy-code

我有一个包含许多大型（1000 多行）函数的 DLL。这段代码有很多复杂的逻辑，我想确保它在维护时不会被破坏，所以我创建了一个动态加载这个 DLL 并调用它的 API 的测试工具。

我想知道一种能够从我的测试工具中测试在此 API 中命中的代码分支的好方法。我能想到的唯一方法如下：

```
// Pseudo test code
void doTest()
{
  loadDllToBeTested();
  dll_api_function_1();
  assert( dll_api_function_1_branches.branch1Hit == true );
  unloadDllToBeTested();
}

 // Real api in the C dll
 struct dll_api_function_1_branches
 {
   bool branch1Hit;
 }

 dll_api_function_1_branches g_dll_api_function_1_branches;

 int private_func1()
 {
     printf("Doing my private stuff\n");
     return 1;
 }

 void dll_api_function_1(void)
 {
   if ( private_func1() )
   {
     printf("doing some stuff\n");
     dll_api_function_1_branches.branch1Hit = true; // so the test code can check if we got here :(
 }
 else
 {
    printf("doing some other stuff\n");
 }

 // tons of other logic and branching...
 } 
```

这基本上是每个函数都有一个结构，当在函数内到达某些分支时，它会设置值。将有一个此结构的全局导出实例，测试代码必须将其初始化为零，然后在调用 API 后进行检查。

另请注意，我使用的是 Visual Studio，因此无法在此处使用 gcov 等工具。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-20T03:13:50.927

LLVM 项目提到了[KLEE](http://klee.llvm.org/TestingCoreutils.html)工具，它有助于创建测试用例来执行所有路径（并在过程中发现错误）。其中一些是面向 Unix 的，它是一个当前的研究项目（粗糙的边缘，需要一些组装，以及其他免责声明）。

# image - 高级 CSS 或图像？

> ID：14356119
> 
> 赞同：0
> 
> 时间：2013-01-16T10:22:25.783
> 
> 标签：image, css, styling

我有一个我正在尝试制作的 div 的想法。这基本上是它的样子。你打算怎么做这个？还是我应该只使用图像？重定向到 URL 基本上只是指向另一个网站的链接。这也是一张桌子的顶部。或者这就是我想要的样子，但如果有更好的方法，请告诉！

```
 ______________
         /              \
        / REDIRECT TO URL\
_______/                  \________ 
```

你打算怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T10:32:16.060

**这个纯 CSS**解决方案怎么样..

HTML

```
<div class="topLeft"></div>
<div class="topMidd">Hello</div>
<div class="topRight"></div> 
```

CSS

```
*{
  font-size:14px;
}
.topLeft{
  float:left;
  border-right:1em red solid;
  border-top:2em transparent solid;
  width:0;
  height:0;
}
.topMidd{
  float:left;
  background:red;
  height:2em;
  line-height:2em;
  padding:0 2em;
}
.topRight{
  float:left;
  border-left:1em red solid;
  border-top:2em transparent solid;
  width:0;
  height:0;
} 
```

您可以随时使用数字来获得您想要的结果。这是一个跨浏览器的解决方案，这意味着您无需费心制作图像。

这是一个[JSFiddle](http://jsfiddle.net/CHEyW/2/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T10:32:53.023

这可以在 css3 等中完成，但会遇到浏览器问题。

我现在会使用一个图像，但如果你希望它对任何文本大小都很好且可扩展，我建议大致像这样布局。

```
<div class="holder">
<span class="block leftBlock"></span>
<span class="block innerBlock">REDIRECT TO URL</span>
<span class="block rightBlock"></span>
</div> 
```

然后用你的CSS

```
.holder{height:heightOFImage;}
.block{float:left;height:100%;display:block;}
.leftBlock{background-image:url("leftImg.png");width:20px;}
.centerBlock{background-image:url("centerImg.png");background-repeat:repeat-x;}
.rightBlock{background-image:url("rightImg.png"); width:20px;} 
```

![图像设计](../Images/8f16b037b686be8c0707e23b9f6caaef.png)

这意味着您可以将其与所有不同类型的非长度字符串一起使用

# c# - 很少发生：对象引用未设置为对象的实例

> ID：14356120
> 
> 赞同：0
> 
> 时间：2013-01-16T10:22:25.997
> 
> 标签：c#, sqlite, windows-8

我知道类似的问题已经被问过很多次，也被回答过很多次。

我有一个奇怪的问题，我只能偶尔发生此异常。它与没有模式不一致，只是随机发生。

异常：未处理 NullReferenceException 文本：对象引用未设置为对象的实例。

发生异常的行：

```
 var query = conn.Table<Items>(); 
```

conn 指的是 SQLiteAsyncConnection("items.db"); 项目引用另一个包含数据库模型的类。

我哪里错了？为什么代码大部分时间都可以工作，但偶尔会随机崩溃？（我没有改变任何因素，只是反复打开应用程序再次运行代码）

忘了提到我正在使用 NUGET 提供的 sqlite-net 插件，可以在这里找到 git：[https ://github.com/praeclarum/sqlite-net](https://github.com/praeclarum/sqlite-net)

根据要求：物品代码（非常基本）

```
public class Items
{
    [PrimaryKey, AutoIncrement]
    public int Id { get; set; }

    [MaxLength(30)]
    public string Item { get; set; }
} 
```

完整方法的代码：

```
 private async void ReadData()
    {
            listdata.Items.Clear();

            var query = conn.Table<Items>(); // Exception occurs here 

            var result = await query.ToListAsync();
            foreach (var item in result)
            {
                listdata.Items.Add(item.Item);
            }
    } 
```

# c++ - 窗口显示后如何调用函数？

> ID：14356121
> 
> 赞同：42
> 
> 时间：2013-01-16T10:22:30.880
> 
> 标签：c++, qt

使用 Qt 我创建了一个**QMainWindow**并希望在显示窗口后调用一个函数。当我在**构造**函数中调用该函数时，该函数（实际上是一个对话框）在显示窗口之前被调用。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2013-01-16T11:50:04.120

如果你想在小部件可见时做一些事情，你可以像这样覆盖[QWidget::showEvent](http://qt-project.org/doc/qt-4.8/qwidget.html#showEvent)：

```
class YourWidget : public QWidget { ...

void YourWidget::showEvent( QShowEvent* event ) {
    QWidget::showEvent( event );
    //your code here
} 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-01-23T16:55:41.880

尝试这个：

**在 mainwindow.h 中：**

```
class MainWindow : public QMainWindow
{
    Q_OBJECT

public:
    explicit MainWindow(QWidget *parent = 0);
    ~MainWindow();  

protected:
      void showEvent(QShowEvent *ev);

private:
      void showEventHelper();
      Ui::MainWindow *ui;
} 
```

**在 mainwindow.cpp 中：**

```
MainWindow::MainWindow(QWidget *parent) : QMainWindow(parent),
    ui(new Ui::MainWindow)
{
    ui->setupUi(this);
}

void MainWindow::showEvent(QShowEvent *ev)
{
    QMainWindow::showEvent(ev);
    showEventHelper();
}

void MainWindow::showEventHelper()
{
    // your code placed here
} 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2014-10-30T10:01:55.820

遵循 Reza Ebrahimi 的示例，但请记住这一点：

不要省略`connect()`指定连接类型的函数的第 5 个参数；确保它是`QueuedConnection`。

IE，

```
connect(this, SIGNAL(window_loaded), this, SLOT(your_function()), Qt::ConnectionType(Qt::QueuedConnection | Qt::UniqueConnection)); 
```

我相信如果你这样做，你会达到你所需要的。

*   信号槽连接有几种类型：`AutoConnection`, `DirectConnection`, `QueuedConnection`, `BlockingQueuedConnection`(+ optional `UniqueConnection`)。阅读手册了解详情。:)

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2019-07-02T12:46:55.127

在分析了上面的解决方案之后，所有这些解决方案，包括那些被大力支持的解决方案，都是错误的。

许多人推荐这样的东西：

```
class MyWidget : public QWidget {
    // ...
};

void MyWidget::showEvent(QShowEvent* event) {
    QWidget::showEvent(event);
    DoSomething();
}

void MyWidget::DoSomething() {
    // ...
} 
```

只要没有`QCoreApplication::processEvents();`in就可以使用`DoSomething`。如果有，它会处理队列中的所有事件，*包括`QShowEvent`首先调用 MyWidget::showEvent 的事件*。当它到达原始的 QShowEvent 时，它再次调用 MyWidget::showEvent，导致无限循环。

如果发生这种情况，有以下三种解决方案：

解决方案 1\. 避免调用`processEvents`in `MyWidget::DoSomething`，而是在必要时调用`update`or 。`repaint`如果`DoSomething`调用别的东西，这些函数`processEvents`也应该避免。

解决方案 2\. 使 DoSomething 成为一个插槽，并将对 DoSomething() 的直接调用替换为

```
QTimer::singleShot(0, this, SLOT(DoSomething())); 
```

由于零间隔计时器仅在队列中的所有事件都处理完毕后才会触发，因此它将处理所有事件，包括原始 QShowEvent，将它们从队列中移除，然后才调用 DoSomething。我最喜欢它。

由于只有在处理完队列中的所有事件后才会触发零间隔计时器，因此您不应尝试通过延长间隔来“改进”它，例如

```
QTimer::singleShot(50, this, SLOT(DoSomething())); // WRONG! 
```

由于 50 毫秒*通常*足以处理队列中的事件，这*通常会*起作用，从而导致难以重现的错误。

解决方案 3\. 制作一个防止第二次调用 DoSomething 的标志：

```
class MyWidget : public QWidget {
    // ...
};

void MyWidget::showEvent(QShowEvent* event) {
    if (is_opening)
        return;
    is_opening = true;
    QWidget::showEvent(event);
    DoSomething();
    is_opening = false;
}

void MyWidget::DoSomething() {
    // ...
} 
```

这里，is_opening 是一个布尔标志，应该在构造函数中初始化为 false。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2018-10-11T16:52:58.293

假设您想在窗口显示*后*在窗口的 UI 线程中运行代码，您可以使用以下相对紧凑的代码。

```
class MainWindow : public QMainWindow
{
        // constructors etc omitted.

protected:
    void showEvent(QShowEvent *ev)
    {
        QMainWindow::showEvent(ev);
        // Call slot via queued connection so it's called from the UI thread after this method has returned and the window has been shown
        QMetaObject::invokeMethod(this, "afterWindowShown", Qt::ConnectionType::QueuedConnection);
    }

private slots:
    void afterWindowShown()
    {
        // your code here
        // note this code will also be called every time the window is restored from a minimized state
    }
}; 
```

它确实按名称调用 afterWindowShown，但这种事情在 Qt 中是相当普遍的做法。有一些方法可以避免这种情况，但它们有点冗长。

请注意，此代码应适用于任何 QWidget 派生类，而不仅仅是 QMainWindow 派生类。

理论上，非常快速的用户可能会在调用 afterWindowShown 之前在显示窗口的 UI 上调用某种操作，但这似乎不太可能。一些需要牢记的东西并可能防御性地编写代码。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-08-03T17:14:51.883

[我在这个问题](https://stackoverflow.com/questions/28458639)中找到了一个很好的答案，即使您使用 Sleep() 函数，它也很有效。

所以尝试了这个：

```
//- cpp-file ----------------------------------------

#include "myapp.h"
#include <time.h>
#include <iosteream>

MyApp::MyApp(QWidget *parent)
    : QMainWindow(parent, Qt::FramelessWindowHint)
{
    ui.setupUi(this);
}

MyApp::~MyApp()
{

}

void MyApp::showEvent(QShowEvent *event) {
    QMainWindow::showEvent(event);
    QTimer::singleShot(50, this, SLOT(window_shown()));
    return;
}

void MyApp::window_shown() {
    std::cout << "Running" << std::endl;
    Sleep(10000);
    std::cout << "Delayed" << std::endl;
    return;
}

//- h-file ----------------------------------------

#ifndef MYAPP_H
#define MYAPP_H

#include <QtWidgets/QMainWindow>
#include <qtimer.h>
#include <time.h>
#include "ui_myapp.h"

class MyApp : public QMainWindow
{
    Q_OBJECT

public:
    MyApp(QWidget *parent = 0);
    ~MyApp();

protected:
    void showEvent(QShowEvent *event);

private slots:
    void window_shown();

private:
    Ui::MyAppClass ui;
};

#endif // MYAPP_H 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-09-27T18:28:20.160

我使用 Paint 事件在没有计时器的情况下解决了它。至少在 Windows 上对我有用。

```
// MainWindow.h
class MainWindow : public QMainWindow
{
    ...
    bool event(QEvent *event) override;
    void functionAfterShown();
    ...
    bool functionAfterShownCalled = false;
    ...
}

// MainWindow.cpp
bool MainWindow::event(QEvent *event)
{
    const bool ret_val = QMainWindow::event(event);
    if(!functionAfterShownCalled && event->type() == QEvent::Paint)
    {
        functionAfterShown();
        functionAfterShownCalled = true;
    }
    return ret_val;
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2017-05-03T11:53:24.623

对我来说最好的解决方案是计算一次绘制事件：

**。H**

```
public:
void paintEvent(QPaintEvent *event); 
```

**.CPP**

```
#include "qpainter.h"
#include <QMessageBox> // example

int contPaintEvent= 0;

void Form2::paintEvent(QPaintEvent* event)
{
  if (contPaintEvent ==0 )
  {
  QPainter painter(this); 
  QMessageBox::information(this, "title", "1 event paint"); // example
  // actions
  contPaintEvent++;
  }
} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-10-24T07:49:31.147

像这样重新实现方法`void show()`：

```
void MainWindow::show()
{
    QMainWindow::show();
    // Call your special function here.
} 
```

# javascript - 如何更改一个可见性 在同一页面中使用 javascript 标记？

> ID：14356124
> 
> 赞同：9
> 
> 时间：2013-01-16T10:22:45.103
> 
> 标签：javascript, html, css, css-transitions

我正在研究一个简单的javascript代码。

***根据条件，我应该将标签的可见性从隐藏更改为可见。***

我应该单独使用javascript。没有 jQuery 或 AJAX。请有任何想法或建议。

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-01-16T10:26:20.977

## 使用`visibility`属性：

显示 div `id="yourID"`：

```
document.getElementById("yourID").style.visibility = "visible"; 
```

隐藏它：

```
document.getElementById("main").style.visibility = "hidden"; 
```

## 使用`display`属性：

显示：

```
document.getElementById("yourID").style.display= "block"; 
```

隐藏：

```
document.getElementById("yourID").style.display= "none"; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-16T10:33:45.580

```
<div id="contentDiv">
    This is the content .
</div> 
```

如果您想使用 javascript 更改 id="contentDiv" 的 div 的可见性，那么您可以使用 ..

```
var eleDiv = document.getElementById("contentDiv");

    // based on condition you can change visibility
if(eleDiv.style.display == "block") {
        eleDiv.style.display = "none";
}
else {
    eleDiv .style.display = "block";
} 
```

希望这段代码对你有帮助............

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-05-30T10:41:29.037

虽然要求不要用 jquery 完成，但可以这样做：`$('.my_div_tag_id').css('visibility','hidden');`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-16T10:25:08.107

可见的：

```
var elem = document.getElementById("IdOfEl");
elem.style.display="block"; 
```

隐藏：

```
var elem = document.getElementById("IdOfEl");
elem.style.display="none"; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-16T10:38:11.610

当你想显示 div 时调用这个函数。在您的细分/案例中写下该条件。

```
function showDiv() {
    document.getElementById('divId').style.display = 'block';   //  or 'inline'
} 
```

让我知道你的反馈。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-09-08T02:26:44.807

一种方法是在 JavaScript 中创建控制逻辑并将其添加到文档的“脚本”标签中。然后应用逻辑来隐藏/显示“div”元素。

我根据第 16 页的“第一个 HTML 文档”（Musciano 和 Kennedy，2002 年）创建了一个示例 HTML 文档。它在靠近顶部的“body”标签内包含一个“div”标签。ShowAndHide 函数已包含在“head”标签内的“script”标签中。ShowAndHide 的应用程序可以在接近末尾的“body”标签内的其他“script”标签中找到。

[您可以在 PDF 文档“ Show-and-Hide Control Logic: Inspired by a Question at Stack Overflow](https://www.academia.edu/40283015/Show-and-Hide_Control_Logic_Inspired_by_a_Question_at_Stack_Overflow) ”的附件中找到 HTML 示例。

**参考**

Musciano, C. 和 Kennedy, B. (2002)。HTML 和 XHTML：权威指南，第五版。加利福尼亚州塞巴斯托波尔：O'Reilly Media Inc.

# mondrian - 如何配置 mondrian olap 以使用 ehcache 来提升性能

> ID：14356126
> 
> 赞同：2
> 
> 时间：2013-01-16T10:22:48.383
> 
> 标签：mondrian

我想将 Mondrian OLAP 配置为使用 EhCache。有没有人尝试过这样做，请分享您的想法以及如何做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-25T14:46:36.940

还可以看看其中一个 CTools - CDC - Community Distributed Cache - 让您控制缓存等等。

[http://forums.pentaho.com/showthread.php?95994-CDC-Community-Distributed-Cache](http://forums.pentaho.com/showthread.php?95994-CDC-Community-Distributed-Cache)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T18:16:18.487

你应该看看 Mondrian 的[SegmentCache SPI](http://mondrian.pentaho.com/api/mondrian/spi/SegmentCache.html)。它允许您为单元数据实现自定义缓存提供程序。在默认的内存实现中有一个[可用的示例。](https://github.com/pentaho/mondrian/blob/lagunitas/src/main/mondrian/rolap/cache/MemorySegmentCache.java)

# c#-4.0 - 如何转换列表 () 到字典 () 在 C# 中使用 LINQ

> ID：14356127
> 
> 赞同：0
> 
> 时间：2013-01-16T10:22:48.903
> 
> 标签：c#-4.0

我有一个`List`，我想把它转换成一个`Dictionary`. `List`我在将 a转换为时没有任何问题，`Dictionary`但我想检查中的键`Dictionary`是否存在，如果存在我应该忽略`KeyValuePair`并继续下一个字符串。

这是示例。

```
IEnumerable<String> readlines = File.ReadAllLines("C:\Text.txt");
List<string> lines = new List<string>();
lines = readlines.ToList();
Dictionary<string, string> keyPair= new Dictionary<string, string>();         
keyPair= test.ToDictionary(s=>s.Split('=')[1], s=>s.Split('=')[0]);  
keyPair.Keys.ToList().Sort(); 
```

如果相同的键重复，则 lambda 表达式会抛出异常，我想检查该键是否存在并继续将下一个字符串转换为字典。完成键排序后，我想将字典转换回列表。有没有办法用 LINQ 做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T10:30:26.563

首先按您的键分组

看到这个问题： [使用 linq 将列表转换为字典，而不用担心重复](https://stackoverflow.com/questions/3319016/convert-list-to-dictionary-using-linq-and-not-worrying-about-duplicates)

像这样的东西应该适合你：

```
var dictionary = lines.GroupBy(s => s.Split('=')[1], x => x.Split('=')[0])
                      .ToDictionary(g => g.Key, g => g.First()); 
```

您可以根据自己的喜好更改值选择器的逻辑

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T10:35:09.100

如果您希望将结果作为列表，则没有理由将其放入字典中。

拆分键上的每个项目和组，对键上的组进行排序，然后从组中选择所需的值。如果我理解正确，您只需要每个键的第一个值：

```
List<string> lines = File.ReadAllLines(@"C:\Text.txt").ToList();
lines =
  lines.Select(x => x.Split('='))
  .GroupBy(a => a[0])
  .OrderBy(g => g.Key)
  .Select(g => g.Key + "=" + g.First()[1])
  .ToList(); 
```

# android - 如何在android中调用意图

> ID：14356133
> 
> 赞同：0
> 
> 时间：2013-01-16T10:23:08.307
> 
> 标签：android, android-intent

嗨，在我的 android 应用程序后台进程中，我需要调用我的课程的意图。但是当我通过任务管理器暂停应用程序时，我的活动被打开。请帮我解决这个问题。

这是我的代码：

```
intent = new Intent(Service.this,PushNotification.class);
intent.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
    startActivity(intent); 
```

如果我没有设置标志（new_Task）我的应用程序强制关闭，我得到了异常。这是我在 logcat 中的错误：

```
01-16 16:23:44.139: E/AndroidRuntime(18251): FATAL EXCEPTION: main
01-16 16:23:44.139: E/AndroidRuntime(18251): android.util.AndroidRuntimeException: Calling startActivity() from outside of an Activity  context requires the FLAG_ACTIVITY_NEW_TASK flag. Is this really what you want?
01-16 16:23:44.139: E/AndroidRuntime(18251):    at android.app.ContextImpl.startActivity(ContextImpl.java:847)
01-16 16:23:44.139: E/AndroidRuntime(18251):    at android.content.ContextWrapper.startActivity(ContextWrapper.java:276)
01-16 16:23:44.139: E/AndroidRuntime(18251):    at com.app.Service.MobilyzerService$ServerTask.onPostExecute(MobilyzerService.java:359)
01-16 16:23:44.139: E/AndroidRuntime(18251):    at com.app.Service.MobilyzerService$ServerTask.onPostExecute(MobilyzerService.java:1)
01-16 16:23:44.139: E/AndroidRuntime(18251):    at android.os.AsyncTask.finish(AsyncTask.java:602)
01-16 16:23:44.139: E/AndroidRuntime(18251):    at android.os.AsyncTask.access$600(AsyncTask.java:156)
01-16 16:23:44.139: E/AndroidRuntime(18251):    at android.os.AsyncTask$InternalHandler.handleMessage(AsyncTask.java:615)
01-16 16:23:44.139: E/AndroidRuntime(18251):    at android.os.Handler.dispatchMessage(Handler.java:99)
01-16 16:23:44.139: E/AndroidRuntime(18251):    at android.os.Looper.loop(Looper.java:137)
01-16 16:23:44.139: E/AndroidRuntime(18251):    at android.app.ActivityThread.main(ActivityThread.java:4441)
01-16 16:23:44.139: E/AndroidRuntime(18251):    at java.lang.reflect.Method.invokeNative(Native Method)
01-16 16:23:44.139: E/AndroidRuntime(18251):    at java.lang.reflect.Method.invoke(Method.java:511)
01-16 16:23:44.139: E/AndroidRuntime(18251):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
01-16 16:23:44.139: E/AndroidRuntime(18251):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
01-16 16:23:44.139: E/AndroidRuntime(18251):    at dalvik.system.NativeStart.main(Native Method) 
```

请指导我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T10:25:49.340

如果您想在服务中调用意图，那么

将意图称为`this.startService(intent);`

（或者）

如果您想从活动中调用意图，则将其称为 `startActivity(intent);`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T10:30:44.707

我的解决方案是

```
intent = new Intent(Service.this,PushNotification.class);
intent.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
startActivity( intent ); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T10:30:14.573

要打开`Activity`使用意图，请使用`startActivity`

代码将是

```
Intent inda = new Intent(getApplicationContext(),
NewDutyActivity.class);
inda.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
inda.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
startActivity(inda); 
```

我认为您正在尝试从 a 打开活动，`service`因为您正在尝试从不是它自身的 UI 组件启动 UI 组件，您会收到此错误。

因此，您必须添加`new task flag`您的意图。

# mysql - 使用mysql计算给定日期的组计数和总和

> ID：14356136
> 
> 赞同：0
> 
> 时间：2013-01-16T10:23:13.573
> 
> 标签：mysql, sql

我有一个存储发票数据的表。一旦它被支付`is_paid`将被标记为1

所以我要做的是获取`(where is_paid =0)`每个用户在给定日期的所有未付发票，以及每个员工的总未付金额和该期间的未付发票数量

```
SELECT
              receivable.amount,
              receivable.admission,
receivable.grouped,
              receivable.month,
              emp.name
            FROM
              receivable JOIN students ON receivable.emp_id = emp.id
where receivable.is_paid='0' 
group by receivable.emp_id
ORDER BY CAST(receivable.grouped AS UNSIGNED ) , receivable.grouped 
```

如何更改上述代码以计算给定期间的待处理发票计数、每个用户的待处理金额总和以及该期间分组的总和（用户输入日期，因此需要在此之前显示所有记录，包括那个日期）

以下是报告结构

![在此处输入图像描述](../Images/404ae7f223420146c3e94a5a53fadb41.png)

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T17:05:52.750

猜测是`month`指本月的第一天——如果你能澄清这一点，我可以写出更准确的东西。本质上，您需要使用 SUM 和 COUNT 聚合函数，并声明要作为 GROUP BY 子句的一部分返回的所有其他列：

```
SELECT
  receivable.emp_id,
  emp.name,
  receivable.grouped,
  receivable.month,
  SUM(receivable.amount) as totalAmount
  COUNT(*) as totalCount
FROM receivable 
JOIN emp ON receivable.emp_id = emp.id
WHERE receivable.is_paid='0'
  AND receivable.month = '2013-01-01'
GROUP BY receivable.emp_id, emp.name, receivable.grouped, receivable.month
ORDER BY CAST(receivable.grouped AS UNSIGNED ), receivable.grouped 
```

# php - fgetcsv - 在封闭内容中使用封闭字符

> ID：14356139
> 
> 赞同：2
> 
> 时间：2013-01-16T10:23:23.537
> 
> 标签：php, fgetcsv

我对 fgetcsv() 和附件字符有疑问。

我有这样的 CSV 行：

```
"13551","Digitaldruck "Blüte x3" ","gelb-weiss" 
```

我这样使用 fgetcsv() ：

```
 public function readCSVData($file, $delimiter, $contentDelimiter)
{
    $fp = fopen($file, 'r');

    $dataResult = array();

    while ($data = fgetcsv($fp, WDC_CSV_MAX_LINES, $delimiter, $contentDelimiter))
    {
        foreach ($data as $key=>$element)
        {
            $data[$key] = iconv("UTF-8", "ISO-8859-1//IGNORE", $element);
        }

        $dataResult[] = $data;
    }

    fclose($fp);

    return $dataResult;
} 
```

我期望得到的是：

```
[14] => Array
    (
        [0] => 13551
        [1] => Digitaldruck "Blüte x3"
        [2] => gelb-weiss
    ) 
```

但我得到的让我有点疯狂

```
 [14] => Array
    (
        [0] => 13551
        [1] => Digitaldruck Blüte x3""
        [2] => gelb-weiss
    ) 
```

如何设置我的代码，以便我可以在内容中使用附件字符？

编辑1：

我需要保证，里面的报价必须用另一个报价转义

IE：

```
"13551","Digitaldruck ""Blüte x3"" ","gelb-weiss" 
```

将导致正确的结果。

# jquery - 根据输入值将值存储在变量中

> ID：14356147
> 
> 赞同：0
> 
> 时间：2013-01-16T10:23:54.617
> 
> 标签：jquery, arrays

我有以下代码，我想做的是根据 packageid 和 categoryid 将 dataids 存储在数组 dataids 中，这两个值在 packageBtnFilter 和 categoryBtnFilter 中定义。如果它们都是 0，那么它应该返回列表中的所有 dataid。目前，如果您看到它只存储 packageids 等于 3 的所有项目的 dataids，但它不应该依赖于 packageBtnFilter 和 categoryBtnFilter。

```
var store_products = function () {
              var catalogue = new Array();
              var packageBtnFilter = $('#packages').val();
              var categoryBtnFilter = $('#categories').val();   

              $('ul.list').each(function () {
                var localproducts = new Array();
                $(this).find('li').each(function () {
                  var $itm = $(this);
                  localproducts.push({
                    'dataid': $itm.attr('data-id'),
                      'datapackage': $itm.attr('data-package'),
                      'packageid': ($itm.children('.packageid').text()),
                                      'categoryid': ($itm.children('.packageid').text())
                  });

                  catalogue.push(localproducts[localproducts.length - 1]);
                });

                var dataids = new Array();

                $(catalogue).each(function () {

                  if (this.packageid == 3) dataids.push(this.dataid);
                });

            console.log(dataids);

              });

    }

    store_products(); 
```

谢谢！

[http://jsfiddle.net/hunter/Tcwgf/1/](http://jsfiddle.net/hunter/Tcwgf/1/)

# java - Intellij IDEA：为 JPA 验证指定数据源

> ID：14356148
> 
> 赞同：50
> 
> 时间：2013-01-16T10:24:01.223
> 
> 标签：java, spring, jpa, intellij-idea

我有一个在 Intellij IDEA 中设置的小型 Web 应用程序的 Spring 项目。

它在 Hibernate 之上使用 JPA 作为持久层。数据源（MySQL）在 Spring 应用程序上下文中定义：

```
 <!-- Values are configured via the property override -->
    <bean id="myDataSource" class="org.apache.commons.dbcp.BasicDataSource" >
        <property name="driverClassName" value=""/>
        <property name="url" value=""/>
        <property name="username" value=""/>
        <property name="password" value=""/>
    </bean> 
```

实际值从属性文件中读取，并在运行时由 Spring 使用属性覆盖机制注入。

然后将数据源注入到同一应用程序上下文中的实体管理器工厂：

```
 <bean id="entityManagerFactory" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
        <property name="dataSource" ref="myDataSource"/>
    </bean> 
```

最后，实体管理器使用注解注入 DAO：

```
/**
 * Shared, thread-safe proxy for the actual transactional EntityManager
 */
@PersistenceContext
private EntityManager em; 
```

当我构建并将其部署到 Tomcat 时一切正常，但 Intellij 的 JPA 验证似乎不了解从何处获取数据源。

在我的实体中，表的名称和列的名称带有红色下划线，验证消息是“无法解析表”或“无法解析列”：

```
@Entity
@Table(name = "domain")
public class Domain extends AbstractAgendaEntity { 
```

在此示例中，它`"domain"`是无效的部分。

我已经在“数据库”工具窗口中手动配置了我的数据库，我可以在控制台中查看我的表并执行 SQL 查询。

如何告诉 Intellij 使用此数据源来解析我的 JPA 实体的表名？

* * *

## 回答 #1

> 赞同：136
> 
> 时间：2013-01-16T12:32:13.893

我终于找到了如何做到这一点。

关键是“持久性”工具窗口。显然，它在您添加 JPA 方面后可用，但它是一个单独的工具窗口。

打开它：菜单“视图”->工具窗口->持久性

在这个窗口中，您会看到您的应用程序具有不同的持久性相关元素（我看到`persistence.xml`，`entityManagerFactory`来自 Spring 上下文，`myUnit`但我不知道它来自哪里。

在这里，您可以右键单击任何元素并选择“分配数据源”。 [![在此处输入图像描述](../Images/4b832c6b8a45f4e4ff0eb10b62e90ae9.png)](https://i.stack.imgur.com/UChf5.png)

这将打开一个弹出对话框，其中包含一个小表，其中左列包含持久性元素，右列包含分配给它的数据源。您可以从那里的“数据库”窗口分配一个数据源，所以我选择了我为 MySQL DB 配置的数据源，瞧，验证错误消失了。

但是如果我输入了错误的表或列名，我仍然会得到一个错误，这非常简洁。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-01-16T11:10:40.030

首先，您必须将数据源添加到您的 IDE 中。您通常可以在右侧的“数据库”选项卡中执行此操作。您可以从代码中导入此数据源。您应该确保点击按钮刷新表格。IDEA 将加载表并使用它们进行验证。然后你必须在你的 JPA 方面设置这个数据源。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-03-08T06:41:38.840

您需要做几件事。首先，在您的项目结构配置中配置一个 Hibernate 方面。此时您可以选择您的 Hibernate 配置文件或创建一个新配置文件。然后您应该在数据库窗口（视图->工具窗口->数据库）中配置您的数据源。请记住在数据库窗口的“控制台”选项卡上设置数据库方言。最后，您需要转到 Persistence 窗口（View->Tools Window->Persistence）并将数据源添加到适当的方面。只需右键单击树中的右侧图标并选择“添加数据源”。数据源列有一个下拉菜单，其中包含您配置的所有数据源。IntelliJ 然后正确识别表。

一句话警告。从 v12.04 开始，IntelliJ 不会修改您的 Hibernate 配置文件。您仍然需要映射您的类并手动添加您的数据库详细信息。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-12-20T10:16:24.637

对于 JPA 无法解析表/列。如果一切正常并且您只是对红色错误标记感到恼火，您可以将检查设置从错误更改为警告：-

`File --> Settings --> Inspections --> JPA issues --> Unresolved database references in annotations`.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-11-17T22:43:53.463

除了像其他人提到的那样设置数据源之外，为了清除这些错误错误，在“数据库”面板中，我必须转到“设置”、“模式和表”选项卡，然后点击“information_schema”表左侧的复选框。数据库。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-16T10:26:56.717

确保您正在导入`javax.persistence.Table`并`javax.persistence.Column`在您的实体类中。

因此，在每个类的顶部检查：

```
import javax.persistence.Table;
import javax.persistence.Column; 
```

这会将正确的 JPA 注释导入到您的类中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-10-19T14:41:51.003

我正确设置了数据源，但未显示列名。在我像下面这样更改架构和目录后，一切都被正确识别。

```
@Entity
@Table(name = "stock_detail", schema = "testing", catalog = "")
public class Xyz { 
    // ... 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-11-24T15:53:51.940

由于路径因您的想法版本而异。所以从 File --> Settings 只搜索： Unresolved database references。然后做任何你认为可以的事情：取消选中验证或更改严重性标志。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-09-24T10:33:24.637

将鼠标光标停留在表名上一段时间，将出现上下文菜单，您可以在其中分配数据源。

# java - android中可调用接口的问题

> ID：14356150
> 
> 赞同：1
> 
> 时间：2013-01-16T10:24:02.650
> 
> 标签：java, android, multithreading

我创建了空白项目并尝试执行下一个代码。不幸的是，我遇到了问题：在未完成我的线程时未加载主要活动。如果不使用线程的返回值一切正常。不幸的是最终的 ExecutorService 服务；最终的未来任务；

```
 service = Executors.newFixedThreadPool(1);
    task    = service.submit(new Foo());

    try
    {
        final String str;

        // waits the 10 seconds for the Callable.call to finish.
        str = task.get();
        Log.d("VSK",str);
    }
    catch(final InterruptedException ex)
    {
        ex.printStackTrace();
    }
    catch(final ExecutionException ex)
    {
        ex.printStackTrace();
    }

    service.shutdownNow();

}
class Foo
        implements Callable<String>
{
    public String call()
    {
        try
        {
            // sleep for 10 seconds
            Thread.sleep(10 * 1000);
        }
        catch(final InterruptedException ex)
        {
            ex.printStackTrace();
        }

        return ("Hello, World!");
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T10:31:39.843

`str = task.get();`当您的可调用对象在其他线程中执行时，此行会阻塞 main thead。[通过Handler](http://developer.android.com/reference/android/os/Handler.html)从您的任务返回结果或使用[AsyncTask](http://developer.android.com/reference/android/os/AsyncTask.html)。

# c# - PagedListPager 传递额外的模型数据

> ID：14356152
> 
> 赞同：5
> 
> 时间：2013-01-16T10:24:17.297
> 
> 标签：c#, asp.net-mvc, pagedlist

我有以下模型：

```
 public class PagedClientViewModel
    {
        public int? Page { get; set; }
        public PagedList.PagedList<ClientViewModel> Clients { get; set; }               
        public bool ShowAllClients { get; set; }
    } 
```

ShowAllClients 是一个复选框，我将使用它来进一步过滤从服务器返回的客户端列表。

```
 @Html.CheckBoxFor(model => model.ShowAllClients, new { id = "ShowAllClientsCheckbox" }) 
```

这是我的寻呼机：

```
@Html.PagedListPager(Model.Clients, page => Url.Action("Index", new { Page = page }), PagedListRenderOptions.DefaultPlusFirstAndLast) 
```

寻呼机和复选框都在同一个表单上。

我遇到的问题是，当我在寻呼机控件上更改页面时，复选框始终设置为 false。发生这种情况是因为在 Index 操作中，ShowAllClients 设置为 false。

更改页面时如何保留复选框数据？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-24T11:21:12.697

我得到这个与以下工作：

```
 @Html.PagedListPager(Model.Clients, page => Url.Action("Index", new PagedClientViewModel { Page = page, ShowAllClients = Model.ShowAllClients })) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-04-11T07:16:34.757

迄今为止找到的最佳解决方案是：

```
@Html.PagedListPager(Model.Clients, page => Url.Action("Index", new { Page = page, param1="",param2="" }), PagedListRenderOptions.DefaultPlusFirstAndLast) 
```

是的，它有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-01-23T09:54:30.520

在我的例子中，模型是 PagedList.IPagedList。接下来，我使用了一个“SearchModel”，它存储在 ViewBag 中，因此可以轻松传递。我需要更新的是页码。

```
@Html.PagedListPager(Model, page =>
{
    ViewBag.SearchModel.Page = page;
    return Url.Action("Index", "Search", ViewBag.SearchModel);
}) 
```

# java - primefaces 动态手风琴未将值解析为 tabChange 列表器

> ID：14356156
> 
> 赞同：1
> 
> 时间：2013-01-16T10:24:26.627
> 
> 标签：java, javascript, primefaces

我正在尝试创建一个`accordion panel`使用 bean 动态加载的方法，并且它必须在其他 bean 上触发方法，当用户单击`tab`.Panel 创建时，该方法会被单击选项卡标题。面板创建运行良好，并且还调用了侦听器，但侦听器没有获得点击的项目标题。谁能指出我的问题或指出我这样做的正确方法。

.xhtml

```
<p:accordionPanel activeIndex="-1"  dynamic="true" cache="false"
                              value="#{beanOne.ItemList}"
                              var="item">
                <p:ajax event="tabChange" listener="#{beanTwo.onTabChange}"   />
                <p:tab title="#{item.title}">                       
                    //view other content of item
                </p:tab>
</p:accordionPanel> 
```

豆

```
public void onTabChange(TabChangeEvent event) {
    System.out.println("onTabChange :"+event.getTab().getTitle());
} 
```

*我认为这是因为面板动态加载选项卡。但是有没有其他选择？*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T11:28:40.477

最后我做到了。

我像这样更改我的 bean onTabChange 方法。它正在工作......

```
 Object o = event.getData();
    Item t = (Item) o;
    System.out.println("onTabChange :"+t.getTitle); 
```

它没有给出 tab.title，但它给出了与单击的选项卡相关的对象（项目）。

# python - wxCollapsiblePane 强制调整框架大小

> ID：14356157
> 
> 赞同：1
> 
> 时间：2013-01-16T10:24:27.513
> 
> 标签：python, user-interface, layout, wxpython, wxwidgets

我在 wxFrame 中有一个 wxCollapsiblePane 和一个 wxGrid。每次我折叠或展开 wxCollapsiblePane 时，都会调整整个框架的大小。我想要的是让 wxGrid 增长和缩小，并使框架保持相同的大小。我还注意到，虽然我明确创建了大小为 500x500 的 wxFrame，但它实际上会缩小以适应其内容。我认为这与sizer有关，但我尝试过的任何事情似乎都不会影响这一点。谁能指出我哪里出错了？到目前为止，这是我的代码。

```
import wx
import wx.grid

class Frame(wx.Frame):

    def __init__(self, *args, **kwargs):
        super(Frame, self).__init__(*args, **kwargs)
        cpane = wx.CollapsiblePane(self)
        p = cpane.GetPane()
        sz = wx.BoxSizer()
        sz.Add(wx.TextCtrl(p), 1, wx.EXPAND)
        p.SetSizer(sz)

        sizer = wx.BoxSizer(wx.VERTICAL)
        self.grid = wx.grid.Grid(self)
        self.grid.CreateGrid(5, 5)

        sizer.Add(cpane, 0, wx.EXPAND)
        sizer.Add(self.grid, 1, wx.EXPAND)
        self.SetSizer(sizer)
        self.SetAutoLayout(1)
        sizer.Fit(self)
        self.Show()

app = wx.App(False)
win = Frame(None, size=(500, 500))
win.Show()
app.MainLoop() 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-16T18:45:59.410

为了不允许 CollapsiblePane 调整框架的大小，请在创建框架时使用 wx.CP_NO_TLW_RESIZE 样式。请参阅[http://docs.wxwidgets.org/trunk/classwx_collapsible_pane.html](http://docs.wxwidgets.org/trunk/classwx_collapsible_pane.html)

Fit() 调用是缩小框架以适应内容的原因。如果您不希望发生这种情况，则不需要它。并且代码中的 SetAutoLayout 调用是多余的，因为 SetSizer 将为您打开该属性。

# c# - 设置 WPF 用户控件图标时无法识别 URI 前缀错误

> ID：14356161
> 
> 赞同：2
> 
> 时间：2013-01-16T10:24:34.440
> 
> 标签：c#, wpf, user-controls, uri

我正在创建一个 WPF 窗口并在其中加载一个用户控件，如下所示：

```
 Uri uri = new Uri("Views/ApplicationInfo.xaml", UriKind.RelativeOrAbsolute);

        UserControl versionInfoUserControl = (UserControl)Application.LoadComponent(uri);

        #region Initizalizing the Window, Winodw Proporties and Icon
        Window versionWindow = new Window();

        versionWindow.Height = 250;
        versionWindow.Width = 400;
        versionWindow.ResizeMode = ResizeMode.NoResize; 
```

现在，当我尝试添加如下应用程序图标时：

```
 versionWindow.Icon = new BitmapImage(new Uri(@"pack://application:,,component/Images/Ico.png")); 
```

我收到 URI 前缀无法识别错误。

*我是否需要使用应用程序名称更改**应用程序**，例如：

```
 versionWindow.Icon = new BitmapImage(new Uri(@"pack://MyApp.MVVM.WPF:,,component/Images/Ico.png")); 
```

即使那样我也遇到同样的错误

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-16T10:42:43.257

假设我有一个项目，其中包含一个名为 Assets 的文件夹，并且在其中有一个带有构建操作资源或嵌入式资源的 png 图像。

然后这个工作：

```
var versionWindow = new Window
                                {
                                    Height = 250,
                                    Width = 400,
                                    ResizeMode = ResizeMode.NoResize,
                                    Icon = new BitmapImage(new Uri(@"pack://application:,,,/Assets/icon.png"))
                                };

        versionWindow.Show(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-26T09:17:54.030

```
versionWindow.Icon =  BitmapFrame.Create(new Uri("pack://application:,,,/YourProjectName;component/Images/computer.ico", UriKind.RelativeOrAbsolute)) 
```

# android - android - 顶部有动态列表视图，底部有容器的对话框+ AutoSize Dialog

> ID：14356163
> 
> 赞同：0
> 
> 时间：2013-01-16T10:24:43.857
> 
> 标签：android, listview, layout, dialog, size

实际上，我想要一个在顶部和底部菜单栏显示列表视图的对话框......

我希望对话框将其大小调整为列表视图和底栏

```
<RelativeLayout 
xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:background="@drawable/bg" >

<ListView
    android:id="@+id/llList"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_above="@+id/illBottom"
    android:layout_alignParentTop="true"
    android:choiceMode="multipleChoice" >
</ListView>

<com.actionbarsherlock.internal.widget.IcsLinearLayout
    android:id="@+id/illBottom"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_alignParentBottom="true"
    android:paddingLeft="4dip"
    android:paddingRight="4dip" >

    ...

</com.actionbarsherlock.internal.widget.IcsLinearLayout> 
```

将列表视图设置为上方`illBottom`且将 LinearLayout 设置为无相对位置，列表视图未显示...按照我的方式设置，使对话框始终为最大尺寸（ListView 的 wrap_content 不起作用...）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T10:42:33.130

也许内置列表会为您完成：

```
AlertDialog.Builder builder = new AlertDialog.Builder(this);
builder.setSingleChoiceItems(.... 
```

# html - HTML5 剪贴板 API 和 Photoshop 透明像素 (PNG)

> ID：14356165
> 
> 赞同：0
> 
> 时间：2013-01-16T10:24:44.013
> 
> 标签：html, drag-and-drop, png, photoshop

我正在尝试在 Photoshop 中选择半透明纹理并将其粘贴到 HTML5 剪贴板 API 中并保持其透明度。

我只是花了很多时间研究这个。一段时间以来，我在制作原型时使用 Photoshop 复制半透明纹理（目标为 Axure RP）。

现在，我尝试在 html 5 中使用新的剪贴板 API。我剖析了此过程生成的 PNG 文件。

如果我使用矩形选框通过剪贴板 API 将半透明纹理复制到浏览器，它会将 alpha 字节设置为 FF（完全不透明）。

如果我使用拖放 API 将“另存为 Web”PNG 24 文件复制到浏览器，它会按预期工作并且透明像素工作（并且 alpha 字节不会强制为 FF）。

我尝试了许多不同的文件格式，例如 24 位深度、更改图层的透明度、填充等。

注意：尽管 Photoshop 说它是 24 位的，但它实际上仍将其导出为 8 位（以及一大堆无用的文本数据）。

**有谁知道是否有一种解决方法可以使用剪贴板 API 将 Photoshop 剪贴板选择进入浏览器，以便保留 alpha 值？**

提前致谢...

更新：-我使用的是 Chrome 版本 24.0.1312.56 m

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T07:49:32.810

根据我的理解，您需要粘贴当前保存在剪贴板中的Photoshop规范吗？目前，剪贴板 API 规范不完整，其最新更新的工作草案（2012 年 2 月 23 日）。[如果我们看一下规范](http://www.w3.org/TR/clipboard-apis/ "剪贴板 API 和事件")的第 10 节：这些是强制性的 mime 类型：

```
text/plain
text/uri-list
text/csv
text/css
text/html
application/xhtml+xml
image/png
image/jpg
image/gif
image/svg+xml
application/xml, text/xml
application/javascript
application/json 
```

您的问题取决于您使用的浏览器，如果它实现了该功能并支持 Photoshop，那么您也许可以这样做。

[1] [http://www.w3.org/TR/clipboard-apis/#introduction](http://www.w3.org/TR/clipboard-apis/#introduction)

# facebook - Facebook 游戏白屏，跨多款游戏系统化

> ID：14356166
> 
> 赞同：0
> 
> 时间：2013-01-16T10:24:43.883
> 
> 标签：facebook, screen

我的一些玩家在 Facebook 关闭我们的应用程序以获取我们错过的更新时看到白屏，现在无法让白屏消失。我一直在搜索，我在许多其他 Facebook 游戏支持论坛上发现了类似的关于此白屏的提及，但没有好的答案。这是我通过振铃器尝试修复它的客户的评论。我在其他游戏论坛上看到过相同的评论。这里要指出的主要一点是，如果他使用他妻子的 FB 登录，我们的游戏可以正常运行，相同的计算机/浏览器，一切正常。这让我相信 Facebook 正在追赶他们。我现在唯一能想到的，对于受白屏影响的玩家来说，就是删除应用再重新安装。

“此时已完成以下工作：清除浏览器历史记录。清除 Flash 缓存。在 FB 中启用安全浏览。这些都不能解决问题。但这里有一些有趣的事情：我使用从未玩过老虎机故事的朋友帐户登录。该应用程序加载得很好。但是在我的帐户上，什么都没有。从其他用户过去的评论中，他们也做了同样的事情。我想你需要看看为什么如果它会从同一台计算机上的新 FB 帐户加载浏览器，然后浏览器历史记录、闪存缓存和互联网安全设置与问题无关！！”

如果有人对为什么我们的游戏可以在同一台计算机上的不同 Facebook 帐户上运行有任何见解，请告诉我。另外，请让我知道告诉我的所有玩家该做什么，因为我们已经尝试了一切！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T19:53:36.313

我的用户报告说删除并重新安装 Facebook 应用程序可以修复白屏。此外，他们所有的硬币/级别都被保存了。

# php - 选择查询 - 选择父权限

> ID：14356171
> 
> 赞同：1
> 
> 时间：2013-01-16T10:24:55.343
> 
> 标签：php, mysql

我需要您的帮助来编写查询 - 请参阅下面的表格结构

**类别**

```
CREATE TABLE IF NOT EXISTS `category` (
  `catid` varchar(170) NOT NULL,
  `name` varchar(170) NOT NULL,
  `parent_catid` varchar(170) NOT NULL,
  `inherit_parent_perms` enum ('Y', 'N') NOT NULL,
  KEY `idx_wss` (`catid`)
);
INSERT INTO `category` VALUES('1', 'Fruits', '0', 'N');
INSERT INTO `category` VALUES('2', 'Apples', '1', 'N');
INSERT INTO `category` VALUES('3', 'Furniture', '0', 'N');
INSERT INTO `category` VALUES('4', 'Toys', '0', 'N');
INSERT INTO `category` VALUES('5', 'Gifts', '4', 'Y'); 
```

和一个权限表

**权限**

```
CREATE TABLE IF NOT EXISTS `permissions` (
  `catid` varchar(170) NOT NULL,
  `permission_object` enum ('seller', 'buyer') NOT NULL,
  `permission_object_id` varchar(170) NOT NULL,
  KEY `idx_wss` (`catid`)
);

INSERT INTO `permissions` VALUES('1', 'seller', '100'); -- Here category 1 is accessible to 'seller' object with ID 100
INSERT INTO `permissions` VALUES('1', 'buyer', '300');  -- Here category 1 is accessible to 'buyer' object with ID 300

INSERT INTO `permissions` VALUES('2', 'buyer', '200');  -- Here category 2 is accessible to 'buyer' object with ID 200

INSERT INTO `permissions` VALUES('3', 'buyer', 'all');  -- Here category 3 is accessible to all 'buyer' objects
INSERT INTO `permissions` VALUES('3', 'seller', 'all'); -- Here category 3 is accessible to all 'seller' objects 
```

如您所见，在权限表中如何引用类别表，并且当对象 id 设置为“全部”时，可以通过具有 id 的对象类型或所有对象类型访问类别

这是我到目前为止的查询

```
SELECT id, name, p. *
FROM `catalogue` c
LEFT JOIN permissions p ON p.cat = c.catid
AND (
        (
            (
                p.permission_object_id = 'all'
                OR p.permission_object_id = '100'
            )
                AND p.permission_object = 'seller'
        )
        OR 
        (
            (
                p.permission_object_id = 'all'
                OR p.permission_object_id = '100'
            )
                AND p.permission_object = 'buyer'
        )
    )
WHERE catid = 3 
```

**问题**

以上查询类型的作品 - 例如，如果买家 ID 100 可以访问类别 3 - 它会显示其下的内容。如果此类别允许买家 ID 为“全部”，则任何买家都可以看到此类别。

但问题是当我有子类别时。因此，如果“全部”可以访问类别 3，然后我添加两个子类别 4 和 5（在类别 3 下）并告诉它从父类别继承权限 4 和子类别 5 只能由“卖家”ID 200 访问- 那我不明白在这里做什么。

*   当标记为继承父权限时，我是否需要复制所有父权限并作为新行插入（显然带有新的类别 ID）......或者......我可以以某种方式使用相同的查询并对其进行一些更改（其中我不知道该怎么做）。

*   对上述内容的任何其他更改/建议将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T11:38:02.673

这只会处理一个级别的子类别，即如果您将子类别添加到类别 4 和 5，它将不起作用。

如果我正确理解了您的问题，它应该可以帮助您开始：

```
-- Assuming category 5 is a sub-category of category 3 and has inherit_parent_perms='Y'

select *
from
(
-- select permisssions for this category
SELECT c.catid, c.name, p.permission_object,p.permission_object_id
FROM `category` c
LEFT JOIN `permissions` p ON p.catid = c.catid
where c.catid = 5
union
-- select permissions from parent category if it exists
SELECT c.catid, c.name, p.permission_object,p.permission_object_id
FROM `category` c
inner join `category` parent on c.parent_catid = parent.catid and c.inherit_parent_perms='Y'
LEFT JOIN `permissions` p ON p.catid = parent.catid
WHERE c.catid = 5
) all_perms
WHERE (
        (
            (
                all_perms.permission_object_id = 'all'
                OR all_perms.permission_object_id = '100'
            )
                AND all_perms.permission_object = 'seller'
        )
        OR 
        (
            (
                all_perms.permission_object_id = 'all'
                OR all_perms.permission_object_id = '100'
            )
                AND all_perms.permission_object = 'buyer'
        )
    ); 
```

# cakephp - 使用 CakePHP 只缓存和压缩一些 CSS 文件

> ID：14356172
> 
> 赞同：1
> 
> 时间：2013-01-16T10:24:55.307
> 
> 标签：cakephp, iis-6

我想尽可能地加快我的 Web 应用程序的速度，我正在考虑缓存 CSS 文件以及一些 JS 文件的可能性，并且可能对其中的一些文件进行一些压缩。

我只想缓存一些文件，因为其他文件可能会受到不断修改的影响，并且用户总是需要最新版本来浏览网站。

我一直在看这篇文章： [如何在 CakePHP2 中缓存静态内容（css、图像、js 文件）？](https://stackoverflow.com/questions/6681869/how-to-cache-static-content-css-images-js-files-in-cakephp)

除了这个： [CakePHP 缓存控制资产文件（图像、CSS 等）](https://stackoverflow.com/questions/1181074/cakephp-cache-control-for-asset-files-images-css-etc?rq=1)

但它会缓存所有文件。有没有办法只缓存一些文件或避免缓存它们的列表？

我在 Windows 2003 Server 和 IIS 6 上使用 CakePHP2.0。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T17:11:53.717

只需将时间戳或随机字符串添加到您不想缓存的那些。

```
/css/something.css?random_string 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T06:57:21.763

我写了一个 CakePHP Combinator 插件，它完全符合你的要求：[https ://github.com/joshuapaling/CakePHP-Combinator-Plugin](https://github.com/joshuapaling/CakePHP-Combinator-Plugin)

您可以合并所有文件——即使是经常更改的文件，因为帮助程序会自动检测文件何时更改，并创建一个新的缓存版本。但是，如果出于某种原因您只想缓存一些文件，那也很容易。它还可以压缩 CSS 和 JS。

另一种选择是 Mark Story 的资产压缩插件：[https ://github.com/markstory/asset_compress](https://github.com/markstory/asset_compress)

Mark 的插件有更多的功能，比如内置 LESS 和 CoffeeScript 支持——但它涉及的更多。我的更简单，更容易。

# forms - 在 Symfony2 的表单类型中使用自定义服务

> ID：14356173
> 
> 赞同：6
> 
> 时间：2013-01-16T10:24:57.780
> 
> 标签：forms, symfony, service, dependency-injection, doctrine-orm

在我的 Symfony2 项目中，我需要在数据库中生成现有表的列表。由于在我的项目中并不是所有的表都被用作实体，而且列表本身需要是一个简单的数组而不是一个实体，所以我为此编写了一个 sql 语句。此 sql 语句嵌入在自定义服务的函数中（并且已经过彻底测试）。

现在，在表单类型中，我想用上述函数的结果数组填充一个字段。这些成为用户可以选择的选项。

我的问题是如何以我的表单类型访问服务？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-24T10:16:00.080

有一个简单的解决方案，它是纯 OOP，没有特定于框架的配置。只需使用构造函数手动将您的服务实例注入您的表单类型实例：

```
class SomeType extends AbstractType
{
    private $provider;

    public function __construct(DataBaseTableNameProvider $provider)
    {
        $this->provider = $provider;
    }

    public function buildForm(FormBuilder $builder, array $options)
    {
         $builder->add('tables', 'choices', array(
             'choices' => $this->provider->getTableNames(),
         ));
    }
} 
```

然后，在您的控制器中，例如：

```
public function newAction()
{
     $form = $this->createForm(new SomeType($this->get('table_name_provider'));

     // more stuff
} 
```

完全一样可以使用框架配置来完成，遵循[http://symfony.com/doc/2.0/cookbook/form/create_custom_field_type.html#creating-your-field-type-as-a-service](http://symfony.com/doc/2.0/cookbook/form/create_custom_field_type.html#creating-your-field-type-as-a-service)。

唯一的区别是它关心使用 DIC 实例化您的类型，并注入正确的依赖项。然后，您只需要修改您的控制器：

```
public function newAction()
{
     $form = $this->createForm('some_type_alias');

     // more stuff
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-10-21T18:57:12.670

表单类型的翻译服务访问示例：

您的表单类型类：

```
class TaskType extends AbstractType {
    ....
    public function setDefaultOptions(OptionsResolverInterface $resolver) {
        $resolver->setDefaults(array(
            't' => 'Symfony\Bundle\FrameworkBundle\Translation\Translator',
        ));
    }  

    public function buildForm(FormBuilderInterface $builder, array $options) {
        $t = $options['t'];
        $t->trans('string to translate');
        ....
    } 
```

控制器：

```
public function someAction() { 
    $form = $this->createForm(new TaskType(), 
                                $task, 
                                array('t' => $this->get('translator'))); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-08-26T16:27:09.137

[Symfony 最佳实践](http://symfony.com/doc/current/best_practices/forms.html#registering-forms-as-services)：

> 您还可以将表单类型注册为服务。仅当您的表单类型需要容器注入一些依赖项时才需要这样做，否则会产生不必要的开销，因此不建议对所有表单类型类执行此操作。

```
# src/AppBundle/Resources/config/services.yml
services:
    app.form.type.gender:
        class: AppBundle\Form\Type\ SomeType
        arguments:
            - "@app.table_name_provider"
        tags:
            - { name: form.type } 
```

```
$form = $this->createForm(SomeType::class) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-04-21T10:54:29.780

Symfony 3.X 的更新，您现在有两个选择...

# 通过选项发送服务

```
public function configureOptions(OptionsResolver $resolver)
{
    $resolver->setRequired('option_key');
} 
```

然后通过控制器传递

```
$form = $this->createForm(XXXType::class, $entity, array(
    'option_key' => $this->get('service_you_want_to_call')
)); 
```

# 将表单定义为服务

此选项更简洁 IMO，您不必在任何调用表单的地方发送选项

```
class XXXType extends AbstractType
{
    private $service;

    public function __construct(ServiceType $service)
    {
        $this->service = $service;
    } 
```

然后在配置中定义服务

```
services:
    app.form.type.XXX:
        class: AppBundle\Form\XXXType
        arguments: ['@service_you_want_to_call']
        tags:
            - { name: form.type } 
```

每次你用

`$this->createForm(XXXType::class, $data, $options)`

Symfony 将足够聪明，知道它必须使用该服务参数（它知道它是因为 form.type 标记），因此您不再需要将任何数据传递给构造函数。

[Symfony 文档：如何从表单内部访问服务或配置](http://symfony.com/doc/current/form/form_dependencies.html)

# visual-studio - 在 AfterBuild 事件中访问强名称密钥 (pfk) 密码

> ID：14356178
> 
> 赞同：5
> 
> 时间：2013-01-16T10:25:03.847
> 
> 标签：visual-studio, msbuild, strong-named-key

如果使用受密码保护的 pfk 对程序集进行强名称签名，是否可以访问 AfterBuild 节点中用于密钥的密码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-11-03T19:57:22.997

不，不可能获得密码。

# javascript - 切换列表和网格视图

> ID：14356184
> 
> 赞同：1
> 
> 时间：2013-01-16T10:25:15.497
> 
> 标签：javascript, jquery, listview, gridview

我使用 jQuery 制作了一个简单的切换列表/网格视图。我的问题是我怎样才能使这个代码，即 jQuery 更有效（更好的编码）？这是一些基于我在项目中的代码的虚拟代码：

HTML：

```
<div class="toggle-view">
  <span class="list l-active">List view</span>
  <span class="grid">Grid view</span>
</div>

<ul id="listing-view">
  <li>Listing Block</li>
  <li>Listing Block</li>
  <li>Listing Block</li>
  <li>Listing Block</li>
  <li>Listing Block</li>
  <li>Listing Block</li>
  <li>Listing Block</li>
  <li>Listing Block</li>
</ul> 
```

CSS：

```
.toggle-view span {
  color: #00804e;
  cursor: pointer;
}

.toggle-view .l-active {
  color: #c4c3c1;
  cursor: auto;
}

.list-view li {
  width: 100%
}

.grid-view li {
  float: left;
  width: 50%;
} 
```

jQuery：

```
$('.toggle-view span').on('click', function() {
  if ($(this).hasClass('grid')) {
    $('#listing-view').addClass('grid-view');
    $('.toggle-view span').addClass('l-active');
    $('.toggle-view span.list').removeClass('l-active');
  } else if ($(this).hasClass('list')) {
    $('#listing-view').removeClass('grid-view');
    $('.toggle-view span').addClass('l-active');
    $('.toggle-view span.grid').removeClass('l-active');
  }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T13:12:31.967

看到这个...

```
$('.toggle-view span').on('click', function() {
  if ($(this).hasClass('grid')) {
    $('#listing-view').addClass('grid-view');
    $('.toggle-view .list').removeClass('l-active');
  } else {
    $('#listing-view').removeClass('grid-view');
    $('.toggle-view .grid').removeClass('l-active');
  }
  $(this).addClass('l-active');
}); 
```

问候。

# java - 需要一个递归函数来处理数组

> ID：14356187
> 
> 赞同：0
> 
> 时间：2013-01-16T10:25:32.157
> 
> 标签：java, arrays, recursion

我需要为递归函数编写代码，该函数实际上对数组进行操作并将数组划分为两个新数组，根据特定条件（例如，使用条件函数 X）大小不等。之后，该函数继续对每个新创建的数组进行操作，直到每个数组仅包含一个元素。你能帮我写一个实际上可以做到这一点的代码吗？我对我需要做什么给出了一个粗略的想法。：

```
recursive_function func1 (array) {
    conditional_function X();
    creates, array1[] and array2[]
    perform the same on each of array1 and array2
    until all arr
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T10:36:50.097

您可以使用[System.arrayCopy](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/System.html#arraycopy%28java.lang.Object,%20int,%20java.lang.Object,%20int,%20int%29)来执行此操作

前任：

```
import com.greytip.common.utils.StringUtils;

public class Test {
    public static void main(String[] args) {
        Object[] array = new Object[11];
        for (int i = 0; i < array.length; i++) {
            array[i] = i;

        }
        recursive(array);
    }

    private static void recursive(Object[] array) {
        if (array == null || array.length < 2) {
            System.out.println("return: " + StringUtils.join(array));
            return;
        }

        int pos = x(array);

        Object[] part1 = new Object[pos];
        Object[] part2 = new Object[array.length - pos];
        System.out.println("array : " + StringUtils.join(array)
                + ", part1: 0.." + pos + ", part2: " + part1.length + ".."
                + part2.length);

        System.arraycopy(array, 0, part1, 0, part1.length);
        System.arraycopy(array, part1.length, part2, 0, part2.length);

        recursive(part1);
        recursive(part2);

    }

    private static int x(Object[] array) {
        return array.length / 2;
    }
} 
```

# php - 如何配置 php RAR Archive 安装程序窗口

> ID：14356188
> 
> 赞同：1
> 
> 时间：2013-01-16T10:25:36.237
> 
> 标签：php

```
<?php $rar_arch = RarArchive::open('filename.rar'); if ($rar_arch === FALSE)
die("Failed opening file");
$entries = $rar_arch->getEntries(); if ($entries === FALSE)
die("Failed fetching entries");
echo "Found " . count($entries) . " extract\location";
if (empty($entries))
die("No valid entries found.");
$stream = reset($entries)->getStream();
if ($stream === FALSE)
die("Failed opening first file");
$rar_arch->close();
echo "Content of first one follows:\n";
echo stream_get_contents($stream);
fclose($stream); ?> 
```

[http://php.net/manual/en/rar.installation.php](http://php.net/manual/en/rar.installation.php)

错误是：

```
Fatal error: Class 'RarArchive' not found in C:\Zend\Apache2\htdocs\CSV\example.php on line 2 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T10:27:54.307

这里有 Windows 二进制文件：http: [//pecl.php.net/package/rar](http://pecl.php.net/package/rar)

如果您打开您提供的链接，然后单击您获得该页面的第一行中的“http://pecl.php.net/package/rar”链接。

之后把`.dll`你的php扩展目录和把线

```
extension=php_rar.dll 
```

给你的`php.ini`

PS：我假设的名称`.dll`是`php_rar.dll`。将其相应地更改为下载的存档中分发的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-01-19T01:39:30.493

除了下载正确的 dll 并将其放入 ext 文件夹，在 php.ini 中配置它，您还必须安装`PEAR`.

PHP_RAR 依赖于 PEAR。有关更多信息，请参阅[此](https://pecl.php.net/package/rar)。[您可以通过此链接](http://pear.php.net/manual/en/installation.getting.php)安装 PEAR 。

如果您在 windows 中安装 pear，请记住使用具有管理员权限的命令行工具。

# jquery - 在 django 中使用 $post 时出现 CSRF 错误

> ID：14356197
> 
> 赞同：0
> 
> 时间：2013-01-16T10:25:55.937
> 
> 标签：jquery, django, post, csrf

我最近发布了一个类似的问题。我在 django 应用程序中使用 $post jquery 表单时遇到问题。它显示 403 错误。

在我[之前的帖子](https://stackoverflow.com/questions/14334901/jquery-post-request-is-not-working-in-django)中，通过提供的答案，我缩小了可能的错误范围，并帮助我找到了一个有类似问题的[帖子。](https://stackoverflow.com/questions/5100539/django-csrf-check-failing-with-an-ajax-post-request)

那个帖子的作者和我有同样的问题。但是，投票最多的答案对我不起作用。相反，这样做的是这个：

```
//Everything works if I add the 
//"csrfmiddlewaretoken: '{{ csrf_token }}'"
//in the data sent to the server.

function test_post(){ 
  $.post("/xhr_test/", {
      name: "Monty",
      food: "Spam",
      csrfmiddlewaretoken: '{{ csrf_token }}'
  },
      function(data) {
          alert(data);
      }

  ); 
}; 
```

虽然它有效，但我不喜欢这个解决方案，因为我必须将“csrfmiddlewaretoken”添加到我发送的所有字符串中。

我想了解为什么投票最多的解决方案对我不起作用，因为我认为它是一个更优雅的解决方案。也就是说，添加这些代码行：

```
$.ajaxSetup({ 
     beforeSend: function(xhr, settings) {
         function getCookie(name) {
             var cookieValue = null;
             if (document.cookie && document.cookie != '') {
                 var cookies = document.cookie.split(';');
                 for (var i = 0; i < cookies.length; i++) {
                     var cookie = jQuery.trim(cookies[i]);
                     // Does this cookie string begin with the name we want?
                 if (cookie.substring(0, name.length + 1) == (name + '=')) {
                     cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                     break;
                 }
             }
         }
         return cookieValue;
         }
         if (!(/^http:.*/.test(settings.url) || /^https:.*/.test(settings.url))) {
             // Only send the token to relative URLs i.e. locally.
             xhr.setRequestHeader("X-CSRFToken", getCookie('csrftoken'));
         }
     } 
}); 
```

我认为它必须与“（！（/^http：.*/.test（settings.url）”部分有关。可能需要在那里改变一些东西，但不确定是什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T11:58:13.000

首先，确保您的 cookie 已启用，这是因为在此方法中，csrftoken 是从 cookie 值中获取的，而不是从模板中获取的。

然后，尝试在 Chrome 开发控制台中粘贴 get_cookie 函数的代码，然后尝试 getCookie('csrftoken')。

如果它返回一个 csrftoken，那么 cookie 就在那里。

接下来，您需要确保那里调用了 ajaxSetup 的代码。在该行之前放置一个`debugger`语句，如下所示：

```
 debugger 
 if (!(/^http:.*/.test(settings.url) || /^https:.*/.test(settings.url))) { 
```

并单步执行代码以查看它是否正确设置了标题。

尝试官方文档中的那个可能是个好主意。

# kendo-ui - 如何根据数据渲染 KendoUI 列

> ID：14356205
> 
> 赞同：0
> 
> 时间：2013-01-16T10:26:24.050
> 
> 标签：kendo-ui

我正在尝试根据列数据呈现客户 html。如果 IsHavingPromotion = true，则说显示“促销图片”。

或者根据检索到的值渲染星级图像。我如何使用 KendoUI 模板做到这一点？

```
 .Columns(columns =>
                {
                    columns.Bound(r => r.Id).Hidden(true);
                    columns.Bound(r => r.Name);
                    columns.Bound(r => r.GuestNumberMax).ClientTemplate("suitable for <strong>#= GuestNumberMax #</strong> pax");
                    columns.Bound(r => r.Description);
                    columns.Bound(r => r.IsHavingPromotion).ClientTemplate("# RenderIsHavingPromotion(this, IsHavingPromotion) #");
                }) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T11:29:43.220

*'或根据检索到的值渲染星级图像'*，从哪里检索？基本上你可以使用外部 JavaScript 函数来处理你的模板：

```
columns.Bound(r => r.IsHavingPromotion).ClientTemplate("#=RenderIsHavingPromotion(data)#");

<script>
    function RenderIsHavingPromotion(model){
          if(model.IsHavingPromotion){
              return '<img src="/promoted.png"/>';
          }else{
              //you other logic
          }
     }
</script> 
```

我希望你明白了。

# ruby-on-rails - 在 Rails 3 中不呈现默认应用程序布局

> ID：14356207
> 
> 赞同：2
> 
> 时间：2013-01-16T10:26:38.667
> 
> 标签：ruby-on-rails, ruby, layout, default

我是 Rails 的入门开发人员，我正在对使用 Ruby 1.8.7 和 Rails 3.0.3 开发的应用程序进行系统研究。在我的应用程序中，我有一个带有**application.html.erb**布局的 application_controller 和一个**带有**home_html.erb**布局的****home_controller**以及 CRUD 视图。然后在我的**routes.rb**中，默认路由设置如下，以及家庭的资源丰富的路由。

**根 :to => 'home#index'**

**资源：首页**

在**application.html.rb**中，我们有要呈现的默认布局，需要使用**<%= yield %>**插入其他视图。但我有另一个布局，称为**home.html.erb ，其内容与****application.html.erb**的内容相同。当我运行应用程序时，默认布局是从**home.html.erb**而不是**application.html.erb**加载的。可能是什么原因？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-16T10:30:04.463

在你的控制器中写

```
 class TetsController < ApplicationController
      layout "layout_name"
      #...
    end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T10:31:28.847

默认情况下，所有控制器都会调用应用程序布局，但如果您想呈现特定布局，您应该这样做

```
class HomeController < ApplicationController
   layout 'home'
end 
```

高温高压

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-16T11:39:38.537

> 默认情况下，**控制器将首先在****layouts**文件夹中查找同名的模板，如果找不到，它将呈现默认的**应用程序**布局。

在这种情况下，执行**home_controller**索引操作时，呈现的布局是**home.html.rb**以及视图内容，因为**home.html.rb**与控制器的命名格式相同。当我将其更改为**home.html.rb**时，控制器会从 layouts 文件夹中获取**application.html.rb 。**所以解决方案是，

> 只需从**views/layouts/**文件夹中删除**home.html.erb 即可。**默认情况下它会自动渲染**application.html.erb**。

 ****谢谢大家。****

# ember.js - 如何使用最新的 ember api 处理动作目标

> ID：14356208
> 
> 赞同：1
> 
> 时间：2013-01-16T10:26:42.553
> 
> 标签：ember.js

在 Ember 的最新文档中，据说动作助手将触发当前动作的方法。

```
 {{#if isExpanded}}
      <div class='body'>{{body}}</div>
      <button {{action "draw"}}>Draw</button>
    {{else}}
      <button {{action "expand"}}>Show More...</button>
    {{/if}} 
```

如何在关联视图上触发操作？我需要对视图执行一些操作，例如在画布上绘图。但是，它无法弄清楚如何获取与当前控制器关联的视图的引用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-16T10:34:18.490

`{{action draw target="view"}}`应该管用。

# c# - 事件完成后不显示消息框c#

> ID：14356210
> 
> 赞同：0
> 
> 时间：2013-01-16T10:26:43.630
> 
> 标签：c#

我们有 C# Web 应用程序，在按钮单击事件上，我们使用运行 3 小时的存储过程执行数据加载过程，在过程完成加载后，我们使用代码显示一个消息框

```
ScriptManager.RegisterStartupScript(this, this.GetType(), Guid.NewGuid().ToString(), scriptString, true);
radiobuttion.SelectedIndex = 2; 
```

Ι 如果程序在 1 小时内完成，一切正常，如果运行超过 2 小时，则页面变为无响应（不显示消息框，未更改单选按钮）。Ι 尝试调试，代码处理完所有行，完成无显示。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T10:40:18.467

假设这是一个 ASP .NET 应用程序，要么您的存储过程超时，要么 Session 在过程返回时被放弃，因此没有控件将起作用。在消息框/单选按钮操作发生之前检查您的会话状态。

# jqplot - jqplot 条形图和一些系列

> ID：14356214
> 
> 赞同：0
> 
> 时间：2013-01-16T10:26:55.360
> 
> 标签：jqplot, bar-chart

[通过使用jqplot，我想做一个这样](http://picturepush.com/public/11972509)的条形图

我确实见过前任。在[jqplot 网站上，](http://www.jqplot.com/deploy/dist/examples/)但不幸的是没有找到，非常感谢

# shell - 如何在 KornShell 脚本中搜索字符串中的特定字符？

> ID：14356216
> 
> 赞同：1
> 
> 时间：2013-01-16T10:26:58.980
> 
> 标签：shell, unix, scripting, ksh

我的 KornShell (ksh) 脚本接收命令行参数作为输入。我的任务是检查这些参数中是否包含**abc**并仅打印那些包含**abc**的参数。例如：-

```
./tree.sh rabc try qwerty 
```

输出应该是 ::

```
rabc 
```

这是我尝试过的：

```
var=$*
z=grep "abc" var
echo $z 
```

对此有任何见解吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T13:22:46.753

首先，您需要能够遍历参数。如果我们看一下`man ksh`，我们会发现以下内容：

> ```
> for vname [ in word ... ] ;do list ;done 
> ```
> 
> 每次`for`执行命令时，`vname`设置为`word`从`in word`列表中获取的下一个命令。如果`in word ...`省略，则该命令对从 1 开始设置的每个位置参数`for`执行一次（请参阅下面的参数扩展）。`do list`当列表中没有更多单词时，执行结束。

所以要获得循环，我们需要这样的东西：

```
for arg
do
    <stuff>
done 
```

在我们运行`<stuff>`时，`$arg`将是传入的参数之一。注意您需要`$`前面的部分；ksh 要求它知道使用存储在变量中的值，而不仅仅是按原样使用变量名。

接下来，我们需要确定是否`$arg`包含`abc`. 我们将使用`grep`，但请记住`grep`查看您给它的文件，或者通过它的标准输入（“stdin”）传递的任何内容。`grep "abc" var`您给出的将`grep`试图`abc`在一个名为`var`.

我们需要`$arg`进入`grep`'s stdin. 我们将使用`echo`将内容放入标准输出（“stdout”）和一个“管道”，它将一个命令的标准输入连接到另一个命令的标准输出：

```
echo "$arg" | grep abc 
```

上面会将任何内容放入`$arg`标准输入，然后`grep`仅在包含`abc`.

因此完整的脚本如下：

```
#!/bin/ksh
for arg
do
    echo "$arg" | grep abc
done 
```

这将无法正确处理参数包含换行符的情况；我会把它留给你自己解决的未来问题。

# python - 在没有新模块的情况下向 OpenERP 中的合作伙伴添加外部 ID

> ID：14356218
> 
> 赞同：6
> 
> 时间：2013-01-16T10:27:12.240
> 
> 标签：python, xml-rpc, openerp

我的问题有点复杂，我对`OpenERP`.

我有一个外部数据库和一个 OpenERP。外部的不是 PostgreSQL。我的工作是我需要同步两个数据库中的伙伴。外部的更重要。这意味着如果外部数据发生变化，OpenERP 的数据也会发生变化，但如果 OpenERP 的数据发生变化，外部数据不会发生任何变化。

*   我可以访问外部数据库，并且使用 XML RCP 我也可以访问 OpenERP。

*   我可以简单地使用 XML RCP 从外部数据库导入数据，但问题是同步。

*   我不能只插入修改后的伙伴并删除旧伙伴，
    因为我无法识别旧伙伴。

*   我需要更新它。但是我需要一个 id 来说明哪个是哪个。和外部ID。

*   据我所知，OpenERP 可以处理外部 ID。

这是如何运作的？以及如何使用它向我的 res.partner 添加外部 ID？

有人告诉我，我不能单独为此创建一个新模块，我需要使用内部 ID 作品。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-16T11:43:37.653

**简短回答**：查看 CSV 导入和导出向导的工作方式 - 导出记录会自动创建一个*外部标识符*，因此您可以重新导入相同的 CSV，并且记录将被更新而不是重新创建。

**长答案**：
OpenERP 将外部 ID 存储在`ir.model.data`表中，您可以通过设置菜单^([1](http://doc.openerp.com/v6.1/developer/03_modules_2.html#openerp.osv.orm.BaseModel.export_data))在用户界面中访问它。这个简单的表将表单中的“外部标识符”映射`module_name.record_identifier`到`(model,res_id)`指向实际表和行的对。

这些外部 ID 用于查找与某个外部源创建的记录相对应的数据库本地行：`module`通常是模块（因此是基于 - 的命名空间）或导入的 CSV 文件。

例如，外部标识符`base.EUR`映射到在数据库中保存欧元货币的数据库记录，并由`base`模块拥有。

从 6.1 版开始，OpenERP 自动为使用侧栏*导出向导***导出**的所有 OpenERP 记录创建新的外部标识符：它们被导出到名为 .csv 的 CSV 列中。*`id`*

 *如果这样的`id`列存在于通过*导入向导***导入**的 CSV 文件中，OpenERP 还将创建一个外部标识符来记住它。并且当外部标识符已经存在时，记录会更新而不是创建。

 *理论上，您所要做的就是从您的主数据库中生成一个带有额外^([第 2](http://doc.openerp.com/v6.1/developer/03_modules_2.html#openerp.osv.orm.BaseModel.import_data))`id`列的适当 CSV 文件（您甚至可以使用实际的 DB ID），然后将其导入 OpenERP。然后，您应该能够随时重新导入此 CSV 文件的更新版本。

**参考：**

*   *导入*和*导出*向导基本上调用 API 方法[export_data](http://doc.openerp.com/v6.1/developer/03_modules_2.html#openerp.osv.orm.BaseModel.export_data)和[import_data](http://doc.openerp.com/v6.1/developer/03_modules_2.html#openerp.osv.orm.BaseModel.import_data)，因此如果需要，您可以通过 XML-RPC 编写脚本。
*   模型存储外部标识符（历史上称为 XML ID ，[`ir.model.data`](http://bazaar.launchpad.net/~openerp/openobject-server/trunk/view/4763/openerp/addons/base/ir/ir_model.py#L772)因为它对应`id`于模块数据文件中 XML 记录的字段）。

* * *

^([1](http://doc.openerp.com/v6.1/developer/03_modules_2.html#openerp.osv.orm.BaseModel.export_data))在 OpenERP 6.1 中，它位于*Settings>Configuration>Sequences & Identifiers>External Identifiers*下，在 OpenERP 版本 7 中位于*Settings>Technical>Sequences & Identifiers>External Identifiers*下。

^([2](http://doc.openerp.com/v6.1/developer/03_modules_2.html#openerp.osv.orm.BaseModel.import_data))可以是任何没有点“`.`”字符的字符串：它将被存储在一个特殊的`__export__`模块命名空间中）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-17T17:31:18.197

> 每行的“id”列的内容甚至可以是外部行id？或者那个id是由OpenERP设置的？

如果 ID 不存在，则由 OpenERP 设置，否则它使用您输入的任何外部行 ID。

> 我在 7.0 中看不到 ir.model.data

ir.model.data 在 7.0 版中有 - 你是如何搜索它的？

> 也不是侧边栏导出向导。

在版本 7 中，您现在需要启用导出/导入。

[http://forum.openerp.com/forum/topic35830.html](http://forum.openerp.com/forum/topic35830.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T11:02:49.763

在 res 合作伙伴表中添加一个整数字段，用于在两个数据库上存储外部 id。当从外部服务器检索数据并添加到您的 openerp 数据库时，将外部 id 存储在本地服务器的 res 伙伴记录中，并将新创建的伙伴记录的 id 保存在外部服务器的伙伴记录中。所以下次更新外部合作伙伴记录时，我们可以在本地服务器中搜索外部 id 并更新该记录。请检查 openerp 模块 base_synchronization 并阅读代码，这将对您有所帮助。**

# android - Android & 自定义视图 & 自定义 xml 属性

> ID：14356222
> 
> 赞同：0
> 
> 时间：2013-01-16T10:27:18.480
> 
> 标签：android, xml, view, custom-controls

假设我有一个有效的自定义视图，名为**com.package.MyCustomView**（MyCustomView 扩展了 LinearLayout 或任何视图）

我可以在这样的活动布局中使用它

```
<com.package.MyCustomView
        android:id="@+id/myView"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"/> 
```

但我想要这样的东西：

```
<com.package.MyCustomView
        android:id="@+id/myView"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        MyCustomView_attribute1="100"
        MyCustomView_attribute2="fantastic"/> 
```

我在想象，如果像**android:layout_width**这样的有效 android xml 属性，关联`value (match_parent, wrap_content)`将设置在父 View 对象的特定属性上（通过使用反射或其他方式。）。我也知道命名空间的存在（那行`xmlns:android="http://schemas.android.com/apk/res/android"`：）..

在任何情况下，我都想要相同类型的东西 - 为我的视图自定义我的自定义 xml 属性......

这可能吗？如果是 - 如何？请提供一些细节

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T10:42:14.050

声明一个可样式化的资源和一些自定义属性。[安卓官方教程](http://developer.android.com/training/custom-views/create-view.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T10:31:22.153

是的，你可以像这样表演......它会起作用

```
 <com.example.application.Drawer
         xmlns:my="http://schemas.android.com/apk/res/com.example.application"
         android:id="@+id/drawer"
         android:layout_width="301dp"
         android:layout_height="wrap_content"
         my:content="@+id/content"
         my:handle="@+id/handle" > 
```

但有一件事是你应该在 src 中有上面的包

# sql - 总数 按月和年排序后的行数

> ID：14356223
> 
> 赞同：0
> 
> 时间：2013-01-16T10:27:21.613
> 
> 标签：sql, sql-server-2008

我正在处理 ac# 项目，因为我做了以下查询：

```
SELECT Sum(pric_ecolumn) 
FROM   table2 
WHERE  Datepart(mm, record_column) = @yourMonthSelected 
AND    Datepart(yy, record_column) = @yourYearSelected 
```

它返回特定月份和年份中价格列的总和。这是排序的类型，但我也想要多少行，所以除了 `sum(price_column)`SQL Server 的 which 函数之外，是否有任何函数返回我可以进行两个查询并使用它的总行数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T10:30:48.537

使用`COUNT`：

```
SELECT SUM(pric_ecolumn)  AS Total_Price,
       COUNT(*) AS Count
FROM   table2 
WHERE  Datepart(mm, record_column) = @yourMonthSelected 
AND    Datepart(yy, record_column) = @yourYearSelected 
```

# c# - 创建一个依赖于 Umbraco 母版页的“普通”ASP.NET 页面

> ID：14356224
> 
> 赞同：1
> 
> 时间：2013-01-16T10:27:21.787
> 
> 标签：c#, asp.net, umbraco

是否可以在 Umbraco 中创建一个继承主 Umbraco 母版页的普通 Web 表单页面？

我的客户需要一些复杂的功能，这些功能需要在 CMS 上下文之外的页面中完成。

我想知道是否可以从“正常”页面的构造函数中手动启动 Umbraco 上下文。目前我只是得到错误：

> 引发了“System.Web.HttpUnhandledException”类型的异常。---> System.NullReferenceException：对象引用未设置为对象的实例。在 umbraco.item..ctor(IDictionary 元素，IDictionary 属性) 在 umbraco.presentation.templateControls.ItemRenderer.GetFieldContents(Item item) 在 umbraco.presentation.templateControls.ItemRenderer.ParseMacros(Item item) 在 umbraco.presentation.templateControls.Item .OnInit(EventArgs e) 在 System.Web.UI.Control.InitRecursive(控制命名容器) 在 System.Web.UI.Control.InitRecursive(控制命名容器) 在

谢谢克里斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T17:26:57.730

您可以使用备用模板直接引用模板，而无需关联内容页面。

您可以通过以下方式引用它：

[http://www.yourdomain.com/page.aspx?altTemplate=templatename](http://www.yourdomain.com/page.aspx?altTemplate=templatename)

[http://www.yourdomain.com/page/templatename.aspx](http://www.yourdomain.com/page/templatename.aspx)

这将阻止用户删除节点。

这有帮助吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T10:40:54.067

您可以从 umbraco 母版页继承，像这样手动指定您的母版页

`MasterPageFile="../masterpages/umbracoPage.Master"`

这适用于`.aspx`您在`plugin directory`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-17T09:33:51.463

我认为您可以实现您的要求；

使页面脱离 Umbraco 控制的常用方法是使用 web.config 键 umbracoReservedUrls 和 umbracoReservedPaths - 这些是随 4.11.1 安装的键：

```
<add key="umbracoReservedUrls" value="~/config/splashes/booting.aspx,~/install/default.aspx,~/config/splashes/noNodes.aspx,~/VSEnterpriseHelper.axd" />
<add key="umbracoReservedPaths" value="~/umbraco,~/install/" /> 
```

其次，如果您的顶级母版页不包含 umbraco 项目或宏或任何内容，您可以在 Page PreInit 事件期间始终切换到母版页

```
protected void Page_PreInit(Object sender, EventArgs e)
{
    this.MasterPageFile = "/umbraco/masterpages/default.master";
} 
```

或者您可以使用@BeaverProj 概述的技术。

**编辑**

看着你的评论，我认为你可以在不进入 umbraco '上下文'的情况下获得 umbraco 数据。添加对 cms.dll 和 businesslogic.dll 的项目引用（umbraco 会将它们放在 bin 中），然后您可以在没有包装控件的情况下使用 umbraco 框架。例如内部editMacro.aspx页面直接使用框架：

```
 <asp:DropDownList OnPreRender="AddChooseList" runat="server" ID="macroPropertyType"
                    DataTextFormatString="" DataTextField='macroPropertyTypeAlias' DataValueField="id"
                    DataSource='<%# GetMacroPropertyTypes()%>' SelectedValue='<%# ((umbraco.cms.businesslogic.macro.MacroPropertyType) DataBinder.Eval(Container.DataItem,"Type")).Id %>'>
                </asp:DropDownList> 
```

# database - web2py查询显示结果

> ID：14356225
> 
> 赞同：0
> 
> 时间：2013-01-16T10:27:22.333
> 
> 标签：database, data-access-layer, web2py

我正在编写一个 web2py 查询来针对数据库运行，但它不会显示结果，因为我收到一条错误消息：Set: No tables selected...

我想知道是否有人可以帮助我解决这个问题？

我要运行查询的表是：

```
db.define_table('Flight',
    Field('FlightNum', type = 'string', length = 10, notnull = True),
    Field('PlaneID', type = 'string', length = 10, notnull = True),
    Field('DepartureLocation', type = 'string', length = 20, notnull = True),
    Field('ArrivalLocation', type = 'string', length = 20, notnull = True),
    Field('DepartureDate', type='date'),
    Field('ArrivalDate', type='date'),
    Field('DepartureTime', type = 'time'),
    Field('ArrivalTime', type = 'time')) 
```

我的查询是：

```
def displayFlights():
    tuples=db((db.Flight.DepartureLocation is request.vars.DepartureLocation)&
       (db.Flight.ArrivalLocation is request.vars.ArrivalLocation)&
       (db.Flight.DepartureDate is request.vars.DepartureDate)&
       (db.Flight.ArrivalDate is request.vars.DepartureDate)).select()
    return dict(tuples=tuples) 
```

有人可以帮我更正这个查询吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T12:42:04.843

查询必须用 构造`==`，而不是`is`：

```
db.Flight.DepartureLocation == request.vars.DepartureLocation 
```

# xna - 生成具有特殊瓷砖纹理的等距瓷砖地图

> ID：14356227
> 
> 赞同：0
> 
> 时间：2013-01-16T10:27:35.327
> 
> 标签：xna, xna-4.0

这是我在这里的第一篇文章，所以请温柔;）

我试图在 XNA 中制作平铺地图，并且我已经使用 perlin 方法随机生成我的地图，该方法生成用于平铺地面选择的灰度纹理。

我就是这样做的

```
 internal void RenderNew(int mapWidth, int mapHeight)
    {
        _mapHeigth = mapHeight;
        _mapWidth = mapWidth;

        Tiles = new Tile[_mapWidth, _mapHeigth];
        bool moveRowLeft = true;

        //Create the map array
        for (int y = 0; y < _mapHeigth; y++)
        {
            moveRowLeft = !moveRowLeft;
            for (int x = _mapWidth - 1; x >= 0; x--)
            {
                Tile t = new Tile(x, y, _mapWidth, _mapHeigth)
                    {
                        Position = new Vector2(x * tileWidth + (moveRowLeft ? tileWidth / 2 : 0), (y * tileHeight / 2))
                    };
                t.Ground = Tile.GroundType.Grass;
                Tiles[x, y] = t;
            }

        }
        //Generate the grayscaled perlinTexture
        GenerateNoiseMap(_mapWidth, _mapHeigth, ref perlinTexture, 20); 

        //Get the color for each pixel into an array from the perlintexture
        Color[,] colorsArray = TextureTo2DArray(perlinTexture);

        //Since a single pixel in the perlinTexture can be mapped to a tile in the map we can
        //loop all tiles and set the corresponding GroundType (ie texture) depending on the 
        //color(black/white) of the pixel in the perlinTexture.
        foreach (var tile in Tiles)
        {
            Color colorInPerlinTextureForaTile = colorsArray[tile.GridPosition.X, tile.GridPosition.Y];
             if (colorInPerlinTextureForaTile.R > 100)
            {
                tile.Ground = Tile.GroundType.Grass;
            }
            else if (colorInPerlinTextureForaTile.R > 75)
            {
                tile.Ground = Tile.GroundType.Sand;
            }
            else if (colorInPerlinTextureForaTile.R > 50)
            {
                tile.Ground = Tile.GroundType.Water;
            }
            else
            {
                tile.Ground = Tile.GroundType.DeepWater;
            }
        }
    } 
```

因此，我使用的纹理表包含沙子、草、水和深水的纹理。但它也包含用于创建漂亮重叠的瓷砖，即从沙子到水等。

！试图发布我的tileset图像，但我不能以防万一我是这个网站上的新人；（

所以我的问题是，我怎样才能使用重叠的瓷砖呢？我如何知道何时使用重叠瓷砖以及朝哪个方向使用？

所有瓷砖也“知道”它在所有八个方向上的相邻瓷砖（S，SE，E，NE，N，NW，W，NE）

//谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T19:22:23.833

执行此操作的一项古老技术是将您的方向分为两组：涉及跨边缘移动的方向，以及涉及跨拐角移动的方向。假设**北**对应于瓦片的顶角，则集合分别分解为序数和基数方向。

然后，您可以将每组方向表示为一个 4 位整数，其中每个位对应于一个方向。对于每个方向，如果该方向需要边缘，则将其对应位设置为**1 ，否则设置为****0**。这将为您提供一对值，范围从 0（无边缘 - 0b0000）到 15（完全边缘 - 0b1111）。

然后，这两个 4 位数字可以用作纹理列表的索引。排列列表中的每个纹理，使其索引对应于设置位的方向。例如，如果您的位顺序是 NSEW（北、南、东、西），并且您计算出南北边缘需要边缘，那么您的纹理索引将为 0b1100 或 12——因此请确保索引为 12 的纹理在图块的南北边缘显示边缘。

然后你所要做的就是绘制瓷砖的基础纹理，用瓷砖的边缘覆盖它，然后用瓷砖的边角覆盖它。

# javascript - 将日期从 02/Jan/2013 格式化为整数 yyyymmdd

> ID：14356228
> 
> 赞同：0
> 
> 时间：2013-01-16T10:27:42.147
> 
> 标签：javascript, date, datetime

我用来执行此操作的当前代码如下所示，

```
x3 = new Date(x1.value).format('yyyymmdd'); 
```

这在 Firefox、Chrome 和其他所有设备中运行良好，除了出色的 Internet Explorer。

我尝试过其他代码，例如...

```
<script>

function parseISO8601(dateStringInRange) {
    var isoExp = /^\s*(\d{4})-(\d\d)-(\d\d)\s*$/,
    date = new Date(NaN), month,
    parts = isoExp.exec(dateStringInRange);

    if(parts) {
      month = +parts[2];
      date.setFullYear(parts[1], month - 1, parts[3]);
      if(month != date.getMonth() + 1) {
        date.setTime(NaN);
      }
    }

    alert(date);
    return date;

}   

parseISO8601('2013-01-21'); 

</script> 
```

这适用于所有浏览器，但给了我这样的输出.....

```
Mon Jan 21 2013 00:00:00 GMT+0000 (GMT Standard Time) 
```

当我真的需要它看起来像这样时

```
20130121 
```

有没有人遇到过这个问题并想办法解决？？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T10:31:14.223

使用此处的函数根据您从函数返回的日期构建一个新字符串。

[https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Date)

getDate()、getMonth() 等应该是您正在寻找的

例子：

```
var toConvert = parseISO8601('2013-01-21');
var newForm = toConvert.getYear().toString()+toConvert.getMonth().toString()+toConvert.getDate().toString(); 
```

然后，如果您需要整数形式的 newForm，则只需运行 parseInt(newForm);

# xcode - 为大型游戏项目改进 XCode 4.5 的构建时间

> ID：14356235
> 
> 赞同：12
> 
> 时间：2013-01-16T10:28:02.897
> 
> 标签：xcode, compiler-construction, compilation, xcode4.5, compiler-optimization

**场景：** 我们有一个用于 iOS 游戏的 XCode 项目，其中包含大约 7000 多个文件。

只有 1000 多个文件是代码。其余的是图像、声音、关卡数据、XIB、plist、配置文件等。

它是一个通用应用程序，因此，我们为旧 iPhone、Retina iPhone、iPad 等提供了单独的资源集。我们还为 BG 图像等少量内容提供了 PNG 和 PVRTC，以充分利用不同的硬件。

**问题：**

目前该项目大约需要

**42 秒清洁（Cmd - Shift - K）**

**完全重建需要 8.3 分钟（Cmd - B）**（重建时，进度条的一半在 1 分钟内填满）

aaaand... **5 分钟 36 只运行 (Cmd - R) ??**

之后，我按下“停止”并再次单击“运行”，没有做任何其他事情。“再次**运行”需要 2 分 40 秒**

我还看到资源再次被复制，一些文件再次被构建，如进度条上方的 XCode 所示。

任何减少这些阶段时间的解决方案都受到高度赞赏。请 ？

*PS 该项目是在 XCode 3 天内启动的，每次有新的 XCode 出来时，我们都会自动更新 xcodeproj 文件。*

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-22T11:04:05.633

您正在寻找的是改善**调试**的编译和启动时间，对吗？那么为每个平台创建不同的目标呢？因此，您保留相同的代码，但仅根据您的调试设备打包资源子集用于调试目的。

为此，请继续您的实际目标，右键单击并复制。保持你的实际目标不变，它是胖的！对于新目标，假设它是 iPad Retina，转到“构建阶段”->“复制捆绑资源”并删除所有与 iPad Retina 无关的资源。对每个平台都这样做。

然后在 Xcode 的左上角，为特定设备选择好的目标。也许，您可以定义目标接受哪个设备。

如果你使用持续集成，让你的构建机器在晚上编译胖目标。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-22T11:54:33.470

如果问题的原因未知，则无法解决问题。“我的车不再启动了，有没有办法让它重新启动？”；最有可能，但前提是它当前拒绝启动的原因是已知的。这听起来有点像您希望 Xcode 中有一个名为“Build fast”的魔法开关，通过启用它，一切都会变得更快。如果有这样的开关，你不觉得它会默认启用吗？你不认为它实际上会一直启用吗？

我也想知道你为什么用“编译器”和“编译器优化”标记这个问题。根据你自己的说法，编译只需要 8.3 分钟的编译时间，那么如何进一步减少编译时间使整个过程更快呢？即使编译时间减少到零，这仍然会给您留下 7.3 分钟的构建时间。不要在错误的一端进行优化。

这就像优化代码。如果您的代码太慢，那么如果您没有将大部分时间花在代码中，那么所有优化都是毫无意义的。如果只有 0.1% 的时间花在这段代码上，那么优化一段代码以使其运行速度提高 10 倍对整体性能毫无帮助。代码优化的第一步是分析代码并找出在哪段代码上花费了多少时间。

所以为了让你的构建过程更快，第一步也是最重要的一步是找出**为什么**现在的构建时间很慢。如果没有这些知识，人们可以在这里给出的所有答案都只是猜测。一旦您确切地知道问题出在哪里，您就可以回来并准确地询问如何使这一步更快。您首先优化最慢的步骤，然后是第二慢的步骤，依此类推。

看一下 Xcode 中的构建日志

![在此处输入图像描述](../Images/efca444e85330f6d7cc198070814c26c.png)

确保选择“所有消息”，否则您只会看到警告和错误，或者只会看到错误。现在开始一个干净的构建，选择左侧弹出的新日志并继续监视该日志。您将准确地看到 Xcode 何时开始操作以及何时接近下一个操作。这应该会给您一个第一印象，哪些任务需要相当长的时间才能完成。一旦您告诉我们这些是哪些任务，我们就可以开始提出建议，您如何能够更快地完成这项任务。

# java - 如何表示布尔代数字符串？

> ID：14356236
> 
> 赞同：2
> 
> 时间：2013-01-16T10:28:05.230
> 
> 标签：java, boolean

我正在寻找一种表示布尔代数的解决方案。假设我有很多要向用户显示的 String 对象。他现在可以多选它们（`&& AND`在它们之间建立联系），也可以`|| OR`建立联系。最后的表达式也应该显示给用户。

因此，例如，如果他选择`String1, String2, String3`我要呈现`String1 && String2 && String3`。也许稍后用户应该能够构建像`(String1 || String 2) && String 3`.

我的问题是：如何跟踪字符串对象之间这些布尔选择的引用？当然我可以只创建一个字符串表达式；并始终附加他选择的内容。但是如果他取消选择一个对象呢？然后我将不得不解析整个字符串并重新评估它。

我正在寻找一些东西来保持`AND/OR`对象之间的引用，然后有一种方法来基于这些构建 String 最终表达式。

欢迎任何想法！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T10:32:41.463

听起来你只需要一个[树结构](http://en.wikipedia.org/wiki/Tree_%28data_structure%29)。每个内部节点代表一个运算符（`&&`、`||`等），每个叶节点代表一个术语。

* * *

参见：[*抽象语法树*](http://en.wikipedia.org/wiki/Abstract_syntax_tree)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T10:50:39.263

您可以通过[词法分析](http://en.wikipedia.org/wiki/Lexical_analysis)来做到这一点。Java 有许多词法生成器，例如：JavaCC、JLex 等。

或者，您可以使用诸如前置/后置计算器或堆栈计算器之类的东西来平衡括号并维护层次结构，最初它是通过[遍历“树”](http://en.wikipedia.org/wiki/Tree_traversal)并在该计算器中代替“1”-“9”数字来完成的（以字符串形式出现）您必须匹配“true”或“false”，而不是“+”、“-”二元运算符，您必须匹配并操作“and”和“or”！

正如我在之前的评论中所承诺的那样，我已经制作了一个布尔代数解析器，我认为它有效，也欢迎您分叉和贡献： [https ://github.com/sadaf2605/Java-Boolean-Algebra-Parser](https://github.com/sadaf2605/Java-Boolean-Algebra-Parser)

代码：

```
public class BooleanAlgebra {

    static final String CONST_and="And";
    static final String CONST_or="Or";
    static final String CONST_true="True";
    static final String CONST_false="False";

    public static void main(String[] args) {

        System.out.println(booleanAlgebra("False")==false);
        System.out.println(booleanAlgebra("True")==true);

        System.out.println(booleanAlgebra("False And False")==false);
        System.out.println(booleanAlgebra("True And False")==false);
        System.out.println(booleanAlgebra("True And True")==true);
        System.out.println(booleanAlgebra("False And True")==false);

        System.out.println(booleanAlgebra("(False And True)")==false);
        System.out.println(booleanAlgebra("True Or (False And True)")==true);
        System.out.println(booleanAlgebra("(True And False) And (False And True) Or True")==true);

        System.out.println(booleanAlgebra("( (True And False) Or True )")==true);

        System.out.println(booleanAlgebra("( False Or (True And (False Or True)) Or True )")==true);

    }

    static boolean booleanAlgebra(String str){
        return TrueFalse(str, false, "Or");
    }

     static boolean TrueFalse(String s,boolean b, String op){
        boolean btemp=false;
        s=s.replaceAll(" ", "");

        while(!s.isEmpty()){

            if(s.startsWith(CONST_true)){
                btemp=true;
                s=s.substring(4);
            }else if(s.startsWith(CONST_false)){
                btemp=false;
                s=s.substring(5);
            }else if(s.startsWith(CONST_and)){
                op=CONST_and;
                s=s.substring(3);
            }else if(s.startsWith(CONST_or)){
                op=CONST_or;
                s=s.substring(2);
            }else if(s.startsWith("(")){
                int end=s.indexOf(")");
                if(end>0){
                b=TrueFalse(s.substring(1, end>-1?end:1),b,op);
                s=s.substring(end);
                }
            }else{
                s=s.substring(1);
            }
            if (op.equals(CONST_and)){
                b=b&&btemp;

            }else if(op.equals(CONST_or)){
                b=b||btemp;
            }   
        }
        return b;   
    }
} 
```

# debugging - IE 10，将 css:hover 添加到选择标签时，选择标签不起作用

> ID：14356237
> 
> 赞同：0
> 
> 时间：2013-01-16T10:28:05.343
> 
> 标签：debugging, internet-explorer-10, dropdownbox, mousehover

我的页面中有一个 select html 标记，它附加了一个类：

```
<select id="sel_NavigateBy" class="selectDropDown" name="sel_NavigateBy"> 
```

问题是，如果我在课堂上使用这个额外的 CSS 悬停；

```
 .selectDropDown:hover
{
    background-color:#EBF2FA !important;   
} 
```

它完全打破了 IE 10 的选择下拉菜单。我不能选择任何东西。当我单击它时，下拉列表拒绝显示（除非我按住鼠标）。即使按住鼠标“强制”它显示，我也无法在下拉列表中选择任何内容。从开发者菜单切换到 IE 9 模式也不能解决这个问题。我认为它在 IE 10 中以不同的方式呈现选择标记。

删除上面的悬停类使 IE 10 恢复正常。截至今天，我正在使用带有 IE 10（预发布）（10.0.9200.16439）的 Win7。

这是 .selectDropDown 的普通 css 类（如果有帮助，我确实意识到使用太多 !important 标签是不好的）

```
.selectDropDown
{
    margin-top:5px !important;
    padding:0px 0px 0px 0px !important;   
    display:inline;
    vertical-align:top !important;
    font-size: 9pt;
    height:25px !important;
    z-index:1;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-04T19:32:32.200

> 我通过在 div 中设置下拉菜单并在用户将鼠标悬停在下拉菜单上时使用 jquery 更改 div 的颜色来解决了这个问题。似乎可以正常工作并使用我刚才提到的临时解决方案实现所有浏览器的“悬停”效果的目的。

# java - 如何保存由 OpenAL 操作的音频文件？

> ID：14356243
> 
> 赞同：2
> 
> 时间：2013-01-16T10:28:31.130
> 
> 标签：java, lwjgl, openal

在我当前的项目中，我需要能够操作 Wave - 文件。它们由一个录制的声音组成，该声音是匿名的。我的第一个想法是改变音高和速度，但 Java Sound API 似乎不支持这样的东西。我认为使用 Java 可以很容易地进行一些基本的声音操作......好吧，如果有其他可能性也没关系。

经过一番研究，我找到了 OpenAL Library 和相应的手册[OpenAL Programmers Guide](https://www.google.de/url?sa=t&rct=j&q=&esrc=s&source=web&cd=2&ved=0CD8QFjAB&url=http://connect.creativelabs.com/openal/Documentation/OpenAL_Programmers_Guide.pdf&ei=A3j2UJ_VMYTFtAbd3oCIDA&usg=AFQjCNEYxwmzo7QgUzRGKzuWoxBfhiKzig&sig2=wZfYsHAsnZ1I6jnnfdDFSQ&cad=rja)。到目前为止，我能够改变音高，获得 asf。甚至使用 LWJGL 添加一些小效果（JOAL 也可以）。如果我想听结果，我只需要调用：

```
AL10.alSourcePlay( int source ); 
```

但我想保存操纵的音频文件。据我了解，我需要获取数据流并使用它。在研究了手册和来源之后，看起来它会支持这样的唯一功能是：

```
ALC11.alcCaptureSamples( ALCdevice device, ByteBuffer buffer, int samples ) 
```

但到目前为止我发现的例子表明，这个函数更多地用于捕获输入流，而不是用于操纵的源。所以问题是：是否有可能保存经过处理的音频文件？如果是，那么正确的方法是什么？

# c++ - 将对象作为参数传递，改为传递对象的变量

> ID：14356244
> 
> 赞同：0
> 
> 时间：2013-01-16T10:28:31.537
> 
> 标签：c++, oop, class

语言：CPP (C++)

我不确定是否梦到了这一点，但是是否可以将类对象作为参数传递给期望不是类类型而是类中的类型的函数。

真的很好，而不是做我可以有一些规则的函数（对象->目标变量），所以我可以做

```
function(object) 
```

这将等于：

```
function(object->target_variable) 
```

有没有办法指定这种期望的行为？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T13:12:43.163

您可以在类中创建一个强制转换运算符，然后每次某个函数需要某种类型并且您提供该类的一个实例时，它将提供其成员。如果您有多个成员可能希望像这样处理（具有相同类型），则不起作用。

或者您可以重载该函数，接受对类实例的引用并使用实例成员调用原始函数。这里的缺点是您需要为每个类重载函数，或者为所有这些类创建一个共同的祖先（接口或“合同”）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T11:17:34.337

好的，这不再适合评论。如果它“基本上是一份合同”，那么就创建一个！例如：

```
struct IDeliverSDLSurface {
    virtual SDL_Surface* GetSurface() const = 0;
    virtual ~IDeliverSDLSurface() = default;
};

class A : public IDeliverSDLSurface {
    SDL_Surface* m_Surface;

    // implements IDeliverSDLSurface
    virtual SDL_Surface* GetSurface() const
    {
        return m_Surface;
    }

    // other stuff    
};

class B : public IDeliverSDLSurface { /* etc */ };

// etc. 
```

然后编写一个中间层，服务`IDeliverSDLSurface*`将表面传递给适当的“引擎”服务，例如：

```
namespace Intermediate {
    void Foo(IDeliverSDLSurface* p_Object)
    {
        // call engine's Foo
        Engine::Foo(p_Object->GetSurface());
    }

    void Bar(IDeliverSDLSurface* p_Object)
    {
        // call engine's Bar
        Engine::Bar(p_Object->GetSurface());
    }

    // etc
} 
```

可以编写一种更复杂的（半自动）调度程序，但是您明白了……在客户端，您可以调用`Intermediate`具有实现的所有类型的所有实例的函数`IDeliverSDLSurface`：

```
A tA;
Intermediate::Foo(&tA);

B tB;
Intermediate::Bar(&tB);

// etc... 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-17T13:38:24.693

正如 SvenS 指出的那样，您可以在类中创建一个强制转换运算符。这是一个转换为 const char* 的示例。这段代码在你的课上：

```
// operator to cast to a const char *
// 
operator const char *()
{
    m_pStr[m_nSize] = '\0';
    return(m_pStr);
} 
```

有关完整示例，请参见：http: [//msdn.microsoft.com/en-us/library/ts48df3y.aspx](http://msdn.microsoft.com/en-us/library/ts48df3y.aspx)

# asp.net - 如何使用 Lambda 表达式创建动态查询

> ID：14356247
> 
> 赞同：1
> 
> 时间：2013-01-16T10:28:38.153
> 
> 标签：asp.net, asp.net-mvc-3, linq, dynamic, razor

我正在使用搜索功能，我有三个文件

示例：- 姓名、州、年龄

当我选择名称并搜索时，它应该显示相关记录，

当我选择名称、状态和搜索时，我应该显示两个选定选项都包含在记录中的记录，

如果记录没有任何选定的选项，则不应显示记录，

所以为此我应该使用lambda 表达式的**动态查询**

所以请给我任何例子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T10:30:57.347

你可以这样使用，利用**Predicate Builder**

我有相同的应用程序，您可以在此处查看：[**使用 Linq 进行动态查询**](http://pranayamr.blogspot.ca/2011/04/dynamic-query-with-linq.html)

```
 var predicate = PredicateBuilder.True<employee>();

    if(!string.IsNullOrEmpty(txtAddress.Text))
        predicate = predicate.And(e1 => e1.Address.Contains(txtAddress.Text));
    if (!string.IsNullOrEmpty(txtEmpId.Text))
        predicate = predicate.And(e1 => e1.Id == Convert.ToInt32(txtEmpId.Text));
    if (!string.IsNullOrEmpty(txtDesc.Text))
        predicate = predicate.And(e1 => e1.Desc.Contains(txtDesc.Text));
    if (!string.IsNullOrEmpty(txtName.Text))
        predicate = predicate.And(e1 => e1.Name.Contains(txtName.Text));

    EmployeeDataContext edb= new EmployeeDataContext();
    var emp = edb.Employees.Where(predicate);
    grdEmployee.DataSource = emp.ToList();
    grdEmployee.DataBind(); 
```

[动态组合表达式谓词](http://www.albahari.com/nutshell/predicatebuilder.aspx)

# mysql - MySQL Regexp 是否支持 Unicode 匹配

> ID：14356248
> 
> 赞同：5
> 
> 时间：2013-01-16T10:28:42.427
> 
> 标签：mysql, regex, unicode, pattern-matching

有谁知道 Mysql 的正则表达式是否支持 unicode？我一直在做一些研究，大多数博客等似乎表明存在问题或不受支持。我想知道是否最好使用 LIKE 进行 unicode 模式匹配和 regexp 进行 ASCII 增强模式匹配？

我喜欢能够在字符串的开头或结尾搜索匹配项的想法，但是如果 regexp 不支持 unicode，那么如果我的文本是 unicode，这可能会很困难。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-16T10:35:59.180

1.  > 有谁知道 Mysql 的正则表达式是否支持 unicode？我一直在做一些研究，大多数博客等似乎表明存在问题或不受支持。

    如[正则表达式](http://dev.mysql.com/doc/en/regexp.html)中所述：

    > ### 警告
    > 
    > [`REGEXP`](http://dev.mysql.com/doc/en/regexp.html#operator_regexp)and运算符以[`RLIKE`](http://dev.mysql.com/doc/en/regexp.html#operator_regexp)字节方式工作，因此它们不是多字节安全的，并且可能会产生与多字节字符集有关的意外结果。此外，这些运算符通过字节值比较字符，即使给定的排序规则将它们视为相等，重音字符也可能不会比较相等。

2.  > 我想知道是否最好使用 LIKE 进行 unicode 模式匹配和 regexp 进行 ASCII 增强模式匹配？

    是的，那将是最好的。

3.  > 我喜欢能够在字符串的开头或结尾搜索匹配项的想法，但是如果 regexp 不支持 unicode，那么如果我的文本是 unicode，这可能会很困难。

    也可以这样做`LIKE`：

    ```
    WHERE foo LIKE 'bar%' 
    ```

    和：

    ```
    WHERE foo LIKE '%bar' 
    ```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-05-26T23:57:35.177

[*MariaDB 从 10.0.5 开始*](https://mariadb.com/kb/en/mariadb/pcre/)：

> REGEXP/RLIKE，以及新函数 REGEXP_REPLACE()、REGEXP_INSTR() 和 REGEXP_SUBSTR()，现在可以正确处理 MariaDB 支持的所有多字节字符集，包括东亚字符集（big5、gb2313、gbk、eucjp、eucjpms , cp932, ujis, euckr) 和 Unicode 字符集 (utf8, utf8mb4, ucs2, utf16, utf16le, utf32)。在早期版本的 MariaDB（和所有 MySQL 版本）中，REGEXP/RLIKE 仅适用于 8 位字符集。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-10-25T08:55:04.020

从 Mysql 8.0 开始，[支持 unicode 匹配](https://mysqlserverteam.com/new-regular-expression-functions-in-mysql-8-0/)

另请参阅有关兼容性问题[的文档](https://dev.mysql.com/doc/refman/8.0/en/regexp.html#regexp-compatibility)

# iphone - 哪种格式的 OAuth redirect_uri 在 instagram 中传递.....？

> ID：14356250
> 
> 赞同：3
> 
> 时间：2013-01-16T10:28:44.357
> 
> 标签：iphone, objective-c, ios6

我是ios的初学者。我想将 instagram 集成到我的应用程序中。我已经在 Instagram 上注册了。当我去管理客户端时，我已经通过了 OAuth redirect_uri，但它给出了错误，您必须输入以 http://、https:// 开头的绝对 URI。它是在我已经通过了完美的 uri 之类的示例.. [http://abc.com](http://abc.com)但它是返回错误。请给出适用于我的应用程序的任何建议。

# javascript - Infragistics webdropdown SelectedItemIndex 问题

> ID：14356255
> 
> 赞同：0
> 
> 时间：2013-01-16T10:29:02.530
> 
> 标签：javascript, asp.net, infragistics

我想知道当用户从 Infragistics webdropdown 删除项目时，如何将 Infragistics webdropdown SelectedItemIndex 重置为 -1 并将其值重置为初始值。我正在尝试使用客户端方法 OnBlur。我想知道，是否有更好的方法。我在下面添加了我的代码。谁能帮帮我..

```
function OnDropdownBlur(sender, args) {
            if (sender.get_currentValue() === "") {
        sender.set_currentValue("", true);
        sender.set_selectedItemIndex(-1);
    }
    else {
        sender.set_selectedItemIndex(sender.get_selectedItemIndex());
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T20:32:43.817

我假设您这样做是为了当用户从下拉列表的文本框部分删除文本时。如果是这样，那么您应该能够删除 else 条件，因为将 selectedItemIndex 设置为其当前值实际上并没有做任何事情。

请注意，默认情况下下拉菜单的初始值是下拉菜单中的第一项而不是空字符串，除非您的第一项在 TextField 中有一个空字符串。如果您希望这样做并且仍然让选定的索引像最初一样为 -1，您可以使用以下设置下拉列表的值：

```
sender.set_currentValue(sender.get_items().getItem(0).get_text(), true); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-09-09T14:20:00.347

这很简单。您可以通过索引设置 webdropdown，如下所示。

```
sender.selectItemByIndex(-1) 
```

注意：如果你想在重置后有文本“选择”，那么你应该使用

```
sender.set_currentValue('Select') 
```

# sql-server-2008 - Sql Update 查询将现有表中的列更新为具有重复值的唯一值

> ID：14356258
> 
> 赞同：0
> 
> 时间：2013-01-16T10:29:18.240
> 
> 标签：sql-server-2008

我有一个名为 Script 的现有表，其中存在许多具有唯一脚本 ID 和非唯一脚本名称的脚本。并且该表中有许多记录。现在作为我当前开发的一部分，我已经使脚本名称是唯一的。当某些主体通过 UI 上传脚本时，此表会被填充。现在对于已经存在的脚本，脚本名称列中的值重复没有限制。所以它存在许多重复记录。现在我想通过添加一些后缀来给所有现有的脚本名称，一个唯一的名称。我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T10:36:49.303

就像是：

```
declare @T table (script_id int not null IDENTITY(1,1) primary key,
                 script_name varchar(30) not null)
insert into @T (script_name) values
('a'),('b'),('c'),('d'),('b'),('a'),('e'),('c'),('b');

;with Ordered as (
    select *,
      ROW_NUMBER() OVER (PARTITION BY script_name ORDER by script_id) as rn
    from @T
)
update Ordered set script_name = script_name +
    CASE WHEN rn > 1 THEN '_' + CONVERT(varchar(10),rn) ELSE '' END

select * from @T 
```

结果：

```
script_id   script_name
----------- ------------------------------
1           a
2           b
3           c
4           d
5           b_2
6           a_2
7           e
8           c_2
9           b_3 
```

# android - 图片质量和加密

> ID：14356266
> 
> 赞同：0
> 
> 时间：2013-01-16T10:29:40.680
> 
> 标签：android, image, aes

我正在使用**AES**算法进行`encrypt`图像并在之后显示`decryption`。但解密后图像质量显着降低，

现在我想知道加密会降低图片质量吗？有什么方法可以增强它们

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T11:00:13.877

解密图像时使用的是 JPEG 格式。

JPEG 是一种有损格式，因为它对您的照片进行压缩以节省磁盘空间。这会导致质量明显下降。尝试使用 PNG 代替 JPEG，这是一种保存文件的无损格式。

# c++ - 如何在 MVS 中使用 OpenGL 绘制实时二维图形

> ID：14356275
> 
> 赞同：0
> 
> 时间：2013-01-16T10:30:28.193
> 
> 标签：c++, opengl, glut

我正在编写一个代码，它使用 comports 从硬件设备接收心音并绘制接收到的信号。我正在使用 OpenGL 绘制接收到的信号。当我收到完整的数据时，我可以进行绘图。但我希望图表随着接收到的数据的更新而更新这是我的代码：

```
 int num_samples = 100000;

long samples[100000];
DWORD        bytes_read    = 0;    // Number of bytes read from port

/* Function plotting func */
void draw( float x1, float x2, float y1, float y2, int N)
{
    float x, dx = 1.0/N; 
glPushMatrix(); /* GL_MODELVIEW is default */

glScalef(1.0 / (x2 - x1), 1.0 / (y2 - y1), 1.0);
glTranslatef(-x1, -y1, 0.0);
glColor3f(1.0, 1.0, 1.0);

glBegin(GL_LINE_STRIP); 
int k =0;
for(x = 0; x < num_samples; x += dx)
{
    glVertex2f(x, samples[k]);
    k=k+1;
}

glEnd();

glPopMatrix();

glFlush();
};

/* Redrawing func */
void redraw(void)
{
    glClearColor(0, 0, 0, 0);
    glClear(GL_COLOR_BUFFER_BIT);
    glMatrixMode(GL_MODELVIEW);
    glLoadIdentity();
    //long buf = getBuffer(samples);
    draw(0, num_samples,-693554432, 693554432, 1);
    //  draw(func, 0, 1000,0, 5000, 1);

    glutSwapBuffers();
    //glFlush();
};

/* Idle proc. Redisplays, if called. */
void idle(void)
{
    glutPostRedisplay();
};

/* Key press processing */
void key(unsigned char c, int x, int y)
{
    if(c == 27) exit(0);
};

/* Window reashape */
void reshape(int w, int h)
{
    glViewport(0, 0, w, h);
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    glOrtho(0, 1, 0, 1, -1, 1);
    glMatrixMode(GL_MODELVIEW);
};
/*
long putBuffer(long[] buffer)
{
    return buffer;
}*/

 //Main function 

int j =0;
unsigned long size = 400000;

int main(int argc, char* argv[])
{
    unsigned char INBUFFER[400000];

    char OUTBUFFER[20];
    DWORD        bytes_read    = 0;    // Number of bytes read from port
    DWORD        bytes_written = 0;    // Number of bytes written to the port
    HANDLE       comport      = NULL;  // Handle COM port
 int   bStatus;
    DCB          comSettings;          // Contains various port settings
    COMMTIMEOUTS CommTimeouts;
    strcpy(&OUTBUFFER[0], "The quick brown fox jumped over the lazy dog. \n\r\0");
    // Open COM port
    if ((comport = 
         CreateFile("\\\\.\\COM44",                // open com5:
                    GENERIC_READ | GENERIC_WRITE, // for reading and writing
                    0,                            // exclusive access
                    NULL,                         // no security attributes
                    OPEN_EXISTING,              
                    FILE_ATTRIBUTE_NORMAL,
                    NULL)) == INVALID_HANDLE_VALUE)
    {
       // cout<<"Port can't be opened"<<endl;
    }
    // Set timeouts in milliseconds
//  cout<<"Port opened"<<endl;
    //DCB dcb;
    CommTimeouts.ReadIntervalTimeout         = 0; 
    CommTimeouts.ReadTotalTimeoutMultiplier  = 0; 
    CommTimeouts.ReadTotalTimeoutConstant    = 100;
    CommTimeouts.WriteTotalTimeoutMultiplier = 0;
    CommTimeouts.WriteTotalTimeoutConstant   = 100;
    bStatus = SetCommTimeouts(comport,&CommTimeouts);
    if (bStatus != 0)
    {
        // error processing code goes here
    }
    // Set Port parameters.
    // Make a call to GetCommState() first in order to fill
    // the comSettings structure with all the necessary values.
    // Then change the ones you want and call SetCommState().
    GetCommState(comport, &comSettings);
   // memset(&dcb,0,sizeof(dcb));

    comSettings.fBinary = 1;
    comSettings.fDtrControl = DTR_CONTROL_ENABLE;
    comSettings.fRtsControl = RTS_CONTROL_ENABLE;
    comSettings.fOutxCtsFlow = 1;
    comSettings.fRtsControl = DTR_CONTROL_HANDSHAKE;

    comSettings.BaudRate = 921600;
    comSettings.StopBits = ONESTOPBIT;
    comSettings.ByteSize = 8;
    comSettings.Parity   = NOPARITY;
    comSettings.fParity  = FALSE;

    bStatus = SetCommState(comport, &comSettings);
    ofstream outdata;
     outdata.open("hsm.txt"); // opens the file
   if( !outdata ) { // file couldn't be opened
      cerr << "Error: file could not be opened" << endl;
      exit(1);
   }
    if (bStatus == 0)
    {
        // error processing code goes here
    }
    int flag = 1;
    int fl =1;
    glutInit(&argc, argv);
    glutInitWindowSize(500,500);
    glutInitWindowPosition(500,200);
    glutInitDisplayMode(GLUT_RGB | GLUT_DOUBLE);

    //glutMainLoop();

  while(flag<120)
   {

        bStatus = ReadFile(comport,   // Handle
                &INBUFFER,            // Incoming data
                size,                  // Number of bytes to read
                &bytes_read,          // Number of bytes read
                NULL);
        if (bStatus != 0)
        {
            //cout<<"Error receiving"<<endl;
        }
//  long samples[100000];

 for (int i=0; i<bytes_read; i++)
 {
    if((unsigned char)INBUFFER[i]==0x99&&(unsigned char)INBUFFER[i+4]==0x99)

    {
    samples[j] = 0x00|(unsigned char)INBUFFER[i+1]<<8|(unsigned char)INBUFFER[i+2]<<16|(unsigned char)INBUFFER[i+3]<<24;
    if(samples[j]!=0)
         {
          outdata << samples[j] <<"\n";
          j++;
         }      
    }

 } 

    flag++;
    glutCreateWindow("Graph plotter");
    glutDisplayFunc(redraw);
    glutReshapeFunc(reshape);
    glutIdleFunc(idle);
    glutMainLoop();

  }
  CloseHandle(comport);
outdata.close();

 return 0;
} 
```

基本上，当样本缓冲区更新时，图形也应该更新。但是该图是在第一次迭代中绘制的，然后什么也没有发生。谁能告诉我如何解决它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T10:52:46.567

当你调用 glutMainLoop 时，它会绘制屏幕，​​处理窗口事件，并重复调用空闲函数。由于您现在的所有空闲功能都是要求重新绘制屏幕，​​因此它不会从您的输入串行端口读取额外的样本。

您应该在`idle`调用函数时尝试从串行端口读取并填充其他示例。

# grails - 如何在不重新启动 grails 应用程序的情况下更改 .less 文件？

> ID：14356276
> 
> 赞同：3
> 
> 时间：2013-01-16T10:30:35.337
> 
> 标签：grails, less

我在我的 Grails 应用程序中使用了 lesscss-resources 插件。一切都按预期工作。但是当我对 .less 文件进行更改时，我每次都需要重新启动整个应用程序。

有没有办法让 Grails 直接重新编译这些更改？

任何帮助深表感谢。

谢谢，乌尔斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-24T16:09:38.883

根据[文档](http://grails.org/plugin/lesscss-resources)：

> 请注意，要导入的文件不是资源包的一部分，因此任何更改都不会触发资源的重建。

因此，如果您要修改的文件较少，那么您目前可能不走运。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-06T04:08:26.877

我没有在 Grails 中使用 less，但对我有用的是实际上删除了我的 cookie，用于您希望 CSS 更新的域。

# drupal - 显示节点翻译的实体参考字段

> ID：14356280
> 
> 赞同：1
> 
> 时间：2013-01-16T10:30:56.630
> 
> 标签：drupal, drupal-7, translation

在 Drupal 中，我有一个内容类型“基因测试”，它有一个实体引用字段（选择列表），我可以在其中选择内容类型“材料”的节点。材质节点都将英语设置为其源语言，但它们也被翻译成荷兰语和法语（实体翻译）。

我遇到的问题是，当我编辑界面语言设置为英语的“基因测试”类型的节点时，选择列表显示材料节点，但是当我将界面语言更改为荷兰语或法语时，列表是空的。

所以我的问题是，当我以所述语言编辑基因测试节点时，如何获取选择列表以显示内容类型材料的荷兰语或法语节点标题？

我希望我让自己清楚一点，英语不是我的第一语言。

预先感谢您的任何帮助。

顺便说一句：我正在使用 Drupal 7。

# ios - 我如何知道在 didSelectItem 的 UITabBarController 中选择了哪个 UIViewController

> ID：14356282
> 
> 赞同：1
> 
> 时间：2013-01-16T10:30:57.333
> 
> 标签：ios, objective-c

```
- (void)tabBar:(UITabBar *)tabBar didSelectItem:(UITabBarItem *)item
{

} 
```

基本上这是要求。如果放置了一个项目，我应该

做这个：

```
self.navigationItem.leftBarButtonItem=self.Reload; 
```

我需要知道用户正在选择正确的项目（#2）。数字可能会改变，但它应该对应于对象类型为 BGCRListOrMapController 的那个

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T10:59:03.767

为每个标签栏项目使用标签，并在您的选择项目功能中读取标签

```
switch(item.tag) {
case 0:
break;
case 1:
do something;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T11:11:43.890

可以拿到selectedViewController，然后测试

```
- (void)tabBarController:(UITabBarController *)tabBarController didSelectViewController:(UIViewController *)viewController;
{
  if ([viewController isKindOfClass:[BGCRListOrMapController class]) {
    viewController.navigationItem.leftBarButtonItem = self.Reload;
  }
} 
```

不要忘记将自己设置为`UITabBarController`的代表

# magento - magento 设置配置插件

> ID：14356284
> 
> 赞同：0
> 
> 时间：2013-01-16T10:31:07.350
> 
> 标签：magento

是否可以创建或者可能已经有一些扩展或文件可以在其中进行所有后端配置？例如添加/重命名商店视图、网站、设置运输方式、添加类别/产品属性、构建类别树等。

我正在处理很多 magento 项目，拥有这样的扩展对我非常有帮助，您可以在一到五个文件中添加所有配置，然后通过“Magento Connect Manager”安装它。同时，如果我可以发送带有所有需要设置的配置的 config *.zip，这对客户会有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T10:38:33.110

您可以通过创建查询来更新`core_config_data`数据库中的表来做到这一点。

包含后端下的所有`core_config_data table`设置。`System - Configuration`

这就是我在本地开发环境中导入生产数据库时所做的事情。我只是使用 sql 查询脚本更新配置设置（如 baseurl）。

# postgresql - PostgreSQL 选择连接表和一个函数

> ID：14356286
> 
> 赞同：3
> 
> 时间：2013-01-16T10:31:10.820
> 
> 标签：postgresql

我的数据库中有一个函数，它返回一个表。我想要做的是选择加入一个表格和那个功能。我看到它不能在 FROM 地方完成，但是如果我把函数放在 select 中执行的时间太长。我的 SQL 是：

```
select
    "Grades"."id",
    SUPRIMENTO_LOJA("Grades"."id", 30, 1, 1)
from
    "Grades" 
```

这需要超过 500 秒才能执行

我也试过了，但它返回一个错误

```
select
    *
from
    "Grades",
    SUPRIMENTO_LOJA("Grades"."id", 30, 1, 1) 
```

使此选择起作用的最佳方法是什么？

编辑：功能是这样的：

```
CREATE OR REPLACE FUNCTION suprimento_loja(grade_id integer, vendas_dias integer, lojaId integer, embalagem numeric(15, 4)) 
RETURNS TABLE(qtd integer, maximo integer, ultFornecedor character varying(50), 
ultCompra character varying(10), ultVenda character varying(10), classeLoja character varying(1), 
vendas integer, sugestao integer, giroLoja numeric(15, 4))
AS $$
DECLARE     
    qtde1 integer;
    vendasdiae1 integer;
    maximoe1 integer;
    ultvendae1 timestamp;
    ultcomprae1 timestamp;
    ultforne1 varchar(50);
    classee1 varchar(1);
    vendase1 integer;
    qtde2 integer;
    vendasdiae2 integer;
    maximoe2 integer;
    ultvendae2 timestamp;
    ultcomprae2 timestamp;
    ultforne2 varchar(50);
    vendase2 integer;
    qtde3 integer;
    vendasdiae3 integer;
    maximoe3 integer;
    ultvendae3 timestamp;
    ultcomprae3 timestamp;
    ultforne3 varchar(50);
    vendase3 integer;
    giroe1 numeric(15, 4);
    giroe2 numeric(15, 4);
    giroe3 numeric(15, 4);
BEGIN
    with vendas as (
    select
        sum(coalesce("quantidade", 0)) as vendas_periodo,
        "inventario_id"
    from
        "WVItens"
    where
        "WVItens"."ultimoDownload" between current_timestamp - (select to_interval(vendas_dias))
        and current_timestamp and coalesce("status", '') = ''
    group by
        "inventario_id")
    select into qtde1, vendasdiae1, maximoe1, ultvendae1, ultcomprae1, ultforne1, classee1, vendase1, giroe1
        cast("quantidadeAtual" as integer), 
        cast("vendasPorDia" as integer), 
        cast("maximoEmDias" as integer), 
            "dataUltimaVenda", 
        "dataUltimaCompra", 
        "ultimoFornecedor", 
        "classe", 
        cast(vendas_periodo as integer),
        coalesce("giro", 0)
    from 
        "Inventarios", 
        "Lojas",
        vendas
    where 
                "Inventarios"."estoque_id" = "Lojas"."estoque1_id" and 
        coalesce("Inventarios"."status", '') = '' and
        "Inventarios"."id" = vendas."inventario_id" and
        "Lojas"."id" = lojaId and 
        "grade_id" = gradeId;

    with vendas as (
    select
        sum(coalesce("quantidade", 0)) as vendas_periodo,
        "inventario_id"
    from
        "WVItens"
    where
        "WVItens"."ultimoDownload" between current_timestamp - (select to_interval(vendas_dias))
        and current_timestamp and coalesce("status", '') = ''
    group by
        "inventario_id")        
    select into qtde2, vendasdiae2, maximoe2, ultvendae2, ultcomprae2, ultforne2, vendase2, giroe2
        cast("quantidadeAtual" as integer), 
        cast("vendasPorDia" as integer), 
        cast("maximoEmDias" as integer), 
        "dataUltimaVenda", 
        "dataUltimaCompra", 
        "ultimoFornecedor", 
        cast(vendas_periodo as integer),
        coalesce("giro", 0)
    from 
        "Inventarios", 
                "Lojas",
            vendas
    where 
        "Inventarios"."estoque_id" = "Lojas"."estoque2_id" and 
        coalesce("Inventarios"."status", '') = '' and
        "Inventarios"."id" = vendas."inventario_id" and
        "Lojas"."id" = lojaId and 
        "grade_id" = gradeId;   

    with vendas as (
    select
        sum(coalesce("quantidade", 0)) as vendas_periodo,
        "inventario_id"
    from
        "WVItens"
    where
        "WVItens"."ultimoDownload" between current_timestamp - (select to_interval(vendas_dias))
        and current_timestamp and coalesce("status", '') = ''
    group by
        "inventario_id")            
    select into qtde3, vendasdiae3, maximoe3, ultvendae3, ultcomprae3, ultforne3, vendase3, giroe3
        cast("quantidadeAtual" as integer), 
        cast("vendasPorDia" as integer), 
        cast("maximoEmDias" as integer), 
        "dataUltimaVenda", 
        "dataUltimaCompra", 
        "ultimoFornecedor", 
        cast(vendas_periodo as integer),
        coalesce("giro", 0)
    from 
        "Inventarios", 
        "Lojas",
        vendas
    where 
        "Inventarios"."estoque_id" = "Lojas"."estoque2_id" and 
        coalesce("Inventarios"."status", '') = '' and
        "Inventarios"."id" = vendas."inventario_id" and
        "Lojas"."id" = lojaId and 
        "grade_id" = gradeId;   

    qtd := 0;
    IF (qtde1 is not null) THEN
        qtd := qtd + qtde1;
    END IF; 
    IF (qtde2 is not null) THEN
        qtd := qtd + qtde2;
    END IF; 
    IF (qtde3 is not null) THEN
        qtd := qtd + qtde3;
    END IF;         

    giroLoja = (giroe1 + giroe2 + giroe3) / 3;

    maximo := 0;
    IF ((maximoe1 is not null) and (vendasdiae1 is not null)) THEN
        maximo := maximo + (maximoe1 * vendasdiae1);
    END IF;
    IF ((maximoe2 is not null) and (vendasdiae2 is not null)) THEN
        maximo := maximo + (maximoe2 * vendasdiae2);
    END IF;
    IF ((maximoe3 is not null) and (vendasdiae3 is not null)) THEN
        maximo := maximo + (maximoe3 * vendasdiae3);
    END IF;

    IF (qtde1 is null) THEN
        qtde1 := 0;
    END IF; 
    IF (qtde2 is null) THEN
        qtde2 := 0;        
    END IF; 
    IF (qtde3 is null) THEN
        qtde3 := 0;        
    END IF; 
    IF (maximoe1 is null) THEN
        maximoe1 := 0;        
    END IF; 
    IF (maximoe2 is null) THEN
        maximoe2 := 0;
    END IF; 
    IF (maximoe3 is null) THEN
        maximoe3 := 0;                        
    END IF; 
    IF (vendasdiae1 is null) THEN
        vendasdiae1 := 0;                
    END IF; 
    IF (vendasdiae2 is null) THEN
        vendasdiae2 := 0;
    END IF; 
    IF (vendasdiae3 is null) THEN
        vendasdiae3 := 0;                                
    END IF; 
    IF (vendase1 is null) THEN
        vendase1 := 0;                        
    END IF; 
    IF (vendase2 is null) THEN
        vendase2 := 0;
    END IF; 
    IF (vendase3 is null) THEN
        vendase3 := 0;  
    END IF; 

    ultCompra := '';
    ultVenda := '';
    ultFornecedor := '';

    IF (ultcomprae1 is null) THEN
        IF (ultcomprae2 is null) THEN
            IF (ultcomprae3 is not null) THEN
                ultCompra := cast(extract(day from ultcomprae3) || '/' || extract(month from ultcomprae3) || '/' || extract(year from ultcomprae3) as varchar(10));
                ultFornecedor := ultforne3;
            END IF;
        ELSE
            IF ((ultcomprae3 is null) or (ultcomprae2 > ultcomprae3)) THEN
                ultCompra := cast(extract(day from ultcomprae2) || '/' || extract(month from ultcomprae2) || '/' || extract(year from ultcomprae2) as varchar(10));
                ultFornecedor := ultforne2;
            ELSE
                ultCompra := cast(extract(day from ultcomprae3) || '/' || extract(month from ultcomprae3) || '/' || extract(year from ultcomprae3) as varchar(10));
                ultFornecedor := ultforne3;
            END IF;
        END IF;
    ELSE
        IF ((ultcomprae2 is null) or (ultcomprae1 > ultcomprae2)) THEN
            IF ((ultcomprae3 is null) or (ultcomprae1 > ultcomprae3)) THEN
                ultCompra := cast(extract(day from ultcomprae1) || '/' || extract(month from ultcomprae1) || '/' || extract(year from ultcomprae1) as varchar(10));
                ultFornecedor := ultforne1;
            ELSE
                IF (ultcomprae3 is not null) THEN
                    ultCompra := cast(extract(day from ultcomprae3) || '/' || extract(month from ultcomprae3) || '/' || extract(year from ultcomprae3) as varchar(10));
                    ultFornecedor := ultforne3;             
                END IF;
            END IF;
        ELSE
            IF ((ultcomprae3 is null) or (ultcomprae2 > ultcomprae3)) THEN
                ultCompra := cast(extract(day from ultcomprae2) || '/' || extract(month from ultcomprae2) || '/' || extract(year from ultcomprae2) as varchar(10));
                ultFornecedor := ultforne2;
            ELSE
                ultCompra := cast(extract(day from ultcomprae3) || '/' || extract(month from ultcomprae3) || '/' || extract(year from ultcomprae3) as varchar(10));
                ultFornecedor := ultforne3;
            END IF;     
        END IF;
    END IF; 

    IF (ultvendae1 is null) THEN
        IF (ultvendae2 is null) THEN
            IF (ultvendae3 is not null) THEN
                ultVenda := cast(extract(day from ultvendae3) || '/' || extract(month from ultvendae3) || '/' || extract(year from ultvendae3) as varchar(10));
            END IF;
        ELSE
            IF ((ultvendae3 is null) or (ultvendae2 > ultvendae3)) THEN
                ultVenda := cast(extract(day from ultvendae2) || '/' || extract(month from ultvendae2) || '/' || extract(year from ultvendae2) as varchar(10));
            ELSE
                ultVenda := cast(extract(day from ultvendae3) || '/' || extract(month from ultvendae3) || '/' || extract(year from ultvendae3) as varchar(10));
            END IF;
        END IF;
    ELSE
        IF ((ultvendae2 is null) or (ultvendae1 > ultvendae2)) THEN
            IF ((ultvendae3 is null) or (ultvendae1 > ultvendae3)) THEN
                ultVenda := cast(extract(day from ultvendae1) || '/' || extract(month from ultvendae1) || '/' || extract(year from ultvendae1) as varchar(10));
            ELSE
                IF (ultvendae3 is not null) THEN
                    ultVenda := cast(extract(day from ultvendae3) || '/' || extract(month from ultvendae3) || '/' || extract(year from ultvendae3) as varchar(10));
                END IF;
            END IF;
        ELSE
            IF ((ultvendae3 is null) or (ultvendae2 > ultvendae3)) THEN
                ultVenda := cast(extract(day from ultvendae2) || '/' || extract(month from ultvendae2) || '/' || extract(year from ultvendae2) as varchar(10));
            ELSE
                ultVenda := cast(extract(day from ultvendae3) || '/' || extract(month from ultvendae3) || '/' || extract(year from ultvendae3) as varchar(10));
            END IF;     
        END IF;
    END IF;     

    vendas = vendase1 + vendase2 + vendase3;
    classeLoja := classee1;

    IF ((qtde1 + qtde2 + qtde3) > ((maximoe1 * vendasdiae1) + (maximoe2 * vendasdiae2) + (maximoe3 * vendasdiae3))) THEN
        sugestao := 0;
    ELSE
        sugestao := cast(((((maximoe1 * vendasdiae1) + (maximoe2 * vendasdiae2) + (maximoe3 * vendasdiae3)) - (qtde1 + qtde2 + qtde3)) + 0.4) as integer);
    END IF;

    RETURN NEXT;
END
$$ LANGUAGE plpgsql; 
```

我尝试了一些查询，但它太长了，甚至不是我需要的最终查询

```
 with suprimento as (
        with vendas as (
            select
                sum(coalesce("quantidade", 0)) as vendas_periodo,
                "inventario_id"
            from
                "WVItens"
            where
                "WVItens"."ultimoDownload" between current_timestamp - (select to_interval(30))
                and current_timestamp and coalesce("status", '') = ''
            group by
                "inventario_id")
        select
            "grade_id",
            "estoque_id",
            sum(cast("quantidadeAtual" as integer)) as "quantidade", 
            sum(cast("vendasPorDia" as integer)) as "vendasPorDia", 
            sum(cast("maximoEmDias" as integer)) as "maximoEmDias", 
            max("dataUltimaVenda") as "ultVenda", 
            max("dataUltimaCompra") as "ultCompra", 
            max("ultimoFornecedor") as "ultFornecedor", 
            sum(cast(vendas_periodo as integer)) as "vendasPeriodo",
            max(coalesce("giro", 0)) as "giro"
        from 
            "Inventarios" 
            left outer join vendas on ("Inventarios"."id" = vendas."inventario_id")
        where 
            coalesce("Inventarios"."status", '') = ''           
        group by
            "grade_id", "estoque_id") 
```

新编辑！！！

我试图只做一个查询，但它一直运行到现在（经过 800 秒），查询是：

```
WITH suprimento_loja as (
WITH suprimento as (
    WITH vendas as (
      SELECT "inventario_id"
        , SUM(coalesce("quantidade", 0)) as vendas_periodo
      FROM "WVItens" vwi
      WHERE vwi."ultimoDownload" between current_timestamp - (SELECT to_interval(30))
        AND current_timestamp
        AND coalesce("status", '') = ''
      GROUP BY "inventario_id"
    )
    SELECT
        "estoque_id",
        "grade_id",
        "classe" as classe
        , cast("quantidadeAtual" as integer) as qtd
        , cast("vendasPorDia" as integer) as vendasDia
        , cast("maximoEmDias" as integer) as maximo
        , coalesce("dataUltimaVenda", timestamp'01.01.1980') as ultVenda
        , "dataUltimaCompra" as ultCompra
        , "ultimoFornecedor" as ultForn
        , cast(vendas_periodo as integer) as vendas_periodo
        , coalesce("giro", 0) as giro
    FROM "Inventarios"  inv
    LEFT OUTER JOIN vendas ve ON inv."id" = ve."inventario_id"
    )
select
    lo."id" as id,
    e1."grade_id" as grade_id,
    e1.ultVenda,
    case
    when e1.ultVenda > coalesce(e2.ultVenda, timestamp'01.01.1980') and e1.ultVenda > coalesce(e3.ultVenda, timestamp'01.01.1980')
    then e1.ultVenda
    else
        case 
        when coalesce(e2.ultVenda, timestamp'01.01.1980') > coalesce(e3.ultVenda, timestamp'01.01.1980')
        then e2.ultVenda
        else e3.ultVenda
        end
    end as ultVenda,
    case
    when e1.ultCompra > coalesce(e2.ultCompra, timestamp'01.01.1980') and e1.ultCompra > coalesce(e3.ultCompra, timestamp'01.01.1980')
    then e1.ultCompra
    else
        case 
        when coalesce(e2.ultCompra, timestamp'01.01.1980') > coalesce(e3.ultCompra, timestamp'01.01.1980')
        then e2.ultCompra
        else e3.ultCompra
        end
    end as ultCompra,
    case
    when e1.ultCompra > coalesce(e2.ultCompra, timestamp'01.01.1980') and e1.ultCompra > coalesce(e3.ultCompra, timestamp'01.01.1980')
    then e1.ultForn
    else
        case 
        when coalesce(e2.ultCompra, timestamp'01.01.1980') > coalesce(e3.ultCompra, timestamp'01.01.1980')
        then e2.ultForn
        else e3.ultForn
        end
    end as ultForn,
    coalesce(e1.vendas_periodo, 0) + coalesce(e2.vendas_periodo, 0) + coalesce(e3.vendas_periodo, 0) as vendas_periodo,
    e1.classe,
    (coalesce(e1.maximo, 0) * coalesce(e1.vendasDia, 0)) + (coalesce(e2.maximo, 0) * coalesce(e2.vendasDia, 0)) + (coalesce(e3.maximo, 0) * coalesce(e3.vendasDia, 0)) as maximo,
    coalesce(e1.giro, 0) as giro,
    coalesce(e1.qtd, 0) + coalesce(e2.qtd, 0) + coalesce(e3.qtd, 0) as qtde,
    case
        when coalesce(e1.giro, 0) = 0
        then 0
        else
        case 
            when ((coalesce(e1.qtd, 0) + coalesce(e2.qtd, 0) + coalesce(e3.qtd, 0)) > ((coalesce(e1.maximo, 0) * coalesce(e1.vendasDia, 0)) + (coalesce(e2.maximo, 0) * coalesce(e2.vendasDia, 0)) + (coalesce(e3.maximo, 0) * coalesce(e3.vendasDia, 0))))
            then 0
            else cast(((((coalesce(e1.maximo, 0) * coalesce(e1.vendasDia, 0)) + (coalesce(e2.maximo, 0) * coalesce(e2.vendasDia, 0)) + (coalesce(e3.maximo, 0) * coalesce(e3.vendasDia, 0))) 
              - (coalesce(e1.qtd, 0) + coalesce(e2.qtd, 0) + coalesce(e3.qtd, 0))) + 0.4) as integer)
        end 
    end as sugestao
from
    "Lojas" lo
    LEFT OUTER JOIN suprimento e2 ON e2."estoque_id" = lo."estoque2_id"
    LEFT OUTER JOIN suprimento e3 ON e3."estoque_id" = lo."estoque3_id"
    JOIN suprimento e1 ON e1."estoque_id" = lo."estoque1_id")

SELECT
    gr."id",
    sl1.*,
    sl2.*,
    sl3.*,
    sl4.*,
    sl5.*,
    sl6.*
FROM
    "Grades" gr
    JOIN suprimento_loja sl1 ON sl1."grade_id" = gr."id"
    JOIN suprimento_loja sl2 ON sl2."grade_id" = gr."id"
    JOIN suprimento_loja sl3 ON sl3."grade_id" = gr."id"
    JOIN suprimento_loja sl4 ON sl4."grade_id" = gr."id"
    JOIN suprimento_loja sl5 ON sl5."grade_id" = gr."id"
    JOIN suprimento_loja sl6 ON sl6."grade_id" = gr."id"
WHERE
    sl1."id" = 1 AND
    sl2."id" = 2 AND
    sl3."id" = 3 AND
    sl4."id" = 4 AND
    sl5."id" = 5 AND
    sl6."id" = 6 
```

我使用了别名并加入，因此您可以轻松阅读

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T19:00:00.757

我让它工作，但以其他方式。如果有人遇到类似的问题，我得到的解决方案是：

```
SELECT 
    gr.id,
    max(CASE sl.id WHEN 1 THEN sl.ultVenda ELSE timestamp'01.01.1980' END) AS ultVenda_l1,
    max(CASE sl.id WHEN 2 THEN sl.ultVenda ELSE timestamp'01.01.1980' END) AS ultVenda_l2,
    max(CASE sl.id WHEN 3 THEN sl.ultVenda ELSE timestamp'01.01.1980' END) AS ultVenda_l3,
    max(CASE sl.id WHEN 4 THEN sl.ultVenda ELSE timestamp'01.01.1980' END) AS ultVenda_l4,
    max(CASE sl.id WHEN 5 THEN sl.ultVenda ELSE timestamp'01.01.1980' END) AS ultVenda_l5,
    max(CASE sl.id WHEN 6 THEN sl.ultVenda ELSE timestamp'01.01.1980' END) AS ultVenda_l6,
    max(CASE sl.id WHEN 1 THEN sl.ultCompra ELSE timestamp'01.01.1980' END) AS ultCompra_l1,
    max(CASE sl.id WHEN 2 THEN sl.ultCompra ELSE timestamp'01.01.1980' END) AS ultCompra_l2,
    max(CASE sl.id WHEN 3 THEN sl.ultCompra ELSE timestamp'01.01.1980' END) AS ultCompra_l3,
    max(CASE sl.id WHEN 4 THEN sl.ultCompra ELSE timestamp'01.01.1980' END) AS ultCompra_l4,
    max(CASE sl.id WHEN 5 THEN sl.ultCompra ELSE timestamp'01.01.1980' END) AS ultCompra_l5,
    max(CASE sl.id WHEN 6 THEN sl.ultCompra ELSE timestamp'01.01.1980' END) AS ultCompra_l6,
    max(CASE sl.id WHEN 1 THEN sl.ultForn ELSE '' END) AS ultForn_l1,
    max(CASE sl.id WHEN 2 THEN sl.ultForn ELSE '' END) AS ultForn_l2,
    max(CASE sl.id WHEN 3 THEN sl.ultForn ELSE '' END) AS ultForn_l3,
    max(CASE sl.id WHEN 4 THEN sl.ultForn ELSE '' END) AS ultForn_l4,
    max(CASE sl.id WHEN 5 THEN sl.ultForn ELSE '' END) AS ultForn_l5,
    max(CASE sl.id WHEN 6 THEN sl.ultForn ELSE '' END) AS ultForn_l6,
    max(CASE sl.id WHEN 1 THEN sl.vendas_periodo ELSE 0 END) AS vendas_periodo_l1,
    max(CASE sl.id WHEN 2 THEN sl.vendas_periodo ELSE 0 END) AS vendas_periodo_l2,
    max(CASE sl.id WHEN 3 THEN sl.vendas_periodo ELSE 0 END) AS vendas_periodo_l3,
    max(CASE sl.id WHEN 4 THEN sl.vendas_periodo ELSE 0 END) AS vendas_periodo_l4,
    max(CASE sl.id WHEN 5 THEN sl.vendas_periodo ELSE 0 END) AS vendas_periodo_l5,
    max(CASE sl.id WHEN 6 THEN sl.vendas_periodo ELSE 0 END) AS vendas_periodo_l6,
    max(CASE sl.id WHEN 1 THEN sl.maximo ELSE 0 END) AS maximo_l1,
    max(CASE sl.id WHEN 2 THEN sl.maximo ELSE 0 END) AS maximo_l2,
    max(CASE sl.id WHEN 3 THEN sl.maximo ELSE 0 END) AS maximo_l3,
    max(CASE sl.id WHEN 4 THEN sl.maximo ELSE 0 END) AS maximo_l4,
    max(CASE sl.id WHEN 5 THEN sl.maximo ELSE 0 END) AS maximo_l5,
    max(CASE sl.id WHEN 6 THEN sl.maximo ELSE 0 END) AS maximo_l6,
    max(CASE sl.id WHEN 1 THEN sl.giro ELSE 0 END) AS giro_l1,
    max(CASE sl.id WHEN 2 THEN sl.giro ELSE 0 END) AS giro_l2,
    max(CASE sl.id WHEN 3 THEN sl.giro ELSE 0 END) AS giro_l3,
    max(CASE sl.id WHEN 4 THEN sl.giro ELSE 0 END) AS giro_l4,
    max(CASE sl.id WHEN 5 THEN sl.giro ELSE 0 END) AS giro_l5,
    max(CASE sl.id WHEN 6 THEN sl.giro ELSE 0 END) AS giro_l6,
    max(CASE sl.id WHEN 1 THEN sl.qtde ELSE 0 END) AS qtd_l1,
    max(CASE sl.id WHEN 2 THEN sl.qtde ELSE 0 END) AS qtd_l2,
    max(CASE sl.id WHEN 3 THEN sl.qtde ELSE 0 END) AS qtd_l3,
    max(CASE sl.id WHEN 4 THEN sl.qtde ELSE 0 END) AS qtd_l4,
    max(CASE sl.id WHEN 5 THEN sl.qtde ELSE 0 END) AS qtd_l5,
    max(CASE sl.id WHEN 6 THEN sl.qtde ELSE 0 END) AS qtd_l6,
    max(CASE sl.id WHEN 1 THEN sl.sugestao ELSE 0 END) AS sugestao_l1,
    max(CASE sl.id WHEN 2 THEN sl.sugestao ELSE 0 END) AS sugestao_l2,
    max(CASE sl.id WHEN 3 THEN sl.sugestao ELSE 0 END) AS sugestao_l3,
    max(CASE sl.id WHEN 4 THEN sl.sugestao ELSE 0 END) AS sugestao_l4,
    max(CASE sl.id WHEN 5 THEN sl.sugestao ELSE 0 END) AS sugestao_l5,
    max(CASE sl.id WHEN 6 THEN sl.sugestao ELSE 0 END) AS sugestao_l6
FROM "Grades" gr
INNER JOIN suprimento_loja sl ON sl.grade_id = gr.id
group by gr.id
order by gr.id 
```

视图“suprimento_loja”是函数中之前使用的查询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T11:51:34.533

您现在可以做的唯一一件事是加快查询速度 - 重新制作函数以减少时间。

在 PostgreSQL 9.3 中，您将能够使用您的第二个查询变体`LATERAL`，但它不会明显更快。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T13:07:15.817

这只是编辑后的正文（未经测试，希望我没有打错字;-)：

```
WITH vendas as (
  SELECT "inventario_id"
      , SUM(coalesce("quantidade", 0)) as vendas_periodo
  FROM "WVItens" vwi
  WHERE vwi."ultimoDownload" between current_timestamp - (SELECT to_interval(vendas_dias)) AND current_timestamp
    AND coalesce("status", '') = ''
  GROUP BY "inventario_id"
)
SELECT into qtde1, vendasdiae1, maximoe1, ultvendae1, ultcomprae1, ultforne1, classee1, vendase1, giroe1
    cast("quantidadeAtual" as integer)
    , cast("vendasPorDia" as integer)
    , cast("maximoEmDias" as integer)
    , "dataUltimaVenda"
    , "dataUltimaCompra"
    , "ultimoFornecedor"
    , "classe"
    , cast(vendas_periodo as integer)
    , coalesce("giro", 0)
FROM "Inventarios" inv
JOIN "Lojas" lo ON inv."estoque_id" = lo."estoque1_id"
JOIN vendas ve ON inv."id" = ve."inventario_id"
WHERE coalesce( inv."status", '') = ''
 AND lo."id" = lojaId
 AND "grade_id" = gradeId
   ;

WITH vendas as (
  SELECT "inventario_id"
      , SUM(coalesce("quantidade", 0)) as vendas_periodo
  FROM "WVItens" vwi
  WHERE vwi."ultimoDownload" between current_timestamp - (SELECT to_interval(vendas_dias))
      AND current_timestamp
      AND coalesce("status", '') = ''
  GROUP BY "inventario_id"
)
SELECT into qtde2, vendasdiae2, maximoe2, ultvendae2, ultcomprae2, ultforne2, vendase2, giroe2
    cast("quantidadeAtual" as integer)
    , cast("vendasPorDia" as integer)
    , cast("maximoEmDias" as integer)
    , "dataUltimaVenda"
    , "dataUltimaCompra"
    , "ultimoFornecedor"
    , cast(vendas_periodo as integer)
    , coalesce("giro", 0)
FROM "Inventarios" inv
JOIN "Lojas" lo ON inv."estoque_id" = lo."estoque2_id"
JOIN vendas ve ON inv."id" = vendas."inventario_id"
WHERE coalesce( inv."status", '') = ''
  AND lo."id" = lojaId
  AND "grade_id" = gradeId
    ;

WITH vendas as (
  SELECT "inventario_id"
    , SUM(coalesce("quantidade", 0)) as vendas_periodo
  FROM "WVItens" vwi
  WHERE vwi."ultimoDownload" between current_timestamp - (SELECT to_interval(vendas_dias))
    AND current_timestamp
    AND coalesce("status", '') = ''
  GROUP BY "inventario_id"
)
SELECT into qtde3, vendasdiae3, maximoe3, ultvendae3, ultcomprae3, ultforne3, vendase3, giroe3
    cast("quantidadeAtual" as integer)
    , cast("vendasPorDia" as integer)
    , cast("maximoEmDias" as integer)
    , "dataUltimaVenda"
    , "dataUltimaCompra"
    , "ultimoFornecedor"
    , cast(vendas_periodo as integer)
    , coalesce("giro", 0)
FROM "Inventarios"  inv
JOIN "Lojas" lo ON inv."estoque_id" = lo."estoque2_id"
JOIN vendas ve ON inv."id" = vendas."inventario_id"
WHERE coalesce( inv."status", '') = ''
  AND lo."id" = lojaId
  AND "grade_id" = gradeId
    ; 
```

乍一看，您似乎在执行完全相同的查询三次，使用不同的常量，在我看来，这看起来不太合适。

# php - 验证和计算来自子类别的选定复选框值。

> ID：14356290
> 
> 赞同：0
> 
> 时间：2013-01-16T10:31:17.800
> 
> 标签：php

我创建了一个表单来显示主要类别及其子类别。这种形式的一切都是动态创建的。为什么我使用这个表单是为了获取从用户中选择的子类别值。在这里，我为此使用复选框。

这是我用于此的 PHP ..

```
echo "<input type='checkbox' value='{cId:sId}' name='subcategory{$cId}[]' />{$sName}"; 
```

然后生成类似这样的HTML...

```
<h3>Main Category 01 
    <input type='checkbox' value='3:4' name='subcategory3[]' />sub category
    <input type='checkbox' value='3:6' name='subcategory3[]' />sub category

<h3>Main Category 02 
    <input type='checkbox' value='4:6' name='subcategory4[]' />sub category
    <input type='checkbox' value='4:2' name='subcategory4[]' />sub category

<h3>Main Category 01 
    <input type='checkbox' value='5:8' name='subcategory5[]' />sub category
    <input type='checkbox' value='5:4' name='subcategory5[]' />sub category 
```

在这种情况下，您可以看到动态生成的子类别名称。（子类别 3、子类别 4、子类别 5）。这些值也可能根据所选的主要类别而改变。在这里，我想知道如何使用 ISSET() 验证子类别值。因为我不知道检测来自 $_POST 数组的值是什么。

有人可以帮我吗..

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T10:37:03.047

我建议将名称从 更改`subcategory3[]`为`subcategory[3][]`。

完成此操作后，执行`var_dump($_POST['subcategory'])`，您将看到如何发送信息，您将在单个数组中获得完整信息。

除此之外，不确定您的问题可能是什么，您能否更具体地说明您遇到问题的地方？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T10:40:26.127

使用该命名约定，您将不得不从复选框名称中解析出数字：

```
foreach($_POST as $key => $value)
{
    if(strpos($key, 'subcategory') === 0 && is_array($value))
    {
        $subCategoryNumber = substr($key, 11);

        // loop over the values for this subcategory array:
        foreach($value as $checkboxValue)
        {
            echo 'subcategory checked: ' . $subCategoryNumber . ', value: ' . $checkboxValue;
        }
    }
} 
```

取而代之的是，您可以向数组添加一个维度并使用：

```
<input type='checkbox' value='3:4' name='subcategory[3][]' />sub category

<input type='checkbox' value='4:6' name='subcategory[4][]' />sub category

<input type='checkbox' value='5:8' name='subcategory[5][]' />sub category 
```

这意味着您可以将它们`$_POST['subcategory']`作为数组访问：

```
foreach($_POST['subcategory'] as $key => $checkboxList)
{
    foreach($checkboxList as $checkboxValue)
    {
        echo 'subcategory checked: ' . $key . ', value: ' . $checkboxValue;
    }
} 
```

# xcode - Xcode用动画实现滚动

> ID：14356297
> 
> 赞同：0
> 
> 时间：2013-01-16T10:31:30.633
> 
> 标签：xcode, animation, scroll, label

如何在到达屏幕顶部之前实现滚动到其中一个标签一直保持在顶部，并且文本从另一个标签滚动超出屏幕的限制，例如在 instagramm 中，除了第二个中的照片文本标签

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-12T08:05:29.407

滚动视图

在到达屏幕顶部之前滚动到其中一个标签一直保持在顶部，并且文本从另一个标签滚动超出屏幕范围，

[http://www.youtube.com/watch?v=mws6Zbq_y6c](http://www.youtube.com/watch?v=mws6Zbq_y6c)

达里奇

# powershell - 连续四连胜游戏

> ID：14356302
> 
> 赞同：0
> 
> 时间：2013-01-16T10:31:37.600
> 
> 标签：powershell

我想出了数组，但现在我想写入我的 $CreateGrid[1,1] 的值，例如

```
Write-host "  A   B   C   D   E   F   G   H   I   J " 
Write-host "+---+---+---+---+---+---+---+---+---+---+ "
Write-host "|   |   |   |   |   |   |   |   |   |   | 1"
Write-host "+---+---+---+---+---+---+---+---+---+---+ "
Write-host "|   |   |   |   |   |   |   |   |   |   | 2"
Write-host "+---+---+---+---+---+---+---+---+---+---+ "
Write-host "|   |   |   |   |   |   |   |   |   |   | 3"
Write-host "+---+---+---+---+---+---+---+---+---+---+ "
Write-host "|   |   |   |   |   |   |   |   |   |   | 4"
Write-host "+---+---+---+---+---+---+---+---+---+---+ "
Write-host "|   |   |   |   |   |   |   |   |   |   | 5"
Write-host "+---+---+---+---+---+---+---+---+---+---+ "
Write-host "|   |   |   |   |   |   |   |   |   |   | 6"
Write-host "+---+---+---+---+---+---+---+---+---+---+ "
Write-host "|   |   |   |   |   |   |   |   |   |   | 7"
Write-host "+---+---+---+---+---+---+---+---+---+---+ "
Write-host "|   |   |   |   |   |   |   |   |   |   | 8"
Write-host "+---+---+---+---+---+---+---+---+---+---+ "
Write-host "|   |   |   |   |   |   |   |   |   |   | 9"
Write-host "+---+---+---+---+---+---+---+---+---+---+ "
Write-host "| $CreateGrid[1,1] |   |   |   |   |   |   |   |   |   | 10"
Write-host "+---+---+---+---+---+---+---+---+---+---+ " 
```

但是，当我尝试这个时，我得到以下值的输出：

```
(          System.Object[] System.Object[] System.Object[] System.Object[] System.Object[] System.Object[] System.Object[] System.Object[]             Syst
em.Object[] System.Object[]                   System.Object[]                                                 [1,1]) 
```

我将如何解决这个问题？还是有更聪明的方法？简而言之，我想在上面显示的网格中包含数组的位置值。

编辑：

```
$CreateBoard = New-object "Array[,]" 10,10

Function Add-ToColumn{
param ([Int] $columnnum,[String] $player)

    PROCESS{if (0..9 -notcontains $columnnum){"Invalid move";return}
        #0 is the bottom, 9 is the top
        for($i = 0; $i -le 9; $i++)
        {
            if ($CreateBoard[$columnnum, $i] -eq $null)
            {
                $CreateBoard[$columnnum, $i] = $player
                "Coin placed in $columnnum, $i coins in the column!"
                return
            }
        }
        #if you get here, column is full
        "Invalid move"
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T10:40:37.377

当您将表达式放在双引号字符串中时，解析器会在第一个非变量名称字符处停止。所以：

```
"$CreateGrid[1,1]" 
```

被处理就好像它是

```
"$CreateGrid" + "[1,1]" 
```

并且作为`$CreateGrid`（或至少看起来是）一个数组，它对`ToString`每个成员执行 a 并连接结果（因为这是一个二维数组，每个枚举成员都是一个数组，因此`System.Object[]`多次）。

如果您`$(...)`在字符串中使用表达式语法 ( )，则整个包含的表达式将作为 PowerShell 表达式处理（例如，您可以在其中放置一个管道）：

```
"$($CreateGrid[1,1])" 
```

# c - C printf 整数类型 U32

> ID：14356304
> 
> 赞同：0
> 
> 时间：2013-01-16T10:31:45.070
> 
> 标签：c, integer, printf

我有十六进制值`0x5a800000000b`，我正在尝试在 C 中获取 printf 语句以将其打印到控制台。

到目前为止（因为我在 C 中没用）我能够使用以下语法打印“b”：

```
printf("Hex value%x\n", value); 
```

该值存储在整数类型 U32 中，但在尝试了 %llx、%lx 的所有不同组合后，我只是不断收到编译器警告。

我猜我的 printf 语法错误，但我似乎找不到正确的 % 选项，有人可以帮帮我吗？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-16T10:35:38.667

这不是问题`printf`。

问题是 32 位变量不能保存该值`0x5a800000000b`。32 位只能保存 8 个十六进制数字：0x0000000b。因此`b`输出。

要存储这么大的值，您应该使用 64 位变量。

```
long long value = 0x5a800000000bLL 
```

`L`还要注意末尾的双倍。它告诉编译器该常量也是一个`long long`.

然后你可以`%llx`在`printf`格式字符串中使用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-16T10:36:30.613

这些类型有一些预定义的宏：

```
#include <inttypes.h>
int64_t PRId64\. PRIi64
int32_t PRId32, PRIi32
int16_t PRId16, PRIi16
int8_t PRId8, PRIi8 
```

例如：

```
printf("%"PRId32"\n", my32Int); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T10:35:51.987

值 0x5a800000000b 超过 32 位，因此您必须使用`long`.

```
long value = 0x5a800000000bl;
printf("Hex value%lx\n", value); 
```

请注意，十六进制常量应以`l`, 结尾。

# iphone - iPhone 模拟器不显示 iphone 5 兼容图像

> ID：14356306
> 
> 赞同：2
> 
> 时间：2013-01-16T10:31:49.900
> 
> 标签：iphone, ios5

关于新旧 iphone 屏幕的元素设置，我很早就遇到了许多问题和答案，并且也有了一些想法。我有一个疑问...我正在为 iphone 320X480(iPhone)、iphone 视网膜 3.5 英寸和 4 英寸视网膜屏幕准备一个应用程序。对于我想以编程方式设置的窗口（背景）实例。它必须带有标题栏。所以我到目前为止所做的检查了屏幕尺寸

```
 CGFloat screenHeight = [UIScreen mainScreen].bounds.size.height;
    if ([UIScreen mainScreen].scale == 2.f && screenHeight == 568.0f) {
       UIImageView *backgroundImage = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"Do-568h@2x.png"]];
    [self.view addSubview:backgroundImage];
    [self.view sendSubviewToBack:backgroundImage];
   } else {

    UIImageView *backgroundImage = [[UIImageView alloc] initWithImage:[UIImage imageNamed:@"Do.png"]];
    [self.view addSubview:backgroundImage];
    [self.view sendSubviewToBack:backgroundImage];
   } 
```

第一个块将检查 iphone 5 屏幕（我假设），第二个块将设置屏幕为正常和视网膜两个屏幕，我为其放置**320X480**像素图像名称 Do.png 和 640X960 图像名称**Do@2x.png**。iphone 和 iphone 3.5 (Retina) 在模拟器上显示良好，但我认为与 iPhone 5 相同的 iphone 4 (Retina) 无法正确显示。请让我知道我应该怎么做...是的，**Do-568h@2x.png**是**640X1136** ...。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T11:32:46.460

使用下面的方法来设置屏幕的大小

```
- (void)iPhoneDeviceScreenSetting {

    if(UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPhone)
    {
        CGSize result = [[UIScreen mainScreen] bounds].size;
        if(result.height == 480)
        {
            // iPhone Classic
            lowerImgVw.frame = CGRectMake(0, 395, 318, 40);
        }
        if(result.height == 568)
        {
            // iPhone 5
            lowerImgVw.frame = CGRectMake(0, 480, 318, 40);
        }
    }
} 
```

# java - tomcat：如何打开 jdbc:oracle 连接的堆栈跟踪？

> ID：14356308
> 
> 赞同：2
> 
> 时间：2013-01-16T10:31:57.100
> 
> 标签：java, apache, tomcat, profiling, dump

有一个跨多个位置运行的 Web 应用程序，
通过在 linux 上运行此命令，我可以看到许多连接堆积：

```
ps -ef|grep LOCAL 
```

向我显示具有进程 ID 的活动 oracle 连接数，并且连接数每小时增长 5-7 个。几个小时后，应用程序变慢，最终需要重新启动 tomcat 服务器。

因为，我能够看到连接在增长，有没有办法获得这些连接的来源，找出哪些类或对象创建了这些铺设的连接？

而且我没有使用 Tomcat 连接池，我尝试通过发出 kill -3 tomcat pid 来生成线程转储，但对我没有用，因为我无法理解它们，甚至尝试过线程分析器。

是否有任何简单的方法可以使用某些 tomcat 功能或通过任何其他方式来获取与这些搁置连接关联的发起者类以获得一个小提示？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T09:36:49.497

在[JProfiler](http://www.ej-technologies.com/products/jprofiler/overview.html)中，您将使用 JDBC 探针来获取打开连接的堆栈跟踪。您将在时间轴中选择连接

![在此处输入图像描述](../Images/3bcbee97540c4f5fd421f0942d10032f.png)

并跳转到事件视图

![在此处输入图像描述](../Images/666feadc9fa655d3c5d0de9fc4123d6c.png)

您可以在其中选择“连接打开”事件。在下部窗格中，显示了相关的堆栈跟踪。

免责声明：我公司开发JProfiler

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T10:57:25.313

您可以搜索`javax.sql.DataSource.getConnection()`使用 IDE 的用途。

如果您在调试模式下启动 tomcat，您可以查找连接类的实例（并看到它们增加）。此外，在构造函数上放置一个断点将在创建过程中捕获它们。

但实际上你应该使用连接池。这是解决您的问题的最简单方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T10:58:41.770

也许这两个工具可以帮助您确定是什么降低了您的服务器应用程序的性能。

[仪表](http://jmeter.apache.org/)

[ab 基准测试工具](http://httpd.apache.org/docs/2.2/programs/ab.html)

由于一些简单的实现问题，性能也可能会减慢。对于 Web 应用程序，您可能希望使用 NIO（面向缓冲区、非阻塞 IO）而不是 IO，而且您可能正在执行大量字符串连接（使用 StringBuffer）。

# grails - GroovyWS WSClient 抢先式基本身份验证

> ID：14356309
> 
> 赞同：0
> 
> 时间：2013-01-16T10:32:06.920
> 
> 标签：grails, groovy, basic-authentication, groovyws

我无法在 groovyws 中设置抢先式身份验证。（ws 提供者需要抢先身份验证。）

我尝试在 groovyws[文档](http://groovy.codehaus.org/WSClient+configuration)中查找，但没有任何线索。

```
import groovyx.net.ws.WSClient

//def proxy = new WSClient("http://202.44.4.97/webservice/pttinfo.asmx?wsdl", this.class.classLoader)
def proxy = new WSClient("http://192.168.3.69/provider/myService", this.class.classLoader)
proxy.setBasicAuthentication('user', 'pass')

proxy.initialize() 
```

下面是一个错误。

```
Caused by: java.io.IOException: Server returned HTTP response code: 405 for URL: http://192.168.3.69/provider/myService 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T11:43:10.660

你试过[`groovy-wslite`](https://github.com/jwagenleitner/groovy-wslite)吗？它在GroovyWS[的文档中说：](http://groovy.codehaus.org/GroovyWS)

> 由于可用性低，该项目目前处于休眠状态，您可以考虑将 groovy-wslite 作为替换模块

所以afaics，这应该接近（我假设你正在[使用 SOAP](https://github.com/jwagenleitner/groovy-wslite#soap)）：

```
import wslite.soap.*
def client = new SOAPClient('http://192.168.3.69/provider/myService')
client.authorization = new HTTPBasicAuthorization( 'user', 'pass' ) 
```

这里有[让 wslite 与 Grails 一起工作的说明](https://github.com/jwagenleitner/groovy-wslite#using-with-grails)。

# inheritance - OpenJPA 加入继承 - 避免数据库连接

> ID：14356310
> 
> 赞同：1
> 
> 时间：2013-01-16T10:32:07.547
> 
> 标签：inheritance, jpa, discriminator

我正在使用带有 Joined 继承策略的 OpenJPA（InheritanceType.JOINED - 所以超类中的所有字段都有一个表，子类表只包含在子类中添加的任何内容的字段，以及对超类的引用桌子）。假设我有一个超类 Person 和许多子类：TypeAPerson、TypeBPerson 等。当有如下查询时：

```
@NamedQuery(
name="Person.findByName", 
query="SELECT p FROM Person p WHERE p.name = :name") 
```

据我所知，我不会得到 Person 实例，而是正确的子类实​​例。[如此处](http://openjpa.apache.org/builds/1.0.2/apache-openjpa-1.0.2/docs/manual/jpa_overview_mapping_inher.html#jpa_overview_mapping_inher_joined_disadv)所述，为了实现这一点并获得正确的子类，OpenJPA 将进行多个连接（每个子类一个）。这具有相当糟糕的性能，特别是如果我有很多子类。我的问题是，是否有任何方法可以通过提示 JPA 加入哪个表来避免这种情况？我想到的第一件事是使用鉴别器值。OpenJPA 支持使用加入策略的鉴别器，所以它应该能够从鉴别器值中确定一个子类（从而确定一个合适的加入表）？有没有办法做到这一点？有没有其他方法可以避免不必要的数据库连接？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T14:17:44.667

如果您只需要单个子类的实体，那么避免多余连接的最佳方法是查询该子类。使用您的示例，它可能如下所示：

```
@NamedQuery(
name="Student.findByName", 
query="SELECT s FROM Student s WHERE s.name = :name") 
```

`Student`是 的子类`Person`。当然，命名查询应该在适当的子类上定义。

没有办法两者兼得 - 使用超类查询并仅连接一个子类表。持久性提供者事先不知道结果，提示正确方向的唯一方法是搜索子类。

**编辑：**如果您不确定确切的子类，但可以限制可能的子类，您可以使用`TYPE`带有 IN 子句的 JPQL 关键字，如下所示：

```
queryString="SELECT p FROM Person p WHERE p.name = :name AND TYPE(p) IN (Student, Teacher)" 
```

使用实体名称作为`TYPE`. AFAIK，它区分大小写。实际的鉴别器类型和值并不重要，因为您没有查询它。类型解析由提供者完成。

但是，我不确定它是否会使提供者限制必要的加入。如果您最终使用它或对其进行基准测试，请告诉它是否确实如此。

# jquery - 如何从 JQuery UI 菜单选择事件中获取属性信息

> ID：14356312
> 
> 赞同：9
> 
> 时间：2013-01-16T10:32:12.007
> 
> 标签：jquery

我正在尝试从 JQuery UI 菜单选择事件中获取自定义属性。当我尝试执行下面的脚本时，我变得不确定。

```
$( "#menu" ).menu({  
select: function( event, ui ) { alert(ui.item.attr("tag")); }
}); 
```

html

```
<ul id="menu" style="position:absolute;">
<li><a href="#" tag="something">Aberdeen</a></li>
<li><a href="#" tag="some">Ada</a></li>
<li><a href="#" tag="something1">Adamsville</a></li>
<li><a href="#" tag="something2">Addyston</a></li></ul> 
```

谢谢你。

更新：添加完整代码以防我链接错误，我是 jQuery 新手。我尝试按照建议使用 $(document).ready 进行包装，但仍然未定义

```
<!doctype html>
<html>
<head>
<link rel="stylesheet" href="http://code.jquery.com/ui/1.9.2/themes/base/jquery-ui.css" />
<script src="http://code.jquery.com/jquery-1.8.3.js"></script>
<script src="http://code.jquery.com/ui/1.9.2/jquery-ui.js"></script>
<script>
  $(document).ready(function(){

        $( "#menu" ).menu({  
            select: function( event, ui ) { alert(ui.item.attr("tag")); }
        });      
  });   

</script>
</head>
<body>    
<ul id="menu" style="position:absolute;">
<li><a href="#" tag="something">Aberdeen</a></li>
<li><a href="#" tag="some">Ada</a></li>
<li><a href="#" tag="something1">Adamsville</a></li>
<li><a href="#" tag="something2">Addyston</a></li></ul>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-06-27T16:24:27.070

“ui.item”jquery 对象中返回的元素是 li 元素（在您的示例中）。您需要做的是获取它的子元素（a 标签）来访问属性并提取标签的值：

```
var menu = $('#menu');
$(document).ready(function(){
    menu.menu({
        select: function(event, ui) {
            alert(ui.item.children().attr('tag'));
        }
    });
}); 
```

[http://jsfiddle.net/4bY7d/88/](http://jsfiddle.net/4bY7d/88/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T10:37:14.933

尝试包裹在里面`document.ready`

```
$(document).ready(function(){

      $( "#menu" ).menu({  
          select: function( event, ui ) { alert(ui.item.attr("tag")); }
      });      
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-08T06:03:19.800

```
$( "#menu" ).menu({select: function( event, ui ) {
    tag = ui.item.context.children[0].attributes.tag.value;
    alert (tag)
}}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-16T10:50:20.523

这是因为没有加载文档。`document.ready`在函数内部编写脚本

```
$(document).ready(function(){

     //jquery code   
}); 
```

# zend-framework2 - 使用 composer 安装组件 zf2

> ID：14356318
> 
> 赞同：7
> 
> 时间：2013-01-16T10:32:39.153
> 
> 标签：zend-framework2, composer-php, zend-http-client

我尝试使用作曲家安装 zf2 组件但不能这样做，因为作曲家总是下载所有框架，我做错了什么？

*作曲家版本 1beccf9*

```
{
 ...
"repositories": [
 {
   "type": "composer",
   "url": "http://packages.zendframework.com/"
 }
 ],
"require": {
  "zendframework/zend-http" : "2.0.*"
 }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-26T11:29:35.863

我启用了 php_intl 扩展并解决了问题

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T18:26:29.163

我无法重现该问题。我尝试过使用“http”和“https”模式，在这两种情况下，都只收到了 zend-http 包及其依赖项。我能看到的唯一可能的问题是，如果您没有使用“https”模式，并且没有将 openssl 编译到您的 PHP 版本中，那么 Composer 可能无法访问我们的存储库，因此默认为 packagist 存储库，它只会给你完整的 ZF 分布。

# java - 在 Spring 中将 .jsp 映射到 Controller

> ID：14356326
> 
> 赞同：4
> 
> 时间：2013-01-16T10:32:54.987
> 
> 标签：java, spring, spring-mvc, heroku

我刚从 spring 开始，所以我从 Heroku 上的 SpringMVC 开始。通过在 Eclipse 中选择 Spring MVC 模板，我得到了一个非常基本的应用程序。现在我正在尝试修改它。

但是，如果我创建另一个`.jsp`并访问控制器中给出的 URL，我会得到 404，这很清楚，因为我从未将控制器映射到`.jsp`. 但是我该怎么做呢？

这是我更改的所有内容（即使我不确定您是否需要它）：

控制器：

```
@Controller
public class BookingController {

    @Autowired
    BookingService bookingService;

    @RequestMapping("/AvailableBikes")
    public String getAvailableBikes(Model model){
        // TOOD: Fix Date
        int availableBookings = bookingService.getAvailableBookings(Calendar.getInstance().getTime());
        model.addAttribute("NumAvailableBikes", Integer.toString(availableBookings));

        return "NumAvailableBikes";
    }

} 
```

实体：

```
@Entity
public class Booking {

    @Id
    @GeneratedValue
    private Integer id;

// Lots of getters setters an attributes ...

} 
```

服务：

```
@Service
public class BookingServiceImpl implements BookingService {

    @Override
    public void addBooking(Booking booking) {
        // TODO Auto-generated method stub

    }

    @Override
    public int getAvailableBookings(Date bookingDay) {
        // TODO Auto-generated method stub
        return 12;
    }

    @Override
    public void removeBooking(Booking booking) {
        // TODO Auto-generated method stub
    }

} 
```

预订.jsp：

```
<!doctype html>
<%@taglib uri="http://www.springframework.org/tags" prefix="spring"%>
<%@taglib uri="http://www.springframework.org/tags/form" prefix="form"%>
<%@taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>

<html>
<head>
    <meta charset="utf-8">
    <title>Spring MVC and Hibernate Template</title>

    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href="http://twitter.github.com/bootstrap/assets/css/bootstrap.css" rel="stylesheet">
    <link href="http://twitter.github.com/bootstrap/assets/css/bootstrap-responsive.css" rel="stylesheet">

</head>

<body>

Test!

<h2>${NumAvailableBikes}</h2>

</body> 
```

网页.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns="http://java.sun.com/xml/ns/javaee"
    xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
    id="WebApp_ID" version="2.5">
    <display-name>Spring-Hibernate-Template</display-name>

    <welcome-file-list>
        <welcome-file>index.jsp</welcome-file>
    </welcome-file-list>

    <servlet>
        <servlet-name>spring</servlet-name>
        <servlet-class>
            org.springframework.web.servlet.DispatcherServlet
        </servlet-class>
        <init-param>
            <param-name>contextConfigLocation</param-name>
            <param-value>classpath:applicationContext.xml</param-value>
        </init-param>
        <load-on-startup>1</load-on-startup>
    </servlet>
    <servlet-mapping>
        <servlet-name>spring</servlet-name>
        <url-pattern>/booking/*</url-pattern>
    </servlet-mapping>
</web-app> 
```

应用程序上下文.xml：

```
<?xml  version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:jdbc="http://www.springframework.org/schema/jdbc"
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:tx="http://www.springframework.org/schema/tx"
       xmlns:mvc="http://www.springframework.org/schema/mvc"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
                           http://www.springframework.org/schema/jdbc http://www.springframework.org/schema/jdbc/spring-jdbc.xsd
                           http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd
                           http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd
                           http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc.xsd">

    <context:annotation-config />
    <context:component-scan base-package="org.stuttgart.fahrrad" />

    <mvc:annotation-driven/>

    <bean id="jspViewResolver" class="org.springframework.web.servlet.view.InternalResourceViewResolver">
        <property name="viewClass" value="org.springframework.web.servlet.view.JstlView" />
        <property name="prefix" value="/WEB-INF/jsp/" />
        <property name="suffix" value=".jsp" />
    </bean>

    <tx:annotation-driven />
    <bean id="transactionManager" class="org.springframework.orm.jpa.JpaTransactionManager">
        <property name="entityManagerFactory" ref="entityManagerFactory" />
        <property name="dataSource" ref="dataSource"/>

    </bean>

    <beans profile="default">
        <jdbc:embedded-database id="dataSource"/>        
        <bean id="entityManagerFactory" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
            <property name="dataSource" ref="dataSource"/>
            <property name="jpaVendorAdapter">
                <bean class="org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter"/>
            </property>
            <property name="jpaProperties">
                <props>
                    <prop key="hibernate.dialect">org.hibernate.dialect.HSQLDialect</prop>
                    <prop key="hibernate.hbm2ddl.auto">create</prop>
                </props>
            </property>
        </bean>
    </beans>

    <beans profile="prod">
        <bean class="java.net.URI" id="dbUrl">
            <constructor-arg value="#{systemEnvironment['DATABASE_URL']}"/>
        </bean>

        <bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource">
            <property name="url" value="#{ 'jdbc:postgresql://' + @dbUrl.getHost() + @dbUrl.getPath() }"/>
            <property name="username" value="#{ @dbUrl.getUserInfo().split(':')[0] }"/>
            <property name="password" value="#{ @dbUrl.getUserInfo().split(':')[1] }"/>
        </bean>

        <bean id="entityManagerFactory" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
            <property name="dataSource" ref="dataSource"/>
            <property name="jpaVendorAdapter">
                <bean class="org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter"/>
            </property>
            <property name="jpaProperties">
                <props>
                    <prop key="hibernate.dialect">org.hibernate.dialect.PostgreSQLDialect</prop>
                    <prop key="hibernate.show_sql">true</prop>
                    <!-- change this to 'verify' before running as a production app -->
                    <prop key="hibernate.hbm2ddl.auto">update</prop>
                </props>
            </property>
        </bean>
    </beans>

</beans> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T11:02:15.143

返回“NumAvailableBikes”；应改为返回“预订”；

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T10:40:56.500

首先考虑如何配置调度程序 servlet。目前它被映射到以下 url 模式：

```
<servlet-mapping>
    <servlet-name>spring</servlet-name>
    <url-pattern>/booking/*</url-pattern>
</servlet-mapping> 
```

这意味着只有`booking`在上下文根之后直接包含目录的 url 才会被映射。所以像`contextroot/AvailableBikes' 这样的url 永远不会被调度程序拾取和处理。我建议将您的网址格式更改为：

```
<servlet-mapping>
    <servlet-name>spring</servlet-name>
    <url-pattern>/</url-pattern>
</servlet-mapping> 
```

这个映射几乎可以作为一个包罗万象的映射。它将匹配所有未映射到另一个 servlet 的 url。请注意：它还需要您设置配置以映射静态资源，例如 css 和 js 文件。这在 Spring 文档中进行了解释。

一旦你做了这个改变，我认为你应该能够使用一个 URL 来访问控制器，例如`rootcontext/AvailableBikes`. 在控制器中设置一个调试点以确认。另请注意，您不会使用包含 .jsp 文件的直接路径的 url，而是在请求映射中指定的路径。您的 jsp 文件应该可用 @ `webcontent directory/WEB-INF/jsp/NumAvailableBikes.jsp`。

为了显示`booking.jsp`应该可用`webcontent dir/WEB-INF/jsp/booking.jsp`的@必须修改控制器以返回`String`预订。

```
 @RequestMapping("/AvailableBikes")
    public String getAvailableBikes(Model model){
        // TOOD: Fix Date
        int availableBookings = bookingService.getAvailableBookings(Calendar.getInstance().getTime());
        model.addAttribute("NumAvailableBikes", Integer.toString(availableBookings));

        return "booking";
    } 
```

# linq - 使用 Linq 语句执行外连接

> ID：14356327
> 
> 赞同：0
> 
> 时间：2013-01-16T10:33:04.057
> 
> 标签：linq, lambda, outer-join

从下面的集合开始，我需要什么 Linq 语句才能返回满足测试的结果集？

```
private List<dynamic> _results;

[SetUp]
public void SetUp()
{
    _results = new List<dynamic>
    {
        new {Id = 1, Names = new[] {"n1"}, Tags = new[] {"abc", "def"}},
        new {Id = 2, Names = new[] {"n2", "n3"}, Tags = new[] {"ghi"}},
        new {Id = 3, Names = new[] {"n1", "n3"}, Tags = new[] {"def", "xyz"}},
        new {Id = 4, Names = new[] {"n4"}, Tags = new string[] {}}
    };
}

private ILookup<string, string> GetOuterJoinedCollection(IEnumerable<dynamic> results)
{
    // ???
}

[Test]
public void Test()
{
    ILookup<string, string> list = GetOuterJoinedCollection(_results);

    Assert.That(list.Count, Is.EqualTo(4));
    Assert.That(list["n1"], Is.EquivalentTo(new [] { "abc", "def", "def", "xyz" }));
    Assert.That(list["n2"], Is.EquivalentTo(new [] { "ghi" }));
    Assert.That(list["n3"], Is.EquivalentTo(new [] { "ghi", "def", "xyz" }));
    Assert.That(list["n4"], Is.EquivalentTo(new string[] { }));
} 
```

注意：这是上一个问题的后续：[Convert Lambda into Linq Statement with nested for loop](https://stackoverflow.com/questions/14343174/convert-lambda-into-linq-statement-with-nested-for-loop)

# hadoop - Hadoop 集群上的 Hive / Map-Reduce 作业：如何（粗略地）计算所需的磁盘空间？

> ID：14356328
> 
> 赞同：1
> 
> 时间：2013-01-16T10:33:06.453
> 
> 标签：hadoop, mapreduce, hive, hdfs, elastic-map-reduce

以下用例：

我对 .gz 压缩中大小约为 500GB 的数据运行配置单元查询：

`select count(distinct c1), c2 from t1 group by c2;`

此查询产生约 2800 个 map 作业和约 400 个 reduce 作业。

当设置一个 Hadoop 集群时，每个 160GB 实例存储有 20 个实例，作业将停止在 97% map 和 21% reduce 进度，然后回落到 94% map 和 19% reduce 进度，然后根本没有进度。我认为这是因为 HDFS 的磁盘空间已达到使用限制。也许我可以在当天晚些时候提供一条异常消息。

**但是：有没有办法根据正在处理的数据的输入大小粗略地预先计算所需的 HDFS 磁盘空间？请记住，输入数据以 .gz 格式存储。**

**更新**

有谁知道，为什么我的 MapReduce 作业只使用节点的本地存储，而不是 DFS？

[DFS 使用概述 http://img27.imageshack.us/img27/5805/dfsusageoverview.png](http://img27.imageshack.us/img27/5805/dfsusageoverview.png)

[DFS 使用详情 http://img542.imageshack.us/img542/5026/dfsusagedetail.png](http://img542.imageshack.us/img542/5026/dfsusagedetail.png)

来自映射器之一的例外：

```
at org.apache.hadoop.hive.ql.exec.MapOperator.process(MapOperator.java:550)
        at org.apache.hadoop.hive.ql.exec.ExecMapper.map(ExecMapper.java:143)
        ... 8 more
Caused by: org.apache.hadoop.hive.ql.metadata.HiveException: java.io.IOException: Spill failed
        at org.apache.hadoop.hive.ql.exec.ReduceSinkOperator.processOp(ReduceSinkOperator.java:304)
        at org.apache.hadoop.hive.ql.exec.Operator.process(Operator.java:471)
        at org.apache.hadoop.hive.ql.exec.Operator.forward(Operator.java:762)
        at org.apache.hadoop.hive.ql.exec.GroupByOperator.forward(GroupByOperator.java:959)
        at org.apache.hadoop.hive.ql.exec.GroupByOperator.flush(GroupByOperator.java:926)
        at org.apache.hadoop.hive.ql.exec.GroupByOperator.processHashAggr(GroupByOperator.java:779)
        at org.apache.hadoop.hive.ql.exec.GroupByOperator.processOp(GroupByOperator.java:722)
        at org.apache.hadoop.hive.ql.exec.Operator.process(Operator.java:471)
        at org.apache.hadoop.hive.ql.exec.Operator.forward(Operator.java:762)
        at org.apache.hadoop.hive.ql.exec.SelectOperator.processOp(SelectOperator.java:84)
        at org.apache.hadoop.hive.ql.exec.Operator.process(Operator.java:471)
        at org.apache.hadoop.hive.ql.exec.Operator.forward(Operator.java:762)
        at org.apache.hadoop.hive.ql.exec.TableScanOperator.processOp(TableScanOperator.java:83)
        at org.apache.hadoop.hive.ql.exec.Operator.process(Operator.java:471)
        at org.apache.hadoop.hive.ql.exec.Operator.forward(Operator.java:762)
        at org.apache.hadoop.hive.ql.exec.MapOperator.process(MapOperator.java:533)
        ... 9 more
Caused by: java.io.IOException: Spill failed
        at org.apache.hadoop.mapred.MapTask$MapOutputBuffer.collect(MapTask.java:1045)
        at org.apache.hadoop.mapred.MapTask$OldOutputCollector.collect(MapTask.java:599)
        at org.apache.hadoop.hive.ql.exec.ReduceSinkOperator.processOp(ReduceSinkOperator.java:289)
        ... 24 more

Caused by: org.apache.hadoop.util.DiskChecker$DiskErrorException: Could not find any valid local directory for output/s
pill15.out
        at org.apache.hadoop.fs.LocalDirAllocator$AllocatorPerContext.getLocalPathForWrite(LocalDirAllocator.java:381)
        at org.apache.hadoop.fs.LocalDirAllocator.getLocalPathForWrite(LocalDirAllocator.java:146)
        at org.apache.hadoop.fs.LocalDirAllocator.getLocalPathForWrite(LocalDirAllocator.java:127)
        at org.apache.hadoop.mapred.MapOutputFile.getSpillFileForWrite(MapOutputFile.java:121)
        at org.apache.hadoop.mapred.MapTask$MapOutputBuffer.sortAndSpill(MapTask.java:1408)
        at org.apache.hadoop.mapred.MapTask$MapOutputBuffer.access$1800(MapTask.java:869)
        at org.apache.hadoop.mapred.MapTask$MapOutputBuffer$SpillThread.run(MapTask.java:1360) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T15:06:03.190

以下是来自[Cloudera 博客](http://blog.cloudera.com/blog/2010/08/hadoophbase-capacity-planning/)的一些注释：

每个文件的默认复制因子为 3，您需要为中间 shuffle 文件留出大约 25% 的磁盘空间。因此，您需要存储在 HDFS 中的原始数据大小的 4 倍。但是，这些文件很少以未压缩的方式存储，并且根据文件内容和压缩算法，我们看到存储在 HDFS 中的文本文件的平均压缩率高达 10-20。因此，实际所需的原始磁盘空间仅为原始未压缩大小的 30-50% 左右。

如果我可以添加一些东西，如果空间真的是一个限制，你应该考虑压缩中间输出（在映射器和减速器之间）以减少中间 shuffle 文件。您可以通过以下方式执行此操作，例如使用 Gzip 压缩：

```
conf.set(“mapred.compress.map.output”, “true”)
conf.set(“mapred.output.compression.type”, “BLOCK”);
conf.set(“mapred.map.output.compression.codec”, “org.apache.hadoop.io.compress.GzipCodec”); 
```

# java - 解释 Java 并将其转换为另一种语言

> ID：14356329
> 
> 赞同：0
> 
> 时间：2013-01-16T10:33:07.967
> 
> 标签：java, compiler-construction, interpreter, bytecode

我使用一种类似于 JavaScript 的语言来进行销售点设备编程。这种语言真的很糟糕，我正在尝试用 Java 构建某种框架，将 Java 代码“转换”成这种语言。

我使用了一些正则表达式并直接解析了 Java 文件。现在我发现这可能不是正确/更好的方法，我正在寻找替代方法。有什么工具可以帮助我这样做吗？

我认为我应该使用一些高级反射实用程序，例如 ASM (http://asm.ow2.org/index.html)。性能并不重要，因此可能是这样。你怎么看？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-16T10:41:33.990

[ANTLR](http://www.antlr.org/)是一个了不起的解析器生成器。我会调查一下。它有一个已经可用的 Java 语法；我不确定它是 Java 5、6 还是 7（我猜是 5）。

一旦你有了 AST，你的问题将是遍历树并生成目标代码。祝你好运。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T10:39:50.550

我建议用[JavaCC](http://javacc.java.net/)或类似工具解析Java语法，很久以前写的[Java语法描述。](http://java.net/projects/javacc/downloads/download/contrib/grammars/Java1.5.zip)它可以用来编写编译器，所以可能也可以用来编写转换器。正则表达式不太擅长解析编程语言。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T10:38:50.380

我自己从来没有做过任何事情，但是您可以查看[altjs.org](http://altjs.org/)中列出的框架之一，特别是在 Java Ports 部分下，并查看其中一个框架并根据您的特定需求对其进行修改.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-20T12:17:03.027

至少有以下三种方式：

a) 解释字节码。JS 中有一些现有的解释器，例如 DoppioVM。它们可能非常慢。

b) 将字节码编译为 JS。我至少见过一次这样的尝试，结果 JS 很丑，而且速度不是很快。但是这种方法可以有很好的性能（嗯，它可能会导致使用HashMap而不是JS对象等等）。最大的问题是恕我直言，当/如果重建。

编辑：好的，可能不是那么慢，但它很丑陋并且包含像`j2js.invokeStatic("j2js.client.Engine", "getEngine()j2js.client.Engine", null);`. 一个编译器是[https://github.com/decatur/j2js-compiler](https://github.com/decatur/j2js-compiler)。

c) 将 Java 编译为 JS。您可以尝试 Google Web Toolkit 或[http://j2s.sourceforge.net/](http://j2s.sourceforge.net/)。

# ios - 非优化与优化二进制文件中奇怪的 ARC 行为

> ID：14356330
> 
> 赞同：3
> 
> 时间：2013-01-16T10:33:11.493
> 
> 标签：ios, objective-c, llvm

我有一个难以跟踪的错误，它只出现在我的应用程序的发布版本中，而不是在调试版本中。构建之间的相关差异结果是 Debug 构建是在没有任何编译器优化的情况下编译的，而 Release 构建是在编译时使用的`-O`（该错误也可以在所有其他优化设置上重现）。这一切都在 LLVM 上。

在我的视图控制器中，我有一个属性`self.basicInfoContainerView`定义为：

```
@property (weak, nonatomic) IBOutlet UIView *basicInfoContainerView; 
```

然后我从一个视图中删除了子视图，并将其添加到另一个视图中。

```
[self.basicInfoContainerView removeFromSuperview];
[self.infoTextView addSubview:self.basicInfoContainerView]; 
```

根据编译器优化级别，会发生不同的事情。

优化：一旦视图从其父视图中删除，视图就会被释放并`self.basicInfoContainerView`归零，因此不会作为子视图添加到新视图中。

关闭优化：子视图没有立即解除分配，而是作为子视图成功添加到新视图中。

（当我将属性存储限定符更改为 时`strong`，视图在两种情况下都存在，但即使这解决了问题，但这并不是我的问题。）

我希望有人能帮助我了解这里到底发生了什么。`weak`当编译器优化关闭时，为什么不立即释放我的视图（如果保留计数 == 0，则将指针归零）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T23:41:26.703

看到保留对对象的额外本地（和强）引用的非优化代码并不罕见。因此，您的未优化代码必须具有对此“basicInfoContainerView”的本地强引用。该引用通过方法保持在范围内，并且可能在方法返回之前不会被释放。

这实际上只是某种意外，它掩盖了代码中的真正错误。事实是，一旦您这样做了`[self.basicInfoContainerView removeFromSuperview]`，您就不能期望您的 basicInfoContainerView 会继续存在，因为您不再对该视图有任何明确的强引用。

当然，解决这个问题的方法是创建对该视图的显式强引用。然后你已经向编译器明确了你的意图，无论代码是否优化，你都应该得到你想要的结果：

```
UIView *containerView = self.basicInfoContainerView
// this local variable is that explicit strong reference you need

[containerView removeFromSuperview];
[self.infoTextView addSubview:containerView];

// the compiler can/will release this view when the local variable
// 'containerView' goes out of scope 
```

希望有帮助。

# jquery - jquery 1.9 .browser 在 safari 中移除滚动

> ID：14356331
> 
> 赞同：2
> 
> 时间：2013-01-16T10:33:12.943
> 
> 标签：jquery, safari, scroll

我有一个非常简单的问题。

现在 $.browser 已从 jQuery 1.9 中完全删除，我该如何解决这个问题：

```
 var bodyelem = $("html,body");
    if($.browser.safari) bodyelem = $("body")
    bodyelem.animate({ scrollTop: 0 }, 'slow'); 
```

人们建议使用 $.support、modernizer 或类似现在 $.browser 消失的东西。我如何检测对错误/功能的支持，如果它是“html，body”作为选择器，它不会滚动，但如果它只是“body”？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T10:36:58.990

[jQuery 升级指南](http://jquery.com/upgrade-guide/1.9/)提到：

> **jQuery.browser() 已移除**
> 
> jQuery.browser() 方法自 jQuery 1.3 以来已被弃用，并在 1.9 中被删除。如果需要，它可以作为 jQuery Migrate 插件的一部分使用。我们建议将特征检测与 Modernizr 等库一起使用。

所以，我想一个明显的解决方案是使用 jQuery Migrate 插件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T10:45:32.723

您可以在这里找到快速解决方法
[http://pupunzi.open-lab.com/2012/08/14/jquery-1-8-and-browser-detection/](http://pupunzi.open-lab.com/2012/08/14/jquery-1-8-and-browser-detection/)

# cakephp - generateTreeList() 在运行 $this->Model->recover() 后停止工作

> ID：14356336
> 
> 赞同：0
> 
> 时间：2013-01-16T10:33:47.920
> 
> 标签：cakephp

我正在使用 CakePHP 2.2.1

我有一个我设置的模型`var $actsAs = array('Tree');`

以前我能够运行`$data = $this->JobType->generateTreeList(null, null, null, '-');`并`$data`包含树的整个视图。

但是，运行后`$this->Area->recover($mode = 'parent', $missingParentAction = null);`我不再得到任何结果`generateTreeList()`——它完全是空的。

但是，所有其他树方法似乎都运行良好。

我已尝试清除所有蛋糕缓存文件以查看是否有任何区别，但没有。

即使我将调试设置为级别 3，也没有显示错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T10:22:48.753

发生这种情况是因为我在数组中有 UTF 数据。显然Cake不喜欢那样。我仍然不知道为什么会发生这种情况，但要回答我自己的问题，这*就是*它发生的原因。

如果有人想来提供更详细的答案，那么我很乐意将其标记为正确！

# c - 在 C 中传输隐藏数据

> ID：14356342
> 
> 赞同：0
> 
> 时间：2013-01-16T10:34:15.463
> 
> 标签：c, performance

**考虑C**程序中的以下情况。我们有一组函数，让泛型函数为

```
 void needs_param (void * param, ...); 
```

，这取决于某些参数的值`param`。参数`param`由函数计算，例如

```
 void compute_param (..., void * param); 
```

我们希望`param`尽可能地向调用者隐藏（类型、大小、值...）的详细信息，其中调用者是一个使用函数`compute_param`和`needs_param`. 如果您可以自由修改`needs_param`和，如何最有效和线程安全地实现这一点`compute_param`？

我考虑并排除了以下可能性：

**答：**因为我们可以自由修改`needs_param`，所以一种方法是传递`gen_param`及其参数而不是`param`，并让`needs_param`计算`param`自行计算。但是`param`计算起来很昂贵，并且需要多次作为其他函数的参数。

**b：**我们可以实现`compute_param`为

```
void * compute_param (...) {
    static param_type param = ...
    return &param;
} 
```

但是，这不是线程安全的，使用`openmp`我们必须保护调用

```
#pragama omp critical
{
    void * param = compute_param (...)
} 
```

这将严重影响线程程序的性能。

**C：**一种解决方案是使用 malloc/free

```
void compute_param (..., void * param) {
    param = malloc (sizeof (param_type));
    ....
    *param = ...
} 
```

这给调用者带来了释放分配的内存的负担，同时由于昂贵的堆内存而效率低下。

**d:**的使用`alloca`，例如

```
void * param = alloca (param_size);
compute_param (..., param);
...
needs_param (param, ...); 
```

，需要有关`param`调用者空间中大小的信息，我们希望将其隐藏。

你有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T10:49:14.797

我建议您使用称为“不透明指针”的解决方案。例如，它在 Windows 内核世界中被广泛用于向调用者隐藏对象。

您首先定义一个指针类型，如`typedef void* pobject;`.

然后，您只能在程序中以这种方式操作您的对象。一堆函数，如`pobject create_object()`,`use_object(pobject)`并`free_object(pobject)`使用这种技术。

为确保可以安全地操作您的对象，请在对象本身中添加一个互斥锁。您还可以将对象的大小添加为第一个成员，以快速检查对象的性质（是否被其他人操作过？）。

然后，在函数中，您真正定义您的对象，如`typedef struct { } object_int, *pobject_int`. 在每个操作它的函数中，只需将你的不透明指针`pobject`从`pobject_int`.

它确实迫使您使用堆，但如果您不想与调用者共享有关您的对象的任何信息，这是最合适的解决方案。

# blackberry - 有没有人让 Ripple 的内置远程 Web 检查器工作？

> ID：14356346
> 
> 赞同：0
> 
> 时间：2013-01-16T10:34:24.410
> 
> 标签：blackberry, blackberry-webworks, ripple

我有 Blackberry webworks 应用程序，并且正在使用 Ripple Chrome 扩展程序（Ripple UI (v0.9.12)）。

我目前正在 BB 模拟器中测试我的应用程序，并且正在手动运行 WEIRNE（远程网络检查器）。

我更喜欢使用内置的波纹版本（因为 WEIRNE 非常不稳定）。

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-21T20:23:40.217

您还可以在启用 Web Inspector 的情况下构建您的应用程序，然后访问

```
http://deviceip:1337/ 
```

当应用程序在模拟器或实际设备上运行时，在您的桌面浏览器中。我经常使用它来监视 Network 选项卡中的 ajax 调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T15:48:59.510

您可以在 Ripple 中使用 chrome web 检查器，就​​像您可以使用任何带有 chrome 的网页一样。您可以右键单击一个元素，然后单击“检查元素”。

如果要在“控制台”中手动执行命令，则需要更改正在访问的框架，在“控制台”底部将“顶部框架”更改为文档（您的文件名）。

# c# - OpenOffice 3 文本文档 - 设置页面大小和边距

> ID：14356350
> 
> 赞同：1
> 
> 时间：2013-01-16T10:34:41.693
> 
> 标签：c#, openoffice-writer, odt

基于[使用 OpenOffice 3 示例代码的“Hello World”，](https://stackoverflow.com/questions/2054328/hello-world-using-openoffice-3-sample-code)我设法从 C# 创建了 Open Office 文本文件。但我仍然找不到设置页面大小和边距的方法。任何线索如何做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T16:24:36.527

我终于发现了，所以如果将来有人需要，代码在这里：

```
XStyleFamiliesSupplier xSupplier = (XStyleFamiliesSupplier)xComponent;
XNameContainer xPageStyleCollection = (XNameContainer)xSupplier.getStyleFamilies().getByName("PageStyles").Value;
XPropertySet xPropertySet = (XPropertySet)xPageStyleCollection.getByName("Default").Value;
xPropertySet.setPropertyValue("LeftMargin", new Any((Int32)(5000))); //mm
xPropertySet.setPropertyValue("RightMargin", new Any((Int32)(9000))); // (1/100)mm
xPropertySet.setPropertyValue("TopMargin", new Any((Int32)(6000))); //(1/100)mm
xPropertySet.setPropertyValue("BottomMargin", new Any((Int32)(7000))); //(1/100)mm
xPropertySet.setPropertyValue("Width", new Any((Int32)(25000))); //(1/100)mm
xPropertySet.setPropertyValue("Height", new Any((Int32)(21000))); //(1/100)mm 
```

# java - 与生产者/消费者线程重叠 50% 的滑动窗口

> ID：14356352
> 
> 赞同：0
> 
> 时间：2013-01-16T10:34:48.230
> 
> 标签：java, android, guava, concurrent-collections

我在Java中有以下场景：

*   1 个生产者线程将事件对象存储到队列中。阻止它不是一种选择。它应该始终只将每个元素存储在队列的末尾并退出（因此没有有界队列）。
*   1 个消费者线程等待队列中包含 WINDOW_SIZE 个事件。然后它应该从队列中检索所有 WINDOW_SIZE 事件以进行处理，但只删除其中的一半（即 WINDOW_SIZE/2），以获得 50% 的重叠。

我的问题是，您将使用哪个（并发）集合来有效地实现这一点？这些事件在资源有限的设备（运行 Android 的手机）上以 100Hz 的频率出现。我想过使用以下内容，但似乎都不合适：

1.  ConcurrentLinkedQueue，每次修改时检查队列大小，并在 WINDOW_SIZE 事件可用时在消费者中使用 peek()/poll()。这似乎有点麻烦。
2.  一个 ArrayBlockingQueue，再次检查队列大小，并使用 drainTo()。但是，该方法具有以下文档：“[...] 此外，如果在操作进行时修改了指定的集合，则此操作的行为是未定义的。[...]”。这对于并发集合来说似乎有点奇怪。

这是一些示例代码：

```
import java.util.Queue;

import com.google.common.collect.Queues;

public class AccelerometerProcessor implements Runnable {

    private static final int WINDOW_SIZE = 128;

    private final Queue<AccelerometerEvent> eventQueue = Queues.newConcurrentLinkedQueue();

    @Override
    public void run() {
        while (!Thread.interrupted()) {
            try {
                synchronized (eventQueue) {
                    while (eventQueue.size() < WINDOW_SIZE) {
                        eventQueue.wait();
                    }

                    // We have WINDOW_SIZE eventQueue, start processing
                }
            } catch (InterruptedException e) {
                // Do nothing
            }
        }
    }

    public void addAccelerometerEvent(AccelerometerEvent accelerometerEvent) {
        synchronized (eventQueue) {
            eventQueue.add(accelerometerEvent);
            eventQueue.notifyAll();
        }
    }
} 
```

顺便说一句，我也在使用 Google Guava，所以如果那里有我没听说过的不错的收藏，请参考我。

所以：有什么好主意如何有效和干净地解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T10:39:18.143

If you're always going to consume WINDOW_SIZE/2 events *en bloc*, why doesn't the producer thread (you said there's only one) fill an array of size WINDOW_SIZE/2 and pass it to the queue once it's full?

# visual-studio-2008 - Visual Studio 2008 中包含文件核心和 highgui 的错误

> ID：14356356
> 
> 赞同：2
> 
> 时间：2013-01-16T10:35:16.527
> 
> 标签：visual-studio-2008, opencv

当我构建我的项目时，我收到以下错误，

```
 Fatal error C1083: Cannot open include file: 'opencv2/core/core_c.h: No such file or directory Similarly for highgui. 
```

因为我已经安装了 OpenCV2.4.3，它的路径是 C:\opencv。我还在**包含目录中添加了这些行**

```
 C:opencv\include\opencv 
  C:opencv\include\opencv2
  C:\opencv\include 
```

源代码是：

```
// #include "stdafx.h"
   #include "cv.h"
   #include "highgui.h"

 int main() 
 {
         IplImage* img = cvLoadImage("C:\\prado.jpg",1);
         cvNamedWindow( "test", CV_WINDOW_AUTOSIZE );
         cvShowImage( "test", img );
         cvWaitKey(0);
         cvReleaseImage( &img );
        return 0; 
```

对我来说一切都很好。我已经在发布模式下删除了所有内容。我只尝试调试模式。

* * *

我所做的 Open CV 的配置是： ![包含文件](../Images/61ace0e08e3bc27b5c8f27ae636c0c91.png)

库文件

![在此处输入图像描述](../Images/fdcc145b9b222ccb669a8fe175c0248a.png)

![在此处输入图像描述](../Images/8cf28d375370a619608c25cbff22c44f.png)

![在此处输入图像描述](../Images/7e79da7667f14fed9eb367d1c7de0c27.png)

![在此处输入图像描述](../Images/fdd8de6f7f1e33b716d505d5b5113de1.png)

![在此处输入图像描述](../Images/d1270d681edcf6851400d4d0301f0ff8.png)

![在此处输入图像描述](../Images/8071d43fa6da704d57b08fb33a86ef7e.png)

![在此处输入图像描述](../Images/fe782e528a70a4650e0e8229d02f5d21.png)

![在此处输入图像描述](../Images/6a559a680ccfafe1f6940262e5e72fe9.png)

![在此处输入图像描述](../Images/b940b7c01fdb34ed5b881a7042031e40.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-16T12:09:14.087

这就是我所做的，它工作正常：

在包含文件中包含以下路径：

1.  `opencv\modules\core\include\opencv2\core`
2.  `opencv\include\opencv2`
3.  `opencv\include\opencv`
4.  `opencv\build\include`

在库文件中包含以下路径；

1.  `opencv\build\x86\vc9\lib`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T19:29:14.787

当我使用opencv时，我在前两张图片的窗口中没有做任何事情，但我将路径放在C/C++、常规、附加包含目录中，但我不知道它是否有任何区别

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-28T17:46:29.523

至少在最新的 OpenCV 2.8.4 中。

如果你手动编译过 OpenCV，你也应该编译 Install 项目。这将有效地创建包含您的“安装”目录

*   斌
*   包括
*   库

就像在正常的二进制安装程序包中找到的一样。

# java - HTTP POST：如何确保仅从前一页调用它？

> ID：14356359
> 
> 赞同：0
> 
> 时间：2013-01-16T10:35:26.390
> 
> 标签：java, jsp, jetty, http-post

对于经验丰富的 Web 开发人员来说，这可能是一个非常简单的新手问题，而我不是，而且谷歌搜索也无济于事。

我在 Heroku 上托管了一个非常简单的 webapp，其代码在[这里](https://github.com/fge/json-schema-validator-demo)。它有两个 JSP 页面，一个索引，一个带有验证结果，没什么花哨的。两个 JSP 页面在[此处 (index.jsp)](https://github.com/fge/json-schema-validator-demo/blob/783c492a6a66c48ffb53ef435c1fc32842180188/src/main/webapp/index.jsp)和[此处 (results.jsp)](https://github.com/fge/json-schema-validator-demo/blob/783c492a6a66c48ffb53ef435c1fc32842180188/src/main/webapp/results.jsp)。

问题在于[验证 servlet](https://github.com/fge/json-schema-validator-demo/blob/4634a3507a513d96a97e1209b050fee8a2da7756/src/main/java/org/eel/kitchen/jsonschema/FormValidation.java)：它是一个 POST，并且在使用应用程序本身时通过`index.jsp`. 但是我已经测试过，如果我直接调用 servlet，它也可以工作......而且我不希望这样。

有没有办法可靠地确保这个 servlet 只能在来自索引页面时被调用（否则发送 403）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T10:50:10.290

我使用的一种方法是让 index.jsp 上的输入表单包含一个隐藏字段，该字段包含一个 md5 散列，results.jsp 也可以计算该散列。我使用客户端机器 IP 地址的 md5 散列与共享密码短语连接。

我猜对于给定的客户端 IP 地址，哈希值总是相同的，因此您也可以使用另一个值（如当前时间）对其进行加盐，该值在另一个隐藏字段中传递，以包含在 results.jsp 的计算中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T11:02:23.590

您可以在加载第一页时生成指纹（例如 UUID.randomUUID()）并将值保存在当前会话中。

当您将结果发布到验证 servlet 时，您将该指纹作为隐藏字段包含在内，并检查该指纹是否存在于会话中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T10:50:53.363

你不可能 100% 确定这一点。最终，您可以检查引用者，但可以伪造它。您还可以在加载 index.jsp 时设置 cookie 并检查 servlet 中的值。但也有可能有人加载 index.jsp 以检索 cookie，然后使用它在验证 servlet 上发布。同样的想法是用哈希隐藏输入。

# c# - PInvoke FatalExecutionEngineError

> ID：14356362
> 
> 赞同：0
> 
> 时间：2013-01-16T10:35:42.803
> 
> 标签：c#, c++, pinvoke

我使用 PInvoke 从 c# 代码访问 C++ 库。但我在使用以下功能时遇到问题：

```
UINT32 myfunc(IN char * var1, IN UINT32 var2, INOUT UINT16 * var3, OUT UINT8 * var4) 
```

文档说：

> 返回参数为错误码
> 
> var1 是一个字符串
> 
> var2 是一个整数
> 
> var3 是一个指向整数的指针（该值将是 var4 的大小，该值将由函数更改）
> 
> var4 是指向将由函数填充的缓冲区的指针

当我使用

```
[DllImport("mydll.dll", CallingConvention = CallingConvention.Cdecl)]
public static extern int myfunc(string var1, int var2, out int var3, 
    out byte[] var4); 
```

该函数给出以下异常：

> 托管调试助手“FatalExecutionEngineError”在“C:\Users...\Documents\Projects...\bin\Debug...vshost.exe”中检测到问题。
> 
> 附加信息：运行时遇到致命错误。错误地址位于线程 0x2edc 上的 0x74292e44。错误代码为 0xc0000005。此错误可能是 CLR 中的错​​误或用户代码的不安全或不可验证部分中的错误。此错误的常见来源包括 COM 互操作或 PInvoke 的用户封送错误，这可能会损坏堆栈。
> 
> 如果有这个异常的处理程序，程序可以安全地继续。

我尝试使用参数来查看是否可以得到任何东西，并更改了字符集，如下所示：

```
[DllImport("mydll.dll, CallingConvention = CallingConvention.Cdecl", CharSet = CharSet.Unicode)]
public static extern int myfunc(string var1, int var2, out int var3, out byte[] var4); 
```

在这种情况下，它不会给出 FatalExecutionEngineError，而是函数返回没有错误。但是返回值表明函数发生了内部错误。（我不知道为什么字符集更改会阻止 FatalExecutionEngineError。）

我不确定我做错了什么，请帮助我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-16T11:47:54.853

p/invoke 声明应如下所示：

```
[DllImport("mydll.dll", CallingConvention = CallingConvention.Cdecl)]
public static extern int myfunc(
    string var1, 
    uint var2, 
    ref ushort var3, 
    byte[] var4
); 
```

然后你这样称呼它：

```
string var1 = "...";
uint var2 = ...;
ushort var3 = 1024;//use whatever length buffer you want to pass
byte[] var4 = new byte[var3];
int retval = myfunc(var1, var2, ref var3, var4);
Array.Resize(ref var4, var3); 
```

本机代码的工作方式是它期望调用代码分配缓冲区，`var4`. 调用代码说明缓冲区在`var3`.

然后当本机代码返回时，`var3`包含缓冲区的实际长度。或者可能是复制的字节数。前者更有用。假设前者那么你也许可以这样写：

```
string var1 = "...";
uint var2 = ...;
ushort var3 = 0;
int retval = myfunc(var1, var2, ref var3, null);
byte[] var4 = new byte[var3];
int retval = myfunc(var1, var2, ref var3, var4); 
```

您应该检查返回值等。

我不能 100% 确定如何调用该函数，因为您的问题中没有足够的信息。至少 p/invoke 签名现在与您的 C++ 代码匹配。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T12:07:18.753

这是一个潜在的非常危险的函数，它可以通过第 4 个参数任意将垃圾喷射到内存中。如果它设计得很好（手指交叉），那么它应该允许您首先测量所需的缓冲区大小。任意猜测：

```
[DllImport("mydll.dll, CallingConvention = CallingConvention.Cdecl", CharSet = CharSet.Ansi)]
public static extern int myfunc(string name, ref int var2, ref int buflen, IntPtr buf);

string name = "foo";
int var2 = 42; //???
int len = 0;
int error = myfunc(name, ref var2, ref len, IntPtr.Zero);
if (error == BUFFER_TOO_SMALL) {
    IntPtr buf = Marshal.AllocCoTaskMem(len);
    try {
       error = myfunc(name, ref var2, ref len, buf);
       if (error == OK) {
           var bytes = new bytes[len];
           Marshal.Copy(buf, bytes, 0, len);
           //...
       }
    }
    finally {
       Marshal.FreeCoTaskMem(buf);
    }
}
if (error != OK) handleError(error); 
```

这是相当沉重的猜测。如果该函数实际上不允许您首先询问所需的缓冲区大小，那么您应该更改 C 代码，使其像这样工作。只有这样才能安全地调用它。

# c# - 允许我重新分发的 C# 音频库

> ID：14356370
> 
> 赞同：2
> 
> 时间：2013-01-16T10:36:22.517
> 
> 标签：c#, audio

我正在用 C# 制作一个游戏库，我需要一个免费的音频库来让我做这些事情。

*   同时播放声音。
*   播放背景 MIDI 音乐。
*   播放这些格式。
    *   WAV
    *   国际电影节
    *   MIDI
    *   非盟
*   允许我用我的引擎重新分发库（我将只使用二进制文件）
*   允许销售使用它制作的游戏。

是否有任何 c# 库可以让我做这些事情？

谢谢。

# sql - 查询（带聚合函数）调优

> ID：14356371
> 
> 赞同：0
> 
> 时间：2013-01-16T10:36:26.260
> 
> 标签：sql

我有一个查询（下）。解释计划显示 CPU 使用率很高，这也导致了我们实验室的停机。所以可以进一步管这个查询吗？我应该怎么做才能调整它？

仅供参考，mtr_main_a，mtr_main_b，mtr_hist 包含大量记录，可能是 1000 万或更多。

```
SELECT to_char(MAX(mdt), 'MM-DD-RRRR HH24:MI:SS')
FROM   (
           SELECT MAX(mod_date - 2 / 86400) mdt
           FROM   mtr_main_a
           UNION
           SELECT MAX(mod_date - 2 / 86400) mdt
           FROM   mtr_main_b
           UNION
           SELECT MAX(mod_date - 2 / 86400) mdt
           FROM   mtr_hist@batch_hist
       )
/ 
```

解释计划如下

```
Execution Plan
----------------------------------------------------------
Plan hash value: 1573811822

-------------------------------------------------------------------------------------------------------------
| Id  | Operation              | Name       | Rows  | Bytes |TempSpc| Cost (%CPU)| Time     | Inst   |IN-OUT|
-------------------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT       |            |     1 |     9 |       | 79803   (1)| 00:18:38 |        |      |
|   1 |  SORT AGGREGATE        |            |     1 |     9 |       |            |          |        |      |
|   2 |   VIEW                 |            |     2 |    18 |       | 79803   (1)| 00:18:38 |        |      |
|   3 |    SORT UNIQUE         |            |     2 |    17 |    77M| 79803   (2)| 00:18:38 |        |      |
|   4 |     UNION-ALL          |            |       |       |       |            |          |        |      |
|   5 |      SORT AGGREGATE    |            |     1 |     8 |       | 79459   (1)| 00:18:33 |        |      |
|   6 |       TABLE ACCESS FULL| MTR_MAIN_A |  5058K|    38M|       | 67735   (1)| 00:15:49 |        |      |
|   7 |      SORT AGGREGATE    |            |     1 |     9 |       |   344   (1)| 00:00:05 |        |      |
|   8 |       TABLE ACCESS FULL| MTR_MAIN_B |     1 |     9 |       |   343   (1)| 00:00:05 |        |      |
|   9 |      REMOTE            |            |       |       |       |            |          |  HISTB | R->S |
-------------------------------------------------------------------------------------------------------------

Remote SQL Information (identified by operation id):
----------------------------------------------------

   9 - EXPLAIN PLAN SET STATEMENT_ID='PLUS10294704' INTO PLAN_TABLE@! FOR SELECT
       MAX("A1"."MOD_DATE"-.00002314814814814814814814814814814814814815) FROM "MTR_HIST" "A1" (accessing
       'HISTB' ) 
```

谢谢和问候，钱德拉

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T10:40:26.533

在确定最大日期之后，您应该能够通过在`mod_date`列上放置索引并以最后进行减法的方式更改查询来大大提高性能：

```
SELECT to_char(MAX(mdt) - 2 / 86400, 'MM-DD-RRRR HH24:MI:SS')
FROM   (
           SELECT MAX(mod_date) mdt
           FROM   mtr_main_a
           UNION
           SELECT MAX(mod_date) mdt
           FROM   mtr_main_b
           UNION
           SELECT MAX(mod_date) mdt
           FROM   mtr_hist@batch_hist
       ) 
```

这应该摆脱全表扫描。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T11:34:34.960

如果您在列上有索引，此版本如何工作：

```
SELECT to_char((case when a.mdt > b.mdt and a.mdt > c.mdt then a.mdt
                     when b.mdt > c.mdt then b.mdt
                     else c.mdt
                end) - 2 / 86400, 'MM-DD-RRRR HH24:MI:SS')
FROM (SELECT MAX(mod_date) mdt
      FROM   mtr_main_a
     ) a cross join
     (SELECT MAX(mod_date) mdt
      FROM   mtr_main_b
     ) b cross join
     (SELECT MAX(mod_date) mdt
      FROM   mtr_hist@batch_hist
     ) c 
```

`union`如果版本不能更快地运行，这只是一个建议。

# transactions - SSIS：无法加入分布式事务

> ID：14356375
> 
> 赞同：0
> 
> 时间：2013-01-16T10:36:42.223
> 
> 标签：transactions, ssis

我想要做的是使用 SSIS 将一些信息从 Oracle 11 DB（查询）复制到 SQL Server 2008（单表）。显然我把交易的东西弄混了。虽然当我将事务选项保留为其默认值时一切都执行良好，但在将包事务属性设置为必需（或将数据流组件事务属性之一设置为必需）时出现以下错误。因此，在尝试执行此 DTSX 脚本时，我收到以下错误：

```
Microsoft (R) SQL Server Execute Package Utility
Version 10.0.2531.0 for 32-bit
Copyright (C) Microsoft Corp 1984-2005\. All rights reserved.

Started:  11:38:02 §£
Info: 2013-01-16 11:38:02.45
   Code: 0x4001100A
   Source: issued_import 
   Description: Starting distributed transaction for this container.
End Info
Info: 2013-01-16 11:38:04.52
   Code: 0x4004300A
   Source: Data Flow Task 1 SSIS.Pipeline
   Description: Validation phase is beginning.
End Info
Info: 2013-01-16 11:38:05.01
   Code: 0x40043006
   Source: Data Flow Task 1 SSIS.Pipeline
   Description: Prepare for Execute phase is beginning.
End Info
Error: 2013-01-16 11:38:05.10
   Code: 0xC0047062
   Source: Data Flow Task 1 Source - Query [1]
   Description: System.InvalidOperationException: Unable to enlist in a distributed transaction
   at Oracle.DataAccess.Client.OracleConnection.EnlistTransaction(Transaction transaction)
   at Microsoft.SqlServer.Dts.Runtime.ManagedHelper.GetManagedConnection(String assemblyQualifiedName, String connStr, Object transaction)
   at Microsoft.SqlServer.Dts.Runtime.Wrapper.IDTSConnectionManager100.AcquireConnection(Object pTransaction)
   at Microsoft.SqlServer.Dts.Pipeline.DataReaderSourceAdapter.AcquireConnections(Object transaction)
   at Microsoft.SqlServer.Dts.Pipeline.ManagedComponentHost.HostAcquireConnections(IDTSManagedComponentWrapper100 wrapper, Object transaction)
End Error
Error: 2013-01-16 11:38:05.10
   Code: 0xC004701A
   Source: Data Flow Task 1 SSIS.Pipeline
   Description: component "Source - Query" (1) failed the pre-execute phase and returned error code 0x80131509.
End Error
Info: 2013-01-16 11:38:05.10
   Code: 0x4004300B
   Source: Data Flow Task 1 SSIS.Pipeline
   Description: "component "SQL Server Destination" (102)" wrote 0 rows.
End Info
Info: 2013-01-16 11:38:05.10
   Code: 0x40043009
   Source: Data Flow Task 1 SSIS.Pipeline
   Description: Cleanup phase is beginning.
End Info
Info: 2013-01-16 11:38:05.10
   Code: 0x4001100C
   Source: Data Flow Task 1 
   Description: Aborting the current distributed transaction.
End Info
Info: 2013-01-16 11:38:05.10
   Code: 0x4001100C
   Source: issued_import 
   Description: Aborting the current distributed transaction.
End Info
DTExec: The package execution returned DTSER_FAILURE (1).
Started:  11:38:02 §£
Finished: 11:38:05 §£
Elapsed:  2.823 seconds 
```

请注意，我对执行分布式事务不感兴趣 - 相关服务在 SQL Server 端运行，但我很确定在 Oracle 端没有对此进行任何处理，并且可能分布式事务应该失败。如果是这种情况，还有什么其他方法可以解决这个问题？将我的数据流任务包装到 BEGIN/END TRANSACTION 执行 SQL 块（如建议[此处](https://stackoverflow.com/questions/13012358/ssis-transaction-management-mssql/13016086#13016086)）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T16:14:58.880

通过将默认 Transaction 类型从 更改`Supported`为`Required`，我的，可能有缺陷的过程的理解是，如果它完全在单个 SQL Server 上，SSIS 引擎将基本上使用 a`BEGIN TRAN`来处理事务。如果涉及多个服务器，则 SSIS 将使用分布式事务协调器来处理向侦听器说出适当的语言以使事务正常工作。

对于 DB2，我们必须向只想从事务中读取数据的帐户显式授予一些权限（在此挥手，因为我不知道具体情况）。如果内存服务正确，我们在使用 MySQL 源时也会遇到类似的问题。

我们想使用本机事务的东西，因为我们是懒惰的程序员，但不想经历为我们可能想要在事务下读取的所有 DB2 数据提交更改控制请求的麻烦，所以我们的解决方案是创建 2 个数据流任务。控制流保留为受支持。第一个任务在 Supported transaction 选项下运行（NotRequired 也可以）。此任务从主机系统中查询数据并将其写入 RAW 目标。RAW 是一种二进制文件格式，SSIS 可以非常有效地使用它，并且是类型安全的，等等。第二个数据流任务将事务设置为必需，并使用 RAW 文件作为源，然后路由到我们的目标表。由于事务对文件没有意义，

不过，这是有代价的，那就是磁盘。任何时候 SSIS 敲击磁盘，你就输了。磁盘 IO 会受到伤害，因此对于大容量（很大程度上取决于您的 IO 子系统、用于加载数据的 SLA 等），您将从源系统中读取数据，写入本地系统，然后将数据读回并然后最终写入目标系统。这是 SSIS 试图通过在内存中做很多事情来避免的大量读取和写入。我们的数量如此之大，以至于这对我们的性能的影响不足以超过文书工作的麻烦，但只有您才能在性能测试后拨打电话。

# c# - MVC3 maproute 不显示动作？

> ID：14356383
> 
> 赞同：2
> 
> 时间：2013-01-16T10:37:03.733
> 
> 标签：c#, asp.net, .net, asp.net-mvc-3, maproute

如果我有以下 MapRoute：

```
routes.MapRoute(
    "Default",                                              // Route name
    "{controller}/{action}/{id}",                           // URL with parameters
        new { controller = "Home", action = "Index", id = "" }  // Parameter defaults
); 
```

我可以有一个像这样的网址：

`blabla.com/Home/Index/123`

但是我需要创建什么样的 MapRoute 才能做到这一点：

`blabla.com/Home/123`还是`blabla.com/Home/DEADBEEF`？

我想它涉及到类似的东西 `"{controller}/{id}/{action}"`

action 和 id 颠倒过来，说不定应该有一个默认的 action。但是 MapRoute 怎么知道应该这样对待哪个控制器呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T11:33:00.063

你可能需要这些方面的东西。

```
 routes.MapRoute(
      name: "DefaultRoute",
      url: "Home/{action}",
      defaults: new { controller = "Home", action = "Index" },
      constraints: new { action = "[A-Za-z]*" }
  ); 
```

或不采取行动

```
 routes.MapRoute(
      name: "DefaultRoute",
      url: "Home/{id}",
      defaults: new { controller = "Home", action = "Index", id = "" },
      constraints: new { id = "[A-Za-z]*" }
  ); 
```

您需要确保路由名称与您设置的任何其他路由不同，并注意路由的顺序，因为其他类似的路由可以相互覆盖。在这种情况下，请确保您可能希望在默认路由之前使用它，但请注意它会覆盖它。

至于没有控制器甚至没有动作，您可以设置默认值并且在路由中不需要它们。

至于约束，您可以简单地将约束参数添加到路由中，为某个属性设置正则表达式，如上所示。

编辑：如果您需要，这里有一些有用的链接，可获取有关路由的更多信息。

*   [http://www.dotnet-tricks.com/Tutorial/mvc/HXHK010113-Routing-in-Asp.Net-MVC-with-example.html](http://www.dotnet-tricks.com/Tutorial/mvc/HXHK010113-Routing-in-Asp.Net-MVC-with-example.html)
*   [http://weblogs.asp.net/scottgu/archive/2007/12/03/asp-net-mvc-framework-part-2-url-routing.aspx](http://weblogs.asp.net/scottgu/archive/2007/12/03/asp-net-mvc-framework-part-2-url-routing.aspx)
*   [高级 ASP 路由教程和示例](https://stackoverflow.com/questions/2341057/advanced-asp-routing-tutorials-and-examples)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T11:47:52.633

您可以添加这样的路线：

```
routes.MapRoute(
    "CustomRoute",
    "Home/{id}",
    new { controller = "Home", action = "Index", id = "" }); 
```

确保将其放置在默认路由之上。然而，这条路线将阻止 HomeController 中的所有其他操作。由于我们对 id 参数没有限制，因此框架不可能知道您是指 URL 中的操作还是 id。由于此路由首先出现，因此会将其映射到 id 参数。

# c# - LINQ to Entities 加入 Null 表示“全部匹配”的可空字段

> ID：14356384
> 
> 赞同：8
> 
> 时间：2013-01-16T10:37:04.433
> 
> 标签：c#, linq, entity-framework

我正在尝试使用 Entity Framework 5 运行以下 LINQ 查询：

```
int taskId = 2;

query = from a in Table_A
        where a.StatusCode != "DONE"
           && a.Inbound
        join b in Table_B
            on a.Id equals b.Id_Table_A
        join c in Table_C
            on a.State equals (c.State ?? a.State)
        where 2 == c.Id_Task
           && b.DataType == c.DataType
        select a.Id; 
```

导致我出现问题的行是：

```
on a.State equals (c.State ?? a.State) 
```

Table_C 中的“State”字段可以为空……当它为空时，它用于暗示“所有状态”。因此，当“c.State”为空时，我希望记录匹配。如果我要在 SQL 中编写它，我会使用以下内容：

```
JOIN Table_C ON Table_A.State = ISNULL(Table_C.State, Table_A.State) 
```

不幸的是，我收到以下错误：

**名称“a”不在“equals”右侧的范围内。考虑交换 'equals' 两边的表达式。**

我将感谢任何可以让我了解使这项工作的秘诀的人。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T11:22:35.023

您可以修改您的代码，如：

```
int taskId = 2;

query = from a in Table_A
        where a.StatusCode != "DONE"
           && a.Inbound
        join b in Table_B
            on a.Id equals b.Id_Table_A
        from c in Table_C
        where 2 == c.Id_Task
           && b.DataType == c.DataType
           && (c.State == null || a.State.Equals(c.State))
        select a.Id; 
```

A`join`本质上是一个`where`子句，所以这里我们可以使用该`where`子句，因为有`join`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-16T12:15:46.903

我设法通过将“DataType”检查从 WHERE 移动到 JOIN，并将“状态”检查从 JOIN 移动到 WHERE 来实现这一点。按我预期工作的结果代码如下：

```
query = from a in Table_A
        where a.StatusCode != "DONE"
           && a.Inbound
        join b in Table_B
            on a.Id equals b.Id_Table_A
        join c in Table_C
            on b.DataType equals c.DataType
        where 2 == c.Id_Task
            && (c.State ?? a.State) == a.State
        select a.Id; 
```

非常感谢所有为我看过这个的人。:)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-07-20T10:29:08.483

您可以使用“from”语法而不是“join”

```
from a in TableA
from b in TableB
.Where(x => (x.Buy ?? a.Buy) == a.Buy
        && (x.Parity ?? a.Parity) == a.Parity) 
```

# http - 有两个？在 URL 中 - 它有效吗？

> ID：14356385
> 
> 赞同：5
> 
> 时间：2013-01-16T10:37:06.697
> 
> 标签：http, url, standards

事情是这样的：

假设我有一个这样的基本 URL：

```
www.mysite.com?my_first_param=1&my_second_param=2 
```

但现在我想在我的 URL 中添加一个新参数：

```
www.mysite.com?my_first_param=1&my_second_param=2&my_redirect_site=www.myothersite.com 
```

想象一下，我正在使用一项服务，他们将新的跟踪参数添加到我的 URL。例如：

```
first_tracking=value1&second_value=value2 
```

因为我的 BASE url 已经有一个“？” 参数添加了“&”，所以我的最终 URL 如下所示：

```
www.mysite.com?my_first_param=1&my_second_param=2&my_redirect_site=www.myothersite.com&first_tracking=value1&second_value=value2 
```

这是一个带有多个参数的正确 URL，但是当我重定向到 时`www.myothersite.com`，由于参数以“&”开头，它们会丢失。添加带有“开始”的跟踪参数是否**正确？**? 像这样：

```
www.mysite.com?my_first_param=1&my_second_param=2&my_redirect_site=www.myothersite.com?first_tracking=value1&second_value=value2 
```

如果不是，那么处理这个问题的好方法是什么？我相信重定向的责任是将跟踪参数传递给重定向 URL。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T11:02:34.243

您应该正确地对每个参数名称和值进行 URLencode，所以如果您想要的参数映射是这样的：

```
my_first_param => 1
my_second_param => 2
my_redirect_site => www.myothersite.com?first_tracking=value1&second_value=value2 
```

那么您应该将其作为查询字符串传递：

```
?my_first_param=1&my_second_param=2&my_redirect_site=www.myothersite.com%3Ffirst_tracking%3Dvalue1%26second_value%3Dvalue2 
```

您应该使用已经执行此操作的库来构建 URI 来为您处理此编码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T11:00:21.883

不，您不能在 URL 中添加第二个问号。

此外，如果您在重定向 URL 中有与号，它们将被视为主 URL 的单独参数，而不被视为连接到重定向 URL。

如果你想做这样的重定向，你需要对整个重定向的 URL 进行 URLEncode。大多数面向 Web 的语言都有标准函数可以做到这一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T11:24:03.717

这取决于您对添加跟踪参数的服务的控制程度。添加参数后可以更改url吗？

如果可以，那么您应该使用 url 构建器将跟踪参数添加到重定向 url，然后对该 url 进行 url 编码，包括跟踪参数。

如果您无法控制并且第三方修改了您的 url，那么您必须在重定向时执行此操作，读取 url 中的参数，获取您的重定向 url 和跟踪参数，将跟踪参数添加到重定向 url 之前重定向。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-16T11:04:39.970

编码参数“？” 将被 %3F 替换

# jquery - 停止超时 JQuery

> ID：14356386
> 
> 赞同：1
> 
> 时间：2013-01-16T10:37:12.177
> 
> 标签：jquery

我有以下代码：

```
<script type="text/javascript">
$("#contact_min").toggle(function(){
  $("#contact_min").animate({
    height: "300px"
  }, 1000 );
$(".arrow").html("&#x25bc;")
$(".popupcontent").html('foobar')
},
function(){
  $("#contact_min").animate({
    height: "28px"
  }, 1000 );
$(".arrow").html("&#x25B2;")
$(".popupcontent").html("")
});
</script>

<script type="text/javascript">
$(document).ready(function(){
   setTimeout(function(){
  $("#contact_min").animate({
    height: "300px"
  }, 1000 );
$(".arrow").html("&#x25bc;")
$(".popupcontent").html('foobar')
      }, 25000);

});
 </script> 
```

这非常有效，您可以单击 div 并打开它，或者您可以等待 25 秒然后它打开。但是当你点击它，然后等待 25 秒，你必须点击两次才能再次关闭它。这是因为超时仍然会打开该框，即使您已经单击了它。单击框后有没有办法停止超时，以便框在 25 秒后不打开？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-16T10:42:32.223

利用`clearTimeout()`

```
var tOut = setTimeout(function(){
                       $("#contact_min").animate({
                              height: "300px"
                       }, 1000 );
                       $(".arrow").html("&#x25bc;")
                       $(".popupcontent").html('foobar')
      }, 25000); 
```

然后要清除此超时，请这样做，`clearTimeout(tOut);`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T10:45:22.950

您只需`clearTimeout`使用存储的值调用即可停止超时

```
clearTimeout(timeout); 
```

# javascript - ie7和ie8中的jquery ui小部件复制

> ID：14356397
> 
> 赞同：2
> 
> 时间：2013-01-16T10:37:36.430
> 
> 标签：javascript, jquery-ui, internet-explorer

我在 jquery ui 上遇到了一个奇怪的行为（在 jquery 1.8.3、jquery-ui 1.9.2 上测试）。

我有一个父子小部件，在父级的 _create 方法上，我将父级的自我引用提供给新创建的子级。当我尝试从子内部访问此引用时，在构建子之后声明的所有函数和属性都不可用。

```
(function ($) {
  $.widget("ui.parentWidget", $.ui.mouse, {
    version: "@VERSION", widgetEventPrefix: "parentWidget",

_create: function () {
  var self = this;
  self.child = $("<div/>")
    .childWidget({ parent: self })
    .appendTo(self.element);
  self.parentName = "parent";
},

parentFeature: function() {
    return "feature";
},

getChild: function() {
    return this.child;
},

updateChild: function () {
    var self = this;
    self.child.childWidget("update", self);
}
});}(jQuery)); 
```

子小部件

```
(function ($) {
$.widget("ui.childWidget", $.ui.mouse, {
    version: "@VERSION", widgetEventPrefix: "childWidget",

    options: {
    },

    _create: function () {
    },

    childParent: function () {
        return this.options.parent;
    },

    updatedParent: function() {
        return this.newParent;
    },

    update: function(parent) {
        var self = this;
        self.newParent = parent;
    }
});
}(jQuery)); 
```

现在要测试我的输出，我只需创建一个父级，检索其子级，然后从子级读取子级的父级并显示结果。

```
var parent = $("<div/>").parentWidget();
parent.parentWidget("updateChild");
var child = parent.parentWidget("getChild");
var childParent = child.childWidget("childParent");
var updatedParent = child.childWidget("updatedParent"); 
```

`childParent.parentName`或者`childParent.parentFeature()`在`undefined`ie7 和 ie8 上运行良好，其他任何地方都`updatedParent`拥有它的所有内容。

我的问题是，这是一个错误吗？还是我误解了如何正确使用 jquery ui 插件。

# c# - 从 Win7 启动位于 NW 驱动器上的 C# exe 时出现“错误 26 - 错误定位服务器”；微软SQL

> ID：14356401
> 
> 赞同：1
> 
> 时间：2013-01-16T10:37:45.680
> 
> 标签：c#, sql-server, windows-7, exe, drive

我有几个使用*LINQ to SQL 类的*C# 程序。如果我将 exe 文件放在*网络驱动器*上并从那里执行它们，我会收到“<strong>error 26”，*但只有当我从 Win7 执行它时*。

**一步步**

1.  创建一个新的 C# 项目（我在 XP 机器上使用 VS 2010 Premium）。添加新的“LINQ to SQL 类”。将一些表拖放到数据上下文中（从服务器资源管理器中）。我使用的数据库都是远程服务器上的 MSSQL。

2.  关于问题：“连接字符串包含带有明文密码的凭据，并且未使用集成安全性……”，选择 **是**

3.  利用数据上下文在程序中进行一些 LINQ 查询。确保程序有效。

4.  将exe放在（映射的）网络驱动器上

5.  执行 exe（从 NW 位置）

**连接字符串**（由系统创建）如下所示（在 VS 项目中可以看到；属性 -> 设置）：

**数据源=SERVERNAME\INSTANCE；初始目录=INITIAL_CATALOG；持久安全信息=True；用户ID=USER_ID；密码=PASSWORD**

**笔记**

*   [*在XP机器上*]本地启动exe（c盘）= **OK**
*   [*在 XP 机器上*] 从 NW 驱动器启动 exe = **OK**
*   [*在Win7机器上*]在本地（C盘）启动exe = **OK**
*   [*在 Win7 机器上*] 从 NW 驱动器启动 exe =**不正常**（错误 26…）

**错误消息**：建立与 SQL Server 的连接时发生与网络相关或特定于实例的错误。服务器未找到或无法访问。验证实例名称是否正确以及 SQL Server 是否配置为允许远程连接。（提供者：SQL 网络接口，错误：26 - 错误定位服务器/指定的实例）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T10:57:08.073

有一个没有。解决此错误的方法。然而。如果您使用的是 64 位（新的 Windows 7 系统，使用 SQL BI Development Studio），您必须**在 SQL Native Client 10.0 配置（32 位）下添加别名**。[检查此链接。它可能会有所帮助： http](http://sqlerrormessages.blogspot.in/2009/12/specified-sql-server-not-found-or-error.html) ://sqlerrormessages.blogspot.in/2009/12/specified-sql-server-not-found-or-error.html

# jquery - CDN 参考哪个 jQuery 版本？

> ID：14356402
> 
> 赞同：6
> 
> 时间：2013-01-16T10:37:52.547
> 
> 标签：jquery, cdn

我想使用 Google 的 jQuery CDN，以便用户有最好的机会已经拥有 jQuery 的缓存版本。

现在我的问题是，我如何确定 jQuery 的最佳版本以最大化用户已经拥有缓存版本的概率？

我应该参考最新版本的 jQuery 吗？还是最受欢迎的版本？

比如目前最新的版本是昨天刚刚发布的jQuery 1.9.0。但是大多数网站可能还没有引用它，所以我最好使用 1.8.3？

我在想我可以只看谷歌或其他流行网站的源代码，看看他们引用的是哪个 jQuery，但是当我查看源代码时，我似乎找不到任何对 jQuery 的引用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-16T10:40:53.147

在您的网站上进行全面测试后，我将使用最新版本。

随着其他站点升级到新版本，您今天通过使用旧版本获得的任何性能提升都将在短时间内丢失。

看其他网站不是很有帮助，我只是尝试了一些。这些版本到处都是，Google、Twitter 和 Facebook 似乎没有使用 jQuery（至少没有按名称），而 stackoverflow 使用的是 1.7.1

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-16T10:42:06.110

这是一个市场份额图表：[http](http://w3techs.com/technologies/details/js-jquery/1/all) : //w3techs.com/technologies/details/js-jquery/1/all 看起来 1.7 占了上风……现在。您可以通过单击版本查看 1.7.x 统计信息：[http ://w3techs.com/technologies/details/js-jquery/1.7/all](http://w3techs.com/technologies/details/js-jquery/1.7/all)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-01-23T13:23:08.863

显然其他网站不会很快升级到新版本。下面是来自 w3techs 的所有 jquery 版本的整体链接，显示了这一点。（自 2.0 以来已经有几个月了）。这对于缓存很重要。您希望访问者最有可能访问的最受欢迎的网站托管相同的版本。尽管它不是永久性的，您可能希望更多地考虑其他事情。

该链接也是这个问题未来的一个很好的参考。您可以每次点击更深。

**[http://w3techs.com/technologies/details/js-jquery/all/all](http://w3techs.com/technologies/details/js-jquery/all/all)**

# iphone - location.load() 在 iphone 浏览器中不起作用

> ID：14356403
> 
> 赞同：0
> 
> 时间：2013-01-16T10:37:55.450
> 
> 标签：iphone, jquery-mobile

location.reload() 在桌面浏览器上工作正常，但在 iPhone 浏览器上不工作。

在 Jquery mobile 中是否有任何替代功能。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T11:55:35.950

尝试这个：

```
window.location = window.location; 
```

# python - 使用 whoosh 搜索 django haystack 模块

> ID：14356405
> 
> 赞同：1
> 
> 时间：2013-01-16T10:38:05.200
> 
> 标签：python, django, django-haystack, whoosh

我正在尝试为我的应用程序添加一个模块范围的搜索并找到 haystack-search。我带着嗖嗖声来存储搜索信息。

我已经按照文档中的说明配置了我的搜索，并且已经可以找到结果。

我遇到的问题是一个存储和电子邮件地址的字段（“test@testdomain.com”）。当我搜索“testdomain”时，我不会得到任何结果，但是当我搜索“tesdomain.com”时，我会得到一些结果。现在我想在输入“testdomain”时得到结果（输入“testdomain.com”时得到）。任何想法如何做到这一点？

有人曾在 haystack 的邮件列表中发过邮件吗？对我来说，即使我是 google-group 的成员也无法发帖。

问候马丁

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T14:47:54.113

现在我有了问题的答案。haystack 附带的标准搜索不支持按子字符串搜索。

我创建了自己的应用程序（mysearch）用于搜索，它将使用 haystacksearch

您要做的就是创建自己的 SearchForm (mysearch/forms.py)

```
from django import forms
from haystack.forms import ModelSearchForm
from haystack.query import SearchQuerySet

class AutocompleteSearchForm(ModelSearchForm):

  def search(self):
    if not self.is_valid():
      return self.no_query_found()

    if not self.cleaned_data.get('q'):
      return self.no_query_found()

    sqs = self.searchqueryset.filter(autocompletetext=self.cleaned_data.get('q'))

    sqs = sqs.models(*self.get_models())

    if self.load_all:
      sqs = sqs.load_all()

    return sqs 
```

然后你必须使用你自己的 SearchForm (mysearch/urls.py) 创建你自己的 url-route

```
from django.conf.urls.defaults import *
from haystack.forms import ModelSearchForm
from haystack.query import SearchQuerySet
from haystack.views import SearchView
from forms import AutocompleteSearchForm

sqs = SearchQuerySet()

# Without threading...
urlpatterns = patterns('haystack.views',
  url(r'^$', SearchView(searchqueryset=sqs, form_class=AutocompleteSearchForm), name='haystack_search'),
) 
```

在您的项目中使用 urls.py

```
url(r"^search/", include("mysearch.urls", namespace="Search")), 
```

代替

```
url(r'^search/', include('haystack.urls', namespace="Search")), 
```

# iphone - 如何在 IOS 6 中访问 iPhone 的联系人

> ID：14356406
> 
> 赞同：1
> 
> 时间：2013-01-16T10:38:07.050
> 
> 标签：iphone, objective-c, addressbook

我想在我的应用程序中显示联系人和联系人的详细信息。联系人列表和选择该联系人的任何联系人详细信息后，将使用地址簿显示在下一页上。我正在开发 IOS 6。在此先感谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-16T10:47:52.473

以下代码用于检索联系方式。

```
- (void)viewDidLoad {
    [super viewDidLoad];
    contactList=[[NSMutableArray alloc] init];
    ABAddressBookRef m_addressbook = ABAddressBookCreate();

    if (!m_addressbook) {
        NSLog(@"opening address book");
    }

    CFArrayRef allPeople = ABAddressBookCopyArrayOfAllPeople(m_addressbook);
    CFIndex nPeople = ABAddressBookGetPersonCount(m_addressbook);

    for (int i=0;i &lt; nPeople;i++) { 
        NSMutableDictionary *dOfPerson=[NSMutableDictionary dictionary];

        ABRecordRef ref = CFArrayGetValueAtIndex(allPeople,i);

        //For username and surname
        ABMultiValueRef phones =(NSString*)ABRecordCopyValue(ref, kABPersonPhoneProperty);
        CFStringRef firstName, lastName;
        firstName = ABRecordCopyValue(ref, kABPersonFirstNameProperty);
        lastName  = ABRecordCopyValue(ref, kABPersonLastNameProperty);
        [dOfPerson setObject:[NSString stringWithFormat:@"%@ %@", firstName, lastName] forKey:@"name"];

        //For Email ids
        ABMutableMultiValueRef eMail  = ABRecordCopyValue(ref, kABPersonEmailProperty);
        if(ABMultiValueGetCount(eMail) &gt; 0) {
            [dOfPerson setObject:(NSString *)ABMultiValueCopyValueAtIndex(eMail, 0) forKey:@"email"];

        }

        //For Phone number
        NSString* mobileLabel;
        for(CFIndex i = 0; i &lt; ABMultiValueGetCount(phones); i++) {
            mobileLabel = (NSString*)ABMultiValueCopyLabelAtIndex(phones, i);
            if([mobileLabel isEqualToString:(NSString *)kABPersonPhoneMobileLabel])
            {
                [dOfPerson setObject:(NSString*)ABMultiValueCopyValueAtIndex(phones, i) forKey:@"Phone"];
            }
            else if ([mobileLabel isEqualToString:(NSString*)kABPersonPhoneIPhoneLabel])
            {
                [dOfPerson setObject:(NSString*)ABMultiValueCopyValueAtIndex(phones, i) forKey:@"Phone"];
                break ;
            }

        [contactList addObject:dOfPerson];
        CFRelease(ref);
        CFRelease(firstName);
        CFRelease(lastName);
    }
    NSLog(@"array is %@",contactList);
    }
} 
```

[您可以下载示例代码并从我网站上的教程中](http://sugartin.info/2011/09/07/get-information-from-iphone-address-book-in-contacts/)找到更多详细信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T10:46:37.503

**添加框架**

```
#import <AddressBook/AddressBook.h>
#import <AddressBook/ABPerson.h>
#import <AddressBookUI/AddressBookUI.h> 
```

**使用委托**

```
<ABPeoplePickerNavigationControllerDelegate,ABPersonViewControllerDelegate,ABNewPersonViewControllerDelegate,ABUnknownPersonViewControllerDelegate> 
```

您可以通过以下方式显示您的联系人`ABPeoplePickerNavigationController`

```
ABPeoplePickerNavigationController *picker = [[ABPeoplePickerNavigationController alloc] init];
        [[picker navigationBar] setBarStyle:UIBarStyleBlack];
        picker.peoplePickerDelegate = self;
        // Display only a person's phone, email, and birthdate
        NSArray *displayedItems = [NSArray arrayWithObjects:[NSNumber numberWithInt:kABPersonPhoneProperty],nil];

        picker.displayedProperties = displayedItems;
        // Show the picker
        [self presentModalViewController:picker animated:YES];
        [picker release]; 
```

**初始化后，您需要使用以下方法**

```
#pragma mark - ABPeopelPickerNavigationController Delegate and DataSource Methods

- (void)peoplePickerNavigationControllerDidCancel:(ABPeoplePickerNavigationController *)peoplePicker
{
    [self dismissModalViewControllerAnimated:YES];
}

- (BOOL)peoplePickerNavigationController:(ABPeoplePickerNavigationController *)peoplePicker shouldContinueAfterSelectingPerson:(ABRecordRef)person
{
   // For get People detail
}

- (void)unknownPersonViewController:(ABUnknownPersonViewController *)unknownCardViewController didResolveToPerson:(ABRecordRef)person
{
}

- (void)newPersonViewController:(ABNewPersonViewController *)newPersonView didCompleteWithNewPerson:(ABRecordRef)person
{
}

- (BOOL)personViewController:(ABPersonViewController *)personViewController shouldPerformDefaultActionForPerson:(ABRecordRef)person property:(ABPropertyID)property identifier:(ABMultiValueIdentifier)identifier
{
    return YES;
}

- (BOOL)peoplePickerNavigationController:(ABPeoplePickerNavigationController *)peoplePicker shouldContinueAfterSelectingPerson:(ABRecordRef)person property:(ABPropertyID)property identifier:(ABMultiValueIdentifier)identifier;
{
    return YES;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T10:44:19.307

利用

```
ABRecordID recordId;
ABAddressBookRef _addressBookRef = ABAddressBookCreate ();
NSArray* allPeople = (NSArray *)ABAddressBookCopyArrayOfAllPeople(_addressBookRef);
NSString* compositeName = (NSString *)ABRecordCopyCompositeName((ABRecordRef)record);
recordId = ABRecordGetRecordID(record);
ABMultiValueRef emails = ABRecordCopyValue(record, kABPersonEmailProperty); 
```

做适当的释放只是一个片段

# php - php regex 或 preg_match colorbox (jQuery)

> ID：14356411
> 
> 赞同：0
> 
> 时间：2013-01-16T10:38:18.477
> 
> 标签：php, regex, preg-match, colorbox

我有一个广告网站，其中图像位于并命名如下：

```
images/139/16_2_139.jpg 
```

在哪里： -

*   `images/139/`是用户文件夹
*   `16`是广告的id
*   `2`是此广告可用的图片数量
*   `139`是用户标识

例子

```
images/1390/3800_12_1390.jpg
images/27/728_7_27.jpg
images/8563/13281_2_8563.jpg 
```

现在我需要在幻灯片（彩盒）中显示与此广告有关的所有图像

我从 sql 中提取广告 ID 和用户 ID

我需要 php 在目录中读取有关广告 ID 和用户 ID 的每个图像，并将其显示在彩盒幻灯片（jQuery 插件）中，广告 ID 从 1 到 15000，用户 ID 从 1 到 9000，也可以更多

我不知道更好的正则表达式或 preg_match 是否可以解决我的问题

感谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T12:09:12.877

try this

```
$str='images/1390/3800_12_1390.jpg

images/27/728_7_27.jpg

images/8563/13281_2_8563.jpg';

preg_match_all('#images/([0-9]+)/([0-9]+)_([0-9]+)_([0-9]+)#is',$str,$res);

$r=array();unset($res[0]);
foreach($res as $k=>$v){
    foreach($v as $k2=>$v2){
        $r[$k2][$k]=$v2;
    }

}

print_r($r); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T03:35:51.463

我为自己找到了一个解决方案，我分享以供参考：

```
function microtime_float()
{
   list($usec, $sec) = explode(' ', microtime());

   return ((float)$usec + (float)$sec);
}
ini_set ("display_errors", "1");
error_reporting(E_ALL);
$start = microtime_float();
$b = '<br />';  $ad = 16;   $cust = 139;
$directory = $_SERVER['DOCUMENT_ROOT'].'/ginew/advertiser/images/'. $cust .'/';
// echo $directory;
if( is_dir( $directory ) ) {
$handler = opendir( $directory );
    $images = glob("$directory{*.jpg,*.JPG,*jpeg, *JPEG}", GLOB_BRACE);
    $cnt = count($images);
echo 'total images in directory: '. $cnt.$b;

$i=0;   $img1 = '';
while ($filename = readdir($handler)) {
    if($filename != '.' && $filename != '..') {
        $base = basename($filename, ".jpg"); // echo $base.$b;
        $ext = substr(strrchr($filename, '.'), 0); // echo $ext.$b;
        $imgsize = @filesize($directory.$filename); $imgsize =     ($imgsize/1000000) .' mb';
if ( preg_match( '#'.$ad.'_([0-9]+)_'.$cust.'#', $base, $matches ) ) { 
$i++;
 $img = $i .' matches '. $matches[0] . $ext; 
$img1.= $i .' matches '. $matches[1] .'<br>'; 

 echo $img.$b;
        } // END is_dir
          echo $i .' --> '. $filename . $ext .' => '. $imgsize .'<br />';
    } // END preg_match
} // END if filename
$end = microtime_float();
} // END while
echo '/ -------------------------- /<br>';
echo $img1.$b;
echo 'matches images found: '. $i . $b;
echo 'preg_match brauch : '.($end-$start).' Sekonnen'; 
```

输出：
目录中的总图像：6
1 匹配 16_2_139.jpg
2 匹配 16_7_139.jpg
3 匹配 16_1_139.jpg
/ -------------------------- /
1 匹配 2
2 匹配 7
3 匹配 1

```
matches images found: 3
preg_match brauch : 0.00037693977355957 Sekonnen 
```

如果有人对此有更好的解决方案，请张贴感谢大家;-)

# sql - 在 Delphi 中从 sql server 表动态创建弹出菜单树

> ID：14356418
> 
> 赞同：2
> 
> 时间：2013-01-16T10:38:51.107
> 
> 标签：sql, delphi, menu, tree, delphi-xe2

我有一张这样的桌子：

```
id     parent_id     name
1          1         Root
2          1         Car
3          1         Plane
4          2         BMW
5          4         CLK 
```

如何在 Delphi 中动态创建包含所有子项的弹出菜单？

它应该是这样的：

[![图片](../Images/d49226676c2abee2e6cb54816c6359c6.png)](https://i.stack.imgur.com/WyWIT.jpg)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T12:13:48.407

假设根元素的 Parent_ID 为 NULL，您可以发出请求

```
 Select ID, Parent_ID, Name from all_my_menus 
   order by Parent_ID nulls first, ID 
   where Menu_ID = :MenuIDParameter

1   <NULL>    Root
8   <NULL>    another root
2        1    Car
4        1    Plane
3        2    BMW
5        4    CLK 
```

您还可以缓存在内存中创建的菜单项：`var MI_by_id: TDictionary<integer, TMenuItem>;`

遍历结果看起来像

```
var MI: TMenuItem;
    MI_by_id: TDictionary<integer, TMenuItem>;
begin 
  MI_by_id := TDictionary<integer, TMenuItem>.Create;
  try
    While not Query.EOF do begin
        MI := TMenuItem.Create(Self);
        MI.Caption := Query.Fields[2].AsString;
        MI.Tag := Query.Fields[0].AsInteger; // ID, would be helpful for OnClick event
        MI.OnClick := ...some click handler

        if Query.Fields[1].IsNull {no parent}
           then MainMenu.Items.Add(MI)
           else MI_by_id.Items[Query.Fields[1].AsInteger].Add(MI);

        MI_by_id.Add(MI.Tag, MI); //save shortcut to potential parent for future searching
        Query.Next;
    end;
  finally 
    MI_by_id.Free;
  end;
end; 
```

实际上，由于我们在查询中对 Parent_ID 进行了排序，因此给定父级的所有子级都会生成单个连续列表，因此在我们填充最后一个子级（即在 parent_ID 获得新值之后）并缓存之前从字典中删除填充的父级可能会更好否则在另一个局部变量中找到父级（而不是通过字典进行另一个搜索）。然而，以人为本的菜单的合理大小应该不值得这样做。但是您必须了解这种方法很可能会随着表的增长而扩展，因此会以非常快的速度开始降低速度。

*   [http://docwiki.embarcadero.com/Libraries/XE3/en/Vcl.Menus.TMenuItem.Add](http://docwiki.embarcadero.com/Libraries/XE3/en/Vcl.Menus.TMenuItem.Add)
*   [http://docwiki.embarcadero.com/CodeExamples/XE2/en/Generics.Collections.TDictionary_(Delphi](http://docwiki.embarcadero.com/CodeExamples/XE2/en/Generics.Collections.TDictionary_(Delphi) )

注意：这也要求对于每个非根元素 ID > ParentID（将 CHECK CONSTRAINT 放在表上）

```
1   <NULL>    Root
8   <NULL>    another root
7        1    Plane
3        4    BMW
4        7    CLK
5        8    Car 
```

这将导致 BMW 在其父 CLK 创建之前绑定创建。违反该条件可以通过以下几种方式克服：

*   recursive load: `select <items> where Parent_id is null`，然后为每个添加的菜单项做`select <items> where Parent_id = :current_memuitem_id`，依此类推。这就像 VirtualTreeView 会工作
*   要求 SQL 服务器对树进行排序和展平 - 这通常称为自递归 SQL 选择，并且取决于服务器。
*   引入另一个集合变量 - 没有父级的菜单项。在将每个新项目添加到菜单之后，如果有待处理的子项要从中提取并移动到新创建的父项中，则应搜索此集合。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-16T11:54:31.000

对于这样一个简单的问题，解决方案太多了。太糟糕了，你得到了订购的 ID，因为没有订购的 ID，事情会更有趣。这是我自己的解决方案。在一个空窗体上放置一个按钮、一个 TClientDataSet 和一个 TPopupMenu。使表单的 PopupMenu = PopupMenu1 可以看到结果。将此添加到 Button1.OnClick：

注意：我*故意*使用 TClientDataSet 而不是真正的查询。这个问题与查询无关，这个解决方案适用于你扔给它的任何 TDataSet 后代。只需确保结果集按顺序排列`id`，否则您可以在父节点之前看到子节点。另请注意，一半的代码用于用问题中的示例数据填充 ClientDataSet！

```
procedure TForm16.Button1Click(Sender: TObject);
var Prev: TDictionary<Integer, TMenuItem>; // We will use this to keep track of previously generated nodes so we do not need to search for them
    CurrentItem, ParentItem: TMenuItem;
begin
  if not ClientDataSet1.Active then
  begin
    // Prepare the ClientDataSet1 structure
    ClientDataSet1.FieldDefs.Add('id', ftInteger);
    ClientDataSet1.FieldDefs.Add('parent_id', ftInteger);
    ClientDataSet1.FieldDefs.Add('name', ftString, 100);

    ClientDataSet1.CreateDataSet;

    // Fill the dataset
    ClientDataSet1.AppendRecord([1, 1, 'Root']);
    ClientDataSet1.AppendRecord([2, 1, 'Car']);
    ClientDataSet1.AppendRecord([3, 1, 'Plane']);
    ClientDataSet1.AppendRecord([4, 2, 'BMW']);
    ClientDataSet1.AppendRecord([5, 4, 'CLK']);
  end;

  // Clear the existing menu
  PopupMenu1.Items.Clear;

  // Prepare the loop
  Prev := TDictionary<Integer, TMenuItem>.Create;
  try
    ClientDataSet1.First; // Not required for a true SQL Query, only required here for re-entry
    while not ClientDataSet1.Eof do
    begin
      CurrentItem := TMenuItem.Create(Self);
      CurrentItem.Caption := ClientDataSet1['name'];

      if (not ClientDataSet1.FieldByName('parent_id').IsNull) and Prev.TryGetValue(ClientDataSet1['parent_id'], ParentItem) then
        ParentItem.Add(CurrentItem)
      else
        PopupMenu1.Items.Add(CurrentItem);

      // Put the current Item in the dictionary for future reference
      Prev.Add(ClientDataSet1['id'], CurrentItem);

      ClientDataSet1.Next;
    end;
  finally Prev.Free;
  end;
end; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-16T11:08:01.543

尝试这个

```
procedure TForm1.MyPopup(Sender: TObject);
begin
  with Sender as TMenuItem do ShowMessage(Caption);
end;

procedure TForm1.Button1Click(Sender: TObject);
var 
  MyItem,MySubItem1: TMenuItem;
begin
  Inc(Num);
  MyItem:=TMenuItem.Create(Self);
  MySubItem1:=TMenuItem.Create(Self);

  MyItem.Caption:='Hello'+IntToStr(Num);
  MySubItem1.Caption:='Good Bye'+IntToStr(Num);

  MainMenu1.Items.Add(MyItem);
  MainMenu1.Items[0].Insert(num-1,MySubItem1);

  MyItem.OnClick:=MyPopUp;
  MySubItem1.OnClick:=MyPopUp;
end; 
```

取自[http://www.greatis.com/delphicb/tips/lib/components-addmenuitem.html](http://www.greatis.com/delphicb/tips/lib/components-addmenuitem.html)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-17T01:44:12.667

有趣的难题......另一个深夜的想法，重用的实用答案:)

制作派生组件：

```
type
  TCascadeMenuItem = class(TMenuItem)
  private
    Id: Integer;
  public
    function AddItem(const ToId, WithId: Integer; AName: string): Boolean;
  end; 
```

带代码

```
function TCascadeMenuItem.AddItem(const ToId, WithId: Integer; AName: string): Boolean;
var
  i: Integer;
  cmi: TCascadeMenuItem;
begin
  if ToId = Id then
  begin
    cmi := TCascadeMenuItem.Create(Owner);
    cmi.Caption := AName;
    cmi.Id := WithId;
    Add(cmi);
    Result := True;
  end
  else begin
    i := 0;
    Result := False;
    while (i < Count) and (not Result) do
    begin
      Result := TCascadeMenuItem(Items[i]).AddItem(ToId,WithId, ANAme);
      inc(i);
    end;
  end; 
```

结尾;

主要形式，假设您的数据：

```
procedure TForm4.Button2Click(Sender: TObject);
var
  mi: TCascadeMenuItem;
  i: Integer;
  Added: Boolean;
begin
    cds1.First;
    while not cds1.Eof do
    begin
      i := 0;
      Added := False;
      while (i < pup.Items.Count) and (not Added) do
      begin
        Added := TCascadeMenuItem(pup.Items[i]).AddItem(cds1Parent_Id.AsInteger, cds1id.AsInteger, cds1name.AsString);
        inc(i);
      end;
      if not Added then
      begin  // new root
        mi := TCasCadeMenuItem.Create(Self);
        mi.Caption := cds1name.AsString;
        mi.id := cds1Parent_Id.AsInteger;
        pup.Items.Add(mi);
      end;
      cds1.Next;
    end;
end; 
```

您可以派生一个 TCascasePopupMenu 并将其放在调色板上:)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-16T11:49:14.043

此解决方案要求 root 的 parent_id 为 0，用

```
Select 1 as ID,          0 as Parent_ID,         'Root' as Name
union
Select 2,          1,        ' Car'
union
Select 3 ,         1,         'Plane'
union
Select 4,          2,        'BMW'
union
Select 5,          4,         'CLK' 
```

应该通过优化，只是时间不够...

```
Function GetMenu(pop:TPopupmenu;ID:Integer):TMenuItem;
var
 i:Integer;
 Function CheckItem(mi:TMenuItem):TMenuItem;
    var
     i:Integer;
    begin
      Result := nil;
      if mi.Name = 'DYN_' + INtToStr(ID) then Result := mi
      else  for i := 0 to mi.Count-1 do
        if not Assigned(Result) then Result := CheckItem(mi[i]);
    end;
begin
  Result := nil;
  for i := 0 to pop.Items.Count-1 do
    begin
      if not Assigned(Result) then Result := CheckItem(pop.Items[i]);
      if Assigned(Result) then Break;
    end;
end;

Function InsertMenuItem(pop:TPopupMenu;mi:TMenuItem;ID:Integer;Const caption:String):TMenuItem;
begin
    Result := TMenuItem.Create(pop);
    Result.Caption := caption;
    Result.Name := 'DYN_' + INtToStr(ID) ;
    if not Assigned(mi) then pop.Items.Add(Result) else mi.Add(Result);

end;

Function AddMenuItem(pop:TPopupmenu;ID:Integer;Ads:TDataset):TMenuItem;
begin
  Ads.Locate('ID',ID,[]);
  Result := GetMenu(pop,id);
  if (not Assigned(Result))   then
    begin
     if  (Ads.FieldByName('parent_ID').AsInteger<>0) then
       begin
        result := AddMenuItem(pop,Ads.FieldByName('parent_ID').AsInteger,Ads);
        Ads.Locate('ID',ID,[]);
       end;
     Result := InsertMenuItem(pop,Result,ID,Ads.FieldByName('Name').AsString);
    end;
  Ads.Locate('ID',ID,[]);
end;

procedure TForm1.Button1Click(Sender: TObject);

begin
   while not ADS.Eof do
      begin
        AddMenuItem(Popupmenu1,ads.FieldByName('ID').AsInteger,Ads);
        Ads.Next
      end;
end; 
```

# android - 在android中的数据库Sql lite中将数据插入到表中

> ID：14356426
> 
> 赞同：1
> 
> 时间：2013-01-16T10:39:12.980
> 
> 标签：android

嗨：在插入方法中使用 UserDAO 类插入查询存在返回类型不匹配问题。我有很多字段，但我想向少数字段插入数据。请帮助我提前谢谢。

```
Veiwholder.btnSave.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {

        String Firstname =Veiwholder.etFirstName.getText().toString();
        String Lastname =Veiwholder.etLastName.getText().toString();
        String Password =Veiwholder.etPassword.getText().toString();
        UsersDAO userDAO = new UsersDAO(NewDataEnteryActivity .this);
        Users userDO = userDAO.AddNewRecod(Firstname, Lastname, Password);
        }
    });
} 
```

这是另一个 userDaO 类代码。这也是我的查询类。

```
public  int AddNewRecod(String FirstName,String LastName,String Password ) {
    int row_id = -1;
    try {

        OpenConnection(context);

        ContentValues contentValue = new ContentValues();
        contentValue.put(Users.FIELD_FIRST,userDO.getfirstName());
        contentValue.put(Users.FIELD_LAST_NAME,userDO.getLastName());
        //contentValue.put(Users.FIELD_EMAIL, userDO.GetEmail());
        contentValue.put(Users.FIELD_PASSWORD,userDO.getpassword());
        //contentValue.put(Users.FIELD_CREATION_DATE,userDO.GetCreationDate());
        //contentValue.put(Users.FIELD_IS_ACTIVE, userDO.GetIsActive());

        row_id = (int) dbSqlLiteDataObject.insert(Users.TABLE_USERS, null,
                contentValue);

        CloseConnection();
    } catch (SQLiteException ex) {
        CloseConnection();
        Log.e("Insert " + Users.TABLE_USERS
                + "into database exception caught", ex.getMessage());
        row_id = -999;
    }

    return row_id;

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T10:48:48.140

类型不匹配问题是由于`AddNewRecod()`返回 a`int`而不是`Users`类型。

该`AddNewRecod()`方法返回`row_id`您可以使用此 id 来查找`Users`记录并在创建新用户后存储该记录。

（您的问题中没有足够的详细信息来为您提供更多信息和如何解决此问题的代码示例）

# c# - 使用 C# TCP 套接字将 Java TCP 服务器连接到 Ubuntu 到 Windows 7

> ID：14356427
> 
> 赞同：1
> 
> 时间：2013-01-16T10:39:17.083
> 
> 标签：c#, java, sockets, ubuntu, ubuntu-11.04

我在 vmware 中运行了 Ubuntu 11.10。我在 Ubuntu 中运行 Java tcp 服务器。因此，当我将此服务器与来自 Ubuntu 的客户端连接时，它工作正常。但是当我试图从另一个操作系统（Windows 7）连接这个服务器时，它显示连接错误。我尝试连接 java 和 C# 客户端，但两次都显示连接错误。这是错误消息：

> System.Net.Sockets.SocketException：无法建立连接，因为目标机器在 System.Net.Sockets.Socket.DoConnect(EndPoint endPointSnapshot, SocketAddress socketAddress) 处主动拒绝了它 192.168.0.129:20000 在 System.Net.Sockets.Socket .Connect(EndPoint remoteEP) at TestUbuntuSocket.Form1.button1_Click(Object sender, EventArgs e) at System.Windows.Forms.Control.OnClick(EventArgs e) at System.Windows.Forms.Button.OnClick(EventArgs e) at System。 Windows.Forms.Button.OnMouseUp(MouseEventArgs meevent) 在 System.Windows.Forms.Control.WmMouseUp(Message& m, MouseButtons button, Int32 clicks) 在 System.Windows.Forms.Control.WndProc(Message& m) 在 System.Windows。在 System.Windows.Forms.Button.WndProc(Message& m) 在 System.Windows 的 Forms.ButtonBase.WndProc(Message& m)。Forms.Control.ControlNativeWindow.OnMessage(Message& m) 在 System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message& m) 在 System.Windows.Forms.NativeWindow.Callback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam)

这是我的 C# 客户端套接字代码：

```
 Socket s = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);
        s.Connect(new IPEndPoint(IPAddress.Parse(textBox1.Text), int.Parse(textBox2.Text)));
        if (s.Connected)
        {
            s.Send(Encoding.ASCII.GetBytes(textBox3.Text));
        }
        else
            MessageBox.Show("Not Connected"); 
```

这是我的 Java 客户端套接字代码：

```
 Socket socket = null;
    try{
        socket = new Socket(txtIp.getText(), Integer.parseInt(txtPort.getText()));
    }
    catch(Exception exc){
        JOptionPane.showMessageDialog(this, "Server is not available!!");
        return;
    }
    try{
        PrintWriter out = new PrintWriter(socket.getOutputStream(),true);
        out.println(txtMessage.getText());
        socket.close();
    }
    catch(Exception exc){
        JOptionPane.showMessageDialog(this, "Error when sending data!!");
    } 
```

服务器 Java 代码：

```
 ServerSocket s = new ServerSocket(port);

        while (start)
        {
            Socket incoming = s.accept();
            BufferedReader in = new BufferedReader(new InputStreamReader(incoming.getInputStream()));
            String message = "";
            String line = in.readLine();
            while(line != null){
                 message += line;
                 line = in.readLine();
            }
            JOptionPane.showMessageDialog(null, message);
        } 
```

这是“sudo netstat -atnp”的输出：

> Proto Recv-Q Send-Q 本地地址 外部地址 状态 PID/程序名称 tcp 0 0 0.0.0.0:22 0.0.0.0:* LISTEN 408/sshd
> tcp 0 0 127.0.0.1:631 0.0.0.0:* LISTEN 925/cupsd
> tcp6 0 0 ::1:42098 :::* LISTEN 2168/java
> tcp6 0 0 :::22 :::* LISTEN 408/sshd
> tcp6 0 0 ::1:631 :::* LISTEN 925/cupsd
> tcp6 0 0 :::20000 :::* LISTEN 3015/java
> tcp6 0 0 127.0.0.1:20000 127.0.0.1:56269 CLOSE_WAIT 3015/java

那么我错了吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T13:33:02.323

服务器端是否有任何错误？您的服务器一次只接受一个请求，通常您会将接受的套接字传递给另一个线程来处理它，而不会阻塞服务器。我不确定 Dialog 是如何阻止服务器线程的，你看到服务器端有什么反应吗？

您可以尝试的另一件事是设置不同的端口，例如 8080，这通常不应该被阻止。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T11:06:33.680

使用 telnet 主机端口检查防火墙。
如果您收到连接被拒绝/超时，则可能是网络问题或服务器无法正常工作，如果您可以输入回车并且线路更改/服务器应答，则一切都很好。
[此链接](http://www.itdoescompute.com/2009/10/29/how-to-enable-telnet-in-windows-7/)解释了在 Windows 上安装 telnet。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T10:47:55.177

不太了解java，但通常必须在服务器上调用listen/accept 类型的方法，没有这些，服务器将不会监听传入的连接。

如果您使用 telnet 在同一 ip/端口上的服务器上本地连接并且失败，这将指向相同的诊断。如果 telnet 成功，则可能是防火墙/网络设置问题。

[编辑]

我认为您的问题可能是您的 ubuntu 机器是为 ipv6 设置的，而您的 java 代码只在 ipv6 上侦听。

[在此处](https://wiki.ubuntu.com/IPv6)查看有关 ipv6 的文档。

检查你的 netstat 的输出，你的 java 代码是这里的特色：

```
tcp6 0 0 :::20000 :::* LISTEN 3015/java 
```

这意味着您有一个使用端口 20000 侦听 ipv6 多播（任何 ipv6 地址都可以连接）的 java 进程。

如果没有一个神奇的过程来将 ipv4 请求隧道传输到 ubuntu 机器内的 ipv6 或更改您的代码以仅监听 ipv4/以及，您的 Windows 客户端将需要：

*   [启用 ipv6](http://windows.microsoft.com/en-GB/windows7/IPv6-frequently-asked-questions)
*   使用 ubuntu 机器的 ipv6 地址连接

您应该能够使用系统菜单或运行“ifconfig”找到 ipv6 地址。它比 ipv4 地址更难输入，但您应该能够从 Windows 7 ping 该地址并连接到您的服务器。

# message - 将收到的来自客户的 hl7 消息存储在数据库中的最佳方法

> ID：14356431
> 
> 赞同：5
> 
> 时间：2013-01-16T10:39:22.917
> 
> 标签：message, hl7

大家好，我是新来的。

我想知道将 hl7 消息存储在 mysql 数据库中的表中的最佳方法，该表仅将一列存储为 hl7 消息或行和列，如发送应用程序列、接收应用程序列等。

我找不到合适的答案，所以请帮助我。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T13:52:58.117

解析 HL7 并将每个 HL7 段存储在一个单独的字段中对于数据库来说是一种过度杀伤（HL7 具有分层结构，并且从每个版本到另一个版本都会发生变化）。

我建议只存储您需要的属性（ID、发送应用程序、时间戳...）并将原始 HL7 作为文本（或 xml）放在一个字段中。然后，您可以使用 HL7 并在需要时再次对其进行解析。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T01:08:00.443

还值得注意的是，在 Mirth Connect 3.0 中，您将能够基于每个通道添加自定义元数据列，这些列存储在数据库中并被索引。例如，您可以在频道中添加“发送应用程序”列，并使用转换器将数据从 MSH.3.1 中提取出来。除了将此值存储在单独的数据库列中之外，您还可以轻松地查看 Channel Messages 屏幕中每条消息的该列，甚至可以在该列上进行搜索。它对于患者 ID、姓名、登录号等内容特别有用。

3.0 GA 将在今年晚些时候发布，但第一个测试版已经发布：[http ://www.mirthcorp.com/community/forums/showthread.php?t=8126](http://www.mirthcorp.com/community/forums/showthread.php?t=8126)

# sql - 将日期时间格式化为月 - 年，然后订购 desc

> ID：14356432
> 
> 赞同：0
> 
> 时间：2013-01-16T10:39:28.283
> 
> 标签：sql, sql-server-2008, datetime

任何人都可以帮助解决这个问题，我正在尝试从表中选择最近 12 个月的日期，然后更改格式以使日期显示为：

2013 年 2 月

2013 年 1 月等

我可以将格式更改为上述格式，但这会将日期更改为字符串，从而无法订购 DESC。

我怎样才能保持上述格式，并且仍然按 desc 排序

```
SELECT DISTINCT TOP 12 
--CONVERT(date, NewsDatePosted, 120) AS ArchiveTravelNewsByMonth
--CONVERT(CHAR(4), NewsDatePosted, 100) + CONVERT(CHAR(4), NewsDatePosted, 120) AS MY
--DatePart(Year,NewsDatePosted) AS YearPosted 
--datename(month,NewsDatePosted) + ' ' + DatePart(Year,NewsDatePosted) AS YearPosted
FROM dbo.at_News
order by ArchiveTravelNewsByMonth DESC 
```

谢谢

乔治

* * *

```
SELECT DISTINCT TOP 12 SUBSTRING(CONVERT(VARCHAR(11), NewsDatePosted, 113), 4, 8)
AS ArchiveTravelNewsByMonth,
NewsDatePosted
FROM dbo.at_News
ORDER BY CONVERT(DATETIME, CONVERT(CHAR(4), NewsDatePosted, 100) + CONVERT(CHAR(4), NewsDatePosted, 120)) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T11:08:11.307

请尝试通过添加 order by 子句和内部选择来尝试

```
SELECT 
    ArchiveTravelNewsByMonth, 
    NewsDatePosted
FROM(
    SELECT DISTINCT TOP 12 SUBSTRING(CONVERT(VARCHAR(11), NewsDatePosted, 113), 4, 8) AS ArchiveTravelNewsByMonth,
        NewsDatePosted
    FROM dbo.at_News)x
ORDER BY CONVERT(DATETIME, ArchiveTravelNewsByMonth) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T11:28:41.173

```
 create table at_News(NewsDatePosted datetime,Row int identity(1,1))

  Insert into at_News values('2011-01-01')
  Insert into at_News values('2006-10-25')
  Insert into at_News values('2012-09-10')
  Insert into at_News values('2002-06-20')
  Insert into at_News values('2008-12-01')
  Insert into at_News values('2008-10-01')
  Insert into at_News values('2008-04-01')

  select CONVERT(CHAR(4), NewsDatePosted, 100) + CONVERT(CHAR(4), NewsDatePosted, 120)      from  at_News order by NewsDatePosted desc 
```

使用ORDER BY CLAUSE 中的日期时间列，不使用任何格式**。**

# c++ - WMI - 从 VC++ 中的多个类进行查询

> ID：14356434
> 
> 赞同：1
> 
> 时间：2013-01-16T10:39:43.557
> 
> 标签：c++, visual-c++, notifications, wmi

我正在使用 MSstudio 2010 和 vc++ 平台。我想从远程机器查询和接收来自多个 WMI 类的通知。我能够收到来自 1 个班级的通知，例如。网络适​​配器更改通知。有什么方法可以在 C++ 中分别从多个类中查询（不过滤）？

使用“ManagementObjectSearcher”是 c# 上的 1 个选项，但我特别希望在 c++ 上使用它！有没有人做过类似的事情或有其他选择吗？提前致谢 ：）

# java - Jboss 7.1、Eclipse 4,2 和 OSGI - ClassNotFoundException

> ID：14356440
> 
> 赞同：1
> 
> 时间：2013-01-16T10:40:05.990
> 
> 标签：java, eclipse, osgi, jboss7.x

我试图在 Jboss 7.1 上部署一个带有 eclipse 和 jboss 工具的 osgi 包。在捆绑包启动期间，jboss 在我的插件（激活器）上抛出 ClassNotFoundException

```
Caused by: java.lang.ClassNotFoundException: testjboss.Activator from [Module       "deployment.TestJboss:1.0.0.qualifier" from Service Module Loader] 
```

如果我用eclipse（导出->可部署插件和片段）将插件导出到jboss的部署文件夹并启动jboss，插件将毫无例外地在Jboss上启动。OSGI-Bundle 很简单，只包含“Activator”类。

我的清单：

```
Manifest-Version: 1.0
Bundle-ManifestVersion: 2
Bundle-Name: TestJboss
Bundle-SymbolicName: TestJboss
Bundle-Version: 1.0.0.qualifier
Bundle-Activator: testjboss.Activator
Import-Package: org.osgi.framework
Bundle-RequiredExecutionEnvironment: JavaSE-1.6 
```

我的 build.properties：

```
source.. = src/
output.. = bin/
bin.includes = META-INF/,\
           . 
```

没什么特别的，简单的 OSGI-Bundle。eclipse 和 Jboss - OSGI 出了点问题。有人知道出了什么问题吗？

更新1：罐子看起来像：

```
jbosstest.jar
|--- META-INF
     |---MANIFEST.MF
|--- testjboss
     |---Activator.class 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T12:31:26.943

我遇到了一个类似的问题，通过在清单中包含这个问题得到了解决

```
Bundle-ClassPath: . 
```

似乎有时没有它它会正常工作，但有时不会，从来没有想过，但这些天我总是把它包括在内。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-10T03:51:22.093

对于 Jboss 7，它使用模块化类加载器。您需要在 manifest 或 jboss-deployment-structure.xml 中将依赖项指定为 org.osgi.framework

# c# - 在 C# 中从基类型转换为派生类型

> ID：14356442
> 
> 赞同：0
> 
> 时间：2013-01-16T10:40:11.830
> 
> 标签：c#, oop

所以我知道你不能从基类型转换为派生类型，因为 Animal 可能不是 Cat 等。

鉴于此，您能否建议一种更好的方法来实现此代码，并避免重复操作符声明和实例化新对象？

```
class scientific_number
{
    public decimal value;
    public int precision;
    public static implicit operator scientific_number(decimal value)
    {
        return new scientific_number() { value = value, precision = 0 };
    }
    public static implicit operator scientific_number(int value)
    {
        return new scientific_number() { value = (decimal)value, precision = 0 };
    }
    public static implicit operator scientific_number(double value)
    {
        return new scientific_number() { value = (decimal)value, precision = 0 };
    }
}
class amu : scientific_number 
{
    public static implicit operator amu(scientific_number scientific_number)
    {
        return new amu() { value = scientific_number.value, precision = scientific_number.precision };
    }
    public static implicit operator amu(decimal value)
    {
        return new amu() { value = value, precision = 0 };
    }
    public static implicit operator amu(int value)
    {
        return new amu() { value = (decimal)value, precision = 0 };
    }
    public static implicit operator amu(double value)
    {
        return new amu() { value = (decimal)value, precision = 0 };
    }

    public kg ToEarthKg()
    {
        return this.value / 0.00000000000000000000000000166053886;
    }
}
class kg : scientific_number
{
    public static implicit operator kg(scientific_number scientific_number)
    {
        return new kg() { value = scientific_number.value, precision = scientific_number.precision };
    }
    public static implicit operator kg(decimal value)
    {
        return new kg() { value = value, precision = 0 };
    }
    public static implicit operator kg(int value)
    {
        return new kg() { value = (decimal)value, precision = 0 };
    }
    public static implicit operator kg(double value)
    {
        return new kg() { value = (decimal)value, precision = 0 };
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T10:43:26.620

> 所以我知道你不能从基类型转换为派生类型，因为 Animal 可能不是 Cat 等。

错误的。

你可以，如果对象不是目标类型，你会得到一个异常。

如果您使用`as`运算符并且目标类型是引用类型，则如果无法执行强制转换，您将获得 null。

所以

```
Animal d = new Dog();

var c = (Cat)d;   // Will throw

var c1 = d as Cat; // Will return null (assuming Dog is a reference type). 
```

# c++ - C++ 指针和变量赋值

> ID：14356445
> 
> 赞同：0
> 
> 时间：2013-01-16T10:40:25.630
> 
> 标签：c++, pointers, variables, heap-memory

所以，我的程序面临一个非常非常不寻常的问题。这是我的程序

```
 void insertItem (Song *&, Song *&, char ar [], int);
    void printList (Song *);
    void deleteList (Song *&, Song *&);
    void processList (Song *&);

    int main (int argc, char * argv[]) {    
    char * filename = argv[1]; char line [31];

int m, n, a;
------------

    /*
        Head and tail pointer to maintain a list of songs
    */
    Song *head;
    Song *tail;

    if (filename == NULL)
        exit(1);    

    fstream fio;
    fio.open (filename, ios::in);

**fio >> m; fio >> n;**
-----------------------

    // Reading the file
    while (!fio.eof()){

**fio >> a;**
-------------

        fio >> line;

**insertItem (head, tail, line, a);**
-------------------------------------

    }
    fio.close();

    printList (head);

**for (int b = 0; b < n; ++b) processList (head);**
---------------------------------------------------

    cout << "\nDeleting List";
    deleteList (head, tail);
    return 0;
    } 
```

我声明了 3 个静态变量（m、n 和 a），并使用了这三个变量。我面临的问题是，一旦尝试在 for 循环中初始化变量**b ，就会出现分段错误。**我使用 gdb 对其进行了调试，当我尝试在 for 循环中使用变量**b时，头指针的值发生了变化。**相反，如果我使用以前使用过的变量，例如 m 或 a 而不是为 for 循环创建一个新变量，它运行得非常好。头指针的地址不会改变。关于这里可能发生什么的任何线索？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T11:07:46.633

您的代码中至少有两个错误：您从未初始化`head`并且`tail`（因此您对它们所做的任何事情都是未定义的行为），并且您在使用之前没有检查您的输入是否成功。（您的第一个循环可能应该是`while ( fio >> line )`。但您不想使用`m`or `n`，除非您已检查输入是否成功。）

# c++ - 羊群不阻挡

> ID：14356451
> 
> 赞同：1
> 
> 时间：2013-01-16T10:40:47.497
> 
> 标签：c++, c, linux, file, concurrency

我想同步对文件的访问。我正在使用 Linux 和 g++。

我想通过使用函数来锁定文件`flock()`。我开发了 2 个测试应用程序，向/从同一个文件写入和读取。他们都`flock()`用`LOCK_SH`.

作家首先开始，写作，然后睡觉。第二个应用程序稍后启动。我期待阅读器应用程序在调用时会阻塞，`flock()`因为编写器进程没有释放锁。

这是正确的期望还是它们仅在`read()`同时`write()`被调用时才阻塞，即在同一确切时间？我误解了什么？

```
 PROG A                PROG B
    -open file
    -flock                -open file
    -write                -sleep 5     
    -sleep 1000           -flock    ** expected to block ?? **
    -close                -read data 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-16T10:49:18.543

`flock`只有在至少一个进程使用它时才会阻塞`LOCK_EX`：

*   如果某个进程持有独占锁，则任何尝试获取独占/共​​享锁的进程都将被阻止。
*   如果某个进程持有共享锁，则试图获得独占锁的进程将被阻止。

通常，您应该使用共享锁进行读取，而使用独占锁进行写入或读/写。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T10:46:51.043

`LOCK_SH`是共享锁。这意味着同时持有这样一个锁的多个进程没有问题。读者使用这种锁。

# css - 圆角菜单

> ID：14356452
> 
> 赞同：2
> 
> 时间：2013-01-16T10:40:50.357
> 
> 标签：css, menubar

我正在尝试创建一个带有圆角的菜单栏，但是当我将其添加`float:left`到`li`元素时，圆角消失了......

这是我的代码：

```
<ul>
  <li>jkfasdf</li>
  <li>jkfasdf</li>
  <li>jkfasdf</li>
</ul>

ul{
  background: red;
  border-top-left-radius: 5px;
  border-bottom-left-radius: 5px;
  border-top-right-radius: 5px;
  border-bottom-left-radius: 5px;
}

li {
  padding: 5px;
  #float: left; #toggle this
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-16T10:45:19.240

添加`overflow:hidden`到`ul`的CSS：

```
ul{
  background: red;
  border-top-left-radius: 5px;
  border-bottom-left-radius: 5px;
  border-top-right-radius: 5px;
  border-bottom-right-radius: 5px;
  overflow:hidden;
} 
```

目前，当你添加一个`float:left;`ul 时，高度变成了 0px。这就是为什么它看起来像圆角消失了。

`overflow:hidden`是解决此类问题的方法之一。在此处查看演示：http: [//jsfiddle.net/2x3Vm/](http://jsfiddle.net/2x3Vm/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T10:45:52.700

最快的方法就是将你的 ul 设置为向左浮动

```
ul{
  background: red;
  border-top-left-radius: 5px;
  border-bottom-left-radius: 5px;
  border-top-right-radius: 5px;
  border-bottom-left-radius: 5px;
  float:left;
} 
```

您的问题是，当您浮动时，您的 ul 中的列表元素会丢失宽度的上下文。另一种方法是清除您的列表

```
ul{
  background: red;
  border-top-left-radius: 5px;
  border-bottom-left-radius: 5px;
  border-top-right-radius: 5px;
  border-bottom-left-radius: 5px;

}

li {
  padding: 5px;
  float: left; 
}
.clear{clear:both;}

<ul>
  <li>jkfasdf</li>
  <li>jkfasdf</li>
  <li>jkfasdf</li>
  <li class="clear"></li>
</ul> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-16T10:46:55.723

如果您只想显示您的 LI 并排显示，请显示：inline-block；实际上可能比浮动元素更好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-16T10:44:50.713

这个问题的解决方案是常见的[clearfix](http://www.webtoolkit.info/css-clearfix.html)。

这是一个修复它的小提琴：http: [//jsfiddle.net/5mxJA/](http://jsfiddle.net/5mxJA/)。只需将`clearfix`课程添加到您的`ul`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-16T10:45:12.100

那是因为你对 . 将此添加到您的 CSS 中：

```
.clearfix { *zoom: 1; }
.clearfix:after { 
width: 100%; 
content: ''; 
font-size: 0; 
line-height: 0; 
text-indent: -4000px; 
clear: both; 
display:block; 
} 
```

然后将类添加`.clearfix`到您的`<ul>`：

```
<ul class="clearfix">
  <li>jkfasdf</li>
  <li>jkfasdf</li>
  <li>jkfasdf</li>
</ul> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-16T10:47:53.180

你必须使用清晰的 div。

```
<ul>
  <li>jkfasdf</li>
  <li>jkfasdf</li>
  <li>jkfasdf</li>
  <li class="clear"></li>
</ul> 
```

和

```
ul{
  background: red;
  border-top-left-radius: 5px;
  border-bottom-left-radius: 5px;
  border-top-right-radius: 5px;
  border-bottom-left-radius: 5px;
}

li {
  margin: 5px;
  padding: 5px;
  float: left;
  background: blue;
}
li.clear{
  width: 0;
  height: 0;
  float: none;
  clear: both;
  margin: 0;
  padding: 0;
} 
```

父母忽略了风格浮动的孩子的身高。

有关浮动的更多信息，请参阅[此链接](https://developer.mozilla.org/en-US/docs/CSS/float)。

有关清除的更多信息，请参阅[此链接](https://developer.mozilla.org/en-US/docs/CSS/clear)。

[你可以在这里](http://jsfiddle.net/tRqWH/3/)看到一个样本。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-16T10:48:19.433

正如其他人所说，浮子使 UL 的高度无效。

而不是一个clearfix，我会为UL设置一个默认高度：

```
ul{
  list-style: none;
  background: red;
  border-top-left-radius: 5px;
  border-bottom-left-radius: 5px;
  border-top-right-radius: 5px;
  border-bottom-left-radius: 5px;
  height: 30px;
}

li {
  padding: 5px;
  float: left;
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-01-21T10:02:21.623

我在我的一个示例项目中使用了该代码，它给了我使用 <border-bottom-left-radius: 5px; 的警告。两次 >。

您忘记添加右下角半径，这可能会影响您的代码。

谢谢

# php - php中数组中浮点值的总和

> ID：14356459
> 
> 赞同：0
> 
> 时间：2013-01-16T10:40:59.170
> 
> 标签：php, floating-point, number-formatting

```
$gtz="select * from add_to_cart where user_id='$userid'";
$gz1=mysql_query($gtz);

 while($gz2=mysql_fetch_array($gz1))
 {

    $tprcz[]=$gz2['total_price'];

 }

$fullquantityz=array_sum($tqtyz); 
```

$tprcz[] 返回浮点值（例如 2.00 和 4.00 ）。但是当找到总和时 $fullquantityz 返回值作为整数而不是浮点数，即 2.00 + 4.00 = 6 ，我希望将值打印为 2.00 + 4.00 = 6.00

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T10:45:18.973

尝试 number_format($fullquantityz,2)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T10:46:08.770

```
return number_format((float)$number, 2, '.', ''); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T10:51:12.603

```
return sprintf('%.2f',$fullquantityz); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-16T10:43:12.727

请参考链接： http: [//php.net/manual/en/function.number-format.php](http://php.net/manual/en/function.number-format.php)，它会给你代码来格式化你的号码。

# mobile - gzip -9/-6/-1 通过移动连接

> ID：14356461
> 
> 赞同：0
> 
> 时间：2013-01-16T10:41:11.853
> 
> 标签：mobile, gzip

-9 对客户端 CPU 的影响是否高于默认级别 (6)。

然后，在移动客户端上进行测试呢？

我的猜测： - 在 Edge 连接上使用压缩版本 - 在 3G/Wifi 连接上使用缩小的未压缩版本

使用 Cordova 之类的库，很容易找到我使用的连接类型。

但是，根据 CPU 使用不同的版本（gzipped/non gzipped）是否也是一个好主意？

我的猜测： - 在 iphone 3GS 上未压缩 - 在 android 的旧 CPU 上未压缩（抱歉，我没有列表） - 在 iphone 4GS + 上压缩

这有意义吗？有没有一种简单的方法可以找出哪些 CPU 将具有增益/损失解压缩比？

# android - 怎么了？gridviev 显示不正确

> ID：14356462
> 
> 赞同：2
> 
> 时间：2013-01-16T10:41:15.660
> 
> 标签：android, gridview

**网格**

```
 <GridView
        android:id="@+id/gridViewProdact_2"
        style="@style/scroll_bar_green"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:background="@android:color/white"
        android:cacheColorHint="#00000000"
        android:fadingEdge="none"
        android:horizontalSpacing="10dp"
        android:layoutAnimation="@anim/controller"
        android:listSelector="@null"
        android:numColumns="auto_fit"
        android:stretchMode="columnWidth"
        android:verticalSpacing="10dp" >

    </GridView> 
```

**项目网格**

```
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/imageLayout"
    android:layout_width="@dimen/item_grid"
    android:layout_height="@dimen/item_grid"
    android:background="@android:color/black" >

    <ImageView
        android:id="@+id/imageGrid"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center"
        android:src="@drawable/image_company" />

</FrameLayout> 
```

并展示了这个

![在此处输入图像描述](../Images/b37410eb2837ee57c66fdfe51f99a05f.png)

谁错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T10:55:49.637

像这样使用..

```
<?xml version="1.0" encoding="utf-8"?>
<GridView xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/grid_view"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:numColumns="auto_fit"
    android:columnWidth="90dp"
    android:horizontalSpacing="10dp"
    android:verticalSpacing="10dp"
    android:gravity="center"
    android:stretchMode="columnWidth" > 

</GridView> 
```

与以下

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <ImageView android:id="@+id/full_image_view"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"/>

</LinearLayout> 
```

# c# - 文件上传到 WP7 应用程序

> ID：14356465
> 
> 赞同：1
> 
> 时间：2013-01-16T10:41:34.800
> 
> 标签：c#, windows-phone-7, file-upload, isolatedstorage

我只有一个“简短”的问题。在过去的几个小时里我做了很多研究，发现一个 Wp7 应用程序可以访问他自己的目录和`IsolatedStorage`. 因此，如果我想在我的应用程序中使用文件，我要么必须使用 VS 中的 Solutionexplorer 将其加载到项目中，要么通过代码手动创建一个文件，将其加载到独立存储中，然后读出它。

所以我得出的结果是，无法将位于未知目录或文件夹中且名称未知的特定文件从我的手机（或 WP7 模拟器）直接加载到应用程序中，对吗？因为在 ASP.NET Webform 中没有浏览功能或类似的东西，所以`FileUploadControl`.

我的理解是正确的还是我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T11:06:28.967

除了应用程序及其隔离存储区域中包含的内容之外，您无法访问手机上的任何内容（音乐和照片库等除外）。

您无法像在 Windows 上那样浏览本地设备。但是您可以从网上下载文件。

# php - 网站推送通知

> ID：14356466
> 
> 赞同：0
> 
> 时间：2013-01-16T10:41:36.347
> 
> 标签：php, jquery

我目前正在建立一个拍卖网站，有一些问题我仍然没有解决方案......如何在网站上推送通知（就像 facebook 一样）。当中标者被其他投标者超越时，我需要在屏幕上显示。

我尝试使用间隔 ajax（拉取请求）它占用了大量服务器资源。

请帮忙。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T10:44:57.597

基本上，您需要“长轮询”或“即时响应功能”。你应该看看长轮询（推送技术），理解它，然后选择适合工作的正确语言、技术和架构。

`In a web/AJAX context, long polling is also known as Comet programming.`

* * *

如果您想构建“类似于 facebook 的东西”，您将需要对以下内容和一些 Javascript 技能进行大量研究。它是您将使用的唯一语言。

*   Node.js：可以使用套接字向浏览器提供实时更新的后端服务器。
*   Backbone.js：一种构建单页应用程序的半结构化方式，“像 facebook”

我还将 Require.js 包含到该列表中，该列表基本上用于异步加载所有 Backbone Javascript 文件。它有助于保持应用程序的文件结构可维护。

* * *

最后，很高兴看到您已经意识到定期提取数据的缺点。因为这会对服务器造成影响。研究长轮询，你会学到很多有用和有趣的东西 :) 记住 - 为工作选择正确的工具。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T10:48:43.370

如果您只需要支持现代浏览器，也许 HTML5 WebSockets 可能是一个解决方案：

[http://www.html5rocks.com/en/tutorials/websockets/basics/](http://www.html5rocks.com/en/tutorials/websockets/basics/)

它们允许您“收听”浏览器中的数据。但是，如果您必须支持较旧的浏览器，则必须采用其他建议的解决方案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T10:43:04.943

间隔 AJAX 是最糟糕的解决方案。使用一些实时 API，例如[PUSHER](http://pusher.com/)。

**[例子](http://www.webspeaks.in/2012/04/twitter-like-real-time-wall-update.html)**

# extjs - 无法在 Ext.Ajax.request 中设置正确的内容类型

> ID：14356468
> 
> 赞同：1
> 
> 时间：2013-01-16T10:41:42.757
> 
> 标签：extjs

代码如下：

```
Ext.Ajax.request({
url: url,
method: 'POST',
headers: { 'Content-Type': 'application/json' },
jsonData: {
        textMatchStyle:"substring",
        fields: ["packageName","name","tableName"], 
        data: {_domain:null,_domainContext:{},operator:"and",criteria:[]},
        limit: 40,
        offset: 0
        }, 
success: function(response) {
    console.log('Success');     
},// function called on success
failure: function(result) {Ext.MessageBox.alert('Error', 'Some problem occurred');},
}); 
```

这应该根据 Extjs 文档工作，但在 request-header

```
Content-Type    application/x-www-form-urlencoded,text/javascript; charset=UTF-8 
```

这会导致问题，因为我的服务器需要`application/json`格式而不是格式的发布数据`application/x-www-form-urlencoded`

我也在 ext-forums 上搜索过这个，但无法正常工作。

我的代码中是否有问题或其在 extjs 中的错误？

请帮忙。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T17:57:10.780

您的代码一切正常，因为它工作正常。我在 IE9 和 Chrome 中都对其进行了测试，如图所示：

![在此处输入图像描述](../Images/8c591d165bb00c483b349f195b59c7f4.png)

你可以在这里看到这个工作：http: [//tinyurl.com/afeluoy](http://tinyurl.com/afeluoy)

我无法想象为什么您的标头没有设置好但在 jsfiddle 中使用它以确认它正常工作的原因。

# android - android：是否可以检查是否在其他应用程序中创建了数据库

> ID：14356470
> 
> 赞同：0
> 
> 时间：2013-01-16T10:41:46.623
> 
> 标签：android, sqlite, android-contentprovider

是否可以检查是否在其他应用程序中创建了数据库？我必须有两个应用程序的通用数据库。如果一个应用程序已经创建了数据库，那么第二个应用程序应该使用第一个应用程序的数据库（我的意思是不应该创建新的）。为此，有没有办法检查是否创建了特定的公共数据库？请帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T10:52:05.450

这并不像您想象的那么容易。即使您明确知道，您的其他应用程序已经创建了数据库，查询它仍然很困难。由于任何 Db 都属于创建它的应用程序，因此通常只有该应用程序可以访问它。好消息是有一种机制，称为[ContentProvider](http://developer.android.com/guide/topics/providers/content-providers.html)。有了它，您可以在应用程序之间共享 db-infos，但要实现这一点需要付出一些努力。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T11:13:56.247

试试下面的代码

```
DB_PATH = "/data/data/THE_PACKAGE_NAME/databases/";
DB_NAME="YOUR_DB_NAME";
File dbFile = new File(DB_PATH + DB_NAME);
if(dbFile.exists()){
/* YOUR CODE HERE*/
} 
```

在创建数据库之前，请使用 PACKAGE NAME 对您的两个应用程序进行上述检查。

:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T11:06:54.617

您应该使用 SQLiteOpenHelper 来控制数据库的版本控制，如[数据库教程](http://developer.android.com/training/basics/data-storage/databases.html)中所述。

不幸的是，SQLiteOpenHelper 仅适用于本地应用程序目录，但您可以告诉它使用 sd 卡上的不同目录，如[sqliteopenhelper-with-fully-qualified-db-path-name 中所述](https://stackoverflow.com/questions/5332328/sqliteopenhelper-problem-with-fully-qualified-db-path-name/9168969#9168969)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-16T10:49:06.097

数据库存储在`/data/data/your.applications.package/databases`. 通常，该位置只能由为应用程序创建的 Android 操作系统的用户访问。除非设备已获得 root 权限，否则其他用户无法访问此位置。然后任何用户都可以访问手机上的任何位置并操作数据。

所以你可以检查数据库是否存在于这个位置

你可以直接检查这个[`Android Access Another App's Database`](https://stackoverflow.com/questions/10045907/android-access-another-apps-database)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-16T10:54:31.077

对你来说最好的事情是使用 sdcard（或其他一些用户可访问的区域，没有 root）看看这个[线程](https://stackoverflow.com/questions/7227806/android-sqlite-database-on-sd-card)

我知道它不安全，但它是解决这类问题的最佳选择。一个应用程序（安装的第一个）在 sdcard 上创建数据库。另一个，只需检查文件（db）是否已经存在并从现有数据库中读取。

# encryption - 将 AES 代码从 M2Crypto 移植到 pycrypto

> ID：14356471
> 
> 赞同：1
> 
> 时间：2013-01-16T10:41:49.043
> 
> 标签：encryption, aes, pycrypto, m2crypto

我想将一些现有的 AES 代码从 M2Crypto 转换为等效的 pycrypto，但文档很薄，尤其是对于 M2Crypto。我已将相关代码简化为[gist](https://gist.github.com/4546068)。主要问题是：

*   Pycrypto 要求输入长度为 16 的倍数，而 m2crypto 则不需要。
*   即使输入长度是 16 的倍数，密文也不同。在尝试了 M2Crypto 密码参数之后，结果证明设置`padding`和`key_as_bytes`错误使用 pycrypto 加密为相同的密文。所以我需要在纯python中`padding=True`进行模拟。`key_as_bytes=True`

任何帮助将非常感激。

编辑：已解决 - 要点已使用等效的 M2Crypto/pycrypto 代码和测试进行了更新，我将把它留在那里以防有人发现它在未来有用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T01:00:45.607

您将必须实现 PKCS#7 填充/取消填充，这很简单，并且在 RSA 实验室的公开可用标准中指定，当然在 Wikipedia 上也有。另请参阅此答案：

[使用 CBC 模式使用 PyCrypto 进行 AES 256 加密 - 有任何弱点吗？](https://stackoverflow.com/questions/7954661/aes-256-encryption-with-pycrypto-using-cbc-mode-any-weaknesses)

请注意，PKCS#7 填充和 PKCS#5 填充是相同的，尽管后者正式仅用于 8 字节块密码（例如 DES/TDEA）。OpenSSL 默认使用 PKCS#7 填充。

# zend-framework - Yii Lucene 编码

> ID：14356480
> 
> 赞同：0
> 
> 时间：2013-01-16T10:42:09.197
> 
> 标签：zend-framework, yii, lucene

在这里或其他任何地方都找不到解决方案，所以我要问另一个关于 Zend Lucene 的问题。每个人都讲述了一些 Lucene 的编码。我应该在哪里切换这种编码？

当我使用搜索（PL 语言）时，我得到了

> oprĂłcz wystÄ...pi reprezentacja Rosji。Mistrzowie olimpijscy z Londynu powalczÄ...</p>

这个 Ăł 在波兰语中应该是“ó”，Ä...（变音符号？）是“ą”等等......当然它适用于英语。

再次 searchController.php（操作创建 + 搜索）：

```
public function actionCreate()
{
    $_indexFiles = 'runtime.search';  
    $index = Zend_Search_Lucene::create($_indexFiles);
    $index = new Zend_Search_Lucene(Yii::getPathOfAlias('application.' . $this->_indexFiles), true);

    $posts = News::model()->with('comment')->findAll();
    foreach($posts as $news){

        $doc = new Zend_Search_Lucene_Document();

        $doc->addField(Zend_Search_Lucene_Field::Text('title',CHtml::encode($news->name), 'utf-8'));

        $doc->addField(Zend_Search_Lucene_Field::Text('link',CHtml::encode($news->url), 'utf-8'));   

        $doc->addField(Zend_Search_Lucene_Field::Text('content',CHtml::encode($news->description), ' utf-8 '));

        $index->addDocument($doc);
    }
    setlocale(LC_CTYPE, 'pl_PL.utf-8');
    $index->commit();
    echo 'Lucene index created';
}

public function actionSearch()
{

    Zend_Search_Lucene_Search_QueryParser::setDefaultEncoding('utf-8');
    Zend_Search_Lucene_Analysis_Analyzer::setDefault(new Zend_Search_Lucene_Analysis_Analyzer_Common_Utf8_CaseInsensitive ());

    $this->layout='column2';

     if (($term = Yii::app()->getRequest()->getParam('q', null)) !== null) {
        $index = new Zend_Search_Lucene(Yii::getPathOfAlias('application.' . $this->_indexFiles));
        $results = $index->find($term);
        $query = Zend_Search_Lucene_Search_QueryParser::parse($term);       

        $this->render('search', compact('results', 'term', 'query'));
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T17:09:41.230

欢迎使用 Zend_Lucene，当你厌倦了它时，你可以开始使用像[Solr](http://lucene.apache.org/solr/)或[Sphinx这样的本地搜索引擎](http://www.yiiframework.com/extension/dgsphinxsearch)

*“从别人的错误中吸取教训。你不能活得足够长，自己做这些。”*

# android - 如何获得 Facebook 好友即将到来的生日的通知/提醒

> ID：14356482
> 
> 赞同：1
> 
> 时间：2013-01-16T10:42:20.180
> 
> 标签：android, facebook, facebook-graph-api, android-facebook

我正在编写一个应用程序，其中我正在*获取我所有 Facebook 朋友的列表*..

但现在我想在我的应用程序中添加一项功能，**以获取即将到来的朋友生日的通知/提醒**

我正在使用下面的代码来获取所有朋友的列表：

```
 public class FriendListAdapter extends BaseAdapter implements
        SectionIndexer {
    private LayoutInflater mInflater;

    private GetProfilePictures picturesGatherer = null;
    FriendsList friendsList;
    private String[] sections;

    Hashtable<Integer, FriendItem> listofshit = null;

    public FriendListAdapter(FriendsList friendsList) {

        this.friendsList = friendsList;
        sections = new String[getCount()];
        listofshit = new Hashtable<Integer, FriendItem>();

        for (int i = 0; i < getCount(); i++) {
            try {

                sections[i] = jsonArray.getJSONObject(i).getString("name")
                        .substring(0);
                sections[i] = jsonArray.getJSONObject(i)
                        .getString("birthday").substring(1);

            } catch (JSONException e) {
                sections[i] = "";

            }
        }
        if (picturesGatherer == null) {
            picturesGatherer = new GetProfilePictures();
        }
        picturesGatherer.setAdapterForListener(this);
        mInflater = LayoutInflater.from(friendsList.getBaseContext());
    }

    public int getCount() {

        if (jsonArray == null)
            return 0;
        return jsonArray.length();
    }

    public Object getItem(int position) {

        return listofshit.get(position);
    }

    public long getItemId(int position) {

        return position;
    }

    public View getView(int position, View convertView, ViewGroup parent) {

        JSONObject jsonObject = null;
        try {
            jsonObject = jsonArray.getJSONObject(position);
        } catch (JSONException e) {

        }

        FriendItem friendItem;

        if (convertView == null) {
            convertView = mInflater.inflate(R.layout.single_friend, null);
            friendItem = new FriendItem();

            convertView.setTag(friendItem);
        } else {
            friendItem = (FriendItem) convertView.getTag();
        }

        friendItem.friendPicture = (ImageView) convertView
                .findViewById(R.id.picture_square);
        friendItem.friendName = (TextView) convertView
                .findViewById(R.id.name);
        friendItem.friendDob = (TextView) convertView
                .findViewById(R.id.dob);
        friendItem.friendLayout = (RelativeLayout) convertView
                .findViewById(R.id.friend_item);

        try {
            String uid = jsonObject.getString("uid");
            String url = jsonObject.getString("pic_square");
            friendItem.friendPicture.setImageBitmap(picturesGatherer
                    .getPicture(uid, url));
        } catch (JSONException e) {

            friendItem.friendName.setText("");
            friendItem.friendDob.setText("");
        }

        try {
            friendItem.friendName.setText(jsonObject.getString("name"));
            friendItem.friendDob.setText(jsonObject.getString("birthday"));
        } catch (JSONException e) {

            friendItem.friendName.setText("");
            friendItem.friendDob.setText("");
        }

        listofshit.put(position, friendItem);
        return convertView;
    }

    public int getPositionForSection(int position) {
        return position;
    }

    public int getSectionForPosition(int position) {
        return position;
    }

    public Object[] getSections() {
        return sections;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T11:05:44.720

您可以使用 CRON 和 facebook 的[Notification API](https://developers.facebook.com/docs/howtos/notifications-api/)。

1.  首先，您需要将用户的 id**和****扩展**访问**令牌**存储在数据库中。
***   然后，运行您的调度程序并使用用户的令牌获取每个用户的朋友的生日*   使用通知 API 向用户发送通知（只需要**APP 访问令牌**- 您可以从[此处](https://developers.facebook.com/tools/access_token/)获取）**

# android - 如何将特定字体应用于 EditText？

> ID：14356483
> 
> 赞同：0
> 
> 时间：2013-01-16T10:42:25.690
> 
> 标签：android, android-layout, android-edittext

我是 android 开发新手，我需要在我的应用程序中实现富文本编辑器。所以我用谷歌搜索并找到了一些解决方案。我正在使用这个解决方案：

[http://code.google.com/p/android-richtexteditor/source/browse/?r=4#svn/trunk/src/net/sgoliver](http://code.google.com/p/android-richtexteditor/source/browse/?r=4#svn/trunk/src/net/sgoliver)

它支持粗体、斜体和下划线。现在我想更改 EditText 中选定文本的字体样式，我该怎么做？

我知道如何为 EditText 中的所有文本设置[字体样式](https://stackoverflow.com/questions/10766943/change-font-for-edittext-in-android)。建议将被采纳！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T10:59:23.610

将字体文件 (*.ttf) 复制到应用程序的 assets 文件夹中。

考虑我已将字体文件“verdana.TTF”复制到资产文件夹，然后以下代码将字体设置为 verdana

```
EditText et=(EditText) findViewById(R.id.editText1);
Typeface tf =   Typeface.createFromAsset(getAssets(),"verdana.TTF");
et.setTypeface(tf); 
```

希望你得到解决方案

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T10:46:03.947

```
Typeface tf =   Typeface.createFromAsset(getAssets(),"fonts/Comic.ttf");
EditText et =   (EditText)findViewById(R.id.et);
et.setTypeface(tf); 
```

您可以将 ttf 文件放在资产中并在此处设置字体样式

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T10:50:43.987

试试这个代码..创建像这个资产/字体这样的字体文件夹并将你的字体文件放入其中..

```
 edittxt = (EditText) findViewById(R.id.edittxt);

 Typeface myTypeface = Typeface.createFromAsset( this.getAssets(), "font/YOURFONT.otf");

 edittxt.setTypeface(myTypeface); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-16T10:44:28.463

```
editText.setTypeface(Typeface.SERIF); as like as TextView. 
```

# intellij-idea - 在 IntelliJ 中，如何使用来自不同 SVN 位置的模块更新项目（ctrl+T）

> ID：14356487
> 
> 赞同：4
> 
> 时间：2013-01-16T10:42:32.177
> 
> 标签：intellij-idea

我有一个由许多模块（15+）组成的 IntelliJ 项目，其中每个模块都来自它们自己的（不同的）SVN 位置。该项目不存储在SVN中，只是每个模块。

Foo 项目（不在 SVN 中）

*   模块 1 [http://svn.example.com/projects/module1/trunk](http://svn.example.com/projects/module1/trunk)
*   模块 2 [http://svn.example.com/projects/module2/branches/bar](http://svn.example.com/projects/module2/branches/bar)
*   模块 3 [http://svn.example.com/projects/module3/tag/2012-11-01](http://svn.example.com/projects/module3/tag/2012-11-01)

我希望能够进行更新项目（`Ctrl`+ `T`）。通常（当整个项目存储在同一个 VCS 位置时）我可以这样做一次。但是由于每个模块都存储在不同的 VCS 位置，我必须手动更新每个模块。

有没有一种方法可以用一个命令更新所有模块？

我正在使用 IntelliJ 11。（但如果需要，没有什么能阻止我升级到 12。）

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2013-01-17T01:33:32.987

In Project settings -> Version Control, you can add all your vcs Directory with vcs type.

# php - PDO值得学习吗？

> ID：14356492
> 
> 赞同：-4
> 
> 时间：2013-01-16T10:42:39.373
> 
> 标签：php, mysql

新开发人员使用 PHP/MySQL/Bash 编写自动化流程的脚本，是否值得学习 PDO。

它执行得更快吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-16T10:44:08.897

1.  回答第一个问题：是的，值得推荐。
2.  回答第二个问题：执行速度比？它不仅与速度有关，还与效率和安全性以及更好的管理有关。

根据[PHP 手册](http://us.php.net/manual/en/mysqlinfo.api.choosing.php)

> 建议使用 mysqli 或 PDO_MySQL 扩展。不建议在新开发中使用旧的 mysql 扩展，因为它在 PHP 5.5.0 中已被弃用，并且将来会被删除。下面提供了详细的特征比较矩阵。所有三个扩展的整体性能被认为是大致相同的。尽管扩展的性能只占 PHP Web 请求总运行时间的一小部分。通常，影响低至 0.1%。

[此处](http://us.php.net/manual/en/mysqlinfo.api.choosing.php)列出的好处

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-16T10:45:58.933

这取决于。

如果你要在应用程序代码中使用裸 API 调用，就像 Stackoverflow 中的几乎每个人一样，PDO 是你的选择，因为它有一些工具可以让这个过程不那么繁琐。

但是如果你想制作一些运行查询的工具，让你的生活**更轻松**，我会推荐 mysqli，因为它是诚实的 API，没有很多不必要的花里胡哨。

# barcode - 我如何解码 UPS maxicode 条形码

> ID：14356494
> 
> 赞同：2
> 
> 时间：2013-01-16T10:42:42.270
> 
> 标签：barcode, ups

我需要解码的图像上有一个 maxicode UPS 条形码。

1.  任何已知的 .Net 实用程序？
2.  数据 AFAIK 是内部编码的，这意味着我需要一些 UPS 的东西。

有人有吗？我怎么才能得到它？

# ios - 单个视图控制器中的多个方向，使用基于 UISplitview 的应用程序

> ID：14356496
> 
> 赞同：0
> 
> 时间：2013-01-16T10:42:43.587
> 
> 标签：ios, ipad, uisplitviewcontroller, device-orientation

我有一个仅适用于横向模式`rootViewController`的应用程序，并且应用程序窗口的`UISplitViewController`. 现在，我希望将一个新`viewController`的视图控制器呈现为支持两种方向（横向和纵向）的模态视图控制器。我已将 plist 中支持的方向设置为仅横向。但是我已经在新的视图控制器中设置了所有方向。但是，未更改为纵向的方向可能是由于 plist 中指定的方向。

我基本上想要的是让应用程序中的所有视图都处于横向模式，并且在两个方向上都只有一个视图。任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T10:52:43.300

shouldAutorotateToInterfaceOrientation 将告诉应用程序是否定向，所以我们可以在这里做的是有一个标志来告诉它是否自动旋转。最初标志为假。但是当您呈现模型视图控制器时，请将其设置为 true。当它消失时，再次将其设置为 false。这可能会奏效 [，你也可以参考这个](https://stackoverflow.com/questions/7353789/ios-disable-autorotation-for-a-subview)

# mysql - mysql/workbench：为什么在更新 CURRENT_TIMESTAMP 中添加了非空时间戳

> ID：14356499
> 
> 赞同：1
> 
> 时间：2013-01-16T10:42:58.167
> 
> 标签：mysql, attributes, timestamp, workbench

*简短的：*

我遇到了奇怪的 MySQL 行为 -虽然我不想添加它，但正在添加**更新 CURRENT_TIMESTAMP属性。**我想知道为什么会发生这种情况 - 这是我使用的 MySQL 服务器还是 MySQL Workbench (v5.2.38) 的问题。

*细节：*

我已经使用 EER 图对数据库结构进行了建模，示例表如下：

```
CREATE  TABLE IF NOT EXISTS `privilege` (
  `id` INT NOT NULL ,
  `name` VARCHAR(64) NOT NULL COMMENT 'privilege name (just a label)' ,
  `created_at` TIMESTAMP NOT NULL COMMENT 'when the privilege was created' ,
  PRIMARY KEY (`id`) )
ENGINE = InnoDB; 
```

上面的脚本片段是使用WorkBench中的*Export > Forward Engineer SQL Create Script 创建的。***created_at**列在这里很重要。它不是 NULL，并且在定义记录时没有为时间戳定义默认值。所以我猜，如果有人试图在没有定义 created_at 的情况下插入记录，则会引发错误。

我在 MySQL 服务器中运行这个脚本来创建整个结构。并且创建的结构不同 - *show create table privilege*返回以下内容：

```
CREATE TABLE `privilege` (
  `id` int(11) NOT NULL,
  `name` varchar(64) NOT NULL COMMENT 'privilege name (just a label)',
  `created_at` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE
  CURRENT_TIMESTAMP COMMENT 'when the privilege was created',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 
```

“on update current_timestamp”从何而来？我 100% 确定我没有选择任何合适的选项，所以 MySQL 不应该创建任何他没有被要求的东西。

有谁知道为什么要添加这些条款？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T10:55:46.953

如[自动初始化和更新中所述`TIMESTAMP`](http://dev.mysql.com/doc/en/timestamp-initialization.html)：

> 以下规则描述了[`TIMESTAMP`](http://dev.mysql.com/doc/en/datetime.html)使用当前时间戳为默认值和自动更新值定义表中的第一列的可能性，一个但不是另一个，或者两者都不是：
> 
> `[ *deletia* ]`
> 
> *   没有`DEFAULT CURRENT_TIMESTAMP`也没有`ON UPDATE CURRENT_TIMESTAMP`，它与同时指定`DEFAULT CURRENT_TIMESTAMP`和相同`ON UPDATE CURRENT_TIMESTAMP`。
> 
> `[ *deletia* ]`
> 
> 要抑制第一[`TIMESTAMP`](http://dev.mysql.com/doc/en/datetime.html)列的自动属性，请执行以下任一操作：
> 
> *   `DEFAULT`使用指定常量默认值的子句定义列。
>     
>     
> *   指定`NULL`属性。这也会导致列允许`NULL`值，这意味着您不能通过将列设置为来分配当前时间戳`NULL`。分配`NULL`将列设置为`NULL`。

# c# - JObject 内存不足

> ID：14356500
> 
> 赞同：2
> 
> 时间：2013-01-16T10:43:00.587
> 
> 标签：c#, json, parsing, json.net

当我尝试解析一个大`json`文件时遇到问题，该文件大约有`200mb`. 我正在用`Newtonsoft.Json`. 它给出了`OutOfMemory`例外。

这是我的代码：

```
using (StreamReader sr=File.OpenText("path"))
        {
            JObject file= (JObject)JToken.ReadFrom(new JsonTextReader(sr));
        } 
```

我怎样才能做到这一点 ？（最好使用 JObject ）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T10:56:44.813

您可以使用此问题`JsonTextReader`中所述的方式阅读文本：`DataReader`

[C# 中的增量 JSON 解析](https://stackoverflow.com/questions/9026508/incremental-json-parsing-in-c-sharp)

您必须编写自己的逻辑来处理 JSON 数据，但它肯定会解决您的内存问题：

```
using (var reader = new JsonTextReader(File.OpenText("path")))
{
    while (reader.Read())
    {
        // Your logic here (anything you need is in [reader] object), for instance:
        if (reader.TokenType == JsonToken.StartArray)
        {
            // Process array
            MyMethodToProcessArray(reader);
        }
        else if (reader.TokenType == JsonToken.StartObject)
        {
            // Process object
            MyMethodToProcessObject(reader);
        }
    }
} 
```

您实际上会构建一个递归 JSON 解析器。

# linux - z3以前的版本库

> ID：14356501
> 
> 赞同：-2
> 
> 时间：2013-01-16T10:43:04.670
> 
> 标签：linux, z3

我正在使用在 max os 上运行的 z3-osx-4.1-x64，目前我需要它在 linux 系统下运行。我尝试下载 linux 版本[http://research.microsoft.com/en-us/um/redmond/projects/z3/](http://research.microsoft.com/en-us/um/redmond/projects/z3/)，但似乎没有 linux 版本。你能告诉我在哪里可以下载吗？非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T10:50:11.123

您应该从[他们当前的站点](http://z3.codeplex.com/)获取源代码并按照他们的[README](http://z3.codeplex.com/SourceControl/changeset/view/89c1785b7322#README)文件中的说明进行操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T12:39:27.370

您可以简单地附加`z3-4.1.tar.gz`到[http://research.microsoft.com/en-us/um/redmond/projects/z3/](http://research.microsoft.com/en-us/um/redmond/projects/z3/)以下载适用于 Linux 的 Z3 4.1 二进制文件。

更完整的旧版本列表可以在[linux 的 Z3 的先前版本中](https://stackoverflow.com/questions/11122735/previous-version-of-z3-for-linux)找到。

对于最新版本，建议[下载 master 分支，在您的 Linux 系统上编译并安装](http://z3.codeplex.com/)。

# javascript - 发送电子邮件导航未来位置 Waze API

> ID：14356503
> 
> 赞同：0
> 
> 时间：2013-01-16T10:43:07.793
> 
> 标签：javascript, html, email, mobile, waze

我想问我是否有可能通过电子邮件发送一个链接，该链接将通过智能手机按下，位智将使用特定地址打开。我看到了[http://www.waze.co.il/dev/documentation/](http://www.waze.co.il/dev/documentation/)浏览器页面，并试图用这个访问智能手机的地址，但他没有回应（打开谷歌搜索 - Android）。有没有这样的方法？（基本上模拟共享应用程序让位）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T05:15:42.620

您可以使用此 URL（来自 Weze API）打开浏览器：

与`JavaScript`：

```
document.querySelector('span').onclick = function() {
  location.href = 'waze://?q=<address search term>';
}
```

```
<span>Navigate</span>
```

与`html`：

```
<a href="waze://?q=<address search term>">Navigate</a>
```

> 我将通过电子邮件发送一个链接，该链接将通过智能手机按下

您只需发送一封包含链接的电子邮件即可`waze://?q=<address search term>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-09T23:50:52.773

目前你不能。

该 API 仅供应用内使用（Android 和 iOS）。

# asp.net-mvc - UrlHelper.Action() 跳过空属性

> ID：14356507
> 
> 赞同：1
> 
> 时间：2013-01-16T10:43:21.053
> 
> 标签：asp.net-mvc, urlhelper

下面的模型有两种使用方式：

```
public class SimpleModel
{
    public DateTime? Date { get; set; }

    // Some other properties

    public SimpleModel()
    {
         Date = DateTime.Now;
    }
} 
```

当在表单中使用模型时，生成的 URL 有空参数 Date ( `/Controller/Action?Date=&SomeOtherParams=123`) 并且`Date`模型中的属性是`null`（在提交带有空日期的表单后）。

```
...

@Html.TextBoxFor(model => model.Date)

... 
```

该模型也用作第三个参数`UrlHelper.Action()`：

```
@Url.Action("Action", "Controller", Model) // Model is SimpleModel 
```

在这种情况下，如果`Date`为 null，则生成的 URL 不包含参数 Date( `/Controller/Action?SomeOtherParams=123`)。如果我关注此 URL，则属性`Date`为`DateTime.Now`，而不是预期的 null 。

如何强制将空属性传递给 URL？

**UPD。动作代码**

```
public ActionResult MyAction( SimpleModel model = null )
{
     if ( model.Date == null )
     {
        // show all
     }
     else
     {
        // show by date
     }
} 
```

实际上，而不是`TextBoxFor`used `DropDownListFor`。

```
@Html.DropDownListFor( model => model.Date, Model.Dates) 
```

如果他想查看所有实体，用户可以从下拉菜单中选择日期或将其留空。

如果用户提交带有空日期的表单，他会跟随 URL`/Controller/Action?Date=`并获取所有实体（日期属性在构造函数中使用默认值初始化，然后用 null 覆盖）。

如果用户通过`@Url.Action`从其他页面生成的 url（不提交表单）跟随，他只会得到今天的实体，因为 URL 不包含 Date 参数（`/Controller/Action`）。在这种情况下 Date 属性在构造函数中初始化，这就是全部。

问题是`model`从不`MyAction`等于 null，我无法识别用户何时选择空日期以及何时访问没有参数的页面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T10:46:20.383

如果您希望`Date`为空，则删除在空构造函数中分配 DateTime.Now 的行。

```
public SimpleModel()
{
   //This line is assigning the value to Date whenever a new SimpleModel() is created. Comment it out.
   //  Date = DateTime.Now;  

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T14:53:11.617

> 如果我关注这个 URL，属性 Date 是 DateTime.Now，而不是预期的 null。

问题是 MVC 引擎正在尝试`Model`根据您定义的构造函数构造一个对象，该构造函数将`Date`属性设置为`DateTime.Now`. 建议您不要定义带有空参数的构造函数，因为 MVC 引擎将使用它在`POST`. 就目前而言，这是预期的行为。

如果您需要该功能，则定义另一个构造函数：

```
public SimpleModel() // Left for MVC
{
}

public SimpleModel(DateTime date) // Use as: new SimpleModel(DateTime.Now) in your action 
{
     Date = date;
} 
```

# php - 查找路线起点和终点周围的标记 (LatLng)

> ID：14356508
> 
> 赞同：0
> 
> 时间：2013-01-16T10:43:21.777
> 
> 标签：php, mysql, sql, geolocation, haversine

所以，我有一个保存“路线”的数据库（即起点和终点，纬度/经度格式'StartLat'，'StartLng'和'EndLat'，my'EndLng'）。目前，人们可以通过他们的起点或终点搜索这些路线（例如“查找起点在我的 LatLng 位置 5 英里范围内的路线。”）。他们可以通过它们的起点或终点来查找它们（例如“在此标记范围内查找起点”或“在此标记范围内查找终点”）。

我目前有一个基于 Haversine 公式的 SQL 查找，这对我来说非常有效。

我想要做的是在一个 SQL 字符串中将两个查询连接在一起，以便能够“找到起点在“Place A”的“x”英里范围内且终点在“x”范围内的所有路线英里的“地方B”。

我有一种感觉，最优雅的方法是在我现有的 SQL 字符串上创建一个连接，但我一生都无法弄清楚如何做！

我当前的 SQL 字符串如下所示：

```
SELECT ID, RouteCode, (3959 * acos(cos(radians('51.5073346')) * cos(radians( EndLat )) * cos(radians( EndLng ) - radians('-0.1276831')) + sin(radians('51.5073346')) * sin(radians( EndLat )))) AS distance FROM markers HAVING distance < 15 
```

（因此，在上面的示例中，用户将搜索终点在坐标 51.5073346、-0.1276831 的 15 英里范围内的所有路线。如果他们想要找到起点在他们的 15 英里范围内的路线LatLng，然后 EndLat 和 EndLng 将被 StartLat 和 StartLng 替换）。

有没有人对 SQL 命令有足够的了解，能够帮助我计算出我需要的 SQL 字符串？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T10:51:15.340

你不需要`join`; 您只需要在查询中添加第二个条件：

```
SELECT ID, 
       RouteCode, 
       (
           3959 * acos(cos(radians('51.5073346')) * cos(radians( EndLat )) * 
           cos(radians( EndLng ) - radians('-0.1276831')) + 
           sin(radians('51.5073346')) *      
           sin(radians( EndLat )))
       ) AS end_distance,
       (
           [similar calculation for start here]
       ) AS start_distance
    FROM markers 
    HAVING start_distance < 15 and end_distance < 15 
```

从概念上讲，a`join`用于添加来自另一个表的数据。您只是想在同一个表中强加另一个要求。

# php - 没有最后一个标点符号的正则表达式链接式匹配

> ID：14356511
> 
> 赞同：1
> 
> 时间：2013-01-16T10:43:46.247
> 
> 标签：php, regex

我有 html/文本字符串，并希望将文本的所有类似链接的部分与带有 A 标签的真实超链接相匹配。对于这个问题，我正在尝试匹配“www.somesite.domen”模式。但是，如果模式接近句尾的标点符号怎么办。

**如何匹配没有标点符号的最后一个字符的模式？**

1.  www.somesite.domen。
2.  www.somesite.domen,
3.  www.somesite.domen?
4.  www.somesite.domen！
5.  www.somesite.domen/?id=1?

这是我正在使用的功能：

```
function make_links($text)
{
  return  preg_replace(
     array(
        '/(^|\s)(www\.[^<>\s!,]+)(!$|\s|\.|\:|\!|,|\?)/iex'
       ),
     array(
        "stripslashes((strlen('\\2')>0?'\\1<a target=\"_blank\" href=\"http://\\2\">\\2</a>\\3':'\\0'))"
       ),
       $text
   );
} 
```

但是当'.' 或者 '？' 字符是句子中的最后一个，我的功能也将它们带入链接。

知道如何解决这种情况吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T11:39:22.687

如果我正确理解您的要求，您需要将您的文本行分成 3 组

*   第一组将在*主机名之前保留文本*
*   第二组将保留*主机名*
*   第三组将最后一个标点字符（或空白字符）。

解决方案之一可能如下：

```
/^(.*?)(www(?:.\w+)+(?:\/[^.\s]+?))(!$|\s|\.|\:|\!|,|\?)?$/ 
```

![正则表达式解释](../Images/bfd6e47df4f22b4a4d7b0508c726a88c.png)

使用`some text www.host.some-site.domen/?id=1?`作为示例，您将获得如下匹配：

![匹配结果](../Images/6992a8254037652576929d6131da2fc0.png)

为了摆弄你的正则表达式，你可以使用[regex101.com](http://regex101.com/)

**编辑**

或者，这是另一个正则表达式。

```
/^(.+\s)?(\w+(?:\.[-\w]+)+\.\w+(?:\/.*?)?)(!$|\s|\.|\:|\!|,|\?)?$/ 
```

我进行了几次测试：

*   测试文本：`some stuff www.host.somesite.domen/?id=1.`。匹配组：

    *   1 `some stuff`：，
    *   2 `www.host.somesite.domen/?id=1`：，
    *   3：`.`
*   测试文本：`some stuff www.host.somesite.domain.`。匹配组：

    *   1：`some stuff`
    *   2：`www.host.somesite.domen`
    *   3：`.`
*   测试文本：`www.host.somesite.domain`。匹配组（只有一个）：

    *   2：`www.host.somesite.domain`
*   测试文本：`hello www.host.somesite.domen/mysite.`。匹配组：

    *   1 `hello`：，
    *   2 `www.host.somesite.domen/mysite`：，
    *   3：`.`
*   测试文本：`www.somesite.domen/?id=1?`。匹配组：

    *   2：`www.somesite.domen/?id=1`
    *   3：`?`

我希望这将有助于解决您的问题。

# ruby - 在没有私钥的情况下删除 Knife 客户端？

> ID：14356515
> 
> 赞同：4
> 
> 时间：2013-01-16T10:43:47.853
> 
> 标签：ruby, chef-infra, vagrant, knife

我加入了一家新公司，为了跟上进度，我一直在为我的 VM 使用 Vagrant。我的系统几乎设置好了，然后一个奇怪的错误迫使我关闭了我的笔记本电脑而没有通过`vagrant destroy`. 现在，当尝试设置时，我运行`vagrant up`并收到以下错误消息。

```
 [default] Running provisioner: Vagrant::Provisioners::ChefClient...
    [default] Creating folder to hold client key...
    [default] Uploading chef client validation key...
    [default] Generating chef JSON and uploading...
    [default] Running chef-client...
    stdin: is not a tty
    [Wed, 16 Jan 2013 05:20:20 -0500] INFO: *** Chef 0.10.2 ***
    [Wed, 16 Jan 2013 05:20:20 -0500] INFO: Client key /etc/chef/client.pem is not present     - registering
    [Wed, 16 Jan 2013 05:20:21 -0500] INFO: HTTP Request Returned 409 Conflict: Client already exists.
    [Wed, 16 Jan 2013 05:20:22 -0500] INFO: HTTP Request Returned 403 Forbidden: Merb::ControllerExceptions::Forbidden
    [Wed, 16 Jan 2013 05:20:22 -0500] FATAL: Stacktrace dumped to /srv/chef/file_store/chef-stacktrace.out
    [Wed, 16 Jan 2013 05:20:22 -0500] FATAL: Net::HTTPServerException: 403 "Forbidden"
    The following SSH command responded with a non-zero exit status.
    Vagrant assumes that this means the command failed!

    chef-client -c /tmp/vagrant-chef-1/client.rb -j /tmp/vagrant-chef-1/dna.json 
```

现在根据我自己的研究，我发现这意味着已经存在指定名称的客户端，因此我决定手动将其关闭。我试图列出所有的刀客户，`knife client list`但随后收到以下消息：

```
 WARNING: No knife configuration file found
    ERROR: Your private key could not be loaded from /etc/chef/client.pem
    Check your configuration file and ensure that your private key is readable 
```

奇怪的。我知道knife.rb 存在，当我看到它时`ls`，我不知道knife 配置文件怎么不存在。如果没有这个私钥，我显然看不到我的刀客。我对 Vagrant、Knife 和 Chef 完全陌生，所以我很难过。

想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T02:01:08.653

所以约定是你`knife.rb`位于`~/.chef/knife.rb`或`/etc/chef/knife.rb`- 我更喜欢前者，因为它保存在我的主文件夹中，并限制为我的用户帐户。

我通常也会将我的 Chef Server 客户端证书保存在那里。

一旦您能够`knife client list`成功执行，那么您将能够识别并删除有问题的客户端证书。（您也可以在此期间使用 Web UI）。

让 Vagrant 在销毁时删除客户端的证书是一个[建议的功能](https://github.com/mitchellh/vagrant/issues/336)，但从未实施，让操作员做出决定。

此外 - 看起来您使用的是非常旧的 Chef 版本 - 0.10.2 - 我们今天刚刚发布了 10.18.2。需要考虑的事情。

# javascript - Javascript 表不呈现

> ID：14356517
> 
> 赞同：0
> 
> 时间：2013-01-16T10:43:55.043
> 
> 标签：javascript

我正在尝试使用 javascript 呈现表格。以下是html和javascript。我很想画出我在 javascript 中使用 HTML 绘制的同一张表格。但是，脚本似乎没有呈现。

```
 <!DOCTYPE html>

 <html>

<head>

</head>

<body>

    <table width = "50%" border = "1" align = "center">
        <thead> 
            <th>ONE</th>
            <th>TWO</th>
            <th>THREE</th>
        </thead>            
        <tbody>
        <tr>
            <td>r1c1</td>
            <td>r1c2</td>
            <td>r1c3</td>
        </tr>
        <tr>
            <td>r2c1</td>
            <td>r2c2</td>
            <td>r2c3</td>
        </tr>
        </tbody>

    </table> 

</body>

<script type = "text/javascript">
    var table = document.createElement("table");
    table.width = "50%";
    table.border = "1";
    table.align = "center";

    //create the table header
    var thead = document.createElement("thead");
    table.appendChild(thead);

    //create the cells inside thead
    thead.insertRow(0);
    thead.rows[0].insertCell(0);
    thead.rows[0].cells[0].appendChild(document.createTextNode("ONE"));
    thead.rows[0].insertCell(1);
    thead.rows[0].cells[1].appendChild(document.createTextNode("TWO"));
    thead.rows[0].insertCell(2);
    thead.rows[0].cells[2].appendChild(document.createTextNode("THREE"));

    //create the table body
    var tbody = document.createElement("tbody");
    table.appendChild(tbody);

    //create the cells inside tbody
    tbody.insertRow(0);//do you start from zero here or 1?
    tbody.rows[0].insertCell(0);
    tbody.rows[0].cells[0].appendChild(document.createTextNode("r1c1"));
    tbody.rows[0].insertCell(1);
    tbody.rows[0].cells[1].appendChild(document.createTextNode("r1c2"));
    tbody.rows[0].insertCell(2);
    tbody.rows[0].cells[2].appendChild(document.createTextNode("r1c3")); 
    //now we make the 2nd row
    tbody.insertRow(1);
    tbody.rows[1].insertCell(0);
    tbody.rows[1].cells[0].appendChild(document.createTextNode("r2c1"));
    tbody.rows[1].insertCell(1);
    tbody.rows[1].cells[1].appendChild(document.createTextNode("r2c2"));
    tbody.rows[1].insertCell(2);
    tbody.rows[1].cells[2].appendChild(document.createTextNode("r2c3")); 
    //now we make the third row
    tbody.insertRow(2);
    tbody.rows[2].insertCell(0);
    tbody.rows[2].cells[0].appendChild(document.createTextNode("r3c1"));
    tbody.rows[2].insertCell(1);
    tbody.rows[2].cells[1].appendChild(document.createTextNode("r3c2"));
    tbody.rows[2].insertCell(2);
    tbody.rows[2].cells[2].appendChild(document.createTextNode("r3c3")); 

</script>
</html> 
```

如何显示第二张桌子？我的代码的哪些部分是错误的？我故意不使用 DOM 方法。

感激不尽

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T10:46:56.583

### 错误：

您已经创建了元素，但尚未将其附加到正文中。

```
document.getElementsByTagName("body")[0].appendChild(table); 
```

### 另一个解决方案：

如果你可以使用 jQuery，它也会变得不那么复杂和容易。

```
<script type = "text/javascript">
    var table = $("<table>", {width: '50%', border: 1, align: 'center'});

    //create the cells inside thead
    var row = $("<tr />").append("<th>One</th>").append("<th>Two</th>").append("<th>Three</th>");
  //create the table header

  var thead = $("<thead />").append(row);
    table.append(thead);

    //create the table body
  var tbody = $("<tbody />");

    //create the cells inside tbody
    var r1 = $("<tr />").html("<td>r1c1</td><td>r1c2</td><td>r1c3</td>");
    tbody.append(r1);

    //now we make the 2nd row
    var r2 = $("<tr />").html("<td>r2c1</td><td>r2c2</td><td>r2c3</td>");
    tbody.append(r2);

    //now we make the third row
    var r3 = $("<tr />").html("<td>r3c1</td><td>r3c2</td><td>r3c3</td>");
    tbody.append(r3);

    table.append(tbody);
    $("body").append(table);

</script> 
```

### CSS

```
th {font-weight: bold; text-align: center;} 
```

### 小提琴：http: [//jsfiddle.net/FWGsk/1/](http://jsfiddle.net/FWGsk/1/)

# javascript - Backbone.js 错误为 TypeError: this.on 不是函数 this.on("change:src", function(){

> ID：14356518
> 
> 赞同：1
> 
> 时间：2013-01-16T10:44:04.893
> 
> 标签：javascript, backbone.js

我一直在阅读这本书“开发backbone.js应用程序”，第18页有一个模型函数，如下所示：

```
 (function($){
    var Photo = Backbone.Model.extend({
        defaults: {
            'src': 'placeholder.jpg',
            'title':'an image placeholder',
            'coordinates':[0,0]
            },
        initialize:function(){
            this.on("change:sr", function(){
                var src = this.get("src");
                console.log("Image src has been updated to: "+src);
                });
            },
        changeSrc: function(source){
            this.set({'src':source});
            }
        });
    var somePhoto = new Photo({'src':'test.jpg', 'title':'testing'});
    somPhoto.changeSrc('thatPhoto.jpg');
    })(jQuery); 
```

它给了我一个错误

```
TypeError: this.on is not a function
this.on("change:src", function(){ 
```

在控制台上。
任何想法我可以如何解决这个问题。我对 Backbone.js 完全陌生。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T10:56:08.290

您可能使用的是旧版本的 Backbone。`on`/`off`仅在 0.9.0 上添加，在此之前它们被称为`bind`and `unbind`。

您应该更新到最新的[Backbone](http://backbonejs.org/)（撰写本文时为 0.9.9）。

# jquery - jQuery/Firefox：打开新窗口并更改内容（头部和身体）

> ID：14356521
> 
> 赞同：1
> 
> 时间：2013-01-16T10:44:18.920
> 
> 标签：jquery, firefox, popup, window.open

我想打开一个弹出窗口，`window.open`然后更改窗口的全部内容。

在 IE 和 Chrome 中，以下运行良好，但在**firefox中****不行**。

 **```
var Window= window.open("blanko.htm", "Win", "width=" + _iWidth + ",height=" + _iHeight + ",resizable=yes,left=" + iLeft + ",top=" + iTop + ",toolbar=1");
var Header = "<head><link rel='Stylesheet' href='CSS.css' type='text/css' /><style type='text/css'>td,th{font-size:11px;font-family:Arial;}body{font-family:Arial;font-size:12px;}</style></head>";
var Body = "<body><div>new Content</div></body>"; 
```

第一次尝试：

```
 $(Window.document).ready(function () {
        $(Window.document.head).append(Header);
        $(Window.document.body).append(Body);
    }); 
```

第二次尝试：

```
$(Window.document).ready(function () {
        $(Window.document).html(Header + Body);
}); 
```

等等

我以这种方式尝试的一切都适用于 IE 和 Chrome，但在 Firefox 中，内容正在加载，一秒钟后它被`window.open`参数中给出的站点替换（blanko.htm）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T11:19:06.160

使用纯 Javascript 是一个非常简单的解决方案：

```
var mynewWindow = window.open("", "Win", "width=" + _iWidth + ",height=" + _iHeight + ",resizable=yes,left=" + iLeft + ",top=" + iTop + ",toolbar=1");

        mynewWindow.document.write(
           '<html>' + 
             '<head>' + 
               '<title>' + myTitle + '</title>' + 
               '<link rel="Stylesheet" href="CSS.css" type="text/css" />' +
               //print on screen style
               '<style media="screen"> your CSS here </style>'+
               //Optional: print on printer style
               '<style media="print"> your CSS here </style>'+
             '</head>' + 
             '<body> <div>new Content</div> </body>' + 
           '</html>'
        ); 
```

希望有帮助

（这应该适用于所有主要的互联网浏览器）**

# hash - 哈希算法 SHA-2 和 SHA-3 有什么区别？

> ID：14356526
> 
> 赞同：19
> 
> 时间：2013-01-16T10:44:28.743
> 
> 标签：hash, cryptography, cryptographic-hash-function

我知道 SHA-224、SHA-256、SHA-384 和 SHA-512 都是[SHA-2 哈希函数系列](http://en.wikipedia.org/wiki/SHA-2)的一部分。但现在还有一种新的 SHA-3 哈希算法。

你能告诉我SHA-2和SHA-3之间的区别吗？何时以及为什么应该使用 SHA-3？SHA-3 实际上包含哪些安全哈希算法？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-01-16T11:47:01.137

[SHA-3](http://en.wikipedia.org/wiki/SHA-3)，也被称为 Keccak（它在被选为[NIST SHA-3 竞赛](http://en.wikipedia.org/wiki/NIST_hash_function_competition)获胜者之前的原名），是一种全新的哈希算法，与 SHA-1 和 SHA-2 无关。

事实上，NIST 之所以选择 Keccak 而不是其他 SHA-3 竞赛决赛选手，原因之一是它与现有的 SHA-1/2 算法不同。有人认为，这种不同使其成为对现有 SHA-2 算法（仍被 NIST 认为是安全且推荐的）的更好补充，并且使得未来任何密码分析突破都​​不太可能危及 SHA-2 算法的安全性。 2 和 SHA-3。

在某些背景下，SHA-3 哈希函数竞赛最初是由 NIST 在 2007 年宣布的，当时一些新的密码分析攻击使 SHA-1 的安全性受到质疑。虽然当时对 SHA-1 的攻击主要是理论上的兴趣，但人们担心这些技术的进一步改进可能会允许对 SHA-1 进行实际的碰撞发现攻击，并且相同的技术也可能适用于 SHA-2，它与 SHA-1 具有相似的设计。因此，NIST 决定举办一场比赛来选择 SHA-2 的继任者，将其命名为 SHA-3。

然而，虽然对 SHA-1 的真实世界碰撞攻击[最终在 2017 年得到证实](https://shattered.io/)，但对 SHA-2 的可怕攻击却未能实现。现在人们普遍认为，破解 SHA-2 不会像十年前那样容易，因此在可预见的未来，SHA-2 的所有变体仍然被认为是安全的。然而，由于 NIST 已承诺 SHA-3 将在 2012 年被选中，并且由于很多人花费了相当多的时间和精力来提交和评估新的哈希函数以供竞赛，并且因为有一些非常好的设计在决赛选手中，毕竟不选择他们中的任何一个作为获胜者似乎是一种耻辱。所以 NIST 决定选择 Keccak 作为 SHA-3，并推荐它作为*替代方案*（不是继任者）SHA-2 哈希函数。

这意味着，如果您想要一个安全且标准化的哈希函数，您可以选择 SHA-2 或 SHA-3。如果你*真的很*偏执，你甚至可能想要同时使用这两种方法，并设计你的密码系统，以便即使其中一个哈希函数被破坏，它也能保持安全。

# iphone - 如何使用单点触摸更改 UISlider 值？

> ID：14356528
> 
> 赞同：10
> 
> 时间：2013-01-16T10:44:48.573
> 
> 标签：iphone, ios, objective-c, uislider

我正在开发我的第一个 iOS 应用程序，其中包含一个`UISlider`. 我知道如何在`UISlider`拖动时获取值。但是对于我的应用程序，我需要一键获取滑块的值；即，如果我触摸 中的某处`UISlider`， a`UILabel`应该显示其正确值。

有没有可能采用这种方式。任何教程或代码都会非常有帮助。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-01-16T10:56:59.713

这里**tapCount**是在**.h 文件**`int`中声明的变量

 **```
- (void)viewDidLoad
{
  tapCount = 0; // Count tap on Slider 

 UITapGestureRecognizer *gr = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(sliderTapped:)];
    [slider addGestureRecognizer:gr];

}

 - (void)sliderTapped:(UIGestureRecognizer *)g 
    {
/////////////// For TapCount////////////

        tapCount = tapCount + 1;
        NSLog(@"Tap Count -- %d",tapCount);

/////////////// For TapCount////////////

        UISlider* s = (UISlider*)g.view;
        if (s.highlighted)
            return; // tap on thumb, let slider deal with it
        CGPoint pt = [g locationInView: s];
        CGFloat percentage = pt.x / s.bounds.size.width;
        CGFloat delta = percentage * (s.maximumValue - s.minimumValue);
        CGFloat value = s.minimumValue + delta;
        [s setValue:value animated:YES];

        NSString *str=[NSString stringWithFormat:@"%.f",[self.slider value]];
        self.lbl.text=str;
    } 
```

**对于 Swift 用户**

```
override func viewDidLoad()
{
    super.viewDidLoad()

    tapCount = 0
    let gr = UITapGestureRecognizer(target: self, action: #selector(self.sliderTapped(_:)))
    slider.addGestureRecognizer(gr)

}

func sliderTapped(_ g: UIGestureRecognizer) {

    /////////////// For TapCount////////////
    tapCount = tapCount + 1
    print("Tap Count -- \(tapCount)")
    /////////////// For TapCount////////////

    let s: UISlider? = (g.view as? UISlider)
    if (s?.isHighlighted)! {
        return
    }

    // tap on thumb, let slider deal with it
    let pt: CGPoint = g.location(in: s)
    let percentage = pt.x / (s?.bounds.size.width)!
    let delta = Float(percentage) * Float((s?.maximumValue)! - (s?.minimumValue)!)
    let value = (s?.minimumValue)! + delta
    s?.setValue(Float(value), animated: true)
    let str = String(format: "%.f", slider.value)
    lbl.text = str
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-10-19T04:04:58.920

更正@ipatel：先前答案中的**数学**不完整，并且由于缺少拇指宽度考虑而导致**抖动。**

如果您选择子类化，它应该是这样的`UISlider`：

```
- (BOOL)beginTrackingWithTouch:(UITouch *)touch withEvent:(UIEvent *)event
{
    [super beginTrackingWithTouch:touch withEvent:event];
    CGPoint touchLocation = [touch locationInView:self];
    CGFloat value = self.minimumValue + (self.maximumValue - self.minimumValue) *
        ((touchLocation.x - self.currentThumbImage.size.width/2) /
        (self.frame.size.width-self.currentThumbImage.size.width));
    [self setValue:value animated:YES];

    return YES;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-01-14T12:14:34.453

接受答案的 Swift 版本，

```
@IBAction func sliderTappedAction(sender: UITapGestureRecognizer)
{
    if let slider = sender.view as? UISlider {

        if slider.highlighted { return }

        let point = sender.locationInView(slider)
        let percentage = Float(point.x / CGRectGetWidth(slider.bounds))
        let delta = percentage * (slider.maximumValue - slider.minimumValue)
        let value = slider.minimumValue + delta
        slider.setValue(value, animated: true)
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-16T10:47:38.250

`UISlider`您可以使用其操作方法显示当前值，如下所示。

```
- (IBAction) sliderValueChanged:(UISlider *)sender {  
    yourLable.text = [NSString stringWithFormat:@"%.1f", [sender value]];  
} 
```

请参阅以下教程和示例`UISlider`：

1.  [UISlider-tutorial-example-how-to-use-slider-in-iphone-sdk-xcode](http://www.xprogress.com/post-35-uislider-tutorial-example-how-to-use-slider-in-iphone-sdk-xcode/)。
2.  [iphone-slider-control-uislider-control-tutorial](http://www.mobisoftinfotech.com/blog/iphone/iphone-slider-control-uislider-control-tutorial/)。

第二个教程带有显示当前（最新）值的示例`UISlider`，`UILable` 请参见下图。

![在此处输入图像描述](../Images/b25878b62dceae3bcb509b4acc2b4d92.png)**

# playframework - 如何在 Play Framework 1.2 中实现 HTTP Basic Auth？

> ID：14356545
> 
> 赞同：3
> 
> 时间：2013-01-16T10:45:33.497
> 
> 标签：playframework, playframework-1.x, basic-authentication

[我找到了这篇文章](http://digitalsanctum.com/2012/06/07/basic-authentication-in-the-play-framework-using-custom-action-annotation/)，但它是针对 Play 2.0 的。

有没有人为 Play 1 做过这个（我使用的是 1.2.4-mbknor-3）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-16T13:37:40.953

该`Http.Request`对象具有从 Authorization 标头填充的属性`user`。`password`你可以这样做：

```
public class Application extends Controller {   
  private static final String WWW_AUTHENTICATE = "WWW-Authenticate";
  private static final String REALM = "Basic realm=\"Your Realm Here\"";

  @Before
  static void authenticate() {
    if (!("username".equals(request.user) && "password".equals(request.password))) {
      response.setHeader(WWW_AUTHENTICATE, REALM);
      error(401, "Unauthorized");
    }
  }

  public static void index() {
    renderText("Welcome!");
  }
} 
```

# android - 网络位置提供程序不适用于 ICS（华为）

> ID：14356546
> 
> 赞同：1
> 
> 时间：2013-01-16T10:45:33.533
> 
> 标签：android, geolocation

我有新的华为手机 Ascend G330D，板载 4.0.4。问题是“网络”位置提供程序不起作用并且根本不返回任何坐标。

其他事实是 1\. 应用程序是正确的 - 它可以在很多 android 设备上运行 2\. gps 位置提供程序工作正常 3\. Google 地图应用程序即使有网络位置（即没有 gps）也能完美运行！（我已经在 /system/app 中替换了 NetworkLocation.apk，之后 Google 应用程序（地图、本地）开始使用网络位置，最初它们都不起作用） 4\. 没有任何 3rd 方应用程序（来自 Market）使用网络位置以及

由于地图不是开源的，我看不出这与使用谷歌 API 的应用程序有什么不同，但我猜谷歌地图可能会使用另一个地理定位来源（或授权密钥）......

有谁知道在哪里挖掘以使网络位置正常工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T10:55:15.890

您可以查看本教程以获取完整示例

[**获取当前位置坐标，城市名称**](http://rdcworld-android.blogspot.in/2012/01/get-current-location-coordinates-city.html)

此外，这是我的工作代码，它与两者一起使用

*   GPS 提供商
*   网络提供商

    ```
    public class MyLocationListener extends Service implements LocationListener {

    private static final String TAG = "MyLocationListener";

    private Context context = null;

    private Location location = null;
    private LocationManager locationManager = null;

    public static boolean isGPSEnabled = false;
    boolean isNetworkEnabled = false;
    boolean canGetLocation = false;

    public double latitude = 0.0;
    public double longitude = 0.0;
    public String location_address = null;

    // The minimum distance to change Updates in meters
    private static final long MIN_DISTANCE_CHANGE_FOR_UPDATES = 10;
    // The minimum time between updates in milliseconds
    private static final long MIN_TIME_BW_UPDATES = 1000 * 60 * 1; // 1 minute

    public MyLocationListener(Context ctx) {
        Log.v(TAG + ".MyLocationListener",
                "MyLocationListener constructor called");
        this.context = ctx;
        getLocationValue();
    }

    public Location getLocationValue() {
        Log.v(TAG + ".getLocationValue", "getLocationValue method called");

        try {
            locationManager = (LocationManager) context
                    .getSystemService(LOCATION_SERVICE);

            isGPSEnabled = locationManager
                    .isProviderEnabled(LocationManager.GPS_PROVIDER);

            isNetworkEnabled = locationManager
                    .isProviderEnabled(LocationManager.NETWORK_PROVIDER);

            if (isGPSEnabled) {

                this.canGetLocation = true;
                Log.v(TAG + ".getLocationValue", "GPS provider enabled");
                // Toast.makeText(context, "Gps", 1).show();
                if (location == null) {
                    locationManager.requestLocationUpdates(
                            LocationManager.GPS_PROVIDER, MIN_TIME_BW_UPDATES,
                            MIN_DISTANCE_CHANGE_FOR_UPDATES, this);
                    if (locationManager != null) {
                        location = locationManager
                                .getLastKnownLocation(LocationManager.GPS_PROVIDER);
                        if (location != null) {
                            latitude = location.getLatitude();
                            longitude = location.getLongitude();
                            Log.v(TAG, "Gps Co-ordinates are:" + latitude + " "
                                    + longitude);

                        }
                    }
                }

            } else if (isNetworkEnabled) {

                // Toast.makeText(context, "Net", 1).show();
                Log.v(TAG + ".getLocationValue", "Network provider enabled");
                locationManager.requestLocationUpdates(
                        LocationManager.NETWORK_PROVIDER, MIN_TIME_BW_UPDATES,
                        MIN_DISTANCE_CHANGE_FOR_UPDATES, this);

                if (locationManager != null) {
                    location = locationManager
                            .getLastKnownLocation(LocationManager.NETWORK_PROVIDER);
                    if (location != null) {
                        latitude = location.getLatitude();
                        longitude = location.getLongitude();
                        Log.v(TAG, "Co-ordinates are: " + latitude + " "
                                + longitude);

                    }
                }

            } else {
                showSettingsAlert();
            }

        } catch (Exception e) {
            e.printStackTrace();
        }

        return location;
    }

    /**
     * Stop using GPS listener Calling this function will stop using GPS in your
     * app
     * */
    public void stopUsingGPS() {
        if (locationManager != null) {
            locationManager.removeUpdates(MyLocationListener.this);
        }
    }

    public double getLatitude() {
        if (location != null) {
            latitude = location.getLatitude();
        }
        return latitude;
    }

    public double getLongitude() {
        if (location != null) {
            longitude = location.getLongitude();
        }
        return longitude;
    }

    /**
     * Function to check GPS/wifi enabled
     * 
     * @return boolean
     * */
    public boolean canGetLocation() {
        return this.canGetLocation;
    }

    /**
     * Function to show settings alert dialog On pressing Settings button will
     * lauch Settings Options
     * */
    public void showSettingsAlert() {
        AlertDialog.Builder alertDialog = new AlertDialog.Builder(context);

        alertDialog.setTitle("GPS Settings");
        alertDialog
                .setMessage("GPS is not enabled. Do you want to go to settings menu?");

        alertDialog.setPositiveButton("Settings",
                new DialogInterface.OnClickListener() {
                    public void onClick(DialogInterface dialog, int which) {
                        Intent intent = new Intent(
                                Settings.ACTION_LOCATION_SOURCE_SETTINGS);
                        context.startActivity(intent);
                    }
                });
        alertDialog.setNegativeButton("Cancel",
                new DialogInterface.OnClickListener() {
                    public void onClick(DialogInterface dialog, int which) {
                        dialog.cancel();
                    }
                });
        alertDialog.show();
    }

    @Override
    public void onLocationChanged(Location location) {
    }

    @Override
    public void onProviderDisabled(String provider) {
    }

    @Override
    public void onProviderEnabled(String provider) {
    }

    @Override
    public void onStatusChanged(String provider, int status, Bundle extras) {
    }

    @Override
    public IBinder onBind(Intent intent) {
        return null;
    }} 
    ```

以这种方式使用上面的代码，只要你想在任何活动中

```
MyLocationListener mylistner = new MyLocationListener(context);
        double lat = mylistner.latitude;
        double lon = mylistner.longitude; 
```

**注意**：我的清单中也有打击权限

```
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"/>
<uses-permission android:name="android.permission.INTERNET"/>

<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"/>
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION"/>
<uses-permission android:name="android.permission.ACCESS_LOCATION_EXTRA_COMMANDS"/>   
<uses-permission android:name="android.permission.ACCESS_MOCK_LOCATION" /> 
```

# jquery - localStorage 不刷新网格

> ID：14356547
> 
> 赞同：0
> 
> 时间：2013-01-16T10:45:41.350
> 
> 标签：jquery, grid, local-storage, kendo-ui

我无法解决这个问题。

这是我的代码

```
var selectedID = "";
    var selectedIDPremise = "";
    var PremisesGrid = "";
    var PremisesGrid2 = "";
    var selectedIDPremise2 = "";
    //var selectedOD2 = "";
    var nova = "";

    $(document).ready(function () {

        $("#routes").kendoDropDownList({
            dataTextField: "Name",
            dataValueField: "Id",
            dataSource: {
                type: "application/jsonp",
                transport: {
                    read: {
                        url: "http://" + servername + "/uBillingServices/Administration/Administration.svc/getRoute",
                        dataType: "json",
                        data: {
                            ID: 0
                        }
                    }
                }
            },
            select: onSelect
        });

        //nova = PremisesGrid2.getKendoDropDownList().dataSource.transport.options.read.data.Route_ID;

        function onSelect(e) {

            //$.getJSON("http://" + servername + "/uBillingServices/Administration/Administration.svc/getRoute", { ID: nova }, function (json) { });
            window.localStorage.setItem("Nova", "");
            nova = this.dataItem(e.item.index());
            window.localStorage.setItem("Nova", nova.ID);
            PremisesGrid2.getKendoGrid().dataSource.read();
            //nova = PremisesGrid2.getKendoDropDownList().dataSource.transport.options.read.data.Route_ID;
            // var data = [{}];
            //PremisesGrid2.getKendoGrid().dataSource.data(data)
            for (var i = 0; i < 3000; i++) {
                if (i == 2999) {
                    PremisesGrid2.getKendoGrid().dataSource.read();
                }
            }

        }
            PremisesGrid2 = $("#assignedRoute").kendoGrid({
                //dataTextField: "Name",
                //dataValueField: "Id",
                dataSource: {
                    type: "application/jsonp",
                    transport: {
                        read:
                                {
                                    url: "http://" + servername + "/uBillingServices/Premise/Premise.svc/GetAllPremisesByRoute",
                                    dataType: "json",
                                    data: {
                                        Route_ID: window.localStorage.getItem("Nova"),
                                        UserName: userName,
                                        WorkStation: workStation

                                    }
                                }
                    },
                    schema: {
                        model: {
                            fields: {
                                ID: { type: "string" },
                                PostalCode: { type: "string" },
                                Latitude: { type: "string" },
                                Longitude: { type: "string" },
                                IsMember: { type: "string" }

                            }
                        }
                    }
                },
                change: function (arg) {

                    myIndex = this.select().index();
                    var PremisesRow = this.select();

                },
                dataBound: function (e) {

                    row = e.sender.tbody.find(">tr:not(.k-grouping-row)").eq(0);
                    if (row.length == 0) {
                        e.sender.select(e.sender.tbody.find(">tr:first"));
                    }
                    else {
                        e.sender.select(row);
                    }
                },
                selectable: true,
                scrollable: true,
                filterable: true,
                groupable: false,
                sortable: {
                    mode: "single",
                    allowUnsort: false
                },
                height: 330,

                columns: [
                    { field: "PostalCode", title: "Assigned Route" }
                    ]//, width: "100px"
            }); 
```

localStorage 工作正常（在资源中它发生了变化），但是当我选择另一个 Reon（形成 DropDown 列表）时它不会刷新网格，当我刷新页面时它显示我选择的最后一个

谁能告诉我有什么问题？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T12:29:44.067

有几个问题：

1.  `ID`和之间的混淆`Id`。
2.  `data`定义 in`transport.read.data`需要是一个函数。

关于1.在`DropDownList`你说的定义中，`dataValueField: "Id"`但在`onSelect`你使用：`window.localStorage.setItem("Nova", nova.ID);`

关于 2\. 将`data`from的定义更改`object`为`function`。这边走：

```
data    : function () {
    return {
        {
            Route_ID: window.localStorage.getItem("Nova"),
            UserName: userName,
            WorkStation: workStation
        }
    }
} 
```

# jsf - 在 JSF 中实现 I18N

> ID：14356548
> 
> 赞同：0
> 
> 时间：2013-01-16T10:45:47.053
> 
> 标签：jsf, internationalization

我想在我的 JSF 应用程序中登录时设置特定的用户语言环境。

为此，我从他的属性中获取用户区域设置并通过设置用户区域设置

```
FacesContext.getCurrentInstance().getViewRoot().setLocale(userLocale); 
```

在成功登录的登录期间。

我的问题是，当我在用户会话期间向用户显示消息时，我通过的语言环境

```
FacesContext context = FacesContext.getCurrentInstance();
    if (context != null && context.getViewRoot() != null) {
        locale = context.getViewRoot().getLocale();
        ... 
```

始终是默认语言环境。

我的代码中没有设置语言环境的其他点，所以我无法弄清楚为什么会发生这种情况。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T11:30:00.457

您基本上只是为**当前**视图设置区域设置，即登录页面。您需要记住会话范围内的用户区域设置，并在同一会话的所有后续视图中进行设置。

您可以通过创建`userLocale`某个会话范围 bean 的属性（可能只是登录用户本身？）并`<f:view locale>`在您的主模板中引用它来做到这一点。

```
<f:view locale="#{user.locale}"> 
```

`viewRoot.setLocale(user.getLocale())`这将对每个视图隐式执行。

### 也可以看看：

*   [JSF 中的本地化，如何记住每个会话而不是每个请求/视图选择的语言环境](https://stackoverflow.com/questions/4830588/jsf-locale-is-set-per-request-not-for-session/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T11:17:05.057

您应该多说些什么，为什么您从有关用户首选本地的请求信息中收集什么，但可以说您是从标头中获取的`accept-language`

然后，正如 JSF 规范所说：

> UIViewRoot 的 Locale 由 ViewHandler 在执行 ViewHandler 的 createView() 方法期间确定和设置。此方法必须通过查看用户的偏好以及应用程序声明的支持的语言环境来确定活动的语言环境。

因此，一件事是在 ViewRoot 中设置 Locale 并从请求标头中收集 Locale，另一件事是在您的配置文件中正确设置支持的语言环境。

在规范的其他部分，您可以阅读（参见`ViewHandler calculateLocale`方法）：

> 方法 Application.getSupportedLocales() 定义了这个 JSF 应用程序能够支持的语言环境。此方法应匹配此类数据源并返回 Locale 对象，这是将当前应用程序呈现给当前用户的最佳选择。

为什么会这样？因为如果您的应用程序不支持使用该语言环境发送响应，则您无法使用用户首选的语言环境向用户发送响应。现在您所要做的（我希望如此）就是像这样配置您的`faces-config.xml`in`WEB-INF`目录（也从 JSF 规范复制）：

```
<faces-config>
  <application>
    <locale-config>
      <default-locale>en</default-locale>
      <supported-locale>de</supported-locale>
      <supported-locale>fr</supported-locale>
      <supported-locale>es</supported-locale>
//    ...
    </locale-config>
  </application>
</faces-config> 
```

# sql-server-2008 - 如何将数字转换为日期

> ID：14356549
> 
> 赞同：0
> 
> 时间：2013-01-16T10:45:47.637
> 
> 标签：sql-server-2008

我应该如何将数字转换为日期？

例如：-

我想输入数字为 31，它应该找到所有月份的日期为 31，它应该显示如下所示的当年。

```
Date           Day
31-01-2013     Thursday
31-03-2013     Sunday 
```

以及我应该如何将数字转换为日期。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T19:02:19.050

[SQL小提琴](http://sqlfiddle.com/#!3/d41d8/7789)

**MS SQL Server 2008 架构设置**：

**查询 1**：

```
declare @Day int;
set @Day = 31

select D.D,
       datename(weekday, D.D) as DOW
from (values (1),(2),(3),(4),(5),(6),(7),(8),(9),(10),(11),(12)) as M(M)
  cross apply (select dateadd(day, 
                              @Day - 1, 
                              dateadd(month, 
                                      M.M - 1, 
                                      dateadd(year, 
                                              year(getdate()) - 1, 
                                              cast('00010101' as date))))) as D(D)
where day(D.D) = @Day 
```

**[结果](http://sqlfiddle.com/#!3/d41d8/7789/0)**：

```
|          D |       DOW |
--------------------------
| 2013-01-31 |  Thursday |
| 2013-03-31 |    Sunday |
| 2013-05-31 |    Friday |
| 2013-07-31 | Wednesday |
| 2013-08-31 |  Saturday |
| 2013-10-31 |  Thursday |
| 2013-12-31 |   Tuesday | 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T18:29:36.100

我不确定这是否正是您想要做的，但如果您先创建一个[日历表](http://web.archive.org/web/20070611150639/http://sqlserver2000.databases.aspfaq.com/why-should-i-consider-using-an-auxiliary-calendar-table.html)，那么这是一个非常简单的查询：

```
select [Date], [Day]
from dbo.Calendar
where YearNumber = 2013 and DayNumber = 31 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T18:37:12.713

您可以使用该[`day()`](http://msdn.microsoft.com/en-us/library/ms176052.aspx)函数将日期列中的日期与您提供的值进行比较。然后您可以使用[`datename()`](http://msdn.microsoft.com/en-us/library/ms174395.aspx)获取工作日：

```
declare @val int = 31

select dt, datename(dw, dt)
from yourtable
where day(dt) = @val 
```

请参阅[带有演示的 SQL Fiddle](http://www.sqlfiddle.com/#!3/a27b3/5)

# php - 在 UIWebView 中检测下载链接

> ID：14356559
> 
> 赞同：0
> 
> 时间：2013-01-16T10:46:11.007
> 
> 标签：php, ios, xcode, uiwebview, download

我正在编写一个需要检测 UIWebView 是否正在导航到存储在 Web 服务器上的 IPA 文件的地址的应用程序。

**例子：**

[http://www.website.com/ipa.ipa](http://www.website.com/ipa.ipa)

显然，在正常情况下，导航到 IPA 的地址时会显示错误，但是对于我的应用程序，我需要能够捕获 IPA 的地址并将其存储为`NSString`要发送到服务器进行处理的地址。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T13:42:44.710

这是 UIWebViewDelegate 协议中的一种方法，它可能会有所帮助：

```
- (BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType; 
```

只需将您的控制器设置为 webview 的委托并实现上述方法。

# python - 是否可以在 python 中将语法同义词添加到“def”？

> ID：14356560
> 
> 赞同：-3
> 
> 时间：2013-01-16T10:46:15.773
> 
> 标签：python, syntax, metaprogramming

我想用 let 而不是 def。

我正在寻找以这种方式更改自己代码语法的明智方法。

基本上在c中它会是

```
#define let def 
```

如何在python中做同样的事情？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-16T10:48:35.033

`def`是python中的关键字，因此不能更改为其他任何内容。

从[文档](http://docs.python.org/2/reference/lexical_analysis.html#keywords)：

> 以下标识符用作保留字，或语言的关键字，不能用作普通标识符。它们的拼写必须与此处所写的完全相同：

```
and       del       from      not       while as        elif     
global    or        with assert    else      if        pass      yield
break     except    import    print class     exec      in       
raise continue  finally   is        return def       for       lambda 
try 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T11:44:29.830

`#define let def`

这将在 C 中起作用，因为它是一个预处理器命令。在这里，您不是在欺骗 C，而是在欺骗阅读您的代码的人。

要在 Python 中实现相同的目标，您需要一个预处理器。像 C 一样，你不会欺骗 Python，你只会欺骗读者。

所以你可以编写一个预处理器来启动你的程序。像 C 一样，您将生成一个中间文件，然后“真正的”python 编译器将使用该文件。

我不是唯一一个认为这不是一个好主意的人。这是支持的噩梦。 *你*有这种偏好，但是每个追随你的人呢？如果您开始弄乱关键字，其他人如何维护此代码？

# ruby-on-rails - 将 current_password 字段添加到以下更改密码视图？

> ID：14356565
> 
> 赞同：0
> 
> 时间：2013-01-16T10:46:22.997
> 
> 标签：ruby-on-rails

我有一个使用 Rails 构建的**用户**`has_secure_password`模型（基于[Rails 教程书](http://ruby.railstutorial.org/ruby-on-rails-tutorial-book)）：

**架构.rb：**

```
create_table "users", :force => true do |t|
  t.string   "password_digest"
end 
```

**用户.rb：**

```
class User < ActiveRecord::Base
  attr_accessible :name, :email, :avatar, :password, :password_confirmation, :provider, :uid

  has_secure_password

  validates :password, presence: true, length: { minimum: 6 }
  validates :password_confirmation, presence: true 
```

我有这样的看法`uses/password_edit.html.erb`：

```
<%= f.label :password %>
<%= f.password_field :password, "New Password" %>

<%= f.label :password_confirmation, "Retype Password" %>
<%= f.password_field :password_confirmation %> 
```

现在，我想`:current_password`在顶部添加一个字段。问题是数据库只有一`password_digest`列。

所以，我在这里有点迷路了。我什至不确定如何使表单在​​不正确时引发`current_password`错误。

有什么建议么？

编辑：

**users_controller.html.erb：**

def update old_password = params[:current_password]

```
if authenticated = User.authenticate(old_password)
  if params[:user][:password].blank? && params[:user][:password_confirmation].blank?
    # Use old password if none indicated
    params[:user][:password] = old_password
    params[:user][:password_confirmation] = old_password
  end
end

@user = User.find(params[:id]) 
@user.errors.add(:base, "Invalid password") unless authenticated
@user.updating_password = true if params[:form_name] == "edit_password"
if authenticated && @user.update_attributes(params[:user])
  flash[:success] = "Profile updated"
  sign_in @user
  redirect_to @user
else
  if params[:form_name] == "edit_password"
    render 'edit_password'
  else
    render 'edit'
  end
end
@user.updating_password = nil 
```

结尾

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T15:13:47.280

我最近做了类似的事情。我在视图中添加了一个与模型无关的输入，然后我的控制器看起来像这样：

```
def update
  old_password = params[:current_password]

  @user = User.find(params[:id])

  if authenticated = @user.authenticate(old_password)
    if params[:user][:password].blank? && params[:user][:password_confirmation].blank?
      # Use old password if none indicated
      params[:user][:password] = old_password
      params[:user][:password_confirmation] = old_password
    end
  end

  @user.errors.add(:base, "Invalid password") unless authenticated

  if authenticated && @user.update_attributes(params[:user])
  ...
end 
```

它似乎对我有用。我希望它对你有帮助。

# passwords - 如何实现这些强密码要求？

> ID：14356568
> 
> 赞同：1
> 
> 时间：2013-01-16T10:46:29.963
> 
> 标签：passwords

*   没有键盘模式。即键盘上垂直或水平相邻的键。例如，“ZXCVBN123”应该被拒绝。
*   没有常用词，也没有倒写或伪装特殊字符的词。例如 'Universe1' 和 'Un1ver$e' 应该被拒绝。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T10:56:22.127

好吧，首先你需要准确地定义你想要什么。什么是键盘模式？'jk' 是键盘模式，还是只是 'jkl'？最短的模式是什么？“gy”是一种模式吗？首先，您需要定义真正的模式。

然后你应该列出所有可用的模式（没有那么多。你有 36 个起点和从每个起点出发的 4 个方向）。当您获得密码时，请尝试找到其中的每个模式。请注意，如果您确定最短的模式是 3 个字母长，则不需要搜索 4 个字母的模式，所有 4 个字母的模式都已经包含 3 个字母的模式。

至于文字，这更容易，但首先您需要列出所有不允许的转换（$->S、1->i 等...）。一旦你得到一个词，应用所有的转换并给自己一个“规范化”的词。将标准化密码与所有合法单词的字典进行两次比较 - 第二次反转密码。

您可能需要做一些比这更复杂的事情，因为您需要忽略单词末尾的数字 -*有时*. 1ncredible 可以替代“incredible”，尽管 ncredible 不是一个词。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T12:17:13.017

如果您检查[http://howsecureismypassword.net](http://howsecureismypassword.net)的代码，您可以看到该密码与大量常用密码进行了比较。

在页面 threre 是对页面[http://xato.net/passwords/more-top-worst-passwords/](http://xato.net/passwords/more-top-worst-passwords/)的引用，该页面列出了前 10.000 个最常见的密码。

一种方法是下载该列表并检查用户密码或至少前 100 个密码。

# javascript - 如何结合谷歌应用脚 本processForm、withSuccessHandler和withUserObject

> ID：14356570
> 
> 赞同：0
> 
> 时间：2013-01-16T10:46:35.610
> 
> 标签：javascript, google-apps-script

所以我在这里关注文档：

[https://developers.google.com/apps-script/html_service?hl=en#GoogleScriptAPI](https://developers.google.com/apps-script/html_service?hl=en#GoogleScriptAPI)

似乎我应该能够在同一个地方使用 processForm、withSuccessHandler 和 withUserObject，但我目前无法让它工作。这是一次尝试

```
<input name='submission'>
<input type='hidden' name='match' value ='<?= match?>'>
<input type='hidden' name='week' value ='<?= j?>'>
<input type='hidden' name='assignment' value ='<?= i?>'>
<input id='button' type='button' onclick='google.script.run.processForm(this.parentNode).withSuccessHandler(submissionReceived).withUserObject(this).getCurrentDate()'> 
```

但这在单击按钮时给了我以下错误：

无法读取未定义的属性“withSuccessHandler_m___”

以下确实有效：

`google.script.run.withSuccessHandler(submissionReceived).processForm(this.parentNode)`

但是我希望“submissionReceived”函数接收本地对象，以便我可以进行一些本地更改以反映这个特定按钮（许多）已被单击的事实。基本上这个顺序：

`google.script.run.processForm(this.parentNode).withSuccessHandler(submissionReceived)`

失败并出现相同的“无法读取未定义的属性'withSuccessHandler_m___'”错误，无论我是否尝试将对象传递给submissionReceived

以下将运行：

`google.script.run.withSuccessHandler(submissionReceived).withUserObject(this).processForm(this.parentNode)`

但是传递给 submitReceived 的单个参数是未定义的

关于如何成功组合这三个函数以便在单击按钮时将对象传递给客户端 javascript 函数的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T12:09:41.263

我设法使它与以下内容一起使用：

```
var r = google.script.run.withSuccessHandler(submissionReceived).withUserObject(this);r.processForm(this.parentNode); 
```

似乎需要先设置成功处理程序。还要注意，这给submissionReceived函数传递了两个参数，第一个是undefined，第二个是当前本地对象，所以函数定义是这样的：

```
function submissionReceived(a,input) { 
```

其中a是未定义的，输入是与脚本运行的输入标签对应的dom节点

# gtk - 如何使用 python 获取当前 gedit 文档的名称？

> ID：14356572
> 
> 赞同：2
> 
> 时间：2013-01-16T10:46:43.213
> 
> 标签：gtk, pygtk, gtk3, gedit, gedit-plugin

我正在为 gtk3 编写一个 gedit 插件。有没有一种简单的方法可以使用 python 获取当前文档的名称？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T12:23:59.773

[这是关于编写 gedit 3 插件](http://www.micahcarrick.com/writing-plugins-for-gedit-3-in-python.html)的非常好的教程。示例 #3 执行您想要的操作：连接到“打开新选项卡”信号并写入文档名称。

在这里你有完整的[Gedit API 参考](http://developer.gnome.org/gedit/stable/)。

```
handler_id = self.window.connect("tab-added", self.on_tab_added)

(...)

def on_tab_added(self, window, tab, data=None):
    document = tab.get_document()
    print "'%s' has been added." % document.get_short_name_for_display()
    print "New file's path: %s" % document.get_uri_for_display() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T12:16:06.637

这里有人可能知道，但我认为您可以通过在[gedit 邮件列表](http://mail.gnome.org/mailman/listinfo/gedit-list)上提问来提高获得答案的机会。

**编辑：**

GNOME wiki 上还有一个[GEdit python 插件 howto](https://live.gnome.org/Gedit/PythonPluginHowTo)。

# prestashop - 删除 prestashop 导入 csv 文件

> ID：14356575
> 
> 赞同：3
> 
> 时间：2013-01-16T10:46:53.097
> 
> 标签：prestashop

简单问题：如何从系统中删除 PrestShop 导入 CSV 文件？我也尝试过使用 FTP，但找不到文件。

它在导入窗口的下拉列表中显示了许多行，我不知道哪个是同名文件中最新的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T22:26:40.637

您的文件将位于`admin/import/*`（这里的管理员是您的后台目录，曾经在旧版本中重命名）目录，通过 FTP 删除是最好的方法。我不确定 Presta 的最新版本，但在它之前的主要版本没有在 GUI 中的任何位置删除这些文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-20T17:01:16.433

在后台选择时，最新的文件将是最上面的。管理员/导入是您可以一次删除所有 csv 文件的地方，而不是在后台一次删除一个。最后，您的文件夹名称可能不会被称为“admin”，而是会被称为您的任何名称，例如，当您安装 prestashop 时，您的 prestashop 自动安装程序将其命名。它将与您用于登录 prestashop 后台的名称相同（“@yoururl.com”、“.org”等之前的名称。

# pandas - RMagic、IPython 和摘要信息

> ID：14356577
> 
> 赞同：5
> 
> 时间：2013-01-16T10:46:55.677
> 
> 标签：pandas, ipython, rpy2, ipython-notebook

按照这里的例子

[http://www.randalolson.com/2013/01/14/filling-in-pythons-gaps-in-statistics-packages-with-rmagic/](http://www.randalolson.com/2013/01/14/filling-in-pythons-gaps-in-statistics-packages-with-rmagic/)

我在 IPython 笔记本中在这里找到的不同数据集上尝试了相同的方法。

[https://github.com/burakbayramli/kod/blob/master/delltest/dell.tgz](https://github.com/burakbayramli/kod/blob/master/delltest/dell.tgz)

```
from pandas import *
orders = read_csv("dell.csv",sep=",")
%load_ext rmagic
%R -i orders print(summary(orders)) 
```

我明白了

```
 Length Class  Mode
[1,] 25     -none- list
[2,] 25     -none- list
[3,] 25     -none- list
.. 
```

但是在 R 中也是一样的

```
data <- read.csv ("dell.csv",header=TRUE,sep=",")
print (summary(data)) 
```

给我正确的摘要信息。

```
 rank        per_customer_count total_total_amount    orderid     
 Min.   : 1.000   Min.   : 1.000     Min.   :    0.14   Min.   :    1  
 1st Qu.: 2.000   1st Qu.: 6.000     1st Qu.:  866.11   1st Qu.: 2964  
 Median : 4.000   Median : 8.000     Median : 1764.08   Median : 5980  
 Mean   : 4.997   Mean   : 9.426     Mean   : 2004.95   Mean   : 5987  
 3rd Qu.: 7.000   3rd Qu.:12.000     3rd Qu.: 2856.06   3rd Qu.: 9004  
 ... 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T12:58:14.647

我快速浏览了一下，似乎在许多情况下 ipython 魔法无法正确转换。我必须就 rmagic 和更多魔法与他们取得联系。

与此同时，您应该能够从下面的代码片段中编写出您需要进行的内容：

```
import pandas
orders = pandas.read_csv("dell.csv", sep=",")
%load_ext rmagic

import rpy2.robjects
d = dict()
for i, (k,v) in enumerate(orders.iteritems()):
    print("%s (type: %s - %i/%i)" %(k, v.dtype.kind, i, orders.shape[1]))
    if v.dtype.kind == 'O':
      v = rpy2.robjects.vectors.StrVector(v)
    d[k] = rpy2.robjects.conversion.py2ri(v)
df = rpy2.robjects.DataFrame(d)

def print_rsummary(x):
    print(rpy2.robjects.baseenv['summary'](x))

print_rsummary(df) 
```

# visual-studio-2012 - 您可以配置 Visual Studio 查找选项吗？

> ID：14356579
> 
> 赞同：7
> 
> 时间：2013-01-16T10:46:59.703
> 
> 标签：visual-studio-2012, visual-studio-2013

当我按下 Ctrl+F 时，是否可以让 VS 2012 查找对话框始终使用*当前文档*并重置*大小写*和*全字？*目前它记得我最后的选择，我经常忘记关闭它们。

此外，它有时会自行切换到*所有打开的文档，这完全让我失望。*我还没有弄清楚为什么或何时会发生这种情况。

我已经搜索了注册表项和扩展名，但到目前为止还没有发现任何有用的信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-21T22:02:45.560

无法让对话框或快速查找 UI 始终选择开箱即用的特定范围。在 VS 2012 的 beta 版本中，实现了此行为，其中 CTRL+F 始终将范围设置为当前文档，而 Ctrl+Shift+F 将在调用命令时设置范围整个解决方案。很多用户对此行为不满意，因此将其还原。没有可以设置的注册表项来更改此行为。

Visual Studio 总是尝试重用上次使用的范围。在某些情况下，该范围不可用，这将导致 IDE 更改您的范围。假设您在“当前项目”中进行搜索，然后关闭整个解决方案，然后调用对话框。范围将不得不更改为其他内容。

您可能知道这一点，但 Ctrl+F3 将搜索插入符号下的单词，并且它始终会在当前文档中使用 Whole Word 选项执行该搜索。也许这会满足您的需求。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T19:43:42.670

我已经发布了一个 Visual Studio“SmartFind”扩展来解决这个问题。

[http://visualstudiogallery.msdn.microsoft.com/015611c4-b357-4672-8977-f3ec92f0b808](http://visualstudiogallery.msdn.microsoft.com/015611c4-b357-4672-8977-f3ec92f0b808)

# java - java - 计算周数 - 开始日期为星期一，结束日期为星期日

> ID：14356580
> 
> 赞同：1
> 
> 时间：2013-01-16T10:47:00.530
> 
> 标签：java, date, calendar

以下是我用来计算一个月中周数的代码。但实际上我需要周数，每周的开始日为星期一，结束日为星期日。例如，2012 年 1 月将有 5 周。但按照上述标准，它将有 6 周。
2012 年 1 月
第一周 - 01 日星期日
第二周 - 2 日星期一至 8 日星期日
第三周 - 9 日星期一至 15 日星期日
第四周 - 16 日星期一至 22 日星期日
第五周 - 23 日星期一至 29 日星期日
第六周 - 30 日星期一至 31 日星期二。

以下代码仅给出 5 周。

```
public class Test { 
    public static void main(String[] args) 
    { 
        Calendar calendar = Calendar.getInstance(); 
        int year = 2012; 
        int month = Calendar.JANUARY; 
        int date = 1; 
        calendar.set(year, month, date); 
        int numOfDaysInMonth = calendar.getActualMaximum(Calendar.DAY_OF_MONTH); 
        int numOfWeeksInMonth = calendar.getActualMaximum(Calendar.WEEK_OF_MONTH); 
        System.out.println("Number of Days In Month: " + numOfDaysInMonth); 
        System.out.println("Number of Weeks In Month: " + numOfWeeksInMonth);

}

} 
```

上述代码的输出是
Number of Days In Month: 31
Number of Weeks In Month: 5

但是我需要将“月中的周数：”设为 6
**另外我正在尝试以 ddMMYYYY 格式获取每周的开始日期和结束日期.. ** 我仍在努力。

谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T11:04:42.117

添加这个得到 `"Number of Weeks In Month:" as 6`，

```
calendar.setFirstDayOfWeek(Calendar.MONDAY); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T11:00:44.403

试试这个功能

```
public static void main(String[] args) {
    System.out.println(getNumberOfWeeks(2012, Calendar.JANUARY));
}

static int getNumberOfWeeks(int year, int month) {
    Calendar c = Calendar.getInstance();
    c.set(Calendar.YEAR, year);
    c.set(Calendar.MONTH, month);
    c.set(Calendar.DAY_OF_MONTH, 1);
    int numOfWeeksInMonth = 1;
    while (c.get(Calendar.MONTH) == month) {
        c.add(Calendar.DAY_OF_MONTH, 1);
        if (c.get(Calendar.DAY_OF_WEEK) == Calendar.MONDAY) {
            numOfWeeksInMonth++;
        }
    }
    return numOfWeeksInMonth;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-16T11:27:08.263

试试这个：

```
public static int noWeeks(int year,int month)
{
     Calendar c = Calendar.getInstance();
        c.set(Calendar.YEAR, year);
        c.set(Calendar.MONTH, month);
        c.set(Calendar.DAY_OF_MONTH, 1);

    int initDay = c.get(Calendar.DAY_OF_WEEK)-1
            ;
    int days =  c.getActualMaximum(Calendar.DAY_OF_MONTH);
    int a = (initDay==0?7:initDay)+days-1;
    return a/7+(a%7==0?0:1);

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-23T18:27:29.130

O algoritmo correto é esse：

```
public static int getTotalWeeksOfMonth(int month, int year){

    int monthIndex = month-1;

     Calendar c = Calendar.getInstance();
     c.set(Calendar.YEAR, year);
     c.set(Calendar.MONTH, monthIndex);
     c.set(Calendar.DAY_OF_MONTH, 1);

     int numOfWeeksInMonth = 0;
     while (c.get(Calendar.MONTH) == monthIndex) {
         c.add(Calendar.DAY_OF_MONTH, 1);
         int dayOfWeek = c.get(Calendar.DAY_OF_WEEK);
         if ( dayOfWeek == Calendar.SUNDAY) {
             numOfWeeksInMonth++;
         }
     }

     if (c.get(Calendar.DAY_OF_WEEK) != Calendar.SUNDAY) {
         numOfWeeksInMonth++;
     }

     return numOfWeeksInMonth;
} 
```

# c - 如何配置和运行 nginx-gridfs

> ID：14356581
> 
> 赞同：3
> 
> 时间：2013-01-16T10:47:03.760
> 
> 标签：c, mongodb, github, nginx

我正在尝试从 github 运行 nginx-gridfs 以将 mongodb 与 nginx 连接。[我按照https://github.com/mdirolf/nginx-gridfs](https://github.com/mdirolf/nginx-gridfs) README 文件中所示的确切程序进行操作。

我在我的系统中编译并制作了 nginx。通过以下步骤

```
$ ./configure --add-module=/path/to/nginx-gridfs/source/
$ make
$ make install 
```

现在下一步该做什么

我无法理解如何在 README 文件中隐含配置指令部分。

现在 nginx-gridfs 有 ngx_http_gridfs_module.c 。我必须编译并运行它才能看到响应。我编译并制作 mongo c 驱动程序并运行 example.c 它运行良好。

有人指导我或给我一些好的链接，这些链接解释了 nginx-gridfs 的逐步配置。

我的最终目标是链接 nginx+mongodb+C 代码..

请帮我 ...

# validation - HTA 文件中的表单验证

> ID：14356582
> 
> 赞同：0
> 
> 时间：2013-01-16T10:47:04.647
> 
> 标签：validation, hta

如何在此 HTA 表单上执行简单验证以确保输入数据并选择选项？这应该很简单，我不确定我错过了什么。

任何答案或建议将不胜感激。

谢谢。

```
<html><head><title>Write data to text file</title>

<HTA:APPLICATION 
border="thin" 
borderStyle="normal" 
caption="yes" 
maximizeButton="no" 
minimizeButton="yes" 
showInTaskbar="yes" 
innerBorder="yes"
navigable="yes"
scroll="auto"
scrollFlat="yes" />

<script language="javascript">
window.resizeTo(480,150)

function Writedata()
{
var fso = new ActiveXObject("Scripting.FileSystemObject");

var write_id;
write_id = document.getElementById('write_id').value ;

alert('The data has been written to \n' + write_id);
var s = fso.OpenTextFile(write_id, 8, true);

s.WriteLine(document.getElementById('name_id').value);

s.Close();
}

</script>

</head>
<body>

<table>
<tr>
<h3>Input some information</h3>
<form>
<td>Input: </td><td><input type="text" name="name" value="" id="name_id"></td>

<td><select id="write_id">
  <option name="write" value="">Select an Option</option>
  <option name="write" value="C:\temp\option1.txt">Option1</option>
  <option name="write" value="C:\temp\option2.txt">Option2</option>
</select></td>

<td><input type="button" onclick="Writedata()" value="submit"></td>
</form>
</tr>
</table>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T12:52:42.567

我被难住了，所以我用 vbscript 重写了这个。

我已经包含了我所做的一些事情，让您了解如何写入文本文件，并使用 HTA 验证您的表单。

VB脚本：

```
Set wshShell = CreateObject( "WScript.Shell" )
strSender = wshShell.ExpandEnvironmentStrings( "%USERNAME%" ) ' Get the current Username

Dim Checkmark

Sub Validate

If form.Flag.checked = True Then ' Find out if your Checkbox is checked
    Checkmark = "*"
Else
    Checkmark = ""
End IF

If form.field1.value = "" Then                    ' Validate the form
    alert "Please enter an number!", "0", "Title"
ElseIf IsNumeric(form.field1.value) = False Then
    alert "Please enter a valid number!", "0", "Title"
ElseIf form.drop_down1.Value = "" Then
    alert "Please select a save location!", "0", "Title"
ElseIf form.field1.value < 100000 Then
    alert "Please enter a six digit number!", "0", "Title"
ElseIf form.field1.value > 999999 Then
    alert "Please enter a six digit number!", "0", "Title"
Else
    SaveData
End If

End Sub

Sub SaveData                    ' Write data to a text file
Set objFSO = CreateObject("Scripting.FileSystemObject")
If objFSO.FileExists(form.drop_down1.Value) Then
Set objFile = objFSO.OpenTextFile(form.drop_down1.Value, 8)
    strLine = form.field1.value & vbtab & Checkmark & vbtab & strSender  & vbtab & Now ' fields that will be written
    objFile.WriteLine strLine
    MsgBox "The Information was successfully written to the file.", "0", "Title"
    objFile.Close
Else
Set objFile = objFSO.CreateTextFile(form.drop_down1.Value) ' If file does not exist, create file
    strLine = form.field1.value & vbtab & Checkmark & vbtab & strSender  & vbtab & Now
    objFile.WriteLine strLine
    MsgBox "The Information was successfully written to the file.", "0", "Title"
    objFile.Close
End If
End Sub 
```

的HTML：

```
<form name="form">
<h2>Imput</h2>
<tr><td><lable>Data: </lable></td><td><input type="text" name="field1" size="25"></td>    </tr>
<tr><td><lable>Save Location: </lable></td><td><select name="drop_down1">
<option type="text" name="select" value="">Select an option</option>
<option type="text" value="SavePath1...">SavePath1</option>
<option type="text" value="SavePath2...">SavePath2</option>
<option type="text" value="SavePath3...">SavePath3</option>
</select></td><td><input type="checkbox" name="Flag" value="">Flag *</td></tr>
</table>
<input type="button" value="Submit" onClick="Validate">
<input type='reset' id='ResetFields' value='Clear Fields' />
</form> 
```

# sql - SQL - 将一个表外部连接到另外两个表

> ID：14356583
> 
> 赞同：0
> 
> 时间：2013-01-16T10:47:11.007
> 
> 标签：sql, database, join

我正在尝试将一个表外部连接到另外两个表上，并将它们都引用到连接的表中。例如：

```
table1 = order_header
table2 = order_line
table3 = inventory 
```

所以我需要获得特定的订单，所以我需要查看 order_header 和 order_line 并且还想检索可能不存在的库存记录（这是我认为外部加入的地方）。问题是，我可以查看库存是否存在的唯一方法是同时查看 order_header 和 order_line 以匹配库存。

```
order_header.location = inventory.location
order_line.product = inventory.product 
```

但是我可以外部加入引用 order_header 和 order_line 详细信息的库存吗？

抱歉解释不佳，但我们将不胜感激。

谢谢。

阿娇。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T11:01:11.003

试试这个 ：

```
SELECT * FROM order_header
INNER JOIN order_line ON order_header.header_id = order_line.header_id
LEFT OUTER JOIN inventory ON order_line.product = inventory.product AND order_header.location = inventory.location
WHERE order_header.header_id = xxx 
```

它之所以有效，是因为 order_header 和 order_line 之间的第一个内部连接可以被视为一个单独的表，所以你只需将连接留在那个 - 一种虚构的 - 表上

# ios - 关于图库中新图片的 iOS 本地通知

> ID：14356593
> 
> 赞同：1
> 
> 时间：2013-01-16T10:47:33.383
> 
> 标签：ios, push-notification, image-gallery

当在手机库存相机上拍摄新照片时，我想在我的应用程序图标上显示一个徽章。我如何注册这个活动？如果不可能，有没有办法告诉用户的 iCloud 何时添加新照片并通知用户打开应用程序？如果不能，我可以为用户安排一个活动（让我们说每小时一次）并运行一些代码来检查图片是否已添加到图库中 - 如果是，则显示一个徽章以便用户打开我的应用程序？

# windows-phone-7 - 有没有办法在 Phonegap 制作的 Windows Phone 应用程序中显示外部页面的 URL 栏？

> ID：14356596
> 
> 赞同：1
> 
> 时间：2013-01-16T10:47:41.630
> 
> 标签：windows-phone-7, cordova

我正在使用 JQuery 移动在 Phonegap 中为 windows phone 7、iOS 和 android 构建一个应用程序。该应用程序被 Microsoft 拒绝，因为当它链接到外部页面以捐赠给慈善机构时，当用户转到此外部页面以向用户显示正在使用 HTTPS 时，URL 栏不可见。有没有办法在外部页面中显示 URL 栏或强制链接在 Internet Explorer 中打开。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-17T09:09:25.043

你试过用

```
target="_blank" 
```

对于外部 ulr？或者，您可以使用 ChildBrowser 插件。

# c# - 授权角色和权限

> ID：14356597
> 
> 赞同：6
> 
> 时间：2013-01-16T10:47:47.657
> 
> 标签：c#, authorization, servicestack

我正在使用`ServiceStack`并已开始向我的服务添加基于角色的授权。从[文档](https://github.com/ServiceStack/ServiceStack/wiki/Authentication-and-authorization)中我可以看到有一些服务可以通过 Web 服务从用户中分配和删除角色。

我的问题是 ServiceStack 中是否包含任何内置服务来查询用户当前拥有的角色和权限？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-16T14:23:09.933

ServiceStack 中没有返回用户角色和权限的内置服务，但很容易创建自己的自定义服务来执行此操作，例如，您可以从会话中读取它，例如：

```
public class MyService : Service { 
    public object Get(UserRoles request) {
        var session = this.GetSession();
        return new UserRolesResponse {
            Roles = session.Roles,
            Permissions = session.Permissions,
        };
    }
} 
```

**有关返回所有**用户身份验证详细信息的管理服务示例，请参阅[SocialBoostrap UserAuths 服务](https://github.com/ServiceStack/SocialBootstrapApi/blob/master/src/SocialBootstrapApi/ServiceInterface/UserAuths.cs)。

# php - MYSQL PHP：我怎样才能找到总数。一行中的列数？

> ID：14356598
> 
> 赞同：0
> 
> 时间：2013-01-16T10:47:48.743
> 
> 标签：php, mysql, database, select

```
$result = mysql_query("select * from formtable") or die("Records could not be fetched");
    while($row=mysql_fetch_row($result))  
    { 
           echo $row[0].$row[1].$row[2];
    } 
```

上面的代码运行完美。但我发现这个陈述->`echo $row[0].$row[1].$row[2]`有点太静态了。因为如果添加新列，我将不得不将代码修改为`echo $row[0].$row[1].$row[2].$row[3]`.

那么，如何计算该行的总列数以避免此类问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T10:52:15.263

您可以使用 count($row) 来查找字段数。但最好使用前面建议的 foreach 循环。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T10:50:27.060

最好使用类似的东西： -

```
foreach($row AS $column)
{
echo $column;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-16T10:50:33.720

[mysql_num_fields()](http://php.net/manual/en/function.mysql-num-fields.php)是你要找的。

只是为了不让它不言而喻；`mysql_*`家庭功能已被弃用，对于您应该使用的新代码`mysqli`或`PDO`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-16T10:55:42.307

使用这样的东西不是更有意义吗：

```
echo implode($row); 
```

当有一个函数可以为您完成时，无需使用循环......

# asp.net - asp.net 分页，第一页显示记录，但第二页为空

> ID：14356605
> 
> 赞同：0
> 
> 时间：2013-01-16T10:48:10.477
> 
> 标签：asp.net, gridview, page-index-changed

我用过asp.net gridview 控件。在 gridview 中手动进行分页。但只有第一页显示记录。页面完全空白。谁能建议我需要为 PageIndex 事件修改什么以及在哪里修改？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T10:54:23.760

您需要更改网格的页面索引并将其绑定在[PageIndexChanged](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.datagrid.pageindexchanged.aspx)中。

```
void GridView1_PageIndexChanging(Object sender, GridViewPageEventArgs e)
{
  GridView1.CurrentPageIndex = e.NewPageIndex;
  YourFunctionToBindGrid();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-04-17T01:57:18.710

//解决了100%的工作

在 Page_index_Changing { GridView1.PageIndex = e.NewPageIndex; 中使用此代码 SqlCommand cmd = new SqlCommand("Select * from Requseted_movie ORDER BY [ID] DESC", con);

SqlDataAdapter DA1 = 新的 SqlDataAdapter(cmd); DA1.填充（DT1）；

```
 GridView1.DataSource = DT1;
    GridView1.DataBind(); 
```

}

# android - 三星 Galaxy Note 2 配置启用开发者模式

> ID：14356606
> 
> 赞同：0
> 
> 时间：2013-01-16T10:48:16.253
> 
> 标签：android

需要添加哪些行，才能`android_usb.inf`在开发者模式下使用三星 Galaxy Note 2？还需要进行哪些其他更改？

# php - .htaccess 小问题

> ID：14356607
> 
> 赞同：0
> 
> 时间：2013-01-16T10:48:18.250
> 
> 标签：php, .htaccess

我有一个重写规则。

```
RewriteRule   ^pages/(.+)$   info_pages.php?page_url=$1   [L] 
```

这之前运作良好。

我的网址是这样的，但在本地主机上

[http://dressgirls.com/demo2/pages/contact-us.html](http://dressgirls.com/demo2/pages/contact-us.html)

这指向

[http://dressgirls.com/demo2/info_pages.php](http://dressgirls.com/demo2/info_pages.php)

当我使用这个

```
echo $_GET['page_url']; 
```

它给了我。`contact-us.html/contact-us.html/contact-us.html`

它应该`contact-us.html`只给一次。

你知道这里有什么问题吗？

这是完整的代码

```
 <IfModule mod_rewrite.c>

 RewriteEngine On

 RewriteRule   ^pages/(.+)$   info_pages.php?page_url=$1   [L]
 RewriteRule   ^reviews/(.+)$   edit_review.php?review_id=$1   [L]
 RewriteRule   ^deals/(.+)$   category.php   [L]
 RewriteRule   ^city/(.+)$   location_deals.php   [L]

 #RewriteCond %{REQUEST_FILENAME} =-f
 #RewriteRule ^(.*)\.php$ $1.html [NC,L]
 #RewriteRule ^(.*)\.html$  $1.php [NC,L]

RewriteCond %{REQUEST_FILENAME} ^(.*)\.html$
RewriteCond %1.php -f
RewriteRule ^(.*)\.html$ $1.php [L,QSA]

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-l
RewriteRule ^(.*)$ deal-detail-page.php  [QSA,L]
</IfModule> 
```

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T11:04:13.740

将代码更改为：

```
RewriteBase  http://dressgirls.com/
RewriteRule   ^pages/(.+)$   info_pages.php?page_url=$1   [L] 
```

并尝试。

# asp.net-mvc - 转换表达式 > 到表达式 >

> ID：14356611
> 
> 赞同：2
> 
> 时间：2013-01-16T10:48:35.047
> 
> 标签：asp.net-mvc, linq, lambda, expression

真的很简单的问题。

我有一个 MVC 视图，它显示一个 Nullable Bool，例如，

```
Html.CheckBoxFor(model=>model.NullableBoolHere, Model.NullableBoolHere, 
```

我想创建一个新的 html 助手，它将接受这种类型，然后转换

```
Null || False => False
True => True 
```

所以我有以下

```
public static MvcHtmlString CheckBoxFor<TModel>(this HtmlHelper<TModel> htmlHelper, Expression<Func<TModel, bool?>> expression, object htmlAttributes, bool disabled)
    {
        IDictionary<string, object> values = new RouteValueDictionary(htmlAttributes);

        if (disabled)
            values.Add("disabled", "true");

        Expression<Func<TModel, bool>> boolExpression = CONVERT_TO_BOOL_HERE(expression);

        return htmlHelper.CheckBoxFor(expression, values);
    } 
```

任何帮助表示赞赏，我知道我将不得不使用递归来复制表达式，但只是不确定如何导航表达式本身，找到 bool？，转换为 bool。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T11:05:56.903

您可以使用以下代码：

```
var body = Expression.Coalesce(expression.Body, Expression.Constant(false));
var boolExpression = (Expression<Func<TModel, bool>>)
    Expression.Lambda(body, expression.Parameters.First()); 
```

其他答案的优点是它不编译第一个表达式，它只是包装它。生成的表达式类似于以下代码创建的表达式：

```
m => m.NullableBoolHere ?? false 
```

[现场检查](http://ideone.com/R5rrhi)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-12T10:43:23.773

所以，最后，我能找到的唯一方法就是解决布尔问题？自己进入一个布尔值，然后通过传入正确的名称等返回一个“正常”复选框。

不过，这确实是一种享受，所以一切都很好。如果您确实知道获得正确 ParameterName 的更好方法，那将是很高兴听到。

```
public static MvcHtmlString CheckBoxFor<TModel>(this HtmlHelper<TModel> htmlHelper, Expression<Func<TModel, bool?>> expression, object htmlAttributes, bool disabled)
    {
        IDictionary<string, object> values = new RouteValueDictionary(htmlAttributes);

        if (disabled)
            values.Add("disabled", "true");

        //Compile the expression to get the value from it.
        var compiled = expression.Compile().Invoke(htmlHelper.ViewData.Model);
        bool checkValue = compiled.HasValue ? compiled.Value : false; //evaluate the compiled expression

        //Get the name of the id we should use
        //var parameterName = ((MemberExpression)expression.Body).Member.Name; // only gives the last part
        string parameterName = expression.Body.ToString().Replace("model.", "");//.Replace(".", HtmlHelper.IdAttributeDotReplacement);

        //Return our 'hand made' checkbox
        return htmlHelper.CheckBox(parameterName, checkValue, values);
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T11:01:10.353

我想仅仅将表达式转换为另一种类型是不够的，MVC 使用表达式是有原因的，所以我怀疑它需要检查给定的表达式并对其应用一些魔法。

您可以创建一个执行转换的新表达式，如下所示：

```
 Expression<Func<TModel, bool>> boolExpression = 
        T => expression.Compile()(T).GetValueOrDefault(false); 
```

但正如我所说，我怀疑这还不够，MVC 可能想要检查表达式中的模型成员等。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-16T11:04:28.473

这个怎么样：

```
 Expression<Func<TModel, bool>> boolExpression = model =>
        {
             bool? result = expression.Compile()(model);

             return result.HasValue ? result.Value : false;
        }; 
```

这样你包装原始表达式，你可以从 bool? 布尔值。

它解决了你的问题吗？

# mongodb - 为什么 MongoDB 可尾游标记录为慢？

> ID：14356612
> 
> 赞同：1
> 
> 时间：2013-01-16T10:48:36.533
> 
> 标签：mongodb

我正在使用可尾光标读取跟踪集合（[http://docs.mongodb.org/manual/tutorial/create-tailable-cursor](http://docs.mongodb.org/manual/tutorial/create-tailable-cursor)）。这似乎工作正常，但我记录了以下慢查询：

```
Tue Jan 15 17:54:37 [conn28] getmore trace.traces query: { time: { $gte: new Date(1358254406370) } } cursorid:7095190436798608732 reslen:20 2268ms
Tue Jan 15 17:54:38 [conn28] getmore trace.traces query: { time: { $gte: new Date(1358254406370) } } cursorid:7095190436798608732 nreturned:1 reslen:513 315ms
Tue Jan 15 17:54:39 [conn28] getmore trace.traces query: { time: { $gte: new Date(1358254406370) } } cursorid:7095190436798608732 nreturned:2 reslen:1800 962ms
Tue Jan 15 17:54:41 [conn28] getmore trace.traces query: { time: { $gte: new Date(1358254406370) } } cursorid:7095190436798608732 reslen:20 2268ms
Tue Jan 15 17:54:43 [conn28] getmore trace.traces query: { time: { $gte: new Date(1358254406370) } } cursorid:7095190436798608732 reslen:20 2283ms 
```

该行每隔几秒钟就会被记录一次，即使根本没有写入集合。

我正在使用 Mongo 2.0.8（和 Java 驱动程序 2.10.1）。我也在 Mongo 2.2.2 上尝试过，但这里没有记录（即使使用 --profile 2），但是，我仍然在 system.profile 集合中看到它。

有谁知道为什么这个查询（报告为）慢？

这是个人资料信息：

```
> db.system.profile.find().limit(1).sort( { millis : -1 } ).pretty()
{
    "ts" : ISODate("2013-01-15T17:33:48.354Z"),
    "op" : "getmore",
    "ns" : "trace.traces",
    "query" : {
            "time" : {
                    "$gte" : ISODate("2013-01-15T12:56:57.589Z")
            }
    },
    "cursorid" : NumberLong("8205177764687670896"),
    "ntoreturn" : 0,
    "keyUpdates" : 0,
    "numYield" : 0,
    "lockStats" : {
            "timeLockedMicros" : {
                    "r" : NumberLong(30492),
                    "w" : NumberLong(0)
            },
            "timeAcquiringMicros" : {
                    "r" : NumberLong(22499),
                    "w" : NumberLong(3)
            }
    },
    "nreturned" : 0,
    "responseLength" : 20,
    "millis" : 2356,
    "client" : "127.0.0.1",
    "user" : ""
} 
```

以下是收集的统计数据：

```
> db.traces.stats()
{
    "ns" : "trace.traces",
    "count" : 41897,
    "size" : 51760464,
    "avgObjSize" : 1235.4217247058261,
    "storageSize" : 52432896,
    "numExtents" : 1,
    "nindexes" : 1,
    "lastExtentSize" : 52432896,
    "paddingFactor" : 1,
    "systemFlags" : 1,
    "userFlags" : 0,
    "totalIndexSize" : 1422624,
    "indexSizes" : {
            "_id_" : 1422624
    },
    "capped" : true,
    "max" : 2147483647,
    "ok" : 1
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T11:31:14.013

我认为当没有可用文档时，您的光标会阻止等待新文档。看到慢查询有所有`reslen:20`. 这对我来说似乎是一种正常的行为。

# salesforce - 如何在销售队伍电子邮件模板中使用 if 语句

> ID：14356620
> 
> 赞同：2
> 
> 时间：2013-01-16T10:49:00.367
> 
> 标签：salesforce, email-templates

我正在尝试将 if 语句添加到我的电子邮件模板（类型：HTML）。我使用了以下代码：

```
{!if(Lead.LastName="", "1", "2")} 
```

我的输出什么都不是：/

有人知道怎么做吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T11:11:43.267

我相信像条件渲染数据这样更复杂的逻辑在简单的电子邮件中是不可用的。`IF`, `BLANKVALUE`etc 功能不起作用，相反，`Dear {!Lead.LastName, 'Sir or Madam'}`如果字段为空，则类似于应该是后备方案的情况。

如果您不太害怕 - 改为制作一个 visualforce 电子邮件模板？

```
<messaging:emailTemplate subject="Hello StackOverflow" recipientType="User" relatedToType="Lead">
    <messaging:HtmlEmailBody >
        <p>Related To: {!relatedTo.Name}, {!relatedTo.LeadSource}</p>
        <p>Recipient: {!recipient.Username}</p>

        <p>{!IF(ISBLANK(relatedTo.LeadSource), '1', '2')}</p>
    </messaging:HtmlEmailBody>
</messaging:emailTemplate> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2022-02-17T11:44:24.180

请使用以下格式，然后它应该可以工作：

```
{!IF(Lead.LastName='','1','2')} 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-01-18T13:39:40.603

现在可以工作了。我只是稍微改变了格式，现在它可以工作了。很奇怪...

# java - jh.jar 和老孙签名

> ID：14356621
> 
> 赞同：0
> 
> 时间：2013-01-16T10:49:02.690
> 
> 标签：java, jar, digital-signature, java-web-start

我正在使用 JWS 应用程序。这个应用程序有一个用户手册，它使用 jh.jar 文件。jh.jar 中有 Sun 数字签名（有效期 2002-2003），因此应用程序启动后显示警告对话框（数字签名已过期）。删除 Sun 签名并使用 own 签名该文件是否合法，或者该文件是否有任何新更新（有效期为 2013-2014 签名）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T11:12:59.807

您应该尝试使用 jh.jar 的未签名（但最年轻）版本，例如[JavaHelp 2.0.05](http://mvnrepository.com/artifact/javax.help/javahelp/2.0.05)

# android - 将日期和时间添加到 Android 日历

> ID：14356625
> 
> 赞同：1
> 
> 时间：2013-01-16T10:49:15.117
> 
> 标签：android, calendar

我正在使用以下代码将此字符串转换为**2013 年 2 月 11 日星期一 08:00:00 CST至今**

```
Date date = null;
long starttime,endtime;
try {
    date = new SimpleDateFormat("EEE, dd MMM yyyy hh:mm:Ss z").parse(tit1);

} catch (java.text.ParseException e) {
    // TODO Auto-generated catch block
    e.printStackTrace();
} 
```

并使用以下代码将此日期添加到日历

```
try{
    Calendar cal = Calendar.getInstance();   
    starttime=date.getTime();
    endtime=date.getTime();
    Intent intent = new Intent(Intent.ACTION_EDIT);
    intent.setType("vnd.android.cursor.item/event");
    intent.putExtra("beginTime",starttime);
    intent.putExtra("allDay", true);
    intent.putExtra("rrule", "FREQ=YEARLY");
    intent.putExtra("endTime", endtime);
    intent.putExtra("title",tit);
}
catch(Exception e)
{
} 
```

事件正在添加，如 2013 年 2 月 11 日星期一。我需要添加事件，如下所示

```
From: Mon, 11 Feb 2013 08:00AM
To:   Mon, 11 Feb 2013 08:30AM 
```

如何使用以下字符串和简单日期格式样式来做到这一点。

**PS** :: starttime & endtime 是长数据类型

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T10:54:49.530

我认为获取日期格式有问题。请检查并执行以下操作

如果您按如下方式获取数据`Date = May 05, 2012, 07:10PM`，则将日期转换为数字格式 a May 为 05 并在以下代码中传递值。

```
Calendar beginCal = Calendar.getInstance();
beginCal.set(year, mnth, day, hrs, min);
startTime = beginCal.getTimeInMillis();

Calendar endCal = Calendar.getInstance();
endCal.set(year, mnth, day, hrs, min);
endTime = endCal.getTimeInMillis();     

Intent intent = new Intent(Intent.ACTION_INSERT);
intent.setType("vnd.android.cursor.item/event");
intent.putExtra(Events.TITLE, summary);
intent.putExtra(Events.DESCRIPTION, summary);
intent.putExtra(Events.EVENT_LOCATION, "");     
intent.putExtra(CalendarContract.EXTRA_EVENT_BEGIN_TIME, beginCal.getTimeInMillis());
intent.putExtra(CalendarContract.EXTRA_EVENT_END_TIME, endCal.getTimeInMillis());
intent.putExtra(Events.ALL_DAY, allDayFlag);
intent.putExtra(Events.STATUS, 1);
intent.putExtra(Events.VISIBLE, 0);
intent.putExtra(Events.HAS_ALARM, 1);
startActivity(intent); 
```

# qt - qt：Maya 视口上的透明 QWidget

> ID：14356627
> 
> 赞同：0
> 
> 时间：2013-01-16T10:49:21.883
> 
> 标签：qt, transparent, viewport, maya

![在此处输入图像描述](../Images/b415d0d8581b12084b66677c2c0d4b27.png)

我为玛雅制作了一个自定义窗口。它包含 Maya 的模型编辑器，因此我可以在自定义窗口上使用视口控件。所以我试图将 QLabel 作为 HUD 留在 modelEditor 上。但正如您所见，QLabel 不起作用，因为它是透明的。我希望让他们有他们的透明度。Maya openGL 处理不好（也许我认为）。我可以绕道这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T20:17:19.797

您可以尝试使用一些`QWidget`包含 a 的内容`QLabel`，然后您将可以访问有关小部件透明度的有用信息，例如：

```
setWindowOpacity(0.85);
setAttribute(Qt::WA_TranslucentBackground); 
```

您还可以尝试有关透明度的[样式表首选项。](http://doc.qt.digia.com/qt/stylesheet-examples.html)

我希望它会有所帮助！

# c++ - Rad Studio XE __property 设置方法不起作用

> ID：14356629
> 
> 赞同：0
> 
> 时间：2013-01-16T10:49:35.923
> 
> 标签：c++, properties, c++builder, rad

以下是头文件中的示例代码（缺少构造函数）：

```
class MyItem
{
   // blah blah
};

class MyClass
{
  public:
  __property MyItem Item = {read=GetItem, write=SetItem};

   private
   MyItem FItem;
   MyItem GetItem(void);
   void SetItem(const MyItem AItem);

} 
```

在 cpp 文件中：

```
void MyClass::SetItem(const MyItem AItem)
{
   FItem = AItem;    
} 
```

我已经排除了 get 方法，因为它工作正常。

由于某种原因，set 方法不起作用。

我肯定在某些测试代码中为属性分配了一个值。

如果我试图在 set 方法中放置一个断点，它不会放置它，因为代码已被优化，因为它从未被调用过。

如果我用字段变量本身替换 Set 方法，它会被写入正常。

我已经浏览了 XE 提供的所有文档。

我很困惑，我认为这可能是一个编译器错误。

如果我通过引用传递参数没有区别。

想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T19:31:51.583

睡了一会儿就解决了。

我从来没有真正设置类本身，我正在设置类的一个成员，所以它实际上是使用 get 方法然后调整返回的值。

将退货更改为参考退货解决了我的问题。

当我直接将属性分配给字段时它起作用的事实一定是因为编译器只是在编译时用字段替换属性名称。我的实际应用程序具有将根据类的状态设置的各种字段，因此为什么不能以这种方式保留它。

谢谢

# validation - 在 IIS 7.5 上编辑 Composite C1 中的输入参数？

> ID：14356630
> 
> 赞同：1
> 
> 时间：2013-01-16T10:49:41.257
> 
> 标签：validation, request, c1-cms

对不起我的英语不好

我在 iis 7.5 上安装 c1 有问题

**例如：**

**我想编辑输入参数：Function/XSLT Function/当你按下组合时 [默认值] 或 [测试值] 对话框不显示**

**控制台错误：** 加载资源失败：服务器响应状态为 404（未找到）

http://[域]/Composite/content/dialogs/functions/editFunctionCall.aspx?type=System.String&dialoglabel=Parameter+Default+Value&multimode=false&functionmarkup=%3Cf:function%20xmlns:f=%22http://www. Composite.net/ns/function/1.0%22%20name=%22Composite.Constant.String%22%20/%3E

**站点日志中的错误：**

HttpRequestValidationException

**url:** http://[domain]/rejected-by-urlscan?~/composite/content/dialogs/functions/editfunctioncall.aspx?type=system.string&dialoglabel=参数默认值&multimode=false&functionmarkup=

**文件路径：** System.Web.HttpRequest.ValidateString(String value, String collectionKey, RequestValidationSource requestCollection) at System.Web.HttpRequest.get_RawUrl() at Composite.Core.WebClient.WC

**错误：** 从客户端检测到具有潜在危险的 Request.RawUrl 值 (="...ionmarkup=

System.Web.HttpRequest.ValidateString（字符串值，字符串 collectionKey，RequestValidationSource requestCollection）在

System.Web.HttpRequest.get_RawUrl() 在 Composite.Core.WebClient.WCF.MultipleHostnameHandler.OnBeginRequest(Object sender, EventArgs e) 在

System.Web.HttpApplication.SyncEventExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() 在

System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously)

更改文件 web.config

validateRequest="false" requestValidationMode="2.0"

等...不成功:(

请帮助:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-25T08:56:46.260

由于某种原因，您使用的 Web 服务器正在转换查询字符串，例如：

...&功能标记=%3f:...

进入

...&functionmarkup=<f:...

这被 ASP.NET 认为是潜在的 XSS 攻击。

似乎没有办法通过配置文件改变行为。我们目前正在为 Composite C1 3.2 开发一个补丁来解决这个问题

# c++ - 定义创建另一个接口指针的ATL接口方法？

> ID：14356638
> 
> 赞同：-1
> 
> 时间：2013-01-16T10:50:11.350
> 
> 标签：c++, com, atl

我正在 ATL 中创建 Oracle 数据访问 com 库。存在一个名为 IConnection 的 COM 接口，它执行数据库连接。我想向 IConnection 添加名为 CreateCommand 的方法来创建 IOciCommand 类型的对象。IOciCommand 已经是同一个库中的一个接口。我需要 IDL 代码和 CreateCommand 的实现

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T12:37:18.683

我无法为您提供 CreateCommand 的确切实现，因为我不知道您的库的内部结构，但基本步骤是：

（1）在IDL接口中添加方法：

```
interface IConnection : IUnknown
{
    HRESULT CreateCommand([out] IOciCommand** ppCommand);
} 
```

(2) 编译IDL文件。

（3）在实现接口的C++类中添加方法实现：

```
virtual HRESULT STDMETHODCALLTYPE CreateCommand(IOciCommand** ppCommand)
{
    if (ppCommand == NULL)
        return E_POINTER;

    CComObject<COciCommand>* pCommand;
    HRESULT hr = CComObject<COciCommand>::CreateInstance(&pCommand);
    if (FAILED(hr))
        return hr;

    *ppCommand = pCommand;
    (*ppCommand)->AddRef();
    return S_OK;
} 
```

这就是实现的基本外观，但显然过于简化了。

# jboss - apache mod_cluster 中的 clError

> ID：14356640
> 
> 赞同：0
> 
> 时间：2013-01-16T10:50:17.387
> 
> 标签：jboss, load-balancing, apache

我无法访问 mod_cluster-manager，并且我在 apache 中的 error.log 中收到以下错误

```
[Wed Jan 16 17:20:13 2013] [warn] module proxy_module is already loaded, skipping 
[Wed Jan 16 17:20:13 2013] [notice] Advertise initialized for process 2410 
[Wed Jan 16 17:20:13 2013] [notice] Apache/2.2.17 (Ubuntu) mod_cluster/1.2.0.Final PHP/5.3.5-1ubuntu7.8 with Suhosin-Patch configured -- resuming normal operations 
[Wed Jan 16 17:27:22 2013] [error] proxy: CLUSTER: (balancer://mycluster). All workers are in error state 
[Wed Jan 16 17:27:23 2013] [warn] proxy: No protocol handler was valid for the URL /favicon.ico. If you are using a DSO version of mod_proxy, make sure the proxy submodules are included in the configuration using LoadModule. 
```

我配置了 jboss Standalone 模式来启用 mod_cluster。我在standalone-ha.xml 的各自部分中添加了以下几行

```
<extension module="org.jboss.as.modcluster"/>

<subsystem xmlns="urn:jboss:domain:modcluster:1.0">
            <mod-cluster-config advertise-socket="modcluster" advertise-security-key="secret"/>
        </subsystem> 
```

我下载了以下模块： mod_slotmem.so mod_manager.so mod_proxy_cluster.so mod_advertise.so

在[http://downloads.jboss.org/mod_cluster//1.1.0.Final/mod_cluster-1.1.0.Final-linux2-x64-so.tar.gz](http://downloads.jboss.org/mod_cluster//1.1.0.Final/mod_cluster-1.1.0.Final-linux2-x64-so.tar.gz)然后把它放在 usr/lib/apache2/modules 中。

我在 /etc/apache2/mods-available 的 mod_cluster.load 中设置了以下内容。

```
LoadModule proxy_module /usr/lib/apache2/modules/mod_proxy.so
LoadModule proxy_http_module /usr/lib/apache2/modules/mod_proxy_http.so
LoadModule proxy_ajp_module /usr/lib/apache2/modules/mod_proxy_ajp.so
LoadModule slotmem_module /usr/lib/apache2/modules/mod_slotmem.so
LoadModule manager_module /usr/lib/apache2/modules/mod_manager.so
LoadModule proxy_cluster_module /usr/lib/apache2/modules/mod_proxy_cluster.so
LoadModule advertise_module /usr/lib/apache2/modules/mod_advertise.so 
```

我在 mod_cluster.conf 中设置了以下内容

```
CreateBalancers 1
<IfModule manager_module>
    Listen 127.0.0.1:8082
    ManagerBalancerName mycluster

     <VirtualHost 127.0.0.1:8082>
        KeepAliveTimeout 300
        MaxKeepAliveRequests 0
        AdvertiseFrequency 5
        ServerAdvertise On
        <Location />
            Order deny,allow
            Allow from 127.0.0.1
        </Location>
     </VirtualHost>
  </IfModule> 
```

我通过执行 $ sudo a2enmod mod_cluster 启用模块

最后，我在 /etc/apache2/sites-available 的 jboss 中设置了以下内容

```
#NameVirtualHost *:80
<VirtualHost *:80>
    #ServerAdmin info@domain.de
    ServerName  comitdev2
    ServerAlias comitdev2
    ProxyPass / balancer://mycluster stickysession=JSESSIONID|jsessionid nofailover=On
    ProxyPassReverse / balancer://mycluster
    ProxyPreserveHost On
      <Location />
        Order deny,allow
        Allow from All
    </Location>

    <Location /mod_cluster-manager>
      SetHandler mod_cluster-manager
      Order deny,allow
      #Deny from all
      Allow from 127.0.0
   </Location>
  </VirtualHost> 
```

最后，我禁用了 000-default 站点并启用了 jboss 站点

每次我访问本地主机时，我都会得到服务暂时不可用。

我正在使用 Ubuntu 11.04

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T15:25:08.997

嗯，我可以在你的日志中看到 mod_cluster/1.2.0.Final，而你说你使用了 mod_cluster-1.1.0.Final-linux2-x64-so.tar.gz，怎么会？

为什么你使用 CreateBalancers 1 和 ProxyPass 而你没有在 ProxyPass 中做任何特别的事情？设置似乎是正确的。我建议尝试使用 CreateBalancers 1 运行并注释掉 ProxyPass 以缩小错误搜索空间:-)

无论如何，试试这个：

**mod_cluster.conf**

```
# MOD_CLUSTER_ADDS
<IfModule manager_module>
  Listen 127.0.0.1:8082 
  ManagerBalancerName mycluster

  <VirtualHost 127.0.0.1:8082>
    <Location />
     Order deny,allow
     Deny from all
     #Just for testing, of course...
     Allow from all
    </Location>

    KeepAliveTimeout 300
    MaxKeepAliveRequests 0
    AdvertiseFrequency 5
    #AdvertiseSecurityKey secret
    #This is important, see docs...
    EnableMCPMReceive

    <Location /mcm>
       SetHandler mod_cluster-manager
       Order deny,allow
       Deny from all
       #Just for testing, of course...
       Allow from all
    </Location>

  </VirtualHost>
</IfModule> 
```

**http.conf**

```
# This must be disabled for mod_cluster to work properly!
#LoadModule proxy_balancer_module modules/mod_proxy_balancer.so

# mod_cluster ifself
LoadModule slotmem_module modules/mod_slotmem.so
LoadModule manager_module modules/mod_manager.so
LoadModule proxy_cluster_module modules/mod_proxy_cluster.so
LoadModule advertise_module modules/mod_advertise.so 
```

**as7**

```
<subsystem xmlns="urn:jboss:domain:modcluster:1.1">
    <mod-cluster-config advertise-socket="modcluster" connector="ajp" />
</subsystem> 
```

**注意：**我有*urn:jboss:domain:modcluster:1.1*，您也应该使用更新的 AS7。Schema 1.0 已经过时了。

如果这个非常简单的设置对您有用，那么将您的 ProxyPass 添加回来，让我们看看它是否是您遇到麻烦的原因。

高温高压

# php - joomla中的自定义菜单参数

> ID：14356641
> 
> 赞同：0
> 
> 时间：2013-01-16T10:50:18.177
> 
> 标签：php, joomla

我有一个我似乎无法解决的要求，我已经尝试了好几天！

基本上我在我的文章中创建了额外的字段选项。但并非所有字段都希望在某些页面上显示。所以我希望能够选择在我的菜单参数中显示哪些字段。

例如。我创建了一个包含姓名、年龄、工作、爱好、经验的个人资料页面。

我可能想使用此配置文件两次，但每次都显示不同的字段。所以我然后创建一个菜单项，其中有一个字段列表，可以用一个复选框来选择。然后可以在文章前端查看所选字段。

这有意义吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T10:57:33.987

我猜你已经有一个显示这些参数的自定义视图。

很可能您想在视图的 .xml 文件中添加一些参数，最好在 com_content 中创建一个专用视图（从您已经创建的视图或文章开始）

然后，您需要修改视图代码以将参数考虑在内并显示相应的字段。

从您的菜单项配置中，一旦您选择了新视图，您现在应该会看到可用的配置参数。

如果您更详细地解释您到目前为止所做的事情，可能会更容易为您提供帮助。

# javascript - 检索更新 soundcloud div 元素的 innerhtml

> ID：14356646
> 
> 赞同：-1
> 
> 时间：2013-01-16T10:50:24.397
> 
> 标签：javascript, jquery, jquery-selectors, google-chrome-extension, soundcloud

我正在创建一个 Chrome 扩展程序，目前正在尝试在 Soundcloud 页面中检索计时器的状态。

使用 Firebug，我发现该元素是一个 div，并且有一个“timeIndicator__current”类。我尝试使用以下 jQuery 命令检索元素。

```
console.log($('.timeIndicator__current').html) 
```

作为回报，我得到了以下 javascript。

```
function (e){return v.access(this,function(e){var n=this[0]||{},r=0,i=this.length;if(e===t)return n.nodeType===1?n.innerHTML.replace(ht,""):t;if(typeof e=="string"&&!yt.test(e)&&(v.support.htmlSerialize||!wt.test(e))&&(v.support.leadingWhitespace||!pt.test(e))&&!Nt[(vt.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(dt,"<$1></$2>");try{for(;r<i;r++)n=this[r]||{},n.nodeType===1&&(v.cleanData(n.getElementsByTagName("*")),n.innerHTML=e);n=0}catch(s){}}n&&this.empty().append(e)},null,e,arguments.length)} 
```

我曾尝试使用 .text、.innerhtml 和 .val，但似乎都没有给我计时器的当前值，它们返回 javascript 或未定义。

我也尝试过使用 $(document).ready(function() 以及使用以下两个命令等到页面加载完毕，但没有找到解决方案。

```
$('.timeIndicator playing').find('.timeIndicator__current').html
$('.timeIndicator__total').clone()).html 
```

任何帮助深表感谢。

**更新：**根据要求，请在下面找到我的内容脚本

```
 "content_scripts": [
    {
        "matches": ["*://*.soundcloud.com/*"],
        "js": ["popup.js"]
    }], 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T10:51:28.780

更改`.html`为`.html()`

```
console.log($('.timeIndicator__current').html()) 
```

# ruby-on-rails - 在我们启用子域后，会话/Cookie 正在发挥作用

> ID：14356649
> 
> 赞同：1
> 
> 时间：2013-01-16T10:50:28.853
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我最近更改`config/initializers/session_store.rb`为支持子域。我添加了`domain: :all`部分，现在看起来像这样：

```
Foobar::Application.config.session_store :cookie_store, key: '_foobar_session', domain: :all 
```

但是，由于这告诉 Rails 以不同的方式处理会话，因此站点中其他用户的旧会话/cookie 无法登录。这有意义吗？如果是这样，你能解释为什么会这样吗？

我是否应该强制所有用户登录网站（这将为他们创建新的会话/cookie）？或者有没有更好的方法来重置已经激活的 cookie？

# ios - iOS 应用内购买 - 一些用户被双重收费

> ID：14356650
> 
> 赞同：1
> 
> 时间：2013-01-16T10:50:31.973
> 
> 标签：ios, in-app-purchase

我们最近收到了一些电子邮件，其中用户抱怨在应用程序购买中对消耗品收取双倍费用。我不知道，这怎么可能。此外，似乎只有少数用户遇到这种问题。但如果这样做，它会发生多次。我错过了什么吗？数量默认为 1，不是吗？您是否遇到过双重收费的问题？我发现很多用户抱怨在各种应用程序上被双重收费。这是 Apple/iTunes 的问题还是许多开发人员做错了什么？

这是交易的相关代码。我一次只允许一个事务，使用成员变量*transactionRunning*并检查 SKPaymentQueue 队列中有多少事务。

任何意见或经验将不胜感激。任何解决此问题的帮助将不胜感激。

```
- (void)purchaseProduct:(NSString*)productIdentifier
{
    NSArray * array = [SKPaymentQueue defaultQueue].transactions;
    if (transactionRunning == false && [array count] == 0)
    {
        transactionRunning = true;      
        SKPayment *payment = [SKPayment paymentWithProductIdentifier:productIdentifier];
        [[SKPaymentQueue defaultQueue] addPayment:payment];
    }
}

- (void)finishTransaction:(SKPaymentTransaction *)transaction wasSuccessful:(BOOL)wasSuccessful
{    
    transactionRunning = false;
    [[SKPaymentQueue defaultQueue] finishTransaction:transaction];
}

- (void)paymentQueue:(SKPaymentQueue *)queue updatedTransactions:(NSArray *)transactions
{
    for (SKPaymentTransaction *transaction in transactions)
    {        
        switch (transaction.transactionState)
        {
            case SKPaymentTransactionStatePurchasing:
                break;
            case SKPaymentTransactionStatePurchased:
                [self provideContent:transaction.originalTransaction.payment.productIdentifier];
                [self finishTransaction:transaction wasSuccessful:YES];
                break;
            case SKPaymentTransactionStateFailed:
                [self failedTransaction:transaction];
                break;
            case SKPaymentTransactionStateRestored:
                [self restoreTransaction:transaction];
                break;
            default:
                break;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-04T08:38:38.333

我有类似的问题，就我而言，问题不在代码中。

有一天，我看到很多退款。

问苹果，说是技术问题，现在问题解决了。退款是针对应用内费用的两倍。

没有其他信息....感谢您的考虑，Apple

# mongodb - 如何将 mongodb 字符集设置为 utf8？

> ID：14356652
> 
> 赞同：23
> 
> 时间：2013-01-16T10:50:34.443
> 
> 标签：mongodb, utf-8, character-encoding, export, database

我是 mongodb 的新手。我需要在我的数据库中以 utf8 编码存储一些数据。当我将它们导出或查看到控制台时，它们无法正确显示。我可以将我的数据库设置为 utf8 字符集来解决这个问题吗？如果是，我该怎么做？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-16T11:02:47.953

`BSON`只能编码在`UTF-8`. 如果您的问题与导出和控制台有关，您可能没有`UTF-8`在将数据上传到`mongodb`.

# java - 在java中使用证书

> ID：14356657
> 
> 赞同：0
> 
> 时间：2013-01-16T10:51:01.160
> 
> 标签：java, ssl, certificate

我一直在尝试几种解决方案来在我的肥皂客户端（身份验证）中使用受密码保护的 p12 证书。我无法让它工作。谁能指出我正确的方向。我最近的测试：

1.  `keytool -importkeystore -srckeystore mycert.p12 -destkeystore cert/cacerts -srcstoretype PKCS12 -deststoretype JKS -srcstorepass 123456789 -deststorepass changeit -srcalias 1 -destalias mycert`
2.  `System.setProperty("javax.net.ssl.trustStore","cert/cacerts"); System.setProperty("javax.net.debug", "ssl");`

结果：

致命的，描述 = certificate_unknown

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T11:46:09.240

您应该首先查看[keystore 和 truststore 之间的区别](https://stackoverflow.com/a/6341566/372643)。如果您想使用 PKCS#12 文件进行客户端身份验证，则需要将其用作密钥库。（如果默认 CA 不能信任服务器证书，您可能还需要设置信任库属性，但这是另一个问题。）

您根本不需要将 p12 文件转换为 JKS。

如果您的客户端使用系统属性来初始化其 SSL 上下文（检查其文档），您应该能够通过指向`javax.net.ssl.keyStore`它、设置和正确设置`javax.net.ssl.keyStoreType`来配置您的 p12 文件。在大多数情况下，应该在尝试任何 SSL 连接之前设置这些属性，因为它们只会被读取一次。`PKCS12``javax.net.ssl.keyStorePassword`

# maven - 如何从命令行获取属性值，如果不是来自环境，如果不是 - 默认值？

> ID：14356658
> 
> 赞同：3
> 
> 时间：2013-01-16T10:51:09.993
> 
> 标签：maven, maven-2

我想在我的 maven pom 文件中定义属性的默认值。但是，开发人员应该能够使用同名的环境变量覆盖它，如果在 mvn 的命令行上指定了相同的属性，则反过来应该覆盖它。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-18T05:45:05.930

我认为您能做的最好的事情是定义一个属性的默认值，如果在命令行上指定了相同的属性，则可以覆盖该默认值。

**此配置已在 maven 2.2.1 下测试。**

1.  在你的 pom 中定义你的属性：

    ```
    <properties>
             <finalname>dropbox</finalname>
    </properties> 
    ```

2.  在 pom 的某个地方使用它，例如

    ```
     <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-assembly-plugin</artifactId>
            <configuration>
                <archive>
                    <manifest>
                        <mainClass>com.dengjintian.uploader.Main</mainClass>
                    </manifest>
                </archive>
                <descriptorRefs>
                    <descriptorRef>jar-with-dependencies</descriptorRef>
                </descriptorRefs>
                <finalName>${finalname}</finalName>
                <appendAssemblyId>false</appendAssemblyId>
            </configuration>
            <!-- This will bind assembly:make-assembly to the package phase -->
            <executions>
                <execution>
                    <id>make-assembly</id>
                    <phase>package</phase>
                    <goals>
                        <goal>single</goal>
                    </goals>
                </execution>
            </executions>
        </plugin> 
    ```

3.  通过命令行覆盖它：

    ```
    mvn clean install  -Dfinalname=dropboxtmp 
    ```

# wcf - 在多个环境中测试 Web 服务

> ID：14356660
> 
> 赞同：2
> 
> 时间：2013-01-16T10:51:12.970
> 
> 标签：wcf, web-services, testing

我一直在使用 Visual Studio 开发一个应用程序，该应用程序在 WCF 中开发了 2 个不同的 Web 服务。我还在 Microsoft Test Project 中编写了许多功能测试方法，它们调用 Web 服务中的每个方法以确保它们按预期工作。

我面临的挑战是我应该如何在不同的阶段（开发机器、质量、登台和最后上线）测试 Web 服务，而不必为不同的环境复制相同的测试？

理想情况下，这样的解决方案应该更容易使用持续集成来自动化测试。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-06-15T15:56:53.327

它有两个部分

1) 对于每个服务，您必须在 app.config 文件中保存所有与环境相关的信息（URL、数据库连接字符串等）。例如，每个测试都应该从同一个应用配置文件中获取服务 URL。这样，当您需要在不同的环境中运行测试时，您所需要做的就是更改应用配置中的 URL 并运行测试。

2）对于持续集成，您将需要某种工具来编排它。您可以使用 Jenkins 将应用程序配置更新为部署的任何环境构建。

如果您需要有关如何操作的更多详细信息，请告诉我。

# spring - 开发SpringMVC web应用程序时是否需要将所有jsp文件保存在WEB-INF文件夹下

> ID：14356666
> 
> 赞同：0
> 
> 时间：2013-01-16T10:51:42.337
> 
> 标签：spring, spring-mvc

我正在学习 SpringMVC，但目前面临一个问题。我所有的 jsp 文件都在 /WEB-INF/jsp 文件夹下。在表单提交期间，如果注册成功，则尝试返回新页面 success.jsp，否则失败.jsp。我的问题是虽然消息正在显示，但 url 没有改变。它是否与表单请求期间相同。`http://localhost:8080/Twitter/User?new` 提交成功后，我希望它是`http://localhost:8080/Twitter/Success.jsp`. 当我将我的 jsp 文件夹放在 Web-inf 之外时，我能够实现这一点。有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T11:21:24.440

你不能通过从你的服务器重定向来做到这一点。它不是将您的 .jsp 文件放在任何文件夹下。显示的 url 是关于数据的来源。您不能通过转发或重定向或使用来更改它`ModelAndView`。

# jquery - Jqplot我如何定位pointLabel

> ID：14356667
> 
> 赞同：1
> 
> 时间：2013-01-16T10:51:42.943
> 
> 标签：jquery, jqplot

我想在网格中定位 pointLabel，并且 pointLabel 与条形图对齐，如下所示。

这是[链接](http://www.google.com/imgres?start=783&num=10&hl=ko&sa=X&tbo=d&biw=1920&bih=995&tbm=isch&tbnid=d39xBHyzhdj-EM%3a&imgrefurl=https://supportcontent.ca.com/cadocs/0/CA%2520Application%2520Performance%2520Management%2520as%2520a%2520Service%25201%25200-ENU/Bookshelf_Files/HTML/APM_Workstation_User_EN/1471468.html&docid=LjEMEkC8UxMwjM&imgurl=https://supportcontent.ca.com/cadocs/0/CA%252520Application%252520Performance%252520Management%252520as%252520a%252520Service%2525201%2525200-ENU/Bookshelf_Files/HTML/APM_Workstation_User_EN/1471257.gif&w=298&h=302&ei=6YT2UIPSBM2gigeV74DYAg&zoom=1&iact=hc&vpx=751&vpy=406&dur=2533&hovh=226&hovw=223&tx=117&ty=108&sig=106196492073145118541&page=13&tbnh=143&tbnw=137&ndsp=72&ved=1t:429,r:97,s:700,i:295)

但是 pointLabel 无法使用偏移量定位，因此在某些时候标签打印出网格。

如何将 pointLabel 对齐到左侧？

#chart2 .jqplot-point-label {

```
font-size:.68em;
color:#D4D0C8;
margin:0 0  0 auto;
//margin-left:25px;
//padding: 1px 3px;
background-color: #000000;
}
</style>

function drawBarChart(arr_val, count){

if( arr_val != '' && count != 0){       
        var result = arr_val.split("|");

        var dataBarChart1= new Array();
        var ticks = new Array();
        var dataOut = new Array();

        var temp=0;
        var secondArr = 0;

        for(var i=0; i < result.length; i++){
            if( i % count != 0){
                    temp += parseInt(result[i]);                
            }               
            if( i % count == 0 && count <= i) {
                ticks[secondArr] = result[i - count];
                dataBarChart1[secondArr] = temp;
                dataOut[secondArr] =  result[i - count] + "   " + temp;
                //alert(ticks[secondArr] );
                //alert(dataBarChart1[secondArr]);
                secondArr++;
            }
        }

    plot2 = jQuery.jqplot('chart2',  [dataBarChart1], {
        seriesDefaults: {
            renderer:jQuery.jqplot.BarRenderer,
            shadowAngle: 135,
            rendererOptions:{
                varyBarColor:true,
                barWidth: 3,
                barDirection: 'horizontal',
                showMarker: false

            },
            pointLabels: {  show: true, location:'s', labels:dataOut, ypadding:3, hideZeros:true, edgeTolerance: -30
            },

        },
        grid:{
            drawGridlines: true,
            background: '#000000',
            borderColor:'#D54206',
            drawBorder: true, 
            shadow: false,

            //borderWidth: 1.5,

        },      
         axes:{
            //show:false,
            //pid:0,
             axesDefaults: {

                },
                        yaxis:{
                         renderer: jQuery.jqplot.CategoryAxisRenderer,      
                         ticks:ticks,

                         rendererOptions: {  tickRenderer: jQuery.jqplot.AxisTickRenderer, 
                                        tickOptions: { showLabel:false, showMark: false,showGridline:false  },
                         },
                         borderColor:'#A3D0DB'
                        },
                        xaxis: {
                             ticks: [0,30],
                                tickOptions:{
                                         formatString:'%d',showGridline:true
                                    }, 
                            showTicks:false,
                          borderColor:'#A3D0DB'
                        },

                        x2axis: {
                            borderColor:'#000000' 
                        },
                        y2axis: {
                            borderColor:'#000000' 
                        },

            },

    });
  }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T09:07:44.803

我已经解决了！

只需编辑“jqplot.pointLabel.js”文件。

```
 var ell = xax.u2p(pd[i][0]) + p.xOffset(elem, location);

            //define someother location character yourself
            //and then just fix the ell which you want to locate position
            if( location == 'u'){
                ell = 13;   
            }

            var elt = yax.u2p(pd[i][1]) + p.yOffset(elem, location); 
```

# google-sheets - 谷歌表格：如何替换列标题中的文本？

> ID：14356670
> 
> 赞同：48
> 
> 时间：2013-01-16T10:51:54.273
> 
> 标签：google-sheets, google-drive-api, google-sheets-query

`=QUERY(B2:C9; "select (C * 100 / B) - 100")`我的Google 表格中有这样的查询。显示为列标题的是：

`difference(quotient(product(100.0()))100.0())`.

我想在那里放一个人类可读的描述。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2013-01-16T22:23:39.493

`=QUERY(B2:C9;"select (C*100/B)-100 label (C*100/B)-100 'Value'")`

[https://developers.google.com/chart/interactive/docs/querylanguage#Label](https://developers.google.com/chart/interactive/docs/querylanguage#Label)

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2019-07-03T22:39:31.760

请记住，那里有一个**技巧**。

**查询的工作**示例：

```
"SELECT C, COUNT(C), AVG(G), AVG(E) GROUP BY C ORDER BY COUNT(C) DESC LABEL COUNT(C) 'My count' FORMAT AVG(G) '##0.00', AVG(E) '##0.00'" 
```

**不工作**的查询示例：

```
"SELECT C, COUNT(C) LABEL COUNT(C) 'My count', AVG(G), AVG(E) GROUP BY C ORDER BY COUNT(C) DESC FORMAT AVG(G) '##0.00', AVG(E) '##0.00'" 
```

也不是查询的**工作**示例：

```
"SELECT C, COUNT(C), AVG(G), AVG(E) GROUP BY C ORDER BY COUNT(C) DESC FORMAT AVG(G) '##0.00', AVG(E) '##0.00' LABEL COUNT(C) 'My count'" 
```

仅当它与其他命令以正确的顺序放置时才有效。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2018-07-06T14:31:52.230

这是违反直觉的，但您必须定义重新标记的列**TWICE**；一次在“SQL”字符串中，然后将该`label`子句附加到 SQL 字符串的末尾。

所以，如果你想选择 A、B、C 并且“B”被标记为“Foo”，你可以这样做：

```
=QUERY(B2:C9;"select A, B, C   label B 'Foo' ") 
```

如果您在进行计算，请注意完全匹配 SQL 字符串定义和标签定义。例如：

```
=QUERY(B2:C9;"select A, B*2, C   label B*2 'Foo' ") 
```

[https://developers.google.com/chart/interactive/docs/querylanguage#Label](https://developers.google.com/chart/interactive/docs/querylanguage#Label)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2022-01-02T00:27:46.013

如果要重命名多个列，则使用一个 LABEL 关键字，然后使用逗号分隔字段及其新名称分配。

```
"select B, D, D*C where D <> 0 label D 'Staff', D*C 'Cost'" 
```

# eclipse - 在 Eclipse IDE 上使用 VBA

> ID：14356671
> 
> 赞同：3
> 
> 时间：2013-01-16T10:51:55.403
> 
> 标签：eclipse, vba, vb6

> **可能重复：**
> [有任何便宜或免费的 IDE 用于 VB6 编程吗？](https://stackoverflow.com/questions/1766514/any-cheap-or-free-ides-out-there-for-vb6-programming)

我们计划编写复杂的 VB6 项目。现在，当合法的 MS Visual Studio 6 稀缺时，在我们的组织中，我们需要寻找替代环境。VBA 的范例，即将所有代码嵌入到单个 xlsx/docx 文件中，不足以满足我们的目的。我们还需要某种错误跟踪。

我知道 Eclipse 和 VBA 只是两个独立的世界......但仍然存在某种集成吗？我特别在寻找：

*   开发在可管理的 .bas 和 .cls 文本文件中完成，而不是一个大的二进制容器。
*   某种调试功能。我不希望有什么能匹配 VB6，但至少某种形式的代码自动导入和导出到一些支持 VBA 的容器（如 .xlsx、docx）
*   VBA 语法高亮
*   某种 Intelli-Sense（代码完成）
*   与 EGit 和 Mylyn 集成

[我知道，我可以使用自定义宏](http://www.rondebruin.nl/vbaimportexport.htm)、Notepad++、TortoiseGit 等工具将某些东西粘合起来。但是 Eclipse 已经具备很多功能，而且我们仍然在我们的组织中使用它，所以人们不需要学习很多新东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-16T14:21:21.090

简短的回答是**不，它没有**。原因是 VB6 编译器是 VB6 的一部分，另一个 IDE 需要 VB6 许可证才能使用它（如果你有，那么你就有 VB6 IDE）或另一个编译器。此外，如果 Eclipse 支持 VB6，那么我希望通过快速的网络搜索来揭示这一点。

如果您主要关心的是具有 VB 代码功能的 IDE 的可用性，那么从长远来看，将您的 VB 移植到 VB.Net 将是您的最佳选择。

# jquery - 当屏幕宽度达到 500 像素时，如何更改此代码以进行切换？

> ID：14356672
> 
> 赞同：1
> 
> 时间：2013-01-16T10:51:57.727
> 
> 标签：jquery, screen

```
<script>
try {
    jQuery(function() {
        jQuery('#video1').VideoPlayer({
            theme: '-vid-skin'              
        });

        $("a.video-link, #video-overlay-shadow").bind("click", function() {
            $("#video-overlay-shadow, #ms-video-overlay").fadeToggle("slow", "linear");
            if($(".Vid-play-button").hasClass("Vid-paused-button")) $(".Vid-play-button").trigger("click");
        });
    });
} catch (e) {
    console.log(lel);
}

</script> 
```

如何修改这段代码，以便在屏幕宽度达到 500px 时触发？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T10:55:21.590

使用 jQuery 的`resize`事件。请参阅[文档](http://api.jquery.com/resize/)。

例如：

```
$(window).resize(
    function() {
        if ($(window).width() >= 500) {
            // Do something...
        }
    }
); 
```

当然，您应该考虑在初始触发后窗口变得比 500 像素更宽或更窄的可能情况。

* * *

如果您需要在窗口宽度超过 500 像素时只触发一次，您需要以某种方式检查它。例如，您可以使用该`data`方法指示窗口已经超过 500px：

```
$(window).resize(
    function() {
         // Window just went over 500 for the first time
        if ($(window).width() >= 500 && !$(window).data('already_over_500')) {
            $(window).data('already_over_500'); // Set a flag for the first time
            // Do something...

         // Window just went below 500
        } else if ($(window).width() < 500) {
            $(window).data('already_over_500',''); // Unset the flag
            // Do something else...
        }
    }
); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T10:57:08.903

尝试这个：

```
$(window).on('resize', function(){
  if($(window).width() >= 500){
    // your code
  }
}); 
```

# python - 如何在 Python 中使用 BeautifulSoup 清除元素的内容（元素 &|| 文本）？

> ID：14356673
> 
> 赞同：0
> 
> 时间：2013-01-16T10:52:00.333
> 
> 标签：python, python-2.7, beautifulsoup

有了一个元素，你如何用 BeautifulSoup 清空它？

例如，我有一个 div（如下图），我需要做什么来清除它的内容？

```
mydiv = soup.find("div", { "id" : "TopMostInfoBlockContent" })
mydiv.?? #Something here to clear the div contents? 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T10:59:34.990

使用[`.clear()`方法](http://www.crummy.com/software/BeautifulSoup/bs4/doc/#clear)：

```
mydiv.clear() 
```

# c++ - 初始化后修改引用所指的对象

> ID：14356682
> 
> 赞同：0
> 
> 时间：2013-01-16T10:52:30.753
> 
> 标签：c++, reference, move

我有以下代码

```
class A {
   A(int & r)
   : i(r)
   {}

   A(A&& obj)
   : i(obj.i)
   {}

   operator=(A&& obj)
   {
     // ?
   }

   int& i;
} 
```

并想象以下主要

```
int main()
{
   int r = 12;
   int r2 = 21;
   A a(r);
   A b(r2);

   b = std::move(a);
   r = 42;
   std::cout << "b.i value is " << b.i << std::endl;
} 
```

我想把它打印出来`b.i value is 42`。

简而言之，是否可以修改`i`以使其引用`obj.i`in `operator=()`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T11:11:35.927

简短的回答是否**。**

为了理解为什么答案是否定的，您需要了解真正的参考是什么。引用不是指针。事实上，引用甚至不是对象：它只是内存中另一个位置的别名。该标准实际上说引用不需要（不需要）有地址，因此它甚至不需要存在于内存中。如您所知，引用可能（在许多情况下）在编译时完全消失。

给定一个引用变量，您不能使用它来引用引用本身。对其名称的任何使用都将指代它所指的内存位置。这就是为什么您不能创建指向引用的指针的原因。也就是说，您不能获取引用的地址。这很好，因为如前所述，它甚至可能没有地址。

因此，鉴于它不一定在内存中占有一席之地，并且您不能引用它的值（只有它所引用的值），您不能更改引用本身的“值”。这就是为什么在 C++03 中尝试创建常量引用 ( `T& const`) 是错误的。*（然而，在 C++11 中，这是允许的，因为引用折叠，这在引入右值引用时是必需的）*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T10:56:48.700

Operator =在构造函数被调用*后被*调用，并且引用字段不能保持未初始化 - 您必须在类的构造函数中设置它们。所以答案是否定的。请改用指针或智能指针。

# clickonce - 在 ClickOnce 部署和独立包之间集成应用程序

> ID：14356683
> 
> 赞同：0
> 
> 时间：2013-01-16T10:52:31.110
> 
> 标签：clickonce

我现在面临一个非常大的问题。
我想为我的应用程序支持 2 种安装机制。

1.  建立一个安装文件。我可以安装在本地机器上。
    此应用程序仅在本地模式下工作。

2.  使用 ClickOnce 发布设置。

应该只允许其中一个存在于单台机器上

这表示：

*   如果我已经安装了 ClickOnce 版本，则不得允许我
    安装独立版本。（在这种情况下，应显示一个消息框）
*   如果我安装了独立包，ClickOnce 设置应该询问我是否要将独立版本升级到 ClickOnce 版本，在此过程中删除独立版本。

我已经考虑了很多个晚上，但我想不出解决它的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T11:08:33.167

以下信息可能对您有所帮助

1.  创建自定义 ClickOnce 安装程序： http: [//tinyurl.com/custominstaller](http://tinyurl.com/custominstaller)
2.  创建客户 ClickOnce 安装程序 (MSDN)：[http ://tinyurl.com/custominstallermsdn](http://tinyurl.com/custominstallermsdn)
3.  管理 ClickOnce 部署：http: [//msdn.microsoft.com/zh-cn/library/aa480721.aspx](http://msdn.microsoft.com/zh-cn/library/aa480721.aspx)

这些文章中解释的选项应该为您提供足够的信息来构建自定义安装程序，该安装程序将检查系统上的独立安装并采取适当的措施。

但是...通常 ClickOnce 应用程序不需要安装管理权限，而普通应用程序则需要。这意味着如果 ClickOnce 安装程序以普通用户身份运行，它可能没有足够的权限来检查计算机上安装了哪些应用程序。

独立应用程序和 ClickOnce 应用程序都可以访问用户的漫游配置文件目录，因此您可以在那里存储一些信息。('Environment.SpecialFolder.ApplicationData')

您的自定义 ClickOnce 安装程序可以检查该目录以找到已安装独立应用程序的指示，并且您的独立安装程序可以执行相同操作。

事实上，您的独立安装程序可能同时是 clickonce 安装程序。
您构建一个可以安装任一版本的自定义安装程序......为用户提供选项。

底线：构建客户安装程序

# python - python内存限制

> ID：14356689
> 
> 赞同：-1
> 
> 时间：2013-01-16T10:53:11.790
> 
> 标签：python, memory

我想生成以下列表：

```
L = list(itertools.product('...', repeat=8)) 
```

通话

```
itertools.product(...) 
```

生成大约 1'099'511'627'776 个长度为 8 的元素（我知道这是一个很大的数字），但我的系统有 12Gbit RAM，因此它应该不是问题，对吧？

每个过程是否有可能有限制？我检查过

```
ulimit -a 
```

和

```
max memory size 
```

设置为无限...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-16T10:55:47.140

1,099,511,627,776 * 8 是 8 TB。8 TB > 12 GB。

您可以考虑直接使用迭代器来处理它，而不是强制它全部被评估并存储在一个列表中。

当然，任何不平凡的处理 1 万亿个元素都可能需要很长时间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T11:02:59.967

一个接一个地处理数据应该不是问题，但收集它们可能是个问题。

如果你有

```
prod = itertools.product('...', repeat=8) 
```

你可以迭代这个对象

```
for item in prod:
    # process item and drop it afterwards 
```

这只会消耗所需的内存量。但随着

```
L = list(prod) 
```

所有对象都将被使用并放入列表中。这可能会很长...

# heroku - 如何在 Heroku 上设置 Postgres 的复制？

> ID：14356691
> 
> 赞同：3
> 
> 时间：2013-01-16T10:53:23.043
> 
> 标签：heroku

Heroku 上为 Postgres 设置数据复制的最佳实践是什么，以便如果我的主数据库所在的硬盘驱动器崩溃，则存在数据的副本？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-16T11:58:08.500

你想使用 Heroku 提供的 Postgres Follower 数据库——它是一个异步只读复制。

[https://devcenter.heroku.com/articles/heroku-postgres-follower-databases](https://devcenter.heroku.com/articles/heroku-postgres-follower-databases)

# sql - 这个查询是否相同？不存在和左外连接公式

> ID：14356693
> 
> 赞同：1
> 
> 时间：2013-01-16T10:53:30.193
> 
> 标签：sql, oracle, outer-join, not-exists

我想获取 ENI_MONITOR 的每条记录，它是孤儿。在 ENI_FLUSSI_HUB 中对应的记录不应该存在。这两个公式都正确吗？左外连接是怎么想的？

```
SELECT /*+ PARALLEL (mon, 10) */
       COUNT(1)
FROM   B
WHERE  B.mon_flag_ann = 'N'
       AND NOT EXISTS
           (
               SELECT /*+  PARALLEL (c, 10)  */
                      1
               FROM   A
               WHERE  B.MON_ID_MESSAGGIO = A.flh_id_messaggio
                      AND B.MON_COD_TP_PROCESSO = A.flh_tipo_processo_cod
                      AND A.FLH_FLAG_ANN = 'N'
           );

SELECT /*+ PARALLEL (mon, 10) parallel (c 10) */
       COUNT(DISTINCT MON_MONITORAGGIO_ID)
FROM   B,
       A
WHERE  B.mon_flag_ann = 'N'
       AND B.MON_ID_MESSAGGIO = A.flh_id_messaggio(+)
       AND B.MON_COD_TP_PROCESSO = A.flh_tipo_processo_cod(+)
       AND A.FLH_FLAG_ANN(+) = 'N'
       AND A.flh_id_messaggio(+) IS NULL 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T11:22:54.217

两者在功能上是等效的，除非代码为 NULL。SQL 是一种*描述性*语言，而不是一种*过程*语言。语法描述了结果集，而不是（必然）如何完成处理。

这里有多种方法可以编写这样的查询（包括一个`not in`版本）。查询的执行方式取决于引擎选择的路径。 [这里](http://www.csee.umbc.edu/portal/help/oracle8/server.815/a67781/c20c_joi.htm)有一些选项。如果你用谷歌搜索，有更多关于不同查询公式的具体性能时间的例子。

第二种结构不是编写外连接查询的好方法。这是首选语法：

```
SELECT /*+ PARALLEL (mon, 10) parallel (c 10) */
       COUNT(DISTINCT MON_MONITORAGGIO_ID)
FROM   B left outer join
       A
       on B.MON_ID_MESSAGGIO = A.flh_id_messaggio and
          B.MON_COD_TP_PROCESSO = A.flh_tipo_processo_cod and
          A.FLH_FLAG_ANN = 'N'
WHERE  B.mon_flag_ann = 'N' and
       A.flh_id_messaggio IS NULL 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T12:39:34.593

它们是不同的，但正如 Gordon Linoff 所展示的，当转换为 ASNSI 连接语法时，更容易理解为什么。在这种形式下，您的第二个查询变为：

```
SELECT /*+ PARALLEL (mon, 10) parallel (c 10) */
       COUNT(DISTINCT MON_MONITORAGGIO_ID)
FROM   B
LEFT JOIN A
    ON A.flh_id_messaggio = B.MON_ID_MESSAGGIO
    AND A.flh_tipo_processo_cod = B.MON_COD_TP_PROCESSO
    AND A.FLH_FLAG_ANN = 'N'
    AND A.flh_id_messaggio IS NULL
WHERE  B.mon_flag_ann = 'N' 
```

外连接条件包括`A.flh_id_messaggio = B.MON_ID_MESSAGGIO` **和** `A.flh_id_messaggio IS NULL`，但不能同时为真。（即使`B.MON_ID_MESSAGGIO`为空，这也会失败，因为您不能`=`用来比较空值）。因此，外连接永远找不到匹配项，不妨省略，因此您将`MON_MONITORAGGIO_ID`计算`B`.

但是，如果您将`IS NULL`检查移至`WHERE`子句（如 Gordon 所做的那样）：

```
SELECT /*+ PARALLEL (mon, 10) parallel (c 10) */
       COUNT(DISTINCT MON_MONITORAGGIO_ID)
FROM   B
LEFT JOIN A
    ON A.flh_id_messaggio = B.MON_ID_MESSAGGIO
    AND A.flh_tipo_processo_cod = B.MON_COD_TP_PROCESSO
    AND A.FLH_FLAG_ANN = 'N'
WHERE  B.mon_flag_ann = 'N'
    AND A.flh_id_messaggio IS NULL 
```

... then 外连接条件可以找到匹配项。如果找不到匹配项，则在`WHERE`评估子句时，`A.flh_id_messaggio`现在确实会是`null`，所以这就像您原来的`NOT EXISTS`.

还有一个假设是 MON_MONITORAGGIO_ID 是唯一的，很可能就是这种情况。但是由于您仅在没有匹配项时才计数，因此我认为您不需要`DISTINCT`.

# mysql - mysql函数调用

> ID：14356694
> 
> 赞同：5
> 
> 时间：2013-01-16T10:53:53.590
> 
> 标签：mysql, stored-functions

如果我多次调用一个函数，那么它是每次都执行还是只执行一次，然后在几次之后使用该值？例子：

```
 select my_function('filed'),my_function('filed')/field2, 
        (my_function('filed')*field1)/field3,
...... from my_table    where group by filed1; 
```

我的问题是 `my_function('filed')`将执行一次，然后将结果用于`my_function('filed')/field2`和`(my_function('filed')*field1)/field3`或每次`my_function('filed')`将在系统级别调用和执行？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-03-13T02:16:47.880

为什么不使用捕获函数值的变量。例如：

```
declare var_function (datatype(size)); // just to declare proper data type for your function

set var_function = my_function('filed');

select var_function, var_function/field2, 
        (var_function*field1)/field3,

....from my_table    where group by filed1; 
```

在这种情况下，您将重用函数结果，而无需重复函数的过程。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-16T11:02:34.413

如果您将函数声明为[`DETERMINISTIC`](http://dev.mysql.com/doc/refman/5.0/en/create-procedure.html). 但它确实应该是确定性的：

> 如果一个例程对于相同的输入参数总是产生相同的结果，则该例程被认为是“确定性的”，否则被认为是“非确定性的”。如果例程定义中既没有给出 DETERMINISTIC 也没有给出 NOT DETERMINISTIC，则默认为 NOT DETERMINISTIC。要声明函数是确定性的，您必须明确指定 DETERMINISTIC。
> 
> 对例程性质的评估基于创建者的“诚实”：MySQL 不检查声明为 DETERMINISTIC 的例程是否没有产生不确定结果的语句。但是，错误地声明例程可能会影响结果或影响性能。将非确定性例程声明为 DETERMINISTIC 可能会导致优化器做出不正确的执行计划选择，从而导致意外结果。将确定性例程声明为 NONDETERMINISTIC 可能会导致不使用可用的优化，从而降低性能。在 MySQL 5.0.44 之前，DETERMINISTIC 特性被接受，但不被优化器使用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-16T10:58:10.047

据我所知（不是 mysql pro）它每次都调用这个函数。你的解释计划应该表明这个问题。

如果您总是使用相同的参数调用该函数，请通过子查询每行查询一次。

```
select funcvalue, funcvalue/field2, (funcvalue*field1)/field3,...... 
from SELECT( my_function('filed') funcvalue, ... your other columns... 
FROM TABLE )
where group by filed1; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-05-16T01:14:19.560

运行 MySQL 函数非常简单。

使用命令登录到 MySQL 命令提示符：

```
$> mysql -u root -p 
```

然后使用数据库：

```
mysql> use database_name 
```

然后使用以下命令运行 MySQL 函数：

```
mysql> delimiter //

mysql> CREATE PROCEDURE simpleproc (OUT param1 INT)
    -> BEGIN
    ->   SELECT COUNT(*) INTO param1 FROM t;
    -> END//
Query OK, 0 rows affected (0.00 sec)

mysql> delimiter ;

mysql> CALL simpleproc(@a);
Query OK, 0 rows affected (0.00 sec) 
```

我们可以在上面的示例中添加任何多行函数，而不是过程。

# youtube-api - 适用于移动设备的 YouTube iframe API 问题

> ID：14356698
> 
> 赞同：0
> 
> 时间：2013-01-16T10:54:13.370
> 
> 标签：youtube-api

我正在为我的 YouTube 频道中的播放列表开发一个自定义 YouTube 播放器，并遇到了 YouTube Iframe API。

我已经成功实现了一个在桌面上工作的播放器，但是它给在移动设备上工作带来了一些挑战。根据文档，如果您打算在手机上显示 YouTube 视频，则 Iframe API 是正确的选择，因为它可以检测 HTML5 视频支持，但是当我尝试我的代码甚至文档中的演示代码时，如下所示

[https://developers.google.com/youtube/iframe_api_reference#Getting_Started](https://developers.google.com/youtube/iframe_api_reference#Getting_Started)

视频的图像加载到移动浏览器中，但是当我去播放它时，我只是通过 IOS 设备上的播放按钮得到一个灰色的 Quicktime 图像，并在 Android 上回退到 flash。

我尝试将 ?html5=1 添加到 iframe url 的末尾以强制 HTML 5 模式，并且还选择了 Youtube 在桌面和每个移动浏览器上的 HTML5 试用，但对结果没有影响。

在桌面加载页面时它确实以 HTML5 模式加载，那么为什么不在移动设备中加载呢？

任何帮助，将不胜感激

谢谢

Ĵ

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T14:41:06.730

您需要有一个 YouTube 授权的“品牌频道”（启用自定义标签），然后您必须请求一个自定义小工具，该小工具显示可用于移动网络版 Youtube 的移动小工具。这在适用于 iOS 的 Youtube 应用程序中不起作用。

# ruby-on-rails-3 - rails 3.2 流数据

> ID：14356704
> 
> 赞同：1
> 
> 时间：2013-01-16T10:54:30.090
> 
> 标签：ruby-on-rails-3

显然，带有 proc 的 render :text 方法在 rails 3.2 中不再可用以流式传输数据。我按照以下说明进行操作

[讨论](https://stackoverflow.com/questions/3507594/ruby-on-rails-3-streaming-data-through-rails-to-client)

并尝试使用迭代器流式传输数据

```
class Streamer
attr_reader :url,:uri
def initialize(url)
  puts "there"
  @url = url
  @uri = URI.parse url
end
def each
  Net::HTTP.start(uri.host) do |http|
    resp = http.get(uri.path) do |str|
      puts  str
    end
  end
end
end 
```

这会将流式数据打印到控制台，但最终目标是流式传输到客户端，所以我将其更改为

```
 resp = http.get(uri.path) do |str|
      yield  str
 end 
```

此代码不起作用。该请求只是没有回复任何内容。我在 webrock 上运行。因此，这种方法可能根本不适用于 webrick，或者代码有什么问题。

帮助表示赞赏。问候，菲尔

# ruby - ruby 哈希中的填充/默认值

> ID：14356706
> 
> 赞同：-1
> 
> 时间：2013-01-16T10:54:31.603
> 
> 标签：ruby, arrays

我从一个 Hash 中得到了这个结果，它在我的 Javascript 中工作得很好。除了一件事，它只发生在某些人身上。结果如下：

```
[[500,400,300], [650,300], [500,400,300]] 
```

您可以在第二个成员中看到该数组只有 2 个成员。我怎样才能把它填出来，所以任何缺失的成员都是 0。这样就可以了。

```
[[500,400,300], [650,300,0], [500,400,300]] 
```

我试过使用默认方法，但它不起作用。

我通过使用以下代码获取此哈希：

```
data = Hash.new { |hash, key| hash[key] = [] } 
```

简而言之，我希望所有数组都是偶数，并放置一个 0 以使它们均匀。多年来一直在研究这个。有人有想法么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T11:03:40.713

你可以使用这样的东西：

```
def addpadding(data, length)
  data.each do |subarray|
    subarray.fill(0, subarray.length...length)
  end
end 
```

您需要向该方法提供二维数组和所需的`length`（例如 3），它会将子数组填充到给定的长度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T11:02:18.130

以下代码有效

```
a = [[500,400,300], [650,300], [500,400,300]].each {|e| e << 0 if e.count < 3}
#=> [[500, 400, 300], [650, 300, 0], [500, 400, 300]] 
```

# arduino - 如何在 Arduino 草图中使用库 Ethernet2？

> ID：14356707
> 
> 赞同：2
> 
> 时间：2013-01-16T10:54:40.100
> 
> 标签：arduino

我遇到了与 Stack Overflow 问题*[Arduino (Uno) Ethernet client connection failed after many client prints](https://stackoverflow.com/questions/7432309/arduino-uno-ethernet-client-connection-fails-after-many-client-prints/7499843#7499843)*中相同的问题。

这个问题的解决方案是使用库[Ethernet2](http://code.google.com/p/tinkerit/source/browse/#svn/trunk/Ethernet2%20library/Ethernet2)。我下载了这个库并将文件夹“Ethernet2”放在文件夹“libraries”中。当我尝试在[草图](http://www.arduino.cc/en/Tutorial/Sketch)中使用 Arduino 1.0.1 时，它会产生错误。

草图：

```
/*
 * Echo Server
 *
 * Echoes back the headers of the web request.  Good for
 * learning how the HTTP protocol works.
 */

#include <Ethernet2.h>

byte mac[] = { 0xDE, 0xAD, 0xBE, 0xEF, 0xFE, 0xED };
byte ip[] = { 10, 0, 0, 177 };

Server server(80);

void setup()
{
    Client client(255);
    Ethernet.begin(mac, ip);
    Serial.begin(9600);
    server.begin();
}

void loop()
{
    char buf[512];
    int i = 0;
    Client client = server.available();
    if (client) {
        boolean previous_is_newline = false;
        while (client.connected()) {
            if (client.available()) {
                char c = client.read();
                if (c == '\n' && previous_is_newline) {
                    buf[i] = 0;
                    client.println("HTTP/1.1 200 OK");
                    client.println("Content-Type: text/html");
                    client.println();
                    client.println("<pre>");
                    client.println(buf);
                    client.println("</pre>");
                    break;
                }
                if (i < 511)
                    buf[i++] = c;
                if (c == '\n')
                    previous_is_newline = true;
                else if (c != '\r')
                    previous_is_newline = false;
            }
        }
        client.stop();
    }
} 
```

错误：

```
In file included from C:\Documents and Settings\Admin\Рабочий стол\!!! Arduino\arduino-1.0.1\hardware\arduino\cores\arduino/Arduino.h:193,
                 from Test_Ethernet2_echo.cpp:10:
C:\Documents and Settings\Admin\Рабочий стол\!!! Arduino\arduino-1.0.1\hardware\arduino\cores\arduino/HardwareSerial.h:58: error: conflicting return type specified for 'virtual size_t HardwareSerial::write(uint8_t)'
C:\Documents and Settings\Admin\Рабочий стол\!!! Arduino\arduino-1.0.1\libraries\Ethernet2/Print.h:36: error:   overriding 'virtual void Print::write(uint8_t)' 
```

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2020-03-22T10:45:28.127

从 Arduino IDE 1.5 开始，您可以使用库管​​理器来安装库 - 这个问题应该不会再发生了

# ios - 图像方向 - iOS 元数据

> ID：14356710
> 
> 赞同：1
> 
> 时间：2013-01-16T10:54:45.227
> 
> 标签：ios, gps, metadata

我正在尝试将 GPS 元数据添加到图像中。我参考了此链接以了解如何设置其他键值。但我无法找到如何获得“图像方向”，即键的值`kCGImagePropertyGPSImgDirection`和`kCGImagePropertyGPSImgDirectionRef`. 我不知道“图像方向”是什么意思，也不知道从哪里获得价值。位置管理器的`location`属性没有任何此类属性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-23T20:17:29.913

尝试使用`CGImageSourceRef`and`CGImageSourceCopyPropertiesAtIndex(...)`获取 GPS 数据，它返回 Image Direction 和 Image Direction Ref。它们是 Cocoa/Cocoa.h 的一部分。

您也可以下载 Apple 的 ImageApp 示例以了解它的使用方式。

# java - 解释 Scanner close() 方法 Java

> ID：14356715
> 
> 赞同：0
> 
> 时间：2013-01-16T10:54:57.887
> 
> 标签：java, io, java.util.scanner

当我需要关闭`Scanner`方法`close()`时，我有如下代码，谁能解释我为什么需要检查`if(input != null`）好吗？

```
Scanner input = new Scanner(new File("System.txt"));

...

Public void closeFile() {
   if(input != null) {
          input.close();
   }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T10:56:31.977

> 谁能解释一下为什么我需要检查 if(input != null) 吗？

它只是一个`null check`如果输入为 null 它会抛出**NullPointerException**。

考虑下面的代码：

```
 Scanner input = new Scanner(new File("System.txt"));
    public void someMethod(){
      input = doSomething(); //say doSomething() returns null
    }
    Public void closeFile()
   {
   if(input != null)
      input.close();
    } 
```

现在，由于输入为空，如果您尝试调用 close() 它会抛出 NPE>

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T10:56:10.740

可以在*其他地方*`input`设置为 null吗？我注意到分配不是，因此可以重新分配（给予适当的访问权限）*`final`*

# objective-c - Restkit - 只有子 ID 的映射

> ID：14356718
> 
> 赞同：2
> 
> 时间：2013-01-16T10:55:08.860
> 
> 标签：objective-c, restkit

我正在尝试在我的 iOS 应用程序中使用 RestKit 0.20 将 json 映射到核心数据对象。我有两种类型的对象：用户和消息。用户有很多消息。消息具有指向用户的字段：'from' 和 'to'。这是我的消息 json：

```
[
    {
        "created_at":1358265482867,
        "to":"50ed7b4e63e9b80200000009",
        "note":"Hello",
        "from":"50ee98365315d00200000003",
        "_id":"50f57cee11f2b00200000016",
        "__v":0
    },
    {
        "created_at":1358265582867,
        "to":"50ed7b4e63e9b80200000009",
        "note":"Hello 2",
        "from":"50ee98365315d00200000003",
        "_id":"50f57cee11f2b00200000016",
        "__v":0
    }
] 
```

我的映射代码如下所示：

```
// Object mappings
RKEntityMapping *userMapping = [RKEntityMapping mappingForEntityForName:@"User" inManagedObjectStore:managedObjectStore];
userMapping.identificationAttributes = @[@"userId"];
[userMapping addAttributeMappingsFromDictionary:@{
     @"_id": @"userId",
     @"name": @"name",
     @"note": @"headline",
     @"photo_url": @"photoUrl"
 }];

RKEntityMapping *messageMapping = [RKEntityMapping mappingForEntityForName:@"Message" inManagedObjectStore:managedObjectStore];
messageMapping.identificationAttributes = @[@"messageId"];
[messageMapping addAttributeMappingsFromDictionary:@{
     @"_id": @"messageId",
     @"note": @"note",
     @"created_at": @"createdAt",
     @"from": @"from",
     @"to" : @"to"
 }];

// !!! This code is ok if json contains entire object (but contains only id).
// [messageMapping addPropertyMapping:[RKRelationshipMapping relationshipMappingFromKeyPath:@"from" toKeyPath:@"from" withMapping:userMapping]];
// [messageMapping addPropertyMapping:[RKRelationshipMapping relationshipMappingFromKeyPath:@"to" toKeyPath:@"to" withMapping:userMapping]];

RKEntityMapping *messageReversedMapping = [messageMapping inverseMapping];
RKRequestDescriptor *requestDescription = [RKRequestDescriptor requestDescriptorWithMapping:messageReversedMapping objectClass:[Message class] rootKeyPath:nil];
[objectManager addRequestDescriptor:requestDescription];

RKResponseDescriptor *userResponseDescriptor = [RKResponseDescriptor responseDescriptorWithMapping:userMapping pathPattern:@"/users" keyPath:nil statusCodes:RKStatusCodeIndexSetForClass(RKStatusCodeClassSuccessful)];
[objectManager addResponseDescriptor:userResponseDescriptor];

RKResponseDescriptor *messageResponseDescriptor = [RKResponseDescriptor responseDescriptorWithMapping:messageMapping pathPattern:@"/messages" keyPath:nil statusCodes:RKStatusCodeIndexSetForClass(RKStatusCodeClassSuccessful)];
[objectManager addResponseDescriptor:messageResponseDescriptor]; 
```

型号代码：

```
@interface Message : NSManagedObject

@property (nonatomic, retain) NSString * note;
@property (nonatomic, retain) NSNumber * createdAt;
@property (nonatomic, retain) NSString * messageId;
@property (nonatomic, retain) User *from;
@property (nonatomic, retain) User *to;

@interface User : NSManagedObject

@property (nonatomic, retain) NSString * email;
@property (nonatomic, retain) NSString * headline;
@property (nonatomic, retain) NSString * lastName;
@property (nonatomic, retain) NSNumber * me;
@property (nonatomic, retain) NSString * name;
@property (nonatomic, retain) NSString * photoUrl;
@property (nonatomic, retain) NSString * userId;
@property (nonatomic, retain) Message *messagesFrom;
@property (nonatomic, retain) Message *messagesTo; 
```

问题是在 json 中，字段“to”和“from”是用户的 id 而不是嵌套对象，因此应用程序崩溃。

我发现了类似的 SO 问题，但仍然无法正常工作。

[使用 Objective-C 在 Xcode 中使用 RestKit 映射嵌套 ID](https://stackoverflow.com/questions/14260806/mapping-nested-ids-with-restkit-in-xcode-using-objective-c)

[通过 ID 数组映射 RestKit 中的关系不起作用](https://stackoverflow.com/questions/13054112/mapping-relationships-in-restkit-through-an-array-of-ids-doesnt-work)

谁能帮我正确设置映射，所以 json 将只包含用户的 ID 而不是嵌套对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T09:31:23.720

好的，我想通了。API 文档给出了如何映射这种关系的示例： [http ://restkit.org/api/latest/Classes/RKConnectionDescription.html](http://restkit.org/api/latest/Classes/RKConnectionDescription.html)

我仍然需要将字段'from'和'to'映射到虚拟'fromUserId'和'toUserId'，但它可以工作。

这段代码对我有用：

```
NSManagedObjectContext *context = ApplicationDelegate.managedObjectContext;
NSEntityDescription *messageEntity = [NSEntityDescription entityForName:@"Message" inManagedObjectContext:context];
NSRelationshipDescription *userRelationshipFrom = [messageEntity relationshipsByName][@"from"];
RKConnectionDescription *connectionUserMessageFrom = [[RKConnectionDescription alloc] initWithRelationship:userRelationshipFrom attributes:@{ @"fromUserId": @"userId" }];
[messageMapping addConnection:connectionUserMessageFrom];

NSRelationshipDescription *userRelationshipTo = [messageEntity relationshipsByName][@"to"];
RKConnectionDescription *connectionUserMessageTo = [[RKConnectionDescription alloc] initWithRelationship:userRelationshipTo attributes:@{ @"toUserId": @"userId" }];
[messageMapping addConnection:connectionUserMessageTo]; 
```

# html - 在中心垂直和水平对齐 DIV，不重叠页眉和页脚

> ID：14356719
> 
> 赞同：1
> 
> 时间：2013-01-16T10:55:09.810
> 
> 标签：html, css, alignment

这是我在 stackoverflow 上的第一篇文章（对我来说轻松一点）这可能是一篇冗长的、过度解释的文章。请原谅我，我从来都不擅长轻松地表达我的话。

基本上，我的页面包含 5 个 div...

*   `#wrap`- 包含所有其他元素
*   `#header`- 标题
*   `#main`- 这包含#imgcont div
*   `#imgcont`- 这包含一个图像
*   `#footer`- 页脚

现在，`#footer`即使调整大小，我也被锁定在页面底部。这是我需要保留的功能。这`#imgcont`是我需要垂直和水平对齐的div。它基本上需要“浮动”在页面的中心，而不会在调整大小时与`#header`and重叠或重叠`#footer`。

我遇到的问题是在`#imgcont`div 内垂直对齐`#main`div，而不使其与`#header`and重叠或重叠`#footer`。我现在使用的代码是：

```
html, body {height: 100%;}
#wrap {
    min-height: 100%;
}

#main {
    overflow: auto;
    padding-bottom: 100px;
}  /* must be same height as the footer */

#footer {
    position: relative;
    margin-top: -100px; /* negative value of footer height */
    height: 100px;
    clear: both;
    background-color: #999;
} 
#header {
    height: 100px;
    background-color: #999;
}

/*Opera Fix*/
body:before {
    content: "";
    height: 100%;
    float: left;
    width: 0;
    margin-top: -32767px;
}
#imgcont {
    width: 1000px;
    height: 300px;
    background-color: #FC3;
    margin: auto;
} 
```

显然，这只会使我的`#imgcont`水平对齐，但我确实在互联网上找到了一个代码，当窗口为全尺寸或大于`#imgcont`...

```
#imgcont {
    width: 1000px;
    height: 300px;
    background-color: #FC3;
    margin: auto;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
    position: absolute;
} 
```

...但是当窗口变小时，`#imgcont`开始与 . 重叠`#header`并在`#footer`.

当它们相遇时，我需要`#imgcont`“锁定”到页眉和页脚，然后保持水平对齐。

任何人都可以请提供任何见解，我把我的头发拉出来！:(

我希望我已经很好地解释了这一点，让你理解，因为我自己也几乎不明白！

在此先感谢，鲍勃

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T11:17:49.913

您需要**固定**身体的高度和宽度。例如。

```
.body {   
height: 900px;
width: 1000px;
 } 
```

# javascript - 不同的原型制作方法，但哪一种更受欢迎？

> ID：14356725
> 
> 赞同：0
> 
> 时间：2013-01-16T10:55:25.797
> 
> 标签：javascript

我正在研究 JavaScript 的原型行为，并看到很多让我感到困惑的不同用法。假设我们有以下构造函数和原型定义。

```
function Mammal(name) { 
   this.name = name;
}

Mammal.prototype.says = function (  ) {
   return this.saying || '';
};

Mammal.prototype.getName = function (  ) {
   return this.name;
};

function Cat(name) {
   this.name = name; //another maybe better way could be Mammal.call(this, name); results in the same
   this.saying = "meow";
}

Cat.prototype = new Mammal();

Cat.prototype.purr = function() {
   return "rrrrrrr";
}; 
```

我在网上和书中看到过很多这样的例子，但感觉这不是正确的做法。我遇到的第一个问题是，在没有参数的情况下调用了 Mammal 构造函数（此时显然是未知的）。因此，新构造的 Mammal 对象的 name 属性未定义（见下图）。

![示例 1](../Images/7c899c178fbc8bb6a7e3d6db17344d2a.png)

在我看来，这个属性甚至不应该存在，因为它没有用处并且污染了对象模型。

我的问题：上面的示例被大量用于解释 JavaScript 的一些原型行为是可接受的执行方式，还是最好执行以下操作：

```
Cat.prototype = Object.create(Mammal.prototype); 
```

请把我从这个负担中解放出来。提前致谢。

# python - Django模型复杂查询

> ID：14356726
> 
> 赞同：1
> 
> 时间：2013-01-16T10:55:26.267
> 
> 标签：python, django

我有以下 Django 模型：

```
class Mappings(models.Model):
    placeFrom = models.CharField(max_length=50)
    placeTo = models.CharField(max_length=50)
    totalTime = models.TimeField() 
```

以下是表格的填充方式：

```
placeFrom       placeTo   totalTime     
new york        london        03:55
london          paris         22:33
london          new york      03: 23
amsterdam       london        82:39 
```

这个想法是为没有直接连接的映射找到所有数据库行。例如，在这种情况下，纽约 - 巴黎没有直接连接。所以，返回的表行应该是

```
new york        london        03:55
london          paris         22:33 
```

知道怎么做吗？我首先使用`Mappings.objects.filter(placeTo="london")`, 来获取代表“某个地方”和“伦敦”之间映射的所有行。所以，我知道如果“纽约”和'某个地方'返回，但不知道如何检查..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T11:02:04.133

这是一个图形问题，不是吗？您基本上需要建立一个图，其中节点是您的位置，边是您的映射（其中边长 = mapping.totalTime），然后应用相关的图搜索算法（例如[Dijkstra 算法](http://en.wikipedia.org/wiki/Dijkstra%27s_algorithm)）来找到之间的最短路径相关节点。

不过，如果不先从数据库中获取所有映射并构建图表，我认为没有任何方法可以做到这一点。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T11:26:19.133

您需要做一些事情，例如在哪里可以建立路线并轻松找出哪些位置（或节点）未连接。完成此操作后，您需要遵循@DanielRoseman 的建议并使用图形搜索算法来填补空白

```
import networkx as nx
G = nx.DiGraph()

G.add_node('new york')
G.add_node('london')
G.add_node('paris')
G.add_node('amsterdam')

G.add_edge('new york', 'london', weight=235)
G.add_edge('london', 'paris', weight=1353)
G.add_edge('london', 'new york', weight=203)
G.add_edge('amsterdam', 'london', weight=4959)

print 'All places not linked to new york:'
for location in nx.non_neighbors(G,'new york'):
    print location 
```

*nb 为了更清楚，我没有展示从模型中导入数据，但你明白了*

你得到以下输出

```
All places not linked to new york:
paris
amsterdam 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T15:59:53.380

感谢您的建议，我选择从简单的解决方案开始，这远非理想，但它会帮助我找到更好的方法。这就是我现在得到的：

```
querySetToEndLocation = Mappings.objects.filter(placeTo="london")
toEnd = []
toMiddle = []
for row in querySetToEndLocation:
  locationFrom = row.placeFrom
  queryNew = Mappings.objects.filter(placeFrom="new york")
  for rowquery in queryNew:
    if locationFrom == rowquery.placeTo:
       toEnd.append(row)
       toMiddle.append(rowquery) 
```

# javascript - 使用 Expressjs 作为跨域 ajax 调用的代理

> ID：14356727
> 
> 赞同：1
> 
> 时间：2013-01-16T10:55:26.500
> 
> 标签：javascript, ajax, node.js, cross-domain, express

我正在开发一个完全基于外部 API 的网站。我没有任何服务器端逻辑。所有数据都将从外部 API 获取。后端服务器主要用于资产管理和路由。已决定`nodejs`与`expressjs`. 我想知道在expressjs路由中需要进行哪些修改以将来自浏览器的所有跨域ajax API调用（作为代理）路由到适当的站点并将json数据路由回浏览器？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T14:36:12.653

我编写了一个将调用路由到 API 的小代理，但我最终放弃了它，因此这可能需要更多的工作。基本思想是：

*   Ajax 无法在每个浏览器中进行跨域请求
*   您有一个外部 API，位于`http://api.example.com/`
*   您的应用程序位于`http://foo.com/`
*   你想代理所有去到`http://foo.com/api/*`的东西`http://api.example.com/*`

最好的方法是使用[Streams](http://nodejs.org/api/stream.html)。您想要过滤所有请求，然后根据收到的 URL`foo.com/api/`发出请求。`api.example.com`然后，您将拥有 4 个对象：

*   提出的要求`foo.com`
*   该请求的响应对象
*   提出的要求`api.example.com`
*   来自 API 服务器的响应

所有这些都是流。第一个和最后一个是可读流，其他是可写流。因此，您要做的是将来自可读流的任何内容写入可写流。您可以使用可读流的`pipe`方法来做到这一点。这看起来像：

```
requestFromBrowser.pipe(requestToAPI(function (responseFromAPI) {
  responseFromAPI.pipe(responseToBrowser);
})); 
```

您仍然需要手动编写标题并可能处理其他细节。这就是我的基本代码的样子。它是 Connect/Express 的中间件。

```
var http = require('http');

exports.proxy = function (prefix) {
  return function (req, res, next) {
    var options = {
      port: 3000,
      // the server receives a url like http://foo.com/api/(*)
      // send the proxy only (*)
      path: req.url.substr(prefix.length),
      // headers and the method need to be written explicitely
      method: req.method,
      headers: req.headers
    };
    if (req.url.indexOf(prefix) === 0) {
      req.pipe(http.request(options, function (proxy) {
        res.writeHead(proxy.statusCode, proxy.headers);
        proxy.pipe(res);
      }).on('error', next));
    } else {
      next();
    }
  };
}; 
```

我建议您寻找已经执行此操作的模块。NPM 注册表中可能不止一个。此外，请阅读更多关于 Streams 的内容，因为它们非常适合编写代理等。

* * *

# python - 关于pygame.sprite.groupcollide的使用方法

> ID：14356730
> 
> 赞同：1
> 
> 时间：2013-01-16T10:55:41.133
> 
> 标签：python, pygame

看这段代码（她可能有点长）：</p>

```
#Begin
import pygame
from pygame.locals import *

global x, y, picPath
x, y, picPath = 100, 100, 'C:\\Pic\\'

class Ball(pygame.sprite.Sprite):
    def __init__(self):
        pygame.sprite.Sprite.__init__(self)
        self.image = pygame.image.load(picPath + 'boll.png')
        self.image.set_colorkey(0xffffff, 0)
        self.rect = self.image.get_rect()
    def update(self, pos):
        screen.blit(self.image, pos)

class Stone(pygame.sprite.Sprite):
    def __init__(self):
        pygame.sprite.Sprite.__init__(self)
        self.image = pygame.image.load(picPath + 'stone.jpg')
        self.rect = self.image.get_rect()
        self.num = 0
        self.up = 5
    def update(self):
        if(self.up != 370)and(self.num == 0):
            self.up += 5
        elif(self.up == 0)and(self.num == 1):
            self.up += 5
            self.num = 0
        else:
            self.up -= 5
            self.num = 1
        screen.blit(self.image, (305, self.up))

class GameStart:
    def __init__(self):
        self.life = 405
        self.bg = pygame.image.load(picPath + 'bg.jpg')
        self.lf = pygame.image.load(picPath + 'life.jpg')
        player1 = pygame.sprite.Group()
        player2 = pygame.sprite.Group()
        self.cB = Ball()
        self.cS = Stone()
        player1.add(self.cB)
        player2.add(self.cS)
        self.collide = pygame.sprite.groupcollide(player1, player2, 1, 0)
    def update(self):    
        if self.collide:
            print 'Yoshi!' 
        screen.blit(self.bg, (0, 0))
        self.cB.update((x, y))
        self.cS.update()
        screen.blit(self.lf, (150, self.life))

    def start(self):
        # This is Start!
        print 'Hello'

pygame.init()
screen = pygame.display.set_mode([700,460])
clock = pygame.time.Clock()

game = GameStart()
game.start()

while True:
    clock.tick(50)

    for event in pygame.event.get():
        if event.type == QUIT:
            pygame.quit()

    pygame.display.update()
    game.update()

    kname = pygame.key.get_pressed()
    if kname[pygame.K_LEFT]:
        if x > 0: x = x - 5
    elif kname[pygame.K_RIGHT]:
        if x < 700: x = x + 5
    elif kname[pygame.K_UP]:
        if y > 0: y = y - 5
    elif kname[pygame.K_DOWN]:
        if y < 460: y = y + 5
#End 
```

为什么她一直打印“Yoshi”？我只想打印一次，球和石头的碰撞。（我的英语很差）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T05:28:59.113

`groupcollide`只运行一次。尝试`groupcollide`搬入`update`

```
class GameStart:
    def __init__(self):
        self.life = 405
        self.bg = pygame.image.load(picPath + 'bg.jpg')
        self.lf = pygame.image.load(picPath + 'life.jpg')
        self.player1 = pygame.sprite.Group()
        self.player2 = pygame.sprite.Group()
        self.cB = Ball()
        self.cS = Stone()
        self.player1.add(self.cB)
        self.player2.add(self.cS)
    def update(self):    
        if pygame.sprite.groupcollide(self.player1, self.player2, 1, 0):
            print 'Yoshi!' 
        screen.blit(self.bg, (0, 0))
        self.cB.update((x, y))
        self.cS.update()
        screen.blit(self.lf, (150, self.life)) 
```

此外，游戏逻辑在显示已绘制后更新。除非您出于某种原因想要这种行为，否则您可以`pygame.display.update`在主循环中调用 last 。

```
game.update()

kname = pygame.key.get_pressed()
if kname[pygame.K_LEFT]:
    if x > 0: x = x - 5
elif kname[pygame.K_RIGHT]:
    if x < 700: x = x + 5
elif kname[pygame.K_UP]:
    if y > 0: y = y - 5
elif kname[pygame.K_DOWN]:
    if y < 460: y = y + 5

pygame.display.update() 
```

# php - 使用 cloudmade HTTP 请求的路由距离

> ID：14356738
> 
> 赞同：0
> 
> 时间：2013-01-16T10:56:06.003
> 
> 标签：php, openstreetmap, cloudmade

是否可以通过使用 cloudemade 发出 HTTP 请求来获得距离？

目前我使用这个请求：

```
http://routes.cloudmade.com/937c6e7e029348uwb988d8a791156f34/api/0.3/8.18,50.13,10.1,53.281/car.js?lang=de&units=km 
```

（更多信息[http://developers.cloudmade.com/projects/routing-http-api/examples/find-route](http://developers.cloudmade.com/projects/routing-http-api/examples/find-route)）

但这需要很多时间，因为响应包括路线的详细信息。我只需要米的距离。

# json - 如何复制 JSON 文件并在 NSIS 中保持格式

> ID：14356741
> 
> 赞同：0
> 
> 时间：2013-01-16T10:56:15.753
> 
> 标签：json, nsis

我只想复制一个 JSON 文件。目前我正在使用 NsJSON 来读取 JSON 文件。这是我的代码：

```
nsJSON::Set /file $DESKTOP\nsis\a.json
nsJSON::Serialize /format /file $DESKTOP\nsis\a_new.json 
```

问题是：

```
"obj": [ "a", "b", "c" ] 
```

变成：

```
"obj": [
            "a",
            "b",
            "c"
        ] 
```

我必须将 json 内容保留为原始文件格式。我如何用 NsJson 做到这一点？如果没有办法，你能推荐一个可以做到这一点的不同的 JSON 解析器吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-18T16:11:43.243

如果要复制文件，请使用 CopyFiles 命令。

```
CopyFiles "$DESKTOP\nsis\a.json" "$DESKTOP\nsis\a_new.json" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-09T19:33:20.260

如果要保留原始文件格式，则不应使用 /format 开关。使用它将以“漂亮的打印”样式格式化输出。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-21T17:50:23.243

我认为没有任何其他 JSON 解析器插件，但恕我直言，您的问题是您需要特定的格式，而不仅仅是任何类型的有效 JSON。

如果您无法更改 JSON 解析器，我想您可以在 NSIS 中对 JSON 进行后处理（此代码不处理所有类型的引号或转义引号！）：

```
Function PrettyOnelineJSON
Exch $0
Push $1
Push $2
Push $3
Push $4
StrCpy $1 "" ; In quote?
StrCpy $2 "" ; Prev. char.
StrCpy $3 "" ; Pos.
loop:
    StrCpy $4 $0 1 $3
    StrCmp $4 "" done
    IntOp $3 $3 + 1
    StrCmp $4 " " 0 +2
        StrCmp $4 $2 eatone ; Was this and the previous character a space?
    StrCpy $2 $4
    StrCmp $4 "$\n" eatone
    StrCmp $4 "$\r" eatone
    StrCmp $4 '"' 0 loop
    StrCmp $4 $1 +3
        StrCpy $1 $4
        Goto loop
    StrCpy $1 ""
    Goto loop
done:
    Pop $4
    Pop $3
    Pop $2
    Pop $1
    Exch $0
    Return
eatone:
    StrCmp $1 "" 0 loop ; In a quoted string?
    StrCpy $4 $0 "" $3
    IntOp $3 $3 - 1
    StrCpy $0 $0 $3
    StrCpy $0 $0$4
    Goto loop
FunctionEnd

Section

StrCpy $0 '"obj": [$\n            "a A  a   A",$\n            "b",$\n            "c"$\n        ]'
MessageBox mb_ok ORG=|$0|

Push $0
Call PrettyOnelineJSON
Pop $0

MessageBox mb_ok NEW=|$0|

SectionEnd 
```

# c# - 不善于调试心情

> ID：14356742
> 
> 赞同：0
> 
> 时间：2013-01-16T10:56:18.623
> 
> 标签：c#, debugging, visual-studio-2012, options

当我调用系统程序集并单击“全部中断”(Ctrl+Alt+Break) 时，我希望看到休耕

![预期结果](../Images/0b376766a34f9aa684c487a4b74cbd48.png)

相反，我得到了这个

![实际结果](../Images/c8a7852b0e2f20cdacf7a8cdcd1aba97.png)

我需要做什么才能从第一张图像中获得结果？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T10:58:51.523

您需要在设置中禁用“仅我的代码”调试（正如第二个屏幕中的第一行所指出的那样）。

您甚至可以在该屏幕上直接将其禁用一点。您是否阅读了完整的错误消息？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-21T07:01:26.840

只需使用调用堆栈窗口并在那里双击您的函数。

# php - 如何用值替换变量？

> ID：14356744
> 
> 赞同：-1
> 
> 时间：2013-01-16T10:56:21.540
> 
> 标签：php, concatenation

```
$ext   = 'jpg';
$path  = './img/';

$capcha .=
'<div><span>'.$values[$i].' <input type="radio" name="capcha" value="'.$value2[$i].'"></span>
 <div style="background: url('.$path.$values[$i].'.'.$ext.');
 width:33px;
 ... 
```

这可行，但我想用他们的值替换`$ext`和`$path`变量。

```
<div style="background: url('./img/'.$values[$i].'.jpg'.); 
```

错误：总是出乎意料。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T10:59:09.663

你应该试试：

```
<div style="background: url(\''.$path.$values[$i].'.'.$ext.'\'); 
```

得到如下结果：

代替

```
<div style="background: url(path); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T10:59:33.970

我猜你打错字了...

```
$capcha .=
'<div><span>'.$values[$i].' <input type="radio" name="capcha" value="'.$value2[$i].'"></span>
 <div style="background: url(./img/'.$values[$i].'.jpg);
 width:33px;
 ... 
```

我想这会奏效。

或者：

转义单引号：

```
$capcha .=
'<div><span>'.$values[$i].' <input type="radio" name="capcha" value="'.$value2[$i].'"></span>
 <div style="background: url(\'./img/'.$values[$i].'.jpg\');
 width:33px;
 ... 
```

# javascript - jquery - 如何从hrefs获取图像列表

> ID：14356747
> 
> 赞同：-1
> 
> 时间：2013-01-16T10:56:34.630
> 
> 标签：javascript, jquery, html, image

我有一个结构：

```
<ul>
 <li><a href="img01.jpg"><img src="img_s01.jpg"></a></li>
 <li><a href="img02.jpg"><img src="img_s02.jpg"></a></li>
...
</ul> 
```

点击任何*一个*我想得到一个列表后：

```
<div>
<img src="img01.jpg">
<img src="img02.jpg">
...
</div> 
```

我在 jquery 上需要什么代码？

不替换 ul，只是在之后添加新的 div

这个小提琴[http://jsfiddle.net/28eue/](http://jsfiddle.net/28eue/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T11:15:45.187

如果想法是用新元素替换现有`ul`元素，`div`您可以这样做：

```
$("ul").replaceWith($("<div />").append($("ul img"))); 
```

...在点击处理程序中：

```
$(document).ready(function() {
  $("ul a").click(function(e) {
    e.preventDefault();
    $("ul").replaceWith($("<div />").append($("ul img")));
  });
}); 
```

演示：http: [//jsfiddle.net/k8N5M/](http://jsfiddle.net/k8N5M/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T11:03:55.667

```
$('a').click(function(e) {
  e.preventDefault()
  var $replacement = $('<div>')

  $('a img').each(function() {
    $replacement.append($(this))
  })

  $('ul').replaceWith($replacement)
}) 
```

JSFiddle：http: [//jsfiddle.net/sqz2t/](http://jsfiddle.net/sqz2t/)

您基本上观察`a`标签上的点击并将所有图像放入新创建的 div 中。

该代码将用新的 div 构造替换图像列表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T11:08:36.567

在您的点击处理程序中：

```
var newDiv = $('<div></div>');
$('ul li a').each(function(i, elem) {
    newDiv.append($('<img src="' + elem.href + '"'));
}); 
```

`newDiv`然后可以插入到 DOM 中，如果这是您想要的，则替换旧列表，或者添加到其他地方的页面中。

# mysql - 从表中选择土耳其语字符？

> ID：14356755
> 
> 赞同：1
> 
> 时间：2013-01-16T10:57:30.183
> 
> 标签：mysql, character, turkish

我有一个 MySQL 表，其中包含带有土耳其字符的文本（昵称）。例如，土耳其语中有一个单词“ **çığır** ”。（“cigir”英文字符）它像“ **Ã§Ä±ÄŸÄ±r** ”一样存储在数据库中。当我在我的 .php 页面中打印这个词时，它被正确打印（如“çığır”）。

但是当我做查询时

```
SELECT * FROM  users WHERE nickname LIKE 'çığır'; 
```

它返回一个空集。当然，另一种方式（昵称如 Ã§Ä±ÄŸÄ±r）也可以，但我也希望能够做到第一种。我怎样才能做到这一点？

ps：我试过了

```
SET NAMES 'UTF8';
SET character_set_connection = 'UTF8';
SET character_set_client = 'UTF8';
SET character_set_results = 'UTF8'; 
```

这些不起作用。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T11:00:53.793

尝试这个：

```
SELECT * FROM  users WHERE Convert(nickname using utf8) LIKE 'çığır'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T11:08:16.010

您最好将数据库转换为 UTF-8，确保 php 使用正确的字符集进行查询，

```
$link = mysql_connect('localhost', 'user', 'pass');
mysql_set_charset("UTF8", $link); 
```

完全忘记有趣的编码。这样，您的所有查询都将自动运行。

# ios - 应用程序终止时禁用监控区域

> ID：14356757
> 
> 赞同：0
> 
> 时间：2013-01-16T10:57:41.647
> 
> 标签：ios, objective-c, monitoring, regions

我为事件做了一个观察者，在为事件`UIApplicationWillTerminateNotification`调用的方法中，我从位置管理器中删除了受监控的区域：

```
for (CLRegion *region in locationManagerInstance.monitoredRegions) {
        [locationManagerInstance stopMonitoringForRegion:region];
} 
```

通常是好的监控区域被删除，当应用程序启动时我检查是否有一些监控区域：

```
[locationManagerInstance.monitoredRegions count] 
```

但是在我的位置位于受监控区域之一的情况下，当应用程序终止时，区域不会被正确删除，并且在应用程序开始时受监控区域计数（`[locationManagerInstance.monitoredRegions count]`）大于 0。

应用程序终止时如何正确删除区域？

# html - 具有后备功能的 HTML5 地理位置

> ID：14356761
> 
> 赞同：0
> 
> 时间：2013-01-16T10:58:07.423
> 
> 标签：html, geolocation

我正在为地理定位尝试这个。

[https://gist.github.com/366184](https://gist.github.com/366184)

它在 Chrome、FF 和 IE9 中运行良好，但在 IE 8 中我得到

```
SCRIPT5007: Unable to get value of the property 'watchPosition': object is null or undefined 
```

我该如何使用它？它只是粘贴了代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T11:54:12.733

在 IE8 中似乎对此有不好的支持，你不是唯一一个对谷歌地理定位和 IE8 有问题的人

[这是一个类似的问题](https://stackoverflow.com/questions/12451150/geolocation-with-both-bing-and-google-because-of-internet-explorer)

# c++ - C++11 和 if(整数)

> ID：14356763
> 
> 赞同：3
> 
> 时间：2013-01-16T10:58:10.277
> 
> 标签：c++, if-statement, c++11

在 C++11 中编写 if 子句是否仍然有效和良好的做法

```
int i;
//some code
if (i) //some code 
```

或者最好写

```
if(i != 0) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-16T11:36:47.767

这是定义明确的行为，因此您可以使用较短的表达式。对于没有经验的开发人员来说，这可能看起来很神秘，但常客在理解它时应该没有问题。

当明确地将`i`其视为数字时使用较长的形式可能有一些意义，而当它具有其他逻辑含义时省略它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T11:12:14.957

使用整数 POD 类型作为条件表达式是有效的。

我认为 C++11 中没有任何要求使用一种风格而不是另一种风格。

因此，选择您喜欢的任何风格。

# java - 计费安装

> ID：14356768
> 
> 赞同：-4
> 
> 时间：2013-01-16T10:58:19.023
> 
> 标签：java

> 如何在windows系统中安装jbilling-community-3.0.2

请帮帮我。我会尝试所有可能的方法，但它不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T16:23:25.493

按照以下教程中的说明进行操作：[http ://www.jbilling.com/documentation/users/installation/windows](http://www.jbilling.com/documentation/users/installation/windows)

它应该是直截了当的。

如果您无法使用上面这个简单的教程安装它；然后聘请专业的 JBilling 开发人员来帮助您安装它。

BTW：我可以帮你安装。如果需要，请与我联系，我将协助您在本​​地系统中安装它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-10-30T06:08:08.903

**从二进制文件设置 jbilling-community-3.0.2.zip 的步骤：**

下载二进制压缩包。注意：需要Java6，根据你的操作系统，如windows、linux、mac，用标准的方式配置。

//解压zip内容 unzip -q jbilling-community-3.0.2.zip

cd jbilling-community-3.0.2/bin/

chmod +x *.sh

./startup.sh && tail -f ../logs/catalina.out

**设置 jbilling-community-3.0.2-src.zip 源 zip 的步骤：**

下载压缩包。笔记：

1.  需要Java6，根据你的操作系统，如windows、linux、mac，用标准的方式配置。
2.  需要在本地安装 Postgres 版本 8.x 或更高版本

//解压zip内容 unzip -q jbilling-community-3.0.2-src.zip

cd jbilling-community-3.0.2/

1.  圣杯清洁
2.  grails 编译
3.  grails 编译
4.  dropdb -U jbilling jbilling_test
5.  createdb -U jbilling jbilling_test
6.  grails 准备测试 --verbose
7.  grails 运行应用程序

**数据库设置**

要使用不同的数据库，请检查*grails-app/conf/DataSource.groovy*文件以设置备用数据库的 dataSource 属性。默认情况下，jBilling 提取的 src zip使用用户*jbilling连接到**jbilling_test*

 ** * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-29T19:07:58.127

我偶然发现了同样的问题来安装它。但在我的情况下，我必须在之前安装的环境变量中删除 catalina_home 和 tomcat 安装路径。jbilling zip 文件与预安装的 tomcat 服务器一起提供，并配置为正常运行。

如果以上不是你的情况。发布错误堆栈跟踪，以便观众了解发生了什么。*

# python - 通过 Python 将 CSV 转换为 KML

> ID：14356770
> 
> 赞同：-1
> 
> 时间：2013-01-16T10:58:30.060
> 
> 标签：python, csv, kml

我有一个小问题我总是得到错误：

> TypeError：无法连接“str”和“list”对象

```
import csv
import os
fp = "filepath/testfile.csv"
file = open(fp)
lines =file.readlines()
for line in lines:
    line = line.strip()
    fields = line.split(',') #comma seperated
    branch = fields[0].split() #splitting
    lat = fields[1].split()
    lng = fields[2].split()
    web = fields[3].split()
    email = fields[4].split()
    adress = fields[5].split()

    print ("branch: " + branch) #print splitted
    print ("lat: " + lat)
    print ("lng: " + lng)
    print ("web :" + web)
    print ("email: " + email)
    print ("address: " + address)

f = open('filepath/csv2kml.kml', 'w')
fname = "testing_Actions"
#Writing the kml file.
f.write("<?xml version='1.0' encoding='UTF-8'?>\n")
f.write("<kml xmlns='http://earth.google.com/kml/2.1'>\n")
f.write("<Document>\n")
f.write("   <name>" + fname + '.kml' +"</name>\n")
for row in lines:
    f.write("   <Placemark>\n")
    f.write("       <ExtendedData>\n")
    f.write("           <Data name=the branch name>\n")
    f.write("               <value>\n")
    f.write("               " + str(branch) + "\n")
    f.write("               </value>\n")
    f.write("           </Data>\n")
    f.write("           </Data name=Web>\n")
    f.write("               <value>\n")
    f.write("               " + str(web) +"\n")
    f.write("               </value>\n")
    f.write("           </Data>\n")
    f.write("           </Data name=email>\n")
    f.write("               <value>\n")
    f.write("               " + str(email) + "\n")
    f.write("               </value>\n")
    f.write("           </Data>\n")
    f.write("       <description>" + str(address) + "</description>\n")
    f.write("       <Point>\n")
    f.write("           <coordinates>" + str(lat) + "," + str(lng) + "</coordinates>\n")
    f.write("       </Point>\n")
    f.write("   </Placemark>\n")
f.write("</Document>\n")
f.write("</kml>\n")
print ("File Created. ")
f.close
file.close() 
```

我找不到我的错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T11:01:03.620

“*我找不到我的错误*”

你可以。如果您完全阅读了错误消息，它还会告诉您错误发生在哪几行。

是在这里吗？

```
print ("branch: " + branch) #print splitted 
```

在以下几行中，您尝试连接 string`"branch"`和 list `branch`。

尝试将其替换为：

```
print ("branch: {}".format(branch)) #print splitted 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T17:29:19.737

更好的是，使用 KML 库：http: [//googlegeodevelopers.blogspot.ca/2012/01/introducing-pykml-python-library-for.html](http://googlegeodevelopers.blogspot.ca/2012/01/introducing-pykml-python-library-for.html)

几乎每种语言都有一个。

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2013-01-16T11:10:22.253

我解决了！

```
print ("branch: " + branch) #print splitted
print ("lat: " + lat)
print ("lng: " + lng)
print ("web :" + web)
print ("email: " + email)
print ("address: " + address) 
```

编辑为

```
print ("branch: " + `branch`) #print splitted
print ("lat: " + `lat`)
print ("lng: " + `lng`)
print ("web :" + `web`)
print ("email: " + `email`)
print ("address: " + `address`) 
```

和

```
f.write("           <Data name=the branch name>\n")
f.write("               <value>\n")
f.write("               " + `branch` + "\n")
f.write("               </value>\n")
f.write("           </Data>\n") 
```

等等

# c# - 当报表有参数时，使用 WebClient 访问 Reporting Services 导出

> ID：14356772
> 
> 赞同：2
> 
> 时间：2013-01-16T10:58:38.010
> 
> 标签：c#, asp.net, reporting-services, webclient

我在尝试使用 WebClient 从 Reporting Services 导出报告时遇到了问题。

如果我使用我的代码加载不包含任何参数的报告，一切正常，一旦我尝试传递参数，我就会收到 500 服务器错误。

如果我在 Web 浏览器中点击 Reporting Services URL，则报告加载良好，它采用查询字符串中指定的参数值并以 Excel 格式返回报告。

这是我过去做过的事情，所以真的很难过问题是什么。下面是我正在使用的一些代码，如上所述，这适用于没有参数的报告。这无论如何都不是最终代码，但我需要先让它与参数一起工作

```
string url = "http://localhost/Reportserver?/ReportsFolder%2fTheReport&rs:Format=EXCEL&rs:Command=Render&Start=15-01-2013&End=15-01-2013";

WebClient c = new WebClient();
c.UseDefaultCredentials = true;
c.Headers.Add("user-agent", "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2; .NET CLR 1.0.3705;)");
byte[] data = c.DownloadData(url); 
```

事实上，在 Web 浏览器中打开链接时它工作正常，这让我很困惑，而且这个问题只发生在具有参数的报告中。

## 更新

我刚刚意识到哪里出了问题，这是日期的格式。我正在输入英国格式的日期 dd/mm/yyyy (15-01/2013)

这仍然是一个奇怪的想法，因为在将 URL 粘贴到 Web 浏览器时，以英国格式提供它可以正常工作。

使用上面的 WebClient 代码提供英国日期时，出现错误。我不确定为什么使用这两种方法会有所不同，对我来说不再是问题，但仍然有兴趣知道为什么会这样......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T11:49:52.103

通过 WebClient 发送请求时，请确保以 mm/dd/yyyy 格式发送日期。

看来，即使英国日期格式 dd/mm/yyyy 在 IE 中有效，但在通过 WebClient 和原始问题中的代码发出请求时也不起作用。

在我的情况下，相反的情况似乎是正确的，当将 URL 粘贴到 IE 时，如果日期以 mm/dd/yyyy 的美国格式提供，则会引发错误

# xml - 替换 xml 节点值无法在 xml 文件中更新

> ID：14356776
> 
> 赞同：0
> 
> 时间：2013-01-16T10:58:43.703
> 
> 标签：xml, powershell, powershell-2.0

我正在尝试使用以下 powershell 脚本更新节点值

```
$XMLContents = [XML] (Get-content "C:\Test.xml")
$XPath="/Parameters/Parameter[ParameterName='pTxtRuntimeUserName']/ParameterValue"
$MachineNameInXML= Select-XML -XML $XMLContents -XPath $Xpath
$Userstring=$($MachineNameInXML.Node.'#text')
$Userstring = $Userstring.Replace("WIN2K8R25\administrator","WIN2K8R25\ABC")
$Userstring
$XMLContents.Save("C:\Test.xml") 
```

当我显示 $Userstring 时，它会正确显示替换值“WIN2K8R25\ABC”，但在 xml 文件中它没有更新。它仍然是旧用户名“WIN2K8R25\administrator”。

我的 XML 文件有很多参数节点，我单独复制了一些示例节点值。

```
<Parameters>
    <Parameter IsEncrypted="False">
      <ParameterName>pTxtRuntimeUserName</ParameterName> 
      <ParameterValue>WIN2K8R25\administrator</ParameterValue> 
    </Parameter>
    <Parameter IsEncrypted="False">
      <ParameterName>pTxtABC</ParameterName> 
      <ParameterValue>XYCr</ParameterValue> 
    </Parameter>
</Parameters> 
```

我找不到我想念的地方。我在这缺少什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T11:12:34.740

在这一行：

```
$Userstring = $Userstring.Replace("WIN2K8R25\administrator","WIN2K8R25\ABC") 
```

看起来您只是将`$Userstring`变量重新分配给一个新值，但这对 DOM 的内容没有影响。

在那之后添加一个新行怎么样：

```
$MachineNameInXML.Node.InnerText = $Userstring 
```

或者您可以完全跳过使用该`$Userstring`变量：

```
$XMLContents = [XML] (Get-content "C:\Test.xml")
$XPath="/Parameters/Parameter[ParameterName='pTxtRuntimeUserName']/ParameterValue"
$MachineNameInXML= Select-XML -XML $XMLContents -XPath $Xpath
$MachineNameInXML.Node.InnerText = $MachineNameInXML.Node.InnerText.Replace("WIN2K8R25\administrator","WIN2K8R25\ABC")
$XMLContents.Save("C:\Test.xml") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T11:23:45.570

尝试：

```
$path = "C:\Test.xml"
$XMLContents = [XML] (Get-content $path)
$Node = $XMLContents.SelectNodes("/Parameters/Parameter[ParameterName='pTxtRuntimeUserName']/")
$Node[0].ParameterValue = $Node[0].ParameterValue.Replace("WIN2K8R25\administrator","WIN2K8R25\ABC")
$XMLContents.Save($path) 
```

可能是一种更好看的方法，但只要它只是一个具有该参数名的节点，它就可以工作。

# maps - 电晕地图和方向

> ID：14356780
> 
> 赞同：0
> 
> 时间：2013-01-16T10:58:53.457
> 
> 标签：maps, coronasdk, direction

我正在将电晕用于我正在制作的应用程序。对于联系页面，我想添加从您所在位置到该地点所在位置的路线。我想知道我怎么能做到这一点。Mapview 似乎没有这些选项。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T21:51:09.580

native.newMapView() 似乎不支持方向，但是您可以使用 URL 方案调用本机地图应用程序并使用它来提供方向。有关更多信息，请参阅此博客文章：

[http://www.coronalabs.com/blog/2012/12/18/reintroducing-google-maps/](http://www.coronalabs.com/blog/2012/12/18/reintroducing-google-maps/)

# php - 如何在 yii 中显示多个星级？

> ID：14356800
> 
> 赞同：1
> 
> 时间：2013-01-16T11:00:09.880
> 
> 标签：php, yii, yii-components

我正在 yii 中开发 CStar 评级小部件。我做了如下：

```
$review = Reviews::model()->findAll();
        foreach($review as $review)
        {
           $rate=$review['rating'];
           $this->widget('CStarRating',array(
                'name'=>'rating',
                'minRating'=>1,
                'maxRating'=>5,
                'starCount'=>5,
                'value'=>$rate,
                'readOnly'=>true,
            ));
            echo "<br/>";
            echo $review['title'];
            echo "<br/>";
            echo "<font color='brown'>".ucfirst($review['name'])."</font><br/>";
            echo $review['body'];
            echo "<hr/><br/>";
        }
    ?> 
```

当我在数据库中输入一条评论时，没关系，但是当我添加第二条评论时，两个评论星混合在一起。

在这种情况下我该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T18:11:34.027

您正在使用小部件的“名称”属性，因此 javascript 变得混乱，因为将有超过 1 个具有相同名称的输入，您需要做的是使用小部件的“模型”和“属性”选项

```
 $this->widget('CStarRating',array(
                'attribute'=>'rating', //change to the attribute in your model
                'model'=>$review,
                'minRating'=>1,
                'maxRating'=>5,
                'starCount'=>5,
                'value'=>$rate,
                'readOnly'=>true,
            )); 
```

您还需要从以下位置重命名 foreach 中的变量：

```
$review = Reviews::model()->findAll();
foreach($review as $review) 
```

到

```
$reviews = Reviews::model()->findAll();
foreach($reviews as $review) 
```

# ios - 多个 UINavigationBar 中的一个 UIBarButtonItem 实例

> ID：14356801
> 
> 赞同：0
> 
> 时间：2013-01-16T11:00:17.387
> 
> 标签：ios, objective-c, uibarbuttonitem

我有一个 UIBarButtonItem 我想创建一次，因为它出现在许多视图中。

在 viewControllers 的不同 UINavigationBar 的标签栏中，我添加了相同的按钮实例：

```
[self.navigationItem setRightBarButtonItems:[NSArray arrayWithObjects:
                                                 self.aButtonItem,
                                                 appDelegate.aSingleton.singleButtonItem,
                                                 nil] 
```

当我在视图之间切换时，单实例按钮仅在第一次显示。有一个空白区域，您甚至可以单击按钮所在的位置并正确调用操作。

只是不再显示该按钮。

这是记录在案的“功能”吗？

我为什么要这样做？

我将要选择的按钮更改为 _singleButtonItem.selected=YES 以向用户显示通知（如徽章，但干扰较少）。因此，我想要一个实例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T11:10:52.540

单个对象不能位于多个位置。您需要创建多个。但是，您可以将徽章值存储在某处并将其显示在每个按钮上以满足您的需求。

从逻辑上讲，一个 UIView 只能有一个父视图。因此，如果您将相同的子视图添加到另一个视图，它将从第一个父视图中删除并作为子视图添加到第二个父视图。

# android - iOS 和 Android 原生移动应用程序的性能测试工具

> ID：14356813
> 
> 赞同：9
> 
> 时间：2013-01-16T11:00:44.793
> 
> 标签：android, ios, native, performance-testing

我必须在 iOS 和 Android 平台上对本机应用程序进行性能测试。该工具的当前要求是：

```
- The tool needs to check for the native applications CPU and memory usage.
- If possible, we need to provide if there are any memory leaks also involved with the native application.
- Check for network performance over the various networks - EDGE, 2G, 3G, 4G and wireless connections (various speeds).
- If we can do Functional testing with the same application, it would be a great addition. 
```

我能够弄清楚的是：

```
1\.  UI Response Time
◦   Download times for intermediate action requests (patch or network downloads), to be reduced with better compression techniques
◦   User action and response rates of the application, need to be smoothened by employing better software rendering and faster animations
◦   Provide a progress indicator to the user, along with completion notification
2\.  Battery Life
◦   Battery drain is non-linear, so minimize radio wake-up calls and
◦   Use system events, instead of polling
3\.  Network Bandwidth
◦   Basically depends on - signal strength, carrier networks and network type (performance can be considered for slower networks, but no guarantee on the faster 2G & above).
◦   Faster networks need to be checked basically for the functionality
4\.  Memory and CPU
◦   Overall device sluggishness needs to be monitored with respect to the response of the various actions. This can only be monitored by running the functional tests, and checking the actual RAM and CPU counters using a recording tool.
◦   No application crashes should be seen, even after keeping the application open for a few days.
5\.  Binary Size
◦   Effects application load time
◦   Effects load RAM size
◦   Download & install times
6\.  Tools
◦   http://spb.com/pocketpc-software/wirelessmonitor/
◦   http://mobitest.akamai.com/m/index.cgi
◦   http://www.neotys.com/product/mobile-load-testing.html 
```

我的问题是我们可以在上面添加任何其他参数来测试本机应用程序的性能吗？

另外，您会推荐哪些其他开源和商业工具，它们满足上述所有在 iOS、Android 和 WindowsOS 平台上对原生移动应用程序进行性能测试的标准？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T06:20:52.867

在移动应用程序的性能测试方面，这是一篇非常全面的文章。我有几件小事要补充： 关于内存： 1\. 您可能还想随时监控峰值内存消耗。这在 Android 上尤其重要，因为应用程序的可用内存实际上可能因设备而异。因此，即使它可能不会在进行测试的设备上给您带来问题，但它可能会在其他一些低端设备上引起问题。

1.  类似地，您可能还想监控垃圾收集的发生情况以及有多少是并发的以及有多少是基于分配的 gc。因为 gc 可能会影响应用程序的响应时间，特别是如果它是由分配引起的。

关于电池寿命： 1\. 您可能需要验证应用程序获取的任何唤醒锁是否被及时释放。2\. 应用程序尽可能使用不精确的计时器，而不是精确的计时器（例如，使用 setInexactRepeating 代替 AlarmManager 的 setRepeating 方法）。

其他一些标准： 1\. 验证应用程序是否正在适当地缓存数据 - 例如，当屏幕方向改变时不刷新它已经拥有的内容。2\. 甚至更好的应用程序，实际上可能会根据连接的网络类型来调节它们的数据消耗——如果连接到 Wifi，就会发疯并预取内容，但如果连接到蜂窝数据，则获取的积极性会降低一些。

希望这可以帮助。

# javascript - 手风琴标签不适用于 IE8

> ID：14356814
> 
> 赞同：0
> 
> 时间：2013-01-16T11:00:45.713
> 
> 标签：javascript, jquery, html, jquery-ui

我使用 ui 库创建手风琴标签，它适用于所有浏览器，但不适用于 IE8

这是我的代码：

```
<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>jQuery UI Accordion - Sortable</title>
    <link rel="stylesheet" href="../../themes/base/jquery.ui.all.css">

    <script src="../../jquery-1.8.3.js"></script>
    <script src="../../ui/jquery.ui.core.js"></script>
    <script src="../../ui/jquery.ui.widget.js"></script>
    <script src="../../ui/jquery.ui.mouse.js"></script>
    <script src="../../ui/jquery.ui.sortable.js"></script>
    <script src="../../ui/jquery.ui.accordion.js"></script>
    <link rel="stylesheet" href="../demos.css">

    <script>
    $(document).ready(function() {

    $("#acc1").accordion({
            active:".ui-accordion-left", 
            alwaysOpen: false,
            autoheight: false,
            header: 'a.acc1',
            clearStyle: true
    });
    $("#acc2").accordion({
            active:".ui-accordion-left", 
            alwaysOpen: false,
            autoheight: false,
            header: 'a.acc2',
            clearStyle: true
    });

});
    </script>
</head>
<body>
<ul id="acc1" class="ui-accordion-container">
    <li>
        <div class="ui-accordion-left">
            </div>
                  <a class="ui-accordion-link acc1">1a
                     <span class="ui-accordion-right"></span>
                      </a>
                      <div>
                        data of 1a<br/>
                        data of 1a<br/>
                        data of 1a<br/>
                        <ul class="ui-accordion-container" id="acc2">
                        <li>
                                <div class="ui-accordion-left">
                              </div>
                                <a class="ui-accordion-link acc2">2a
                                <span class="ui-accordion-right"></span>
                             </a>
                                <div>
                                data of 2a<br/>
                                data of 2a<br/>
                                data of 2a<br/>
                                </div>
                        </li>
                        <li>
                                <div class="ui-accordion-left">
                              </div>
                                <a class="ui-accordion-link acc2">2b
                                <span class="ui-accordion-right"></span></a>
                                <div>
                              data of           2b<br/>
                                data of 2b<br/>
                                data of 2b<br/>
                                </div>
                        </li>
                </ul>
                </div>
      </li>
    <li>
              <div class="ui-accordion-left"></div>
                <a class="ui-accordion-link acc1">1b
                <span class="ui-accordion-right"></span></a>
               <div>
                data of 1b<br />
                      data of 1b<br />
                      dta of 1b <br />
               </div>
    </li>
</ul>

<div class="demo-description">
<p>Drag the header to re-order panels.</p>
</div>
</body>
</html> 
```

来自 Firefox 的屏幕截图有效： ![火狐](../Images/94ccdebc6e296925a8c8fa6589feed7e.png) 来自 IE8 的屏幕截图无效： ![IE](../Images/783f54fb0ecc85538ec0af1a59bf7103.png) 我想我错过了一些东西！如何解决？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T11:03:11.363

添加**脚本类型**

```
 <script type="text/javascript">

    $(document).ready(function() {

    }):

</script> 
```

# doxygen - doxygen 1.8.3 子页面：缺少空间

> ID：14356822
> 
> 赞同：1
> 
> 时间：2013-01-16T11:01:16.750
> 
> 标签：doxygen

运行 doxygen 1.6.2 没有问题，但是如果我运行 1.8.3（在 win7 上），我会遇到缺少空间的问题。

**编码：**

```
/** \mainpage FEAST Overview

Chapter \subpage tutorial_page - Go here to work through the calculator
example that shows how to create a simple Web-Service driven application
from scratch. 
```

*/

/** \page tutorial_page 教程

```
This chapter contains a list of tutorials and examples that introduce the most
important features of FEAST. 
```

*/

**结果：**

```
ChapterTutorials - Go here to work through the calculator example that shows how to create a simple Web-Service driven application from scratch. 
```

在**章节**和**教程**之间没有空间。这是一个错误吗？

# c# - 如何合并给定属性上的两个列表

> ID：14356823
> 
> 赞同：5
> 
> 时间：2013-01-16T11:01:16.997
> 
> 标签：c#, linq

我有两个查询，每个都返回一个对象列表。

```
List<A> list1 = (....query...)
List<A> list2 = (....query...) 
```

“A”是一个对象模型。

两个查询都返回几乎相同的对象，但设置了不同的属性。

我想删除重复项，根据对象 A 的属性将它们合并到一个列表中。

基本上是这样的：

```
List<A> finalLis = list1 join list2 on elemList1.somePropID == elemList2.somePropID 
```

在简单的 C# 风格中，它会是这样的：

```
foreach(elem1 : list1) {
    foreach(elem2: list1) {
       if(elem1.someID == elem2.someID) {
           elem1.someProp = elem2.someProp
           elem1.otherProp = elem2.otherProp
        }
     }
} 
```

我不想这样做，因为我确信 linq 中有一种更优雅的方式。

如果您有任何建议，请让我知道。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T17:44:56.923

Linq 可以帮助您选择，但不能帮助您更新。所以你不会摆脱`foreach`声明。所以你的任务可以用 linq 写成这样：

```
//the query is like LEFT JOIN in SQL
var query = from x in list1
            join y in list2 on x.IDItem equals y.IDItem
            into z
            from q in z.DefaultIfEmpty()
            select new {IOne = x, ITwo = q};
foreach (var pair in query)
{
    if (pair.ITwo != null) // && pair.IOne.OneProperty != null
        pair.IOne.OneProperty = pair.ITwo.TwoProperty;
}

var resultList = query.Select(x => x.IOne).ToList(); 
```

您可以在[此处](http://ideone.com/ecXeXg)查看结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T15:21:15.217

试试这个：

```
List<A> list = (from e1 in list1
           join e2 in list2
           on e1.ID equals e2.ID
           select new A
           {
              ID = l2.ID,
              someProp1 = l2.someProp1,
              someProp2 = l2.someProp2
           }).ToList(); 
```

然后你会有一个包含所有元素的第三个列表。

此链接可能会有所帮助：[LINQ Join 2 List<T>s](https://stackoverflow.com/questions/2723985/linq-join-2-listts)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T15:33:50.483

Linq 用于*查询*，而不是*更新*。您可以简化连接，但仍需要循环进行更新。

就像是：

```
List<A> finalList = 
   from item1 in list1 
   join item2 in list2 on item1.somePropID equals item2.somePropID 
   select new{Item1 = item1, Item2 = item2};

foreach(var item in finalList)
{
    item.Item2.someProp1 = item.Item1.someProp1;
    item.Item2.someProp2 = item.Item1.someProp2;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-12T09:27:37.993

想要使用 LINQ 是对的。

这里的答案都等同于给定的 C# 代码片段，除了代码片段效率非常低，并且会导致 list1.Length * list2.Length 操作。

使用 LINQ 连接效率更高，并且会产生大致的 list1.Length + list2.Length 操作。

这是因为 id 上的连接将使用字典执行类似的操作

```
// create a dict so that you can lookup things in item1 based on id
var list1IdToADict = list1.ToDictionary(a => a.id);

//filter out things not in both lists (join on there id)
var joinedList2 = list2.Where(a => list1IdToADict.ContainsKey(a.id)); 
```

其他答案更优雅，但如果你想这样做，你可以完成

```
foreach(var a in joinedList2){
    a.someProp = list1IdToADict[a.id].someProp;
    a.otherProp = list1IdToADict[a.id].otherProp;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-08-09T16:31:56.990

任何解决方案`List<T>`最多只能在 N * Log(n) 处执行，因为需要对列表进行排序。

在您的模型上实现相等成员并使用 a`HashSet<T>`代替。

这在复杂性和分配方面都是最佳的。

```
var set1 = new HashSet<Model>
{
    new Model(0, "000"),
    new Model(2, "222"),
    new Model(4, "444"),
};

var set2 = new HashSet<Model>
{
    new Model(1, "111"),
    new Model(2, "2222"),
    new Model(3, "333"),
};

set1.ExceptWith(set2);
set1.UnionWith(set2); 
```

补充一下，使用覆盖集作为结果集会更快。

```
set2.UnionWith(set1); 
```

`Model`上述示例中的类：

```
class Model
{
    public readonly int Id;
    public string Data;

    public Model(int id, string data)
    {
        Id = id;
        Data = data;
    }

    public override int GetHashCode()
    {
        return Id;
    }

    protected bool Equals(Model other)
    {
        return Id == other.Id;
    }

    public override bool Equals(object obj)
    {
        if (ReferenceEquals(null, obj)) return false;
        if (ReferenceEquals(this, obj)) return true;
        return obj.GetType() == GetType() && Equals((Model) obj);
    }
} 
```

# nservicebus - NServiceBus.Master 配置文件执行期间的 MasterNodeConfig 行为

> ID：14356824
> 
> 赞同：0
> 
> 时间：2013-01-16T11:01:20.267
> 
> 标签：nservicebus, nservicebus3, nservicebus-distributor

我今天遇到了路障。在我们的组织中，所有的部署都是由 TFS Build 完成的。每个 NSB 主机组件都由构建门户打包和部署。当我们尝试使用 NSB 的横向扩展功能时，我们必须使用 Master 和 Worker 配置文件安装相同的组件。我们通过在打包时传递所需的参数来管理 Master 和 Worker 安装程序。为了简化流程，我们计划为 Master 和 Worker 使用一个配置文件，我们为 Master 和 Worker 保留 MasterNode 配置。一切都好！它工作得非常好。

根据政策，我们不应该在配置文件中使用服务器名称，我们必须在我们的配置文件中使用 DNS 别名。我们通过在 DNS 别名之上启用 MSMQ 工作来实现它。

现在真正的问题开始了，NServiceBus.Master 配置文件将 Node 值附加到输入队列上。当我们将 DNS 别名用作 Node 时，它​​会引发以下异常。

> System.Exception：启动端点时出现异常，已记录错误。原因：输入队列 [somequeue@some-dns.bus] 必须与此进程 [SOMEDITSERVER01] 在同一台机器上。---> System.InvalidOperationException：输入队列 [somequeue@some-dns.bus] 必须与此进程 [SOMEDITSERVER01] 在同一台机器上。在 NServiceBus.Unicast.Queuing.Msmq.MsmqMessageReceiver.Init（地址地址，布尔事务）在 NServiceBus.Unicast.Transport.Transactional.TransactionalTransport.NServiceBus.Unicast.Transport.ITransport.Start（地址地址）在 NServiceBus.Unicast.UnicastBus。 NServiceBus.IStartableBus.Start(Action startupAction) 在 NServiceBus.Hosting.GenericHost.Start()
> 
> --- 内部异常堆栈跟踪结束 --- 在 Magnum.StateMachine.EventActionList 的 NServiceBus.Hosting.GenericHost.Start() 处`1.Execute(T stateMachine, Event event, Object parameter)
> 
> --- 内部异常堆栈跟踪结束 --- 在 Magnum.StateMachine.ExceptionActionDictionary 1.Execute(T stateMachine, Event event, Object parameter) at Magnum.StateMachine.State 1 eevent, Object value) at Magnum.StateMachine.StateMachine` 1.RaiseEvent（事件引发）在 Topshelf.Internal.ServiceControllerProxy.Start() 在 Topshelf.Internal.ServiceCoordinator.Start() 在 Topshelf.Internal.Hosts.ConsoleHost.Run() 在 NServiceBus.Hosting.Windows.Program.Main(字符串 [] 参数）`1.HandleException(T stateMachine, Event event, Object parameter, Exception exception)
> at Magnum.StateMachine.EventActionList``1.RaiseEvent(T instance, BasicEvent`

**问题：**

当 NSB 严格寻找当前 MachineName 作为当前输入队列的有效服务器名称时，为什么 NSB 在输入队列和其他队列上附加 MasterNode 值？为什么 NSB 在与 NServiceBus.Master 或 NServiceBus.Distributor 一起运行时不忽略 MasterNode 值？

如果 NSB 仍想在输入队列上附加 MasterNode 值……为什么 NSB 不解析 DNS 名称，而是限制使用当前 MachineName 进行验证？

```
var configSection = Configure.GetConfigSection<MasterNodeConfig>();
if (configSection == null)
{
    return;
}
var ipAddressesOfNode = Dns.GetHostEntry(configSection.Node).AddressList.Select(ip => ip.ToString()).ToArray();
var ipAddressesOfHost = Dns.GetHostEntry(Environment.MachineName).AddressList.Select(ip => ip.ToString()).ToArray();
if (ipAddressesOfHost.Any(ipAddressesOfNode.Contains))
{
    //Valid DNS Name
} 
```

最后我们最终得到以下选项，

1.**失败的方法：**更改 IHandleProfile 上的 MasterNodeConfig 的 Node 值。我喜欢这种方法，但它几乎没有缺点。它不会工作，因为 MasterNodeConfig 没有覆盖 IsReadonly() 的默认行为，它会抛出错误。如果您使用集成配置文件，在安装期间它不会创建 Worker & Distributor 队列

```
internal class MasterNodeConfigSetup : IHandleProfile<Master> 
{
public void ProfileActivated()
{
var configSection = Configure.GetConfigSection<MasterNodeConfig>();
configSection.Node = Environment.MachineName;
} 
} 
```

有绕过上述代码创建的运行时错误的技巧。但是，如果您手动处理其他队列创建，我们可以使用它；

```
var field = typeof(ConfigurationElement).GetField("_bReadOnly", BindingFlags.Instance | BindingFlags.NonPublic);
if (field != null)
{
field.SetValue(configSection, false);
configSection.Node = Environment.MachineName;
} 
```

2.为worker和master保留两个不同的配置文件并打包。很多工作看起来是可行的。

3.在Master组件部署过程中移除MasterNodeConfig。

我不反对NSB，我喜欢NSB。我只是表达我的沮丧，想知道为什么！为什么它附加 MasterNode 值以及为什么它只是用 Environemnt 验证而不是解决它。

我非常愿意接受您的任何建议。

# iphone - iPhone 视图上的圆角

> ID：14356825
> 
> 赞同：1
> 
> 时间：2013-01-16T11:01:22.827
> 
> 标签：iphone, ios, rounded-corners, shadow

我想创建一个如下所示的视图。
（您可能在 pinterest 和其他图像共享应用程序中看到过类似的图像格式）
它们会有很多（它们将是 tableview 或 collectionView 单元格）。

是否有为大量视图 创建`rounded effect`,的首选方式？`shading effect`

![在此处输入图像描述](../Images/ba830c449160e956982ad5166645a2f9.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T11:03:47.157

添加此框架

```
#import <QuartzCore/QuartzCore.h> 
```

并使用以下代码，

```
UIView *view = [[UIView alloc] initWithFrame:CGRectMake(15, 15, self.view.bounds.size.width - 30, self.view.bounds.size.height - 30)];
view.backgroundColor = [UIColor whiteColor];
view.layer.cornerRadius = 15.f;
view.layer.borderColor = [UIColor grayColor].CGColor;
view.layer.borderWidth = 2.f;
[self.view addSubView:view]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T11:02:33.793

您将需要使用该`CALayer`属性 -`cornerRadius`

您需要导入 QuartzCore 框架才能使用它。

```
view.layer.cornerRadius = 10; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T11:56:00.127

对于使用圆角制作视图，使用 QuartzCore 框架 CALayer 类有助于制作圆角、颜色和宽度等边框

对于圆角使用这个

```
 [viewObject.layer setCornerRadius:15.0f]; 
```

和阴影使用这个

```
 viewObject.layer.shadowColor = [[UIColor blackColor] CGColor];
 viewObject.layer.shadowRadius = 7.0f;
 viewObject.layer.shadowOpacity = 0.8f;
 viewObject.layer.shadowOffset = CGSizeMake(20, 20); 
```

# c# - NullReferenceException 未处理 C#

> ID：14356827
> 
> 赞同：0
> 
> 时间：2013-01-16T11:01:34.680
> 
> 标签：c#, nullreferenceexception

Visual Studio 2010 - C# 中的（Windows 窗体）

我有这个代码：

```
private void cbxValuta_SelectedIndexChanged(object sender, EventArgs e)
    {
        try
        {
            string primo = cbxValuta.SelectedItem.ToString();
            string secondo = cbxValuta2.SelectedItem.ToString();
            double cambio = double.Parse(CurrencyConverter.Convert(1.0m, primo, secondo));
            tbxConvertito.Text = (double.Parse(tbxDaConvertire.Text) * cambio).ToString(); 
```

我收到此错误：

> NullReferenceException 是未处理的对象引用未设置为对象的实例。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T11:05:13.023

您可能没有[`SelectedItem`](http://msdn.microsoft.com/en-us/library/system.windows.forms.combobox.selecteditem.aspx)i 组合框。

> 作为当前选定项的对象，如果当前没有选定项，则为 null。

然后这些行可能会失败`ToString()`：

```
string primo = cbxValuta.SelectedItem.ToString();
string secondo = cbxValuta2.SelectedItem.ToString(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T11:05:52.300

`SelectedItem`如果在 UI 元素中未选择任何项目，则返回 null。尝试添加检查是否已选择项目

```
if(cbxValuta.SelectedItem != null && cbxValuta2.SelectedItem != null)
{
       string primo = cbxValuta.SelectedItem.ToString();
       string secondo = cbxValuta2.SelectedItem.ToString();
//       ....
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-16T11:05:53.580

你写了这个字符串发生了异常：

```
string secondo = cbxValuta2.SelectedItem.ToString(); 
```

这意味着或 cbxValuta2 为空，或 cbxValuta2.Selected 项目为空。检查您是否在此组合框中选择了某些内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-16T11:05:23.007

这意味着要么`cbxValuta2`或（更有可能）`cbxValuta2.SelectedItem`是`null`。这并不奇怪——如果你有一个用户可以选择零个项目的列表，a`null`是一个很可能的值。

您应该`if`在调用任何方法（`ToString()`在本例中为 ）之前检查它。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-16T11:07:51.360

primo 为空，因为 cbxValuta 没有选定项目。

# iphone - 如何在线程中执行 GUI 操作 - IOS

> ID：14356828
> 
> 赞同：0
> 
> 时间：2013-01-16T11:01:35.010
> 
> 标签：iphone, ios, objective-c, cocoa-touch, dispatch-async

我有一个线程会调用我的许多接口函数。当它调用时我需要做一些 GUI 操作，因为我知道 GUI 需要在主线程中完成，现在我还在使用

```
 dispatch_async(dispatch_get_main_queue(), ^{
                // Some method call...
            }); 
```

在大多数情况下它都可以正常工作，但我在这里仍然面临问题..例如..我的界面功能如下...

```
 void interface_fun(char *name, int user_id) {
                dispatch_async(dispatch_get_main_queue(), ^{
                    gui_acton_with_name(name, user_id);
                });
         } 
```

现在名称指针大部分时间我在调度调用中得到 nil （我想我在这里丢失数据），我尝试使用 performselectoronMainthread 方法..但我不知道如何将它与多个参数一起使用..

任何想法谢谢..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T11:12:43.487

我将其发布为答案，因为很难将其放入评论中，但是如果您使用`performSelectorOnMainThread:withObject:waitUntilDone:`，您可以将您的两位信息包装到字典（或数组，但字典效果更好，因为您可以访问信息按名字）：

```
NSDictionary *info = @{ @"name" : @(name), @"user_id", @(user_id) };
[self performSelectorOnMainThread:@selector(someMethod:) withObject:info waitUntilDone:NO]; 
```

然后在您的方法中（仅 iOS 6，除非您恢复到 oldschool `objectForKey:`）：

```
- (void) someMethod:(NSDictionary *) info
{
    NSString *name = info[@"name"];
    NSNumber *user_id = info[@"user_id"];

    // unbox name and user_id if necessary
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T11:14:37.750

您的问题可能是`interface_fun`返回后，指向的对象`name`已被释放。

您应该复制`name`到一个局部变量，然后在块的末尾释放该变量。（如果您使用 ARC，则为自动）。像这样的东西：

```
NSData *data = [NSData dataWithBytes:name length:strlen(name)+1];
dispatch_async(dispatch_get_main_queue(), ^{
  gui_acton_with_name((char*)[data bytes], user_id);
}); 
```

如果你使用 ARC，你也可以`name`作为`NSString*`or传入`NSData*`。在这种情况下，内容将被保留，直到您的块完成。

# html - 在 iOS 上打开 PDF 时在选项卡上显示标题的问题

> ID：14356830
> 
> 赞同：0
> 
> 时间：2013-01-16T11:01:36.227
> 
> 标签：html, ios, ipad, pdf, mobile-safari

有谁知道是否有办法强制 iOS 移动 Safari 显示 pdf 的文件名而不是选项卡中的 URL？我们网站上有一些 PDF 没有存储“标题”元数据，因此当您在移动 Safari 中打开它们时，选项卡只会显示一个数字，即 URL 的末尾。

或者如果没有，有没有办法规定浏览器应该显示什么作为标签标题？

任何帮助都会很棒

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T07:18:42.363

没有办法做到这一点，对不起。

# java - Java中的DatacontractSerializer

> ID：14356832
> 
> 赞同：3
> 
> 时间：2013-01-16T11:01:39.083
> 
> 标签：java, .net, xml-serialization, datacontractserializer, xmlserializer

Java中是否有可以反序列化由DataContractSerializer序列化的.net对象的方法或库？

我的情况：

我想创建一个可以通过 http 与 Microsoft MQ (MSMQ) 通信的 java 客户端。我想在 .Net 中使用 DataContractSerializer，在 Java 中使用 Serializer，以便 .Net 可以读取由 java 序列化的消息内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-16T08:04:57.783

我的解决方案是使用 jackson json 序列化程序。此外，我使用 Bson4jackson 库来序列化字节数组。这对我来说是一个快速的解决方案。

在.net 方面，我使用带有 BsonWriter/Reader 的 NewtonSoft Json 序列化程序（也反序列化）来接收和发送消息。

# java - 更改 wsimport 绑定文件以指向本地资源

> ID：14356835
> 
> 赞同：1
> 
> 时间：2013-01-16T11:01:51.623
> 
> 标签：java, maven

我目前正在一个项目中工作，我们希望使用 Maven 的 jaxws-maven-plugin 自动生成 Web 服务客户端。目前，Web 服务客户端是使用用于 Web 服务客户端生成的 IBM RAD 8.0 内部工具生成的。

这很好用，但是随着 Web 服务数量的增加，这个过程变得太慢了。虽然我们可以让 Maven 插件在客户端项目中生成 Java 类并在本地服务器的本地开发中使用它们，但当我们尝试部署它时，Web 服务的验证失败。这是由于服务器基础设施，当测试在每台服务器上成功运行时，项目需要逐步通过测试、阶段和生产服务器，并进一步部署。

部署后，Websphere Portal Servr 尝试根据包中生成的绑定 Java 文件中给出的 WSDL 定义来验证生成的 Web 服务客户端。运行 maven 插件时，会产生以下绑定：

**我的项目HttpService**

```
 static {
    URL url = null;
    WebServiceException e = null;
    try {
        url = new URL("http://localhost:9080/MyProjectWeb/sca/MyProjectExportWS?wsdl");
    } catch (MalformedURLException ex) {
        e = new WebServiceException(ex);
    } 
```

因为生成的 Web 项目需要从同一个 EAR 文件在每台服务器上运行，所以我们无法在服务器之间更改 WSDL 文件中的 URL。

RAD 的导入工具会生成一个绑定文件，该文件使用类加载器来获取文件：

**我的项目HttpService**

```
static {
    URL url = null;
    try {
        url = com.my.package.portal.MyProjectHttpService.class.getResource("/WEB-INF/wsdl/project/interfaces/MyProjectExport1.wsdl");
        if (url == null) throw new MalformedURLException("/WEB-INF/wsdl/project/interfaces/MyProjectExport1.wsdl does not exist in the module.");
    } catch (MalformedURLException e) {
       ...
    } 
```

In order to find a solution we went as far as writing our own Maven plugin that downloads the XSD and WSDL files and puts them in the build package, so they could be used to generate the web service client with the wsimport plugin afterwards, but using instead of . However, this was not successull as well, as the binding file would be produced with an absolute path:

```
 static {
    URL url = null;
    WebServiceException e = null;
    try {
        url = new URL("file:/D:/mavenworkspace/testproject/target/META-INF/wsdl/com/my/package/portal/ws/interfaces/MyProjectExport1.wsdl");
    } catch (MalformedURLException ex) {
        e = new WebServiceException(ex);
    }
  } 
```

Any help on how we can resolve the problem would be welcome. We don't really care on how we can achieve the result of having all of the XSD and WSDL file inside our jar, being referenced relatively, so the environment doesn't matter when the webserver tries to validate the web service client.

PS: Sadly, we also cannot use multiple profiles for the different environments.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T12:22:25.843

After some trying I was finally able to resolve our problem. We came onto the right track by this blogpost (and the ones linked in it): [http://blog.vinodsingh.com/2008/12/locally-packaged-wsdl.html](http://blog.vinodsingh.com/2008/12/locally-packaged-wsdl.html)

We ended up with a custom solution which combines a new maven plugin and usage of the wsimport plugin. Our own plugin does some preliminary work by downloading all .wsdl and .xsd files for a given URL. I am not allowed to share the code, but I want to give some hints on how our plugin works, so that anybody in the same situation as us can hack a fitting plugin ;)

This is the build part of the pom file of the project that becomes our web service client:

```
<build>
    <plugins>
        <plugin>
            <groupId>com.my.company</groupId>
            <artifactId>wsdl-import</artifactId>
            <version>0.0.1-SNAPSHOT</version>
            <executions>
                <execution>
                    <goals>
                        <goal>wsdlimport</goal>
                    </goals>
                </execution>
            </executions>
            <configuration>
                <wsdlUrls>
                    <wsdlUrl>http://serveraddress/MYWEBSERVICEMODULE/WEBSERVICe?wsdl</wsdlUrl>
                </wsdlUrls>
            </configuration>
        </plugin>
        <plugin>
            <groupId>org.jvnet.jax-ws-commons</groupId>
            <artifactId>jaxws-maven-plugin</artifactId>
            <version>2.2</version>
            <configuration>
                <target>2.1</target>
                <keep>true</keep>
            </configuration>
            <executions>
                <execution>
                    <phase>generate-sources</phase>
                    <goals>
                        <goal>wsimport</goal>
                    </goals>
                    <configuration>
                        <wsdlLocation>/wsdl/com/my/company/WEBSERVICEEXPORT.wsdl</wsdlLocation>
                        <wsdlUrls>
                            <wsdlUrl>${project.build.directory}/META-INF/wsdl/com/my/company/WEBSERVICEEXPORT.wsdl</wsdlUrl>
                        </wsdlUrls>
                    </configuration>
                </execution
            </executions>   
        </plugin>
    </plugins>
    <resources>
        <resource>
            <directory>${project.build.directory}/META-INF/</directory>
        </resource>
    </resources>
</build> 
```

Our plugin wsdlimport is build similar to the wsimport plugin. It takes a set of WSDL files in the tag. Each wsdl file is downloaded and the resulting document parsed using XPath. For each XML node that is either an "xsd:import" or "xsd:include" element, the path of the schema location is extracted and the parsed for further nodes that include (other) XSD files. What you need to look out for are nodes that reference other elements that are not simple types:

```
<xsd:element maxOccurs="unbounded" minOccurs="0" name="persons" type="bons1:BOPerson">
<xsd:element maxOccurs="unbounded" minOccurs="0" name="names" type="xsd:string"> 
```

Such elements have another namespace than simple types, which are in the xsd namespace. In our case, we have custom namespaces bons1 and bons2 (I guess BO-Namespace 1 and 2) for our BOs.

The plugin is configured to place all wsdl files in the target directory in a folder "META-INF/wsdl/packagepath/"

After that, the normal wsimport plugin takes over: We define to point to the path "/wsdl/packagepath/" (like above, but without the META-INF). As wsdlUrl we supply the local path to the downloaded WSDL file. This generates our java implementation.

Finally, for the downloaded and generated files to work, you need to define the META-INF folder as a resource so it is bundled into the output .jar file. By defining the META-INF folder, the WSDL and XSD files will be packaged with "/wsdl" being in the root directory of the .jar. That's why we defined the to be "/wsdl/packagepath/..." instead of "/META-INF/wsdl/packagepath/...".

I hope this helps to solve similar problems in the future.

# html - 如何将输入按钮向右移动？

> ID：14356836
> 
> 赞同：-1
> 
> 时间：2013-01-16T11:01:55.647
> 
> 标签：html, css

我有一个像这样定义的html

```
<table style="margin: auto;">
    <colgroup>
        <col width="85%">
        <col width="85%">
    </colgroup>
    <tr>
        <td> ...... </td>
    </tr>

    <tr>        
        <td><input type="submit" value="Add Log" /></td>
    </tr>
</table>
```

目前，按钮停留在左侧。我怎样才能把它移到右边？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T11:03:28.687

### CSS

```
td.right {text-align: right;} 
```

### HTML

```
<td class="right"><input type="submit" value="Add Log" /></td> 
```

### [小提琴](http://jsfiddle.net/vWVjQ/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T11:04:03.213

没有为您的表格指定宽度，因此它现在适合表格宽度。

添加`input{float:right}`到 css 或`align="right"`直接 td

喜欢`<td align="right"><input type="submit" value="Add Log" /></td>`

[**演示**](http://jsfiddle.net/wS5Rs/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-23T10:16:16.370

```
[type=submit]{

    margin-left: 121px;
    margin-top: 19px;
    width: 84px;
    height: 40px;   
    font-size:14px;
    font-weight:700;

} 
```

# php - imagemagick 不同的输出，相同的代码，不同的服务器

> ID：14356840
> 
> 赞同：0
> 
> 时间：2013-01-16T11:02:11.290
> 
> 标签：php, imagemagick, imagick

我有相同的代码，相同版本的 imagemagick，但第二台服务器的输出不同。它似乎缺乏透明的颜色。

服务器 1：[http ://webninjamobile.com/portfolio/canvas/Desert_Distorded.png](http://webninjamobile.com/portfolio/canvas/Desert_Distorded.png)

服务器 2：

> `http://54.252.104.61/uploads/perspective/NLuLUfqQvPnglG82aBtd.jpg`

相同的imagemagick版本。

代码

```
<?php
    error_reporting(E_ALL);
    $im = new Imagick('4.jpg');
    $im->setImageFormat('png');
    $d = $im->getImageGeometry();
    $w = $d['width'];  
    $h = $d['height']; 
    $im3 = new Imagick();
    $im3->newImage(1, $h, 'none','png');
    $im3->setImageVirtualPixelMethod(Imagick::VIRTUALPIXELMETHOD_TRANSPARENT);
    $im1 = $im->clone();;
    $im1->setImageVirtualPixelMethod(Imagick::VIRTUALPIXELMETHOD_TRANSPARENT);
    $im1->setImageMatte(true);
    $im1->cropImage(0, $h, 0, 0);
    $controlPoints = array(
                        0,0, 15,15, 
                        ($w-10),0, ($w-10),0, 
                        0,$h, 25,($h-20), 
                        ($w-10),$h, ($w-10),$h 
                        );
    $im1->distortImage(Imagick::DISTORTION_BILINEAR, $controlPoints, true);
    $im2 = $im->clone();
    $im2->setImageVirtualPixelMethod(Imagick::VIRTUALPIXELMETHOD_TRANSPARENT);
    $im2->setImageMatte(true);
    $im2->cropImage(10, $h, ($w-10), 0);
    $controlPoints2 = array(
                        0,0, 0,0, 
                        10,0,10,10, 
                        0,$h, 0,$h,
                        10,$h, 10,($h-10) 
                        );
    $im2->distortImage(Imagick::DISTORTION_BILINEAR, $controlPoints2, true); 
    $im4 = $im->clone();
    $im4->setImageVirtualPixelMethod(Imagick::VIRTUALPIXELMETHOD_TRANSPARENT);
    $im4->setImageMatte(true);
    $im4->cropImage($w, $h,$w-100,0);
    $image = new Imagick();
    $image->addImage($im1);
    //$image->addImage($im4);
    $image->addImage($im3);
    $image->addImage($im2);
    $image->resetIterator();
    $combined = $image->appendImages(false);
    $shadow = $combined->clone(); 
    $shadow->setImageBackgroundColor( new ImagickPixel( 'black' ) ); 
    $shadow->shadowImage( 50, 3, 5, 5 ); 
    $shadow->compositeImage( $combined, Imagick::COMPOSITE_OVER, 0, 0 ); 
    $shadow->writeImage('Desert_Distorded.png');
   // echo '<img src="http://webninjamobile.com/portfolio/canvas/Desert_Distorded.png" />'; 
```

# sql - 复杂的表合并场景，涉及3个表和自引用

> ID：14356844
> 
> 赞同：0
> 
> 时间：2013-01-16T11:02:23.043
> 
> 标签：sql, sql-server, tsql, ssis

```
Source Table 

TableSource

SOurceID  Name   ParentId

Target Table

TableTarget

RefId ParentRefId SourceId  Name 
```

-- RefId 是来自 TableReference 的外键

```
Table Reference 

TableReference

RefID -- Auto increment IdentityCOlumn 
```

设想

需要以这样的方式合并（插入/更新）TableSource 和 TableTArget

```
1\. On Each insert into TableTarget, it should insert a new RefId into TableReference and then Copy that RefId into TableTarget's RefId Column. 

2.ParentRefId also needs to be populated on the basis of ParentID in TableSource I-E 
```

TableSource --假设TableSource开头有以下记录

```
SOurceID  Name         ParentId
1A         Group1       NULL
2B         GROUP2       NULL
3C         Department1   1A
4D         Department2   2B
5E         Section1      3C
6F         Section2      4D

-- I want to see TableTarget as following

RefId     SourceId     Name                ParentRefId 

1         1A           Group1              NULL as Group1 doesn't has a parent
2         2B           GROUP2              NULL as Group1 doesn't has a parent
3         3C           Department1         1 -- SourceID 3C's Parent is 1A and RefID of   1A is 1
4         4D           Department2         2 -- SourceID 4D's Parent in TableSOurce is   2B so we need to find the RefId of 2B in TableTarget to insert it here. That's 2
5         5E           Section1            3 -- PArent of 5E is 3C and RefId of 3C is 3
6         6F           Section2            4 -- PArent of 6F is 4D and RefID of 4D is 4 
```

解决方案：

Name 和 SourceID 的合并不是问题。当我们需要在 TableReference 中为每个插入 TableTarget 的新 RefID 插入一个新的 RefID，然后复制它并将其插入到 tableTarget 时，问题就开始了。第二个问题是如何填充 ParentRefID。任何有关这方面的意见将不胜感激

*** 最好的方法是什么 ** 我们需要游标吗？我们是否应该先用 RefID 加载它们并在加载它们之前处理 ParentRefId？***

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T23:45:35.013

我会推荐一个两次通过的解决方案，在第一次通过时将 ParentRefID 保留为空。除了通过 RBAR 方法外，没有任何方法可以一次性使用 tableTarget 表中刚刚插入的数据来“查找”父项的引用 ID。

所以：

插入参考：

```
insert into tblReference select * from tblSource /* or whatever columns you want */ 
```

使用新的 RefID 插入目标，将 parentRefID 保留为空：

```
insert into tblTarget select tblReference.refID, tblSource.SourceID, tblSource.Name, NULL as parentRefID from tblSource inner join tblReference on <-- whatever columns link reference and source tables --> 
```

使用 parentRefID 批量更新目标：

更新 tblTarget set parentRefID = target_parent.refID from tblSource 内部连接 ​​tblTarget target_parent on target_parent.sourceID = tblSource.parentID 内部连接 ​​tblTarget on tblTarget.sourceid = tblSource.sourceID

不，您不能只使用 MERGE，因为您不能在 MERGE 批处理中使用新插入的数据来传递给后续的插入/更新。

# c# - 规则/验证设计模式

> ID：14356851
> 
> 赞同：4
> 
> 时间：2013-01-16T11:02:36.723
> 
> 标签：c#, design-patterns

什么设计模式可以用来为象棋这样的游戏创建规则/验证系统（这只是一个简单的例子，实际的游戏需要更难的规则集）

我已经阅读了这个网站上的几个问题，但没有找到结论性的答案，也没有找到正确方向的答案。

该系统将需要以下内容：

*   每个应用了规则的对象都应该使用一个方法实现一个特定的接口，该方法是验证的起点
*   该规则应该分两步应用：首先，它需要验证（可以将棋子A移动到方块D4），如果为真则执行方法A 如果为假则执行方法B
*   每个对象都可以有多个规则，需要按特定顺序应用。规则 1 完成后，规则 2 应开始验证等
*   每个单独的规则（例如：只能移动 1 个方格，只能沿对角线移动等）必须属于自己的类，并且必须可重用并适用于需要规则的对象。
*   请注意，这将用于后端的多人游戏
*   请注意，每条规则都需要多个对象来测试其有效性，例如，通常一个棋子可以移动 1 个方格，现在游戏板上的下一个方格由对手的棋子填充。结果：你的棋子不能移动。棋子应包括其他棋子位置，或在其验证中的游戏板。

这些规则的另一个词是行为限制。

我还在 gamedev.stackexchange 上发布了这个问题，但由于这不是一个与游戏相关的问题，而且似乎没有人有答案，所以我也将它发布在这里。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-16T17:30:17.190

我越是关注问题，就越会想起状态/流程图。

![在此处输入图像描述](../Images/308b83ecd83403b73173edf56815fac0.png)

> *   每个应用了规则的对象都应该使用一个方法实现一个特定的接口，该方法是验证的起点
>     
>     
> *   该规则应该分两步应用：首先，它需要**验证**（可以将棋子A移动到方块D4），如果为真则**执行**方法A 如果为假则执行方法B

状态对象可以包含多个转换。

过渡包括：

1.  条件）
2.  行动

> *   每个对象都可以有**多个**需要按**特定顺序**应用的规则。规则 1 完成后，规则 2 应开始验证等

通过使用状态图，您可以通过状态和状态转换获得多个规则和特定的动作序列

> *   每个单独的规则（例如：只能移动 1 个方格，只能沿对角线移动等）必须属于自己的类，并且必须可重用并适用于需要规则的对象。

这可以通过将条件检查行为封装为一个类来实现

```
public class Condition 
{
    public string Name {get; set;}
    public Func<Move,bool> IsMet {get;set;} 
}

// Captures the behaviour of moving diagonally by 1-step
// This can now be referenced/composed by other classes to build
// a more complex condition
var moveDiagonalCondition = new Condition 
{ 
    Name="Move diagonal", 
    IsMet = move => 
                    {
                        var delta = (move.ToPosition - move.FromPosition);
                        // 1 step to the left or right
                        return Math.Abs(delta.X) == 1 
                        // 1 step upwards (if player),
                        // or 1 step downwards (if opponent)
                        && delta.Y == move.IsPlayer1Move ? -1 : 1
                    }
} 
```

> *   请注意，这将用于后端的多人游戏
>     
>     
> *   请注意，每条规则都**需要多个对象**来测试其有效性，例如，通常一个棋子可以移动 1 个方格，现在游戏板上的下一个方格由对手的棋子填充。结果：你的棋子不能移动。棋子应包括其他棋子位置，或在其验证中的游戏板。

在国际象棋场景中，我建议传递`move`参数：

```
public class Move
{
    public Point FromPosition {get;set;}
    public Point ToPosition {get;set;}
    public Piece Piece {get;set;}
} 
```

同时，各州应该可以访问整个 GameBoard。这允许国家做一些事情，比如

```
// Check for empty cell
GameBoard.GetPieceAt(move.ToPosition) == null;

// Check for opponent's piece
GameBoard.GetPieceAt(move.ToPosition).IsPlayer2; 
```

为了进一步将此扩展到您的 MMORPG 场景，我将通过参数传递任何“源”和/或“目标”

*   即碰撞源/目标，或任何直接受影响的对象

* * *

# 结论

与状态问题如此相似，我认为查看基于状态的解决方案是个好主意。

例如，[状态模式](http://en.wikipedia.org/wiki/State_pattern)、有限状态机、状态转换表、自动机等。

或者您可以尝试查找决策表和决策树*（我自己并没有真正使用过这些，所以我无法对它们多说）*。

不幸的是，我认为我不能推荐一个确切的解决方案。

但希望上面的几个示例/关键字可以帮助您入门。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T12:31:59.353

我认为[策略模式](https://www.codeproject.com/Articles/52807/Design-Patterns-Part-The-Strategy-Pattern)可能是您正在寻找的，它比 HuorSwords 建议的规范模式更轻，如果您正在寻找更容易上手的东西。

您希望使用的规则可以抽象为策略，然后酌情插入每个部分。

每个规则都可以保存在它自己的类中。

每个策略都可以建立一个规则列表，按照您的要求按顺序应用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-16T11:18:26.920

我正在考虑解决您的问题的[规范模式](http://martinfowler.com/apsupp/spec.pdf)方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-16T12:01:11.550

这就是我设计它的方式。（可能对应于某些设计模式，也可能不对应）。

```
abstract class Rule<T>
{
    protected abstract bool implementRule(T on, GameWorld gw);

    protected abstract void doIfTrue();

    protected abstract void doIfFalse();

    public void runRule(T on, GameWorld gw)
    {
        if (implementRule(on, gw))
        {
            doIfTrue();
        }
        else
        {
            doIfFalse();
        }
    }

} 
```

然后，假设你有一些名为 pawn 的类/接口，它有一个 getX() 方法，你可以做类似的事情

```
class RuleImpl : Rule<Pawn> // note T is now Pawn
{

    protected override bool implementRule(Pawn on, GameWorld gw) {
        if(on.getX()<gw.getX()){
            return true;
        }

        return false;
    }

    protected override void doIfTrue()
    {
        Console.WriteLine("true");

    }

    protected override void doIfFalse() {
        Console.WriteLine("false");

    }
} 
```

编辑：自然 Pawn 可以而且应该更改为类似`ThingsThatHaveAnXValue`. 但为了代码清晰，我保持原样

# c++ - 我的简单阶乘计算器 C++ 程序有问题吗？

> ID：14356854
> 
> 赞同：1
> 
> 时间：2013-01-16T11:02:41.530
> 
> 标签：c++

半小时前，我做了一个简单的阶乘计算器，它以非零整数作为输入。在测试了一些值之后，我注意到它只能在 12 点之前正常工作！

我已经有几个月没有编程了，老实说，我仍然是一个初学者。我决定使用递归，这样我就可以更快地回到“编程模式”（我的偏好）。

我检查并修改了将近一个小时。我真的不知道我的算法有什么问题。

这是我的代码：

```
#include <iostream>

using namespace std;

int factorial(int);

int main()
{
    int usrInput = 0;   //initialize input variable
    cout << "Please input the factorial you want to calculate: ";
    cin >> usrInput;
    while(usrInput < 1)
    {
        cout << "Please input a valid number: ";
        cin >> usrInput;
    } //end while
    cout << "\nAnswer: " << factorial(usrInput) << '\n';
    return 0;
}

int factorial(int n)
{
    int product = n;
    if(n < 2)
        product = 1;
    else
    {
        product *= factorial(n-1);
    cout << "\n" << product; //debugging line
    } //end if else
    return product;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T11:06:15.727

您超出了 int 的限制。13！= 6227020800，int 仅涵盖 -2147483648 .. 2147483647。使用更大的类型（例如 __int64）、双精度（但您会失去精度）或实现（或使用）大数字库。

# bash - 如何在 tmux 窗格标题中显示当前命令

> ID：14356857
> 
> 赞同：5
> 
> 时间：2013-01-16T11:02:50.030
> 
> 标签：bash, tmux

我想用当前正在执行的命令更新 tmux 窗格标题，或者如果没有命令，则使用当前 shell 的名称。到目前为止，我在 bashrc 中想到的是：

```
case ${TERM} in

  screen*)       
    PROMPT_COMMAND='printf "\033]2;bash\033\\"'
    set -o functrace
    trap 'echo -ne "\033]2;$BASH_COMMAND\033\\"' DEBUG
    ;;

   ...

esac 
```

该方法来自这里： [http ://www.davidpashley.com/articles/xterm-titles-with-bash.html](http://www.davidpashley.com/articles/xterm-titles-with-bash.html)

这部分有效 - 它完成了所需但会导致其他问题：新 shell 中的第一个提示以

```
"'"' DEBUG" 
```

以及所有剩余的命令

```
" 
```

它还可以防止命令行中给出的某些命令失败，例如：

```
$ ps -h $$
Warning: bad ps syntax, perhaps a bogus '-'? See http://procps.sf.net/faq.html 
```

因此，虽然上面确实允许在 tmux 窗格标题中显示当前命令，但它不起作用。有没有其他人对此有更好的解决方案，或者关于上述问题的建议？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-18T10:00:50.980

这是每次在 BASH 中执行命令时更新 tmux 窗格标题的一种方法。将如下代码放入`~/.bashrc`：

```
case ${TERM} in

    screen*)

        # user command to change default pane title on demand
        function title { TMUX_PANE_TITLE="$*"; }

        # function that performs the title update (invoked as PROMPT_COMMAND)
        function update_title { printf "\033]2;%s\033\\" "${1:-$TMUX_PANE_TITLE}"; }

        # default pane title is the name of the current process (i.e. 'bash')
        TMUX_PANE_TITLE=$(ps -o comm $$ | tail -1)

        # Reset title to the default before displaying the command prompt
        PROMPT_COMMAND=${PROMPT_COMMAND:+$PROMPT_COMMAND; }'update_title'   

        # Update title before executing a command: set it to the command
        trap 'update_title "$BASH_COMMAND"' DEBUG

        ;;

        ... other cases for different terminals ...

esac 
```

}

该函数`update_title`打印更改 tmux 窗格标题的转义序列。它将窗格标题设置为默认值（的值`$TMUX_PANE_TITLE`）或作为参数给出的任何内容。

该功能`title`是为了最终用户的方便：它更改默认标题的值`$TMUX_PANE_TITLE`。最终用户可以随时通过执行以下操作将标题更改为他们想要的任何位置：

```
$ title my new pane title 
```

初始标题设置为正在运行的 shell 的名称（即“bash”）。

Bash 在`$PROMPT_COMMAND`显示提示之前执行任何操作。设置此项是为了`update_title`在每次提示之前执行该函数，以将提示设置为默认标题。

陷阱会导致 Bash`$BASH_COMMAND`在执行任何命令之前执行。它被设置为在每个命令之前执行该`update_title`函数以将提示设置为该命令的文本。

其他注意事项

*   在解决这个问题时，我发现`set -o functrace`or `set -T`（如问题中相关人员所述）导致 RVM 中断。建议它的原因是允许在子shell 中更改提示，但缺少这个对我来说不是问题。

*   为了获得最初的标题，我想使用更简洁的`ps -ho comm $$`，但这似乎在 tmux 中不起作用。我不确定为什么要选择其他有效的方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-30T19:16:25.213

我不确定是否可以将其设置为窗格的标题（如果还没有的话）（看起来在我的 tmux 1.8 上它已经将命令声明为窗格的标题），但是有一个未记录的`#{pane_current_command}`变量您可以在包含命令的状态栏字符串中使用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-06-30T15:13:10.720

作为替代方案，您可以使用这个单行函数在 tmux 中为您的命令添加前缀：

```
panewrap () { printf "\033]2;%s\033\\" "$1"; "$@"; } 
```

它将窗格标题设置为启动命令（`$1`-命令名称）并将其执行传递给终端（`$@`-命令名称及其所有参数）。

不便之处在于您必须在任何命令之前添加一个额外的单词前缀，但我偶尔会这样做，仅当命令打算运行一段时间（例如，tail）时。

# java - JTable CTRL+C 事件的名称是什么？

> ID：14356859
> 
> 赞同：1
> 
> 时间：2013-01-16T11:02:59.003
> 
> 标签：java, swing, events, jtable, clipboard

我正在开发一个 Java 应用程序，当我在 jTable 上按 CTRL+C 时，我可以获取剪贴板并将其粘贴到 Excel 中。我想实现一个做同样事情的按钮。我怎样才能得到函数，监听器，无论我用什么来实现这个？

PS：我尝试过查看其他问题，但似乎没有人在寻找我想要的东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-16T17:18:41.097

表的复制操作的关键是`"copy"`：

```
Action copyAction = table.getActionMap().get("copy"); 
```

但我没有看到一种有用的方法来回收`Action`：

```
JButton button = new JButton(copyAction); 
```

相反，只需将表的当前选择导出到系统剪贴板。

```
JFrame f = new JFrame("Test");
f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
TableModel model = new DefaultTableModel(
    new Object[][]{{"Some"}, {"More"}}, new Object[]{"Name"});
final JTable table = new JTable(model);
table.getSelectionModel().setSelectionInterval(0, 1);
f.add(table);
f.add(new JButton(new AbstractAction("Export") {

    @Override
    public void actionPerformed(ActionEvent e) {
        Clipboard clipboard = Toolkit.getDefaultToolkit().getSystemClipboard();
        table.getTransferHandler().exportToClipboard(
            table, clipboard, TransferHandler.COPY);
        Transferable contents = clipboard.getContents(null);
    }
}), BorderLayout.SOUTH);
f.pack();
f.setLocationRelativeTo(null);
f.setVisible(true); 
```

附录：此变体依赖于[`TableTransferable`](https://stackoverflow.com/a/15283824/230513).

```
final DefaultTableModel model = new DefaultTableModel(
    new Object[][]{
    {"A1", "A2", "A3", "A4", "A5"},
    {"B1", "B2", "B3", "B4", "B5"},
    {"C1", "C2", "C3", "C4", "C5"},
    {"D1", "D2", "D3", "D4", "D5"},
    {"E1", "E2", "E3", "E4", "E5"},
    {"F1", "F2", "F3", "F4", "F5"}
},
    new Object[]{"1", "2", "3", "4", "5"});
JFrame f = new JFrame("Test");
f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
final JTable table = new JTable(model);
table.getSelectionModel().setSelectionInterval(0, 1);
f.add(table);
f.add(new JButton(new AbstractAction("Export") {
    @Override
    public void actionPerformed(ActionEvent e) {
        Clipboard cb = Toolkit.getDefaultToolkit().getSystemClipboard();
        cb.setContents(new TableTransferable(model), new ClipboardOwner() {
            @Override
            public void lostOwnership(Clipboard clipboard, Transferable contents) {
                System.out.println("Clipboard lost!");
            }
        });
    }
}), BorderLayout.SOUTH);
f.pack();
f.setLocationRelativeTo(null);
f.setVisible(true); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-08T04:04:56.557

> 但我没有看到回收动作的有用方法：

您不能以这种方式使用 Action，因为 Action 的来源是按钮而不是表格。

有关通用解决方案，请参阅[动作映射动作](http://tips4java.wordpress.com/2008/12/06/action-map-action/)。使用提供的类，代码将是：

```
Action copyAction = new ActionMapAction("Copy Table", table, "copy");
JButton copyButton = new JButton(copyAction); 
```

# ruby-on-rails - Rails 从两个表连接：如何选择属性

> ID：14356865
> 
> 赞同：1
> 
> 时间：2013-01-16T11:03:10.650
> 
> 标签：ruby-on-rails, join, model, associations, rails-activerecord

在 Rails 3.2.1 中

我有：

```
class Project < ActiveRecord::Base
  attr_accessible :name, :description
  has_many :subprojects
end

class SubProject < ActiveRecord::Base
  attr_accessible :id_name, :description, :num_alloc, :project_id
  belongs_to :projects
end 
```

我如何在 rails 控制器中返回一个包含“名称”属性（来自 Project 模型）和`id_name`, `description`and `num_alloc`（来自 SubProject 模型）的对象。

在控制器中，如果我让

```
@results=  SubProject.joins('LEFT OUTER JOIN.......) 
```

`@results`只包含 SubProject 类的属性，因为`SubProject.joins(...)`返回一个`SubProject`对象，对吗？

那么如何从两个模型返回具有属性的对象呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-16T11:16:48.910

```
@subproject = SubProject.select("subprojects.id_name, subprojects.description, subprojects.num_alloc, projects.name").joins("LEFT OUTER JOIN projects ON projects.id = sub_projetcs.project_id") 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-16T11:17:53.057

如果您只想使用一个对象来避免多个 SQL 查询（还有什么其他原因？），您可以这样做：

```
@results = SubProject.includes(:projects).where(...) 
```

然后你可以做

```
@results.first.projects.name 
```

这不会触发新的 SQL 查询。

此外，如果您在 SubProject 定义中添加一行

```
class SubProject < ActiveRecord::Base
  delegate :name, :to => :projects, :prefix => true
  ...
end 
```

然后你可以写：

```
@results = SubProject.includes(:projects).where(...)
@results.first.projects_name 
```

因此，正如您所要求的，您实际上*有一个具有两个模型属性的对象。*

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-16T11:29:38.900

我将从您的模型定义开始：您的`has_many`关联名称中需要有一个下划线 - `SubProject -> sub_project`：

```
class Project < ActiveRecord::Base
 attr_accessible :name, :description
 has_many :sub_projects # !
end 
```

接下来，您`belongs_to`需要采用单数形式：

```
class SubProject < ActiveRecord::Base
  attr_accessible :id_name, :description, :num_alloc, :project_id
  belongs_to :project # !
end 
```

进行这些更改后，您可以查询：

```
@sub_projects = SubProject.includes(:project).all
name = @sub_projects.first.project.name
... 
```

# php - php mail() 函数检测为垃圾邮件

> ID：14356866
> 
> 赞同：0
> 
> 时间：2013-01-16T11:03:10.507
> 
> 标签：php

我在我的网站中使用简单的邮件功能作为联系表。

```
$name = stripslashes($_POST['name']);
$email = trim($_POST['email']);
$text = stripslashes($_POST['message']);

$message = '<html><body>'.nl2br($text)."</body></html>";
$mail = mail("info@domain.com", "Contact Form", $message,
     "From: ".$name." <".$email.">\r\n"
    ."Reply-To: ".$email."\r\n"
    ."X-Mailer: PHP/" . phpversion()
    ."MIME-Version: 1.0\r\n"
    ."Content-Type: text/html; charset=utf-8"); 
```

电子邮件已发送，但始终被检测为垃圾邮件，这是不好的。可能是因为“FROM”是访问者在表单中提供的电子邮件。

如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T11:11:39.943

不要使用用户的电子邮件地址作为`From`标题。它会给您与垃圾邮件过滤器不一致的结果，并且在您的情况下，它会引入标头注入漏洞。而是使用有效的静态邮箱（实际存在 - 最好与您发送邮件的域相同）。

您错过了`\r\n`某些标题上的后缀，即`X-Mailer`and `Content-type`。

我建议检查您的服务器的 IP 地址，它可能被列入黑名单或列为垃圾邮件，这将导致一些垃圾邮件过滤器自动拒绝或转储垃圾文件夹中的所有内容。在共享主机上可能会出现这种情况，即使您从未从自己的包裹中发送过垃圾邮件，服务器上的其他主机帐户也可能有。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T11:06:46.523

检查此链接到 StackOverflow 上的帖子：[https](https://stackoverflow.com/a/2573286/1983368) ://stackoverflow.com/a/2573286/1983368 垃圾邮件主要是从接收端检测到的。

# uitableview - 如何从 UITableview 的选定行中获取 cell.label.text 值？

> ID：14356869
> 
> 赞同：2
> 
> 时间：2013-01-16T11:03:18.633
> 
> 标签：uitableview, ios6

我是 iOS 应用程序开发的新手，我需要有关 UItableview 的帮助。当我用 json 数据填充表视图时。我也在使用自定义的 Tableviewcell。我没有在“lbluid”上获得选定单元格的“huid”值。“lluid”根据滚动显示“huid”的值，因为我将向上滚动它将显示 UITableview 最上面可见单元格的“huid”值，如果我向下滚动它将显示最后的“huid”值从下可见的细胞。

```
- (UITableViewCell *)tableView:(UITableView *)tableView
     cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *simpleTableIdentifier = @"SimpleTableCell";
    SimpleTableCell *cell = (SimpleTableCell *)[tableView dequeueReusableCellWithIdentifier:simpleTableIdentifier];
    if (cell == nil)  {
        NSArray *nib = [[NSBundle mainBundle] loadNibNamed:@"SimpleTableCell" owner:self options:nil];
        cell = [nib objectAtIndex:0];;
    }

    NSUInteger row = [indexPath row];

    cell.lbl4.text = [hudid objectAtIndex:row];
    lbluid.text=cell.lbl4.text;
    return cell;
} 
```

`Simpletablecell`是定制的`UITableViewCell`。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-16T13:19:33.203

您可能必须实现该方法：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath 
```

每次选择一行时都会调用它，并且在该方法内部：

```
Simpletablecell *cell = (Simpletablecell *)[tableView cellForRowAtIndexPath:indexpath];
lbluid.text = cell.lbl4.text; 
```

方法：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath 
```

称为表格视图正在加载要显示的单元格，这就是为什么您`lbluid.text`仅在滚动表格视图时才更改的原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-12-26T12:00:04.393

在斯威夫特

```
func tableView(_ tableView: UITableView, didSelectRowAt indexPath: IndexPath) {

       let cell = tableView.cellForRow(at: indexPath) as! NotesCell!
        let value = cell?.lblDetail.text
    } 
```

# java - 匹配特定索引

> ID：14356870
> 
> 赞同：0
> 
> 时间：2013-01-16T11:03:19.543
> 
> 标签：java, regex, string, pattern-matching, match

> **可能重复：**
> [在java中的字符串中查找子字符串的第n次出现？](https://stackoverflow.com/questions/5678152/find-the-nth-occurence-of-a-substring-in-a-string-in-java)

有没有办法在字符串中获得特定匹配？

如果我们有`String test = "this is a long test which is a test of a test";`那么我们可以`Matcher`用来获取**第二个**（或任何特定的）实例`test`吗？

我以为我可以使用`Matcher.find(x)`，但这似乎不太好用......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T11:06:43.453

尝试

```
int firstIndex = string.indexOf("test");
if (firstIndex >= 0) {
    int secondIndex = string.indexOf("test", firstIndex+1);
} 
```

此外，如果您想要第 n 次出现，您可以进行循环：

```
int nthIndex = -1;
for (int i=0; i<n; i++ ) {
    nthIndex = string.indexOf("test", nthIndex +1);
    if (nthIndex < 0) {
        break;
    }
} 
```

这将为您提供 nthIndex，如果未找到，则为 -1。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T11:12:57.513

我认为这个功能可以完成这项工作

```
int find(String s, String pattern, int occurence) {
    Matcher m = Pattern.compile(pattern).matcher(s);
    for (int i = 1; m.find(); i++) {
        if (i == occurence) {
            return m.start();
        }
    }
    throw new RuntimeException();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T11:06:50.770

您可以使用`indexOf`方法来执行此操作。

```
 String string;
    int one = string.indexOf(strToBeSearched);     
    int two = string.indexOf(strToBeSearched, one+1); 
```

此外，您应该检查是否`one`> = 0（如果`strToBeSearched`字符串中不存在，`indexOf`将返回-1）

# c# - 将文件上传到网络驱动器文件夹

> ID：14356874
> 
> 赞同：0
> 
> 时间：2013-01-16T11:03:32.507
> 
> 标签：c#, asp.net-mvc-3, impersonation

**我的服务器机器包括：**

1.  IIS 7。
2.  窗口服务器 2008。
3.  网络驱动器映射为 Linux 机器的 Z 驱动器。
4.  托管在服务器计算机上的 ASP.NET MVC 3 应用程序。

**问题：**

我已经构建了 asp.net mvc 3 应用程序，该应用程序可以将多个文件上传到本地驱动器，但无法上传到服务器机器的网络驱动器（在我的情况下为 Z:/）。它显示错误：

```
Could not find a part of the path 'Z:\uploadfolder\sdlkfjsdl.wav'. 
```

然后，我检查了网络服务用户没有完全控制或写入权限的文件夹 (uploadfoler) 安全选项。这里的问题是我无权为 NETWORK SERVICE 用户添加权限，并且网络驱动器属于 LINUX 机器。

在寻找替代解决方案时，我发现了一个叫做模拟的概念。我对这个概念完全陌生。这能够解决我在我的场景中的问题吗？或者，还有其他替代解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T11:11:37.720

您的应用程序应在单独的 IIS 应用程序池中运行。在 IIS 中，您可以将用户分配到应用程序池。此用户应具有对网络驱动程序的写入权限。

请参阅[http://technet.microsoft.com/en-us/library/cc753842(v=ws.10).aspx](http://technet.microsoft.com/en-us/library/cc753842(v=ws.10).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T11:52:17.193

好的，Z:\ 是您的网络驱动器，但它是否位于托管 IIS 的机器上，没有任何网络驱动器映射？如果它在另一台机器上，您需要使用 UNC 路径（即 \server\path\folder\filename.ext），因为运行 IIS 的用户不会映射它。

您不会将用户“添加”到应用程序池...您将创建一个显式应用程序池，该应用程序池作为命名用户而不是网络服务或应用程序池标识运行。创建应用程序池时，您可以指定运行它的用户。对于特定版本的 IIS，您可以找到大量相关信息。

此命名用户需要权限才能写入/读取您配置的 UNC 路径。

# apache-poi - 通过 Apache-POI 将 Lotus Notes 富文本 mime 内容导出到 Word/Excel

> ID：14356876
> 
> 赞同：0
> 
> 时间：2013-01-16T11:03:38.593
> 
> 标签：apache-poi, xpages, mime

我创建了一个网页，并希望允许用户导出页面的内容。为此，我使用了 Apache-POI 库。这适用于文本。但是如何导出 mime 内容？如果我将富文本属性更改为“将内容存储为 html/mime”（因为我想在 Notes 中格式化内容，有时内容包含图像）。如果那是不可能的，那么 xpage 中有哪些可用的替代方案？

下面的代码将作为 xAgent 执行。

谢谢阿明

```
importPackage(java.io);
importPackage(org.apache.poi.hwpf);
importPackage(org.apache.poi.hwpf.usermodel);
importPackage(org.apache.poi.poifs.filesystem);

var docID = sessionScope.contentUNID;
var nv:NotesView = database.getView("(allByKey)");
var doc:NotesDocument = nv.getDocumentByKey(docID, true);

var fs:POIFSFileSystem = new POIFSFileSystem(new FileInputStream("empty.doc"));
var wdoc:HWPFDocument = new HWPFDocument(fs);
var wdRange:Range = wdoc.getRange();

wdRange.insertBefore(doc.getItemValueString("title"));
wdRange.insertAfter(doc.getMIMEEntity("content")); !!!doesn'twork

var extCont = facesContext.getExternalContext(); 
var pageResponse = extCont.getResponse();
var pageOutput = pageResponse.getOutputStream();

pageResponse.setContentType("application/vnd.ms-word");
pageResponse.setHeader("Cache-Control", "no-cache");
pageResponse.setHeader("Content-Disposition","inline; filename=export.doc");
wdoc.write(pageOutput);
pageOutput.flush();
pageOutput.close();

facesContext.responseComplete(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T11:14:48.353

您将需要使用`MIMEEntity`类的方法来获取内容。例如`doc.getMIMEEntity("content").getContentAsText()`. 为此，您可能需要`session.setConvertMIME(false)`在获取文档之前进行设置。

另一种方法是获取它，`RichTextItem`并`doc.getFirstItem("content")`使用`RichTextItem`类的方法来获取内容。在这种情况下，您不会设置`session.setConvertMIME(false)`.

# http-headers - 不同用户的 HTTP 标头“Persistent-Auth”不一致

> ID：14356890
> 
> 赞同：12
> 
> 时间：2013-01-16T11:04:08.800
> 
> 标签：http-headers, iis-7.5, windows-server-2008

我们有一个在 Windows 2008 上的 IIS 7.5 上运行的 ASP.Net 4.0 应用程序。我们的用户都在域上下文中运行 Windows XP 或 Windows 7。

用户使用 Windows 身份验证进行身份验证。

我们有两台似乎配置相同的服务器。`system.webServer/security.authentication/windowsAuthentication`：

```
authPersistNonNTLM = False
authPersistSingleRequest = False
enabled = True 
```

`system.webServer/security/authentication/anonymousAuthentication`：

```
enabled = False 
```

Beta 服务器似乎始终**`Persistent-Auth: true`**为所有用户返回，而生产服务器似乎始终`false`为某些用户返回。有两个开发人员的 PC 是同时构建的，使用相同的 OS 映像，他们的 ActiveDirectory 配置文件都以我为模型：**一个总是得到`false`，另一个总是得到`true`。**

这是一个问题，因为一些用户生成`Authenticate`: 标头 10k 长（我的大约 3k）。根据使用了应用程序的哪些部分，您可能无法在 16k 限制内安装 10k Auth 标头和所有潜在的会话 cookie。

**哪些设置可能导致 Persistent-Auth 标头因每个用户而异？**

# parameters - 如何让jMeter http请求采样器生成参数？

> ID：14356893
> 
> 赞同：23
> 
> 时间：2013-01-16T11:04:24.877
> 
> 标签：parameters, query-string, jmeter

有没有办法在 jMeter http 请求采样器或任何其他采样器中生成随机参数值？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-01-16T11:59:55.373

在 JMeter 中，您可以使用它`counters`来生成参数值。将您添加`counter`到测试计划的顶部并选择`initial`,`increment`和`maximum`值。它将自动开始计数。

`counter`在`Pre Processors`菜单中。您可以使用 HTTP 采样器中的计数器值`reference name`。即，假设您的参考名称是，**`ref_counter`**那么您可以在 HTTP 采样器中使用**`${ref_counter}`**.

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-01-16T13:37:21.827

您可以尝试使用[jmeter 的一些函数](http://jmeter.apache.org/usermanual/functions.html)来生成随机值：

*   [__Random](http://jmeter.apache.org/usermanual/functions.html#__Random)生成随机 int: `${__Random(MIN, MAX}`;
*   [__RandomString](http://jmeter.apache.org/usermanual/functions.html#__RandomString)生成随机字符串：`${__RandomString(LENGTH)}`;

以及用于相同目的的[随机变量配置元素。](http://jmeter.apache.org/usermanual/component_reference.html#Random_Variable)

# javascript - 带有jquery的容器下的单击事件

> ID：14356897
> 
> 赞同：0
> 
> 时间：2013-01-16T11:04:37.417
> 
> 标签：javascript, jquery, css, javascript-events

在此[示例](http://jsfiddle.net/A2ehc/6/)中，您会看到一个类似于苹果设备的选择器。

当您单击任何数字时，您会注意到父级捕获单击事件而不是子级。

这是因为选择器。Parent 有一个 before*伪选择器*，它在顶部创建一个新元素。

```
.date_subsel:before {
  content:"";
  position: absolute;
  width: 206px;
  height: 41px;
  margin-top: -2px;
  background-image: -webkit-linear-gradient(left, hsla(0, 0%, 0%, 0.25) 0%, hsla(0, 0%, 0%, 0.10) 25%, hsla(0, 0%, 0%, 0.0) 50%, hsla(0, 0%, 0%, 0.10) 75%, hsla(0, 0%, 0%, 0.25) 100%);
  border: 1px solid rgb(185, 185, 185);
  border-radius: 4px;
  -webkit-box-shadow: inset 0px 0px 8px hsla(0, 0%, 8%, 0.5), 0px 3px 5px hsl(0, 0%, 69%);
} 
```

我该如何处理这个并将点击事件重定向到它的孩子？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T11:20:56.750

不确定这是否是您所追求的......但只需在日期中添加一个位置属性即可。

```
 .date_subsel div > div {
      margin: 0 3px 0 3px;
      -webkit-box-flex: 1;
      border: 1px solid hsl(0, 0%, 68%);
      padding: 3px 8px 3px 8px;
      background-color: transparent; /* ------------ edited */
      text-align: center;
      font-size: 20pt;
      border-radius: 3px;
      box-shadow: 0px 0px 3px hsl(0, 0%, 20%);
      position: relative; /* ---------------------- added */
    } 
```

[在这里更新小提琴](http://jsfiddle.net/NotInUse/A2ehc/11/)

# c# - 我有一个项目列表并将其复制到一个集合中。如果列表发生任何更改，它应该自动反映在集合中

> ID：14356902
> 
> 赞同：0
> 
> 时间：2013-01-16T11:04:57.367
> 
> 标签：c#, .net, visual-studio-2008

我的项目是

> 第 1 步：创建一个 C# 控制台应用程序，该应用程序应创建一个 String 类型的列表并添加 item1、item 2 和 item 3。
> 
> 第 2 步：创建 String 类型的 Collection 并复制这些项目。
> 
> 第 3 步：如果 List 对象发生任何变化，它应该反映在 Collection 对象中。

我成功地完成了第 2 步，我的代码是

```
class Program
    {
        static void Main(string[] args)
        {
            List<string> newList = new List<string>();
            newList.Add("Item 1");
            newList.Add("Item 2");
            newList.Add("Item 3");

            Collection<string> newColl = new Collection<string>();

            foreach (string item in newList)
            {
                newColl.Add(item);
            }

            Console.WriteLine("The items in the collection are");
            foreach (string item in newColl)
            {
                Console.WriteLine(item);
            }

            Console.ReadKey();
        }
    } 
```

现在，如果列表中发生更改，它将如何反映在集合对象中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T11:07:42.237

尝试使用[ObservableCollection](http://msdn.microsoft.com/en-us/library/ms668604.aspx)代替`List<string>`并订阅事件`CollectionChanged`。这是非常幼稚的实现，只是为了给出一般的想法。您应该添加参数检查或进行其他类型的同步，因为您没有说明应该如何准确地反映更改`Collection`

```
ObservableCollection<string> newList = new ObservableCollection<string>();
newList.Add("Item 1");
newList.Add("Item 2");
newList.Add("Item 3");

Collection<string> newColl = new Collection<string>();

newList.CollectionChanged += (sender, args) => 
        {
            foreach (var newItem in args.NewItems)
            {
                newColl.Add(newItem);
            }
            foreach (var removedItem in args.OldItems)
            {
                newColl.Remove(removedItem);
            }
        }; 
```

# java - Netty 似乎忽略了编码

> ID：14356906
> 
> 赞同：1
> 
> 时间：2013-01-16T11:05:11.460
> 
> 标签：java, encoding, utf-8, netty

我正在运行一个似乎忽略编码的 netty 服务器。d3.js 中的错误是由于 PI 符号引起的。下面是设置编码的代码。即使在硬编码之后它仍然不起作用，任何想法为什么？

```
RandomAccessFile raf;
try {
  raf = new RandomAccessFile(file, "r");
} catch (FileNotFoundException fnfe) {
  sendError(ctx, NOT_FOUND);
  return;
}
long fileLength = raf.length();

HttpResponse response = new DefaultHttpResponse(HTTP_1_1, OK);
setContentTypeHeader(response, file);
setContentLength(response, fileLength);
setDateAndCacheHeaders(response, file);
if (isKeepAlive(request)) {
  response.setHeader(CONNECTION, HttpHeaders.Values.KEEP_ALIVE);
}

// Write the initial line and the header.
ctx.write(response);

// Write the content.
ChunkedFile chunkedFile = new ChunkedFile(raf, 0, fileLength, 8192);
ChannelFuture writeFuture = ctx.write(chunkedFile);

ctx.write(chunkedFile, writeFuture); 
```

这是`setContentTypeHeader`代码：

```
private static void setContentTypeHeader(HttpResponse response, File file) {
String contentType = MimeTypes.getContentType(file.getPath());
response.setHeader(CONTENT_TYPE, contentType);
if (!contentType.equals("application/octet-stream")) {
  response.setHeader(CONTENT_ENCODING, "charset=utf-8");
} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T16:03:06.570

[内容编码](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.11)不是字符编码，而是用于 gzip 等压缩。响应的字符编码在[Content-Type 标头](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.17)中指定。

```
private static void setContentTypeHeader(HttpResponse response, File file) {

    String contentType = MimeTypes.getContentType(file.getPath());

    if (!contentType.equals("application/octet-stream")) {
      contentType += "; charset=utf-8";
    }
    response.setHeader(CONTENT_TYPE, contentType);

} 
```

# php - Yii 未定义属性：CWebApplication::$user

> ID：14356910
> 
> 赞同：0
> 
> 时间：2013-01-16T11:05:32.683
> 
> 标签：php, session, yii, autologin

我有 WebUser 的扩展版本。

它工作得很好。直到今天，我用时间激活了“自动登录”。现在，当用户回来并启动自动登录时，此方法出现错误：

```
public function afterLogin($fromCookie)
    {
            parent::afterLogin($fromCookie);

            // Update Last Login
            $model = $this->loadUser(Yii::app()->user->id);
            $model->last_visit = new CDbExpression('NOW()');
            $model->save();
    } 
```

错误是：

```
Undefined property: CWebApplication::$user 
```

这是否意味着自动登录不再创建“用户”属性？

如果我删除这些行，那么网站的其余部分到目前为止似乎工作正常。

```
PHP notice

Undefined property: CWebApplication::$user

/Users/nathan/Git/web/protected/components/WebUser.php(16)

04 // protected/components/WebUser.php
05  
06 class WebUser extends RWebUser {
07  
08     // Store model to not repeat query.
09     private $_model;
10         
11     public function afterLogin($fromCookie)
12     {
13             parent::afterLogin($fromCookie);
14 
15             // Update Last Login
16             $model = $this->loadUser(Yii::app()->user->id);
17             $model->last_visit = new CDbExpression('NOW()');
18             $model->save();
19     }
20  
21     // Return first name.
22     // access it by Yii::app()->user->first_name
23     function getDisplayName(){
24         $user = $this->loadUser(Yii::app()->user->id);
25         return $user->displayName;
26     }
27     
28     function getNotificationCount(){
Stack Trace
#0  
–  /Users/nathan/Git/web/yii/yiilite.php(4087): WebUser->afterLogin(true)
4082                     if($this->autoRenewCookie)
4083                     {
4084                         $cookie->expire=time()+$duration;
4085                         $request->getCookies()->add($cookie->name,$cookie);
4086                     }
4087                     $this->afterLogin(true);
4088                 }
4089             }
4090         }
4091     }
4092     protected function renewCookie()
#1  
–  /Users/nathan/Git/web/yii/yiilite.php(3943): CWebUser->restoreFromCookie()
3938     public function init()
3939     {
3940         parent::init();
3941         Yii::app()->getSession()->open();
3942         if($this->getIsGuest() && $this->allowAutoLogin)
3943             $this->restoreFromCookie();
3944         elseif($this->autoRenewCookie && $this->allowAutoLogin)
3945             $this->renewCookie();
3946         if($this->autoUpdateFlash)
3947             $this->updateFlash();
3948         $this->updateAuthStatus();
#2  
–  /Users/nathan/Git/web/yii/yiilite.php(1050): CWebUser->init()
1045             $config=$this->_componentConfig[$id];
1046             if(!isset($config['enabled']) || $config['enabled'])
1047             {
1048                 unset($config['enabled']);
1049                 $component=Yii::createComponent($config);
1050                 $component->init();
1051                 return $this->_components[$id]=$component;
1052             }
1053         }
1054     }
1055     public function setComponent($id,$component,$merge=true)
#3  
–  /Users/nathan/Git/web/yii/yiilite.php(905): CModule->getComponent("user")
900         $this->init();
901     }
902     public function __get($name)
903     {
904         if($this->hasComponent($name))
905             return $this->getComponent($name);
906         else
907             return parent::__get($name);
908     }
909     public function __isset($name)
910     {
#4  
–  /Users/nathan/Git/web/protected/controllers/SiteController.php(30): CModule->__get("user")
25      * This is the default 'index' action that is invoked
26      * when an action is not explicitly requested by users.
27      */
28     public function actionIndex()
29     {
30         if(Yii::app()->user->checkAccessOrDeny('readHome')){
31                     //URLs to show in the list
32                     $criteria = Yii::app()->params['currentCommunity']->getUrls();
33                     $criteria->limit = 10;
34                     $urls = Url::model()->findAll($criteria);
35 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T16:01:57.723

当您调用 时`Yii::app()->user->id`，该`user`部分是`CWebUser`该类的一个实例（或该类的子类）。

When the application loads, it tries to initialize that `user` component, and as part of that initialization, it logs in a user, and then calls your overridden `afterLogin` method. Your `afterLogin` method in turn tries to call the component... but it hasn't finished initializing yet. So rather than get stuck in an infinite loop, Yii just tells you that the `user` component doesn't exist.

Fortunately, during the login process, a call to `changeIdentity` is made, which calls `setId`, which populates the `$id` attribute of the `user` component. This `id` attribute is in fact exactly the same attribute that is called with `Yii::app()->user->id`, only it is accessed within the object, instead of externally.

# iphone - 通过谷歌帐户登录到iphone App。

> ID：14356914
> 
> 赞同：0
> 
> 时间：2013-01-16T11:05:53.807
> 
> 标签：iphone, authentication, google-api

我是这个任务的新手。如何通过谷歌账户登录iphone原生应用程序有示例代码。我搜索了很多教程，但没有找到完整的支持。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T11:23:15.310

```
Here's the code that actually does the request - funny thing is that it works great if I use other APIs such as the URL shortener API:

    var scopes = new java.util.ArrayList();                                                                                                    
    scopes.add("https://www.googleapis.com/auth/drive");                                                                                       
    var appIdentity = AppIdentityServiceFactory.getAppIdentityService();                                                                       

       var accessToken = appIdentity.getAccessToken(scopes);

    var url = new URL("https://www.googleapis.com/drive/v2/files");                                                                            
    var connection = url.openConnection();                                                                                                     
    connection.setDoOutput(true);                                                                                                              
    connection.setRequestMethod("GET");                                                                                                        
    connection.addRequestProperty("Content-Type", "application/json");                                                                         
    connection.addRequestProperty("Authorization", "OAuth " + accessToken.getAccessToken()); 
```

按照这个[链接，这将解决你的问题](https://stackoverflow.com/questions/12503437/google-drive-service-account-returns-403-usagelimits/12526286#12526286)

# powershell - Export-Counter -Fileformat csv 追加？

> ID：14356923
> 
> 赞同：0
> 
> 时间：2013-01-16T11:06:24.437
> 
> 标签：powershell

我想对一组计算机运行 get counter 并将值输出到 csv ，我看到 Export-Counter 没有附加参数？

有人可以帮助解决如何使用 Export-Counter 附加更多信息的 csv，我知道 export-csv 有一个 append 参数，但是如果我想将数据附加到 Export-Counter 生成的 csv 怎么办。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T14:06:14.903

我想你在这里有两个选择。如果您需要它来打印报告，并使用 export-csv 保存它。前任：

```
Get-Counter | select ...(if you want need to modify output)| Export-Csv -Append test2.txt -NoTypeInformation 
```

如果您需要稍后导入它（需要真正的 performancecountersampleset-object），请尝试将前一个存储在一个数组中并添加新的计数器。前任：

```
$path = "C:\test.csv"

#1st time
Get-Counter | Export-Counter $path -FileFormat csv

#Next time you use
$a = Import-Counter $path
$array = @($a)
$b = Get-Counter
$array += $b
$array | Export-Counter $path -FileFormat csv -Force 
```

# android - 一个应用程序打包的最大文件数

> ID：14356928
> 
> 赞同：-2
> 
> 时间：2013-01-16T11:06:46.663
> 
> 标签：android, ios

有点奇怪的问题但是..

我目前正在构建一个应用程序，它将本质上是一个带有一些装饰的酒店列表目录。

在我突然发现自己有以下问题但找不到答案之前从未做过这样的应用程序...

您可以打包应用程序的文件数量是否有限制，即提交到iTunes...

我问的原因可能是我想提交我的应用程序，每个应用程序在他们自己的目录中至少包含 700 多个图像，从而产生 1400 多个文件（假设一个目录是一个文件）。我可以获得图像的大小以适应“空中”最大应用程序下载大小..但找不到您可以提交的文件数量是否有限制...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T11:13:44.530

您的应用程序通常包含在*一个*.apk 文件中。包括您的资源。链接：[https](https://en.wikipedia.org/wiki/APK_%28file_format%29) ://en.wikipedia.org/wiki/APK_%28file_format%29所以它的大小才是最重要的。

您可能需要仔细检查应用程序的架构，听起来您想要一个网络服务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T11:14:40.370

要上传的文件数量没有这样的限制。但是，正如您提到的，最好在安装后从应用程序下载文件。这将帮助您减小二进制大小。这是针对 iOS 的。

# java - 一条语句在 WAS 上给出 nullPointerException 但在 Tomcat 上运行良好

> ID：14356929
> 
> 赞同：1
> 
> 时间：2013-01-16T11:06:47.627
> 
> 标签：java, jsf-2, tomcat7, el, websphere-7

这是一个奇怪的场景，我要问的是是否有人过去经历过类似的事情以及可能的情况的任何提示

我正在开发的应用程序可用于各种环境。我们通常使用 Tomcat 进行开发，我们的集成环境之一是 Websphere。

现在像这样的声明

**BillingPaymentAssembler.java:149**

```
finActivity.setReferenceNo(paymentDetail.getTicketNumber()); 
```

在哪里 ticketNumber `String`，在单元测试期间可以在 Tomcat 上正常运行。但是当部署在 websphere 上时，会`nullPointerException`为同一个测试用例抛出一个。

更新#1

我们在 UI 上使用 JSF2，paymentDetail 是 Bean。

`ticket number``ticketNumber`是bean对应的 UI 上的一个字段。

这种情况下，当我没有在 UI 上输入任何内容时`ticket number`，将其留空。在那种情况下，我得到了例外

更新#2

```
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R java.lang.NullPointerException
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at com.csc.csa.assembler.BillingPaymentAssembler.disassemble(BillingPaymentAssembler.java:149)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at com.csc.fs.accel.AccelTransformation.disassemble(AccelTransformation.java:79)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:48)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at java.lang.reflect.Method.invoke(Method.java:600)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at com.csc.fs.ServiceHandler.invoke(ServiceHandler.java:59)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at com.csc.fs.accel.AccelService.callService(AccelService.java:1087)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at com.csc.csa.process.BillingPaymentBP.process(BillingPaymentBP.java:29)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at com.csc.fs.accel.AccelBP.process(AccelBP.java:62)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:48)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at java.lang.reflect.Method.invoke(Method.java:600)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at com.csc.fs.service.ServiceControllerBP.process(ServiceControllerBP.java:54)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at com.csc.fs.service.ServiceControllerAbstract.internalExecute(ServiceControllerAbstract.java:278)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at com.csc.fs.service.ServiceControllerAbstract.execute(ServiceControllerAbstract.java:197)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at com.csc.fs.delegate.DirectServiceController.execute(DirectServiceController.java:61)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at com.csc.fs.delegate.ServiceDelegateDirect.execute(ServiceDelegateDirect.java:70)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at com.csc.fs.accel.ui.BaseServiceAction.execute(BaseServiceAction.java:584)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at com.csc.fs.accel.ui.action.policy.services.MaintainBillingPayment.perform(MaintainBillingPayment.java:145)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at com.csc.fs.accel.ui.BaseServiceAction.perform(BaseServiceAction.java:618)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at com.csc.fs.accel.ui.ServiceDelegator.execute(ServiceDelegator.java:506)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at com.csc.fs.accel.ui.ServiceDelegator.processEvent(ServiceDelegator.java:240)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at com.csc.fs.accel.ui.BeanBase.executeEvent(BeanBase.java:779)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at pagecode.policy.file.Billing.executeBillingPayments(Billing.java:498)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:48)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:37)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at java.lang.reflect.Method.invoke(Method.java:600)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at org.apache.el.parser.AstValue.invoke(AstValue.java:131)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at org.apache.el.MethodExpressionImpl.invoke(MethodExpressionImpl.java:276)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at org.apache.jasper.el.JspMethodExpression.invoke(JspMethodExpression.java:67)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at javax.faces.component.MethodBindingMethodExpressionAdapter.invoke(MethodBindingMethodExpressionAdapter.java:88)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at com.sun.faces.application.ActionListenerImpl.processAction(ActionListenerImpl.java:102)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at javax.faces.component.UICommand.broadcast(UICommand.java:315)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at javax.faces.component.UIViewRoot.broadcastEvents(UIViewRoot.java:775)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at javax.faces.component.UIViewRoot.processApplication(UIViewRoot.java:1267)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at com.sun.faces.lifecycle.InvokeApplicationPhase.execute(InvokeApplicationPhase.java:82)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:118)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at javax.faces.webapp.FacesServlet.service(FacesServlet.java:312)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at com.ibm.ws.webcontainer.servlet.ServletWrapper.service(ServletWrapper.java:1655)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at com.ibm.ws.webcontainer.servlet.ServletWrapper.service(ServletWrapper.java:1595)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at com.ibm.ws.webcontainer.filter.WebAppFilterChain.doFilter(WebAppFilterChain.java:131)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at com.csc.fs.accel.ui.filters.ResponseHeaderFilter.doFilter(ResponseHeaderFilter.java:82)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at com.ibm.ws.webcontainer.filter.FilterInstanceWrapper.doFilter(FilterInstanceWrapper.java:188)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at com.ibm.ws.webcontainer.filter.WebAppFilterChain.doFilter(WebAppFilterChain.java:116)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at com.ibm.ws.webcontainer.filter.WebAppFilterChain._doFilter(WebAppFilterChain.java:77)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at com.ibm.ws.webcontainer.filter.WebAppFilterManager.doFilter(WebAppFilterManager.java:895)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at com.ibm.ws.webcontainer.servlet.ServletWrapper.handleRequest(ServletWrapper.java:932)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at com.ibm.ws.webcontainer.servlet.ServletWrapper.handleRequest(ServletWrapper.java:500)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at com.ibm.ws.webcontainer.servlet.ServletWrapperImpl.handleRequest(ServletWrapperImpl.java:178)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at com.ibm.ws.webcontainer.servlet.CacheServletWrapper.handleRequest(CacheServletWrapper.java:91)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at com.ibm.ws.webcontainer.WebContainer.handleRequest(WebContainer.java:864)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at com.ibm.ws.webcontainer.WSWebContainer.handleRequest(WSWebContainer.java:1583)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at com.ibm.ws.webcontainer.channel.WCChannelLink.ready(WCChannelLink.java:183)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.handleDiscrimination(HttpInboundLink.java:455)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at com.ibm.ws.http.channel.inbound.impl.HttpInboundLink.handleNewInformation(HttpInboundLink.java:384)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at com.ibm.ws.http.channel.inbound.impl.HttpICLReadCallback.complete(HttpICLReadCallback.java:83)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at com.ibm.ws.tcp.channel.impl.AioReadCompletionListener.futureCompleted(AioReadCompletionListener.java:165)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at com.ibm.io.async.AbstractAsyncFuture.invokeCallback(AbstractAsyncFuture.java:217)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at com.ibm.io.async.AsyncChannelFuture.fireCompletionActions(AsyncChannelFuture.java:161)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at com.ibm.io.async.AsyncFuture.completed(AsyncFuture.java:138)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at com.ibm.io.async.ResultHandler.complete(ResultHandler.java:204)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at com.ibm.io.async.ResultHandler.runEventProcessingLoop(ResultHandler.java:775)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at com.ibm.io.async.ResultHandler$2.run(ResultHandler.java:905)
[1/16/13 5:25:02:750 EST] 00000019 SystemErr     R  at com.ibm.ws.util.ThreadPool$Worker.run(ThreadPool.java:1550) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T12:05:30.807

我假设这`ticketNumber`是[`Number`](http://docs.oracle.com/javase/6/docs/api/java/lang/Number.html)( `Integer`, `Long`, `Double`, 等) 的一个实例。通常，当使用原始类型（`int`、`long`、`double`等）时，EL 会自动将提交的空字符串值强制为原始类型的默认值，即`0`or `0.0`。在包装对象类型的情况下，EL 解析器存在差异，因为[EL 规范](http://jcp.org/aboutJava/communityprocess/mrel/jsr245/index.html)对此并不十分清楚和/或因为强制对`null`非原始类型上的空字符串提交值更有意义。

带有 Apache EL 解析器的 Tomcat 会将提交的空字符串`Number`类型值强制为原始表示的默认值。因此，类型上的空提交值`Integer`将被设置为`0`而不是`null`. 显然，您认为这是“正确”的行为，并且您的代码也被这样编写以拦截。

但是，其他服务器（例如本例中的 WebSphere）将强制它们`null`使用原始表示的默认值，而不是原始表示的默认值，从而导致 NPE。

基本上，错误在您的代码中。您应该考虑`null`价值，或者使用if来`int`代替“无价值”的有效表示（这取决于您的业务需求）。为了让所有服务器的行为都相同，您基本上还应该指示 Tomcat**不要**将提交的空字符串值强制到. 您可以通过将以下 VM 参数添加到 Tomcat 启动脚本来做到这一点：`Integer``0`**`Number``0`**

 **```
-Dorg.apache.el.parser.COERCE_TO_ZERO=false 
```

请注意，这个问题本质上与 JSF 无关。它只是碰巧*使用*EL。

### 也可以看看：

*   [绑定到 Integer 属性的 h:inputText 正在提交值 0 而不是 null](https://stackoverflow.com/questions/3116517/hinputtext-which-is-bound-to-integer-property-is-submitting-value-0-instead-of)**

# mysql - 尝试在 for 循环内连续将文档添加到 lucene 索引时引发异常

> ID：14356935
> 
> 赞同：0
> 
> 时间：2013-01-16T11:07:15.263
> 
> 标签：mysql, lucene, wso2, compass-lucene, wso2dss

我正在使用“compass-2.2.0”在 MySql 数据库表中创建一个 lucene 索引。这是我索引文档的代码的一部分，在尝试在 for 循环内连续将文档添加到 lucene 索引时抛出异常。有什么办法可以克服这个错误吗？

我的托管服务器是基于 Wso2 Stratoes Tomcat 的服务器和 Wso2 Stratoes 数据服务服务器。我的程序在本地 tomcat/mySql 服务器上工作。

这是我关注的示例博客文章[- http://mprabhat.wordpress.com/2012/08/13/create-lucene-index-in-database-using-jdbcdirectory/](http://mprabhat.wordpress.com/2012/08/13/create-lucene-index-in-database-using-jdbcdirectory/)

```
 private void addIndex(IndexWriter indexWriter) throws CorruptIndexException, IOException {
        try {
            for (int i = 0; i < docNames.length; i++) {
                StringReader strRdElt = new StringReader(new DefaultTokenizer().processText(filesInText[i]));
                StringReader docId = new StringReader(Integer.toString(i));

                Document doc = new Document();

                doc.add(new Field("doccontent", strRdElt, Field.TermVector.YES));
                doc.add(new Field("docid", docId, Field.TermVector.YES));

                indexWriter.addDocument(doc);

            }
          //  indexWriter.close();

        } catch (Exception e) {
            e.printStackTrace();
        }
    } 
```

这是我得到的新错误，我使用的服务器不允许创建临时文件。在尝试将内容写入数据库时​​，它会以某种方式创建临时文件。我在上面的循环中进行了调试，大约 5 次迭代它成功然后发生以下错误。任何解决方法来克服这个错误？

```
java.lang.SecurityException: Unable to create temporary file
        at java.io.File.checkAndCreate(File.java:1701)
        at java.io.File.createTempFile(File.java:1792)
        at java.io.File.createTempFile(File.java:1828)
        at org.apache.lucene.store.jdbc.index.FileJdbcIndexOutput.configure(File
JdbcIndexOutput.java:46)
        at org.apache.lucene.store.jdbc.index.RAMAndFileJdbcIndexOutput.switchIf
Needed(RAMAndFileJdbcIndexOutput.java:113)
        at org.apache.lucene.store.jdbc.index.RAMAndFileJdbcIndexOutput.writeByt
es(RAMAndFileJdbcIndexOutput.java:73)
        at org.apache.lucene.store.DataOutput.writeBytes(DataOutput.java:43)
        at org.apache.lucene.store.RAMOutputStream.writeTo(RAMOutputStream.java:
65)
        at org.apache.lucene.index.TermVectorsTermsWriter.finishDocument(TermVec
torsTermsWriter.java:170)
        at org.apache.lucene.index.TermVectorsTermsWriter$PerDoc.finish(TermVect
orsTermsWriter.java:258)
        at org.apache.lucene.index.DocumentsWriter$WaitQueue.writeDocument(Docum
entsWriter.java:1404)
        at org.apache.lucene.index.DocumentsWriter$WaitQueue.add(DocumentsWriter
.java:1424)
        at org.apache.lucene.index.DocumentsWriter.finishDocument(DocumentsWrite
r.java:1043)
        at org.apache.lucene.index.DocumentsWriter.updateDocument(DocumentsWrite
r.java:772)
        at org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java:2060
)
        at org.apache.lucene.index.IndexWriter.addDocument(IndexWriter.java:2034
)
        at org.karsha.base.DocIndexer_test.addIndex(DocIndexer_test.java:168)
        at org.karsha.base.DocIndexer_test.indexToDB(DocIndexer_test.java:115)
        at org.karsha.base.DocIndexer_test.topKFiboTerms(DocIndexer_test.java:35
9)
        at org.karsha.controler.RecommondTermsServelet.doGet(RecommondTermsServe
let.java:379)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:621)
        at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
        at sun.reflect.GeneratedMethodAccessor75.invoke(Unknown Source)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAcces
sorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:597)
        at org.apache.catalina.security.SecurityUtil$1.run(SecurityUtil.java:274
)
        at org.apache.catalina.security.SecurityUtil$1.run(SecurityUtil.java:271
)
        at java.security.AccessController.doPrivileged(Native Method)
        at javax.security.auth.Subject.doAsPrivileged(Subject.java:517)
        at org.apache.catalina.security.SecurityUtil.execute(SecurityUtil.java:3
06)
        at org.apache.catalina.security.SecurityUtil.doAsPrivilege(SecurityUtil.
java:166)
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(Appl
icationFilterChain.java:299)
        at org.apache.catalina.core.ApplicationFilterChain.access$000(Applicatio
nFilterChain.java:57)
        at org.apache.catalina.core.ApplicationFilterChain$1.run(ApplicationFilt
erChain.java:193)
        at org.apache.catalina.core.ApplicationFilterChain$1.run(ApplicationFilt
erChain.java:189)
        at java.security.AccessController.doPrivileged(Native Method)
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationF
ilterChain.java:188)
        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperV
alve.java:225)
        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextV
alve.java:123)
        at org.apache.catalina.authenticator.AuthenticatorBase.invoke(Authentica
torBase.java:472)
        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.j
ava:168)
        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.j
ava:98)
        at org.wso2.carbon.tomcat.ext.valves.CompositeValve.invoke(CompositeValv
e.java:172)
        at org.wso2.carbon.tomcat.ext.valves.CarbonStuckThreadDetectionValve.inv
oke(CarbonStuckThreadDetectionValve.java:156)
        at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:
927)
        at org.wso2.carbon.tomcat.ext.valves.CarbonContextCreatorValve.invoke(Ca
rbonContextCreatorValve.java:52)
        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineVal
ve.java:118)
        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.jav
a:407)
        at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp
11Processor.java:1001)
        at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(
AbstractProtocol.java:579)
        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoin
t.java:1653)
        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExec
utor.java:886)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor
.java:908)
        at java.lang.Thread.run(Thread.java:619) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T03:41:29.263

您可以从数据库中获取 ThreadDeath 异常的原因有很多。

1.  数据库 URL 不正确
2.  数据库的端口号已更改，[此处](https://community.jboss.org/thread/77669)类似问题，请参阅讨论中的最后一条评论
3.  您打开了太多会话，您的数据库无法为您提供新会话。

编辑根据更新的堆栈跟踪

指南针给你两件事：

1.  IndexInput 和 2\. IndexOutput

默认情况下 IndexOutput 设置为[RAMAndFileJDBCIndexOutput](http://www.compass-project.org/docs/2.2.0/reference/html/jdbcdirectory.html)，在[一定限制](http://www.compass-project.org/docs/2.2.0/api/org/apache/lucene/store/jdbc/index/RAMAndFileJdbcIndexOutput.html#INDEX_OUTPUT_THRESHOLD_SETTING)后切换到[FileJdbcIndexOutput](http://www.compass-project.org/docs/2.2.0/api/org/apache/lucene/store/jdbc/index/FileJdbcIndexOutput.html)并创建您的临时文件。

要解决此问题，您可以更改此默认值或更改 JDBCDirectorySettings 中的默认 IndexOutput。

# html - 是否溢出：隐藏是否清除：

> ID：14356937
> 
> 赞同：2
> 
> 时间：2013-01-16T11:07:29.710
> 
> 标签：html, css

在一篇文章中，我读到有一个关于浮动的`<li>`问题`<ul>`。那家伙问为什么他的`<ul>`背景在浮动时消失了，`<li>`以及如何解决这个问题。答案是设置`overflow:hidden`为`<ul>`. 我试过了，它会起作用的，但我以前没有读过和听过类似的东西。

我的问题是：您可以使用`overflow:hidden`clearfix 之类的清除元素吗？

在这种情况下：

```
<ul>
  <li>one</li>
  <li>two</li>
  <li>three</li>
</ul> 
```

如果我有以下 CSS：

```
ul{
  background: #999;
  overflow: hidden;
}

li {
  float: left;
} 
```

我还需要清除：`<ul class="clearfix">`和CSS：

```
.clearfix { *zoom: 1; }
.clearfix:after { 
    width: 100%; 
    content: ''; 
    font-size: 0; 
    line-height: 0; 
    text-indent: -4000px; 
    clear: both; 
    display:block; 
} 
```

或者我可以让`overflow:hidden`做那份工作

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-16T11:11:49.540

### 是的！

有以下三种方法`clear`：

1.  用于ed元素`overflow: hidden;`的父级。`float`
2.  给ed 元素的父元素一个`float: left;`or 。`float: right;``float`
3.  `clear`在浮动元素的末尾给出一个ing 元素作为兄弟元素。

### 对于你的问题...

是的，您可以只使用`overflow: hidden;`to do，但是有一个问题。假设您有弹出列表或弹出框之类的东西，这些东西会随着`UL`标签的尺寸而减少。

如果您也希望它们显示，则需要使用`<ul class="clearfix">`. 我会说，`clearfix`比`overflow: hidden;`。

*ps：我是一名前端工程师，开发跨所有浏览器兼容的企业 Web 应用程序。*

# php - 需要帮助以 php 形式进行数据库更新查询 - Joomla 数据库

> ID：14356938
> 
> 赞同：0
> 
> 时间：2013-01-16T11:07:32.087
> 
> 标签：php, mysql, database, joomla, joomla1.5

假设我有一个包含**10 条记录的****表**，我想从这 10 条记录中获取**name**、**lastname**和**rank 。**首先我做这样的事情：

 ******```
<?php // DATABASE SELECT QUERY
      $db =& JFactory::getDBO();
      $query="SELECT name, lastname, rank
                FROM table
               ORDER BY rank ASC";
      $db->setQuery($query);
      $rows = $db->loadObjectList(); ?> 
```

然后，我在表单中添加了一些包含表值的字段，因此我可以通过表单对其进行编辑：

```
<form action="#" method="post" name="form">

<table><?php $count    = 0; while ($count < 10){
             $name     = $rows[$count]->name;
             $lastname = $rows[$count]->lastname;
             $rank     = $rows[$count]->rank; ?>
<tr>

<td><input name="name" value="<?php echo $name ?>" type="text" /></td>
<td><input name="lastname" value="<?php echo $lastname ?>" type="text" /></td>
<td><select name="rank">
    <option value="<?php echo $rank ?>"><?php echo $rank ?></option>
    <option disabled="disabled" value="...">...</option>
    <?php for ($i = 0; $i <= 100; $i++){ ?>
    <option value="<?php echo $i ?>"><?php echo $i ?></option> <?php } ?>
    </select></td>  

</tr><?php $count++;}?>

</table>

<input class="something" name="updatemod" type="submit" value="UPDATE" />
</form> 
```

接下来，在选择查询之前，我在下面使用此方法添加了一个更新查询，所以当我按下更新按钮时，更新我的数据库：

```
// DATABASE UPDATE QUERY
if (isset($_POST['updatemod']) or isset($_GET['updatemod'])){
$db =& JFactory::getDBO();
$query = "UPDATE table
             SET name = '".$_POST["name"]."',
             SET lastname = '".$_POST["lastname"]."',
             SET rank = '".$_POST["rank"]."'
             ";
$db->setQuery($query);
$db->query();} 
```

但是......没有任何工作！我对另一种形式做了完全相同的事情，而且效果很好！这两种形式的唯一区别是我没有`while`在另一种形式中使用这个循环。所以，也许它与这个或什么有关？？？我不知道，此时是我的知识混乱的地方，所以我需要你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T11:38:19.163

我认为您正在尝试更新表中的所有行。

如果是这种情况，你需要做这样的事情。

```
<?php // DATABASE SELECT QUERY // also you should select your unique id field
      $db =& JFactory::getDBO();
      $query="SELECT name, lastname, rank,id
                FROM table
               ORDER BY rank ASC";
      $db->setQuery($query);
      $rows = $db->loadObjectList(); ?> 
```

在您的表单中，您将元素名称设置为单个，但您的要求是一次编辑所有行，您应该使用输入名称作为数组。此外，您还必须在此处引入一个新的 id 字段以用于更新条件

```
 <form action="#" method="post" name="form">

    <table><?php $count    = 0; while ($count < 10){
                 $name     = $rows[$count]->name;
                 $lastname = $rows[$count]->lastname;
                 $rank     = $rows[$count]->rank;
                  $id      = $rows[$count]->id; ?>
    <tr>

    <td><input name="uid[]" value="<?php echo $id?>" type="hidden" />
<input name="name[]" value="<?php echo $name ?>" type="text" /></td>
    <td><input name="lastname[]" value="<?php echo $lastname ?>" type="text" /></td>
    <td><select name="rank[]">
        <option value="<?php echo $rank ?>"><?php echo $rank ?></option>
        <option disabled="disabled" value="...">...</option>
        <?php for ($i = 0; $i <= 100; $i++){ ?>
        <option value="<?php echo $i ?>"><?php echo $i ?></option> <?php } ?>
        </select></td>  

    </tr><?php $count++;}?>

    </table>

    <input class="something" name="updatemod" type="submit" value="UPDATE" />
    </form> 
```

同样在您的更新查询中也需要循环和 where cluase

```
// DATABASE UPDATE QUERY
if (isset($_POST['updatemod']) or isset($_GET['updatemod'])){
$db =& JFactory::getDBO();
$total_rows = sizeof($_POST["uid"]);
for($i =0; $i<$total_rows;$i++){

$query = "UPDATE table
             SET name = '".$_POST["name"][$i]."',
             lastname = '".$_POST["lastname"][$i]."',
             rank = '".$_POST["rank"][$i]."'
              WHERE id = '".$_POST["uid"][$i]."'
             ";
$db->setQuery($query);
$db->query();
}
} 
```

我认为这将解决您的问题。

在这里，我刚刚提到了“id”作为您可能不同的表的唯一键。但您会明白的，我希望

但这是一个最坏的更新条件 Bcoz 你只是想象一个有 1000 行的表。需要很长时间才能得到结果。

尝试用适当的方法更新单行。这是最好的方法。

希望这可以帮助你。******

# facebook - 什么是channelUrl

> ID：14356943
> 
> 赞同：1
> 
> 时间：2013-01-16T11:07:47.097
> 
> 标签：facebook

> **可能重复：**
> [为什么我们需要在我们的服务器上创建一个 channel.html 来使用 Facebook JS SDK？](https://stackoverflow.com/questions/7052734/why-do-we-need-to-create-a-channel-html-on-our-server-to-use-facebook-js-sdk)

按照本指南，我能够在我的 php 页面 [http://developers.facebook.com/docs/guides/web/](http://developers.facebook.com/docs/guides/web/)之一中输入 facebook 的登录信息， 但我不明白如何更改这一行。它是什么？

```
channelUrl : '//WWW.YOUR_DOMAIN.COM/channel.html', // Channel File 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T11:11:27.797

您需要阅读以下内容：操作方法[：优化社交插件性能](https://developers.facebook.com/blog/post/530/)

# php - 使用词袋

> ID：14356946
> 
> 赞同：0
> 
> 时间：2013-01-16T11:07:51.450
> 
> 标签：php

在处理存储为文本文件的电子邮件时，我正在研究实施词袋方法。我想使用可能表明电子邮件需要回复的关键字，用二进制分析电子邮件（类似于 1|0|1|0|0 等，具体取决于是否使用该词），然后获得我可以使用的特征向量不同的机器学习算法。

我正在考虑使用 PHP 来获取特征向量，但我找不到任何现有的实现。甚至可以在 PHP 中做类似的事情吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T09:48:28.163

是的，词袋对于制作分类器很有意义。我也在做关于文本分类的论文，我正在使用 php 和 mysql。我对创建词袋有点困惑。但一段时间后，它可以完成。

# java - 学习JavaBean

> ID：14356947
> 
> 赞同：-1
> 
> 时间：2013-01-16T11:07:56.100
> 
> 标签：java

我是 Java 新手，我想从头开始学习 JavaBean。因此，如果有人可以告诉我一些教程或链接，那将对我有很大帮助。还有另一个问题我可以在 Scriptlets 中使用 jsp 动作标签作为子标签吗？

我在哪里可以找到从 Jsp 页面生成的 servlet？我正在使用 Tomcat 7.0。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T11:13:18.250

企业 Java Bean (EJB) 和 Java Bean（也称为 POJO）之间存在巨大差异。第一个是指企业 Java 规范的业务组件部分，互联网上有大量文章、指南、教程和其他材料讨论和解释

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T11:10:59.047

最好的教程是[来自 Oracle](http://docs.oracle.com/javase/tutorial/javabeans/index.html)的教程。

您不应该将 scriptlet 代码添加到 JSP。学习 JSTL 并编写无脚本 JSP。

JSP 是一个超越 Java Bean 的高级主题。不懂Java Beans的人怎么写JSP？

# html - html页面加载后播放音频

> ID：14356956
> 
> 赞同：15
> 
> 时间：2013-01-16T11:08:38.487
> 
> 标签：html

我在html中插入了音频。但是音频在整个页面加载之前就开始了。我希望在整个页面加载后播放音频。

```
<audio src="bg.mp3" autoplay="autoplay" loop="loop"></audio> 
```

任何人都可以在这方面帮助我。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-01-16T11:29:29.460

为此，您将需要 JavaScript。删除`autoplay`属性：

```
<audio id="my_audio" src="bg.mp3" loop="loop"></audio> 
```

并添加这样的脚本：

```
window.onload = function() {
    document.getElementById("my_audio").play();
} 
```

或者，如果您使用 jQuery：

```
$(document).ready(function() {
    $("#my_audio").get(0).play();
}); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-10-01T06:46:56.207

只需将此代码复制并粘贴到您的 HTML 代码的正文部分。

```
<audio autoplay>
  <source src="song.mp3" type="audio/mpeg">
</audio> 
```

并确保您的音频文件应位于同一文件夹中。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-16T11:21:47.060

我认为您必须使用 JS (jQuery) 函数来准备文档

> $(文档).ready(函数()

[单击按钮时使用 jQuery 播放音频文件](https://stackoverflow.com/questions/8489710/how-can-i-play-sound-in-jquery-when-click-a-button)

你在这里有答案（如果我没听错的话）

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2016-12-09T05:02:08.457

对于重复的音调，请放置以下代码

```
 <audio src="./audio/preloader.mp3" autoplay="autoplay" loop="loop"></audio> 
```

一次，删除循环。那么应该是这样的

```
 <audio src="./audio/preloader.mp3" autoplay="autoplay"></audio> 
```

# java - Spring webflow 有问题

> ID：14356957
> 
> 赞同：0
> 
> 时间：2013-01-16T11:08:47.847
> 
> 标签：java, spring, jakarta-ee, spring-webflow

我正在尝试向`on-render`此 XML 添加一个元素：

```
<var name="someVariable" class="com.example.test"/>

<view-state id="frontpage" view="test/test">    
    <binder>
        <binding property="test" required="true"/>
    </binder>     
    <transition on="submit" to="summary">
        <evaluate expression="myExpression.test()"/>
    </transition>
</view-state> 
```

我尝试将它添加到`view-state`元素中，但是当我这样做时，页面崩溃了。这是一个例外：

> org.xml.sax.SAXParseException: cvc-complex-type.2.4.a: 发现从元素'binder'开始的无效内容。'{"http://www.springframework.org/schema/webflow":transition, "http://www.springframework.org/schema/webflow":on-exit, "http://www.springframework" 之一.org/schema/webflow":exception-handler}' 是预期的。

我正在使用 Spring webflow 2.0.8。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T16:41:13.823

[WebFlow XSD](http://www.springframework.org/schema/webflow/spring-webflow-2.0.xsd)指定任何`<binder>`元素必须位于任何元素之前`<on-render>`。您收到的异常消息是因为您的`on-render`元素出现在`<binder>`元素之前。我建议您使用支持 XSD 的编辑器来编辑 XML 文件，并在 XML 声明中包含 webflow XSD：

```
<?xml version="1.0"?>
<flow xmlns="http://www.springframework.org/schema/webflow" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      xsi:schemaLocation="http://www.springframework.org/schema/webflow http://www.springframework.org/schema/webflow/spring-webflow-2.0.xsd"
      start-state="startState">

...

</flow> 
```

# java - eclipse indigo 中的可运行 jar 创建选项

> ID：14356958
> 
> 赞同：1
> 
> 时间：2013-01-16T11:08:49.070
> 
> 标签：java, eclipse, jar, executable-jar, eclipse-indigo

我正在使用 eclipse indigo 创建一个可运行的 jar，我遇到了两个选项：

`Extract required libraries into generated jar`

和

`Package required libraries into generated jar`

虽然使用第一个选项创建只生成了一个包含应用程序包和`META-INF`包的 jar 文件，但第二个选项也创建了一个`org`包。

该`org`软件包通过其子文件夹进一步扩展为`org> eclipse> jdt> internal> jarinjarloader`. 该`jarinjarloader`软件包包含一些我以前从未见过的类。

这是我在第二个选项中的清单文件：

```
Manifest-Version: 1.0
Rsrc-Class-Path: ./
Class-Path: .
Rsrc-Main-Class: main.SimpleCalculator
Main-Class: org.eclipse.jdt.internal.jarinjarloader.JarRsrcLoader 
```

`main`是我的应用程序包，`SimpleCalculator`是我的主要课程。

我的问题是：

1）这两个选项有何不同，第二个选项添加了哪些新类？第二个选项的清单中还有哪些不同的名称-值对？

2）此外，除了它们的清单文件允许可运行的可执行文件之外，不可运行和可运行的 jar 之间是否有任何区别。（我找到了在我的项目中指定主类的选项，同时创建了一个不可运行的 jar 文件，所以我在这里遗漏了一些东西还是只是 eclipse 试图提供额外的帮助？）

注意：我对这两个选项有一些猜测，但它们只是……猜测！

提前谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T11:20:34.230

1）这两个选项有何不同？

[可运行的 jar 库处理选项有什么区别？](https://stackoverflow.com/questions/8302894/what-is-the-difference-between-runnable-jar-library-handling-options)

2）第二个选项添加的这些新类是什么？

`org`包用于 jar-in-jar-loader。有了`package option`它会变成胖罐子，你的主类将不再是真正的主类，在这种情况下见清单。

来自 Ant，但你明白吗？

```
 <attribute name="Main-Class" value="org.eclipse.jdt.internal.jarinjarloader.JarRsrcLoader"/>
 <attribute name="Rsrc-Main-Class" value="YourRealMainClass"/> 
```

3）此外，除了清单文件之外，不可运行和可运行的 jar 之间有什么区别吗？

我不这么认为，但是从 Eclipse 中导出不可运行的 jar 您可以指定要包含的文件，而不是更灵活。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T11:25:44.670

第一个问题的答案是第一个选项提取依赖类文件和资源，然后将它们打包到您的jar文件中，您需要注意使用此选项的许可证问题

至于第二个选项，它只打包 ie：将 jar 文件按原样添加到您的 jar 文件中，并通过 MANIFEST 引用它们。

还有另一种创建可运行 jar 文件的选项，它将所有依赖项 jar 文件放在与项目的可运行 jar 相邻的文件夹中，并在 MANIFEST 中包含对该文件夹中 jar 的引用。

你的第二个问题的答案是，是的，eclipse 试图通过使用你的运行时配置来让生活变得更轻松，这样你就可以根据你选择的任何配置创建一个可运行的 jar。您可以通过手动创建包含主类的清单来创建可运行的 jar。

# xsd - 如何使用 XSD 将动态列表添加到 simpletype(dropdown) 的枚举？

> ID：14356959
> 
> 赞同：0
> 
> 时间：2013-01-16T11:08:50.983
> 
> 标签：xsd

我已经使用 XSD 使用 simpleType 限制编写了 dorp down 元素。这是我的示例代码。

```
<xsd:simpleType name="StatusListDropDown">
   <xsd:restriction base="xsd:string">
            <xsd:enumeration value="Submitted" />
            <xsd:enumeration value="In Process" />
            <xsd:enumeration value="Cancelled" />
            <xsd:enumeration value="Completed" />
            <xsd:enumeration value="Saved" />           
        </xsd:restriction>
    </xsd:simpleType> 
```

实际上我的列表大小超过 30 条记录，我不想在同一个 XSD 中硬编码它们。有什么我可以动态获取它们的。一个想法是为此列表设置单独的 XSD，并使用 xsi:schemaLocation 导入该列表。这是正确的方法吗？或者有什么好的方法可以做到这一点。请告诉我。先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T16:18:52.990

是的，采用像您描述的那样频繁更改的枚举并将其放入单独的架构文档中，该文档可以独立于架构的其余部分进行更新，这是完全正确的做法。你要求好的方法来做到这一点，但我认为你已经找到了最好的方法。

一个技术点：除非您想将 StatusListDropDown 类型放在单独的命名空间中，否则您将需要使用`xsd:include`，而不是`xsd:import`将其带入主模式文档。

# elasticsearch - 弹性搜索仅 10 次点击

> ID：14356965
> 
> 赞同：0
> 
> 时间：2013-01-16T11:09:14.023
> 
> 标签：elasticsearch

我第一次使用elasticsearch，但是当我进行搜索时，我从elasticsearch 得到一个JSON 响应，它给了我前10 个结果。然后我如何请求接下来的 10 个结果等等？

我查看了 API，但这并没有给出太多的见解。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T11:34:30.903

您可以使用`size`和`from`参数 - [http://www.elasticsearch.org/guide/reference/api/search/from-size.html](http://www.elasticsearch.org/guide/reference/api/search/from-size.html)

# registry - WPD 上层过滤器导致 MTP 设备安装失败

> ID：14356968
> 
> 赞同：0
> 
> 时间：2013-01-16T11:09:30.000
> 
> 标签：registry, driver, samsung-mobile, wpd, filter-driver

我一直在为 WPD（便携式设备）类编写 KMDF 过滤器驱动程序（基于[http://www.osronline.com/article.cfm?article=446](http://www.osronline.com/article.cfm?article=446)中的示例）。驱动程序的目的是对设备的块写入请求。
我在注册表中为 WPD 类设置了 UpperFilters，当插入三星 Galaxy S3 时，我能够捕获发送到设备的 WPD IOCTL（当前驱动程序只将请求转发给下一个驱动程序）。到目前为止，一切都很好。
然后我安装了 Samsung Kies 以查看过滤器驱动程序是否仍然有效，但是当我插入设备时，Windows 尝试安装“Samsung Mobile MTP Device”并失败。我试了几次（我确认驱动程序仍然安装，这不是缺少驱动程序的问题）。当我从 UpperFilters 中删除我的驱动程序时，该设备已安装并可以正常工作。当我放回过滤器时，设备无法启动（代码 10）。使用Windbg，我可以看到我的驱动程序启动，设备被添加，然后驱动程序卸载（我不知道中间发生了什么......）
当我试图将它作为一个较低的过滤器时，它又可以正常工作了。
在网上搜索时，我发现使用 WDM 而不是 WDK 时也会发生这种情况。

为什么在这种情况下放置 UpperFilter 会导致设备无法启动？
有没有办法解决它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-30T04:55:06.163

Oren，你在什么机器上测试你的代码？你能概括地描述你的代码实际上做了什么吗？

我正在使用相同的示例作为我的项目的基线，它作为 GS3 顶部的上层过滤器驱动程序运行良好 - 安装了 Kies - 在运行 Win7/32 的 VMWare 上。

最重要的是 - 您将驱动程序作为上层过滤器添加到哪个类？

我在 HKLM\XxXControlSet\Control\Class{EEC5AD98-8080-425F-922A-DABF3DE3F69A} 上添加了我的，它在 GS3 上运行平稳。

您是否使用示例中的安装程序应用程序来安装驱动程序/服务？

祝你好运乌列尔

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T00:39:18.267

您是否尝试过其他设备以查看这是否是三星特有的？

此外，这看起来像是三星 Kies 软件引入的东西，也许他们正在安装另一个过滤器驱动程序。您可以通过检查 %windir%\inf\setupapi.dev.log 来查看是否有与 Kies 或 Samsung 相关的驱动程序条目。

# android - 将它们放在 ldpi 文件夹中时出现失真的图像，它们在屏幕截图中看起来很完美

> ID：14356969
> 
> 赞同：0
> 
> 时间：2013-01-16T11:09:38.050
> 
> 标签：android, image, screenshot, distortion

我有一些尺寸合适并放入drawable-land-ldpi和drawable-port-ldpi的图像资源。当我看到应用程序的外观时，图像显示为横向横向拉伸和纵向纵向拉伸。

但是，如果我使用 DDMS 截取屏幕截图，它们的尺寸看起来非常完美，完全没有变形！发生了什么？

它在 android 4.0.3 上，一个实际的设备。最简单的图像布局。

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:background="@android:color/black"
tools:context=".MainActivity" >
     <ImageView
    android:id="@+id/imageView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:src="@drawable/imageb" />
</RelativeLayout> 
```

# coldfusion - 使用 ColdFusion 10 导出到 Excel 并格式化单元格

> ID：14356974
> 
> 赞同：0
> 
> 时间：2013-01-16T11:10:06.583
> 
> 标签：coldfusion, spreadsheet, export-to-excel, coldfusion-10

我有一个查询，我想在 Excel 的电子表格中输出。我希望以某种方式对某些单元格列进行格式化，即数千个分组和数字格式，以便可以在该行上进行求和、加法等操作，而无需进一步更改。

我已经阅读了文档，但首先让我对如何输出到 Excel 感到有些困惑。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T13:02:26.777

*我从评论开始，但作为答案更容易阅读。*

你试过什么？您是否阅读过[CFSpreadsheet 文档](http://help.adobe.com/en_US/ColdFusion/10.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec17cba-7f87.html)？应该很直截了当。`CFSpreadsheet`标签的参数之一是“查询”。为什么不从它开始，看看默认情况下它是如何为您设置列格式的，以查看需要调整的内容。

这是直接取自参考文档页面的示例：

```
<cfquery name="courses" datasource="cfdocexamples"> 
    SELECT CORNUMBER, DEPT_ID, COURSE_ID, CORNAME 
    FROM COURSELIST 
</cfquery> 

<cfscript> 
    //Use an absolute path for the files. ---> 
    theDir=GetDirectoryFromPath(GetCurrentTemplatePath()); 
    theFile=theDir & "courses.xls"; 
    //Create an empty ColdFusion spreadsheet object. ---> 
    theSheet = SpreadsheetNew("CourseData"); 
    //Populate the object with a query. ---> 
    SpreadsheetAddRows(theSheet,courses); 
</cfscript>

<!--- Write the sheet to a file ---> 
<cfspreadsheet action="write" filename="#theFile#" name="theSheet" sheetname="courses" overwrite=true> 
```

请参阅[SpreadsheetFormatColumn](http://help.adobe.com/en_US/ColdFusion/10.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-6806.html)、[SpreadsheetFormatColumns](http://help.adobe.com/en_US/ColdFusion/10.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-677a.html)、[SpreadsheetFormatRow](http://help.adobe.com/en_US/ColdFusion/10.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-676f.html)和[SpreadsheetFormatRows](http://help.adobe.com/en_US/ColdFusion/10.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-676e.html)的文档以了解有关格式化特定单元格的信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T13:03:29.210

您只需要使用`cfspreadsheet`标签来创建文件，并且您可以使用`spreadsheetFormat*`函数格式化单元格。[您可以在Ray Camden 的网站](http://www.raymondcamden.com/index.cfm/2011/6/1/ColdFusion-Sample--Create-an-Excel-File)上找到如何执行此操作的示例。

# algorithm - 将人们与他们不认识的人配对

> ID：14356975
> 
> 赞同：2
> 
> 时间：2013-01-16T11:10:09.327
> 
> 标签：algorithm, graph-algorithm

所以我遇到了一个问题。问题是：我有一群人，男性和女性，这些人有朋友（可能有数百人）和他们可以自由结识的时间（例如 19:00、20:00、21:00）。我想尽可能有效地匹配它们，以便尽可能少的人保持不匹配。规则是您必须与异性匹配，匹配不能是朋友，并且您的匹配必须与您有相同的可用时间。

我真的很感激对此的一些指示。提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-16T11:55:43.600

您正在查看[最大基数二分匹配](http://en.wikipedia.org/wiki/Matching_%28graph_theory%29#Maximum_matchings_in_bipartite_graphs)。您的图表是一个二分图（即可拆分为两组节点），其中一组是男性，另一组是女性。如果满足您的条件，则两个节点之间存在边。

# wordpress - 使用 wp_query 显示每个帖子类型的两个帖子

> ID：14356976
> 
> 赞同：0
> 
> 时间：2013-01-16T11:10:13.063
> 
> 标签：wordpress, post

我使用以下代码显示每个帖子中的一个帖子。

```
 $post_types = array('a', 's','d','f','g');//post type names
  foreach( $post_types as $post_type) :
  // The Query
  $the_query = new WP_Query( array(  'post_type' => $post_type,
                                     'orderby' => 'post_date',
                                     'order' => 'DESC',
                                     ));
  // The Loop
  ?>
  <?php
  while ( $the_query->have_posts() ) : $the_query->the_post(); ?>
  <?php if ( has_post_thumbnail() ) : ?>
    <div class="issue-content masonItem <?php echo $post_type; ?>">
      <?php
        $url = wp_get_attachment_url( get_post_thumbnail_id() );
        $resizedUrl = get_bloginfo('template_url')."/libs/timthumb.php?src=".$url."&amp;w=327&amp;h=204&amp;zc=1"; ?>
      <a href="<?php echo $post_type == 'news' ? site_url('/news')  : the_permalink(); ?>"><img src="<?php echo $resizedUrl; ?>" alt="<?php the_title(); ?>" class="masonry-thumb" /></a>

      <?php get_template_part( 'content-issues', 'page' );?>
    </div><!--issue-content--><!--Mason Item-->
    <?php endif; ?>
  <?php endwhile; 
```

现在我想显示每种帖子类型的 2 个帖子。我怎样才能做到这一点 ？我得到了 $post_count 的想法。但我不知道在我的代码中使用它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T07:17:28.073

试试这个 ：

```
'posts_per_page' => 2, 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-06T14:26:49.600

你试试这个

```
 $the_query = new WP_Query( array(  'post_type' => $post_type,'orderby' => 'post_date','posts_per_page' => 2,'order' => 'DESC')); 
```

# function - 尝试从 ListModel QML 中的 ListElement 调用自定义函数

> ID：14356977
> 
> 赞同：1
> 
> 时间：2013-01-16T11:10:16.787
> 
> 标签：function, listview, qml, defaultlistmodel

例如，我的 QML 中有这样的模型：

```
ListModel{
    id: mainlist
    ListElement
    {
        name: "Name1"
        type: "subMenu"
        toogle: false
        iconSource: ""

        function actionClick()
        {
            console.log("actionclick is passed for 0 item!")
        }
    }
    ListElement
    {
        name: "Manage Favorites"
        type: "subMenu"
        toogle: false
        iconSource: "image://provider/common/endless_menu/list_icons/fav"

        function actionClick()
        {
            console.log("actionclick is passed for 1 item!")
        }
    }
    ListElement
    {
        name: "Name2"
        type: "subMenu"
        toogle: false
        iconSource: "image://provider/common/endless_menu/list_icons/active"

        function actionClick()
        {
            console.log("actionclick is passed for 2 item!")
        }
    }
    ListElement
    {
        name: "Name3"
        type: "subMenu"
        toogle: false
        iconSource: "image://provider/common/endless_menu/list_icons/scan"

        function actionClick()
        {
            console.log("actionclick is passed for 3 item!")
        }
    }
    ListElement
    {
        name: "Manual Frequency Input"
        type: "commonBtn"
        toogle: false
        iconSource: ""

        function actionClick()
        {
            console.log("actionclick is passed for 4 item!")
        }
    }

    function onStart(currIndex)
    {
        console.log("test is passed for " + currIndex + "item!")
    }
} 
```

所以，我有 ListView 元素`id: optionlist`和 ListDelegate 用于控制列表元素。我有几个模型 - 所有这些元素都是为项目中的菜单选项创建的。因此，`onModelChanged: optionlist.model.onStart()`列表文件中的代码可以完美运行。

问题是从MouseArea 元素中`actionClick()`的 listDelegate 脚本调用函数。`OnClicked`是否有可能做到这一点？像这样的东西：`optionlist.model.ContentItem.children[currentIndex].actionClick()`也许还是别的什么？

更新：对不起，Amit Tomer，也许我没有正确解释任务......所以，我需要模型中的元素和下一个字段：

```
name: - text for element
type: - type of element (button, radio button, check button or submenu) - needed for corect action when user clicked on this item
toogle: - boolean value for radio/check buttons state, and for some internal operations.
iconSource: - path for icon, if it needed.

function actionClick() - function, which will be execute when user clicked on this item. 
```

所有这些都必须完成，以便清楚且轻松地填写所有选项菜单树。此菜单树将写入单独的文件中。

在下面的代码中，我展示了工作模型：

```
Item{
    id: menuoptions

    property ListModel prev: manageFavorites
    property bool root: true

//Main Menu
    property alias mainlist: mainlist
    ListModel{
        id: mainlist
        ListElement
        {
            name: "Band: "
            type: "subMenu"
            toggle: false
            iconSource: ""
        }
        ListElement
        {
            name: "Manage Favorites"
            type: "subMenu"
            toggle: false
            iconSource: "image://provider/common/endless_menu/list_icons/fav"
        }
        ListElement
        {
            name: "Show: "
            type: "subMenu"
            toggle: false
            iconSource: "image://provider/common/endless_menu/list_icons/active"
        }
        ListElement
        {
            name: "Scan"
            type: "subMenu"
            toggle: false
            iconSource: "image://provider/common/endless_menu/list_icons/scan"
        }
        ListElement
        {
            name: "Manual Frequency Input"
            type: "commonBtn"
            toggle: false
            iconSource: ""
        }

        function actionClick(currIndex)
        {
            switch(currIndex)
            {
                case 0:
                {
                    prev = mainlist
                    menuList.model = bandlist
                    break
                }
            case 1:
                {
                    prev = mainlist
                    menuList.model = manageFavorites
                    break
                }
            case 2:
                {
                    prev = mainlist
                    menuList.model = showlist
                    break
                }
            case 3:
                {
                    console.log("Scan started")
                    mainlist.setProperty(3, "name", getScan())
                    break
                }
            case 4:
                {
                    console.log("Speller for Manual Frequency Input open!")
                    break
                }
            }
        }

        function onStart()
        {
            console.log("root model loaded")
            root = true
            mainlist.setProperty(0, "name", "Band: " + getBand())
            mainlist.setProperty(2, "name", "Show: " + getShow())
            mainlist.setProperty(3, "name", getScan())
        }
    }

//First Lvl subMenu
    property alias bandlist: bandlist
    ListModel{
        id: bandlist
        ... Analog menulist
    }

    property alias manageFavorites: manageFavorites
    ListModel{
        id: manageFavorites
        ... Analog menulist
    }

    property alias showlist: showlist
    ListModel{
        id: showlist
        ... Analog menulist
    }
} 
```

如你所见，我写了类似你说的东西。没关系，如果我没有找到更好的解决方案。更好的解决方案 - 删除 actionClick() 通用函数并将其部分（案例块中的代码）分别添加到 ListElement。并在元素点击时调用它。

我不知道如何从 ListElement 调用这个函数。在 WPF 中，我将只创建自定义组件，它可以替代 ListElement 和所有组件！但我不知道如何在 QML 中做到这一点。

我有什么不清楚的 - 请询问。

更新：问题解决了。我的答案变体。谢谢大家。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T12:34:29.657

这个怎么样：

```
import QtQuick 1.0

Rectangle
{
    color: "grey"
    width:  800
    height: 800

    function actionClick(index)
    {
        if( 0 == listModel.get(index).internalIndex )
           functionForElement1()
        else if( 1 == listModel.get(index).internalIndex )
           functionForElement2()
        else if( 2 == listModel.get(index).internalIndex )
           functionForElement3()
        else if( 3 == listModel.get(index).internalIndex )
           functionForElement4()
        else if( 4 == listModel.get(index).internalIndex )
           functionForElement5()
    }

    functionForElement1() {  console.log("Inside Function 1")     }
    functionForElement2() {  console.log("Inside Function 2")     }
    functionForElement3() {  console.log("Inside Function 3")     }
    functionForElement4() {  console.log("Inside Function 4")     }
    functionForElement5() {  console.log("Inside Function 5")     }

    ListView
    {
        anchors.centerIn: parent
        width: parent.width
        height: parent.height
        model: listModel
        spacing: 10
        delegate: Component
        {
            Rectangle
            {
               x: 350
               y: 350
               width: 100
               height: 50
               Text { text: name ; anchors.centerIn: parent }

               MouseArea
               {
                  anchors.fill: parent
                  onClicked: actionClick( index )
               }
            }
        }

        ListModel
        {
            id: listModel

                 ListElement { name: "Apple",          internalIndex: 1}
                 ListElement { name: "badApple" ,      internalIndex: 2}
                 ListElement { name: "goodApple" ,     internalIndex: 3}
                 ListElement { name: "worseApple" ,    internalIndex: 4}
                 ListElement { name: "spoilledApple" , internalIndex: 5}
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T10:09:21.240

问题解决了。但并不像一开始的计划。

```
import QtQuick 2.0

/*
Elements of model:
name - displayed text
type - type of element, for clicked event
toggle - state for radio and check btn
iconSource - path to icon

*/
/*
TYPE:
radioBtn
checkBtn
commonBtn
subMenu
*/
Item{
    id: menuoptions

    //property ListModel prev: listmodel

    property Item curr: mainList

    //TEST FUNCTIONS
    property string band: "AM"
    property string show: "All"
    //END TEST FUNCTION

//Main Menu Radio
    Item{
        id: mainList
        property int count: 7
        property Item prev

        children:
        [
            Item
            {
                property string name: "Band: "
                property string type: "subMenu"
                property bool toggle: false
                property string iconSource: ""

                property bool need: true

                function onClick()
                {
                    curr = bandList
                    loadModel()
                }
            },
            Item
            {
                property string name: "Manage Favorites"
                property string type: "subMenu"
                property bool toggle: false
                property string iconSource: "image://provider/common/endless_menu/list_icons/fav"

                property bool need: true

                function onClick()
                {
                    curr = manageFavList
                    loadModel()
                }
            },
            Item
            {
                property string name: "Show: "
                property string type: "subMenu"
                property bool toggle: false
                property string iconSource: "image://provider/common/endless_menu/list_icons/active"

                property bool need: true

                function onClick()
                {
                    curr = showList
                    loadModel()
                }
            },
            Item
            {
                property string name: "Scan"
                property string type: "subMenu"
                property bool toggle: false
                property string iconSource: "image://provider/common/endless_menu/list_icons/scan"

                property bool need: true

                function onClick()
                {
                    if (!listmodel.get(menuList.currentIndex).toggle)
                    {
                        listmodel.setProperty(menuList.currentIndex, "toggle", true)
                        listmodel.setProperty(menuList.currentIndex, "name", "Scan")
                    }
                    else
                    {
                        listmodel.setProperty(menuList.currentIndex, "toggle", false)
                        listmodel.setProperty(menuList.currentIndex, "name", "Stop")
                    }

                }
            },
//optional
            Item
            {
                property string name: "Alternative Frequency"
                property string type: "checkBtn"
                property bool toggle: false
                property string iconSource: ""

                property bool need: false

                function onClick()
                {
                    if (listmodel.get(menuList.currentIndex).toggle)
                    {
                        listmodel.setProperty(menuList.currentIndex, "toggle", false)
                        listmodel.setProperty(menuList.currentIndex + 1, "toggle", false)
                    }
                    else
                    {
                        listmodel.setProperty(menuList.currentIndex, "toggle", true)
                    }
                }
            },
            Item
            {
                property string name: "Regionalization"
                property string type: "checkBtn"
                property bool toggle: false
                property string iconSource: "image://provider/common/endless_menu/list_icons/scan"

                property bool need: false

                function onClick()
                {
                    if (listmodel.get(menuList.currentIndex - 1).toggle)
                    {
                        if (listmodel.get(menuList.currentIndex).toggle)
                        {
                            listmodel.setProperty(menuList.currentIndex, "toggle", false)
                        }
                        else
                        {
                            listmodel.setProperty(menuList.currentIndex, "toggle", true)
                        }
                    }

                }
            },
//end optional
            Item
            {
                property string name: "Manual Frequency Input"
                property string type: "commonBtn"
                property bool toggle: false
                property string iconSource: ""

                property bool need: true

                function onClick()
                {
                    console.log("Speller for Manual Frequency Input open!")
                }
            }
        ]
        function preLoad()
        {
            console.log("preload Func")
            children[0].name = "Band: " + band
            children[2].name = "Show: " + show
            if (band == "SAT" || band == "AM")
            {
                children[4].need = false
                children[5].need = false
            }
            if (band == "FM")
            {
                children[4].need = true
                children[5].need = true
            }
        }
    }

//First Lvl subMenu Radio
    Item{
        id: bandList
        property int count: 3
        property Item prev: mainList

    //Analog as mainList
    }

    Item{
        id: manageFavList
        property int count: 3
        property Item prev: mainList

    //Analog as mainList
        function preLoad()
        {
            console.log("preload Func for Manage Favorite List")
            //Insert into model fav stations from 0 item
            //favcount = gateway.getFavCount()
        }
        function favClick()
        {
            console.log("Favorite item clicked")
        }
    }

    Item{
        id: showList
        property int count: 2
        property Item prev: mainList

    //Analog as mainList
    }

//Service Items
    property alias listmodel: listmodel
    ListModel{
        id: listmodel
}
    function loadModel()
    {
        console.log("loader menu")
        favcount = 0;
        listmodel.clear()
        curr.preLoad()
        for (var i=0;i<curr.count;i++)
        {
            if (curr.children[i].need){
                listmodel.append({"name": curr.children[i].name,
                                  "type":curr.children[i].type,
                                  "toggle":curr.children[i].toggle,
                                  "iconSource":curr.children[i].iconSource})
            }
        }
    }

    function actionClick(currIndex)
    {
        if (favcount == 0)
            curr.children[currIndex].onClick()
        else
        {
            if (currIndex <= favcount - 1)
                curr.favClick()
            else
               curr.children[currIndex-favcount].onClick()
        }
    }

    function toggled(index)
    {
        for (var i=0; i<listmodel.count; i++)
            listmodel.setProperty(i, "toggle", false)
        listmodel.setProperty(index, "toggle", true)
    }
} 
```

如您所见，更改 optionMenu 通过清理模型和填充 Item 中的元素来解决。

每个项目 - 是一个屏幕。

服务项目 - 通用组件和功能。

现在我认为，在其他文件中分离 menuTree（项目组件）会更好，因为会有 3 个不同的 OptionMenu 与不同的树。

# java - 从字符串中删除特定标记

> ID：14356979
> 
> 赞同：2
> 
> 时间：2013-01-16T11:10:30.607
> 
> 标签：java, string

我必须从 String 变量中删除特定的标记。

例如：如果字符串变量就像`"GUID+456709876790"`我需要`"GUID+"`从字符串中删除部分并且只需要`"456709876790"`.

如何做呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-16T11:12:16.293

两种选择：

*   由于您只是*从头开始*删除，因此您可以非常轻松地使用子字符串：

    ```
    text = text.substring(5);
    // Or possibly more clearly...
    text = text.substring("GUID+".length()); 
    ```

*   *要在字符串中的任何位置*删除它，只需使用替换：

    ```
    text = text.replace("GUID+", ""); 
    ```

注意`String.replace()`在后一种情况下使用 ，而不是`String.replaceAll()`- 后者使用正则表达式，这会影响`+`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-16T11:12:46.157

```
String s = "GUID+456709876790";
String token = "GUID+";
s = s.substring(s.indexOf(token) + token.length());
// or s = s.replace(token, ""); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-16T11:18:06.937

如果您正在使用 `apache.commons.lang`库，则可以使用`StringUtils`：

```
StringUtils.remove(yourString, token); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-16T11:13:06.137

```
 String str = "GUID+456709876790"

 str.substring(str.indexOf("+")+1) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-16T11:13:20.730

试试这个：

```
String a = "GUID+456709876790";
String s = a.replaceAll("\\D",""); 
```

我假设你只想要数字，因为我在这里使用了正则表达式来删除任何不是数字的东西

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-11-25T18:36:56.277

这对我有用

```
String Line="test line 1234 abdc",aux;
token=new StringTokenizer(Line);

 while(token.hasMoreTokens())
   if(!("1234").equals(aux=token.nextToken())){ 
     new_line+= aux+" ";
     System.out.println("la nueva string es: "+ new_line);
   } 
```

# asp.net - 将url传递给asp.net C#中的图像标签

> ID：14356981
> 
> 赞同：0
> 
> 时间：2013-01-16T11:10:34.397
> 
> 标签：asp.net

我不知道如何将值从 page.aspx.cs (string url = dr["report_image"].ToString();) 传递到 page.aspx ()

我将图像文件名（例如：sunset.jpg）保存到 sql 数据库并使用阅读器检索它（字符串 url = dr["report_image"].ToString();），我想使用这个 url（或文件名）在主网页（aspx）。我不知道如何将此值从“ *.aspx.cs”传递给“* .aspx”

任何帮助，将不胜感激。谢谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T11:15:21.067

```
<asp:Image ID="img" Runat="Server" /> 
```

Аnd 在代码中：

```
img.ImageUrl = url 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-16T11:39:05.743

或者您可以简单地在 aspx.cs 端生成 Image 元素。

下面的代码

```
 Image img = new Image();
 img.ImageUrl = "your string"; 
```

# html - 如何从二十一十二主题中删除响应式代码

> ID：14356982
> 
> 赞同：0
> 
> 时间：2013-01-16T11:10:36.940
> 
> 标签：html, css, wordpress, wordpress-theming

我一直在寻找这个问题的答案，但我找不到。我知道在 21 岁时它就像删除一些 CSS 一样简单。但我一生都无法弄清楚如何使 wordpress 3.5 中的二十十二个主题无响应。有谁知道怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T11:32:51.937

主题的响应性在媒体查询中本地化。

打开`style.css`文件，查找

```
 /* =Media queries
 -------------------------------------------------------------- */ 
```

只需删除所有行，直到

```
/* =Print 
```

它应该删除主题的响应功能

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-30T16:35:47.550

您可以从中选择您喜欢的样式并将它们作为子主题应用到 2011 年，而不是向后工程师二十二。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-01-30T05:14:48.197

只需删除与媒体查询相关的所有代码。

# c# - 是否有一些调试工具可以在平面表中显示结果

> ID：14356985
> 
> 赞同：3
> 
> 时间：2013-01-16T11:10:54.843
> 
> 标签：c#, asp.net, visual-studio, debugging, visual-studio-2008

我想问一下是否有一些调试工具可以在平面表中显示结果，以便于查找任何逻辑错误。

例如 ：：

![在此处输入图像描述](../Images/c8bc0eb593a43626f20c04ac3f2cfd3d.png)

现在我想在一个平面表中查看所有这些行，而不是通过调试器查看每一行。

有没有类似的工具`LINQPad`用于此目的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T11:17:30.787

Visual Studio 的调试器已经有一个内置的`DataTable`可视化工具。只需单击放大镜符号，您就可以将其作为表格进行检查。

如果您不分析 a `DataTable`but a `DataRowCollection`（如屏幕截图所示），则可以在调试器的快速监视窗口中使用它：

```
rows.Cast<DataRow>().CopyToDataTable() 
```

在那里执行后，您可以单击放大镜来检查表格。这也适用于`Linq`查询或 a 的`Rows`属性`DataTable`。

[**数据集可视化工具对话框**](http://msdn.microsoft.com/en-us/library/d480bk47.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T11:14:59.710

我不知道现有的以表格形式显示 DataRowCollection 的工具 - 但通常，这些类型的工具称为可视化工具。[这是有关它们的 MSDN 页面](http://msdn.microsoft.com/en-us/library/zayyhzts%28v=vs.100%29.aspx)- 包括有关如何构建自己的链接。这真的很简单。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-16T11:12:43.460

不，没有（我不知道），但您实际上可以编写自己的调试扩展。这并不难。

这里的主要问题更多是使用 DataTable，它很慢，占用内存，而且通常比实际对象更糟糕。

# javascript - 如何使用 jQuery 延迟鼠标离开动作

> ID：14356986
> 
> 赞同：2
> 
> 时间：2013-01-16T11:10:58.640
> 
> 标签：javascript, jquery, delay, mouseenter, mouseleave

我有一个菜单。在这个菜单中，我有一些隐藏的子菜单，所以我在悬停动作后显示它。我对子菜单的显示也有一些延迟效果。现在我想在隐藏它时添加相同的效果。但它不起作用。另外，如何在悬停/鼠标进入下一个菜单元素上添加一些延迟？

```
$('.main_menu ul li').on({
    mouseenter: function(){
        var self = this,
            time = 200;
        $(self).data('timer', setTimeout(function(){
            $(self).children('.sub_menu_main').addClass('opened');
        }, time));
    },
    mouseleave: function(){
        var self = this,
            time = 200;
        clearTimeout($(self).data('timer'));
        setTimeout(function() {
            $(self).children('.sub_menu_main').removeClass('opened');
        }, time);
    }
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T10:31:05.593

我很好地解决了这个问题，所以：

```
var timer;
$('.main_menu ul li').on({
    mouseenter: function(){
        var self = this;
        clearTimeout(timer);
        timer = setTimeout(function(){
            $(self).children('.sub_menu_main').addClass('opened');
        }, 100)
    },
    mouseleave: function(){
        var self = this;
        setTimeout(function(){
            if (!$(self).children('.sub_menu_main').is(":hover")){
                 $(self).children('.sub_menu_main').removeClass('opened');
            }
        }, 100);
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T11:13:31.540

可能是您没有`self`在 mouseleave 事件中使用吗？那个`this`函数里有什么？发表`debugger`声明，看看是否`this`是您认为它所指的事物。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T11:21:10.897

你考虑过使用`.delay()`吗？

[http://api.jquery.com/delay/](http://api.jquery.com/delay/)

# visual-studio-2010 - TF30170 : 无法再创建新的团队项目

> ID：14356991
> 
> 赞同：1
> 
> 时间：2013-01-16T11:11:08.663
> 
> 标签：visual-studio-2010, visual-studio, tfs, visual-studio-2012

我们曾经在安装 TFS 2010 时玩得很开心，但突然之间，它似乎在背后捅了我们一刀。

当我们尝试创建新的团队项目（通过 VS2010 或 VS2012 Team Explorer）时，TFS 在导入流程模板时遇到错误。我选择哪个已安装的模板都没有关系，错误总是一样的。

```
2013-01-16T11:11:08 | Modul: Work Item Tracking | Thread: 39 | Uploading task type from file "C:\Users\user1\AppData\Local\Temp\TPW_tmp447E.tmp\WorkItem     Tracking\TypeDefinitions\Bug.xml" hochgeladen...
---Begin Exception---
Zeit: 2013-01-16T11:11:08
Modul: Engine
Exception Description: TF30162: Error at Task "WITs" from Group "WorkItemTracking".
Exception Type: Microsoft.TeamFoundation.Client.PcwException
Exception Message: TF24016: Team project "MyInfoservice" not found.
Stacktrace:
   at Microsoft.VisualStudio.TeamFoundation.WorkItemTracking.WitPcwPlugin.PcwPluginComponentCreator.Execute(ProjectCreationContext ctxt, XmlNode taskXml)
   at Microsoft.VisualStudio.TeamFoundation.ProjectCreationEngine.TaskExecutor.PerformTask(IProjectComponentCreator componentCreator, ProjectCreationContext context, XmlNode taskXml)
   bei Microsoft.VisualStudio.TeamFoundation.ProjectCreationEngine.RunTask(Object taskObj)
--   Inner Exception   --
Ausnahmemeldung: TF24016: Team project "MyInfoservice" not found. (Type WitPcwFatalException)

Ausnahmestapelüberwachung:    at Microsoft.VisualStudio.TeamFoundation.WorkItemTracking.WitPcwPlugin.PcwPluginComponentCreator.ContextWrapper.get_Project()
   at Microsoft.VisualStudio.TeamFoundation.WorkItemTracking.WitPcwPlugin.PcwPluginComponentCreator.WitPcwTask.WorkItemTypesTask.UploadTypeDefinition(String file, Boolean execute)
   at Microsoft.VisualStudio.TeamFoundation.WorkItemTracking.WitPcwPlugin.PcwPluginComponentCreator.WitPcwTask.WorkItemTypesTask.Execute()
   at Microsoft.VisualStudio.TeamFoundation.WorkItemTracking.WitPcwPlugin.PcwPluginComponentCreator.Parse(ContextWrapper wrapper, XmlNode taskXml, Boolean fExecute)
   at Microsoft.VisualStudio.TeamFoundation.WorkItemTracking.WitPcwPlugin.PcwPluginComponentCreator.Execute(ProjectCreationContext ctxt, XmlNode taskXml)

---End Exception--- 
```

**编辑：**我的同事刚刚发现这不会发生在任何其他机器上，所以一定是我们的 Visual Studio 实例搞砸了。

那么他们为什么会搞砸呢？我们通过尝试进行灾难恢复导致了灾难（如果我们只有 TFS 集合的数据库转储会发生什么？）。简而言之，我们所做的：

*   备份 TFS 数据库（不将其与 TFS 分离）
*   创建第二个服务器并在那里重新连接数据库
*   在数据库上运行 TfsConfig Recover

乍一看，结果似乎还可以，但仔细一看，很多问题浮出水面。我猜他们回到了这样一个事实，即 Visual Studio 连接到具有相同项目和集合 GUID 的两台服务器，但这只是一个猜测。现在我们正试图让我们的机器恢复到只连接一个 TFS 时的工作方式。

尝试但不工作：

*   devenv 重置设置
*   删除下面的所有 VisualStudio 和 TeamFoundation 文件夹`C:\users\user1\AppData\Local`并`Roaming`
*   删除包含 TFS 服务器名称的注册表项

谁能指出我正确的方向，我们还能尝试什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T15:21:42.077

经过几次或多或少的绝望尝试，我终于能够解决这个问题。

由于将本地 Temp 文件夹中的文件上传到 TFS 时发生异常，因此我尝试清除整个 TEMP 文件夹。那成功了。相关信息是我上面贴的日志输出的第一行。

```
Uploading task type from file "C:\Users\user1\AppData\Local\Temp\TPW_tmp447E.tmp\WorkItemTracking\TypeDefinitions\Bug.xml" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-11-10T23:47:26.283

从备份恢复 TFS 2012 Express 集合后，我遇到了类似的问题。我通过删除本地开发人员上的 TFS 缓存解决了这个问题。机器。我刚刚删除了整个**缓存**文件夹...

```
C:\Users\myUsername\AppData\Local\Microsoft\Team Foundation\5.0\Cache 
```

如果你有另一个开发者。机器方便，然后您可以检查是否可以在其上创建 TFS 项目。如果可以，那么问题出在您的开发人员上。机器，很可能是缓存。

# gwt - 绕过 GWT 同源策略

> ID：14356993
> 
> 赞同：1
> 
> 时间：2013-01-16T11:11:11.107
> 
> 标签：gwt

我正在尝试实施此链接上建议的工作 [http://raibledesigns.com/rd/entry/how_to_do_cross_domain](http://raibledesigns.com/rd/entry/how_to_do_cross_domain) 我的服务器上现有的 Servlet 看起来像

```
@SuppressWarnings("serial")
public class ContactsServiceImpl extends RemoteServiceServlet  implements ContactsService   
{
 ... 
```

如何修改它以使跨域工作。我需要在客户端进行任何更改吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T01:35:51.920

It isn't the GWT Same Origin Policy - it is the browser itself! The browser won't normally allow any XHR call to go out to a server that isn't the same server the page was loaded from.

The link you mentioned lets your server act as a proxy - thats one way to let the client talk to another server. The steps they take (create a servlet that forwards requests, configure it to point at the other server you want to use) do not require changes to the client.

Another option is to use the [Cross Origin Resource Sharing](http://www.w3.org/TR/cors/) - a way for the *server* to specify that the browser is allowed to contact it, even across domains. The catch: not all browsers support it.

# facebook - Facebook.api 方法名称文档

> ID：14356997
> 
> 赞同：-3
> 
> 时间：2013-01-16T11:11:26.610
> 
> 标签：facebook, api, methods

我在哪里可以获得 Facebook.api 方法名称，例如获取登录的用户朋友，然后我们调用以下方法

Facebook.api('/我/朋友')

我想知道关于 '/me/friends' 、 '/me/albums' 等请求方法字符串的文档在哪里。

- 谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T11:18:20.523

很多信息可以在以下链接中找到：

[图形 API 文档](https://developers.facebook.com/docs/reference/api/)

[图形 API 资源管理器](https://developers.facebook.com/tools/explorer?method=GET&path=me/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T11:18:43.740

所有请求方法都没有这样的“文档”。

但是你可以看看：[Graph API Explorer](https://developers.facebook.com/tools/explorer?method=GET&path=me)

![sd](../Images/1d789e37adc0c05fbe963ca529415e39.png)