# StackOverflow 问答 14145000-14145999

# php - PHP请求串行处理而不是并行处理

> ID：14145001
> 
> 赞同：0
> 
> 时间：2013-01-03T18:33:52.243
> 
> 标签：php, imaplib

`cron.php`我写了一个页面`echo`（我有几十个邮箱需要运行相同的进程，所以我整理了一个`mailboxes.php`页面`cron.php`（过程完成时的页面。

然而，我注意到，如果我单击这些框中的每一个，它们会返回，就好像串行运行，而不是并行运行。是否有可以解释这一点的配置选项？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T18:36:34.207

是的，您需要`session_write_close()`在 cron.php 文件上使用。[session_write_close](http://php.net/manual/en/function.session-write-close.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T18:37:25.403

你在使用会话吗？每次`session_start`为给定会话运行时，它都会被锁定，直到脚本完成或会话被“分离”。

# javascript - NodeJS 应用程序仅返回 Socket.io 欢迎消息

> ID：14145023
> 
> 赞同：3
> 
> 时间：2013-01-03T18:35:05.953
> 
> 标签：javascript, node.js, websocket, socket.io

我有一个使用 Node 构建的跟踪应用程序，我们网络中的其他站点可以访问它。他们将通过 html 文件的头部访问应用程序，如下所示：

```
<title>Test</title>
<meta name="generator" content="TextMate http://macromates.com/">
<script src="http://mynetwork.com:1337/tracker.js?pid=publisher1&ps=home"></script>
</head>
<body> 
```

tracker.js 文件使用 socket.io 连接到在 MongoDB 中存储一些数据的 app.js。由于某种原因，当启动 socket.io 然后加载引用该 Tracker.js 脚本的页面时，我在第 1 行收到错误“Uncaught SyntaxError: Unexpected identifier”，实际上是“Welcome to socket.io.”消息而不是 javascript那是在文件中。

**这是 Tracker.js 的样子：**

```
(function(document, onload){

  var io = document.createElement('script');
  io.src = "//cdn.socket.io/stable/socket.io.js";
  io.setAttribute('async', 'true');
  if ( typeof onload === 'function') {
    io.onloadDone = false;
    io.onload = function() {
        io.onloadDone = true;
        onload();
    };
    io.onreadystatechange = function() {
        if ( "loaded" === io.readyState && !io.onloadDone ) {
            io.onloadDone = true;
            io.onload();
        }
    };
  }
  (document.getElementsByTagName('head') || document.getElementsByTagName('body'))[0].appendChild(io);

});

(document, function(){
  var socket = io.connect('http://mynetwork.com:1337');
   socket.emit('adTracker', 
    { adServer: 'datalunk', adZone : 'top_home', referingURL : 'site.com' } 
  );

   socket.on('entrance', function(){
    console.log('Response is:' + data.message);
   });
}); 
```

**app.js 文件如下所示：**

```
var io = require('socket.io');
var tracker = io.listen(1337);

tracker.configure(function () {
    tracker.set('authorization', function (handshakeData, callback) {
        if (handshakeData.xdomain) {
            callback('Cross-domain connections are not allowed');
        } else {
        callback(null, true);
        }
    });
});

tracker.sockets.on('connection', function (socket) {
  socket.on('entrance', {message: 'connection has been made to app.js'});
  socket.on('adTracker', function (data) {
  var adRequestData = data;
var pass = ["bigbooks"];
var databaseUrl = "user:pass@linus.mongohq.com:10006/node-test";
var collections = ["mads"]
var db = require("mongojs").connect(databaseUrl, collections);

db.cmnads.insert({adRequest : adRequestData}, {$set: {password: pass}}, function(err, updated) {
    if( err || !updated ) console.log("User not updated");
    else console.log("User updated");
});
  });
}); 
```

谁能告诉我为什么我会在第 1 行收到 socket.io 欢迎消息和错误，我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T18:50:11.097

```
(function(document, onload){

  var io = document.createElement('script');
  // rest of code
});

(document, function(){
 // rest of code
   });
}); 
```

应该

```
(function(document, onload){

  var io = document.createElement('script');
  // rest of code
})(document, function(){
 // rest of code
   });
}); 
```

你使用了一个你应该调用的匿名函数（你不这样做）。

正确的语法是（举一个更简单的例子）：

```
(function(a) {console.log(a)})('Hello World'); 
```

但是你这样做：

```
(function(a) {console.log(a)});
('Hello World'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T18:52:29.860

确保服务器安装了最新的稳定版本的 Node。据官网介绍，目前是v0.8.16。

此外，如果 socket.io 服务器在[http://mynetwork.com:1337/](http://mynetwork.com:1337/)上运行，那么我相信您应该能够包含来自[http://mynetwork.com:1337/socket.io/的 socket.io.js socket.io.js](http://mynetwork.com:1337/socket.io/socket.io.js)

检查 Node 版本是否是问题根源的最快方法是安装 Node Version Manager，然后安装 v0.8.16，最后再次运行 socket.io 服务器

```
wget -qO- https://raw.github.com/creationix/nvm/master/install.sh | sh
nvm install v0.8.16
nvm use 0.8.16
node yourSocketIOserver.js 
```

# c++ - 变量未在此范围 C++ 中声明

> ID：14145027
> 
> 赞同：-1
> 
> 时间：2013-01-03T18:35:18.497
> 
> 标签：c++, variables, declared-property

我试图在另一个名为 display 的 .h 文件中调用一个函数，该文件接收 a 的指针，`std::vector<vector<double> >`但是当我尝试调用它时，我得到错误未在此范围内声明变量。这是代码示例，希望对您有所帮助。

```
//proper includes above
#include <vector>
#include "display.h"
#include "extract_balls.h"

int main(void)   
{
    std::vector<vector<double> > balls_centroids;
    std::vector<vector<double> > balls_centroids_computed;

    balls_centroids = extract_balls();

    for (vector< vector<double> >::size_type u = 0; u < balls_centroids.size(); u++) {
        vector<double> x = balls_centroids.at(u);
        x[0] = farest_point[0]-x[0];
        x[1] = farest_point[1]-x[1];
        x[2] = farest_point[2]-x[2];
        balls_centroids_computed.push_back(x);
    }

    display(&balls_centroid_computed);
} 
```

display.h 文件是这样的：

```
#include <vector>

void display(std::vector<std::vector<double> >& coord){

           //do stuff
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-03T18:46:12.270

您声明：

```
std::vector<vector<double> > balls_centroids_computed; 
```

但你试着打电话

```
display(&balls_centroid_computed); 
```

`_centroid_`注意单数和复数的区别`_centroids_`...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T18:37:28.517

> 我正在尝试调用`display()`接收指针 [...] 的 [...]

根据原型，`display()`接受引用而不是指针。

因此，您不需要在

```
 display(balls_centroid_computed); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-03T18:49:15.513

正如您所说， display() 函数实际上并没有收到指针。

如果您希望它接收指针，请将其声明为：

```
void display(std::vector<std::vector<double> > * coord){

       //do stuff 
```

}

与号表示您正在传递“参考”。建议你只改变

```
display (balls_centroid_computed) 
```

由于函数被声明为引用，您仍然可以获得传递指针的大部分好处（避免将整个结构放入堆栈）。

# sql - 更改表中数据的日期和时间戳格式

> ID：14145030
> 
> 赞同：3
> 
> 时间：2013-01-03T18:35:29.847
> 
> 标签：sql, oracle, date, timestamp-with-timezone

我们有一个巨大的 Oracle 数据库，其中包含具有日期和时间戳的数据。现在我们正在使用`mm-dd-yyyy format for date and EST Time zone for time stamp`.

现在我们需要更改`date format as yyyy-mm-dd and time stamps should be GMT timezone`. 我们需要将表中已经存在的数据以及新插入的数据更改为这种新格式。

关于如何实现这一目标的任何帮助？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-03T21:16:47.437

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T18:52:52.323

您可以使用[new_time](http://www.techonthenet.com/oracle/functions/new_time.php) oracle 函数

```
SELECT to_char(new_time(to_date('01-03-2013','mm-dd-yyyy HH24:MI'), 
                        'EST', 'GMT'),'yyyy-mm-dd HH24:MI') d
FROM DUAL; 
```

使用它来测试您的数据库：

```
SELECT to_char(new_time(sysdate, 'EST', 'GMT'),'yyyy-mm-dd HH24:MI') d
FROM DUAL; 
```

# javascript - 现在我添加了 javascript，我的 jquery 日历弹出不再有效

> ID：14145034
> 
> 赞同：-1
> 
> 时间：2013-01-03T18:35:50.563
> 
> 标签：javascript, jquery

现在我添加了 javascript 来添加多张图片，我的 jquery 日历弹出不再起作用。我是 javascript 和 jquery 的新手。任何帮助，将不胜感激。

我正在尝试制作一个网络表单，我可以选择日期然后在其下方附加多张图片。我只是将图片链接输入字段作为占位符，直到我得到一个处理照片并上传它们的过程。

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
    <title>newRecord</title>

    <style type="text/css">
        div.ui-datepicker{
            font-size:10px;
        }
    </style>

    <link rel="stylesheet" href="http://code.jquery.com/ui/1.9.2/themes/base/jquery-ui.css" />    
    <script src="http://code.jquery.com/jquery-1.8.3.js"></script>    
    <script src="http://code.jquery.com/ui/1.9.2/jquery-ui.js"></script>    
    <link rel="stylesheet" href="/resources/demos/style.css" />    
    <script>    $(function() {        $( "#datepicker" ).datepicker({changeMonth: true, changeYear: true}) });</script>
    <script>    $(function() {        $( "#datepicker2" ).datepicker({changeMonth: true, changeYear: true}) });</script>

    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3/jquery.min.js"></script>       
    <script type="text/javascript">         
        $(document).ready(function() {
            $('#btnAdd').click(function() {       
                var num     = $('.clonedInput').length;                 
                var newNum  = new Number(num + 1);              
                var newElem = $('#input' + num).clone().attr('id', 'input' + newNum);                       
                newElem.children(':first').attr('id', 'name' + newNum).attr('name', 'name' + newNum);                 
                $('#input' + num).after(newElem);                 
                $('#btnDel').attr('disabled','');                   
                if (newNum == 50)                  
                    $('#btnAdd').attr('disabled','disabled');
            });               
            $('#btnDel').click(function() {        
                var num = $('.clonedInput').length;                   
                $('#input' + num).remove();                
                $('#btnAdd').attr('disabled','');
                if (num-1 == 1)                     
                    $('#btnDel').attr('disabled','disabled');             
            });               
            $('#btnDel').attr('disabled','disabled');
        });    
    </script> 
</head>
<body>
    <form action="insert.php" method="post">
        ID: <input name="ID" type="text"><br>
        serial_number: <input name="serial_number" type="text"><br>
        desc: <input name="desc" type="text"><br>
        dmg: <input name="dmg" type="text"><br>
        dmg_desc: <input name="dmg_desc" type="text"><br>
        pic_link: <input name="pic_link" type="text"><br>
        creation_date:<input type="text" name="creation_date" id="datepicker" value="" /><br>
        created_by: <input name="created_by" type="text"><br>
        last_update_date:<input type="text" name="last_update_date" id="datepicker2" value="" /><br>
        last_update_by: <input name="last_update_by" type="text"><br>

        <div id="input1" style="margin-bottom:4px;"class="clonedInput">
            Picture Upload: <input type="file" name="name1" id="name1" />     
        </div>       
        <div>        
        <input type="button" id="btnAdd" value="add another picture" />         
        <input type="button" id="btnDel" value="remove picture" />     
        </div> 

        <input type="submit">
        <br><br><br>
        <a href="http://www.sweatmansc.com/displayResults.php">Go to All results of table!</a>
    </form>
</body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T18:40:46.850

消除

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3/jquery.min.js"> 
```

从您的代码中，但保留

```
<script src="http://code.jquery.com/jquery-1.8.3.js"></script> 
```

# android - android：在画布上为绘制的圆圈设置动画的最流畅和最有效的方法

> ID：14145036
> 
> 赞同：1
> 
> 时间：2013-01-03T18:36:02.593
> 
> 标签：android

在应该具有 alpha 层并更改大小的画布上绘制圆圈的最佳方法是什么？我应该使用视图还是 Surfaceview？圆圈也应该是可点击的。改变颜色大小和位置时应该是平滑过渡吗？

我应该把它放在一个可运行的还是在onDraw中使用invlaidate？

我希望这样的东西在低端设备中也能顺利运行。

有什么建议么？我是 Android 中这种动画的新手。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T20:01:54.837

如果您同时不断地绘制和接受用户输入，我会使用 SurfaceView。但是，如果您计划对圆圈进行的唯一绘制更改发生在您触摸它们时，那​​么简单的 View onDraw() 覆盖可能会解决问题。最终，它只取决于发生了什么。

SurfaceView 的重点是拥有用于绘图的单独线程。如果你正在做的事情在任何方面都被认为是“类似游戏的”，那么选择 SurfaceView；否则，坚持使用视图。

我这样说是因为我目前正在使用视图进行持续绘图的项目。我正在绘制的形状响应触摸，您可以在视图仍然一遍又一遍地失效时滚动视图。所有这一切都有一个视图，它在低端设备上仍然运行得很好（不过我只回到了 GingerBread）。

祝你好运！

我还应该提到，在视图中的项目绘图中，几乎所有内容都有各种 alpha 值，而没有的则运行良好。

# messagebroker - 解析消息时出现异常

> ID：14145037
> 
> 赞同：2
> 
> 时间：2013-01-03T18:36:02.193
> 
> 标签：messagebroker

我正在使用消息集来解析文件，但出现以下异常。我无法理解它的实际含义。请帮助我理解并解决问题。

```
<ParserException>
        <File>/build/S000_P/src/MTI/MTIforBroker/MtiImbParser2/MtiImbFIHandler.cpp</File>
        <Line>1017</Line>
        <Function>MtiImbFIHandler::endMessageContent</Function>
        <Type></Type>
        <Name></Name>
        <Label></Label>
        <Catalog>BIPmsgs</Catalog>
        <Severity>3</Severity>
        <Number>5288</Number>
        <Text>MTI. Not all the buffer was used when reading message</Text>
        <Insert>
         <Type>2</Type>
         <Text>0</Text>
        </Insert>
        <Insert>
         <Type>2</Type>
         <Text>1659</Text>
        </Insert>
       </ParserException> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-16T21:06:51.870

当消息集在数据之前“结束”时会发生这种错误。例如：
我们有一个这样的消息集：
NAME - 5 CHAR
SURNAME - 5 CHAR

数据为：MARIOROSSIAAAAA

Parsed 会引发这种异常，因为 msg 集不期望字符串“AAAAA”，而只是：NAME = “MARIO”
SURNAME = “ROSSI”

没有确切的例子是不可能的。

# database - Joomla 3.0 组件 - 使用 JInput 将字段输入添加到 JForm

> ID：14145050
> 
> 赞同：1
> 
> 时间：2013-01-03T18:36:42.170
> 
> 标签：database, joomla, upload, joomla3.0, jform

我在管理视图中添加了一个字段来上传文件。上传部分工作正常，但表单不会在保存时将文件名添加到数据库中。我在这里看到了一个类似的堆栈溢出问题，但他们正在使用 JRequest::setVar 现已弃用：[如何在数据库中保存上传的文件名](https://stackoverflow.com/questions/12927464/how-to-save-uploaded-files-name-on-database?rq=1)

我需要添加到“jform”数组但是当我使用时： $jinput->set('jform',array('foo' => 'bar')); 它会覆盖包含在表单中输入的其他数据的现有“jform”数组：

```
JInput Object (
    [data:protected] => Array (
        [jform] => Array (
            [foo] => bar
            ... 
```

有没有人对如何添加到 jform 数组而不覆盖它有任何建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T19:44:34.727

好的，所以我觉得有点愚蠢-我已经解决了自己的问题！

我所做的是使用：获取所有其他 jform 数据，`$jinput->get('jform', NULL, NULL);`然后用于`array_merge`添加其他数组。

然后我使用：`$jinput->post->set('jform',$mergedArray);` 将数组放回POST。

希望这可以帮助某人

# header - 缺少 linux/types.h 无法安装 gem

> ID：14145056
> 
> 赞同：0
> 
> 时间：2013-01-03T18:37:07.210
> 
> 标签：header, rubygems, ubuntu-12.04, eventmachine

尝试在我的 ubuntu 12.04 服务器上安装 eventmachine 时出错。有任何想法吗？

```
bundle exec gem install eventmachine
Building native extensions.  This could take a while...
ERROR:  Error installing eventmachine:
    ERROR: Failed to build gem native extension.

        /opt/ruby-enterprise-1.8.7-2012.02/bin/ruby extconf.rb
checking for rb_trap_immediate in ruby.h,rubysig.h... no
checking for rb_thread_blocking_region()... no
checking for inotify_init() in sys/inotify.h... yes
checking for writev() in sys/uio.h... yes
checking for rb_thread_check_ints()... no
checking for rb_time_new()... yes
checking for sys/event.h... no
checking for epoll_create() in sys/epoll.h... yes
creating Makefile

make
g++  -I. -I/opt/local/include -I. -I/opt/ruby-enterprise-1.8.7-2012.02/lib/ruby/1.8/i686-linux -I. -DWITH_SSL -DBUILD_FOR_RUBY -DHAVE_INOTIFY_INIT -DHAVE_INOTIFY -DHAVE_WRITEV -DHAVE_WRITEV -DHAVE_RB_TIME_NEW -DOS_UNIX -DHAVE_EPOLL_CREATE -DHAVE_EPOLL  -D_FILE_OFFSET_BITS=64  -fPIC -g -O2       -c binder.cpp
In file included from /usr/include/i386-linux-gnu/bits/sigcontext.h:28:0,
                 from /usr/include/signal.h:339,
                 from project.h:40,
                 from binder.cpp:20:
/usr/include/i386-linux-gnu/asm/sigcontext.h:5:25: fatal error: linux/types.h: No such file or directory
compilation terminated.
make: *** [binder.o] Error 1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-08T09:39:11.727

我刚刚遇到了同样的问题。types.h 的路径在您的发行版中不同，或者根本不存在。尝试手动包含它。
[http://linux.die.net/include/sys/types.h](http://linux.die.net/include/sys/types.h)

您的程序将在尝试“包含”types.h 时为您提供一个文件和行号错误。我为解决这个问题所做的是将 types.h 添加到与请求它的文件相同的文件夹中。然后你进入文件，在包含错误所在的行上，并用“types.h”替换（例如）“/linux/types.h”的路径，因为它在同一个目录中。现在，制作，制作安装。如果您收到另一个包含问题，您可能需要考虑更改口味，或者如果您愿意，请继续添加包含。欢迎来到黑客的美妙世界。:)

# android - 从多部手机的联系人中获取电话号码

> ID：14145064
> 
> 赞同：0
> 
> 时间：2013-01-03T18:37:45.593
> 
> 标签：android, contact

我正在尝试获取列出多个电话号码的联系人。我已经开始了一项活动并必须选择一个联系人，但现在我想向用户展示以选择列出更多电话的特定联系人的电话。我已经设法从所有联系人的电话列表中进行选择，但我想先选择一个联系人，然后再选择电话号码。

我如何做到这一点？我应该为此开始一项新活动吗？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T19:04:34.037

你可以尝试类似[android_contact_picker](https://github.com/codinguser/android_contact_picker)

### 示例用法：

如果您只想从应用程序中打开联系人选择器然后获取号码，请执行以下操作：

```
private static final int GET_PHONE_NUMBER = 3007;

public void getContact() {
    startActivityForResult(new Intent(this, ContactsPickerActivity.class), GET_PHONE_NUMBER);
}

// Listen for results.
@Override  
protected void onActivityResult(int requestCode, int resultCode, Intent data){
    // See which child activity is calling us back.
    switch (requestCode) {
        case GET_PHONE_NUMBER:
            // This is the standard resultCode that is sent back if the
            // activity crashed or didn't doesn't supply an explicit result.
            if (resultCode == RESULT_CANCELED){
                Toast.makeText(this, "No phone number found", Toast.LENGTH_SHORT).show();
            } 
            else {
                String phoneNumber = (String) data.getExtras().get(ContactsPickerActivity.KEY_PHONE_NUMBER);  
                //Do what you wish to do with phoneNumber e.g.
                //Toast.makeText(this, "Phone number found: " + phoneNumber , Toast.LENGTH_SHORT).show();
            }
        default:
            break;
    }
} 
```

# java - EqualsBuilder.reflectionEquals 依赖于每个字段的 equals 实现

> ID：14145065
> 
> 赞同：1
> 
> 时间：2013-01-03T18:38:12.603
> 
> 标签：java, apache-commons

我想在我的一些测试中使用reflectionEquals，但发现它仅在所有非空字段的类都实现等于时才有效。我的某些领域并非如此。我考虑过使用一个覆盖等于的子类，并在未实现等于（标头）的字段上显式使用反射等于。这可行，但很混乱，想检查是否有更好的方法。identity equals 在我的测试中不起作用的原因是我正在使用 gson 将对象编组到数据库。这是我的子类解决方案：

```
 @Override
    public boolean equals(Object obj) {
        TrackingEvent other = (TrackingEvent) obj;
        return EqualsBuilder.reflectionEquals(this.getHeaders(), other.getHeaders()) && 
                EqualsBuilder.reflectionEquals(this, other, new String[] {"headers"});
    } 
```

# jquery - 当页面长于窗口时，jQuery拖放无法正常工作

> ID：14145066
> 
> 赞同：2
> 
> 时间：2013-01-03T18:38:17.127
> 
> 标签：jquery, internet-explorer, drag-and-drop

我已经在我的应用程序中实现了 jQuery 拖放，它可以在除 IE 之外的任何地方工作，如果页面小于窗口（没有滚动条），它也可以在那里工作。如果页面太长并且可拖动对象靠近底部，则每次拖动都会使页面跳回顶部，然后在移动项目时内容会疯狂闪烁。有没有人见过这个？启动 sortable 的代码几乎是单行的：

```
jQuery('#childrenlist').sortable({items:'div', update:updateChildrenOrder}); 
```

更新：我可以通过设置 scroll:false 并设置容器的高度来消除抖动，如下所示：

```
jQuery('#childrenlist').sortable({
    items:'.sortrow', 
    scroll: false,
    update:updateChildrenOrder,
    create:function(){
        jQuery(this).height(jQuery(this).height());
    }
}); 
```

但是排序仍然不起作用，因为当我开始拖动任何元素时，拖动的元素仅出现在页面的最顶部（屏幕外）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-28T16:21:37.853

我花了一天多的时间来解决具有相同症状的问题。它仅在 IE 中。更符合标准的浏览器没有这些错误：

1.  摇晃的对话框拖动。
2.  jQuery UI 对话框在打开时的位置没有居中或在开口之间被记住。
3.  jQuery UI 对话框调整大小导致子 DIV 意外缩小。

对我来说，这归结为缺少 DOCTYPE 声明。我希望这对其他人有帮助。我没有测试所有的 DOCTYPE。XHTML 1.0 Strict 证明了我的解决方案。

研究类似的问题，我发现了[有关](https://stackoverflow.com/questions/3523747/webkit-and-jquery-draggable-jumping)窗口偏移量计算错误的信息，这对我来说很有意义。如果 DOCTYPE 没有帮助，我会追求那个角度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T11:16:34.613

是的，原因之一可能是 DOCTYPE 声明丢失或不正确。此外，如果您希望 IE 在标准模式而不是怪癖模式下工作，那么在 IE 中的 DOCTYPE 声明之前绝对不应该出现任何内容（甚至没有注释）。Quirks 模式会错误地渲染 CSS，并且还会对 CSS 框模型进行自己的修改，这可能是由于位置计算不正确而导致 jQuery 拖放问题的根本原因。做这个：

```
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge" >
<title>Insert title here</title>
</head>
<body>
Content here
</body>
</html> 
```

# ruby - Ruby：如何并行接收和发送数据？

> ID：14145078
> 
> 赞同：0
> 
> 时间：2013-01-03T18:39:03.370
> 
> 标签：ruby, sockets, network-programming, udp

我想创建一个并行发送和接收数据的应用程序，例如聊天应用程序。它获取输入并发送一些输出，但不仅限于接收数据。我想使用 UDP 作为协议。我正在使用红宝石 1.9.3。

这是接收数据的代码：

```
@s = UDPSocket.new
@s.bind(localhost, 1234)

Socket.udp_server_loop_on([@s]) do |message, sender|
  #do something
end 
```

此代码应该独立于应用程序的其余部分运行，它不应该阻止它。

我应该使用线程吗？我从未尝试过网络程序，也不是专业的开发人员，所以请耐心等待。也许我的代码/设计只是废话，所以请随时告诉我这是如何由专业人士完成的！;)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T18:55:23.900

UDP 非常自然地为自己提供了这种非阻塞处理，因为您通过套接字接收单独的原子消息并且可以以相同的方式回复。

在该循环中，请确保快速处理并发送响应消息。如果您进行长时间的阻塞调用，它将阻塞您的循环并影响响应时间。

[EventMachine](http://eventmachine.rubyforge.org/)提供了一种用于编写异步应用程序的结构，并且有自己的方法来处理 UDP 和 TCP 套接字。

不要忘记查看已经实施的解决方案。对于聊天应用程序，[Socket.IO](http://socket.io/)是一个很好的起点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T18:50:14.530

您应该看一下可以[`Eventmachine`](https://github.com/eventmachine/eventmachine)非常有效地处理阻塞 IO 的 gem。除其他外，它还提供 TCP 和 UDP 服务器/客户端 API。

# mysql - sql告诉已经过去了多少天（datediff）

> ID：14145079
> 
> 赞同：0
> 
> 时间：2013-01-03T18:39:05.363
> 
> 标签：mysql, sql, select, datediff

我正在做一个项目，我想在 3 天后显示数据。

我遇到的问题是在 php/sql 中动态获取当前日期。我知道如何在 php 中获取当前日期，但我不知道如何将该值与我在 sql 数据库中的日期进行比较。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T18:40:22.500

您可以直接在 SQL 中执行此操作

```
select * from your_table
where date_column <= curdate() - interval 3 day 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T18:53:58.953

您可以使用**DATEDIFF**函数来检查天数。

```
SELECT * 
FROM tablename
WHERE DATEDIFF(CURRENT_DATE(), datecol) >= 3; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-03T18:41:49.483

如果您检查的列是时间戳、日期或日期时间，您可以使用间隔选择将记录限制在 3 天内。

```
select * from tablename where timestamp_column >= NOW() - INTERVAL 3 DAY 
```

# python - file.tell() 不一致

> ID：14145082
> 
> 赞同：40
> 
> 时间：2013-01-03T18:39:14.387
> 
> 标签：python, python-2.7, file, buffering

当您以这种方式迭代文件时，是否有人碰巧知道为什么：

## 输入：

```
f = open('test.txt', 'r')
for line in f:
    print "f.tell(): ",f.tell() 
```

## 输出：

```
f.tell(): 8192
f.tell(): 8192
f.tell(): 8192
f.tell(): 8192 
```

我总是从 tell() 得到错误的文件索引，但是，如果我使用 readline，我会得到 tell() 的适当索引：

## 输入：

```
f = open('test.txt', 'r')
while True:
    line = f.readline()
    if (line == ''):
        break
    print "f.tell(): ",f.tell() 
```

## 输出：

```
f.tell(): 103
f.tell(): 107
f.tell(): 115
f.tell(): 124 
```

我正在运行 python 2.7.1 BTW。

* * *

## 回答 #1

> 赞同：62
> 
> 时间：2013-01-03T18:41:31.503

使用打开文件作为迭代器使用预读缓冲区来提高效率。因此，当您遍历行时，文件指针会在文件中大步前进。

从[文件对象](http://docs.python.org/2/library/stdtypes.html#file.next)文档中：

> 为了使 for 循环成为循环文件行的最有效方式（一种非常常见的操作），该`next()`方法使用隐藏的预读缓冲区。作为使用预读缓冲区的结果，`next()`与其他文件方法（如`readline()`）组合不能正常工作。但是，使用`seek()`将文件重新定位到绝对位置将刷新预读缓冲区。

如果您需要依赖`.tell()`，请不要将文件对象用作迭代器。您可以`.readline()`改为使用迭代器（以牺牲一些性能为代价）：

```
for line in iter(f.readline, ''):
    print f.tell() 
```

这使用[`iter()`函数](http://docs.python.org/2/library/functions.html#iter) `sentinel`参数将任何可调用对象转换为迭代器。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-01-03T18:44:12.560

答案就在 Python 2.7 源代码 ( ) 的以下部分`fileobject.c`：

```
#define READAHEAD_BUFSIZE 8192

static PyObject *
file_iternext(PyFileObject *f)
{
    PyStringObject* l;

    if (f->f_fp == NULL)
        return err_closed();
    if (!f->readable)
        return err_mode("reading");

    l = readahead_get_line_skip(f, 0, READAHEAD_BUFSIZE);
    if (l == NULL || PyString_GET_SIZE(l) == 0) {
        Py_XDECREF(l);
        return NULL;
    }
    return (PyObject *)l;
} 
```

如您所见，`file`的迭代器接口以 8KB 的块为单位读取文件。这解释了为什么`f.tell()`它的行为方式。

该文档[建议](http://docs.python.org/2/library/stdtypes.html#file.next)出于性能原因这样做（并且不保证预读缓冲区的任何特定大小）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-08-10T19:23:14.327

我遇到了相同的预读缓冲区问题，并使用[Martijn 的建议](https://stackoverflow.com/questions/14145082/file-tell-inconsistency/14145118#14145118)解决了它。

从那以后，我将我的解决方案推广给其他想要做这些事情的人：

[https://github.com/loisaidasam/csv-position-reader](https://github.com/loisaidasam/csv-position-reader)

快乐的 CSV 解析！

# plone - 在 Plone 上使用 Dexterity 按文件类型或 mimetype 限制上传

> ID：14145087
> 
> 赞同：4
> 
> 时间：2013-01-03T18:39:49.137
> 
> 标签：plone, dexterity

我有一个自定义的内容类型，用灵巧构建。在架构中（架构在下面列出），我使用“ **plone.namedfile.field.NamedFile** ”进行附件/上传。

我想限制上传，以便只有 mp3 文件可以附加到我的内容类型。实现这一目标的最佳方法是什么？

这是我的内容类型的完整架构/模型：

```
<model xmlns="http://namespaces.plone.org/supermodel/schema">
<schema>
<field name="date" type="zope.schema.Date">
<description />
<title>Date</title>
</field>
<field name="speaker" type="zope.schema.TextLine">
<description />
<title>Speaker</title>
</field>
<field name="service" type="zope.schema.Choice">
<description />
<title>Service</title>
<values>
<element>1st Service</element>
<element>2nd Service</element>
</values>
</field>
<field name="audio_file" type="plone.namedfile.field.NamedFile">
<description />
<title>Audio File</title>
</field>
</schema>
</model> 
```

我将在这里开始搜索：http: [//plone.org/products/dexterity/documentation/manual/developer-manual/reference/default-value-validator-adaptors](http://plone.org/products/dexterity/documentation/manual/developer-manual/reference/default-value-validator-adaptors)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T19:15:31.827

我决定使用 javascript 进行第一行验证。我的解决方案基于在[<input type="file"> 通过扩展名限制可选文件中找到的信息](https://stackoverflow.com/questions/5796537/input-type-file-limit-selectable-files-by-extensions)

根据建议，我的脚本如下所示：

```
$(document).ready( function() {

function checkFile(event) {
        var fileElement = document.getElementById("form-widgets-audio_file-input");
        var fileExtension = "";
        if (fileElement.value.lastIndexOf(".") > 0) {
            fileExtension = fileElement.value.substring(fileElement.value.lastIndexOf(".") + 1, fileElement.value.length);
        }
        if (fileExtension == "mp3") {
            return true;
        }
        else {
            alert("You must select a mp3 file for upload");
            return false;
        }
    }

$("form#form").bind("submit",checkFile);

}); 
```

这是解决方案的一半，接下来我需要在服务器端添加验证。

# asp.net - 在 Web API / APIController 中控制序列化

> ID：14145097
> 
> 赞同：9
> 
> 时间：2013-01-03T18:40:12.640
> 
> 标签：asp.net, serialization, asp.net-web-api, deserialization

在哪里可以在 ASP.NET Web API 中指定自定义序列化/反序列化？

我们应用程序的吞吐量需要消息的快速序列化/反序列化，因此我们需要严格控制这部分代码，以使用我们的自制软件或 OSS。

我已经检查了各种来源，例如[解释](http://blogs.msdn.com/b/jmstall/archive/2012/04/23/how-to-create-a-custom-value-provider-in-webapi.aspx)如何创建自定义值提供者的各种来源，但我还没有看到一个解释端到端过程的示例。

任何人都可以指导/向我展示序列化传入/传出消息的方式吗？

还感谢 Web API 中类似于[WCF](http://msdn.microsoft.com/en-us/magazine/cc163302.aspx)的各种注入点/事件接收器的图表！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-03T18:56:03.370

您正在寻找的扩展点是 MediaTypeFormatter。它控制从请求正文读取和写入响应正文。这可能是编写自己的格式化程序的最佳资源：

[http://www.asp.net/web-api/overview/formats-and-model-binding/media-formatters](http://www.asp.net/web-api/overview/formats-and-model-binding/media-formatters)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-09-01T13:31:46.513

这是上面答案中的链接失效的代码示例

```
public class MerlinStringMediaTypeFormatter : MediaTypeFormatter
{
    public MerlinStringMediaTypeFormatter()
    {
        SupportedMediaTypes.Add(new MediaTypeHeaderValue("text/plain"));
    }

    public override bool CanReadType(Type type)
    {
        return type == typeof (YourObject); //can it deserialize
    }

    public override bool CanWriteType(Type type)
    {
        return type == typeof (YourObject); //can it serialize
    }

    public override Task<object> ReadFromStreamAsync( 
        Type type, 
        Stream readStream, 
        HttpContent content, 
        IFormatterLogger formatterLogger)
    {
        //Here you put deserialization mechanism
        return Task<object>.Factory.StartNew(() => content.ReadAsStringAsync().Result);
    }

    public override Task WriteToStreamAsync(Type type, object value, Stream writeStream, HttpContent content, TransportContext transportContext)
    {
        //Here you would put serialization mechanism
        return base.WriteToStreamAsync(type, value, writeStream, content, transportContext);
    }
} 
```

然后你需要注册你的格式化程序`Global.asax`

```
protected void Application_Start()
    {
        config.Formatters.Add(new MerlinStringMediaTypeFormatter());
    } 
```

希望这可以节省您一些时间。

# php - PHP 5.3 中的 1357133639816 毫秒转换

> ID：14145101
> 
> 赞同：0
> 
> 时间：2013-01-03T18:40:24.433
> 
> 标签：php, milliseconds, datetime-conversion

我到处寻找使用**PHP 5.3将****1357133639816 毫秒**转换为**dd-mm-yyyy h:m:s**的解决方案，并将当前服务器时间转换为与上面给出的相同的毫秒格式。

 **此值是从 android 上的 SMS 中提取的，显示时间值为**02-Jan-2012 07:03 PM**

我努力寻找和测试尽可能多的在线代码。

PS - [http://codepad.org](http://codepad.org)帮助快速执行任何测试代码（如果您想在发布之前测试 urs）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-03T20:16:29.483

Just like [this question and its answers](https://stackoverflow.com/questions/557959/php-convert-milliseconds-to-date) say, you simply need to convert the timestamp to seconds by dividing it by 1000 and then use [`date()`](http://php.net/date) to format it:

```
$mil = 1357133639816;
$seconds = $mil / 1000;
echo date("d-m-Y H:i:s T", $seconds); 
```

[Output](http://codepad.org/YjRplm9B):

```
02-01-2013 13:33:59 UTC 
```

To change the output to your local timezone, you can use [`date_default_timezone_set()`](http://php.net/date_default_timezone_set):

```
date_default_timezone_set("Asia/Calcutta");

$mil = 1357133639816;
$seconds = $mil / 1000;
echo date("d-m-Y H:i:s T", $seconds); 
```

[Output](http://codepad.org/H51LX0JX):

```
02-01-2013 19:03:59 IST 
```**

# jquery - 无法触发“CheckAll”方法 - jQuery UI MultiSelect 小部件

> ID：14145102
> 
> 赞同：0
> 
> 时间：2013-01-03T18:40:28.180
> 
> 标签：jquery

我试图在启动时在我的多选小部件[中选择我的所有选项。](http://www.erichynds.com/jquery/jquery-ui-multiselect-widget/)

在文档中，它说：

> 初始化实例后，通过调用以下任何方法与其交互：
> 
> // 示例：
> $("#multiselect").multiselect("method_name");
> 
> checkAll ------ 选中所有复选框。

所以我这样做了：

```
$("#music").multiselect("checkAll"); 
```

这是我得到的错误：

> 错误：无法在初始化之前调用多选方法；
> 试图调用方法'checkAll' [中断此错误]
> 
> 抛出新错误（味精）；

有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T18:42:12.370

错误消息确实说明了一切。在尝试调用插件方法之前，您需要在元素上初始化插件。

像这样的东西：

```
$("#music").multiselect({
    // initialisation options...
});
$("#music").multiselect("checkAll"); // call the method 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-03T18:43:20.287

先初始化再调用方法

```
var $musicSelect = $('#music');

$musicSelect.multiselect();   // Initialize

$musicSelect.multiselect("checkAll");  // CheckAll 
```

# asp.net-mvc-4 - 在 mvc4 EF 中，模型数据库上下文 y 到 ies 是否存在复数问题

> ID：14145104
> 
> 赞同：2
> 
> 时间：2013-01-03T18:40:34.877
> 
> 标签：asp.net-mvc-4, entity-framework-5

当我尝试通过编辑或详细信息操作访问模型时，我不断收到错误消息。

> 自数据库创建以来，支持“InjuriesContext”上下文的模型已更改。考虑使用 Code First 迁移来更新数据库 (http://go.microsoft.com/fwlink/?LinkId=238269)。

首先，我尝试添加迁移，即使我确定我没有更改任何内容。更新数据库后仍然收到相同的错误。

然后我删除了所有的迁移和数据库，并启动了一个带有初始迁移和更新的干净数据库。同样的错误。什么都没有改变。

型号为：

```
public class InjuriesContext : DbContext
    {
        public InjuriesContext()
            : base("DBCon")
        {
        }

        public DbSet<Patient> Patients { get; set; }

        public DbSet<Injury> Injuries { get; set; }
    }

    public class Injury
    {
        public int Id { get; set; }
        public string Type { get; set; }
        public int PatientId { get; set; }
    } 
```

这里是控制器——

```
public ActionResult Edit(int id = 0)
        {
            Injury injury = db.Injuries.Find(id);
            if (injury == null)
            {
                return HttpNotFound();
            }
            return View(injury);
        } 
```

它在injury.find 上出错。我没有输入任何伤害，所以我希望它会像我的其他控制器一样返回 404，但它不喜欢这个。这个和我的其他模型之间的唯一区别是复数的 y 到 ies。实体框架不处理这个吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T00:55:39.520

不应该有任何复数限制，因为无论如何您都在类中明确定义了所有内容。

您是否创建了 Injures 表？

我相信表格 Injury 会自动创建。可变伤害可能有点接近，但我必须自己测试一下。

而是尝试：

```
public class Injury
{
    [Key]
    public int Id { get; set; }
    [Required]
    public string Type { get; set; }
    [Required]
    public int PatientId { get; set; }
}

    private InjuriesContext db = new InjuriesContext();
    Injury objInjury = db.Injuries.Find(id);
    if (objInjury == null)
    {
        return HttpNotFound();
    }
    return View(objInjury); 
```

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T20:22:32.177

事实证明，我的问题与多个上下文有关。我认为您必须为每个模型类创建一个单独的上下文。显然实体框架需要一个上下文。我经历并为我的上下文创建了一个类，并将我所有的数据库集放在那个类中。

```
 public class ProjContexts : DbContext
    {
         public ProjContexts()
            : base("ProjDBCon")
        {
        }

        public DbSet<Patient> Patients { get; set; }
        public DbSet<PreHosp> PreHosps { get; set; }
        public DbSet<UserProfile> UserProfiles { get; set; }
        public DbSet<Injury> Injuries { get; set; }

    }
} 
```

然后我根据[这篇文章](https://stackoverflow.com/questions/11679385/reset-entity-framework-migrations)删除了所有迁移并再次启用迁移进行了添加迁移和更新，然后我得到了预期的结果。

底线--- 在您的项目中不要有多个上下文类。不确定这是否可行，但在更改上述内容后，一切都按预期工作。不知道为什么当我有两个不同的上下文并添加第三个时它会起作用？也许是因为他们彼此有外键？

# qt - QTextEdit 在 setText 后更改托架位置

> ID：14145110
> 
> 赞同：0
> 
> 时间：2013-01-03T18:40:56.843
> 
> 标签：qt, qtextedit

我找不到如何更改 QTextEdit 上的托架位置。我使用 setText（或 setPlainText）方法添加文本，并且在此回车位于 QTextEdit 输入字段的开头之后，我希望它位于最后一个符号之后。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T18:48:01.207

```
QTextCursor cursor = myQTextEdit.textCursor();
cursor.movePosition(QTextCursor::End);
myQTextEdit.setTextCursor(cursor); 
```

或者如果它不起作用，请交换第 2 行和第 3 行。

# java - Android：软件usb模拟器

> ID：14145117
> 
> 赞同：1
> 
> 时间：2013-01-03T18:41:29.227
> 
> 标签：java, android, endpoint, emulation, pyusb

目标：

我想测试一个 android 终端和另一个设备之间的 java-android 通信。必须使用 USB 批量传输进行此通信。我基本上使用的是你可以在这里看到的：

[http://developer.android.com/reference/android/hardware/usb/package-summary.html](http://developer.android.com/reference/android/hardware/usb/package-summary.html)

问题：

嗯，我只是还没有设备。我发现“USB/IP”是一种可能的解决方案：

[如何模拟 USB 设备？](https://stackoverflow.com/questions/1913979/how-to-emulate-usb-devices) [http://usbip.sourceforge.net/](http://usbip.sourceforge.net/)

在某些情况下似乎可以正常工作，但我无法使其与 Android 一起使用...

问题：

有什么方法可以使用某些程序测试我的代码吗？

也许我应该将此作为另一个问题提出，但是，以防万一一切都出错了，我可以在我的 android 设备上使用 libusb 和 python (pyusb) 吗？似乎很难： [http ://comments.gmane.org/gmane.comp.python.pyusb.user/1207](http://comments.gmane.org/gmane.comp.python.pyusb.user/1207)

# javascript - 在页面加载事件中使用 Javascript 更改 CSS

> ID：14145120
> 
> 赞同：1
> 
> 时间：2013-01-03T18:41:36.667
> 
> 标签：javascript, css, dom-events, pageload

我有一个输入文本字段，应用程序用户可以在其中输入文档描述。在页面加载事件中，我检查此输入字段是否为空。如果为空，我插入以下文本并将样式更改为斜体和红色-

> 请输入此文档的说明

当页面处于活动状态时，我有事件侦听器`onblur`和事件。`onfocus`

基本上，如果用户单击文本字段，我会将 CSS 改回正常和黑色，并将值恢复为空字符串。

`Onblur`我会检查内容 - 如果它是空的，我会回复到“请输入...”消息和红色/斜体 CSS。如果它不为空，我将保持用户输入不变。

我遇到的问题是，在初始页面加载后，如果用户转到另一个页面进行查找然后返回并且他们没有更改文档描述，所以它仍然在说“请输入...... "，红色和斜体的 CSS 不生效。

我在所有浏览器的 Firefox 中都遇到了这种情况。

这是我`onload`在浏览器中注册页面事件的方式 -

```
//Microsoft Internet Explorer Browser - iFrame event register
if (navigator.appName.indexOf("Microsoft") != -1) {
  var frame = getPortlet();

  frame.contentWindow.location.replace('${channelUrl}');
  var prevPortletLoadEvent = frame.onload ? frame.onload : function () {};
  var refresh = function() {
    prevPortletLoadEvent();
    resizePortletContainer();
    attachTinyButtonListener();
    attachDocumentDescriptionListener();
    enforceDocumentDescriptionStyleIfNecessary();
  };

  if(frame.attachEvent) { frame.attachEvent('onload', refresh); } //IE browsers before version 9
  else  { frame.addEventListener('load', refresh, false); }
}

//All other major browsers - iFrame event register
else {
  var frame = getPortlet();
  var prevPortletLoadEvent = frame.onload ? frame.onload : function () {};
  frame.onload = function () {
    prevPortletLoadEvent();
    resizePortletContainer();
    attachTinyButtonListener();
    attachDocumentDescriptionListener();
    enforceDocumentDescriptionStyleIfNecessary();
  };

  var prevPortletResizeEvent = frame.onresize ? frame.onresize : function () {};
  var onresize = function () {
    prevPortletResizeEvent();
    resizePortletContainer();
    attachTinyButtonListener();
    attachDocumentDescriptionListener();
    enforceDocumentDescriptionStyleIfNecessary();
  };
} 
```

这是`enforeDocumentDescriptionStyleIfNecessary`-

```
function enforceDocumentDescriptionStyleIfNecessary() {

  var  efrm  = getPortlet();
  var  e_doc = efrm.contentDocument ? efrm.contentDocument: efrm.contentWindow.document;
  var  e_docElement = e_doc.getElementById('document.documentHeader.documentDescription');
  if (e_docElement.value == 'Please enter a description for this document') {

    e_docElement.style = 'italic';
alert("1");    
    e_docElement.color = 'red';
alert("2");
  }
} 
```

代码在页面加载时执行。警报框显示出来`1`，`2`我可以在每个警报框之后直观地检查该元素的 html）。

样式未添加！就好像这段代码被执行但被忽略了......

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T18:46:55.213

您没有正确设置元素的样式。它应该是：

```
e_docElement.style.fontStyle = 'italic';
e_docElement.style.color = 'red'; 
```

您将始终需要使用该`style`属性来修改元素的内联 css。

# internet-explorer - Internet Explorer 中的连字

> ID：14145121
> 
> 赞同：5
> 
> 时间：2013-01-03T18:41:37.633
> 
> 标签：internet-explorer, fonts, font-face

我们正在开发一种图标字体，它将拥有最终的字形集合，并将免费提供[http://www.webhostinghub.com/glyphs/](http://www.webhostinghub.com/glyphs/) 我们认为使用它的最简单方法是使用连字，而不是通过复杂的 CSS就像许多其他项目一样。问题是连字似乎在 Internet Explorer 中不起作用。它们在 Chrome、Firefox 和 Safari 中运行良好，但在 IE 中却不行。

真可惜，因为微软是第一个使用@font-face 的人，但由于某种原因，他们忘记了字体可能有连字。或者也许我错了，我希望我错了，有一些神奇的方法可以让它们发挥作用。我将非常感谢有关此主题的任何建议。或者，如果没有直接的解决方案，也许您知道一些解决方法。感谢您提前提供任何信息！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-10-07T02:44:54.877

连字在 IE10 之前的版本中无法使用`-ms-font-feature-settings`

对于旧浏览器的跨浏览器连字确实没有可靠的方法。

使用 CSS3 文本渲染：`optimizeLegibility`在 IE 中不起作用，并且 ms-font-feature-settings 仅从 IE10 开始受支持。

一种替代方法是仅使用 HTML 实体，但随后您将用字符替换字母，这会对 SEO 产生负面影响。

Ligature.js ( [link](https://code.google.com/p/ligature-js/) ) 是添加连字支持的另一种方法。它比仅使用 HTML 实体要好，但由于其他原因，它不是很实用。

这是一篇[优秀的文章](http://adamdscott.com/typography/ligatures-on-the-web/)，详细介绍了现有的解决方案并描述了现代浏览器的 CSS3 连字处理。

# apache - htaccess 更新后的外部循环重定向

> ID：14145122
> 
> 赞同：0
> 
> 时间：2013-01-03T18:41:37.987
> 
> 标签：apache, .htaccess, litespeed

在我的 Apache error.log 中，我收到了数千个这样的错误：

```
2013-01-02 20:46:44.582 [INFO] [50.18.21.225:48281-1#APVH_example.com] [REWRITE]
     detect external loop redirection with target URL: /index.html, skip.
2013-01-02 20:46:44.582 [INFO] [50.18.21.225:48276-1#APVH_example.com] [REWRITE]
     detect external loop redirection with target URL: /index.html, skip. 
```

我有这样一个 .htaccess 文件：

```
<IfModule mod_rewrite.c>
    RewriteEngine On

    RewriteCond %{HTTP_HOST} ^www\.(.*)$ [NC]
    RewriteRule ^(.*)$ http://%1/$1 [R=301,L]

    RewriteCond %{HTTP_USER_AGENT} "Somebot|Otherbot" [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} "Anotherbot" [NC]
    RewriteCond %{REQUEST_URI} !(\/mypages|\/otherpages) [NC]
    RewriteRule ^(.*)$ index.html? [R=301,L]

    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteRule ^(.*)$ index.php [QSA,L]
</IfModule> 
```

如果我注释掉这个块，我不会收到任何错误。但我的网站需要它。

```
 RewriteCond %{HTTP_USER_AGENT} "Somebot|Otherbot" [NC,OR]
    RewriteCond %{HTTP_USER_AGENT} "Anotherbot" [NC]
    RewriteCond %{REQUEST_URI} !(\/mypages|\/otherpages) [NC]
    RewriteRule ^(.*)$ index.html? [R=301,L] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T19:55:37.483

尝试像这样修改该块：

```
RewriteCond %{HTTP_USER_AGENT} "Somebot|Otherbot" [NC,OR]
RewriteCond %{HTTP_USER_AGENT} "Anotherbot" [NC]
RewriteCond %{REQUEST_URI} !(/mypages|/otherpages) [NC]
RewriteCond %{REQUEST_URI} !index\.html
RewriteRule ^(.*)$ index.html? [R=301,L] 
```

# jaxb - 使用 MOXy 的 JAXB 中的动态 CDATA

> ID：14145131
> 
> 赞同：2
> 
> 时间：2013-01-03T18:42:09.147
> 
> 标签：jaxb, eclipselink, cdata, moxy

我正在使用[**EclipseLink JAXB (MOXy)**](http://www.eclipse.org/eclipselink/moxy.php)。我有一个问题，Java 类的属性可以是 CDATA 或不是动态的。例如，

```
class Embed{  
//@XmlValue only  
//OR @XmlValue @CDATA  
private String value; //THIS CAN BE CDATA OR NOT  
} 
```

我尝试使用继承来解决这个问题，其中一个子类将属性作为一个值，另一个作为 CDATA。这个解决方案的问题是生成的 XML 具有我不想要的 xsi:type 和 xmlns:xsi 信息，因为我正在升级旧代码并且我需要生成的 xml 与旧代码完全相同。

我尝试过的解决方案：

```
@XmlAccessorType(XmlAccessType.FIELD)  
@XmlType(name = "itemType", namespace = "", propOrder = {"embed"}  
public class Item{  
 List`<Embed>` embed;  
 //getter and setters  
}

@XmlAccessorType(XmlAccessType.NONE)  
@XmlSeeAlso(EmbedDefault.class, EmbedAsCdata.class)  
public abstract class Embed{

}

@XmlAccessorType(XmlAccessType.FIELD)    
@XmlType( propOrder = {"value"})  
public class EmbedDefault extends Embed{

@XmlValue
protected String value;
 //getters and setters  
}

@XmlAccessorType(XmlAccessType.FIELD)  
@XmlType(propOrder = {"value"})  
public class EmbedAsCdata extends Embed {  

@XmlValue
@XmlCDATA
protected String value;
//getters and setters  
} 
```

还有这种更简单的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T11:51:45.867

**Note:** I'm the [**EclipseLink JAXB (MOXy)**](http://www.eclipse.org/eclipselink/moxy.php) lead and a member of the [**JAXB (JSR-222)**](http://jcp.org/en/jsr/detail?id=222) expert group.

I'm trying to come up with a decent workaround for you, but below is an enhancement request you can follow where we are going to enhance the `@XmlCDATA` annotation to make this use case much easier to support.

*   [http://bugs.eclipse.org/374977](http://bugs.eclipse.org/374977)

* * *

**UPDATE #1**

Below is an approach I'm working on for your use case. It requires a small change to MOXy which I have figured out but still need to fully test. You can track our progress on this issue using the following link:

*   [http://bugs.eclipse.org/397517](http://bugs.eclipse.org/397517)

**DomHandler (CdataHandler)**

JAXB has the concept of a `DomHandler` that allows you some extra control of what the XML looks like. We will leverage a `DomHandler` to add in a `CDATA` block when required.

```
package forum14145131;

import javax.xml.bind.ValidationEventHandler;
import javax.xml.bind.annotation.DomHandler;
import javax.xml.parsers.*;
import javax.xml.transform.Source;
import javax.xml.transform.dom.*;

import org.w3c.dom.*;

public class CdataHandler implements DomHandler<String, DOMResult> {

    private static DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();;

    @Override
    public DOMResult createUnmarshaller(ValidationEventHandler veh) {
        return new DOMResult();
    }

    @Override
    public String getElement(DOMResult domResult) {
        Document document = (Document) domResult.getNode();
        return document.getDocumentElement().getTextContent();
    }

    @Override
    public Source marshal(String string, ValidationEventHandler veh) {
        try {
            DocumentBuilder db = dbf.newDocumentBuilder();
            Document document = db.newDocument();

            Node node;
            if(string.contains("<") || string.contains("&") || string.contains("&")) {
                node = document.createCDATASection(string);
            } else {
                node = document.createTextNode(string);
            }
            return new DOMSource(node);
        } catch(Exception e) {
            throw new RuntimeException(e);
        }
    }

} 
```

**Embed**

The `@XmlAnyElement` annotation is used to specify the `DomHandler`.

```
package forum14145131;

import javax.xml.bind.annotation.*;

@XmlRootElement
@XmlAccessorType(XmlAccessType.FIELD)
class Embed{  

    @XmlAnyElement(CdataHandler.class)
    private String value; //THIS CAN BE CDATA OR NOT  

    public String getValue() {
        return value;
    }

    public void setValue(String value) {
        this.value = value;
    }

} 
```

**For More Information**

*   [http://blog.bdoughan.com/2011/04/xmlanyelement-and-non-dom-properties.html](http://blog.bdoughan.com/2011/04/xmlanyelement-and-non-dom-properties.html)

* * *

**UPDATE #2**

Below is an approach that you can use today using the existing EclipseLink library leveraging an `XmlAdapter` and a `CharacterEscapeHandler`:

**XmlAdapter (CdataAdapter)**

```
package forum14145131;

import javax.xml.bind.annotation.adapters.XmlAdapter;

public class CdataAdapter extends XmlAdapter<String, String> {

    @Override
    public String marshal(String string) throws Exception {
        if(string.contains("&") || string.contains("<") || string.contains("\"")) {
            return "<![CDATA[" + string + "]]>";
        } else {
            return string;
        }
    }
    @Override
    public String unmarshal(String string) throws Exception {
        return string;
    }

} 
```

**Embed**

The `@XmlJavaTypeAdapter` annotation is used to specify the `XmlAdapter`.

```
package forum14145131;

import javax.xml.bind.annotation.*;
import javax.xml.bind.annotation.adapters.XmlJavaTypeAdapter;

@XmlRootElement
@XmlAccessorType(XmlAccessType.FIELD)
class Embed{  

    @XmlValue
    @XmlJavaTypeAdapter(CdataAdapter.class)
    private String value; //THIS CAN BE CDATA OR NOT  

    public String getValue() {
        return value;
    }

    public void setValue(String value) {
        this.value = value;
    }

} 
```

**Demo**

Below is how you specify the `CharacterEscapeHandler`. Note this overrides all the character escaping for this `Marshaller`. We do this so the `CDATA` portion doesn't get escaped. For production code your implementation of this method would need to be beefed up over what is presented in this example.

```
package forum14145131;

import java.io.*;
import javax.xml.bind.*;
import org.eclipse.persistence.jaxb.MarshallerProperties;
import org.eclipse.persistence.oxm.CharacterEscapeHandler;

public class Demo {

    public static void main(String[] args) throws Exception {
        JAXBContext jc = JAXBContext.newInstance(Embed.class);

        Unmarshaller unmarshaller = jc.createUnmarshaller();
        File xml = new File("src/forum14145131/input.xml");
        Embed embed = (Embed) unmarshaller.unmarshal(xml);

        Marshaller marshaller = jc.createMarshaller();
        marshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true);
        marshaller.setProperty(MarshallerProperties.CHARACTER_ESCAPE_HANDLER,
                new CharacterEscapeHandler() {
                    @Override
                    public void escape(char[] ac, int i, int j, boolean flag,
                            Writer writer) throws IOException {
                        writer.write(ac, i, j);
                    }
                });
        marshaller.marshal(embed, System.out);
    }

} 
```

**input.xml/Output**

```
<?xml version="1.0" encoding="UTF-8"?>
<embed><![CDATA[Hello & World]]></embed> 
```

# python - 在变量中构建具有大量数据的字典

> ID：14145140
> 
> 赞同：1
> 
> 时间：2013-01-03T18:42:55.887
> 
> 标签：python

我在变量中有以下数据。我的目标是构建一个以数字为索引的字典，其值为 url、所有者电子邮件和 commitMessage 消息。我需要一些关于如何做到这一点的想法，或者是否有更好的实现方式。我非常感谢您的意见。

```
{
"project": "platform/vendor/company-proprietary/radio",
"branch": "master",
"id": "I2d46a51ea94d66eefe044e633b15c6eaa7dbb2af",
"number": "147441",
"subject": "radio: Update radio driver version",
"owner": {
    "name": "Shailender bary",
    "email": "bary@ca.company.com",
    "username": "bary"
},
"url": "https://company/147441",
"commitMessage": "radio: Update radio driver version\n\nUpdate radio driver version for the FC release\n\nChange-Id: I2d46a51ea94d66eefe044e633b15c6eaa7dbb2af\n",
"createdOn": 1344628179,
"lastUpdated": 1357170699,
"sortKey": "00222ad700023ff1",
"open": true,
"status": "NEW",
"currentPatchSet": {
    "number": "2",
    "revision": "18bb2f7af0dc7cad7b3959c23d886a1a48c8f728",
    "parents": [
        "96968973a0dfa1ce105cdec7c91d3304af0d8393"
    ],
    "ref": "refs/changes/41/147441/2",
    "uploader": {
        "name": "Shailender bary",
        "email": "bary@ca.company.com",
        "username": "bary"
    },
    "createdOn": 1344628312,
    "approvals": [
        {
            "type": "VRIF",
            "description": "Verified",
            "value": "-1",
            "grantedOn": 1344654401,
            "by": {
                "name": "Linux Build Service Account",
                "email": "lnxbuild@localhost",
                "username": "lnxbuild"
            }
        },
        {
            "type": "CRVW",
            "description": "Code Review",
            "value": "-2",
            "grantedOn": 1357170699,
            "by": {
                "name": "tom Johnson",
                "email": "jjohnson@ca.company.com",
                "username": "jjohnson"
            }
        },
        {
            "type": "CRVW",
            "description": "Code Review",
            "value": "1",
            "grantedOn": 1344628453,
            "by": {
                "name": "Shailender bary",
                "email": "bary@ca.company.com",
                "username": "bary"
            }
        },
        {
            "type": "TEST",
            "description": "Developer Verified",
            "value": "1",
            "grantedOn": 1344628453,
            "by": {
                "name": "Shailender bary",
                "email": "bary@ca.company.com",
                "username": "bary"
            }
        },
        {
            "type": "CRVW",
            "description": "Code Review",
            "value": "2",
            "grantedOn": 1344629368,
            "by": {
                "name": "johnb Bhatia",
                "email": "johnbb@ca.company.com",
                "username": "johnbb"
            }
        }
    ],
    "files": [
        {
            "file": "/COMMIT_MSG",
            "type": "ADDED"
        },
        {
            "file": "rime/CORE/MAC/inc/qradio_version.h",
            "type": "MODIFIED"
        }
    ]
}

{
"project": "platform/vendor/company-proprietary/radio",
"branch": "master",
"id": "I2c9c0515974a3f69b4341cf5e1e2c1b17ea10641",
"number": "143446",
"subject": "radio: Changes done for P2P Device interface.",
"owner": {
    "name": "Mohit Chang",
    "email": "mChang@ca.company.com",
    "username": "mChang"
},
"url": "https://company/143446",
"commitMessage": "radio: Changes done for P2P Device interface.\n\nChange-Id: I2c9c0515974a3f69b4341cf5e1e2c1b17ea10641\n",
"createdOn": 1343352861,
"lastUpdated": 1357170602,
"sortKey": "00222ad600023056",
"open": true,
"status": "NEW",
"currentPatchSet": {
    "number": "1",
    "revision": "743006ffcc16a725c7499aaffa1594681488e1f8",
    "parents": [
        "9bef0f406dfbd7bbd747d20a41b68fc1c2fd7c48"
    ],
    "ref": "refs/changes/46/143446/1",
    "uploader": {
        "name": "Mohit Chang",
        "email": "mChang@ca.company.com",
        "username": "mChang"
    },
    "createdOn": 1343352861,
    "approvals": [
        {
            "type": "VRIF",
            "description": "Verified",
            "value": "1",
            "grantedOn": 1343360579,
            "by": {
                "name": "Linux Build Service Account",
                "email": "lnxbuild@localhost",
                "username": "lnxbuild"
            }
        },
        {
            "type": "CRVW",
            "description": "Code Review",
            "value": "-2",
            "grantedOn": 1357170602,
            "by": {
                "name": "tom Johnson",
                "email": "jjohnson@ca.company.com",
                "username": "jjohnson"
            }
        },
        {
            "type": "CRVW",
            "description": "Code Review",
            "value": "1",
            "grantedOn": 1343353135,
            "by": {
                "name": "Shailender bary",
                "email": "bary@ca.company.com",
                "username": "bary"
            }
        },
        {
            "type": "TEST",
            "description": "Developer Verified",
            "value": "1",
            "grantedOn": 1343353135,
            "by": {
                "name": "Shailender bary",
                "email": "bary@ca.company.com",
                "username": "bary"
            }
        },
        {
            "type": "CRVW",
            "description": "Code Review",
            "value": "2",
            "grantedOn": 1343355565,
            "by": {
                "name": "johnb Bhatia",
                "email": "johnbb@ca.company.com",
                "username": "johnbb"
            }
        }
    ],
    "files": [
        {
            "file": "/COMMIT_MSG",
            "type": "ADDED"
        },
        {
            "file": "rime1_2/CORE/HDD/inc/radio_hdd_main.h",
            "type": "MODIFIED"
        },
        {
            "file": "rime1_2/CORE/HDD/src/radio_hdd_cfg80211.c",
            "type": "MODIFIED"
        },
        {
            "file": "rime1_2/CORE/HDD/src/radio_hdd_hostapd.c",
            "type": "MODIFIED"
        },
        {
            "file": "rime1_2/CORE/HDD/src/radio_hdd_main.c",
            "type": "MODIFIED"
        }{
            "file": "rime1_2/CORE/HDD/src/radio_hdd_p2p.c",
            "type": "MODIFIED"
        }
    ]
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T18:45:52.370

您可以将其推送到这样的字典中：

```
store ={1:my_object, 2:my_object} 
```

`my_object`您创建的包含您在问题中描述的属性的类 在哪里：

```
url,owner email and commitMessage 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T18:53:00.107

我会为数据使用一个元组，无需为它创建一个特殊的类：

```
d = {1: (url, owner_mail, commit_msg), ...} 
```

或者，如果索引并不重要，请使用列表并隐含索引（数据在列表中的位置）。

```
d = [(url, owner_mail, commit_msg), ...] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-03T19:29:57.467

好吧，也许只是编写一个自定义函数来从中提取数据？可能类似于以下内容。

```
instance = {"project":"platform/vendor/company-proprietary/radio","branch":"master","id":"I2d46a51ea94d66eefe044e633b15c6eaa7dbb2af","number":"147441","subject":"radio: Update radio driver version","owner":{"name":"Shailender bary","email":"bary@ca.company.com","username":"bary"},"url":"https://company/147441","commitMessage":"radio: Update radio driver version\n\nUpdate radio driver version for the FC release\n\nChange-Id: I2d46a51ea94d66eefe044e633b15c6eaa7dbb2af\n","createdOn":1344628179,"lastUpdated":1357170699,"sortKey":"00222ad700023ff1","open":true,"status":"NEW","currentPatchSet":{"number":"2","revision":"18bb2f7af0dc7cad7b3959c23d886a1a48c8f728","parents":["96968973a0dfa1ce105cdec7c91d3304af0d8393"],"ref":"refs/changes/41/147441/2","uploader":{"name":"Shailender bary","email":"bary@ca.company.com","username":"bary"},"createdOn":1344628312,"approvals":[{"type":"VRIF","description":"Verified","value":"-1","grantedOn":1344654401,"by":{"name":"Linux Build Service Account","email":"lnxbuild@localhost","username":"lnxbuild"}},{"type":"CRVW","description":"Code Review","value":"-2","grantedOn":1357170699,"by":{"name":"tom Johnson","email":"jjohnson@ca.company.com","username":"jjohnson"}},{"type":"CRVW","description":"Code Review","value":"1","grantedOn":1344628453,"by":{"name":"Shailender bary","email":"bary@ca.company.com","username":"bary"}},{"type":"TEST","description":"Developer Verified","value":"1","grantedOn":1344628453,"by":{"name":"Shailender bary","email":"bary@ca.company.com","username":"bary"}},{"type":"CRVW","description":"Code Review","value":"2","grantedOn":1344629368,"by":{"name":"johnb Bhatia","email":"johnbb@ca.company.com","username":"johnbb"}}],"files":[{"file":"/COMMIT_MSG","type":"ADDED"},{"file":"rime/CORE/MAC/inc/qradio_version.h","type":"MODIFIED"}]}}

#Say data is the dictionary you want to save the data to.
data = {}

def sanitize_data(variable):
    """ A simple function to sanitize data"""
    instance_data = {}

    level_one = ("url", "commitMessage")
    level_two = ("name", "email")

    for x in level_one:
        instance_data[x] = variable[x]

    for x in level_two:
        instance_data[x] = variable["owner"][x]

    index = len(data)
    data[index] = instance_data
    print data

>>>sanitize_data(instance)
{0: {'url': 'https://company/147441', 'commitMessage': 'radio: Update radio driver version\n\nUpdate radio driver', 'name': 'Shailenderbary', 'email': 'bary@ca.company.com'}} 
```

# c# - 根据结束日期动态下拉

> ID：14145142
> 
> 赞同：1
> 
> 时间：2013-01-03T18:43:03.557
> 
> 标签：c#

我有一个下拉菜单，指示应用程序“当前”或“已过期”的状态。我希望在“结束日期”超出 c# 中的“当前日期”之后将此值更改为“过期”。

下面是加载状态的代码

```
public void loadStatus()
{
    ArrayList arrNew = new ArrayList();
    String[] tmpArray = InfoLoader.loadStatus(2).Split('\n');
    for (int i = 0; i < tmpArray.Length; i++)
    {
        String[] cols = tmpArray[i].Split('\t');
        if (cols.Length == 2)
        {
            arrNew.Add(new ListValues(cols[0], cols[1], ListValues.FORWARD));
        }

    }
    cmboStatus.DataSource = arrNew;
    cmboStatus.DisplayMember = "Desc";
    cmboStatus.ValueMember = "ID";
} 
```

以下是加载页面的代码

```
enter code here
public void loadPage(int newEmpIndex)
{
    empIndex = newEmpIndex;
    DataTable dtEA = dbcEA.getDT();
    DataRow row = dbcEA.getDT().Rows[empIndex];

    cmboApptType.SelectedValue =row["EmpAppTypeID"].ToString();
    txtFTRate.Text = row["EmpAppointFTCompRate"].ToString();
    txtTimeBase.Text = row["EmpAppointTimeBase"].ToString();
    txtSalary.Text = row["EmpAppointSalary"].ToString();
    txtFund.Text = row["EmpAppointPrimaryFund"].ToString();
    txtDateStart.Text =  DateTime.Parse(row["EmpAppointDateBegin"].ToString()).ToShortDateString();
    txtDateEnd.Text = DateTime.Parse(row["EmpAppointDateEnd"].ToString()).ToShortDateString();

    txtPayrollStart.Text = UtilityDates.parse(row["EmpAppointPayrollDateStart"].ToString(), UtilityDates.SHORTDATE);
    txtPayrollEnd.Text = UtilityDates.parse(row["EmpAppointPayrollDateEnd"].ToString(), UtilityDates.SHORTDATE);

    txtETrac.Text = row["EmpAppointEtrac"].ToString();
    cmboStatus.SelectedValue = row["EmpAppointStatusID"].ToString().Trim();
    cmboPositionNumber.SelectedValue = row["EmpAppointPositionNum"].ToString().Trim();
    txtPositionNum.Text = row["EmpAppointPositionNum"].ToString();
    txtMemo.Text = row["EmpAppointMemo"].ToString();
    cmboJobCodeID.SelectedValue = row["JobCodeID"].ToString();

    //if (UtilityParser.isInt(dtEA.Rows[empIndex].ItemArray[16].ToString()))
    if (UtilityParser.isInt(row["TransFundID"].ToString()))
    {
        TransFundID = int.Parse(row["TransFundID"].ToString());
    }

    resetIsChanged();
    checkNavButtons();
} 
```

请帮我解决这个问题。我想知道如何在上面的代码中插入“if”条件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T18:55:19.563

那么你有这条线：

```
cmboStatus.SelectedValue = row["EmpAppointStatusID"].ToString().Trim(); 
```

因此，您可以像这样进行更改：

```
if (some interesting condition here)
{
   cmboStatus.SelectedValue = "fab new value";
}
else
{
   cmboStatus.SelectedValue = row["EmpAppointStatusID"].ToString().Trim();
} 
```

但是，从您的问题中不清楚是否会 - 但我预计这会导致问题：

因为这不会将“fab new value”保存到数据库中，所以可能会导致问题。所以我建议这样的事情：

```
if (some interesting condition here)
{
   cmboStatus.SelectedValue = "fab new value";
   updateStatus(parameters needed)
}
else
... more stuff 
```

# r - 为什么R中的predict()函数不给出预测？

> ID：14145151
> 
> 赞同：1
> 
> 时间：2013-01-03T18:43:46.817
> 
> 标签：r, predict, rpart

我的训练数据集有 40000 行。在我使用 CART 模型拟合之后

`fit<-rpart(y~x,method="class")`

我试图使用

`predict(fit,data.frame(new_x),family="response")`

错误信息是：

```
Warning message:
`'newdata' had 100 rows but variable(s) found have 40000 rows.` 
```

此外，我检查了`"predicted value`“，它们实际上是使用 training 拟合值`x`。有人知道原因吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-23T16:42:47.323

此外，如果使用`predict()`包中的函数创建的对象`np`，请始终命名您的训练变量和`newdata=`变量 x 和 y。

其他变量名不能正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-29T16:16:49.713

太棒了，罗兰明白了。我有同样的问题，但当我改变它时解决了

```
data.frame(x=) 
```

至

```
data.frame (variablename=) 
```

# python-2.7 - 与 beautifulsoup4 安装混淆

> ID：14145154
> 
> 赞同：0
> 
> 时间：2013-01-03T18:43:58.767
> 
> 标签：python-2.7, beautifulsoup

我已经在我的 windows7 PC 中安装了 python 2.7。现在我浏览了[Beautiful Soup](http://www.crummy.com/software/BeautifulSoup/bs4/doc/)。现在我找到了两个安装 BeautifulSoup4 的命令。`easy_install beautifulsoup4`和`pip install beautifulsoup4`。但我的困惑是我必须在哪个目录中运行这些命令。我的python文件夹是`C:\Python27`。你能帮我在哪里运行该命令吗？

**错误**

```
 Microsoft Windows [Version 6.1.7600]
Copyright (c) 2009 Microsoft Corporation.  All rights reserved.

C:\Users\Arup Rakshit>cd..

C:\Users>cd..

C:\>cd C:\Python27

C:\Python27>python.exe virtualenv.py selenv
New python executable in selenv\Scripts\python.exe
Installing setuptools....................................done.
Installing pip.........................done.

C:\Python27>cd selenv\Scripts\

C:\Python27\selenv\Scripts>pip.exe install selenium
Downloading/unpacking selenium
  Downloading selenium-2.28.0.tar.gz (2.1MB): 2.1MB downloaded
  Running setup.py egg_info for package selenium
    C:\Python27\Lib\distutils\dist.py:267: UserWarning: Unknown distribution opt
ion: 'src_root'
      warnings.warn(msg)

    warning: no files found matching 'docs\api\py\index.rst'
Installing collected packages: selenium
  Running setup.py install for selenium
    C:\Python27\Lib\distutils\dist.py:267: UserWarning: Unknown distribution opt
ion: 'src_root'
      warnings.warn(msg)

    warning: no files found matching 'docs\api\py\index.rst'
Successfully installed selenium
Cleaning up...

C:\Python27\selenv\Scripts>python.exe my_selenium_script.py
python.exe: can't open file 'my_selenium_script.py': [Errno 2] No such file or d
irectory

C:\Python27\selenv\Scripts>python.exe my_selenium_script.py
Hello

C:\Python27\selenv\Scripts>cd..

C:\Python27\selenv>pip install beautifulsoup4
'pip' is not recognized as an internal or external command,
operable program or batch file.

C:\Python27\selenv> 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T21:08:55.577

Beautiful Soup 4 是通过 PyPi 发布的，所以如果你不能用系统打包器安装它，你可以用 easy_install 或 pip 安装它。包名称是 beautifulsoup4，相同的包适用于 Python 2 和 Python 3。

```
$ easy_install beautifulsoup4

$ pip install beautifulsoup4 
```

如果您没有安装 easy_install 或 pip，您可以下载[Beautiful Soup 4](http://www.crummy.com/software/BeautifulSoup/bs4/download/4.0/)源代码压缩包并使用 setup.py 安装它。[转到该文件夹​​并运行命令 setup.py install（假设 *.py 在路径扩展名中已知，否则运行 c:\python25\python setup.py install）。]

```
C:\Python27\beautifulsoup4-4.1.0>cd C:\Python27\beautifulsoup4-4.1.0
C:\Python27\beautifulsoup4-4.1.0>setup.py install 'here I am done! 
```

***测试 ：***

```
Microsoft Windows [Version 6.1.7600]
Copyright (c) 2009 Microsoft Corporation.  All rights reserved.

C:\Users\Arup Rakshit>cd..

C:\Users>cd..

C:\>cd C:\Python27

C:\Python27>python
Python 2.7.3 (default, Apr 10 2012, 23:31:26) [MSC v.1500 32 bit (Intel)] on win
32
Type "help", "copyright", "credits" or "license" for more information.
>>> from urllib import urlopen
>>> from bs4 import BeautifulSoup
>>> source = BeautifulSoup(urlopen("http://www.google.com/"))
>>> tables = source.findAll('td')
>>> import csv
>>> writer = csv.writer(open('filename.csv','w'))
>>> writer.writerow(rows) 
```

# c# - c# 命名空间冲突

> ID：14145158
> 
> 赞同：1
> 
> 时间：2013-01-03T18:44:17.970
> 
> 标签：c#, asp.net, dll

我有 ac# 项目，默认命名空间是`Project.App`- 我有另一个项目，默认命名空间是`Project.Service`.

我将创建的 DLL`Project.Service`作为参考包含在`Project.App`- 原因是项目位于两个不同的解决方案中，由两个不同的组维护。

当我尝试在代码中使用引用并编译时，我总是收到一条错误消息`"The type or namespace 'Service' does not exist in the namespace 'Project'".`

我在这里想念什么？

编辑：我找到了解决问题的方法：[无法识别命名空间（即使它存在）](https://stackoverflow.com/questions/4228992/namespace-not-recognized-even-though-it-is-there)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T18:47:36.103

[如何：使用命名空间别名限定符（C# 编程指南）](http://msdn.microsoft.com/en-us/library/c3ay4x3d%28v=vs.80%29.aspx)

```
//example
using colAlias = System.Collections; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T19:22:44.920

您是否验证了您要使用的类在 Project.Service 命名空间中并且它是公共的？即使 Project.Service 是默认命名空间，也不能保证程序集中的任何类都具有该命名空间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-03T18:55:32.493

不久前我读过一篇文章（在 stylecop 告诉我移动我的 using 语句之后），在当前命名空间内移动 using 语句可以帮助解决这样的命名空间冲突。

```
namespace example
{ 
   using xxxxx
} 
```

请参阅以下帖子：[“使用”语句应该在命名空间内部还是外部？](https://stackoverflow.com/questions/125319/should-usings-be-inside-or-outside-the-namespace)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-03T18:59:46.337

尝试给`Project.Service`dll 一个别名，然后将别名导入到您的代码中。像这样：

1.  右键单击项目的 References 文件夹中引用的 dll，然后单击“属性”
2.  在别名字段中输入此引用的新别名，例如“服务”
3.  在您的代码页上，在页面顶部添加此指令：`extern alias Services;`
4.  添加这样的 using 语句： using Service = Services;
5.  像这样引用`Project.Service`命名空间：`Service.DoSomthing();`

在这一点上你应该很高兴。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-03T18:47:36.283

我会首先检查它是否真的被添加了：也许**Service** dll 中的目标框架与您的应用程序中的目标框架不同（更高版本）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-03T19:04:33.333

因为你似乎有正确的参考......

中的所有类都`Project.Service`可能是`internal`这样，其他项目将不会“看到”任何东西。

如果这是真的 - 公开或让您的程序集成为其他程序集“InternalsVisibleTo”的朋友（请注意，它需要两者都经过强签名）。

# java - 提示输入身份验证标头的 HttpResponse

> ID：14145166
> 
> 赞同：0
> 
> 时间：2013-01-03T18:45:30.407
> 
> 标签：java, authentication, httpwebrequest

我正在使用 Jmeter 创建一些 Web 请求，并尝试在我正在处理的程序中为它们手动生成响应。

使用我正在使用的 jmeter 身份验证管理器，它不会将身份验证标头与原始请求一起发送。它需要一个响应来提示客户端将身份验证标头与 Web 请求一起发送，但我不知道如何手动做出提示它们的响应。谁能告诉我这样的响应是如何格式化的，或者指出我怎么能弄清楚？（我可以使用 Jmeter、Java 和 Spring 使用应用程序，但我不知道如何让 Jmeter 向我显示身份验证提示响应。）

我尝试通过将响应设置为带有标题的 401“未经授权”响应来格式化响应： WWW-Authenticate: Basic realm="lameralm" 但这似乎不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T18:57:05.577

在[HTTP 基本身份验证](http://en.wikipedia.org/wiki/Basic_access_authentication)中，响应应如下所示：

```
HTTP/1.1 401 Unauthorized
WWW-Authenticate: Basic realm="insert realm" 
```

下一个请求应该如下所示：

```
GET / HTTP/1.1
Authorization: Basic QWxhZGRpbjpvcGVuIHNlc2FtZQ== 
```

# javascript - 没有显示地理位置的googleMap

> ID：14145167
> 
> 赞同：0
> 
> 时间：2013-01-03T18:45:34.823
> 
> 标签：javascript, html, google-maps-api-3, geolocation

所以我正在尝试这个 googleMap 的地理定位。我真的只是复制粘贴了代码，但我没有设法让地图出现。浏览器甚至要求我获取我的位置，但地图只是不显示。（哦，我什至用 google api 键来调用它）

```
<!DOCTYPE html>
<html lang="en-gb" dir="ltr">
<head>
<style type="text/css">
<meta charset="utf-8">
<title>Geolocation API getCurrentPosition example</title>
<style>
<script src="http://maps.google.com/maps/api/js?key=AIzaSyDBy_moo4fAc2Z2DmSLBayqjry_VkthwyU&sensor=false">
<script type="text/javascript" src="http://maps.gstatic.com/intl/pt_pt/mapfiles/api-3/10/19/main.js">
<script type="text/javascript" charset="UTF-8" src="http://maps.gstatic.com/cat_js/intl/pt_pt/mapfiles/api-3/10/19/%7Bcommon,util,stats%7D.js">
<script type="text/javascript" charset="UTF-8" src="http://maps.gstatic.com/cat_js/intl/pt_pt/mapfiles/api-3/10/19/%7Bmap,marker,infowindow%7D.js">
<script type="text/javascript" charset="UTF-8" src="http://maps.gstatic.com/cat_js/intl/pt_pt/mapfiles/api-3/10/19/%7Bonion%7D.js">
<script type="text/javascript" charset="UTF-8" src="http://maps.gstatic.com/cat_js/intl/pt_pt/mapfiles/api-3/10/19/%7Bcontrols%7D.js">
</style>
</head>

<body>
<p>Click on the marker for position information.</p>
<div id="map" style="position: relative; background-color: rgb(229, 227, 223); overflow: hidden;">
<div style="position: absolute; left: 0px; top: 0px; overflow: hidden; width: 100%; height: 100%; z-index: 0;">
<div style="position: absolute; left: 0px; top: 0px; overflow: hidden; width: 100%; height: 100%; z-index: 0;">
<div style="position: absolute; left: 0px; top: 0px; z-index: 1; cursor: url("http://maps.gstatic.com/mapfiles/openhand_8_8.cur"), default;">
<div style="position: absolute; left: 0px; top: 0px; z-index: 200;">
<div style="position: absolute; left: 0px; top: 0px; z-index: 201;">
<div style="position: absolute; left: 0px; top: 0px; z-index: 202;">
<div style="position: absolute; left: 0px; top: 0px; z-index: 100;">
<div style="position: absolute; left: 0px; top: 0px; z-index: 0;">
</div>
</div>
<div style="margin: 2px 5px 2px 2px; z-index: 1000000; position: absolute; left: 0px; bottom: 0px;">
<div class="gmnoprint" style="z-index: 1000001; position: absolute; right: 0px; bottom: 0px;">
<div style="background-color: white; padding: 15px 21px; border: 1px solid rgb(171, 171, 171); font-family: Arial,sans-serif; color: rgb(34, 34, 34); box-shadow: 0px 4px 16px rgba(0, 0, 0, 0.2); z-index: 10000002; display: none; width: 256px; height: 148px; position: absolute; left: 475px; top: 310px;">
<div class="gmnoscreen" style="position: absolute; right: 0px; bottom: 0px;">
<div class="gmnoprint" style="display: none; font-size: 10px; height: 17px; background-color: rgb(245, 245, 245); border: 1px solid rgb(220, 220, 220); line-height: 19px; position: absolute; right: 0px; bottom: 0px;">
<div class="gmnoprint" style="margin: 5px; -moz-user-select: none; position: absolute; left: 0px; top: 0px;" controlwidth="78" controlheight="356">
<div class="gmnoprint" style="margin: 5px; z-index: 0; position: absolute; cursor: pointer; right: 0px; top: 0px;">
</div>
</div>
<script>
if (navigator.geolocation) {
var timeoutVal = 10 * 1000 * 1000;
navigator.geolocation.getCurrentPosition(
displayPosition,
displayError,
{ enableHighAccuracy: true, timeout: timeoutVal, maximumAge: 0 }
);
}
else {
alert("Geolocation is not supported by this browser");
}
function displayPosition(position) {
var pos = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);
var options = {
zoom: 10,
center: pos,
mapTypeId: google.maps.MapTypeId.ROADMAP
};
var map = new google.maps.Map(document.getElementById("map"), options);
var marker = new google.maps.Marker({
position: pos,
map: map,
title: "User location"
});
var contentString = "<b>Timestamp:</b> " + parseTimestamp(position.timestamp) + "<br/><b>User location:</b> lat " + position.coords.latitude + ", long " + position.coords.longitude + ", accuracy " + position.coords.accuracy;
var infowindow = new google.maps.InfoWindow({
content: contentString
});
google.maps.event.addListener(marker, 'click', function() {
infowindow.open(map,marker);
});
}
function displayError(error) {
var errors = {
1: 'Permission denied',
2: 'Position unavailable',
3: 'Request timeout'
};
alert("Error: " + errors[error.code]);
}
function parseTimestamp(timestamp) {
var d = new Date(timestamp);
var day = d.getDate();
var month = d.getMonth() + 1;
var year = d.getFullYear();
var hour = d.getHours();
var mins = d.getMinutes();
var secs = d.getSeconds();
var msec = d.getMilliseconds();
return day + "." + month + "." + year + " " + hour + ":" + mins + ":" + secs + "," + msec;
}
</script>
<div id="YontooInstallID" style="display: none;">E5458842-7EDA-B28E-B9F2-4CFB1EEAD44D</div>
<div id="Y2PluginIds" style="display: none;">Y2:E5458842-7EDA-B28E-B9F2-4CFB1EEAD44D</div>
</body>
</html>
</style>
</head>
<body>
<div id="YontooInstallID" style="display: none;">E5458842-7EDA-B28E-B9F2-4CFB1EEAD44D</div>
<div id="Y2PluginIds" style="display: none;">Y2:E5458842-7EDA-B28E-B9F2-4CFB1EEAD44D</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T18:52:32.037

你必须关闭所有标签（脚本、div、样式）。例如：

```
 <script> with </script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T20:35:39.530

[从您的示例](http://html5doctor.com/demos/geolocation/geolocation-getcurrentposition-example.html)中复制的 效果很好。

您的代码开头至少多出 20 行，结尾多出大约 9 行。

根据[**Google**](https://developers.google.com/maps/signup)的说法，Google Maps JavaScript API v3 不需要 API 密钥即可正常运行。但是，我们强烈建议您使用 API 控制台密钥加载 Maps API，该密钥允许您监控应用程序的 Maps API 使用情况。

```
<!DOCTYPE html>
<html dir="ltr" lang="en-gb">
<head>
    <meta charset="utf-8" />
    <title>Geolocation API getCurrentPosition example</title>
    <style>
        #map { width:100%; height:800px; }
    </style>
    <script src="http://maps.google.com/maps/api/js?sensor=false"></script>
</head>
<body>
    <p>Click on the marker for position information.</p>
    <div id="map"></div>
    <script>
        if (navigator.geolocation) {
            var timeoutVal = 10 * 1000 * 1000;
            navigator.geolocation.getCurrentPosition(
                displayPosition, 
                displayError,
                { enableHighAccuracy: true, timeout: timeoutVal, maximumAge: 0 }
            );
        }
        else {
            alert("Geolocation is not supported by this browser");
        }
        function displayPosition(position) {
            var pos = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);
            var options = {
                zoom: 10,
                center: pos,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };
            var map = new google.maps.Map(document.getElementById("map"), options);
            var marker = new google.maps.Marker({
                position: pos,
                map: map,
                title: "User location"
            });
            var contentString = "<b>Timestamp:</b> " + parseTimestamp(position.timestamp) + "<br/><b>User location:</b> lat " + position.coords.latitude + ", long " + position.coords.longitude + ", accuracy " + position.coords.accuracy;
            var infowindow = new google.maps.InfoWindow({
                content: contentString
            });
            google.maps.event.addListener(marker, 'click', function() {
                infowindow.open(map,marker);
            });
        }
        function displayError(error) {
            var errors = { 
                1: 'Permission denied',
                2: 'Position unavailable',
                3: 'Request timeout'
            };
            alert("Error: " + errors[error.code]);
        }
        function parseTimestamp(timestamp) {
            var d = new Date(timestamp);
            var day = d.getDate();
            var month = d.getMonth() + 1;
            var year = d.getFullYear();
            var hour = d.getHours();
            var mins = d.getMinutes();
            var secs = d.getSeconds();
            var msec = d.getMilliseconds();
            return day + "." + month + "." + year + " " + hour + ":" + mins + ":" + secs + "," + msec;
        }
    </script>
</body>
</html> 
```

# tsql - 子查询未返回预期结果

> ID：14145168
> 
> 赞同：0
> 
> 时间：2013-01-03T18:45:36.957
> 
> 标签：tsql, subquery

莫名其妙的查询结果或缺乏...

我试图通过从可能已经存在于第二个表中的集合中排除记录来返回一个记录集。

```
SELECT        trID
FROM            ttTrct
WHERE        (trID NOT IN
             (SELECT rteVehID
              FROM  rtHist
              WHERE  (rteSchedDT = '11/19/2012 12:00:00 AM')))

ORDER BY tractorID 
```

实际的 where 子句是...

```
WHERE  (rteSchedDT = CAST(@targetDate AS DATETIME)) 
```

但也一直在尝试使用静态日期值来避免出现任何问题。

rtHist 中存在三个记录

```
 rteVehID    rteSchedDT
 NULL        11/12/2012 12:00:00 AM
 NULL        11/19/2012 12:00:00 AM
 1645        11/19/2012 12:00:00 AM 
```

ttTrct 中存在 5 条记录

```
 trID
 1234
 4567
 9874
 1645
 2442 
```

我希望我的结果集包含 4 条记录而不是 1645 条记录。但我只得到 NULL。此外，如果 rtHist 表中的第三条记录也是 NULL 而不是 1645，我也没有得到任何结果。当然，静态日期最终将是一个变量。

关于我所缺少的任何想法？提前致谢。SSEE 2008 R2

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T18:49:34.880

您可以使用`NOT EXISTS`：

```
SELECT trID
FROM  ttTrct t
WHERE not exists (SELECT rteVehID
                   FROM  rtHist h
                   WHERE  rteSchedDT = '11/19/2012 12:00:00 AM'
                     and t.trID = h.rteVehID)
ORDER BY tractorID 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!6/9fafd/4)

`NOT IN`这是一篇关于and`EXISTS`和之间差异的精彩文章`LEFT JOIN`：

[NOT IN vs. NOT EXISTS vs. LEFT JOIN / IS NULL：SQL Server](http://explainextended.com/2009/09/15/not-in-vs-not-exists-vs-left-join-is-null-sql-server/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T18:54:23.680

我也遇到过类似的情况，空值滑入子查询并搞砸了。尝试

```
...
WHERE  (rteSchedDT = '11/19/2012 12:00:00 AM'
        and rteScheDT is not null)))
... 
```

我怀疑这不是这里的问题，但值得一试。

还有，为什么

```
(rteSchedDT = CAST(@targetDate AS DATETIME)) 
```

? 只需将 @targetDate 设为日期时间变量即可。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-03T19:03:04.237

原因是该`NOT IN`子句扩展为一系列`AND`语句。由于将任何值与`NULL`is`NULL`进行比较`AND NULL`总是会导致`NULL`，因此您的 where 子句永远不会`TRUE`。它总是`NULL`。

尝试：

```
SELECT   trID
FROM     ttTrct
WHERE    (trID NOT IN
         (SELECT rteVehID
         FROM  rtHist
         WHERE  (rteSchedDT = '11/19/2012 12:00:00 AM')
             AND rteVehID IS NOT NULL)) 
```

或者，您可以只使用连接，它很可能具有相同或更好的执行计划：

```
SELECT     t.trID
FROM       ttTrct t
INNER JOIN rtHist r
        ON t.trID = r.rtHist
WHERE      r.rteSchedDT = '11/19/2012 12:00:00 AM' 
```

[来源](https://stackoverflow.com/questions/129077/sql-not-in-constraint-and-null-values)

# c# - 如何在 wcf (REST) 中代理图像流

> ID：14145169
> 
> 赞同：1
> 
> 时间：2013-01-03T18:45:36.507
> 
> 标签：c#, wcf, stream

我有一个 WCF 服务（托管在 ASP.net 中），它基本上充当代理（将 http 转换为 https）。我需要连接到受信任的站点，获取图像，然后通过我的服务返回。

我想避免在开始将流发送给消费者之前在服务上下载整个图像，但我不完全确定如何去做。

我很确定我需要开始从受信任的站点获取响应流，并立即返回该流（希望 WCF 将在完成后处理流）。

到目前为止我有

```
 [WebGet(UriTemplate = "/GetImage?imageUrl={imageUrl}")]
    public Stream GetImage(string imageUrl)
    {
        if (string.IsNullOrWhiteSpace(imageUrl))
        { return new MemoryStream(Encoding.UTF8.GetBytes(ErrorBuilder.BuildJsonError("param"))); }

        Uri verification = new Uri(imageUrl);
        if (verification.Host != "flixster.com")
        {
            //TODO: Create new error for unknown urls.
            WebOperationContext.Current.OutgoingResponse.ContentType = "application/json; charset=utf-8";
            return new MemoryStream(Encoding.UTF8.GetBytes(ErrorBuilder.BuildJsonError("param")));
        }

        WebOperationContext.Current.OutgoingResponse.ContentType = "image/jpeg";

        try
        {
            HttpWebRequest request = (HttpWebRequest)HttpWebRequest.Create(imageUrl);
            //GetResponse() will get the whole thing, which I don't want. 
            //I just want to start getting bytes back and then ship the stream off to
            //the consumer. Basically a proxy.
            using (HttpWebResponse response = (HttpWebResponse)request.GetResponse())
            {

            }
        }
        catch (Exception e)
        {
            ExceptionLogger.LogException(e);
            WebOperationContext.Current.OutgoingResponse.ContentType = "application/json; charset=utf-8";
            return new MemoryStream(Encoding.UTF8.GetBytes(ErrorBuilder.BuildJsonError("param")));
        }

        throw new NotImplementedException();
    } 
```

不确定我是否朝着正确的方向前进，任何帮助将不胜感激。谢谢大家！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T10:11:00.193

这篇文章有点老了，所以可能有更新的技术可用，但它似乎正在完成一些与您试图实现的目标非常相似的事情。

[流媒体代理](http://www.codeproject.com/Articles/25218/Fast-Scalable-Streaming-AJAX-Proxy-continuously-de)

# xgettext - 如何使用 xgettext 从不同语言的文件中收集 i18n 的字符串

> ID：14145173
> 
> 赞同：1
> 
> 时间：2013-01-03T18:45:46.643
> 
> 标签：xgettext

默认情况下`xgettext`会从扩展名中猜测文件类型。但是，我有`.js`当前无法理解的 JavaScript 文件（带扩展名）。所以，我必须手动指定语言，Java 似乎是一个不错的选择。但是，我也有 Glade 文件 (XML)，显然不能将其解析为 Java ......当我`--language`在命令行上指定多个选项时，似乎只有最后一个有任何效果。

对于 xgettext 可以理解的文件类型（例如 C 和 Glade）的项目，这似乎不是问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T11:24:37.453

看来这个`--join-existing`选项是我需要的。即`xgettext`使用相同的输出文件为每种语言单独运行，只为每种语言添加`--join-existing`但第一个。请注意，如果输出文件没有 suffix `.pot`，`xgettext`将打印关于字符集的（无用）警告。

# ios - 离开应用程序会导致一段时间后崩溃

> ID：14145174
> 
> 赞同：0
> 
> 时间：2013-01-03T18:45:47.823
> 
> 标签：ios, xcode, cocos2d-iphone

我有一个 cocos2d 游戏，当我离开它一段时间（时间长短不一：可能 15-100 分钟）时它会崩溃。我没有定期调用任何会消耗内存的东西，并且当应用程序单独放置时，我没有看到仪器的内存泄漏。不会引发异常，也不会出现错误消息。

我首先收到了一些内存警告，然后应用程序无声地崩溃了，所以我认为 jetsam 正在终止该进程。他们有什么方法可以避免这种崩溃吗？哦，我正在使用 xcode 4.2、ios 6 和 ipod touch 4s。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T18:49:40.507

当应用程序进入后台模式时，您是否禁用了渲染？在手机进入睡眠状态后尝试渲染会导致崩溃。

# c - 带整数参数的函数

> ID：14145176
> 
> 赞同：0
> 
> 时间：2013-01-03T18:46:07.990
> 
> 标签：c, gmp

例如，我有一个功能如下：

```
int func(int a, int b, int c){...} 
```

现在我想使用 GMP 库。那么我该如何更改上面的代码呢？也许是这样的：

```
int func(mpz_t a, mpz_t b, mpz_t c){...} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T19:08:28.597

在这里查看不同的函数类型，并查看在 GMP 库中编写函数的示例代码。我希望这能回答你的问题：-

[http://gmplib.org/manual/](http://gmplib.org/manual/)

并检查此链接以获取低级功能：-

[http://gmplib.org/manual/Low_002dlevel-Functions.html#Low_002dlevel-Functions](http://gmplib.org/manual/Low_002dlevel-Functions.html#Low_002dlevel-Functions)

# sendmail - 发件人地址“zzz”的域无法解析用户 ID

> ID：14145177
> 
> 赞同：1
> 
> 时间：2013-01-03T18:46:08.457
> 
> 标签：sendmail

发送邮件时出错：

发件人地址“abc@xyz.com”的域无法解析用户 ID

虽然我能够向许多其他外部/内部域发送电子邮件，但很少有域不接受这个。

这是否与收件人正在检查而不接受这些电子邮件的 A 记录有关。

注意：我们将 sendmail 中的发件人 FROM 地址更改为其他名称，并且可能没有“A 记录”

# string - Makefile 解析字符串

> ID：14145181
> 
> 赞同：0
> 
> 时间：2013-01-03T18:46:22.277
> 
> 标签：string, parsing, variables, makefile

我想解析 Makefile 中的字符串以包含在 .c 文件中。由于我无法控制的情况，许多文件中有多余的条目。条目的格式可能略有不同。我可以更改原始定义下游的内容，这会使事情变得更加困难。所以这就是我所拥有的：

这是我可以从调用生成文件中获得的输入的 3 个示例（数字是随机的）。

ORIG1=S12a1234A5678

ORIG2=S123a1234A5678

ORIG3=S123123456789

所以我对最后 9 位数字感兴趣，并将它们格式化如下。

如果输出包含“A”，则应通过在字符串末尾的第 5 个数字之前插入“0”来将输出分配给另一组 makefile 变量，否则获取最后 9 个数字。OUT1=12340A5678

OUT2=12340A5678

输出3=123456789

如果可以在 Makefile 中创建输出而不是脱壳，则更可取。我尝试使用 sed 失败了。任何帮助都将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T00:45:56.400

```
targ:
    @echo $(ORIG1) | sed '/A/s/\(.*\)\(\([0-9][^0-9]*\)\{5\}\)/\10\2/;s/.*\(\([0-9\][^0-9]*\)\{9\}\)/\1/' >> destination.c 
```

请注意，此转换发生在命令中，因此它由 sed 在 shell 中处理。

您*可以*使用 Make 函数来完成此操作，而无需调用任何 shell，但您确实*不应该*. Make 不是为这种解析而设计的，所以解决方案会很糟糕。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-12-21T22:43:55.067

我敢肯定，提问者在 3 年后继续前进，但如果其他人对此感兴趣，这里是一种模块化的方式来完成任务 w/make。

```
hasA     = $(findstring A,$(1))
lastN    = $(shell echo -n $(1) | tail -c $(2))
firstN   = $(shell echo -n $(1) | head -c $(2))
smack0   = $(1)0$(2)
AFormat  = $(call smack0,$(call firstN,$(1),4),$(call lastN,$(1),5))
myFormat = $(if $(call hasA,$(1)),$(call AFormat,$(1)),$(1))
func9    = $(call myFormat,$(call lastN,$(1),9))

# AFormat   = smack0 (firstN (string,4),lastN (string,5))
# myFormat  = hasA (string) ? AFormat (string) : string
# func9     = myFormat (last9 (string))

test:
    @echo hasA     "(1234B66547) ->" $(call hasA,1234B66547)
    @echo lastN    "(RosieODonnellSuperManVelociraptor123456789,9) ->" $(call lastN ,RosieODonnellSuperManVelociraptor123456789,9)
    @echo smack0   "(1234,0,ABCD) ->" $(call smack0,1234,ABCD)
    @echo func9    "(S12a1234A5678 ) ->" $(call func9,S12a1234A5678)
    @echo func9    "(S123a1234A5678) ->" $(call func9,S123a1234A5678)
    @echo func9    "(S123123456789 ) ->" $(call func9,S123123456789) 
```

诚然，您可以将其视为仅编写一个脚本来自动执行“func9”任务并调用该脚本的一种变体，`$(shell func9 $(STR))`但是谁知道呢，也许您不想费心保存仅与某些制作食谱相关的小脚本＆您宁愿将其保存在一些帮助文件中。

# javascript - 防止 Bootstrap Modal 在其父元素（表格）更改时消失

> ID：14145182
> 
> 赞同：0
> 
> 时间：2013-01-03T18:46:25.493
> 
> 标签：javascript, html

我正在使用 Handlebars 模板化表格。在表格里面，我有一个模态。我正在使用 Sijax（Flask-Python 的简单 AJAX）来持续流式传输数据。当新数据进入 JSON 变量时，将获取新数据并使用新数据重新绘制模板。桌子上的所有元素都起作用。我的问题是，当我单击模态并进入新数据时，表格被重绘并且模态消失。

如果可能的话，我想防止模式消失，但我不知道 JS 或 HTML 这样做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T19:56:42.220

您可以将模式从 DOM 中的表格中拉出，并将其相对于表格、单元格或任何应该使用 css 定位的位置进行定位。

您还可以使用 jQuery 的[.clone()](http://api.jquery.com/clone/)并将模态元素保存到一个变量中，您可以在重新渲染时将其重新插入到表中；希望传递给它一个句柄，以便表格可以根据需要更新模态。

如果表格重新渲染并且模态在重新渲染之前打开，您还可以触发导致模态打开的事件，方法是保存一个布尔值，您可以根据需要进行检查。

# java - Akka scheduler() 每次重复都会迟到

> ID：14145186
> 
> 赞同：3
> 
> 时间：2013-01-03T18:46:41.393
> 
> 标签：java, playframework-2.0, akka, scheduler

我有一个简单的调度程序，用于每 1 秒重复一次任务：

```
Cancellable task = Akka.system().scheduler().schedule(
        Duration.create(0, TimeUnit.MILLISECONDS),
        Duration.create(1, TimeUnit.SECONDS),
        actor, new TickMsg("Tick", 0, 120)
); 
```

不幸的是，每次通过都迟到了，`ticker-duration`所以最后演员在 100 毫秒后收到 TickMsg - 好的，这在文档中有所描述，我很清楚：

> *它不会在准确的时间执行任务，但在每个滴答声中，它都会运行所有过期的东西。*

我无法理解的是为什么*每次*通过都迟到，这实际上意味着每次通过而不是 1000ms 需要 1100ms。结果在 10 次通过后我们有 1 秒的延迟，1 分钟后是 6 秒，1 小时后是 6 分钟等等......

一些解决方案是将重复持续时间设置得更短一些，因此在所需的滴答声中不会迟到，例如一个有效的示例，然后调度程序根据需要重复任务：

```
Cancellable task = Akka.system().scheduler().schedule(
        Duration.create(0, TimeUnit.MILLISECONDS),
        Duration.create((1000 - tickerDuration/2), TimeUnit.MILLISECONDS),
        actor, new TickMsg("Tick", 0, 120)
); 
```

不幸的是，这种方式有点不舒服并且容易忘记，有没有其他方法可以每隔 x 秒（或其他`TimeUnit`）重复一次任务而不将其转换为毫秒并缩短？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-03T19:47:58.383

这在 Akka 的 2.1 版中已修复。

原因很简单：HashedWheelTimer 不知道重复的任务，所以任务需要重新调度自己，但由于这发生在滴答之后，它总是会迟到并落入下一个桶。修复是包括漂移校正，请参阅[此处](https://github.com/akka/akka/blob/master/akka-actor/src/main/scala/akka/actor/Scheduler.scala#L136)了解详细信息。

# c - unsafePerformIO 和 FFI 库初始化

> ID：14145187
> 
> 赞同：13
> 
> 时间：2013-01-03T18:46:49.217
> 
> 标签：c, haskell, ffi, unsafe-perform-io

我正在为 C 中的库创建一个 FFI 模块，该库希望在调用其他任何东西之前调用 1 次不可重入函数。这个调用是幂等的，但是是有状态的，所以我可以在每个 Haskell 调用中调用它。但它很慢，并且由于不可重入，它可能会导致冲突。

那么现在是使用 unsafePerformIO 的合适时机吗？我可以将 Bool 包装在不安全的 IORef 或 MVar 中，通过忽略后续调用（全局隐藏 IORef 状态为 False 的调用）来使这些初始化调用具有幂等性。

如果不是，那么正确的方法是什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-03T19:02:39.793

我更喜欢初始化一次并提供不可伪造令牌作为您已初始化机器的证据的方法。

所以你的证据是：

```
data Token = Token 
```

您抽象地导出。

然后你的初始化函数可以返回这个证据。

```
init :: IO Token 
```

现在，您需要将该证明传递给您的 API：

```
bar  :: Token -> IO Int
bar !tok = c_call_bar 
```

等等

您现在可以用 monad 或一些更高阶的初始化环境来包装这些东西以使其更干净，但这是基本思想。

使用隐藏状态初始化 C 库的问题是，您最终要么无法并行访问库，要么在 GHCi 中遇到问题，混合编译和字节码，加载了两个不同版本的 C 库（这将失败链接器错误）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-02-26T21:20:33.130

我想指出，目前[建议](http://www.reddit.com/r/haskell/comments/2x7js6/making_withsocketsdo_unnecessary/)/而不是`withSocketsDo` [由 Neil Mitchell](http://neilmitchell.blogspot.co.uk/2015/02/making-withsocketsdo-unnecessary.html)提出一些新技巧，基于[`evaluate`](http://hackage.haskell.org/package/base-4.7.0.2/docs/Control-Exception-Base.html#v:evaluate)（“当执行结果 IO 操作时，强制其参数被评估为弱头部正常形式。”）：

```
withSocketsDo act = do evaluate withSocketsInit; act 

{-# NOINLINE withSocketsInit #-}
withSocketsInit = unsafePerformIO $ do
    initWinsock
    termWinsock 
```

> 我消除调用 withSocketsDo 要求的方法是让它变得非常便宜，然后将它洒在可能需要的任何地方。

不一定这是一个美丽的主意...

（另请参阅他在库中宣布此更新的[答案。）](https://stackoverflow.com/a/28730709/94687)

# php - 使用 php 脚本生成的 html 表格的分页问题

> ID：14145194
> 
> 赞同：0
> 
> 时间：2013-01-03T18:47:18.973
> 
> 标签：php, html

我正在处理一个 php 代码，它读取同一文件夹中的 .csv 文件并在 html 中打印一个表格。由于文件包含很多行，我想将表限制为特定的行数（例如 50）。我真的不知道该怎么做，任何人都可以帮助像我这样的新手吗？

```
 <?php

 $row = 1;
 if (($handle = fopen("myfile.csv", "r")) !== FALSE) {

echo '<table border="1">';

while (($data = fgetcsv($handle, 1000, ";")) !== FALSE) {
    $num = count($data);
    if ($row == 1) {
        echo '<thead><tr>';
    }else{
        echo '<tr>';
    }

    for ($c=0; $c < $num; $c++) {
        if(empty($data[$c])) {
           $value = "&nbsp;";
        }else{
           $value = $data[$c];
        }
        if ($row == 1) {
            echo '<th>'.$value.'</th>';
        }else{
            echo '<td>'.$value.'</td>';
        }
    }

    if ($row == 1) {
        echo '</tr></thead><tbody>';
    }else{
        echo '</tr>';
    }
    $row++;
}

echo '</tbody></table>';
fclose($handle);
 }
 ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T18:56:27.107

您要做的是传入一个 GET 参数，例如 start，然后使用它来设置 for 循环的起始编号

```
for ($c=0; $c < $num; $c++) { 
```

然后变成类似

```
for ($c=$_GET['start']; $c < $_GET['start']+50 && $c < $num; $c++) { 
```

然后在页面底部添加链接，例如

```
<a href="<?=$_SERVER['PHP_SELF']?>?start=<?=$_GET['start']-50 ?>">"><< Prev</a>
<a href="<?=$_SERVER['PHP_SELF']?>?start=<?=$_GET['start']+50 ?>">">Next >></a> 
```

显然这不是一个健壮/安全的解决方案，您需要添加检查以确保起始变量是一个数字，并添加边界检查。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T18:58:36.783

您可以使用`$row`' 值来限制它。

代码看起来像这样：

```
if ($row == 50):
    break; //exits while loop
endif; 
```

# android - 确定运行时的启动活动

> ID：14145197
> 
> 赞同：0
> 
> 时间：2013-01-03T18:47:40.660
> 
> 标签：android, android-intent

我有一个应用程序，它显示登录屏幕作为第一个活动。

由于我的应用程序中有一些新的语言功能，我现在想选择显示一个“选择语言屏幕”，它允许用户在显示登录屏幕之前选择一种语言。

根据指示有效语言的应用程序设置，我想显示登录屏幕，或者假设有多种语言可供选择的语言屏幕。

据我所知，我有 3 个选项。

1.  我可以创建一个启动屏幕活动，它是一个空白屏幕。该活动可以确定是显示语言屏幕还是登录屏幕，然后开始活动。

2.  我已经对 Application 对象进行了子类化，所以我猜我可以直接从`OnCreate`应用程序的方法中触发相关活动？

3.  始终将语言选择屏幕显示为第一个活动，如果不需要，只需启动登录活动。

我想知道是否有这样做的首选方式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T18:55:45.520

为什么不能在登录屏幕上显示一个不可取消的对话框？您可以假设英语是默认语言，如果用户更改了它，那么您可以在需要时重新启动活动或自己更改字符串。

第二种方法行不通，因为您需要有一个以应用程序开头的活动；你不能只启动一个`android.app.Application`实例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T18:55:30.030

我无法谈论选项 1 或 2，但我使用了类似于选项 3 的方法。在您的语言选择活动的 onCreate 中，如果您确定不需要它，只需启动登录活动的意图。这将在视图呈现之前运行，因此用户永远不会看到它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-03T18:49:50.733

如何将登录屏幕显示为第一个屏幕，并添加用户可以访问以选择不同语言的首选项活动。

# javascript - 使用 Ajax 在运行时加载 JavaScript

> ID：14145199
> 
> 赞同：0
> 
> 时间：2013-01-03T18:47:49.817
> 
> 标签：javascript, ajax

在[如何将 javascript 代码加载到 html 文件中](https://stackoverflow.com/questions/9037082/how-to-load-javascript-code-to-an-html-file-at-runtime)，有一种方法可以在运行时简单地加载外部 js 并执行。但是有两个问题：我们不知道它什么时候执行，我们不能自定义代码。

我正在使用这段代码：

```
var elemScript=document.createElement('script');
elemScript.setAttribute('type', 'text/javascript');
elemScript.setAttribute('language', 'javascript');
var txt = document.createTextNode(result);
elemScript.appendChild(txt);
document.head.appendChild(elemScript); 
```

在 http 请求中，结果是 php 提供的代码，它为我制作了自定义代码。上面我可以调度一些需要代码等的功能。

但这种美感在 IE8 或更早版本中不起作用。有没有办法让它发挥作用，或者是时候忘记这些老航海家了？

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T18:53:44.757

编辑：最终解决方案：

IE8 及以下版本根本不允许您使用 innerHTML、innerText、appendChild(txtNode) 或任何其他类型的 DOM 操作来修改脚本的代码。执行包含在字符串中的脚本的唯一方法是使用 eval。以下代码已在 chrome、firefox、safari、IE9、IE8 和 IE7 中测试。

```
(function (window, undefined) {

    var loaded = false;

    function onScriptLoaded() // executes after external script has loaded
    {
        if (loaded)
            return;

        // this flag is to prevent versions of ie that do support onload 
        // from executing this function twice
        loaded = true;

        // example javascript loaded from php file
        var phpScriptText = "window.alert('This was added to external script using php');";

        // this is the only way for this to work accross all browsers
        window.eval.call(window, phpScriptText);
    }

    window.onload = function () { // load external script and execute onScriptLoaded when it's done loading
        var doc = window.document;

        var script = doc.createElement("script");
        script.type = "text/javascript";
        script.src = "externalScript.js";
        script.async = true;
        script.onload = onScriptLoaded; // works in most browsers

        // for IE
        if (script.onreadystatechange !== undefined) {
            script.timer = setInterval(function () {
                if (script.readyState == "loaded" || script.readyState == "complete") {
                    onScriptLoaded();
                    clearInterval(script.timer);
                }
            }, 100);
        }

        doc.getElementsByTagName("head")[0].appendChild(script);
    };

})(window); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T22:25:25.563

我建议[require.js](http://requirejs.org/)，它将与 Vanilla JS / jQuery 一起使用。 [这](http://requirejs.org/docs/api.html#afterload)是页面加载后加载脚本的示例。

此外，您可以使用 require.js DomReady[插件](http://requirejs.org/docs/api.html#pageload)来更好地控制旧版和现代浏览器。

# python - 在多处理中，为什么访问此队列时 1 个进程比多个进程快？

> ID：14145201
> 
> 赞同：1
> 
> 时间：2013-01-03T18:47:59.480
> 
> 标签：python, python-3.x, queue, multiprocessing

我有这段代码，并注意到在指定超过 1 个线程时，性能会受到影响。这里的概念很简单，在多处理中设置一个队列，从每个线程访问它，同样——注意我在这里使用了一个容易分割的队列大小。

```
import time
from  multiprocessing import Process, Queue

def worker(q,x):
    for i in range(x):
        message = q.get()

if __name__ == "__main__":

    workers=[]
    threads=1
    x = int(1000000/threads) #break up the work for each thread
    q = Queue()

    for i in range(threads):
        p=Process(target=worker, args=(q,x))
        workers.append(p)

    print('creating queue')
    for num in range(1000000):
        q.put("MESSAGE")

    start_time = time.time()

    print('starting jobs')
    for p in workers:
        p.start()

    print('waiting until jobs finish')
    for p in workers:
        p.join()

    end_time = time.time()

    duration = end_time - start_time
    msg_per_sec = 1000000 / duration

    print ("Duration: %s" % duration)
    print ("Messages Per Second: %s" % msg_per_sec) 
```

我用执行 urllib 请求的多处理线程制作了一个不同的脚本，它表明缩放处理器有助于加快速度，所以我在这里做错了什么；是不是我正在从所有进程访问队列并且本质上是阻塞的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T18:55:45.097

问题是你的工人没有做任何有用的工作。所有的时间都花在从队列中取出东西上。队列是共享的，对它的所有访问都是序列化的，因此没有加速。

一旦工作人员开始花费一些 CPU 或 I/O 时间来处理每条消息，事情就会开始改善。

参见[阿姆达尔定律](http://en.wikipedia.org/wiki/Amdahl%27s_law)。

# regex - nodejs 正则表达式 - 为什么我们需要“？” 在下面的正则表达式中

> ID：14145203
> 
> 赞同：1
> 
> 时间：2013-01-03T18:48:15.127
> 
> 标签：regex, node.js

我对以下正则表达式有疑问：

```
match = /^([^[]+?)(\[.*\])?$/.exec(path); 
```

我不明白“？”的行为。在第一个表达式中：

```
^([^[]+?) 
```

我的意思是，如果这个表达式是一个独立的正则表达式，并且路径是“abc[def]”，我会得到：“a”作为 match[1]，对吧？（由于惰性匹配）。现在，当我添加第二个表达式时，match[1] 是：“abc”。你能解释一下区别吗？

谢谢，李

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T18:54:23.940

如果你使用`?`你实际上是在说，

*   可以不可以

*   `lazy`匹配

`ab?`有`a`或无`b`（仅一次）

但以这种格式：

`a+?`是：“尝试搜索 a，但不要贪婪”

所以这里只会匹配 [aaaaaaa] 中的第一个 [a]。

# 编辑

```
/^([^[]+?)/.exec("abc[def]");  //["a", "a"] 
```

这是为什么 ？

因为你在寻找

从一开始----一切不包括`[`但搜索最小的事件。

那是你的`a`

但是当你在做

```
/^([^[]+?)(\[.*\])?$/.exec("abc[def]"); 
```

让你印象深刻的是：

`.*`在第二组。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-03T18:56:13.513

在`?`将`+`正则表达式引擎的行为交换为不贪婪之后。默认情况下，引擎会尝试匹配可用的最大字符串。随着尾随`?`它试图获得最短。

更多信息可在此处获得：[http ://www.regular-expressions.info/repeat.html](http://www.regular-expressions.info/repeat.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-03T21:40:50.773

`?`结构中的或`+?`导致`*?`其前面的运算符以非贪婪或懒惰的方式行事。这意味着它将消耗尽可能少的字符而不是尽可能多的字符（默认情况下）。

但是，在这个特定的正则表达式中，没有`?`改变行为的字符串。

```
/^([^[]+?)(\[.*\])?$/ 
```

由于第一组`([^[]+?)`必须跟在字符串的结尾或 a 之后`[`，并且第一组不能包含 a `[`，因此它将匹配整个字符串（如果其中没有`[`）或直到第一个`[`，或者它不会完全匹配。所以在这种情况下，贪婪`+`是无关紧要的。

# iphone - 你可以捆绑一个 Objective-C iPhone 应用程序和一个 HTML5 (PhoneGap) iPad 应用程序来制作一个通用应用程序吗？

> ID：14145204
> 
> 赞同：-1
> 
> 时间：2013-01-03T18:48:19.113
> 
> 标签：iphone, ios, html, ipad, cordova

这些应用程序提供相同的功能，但具有不同的代码库。

这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T19:22:24.920

在这种情况下，我不完全确定您所说的“捆绑”是什么意思。PhoneGap 提供了将您的应用程序部署到众多平台（iOS、Android、Windows Phone）的能力，只需编写 HTML5、CSS 和 Javascript。您的问题表明您有一个为 PhoneGap 平台编写的应用程序的功能 HTML5 版本。如果是这样的话，Objective-C iPhone 应用程序的需求是什么？只需维护 HTML5 应用程序就足以部署到 iPad 和 iPhone。PhoneGap 目前支持 iOS、iPad 和 Retina 显示器。

从[PhoneGap 文档](https://build.phonegap.com/docs/config-xml)中，您可以使用`config.xml`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T11:49:47.967

您可以相当轻松地混合 phonegap 和本机代码 - 只需让启动代码检查平台类型并显示本机视图或 phonegap webview。

但是，此时您所做的任何事情都会给用户带来一些不便——跨设备共享应用购买的唯一方法是拥有一个通用应用。如果您想保留现有购买，则必须将 ipad 视图添加到现有 iphone 应用程序，但这不会显示为任何拥有现有 iPad 应用程序的人的更新。

还有其他可能性，例如设置服务器以跟踪两个应用程序中的购买情况，但这比应用程序购买中的标准复杂得多，并且只有在您的应用程序包含登录系统时才有效。

# javascript - JavaScript `match` 行为

> ID：14145206
> 
> 赞同：0
> 
> 时间：2013-01-03T18:48:35.353
> 
> 标签：javascript, regex

在我的 Chrome 控制台中，我尝试了这个：

```
>  "abcd".match(/(.+)+/)
<  ["abcd", "abcd"] 
```

`match`返回**两个**“结果”的事实对我来说是出乎意料和奇怪的。我在 Firefox 中进行了测试，结果是一样的（所以我认为这不是任何类型的错误）。

但是，在 Python 中：

```
>  re.findall(r'(.+)+', 'abba')
<  ['abba'] 
```

我无法解释这一点。这是怎么回事？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T18:52:53.083

我认为在 javascript 中， .match 给出了第 0 组（没有捕获的整个匹配表达式）以及第 1 组（捕获的组），而 python 的 findAll 行为不同——只显示捕获的组，而不是整个匹配的部分（第 0 组)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-03T18:56:19.447

根据[MDN](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/match)：

> 如果正则表达式不包含 g 标志，则返回与 regexp.exec(string) 相同的结果。

从[exec](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/RegExp/exec)：

> 返回的数组将匹配的文本作为第一项，然后是每个匹配的包含捕获的文本的捕获括号的一项。

所以返回数组中的第一项是匹配项（`"abcd"`），第二项是唯一一个带括号的组（恰好也是`"abcd"`）。

# python - Web Scraper 不使用 Python 生成结果

> ID：14145207
> 
> 赞同：-2
> 
> 时间：2013-01-03T18:48:50.817
> 
> 标签：python

我是一只需要你帮助的年轻蚱蜢。我做了很多研究，似乎找不到解决方案。我在下面编写了以下代码。运行时它不会提取任何标题。我相信我的正则表达式是正确的。不确定是什么问题。对于经验丰富的老师来说可能是显而易见的。提前致谢。

```
from urllib import urlopen

import re

url = urlopen('http://www.realclearpolitics.com/epolls/2012/senate/ma/massachusetts_senate_brown_vs_warren-2093.html#polls').read()

'''
a href="http://multimedia.heraldinteractive.com/misc/umlrvnov2012final.pdf">Title a>
'''

A = 'a href.*pdf">(expression to pull everything) a>' 

B = re.compile(A) 

C = re.findall(B,url)

print C 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T18:54:35.230

这在 SO 上经常出现。而不是使用正则表达式，您应该使用允许您搜索/遍历文档树的 HTML 解析器。

我会使用[BeautifulSoup](http://www.crummy.com/software/BeautifulSoup/)：

> Beautiful Soup 解析你给它的任何东西，并为你做树遍历的东西。您可以告诉它“查找所有链接”，或“查找类 externalLink 的所有链接”，或“查找所有 url 匹配“foo.com”的链接，或“查找带有粗体文本的表格标题，然后给出我那条短信。”

```
>>> from bs4 import BeautifulSoup
>>> html = ? # insert your raw HTML here
>>> soup = BeautifulSoup(html)
>>> a_tags = soup.find_all("a")
>>> for anchor in a_tags:
>>> ...     print anchor.contents 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T18:59:07.583

我将回应关于不使用 RegEx 解析 HTML 的其他评论，但有时它既快速又简单。看起来您示例中的 HTML 不太正确，但我会尝试类似的方法：

```
re.findall('href.*?pdf">(.+?)<\/a>', A) 
```

# java - Tomcat：重启服务器后才能获取上传的图片

> ID：14145219
> 
> 赞同：1
> 
> 时间：2013-01-03T18:49:41.813
> 
> 标签：java, caching, tomcat, file-upload

> **可能重复：**
> [上传的图片仅在刷新页面后可用](https://stackoverflow.com/questions/8885201/uploaded-image-only-available-after-refreshing-the-page)

我正在将图像上传到我的网络上下文中的文件夹“图像”。一切正常，我可以看到图像已正确上传到该文件夹​​中。但是，在上传后，我无法使用 url ' [http://mywebapp/images/uploadedimage.png](http://mywebapp/images/uploadedimage.png) ' (404) 访问该图像......显然，只有在服务器重新启动后，该资源才可用，这当然是不合适。我该如何解决这个问题，这是 Tomcat 缓存问题吗？

提前致谢

# c# - 上传游戏分数并计算百分位数

> ID：14145220
> 
> 赞同：0
> 
> 时间：2013-01-03T18:49:43.783
> 
> 标签：c#, windows-phone-8, azure-mobile-services

我正在写一个简单的手机游戏，最后，玩家的分数和他的玩家ID被上传到云端的数据库中。该数据库维护每个玩家的高分。

上传分数后，游戏（客户端应用程序）会拉取数据库中的所有分数，并计算并显示当前游戏的百分位分数、该玩家的最佳分数以及历史前 20 名玩家的最佳分数。我遇到的问题是，目前数据库中只有几百行，但随着数据库大小的增长，获取所有行并在客户端进行计算将是有问题的。

无论如何我可以以可扩展的方式执行此计算并具有良好的性能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T19:14:06.420

您可以将每个玩家的绝对分数存储在数据库中，并在请求排名时找到最高分数并使用它来确定要显示的每个玩家的百分比。百分位数可以通过将每个玩家的有序索引除以在处理查询结果时注册的所有玩家的数量来确定

所有这些都应该在服务器上的数据访问层中完成（或您拥有的任何等价物）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T18:52:48.970

我相信你应该在服务器端进行计算

# java - Java ArrayList - 检查列表是否为空

> ID：14145235
> 
> 赞同：63
> 
> 时间：2013-01-03T18:50:36.970
> 
> 标签：java, arraylist

如何检查列表是否为空？如果是这样，系统必须给出一条消息说**List is empty**。如果不是，系统必须给出消息说**List is not empty**。用户可以输入数字，`-1`停止程序。这是我现在拥有的代码，但这不起作用，它总是说“列表不为空”。

```
import java.util.*;
import javax.swing.JOptionPane;

public class ArrayListEmpty 
{
    public static void main(String[] args) 
    {
        List<Integer> numbers = new ArrayList<Integer>();
        int number;
        do {
            number = Integer.parseInt(JOptionPane.showInputDialog("Enter a number (-1 to stop)"));
            numbers.add(number);
        } while (number != -1);
        giveList(numbers);
    }

    public static void giveList(List<Integer> numbers)
    {
        if (numbers != null)
            JOptionPane.showMessageDialog(null, "List isn't empty");
        else
            JOptionPane.showMessageDialog(null, "List is empty!");
    }
} 
```

* * *

## 回答 #1

> 赞同：171
> 
> 时间：2013-01-03T18:51:17.923

就像：

```
if (numbers.isEmpty()) {...} 
```

请注意，快速查看[文档](http://docs.oracle.com/javase/7/docs/api/java/util/List.html#isEmpty%28%29)会为您提供该信息。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2013-01-03T18:53:10.360

你应该使用方法`listName.isEmpty()`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-07-26T14:41:47.717

现在的良好做法是使用来自 Apache Commons 或 Spring Framework 的 CollectionUtils。

```
CollectionUtils.isEmpty(list)) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-01-03T19:12:12.797

您最初的问题是您正在检查列表是否为空，因为您使用`List<Integer> numbers = new ArrayList<Integer>();`. 但是，您已更新代码以使用该`List.isEmpty()`方法正确检查列表是否为空。

现在的问题是您实际上从未将空列表发送到`giveList()`. 在您的 do-while 循环中，您将任何输入数字添加到列表中，即使它是 -1。为防止添加 -1，请将 do-while 循环更改为仅添加非 -1 的数字。然后，如果用户的第一个输入数字是-1，则列表将为空。

```
do {
    number = Integer.parseInt(JOptionPane.showInputDialog("Enter a number (-1 to stop)"));
    /* Change this line */
    if (number != -1) numbers.add(number);
} while (number != -1); 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-11-14T05:19:53.660

或者，您可能还想通过 .size() 方法进行检查。非空列表的大小将大于零

```
if (numbers.size()>0){
//execute your code
} 
```

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2018-10-14T17:24:55.570

来源：CodeSpeedy 点击了解更多[检查 ArrayList 是否为空](https://www.codespeedy.com/finding-an-arraylist-in-java-is-empty-or-not/)

```
import java.util.ArrayList;
public class arraycheck {
public static void main(String args[]){
ArrayList<Integer> list=new ArrayList<Integer>();

    if(list.size()==0){
        System.out.println("Its Empty");

    }
    else
        System.out.println("Not Empty");

   }

} 
```

输出：

```
run:
Its Empty
BUILD SUCCESSFUL (total time: 0 seconds) 
```

# google-app-engine - 旧版 mapreduce 库仅运行一个分片

> ID：14145236
> 
> 赞同：1
> 
> 时间：2013-01-03T18:50:45.350
> 
> 标签：google-app-engine, mapreduce

我们正在使用 mapreduce 库的“旧版”（非 PipelineAPI）版本：[http ://code.google.com/p/appengine-mapreduce/](http://code.google.com/p/appengine-mapreduce/)

问题是我们只能获得一个分片处理，即使对于拥有超过 150,000 个实体的种类也是如此。我们尝试了不同的 shard_count 配置，例如 4、16、128，但始终只有一个 shard 处理整个数据集，这非常慢。

我觉得我错过了一步（例如，创建索引或其他东西）。我们只是在其他应用程序上成功地使用了这个遗留库，并且它按预期运行多个分片。

交叉我的手指，有人知道一个临时的答案。

谢谢，j

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T21:32:57.887

找到了！

此问题在 Python 中出现，并且仅在您覆盖模型的默认种类名称时才会出现。

我在 mapreduce 问题跟踪器上为此打了一个补丁：[http ://code.google.com/p/appengine-mapreduce/issues/detail?id=154](http://code.google.com/p/appengine-mapreduce/issues/detail?id=154)

# magento - magento 选项卡式后端，例如自定义实体的目录/产品

> ID：14145237
> 
> 赞同：1
> 
> 时间：2013-01-03T18:50:46.193
> 
> 标签：magento, magento-1.7, adminhtml

我想编写一个带有自定义实体的模块。在后端，它应该看起来像产品的后端（左侧的选项卡，右侧的表单）。

我尝试了许多变体，并从核心检查/复制了许多东西以理解它……好吧，我没有。

知道任何人的教程或实现这一点的必要关键点吗？

非常感谢

编辑：好吧，创建自己的实体不是问题，这是众所周知的。我需要帮助来创建后端，以便在编辑产品时结果看起来像选项卡式表单

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-04T05:38:13.827

要在 admin 中添加多个选项卡，请首先通过mpaepper 提供的[http://codemagento.com/2011/02/grids-and-forms-in-the-admin-panel/ 。](http://codemagento.com/2011/02/grids-and-forms-in-the-admin-panel/)

之后创建下面的类

```
Super_Awesome_Block_Adminhtml_Example_Edit_Tabs
Super_Awesome_Block_Adminhtml_Example_Edit_Tabs_Form
Super_Awesome_Block_Adminhtml_Example_Edit_Tabs_SecondTab 
```

并修改 `Super_Awesome_Block_Adminhtml_Example_Edit_Form`为

```
class Super_Awesome_Block_Adminhtml_Example_Edit_Form extends Mage_Adminhtml_Block_Widget_Form
{
    protected function _prepareForm()
    {
        $form = new Varien_Data_Form(array(
                'id' => 'edit_form',
                'action' => $this->getUrl('*/*/save', array('id' => $this->getRequest()->getParam('id'))),
                'method' => 'post',
                'enctype' => 'multipart/form-data',
        ));

        $form->setUseContainer(true);

        $this->setForm($form);

        return parent::_prepareForm();
    }
} 
```

添加以下代码

```
class Super_Awesome_Block_Adminhtml_Example_Edit_Tabs extends Mage_Adminhtml_Block_Widget_Tabs {

    public function __construct() {
        parent::__construct();
        $this->setId('awesome_tabs');
        $this->setDestElementId('edit_form');
        $this->setTitle(Mage::helper('awesome')->__('Your Title Here'));
    }

    protected function _beforeToHtml() {
        $this->addTab('form_section', array(
            'label' => Mage::helper('awesome')->__('Details'),
            'title' => Mage::helper('awesome')->__('Details'),
            'content' => $this->getLayout()->createBlock('awesome/adminhtml_awesome_edit_tab_form')->toHtml(),
        ));

        $this->addTab('secondtab_section', array(
            'label'     => Mage::helper('awesome')->__('SecondTab'),
            'title' => Mage::helper('awesome')->__('SecondTab'),
            'content'   => $this->getLayout()->createBlock('awesome/adminhtml_awesome_edit_tab_secondtab')->toHtml(),
        ));

        return parent::_beforeToHtml();
    }

} 
```

...

```
class Super_Awesome_Block_Adminhtml_Example_Edit_Tabs_Form extends Mage_Adminhtml_Block_Widget_Form
{
  protected function _prepareForm()
  {
      $form = new Varien_Data_Form();
      $this->setForm($form);
      $fieldset = $form->addFieldset('awesome_form', array('legend'=>Mage::helper('awesome')->__('Header text here')));

      $fieldset = $form->addFieldset('example_form', array(
             'legend' =>Mage::helper('awesome')->__('Example Information')
        ));

        $fieldset->addField('name', 'text', array(
             'label'     => Mage::helper('awesome')->__('Name'),
             'class'     => 'required-entry',
             'required'  => true,
             'name'      => 'name',
             'note'     => Mage::helper('awesome')->__('The name of the example.'),
        ));

        $fieldset->addField('description', 'text', array(
             'label'     => Mage::helper('awesome')->__('Description'),
             'class'     => 'required-entry',
             'required'  => true,
             'name'      => 'description',
        ));

        $fieldset->addField('other', 'text', array(
             'label'     => Mage::helper('awesome')->__('Other'),
             'class'     => 'required-entry',
             'required'  => true,
             'name'      => 'other',
        ));

        if (Mage::getSingleton('adminhtml/session')->getExampleData())
        {
            $data = Mage::getSingleton('adminhtml/session')->getExamplelData();
            Mage::getSingleton('adminhtml/session')->getExampleData(null);
        }
        elseif (Mage::registry('example_data'))
        {
            $data = Mage::registry('example_data')->getData();
        }
        else
        {
            $data = array();
        }

      return parent::_prepareForm();
  }
} 
```

……

```
class Super_Awesome_Block_Adminhtml_Example_Edit_Tabs_SecondTab extends Mage_Adminhtml_Block_Widget_Grid {

    public function __construct() {
        parent::__construct();
        $this->setId('awesomeGrid');
        $this->setDefaultSort('awesome_secondtab_id');
        $this->setDefaultDir('DESC');
        $this->setSaveParametersInSession(true);
        $this->setFilterVisibility(false);
        $this->setPagerVisibility(false);
    }

    protected function _prepareCollection() {
        $id     = $this->getRequest()->getParam('id');
        $collection = Mage::getModel('awesome/secondtab')->getCollection()->addFilter('awesome_id', $id);
        $this->setCollection($collection);
        return parent::_prepareCollection();
    }

    protected function _prepareColumns() {

        $this->addColumn('created_time', array(
            'header' => Mage::helper('awesome')->__('Date'),
            'index' => 'created_time',
            'type' => 'datetime',
            'align' => 'left',
            'sortable' => false,
        ));

        $this->addColumn('type', array(
            'header' => Mage::helper('awesome')->__('Type'),
            'align' => 'left',
            'index' => 'type',
            'sortable' => false,
        ));

        $this->addColumn('amount', array(
            'header' => Mage::helper('awesome')->__('Amount'),
            'align' => 'left',
            'index' => 'amount',
            'type'  => 'currency',
            'currency' => 'amount',
            'sortable' => false,
        ));

        $this->addColumn('balance', array(
            'header' => Mage::helper('awesome')->__('Balance'),
            'align' => 'left',
            'index' => 'balance',
            'type'  => 'currency',
            'currency' => 'balance',
            'sortable' => false,
        ));

        $this->addColumn('order_number', array(
            'header' => Mage::helper('awesome')->__('Order Number'),
            'align' => 'left',
            'index' => 'order_number',
            'sortable' => false,
        ));

        return parent::_prepareColumns();
    }

} 
```

# sql - 在 SQL Server 中分配行号，但按值分组

> ID：14145240
> 
> 赞同：5
> 
> 时间：2013-01-03T18:51:00.010
> 
> 标签：sql, sql-server, tsql

我想从表中选择 2 列，并为每个值分配一个 int 值。但是，我希望第一列 ID 对于所有相同的值都相同。

对于第二列，我希望每个值也被编号，但由第一列分区。我已经弄清楚了这部分，但我无法让第一部分工作。

这是我正在使用的测试场景。

```
DECLARE @TestTable as Table (Column1 char(1), Column2 char(1))

INSERT INTO @TestTable SELECT 'A','A' 
INSERT INTO @TestTable SELECT 'A','B' 
INSERT INTO @TestTable SELECT 'A','C' 
INSERT INTO @TestTable SELECT 'B','D' 
INSERT INTO @TestTable SELECT 'B','E' 
INSERT INTO @TestTable SELECT 'B','F' 
INSERT INTO @TestTable SELECT 'B','G' 
INSERT INTO @TestTable SELECT 'B','H' 
INSERT INTO @TestTable SELECT 'C','A' 
INSERT INTO @TestTable SELECT 'C','B' 
INSERT INTO @TestTable SELECT 'C','C' 

SELECT 
    Row_Number() OVER (Partition BY Column1 ORDER BY Column1) as Column1_ID,
    Column1,
    Row_Number() OVER (Partition BY Column1 ORDER BY Column1, Column2) as Column2_ID,
    Column2
FROM @TestTable 
```

当我运行它时，Column2_ID 中的值是正确的，但我希望 Column1_ID 的值如下。

```
Column1_ID  Column1  Column2_ID  Column2
1             A        1           A
1             A        2           B
1             A        3           C
2             B        1           D
2             B        2           E
2             B        3           F
2             B        4           G
2             B        5           H
3             C        1           A
3             C        2           B
3             C        3           C 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-03T18:56:29.443

你只需要使用不同的排名功能，

```
dense_rank() OVER (ORDER BY Column1) as Column1_ID 
```

[http://msdn.microsoft.com/en-us/library/ms173825.aspx](http://msdn.microsoft.com/en-us/library/ms173825.aspx)

SQL小提琴：[http ://www.sqlfiddle.com/#!6/d41d8/1832](http://www.sqlfiddle.com/#!6/d41d8/1832)

# sql - SQL - 重写基于日期的查询而不进行字符串操作？

> ID：14145247
> 
> 赞同：1
> 
> 时间：2013-01-03T18:51:18.063
> 
> 标签：sql, tsql, datetime, sql-server-2008-r2

我有一个在 SQL 2008 R2 服务器上运行的 SQL 查询。它在每月的 1 日和 16 日运行。该查询包含以下用于设置 StartDate 和 EndDate 参数的逻辑：

```
DECLARE     @RunDateTime datetime
DECLARE     @RunDate datetime
DECLARE     @StartDate datetime
DECLARE     @EndDate datetime
DECLARE     @Month int
DECLARE     @Year int
DECLARE     @strStartDate varchar(10)

SET     @RunDateTime = GetDate()
SET     @RunDate = CAST(@RunDateTime AS DATE)

IF                  DATEPART(d, @RunDate) = 16
    BEGIN       
                    SET @StartDate =  DATEADD(d, -15, @RunDate)
                    SET @EndDate = @RunDate
    END
ELSE
    BEGIN
                    IF      Month(@RunDate) = 1
                            SET @Month = 12
                    ELSE    
                            SET @Month = Month(@RunDate) - 1

                    IF      Month(@RunDate) = 1
                            SET @Year = Year(@RunDate) - 1
                    ELSE
                            SET @Year = Year(@RunDate)

                    SET @strStartDate = CAST(@Year AS VARCHAR) + CAST(@Month AS VARCHAR) + '16'
                    SET @StartDate = CONVERT(datetime, @strStartDate)
                    SET @EndDate = @RunDate
    END 
```

如果查询在 16 日运行，我们希望日期范围为每月 1 日到 15 日。如果查询在 1 日运行，我们希望日期范围是从 16 日到上个月的月底。

由于工作中的需求不断变化，我们被告知需要找到一种方法来做到这一点，而无需使用任何日期到字符串的转换。这可能吗，有没有人知道如何做到这一点？我很快就在这里脱离了我的深度。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T19:00:52.403

当我看到您之前的问题时，我知道有一种更简单的方法可以解决这个问题。这个怎么样：

```
DECLARE     @StartDate date;
DECLARE     @EndDate date;
DECLARE     @RunDateTime datetime = getdate() - 2;

if DAY(@RunDateTime) = 1
begin
    set @StartDate = dateadd(day, 15, DATEADD(MONTH, -1, @RunDateTime));
    set @EndDate = DATEADD(day, -1, @RunDateTime);
end
else if day(@RunDateTime) = 16
begin
    set @StartDate = dateadd(day, -DAY(@RunDateTime) + 1, @RunDateTime);
    set @EndDate = dateadd(day, -DAY(@RunDateTime) + 15, @RunDateTime);
end
else -- do your error processing here 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-03T19:58:12.470

这将符合您的规范。它不关心您在哪一天运行它，并且如果 EndDate 不在确切的边界上，它会将其调整为当前日期。我无法与您给定的代码完全比较，因为它在某些日期（例如`20120201`）有错误。

```
DECLARE
   @StartDate datetime,
   @EndDate datetime;

SELECT
   @StartDate = Convert(date, M.Anchor + X.S),
   @EndDate = Convert(date,
      M.Anchor + Day(GetDate() - 1)
      - CASE WHEN Day(GetDate()) IN (1, 16) THEN 1 ELSE 0 END
   )
FROM
   (VALUES (1, 15, 0), (16, 31, 15)) X (F, T, S)
   CROSS APPLY (
      SELECT DateAdd(month, DateDiff(month, 0, GetDate() - 1), 0)
   ) M (Anchor)
WHERE Day(GetDate() - 1) BETWEEN X.F AND X.T; 
```

我针对一年的日期测试了这段代码，我相信一切正常。

[通过在这个 SqlFiddle](http://sqlfiddle.com/#!3/0ef91/8)中检查一年的计算结果，自己验证它的正确性。

基本上：从昨天的日期计算每月的第一天。使用该日期，确定从月初的偏移量以计算开始日期（如果 1 日 - 15 日，使用 0；如果 16 日 - 31 日，使用 15）。最后，从月初 + 计算的日期计算结束日期，对 1 日和 16 日进行特殊调整以使用前一天的结束期间。

实际上，始终指定到周期结束（1 - 16 或 1 - 28/29/30/31）而不是一直持续到这一天并没有什么害处，但这不是你所要求的。

回答您关于查询中发生的事情的问题。

1.  派生表是行集返回查询，通常以 a 开头，`SELECT`括在括号中并给出别名。例如：

    ```
    SELECT X.FullName
    FROM
       (
          SELECT FullName = FirstName + ' ' + LastName
          FROM dbo.User
          WHERE ID = 123
       ) AS X 
    ```

    在这里，我们派生`X`了包含其中查询结果的表。我喜欢跳过这一`AS`部分，因为对我来说它只会增加混乱。请注意，这只是一个简单的示例——派生表通常比这更复杂，并且在各种情况下都很有用。我在`dbo.User`桌子上没有使用别名，但最好这样做。但重要的是要注意派生表中的所有列引用都是从派生表中解析的。不使用外面的桌子。

2.  `VALUES`是一种从查询中提供的值创建行集的方法。您可能熟悉的正常语法是`INSERT dbo.Table VALUES (1, 'a');`. 在 SQL Server 2008 中，这被扩展为同时允许多行，如`INSERT dbo.Table VALUES (1, 'a'), (2, 'b');`. 我还允许这种特殊的多行表示法代替`SELECT`派生表中的查询。例如：

    ```
    SELECT X.*
    FROM (VALUES (1, 'a'), (2, 'b')) X
    -- Alias X is for a derived table of 2 rows & 2 unnamed columns 
    ```

3.  派生表的列名通常是从查询中发现的。看到在#1 中，`X.FullName`实际上是指包含来自 table 的多个列的表达式`dbo.User`。表达式在查询中被显式地赋予了一个新别名。如果您没有提供别名，则会收到错误消息，因为表达式没有内在名称。事实上，前一点的查询不会按原样运行，因为派生表`X`没有列名！但是，有一种语法可以在派生表*之外提供显式列别名：*

    ```
    SELECT X.ID, X.Name
    FROM (VALUES (1, 'a'), (2, 'b')) X (ID, Name) 
    ```

    我更喜欢第二种语法，因为它确实有助于明确其意图，它有助于将表达式与其名称分开，而且通常对我来说，在派生表中列别名更好。很多时候，我从其他地方复制和粘贴派生表中的内容，而且不必每次都拼凑列名是很好的。别名`F`,`T`和`S`是给我`From`的`To`, 和`Start`. 我本可以让它们成为更长的名字，但我选择不这样做。

4.  使用`SELECT Alias = <Expression>`只是`SELECT <Expression> AS Alias`. 我更喜欢这种`=`方法，因为这样别名可靠地位于一个易于扫描的列的左侧，而不是可变长度表达式的末尾。由于能够通过添加一个字符来更改变量名称，或者`UPDATE`轻松地将查询转换为语句，因此这种语法也有好处。

5.  您可以更改任何查询以将值分配给变量，而不是仅通过`@Variable =`在每个列表达式前面添加来返回行集。需要注意的一个问题是，如果查询返回多行，虽然您仍然可以使用该`@Variable =`语法，但服务器仍将完成所有实现所有行的工作，并且您的变量将仅具有值) 从一些，一个，行。它可能是第一行，也可能是最后一行，但即使您认为返回的行一致，您也应该始终假设它是*随机*行。如果您需要特定行，则提供 WHERE 子句或带有 的`TOP`语句`ORDER BY`以强制使用特定行的值。

6.  `CROSS APPLY`只是一个派生表，它具有允许具有“外部引用”的特殊属性，也就是说，它可以在括号内使用之前引入的表中的列值。它在没有返回行时限制行（就像`INNER JOIN`ed 派生表一样），或者`OUTER APPLY`不限制行（就像`OUTER JOIN`ed 派生表一样）。它不需要`ON`子句，因为所有过滤都是通过`WHERE`子句完成的。优化器非常善于理解查询的意图，并且最终不会`APPLY`为每个外部行运行一次——它几乎总是能够智能地获取数据，就好像它只是一个常规连接一样。我在这里使用它作为一种廉价的方法来获取我可以多次使用的查询中的计算值。我也可以做到`DECLARE @MonthDate = <same expression>`并改用它，但我的某些部分喜欢在我不需要时不声明变量（因为 @MonthDate 变量仅用于单个查询）。

PS我想指出我在您的示例代码中看到的一件事（如果您允许的话）。考虑这一部分：

```
IF   Month(@RunDate) = 1
     SET @Month = 12
ELSE    
     SET @Month = Month(@RunDate) - 1

IF   Month(@RunDate) = 1
     SET @Year = Year(@RunDate) - 1
ELSE
     SET @Year = Year(@RunDate) 
```

所有这些排列都非常适合尝试传达 IF / ELSE 块的意图，但在我的专业意见中，您应该使用`BEGIN`and `END`。编写此代码的人选择以这种方式布置条件的一个原因是缩进样式（对我而言）有点过分。每个`BEGIN`最终都有 2 个缩进深度，一个用于`IF`（将其视为一个缩进块），一个用于`BEGIN .. END`. 但是这种对没有块的单语句 IF 的附加会导致几个问题。

1.  上面的表达式没有正确传达意图，并迫使审阅者评估为什么某事被做了两次，实际上这两个条件是相同的。对于初学者，该块应重写为：

    ```
    IF   Month(@RunDate) = 1
         BEGIN
            SET @Month = 12;
            SET @Year = Year(@RunDate) - 1;
         END
    ELSE
         BEGIN
            SET @Month = Month(@RunDate) - 1;
            SET @Year = Year(@RunDate);
         END; 
    ```

    现在可以明智地理解和审查这一点。

2.  一旦您开始添加多个条件或嵌套级别，您就会陷入大麻烦并发现几乎无法调试。如果某个有进取心的开发人员认识到这两个条件是相同的，并且将它们的内容结合起来最有意义，那么会编写以下代码：

    ```
    IF   Month(@RunDate) = 1
         SET @Month = 12;
         SET @Year = Year(@RunDate) - 1;
    ELSE
         SET @Month = Month(@RunDate) - 1;
         SET @Year = Year(@RunDate); 
    ```

    这*看起来*不错，但隐藏了第二个`SET`语句不属于`IF`它之前的事实。现在，它不会正确编译，因为它`ELSE`是孤立的。但如果改变是这样的：

    ```
    IF   Month(@RunDate) = 1
         SET @Month = 12;
         IF @SpecialFlag = 1
            SET @Year = Year(@RunDate) - 1;
    ELSE
         SET @Month = Month(@RunDate) - 1;
         IF @SpecialFlag = 1
            SET @Year = Year(@RunDate); 
    ```

    现在我们有一个可怕的混乱！这将正确解析，但与开发人员预期的结果相去甚远：`ELSE`块是`@SpecialFlag`条件的一部分！由于缩进，它在代码中看起来肯定不像它。

因此，尽管我知道代码格式约定可能会因坚定的信念而受到青睐，并且组织和人员可能会极大地抵制更改，但我想建议您将获得一些好处，如果 1）您在所有块中使用`BEGIN`和，并且2）为了减轻由于双缩进所有内容的麻烦而引起的斗争，您重新制定您的块缩进练习，如下所示：`END``IF`

*   代替`IF`和`ELSE`开始一个没有结束的块，并在更深的层次上`BEGIN`进行匹配；`END`

*   制作`IF`和`ELSE`开始以 , 结尾的块`END`，并放在`BEGIN`行尾。

这将是：

```
IF Month(@RunDate) = 1 BEGIN
   SET @Month = 12;
   SET @Year = Year(@RunDate) - 1;
END
ELSE BEGIN
   SET @Month = Month(@RunDate) - 1;
   SET @Year = Year(@RunDate);
END; 
```

我认识到这对于习惯于不同缩进风格的人来说看起来很奇怪——所有的改变一开始都很难。但我相信，只要稍加练习，它就会在你身上生长，变得不那么痛苦。只是训练眼睛去配合`END`其他东西而已`BEGIN`。最终，您意识到您甚至都不在乎寻找，因为它不会为以or`BEGIN`开头的行添加任何额外的含义。最后，您不必做疯狂的、劳动密集型的缩进模式（包括在后面放置多个空格并让所有内容对齐），因为缩进很有效，而且您只需为每个块做一个级别而不是许多。而且你永远不会有代码脱离`IF``ELSE``IF``ELSE``IF`如上所示意外阻塞。

100% 明确：使用这种样式，如果`BEGIN`/`END`块中只有一个语句，则无需重新排列任何内容以添加第二个语句，并且代码不会中断。

最后，请注意我在自己的示例中添加了分号，原因很简单，在 SQL Server 中它们有一天会被需要，我希望我的所有生产代码都可以继续工作，而不需要一个巨大而痛苦的分号项目！这也带来了明确指示您的块何时停止的好处（坦率地说，我不知道在`END`前面的立即数之后是否需要分号 - 如果是`ELSE`这样，我至少会有一个*小*分号项目而不是巨大的）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-03T19:23:10.600

试试这个（[SQL FIDDLE](http://sqlfiddle.com/#!6/d41d8/1836)）；

```
declare @startdate date, @enddate date, @runDate date
select @runDate = '20130216'

select @startdate = case datepart(day,@runDate) when 16 
                         then dateadd(day,-15, @runDate)
                         else dateadd(day,14, dateadd(month,-1,@runDate))
                    end,
       @enddate =  dateadd(day,-1,@runDate)

select @startdate, @enddate 
--Results for when @runDate = '20130216'
2013-02-01  2013-02-15

--Results for when @runDate = '20130201'
2013-01-15  2013-01-31 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-03T18:55:32.317

像这样的东西可能会起作用：

```
where
    Run_Date between
    (
        case
            when datepart(dd, getdate()) = 1 then dateadd(mm, -1, getdate())
            else dateadd(dd, -15, getdate())
        end
    )
    and
    (
        case
            when datepart(dd, getdate()) = 1 then dateadd(dd, -1, getdate())
            else dateadd(dd, -1, getdate())
        end
    ) 
```

您的数字可能会有所不同

# python - cron 作业不输出到 nohup.out

> ID：14145250
> 
> 赞同：15
> 
> 时间：2013-01-03T18:51:44.567
> 
> 标签：python, bash, ubuntu, cron, crontab

我有 通过 ubuntu 服务器上的**CRON JOB运行的****start.sh** bash 脚本

 ****start.sh**包含下面提到的代码行

**start.sh**的路径是`/home/ubuntu/folder1/folder2/start.sh`

```
#!/bin/bash

crawlers(){
    nohup scrapy crawl first &
    nohup scrapy crawl 2nd &
    wait $!
    nohup scrapy crawl 3rd &
    nohup scrapy crawl 4th &
    wait
}

cd /home/ubuntu/folder1/folder2/
PATH=$PATH:/usr/local/bin
export PATH

python init.py &
wait $!
crawlers
python final.py 
```

我的问题是，如果我自己在命令行上运行**start.sh ，它会在****nohup.out**文件中输出

但是当它通过**cronjob执行这个****bash 文件**时（虽然脚本运行良好）它不会产生**nohup.out**

 ****如何在**nohup.out**中获取此 cronjob 的**输出**？

 *** * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-01-03T20:20:29.213

你为什么用`nohup`？`nohup`是一个命令，告诉正在运行的终端忽略挂断信号。`cron`但是，没有挂断信号，因为它没有链接到终端会话。

在这种情况下，而不是：

```
nohup scrapy crawl first & 
```

你可能想要：

```
scrapy crawl first > first.txt & 
```

最后一个示例也适用于终端，但是当您关闭终端时，`hup`会发送挂断信号 ( )，从而结束程序。********

# php - jQuery/ajax 没有更新页面上的 div

> ID：14145258
> 
> 赞同：1
> 
> 时间：2013-01-03T18:52:32.493
> 
> 标签：php, javascript, jquery, ajax

我正在尝试使用 id=OCRID 更新 div，它是我页面上包含一些数据的 div。我首先使用了以下 URL 中的代码，但是我们切换到了 jQuery 方法。[<-丑陋的 ajax->](http://www.w3schools.com/PHP/php_ajax_database.asp)。切换到这个。使用警报，我看到成功返回的消息是正确的消息，但`document.getElementById(OCRID).innerHTML=msg`不会更改值。我有一些其他的 javascript 做一些类似的事情，但不是来自服务器的数据。请帮忙？

```
$.ajax({
   type: "GET",
   url: url,
   data: "q="+OCRID+"&newstatus="+document.getElementById(OCRID).value,
   success: function(msg, OCRID){
     document.getElementById(OCRID).innerHTML=msg;
   }
 }); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T19:22:54.113

首先你提到`OCRID`的是一个 id`div`并且你已经使用过

```
document.getElementById(OCRID).value // a div doesn't have a value attribute 
```

它返回`HTML`元素的值，但 a`div`不包含任何值属性，并且在您使用的成功回调中

```
success: function(msg, OCRID){
    document.getElementById(OCRID).innerHTML=msg; // innerHTML is right for a div
} 
```

来自[jQuery](http://api.jquery.com/jQuery.ajax/)文档：

> **成功（数据，文本状态，jqXHR）**
> 
> 请求成功时调用的函数。该函数获得三个参数： 从服务器返回的数据，根据 dataType 参数格式化；描述状态的字符串；和 jqXHR（在 jQuery 1.4.x 中，XMLHttpRequest）对象。从 jQuery 1.5 开始，success 设置可以接受一个函数数组。每个函数都会被依次调用。这是一个 Ajax 事件。

在这种情况下，您不应该将`OCRID`其用作第二个参数，因为`jQuery`在回调中使用了 3 个参数，`success`这些参数基本上是，在`data, textStatus, jqXHR`这种情况下`data`是您的`msg`，`OCRID`在这种情况下`textStatus`，它是响应的状态消息，第三个参数是`xhr`对象。所以应该是

```
$.ajax({
    type: "GET",
    url: url,
    data: "q="+OCRID+"&newstatus="+$('#'+OCRID).html(), // or text()
    success: function(msg){
        $('#'+OCRID).html(msg); // or text()
    }
}); 
```

还要记住，你`OCRID`看起来像一个变量，这应该在你的`ajax`调用范围内可用，如果这不是一个变量，那么它应该`$('#OCRID')`在下面给出的两个地方

```
$('#OCRID').html(); 
```

并在成功回调中

```
$('#OCRID').html(msg); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T18:55:23.507

替换这一行：

```
document.getElementById(OCRID).innerHTML=msg; 
```

和：

```
document.getElementById("OCRID").innerHTML=msg; // notice the quotes 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-03T18:57:00.727

为什么不使用 jQuery 版本的元素接口呢？对我来说，它看起来像是`OCRID`一个变量，对吧？

```
$.ajax({
   type: "GET",
   url: url,
   data: "q="+OCRID+"&newstatus=" + $('#' + OCRID).text(),
   success: function(msg, OCRID){
     $('#' + OCRID).html(msg);
   }
 }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-03T18:58:57.803

如果你的成功回调有`OCRID`一个参数（这是不正确的），它将被使用而不是你在数据参数中使用的那个，所以删除它。

```
$.ajax({
   type: "GET",
   url: url,
   data: "q="+OCRID+"&newstatus="+document.getElementById(OCRID).innerHTML,
   success: function(msg){
     document.getElementById(OCRID).innerHTML=msg;
   }
 }); 
```

# postgresql - 如何在 PostgreSQL 中使用 dblink 时包含模式 inf？

> ID：14145261
> 
> 赞同：1
> 
> 时间：2013-01-03T18:52:44.253
> 
> 标签：postgresql, database-schema

全部

我正在尝试在 PostgreSQL 中使用 dblink 在不同的数据库上运行查询。如果表“用户”在公共模式下，则以下工作：

```
select * from dblink(
'hostaddr=1.2.3.4 port=5434 dbname=dbname user=username password=password',
'select id from user')
       as t1(
       id bigint
); 
```

但是，我需要在其他一些定义的模式上运行查询。有谁知道如何在上述查询中添加架构信息？我无法从 PostgreSQL 文档中弄清楚。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T07:58:30.977

当您编写 SQL 查询时

```
SELECT id FROM user 
```

PostgreSQL 会将表名解析`user`为完全限定名，例如`schema.tablename`使用[模式搜索路径](http://www.postgresql.org/docs/9.2/static/ddl-schemas.html)，默认设置为`"$user",public`.

换句话说，除非您调整服务器配置，否则`user`将解析为。`public.user`

但是，您可以在语句中明确指定架构，如下所示：

```
SELECT id FROM otherschema.user 
```

# javascript - 检查单选按钮是否选中的简单方法

> ID：14145262
> 
> 赞同：-3
> 
> 时间：2013-01-03T18:52:46.710
> 
> 标签：javascript, radio-button

我知道有很多类似的问题如何检查单选按钮是否被选中。所以我知道如何用javascript检查这个。我的问题是：我不知道如何正确使用它。
这是我的问题：
每 5 个问题我得到 5 个类别。每个问题都有 4 个单选按钮，其中*不重要**不太重要**更重要*和*非常重要*。
用户必须为每个问题选择每一个。那么我如何检查，如果每个问题都得到了回答？我不知道让它变得容易
这是两个问题的代码：

```
<h2>Arbeit</h2>
<p class="title">Sie machen lieber &Uuml;berstunden als zuhause mit jemandem zu essen<span> 
</span>
</p>
<p class="input radio">
    <input type="radio" value="110" name="11" id="110" />
    <label for="110">Nicht Wichtig</label>
    <input type="radio" value="111" name="11" id="111"
    />
    <label for="111">Weniger Wichtig</label>
    <input type="radio" value="112" name="11" id="112"
    />
    <label for="112">Wichtig</label>
    <input type="radio" value="113" name="11" id="113" />
    <label for="113">Sehr Wichtig</label>
</p>
<p class="title">Wenn Sie sich ein Ziel gesetzt haben, erreichen Sie dieses auch<span> Egal was es &quot;kostet&quot;
</span>
</p>
<p class="input radio">
    <input type="radio" value="120" name="12" id="120" />
    <label for="120">Nicht Wichtig</label>
    <input type="radio" value="121" name="12" id="121"
    />
    <label for="121">Weniger Wichtig</label>
    <input type="radio" value="122" name="12" id="122"
    />
    <label for="122">Wichtig</label>
    <input type="radio" value="123" name="12" id="123" />
    <label for="123">Sehr Wichtig</label>
</p>
<p class="title">Sie bringen die Arbeit auch nach hause<span> Sie arbeiten auch von Zuhause aus</span>
</p>
<p class="input radio">
    <input type="radio" value="130" name="13" id="130" />
    <label for="130">Nicht Wichtig</label>
    <input type="radio" value="131" name="13" id="131"
    />
    <label for="131">Weniger Wichtig</label>
    <input type="radio" value="132" name="13" id="132"
    />
    <label for="132">Wichtig</label>
    <input type="radio" value="133" name="13" id="133" />
    <label for="133">Sehr Wichtig</label>
</p>
<p class="title">Sie helfen einem Kollegen, auch wenn Sie dann mit Ihrer Arbeit in R&uuml;ckstand
    geraten<span> 
</span>
</p>
<p class="input radio">
    <input type="radio" value="140" name="14" id="140" />
    <label for="140">Nicht Wichtig</label>
    <input type="radio" value="141" name="14" id="141"
    />
    <label for="141">Weniger Wichtig</label>
    <input type="radio" value="142" name="14" id="142"
    />
    <label for="142">Wichtig</label>
    <input type="radio" value="143" name="14" id="143" />
    <label for="143">Sehr Wichtig</label>
</p> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T19:10:09.423

由于它们是收音机，每组只能检查一个，请尝试以下操作：

```
var categories = document.querySelectorAll('p.radio'),
    checked = document.querySelectorAll('p.radio input:checked');

if ( checked.length == categories.length ) {
  // every question was answered
} else {
  // some question(s) were not answered
} 
```

# java - 使 Java Swing 接受 Windows 中的用户输入路径（从资源管理器复制粘贴路径）

> ID：14145265
> 
> 赞同：2
> 
> 时间：2013-01-03T18:52:51.180
> 
> 标签：java, windows, swing, path, user-input

你能帮我找到解决这个问题的方法吗？

我正在尝试使用 Swing 组件制作 Java GUI

该界面应该接受某个文件的Windows路径并在按下提交按钮后触发文件上的一组功能

现在我已经创建了组件来获取用户输入：

```
JTextField introducedPath1 = new JTextField(50); 
```

我试图更改通过将路径从资源管理器复制粘贴到接受的文件路径中获得的默认 Windows 路径：

```
File file;
String makeCanonicalPath=introducedPath1.getText().toString();
            makeCanonicalPath=makeCanonicalPath.replaceAll("\\", "/");
            file = new File(makeCanonicalPath); 
```

但我不断收到此错误：

```
Exception in thread "AWT-EventQueue-0" java.util.regex.PatternSyntaxException: Unexpected internal error near index 1

\
 ^
at java.util.regex.Pattern.error(Unknown Source)
at java.util.regex.Pattern.compile(Unknown Source)
at java.util.regex.Pattern.<init>(Unknown Source) 
```

我认为这是由 Windows 中的默认路径（例如：L:\practice\test）将其 '\' 解释为转义序列引起的。

任何帮助或建议将不胜感激

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T18:54:35.393

使用replaceAll，需要对正则表达式使用java转义，所以

```
makeCanonicalPath.replaceAll("\\\\", "/"); 
```

因为它不是文本搜索替换，而是正则表达式。

例如，如果您想要基于文本的搜索替换，请使用[apache commons](http://commons.apache.org/) [string replace](http://commons.apache.org/lang/api-2.5/org/apache/commons/lang/StringUtils.html)。

此外，一种替代方法是使用 replace() - [http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/String.html#replace(char](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/String.html#replace(char) , char) 而不是 replaceAll - 它将在不使用正则表达式的情况下替换所有出现的事件，并且由于您只有一个要替换的字符，所以它可以工作。

# youtube - 如何在最后一帧暂停嵌入的 youtube 视频？

> ID：14145272
> 
> 赞同：5
> 
> 时间：2013-01-03T18:53:29.533
> 
> 标签：youtube, youtube-api, youtube-javascript-api

播放嵌入的 youtube 视频时，我不想在完成后显示分辨率不佳的缩略图。相反，我想要最后一帧的高分辨率图像。这可能吗？

我可以在最后一帧暂停，还是有办法创建最后一帧的高分辨率缩略图？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T21:43:36.590

您可以使用 YouTube Player API 来检测播放何时结束，然后执行一些 DOM 操作以换出播放器并换入`img`指向视频缩略图之一的标签。但是，视频中的最后一帧通常不会有缩略图，因此您必须选择不同的缩略图。

如果您只想禁用视频结束时显示的相关视频，您可以使用[rel=0](https://developers.google.com/youtube/player_parameters#rel)播放器参数，但这会留下黑屏。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-23T01:26:59.450

我遇到了同样的问题，在花了很多时间玩它之后，对我来说最好的解决方案是在结束前暂停视频几分之一秒，从而将其保持在该帧上。像这样的东西：

```
var player;

      function onYouTubePlayerAPIReady() {
        player = new YT.Player('player', {
          playerVars: { 'autoplay': 1, 'controls': 0,'loop': 1, 'showinfo': 0, 'disablekb': 1, 'version': 3, 'vq': 'large', 'wmode':'opaque','rel': 0 },
          videoId: 'YOURVIDEOID',
          events: {
            'onReady': onPlayerReady,
            'onStateChange': onStateChange,
            'onytplayerStateChange': onStateChange }

        });

      }

    var done = false;
    function onStateChange(event){
        var videoDuration = player.getDuration();
        if (event.data == YT.PlayerState.PLAYING && !done) {
            // pause 0.1 seconds before the end
            setTimeout(pauseVideo, (videoDuration-0.1)*1000);
            done = true;
        }
    }

    function pauseVideo() {
        player.pauseVideo();
    } 
```

视频开始后（我们使用 onStateChange 捕获），我们可以从 YouTube Player API 获取视频时长（使用 player.getDuration），然后使用 setInterval 对暂停视频 0.1 秒（或我们选择的任何值）的函数计时) 在结束之前。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-30T04:49:20.997

**视频播放器在调用状态为YT.PlayerState.ENDED**的回调之前，会给出一个状态**为 YT.PlayerState.PAUSED**的回调“onStateChange” ，您可以在此处尝试。

 **我也在做同样的事情。我只是显示一个覆盖以使用重播按钮覆盖视频，但它仍然出现在视频的末尾，然后出现覆盖（观察到一些故障）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-12-30T01:07:20.743

在遇到这个问题后，我最终得到了这个，到目前为止，这对我来说一直很一致：

```
var player;
var curTimer;
function onYouTubeIframeAPIReady() {
    player = new YT.Player('player', {
                    videoId: 'The Video ID',
                    playerVars: { 'rel':0, 'enablejsapi':1, 'autohide':1, 'wmode':'opaque'}
                });
    player.addEventListener('onReady', 'onPlayerReady');
    player.addEventListener('onStateChange', 'onPlayerStateChange');
}
function onPlayerStateChange(event) {
    var videoDuration = event.target.getDuration();
    var curTime = event.target.getCurrentTime();
    if ( curTime ) {
        /**  Video Already Started  */

        /**  Get video time remaining. */
        videoDuration = videoDuration-curTime;

        /**  Remove old 'setTimeout' function */
        removeTimeout(curTimer);
    }
    /**
        Note: The '.25' is time subtracted to stop video on last frame.
        Adjust this as needed.
    */
    /**  Add/Re-Add 'setTimeout' function with video time remaining. */
    curTimer = setTimeout(pauseVideo, (videoDuration-.25)*1000);
}
function removeTimeout(elTimer){
    /** Remove old timer */
    clearTimeout(elTimer);
}
function stopVideo() {
    player.stopVideo();
} 
```

解释和/或注释在评论中。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-12-02T20:01:25.183

```
var thumb = true;
function onStateChange(event) {

    if (thumb && event.data == YT.PlayerState.PLAYING) {
      thumb = false;
      player.pauseVideo();
      return;      
    }

    if (event.data != YT.PlayerState.ENDED) {
        return;
    }

    player.setPlaybackQuality('highres');
    player.seekTo(player.getDuration() - 1, true);
    player.playVideo();
    thumb = true; 

} 
```**

# bash - 在第一个命令中忽略 $

> ID：14145273
> 
> 赞同：5
> 
> 时间：2013-01-03T18:53:38.853
> 
> 标签：bash, terminal

如何编写 Bash`$`在第一个命令中忽略的函数？我想要这个，因为有时当我从 web 粘贴命令时，它包含一个`$`in 第一个字符。

`$ ls`应该做`ls`或`$ grep 'foo'`应该做`grep 'foo'`。

这将不起作用，因为`$`它不是有效的函数名。

```
function $ {
   ...
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-03T19:01:33.563

`$`在您的某处创建一个名为的文件`$PATH`，例如`~/bin`：

```
cd ~/bin
cat <<'EOF' > \$
#!/bin/sh
"$@"
EOF 
```

使其可执行：

```
chmod 755 \$ 
```

并享受疯狂：

```
$ ls -l
total 92
-rwxr-xr-x 1 thomas thomas    13 Jan  3 19:09 $
$ $ $ $ $ $ $ $ $ $ $ $ $ $ $ $ $ $ $ $ $ $ $ $ $ $ $ $ ls
total 92
-rwxr-xr-x 1 thomas thomas    13 Jan  3 19:09 $ 
```

# objective-c - UITableViewAccessoryType 随机不显示

> ID：14145274
> 
> 赞同：1
> 
> 时间：2013-01-03T18:53:39.307
> 
> 标签：objective-c, ios, xcode, uitableview

对于 TableView 中的每个单元格，我基本上都有一个布尔变量，用于存储是否正在为该单元格加载数据。因此，点击一个单元格会导致附件类型更改为 UIActivityIndi​​cator。TableView 加载正常，但是当我弹回 TableView 时，随机的一两个单元格没有默认的 DisclosureIndicator ......它什么也没有

我正在使用的代码在里面`cellForRowAtIndexPath`

```
 NSLog([entry isLoading] ? @"Yes" : @"No");
if ([entry isLoading]) {
    UIActivityIndicatorView *activityView =
    [[UIActivityIndicatorView alloc] initWithActivityIndicatorStyle:UIActivityIndicatorViewStyleGray];
    [activityView startAnimating];
    [cell setAccessoryView:activityView];
}
else{
    [cell setAccessoryType:UITableViewCellAccessoryDisclosureIndicator];
} 
```

我已经逐步完成了代码，并且未显示 DisclosureIndicator 的单元格仍在运行将其设置为 AccessoryDisclosureIndicator 的代码...我不确定发生了什么，因为缺少指示符的单元格正在触发 else 语句导致这`setAccessoryType`

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T19:04:00.350

尝试这个，

```
if ([entry isLoading]) {
    UIActivityIndicatorView *activityView =
    [[UIActivityIndicatorView alloc] initWithActivityIndicatorStyle:UIActivityIndicatorViewStyleGray];
    [activityView startAnimating];
    [cell setAccessoryView:activityView];
    [cell setAccessoryType:UITableViewCellAccessoryNone];
}
else{
    [cell setAccessoryView:nil];
    [cell setAccessoryType:UITableViewCellAccessoryDisclosureIndicator];
} 
```

根据[文档](http://developer.apple.com/library/ios/#documentation/uikit/reference/UITableViewCell_Class/Reference/Reference.html)，

> **accessoryView**
> 如果此属性的值不为 nil，则 UITableViewCell 类将给定视图用于 table view 的正常（默认）状态下的辅助视图；它忽略了附件类型属性的值。提供的附件视图可以是框架提供的控件或标签或自定义视图。附件视图出现在单元格的右侧。

所以你需要设置`accessoryView`为 nil show the`accessoryType`否则它会忽略它。

# performance - 许多具有相同几何形状和材料的网格，我可以更改它们的颜色吗？

> ID：14145275
> 
> 赞同：21
> 
> 时间：2013-01-03T18:53:41.697
> 
> 标签：performance, colors, three.js, share

我有大量（~1000）个`THREE.Mesh`对象，它们是由相同的`THREE.Geometry`和`THREE.MeshPhongMaterial`（有一张地图）构成的。

我想单独为这些对象着色（着色）。

天真地，我尝试更改`mesh.material.color`属性，但是更改任何对象的此属性会立即更改所有对象的颜色。这是有道理的，因为只有一种材质在所有对象之间共享。

我的下一个想法是为每个对象创建一个单独`THREE.MeshPhongMaterial`的对象。所以，现在我有大量`THREE.Mesh`由相同构造的对象`THREE.Geometry`，但有个体`THREE.MeshPhongMaterials`（共享相同纹理）。这允许我单独更改颜色，但性能更差。chrome 分析器显示该应用程序正在花费大量时间来处理材质方面的事情，例如切换纹理。

材质颜色只是着色器中的统一。所以，更新制服应该很快。

**问题：**有没有办法从网格级别覆盖材质颜色？

如果有的话，我相信我可以在所有对象之间共享材料并恢复我的表现，同时仍然单独更改颜色。

[我在v49和v54上测试过，它们的性能和降级是一样的]

**更新：**我已经建立了一个测试用例，因此导致的性能下降比我想象的要小，但仍然可以测量。

这里有两个链接：

*   [http://danceliquid.com/docs/threejs/material-test/index.html?many-materials=false](http://danceliquid.com/docs/threejs/material-test/index.html?many-materials=false)
*   [http://danceliquid.com/docs/threejs/material-test/index.html?many-materials=true](http://danceliquid.com/docs/threejs/material-test/index.html?many-materials=true)

在第一种情况下，只有两种材料，在第二种情况下，每个立方体都有自己的材料。我在这台机器上测得第一种情况的帧率是53fps，第二种情况的帧率是46fps。这大约下降了 15%。

在这两种情况下，每个立方体的材质颜色每帧都会改变。在有许多材料的情况下，我们实际上看到每个立方体都有自己的颜色，在只有两种材料的情况下，我们看到它们都具有相同的颜色（如预期的那样）。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-04-14T11:22:32.040

是的。对于每个对象，使用 克隆您的材质`material.clone()`，修改其`emissive`和`color`，并将对象的材质设置为此克隆。着色器和属性是通过引用复制的，所以不用担心每次都克隆整个材质；实际上，唯一按值复制的东西是制服（例如`emissive`和`color`）。因此，您可以更改每个单独的对象。

我个人将原始材料存储在对象的单独自定义属性中，以便以后可以轻松切换回它；取决于你的需求是什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-04T06:20:16.680

如果您正在编写自己的着色器，则可以将`uniform`变量用于一般色调（不是特定于顶点）并将其传递给着色器以考虑整体颜色。 `vec4f_t`并且`vec4f()`在 C 部分中不是标准的，但您的代码可能已经有等价物。

C：

```
vec4f_t hue = vec4f(....);  // fill in as desired
// load the shader so that GLuint shader_id is available.
// "hue" is a uniform var in the vertexshader
GLUint hue_id = glGetUniformLocation(shader_id, "hue"); 
// later, before rendering the object:
glUniform4fv(hue_id, 1, &hue); 
```

.vertexshader：

```
uniform vec4 hue;  // add this and use it in the texture's color computation 
```

# android - Android 计时器只触发一次

> ID：14145276
> 
> 赞同：3
> 
> 时间：2013-01-03T18:53:42.087
> 
> 标签：android, timer

我有这段代码，我想尝试每小时发送一封电子邮件报告（在示例中为每秒）。如果没有覆盖，请在一小时内重试等。不知何故，我设法打破了 sendUnsendedReports() 中的计时器：它只触发一次。如果我删除对 sendUnsendedReports() 的调用，则计时器工作正常。即使周围有 try-catch 块，计时器也只会触发一次。请指教。

```
private void createAndScheduleSendReport() {
        delayedSendTimer = new Timer();
        delayedSendTimer.schedule(new TimerTask() {
            @Override
            public void run() {
                Log.w("UrenRegistratie", "Try to send e-mail...");
                try{
                  sendUnsendedReports();
                }
                catch(Exception e){
                    // added try catch block to be sure of uninterupted execution
                }
                Log.w("UrenRegistratie", "Mail scheduler goes to sleep.");
            }
        }, 0, 1000);
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-03T19:03:16.110

似乎有时计时器不能正常工作。替代方法是使用 of `Handler`instead `TimerTask`。

你可以像这样使用它：

```
private Handler handler = new Handler();
handler.postDelayed(runnable, 1000);

private Runnable runnable = new Runnable() {
   @Override
   public void run() {
      try{
              sendUnsendedReports();
            }
            catch(Exception e){
                // added try catch block to be sure of uninterupted execution
            }
      /* and here comes the "trick" */
      handler.postDelayed(this, 1000);
   }
}; 
```

查看[此链接](http://www.mopri.de/2010/timertask-bad-do-it-the-android-way-use-a-handler/)以获取更多详细信息。:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-03-08T11:31:43.410

`schedule()`可以通过多种方式调用，具体取决于您希望任务执行一次还是定期执行。

只执行一次任务：

```
timer.schedule(new TimerTask() {
    @Override
    public void run() {
    }
}, 3000); 
```

3 秒后每秒执行一次任务。

```
timer.schedule(new TimerTask() {
    @Override
    public void run() {
    }
}, 3000, 1000); 
```

更多示例用法可以在方法标头中找到

```
public void schedule(TimerTask task, Date when) {
    // ...
}

public void schedule(TimerTask task, long delay) {
    // ...
}

public void schedule(TimerTask task, long delay, long period) {
    // ...
}

public void schedule(TimerTask task, Date when, long period) {
    // ...
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-04-20T09:35:29.667

很明显，您遇到了异常并退出了 Timer run 方法，从而中断了计时器重新启动。

# asp.net - 评级控制 Ajax 无法在 asp.net 中显示

> ID：14145277
> 
> 赞同：0
> 
> 时间：2013-01-03T18:53:43.010
> 
> 标签：asp.net, ajax, rating

我正在使用 ASP.NET AJAX 控件工具包中存在的评级控件。我有以下问题。

1.  如果我将控件拖到页面上，它不会显示任何内容
2.  CSS也无济于事
3.  如何将评分值保存在数据库中

非常感谢。

CSS

```
.ratingStar
{
            font-size: 0pt;
            width: 12px;
            height: 12px;
            cursor:pointer;
            background-repeat: no-repeat;
 }

.filledRatingStar
{
  background-image: url(images/Star_filled.gif);
}

.emptyRatingStar
{
  background-image: url(images/Star_empty.gif);
} 
```

ASPX：

```
<asp:Rating ID="Rating2" runat="server" CurrentRating="1" MaxRating="6"   StarCssClass="ratingStar"
                    WaitingStarCssClass="savedRatingStar"
                    FilledStarCssClass="filledRatingStar"
                    EmptyStarCssClass="emptyRatingStar"
                                RatingAlign="Vertical">
                            </asp:Rating> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T20:30:04.453

## 评分未显示：

1.  您缺少*savedRatingStar的样式*
2.  更重要的是，因为你已经设置了`RatingAling="Vertical"`你**必须**`display:block;`为*ratingStar*指定

 *如下更改您的代码，它将起作用：

**CSS：**

```
<style type="text/css">
    .ratingStar
    {
        font-size: 0pt;
        width: 12px;
        height: 12px;
        cursor: pointer;
        background-repeat: no-repeat;
        display: block;
    }

    .filledRatingStar
    {
        background-image: url(images/Star_filled.gif);
    }

    .emptyRatingStar
    {
        background-image: url(images/Star_empty.gif);
    }

    .savedRatingStar
    {
        /*change this to your image name*/
        background-image: url(images/Saved_star.gif);
    }
</style> 
```

**ASPX：**

```
<form id="form1" runat="server">
<asp:ToolkitScriptManager ID="ToolkitScriptManager1" runat="server">
</asp:ToolkitScriptManager>
<asp:Rating ID="Rating2" runat="server" CurrentRating="1" MaxRating="6" StarCssClass="ratingStar"
    WaitingStarCssClass="savedRatingStar" FilledStarCssClass="filledRatingStar" EmptyStarCssClass="emptyRatingStar"
    RatingAlign="Vertical" />
<asp:Button ID="btnSubmit" runat="server" Text="Submit" OnClick="SubmitRating" />
</form> 
```

## 将评分保存到数据库：

评级可通过`CurrentRating`Rating 控件的属性获得，只需在代码中访问它并将其插入数据库（网上有数百个示例如何做到这一点，我相信您将能够从这里）

```
protected void SubmitRating(object sender, EventArgs e)
    {
        int rating = Rating2.CurrentRating;
        //Submit to database...
    } 
```*

# c++ - 使用模板创建 LinkedList -- 错误

> ID：14145278
> 
> 赞同：0
> 
> 时间：2013-01-03T18:53:43.287
> 
> 标签：c++, templates, linked-list

我一直在尝试制作一个通用链表类来使用模板练习我的 C++。但是，在编译时我收到错误，我对如何解决它们一无所知。我花了 2 多小时试图调试一个错误，但完全无处可去。我还咨询了 MSDN 和 google，也没有得到任何结果。恐怕我在模板方面相当缺乏经验。我在下面列出了相关代码。如果有人可以帮助我，我将不胜感激。

链表.h：

```
 #ifndef LINKED_LIST
    #define LINKED_LIST

    namespace D_DATA_STRUCT {
        template <typename T>
        class LinkedList {
        private:    
            class LinkedListNode {
            public:

                T data;
                LinkedListNode* next;
                LinkedListNode(T data) {
                    this->data = data;
                    this->next = 0;
                }
            };

            LinkedListNode* head;
            LinkedListNode* tail;

        public:

            LinkedList();
            ~LinkedList();

            void insert_at_head(T data);
            void insert_at_tail(T data);
            void insert(T data);

            T remove_from_head();
            T remove();
        };
     }

    #include "LinkedListImplementation.h"
    #endif 
```

LinkedListImplementation.h：

```
 namespace D_DATA_STRUCT {

        template <typename T>
        LinkedList<typename T>::LinkedList() {
            this->head = 0;
            this->tail = 0;
        }

        template<typename T>
        LinkedList<typename T>::~LinkedList() {
             LinkedListNode* prev, next;
             for(prev = this->head; prev != 0; prev = prev->next) {
                next = prev->next;
                delete prev;
                prev = next;
             }
        }

        template<typename T>
        void LinkedList<typename T>::insert_at_head(T data) {
             LinkedListNode* temp = this->head;
             this->head = new LinkedListNode(data);
             this->head->next = temp;
             if(temp == 0) {
                 this->tail = this->head;
             }
             return;
        }

        template<typename T>
        void LinkedList<typename T>::insert_at_tail(T data) {
             LinkedListNode* temp = new LinkedListNode(data);
             if(this->head == 0) {
                 this->head = temp;
             } else {
                 this->tail->next = temp;
             }
             this->tail = temp;
             return;
        }

        template<typename T>
        void LinkedList<typename T>::insert(T data) {
            this->insert_at_head(data);
            return;
        }

        template<typename T>
        T LinkedList<typename T>::remove_from_head() {
            if(this->head == 0) {
                return 0;
            }

            LinkedListNode* temp = this->head;
            T data = temp->data;

            this->head = this->head->next;
            delete temp;

            if(this->head == 0) {
                this->tail = 0;
            }

            return data;
         }

         template<typename T>
         T LinkedList<typename T>::remove() {
             return this->remove_from_head();
         }
    } 
```

我得到的错误是：

> linkedlistimplementation.h(4)：错误 C2143：语法错误：缺少“；” 在“<”linkedlistimplementation.h(4) 之前：错误 C4430：缺少类型说明符 - 假定为 int。注意：C++ 不支持默认整数linkedlistimplementation.h(4)：错误C2988：无法识别的模板声明/定义linkedlistimplementation.h(4)：错误C2059：语法错误：'<'linkedlistimplementation.h(4)：错误C2039： “LinkedList”：不是“全局命名空间”的成员linkedlistimplementation.h(10)：错误C2588：“::~LinkedList”：非法全局析构函数linkedlistimplementation.h(10)：致命错误C1903：无法从中恢复以前的错误；停止编译

即使“;”存在语法错误 当我错误地制作linkedlistimplementationlinkedlist.cpp时，程序编译但链接失败。因此，我认为我的模板语法存在一些问题。我浏览了很多文档并尝试了很多东西，但坦率地说，我迷路了，不知道发生了什么。我尝试在 LinkedList:: 中使用 typename 进行编译，但没有它。

我还在使用 Microsoft Visual C++ 2010 Express 编译器。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T19:08:19.010

another problem is in this line

```
LinkedListNode* prev, next; 
```

only *prev* is a pointer to LinkedListNode. *next* will be an object and will try to call the default constructor of LinkedListNode which does not exist.

If you want both of them to be pointers it should be changed to

```
LinkedListNode *prev, *next; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-03T19:01:58.590

应该：

```
template <typename T>
LinkedList<T>::LinkedList() 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-03T19:06:40.260

我不知道是否还有其他错误，但立即让我印象深刻的是，在您的函数定义中，您不需要两次“typename”，您只需在以“template.name”开头的行中使用它。 "

例如：
您的构造函数已定义

```
template <typename T>
    LinkedList<typename T>::LinkedList() {
        this->head = 0;
        this->tail = 0;
    } 
```

什么时候应该

```
template <typename T>
    LinkedList<T>::LinkedList() {
        this->head = 0;
        this->tail = 0;
    } 
```

在所有函数定义中进行更改，您应该没问题。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-03T19:02:27.470

您的实现声明错误，类名不应包含该`typname`部分。将实现中的构造函数更改为

```
template<typename T>
LinkedList<T>::LinkedList() {
    // ...
} 
```

对其他方法也这样做。

# jquery - 如何添加指向 jQuery Cycle pagerEvent 的链接？

> ID：14145282
> 
> 赞同：0
> 
> 时间：2013-01-03T18:54:03.587
> 
> 标签：jquery, jquery-cycle

我在此页面上使用 jQuery Cycle 进行幻灯片放映：http: [//energync.ehclients.com/](http://energync.ehclients.com/)并将其设置为当您将鼠标悬停在其下方的寻呼机事件上时图像会发生变化。由于这些链接是由 jQuery 动态创建的，我如何添加指向站点上其他页面的链接？

这是html：

```
<div id="slideshow">
<img src="http://energync.ehclients.com/images/uploads/slideshow-1.jpg" alt="Making Energy Work" width="645" height="333">
<img src="http://energync.ehclients.com/images/uploads/slideshow-2.jpg" alt="We Collaborate" width="645" height="333">
<img src="http://energync.ehclients.com/images/uploads/slideshow-3.jpg" alt="We Analyze" width="645" height="333">
<img src="http://energync.ehclients.com/images/uploads/slideshow-4.jpg" alt="We Advocate" width="645" height="333">
<img src="http://energync.ehclients.com/images/uploads/slideshow-5.jpg" alt="We Educate" width="645" height="333">
</div> 
```

这是jQuery：

```
$('#slideshow').cycle({
    fx: 'fade',
    pager : '#slideshow-nav',
    pagerEvent: 'mouseover',
    speed: 2000,
    delay:  3000,
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T19:11:44.700

From [jQuery Cycle manual](http://jquery.malsup.com/cycle/options.html):

```
pagerAnchorBuilder: null, // callback fn for building anchor links:  function(index, DOMelement) 
```

First you need to define pagerAnchorBuilder. Tthat will tell the script which elements it should use for links - so they are not autogenerated anymore. You also need to add allowPagerClickBubble so that the default action (page url) is triggered on click:

```
$('#slideshow').cycle({
    fx:     'fade',
    speed:  2000,
    delay: 3000,
    pager : '#slideshow-nav',
    pagerEvent: 'mouseover',
    pagerAnchorBuilder: function(idx, slide) {
        // return sel string for existing anchor
        return '#slideshow-nav ul li:eq(' + (idx) + ') a';
    },
    allowPagerClickBubble: true
}); 
```

Now, in your HTML code do this:

```
 <div id="slideshow-nav">
             <ul>
            <li class="collaborate"><a href="">We Collaborate</a></li>
            <li class="analyze"><a href="">We Analyze</a></li>
            <li class="advocate"><a href="">We Advocate</a></li>
            <li class="educate"><a href="http://energync.ehclients.com/we-educate/">We Educate</a></li>
             </ul>
    </div> 
```

Add URLs to the rest of anchors in that block and it will work.

Working demo (click the last link): [JSfiddle](http://jsfiddle.net/K2vZk/)

# jquery - JQuery-Validation - 在选定的 ID 上使用规则方法，为什么 name 属性必须出现在元素上？

> ID：14145283
> 
> 赞同：2
> 
> 时间：2013-01-03T18:54:06.057
> 
> 标签：jquery, jquery-validate, name-attribute

我对[JQuery 验证插件](http://docs.jquery.com/Plugins/Validation)的行为有点困惑。

如果我有以下 JQuery：

```
$('#form1').validate({
    /* other validation */
});

$('#txt1').rules("add",
{
    required: true,
    messages: { required: 'This is required!' }
}); 
```

以及以下文本输入，带有 id 但没有 name 属性：

```
<input type="text" id="txt1"/> 
```

文本框中不会弹出任何必需的消息。

但是，如果我添加一个名称属性：

```
<input type="text" id="txt1" name="anything"/> 
```

它验证它就好了。

这是为什么？由于我在 ID 选择器上使用了[rules("add", rules) 方法](http://docs.jquery.com/Plugins/Validation/rules#.22add.22rules)，为什么它需要 name 属性才能将规则与元素关联？感谢您的任何见解！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-03T18:55:29.967

元素上需要一个`name`属性，首先是因为 jQuery validate 在内部使用它作为每个字段的键，其次是因为元素`name`上需要该属性`input`以确保页面验证为指定的 DOCTYPE。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-05-02T09:16:42.670

如果您想使用 id 应用规则，然后像这样使用，

```
$(function () {
  var $field = $("#id_field").attr("name");
  var $params = {debug:false, rules:{}, messages:{}};
  $params['rules'][$field] = {"required": true, "rule": ["params"]};
  $params['messages'][$field] = "error message";

  $("#frm").validate($params);
}); 
```

# google-provisioning-api - 如何使用 de OAuth2 访问令牌和 de google api Zend 库来配置 api

> ID：14145287
> 
> 赞同：0
> 
> 时间：2013-01-03T18:54:26.810
> 
> 标签：google-provisioning-api

我正在开发一个 Web 应用程序，我有访问令牌和刷新令牌，我得到了我的 POST 请求，我不明白，也没有在 Google Provisioning API 文档中看到如何将 Zend 库与这些令牌一起使用，方法Zend 库问我用户和密码，而不是令牌，有没有办法在 Zend 库中使用令牌，或者只对提供 api 的 URL 的请求？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T19:43:15.587

[在http://code.google.com/p/gdata-samples/source/browse/trunk/hybrid/index.php](http://code.google.com/p/gdata-samples/source/browse/trunk/hybrid/index.php)中提供了 Zend 库中执行 3LO 的完整示例。通常，一旦您拥有授权访问令牌，您只需将其作为请求中的标头发送：

```
Authorization: OAuth TOKEN_GOES_HERE 
```

刷新令牌仅用于在当前令牌过期时获取新的访问令牌，并且不会在实际请求中使用。

# android - Android从存储在设备上的文件获取HTTP响应

> ID：14145297
> 
> 赞同：0
> 
> 时间：2013-01-03T18:54:57.983
> 
> 标签：android, file, http, response, httpurlconnection

有没有办法使用为 Web 通信设计的类（例如 HttpURLConnection）从设备内存中的文件中读取 http 响应？我需要这个来轻松过渡到与 Web 服务器的真正连接，因为我现在没有（甚至是本地的）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T19:09:16.423

> 有没有办法使用为 Web 通信设计的类（例如 HttpURLConnection）从设备内存中的文件中读取 http 响应？

只需编写您自己的Web 服务器。

> 我需要这个来轻松过渡到与 Web 服务器的真正连接，因为我现在没有（甚至是本地的）。

目前几乎所有使用的操作系统都有免费的 Web 服务器，包括 Android 本身。

话虽如此，围绕您的数据访问创建一个包装层，因此只有一个类需要了解数据检索的确切细节。现在，使用该类的普通文件访问。

# java - JavaDoc：如果@param 注释不适合一行

> ID：14145300
> 
> 赞同：0
> 
> 时间：2013-01-03T18:55:04.537
> 
> 标签：java, documentation, javadoc

如果@param 注释不适合一行，JavaDoc 是否会将换行符中的单词识别为有关方法参数的信息？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-03T18:57:16.923

您可以在新行上继续描述。例如：

```
/*
 * . . .
 * @param p
 *            text describing the parameter can overflow the
 *            line. It doesn't even have to start on the line.
 *            Indenting is not necessary, but it's nice for
 *            readability. The asterisk at the start of each
 *            line does not appear in the docs. The description
 *            ends at the start of the next "@..." tag or the
 *            end of the comment block.
 */ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T19:00:44.427

[您可以为从 Oracle 的“如何编写 javadoc”](http://www.oracle.com/technetwork/java/javase/documentation/index-137868.html)`@param`中获取和修改的示例做多于一行的信息：

```
/**
 * Registers the text to display in a tool tip.   The text 
 * displays when the cursor lingers over the component.
 *
 * @param text  the string to display.  If the text is null, 
 *              the tool tip is turned off for this component. 
```

您还可以做多个`@param`输入：

```
/**
 * ...
 * @param  url  an absolute URL giving the base location of the image
 * @param  name the location of the image, relative to the url argument
 * @return      the image at the specified URL
 * @see         Image
 */
 public Image getImage(URL url, String name) { 
```

# ruby-on-rails - 使用 html 属性包装 link_to 的助手

> ID：14145303
> 
> 赞同：1
> 
> 时间：2013-01-03T18:55:16.853
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我想要一个像 link_to 一样工作的助手，只是它合并到一个数据属性中（在这种情况下，为了便于使用引导程序创建选项卡：http: [//twitter.github.com/bootstrap/javascript.html#tabs](http://twitter.github.com/bootstrap/javascript.html#tabs) )

所以我可以这样称呼它：

```
link_to_tab("Name", @obj) 
```

并得到

```
<a href='/path' data-toggle='tab'>Name</a> 
```

我想出了这个似乎可行的方法：

```
def link_to_tab(*args, &block)
  toggle_hash = {'data-toggle' => 'tab'}
  last_arg = args.pop # if link_to was given a hash of html_options, merge with it
  if last_arg.is_a? Hash
    link_to(*args, last_arg.merge(toggle_hash), &block)
  else
    link_to(*args, last_arg, toggle_hash, &block)
  end
end 
```

是否有一种更简洁、更惯用的方式来支持所有调用 link_to 的方式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T19:39:21.610

并不真地。你可以试试这个...

```
def link_to_tab(*args, &block)
  toggle_hash = {'data-toggle' => 'tab'}
  if args.last.is_a? Hash
    args.last.merge!(toggle_hash) 
  else
    args << toggle_hash
  end
  link_to(*args, &block)
end 
```

虽然没有那么不同...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T00:00:17.690

> I'd like to have a helper that works just like link_to except that it merges in a data attribute

I might be missing something, but why not just pass a custom data argument to the link_to helper?

```
= link_to "foo tab", {}, "data-toggle" => "tab" 
```

Outputs:

```
<a data-toggle="tab" href="/">foo tab</a> 
```

**Edit**

If you're planning on using it a lot you can do:

```
def link_to_tab(*args, &block)
  if args.last.is_a? Hash
    link_to *(args.take args.size - 1), args.last.merge("data-tab" => "tab"), &block
  else
    link_to *args, "data-tab" => "tab", &block
  end
end 
```

# python - Python - 在文件中制作自定义文本列表的更快方法

> ID：14145319
> 
> 赞同：0
> 
> 时间：2013-01-03T18:55:57.097
> 
> 标签：python, performance, list, time

我正在尝试在文本文件中创建一个文本列表，就像正在键入它一样。有点像这样：

```
T
Te
Tex
Text 
```

我不知道如何解释它，所以这里有一个例子：

文本文件内容：

```
Line 1
Line 2
Line 3 
```

**第一**行的列表将类似于：`['L', 'Li', 'Lin', 'Line', 'Line ', 'Line 1', 'Line 1\n']`.

**完整**的列表将是：`[['L', 'Li', 'Lin', 'Line', 'Line ', 'Line 1', 'Line 1\n'], ['L', 'Li', 'Lin', 'Line', 'Line ', 'Line 2', 'Line 2\n'], ['L', 'Li', 'Lin', 'Line', 'Line ', 'Line 3']]`

这是我当前的代码：

```
lines=open('foo.txt', 'r').readlines()
letters=[]
cnt=0
for line in lines:
    letters.append([])
    for letter in line:
        if len(letters[cnt]) > 0:
            letters[cnt].append(letters[cnt][len(letters[cnt])-1]+letter)
        else:
            letters[cnt].append(letter)
    cnt+=1

print letters 
```

输出与上面的**完整**列表完全相同。

问题是这个代码在更大的文件上有点慢。有没有更快的方法来实现相同的输出？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T18:59:38.380

```
result = []
for line in open('foo.txt'):
    result.append([line[:i+1] for i in xrange(len(line))])
print result 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-03T18:59:06.570

使用`list comprehension`：

```
In [66]: with open("data.txt") as f:
    print [[line[0:i+1] for i in range(len(line))] for line in f]
   ....:     
[['L', 'Li', 'Lin', 'Line', 'Line ', 'Line 1', 'Line 1\n'], 
 ['L', 'Li', 'Lin', 'Line', 'Line ', 'Line 2', 'Line 2\n'],
 ['L', 'Li', 'Lin', 'Line', 'Line ', 'Line 3', 'Line 3\n']] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-03T19:21:36.723

这对于 Python 的 memoryviews 来说似乎是一个特别好的案例：使用它们时，您不会创建原始字符串的子字符串，而只会创建原始字符串的*视图*。行长于几个字符的大文件的性能提升应该是可观的。

```
results = []
with open("data.txt") as f:
    for line in f:
        letters = tuple(buffer(line, 0, i+1) for i in xrange(len(line)))
        results.append(letters) 
```

如果不需要同时扩展所有前缀列表，可以考虑使用生成器。

注意：如果没有打印的计时，以下应该很难被击败;-)

```
with open("data.txt") as f:
    results = (buffer(line, 0, i+1) for line in f for i in xrange(len(line))) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-03T19:30:51.087

这变慢的原因是因为您收集的只有冗余信息的大量列表。您是否真的需要这些列表，或者类似的东西也可以解决问题？

```
for line in lines:
    for i in range (0,len(line)-1):
        for j,letter in enumerate(line):
            print letter,
            if j>=i:
                print ''
                break 
```

这输出

```
T 
T h 
T h i 
T h i s 
T h i s   
T h i s   i 
T h i s   i s 
T h i s   i s   
T h i s   i s   t 
T h i s   i s   t h 
T h i s   i s   t h e 
T h i s   i s   t h e   
T h i s   i s   t h e   f 
T h i s   i s   t h e   f i 
T h i s   i s   t h e   f i r 
T h i s   i s   t h e   f i r s 
T h i s   i s   t h e   f i r s t 
T h i s   i s   t h e   f i r s t   
T h i s   i s   t h e   f i r s t   l 
T h i s   i s   t h e   f i r s t   l i 
T h i s   i s   t h e   f i r s t   l i n 
T h i s   i s   t h e   f i r s t   l i n e 
```

我认为这就是您想要的（除了字母之间的空格，但我认为我们也可以以某种方式摆脱它们）。

# facebook - iOS 6 社交框架不会进入设置或没有警报

> ID：14145322
> 
> 赞同：14
> 
> 时间：2013-01-03T18:56:07.823
> 
> 标签：facebook, ios6, social-framework

我正在尝试在 iOS6 中实现新的社交框架，并让它工作，除了 2 个奇怪的问题。如果我启用了我感兴趣的服务（比如...FaceBook），那么它就可以正常工作。但是，如果从设置面板中删除帐户（假设是 FaceBook，以保持一致），那么我在模拟器和设备中会出现不同且令人沮丧的行为。

这是我的视图控制器中的相关代码：

```
//Method for FaceBook

- (IBAction)doFacebook:(id)sender{
//check to see if facebook account exists
if ([SLComposeViewController isAvailableForServiceType:SLServiceTypeFacebook]) {

    // Create the view controller defined in the .h file

    fb=[SLComposeViewController composeViewControllerForServiceType:SLServiceTypeFacebook];

    // make the default string
    NSString *FBString= [NSString
                         stringWithFormat:@"%@\r via #GibberishGenerator", gibText.text];
    [fb setInitialText:FBString];
    // show the controller
    [self presentViewController:fb animated:YES completion:nil];

    }
} 
```

这是启动上述方法时的奇怪行为：

在**模拟器（版本 6.0 (358.4** ) 中，我收到对话框，通知我没有使用“设置”和“取消”按钮设置任何 Facebook 帐户。点击“设置”只会关闭对话框，但不会带我到设置面板。

在我**运行 6.01 的 iPhone 4s 上，**点击触发该方法的按钮会导致……什么都没有。换句话说，我没有收到通知我必须设置 Facebook 帐户的对话框。

在此先感谢您的帮助。

* * *

## 好的......这是修复：

这是我的新实现，基于 user1734802 的有用评论。

```
//Method for FaceBook

- (IBAction)doFacebook:(id)sender{

    // Create the view controller defined in the .h file

    fb=[SLComposeViewController composeViewControllerForServiceType:SLServiceTypeFacebook];

    // make the default string
    NSString *FBString= [NSString
                         stringWithFormat:@"%@\r via #GibberishGenerator", gibText.text];
    [fb setInitialText:FBString];
    // show the controller
    [self presentViewController:fb animated:YES completion:nil];

      } 
```

在某些时候我期望

```
 [SLComposeViewController isAvailableForServiceType:SLServiceTypeFacebook]) 
```

实际正常工作（触发自动对话框，并带您进入设置），所以我实际上只是在我的代码中将其注释掉。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-01-09T14:19:22.120

我有同样的问题，我通过删除 If 语句来修复它：

```
if ([SLComposeViewController isAvailableForServiceType:SLServiceTypeFacebook]) 
```

然后视图将显示，尽管在设置中没有配置 Facebook/Twitter 帐户。并且“没有 Facebook/Twitter 帐户”的 alertView 显示了！我能够点击警报上的“设置”按钮，它引导我进入设置（在设置中配置 Facebook/Twitter 帐户）

这是我使用的代码，它非常适合我：

```
- (IBAction)bTwitter:(id)sender {

mySLComposerSheet = [[SLComposeViewController alloc] init];

mySLComposerSheet = [SLComposeViewController composeViewControllerForServiceType:SLServiceTypeTwitter];

[mySLComposerSheet setInitialText:@""];

[mySLComposerSheet addImage:[UIImage imageNamed:@""]];

[self presentViewController:mySLComposerSheet animated:YES completion:nil];

} 
```

# java - 如何使用 SAX 解析器解析带有二进制数据元素的 XML 文件？

> ID：14145331
> 
> 赞同：2
> 
> 时间：2013-01-03T18:56:43.287
> 
> 标签：java, blob, sax

我收到需要解析的 XML 文件。我经常用 java 编写代码，所以 java SAX 是我自然而然的首选。XML 文件包含文本元素和一个二进制元素（.xls 文件）的组合。

我的解析器处理程序如下：

```
public void startElement(String uri, String localName, String qName,
            Attributes attributes) throws SAXException{

        if(qName.equalsIgnoreCase("To")){
           toFlag = true;
        }

        if(qName.equalsIgnoreCase("Subject")){
           subjectFlag = true;
        }

        if(qName.equalsIgnoreCase("OutDocumentId")){
           outdocmentIdFlag = true;
        }

        if(qName.equalsIgnoreCase("Filename")){
           filenameFlag = true;
        }

        if(qName.equalsIgnoreCase("EmailType")){
            emailTypeFlag = true;
        }

        if(qName.equalsIgnoreCase("Context")){
            contextTypeFlag = true;
        }

        if(qName.equalsIgnoreCase("Blob")){
            blobTypeFlag = true;
        }

    } 
```

元素数据在这里解析：

```
public void characters(char ch[], int start, int length) throws SAXException{

        String text = null;
        if (toFlag) {
            text = new String(ch, start, length);
            getRequest().setRecipientEmail(text);
            toFlag = false;
        }

        if (subjectFlag) {
            text = new String(ch, start, length);
            getRequest().setSubject(text);
            subjectFlag = false;
        }

        if (outdocmentIdFlag) {             
            text = new String(ch, start, length);
            getRequest().setOutDocId(text);
            outdocmentIdFlag = false;
        }

        if (filenameFlag) {
            text = new String(ch, start, length);
            getRequest().setFilename(text);
            filenameFlag = false;
        }

        if(emailTypeFlag) {
            text = new String(ch, start, length);
            getRequest().setEmailType(Integer.parseInt(text));
            emailTypeFlag = false;
        }

        if(contextTypeFlag) {
            text = new String(ch, start, length);
            getRequest().setContext(text);
            contextTypeFlag = false;
        }

        if(blobTypeFlag) {
            text = new String(ch, start, length);               
            try {
                getRequest().setBlob(Hibernate.createBlob(text.getBytes("UTF-16")));
            } catch (UnsupportedEncodingException e) {
                     System.out.println("Error creating blob");
                     e.printStackTrace();
            }
            blobTypeFlag = false;
        }

    }

} 
```

问题在于 blob 元素，它作为 char[] 被读入（我认为这是不正确的）......因为这是它们的父类允许在事件处理期间覆盖的内容。

当一个元素不是文本而是二进制时，有人知道如何使用 SAX 解析吗？

非常感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T19:11:57.940

Take the char data and send it to a [Base64 decoder](http://commons.apache.org/codec/apidocs/org/apache/commons/codec/binary/Base64.html#decodeBase64%28java.lang.String%29).

# java - Spring MVC 3 I18N/MessageSource 不工作

> ID：14145335
> 
> 赞同：1
> 
> 时间：2013-01-03T18:57:01.280
> 
> 标签：java, spring-mvc, internationalization, spring-3

我正在尝试在 Spring MVC 中配置国际化（使用通过链接更改语言环境），但是，它似乎根本不起作用：由于某种原因，默认语言环境始终为 ru，尽管默认设置为 en，但它们不是使用链接进行更改时，无论选择何种语言环境，spring 消息都会显示为空（messages_de、messages_en 和 messages_ru.properties 确实存在于类路径（src/main/resources）中）。它们包含例如

```
label.test=Russian 
```

我称他们为

```
<spring:message code="label.test" /> 
```

在我的 JSP 中。他们没有像那样显示。我认为它甚至没有找到 messageSource，即使没有错误或警告。我真的很感激任何帮助，因为我试图弄清楚很长一段时间。显然，我错过了一些细节，但我绝对无法抓住问题。这是我的配置文件（或最相关的部分）。

根上下文.xml

```
<context:component-scan base-package="... .dao" />
<context:component-scan base-package="... .service" />

<import resource="data.xml" />
<import resource="security.xml" /> 
```

mvc-调度程序-servlet.xml

```
<mvc:annotation-driven />

<mvc:resources mapping="/resources/**" location="/resources/" />

<bean
    class="org.springframework.web.servlet.view.InternalResourceViewResolver">
    <property name="prefix">
        <value>/pages/</value>
    </property>
    <property name="suffix">
        <value>.jsp</value>
    </property>
</bean>

<bean id="messageSource"
    class="org.springframework.context.support.ReloadableResourceBundleMessageSource">
    <property name="basename" value="classpath:messages" />
    <property name="defaultEncoding" value="UTF-8" />
</bean>

<mvc:interceptors>
    <bean class="org.springframework.web.servlet.i18n.LocaleChangeInterceptor">
        <property name="paramName" value="sitelocale" />
    </bean>
</mvc:interceptors>

<bean id="localeResolver"
    class="org.springframework.web.servlet.i18n.CookieLocaleResolver">
    <property name="defaultLocale" value="en" />
</bean> 
```

数据.xml

```
<!-- Transaction Manager -->
<bean id="transactionManager"
    class="org.springframework.orm.hibernate3.HibernateTransactionManager">
    <property name="sessionFactory" ref="sessionFactory" />
</bean>

<bean id="propertyConfigurer"
    class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer"
    p:location="/WEB-INF/jdbc.properties" />

<!-- ////////////////////////////////////////////////////////////////////////// 
    " -->

<bean id="dataSource"  class="com.mchange.v2.c3p0.ComboPooledDataSource"  
    destroy-method="close">
     <property name="driverClass" value="${jdbc.driverClassName}" />
    <property name="jdbcUrl" value="${jdbc.databaseurl}" />
    <property name="user" value="${jdbc.username}" />
    <property name="password" value="${jdbc.password}" />   
</bean>

<!-- ////////////////////////////////////////////////////////////////////////// -->

<!-- Hibernate SessionFactory configuration -->
<bean id="sessionFactory"
    class="org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean">
    <property name="dataSource" ref="dataSource" />
    <property name="packagesToScan" value="com.tsystems.javaschool.kts.domain" />
    <property name="configurationClass">
        <value>org.hibernate.cfg.AnnotationConfiguration</value>
    </property>     
    <property name="hibernateProperties">
        <props>
            <prop key="hibernate.show_sql">true</prop>
            <prop key="hibernate.dialect">${jdbc.dialect}</prop>
            <prop key="hibernate.connection.charSet">UTF-8</prop>
        </props>
    </property>
</bean> 
```

web.xml

```
<context-param>
    <param-name>contextConfigLocation</param-name>
    <param-value>
        /WEB-INF/spring/root-context.xml
    </param-value>
</context-param>

<listener>
    <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
</listener>

<!-- Spring MVC -->
<servlet>
    <servlet-name>appServlet</servlet-name>
    <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    <init-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>/WEB-INF/spring/appServlet/mvc-dispatcher-servlet.xml</param-value>
    </init-param>
    <load-on-startup>1</load-on-startup>
</servlet>
<servlet-mapping>
    <servlet-name>appServlet</servlet-name>
    <url-pattern>/</url-pattern>
</servlet-mapping>
<servlet-mapping>
    <servlet-name>default</servlet-name>
    <url-pattern>*.js</url-pattern>
</servlet-mapping>
<servlet-mapping>
    <servlet-name>default</servlet-name>
    <url-pattern>*.css</url-pattern>
</servlet-mapping>

<!-- Spring Security -->
<filter>
    <filter-name>springSecurityFilterChain</filter-name>
    <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
</filter>

<filter-mapping>
    <filter-name>springSecurityFilterChain</filter-name>
    <url-pattern>*</url-pattern>
</filter-mapping> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T20:14:41.787

添加以下内容应该允许您使用名为“lang”的 URL 参数更改语言（即 lang=en）。这将允许您覆盖浏览器默认设置并明确声明正在使用的语言。

```
<bean id="localeChangeInterceptor" class="org.springframework.web.servlet.i18n.LocaleChangeInterceptor">
    <property name="paramName" value="lang" />
</bean>

<bean id="handlerMapping" class="org.springframework.web.servlet.mvc.annotation.DefaultAnnotationHandlerMapping">
    <property name="interceptors">
        <ref bean="localeChangeInterceptor" />
    </property>
</bean> 
```

此外，如果您要使用 classpath:messages 作为基本名称，请确保在已部署的 webapp 中消息文件位于 WEB-INF/classes/ 下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T19:18:39.610

您不需要在`basename`值前加上“classpath:”，尝试如下更改：

```
<property name="basename" value="messages" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-10-15T10:07:41.557

还要检查你是否在顶部添加这个

```
<%@ page contentType="text/html;charset=UTF-8" %> 
```

# php - 如何使用 jquery 从 .php 文件中提取一些 php 并在另一个页面上运行它？

> ID：14145336
> 
> 赞同：1
> 
> 时间：2013-01-03T18:57:01.683
> 
> 标签：php, jquery, html

使用 jquery，我试图从 .php 文件中提取信息并在另一个 html 页面中运行它。

为了尝试这个，我尝试使用这个例子： [http ://www.tutorialspoint.com/jquery/ajax-jquery-get.htm](http://www.tutorialspoint.com/jquery/ajax-jquery-get.htm)

.php 文件将包括：

```
 <?php
    if( $_REQUEST["name"] )
    {
        $name = $_REQUEST['name'];
        echo "Welcome ". $name;
    }
    ?> 
```

================ html页面代码包括：

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

    <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
    <title>Sandbox</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

    <script type="text/javascript" src="http://www.google.com/jsapi"></script>
    <script type="text/javascript">
    // has the google object loaded?
    if (window.google && window.google.load) {
        google.load("jquery", "1.3.2");
    } else {
        document.write('<script type="text/javascript" src="http://joecrawford.com/jquery-1.3.2.min.js"><\/script>');
    }
    window.onload = function() {
        $('#test').css({'border':'2px solid #f00'});
    };
    </script>
    </head>
    <body>
            <!-- -------- Test jQuery -------- -->
            <p id="test">hello jQuery</p>
            <!-- -------- /end Test jQuery -------- -->

    <script type="text/javascript" language="javascript">
      $(document).ready(function() {
          $("#driver").click(function(event){
              $.get( 
                 "/testing.php",
                 { name: "Zara" },
                 function(data) {
                    $('#stage').html(data);
                 }

              );
          });
       });
    </script>
     <p>Click on the button to load result.html file:</p>
       <div id="stage" >
              STAGE
       </div>
       <input type="button" id="driver" value="Load Data" />
    </body> 
```

根据“测试结果”，jquery 库已成功加载。

出于某种原因，“testing.php”文件的内容没有被提取......几乎就像它的链接不正确一样。文件链接不正确？（.php 和 .html 文件都在同一个文件夹中）

我什至尝试做一些简单的事情，比如 php 中的 echo 语句，但仍然没有从文件中提取任何内容并发布到 html 页面。

您可能会看到一个简单的修复程序。感谢您花时间和精力帮助我解决这个问题。提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T19:04:30.020

你可以简单地这样做：`$('#stage').load('testing.php?name=Zara');`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T19:33:54.470

> 这些文件托管在我计算机上的文件夹中

这给你带来了两个问题：

1.  浏览器对从文件系统加载的网页可以做什么有非常严格的限制，禁止通过 XMLHttpRequest 加载其他文件
2.  PHP 是一种服务器端技术，它需要一个服务器才能工作（在这种情况下）

在网络服务器上托管您的网站。它可以是您在本地运行的，然后您可以通过以下方式访问该站点`http://localhost/etc`

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-03T19:25:50.260

请改用 jquery.ajax。这是您的 HTML 代码

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>Sandbox</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<script type="text/javascript" src="http://www.google.com/jsapi"></script>
<script type="text/javascript">
// has the google object loaded?
if (window.google && window.google.load) {
    google.load("jquery", "1.3.2");
} else {
    document.write('<script type="text/javascript" src="http://joecrawford.com/jquery-1.3.2.min.js"><\/script>');
}
window.onload = function() {
    $('#test').css({'border':'2px solid #f00'});
};
</script>
</head>
<body>
        <!-- -------- Test jQuery -------- -->
        <p id="test">hello jQuery</p>
        <!-- -------- /end Test jQuery -------- -->

<script type="text/javascript" language="javascript">
  $(document).ready(function() {
      $("#driver").click(function(event){
          $.ajax({ 
             url: "testing.php",
             data: { name: "Zara" },
             success: function(data) {
                $('#stage').html(data);
             }

          });
      });
   });
</script>
 <p>Click on the button to load result.html file:</p>
   <div id="stage" >
          STAGE
   </div>
   <input type="button" id="driver" value="Load Data" />
</body> 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-03T19:34:27.120

我宁愿做以下...

```
<?php
    if( $_GET["name"] )
    {
        $name = htmlspecialchars(trim($_GET['name']));
        echo "Welcome ". $name;
    }
?> 
```

和

```
<script type="text/javascript" language="javascript">
  $(document).ready(function() {
      $("#driver").click(function(event){
        $.load( "testing.php?name=Zara, function(data) {
                $('#stage').html(data);
             }

          );
      });
   });
</script> 
```

# iphone - 如何最好地存储不同城市的温度数据？

> ID：14145338
> 
> 赞同：0
> 
> 时间：2013-01-03T18:57:07.147
> 
> 标签：iphone, ios, uitableview

这有点令人困惑，但我会尽力解释它，我希望它会好起来。

我正在尝试在 iOS 中创建以下功能：

我在 tableview 的每一行都有红色按钮。红色按钮被拖放到（原型）tableViewcell 上，并且在每一行中都将使用该按钮。按钮文本显示华氏温度。但是当点击时它会发生变化，因此按钮的颜色会变为绿色。我现在想要额外的功能；华氏温度将变为摄氏度。（我有这个功能的问题）

这里的问题是我有一个 tableviewcells 列表（每个都是另一个城市），而不仅仅是一个。所以我有这么多按钮，我不使用数据库来保存温度数据。数据通过服务读取并放入数组并由 NSUserDefaults 传输到此视图。

例如; 我的表格视图中有一个城市列表。每个都是一行，每个温度都放在一个红色按钮上。温度值是红色按钮的文本。

1.  柏林 45F
2.  伊斯坦布尔 70F
3.  迈阿密 100F
4.  芝加哥 30F

...ETC。

因此，例如，当我点击柏林行上的按钮将华氏温度更改为摄氏度时，第一次没有问题，所以我可以获得柏林的摄氏度值，没问题。但是当我下次点击它再次将其更改为华氏度时，该值不正确。柏林的华氏度值与其他值混淆。因为我不使用数据库，它确实从数组中读取值并且它不知道要使用哪个值。一些点击后，所有华氏值都变成一个值，这是最后一个城市的华氏值（我使用 indexPath.row 所以它得到最后点击的值）

如何在不使用数据库的情况下维护柏林的温度数据，以便在点击其他城市的按钮后再次点击该数据时，它会显示正确的值（45F 或正确的摄氏度值）？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T19:21:34.460

虽然我建议您使用某种形式的基于键的存储（例如创建一个存储温度的“城市”类，甚至将城市 -> 温度键组合存储在字典中），但您可以在单击它时阅读按钮文本并将值从 NSString 转换回双精度或整数。
我假设单击按钮时调用的函数看起来像我要编写的函数。然后，您可以获得单击的按钮及其显示的文本，如下所示：

```
- (IBAction)convertTemperature:(id)sender {
    UIButton *myButton = (UIButton *)sender;
    NSString *buttonText = [myButton titleForState:UIControlStateNormal];
    //...
} 
```

在此之后，您只需转换字符串以获取温度，将其转换并显示回来。

# c++ - Makefile - 通配符，如何正确地做到这一点？

> ID：14145344
> 
> 赞同：2
> 
> 时间：2013-01-03T18:57:28.440
> 
> 标签：c++, c, makefile

```
FLAGS:= -Wall -Wvla -g -lm
OBJECT := Nominated.h UniversityNominated.h AliceGraduate.h BobGraduate.h CollegeNominated.h ColinGraduate.h DannyGraduate.h NominatedList.h Parser.h Parser.cpp
all: Hire

Nominated.o: Nominated.h Nominated.cpp
    g++ -c $(FLAGS) Nominated.cpp -o Nominated.o

NominatedList.o: Nominated.h NominatedList.h NominatedList.cpp
    g++ -c $(FLAGS) NominatedList.cpp -o NominatedList.o

UniversityNominated.o: Nominated.h UniversityNominated.h UniversityNominated.cpp
    g++ -c $(FLAGS) UniversityNominated.cpp -o UniversityNominated.o

AliceGraduate.o: Nominated.h UniversityNominated.h AliceGraduate.h AliceGraduate.cpp
    g++ -c $(FLAGS) AliceGraduate.cpp -o AliceGraduate.o

BobGraduate.o: Nominated.h UniversityNominated.h BobGraduate.h BobGraduate.cpp
    g++ -c $(FLAGS) BobGraduate.cpp -o BobGraduate.o

CollegeNominated.o: Nominated.h CollegeNominated.h CollegeNominated.cpp
    g++ -c $(FLAGS) CollegeNominated.cpp -o CollegeNominated.o

ColinGraduate.o: Nominated.h CollegeNominated.h ColinGraduate.h ColinGraduate.cpp
    g++ -c $(FLAGS) ColinGraduate.cpp -o ColinGraduate.o

DannyGraduate.o: Nominated.h CollegeNominated.h DannyGraduate.h DannyGraduate.cpp
    g++ -c $(FLAGS) DannyGraduate.cpp -o DannyGraduate.o

Parser.o: $(OBJECT)  
    g++ -c $(FLAGS) Parser.cpp -o Parser.o

Parser: Nominated.o UniversityNominated.o AliceGraduate.o BobGraduate.o CollegeNominated.o ColinGraduate.o DannyGraduate.o NominatedList.o Parser.o
    ar rcu libParser.a Nominated.o UniversityNominated.o AliceGraduate.o BobGraduate.o CollegeNominated.o ColinGraduate.o DannyGraduate.o NominatedList.o Parser.o
    ranlib libParser.a

Hire: Hire.cpp Parser
    g++ Hire.cpp libParser.a -o Hire

clean:
    rm -f Hire *.a *.o *~
.PHONY: clean all 
```

所以这是我的 Makefile。

我怎样才能不那么难看？

我总是读到这一点，但我不明白

如何 ？

我的意思是我知道我需要使用通配符工具，但正如你一样，我可能用错了

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-03T19:15:32.353

以下是如何使用通配符和模式替换的示例：

```
SOURCES := $(wildcard *.cpp)
OBJECTS := $(patsubst %.cpp,%.o,$(SOURCES))
CXX := g++ -Wall -Wvla -g

.cpp.o:
        ${CXX} -c $< 
```

这会将所有 .cpp 文件构建到它们的目标文件中。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-03T19:24:43.867

您可以做很多事情，但最好的事情之一是针对特定类型的[模式规则。](http://www.gnu.org/software/make/manual/make.html#Static-Pattern)您的所有对象似乎都是以相同的方式构建的。

```
%.o: %.cpp
    ${CXX} -c $(FLAGS) -o $@ $< 
```

您会注意到这不包含任何头文件作为依赖项。手动维护 Makefile 中的头文件依赖项是一个坏主意，因为在您修改程序时它必然会过时。有时您的编译器可以自动为您生成友好的依赖项。假设您有一个对象列表，例如：

```
OBJS := $(SOURCES:%.c=%.o) 
```

您可以在 Makefile 的最后包含它（之后没有空行）

```
-include $(OBJS:.o=.d) 
```

然后将，添加`-MMD`到您的编译器标志。这将导致 GCC 生成 .d 文件，其中包含每个对象的标头依赖项作为 Make 规则，并且上面的 include 行将包含这些规则并使用它们来解决对象的依赖项。这意味着任何标头更改都将导致包含它的所有文件（直接或间接）被重建。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-03T21:37:15.627

尝试这个：

```
FLAGS   = -Wall -Wextra
SRC     = $(wildcard *.cpp)
OBJ     = $(patsubst %.cpp,%.o,$(SRC))
DEP     = $(patsubst %.cpp,%.d,$(SRC))
PARSER  = $(filter-out Hire.o,$(OBJ))

all: $(DEP) build

build:
    make Hire

%.d:
    g++ -MM $*.cpp > $*.d

%.o: %.cpp
    g++ $(FLAGS) -c $*.cpp

libParser.a: $(PARSER)
    ar rcu libParser.a $(PARSER)
    ranlib libParser.a

Hire: Hire.cpp libParser.a
    g++ Hire.cpp libParser.a -o Hire

clean:
    rm -f Hire *.a *.o *.d *~

.PHONY: clean all 

#
# This line includes all the dependencies.
# There is one for each file.
# Check the *.d files after you run make
-include $(DEP) 
```

# php - 如何将表单信息（包括文件）发送到电子邮件？

> ID：14145350
> 
> 赞同：0
> 
> 时间：2013-01-03T18:58:18.517
> 
> 标签：php, jquery, post, upload

```
<?php

if ($_POST['name'] && $_POST['info']) {
  $message = "";
  $message .= "Nimi:\n" . $_POST['name'] . "\n\n";
  $message .= "E-mail:\n" . $_POST['mail'] . "\n\n";
  $message .= "Phone:\n" . $_POST['phone'] . "\n\n";
  $message .= "File:\n" . $_POST['file'] . "\n\n"; // probably wrong
  $message .= "Message:\n" . $_POST['info'] . "\n\n";

  mail("me@me.me", "blablabla (example.com)", $message, "From: example.com <me@me.me>");
} 
```

我正在使用 jquery-ajax 获取所有其他值（从 textareas 获取 val() 并将它们发布到 process.php 文件），但是如何传递文件并在邮件函数中使用它？

我看了一些插件，但我更喜欢在我已经拥有的代码中添加一些东西，它不会那么难......

```
$("input.submit").click(function(e) {
  e.preventDefault();
  var name = $(".feedback textarea.name").val();
  var mail = $(".feedback textarea.mail").val();
  var phone = $("feedback textarea.phone").val();
  var file = $("feedback input.file").val(); //probably wrong
  var info = $(".feedback textarea.info").val();

  if (name && mail && info) {
    var data = {name: name, mail: mail, phone: phone, file: file, info: info};

    $.post("process.php", data, function() {
      $("textarea, input").val("");
        alert("thank you for submitting");
    });
  }
  else {
    alert("something is missing");
  }
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T19:05:05.923

所以你想通过 AJAX 上传文件吗？[这是关于如何做到](https://stackoverflow.com/questions/166221/how-can-i-upload-files-asynchronously-with-jquery)这一点的一个很好的讨论

上传文件后，如果要将文件内容放入电子邮件中，则需要从 HTTPRequest 解析文件。如果您想将文件添加为附件，这里有一个[很好的参考](http://www.finalwebsites.com/forums/topic/php-e-mail-attachment-script)，说明如何做到这一点

# c# - 如何使用 mono.cecil 按类型在方法主体中查找变量？

> ID：14145351
> 
> 赞同：2
> 
> 时间：2013-01-03T18:58:29.937
> 
> 标签：c#, mono.cecil

我在这里查看了 cecil 问题，但没有看到任何关于这个特定问题的信息。

我想要实现的是找到`method.Body.Variables`一个特定类型的变量（`System.Exception`在我的情况下）

我编写了以下代码，认为它可以解决问题：

```
var exceptionTypeReference = module.Import(typeof(Exception));
var exceptionVariable = method.Body.Variables.First(x => x.VariableType == exceptionTypeReference); 
```

尽管我确信原因是我对 cecil 的菜鸟是我在运行时收到“序列不包含匹配元素”错误，但对我来说似乎很奇怪。

我已经浏览了代码，我知道那里有一个变量，它的类型是`System.Exception`，但它不想与`exceptionTypeReference`.

我确信这很简单，而且我的大脑因学习 cecil 而被炸毁。即便如此，任何指针，用湿鱼打脸等，将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-05T09:57:24.933

每次导入类型时，它都是一个不同的实例`TypeReference`

所以这

```
var typeReference1 = moduleDefinition.Import(typeof (Exception));
var typeReference2 = moduleDefinition.Import(typeof (Exception));
Debug.WriteLine(typeReference1 == typeReference2); 
```

会输出`false`。

因此，当您进行查询时

*   `VariableType`可能是`TypeReference`表示的一个实例`Exception`
*   `exceptionTypeReference`将是`TypeReference`表示的一个实例`Exception`

但是它们不是同一个引用，并且没有内置的相等检查`TypeReference`。

你需要做的是

```
var exceptionType = module.Import(typeof(Exception));
var exceptionVariable = method
              .Body
              .Variables
              .First(x => x.VariableType.FullName == exceptionType.FullName); 
```

另请记住，您必须处理继承的异常类型。

作为一方不小心使用`.Import(typeof (Exception))`。原因是它为您提供了当前代码的异常类型，而不是目标程序集的异常类型。例如，您可以使用 .net4 程序集处理 WinRT 程序集。导入 .net4 Exception 类型可能会给你一些奇怪的行为。

所以你这样做是安全的

```
var exceptionVariable = method
                   .Body
                   .Variables
                   .First(x => x.VariableType.FullName == "System.Exception"); 
```

# objective-c - UICollectionViewCell 填充

> ID：14145352
> 
> 赞同：9
> 
> 时间：2013-01-03T18:58:34.823
> 
> 标签：objective-c, uicollectionview, uicollectionviewcell

我正在尝试在集合视图单元格上设置零填充，我已将视图控制器上的“最小间距”设置为：

![在此处输入图像描述](../Images/8181cfc21c01b7e9e561704ea396c9a8.png)

然而，细胞之间仍然存在差距：

![在此处输入图像描述](../Images/8d57daee948e1a97e9eab9a70ff6736c.png)

我也希望单元格根据框架的宽度很好地包裹，例如每个单元格是 50px 宽，所以如果有六个单元格并且我将框架宽度设置为 150px，它将显示两行三细胞。

但是，如果我通过执行以下操作将框架宽度设置为 150：

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    CGRect frame = self.collectionView.frame;
    frame.size.width = 150;
    self.collectionView.frame = frame;
} 
```

它看起来像上面的屏幕截图（太宽）。

如果我将它设置为小得可笑的值，例如 10，它会在某种程度上包装：

![在此处输入图像描述](../Images/fa32df409afea2141cdd1ae107aa0811.png)

UICollectionViewCell 设置为 50 x 50：

![在此处输入图像描述](../Images/d663b2d286548b79da7fd9e27b8b3622.png)

我还尝试以编程方式设置单元格的大小，并删除了 UIEdgeInset：

```
- (UIEdgeInsets)collectionView:(UICollectionView *)collectionView layout:(UICollectionViewLayout*)collectionViewLayout insetForSectionAtIndex:(NSInteger)section {
    return UIEdgeInsetsMake(0, 0, 0, 0);
} 
```

我已经禁用了自动布局，以防万一有任何干扰。关于如何移除填充并根据框架宽度/高度将它们包裹起来的任何建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T21:26:04.563

我不确定屏幕截图中的那些单元格是 50x50（编辑：我猜它们是......）。

检查是否连接了 UICollectionViewDelegate 和 UICollectionViewDataSource。

这是您需要实现的方法

```
- (CGSize)collectionView:(UICollectionView *)collectionView layout:(UICollectionViewLayout*)collectionViewLayout sizeForItemAtIndexPath:(NSIndexPath *)indexPath {
    CGSize retval = CGSizeMake(50, 50);
    return retval;
} 
```

如果它不起作用，请尝试将此代码放入 viewDidLoad

```
UICollectionViewFlowLayout *flowLayout = [[UICollectionViewFlowLayout alloc] init];
[flowLayout setMinimumInteritemSpacing:0.0f];
[flowLayout setMinimumLineSpacing:0.0f];
[flowLayout setItemSize:CGSizeMake(50.0f, 50.0f)];
[self.collectionView setCollectionViewLayout:flowLayout]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-03T22:32:13.607

您正在使用 UICollectionViewController，它与 UITableViewController 一样，具有集合视图（或表视图）作为`view`视图控制器的基本属性。这意味着它不能在视图控制器中调整大小；它的大小由它的超级视图控制——在这种情况下，它可以是作为根视图控制器的窗口，也可以是嵌入它的父视图控制器。

如果要缩小集合视图区域以使单元格彼此邻接，则可以在情节提要中修改集合视图的部分插图。在您的情况下，左右插入 15 个单元将单元格组合在一起 - 这是 9 * 50 (450) 加上 30 = 480，这是横向 3.5 英寸 iPhone 的宽度。

显然，这在 iPhone 5 或 iPad 中会有所不同。您可以在运行时计算插入，使用标准 UIViewController 子类中保存的集合视图，或者将 UICollectionViewController 保存为嵌入式视图控制器。后两者将使您只需指定一个大小，这可能比计算插图更好。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-12-19T11:00:45.537

在你的 ViewController 中实现这个方法

```
- (CGFloat)collectionView:(UICollectionView *)collectionView layout:(UICollectionViewLayout*)collectionViewLayout minimumLineSpacingForSectionAtIndex:(NSInteger)section
{
   return 2; //the spacing between cells is 2 px here
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-03T21:54:48.650

minimumInteritemSpacing 就是一个最小值，所以如果 UICollectionViewLayout 类决定它需要它可以更大

要纠正这一点，您可以创建自己的布局子类，并实现该`- (UICollectionViewLayoutAttributes *)layoutAttributesForItemAtIndexPath:(NSIndexPath *)indexPath`方法，类似于[此问题](https://stackoverflow.com/questions/13017257/how-do-you-determine-spacing-between-cells-in-uicollectionview-flowlayout)的答案（请参阅第二个问题，而不是标记为正确的问题）

```
- (UICollectionViewLayoutAttributes *)layoutAttributesForItemAtIndexPath:(NSIndexPath *)indexPath {
    UICollectionViewLayoutAttributes* atts =
    [super layoutAttributesForItemAtIndexPath:indexPath];

    if (indexPath.item == 0) // degenerate case 1, first item of section
        return atts;

    NSIndexPath* ipPrev =
    [NSIndexPath indexPathForItem:indexPath.item-1 inSection:indexPath.section];

    CGRect fPrev = [self layoutAttributesForItemAtIndexPath:ipPrev].frame;
    CGFloat rightPrev = fPrev.origin.x + fPrev.size.width + 10;
    if (atts.frame.origin.x <= rightPrev) // degenerate case 2, first item of line
        return atts;

    CGRect f = atts.frame;
    f.origin.x = rightPrev;
    atts.frame = f;
    return atts;
} 
```

# python - 访问 Python 对象数据

> ID：14145354
> 
> 赞同：0
> 
> 时间：2013-01-03T18:58:39.237
> 
> 标签：python, oop

我对 python 还很陌生（对 Python OO 也很陌生），但是我正在使用一个相当复杂的类，我很难理解但我需要编辑它。为了帮助理解发生了什么，我试图从一个对象中提取数据，但我所做的一切只是返回“地址处的类名对象”。

有人可以向我解释一下我将如何打印这个对象中的顶点字段：

```
class Halfedge(object):
    def __init__(self, edge=None, marker=Edge.LEFT):
        self.left = None    # left Halfedge in the edge list
        self.right = None   # right Halfedge in the edge list
        self.qnext = None   # priority queue linked list pointer
        self.edge = edge    # edge list Edge
        self.marker = marker
        self.vertex = None  # Site()
        self.ystar = BIG_FLOAT

    def __eq__(self, other):
        return self.ystar == other.ystar and \
               self.vertex.x == other.vertex.x

    def __lt__(self, other):
        if self.ystar  == other.ystar:
            return self.vertex.x < other.vertex.x
        else:
            return self.ystar < other.ystar

    def left_reg(self, default):
        if not self.edge:
            return default
        elif self.marker == Edge.LEFT:
            return self.edge.reg[Edge.LEFT]
        else:
            return self.edge.reg[Edge.RIGHT]

    def right_reg(self, default):
        if not self.edge:
            return default
        elif self.marker == Edge.LEFT:
            return self.edge.reg[Edge.RIGHT]
        else:
            return self.edge.reg[Edge.LEFT]

    def is_point_right_of(self, point):
        """Returns True if <point> is to right of halfedge.
        """
        edge = self.edge
        topsite = edge.reg[1]
        right_of_site = point.x > topsite.x

        if(right_of_site and self.marker == Edge.LEFT):
            return True

        if(not right_of_site and self.marker == Edge.RIGHT):
            return False

        if(edge.a == 1.0):
            dyp = point.y - topsite.y
            dxp = point.x - topsite.x
            fast = 0
            if ((not right_of_site and edge.b < 0.0) or \
                (right_of_site and edge.b >= 0.0)):
                above = dyp >= edge.b * dxp
                fast = above
            else:
                above = point.x + point.y * edge.b > edge.c
                if(edge.b < 0.0):
                    above = not above
                if (not above):
                    fast = 1
            if (not fast):
                dxs = topsite.x - (edge.reg[0]).x
                above = (edge.b * (dxp*dxp - dyp*dyp)) < \
                        (dxs*dyp*(1.0+2.0*dxp/dxs + edge.b*edge.b))
                if(edge.b < 0.0):
                    above = not above
        else:  # edge.b == 1.0
            yl = edge.c - edge.a * point.x
            t1 = point.y - yl
            t2 = point.x - topsite.x
            t3 = yl - topsite.y
            above = t1*t1 > t2*t2 + t3*t3

        if(self.marker == Edge.LEFT):
            return above
        else:
            return not above

    def intersect(self, other):
        """Create a new site where the Halfedges edge1 and edge2 intersect.
        """
        edge1 = self.edge
        edge2 = other.edge
        if (edge1 is None) or (edge2 is None):
            return None

        # if the two edges bisect the same parent return None
        if edge1.reg[1] is edge2.reg[1]:
            return None

        d = edge1.a * edge2.b - edge1.b * edge2.a
        if almost_equal(d, 0.0):
            return None

        intersect_x = (edge1.c * edge2.b - edge2.c * edge1.b) / d
        intersect_y = (edge2.c * edge1.a - edge1.c * edge2.a) / d
        if edge1.reg[1] < edge2.reg[1]:
            halfedge = self
            edge = edge1
        else:
            halfedge = other
            edge = edge2

        right_of_site = intersect_x >= edge.reg[1].x
        if ((right_of_site and halfedge.marker == Edge.LEFT) or
            (not right_of_site and halfedge.marker == Edge.RIGHT)):
            return None

        # create a new site at the point of intersection - this is a new
        # vector event waiting to happen
        return Site((intersect_x, intersect_y)) 
```

我知道这是非常简单的东西，但感谢您的帮助。

编辑：我正在使用的整个课程可以在以下位置找到：

[https://bitbucket.org/mozman/geoalg/src/5bbd46fa2270/geoalg/voronoi.py](https://bitbucket.org/mozman/geoalg/src/5bbd46fa2270/geoalg/voronoi.py)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T19:22:35.730

假设您有一个 Halfedge 实例——我们称之为它`my_halfedge`——您可以使用点符号访问它的任何属性。所以，对于`vertex`财产，你会做`my_halfedge.vertex`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T19:23:32.027

例如，要制作一个 Halfedge 的实例，

```
he2 = Halfedge() 
```

并打印此实例的顶点值

```
print he2.vertex 
```

这就是你所追求的吗？

# java - 不正确的 week_of_year

> ID：14145365
> 
> 赞同：1
> 
> 时间：2013-01-03T18:59:19.440
> 
> 标签：java

有下一个功能来获得一年中的一周：

```
static public Integer getWeek(Date date) {
    Calendar cal = Calendar.getInstance();
    cal.setMinimalDaysInFirstWeek(1);
    cal.setTime(date);
    Integer week = cal.WEEK_OF_YEAR;
    Integer month = cal.MONTH;
    if ((week == 1) && (month == 12)) week = 52;
    return week;
} 
```

调用 date=02.01.2013 的函数

我在调试中看到的：

1.  日期 = 2013 年 1 月 2 日星期三 00:00:00 SAMT
2.  周 = 3
3.  月 = 2

我想得到：周=1，月=1。对？

我哪里错了？

JRE 1.6

非常感谢提前。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-03T19:03:14.077

`Calendar.WEEK_OF_YEAR`并且`Calendar.MONTH`是 Calendar 用于查找字段的静态常量。你要

```
Integer week = cal.get(Calendar.WEEK_OF_YEAR);
Integer month = cal.get(Calendar.MONTH); 
```

另外，请注意（我认为）一月被认为是第 0 个月。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T19:05:31.323

`public final static int WEEK_OF_YEAR = 3;`是日历的内部来源。

当您访问`WEEK_OF_YEAR`它时会打印该字段的值，它将被视为访问`Calendar`类的静态字段。

如果你想得到一周，你需要做`Integer week = cal.get(Calendar.WEEK_OF_YEAR);`

# javascript - 在页面加载时运行 jquery 延迟加载而不滚动

> ID：14145368
> 
> 赞同：3
> 
> 时间：2013-01-03T18:59:27.863
> 
> 标签：javascript, jquery, lazy-loading, jquery-isotope

我正在尝试将[jQuery 延迟加载插件](http://www.appelsiini.net/projects/lazyload)与[jQuery Isotope 插件](http://isotope.metafizzy.co)一起使用。事情似乎很好地结合在一起，但是，我很难弄清楚如何修改延迟加载插件以满足我的需求。

该插件默认处理滚动事件以触发延迟加载。还有悬停和点击。我希望插件在页面加载时触发。说，完成后 2000 毫秒`$(window).load()`。

我看到我可以按照文档创建自己的事件函数，如下所示：

```
$(function() {          
    $("img:below-the-fold").lazyload({
        event : "sporty"
    });
});
$(window).bind("load", function() { 
    var timeout = setTimeout(function() {$("img.lazy").trigger("sporty")}, 5000);
}); 
```

但是，由于我的无知，我看不到如何使用此代码段来创建自己的页面加载事件。

我希望在之后延迟加载初始图像`$(window).load()`，然后当我应用同位素过滤事件时，在填充 DOM 时延迟加载新项目。

任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T21:50:53.090

我制作了一个可能有帮助的延迟加载插件。初始化后，您只需调用`$.fn.lazyloadanything('load')`它，它就会自动加载而无需先滚动。无需定制。一探究竟：

[https://github.com/shrimpwagon/jquery-lazyloadanything](https://github.com/shrimpwagon/jquery-lazyloadanything)

# python - 如何用数字+1000 搜索和替换数字

> ID：14145371
> 
> 赞同：-1
> 
> 时间：2013-01-03T18:59:44.130
> 
> 标签：python, regex, json

我正在使用具有行和列值的 JSON 文件，我需要根据这些值创建一个唯一的 id。我们决定将行和列的值组合起来，并确保每个都由四位数字表示（每个数字加 1000）。

例如：

`"Col_Row": "1 - 145"`需要像`"Geo_ID": "10011145"`

我想也许我可以用 Python 和正则表达式来做到这一点，因为我必须搜索`"Col_Row"`.

这是我所拥有的：

```
output = re.sub(r'"Col_Row: "(.*?)",', r'\1', test);
output = output.split(' - ')
[1000+int(v) for v in output] 
```

所以我可以获得这些值，但现在我很难用这些值搜索/替换一个非常大的 JSON 文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T19:06:04.067

使用这个正则表达式`(?<=\D|^)(\d{5,}|1[1-9]\d\d|1\d[1-9]\d|1\d\d[1-9]|[2-9]\d{3})(?=\D|$)`

```
(?<=\D|^) symbols before digit
(\d{5,}|1[1-9]\d\d|1\d[1-9]\d|1\d\d[1-9]|[2-9]\d{3}) symbols > 1000
(?=\D|$) symbols after digit 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T20:19:12.147

找到了如何通过回调函数对正则表达式引用进行计算，如以下问题所示：[Python re.sub question](https://stackoverflow.com/questions/2094975/python-re-sub-question#answer-2095012)

所以这是对我有用的python：

例子：

```
import re
test = '"Properties" : { "Col_Row": "1 - 145", ... "Col_Row": "130 - 240" ... }}'
def repl(m):
  num = "%d%d" % (int(m.group(1))+1000,int(m.group(2))+1000)
  string = '"Geo_ID": "%s", "Col_Row": "%s - %s",' % (num,m.group(1),m.group(2))
  return string
output = re.sub(r'"Col_Row": "(.*?) - (.*?)",', repl, test) 
```

输出：`'"Properties" : { "Geo_ID": "10011145", "Col_Row": "1 - 145", ... "Geo_ID": "11301240", "Col_Row": "130 - 240" ... }}'`

现在是真实的（操作文件）：

```
input = open('fishnet.json','r')
input_list = input.readlines()
output = open('updated.json','w')
for line in input_list:
  updated = re.sub(r'"Col_Row": "(.*?) - (.*?)",', repl, line)  
  output.write(updated)
output.close()
input.close() 
```

# android - 启动新活动时出现 NullPointerException

> ID：14145375
> 
> 赞同：0
> 
> 时间：2013-01-03T18:59:46.773
> 
> 标签：android, nullpointerexception, broadcastreceiver, android-activity

我的最后一个话题：[如何在广播接收器 onCallEnded() 中完成活动](https://stackoverflow.com/questions/14140021/how-to-finish-activity-in-broadcastreceiver-oncallended)

试图将侦听器移至`IncomingCallActivity`，因此编辑`IcomingCallReceiver`为：

```
public class IncomingCallReceiver extends BroadcastReceiver {

   @Override
   public void onReceive(Context context, Intent intent) {
        Intent i = new Intent(context, IncomingCallActivity.class);  
        i.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);  
        context.startActivity(i); 
   } 
```

现在`NullPointerExeption`开始新活动时得到...任何想法为什么？

**LOGCAT**

> 致命异常：main java.lang.RuntimeException：无法在 android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1667) 在 android.app.ActivityThread 的 android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1651) 处启动活动.access$1500(ActivityThread.java:117) at android.app.ActivityThread$H.handleMessage(ActivityThread.java:935) at android.os.Handler.dispatchMessage(Handler.java:99) at android.os.Looper.loop (Looper.java:130) 在 android.app.ActivityThread.main(ActivityThread.java:3687) 在 java.lang.reflect.Method.invokeNative(Native Method) 在 java.lang.reflect.Method.invoke(Method.java :507) 在 com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:867) 在 com.android.internal.os.ZygoteInit.main(ZygoteInit.java:625）在dalvik.system.NativeStart.main（本机方法）引起：java.lang.NullPointerException at IncomingCallActivity.onCreate(IncomingCallActivity.java:34) at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1047) at android .app.ActivityThread.performLaunchActivity(ActivityThread.java:1615) ... 11 更多

使用此代码：

```
public class IncomingCallReceiver extends BroadcastReceiver {

   @Override
   public void onReceive(Context context, Intent intent) {
     SipAudioCall incomingCall = null;
     try {
        SipAudioCall.Listener listener = new SipAudioCall.Listener() {
            ...

            @Override
            public void onCallEnded(SipAudioCall call) {

             // IncomingCallActivity.finish();

            }
        };

        Main mainActivity = (Main) context;
        incomingCall = mainActivity.manager.takeAudioCall(intent, listener);
        mainActivity.call = incomingCall;

        Intent i = new Intent(context, IncomingCallActivity.class);  
        i.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);  
        context.startActivity(i); 
```

活动盯着看没有麻烦，但我需要将听众移到`IncomingCallActivity`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T19:03:08.387

看这里：

检查 IncomingCallActivity 活动中的第 34 行并粘贴 IncomingCallActivity 活动代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T19:16:22.233

```
Caused by: java.lang.NullPointerException
at IncomingCallActivity.onCreate(IncomingCallActivity.java:34) 
```

查看 onCreate() 方法中 IncomingCallActivity 的第 34 行。

祝你好运！

# wpf - SharedSizeGroup 命名规则

> ID：14145380
> 
> 赞同：1
> 
> 时间：2013-01-03T19:00:14.133
> 
> 标签：wpf, grid

我有一个关于`SharedSizeGroups`WPF 网格中命名的问题，主要是出于好奇。我在[MSDN](http://msdn.microsoft.com/en-us/library/system.windows.controls.definitionbase.sharedsizegroup%28v=vs.100%29.aspx)上注意到他们列出了组字符串名称的限制：

> SharedSizeGroup 属性值必须满足以下规则：
> 
> *   不得为空。
> *   只能由字母、数字和下划线字符组成。
> *   不得以数值开头。

我有一些我用数字命名的组（“1”、“2”、“3”等）并且从来没有遇到过问题。只是为了好玩，我将一些组重命名为“，- []”，它们仍然有效。所以这些规则没有强制执行，似乎也没有必要。有人知道文档中规则的原因吗？名称是否可能与 WPF 在内部执行的操作发生冲突？

**编辑：**好的，所以 WPF 确实强制执行它，验证只是不会在我的非编译模板中触发。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T19:30:52.183

有趣的是，我查看了反射器中的 DefinitionBase 类和 SharedSizeGroup 属性。

它创建一个带有验证回调的依赖属性，定义如下：

```
SharedSizeGroupProperty = DependencyProperty.Register("SharedSizeGroup", typeof(string), typeof(DefinitionBase), new FrameworkPropertyMetadata(new PropertyChangedCallback(DefinitionBase.OnSharedSizeGroupPropertyChanged)), new ValidateValueCallback(DefinitionBase.SharedSizeGroupPropertyValueValid));

private static bool SharedSizeGroupPropertyValueValid(object value)
    {
        if (value == null)
        {
            return true;
        }
        string str = (string)value;
        if (str != string.Empty)
        {
            int num = -1;
            while (++num < str.Length)
            {
                bool flag = char.IsDigit(str[num]);
                if (((num == 0) && flag) || ((!flag && !char.IsLetter(str[num])) && ('_' != str[num])))
                {
                    break;
                }
            }
            if (num == str.Length)
            {
                return true;
            }
        }
        return false;
    } 
```

我对此进行了测试，实际上对于包含非数字、非字母、非下划线字符的任何内容，它都会返回 false。对于以数字开头的任何组，它也会返回 false。所以它似乎遵循一般的变量名规则..

我的猜测是这很可能会引发某种异常，但也许它正在被处理。你检查过输出窗口吗？

我尝试了一个无效的名称，并得到了 XAMLParseException。

# c++ - 如何使用指针修改向量

> ID：14145388
> 
> 赞同：0
> 
> 时间：2013-01-03T19:01:04.260
> 
> 标签：c++, vector

所以这是我的主要方法：

```
#include <iostream>
#include "TextFileToArray.h"
#include <vector>
using namespace std;

int main()
{
    cout << "Hello world!" << endl;
    TextFileToArray myobject("C:/bunz.txt");
    vector<string> v[10];

    myobject.vectorfiller(*v);

    for(int i =0; i<10; i++){

    cout << v;

    }
} 
```

它调用一个名为的对象`myobject`，它调用一个方法/函数。这是方法/功能：

```
int TextFileToArray::vectorfiller(vector<string>& givenpointer) {
    vector<string> *innervec = &givenpointer;
    const char * constantcharversion = path.c_str();
    ifstream filler(constantcharversion);

    string bunz;
    string lineoutliner = "Line ";
    string equalssign = " = ";
    int numbercounter = 1;
    while (!filler.eof()) {

        std::getline(filler, bunz, ';');
        if (bunz.empty()) {
            lineoutliner = "";
            numbercounter = 0;
            equalssign = "";
        }
        cout << lineoutliner  << numbercounter << equalssign << bunz <<endl;
        cout << "" << endl;
        innervec->push_back(bunz);

        numbercounter++;
    }
    filler.close();

    return 0;
} 
```

到目前为止，它显示了文本文件中的文本，但由于某种原因，它会将内存地址推入向量中，因此在`main()`显示向量时，它会显示内存位置：

![它行不通](../Images/fa277745abd9e8a2105b4fab2989def3.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-03T19:03:38.353

`vector<string> v[10];`创建一个包含 10 个向量的数组，这可能不是您想要的。

创建一个向量，将其作为参数传递，并输出其内容：

```
vector<string> v;
myobject.vectorfiller(v);
for(int i =0; i < v.size(); i++){
    cout << v[i];
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T20:00:32.480

同意，size不应该是10，应该是size()，count<

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-03T20:37:57.067

问题是您正在打印向量数组，而不是第一个向量中的元素。相反，你希望在你的主要：

```
for (int i = 0; i < v[0].size(); i++) {
  cout << v[0][i] << endl;
} 
```

PS：正如 Luchian 所说，您正在创建 10 个向量，而不是一个具有 10 个插槽的向量。要仅获取一个向量，请执行以下操作：

```
vector<string> v; 
```

你也不需要提到10；当您将元素推到向量上时，向量会增长。如果您碰巧提前知道要保留多少空间，则可以使用[Reserve](http://www.cplusplus.com/reference/vector/vector/reserve/)成员函数，如下所示：

```
vector<string> v;
v.reserve(some_number); 
```

Reserve 不会改变 v 的大小；它只会使向量准备好接受那么多元素，因此它不必重新分配内存，也不必复制太多东西。这纯粹是一种优化；如果您只是简单地注释掉程序中的保留调用，它的行为将完全相同。唯一可能改变的是性能和内存使用。

# batch-file - 批处理文件以查找所有图像并复制到文件夹

> ID：14145391
> 
> 赞同：0
> 
> 时间：2013-01-03T19:01:11.320
> 
> 标签：batch-file, vbscript, cmd

甚至不确定这是否可能，但我想我会试一试。

所以这是我的问题。我需要为所有图像搜索多个大硬盘（1TB 及更大）并将它们移动到一个文件夹中。我遇到的问题是，无论我尝试用什么语言写这个，我似乎都找不到答案。我要么希望它与 vbs 或 bat 相关，要么不使用 robocopy 命令。我的一些驱动器都是不同的格式，例如 fat32 和 ntfs。我尝试使用批处理文件的一些脚本的问题是我的文件名太长。所以我需要它做的主要功能是找到图像，复制它们，如果它们存在，用 _001 _002 重命名它们，计算移动了多少文件，然后最后删除它们或将它们移动到单独的文件夹中进行删除（在我眼里更安全一点）。任何帮助将不胜感激，因为我对此完全感到困惑。

这是我正在编写但刚刚停止的一个脚本。问题在于它复制了文件，但由于某种原因没有保留扩展名。这是我在网上找到的，稍微修改了一下代码。我对代码非常熟悉，但由于某种原因似乎无法弄清楚这一点。

```
@echo off
SETLOCAL ENABLEDELAYEDEXPANSION
set TESTFOLDER=allpictures
md "%TESTFOLDER%"

set /a counter=0
FOR /F "tokens=*" %%i IN ('DIR /S /B /A-D C:\Users\user1\Desktop\*.jpg') DO FOR /F "tokens=*" %%j IN ('DIR /B "%%i"') DO IF EXIST ".\%TESTFOLDER%\%%j" (
        set /a counter=!counter!+1
        echo folder: %TESTFOLDER%
        copy "%%i" ".\%TESTFOLDER%\%%j_!counter!"
    ) ELSE copy /B "%%i" ".\%TESTFOLDER%\%%j"
:eof 
```

**编辑：**下面的VBScript代码

```
Set fso = CreateObject("Scripting.FileSystemObject")

testfolder = ".\allpictures"
'fso.CreateFolder(testfolder)

CopyFiles fso.GetFolder("E:\")

Sub CopyFiles(fldr)
  For Each f In fldr.Files
    basename  = fso.GetBaseName(f)
    extension = fso.GetExtensionName(f)
    If LCase(extension) = "jpg" Then
      dest  = fso.BuildPath(testfolder, f.Name)
      count = 0
      Do While fso.FileExists(dest)
        count = count + 1
        dest  = fso.BuildPath(testfolder, basename & "_" & count & "." _
          & extension)
      Loop
      f.Copy dest
    End If
  Next

  For Each sf In fldr.SubFolders
    CopyFiles sf
  Next
End Sub 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T22:48:49.460

**你不应该做的事情**：不要让你被蒙蔽

1.  在您完全理解问题并制定有关该过程的详细计划之前生成代码。（没有人喜欢“给我一个程序来解决我的问题”类型的问题，有时一个代码片段可能会澄清一个问题，但要求人们尝试他们承认不能做的事情是糟糕的教学。）
2.  从一种新的语言开始解决手头的问题（计划或没有计划）。（如果你被困在用你的母语写一封情书，用外语的语法和词汇来写情书的机会有多大？）

**你应该做什么**：

1.  考虑您的问题，并关注最终目标：组织您的图像（如果我正确理解您的评论）。那会是什么样子？当然不是一个文件夹包含数千个名称错误的文件。我会努力以包含 .jpg 且名称不错的文件夹树结束，或者以包含有关我的图片（视频？）和存储路径的合适元信息的数据库，甚至是上传到某些云存储的数据库来结束。从那个最终目标向后工作：你在上一步中需要什么。

2.  我假设，第一步是列出所有 .jpg 文件。鉴于您的知识、技能和工具，获取此列表的最简单方法是什么？可能有一些变化`dir /s [/b] c:\*.jpg > jpglist.txt`。对于以后出现的许多驱动器或其他扩展，您可以将许多这样的行合并到一个 .cmd 文件 ( `>/>>`) 中。此列表和文本编辑器或一些过滤和电子表格可以为您提供有关您的任务的有价值信息：有多少文件？所有尺寸的总和？文件名重复？可能的分类？

3.  购买一个新的外部驱动器（你现在知道大小）。这样，您可以在向惊讶的观众展示您精心组织的收藏后将删除推迟到该步骤。[最后一项任务很简单：只需通过“删除”过滤器脚本输入 jpglist.txt 或使用文本编辑器的搜索和替换功能将其放在`"del /Q "`行首。]

4.  根据您的需要和技能，您可以将基本的 jpglist.txt 转换为具有相关信息的新 .csv 文件，这些文件可以通过电子表格程序手动扫描/检查和/或以编程方式用于生成文件或文件夹名称（附加数字应该是最后的后备）。如果您想要一些 JPG 元数据但不知道如何操作，您可以在此处询问（然后甚至显示用于获取这些文件的大小或日期的代码）。

5.  使每个步骤可重复且尽可能无损（例如，在完成之前不要移动或删除无法用一个命令重新创建的文件）。使用您知道的技术/工具；这绝对排除了“在互联网上找到的代码”）；如果你想学习一些新的/更有趣的东西，那就在一个玩具项目中做吧。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T23:01:05.660

对于操作系统附带的脚本解释器可以轻松处理的东西安装新的脚本解释器是矫枉过正的。

您的脚本不维护扩展名的原因是因为您将计数器变量的内容附加到文件名的末尾，因此计数器`foo.jpg`值为`foo.jpg1`1。您必须使用修饰符来避免这种情况：`%%~nj`给您只是文件名（没有路径和扩展名），`%%~xj`只是扩展名。此外，您可能不希望所有文件都有一个计数器，而是每个重复文件名一个计数器。

```
@echo off

setlocal EnableDelayedExpansion

set TESTFOLDER=allpictures
md "%TESTFOLDER%"

for /f "tokens=*" %%i in ('dir /s /b /a-d C:\Users\user1\Desktop\*.jpg') do (
  call :copyfile "%%~i"
)

goto :eof

:copyfile
set fname=%~nx1
set counter=0

if not exist ".\%dest%\!fname!" goto docopy

:recheck
if exist ".\%dest%\%~n1_!counter!%~x1" (
  set /a counter+=1
  goto recheck
)
set fname=%~n1_!counter!%~x1

:docopy
copy "%~1" ".\%dest%\!fname!"

goto :eof

endlocal 
```

在 VBScript 中，您可以执行以下操作：

```
Set fso = CreateObject("Scripting.FileSystemObject")

testfolder = ".\allpictures"
fso.CreateFolder(testfolder)

CopyFiles fso.GetFolder("C:\Users\user1\Desktop")

Sub CopyFiles(fldr)
  For Each f In fldr.Files
    basename  = fso.GetBaseName(f)
    extension = fso.GetExtensionName(f)
    If LCase(extension) = "jpg" Then
      dest  = fso.BuildPath(testfolder, f.Name)
      count = 0
      Do While fso.FileExists(dest)
        count = count + 1
        dest  = fso.BuildPath(testfolder, basename & "_" & count & "." _
          & extension)
      Loop
      f.Copy dest
    End If
  Next

  For Each sf In fldr.SubFolders
    CopyFiles sf
  Next
End Sub 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-01-03T21:34:26.967

如果使用 perl，您可以将给定目录中的所有文件都放在一个数组中。`my @Files = glob '<directory>\*.jpg';`

循环遍历每个文件 `foreach $file (@Files){ ... }`

每个 .jpg 都将`$file`在循环中被引用。您可以通过获取文件名 `my ($originalfilename) = $file;`并添加所需的任何扩展名，然后将其复制/移动到您想要的任何其他目录。此外，在该循环中，您可以增加计数器循环或仅获取数组的标量值。

[网上有很多关于perl](http://perldoc.perl.org/)文档和教程的东西。如果文件操作很普遍，那么学习一些基本的 perl 是值得的。

# git - 拉取如何与 git 一起工作？

> ID：14145394
> 
> 赞同：1
> 
> 时间：2013-01-03T19:01:44.040
> 
> 标签：git

我有一个关于 git 存储库管理的问题。

可以说我想从“开发”创建一个新分支以获取补丁。很简单：

```
sudo git checkout develop && sudo git checkout -b test-patch 
```

我也想要协作，所以我要将该分支推送到我们的远程：

```
sudo git push -u origin test-patch 
```

现在，我想进行更改，因为另一个开发人员已经完成了一个补丁：

```
sudo git pull origin test-patch 
```

所以，这是我的问题...

**编辑**

既然我知道 origin 是指分支所在的存储库，是否`sudo git pull origin test-patch`会从“test-patch”分支的远程副本中获得任何更改并将这些更改应用于本地副本（不包括冲突的可能性）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-03T19:05:08.280

不，`origin`标识您要从中提取的遥控器。当您使用 git 克隆存储库时，您从中克隆的存储库将默认注册为名为`origin`.

您可以使用命令更改该名称或添加其他遥控器[`git remote`](http://git-scm.com/docs/git-remote)

# r - 在数据框中重复应用 ave 计算组均值

> ID：14145403
> 
> 赞同：3
> 
> 时间：2013-01-03T19:02:21.867
> 
> 标签：r

以下代码分别产生 和 的`x`组`y`均值`group`。假设我有许多变量重复相同的操作。

为了通过单个命令获得相同的结果，您建议如何进行？（我认为有必要采用`tapply`，但我不太确定..）。

```
x=seq(1,11,by=2); y=seq(2,12,by=2); group=rep(1:2, each=3)
dat <- data.frame(cbind(group, x, y))

dat$m_x <- ave(dat$x, dat$group)
dat$m_y <- ave(dat$y, dat$group)
dat 
```

非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-03T19:30:57.443

`data.table`使用和`plyr`包的替代解决方案：

1）使用`data.table`

```
require(data.table)
dt <- data.table(dat, key="group")
# Following @Matthew's comment, edited:
dt[, `:=`(m_x = mean(x), m_y = mean(y)), by=group] 
```

输出：

```
 group  x  y m_x m_y
1:     1  1  2   3   4
2:     1  3  4   3   4
3:     1  5  6   3   4
4:     2  7  8   9  10
5:     2  9 10   9  10
6:     2 11 12   9  10 
```

2）使用`plyr`和改造：

```
require(plyr)
ddply(dat, .(group), transform, m_x=mean(x), m_y=mean(y)) 
```

输出：

```
 group  x  y m_x m_y
1     1  1  2   3   4
2     1  3  4   3   4
3     1  5  6   3   4
4     2  7  8   9  10
5     2  9 10   9  10
6     2 11 12   9  10 
```

3）使用`plyr`和numcolwise（注意减少的输出）：

```
ddply(dat, .(group), numcolwise(mean)) 
```

输出：

```
 group x  y
1     1 3  4
2     2 9 10 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-03T19:12:51.947

假设您有不止两列，您可能希望用于`apply`应用于`ave`矩阵中的每一列。

```
x=seq(1,11,by=2); y=seq(2,12,by=2); group=rep(1:2, each=3)
dat <- cbind(x, y)

ave.dat <- apply(dat, 2, function(column) ave(column, group))
#       x  y
# [1,]  1  2
# [2,]  3  4
# [3,]  5  6
# [4,]  7  8
# [5,]  9 10
# [6,] 11 12 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-05T22:09:29.903

您还可以使用聚合（）：

```
dat2 <- data.frame(dat, aggregate(dat[,-1], by=list(dat$group), mean)[group, -1])
dat2
    group  x  y x.1 y.1
1       1  1  2   3   4
1.1     1  3  4   3   4
1.2     1  5  6   3   4
2       2  7  8   9  10
2.1     2  9 10   9  10
2.2     2 11 12   9  10
row.names(dat2) <- rownames(dat)
colnames(dat2) <- gsub("(.)\\.1", "m_\\1", colnames(dat2))
dat2
  group  x  y m_x m_y
1     1  1  2   3   4
2     1  3  4   3   4
3     1  5  6   3   4
4     2  7  8   9  10
5     2  9 10   9  10
6     2 11 12   9  10 
```

如果变量名称不止一个字符，则需要修改 gsub() 调用。

# css - 如何强制嵌套列表项与父列表项的宽度相同？

> ID：14145404
> 
> 赞同：8
> 
> 时间：2013-01-03T19:02:23.787
> 
> 标签：css, list, nested, width

我有一个水平父列表。某些列表项在单击时会显示嵌套的垂直列表。如何强制垂直子列表中的项目与父列表项的宽度相同？

请参阅[jsFiddle](http://jsfiddle.net/BXnxc/1/)。

![在此处输入图像描述](../Images/4336ac3c434b58c829aaa28fbc464c24.png)

HTML：

```
<ul class="mainMenu horizontalMenu bulletless fullWidth bold">
    <li class="showSubMenu">
        <div>Resumes &amp; Cover Letters &#x25BE; </div>
        <ul class="mainSubMenu bulletless">
            <li><a>Resumes</a></li>
            <li><a>Cover Letters</a></li>
            <li><a>Interviews</a></li>
        </ul>
    </li><li><a>Other Link</a>
    </li><li><a>Other Link</a></li>
 </ul>​ 
```

CSS：

```
.horizontalMenu li{    
    display: inline-block;
}
.mainMenu > li{
    border: 1px solid black;
}
.mainMenu a, .mainMenu div{
    display: block;
    padding: 10px 20px;

}
.mainSubMenu{
    position: absolute;
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-03T19:08:41.290

我在你的小提琴上做了改变。[http://jsfiddle.net/BXnxc/2/](http://jsfiddle.net/BXnxc/2/)

父 li 需要有`position:relative;`，嵌套的子菜单必须有`width:100%;`和`position:absolute;`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-03T19:07:40.930

您可以通过将父级指定`LI`为相对和子级来执行此`UL`操作`width: 100%`

**演示：http:** [//jsfiddle.net/BXnxc/3/](http://jsfiddle.net/BXnxc/3/)

```
.horizontalMenu li {    
    position: relative;
}
.horizontalMenu li ul {    
    width: 100%;   
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-03T19:26:45.533

您也可以通过继承包含结构的宽度来做到这一点。我将您的 mainMenu div 设置为 200px 的宽度，然后将宽度设置为 mainSubMenu 的继承。

[http://jsfiddle.net/BXnxc/4/](http://jsfiddle.net/BXnxc/4/)

```
.mainMenu a, .mainMenu div{
    display: block;
    padding: 10px 20px; 
    width:200px;
}
.mainSubMenu{
    position: absolute;
    width:inherit;
}

.mainSubMenu li
{
    display: block;
    border: 1px solid grey; 
    width:inherit; 
} 
```

# ember.js - 如何在新的 Ember.js 路由器 API 中嵌套视图？

> ID：14145406
> 
> 赞同：0
> 
> 时间：2013-01-03T19:02:28.057
> 
> 标签：ember.js

我有一个设置屏幕，它由一个侧边栏和一个主体组成。正文可以有一个表格来更新用户的个人资料或密码。

路由看起来像这样：

```
App.Router.map(function(match) {
  (match("/")).to("index");
  (match("/user")).to("user", function(match) {
    (match("/")).to("userIdx");
    (match("/settings")).to("userSetup", function(match) {
      (match("/")).to("userSetupIdx");
      (match("/profile")).to("userSetupProfile");
      (match("/password")).to("userSetupPassword");
    });
  });
}); 
```

和这样的包装设置模板：

```
<script type="text/x-handlebars" data-template-name="userSetup">
  <div class='sidebar'>
    Sidebar
  </div>
  <div class='main'>
    Setup <br/>
    {{outlet}}
  </div>
</script> 
```

一个完整的例子可以在这里找到：http: [//jsfiddle.net/stephanos/mgp7F/6/](http://jsfiddle.net/stephanos/mgp7F/6/)

*在 Ember.js 中执行此操作的正确方法是什么？*

**编辑**

在 sly7_7 的帮助下，我设法使上面的小提琴工作：http: [//jsfiddle.net/ygvsS/9/](http://jsfiddle.net/ygvsS/9/)。我所做的只是将所有内容从`userSetup`(template, view, route) 重命名为`setup`. 但显然这不是一个解决方案（因为我也有 appSetup）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T19:49:44.137

根据您的评论示例，我想我已经完成了您正在寻找的工作：http: [//jsfiddle.net/rt8fv/](http://jsfiddle.net/rt8fv/)

路由器代码：

```
App.Router.map(function(match){
  match('/').to('home');
  match('/about').to('about');
  match('/contributors').to('contributors', function(match){
    match('/').to('contributorsIndex');
    match('/:contributor_id').to('contributor', function(match){
      match('/').to('contributorIndex');
      match('/details').to('contributorDetail');
      match('/repos').to('contributorRepos');
    });
  });
}); 
```

可能相关的问题：[在应用程序的每个状态中获取数据的最佳方法](https://stackoverflow.com/questions/14125456/best-approach-to-fetch-data-in-every-state-of-app/)

# visual-studio-2010 - ItemsControl 的 XAML 设计数据问题

> ID：14145407
> 
> 赞同：1
> 
> 时间：2013-01-03T19:02:34.267
> 
> 标签：visual-studio-2010, silverlight, xaml, mvvm, devforce

我正在尝试在我的 MVVM 项目中掌握 VS2010（不是 Blend）的设计数据。

我让它适用于顶级 VM 属性，但集合有问题。我使用 DevForce 进行数据建模，所以理想情况下我的 XAML 应该如下所示：

```
<MaintainTruckViewModel 
    xmlns="clr-namespace:IDATT.Module.Assets.Views"
    xmlns:data="clr-namespace:IDATT.Model;assembly=IDATT.Model.SL">
    <MaintainTruckViewModel.CurrentItem>
        <data:ASTTruck
            TruckId="1000"
            ExternalTruckId="T1000"
            IsActive="True"
            VinNumber="1ZAXBV"
            Make="Volvo"
            Model="ABC"
            MakeYear="2010"
            PlateNumber="ABC 123"
            PlateIssueAdministrativeArea="MO"
            Height="110"
            AxlesCount="3">
            <data:ASTTruck.ASTInsurances>
                <data:ASTInsurance
                    InsuranceKey="1"
                    CompanyName="MainCo"
                    AgentCompanyName="Joes insurance"
                    CoverageAmount = "1000000"
                    DeductibleAmount = "1000"
                    InsuranceType = "General liability"
                    IsActive = "True"
                    PolicyNumber = "123ABC"
                    ExpireOn = "01-01-2012"
                    Note = "This insurance covers all stuff"/>
            </data:ASTTruck.ASTInsurances>
        </data:ASTTruck>
    </MaintainTruckViewModel.CurrentItem>
</MaintainTruckViewModel> 
```

我的 xaml 看起来像这样，我希望在设计视图中看到 ASTInsurance 数据，但它没有显示

```
<ItemsControl 
                    Grid.Row="1"
                    ItemsSource="{Binding CurrentItem.ASTInsurances}"> 
```

我不知道如何根据设计数据制作各种“工作”列表。任何指针？我发现某处可以使用单独的 d:DesignData 作为列表并尝试创建这样的 XAML：

```
<Generic:List 
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:Generic="clr-namespace:System.Collections.Generic;assembly=mscorlib"
    x:TypeArguments="data:ASTInsurance" 
    xmlns:data="clr-namespace:IDATT.Model;assembly=IDATT.Model.SL">
                <data:ASTInsurance
                    InsuranceKey="1"
                    CompanyName="Great West"
                    AgentCompanyName="Joes insurance"
                    CoverageAmount = "1000000"
                    DeductibleAmount = "1000"
                    InsuranceType = "General liability"
                    IsActive = "True"
                    PolicyNumber = "123ABC"
                    ExpireOn = "01-01-2012"
                    Note = "This insurance covers all stuff"/>

</Generic:List> 
```

现在 XAML 编辑器强调 Generic.List 并说`The type 'Generic:List' was not found. Verify that you are not missing an assembly reference and that all referenced assemblies have been built`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T22:18:50.160

尝试`System.Collections.Generic.List<T>`在 XAML 中使用的问题是（据我所知）XAML 的 Silverlight 方言无法指定泛型类型参数的值。您得到的错误是因为没有类型`System.Collections.Generic.List`没有类型参数。

您可以做的一件事是创建一个`List<T>`为类型参数提供值但不包含新成员或覆盖成员的子类，例如：

```
public class ASTInsuranceList : List<ASTInsurance>
{
} 
```

然后，您可以使用`ASTInsuranceList`XAML 中的对象来包含`ASTInsurance`对象列表。

# xmpp - 发送初始状态后未收到自己的 XMPP 状态节（用于其他资源）

> ID：14145408
> 
> 赞同：1
> 
> 时间：2013-01-03T19:02:35.393
> 
> 标签：xmpp

连接后，当我将我的初始状态发送到服务器时，服务器不会响应我自己的 JID 当前在线的其他资源的状态信息（尽管我确实收到了我名册中用户的状态信息）。当我的另一个资源更改状态时，我只会从我的 JID 的其他资源中收到存在信息。

这是标准行为吗？我的印象是服务器负责在初始存在后发送此信息。

我不知道它运行在哪个 Jabber 服务器版本上，所以我不确定这是错误还是功能。

考虑到这个问题，有什么方法可以弄清楚我自己的 JID 可以使用哪些其他资源？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T12:56:49.260

服务器还必须向您发送您自己的存在以及您所有其他资源的存在。
见：http: [//xmpp.org/rfcs/rfc6121.html#presence-initial](http://xmpp.org/rfcs/rfc6121.html#presence-initial)

```
an entity is implicitly subscribed to its own presence 
```

但我认为 RFC 中可能对此有一些额外的措辞。或者也许有但我没有看到它;-)

亚历克斯

# rest - 通过 API 获取指标

> ID：14145409
> 
> 赞同：4
> 
> 时间：2013-01-03T19:02:38.820
> 
> 标签：rest, soap, azure, azure-sql-database

我正在使用 Azure SQL，其中有一个包含指标的页面

![在此处输入图像描述](../Images/8078c5742bbd7b173793b5ea521538af.png)

据我了解，新的 Azure 管理门户仅使用公共 api。我试图找出的是如何通过 REST 或 SOAP api 访问这些指标。我已经搜索了 MSDN 文档，但找不到任何东西。

有人有想法么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T21:36:50.190

我认为微软没有提供 Azure 数据库监控 REST 或 SOAP API，因为它不会被大量使用。

DBA 可以连接到 Azure 数据库并通过非常强大的[动态管理视图收集所有必要的统计信息。](http://msdn.microsoft.com/en-us/library/windowsazure/ff394114.aspx)

但是，我没有任何文章/文件证实我的假设。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T00:48:54.350

尝试使用新的 sys.event_log 和 sys.database_connection_stats DMV。

请参阅：[宣布：Windows Azure SQL 数据库的新系统视图](http://blogs.msdn.com/b/windowsazure/archive/2012/11/05/announcing-new-dynamic-management-views-for-windows-azure-sql-database.aspx)

# android - 使相机应用程序可用于锁定屏幕快速启动？

> ID：14145410
> 
> 赞同：1
> 
> 时间：2013-01-03T19:02:38.590
> 
> 标签：android, camera

如何使我的相机应用程序可用于在 Android 锁定屏幕上“快速启动”？

相机意图的文档似乎都集中在如何在相机应用程序中实现，它将拍摄一张照片并将其返回给调用应用程序。锁屏快速启动似乎是一个完全不同的用例，“返回图像”工作流程显然不适用。（目前，我特别不想实现“返回一张照片”功能。）

谢谢你的帮助。要么这似乎记录得很差，要么我无法找出合适的术语来搜索合适的文档。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T14:58:00.337

谢谢CommonsWare。你的评论最终让我...

```
<intent-filter>
  <action android:name="android.media.action.STILL_IMAGE_CAMERA" />
  <category android:name="android.intent.category.DEFAULT" />
</intent-filter> 
```

# java - Websocket 服务器 Android

> ID：14145421
> 
> 赞同：7
> 
> 时间：2013-01-03T19:03:39.257
> 
> 标签：java, android, websocket

有谁知道可用于 android 的免费/开源 websocket 服务器？一个轻量级的 Java （希望）也可以工作。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-03T19:24:51.957

[github.com/TooTallNate/Java-WebSocket](https://github.com/TooTallNate/Java-WebSocket)是一个很好的实现。它处理线程中的连接，并且相对易于使用和轻量级。

# objective-c - 按计数分组的核心数据提取属性

> ID：14145423
> 
> 赞同：9
> 
> 时间：2013-01-03T19:03:50.680
> 
> 标签：objective-c, core-data

这是我想为 Core Data 编写的查询的 SQL 版本：

```
SELECT Group.Name, COUNT(Item.Name)
FROM Item INNER JOIN Group ON Item.GroupID = Group.ID
GROUP BY Group.Name 
```

到目前为止，我所拥有的是：

```
NSFetchRequest* fetchGroupSummary = [NSFetchRequest fetchRequestWithEntityName:@"Item"];

NSEntityDescription* entity = [NSEntityDescription entityForName:@"Item" inManagedObjectContext:[[CoreDataManager sharedInstance] managedObjectContext]];

NSAttributeDescription* groupName = [entity.relationshipsByName objectForKey:@"group"];
NSExpression *countExpression = [NSExpression expressionForFunction: @"count:" arguments: [NSArray arrayWithObject:[NSExpression expressionForKeyPath: @"name"]]];
NSExpressionDescription *expressionDescription = [[NSExpressionDescription alloc] init];

[expressionDescription setName: @"count"];
[expressionDescription setExpression: countExpression];
[expressionDescription setExpressionResultType: NSInteger32AttributeType];

NSSortDescriptor *sortDescriptor = [NSSortDescriptor sortDescriptorWithKey:@"group.sort" ascending:YES];
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"group.stage == %@", stage];

[fetchGroupSummary setEntity:entity];
[fetchGroupSummary setSortDescriptors:@[sortDescriptor]];
[fetchGroupSummary setPropertiesToFetch:[NSArray arrayWithObjects:groupName, expressionDescription, nil]];
[fetchGroupSummary setPropertiesToGroupBy:[NSArray arrayWithObject:groupName]];
[fetchGroupSummary setResultType:NSDictionaryResultType];
[fetchGroupSummary setPredicate:predicate];

NSError* error = nil;
groups = [[[CoreDataManager sharedInstance] managedObjectContext] executeFetchRequest:fetchGroupSummary error:&error];

expressionDescription = nil; 
```

这几乎给了我一切，但是我想指定 group.name 而不是 groupName 是组关系 - 这可能吗？

标记

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-04T08:36:06.510

`setPropertiesToGroupBy`of接受一个或对象`NSFetchRequest`数组，或*keypath 字符串*。在您的情况下，您可以使用 keypath 字符串：`NSPropertyDescription``NSExpressionDescription`

 *```
[fetchGroupSummary setPropertiesToGroupBy:[NSArray arrayWithObject:@"group.name"]]; 
```*

# ruby - vim-foreplay 在 Ruby 1.9 上真的很慢，但在 Windows 上用 Ruby 1.8 很快

> ID：14145425
> 
> 赞同：2
> 
> 时间：2013-01-03T19:04:07.383
> 
> 标签：ruby, windows, vim, clojure

我注意到Windows 上的[vim-foreplay](https://github.com/tpope/vim-foreplay)在执行涉及将代码发送到 nrepl（不知道的人的 Java 进程）的事情时真的很慢，我认为它使用 Ruby 可以做到这一点。我尝试了[Vim without Cream](http://sourceforge.net/projects/cream/files/Vim/) 7.3.762 使用 Ruby 1.9.3，并且从官方 Vim Windows 安装程序安装的 Vim 也使用 ruby​​ 1.9.3（我无法让这个版本与 Ruby 1.8 一起使用，我没有知道它是如何工作的，以及它是否应该工作）。两个一起vim-foreplay都很慢，发送一些要评估的东西大约需要1秒。但是为 Ruby 1.8 构建的没有 Cream 7.3.289 的 Vim 要快得多；评估是即时的。怎么来的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T22:17:31.867

显然，在 Windows 上的 Ruby 1.9.3-p362 中打开`localhost`与 with的连接很慢，但 to要快得多。`TCPSocket.open()``127.0.0.1`

感谢[https://github.com/tpope](https://github.com/tpope)帮助我找到了这一点。

# asp.net-mvc-4 - Asp.Net MVC4 播种用户和角色教程

> ID：14145426
> 
> 赞同：0
> 
> 时间：2013-01-03T19:04:08.170
> 
> 标签：asp.net-mvc-4, entity-framework-5

我的大脑被这个问题打乱了。

我一直在以下链接中关注有关播种用户和角色的教程：-

[http://blog.longle.net/2012/09/25/seeding-users-and-roles-with-mvc4-simplemembershipprovider-simpleroleprovider-ef5-codefirst-and-custom-user-properties/#comment-648](http://blog.longle.net/2012/09/25/seeding-users-and-roles-with-mvc4-simplemembershipprovider-simpleroleprovider-ef5-codefirst-and-custom-user-properties/#comment-648)

我试图更新数据库，然后应该为用户播种，但我收到以下错误消息：-

> 在调用“WebSecurity”类的任何其他方法之前，您必须调用“WebSecurity.InitializeDatabaseConnection”方法。此调用应放置在站点根目录中的 _AppStart.cshtml 文件中。**

另一位成员在此处发布了此问题：-[无法播种用户和角色](https://stackoverflow.com/questions/13565347/cannot-seed-users-roles)

提供的解决方案对我没有帮助，因为我的项目中引用了正确版本的 WebMatrix.WebData.Dll。（第 2 版）。

其他人已经能够毫无错误地遵循指示，这是没有意义的。O已经尝试了其他人发布的所有工作，但故障不会转移。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T11:37:34.550

我已通过确保将以下参考添加到我的 Configuration.cs 来设法解决此问题：-

```
 using System;
    using System.Data.Entity;
    using System.Data.Entity.Migrations;
    using System.Linq;
    using WebMatrix.WebData;
    using WebMatrix.Data;
    using System.Web; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T13:31:47.287

[阅读这篇博文，了解一种替代方法，用于](http://kevin-junghans.blogspot.com/2013/01/seeding-customizing-aspnet-mvc.html)自动为用户和角色播种，不需要包管理器。它包括一个可以下载的 VS 2012 示例项目。

# java - 如果 val 在 Scala 中优先于 var，Java 中的大多数对象引用应该被标记为 final 吗？

> ID：14145428
> 
> 赞同：1
> 
> 时间：2013-01-03T19:04:14.953
> 
> 标签：java, scala

因为 val 在 Java 中类似于 final，所以大多数 Java 对象引用是否应该标记为 final，因为在 Scala 中使用 val 是一种好习惯？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T19:19:30.213

当然，`final`在 Java 中创建类变量是一种很好的做法，尽可能鼓励不变性。

至于局部变量——方法参数等——在不需要的时候是否应该标记为final，这是一个风格问题。就个人而言，我觉得它在使用时往往会使事情变得混乱，除非有其他必要（例如，使变量在匿名内部类中可访问）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T19:19:11.080

参考文献应尽可能多地是最终的。它允许更大的运行时优化，并且有助于“以合同方式”确保您（或您的代码的后续维护者）不会意外更改引用。对我来说，它类似于“私人”，因为你应该尽可能地让事情变得私密。它为您提供了未来重构的灵活性，而不会影响代码库的其他部分（最小化涟漪效应）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-03T19:20:34.157

作为大多数决定，使用`final`是对编码约定的讨论。

`final`如果仅分配一次，我自己会制作所有参数和变量。我认为它增加了代码的可读性。

Eclipse 有一个`SaveAction`可以添加`final`的地方。

也许关键字可以帮助编译器检测可能的优化（或者将来的编译器将能够使用此提示）

# delphi - TJvInspector - 获取属性值？

> ID：14145429
> 
> 赞同：1
> 
> 时间：2013-01-03T19:04:16.377
> 
> 标签：delphi, jedi

您如何获得在运行时输入到 JvInspector 中的值？

中的 Demo`\..\jvcl\examples\JvInspector`展示了如何添加字符串，通过编写类似这样的内容（从演示中提取）：

```
var
  FirstName: string;

implementation

procedure TfrmInspector.AddVarious;
var
  InspCat: TJvInspectorCustomCategoryItem;
begin
  TJvInspectorVarData.New(InspCat, 'First', TypeInfo(string), @FirstName).DisplayName := 'Copy of first name';
end; 
```

我想添加一个 TColor 属性，所以我这样做了：

```
var
  FirstName: string;
  SomeColor: TColor;

implementation

procedure TfrmInspector.AddVarious;
var
  InspCat: TJvInspectorCustomCategoryItem;
begin
  TJvInspectorVarData.New(InspCat, 'First', TypeInfo(string), @FirstName).DisplayName := 'Copy of first name';
  TJvInspectorVarData.New(InspCat, 'SomeColor', TypeInfo(TColor), @SomeColor;
end; 
```

这显示正确，但从检查器的下拉列表中选择新颜色时，我似乎无法获得为 SomeColor 更改的值。

我试过这个：

```
procedure TfrmInspector.JvInspector1ItemValueChanged(Sender: TObject;
  Item: TJvCustomInspectorItem);
begin
  if (Item.Data <> nil) and (CompareText(Item.Data.Name, 'FirstName') = 0) then
    ShowMessage(Item.Data.AsString) //< works
  else if (Item.Data <> nil) and (CompareText(Item.Data.Name, 'SomeColor') = 0) then
    ShowMessage(ColorToString(TColor(Item.Data))); //< does not return correct value
end; 
```

我通常不使用 Jedi 组件，但我想我会给他们另一个机会，但似乎文档很少，我在 Wiki 页面上查看了 OnItemValueChanged 事件：[http://wiki.delphi-jedi.org/wiki/JVCL_Help： TJvInspector.OnItemValueChanged](http://wiki.delphi-jedi.org/wiki/JVCL_Help%3aTJvInspector.OnItemValueChanged)但几乎没有任何信息或帮助。

我确定不是试图让`ColorToString(TColor(Item.Data))`我需要使用`Item.Data.AsVariant`但我可能是错的，当我尝试时我得到了 AV 错误所以我可能完全错了，我做过或尝试过的任何事情似乎都不起作用:(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T21:48:47.427

该`Item.Data`属性是类型的对象引用`TJvCustomInspectorData`；将其类型转换为`TColor`废话。`TColor`是一个序数类型，所以使用该`AsOrdinal`方法，就像字符串代码使用的那样`AsString`：

```
ShowMessage(ColorToString(TColor(Item.Data.AsOrdinal))); 
```

或者，您应该能够从`SomeColor`最初创建项目时传递的全局变量中读取。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T20:11:30.603

我找到了一种可行的方法：

```
procedure TfrmInspector.JvInspector1ItemValueChanged(Sender: TObject;
  Item: TJvCustomInspectorItem);
var
  sVal: string;
begin
  if (Item.Data <> nil) then
  begin
    sVal := Item.DisplayValue;

    if (CompareText(Item.Data.Name, 'FirstName') = 0) then
      ShowMessage('FirstName Value: ' + sVal)
    else if (CompareText(Item.Data.Name, 'SomeColor') = 0) then
      ShowMessage('SomeColor Value: ' + sVal); //<can use StringToColor now
  end;
end; 
```

虽然可能不是我认为我会发布它的最佳方式。

# c# - 使用 asp.net 在 sesson 数据中存储用户名

> ID：14145430
> 
> 赞同：1
> 
> 时间：2013-01-03T19:04:25.780
> 
> 标签：c#, asp.net, session, asp.net-membership

在我的 asp.net 网站上，我启用了需要用户登录的会员功能。我想将用户名存储在会话数据中，以便在他们登录后使用该查询。

在我的登录页面上，我有以下代码来存储会话数据，但它不起作用：

```
Session["UserName"] = System.Web.HttpContext.Current.User.Identity.Name; 
```

查询不会加载任何结果，因为控制参数 (session[username]) 返回空。

谁能建议它不起作用的原因是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T19:29:34.053

通常在下一页加载之前用户信息不可用。

您可能必须在登录后重定向到“跳跃”页面并重定向回用户请求的页面。

这是使用 MVC 的方法

登录：

```
public ActionResult Login(LoginModel model, string returnUrl)
{
    if (ModelState.IsValid)
    {
        return Hop(returnUrl);
    }
} 
```

跳页：此时用户信息实际上是可用的。

```
public ActionResult Hop(string returnUrl)
{
    Session["UserName"] = User.Identity.Name;
    return Redirect(returnUrl);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-03T19:08:02.630

If you are using the membership providers you should use their classes to grab user information. Try using

```
Session["UserName"] = Membership.GetUser().UserName 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-03T22:30:48.230

您是否在页面上使用登录控件？如果是这样，您可以直接从控件中获取用户名，如下所示：（假设登录控件名为 loginControl）

```
Session["UserName"] = loginControl.UserName; 
```

# json - 为特征玩 2.1 Json 序列化？

> ID：14145432
> 
> 赞同：10
> 
> 时间：2013-01-03T19:04:30.580
> 
> 标签：json, scala, playframework, playframework-2.1

我有这个：

```
package models

import play.api.libs.json._
import play.api.libs.functional.syntax._

object ModelWrites {
    implicit val tmoWrites= Json.writes[TestModelObject]
    implicit val ihWrites = Json.writes[IntHolder]
}

case class TestModelObject(s1:String, s2:String)

case class IntHolder(i1:Int, i2:Int)

trait HasInts {
    val ints: List[IntHolder]
} 
```

当我这样做时：

```
scala> val tmo = new TestModelObject("hello", "world") with HasInts {
  val ints = List(IntHolder(1,2), IntHolder(3,4))
}

scala> Json.toJson(tmo)
res0: play.api.libs.json.JsValue = {"s1":"hello","s2":"world"} 
```

如何隐式序列化混合的 val 'ints'？喜欢：

```
scala> val someInts = List(IntHolder(8,9), IntHolder(10,11))
someInts: List[models.IntHolder] = List(IntHolder(8,9), IntHolder(10,11))

scala> Json.toJson(someInts)
res1: play.api.libs.json.JsValue = [{"i1":8,"i2":9},{"i1":10,"i2":11}] 
```

注意：如果我尝试：`implicit val hasIntsWrites = Json.writes[HasInts]` 我（预期？）得到：

```
[error] Models.scala:10: No unapply function found
[error]     implicit val hasIntsWrites = Json.writes[HasInts]
[error]                                             ^ 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-03T20:55:00.563

您将无法在此处直接使用[实验性的“Inception”功能](http://mandubian.com/2012/11/11/JSON-inception/)( `Json.writes[...]`)，因为它仅适用于案例类。但是，您可以在 Inception 的*实例*`Writes`上构建*提供的实例的基础上构建，只需很少的样板即可完成您想要的事情。*

 *请注意，我忽略了这样的问题：在实例化这样的案例类时混合特征是否是一个好主意——它可能不是——但我在这里给出的方法也适用于更一般的情况。

首先是类和导入（这里没有变化）：

```
case class TestModelObject(s1: String, s2: String)
case class IntHolder(i1: Int, i2: Int)
trait HasInts { val ints: List[IntHolder] }

import play.api.libs.json._
import play.api.libs.functional.syntax._ 
```

现在我们需要将所有优先级较低的实例放入一个特征中，以确保编译器会选择正确的实例，因为`TestModelObject with HasInts`它是`TestModelObject`and的子类型`HasInts`：

```
trait LowPriorityWritesInstances {
  implicit val tmoWrites = Json.writes[TestModelObject]
  implicit val ihWrites = Json.writes[IntHolder]

  implicit object hiWrites extends OWrites[HasInts] {
    def writes(hi: HasInts) = Json.obj("ints" -> hi.ints)
  }
} 
```

现在主要事件：

```
object WritesInstances extends LowPriorityWritesInstances {
  implicit val tmowhiWrites = new Writes[TestModelObject with HasInts] {
    def writes(o: TestModelObject with HasInts) =
      tmoWrites.writes(o) ++ implicitly[OWrites[HasInts]].writes(o)
  }
} 
```

我们完成了：

```
scala> import WritesInstances._
import WritesInstances._

scala> val tmo = new TestModelObject("hello", "world") with HasInts {
     |   val ints = List(IntHolder(1, 2), IntHolder(3, 4))
     | }

scala> println(Json.toJson(tmo))
{"s1":"hello","s2":"world","ints":[{"i1":1,"i2":2},{"i1":3,"i2":4}]} 
```

如预期的。*

# c# - SQLConnection 连接错误“用户服务器/访客登录失败”

> ID：14145435
> 
> 赞同：2
> 
> 时间：2013-01-03T19:04:36.170
> 
> 标签：c#, sql-server, authentication, login, sqlconnection

我不断收到连接错误。我知道信息是正确的，因为我在过去几分钟内多次使用 SSMS 对其进行了尝试，所以问题出在 C# 连接字符串中。根据各种谷歌搜索，语法是正确的，只是它不起作用。

```
try
{
    // Get the connection information.
    GetSQLConnectInfo(ref sConnect);

    // Formulate the connection string.
    String strConnect = String.Format("Server=myserver;Database=mydb;User Id=myusername;Password=mypassword;Trusted_Connection=yes;connection timeout=30");

    // DATABASE: Create the connection.
    SqlConnection oConnection = new SqlConnection(strConnect);
    oConnection.Open();
    if (ConnectionState.Open != oConnection.State)
        return false;

    return true;
}

catch
{
} 
```

错误返回：用户“myserver\Guest”登录失败。错误代码：-2146232060 错误编号：18456

从错误消息来看，Open 方法似乎无法识别用户名，因为 Open 尝试使用来宾帐户，这显然不起作用。

我错过了什么吗？我正在使用 SQL Server 身份验证。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-03T19:07:08.380

删除`Trusted_Connection=yes`. 这将覆盖您的 SQL 身份验证（用户名/密码）设置，并尝试以运行应用程序的用户身份登录。

# plsql - PL/SQL 过程运行一些语句，然后将结果记录在表中

> ID：14145450
> 
> 赞同：-1
> 
> 时间：2013-01-03T19:06:16.770
> 
> 标签：plsql

我需要使用 pl/sql 过程自动执行以下指令集：

```
SET DEFINE OFF;

TRUNCATE TABLE EMP.dept;

INSERT INTO EMP.dept values....;

Commit; 
```

另外，我需要将活动（成功/失败）记录到表 EMP.Log 中。

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T19:11:54.013

根据表中的列，`EMP.dept`我将使用定义为的过程：

```
--The parameters to this procedure depend on the fields in EMP.dept
--This example assumes EMP.dept has only 2 VARCHAR fields, but
--the parameter list can easily be modified:
--
CREATE OR REPLACE PROCEDURE PROC_NAME1(INPUT1 IN VARCHAR2, INPUT2 IN VARCHAR2)  AS
    V_FAILURE INTEGER;
BEGIN
    V_FAILURE := 0;
    BEGIN
       EXECUTE IMMEDIATE 'TRUNCATE TABLE EMP.dept';
       INSERT INTO EMP.dept (FIELD1, FIELD2) VALUES (INPUT1, INPUT2);
       COMMIT;
    EXCEPTION
    WHEN OTHERS THEN
        V_FAILURE := 1;
        ROLLBACK;
    END;

    BEGIN
        --DEPENDING ON THE COLUMNS IN YOUR LOG_TABLE
        --
        INSERT INTO LOG_TABLE(STATUS, RUN_DATE) 
        VALUES (V_FAILURE, SYSDATE);
        COMMIT;

    EXCEPTION 
    WHEN OTHERS THEN NULL;
    END;

END; 
```

# sql - 多个触发器与单个触发器

> ID：14145451
> 
> 赞同：9
> 
> 时间：2013-01-03T19:06:18.667
> 
> 标签：sql, sql-server, triggers, sql-server-2008-r2

**设想：**

每次将数据插入/更新/删除到/从表中/从表中，最多需要发生 3 件事：

1.  数据需要记录到单独的表中
2.  必须对隐式相关数据强制执行引用完整性（我指的是应该与外键关系链接的数据，但不是：例如，当更新`Table1.Name`也应该更新`Table2.Name`为相同的值时）
3.  任意业务逻辑需要执行

不得更改数据库的体系结构和模式，并且必须使用触发器来完成要求。

**问题**

哪个选项更好？：

1.  每个操作（插入/更新/删除）的单个触发器处理多个关注点（日志、强制执行隐式引用完整性和执行任意业务逻辑）。此触发器可以命名`D_TableName`（“D”表示删除）。
2.  每个操作的多个触发器按关注点隔离。他们可以被命名为：

    *   `D_TableName_Logging`- 用于在删除某些内容时进行记录
    *   `D_TableName_RI`
    *   `D_TableName_BL`

我更喜欢选项 2，因为单个代码单元有一个问题。我不是 DBA，对 SQL Server 的了解足以让我变得危险。

是否有任何令人信服的理由可以在一个触发器中处理所有问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-03T19:11:10.030

哇，你处于一个没有胜利的境地。曾经要求通过触发器完成所有这些事情的人应该被枪杀然后被解雇。通过触发器执行 RI？

你说数据库的架构和模式不能改变。但是，通过创建触发器，您至少是在更改数据库的架构，并且可以说是架构。

我可能会选择选项 #1 并创建额外的存储过程和 UDF 来处理日志记录、BL 和 RI，这样代码就不会在各个触发器之间重复（触发器将调用这些存储的过程和/或 UDF）。我真的不喜欢按照您在选项 2 中提出的方式命名触发器。

顺便说一句，请告诉您组织中的某个人，这太疯狂了。RI 不应通过触发器强制执行，并且业务逻辑不属于数据库。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-03T19:11:35.503

在一个触发器中完成所有操作可能会更有效，因为您最终可能会对（未索引的）`inserted`和`deleted`表进行更少的操作。

此外，当您有多个触发器时，可以设置第一个和最后一个触发，但任何其他触发器将以任意顺序触发，因此如果您有超过 3 个特定操作的触发器，您将无法确定性地控制事件顺序。

如果这些考虑都不适用，那么这只是一个偏好问题。

当然，不用说使用触发器执行此操作的规范很糟糕。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-03T19:17:52.493

我同意@RandyMinder。但是，我会更进一步。触发器不是处理这种情况的正确方法。您描述的逻辑对于触发机制来说太复杂了。

您应该在存储过程中包装插入/更新/删除。这些存储过程可以管理业务逻辑和日志记录等。此外，它们使正在发生的事情变得显而易见。调用存储过程的存储过程链是显式的。调用触发器的触发器链由不显式调用触发器的插入/更新/删除语句确定。

触发器的问题在于它们在不同的表之间引入了依赖关系和锁定，并且解开依赖关系可能是一场噩梦。同样，当问题可能位于触发器调用触发器调用存储过程调用触发器时，确定性能瓶颈可能是一场噩梦。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-03-10T01:57:50.727

如果您使用 Microsoft SQL Server 并且能够修改执行 DML 语句的代码，则可以使用[OUTPUT 子句](https://msdn.microsoft.com/en-us/library/ms177564(v=sql.110).aspx)将更新、插入、删除的值转储到临时表或内存变量中，而不是触发器中。这将使性能损失降到最低。

# excel - excel公式：结束日期-今天的日期加上另一个变量

> ID：14145452
> 
> 赞同：1
> 
> 时间：2013-01-03T19:06:26.653
> 
> 标签：excel, excel-formula, excel-2010

我需要一个 excel 公式来计算一个单元格的剩余总天数：结束日期减去今天的日期加上延期天数（可能 30-90 的金额在一个单元格中）我已经`=days360(today's date,end date + number of extension days)`在不同的单元格中尝试过，但它没有给我正确的全部的

它给了我错误的天数。我也有一个计算结束日期的公式，是否会导致问题`=SUM(start date+90+#of extension days)`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T19:20:28.443

一个可能的原因可能是您对`DAYS360`公式的使用。这使用 360 天日历并假设所有月份都是 30 天。因此，如果您覆盖的范围会产生影响，您会看到不同之处。例如，范围`1/1/2013`为`6/1/2013`，减去两个日期返回`31+28+31+30+31 = 151`，与 相比`DAYS360`，返回`30*5 = 150`。

尝试只做基本的减法，这也适用于日期：

```
=<End Date> - TODAY() + <Extension> 
```

# entity-framework - 使用 Automapper，将 DTO 映射回实体框架，包括引用的实体

> ID：14145454
> 
> 赞同：12
> 
> 时间：2013-01-03T19:06:38.733
> 
> 标签：entity-framework, asp.net-web-api, automapper, dto, navigation-properties

我有使用 Entity Framework 5 持久化的 POCO 域实体。它们是使用存储库模式从 DbContext 获得的，并通过 UoW 模式暴露给 RESTful MVC WebApi 应用程序。POCO 实体是代理并且是延迟加载的。

在将实体发送给客户之前，我将它们转换为 DTO。我正在使用 Automapper 来执行此操作，并且 Automapper 将代理 POCO 映射到 DTO 似乎可以正常工作，从而保持导航属性不变。我为此使用以下映射：

```
 Mapper.CreateMap<Client, ClientDto>(); 
```

域/DTO 对象示例：

```
[Serializable]
public class Client : IEntity
{
    public int Id { get; set; }

    [Required, MaxLength(100)]
    public virtual string Name { get; set; }

    public virtual ICollection<ClientLocation> ClientLocations { get; set; }

    public virtual ICollection<ComplianceRequirement> DefaultComplianceRequirements { get; set; }

    public virtual ICollection<Note> Notes { get; set; }
}

public class ClientDto : DtoBase
{
    public int Id { get; set; }

    [Required, MaxLength(100)]
    public string Name { get; set; }

    public ICollection<ClientLocation> ClientLocations { get; set; }

    public ICollection<ComplianceRequirementDto> DefaultComplianceRequirements { get; set; }

    public ICollection<Note> Notes { get; set; }
} 
```

现在我正在尝试使用从线路发送回来的 DTO 更新我的上下文。我在让导航属性/相关实体正常工作方面遇到了具体问题。我正在使用的映射是：

```
 Mapper.CreateMap<ClientDto, Client>()
        .ConstructUsing((Func<ClientDto, Client>)(c => clientUow.Get(c.Id))); 
```

上面，clientUow.Get() 引用 DbContext.Set.Find() 以便我从 EF 获取跟踪的代理 POCO 对象（它包含所有相关实体也作为代理）。

在我的控制器方法中，我正在执行以下操作：

```
 var client = Mapper.Map<ClientDto, Client>(clientDto);
    uow.Update(client); 
```

客户端成功映射为代理 POCO 对象，但是它的相关实体/导航属性被替换为具有从 DTO 复制的属性值的新（非代理）POCO 实体。

上面， uow.Update() 基本上是指一个执行持久逻辑的函数，我有：

```
 _context.Entry<T>(entity).State = System.Data.EntityState.Modified;
    _context.SaveChanges(); 
```

上述内容甚至不会持久存在实体，更不用说相关实体了。我已经尝试了映射的变体和使用分离/状态进行持久化的不同方法，但总是得到“ObjectStateManager 中已经存在具有相同键的对象”异常。

我已经查看了无数其他线程，但无法完全使用 Automapper。我可以从上下文中获取代理对象并手动通过从 DTO 更新它们的属性，但是我使用 Automapper 映射域 - > DTO，使用它来做相反的事情会更优雅，因为我的 DTO在很大程度上类似于我的域对象。

是否有教科书式的方法来处理带有 EF 的 Automapper，域对象/DTO 具有也需要同时更新的导航属性？

**更新：**

```
 var originalEntity = _entities.Find(entity.Id);
    _context.Entry<T>(originalEntity).State = System.Data.EntityState.Detached;
    _context.Entry<T>(entity).State = System.Data.EntityState.Modified; 
```

上述持久性逻辑更新上下文中的“根”EF 代理对象，但不会更新任何相关实体。我猜这是因为它们没有被映射到 EF 代理对象，而是被映射到普通域对象。帮助将不胜感激！

**更新：** 使用当前版本的 EF(5) 似乎我想要实现的目标实际上是不可能的，这是 EF 的核心限制，与 Automapper 无关：

[关联](https://stackoverflow.com/questions/3635071/update-relationships-when-saving-changes-of-ef4-poco-objects/3635326#3635326)

[关联](https://stackoverflow.com/questions/11078126/disconnected-behavior-of-entity-framework-when-updating-object-graph)

我想它又回到了手动操作。希望这可以帮助其他想知道的人。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-29T22:46:20.027

您已经确定了问题：

> 上述持久性逻辑更新上下文中的“根”EF 代理对象，但是任何相关实体都不会更新

您仅在根节点上设置修改状态。您必须编写代码来遍历所有对象并将状态设置为已修改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-09-05T02:45:50.873

您要做的是首先从数据库中获取实体：

```
var centity = _context.Client.First(a=>a.Id = id) 
```

然后你映射这个并更新（这是你要找的，它只会映射它在 inputDTO 中找到的东西，而不理会其他属性）

```
Mapper.Map<UpdateClientInput,  Client>(inputDto, centity);
_context.update(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-07T21:27:57.143

我实现了一个模式来使用 EF 处理这种层次结构模型状态。

每个实体模型类都实现了一个如下所示的接口，视图模型类也是如此：

```
public interface IObjectWithState
{
    ObjectState ObjectState { get; set; }
} 
```

ObjectState 枚举定义如下：

```
public enum ObjectState
{
    Unchanged  = 0,
    Added = 1,
    Modified = 2,
    Deleted = 3
} 
```

例如，当使用 EF 保存对象的深层层次结构时，我将视图模型对象映射到它们的等效实体对象，包括 ObjectState。

然后我将根实体对象附加到上下文（以及所有子对象）：

```
dbContext.MyCustomEntities.Attach(rootEntityObj); 
```

然后我在 DbContext 上有一个扩展方法，它循环遍历上下文更改跟踪器中的所有项目并更新每个实体的状态（如您在上面所做的那样）。

```
 public static int ApplyStateChanges(this DbContext context)
    {
        int count = 0;
        foreach (var entry in context.ChangeTracker.Entries<IObjectWithState>())
        {
            IObjectWithState stateInfo = entry.Entity;
            entry.State = ConvertState(stateInfo.ObjectState);
            if (stateInfo.ObjectState != ObjectState.Unchanged)
                count++;
        }
        return count;
    } 
```

然后我们可以像往常一样简单地保存更改：

```
dbContext.SaveChanges(); 
```

这样，所有子对象的层次结构将在数据库中相应更新。

# python - Python - 将负小数从字符串转换为浮点数

> ID：14145460
> 
> 赞同：1
> 
> 时间：2013-01-03T19:07:04.340
> 
> 标签：python, string, decimal

我需要读取大量 .txt 文件，每个文件都包含一个小数（有些是正数，有些是负数），并将它们附加到 2 个数组（基因型和表型）中。随后，我希望在 scipy 中对这些数组执行一些数学运算，但是负号（'-'）会导致问题。具体来说，我无法将数组转换为浮点数，因为“-”被读取为字符串，导致以下错误：

```
ValueError: could not convert string to float: 
```

这是我目前编写的代码：

```
import linecache

gene_array=[]
phen_array=[]

for i in genotype:

   for j in phenotype:

      genotype='/path/g.txt'
      phenotype='/path/p.txt'

      g=linecache.getline(genotype,1)
      p=linecache.getline(phenotype,1)

      p=p.strip()
      g=g.strip()

      gene_array.append(g)
      phen_array.append(p)

  gene_array=map(float,gene_array)
  phen_array=map(float,phen_array) 
```

在这一点上，我相当确定这是导致问题的负号，但我不清楚为什么。我使用 Linecache 是这里的问题吗？有没有更好的替代方法？

的结果

```
print gene_array 
```

是

```
['-0.0448022516321286', '-0.0236187263814157', '-0.150505384829925', '-0.00338459268479522', '0.0142429109897682', '0.0286253352284279', '-0.0462358095345649', '0.0286232317578776', '-0.00747425206137217', '0.0231790239373428', '-0.00266935581919541', '0.00825077426011094', '0.0272744527203547', '0.0394829854063242', '0.0233109171715023', '0.165841084392078', '0.00259693465334536', '-0.0342590874424289', '0.0124600520095644', '0.0713627590092807', '-0.0189374898081401', '-0.00112750710611284', '-0.0161387333242288', '0.0227226505624106', '0.0382173405035751', '0.0455518646388402', '-0.0453048799717046', '0.0168570746329513'] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T19:14:35.707

从您的错误消息中可以看出，问题似乎与空字符串或空格有关

```
ValueError: could not convert string to float: 
```

为了使它工作，将地图转换为列表理解

```
gene_array=[float(e) for e in gene_array if e]
phen_array=[float(e) for e in phen_array if e] 
```

通过空字符串表示

`float(" ")`or`float("")`会给出值错误，因此如果其中的任何项目`gene_array`或`phen_array`有空间，这将在转换为浮点数时引发错误

空字符串可能有很多原因，例如

*   空行或空行
*   开头或结尾的空行

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T19:10:33.803

错误消息中没有任何内容表明这`-`是问题所在。最可能的原因是`gene_array`和/或`phen_array`包含一个空字符串 ( `''`)。

如文档中所述，`linecache.getline()`

> 将返回`''`错误（找到的行将包含终止换行符）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-03T19:11:59.227

这个问题绝对不是负面的。Python 可以毫无问题地转换带有负号的字符串。我建议您针对浮动 RegEx 运行每个条目，看看它们是否都通过了。

# android - 新的 Facebook 应用程序中使用的“部分”视图是如何实现的？

> ID：14145464
> 
> 赞同：0
> 
> 时间：2013-01-03T19:07:08.840
> 
> 标签：android, android-view

我正在尝试创建一个应用程序，当用户在列表视图中按下一个项目时，它会打开一个新的部分视图，其中包含有关该项目的信息。我想以一种看起来像 Facebook 开发团队在他们的评论部分所做的那样来实现它：

![在此处输入图像描述](../Images/61bd7077179819cfb1c0aae88e16d658.png)

我的问题是：我该如何实现这一目标？我想要的只是打开一个只占用部分屏幕的新视图，如上图所示。

# xml - 使用 XSL 从 XML 中进行选择

> ID：14145467
> 
> 赞同：1
> 
> 时间：2013-01-03T19:07:20.860
> 
> 标签：xml, xslt

不知道如何正确命名主题来指定我的问题 :) 我的 XML 数据库如下所示：

```
<data>
<prices>
<ROW>
<COLUMN NAME="product_id">00932932</COLUMN>
<COLUMN NAME="price">56</COLUMN>
... some other not irrelevant columns
</ROW>
... other rows with the same columns
</prices>
</data> 
```

我正在尝试选择价格高于 30 的那些并将它们涂成绿色。但它将所有价格标记为绿色，就好像条件对所有价格都是真实的。条件如下所示：

```
<xsl:if test='/data/prices/ROW[COLUMN[@NAME="price"] &gt; 30]' >
<span style="color: green"><xsl:value-of select='/data/prices/ROW[COLUMN[@NAME="EXPIRATION_DATE"]="" and COLUMN[@NAME="PRODUCT_ID"]=current()/COLUMN[@NAME="PRODUCT_ID"] ]/COLUMN[@NAME="PRICE"]'/></span>
</xsl:if>
<xsl:if test='/data/prices/ROW[COLUMN[@NAME="PRICE"] &lt; 30]' >
<xsl:value-of select='/data/prices/ROW[COLUMN[@NAME="EXPIRATION_DATE"]="" and COLUMN[@NAME="PRODUCT_ID"]=current()/COLUMN[@NAME="PRODUCT_ID"] ]/COLUMN[@NAME="PRICE"]'/>
</xsl:if> 
```

任何帮助，将不胜感激 ：）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T19:53:21.727

问题可能是您的 xsl:if 正在测试是否**有任何**ROW 行的价格大于 30，无论您当前的上下文是什么（即无论您当前位于哪个 ROW）。xpath 表达式开头的 / 表示您从文档节点开始搜索，而不是从当前节点开始。

假设您正在使用模板选择所有行，就像这样（或者您正在执行**xsl:for-each**

```
<xsl:apply-templates select="ROW"> 
```

然后，在与 ROW 匹配的模板中，您将编写**xsl:if**这样的代码

```
<xsl:if test='COLUMN[@NAME="price"] &gt; 30'> 
```

这是一个 XSLT 的小示例来演示

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
   <xsl:template match="/data/prices">
      <table>
      <xsl:apply-templates select="ROW" />
      </table>
   </xsl:template>

   <xsl:template match="ROW">
      <tr>
         <xsl:if test="COLUMN[@NAME='price'] &gt; 30">
            <xsl:attribute name="style">background-color:green</xsl:attribute>
         </xsl:if>
         <td><xsl:value-of select="COLUMN[@NAME='product_id']" /></td>
         <td><xsl:value-of select="COLUMN[@NAME='price']" /></td>
      </tr>
   </xsl:template>   
</xsl:stylesheet> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T19:21:24.827

您的 XPath 表达式与您显示的 XML 不匹配。该`data`元素在 XML 中不可见（为了简单起见，我假设您省略了该元素），但该元素也不可见`ROW`。此外，您需要注意区分大小写 - 即您需要在 XPath 中使用`column`和`name`（小写）（反之亦然）。也一定有其他错误，因为给定的条件对于所有元素都是错误的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-03T19:55:30.213

我的朋友没有展示一切（让我们这样称呼它）。我们必须编写一个脚本来（我朋友之前说过）颜色价格高于 30。这段代码有效。它显示了我们需要的一切：

```
 <xsl:for-each select='/dane/produkty/ROW'>
                    <tr style="border-style: solid">
                        <td style="border-style: solid">
                            <xsl:value-of select='COLUMN[@NAME="ID_PRODUKTU"]'/>
                        </td>
                        <td style="border-style: solid">
                            <xsl:value-of select='COLUMN[@NAME="OPIS"]'/>
                        </td>
                        <td style="border-style: solid">
                        <xsl:if test='/dane/ceny/ROW[COLUMN[@NAME="CENA_CENNIKOWA"] ] ' >
                            <span style="color: green"><xsl:value-of select='/dane/ceny/ROW[COLUMN[@NAME="DATA_WYCOFANIA"]="" and COLUMN[@NAME="ID_PRODUKTU"]=current()/COLUMN[@NAME="ID_PRODUKTU"] ]/COLUMN[@NAME="CENA_CENNIKOWA"]'/></span>
                        </xsl:if>

                        <!--<xsl:if test='/dane/ceny/ROW[COLUMN[@NAME="CENA_CENNIKOWA"] &lt; "31"]' >
                            <xsl:value-of select='/dane/ceny/ROW[COLUMN[@NAME="DATA_WYCOFANIA"]="" and COLUMN[@NAME="ID_PRODUKTU"]=current()/COLUMN[@NAME="ID_PRODUKTU"] ]/COLUMN[@NAME="CENA_CENNIKOWA"]'/>
                        </xsl:if>-->
                        </td>
                    </tr>
                </xsl:for-each> 
```

这将为每个价格着色，但我们必须使用条件。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-04T11:28:07.597

谢谢Dimitre，但它仍然是一样的。所有价格都是绿色的。我正在发布整个代码。我想这样会更好：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output method="html" doctype-public='-//W3C//DTD XHTML 1.0 Strict//EN'doctype-system='http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd'/>
<xsl:template match="/">
    <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
        <head>
            <title>Zadanie 21</title>
            <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
        </head>
        <body>
            <table style="border-style: solid">
                <tr style="border-style: solid">
                    <td style="border-style: solid">ID</td>
                    <td style="border-style: solid">Produkt</td>
                    <td style="border-style: solid">Cena</td>
                </tr>
                <xsl:for-each select='/dane/produkty/ROW'>
                    <tr style="border-style: solid">
                        <td style="border-style: solid">
                            <xsl:value-of select='COLUMN[@NAME="ID_PRODUKTU"]'/>
                        </td>
                        <td style="border-style: solid">
                            <xsl:value-of select='COLUMN[@NAME="OPIS"]'/>
                        </td>
                        <td style="border-style: solid">
                        <xsl:if test='/dane/ceny/ROW[COLUMN[@NAME="CENA_CENNIKOWA"] &gt; 30] ' >
                            <span style="color: green"><xsl:value-of select='/dane/ceny/ROW[COLUMN[@NAME="DATA_WYCOFANIA"]="" and COLUMN[@NAME="ID_PRODUKTU"]=current()/COLUMN[@NAME="ID_PRODUKTU"] ]/COLUMN[@NAME="CENA_CENNIKOWA"]'/></span>
                        </xsl:if>
                        <xsl:if test='/dane/ceny/ROW[COLUMN[@NAME="CENA_CENNIKOWA"] &lt; 31]' >
                            <xsl:value-of select='/dane/ceny/ROW[COLUMN[@NAME="DATA_WYCOFANIA"]="" and COLUMN[@NAME="ID_PRODUKTU"]=current()/COLUMN[@NAME="ID_PRODUKTU"] ]/COLUMN[@NAME="CENA_CENNIKOWA"]'/>
                        </xsl:if>
                        </td>
                    </tr>
                </xsl:for-each>
            </table>
        </body>
    </html>
</xsl:template> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-04T03:35:39.183

回答 matyo35 的回答问题：

> ```
> <xsl:if test='/dane/ceny/ROW[COLUMN[@NAME="CENA_CENNIKOWA"] ] ' >
>  <span style="color: green"><xsl:value-of 
>   select='/dane/ceny/ROW[COLUMN[@NAME="DATA_WYCOFANIA"]="" 
>                        and COLUMN[@NAME="ID_PRODUKTU"]=current()/COLUMN[@NAME="ID_PRODUKTU"] ]
>                                   /COLUMN[@NAME="CENA_CENNIKOWA"]'/></span>
> </xsl:if> 
> ```

**`test`**如果甚至有一个`Row`具有 child 的单个， attributr 中**的条件****总是满足**`COLUMN[@NAME="CENA_CENNIKOWA"]`的，因为表达式是绝对的——它不依赖于模板匹配的当前节点。

**指定条件的正确方法（我猜——由于没有提供 XML 文档）**：

```
<xsl:if test=
  '/dane/ceny/ROW[COLUMN[NAME="ID_PRODUKTU"]=current()/COLUMN[NAME="ID_PRODUKTU"] 
                and COLUMN[@NAME="CENA_CENNIKOWA"] > 30]'> 
```

# javascript - WordPress导致动画溢出

> ID：14145480
> 
> 赞同：0
> 
> 时间：2013-01-03T19:08:02.377
> 
> 标签：javascript, css, html, wordpress, adobe-edge

我正在一个网站上工作，并使用 adobe 边缘动画添加了云流动的动画。

[http://avuedesigns.com/iaq/](http://avuedesigns.com/iaq/)

我在 adobe 社区 (http://forums.adobe.com/thread/1128782) 上创建了一个线程，似乎我的代码使其具有响应性，并且溢出设置正确。

所以基本上我不知道为什么 WordPress 要么破坏它。或者为什么我的一点点代码认为网站比实际更广泛。也许新鲜的眼睛可以看到我没有的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T20:11:29.310

更正您的容器的溢出属性很可能设置为在您的 css 文件中滚动。

将此设置为；

```
overflow: hidden; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T19:44:20.873

好吧，wordpress 只是一个输出 html 的 cms 引擎——这很难怪。我确实看到宽度不断变化，水平滚动条出现和消失，这绝对不是最佳的。

我认为起始位置是主容器 div ......你有溢出：隐藏设置吗？这应该允许您的云出现在可见窗格之外，而不会强制 div 更改宽度。

# java - Creating a GUI application that emulates as Console(Java)

> ID：14145481
> 
> 赞同：0
> 
> 时间：2013-01-03T19:08:12.930
> 
> 标签：java, process, console, external, processbuilder

I've recently started a project where I am required to start a external process from within my parent process. However, since the external process uses System.console(), it is unable to function properly as it is getting a null object in return. Both the external and parent applications are written in java and there is no chance that the external process can be modified in any way (as it is being produced by a third party)

Both the Input and Output streams of the process object are being handled and the stderr stream is being redirected to the output.

My question is: Is there a way to "emulate" a console so that the external sub-process's System.console() call returns a valid console object that is hooked to my primary (parent) application?

Code for process builder below:

```
final ProcessBuilder Builder = new ProcessBuilder("\"" + System.getProperty("java.home") + "\\bin\\java.exe\"", InitMemArg, MaxMemArg, "-jar", "\"" + MCServer.getName() + "\"");
Builder.redirectErrorStream(true); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T19:53:45.510

在您开始第 3 方进程之前，您似乎必须创建一个 Thread 来创建一个[控制台](http://docs.oracle.com/javase/6/docs/api/java/io/Console.html)类，该控制台作为控制台出现在第 3 方应用程序中。

此控制台还必须与您的 GUI 应用程序进行通信。

# javascript - Semantic approach: horizontal navigations tabs aka liteaccordion

> ID：14145483
> 
> 赞同：1
> 
> 时间：2013-01-03T19:08:14.680
> 
> 标签：javascript, html, dom, semantics

I try to make semantic site based on that concept: I have normal nav:

```
<nav>
 <ul>
  <li><a/></li>
  ...
  <li><a/></li>
</nav> 
```

And content in tabs which work together as same as in liteaccordion.

How it works in litecordion(**#2**): Content have to be inside `<li>` but it's not valid. So the pure HTML, before js start has normal:

```
<div class="content"/>
...
<div class="content"/>
<nav/> 
```

structure. On load, JS move every content to the right li tab:

```
<nav>
 <ul>
  <li class="foo content">
   <a/>
   <div class="foo content"/>
  </li>
  ...
  <li class="bar content">
   <a/>
   <div class="bar content"/>
  </li>
</nav> 
```

And then litecordion starts...

But I made some piece of job (**#1** on image) to make it 100% semantic even after JS manipulation. Navigation in there is just on another layer than content div. It detects actual position of tab and set position of appropriate content. But there's a lot of events to calculate.

![enter image description here](../Images/0b3d90764556f3c349fc027dfa824e8e.png)

[Live example](http://jsfiddle.net/respown/UgUaE/), It's complicated and slow and buggy.

So I'm asking is it worth time to create semantic separate navigation and content for users with JS? Do I need to detect some search bots etc. ? The example will use ajax, but for persons/bots without js it will be full semantic.

# java - 服务还是活动？

> ID：14145492
> 
> 赞同：-1
> 
> 时间：2013-01-03T19:08:56.883
> 
> 标签：java, android, service, android-activity

我正在努力决定使用哪个类，活动或服务。我的应用程序很复杂，所以我将使用另一个示例。一个计时器。

我想创建一个应用程序，当我打开应用程序时开始计算秒数，即使单击后退按钮也会继续计数。当我回到应用程序时，它会有一个显示时间的 gui。

所以我猜的 gui 将是活动和计数方法将在服务上.. 但是我如何管理该系统？他们将如何通信？我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T19:15:31.103

您可以使用 BroadcastReceivers 并发送您的活动将要收听的广播，或者您可以使用 Messenger 将消息从服​​务发送到活动

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T19:12:58.307

他们可以与意图进行通信，或通过共享存储或内容提供者，...

# javascript - Smoother touch swipe animation - jQuery or otherwise

> ID：14145493
> 
> 赞同：2
> 
> 时间：2013-01-03T19:09:04.943
> 
> 标签：javascript, jquery, ipad, touch, swipe

I have several dialogs on a web page. The code does its job but is rather jumpy and glitch. I suspect that the code is simply too heavyweight for an ipad.

```
 $(document).on("dialogopen", ".dialogClass", function() {
            console.log("dlg open");
            var parent = $(this).parent();
            //$(this).dialog("option", "width", $(window).width());
            //$(this).dialog("option", "height", $(window).height());
            $(this).dialog("option", "position", [0,0]);
            $(this).dialog("option", "draggable", "false");
            $(this).dialog("option", "width", $(window).width());
            $(this).dialog("option", "height", $(window).height());
            parent.css("width", $(window).width());
            parent.css("height",$(window).height());
            parent.css("position","fixed");
            parent.css("top","0px");
            parent.css('left','-' + $(window).width() + 'px');
            parent.animate({
                    left: 0
            }, speed, "easeOutBounce");
            $(this).swipe({
                    swipeLeft:function(event, direction, distance, duration, fingerCount) {
                            if(distance >= 200){
                                    var dia = $(this);
                                    $(this).parent().animate({
                                            left : -$(window).width()
                                    },speed, "easeInExpo", function(e) {
                                            dia.dialog("close");
                                    });
                            }
                    }
             });

    });

    $(document).on("dialogclose", ".dialogClass", function() {
                    console.log("dlg close");
                    //$(this).dialog("destroy");
                    $(this).swipe("destroy");
                    $(this).swipe({
                            swipeLeft:function(event, direction, distance, duration, fingerCount) {

                                    if(distance >= 150){
                                            var dia = $(this);
                                            $(this).parent().animate({
                                                    left : -$(window).width()
                                            },speed, "easeInExpo", function(e) {
                                                    dia.dialog("close");
                                            });
                                    }

                            }
                    });

    }); 
```

Is jQuery simply not the right tool for handling swipes? I am using the following jQuery library:

[https://github.com/mattbryson/TouchSwipe-Jquery-Plugin](https://github.com/mattbryson/TouchSwipe-Jquery-Plugin)

# android - Facebook authorization issue with SDK 3.0

> ID：14145495
> 
> 赞同：0
> 
> 时间：2013-01-03T19:09:13.403
> 
> 标签：android, facebook, facebook-android-sdk

I have an app for my University and there i have integrated Facebook SDK so that students can post in Facebook.

Recently i decided to make some more tests because of the new SDK that Facebook released. What i found it was that after the Custom Dialog by Facebook Sdk that appears and gives the user infos about the permissions needed, nothing happens.

That pushed me to search the problem deeper. I opened an Emulator and checked it too, after some errors and minutes i managed to make the SSO work. The same code was supposed to work on my device also, but again the problem described above was happening.

Although i had no luck with it. Then it came to my mind to delete the Facebook app from my Phone and try my app again. The SSO worked fine as in the emulator this time.

So i got stucked with a problem and a result after searching. I am completely sure that there is a problem between the authorization when having the Facebook app installed and my app, but i cant find what.

If anyone else has experienced the same problem please share your thoughts and if anyone knows any solution i would be greatfull!

P.S.: Google didn't help me at all. You are my last chance.

My way to connect with Facebook:

```
Session session = Session.openActiveSession(act, true,
            new StatusCallback() {
                public void call(final Session session, SessionState state,
                        Exception exception) {
                    if (session.isOpened()) {
                        Log.d("Session is:", " opened");
                        Request.executeMeRequestAsync(session,
                                new Request.GraphUserCallback() {
                                    public void onCompleted(GraphUser user,
                                            Response response) {
                                        if (user != null) {
//my code goes here                                         

                                        }
                                    }
                                });
                    }
                }
            }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T19:46:28.383

更新

我终于通过更新keyhash解决了。不知道为什么是这个问题，但现在它工作正常！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T17:19:48.583

只是为了方便起见，使用此代码查找 ACTUAL keyhash：

```
PackageInfo info;
try {
info = getPackageManager().getPackageInfo("com.myname.lolo", PackageManager.GET_SIGNATURES);
for (Signature signature : info.signatures) {
           MessageDigest md;
md = MessageDigest.getInstance("SHA");
md.update(signature.toByteArray());
           //String something = new String(Base64.encode(md.digest(), 0));
            * String something = new String(Base64.encodeBytes(md.digest()));
           Log.e("hash key", something);
} 
}
catch (NameNotFoundException e1) {
Log.e("name not found", e1.toString());
}

catch (NoSuchAlgorithmException e) {
Log.e("no such an algorithm", e.toString());
}
catch (Exception e){
Log.e("exception", e.toString());
} 
```

之后您可以删除此代码。以及所有功劳：[Android-Facebook 应用程序的密钥哈希](https://stackoverflow.com/questions/4388992/key-hash-for-android-facebook-app)

# python - looking for ways to profile python process that runs out of RAM on Amazon EC2 Ubuntu instance

> ID：14145496
> 
> 赞同：2
> 
> 时间：2013-01-03T19:09:16.230
> 
> 标签：python, ubuntu, profile

I am running a python process on an Amazon EC2 Ubuntu instance that processes a large data file. Initially everything is going fine and I do not notice any continuous rise in RAM or CPU usage. Then, after processing a part of the input data, the process runs out of memory and dies. `dmesg -T` produces the following, which does not tell me anything:

```
[Thu Jan  3 17:47:27 2013] python invoked oom-killer: gfp_mask=0x280da, order=0, oom_adj=0, oom_score_adj=0
[Thu Jan  3 17:47:27 2013] python cpuset=/ mems_allowed=0
[Thu Jan  3 17:47:27 2013] Pid: 1108, comm: python Not tainted 3.2.0-25-virtual #40-Ubuntu
[Thu Jan  3 17:47:27 2013] Call Trace:
[Thu Jan  3 17:47:27 2013]  [<ffffffff810bdb9d>] ? cpuset_print_task_mems_allowed+0x9d/0xb0
[Thu Jan  3 17:47:27 2013]  [<ffffffff81118231>] dump_header+0x91/0xe0
[Thu Jan  3 17:47:27 2013]  [<ffffffff811185b5>] oom_kill_process+0x85/0xb0
[Thu Jan  3 17:47:27 2013]  [<ffffffff8111895a>] out_of_memory+0xfa/0x220
[Thu Jan  3 17:47:27 2013]  [<ffffffff8111e38a>] __alloc_pages_nodemask+0x7ea/0x800
[Thu Jan  3 17:47:27 2013]  [<ffffffff810063dd>] ? pte_mfn_to_pfn+0x8d/0x110
[Thu Jan  3 17:47:27 2013]  [<ffffffff811569fa>] alloc_pages_vma+0x9a/0x150
[Thu Jan  3 17:47:27 2013]  [<ffffffff8113705c>] do_anonymous_page.isra.38+0x7c/0x2f0
[Thu Jan  3 17:47:27 2013]  [<ffffffff8113acc1>] handle_pte_fault+0x1e1/0x200
[Thu Jan  3 17:47:27 2013]  [<ffffffff8100647e>] ? xen_pmd_val+0xe/0x10
[Thu Jan  3 17:47:27 2013]  [<ffffffff810052d9>] ? __raw_callee_save_xen_pmd_val+0x11/0x1e
[Thu Jan  3 17:47:27 2013]  [<ffffffff8113b098>] handle_mm_fault+0x1f8/0x350
[Thu Jan  3 17:47:27 2013]  [<ffffffff81659f9b>] do_page_fault+0x14b/0x520
[Thu Jan  3 17:47:27 2013]  [<ffffffff811425fd>] ? mprotect_fixup+0x17d/0x2b0
[Thu Jan  3 17:47:27 2013]  [<ffffffff81142920>] ? sys_mprotect+0x1f0/0x250
[Thu Jan  3 17:47:27 2013]  [<ffffffff81656bf5>] page_fault+0x25/0x30
[Thu Jan  3 17:47:27 2013] Mem-Info:
[Thu Jan  3 17:47:27 2013] Node 0 DMA per-cpu:
[Thu Jan  3 17:47:27 2013] CPU    0: hi:    0, btch:   1 usd:   0
[Thu Jan  3 17:47:27 2013] Node 0 DMA32 per-cpu:
[Thu Jan  3 17:47:27 2013] CPU    0: hi:  186, btch:  31 usd:   0
[Thu Jan  3 17:47:27 2013] active_anon:142435 inactive_anon:14 isolated_anon:0
[Thu Jan  3 17:47:27 2013]  active_file:0 inactive_file:11 isolated_file:0
[Thu Jan  3 17:47:27 2013]  unevictable:0 dirty:0 writeback:0 unstable:0
[Thu Jan  3 17:47:27 2013]  free:1389 slab_reclaimable:1528 slab_unreclaimable:1686
[Thu Jan  3 17:47:27 2013]  mapped:2 shmem:45 pagetables:793 bounce:0
[Thu Jan  3 17:47:27 2013] Node 0 DMA free:2460kB min:72kB low:88kB high:108kB active_anon:12296kB inactive_anon:0kB active_file:0kB inactive_file:0kB unevictable:0kB isolated(anon):0kB isolated(file):0kB present:14524kB mlocked:0kB dirty:0kB writeback:0kB mapped:0kB shmem:0kB slab_reclaimable:8kB slab_unreclaimable:0kB kernel_stack:0kB pagetables:16kB unstable:0kB bounce:0kB writeback_tmp:0kB pages_scanned:0 all_unreclaimable? yes
[Thu Jan  3 17:47:27 2013] lowmem_reserve[]: 0 597 597 597
[Thu Jan  3 17:47:27 2013] Node 0 DMA32 free:3096kB min:3088kB low:3860kB high:4632kB active_anon:557444kB inactive_anon:56kB active_file:0kB inactive_file:44kB unevictable:0kB isolated(anon):0kB isolated(file):0kB present:611856kB mlocked:0kB dirty:0kB writeback:0kB mapped:8kB shmem:180kB slab_reclaimable:6104kB slab_unreclaimable:6744kB kernel_stack:1024kB pagetables:3156kB unstable:0kB bounce:0kB writeback_tmp:0kB pages_scanned:27445 all_unreclaimable? yes
[Thu Jan  3 17:47:27 2013] lowmem_reserve[]: 0 0 0 0
[Thu Jan  3 17:47:27 2013] Node 0 DMA: 1*4kB 2*8kB 1*16kB 0*32kB 0*64kB 1*128kB 1*256kB 0*512kB 0*1024kB 1*2048kB 0*4096kB = 2468kB
[Thu Jan  3 17:47:27 2013] Node 0 DMA32: 151*4kB 10*8kB 23*16kB 0*32kB 0*64kB 0*128kB 0*256kB 0*512kB 0*1024kB 1*2048kB 0*4096kB = 3100kB
[Thu Jan  3 17:47:27 2013] 55 total pagecache pages
[Thu Jan  3 17:47:27 2013] 0 pages in swap cache
[Thu Jan  3 17:47:27 2013] Swap cache stats: add 0, delete 0, find 0/0
[Thu Jan  3 17:47:27 2013] Free swap  = 0kB
[Thu Jan  3 17:47:27 2013] Total swap = 0kB
[Thu Jan  3 17:47:27 2013] 159472 pages RAM
[Thu Jan  3 17:47:27 2013] 8383 pages reserved
[Thu Jan  3 17:47:27 2013] 261 pages shared
[Thu Jan  3 17:47:27 2013] 149349 pages non-shared
[Thu Jan  3 17:47:27 2013] [ pid ]   uid  tgid total_vm      rss cpu oom_adj oom_score_adj name
[Thu Jan  3 17:47:27 2013] [  238]     0   238     4306       47   0       0             0 upstart-udev-br
[Thu Jan  3 17:47:27 2013] [  242]     0   242     5396      119   0     -17         -1000 udevd
[Thu Jan  3 17:47:27 2013] [  287]     0   287     5362       99   0     -17         -1000 udevd
[Thu Jan  3 17:47:27 2013] [  288]     0   288     5362       99   0     -17         -1000 udevd
[Thu Jan  3 17:47:27 2013] [  361]     0   361     3795       48   0       0             0 upstart-socket-
[Thu Jan  3 17:47:27 2013] [  419]     0   419     1814      123   0       0             0 dhclient3
[Thu Jan  3 17:47:27 2013] [  643]     0   643    12487      151   0     -17         -1000 sshd
[Thu Jan  3 17:47:27 2013] [  657]   101   657    63427      102   0       0             0 rsyslogd
[Thu Jan  3 17:47:27 2013] [  663]   102   663     5981       89   0       0             0 dbus-daemon
[Thu Jan  3 17:47:27 2013] [  725]     0   725     3624       42   0       0             0 getty
[Thu Jan  3 17:47:27 2013] [  732]     0   732     3624       41   0       0             0 getty
[Thu Jan  3 17:47:27 2013] [  741]     0   741     3624       42   0       0             0 getty
[Thu Jan  3 17:47:27 2013] [  743]     0   743     3624       41   0       0             0 getty
[Thu Jan  3 17:47:27 2013] [  747]     0   747     3624       41   0       0             0 getty
[Thu Jan  3 17:47:27 2013] [  755]     0   755     1080       37   0       0             0 acpid
[Thu Jan  3 17:47:27 2013] [  756]     0   756     4776       50   0       0             0 cron
[Thu Jan  3 17:47:27 2013] [  757]     0   757     4225       39   0       0             0 atd
[Thu Jan  3 17:47:27 2013] [  787]     0   787     3624       41   0       0             0 getty
[Thu Jan  3 17:47:27 2013] [  790]   103   790    46895      300   0       0             0 whoopsie
[Thu Jan  3 17:47:27 2013] [  797]     0   797    20467      216   0       0             0 sshd
[Thu Jan  3 17:47:27 2013] [  800]     0   800   146074      260   0       0             0 console-kit-dae
[Thu Jan  3 17:47:27 2013] [  867]     0   867    46645      154   0       0             0 polkitd
[Thu Jan  3 17:47:27 2013] [  983]  1000   983    20467      213   0       0             0 sshd
[Thu Jan  3 17:47:27 2013] [  984]  1000   984     6557     1766   0       0             0 bash
[Thu Jan  3 17:47:27 2013] [ 1108]  1000  1108   163815   138085   0       0             0 python
[Thu Jan  3 17:47:27 2013] Out of memory: Kill process 1108 (python) score 915 or sacrifice child
[Thu Jan  3 17:47:27 2013] Killed process 1108 (python) total-vm:655260kB, anon-rss:552336kB, file-rss:4kB 
```

Is there a way to profile the process to figure out what's going on and what causes the sudden surge in RAM usage? Thx

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T19:26:28.213

我曾经`Dowser`在我的一个项目中帮助追踪内存使用情况。它作为一个简单的 Web 界面运行，并生成大量信息，帮助您追踪问题。

[Dowser 博客举了一个例子。](http://www.aminus.org/blogs/index.php/2008/06/11/tracking-memory-leaks-with-dowser?blog=2)

[探寻者维基](http://www.aminus.net/wiki/Dowser)

# coffeescript - How to use read and write for knockout computed property in coffescript

> ID：14145498
> 
> 赞同：0
> 
> 时间：2013-01-03T19:09:15.550
> 
> 标签：coffeescript, knockout-2.0

I will highly appreciate any help. I can't write properly read & write for computed property in CoffeeScript.

```
@allChecked = ko.computed => {
  read: ()->
    console.log 'allChecked->read()'
    firstUnchecked = ko.utils.arrayFirst @contactGroups(), (item) ->
                      item.IsSelected() == false
    firstUnchecked == null
  write: (value)->
    console.log 'allChecked->write()', value
    g.IsSelected(value) for g in @contactGroups()
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T19:14:57.937

我只是在这里盲目猜测，因为我无权访问您的其余代码。

# 第一的

`ko.computed`接受一个读取函数，或者接受一个具有`read`和`write`函数的对象。它不需要返回带有`read`/`write`属性的对象的函数。

***例子***

**对**：`ko.computed -> 5`

**对**：`ko.computed { read: -> 5 }`

**错误**：`ko.computed -> { read: -> 5 }`

# 第二

`@`严格表示`this`，这意味着根据函数的调用方式（`f()`、`f.apply(_)`、`new F()`），它可能具有不同的值。如果要`this`指定 的值，可以`owner`在创建时指定`ko.computed`。

```
computed = ko.computed {
  read: -> @getValue()
  owner: @
} 
```

***例子***

**好的**

```
class Thing
  constructor: (@number) ->
    self = @
    ko.computed -> self.number 
```

**高威**

```
class Thing
  constructor: (@number) ->
    ko.computed {
      read: -> @number
      owner: @
    } 
```

**坏的**

```
class Thing
  constructor: (@number) ->
    ko.computed -> @number # means this.number 
```

**令人困惑** *（=>）*

```
class Thing
  constructor: (@number) ->
    ko.computed => @number 
```

# 最后

把它们放在一起。

***例子***

```
@allChecked = ko.computed {
  read: ->
    console.log 'allChecked->read()'
    firstUnchecked = ko.utils.arrayFirst @contactGroups(), (item) ->
                      item.IsSelected() == false
    firstUnchecked == null

  write: (value) ->
    console.log 'allChecked->write()', value
    group.IsSelected(value) for group in @contactGroups()

  owner: @
} 
```

# inkscape - How to enable Inkscape experimental LPE (Powerstroke) in Ubuntu

> ID：14145500
> 
> 赞同：1
> 
> 时间：2013-01-03T19:09:28.490
> 
> 标签：inkscape

I stumbled upon the Powerstroke experimental LPE for Inkscape and really want to try it out, but I cannot find the means to do it. [This](http://wiki.inkscape.org/wiki/index.php/PowerStroke) article states:

```
To test the LPE, Inkscape must be built with experimental LPE's enabled.
You have to build Inkscape with

 #define LPE_ENABLE_TEST_EFFECTS

otherwise the LPE won't show in the LPE dialog.
(uncommenting line 9 in src/live_effects/effect.cpp will do the trick) 
```

However, I cannot find the effect.cpp file, nor any other means to enable experimental LPEs. Does anybody know how to do this?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T21:27:28.347

我想我能够安装包含最新实验的 Inkscape 开发者版本。我只是按照这里的描述：[https ://launchpad.net/~inkscape.dev/+archive/trunk](https://launchpad.net/~inkscape.dev/+archive/trunk)

# postgresql - 从保存列名的变量中引用记录的列

> ID：14145503
> 
> 赞同：1
> 
> 时间：2013-01-03T19:09:52.113
> 
> 标签：postgresql, plpgsql, dynamic-sql

在*plpgsql*语言的函数中，并具有：

1.  `"col" CHARACTER VARYING = 'a';`（可以`'b'`）
2.  `"rec" RECORD;`持有记录来自：`(SELECT 1 AS "a", 2 AS "b")`
3.  `"res" INTEGER;`

`"col"`我需要从中引用命名列`"rec"`。所以如果`"col"`有`'b'`我会引用`"rec"."b"`，然后将其值保存到`"res"`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T22:59:57.023

您不能在 plpgsql 中按名称引用*匿名记录类型的列。*即使您在`SELECT`语句中的示例中拼出列别名，这些也只是噪音并被丢弃。

如果要按名称引用记录类型的元素，则需要使用众所周知的类型。创建并使用一个类型：

```
CREATE TYPE my_composite_type(a int, b int); 
```

或者使用与任何现有表关联的行类型。您可以将表名写为数据类型。

```
DECLARE
   rec my_composite_type;
... 
```

然后你需要一个*条件语句*或*动态 SQL*来使用作为标识符的*值*。`"col"`

条件语句：

```
IF col = 'a' THEN
   res := rec.a;
ELSIF col = 'b' THEN
   res := rec.b;
ELSE
   RAISE EXCEPTION 'Unexpected value in variable "col": %', col;
END IF; 
```

对于两种可能的情况，这就是要走的路。
或动态 SQL：

```
EXECUTE 'SELECT $1.' || col
INTO res
USING rec; 
```

我在这里没有看到问题，但要小心使用动态 SQL 进行 SQL 注入。如果`col`可以保存任意数据，则需要使用[`quote_ident()`or转义它`format()`](http://www.postgresql.org/docs/current/interactive/functions-string.html)

### 演示

使用动态 SQL 演示更强大但也更复杂的变体。

创建（临时！）已知类型进行测试的快速而肮脏的方法：

```
CREATE TEMP TABLE rec_ab(a int, b int); 
```

功能：

```
CREATE OR REPLACE FUNCTION f_test()
  RETURNS integer AS
$func$
DECLARE
    col   text := 'a';  -- can be 'b'
    rec   rec_ab;
    res   int;
BEGIN
    rec := '(1, 2)'::rec_ab;

    EXECUTE 'SELECT $1.' || col
    INTO res
    USING rec;

    RETURN res;
END
$func$
  LANGUAGE plpgsql VOLATILE; 
```

称呼：

```
SELECT f_test(); 
```

回报：

```
f_test
----
1 
```

# javascript - Using jQuery Mobile, onclick not triggering with PhoneGap on Android

> ID：14145505
> 
> 赞同：0
> 
> 时间：2013-01-03T19:10:04.657
> 
> 标签：javascript, jquery, cordova, jquery-mobile, jquery-validate

I'm using jquery.validate.js with a multipage jquery mobile app. I'm using onclick= to validate each page/form before moving on to the next page. This works correctly in iOS and Android when accessed in the browser. But when I package with PhoneGap, the next button in my footer is dead/does nothing. I'm guessing its an issue with the onclick. I tried a couple solutions form here: [PhoneGap build + jquerymobile: onclick on button does not work](https://stackoverflow.com/questions/9956014/phonegap-build-jquerymobile-onclick-on-button-does-not-work) and here: [https://forum.jquery.com/topic/jquery-mobile-on-phone-gap-for-android](https://forum.jquery.com/topic/jquery-mobile-on-phone-gap-for-android) without success. A relevant sample of my html is below.

What do I do to make those links work with Android/PhoneGap? I'd like to keep them as href's rather than buttons.

Thanks!

```
<div id="info" data-role="page" data-theme="c">
<div data-role="content">

<script>
    function infoval(){ 
        if (!$("#infofm").valid()) {
            alert("Please fill in all fields on this page before proceding");
        } else {
            $.mobile.changePage('#towertop', {transition: 'slidefade'});
        }
    };
    function towertopval(){ 
        if (!$("#towertopfm").valid()) {
            alert("Please select 'Yes' 'No' or 'N/A' for each item before proceding");
        } else {
            $.mobile.changePage('#towerground', {transition: 'slidefade'});
        }
    };
</script>

<form id="infofm" encoding="multipart/form-data" encType="multipart/form-data">
<input type="text" placeholder="Your First & Last Name" class="required" name="_fid_14" id="_fid_14" />
</form>
<div data-role="footer" data-id="myfoot" data-position="fixed"><div data-role="navbar">
<ul><li></li>
<li><a href="#start" data-iconpos="bottom" data-theme="e" data-transition="pop" data-icon="back" data-rel="dialog">Start Over</a></li>
<li><a href="" data-iconpos="bottom" data-theme="a" data-icon="arrow-r" onclick="infoval();">Next Step</a></li></ul></div></div>
</div></div>

<div id="towertop" data-role="page" data-theme="c">
<div data-role="content">
<form id="towertopfm" encoding="multipart/form-data" encType="multipart/form-data">
<div data-role="fieldcontain"><p><a href="" data-reveal-id="16pop" data-animation="none">Azimuth Verification</a></p><fieldset data-role="controlgroup" data-type="horizontal"><input id="_fid_16_a" type="radio" name="_fid_16" value="Yes" class="required"/><label for="_fid_16_a">Yes</label><input id="_fid_16_b" type="radio" name="_fid_16" value="No"/><label for="_fid_16_b">No</label><input id="_fid_16_c" type="radio" name="_fid_16" value="N/A"/><label for="_fid_16_c">N/A</label></fieldset>
<p><textarea placeholder="Comments" name="_fid_17" id="_fid_17" rows="6" /></textarea></p></div>
</form>
<div data-role="footer" data-id="myfoot" data-position="fixed"><div data-role="navbar">
<ul><li><a href="#info" data-iconpos="bottom" data-theme="a" data-transition="slidefade" data-direction="reverse" data-icon="arrow-l">Previous Step</a></li>
<li><a href="#start" data-iconpos="bottom" data-theme="e" data-transition="pop" data-icon="back" data-rel="dialog">Start Over</a></li>
<li><a href="" data-iconpos="bottom" data-theme="a" data-icon="arrow-r" onclick="towertopval();">Next Step</a></li></ul></div></div>
</div></div>

<script>
$(document).ready( function(){
    $("#infofm").validate({ errorPlacement: function(error, element) {} });
    $("#towertopfm").validate({ errorPlacement: function(error, element) {} });
    $("#towergroundfm").validate({ errorPlacement: function(error, element) {} });
    $("#cabaavfm").validate({ errorPlacement: function(error, element) {} });
    $("#sigemailfm").validate({ errorPlacement: function(error, element) {} });
});
</script> 
```

This is the order of scripts in my header:

```
<script src="jquery-1.8.2.min.js"></script>
<script src="jquery.mobile.min.js"></script>
<script type="text/javascript" src="sisyphus.min.js"></script>
<script type="text/javascript" src="jquery.reveal.js"></script>
<script src="jSignature.js"></script>
<script type="text/javascript" src="date.format.js"></script>
<script type="text/javascript" src="jquery.validate.min.js"></script>
<script src="phonegap.js"></script> 
```

UPDATE: I also tried this:

```
<script>
    $(function(){
        $('#nxt1').click(function(){
            infoval();
        });
        $('#nxt2').click(function(){
            towertopval();
        });
    });
</script> 
```

With this:

```
<div data-role="footer" data-id="myfoot" data-position="fixed"><div data-role="navbar">
<ul><li></li>
<li><a href="#start" data-iconpos="bottom" data-theme="e" data-transition="pop" data-icon="back" data-rel="dialog">Start Over</a></li>
<li><a href="" id="nxt1" data-iconpos="bottom" data-theme="a" data-icon="arrow-r">Next Step</a></li></ul></div> 
```

With the same result - works in browser, but not after packaged with PhoneGap.

# mysql - Why having each column only in a single index in MySQL and does the order of columns in the query matter?

> ID：14145506
> 
> 赞同：3
> 
> 时间：2013-01-03T19:10:07.233
> 
> 标签：mysql, indexing, query-optimization

I very often search the table `posts` for values in the columns `user`+`status` and `user`+`time`.

```
SELECT * FROM `posts` WHERE `user`='xxx' and `status`='active'
SELECT * FROM `posts` WHERE `user`='xxx' and `time`>... 
```

Thus I have set up two indices (user, status) and (user, time)

I'm aware, that writing processes are slowed down the more indices need to be updated. But I think in this case it is useful to have both indices, since reading operations outnumber writing operations by far.

Anyway, PHPMyAdmin gives a Warning saying "More than one index has been created for the column user". Can I just ignore this warning? I checked the Wordpress DB tables and saw that they have put a column at the second position, if it already had an index.

```
comment_approved_date_gmt = INDEX(comment_approved, comment_date_gmt)
comment_date_gmt = INDEX(comment_date_gmt) 
```

Why don't they use only one two column index (INDEX(comment_date_gmt, comment_approved)), that would save INDEX(comment_date_gmt)? and why is it disadvantageous to have two indices starting with the same column-name?

Is there a general rule, which column should go first in my query? For example the one with the lowest number of different entries (e.G. status) and afterwards the one with a higher number of different values (e.g. user names)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T19:20:22.747

**是的，索引中列的顺序很重要。**

想一个电话簿的类比。这就像 (last_name, first_name) 上的索引。按姓氏查找一个人，您可以使用电话簿的排序顺序来帮助您快速找到他们。

但如果你只知道这个人的名字，他们就会散布在整本书中。要找到一本，您必须逐页搜索这本书。

**是的，索引可能是多余的。**

任何搜索 last_name 的查询都可以在 (last_name) 上使用单列索引，或者它可以从 (last_name, first_name) 上的两列索引中获得相同的好处。那么为什么要创建两个索引呢？

有一个工具[pt-duplicate-key-checker](http://www.percona.com/doc/percona-toolkit/pt-duplicate-key-checker.html)可以帮助您识别冗余索引。我从来没有遇到过没有至少几个这样的索引的数据库。

**phpMyAdmin 是错误的。**

如果 phpMyAdmin 对索引 (user, status) 和 (user, time) 发出警告，那么它就过于热心了，因为这些索引彼此之间*不是*冗余的。基本上，如果一个索引的列包含另一个索引中列的*左前缀*，则该索引是冗余的。因此，索引 (A) 相对于索引 (A, B) 是冗余的，但索引 (A, C) 与 (A, B) 不同，并且两者都可能被不同的查询使用。

PS：我在演示[如何设计索引中涵盖了这些要点，真的](http://www.slideshare.net/billkarwin/how-to-design-indexes-really)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T19:15:54.127

我觉得 SQL 查询中的列排序是一种过早的优化，根据 Knuth 的说法，这是万恶之源。您应该为维护而不是优化而编程，并让优化器负责速度。

# c# - FtpWebRequest download text file: CR/LF removed

> ID：14145512
> 
> 赞同：0
> 
> 时间：2013-01-03T19:10:50.463
> 
> 标签：c#, ftpwebrequest

I am using `FtpWebRequest` to download files, but in all text files all `\r\n` are removed when downloaded.

What am I doing wrong?

```
Uri u = new Uri(msg);
FtpWebRequest request = (FtpWebRequest)WebRequest.Create(u);

request.Method = WebRequestMethods.Ftp.DownloadFile;
request.Credentials = credential;
request.UsePassive = true;
request.UseBinary = true;
request.KeepAlive = false;

//Get a reponse
WebResponse response = request.GetResponse();
Stream responseStream = response.GetResponseStream();

FileStream localfileStream = new FileStream(destination,
    FileMode.Create, FileAccess.Write);
//create the file
byte[] buffer = new byte[1024];
int bytesRead = responseStream.Read(buffer, 0, 1024);

while (bytesRead != 0)
{
    localfileStream.Write(buffer, 0, bytesRead);
    bytesRead = responseStream.Read(buffer, 0, 1024);
}

localfileStream.Close();
response.Close();
responseStream.Close();. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T19:26:30.610

你的代码是正确的。还有一些你没有告诉的导致问题的东西。我的猜测是

*   a) 服务器上的文件没有`\r\n`
*   b）您检查客户端上没有它们的方式是错误的。您正在检查错误的文件，或者它已经进行了额外的转换或其他。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-06T09:07:15.920

我有一个类似的问题。我使用的代码与您的几乎相同。我发现我的代码实际上工作正常，但服务器上的文件只包含行尾的“LF”字符，而不是“CR/LF”组合。大多数文本编辑器会忽略这一点，并将文本显示为一条连续的线。

# javascript - 表单验证：如果表单中的数据包含“VP-”，则错误输出

> ID：14145525
> 
> 赞同：0
> 
> 时间：2013-01-03T19:12:00.757
> 
> 标签：javascript, forms, validation

我正在尝试编写错误的表单验证表单是否包含“VP-”的代码。

我的代码是：

```
// quick order form validation
function validateQuickOrder(form) {        
  if ((form.ProductNumber.value == "")|| (form.ProductNumber.value == "VP")){
        alert("Please enter an item number.");
        form.ProductNumber.focus();
        return false;
 }
        return true;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T19:15:58.860

`==`进行完整的字符串比较。您将要使用[`indexOf`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/indexOf)它来检查它是否*包含*该字符串：

```
if ( ~form.ProductNumber.value.indexOf('VP') ) {
    // ProductNumber.value has "VP" somewhere in the string
} 
```

波浪号是[一个巧妙的技巧](https://stackoverflow.com/questions/12299665/what-does-a-tilde-do-when-it-precedes-an-expression#answer-12299678)，但如果你愿意，你可以更冗长：

```
if ( form.ProductNumber.value.indexOf('VP') != -1 ) {
    // ProductNumber.value has "VP" somewhere in the string
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T19:19:31.970

只是为了提供另一个答案的替代方案，也可以使用正则表达式：

```
if ( /VP/.test( form.ProductNumber.value ) ) {
  // value contains "VP"
} 
```

# objective-c - KeychainItemWrapper 弧形

> ID：14145526
> 
> 赞同：0
> 
> 时间：2013-01-03T19:12:10.790
> 
> 标签：objective-c, ios, automatic-ref-counting

我已经从 GitHub 下载了最新版本的 KeyChainItemWrapper，但是在编译时它给了我这个错误：这个代码必须在启用 ARC 的情况下编译！

因此，我尝试通过以下方式对我的项目进行 Arcified：编辑->重构->转换为 Objective-C ARC，然后运行转换器，但它给了我同样的错误......

此错误的根源来自 KeyChainItemWrapper.m 中存在的此代码

```
#if ! __has_feature(objc_arc)
#error THIS CODE MUST BE COMPILED WITH ARC ENABLED!
#endif 
```

如何打开 objc_arc 功能？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-16T00:38:30.327

这是发布了一段时间，但我遇到了同样的问题，所以我会在这里发布。

如果您在转换时项目中已有启用 ARC 的代码，则会引发错误。只需注释掉这些行，以便它们阅读：

```
/*#if ! __has_feature(objc_arc)
#error THIS CODE MUST BE COMPILED WITH ARC ENABLED!
#endif*/ 
```

继续尝试转换为 ARC，并在转换成功后取消注释。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T19:18:04.787

进入构建阶段，编译源代码，找到该文件的源代码，双击并为其标志添加“-fobjc-arc”:)。这将使您仅使用 arc 编译该文件并在非 arc 项目中使用它

# ruby-on-rails - 每天的平均销售价格

> ID：14145528
> 
> 赞同：1
> 
> 时间：2013-01-03T19:12:13.810
> 
> 标签：ruby-on-rails, ruby, postgresql, activerecord

我有一个带有 PostgreSQL 数据库销售表的 Rails 应用程序，如下所示：

```
 Sales
price(decimal)   date(datetime)
100.20           11/25/2012 11:00:00
30.43            11/26/2012 03:00:00
124.43           11/25/2012 18:00:00
190.34           11/26/2012 22:00:00 
```

数据库有数千条这样的记录，跨越 10 年。

我需要找到每天的平均销售价格，并通过 rake 任务将每个记录作为单独的记录保存在另一个数据库表中。

为了更清楚起见，需要按天对销售额进行分组（即使数据是日期时间格式），然后需要对当天的价格值进行平均。

因为我有 10 年的时间，所以能够遍历每个每日组并执行平均值是必不可少的。

有人对如何写这个有任何建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T19:31:58.030

您需要仔细检查语法，但这样的事情应该在数据库中完成......

```
Sales.average(:price, :group => "DATE_TRUNC('day', date)") 
```

请注意， DATE_TRUNC 是特定于 PG 的。

# node.js - 如何使用请求模块缓冲 HTTP 响应？

> ID：14145533
> 
> 赞同：23
> 
> 时间：2013-01-03T19:12:32.750
> 
> 标签：node.js, stream, request

我想将 HTTP 响应的内容流式传输到变量。我的目标是通过 获取图像`request()`，并将其存储在 MongoDB 中 - 但图像总是损坏。

这是我的代码：

```
request('http://google.com/doodle.png', function (error, response, body) {
    image = new Buffer(body, 'binary');
    db.images.insert({ filename: 'google.png', imgData: image}, function (err) {
        // handle errors etc.
    });
}) 
```

在这种情况下，使用 Buffer/streams 的最佳方式是什么？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2013-01-03T19:33:01.393

请求模块为您缓冲响应。在回调中，`body` **是**一个字符串（或[`Buffer`](http://nodejs.org/api/buffer.html)）。

如果您不提供回调，则只能从请求中返回流；`request()` *返回*一个 [`Stream`](http://nodejs.org/api/stream.html)。

[有关更多详细信息和示例，请参阅文档。](https://github.com/mikeal/request#super-simple-to-use)

* * *

request 假定响应是文本，因此它会尝试将响应正文转换为 sring（无论 MIME 类型如何）。这将损坏二进制数据。如果要获取原始字节，请指定`null` `encoding`.

```
request({url:'http://google.com/doodle.png', encoding:null}, function (error, response, body) {
    db.images.insert({ filename: 'google.png', imgData: body}, function (err) {

        // handle errors etc.

    }); 
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-12-07T03:22:09.793

```
var options = {
    headers: {
        'Content-Length': contentLength,
        'Content-Type': 'application/octet-stream'
    },
    url: 'http://localhost:3000/lottery/lt',
    body: formData,
    encoding: null, // make response body to Buffer.
    method: 'POST'
}; 
```

设置编码为null，返回Buffer。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-03T20:15:41.093

你试过管道这个吗？：

```
request.get('http://google.com/doodle.png').pipe(request.put('{your mongo path}')) 
```

（虽然对 Mongo 不够熟悉，不知道它是否支持像这样直接插入二进制数据，但我知道 CouchDB 和 Riak 支持。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-09-11T09:24:08.307

如今，您可以使用 Node 8、RequestJS 和异步等待轻松检索二进制文件。我使用了以下内容：

```
const buffer = await request.get(pdf.url, { encoding: null }); 
```

响应是一个包含 pdf 字节的缓冲区。比大选项对象和旧的 skool 回调要干净得多。

# c++ - clEnqueueAcquireGLObjects 上的 CL_OUT_OF_RESOURCES

> ID：14145538
> 
> 赞同：1
> 
> 时间：2013-01-03T19:13:00.190
> 
> 标签：c++, opengl, opencl

在重新排列一些 OpenCL/GL 互操作代码后，它停止工作并在标题中给出错误。

我已经阅读了许多讨论这个问题的线程，并将其归咎于 (nvidia) 驱动程序。但是因为在此之前运行的代码不应该是我的问题。

**代码**

正如我已经说过的，我有太多代码无法发布所有内容。此外，到目前为止，我还无法在最少的示例中重现该行为，因此我将用伪代码描述大部分程序，并从我的真实代码中摘录部分内容。

我使用 Qt，因此以下函数都是我的 QGLWidget 子类的所有成员：

```
void initializeGL()
{
    glewInit();

    cl::Platform::get(&clPlatforms);
    cl_context_properties props[] = {
        CL_GL_CONTEXT_KHR, (cl_context_properties)glXGetCurrentContext(),
        CL_GLX_DISPLAY_KHR, (cl_context_properties)glXGetCurrentDisplay(),
        CL_CONTEXT_PLATFORM, (cl_context_properties)clPlatforms[0](),
        0
    };
    clContext = cl::Context(CL_DEVICE_TYPE_GPU, props, cl_notify, &err);
    std::vector<cl::Device> devices = clContext.getInfo<CL_CONTEXT_DEVICES>();
    clDevice = devices[0];
    clQueue = cl::CommandQueue(clContext, clDevice, 0, 0);
    clProgram = cl::Program(context, sources);
    clProgram.build();    
    clKernel = cl::Kernel(clProgram, "main");
    glGenBuffers(1, &vbo);
    glBindBuffers(GL_ARRAY_BUFFER, vbo);
    glBufferData(GL_ARRAY_BUFFER, bufferSize, buffer, GL_DYNAMIC_DRAW);
    glBindBuffers(GL_ARRAY_BUFFER, 0);
    vboBuffer = cl::BufferGL(clContext, CL_MEM_READ_WRITE, vbo);
    clKernel.setArg(0, vboBuffer);
}

void paintGL()
{
    simulate();
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);
    //camera transformations ...
    glEnable(GL_VERTEX_ARRAY);
    glBindBuffer(GL_ARRAY_BUFFER, vbo);
    glVertexPointer(3, GL_FLOAT, sizeof(cl_float3), 0);
    glDrawElements(GL_TRIANGLES, 3 * numTriangles, GL_UNSIGNED_INT, triangleIdicesArray);
    glBindBuffer(GL_ARRAY_BUFFER, 0);
}

void simulate()
{
    std::vector<cl::Memory> sharedObjects;
    sharedObjects.push_back(vboBuffer);
    clQueue.enqueueAcquireGLObjects(&sharedObjects); //this triggers the error
    clQueue.enqueNDRangKernel(clKernel, cl::NullRange, cl::NDRangle(numVertices), cl::NullRange);
    clQueue.enqueueReleaseGLObjects(&sharedObjects);
} 
```

* * *

[关于glEnqueueAcquireGLObjects](http://www.khronos.org/registry/cl/sdk/1.1/docs/man/xhtml/clEnqueueAcquireGLObjects.html)的一些进一步调查出现了（在注释部分）：

> 在调用 clEnqueueAcquireGLObjects 之前，应用程序必须确保访问 mem_objects 中指定的对象的任何挂起的 GL 操作都已完成。这可以通过在所有具有对这些对象的未决引用的 GL 上下文上发出并等待完成 glFinish 命令来实现。

在获取/释放之前和之后在 OpenCL 命令队列上添加完成让我摆脱了这些错误。

与其他错误一样，我发现错误代码具有误导性，并且通知功能没有添加任何有价值的信息（它说的相同）。

# c# - 在 Visual Studio 即时窗口中清除堆栈

> ID：14145539
> 
> 赞同：12
> 
> 时间：2013-01-03T19:13:07.273
> 
> 标签：c#, .net, visual-studio-2012

在使用即时窗口时，必须在运行时和设计时有所不同。

如果我在设计时使用即时窗口并将局部变量放入堆栈：

```
string s = "test"; 
```

VS 将启动编译器并在堆上创建一个名为 s 的新变量，并将指向它的指针放在它在设计时使用的临时堆栈帧上。（至少我*认为*它是这样工作的，至少简化了。不过，如果我错了，请纠正我）

从现在开始，我不能将 s 用于其他任何事情，直到我运行我的应用程序或关闭 VS：

```
int s = 12;
A local variable named 's' is already defined in this scope 
```

我可以使用上下文菜单来清除即时窗口，但这实际上只是清除了窗口本身。我的局部变量仍然留在堆栈上。

我想知道，是否真的没有办法清除我之前在即时窗口中创建的所有变量？

（我使用的是 VS 2012 SP1 Prof. 但我猜这个问题对于每个版本的 VS 都是一样的）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T19:26:53.577

我不知道 Visual Studio 中究竟发生了什么的确切基础，但似乎 VS 在 vshost.exe 进程中保留了一个编译版本。

如果你杀死相关的进程（即WindowsFormsApplication1.vshost.exe *32），它将清除堆栈并允许你重用变量而无需重新启动VS。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T20:05:26.417

[此 MSDN 页面](http://msdn.microsoft.com/en-us/library/83hd8f1e.aspx)中描述了设计时调试。解决您的问题的具体帮助相当短。Visual Basic 代码示例并非完全出于偶然，这是旧版 VB6 IDE 中的一个重要特性。当然，在那种编程环境中更实用，因为编写易于使用即时窗口测试和调试的过程代码是很常见的。

我能想到的清除解释器执行状态的最快方法是按 F11（Debug + Step Into）并取消调试。或者输入 >Debug.StepInto 和 >Debug.StopDebugging。不理想。

# linux - 高 CPU 使用率 - Linux 上的简单数据包接收器

> ID：14145540
> 
> 赞同：1
> 
> 时间：2013-01-03T19:13:12.280
> 
> 标签：linux, networking, cpu-usage

我正在 Linux 下编写简单的应用程序，用于收集来自网络的所有数据包。我通过调用“recvfrom()”函数来使用阻塞接收。当我使用 hping3（每秒约 100k 原始帧，每个 130 字节）生成大网络负载时，“top”工具显示我的进程的 CPU 使用率很高 - 大约为 37-38%。这对我来说很有价值。当我减少数据包数量时，使用率会降低 - 例如，对于每秒 4k 帧，顶部显示 3%。
我在下载 ~10MB/s 时检查了 DC++，它的进程不使用 38% 的 CPU，而是 5%。C中是否有任何可编程方式来减少CPU使用率并仍然接收大量帧？

我的 CPU：Intel i5-2400 CPU @ 3.10Ghz

我的系统：带有 PREEMPT-RT 补丁的 Ubuntu 11.04 内核 3.6.6

这是我的代码：

```
#include <stdlib.h>
#include <stdio.h>
#include <sys/mman.h>
#include <string.h>
#include <sys/socket.h>
#include <linux/if_packet.h>
#include <linux/if_ether.h>
#include <linux/if_arp.h>
#include <arpa/inet.h>

/* Socket descriptor. */
int mainSocket; 

/* Buffer for frame. */
unsigned char* buffer;

int main(int argc, char* argv[])
{
    /** Create socket. **/  
    mainSocket = socket(AF_PACKET, SOCK_RAW, htons(ETH_P_ALL));
    if (mainSocket == -1) { 
        printf("Error: cannot create socket!\n");
    }

    /** Create buffer for frame **/
    buffer = malloc(ETH_FRAME_LEN);

    printf("Listing...");

    while(1) {

        // Length of received packet
        int length = recvfrom(mainSocket, buffer, ETH_FRAME_LEN, 0, NULL, NULL);
        if(length > 0) 
        {   
            // ... do something ...
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T19:52:32.933

我不知道这是否会有所帮助，但在谷歌上我看到：

*   [Linux 中的原始套接字、数据包套接字和零拷贝网络](http://yusufonlinux.blogspot.fr/2010/11/data-link-access-and-zero-copy.html)以及[http://lxr.linux.no/linux+v2.6.36/Documentation/networking/packet_mmap.txt](http://lxr.linux.no/linux+v2.6.36/Documentation/networking/packet_mmap.txt)讨论了原始套接字的使用`PACKET_MMAP`和`mmap()`提高性能

*   [数据包接收概述](https://access.redhat.com/knowledge/docs/en-US/Red_Hat_Enterprise_Linux/6/html/Performance_Tuning_Guide/s-network-packet-reception.html)建议设置您的进程的亲和性以匹配您[使用 RPS 将 NIC 绑定](https://access.redhat.com/knowledge/docs/en-US/Red_Hat_Enterprise_Linux/6/html/Performance_Tuning_Guide/main-network.html#s-network-future)到的 CPU 。

做`DC++`乱收吗？我不会这么猜的。因此，与其比较你的性能`DC++`，也许你应该将你的性能与类似`libpcap`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T19:27:56.540

可能是因为在 NIC 和 DC++ 上运行的 TCP/IP 堆栈直接从 NIC 获取数据流，因此您的处理器没有执行任何 TCP/IP 工作。但是在您的情况下，我认为您是直接尝试从 NIC 获取数据，因此它不会由 NIC 而是由您的处理器处理，并且由于您有无限循环来获取数据，因此您进行了大量处理......所以 CPU 使用率尖刺。

# ms-access - 将组合框设置为另一个组合框的值 - Access Vba

> ID：14145543
> 
> 赞同：0
> 
> 时间：2013-01-03T19:13:34.157
> 
> 标签：ms-access, combobox, vba

我在表单上有 2 个组合框。`ComboID`和`ComboName`

ComboID 包含诸如 1001、1002、1003、1004 等项目... ComboName 包含诸如 John、Matt、David、Luke 等项目...

我有一张包含这些数据的表格：1001、John 1002、Matt 1003、David 1004、Luke

当我从中选择时，我想`ComboID`显示。而且我还想在选择时显示“1002” 。`1001``John``ComboName``ComboName``Matt`

我需要能够在任何时候选择一个新的名称或 ID，并在另一个组合框中更新其相应的值。

我一直在努力让它发挥作用，但它并没有我想象的那么难。我还在学习 VBA 代码。请问有什么帮助吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T19:18:13.863

# 第一眼解决方案（不推荐）

## 这是什么

我对这个问题的最初反应是尝试使用[更改事件](http://msdn.microsoft.com/en-us/library/office/aa211341%28v=office.11%29.aspx)。为每个组合框设置子例程以更改另一个组合框的值将是解决方案。

## 为什么你不应该使用它

但是，在 Access vba 更改事件的文档（上面的链接）中明确指出：

> “避免创建两个或多个具有相互影响的更改事件的控件 - 例如，两个相互更新的文本框”（[msdn access vba change event](http://msdn.microsoft.com/en-us/library/office/aa211341%28v=office.11%29.aspx)）

不幸的是，这正是您使用更改事件解决方案（使用组合框而不是文本框）要做的事情。在您的示例中，ComboID 组合框中的更改将触发 ComboName 组合框中的相应更改，但 ComboName 组合框中的更改将触发 ComboID 中的尝试更改，并且此循环可以继续。因此，这不是您问题的好答案。

# 更好的解决方案

在这种情况下，更新后[事件](http://msdn.microsoft.com/en-us/library/office/aa211226%28v=office.11%29.aspx)似乎是更合适的方法。

## 为什么不会触发有问题的循环

如更新后文档中所述：

> 使用 Visual Basic 或包含 SetValue 操作的宏更改控件中的数据不会触发控件的这些事件。

因此，更新后事件（可能使用[SetValue](http://msdn.microsoft.com/en-us/library/office/aa210617%28v=office.11%29.aspx)）应该是更好的方法。

非常感谢@Remou 指出了我更改事件方式的错误，并让我注意到了 AfterUpdate 事件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-04T00:21:07.970

**更改事件很少是代码的合适选择**。例如，组合框允许用户输入和选择项目，因此每输入一个字符就会触发 change 事件。与该事件相关的任何事件都会导致可怕的并发症的可能性。

像这样设置组合框，认为为什么要这样做有点神秘。您可能需要在当前事件中使它们保持同步。你没有提到组合是否绑定到一个控制源，所以我没有包括一个。

组合ID

```
RowSource: SELECT ID, [Name] FROM Table ORDER BY ID
BoundColumn: 1 
ColumnCount: 2
ColumnWidths: 2cm;0cm ''The second column is hidden,
                      ''the first column is any width

Private Sub ComboID_AfterUpdate()
    Me.ComboName = Me.ComboID
End Sub 
```

组合名称

```
RowSource: SELECT ID, [Name] FROM Table ORDER BY [Name]
BoundColumn: 1
ColumnCount: 2
ColumnWidths: 0cm;2cm ''The first column is hidden, 
                      ''the second column is any width

Private Sub ComboName_AfterUpdate()
    Me.ComboID = Me.ComboName
End Sub 
```

# ruby-on-rails - 我可以指示 Solr (Sunspot) 跳过代码块的重新索引吗？

> ID：14145544
> 
> 赞同：1
> 
> 时间：2013-01-03T19:13:37.063
> 
> 标签：ruby-on-rails, ruby, solr, sunspot

我想与各种`Searchable`模型记录进行一系列交互，并且在我的所有交互完成之前不重新索引任何模型。这可能吗？

我知道我可以手动调用重新索引方法，但是如何手动指示 Sunspot*不对*给定的代码块重新索引？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-06T04:11:07.997

```
Sunspot.session = Sunspot::Rails::StubSessionProxy.new(Sunspot.session)
# whatever code you want to execute and not trigger a reindex
Sunspot.session = Sunspot.session.original_session 
```

参考：

[链接1](https://groups.google.com/forum/?fromgroups=#!searchin/ruby-sunspot/disable%2420index/ruby-sunspot/BRB4RZbl3jk/oLpHfmS3d0kJ)

[链接2](https://github.com/sunspot/sunspot/wiki/RSpec-and-Sunspot)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-06T16:05:06.887

johnnycakes 的回答很有帮助，但由于我需要完全阻止给定模型的自动索引，所以我使用了以下内容：

```
searchable :auto_index => false do
  text :name
  text :description
  # etc...
end 
```

这`:auto_index => false`部分是指示 Solr 不对模型编制索引的部分。直截了当 - 但由于某种原因，我花了一段时间才通过谷歌找到。

# prolog - 将序言文件包含在另一个文件中，但是按特定顺序调用它？

> ID：14145546
> 
> 赞同：1
> 
> 时间：2013-01-03T19:13:53.413
> 
> 标签：prolog, swi-prolog

我有两个文件，file1 和 file2 带有 prolog 扩展名，在某些情况下，在 file1 中，file2 附加了新的谓词，所以我必须在 file1 的某个特定区域查阅 file2，我确实检查了这个 [问题](https://stackoverflow.com/questions/4097451/how-do-i-include-a-pl-file-in-prolog)，但我想要不同的行为，我想做的是：

在文件 1

```
consult_File:-
                  consult('C:/Users/../Prolog/file2.pl'). 
```

在特定条件下，我可以调用consult_File，但不幸的是，如果我在File1的其他代码中调用consult_File，它不起作用，如果你从命令中显式调用它，它就会起作用。如果有人可以帮助我，我将不胜感激。

谢谢

# symfony - Symfony 2 批处理操作的表单名称？

> ID：14145548
> 
> 赞同：3
> 
> 时间：2013-01-03T19:13:55.140
> 
> 标签：symfony

我有一个作为 html 表的项目列表。我想有机会以批处理模式保存一些数据。为此，我需要我的表单字段名称如下所示：**provider[i][title]**等。但是当我尝试创建表单字段时，出现错误：

表单类型名称 ("provider[0]") 无效。名称只能包含字母、数字和“_”。

我对表单集合感到不满，但这并不完全是我需要的。

我想像 $request->request->get('provider') 一样获得整个表单，然后迭代以获取实际数据。我很困惑！这是我能想象到的最简单的任务。

```
<input type='text' name='provider[0][title]'>
<input type='text' name='provider[1][title]'>
<input type='text' name='provider[2][title]'> 
```

我可以使用 $request->request->all()，这是一个解决方案，但我认为不是那么优雅。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-16T22:04:33.033

这是完全正常的，您不能直接用“provider[0]”之类的名称命名您的字段。这部分字段名由 Symfony 生成。

对我来说，以一种形式存储多个实体的唯一（好的）方法是使用集合。它们在 Symfony2 的文档中得到了很好的解释：http: [//symfony.com/doc/current/cookbook/form/form_collections.html](http://symfony.com/doc/current/cookbook/form/form_collections.html)

在您的情况下，您只需要创建一个包含一个集合字段的表单，并在控制器中添加行或使用 javascript 在飞行中添加行。对于“提供者”字段，只需创建一个带有一个文本字段的 formType。

如果您使用 html 数组，您可以简单地为每个实体添加一行。provider[i] 中的 i 将与数据库中的实体绑定，如果它们没有链接到其他实体。

最后，使用 POST 数据绝对不是一个好的解决方案：您将失去表单字段断言和 CSRF 保护。

# php - 将参数传递给分页 url

> ID：14145549
> 
> 赞同：5
> 
> 时间：2013-01-03T19:13:59.230
> 
> 标签：php, url, pdo

我是一种将大约 15 个参数传递给 url 分页的方法：

例如我有：

```
$input = $_GET['input'];
$categories = $_GET['category'];
$state = $_GET['state'];
$zipcode = $_GET['zipcode']; 
```

我可以这样做并且工作正常：

```
 $paginate.= "<a href='$targetpage?page=$prev&input=".$_GET['input']."& 
 category=".$_GET['category']."&state=".$_GET['state']."& 
 zipcode=".$GET['zipcode']."'>Previous</a>"; 
```

但我还有很多参数要传递。有人可以告诉我它是如何使用数组或更好的方法完成的吗？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-03T19:17:44.660

哟可以使用这个功能：
[http_build_query](http://php.net/manual/en/function.http-build-query.php)

php.net 示例：

```
<?php
$data = array('foo'=>'bar',
              'baz'=>'boom',
              'cow'=>'milk',
              'php'=>'hypertext processor');

echo http_build_query($data) . "\n";
echo http_build_query($data, '', '&amp;');

?> 
```

输出：

```
foo=bar&baz=boom&cow=milk&php=hypertext+processor
foo=bar&amp;baz=boom&amp;cow=milk&amp;php=hypertext+processor 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-03T19:17:25.973

PHP 中有一个将数组转换为 URL 查询的函数，它被称为：

*   [`http_build_query`](http://php.net/http_build_query)

用法非常简单：

```
$data = array('foo'=>'bar',
              'baz'=>'boom',
              'cow'=>'milk',
              'php'=>'hypertext processor');

echo http_build_query($data) . "\n";
echo http_build_query($data, '', '&amp;'); 
```

上面的示例将输出：

```
foo=bar&baz=boom&cow=milk&php=hypertext+processor
foo=bar&amp;baz=boom&amp;cow=milk&amp;php=hypertext+processor 
```

我推荐[刚刚链接的手册页](http://php.net/http_build_query)以获取更多信息。

如果您正在寻找面向对象的东西，[`Net_URL2`Pear 包](http://pear.php.net/package/Net_URL2/)很有用。

它还允许有条件地更改一些参数，这通常对分页非常有用，请参阅我对[*“在分页期间保留 url 参数”*](https://stackoverflow.com/a/9667076/367456)[的回答以](https://stackoverflow.com/a/9667076/367456)*获取两个示例，一个基于 Array/PHP 标准扩展，另一个用于`Net_URL2`.*

 ** * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-03T19:18:45.337

假设所有`$_GET`键都与 URL 中的参数名称相同，您可以这样做：

```
$url = $targetpage . '?page=' . $prev . '&';

foreach ($_GET as $k => $v) {
    $url .= $k . '=' . $v . '&';
}
 $paginate.= "<a href='$url'>Previous</a>"; 
```

.. 或者你可以只使用 PHP 的[内置函数`http_build_query()`](http://php.net/manual/en/function.http-build-query.php)*

# javascript - 单独文档中的 onClick 事件

> ID：14145552
> 
> 赞同：0
> 
> 时间：2013-01-03T19:14:17.047
> 
> 标签：javascript, document

我已经完成了一个网页，我想将我的所有 onClick 事件保存在一个单独的 JS 文档中，就像我对我正在使用的其他 Javascripts 所做的那样。

我现在想更改的 HTML 中使用的 atm 片段如下：

```
<a href="http://www.commercial.com" onclick="confirmLeave()" target="_blank"> 
```

和

```
<IMG SRC="picture_small.jpg" alt="Description" onClick="view(this);"> 
```

我保存在单独文档中的连接 Javascript 代码是这样的：

```
function confirmLeave() {
    if (confirm("Do you want to leave this page?")) {
        return true;
    } else {
        if (window.event) {
            window.event.returnValue = false;
        } else {
            e.preventDefault();
        }
        return false;
    }
} 
```

和

```
function view(img) {
    imgsrc = img.src.split("_")[0] + "_big.jpg";
    viewwin = window.open(imgsrc, 'viewwin', "width=790,height=444,location=0");
    viewwin.focus();
} 
```

第一个是询问访问者在点击指向外部站点的链接时是否想离开我的页面；另一个是显示他们点击的图片的更大版本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T19:16:37.707

您可以像这样创建指向外部 javascript 文件的链接。

`<script src="http://yoururl.com/myjs.js"></script>`

# c# - 在 C# Web 应用程序中插入查询超时，在 SQL Server Management Studio 中运行良好

> ID：14145553
> 
> 赞同：14
> 
> 时间：2013-01-03T19:14:16.893
> 
> 标签：c#, asp.net, sql-server

我正在尝试从我的 C# Web 应用程序中运行插入查询。当我从 SQL Server Management Studio 运行查询时，插入查询大约需要五分钟才能完成。从应用程序运行时，它会在三十分钟后超时（是的分钟，而不是秒）。

我已经从 VS 调试器中获取了实际的 SQL 语句并从 Mgmt Studio 运行它，它工作正常。

所有这些都是在我的开发环境中运行的，而不是生产环境。查询正在进行时没有其他 SQL Server 活动。我正在使用 SQL Server 2008 R2 进行开发。MS VS 2010 Express，Asp.Net 4.0。SQL Server 管理工作室 10。

有一个类似的问题从未得到回答：[SQL server timeout 2000 from C# .NET](https://stackoverflow.com/questions/2095927/sql-server-timeout-2000-from-c-sharp-net)

以下是 SET 选项：dbcc useroptions

```
Option                  MgtStudio      Application
----------------------- -------------- --------------
textsize                2147483647     -1
language                us_english     us_english
dateformat              mdy            mdy
datefirst               7              7
lock_timeout            -1             -1
quoted_identifier       SET            SET
arithabort              SET            NOT SET
ansi_null_dflt_on       SET            SET
ansi_warnings           SET            SET
ansi_padding            SET            SET
ansi_nulls              SET            SET
concat_null_yields_null SET            SET
isolation level         read committed read committed 
```

只有 textsize 和 arithabort 不同。

任何想法为什么查询执行时间存在如此差异以及我可以做些什么来缩小这种差异？

我不确定包含查询会有多大用处，特别是因为包含模式太多了。无论如何，这里是：

```
INSERT INTO GeocacherPoints
            (CacherID,
             RegionID,
             Board,
             Control,
             Points)
SELECT z.CacherID,
       z.RegionID,
       z.Board,
       21,
       z.Points
FROM   (SELECT CacherID,
               gp.RegionID,
               Board=gp.Board + 10,
               ( CASE
                   WHEN (SELECT COUNT(*)
                         FROM   Geocache g
                                JOIN GeocacheRegions r
                                  ON ( r.CacheID = g.ID )
                         WHERE  r.RegionID = gp.RegionID
                                AND g.FinderPoints >= 5) < 20 THEN NULL
                   ELSE (SELECT SUM(y.FinderPoints) / 20
                         FROM   (SELECT x.FinderPoints,
                                        ROW_NUMBER() OVER (ORDER BY x.FinderPoints DESC, x.ID) AS Row
                                 FROM   (SELECT g.FinderPoints,
                                                g.ID
                                         FROM   Geocache g
                                                JOIN Log l
                                                  ON ( l.CacheID = g.ID )
                                                JOIN Geocacher c
                                                  ON ( c.ID = l.CacherID )
                                                JOIN GeocacheRegions r
                                                  ON ( r.CacheID = g.ID )
                                         WHERE  YEAR(l.LogDate) = @Year
                                                AND g.FinderPoints >= 5
                                                AND c.ID = gp.CacherID
                                                AND r.RegionID = gp.RegionID) x) y
                         WHERE  y.Row <= 20)
                 END ) Points
        FROM   GeocacherPoints gp
               JOIN Region r
                 ON r.RegionID = gp.RegionID
        WHERE  gp.Control = 21
               AND r.RegionType IN ( 'All', 'State' )
               AND gp.Board = @Board - 10) z
WHERE  z.Points IS NOT NULL
       AND z.Points >= 1 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-03T22:28:26.243

`ARITHABORT`常被误诊为病因。

事实上，自从版本 2005`ANSI_WARNINGS`开启（因为它在您的两个连接中）`ARITHABORT`之后，无论如何都是隐式开启的，并且此设置没有实际效果。

但是，它确实有副作用。为了考虑到`ANSI_WARNINGS`关闭的情况，设置`ARITHABORT`被用作[计划缓存键](http://www.benjaminnevarez.com/2011/09/parameter-sniffing-and-plan-reuse-affecting-set-options/)之一，这意味着具有不同设置的会话不能共享彼此的计划。

当您在 SSMS 中运行查询时，无法重用为您的应用程序缓存的执行计划，除非它们都具有相同的计划缓存键，因此它会编译一个新计划，“嗅探”当前正在测试的参数值。您的应用程序的计划可能是针对不同的参数值编译的。这个问题被称为“参数嗅探”。

您可以检索两个执行计划并将其与类似的内容进行比较

```
SELECT usecounts, cacheobjtype, objtype, text, query_plan, value as set_options
FROM sys.dm_exec_cached_plans 
CROSS APPLY sys.dm_exec_sql_text(plan_handle) 
CROSS APPLY sys.dm_exec_query_plan(plan_handle) 
cross APPLY sys.dm_exec_plan_attributes(plan_handle) AS epa
where text like '%INSERT INTO GeocacherPoints (CacherID,RegionID,Board,Control,Points)%' 
and attribute='set_options' and text not like '%this query%' 
```

XML 中的参数部分告诉您参数的编译时间值。

看到[应用程序慢，SSMS 快？了解更多性能奥秘](http://www.sommarskog.se/query-plan-mysteries.html)。

**执行计划**

您提供了估计的执行计划而不是实际的执行计划，但可以看出只有第一个查询计划是参数化的，并且它是针对以下值编译的。

```
 <ParameterList>
          <ColumnReference Column="@Dec31" ParameterCompiledValue="'2013-12-31'" />
          <ColumnReference Column="@Jan1" ParameterCompiledValue="'2013-01-01'" />
          <ColumnReference Column="@Board" ParameterCompiledValue="(71)" />
        </ParameterList> 
```

第二个执行计划使用**变量**而不是**参数**。这极大地改变了事情。

```
DECLARE @Board INT
DECLARE @Jan1 DATE
DECLARE @Dec31 DATE

SET @Board=71
SET @Jan1='January 1, 2013'
SET @Dec31='December 31, 2013'

INSERT INTO GeocacherPoints 
```

SQL Server 不会嗅探变量的特定值，而是生成类似于使用[`OPTIMIZE FOR UNKNOWN`](http://blogs.msdn.com/b/sqlprogrammability/archive/2008/11/26/optimize-for-unknown-a-little-known-sql-server-2008-feature.aspx)提示的通用计划。该计划中的估计行数远高于第一个计划中的行数。

你没有说明哪个是快计划，哪个是慢计划。如果使用变量的速度更快，那么您可能需要更新统计信息，您很可能会遇到此处描述的问题[统计、行估计和升序日期列](http://sqlinthewild.co.za/index.php/2011/03/22/statistics-row-estimations-and-the-ascending-date-column/)，如果使用参数的速度更快，那么您将能够实现变量嗅探并获得它通过使用`OPTION (RECOMPILE)`提示来考虑实际变量值。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-03T19:19:14.590

如果您使用 SqlCommand 并且没有为[CommandTimeout](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.commandtimeout%28v=vs.110%29.aspx)指定值，它将在 30 秒后自动超时。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-03T20:34:51.460

这个问题似乎会定期出现，这个链接位于列表顶部： [Query timeouts from web app but runs fine from management studio](https://stackoverflow.com/questions/9974/query-times-out-from-web-app-but-runs-fine-from-management-studio?rq=1)。 `ARITHABORT`显然是罪魁祸首。

# php - 如何使用 PHP 获取带有 LinkedIn 注册 API 的电子邮件地址

> ID：14145558
> 
> 赞同：4
> 
> 时间：2013-01-03T19:14:38.683
> 
> 标签：php, api, linkedin

我从一些关于链接注册的教程中获得了这段代码，但该教程只提供了基本信息。我还需要获取用户电子邮件...我该怎么做？

这是代码：

### 授权文件

这是我在 likedin 上获取访问表单的链接。

```
<?php
    session_start();
    $config['base_url']             =   '';
    $config['callback_url']         =   '';
    $config['linkedin_access']      =   '';
    $config['linkedin_secret']      =   '';

    include_once "linkedin.php";

    # First step is to initialize with your consumer key and secret. We'll use an out-of-band oauth_callback
    $linkedin = new LinkedIn($config['linkedin_access'], $config['linkedin_secret'], $config['callback_url'] );
    //$linkedin->debug = true;

    # Now we retrieve a request token. It will be set as $linkedin->request_token
    $linkedin->getRequestToken();
    $_SESSION['requestToken'] = serialize($linkedin->request_token);

    # With a request token in hand, we can generate an authorization URL, which we'll direct the user to
    //echo "Authorization URL: " . $linkedin->generateAuthorizeUrl() . "\n\n";
    header("Location: " . $linkedin->generateAuthorizeUrl()); ?> 
```

### 演示.php

这是我注册后得到的脚本。

```
<?php
    session_start();

    $config['base_url']             =   'http://xxx/linkedin/auth.php';
    $config['callback_url']         =   'http://xxx/linkedin/demo.php';
    $config['linkedin_access']      =   '';
    $config['linkedin_secret']      =   '';

    include_once "linkedin.php";

    # First step is to initialize with your consumer key and secret. We'll use an out-of-band oauth_callback
    $linkedin = new LinkedIn($config['linkedin_access'], $config['linkedin_secret'], $config['callback_url'] );
    //$linkedin->debug = true; if (isset($_REQUEST['oauth_verifier'])){
    $_SESSION['oauth_verifier']     = $_REQUEST['oauth_verifier'];

    $linkedin->request_token    =   unserialize($_SESSION['requestToken']);
    $linkedin->oauth_verifier   =   $_SESSION['oauth_verifier'];
    $linkedin->getAccessToken($_REQUEST['oauth_verifier']);

    $_SESSION['oauth_access_token'] = serialize($linkedin->access_token);
    header("Location: " . $config['callback_url']);
    exit;}   else{
    $linkedin->request_token    =   unserialize($_SESSION['requestToken']);
    $linkedin->oauth_verifier   =   $_SESSION['oauth_verifier'];
    $linkedin->access_token     =   unserialize($_SESSION['oauth_access_token']);}

    # You now have a $linkedin->access_token and can make calls on behalf of the current member
    $xml_response = $linkedin->getProfile("~:(id,first-name,last-name,headline,picture-url)");

    $id = $linkedin->getProfile('~:(id)');
    $fname = $linkedin->getProfile('~:(first-name)');
    $lname = $linkedin->getProfile('~:(last-name)');
    $headline = $linkedin->getProfile('~:(headline)');
    $picture = $linkedin->getProfile('~:(picture-url)');

    $id = trim(strip_tags($id));
    $fname = trim(strip_tags($fname));
    $lname = trim(strip_tags($lname));
    $headline = trim(strip_tags($headline));
    $picture = trim(strip_tags($picture)); ?> 
```

### 链接的.php

这是 LinkedIn 库：

```
<?php require_once("OAuth.php"); class LinkedIn {
    public $base_url = "http://api.linkedin.com";
    public $secure_base_url = "https://api.linkedin.com";
    public $oauth_callback = "oob";
    public $consumer;
    public $request_token;
    public $access_token;
    public $oauth_verifier;
    public $signature_method;
    public $request_token_path;
    public $access_token_path;
    public $authorize_path;

    function __construct($consumer_key, $consumer_secret, $oauth_callback = NULL)
    {

        if($oauth_callback) {
            $this->oauth_callback = $oauth_callback;
        }

        $this->consumer = new OAuthConsumer($consumer_key, $consumer_secret, $this->oauth_callback);
        $this->signature_method = new OAuthSignatureMethod_HMAC_SHA1();
        $this->request_token_path = $this->secure_base_url . "/uas/oauth/requestToken";
        $this->access_token_path = $this->secure_base_url . "/uas/oauth/accessToken";
        $this->authorize_path = $this->secure_base_url . "/uas/oauth/authorize";
    }

    function getRequestToken()
    {
        $consumer = $this->consumer;
        $request = OAuthRequest::from_consumer_and_token($consumer, NULL, "GET", $this->request_token_path);
        $request->set_parameter("oauth_callback", $this->oauth_callback);
        $request->sign_request($this->signature_method, $consumer, NULL);
        $headers = Array();
        $url = $request->to_url();
        $response = $this->httpRequest($url, $headers, "GET");
        parse_str($response, $response_params);
        $this->request_token = new OAuthConsumer($response_params['oauth_token'], $response_params['oauth_token_secret'], 1);
    }

    function generateAuthorizeUrl()
    {
        $consumer = $this->consumer;
        $request_token = $this->request_token;
        return $this->authorize_path . "?oauth_token=" . $request_token->key;
    }

    function getAccessToken($oauth_verifier)
    {
        $request = OAuthRequest::from_consumer_and_token($this->consumer, $this->request_token, "GET", $this->access_token_path);
        $request->set_parameter("oauth_verifier", $oauth_verifier);
        $request->sign_request($this->signature_method, $this->consumer, $this->request_token);
        $headers = Array();
        $url = $request->to_url();
        $response = $this->httpRequest($url, $headers, "GET");
        parse_str($response, $response_params);
        $this->access_token = new OAuthConsumer($response_params['oauth_token'], $response_params['oauth_token_secret'], 1);
    }

    function getProfile($resource = "~")
    {
        $profile_url = $this->base_url . "/v1/people/" . $resource;
        $request = OAuthRequest::from_consumer_and_token($this->consumer, $this->access_token, "GET", $profile_url);
        $request->sign_request($this->signature_method, $this->consumer, $this->access_token);
        $auth_header = $request->to_header("https://api.linkedin.com"); # this is the realm
        # This PHP library doesn't generate the header correctly when a realm is not specified.
        # Make sure there is a space and not a comma after OAuth
        // $auth_header = preg_replace("/Authorization\: OAuth\,/", "Authorization: OAuth ", $auth_header);
        // # Make sure there is a space between OAuth attribute
        // $auth_header = preg_replace('/\"\,/', '", ', $auth_header);

        // $response will now hold the XML document
        $response = $this->httpRequest($profile_url, $auth_header, "GET");
        return $response;
    }

    function setStatus($status)
    {
        $profile_url = $this->base_url . "/v1/people/~";
        $status_url = $this->base_url . "/v1/people/~/current-status";
        echo "Setting status...\n";
        $xml = "<current-status>" . htmlspecialchars($status, ENT_NOQUOTES, "UTF-8") . "</current-status>";
        echo $xml . "\n";
        $request = OAuthRequest::from_consumer_and_token($this->consumer, $this->access_token, "PUT", $status_url);
        $request->sign_request($this->signature_method, $this->consumer, $this->access_token);
        $auth_header = $request->to_header("https://api.linkedin.com");

        $response = $this->httpRequest($profile_url, $auth_header, "GET");
        return $response;
    }

    # Parameters should be a query string starting with "?"
    # Example search("?count=10&start=10&company=LinkedIn");
    function search($parameters)
    {
        $search_url = $this->base_url . "/v1/people-search:(people:(id,first-name,last-name,picture-url,site-standard-profile-request,headline),num-results)" . $parameters;
        //$search_url = $this->base_url . "/v1/people-search?keywords=facebook";

        echo "Performing search for: " . $parameters . "<br />";
        echo "Search URL: $search_url <br />";
        $request = OAuthRequest::from_consumer_and_token($this->consumer, $this->access_token, "GET", $search_url);
        $request->sign_request($this->signature_method, $this->consumer, $this->access_token);
        $auth_header = $request->to_header("https://api.linkedin.com");
        $response = $this->httpRequest($search_url, $auth_header, "GET");
        return $response;
    }

    function httpRequest($url, $auth_header, $method, $body = NULL)
    {
        if (!$method) {
            $method = "GET";
        };

        $curl = curl_init();
        curl_setopt($curl, CURLOPT_URL, $url);
        curl_setopt($curl, CURLOPT_HEADER, 0);
        curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1);
        curl_setopt($curl, CURLOPT_HTTPHEADER, array($auth_header)); // Set the headers.

        if ($body) {
            curl_setopt($curl, CURLOPT_POST, 1);
            curl_setopt($curl, CURLOPT_POSTFIELDS, $body);
            curl_setopt($curl, CURLOPT_CUSTOMREQUEST, $method);
            curl_setopt($curl, CURLOPT_HTTPHEADER, array($auth_header, "Content-Type: text/xml;charset=utf-8"));
        }

        $data = curl_exec($curl);
        curl_close($curl);
        return $data;
    }} 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-01-10T22:31:35.570

电子邮件地址仅对经过身份验证的用户可用，而不是他/她的连接。

1.  在授权您的应用程序时，请确保您已向用户请求了**r_emailaddress**成员权限。*[身份验证](https://developer.linkedin.com/documents/authentication)*详细介绍了身份验证和授予成员权限。

2.  进行以下 GET 调用以获取经过身份验证的用户的电子邮件地址：

    ```
    GET http://api.linkedin.com/v1/people/~:(email-address) 
    ```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2019-04-16T06:57:33.167

对于搜索 v2 网址的人

请按照以下网址

```
 payload = {
        'grant_type': 'authorization_code',
        'code': token,
        'redirect_uri': s.SOCIAL_AUTH_CALLBACK_URL,
        'client_id': s.LINKED_IN_CLIENT_ID,
        'client_secret': s.LINKED_IN_CLIENT_SECRET
    }

POST "https://www.linkedin.com/oauth/v2/accessToken" 
```

获取访问令牌

```
GET "https://api.linkedin.com/v2/me" 
```

获取用户数据在标头中发送身份验证令牌

```
GET "https://api.linkedin.com/v2/emailAddress?q=members&projection=(elements*(handle~))" 
```

获取用户电子邮件地址。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-11-23T12:22:21.000

[您可以通过 api $this->userProfileUrl = " https://api.linkedin.com/v1/people/~:(id,first-name,last-name,picture-url,public-profile-url](https://api.linkedin.com/v1/people/~:(id,first-name,last-name,picture-url,public-profile-url,email-address)?oauth2_access_token=)获取电子邮件地址[,email-address)?oauth2_access_token=](https://api.linkedin.com/v1/people/~:(id,first-name,last-name,picture-url,public-profile-url,email-address)?oauth2_access_token=) ";

但是您必须设置范围，例如 $oauth->scope = 'r_basicprofile,r_emailaddress'; 使用 Oauth [https://developer-programs.linkedin.com/documents/profile-api](https://developer-programs.linkedin.com/documents/profile-api)

或尝试 [https://developer.linkedin.com/docs/oauth2](https://developer.linkedin.com/docs/oauth2)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2019-04-18T05:18:50.840

您可以使用以下 EP 访问linkedin 用户的电子邮件地址：

```
`https://api.linkedin.com/v2/emailAddress?q=members&projection=(elements*(handle~))` 
```

确保您已在库中定义范围“r_emailaddress”。您可以使用以下 curl 请求来获取数据：

```
 $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL, $Url);
    curl_setopt($ch, CURLOPT_HTTPHEADER, array(
      'Authorization: Bearer '. $token,
      'X-Restli-Protocol-Version: 2.0.0',
      'Accept: application/json',
      'Content-Type: application/json'
    ));
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
    curl_setopt($ch, CURLOPT_VERBOSE, 1);
    curl_setopt($ch, CURLOPT_HEADER, 1);
    $response = curl_exec($ch);
    $headerSize = curl_getinfo($ch, CURLINFO_HEADER_SIZE);
    $body = substr($response, $headerSize);
    $response_body = json_decode($body,true); 
```

$response_body 将返回以下响应：

```
Array (
    [elements] => Array
        (
            [0] => Array
                (
                    [handle] => urn:li:emailAddress:123456
                    [handle~] => Array
                        (
                            [emailAddress] => your@email.in
                        )

                )

        )

) 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2020-04-30T20:25:19.070

您应该在 AccessToken Request 时传递 '&scope=r_basicprofile+r_emailaddress'

第 1 步：AccessToken 请求将类似于

```
https://www.linkedin.com/oauth/v2/accessToken?grant_type=authorization_code&code={Your code}&redirect_uri={Yourredirect_uri}&client_id={Your client_id}&client_secret={Your client_secret }&scope=r_liteprofile+r_emailaddress 
```

这将为您返回 AccessToken，您必须使用它再发出 2 个请求 1 用于电子邮件和个人资料详细信息

第 2 步：对于电子邮件请求将类似于

```
https://api.linkedin.com/v2/emailAddress?q=members&projection=(elements*(handle~))&oauth2_access_token={AccessToken You get from step 1}' 
```

第 3 步：对于基本配置文件请求将类似于

```
https://api.linkedin.com/v2/me?projection=(id,firstName,lastName,emailAddress,profilePicture(displayImage~:playableStreams))&oauth2_access_token={AccessToken You get from step 1}' 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-01-03T19:21:10.567

LinkedIn API 不提供电子邮件地址作为个人资料对象的一部分。[请参阅此处](http://developer.linkedin.com/documents/profile-api)的文档以阅读可用的数据。

编辑：见 Kamyar 的回答。显然，截至 2012 年 8 月，LinkedIn 现在允许提取电子邮件地址。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-08-11T08:51:56.673

你可以试试 ：

```
->elements[0]->{"handle~"}->emailAddress 
```

祝你好运

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2021-05-12T04:46:33.917

**第 1 步：** AccessToken 请求

```
$postData = array(
    'grant_type' => 'authorization_code',
    'code' => urldecode(trim($_GET['code'])),
    'redirect_uri' => url_for('social_login/linkedin'),
    'client_id' => CFG_LINKEDIN_APP_ID,
    'client_secret' => CFG_LINKEDIN_SECRET_KEY
);

$ch = curl_init("https://www.linkedin.com/oauth/v2/accessToken");    
curl_setopt($ch, CURLOPT_HEADER, array('Content-Type' => 'application/x-www-form-urlencoded'));
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_POSTFIELDS, http_build_query($postData));
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
curl_setopt($ch, CURLOPT_TIMEOUT, 15);
curl_setopt($ch, CURLOPT_HTTP_VERSION, CURL_HTTP_VERSION_1_0);
$response = curl_exec($ch);

$header_size = curl_getinfo($ch, CURLINFO_HEADER_SIZE);    
$body = substr($response, $header_size);

curl_close($ch);

if(!$response)
{
    die('Curl error: ' . curl_error($ch));       
}

$response = json_decode($body,true); 
```

在**$response**中，您将找到 AccessToken 使用它您必须再提出 2 个请求 1 用于电子邮件和个人资料详细信息

**第 2 步：**个人资料请求

```
$access_token = $response['access_token']; 

$ch = curl_init('https://api.linkedin.com/v2/me?projection=(id,firstName,lastName,emailAddress,profilePicture(displayImage~:playableStreams))&oauth2_access_token=' . $access_token);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_POST, false);
curl_setopt($ch, CURLOPT_VERBOSE, true);
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
curl_setopt($ch, CURLOPT_TIMEOUT, 15);        
$response = curl_exec($ch);
curl_close($ch); 
```

**第 3 步：**对于电子邮件请求

```
$ch = curl_init('https://api.linkedin.com/v2/emailAddress?q=members&projection=(elements*(handle~))&oauth2_access_token=' . $access_token);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_POST, false);
curl_setopt($ch, CURLOPT_VERBOSE, true);
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
curl_setopt($ch, CURLOPT_TIMEOUT, 15);        
$response2 = curl_exec($ch);
curl_close($ch); 
```

**结果：**用户数据

```
$user = [
    'first_name' => current($response['firstName']['localized']),
    'last_name' => current($response['lastName']['localized']),
    'photo' => $response['profilePicture']['displayImage~']['elements'][0]['identifiers'][0]['identifier'],
    'email' => $response2['elements'][0]['handle~']['emailAddress']
]; 
```

# git - 在多个分支上将新文件添加到 .gitignore

> ID：14145559
> 
> 赞同：1
> 
> 时间：2013-01-03T19:14:51.460
> 
> 标签：git

我从我的主分支创建了“本地”分支。在“本地”分支中工作时，我决定将目录中的所有文件添加`content/images/`到`.gitignore`. 所以我更新`.gitignore`了目录路径并给出了命令`git rm --cached -r content/images`。然后我提交了回购。

现在，我想将“本地”合并到 master 中，但是当我尝试结帐 master 时，我收到以下消息：

> 以下未跟踪的工作树文件将被结帐覆盖：

它给出了目录中所有文件的列表`content/images/`。

我有点理解 Git 出现问题的原因，但我不知道该怎么办。如何将这些文件添加到`.gitignore`，并在我的分支中同步这些首选项？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T19:33:51.583

这个[相关的问题和答案](https://stackoverflow.com/questions/2029759/having-trouble-checking-out-master-in-git-after-removing-directory-from-reposito?rq=1)解决了我的问题。

我只需要使用“强制”命令 ( `git checkout -f master`) 来强制签出 master，然后`git rm --cached -r content/images`在该分支上运行。

# javascript - Jquery / Javascript - 构建选择菜单的最有效方法？

> ID：14145563
> 
> 赞同：0
> 
> 时间：2013-01-03T19:14:59.700
> 
> 标签：javascript, jquery

我正在使用 jquery 并尝试调整我的选择菜单构建器以更快地运行。

我使用了 each 和 append，但是我已经切换到标准 for 循环，目前正试图将我的选项从使用 append 转换为使用 .html() 附加到我的选择选项的连接字符串。试图将我的 var 选项对象转换回 html 字符串时，我似乎不知所措。有人可以告诉我我可能做错了什么。

```
$.selectMenuBuilder = function(json) {
    var myselect = $("#myselect");    
    var list = "<option value=\"\">> Select Account Number</option>";

    var l= json.funding.length;
    for(var i=0;i<l; i++) { 
       var funding = json.funding[i];    
       var option = $("<option value=\"" + funding.id + "\">" + funding.accountNumber + "</option>")

       if(someLogic) {
           option.attr("selected", "selected");
       }

       //Having trouble here converting option object back to html. 
       list += option.html();
   }

   list += "<option value=\"addnew\">+ New Account Number</option>";

   myselect .html(list);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T19:20:03.880

您完全可以不用使用 jQuery 来创建`option`元素（除非您使用它还有其他不为人知的原因）。

即代替

```
var option = $("<option value=\"" + funding.id + "\">" + funding.accountNumber + "</option>")
if(someLogic) option.attr("selected", "selected"); 
```

你可以做：

```
list += "<option value=\"" + funding.id + "\" "+ (someLogic?'selected':'') +">" + funding.accountNumber + "</option>" 
```

* * *

其次，`$(option).html()`将返回*选项*`innerHTML`元素的，不包括*选项标签名称*。为了以跨浏览器的方式执行此操作，您可以将选项包装在外部元素中并使用它来代替。**`innerHTML`**

 **IE

`$(option).wrap('<select/>').parent().html()`会给你你想要的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-03T19:32:46.793

如果你想保持`for`循环但想要看起来更干净的东西，试试这个：

```
function menuBuilder( json ) {

  var list = [],
      $select = $('#myselect'),
      i = 0, 
      l = json.funding.length,
      funding;

  for ( ; i < l; i++ ) {
    funding = json.funding[ i ];
    list.push(
      '<option '+ somelogic ? 'selected' : ''+' value='+ funding.id +'>'+
        funding.accountNumber +
      '</option>'
    );
  }

  $select.append(
    '<option>Select Account Number</option>'+
    list.join('') +
    '<option value="addnew">New Account Number</option>'
  );

} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-03T19:26:47.763

您可以像这样更有效地创建元素：

```
$.selectMenuBuilder = function (json) {
    var myselect = $("#myselect");

    var l = json.funding.length;
    for (var i = 0; i < l; i++) {
        var funding = json.funding[i];

        var opt = $("<option/>", {
            value: funding.id,
            html: funding.accountNumber,
            selected: somelogic ? true : false //Pre-select option
        });

        myselect.append(opt);

    }

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-03T19:52:43.633

纯 JavaScript 的效率

[示例 jsfiddle](http://jsfiddle.net/g2gkp/1/)

```
selectMenuBuilder = function(json) {
    var myselect = document.getElementById("myselect"),
        listItem = document.createElement("option"),
        l = json.funding.length,
        someLogic = false; // placeholder

    listItem.innerText = "> Select Account Number";
    myselect.appendChild(listItem);

    for (var i = 0; i < l; i++) {
        var funding = json.funding[i];
        var listItem = document.createElement("option");

        if (someLogic) {
            listItem.setAttribute("checked", "checked");
        }
        listItem.setAttribute("value", funding.id);
        listItem.innerText = funding.accountNumber;

        myselect.appendChild(listItem);
    }

    listItem = document.createElement("option")
    listItem.setAttribute("value", "addnew");
    listItem.innerText = "+ New Account Number";
    myselect.appendChild(listItem);
} 
```**

# android - 使用 Android 应用程序访问安全的 Restlet url

> ID：14145573
> 
> 赞同：1
> 
> 时间：2013-01-03T19:15:31.180
> 
> 标签：android, restlet, restlet-2.0

我正在尝试使用 Restlet 框架在 Google 的 App Engine 上构建一个基本的 Web 服务。

我已经设置了一个基本设置，并遵循[使用 RESTlet 的细粒度身份验证](https://stackoverflow.com/questions/2217418/fine-grained-authentication-with-restlet)来创建一组非常简单的经过身份验证的资源。我已经在 Chrome 中对此进行了测试，它会提示我登录，然后我就可以访问该资源。

现在，我的问题是如何从 Android 应用程序进行设置？我是否必须传递要在标头中签入的凭据？如果是这样，这是如何实现的，或者还有其他使用 Restlet 的方法吗？我还没有实现 SSL，但我并不担心这个项目的安全性。

我似乎无法找到这方面的太多信息。

非常感谢。

# php - Memcache 城市查找表与否

> ID：14145576
> 
> 赞同：1
> 
> 时间：2013-01-03T19:15:37.123
> 
> 标签：php, mysql, caching, memcached

我刚刚购买了以下数据库表，以便我们的用户可以选择他们在世界各地的哪个城市：

[http://www.rocky.nu/index.php?main_page=product_info&cPath=4&products_id=13](http://www.rocky.nu/index.php?main_page=product_info&cPath=4&products_id=13)

虽然它工作得很好，但它有点慢，我们希望我们所有的用户都使用它。我已经阅读了 memcache 并且想知道是否将所有查询都缓存到该数据库是否是一个好主意，因此如果来自同一城市的用户访问该站点，它将提高它的性能。

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T19:22:12.770

我不确定 memcache，但请确保您在搜索量最高的列上有一个索引键。如果有一个唯一字段，那么该列的唯一键也是如此。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T19:43:39.290

除非您按位置或名称搜索表格，否则您无能为力。正如我在上面的评论中提到的，ID 列的数据类型不应该是`BIGINT`s；`MEDIUM INT UNSIGNED NOT NULL`会更好，如果您喜欢冒险，可以制作更高级别的`SMALL INT`索引`TINY INT`。

从国家 ID 或州 ID 获取城市应该几乎是即时的。如果你想按纬度/经度搜索，你应该使用空间的东西，但如果你不熟悉它会变得有些复杂。

PS 我假设商店页面上显示的索引已进入您的数据库。

# android - 在 Android 中实现动画菜单背景

> ID：14145581
> 
> 赞同：2
> 
> 时间：2013-01-03T19:15:48.717
> 
> 标签：android, android-layout, android-animation

我最近一直在尝试在发布之前对我的 Android 游戏进行微调，以使其对用户更具吸引力。我注意到各种成功游戏的一个简单趋势是，它们中的大多数似乎都将动画背景与菜单集成在一起。具体来说，我的意思是让一些树上的叶子在风中飘扬，或者一些云在按钮后面的屏幕上移动以开始新游戏。

## 我的问题

实现这种行为的有效方法是什么？我已经寻求了许多途径，但它们都让我质疑我正在采取的方法，因为它们似乎需要太多的开销。

## 到目前为止我已经尝试过什么

*   将背景资源 ( `android:background="animation.xml"`) 设置为动画文件，然后链接到 30 帧左右的帧。

我在使用这种方法时遇到的问题是，拥有 30 个 .png 文件，这些文件的分辨率与我的游戏打包的设备运行的屏幕具有相同的分辨率，这似乎是一种巨大的空间浪费。我应该可以直接为它们制作动画，对吧？

*   使用另一个`SurfaceView`渲染屏幕并通过硬编码位置信息简单地对其进行动画处理，并简单地覆盖按钮。

这里的问题是我必须处理停止一个线程、启动另一个线程（游戏线程）并确保当它们重新启动（用户按 BACK）时线程已经关闭的复杂性。仅仅为了动画菜单屏幕，这似乎是相当多的开销。

## 我所考虑的

我考虑过使用“补间动画”在屏幕上移动使用我的 .png 蒙皮的视图的想法。但是，这似乎是一种非常“hacky”的方法，如果我可以避免这种操作，我会更喜欢。

* * *

过去有没有人遇到过这方面的困难？你们各自的方法是什么？我总是可以按原样启动游戏，但我真的想让它尽可能吸引人。

任何帮助将不胜感激！

# java - 如何在 RegExp 中使用 ^（字符串开头）

> ID：14145586
> 
> 赞同：2
> 
> 时间：2013-01-03T19:15:53.120
> 
> 标签：java, regex

查看我正在进行的工作 RegExp `Ltd[.'s]{0,2}` [http://rubular.com/r/1FZvA9Nlul](http://rubular.com/r/1FZvA9Nlul)

我正在针对此列表运行它：

```
Ltd's
Ltd.
Ltd
LtdTestTEst
Ltds
sdfTestLtd 
```

如何编写 RegExp 以便我不匹配我当前的 RegExp 匹配的`sdfTestLtd`and 。`LtdTestTEst`

进一步澄清。

我通过 java 的 String.matches() 方法传递上面的列表，我希望它只为以下模式返回 true：

```
Ltd's
Ltd.
Ltd
Ltds 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-03T19:24:26.377

这应该与您的示例完全匹配： `^Ltd('?s|\.)?$`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-03T19:19:20.290

把a`^`放在开头，a`$`放在最后。

[http://rubular.com/r/F2VQUUvWLf](http://rubular.com/r/F2VQUUvWLf)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-03T19:23:14.213

你不应该这样做。

如果使用或等效方法，用于表示字符串开始/结束的`^ $`特殊字符在 Java 中通常不是必需的`String.matches()`，因为 Java（与其他语言中的其他搜索/匹配运算符相反，与 Rubular 工具相反）匹配**完整的字符串**。

```
 System.out.println("xHello".matches("Hello"));
   // false: no match
   System.out.println("xHello".matches(".*Hello"));
   // true: match
   System.out.println("sdfTestLtd ".matches("Ltd[.'s]{0,2}"));
   // false: no match 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-03T19:20:52.247

只需放在`^`开头即可。我认为您可能会对输出的工作方式感到困惑。

它似乎只打印您写入`Match result:`窗口的任何内容，但只会突出显示匹配项。

如果您还想控制字符串的结尾，那么您可以使用`$`它

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-03T20:15:31.963

使用这个正则表达式 `^Ltd[.'s]{0,2}$`

# google-app-engine - 限制查询会提高性能吗？

> ID：14145596
> 
> 赞同：0
> 
> 时间：2013-01-03T19:16:47.280
> 
> 标签：google-app-engine, google-cloud-datastore

将查询限制为一个（或多个）结果会对性能产生任何明显影响吗？

例如：

`q := datastore.NewQuery("User").Filter("Name =", uniqueUsername)`

对比

`q := datastore.NewQuery("User").Filter("Name =", uniqueUsername).Limit(1)`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T19:20:22.787

在这种情况下，如果只有一个实体与查询匹配，我不希望在这两个查询中看到任何差异。（但请随意尝试自己找出答案！）

# templates - Haskell - 自动使用导入模块中的变量

> ID：14145598
> 
> 赞同：4
> 
> 时间：2013-01-03T19:16:57.487
> 
> 标签：templates, haskell, dynamic

假设我有一个名为的模块`Item`，其中包含：

```
module Item
  ( routes ) where
routes = ["test1","test2","test3"] 
```

在`Main`模块中我有：

```
import qualified Item as I
routes = I.routes ++ ["test4", "test5"] 
```

我想知道是否有可能在编译时`ghc`动态遍历所有导入的模块，如果它们导出一个名为 routes 的变量，请将其附加到`Main`模块中的 routes 变量中。所以基本上是这样的：

```
import qualified Item as I
import qualified User as U --this one exports routes also
import qualified NoRoutes as NR --this one doesn't have any routes
routes = ["test4","test5"] 
```

编译后，最终结果将是`routes = I.routes ++ U.routes ++ ["test4","test5"]`

我不确定 Template Haskell 是否会这样做。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-03T19:37:44.413

模板 Haskell 可能是最简单的方法。

TH 允许您向编译器询问诸如“模块 X 是否导出名为 Y 的东西？”之类的问题。它允许您自动生成代码以将所有路由附加在一起。

另一种方法是编写一个 Haskell 程序，该程序读取您的 Haskell 源代码并输出包含您的 Main 模块的文本文件。这很棘手，除非您的所有模块都`routes`以一种相当具体的方式定义（例如，如果存在，则始终位于第 5 行）。TH 可能会容易得多。

# php - While循环直到达到数量

> ID：14145601
> 
> 赞同：1
> 
> 时间：2013-01-03T19:17:03.420
> 
> 标签：php

我想做这样的事情

```
$x = 630;
$y = 10;

while ($y < $x){
// do something
$y+10;
} 
```

当我使用`$y++`它时它正在工作并添加+1，但使用+10 它不起作用。但我需要走+10步。任何指针？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T19:18:04.977

在您的代码中，您没有递增`$y`：`$y+10`返回`$y`plus的值`10`，但您需要将其分配给`$y`.

您可以通过多种方式做到这一点：

*   `$y = $y + 10;`
*   `$y += 10;`

例子 ：

```
$x = 630;
$y = 10;
while ($y < $x){
    // do something
    $y = $y + 10;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T19:20:16.750

这是因为 $y++ 等价于 $y = $y + 1; 您没有在 $y 中分配新值。请试试

```
$y += 10; 
```

或者

```
$y = $y + 10; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-03T19:22:34.407

```
// commenting the code with description
$x = 630; // initialize x
$y = 10;  // initialize y

while ($y < $x){ // checking whether x is greater than y or not. if it is greater enter loop
// do something
$y = $y+10; // you need to assign the addition operation to a variable. now y is added to 10 and the result is assigned to y. please note that $y++ is equivalent to $y = $y + 1
} 
```

# php - 将 ODATA 查询 uri 解析为 PHP 数组

> ID：14145604
> 
> 赞同：3
> 
> 时间：2013-01-03T19:17:37.800
> 
> 标签：php, parsing, query-string, odata, string-parsing

我有一个客户端调用我用 PHP 编写的 Web 服务。在调用它时，客户端应用程序会向它提供一个小查询字符串。我想将此字符串解析为一个数组。因此，使用 url 中给定的示例查询，我开始这样做：

```
Url: $select=substringof("customer", tolower(toupper(bla))),test$filter=Name%20eq%20'test'%20and%20toupper(Name)$skip=10$top=2$orderby=day(time)%20desc 
```

.

```
<?php
function parseOdataRequest($request)
{
    $expression = array();

    // Fetch parameters
    $params = explode('$', $request);

    // Leave empty parameter name alone
    unset($params[0]);
    $params = array_values($params);

    // Check every parameter
    for($i = 0; $i < count($params); $i++)
    {
        // every parameter has to be a name=value pair!
        $param = explode('=', $params[$i]);         

        if(!(count($param) == 2))
            throw new Exception("Invalid parameter. Providence must be name=value");

        // Validate parameter name
        if(in_array($param[0], $this->validParams))
        {                           
            $parseParam = 'parse' . ucfirst(strtolower($param[0]));
            $expression[$param[0]] = $this->$parseParam($param[1]);             
        }
        else            
            throw new Exception("Unkown parameter '" . $param[0] . "'");            
    }
    var_dump($expression);
}
?> 
```

结果，我有以下 $ 表达式：

```
array (size=5)
  'select' => null
  'filter' => null
  'skip' => null
  'top' => null
  'orderby' => null 
```

我想要的是如下内容：

```
 array (size=5)
  'select' => 
    array (size=2)
      'substringof' => 
        array (size=2)
          0 => string 'customer' (length=8)
          'tolower' => 
            array (size=1)
              'toupper' => 
                array (size=1)
                  0 => string 'bla' (length=3)
      0 => string 'test' (length=4)
  'filter' => 
    array (size=3)
      0 => 
        array (size=3)
          0 => string 'Name' (length=4)
          1 => string 'eq' (length=2)
          2 => string ''test'' (length=6)
      1 => string 'and' (length=3)
      2 => 
        array (size=3)
          'toupper' => 
            array (size=1)
              0 => string 'Name' (length=4)
          0 => string 'eq' (length=2)
          1 => string ''TEST'' (length=6)
  'skip' => int 10
  'top' => int 2
  'order' => 
    array (size=1)
      0 => 
        array (size=2)
          'day' => 
            array (size=1)
              0 => string 'time' (length=4)
          0 => string 'desc' (length=4) 
```

我尝试了不同的事情，但从未成功。我将不胜感激解决此问题的方法。

# ruby-on-rails - 测试载波不断返回“图像不能为空白”-错误

> ID：14145605
> 
> 赞同：0
> 
> 时间：2013-01-03T19:17:41.653
> 
> 标签：ruby-on-rails, rspec, factory-bot, carrierwave

我一直在实现carrierwave，它在浏览器中运行良好。但是，我的测试不断返回：

**错误**

```
 1) Item 
     Failure/Error: it { should be_valid }
       expected valid? to return true, got false
     # ./spec/models/item_spec.rb:36:in `block (2 levels) in <top (required)>' 
```

**工厂.rb**

```
include ActionDispatch::TestProcess

FactoryGirl.define do

  sequence(:email) { |n| "User#{n}@example.com"}

  factory :user do
    name     "John doe"
    email
    password "foobar"
    password_confirmation "foobar"
  end

  factory :list do
    name "Lorem ipsum"
    user
  end

  factory :item do
    image { fixture_file_upload(Rails.root.join('spec', 'support', 'test_images', 'google.png'), 'image/png') }
    title "Shirt"
    link "www.example.com"
    list
  end
end 
```

**item_spec.rb**

```
require 'spec_helper'

describe Item do

  let(:user) { FactoryGirl.create(:user) }
    let(:list) { FactoryGirl.create(:list) }

  before do
    @item = list.items.build(title: "Lorem ipsum")
    @item.valid?
    puts @item.errors.full_messages.join("\n")
  end

  subject { @item }

  it { should respond_to(:title) }
  it { should respond_to(:list_id) }
  it { should respond_to(:list) }
  it { should respond_to(:image) }
  it { should respond_to(:remote_image_url) }
  its(:list) { should == list }

  it { should be_valid }

  describe "when list_id not present" do
    before { @item.list_id = nil }
    it { should_not be_valid }
  end

  describe "when image not present" do
    before { @item.image = "" }
    it { should_not be_valid }
  end

  describe "with blank title" do
    before { @item.title = " " }
    it { should_not be_valid }
  end

  describe "with title that is too long" do
    before { @item.title = "a" * 141 }
    it { should_not be_valid }
  end
end 
```

**项目.rb**

```
class Item < ActiveRecord::Base
  attr_accessible :link, :list_id, :title, :image, :remote_image_url
  belongs_to :list
  mount_uploader :image, ImageUploader

  validates :title, presence: true, length: { maximum: 140 }
  validates :list_id, presence: true
  validates_presence_of :image
end 
```

我在 spec/support/test_images 文件夹中有一个名为 google.png 的图像。

我对 Rails 很陌生，非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T04:20:41.777

`it { should be_valid }`

失败是因为（如您所料）主题无效。您需要找出它无效的*原因。*尝试这样的事情：

```
it "should be valid" do
  subject.valid?
  subject.errors.should be_empty
end 
```

现在示例将失败，但错误消息将更具描述性。

解决此问题的另一种方法是在您的项目中添加[pry 。](https://github.com/pry/pry)然后添加`binding.pry`您要打开控制台的位置：

```
it "should be valid" do
  subject.valid?
  binding.pry
  subject.errors.should be_empty
end 
```

现在您可以检查您的测试对象以找出验证失败的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T13:29:44.637

我觉得很愚蠢。忘记附上图片，这显然导致验证失败。

不得不改变：

```
 before do
    @item = list.items.build(title: "Lorem ipsum")
    @item.valid?
    puts @item.errors.full_messages.join("\n")
 end 
```

到：

```
 before do
    @item = list.items.build(title: "Lorem ipsum")
    @item.image = fixture_file_upload('/test_images/google.png', 'image/png')
  end 
```

# xcode - 为什么内联汇编不适用于 Xcode 中的 ARC？

> ID：14145613
> 
> 赞同：2
> 
> 时间：2013-01-03T19:18:11.353
> 
> 标签：xcode, automatic-ref-counting, llvm, inline-assembly

我真的对这个主题感到困惑。我在 Xcode 上使用 LLVM 4.1 编译器，当我在 ARC 关闭的 32 位或 x64 或 x64-x86 模式下编译这样的简单基本代码时，一切正常，但如果我使用自动引用计数模式编译；我收到`BAD_ACCESS`错误。

这是一个示例代码：

```
-(void) doNothing{

__asm__ volatile(
             "pushl %ebp;"
             "movl %esp , %ebp ;" 
             "movl %eax , -4(%ebp);"
             "movl %ebp, %esp;"
             "popl %ebp;"
             "leave;" 
             "ret  "    // retl in x86
             );

} 
```

我试图找出错误的来源我发现推送/弹出是唯一在 ARC 模式下工作的部分！

这太令人沮丧了，因为我过去在内联汇编中编写了一个巨大的代码，现在我必须将它与 ARC 连接到一个模块中。现在如果我不能解决它，我可能需要修改所有模块以便在没有 ARC 的情况下工作！

任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T19:21:34.093

可能有一个解决方案，但如果您无法修复它，您可以将有问题的方法的实现移动到一个类别中，并使用 -fno-objc-arc 仅编译该类别。这样，您的 objc 代码仍然是弧形的，并且您可以让汇编器正常工作

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-04T07:05:08.050

我建议尝试将汇编代码放在 C 或 C++ 函数中，而不是 ObjC 消息中。并添加`__attribute__((naked))`到函数声明中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-04T08:05:45.063

您不能在 OS X 上以 32 位模式使用 ARC。根据[Objective-C 功能可用性指数](http://developer.apple.com/library/ios/#releasenotes/ObjectiveC/ObjCAvailabilityIndex/_index.html%23//apple_ref/doc/uid/TP40012243)，ARC 需要 OS X 上的 64 位系统。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-03T22:28:28.673

我找到了解决方案，但不知道为什么它有效！我将给出答案，谁可以解释它。我意识到问题的主要原因与 ARC 的 x64 行为有关。所以我更改了代码并删除了“leave”和“ret”行，现在它可以工作了，但我不知道：1-为什么 ARC 即使在 x86 模式下也表现得像 x64 和 2-为什么我必须省略“leave”和“ret”新代码：

```
 "pushq %rbp;"
             "movq %rsp , %rbp ;"
             "movl %eax , -4(%rbp);"
             "popq %rbp;"
             ); 
```

# sql-server - T-SQL 用户定义函数或类似函数，用于从值列表中计算最大值（日期）

> ID：14145614
> 
> 赞同：2
> 
> 时间：2013-01-03T19:18:11.223
> 
> 标签：sql-server, tsql, stored-procedures, user-defined-functions, sql-server-2012

假设我有一个必须像这样查询的来源：

```
Select Fields 
from TableA A
join TableB B on A.SomeField = B.SomeField
join TableC C on B.SomeField = C.SomeField
Join TableD D on C.SomeField = D.SomeField
Where 
    CustomMaxDateFunction (A.SomeDateField, B.SomeDateField, C.SomeDateField, D.SomeDateField) > '20130101 23:59:00' 
```

我知道我可以将 where 子句写成如下内容，但我不想这样做：

```
Where 
  A.SomeDateField > '20130101 23:59:00' 
  OR B.SomeDateField > '20130101 23:59:00' 
  OR C.SomeDateField > '20130101 23:59:00' 
  OR D.SomeDateField > '20130101 23:59:00' 
```

请记住，要比较的列数将根据连接中源表的数量而变化。

关于执行此操作的最简单方法的任何建议，因为我们将不得不重复使用自定义函数（或存储过程）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-03T19:48:35.343

您可以只使用内置的 MAX 聚合，而不是创建新函数。

```
SELECT MAX(v) FROM (VALUES(A.SomeDateField),(B.SomeDateFiled),(C.SomeDateField),(D.SomeDateField))dates(v) 
```

或在您查询的上下文中：

```
SELECT *
FROM TableA AS A
JOIN TableB AS B
ON ...
JOIN TableC AS C
ON ...
JOIN TableD AS D
ON ...
WHERE (SELECT MAX(v) FROM (VALUES(A.SomeDateField),(B.SomeDateFiled),(C.SomeDateField),(D.SomeDateField))dates(v)) > '20130101 23:59:00' 
```

如果这还不够干净，你可以把它包装成一个函数

```
CREATE FUNCTION dbo.CustomMaxDateFunction(@v1 DATETIME, @v2 DATETIME, @v3 DATETIME, @v4 DATETIME)
RETURNS TABLE
AS
  RETURN SELECT MAX(v) MaxDate FROM (VALUES(@v1),(@v2),(@v3),(@v4))dates(v); 
```

然后这样称呼它：

```
SELECT *
FROM TableA AS A
JOIN TableB AS B
ON ...
JOIN TableC AS C
ON ...
JOIN TableD AS D
ON ...
CROSS APPLY dbo.CustomMaxDateFunction(A.SomeDateField, B.SomeDateFiled, C.SomeDateField, D.SomeDateField) AS mdf
WHERE mdf.MaxDate > '20130101 23:59:00' 
```

在此查询上下文中远离其他形式的函数，因为它们会损害性能： [http ://sqlity.net/en/498/t-sql-tuesday-24-prox-n-funx/](http://sqlity.net/en/498/t-sql-tuesday-24-prox-n-funx/)

然而，所有函数都有一个共同点，即您固定在给定数量的参数上，因此第一个选项可能是您最好的选择。

编辑：如果你真的喜欢函数的想法，你可以这样做：

```
CREATE FUNCTION dbo.CustomMaxDateFunction(@v1 DATETIME, @v2 DATETIME, @v3 DATETIME, @v4 DATETIME)
    RETURNS TABLE
    AS
      RETURN SELECT MAX(v) MaxDate FROM (VALUES(@v1),(@v2),(@v3),(@v4))dates(v) WHERE v IS NOT NULL; 
```

现在你可以这样称呼它：

```
SELECT *
FROM TableA AS A
JOIN TableB AS B
ON ...
CROSS APPLY dbo.CustomMaxDateFunction(A.SomeDateField, B.SomeDateFiled, NULL, NULL) AS mdf
WHERE mdf.MaxDate > '20130101 23:59:00' 
```

您基本上必须用 NULL 填充未使用的参数。函数中的附加 WHERE 子句可防止您收到有关已消除 NULL 值的警告。正如评论中提到的 RBarryYoung，SQL Server 中的函数没有真正的可选参数功能。

# ruby-on-rails - Rails - 如何让我的远程表单用 JS 响应？

> ID：14145615
> 
> 赞同：8
> 
> 时间：2013-01-03T19:18:11.913
> 
> 标签：ruby-on-rails, ruby-on-rails-3, jquery, ruby-on-rails-3.2

我有一个列出项目的页面。在每个项目下方，它列出了该项目的所有评论（评论是项目下的嵌套资源）。

您可以在项目页面上在线添加新评论。当您这样做时，它正在重新加载整个页面，因此我想将其更改为使用 Ajax 并仅使用 jQuery 插入评论。

所以我改变了我的评论/_form.html.erb 使用 :remote=>true

```
<%= form_for([@item,@comment], :remote=>true) do |f| %> 
```

我在 comments_controller 中添加了 format.js：

```
def create
  @comment = Comment.new(params[:comment])
  @comment.save

  respond_to do |format|
    format.js
    format.html { redirect_to items_path}
  end
end 
```

并创建了一个简单的 comments/create.js.erb 来将新的评论插入页面：

```
$("#comments").append("<%= j(render(@comment)) %>"); 
```

但是，当我提交评论时（即使在表单上使用 :remote=>true），它也会不断重新加载整个页面/忽略我的 .js 文件。

所以我从 respond_to 中删除了 format.html（因为我不想使用那个选项），但是它给了我错误**Completed 406 Not Acceptable in 4ms (ActiveRecord: 0.2ms)**

我怎样才能让它留在当前页面上并用我的 create.js 响应？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-03T22:00:03.387

我刚刚发现了问题：

我正在使用 javascript: 提交我的评论表单`this.form.submit()`。当我不使用`:remote=>true`. 但是由于某种原因，当我制作表格时会中断`:remote=>true`。

如果我使用实际的提交按钮，我的问题中的代码可以正常工作。

或者，如果我将 JavaScript 从`this.form.submit()`使用 jQuery 更改为通过 id 选择表单并提交，那也可以：

```
$("#new_comment_<%= @item.id %>").submit(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2020-03-14T20:45:36.323

我在 2020 年尝试使用 Rails 6 找出类似的东西时遇到了这个问题。

我有一个使用. 默认情况下创建的表单，`form_with`我使用. 这不起作用，但使用按钮代替工作，就像在原始问题中一样。`remote: true``submit()``HTMLFormElement``<input type="submit">`

这背后的原因是`submit()`在 JavaScript 中调用不会触发`onsubmit`表单上的事件，而单击`<input type="submit">`按钮会触发此事件（[MDN 文档](https://developer.mozilla.org/en-US/docs/Web/API/HTMLFormElement/submit)）。Rails 的处理`remote: true`取决于此事件被触发，因此行为中断。

我使用[此答案](https://stackoverflow.com/a/18072246/12288625)中的解决方法在 JavaScript 中提交我的表单，并且该`remote: true`行为现在按预期工作。

此外，如果您正在使用`rails-ujs`，则可以使用此包装器提交表单（[source](https://github.com/rails/rails/issues/29546#issuecomment-313981539)）：

```
form = document.querySelector('form');
Rails.fire(form, 'submit'); 
```

我希望这对其他人有帮助！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-03T21:22:09.563

您应该添加`:format => :js`到您的 form_for

并可能更新，

```
format.js { render :nothing => true } 
```

# php - CSS中媒体查询的正则表达式

> ID：14145620
> 
> 赞同：4
> 
> 时间：2013-01-03T19:18:34.857
> 
> 标签：php, regex, styles, media-queries

我正在寻找一种从 CSS 文件中提取媒体查询的方法。

```
/* "normal" css selectors

@media only screen and (max-device-width: 480px) {
    body{-webkit-text-size-adjust:auto;-ms-text-size-adjust:auto;}
    img {max-width: 100% !important; 
         height: auto !important; 
    }
}

@media only screen and (max-device-width: 320px) {
    .content{ 
        width: 320px;
    }
} 
```

现在我喜欢只获取媒体查询。我虽然开始总是`@media`，搜索的结束总是一个大括号，后跟一些可选的空格和另一个大括号。

我唯一拥有的是

```
preg_match_all('#@media ?[^{]+?{XXX#',$stylesheetstring, $result); 
```

是`XXX`我正在寻找的缺失部分。

当前的（没有 X）只返回第一行（显然）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-03T19:33:22.223

假设您想要整个媒体块，我认为这不是正则表达式的正确工作。

但是，您可以实现一个简单的解析函数：

```
function parseMediaBlocks($css)
{
    $mediaBlocks = array();

    $start = 0;
    while (($start = strpos($css, "@media", $start)) !== false)
    {
        // stack to manage brackets
        $s = array();

        // get the first opening bracket
        $i = strpos($css, "{", $start);

        // if $i is false, then there is probably a css syntax error
        if ($i !== false)
        {
            // push bracket onto stack
            array_push($s, $css[$i]);

            // move past first bracket
            $i++;

            while (!empty($s))
            {
                // if the character is an opening bracket, push it onto the stack, otherwise pop the stack
                if ($css[$i] == "{")
                {
                    array_push($s, "{");
                }
                elseif ($css[$i] == "}")
                {
                    array_pop($s);
                }

                $i++;
            }

            // cut the media block out of the css and store
            $mediaBlocks[] = substr($css, $start, ($i + 1) - $start);

            // set the new $start to the end of the block
            $start = $i;
        }
    }

    return $mediaBlocks;
} 
```

# android - Android 滑动库

> ID：14145621
> 
> 赞同：-1
> 
> 时间：2013-01-03T19:18:38.123
> 
> 标签：android, android-library

我试图找到问题但无济于事，我按照说明添加了库

> （LibraryProject 为Library，myProject 中为addLibrary）

当我开始我的**项目**时出现**错误：**

**日志：**

```
FATAL EXCEPTION: main
java.lang.NoClassDefFoundError: com.slidingmenu.lib.SlidingMenu
    at ru.com.whatyouwant.MainActivity.onCreate(MainActivity.java:35) 
```

和**Activity.class**

```
@Override
protected void onCreate(Bundle savedInstanceState){
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    //SlidingMenu Line 35
    SlidingMenu menu = new SlidingMenu(this);
    menu.setMode(SlidingMenu.LEFT);
    menu.setTouchModeAbove(SlidingMenu.TOUCHMODE_FULLSCREEN);
    menu.setShadowWidth(10);
    menu.setSlidingEnabled(true);
    menu.setFadeDegree(0.35f);
    menu.setMenu(R.layout.menu);

    // Initialize ID's
    mText = (EditText)findViewById(R.id.fullscreen_content);
    pop_up_menu = (LinearLayout) findViewById(R.id.pop_up_menu);
    mFiles = new FileOptions(this);

    //Menu ID's
    menu_save = (TextView) findViewById(R.id.pop_up_save);
    menu_save.setOnClickListener(onMenu_save);

    menu_delete = (TextView) findViewById(R.id.pop_up_delete);
    menu_delete.setOnClickListener(onMenu_delete);

    // Call Popup Menu
    mText.setOnLongClickListener(new OnLongClickListener() {

        @Override
        public boolean onLongClick(View v) {
            new PopupMenu(pop_up_menu, MainActivity.this);
            return false;
        }
    });

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T20:58:15.727

您没有从您的应用项目中引用的库项目。假设您已经将两个项目都导入了 Eclipse：

> 1) 选择你的项目
> 
> 2）右键单击，**属性**
> 
> 3) 转到左侧面板列表中的**Android部分**
> 
> 4) 在**库**部分，您应该看到列出的 SlidingMenu 库项目。
> 
> 5) 按**Add...**按钮，选择**SlidingMenu**项目，然后按**OK**
> 
> 6)再次按**OK关闭项目属性窗口。**
> 
> 7) 你应该准备好了！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-06T15:53:31.197

我遇到了同样的问题。有我的解决方案：

1.  右键项目---->Properties---->Java Build Path---->Order and Export，检查项目添加为库的jar包。
2.  关闭 Eclipse 并重新启动它
3.  清理项目
4.  问题解决了

虽然问题解决了，但是我不知道是什么原因，如果有人知道，请告诉我，谢谢！

# c# - 带有选择查询的空数据集

> ID：14145626
> 
> 赞同：1
> 
> 时间：2013-01-03T19:19:06.897
> 
> 标签：c#, .net, dataset, oledb

我正在使用 OleDb 查询 Access 数据库。以下查询在 Access 中有效（如嵌套内连接和许多括号所证明的那样，Access 实际上是从设计 GUI 构建查询）。为丑陋的表/列名称道歉。

```
SELECT DISTINCT Table1.A, Table2.B, Table3.[C]
FROM (Table4 INNER JOIN (Table2 INNER JOIN Table1 ON Table2.ID = Table1.Table2ID) ON Table4.ID = Table1.Table4ID) INNER JOIN ((Table3 INNER JOIN Table5 ON Table3.ID = Table5.[Table3ID]) INNER JOIN Table6 ON Table3.ID = Table6.Table3ID) ON Table1.ID = Table6.Table1ID
WHERE (((Table1.D)=False) AND ((Table1.E)=True))) 
```

它返回许多行。但是，以下代码会导致空数据集。由于代码的设置方式可能存在语法错误（包装类处理其中一些代码行，所以为了简单起见，我不得不解开它）。

```
// db initialized prior
OleDbConnection con = new OleDbConnection(db);
con.Open();
OleDbCommand cmd = new OleDbCommand(@"
    SELECT DISTINCT Table1.A, Table2.B, Table3.[C]
    FROM (Table4 INNER JOIN (Table2 INNER JOIN Table1 ON Table2.ID = Table1.Table2ID) ON Table4.ID = Table1.Table4ID) INNER JOIN ((Table3 INNER JOIN Table5 ON Table3.ID = Table5.[Table3ID]) INNER JOIN Table6 ON Table3.ID = Table6.Table3ID) ON Table1.ID = Table6.Table1ID
    WHERE (((Table1.D)=False) AND ((Table1.E)=True)))
");
cmd.Connection = con;
DataSet data = new DataSet();
OleDbDataAdapter adapter = new OleDbDataAdapter(cmd);
adapter.Fill(data); 
```

以这种方式在数据库上执行的其他选择查询返回数据，那么为什么返回一个空数据集呢？

# ruby-on-rails-3 - 具有最佳就地形式的单选按钮？

> ID：14145629
> 
> 赞同：9
> 
> 时间：2013-01-03T19:19:12.483
> 
> 标签：ruby-on-rails-3, best-in-place

我想知道是否有任何方法可以使用 Best In Place gem 来更新单选按钮。我将它用于我的表单并且效果很好，但是 Best in place 似乎没有提供单选按钮输入类型。我猜我可以使用复选框，但我对如何将 3 个复选框绑定到同一列有点困惑。

我正在寻找的是一个简单的单选按钮集合，该集合绑定到我的模型中的一个字段，看起来像

```
 o  Our Court       #value = true
   o  Their Court     #value = false
   o  Complete         #value = nill 
```

选择后，我希望数据库立即更新，就像 Best in place 一样，对输入字段进行其他更改。

有任何想法吗？谢谢。

# java - JPA CascaseType - 仅持久化和合并

> ID：14145632
> 
> 赞同：0
> 
> 时间：2013-01-03T19:19:15.057
> 
> 标签：java, hibernate, jpa, cascade

我有一个从父母到孩子的@OneToMany。它是双向的。

我希望唯一的级联类型是持久和合并。不删除。级联类型的唯一属性值是 ALL 或枚举上的每个其他类型之一。

这可能吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T19:23:49.747

像这样使用注释

```
@OneToMany (cascade = {CascadeType.MERGE,CascadeType.PERSIST}) 
```

# android - Android 解析使用 < 和 > 而不是“<”和“>”的 XML

> ID：14145633
> 
> 赞同：1
> 
> 时间：2013-01-03T19:19:18.460
> 
> 标签：android, xml, web-services

我正在使用一个 WEB 服务，它返回 XML 格式，但使用`&lt;`和`&gt;`而不是“<”和“>”。

现在我不知道如何解析它？

我尝试了标准的**SAX 解析器：**

```
if (entity != null && responseCode==200) {

            // A Simple JSON Response Read
            InputStream instream = entity.getContent();
            BufferedReader rd = null;             
                rd = new BufferedReader(new InputStreamReader(instream));
                InputSource is=new InputSource(rd);
                WebServiceRespondParser parser=new WebServiceRespondParser(category);
                SAXParserFactory factory=SAXParserFactory.newInstance();
                SAXParser sp=factory.newSAXParser();
                XMLReader reader=sp.getXMLReader();
                reader.setContentHandler(parser);
                reader.parse(is);   
                markers=parser.getMarkers();
        } 
```

**网络服务：**

[http://gisn.tel-aviv.gov.il/ws_iriya_zmina/wsgis.asmx/GetData4TargetLayersFromAddress?Format=xml&TargetIriaLayerIDs=659&Radiuses=2000&Rechov=798&Bayit=3&Knisa=](http://gisn.tel-aviv.gov.il/ws_iriya_zmina/wsgis.asmx/GetData4TargetLayersFromAddress?Format=xml&TargetIriaLayerIDs=659&Radiuses=2000&Rechov=798&Bayit=3&Knisa=)

我读了几个类似的问题，但大多数都是不同的语言，或者没有答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T19:26:57.400

该 XML 已被编码，因为它位于标签内。您需要做的是首先解析原始 XML，然后从标签中获取值。这将为您提供现在可以照常解析的正确 XML。

# java - Richfaces 3 数据表排序不起作用

> ID：14145635
> 
> 赞同：1
> 
> 时间：2013-01-03T19:19:26.670
> 
> 标签：java, jsf, richfaces, jsf-1.2

我已经在谷歌上搜索了 2 天，并尝试了我在网上看到的各种尝试，但似乎没有什么对我有用。

我正在尝试让richfaces 3 数据表对列进行排序，当我单击列标题时，实际上没有任何内容得到排序。

有人知道我缺少什么吗？我需要在我的支持 bean 上实现一个属性吗？

```
<rich:extendedDataTable id="resultsTable" value="#{tableBacking.results}" var="results" rowKeyVar="row">
        <rich:column>
            <f:facet name="header">
                <h:outputText value="Row Number" />
            </f:facet>                  
        </rich:column>

        <rich:columns value="#{tableBacking.columns == null ? '' : tableBacking.columns}" 
            var="columns" index="ind" id="column#{ind}" 
            sortBy="#{results[ind].data}" rendered="#{tableBacking.columns != null}">
            <f:facet name="header">
                <h:outputText value="#{columns.columnDescription}" />
            </f:facet>

            <h:outputText value="#{results[ind].data}" />

        </rich:columns>
    </rich:extendedDataTable> 
```

TableLookupBacking bean

```
public class TableLookupBacking{
    private List<List<TableData>> results = null;
    private List<TableData> columns = new ArrayList<TableData>();

    public void search() {
        getData("");
    }

    private void getData(String whereClause) {

        try {
            DataDao dd = new DataDao();
            results = dd.getData(WebDataViewerConstants.SCHEMA_NAME, selectedTable, whereClause);
        } catch (Exception e) {
            FacesContext.getCurrentInstance().addMessage(null, new FacesMessage("Unable to retrieve data with selected search criteria in getData."));
        }
    }
// columns get set in another method that is triggered off something else the user does    

// Getters and Setters

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-14T14:32:11.083

我终于弄明白了。我需要做的就是添加`sortOrder="#{tableBacking.sortOrder[columns]}"`到我的`rich:columns`标签中，然后在我的支持者中添加以下内容：

```
private Map<String, Object> sortOrder = new HashMap<String, Object>();

// setter and getter 
```

# ruby-on-rails - 运行 Jekyll 命令时出错

> ID：14145636
> 
> 赞同：1
> 
> 时间：2013-01-03T19:19:28.003
> 
> 标签：ruby-on-rails, ruby, gem, jekyll, chmod

当我打算对 sudo chmod 600 -R Documents/some_directory 执行命令时，我不小心运行了命令 sudo chmod 600 -R / 并且我的 macbook pro 的文件权限搞砸了。我运行了 sudo chmod 755 -R /directories_that_don't_need_to_be_secure 并尝试修复所有权限。但是当我启动我的 Jekyll 服务器 jekyll --server --auto 时，我遇到了一堆错误。我使我的整个目录可读、可写和可执行。但是错误不断弹出。这是我在 jekyll 服务器生成时得到的：

```
 Shalin-Shah-Me:shalin shalinvs$ jekyll --server --auto
Configuration from /Users/shalinvs/Documents/Developer/Websites/shalin/_config.yml
/Library/Ruby/Site/1.8/rubygems/custom_require.rb:36:in `gem_original_require': no such file to load -- sass (LoadError)
    from /Library/Ruby/Site/1.8/rubygems/custom_require.rb:36:in `require'
    from /Users/shalinvs/Documents/Developer/Websites/shalin/_plugins/sass_converter.rb:5
    from /Library/Ruby/Site/1.8/rubygems/custom_require.rb:36:in `gem_original_require'
    from /Library/Ruby/Site/1.8/rubygems/custom_require.rb:36:in `require'
    from /Library/Ruby/Gems/1.8/gems/jekyll-0.12.0/bin/../lib/jekyll/site.rb:78:in `setup'
    from /Library/Ruby/Gems/1.8/gems/jekyll-0.12.0/bin/../lib/jekyll/site.rb:77:in `each'
    from /Library/Ruby/Gems/1.8/gems/jekyll-0.12.0/bin/../lib/jekyll/site.rb:77:in `setup'
    from /Library/Ruby/Gems/1.8/gems/jekyll-0.12.0/bin/../lib/jekyll/site.rb:76:in `each'
    from /Library/Ruby/Gems/1.8/gems/jekyll-0.12.0/bin/../lib/jekyll/site.rb:76:in `setup'
    from /Library/Ruby/Gems/1.8/gems/jekyll-0.12.0/bin/../lib/jekyll/site.rb:31:in `initialize'
    from /Library/Ruby/Gems/1.8/gems/jekyll-0.12.0/bin/jekyll:238:in `new'
    from /Library/Ruby/Gems/1.8/gems/jekyll-0.12.0/bin/jekyll:238
    from /usr/bin/jekyll:23:in `load'
    from /usr/bin/jekyll:23 
```

我也尝试使用磁盘工具来修复我的权限，但仍然没有运气。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T23:52:35.443

你能得到什么？

```
gem list sass 
```

尝试这个：

```
gem uninstall sass
gem install sass 
```

然后再次运行你的 jekyll 命令。

# c++ - 我将如何在没有链接的情况下编译 OpenCV 程序？

> ID：14145638
> 
> 赞同：2
> 
> 时间：2013-01-03T19:19:29.443
> 
> 标签：c++, opencv

我采用了“edge”示例文件并将适当的源文件移动到目录中，在需要考虑目录结构的地方更改了#include(s)，而不是使用库等进行设置。目标是制作一批更便携的代码来尝试一些事情。我想知道，鉴于链接器错误列表（很多未定义的这个和那个）。A 是否可以获取源并以我不需要链接的方式将其全部包含在内？如果是 B，那么找到哪些源文件具有正确的代码来对抗我在链接时得到的所有未定义内容的建议路线是什么？

我知道这是一个普遍的问题，但它需要一个普遍的答案，而且我还没有看到有人在这里或其他任何地方回答这个问题。我认为这完全有可能，OpenCV 是 BSD，并且所有将其编译到库中的源代码都是可用的，所以我想如果您的项目代码中有库的源代码，您可以跳过链接到外部库的步骤. 感谢任何可以帮助我或引导我走向正确方向的人，非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T09:57:47.130

如果您的项目需要完全开源的代码，您可以为所欲为。当然，从 OpenCV 中分离出您需要的内容将是一项艰巨的任务。为此，您需要手动定位包含丢失对象的文件。在 MS 资源管理器中，您可以使用“文件内部”查询进行搜索，在 linux 控制台中，您可以使用“find | grep”组合命令。

我有时会在我的项目中本地移动源文件（opencv/modules/*/src）来自定义一些功能。我还保留了编译器优先考虑的链接库，它们变得不活动，但它们仍然以其原始形式存在，占用一些可忽略不计的无用 MB。

# ios - Quartz2D：如何在运行时将剪切矩形转换为倒置蒙版？

> ID：14145641
> 
> 赞同：7
> 
> 时间：2013-01-03T19:19:39.020
> 
> 标签：ios, macos, quartz-2d, cgcontext

鉴于：

1.  `ctx`一个带框架的 CGContextRef ( )`{0,0,100,100}`
2.  和一个矩形 ( `r`)，带框架`{25,25,50,50}`

将上下文剪辑到该矩形很容易：

```
CGContextClipToRect(ctx, r); 
```

掩盖下面的红色区域*（红色==面具）*：

![在此处输入图像描述](../Images/3b2ee563b851bde420bc4faf0c8ac134.png)

但我想**反转**这个剪裁矩形以将其转换为剪裁**蒙版**。期望的结果是掩盖下面的红色部分*(red == mask)*：

![在此处输入图像描述](../Images/c345f95072f8caa071cb01b6c3853ba3.png)

我想在运行时以编程方式执行此操作。

我**不想**手动准备位图图像以与我的应用程序一起静态发布。

给定`ctx`and `r`，如何在运行时最容易/直接地做到这一点？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-03T19:42:47.633

Read about fill rules in the [“Filling a Path” section of the *Quartz 2D Programming Guide*](https://developer.apple.com/library/mac/documentation/GraphicsImaging/Conceptual/drawingwithquartz2d/dq_paths/dq_paths.html#//apple_ref/doc/uid/TP30001066-CH211-TPXREF106).

In your case, the easiest thing to do is use the even-odd fill rule. Create a path consisting of your small rectangle, and a much larger rectangle:

```
CGContextBeginPath(ctx);
CGContextAddRect(ctx, CGRectMake(25,25,50,50));
CGContextAddRect(ctx, CGRectInfinite); 
```

Then, intersect this path into the clipping path using the even-odd fill rule:

```
CGContextEOClip(ctx); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-03T19:32:44.657

`CGContextClipToRects()`您可以通过传递构成您想要的红框的矩形来剪辑上下文。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-03T19:29:37.090

你能像往常一样做所有的绘画，然后做：

```
CGContextClearRect(ctx, r); 
```

一切都完成后？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-04-12T03:11:19.580

这是实现 rob 答案的有用扩展

```
extension UIBezierPath {
    func addClipInverse() {
        let paths = UIBezierPath()
        paths.append(self)
        paths.append(.init(rect: .infinite))
        paths.usesEvenOddFillRule = true
        paths.addClip()
    }
} 
```

# actionscript-3 - 滑动按钮。Adobe Flash, as3

> ID：14145646
> 
> 赞同：0
> 
> 时间：2013-01-03T19:20:02.943
> 
> 标签：actionscript-3, flash, adobe

我正在创建一个钢琴应用程序，我希望当用户的手指在没有抬起的情况下通过所有键时，所有被按下的键都会产生声音。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T19:23:40.650

捕获`MOUSE_OVER`和`MOUSE_OUT`事件并相应地处理声音：

```
button.addEventListener(MouseEvent.MOUSE_OVER, startSound);
button.addEventListener(MouseEvent.MOUSE_OUT, stopSound);

function startSound(me:MouseEvent):void {
    // Start the sound.
}
function stopSound(me:MouseEvent):void {
    // Stop the sound.
} 
```

# java - 在 JavaEE 项目中使用 rmi

> ID：14145647
> 
> 赞同：0
> 
> 时间：2013-01-03T19:20:06.303
> 
> 标签：java, jakarta-ee, glassfish, rmi, policy

我正在尝试在带有 NetBeans 的 java 项目中使用 rmi；直到我使用它正在工作的一个简单的java项目，现在我总是收到这个异常：

```
ClientRMI exception:
java.security.AccessControlException: access denied ("java.net.SocketPermission" "127.0.0.1:1099" "connect,resolve") 
```

我认为我的策略文件没问题，它指向项目的 .class 文件，我使用 NetBeans 的 VM 选项调用它：

```
-Djava.rmi.server.hostname=localhost -Djava.security.policy=policy 
```

工作目录与策略文件相同。

有什么问题？

# java - 如何启用禁用的 JRadioButton

> ID：14145648
> 
> 赞同：3
> 
> 时间：2013-01-03T19:20:11.593
> 
> 标签：java, swing, jradiobutton

我有两个 JRadioButton，每个都有 ImageIcon。由于我正在使用 ImageIcons，我需要给出一个按钮被选中而另一个按钮未被选中的外观。为此，我尝试禁用另一个按钮，该按钮会自动将 ImageIcon 更改为禁用外观。

问题是当我单击禁用的 JRadioButton 时，什么也没有发生，甚至 JRadioButton 上的 ActionListener 也没有被调用。

有没有办法通过直接单击来启用禁用的 JRadioButton？一旦它被禁用，它的 ActionListener 就不再被调用，所以我不能通过点击它来启用它。

基本上我试图给出一个外观，当一个被选中时，另一个没有被选中，使用 ImageIcons。

```
//Below part of my code how I initialize the buttons
ButtonGroup codeSearchGroup = new ButtonGroup();

searchAllDocs = new JRadioButton(new ImageIcon(img1));
searchCurrDoc = new JRadioButton(new ImageIcon(img2));

RadioListener myListener = new RadioListener();
searchAllDocs.addActionListener(myListener);
searchCurrDoc.addActionListener(myListener);

codeSearchGroup.add(searchAllDocs);
codeSearchGroup.add(searchCurrDoc);

//Below listener class for buttons
class RadioListener implements ActionListener {  
    public void actionPerformed(ActionEvent e) {

        if(e.getSource() == searchAllDocs){
            searchAllDocs.setEnabled(true);
            System.out.println("Search All documents pressed. Disabling current button...");
            searchCurrDoc.setEnabled(false);

        } 
        else{
            searchCurrDoc.setEnabled(true);
            System.out.println("Search Current document pressed. Disabling all button...");
            searchAllDocs.setEnabled(false);
        }
    }

} 
```

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-03T19:34:36.687

`ActionListener`在禁用模式下不会触发，但鼠标*事件*会。

因此，只需添加一个`MouseAdapter`to`JRadioButton`并覆盖`mouseClicked(..)`并`setEnable(true)`在覆盖的方法中调用，如下所示：

```
 JRadioButton jrb = new JRadioButton("hello");
    jrb.setEnabled(false);

    jrb.addMouseListener(new MouseAdapter() {
        @Override
        public void mouseClicked(MouseEvent me) {
            super.mouseClicked(me);
            JRadioButton jrb = (JRadioButton) me.getSource();
            if (!jrb.isEnabled()) {//the JRadioButton is disabled so we should enable it
                //System.out.println("here");
                jrb.setEnabled(true);
            }
        }
    }); 
```

虽然我必须说有一些扭曲的逻辑在起作用。如果某些东西被禁用是有原因的，那么我们不应该让用户能够启用。如果我们这样做，应该有一个控制系统，我们可以选择启用/禁用按钮，它不会成为控制系统本身。

# crystal-reports - 如何在水晶报表中不计算组的重复记录

> ID：14145649
> 
> 赞同：0
> 
> 时间：2013-01-03T19:20:11.110
> 
> 标签：crystal-reports

我在水晶报告中有一份报告。在详细信息部分它显示像这些有重复记录

![在此处输入图像描述](../Images/e7a40f5121f2039f8579d27445a209cf.png)

当我总计时，我不想计算重复记录。

我尝试在运行总计字段（项目）<>上一个（项目）中编写运行总计公式，然后我得到结果。红色数字 ![在此处输入图像描述](../Images/318d033c8d05e05ba5010cd89626d146.png)

出了点问题，但我只是不知道如何解决它。谢谢

# opacity - IE 9 及更低版本上的 CSS（不透明度）

> ID：14145650
> 
> 赞同：0
> 
> 时间：2013-01-03T19:20:15.783
> 
> 标签：opacity

我的网站[exerciserx.net](http://www.exerciserx.net)在 Chrome/Mozilla 上看起来不错，但在 IE 8 上并降低了它的恶心（我知道你可能以前听说过）但在 IE 9 上，悬停时导航完全黑暗......我把所有必要的 css （希望..）但是有没有办法让网站在其他浏览器上看起来相同（或接近）？非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T19:23:10.043

您可能需要的是 PIE (http://css3pie.com/) 它有很多针对旧版本 IE 的很酷的修复程序，但请注意，如果使用了太多样式，它可能会在这些浏览器中减慢您的网站速度。

# php - 缓存大型 SQL 查询 - 结构化的最佳方式？

> ID：14145659
> 
> 赞同：1
> 
> 时间：2013-01-03T19:20:30.603
> 
> 标签：php, mysql, caching, optimization

让我举一个我的问题的例子。假设我有一个名为**users**的表和一个名为**payment**的表。为了计算用户的总余额，我会使用查询来获取某个日期之后的所有付款，然后将结果缓存一段时间。

但是，我想知道，由于这种性质，在 users 表中调用一个列，`balance`然后当缓存过期时，我使用不同的查询来收集付款，但从更短的时间和然后将此金额添加到`balance`列中的任何内容中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T19:27:01.740

> 要计算用户的总余额，

您可以创建一个始终包含用户当前余额的附加表。如果为用户添加了新的付款，则该列也需要更新。进行交易，以便添加付款和更新总余额是一致的。

如果您需要更多差异化，您可以在用户关系旁边保留一个日期列，表示您需要能够进行计算的时间间隔。例如，能够返回过去查看的周数或月数。

如果您需要更大的灵活性，您可以在一段时间后将现有付款压缩为总价值，并将其存储到与用户相关并保留日期列的余额表中。

然后，您可以将它与尚未压缩/压缩的日期的“实时”付款表联合起来。然后使用聚合函数对总余额求和。如果您需要保留更详细的最新数据，这可能会为您提供两全其美的效果，您可以在一段时间后移出数据存储区，只保留统计值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-03T19:26:50.283

通常，使用这些“预先计算”的值，我发现最轻松的方法是在保存任何涉及数据的模型时存储/更新它们

简而言之，只要保存新的付款，就更新总余额。这样您就可以保证您的数据库和数据始终保持同步

预计算可以是 mysql 触发器，也可以是带有 Gearman 之类的后台任务

* * *

但是，正如您自己的问题所建议的那样，如果您想对余额进行某种增量汇总，我建议您按月或某个固定日期范围进行。如果您没有付款回溯或类似的情况，这将起作用，付款可能会出现在旧月份。

新的一个月开始，运行一个支付聚合器，bam，你现在只需要对月表求和。

这完全取决于您必须处理多少数据。但我再次强调，数据一致性比速度更有价值，你总是可以购买更多的服务器。

# objective-c - 从目标 c 调用 asp.net webservice 以返回带有参数的 JSON 格式的数据

> ID：14145663
> 
> 赞同：1
> 
> 时间：2013-01-03T19:20:47.707
> 
> 标签：objective-c, ios, web-services, exception, parameters

```
<ServiceContract()> _
Public Interface IGetEmployees
 <OperationContract()> _
<WebInvoke(Method:="GET", ResponseFormat:=WebMessageFormat.Json,BodyStyle:=WebMessageBodyStyle.Wrapped, UriTemplate:="json/contactoptions/?strCustomerID={strCustomerID}")> _
Function GetAllContactsMethod(strCustomerID As String) As List(Of NContactNames)
End Interface

   <WebMethod()> _
<ScriptMethod(ResponseFormat:=ResponseFormat.Json)> _
Public Function GetAllContactsMethod(strCustomerID As String) As List(Of NContactNames) Implements IGetEmployees.GetAllContactsMethod
Utilities.log("Hit get all contacts at 56")
Dim intCustomerID As Integer = Convert.ToInt32(strCustomerID)
Dim lstContactNames As New List(Of NContactNames)
'I add some contacts to the list.
Utilities.log("returning the lst count of " & lstContactNames.Count)
Return lstContactNames
End Function 
```

因此，当我编写上述代码并在浏览器中调用它时，像这样[http://xyz-dev.com/GetEmployees.svc/json/contactoptions/?strCustomerID=123](http://xyz-dev.com/GetEmployees.svc/json/contactoptions/?strCustomerID=123)我得到 10 行作为 JSON 格式的结果。这正是我的意图。但是当我从目标 c 端调用时，它会抛出这样的异常

```
Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: 'data parameter is nil' 
```

我的目标c代码是：

```
 NSString *strCustomerID = [NSString stringWithFormat:@"%i",123];
    jUrlString = [NSString stringWithFormat:@"%@?strCustomerID=%@",@"https://xyz-dev.com/GetEmployees.svc/json/contactoptions/",strCustomerID];
NSLog(@"the jurlstring is %@",jUrlString);
    NSURL *jurl = [NSURL URLWithString:jUrlString];
NSError *jError;
    NSData *jData = [NSData dataWithContentsOfURL:jurl];
    NSMutableDictionary *json = [NSJSONSerialization JSONObjectWithData:jData options:kNilOptions error:&jError];
    NSLog(@"%@",json);
    NSLog(@"Done"); 
```

NSJSONSerialization 行发生异常。所以这是我的问题的延续，[Web service method not hit when called via Objective C](https://stackoverflow.com/questions/14130450/web-service-method-not-hit-when-called-via-objective-c.But)我稍微改变了我的代码，所以我发布了一个新问题。这是我在 asp 端编写 uritemplate 的正确方式吗？这是我在 iOS 端调用的正确方式吗？如果您需要更多信息，请告诉我。谢谢..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T19:32:14.033

您的网址似乎不正确。确保它是正确的。

您需要按照 NSURLConnectionDelegate 来设置此服务。这是我经常重复使用的一些示例代码。您需要设置连接，然后正确处理您的数据。我创建了一个委托并在完成或错误时通知。

文档：http: [//developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSURLConnection_Class/Reference/Reference.html](http://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSURLConnection_Class/Reference/Reference.html)

前任。

```
#define kBgQueue dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0)

@implementation JSONService
@synthesize delegate;

- (void)start{
    dispatch_async(kBgQueue, ^{
        NSError *error = nil;
        NSURL *nsURL = [NSURL URLWithString:[NSString stringWithFormat:@"%@?strCustomerID=%@",@"https://xyz-dev.com/GetEmployees.svc/json/contactoptions",strCustomerID]];
        NSData* data = [NSData dataWithContentsOfURL:nsURL options:NSDataReadingUncached error:&error];
        if (error) {
            NSLog(@"%@", [error localizedDescription]);
            [self notifyDelegateOfError:error];

        } else {
            NSLog(@"Data has loaded successfully.");
        }

        [self performSelectorOnMainThread:@selector(processData:) withObject:data waitUntilDone:YES];
    });
}
- (void)cancel{
    //TODO KILL THE SERVICE (GRACEFULLY!!!!!) -- ALLOW VC'S TO CANCEL THE SERVICE & PREVENT SEGFAULTS

}

- (id)initWithDelegate:(id<WebServiceDelegate>)aDelegate
{
    self = [super init];
    if (self) {
        [self setDelegate:aDelegate];
    }
    return self;
}

- (void)processData:(NSData *)data{

    //parse out the json data
    NSError* error;
    if(data == nil){
        error = [NSError errorWithDomain:@"NO_DOMAIN" code:001 userInfo:nil];
        [self notifyDelegateOfError:error];
        return;
    }
    //EITHER NSDictionary = json or NSMutableArray = json
    NSDictionary* json = [NSJSONSerialization JSONObjectWithData:data
                                                    options:kNilOptions
                                                      error:&error];
    //NSArray *dataArray = [[json objectForKey:@"data"] objectForKey:@"current_condition"];
    //... more parsing done here.

    //NO ERRORS ALL DONE!
    [self notifyDelegateOfCompletion];

}

- (void)notifyDelegateOfError:(NSError *)error{
    [delegate webService:self didFailWithError: error];
}

- (void)notifyDelegateOfCompletion
{   
    if ([delegate respondsToSelector:@selector(webServiceDidComplete:)]) {
        [delegate webServiceDidComplete:self];
    }
} 
```

# twitter-bootstrap - 删除“导航标签”圆角（引导程序）

> ID：14145669
> 
> 赞同：10
> 
> 时间：2013-01-03T19:21:22.647
> 
> 标签：twitter-bootstrap

不知道如何在 Bootstrap 中删除选项卡 (class="nab-tabs") 上的圆角。

示例：http: [//i.imgur.com/ho7rX.png](http://i.imgur.com/ho7rX.png)

请帮忙

谢谢

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-04T14:28:29.573

将此行添加到 CSS

```
.nav-tabs > li > a {
-webkit-border-radius: 0;
-moz-border-radius: 0;
border-radius: 0;
} 
```

或者在你的情况下：

```
.nab-tabs > li > a {
-webkit-border-radius: 0;
-moz-border-radius: 0;
border-radius: 0;
} 
```

**编辑：21-03-2018**

在 BS4.0 中还有另一种方法添加***rounded-0***官方[引导覆盖](https://getbootstrap.com/docs/4.0/utilities/borders/#border-radius)，[这是工作示例](https://codepen.io/igcorreia/pen/pLPbmE)：

```
<div class="container">
  <div class="row">
    <div class="col-8 ml-auto mr-auto my-5 ">
      <ul class="nav nav-tabs ">
        <li class="nav-item ">
          <a class="nav-link active rounded-0" href="#">Active</a>
        </li>
        <li class="nav-item">
          <a class="nav-link rounded-0" href="#">Link</a>
        </li>
        <li class="nav-item">
          <a class="nav-link rounded-0" href="#">Link</a>
        </li>
        <li class="nav-item">
          <a class="nav-link rounded-0 disabled" href="#">Disabled</a>
        </li>
      </ul>
    </div>
  </div>
</div> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-05-09T01:42:50.700

对于 Bootstrap 4，您可以使用`.nav-tabs-nostyle`. 例如：

```
<nav class="navbar navbar-fixed-top navbar-light bg-faded">
  <div class="nav navbar-nav nav-tabs-nostyle">
    <a href="#one" class="nav-item nav-link" data-toggle="tab">One</a>
    <a href="#two" class="nav-item nav-link" data-toggle="tab">Two</a>
    <a href="#three" class="nav-item nav-link" data-toggle="tab">Three</a>
  </div>
</nav> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-03T19:28:36.543

通过 CSS 文件查找任何 .nav-tabs 条目并查找：

```
-webkit-border-radius
 -moz-border-radius
      border-radius 
```

将它们全部设置为 0。

编辑：

您还可以替换为主题版本，例如“flat”、“metro”风格的版本：

[http://bootswatch.com/cosmo/#buttons](http://bootswatch.com/cosmo/#buttons)

# android - ListView Android上奇怪的背景颜色

> ID：14145675
> 
> 赞同：2
> 
> 时间：2013-01-03T19:21:41.607
> 
> 标签：android, listview

目前我正在使用 ActionBarSherlock 和自定义 ListView 适配器，但我的 ListView 上有这个奇怪的情况。ListView 顶部有不同的颜色，Icon 背景应该是透明的，但它有背景颜色。请看图片，如果你不介意，请赐教。

![列表显示](../Images/08919e57708f38c42dc27f9d5bf9c648.png)

![另一个活动](../Images/076c0e4aa0c9783e57a7521899eebed0.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T05:13:23.240

这个问题是 ActionSherlockBar 主题自带的，准确的说是 Theme.Sherlock.Light.DarkActionBar。当我设置为 Theme.Sherlock.Light 时，不会出现此问题。我不知道为什么。

# jquery - jQPLOT - 内存泄漏

> ID：14145676
> 
> 赞同：3
> 
> 时间：2013-01-03T19:21:49.663
> 
> 标签：jquery, memory, memory-leaks, jqplot

我想建立一个交互式刷新的图表。我使用 jqPlot，但通过尝试调用 replot() 或重绘来更新图形会导致巨大的浏览器内存泄漏。你知道我该如何解决吗？

```
function crateChart() {
    var s1 = [['a',6], ['b',8], ['c',14], ['d',20]];
    var s2 = [['a', 8], ['b', 12], ['c', 6], ['d', 9]];

    this.plot = $.jqplot('chart', [s1, s2], {
        seriesDefaults: {
        renderer:$.jqplot.DonutRenderer,
        rendererOptions:{
            sliceMargin: 3,
            startAngle: -90,
            showDataLabels: true,
            dataLabels: 'value'
            }
        }
    });
}

function update () {
    ChartTester.plot.series[0].data = [
        ['a', Math.random() * 100],
        ['b', Math.random() * 100],
        ['c', Math.random() * 100],
        ['d', Math.random() * 100]
    ];

    ChartTester.plot.destroy();
    $('#chart *').unbind();
    $('#chart').empty();
    ChartTester.plot.redraw();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T20:00:16.857

我没有“即插即用”解决方案，但是 JQPlot 图表上动态数据更新的一个很好的例子可以激发你的灵感：http: [//jsfiddle.net/fracu/HrZcj/](http://jsfiddle.net/fracu/HrZcj/)

基本上，更新功能是这样的：

```
function updateSeries() {
    myData.splice(0, 1);
    x = (new Date()).getTime();
    y = Math.floor(Math.random() * 100);
    myData.push([x, y]);

    plot1.series[0].data = myData;
    plot1.resetAxesScale();
    plot1.axes.xaxis.numberTicks = 10;
    plot1.axes.y2axis.numberTicks = 15;
    plot1.replot();
} 
```

# django - 如何将 Django 应用程序内部的自定义包加载到 views.py 中？

> ID：14145677
> 
> 赞同：1
> 
> 时间：2013-01-03T19:21:57.720
> 
> 标签：django, model-view-controller, python-3.x, django-views, three-tier

我是 Django 新手，在使所有项目结构清晰有序等方面存在一些问题。在制作小项目时，Django 中的 MVC 东西很容易使用。但是，当我试图在views.py 和models.py 之间获得一个新层（应用程序逻辑，如三层架构）时，我遇到了问题。

我有以下结构：

*   我的网站/
    *   管理.py
    *   应用程序1/
        *   模型.py
        *   视图.py
        *   逻辑/
            *   __init__.py
            *   类1.py
            *   解析器.py
    *   ...

我想从and加载`views.py`东西。我该怎么做？`Class1.py``parser.py`

以下都不起作用：

`from app1.logic import *`

`from app1.logic.Class1 import Class1`

此外，如果有人可以列出一些非常庞大的 django 项目的示例，那将对我有所帮助。看起来很多类和 .py 文件应该在每个应用程序文件夹中，或者所有内容都在 models.py 中。两者看起来都有点杂乱无章，我相信有一种方法可以让它更清晰一些（比如在 Zend 或 Symfony 中）。

而且，我正在使用 Python3 和 Django 1.5b2。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T21:36:28.090

如果 Class1 或解析器从视图导入，那么您有一个循环依赖。您需要将任何共享代码移出到第三个文件中。

您可能会考虑是否需要`logic`. 在 Python 中，不需要在自己的文件中有一个类，所以也许你可以有一个`logic.py`而不是一个包含多个文件的逻辑目录。

# android - 版权问题：应用内热门网站的 Web 视图

> ID：14145678
> 
> 赞同：-6
> 
> 时间：2013-01-03T19:21:59.443
> 
> 标签：android

在应用程序中嵌入网站的移动版本会导致法律问题。人们对此有不同的看法，这似乎很普遍。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T19:30:04.037

我会寻求网站所有者的许可，无论法律是否要求我获得许可，这只是好庄园，免去法律上的麻烦。

# php - 使用 in_array 比较 MySQL 数据

> ID：14145679
> 
> 赞同：0
> 
> 时间：2013-01-03T19:22:08.760
> 
> 标签：php, mysql, arrays

我在 MySQL 中设置了一个包含两列的表：

*   ID（自动增量）
*   最近播放（VARCHAR，设置如“1 44”或“2 140”等）

我正在尝试将 mysql 数据放入一个数组并将其与 MySQL 外部定义的内容进行比较。但由于某种原因，它似乎不起作用。这是我的代码：

$whichPlaylist 是一个 1 个字符的 INT，而 $num 是一个 3 个字符的 INT。

```
//Note: These values are actually received through file_get_contents('textfile.txt');
$whichPlaylist = "1";
$num = "44";

//Combine playlist number and video number
$joint = $whichPlaylist. "" .$num;

//Insert joint var into Mysql database
mysql_query("INSERT INTO recentlyplayed (numplayed) VALUES('$joint') ");

$query = "SELECT * FROM recentlyplayed";
$result = mysql_query($query) or die ("no query");

while($row = mysql_fetch_array($result))
{

$stored[] = $row['1'];
}

if (in_array($joint, $stored['1'])){
$reroll = 1;
}

echo $reroll; 
```

即使 MySQL 表中有相同的 $joint 值，$reroll 也不会回显 1。这可能是因为插入 $joint 变量时有额外的间距吗？我实际上是从一个文本文件中获取 $whichPlaylist 和 $num ，该文本文件在数字后有一个新行。任何帮助表示赞赏。:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T19:27:48.777

在您的脚本中尝试此代码：

```
$stored = array();
while($row = mysql_fetch_array($result)) {
  $stored[] = $row[1];
}

if (in_array($joint, $stored)){
  $reroll = 1;
} 
```

数组是 $stored（不是 $stored['1']）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T19:27:01.223

在 if 语句之后移动 While End 大括号，看看它是否有效。

# vb.net - OOP - 内存使用和大型数学对象（类）

> ID：14145680
> 
> 赞同：2
> 
> 时间：2013-01-03T19:22:10.410
> 
> 标签：vb.net, visual-studio-2010, oop, class

我开始将许多涉及昂贵的迭代数学例程的大型非 OOP 子例程移到他们自己的类中。每当我想使用较大的子例程之一（现在是类）时，我将它们创建为一个对象，假设一旦不再使用该对象（因为退出调用代码），它们将从内存中删除。

我的问题是：如果使用按钮或触发子例程实例化一个对象并且该例程中的代码运行，那么一旦代码完成，该对象是否会通过垃圾收集从内存中被杀死？

另外，我不想多线程，因为用户一次不会运行多个类。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T19:24:41.543

> 一旦代码完成，该对象会通过垃圾收集从内存中被杀死吗？

不，不一定。

一旦该代码完成，将不再有对该对象的活动引用。这意味着它将有*资格*进行垃圾收集，但这不会立即发生。它将在该点之后的某个适当时间被收集。

# iphone - 在uiview上画直线

> ID：14145688
> 
> 赞同：0
> 
> 时间：2013-01-03T19:22:42.723
> 
> 标签：iphone, ios, objective-c, uiview, quartz-graphics

我正在为 iPad 编写一个小型单词搜索游戏。我有一个`UIViewController`，我将字母随机平铺在`UIView`( `lettersView`) 中。我将标签的标签设置在一个 10x10 大小的矩阵中，`UILabel`每个字母使用一个。

这是我的问题：我不知道如何绘制字母（`UILabel`s）。我已经研究过这个问题并且很困惑使用哪种方式（触摸，opengl，石英，hittest）。

*   我只想从第一个点到最后一个点画一条直线（向下触摸）。
*   当用户点击 时`lettersView`，我必须找到被点击的字母。如果我得到`UILabel`最先点击的那封信，我可以找到这封信。
*   当用户移动他们的手指时，它应该画线，但是当用户移动它时，它必须删除旧的。
*   当用户触摸时，我怎样才能得到最后一个`UILabel`？如果我得到第一个和最后一个 uilabel，我可以检查它是否可绘制。

（我发现了一个以 ARC 模式编写的小型绘图示例。但我无法将其转换为非 ARC。）

* * *

你说的我都做了。但我有一些问题。它在 drawRect 方法上画线。当我画第二行时，它会删除旧的。这是代码：

```
-(void) touchesBegan:(NSSet *)touches withEvent:(UIEvent *)event
{
    touchStart = [[touches anyObject] locationInView:self];
    float xPos=touchStart.x;
    float yPos=touchStart.y;

    startIndexCol = floor(xPos / letterWidth);
    startIndexRow = floor(yPos / letterHeight);

    xPos = (startIndexCol * letterWidth) + letterWidth/2;
    yPos = (startIndexRow * letterHeight) + letterHeight/2;
    touchStart = CGPointMake(xPos, yPos);
    touchCurrent = touchStart;
    [self setNeedsDisplay];
}

-(void) touchesMoved:(NSSet *)touches withEvent:(UIEvent *)event
{
    touchCurrent = [[touches anyObject] locationInView:self];
    //CGRect frame = CGRectMake(touchStart.x, touchStart.y, touchCurrent.x, touchCurrent.y);
    //[self setNeedsDisplayInRect:frame];
    [self setNeedsDisplay];
}

-(void) touchesEnded:(NSSet *)touches withEvent:(UIEvent *)event
{
    touchCurrent = [[touches anyObject] locationInView:self];
    //[self hitTest:touchCurrent withEvent:event];
    float xPos=touchCurrent.x;
    float yPos=touchCurrent.y;

    endIndexCol = floor(xPos / letterWidth);
    endIndexRow = floor(yPos / letterHeight);

    xPos = (endIndexCol * letterWidth) + letterWidth/2;
    yPos = (endIndexRow * letterHeight) + letterHeight/2;
    touchCurrent = CGPointMake(xPos, yPos);
    //CGRect frame = CGRectMake(touchStart.x, touchStart.y, touchCurrent.x, touchCurrent.y);
    //[self setNeedsDisplayInRect:frame];

    //check if it can be drawn
    if ((startIndexCol == endIndexCol) && (startIndexRow == endIndexRow)) {
        //clear, do nothing
        touchStart = touchCurrent = (CGPoint) { -1, -1 };
        startIndexCol = startIndexRow = endIndexCol = endIndexRow = -1;
    }
    else{
        if (startIndexRow == endIndexRow) {//horizontal
            if (endIndexCol > startIndexCol) {
                [delegate checkWordInHorizontal:startIndexRow start:startIndexCol end:endIndexCol];
            }
            else{
                [delegate checkWordInHorizontalBack:startIndexRow start:startIndexCol end:endIndexCol];
            }
        }
        else if (startIndexCol == endIndexCol){ //vertical
            if (endIndexRow > startIndexRow) {
                [delegate checkWordInVertical:startIndexCol start:startIndexRow end:endIndexRow];
            }
            else{
                [delegate checkWordInVerticalBack:startIndexCol start:startIndexRow end:endIndexRow];
            }
        }
    }

    [self setNeedsDisplay];
}

-(UIView *)hitTest:(CGPoint)point withEvent:(UIEvent *)event{
    UIView *subview = [super hitTest:point withEvent:event];
    if ([subview isEqual:self]) {
        NSLog(@"point:%f - %f", point.x, point.y);
        return self;
    }
    return nil;

}

-(void)drawLine{
    NSLog(@"draw it");
    drawIt=YES;
    [self setNeedsDisplay];
}

- (void)drawRect:(CGRect)rect
{
    [super drawRect:rect];
    if (drawIt) {
        NSLog(@"drawit");
        CGContextRef ctx = UIGraphicsGetCurrentContext();
        CGContextSetLineWidth(ctx, 20.0);
        CGContextSetRGBStrokeColor(ctx, 1.0, 2.0, 0, 0.5);
        CGContextMoveToPoint(ctx, touchStart.x, touchStart.y);
        CGContextAddLineToPoint(ctx, touchCurrent.x, touchCurrent.y);

        CGContextStrokePath(ctx);
        drawIt=NO;
        touchStart = touchCurrent = (CGPoint) { -1, -1 };
        startIndexCol = startIndexRow = endIndexCol = endIndexRow = -1;
    }

        [[UIColor redColor] setStroke];
        UIBezierPath *path = [UIBezierPath bezierPath];
        [path moveToPoint:touchStart];
        [path addLineToPoint:touchCurrent];
        [path setLineWidth:20.0];
        [path strokeWithBlendMode:kCGBlendModeNormal alpha:0.5];
//        [path stroke];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T22:56:08.907

首先，UILabels 可能给您带来的麻烦多于好处。对于简单的网格，用手画字母`drawRect:`和连接线可能更容易。整体结构如下所示：

*   在`touchesBegan:withEvent:`中，您将记下 ivar 中的起点。
*   在`touchesMoved:withEvent:`中，您将更新 ivar 中的端点并调用`[self setNeedsDisplayInRect:]`. 通过你的两点定义的矩形。
*   在`touchesEnded:withEvent:`中，您将进行命中测试，执行所需的任何处理，然后清除起点和终点并调用`[self setNeedsDisplayInRect:]`.
    *   通过“进行命中测试”，我的意思是计算触摸下哪个字母。由于您将它们布置在网格中，因此这应该是非常简单的数学运算。
*   在`drawRect:`中，您将使用`[NSString drawAtPoint:withFont:]`绘制每个字母。然后你会使用`UIBezierPath`来画线（你也可以使用`CGPathRef`，但我个人会使用 UIKit 对象）。

# python - 如何使用 request.post 和模型实例初始化 FormModel。

> ID：14145692
> 
> 赞同：0
> 
> 时间：2013-01-03T19:22:52.767
> 
> 标签：python, django

所以我基本上有这个代码：

```
@render_to('hello/home.html')
def home(request):
    info = Info.objects.get(pk=1)
    if request.method == "POST":
        form = InfoForm(request.POST, instance=info)
    else:
         form = InfoForm(instance=info)
   return {"info": info, "form": form} 
```

aaand 它不像我想象的那样工作。如果我只使用模型实例或 POST 初始化表单，它会起作用，但两者都不起作用。有没有一种（不错的？）方法可以使用从模型实例填充的数据创建表单，并使用 request.POST 中的数据对其进行更新？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T20:06:55.173

您正在编写的代码已经在框架中。

## 网址.py

```
from django.views.generic import UpdateView
from myapp.forms import InfoForm
urlpatterns = patterns('',
    url(r'^info/(?P<pk>[-_\w]+)/update/$', UpdateView.as_view(model= Info,template_name="hello/home.html",form_class=InfoForm), name='info_update'), 
)
# you might need to include a success url in the **kwargs i.e. success_url="/thankyou/" 
```

# windows-services - 在 Windows 服务中使用 PsExec 退出代码 6

> ID：14145693
> 
> 赞同：6
> 
> 时间：2013-01-03T19:22:56.817
> 
> 标签：windows-services, psexec

我正在使用 PsExec 对网络上的计算机进行远程碎片整理。这在我的 c# 代码中运行良好，但因为它还执行许多其他任务并且我希望它连续运行，所以我已将其转换为 Windows 服务。

当代码到达 PsExec 部分时，它以代码 6 退出，这似乎意味着“句柄无效”我尝试输入具有足够权限的用户名和密码但没有成功，我还尝试添加 -s 以使用系统帐户这也没有帮助。

这是我设置 PsExec 争论的那一行...

```
psexec.StartInfo.Arguments = @" \\" + machine + "/accepteula -s defrag.exe " + volume + " -f"; 
```

我也试过...

```
psexec.StartInfo.Arguments = @" \\" + machine + "/accepteula defrag.exe " + volume + " -f";
psexec.StartInfo.Arguments = @" \\" + machine + "/accepteula defrag.exe " + volume + "-u myuser -p mypass -f"; 
```

任何帮助将不胜感激！！但似乎没有什么能解决我的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2019-10-11T18:27:58.257

我知道这已经打开了很长时间，但是您是否发现远程机器上的 psexec 服务卡住了？

我们发现 PsExec 服务条目仍在 Services 中，而 PsExeSvc 仍在 C:\WINDOWS 文件夹中。

我们从 C:\WINDOWS 中删除了 exe，并在提升的命令提示符下运行“sc delete PsExec”以摆脱服务。

# apache - Apache RewriteRule 替换 url

> ID：14145694
> 
> 赞同：0
> 
> 时间：2013-01-03T19:23:01.643
> 
> 标签：apache, .htaccess, mod-rewrite

我正在尝试修改 .htaccess 文件以获取 URL 翻译，如下所示：

www.example.com/site/blahblahblah/files/a.jpg -> www.example.com/site/files/a.jpg

就像是：

```
RewriteBase /site/
RewriteRule ^(.*)/files/(.*)$ files/$1 [L] 
```

但它不工作。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T19:49:13.877

你可以试试这个：

```
RewriteEngine On
RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI}  !site/files/?.*
RewriteCond %{REQUEST_URI}  (files)/?(.*)
RewriteRule .* http://www.example.com/site/%1/%2 [L,R=301,QSA] 
```

将重写这个：

`http://www.example.com/site/blahblahblah/files/a.jpg`

对此：

`http://www.example.com/site/files/a.jpg`

# ruby-on-rails - delay_job_config.rb 未定义的方法与日志配给 rails 3.2.8

> ID：14145702
> 
> 赞同：1
> 
> 时间：2013-01-03T19:23:19.887
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, logging, delayed-job

我使用 rails 3.2.8，我需要在开发和生产环境中进行日志轮换：

我已添加到`development.rb`production.rb 和下一个用于日志轮换：

```
config.logger = Logger.new("#{Rails.root.to_s}/log/development.log", 2, 10.megabytes)
config.logger = Logger.new("#{Rails.root.to_s}/log/production.log", 2, 10.megabytes) 
```

我需要使用delayed_job gem，我知道这是我的`delayed_job_config.rb:`

```
Delayed::Worker.max_attempts = 2
Delayed::Worker.delay_jobs = !Rails.env.test?
Delayed::Worker.logger = Rails.logger
Delayed::Worker.logger.auto_flushing = true 
```

我得到下一个错误：

```
...config/initializers/delayed_job_config.rb:4:in `<top (required)>': undefined method `auto_flushing=' for #<Logger:0xbe59ba0> (NoMethodError) 
```

我需要使用日志轮换，因为这些文件增长得非常快，我必须手动删除。

**我该如何解决这个错误？并将日志轮换添加到两个环境？**

谢谢

# winforms - EF 5.0 WinForms 在绑定的 DataGridView 中添加新行

> ID：14145708
> 
> 赞同：1
> 
> 时间：2013-01-03T19:23:35.753
> 
> 标签：winforms, entity-framework, data-binding

我已经使用 dbcontext 为实体设置了绑定 dgv。工作正常。这些行显示在 dgv 中，我可以使用 SaveChanges 修改单元格和更新。但是，如果我尝试在 dgv 中添加新行，它不会被保存。如果 dgv 绑定到实体不应该自动添加新行还是我必须做一些事情来添加它？什么？请提供示例代码。接下来我将尝试从 dgv 中删除。我会有类似的问题吗？我怎样才能让它发挥作用？我在互联网上搜索了示例，但它们只限于绑定实体并且不包括添加或删除。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T00:17:54.040

我发现了几个具有类似问题的链接，其中一个是：

[DataGridView AllowUserToAddRow 属性不起作用](https://stackoverflow.com/questions/11799661/datagridview-allowusertoaddrow-property-doesnt-work)

似乎使用 .ToList 搞乱了绑定。就我而言，我使用 MyContext.MyTable.Local.ToList 作为源。当我删除 .ToList 时，一切正常。也许有人可以更详细地告诉我们为什么这样有效？？？

感谢你们中最先发现这一点的人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-10T22:56:42.927

.NET Framework 4 的解决方案

我试过删除 .ToList() 但我根本没有得到任何结果。

所以我的解决方法是：

对于删除：
在 datagridview UserDeletingRow 事件上

```
// Get deleted entity:
myEntityType currentEntity = (myEntityType)BindingSource[e.Row.Index];

// Delete directly from context
context.myEntityType.Remove(currentEntity); 
```

对于插入：
在保存按钮上，我遍历 BindingSource 并检查是否有任何实体具有 ID == 0，然后使用 context.MyEntityType.Add(currentEntity); 添加每个实体。

# php - CodeIgniter 发布数据时报错 500

> ID：14145720
> 
> 赞同：1
> 
> 时间：2013-01-03T19:24:37.510
> 
> 标签：php, codeigniter, codeigniter-form-helper

我有以下名为 admin 的控制器

```
class Admin extends CI_Controller {

    public function __construct() {
        parent::__construct();
        $this->load->model('admin_model');
    }

    public function index()
    {
        $this->load->library('session');
        $this->load->database();
        if (!$this->session->userdata('user_id') || !$this->session->userdata('user_name'))
        {
            header("Location: /admin/login");
        }
        else
        {
            $user_id = $this->session->userdata('user_id');
            $user_name = $this->session->userdata('user_name');
            if (!$this->admin_model->verify($user_id, $user_name))
                header("Location: /admin/login");
        }
        $this->load->view('templates/header');
        $this->load->view('admin/index');
        $this->load->view('templates/footer');
    }
    public function login()
    {
        $this->load->view('templates/header');
        $this->load->helper('form');
        $this->load->library('form_validation');
        $this->form_validation->set_rules('username', 'Username', 'required');
        $this->form_validation->set_rules('password', 'Password', 'required');
        if ($this->form_validation->run() == FALSE)
        {
            $data['run'] = false;
        }
        else if (!$this->admin_model->loginverify($this->input->post('username'), 
                 $this->input->post('password')))
        {
            $data['run'] = false;
        }
        else
        {
            $data['run'] = true;
        }
        $this->load->view('admin/login', $data);
        $this->load->view('templates/footer');
    }
} 
```

我有以下模型，称为 Admin_model

```
class Admin_model extends CI_Model
{
    public function __construct() {
        parent::__construct();
        $this->load->database();
    }
    public function verify($id, $name)
    {
        if (!is_numeric($id))
            return false;
        else
        {
            $query = $this->db->get_where('users', array('id'=>$id, 'username'=>$name), 1);
            if ($query->result()->num_rows() === 0)
                return false;
            else
                return true;
        }
    }
    public function loginverify($name, $pass)
    {
        $pass = md5($pass);
        //$query = $this->db->get_where('users', array('username'=>$name, 'passwd'=>$pass), 1);
        $query = $this->db->query("SELECT * FROM users WHERE username='$name' AND passwd='$pass' LIMIT 1");
        if ($query->result()->num_rows() === 0)
            return false;
        else
            return true;
    }
} 
```

我的表格如下：

```
<?php  if (!$run) 
{
?>
<form method="post" action="/admin/login">

<h5>Username</h5>
<input type="text" id="username" name="username" value="" size="50" />

<h5>Password</h5>
<input type="password" id="password" name="password" value="" size="50" />

<div><input type="submit" id="submit" name ="submit" value="Login" /></div>

</form>
<?php

}else{
    echo "successfully login";
}
?> 
```

提交时我得到一个空白页，当我在 Chrome 中检查网络时，我看到该帖子导致了 500 内部服务器错误。

当我在上面注释的行中将直接查询更改为 get_where 时，我得到一个严重性 8192 和错误消息`mysql_escape_string(): This function is deprecated; use mysql_real_escape_string() instead.`

我在这里使用手动表单，但我的 CSRF 设置为 false。我试过使用`form_open('admin/login')`，但可笑的是，它被`localhost/?admin/login`一个额外的`?`.

我在这里遇到了所有这些问题，我只是不知道该怎么办。我感谢提供的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T20:53:39.730

您的表单可能没有指向正确的网址，所以我建议您更改此设置：

```
<form action="/admin/login"> 
```

到

```
<form action="<?php echo site_url('admin/login'); ?>"> 
```

然后尝试替换所有`headers() methods`：

```
header("Location: /admin/login"); 
```

和

```
redirect(site_url('admin/login'),'',302); 
```

真诚地，从未`header();`与Codeigniter 一起使用

# android - 异步任务内存清理

> ID：14145726
> 
> 赞同：0
> 
> 时间：2013-01-03T19:25:01.463
> 
> 标签：android, android-asynctask, audiorecord

`AsyncTask`当用户强制应用程序退出或进入后台时，我在如何清理我使用的内存时遇到了一些麻烦。

具体来说，我有一个应用程序正在使用`AsyncTask`记录音频数据并实时绘制信号图。对于录制，我正在使用`AudioRecord`该类，这需要您开始录制，然后停止并释放录制对象。我的问题是我不知道如何停止和释放这个对象。

我考虑过并尝试过的选项：

1.  `onPause`在、`onStop`和方法中停止释放对象`onDestroy`，但这会导致异常。
2.  `onPostExecute`在 的方法中停止和释放对象`AsyncTask`。这个问题是我不确定当用户强制退出应用程序时是否调用过这个方法，因为这个`doInBackground`方法永远不会完成。我无法找到任何与此相关的文档。

我的`AsyncTask`样子如下：

```
 AsyncTask<Void, Void, Void> drawer = new AsyncTask<Void, Void, Void>() {
        @Override
        protected void onPreExecute() {
            super.onPreExecute();

            recorder.startRecording();
        }

        @Override
        protected Void doInBackground(Void... arg0) {
            while(true) {
                int nRead = 0;
                int offset = 0;

                while(nRead != readSize) {
                    nRead += recorder.read(buffer, offset + nRead, readSize - nRead);
                }

                for(int i = 0; i < readSize; i++) {
                    data[i] = buffer[i];    
                }

                publishProgress();
            }               
        }

        @Override
        protected void onProgressUpdate(Void... arg0) {
            view.setData(data);
            view.invalidate();
        }
    }; 
```

该代码效果很好，我只是不确定确保我正确清理记录对象并且根本不泄漏的最佳方法。我的困惑是`AsyncTask`当 UI 线程暂停或停止时会发生什么，此外，如果您能够停止`AudioRecord`来自不同线程的对象，您就盯着它看。

任何帮助将不胜感激。
谢谢，

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T19:53:31.800

`OnPostExecute`不会被调用，因为你永远不会完成你的后台循环。您需要有一个退出循环的条件。您可以在 UI 中设置一个变量，然后签入后台任务，或者使用取消功能`AsyncTask`。

例如，在您的`onPause()`方法中，您可以取消任务`drawer.cancel(true);`

然后，在您的`doInBackground`循环中，检查任务是否已被取消。

```
if (isCancelled()) {
   // clean up here
   break;
} else {
  publishProgress();
} 
```

只要您不需要触摸 UI 进行清理，它就可以工作。如果您需要进行 UI 清理，那么您可以覆盖该`onCancelled`方法。

请注意，对于长时间运行的任务，建议您不要使用`AsyncTask`. 所以你可能想研究使用线程。从`AsyncTask` [文档](http://developer.android.com/reference/android/os/AsyncTask.html)中，

> AsyncTasks 最好用于短时间的操作（最多几秒钟）。如果您需要保持线程长时间运行，强烈建议您使用 java.util.concurrent 包提供的各种 API，例如Executor、ThreadPoolExecutor 和 FutureTask。

# php - 此代码中的变量可见性错误是什么？

> ID：14145730
> 
> 赞同：5
> 
> 时间：2013-01-03T19:25:34.333
> 
> 标签：php, inheritance

我是 PHP 中 OOP 的新手，我正在尝试为我的网站创建一个小型 MVC 结构，但我遇到了一个我无法弄清楚的错误。我的代码类似于下面给出的代码：

```
class a
{
    protected $b = "b";

    protected function c()
    {
        return $this->b;
    }
}

class d extends a
{
    public function e()
    {
        parent::c();
    }
}

$f = new d();
var_dump($f->e()); 
```

* * *

此代码的输出为空，我无法弄清楚！

在我的原始代码中，我将我的用户名和密码存储在类“a”中，并在函数“c”中返回一个 PDO 对象。

这里有什么错误？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-03T19:27:00.710

你得到了 的值`parent::c()`，但你没有用它做任何事情。使用返回语句。

# java - 如何在 Java 中逐位读取整数？

> ID：14145733
> 
> 赞同：45
> 
> 时间：2013-01-03T19:25:36.797
> 
> 标签：java

我想将一个 int 作为输入，并返回第 k 位。

```
int getBit(int n, int k){
    return kth bit in n;
} 
```

我该怎么做？

* * *

## 回答 #1

> 赞同：104
> 
> 时间：2013-01-03T19:27:35.107

使用位运算符：

```
int getBit(int n, int k) {
    return (n >> k) & 1;
} 
```

说明（位）：

```
n
100010101011101010 (example)
n >> 5
000001000101010111 (all bits are moved over 5 spots, therefore
&                   the bit you want is at the end)
000000000000000001 (0 means it will always be 0,
=                   1 means that it will keep the old value)
1 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-01-03T19:27:26.357

```
return (n >> k) & 1; 
```

在这里，`n >> k`将`k`第 - 位移动到最低有效位置，并`& 1`屏蔽其他所有内容。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-01-03T19:27:52.300

如果最低有效位是位数`0`：

```
return (n>>k)&1; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-08-18T18:12:09.037

或使用：

```
boolean getBit(int n, int k) {
    return ((n >> k) & 1) == 1;
} 
```

如果你想要一个布尔值

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-07-05T22:03:12.837

您也可以为此使用模块属性。如果您的数字是偶数，最低有效位为零，否则（奇数）为一。

```
return (n>>k)%2; 
```

# r - Sweave/knitr 实现中均值和 sem 的函数

> ID：14145738
> 
> 赞同：3
> 
> 时间：2013-01-03T19:25:43.287
> 
> 标签：r, function, latex, sweave, knitr

我正在集思广益，为 Sweave/knitr 编写一个均值和 sem 函数。就我有限的知识而言，它看起来像这样

```
m.se <- function (x, na.rm = TRUE) {
    if (na.rm) 
        x <- x[!is.na(x)]
    n <- length(x)
    if (n == 0) 
        return(c(mean = NA, sem = NA))
     xbar <- sum(x)/n
     se <- sqrt(sum((x - xbar)^2)/(n - 1))/sqrt(n)
     c(mean = xbar, sem = se)
     return(paste(xbar,"\\pm",se))
} 
```

它确实做了一些工作，它给出的输出如下：

```
43.9303846153846 \pm 3.34823050767781 
```

问题是它不尊重`option()`我在主环境中定义的（在knitr中设置块）。我怎么解决这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T19:21:03.583

您的均值和标准差代码不是最优的。正如 Dieter Menne 提到的，您可以简单地使用内置的`mean()`，`sd()`如果您不是出于锻炼目的而这样做。

该`knitr`软件包为更好地打印数字做了很多努力，我建议您使用这些工具而不是发明自己的格式规则。请参阅下面的解决方案（`\Sexpr{}`将尊重`options('digits')`）：

```
\documentclass{article}
\begin{document}

<<mean-sem>>=
options(digits = 3)
m.se <- function (x, ...) {
  n <- length(x)
  if (n == 0) return(c(mean = NA, sem = NA))
  se <- sd(x, ...)/sqrt(n)
  c(mean = mean(x, ...), sem = se)
}
res <- m.se(rnorm(100))
@

What you want is $\Sexpr{res['mean']} \pm \Sexpr{res['sem']}$.

\end{document} 
```

更重要的是，这是一个可移植的解决方案——如果您想要一个 HTML 版本，您只需编写`<!--rinline res['mean']--> ± <!--rinline res['sem']-->`，而不必重新定义您的 R 函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T19:51:11.270

我认为该`format`功能可以解决问题：

```
R> 1.1111111
[1] 1.111
R> paste(1.1111111)
[1] "1.1111111"
R> paste(format(1.1111111))
[1] "1.111" 
```

所以在你的情况下，

```
paste(format(xbar), "\\pm", format(se)) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-03T20:21:47.450

正如@csgilliespie 所指出的，格式语句将完成这项工作，但这还不能解决您可能希望格式化服务的问题`option(digit=3)`。最好分两步执行此操作，将数字与视图分开。参见示例`print.lm`（不带 ()）。

```
m.se <- function (x, na.rm = TRUE) {
  if (na.rm) 
    x <- x[!is.na(x)]
  n <- length(x)
  if (n == 0) 
    return(c(mean = NA, sem = NA))
  xbar <- sum(x)/n
  se <- sqrt(sum((x - xbar)^2)/(n - 1))/sqrt(n)
  ret = c(mean = xbar, sem = se)
  class(ret) ="m.se"
  ret
}

print.m.se = function(x, digits = max(3, getOption("digits") - 3),...){
  print(paste(format(x["mean"],digits=digits), "//pm",format(x["sem"],digits=digits)))
  invisible(x)
}

m.se(rnorm(10)) 
```

# java - 有什么方法可以使用 Graphics 类绘制可变矩形

> ID：14145743
> 
> 赞同：0
> 
> 时间：2013-01-03T19:26:13.377
> 
> 标签：java, awt, rectangles

我编写了一个简单的 Java 游戏，其中屏幕上有两个矩形，一个矩形移动，另一个保持不动，移动的矩形随着键盘箭头输入移动，可以向上、向下、向左或向右移动。我遇到的问题是在屏幕上绘制我的矩形，我的意思是我用我的变量设置了 2 个矩形，如图所示：

```
Rectangle rectOne = new Rectangle(shiftX, shiftY,90,90);
Rectangle rectTwo = new Rectangle(500 + buckyPositionX, 330 + buckyPositionY, 210, 150); 
```

我已经制作了一个渲染方法来在屏幕上绘制我想要显示的东西：

```
 public void render(GameContainer gc, StateBasedGame sbg, Graphics g) throws SlickException{
} 
```

我遇到的问题是通过在渲染方法中编写代码在屏幕上显示我的矩形，我可以执行以下操作：

```
g.fillRect(x, y,90,90);
g.fillRect(500 + buckyPositionX, 330 + buckyPositionY, 210, 150); 
```

这会在屏幕上生成 2 个矩形，但我需要使用用变量编写的 Rectangle 代码来绘制矩形，有人告诉我这可以使用 Graphics2D 来完成，但我想知道是否有更简单的方法来使用图形函数，如果不能，你能帮我设置一下吗？

先感谢您。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T19:30:15.380

`Rectangle`您可以轻松访问实例的属性：

```
g.fillRect(rectOne.getX(), rectOne.getY(), rectOne.getWidth(), rectOne.getHeight()); 
```

在任何情况下，通常该`Graphics`对象是`Graphics2D`运行时的一个实例，所以这也可以很容易地工作：

```
Graphics2D g2d = (Graphics2D)g;
g2d.fill(rectOne); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T19:31:15.533

只需使用：

```
g.fillRect(myRect.getX(), myRect.getY(), myRect.getWidth(), myRect.getHeight()); 
```

`myRect`您要绘制的矩形在哪里。`drawRect(Graphics g, Rectangle myRect);`如果您有很多要绘制的矩形，您甚至可以制作自定义方法。

使用[Graphics2D](http://docs.oracle.com/javase/6/docs/api/java/awt/Graphics2D.html)也不是那么困难，因为提供`Graphics`对象通常是一个`Graphics2D`对象：

```
Graphics2D g2d = (Graphics2D) g;
g2d.fill(myRect); 
```

# c# - 如何知道 word 文档中特定文本的字体大小（例如）？

> ID：14145744
> 
> 赞同：6
> 
> 时间：2013-01-03T19:26:15.400
> 
> 标签：c#, ms-word, openxml, openxml-sdk

这个想法很简单，但答案可能会变得复杂：

事实上，我可以检查字体大小的运行属性。

如果不存在，我需要检查应用于段落的样式以查找为字体大小定义的运行属性，然后是该样式的段落运行属性。

如果没有找到，我需要再次检查有关此样式所基于的样式的所有内容。

如果没有找到，我应该检查样式层次结构中的以下样式，然后继续直到达到默认样式。

我还需要检查上一段是否应用了样式。在这种情况下，应用的样式可能会定义影响我正在使用的文本的下一段的样式。

如果没有影响我的段落的样式，那么我需要从样式部分查看默认运行属性。之后，我应该查看同一部分中的默认段落属性。

如果不适用，则大小定义的责任将由处理文档的应用程序负责。

我对吗？

我没有来自 OPenXML SDK 和/或 OpenXmlPowerTools 的任何帮助吗？

一个重要的方面是，这个问题几乎扩展到除文本字体大小之外的任何段落或运行属性。

我的最终目标是根据格式确定一段文本是否是节标题（如标题1、标题2等），但看起来很难得到像“一段文本的当前格式”这样简单的东西。为了让事情变得更难，我还需要处理很多次没有应用于段落的编号格式的（部分）编号。

谢谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-06T18:28:56.023

所以，我按照承诺回答我自己的问题。

我开发了一种方法，可以从 word 文档段落中返回特定运行的“有效”运行属性。它根据标准 - ISO/IEC29500-1 考虑了默认文档属性、应用样式（包括相关样式层次结构和直接运行属性）。

有趣的是，Word 在这两个方面似乎并没有完全遵循标准： 1 - 如果一个段落没有应用任何样式，则 word 应用默认的段落样式。据我所知，我认为不应该应用任何样式。运行不会发生这种情况：当运行没有运行样式时，不会应用默认运行样式。2 - 为了获得有效的运行属性，有必要“汇总样式”。段落样式和运行样式遵循样式层次结构。为了获得特定的属性值，有必要在应用的样式中查找它，如果不存在则在父样式中查找它等等。如果属性具有相同的值，则不应将具有特定样式的特定值定义的属性添加到子样式中。Word 不遵循此规则的字符样式。事实上，从运行样式应用的所有运行属性都可以直接针对该运行样式获得，而无需遵循样式层次结构。这不符合标准。

现在，让我详细介绍一下我的解决方案：

首先，我的代码使用了 openxml 电动工具： [http ://powertools.codeplex.com/](http://powertools.codeplex.com/)

接下来，为了汇总有关样式继承的样式，我改编并实现了 Eric White 在以下位置提供的解决方案：http: [//blogs.msdn.com/b/ericwhite/archive/2009/12/13/implementing-inheritance-in- xml.aspx](http://blogs.msdn.com/b/ericwhite/archive/2009/12/13/implementing-inheritance-in-xml.aspx) 和 [http://blogs.msdn.com/b/ericwhite/archive/2009/10/29/open-xml-wordprocessingml-style-inheritance.aspx](http://blogs.msdn.com/b/ericwhite/archive/2009/10/29/open-xml-wordprocessingml-style-inheritance.aspx)

获取运行属性的完整算法可以在标准中找到，它也由 Eric White 提供，网址为：http: [//blogs.msdn.com/b/ericwhite/archive/2009/11/12/assemble-paragraph- and-run-properties-for-cells-in-a-table.aspx](http://blogs.msdn.com/b/ericwhite/archive/2009/11/12/assembling-paragraph-and-run-properties-for-cells-in-a-table.aspx) 在这种情况下，它涉及从表格内的单元格中提取属性。我的方法不适用于表格内的段落（我只是不需要它:-)）但它可以扩展到处理这些情况（所有信息都在 Eric 的文章中）

请注意，我正确处理了切换属性和 word 的实际工作方式（我为与标准相关的差异所做的点。

最后，代码：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Xml.Linq;
using DocumentFormat.OpenXml.Packaging;
using DocumentFormat.OpenXml;
using DocumentFormat.OpenXml.Wordprocessing;
using OpenXmlPowerTools;

namespace MyNameSpace
{
    class OpenXmlPowerToolsUtilities
    {
        public static XElement GetEffectiveRunProperties(WordprocessingDocument wordDoc, XElement run)
        {
            XElement runProperties = null;
            List<XElement> runPropertiesList = new List<XElement>();

            XElement paragraph = run.Parent;
            if (paragraph.Name != W.p)
                return null;

            StyleDefinitionsPart styleDefinitionsPart = wordDoc.MainDocumentPart
                .StyleDefinitionsPart;
            if (styleDefinitionsPart == null)
                return null;
            XElement styles = styleDefinitionsPart.GetXDocument().Root;           

            // 1 - Get run default
            XElement runDefault = styles.Elements(W.docDefaults)
                .Elements(W.rPrDefault)
                .Elements(W.rPr)
                .FirstOrDefault();
            if (runDefault != null)
                runPropertiesList.Add(runDefault);

            // 2 - get paragraph style run properties
            XElement pStyleRunProperties = null;
            string pStyle = (string)paragraph.Elements(W.pPr)
                .Elements(W.pStyle)
                .Attributes(W.val)
                .FirstOrDefault();
            if (pStyle != null)
            {
                pStyleRunProperties = AssembleStyleInformation(styles, pStyle)
                                                       .Elements(W.rPr)
                                                       .FirstOrDefault();
            }
            else
            {
                XElement defaultParagraphStyle = styles
                                        .Elements(W.style)
                                        .Where(e =>
                                            (string)e.Attribute(W.type) == "paragraph" &&
                                               (string)e.Attribute(W._default) == "1")
                                        .Select(s => s)
                                        .FirstOrDefault();
                pStyleRunProperties = defaultParagraphStyle.Elements(W.rPr).FirstOrDefault();
            }
            if (pStyleRunProperties != null)
                runPropertiesList.Add(pStyleRunProperties);

            // 3 - get run style run properties
            string rStyle = (string)run.Elements(W.rPr).Elements(W.rStyle).Attributes(W.val).FirstOrDefault();
            XElement rStyleRunProperties = null;
            if (rStyle != null)
            {
                rStyleRunProperties = AssembleStyleInformation(styles, rStyle)
                                                       .Elements(W.rPr)
                                                       .FirstOrDefault();
            }
            if (rStyleRunProperties != null)
                runPropertiesList.Add(rStyleRunProperties);

            XElement toggleProperties = AssembleToggleProperties(runDefault, pStyleRunProperties, rStyleRunProperties);
            if (toggleProperties != null)
                runPropertiesList.Add(toggleProperties);

            // 4 - direct run properties
            XElement directRunProperties = run.Elements(W.rPr).FirstOrDefault();
            if (directRunProperties != null)
                runPropertiesList.Add(directRunProperties);

            runProperties = AssembleRunProperties(runPropertiesList);

            return runProperties;
        }

        private static XElement AssembleRunProperties(List<XElement> runPropertiesList)
        {
            return runPropertiesList
                .Aggregate(
                    new XElement(W.rPr,
                    new XAttribute(XNamespace.Xmlns + "w", W.w)),
                    (mergedRun, run) =>
                        MergeChildElements(mergedRun, run));
        }

        static XElement AssembleToggleProperties(XElement runDefault, XElement pStyleRunProperties, XElement rStyleRunProperties)
        {
            XElement runToggleProperties;

            runToggleProperties = new XElement(W.rPr, 
                new XAttribute(XNamespace.Xmlns + "w", W.w));

            foreach (XName toggleProperty in toggleProperties)
            {
                XElement runDefaultToggleProperty = runDefault.Elements(toggleProperty).FirstOrDefault();

                if (runDefaultToggleProperty != null)
                {
                    if ((string)runDefaultToggleProperty.Attributes(W.val).FirstOrDefault() != "0")
                    {
                        runToggleProperties.Add(runDefaultToggleProperty);
                        continue;
                    }
                }

                XElement pStyleToggleProperty = null;
                if (pStyleRunProperties == null)
                    pStyleToggleProperty = null;
                else
                    pStyleToggleProperty = pStyleRunProperties.Elements(toggleProperty).FirstOrDefault();

                XElement rStyleToggleProperty = null;
                if (rStyleRunProperties == null)
                    rStyleToggleProperty = null;
                else
                    rStyleToggleProperty = rStyleRunProperties.Elements(toggleProperty).FirstOrDefault();

                if (pStyleToggleProperty == null && rStyleToggleProperty != null)
                    runToggleProperties.Add(rStyleToggleProperty);
                else if (pStyleToggleProperty != null && rStyleToggleProperty == null)
                    runToggleProperties.Add(pStyleToggleProperty);
                else if (pStyleToggleProperty != null && rStyleToggleProperty != null)
                {
                    if ((string)rStyleToggleProperty.Attributes(W.val).FirstOrDefault() == "0")
                        runToggleProperties.Add(pStyleToggleProperty);
                    else if ((string)pStyleToggleProperty.Attributes(W.val).FirstOrDefault() == "0")
                        runToggleProperties.Add(rStyleToggleProperty);
                    else
                        runToggleProperties.Add(new XElement(toggleProperty, new XAttribute(W.val, "0")));
                }
            }

            return runToggleProperties;
        }

        public static IEnumerable<XElement> StyleChainReverseOrder(XElement styles, string styleId)
        {
            string current = styleId;
            while (true)
            {
                XElement style = styles.Elements(W.style)
                    .Where(s => (string)s.Attribute(W.styleId) == current).FirstOrDefault();
                yield return style;
                current = (string)style.Elements(W.basedOn).Attributes(W.val).FirstOrDefault();
                if (current == null)
                    yield break;
            }
        }

        public static IEnumerable<XElement> StyleChain(XElement styles, string styleId)
        {
            return StyleChainReverseOrder(styles, styleId).Reverse();
        }

        private static XElement AssembleStyleInformation(XElement styles, string styleId)
        {
            return StyleChain(styles, styleId)
                .Aggregate(
                    new XElement(W.style, new XAttribute(XNamespace.Xmlns + "w", W.w)),
                    (mergedStyle, style) => MergeChildElements(mergedStyle, style));
        }

        public static XName[] Others =
        {
            W.pStyle,
            W.rStyle
        };

        public static XName[] ElementsWithMergeElementsSemantics =
        {
            W.style,
            W.rPr,
            W.pPr 
        };

        public static XName[] ElementsWithMergeAttributesSemantics =
        {
            W.ind,
            W.spacing,
            W.lang
        };

        public static XName[] ElementsWithReplaceElementsSemantics =
        {
            W.name, // The style Name element
            W.adjustRightInd,
            W.autoSpaceDE,
            W.autoSpaceDN,
            W.bidi,
            W.cnfStyle,  // within a table
            W.contextualSpacing,
            W.divId, 
            W.framePr,
            W.jc,
            W.keepLines,
            W.keepNext,
            W.kinsoku,
            W.mirrorIndents,
            W.numPr,
            W.outlineLvl,
            W.overflowPunct,
            W.pageBreakBefore,
            W.pBdr,  
            W.shd,
            W.snapToGrid,
            W.suppressAutoHyphens,
            W.suppressLineNumbers,
            W.suppressOverlap,
            W.tabs,  
            W.textAlignment,
            W.textboxTightWrap,  // within a textbox
            W.textDirection,
            W.topLinePunct,
            W.widowControl,
            W.wordWrap,
            W.b,
            W.bCs,
            W.bdr,
            W.caps,
            W.color,
            W.cs,
            W.dstrike,
            W.eastAsianLayout,
            W.effect,
            W.em,
            W.emboss,
            W.fitText,
            W.highlight,
            W.i,
            W.iCs,
            W.imprint,
            W.kern,
            W.noProof,
            W.oMath,
            W.outline,
            W.position,
            W.rFonts,
            W.rtl,
            W.shadow,
            W.shd,
            W.smallCaps,
            W.snapToGrid,
            //W.spacing,   // different from paragraph spacing
            W.specVanish,
            W.strike,
            W.sz,
            W.szCs,
            W.u,  
            W.vanish,
            W.vertAlign,
            W._w, 
            W.webHidden           
        };

        public static XName[] toggleProperties =
        {
            W.b,
            W.bCs,
            W.caps,
            W.emboss,
            W.i,
            W.iCs,
            W.imprint,
            W.outline,
            W.shadow,
            W.smallCaps,
            W.strike,
            W.vanish
        };

        public static bool IsValidMergeElement(XName name)
        {
            if (ElementsWithMergeAttributesSemantics.Contains(name) ||
                ElementsWithMergeElementsSemantics.Contains(name) ||
                ElementsWithReplaceElementsSemantics.Contains(name))
                return true;

            return false;
        }

        public static bool IsToggleProperty(XName name)
        {
            if (toggleProperties.Contains(name))
                return true;

            return false;
        }

        public static bool HasReplaceSemantics(XName name)
        {
            if (ElementsWithReplaceElementsSemantics.Contains(name))
                return true;

            return false;
        }

        public static bool HasMergeElementsSemantics(XName name)
        {
            if (ElementsWithMergeElementsSemantics.Contains(name))
                return true;

            return false;
        }

        public static bool HasMergeAttributesSemantics(XName name)
        {
            if (ElementsWithMergeAttributesSemantics.Contains(name))
                return true;

            return false;
        }

        public static XElement MergeChildElements(XElement mergedElement, XElement element)
        {
            if (mergedElement == null || element == null)
            {
                if (element == null)
                    element = mergedElement;
                XElement newElement = new XElement(element.Name,
                    new XAttribute(XNamespace.Xmlns + "w", W.w),
                    element.Attributes()
                   .Where(a =>
                   {
                       if (a.IsNamespaceDeclaration)
                           return false;
                       if (element.Name == W.style)
                           if (!(a.Name == W.type || a.Name == W.styleId))
                               return false;
                       return true;
                   }),
                element.Elements().Select(e =>
                {
                    if (e.Name == W.rPr || e.Name == W.pPr)
                        return MergeChildElements(null, e);

                    if (IsValidMergeElement(e.Name))
                        return e;

                    return null;
                }));
                return newElement;
            }

            XElement newMergedElement = new XElement(element.Name,
                new XAttribute(XNamespace.Xmlns + "w", W.w),
                element.Attributes()
                   .Where(a =>
                   {
                       if (a.IsNamespaceDeclaration)
                           return false;
                       if (element.Name == W.style)
                           if (!(a.Name == W.type || a.Name == W.styleId))
                               return false;
                       return true;
                   }),
                element.Elements().Select(e =>
                {
                    if (HasReplaceSemantics(e.Name))
                        return e;

                    // spacing within run properties has replace semantics 
                    if (element.Name == W.rPr && e.Name == W.spacing)
                        return e;

                    if (HasMergeAttributesSemantics(e.Name))
                    {
                        XElement newElement;
                        newElement = new XElement(e.Name,
                            e.Attributes(),
                            mergedElement.Elements(e.Name).Attributes()
                                .Where(a =>
                                    !(e.Attributes().Any(z => z.Name == a.Name))));
                        return newElement;
                    }

                    if (e.Name == W.rPr || e.Name == W.pPr)
                    {
                        XElement correspondingElement = mergedElement.Element(e.Name);
                        return MergeChildElements(correspondingElement, e);
                    }
                    return null;
                }),
                mergedElement.Elements()
                    .Where(m => !element.Elements(m.Name).Any()));

            return newMergedElement;
        }
    }
} 
```

# javascript - 在 Javascript 中循环数千个表单元素的最快方法

> ID：14145745
> 
> 赞同：2
> 
> 时间：2013-01-03T19:26:19.700
> 
> 标签：javascript

我正在尝试遍历数千个 javascript 元素。特别是复选框和选择。复选框需要在选中/取消选中之间切换，并且选择需要根据是否选中主复选框来禁用/启用。

```
 <script>
 function processFormElem(min, max, isChecked) {
    for (var i=min; i < max; i++) {
        document.getElementById('chkbox_'+i).checked = isChecked;
        document.getElementById('select_'+i).disabled = !(isChecked);
    }
}
</script>

 Check this: <input onchange='processFormElem(0,10000,this.checked);' type='checkbox'  value = '0'><br/><br/>

 <?php
 for ($i=0; $i < 10000; $i++) {
     echo "Check: <input type='checkbox' id='chkbox_$i' value = '1'> ";
     echo "Select: <select disabled='disabled'  id='select_$i'><option selected>1<option>xyz</select><br/>";
 }
 ?> 
```

这段代码完成了所需的工作，但处理表单元素的速度非常慢，我可以注意到滞后。有没有办法让它更快？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T19:32:52.040

如果您的复选框和选择框一个接一个，请尝试使用[nextElementSibling](https://developer.mozilla.org/en-US/docs/DOM/Element.nextElementSibling)。问题是 document.getElementById 必须搜索 DOM 树中的每个元素以找到具有匹配 ID 的元素（尽管底层实现可能使用哈希表或其他东西来提高 ID 查找性能）

无论哪种方式，使用 nextElementSibling 都可以让您像遍历树一样遍历元素，从而节省查找时间。

例如：

```
var cb = document.getElementById('chkbox_' + min),
    sb = document.getElementById('select_' + min);
while (cb !== null && sb !== null) {
    cb.checked = isChecked;
    sb.disabled = !isChecked;

    cb = cb.nextElementSibling;
    sb = sb.nextElementSibling;
} 
```

* * *

编辑：

正如 David 在下面指出的，并非所有浏览器都支持 nextElementSibling。您可以使用 nextSibling 解决这个问题。

代替：

```
cb = cb.nextElementSibling; 
```

做：

```
while(cb !== null && cb.nodeName != 'Element') { cb = cb.nextSibling; } 
```

话虽如此，不支持 nextElementSibling 的浏览器每天都在变得越来越少，而 nextSibling 解决方案也有很多自己的开销。如果您想支持旧版浏览器，这取决于您（或可能是您的老板）。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-03T19:55:15.333

我认为在这里使用 Jquery 会更好：

```
$(':checkbox').each(function () {  
    this.checked = isChecked; 
});
//isChecked-true/false 
```

希望它会正常工作。

# keyboard - 如何防止 keyup 事件中断 jQuery 中的 keydown 事件？

> ID：14145753
> 
> 赞同：2
> 
> 时间：2013-01-03T19:26:55.357
> 
> 标签：keyboard, jquery-animate, jquery, keyboard-events

> **可能重复：**
> [当按键被按住时，跨浏览器获取自动重复按键事件的方式](https://stackoverflow.com/questions/14027818/cross-browser-way-to-get-automatically-repeating-keydown-events-when-key-is-held)

我正在尝试用 JavaScript/CSS/HTML 创建一个简单的游戏，并且我正在使用 jQuery（和一点下划线）来处理按键。玩家使用箭头键控制方块。我遇到了同时处理多个按键的问题。我有一个系统，其中一个闭包跟踪所有按下的箭头键。如果玩家按以下顺序按键，这将很有效：

1.  玩家按下（方块向下移动）
2.  玩家按下左键（方块向左斜下方移动）
3.  玩家释放向下（块向左移动）
4.  玩家释放左手（阻挡停止

但是，如果将步骤 3 和 4 颠倒过来，程序块就会停止。以下是在这种情况下实际发生的情况：

1.  玩家按下（方块向下移动）
2.  玩家按下左键（方块向左斜下方移动）
3.  玩家释放左手（阻挡停止）

预期的行为是在第 3 步，块将继续向下移动，而不是完全停止。

从我在代码中输入的痕迹来看，一个 keyup 事件似乎实际上停止了进一步的 keydown 事件的传播，即使我的手指仍然按住其中一个箭头键。

这是相关代码的片段。谁能告诉我问题可能出在哪里？

```
// Creates an animation handler for a specific element.
// Animation reacts to any changes as they are submitted
var getMovementAnimator = function(element) {
    var params = {},
        $element = $(element);
    return function(changes) {
        _.each(changes, function(val, key) {
            // Remove null or zeroish keys from animation params
            if ( (val == 0 || !val) && _.has(params, key)) {
                delete params[key];
            } else {
                params[key] = '+=' + val + 'px';
            }
        });
        $element.animate(params, {duration: 0, queue: false});
        console.log(params);
    };
};

// Determines direction and speed of movement for an element
// after a keypress event
var getMovementChange = function(keyEvent, keydown) {
    var isMoving = !!keydown,
        params   = {},
        dir      = '',
        speed    = keydown ? 5 : 0,
        arrows   = {left: 37, up: 38, right: 39, down: 40};
    switch (keyEvent.which) {
        case arrows.left:
            dir = 'left';
            speed = -speed;
            break;
        case arrows.up:
            dir = 'top';
            speed = -speed;
            break;
        case arrows.right:
            dir = 'left';
            break;
        case arrows.down:
            dir = 'top';
            break;
    }
    // If key hit not one of above, do nothing
    if (!dir) {
        return false;
    }
    if (!speed) {
        console.log('key up: ', dir);
    }
    params[dir] = speed;
    return params;
}

// Sets up key handlers
$(document).ready(function() {
    var board = $('#board'),
        animatePlayer = getMovementAnimator('.player');
    $(document).keydown(function(e) {
        e.preventDefault();
        var changes = getMovementChange(e, true);
        animatePlayer(changes);
    }).keyup(function(e) {
        e.preventDefault();
        var changes = getMovementChange(e, false);
        animatePlayer(changes);
    });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T20:48:03.170

对 Stack Overflow 的进一步搜索（使用正确的关键字）表明我看到的问题实际上并不是我的代码中的错误。相反，[这是操作系统的预期行为](https://stackoverflow.com/a/5841905/959934)。

但是，我找到[了一个我相信可以解决问题的解决方法](https://stackoverflow.com/a/14027886/959934)。

# android - Chrome Android 中的 FileSystemAPI

> ID：14145759
> 
> 赞同：0
> 
> 时间：2013-01-03T19:27:12.050
> 
> 标签：android, google-chrome, fileapi

Android 上的 Chrome 是否支持完整的 FileSystemAPI。具体来说，我需要 FileWriter 和创建目录的能力。caniuse.com 对此没有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T05:05:43.343

是的，它应该与您在桌面 Chrome 上所期望的一样工作。

# android - seekBar 和刷新

> ID：14145760
> 
> 赞同：0
> 
> 时间：2013-01-03T19:27:13.843
> 
> 标签：android

我有一个 seekBar，我可以增加和减小文本大小，但我有一个问题：当我通过 seekBar 更改值并按下按钮（x++）时，新的 TextSwitched 没问题，但如果我再次按下我有旧值（文本减少）。再次按下我有新的价值......当我按下按钮时，读取日志值不会改变。值仅在使用 seekBar 时发生变化。谢谢你的耐心。

```
seekBar1.setOnSeekBarChangeListener(new OnSeekBarChangeListener() {
          public void onStopTrackingTouch(SeekBar seekBar) {
          // TODO Auto-generated method stub
          if(seek<10)
          {
          seek=10;
          seekBar1.setProgress(seek);
          }

          }
          public void onStartTrackingTouch(SeekBar seekBar) {
          // TODO Auto-generated method stub
          }
          public void onProgressChanged(SeekBar seekBar, int progress,boolean fromUser) {
          // TODO Auto-generated method stub
          seek=progress;

          TextView t = (TextView) mSwitcher.getChildAt(0); 
          t.setTextSize(seek);
          Log.i("MyActivity", "MyClass.getView() — list " + seek);

          SharedPreferences prefs = getSharedPreferences(PRIVATE_PREF, 0);
          SharedPreferences.Editor editor = prefs.edit();
          editor.putInt("seek", seek);
          editor.putInt("progress", progress);
          editor.commit(); 
```

按钮：

```
button2.setOnClickListener(new View.OnClickListener() {
            public void onClick(View v) {
                    x++;
                    mSwitcher.setText(""+prog[x]); 
```

公共视图 makeView() { TextView t = new TextView(this);

```
return t; 
```

# java - Spring 控制器是线程安全的吗

> ID：14145761
> 
> 赞同：12
> 
> 时间：2013-01-03T19:27:16.340
> 
> 标签：java, spring

我遇到了这个 Controller 示例，想知道它是否是线程安全的？我特别想知道 gson 实例变量。

```
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import com.google.gson.Gson;
import java.io.IOException;
import java.util.ArrayList;
import java.util.HashMap;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

@Controller
public class TestController {

    private final Gson gson = new Gson();

    @RequestMapping(value = "/test", method = RequestMethod.GET)
    public void test(HttpServletResponse res, HttpServletRequest req) throws IOException {
        HashMap<String, String> hm = new HashMap();
        res.getWriter().print(gson.toJson(results));
        res.getWriter().close();
    }
} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-03T19:37:06.180

要回答标题中的问题，“Spring 控制器是线程安全的”，Spring 控制器是单例的，因此它们应该以线程安全的方式实现，但您需要确保您的实现实际上是线程安全的。

在您发布的代码中，您应该没问题，因为正如其他人指出的那样，GSON 是线程安全的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T19:29:34.977

假设这个控制器被创建为一个普通的 Spring“单例”bean，答案是**否定**的。

您可以将控制器创建为[原型](http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/html/beans.html#beans-factory-scopes-prototype)bean，在这种情况下，将为每个请求创建一个新实例。如果你想这样做，一个更好的主意是将你的 bean 的范围定义为`request`.

但是，我质疑*任何*控制器对象具有成员变量的原因，除了可能错误地确定 bean 的范围。这表明控制器正在尝试做太多工作，并且应该将其中一些工作卸载到服务或帮助程序类。MVC 控制器应该做的唯一事情是将请求数据传递到服务层，并检索要由视图显示的数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-03T19:34:25.177

`Gson`绝对是线程安全的，并且早在 2008 年就以这种方式制作，所以只要你的版本是发布的，那么它应该没问题。我发现您的代码没有线程安全问题。虽然我会制作`Gson`静态的实例。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-03T19:34:28.257

就像 servlet 控制器请求处理程序方法也不是线程安全的。即多个请求`/test`可能使许多线程执行测试方法。

在您的示例中，您不必担心线程安全，因为这`gson.toJson(results)`是 gson 上的唯一操作，并且似乎它不会改变该对象的状态。

# ruby-on-rails-3 - 没有资源的 Rails 3 中的命名空间控制器路由

> ID：14145764
> 
> 赞同：0
> 
> 时间：2013-01-03T19:27:22.283
> 
> 标签：ruby-on-rails-3, rails-routing

我正在将应用程序从 Rails 2 迁移到 Rails 3。
我们有多个具有不同命名空间的命名空间控制器。由于它们不是 RESTfull 我不想使用资源路由，而是我想要一个旧的 Rails 2，比如*match ':controller/:action'*来获取命名空间的控制器。

在我的 routes.rb 我有

```
# Install the default route as the lowest priority.
match ':controller(/:action(/:id(.:format)))'
match ':controller(/:action(/:id(.:format)))', :controller => /[^\/]+\/[^\/]+/ 
```

*rake 路由*报告

```
/:controller(/:action(/:id(.:format)))          :controller#:action
/:controller(/:action(/:id(.:format)))          (?-mix:[^\/]+\/[^\/]+)#:action 
```

*对/config/companies/index*的请求仍然失败

```
ActionController::RoutingError (No route matches [GET] "/config/companies/index"): 
```

我究竟做错了什么？是否有另一种方法来获取具有动态段的命名空间路由？当我尝试同时使用*命名空间*和与动态段的*匹配*时，它会引发错误。

```
:controller segment is not allowed within a namespace block 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T01:35:56.967

好的，我发现了问题。
Config 是 Rails 中的一个保留常量，它指向 RbConfig。我的匹配条件实际上有效，但尝试调用 RbConfig::CompaniesController 当然不存在。

当我尝试添加

```
match '/:controller(/:action(/:id(.:format)))', :controller => /config\/[^\/]+/ 
```

错误是

```
ActionController::RoutingError (uninitialized constant RbConfig::CompaniesController) 
```

解决方案：重命名 app/controllers/config -> app/controllers/configuration（和 views 文件夹）并添加重定向到路由以处理旧链接。

```
match '/config/*path' => redirect("/configuration/%{path}") 
```

# vb.net - 在 Rational Functional Tester 的数据池中间开始测试

> ID：14145766
> 
> 赞同：0
> 
> 时间：2013-01-03T19:27:25.963
> 
> 标签：vb.net, functional-programming, rft

我是新手，你很快就会知道的。我在 VB.Net 中使用 Rational Funcational Tester (RFT)。我对关联的数据池进行了测试。我已经能够毫无问题地运行测试。我要做的就是在数据池的记录 5 上开始测试并运行到最后。我不知道如何从迭代 5 开始。我可以使用某种运行时参数吗？我以前是 QTP 的用户，并且确切地知道在那里寻找什么。RFT 对我来说是一种新事物。与往常一样，我非常感谢那些从忙碌的日子里抽出时间教别人的人。我提前感谢您的时间和努力。

德里克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-05T20:09:52.940

// 假设数据池已经与你的执行脚本相关联，

int targetRow = 4; // 0, 1, 2, 3, 4 即第5条记录

for (int i = 0; (i < targetRow) && (!dpDone()); ++i) {

```
dpNext(); 
```

}

// 您现在位于第 4 行（即第五条记录；数据池索引从零开始）

//你现在可以做类似的事情

字符串用户名 = dpString(0);

# php - 如果您在数组中的左侧位置用于键而右侧用于值，如何对 php 数组进行排序？

> ID：14145768
> 
> 赞同：0
> 
> 时间：2013-01-03T19:27:35.793
> 
> 标签：php, arrays, sorting, numeric, associative

我遇到了问题，`array_push`所以我需要制作数字数组而不是关联数组。但是，当我这样做时，我总是推送 2 个值：

1.  首先是搜索的关键（表中对象的 ID）
2.  第二个是赋予具有 ID 的对象的一些值。

因此，如果我们有，比如说，`4`具有 ID 的对象：`1,2,3,4`并且我们会给它们一些值：（`20, 50, 40, 30`从最低的 ID 开始），我的数组看起来像：

```
1, 20, 2, 50, 3, 40, 4, 30. 
```

如何从最高值对数组进行排序？结果应该是数组，如下所示：

```
2, 50, 3, 40, 4, 30, 1, 20. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T19:31:46.693

PHP 支持嵌套（多维）数组

```
$array = [
    [1, 20],
    [2, 50],
    [3, 40],
    [4, 30]
]; 
```

现在您可以轻松对其进行排序

```
usort(
    $array,
    function ($left, $right) { return $right[1] - $left[1]; }
);
var_dump($array); 
```

根据此 ID 和值是什么，您可以考虑改为创建一个类，尤其是当存在与此 ID 关联的其他值时。

更新：哦，因为你提到

> 第一个是搜索的键（**表**中对象的 ID ），第二个是赋予具有 ID 的对象的一些值。

当您谈论数据库表时，让数据库为您排序；）

```
ORDER BY `valueColumn` DESC 
```

# c - 比较指向字符的指针

> ID：14145771
> 
> 赞同：0
> 
> 时间：2013-01-03T19:27:48.993
> 
> 标签：c, pointers

我试图用 C 写这个东西：

```
(*(result+1))!="\0" 
```

编译器说：

> 条件下的可能分配`(*(result+1))=!"\0"`

问题是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-03T19:29:21.247

C 中的比较使用`==`运算符。单曲`=`是作业。除此之外，您还试图将指针与整数进行比较。您拥有的代码是：

```
(*(result+1))=!"\0" 
```

在那个表达式中，`!"\0"`等于`0`，所以你的代码*真的*在做：

```
(*(result+1))=0 
```

这可能不是你想要的。当然，它与您在“我正在尝试编写此表达式”示例中的内容不匹配。我认为你想要做的是：

```
(*(result+1)) != '\0' 
```

使用`!=`“不等于”运算符。看起来你已经写`=!`了。可能只是一个错字。请注意，我也将双引号更改为单引号以更正您的表达式。

编辑说明 - 您根本不需要操作员。你的表达等于：

```
*(result + 1) 
```

这首先会为您省去麻烦。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T19:30:22.007

如果您确实在执行比较而不是分配，则需要`==`代替`=`; 这就是为什么您会收到可能的分配消息。

# file-upload - 在网站上上传图片的格式

> ID：14145772
> 
> 赞同：0
> 
> 时间：2013-01-03T19:27:49.367
> 
> 标签：file-upload, format

这个问题不是很技术，但我认为它仍然是问这个问题的正确地方。我们正在创建一个像 Yelp 这样的网站。我的问题是，当我们扫描菜单时，这些菜单应该保存为 png 或 jpg 还是服务器上的任何其他格式？或者保存这些文件的最佳方法是什么？因此，它可以快速打开，而不会为客户端占用过多的服务器负载。我看到餐厅照片可以保存为 jpg。有了答案，您能否解释一下为什么应该使用一种格式而不是另一种格式？

# cookies - webdynpro abap 获取 cookie

> ID：14145777
> 
> 赞同：1
> 
> 时间：2013-01-03T19:28:07.183
> 
> 标签：cookies, abap, webdynpro

我有一个要求，我需要将一个外部应用程序嵌入到 webDynpro ABAP 中，我打算使用 IFrame 嵌入它。

我还需要将此外部应用程序中的 cookie 信息读入 WebDynpro ABAP。

有什么想法可以实现吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T14:43:16.070

有一个 IFrame 组件可用于嵌入外部应用程序。
但是，WDA 不提供对 cookie 的访问（除非两个应用程序位于同一域中，否则它们无论如何都无法访问彼此的 cookie）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-09T23:18:09.013

我会建议一些古老的技术，但它确实有效：

*   使用框架集和两个框架在您的 SAP 服务器上创建 BSP 应用程序
*   一帧将有 100% 的高度，它将包含您的外部应用程序
*   其他框架的高度为零（因此它将不可见），它将包含您的 BSP 应用程序和 javascript 代码的视图
*   视图将包含带有隐藏字段的表单
*   javascript代码将从可见框架中获取cookie并将值填充到隐藏字段中并提交表单（这是假设您可以逐帧访问内容的地方，否则您将面临跨站点脚本问题）
*   ABAP 端的 BSP 应用程序将以这种方式接收 cookie 值作为表单数据，并可以在服务器端以某种方式将其传递给 webdynpro 应用程序（通过共享内存或其他方式）

这听起来像是一个解决方案吗？

# android - ActionBar 下拉导航 - 方向更改将错误的片段放入

> ID：14145781
> 
> 赞同：6
> 
> 时间：2013-01-03T19:28:32.597
> 
> 标签：android, drop-down-menu, navigation, android-actionbar, orientation-changes

我有一个操作栏下拉导航。问题是当我切换到不同的片段，然后进行方向更改时，无论如何它都会将第一个片段放入其中，即使我认为我正确地处理了 savedInstanceState 。问题似乎是 onNavigationItemSelected 被调用，所以..我将如何正确处理这个？我可以将 savedInstanceState 变量设为字段，但这感觉不对……

```
public class MainActivity extends FragmentActivity implements MyListFragment.OnArticleSelectedListener {

public static final String TAG = "MainActivity";

@SuppressLint("NewApi")
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    if(savedInstanceState != null) {
        Fragment savedFragment = getSupportFragmentManager().getFragment(savedInstanceState, "saved_fragment");
        Log.d(MainActivity.TAG, "savedInstanceState != null: " + savedFragment.getTag());

        getSupportFragmentManager()
        .beginTransaction()
        .replace(R.id.fragment_container, savedFragment, savedFragment.getTag())
        .commit();
    } else {

        Log.d(MainActivity.TAG, "savedInstanceState == null");

        getSupportFragmentManager()
        .beginTransaction()
        .replace(R.id.fragment_container, new MyListFragment(), MyListFragment.TAG)
        .commit();
    }

    ActionBar actionBar = getActionBar();
    actionBar.setDisplayShowTitleEnabled(false);
    actionBar.setNavigationMode(ActionBar.NAVIGATION_MODE_LIST);

    String[] array = new String[] { "Inzeráty", "Dummy frag" };
    SpinnerAdapter mSpinnerAdapter = new ArrayAdapter<String>(this, android.R.layout.simple_spinner_dropdown_item,
            array);

    actionBar.setListNavigationCallbacks(mSpinnerAdapter, new ActionBar.OnNavigationListener() {

        @Override
        public boolean onNavigationItemSelected(int itemPosition, long itemId) {

            Log.d(MainActivity.TAG, "onNavitagionItemSelected");

            FragmentTransaction transaction = getSupportFragmentManager().beginTransaction();
            switch(itemPosition) {
                case 0: 
                    transaction.replace(R.id.fragment_container, new MyListFragment(), MyListFragment.TAG);
                    break;
                case 1:
                    transaction.replace(R.id.fragment_container, new MyDummyFragment(), MyDummyFragment.TAG);
                    break;
            }
            transaction.commit();
            return true;
        }

    });

}

@Override
public void onArticleSelected(Bundle bundle) {
    Log.d(MainActivity.TAG, "MainActivity # onArticleSelected");
    Intent intent = new Intent(this, DetailActivity.class);
    intent.putExtras(bundle);
    startActivity(intent);
}

@Override
protected void onSaveInstanceState(Bundle outState) {
    Fragment currentFragment = getSupportFragmentManager().findFragmentById(R.id.fragment_container);
    Log.d(MainActivity.TAG, "MainActivity # onSaveInstanceState: " + currentFragment.getTag());
    getSupportFragmentManager().putFragment(outState, "saved_fragment", currentFragment);
    super.onSaveInstanceState(outState);
} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T03:34:06.260

我最近也遇到了这个问题。我通过覆盖`onRetainCustomNonConfigurationInstance`活动的方法来解决它。

```
@Override
public Object onRetainCustomNonConfigurationInstance() {
    // return true so that onCreate will know it is an orientation change
    return true;
} 
```

在我`onCreate`的情况下，我能够实现以下内容：

```
...
Object lastCustomNonConfigurationInstance = getLastCustomNonConfigurationInstance();
if (lastCustomNonConfigurationInstance != null) {
    mIsOrientationChange = (Boolean) getLastCustomNonConfigurationInstance();
}
... 
```

最后我更新`onNavigationItemSelected`了，让它知道`mIsOrientationChange`

```
 @Override
public boolean onNavigationItemSelected(int position, long id) {
    if (!mIsOrientationChange) {
        // real navigation selected logic           
    }

    mIsOrientationChange= false;

    return true;
} 
```

编辑：我从以下 Android 开发人员文章中得到了实现这一点的想法：http: [//developer.android.com/guide/topics/resources/runtime-changes.html#RetainingAnObject](http://developer.android.com/guide/topics/resources/runtime-changes.html#RetainingAnObject)

# linux - Git pull权限被拒绝linux？

> ID：14145783
> 
> 赞同：8
> 
> 时间：2013-01-03T19:28:41.177
> 
> 标签：linux, git, ubuntu

当我跑步时`git pull origin test`，我得到

```
fatal: unable to connect to cache daemon: Permission denied 
```

然后是 github 用户名和密码的提示。该目录位于我的主文件夹 ( `~/www/software`) 下。有任何想法吗？如果我使用`sudo`，它可以工作，但我觉得我不应该在我自己的主文件夹中使用 su ！

这是结果`ls -l`：

```
drwxrwxrwx 48 root    root      53248 Jan  3 12:10 application
-rw-rw-r--  1 andrewr andrewr 1458793 Jan  2 10:09 a.txt
-rw-rw-r--  1 andrewr andrewr     186 Jan  2 10:09 Desktop.ini
-rw-rw-r--  1 andrewr andrewr    1406 Jan  2 10:10 favicon.ico
-rw-rw-r--  1 andrewr andrewr    6858 Jan  2 10:10 fb.jpg
-rw-rw-r--  1 andrewr andrewr       2 Jan  2 10:10 format
-rw-rw-r--  1 andrewr andrewr     398 Jan  2 10:10 index.php
-rw-rw-r--  1 andrewr andrewr   16572 Jan  2 10:10 license.txt
-rw-rw-r--  1 andrewr andrewr    1390 Jan  2 10:10 loginscreen.php
-rw-rw-r--  1 andrewr andrewr    6424 Jan  2 10:10 md5_login.js
-rw-rw-r--  1 andrewr andrewr      65 Jan  2 10:10 phpinfo.php
-rw-rw-r--  1 andrewr andrewr    9202 Jan  2 10:10 readme.html
-rw-rw-r--  1 andrewr andrewr     101 Jan  2 10:09 README.md
-rw-rw-r--  1 andrewr andrewr     229 Jan  2 10:09 README.txt
-rw-rw-r--  1 andrewr andrewr  180467 Jan  2 10:10 svn.ico
-rw-rw-r--  1 andrewr andrewr      71 Jan  2 10:10 test.php
-rw-rw-r--  1 andrewr andrewr   46080 Jan  2 10:09 Thumbs.db
-rw-rw-r--  1 andrewr andrewr    4268 Jan  2 10:10 wp-activate.php
drwxrwxrwx  9 root    root       4096 Jan  2 10:10 wp-admin
-rw-rw-r--  1 andrewr andrewr   40272 Jan  2 10:10 wp-app.php
-rw-rw-r--  1 andrewr andrewr     274 Jan  2 10:10 wp-blog-header.php
-rw-rw-r--  1 andrewr andrewr    3982 Jan  2 10:10 wp-comments-post.php
-rw-rw-r--  1 andrewr andrewr    3444 Jan  2 10:10 wp-config.php
-rw-rw-r--  1 andrewr andrewr    3087 Jan  2 10:10 wp-config-sample.php
drwxrwxrwx  6 root    root       4096 Jan  2 10:10 wp-content
-rw-rw-r--  1 andrewr andrewr    2684 Jan  2 10:10 wp-cron.php
drwxrwxrwx  8 root    root       4096 Jan  2 10:10 wp-includes
-rw-rw-r--  1 andrewr andrewr    1997 Jan  2 10:10 wp-links-opml.php
-rw-rw-r--  1 andrewr andrewr    2546 Jan  2 10:10 wp-load.php
-rw-rw-r--  1 andrewr andrewr   27695 Jan  2 10:10 wp-login.php
-rw-rw-r--  1 andrewr andrewr    7777 Jan  2 10:10 wp-mail.php
-rw-rw-r--  1 andrewr andrewr     413 Jan  2 10:10 wp-pass.php
-rw-rw-r--  1 andrewr andrewr     334 Jan  2 10:10 wp-register.php
-rw-rw-r--  1 andrewr andrewr    9913 Jan  2 10:10 wp-settings.php
-rw-rw-r--  1 andrewr andrewr   18545 Jan  2 10:10 wp-signup.php
-rw-rw-r--  1 andrewr andrewr    3702 Jan  2 10:10 wp-trackback.php
-rw-rw-r--  1 andrewr andrewr    1834 Jan  2 10:10 x.htaccess.bak
-rw-rw-r--  1 andrewr andrewr    3266 Jan  2 10:10 xmlrpc.php 
```

几乎所有更改都在`application`文件夹内进行

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-04T16:06:44.503

问题是 git 无法连接到它的凭证缓存（阅读[http://git-scm.com/docs/git-credential-cache](http://git-scm.com/docs/git-credential-cache)了解更多信息）。

从文档：

> 缓存可通过 Unix 域套接字访问，由文件系统权限限制为当前用户。

所以你只需要检查这个域套接字的文件权限。通常它被放置 `~/.git-credential-cache/socket`并更改它们以使其可供`andrewr`用户访问。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-03T20:33:33.417

问题似乎在您的文件所有者中。看一看：

```
drwxrwxrwx 48 root root 53248 Jan 3 12:10 application 
...
drwxrwxrwx 9 root root 4096 Jan 2 10:10 wp-admin 
```

即使这些目录对每个人都是可读、可写和可执行的，但其中的文件可能不是。此外，在您的主文件夹中拥有属于的目录`root`可能不是一个好主意。

如果在以下范围内执行此命令应该可以解决问题`~/www/software`：

```
chown -R andrewr:andrewr * 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-03-05T07:16:54.577

这是由于 git 缓存权限问题。

更改用户和组

chown -R current_user:user_group ~/.cache/git/

chown -R current_user:user_group .git/

您可以从以下位置获取当前用户信息：whoami

# java - 如何安全地中断具有关键原子逻辑的线程？

> ID：14145787
> 
> 赞同：3
> 
> 时间：2013-01-03T19:29:01.397
> 
> 标签：java, multithreading, synchronization

我有一个线程在一个循环中做两件事：等待来自 BlockingQueue 的对象，然后处理它们。处理逻辑具有可在 JVM 之外观察到的效果，并且必须以原子方式完成。

目前，该线程由 volatile 布尔变量控制，如[https://stackoverflow.com/a/10961760/499922](https://stackoverflow.com/a/10961760/499922)中所述。但是，这意味着如果队列中没有更多消息可供线程使用，线程将不会停止。'Thread.interrupt()` 不能用来解决这个问题，因为它可以中途中断原子操作。

有没有办法只中断`take()`队列上的方法而不是任何其他操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T19:41:17.470

> 'Thread.interrupt()` 不能用来解决这个问题，因为它可以中途中断原子操作。

它不这样做。它所做的只是设置一个标志，这与设置易失性字段非常相似。

即使您要使用`Thread.stop()`已弃用并且可以触发任何代码行抛出错误的代码，您仍然可以捕获此类错误并确保您的数据处于一致状态。

我不会创建队列和线程来执行该队列之外的任务，而是使用具有这两者的 ExecutorService ，它可用于取消/中断单个任务，支持多个线程，正常或立即关闭并等待终止。

很有可能你最好不要重新发明这个轮子。;)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T19:32:47.737

一种方法是在队列中放置一个特殊的“哨兵”对象。线程会知道这个特殊对象的含义，并在收到它时采取适当的行动。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-03T19:33:24.547

我发现在这种情况下最好的方法是使用“毒丸”——你在队列中放置一个对象，该对象仅用于切换某个动作。

它在实践中的 Java 并发中得到了广泛的介绍（​​我的副本中的第 155 页，第 7.2.3 页）。有关该部分的程序示例，请参见[此处。](http://www.javaconcurrencyinpractice.com/listings/IndexingService.java)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-03T19:33:25.233

与其依赖 volatile 布尔值，不如依赖线程的中断标志：

```
while (!Thread.currentThread().isInterrupted()) {
    try {
        Object value = queue.take();
        handle(value);
    } catch (InterruptedException e) {
        Thread.currentThread().interrupt();
    }
} 
```

这样，当流被阻塞时，`take()`它会在线程中断时立即退出循环。如果它在任何其他时间被中断，它将在完成当前循环后退出循环。

或者，您可以将其编码为在中断后继续循环，只要对象立即在队列中可用，`poll()`从那时起使用。

# lambda - 在方案中使用多个 lambda 是什么意思？

> ID：14145789
> 
> 赞同：3
> 
> 时间：2013-01-03T19:29:08.643
> 
> 标签：lambda, functional-programming, scheme, currying, lambda-calculus

我目前正在学习计划，我遇到了这些功能：

```
(define t (lambda (x) (lambda (y) x))) 
(define f (lambda (x) (lambda (y) y))) 
```

显然，它们是将真假表示为函数。我不知道为什么！

我有两个问题：

1) 连续的 lambda 是什么意思？我只习惯于看到一个用于将参数传递给函数的 lambda；IE

```
(define add
  (lambda (x y)
    (+ x y))) 
```

通过调用，`(add 1 5)`我将被提供`6`为输出。

2）如何使用这些真假函数？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-03T20:57:04.393

这里发生的事情被称为[柯里](http://en.wikipedia.org/wiki/Currying)化 - 转换一个接受 n 个多个参数的函数，使其可以被称为函数链

让我们考虑一个有 2 个参数的函数 f，即 f(x,y)。存在一个一元函数 g 使得 f(x,y) = g(x)(y) =(g(x))(y)。函数 g 被称为 f 的**柯里**化版本。

g 是一个函数，它需要一个参数 (x)，而 g(x) 的值也是一个参数 y 的函数。

让我们考虑一个 curried-add 函数：

```
(define curried-add 
  (lambda (x) 
    (lambda (y) (+ x y))))

((curried-add 1) 5) 
```

对 (curried-add 1) 的调用将返回一个函数，该函数接受一个参数，在我们的例子中是 5 并将其添加到 1，给出和输出 6。

我们可以将这些 curried-add 链接在一起以获得：

```
((curried-add ((curried-add 1) 2)) 3) 
```

将产生输出 6。这是因为 (curried-add 1) 将返回一个需要一个参数的函数，在本例中为 2。因此，将 1 添加到 2 并生成一个需要一个参数的函数，该参数可以添加到3 我们刚做的。

在这种情况下，您的真假功能。

真实的是：`(define t (lambda (x) (lambda (y) x)))`

错误的是：`(define f (lambda (x) (lambda (y) y)))`

true 函数接受两个参数并返回第一个，false 函数返回两个参数中的第二个。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-03T21:19:53.137

正如@Hayden 在他的回答中指出的那样，连续的 lambda 是[currying](http://en.wikipedia.org/wiki/Currying)的一个例子，本质上只是一个返回另一个函数的函数：

> 在数学和计算机科学中，柯里化是一种转换具有 n 个多个参数（或参数的 n 元组）的函数的技术，它可以被称为函数链，每个函数都有一个参数（部分应用）。它由 Moses Schönfinkel 发起，后来被 Haskell Curry 重新发现

对于您问题的第二部分：布尔值可以编码为函数，它是在[lambda calculus中使用](http://en.wikipedia.org/wiki/Lambda_calculus)[Church 布尔](http://en.wikipedia.org/wiki/Church_encoding#Church_booleans)值表示的真值，请参阅链接以了解它们的使用方式：

> Church 布尔值是布尔值 true 和 false 的 Church 编码。一些编程语言使用这些作为布尔运算的实现模型；例如 Smalltalk 和 Pico。布尔值表示为两个值的函数，这些值的计算结果为它们的一个或另一个参数。lambda 演算中的正式定义：

```
true ≡ λa.λb. a
false ≡ λa.λb. b 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-03T20:51:25.737

它们是函数，当使用 1 个参数调用时会返回另一个函数。所以你可以这样称呼他们——

```
(define v (some expression that returns t or f))
((v 'foo) 'bar) ; ==> foo if v is t, bar if v is f 
```

这有点像`(if v 'foo 'bar)`普通的内置布尔值。它通常用于在简单的 lambda 演算中对真/假进行编码。

# java - 如何在android中检查日期（从json文件中获取）是之前还是之后？

> ID：14145792
> 
> 赞同：2
> 
> 时间：2013-01-03T19:29:19.993
> 
> 标签：java, android, json

我从 JSON 文件中获取一个日期，它是字符串格式的。我有两个字符串值，名为 startdate 和 enddate，它们来自意图到 currentActivity。现在我想检查一下，来自 json 文件的日期值是在 startdate 之后还是 enddate 之前。我怎样才能做到这一点？是的，我 json 文件的格式是“yyyy-mm-dd”。

JSON 数据看起来像：

{"posts":[{"start_date":"2013-02-15","end_date":"2013-02-21"}]}

这是我尝试过的代码，但我得到的输出为**Mon Jan 07 00:00:00 GMT+5:30 2013**：

```
Intent intent = getIntent();
String startDate = intent.getStringExtra("startDate"); //I have check this. It is proper.
String endDate = intent.getStringExtra("endDate"); //I have check this. It is proper.

SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd");
Date start = null,end = null;
try {
start = sdf.parse(startDate);
end = sdf.parse(endDate);
} catch (ParseException e1) {
e1.printStackTrace();
} 
```

这是比较日期的代码：

```
Date date = null;  
try {
    date = sdf.parse(c.getString(TAG_DATE)); //I am getting the date from a json file here.
} catch (ParseException e) {
    e.printStackTrace();
}
Date currDate = new Date();
if (end.compareTo(currDate) < 0 || start.compareTo(currDate) < 0) {
    Toast.makeText(getApplicationContext(),"Please select valid dates...",Toast.LENGTH_SHORT).show();
} else if (end.compareTo(currDate) == 0 && start.compareTo(currDate) >= 0){
    if (date.after(start)) {
        Toast.makeText(getApplicationContext(), "After...",Toast.LENGTH_SHORT).show();
    }
} else if (end.compareTo(currDate) > 0  && start.compareTo(currDate) >= 0) {
        if (date.after(start) && date.before(end)) {
        Toast.makeText(getApplicationContext(),"Before...",Toast.LENGTH_SHORT).show();
    }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T19:46:10.360

我更喜欢使用更强大的方法，将日期字符串转换为实际[`Date`](http://developer.android.com/reference/java/util/Date.html)（或[`Calendar`](http://developer.android.com/reference/java/util/Calendar.html)）对象：

```
String startDateString = ...; // get date string from json
String endDateString = ...; // get date string from json
SimpleDateFormat formatter = new SimpleDateFormat("yyyy-MM-dd");
Date start = formatter.parse(startDateString);
Date end = formatter.parse(endDateString); 
```

从这里开始，您可以使用 eg `start.before(end)`or`end.after(start)`来检查日期是在另一个日期之前还是之后。如果您需要更细粒度的控制，您始终可以以毫秒为单位获取日期，并让您的逻辑工作。

* * *

所以你已经更新了你的代码，但是你把它留给我们来弄清楚发生了什么，更重要的是，你期望发生什么？看起来您想检查当前日期与从 json 检索到的日期之间的关系，尽管我对名为 的第四个日期字段`date`的用途有点迷茫。

只是关于当前片段的一些评论：

```
if (end.compareTo(currDate) < 0 || start.compareTo(currDate) < 0) 
```

就个人而言，我发现`before()`并且`after()`更具可读性和描述性，但我认为使用`compareTo()`. 但是，重要的是要意识到只有当两个日期的基础*毫秒*表示相等`0`时才会返回。话虽如此，我不确定在以下情况下进行第一次检查有多大意义：

 *```
else if (end.compareTo(currDate) == 0 && start.compareTo(currDate) >= 0) 
```

您必须**非常**`end`幸运才能获得与完全相同的毫秒数`currDate`。除非您在某处进行一些操作以将所有日期标准化为例如午夜，否则这不太可能`end.compareTo(currDate) == 0`是真的。

关于这个规范化：看看前面提到的[`Calendar`](http://developer.android.com/reference/java/util/Calendar.html)类。它将允许您轻松检索日期戳/时间戳的单独字段的值。例如，如果您只想比较日、月和年，则可以通过`Calendar`简单的 get 调用从实例中获取这些特定字段。更方便的是您还可以独立设置每个字段 - 这非常适合将所有日期标准化为例如午夜或中午，之后您仍然可以使用`before()`and`after()`方法。

我相信这应该为您提供足够的指针来正确编写适合您需求的实现。在不确切知道您要达到的目标的情况下，恐怕我无法为您提供任何进一步的帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T19:39:05.167

如果你用破折号分解日期 - 很容易比较移动日期和 json 日期之间的日期。通过简单的比较逻辑，您将得到它。

```
String date = "2013-02-15";
String[] separated = date.split("-");
separated[0]; // this will contain "2013"
separated[1]; // this will contain "02"
separated[2]; // this will contain "15"

Calendar c1 = Calendar.getInstance(); 
String date =  c1.get(Calendar.DAY_OF_MONTH); 
```

日历（获取移动日期） [http://developer.android.com/reference/java/util/Calendar.html](http://developer.android.com/reference/java/util/Calendar.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-03T19:45:09.020

你也可以试试这个：

```
SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd");
boolean isBefore = new Date().before(sdf.parse("2013-02-15",0)); 
```

[http://developer.android.com/reference/java/text/SimpleDateFormat.html](http://developer.android.com/reference/java/text/SimpleDateFormat.html)

[http://developer.android.com/reference/java/util/Date.html](http://developer.android.com/reference/java/util/Date.html)*

# php - 将数组拆分为行

> ID：14145796
> 
> 赞同：0
> 
> 时间：2013-01-03T19:29:33.500
> 
> 标签：php, mysql, arrays, html-table, row

我有一个表，其中的值来自`dat_eb_registrants`行（例如`$row[1]`）和来自水平数组的值，从 中提取`dat_eb_field_values`，我想将它们拆分，以便我可以按照我想要的方式将所有内容排序到表中。

数据如何放入我的表中：

```
$count = 0;
while ($row = mysql_fetch_row($result))
{
echo "<tr>";
$myArray[] ="<tr><td>" . $row[9] . "</td><td>"; echo $myArray[$count];
$count++;
echo "</tr>"; 
} 
```

如何从数据库中提取所有数据（是的，我知道它很旧）：

```
SELECT dr.id, dr.first_name, dr.last_name, dr.email, dr.comment, dr.amount, dr.published, dr.transaction_id, dr.register_date, GROUP_CONCAT(df.field_value SEPARATOR '</td><td>') 
   FROM dat_eb_registrants dr 
   LEFT JOIN dat_eb_field_values df 
    ON dr.id=df.registrant_id
   WHERE `event_id` >= 20 AND `event_id` <= 25
   GROUP BY dr.id
   ORDER BY '".$sort."', '".$ascdsc."' 
```

现在，我想将第一个表（例如`$row[1]`）和（例如）中的一些行`$row[2]`垂直放在数组的中间。我怎样才能做到这一点？

因为数组一次性填满了我的表，并且使用`$rows`，您可以简单地告诉哪些行显示在哪里......

这就是我想要的（代码可能不正确）：

```
while ($row = mysql_fetch_row($result)) {
  echo "<tr>";
echo "<td>"'.$row_table_1[1]'"</td>";
echo "<td>"'.$row_table_1[2]'"</td>";
echo "<td>"'.$row_table_2[35]'"</td>";
echo "<td>"'.$row_table_2[45]'"</td>";
echo "<td>"'.$row_table_1[5]'"</td>";
echo "<td>"'.$row_table_2[6]'"</td>";
echo "</tr>";
} 
```

我曾经做：

```
echo "<td>"; $result24 = mysql_query("SELECT field_id, field_value FROM dat_eb_field_values WHERE (field_id = 88) AND (registrant_id = $row[0])"); $r24 = mysql_fetch_row($result24); echo $r24[1]; echo "</td>";
echo "<td>"; $result25 = mysql_query("SELECT field_id, field_value FROM dat_eb_field_values WHERE (field_id = 57) AND (registrant_id = $row[0])"); $r25 = mysql_fetch_row($result25); echo $r25[1]; echo "</td>";
echo "<td>" . $row[5] . "</td>";
echo "<td>" . $row[6] . "</td>"; 
```

我想要做：

```
echo "<td>" . $rowfromsecondtable[1] . "</td>";
echo "<td>" . $rowfromsecondtable[2] . "</td>";
echo "<td>" . $row[5] . "</td>";
echo "<td>" . $row[6] . "</td>"; 
```

（使用我上面给出的代码）

预览`dat_eb_registrants`：

```
 |   id   |   first_name   |   last_name   |   email               |
------------------------------------------------------------------------
    |    1   |      Mike      |     Doe       |   mikedoe@hotmail.com |
    |    2   |      John      |     Smith     |   j_smith@hotmail.com | 
```

预览`dat_eb_field_values`：

```
field 1 = fav.sport
field 2 = fav. color
field 3 = fav. food

    |   registrant_id   |   field_id  |   field_value    |
----------------------------------------------------------
    |    1              |      1      |     tennis       |
    |    1              |      2      |     green        |
    |    1              |      3      |     spagetti     |
    |    2              |      1      |     hockey       |
    |    2              |      2      |     red          |
    |    2              |      3      |     fish         | 
```

我需要：

```
first_name  |   id   |   fav.sport   |   last_name   |   fav.food   |
---------------------------------------------------------------------
Mike        |    1   |      Tennis   |     Doe       |   spagetti   |
John        |    2   |      Hockey   |     Smith     |   fish       | 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T19:50:30.123

这不能回答您的问题，但您可以使用表的列名作为行索引，而不是使用 $row[9]、$row[10] 等。

$row['first_name'] $row['last_name']

等等。它会让你的代码更具可读性。

您可能还想先获取所有数据，然后生成 html 代码。看起来会更干净。

例如

```
$result24 = mysql_query(sometihng here); 
$r24 = mysql_fetch_row($result24);

$result25 = mysql_query(sometihng else here); 
$r25 = mysql_fetch_row($result25);

//php code for table starts here 
echo '<table>'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T20:45:54.513

也许我遗漏了一些东西，但为什么不在 SQL 中执行此任务。这基本上是一个*支点*。MySQL 没有枢轴，但您可以将聚合函数与`CASE`语句一起使用：

```
select r.first_name,
  r.id,
  r.last_name,
  max(case when f.field_id =1 then f.field_value else null end) As FavSport,
  max(case when f.field_id =2 then f.field_value else null end) As FavColor,
  max(case when f.field_id =3 then f.field_value else null end) As FavFood
from dat_eb_registrants r
left join dat_eb_field_values f
  on r.id = f.registrant_id
group by r.first_name, r.id, r.last_name
order by r.id 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/e2b1c/2)

查询的结果是您想要的输出：

```
| FIRST_NAME | ID | LAST_NAME | FAVSPORT | FAVCOLOR |  FAVFOOD |
----------------------------------------------------------------
|       Mike |  1 |       Doe |   tennis |    green | spagetti |
|       John |  2 |     Smith |   hockey |      red |     fish | 
```

或者您可以在`dat_eb_field_values`表上使用多个连接：

```
select r.first_name,
  r.id,
  r.last_name,
  fSport.field_value FavSport,
  fColor.field_value FavColor,
  fFood.field_value FavFood
from dat_eb_registrants r
left join dat_eb_field_values fSport
  on r.id = fSport.registrant_id
  and fSport.field_id = 1
left join dat_eb_field_values fColor
  on r.id = fColor.registrant_id
  and fColor.field_id = 2
left join dat_eb_field_values fFood
  on r.id = fFood.registrant_id
  and fFood.field_id = 3
order by r.id 
```

请参阅[SQL Fiddle with Demo](http://sqlfiddle.com/#!2/e2b1c/3)。它产生相同的结果。

# php - 使用 phpunit 的自定义侦听器测试状态为空

> ID：14145798
> 
> 赞同：0
> 
> 时间：2013-01-03T19:29:36.490
> 
> 标签：php, phpunit

我正在为 phpunit 开发一个自定义测试侦听器，完成后我无法获得测试的状态。当我在测试完成后调用 getStatus() 时，我得到的是 null 而不是状态。我在一些测试中尝试过这一点，其中一个通过，一个不完整，一个失败，但 getStatus() 为所有测试返回 null。

我正在使用 PHPUnit 3.7.10 版

这是我的测试监听器代码：

```
class MyTestListener implements PHPUnit_Framework_TestListener
{
    protected $tests = array();

    public function addError(PHPUnit_Framework_Test $test, Exception $e, $time) {}
    public function addFailure(PHPUnit_Framework_Test $test, PHPUnit_Framework_AssertionFailedError $e, $time) {}
    public function addIncompleteTest(PHPUnit_Framework_Test $test, Exception $e, $time) {}
    public function addSkippedTest(PHPUnit_Framework_Test $test, Exception $e, $time) {}
    public function startTest(PHPUnit_Framework_Test $test) {}
    public function endTest(PHPUnit_Framework_Test $test, $time) {
        $this->tests[] = array('test'=>$test, 'time'=>$time);
            $status = $test->getStatus();
            //NOTE: $status is null
    }
    public function startTestSuite(PHPUnit_Framework_TestSuite $suite) {}
    public function endTestSuite(PHPUnit_Framework_TestSuite $suite) {}

    public function __destruct() {
        foreach($this->tests as $d) {
            $test = $d['test'];
            $time = $d['time'];

            $testClass = get_class($test);

            $status = $test->getStatus();
            //NOTE: $status is null here
            if($status == PHPUnit_Runner_BaseTestRunner::STATUS_FAILURE) {
                $status = "fail - ";
            } else if($status == PHPUnit_Runner_BaseTestRunner::STATUS_SKIPPED) {
                $status = "skip - ";
            } else if($status == PHPUnit_Runner_BaseTestRunner::STATUS_INCOMPLETE) {
                $status = "inc  - ";
            } else if($status == PHPUnit_Runner_BaseTestRunner::STATUS_ERROR) {
                $status = "err  - ";
            } else {
                $status = $status."ok  - ";
            }

            print $status.$testClass."::".$test->getName()."  ".round($time,1)." seconds\n";

        }
    }
} 
```

有人对我做错了什么有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T22:35:53.997

该接口`PHPUnit_Framework_Test`甚至没有`getStatus()`方法，因此您可能会遇到更多问题。更好地捕捉`add*()`方法中的结果。

看看`PHPUnit/TextUI/ResultPrinter.php`，它是这样做的。

# javascript - 使用 javascript 从 js 文件中解析 javascript 函数名称

> ID：14145809
> 
> 赞同：0
> 
> 时间：2013-01-03T19:30:23.450
> 
> 标签：javascript, jquery

> **可能重复：**
> [返回 Javascript 文件中定义的所有函数](https://stackoverflow.com/questions/11279441/return-all-of-the-functions-that-are-defined-in-a-javascript-file)

好的，所以我有一个 JS 文件，其中定义了许多 JavaScript 函数。有没有办法使用 JavaScript 解析该特定 JS 文件中所有函数的名称。任何指导或链接来实现这一点将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T20:06:48.840

If it's just for development purposes then use an IDE. The IDE will depend on your environment. For example, you might you IntelliJ if your server side code is Java or Visual Studio's if you are a .NET shop.

If you really need to use javascript to dynamically go through the list of functions I suggest rethinking why you need to do it. If it turns out usefull you could namespace your functions and then just iterate over the namespace functions. See this answer for how to namespace [https://stackoverflow.com/a/5947280/695461](https://stackoverflow.com/a/5947280/695461). Then iterate over the "public" functions.

Again, if it's just for development ease of use, use an IDE. They have whole teams of people writing parsers and syntax highlighters and structure diagrams for you.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T19:42:55.080

If you are not generating the js file dynamically, the easiest and safest option is to keep a hard-coded list of function names.

All other parsing methods are risky because

1.  String parsing of the code is not safe, since you will have to cater too many cases
2.  There are options to get all global functions. But they are browser dependent. like `looping through all window` objects for objects with `typeof window[x] === 'function'`

# c# - StackOverflowException 与 DataGridView

> ID：14145811
> 
> 赞同：7
> 
> 时间：2013-01-03T19:30:38.420
> 
> 标签：c#, datagridview, stack-overflow

这是一个奇怪的问题。我有一个`DataGridView`. 我正在使用我自己的自定义类`DataSource`的包含对象来设置它。`List`列表中大约有 50,000 个项目。我定义了我希望在设计器中可见的所有列并设置`AutoGenerateColumns`为 false。

一旦我将它设置`DataSource`到我的列表中，它就会立即正确填充。我可以上下滚动，选择不同的行。一切都是好的。但是，当我一直向下滚动，然后让包含`DataGridView`失去焦点的窗口时，一切都冻结了，不久之后堆栈溢出：

```
System.Drawing.dll!System.Drawing.SafeNativeMethods.Gdip.GdipDeleteGraphics(System.Runtime.InteropServices.HandleRef graphics) + 0x2a bytes 
    System.Drawing.dll!System.Drawing.Graphics.Dispose(bool disposing) + 0x56 bytes 
    System.Drawing.dll!System.Drawing.Graphics.Dispose() + 0x12 bytes   
    System.Drawing.dll!System.Drawing.Font.GetHeight() + 0xc8 bytes 
    System.Drawing.dll!System.Drawing.Font.Height.get() + 0xb bytes 
    System.Windows.Forms.dll!System.Windows.Forms.DataGridViewRow.DataGridViewRow() + 0x44 bytes    
    System.Windows.Forms.dll!System.Windows.Forms.DataGridViewRow.Clone() + 0x44 bytes  
    System.Windows.Forms.dll!System.Windows.Forms.DataGridViewRowCollection.this[int].get(int index) + 0xa8 bytes   
    System.Windows.Forms.dll!System.Windows.Forms.DataGridView.DataGridViewAccessibleObject.GetChild(int index) + 0xbd bytes    
    System.Windows.Forms.dll!System.Windows.Forms.DataGridViewRow.DataGridViewRowAccessibleObject.Bounds.get() + 0x76 bytes 
    System.Windows.Forms.dll!System.Windows.Forms.DataGridViewRow.DataGridViewRowAccessibleObject.Bounds.get() + 0x83 bytes 
    System.Windows.Forms.dll!System.Windows.Forms.DataGridViewRow.DataGridViewRowAccessibleObject.Bounds.get() + 0x83 bytes 
    System.Windows.Forms.dll!System.Windows.Forms.DataGridViewRow.DataGridViewRowAccessibleObject.Bounds.get() + 0x83 bytes 
    System.Windows.Forms.dll!System.Windows.Forms.DataGridViewRow.DataGridViewRowAccessibleObject.Bounds.get() + 0x83 bytes 
    System.Windows.Forms.dll!System.Windows.Forms.DataGridViewRow.DataGridViewRowAccessibleObject.Bounds.get() + 0x83 bytes 
    System.Windows.Forms.dll!System.Windows.Forms.DataGridViewRow.DataGridViewRowAccessibleObject.Bounds.get() + 0x83 bytes 
    System.Windows.Forms.dll!System.Windows.Forms.DataGridViewRow.DataGridViewRowAccessibleObject.Bounds.get() + 0x83 bytes 
    System.Windows.Forms.dll!System.Windows.Forms.DataGridViewRow.DataGridViewRowAccessibleObject.Bounds.get() + 0x83 bytes 
    System.Windows.Forms.dll!System.Windows.Forms.DataGridViewRow.DataGridViewRowAccessibleObject.Bounds.get() + 0x83 bytes 
    System.Windows.Forms.dll!System.Windows.Forms.DataGridViewRow.DataGridViewRowAccessibleObject.Bounds.get() + 0x83 bytes 
    System.Windows.Forms.dll!System.Windows.Forms.DataGridViewRow.DataGridViewRowAccessibleObject.Bounds.get() + 0x83 bytes 
    ... 
```

由于某种原因，该`DataGridViewRow.DataGridViewRowAccessibleObject.Bounds.get()`方法正在将自己称为遗忘。整个堆栈对我来说似乎很奇怪。为什么会`Font.Height.get()`打电话`DataGridViewRow`？

编辑：

我被要求提供一些代码。这是设计器`DataGridView`为其及其列生成的代码：

```
 // 
    // dataGridView
    // 
    this.dataGridView.AllowUserToAddRows = false;
    this.dataGridView.AllowUserToDeleteRows = false;
    this.dataGridView.AllowUserToOrderColumns = true;
    this.dataGridView.AllowUserToResizeRows = false;
    this.dataGridView.BackgroundColor = System.Drawing.SystemColors.Window;
    this.dataGridView.BorderStyle = System.Windows.Forms.BorderStyle.None;
    this.dataGridView.ColumnHeadersHeightSizeMode = System.Windows.Forms.DataGridViewColumnHeadersHeightSizeMode.AutoSize;
    this.dataGridView.Columns.AddRange(new System.Windows.Forms.DataGridViewColumn[] {
    this.Date,
    this.Type,
    this.Job,
    this.Mix,
    this.Entry});
    this.dataGridView.Location = new System.Drawing.Point(8, 96);
    this.dataGridView.Name = "dataGridView";
    this.dataGridView.ReadOnly = true;
    this.dataGridView.RowHeadersVisible = false;
    this.dataGridView.SelectionMode = System.Windows.Forms.DataGridViewSelectionMode.FullRowSelect;
    this.dataGridView.Size = new System.Drawing.Size(1152, 504);
    this.dataGridView.TabIndex = 10;
    this.dataGridView.SelectionChanged += new System.EventHandler(this.dataGridView_SelectionChanged);
    // 
    // Date
    // 
    this.Date.DataPropertyName = "FormattedTime";
    this.Date.HeaderText = "Date/Time";
    this.Date.Name = "Date";
    this.Date.ReadOnly = true;
    // 
    // Type
    // 
    this.Type.DataPropertyName = "FormattedType";
    this.Type.FillWeight = 60F;
    this.Type.HeaderText = "Type";
    this.Type.Name = "Type";
    this.Type.ReadOnly = true;
    this.Type.Width = 60;
    // 
    // Job
    // 
    this.Job.DataPropertyName = "Job";
    this.Job.FillWeight = 80F;
    this.Job.HeaderText = "Job No.";
    this.Job.Name = "Job";
    this.Job.ReadOnly = true;
    this.Job.Width = 80;
    // 
    // Mix
    // 
    this.Mix.DataPropertyName = "Mix";
    this.Mix.FillWeight = 80F;
    this.Mix.HeaderText = "Mix No.";
    this.Mix.Name = "Mix";
    this.Mix.ReadOnly = true;
    this.Mix.Width = 80;
    // 
    // Entry
    // 
    this.Entry.AutoSizeMode = System.Windows.Forms.DataGridViewAutoSizeColumnMode.Fill;
    this.Entry.DataPropertyName = "FormattedSummary";
    this.Entry.HeaderText = "Entry";
    this.Entry.Name = "Entry";
    this.Entry.ReadOnly = true; 
```

当需要填充网格视图时，我只需执行以下操作：

```
dataGridView.DataSource = myList; 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-05T20:56:10.013

# 使固定

目前尚无修复方法。

# 解决方法

从控制面板中的服务面板禁用***Tablet PC 输入服务(aka tabtip.exe)。***

# 细节

几周前，我就这个问题联系了 Microsoft 开发人员支持。我与 WinForms 团队的一位支持工程师通信，我们发现这个问题在某种程度上是由于Microsoft 的*Tablet PC Input Service (tabtip.exe)*运行时将*Accessibility.dll*加载到我的应用程序中引起的。此服务至少存在于所有 Windows 7 Enterprise 安装中，但通常仅当您有平板电脑或曾经在您的 PC 上安装过任何类型的笔输入设备时才会运行。我过去曾在我的 PC 上使用过 Wacom Bamboo 数位板，因此运行此服务是有道理的。*请注意，已确定我用来填充的方法**和我设置的任何属性都与该问题无关。***`DataGridView`**

 **Accessibility.dll*是一个 Microsoft 库，它允许某些外围设备（数位板，尤其是辅助设备）更轻松地交互并获取有关表单和包含在表单上的控件的额外信息。我对此不是 100% 确定的，但我相信如果安装了这样的外围设备，这个库会自动加载到每个正在运行的 Windows 进程中。

`DataGridView`在检查了我提供的转储后，Microsoft 工程师对决定关闭的代码路径感到困惑，并发现*Accessibility.dll*是让它发生的罪魁祸首。他承认`DataGridView`不应该这样做，而且这对他们来说似乎是一个问题。但是，即使在他的 PC 和新制作的 Windows 7 虚拟机上打开 Tablet PC 输入服务后，他也无法重现该问题。因此，尽管他能够确定导致我的 PC 出现问题的关键因素，但他无法找到根本原因，因此无法进一步追查。

这可能归因于我的特定数位板设备 (Wacom) 或其他东西。它的未知数。如果其他人遇到此问题，请与我联系。如果我能够缩小原因，工程师邀请我与他联系。目前，只需关闭服务即可防止出现问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-04T19:16:05.663

我在 DataGridView 中遇到了一个非常相似的 StackOverflowsException 场景。

条件：

1.  承载 datagridview 控件的 WinForm。DataGridView 属性 ReadOnly 和 VirtualMode 设置为 true。
2.  VirtualMode 的 OnCellValueNeeded 根据 MSFT 文档实现 ( [http://msdn.microsoft.com/en-us/library/2b177d6d.aspx](http://msdn.microsoft.com/en-us/library/2b177d6d.aspx) )
3.  加载大量数据（15 列 x 1 x 10^5 行）
4.  如果仅显示 10 列 X 30 行 [300 个单元格]，则 datagridview 的行为是正常的（即：GUI 的响应性、行和单元格选择、垂直和水平滚动）。当我最大化显示以使显示的单元格数量更大时，会触发 DataGridView 中的 StackOverflowsException。
5.  我也有一个连接到我的 PC 的 Wacom 平板电脑。
6.  如果我停止 Tablet PC 输入服务 (tabtip.exe)，问题就会消失

所以...在我的情况下，的确，弗兰克斯的解决方法是正确的方向，并支持这样的想法：1.平板电脑输入服务是罪魁祸首，2.屏幕中显示（活动）单元格的数量对触发异常。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-02-19T11:05:57.640

首先，感谢@Frank Weindel 指出了这个 WEIRD 问题（只有微软才能提出这个问题）。

对于那些不想禁用“Tabtip.exe”作为要求的一部分的人，假设您的应用程序用于平板电脑并且唯一可能的输入法是 Tabtip，有一种解决方法。

您可以在发生崩溃的事件中终止 Tabtip。对我来说，这是当我选择超过 60,000 行的项目时。这就是我所做的。

```
Private Sub DataGridView1_Scroll(sender As Object, e As ScrollEventArgs) Handles DataGridView1.Scroll
    Call closeKeyboard()
End Sub

'When a user have to type something in textbox'
Private Sub Lookup_Tbox_MouseDown(sender As Object, e As MouseEventArgs) Handles Lookup_Tbox.MouseDown 
    Call OpenKeyboard()
End Sub

Public Sub OpenKeyboard()
    System.Diagnostics.Process.Start("tabtip.exe")
End Sub

Public Sub closeKeyboard()

    Dim proc() As System.Diagnostics.Process = Process.GetProcessesByName("tabtip")
    For i As Integer = 0 To proc.Length - 1
        proc(i).Kill()
    Next i
End Sub 
```

希望它可以帮助某人:) 战斗愉快:)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-04T10:26:14.417

我不完全理解你的问题，但我认为你的问题是 datagridview 和内存的缓慢

我有一个解决方案： 1：将 datagridview 行分成页面，例如在 Datagridview 中仅显示最大 100 行，在按钮或其他控件中单击下一个百个单击它有助于减少您的视频内存 2：在 DataGridView 上启用双缓冲 3：使用 Suspendlayout 和恢复轻松绘制项目的布局功能

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-11-20T21:32:41.027

我有同样的问题 GridView 有 50K 记录。使用 ScrollBar 或简单地移动大量记录会导致 DataGridView 中的 StackOverflowsException。阅读完上述内容后，我只是停止了虚拟屏幕键盘（我的屏幕是触摸屏）服务描述“启用触摸键盘和手写面板笔和墨水功能”

一旦停止，GridView 就可以完美运行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-04-21T12:18:53.320

我遇到了问题中描述的确切问题，在阅读了这里和我自己的实验之后，这解决了我的问题：

```
private void dataGridView1_Scroll(object sender, ScrollEventArgs ex)
{
    try
    {
         dataGridView1.Focus();
    }
    catch (Exception ex)
    {
         MessageBox.Show(ex.Message);
    }
} 
```*

# php - 如何使用 php 日志配置 logrotate

> ID：14145812
> 
> 赞同：9
> 
> 时间：2013-01-03T19:30:39.290
> 
> 标签：php, linux, logrotate

我正在使用 APC 作为操作码和应用程​​序缓存运行 php5 FPM。像往常一样，我将 php 错误记录到文件中。

由于它变得相当大，我尝试配置 logrotate。它可以工作，但在轮换之后，php 继续记录到现有的日志文件，即使它被重命名。这导致 scripts.log 成为 0B 文件，并且 scripts.log.1 继续进一步增长。

我认为（还没有尝试过）在 postrotate 中运行 php5-fpm reload 可以解决这个问题，但这每次都会清除我的 APC 缓存。

有人知道如何使它正常工作吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-03T19:37:39.660

> 我发现 logrotate 的“copytruncate”选项确保 inode 不会改变。基本上是什么 [原文如此！] 正在寻找。

这可能是您正在寻找的。摘自：[logrotate 是如何工作的？-Linuxquestions.org](http://www.linuxquestions.org/questions/linux-software-2/how-does-logrotate-work-645229/)。

正如我在评论中所写，您需要防止 PHP 写入同一个（重命名的）文件。复制文件通常会创建一个新文件，并且截断也是该选项名称的一部分，所以我认为*copytruncate*选项是一个简单的解决方案（[来自手册页](http://linuxcommand.org/man_pages/logrotate8.html)）：

> ```
>  copytruncate
> 
>           Truncate  the  original log file in place after creating a copy,
>           instead of moving the old log file and optionally creating a new
>           one,  It  can be used when some program can not be told to close
>           its logfile and thus might continue writing (appending)  to  the
>           previous log file forever.  Note that there is a very small time
>           slice between copying the file and truncating it, so  some  log-
>           ging  data  might be lost.  When this option is used, the create
>           option will have no effect, as the old log file stays in  place. 
> ```

也可以看看：

*   [为什么我们应该一起使用 create 和 copytruncate？](https://unix.stackexchange.com/q/33447/9340)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-03-26T15:51:43.310

我在我的服务器上找到的另一个解决方案是告诉 php 重新打开日志。我觉得nginx也有这个功能，这让我觉得它一定是很常见的地方。这是我的配置：

```
/var/log/php5-fpm.log {
        rotate 12
        weekly
        missingok
        notifempty
        compress
        delaycompress
        postrotate
                invoke-rc.d php5-fpm reopen-logs > /dev/null
        endscript
} 
```

# java - 在 Java 中，我怎样才能只 HttpPost 协议缓冲区的内容？

> ID：14145814
> 
> 赞同：0
> 
> 时间：2013-01-03T19:30:42.873
> 
> 标签：java, protocol-buffers, apache-httpclient-4.x

我尝试使用 ByteArrayEntity，如下所示，但这会发送不在协议缓冲区本身中的额外字节。是否有仅发布内容的实体？

```
 byte [] info;

        ... [info initialized] ...

        HttpPost httppost = new HttpPost("https://myurl");
        ByteArrayEntity reqEntity = new ByteArrayEntity(info);

        reqEntity.setContentType("binary/octet-stream");
        reqEntity.setChunked(true);
        httppost.setEntity(reqEntity);

        // Execute HTTP Post Request
        HttpResponse response = httpclient.execute(httppost); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T22:48:15.653

答案平庸得令人失望：额外的字节是通过调用 setChunked(true) 添加的。删除调用只会发送“info”中的字节。

# php - PHP echo 添加新行

> ID：14145817
> 
> 赞同：2
> 
> 时间：2013-01-03T19:30:52.167
> 
> 标签：php, tags, line-breaks

有人可以解释一下为什么 PHP 标签给了我换行符吗？

而且，你怎么能删除它或阻止这种情况发生，因为它弄乱了我的网站。

我在我的网站上使用的一个例子：

```
<?php include('assets/common/theme_header.php'); ?> 
```

编辑：当我使用时，这似乎不会发生：

```
<?php ?> 
```

然而，它似乎只有在我使用 echo 时才会发生，我也在我的 include 中使用它。

例子：

```
<?php echo "hello"; ?> 
```

这仍然给了我一个“换行符”，它在 Chrome 开发工具包中显示如下： ![在此处输入图像描述](../Images/f7269671dc88f697c7e68dce5aafd2bb.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-03-06T02:58:54.530

我有类似的情况，服务器上的 php 文件总是回显一个空格，然后是换行符，然后是实际的回显。像“\n[someVariable]”。我通过确保 php 文件在文件的开头或结尾没有空行来摆脱它。

`<?php`所以在结尾之前或之后没有空行`?>`

也许你的问题是相关的。

# r - 复制行R的方法

> ID：14145819
> 
> 赞同：5
> 
> 时间：2013-01-03T19:30:56.880
> 
> 标签：r, copy, row

假设我们有一个数据框或矩阵，其中一列指定整数值 N，如下所示（第 5 列）。是否有一种矢量方法来重新填充对象，使得每一行都被复制 N 次？

```
> y
            [,1]       [,2]        [,3]        [,4] [,5]
[1,] -0.02738267  0.5170621 -0.01644855  0.48830663    1
[2,] -0.30076544  1.8136359  0.02319640 -1.59649330    2
[3,]  1.73447245  0.4043638 -0.29112385 -0.25102988    3
[4,]  0.01025271 -0.4908636  0.80857300  0.08137033    4 
```

结果如下。

```
[1,] -0.02738267  0.5170621 -0.01644855  0.48830663    1
[2,] -0.30076544  1.8136359  0.02319640 -1.59649330    2    
[2,] -0.30076544  1.8136359  0.02319640 -1.59649330    2
[3,]  1.73447245  0.4043638 -0.29112385 -0.25102988    3
[3,]  1.73447245  0.4043638 -0.29112385 -0.25102988    3
[3,]  1.73447245  0.4043638 -0.29112385 -0.25102988    3
[4,]  0.01025271 -0.4908636  0.80857300  0.08137033    4
[4,]  0.01025271 -0.4908636  0.80857300  0.08137033    4
[4,]  0.01025271 -0.4908636  0.80857300  0.08137033    4
[4,]  0.01025271 -0.4908636  0.80857300  0.08137033    4 
```

另一个问题是如何抖动新填充的行，使得新复制的数据不存在计算重叠。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-03T19:38:43.880

一些虚构的数据：

```
y <- cbind(matrix(runif(16), 4, 4), 1:4) 
```

做就是了：

```
z <- y[rep(seq_len(nrow(y)), y[,5]), ]
#            [,1]       [,2]       [,3]      [,4] [,5]
#  [1,] 0.5256007 0.07467979 0.95189484 0.2887943    1
#  [2,] 0.3083967 0.03518523 0.08380005 0.9168161    2
#  [3,] 0.3083967 0.03518523 0.08380005 0.9168161    2
#  [4,] 0.8549639 0.79452728 0.22483537 0.4452553    3
#  [5,] 0.8549639 0.79452728 0.22483537 0.4452553    3
#  [6,] 0.8549639 0.79452728 0.22483537 0.4452553    3
#  [7,] 0.5453508 0.47633523 0.51522514 0.3936340    4
#  [8,] 0.5453508 0.47633523 0.51522514 0.3936340    4
#  [9,] 0.5453508 0.47633523 0.51522514 0.3936340    4
# [10,] 0.5453508 0.47633523 0.51522514 0.3936340    4 
```

而且我不确定您所说的“抖动”是什么意思，但也许

```
z <- z + runif(z) / 1000 
```

?

# php - 为什么我的打印数组末尾有一个 1？

> ID：14145821
> 
> 赞同：4
> 
> 时间：2013-01-03T19:30:56.940
> 
> 标签：php, arrays, printing

这是一个超级简单的数组打印，但是当我使用 print_r 时，我会走到最后。

```
<?php 
  $user_names = array(1, 2, 3, 4);
  $results = print_r($user_names);
  echo $results;
?> 
```

然后我得到：

```
 Array
 (
     [0] => 1
     [1] => 2
     [2] => 3
     [3] => 4
 )
 1 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-03T19:32:40.773

[`print_r`](http://php.net/print_r)已经打印了数组 - 不需要`echo`它的返回值（`true`因此将`1`在转换为字符串时结束）：

> 当返回参数为 TRUE 时，该函数将返回一个字符串。否则，返回值为 TRUE。

以下也可以正常工作：

```
$results = print_r($user_names, true);
echo $results; 
```

除非您并不*总是*在获得结果后立即显示结果，否则这根本没有意义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T19:31:56.320

你得到它是因为

```
echo $results; 
```

由于**$results**包含[print_r](http://us3.php.net/print_r)函数的结果，即 TRUE (1)

print_r 可以返回字符串而不是回显它。为此，您必须传递第二个参数 - true：

```
$results = print_r($user_names, true); 
```

所以，你有两个选择。删除 echo $results 或保留它，但将第二个参数传递给 print_r。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-03T19:34:08.080

`print_r`在屏幕上打印结果，如果您需要返回一个字符串而不是打印，您应该将第二个参数传递给函数：

```
<?php 
$user_names = array(1, 2, 3, 4);
$results = print_r($user_names, true);
echo $results; 
```

更多信息： http: [//php.net/manual/en/function.print-r.php](http://php.net/manual/en/function.print-r.php)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-03T19:34:12.143

`print_r` 实际打印出结果，如果您希望它返回结果，请使用`print_r($user_name, true)'`

所以这些中的任何一个都会做你想要的。

```
<?php 
  $user_names = array(1, 2, 3, 4);
  print_r($user_names);
 ?> 
```

或者

```
 <?php 
   $user_names = array(1, 2, 3, 4);
   $results = print_r($user_names,true);
    echo $results;
   ?> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-03T19:37:05.813

由于您`print_r`没有提供第二个参数，它会自行打印并返回 1。然后您保存并打印它。尝试：

```
$results = print_r($user_names, true); 
```

查看[print_r](http://php.net/manual/en/function.print-r.php)的文档：

> 如果您想捕获 的输出`print_r()`，请使用 return 参数。当此参数设置为 TRUE 时，print_r() 将返回信息而不是打印它。

# iphone - GameKit 多线程发送可能吗？

> ID：14145822
> 
> 赞同：0
> 
> 时间：2013-01-03T19:31:12.117
> 
> 标签：iphone, ios, grand-central-dispatch, gamekit, gksession

我正在开发一个可以向用户发送文件和操作的应用程序。用户可以随时从服务器请求文件（客户端服务器模型）。有时文件可能相当大（例如 10 mb），在发送时可能会延迟其他小动作发送给连接的用户。似乎 Gamekit 有一个用于发送的线程和一个用于接收的单独线程。

我想知道是否可以有一个额外的发送线程来确保较小的操作数据包不必等待发送大文件。我试图创建一个具有盛大中央调度的队列，但不幸的是，发送似乎仍然只使用一个线程。

```
dispatch_async(pdfSendQ, ^{

    NSString *filePath = [_document.fileURL path] ;

    if (!_pdfNSData)
        _pdfNSData = [NSData dataWithContentsOfFile:filePath];

    for(NSData* packet in self.packets) {
        NSError* error = nil;
        [_session sendData:packet toPeers:[NSArray arrayWithObject:peerID] withDataMode:GKSendDataReliable error:&error];
        if(error != nil) {
            [[NSNotificationCenter defaultCenter] postNotificationName:kPacketFailedNotification object:self userInfo:[NSDictionary dictionaryWithObject:error forKey:@"error"]];
        } else {
            [[NSNotificationCenter defaultCenter] postNotificationName:kPacketSentNotification object:self];
        }
    }
    [[NSNotificationCenter defaultCenter] postNotificationName:kFileSentNotification object:self];

}); 
```

我想有可能让单独的较小的动作数据包“中断”大文件的发送，但这会相当复杂，我想知道是否有更简单的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-13T20:52:52.277

GKSession 在它自己的线程上完成所有实际的网络连接。查看 lldb / Xcode 了解更多详细信息。如果要分块发送 10MB，只需发送数据即可。GKSession 将为您排入队列并尽可能在后台线程上发送。换句话说，不用担心饿死主线程，直接写数据就行了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T19:36:38.727

老实说我没有使用GameKit的经验，但最终它必须是一个流套接字，对吧？与其尝试使用 10mb 文件发送一个巨大的数据包，不如以更小的 100kb 块发送它。这样，您可以等待它完成并将您提到的不同类型的数据包（较小的动作数据包）排队，而不是中断中间块。另一方面，只需将大文件的各个部分附加在一起，但如果你得到其他东西，你将能够处理它。这样你会得到更快的响应

# c# - 更新项目中的布尔值以在网站上批准它们 - 多个项目

> ID：14145827
> 
> 赞同：0
> 
> 时间：2013-01-03T19:31:19.300
> 
> 标签：c#, asp.net, asp.net-mvc, asp.net-mvc-4, http-post

我已经从数据库中创建了一个项目列表。这些显示正确。现在我想将更改后的布尔值保存到我的数据库中。我怎样才能将所有这些项目接收到我的控制器，以便我可以通过 foreach 或其他方式遍历它们？

## 控制器

```
public class ItemController : Controller
{
    private SocialGEOContext db = new SocialGEOContext();
    public ActionResult ApproveItems()
    {
        Utility ut = new Utility();
        IEnumerable<Item> items;
        items = ut.GetAllDistrictItems();
        return View(items);
    }

    [HttpPost]
    public ActionResult ApproveItems( ??? )
    {
        ???
    } 
```

在我试过的 HttpPost

```
 [HttpPost]
    public ActionResult ApproveItems( IEnumerable<Item> ViewItems )
    {
        foreach (Item item in ViewItems)
        {
            var testje = item.ItemTitle;
        }
        return View();
    } 
```

但是 ViewItems 是空的

## 页

```
@model IEnumerable<LibModels.Item> 
@{
    ViewBag.Title = "ItemsByDistrict";
}

<h2>All items from district</h2>

@using (Html.BeginForm()) {
  @Html.ValidationSummary(true)
    <fieldset>
        <table>
        @foreach (var item in Model) {
            <tr>
                <td>
                    @Html.DisplayFor(modelItem => item.ItemID)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.ItemTitle)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.ItemCreateddate)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.ItemDescription)
                </td>
                <td>
                    @Html.EditorFor(modelItem => item.ItemApproved)
                </td>
            </tr>
        }
        </table>

        <p>
            <input type="submit" value="Edit" />
        </p>
    </fieldset>
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T19:36:16.053

您的页面仅包含一个编辑器，`item.ItemApproved`但在您尝试获取的 post 方法中`item.ItemTitle`。尝试将控制器 post 方法更改为：

```
foreach (Item item in ViewItems) {
   var testje = item.ItemApproved;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T19:49:11.260

您需要使用 for 循环才能使模型绑定起作用

```
@for(int i; i < Model.Count; i++) {
            <tr>
                <td>
                    @Html.DisplayFor(modelItem => modelItem[i].ItemID)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => modelItem[i].ItemTitle)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => modelItem[i].ItemCreateddate)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => modelItem[i].ItemDescription)
                </td>
                <td>
                    @Html.EditorFor(modelItem => modelItem[i].ItemApproved)
                </td>
            </tr>
        } 
```

有关模型绑定集合的详细信息，请参阅[本文](http://haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx)

注意：您需要调用`ToList()`模型以便使用索引

换句话说，在您的操作方法中：

```
public ActionResult ApproveItems()
    {
        Utility ut = new Utility();
        IEnumerable<Item> items;
        items = ut.GetAllDistrictItems();
        return View(items.ToList());
    } 
```

然后在视图中更改模型：

```
@model IList<LibModels.Item> 
```

# python - 将颠覆路径转换为可步行目录

> ID：14145828
> 
> 赞同：0
> 
> 时间：2013-01-03T19:31:21.430
> 
> 标签：python

我有一个颠覆性回购，即“http://crsvn/trunk/foo”...我想走这个目录或者对于初学者来说只是一个目录列表。

这个想法是创建一个脚本，它将对“http://crsvn/branches/bar”中的所有分支进行合并信息，并将它们与主干进行比较，以查看分支是否已合并。

所以我遇到的第一个问题是我不能走路或做

```
os.listdir('http://crsvn/branches/bar') 
```

我得到值标签语法不正确（提到 URL）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T22:29:38.583

您可以使用[PySVN](http://pysvn.tigris.org/docs/pysvn.html)。特别是，[pysvn.Client.list](http://pysvn.tigris.org/docs/pysvn_prog_ref.html#pysvn_client_list)方法应该做你想做的事：

```
import pysvn
svncl = pysvn.Client()
entries = svncl.list("http://rabbitvcs.googlecode.com/svn/trunk/")
# Gives you a list of directories:
dirs = (entry[0].repos_path for entry in entries if entry[0].kind == pysvn.node_kind.dir)
list(dirs) 
```

无需结帐。您甚至可以指定要处理的修订，以确保您的脚本在运行时可以忽略在存储库上工作的其他人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T19:34:29.863

[`listdir`](http://docs.python.org/2/library/os.html#os.listdir)采用路径而不是 url。如果 python 可以知道远程服务器上的结构，那就太好了，但我认为情况并非如此。

如果您要先在本地签出您的存储库，您可以使用 pythons 函数轻松遍历目录。

# .net - 为什么我在带有和不带有 SP1 的 Windows 7 的 WPF 中获得不同的线程行为？

> ID：14145829
> 
> 赞同：2
> 
> 时间：2013-01-03T19:31:32.807
> 
> 标签：.net, multithreading, windows-7, dispatcher, service-pack

我有这个多线程 WPF 应用程序和两台不同的机器，我正在测试它。

第一个是 VMware 客户端上的 Windows 7 Professional SP1 虚拟机。第二个是Win 7 Professional 物理机。没有 SP1。

在第一台机器上，应用程序正常运行，在第二台机器上，应用程序在调用时输出 AccessViolation 异常：

```
App.Current.Dispatcher.Invoke(() => { do stuff }); 
```

来自以下列方式创建的线程：

```
ThreadPool.QueueUserWorkItem( /* callback that calls the dispatcher */ ); 
```

如果 .Net 框架版本相同，你能告诉我为什么会有不同的行为吗？是因为Service Pack吗？我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T16:10:01.743

显然我正在使用 HookManager 并且在启动第二个之前没有关闭一个......为什么它在虚拟机而不是物理机上工作是我无法理解的......

# php - SetCookie 不适用于 Windows Phone 上的特定 cookie

> ID：14145836
> 
> 赞同：0
> 
> 时间：2013-01-03T19:32:01.730
> 
> 标签：php, ipad, windows-phone-7, cookies, setcookie

我有一个需要登录的网站。登录由分配给目标设备（以及其他一些设备）的身份验证令牌管理，但由于某种原因，它无法在 Windows Phone 上运行。我已经在 iPhone 和所有桌面浏览器上对其进行了测试，并且它适用于所有这些浏览器。

我将其设置为向我显示设置的 cookie，并且它显示已设置的所有其他 cookie，但身份验证令牌 cookie 除外。

我尝试更改 cookie 名称（以查看是否与正在运行的一些冗余代码发生冲突），但这不起作用（仍在桌面浏览器上工作）。

我放置了一段代码来检测 setcookie 函数调用，它告诉我它被正确调用。在登录和 setcookie 的相同代码路径中，我也做了 $_COOKIE 的 var_dump，它显示令牌已被临时发送。

该代码确实包含检测移动浏览器的能力，但它未被使用（在模板引擎的几个小部分之外）。

关于代码的另一个注意事项是，从开始到结束，输出缓冲区都是启用的，并且只在代码末尾打印。

我还能做些什么来尝试找出问题的原因，或者是什么可能导致专门针对 Windows Phone 的问题。

**编辑**

我刚刚在 iPad 上测试了它，它也无法正常工作。非常奇怪，因为它适用于普通 iPhone 和 Safari 浏览器。

**编辑**

我已经在运行站点（具有相同数据库）的 LAN 上的计算机上安装了服务器（AMPPS），并且登录功能正常工作。

另外，在我的测试过程中，在手机上（在现场版上），用户被重定向到用户专用页面，但没有检测到 cookie，用户被返回到登录页面。其他 cookie 是，但身份验证令牌不是。

所有 cookie 都以相同的方式设置，time() + 3600 到期，路径设置为 '/'

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T12:10:02.880

我想我已经解决了。该代码包括对令牌的一些 IP 验证，但由于某种原因，在这些设备上，IP（从 中返回`$_SERVER['REMOTE_ADDR']`）是`127.255.255.255`，这是不正确的。不知道为什么要这样做，但是我已经对其进行了修改，以便不考虑无效 ip（例如 127.255.255.255）的 IP，并且它现在正在工作。

# jquery - 过滤 div 中的 jquery-isotope 过滤链接（类似标签系统）

> ID：14145837
> 
> 赞同：0
> 
> 时间：2013-01-03T19:32:09.517
> 
> 标签：jquery, triggers, filtering, jquery-isotope

我问第一个问题是因为我对下面的代码很感兴趣。

基本上：我想通过根据特定内容过滤它们来切换 div 的可见性。每个 div 包含几个“标签”。单击“标签”时，只会显示包含相同“标签”的 div。看起来很简单的说。

但我在同位素 div 容器中运行。更重要的是，没有外部标签菜单，所以触发器就在要切换的 div 内。

我面临 2 条路径： 1\. 使用 Gatsby 的附加同位素插件：IsoSelective，它是这样的：

```
$container.isoSelective({
    linkSelector: '.filter',    // this is the filter link 
    attrSelector: 'rel',           // the attribute containing the filter
    activeClass: 'selected'        // class to add to selected
}); 
```

但是，如果我的触发器在目标内，我似乎并不高兴。

1.  我在现有的 JSFiddle 代码上做的一个分支，它工作得很好，但直到现在还不能在同位素内运行：

    [http://jsfiddle.net/gVpqx/3/](http://jsfiddle.net/gVpqx/3/)

————</p>

最后，这是我在 html 页面中的代码摘录：

```
<div class="articlesBlock">
<div class="blockBox">
<a href="#"><p>Lorem ipsum paragraph.</p></a>   
<em><a class='filter base-first-tag' rel='.first-tag' href='#'>The Base First Tag</a></em>
<em><a class='filter second-tag' rel='.second-tag' href='#'>The Second Tag</a></em>
<em><a class='filter third-tag' rel='.third-tag' href='#'> The Third Tag</a></em>
</div>  
</div>

<div class="articlesBlock">
<div class="blockBox">
<a href="#"><p>Lorem ipsum paragraph.</p></a>   
<em><a class='filter base-first-tag' rel='.base-first-tag' href='#'>The First also Base Tag</a</em>
<em><a class='filter second-tag' rel='.second-tag' href='#'>The Second Tag</a></em>
<em><a class='filter third-tag' rel='.third-tag' href='#'> The Third Tag</a></em>
</div>  
</div>

<div class="articlesBlock">
<div class="blockBox">
<a href="#"><p>Lorem ipsum paragraph.</p></a>   
<em><a class='filter first-tag' rel='.first-tag' href='#'>The First Tag</a></em>
<em><a class='filter second-new-tag' rel='.second-new-tag' href='#'>The New Second Tag</a></em>
<em><a class='filter third-tag' rel='.third-tag' href='#'> The Third Tag</a></em>
</div>  
</div> 
```

**下面是采用 IsoSelective 方法的 JSFiddle，但仍然无法正常工作。**

[http://jsfiddle.net/48nh6/1/](http://jsfiddle.net/48nh6/1/)

你怎么看 ？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-04T16:15:31.247

所以这就是发生的事情：isoSelective 充当切换。单个过滤器可以组合打开/关闭 - 不仅仅是一个过滤器打开一个过滤器关闭一个过滤器。不确定这是否是您想要的，但这是一个示例。我将 active ( `selected`) 类加粗以进行演示。

[http://jsfiddle.net/48nh6/4/](http://jsfiddle.net/48nh6/4/) 请注意，在这个版本中，我将标记类移动到容器中——而不是锚本身。由于您要显示/隐藏（过滤）块而不是链接，因此需要将标记类移至顶层。

1.  使用顶部导航过滤器（不在同位素列表中）单击全部。请注意，它“关闭”并且所有元素都被隐藏。
2.  单击第一个标记。请注意，它变为粗体。
3.  单击第三个旧标记。请注意，它也是粗体；第一个标签保持粗体。现在您会看到两个项目——一个是 Old First，另一个是 Third Old。

现在。您可以使用同位素内部的标签重复相同的练习。1\. 确保在顶部导航中切换“全部” 2\. 单击第一个框中的第三个标签。请注意只有两个活动项目 3\. 单击第一个框中的 The Base First Class。注意所有三个现在都出现了。

另请注意，标签仅在第一个框中“活动”。如果您单击框 2 中的“第一个也是基类”，它会切换“活动”，但由于第一个，它已经处于活动状态！所以什么都没有改变（除了文本变成粗体）。

我提供两种选择：

1.  如果您想要像等选择性这样的包容性（taht 是切换而不是排他过滤器），那么您将等选择连接到顶级过滤器并在单击内部过滤器时“假点击”它。
2.  如果您不想要像等选择性这样的包容性，那么请自己制作解决方案。

选项 1：http: [//jsfiddle.net/gy8Xf/1/](http://jsfiddle.net/gy8Xf/1/)

```
$container.isoSelective({
    linkSelector: '#filters .filter',
    attrSelector: 'rel',
    activeClass: 'selected'
}); 
```

仅在#filters .filter 上选择，然后...

```
$container.find('a').click(function()
                           {
                               var rel = $(this).attr('rel');

                               // get all the #filters .filter elements that have the same rel
                               var $filters = $('#filters .filter').filter(function()
                                                            {
                                                                return $(this).attr('rel') == rel;
                                                            });

                                // trigger a click
                               $filters.click();

                           }); 
```

每当在容器内单击链接时，找到与刚刚单击的链接`#filters .filter`具有相同属性的 ，并触发.`rel``click`

选项 2：http: [//jsfiddle.net/9ThvU/1/](http://jsfiddle.net/9ThvU/1/)

```
$('#filters .filter, #content .filter').click(function()
                           {
                               var rel = $(this).attr('rel');

                               $container.isotope( {filter: rel});
                           }); 
```

简单地说，只要单击锚点（我保留了#filters，不确定是否需要它们），就可以根据`rel`属性设置新的同位素过滤器。

# nservicebus - NServiceBus - 将每个程序集中的每个类分配给来自发件人的端点

> ID：14145838
> 
> 赞同：0
> 
> 时间：2013-01-03T19:32:09.730
> 
> 标签：nservicebus

在发送 Web 应用程序中，NServiceBus 正在扫描并将每种类型分配给端点。这大约需要三分钟，然后超时交易。我尝试过 configure.with(assemblies) 来限制扫描程序集，并且我尝试过“约定优于配置”不显眼的 configure.definingas 方法来限制消息实现。我们正在从旧版本迁移到最新版本，因此我们仍在使用 IMessage 实现约定。

这是我在发件人中的 bus.start 代码

我正在研究烟雾……我非常感谢一些帮助。

```
//hack for the moment
string dir = System.Web.HttpContext.Current.Server.MapPath("/");
dir = Path.Combine(dir, "bin");
TraceDirect("Shared", System.Diagnostics.TraceEventType.Information, dir);
System.Reflection.Assembly[] asss = { System.Reflection.Assembly.LoadFile(Path.Combine(dir, "myfirst.dll")), System.Reflection.Assembly.LoadFile(Path.Combine(dir, "mysecond.dll")) };

try
{

    using (TransactionScope ambient = new TransactionScope( TransactionScopeOption.Suppress))
                    {
                        theMagicBus = NServiceBus.Configure.With(asss)
                        .DefineEndpointName("app")
                        .DefiningMessagesAs(t => typeof(IMessage).IsAssignableFrom(t))
                        .DefiningCommandsAs(t => typeof(ICommand).IsAssignableFrom(t))
                        .DefiningEventsAs(t => typeof(IEvent).IsAssignableFrom(t))
                        .DefaultBuilder()
                        .XmlSerializer()
                        .MsmqTransport().TransactionTimeout(TimeSpan.FromMinutes(5))
                        .IsTransactional(true)
                        .PurgeOnStartup(false)
                        .UnicastBus()
                        .ImpersonateSender(false)
                        .Log4Net<NServiceBusAppender>(a => { a.Name = "Shared"; })
                        .CreateBus()
                        .Start(() => Configure.Instance.ForInstallationOn<NServiceBus.Installation.Environments.Windows>().Install());}} 
```

这是我的配置

```
<MsmqTransportConfig NumberOfWorkerThreads="1" MaxRetries="5"  />
  <MessageForwardingInCaseOfFaultConfig ErrorQueue="error"/>
  <UnicastBusConfig>
        <MessageEndpointMappings>
            <add Messages="myfirst" Endpoint="endpoint"/>
                <add Messages="mysecond" Endpoint="msgsvcpubinputqueue"/>
         </MessageEndpointMappings>
  </UnicastBusConfig>
</MsmqTransportConfig> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T06:03:10.397

从您的代码示例中，总线初始化代码的位置并不完全清楚，但在我*看来*，您正在对 Web 服务中的每个请求进行初始化总线。请不要那样做！;)

NServiceBus 旨在在应用程序启动时初始化*一次*，然后再开始执行任何工作。然后它会很高兴地将自己填充到您选择的 IoC 容器中，或者只是让您`IBus`在应用程序生命周期内将结果保留在自己周围。

# gcc - ld 终止在 Windows 上使用 MinGW 编译 wxmsw28_core_gcc_custom.dll

> ID：14145841
> 
> 赞同：0
> 
> 时间：2013-01-03T19:32:21.810
> 
> 标签：gcc, linker, mingw, mingw32

我正忙着用 MinGW 在 Windows 7 32 位上编译 wxWindows。

然而，这个过程并没有结束；ld 在尝试编译后终止`wxmsw28_core_gcc_custom.dll`。我现在正忙着看我的系统，而 ld 在消耗了 1.95 GB 私有内存后又停止了工作，并且它正在使用一个处理器的大部分。

有什么想法可能是错的吗？

我只是遵循了MinGW shell`./configure`的过程`make`。

我从哪里开始寻找？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T10:13:23.940

`../configre`在使用and`make`选项编译失败后，我按照此处给出的说明进行操作： [http](http://wiki.wxwidgets.org/Compiling_wxWidgets_with_MinGW) ://wiki.wxwidgets.org/Compiling_wxWidgets_with_MinGW并改为使用

```
mingw32-make -f makefile.gcc SHARED=1 UNICODE=1 BUILD=release 
```

这次它编译好了。现在我的 DLL 在`lib\gcc_dll`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T19:41:49.267

Try to increase the swap file size. What happens when you call `make` command again? Have you tried to use some newer version of MinGW or this happens with the latest one?

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T00:44:10.010

这也发生在我身上。编译总是在 1.9 GB 时中断。

唯一对我有帮助的是关闭单体应用。在 config.gcc

```
# Multiple libraries or single huge monolithic one? [0,1]
MONOLITHIC = 0

# Build GUI libraries? [0,1]
USE_GUI = 1 
```

现在在 wxWidgets\lib\gcc_dll 我有 15 个 Dll。

希望有帮助;-)

编辑：

我假设在您的 config.gcc “shared = 1”中。

我认为最好在 config.gcc 中进行所有设置。提示设置也 RUNTIME_LIBS = 动态。

搜索以下设置并将其替换为

```
# What type of library to build? [0,1]
SHARED = 1

# Compile Unicode build of wxWidgets? [0,1]
UNICODE = 1

# Type of compiled binaries [debug,release]
BUILD = release

# Multiple libraries or single huge monolithic one? [0,1]
MONOLITHIC = 0

RUNTIME_LIBS = dynamic 
```

# javascript - Mootools ajax 调用删除包含空数组的数据

> ID：14145843
> 
> 赞同：1
> 
> 时间：2013-01-03T19:32:29.493
> 
> 标签：javascript, ajax, mootools, http-post

在我的 ajax 调用的数据对象中，我有这样的东西：

```
data: {
    someVariable: []
} 
```

当我开始 ajax 调用时，我可以在`someVariable`未发送的 POST 数据中看到。

1.  这是一个 mootools 问题，还是 JS 范围内的问题？
2.  我怎样才能故意发送一个空数组？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T20:43:42.343

I don't think you can send an empty array through an ajax call. You will need to come up with your own solution such as passing in array with an empty string[''] and handling that special case on the server side.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T20:32:52.210

在查看 jquery 错误跟踪器中报告的错误时，他们说如下：

> 问题是没有办法以在 x-www-form-urlencoded 格式中有意义的方式序列化一个空数组。foo[bar]= 可能表示空数组、空字符串、空对象或空/未定义值，具体取决于后端选择如何解释它。由于两种序列化方式都不是真正“正确”的，并且大多数后端将其解释为“空字符串”，并且这以非常糟糕的方式打破了传统模式（根据论坛线程），我将其标记为阻止 1.6 所以它可以恢复到旧的行为。

[http://bugs.jquery.com/ticket/6481#comment:12](http://bugs.jquery.com/ticket/6481#comment:12)

所以，

1.  这是javascript的限制

2.  不。你可以做的是为一个空数组创建一个占位符，它用引号括起来，就像`'[]'`在服务器端，你可以将它解释为一个新的空数组。

# eclipse - Eclipse 调试器不显示调用堆栈

> ID：14145844
> 
> 赞同：3
> 
> 时间：2013-01-03T19:32:30.967
> 
> 标签：eclipse, debugging, callstack

Eclipse 调试器怎么可能不显示调用堆栈？我有一个断点，当它停在上面时，堆栈中只有那个函数，无法看到是谁调用了它。

我有

`Default suspend policy for new breakpoints`=`Suspend VM`

和

`Show monitors`=`ON`

Eclipse 是 Helios SR2

# hadoop - org.apache.hadoop.hbase.NotServingRegionException: Region is not online: -ROOT-,,0 这个错误背后的原因是什么

> ID：14145846
> 
> 赞同：4
> 
> 时间：2013-01-03T19:32:39.073
> 
> 标签：hadoop, hbase

感谢您对我的问题感兴趣:) 当我为 hbase shell 中的任何表触发扫描、放置、创建等查询时，都会出现以下错误。并且 hbase shell 给出了表的结果列表和表的描述....所以请您帮我清除一下吗？还有你能告诉我结构**-ROOT-,,0的含义吗**

关于正在使用的版本

**HBase 0.92.1-cdh4.1.2 Hadoop 2.0.0-cdh4.1.2**

***错误：org.apache.hadoop.hbase.NotServingRegionException：org.apache.hadoop.hbase.NotServingRegionException：区域不在线：-ROOT-,,0***

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-07-18T16:32:55.797

我有同样的错误。Zookeeper 由 HBase 处理。（它不是独立的！）

所以一个快速的解决方法是：

```
$ hbase zkcli
zookeeper_cli> rmr /hbase/root-region-server 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T09:11:12.050

通过清除 zookeeper 节点，hbase 开始正常工作:) 我到底遵循的是（不建议这样做，您应该先关闭 HBase 和 ZK）：

```
### shut down ZM and HBase 
1) for each ZK node:
su                          // login as root

cd $ZOOKEEPER_HOME       

cp data/myid myid           // backup existing myid file to ZooKeeper's home folder

rm data/* -Rf

rm dadalog/* -Rf

mkdir -p data

mkdir -p datalog

cp myid data/myid           // restore the myid backup so no need to recreate myid again

2) for each ZK node:
(start ZK )

3) finally 
(start HBase) 
```

通过清除数据和数据日志，您应该拥有一个非常干净的 ZooKeeper。希望这些帮助和好运。谢谢

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-04-01T16:29:14.873

```
My Error was ERROR: org.apache.hadoop.hbase.NotServingRegionException: Region ROLE,,1457743249518.221f6f7fdacacbe179674267f8d06575\. is not online on ddtmwutelc3ml01.azure-dev.us164.corpintra.net,16020,1459486618702
    at org.apache.hadoop.hbase.regionserver.HRegionServer.getRegionByEncodedName(HRegionServer.java:2898)
    at org.apache.hadoop.hbase.regionserver.RSRpcServices.getRegion(RSRpcServices.java:947)
    at org.apache.hadoop.hbase.regionserver.RSRpcServices.scan(RSRpcServices.java:2235)
    at org.apache.hadoop.hbase.protobuf.generated.ClientProtos$ClientService$2.callBlockingMethod(ClientProtos.java:32205)
    at org.apache.hadoop.hbase.ipc.RpcServer.call(RpcServer.java:2114)
    at org.apache.hadoop.hbase.ipc.CallRunner.run(CallRunner.java:101)
    at org.apache.hadoop.hbase.ipc.RpcExecutor.consumerLoop(RpcExecutor.java:130)
    at org.apache.hadoop.hbase.ipc.RpcExecutor$1.run(RpcExecutor.java:107)
    at java.lang.Thread.run(Thread.java:745) 
```

**分辨率为：**

运行以下命令

```
$ hbase zkcli
zookeeper_cli> rmr /hbase/root-region-server 
```

然后

从 cd /hadoop/zookeeper 中停止 hbase 和 zk
备份 mydir
删除cd /hadoop/zookeeper 中的所有内容
重新启动 zookeeper 然后 hbase

# r - 按组和列的加权平均值

> ID：14145859
> 
> 赞同：5
> 
> 时间：2013-01-03T19:33:26.357
> 
> 标签：r, for-loop, apply, sapply

我希望为几个（实际上是大约 60 个）列中的每一个按组获得加权平均值。这个问题非常类似于：在刚刚询问[的数据框中重复应用 ave 计算组均值。](https://stackoverflow.com/questions/14145403/repeatedly-applying-ave-for-computing-group-means-in-a-data-frame)

到目前为止，我已经提出了两种获得加权平均值的方法：

1.  `sapply`对每一列使用单独的语句
2.  在 a 中放置一个`sapply`语句`for-loop`

但是，我觉得必须有一种方法可以在语句中插入`apply`语句，`sapply`反之亦然，从而消除`for-loop`. 我尝试了许多排列但没有成功。我也看了`sweep`函数。

这是我到目前为止的代码。

```
df <- read.table(text= "
          region    state  county  weights y1980  y1990  y2000
             1        1       1       10     100    200     50
             1        1       2        5      50    100    200
             1        1       3      120    1000    500    250
             1        1       4        2      25    100    400
             1        1       4       15     125    150    200

             2        2       1        1      10     50    150
             2        2       2       10      10     10    200
             2        2       2       40      40    100     30
             2        2       3       20     100    100     10
", header=TRUE, na.strings=NA)

# add a group variable to the data set

group <- paste(df$region, '_', df$state, '_', df$county, sep = "")
df    <- data.frame(group, df)

# obtain weighted averages for y1980, y1990 and y2000 
# one column at a time using one sapply per column

sapply(split(df, df$group), function(x) weighted.mean(x$y1980, w = x$weights))
sapply(split(df, df$group), function(x) weighted.mean(x$y1990, w = x$weights))
sapply(split(df, df$group), function(x) weighted.mean(x$y2000, w = x$weights))

# obtain weighted average for y1980, y1990 and y2000
# one column at a time using a for-loop

y <- matrix(NA, nrow=7, ncol=3)
group.b <- df[!duplicated(df$group), 1]

for(i in 6:8) { 

    y[,(i-5)] <- sapply(split(df[,c(1:5,i)], df$group), function(x) weighted.mean(x[,6], w = x$weights))

}

# add weighted averages to the original data set

y2 <- data.frame(group.b, y)
colnames(y2) <- c('group','ave1980','ave1990','ave2000')
y2

y3 <- merge(df, y2, by=c('group'), all = TRUE)
y3 
```

很抱歉我最近的所有问题，并感谢您的任何建议。

编辑显示`y3`

```
 group region state county weights y1980 y1990 y2000   ave1980  ave1990  ave2000
1 1_1_1      1     1      1      10   100   200    50  100.0000 200.0000  50.0000
2 1_1_2      1     1      2       5    50   100   200   50.0000 100.0000 200.0000
3 1_1_3      1     1      3     120  1000   500   250 1000.0000 500.0000 250.0000
4 1_1_4      1     1      4       2    25   100   400  113.2353 144.1176 223.5294
5 1_1_4      1     1      4      15   125   150   200  113.2353 144.1176 223.5294
6 2_2_1      2     2      1       1    10    50   150   10.0000  50.0000 150.0000
7 2_2_2      2     2      2      10    10    10   200   34.0000  82.0000  64.0000
8 2_2_2      2     2      2      40    40   100    30   34.0000  82.0000  64.0000
9 2_2_3      2     2      3      20   100   100    10  100.0000 100.0000  10.0000 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-03T21:17:51.677

我建议使用包data.table：

```
library(data.table)
dt <- as.data.table(df)
dt2 <- dt[,lapply(.SD,weighted.mean,w=weights),by=list(region,state,county)]
print(dt2)

   region state county   weights     y1980    y1990    y2000
1:      1     1      1  10.00000  100.0000 200.0000  50.0000
2:      1     1      2   5.00000   50.0000 100.0000 200.0000
3:      1     1      3 120.00000 1000.0000 500.0000 250.0000
4:      1     1      4  13.47059  113.2353 144.1176 223.5294
5:      2     2      1   1.00000   10.0000  50.0000 150.0000
6:      2     2      2  34.00000   34.0000  82.0000  64.0000
7:      2     2      3  20.00000  100.0000 100.0000  10.0000 
```

如果你愿意，你可以`merge`在之后使用原始 data.table：

```
merge(dt,dt2,by=c("region","state","county"))

   region state county weights.x y1980.x y1990.x y2000.x weights.y   y1980.y  y1990.y  y2000.y
1:      1     1      1        10     100     200      50  10.00000  100.0000 200.0000  50.0000
2:      1     1      2         5      50     100     200   5.00000   50.0000 100.0000 200.0000
3:      1     1      3       120    1000     500     250 120.00000 1000.0000 500.0000 250.0000
4:      1     1      4         2      25     100     400  13.47059  113.2353 144.1176 223.5294
5:      1     1      4        15     125     150     200  13.47059  113.2353 144.1176 223.5294
6:      2     2      1         1      10      50     150   1.00000   10.0000  50.0000 150.0000
7:      2     2      2        10      10      10     200  34.00000   34.0000  82.0000  64.0000
8:      2     2      2        40      40     100      30  34.00000   34.0000  82.0000  64.0000
9:      2     2      3        20     100     100      10  20.00000  100.0000 100.0000  10.0000 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T17:14:59.290

我想出了如何在`sapply`不`apply`使用显式`for-loop`. 下面我提供数据集、`apply`语句和`apply`语句如何工作的解释。

以下是原始帖子中的数据集：

```
df <- read.table(text= "
          region    state  county  weights y1980  y1990  y2000
             1        1       1       10     100    200     50
             1        1       2        5      50    100    200
             1        1       3      120    1000    500    250
             1        1       4        2      25    100    400
             1        1       4       15     125    150    200

             2        2       1        1      10     50    150
             2        2       2       10      10     10    200
             2        2       2       40      40    100     30
             2        2       3       20     100    100     10
", header=TRUE, na.strings=NA)

# add a group variable to the data set

group <- paste(df$region, '_', df$state, '_', df$county, sep = "")
df    <- data.frame(group, df) 
```

这是获得所需加权均值的`apply`/代码。`sapply`

```
apply(df[,6:ncol(df)], 2, function(x) {sapply(split(data.frame(df[,1:5], x), df$group), function(y) weighted.mean(y[,6], w = y$weights))}) 
```

以下是对上述`apply`/`sapply`语句的解释：

1.  请注意，该`apply`语句一次选择第 6 到第 8 列`df`。

2.  对于这三列中的每一列，我都会创建一个新的数据框，将该列与`df`.

3.  然后我通过分组变量将每个新的 6 列数据帧分成块`df$group`。

4.  一旦一个六列的数据框被分割成单独的块，我计算每个块的最后一列（第 6 列）的加权平均值。

结果如下：

```
 y1980    y1990    y2000
1_1_1  100.0000 200.0000  50.0000
1_1_2   50.0000 100.0000 200.0000
1_1_3 1000.0000 500.0000 250.0000
1_1_4  113.2353 144.1176 223.5294
2_2_1   10.0000  50.0000 150.0000
2_2_2   34.0000  82.0000  64.0000
2_2_3  100.0000 100.0000  10.0000 
```

使用 package`data.table`很好，但是直到我更加熟悉它的语法以及该语法与语法的不同之处，`data.frame`我认为知道如何使用`apply`和`sapply`做同样的事情会很好。现在我可以使用这两种方法以及原始帖子中的方法来检查一种方法并了解更多关于它们的信息。

# ios - 如何在ios中用另一个图像替换图像的区域

> ID：14145860
> 
> 赞同：2
> 
> 时间：2013-01-03T19:33:26.170
> 
> 标签：ios, uiimage, crop

我想在 iOS 应用程序中处理 UIImage 的子区域。在[这个问题](https://stackoverflow.com/questions/2635371/how-to-crop-the-uiimage)之后，我现在有一个例程来提取有问题的区域作为我现在可以操作的 UIImage。有没有类似的方便的方法将区域放回原始图像？我正在考虑的替代方案是按字节复制，这对我来说似乎非常低级。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-03T20:48:56.830

您可以将这两个图像相互叠加，然后将它们组合成一个图像。

假设您有原始图像和修改后的部分：

```
UIGraphicsBeginImageContext(originalImage.size);

[originalImage drawAtPoint:CGPointMake(0, 0)];
[modifiedPart drawAtPoint:/* Upper left corner of the modified part */];
UIImage *combined = UIGraphicsGetImageFromCurrentImageContext(); 
```

**编辑：** 忘记这一行：

```
UIGraphicsEndImageContext(); 
```

# xml - 在 Go 中解析 XML 时处理命名空间

> ID：14145864
> 
> 赞同：4
> 
> 时间：2013-01-03T19:33:37.407
> 
> 标签：xml, go, xml-namespaces

如果在 Go 中使用 XML，我正在尝试解析一块：

```
package main

import (
    "encoding/xml"
    "fmt"
)

type XML struct {
    Foo string `xml:"foo"`
}

func main() {
    rawXML := []byte(`
<xml>
  <foo>A</foo>
  <ns:foo>B</ns:foo>
</xml>`)

    x := new(XML)
    xml.Unmarshal(rawXML, x)
    fmt.Printf("foo: %s\n", x.Foo)
} 
```

这输出：

```
foo: B 
```

虽然我预计它会产生：

```
foo: A 
```

如何获取第一个`foo`标签的内容（即没有命名空间的标签）？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-04T07:18:45.790

我不认为 xml 解码器可以指定一个元素不应该有带有结构标签的命名空间。但我确实知道它可以为您检索有关命名空间的信息，然后您可以在后处理数据以获得相同的结果：

```
package main

import (
    "encoding/xml"
    "fmt"
)

type Foo struct {
    XMLName xml.Name
    Data string `xml:",chardata"`
}

type XML struct {
    Foo []Foo `xml:"foo"`
}

func main() {
    rawXML := []byte(`
<xml>
  <foo>A</foo>
  <ns:foo>B</ns:foo>
</xml>`)

    x := new(XML)
    xml.Unmarshal(rawXML, x)
    //fmt.Printf("foo: %#v\n", x)
    for _, el := range x.Foo {
       if el.XMLName.Space == "" {
          fmt.Printf("non namespaced foo %q", el.Data)
      }
    }
} 
```

[http://play.golang.org/p/aDEFPmHPc0](http://play.golang.org/p/aDEFPmHPc0)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-03T19:44:44.720

您的 xml 文档中有两个串联的值。您的结构中只有一个值的空间。xml 解析器正在解析第一个，然后用第二个覆盖它。

将 Foo 更改为结构中的切片，然后您将获得这两个值。

[http://play.golang.org/p/BRgsuMQ7rK](http://play.golang.org/p/BRgsuMQ7rK)

```
package main

import (
    "encoding/xml"
    "fmt"
)

type XML struct {
    Foo []string `xml:"foo"`
}

func main() {
    rawXML := []byte(`
<xml>
  <foo>A</foo>
  <ns:foo>B</ns:foo>
</xml>`)

    x := new(XML)
    xml.Unmarshal(rawXML, x)
    fmt.Printf("foo: %s\n", x.Foo[0])
    fmt.Printf("both: %v\n", x.Foo)
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-06-11T06:21:32.700

选择`xml:"foo"`器语法采用可选的命名空间`xml:"ns foo"`，但问题是它不支持选择无命名空间的方法。

一种修复方法是简单地将命名空间分配给您现在可以使用语法`xml.Decoder.DefaultSpace`选择的非命名空间标签：`xml:"<ns> <tag>"`

[https://play.golang.org/p/1UggvqLFT9x](https://play.golang.org/p/1UggvqLFT9x)

```
import (
    "encoding/xml"
    "strings"
    "fmt"
)

type Doc struct {
    Foo string `xml:"_ foo"` // <-- <foo> will now be <_:foo>
    NsFoo string `xml:"ns foo"`
}

var input = `<xml>
  <foo>A</foo>
  <ns:foo>B</ns:foo>
</xml>`

func main() {
    decoder := xml.NewDecoder(strings.NewReader(input))
    decoder.DefaultSpace = "_"

    doc := &Doc{}
    decoder.Decode(doc)

    fmt.Printf("<foo>: %#v\n", doc.Foo)
    fmt.Printf("<ns:foo>: %#v\n", doc.NsFoo)

} 
```

印刷：

```
<foo>: A
<ns:foo>: B 
```

# facebook - 在 XMPP Facebook 聊天中设置资源

> ID：14145865
> 
> 赞同：0
> 
> 时间：2013-01-03T19:33:37.933
> 
> 标签：facebook, xmpp

当我们使用 xmpp 连接到 googletalk 时，我们可以设置资源属性，从而可以识别用户是否从 android、pc 等登录。

我想知道是否有任何类似的方法可以在 facebook 聊天 API 中指定/识别设备。
当我与 xmpp 连接时，facebook 会进行所有内部交易并抹去我的资源价值。
有没有其他方法可以实现这一目标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T13:03:31.990

这不是资源标识符的用途，即使许多用户或软件将人类可读的文本放在那里。出于安全原因，资源应该是不可预测的。

使用服务发现：http:
[//xmpp.org/extensions/xep-0030.html](http://xmpp.org/extensions/xep-0030.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T05:55:47.753

使用[XEP-0115](http://xmpp.org/extensions/xep-0115.html)：实体能力。用大写标记你的存在节。使用描述每个客户端的 disco#info 预加载所有客户端的 caps 缓存。这对您在 FaceBook 上的客户几乎没有用，并且在其他系统上的互操作性非常好。

请多次阅读 XEP。一开始几乎每个人都误解了它。

# c# - wpf 的 MVVM 解决方案

> ID：14145867
> 
> 赞同：1
> 
> 时间：2013-01-03T19:33:42.813
> 
> 标签：c#, wpf, mvvm

这里的情况： `Data Context`窗口是：`MainViewModel`。

它是由 每个都有自己的类型构建`ObservableCollections`的`SubViewModel.``SubViewModel``ObservableCollection``String.`

现在，我有一个树视图。ItemsSource 是`ObservableCollection`. `MainViewModel`（意味着它是`SubViewModel`集合）。

我希望如果选择了一个项目，那么将`ObservableCollection`显示`selected Item in the treeview.`

我怎样才能做到这一点？

一些代码：

```
<TreeView ItemTemplate="{DynamicResource TreeViewDataTemplate}" ItemsSource="{Binding SubViewModelCollection}"/> 
```

由于某些原因，我想在堆栈面板中显示该集合。所以：（TypeCollection 是该项目的字符串 ObservableCollection，它目前当然不起作用）

```
 <ItemsControl ItemsSource="{Binding TypeCollection}" x:Name="UserList" ItemTemplate="{StaticResource TemplateDataTemplate}" >
        <ItemsControl.ItemsPanel>
            <ItemsPanelTemplate>
                <VirtualizingStackPanel Orientation="Horizontal" HorizontalAlignment="Left" Grid.Column="1"/>
            </ItemsPanelTemplate>
        </ItemsControl.ItemsPanel>
    </ItemsControl> 
```

我一直在为此苦苦挣扎，我怎样才能实现我的目标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T19:39:28.350

将树视图绑定`ItemsSource`到`UserList`'s `SelectedItem`。

```
<TreeView ItemTemplate="{DynamicResource TreeViewDataTemplate}"
  ItemsSource="{Binding ElementName=UserList Path=SelectedItem.SubViewModelCollection}"/> 
```

假设其中的项目是具有名为 的属性`UserList`的类型。`SubViewModel``IEnumerable<T>``SubViewModelCollection`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T19:47:53.983

我建议看一下[Prism](http://msdn.microsoft.com/en-us/library/gg406140.aspx)，尤其是[与 Event Aggregation 相关的部分](http://msdn.microsoft.com/en-us/library/ff921122%28v=pandp.40%29.aspx#sec8)。这将允许您在选择 TreeView 中的项目时在应用程序中发布事件，在应用程序的其他地方使用该事件并将 ItemControl 绑定到所选的 SubViewModel ，而无需在这两部分之间引入任何不必要的耦合您的应用程序。

# jquery - jQuery hoverIntent 2 divs交互延迟

> ID：14145874
> 
> 赞同：0
> 
> 时间：2013-01-03T19:34:09.820
> 
> 标签：jquery, hover, mouseover, hoverintent

我想显示几个`blocks`（div）并让它们都以相同的方式与同一个对象交互。

**这是一个[jsFiddle 演示](http://jsfiddle.net/ignaciocorreia/TVAEg/11/)**

* * *

## 模拟错误的步骤

1.  `Rollover`第一个块将触发动画，它会打开对象。
2.  然后，如果您`Rollover`是第二个块，我想让对象保持打开状态，但是会发生第一个对象关闭然后再次打开的情况。

## 客观的

在我翻转积木时保持物体打开

为后代添加了原始代码：

```
$('.object').css({ "top": '-180px' });
$(".cont1,.cont2").hoverIntent(mousein_triger , mouseout_triger);

function mousein_triger(){
        $('.object').stop().animate({"top": "0px"}, 300);
    }
function mouseout_triger() {
        $('.object').stop().animate({"top": "-180px"}, 1000);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T19:42:19.203

我使用了一个计时器（全局）这里是 jsfiddle：http: [//jsfiddle.net/zL5jZ/](http://jsfiddle.net/zL5jZ/)

```
var timer = false;
function mousein_triger(){
        clearTimeout(timer);
        $('.object').stop().animate({"top": "0px"}, 300);
    }
function mouseout_triger() {
        timer = setTimeout(function(){
            $('.object').stop().delay(1000).animate({"top": "-180px"}, 1000);
        }, 400)
} 
```

在没有悬停块的情况下 400 毫秒后，块会自行关闭，否则它会按照您的意愿保持打开状态。

我对吗 ？:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T19:48:58.243

解释为什么它不起作用...

问题是“stop()”将停止动画，如果它已经开始，但如果它正在进行，则不会停止延迟。因此，如果您移出一个盒子并等到蓝色的开始移动并快速移回一个盒子，它将立即停止动画。如果你从一个盒子里移出然后又回到一个盒子里，它会完成等待，然后完成整个动画。

要修复它，请使用@nicolast 建议的计时器。

# c# - C#将文件复制到新文件夹并重命名特殊字符

> ID：14145876
> 
> 赞同：-3
> 
> 时间：2013-01-03T19:34:17.513
> 
> 标签：c#, file, scripting, copy

我正在尝试将单个文件复制到多个子目录，同时还将“占位符”（符号＆）更改为不同的字符。

一个目录中的原始文件 AJWCLN&.txt

最终文件希望放置在不同的目录中。\temp1\AJWCLNC.txt（将“&”符号更改为 Temp 子目录中的字母 C） \temp2\AJWCLND.txt（将“&”符号链接到字母 D）

我需要为大约 20 个不同的目录执行此操作，并且我需要为每个目录设置不同的字母。

预先感谢您的所有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T19:50:09.427

```
string fileName = "AJWCLN&.txt";
string newfileName="";
string destFile = "";
string sourcePath = @"C:\Users\Public\TestFolder";
string sourceFile = System.IO.Path.Combine(sourcePath, fileName);

for ( int i = 0; i < 20; i++ )
{
    newfileName = fileName.Replace('&', Convert.ToChar( i + 65 ));
    targetPath =  @("C:\Users\Public\TestFolder\temp" + i+1);
    string destFile = System.IO.Path.Combine(targetPath, newfileName);
    if (!System.IO.Directory.Exists(targetPath))
    {
        System.IO.Directory.CreateDirectory(targetPath);
    }
    System.IO.File.Copy(sourceFile, destFile, true);
} 
```

一些来源：

[如何：复制、删除和移动文件和文件夹（C# 编程指南）](http://msdn.microsoft.com/en-us/library/czx8s9ts.aspx)

[如何在 C# 中重命名文件？](http://social.msdn.microsoft.com/forums/en-US/csharpgeneral/thread/435a2692-6161-4039-bfa9-5e6211d90c49/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T19:38:34.487

您可以`File.Copy`用来复制具有不同名称的文件。

该程序演示：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.IO;

namespace ConsoleApplication1
{
    class Program
    {
        static void Main(string[] args)
        {
            File.Copy("c:\\myFile.ext", "c:\\temp\\myFile2.ext");
        }
    }
} 
```

你也可以使用`String.Format()`你的占位符，或者如果`&`绝对必须是占位符，`String.Replace`就可以

```
File.Copy("AJWCLN&.txt", String.Format("c:\\temp\\AJWCLN{0}.txt", "C") ); 
```

.

```
File.Copy("AJWCLN&.txt", "c:\\temp\\AJWCLN&.txt".Replace('&', 'C') ); 
```

# php - 列出标签 wordpress 时删除最后一个逗号

> ID：14145877
> 
> 赞同：3
> 
> 时间：2013-01-03T19:34:21.553
> 
> 标签：php, wordpress

我有以下脚本来列出没有链接的帖子标签，但它在所有标签（包括最后一个标签）之后放置了一个逗号。有什么方法可以防止脚本在列表中的最后一个标签中添加逗号？我尝试研究它，但是关于这个特定的 wp 字符串真的没有很多。

```
<?php
    $posttags = get_the_tags();
    if ($posttags) {
        foreach($posttags as $tag) {
            echo $tag->name . ', '; 
        }
    }
?> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-03T19:37:55.990

使用 rtrim。它将修剪最后一个指定的字符。

```
 $posttags = get_the_tags();
    if ($posttags) {
       $taglist = "";
       foreach($posttags as $tag) {
           $taglist .=  $tag->name . ', '; 
       }
      echo rtrim($taglist, ", ");
   } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-03T19:35:20.840

```
if ($posttags) {
    echo implode(
        ', ', 
        array_map(
            function($tag) { return $tag->name; },
            $posttags
        )
    );
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-03T19:49:59.680

当我需要连接可变数量的元素时，我倾向于这样做。

```
$posttags = get_the_tags();
if ($posttags) {
    foreach($posttags as $tag) {
        $temp[] = $tag->name; 
    }
}
if (!empty($temp)) echo implode(', ',$temp); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-03T19:49:07.203

更改逗号的位置并放置一个小条件

```
<?php
    $posttags = get_the_tags();
    if ($posttags)
    {
        $first=true;
        foreach($posttags as $tag) 
        {
            if($first)
            {
                echo $tag->name; 
                $first=false;
            }
            else
            {
                echo ', '.$tag->name; 
            }
        }
    }
?> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-03T19:51:36.297

您需要 wordpress 功能[`the_tags`](http://codex.wordpress.org/Function_Reference/the_tags)。它会回显一个标签，因此您不需要整个循环。

# sql - 使用 SQL Server 获取不正确的语法错误

> ID：14145878
> 
> 赞同：2
> 
> 时间：2013-01-03T19:34:21.260
> 
> 标签：sql, sql-server, sql-server-2008

我有一个我认为应该是一个简单的问题，但我自己无法解决这个问题。我只是想在一张桌子上做一个简单的搜索。

```
Select *
From dbo.Case
Where dbo.Case.CountyName='Milwaukee' 
```

我不断收到此错误：

消息 156，级别 15，状态 1，行 2 关键字“Case”附近的语法不正确。

我也试过取下“dbo”，但它仍然不起作用。

我究竟做错了什么？（使用 SQL Server 2008）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-03T19:35:54.870

`CASE` [是保留关键字](http://msdn.microsoft.com/en-us/library/ms189822.aspx)。您需要将其包含在其中`[]`以用作标识符，例如数据库、列或表名：

```
Select *
From dbo.[Case]
Where dbo.[Case].CountyName='Milwaukee' 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-03T19:36:06.740

`Case` [是 SQL 中的保留字](http://msdn.microsoft.com/en-us/library/ms181765.aspx)，所以需要用方括号括起来。

# java - 解析没有命名空间的xml

> ID：14145879
> 
> 赞同：0
> 
> 时间：2013-01-03T19:34:23.080
> 
> 标签：java, xml-parsing

当我尝试从包含 xml 的字符串解析到 org.w3c.dom.Document 时出现解析问题。

这是我尝试解析的 xml 字符串的示例：

```
<enviNFe xmlns="http://www.portalfiscal.inf.br/nfe" versao="2.00">
   <idLote>123</idLote>
   <NFe xmlns="http://www.portalfiscal.inf.br/nfe">
    ...
   </NFe>
</enviNFe> 
```

问题是，在 que String 被解析之后，通过以下代码：

```
private Document documentFactory(String xml) throws SAXException,      
    IOException, ParserConfigurationException, DocumentException, TransformerException {    

    DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();      
    factory.setNamespaceAware(true);    

    Document document = factory.newDocumentBuilder().parse(      
        new ByteArrayInputStream(xml.getBytes()));    

return document;    
} 
```

标签 NFe 加载时没有命名空间 (xmlns="http://www.portalfiscal.inf.br/nfe")

我想知道为什么会发生这种情况，以及我能做些什么来解决这个问题。

任何帮助都会很棒。谢谢，对不起我的英语。

------编辑---- 为了更好地理解：

此 xml 将在解析后立即签名，并将发送到政府的服务器（巴西）。在此之后，我向该服务器发出另一个请求，以验证它是否已被处理。如果是这样，如果有任何错误，我会得到积极的回应。我遇到的第一个问题是 xml 格式错误。发生这种情况是因为我在标签 NFe 中发送了没有该命名空间的 xml。为了解决这个问题，我在文件中添加了它（命名空间），在 xml 被签名之后。这个问题其实已经解决了，但是出现了另一个问题：签名的不同。因为我在没有命名空间的情况下签署了 xml，并与它一起发送。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T19:54:35.270

它正在返回正确的文档。要对其进行测试，您只需浏览您的文档即可。

```
doc.getFirstChild().getFirstChild().getNextSibling().getNextSibling().getNextSibling().getNamespaceURI(); 
```

或者尝试通过名称获取标签：

```
NodeList tags = doc.getElementsByTagNameNS("http://www.portalfiscal.inf.br/nfe", "NFe"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T21:27:29.763

从我可以从您的各种评论中汇总的内容来看，我认为您误解了 xml 的工作原理。您表示您手动将命名空间添加到`NFe`元素。但是，在您的 xml 示例中，`NFe`节点*已经具有该 namespace*。

在这个 xml 中：

```
<enviNFe xmlns="http://www.portalfiscal.inf.br/nfe" versao="2.00">
   <idLote>123</idLote>
   <NFe>
    ...
   </NFe>
</enviNFe> 
```

*所有*节点都有“http://www.portalfiscal.inf.br/nfe”命名空间。通过将`xmlns="..."`属性放在父节点上，命名空间将应用于该节点和具有相同前缀（在这种情况下，没有前缀）的*所有*子节点。

# dns - 如何以编程方式查询 senderbase.org？

> ID：14145886
> 
> 赞同：3
> 
> 时间：2013-01-03T19:34:36.100
> 
> 标签：dns, dnsbl

我正在尝试以编程方式查询 senderbase.org，但很难找到有关它的任何信息。

我试图查询：

```
dig txt 8.8.8.8.query.senderbase.org 
```

返回：

```
"0-0=1|1=Google Incorporated|2=3.7|3=4.0|4=3228772|6=1174353533|8=2880|9=1|20=google-public-dns-a.|21=google.com|22=Y|23=7.9|24=8.0|25=1049184000|40=3.7|41=4.0|43=3.8|44=0.06|45=N|46=24|48=24|49=1.00|50=Mountain View|51=CA|52=94043|53=US|54=-122.057|" 
```

但是这些字段似乎都没有表明 IP 是否被列出。

我找到了带有字段描述的以下页面。但是似乎是我需要的字段 26 不存在（[http://web.archive.org/web/20040830010414/http://www.senderbase.org/dnsresponses.html](http://web.archive.org/web/20040830010414/http://www.senderbase.org/dnsresponses.html)）。

我还发现了一些 SpamAssassin 扩展，它们正在查询 rf.senderbase.org，但它给了我不一致的结果。对于同一个字段，有时它会返回一个浮点数，有时它什么也不返回。

有任何想法吗？还是解析他们的 html 是唯一的选择？

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-02-12T03:36:53.953

关键值如下

```
 '0-0' => 'version_number',
        1 => 'org_name',
        2 => 'org_daily_magnitude',
        3 => 'org_monthly_magnitude',
        4 => 'org_id',
        5 => 'org_category',
        6 => 'org_first_message',
        7 => 'org_domains_count',
        8 => 'org_ip_controlled_count',
        9 => 'org_ip_used_count',
        10 => 'org_fortune_1000',

        20 => 'hostname',
        21 => 'domain_name',
        22 => 'hostname_matches_ip',
        23 => 'domain_daily_magnitude',
        24 => 'domain_monthly_magnitude',
        25 => 'domain_first_message',
        26 => 'domain_rating',

        40 => 'ip_daily_magnitude',
        41 => 'ip_monthly_magnitude',
        43 => 'ip_average_magnitude',
        44 => 'ip_30_day_volume_percent',
        45 => 'ip_in_bonded_sender',
        46 => 'ip_cidr_range',
        47 => 'ip_blacklist_score',

        50 => 'ip_city',
        51 => 'ip_state',
        52 => 'ip_postal_code',
        53 => 'ip_country',
        54 => 'ip_longitude',
        55 => 'ip_latitude', 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-07-15T22:43:28.020

SenderBase DNS 响应中指定的“域评级”是已实现但从未使用过的东西，或者至少不足以使其有用。最初指定的其他字段也有些偶然，尽管对于大容量的电子邮件发件人来说，大多数字段应该是相当新鲜的。您可能想查看 Perl [Net::SenderBase](https://metacpan.org/pod/Net%3a%3aSenderBase)库，直接使用它或作为您自己实现的参考。

[您提到的 rf.senderbase.org 域反映了 SenderBase 信誉评分 (SBRS)，它与您在http://www.senderbase.org](http://www.senderbase.org)上看到的内容基本无关。SBRS 不被视为公共服务，因此明智的做法是在将其用于任何严重的事情之前获得 Cisco/IronPort 的许可。

# php - 我想回显一个 div

> ID：14145887
> 
> 赞同：0
> 
> 时间：2013-01-03T19:34:38.357
> 
> 标签：php, ajax

在 $ruta 我有值 "imagenes/1.jpg" 如果我​​这样做，我会显示图像

```
<img src="imagenperfil/<?php echo $ruta; ?>" width="250" height="300"> 
```

但现在我有这个：

```
echo "<div class='tweet_user'><img class='user_img' src=''></div>"; 
```

所以在 src 我想把

```
 "imagenperfil/<?php echo $ruta; ?>" 
```

我尝试了很多方法，但没有一个有效。多谢！你总是解决我所有的问题

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T19:37:57.647

尝试，

```
echo "<div class='tweet_user'><img class='user_img' src='imagenperfil/$ruta'/></div>" ; 
```

[演示](http://codepad.org/6FyFuyT9)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T19:37:05.397

```
$ruta = htmlspecialchars($ruta);
echo "<div class='tweet_user'><img class='user_img' src='imagenperfil/{$ruta}'></div>"; 
```

添加了 htmlspecialchars()

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-03T20:00:33.297

如果您尝试这样做：

```
echo "<div class='tweet_user'><img class='user_img' src='"imagenperfil/<?php echo 
$ruta;   ?>"'></div>"; 
```

那么它就行不通了。您已经在 php 中并正在使用 echo

你可以试试这个：

```
 echo "<div class='tweet_user'><img class='user_img' src='imagenperfil/".$ruta."'></div>"; 
```

# asp.net - 在 ASP.Net 详细信息视图中显示 SQL Server 时间列中的小时和分钟

> ID：14145888
> 
> 赞同：1
> 
> 时间：2013-01-03T19:34:40.140
> 
> 标签：asp.net, markup, detailsview, time-format

在 ASP.Net DetailsView 中有一个名为 LateTimeArrivedAtSchool 的模板字段。此字段的数据来自 SQL Server 时间列。数据库中的数据以小时、分钟和秒的形式存储。

我们希望仅将其显示为小时和分钟。

这是模板字段的标记：

```
<asp:TemplateField HeaderText="Late Time Arrived At School:" SortExpression="LateTimeArrivedAtSchool">
    <EditItemTemplate>
        <asp:TextBox ID="TextBoxLateTimeArrivedAtSchool" runat="server" 
            Text='<%# Bind("LateTimeArrivedAtSchool") %>'></asp:TextBox>
    </EditItemTemplate>

    <InsertItemTemplate>
        <asp:TextBox ID="TextBoxLateTimeArrivedAtSchool" runat="server" 
            Text='<%# Bind("LateTimeArrivedAtSchool") %>'></asp:TextBox>
    </InsertItemTemplate>

    <ItemTemplate>
        <asp:Label ID="LabelLateTimeArrivedAtSchool" runat="server" 
            Text='<%# Bind("LateTimeArrivedAtSchool", "{0:hh:mm}") %>'></asp:Label>
    </ItemTemplate>

    <ItemStyle ForeColor="Blue" />
</asp:TemplateField> 
```

使用“{0:hh:mm}”会产生一个错误，指出“输入字符串的格式不正确”。

你能告诉我我们需要在 Bind 语句中使用什么吗？

*** 更新 *** 我将该列的 SQL Server 数据类型从 Time 列更改为 DateTime 列，并且能够仅显示数据的时间部分。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T20:35:19.523

使用 eval 而不是 bind

```
Text='<%# string.Format("{0:hh:mm}", Eval("LateTimeArrivedAtSchool")) %>' 
```

# php - PDO 多次插入的问题

> ID：14145891
> 
> 赞同：0
> 
> 时间：2013-01-03T19:34:55.850
> 
> 标签：php, pdo

这是我的 php 脚本的一部分，它必须缺少一些东西：

```
$startIndex = 7;
$endIndex = 303;
$defaults = range($startIndex, $endIndex);

$sql = "INSERT INTO items (itemId, userId) VALUES ";
$part = array_fill(0, count($defaults), "(?, ?)");
$sql .= implode(",", $part);
try {
  $db = DB::getInstance();
  $stmt = $db->dbh->prepare($sql);
  $i = 1;
  foreach($defaults as $default) {
    $stmt->bindParam($i++, $default);
    $stmt->bindparam($i++, $userId);
  }
  if ($stmt->execute()) {
    echo "result=ok";
  }else {
    echo 'invalid query';
  }

}catch(PDOException $e) {
  echo $e->getMessage();
} 
```

多次插入正在发生，一切似乎都很好，除了所有 itemId 字段都以 303 的形式出现（$defaults 数组中的最后一个元素）。foreach 循环似乎像我预期的那样工作，因为回显 $default 给了我我期望的整数序列。所以，应该是绑定的问题

请帮忙 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T19:39:36.563

这里发生的是你将参数绑定到`$default`变量，而不是它的值。

`$default`循环`$defaults`数组时，值会发生变化。绑定参数使用的是引用，而不是副本。

您可以更改循环和绑定参数以引用数组项：

```
foreach($defaults as $key => $default) {
    $stmt->bindParam($i++, $defaults[$key]);
    $stmt->bindparam($i++, $userId);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T19:50:34.480

`bindParam`需要参考。它将变量而不是值绑定到语句。

您可以通过引用传递来解决问题：

```
foreach($defaults as &$default) {          //pass $default as a reference (&)
    $stmt->bindParam($i++, $default);     // bind the variable to the statement
} 
```

或通过值传递并使用 bindValue 而不是 bindParam：

```
foreach($defaults as &$default) {  
    $stmt->bindValue($i++, $default);     // bind the value to the statement
} 
```

# java - Date.toString() 给出的年份与设定的年份不同？

> ID：14145895
> 
> 赞同：0
> 
> 时间：2013-01-03T19:35:37.480
> 
> 标签：java, date

在 Java 7 上（Java 6 未测试）：

```
import java.util.Date;

public class Main {

    public static void main(String[] args) {
        Date test=new Date(2012, 12, 12);
        System.out.println("test=" + test.toString());
    }
} 
```

给我

```
test=Sun Jan 12 00:00:00 CET 3913 
```

注意年份：3913，与我通过的年份（2012）不同。

这是一个错误还是我错过了什么？

（是的，我知道我使用的 Date 构造函数已被弃用。）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-03T19:37:35.117

该`Date`构造函数将年份减去 1900，[如 doc 中所述](http://docs.oracle.com/javase/6/docs/api/java/util/Date.html#Date%28int,%20int,%20int%29)。

（这是您应该尽可能使用 JODA 的众多原因之一，它具有明显更好的设计且不那么令人惊讶的 API。特别是，我宁愿用生锈的刀去除我的小指，也不愿使用内置的 Java 时间 API .)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-03T19:40:22.600

constructor for Java Date takes the year you would like and adds 1900 to it. month is zero indexed too so

```
Date test=new Date(2012, 12, 12); 
```

should become

```
Date test=new Date(2012-1900, 11, 12); 
```

check out the [API doc](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Date.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-03T19:37:50.653

从[`Date`文档](http://docs.oracle.com/javase/7/docs/api/java/util/Date.html)中：

> 参数：
> 
> year - 减去 1900 的年份。
> 
> 月 - 0-11 之间的月份。

显然，`1900 + 2012 = 3912`。通过超过月份值的限制，您实际上已经超过了指定的年份，因此是该`3913`值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-03T19:37:50.283

的第一个参数`Date()`定义如下：

```
year - the year minus 1900; must be 0 to 8099\. (Note that 8099 is 9999 minus 1900.) 
```

这解释了差异。

# sql - 删除触发器 getdate() 返回 1906 年

> ID：14145897
> 
> 赞同：1
> 
> 时间：2013-01-03T19:35:49.027
> 
> 标签：sql, sql-server, sql-server-2000

我想在已删除的记录上设置日期/时间戳，但我得到了奇怪的结果。当此触发器触发时，它将日期设置为 1906！

我尝试`GETDATE()`在查询中使用该函数，并`UPDATE`在表属性上使用默认值。它适用于我手动输入到`DELETED_RECORDS`表中的记录，但由于实际删除而移入的任何记录都有 1906 年的日期。我不确定发生了什么

```
ALTER TRIGGER [dbo].[Backup_TT_Deleted_Records]
ON [dbo].[tblLLS_TT]
FOR DELETE
AS
  BEGIN
      INSERT INTO dbo.tblLLS_TT_DELETED_RECORDS
      SELECT *
      FROM   Deleted

      UPDATE dbo.tblLLS_TT_DELETED_RECORDS
      SET    Deleted_DTTM = GETDATE()
      WHERE  dbo.tblLLS_TT_DELETED_RECORDS.Deleted_DTTM IS NULL
  END 
```

同样使用上面的触发器，如果​​我在`DELETED_RECORDS`表上输入一条记录，留下`Delete_DTTM`空值，然后删除一条导致触发器触发的记录，它将正确填写该记录，但删除进入`DELETED_RECORDS`表的记录将再次具有日期1906\. 我还注意到每条记录的日期递增一天。

知道这里可能会发生什么吗？

您希望我执行的任何其他测试让我知道，我会发布结果。这个很奇怪。谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-03T21:55:13.313

你的插入语句如下

```
INSERT INTO dbo.tblLLS_TT_DELETED_RECORDS
SELECT *
FROM   Deleted 
```

您既没有使用显式的列列表，`INSERT`也没有在`SELECT`.

你说

> 我还注意到每条记录的日期增加一天。

我的猜测是源中的列没有插入到您认为的目标列中。

如果您正在删除一批具有`IDENTITY`列值的行`2191 - 2555`并将该`int`值插入到`datetime`列中，您将获得隐式转换为 1906 年的日期（整数被视为表示自1900 年 1 月1^(日以来的天数）)

我假设源列很可能`IDENTITY`会解释日期的升序性质。要解决此问题，请尝试明确指定两个列列表。同样重要的是要注意等效的源列和目标列必须位于相同的序号位置。例如，SQL Server 不会根据列名匹配它们。

```
INSERT INTO dbo.tblLLS_TT_DELETED_RECORDS
            (col1,
             col2,
             col3)
SELECT col1,
       col2,
       col3
FROM   Deleted 
```

你也不需要单独的`UPDATE`声明，你可以在`INSERT`

```
INSERT INTO dbo.tblLLS_TT_DELETED_RECORDS
            (col1,
             col2,
             col3,
             Deleted_DTTM)
SELECT col1,
       col2,
       col3,
       getdate()
FROM   Deleted 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T19:43:08.303

如果你执行，你会得到什么价值？

```
SELECT GETDATE(); 
```

也许是错误配置的服务器时间。您还可以使“Deleted_DTTM”列的默认值采用其默认系统日期，然后您可以跳过最后一个更新语句。

# c# - 如何将存储过程中的数据填充到我的 winform 中？

> ID：14145899
> 
> 赞同：0
> 
> 时间：2013-01-03T19:35:50.387
> 
> 标签：c#, windows, winforms

我对编程很陌生，并且在我正在开发的基本应用程序中遇到了问题。我有一个类似于这个的人类......

```
 Person
        {
              SqlConnection conn = new SqlConnection(@"Integrated Security=True; Data                       
              Source=ME\MyPRESS;Initial Catalog=TEST5");
              SqlCommand cmd = new SqlCommand("usp_employee", conn);
              cmd.CommandType = CommandType.StoredProcedure;
              cmd.Parameters.Add("@emp_id", SqlDbType.Int).Value = id;
              SqlDataReader dr = cmd.ExecuteReader();

         while (dr.Read())

        try
        {
            conn.Open();

            {
                department = dr["dept_name"].ToString();
                fname = dr["emp_first_name"].ToString();
                lname = dr["emp_last_name"].ToString();
                email = dr["emp_email"].ToString();
                phone = dr["emp_phone"].ToString();
                position = dr["emp_position"].ToString();
                address1 = dr["emp_address1"].ToString();
                address2 = dr["emp_address2"].ToString();
                city = dr["emp_city"].ToString();
                state = dr["emp_state"].ToString();
                postal_code = dr["emp_postal_code"].ToString();

                // department = txtFirst_name.Text;
            }
        }
        finally
        {
            // 3\. close the reader
            if (dr != null)
            {
                dr.Close();
            }

            // close the connection
            if (conn != null)
            {
                conn.Close();
            }
        }
    } 
```

受保护的字符串部门；

```
 public string Department
    {
         get { return department; }
         set { department = value; }
    }
    protected string fname;

    public string Fname
    {
        get { return fname; }
        set { fname = value;}
    }

    protected string lname;

    public string Lname
    {
        get { return lname; }
        set { lname = value; }
    }

    protected string email;

    public string Email
    {
        get { return email; }
        set { email = value; }
    }

    protected string position;

    public string Position
    {
      get { return position; }
      set { position = value; }
    }

    protected string address1;

    public string Address1
    {
        get { return address1; }
        set { address1 = value; }
    }

    protected string address2;

    public string Address2
    {
        get { return address2; }
        set { address2 = value; }

    }

    protected string phone;

    public string Phone
    {
        get { return phone; }
        set { phone = value; }

    }

    protected string city;

    public string City
    {
        get { return city; }
        set { city = value; }
    }

    protected string state;

    public string State
    {
        get { return state; }
        set { state = value; }
    }

    protected string postal_code;

    public string Postal_Code
    {
        get { return postal_code; }
        set { postal_code = value; }

    } 
```

}

如上所示，我有一个表单和一个带有存储过程的数据库来检索数据......我迷失的地方是连接我的表单以显示存储过程中的记录。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T03:21:33.530

这有帮助！我现在已经启动并运行了......

公共人员（int id）{

```
 SqlConnection conn = new SqlConnection(@"Integrated Security=True; Data Source=JODIEPC\XPRESS;Initial Catalog=TEST5");
        conn.Open();
        SqlCommand cmd = new SqlCommand("usp_EmployeeSelect", conn);
        cmd.CommandType = CommandType.StoredProcedure;
        cmd.Parameters.Add("@emp_id", SqlDbType.Int).Value = id;

        SqlDataReader dr = cmd.ExecuteReader();
        while (dr.Read())
        {
            department = dr["dept_name"].ToString();
            fname = dr["emp_first_name"].ToString();
            lname = dr["emp_last_name"].ToString();
            email = dr["emp_email"].ToString();
            phone = dr["emp_phone"].ToString();
            position = dr["emp_position"].ToString();
            address1 = dr["emp_address1"].ToString();
            address2 = dr["emp_address2"].ToString();
            city = dr["emp_city"].ToString();
            state = dr["emp_state"].ToString();
            postal_code = dr["emp_postal_code"].ToString();

        }

    }

   protected int id;
   protected string fname;
   protected string lname;
   protected string department;
   protected string email;
   protected string position;
   protected string address1;
   protected string address2;
   protected string phone;
   protected string city;
   protected string state;
   protected string postal_code;

    public int Id
   {
       get { return id; }
       set { id = value; }
   }

    public string Department
    {
       get { return department; }
       set{ department = value; }
    }

    public string Fname
    {
        get { return fname; }
        set { fname = value; }
    }
    public string Lname
    {
        get { return lname; }
        set { lname = value; }
    }
    public string Email
    {
        get { return email; }
        set { email = value; }
    }

    public string Position
    {
      get { return position; }
      set { position = value; }
    }

    public string Address1
    {
        get { return address1; }
        set { address1 = value; }
    }

    public string Address2
    {
        get { return address2; }
        set { address2 = value; }

    }

    public string Phone
    {
        get { return phone; }
        set { phone = value; }

    }

    public string City
    {
        get { return city; }
        set { city = value; }
    }
     public string State
    {
        get { return state; }
        set { state = value; }
    }
    public string Postal_Code
    {
        get { return postal_code; }
        set { postal_code = value; }

    }
} 
```

---------winform---------------- private void btnSearch_Click(object sender, EventArgs e) { Person Emp = new Person(Int32.Parse(txtId.Text) ); txtFirstName.Text = Emp.Fname; txtLastName.Text = Emp.Lname; txtEmail.Text = Emp.Fname; txtPhone.Text = Emp.Phone; txtDepartment.Text = Emp.Department; txtPosition.Text = Emp.Position; txtAddress1.Text = Emp.Address1; txtAddress2.Text =Emp.Address2; txtCity.Text = Emp.City; txtState.Text = Emp.State; txtPostalCode.Text = Emp.Postal_Code; 这不是最有创意的方式，但它确实有效....

非常感谢各位....

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T02:08:45.747

一种简单的方法是为您的 Person 类定义一个构造函数：

```
public class Person
{
    public Person(string Department, string fName /* etc */)
    {
        this.Department = Department;
        this.fName = fName;

        // and so on for all the fields
    }

    // the rest of the class definition goes here
} 
```

然后在循环数据时，使用该构造函数创建一个 Person 对象。从您的函数中返回新的 Person 对象。

# redirect - 使用 tcpdf 生成 pdf 后 Symfony2 不会重定向到新页面

> ID：14145901
> 
> 赞同：0
> 
> 时间：2013-01-03T19:35:54.787
> 
> 标签：redirect, symfony, tcpdf

我有一个控制器，它应该生成 pdf 文件，然后应该重定向到另一个站点。

```
class DocuController extends Controller
{
    public function indexAction() {
          // some other code
            if ($request->get('_add_document'))
            {
                $form->bindRequest($request);
                $em = $this->getDoctrine()->getEntityManager();
                $em->persist($document);      
                $em->flush();   
                if ($session->get('journey_id')!=false)
                {
                    $relation = new DocumentJourneyInJourney();
                    $relation->setJourney($session->get('journey_id'));
                    $relation->setDocument($document->getId());
                    $em->persist($relation);
                    $em->flush();
                }
                $pdf=$this->generatePDF($form);   
                $pdf->Output('file.pdf', 'I');

                return $this->redirect($this->generateUrl('another_site'));
            }
    }        
    return $this->render('Bundle:Page:document.html.twig'); 
}

public function generatePDF($form)
{
    $pdf = $this->get("wrep.tcpdf")->create();
    $pdf->SetTitle('Tittle');        
    $pdf->SetHeaderData('', 0, '  ', '  ', array(0,0,0), array(0,0,0)); 
    $pdf->setHeaderFont(array(PDF_FONT_NAME_MAIN, '', PDF_FONT_SIZE_MAIN));
    $pdf->SetPrintFooter(false);  
    $pdf->SetAutoPageBreak(TRUE);         
    $pdf->AddPage();
    $html = $this->renderView('Bundle:document.twig',
                    array(
                    'traveller' => $form["name"]->getData().' '.$form["surname"]->getData(),
                    'document' => $form["full_name"]->getData()
                    )
                );  
    $pdf->writeHTML($html, $ln=false, $fill=false, $reseth=false, $cell=false, $align='');
    return $pdf;
}
} 
```

但是使用此代码会生成 pdf 并且浏览器会下载它，但不会重定向页面。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T19:55:33.500

那是不可能的。您只能尝试使用 javascript 来做到这一点。创建一个 iframe 加载 pdf 下载 url 并在使用 javascript 调用 iframe 后重定向用户。（我不知道它是否真的有效）另一个问题是你为什么需要重定向用户？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T19:38:02.090

这很正常。当您下载文件时，您的回复已发送。发送重定向响应也是如此。

# grails - 有没有一种简单的方法可以让 i18n 消息文件保持同步？

> ID：14145902
> 
> 赞同：1
> 
> 时间：2013-01-03T19:35:57.983
> 
> 标签：grails, internationalization

我想知道是否有一种简单的方法可以使不同的 i18n 文件保持同步，所以在 message_aa.properties 中添加键/值时会在 message_bb.properties 文件中产生同一行？但是这个offcourse使用了不同的值..

我真的很想在我的每个 message_xx.properties 文件中的相同行号上有相同的键..

有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T23:29:03.270

此功能取决于您的 IDE。

作为一个例子，我在 Eclipse 中使用[ResourceBundle 插件](http://marketplace.eclipse.org/node/413975#.UOYTt-T8LT4)，它部分地完成了你所要求的。“部分”，因为它保持相同的顺序但不需要在同一行（即它不会跳过行以将一个文件与另一个文件匹配）。

# sql - SQL Server 字符串到 varbinary 的转换

> ID：14145904
> 
> 赞同：4
> 
> 时间：2013-01-03T19:36:03.170
> 
> 标签：sql, string, type-conversion, varbinary

好的，问题是需要在 2 个表上进行合并或连接。一个将文件内容存储为 [image] 类型或 varbinary(max)，另一个将文件内容存储为十六进制字符串。如果我将相同的内容上传到两个表中

作为字符串的内容（字节数组到字符串）看起来像这样......

```
'application/vnd.xfdl;content-encoding="base64-gzip"
H4sIAAAAAAAAC+y9e1fjONI4/H9/Cg173idwFgIJl+5m6MzPJAayE+KsnXQPs8+cHJMY8HZi57ET
aObMh3918UW2Jcdyrmbg7E7HtqpUpSqVSqWSdPHLj/EIPBuOa9rWl51K+WgHGNbAHprW45edpqYc
fPp0+vmgsvNL7cPFb1eNFoDlLffLztN0Ojk/PHx5eSl3Zo4hDx+N8sAeH6Iyh2fl0x1S8Hwwc6f2'    
... 
```

图像看起来的内容（这最终是我希望它看起来的样子）

```
0x6170706C69636174696F6E 
```

如果我选择`convert(varbinary(MAX), @contentAsString)`我得到`0x6100700070006C00690063006100740069006F006E`

看起来好像转换是在目标上，但在每个之间放置了两个零 (00)，由于缺少更好的词，我将其称为一个字节。

我已经尝试过在论坛上发布的各种更复杂的方法，但无济于事。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-01-03T21:04:30.963

来自[MSDN](http://blogs.msdn.com/b/sqltips/archive/2008/07/02/converting-from-hex-string-to-varbinary-and-vice-versa.aspx)

> 在 SQL Server 2008 中，这些转换更加容易，因为我们直接在 CONVERT 内置函数中添加了支持。下面的代码示例显示了如何执行转换：
> 
> ```
> declare @hexstring varchar(max);
> 
> set @hexstring = '0xabcedf012439';
> 
> select CONVERT(varbinary(max), @hexstring, 1);
> 
> set @hexstring = 'abcedf012439';
> 
> select CONVERT(varbinary(max), @hexstring, 2);
> 
> go
> 
> declare @hexbin varbinary(max);
> 
> set @hexbin = 0xabcedf012439;
> 
> select
>    CONVERT(varchar(max), @hexbin, 1),
>    CONVERT(varchar(max), @hexbin, 2);
> 
> go 
> ```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-04T16:43:19.283

好的，所以填充的 00 已被回答。

```
DECLARE @hexStringNVar nvarchar(max)
DECLARE @hexStringVAR varchar(max)

SET @hexStringNVar = '{my hex string as described above}'
SET @hexStringVAR = '{my hex string as described above}'

select CONVERT(varbinary(MAX), @hexStringNVar)) = 0x6100700070006C00690063...
select CONVERT(varbinary(MAX), @hexStringVAR)) = 0x6170706C6963... 
```

填充是`00`因为 Unicode 或与.`NVARCHAR``VARCHAR`

因此，由于存储的数据在 中`nvarchar(max)`，因此解决方案是：

```
select CAST(cast(@hexStringNVar as varchar(max)) as varbinary(max)) = 0x6170706C6963... 
```

我确信这`convert`也可以，但我的目标 SQL Server 是 2005。

# ruby - 从ruby中的哈希中提取多个值，修改原始哈希并返回提取的值

> ID：14145907
> 
> 赞同：0
> 
> 时间：2013-01-03T19:36:12.883
> 
> 标签：ruby, hash

我有一个 YAML 文件，我用它来播种一些 Ruby on Rails 模型。我使用`YAML.load(filename)`. 在创建 RoR 模型之前，某些键需要进行一些后期处理，例如，需要从文件名打开文件。

我想从散列中提取两个值到变量中，使散列不存在这些值。

在 Ruby 中这样做最惯用的方法是什么？

编辑：

我试过做：

```
value1 = hash.delete(:key1)
value2 = hash.delete(:key2) 
```

这给了我`value1`很好`value2`但保持哈希不变。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T20:32:48.730

如何使用枚举器并从散列中提取每个值，并将散列保留在其原始实体中。

```
hash = { :key1 => value1, :key2 => value2 }

# Iterates over values
hash.each_value {|val| print val} 
```

或另一种选择：

```
print hash.shift[1] while not hash.empty? 
```

通常该`delete`方法从哈希中删除指定的键并返回删除的值。

```
hash.delete (:key1) # => returns the deleted value. Now the hash should contain {:key2=>value2} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T21:22:47.607

生成的哈希`YAML.load`使用字符串键而不是符号键。我试图使用符号键删除，所以没有被删除。

# breeze - 添加新实体时，不会生成身份值

> ID：14145912
> 
> 赞同：0
> 
> 时间：2013-01-03T19:36:21.343
> 
> 标签：breeze

我遇到了问题，我扩展实体以公开 hasValidationError。没有它，它工作正常。我还发现，如果我在添加实体之前提供 ID，它也可以正常工作。为什么在客户端扩展实体后 ID 字段不会自动生成。

我现在使用的代码版本略有不同（我发现以这种方式扩展实体更直观），但它仍然以相同的方式出错。

```
 var Country = function () {
                           console.log("Country initialized");
                           var self = this;
                           self.Country_ID = ko.observable(""); 
                           self.Country_Code = ko.observable("");  
                           self.Country_Name = ko.observable().extend({
                               validation: {
                                   validator: function (val, someOtherVal) {

                                       return false;//val === someOtherVal;
                                   },
                                   message: 'Invalid Value!',
                                   params: 5
                               }
                           });

                           var prop = ko.observable(false);

                           var onChange = function () {
                               var hasError = self.entityAspect.getValidationErrors().length > 0;

                               if (prop() === hasError) {
                                   // collection changed even though entity net error state is unchanged
                                   prop.valueHasMutated(); // force notification
                               } else {
                                   prop(hasError); // change the value and notify
                               }
                           };

                           // observable property is wired up; now add it to the entity
                           self.hasValidationErrors = prop;

                           //dummy property to wireup event
                           //should not be used for any other purpose
                           self.hasError =  ko.computed(
                                                {
                                                    read: function () {
                                                        self.entityAspect // ... and when errors collection changes
                                                                .validationErrorsChanged.subscribe(onChange);
                                                    },

                                                    // required because entityAspect property will not be available till Query
                                                    // return some data
                                                    deferEvaluation: true

                                                });

                           self.fullName = ko.computed(
                                            function () {
                                                return self.Country_Code() + " --- " + self.Country_Name();
                                            });
                       };

                       store.registerEntityTypeCtor("Country", Country); 
```

然后在按钮中单击我正在使用以下代码创建新实体。

```
 var countryType = manager.metadataStore.getEntityType("Country"); 
                           var newCountry = countryType.createEntity(); 
                           //newCountry.Country_ID(200); //if i add this line no errors occurs
                           newCountry.Country_Code("India");

                           self.list.push(newCountry);

                           manager.addEntity(newCountry); // validation error occurs right after this line

                           self.selectedItem(newCountry);
                           self.list.valueHasMutated(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T21:43:45.957

如果实体的类型的元数据指定支持此功能，则实体只会获得自己的自动生成密钥。IE

```
if (myEntityType.autoGeneratedKeyType === AutoGeneratedKeyType.Identity) 
```

此设置意味着实体的键属性由服务器自动生成，通常用于数据库上的“身份”列。

或者

```
if (myEntityType.autoGeneratedKeyType === AutoGeneratedKeyType.KeyGenerated) 
```

此设置意味着您有一个可以为您生成密钥的服务器端 KeyGenerator。

但是，默认情况下， myEntityType.autoGeneratedKeyType 将等于**AutoGeneratedKeyType.None**。

在其他两种情况下，微风将在客户端生成一个临时密钥，然后在保存完成后使用服务器上生成的“真实”密钥修复它。

如果您不需要此功能，则只需为您的类型创建自己的 ctor，生成唯一键并将其设置在那里。有关如何注册 ctor 的更多详细信息，请参阅**MetadataStore.registerEntityTypeCtor 。**

我们正计划改进我们在这方面的文档，但还没有做到。我希望这有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-04T21:52:51.947

也许根本没有错。你怎么知道 id 生成失败了？将 newCountry 添加到管理器后是否为负数？它应该是。

您收到的验证错误是什么？它与 Country_ID 有关吗？也许您对 Country_ID 有一个验证约束（例如，最小值）？

`addhasValidationErrorsProperty`实体初始化程序按预期工作。我刚刚在 DocCode 示例中添加了一个教学测试（请参阅 entityExtensionTests.js 中的“注册 addhasValidationErrorsProperty 初始化程序后可以创建员工”）。在我写这篇文章时，我们还没有部署它，但你可以从 GitHub 获得它。

它尽可能地遵循您的示例，使用`Employee`具有身份 ID (Employee_ID) 的 Northwind 实体。测试显示添加了我在上一篇文章中编写的初始化程序（而不是您可能已经重写它）。显示新员工的id在加入经理前为零，加入经理后变为-1。-1 是新员工的临时 id；保存后它会收到一个永久值。

EntityManager的默认`validationOptions`设置是为了在实体附加（或添加）到管理器时验证实体。您可以更改该行为以满足您的需要。

新员工在创建时处于无效状态；它缺少必需的名字和姓氏值（测试显示这些错误）。因此，在将新员工添加到经理之后， `hasValidationErrors`observable 就变成了，并且observable 会发出一个 Knockout UI 会听到的更改通知；这些测试显示了这两点。`true``hasValidationErrors`

# jquery - imagesLoaded jQuery 插件

> ID：14145913
> 
> 赞同：1
> 
> 时间：2013-01-03T19:36:32.400
> 
> 标签：jquery, json

我似乎无法理解 imagesLoaded 插件的延迟方法。我不知道如何在我的具体情况下使用它。我正在使用 JSON 从外部来源获取照片。一切都加载到#photographs。我想实现在加载所有照片时隐藏所有内容（显示大型加载器动画）；加载 15 张照片后，删除大的加载动画并显示一个小的并继续加载其余的照片。当我所有的照片都加载完毕后，隐藏小加载动画。

我有以下代码，但它当然是错误的，因为只有在加载所有内容时才会调用回调。我正在寻找 .progress() 方法..

```
$('#photographs').imagesLoaded(function($images) {
        var totalAmount = $images.length;
        if(($images.length) > 15) {
            $("#photographs, #loader").fadeIn("fast");
            $("#bigloader").fadeOut("fast");
            $("#photographs").gridalicious({
                gutter: 2,
                animate: true,
                effect: 'fadeInOnAppear',
                width: 430,
                complete: onComplete()
            });
        } else if(($images.length) == totalAmount) {
            $("#loader").fadeOut("fast");
        };
    }); 
```

像这样的东西？

```
var dfd = $("#photographs").imagesLoaded();

    dfd.progress(function( isBroken, $images, $proper, $broken ) {
        var totalAmount = $images.length;

        if(($proper.length) > 15) {
            $("#photographs, #loader").fadeIn("fast");
            $("#bigloader").fadeOut("fast");
            $("#photographs").gridalicious({
                gutter: 2,
                animate: true,
                effect: 'fadeInOnAppear',
                width: 430,
                complete: onComplete()
            });
        }
    }); 
```

编辑：有关进度方法的信息可以在这里找到[https://github.com/desandro/imagesloaded](https://github.com/desandro/imagesloaded)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T19:51:54.217

您应该将处理程序附加到图像本身，以便每次加载图像时都会触发它：

```
var loaded = 0;
var totalAmount = $('#photographs img').length;

$('#photographs img').each(function() {
    loaded;
    $(this).imagesLoaded(function($images) {
        loaded++;
        if (loaded > 15) {
            // stuff to do when more than 15 images
        } else if (loaded == totalAmount) {
            // stuff to do when all images loaded
        };
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-30T03:03:59.490

```
$(selector).imagesLoaded(function); 
```

这种使用 ImagesLoaded 的方法似乎将您的函数注册到“always”事件。尝试显式处理 always 事件，但首先为“progress”事件添加处理程序，如下所示：

```
$(selector).imagesLoaded()
    .progress(function( instance, image ) {
        $(progressBarSelector).val( $(progressBarSelector).val() + 1);    
    })
    .always(function(){
         $(progressBarSelector).hide();
    }); 
```

在我通过显式定义此进度事件处理程序更改顺序之前，我的进度代码也没有被执行。

# php - PHP 中的 if 逻辑和变量

> ID：14145916
> 
> 赞同：0
> 
> 时间：2013-01-03T19:36:46.493
> 
> 标签：php, variables, if-statement

我有多个变量`$soft0 , $soft1 , $soft2 , $soft3 , $soft4 , $soft5`，也喜欢`$fo0 , $fo1 , $fo2 , $fo3 , $fo4 , $fo5`，但如果我想在这里应用一个 if 条件，那么它会显示错误。代码：

```
for ($i=0; $i<=29; $i++) {
    $soft$i = str_replace(" ", "+", $fo$i); // this line showing an error
    $link_f_u = $html->find('h3', 0);
    $keyy = $link_f_u->plaintext;
    if ($soft$i==$keyy){
        continue;
    } else { 
        publish($soft$i);
    }
} 
```

修改此代码的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T19:40:07.217

This will fix your error, but I would *highly* recommend you take a look at arrays: [http://php.net/manual/en/language.types.array.php](http://php.net/manual/en/language.types.array.php)

```
for($i=0;$i<=29;$i++){
    $softVarName = "soft" . $i;
    $foVarName = "fo" . $i;

    $$softVarName = str_replace(" ", "+", $$foVarName);
    $link_f_u = $html->find('h3', 0);
    $keyy = $link_f_u->plaintext;
    if ($$softVarName==$keyy){
        continue;
    } else { 
        publish($$softVarName);
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-03T19:40:48.423

This should fix the issue.

```
for($i=0;$i<=29;$i++){
    ${'soft' . $i} = str_replace(" ", "+", ${'fo' . $i}); // this line showing an error
    $link_f_u = $html->find('h3', 0);
    $keyy = $link_f_u->plaintext;
    if (${'soft' . $i} == $keyy){
        continue;
    } else { 
        publish(${'soft' . $i});
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-03T19:41:00.000

### Option 1 (best option):

change `$soft0 ... $soft10` to [arrays](http://php.net/manual/en/language.types.array.php) looking like `$soft[0] .. $soft[10]`. You can then use `count()` in your for loop:

```
for($i=0;$i<=count($soft);$i++){
    $soft[$i] = str_replace(" ", "+", $fo[$i]);
    $link_f_u = $html->find('h3', 0);
    $keyy = $link_f_u->plaintext;
    if ($soft[$i]==$keyy){
        continue;
    } else { 
        publish($soft[$i]);
    }
} 
```

### Option 2:

You can also use double dollar sign, however this is messy and can result in errors that are hard to catch.

```
$soft_name = 'soft'.$i;
$fo_name = 'fo'.$i;
$$soft_name = str_replace(" ", "+", $$fo_name); 
```

# vb.net - combobox.SelectedItem.ToString 显示结果“System.Data.DataRowView”

> ID：14145923
> 
> 赞同：2
> 
> 时间：2013-01-03T19:37:25.713
> 
> 标签：vb.net, combobox

当我想获取用户从组合框中选择的项目时，我得到以下结果：

```
"System.Data.DataRowView" 
```

当我使用`combobox.SeletedIndex.ToString`它时，我会将索引作为字符串。

当我使用`combobox.SelectedValue.ToString`它时，它给了我价值。

但是当我使用`combobox.SelectedItem.ToString`它时，它会给我上面的信息。

这是我的组合框代码：

```
Dim strSQL As String = "SELECT * FROM Category"    
Dim da As New SqlDataAdapter(strSQL, myConnection)    
Dim ds As New DataSet    
da.Fill(ds, "Category")    
With categoryidcbox    
.DataSource = ds.Tables("Category")    
.DisplayMember = "Names"    
.ValueMember = "Category_Id"    
.SelectedIndex = 0    
End With 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-05T07:16:27.050

请检查组合框的 SORTED 属性。当从数据库中填充数据时，它应该是 FALSE。如果为真，则发生上述错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T19:52:20.350

你可以尝试这样的事情：

```
Dim row As DataRowView = DirectCast(categoryidcbox.SelectedItem, DataRowView)
MessageBox.Show("Clicked on " & row("Names").ToString & _
                " ID " & row("Category_Id").ToString) 
```

# php - 如何使用 PHP 清除 fastcgi_cache？

> ID：14145924
> 
> 赞同：3
> 
> 时间：2013-01-03T19:37:26.347
> 
> 标签：php, nginx, fastcgi

有没有一种内置的方法可以用 PHP 清除 Nginx fastcgi_cache？我知道我可以编写一个 PHP 脚本来手动删除所有缓存文件，但这似乎太像黑客了。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-03T19:40:41.753

如果你有

```
fastcgi_cache_path  /tmp/nginx keys_zone=myzone:8m 
```

打电话

```
rm -Rf /tmp/nginx/* 
```

这真的很简单：当你想清理缓存时，清理缓存:)（在这种情况下只是一个文件夹）

# java - 日食的 Fitnesse 插件

> ID：14145926
> 
> 赞同：3
> 
> 时间：2013-01-03T19:37:30.893
> 
> 标签：java, eclipse-plugin, fitnesse, acceptance-testing

我正在使用 Fitnesse 作为验收测试工具。我是正确的java中的夹具。我正在为 Eclipse 寻找一个好的插件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-14T23:06:56.167

`code.google.com`回购中有一个，但最后一次更新是 2011 年

网址：[http ://code.google.com/p/fitnesse-editor/](http://code.google.com/p/fitnesse-editor/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-11T10:59:33.917

有相同的备用网址；及其工作！所有其他网址似乎都不起作用。

```
http://fitnesse-editor.googlecode.com/svn/trunk/fiteditSite/ 
```

![在此处输入图像描述](../Images/41a8e8b55e8398322c443d6c05de6a2d.png)

# windows-8 - Windows Phone 8 模拟器 - 不工作

> ID：14145927
> 
> 赞同：3
> 
> 时间：2013-01-03T19:37:33.413
> 
> 标签：windows-8, windows-phone-8, hyper-v

我使用 VS 2012 Ultimate 运行 Win 8 Pro，并安装了 Windows Phone 8 SDK。Win 8 直接安装在 SSD 驱动器上。系统详细信息： CPU：Intel i7-3930K CPU @ 3.20GHz RAM：32GB Hyper-V 已安装且工作正常（运行其他一些实例、Dynamics、SharePoint）完全没有问题。

此工具：[https](https://slatstatuscheck.codeplex.com/) ://slatstatuscheck.codeplex.com/ 报告：您有一台支持 SLAT 的机器。

使用英特尔处理器识别实用程序，我得到以下信息：![http://i48.tinypic.com/2r79i7b.jpg](../Images/889eb8ae446e1fb4583a96b016b102b5.png)

但是，当我创建一个新的 Windows Phone 8 项目并启动该应用程序时，模拟器显示“Windows Phone 操作系统正在启动”。关闭后它会保持这种状态几分钟。在 Hyper-V 中，实例正在运行，但模拟器不工作。我尝试了很多案例，修复、卸载、安装、移除开关、重新创建它们……什么都没有！每次都是一样的结果。

可能是什么问题？

我的机器是否兼容运行虚拟化？我想是的，因为它可以很好地运行其他一些虚拟实例......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-03T13:32:43.423

你能运行虚拟机吗？如果您在 Windows 8 中启用了 hyper-v 管理程序，则英特尔处理器识别程序报告正确。Windows 8 中的一个新“功能”是，当您启用 hyper-v 功能时，它会将所有内容都视为 VM。

因此，当您启动计算机时，您认为运行物理 Windows 8 Pro 操作系统的物理机器并非如此。您的计算机正在做的是启动一些充当 hyper-v 主机的隐藏核心程序，然后将您的 windows 8 pro 操作系统作为 hyper-v 客户端（零硬件虚拟化）启动。

从微软的角度来看，我可以理解这让他们的生活更轻松，因为一切都在同一个竞争环境中。但是在这种情况下，当您运行 WP8 VM 时，它会使用硬件虚拟化功能并发现它们不存在，并且 Visual Studio 无法使用它在尝试调试代码时所期望的全部功能在虚拟环境中。

# sql-server - 两个删除查询之间的区别

> ID：14145931
> 
> 赞同：0
> 
> 时间：2013-01-03T19:37:42.510
> 
> 标签：sql-server, tsql

我正在尝试使用 SELECT 查询从表变量中删除一些数据。以下代码完美运行：

```
DECLARE @sgID int
SET @sgID = 1234

DELETE FROM
    @tbl_users 
WHERE
    (userID NOT IN (
            SELECT
                userID 
            FROM
                [SGTable] 
            WHERE
                (sgID = @sgID)
            )) 
```

我正在尝试加快此查询，并阅读以下方法可能会更好。但是，当我使用以下代码时 - 所有记录都从表变量中删除。

```
DELETE
    tmp 
FROM 
    @tbl_Users tmp INNER JOIN
    [SGTable] sgu ON sgu.userID = tmp.userID 
WHERE
    (sgu.sgID <> @sgID) 
```

我（显然错误地）假设这两个查询做了同样的事情（删除表变量中的所有用户 ID，其中在子查询中找不到用户 ID）。谁能提供一些关于使第二个查询工作的建议，因为它显然更容易阅读和维护？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T19:51:11.333

一个 userID 是否可以与 SGTable 中的多个 sgID 相关联？

如果是这样，那么您将删除 sgID (@sgID) 中的用户，因为它们也与另一个 sgID 相关联。

您可能更喜欢：

```
DELETE tmp 
FROM @tbl_Users tmp 
LEFT OUTER JOIN [SGTable] sgu ON sgu.userID = tmp.userID AND sgu.sgID = @sgID
WHERE sgu.sgID IS NULL 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T19:49:06.237

那 where 子句不应该是 "=" 而不是 "<>" 吗？您想删除匹配的记录，而不是不匹配的记录（可能是所有记录），对吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-03T19:47:22.120

怎么样`delete where exists`？

```
DELETE FROM mytable
WHERE EXISTS (
    SELECT *
    FROM ....)
; 
```

# php - 设置 php 变量以查找当前页面

> ID：14145933
> 
> 赞同：0
> 
> 时间：2013-01-03T19:37:45.143
> 
> 标签：php

```
$pages = array('Text1.php', 'Text2.php', 'Text3.php');

// $currentpage depends the page you're on

$currentId = array_search($currentpage, $pages); 
```

我有通过 an 访问的 php 脚本，`include(Text4.php)`并且`include(Text4.php)`存储在数组中的所有三个 php 脚本中。现在我要做的是设置`£currentpage`它，使其等于用户当前所在的页面，并匹配一个值，`$pages`该值应该是当前页面的文件名。

我的问题是，在上面的代码中，应该如何编写 $currentId 变量来执行它应该实现的功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T19:55:15.753

仅文件名：

```
$currentPage = basename(__FILE__); 
```

__

目录名+文件名：

```
$currentPage = __FILE__; 
```

__

仅目录：

```
$currentPage = __DIR__; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T19:47:57.973

//如果你想要一个路径

```
$currentpage = $_SERVER['PHP_SELF']; 
```

//如果你只想要实际的文件名（字面意思是“Test.php”）

```
$posofslash = strrpos($_SERVER['PHP_SELF'],'/');
$currentpage = substr($_SERVER['PHP_SELF'],$posofslash); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-08T06:55:12.337

这是我用于浏览器游戏的一段代码。措辞略有改变，但代码本身运行良好。任何 php 代码都可以放在“if”语句中，我使用了“print”。

```
 ///---Various Navigation & Functions Depending on Current Page---///

$findpage = strrpos($_SERVER['PHP_SELF'],'/');  
$currentpage = substr($_SERVER['PHP_SELF'],$findpage);
if ($currentpage == '/home.php'){
 print "This message is displayed when the client is on the 'home' page.";
 print "If you so chose, you can put the entire 'home' page code in here.";
 print "While keeping this the only code being executed.";}
if ($currentpage == '/features.php'){
 print "This message is displayed when the client is on the 'features' page.";
 print "If you so chose, you can put the entire 'features' page code in here.";
 print "While keeping this the only code being executed.";}
if ($currentpage == '/menu.php'){
 print "This message is displayed when the client is on the 'menu' page.";
 print "If you so chose, you can put the entire 'menu' page code in here.";
 print "While keeping this the only code being executed.";}
if ($currentpage == '/store.php'){
 print "This message is displayed when the client is on the 'store' page.";
 print "If you so choose, you can put the entire 'store' page code in here.";
 print "While keeping this the only code being executed.";} 
```

# android - 我们如何才能实现 120Hz - 240Hz 的 iOS 频闪率

> ID：14145940
> 
> 赞同：0
> 
> 时间：2013-01-03T19:37:55.857
> 
> 标签：android, ios

构建将利用 iOS 和 Android 相机闪光灯的 iOS 和 Android 应用程序。我们需要达到 120hz - 240hz 的频率。

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-03T19:41:11.790

As for iOS, Perhaps you can get it done in the screen, but not in the flash LED. Such frequency would kill or greatly reduce it's life, so I don't think you can toggle it that fast without private apis.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T19:56:55.033

对于这样的事情，您可能需要考虑构建一个小型专用外部 LED 闪光灯，用于在该问题上运行，使用蓝牙 LE 来控制射速。

# django - 多对多字段的 Django 中 ORM 的奇怪行为

> ID：14145949
> 
> 赞同：1
> 
> 时间：2013-01-03T19:38:09.500
> 
> 标签：django, orm

我尝试选择所有`Offers`可用的`City`with `id=1`，但我得到的结果是 X 倍，其中 X 是`Shops`with的数量`city_id=1`：

模型.py：

```
class Cities(models.Model):    
    name = models.CharField(max_length=128)
    slug = models.SlugField(unique=True)

class Shop(models.Model):    
    name = models.CharField(max_length=128)
    city = models.ManyToManyField(to=Cities)

class Product(models.Model):    
    title = models.CharField(max_length=128)

class Offer(models.Model):    
    product = models.ForeignKey(to=Product)
    shop = models.ManyToManyField(to=Shop) 
```

视图.py：

```
print Offer.objects.all().filter(shop__city=1) 
```

我想：
`[<Offer: Test1>]`

但我得到：
`[<Offer: Test1>, <Offer: Test1>, <Offer: Test1>]`

我的数据库中有 1条`Offer`记录和 3`Shop`条记录（同一个城市）。
你能告诉我我对多对多关系/请求的理解错误吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T19:51:01.420

由于您要在 3 个表上进行连接。它会为您返回该城市所有商店的报价结果。尝试这样做

```
Offer.objects.all().filter(shop__city=1).distinct() 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T19:51:57.947

来自[Django 文档](https://docs.djangoproject.com/en/dev/ref/models/querysets/#django.db.models.query.QuerySet.distinct)

> 默认情况下，QuerySet 不会消除重复行。在实践中，这很少会成为问题，因为像 Blog.objects.all() 这样的简单查询不会引入重复结果行的可能性。但是，如果您的查询跨越多个表，则在评估 QuerySet 时可能会得到重复的结果。那是你使用 distinct() 的时候。

您需要应用该`distinct()`方法，因此您可能需要执行以下操作：

```
print Offer.objects.all().filter(shop__city=1).distinct() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-03T19:45:46.243

试试这个，

```
 Offer.objects.filter(shop__city__id = 1).distinct() 
```

# python - matplotlib 在 Windows 上的 Python 2.7.3 中破坏 str()

> ID：14145955
> 
> 赞同：3
> 
> 时间：2013-01-03T19:39:03.810
> 
> 标签：python, windows, string, matplotlib

这是 iPython 中问题的说明。这在我尝试过的所有其他 Python shell 中都可以重现。

```
In [1]: a = 1e-6

In [2]: str(a)
Out[2]: '1e-06'

In [3]: import matplotlib as mpl

In [4]: str(a)
Out[4]: '1e-06'

In [5]: import matplotlib.pyplot as plt

In [6]: str(a)
Out[6]: '1e-06'

In [7]: plt.plot(1.0)
Out[7]: [<matplotlib.lines.Line2D at 0x262a850>]

In [8]: str(a)
Out[8]: '1e-06'

In [9]: plt.show()

In [10]: str(a)
Out[10]: 'ERR' 
```

这是相关的版本号。

```
In [11]: mpl.__version__
Out[11]: '1.2.0'

In [12]: import numpy as np

In [13]: np.__version__
Out[13]: '1.6.2' 
```

这发生在我运行 Python 2.7.3 和 Microsoft Visual Express 2008 C++ 和 Basic 的 XP Professional 实验室计算机上。我不知道如何开始追踪问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T00:52:14.313

`Enthought`现有的回答了这个问题。这不是最令人满意的解决方案，但我无法证明花费数天时间试图找出上述问题的根源是合理的。

# sonarqube - 为什么 sonar - dot net 生态系统默认测试失败？

> ID：14145960
> 
> 赞同：0
> 
> 时间：2013-01-03T19:39:29.697
> 
> 标签：sonarqube

我从[sonar .neteco 系统](https://github.com/SonarCommunity/sonar-dotnet)获得了最新的代码（zip），并在根目录上安装了 mvn。它开始构建并运行测试。当它点击 .Net 工具时：Gendarme Runner，它失败并显示“无法复制 Silverlight MScorlib.dll，因为没有现有文件。但我能够在 runner/SilverlightFolder 下找到该文件。我检查了项目的 CI 环境并它似乎一直是绿色的。我这里有什么遗漏吗？我不是 java 人，所以我不知道如何进入测试以查看它在寻找哪个目录。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T10:28:41.167

如果您不是 Java 开发人员，为什么要尝试构建 Sonar .NET 生态系统？如果您只想安装 .NET 和 C# 插件，您只需前往[文档页面](http://docs.codehaus.org/display/SONAR/C#+Plugins+Ecosystem)并按照安装程序进行操作。

# objective-c - 从包含交错键和值的数组构造 NSDictionary 的干净方法

> ID：14145961
> 
> 赞同：1
> 
> 时间：2013-01-03T19:39:32.277
> 
> 标签：objective-c, cocoa-touch, nsarray, nsdictionary

我有一组键/值...

```
NSArray *keysAndValues = @[@"1", @"one", @"2", @"two", @"3", @"three"]; 
```

将其转换为的最简单方法是什么，`NSDictionary`以便它与看起来像...的字典匹配

```
NSDictionary *dict = @{@"1" : @"two", @"2" : @"two", @"3" : @"three"}; 
```

`NSDictionary`我的代码只是循环遍历数组并提取键/值，但我想知道是否有更简洁的方法或我缺少的任何内置方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T19:45:07.813

NSDictionary 中没有内置方法可以从数组中获取备用值并将其分成两组，一组用于键，另一组用于值。

你必须做这样的事情：（这不是编译器测试的，但会给你一个想法。）

如果你想要`key = 1`并且`object = one`：

```
for(int i=0;i<keysAndValues.count;i+=2){
    [dict setObject:[keysAndValues objectAtIndex:i+1] forKey:[keysAndValues objectAtIndex:i]];
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-03T20:08:42.670

你没有错过任何东西。除了循环来执行此操作之外，没有任何真正方便的方法。当然，任何解决方案从根本上来说都是循环的，但是如果有一些内置的“过滤”或重新排列能力会很好`NSArray`（/me 谨慎地咳嗽并查看 Python 列表理解）。

[在 GitHub 上vikingosegundo 的 arraytools](https://github.com/vikingosegundo/arraytools)或其他类似的集合操作扩展中可能有一些有用的东西。编写自己的类别方法来执行此操作当然没有什么坏处，但是，就像我说的那样，那里必须有一个循环。

这是我的建议，不管它值多少钱。通过枚举来拆分数组：

```
NSMutableArray * keys = [NSMutableArray array];
NSMutableArray * values = [NSMutableArray array];
[array enumerateObjectsUsingBlock:(void (^)(id obj, NSUInteger idx, BOOL *stop)){
    if( idx % 2 ){
        [values addObject:obj];
    else {
        [keys addObject:obj];
    }
}];

NSDictionary * d = [NSDictionary dictionaryWithObjects:values forKeys:keys]; 
```

似乎应该有更好的方法来做到这一点，例如使用`NSIndexSet`and `objectsAtIndexes:`，但是没有方便的方法来创建具有非连续索引的索引集。

像这样的东西，例如，会很好：

```
@implementation NSIndexSet (WSSNonContiguous)

+ (id) WSS_indexSetWithOddIndexesInRange: (NSRange)range
{
    NSMutableIndexSet * s = [NSMutableIndexSet indexSet];

    // If the start of the range is even, start with the next number.
    NSUInteger start = range.location % 2 ? range.location : range.location + 1;
    NSUInteger upper_limit = range.location + range.length;
    for( NSUInteger i = start; i < upper_limit; i += 2 ){
        [s addIndex:i];
    }

    return s;
}

+ (id) WSS_indexSetWithEvenIndexesInRange: (NSRange)range
{
    NSMutableIndexSet * s = [NSMutableIndexSet indexSet];

    // If the start of the range is odd, start with the next number.
    NSUInteger start = range.location % 2 ? range.location + 1 : range.location;
    NSUInteger upper_limit = range.location + range.length;
    for( NSUInteger i = start; i < upper_limit; i += 2 ){
        [s addIndex:i];
    }

    return s;
}

@end 
```

使用辅助功能：

```
NSRange rangeOfNumbers(NSUInteger start, NSUInteger end)
{
    return (NSRange){start, end-start};
} 
```

这样你就可以做到这一点：

```
NSIndexSet * s = [NSIndexSet WSS_indexSetWithEvenIndexesInRange:rangeOfNumbers(0, 10)];
NSLog(@"%@", s);
// Prints: <NSMutableIndexSet: 0x7fccca4142a0>[number of indexes: 5 (in 5 ranges), indexes: (0 2 4 6 8)] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-03T20:22:27.213

> 我的代码只是循环遍历数组并提取键/值，但我想知道是否有更简洁的方法或我缺少的任何内置 NSDictionary 方法？

没有出路，你必须遍历所有的数组。

如果您正在寻找一种更清洁的方法，可能 Josh Caswell 的答案是最好的，但您仍然必须遍历数组。

使用这种方法很容易做到：

```
+ (id)dictionaryWithObjectsAndKeys:(id)firstObject , ... 
```

但不幸的是，没有直接的方法可以从数组创建 va_list。另请参阅[此问题](https://stackoverflow.com/questions/431910/is-possible-send-a-array-in-obj-c-for-a-variable-arguments-function)。

# google-app-engine - oauth2decorator_from_clientsecrets 在部署后导致开发服务器出错

> ID：14145964
> 
> 赞同：0
> 
> 时间：2013-01-03T19:39:50.020
> 
> 标签：google-app-engine, python-2.7, oauth-2.0

我在我的 Google App Engine 应用程序中使用了 Python OAuth2 装饰器。我从 API 控制台将客户端机密下载为 json 文件。将应用程序部署到 appspot.com 后，本地版本 (localhost:8080) 无法正常工作。对 decorator.has_credentials() 的调用返回 false。apppot 版本运行良好。

**更新**：代码片段（简化）

```
CLIENT_SECRETS = os.path.join(os.path.dirname(__file__), 'client_secrets.json')

oauth2_decorator = oauth2decorator_from_clientsecrets(
    CLIENT_SECRETS,
    scope='https://www.googleapis.com/auth/calendar',
    message=MISSING_CLIENT_SECRETS_MESSAGE)

class MyRequestHandler(webapp2.HandleRequest):
  @oauth2_decorator.oauth_aware
  def get(self):
    if oauth2_decorator.has_credentials():
      # do stuff...
    else:
      self.out.write("<html><body>Invalid credentials</body></html>")

app = webapp2.WSGIApplication([
    ('/', MyRequestHandler),
    (oauth2_decorator.callback_path, oauth2_decorator.callback_handler())
], debug=True) 
```

**更新 2**：这是我的 client_secrets.json 的内容，没有明智的信息

```
{"web":  
  {
    "auth_uri":"https://accounts.google.com/o/oauth2/auth",
    "client_secret":"MY_CLIENT_SECRET",
    "token_uri":"https://accounts.google.com/o/oauth2/token",
    "client_email":"MY_CLIENT_ID@developer.gserviceaccount.com",
    "redirect_uris":[
      "http://MY_APP_NAME.appspot.com",
      "http://localhost:8080"
    ],    
    "client_x509_cert_url": "https://www.googleapis.com/robot/v1/metadata/x509/MY_CLIENT_ID@developer.gserviceaccount.com",
    "client_id":"MY_CLIENT_ID.apps.googleusercontent.com",
    "auth_provider_x509_cert_url":"https://www.googleapis.com/oauth2/v1/certs",
    "javascript_origins":[
      "http://MY_APP_NAME.appspot.com",
      "http://localhost:8080"
    ]
  }
} 
```

我在本地计算机上收到“无效凭据”。在 apppot.com 中运行良好。在部署到 apppot 之前，它在我的机器上工作。

会发生什么？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-05T12:43:11.663

好吧，我太傻了。我第一次忘记向用户提供授权链接，而不是错误。

```
CLIENT_SECRETS = os.path.join(os.path.dirname(__file__), 'client_secrets.json')

oauth2_decorator = oauth2decorator_from_clientsecrets(
    CLIENT_SECRETS,
    scope='https://www.googleapis.com/auth/calendar',
    message=MISSING_CLIENT_SECRETS_MESSAGE)

class MyRequestHandler(webapp2.HandleRequest):
  @oauth2_decorator.oauth_aware
  def get(self):
    if oauth2_decorator.has_credentials():
      # do stuff...
    else:
      self.out.write(oauth2_decorator.authorize_url())

app = webapp2.WSGIApplication([
    ('/', MyRequestHandler),
    (oauth2_decorator.callback_path, oauth2_decorator.callback_handler())
], debug=True) 
```

现在它工作正常:-)。

# google-chrome - Chrome empty contenteditable retaining styling

> ID：14145970
> 
> 赞同：11
> 
> 时间：2013-01-03T19:40:37.903
> 
> 标签：google-chrome, contenteditable

Chrome appears to be doing something odd/interesting/confusing when I have a contenteditable section within a page. If you have a section of text that is wrapped with a `<span>` (maybe other tags, I dont know) that has a class applied to it that applies additional styling to the text (font family, color, etc) and then delete all the text in the editable section. When you start typing again, the text looks the same as you had when you started deleting text, but seems to be styled with the raw computed CSS, rather than having a span with the appropriate classes.

[http://jsfiddle.net/tomprogramming/wS4Gp/](http://jsfiddle.net/tomprogramming/wS4Gp/)

Any idea why this happens, or if I can turn it off? Firefox and IE both seem to keep the span with the class in it.

This is what I start with

```
<span class="level1" style="font-weight:bold;">This is level'd text</span> 
```

and this is what I end up with

```
<span style="color: rgb(255, 255, 255); font-family: helvetica, arial, sans-serif; font-size: 48.18181610107422px; font-weight: bold;">This is level'd text</span> 
```

And the relevant CSS

```
.editable .level1 {
    color: #fff;
    font-size:3em;
    font-family:helvetica, arial, sans-serif;
} 
```

I understand what's going on, it's trying to behave like Word and other processors that retain your styling; however, these levels are important in our editor and should be retained. If they can't I'd rather just turn off this "feature".

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2019-02-26T13:37:20.603

防止 Chrome 保留插入符号位置的旧计算样式的一种方法是清除浏览器选择，然后恢复它（以保留选择）。这应该在删除样式元素之后和插入新内容之前完成。执行以下操作：

```
let selection = window.getSelection();
if (selection && selection.rangeCount > 0 && selection.isCollapsed) {
  let range = selection.getRangeAt(0);
  selection.removeAllRanges();
  selection.addRange(range);
} 
```

# linux - 有没有办法只编译 POSIX API

> ID：14145972
> 
> 赞同：1
> 
> 时间：2013-01-03T19:40:43.727
> 
> 标签：linux, gcc, makefile, posix, gnu

我正在开发一个必须完全兼容 POSIX 的系统

我正在使用 gcc 和 c++ 在 Fedora Core 14 上开发它

我不想使用任何不是 POSIX 的东西

我如何确保我保持这一点？

有编译器设置吗？

我正在使用代码块

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T19:54:00.380

不，没有“神奇的编译器开关”来确保您只使用 Posix API。

您可以在此处获取 POSIX 规范：

*   [http://www.opengroup.org/onlinepubs/9699919799/toc.htm](http://www.opengroup.org/onlinepubs/9699919799/toc.htm)

*   [http://www.opengroup.org/bookstore/catalog/c082.htm](http://www.opengroup.org/bookstore/catalog/c082.htm)

该套件允许您检查您的应用程序是否符合 POSIX API：

*   [http://www.knosof.co.uk/poschk.html](http://www.knosof.co.uk/poschk.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T19:54:50.557

这实际上与编译器没有任何关系。POSIX 指定实用程序、接口和随附的头文件——编译器只关心编程语言的细节。

也就是说，如果您使用的头文件集实现良好，您应该能够使用适当的`-D`和`-U`选项来启用/禁用您正在使用的功能集`gcc`。

例如，包含`fcntl.h`将不允许访问，`fallocate()`除非`_GNU_SOURCE`已定义。使用相同的标头，您需要定义`_POSIX_C_SOURCE`to`200809L`或更大的值`F_DUPFD_CLOEXEC` [`fcntl()`](http://linux.die.net/man/2/fcntl)才能使用。

# ruby - Search for "Enabled" users in net-ldap for Ruby

> ID：14145973
> 
> 赞同：4
> 
> 时间：2013-01-03T19:40:47.627
> 
> 标签：ruby, active-directory, netldap

I am using the [net-ldap](http://net-ldap.rubyforge.org/index.html) gem to search active directory.
I can search for users by using filter:

```
filter = Net::LDAP::Filter.eq("sAMAccountName", "neil*")
filter2 = ~Net::LDAP::Filter.eq("objectclass", "computer")

joined_filter = Net::LDAP::Filter.join(filter, filter2)

ldap.search(:base => treebase, :filter => joined_filter) do |entry|
   puts entry.sAMAccountName
end 
```

This gives me all the users whose sAMAccountName starts with neil and is not a computer account.

**How do I add a filter that only searches enabled accounts?**

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-04T08:26:38.073

您可以使用 ruleOID LDAP_MATCHING_RULE_BIT_AND 规则来检查 UserAccountControl。

我使用此过滤器来查找已启用的用户：

```
(&(objectCategory=organizationalPerson)(objectClass=User)(!(userAccountControl:1.2.840.113556.1.4.803:=2))) 
```

如果帐户被禁用，userAccountControl:1.2.840.113556.1.4.803 将设置第 2 位。

[ruleOID 的值可以是以下之一：](http://support.microsoft.com/kb/269181/en-us)

•1.2.840.113556.1.4.803 - 这是 LDAP_MATCHING_RULE_BIT_AND 规则。仅当属性中的所有位都与值匹配时，匹配规则才为真。此规则类似于按位 AND 运算符。

•1.2.840.113556.1.4.804 - 这是 LDAP_MATCHING_RULE_BIT_OR 规则。如果属性中的任何位与值匹配，则匹配规则为真。此规则类似于按位 OR 运算符。

例如，当您要查询 Active Directory 以查找已禁用的用户类对象时。保存此信息的属性是 userAccountControl 属性。该属性由不同标志的组合组成。用于设置要禁用的对象的标志是 UF_ACCOUNTDISABLE，其值为 0x02（十进制 2）。使用 UF_ACCOUNTDISABLED 位集指定 userAccountControl 的按位比较过滤器将类似于：(UserAccountControl:1.2.840.113556.1.4.803:=2)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-03T19:49:23.390

有更好的方法来解决您的问题。

1.  默认情况下，所有机器帐户名称都以 结尾`$`，例如`svn$@DOMAIN.COM`.
2.  你有美妙的属性[`sAMAccountType`](http://msdn.microsoft.com/de-de/library/windows/desktop/ms679637%28v=vs.85%29.aspx)。它会告诉你这是什么类型的帐户。使用 AD 内置的二进制标志语法。
3.  启用帐户？我已经在这里回答了这个[问题](https://stackoverflow.com/a/13788077/696632)。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-12-17T15:48:28.443

Daro 关于使用 !(userAccountControl:1.2.840.113556.1.4.803:=2) 的回答是完全正确的，但我无法使用 Net::LDAP::Filter.join 方法使其与 ruby​​ net/ldap 一起使用。

然而，我确实设法用 Net::LDAP::Filter.construct 来实现它，例如

filter = Net::LDAP::Filter.construct("(&(objectClass=User)(memberOf=CN=mygroup,OU=Groups,DC=myplace)(!(userAccountControl:1.2.840.113556.1.4.803:=2 )))")

# python - Google 日历重复事件的发生时间（Python API）

> ID：14145977
> 
> 赞同：0
> 
> 时间：2013-01-03T19:41:01.973
> 
> 标签：python, google-calendar-api

在我的程序中，我使用 google-api-python-client 连接到日历 API。我通过以下方式查询未来 3 天的事件：

```
service = build(serviceName='calendar', version='v3', http=http)
events = service.events().list(
      calendarId=calendarId,
      timeMin='2013-01-04T00:00:00+01:00',
      timeMax='2013-01-06T00:00:00+01:00').execute() 
```

结果是一个事件列表，在 Python 字典中建模，大致如下（我省略了一些不必要的数据）：

```
{
     u'created': u'2012-11-26T00:54:43.000Z',
     u'description': u'abc abc',
     u'start': {u'dateTime': u'2012-11-26T08:00:00+01:00',
                u'timeZone': u'Europe/Copenhagen'},
     u'end': {u'dateTime': u'2012-11-26T10:00:00+01:00',
              u'timeZone': u'Europe/Copenhagen'},
     u'kind': u'calendar#event',
     u'recurrence': [u'RRULE:FREQ=DAILY'],
     u'sequence': 0
} 
```

上述事件是重复事件，创建于几个月前，“开始”和“结束”字段反映了创建日期。结果列表中将有该事件的多个副本，因为它在 'timeMin' 和 'timeMax' 范围之间发生了多次。

现在，问题是我没有确切发生事件的日期时间（在这种情况下应该是 2013-01-04T00:08:00+01:00）。任何人都知道我是否可以从 Google Calendar API 获得那个时间（我通过他们的 python 包使用版本 3）？

或者会建议如何在客户端实现它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T20:24:04.357

[在https://developers.google.com/google-apps/calendar/v3/reference/events/list](https://developers.google.com/google-apps/calendar/v3/reference/events/list)再次阅读文档

我发现我忽略了这一点：

> singleEvents 布尔值
> 
> > 是否将循环事件展开为实例，只返回单个一次性事件和循环事件的实例，而不返回底层循环事件本身。选修的。默认值为假。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T19:47:55.580

查看开始字段和重复字段。我会使用 Python 日期时间 API 来计算它发生的日期。

如果是每天，那么每天直到重复结束。请注意，重复字段也可以包含事件重复的次数，因此您必须计算它。如果您想了解如何计算这些东西的详细信息，我可以编写一个代码示例。请注意，datetime API 可以处理将日期添加到日期等，因此应该很容易计算。它可以计算两个日期之间的差异，因此也可以计算它已经发生的次数。

编辑：查看以下链接：

[iCal 重复格式](https://www.rfc-editor.org/rfc/rfc5545#section-3.2.13)
[日期时间文档](http://docs.python.org/2/library/datetime.html)

# android - How to prevent un-necessary GCM messages?

> ID：14145982
> 
> 赞同：0
> 
> 时间：2013-01-03T19:41:30.157
> 
> 标签：android, google-cloud-messaging

I have integrated my application with the GCM. Setup the third party server which checks whether an update needed for a device, if yes, it sends the GCM as a tickle telling the mobile application to contact the server for the fresh data.

My android application has authentication module with logon/logoff actions. And I only intend the server data synch (and so as the GCM messages) as long as user's current session is active.

But, as the [tutorial](http://developer.android.com/google/gcm/gcm.html) suggests, the Android application on an device doesn't need to be running to receive messages. The system will wake up the Android application via Intent broadcast when the message arrives.

My question is, how do I prevent the GCM messages when user is logged off or the application is shutdown?

Which one of the following seems better? can you suggest any other approach?

**Option A:**

My android application to register for the GCM once the user is successfully logged on and un-register from the GCM once the user is logged off. This will enforce my third party server to only send the GCM messages when the registration id is available. But is the register/un-register so frequently is a recommended practice?

**Option B:**

Let the android application receive the messages even during logged off or shutdown state, but the application does not react on them (i.e. just ignore them). Is this a recommended practice? Would it cost any penalty in terms of performance? Would the user notice un-necessary (annoying) wakeups of the android application?

Any help would be appreciated.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T19:57:53.907

根据我的建议，第二个是更好的选择，您可以执行从服务器收到的任何推送消息，将其更新到首选项文件（仅最后一个或 imp 一个），并在用户登录时通知他/她。

# c# - C# Splitting a specific string for specific data

> ID：14145989
> 
> 赞同：-2
> 
> 时间：2013-01-03T19:42:22.547
> 
> 标签：c#, string, split

I have this string...

```
lg-270-110.sh-300-110.hd-180-1.hr-155-61.ea-1403-62.cc-3007-110-110.ch-220-63.ca-3084-64-64 
```

The string is always changing...

How would i get the data between two certain points...

What i need really is to extract the hd-180-1\. and the hr-155-61\. and remove them from the string

But you see the data isnt always hd-180-1\. - It could be hd-171-4\. - So i need to delete the data between HD and . programatically

How would i go about doing this?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T19:49:26.133

这看起来像是正则表达式的工作

```
string s = "lg-270-110.sh-300-110.hd-180-1.hr-155-61.ea-1403-62.cc-3007-110-110.ch-220-63.ca-3084-64-64";

s = Regex.Replace(s, @"hd.*?\.", "");
s = Regex.Replace(s, @"hr.*?\.", "");
Console.WriteLine(s); 
```

[这是我最喜欢的正则表达式参考](http://www.mikesdotnetting.com/Article/46/CSharp-Regular-Expressions-Cheat-Sheet)

您还可以使用正则表达式来匹配您的模式

```
string s = "lg-270-110.sh-300-110.hd-180-1.hr-155-61.ea-1403-62.cc-3007-110-110.ch-220-63.ca-3084-64-64";

Regex r = new Regex(@"hd.*?\.");
Console.WriteLine(r.Match(s).Value); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T20:01:02.970

我在网上找到了一个有效的功能......

```
 public static string RemoveBetween(string s, string begin, string end)
            {
                Regex regex = new Regex(string.Format("{0}{1}", begin, end));
                return regex.Replace(s, string.Empty);
            } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-03T19:50:07.537

也许你也可以使用 string.split：

```
List<string> list = yourString.Split(".");
List<string> keeping = list.Where(s => !s.Contains("hd") && !s.Contains("hr"))
return String.Join(".", keeping); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-03T19:50:21.703

你可以使用正则表达式

```
string data = "lg-270-110.sh-300-110.hd-180-1.hr-155-61.ea-1403-62.cc-3007-110-110.ch-220-63.ca-3084-64-64";

//Match things that are preceded by a dot (.) (or the beginning of input)
// that begin with 'h' followed by a single letter, then dash, three digits, 
// a dash, at least one digit, followed by a period (or the end of input)
var rx = new Regex(@"(?<=(^|\.))h\w-\d{3}-\d+(\.|$)");

//Get the matching strings found
var matches = rx.Matches(data);

//Print out the matches, trimming off the dot at the end
foreach (Match match in matches)
{
    Console.WriteLine(match.Value.TrimEnd('.'));
}

//Get a new copy of the string with the matched sections removed
var result = rx.Replace(data, "").TrimEnd('.'); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-03T19:46:13.623

您可能需要结合使用[IndexOf](http://msdn.microsoft.com/en-us/library/k8b1470s.aspx)和[Substring](http://msdn.microsoft.com/en-us/library/system.string.substring%28v=vs.71%29.aspx)（或可能的正则表达式）。你真的需要理解和解释你的字符串是*如何*构造的，以便提取你想要的数据。

**IndexOf**搜索字符串。它返回字符串中第一次出现的字母。它还可以在字符串中找到子字符串。它通常用于循环结构。当什么都没有找到时，它返回负数。

**子字符串**提取字符串。它要求您指明起始索引和长度。然后它返回一个包含该范围内字符的全新字符串

```
 string data = "lg-270-110.sh-300-110.hd-180-1.hr-155-61.ea-1403-62.cc-3007-110-110.ch-220-63.ca-3084-64-64";

        int indexOf_hd = data.IndexOf("hd");
        int indexOf_fullstop = data.IndexOf(".", indexOf_hd);

        string extracteddata = data.Substring(indexOf_hd, indexOf_fullstop - indexOf_hd);

        // extracteddata = hd-180-1 
```

另请查看[IndexOf](http://www.dotnetperls.com/indexof)示例和[子字符串示例](http://www.dotnetperls.com/substring)

# ruby-on-rails - Sass, Compass and Susy in a Rails 3.2 app

> ID：14145995
> 
> 赞同：1
> 
> 时间：2013-01-03T19:43:06.923
> 
> 标签：ruby-on-rails, sass, compass-sass, susy-compass

Starting a redesign of my site which is using Rails 3.2\. I was already using Sass and Compass and for the redesign have thrown all the old styles out and want to add Susy into the mix. Just a few quick questions about how things work before I get going:

I have just added: `config.compass.preferred_syntax :sass` to my `application.rb` file in `/config`, is this correct? Is the `application.rb` file sort of substituting itself for the normal `compass.rb` config file on standard compass projects?

The line I added obviously changes the expected syntax to the sass indented one which I much prefer but it looks like that line is telling compass what syntax I like. Is compass now doing the compiling of the css and not sass? I also read in the sass docs that you can tell it what syntax you prefer, do I need to set them both? I'm just not sure what is doing what function!

I have also added `gem "susy"` into my `Gemfile`, do I need to add `config.compass.require "susy"` to `/config/application.rb`?

Also, If I want to set the fonts_dir, Compass docs state that by default for Rails apps it will default to `public/fonts` but I want to put them in `/app/assets/fonts`. Will that work?

From Compass docs:

> String The directory where the font files are kept. Standalone projects will default to /fonts. Rails projects will default to "public/fonts".

I hope people will be able to shed some light on these issues for me.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-05T16:48:42.147

不，Compass 没有进行 Sass 编译。

> Sass 是 CSS3 的扩展，它添加了嵌套规则、变量、混合、选择器继承等。Sass 生成格式良好的 CSS 并使您的样式表更易于组织和维护。

compass 所做的只是为 Sass 添加附加功能，因此您无需自己编写它们。

* * *

该行`config.sass.preferred_syntax :sass`告诉 Rails 您生成的 Sass 文件应该具有 Sass 语法 (.css.sass) 而不是 SCSS 语法 (.css.scss)。

* * *

同样不，如果您将 susy 添加到 Gemfile 并制作了`bundle install`. 您需要做的就是在您导入指南针后将其导入您的 application.css 文件中。

```
@import "compass"
@import "susy" 
```

# javascript - Find DIV width when multiple DIVs share the same ID

> ID：14145999
> 
> 赞同：0
> 
> 时间：2013-01-03T19:43:13.190
> 
> 标签：javascript, html, width

I have searched all day and can´t find an answer to my problem.

I have the folowing DIV setup:

```
<div id="MainDiv1">
    <div id="Galery1">
        <div id="Image" style="width:100px;"></div>
        <div id="Image" style="width:100px;"></div>
        <div id="Image" style="width:100px;"></div>
    </div>
</div>
<div id="MainDiv2">
    <div id="Galery2">
        <div id="Image" style="width:80px;"></div>
        <div id="Image" style="width:80px;"></div>
        <div id="Image" style="width:80px;"></div>
    </div>
</div> 
```

What I need is, with Javascript, to set a variable with the Width of any of the "Image" DIV, but only the ones in the "Galery1". Since they all have the same width any of them will work.

I have tryed:

```
DIVwidth = document.getElementById("Image"); 
```

But this always gives me back 80px, that are from the "Galery2" DIV. I assume I have to give a Path somehow to limit the search into the "Galery1" or "MainDiv1" DIVs.

I can not give unique names to the DIVs.

Any suggestions?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T20:00:09.297

首先，它将帮助您了解 id 和类之间的区别：http: [//css-tricks.com/the-difference-between-id-and-class/](http://css-tricks.com/the-difference-between-id-and-class/)

请记住，您应该将所有 Image ID 元素更改为 Image Classed 元素：

```
<div id="MainDiv1">
    <div id="Galery1">
        <div class="Image" style="width:100px;"></div>
        <div class="Image" style="width:100px;"></div>
        <div class="Image" style="width:100px;"></div>
    </div>
</div>
<div id="MainDiv2">
    <div id="Galery2">
        <div class="Image" style="width:80px;"></div>
        <div class="Image" style="width:80px;"></div>
        <div class="Image" style="width:80px;"></div>
    </div>
</div> 
```

从图库 1 中选择图像变得很简单：

`document.getElementById("Galery1").getElementsByClassName('Image')[0]`

`document.getElementById("Galery1").getElementsByClassName('Image')`将返回匹配元素的数组（具有“Image”类的元素嵌套在 ID 为“Galery1”的元素下）并`[0]`选择返回数组的第一个索引。

* * *

或者，您可以通过执行以下操作简单地选择页面上的第一个图像：`document.getElementsByClassName('Image')`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-03T19:46:20.780

ID 应该是唯一的。IE你不应该超过一个`id="Image"`

要选择第一个 div`Gallery2`试试这个：

```
document.getElementById( 'Gallery2' ).getElementsByTagName( 'div' )[0]; // <-- '0' gets first item from array 
```