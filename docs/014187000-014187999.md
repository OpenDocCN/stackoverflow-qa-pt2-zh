# StackOverflow 问答 14187000-14187999

# spring - 删除 ManyToOne 记录后发生 Spring Data JPA JpaObjectRetrievalFailureException

> ID：14187002
> 
> 赞同：6
> 
> 时间：2013-01-06T21:32:45.077
> 
> 标签：spring, hibernate, spring-mvc, spring-data-jpa

我遇到了一个问题，当我在 ManyToOne 关系的多方面删除一条记录时，它可以工作，但是在下一个数据库事务中，我得到一个异常，说找不到我刚刚删除的实体（例如，当尝试添加另一个链接时）说找不到我刚刚删除的那个）。我在数据库中验证了记录正在被删除。

我在 Hibernate 中使用 Spring MVC 和 Spring Data JPA。我有一个用户类和一个 NewsLink 类。一个用户可以有许多新闻链接，我想删除其中一个新闻链接。我只是通过构建一个简单的应用程序来学习如何自己使用 Spring 框架。所以这对我来说很新。我很感激任何帮助！

用户实体类

```
@Entity
@Table(name = "users")
public class User implements Serializable{

@Id 
@Column(name = "idusers")
@GeneratedValue(strategy = GenerationType.AUTO)     
private Long id;

....    

@OneToMany(mappedBy="user", fetch= FetchType.EAGER, cascade=CascadeType.ALL, orphanRemoval= true)
private Set<NewsLink> newsLink; 
```

NewsLink 实体类

```
@Entity
@Table(name = "news_links")
public class NewsLink implements Serializable{

@Id
@Column
@GeneratedValue(strategy = GenerationType.AUTO) 
private Long id;

@Column(insertable=false, updatable=false)
private Long idusers;   
....

@ManyToOne
@JoinColumn(name="idusers")
private User user; 
```

这是执行删除的服务类中的方法。我认为这是我做得不对的部分：

```
@Override
@Transactional
public User deleteNewsLink(int id, User user){

    Iterator<NewsLink> links = user.getNewsLink().iterator();

    while(links.hasNext()){
        NewsLink link = links.next();

        if (link.getId() == id){
            links.remove();
        }

    }

    userRepository.save(user);

    return user;
} 
```

这是我看到的例外：

```
Request processing failed; nested exception is  org.springframework.orm.jpa.JpaObjectRetrievalFailureException: Unable to find com.test.dailyemail.repository.NewsLink with id 8; nested exception is javax.persistence.EntityNotFoundException: Unable to find com.test.dailyemail.repository.NewsLink with id 8
javax.persistence.EntityNotFoundException: Unable to find com.test.dailyemail.repository.NewsLink with id 8
at org.hibernate.ejb.Ejb3Configuration$Ejb3EntityNotFoundDelegate.handleEntityNotFound(Ejb3Configuration.java:155)
at org.hibernate.event.internal.DefaultLoadEventListener.load(DefaultLoadEventListener.java:210)
at org.hibernate.event.internal.DefaultLoadEventListener.proxyOrLoad(DefaultLoadEventListener.java:260)
at org.hibernate.event.internal.DefaultLoadEventListener.onLoad(DefaultLoadEventListener.java:148)
at org.hibernate.internal.SessionImpl.fireLoad(SessionImpl.java:1078)
at org.hibernate.internal.SessionImpl.internalLoad(SessionImpl.java:1005)
at org.hibernate.type.EntityType.resolveIdentifier(EntityType.java:651)
at org.hibernate.type.EntityType.resolve(EntityType.java:471)
at org.hibernate.type.EntityType.replace(EntityType.java:328)
at org.hibernate.type.CollectionType.preserveSnapshot(CollectionType.java:581)
at org.hibernate.type.CollectionType.replaceElements(CollectionType.java:534)
at org.hibernate.type.CollectionType.replace(CollectionType.java:664)
at org.hibernate.type.TypeHelper.replace(TypeHelper.java:177)
at org.hibernate.event.internal.DefaultMergeEventListener.copyValues(DefaultMergeEventListener.java:372)
at org.hibernate.event.internal.DefaultMergeEventListener.entityIsDetached(DefaultMergeEventListener.java:309)
at org.hibernate.event.internal.DefaultMergeEventListener.onMerge(DefaultMergeEventListener.java:151)
at org.hibernate.event.internal.DefaultMergeEventListener.onMerge(DefaultMergeEventListener.java:76)
at org.hibernate.internal.SessionImpl.fireMerge(SessionImpl.java:903)
at org.hibernate.internal.SessionImpl.merge(SessionImpl.java:887)
at org.hibernate.internal.SessionImpl.merge(SessionImpl.java:891)
at org.hibernate.ejb.AbstractEntityManagerImpl.merge(AbstractEntityManagerImpl.java:879) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-06T22:44:52.873

我不确定这是否是您的问题，因为我看不到其余代码，但我认为如果您在删除 NewsLink 后仍想使用该对象，则应该返回`User`实例而不是原始用户对象`userRepository.save(user)`.

在该`save`方法的javadoc中它说：

> 保存给定的实体。使用返回的实例进行进一步的操作，因为保存操作可能已经完全改变了实体实例。

尝试这样的事情：

```
@Override
@Transactional
public User deleteNewsLink(int id, User user){

    Iterator<NewsLink> links = user.getNewsLink().iterator();

    while(links.hasNext()){
        NewsLink link = links.next();

        if (link.getId() == id){
            links.remove();
            break;
        }

    }

    return userRepository.save(user);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T22:52:25.757

尝试调用`saveAndFlush`以刷新数据库中的实体。

```
@Override
@Transactional
public User deleteNewsLink(int id, User user){

    Iterator<NewsLink> links = user.getNewsLink().iterator();

    while(links.hasNext()){
        NewsLink link = links.next();

        if (link.getId() == id){
            links.remove();
        }

    }

    userRepository.saveAndFlush(user);

    return user;
} 
```

# signalr - 通过 CDN 时未调用 signalR 客户端函数

> ID：14187003
> 
> 赞同：0
> 
> 时间：2013-01-06T21:32:52.563
> 
> 标签：signalr

我有以下JS代码

```
var chat = $.connection.MyHub;
chat.client.initChart = function (data) { 
    ... do stuff ...
} 
```

和这个集线器代码

```
public class MyHub : Hub
{
    public override Task OnConnected()
    {
        using (var conn = new SqlConnection(ConnectionString))
        {
            conn.Open();

            //Using Dapper
            var data = conn.Query("SELECT data FROM Sql").ToList();

            return Clients.Caller.initChart(data);
        }
    }

} 
```

这在我的机器（Win7Pro，IIS 7）上完美运行，但是，当我将它部署到我们的服务器（Win2008R2，iis7）时，它不会调用该`initChart`函数。我在服务器上安装了 VS，当我调试进程时，`OnConnected`事件被调用并成功完成，但客户端没有任何反应。我可以看到没有发生 JS 错误或服务器端错误。

只是为了进一步混淆，我在客户端上声明了另一个由 NServiceBus 处理程序调用的函数，这个函数每次都会被调用，我在其中放置了一个浏览器断点，我可以看到它被调用。

在我的机器上检查 signalR 日志，它使用 SSE，但在服务器上它回退到长轮询。

更新：刚刚意识到服务器位于 Akamai 的 DSD 后面，如果我不经历这个，它可以工作，但我不明白为什么它会有所作为。

第二次更新：

以下是`connect?transport=serverSentEvents&connectionId=9fce5552-4c2e-4739-93ea-501dda0a0654&connectionData=%5B%7B%22name%22%3A%22navigationtiminghub%22%7D%5D&tid=9 HTTP/1.1`调用的不同响应标头

首先，我直接调用原点时的请求：

```
HTTP/1.1 200 OK
Cache-Control: no-cache
Pragma: no-cache
Transfer-Encoding: chunked
Content-Type: text/event-stream
Expires: -1
Server: Microsoft-IIS/7.5
Date: Mon, 07 Jan 2013 01:08:26 GMT 
```

这是 Akamai 的回应。请注意，根据 wireshark，我们服务器对 Akamai 的响应与上述响应相同

```
HTTP/1.1 200 OK
Content-Type: text/event-stream
Server: Microsoft-IIS/7.5
Expires: Mon, 07 Jan 2013 01:07:23 GMT
Cache-Control: max-age=0, no-cache, no-store
Pragma: no-cache
Date: Mon, 07 Jan 2013 01:07:23 GMT
Content-Length: 486
Connection: keep-alive 
```

同样在第一个中，连接保持打开（应该如此），而在第二个中它关闭。

更新 3：这纯粹是 Akamai 问题，我们刚刚切换到 Edgecast，他们正确响应了 SSE 连接。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T09:47:59.983

您可以在上面的标题中看到这一点，因为您有一个`Content-Length`标题，而且您的响应中也缺少`Transfer-Encoding`标题。

您不能自己启用缓冲，但您可以让他们的专业服务团队为您做这件事。

这似乎修复了 Chrome 的服务器发送事件，但没有修复 IE9 的 Forever Frame。

对于 Forever Frame，这似乎是一个压缩问题。如果您从请求中删除标`Transfer-Encoding: chunked`头，则会恢复标头。`Accept-Encoding`然后 IE 工作得很好。集线器 URL 需要排除边缘的 gzip 功能。

# c++ - 手动调用析构函数总是糟糕设计的标志吗？

> ID：14187006
> 
> 赞同：90
> 
> 时间：2013-01-06T21:33:21.013
> 
> 标签：c++, coding-style, destructor

我在想：他们说如果你手动调用析构函数 - 你做错了什么。但总是这样吗？有没有反例？需要手动调用它或很难/不可能/不切实际避免它的情况？

* * *

## 回答 #1

> 赞同：117
> 
> 时间：2013-01-06T22:19:01.050

所有答案都描述了具体情况，但有一个普遍的答案：

每次只需要销毁*对象*（在 C++ 意义上）而不释放对象所在的*内存时，都显式调用 dtor。*

这通常发生在内存分配/释放与对象构造/销毁独立管理的所有情况下。在这些情况下，构造是通过在现有内存块上*放置 new发生的，而破坏是通过显式 dtor 调用发生的。*

这是原始示例：

```
{
  char buffer[sizeof(MyClass)];

  {
     MyClass* p = new(buffer)MyClass;
     p->dosomething();
     p->~MyClass();
  }
  {
     MyClass* p = new(buffer)MyClass;
     p->dosomething();
     p->~MyClass();
  }

} 
```

另一个值得注意的例子是`std::allocator`by 使用时的默认值`std::vector`：元素是在`vector`during中构造的`push_back`，但内存是按块分配的，因此它预先存在元素构造。因此，`vector::erase`必须销毁元素，但不一定会释放内存（特别是如果新的 push_back 必须很快发生......）。

这是严格的 OOP 意义上的“糟糕设计”（你应该管理对象，而不是内存：对象需要内存的事实是一个“事件”），它是“低级编程”中的“好设计”，或者在内存不足的情况下不是从默认`operator new`购买的“免费商店”中获取的。

如果它在代码周围随机发生，这是一个糟糕的设计，如果它在本地发生在专门为此目的设计的类中，这是一个好的设计。

* * *

## 回答 #2

> 赞同：102
> 
> 时间：2013-01-06T21:39:28.873

如果对象是使用 的重载形式构造的，则需要手动调用析构函数`operator new()`，除非使用 " `std::nothrow`" 重载：

```
T* t0 = new(std::nothrow) T();
delete t0; // OK: std::nothrow overload

void* buffer = malloc(sizeof(T));
T* t1 = new(buffer) T();
t1->~T(); // required: delete t1 would be wrong
free(buffer); 
```

然而，像上面显式调用析构函数那样在相当低的级别上管理内存*是*糟糕设计的标志。可能，它实际上不仅是糟糕的设计，而且是完全错误的（是的，在赋值运算符中使用显式析构函数后跟复制构造函数调用*是*一个糟糕的设计，很可能是错误的）。

在 C++ 2011 中，使用显式析构函数调用还有另一个原因：使用通用联合时，需要显式销毁当前对象，并在更改表示对象的类型时使用placement new 创建一个新对象。此外，当联合被销毁时，如果需要销毁，则需要显式调用当前对象的析构函数。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2013-01-06T21:35:44.460

不，您不应该显式调用它，因为它会被调用两次。一次用于手动调用，另一次用于声明对象的范围结束。

例如。

```
{
  Class c;
  c.~Class();
} 
```

如果你真的需要执行相同的操作，你应该有一个单独的方法。

在[特定情况下](http://www.parashift.com/c++-faq/placement-new.html)，您可能希望在具有位置的动态分配的对象上调用析构函数，`new`但这听起来并不需要。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2013-01-06T23:48:47.203

不，视情况而定，有时它是合法且**良好的**设计。

要了解为什么以及何时需要显式调用析构函数，让我们看看“new”和“delete”会发生什么。

要动态创建对象， `T* t = new T;`在后台： 1\. 分配 sizeof(T) 内存。2.调用T的构造函数初始化分配的内存。运算符 new 做了两件事：分配和初始化。

要在底层销毁对象`delete t;`： 1\. 调用 T 的析构函数。2\. 为该对象分配的内存被释放。操作符 delete 也做了两件事：销毁和释放。

一个是写构造函数来做初始化，而写析构函数来做销毁。当您显式调用析构函数时，只完成了析构，而**不是释放**。

因此，显式调用析构函数的合法用途可能是，“我只想销毁对象，但我不（或不能）释放内存分配（还）。”

一个常见的例子是为某些对象池预先分配内存，否则这些对象必须动态分配。

创建新对象时，您从预分配的池中获取内存块并执行“新放置”。完成对象后，您可能需要显式调用析构函数来完成清理工作（如果有）。但是您实际上不会像操作员 delete 那样释放内存。相反，您将块返回到池中以供重用。

* * *

## 回答 #5

> 赞同：9
> 
> 时间：2013-01-06T21:39:19.663

正如常见问题解答中所引用的，[您应该在使用 Placement new 时显式调用析构函数](http://www.parashift.com/c++-faq-lite/placement-new.html)。

> 这是您唯一一次显式调用析构函数。

我同意这很少需要。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2013-01-06T21:56:37.000

每当您需要将分配与初始化分开时，您都需要手动放置新的和显式调用析构函数。今天，它很少需要，因为我们有标准容器，但如果你必须实现某种新的容器，你会需要它。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-01-06T21:44:09.960

在某些情况下，它们是必要的：

在我处理的代码中，我在分配器中使用显式析构函数调用，我实现了简单的分配器，它使用放置新来将内存块返回到 stl 容器。在摧毁我有：

```
 void destroy (pointer p) {
    // destroy objects by calling their destructor
    p->~T();
  } 
```

在构造时：

```
 void construct (pointer p, const T& value) {
    // initialize memory with placement new
    #undef new
    ::new((PVOID)p) T(value);
  } 
```

还可以在 allocate() 中进行分配，在 deallocate() 中进行内存释放，使用平台特定的 alloc 和 dealloc 机制。此分配器用于绕过 doug lea malloc 并直接使用例如 Windows 上的 LocalAlloc。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2016-08-04T12:44:41.847

那这个呢？
如果构造函数抛出异常，则不会调用析构函数，因此我必须手动调用它以销毁在异常之前在构造函数中创建的句柄。

```
class MyClass {
  HANDLE h1,h2;
  public:
  MyClass() {
    // handles have to be created first
    h1=SomeAPIToCreateA();
    h2=SomeAPIToCreateB();        
    try {
      ...
      if(error) {
        throw MyException();
      }
    }
    catch(...) {
      this->~MyClass();
      throw;
    }
  }
  ~MyClass() {
    SomeAPIToDestroyA(h1);
    SomeAPIToDestroyB(h2);
  }
}; 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-01-14T20:27:16.420

我发现 3 次我需要这样做：

*   在 memory-mapped-io 或共享内存创建的内存中分配/释放对象
*   使用 C++ 实现给定的 C 接口时（是的，不幸的是，今天仍然会发生这种情况（因为我没有足够的影响力来改变它））
*   在实现分配器类时

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-01-06T21:36:11.240

我从来没有遇到过需要手动调用析构函数的情况。我似乎记得甚至 Stroustrup 声称这是不好的做法。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2018-06-30T09:15:14.837

找到另一个示例，您必须手动调用析构函数。假设您已经实现了一个类似变体的类，该类包含几种类型的数据之一：

```
struct Variant {
    union {
        std::string str;
        int num;
        bool b;
    };
    enum Type { Str, Int, Bool } type;
}; 
```

如果`Variant`实例持有 a `std::string`，而现在您要为联合分配不同的类型，则必须破坏第`std::string`一个。[编译器不会自动执行此操作](https://en.cppreference.com/w/cpp/language/union#Explanation)。

* * *

## 回答 #12

> 赞同：-4
> 
> 时间：2016-05-25T13:48:41.697

我还有另一种情况，我认为调用析构函数是完全合理的。

在编写“重置”类型的方法以将对象恢复到其初始状态时，调用析构函数来删除正在重置的旧数据是完全合理的。

```
class Widget
{
private: 
    char* pDataText { NULL  }; 
    int   idNumber  { 0     };

public:
    void Setup() { pDataText = new char[100]; }
    ~Widget()    { delete pDataText;          }

    void Reset()
    {
        Widget blankWidget;
        this->~Widget();     // Manually delete the current object using the dtor
        *this = blankObject; // Copy a blank object to the this-object.
    }
}; 
```

# php - 倒数计时器 PHP 错误

> ID：14187020
> 
> 赞同：0
> 
> 时间：2013-01-06T21:34:35.600
> 
> 标签：php, mysql, database, timer, countdown

我正在尝试制作一个倒数计时器，它显示产品到期前的天数，当有 0 天时，我想显示一条消息说它已过期：

```
<?php
$target =  mktime(0, 0, 0, 1, 7, 2013) ;
$today = time () ;
$difference =($target-$today) ;
$days =(int) ($difference/86400) ;
if ($today == $target)
{
print "this product has expired";
}
else
{
print "This product expires in $days days";
}
?> 
```

当您访问该页面时，它始终显示第二条消息，即使今天与目标日期相同。

如果可能的话，你能告诉我如何在不重新加载页面的情况下显示分钟和秒吗？我还想在还剩 0 天/分钟时更新 MySQL 数据库，这可能吗？不需要有开始/停止按钮。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-08-02T18:23:13.520

我想你已经得到了解决方案。但是，如果有人仍在寻找此解决方案，那么这可能会有所帮助。在这个解决方案中，我们可以分割天、小时、分钟、秒。

```
Reverse timer from javascript:

var target_date = new Date('Aug 01 2014 20:47:00').getTime();
    var days, hours, minutes, seconds;
    var countdown = document.getElementById('timeremaining');
    var countdownTimer = setInterval(function () {
        var current_date = new Date().getTime();
        var seconds_left = (target_date - current_date) / 1000;

        days = parseInt(seconds_left / 86400);
        seconds_left = seconds_left % 86400;

        hours = parseInt(seconds_left / 3600);
        seconds_left = seconds_left % 3600;
        minutes = parseInt(seconds_left / 60);
        seconds = parseInt(seconds_left % 60);

        if(days <= 0 && hours <= 0 && minutes <= 0 && seconds <= 0 )
        {
           document.getElementById('timeremaining').innerHTML = '';
           clearInterval(countdownTimer);              
        }
        else
        {       
            if(days>0)
              {
                 days= days+'d,';
              } 
              else
              {
                 days='';
              }            
            countdown.innerHTML ='( ' + days + checkTime(hours) + ':'+ checkTime(minutes) + ':' + checkTime(seconds) +' remaining)';    
        }
    }, 1000);

    function checkTime(i) {
        if (i < 10) {i = '0' + i};  
        return i;
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T21:53:44.077

这里有两个问题。首先是 $today 和 $target 都以秒为单位。

这意味着除非您在与目标完全相同的时间访问该页面，否则您不会看到该消息。

这也意味着过期后的任何时间也将起作用，这可能不是您想要的。尝试使用：

```
if($today > $target) 
```

要显示分钟和秒，您应该查看可以倒计时的javascript。

# knockout.js - 将文本输入到输入中时，淘汰订阅更新？

> ID：14187028
> 
> 赞同：0
> 
> 时间：2013-01-06T21:36:05.280
> 
> 标签：knockout.js

我有一个绑定到可观察对象的输入字段。我订阅了更改，因此我可以在他们输入数据时进行一些 ui 更改。当前，用户在输入之外单击后会调用订阅事件。有什么方法可以更改订阅，以便在用户在输入字段中输入字符时更新？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T21:40:02.917

为此有[“valueUpdate”](http://knockoutjs.com/documentation/value-binding.html)参数/“绑定”：

```
<input data-bind="value: someObservable, valueUpdate: 'afterkeydown'"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T21:40:50.243

这是我的做法。

HTML：

```
<input type="text" data-bind="value: filter, valueUpdate: 'afterkeydown'" /> 
```

JS：

```
filter = ko.observable(""); 
```

# objective-c - 天数日期格式在月末继续计数

> ID：14187029
> 
> 赞同：0
> 
> 时间：2013-01-06T21:36:05.373
> 
> 标签：objective-c, cocoa-touch, formatting, nsdateformatter

我有一个按天分隔的部分的表格视图，如下所示：

2012 年 1月 15 日 2012 年
1 月 16 日 2012 年
1 月 21 日 2012 年
1 月 30 日 2012 年
1 月 31 日 2012 年
2 月 1 日 2012 年
2 月 2 日

我正在使用以下代码：

```
UILabel * lbDayOfWeek = (UILabel *)[cell viewWithTag:1];
NSDate * date = [m_arEventsSorted objectAtIndex:section];
NSDateFormatter* theDateFormatter = [[NSDateFormatter alloc] init];
[theDateFormatter setFormatterBehavior:NSDateFormatterBehavior10_4];
[theDateFormatter setDateFormat:@"EEEE"];
NSString * weekDay =  [theDateFormatter stringFromDate:date];
lbDayOfWeek.text = weekDay;

UILabel * lbMonthDayYear = (UILabel *)[cell viewWithTag:2];
[theDateFormatter setDateFormat:@"MMM D YYYY"];
NSString * monthDayYear =  [theDateFormatter stringFromDate:date];
lbMonthDayYear.text = monthDayYear; 
```

但我的日子不会在月底重新开始。例如，我得到以下信息：

2012 年 1月 15 日 2012 年
1 月 16 日 2012 年
1 月 21 日 2012 年
1 月 30 日 2012 年
1 月 31 日 2012 年
2 月 32 日 2012 年
2 月 33 日

我不确定为什么上面的代码输出错误的日期。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T22:56:41.550

检查[格式说明符](http://www.unicode.org/reports/tr35/tr35-25.html#Date_Format_Patterns)。大写的“D”表示*一年*中的一天，当您想要*一个月*中的一天时。二月的第一天也是一年的第32天。

您的格式字符串应该是`@"MMM d yyyy"`.

（还要注意小写和大写 'y' 之间的区别。您几乎总是需要小写 - 请参阅数据格式指南中[“日期格式：固定格式”下的注释 #1。）](http://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/DataFormatting/Articles/dfDateFormatting10_4.html#//apple_ref/doc/uid/TP40002369-SW13)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T21:44:12.910

您正在寻找 NSDateFormatterMediumStyle，不要设置格式，设置样式而不是格式：

```
[theDateFormatter setDateFormat: NSDateFormatterMediumStyle]; 
```

仅当您找不到符合您需要的样式时才应使用日期格式。在这种情况下，格式为`@"MMM d, yyyy"`.

# php - 如何在不使用谷歌应用的情况下授权谷歌驱动服务账户访问谷歌账户？

> ID：14187030
> 
> 赞同：7
> 
> 时间：2013-01-06T21:36:04.543
> 
> 标签：php, google-drive-api, google-api-php-client

我想使用 Google Drive 作为我正在制作的网站的准 CMS，以便内容所有者可以使用 Google Drive 编辑他们的内容。我想使用可以访问 Google Drive 的特定用户帐户（在撰写本文时，服务帐户不能直接访问 Google Drive）并且能够与内容所有者共享文档。

通读 API 和教程后，我在委托中找到了答案：[https ://developers.google.com/drive/delegation](https://developers.google.com/drive/delegation)

我对这个过程的主要问题是该网站不是由 Google Apps 管理的，因此“将域范围的权限委派给您的服务帐户”中概述的步骤让我感到困惑 - 似乎应该可以在不使用 Google 的情况下处理这个委派应用程序，但在 Google 云端硬盘中搜索我的特定用户帐户的设置后，我似乎找不到授权模拟的能力。

我正在使用的代码片段：

```
static public function getService() {
  $key = file_get_contents(GOOGLEAPI_KEYFILE);
  $auth = new Google_AssertionCredentials(GOOGLEAPI_SERVICE_EMAIL, array(GOOGLEAPI_SCOPE), $key);
  $auth->setPrn(GOOGLEAPI_IMPERSONATION);
  self::$apiClient = new Google_Client();
  self::$apiClient->setUseObjects(true);
  self::$apiClient->setAssertionCredentials($auth);
  return new Google_DriveService(self::$apiClient);
} 
```

`GOOGLEAPI_IMPERSONATION`是特定的用户帐户，当我运行此代码时，异常状态：

> 刷新 OAuth2 令牌时出错，消息：'{ "error" : "access_denied" }

有人提供任何帮助吗？我是否误解了 oAuth 在授权方面如何工作的基本概念？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-07T21:42:52.943

服务帐户适用于两种不同的情况：

*   授权应用程序/进程使用自己的身份验证和调用服务。想想预测、云存储等服务，其中数据归应用所有。
*   在 Google Apps 域中模拟用户，域管理员可以预先授权该应用代表其域中的用户执行操作。

模拟适用于 Google Apps 域，因为管理员有一种机制可以通过控制面板为用户带外授权应用程序。当然，他们只能授权该应用访问他们管理的帐户的数据。对于不属于组织的个人用户，应用程序需要使用正常的 OAuth 流向每个用户请求授权。

我有一段时间没有测试过它，但最后我检查了是否可以将 Drive 与充当自身的服务帐户一起使用。我遇到的唯一限制是无法购买额外的配额，并且该应用程序仅限于最初的 5GB 免费存储空间。

# opencv - OpenCV 和连接网络摄像头？

> ID：14187032
> 
> 赞同：0
> 
> 时间：2013-01-06T21:36:15.467
> 
> 标签：opencv, webcam

我正在努力在[OpenCV](http://en.wikipedia.org/wiki/OpenCV)中连接我的网络摄像头。我的笔记本电脑在 Windows 7 64 位中的网络摄像头工作正常。但是如果我连接另一个网络摄像头，代码根本不起作用：

```
capWebcam = cvCaptureFromCAM(0); 
if(capWebcam == NULL) { 
    printf("error: capture is NULL \n"); 
    getchar(); 
    return(-1);
} 
```

由于没有任何网络摄像头，因此它返回消息错误。我禁用了笔记本电脑的网络摄像头，它工作正常，但我得到了黑屏。

我尝试了两个网络摄像头，分别是[罗技 HD Pro C920](http://www.logitech.com/en-us/product/hd-pro-webcam-c920)和微软的[LifeCam Cinema](https://en.wikipedia.org/wiki/LifeCam#Cinema)。这是负责获取凸轮的行：

```
CvCapture* mycapWebcam = cvCaptureFromCAM(0); 
```

我将 0 更改为另一个值 (0-10)，这是有关此结构的信息：

> CvCapture* cvCaptureFromCAM(int index)
> 
> 初始化从摄像机捕获视频。
> 
> 参数： index - 要使用的相机的索引。如果只有一个摄像头，或者使用什么摄像头无关紧要，则可以通过 -1。
> 
> 函数 cvCaptureFromCAM() 分配和初始化 CvCapture 结构，用于从摄像机读取视频流。目前在 Windows 上可以使用两种相机接口：Video for Windows (VFW) 和 Matrox Imaging Library (MIL)；Linux 上的两个：V4L 和 FireWire (IEEE1394)。
> 
> 要释放结构，请使用 ReleaseCapture。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T00:34:33.663

尝试使用不同的 API - 查看[我对 Stack Overflow 问题*OpenCV on Mac is not opening USB web camera*](https://stackoverflow.com/a/14188280/1598485)的回答。

第一帧通常是黑色的（我不知道为什么）。尝试等待一段时间并获得另一帧。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-27T18:23:51.730

如果您使用的是另一台相机，则应将 1 设置为索引：

```
capWebcam = cvCaptureFromCAM(1); 
```

# php - 选择 UNIX_TIMESTAMP() 返回奇怪的 JSON 键

> ID：14187033
> 
> 赞同：0
> 
> 时间：2013-01-06T21:36:20.637
> 
> 标签：php, javascript, mysql, json

我将 TIMESTAMP 存储在 MySQL 中，并使用类似于以下内容的查询返回它们：

```
SELECT UNIX_TIMESTAMP(field)... 
```

它可以工作，但是在使用 json_encode 返回它们时，我`key: value`显示为`"UNIX_TIMESTAMP(orders.time)":"1357453256"`. 我不确定如何在 Javascript 中使用它。

所以我的问题是，我如何让 JS 解释这个键：值对？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T21:38:22.807

给出`UNIX_TIMESTAMP`别名的结果：

```
SELECT UNIX_TIMESTAMP(field) AS field ... 
```

您生成的 JSON 应如下所示：

```
"field":"1357453256" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T21:40:47.527

您始终可以使用方括号表示法：

```
var timestamp = json.foo.bar.["UNIX_TIMESTAMP(orders.time)"]; 
```

# ruby - 尽管在文档中仅存在一次，但 Nokogiri 显示了两次相同的文本。漏洞？

> ID：14187034
> 
> 赞同：0
> 
> 时间：2013-01-06T21:36:21.607
> 
> 标签：ruby, web-scraping, nokogiri

我正在为 yahoo.finance.com 网站制作一个小型刮板。当我提出这个要求时：

```
symbol = 'AAPL'

@page = Nokogiri::HTML(open("http://finance.yahoo.com/q?s=#{symbol.upcase}&ql=1"))

def marketCap(symbol)
  @page.xpath("//*[(@id = \"yfs_j10_#{symbol.downcase}\")]").text
end

puts marketCap(symbol) 
```

它打印两次相同的结果。

“495.74B495.74B”

我查看了源代码，标签只显示一次

```
<span id="yfs_j10_f">51.74B</span> 
```

如果我使用 css 选择器，我会遇到同样的问题。

这是一个错误还是我犯了一个错误？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T21:46:01.963

```
@page.xpath("//*[(@id = \"yfs_j10_#{symbol.downcase}\")]").text 
```

不正确。

`xpath`返回一个 NodeSet，它类似于一个 Array。如果它包含两个元素`text`将同时包含它们：

```
@page.xpath("//*[(@id = \"yfs_j10_#{symbol.downcase}\")]").size
=>2 
```

相反，使用`at_xpath`来查找第一个。

```
@page.at_xpath("//*[(@id = \"yfs_j10_#{symbol.downcase}\")]").text
=> "495.74B" 
```

现在，我建议不要使用 XPath，我觉得它通常更复杂且可读性更差，我建议您使用 CSS 作为访问器：

```
@page.at("#yfs_j10_#{symbol.downcase}").text
=> "495.74B" 
```

请注意，我使用`at`了代替`at_css`or `at_xpath`。`at`感知您传递的是 XPath 还是 CSS。它是通用的，在确定使用哪个时可能会出错，但它也更容易使用。`search`代替`css`or也是如此`xpath`。它像其他两个一样返回一个 NodeSet，但会感知它应该使用哪种类型的访问器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T21:51:37.127

解决了这个问题。看起来它与另一个选择器冲突。

这解决了问题

```
def marketCap(symbol)
  @page.css("#yfi_comparison #yfs_j10_#{symbol.downcase}").text
end 
```

# c - C：使用带有 ++ / -- 的指针更新内存地址内容

> ID：14187040
> 
> 赞同：1
> 
> 时间：2013-01-06T21:36:55.070
> 
> 标签：c, pointers, memory, updating

我想知道，为什么会这样：

```
*some_var++; 
```

不做同样的事情：

```
*some_var = *some_var + 1; 
```

...是因为在第二个示例中，<*> 解引用运算符被用于两个不同的目的吗？

```
*some_var = *some_var + 1; 
```

也就是说：***some_var**的第一个实例正在设置**&some_var的内容，而*****some_var**的第二个实例正在调用**&some_var**的当前内容？...这是 C 不能用以下语句做出的区别：***some_var++;** ?

此外，是否：

```
*some_var++; 
```

做任何事，如果是，怎么办？！

感谢您的任何意见......也许是一件微不足道的事情，但我仍然很好奇。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-06T21:37:54.330

```
*some_var++; 
```

相当于

```
*(some_var++); 
```

并且不等同于：

```
(*some_var)++; 
```

`++`后缀运算符的优先级高于`*`一元运算符。

顺便说一句，由于您在语句中不使用`*`运算符的值，因此`*some_var++;`语句也等效于`some_var++;`（假设`some_var`不是指向`volatile`对象的指针）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T07:46:26.203

请参阅以下示例：

```
ex: 1

int main()
{
  char *ptr = "stackoverflow";
  *ptr++;
  printf ("%s\n", ptr);//this will print "tackoverflow" i.e pointr is incremented.
  return 0;
}

ex:2

int main()
{
   char *ptr = "stackoverflow";
   *ptr = *ptr + 1;// here you are trying to assing incremented content to *ptr, but this will give you error because string literal "stackoverflow" is stored in the read only memory so you can't modify .
} 
```

# ms-access-2010 - 设置文本框默认值查询结果

> ID：14187042
> 
> 赞同：5
> 
> 时间：2013-01-06T21:37:08.130
> 
> 标签：ms-access-2010

相当简单的问题。我有一个表单中的文本字段，我希望将默认值设置为查询结果。此特定查询返回我在 Access 中设置的小型发票系统的默认税率。

查询 (qrySettingsDefaultTaxRate) 如下所示，并返回一行，其中包含我想以这种形式设置为默认值的十进制税率：

```
SELECT CDbl([value]) AS default_tax_rate
FROM settings
WHERE (((settings.key_name)="default_tax_rate")); 
```

我尝试将我的文本字段的默认值设置为：

```
=[qrySettingsDefaultTaxRate]![default_tax_rate] 
```

然而这并没有奏效。当我返回表单视图时，该框会显示“ **#Name？** ”作为默认值，而不是返回查询结果。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-06T21:49:26.003

您可以将文本框的控制源设置为[DLookup](https://support.office.com/en-us/article/DLookup-Function-8896CB03-E31F-45D1-86DB-BED10DCA5937)，或在代码中将值设置为 DLookup 。

```
DlookUp("default_tax_rate","qrySettingsDefaultTaxRate") 
```

或者

```
DlookUp("default_tax_rate","settings","settings.key_name='default_tax_rate'") 
```

您甚至可以将 DLookUp 放在默认值下的属性表上。

![Dlookup 默认值](../Images/bb202cdbf58a61c1531a69a4b1d8483a.png)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-08-16T09:57:22.537

我有一个类似的问题。这对我有用 - 我编写了一个函数，它返回我想设置为默认值的值，并以表单的默认值指定函数。

我的代码：

```
Public Function MaxTDate()
    MaxTDate = CurrentDb.OpenRecordset("MaxTDateQry").Fields(0)
End Function 
```

...在字段属性中：

默认值 =MaxTDate()

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-11-06T03:19:04.347

尽管现在答案已经打勾，因为在某些情况下正确答案就足够了。

可能存在默认值来自表达式、外部文件、用户输入或任何其他计算的情况。

Microsoft Access 抛出#Name 的原因是什么？错误是因为它希望字符串数据用撇号引用“。同时还说，如果字符串本身包含撇号，它也需要转义。想想php中的addlashes。

所以给一个特定的变量 DefValue，

```
Dim DefValue
DefValue = "This is a static string or result from database query or other computation"
TextBox.DefaultValue = """" & Replace(DefValue, """", """""") & """" 
```

所以，在你的情况下，它将是`"""" & Replace([qrySettingsDefaultTaxRate]![default_tax_rate], """", """""") & """"`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-07-09T10:21:30.810

Fionnuala 的答案在第二部分中包含错误。不幸的是，我的编辑被拒绝了两次，所以现在我将其作为单独的回复发布。它需要如下：

```
DLookUp("value","settings","settings.key_name='default_tax_rate'") 
```

原因是在原始 Table`settings`中调用了该列`value`，而`default_tax_rate`仅在`qrySettingsDefaultTaxRate`基于 的查询中创建了该列`settings`。

# mysql - MySQL 查询以在数据库中搜索与给定产品名称相似的产品

> ID：14187044
> 
> 赞同：2
> 
> 时间：2013-01-06T21:37:14.287
> 
> 标签：mysql, sql-like

我已经研究了 Levenschein 函数以及其他解决方案，但我认为我想要做的事情可以通过一个查询来完成。我编写了一个函数来删除常见的停用词，然后我将重要的单词放入一个数组中以在查询中使用。这是我到目前为止所拥有的。

```
$title = removecommonwords($itemtitle);
$title = explode (" ", $title);

$comparequery = mysql_query("SELECT * FROM listings WHERE (CONCAT(title, description) LIKE '%".$title."%') LIMIT 0,5 ORDER BY ...); 
```

我怎样才能按最接近的匹配排序结果？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T21:43:15.483

如果您修复了您现在有一个数组的 like 子句，这应该适用于您的搜索，但请注意，您将进行全表扫描，因为 CONCAT() 会破坏标题或描述中存在的任何索引的好处。

`explode()`创建一个数组。您要么想`implode()`创建一个字符串，要么需要 \ 遍历 $title 数组并调用每个值的查询......你不能将这样的数组粘贴到这样的 like 子句中。

Mysql 无法按照like 子句中匹配程度的百分比进行本地排序。

# r - 清理变量并关闭连接

> ID：14187048
> 
> 赞同：28
> 
> 时间：2013-01-06T21:37:38.507
> 
> 标签：r, reset

我想知道 R 中是否有任何指令可以清除所有已初始化的变量并关闭所有打开的连接。就像某种*重置*功能一样。

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2013-01-06T21:45:49.073

```
closeAllConnections()
rm(list=ls()) 
```

我讨厌第二个构造，因为人们有时会将它偷偷带入示例代码中，当我错过它并将其复制粘贴到我的控制台时，然后我的整个工作空间就被清除了。真正的大师不会犯这个错误，因为他们总是有多个 emacs 窗口，并且总是从编辑窗口和所有其他“明智的事情”构建包和运行代码。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-01-06T21:45:30.300

您可以使用`remove()`删除变量。例如：

```
remove('variabl1','variable2','etc') 
```

不确定连接，但假设您指的是您打开的数据库连接以通过例如 ODBC 加载数据？我会假设提供包的包也有关于如何关闭连接的文档（如果需要或好的做法 - 因此不会自动完成）。

# c# - 如何组织将要为多个平台构建的类库项目的源代码？

> ID：14187053
> 
> 赞同：3
> 
> 时间：2013-01-06T21:38:11.677
> 
> 标签：c#, visual-studio, projects-and-solutions, code-organization

我正在开发一个类库项目，该项目为客户端应用程序提供了许多有用的扩展方法。该项目预计将用于各种平台（.NET 框架的版本）。

为此，我将使用几个单独的 Visual Studio 项目，每个项目用于自己的平台。这些项目可以有自己的外部依赖项，尽管源代码将使用“添加为引用”功能在它们之间共享。这种方法将允许我通过在一个文件中编写代码来更改所有项目的实现，而无需将其复制到其他项目。记住目标框架的差异，我需要使用`#if`编译器指令。每个项目的结果将作为特定版本的 .NET 框架的 NuGet 包发布。

**这是我有两个问题：**

1.  每个新文件都必须添加到每个项目中，否则将无法编译，并且其中定义的每个类都无法在某些平台上访问。你可以意识到很容易忘记这一点。有没有办法避免这种文件跟踪？有可能实现自动化吗？
2.  我怎样才能改善整个基础设施？您在项目中使用了哪些方法和/或解决方案？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-06T21:42:51.403

> 为此，我将使用几个单独的 Visual Studio 项目，每个项目用于自己的平台。

你不需要这样做。同一个项目可以有多个配置。您需要通过编辑项目文件来处理它，但您只需执行一次（或至少，每次需要添加新平台时执行一次）。使用在每个项目配置中定义的条件编译符号允许您在每个构建配置中排除某些源代码位。

我之前做过几次，这是我用来允许在[Noda Time](http://noda-time.googlecode.com)中构建 PCL 的方法。我最终得到了 6 种配置：

*   调试
*   调试 PCL
*   释放
*   发布 PCL
*   签名发布
*   签名发布 PCL

显然，您的需求可能会有所不同（尤其是在签名方面），但它现在对我们来说工作得很好——而且我认为这比手动保持多个项目文件同步要好得多。

另一种选择是为每个平台提供一个“骨架”项目文件和一个“主”项目文件，并为除主平台之外的所有平台生成真正的项目文件。因此，您需要将新的源文件引用添加到主项目文件中，然后重新生成所有其他文件。这确实意味着编写代码来做到这一点，请注意……或使用我们用于[protobuf-csharp-port](http://protobuf-csharp-port.googlecode.com)的项目：[csprojectprojector](http://code.google.com/p/csprojectprojector/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-14T06:11:24.877

另一种方法是使用通配符，而不是在项目中包含单个文件。这也需要手动编辑您的项目文件，但这将是一项一次性任务。我从来没有使用过这种方法，但我看到其他人提到过。

[http://msdn.microsoft.com/en-us/library/ms171454(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/ms171454(v=vs.100).aspx)

# ocaml - OCaml 解析器代码

> ID：14187054
> 
> 赞同：2
> 
> 时间：2013-01-06T21:38:15.753
> 
> 标签：ocaml, ocamlyacc

我的代码：

```
Term :
...
| VAR { try Hashtbl.find var_table $1
         with Not_found ->
      printf "no such variable '%s'\n" $1; 0.0 }    /*(Line:75)*/
... 
```

当我运行它时， `ocamlc -c parser.ml`我看到：

```
Error: This expression has type float but an expression was expected of type
         Syntax.term 
```

大家可以帮我证明这个问题吗？我知道第 75 行的类型与 Syntax.ml 和 Syntax.mll 中定义的类型 Syntax.term 不匹配，但我想将类型 0.0 指定给 Syntax.term 来证明这一点。我可以做吗？？

- - - - - - - - - - 编辑 - - - - - - - - - ：

术语类型：

```
type term =
    TmTrue
  | TmFalse
  | TmIf of term * term * term
  | TmAnd of term * term
  | TmOr of term * term
  | TmXor of term * term
  | TmSum of term * term
  | TmSub of term * term
  | TmMult of term * term
  | TmPow of term * term
  | TmZero
  | TmSucc of term
  | TmPred of term
  | TmIsZero of term
  | TmNot of term 
```

每件事都正常工作，我想在我的代码中添加分配，我使用上面的代码将 VAR 添加到 Term。我为它创建了哈希表和其他东西，但这部分让我感到困惑......

- - - - - - - - - - - /编辑 - - - - - - - - - - - -

tnx ;)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T22:22:46.503

您没有可以表示值 0.0 的术语。也许你应该使用`TmZero`？

# perl - 无需我询问即可设置对象属性

> ID：14187057
> 
> 赞同：1
> 
> 时间：2013-01-06T21:38:20.690
> 
> 标签：perl, oop, object, moose

我正在使用[`Moose`](http://search.cpan.org/~doy/Moose-2.0604/lib/Moose.pm)，也许它很重要，也许它不重要。

我的对象以 形式出现`$event`，我将`args`属性值保存到变量中：

```
my $args = $event->args; 
```

该值恰好是一个散列，所以我对散列做了一些处理，特别是添加了一个新元素：

```
$$args{id} = 4; 
```

这是我不明白的，当我回去查看我的`$event`对象时，它里面保存了新的哈希元素！我将它设置为一个完全不同的变量，而不是对象，那么为什么对象会接收它呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T00:04:10.910

如果你想获得一点进步，而不是做

```
has 'args' => (
  is => 'rw',
  isa => 'HashRef',
); 
```

或者无论你通常做什么，你都可以做类似的事情

```
has '_args' => (
  is => 'ro',
  isa => 'HashRef',
  default => sub { +{} },
  traits => ['Hash'],
  handles => {
    args => 'kv', # or args => 'shallow_clone'
    set_arg => 'set',
    get_arg => 'get',
    clear_arg => 'delete',
  },
); 
```

现在，args 仍然作为 hashref 存储在对象中，但它存储在名为 的私有属性中`_args`，并且您使用其他方法来访问它，例如`my %args = $event->args`（如果您使用过`kv`）或`my $args = $event->args`（如果您使用过`shallow_clone`，您会得到一个 hashref，但它仍然是一个副本）`$event->set_arg("foo" => "bar"); my $value = $event->get_arg("foo")`等。这完全是可选的，如果您不理解它应该跳过它，但它可以帮助您构建一个更加正交的接口并隐藏用户的实现细节。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-06T21:45:27.583

驼鹿无所谓。`$event->args`返回您的哈希引用，因此您的副本并`$event->args`指向相同的哈希。当您添加一个键时，它将被添加，因此它在两个引用中都可见。

为避免这种情况，您可以复制由以下内容返回的哈希`args`：

```
my $args = {%{$event->args}}; 
```

复制后，您将获得对新哈希的引用，因此`$args`成为对复制的引用，无需更改其他代码。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-06T21:45:20.997

你得到`$event->args`的不是散列，而是散列*引用。*也就是说，它是一个指向散列的指针，`args`对象中的属性也指向该散列。当您说`$$args{id} = 4`（或`$args->{id} = 4`等效的）时，您正在更改`$args`指向的哈希中的值。由于指向该哈希的指针也存储在您的对象中，因此更改也会反映在那里。

如果您想在`$args`不影响对象的情况下更改内容，可以制作哈希的副本：

```
my %args = %{ $event->args }; 
```

# php - 查询数据库中给定数组中的列值

> ID：14187060
> 
> 赞同：0
> 
> 时间：2013-01-06T21:38:45.270
> 
> 标签：php, mysql, sql

我正在尝试在我的数据库中的表中查询 home_team 和 away_team 列都包含数组中的值的行。然而，没有这样的运气。我的代码如下。

```
$new_array = array();

for($i=0;$i<count($ncaa);$i++)
{
//  Since some of the values in this array contain apostrophes, escape each value 
$new_array[$i] = mysql_real_escape_string($ncaa[$i]);   
}

$list = join(",", $new_array);
$query = "SELECT * 
     FROM ncaa_games
     WHERE game_date_int >= '".$limit."' 
     AND (home_team = '".mysql_real_escape_string($team)."' OR away_team = '".mysql_real_escape_string($team)."') 
     AND home_team IN (".$list.")
     AND away_team IN (".$list.")
     ORDER BY game_date_int ASC 
     LIMIT 1";

$next = mysql_query($query)or die(mysql_error()); 
```

我不断收到一条错误消息：“您的 SQL 语法有错误；请查看与您的 MySQL 服务器版本相对应的手册，以了解在“UTSA Roadrunners”附近使用的正确语法）和 away_team IN（奥尔巴尼大丹犬，宾厄姆顿熊'在第 5 行"

我有一种感觉，这可能是相当简单的事情。但是，它仍然设法躲避我。有任何想法吗？

谢谢，

槊

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T21:43:21.633

```
$list = join(",", $new_array); 
```

不会用引号将团队括起来。即你有：

```
away_team IN (Albany Great Danes,Binghamton Bears) 
```

当这应该是：

```
away_team IN ('Albany Great Danes','Binghamton Bears') 
```

尝试使用： $list = join("','", $new_array); 并具有：

```
 AND home_team IN ('".$list."')
 AND away_team IN ('".$list."') 
```

（确保`$list`不为空）。

# javascript - 使用 Jquery 获取输入复选框切换状态

> ID：14187061
> 
> 赞同：1
> 
> 时间：2013-01-06T21:38:47.620
> 
> 标签：javascript, jquery, checkbox

我希望每当您单击复选框时，都会在控制台上打印一个与复选框 ( `on`/ `off`) 状态相对应的值。我知道有类似标题的线程，但我见过的所有线程都没有明确的例子。

这是我到目前为止得到的（打开`Console`并单击`Add library`, `JQuery1.8.3`）：

[尝试 1](http://jsbin.com/urodit/111/edit)

这只在页面加载时打印，我希望它在我点击它时打印。

[尝试 2](http://jsbin.com/urodit/112/edit)

每当我单击复选框时，此代码段都会切换打开和关闭值，但打开时该框不再显示刻度符号。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-06T21:41:27.627

监听更改事件。

```
$("#box").change(function(){  
    console.log(this.checked); 
    // console.log( this.checked ? 'on' : 'off' ); 
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-06T21:42:20.990

```
$("#box").change(function() {
  console.log($(this).prop('checked'));
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-06T21:44:09.847

这很简单，您需要在点击事件中使用 .val() 。这是代码：

```
$('input[type="checkbox"]').click(function() {
    if( $(this).is(':checked') ) {
        console.log( $(this).val() );
    } else {
        console.log('no');
    }
}); 
```

这是一个工作[演示](http://jsfiddle.net/atomicpages/F4yaU/)。希望这可以帮助！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-06T21:43:06.607

你可以这样做：

```
$('#box').click(function()
{
    if ($('#box').is(':checked')){ 
        console.log("on"); 
    }else{ 
        console.log("off");
    }
}); 
```

# javascript - 使用 Backbone.JS 在服务器和客户端之间共享常量的最佳实践

> ID：14187064
> 
> 赞同：15
> 
> 时间：2013-01-06T21:38:57.220
> 
> 标签：javascript, backbone.js

使用 Backbone.JS 处理服务器代码和客户端代码之间共享常量的最佳方法是什么？例如，假设我有这张用户角色地图：

```
user_roles = {
  1 => "member", 
  2 => "moderator", 
  3 => "admin"} 
```

显然，如果您在客户端和服务器端的代码中复制这些定义，这将不能很好地扩展并且容易出错。

我能想出的解决方案只是将这些定义公开为 Backbone.Collection 或 Backbone.Model 并从服务器获取它们，但是如果您有大量常量类型，这可能会导致不必要的开销，我不确定它们是否真的属于模型内部。

解决这个问题有哪些不同的解决方案，它们的规模如何？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-07T21:18:49.340

我尝试了几种不同的方法来处理这个问题。我不知道它们中的任何一个是否是**最好**的方法，但它们都对我来说效果很好，所以我将在这里描述它们，希望它们对我有所帮助。

两者的核心概念是相同的：常量在服务器端语言（在我的例子中是 C# 和 Java）中被定义为**真正**的常量，并且为了客户端的利益被转换为 JSON 或 javascript。我认为这是要走的路，而不是共享单个 JSON/YML/等。配置文件。仅仅因为 javascript 没有真正的常量并不意味着你的服务器也不应该有它们。

**选项 1：通过 Web 服务调用在运行时加载常量和枚举。**

创建一个服务端点（我们称之为`/enums`），它基本上将所有服务器端枚举和常量收集到一大堆 JSON 中。为了避免额外的服务调用，如果您还使用一些服务器端模板框架，您可以将其引导到您的`index.html`.

如果您不想将任何内容引导到静态内容，则可以进行其他优化。由于常量很少更改，因此您可以将`/enums`响应包装到包含服务器应用程序构建版本的包装器对象中。例如：

```
{
  "version": "1.2.1.0",
  "enums": { ... }
} 
```

当用户第一次点击页面时，请求`GET /enums`，并将整个响应存储到浏览器的本地存储中。在随后的访问中，从本地存储中读取常量并使用`GET /enums?v=1.2.1.0`. 服务器应该将它的版本与传递的版本进行比较，如果它们相同，它只会返回`HTTP 200 OK`以向客户端表明它的枚举仍然有效。

如果您在前端和后端开发人员使用不同工具或通常不紧密合作的分布式环境中工作，则此选项非常有用。

**选项 2：在构建过程中共享常量**

您可以使用文本转换模板（例如[T4](http://msdn.microsoft.com/en-us/library/bb126445.aspx)）从服务器端语言源生成 javascript 代码。就我而言，这是 C#。

我将所有服务器端枚举存储在一个目录中，并运行了一个构建任务，该任务将该目录中的所有 C# 源文件转换为 javascript 对象，并将它们组合成`enums.js`客户端源树中的一个文件。

我发现这是一个更可取的选择，但是如果客户端和服务器开发没有同步完成（一起构建，一起发布），依赖管理可能会变得非常混乱。就我而言，我总是将客户端和服务器都部署在一起，所以效果很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T21:45:45.003

如果您的后端不在 JavaScript 中，请使用您的常量生成一个 JavaScript 或 JSON 文件，然后将其包含在客户端构建中或将它们注入到您的初始 HTML 模板中。我有时会使用 Django 配置设置或使用 yaml 文件中的设置来执行此操作：yaml -> python、yaml -> js 或只是 JSON。

我不知道为常量使用所有额外的主干模型逻辑是否有意义。

另一方面，这是我喜欢meteor.js 的一个很好的理由。完全不用担心这种事情，因为您可以轻松地在服务器和客户端之间共享常量。:)

# perl - 匹配后第一次出现字符串 perl

> ID：14187072
> 
> 赞同：0
> 
> 时间：2013-01-06T21:40:26.280
> 
> 标签：perl

我正在用 perl 解析一个 pcap 文件。我有请求和回应。我想找到所有未完成的交易（请求没有响应）。我的请求看起来像 ReqInfo、ReqData、ReqMsg 和响应 RespInfo、RespData、RespMsg。我已经完成了 Req 和 Resp 的基本计数。请求数比响应数大 1。它是大文件，无法确定错过了哪个请求。我只管理过

```
perl -lne 'END {print $c} map ++$c, /ReqInfo/g' file.pcap 
```

请求和响应由 transactionID 绑定。我计划在每次成功的 ReqInfo 后将 transactionID 添加到数组中，并在每次 RespInfo 匹配后从数组中删除 transactionID。在整个搜索之后，我希望该数组包含所有孤立事务 ID 的列表。因为它是 pcap 文件，所以没有带分隔符的规则。我可以在单行中有一堆 Req，也可以在单独的行中有每个 Req，或者在多行中有碎片数据

我正在寻找在 ReqInfo 之后找到第一次出现 transactionID 的方法。我可以在单行中拥有一堆 ReqInfo，或者在单独的行中拥有每个 ReqInfo，或者在多行中拥有碎片数据

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T22:06:46.997

找到请求后，

```
++$c{$tran_id} 
```

找到回复后，

```
--$c{$tran_id} 
```

*   任何具有相同数量的请求和响应的事务都将得分为零。
*   任何缺少响应的交易最终都会得到正分。
*   任何缺少请求的事务都会以负分结束。

# iphone - iOS自定义表格视图单元格在编辑模式下调整大小

> ID：14187073
> 
> 赞同：3
> 
> 时间：2013-01-06T21:40:32.637
> 
> 标签：iphone, ios, xcode, tableview

编辑`UITableView`圆形红色按钮时，删除按钮与自定义单元格重叠。

我们如何调整自定义单元格的大小以便为红色圆形按钮和删除按钮留出空间。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T03:43:34.490

使用此代码，您可以根据编辑单元格的方式和所处的阶段执行不同的任务。我对代码进行了大量注释，因为我自己花了很长时间才弄清楚这一点。（变得混乱）

```
 - (void)willTransitionToState:(UITableViewCellStateMask)state {

        [super willTransitionToState:state];

        if (state == UITableViewCellStateDefaultMask) {

            NSLog(@"Default");
            // When the cell returns to normal (not editing)
            // Do something...

        } else if ((state & UITableViewCellStateShowingEditControlMask) && (state & UITableViewCellStateShowingDeleteConfirmationMask)) {

            NSLog(@"Edit Control + Delete Button");
            // When the cell goes from Showing-the-Edit-Control (-) to Showing-the-Edit-Control (-) AND the Delete Button [Delete]
            // !!! It's important to have this BEFORE just showing the Edit Control because the edit control applies to both cases.!!!
            // Do something...

        } else if (state & UITableViewCellStateShowingEditControlMask) {

            NSLog(@"Edit Control Only");
            // When the cell goes into edit mode and Shows-the-Edit-Control (-)
            // Do something...

        } else if (state == UITableViewCellStateShowingDeleteConfirmationMask) {

            NSLog(@"Swipe to Delete [Delete] button only");
            // When the user swipes a row to delete without using the edit button.
            // Do something...
        }
    } 
```

你说你添加了自定义标签和什么没有，我之前在使用 tableviews 时也做过同样的事情。我通常更喜欢使用动画块“隐藏”重叠的视图，例如：

```
[UIView animateWithDuration:0.3

                        animations:^ {
                            self.myTableCellSubview.alpha = 0.0f;
                        }
        ]; 
```

在上面的每个 if 语句中，并根据状态将 alpha 从 1.0f 更改为 0.0f。

至于一般缩进，在属性检查器中，确保选中“编辑时缩进”，您也可以通过以下方式以编程方式设置：

```
cell.shouldIndentWhileEditing = YES; 
```

如果这不起作用，您的自动调整大小可能会有些古怪。在故事板或 xib 中，选择需要缩进的单元格子视图，然后转到大小检查器（标尺选项卡）。如果子视图需要从左侧缩进（ ---> ），请确保将其固定在左侧：

![在此处输入图像描述](../Images/2d9598f9f4ba3497be56d82409f15bf0.png)

如果子视图需要从右侧缩进（ <--- ），请确保将其固定在右侧：

![在此处输入图像描述](../Images/980494e9e48039d68a1d4d278d28e9c1.png)

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T21:53:59.443

您可以覆盖我认为的其中一种方法并调整自定义单元格的大小。不过，不确定这正是您根据问题提出的问题。

```
- (void)willTransitionToState:(UITableViewCellStateMask)state
- (void)didTransitionToState:(UITableViewCellStateMask)state 
```

# android - ListView onListItemClick 无法正常运行

> ID：14187078
> 
> 赞同：0
> 
> 时间：2013-01-06T21:40:53.517
> 
> 标签：android, listview, toast

我有一个项目列表视图。当我单击一个项目时，我想显示一条简单的 toast 消息以通知用户单击的项目。但是由于某种原因，下面的代码对我不起作用：

当前项目的代码： - 不工作。

```
@Override
protected void onListItemClick(ListView l, View v, int position, long id) {
    Toast.makeText(getApplicationContext(), l.getItemAtPosition(position).toString() + " added to order", Toast.LENGTH_SHORT).show();
} 
```

这很奇怪，因为它过去一直有效。列表中的每一项都包含一个 ImageView、两个 TextView、一个 Button 和一个 NumberPicker 小部件。它们都正常运行，但由于某种原因，onListItemClick() 代码未执行。

关于为什么的任何想法？非常感谢！

编辑：我刚刚检查了一个较旧的项目，我使用了类似的代码，对其进行了测试并且工作正常，我无法弄清楚为什么我会遇到这个问题，这与视图的复杂性有关吗？

以下是以前项目的代码： - 工作正常。

```
@Override
protected void onListItemClick(ListView l, View v, int position, long id) {
    Toast.makeText(getApplicationContext(), l.getItemAtPosition(position).toString() + " added to order", Toast.LENGTH_SHORT).show();
    // add clicked item to orderData....
    MenuItem m = (MenuItem) l.getItemAtPosition(position);
    // create new item
    orderData.add(m);
    subTotal += m.getPrice();
    calc();
} 
```

编辑：适配器类的 getView() 方法

```
public View getView(final int position, View convertView, ViewGroup parent){
    View v = convertView;

    if(v == null){
        LayoutInflater vi = (LayoutInflater) getContext().getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        v = vi.inflate(R.layout.menuitem_row, null);
    }

    //assign values to view
    final MenuItem item = this.menuItems.get(position);

    TextView nameView = (TextView) v.findViewById(R.id.item_name);
    final TextView priceView = (TextView) v.findViewById(R.id.item_price);

    nameView.setText(item.getName() + " ");
    priceView.setText("€"+ String.valueOf(item.getPrice()));

    //number picker
    np = (NumberPicker)v.findViewById(R.id.numpick);
    np.setMaxValue(99);
    np.setMinValue(0);
    np.setValue(0);

    //calculation occurs when values are changed...
    np.setOnValueChangedListener( new OnValueChangeListener() {
          public void onValueChange(NumberPicker picker, int oldVal, int newVal) {
                Toast.makeText(picker.getContext(), "dish: " + item.getName() + " amount: " + picker.getValue(), Toast.LENGTH_SHORT).show();
                Toast.makeText(picker.getContext(), "new Value: " + newVal + " old Value: " + oldVal, Toast.LENGTH_SHORT).show();

               // amount += item.getPrice() * picker.getValue();

                if(newVal > oldVal){
                    total = (item.getPrice() * newVal) - item.getPrice() * oldVal;
                    amount += total;
                }

                if(newVal < oldVal){
                    total = (item.getPrice() * oldVal) - item.getPrice() * newVal;
                    amount -= total;
                }

                price.setText("€" + String.valueOf(amount));
            }
          });

    return v;

} 
```

Menu_item_row.xml 文件：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:paddingBottom="20dp"
    android:paddingTop="20dp"
    android:orientation="horizontal" >

    <NumberPicker
        android:id="@+id/numpick"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentRight="true"
        android:layout_alignParentTop="true" />

    <ImageView
        android:id="@+id/dishpic"
        android:layout_width="140dp"
        android:layout_height="150dp"
        android:layout_alignBottom="@+id/numpick"
        android:layout_alignParentLeft="true"
        android:layout_alignParentTop="true"
        android:src="@drawable/ic_launcher" />

    <TextView
        android:id="@+id/item_name"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/reviewBtn"
        android:layout_alignParentTop="true"
        android:layout_alignRight="@+id/item_price"
        android:text="ITEM NAME"
        android:textSize="30sp" />

    <TextView
        android:id="@+id/item_price"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignRight="@+id/reviewBtn"
        android:layout_below="@+id/item_name"
        android:layout_marginTop="17dp"
        android:layout_toRightOf="@+id/dishpic"
        android:text="ITEM PRICE"
        android:textSize="40sp" />

    <Button
        android:id="@+id/reviewBtn"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_alignBottom="@+id/dishpic"
        android:layout_toLeftOf="@+id/numpick"
        android:layout_toRightOf="@+id/dishpic"
        android:text="@string/reviewBtn" />

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T23:13:03.190

尝试`Button`和`NumberPicker`呼入`setFocus(false)`_`getView()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T04:28:02.583

试试这个。

只需从 listRow 中删除 Button 和 NumberPicker 并查看其是否正常工作。如果它正在工作，那么该行为应该是因为视图。

在存在 Button 和 NumberPicker 的情况下，您无法单击 ListviewItem，这就是您没有得到任何 toast 的原因。

所以，请尝试一下并告诉我。

随时发表任何评论。

# php - CodeIgniter 的子目录问题

> ID：14187079
> 
> 赞同：2
> 
> 时间：2013-01-06T21:40:57.297
> 
> 标签：php, codeigniter, directory, codeigniter-2

我在主域 (domain.com) 上安装了 CodeIgniter 应用程序。现在我想使用一个博客目录 (domain.com/blog/)，我想在其中安装一个 WordPress 驱动的博客。但问题是我创建了一个名为博客的目录，但是当我尝试通过键入 domain.com/blog/ 访问它时，我得到 CodeIgniter 404 not fount page。我对 CodeIgniter 很陌生，所以我一定在这里遗漏了一些东西。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-06T21:46:33.383

假设您要从 URL`.htaccess`中删除`index.php`，您应该`.htaccess`在项目的根目录中有一个类似这样的内容：

```
RewriteCond $1 !^(index\.php|robots\.txt|css|images)
RewriteRule ^(.*)$ index.php/$1 [L] 
```

它基本上是在说“将所有请求发送到，`index.php/$request`除非它们以`index.php`, `robots.txt`, `css`, or开头`images`。

这样您就不必使用像`http://example.com/index.php/controller/method`.

只需添加`blog`：

```
RewriteCond $1 !^(index\.php|robots\.txt|css|images|blog)
RewriteRule ^(.*)$ index.php/$1 [L] 
```

# php - 如何计算5天（mysql）酒店预订系统的总价

> ID：14187081
> 
> 赞同：0
> 
> 时间：2013-01-06T21:41:02.787
> 
> 标签：php, mysql, sql, phpmyadmin

我有这张表是不同季节（旺季、淡季）房间的价格

如何在不同的日子和不同的季节获得 5 天的总价..

看看这张表

![在此处输入图像描述](../Images/444ac9518607d82d8711088779a6f1f4.png)

**这是我的命令（mysql）我想获得从2013**年 4 月 7 日 到**2013**年 7 月 11 日 10 晚的总价

 **```
select sum(
case when dayname('2013-01-07') = 'Monday' then coalesce(prices.room_price , def.room_price) 
 when dayname('2013-01-07') = 'Sunday' then coalesce(prices.room_price , def.room_price) 

)as TotalPrice 
from (select strtodate('2013-01-07' , '%Y-%m-%d') as thedate 
select strtodate('2013-01-08' , '%Y-%m-%d') as thedate ) dates left outer join ts_room_prices prices
on dates.thedate between prices.season_start and prices.season_end cross join ts_room prices def on def.season_name = 'default' 
```

* * *

* * *

## 添加

我写了这个命令，但仍然不起作用

```
select sum(coalesce(prices.room_price , def.room_price) ) as TotalPrice
from (select strtodate('2013-01-07' , '%Y-%m-%d') as thedate union all
      select strtodate('2013-01-08' , '%Y-%m-%d') as thedate
     ) dates left outer join
     ts_room_prices prices
     on dates.thedate between prices.season_start and prices.season_end and
        dayname(dates.thedate) = prices.dayofweek join ts_room_prices def
    on def.season_name = 'default' and
       def.hotel = 3233 and
       def.dayofweek = dayname(dates.thedate) 
```

***错误：#1305 - 函数 saudihot_saudihotels.strtodate 不存在***

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T22:06:26.597

这是查询：

```
select sum(coalesce(prices.room_price , def.room_price) ) as TotalPrice
from (select strtodate('2013-01-07' , '%Y-%m-%d') as thedate union all
      select strtodate('2013-01-08' , '%Y-%m-%d') as thedate
     ) dates left outer join
     ts_room_prices prices
     on dates.thedate between prices.season_start and prices.season_end and
        dayname(dates.thedate) = prices.dayofweek join ts_room prices def
    on def.season_name = 'default' and
       def.hotel = <whatever the hotel is> and
       def.dayofweek = dayname(dates.thedate) 
```

请注意，`sum()`表达式要简单得多，并且现在加入了星期几。我还添加了获取默认值的酒店条件——这也应该在另一个查询中。

请记住，您必须将所有日期放在初始子查询中，并结合`union all`.**

# wpf - Behavior 中集合类型的 DependencyProperty

> ID：14187082
> 
> 赞同：0
> 
> 时间：2013-01-06T21:41:14.643
> 
> 标签：wpf, dependency-properties

我正在创建一种行为，我需要允许将某些类型的列表设置为依赖属性。为了清楚起见，这里有一个例子：

```
<SomeUserControl .....>
  <i:Interaction.Behaviors>
    <local:CustomBehavior PropertyA="False">
      <local:CustomBehavior.PropertyBList>
        <x:Type Type="local:TypeA" />
        <x:Type Type="local:TypeB" />
        <x:Type Type="local:TypeC" />
      </local:CustomBehavior.PropertyBList>
    </local:CustomBehavior>
  </i:Interaction.Behaviors>
</SomeUserControl> 
```

如您所见，行为需要接受在 XAML 中传递的类型列表。我发现将类型集合传递给 a 的唯一方法`DependencyProperty`是使用 a `DependencyPropertyKey`：

```
private static readonly DependencyPropertyKey PropertyBListPropertyKey =
    DependencyProperty.RegisterReadOnly("PropertyBList", typeof(List<Type>), typeof(CustomBehavior), new PropertyMetadata(new List<Type>()));

public static readonly DependencyProperty PropertyBListProperty = PropertyBListPropertyKey.DependencyProperty;

public List<Type> PropertyBList
{
    get { return (List<Type>)GetValue(PropertyBListProperty); }
} 
```

但是，这种方法的问题是集合永远不会重置。例如，如果我有两个`UserControls`use `CustomBehavior`，`PropertyBList`则 collection 将包含添加到两个 usercontrols 上的类型，这意味着它`PropertyBList`就像一个在所有使用此行为的 usercontrols 之间共享的静态集合。

如何解决这个问题呢？如何拥有一个`List<Type>`特定于用户控件实例而不是共享的依赖属性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T22:13:47.333

问题是您`PropertyBList`通过属性元数据中的默认值初始化值，该值由所有 CustomBehavior 实例共享。您可以改为在 CustomBehavior 构造函数中初始化值：

```
private static readonly DependencyPropertyKey PropertyBListPropertyKey =
    DependencyProperty.RegisterReadOnly(
        "PropertyBList", typeof(List<Type>), typeof(CustomBehavior), null);

public static readonly DependencyProperty PropertyBListProperty =
    PropertyBListPropertyKey.DependencyProperty;

public List<Type> PropertyBList
{
    get { return (List<Type>)GetValue(PropertyBListProperty); }
}

public CustomBehavior()
{
    SetValue(PropertyBListPropertyKey, new List<Type>());
} 
```

# sql-server-2008 - 如何在不锁定 MSSQL 2008 中的目标表的情况下插入/选择？

> ID：14187084
> 
> 赞同：0
> 
> 时间：2013-01-06T21:41:48.317
> 
> 标签：sql-server-2008

我有一个过程需要将许多行（可能是数万或数十万行）从临时表复制到另一个将被处理的表。

通常，我只想说

```
insert into production_table select * from staging_table 
```

但是这个语句可能需要一个小时才能运行，所以为了不锁定处理表，我们使用客户端应用程序中的以下逻辑来移动接下来的 1,000 行，以便最终所有行都进入生产表：

```
do 
{
    max_id = select max(id) from production_table where jobid = YYY

    insert into production_table (jobid, ...) 
    select top 1000 jobid, ... from staging_table 
    where id > @max_id
    order by id asc

} while @row_count = 1000 
```

我正在重构这个过程，我认为这不是最好的方法。有没有更好的（最好是事务安全的）方法来一次性复制所有行而不锁定目标表？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T03:33:37.313

可以使用表分区吗？

1.  将目标表和临时表分区到某个列（如日期或增量 batchID）。

2.  完成登台后，将分区切换到处理表。

3.  处理完成后，您可以将已处理的分区切出并截断

# cocos2d-iphone - 绘制彩色圆圈

> ID：14187087
> 
> 赞同：4
> 
> 时间：2013-01-06T21:42:09.567
> 
> 标签：cocos2d-iphone

我正在尝试使用 cocos2d 在屏幕上绘制一个简单的彩色圆圈，但我绘制的所有内容都是白色的。我尝试了 glColor4f 和 glColor4ub 但都没有工作，即使它们在这里被用来绘制彩色图元：[http ://code.google.com/p/cocos2d-iphone/source/browse/trunk/tests/drawPrimitivesTest.m?r =1813](http://code.google.com/p/cocos2d-iphone/source/browse/trunk/tests/drawPrimitivesTest.m?r=1813)

这些是直接来自他们的代码的示例，但它只是给了我一个白圈和一条白线。

```
-(void) draw
{
    [super draw];
    glEnable(GL_LINE_SMOOTH);

    glColor4f(0.0, 1.0, 0.0, 1.0);
    glLineWidth(2.0f);
    ccDrawLine(ccp(10,100),ccp(50,79));

    glLineWidth(16);
    glColor4ub(0, 255, 0, 255);
    ccDrawCircle( ccp(200,  200), 100, 0, 10, NO);

} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-06T22:14:28.980

cocos2d 2.0 使用 OpenGLES 2.0。`glColor4f`不复存在。要更改绘图颜色，您可以使用

```
ccDrawColor4F(0.0f, 1.0f, 0.0f, 1.0f); 
```

# php - 防止 PHP 解析字符串

> ID：14187093
> 
> 赞同：-6
> 
> 时间：2013-01-06T21:42:22.840
> 
> 标签：php, parsing, escaping

我目前有一个数据库，其中一些字段包含表单的文本

`The root location is <?=$GLOBALS['root']?>`,

这个想法是，当显示在网页上时，输出是

`The root location is /random/directory/that/changes/`.

问题是我还想要一个可以编辑这些字段的页面，所以我需要把

`The root location is <?=$GLOBALS['root']?>`

进入文本区域。不幸的是，像这样的代码

```
<textarea><?echo $page->text?></textarea> 
```

做你所期望的并将任何发生的事件更改`<?=$GLOBALS['root']?>`为 /random/directory/that/changes/。我知道可以像 phpmyadmin 那样做到这一点，但我看过他们的代码，并不能完全弄清楚他们是如何做到的。据我所知，没有任何常用的转义函数可以解决问题，正如我所预料的那样。

PS我意识到将PHP代码放入这样的数据库并不是最好的主意，但我现在有点坚持。

编辑：对不起，我是个傻瓜。请忽略这个问题。有关更多详细信息，请参阅下面的答案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T21:45:58.750

`<?php echo $page->text; ?>`不应该在`$page->text`. 但是，其中的 PHP 代码可能会被*浏览器*解释为[处理指令](https://en.wikipedia.org/wiki/Processing_Instruction)。要解决此问题，您需要将其转义为 HTML：

```
<?php echo htmlspecialchars($page->text); ?> 
```

有关详细信息`htmlspecialchars`，[请参阅文档](http://www.php.net/htmlspecialchars)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T21:53:26.077

对不起，我是个白痴，没有仔细阅读我留下来处理的代码。你是正确的，替换不是由 PHP 自动完成的，但由于某种原因，前作者认为使用`str_replace("<?=\$GLOBALS['root']?>", $GLOBALS['root'], mysql_result($result, 0, "text"));`......

很抱歉浪费您的时间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-06T21:49:48.130

您可以为字符串中的变量引入自己的语法并运行`str_replace`（或使用正则表达式）以将它们替换为实际值：

```
$variables = array(
  'root' => '/random/directory/that/changes/'
};
$string = str_replace('{$root}', $variables['root'], $string); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-06T21:44:52.103

使用双引号（“”）。要将数据放入数据库，请使用一些抽象层，例如 PDO。 [http://php.net/manual/en/book.pdo.php](http://php.net/manual/en/book.pdo.php)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-06T21:46:03.180

我认为您想要的是`eval()`从数据库执行任意代码的功能。但是，不建议从字符串执行任意代码。

[http://php.net/manual/en/function.eval.php](http://php.net/manual/en/function.eval.php)

问题`<?`消失了，因为`eval()`不支持这些。

# c# - ReadEntityBody 改变了行为

> ID：14187094
> 
> 赞同：6
> 
> 时间：2013-01-06T21:42:41.770
> 
> 标签：c#, asp.net

我有一个充当文件上传模块的 HttpModule，在将 .NET 框架升级到 4.5 后，它的工作方式有所不同。在框架 4.0 中，ReadEntityBody 方法用 256k 填充数组，但升级后它只会返回 16k。还有其他人有这个问题吗？

```
 public void ProcessRequest(HttpContext context)
    {
        IServiceProvider provider = (IServiceProvider)context;
        HttpWorkerRequest worker = (HttpWorkerRequest)provider.GetService(
            typeof(HttpWorkerRequest));

        byte[] data = new byte[256 * 1024];
        int readData = worker.ReadEntityBody(data, data.Length);

        // ......
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T17:40:29.593

我们也遇到过这种情况，不得不进行调整。事实上，在生产中，我们发现通常也可以返回不到 16 KB，这可能是因为在该环境中一次可用的空间较少。

就个人而言，我将此视为 4.5 错误，因为未记录[ReadEntityBody](http://msdn.microsoft.com/en-us/library/c6xe6631.aspx)的行为返回少于请求的值，因此这是从 4.​​0 到 4.5 的重大更改。

另一方面，[Stream.Read](http://msdn.microsoft.com/en-us/library/system.io.stream.read.aspx)确实明确记录了这种行为：

> 即使没有到达流的末尾，实现也可以自由地返回比请求更少的字节。

因此，如果您从另一个角度来看它，它`ReadEntityBody`具有相同的 API，`Stream.Read`并且应该具有相同的语义。从这个意义上说，4.5 (webengine4.dll) 只是改变了实现，同时仍然履行了相同的合同。

IMO，在最坏的情况下这是一个重大变化，而在最好的情况下它是一个文档错误。有些人可能两者都不考虑。你可以决定。

我没有动力提交错误。如果它从第一天起就以这种方式工作，我可能会认为它是合乎逻辑的。遗憾的是，它在预期的 100% 向后兼容的框架更新中中断了。这就是生活..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T10:17:21.970

最后我找到了解决这个问题的方法。为 HttpWorkerRequestExtension 类创建了一个扩展，它将在返回我的调用之前填充缓冲区。

```
public static class HttpWorkerRequestExtension
{
    public static int ReadEntityBodyEx(this HttpWorkerRequest request, byte[] buffer, int offset, int size)
    {
        int bytesRead = 0;
        int totalBytesRead = 0;
        int bytesToRead = size;

        while (bytesToRead > 0)
        {
            bytesRead = request.ReadEntityBody(buffer, offset + totalBytesRead, size - totalBytesRead);

            if (bytesRead == 0) { break; }

            bytesToRead -= bytesRead;
            totalBytesRead += bytesRead;
        }

        return totalBytesRead;
    }

    public static int ReadEntityBodyEx(this HttpWorkerRequest request, byte[] buffer, int size)
    {
        return request.ReadEntityBodyEx(buffer, 0, size);
    }
} 
```

# svn - 如何下载 SVN 存储库？

> ID：14187097
> 
> 赞同：1
> 
> 时间：2013-01-06T21:42:51.320
> 
> 标签：svn

下载整个 Subversion 存储库（即存储库本身）的命令是什么？我知道这不是`svn checkout`因为那只下载头部修订版。我正在寻找类似于`git clone`or的东西`hg clone`。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-07T00:57:25.107

正如@Chris 所说，SVN 不是分布式版本控制系统，因此下载整个存储库的操作相对较少，普通用户不需要。通常，用户只需执行`svn checkout`.

但是为此提供了实用程序作为备份机制的一部分。

历史上`svnadmin dump`会使用该命令。这假设您对存储库本身具有本地文件访问权限（例如，不仅仅是 svn+ssh:\\ 或 http:\\）。此命令会将指定修订范围内的每个提交的详细信息（例如 -r1:HEAD）转储到标准输出。然后可以使用该`svnadmin load`命令将此类文件用于填充另一个存储库。有关使用详情，请参阅[svn book](http://svnbook.red-bean.com/en/1.7/svn.reposadmin.maint.html#svn.reposadmin.maint.migrate)。

此外，在 subversion 1.7 版本中引入了一个可识别网络的转储实用程序，称为`svnrdump`. 这将创建与上述命令相同的转储格式文件`svnadmin dump`。再次，请参阅[svn book](http://svnbook.red-bean.com/en/1.7/svn.ref.svnrdump.html)了解详细信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-06T21:45:31.740

与 git 或 hg 相比，SVN 不是分布式版本控制系统。无法下载存储库本身。

如果您确实下载了它（例如通过 ftp），则无法将更改与原始存储库合并。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-08-12T07:39:30.460

我试图在不安装的情况下获得它，我可以通过运行 wget 来做到这一点。使用以下命令下载 svn repo

```
wget -m -np http://myproject.googlecode.com/svn/myproject/trunk/ 
```

# c# - UIAutomation 不会检索元素的子元素

> ID：14187110
> 
> 赞同：9
> 
> 时间：2013-01-06T21:44:11.977
> 
> 标签：c#, windows, ui-automation, microsoft-ui-automation

我可以看到具有特定自动化 ID 的元素在检查工具中有子元素：

![检查屏幕截图](../Images/1446ab65a82a44fef279b60df23093be.png)

但是当我尝试像这样检索它们时：

```
AutomationElement aPane = mainWindow.FindFirst(TreeScope.Subtree, new PropertyCondition(AutomationElement.AutomationIdProperty, "8264"));
AutomationElementCollection theChildren = aPane.FindAll(TreeScope.Subtree, Condition.TrueCondition); 
```

`aPane`元素被正确检索，但元素`theChildren`为空。任何想法出了什么问题？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-06T22:45:45.927

在极少数情况下，我发现`Find*`调用找不到所有自动化对象。我见过的唯一一致的情况是 WPF`TextBlock`控件在数据模板中时不会被这些调用找到。在这些情况下，您可以尝试`RawViewWalker`可能更接近 Inspect 在内部执行的操作。

```
public static IEnumerable<AutomationElement> FindInRawView(this AutomationElement root)
{
    TreeWalker rawViewWalker = TreeWalker.RawViewWalker;
    Queue<AutomationElement> queue = new Queue<AutomationElement>();
    queue.Enqueue(root);
    while (queue.Count > 0)
    {
       var element = queue.Dequeue();
       yield return element;

       var sibling = rawViewWalker.GetNextSibling(element);
       if (sibling != null)
       {
          queue.Enqueue(sibling);
       }

       var child = rawViewWalker.GetFirstChild(element);
       if (child != null)
       {
          queue.Enqueue(child);
       }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-10-09T03:47:53.520

答案有点晚，但我想更正此处选择的答案。是的，VS 提供的 COM 包装器确实可能使用不同的 UIAutomationClient.dll，并且在调用 UIAutomation 方法时使用本机代码与托管代码会有所不同，但是这里提出的问题是不同的问题。（顺便说一句，您可以使用托管代码中的 COM 包装器来调用 UIAutomation dll 的正确版本，这将解决诸如“inspect.exe 找到它但我的托管代码不能”之类的问题）。

我也遇到了这里提出的问题（我的问题是： FindAll(TreeScope.Children, TrueCondition) 没有返回任何东西，尽管 FindFirst() 成功地返回了同一控件上的子项）。

我尝试了 mike-z 的方法，使用 RawViewWalker 来寻找孩子，它在这种情况下效果很好。我正在写这个单独的答案，说问题不是 Find* 方法，而是导致 August 问题的 FindAll 和 FindFirst 方法之间的差异。

### 更新

对于 MS 工具，不一致的行为似乎是常态。进行此更新的原因是，我在使用 C# 的 tlbimp.exe'd RCW for uia 遇到了类似的问题，这次我编写了一个直接等效的 C 代码，令我惊讶的是它在 C# 代码中运行良好在试图找到一个简单的 OpenFileDialog 控件时拒绝以任何方式工作，然后在主窗体上找到另一个控件。两个世界的唯一区别是神秘的 MS RCW 魔法。我不确定这是否是使用自动创建的 COM 包装器（通过 tlbimp）或其他方式处理封送处理的方式。并且为创建的界面显示的 [ComConversionLoss] 属性对我来说听起来不正确。反正我

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-02-01T16:49:21.750

实际上问题是 Inspect.exe 是用非托管代码编写的，而我试图在**[托管](https://msdn.microsoft.com/en-us/library/ms747327(v=vs.110).aspx)**代码中实现相同的**[结果](https://msdn.microsoft.com/en-us/library/windows/desktop/ff486375(v=vs.85).aspx)**。非托管代码返回的结果与托管版本略有不同（例如，托管代码将返回控制类型[文档](https://msdn.microsoft.com/en-us/library/system.windows.automation.controltype.document(v=vs.110).aspx)，其中非托管代码将在我的应用程序中返回[编辑](https://msdn.microsoft.com/EN-US/library/windows/desktop/ee671626(v=vs.85).aspx)）。

虽然我花了一些时间来理解它，但非托管代码更快、更准确，因此更可靠。

C# 的非托管 UI 自动化代码的一些示例可以在 Microsoft Windows UI 自动化博客中找到，例如[这里](http://blogs.msdn.com/b/winuiautomation/archive/2011/05/18/building-ui-automation-client-applications-in-c-and-c.aspx)，

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-03-31T13:24:17.200

托管和非托管 UI 自动化之间的区别在于托管使用旧实现，但 Inspect 直接使用 COM，这是较新的 3.0 版

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-09-27T16:03:07.723

我原来的例子是简化的。我尝试使用 3 种技术访问儿童：

1.  .Net 托管代码中的 RawViewWalker。
2.  COM 中的等效 walker，即 .Net 托管代码中可用的 COM 包装器。
3.  我编写的一个完全独立的 VB6 应用程序中的非 .Net 代码（即非托管代码）。

只有 VB6（非托管）代码给出了与 Microsoft 的 Inspect 工具相同的结果。我相信这证实了上面其他人所说的：Microsoft 在 .Net 中的 UI 自动化实现存在严重问题。可能唯一的解决方案是在 .Net 中编写自定义 UI 自动化客户端，但这假设目标应用程序中的 UI 自动化服务器行为正确。这些超出了我的控制范围，因为目标应用程序是由其他公司编写的，而不是我的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-10-22T01:29:57.870

为了让 FindFirst 找到后代，目标元素必须设置 IsControlElement。

在原始海报的屏幕截图中，IsControlElement 被报告为`[Not supported]`.

换句话说，FindFirst 搜索控制树，而不是原始树。

# java - 是否有一种简单有效的方法来延迟来自 Java Servlet 的响应

> ID：14187112
> 
> 赞同：1
> 
> 时间：2013-01-06T21:44:33.987
> 
> 标签：java, security, servlets, denial-of-service

当我得到明显的黑客攻击时，我该怎么办？我希望有一种简单的方法可以让他们浪费时间，而不涉及服务器资源。即使是几秒钟的延迟也可能使暴力攻击无效。

将它们发送到 AsyncContext 似乎过于占用处理器资源，并且超时会自动将相同的请求重新发送回它开始的位置。这实际上可能有助于 DOS 攻击。

我正在使用 Jetty 并且了解 DoSFilter，但是如果我可以在检测到犯规行为时延迟响应会更有效，这在我的情况下很容易感知。我认为每次失败的验证/身份验证尝试都应该以某种方式自动延迟响应。

我在这里并没有真正进行身份验证，因此身份验证协议/前端没有用。我只是在验证满足特定标准的模式的连接参数。我知道 TCP/IP 会通知，但如果我可以静默断开无效的访问尝试并让它们挂起，那将是理想的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T21:55:55.940

如果您收到来自同一 IP 的可疑重复请求，您可以引入升级延迟：

```
Thread.sleep(n); 
```

其中 n 将每个后续事件翻倍。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-06T22:05:46.650

我认为，如果您检测到傻瓜游戏，最好在一段时间内阻止他们的 ip。只需添加他们的 ip 就很容易`/etc/hosts.deny`（它适用于许多 unix 守护进程，但我不确定它是否也适用于 java 进程，我认为它*应该可以工作*，因为它被 tcp 守护进程本身使用）。`man 5 hosts.deny`在命令行给出一些提示（或查看[此在线链接](http://linux.about.com/od/commands/l/blcmdl5_hostsde.htm)）。

顺便说一句，我认为您可以使用[`Thread.sleep()`](http://docs.oracle.com/javase/7/docs/api/java/lang/Thread.html#sleep%28long%29)暂停 servlet，就像在任何普通的 java 代码中一样。但这可能会导致来自同一调用者的更多请求长时间保持打开状态，从而增加应用程序服务器必须分配和维护的活动资源。因此，如果攻击者可以在多线程中工作，这可能会帮助他阻止您的服务器，因为它将持有所有线程进行攻击，阻止所有其他用户访问您的服务。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-06T22:14:04.847

我实际上认为 AsyncContext 可能是比在同步请求上休眠更好的解决方案。

但是，我认为您必须尝试这两种情况，并实际测量每种情况对 cpu 使用率和总吞吐量的影响才能确定。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-06T22:20:51.430

你应该保护在较低的水平。任何涉及 Java 的行为都会比黑客对您造成更大的伤害，因为容器会在每个请求上创建环境。

黑客很可能不会等待响应，因此您不会通过延迟响应来打击他们。

使用`nginx`或防火墙级别。

# html - Is it bad practice to ID every dynamically created element?

> ID：14187113
> 
> 赞同：1
> 
> 时间：2013-01-06T21:44:40.627
> 
> 标签：html

So, I'm creating a webpage where new elements are dynamically created by the user, and as they are made, each element object is added to an array to keep track of them. The thing is, that when someone closes the element, I want it to be removed from the array; the only way I can think of is to give an ID equivalent to the index in the array to each element. I feel as if this could get messy and/or be bad practice. Is there any alternative? Or is this ok to do?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T21:48:58.310

It's not about dynamic vs not dynamic.

An ID should be given to an element for one reason, if it is **unique**. If only one of that element type (By "type" I mean semantically meaning type, not tagname or such. For instance, there can be multiple sidebars, or headlines, but only one `#mainNav` or `#generalWrapper`).

Giving an ID to every single element you create dynamically is, by definition, wrong. Since you most likely create very similar elements, in which case, a **class name** is more appropriate.

If you want a way to track them, you can always use `data-*=` attributes with whatever custom data you want. For instance: `data-id=1`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-06T21:49:08.700

There's a big debate about over-use of ID's.

My suggestion would be to use a `data` attribute, something like:

```
<li data-id="54">My element</li> 
```

Then you can easily manipulate the element (remove, modify, etc) using Javascript. jQuery has the `data()` method for instance - [http://api.jquery.com/jQuery.data/](http://api.jquery.com/jQuery.data/)

My main argument against using a class or id is that you're (in this instance) looking for information about an element for a specific function, whereas a class or id is better suited for distinguishing the element on a more global level.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-06T21:58:59.810

You could wait until the user is finished adding or removing the elements and then use something like jQuery's $.each function. For example if you want to collect the value from a series of inputs that a user added to a div you could simply do

```
var myArray = [];
$('#mydiv input').each(function(){
    //Do something here with each of the inputs
    myArray.push($(this).val());
}); 
```

If you want to simply add some sort of attribute to them you could still use this same function

```
$('#mydiv input').each(function(index){
    //Do something here with each of the inputs
    $(this).attr('data-id', index);
}); 
```

I hope I answered your question for you as I am not sure what you are trying to use that array for. I assumed for some sort of submission at some point.

# php - 比较字符串，使用较短的字符串

> ID：14187115
> 
> 赞同：0
> 
> 时间：2013-01-06T21:44:50.010
> 
> 标签：php, web-scraping, conditional-statements

我是一名初级程序员，试图制作一个简单的应用程序，只抓取网站并返回值。

我正在尝试做一些我认为很简单的事情，但是在搜索和尝试之后，我放弃了只是问。

使用我的爬虫，我返回三个变量：**$title1**、**$title2**和**$title3**。所有的 $title 都来自我试图找到文章名称的不同方法。理想情况下，我只需要寻找一个并完成，但有些网站以不同的方式存储数据（有些通过元标记、隐藏的 div、元素等）。

我需要一种方法来执行以下伪代码：

```
if $title1, $title2, $title3 != null { // don't count a string if it is null

    $title1_stringlength = string_length($title1) //find string length of the $titles
    $title2_stringlength = string_length($title2)
    $title3_stringlength = string_length($title3)

    $realtitle = $lowestvalueofstringlength; // $realtitle gets whichever $title is shortest in length, not counting any null $title's

} 
```

这是我为什么需要这样做的一个例子：

```
echo $title1; //echoes "Exercise Daily"
echo $title2; //echoes "null"
echo $title3; //echoes "Exercise Daily - And More advice on SaveTheTwinkie.org"
$realtitle = $title1;//should be $title1 because it was shortest that wasn't null

//or a different example from another site

echo $title1; //echoes "Wow look at this Article Title!"
echo $title2; //echoes "null"
echo $title3; //echoes "Wow look at this Article Title! - from StupidArticles.tv"
$realtitle = $title1;//should be $title1 because it was shortest that wasn't null 
```

因此，我的代码将查找字符串长度中最短的 $title（不为空）并将值赋予 $realtitle。

感谢您的任何帮助！如果您需要更多详细信息，请询问！

* * *

编辑

* * *

这是我的完整代码：它一直有效，直到 $title 之一是“”，然后 $realtitle 也变为“”

```
<?php

$sites_html = file_get_contents($url);

$html = new DOMDocument();
@$html->loadHTML($sites_html);
$title1 = null; //reset
$title2 = null; //reset
$title3 = null; //reset

//Get all meta tags and loop through them.
foreach($html->getElementsByTagName('meta') as $meta) {
    if($meta->getAttribute('property')=='og:title'){ 
        //Assign the value from content attribute to $title1
        $title1 = $meta->getAttribute('content');
    }
}
foreach($html->getElementsByTagName('h1') as $div) {
    if($div->getAttribute('itemprop')=='name'){
        $title2 = $div->nodeValue;
    }
}
foreach($html->getElementsByTagName('h1') as $div) {
    if($div->getAttribute('class')=='fn'){
        $title3 = $div->nodeValue;
    }
}

$realtitle = array_reduce(array($title2, $title1, $title3), function($a, $b) {
    return strlen($a) && $a != 'null' && strlen($a) < strlen($b) ? $a : $b;
}, null);

    echo 'metaogtitle: '.$title1 . '<br/><br/><br/><br/><br/>';
    echo 'name: '.$title2\. '<br/><br/><br/><br/><br/>';
    echo 'name2: '.$title3\. '<br/><br/><br/><br/><br/>';
    echo 'realtitle: '.$realtitle. '<br/><br/><br/><br/><br/>';
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T22:02:56.550

```
// Filter invalid values
$titles = array_filter($titles, function($title) { return $title && $title != 'null'; }); 
// Just  sort :)
usort ($titles, function ($left, $right) { return strlen($left) - strlen($right); });
echo $titles[0]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T22:23:46.473

这是一个适用于无限数量字符串的变体：

```
$shortest = NULL;

$shortestReduce = function ($string) use (&$shortest) {

    if ( ($string === "null") || !($len = strlen($string))) {
        return $shortest;
    }

    if (!isset($shortest) || $len < strlen($shortest)) {
        $shortest = $string;
    }

    return $shortest;
};

$shortestReduce($string1);
$shortestReduce($string2);
$shortestReduce($string3);
# ...

echo $shortest; # "Exercise Daily" 
```

此 reduce 允许您对生成一个结果的多个值应用相同的函数，这里最短的字符串不是`"null"`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-06T22:03:33.253

这个应该工作：

```
function real_title($titles) {
    /* Gets array of titles.
       Return the shortest that isn't null.
    */

    $min_length = strlen($titles[0]);
    $real_title = $titles[0];

    foreach ($titles as $single_title) {
       $title_length = strlen($single_title);
       if (($title_length < $min_length) && ($title_length > 0)) {
                $min_length = $title_length;
                $real_title = $single_title;
        }
    }

    return $real_title;
} 
```

# sql-server-2008 - 计算公式中折扣后的净额

> ID：14187132
> 
> 赞同：0
> 
> 时间：2013-01-06T21:46:08.127
> 
> 标签：sql-server-2008, formula, calculated-columns

我需要在 SQL Server 的计算列中输入值。

公式需要类似于：col1 * 0.col2（第 1 列和第 2 列都可以为空）。Col1 是 GrossAmount(decimal(10,2))，Col2(smallint) 是折扣百分比。

我试图为此寻找解决方案，但到目前为止没有发现任何帮助。知道我可以在哪里找到一个好的解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T22:33:16.367

您是否正在寻找类似的东西：

```
select GrossAmount, DiscountPercentage,
  GrossAmount * DiscountPercentage / 100.0 as [DiscountAmount]
  from YourTable 
```

这假定这`DiscountPercentage`是要以百分比打折的金额。贴现总额将是：

```
GrossAmount * ( 100.0 - DiscountPercentage ) / 100.0 as [DiscountedGrossAmount] 
```

在表定义中，您可以创建一个计算列：

```
DiscountedGrossAmount as GrossAmount * ( 100.0 - DiscountPercentage ) / 100.0 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2016-11-09T12:47:53.327

```
grossamount-(grossamount*(discountpercentage/100)) as Discountpercentage 
```

# linux - Xlib 键盘轮询

> ID：14187135
> 
> 赞同：1
> 
> 时间：2013-01-06T21:46:21.887
> 
> 标签：linux, opengl, input, xlib

我正在开发一个多平台 OpenGL 应用程序，为此我在 Linux 下使用 Xlib。我知道 Xlib 输入处理是基于事件的，但是我的程序已经做了自己的事件处理，我更希望能够轮询 xserver 以获取自上次轮询以来在活动窗口下按下或引发的任何键.

如果我必须在 X 下使用基于事件的输入处理，我必须对其他平台做同样的事情，同时重写大量代码，因为事件方法在一个平台与另一个平台之间是如此不同。轮询确实会为我简化事情，但我担心这样的事情会产生大量开销，而且我什至无法获得有关应该如何完成的信息。我曾想过直接检查 /dev/input/eventX 节点，但这可能会使事情变得更复杂，而不是简化。

我真正想知道的是如何有效地轮询 Linux 系统上的键盘状态。我是否在 Xlib 上浪费时间，我应该考虑其他技术或库吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T22:16:09.037

为了有效地进行轮询，我通常使用`select`(on `ConnectionNumber`) 来等待与 X 的连接发生某些事情，然后在`XPending`我使用`XNextEvent`抓取东西的时候。不要调用`XNextEvent`除非`XPending`，否则它会阻塞。

方便的是，`select`它提供了一个超时机制，因此您也可以很容易地停止定期等待去做其他事情（比如绘图）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T23:29:29.933

轮询意味着，您将在程序中的某处有一些循环。使用 XPending 检查服务器是否有新内容（这是您的投票），然后使用 XNextEvent 读取它。

# shell - autoconf：我是否应该始终使用 AS_IF 而不是 if 和 m4_if？

> ID：14187136
> 
> 赞同：6
> 
> 时间：2013-01-06T21:46:31.777
> 
> 标签：shell, autoconf, m4

autoconf 手册建议使用`AS_IF`而不是`if`，但没有提及`m4_if`. 也应该`AS_IF`优先于`m4_if`?

手册的[“内置函数的限制”](http://www.gnu.org/software/autoconf/manual/autoconf-2.67/html_node/Limitations-of-Builtins.html#if)部分说使用`AS_IF`它的可移植性，但[`AC_REQUIRE`描述](http://www.gnu.org/software/autoconf/manual/autoconf-2.67/html_node/Prerequisite-Macros.html)说使用它来扩展所需的宏。

我应该一直使用`AS_IF`吗？答案似乎是肯定的，但我又看到`if`并`m4_if`在其他宏中使用。什么时候可以不使用`AS_IF`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-14T01:54:59.890

我对此感到困惑，因为我没有意识到`if`/`AS_IF`和之间的根本区别`m4_if`。当用户运行脚本时，正常`if`并`AS_IF`评估其条件，即`configure`. 相反，`m4_if`在宏扩展期间对其条件进行评估，即`autoreconf`.

`if`/`AS_IF`影响脚本的流程。`m4_if`影响脚本的内容。

这现在似乎很明显，但我一开始并没有得到它。希望这对其他人有帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T00:16:41.320

AS_IF 的另一个好处是，当它展开时，分支中的宏需要的任何宏都会在测试之前展开。

请参阅[手册](http://www.gnu.org/savannah-checkouts/gnu/autoconf/manual/autoconf-2.69/html_node/Common-Shell-Constructs.html)。

# android - 将侦听器设置为帧动画

> ID：14187140
> 
> 赞同：1
> 
> 时间：2013-01-06T21:46:45.653
> 
> 标签：android, animation, listener

我有以下 XML 文件来定义我的帧动画：

```
<animation-list
xmlns:android="http://schemas.android.com/apk/res/android"
android:oneshot="false">
<item android:drawable="@drawable/youme_blink_frame_0000" android:duration="40" />
<item android:drawable="@drawable/youme_blink_frame_0001" android:duration="40" />
<item android:drawable="@drawable/youme_blink_frame_0002" android:duration="40" />
<item android:drawable="@drawable/youme_blink_frame_0003" android:duration="40" />
<item android:drawable="@drawable/youme_blink_frame_0004" android:duration="40" />
<item android:drawable="@drawable/youme_blink_frame_0005" android:duration="40" />
<item android:drawable="@drawable/youme_blink_frame_0006" android:duration="40" />
<item android:drawable="@drawable/youme_blink_frame_0007" android:duration="40" />
<item android:drawable="@drawable/youme_blink_frame_0008" android:duration="40" />
<item android:drawable="@drawable/youme_blink_frame_0009" android:duration="40" />
<item android:drawable="@drawable/youme_blink_frame_0010" android:duration="40" />
</animation-list> 
```

然后我有以下代码：

```
 Animation mAnim = AnimationUtils.loadAnimation(this, R.anim.blink);
    mAnim.setAnimationListener(this);

    ImageView img = (ImageView)findViewById(R.id.animationImage);
    img.clearAnimation();
    img.setAnimation(mAnim);
    img.startAnimation(mAnim); 
```

此代码生成异常，错误为“找不到动画文件”。是帧动画不被认为是动画还是我做错了什么？

谢谢，西蒙

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-09T01:57:49.620

逐帧动画是 AnimationDrawable 而不是 Animation。您所做的是将它用作动画，这就是异常的原因没有具有该名称的动画文件有可绘制文件。使用 AnimationDrawable 使用这个代码片段

```
// Load the ImageView that will host the animation and
// set its background to our AnimationDrawable XML resource.
ImageView img = (ImageView)findViewById(R.id.spinning_wheel_image);
img.setBackgroundResource(R.drawable.spin_animation);

// Get the background, which has been compiled to an AnimationDrawable object.
AnimationDrawable frameAnimation = (AnimationDrawable) img.getBackground();

// Start the animation (looped playback by default).
frameAnimation.start(); 
```

有关 AnimationDrawable 的更多信息，请参阅[文档](http://developer.android.com/guide/topics/graphics/drawable-animation.html)

# javascript - 为什么这个 javascript 脚本不起作用？

> ID：14187142
> 
> 赞同：0
> 
> 时间：2013-01-06T21:47:09.717
> 
> 标签：javascript

我是新手，所以这可能很简单，但它不适合我。

```
<div id="abc" style="width:100px; height:100px; background-color:Blue;" onclick="change()">
  Hi
</div> 
```

这是一个脚本，因此单击该框*应*更改文本。但没有。为什么？

```
function change() 
{
  var text = "abcde";
  var new1 = "";
  var element = document.getElementById('abc');
  for (var i=0;i<text.length;i++)
    {
      new1 = substring(i,text.length-i);
      element.innerHTML = new1;
    }
} 
```

jsfiddle：[在这里](http://jsfiddle.net/wrG3B/)。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T21:49:12.140

`substring()`必须应用于一个字符串（你想提取一部分的那个），所以在你的情况下，我相信你的意图是这样的：

```
function change() 
{
  var text = "abcde";
  var new1 = "";
  var element = document.getElementById('abc');
  for (var i=0;i<text.length;i++)
    {
      new1 = text.substring(i,text.length-i-1);
      element.innerHTML = new1;
    }
} 
```

[示例小提琴](http://jsfiddle.net/wrG3B/2/)

# jquery - Jquery 仅适用于断点

> ID：14187145
> 
> 赞同：2
> 
> 时间：2013-01-06T21:47:22.307
> 
> 标签：jquery, jquery-ui-tabs, breakpoints

我正在使用以下代码来跟踪 jquery-ui-tabs 中的命名锚点。我有它，所以当点击链接时，它应该带我到相应的选项卡并滚动到 id。链接工作（经过很多麻烦），但是只有当我在动画行上放置一个断点时，滚动才有效。

```
jQuery(document).ready(function($) {
    $('a[goto]').click(function(evt) {
        evt.preventDefault();
        var whereTo = $(this).attr('goto');
        $tabs = $("ul.ui-tabs-nav li");
        $tabs.find('a[href=#' + whereTo + ']').trigger('click')
        $('html,body').animate({
            scrollTop:$(this.hash).offset().top},
            500);
        });
    }); 
}); 
```

我尝试将其作为回调的一部分，但仍然没有运气。

```
 $('a[goto]').click(function(evt) {
     evt.preventDefault();
     var whereTo = $(this).attr('goto');
     $tabs = $("ul.ui-tabs-nav li");
     $tabs.find('a[href=#' + whereTo + ']').trigger('click', function(){
         $('html,body').animate({scrollTop:$(this.hash).offset().top}, 500);
     });
 }); 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T21:55:50.110

`trigger`方法不接受回调函数，它触发事件以便执行事件处理程序，你有使用`goto`属性的值，你试图做的最终给你这个变量的值，~~实际上那部分是多余的。~~只需使用`whereTo`变量。

```
jQuery(document).ready(function ($) {
  var $tabs = $("ul.ui-tabs-nav li");
  $('a[goto]').click(function (evt) {
    evt.preventDefault();
    var whereTo = $(this).attr('goto');
    var hash = this.hash;
    // 1
    $tabs.find('a[href=#' + whereTo + ']').trigger('click');
    setTimeout(function(){
       $('html,body').animate({
          scrollTop: $(hash).offset().top
       }, 500);
    }, 500)
    // 2
    // $tabs.find('a[href=#' + whereTo + ']').trigger('click')
    // $('#'+ whereTo).closest('.ui-tabs-panel').promise().done(function(){
    //     $('html,body').animate({
    //        scrollTop: $('#' + whereTo).offset().top
    //     }, 500);
    // })
  });
}); 
```

Note that `goto` is not valid attribute, if you are using HTML5 consider using `data-*` attributes.

# android - 捕捉照片时模拟器崩溃 (NullPointerException)

> ID：14187146
> 
> 赞同：1
> 
> 时间：2013-01-06T21:47:48.393
> 
> 标签：android, android-camera

我在拍摄照片时遇到了一些问题。

到目前为止，我可以从相机、模拟器和真实设备中毫无问题地拍照。但是那些图片，被保存在默认路线上。

我想编辑那条路线，所以我可以自己设置。

我是这样做的：

```
File folder = new File(Environment.getExternalStorageDirectory().toString()+"/ImagesFolder/");
            folder.mkdirs();

            Intent cameraIntent = new Intent(android.provider.MediaStore.ACTION_IMAGE_CAPTURE);
            Uri uriSavedImage=Uri.fromFile(new File(Environment.getExternalStorageDirectory().toString()+"/ImagesFolder/imatge.jpg"));
            cameraIntent.putExtra(MediaStore.EXTRA_OUTPUT, uriSavedImage);

            startActivityForResult(cameraIntent, 1888); 
```

这是在真实设备上运行的，索尼爱立信 Xperia Ray。它创建文件夹，并将图像保存在那里。

但问题出在模拟器上。恐怕这会在其他设备上发生。

这是日志：

```
01-06 21:35:21.115: E/AndroidRuntime(1565): FATAL EXCEPTION: main
01-06 21:35:21.115: E/AndroidRuntime(1565): java.lang.RuntimeException: Failure delivering result ResultInfo{who=null, request=264032, result=-1, data=null} to activity {com.exercise.AndroidViewPager/com.exercise.AndroidViewPager.AndroidViewPagerActivity}: java.lang.NullPointerException
01-06 21:35:21.115: E/AndroidRuntime(1565):     at android.app.ActivityThread.deliverResults(ActivityThread.java:3319)
01-06 21:35:21.115: E/AndroidRuntime(1565):     at android.app.ActivityThread.handleSendResult(ActivityThread.java:3362)
01-06 21:35:21.115: E/AndroidRuntime(1565):     at android.app.ActivityThread.access$1100(ActivityThread.java:141)
01-06 21:35:21.115: E/AndroidRuntime(1565):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1282)
01-06 21:35:21.115: E/AndroidRuntime(1565):     at android.os.Handler.dispatchMessage(Handler.java:99)
01-06 21:35:21.115: E/AndroidRuntime(1565):     at android.os.Looper.loop(Looper.java:137)
01-06 21:35:21.115: E/AndroidRuntime(1565):     at android.app.ActivityThread.main(ActivityThread.java:5039)
01-06 21:35:21.115: E/AndroidRuntime(1565):     at java.lang.reflect.Method.invokeNative(Native Method)
01-06 21:35:21.115: E/AndroidRuntime(1565):     at java.lang.reflect.Method.invoke(Method.java:511)
01-06 21:35:21.115: E/AndroidRuntime(1565):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
01-06 21:35:21.115: E/AndroidRuntime(1565):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
01-06 21:35:21.115: E/AndroidRuntime(1565):     at dalvik.system.NativeStart.main(Native Method)
01-06 21:35:21.115: E/AndroidRuntime(1565): Caused by: java.lang.NullPointerException
01-06 21:35:21.115: E/AndroidRuntime(1565):     at com.exercise.AndroidViewPager.MyFragmentD.onActivityResult(MyFragmentD.java:52)
01-06 21:35:21.115: E/AndroidRuntime(1565):     at android.support.v4.app.FragmentActivity.onActivityResult(FragmentActivity.java:152)
01-06 21:35:21.115: E/AndroidRuntime(1565):     at android.app.Activity.dispatchActivityResult(Activity.java:5293)
01-06 21:35:21.115: E/AndroidRuntime(1565):     at android.app.ActivityThread.deliverResults(ActivityThread.java:3315)
01-06 21:35:21.115: E/AndroidRuntime(1565):     ... 11 more 
```

迷恋;撞车;崩溃：

```
01-06 21:35:21.115: E/AndroidRuntime(1565): Caused by: java.lang.NullPointerException
01-06 21:35:21.115: E/AndroidRuntime(1565):     at com.exercise.AndroidViewPager.MyFragmentD.onActivityResult(MyFragmentD.java:52) 
```

来自这里：

```
@Override
public void onActivityResult(int requestCode, int resultCode, Intent data) {
    if( requestCode == 1888 && resultCode == -1) { //-1 = TOT HA ANAT BE.
        Bitmap photo = (Bitmap) data.getExtras().get("data");
        Log.d("debugging",""+photo.getHeight());
        Log.d("debugging",""+photo.getWidth());
        ((ImageView) myFragmentView.findViewById(R.id.fotoCapturada)).setImageBitmap(photo);
    }
} 
```

确切地：

```
Bitmap photo = (Bitmap) data.getExtras().get("data"); 
```

经过一番研究，我发现没有什么清楚的......

你能帮我解决这个问题吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T22:34:43.680

Since your data extras method isn't working, you could try storing a field of the file or the path when the Intent is launched.

```
File resultingFile;//This will be in your class definition

File folder = new File(Environment.getExternalStorageDirectory().toString()+"/ImagesFolder/");
folder.mkdirs();

Intent cameraIntent = new Intent(android.provider.MediaStore.ACTION_IMAGE_CAPTURE);
resultingFile = new File(folder.toString() + "/image.jpg");
Uri uriSavedImage=Uri.fromFile(resultingFile);
cameraIntent.putExtra(MediaStore.EXTRA_OUTPUT, uriSavedImage);

startActivityForResult(cameraIntent, 1888); 
```

So when you enter onActivityResult you can test the resultCode against RESULT_OK and RESULT_CANCELED. When I use onActivityResult, I do it like this:

```
if(requestCode == 1888){
  if(resultCode == RESULT_OK){ //Called when the user saves the image
     if(resultingFile.exists(){
       Bitmap photo = BitmapFactory.decodeFile(resultingFile.getPath()); 
       ((ImageView) myFragmentView.findViewById(R.id.fotoCapturada)).setImageBitmap(photo);
     }
  }else if(resultCode == RESULT_CANCELED){ //Called when the user presses back or cancels the saving of the image

  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T23:04:58.767

After some help, specially from @BackpackOnHead, I got it.

What did I achieve?

*   Retrieve a picture from camera,
*   save it on a specified folder
*   save it on a specified name

This is the final code:

On declaration of the class:

```
File resultingFile; 
```

When clicking the button that starts camera:

```
public void onClick(View v) {
            Log.d("debugging","Has clicat al botó");

            File folder = new File(Environment.getExternalStorageDirectory().toString()+"/FolderWithImages/"); //NAME OF THE FOLDER
            folder.mkdirs();

            Intent cameraIntent = new Intent(android.provider.MediaStore.ACTION_IMAGE_CAPTURE);
            resultingFile=new File(folder.toString() + "/imatge.jpg"); //THIS IS THE NAME OF THE FILE
            Uri uriSavedImage=Uri.fromFile(resultingFile);
            cameraIntent.putExtra(MediaStore.EXTRA_OUTPUT, uriSavedImage);

            startActivityForResult(cameraIntent, 1888);
        } 
```

Then on, onActivityResult:

```
Bitmap photo = BitmapFactory.decodeFile(resultingFile.getPath());
        Log.d("debugging",resultingFile.getPath());
        ((ImageView) myFragmentView.findViewById(R.id.fotoCapturada)).setImageBitmap(photo); 
```

Yay!

Why did I do it this way and not with `Bitmap photo = (Bitmap) data.getExtras().get("data");` ?

Basically, because for some unknown (for me) reason, on some devices, aswel as on emulator, this .getExtras is returning null, thing that in some devices, obvioulsy, as it should, isn't returning null. This "getExtras" provided the photo. We had to use a workaround, that isn't maybe clear and clean, but it does the trick.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-09T20:11:57.203

Try this:

```
File f = createImageFile();
takePictureIntent.putExtra(MediaStore.EXTRA_OUTPUT, f.getAbsolutePath());
startActivityForResult(takePictureIntent, 1); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-06T21:52:50.533

getExtras() 可以返回 null ，在您的情况下它可能会返回。

# sql - 从 SQL Server 连接中获取最大值

> ID：14187147
> 
> 赞同：2
> 
> 时间：2013-01-06T21:47:52.377
> 
> 标签：sql, sql-server, sql-server-2008, join

我已经为 SQL Server 查询苦苦挣扎了一段时间，并意识到我必须从比我更了解 SQL Server 的人那里获得帮助。

环境：SQL Server 2008

```
SELECT      
    t1.SUPPL_ORDERNO, 
    t2.OUR_ORDER,
    t3.CUST_INVOICE
FROM t1 

    LEFT OUTER JOIN t2 
        ON t1.SUPPL_ORDERNO = t2.ORDER_REM5 

    LEFT OUTER JOIN t3
        ON t2.ORDER_REM5  = t3.INV_REM5

GROUP BY t1.SUPPL_ORDERNO, t2.OUR_ORDER, t3.CUST_INVOICE
ORDER BY t1.SUPPL_ORDERNO,t3.CUST_INVOICE 
```

这是我通过上面的查询得到的结果：

```
SUPPL_ORDERNO                  OUR_ORDER CUST_INVOICE
------------------------------ --------- ------------
143914                         64228     179890
143914                         64228     179935
143914                         64228     179995
143914                         64228     179999
143914                         64228     180067
143914                         64228     180148
326042                                   
326052                         64549     180219
326086                         64633 
```

`CUST_INVOICE`我为每个组合得到多个`SUPPL_ORDERNO`，`OUR_ORDER`但我只想返回最新的`CUST_INVOICE`（=最大的发票号）。

这是我要返回的结果：

```
SUPPL_ORDERNO                  OUR_ORDER CUST_INVOICE
------------------------------ --------- ------------
143914                         64228     180148
326042                                   
326052                         64549     180219
326086                         64633 
```

概括：

1.  如果组合的数量超过一 (1) `CUST_INVOICE`，`SUPPL_ORDERNO`并且`OUR_ORDER`我只想显示`CUST_INVOICE`数量最多的
2.  如果没有`OUR_ORDER`，`CUST_INVOICE`我希望它显示为空
3.  如果有`OUR_ORDER`并且没有，`CUST_INVOICE`我希望它显示为空

任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T23:42:59.097

从 GROUP BY 中删除 t3.CUST_INVOICE 并将 MAX(t3.CUST_INVOICE) 函数用于 SELECT 语句

```
SELECT t1.SUPPL_ORDERNO, t2.OUR_ORDER, MAX(t3.CUST_INVOICE) AS CUST_INVOICE
FROM t1 LEFT JOIN t2 ON t1.SUPPL_ORDERNO = t2.ORDER_REM5 
        LEFT JOIN t3 ON t2.ORDER_REM5  = t3.INV_REM5
GROUP BY t1.SUPPL_ORDERNO, t2.OUR_ORDER
ORDER BY t1.SUPPL_ORDERNO, t3.CUST_INVOICE 
```

[**SQLFiddle**](http://sqlfiddle.com/#!3/e26ae/1)上的简单示例[](http://sqlfiddle.com/#!3/e26ae/1)

 *** * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T22:01:36.877

解决此问题的最佳方法是使用`row_number()`. 这会为事物添加一个序列号，在本例中是每个订单中的发票号：

```
select suppl_orderno, our_order, cust_invoice
from (SELECT t1.SUPPL_ORDERNO, t2.OUR_ORDER, t3.CUST_INVOICE,
             row_number() over (partition by t1.SUPPL_ORDERNO, t2.OUR_ORDER order by t3.cust_invoice desc) as seqnum
      FROM t1 LEFT OUTER JOIN
           t2 
           ON t1.SUPPL_ORDERNO = t2.ORDER_REM5 LEFT OUTER JOIN
           t3
           ON t2.ORDER_REM5  = t3.INV_REM5
     ) t
where seqnum - 1
ORDER BY SUPPL_ORDERNO,CUST_INVOICE 
```

通过以降序对发票进行排序，最近的发票将获得值“1”，用于过滤器。**

# php - 按 ID 查询数据库以获取页面标题和内容

> ID：14187148
> 
> 赞同：0
> 
> 时间：2013-01-06T21:47:58.207
> 
> 标签：php, mysql, sql, content-management-system

这个很简单，但我今天转了这么多圈，完全迷路了！

我正在尝试根据我在页面顶部设置的变量来获取正确的页面标题和页面内容。IE：

```
<?php 
$pageIDn = 2;
include($_SERVER['DOCUMENT_ROOT'] .'/includes/functions.php');
content($pageIDn); // the function that queries the DB
include($_SERVER['DOCUMENT_ROOT'] .'/includes/header.php'); ?> 
```

在函数中，我有这个函数/查询：

```
function content($pageID){
    $query = mysql_query("SELECT * FROM pages WHERE id = 1");
    $title = $query['title'];
    $content = $query['content'];
} 
```

然后在文件中的相关位置，我试图回显变量，即：

```
<h2><?php echo $content; ?></h2> 
```

我知道我在这里某个地方犯了一个非常愚蠢的错误……只是不确定在哪里。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T21:49:39.140

你有三个**大**错误：

1.  你忘了把你`$pageID`的查询：

    ```
    $query = mysql_query("SELECT * FROM pages WHERE id = {$pageID}"); 
    ```

2.  ...获取您的结果：

    ```
    $row = mysql_fetch_assoc($query);
    $title = $row['title'];
    $content = $row['content']; 
    ```

3.  ...并返回并捕获您的输出：

    ```
    return array($title, $content);

    list($title, $content) = content($pageIDn); 
    ```

堆栈溢出：

```
$pageIDn = 2;
include($_SERVER['DOCUMENT_ROOT'] .'/includes/functions.php');
list($title, $content) = content($pageIDn); // the function that queries the DB
include($_SERVER['DOCUMENT_ROOT'] .'/includes/header.php'); ?>

function content($pageID){
    $query = mysql_query("SELECT * FROM pages WHERE id = {$pageID}");
    $row = mysql_fetch_assoc($query);
    $title = $row['title'];
    $content = $row['content'];
    return array($title, $content);
} 
```

另外，[**请不要`mysql_*`在新代码中使用函数**](https://stackoverflow.com/q/12859942/)。它们不再被维护[并被正式弃用](https://wiki.php.net/rfc/mysql_deprecation)。看到[**红框**](https://www.php.net/manual/en/function.mysql-connect.php)了吗？改为了解[*准备好的语句*](https://en.wikipedia.org/wiki/Prepared_statement)，并使用[PDO](http://php.net/pdo)或[MySQLi](http://php.net/mysqli) -[本文](https://php.net/manual/en/mysqlinfo.api.choosing.php)将帮助您决定使用哪个。如果您选择 PDO，[这里有一个很好的教程](http://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T21:53:47.737

你的第一个错误是忘记 MYSQL_ ***。使用PDO 第二，你说要抢$pageIDn = 2，但是你根本没有使用。

```
function content($pageID){
$query = mysql_query("SELECT * FROM pages WHERE id = ".$pageIDn." ");
$row = mysql_fetch_array($query);
$title = $query['title'];
$content = $query['content'];
 } 
```

# javascript - new MyObject() 不等于 new funcion MyObejct 如何让它们相等？

> ID：14187149
> 
> 赞同：0
> 
> 时间：2013-01-06T21:48:17.503
> 
> 标签：javascript, kendo-ui, javascript-objects

我有一个使用 case 返回对象的函数

```
 function GetModel(mymodel){

    var mydatamodel = null; 
    switch(mymodel)
    {
    case 'Contact':
    mydatamodel = kendo.data.Model.define({
                                    id: "__KEY",
                                    fields: {
                                    __KEY: { type: "string" },
                                    __STAMP: { type: "number" },
                                    ID: { editable: false, nullable: true },                                                                
                                    firstName: { type: "string" },
                                    middleName: { type: "string" },                                                         
                                    lastName: { type: "string" }
                                    }                               
                                });
                                break;

    case 'Address':
    mydatamodel = kendo.data.Model.define({
                                    id: "__KEY",
                                    fields: {
                                    __KEY: { type: "string" },
                                    __STAMP: { type: "number" },
                                    ID: { editable: false, nullable: true },                                                                
                                    street: { type: "string" }
                                    }                               
                                });
                                break;
    case 'ContactType':     
    mydatamodel = kendo.data.Model.define({
                                    id: "__KEY",
                                    fields: {
                                    __KEY: { type: "string" },
                                    __STAMP: { type: "number" },
                                    ID: { editable: false, nullable: true },                                                                
                                    name: { type: "string" }                                
                                    }                               
                                });
                                break;
    };

    return mydatamodel  
    };

//Try to create new instance
var mymodel = new GetModel("Contact") 
```

现在这个函数确实返回一个对象，但该对象与使用下面的代码创建一个新对象不同，这是我需要的

```
 var mydatamodel = kendo.data.Model.define({
                                    id: "__KEY",
                                    fields: {
                                    __KEY: { type: "string" },
                                    __STAMP: { type: "number" },
                                    ID: { editable: false, nullable: true },                                                                
                                    firstName: { type: "string" },
                                    middleName: { type: "string" },                                                         
                                    lastName: { type: "string" }
                                    }                               
                                });

//Create new object;
var mymodel = new mydatamodel(); 
```

这按预期工作并创建 kendoui.datamodel 的新实例，其中函数返回 kendoui.data.modal.... 作为函数而不是对象的新实例

我希望能够调用 switch 函数，因为我希望此代码位于不同的 .js 文件中，然后是用于代码分离的主 .html 页面。那么我将如何让上述函数 GetModel 以与 var = kendoui.data.model... 相同的方式运行

谢谢，

担

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T21:52:00.543

不要在你的函数上使用 new 运算符。

只需让函数返回一个像这样的实例：

```
function GetModel(mymodel){

var mydatamodel = null; 
switch(mymodel)
{
case 'Contact':
mydatamodel = kendo.data.Model.define({
                                id: "__KEY",
                                fields: {
                                __KEY: { type: "string" },
                                __STAMP: { type: "number" },
                                ID: { editable: false, nullable: true },                                                                
                                firstName: { type: "string" },
                                middleName: { type: "string" },                                                         
                                lastName: { type: "string" }
                                }                               
                            });
                            break;

case 'Address':
mydatamodel = kendo.data.Model.define({
                                id: "__KEY",
                                fields: {
                                __KEY: { type: "string" },
                                __STAMP: { type: "number" },
                                ID: { editable: false, nullable: true },                                                                
                                street: { type: "string" }
                                }                               
                            });
                            break;
case 'ContactType':     
mydatamodel = kendo.data.Model.define({
                                id: "__KEY",
                                fields: {
                                __KEY: { type: "string" },
                                __STAMP: { type: "number" },
                                ID: { editable: false, nullable: true },                                                                
                                name: { type: "string" }                                
                                }                               
                            });
                            break;
};

return new mydatamodel();
}; 
```

并像这样使用您的创建者功能：

```
var mymodel = GetModel("Contact"); 
```

编辑

或者像这样使用你的代码：

```
var mymodel = new (GetModel("Contact"))(); 
```

# java - 使用星号打印图形以在 Java 中显示数据。如果语句？

> ID：14187153
> 
> 赞同：3
> 
> 时间：2013-01-06T21:48:40.797
> 
> 标签：java, methods, graph

这是我的 Java 课程中的一个作业，我们必须使用方法来解决问题。我已经完成了大部分工作，但我遇到了麻烦。

任务：

图表有助于显示数据。创建一个类似于下图的表。生成的数字将被创建为 10,000 美元到 40,000 美元之间的随机数字。数字和图表显示了 10 月份批发商的销售额。请注意，它们每周 7 天不开放。（星期日是他们关闭的那一天，而在相关年份的 10 月 1 日、8 日、15 日、22 日和 29 日是星期日。生成该图表的原因是，每颗星代表 1,000 美元的销售额。

您的图表看起来不会完全像这样，因为每个程序中生成的随机数都不同。如图所示（右对齐）打印列中的日期。此外，星期一的销售额总是超过 30,000 美元，星期二的销售额总是超过 20,000 美元。星期六的销售额总是低于 15,000 美元。

样本输出：

```
Day Daily   Sales Graph
2   37081   *************************************
3   28355   ****************************
4   39158   ***************************************
5   24904   ************************
6   28879   ****************************
7   13348   *************

9   38791   **************************************
10  32564   ********************************
11  23867   ***********************
12  18154   ******************
13  25830   ***********************
14  14092   **************

16  36861   ************************************
17  26207   ************************
18  10921   **********
19  16573   ****************
20  33423   *********************************
21  12766   ************

23  33770   *********************************
24  28823   **************************
25  38883   **************************************
26  20959   ******************
27  16262   ****************
28  13269   *************

30  33557   *********************************
31  22579   ********************** 
```

我这里有大部分：

```
import java.util.*;
public class Prog310t
{
    public static Integer randomNumbers (int minNumber, int maxNumber)
    {
        Random gen = new Random();
        return (gen.nextInt(maxNumber - minNumber + 1) + minNumber);
    }

    public static String starLine (int numberOfAsterisks)
    {
        String stars = "";
        for (int i = 0; i < numberOfAsterisks; i++)
            stars = stars + "*";
        return stars;
    }

    public static void main (String args [])
    {
        int randomNumber;
        System.out.println("Day\tDaily\tSales Graph");
        for (int x = 2; x <= 31; x++)
        {
            if (x == 8 || x == 15 || x == 22 || x == 29)
            {
                System.out.println();
            }
            if (x == 2 || x == 9 || x == 16 || x == 23 || x == 30)
            {
                randomNumber = randomNumbers(30000, 40000);
                System.out.println(x + "\t" + randomNumber + "\t" + starLine(randomNumber / 1000));
            }
            if (x == 3 || x == 10 || x == 17 || x == 24 || x == 31)
            {
                randomNumber = randomNumbers(20000, 40000);
                System.out.println(x + "\t" + randomNumber + "\t" + starLine(randomNumber / 1000));
            }
            if (x == 7 || x == 14 || x == 21 || x == 28)
            {
                randomNumber = randomNumbers(10000, 15000);
                System.out.println(x + "\t" + randomNumber + "\t" + starLine(randomNumber / 1000));
            }
        }
    }
} 
```

其他日子我将如何让它输出？它只输出星期日（空白）、星期一、星期二和星期六。如何让它在其他日子输出而不必输入每一天的数字？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T22:10:24.363

使用 for 循环，只允许 31 天，嵌套在 for 循环中数周。检查特殊天数并根据天数生成随机数。

```
import java.util.*;
public class Prog310t
{
    public static Integer randomNumbers (int minNumber, int maxNumber)
    {
        Random gen = new Random();
        return (gen.nextInt(maxNumber - minNumber + 1) + minNumber);
    }

    public static String starLine (int numberOfAsterisks)
    {
        String stars = "";
        for (int i = 0; i < numberOfAsterisks; i++)
            stars = stars + "*";
        return stars;
    }

    public static void main (String args [])
    {
        int days = 1;
        for(int week = 0; week < 5; week++){
            for(int day = 1; day < 8 && days < 32; day++){
                int randomNumber = 0;
                    if(day==1){
                        randomNumber = 0;
                    }else if(day == 2){
                        randomNumber = randomNumbers(30000, 40000);
                    }else if(day==3){
                        randomNumber = randomNumbers(20000, 40000);
                    }else if(day==7){
                        randomNumber = randomNumbers(10000, 15000);
                    }else{
                        randomNumber = randomNumbers(10000, 40000);
                    }
                System.out.println(days + "\t" + randomNumber + "\t" + starLine(randomNumber / 1000));
                days++;
            }
        }
    }
} 
```

# python - Python：列表字典的排序表示，在删除重复项后按列表中元素的数量排序

> ID：14187155
> 
> 赞同：1
> 
> 时间：2013-01-06T21:48:44.133
> 
> 标签：python, sorting, dictionary

我有一本看起来像这样的字典：

```
example_dict = {
        0: [(1,2),(3,4),(3,4),(4,5)],
        1: [(1,2),(3,4),(5,6),(7,8)],
        2: [(4,5),(7,8)]} 
```

**在“临时”删除重复项之后**，我想通过每个列表中的元素数量来获得该字典的排序表示（仅出于排序目的，我不想删除删除元组）。所以 sorted`example_dict`将具有以下（升序）键顺序：2,0,1。

有没有有效的*Pythonic*方法来做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-06T21:53:57.073

```
print sorted(example_dict,key=lambda x: len(set(example_dict[x]))) 
```

输出：

```
[2, 0, 1] 
```

或者，如果您希望将字典项排序为元组列表：

```
print sorted(example_dict.items(),key=lambda x: len(set(x[1]))) 
```

输出：

```
[(2, [(4, 5), (7, 8)]), (0, [(1, 2), (3, 4), (3, 4), (4, 5)]), (1, [(1, 2), (3, 4), (5, 6), (7, 8)])] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T22:10:42.203

最适合您的数据结构可能是[`collections.OrderedDict`](http://docs.python.org/2.7/library/collections.html#collections.OrderedDict). 然后您可以按排序顺序遍历您的字典。

```
In [1]: from collections import OrderedDict

In [2]: example_dict_sorted = OrderedDict(sorted(example_dict.items(), key=lambda tup: len(set(tup[1]))))

In [3]: example_dict_sorted[0]
Out[3]: [(1, 2), (3, 4), (3, 4), (4, 5)]

In [4]: example_dict_sorted[1]
Out[4]: [(1, 2), (3, 4), (5, 6), (7, 8)]

In [5]: example_dict_sorted[2]
Out[5]: [(4, 5), (7, 8)]

In [6]: for key in example_dict_sorted:
   ...:     print key
2
0
1 
```

# android - Ant + Proguard 提供 android-support-v4.jar 错误

> ID：14187159
> 
> 赞同：1
> 
> 时间：2013-01-06T21:49:04.163
> 
> 标签：android, eclipse, ant, proguard, android-compatibility

使用 ANT 1.8.2 和 proguarg 4.8.1 构建项目时

```
 [proguard] Unexpected error while evaluating instruction:
 [proguard]   Class       = [android/support/v4/view/AccessibilityDelegateCompat$AccessibilityDelegateJellyBeanImpl]
 [proguard]   Method      = [newAccessiblityDelegateBridge(Landroid/support/v4/view/AccessibilityDelegateCompat;)Ljava/lang/Object;]
 [proguard]   Instruction = [18] areturn
 [proguard]   Exception   = [java.lang.IllegalArgumentException] (Can't find any super classes of [android/support/v4/view/AccessibilityDelegateCompatIcs$1] (not even immediate super class [android/view/View$AccessibilityDelegate]))
 [proguard] Unexpected error while performing partial evaluation:
 [proguard]   Class       = [android/support/v4/view/AccessibilityDelegateCompat$AccessibilityDelegateJellyBeanImpl]
 [proguard]   Method      = [newAccessiblityDelegateBridge(Landroid/support/v4/view/AccessibilityDelegateCompat;)Ljava/lang/Object;]
 [proguard]   Exception   = [java.lang.IllegalArgumentException] (Can't find any super classes of [android/support/v4/view/AccessibilityDelegateCompatIcs$1] (not even immediate super class [android/view/View$AccessibilityDelegate]))

BUILD FAILED
E:\adt-bundle-windows\sdk\tools\ant\build.xml:864: java.lang.IllegalArgumentException:     Can't find any super classes of [android/support/v4/view/AccessibilityDelegateCompatIcs$1] (not even immediate super class [android/view/View$AccessibilityDelegate]) 
```

`android-support-v4.jar`在类路径和项目依赖项中...从`Eclipse`所有`but debug`版本都构建好。Ant 显示这些错误...

如何避免这种情况？我知道如果`Eclipse`构建这个可以，`Ant`也必须构建..

**PS**我的项目是android-10目标，如果有人建议，我不想也不能使它成为目标16...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T22:24:17.353

您应该指定一个目标 SDK `project.properties`，在这种情况下包含“android.view.View$AccessibilityDelegate”（SDK 级别 14 或更高）。ProGuard 的收缩/优化/混淆至少需要与用于编译应用程序及其库的基本 SDK*相同*。支持库是针对这个更新的 SDK 编译的，所以 ProGuard 也需要它。

您仍然可以在您的`AndroidManifest.xml`, 中指定不同的目标/最小/最大 SDK 来运行应用程序。您当然应该确保应用程序确实与那些指定的 SDK 兼容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-28T16:53:52.220

尝试将这些添加到您的 proguard.cf 中怎么样？

```
-libraryjars   libs/android-support-v4.jar
-dontwarn android.support.v4.**    
-keep class android.support.v4.** { *; }  
-keep interface android.support.v4.app.** { *; }  
-keep public class * extends android.support.v4.**  
-keep public class * extends android.app.Fragment 
```

# c# - PetaPoco vs NPoco

> ID：14187162
> 
> 赞同：6
> 
> 时间：2013-01-06T21:49:16.867
> 
> 标签：c#, nuget, petapoco, npoco

`NPoco`似乎是一个实现`PetaPoco`. `PetaPoco`安装代码生成模板和`PetaPoco.cs`. Nuget 版本`PetaPoco`是 4.0.3。我知道有些版本（即 4.0.12）实现了`NPoco`.

如何同时使用代码生成`PetaPoco`和最新功能`NPoco`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T00:46:44.393

您应该能够将 PetaPoco 代码生成工具与 NPoco 一起使用，但是我没有测试它，因为我不使用/不喜欢它。

大多数方法是相同的，但您可能需要稍微调整它们。您可以将`TT`文件放入您的项目并运行它们以及将 NPoco 添加到您的项目中。

如果您确实让它们工作，请告诉我，我可能会考虑将它们重新添加到 NPoco。;)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-04-24T17:46:14.043

您可以使用[此项目的](https://github.com/Rhysling/NPoco.T4)T4 模板生成由 NPoco 支持的类

# c# - 比较图像时索引超出数组范围

> ID：14187170
> 
> 赞同：0
> 
> 时间：2013-01-06T21:50:04.443
> 
> 标签：c#, .net, winforms, image, bitmap

我正试图弄清楚这一点。我正在比较程序中的图像。在大多数情况下，当我尝试比较图像时，我没有任何问题。虽然当我使用几种不同的组合时，我得到了这个错误。我最初认为是因为图像格式不同。虽然事实并非如此。

如果我拍摄每张图像并将它们与其他图像进行比较，则效果很好。只是不是在相互比较时。我在下面标出了错误出现的位置。

```
public Color this[int x, int y]
{
    get
    {
        int index = (x + (y * image.Width)) * 4;
        return Color.FromArgb(rgbValues[index + 3], rgbValues[index + 2], rgbValues[index + 1], rgbValues[index]); //This line is where the index out of bounds of the array error happens.
    }

    set
    {
        int index = (x + (y * image.Width)) * 4;
        rgbValues[index] = value.B;
        rgbValues[index + 1] = value.G;
        rgbValues[index + 2] = value.R;
        rgbValues[index + 3] = value.A;
    }
}

/// <summary>
/// Width of the image. 
/// </summary>
public int Width
{
    get
    {
        return image.Width;
    }
}

/// <summary>
/// Height of the image. 
/// </summary>
public int Height
{
    get
    {
        return image.Height;
    }
}

/// <summary>
/// Returns the modified Bitmap. 
/// </summary> 
```

我将不胜感激任何帮助。我很困惑为什么它只在图像组合使用时才会发生。

如果您想知道如何加载图像，我会在 vb.net 中进行。C# 代码位于 dll 中。这是我将位图加载到内存的 vb.net 代码。图像尺寸也为：431x253

```
Dim bm As Bitmap = Bitmap.FromFile(Label1.Text)
Dim bm2 As Bitmap = Bitmap.FromFile(Label2.Text)
' Dim pnt As Point = ImageFinder.Contains(bm, bm2)
Dim ir As New ImageChecker(bm, bm2)
Dim imageContains As Boolean = ir.findimageboolean()
MessageBox.Show(imageContains) 
```

编辑：这是 DLL 的完整代码

```
using System;
using System.Collections.Generic;
using System.Drawing;
using System.Linq;
using System.Text;
using System.IO;

namespace ImageRecognition
{
    public class LockedFastImage
    {
        private Bitmap image;
        private byte[] rgbValues;
        private System.Drawing.Imaging.BitmapData bmpData;

        private IntPtr ptr;
        private int bytes;

        public LockedFastImage(Bitmap image)
        {
            this.image = image;
            Rectangle rect = new Rectangle(0, 0, image.Width, image.Height);
            bmpData = image.LockBits(rect, System.Drawing.Imaging.ImageLockMode.ReadWrite, image.PixelFormat);

            ptr = bmpData.Scan0;
            bytes = Math.Abs(bmpData.Stride) * image.Height;
            rgbValues = new byte[bytes];
            System.Runtime.InteropServices.Marshal.Copy(ptr, rgbValues, 0, bytes);
        }

        ~LockedFastImage()
        {
            // Try to unlock the bits. Who cares if it dont work...
            try
            {
                image.UnlockBits(bmpData);
            }
            catch { }
        }

        /// <summary>
        /// Returns or sets a pixel of the image. 
        /// </summary>
        /// <param name="x">x parameter of the pixel</param>
        /// <param name="y">y parameter of the pixel</param>
        public Color this[int x, int y]
        {
            get
            {
                int index = (x + (y * image.Width)) * 4;
                return Color.FromArgb(rgbValues[index + 3], rgbValues[index + 2], rgbValues[index + 1], rgbValues[index]);
            }

            set
            {
                int index = (x + (y * image.Width)) * 4;
                rgbValues[index] = value.B;
                rgbValues[index + 1] = value.G;
                rgbValues[index + 2] = value.R;
                rgbValues[index + 3] = value.A;
            }
        }

        /// <summary>
        /// Width of the image. 
        /// </summary>
        public int Width
        {
            get
            {
                return image.Width;
            }
        }

        /// <summary>
        /// Height of the image. 
        /// </summary>
        public int Height
        {
            get
            {
                return image.Height;
            }
        }

        /// <summary>
        /// Returns the modified Bitmap. 
        /// </summary>
        public Bitmap asBitmap()
        {
            System.Runtime.InteropServices.Marshal.Copy(rgbValues, 0, ptr, bytes);
            return image;
        }
    }

    public class ImageChecker
    {

        private LockedFastImage big_image;
        private LockedFastImage small_image;
        /// <summary>
        /// The time needed for last operation.
        /// </summary>
        public TimeSpan time_needed = new TimeSpan();

        /// <summary>
        /// Error return value.
        /// </summary>
        static public Point CHECKFAILED = new Point(-1, -1);

        /// <summary>
        /// Constructor of the ImageChecker
        /// </summary>
        /// <param name="big_image">The image containing the small image.</param>
        /// <param name="small_image">The image located in the big image.</param>
        public ImageChecker(Bitmap big_image, Bitmap small_image)
        {
            this.big_image = new LockedFastImage(big_image);
            this.small_image = new LockedFastImage(small_image);
        }

        /// <summary>
        /// Returns the location of the small image in the big image. Returns CHECKFAILED if not found.
        /// </summary>
        /// <param name="x_speedUp">speeding up at x achsis.</param>
        /// <param name="y_speedUp">speeding up at y achsis.</param>
        /// <param name="begin_percent_x">Reduces the search rect. 0 - 100</param>
        /// <param name="end_percent_x">Reduces the search rect. 0 - 100</param>
        /// <param name="begin_percent_x">Reduces the search rect. 0 - 100</param>
        /// <param name="end_percent_y">Reduces the search rect. 0 - 100</param>
        public Point bigContainsSmall(int x_speedUp = 4, int y_speedUp = 4, int begin_percent_x = 0, int end_percent_x = 100, int begin_percent_y = 0, int end_percent_y = 100)
        {
            /*
             * SPEEDUP PARAMETER
             * It might be enough to check each second or third pixel in the small picture.
             * However... In most cases it would be enough to check 4 pixels of the small image for diablo porposes.
             * */

            /*
             * BEGIN, END PARAMETER
             * In most cases we know where the image is located, for this we have the begin and end paramenters.
             * */

            DateTime begin = DateTime.Now;

            if (x_speedUp < 1) x_speedUp = 1;
            if (y_speedUp < 1) y_speedUp = 1;
            if (begin_percent_x < 0 || begin_percent_x > 100) begin_percent_x = 0;
            if (begin_percent_y < 0 || begin_percent_y > 100) begin_percent_y = 0;
            if (end_percent_x < 0 || end_percent_x > 100) end_percent_x = 100;
            if (end_percent_y < 0 || end_percent_y > 100) end_percent_y = 100;

            int x_start = (int)((double)big_image.Width * ((double)begin_percent_x / 100.0));
            int x_end = (int)((double)big_image.Width * ((double)end_percent_x / 100.0));
            int y_start = (int)((double)big_image.Height * ((double)begin_percent_y / 100.0));
            int y_end = (int)((double)big_image.Height * ((double)end_percent_y / 100.0));

            /*
             * We cant speed up the big picture, because then we have to check pixels in the small picture equal to the speeded up size 
             * for each pixel in the big picture.
             * Would give no speed improvement.
             * */

            //+ 1 because first pixel is in picture. - small because image have to be fully in the other image
            for (int x = x_start; x < x_end - small_image.Width + 1; x++)
                for (int y = y_start; y < y_end - small_image.Height + 1; y++)
                {
                    //now we check if all pixels matches
                    for (int sx = 0; sx < small_image.Width; sx += x_speedUp)
                        for (int sy = 0; sy < small_image.Height; sy += y_speedUp)
                        {
                            if (small_image[sx, sy] != big_image[x + sx, y + sy])
                                goto CheckFailed;
                        }

                    //check ok
                    time_needed = DateTime.Now - begin;
                    return new Point(x, y);

                CheckFailed: ;
                }

            time_needed = DateTime.Now - begin;
            return CHECKFAILED;
        }
         public Boolean findimageboolean(int x_speedUp = 1, int y_speedUp = 1, int begin_percent_x = 0, int end_percent_x = 100, int begin_percent_y = 0, int end_percent_y = 100)
        {
            /*
             * SPEEDUP PARAMETER
             * It might be enough to check each second or third pixel in the small picture.
             * However... In most cases it would be enough to check 4 pixels of the small image for diablo porposes.
             * */

            /*
             * BEGIN, END PARAMETER
             * In most cases we know where the image is located, for this we have the begin and end paramenters.
             * */

            DateTime begin = DateTime.Now;

            if (x_speedUp < 1) x_speedUp = 1;
            if (y_speedUp < 1) y_speedUp = 1;
            if (begin_percent_x < 0 || begin_percent_x > 100) begin_percent_x = 0;
            if (begin_percent_y < 0 || begin_percent_y > 100) begin_percent_y = 0;
            if (end_percent_x < 0 || end_percent_x > 100) end_percent_x = 100;
            if (end_percent_y < 0 || end_percent_y > 100) end_percent_y = 100;

            int x_start = (int)((double)big_image.Width * ((double)begin_percent_x / 100.0));
            int x_end = (int)((double)big_image.Width * ((double)end_percent_x / 100.0));
            int y_start = (int)((double)big_image.Height * ((double)begin_percent_y / 100.0));
            int y_end = (int)((double)big_image.Height * ((double)end_percent_y / 100.0));

            /*
             * We cant speed up the big picture, because then we have to check pixels in the small picture equal to the speeded up size 
             * for each pixel in the big picture.
             * Would give no speed improvement.
             * */

            //+ 1 because first pixel is in picture. - small because image have to be fully in the other image
            for (int x = x_start; x < x_end - small_image.Width + 1; x++)
                for (int y = y_start; y < y_end - small_image.Height + 1; y++)
                {
                    //now we check if all pixels matches
                    for (int sx = 0; sx < small_image.Width; sx += x_speedUp)
                        for (int sy = 0; sy < small_image.Height; sy += y_speedUp)
                        {
                            if (small_image[sx, sy] != big_image[x + sx, y + sy])
                                goto CheckFailed;
                        }

                    //check ok
                    time_needed = DateTime.Now - begin;
                    return true;

                CheckFailed: ;
                }

            time_needed = DateTime.Now - begin;
             return false;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T07:03:20.297

如果**Stride**是负数，您需要以不同的方式复制图像字节，所以我对您的构造函数进行了一些修改：

```
 public LockedFastImage(Bitmap image)
    {
        this.image = image;
        Rectangle rect = new Rectangle(0, 0, image.Width, image.Height);
        bmpData = image.LockBits(rect, System.Drawing.Imaging.ImageLockMode.ReadWrite, PixelFormat.Format32bppArgb);

        ptr = bmpData.Scan0;
        bytes = Math.Abs(bmpData.Stride) * image.Height;
        rgbValues = new byte[bytes];
        if (bmpData.Stride < 0)
        {
            int lines, pos, BytesPerLine = Math.Abs(bmpData.Stride);
            for (lines = pos = 0; lines < image.Height; lines++, pos += BytesPerLine)
            {
                System.Runtime.InteropServices.Marshal.Copy(ptr, rgbValues, pos, BytesPerLine);
                ptr = (IntPtr)(ptr.ToInt64() + bmpData.Stride);
            }
        }
        else
            System.Runtime.InteropServices.Marshal.Copy(ptr, rgbValues, 0, bytes);
    } 
```

如果您将像素数据存储为 ARGB，则需要使用相应的**PixelFormat**锁定像素。我还修改了您的访问器：

```
 public Color this[int x, int y]
    {
        get
        {
            int index = y * (image.Width << 2) + x;
            return Color.FromArgb(rgbValues[index + 3], rgbValues[index + 2], rgbValues[index + 1], rgbValues[index]);
        }

        set
        {
            int index = y * (image.Width << 2) + x;
            rgbValues[index] = value.B;
            rgbValues[index + 1] = value.G;
            rgbValues[index + 2] = value.R;
            rgbValues[index + 3] = value.A;
        }
    } 
```

顺便说一句，我还没有测试过这段代码！

* * *

严格来说，您应该保存`BytesPerLine`为私有字段，然后`index`在您的访问器中使用它来计算。所以你应该把它`(image.Width << 2)`改成`BytesPerLine`.
您也可以尝试将您的*get*访问器更改为以下内容（不确定它是否更快，但如果您愿意，可以尝试）：

```
 get
    {
        return Color.FromArgb(BitConverter.ToInt32(rgbValues, y * (image.Width << 2) + x));
    } 
```

# google-chrome-extension - 无法发布我的谷歌浏览器扩展

> ID：14187171
> 
> 赞同：0
> 
> 时间：2013-01-06T21:50:10.143
> 
> 标签：google-chrome-extension

当我尝试通过网上商店发布我的 chrome 扩展时，我遇到了一个奇怪的问题。每次我上传 zip 文件时，我都会收到此错误：发生错误：无法包含对文件的访问权限。

我什至尝试上传一个仅包含清单文件的 zip 文件，但我仍然遇到同样的错误。

任何想法 ？

谢谢

清单文件：

```
{
"name": "__MSG_plugin_name__",
"version": "0.0.0.1",
"manifest_version": 2,
"description": "__MSG_plugin_description__",
"browser_action": {
    "default_icon": "images/ST_19.png",  
    "default_title": "__MSG_plugin_title__",
    "default_popup": "popup.html"
},
"icons":{
     "16": "images/ST_16.png",
     "48": "images/ST_48_1.png",
     "128": "images/ST_128.png"
},
"default_locale": "en",
"permissions": [
    "contextMenus",
    "tabs", "http://*/*", "file:///*","https://*/*", "ftp://*/*"
],
"background": {
    "persistent": false,
    "scripts": ["scripts/jquery.min.js","scripts/utils.js", "scripts/menus.js","scripts/logic.js"]
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T22:08:01.430

所以我隔离了这件事：“”file:///*“”是错误的，因为我希望扩展在任何打开的 url 上运行，我使用“”作为权限。清单文件中的更改是：

```
"permissions": [
"contextMenus",
"tabs", "<all_urls>"
] 
```

谢谢大家

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-24T14:40:57.317

是的，ndongo 是正确的，Chrome 抱怨它没有域或路径（就像其他协议一样）。

你必须写你的 URL 的方式必须是`protocol://domain/path`（注意你可以使用 * 或？）

所以你可以替换`"file:///*"`为`"file:///*/*"`或使用`"<all_urls>"`

# makefile - Windows 上的自动配置

> ID：14187172
> 
> 赞同：1
> 
> 时间：2013-01-06T21:50:13.883
> 
> 标签：makefile, mingw, autoconf

我目前正在尝试使用 MinGW 在 Windows 7 上编译 Freeglut。问题是只有一个makefile.am 和一个makefile.in。感谢谷歌，我发现这些属于 autoconf。问题是我没有找到 autoconf.exe 文件，只有 MSYS 或 Cygwin 的文件。

有没有办法获取/编译exe文件？如果有，它是否也可用于 x64 窗口？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T01:40:25.947

实际上，Makefile.am 是 automake 的输入，而 Makefile.in 是转换为实际 Makefile 的模板。

如果您安装了 MSYS，那么您可以解压缩 tarball，然后运行`./configure`然后`make`构建它。

[但是，当其他人已经制作了32 位和 64 位 Windows 二进制文件](http://www.transmissionzero.co.uk/software/freeglut-devel/)时，为什么还要这样做呢？

# php - 为新记录初始化视图变量

> ID：14187173
> 
> 赞同：0
> 
> 时间：2013-01-06T21:50:17.627
> 
> 标签：php, model-view-controller, pdo

在我的 MVC 中，我使用数组使用模型中的数据填充表单。我正在使用 PDO 并获取关联数组，这提供了一个可用于填充视图的字段数组。

当用户请求新记录时，数组为空，除非我在使用前明确测试每个变量的值，否则脚本会因索引不存在而崩溃。

我以前的方法是，对于新记录，设置一个空数组并将其传递给视图。这对于简单的表单来说很好，但是当视图需要使用 10-15 个变量时，这有点乏味。

这样做的首选方法是什么？我的视图应该在使用前测试每个字段，还是应该创建空数组。如果是这样，应该在控制器或模型中创建空数组吗？

* * *

例如，如果用户想要编辑现有记录，控制器将 ID 号传递给模型并要求它提供记录的当前值数组。

控制器将此数组传递给视图，然后视图将值合并到一个表单中以进行编辑。

相反，当控制器收到*新*记录的请求时，它知道向模型询问记录是没有意义的，因为它是新的。它不能只调用视图，因为传递的数组不包含表单所需的键。

我目前的方法是初始化一个空键数组，但这似乎很乏味、浪费时间并且容易出错，因为如果模型发生变化则需要对其进行维护。

例如：

```
$this->view->class['Code']=NULL;
$this->view->class['Description']=NULL;
$this->view->class['Image']=NULL;
$this->view->class['Judge']=NULL;
$this->view->class['Entries']=NULL;
$this->view->class['Absentees']=NULL; 
```

ETC

一定有更好的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T23:39:09.573

这对于糟糕的 MVC 设计来说是一种创可贴，但你可以使用这样的函数，

```
function idx(&$array, $index = 0, $default = null) {
  return isset($array[$index]) ? $array[$index] : $default
} 
```

在视图中如果你正常做`$class['Description']`

你现在可以使用`idx($class, 'Description')`

* * *

您不必单独传递模型的每个属性。相反，只需传递整个模型对象并从视图中访问它。例子：

`$this->view->entry = $myModelInstance;`where是具有 Code、Description、Image、Judges 等属性`$myModelInstance`的实例或任何类。`Entry`

然后在视图中，使用类似`$entry->Description`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T22:32:03.817

在我看来，设置 propper 默认值是一个模型问题。

想象这样一个类：

```
class Car {

    protected $color;

    protected $vendor;

    public function __construct($color, $vendor) {
        $this->color = $color;
        $this->vendor = $vendor;
    }

    public static function getDefault() {
        return new Car('unknown', 'unknown');       
    } 

} 
```

然而。你告诉过你使用数组。您会为数组找到类似的方法。我建议编写一个类似的函数`getDefaultWhatever()`并将其放在代码的**模型**部分中。

# c# - Visual Studio、图表、轴 x 点名称

> ID：14187176
> 
> 赞同：2
> 
> 时间：2013-01-06T21:51:06.870
> 
> 标签：c#, sql, charts

我正在创建一个小程序，它通过图表按月显示我们的总销售额，我需要通过我的 SQL 响应名称（2012'7、2012'8、2012 调用 X 轴点（1、2、3、4、5） '9），但找不到如何做到这一点。

![在此处输入图像描述](../Images/77575db2b409bd8d6d95f96e95dc1017.png)

代码：

```
 sqlQuery = "SELECT YEAR(`importdate`) as 'Year', MONTH(`importdate`) as 'Month', SUM(`price`) as 'Sum' FROM `wagon` GROUP BY MONTH(`importdate`), YEAR(`importdate`) ORDER BY YEAR(`importdate`), MONTH(`importdate`) ASC LIMIT 12";

        MySqlConnection sqlConnection = new MySqlConnection(sqlParams);
        MySqlCommand sqlCommand = new MySqlCommand(sqlQuery, sqlConnection);

        chart1.ChartAreas["ChartArea1"].AxisX.MajorGrid.LineColor = Color.Gainsboro;
        chart1.ChartAreas["ChartArea1"].AxisY.MajorGrid.LineColor = Color.Gainsboro;

        try
        {
            sqlConnection.Open();

            MySqlDataReader sqlReader = sqlCommand.ExecuteReader();

            if (sqlReader.HasRows)
            {
                while (sqlReader.Read())
                {
                    string Sum = sqlReader["Sum"].ToString();
                    if (Sum.Contains(",")) Sum = Sum.Replace(",", ".");

                    string serieName = "Series1";
                   // string serieName = sqlReader["Year"].ToString() + '\'' + sqlReader["Month"].ToString();
                   // chart1.Series.Add(sqlReader["Year"].ToString() + '\'' + sqlReader["Month"].ToString());

                   // chart1.Series[serieName].ChartArea = "ChartArea1";

                    chart1.Series[serieName].Points.AddY(Sum);

                    chart1.Series[serieName].ChartType = SeriesChartType.Line;
                    chart1.Series[serieName].IsValueShownAsLabel = true;
                    //sqlReader["Year"].ToString() + '"' + sqlReader["Month"].ToString()
                }
            }
        } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-06T21:53:29.160

如果我说对了，您可以使用：

```
Chart1.ChartAreas(0).AxisX.CustomLabels.Add(0.5, 1.5, "1");
            Chart1.ChartAreas(0).AxisX.CustomLabels.Add(1.5, 2.5, "2");
            Chart1.ChartAreas(0).AxisX.CustomLabels.Add(2.5, 3.5, "3");
            Chart1.ChartAreas(0).AxisX.CustomLabels.Add(3.5, 4.5, "4");
            Chart1.ChartAreas(0).AxisX.CustomLabels.Add(4.5, 5.5, "5"); 
```

前两个数字决定了这些标签的传播范围。第三是标签本身。

# c - 为什么函数参数的名称在调用时与声明时不同？

> ID：14187178
> 
> 赞同：1
> 
> 时间：2013-01-06T21:51:10.660
> 
> 标签：c, function, variables, arguments

在下面的`main`函数中，我正在调用`circleArea()`并告诉它我想使用参数`circleRadius`。

之后，在`circleArea()`函数声明中，我将参数的名称更改为`theRadius`.

据我了解，由于我在调用函数时声明了一个参数，所以当我声明函数时，它知道我想在函数中使用哪个值，我可以给它一个不同的名称。真的吗？

如果是，当我想在函数中使用多个参数时会发生什么？

```
int main()
{    
    float pictureWidth, pictureHeight, pictureSurfaceArea,
    circleRadius, circleSurfaceArea; // [4.4]
    pictureWidth = 8.0;
    pictureHeight = 4.5;
    circleRadius = 5.0; // [4.7]

    pictureSurfaceArea = pictureWidth * pictureHeight;

    // Here we call our function
    circleSurfaceArea = circleArea(circleRadius); 
}

float circleArea(float theRadius) // [5.1]
{
    float theArea;
    theArea = 3.1416 * theRadius * theRadius; // pi times r square [5.4]
    return theArea;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T21:55:59.467

是的你是对的。函数内变量的本地名称可以是您想要的任何名称，相关的是

*   调用函数时必须对应的参数类型
*   位置（如果是第一个，第二个，无论如何）

实际上，一旦您的代码被编译，生成的二进制文件就根本没有您的参数的任何名称。这是合法的：

```
void method(int a, int b);

int main()
{
  int z,x,y;

  method(x,y);
  method(z,y);
}

void method(int a, int b) {
  //
} 
```

参数的范围与函数的每个局部变量相同，并且仅在该函数内部有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-06T21:57:48.003

> 在`circleArea()`函数声明中，我们将参数的名称更改为 theRadius [...]，因为我们在调用函数时声明了一个参数，所以当我们声明函数时，它知道我们要在函数中使用哪个值，并且我们可以给它一个不同的名字。

我不确定你的意思是什么......**参数的名称仅在函数的****实现**（或“主体”）内部时才重要。函数体使用参数的名称来引用它的参数。**调用**（而不是定义）函数时传入的**变量**的名称是什么并不重要。它甚至可能没有名称，因为您可以传递任何表达式，也可以，在这种情况下，参数甚至没有“名称”（嗯，很难使用正确的术语来解释）。**`circleSurfaceArea = circleArea(1.0);`**

 **> 当我想在函数中使用超过 1 个参数时发生了什么？

然后使用逗号分隔参数：

```
float rectangleArea(float a, float b); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-07T07:20:40.197

```
int main()
{    
   float pictureWidth, pictureHeight, pictureSurfaceArea,
   circleRadius, circleSurfaceArea; // [4.4]
   pictureWidth = 8.0;
   pictureHeight = 4.5;
   circleRadius = 5.0; // [4.7]

   pictureSurfaceArea = pictureWidth * pictureHeight;

   // Here we call our function
  circleSurfaceArea = circleArea(circleRadius); 
}

float circleArea(float theRadius) // [5.1]
{
   float theArea;
   theArea = 3.1416 * theRadius * theRadius; // pi times r square [5.4]
   return theArea;
} 
```

在上面的代码中，在main函数中你只是传递了circleRadius[实际参数]的值，所以这个值将被复制到形式参数[theRadius]，这里与参数名称无关，你可以取同名为形式论据。在多个参数中也与参数名称无关，仅它会采用参数值并计算并返回结果。但是在传递参数时您需要集中精力的是您应该将形式参数的“数据类型”声明为与实际参数相同。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-06T22:12:30.620

函数`prototype`由函数名称和它的参数类型列表组成，而不是名称。即编译器不会“看到”参数名称。当编译器看到你的调用

```
circleSurfaceArea = circleArea(circleRadius) 
```

它看到你调用函数`circleArea(float)`，因为`circleRadius`is `float`。这与您的定义相匹配，因此编译器将调用与定义绑定。参数的名称无关紧要。

这是为了您的舒适，因为它通常适合在函数体内以不同于函数调用的方式命名参数（这里的参数被命名为“参数”）。这是一些旧语言中不存在的封装形式，例如[http://en.wikipedia.org/wiki/GOSUB](http://en.wikipedia.org/wiki/GOSUB)

封装有助于分离函数使用和函数实现。

如果您想要超过 1 个参数，请声明并定义更多参数。同样，编译器不会看到名称，只会看到类型。

我的回答是关于`C`不`objective-C`。可能这里是巧合。**

# javascript - 对象属性存在但返回未定义？

> ID：14187179
> 
> 赞同：1
> 
> 时间：2013-01-06T21:51:12.170
> 
> 标签：javascript

我在脚本中有一个自定义类/对象。在其中一种对象方法中，当我运行以下命令时：

```
MapLabel.prototype.show = function()
{
    console.log(this);         // Here are the
    console.log(this.canvas);  // lines in question

    if (!this.canvas) // this is not giving the expected result
    {
        console.log('canvas doesnt exist to show');
        return;
    }

    console.log('showing maplabel');
    this.visible = true;

    this.canvas.style['visibility'] = 'visible';
    this.marker.setVisible(true);
} 
```

我得到以下信息：

```
MapLabel {gm_accessors_: Object, fontFamily: "'Droid Sans', 'Helvetica Neue', 
Helvetica, Arial, sans-serif", gm_bindings_: Object, fontSize: 14, fontColor: "#FFFFFF"…}
__e3_: Object
align: "center"
canvas: <canvas>
fontColor: "#FFFFFF"
fontFamily: "'Droid Sans', 'Helvetica Neue', Helvetica, Arial, sans-serif"
fontSize: 14
gm_accessors_: Object
gm_bindings_: Object
gm_props_: Hu
id: 216
map: xh
marker: Ah
markerImage: Qh.MarkerImage
minZoom: 5
position: Q
strokeColor: "#000000"
strokeWeight: 4
text: "Sometext"
visible: false
zIndex: 100
__proto__: Dh

undefined    // <---- this.canvas = undefined even though it exists? 
```

您可以在输出中看到`this.canvas`存在并具有值。但是当`console.log(this.canvas)`紧随其后运行时，它会返回`undefined`.

我在这里缺少什么吗？

**更新：我添加了调用代码的函数**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T22:35:03.960

只是一个疯狂的猜测，但“问题”可能出在 Chrome 控制台上。当您将`this`上下文输出到调试器时，控制台会在检查时显示**当前**值，而不是在执行时显示。

[看看这个小提琴](http://jsfiddle.net/3qxds/)。当您单击该按钮时，您将在控制台中看到：

```
The current value is: {"hello":"world"} 
The this context is > Thing {hello: "world"} 
changing value of this.hello... 
The current value is: {"hello":"Cleveland"} 
```

现在通过单击前面的箭头打开对象检查器`> Thing {hello: "world"}`，您将看到：

```
The current value is: {"hello":"world"} 
The this context is  Thing {hello: "world"}
  hello: "Cleveland"                              <-- Surprise!
  test: function () {
  __proto__: Thing
changing value of this.hello... 
The current value is: {"hello":"Cleveland"} 
```

在这种情况下，在执行时`this.canvas`确实*是未定义的。*

为了确保，您可以`console.log(this.canvas)`改为。

# actionscript-3 - 如何将位图转换为字节数组？

> ID：14187181
> 
> 赞同：1
> 
> 时间：2013-01-06T21:51:26.910
> 
> 标签：actionscript-3

我必须将位图保存到共享对象中……我在网上读到，为了做到这一点，我必须将其转换为字节数组……但我不确定该怎么做……有人可以解释一下吗我一步一步地介绍如何将位图转换为字节数组..

这是我正在使用的代码

```
var btm:BitmapData;
var x_d:Array = new Array();

orange.addEventListener( MouseEvent.CLICK, firstc);
    function firstc (x:MouseEvent){

        btm = new BitmapData(200,200);
       x_d[0] = new Bitmap (btm);
        addChild(x_d[0]);
        btm.draw (orange);
            gotoAndStop(3);

    }; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T09:10:28.917

如果你想要原始数据，你应该使用[getPixels()](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/BitmapData.html#getPixels%28%29)方法，但如果你想存储压缩为 jpg 或 png 的位图数据，请这样做：

**PNG**

```
btm = new BitmapData(200,200);
...
var stream:ByteArray = PNGEncoder.encode( btm ); 
```

**JPG**

```
btm = new BitmapData(200,200);
...
var jpgEncoder:JPGEncoder = new JPGEncoder( 90 );
var stream:ByteArray = jpgEncoder.encode( btm ); 
```

对于 PNGEncoder 和 JPGEncoder 类使用[as3corelib](https://github.com/mikechambers/as3corelib)

如果您使用 Flash Player 11.3 及更高版本定位用户，则可以使用[本机编码器](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/BitmapData.html#encode%28%29)

# scala - Scala 通用但未知的参数

> ID：14187185
> 
> 赞同：2
> 
> 时间：2013-01-06T21:51:55.197
> 
> 标签：scala, generics

我在使用 Scala 中的泛型参数定义方法时遇到了麻烦。

假设我想要这样的东西：

```
class CollectionConverter {
   def convertListToSet(list: java.util.List[SomeType]): java.util.Set[SomeType] = {
     val s = new java.util.HashSet[SomeType]
     s.addAll(list)
     s
   }
} 
```

我似乎无法找到一种方法让 Scala 明白我不知道 SomeType 是什么，只是不管它是什么，返回的泛型集都将具有与提供的列表相同的泛型类型。它抱怨我没有定义 SomeType。但这就是问题——我不知道也不关心 SomeType 是什么，我只关心它可以被称为 YeahYeahYeah。

我不想使用 List[Any]，而 List[_] 会产生其他问题，所以......这样做的正确方法是什么？

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-06T21:54:55.270

这就是方法的类型参数的用途。

```
def convertListToSet[SomeType](list: java.util.List[SomeType]): java.util.Set[SomeType] = {
   val s = new java.util.HashSet[SomeType]
   s.addAll(list)
   s
} 
```

# javascript - 如何通过 javascript 将 SLD 样式动态添加到 WMS 层

> ID：14187187
> 
> 赞同：3
> 
> 时间：2013-01-06T21:52:00.030
> 
> 标签：javascript, openlayers, geoserver

使用 OPENLAYERS + GEOSERVER + JAVASCRIPT + SERVLET + AJAX

我有一个 servlet 可以接收 ajax 调用并返回所有国家/地区的人口。我想以这样的方式添加 SLD，WMS 图层将为人口少于 50,000 的国家显示红色，为人口超过 50,000 的国家显示绿色。所以最终我想根据我从 ajax 调用获得的结果在 javascript 中为 WMS 层设计 SLD 样式。是否可以在 javascript 中应用 SLD ..？如果是这样，请提供示例代码。谢谢你的耐心。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-07T10:42:34.137

我自己没有尝试过，但它是如何工作的：

首先在你的 js 代码中定义 SLD

```
var sld = '<?xml version="1.0" encoding="ISO-8859-1"?>';
sld += '<StyledLayerDescriptor version="1.0.0"'; 
sld += '    xsi:schemaLocation="http://www.opengis.net/sld StyledLayerDescriptor.xsd" ';
sld += '    xmlns="http://www.opengis.net/sld" ';
sld += '    xmlns:ogc="http://www.opengis.net/ogc" ';
sld += '    xmlns:xlink="http://www.w3.org/1999/xlink" ';
sld += '    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">';
sld += '  <NamedLayer>';
sld += '    <Name>Attribute-based polygon</Name>';
sld += '    <UserStyle>';
sld += '      <Title>SLD Cook Book: Attribute-based polygon</Title>';
sld += '      <FeatureTypeStyle>';
sld += '        <Rule>';
sld += '          <Name>SmallPop</Name>';
sld += '          <Title>Less Than 200,000</Title>';
sld += '          <ogc:Filter>';
sld += '            <ogc:PropertyIsLessThan>';
sld += '              <ogc:PropertyName>pop</ogc:PropertyName>';
sld += '              <ogc:Literal>200000</ogc:Literal>';
sld += '            </ogc:PropertyIsLessThan>';
sld += '          </ogc:Filter>';
sld += '          <PolygonSymbolizer>';
sld += '            <Fill>';
sld += '              <CssParameter name="fill">#66FF66</CssParameter>';
sld += '            </Fill>';
sld += '          </PolygonSymbolizer>';
sld += '        </Rule>';
sld += '        <Rule>';
sld += '          <Name>MediumPop</Name>';
sld += '          <Title>200,000 to 500,000</Title>';
sld += '          <ogc:Filter>';
sld += '            <ogc:And>';
sld += '              <ogc:PropertyIsGreaterThanOrEqualTo>';
sld += '                <ogc:PropertyName>pop</ogc:PropertyName>';
sld += '                <ogc:Literal>200000</ogc:Literal>';
sld += '              </ogc:PropertyIsGreaterThanOrEqualTo>';
sld += '              <ogc:PropertyIsLessThan>';
sld += '                <ogc:PropertyName>pop</ogc:PropertyName>';
sld += '                <ogc:Literal>500000</ogc:Literal>';
sld += '              </ogc:PropertyIsLessThan>';
sld += '            </ogc:And>';
sld += '          </ogc:Filter>';
sld += '          <PolygonSymbolizer>';
sld += '            <Fill>';
sld += '              <CssParameter name="fill">#33CC33</CssParameter>';
sld += '            </Fill>';
sld += '          </PolygonSymbolizer>';
sld += '        </Rule>';
sld += '        <Rule>';
sld += '          <Name>LargePop</Name>';
sld += '          <Title>Greater Than 500,000</Title>';
sld += '          <ogc:Filter>';
sld += '            <ogc:PropertyIsGreaterThan>';
sld += '              <ogc:PropertyName>pop</ogc:PropertyName>';
sld += '              <ogc:Literal>500000</ogc:Literal>';
sld += '            </ogc:PropertyIsGreaterThan>';
sld += '          </ogc:Filter>';
sld += '          <PolygonSymbolizer>';
sld += '            <Fill>';
sld += '              <CssParameter name="fill">#009900</CssParameter>';
sld += '            </Fill>';
sld += '          </PolygonSymbolizer>';
sld += '        </Rule>';
sld += '      </FeatureTypeStyle>';
sld += '    </UserStyle>';
sld += '  </NamedLayer>';
sld += '</StyledLayerDescriptor>'; 
```

这是从[Geoserver SLD 食谱](http://docs.geoserver.org/stable/en/user/styling/sld-cookbook/polygons.html)中直接提取的，这是一个非常好的网站。不要忘记根据您的数据（图层名称、数据属性等）更改 SLD。在食谱中，您还可以看到数据应该是什么样子。

定义 SLD 后，您可以使用它简单地创建一个新的 WMS 图层：

```
newWmsLayer = new OpenLayers.Layer.WMS.Post(layerName, wmsUrl,
    {
        layers: layerName,
        sld_body: sld
    }); 
```

最后将其添加到地图中：

```
map.addLayer(newWmsLayer); 
```

当然，如果这应该更新现有层，您应该首先删除旧层。

# magento - 使用 Observer 捕获 Magento 事件

> ID：14187188
> 
> 赞同：0
> 
> 时间：2013-01-06T21:52:12.530
> 
> 标签：magento

我的观察者似乎没有捕捉到 Magento v1.12.0.2 发出的事件。我正在密切关注来自[http://inchoo.net/ecommerce/magento/dispatching-before-and-after-events-to-magento-core-actions/](http://inchoo.net/ecommerce/magento/dispatching-before-and-after-events-to-magento-core-actions/)的教程，并且似乎无法重现。

**app/etc/modules/Require_Additional_Product.xml**：

```
<?xml version="1.0"?>
<config>
    <modules>
        <RequireAdditionalProduct>
            <active>true</active>
            <codePool>local</codePool>
        </RequireAdditionalProduct>
    </modules>
</config> 
```

**应用程序/代码/本地/Hatclub/RequireAdditionalProduct/etc/config.xml**：

```
<modules>
    <RequireAdditionalProduct>
        <version>1.0.0</version>
    </RequireAdditionalProduct>
</modules>

<global>

    <models>
        <dispatcher>
            <class>Hatclub_RequireAdditionalProduct_Model</class>
        </dispatcher>
    </models>

    <events>

         <!-- Hooking to Magento's default event "controller_action_predispatch" -->
        <controller_action_predispatch>
            <observers>
                <controller_action_before>
                    <class>dispatcher/observer</class>
                    <method>hookToControllerActionPreDispatch</method>
                </controller_action_before>
            </observers>
        </controller_action_predispatch>

        <!-- Hooking to Magento's default event "controller_action_postdispatch" -->
        <controller_action_postdispatch>
            <observers>
                <controller_action_after>
                    <class>dispatcher/observer</class>
                    <method>hookToControllerActionPostDispatch</method>
                </controller_action_after>
            </observers>
        </controller_action_postdispatch>

        <!-- Hooking to our own event "add_to_cart_before" -->
        <add_to_cart_before>
            <observers>
                <add_to_cart_before>
                    <class>dispatcher/observer</class>
                    <method>hookToAddToCartBefore</method>
                </add_to_cart_before>
            </observers>
        </add_to_cart_before>

        <!-- Hooking to our own event "add_to_cart_after" -->
        <add_to_cart_after>
            <observers>
                <add_to_cart_after>
                    <class>dispatcher/observer</class>
                    <method>hookToAddToCartAfter</method>
                </add_to_cart_after>
            </observers>
        </add_to_cart_after>

    </events>

</global> 
```

**app/code/local/Hatclub/RequireAdditionalProduct/Model/Observer.xml**：

```
class Hatclub_RequireAdditionalProduct_Model_Observer {

    //this is hook to Magento's event dispatched before action is run
    public function hookToControllerActionPreDispatch($observer)
    {

        error_log('test 1', 0);

        //we compare action name to see if that's action for which we want to add our own event
        if($observer->getEvent()->getControllerAction()->getFullActionName() == 'checkout_cart_add')
        {
            //We are dispatching our own event before action ADD is run and sending parameters we need
            Mage::dispatchEvent("add_to_cart_before", array('request' => $observer->getControllerAction()->getRequest()));
        }

    }

    public function hookToControllerActionPostDispatch($observer)
    {
        error_log('test 1', 0);

        //we compare action name to see if that's action for which we want to add our own event
        if($observer->getEvent()->getControllerAction()->getFullActionName() == 'checkout_cart_add')
        {
            //We are dispatching our own event before action ADD is run and sending parameters we need
            Mage::dispatchEvent("add_to_cart_after", array('request' => $observer->getControllerAction()->getRequest()));
        }
    }

    public function hookToAddToCartBefore($observer)
    {
        error_log('test 1', 0);

        //Hooking to our own event
        $request = $observer->getEvent()->getRequest()->getParams();

        // do something with product
        Mage::log("Product ".$request['product']." will be added to cart.");
    }

    public function hookToAddToCartAfter($observer)
    {   
        error_log('test 1', 0);

        // Hooking to our own event
        $request = $observer->getEvent()->getRequest()->getParams();

        // do something with product
        Mage::log("Product ".$request['product']." is added to cart.");
    }

} 
```

我只是想获得输出，以便我知道观察者正在捕获事件（通过使用 php error_log 和 Mage::log）。两者都没有输出任何东西，所以这似乎根本不起作用。谁能发现我哪里出错了？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-06T22:03:21.223

您的模块注册文件中的 xpath 对于您的模块配置文件不正确。

```
<?xml version="1.0"?>
<config>
    <modules>
        <!--
            this node name along with codePool value is how your module's
            config.xml file will be located.
        -->
        <Hatclub_RequireAdditionalProduct>
            <active>true</active>
            <codePool>local</codePool>
        </Hatclub_RequireAdditionalProduct>
    </modules>
</config> 
```

有关更多信息，请参阅[`Mage_Core_Model_Config::loadModulesConfiguration()`（链接）](https://github.com/benmarks/magento-mirror/blob/1.7.0.2/app/code/core/Mage/Core/Model/Config.php#L935)。

# sql - 为 PK 的顺序索引的填充因子

> ID：14187192
> 
> 赞同：3
> 
> 时间：2013-01-06T21:53:00.690
> 
> 标签：sql, postgresql, database-design, fillfactor

是的，`fillfactor`再次。我花了很多时间阅读，我无法决定每种情况下什么是最好的。我不明白碎片何时以及如何发生。我正在将数据库从 MS SQL Server 迁移到 PostgreSQL 9.2。

#### 情况1

在顺序（串行）PK 中 10-50 次插入/分钟，20-50 次读取/小时。

```
CREATE TABLE dev_transactions (
  transaction_id serial NOT NULL,
  transaction_type smallint NOT NULL,
  moment timestamp without time zone NOT NULL,
  gateway integer NOT NULL,
  device integer NOT NULL,
  controler smallint NOT NULL,
  token integer,
  et_mode character(1),
  status smallint NOT NULL,
  CONSTRAINT pk_dev_transactions PRIMARY KEY (transaction_id)
); 
```

#### 案例2

类似的结构，串行PK的索引，每2个月写入约50.000个寄存器的块（一次），读数10-50 /分钟。

50% 的填充因子是否意味着每次插入都会生成一个新页面并将 50% 的现有行移动到新生成的页面？

50% 的填充因子是否意味着在新数据页的物理行*之间*分配了释放空间？

仅当现有页面中没有可用空间时才会生成新页面？

如您所见，我很困惑；我会很感激一些帮助——也许是阅读 PostgreSQL 和 index 的好链接`fillfactor`。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-06T22:14:59.740

### [`FILLFACTOR`](https://www.postgresql.org/docs/current/sql-createtable.html#SQL-CREATETABLE-STORAGE-PARAMETERS)

with only`INSERT`并且`SELECT`你应该在任何地方使用`FILLFACTOR`of `100`。如果您不打算与`UPDATE`s 一起“摆动”，那么为每个内存块留出摆动空间是没有意义的。

背后的机制`FILLFACTOR`很简单。`INSERT`s 仅将数据页（通常为 8 kB 块）填充到`FILLFACTOR`设置声明的百分比。此外，无论您何时奔跑`VACUUM FULL`或`CLUSTER`在桌面上，都会重新建立每个街区的相同摆动空间。理想情况下，这允许`UPDATE`在同一数据页中存储新的行版本，这可以在处理大量`UPDATE`s 时提供显着的性能提升。**与HOT 更新**结合使用也有好处。看：

*   [更新语句中的冗余数据](https://stackoverflow.com/questions/7806058/redundant-data-in-update-statements/7806610#7806610)

如果*没有*更新，不要为此浪费空间并设置`FILLFACTOR = 100`（这是表的默认设置）。

[`CREATE TABLE`](https://www.postgresql.org/docs/current/sql-createtable.html#SQL-CREATETABLE-STORAGE-PARAMETERS)基本信息来源：和的手册[`CREATE INDEX`](https://www.postgresql.org/docs/current/sql-createindex.html)。

### 其他优化

但是您可以做*其他事情*-因为您似乎是优化的傻瓜... :)

```
CREATE TABLE dev_transactions(
  transaction_id serial PRIMARY KEY
, gateway integer NOT NULL
, moment timestamp NOT NULL
, transaction_type smallint NOT NULL
, status smallint NOT NULL
, device integer NOT NULL
, controler smallint NOT NULL
, token integer
, et_mode character(1)
); 
```

这优化了您的表格在**数据对齐**方面并避免了典型 64 位服务器的**填充**并节省了几个字节，平均可能只有 8 个字节 - 您通常不能使用“列俄罗斯方块：

*   [在 PostgreSQL 中计算和节省空间](https://stackoverflow.com/questions/2966524/calculating-and-saving-space-in-postgresql)

将列保留`NOT NULL`在表的开头以获得非常小的性能奖励。

您的表有*9 列*。这意味着扩展的**NULL 位图**需要额外的*8 个字节*- 这将适合仅*8 列*的初始 1 字节 NULL 位图。 如果定义and ，则所有列都是并且永远不会使用 NULL 位图，每行释放 8 个字节。 如果您不*声明*columns ，这甚至适用于每行。如果所有列都有值，则该行没有 NULL 位图。在您的特殊情况下，这会导致悖论效应，即填充值并可以使您的存储大小*更小*或至少保持不变： ***`et_mode``token` `NOT NULL``NOT NULL`
*`NOT NULL``et_mode``token`****

 ******   [可以为空的列在 PostgreSQL 中是否会占用额外的空间？](https://stackoverflow.com/questions/12145772/do-nullable-columns-occupy-additional-space-in-postgresql/12147130#12147130)

基本信息来源：[数据库物理存储](https://www.postgresql.org/docs/current/storage.html)手册。

将行的大小（填充值）与原始表进行比较以获得明确的证据：

```
SELECT pg_column_size(t) FROM dev_transactions t; 
```

（加上可能在行之间填充，因为下一行从 8 个字节的倍数开始。）*****

# ruby - 使用正则表达式在 __italic__ 和其他一些之间进行提取

> ID：14187194
> 
> 赞同：0
> 
> 时间：2013-01-06T21:53:04.427
> 
> 标签：ruby, regex

我正在编写代码来提取（**斜体**，--bold--）字符之间的一些数据。（非常类似于 SO 评论功能）

我实际上为此编写了方法（使用循环并检查字符），但我想知道是否可以使用正则表达式重新编写该方法。

我尝试了 Rubular，但我不擅长正则表达式：

这有点适用于斜体，但我认为这不是使用所有其他特殊字符的好解决方案（比如 - 可能还有其他字符）

```
regex: _{2}([^_]*)_{2}
text: __word1__ not_italic __a__ --bolder-- 
```

是否可以使用 1 个匹配调用和正则表达式来做到这一点，或者我是否必须为每个特殊格式字符创建特殊的正则表达式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T21:59:41.790

你当然可以。这是一个您可以使用的漂亮结构：`(__|--)((?:(?!\1).)+)\1`

演示+解释：[http ://regex101.com/r/tO4tW1](http://regex101.com/r/tO4tW1)

您所追求的内容每次都会在第二个反向引用中。

# ios - 从调试器打印时，为什么有些字典键有引号而另一些没有？

> ID：14187201
> 
> 赞同：5
> 
> 时间：2013-01-06T21:53:32.613
> 
> 标签：ios, ios6, nsdictionary, restkit, afnetworking

所以我目前正在从我的服务器发回一个 JSON 对象。如果我在 XCode 中打印 responseObject，我会得到以下信息：

```
Printing description of responseObject:
{
order = 3;
"picture_bucket_name" = test;
"picture_creation_date" = "2013-01-06T21:49:54.546Z";
"picture_identifier" = 61;
"picture_url_with_bucket" = "test/pictures/sop/steps/test_default_320_320.png";
"sub_order" = 0;
 } 
```

为什么 Order 键不在“”中？这是我必须使用 NumberFormatter 从 NSString 转换为 NSNumber 的唯一键。这是为什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-06T23:53:35.890

通常，在控制台中为字典键显示一个没有任何空格和其他特殊字符的单词而没有任何引号。例如：- 上面示例中的键`order`和值`test`。这有助于保持可读性。将这些其他词用引号括起来可确保可读性。

# ruby-on-rails - PostgreSQL rake db：在本地环境中创建错误

> ID：14187208
> 
> 赞同：1
> 
> 时间：2013-01-06T21:54:20.310
> 
> 标签：ruby-on-rails, rails-postgresql

每当我在本地环境中使用 postgreSQL 进行 Rails 应用程序开发时，我都会继续遇到问题。

我在 Mac OS X 10.7 上运行。我知道这个版本带有预装的 Postgres 版本。

我最初使用[brew 方法](http://russbrooks.com/2010/11/25/install-postgresql-9-on-os-x)安装了 Postgres ，并且至少有几次成功。我知道用户身份验证问题。

在插入`psql --version`或`which psql`确定正在使用哪个安装时，我必须先调整我的 .bash_profile 以反映带有 .bash_profile 的适当路径`export PATH=/usr/local/bin:$PATH`。

我现在遇到的问题，以及几个小时的谷歌没有解决这个问题，是我的机器在没有正确关闭 PostgreSQL 的情况下重新启动。反过来，当我尝试`rake db:create`在新应用程序上执行时，我收到以下错误，我收到以下错误：

`Couldn't create database for {"adapter"=>"postgresql", "encoding"=>"unicode", "database"=>"app_development", "pool"=>5, "username"=>"tomgeoco", "password"=>nil} could not connect to server: No such file or directory Is the server running locally and accepting connections on Unix domain socket "/tmp/.s.PGSQL.5432"?`

我的 config/database.yml 看起来像：

```
 development:
      adapter: postgresql
      encoding: unicode
      database: app_development
      pool: 5
      username: tomgeoco
      password: 

    test:
      adapter: postgresql
      encoding: unicode
      database: app_development
      pool: 5
      username: tomgeoco
      password: 

    production:
      adapter: postgresql
      encoding: unicode
      database: app_development
      pool: 5
      username: tomgeoco
      password: 
```

当我检查 Postgres 服务器的状态时，`ps auxwww | grep postgre`我得到以下信息：

`tomgeoco 12596 0.0 0.0 2434892 408 s000 R+ 11:54AM 0:00.00 grep postgres`

那么在这种情况下会出现什么问题呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T06:03:45.853

这个问题不是关于rails，而是关于postgres。我最近在 django 项目中遇到了完全相同的问题。

根据您的 ps 输出，postgres 目前无法正常工作。

首先你必须检查日志，我的是/usr/local/var/postgres/server.log。它会让您了解 postgre 启动时出了什么问题。

我的问题通过修复 .bash_profile 中的 PATH 变量得到解决。

尝试手动启动您的 postgre 服务器，检查其所有输出。如果一切正常但在系统重新启动时损坏，请检查您的 launchctl 守护程序以找出使用了哪个配置文件。这也可能是一个问题。

[在这里](https://stackoverflow.com/questions/7975556/how-to-start-postgresql-server-on-mac-os-x)，您可以找到清楚安装 brew 版本的 postgres 的良好说明。这里正在修改 postgres 默认设置，[这](https://stackoverflow.com/questions/12032585/postgresql-mountain-lion-socket-issue)也可能有用。

# ruby - 记住gets.chomp

> ID：14187210
> 
> 赞同：0
> 
> 时间：2013-01-06T21:54:52.750
> 
> 标签：ruby, editor

我正在尝试用 Ruby 制作一个文本编辑器，但我不知道如何使用`gets.chomp`.

到目前为止，这是我的代码：

```
outp =
def tor
    text = gets.chomp
    outp = "#{outp}" += "#{text}"
    puts outp
end

while true
    tor
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T23:39:59.187

方法中的普通变量，如`outp`，仅在该方法内可见（AKA 具有范围）。

```
a = "aaa"
def x
  puts a
end
x # =>error: undefined local variable or method `a' for main:Object 
```

这是为什么？一方面，如果您正在编写一个方法并且您需要一个计数器，您可以使用一个名为`i`（或其他）的变量，而不必担心`i`在您的方法之外命名的其他变量。

但是......你想在你的方法中与外部变量进行交互！这是一种方式：

```
@outp = "" # note the "", initializing @output to an empty string.

def tor
    text = gets.chomp
    @outp = @outp + text #not "#{@output}"+"#{text}", come on.
    puts @outp
end

while true
    tor
end 
```

`@`赋予此变量更大的可见性（范围）。

这是另一种方式：将变量作为参数传递。这就像对您的方法说：“在这里，使用这个。”。

```
output = ""

def tor(old_text)
  old_text + gets.chomp
end

loop do #just another way of saying 'while true'
  output = tor(output)
  puts output
end 
```

# mysql - MySQL COUNT 过滤

> ID：14187212
> 
> 赞同：1
> 
> 时间：2013-01-06T21:55:17.877
> 
> 标签：mysql, join, count

这是我关于 stackoverflow 的第一篇文章，虽然我已经将它用作参考很长时间了。因此，感谢您过去为我提供的所有指导。对此，我真的非常感激。这是我的问题：

我有两张桌子，一张叫`USERS`一张叫`SIGNIN`

```
USERS  
-----------------
userid | password

SIGNIN
--------------
suserid | date 
```

我想计算用户在上周期间登录的次数。

这是我所拥有的：

```
SELECT userid, password FROM USERS JOIN (SELECT suserid, COUNT(*) AS logins 
FROM signin 
WHERE WEEKOFYEAR(date) = WEEKOFYEAR(CURDATE()) && signin.suserid = users.userid) 
GROUP BY userid 
```

我只是无法理解如何进行`JOIN`子查询并使其计算每个人的登录（日期列）并为每个人返回一个个性化的数字。我知道这个查询完全被抬高了，但我只是在那一点上，你知道，我变得如此困惑，我只需要一些指导。

任何帮助和指导都会很棒！我已经阅读了很多页，但无济于事。提前致谢！

** 并感谢您的编辑。当我再次发布时，他们将在未来提供帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T22:09:08.847

不要尝试进行子查询，只需按用户 ID 进行连接和分组。此外，您需要 YEARWEEK，以便匹配年份和星期，而不仅仅是任何一年的星期。

```
select userid, count(*)
    from users inner join signin on userid=suserid and yearweek(`date`) = yearweek(curdate())
    group by userid; 
```

如果您希望尚未登录的用户的结果为 0，则左连接而不是内部连接。这遵循我假设您的“上周”意图，即当前日期的一周（默认情况下从星期日开始，但请参阅yearweek 的可选模式参数）。

请注意，这里的 users 表是完全可选的；你可以这样做：

```
select suserid, count(*) from signin
    where yearweek(`date`) = yearweek(curdate())
    group by suserid; 
```

但我猜您可能会从用户那里获得其他列，或者想要排除已删除用户的登录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T22:02:33.300

s这应该是：

```
select suserid, count(suserid)
    from signin
    where date > NOW() - INTERVAL 1 WEEK
    group by suserid; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-06T22:05:45.800

如果我理解正确，您不需要子查询。

就像是：

```
SELECT a.userid, a.password, count(b.date) AS logins
FROM users a
INNER JOIN signin b ON a.userid = b.suserid  and WEEKOFYEAR(date) = WEEKOFYEAR(CURDATE())
GROUP BY a.userid, a.password 
```

抱歉 - 没有时间尝试查询以仔细检查语法，但希望能让您朝着正确的方向前进

编辑：如果您想包含登录次数为 0 的用户，请更改为 LEFT OUTER JOIN

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-06T22:06:57.390

你不需要在这里加入。你需要的是

```
SELECT userid, password, (SELECT COUNT(*) 
FROM SIGNIN
WHERE WEEKOFYEAR(date) = WEEKOFYEAR(CURDATE()) AND signin.suserid = users.userid) AS logins
FROM USERS WHERE 1 GROUP BY userid; 
```

# c++ - 无效的数组分配？

> ID：14187217
> 
> 赞同：1
> 
> 时间：2013-01-06T21:55:53.830
> 
> 标签：c++

当我运行下面的代码时，我收到错误：第 14 行和第 26 行的数组分配无效。我对 c++ 相当陌生（1 周），所以我有点困惑。我搜索并找不到解决我问题的答案。

```
#include <iostream>

int main()
{

 using namespace std;

 char usrname[5];
 char psswrd[9];

 cout << "Please enter your username:";
 cin >> usrname;

 if (usrname = "User")
  {
    cout << "Username correct!";
  }
  else 
  {
    cout << "Username incorrect!";
  }

 cout << "Please enter your password:";
 cin >> psswrd;

 if (psswrd = "password")
  {
    cout << "The password is correct! Access granted.";
  }
 else 
  {
    cout << "The password is incorrect! Access denied.";
  }

  return 0; 
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-06T21:56:43.347

您不能分配数组，并且

```
usrname = "User" 
```

就是这样做的。不。

你的意思是

```
usrname == "User" 
```

这是一个比较，**但不会比较您的 strings**。它只是比较指针。

使用`std::string`而不是`char`数组或指针并与 进行比较`==`：

```
 #include <string>

 //...
 std::string usrname;
 cin << usrname;

  if (usrname == "User")
  //          ^^
  //   note == instead of = 
```

附带问题 - 将“用户名”缩短为“用户名”有什么意义......你正在保存一个字符......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T22:02:02.460

你需要使用 strcmp 或类似的。

```
if (!strcmp(usrname, "User"))
{
   cout << "Username correct!";
} 
```

您正在做的是分配一个值而不是比较值。

# html - 当容器宽度小于子元素宽度之和时如何禁止div元素之间的换行

> ID：14187225
> 
> 赞同：1
> 
> 时间：2013-01-06T21:56:57.927
> 
> 标签：html, css

我有一个容器 div 元素和一些子 div 元素。

```
<div>
  <div>foo</div>
  <div>bar</div>
  <div>baz</div>
<div> 
```

我想在一行中水平列出子元素而没有换行符。我读到我可以`white-space:nowrap`在容器元素和/或`display:inline`子元素`display:inline-block`上使用。这适用于容器的宽度足够长的情况。

但是，我有一个容器，其宽度可能会小于子项宽度的总和。在这种情况下，上述方式并不禁止换行。我仍然想禁止换行并强制它们在单行上，`hidden`如果容器宽度不够，则额外的部分是孩子。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T22:04:54.763

```
<div id="parent">
  <div class="child"></div>
  <div class="child"></div>
  <div class="child"></div>
</div> 
```

```
#parent{
   overflow: hidden;
   white-space: nowrap;
}

.child{
   display: inline-block;
   width: 200px;
   height: 200px;
} 
```

[http://jsfiddle.net/YAp6k/](http://jsfiddle.net/YAp6k/)

# ios - iOS 和计时器应用程序：有没有办法阻止屏幕保护程序启动？

> ID：14187228
> 
> 赞同：1
> 
> 时间：2013-01-06T21:57:14.613
> 
> 标签：ios, timer, screen, screensaver

> **可能重复：**
> [如何防止 iPhone 屏幕在我的应用程序运行时变暗或关闭？](https://stackoverflow.com/questions/125619/how-do-i-prevent-the-iphone-screen-from-dimming-or-turning-off-while-my-applicat)

我正在开发一个计时器应用程序，想知道是否有办法告诉 iOS 在应用程序空闲时不要启动屏幕保护程序（例如计时器放在桌子上）。

我还想将屏幕亮度保持在最高水平。

有什么建议吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T22:01:08.187

要禁用屏幕保护程序，请尝试以下操作：

```
[UIApplication sharedApplication].idleTimerDisabled = YES; 
```

用于调整屏幕亮度（仅限 iOS5 及更高版本**，**以前没有用于此的公共 API）：

```
[[UIScreen mainScreen] setBrightness:1.0]; 
```

# c - 将二叉树保存到 C 中的文件

> ID：14187229
> 
> 赞同：0
> 
> 时间：2013-01-06T21:57:18.063
> 
> 标签：c, file, binary-tree

当用户可以添加/编辑/搜索/列出客户时，我目前正在执行客户计划。我决定使用二叉树作为这个程序的主干。我的想法是在程序关闭之前将树中的每个项目保存到“customers.dat”，然后在启动时将文件中的所有内容加载到树中。到目前为止一切顺利，但是在最终设法将二叉搜索树保存到文件中之后，我遇到了一个错误。

假设我第一次添加了 3 个客户。然后我关闭程序，当我重新打开它时，我会在树中找到相同的 3 个客户。但是，下次我打开文件时，它给了我一个来自我的预定义错误的错误，当节点无法识别是向左还是向右时，可能是因为它是空的或不可比较的。这是一些代码片段。我还尝试使用 a+b 以外的其他文件打开技术，但没有出现此类错误，但是按照我设计程序的方式，我需要 append 方法，否则只会保存一条记录。

客户存储在 Cstmr 的标头中：

```
typedef struct customer
{
    char Name[MAXNAME];
    char Surname[MAXNAME];
    char ID[MAXID];
    char Address[MAXADDRESS];

} Cstmr; 
```

别的：

```
void CustomerTreeToFile(Tree*pt)
{
    if (TreeIsEmpty(pt))
        puts("Nothing to save!");
    else
        Traverse(pt,saveItem); //Traverses each node, and appliess the function 
                                   //saveItem to each node
}

void saveItem(Cstmr C)
{
    save = C;
    customers = fopen("customers.dat","ab+");
    fwrite(&C,sizeof (Cstmr), 1, customers);
    fclose(customers);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T22:34:27.447

问题是您总是将所有数据附加到同一个文件中......所以上一次运行的所有内容都是重复的。

一种解决方案是在使用当前方法保存数据之前删除（取消链接）文件。

但是，正如 Freezerburn 之前指出的那样，不打开和关闭每个项目的文件更经济。只需以覆盖模式（即不追加）打开文件一次，然后写入所有数据，然后关闭文件。也应该快得多。

另一个问题是您以二进制格式保存数据。尝试定义一种易于阅读的文本格式。那会让问题变得明显......

# sql - SSRS 表达式 - 获取最近星期六的日期

> ID：14187230
> 
> 赞同：0
> 
> 时间：2013-01-06T21:57:38.550
> 
> 标签：sql, sql-server, reporting-services

我试图找到一个 SSRS 表达式，它将返回最近星期六的日期。如果表达式在星期六运行，我希望它显示前一周的星期六。

我玩弄了一个我在网上找到的例子，并让它产生我需要它产生的价值。下面列出：

`=IIf(Parameters!O_endDate.Value = nothing, DateAdd("d", -7-(WeekDay(Today(),7))+8, Today()), Parameters!O_endDate.Value)`

我为愚蠢的帖子道歉。我不明白为什么上面的表达式会产生我需要的值，我想知道它是否会继续像我希望的那样工作，当它在未来一周的其他日子运行时。注意：我在周日运行了这段代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T04:00:52.203

出于您的目的，我认为您不需要 IIF 语句 - 如果它不是什么都没有，它只会返回参数的值。

这将关键操作保留为`DateAdd("d", -7-(WeekDay(Today(),7))+8, Today())`。

它的作用是增加`-7-(WeekDay(Today(),7))+8`今天的天数 - 这可以简化为`1-(WeekDay(Today(),7))`-7+8=1。

[查看此处](http://msdn.microsoft.com/en-us/library/ee634550%28v=sql.105%29.aspx)的文档，return_type 似乎无效，因为该函数仅针对 1、2 和 3 的值定义 - 如果它现在工作，那么它可能无法继续工作。

如果`DateAdd("d", 1 - WeekDay(Today(), 1), Today())`您希望最近的星期日是今天，而今天是星期日，或者`DateAdd("d", WeekDay(Today(), 2)), Today())`如果最近的星期日是上周，而今天是星期天，这将一直有效。

请注意，在这两种情况下，由于对 Today() 的 2 次调用相隔几毫秒，这可能会在午夜左右产生错误的答案。要绝对正确，它应该是：

```
Declare @DateToCheck datetime=Today()
Select DateAdd('d', 1 - WeekDay(@DateToCheck, 1), @DateToCheck) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-09T03:12:17.517

这是一种更通用的方法，应该更接近 ANSI SQL。

请参阅 SQL Server 2008 的[SQL Fiddle](http://sqlfiddle.com/#!3/d746d/5)。

因为 DATEPART 的返回值取决于全局数据库设置，所以返回值会针对已知的星期六进行调整。通过将其更改为一周中的另一天，您将获得最后一天。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-06-30T05:07:53.783

你可以试试这个： `=DateAdd("d", -1 * (weekday(today()) mod 7 ), today())`

# javascript - 使用 $push 和 db.update 时的 Meteor.methods() 意外行为

> ID：14187231
> 
> 赞同：0
> 
> 时间：2013-01-06T21:57:46.470
> 
> 标签：javascript, node.js, mongodb, meteor

我有这个代码来更新一个条目：

```
function updateList(listTime) {

    var firstList = Project.find().fetch()[0].list; // returns a list
    var nextElement = (firstList[firstList.length-1] + 50); // value of last + 50

    Project.update({name: "List 1"}, {$push: {list: nextElement}});
} 
```

我从以下位置调用它：

```
Meteor.methods({
  updateList: updateList,
}); 
```

因为我正在使用 python ddp 客户端并且需要这样。

问题是 nextElement 并没有真正增加我列表中的序列。想象一下，我的列表是 [50,100,150,...]，如果我调用 updateList，它会变成 [50,100,150,150,150,150...] 等等……它应该变成 [50,100,150,200,250,300...]。

有谁知道为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T00:46:03.670

让我们从制作 nextElement`+1`而不是`+50`.

```
var nextElement = (firstList[firstList.length-1] + 1); 
```

请注意，listTime 将成为列表中的最后一个元素。所以如果你运行`updateList(20)`列表会变成`[1, 2, 3, 4, 5, 6, 7, 20]`. 如果你再调用`updateList(2)`它会变成`[1, 2, 3, 4, 5, 6, 7, 20, 21, 2]`等等。

我不确定 listTime 应该做什么，但如果您想添加`last int + 1`到列表中：

```
function updateList() {
    var firstList = Project.find().fetch()[0].list;
    var nextElement = (firstList[firstList.length-1] + 1);

    Project.update({name: "List 1"}, {$push: {list: nextElement}});
} 
```

这将导致：

```
Project.find().fetch()[0].list
> [1, 2, 3, 4, 5, 6, 7]

updateList()
Project.find().fetch()[0].list
> [1, 2, 3, 4, 5, 6, 7, 8]

updateList()
Project.find().fetch()[0].list
> [1, 2, 3, 4, 5, 6, 7, 8, 9] 
```

# ruby-on-rails - Rails：Web 服务器（Apache/nginx/passenger）有什么用？

> ID：14187233
> 
> 赞同：13
> 
> 时间：2013-01-06T21:58:04.600
> 
> 标签：ruby-on-rails

嗨，我在过去的半年里一直在学习 rails，并且在 Heroku 上安装了一些应用程序。所以对我来说，我认为将应用程序部署到万维网上就像`heroku push`. 然而，我刚刚在 Rails 上获得了第一份实习机会，而我的一位前辈正在谈论 Apache 和 Nginx，我不确定它们如何适应这种情况，因为我认为应用程序仅由 Rails + 云应用程序平台组成。我已经查过了，但我仍然不知道它如何以及在何处影响我的应用程序生命周期。有人可以解释使用网络服务器的内容/地点/时间吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-01-06T22:32:27.747

所以你已经有了 Rails 应用程序，并且你知道你有控制器、动作和视图等等。

当用户在浏览器中访问您在 Heroku 上的应用时，他们会输入指向 Heroku 服务器的 URL。

Heroku 服务器是 Web 服务器，它监听用户输入 URL 并将他们连接到 Rails 应用程序。rails 应用程序会做它的事情（获取博客文章列表或其他内容），然后服务器将此信息发送回用户的浏览器。

您一直在使用 Web 服务器，只是由于 Heroku，它被从您身上抽象出来并变得超级简单。

所以生命周期有点像这样：

当您在开发机器上构建应用程序时，您可能遇到过 command `rails server`。这将启动一个名为 WEBrick 的程序，它是一个 Web 服务器，并在端口 3000 上进行侦听。您可以通过`http://localhost:3000`.

WEBrick 监听 3000 端口并响应用户的请求，例如“嘿，给我一个帖子列表”命令。

当您将代码推送到生产环境时（根据您的经验，通过`heroku push`），您将代码发送给一个提供者，该提供者`rails server`为您处理生产等价物。

生产设置（您的高级开发人员正在谈论）比您`rails server`在开发机器上的本地设置要复杂一些。

在生产环境中，你有你的 Rails 服务器（通常是 Unicorn、Passenger）来代替 WEBrick。

在许多生产设置中，还使用另一个服务器，例如 Apache 或 nginx，并且是用户在访问您的应用程序时连接到的服务器。

该服务器通常作为一个路由器存在，用于确定应如何处理不同类型的请求。例如，对存储在服务器上的静态文件（css、图像、javascript 等）的请求可能只由 Apache 或 nginx 直接处理，因为它在将静态资产发送回客户端方面做得非常出色（而且速度很快）。

其他请求，例如“给我一个所有博客文章的列表”被传递到 Rails 服务器（Unicorn、Passenger 等），后者依次完成所需的工作并将响应发送给 Apache/nginx，后者将其发送回客户端.

Heroku 在一个易于使用的软件包中为您完成了所有这些工作，但听起来您工作的地方自己管理这一切，而不是使用 Heroku。他们已经设置了自己的一组 Web 服务器，并且会以自己的方式执行等效的`heroku push`操作，将代码发送到服务器，并确保它们已启动并运行准备好响应用户请求。

希望有帮助！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-06T22:21:15.650

网页需要 Web 服务器才能在 Internet 上可用。

因此，一个全是静态内容（全都是 .html 页面）的站点只需要一个 Web 服务器，这就是 Apace、nginx 等的用武之地。它们是 Web 服务器。

当您使用像 rails 这样的框架时，会添加一个附加组件，即应用程序服务器。这使用 rails 框架对页面进行预处理，然后（仍然）使用上述 Web 服务器使最终页面（当然是 .html）通过浏览器提供给最终用户。

Passenger Phusion 是一个应用程序服务器，使用 rails 将有助于管理和自动化代码的部署。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-06T22:12:01.867

Heroku 是一项云服务，这意味着他们负责硬件和软件，让您可以无缝地发布您的应用程序，而不必担心幕后发生的事情。所以你唯一需要做的就是将你的代码推送到他们的 Git 上，瞧。

另一方面，Rails 也可以部署在您完全从零开始构建的系统上，您不仅要负责应用程序的开发，还要负责服务器的维护和硬件和/或软件的选择。然后，您可以在几个能够运行 rails 的应用程序服务器之间进行选择，例如 ngix。

希望有帮助。

# java - 按下 JButton 时返回的方法

> ID：14187235
> 
> 赞同：0
> 
> 时间：2013-01-06T21:58:18.843
> 
> 标签：java, swing, jbutton, jtextfield

`JButton`我需要创建一个仅在按下a 时才返回的方法。我有一个自定义`JButton`课程

```
public class MyButton extends JButton {

   public void waitForPress() {
       //returns only when user presses this button
   }

} 
```

我想实施`waitForPress`. 基本上，该方法应该只在用户用鼠标按下按钮时返回。我已经实现了类似的行为`JTextField`（仅在用户按下时返回`Space`）：

```
public void waitForTriggerKey() {
        final CountDownLatch latch = new CountDownLatch(1);
            KeyEventDispatcher dispatcher = new KeyEventDispatcher() {
                public boolean dispatchKeyEvent(KeyEvent e) {
                    if (e.getID() == KeyEvent.KEY_PRESSED && e.getKeyCode() == KeyEvent.VK_SPACE) {
                        System.out.println("presed!");
                        latch.countDown();
                    }
                    return false;
                }
            };
            KeyboardFocusManager.getCurrentKeyboardFocusManager().addKeyEventDispatcher(dispatcher);
            try {
                //current thread waits here until countDown() is called (see a few lines above)
                latch.await();
            } catch (InterruptedException e1) {
                e1.printStackTrace();
            }  
            KeyboardFocusManager.getCurrentKeyboardFocusManager().removeKeyEventDispatcher(dispatcher);

    } 
```

但我想对`JButton`.

***提前：***请，如果您想评论说这不是一个好主意，并且应该简单地等待`actionPerformed`事件发生`JButton`然后采取一些行动，请意识到我已经知道并且有充分的理由去做我的事情'我在这里问。请尽量只帮助我提出的问题。谢谢！！

***提前：***请也意识到执行 actionPerformed 也不会直接解决问题。因为即使没有按下按钮，代码也会继续进行。我需要程序停止，并且只有在按下按钮时才返回。如果我要使用 actionPerformed，这是一个糟糕的解决方案：

```
public class MyButton extends JButton implements ActionPerformed {
   private boolean keepGoing = true;

   public MyButton(String s) {
       super(s);
       addActionListener(this);
   }

   public void waitForPress() {
       while(keepGoing);
       return;
   }

   public void actionPerformed(ActionEvent e) {
       keepGoing = false;
   }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T22:54:31.870

对于它的价值，这是你可以做到的`wait()`，`notify()`但我觉得这里有一个更深层次的问题。我不认为这是一个令人满意的解决方案：

```
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.util.concurrent.Executors;
import java.util.concurrent.ScheduledExecutorService;

import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.SwingUtilities;

public class TestBlockingButton {

    boolean clicked = false;
    private Object toNotify;

    private void initUI() {
        JFrame frame = new JFrame(TestBlockingButton.class.getSimpleName());
        JButton button = new JButton("Click me");
        button.addActionListener(new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent e) {
                clicked = true;
                if (toNotify != null) {
                    synchronized (TestBlockingButton.this) {
                        toNotify.notify();
                    }
                }
            }
        });
        frame.add(button);
        frame.setSize(400, 400);
        frame.setLocationRelativeTo(null);
        frame.setVisible(true);
    }

    public void waitForProcess() {
        toNotify = this;
        while (!clicked) {
            synchronized (this) {
                try {
                    wait();
                } catch (InterruptedException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }
            }
        }
        System.out.println("continuing work");
    }

    public static void main(String[] args) {
        final TestBlockingButton test = new TestBlockingButton();
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                test.initUI();
            }
        });
        ScheduledExecutorService pool = Executors.newScheduledThreadPool(1);
        pool.execute(new Runnable() {
            @Override
            public void run() {
                System.out.println("I was doing something and now I will wait for button click");
                test.waitForProcess();
                System.out.println("User has now cliked the button and I can continue my work");
            }
        });

    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-06T22:35:01.130

当您要求使用互斥锁实现时，这就是它的样子。我正在使用一个`ActionListener`，但它没有忙碌的等待。如果那不是您想要的，那么您至少看到了 Burkhard 的意思；）

```
public class MyButton extends JButton implements ActionListener
{
    private Semaphore sem = new Semaphore(1);

    public MyButton(String text) throws InterruptedException
    {
        super(text);
        addActionListener(this);
        sem.acquire();
    }

    @Override
    public void actionPerformed(ActionEvent e) {
        sem.release();
    }

    public void waitForPress() throws InterruptedException {
        sem.acquire();
        //do your stuff
        sem.acquire();
        //or just
        //waitForPress()
            //if you dont want it to end.
    }

    public static void main(String[] args) throws InterruptedException {
        JFrame frame = new JFrame();
        MyButton m = new MyButton("test");
        frame.add(m);
        frame.pack();
        frame.setVisible(true);
        m.waitForPress();
        //another time, if you only want it to block twice
        m.waitForPress();
    }
} 
```

但我不认为这是一种干净的方法，但它不会像 while(isStatementTrue) 实现那样消耗 CPU 时间。
这里重要的一点是：您正在阻塞主线程，`m.waitForPress()`但是正如您所写的那样，您很有经验并且知道如何处理它。

# ember.js - ember 中已删除的记录不会从集合中删除

> ID：14187239
> 
> 赞同：5
> 
> 时间：2013-01-06T21:59:00.857
> 
> 标签：ember.js

我正在构建一个简单的 CRUD 应用程序。我有一个从服务器获取的记录列表，单击第一个，然后我在`show`该记录的页面上，并带有一个`delete`与控制器上的此操作相关联的按钮：

```
destroy: function() {
  this.content.deleteRecord()
  this.store.commit()
  this.transitionTo('usersIndex')
} 
```

我知道记录被删除了，我可以在服务器上看到它被删除。AJAX 请求成功。但是，该记录仍然显示在索引页面上。如果我从服务器进行硬刷新，它现在就消失了。

我的路由器`usersIndex`如下：

```
App.UsersIndexRoute = Ember.Route.extend({
  model: function(params) {
    return App.Users.find();
  },
  setupController: function(controller, model) {
    controller.set('content', model);
  }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-05-20T09:32:50.690

调用 deleteRecord 后，您必须将其保存为 ember 数据。

```
destroy: function() {
  this.content.deleteRecord()
  this.content.get('isDeleted');
  this.content.save()
  this.store.commit()
  this.transitionTo('usersIndex')
} 
```

或者，您也可以起诉 destroyRecord 从后端和 ember 数据中删除了 thh 记录

```
destroy: function() {
      this.content.destroyRecord()
      this.transitionTo('usersIndex')
    } 
```

希望这可以帮助 ！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-27T05:37:07.117

我在我的项目中应用的解决方案是增强 usersIndex 以过滤掉任何 isDeleted 记录，例如

在模板中类似于：

```
{{#unless user.isDeleted}}
  {{render 'user' user}}
{{/unless}} 
```

也可以利用 afterModel 钩子来测试 isDeleted 例如：

```
afterModel: function(model){
    if ((!model.get('users').isAny('isDeleted',false)) || model.get('users.length') === 0){
        this.send('exitUserIndex');
    }
} 
```

# ios - 从 UIImages 创建 mov 时的 iOS 绿色边框

> ID：14187240
> 
> 赞同：4
> 
> 时间：2013-01-06T21:59:16.253
> 
> 标签：ios, objective-c, uiimage

我正在使用下面的代码获取一系列 UIImage 并将它们转换为 mov。出于某种原因，我不断在底部或右侧获得绿色边框，具体取决于它是风景照片还是肖像照片。图像为 215x320。

如何去除绿色边框？有没有更好的方法从 UIImages 创建 .mov？

```
- (void)createMov
{
  UIImage *first = [self.videoFrames objectAtIndex:0];

  CGSize frameSize = first.size;

  NSError *error = nil;
  AVAssetWriter *videoWriter = [[AVAssetWriter alloc] initWithURL:
                                [NSURL fileURLWithPath:fileName] fileType:AVFileTypeQuickTimeMovie
                                                        error:&error];

  if (error) {
    NSLog(@"error creating AssetWriter: %@",[error description]);
  }

  int numPixels = first.size.width * first.size.height;
  int bitsPerSecond = numPixels * 11.04;

  NSDictionary *videoSettings = [NSDictionary dictionaryWithObjectsAndKeys:
                                 AVVideoCodecH264, AVVideoCodecKey,
                                 [NSNumber numberWithInt:frameSize.width], AVVideoWidthKey,
                                 [NSNumber numberWithInt:frameSize.height], AVVideoHeightKey,
                                 [NSDictionary dictionaryWithObjectsAndKeys:
                                  [NSNumber numberWithInteger:bitsPerSecond], AVVideoAverageBitRateKey,
                                  [NSNumber numberWithInteger:30], AVVideoMaxKeyFrameIntervalKey,
                                  nil], AVVideoCompressionPropertiesKey,
                                 nil];

  AVAssetWriterInput* writerInput = [[AVAssetWriterInput
                                      assetWriterInputWithMediaType:AVMediaTypeVideo
                                      outputSettings:videoSettings] retain];

  NSMutableDictionary *attributes = [[NSMutableDictionary alloc] init];
  [attributes setObject:[NSNumber numberWithUnsignedInt:kCVPixelFormatType_32ARGB] forKey:   (NSString*)kCVPixelBufferPixelFormatTypeKey];
  [attributes setObject:[NSNumber numberWithUnsignedInt:frameSize.width] forKey:(NSString*)kCVPixelBufferWidthKey];
  [attributes setObject:[NSNumber numberWithUnsignedInt:frameSize.height] forKey:(NSString*)kCVPixelBufferHeightKey];

  AVAssetWriterInputPixelBufferAdaptor *adaptor = [AVAssetWriterInputPixelBufferAdaptor
                                              assetWriterInputPixelBufferAdaptorWithAssetWriterInput:writerInput
                                               sourcePixelBufferAttributes:attributes];

  [videoWriter addInput:writerInput];

  // fixes all errors
  writerInput.expectsMediaDataInRealTime = YES;

  //Start a session:
  BOOL start = [videoWriter startWriting];
  NSLog(@"Session started? %d", start);
  [videoWriter startSessionAtSourceTime:kCMTimeZero];

  // Writing.
  CVPixelBufferRef buffer = NULL;
  buffer = [self pixelBufferFromCGImage:[first CGImage]];
  BOOL result = [adaptor appendPixelBuffer:buffer withPresentationTime:kCMTimeZero];

  if (result == NO) //failes on 3GS, but works on iphone 4
    NSLog(@"failed to append buffer");

  if(buffer)
    CVBufferRelease(buffer);

  [NSThread sleepForTimeInterval:0.05];

  int fps = [Utils frameRate];

  int i = 0;
  for (UIImage *imgFrame in self.videoFrames) {
    i = [self addFrame:adaptor videoWriter:videoWriter buffer:buffer imgFrame:imgFrame i:i fps:fps];
  }

  //Finish the session:
  [writerInput markAsFinished];
  [videoWriter finishWriting];
  CVPixelBufferPoolRelease(adaptor.pixelBufferPool);
  [videoWriter release];
  [writerInput release];
}

- (int)addFrame:(AVAssetWriterInputPixelBufferAdaptor *)adaptor videoWriter:(AVAssetWriter *)videoWriter buffer:(CVPixelBufferRef)buffer imgFrame:(UIImage *)imgFrame i:(int)i fps:    (float)fps
{
  if (adaptor.assetWriterInput.readyForMoreMediaData) {

    i++;
    NSLog(@"inside for loop %d",i);
    CMTime frameTime = CMTimeMake(1, fps);
    CMTime lastTime=CMTimeMake(i, fps);
    CMTime presentTime=CMTimeAdd(lastTime, frameTime);

    buffer = [self pixelBufferFromCGImage:[imgFrame CGImage]];
    BOOL result = [adaptor appendPixelBuffer:buffer withPresentationTime:presentTime];

    if (result == NO) { //fails on 3GS, but works on iphone 4
      NSLog(@"failed to append buffer");
      NSLog(@"The error is %@", [videoWriter error]);
    }

    if (buffer) {
      CVBufferRelease(buffer);
    }

    [NSThread sleepForTimeInterval:0.05];
  } else {
    NSLog(@"error");
    i--;
  }
  [NSThread sleepForTimeInterval:0.02];

  return i;
}

- (CVPixelBufferRef)pixelBufferFromCGImage:(CGImageRef)image
{
  NSDictionary *options = [NSDictionary dictionaryWithObjectsAndKeys:
                           [NSNumber numberWithBool:YES],     kCVPixelBufferCGImageCompatibilityKey,
                           [NSNumber numberWithBool:YES], kCVPixelBufferCGBitmapContextCompatibilityKey,
                           nil];
  CVPixelBufferRef pxbuffer = NULL;

  CVPixelBufferCreate(kCFAllocatorDefault, CGImageGetWidth(image),
                      CGImageGetHeight(image), kCVPixelFormatType_32ARGB, (CFDictionaryRef) options,
                  &pxbuffer);

  CVPixelBufferLockBaseAddress(pxbuffer, 0);
  void *pxdata = CVPixelBufferGetBaseAddress(pxbuffer);
  size_t rowBytes = CVPixelBufferGetBytesPerRow(pxbuffer);

  CGColorSpaceRef rgbColorSpace = CGColorSpaceCreateDeviceRGB();
  CGContextRef context = CGBitmapContextCreate(pxdata, CGImageGetWidth(image),
                                           CGImageGetHeight(image), 8, rowBytes, rgbColorSpace,
                                           kCGImageAlphaNoneSkipFirst);

  CGContextConcatCTM(context, CGAffineTransformMakeRotation(0));

  CGContextDrawImage(context, CGRectMake(0, 0, CGImageGetWidth(image),
                                     CGImageGetHeight(image)), image);
  CGColorSpaceRelease(rgbColorSpace);
  CGContextRelease(context);

  CVPixelBufferUnlockBaseAddress(pxbuffer, 0);

  return pxbuffer;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-02-24T10:10:02.427

似乎我遇到了类似的问题，在阅读了以下两篇文章后，我的脑海中浮现出一个想法。

[http://forum.videohelp.com/threads/314973-green-line-at-bottom-of-video-window](http://forum.videohelp.com/threads/314973-green-line-at-bottom-of-video-window)

[http://en.wikipedia.org/wiki/H.264/MPEG-4_AVC#Features](http://en.wikipedia.org/wiki/H.264/MPEG-4_AVC#Features)

```
NSDictionary *videoSettings = [NSDictionary dictionaryWithObjectsAndKeys:
                                       AVVideoCodecH264, AVVideoCodecKey,
                                       [NSNumber numberWithUnsignedLong:sourceWidth], AVVideoWidthKey,
                                       [NSNumber numberWithUnsignedLong:sourceHeight], AVVideoHeightKey,
                                       nil];
AVAssetWriterInput *writerInput =
        [AVAssetWriterInput assetWriterInputWithMediaType:AVMediaTypeVideo outputSettings:videoSettings]; 
```

在开始通过 AVAssertWriter 写入数据之前，请重置`sourceWidth`并`sourceHeight`使用此方法：

```
size_t fixedLineValue(size_t sourceValue){
    size_t divide = sourceValue%4;
    size_t finalValue = sourceValue;
    if (divide) {
        finalValue=(sourceValue/4+1)*4;
    }
    return finalValue;
} 
```

我无法弄清楚为什么要这样做，但在那之后，丑陋的绿色边框被删除了。如果有更好的答案，请发表评论，让我们知道。谢谢。

# matlab - 盐和胡椒的最佳结果

> ID：14187242
> 
> 赞同：-1
> 
> 时间：2013-01-06T21:59:21.807
> 
> 标签：matlab, image-processing

我有一张添加了椒盐噪声的图片。我的任务是使用以下功能将其删除：

您可以使用 matlab 函数 ginput 来查找图像中的特定点（当然在脚本中您应该硬编码所需的坐标）。

您可以使用 conv2、fft2、ifft2、fftshift 等。

您还可以使用中位数、平均值、最大值、最小值、排序等。

据我所知。我可以使用 MinMax 过滤器或中值过滤器。

我的任务是取得最好的成绩！到目前为止，我认为中值过滤器会让我明白这一点。

中值滤波器真的比做 MinMaxMinMax.... 更好吗？有没有更好的方法来获得更好的结果？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T22:07:25.207

中值滤波器是解决椒盐噪声的好方法和教科书方法。Matlab`medfilt2`为此提供了一个函数，但当然您也可以通过计算 3x3 窗口的中心强度来编写自己的代码，`w`使用`median(w(:))`.

# ruby-on-rails-3 - Rails 管理中的 ActiveRecord::HasManyThroughNestedAssociationsAreReadonly 错误

> ID：14187248
> 
> 赞同：6
> 
> 时间：2013-01-06T22:00:04.723
> 
> 标签：ruby-on-rails-3, rails-admin

我刚刚升级到`Rails 3.2.10`并收到一条错误消息，这是我在通过 RailsAdmin 更新记录时从未收到过的错误消息。

```
ActiveRecord::HasManyThroughNestedAssociationsAreReadonly at /admin/vendor/12/edit

Message Cannot modify association 'Vendor#categories' because it goes through more than one other association. 
```

这是我的`Vendor`模型：

```
class Vendor < ActiveRecord::Base
  attr_accessible :name, :description, :banner_image, :logo_image, :intro_text, :thumb_image, :category_ids, :product_ids, :user_id, :remove_banner_image, :banner_image_cache, :remove_logo_image, :logo_image_cache
    mount_uploader :banner_image, ImageUploader
    mount_uploader :logo_image, ImageUploader
    mount_uploader :thumb_image, ImageUploader

    has_many :products, :dependent => :destroy
    has_many :categories, :through => :products
    belongs_to :owner, :class_name => "User",
        :foreign_key => "user_id"   
end 
```

这是我的`Category`模型：

```
class Category < ActiveRecord::Base
  attr_accessible :name, :product_ids, :category_ids
    has_many :category_products do
         def with_products
           includes(:product)
         end
       end

  has_many :products, :through => :category_products

end 
```

这是我的`Product`模型：

```
class Product < ActiveRecord::Base
  attr_accessible :name, :description, :price, :vendor_id, :image, :category_ids, :sku, :remove_image, :image_cache
    mount_uploader :image, ImageUploader

    belongs_to :vendor
    has_many :category_products do
           def with_categories
             includes(:category)
           end
    end

    has_many :categories, :through => :category_products

end 
```

这是我的`CategoryProduct`模型：

```
class CategoryProduct < ActiveRecord::Base
  attr_accessible :product_id, :category_id, :purchases_count

    belongs_to :product
  belongs_to :category

  validates_uniqueness_of :product_id, :scope => :category_id
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-14T09:06:30.057

发生这种情况是因为您的关联是嵌套的，这意味着（来自 rails 源）：如果存在多个连接表，则通过关联是嵌套的……这就是您的情况。

显然，一种解决方法（我没有测试）告诉供应商它不需要自动保存关联。

```
has_many :categories, :through => :products, :autosave => false 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-03T19:15:37.553

您可以将关联标记为只读，然后 rails_admin 将不会在表单中为供应商生成类别字段：

`has_many :categories, -> { readonly }, through: :products`

# django - 自定义 Django.contrib.comments 蜜罐

> ID：14187250
> 
> 赞同：0
> 
> 时间：2013-01-06T22:00:26.003
> 
> 标签：django, django-comments, honeypot

我正在使用 Django 的标准评论系统，我想扩展它的反垃圾邮件蜜罐功能。

我想将字段的默认“名称”和“ID”更改为对垃圾邮件机器人更有吸引力的东西，例如“网站”。我检查了html，它看起来像这样：

```
 <p style="display:none;">
    <label for="id_honeypot">Never send a human to do a machine's job</label>
    <input type="text" name="honeypot" id="id_honeypot" />
  </p> 
```

我认为更改此元素的默认值会增强其反垃圾邮件功能是否正确？我尝试`django/contrib/comments/forms.py`像这样修改它：

```
class CommentForm(CommentDetailsForm):
    #use to be honeypot = forms.CharField(...
    website      = forms.CharField(required=False,
                                label=_('Never send a human to do a machines job')

def clean_honeypot(self):
    """Check that nothing's been entered into the honeypot."""
    value = self.cleaned_data["website"]
    if value:
        raise forms.ValidationError(self.fields["website"].label)
    return value 
```

这成功地改变了django 生成的 html 中的`name`and `id`，但是整个机制停止工作 - 我尝试填充这个不可见的字段，提交并添加了评论。

我也有其他一些想法，但首先我真的很想让这个工作 - 是否可以修改默认蜜罐`name`并`id`让它像它应该的那样工作？

PS我相信这样做更优雅的方法是扩展 django.contrib.comments 并在那里编写修改代码，而不是处理实际的 django 代码——实现这一点的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T23:21:08.927

给我更多的时间来修补，我找到了我两个问题的答案：

为了修改标准蜜罐或创建自己的蜜罐，您必须`CommentForm`通过添加一个`clean_NAME_OF_HONEYPOT`函数和一个`NAME_OF_HONEYPOT`变量来扩展该类，这两者看起来都类似于标准蜜罐，您还必须覆盖该`security_errors`函数以包含您在字典中的新/修改蜜罐。

The best way to do this is to create your custom comments app as described here: [https://docs.djangoproject.com/en/dev/ref/contrib/comments/custom/](https://docs.djangoproject.com/en/dev/ref/contrib/comments/custom/) .

I hope this answer helps anyone else in my situation.

# python - 使用python更新/插入访问数据库

> ID：14187253
> 
> 赞同：0
> 
> 时间：2013-01-06T22:00:46.143
> 
> 标签：python, python-2.7

是否可以在 python 中编写一个简单的`.py`脚本来更新我的访问数据库记录或插入新的记录（如果有的话）？新记录将从 Excel 中提取并推送到数据库中。

**我正在使用***的 MS-Access2010 。*****

 **谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T22:07:39.917

这绝对是可能的。您可能希望使用[`comtypes`module](http://pypi.python.org/pypi/comtypes)来实现，它允许使用组件对象模型 (COM) 在 Windows 进程之间进行通信。

[这是另一个问题中发布的脚本示例。](https://stackoverflow.com/questions/3094537/how-do-you-create-a-mdb-database-file-in-python)

从 Microsoft Excel 中获取信息可以通过很多模块来完成，但我成功使用的一个模块是[`openpyxl`](http://pypi.python.org/pypi/openpyxl/1.6.1). 可以在[此处](http://packages.python.org/openpyxl/usage.html)找到一些使用它阅读 Excel 工作簿的示例。**

# c++ - 在构造函数成员初始化程序中引发 C++ 异常？

> ID：14187255
> 
> 赞同：1
> 
> 时间：2013-01-06T22:01:05.050
> 
> 标签：c++, exception, c++11, constructor

考虑以下情况：

```
struct X { ... };

struct Y
{
     Y(...);

     ...

     X x;

     ...
}

X f()
{
    ...

    if (...)
        throw E;

    ...
}

Y::Y(...) :
    ... ,
    x(f()) ,
    ...
{
    ...
} 
```

这里有任何未定义的行为吗？抛出 E 时，这样的设计是否存在任何陷阱或潜在问题？

**更新：**

`Y::x`可能不是 的唯一成员变量，可能不是类中的第一个成员变量，并且可能在init 列表`Y`的中途被初始化。`Y::Y`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-06T22:03:05.873

> 这里有任何未定义的行为吗？

否。 的构造`Y`已中止。

> 抛出 E 时，这样的设计是否存在任何陷阱或潜在问题？

没有`Y`被创建，所以没有析构函数可以调用。完全构造的元素的析构函数，那些之前`x`在类主体中声明的元素，将被自动调用（否则你怎么知道你抛出的初始化列表有多远）。如果你需要销毁任何东西，那么你必须捕获异常并自己销毁它。你不能吸收异常，你可以重新抛出它，抛出一个新的异常，或者什么都不做，无论如何都会导致异常被重新抛出。对于您的特定用例，不应该有任何东西可以破坏，因为构造函数主体根本不会被调用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-06T22:16:04.127

When an exception is throwing during the construction of an object, the destructors of all fully constructed subobjects are called. That is, assuming your type `X` throwing an exception correctly cleans up any resources it may have allocated before the exception was thrown, there is no issue.

# webapp2 - Firefox webapp 文件输入

> ID：14187259
> 
> 赞同：0
> 
> 时间：2013-01-06T22:01:22.740
> 
> 标签：webapp2, firefox-os

我正在为 firefox aurora (android) 开发一个 webapp。我有一个文件输入。但是当用户点击输入时，他们不能从 sdcard 或文件系统中选择文件，只有图片、音乐或视频。

我在[MOZILLA DEVELOPER NETWORK](https://developer.mozilla.org/en-US/docs/Using_files_from_web_applications)上搜索，但找不到任何有用的东西。

在我的 manifest.webbapp 我有设备存储权限：

```
"permissions": {
    "device-storage:sdcard":{ "access": "readonly" }
  }, 
```

![在此处输入图像描述](../Images/39dde517ff6e4105f6ead57b33b3c180.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T15:38:39.167

根据[源代码](http://mxr.mozilla.org/mozilla-central/source/dom/apps/src/PermissionsTable.jsm#36)，此权限仅授予已打包和特权的应用程序，后者也意味着该应用程序必须由 Marketplace 签名。

您可以在此处找到有关打包应用程序和特权应用程序类型的更多信息： [https ://developer.mozilla.org/en-US/docs/Apps/Packaged_apps](https://developer.mozilla.org/en-US/docs/Apps/Packaged_apps)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T09:38:30.720

我假设您目前只是使用标记？

device-storage:sdcard 确实适用于一组非常不同的用例。我们还没有在 Firefox for Android 上实现它。

显示的应用程序列表只是我们从 Android Intents 系统获得的一组应用程序。我可以想象，如果用户安装了某种文件浏览器应用程序，它可能会响应该意图并且它会在那里弹出。

但当然，这不是您可以在应用程序中依赖的东西。

老实说，我对android上没有提供该功能的默认应用程序感到有些惊讶，但我想就是这样。或者有人知道一种方法来获得我们可以连接的文件选择器意图吗？

中期您将能够使用 DeviceStorage API。这将使您可以直接 JS 访问 SD 卡，这将允许您构建自己的 UI 以从 SD 卡中选择文件。但这种额外的力量也有很多缺点。这是一个特权 API，这意味着您必须将应用程序编写为打包应用程序，并且您必须使用 CSP。而且您必须通过 Firefox 市场审查流程（所有特权应用程序都必须通过代码审查）。

所以这是一个相当遥远的第二选择。

除此之外没有任何解决方案。最好的办法当然是我们可以弹出一个 Android 文件选择器，但我不确定这是否可行。而且它肯定还没有实施。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T08:32:59.040

只需安装 Android 文件管理器应用程序 ( [https://play.google.com/store/search?q=file+manager&c=apps](https://play.google.com/store/search?q=file+manager&c=apps) )，您就可以从 SD 卡中选择文件。不需要特定权限，因为这是由标准文件输入自动处理的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-10T15:01:25.580

只能通过特权或经过认证的应用程序访问 SD 卡。目前据我所知，没有像您希望的那样集成系统菜单。就个人而言，我希望这会有所改变。

API 文档：[https ://developer.mozilla.org/en-US/docs/WebAPI/Device_Storage](https://developer.mozilla.org/en-US/docs/WebAPI/Device_Storage)

您可以创建自己的菜单来模仿系统菜单；通过这种方式，用户可以获得无缝体验，并且他们不知道其中的区别。尽管它不是无法克服的样板水平，但它需要一些样板。

浏览/枚举 SDCard 上所有照片的快速片段：

```
var storage = navigator.getDeviceStorage("sdcard");

sdcard.browse = function () {
  var pics = navigator.getDeviceStorage('pictures');

  // Let's browse all the images available
  var cursor = pics.enumerate();

  cursor.onsuccess = function () {
    var file = this.result;
    alert("File found: " + file.name);

    // Once we found a file we check if there are other results
    if (!this.done) {
      // Then we move to the next result, which call the cursor
      // success with the next file as result.
      this.continue();
    }
  }

  cursor.onerror = function () {
    alert("No files found: " + this.error);
  }
}; 
```

如果您想了解更多有关读取、写入和计算可用存储的详细信息，我目前正在利用业余时间开发一个小型包装库，以便更轻松地使用 SDCard（并处理一些回调以更好地与其他代码集成）在我的业余时间，可能可以帮助你。

# python - 基于生成器编写python迭代器的最佳方法是什么

> ID：14187261
> 
> 赞同：3
> 
> 时间：2013-01-06T22:01:36.330
> 
> 标签：python, iterator, generator

我一直在寻找一种编写基于生成器的 Python 迭代器的好方法。我找到了很多关于迭代器主题的教程，还有很多关于生成器和 yield 语句的教程，但没有任何东西可以将两者结合起来。我建立了一个可行的小例子，并想知道是否有更好的方法来做到这一点。

```
class myIterator :

    def __init__(self, n) :
        self.last = n
        self.myGen = self.myGenerator() 

    def __iter__(self) :
        return self.myGenerator()

    def next(self) :
        return self.myGen.next()

    def myGenerator(self) :
        prev = 0
        fib = 1
        while fib < self.last :
            res = fib
            yield res
            fib = fib + prev
            prev = res

        raise StopIteration 
```

我在一个真实世界的程序中使用了这种技术，该程序可以[在我的 Github 存储库中的 SQLStatements.py 中找到](https://github.com/PeterWooster/SQL-Tools/blob/master/SQLStatements.py)

其中最令人困惑的部分是定义 next() 函数。显而易见的解决方案在每次调用时都返回第一个元素。存储包含生成器的实例变量是可行的，但似乎是一个杂项。

如果您知道更好的方法或涵盖此主题的好教程，请告诉我。

编辑：@MartijnPieters 发布的第三个示例完全解决了这个问题。将 self.generator.next 函数保存在 self.next 中提供了一个 next 函数。我希望这可以帮助其他人试图解决这个问题。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-06T22:05:23.720

迭代器协议由两部分组成。该方法是最重要的一个，当您在对象上`__iter__`使用时，它有望返回迭代器。`iter()`

只需将主体替换`__iter__`为`myGenerator`; 也无需提出`StopIteration`：

```
class myIterator:
    def __init__(self, n):
        self.last = n

    def __iter__(self):
        prev = 0
        fib = 1
        while fib < self.last:
            res = fib
            yield res
            fib += prev
            prev = res 
```

Now`iter(myIterator(10))`是一个迭代器并且有一个`.next()`方法。

如果您希望您的类直接用作迭代器，则需要`__iter__`返回`self`并提供一个`.next()`方法。

方法为每个函数体（并使用）`.next()`生成*一个*`return somevalue`元素。生成器只是一个使用 的函数`yield`，实际上，这样的方法本身为您实现了迭代器协议（其中包括`.next()`）。

如果您要使用`.next()`，它看起来像这样：

```
class myIterator:
    def __init__(self, n):
        self.last = n
        self.prev = 0
        self.fib = 1

    def __iter__(self):
        return self

    def next(self):
        if self.fib < self.last:
            res = self.fib
            self.fib += self.prev
            self.prev = res
            return res

        raise StopIteration 
```

*或者*您可以重用`.next()`生成器的方法：

```
class myIterator:
    def __init__(self, n):
        self.last = n
        self.next = self.myGenerator().next  # Use the generator `.next`

    def __iter__(self):
        return self

    def myGenerator(self):
        prev = 0
        fib = 1
        while fib < self.last:
            res = fib
            yield res
            fib += prev
            prev = res 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-06T22:16:50.507

生成器**已经**是迭代器。无需包装它：

```
>>> def gen():
...  yield 1
...  yield 2
...  yield 3
... 
>>> 
>>> a = gen()
>>> dir(a)
['__class__', '__delattr__', '__doc__', '__format__', '__getattribute__', '__hash__', '__init__', '__iter__', '__name__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', 'close', 'gi_code', 'gi_frame', 'gi_running', 'next', 'send', 'throw']
>>> ai = a.__iter__()
>>> ai
<generator object gen at 0x542f2d4>
>>> a
<generator object gen at 0x542f2d4>
>>> a.next()
1
>>> a.next()
2
>>> a.next()
3
>>> a.next()
Traceback (most recent call last):
  File "<string>", line 1, in <module>
StopIteration 
```

# android - SQLite 数据库 Android - INSERT 方法

> ID：14187269
> 
> 赞同：0
> 
> 时间：2013-01-06T22:02:20.557
> 
> 标签：android, sql, database, sqlite, insert

我在将值插入我的 Android SQLite 数据库表时遇到问题。我已经尝试过改编一些教程示例，但无济于事。有人可以看看我的代码，指出我应该改变什么才能让它工作吗？这是我班级的代码：

```
public class Baza extends SQLiteOpenHelper {
SQLiteDatabase db;
static final String dbName ="MyDb";
static final int dbVersion = 1;

// tabela przepisy
static final String TabName = "Przepisy";
static final String TabCol1 = "id";
static final String TabCol2 = "Nazwa";
static final String TabCol3 = "Kategoria";

static final String dbCreate = "CREATE TABLE" + TabName + "(" + 
    TabCol1+ " INTEGER PRIMARY KEY, "+
    TabCol2+ " TEXT, " +
    TabCol3+ " TEXT)";

public Baza(Context context) {
    super(context, dbName, null, dbVersion);
    // TODO Auto-generated constructor stub
}

@Override
public void onCreate(SQLiteDatabase db) {
    // TODO Auto-generated method stub
    db.execSQL(dbCreate);
}

@Override
public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
    // TODO Auto-generated method stub
    db.execSQL("DROP TABLE IF EXISTS "+ TabName);
}

public boolean insert(String name, String cat)
{
    db = super.getWritableDatabase();
     ContentValues cv=new ContentValues();

       cv.put(TabCol2, name);
       cv.put(TabCol3, cat);

       long isAdded = db.insert(TabName, null, cv);
       if (isAdded == -1)       return false;
       else return true;
}
} 
```

我会很感激任何帮助。

日志错误：

```
 I/Process(1289): Sending signal. PID: 1289 SIG: 9
 D/AndroidRuntime(1318): Shutting down VM
 W/dalvikvm(1318): threadid=1: thread exiting with uncaught exception (group=0x40015560)
 E/AndroidRuntime(1318): FATAL EXCEPTION: main
 E/AndroidRuntime(1318): java.lang.NullPointerException
 E/AndroidRuntime(1318):    at com.example.mojabaza.Baza.insert(Baza.java:60)
 E/AndroidRuntime(1318):    at com.example.mojabaza.Mojabaza$2.onClick(Mojabaza.java:45)
 E/AndroidRuntime(1318):    at android.view.View.performClick(View.java:2485)
 E/AndroidRuntime(1318):    at android.view.View$PerformClick.run(View.java:9080)
 E/AndroidRuntime(1318):    at android.os.Handler.handleCallback(Handler.java:587)
 E/AndroidRuntime(1318):    at android.os.Handler.dispatchMessage(Handler.java:92)
 E/AndroidRuntime(1318):    at android.os.Looper.loop(Looper.java:123)
 E/AndroidRuntime(1318):    at android.app.ActivityThread.main(ActivityThread.java:3683)
 E/AndroidRuntime(1318):    at java.lang.reflect.Method.invokeNative(Native Method)
 E/AndroidRuntime(1318):    at java.lang.reflect.Method.invoke(Method.java:507)
 E/AndroidRuntime(1318):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
 E/AndroidRuntime(1318):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
 E/AndroidRuntime(1318):    at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T22:17:15.953

您缺少一个空格，我不确定`AUTO INCREMENT`是两个词：

```
"CREATE TABLE" + TabName + "(" + 
    TabCol1+ " INTEGER PRIMARY KEY AUTO INCREMENT, "+ 
```

采用：

```
//    Added: v
"CREATE TABLE " + TabName + "(" + 
    TabCol1+ " INTEGER PRIMARY KEY, "+ // autoincrement is implied as well as `not null` 
```

根据错误，您可能需要设置`dbVersion`等于 2 来构建这个新模式。

# java - PNG图像未缩放到全屏尺寸

> ID：14187270
> 
> 赞同：0
> 
> 时间：2013-01-06T22:02:29.837
> 
> 标签：java, android

我的 android 应用程序上有一个启动画面，由 png 图像填充。但是 png 图像没有填充全屏，侧面显示有空格。

我正在观看这个和 AVD。

这是我看到的： ![我的启动画面的视图](../Images/840055d072e0d62a391c39ebf8855752.png)

这是我的 XML 代码：

```
 <?xml version="1.0" encoding="utf-8"?>
 <LinearLayout
 xmlns:android="http://schemas.android.com/apk/res/android"
 android:layout_width="fill_parent"
 android:layout_height="fill_parent">

 <ImageView
 android:src="@drawable/splash"
 android:layout_width="fill_parent"
 android:layout_height="fill_parent"></ImageView>  

</LinearLayout> 
```

这是我的 Android 清单代码的摘录：

```
<uses-sdk
    android:minSdkVersion="5"
    android:targetSdkVersion="17" />

<supports-screens 
android:resizeable="true"
android:smallScreens="true" 
android:normalScreens="true" 
android:largeScreens="true"
android:anyDensity="true" />

<application
    android:allowBackup="true"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name" 
    android:theme="@style/AppTheme" >
            <activity
        android:name="com.shaadcorp.wazaifapp.MainMenu"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
    <activity
        android:name="ButtonMenu"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="com.shaadcorp.wazaifapp.CLEARSCREEN" />
            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
    </activity>   
    <activity
        android:name="wazeefa"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="com.shaadcorp.wazaifapp.WAZEEFA" />
            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
    </activity>
    <activity
        android:name="durood"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="com.shaadcorp.wazaifapp.DUROOD" />
            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
    </activity>

</application>

</manifest> 
```

请问有人可以帮忙吗？我试图增加 png 本身的尺寸，但这没有什么区别。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T22:19:45.003

您需要将`android:scaleType`属性添加到`ImageView`. 大概`centerCrop`就是你想要的。

```
<ImageView
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:scaleType="centerCrop"
    android:src="@drawable/splash" /> 
```

# php - 无法从 sql 表中提取数据

> ID：14187273
> 
> 赞同：1
> 
> 时间：2013-01-06T22:02:41.007
> 
> 标签：php, html, mysql, sql

我有一个 html 表单，我的用户可以使用它来搜索我的 MYSQL 数据库中的表。默认情况下，如果您只是点击 go，它将显示整个表格，但是我希望他们能够选择某些字段和我的 php 表单以通过填写的字段进行搜索。

如果不为所有 11 个输入以它们可以输入的不同组合编写单独的查询，我似乎无法找到一种方法，总共有 76 个查询。

如果有人有办法简化这一点，我会喜欢任何建议。

我曾尝试使用 AND 运算符运行查询，但这不起作用，因为某些变量可以为空并且不会返回任何结果，不确定这是否是应该发生的，但这就是正在发生的事情。

我的html和php：

[http://jsbin.com/oquwid/1/edit](http://jsbin.com/oquwid/1/edit)

PHP

```
$sql = "SELECT * FROM  ".$tbl_name." 
WHERE fname='".$fname."' 
and lname='".$lname."' 
and city='".$city."'
and phone='".$pohne."'
and interest_inet='".$internet."'
and interest_tv='".$television."'
and interest_voice='".$voice."'
and submission_ip='".$ip."'
and inquiry_handled='".$handled."'";
$result = mysql_query($sql);

echo "<table border='1'>";
echo "<tr>";
$i = 0;

while ($i < mysql_num_fields($result))
{
    $meta = mysql_fetch_field($result, $i);   
    echo "<th>".$meta->name."</th>";
    $i++;
}

while ($row = mysql_fetch_row($result))
{
    echo '<tr>';

foreach($row as $item)
{
    echo "<td>".$item."</td>";
}

echo '</tr>';
echo $row;
}

echo "</table>"; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T22:20:01.430

您可以根据填写的内容将部分附加到查询中：

```
if(!empty($fname) || !empty($lname) || !empty($city) || etc.etc.) {
   $sql = "SELECT * FROM  $tbl_name WHERE ";

   $queryParts = array();
   if($fname  != "") { 
      $queryParts[] = " fname='$fname'";
   }
   if($lname != "") {
      $queryParts[] = " lname='$lname'";
   }
   etc.etc.

   $sql .= implode(" AND ", $queryParts);

   // do query, etc.
}
else {
   // Don't do query if no parameters are specified
} 
```

您还需要确保在使用所有查询参数之前对其进行转义，否则可能会有人破坏您的数据。

以下使用循环来避免重复代码：

```
$fieldIsSpecified = false;
$queryFields = array('fname' => $fname, 'lname' => $lname, 'city' => $city, etc...);
foreach($queryFields as $column => $value) {
    if(!empty($value){
         $fieldIsSpecified = true;
         break;
    }
}
if($fieldIsSpecified) {
   $sql = "SELECT * FROM  $tbl_name WHERE ";

   $queryParts = array();
   foreach($queryFields as $column => $value) {
      if(!empty($value)) {
          $queryParts[] = " $column = '$value'";
      }
   }

   $sql .= implode(" AND ", $queryParts);

   // do query, etc.
}
else {
   // Don't do query if no parameters are specified
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T22:19:37.847

如果未填写值，则查询无效的原因可能是因为查询结果为（假设名字为空）

```
SELECT * FROM $tbl_name WHERE fname='' 
```

并且可能没有没有名字的用户。

此外，您考虑为每个请求的信息添加一个标志，并在此基础上向查询的选择部分添加或删除所需的部分？

例如，

```
$sql = "SELECT * FROM $tbl_name WHERE "; 
$queryChanged = false;
if (isset($fname)){
    if (!empty($fname)){
        $sql .= "fname='$fname' ";
        $queryChanged=true;
    }
}
if (isset($lname)){
    if (!empty($lname)){
        $sql .= ($queryChanged) ?  " AND lname='$lname'" : "lname='$lname'";
        $queryChanged = true;
    }
}
... //Continue the logic 
```

我建议你阅读[这篇关于 select * 的文章](https://stackoverflow.com/questions/321299/what-is-the-reason-not-to-use-select)以及[关于用户输入和如何处理它的文章](https://stackoverflow.com/questions/129677/whats-the-best-method-for-sanitizing-user-input-with-php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T03:01:00.340

这就是我必须这样做的方式

php:`

```
//if just lname is set
if(empty($start_date) && empty($end_date) && empty($fname) && isset($lname) && empty($city) &&
 empty($internet) && empty($television) && empty($voice) && empty($phone) && empty($ip) && 
 empty($handled) && empty($not_handled)){ 
$sql = "SELECT * FROM  ".$tbl_name."
WHERE lname='".$lname."'";
$result = mysql_query($sql);
echo "<table border='1'>";
echo "<tr>";
$i = 0;
while ($i < mysql_num_fields($result))
{
$meta = mysql_fetch_field($result, $i);   
echo "<th>".$meta->name."</th>";
$i++;
}
while ($row = mysql_fetch_row($result))
{
echo '<tr>';
foreach($row as $item)
{
    echo "<td>".$item."</td>";
}   
echo '</tr>';
}
echo "</table>";
exit();
}

//if just city is selected
if(empty($start_date) && empty($end_date) && empty($fname) && empty($lname) && isset($city) &&
 empty($internet) && empty($television) && empty($voice) && empty($phone) && empty($ip) && 
 empty($handled) && empty($not_handled)){ 
$sql = "SELECT * FROM  ".$tbl_name."
WHERE city='".$city."'";
$result = mysql_query($sql);
echo "<table border='1'>";
echo "<tr>";
$i = 0;
while ($i < mysql_num_fields($result))
{
    $meta = mysql_fetch_field($result, $i);   
    echo "<th>".$meta->name."</th>";
$i++;
}
while ($row = mysql_fetch_row($result))
{
    echo '<tr>';
foreach($row as $item)
{
    echo "<td>".$item."</td>";
}   
echo '</tr>';
}
echo "</table>";
exit();
} 
```

等等......我将不得不重复这个过程，直到我涵盖所有，我相信 76 个可能性。thnkfully 它只是大量的复制粘贴。谢谢大家的帮助

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-06T22:23:13.473

首先不要使用 MYSQL_ ***。使用 PDO

其次，使用您的代码，您需要填写所有字段。

如果你不想这样做，那就这样吧：

您可以使用 WHERE 1=1 ，但不推荐！！！！

```
 $sql = "SELECT * FROM  ".$tbl_name." WHERE confirm = '0' ";

 $sql .= "AND fname = ".$fname."";
 $sql .= "AND lname = ".$lname."";
 $sql .= "AND city = ".$city."";
 $sql .= "AND phone = ".$pohne."";
 $sql .= "ORDER BY date DESC";
 $result = mysql_query($sql);

 echo "<table border='1'>";
 echo "<tr>";
 $i = 0;

 while ($i < mysql_num_fields($result))
 {
 $meta = mysql_fetch_field($result, $i);   
 echo "<th>".$meta->name."</th>";
 $i++;
 }

 while ($row = mysql_fetch_row($result))
  {
  echo '<tr>';

  foreach($row as $item)
  {
  echo "<td>".$item."</td>";
   }

   echo '</tr>';
   echo $row;
     }

   echo "</table>"; 
```

# java - morphia : 插入数组中的对象

> ID：14187276
> 
> 赞同：1
> 
> 时间：2013-01-06T22:02:52.487
> 
> 标签：java, mongodb, morphia, nosql

使用 Morphia，是否可以对嵌入在数组中的对象执行 saveOrUpdate / upsert 操作。

考虑以下文件：

```
{
_id : "abcd",
myArray : [{
        "key" : "areaTotal",
        "value" : "101.9",
        "label" : "Total area (municipality)"
    }, {
        "key" : "areaUrban",
        "value" : "803",
        "label" : "Total area (urban)"
    }, {
        "key" : "populationDensity",
        "value" : "15991",
        "label" : "Population desnsity"
    }
]
} 
```

有没有一种干净的方法可以用另一个对象替换例如带有键“areaUrban”的数组元素，例如

```
{
        "key" : "areaUrban",
        "value" : "123",
        "label" : "a new label"
} 
```

现在我在两个更新操作中首先删除，然后添加：

```
UpdateOperations<T> ops = createUpdateOperations().removeAll("myArray ", new BasicDBObject("key", "areaUrban")); 
update(createQuery().field("_id").equal(myObjId),ops);
UpdateOperations<T> ops2 = createUpdateOperations().add("myArray ", myReplacementObject); 
update(createQuery().field("_id").equal(myObjId),ops2); 
```

哪个工作正常，但我可以只在一个更新操作中做到这一点（使用 morphia 或普通的 mongo java 驱动程序）？

此外，如果数组中最初不存在匹配对象，则应将 myReplacementObject 对象添加到数组中。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T02:11:12.643

使用[$ 位置运算符](http://docs.mongodb.org/manual/reference/operators/#_S_)：

```
db.test.update({_id: "abcd", "myArray.key": "areaUrban"}, {$set: {"myArray.$.value": 123, "myArray.$.label": "a new label"}}) 
```

* * *

[编辑] 正如 JohnnyHK 在评论中提到的，如果嵌套文档不存在，则不会对其进行更新。

# php - 无法将多数组从 javascript 发布到 PHP

> ID：14187285
> 
> 赞同：0
> 
> 时间：2013-01-06T22:03:22.170
> 
> 标签：php, jquery

我已经搜索了论坛，但没有找到任何与发布多数组有关的具体示例。这是我的问题：

我正在为我的伙伴和我正在编写的应用程序进行前端编程。他已经完成了所有后端工作，但还用 PHP 和 HTML 创建了一个工作原型前端（大约 1991 年的风格，使用表格进行定位……阅读起来绝对是一场噩梦）。

我正在使用 html/css/Jquery 从头开始​​重新编码所有内容。我特别喜欢 jquery 来创建动态表单。在用例中，客户向提供商提出与特定发票相关的新票证（事件）。由于一张发票可能包含几十个行项目，因此客户还可以指定一个或多个项目。在我的代码中，我在一个多数组中捕获所有这些，然后将其发布到一个 php 页面进行处理。

我的问题是我似乎无法找到正确的方法将数据从我的 JS 代码以它喜欢的数据结构发布到 PHP。

上代码：

# **表单页面**

* * *

用户输入的每个项目都有几个字段。我将每个都包装在一个字段集中。

```
$('.add_product').click(function(){
                    index++;
                    $(this).parent().parent().append("<fieldset>" +
                    "<label for='name'>Name</label><input type='text' alt='name' value='' id='" + this + "_name" + index + "'/>" +
                     "<label for='code'>Code</label><input type='text' alt='code' value='' id='" + this + "_code" + index + "'/>" +
                     "<label for='lotnumber'>Lot</label><input type='text' alt='lotnumber' value='' id='" + this + "_lotnumber" + index + "'/>" +
                     "<label for='expiration'>Expiration</label><input type='text' alt='expiration' value='' id='" + this + "_expiration" + index + "'/>" +
                     "<p class='remove_product'>Remove</p></fieldset>"); 
```

提交表单后，我将所有字段集选择到一个多数组中，如下所示：

```
 var postValues={};
 var i=0;
                $('fieldset').each(function(){

                    postValues[i]={"VarChar08":"","VarChar07": $(this).parent().parent().attr('id'),"VarChar14":"P" , "VarChar09": $(this).find('input[alt="name"]').val(), "VarChar10": $(this).find('input[alt="code"]').val(), "VarChar11": $(this).find('input[alt="lotnumber"]').val(), "VarChar12": $(this).find('input[alt="expiration"]').val(),"VarChar13":"","VarChar20":"1"} ;
                    i++;

                }); 
```

我最后一次尝试是对数组进行 JSON 字符串化：

```
var itemValues= JSON.stringify(postValues); 
```

然后我将它们发布到 php 处理器页面：

```
 $.post("some.php", {items: itemValues}); 
```

# **PHP 处理器页面**

* * *

```
$itemValues=json_decode($_POST['items']);
$items = $itemValues;

// read into POST values for submitting to a stored procedure
foreach ($items AS $m => $tmp_items){
        $_POST['VarChar09'] = $items[$m][3]; // name
        $_POST['VarChar10'] = $items[$m][4]; // code
        $_POST['VarChar11'] = $items[$m][5]; // lot
        $_POST['VarChar12'] = $items[$m][6]; // expiry
} 
```

不幸的是，这不起作用。PHP 处理器页面未正确读取数据结构，因此未正确分配值。恐怕我已经达到了我的经验的极限。我怀疑我从javascript方面对数据结构的理解可能存在缺陷。我还没有完全理解拥有一个数组对象、一个对象对象、一个对象数组或一个数组数组的整个想法。尽管如此，这可能与它有任何关系，也可能没有任何关系。

任何帮助深表感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T22:52:10.327

你的`input`元素有几个问题。首先`this`是您尝试连接到 html 字符串的 DOM 元素。

`input`元素没有`name`字段提交和创建密钥所需的内容`$_POST`

使用`name`元素的属性，您可以使用它`serialize()`来生成所有表单数据，而不是自己对数据对象进行硬编码。

```
var data=$('#formID').serialize();

 $.post("some.php", data, function(response){
     /* ajax success... do something with response if needed*/
 }); 
```

API 参考：[http ://api.jquery.com/serialize/](http://api.jquery.com/serialize/)

现在您的 php`$_POST`键将匹配字段中的名称

# javascript - 如何创建可拖动的菜单 div（桌面和移动）

> ID：14187290
> 
> 赞同：2
> 
> 时间：2013-01-06T22:04:35.073
> 
> 标签：javascript, jquery

![在此处输入图像描述](../Images/71b0cf50f59eae3dafb30ff92b196964.png)

以上内容如何制作？它可以通过拖动菜单文本区域（菜单图像或某些内部 div）来上下拖动，并且 div 在拖动时向下或向上（具有最大和最小限制）。

我不能让这个代码工作，任何人都可以给出一个实用的代码吗？

```
whole_menu.onPress = function() {
startDrag(this);
};
whole_menu.onRelease =function () {
stopDrag();
};

whole_menu.onPress = function() {
startDrag(this, false, 0, this._y, 800-this._width, this._y);
};
whole_menu.onRelease =function () {
stopDrag();
}; 
```

**编辑：** 添加了更多解释和代码，因此
**无需关闭此问题**

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-06T22:53:13.117

（**没有 jQuery UI**）我构建了这个，应该适用于所有移动设备！（也在移动设备上测试 - Android）

## [jsBin 演示](http://jsbin.com/caqupon/edit?html,css,js,console,output)

```
var $MB = $('#menu_btn'),
    $M = $('#menu'),
    $DOM = $(document),
    startAtY = 10, // CSS px
    endAtY = 270,  // CSS #menu height px
    clickedAtY,
    clickEventType= document.ontouchstart !== null ? 'mousedown' : 'touchstart',
    moveEventType = document.ontouchmove  !== null ? 'mousemove' : 'touchmove' ,
    endEventType  = document.ontouchend   !== null ? 'mouseup'   : 'touchend'  ;

$MB.on(clickEventType, function( e ) { 

  e.preventDefault();  

  clickedAtY	= e.pageY - $(this).offset().top;
  if(clickEventType === 'touchstart'){
    clickedAtY = e.originalEvent.touches[0].pageY - $(this).offset().top;
  }

  $DOM.on(moveEventType, moveHandler)
      .on(endEventType, stopHandler);

});

function moveHandler( e ) {
  var posY = e.pageY - clickedAtY;
  if(moveEventType === 'touchmove') {
    posY = e.originalEvent.touches[0].pageY - clickedAtY;
  }
  posY = Math.min( Math.max(0, posY), endAtY - startAtY);
  $M.css({top: posY});
}

function stopHandler() {
  $DOM.off(moveEventType, moveHandler)
      .off(endEventType,  stopHandler);
}
```

```
*{margin:0;padding:0;}

body{font-family:Arial;}

#menu_wrapper{
  height:0px;
}
#menu{
  background:#444;
  height:280px;
  margin-top:-270px;
  color:#ccc;
  position:relative;
}
#menu_btn{
  cursor:pointer;
  background:#444;
  padding:10px 20px;
  position:absolute;
  bottom:-30px;
    left:30px;
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

<div id="menu_wrapper">
  <div id="menu">

    <div id="menu_btn">DRAG ME DOWN</div>
  </div>
</div>
```

# javascript - AngularJS - ng-repeat 和 ng-show

> ID：14187292
> 
> 赞同：3
> 
> 时间：2013-01-06T22:04:53.450
> 
> 标签：javascript, angularjs, repeat

我得到以下代码：

```
<div class="map" ng-controller="DealerMarkerListCtrl">
    <a ng-click="showdetails=!showdetails" href="#/dealer/{{marker.id}}" class="marker" style="left:{{marker.left}}px;top:{{marker.top}}px" ng-repeat="marker in dealer"></a>
</div> 
```

这个观点：

```
<div ng-show="showdetails" class="alldealermodal">    
    <div ng-view></div>
</div> 
```

相同的“ng-show”内容仅在 ng-repeat 之外的一个链接上正常工作，但在此 ng-repeat 中它不起作用。
该链接应打开一个覆盖。ng-view 也可以。

我错过了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-06T22:43:01.263

由于[ngRepeat](http://docs.angularjs.org/api/ng.directive:ngRepeat)创建了一个新范围，`showdetails`因此在您之外引用的`ng-repeat`实例与`showdetails`在您的重复中更新的实例不同`ng-click`。

您可以查看[这篇文章](https://stackoverflow.com/questions/11872927/why-doesnt-an-input-modify-a-value-outside-of-an-ng-repeat-and-ng-switch)了解更多详细信息，但围绕新范围的一种方法是绑定到对象属性而不是原始类型。

[这个小提琴](http://jsfiddle.net/RXAP5/)显示了一个小示例绑定到`details.show`而不是`showdetails`：

`$scope.details = { show: true };`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-08T04:41:11.167

> “我错过了什么？”

正如@Gloopy 已经提到的，您可能没有意识到 ng-repeat 创建子范围（每个项目一个）。此外，还需要了解 JavaScript 原型继承的工作原理，因为每个子作用域原型都继承自同一个父作用域，这会影响 JavaScript 如何在作用域上查找（或创建）属性。

请注意，许多 Angular 内置指令会创建子作用域：ng-repeat、ng-include、ng-switch、ng-controller、指令（可以，但可能不会）。有关原型继承如何工作、尝试绑定到原语时为什么会出现问题以及它如何与 Angular 作用域相关的（更多）信息，请参见[此处](https://stackoverflow.com/questions/14049480/what-are-the-nuances-of-scope-prototypal-prototypical-inheritance-in-angularjs/14049482#14049482)。

要扩展@Gloopy 的答案，您可以考虑其他两种选择：

1.  在 ng-repeat 内部使用`$parent`以绑定到父范围属性（而不是创建子范围属性）：
    `<a ng-click="$parent.showdetails=!$parent.showdetails" ...`
2.  在父范围上定义一个方法并调用它，从而也更改父范围属性（而不是子范围属性）：
    `<a ng-click="toggleDetails()" ...`

# r - 在 for 循环中调用函数时 R 中的奇怪行为

> ID：14187297
> 
> 赞同：0
> 
> 时间：2013-01-06T22:05:15.987
> 
> 标签：r, function

我在 R 中有以下架构：

```
functionA<-function(dataA)
{
    #do something
    #no return value
    functionB(dataC)
}

functionB<-function(dataB)
{
    #do something
    #no return value
}

for (i in 1:5)
{
     functionA(list[i])
     print ("message")
} 
```

我遇到的问题是它只评估第一个值，甚至只打印一次“消息”这个词。我认为这是因为 functionB 没有返回到 functionA，但有必要吗？我的意思是 for 循环不应该继续评估其他指令。我已经通过注释该行来尝试代码

```
functionA(list[i]) 
```

在这种情况下，它会打印 5 次消息。有什么可能是错的？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T22:10:29.277

不，这不是我得到的。

```
functionA<-function(dataA) {
    #do something
    #no return value
    functionB(dataC)
}

functionB<-function(dataB) {
    #do something
    #no return value
    print("in here")
}

for (i in 1:5) {
    functionA(list[i])
    print ("message")
}

[1] "in here"
[1] "message"
[1] "in here"
[1] "message"
[1] "in here"
[1] "message"
[1] "in here"
[1] "message"
[1] "in here"
[1] "message" 
```

# java - Android 中 OpenGL ES 2.0 Shapes 的翻译

> ID：14187300
> 
> 赞同：0
> 
> 时间：2013-01-06T22:05:40.950
> 
> 标签：java, android, opengl-es-2.0, transform

最近看了developers.android.com提供的OpenGL ES 2.0 Tutorial。我成功地完成了它（即使不是很清楚），但后来我遇到了一个问题。完成后，我从未被告知如何平移或缩放对象。我尝试了目前看起来合乎逻辑的不同选项，但它们没有奏效。我对android中的OpenGL ES 2.0不是很熟悉。

```
Matrix.setLookAtM(mVMatrix, 0, 0, 0, -3, 0f, 0f, 0f, 0f, 1.0f, 0.0f);
Matrix.multiplyMM(mMVPMatrix, 0, mProjMatrix, 0, mVMatrix, 0);

long time = SystemClock.uptimeMillis() % 4000L;
mAngle = 0.090f * ((int) time);
Matrix.setRotateM(mRotationMatrix, 0, mAngle, 0, 0, -1.0f);

Matrix.multiplyMM(mMVPMatrix, 0, mRotationMatrix, 0, mMVPMatrix, 0);

t.draw(mMVPMatrix); 
```

所有这些矩阵都是大小为 16 的浮点数组。我的问题是，我怎么能用 x 和 y 位置和 sam 进行平移（带有刻度的浮点数）？似乎有 mo setTranslateM 方法，当我尝试替代方法时，我无法使它们工作。我该怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-08T08:44:19.780

要平移/缩放/旋转您的对象，您应该将这些操作应用于您的模型矩阵。

例子：

```
Matrix.setIdentityM(mMMatrix, 0); // reset transformations
Matrix.setRotateM(mMMatrix, 0, 0, 1.0f, 0, 0); // set rotation
Matrix.translateM(mMMatrix, 0, 10.0f, 20.0f, 0); // apply translation
Matrix.scaleM(mMMatrix, 0, 0.25f, 0.25f, 0.25f); // apply scale 
```

请注意，`Matrix`类的某些静态方法会分配内存，因此如果您在每一帧上进行对象转换，您可能不想使用它们。阅读更多关于这里[http://groups.google.com/group/android-developers/browse_thread/thread/b30dd2a437cfb076?pli=1](http://groups.google.com/group/android-developers/browse_thread/thread/b30dd2a437cfb076?pli=1)和我的博客文章这里[http://androidworks-kea.blogspot.com/2012/ 05/developers-notes-about-opengl-es.html](http://androidworks-kea.blogspot.com/2012/05/developers-notes-about-opengl-es.html)

# html - CSS：3x3 repeat-y 背景顶部和底部限制？

> ID：14187304
> 
> 赞同：0
> 
> 时间：2013-01-06T22:06:08.143
> 
> 标签：html, css, background, styles

我有以下问题：

我需要应用一个背景，上面有一个重复-y，以填充我的 div 垂直。现在我有一个问题，它不应该从顶部填充：0 而是从顶部 85px 填充，所以我需要类似的东西

```
position:absolute;
top:85px;
bottom:85px; 
```

用于在 css 中应用的背景。

我的问题的一些附加信息可以在这里找到：[如何使用 HTML / CSS 根据内容高度放置响应式背景？](https://stackoverflow.com/questions/14146489/how-to-place-a-responsive-background-according-to-content-height-with-html-css)

我怎样才能做到这一点？

我的结构如下：

```
<content><innercontent></innercontent></content> 
```

content 具有浏览器的整个宽度，innercontent 具有固定宽度。

```
#content {
    background: 
    url("images/bg-top.png") no-repeat scroll center top, 
    url("images/bg-bottom.png") no-repeat scroll center bottom, 
    url("/images/bg-middle.png") repeat-y scroll center center transparent;
    position:relative;
} 
```

有人能帮我吗 ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T22:19:37.850

如果我理解正确，只需将其更改为：

```
#content {
    background: 
    url("images/bg-top.png") no-repeat scroll center top, 
    url("images/bg-bottom.png") no-repeat scroll center bottom, 
    url("/images/bg-middle.png") repeat-y scroll center 85px transparent;
    position:relative;
} 
```

注意背景位置 y`85px`的代替`center`。

[http://jsfiddle.net/ghKb2/1/](http://jsfiddle.net/ghKb2/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T22:28:01.140

最后我找到了：

只需用这个创建一个div：

```
#middle-stripe {
  background: url("/wp-content/themes/vitaphone/library/images/bg-middle.png") repeat-y scroll center center transparent;
   position: absolute;
   top:85px;
   bottom:85px;
   width:100%;
 } 
```

# javascript - 为什么这个元素是空的？

> ID：14187310
> 
> 赞同：0
> 
> 时间：2013-01-06T22:06:55.103
> 
> 标签：javascript

**澄清：**

我对使用 jQuery 方法不感兴趣。

**概括**

我使用一种方法仅在 html 完成加载后运行我的模块。它看起来像这样。 `page_complete`是页面上最后一个元素的 id。

```
$A.finish('page_complete', function () { 
    // page has finished loading
}); 
```

完成是这样实现的。它只是一个检查最后一个元素是否存在的计时器。一旦找到它，它就会初始化所有模块。

我不明白为什么 FF 告诉我的元素是 NULL。

```
/*finish
** Once an element has been loaded an HTML focus event is fired
** on that ID.  It can not be cancelled and bubbles up
**
*/
$A.finish = function (id, callback) {
    var htm_finished = document.getElementById(id);
    if (htm_finished) {
        $A.initAll(); // intilAll will fire the init function of all modules.
        $A.makeEvent('focus', htm_finished);
        callback();
    } else {
        setTimeout(function () {
            $A.finish(id, callback);
        }, 10);
    }
}; 
```

**火狐浏览器中的错误**

```
...TypeError: this.E.ready is null @ ... 
```

请注意，我在错误所在的位置发表了评论。

**有错误的模块**

```
/*MUserAny
**
**
**   
*/
$A.module({
    Name: 'MUserAny',
    S: {
        DynSma: SDynSma,
        DynTwe: SDynTwe,
        DynArc: SDynArc,
        AniFlipMediaPane: SAniFlipMediaPane,
        AniFlipPage: SAniFlipPage,
        ClientStorage: SClientStorage
    },
    E: {
        ready: $A('#page_complete')[0]
    },
    init: function () {
        var pipe = {},
            this_hold = this;
        this.E.ready.addEventListener("focus", function (event) { // error is here.
            pipe = $A.definePipe(this_hold.Name);
            $A.machine(pipe);
        }, false);
    },
    pre: function (pipe) {
        var h_token = this.S.ClientStorage.get('h_token');
        if ((h_token === '0') || (h_token === 'undefined') || (h_token === null)
                || (h_token === undefined)) {
            this.S.AniFlipPage.run('sp');
            pipe.state = false;
        } else {
            pipe.server.smalls.h_token = h_token;
            pipe.state = true;
        }
        this.S.AniFlipMediaPane.run('mi_cover');
        return pipe;
    },
    post: function (pipe) {
        this.S.DynSma.run(pipe.server.smalls);
        this.S.DynArc.run(pipe.server.arcmarks);
        this.S.DynTwe.run(pipe.server.tweets);
        this.S.AniFlipPage.run(this.S.ClientStorage.get('page'));
        return pipe;
    },
    finish: function (pipe) {
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T22:18:52.033

看起来像

```
E: {
    ready: $A('#page_complete')[0]
} 
```

正在作为对象文字的一部分进行评估，如果在页面完成之前发生这种情况，则会出现错误。一种快速而肮脏的解决方案可能是更改`E.ready`为一个函数，该函数只会在 期间调用`init`，您知道这会在页面完成后发生，例如

```
E: {
    ready: function() { return $A('#page_complete')[0]; }
},
init: function () {
    var pipe = {},
        this_hold = this;
    this.E.ready().addEventListener("focus", function (event) { ... 
```

# security - 保护 websockets 免受外部脚本的影响

> ID：14187316
> 
> 赞同：3
> 
> 时间：2013-01-06T22:07:45.007
> 
> 标签：security, browser, websocket, cross-domain

在许多网页上，我们都包含外部脚本。无论是 facebook 之类的按钮、分析或广告系统的客户端代码、外部评论提供者或其他东西。

这些脚本无法访问我的 Ajax 资源，因为一直在检查原始标头。

但是，我有点担心这些脚本可以对我页面上的 websocket 连接做什么。据我所知，在这里，仅在握手期间检查原始标头。

假设我打开一个连接并像这样定义一个 onmessage 处理程序

```
var ws = new WebSocket("ws://host/resource");
ws.onmessage = function(evt) { my stuff ... } 
```

外部脚本是否无法重新分配 onmessage 处理程序，从而无法访问我的服务器通过 websocket 发送到浏览器的所有内容？喜欢

```
var oldHandler = ws.onmessage;
ws.onmessage = function(evt) { 
   externalscript.readMystuffAndDoEvilThings(evt); 
   oldHandler(evt); 
} 
```

我不明白为什么这是不可能的。wss:// 和会话 cookie 或其他东西都不会阻止它。但也许我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T22:28:06.150

你没有错过任何东西。如果您已将外部（跨域）脚本加载到浏览上下文中，则该脚本具有与“本地”（同源）脚本相同的权限。外部脚本可以以同样的方式替换您的 XHR 回调、console.log-s 和其他所有内容。

此类恶意外部脚本的问题在于 a) 您必须愿意将它们加载到您的应用程序中，并且 b) 脚本必须知道要替换什么（函数/变量名称）。

防止此类攻击的方法是使用所谓的 JavaScript 模块模式——将所有代码包装在一个匿名函数中并立即执行该函数。这样，您的代码就不会受到外部脚本的影响，因为它在闭包（本地范围）内执行。有关该模式的更多信息和变体，请参阅此：http: [//addyosmani.com/resources/essentialjsdesignpatterns/book/#modulepatternjavascript](http://addyosmani.com/resources/essentialjsdesignpatterns/book/#modulepatternjavascript)

# c++ - 如何将char数组转换为float数组？

> ID：14187318
> 
> 赞同：2
> 
> 时间：2013-01-06T22:08:05.493
> 
> 标签：c++, types, casting, type-conversion

为了训练分类器，需要使用一组浮点数组指定训练数据。不幸的是，我可用的训练数据是*字节数组*（实际上它们是[Ipp8u](http://software.intel.com/sites/products/documentation/hpc/ipp/ipps/ipps_ch2/ch2_data_types.html)数组，可以转换为无符号字符数组）。

本质上，给定一个 unsigned char 数组，我需要将它转换为一个 float 数组：换句话说，给定一个 unsigned char 数组，我应该将它读取为一个 float 数组。是否始终允许此操作？浮点数据类型是否允许所有可能的位配置？如果是，如何实现这种转换？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-06T23:17:57.123

有很多方法可以近似实数。有一些浮点表示，其中一些位表示指数，另一些位表示系数，有一些定点表示，其中一些位表示整数部分，一些位表示派系部分，有任意有限精度表示，其中一些数量的存储某个基数中的“数字”等，并且对于每个一般的表示类别，在将该表示转换为`float`s 时，都有无数种细节很重要。

您的问题没有指定字节数组包含的表示形式。指定数组`Ipp8u`不接近提供必要的信息。

* * *

您可能的意思是字节数组包含机器对`float`s 的本机表示（可能是 IEEE-754）的字节表示，最多在字节序上有所不同。

您可以简单地将`char`数组中的数据 memcpy 放入浮点数组中：

```
char c[10 * sizeof(float)] = {...};
float f[10];
std::memcpy(f, c, 10 * sizeof(float)); // or you can search for an implementation of bit_cast 
```

不应该做的一件事是简单地转换`char`数组：`float *f = reinterpret_cast<float*>(c);`这种转换可能具有未定义的行为，因为`float`可能具有比`char`.

如果字节序不同，则首先遍历字节数组并重新排序字节，如下所示：

```
// assuming sizeof(float) == sizeof(uint32_t)
for (int i; i<sizeof c; i+=sizeof(float)) {
    uint32_t i;
    std::memcpy(&i, c + i, sizeof(uint32_t));
    ntoh(i); // swaps bytes from Network TO Host order.
    std::memcpy(c + i, &i, sizeof(uint32_t));
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-06T22:57:44.707

鉴于[Intel Integrated Performance Primitives](http://software.intel.com/sites/products/documentation/hpc/ipp/ipps/)的文档，函数：

```
IppStatus ippsConvert_8u32f(const Ipp8u* pSrc, Ipp32f* pDst, int len); 
```

似乎是最方便的功能，可以**完全按照**您的要求进行操作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-06T22:16:00.043

您应该明确地执行每个操作，而不是依赖隐式转换。首先读取 char 形式的数组

```
unsigned char charArray[100];
// reading 
```

然后逐个转换元素

```
float floatArray[100];
for(i=0; i<100; ++i) {
   floatArray[i] = (float) charArray[i];
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-06T22:16:06.043

您可以在 for 循环中使用[atof运行迭代转换。](http://www.cplusplus.com/reference/cstdlib/atof/)然后你可以只使用浮点数组。我确信有一个单线解决方案。

# qt - Qt QByteArray 驱动类

> ID：14187319
> 
> 赞同：-2
> 
> 时间：2013-01-06T22:08:10.000
> 
> 标签：qt

我的驾驶课程有问题

```
 class Myclass:public QByteArray 
{
public :
Myclass();
}

Myclass::Myclass()
:QByteArray ()
{

} 
```

当我尝试将 Myclass 视为 QByteArray 时的问题： Myclass tt("fooo");

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T22:33:18.497

看起来您没有采用 C 字符串参数的构造函数。

构造函数不是继承的，你必须将你需要的每个构造函数添加到你的类中，即使你只是要调用一个超类构造函数而没有别的。

例子：

```
MyClass::MyClass(const char *cstr) : QByteArray(cstr) {} 
```

# android - 在Android中获取GridView的实际列宽

> ID：14187321
> 
> 赞同：5
> 
> 时间：2013-01-06T22:08:22.743
> 
> 标签：android, android-gridview

各位开发者您好。

我在 android 应用程序中有一个网格视图。网格视图具有自动适应列数的设置，并且最小列宽为 250 像素。

在网格单元格内，我有一个具有图像视图和一些文本视图的 LinearLayout。

我希望我的图像视图始终是方形的，但不幸的是，我无法使用任何布局设置来做到这一点（如果我错过了一个选项，请在此处接受建议）。

所以我的想法是我应该以某种方式在我的图像加载类中获取网格列宽度并在那里动态调整 imageView 高度，以匹配宽度。

我没有得到列宽。如果我在我的设置一个断点，我 `public View getView(int position, View convertView, ViewGroup parent)`会看到我的父 ViewGroup 是 Grid 并且它具有正确的列宽值，但是当我使用时：

```
GridView mGridView = (GridView)parent;
int width = mGridView.getColumnWidth(); 
```

该应用程序崩溃，因为它说没有 getColumnWidth 方法。

这里有什么帮助吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-07T00:10:41.840

该解决方案可能会根据您的要求扩展您的 ImageView 并覆盖 onMesure() 方法：

```
onMeasure(int widthMeasureSpec, int heightMeasureSpec){
   super.onMeasure(widthMeasureSpec,heightMeasureSpec);
   setMeasuredDimension(getMeasuredWidth(),getMeasuredWidth());

} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-11-06T15:35:46.153

以防万一有人正在寻找一种方法来获取实际的 columnWidth pre api 16（就像我看到这篇文章时一样），这就是我检索它的方式。

我扩展了 GridView 并用这个覆盖了 getColumnWidth 方法

```
@SuppressLint("NewApi")
@Override
public int getColumnWidth() {
    if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.JELLY_BEAN)
        return super.getColumnWidth();
    else {
        try {
            Field field = GridView.class.getDeclaredField("mColumnWidth");
            field.setAccessible(true);
            Integer value = (Integer) field.get(this);
            field.setAccessible(false);

            return value.intValue();
        } catch (NoSuchFieldException e) {
            throw new RuntimeException(e);
        } catch (IllegalAccessException e) {
            throw new RuntimeException(e);
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-12T16:06:47.403

Daniel Bo 的答案的替代方法是手动计算该值：

```
private int getColumnWidth(Context context, GridView gridView) {
    if (android.os.Build.VERSION.SDK_INT >= 16)
        return gridView.getColumnWidth();

    Resources res = context.getResources();
    int lPad = (int)res.getDimension(R.dimen.left_padding);
    int rPad = (int)res.getDimension(R.dimen.right_padding);
    int hSpace = (int)res.getDimension(R.dimen.horizontal_spacing);
    int cols = gridView.getNumColumns();
    int width = gridView.getWidth();

    return (width - lPad - rPad + hSpace) / cols - hSpace;
} 
```

请注意，这只适用于高于 11（Honeycomb）的 API，并假设您使用定义为资源的某些值设置 GridView。例如，假设您有一个 dimens.xml 具有：

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <dimen name="left_padding">4dp</dimen>
    <dimen name="right_padding">8dp</dimen>
    <dimen name="horizontal_spacing">2dp</dimen>
</resources> 
```

然后你的布局 XML 文件有：

```
<GridView
    ...
    android:horizontalSpacing="@dimen/horizontal_spacing"
    android:paddingLeft="@dimen/left_padding"
    android:paddingRight="@dimen/right_padding"
    ...
    /> 
```

如果您有许多类似的 GridView，最好将这些属性放在自定义样式中。

至少这对我有用，而不必使用反射。请注意，频繁调用此函数可能会过大。

希望这可以帮助某人。

# javascript - Javascript 将元素 ID 属性作为参数传递

> ID：14187322
> 
> 赞同：1
> 
> 时间：2013-01-06T22:08:34.300
> 
> 标签：javascript, onclick, parameter-passing, setattribute

这个说法有效。单击节点时，我会收到一条显示其 ID 的消息。

```
 newnode.setAttribute("onClick", "alert(this.id)"); 
```

我需要将*this.id*的值传递给不同的函数，并且正在努力解决它。

尝试1：

以下不起作用；我知道我不能将**this.id**传递给另一个做同样事情的函数，因为**这**与测试函数中的任何内容都无关：

```
newnode.setAttribute("onClick", "test(this.id)"); 

function test(f){
alert(f);
} 
```

尝试2：

```
var testvar = newnode.id;
newnode.setAttribute("onClick", "test(testvar)"); 

function test(f){
alert(f);
} 
```

为什么我的 setAttribute 行中无法识别*testvar ？*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T22:21:28.823

```
newNode.onclick = function(){
  test(this.id);
};

function test(id){
  alert(id);
} 
```

示例：http: [//jsfiddle.net/sHZeL/1/](http://jsfiddle.net/sHZeL/1/)

# php - 在数据库（MySQL）的输出上使用 htmlspeciachars，还有什么要考虑的来防止 XSS？

> ID：14187326
> 
> 赞同：0
> 
> 时间：2013-01-06T22:09:23.957
> 
> 标签：php, mysql, database, xss

在数据库（MySQL）的输出上使用 htmlspeciachars，还有什么要考虑的来防止 XSS？

从数据库（在本例中为 MySQL）获取数据时在输出上使用 htmlspecialchars 是否正确，可以防止 XSS？在这种情况下，要在 HTML 文档中显示 HTML？还有什么你应该考虑的吗？我的意思是在哪些其他情况下你可能容易受到 XSS 攻击？

假设我有一个网站，我在其中创建了一个登录系统，供用户发布新帖子，用户可以在这里删除这些新闻帖子，但这里使用了一个 JavaScript 函数和 alertbox() 来确保用户真的想删除这条新闻，如果是，则新闻 ID 通过 URL 传递，如下所示：

```
echo '<a class="btn-small btn-danger" onclick="deleteNews('. htmlspecialchars($newsidfk) .')" ">Delete news</a>'; 
```

Javascript函数：

```
//alert deleteNews
function deleteNews($newsidfk)
{
var ans = window.confirm(Are you sure you want to delete this news post?');
        if (ans == true)
        {
            window.location.href="delete.php?news_id_fk="+$newsidfk;
        }
} 
```

还有什么我应该考虑的东西来防止 XSS，或者这里不能做 XSS？假设我有一个字符串而不是数字，我应该做一些 JavaScript 编码，也许是 encodeURI() 函数吗？

使用 htmlspecialchars 阻止例如脚本标签、链接标签和 img 标签运行是否正确？这就是 XSS 的工作方式，因为有人可以，例如，窃取用户的私人信息？

我了解到在显示数据库输出时应该始终进行清理，但是存储到数据库中的输入呢？您是否也应该对此进行清理，还是仅使用 PDO 准备好的语句或其他东西就足够了，以及如何这样做？

我在 wiki 上的这篇文章中阅读了有关 HTML 清理的内容： [http ://en.wikipedia.org/wiki/HTML_sanitization](http://en.wikipedia.org/wiki/HTML_sanitization)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T23:19:20.917

> 从数据库（在本例中为 MySQL）获取数据时在输出上使用 htmlspecialchars 是否正确，可以防止 XSS？在这种情况下，要在 HTML 文档中显示 HTML？还有什么你应该考虑的吗？我的意思是在哪些其他情况下你可能容易受到 XSS 攻击？

是的，这是正确的。有时被忽视的完整故事的一部分是字符编码。虽然默认情况下这工作得很好，但如果您没有检查您在输入的数据上使用的编码是否也向函数本身发出信号，则*可能会出现问题。*`htmlspecialchars`

例如，如果您使用 PHP 5.3，并且您的数据库中有 UTF-8 编码的字符串并且您这样查询它们并且您在 HTML 中使用 UTF-8，那么您还应该告诉`htmlspecialchars`：

```
$flags    = ENT_COMPAT | ENT_HTML401;
$encoding = 'UTF-8'

htmlspecialchars($string, $flags, $encoding); 
```

尽管如果您使用的是 PHP 5.4，UTF-8 是默认编码，您不需要提供它：

```
htmlspecialchars($string); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T22:25:28.447

始终将 JavaScript 文字输出为 JSON。

```
<a class="btn-small btn-danger" onclick="deleteNews(<?php echo htmlspecialchars(json_encode($newsidfk)); ?>)" ">Delete news</a>

<script>
var data = <?php echo json_encode($data); ?>
</script> 
```

# javascript - 角度插值正在改变父表单元素，如何覆盖此函数以便仅评估文本节点处的表达式？

> ID：14187330
> 
> 赞同：0
> 
> 时间：2013-01-06T22:09:45.817
> 
> 标签：javascript, html, forms, templates, angularjs

我在一个电子商务网站上工作，并使用 Angular 在产品详细信息页面上构建一个小部件。对于浏览器最初呈现为 HTML 的内容，我的控制非常有限。我的小部件需要完成的大部分工作都按预期工作。`add to cart`我有 Angular 的表达式插值影响表单的副作用。每种产品的颜色变化都将呈现到页面上`HTMLOptionElement`，其`innerText`值如下所示：

`{{hex="000000";sizes=["S","M","L","XL","2XL"];name="Black";}}`或
`{{hex="FFFFFF";sizes=["S","M","L"];name="White";}}`或
`{{hex="323C88";sizes=["S","M","L","XL","2XL"];name="Royal";}}`

Angular 初始化过程的最终结果是这些中的每一个都转换为以下内容：

`Black`或
`White`或
`Royal`分别

这很好，因为这允许用户为其颜色选择提供可读值。副作用是父`HTMLFormElement`级不再通过提交按钮提交。它的 class 属性已更改为 include`ng-pristine`和`ng-valid`。

**请注意，在页面加载之前，我无法更改此表单的 HTML。**

我确信我可以拼凑一个简单的覆盖来让表单提交，但我正在寻找更多关于插入 Angular 初始化的信息。到目前为止，我能想到的最好的方法是将表单包装`ng-non-bindable`在 java 模板中：

```
<div ng-non-bindable>${MyAddToCartFormRendersHere}</div> 
```

但是，我需要一种`$interpolate`在页面加载后自己进行调用的方法。

**这可行，但我敢打赌有更好的方法。**

```
AngularApp.directive("customInterpolation", function ($interpolate, $document) {
$document.find("option:contains('{{')").each(function(i,el){
    var angEl = angular.element(el);
    angEl.text($interpolate(angEl.text(),true));
}); 
```

然后表单包装器变为：

```
<div ng-non-bindable data-custom-interpolation>${MyAddToCartFormRendersHere}</div> 
```

我的指令将运行一次，但由于 nonBindable 指令，返回任何东西（例如链接函数）都是无用的。... 一定有更好的方法。

这是一个[jsfiddle](http://jsfiddle.net/kWecG/3/)来更好地说明这个问题。`ngNonBindable`请注意，除非指令应用于周围，否则表单不会提交`<div>`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T20:31:48.510

编写一个带有 compile 函数的指令，该函数查找`form`并修改`action`属性以包含`?`. 该指令的 compile 函数将在 Angular 编译表单之前执行。

HTML：

```
<div modify-action>
  <form class="product-border product-gap addtocart" method="post" action=""> 
```

指示：

```
myApp.directive('modifyAction', function() {
    return {
        compile: function(element) {
            var form = element.find('form');
            console.log(form);
            form.attr('action', '?');
            console.log(form);
        }
    }
}); 
```

[小提琴](http://jsfiddle.net/mrajcok/J2uLy/)。当您点击提交时，您会看到表单已提交。

# rest - 凭据包含 Unicode 时的基本身份验证编码

> ID：14187331
> 
> 赞同：5
> 
> 时间：2013-01-06T22:09:53.727
> 
> 标签：rest, tomcat, unicode, encoding, basic-authentication

在这个问题上，我一直在用头撞墙。我读过类似的帖子和文章；大多数建议在 Tomcat 的 server.xml 文件中将 URIEncoding 设置为 UTF-8，但这在这里似乎没有什么区别。

我有一个 ReSTful Web 服务部署到托管在 Tomcat 7 上的测试环境。Tomcat 被配置为使用 Java 6，尽管 Java 7 也安装在机器上。*对托管在那里的服务运行基本身份验证测试时，登录失败，当原始*凭据包含 Unicode 字符时，我收到 HTTP 状态 401 的响应。当凭据仅包含 ASCII 时，基本身份验证工作正常。我也可以完全不使用基本身份验证登录 - 我的服务支持自定义登录标头和 RFC 2047。使用这种方法，凭据是否包含 Unicode 都没有关系，登录不是问题。

具体来说，“问题”似乎是用户名被 UTF-8 编码两次。我的记录器（单独的问题）中有一个错误，其中日志文件是 ANSI 编码的。当您将日志文件转换为 UTF-8 时，字符将正确显示。但是在这种情况下，有问题的用户名比它应该的长得多，当文件转换为 UTF-8 时，它看起来就像它最初应该有的一样（在转换之前）。例如：

*   BAD (BASIC AUTH): SampleUser-Ã‚Â¢Ã°Â£Å½Â´eÃŒâ€šÃ©Â¾Â± -> SampleUser-Â¢ð£Ž´eÌ‚é¾±</li>
*   好的（RFC 2047）：SampleUser-Â¢ð£Ž´eÌ‚é¾± -> SampleUser-¢ê龱</li>

这里真正的问题是我有自己的 Tomcat 7 (Java 6) 实例在本地运行，但我无法针对它重现问题。我比较了两个 Tomcat 的 conf 目录，它们看起来是一样的。我无法弄清楚为什么基本身份验证在一种环境中工作而不是在另一种环境中工作。我正在从我的机器上运行测试，所以这不可能是由于我测试它的方式（JUnit/JSystem）的差异。

这是我所知道的：

*   就特权而言，我们谈论的用户类型无关紧要。用户名中的 Unicode 是有问题的因素。
*   请求是通过 XML 还是 JSON 发送并不重要。我的服务支持这两种类型的序列化。
*   接受字符集和内容类型（如果适用）在请求中都设置为 UTF-8。
*   Java 系统属性在两种环境中是相同的。

以下文章对我来说非常有趣，因为它们提出了将 RFC 2047 和基本身份验证结合在一起的可能性。我不认为这是必要的，因为基本的身份验证字符串本身只包含 ASCII（因为它是 base-64 编码的）。即使是这样，为什么在一台 Tomcat 服务器而不是另一台服务器上需要这样的东西？我觉得追求这种组合方法并没有解决根本问题，这才是真正让我发疯的原因！

*   [http://www.mentby.com/Group/tomcat-user/basic-authentication-failed-with-multibyte-username.html](http://www.mentby.com/Group/tomcat-user/basic-authentication-failed-with-multibyte-username.html)
*   [我应该为 HTTP 基本身份验证使用什么编码？](https://stackoverflow.com/questions/7242316/what-encoding-should-i-use-for-http-basic-authentication)

提前感谢您提供有关尝试或仔细检查的建议。测试环境对我来说有点局限——我只能在下班时间“玩”，所以如果我没有及时回复，我提前道歉。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-09T04:33:50.247

从您提供的数据来看，实际上似乎 UTF-8 数据正在转换为 ASCII 编码，而不是双重 UTF-8 编码。

就实际问题而言，不幸的是，基本身份验证没有提供任何方式来传输未解码的用户名和密码的字符集。因此，您的主要选择是假设并手动指定字符集，使用环境中的默认字符集，或确定提供字符集的自定义方式（例如另一个标题）。每种选项都取决于您对环境和通信的客户端/服务器端的控制程度，以及您是否希望所有调用都使用相同的字符集。

基于一台服务器行为正确而另一台服务器行为不正确，我假设解码当前使用环境中的默认字符集。您是正确的，编码字符串将仅包含 ASCII（因此您可能没有看到传输编码值的问题），因此数据可能在解码过程中（或之后）丢失。根据您选择的库，它可能会生成字节数组或字符串，因此请确保在从字节数组创建字符串时检查您是否提供了字符集（例如 new String(decodedData, someCharset)）或看看是否有办法将它提供给库（如果它产生一个字符串）。

# mysql - MDB2 准备好的语句并插入 NOW()

> ID：14187333
> 
> 赞同：0
> 
> 时间：2013-01-06T22:10:00.483
> 
> 标签：mysql, function, prepared-statement, mdb2

我正在使用 MDB2 的准备好的语句，对[文档](http://pear.php.net/manual/en/package.database.mdb2.intro-execute.php)有点困惑，特别是处理 MySQL 内置函数，如 NOW() 或 CURDATE()。

> $data 中传递的值必须是文字。不要提交 SQL 函数（例如 CURDATE()）。应该在执行时执行的 SQL 函数需要放在准备好的语句中。同样，不能使用标识符（即表名和列名），因为名称在准备阶段得到验证。

所以文档说要在准备好的语句中包含这些函数，但我不确定如何解释字段名。例如，如果我有一个包含五列的表：

id 姓 名 性别 date added

我想插入一行，只有第一个，最后一个和添加日期......我可能会使用类似的东西

```
INSERT INTO mytable (firstname,lastname,dateadded) VALUES('jane','doe',NOW()) 
```

如果不是 date added 列，我会使用类似的东西：

```
 $types = array(
        'text', 
        'text' 
    );
    $sth = $mdb2->prepare('
        INSERT INTO 
            mytable 
        VALUES 
            (
                :firstname,
                :lastname
            )', $types);

    $data = array(
        'firstname'     => 'Jane', 
        'lastname'  => 'Doe'
    );
    $affectedRows = $sth->execute($data); 
```

那么——就列出字段名而言，我如何解释 MySQL 函数？或者我是否需要计划为表中的每个字段插入值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T23:46:32.777

我不明白你的问题。
为什么不像它所说的那样将 NOW() 添加到准备好的语句中？

```
$sql = 'INSERT INTO mytable ( lastname, firstname, dateadded) 
        VALUES (:firstname, :lastname, NOW())';
$sth = $mdb2->prepare($sql, $types); 
```

# python - python to cython - 消除python调用

> ID：14187335
> 
> 赞同：2
> 
> 时间：2013-01-06T22:10:24.123
> 
> 标签：python, numpy, cython

我目前正在尝试将以下循环转换为 cython：

```
cimport numpy as np
cimport cython
@cython.boundscheck(False) # turn of bounds-checking for entire function
def Interpolation(cells, int nmbcellsx):
    cdef np.ndarray[float, ndim=1] x,y,z
    cdef int i,j,len
    for i in range(nmbcellsx):
      x = cells[i].x
      y = cells[i].y
      z = cells[i].z
      len = x.size
      for j in range(len):
         x[j] = x[j] * y[j] * z[j]

    return 0 
```

到目前为止，一切看起来都还不错，但是对 cells[i].* 的访问仍然需要 python 调用。这可以防止 i-loop 的并行化。

这是一个 cython 反馈（使用 cython -a 生成）：

[cython -a 反馈](http://i49.tinypic.com/30sarye.png)

因此问题是：如何删除这些 python 回调（即，使第 9-12 行变为白色）？

当我尝试像这样添加 Cell 的类型时：

```
cimport numpy as np
cimport cython

cdef class cell_t:
   cdef np.ndarray x,y,z

@cython.boundscheck(False) # turn of bounds-checking for entire function
def Interpolation(np.ndarray[cell_t,ndim=1] cells, int nmbcellsx):
    cdef np.ndarray[float, ndim=1] x,y,z
    cdef int i,j,len
    for i in range(nmbcellsx):
      x = cells[i].x
      y = cells[i].y
      z = cells[i].z
      len = x.size
      for j in range(len):
         x[j] = x[j] * y[j] * z[j]

    return 0 
```

我收到以下 cython 错误：dtype must be "object", numeric type or a struct（它抱怨声明中的 cell_t）

非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T04:23:26.473

使用[Typed Memoryview](http://docs.cython.org/src/userguide/memoryviews.html)怎么样？

```
cimport cython

cdef class cell_t:
    cdef public float[:] x, y, z

    def __init__(self, x, y, z):
        self.x = x
        self.y = y
        self.z = z

@cython.boundscheck(False) # turn of bounds-checking for entire function
def Interpolation(cell_t[:] cells, int nmbcellsx):
    cdef float[:] x,y,z
    cdef int i,j,length
    cdef cell_t cell
    for i in range(nmbcellsx):
        cell = cells[i]
        x = cell.x
        y = cell.y
        z = cell.z
        length = len(x)
        for j in range(length):
            x[j] = x[j] * y[j] * z[j]
    return 0 
```

这是测试代码：

```
import numpy as np
from cells import cell_t, Interpolation

x = np.array([1,2,3], np.float32)
y = np.array([4,5,6], np.float32)
z = np.array([7,8,9], np.float32)
c1 = cell_t(x, y, z)

x = np.array([1,1,1,1,1], np.float32)
y = np.array([2,2,2,2,2], np.float32)
z = np.array([3,3,3,3,3], np.float32)
c2 = cell_t(x, y, z)

cells = np.array([c1, c2], object)

Interpolation(cells, 2)

print c1.x.base
print c2.x.base 
```

和输出：

```
[  28\.   80\.  162.]
[ 6\.  6\.  6\.  6\.  6.] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-06T22:45:25.660

您没有告诉**Cython**参数的类型，`cells`因此它将使用**Python**查找方法。尝试将定义更改为以下内容：

`def Interpolation(np.ndarray cells, int nmbcellsx):`

这将告诉**Cython**它正在获取`ndarray`类型，因此可以使用**C**访问。

# xml - 生成 XML 属性而不是元素

> ID：14187340
> 
> 赞同：2
> 
> 时间：2013-01-06T22:10:54.597
> 
> 标签：xml, jaxb

我正在使用`@XmlRootElement`注释以及`@XmlElement`在我的 Spring MVC 应用程序中生成 xml 输出。我有以下课程：

```
@XmlRootElement
public class Chart
{
    private String id;
    private String name;
    private List<Connection> connections;
    //..................

    @XmlElement(name = "connection")
    public List<Connection> getConnections()
    {
        return this.connections;
    }

    //..................
}

public class Connection
{
    private String from;
    private String to;

    public String getFrom()
    {
        return this.from;
    }

    public void setFrom(String from)
    {
        this.from = from;
    }

    public String getTo()
    {
        return this.to;
    }

    public void setTo(String to)
    {
        this.to = to;
    }
} 
```

我得到这样的 xml 输出：

```
<chart>
    <id>a1</id>
    <name>chart1</name>
    <connection>
        <from>a1</from>
        <to>a2</to>
    </connection>
    ....
</chart> 
```

但是，我需要以这种方式格式化 xml：

```
<chart>
    <id>a1</id>
    <name>chart1</name>
    <connection from="a1" to="a2"></connection>
    ....
</chart> 
```

如何配置注释以实现此结果？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T22:36:44.903

用于您要视为属性`@XmlAttribute`的特定元素。`Connection`

```
public class Connection
{
    private String from;
    private String to;

    public String getFrom()
    {
        return this.from;
    }

    @XmlAttribute
    public void setFrom(String from)
    {
        this.from = from;
    }

    public String getTo()
    {
        return this.to;
    }

    @XmlAttribute
    public void setTo(String to)
    {
        this.to = to;
    }
} 
```

# python - Google App Engine 联系表

> ID：14187344
> 
> 赞同：3
> 
> 时间：2013-01-06T22:11:36.833
> 
> 标签：python, google-app-engine, contact-form

我有一个静态 (HTML/CSS) 网站作为 Google App Engine - Python 上的应用程序托管。一切正常，除了我想添加一个联系表格。我找到了一个我希望使用的[很棒的模板](http://theodin.co.uk/blog/ajax/contactable-jquery-plugin.html)，但发现它需要 PHP 才能工作。有什么方法可以让它工作或找到与 GAE 一起使用的联系表。

我知道将 GAE 用于静态网站并不是它的主要用途，但它是免费的，并且非常适合我想要它做的事情（托管单页简历）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-07T07:17:21.120

看看[GAE 样板](https://github.com/coto/gae-boilerplate)。在样板处理程序中，有一个名为的处理程序`ContactHandler`可以执行您想要执行的操作。

无论如何，您都应该研究这个项目的代码，因为它提供了很多在 GAE 中编写代码的良好实践。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T22:15:56.140

本教程展示了如何将表单与`webapp2`GAE 一起使用。如果您刚刚通过标准 HTTP 提交的版本，您应该能够重新处理它以捕获该信息。

[处理表格](https://developers.google.com/appengine/docs/python/gettingstartedpython27/handlingforms)

```
import cgi
import webapp2

from google.appengine.api import users

class MainPage(webapp2.RequestHandler):
    def get(self):
        self.response.out.write("""
          <html>
            <body>
              <form action="/sign" method="post">
                <div><textarea name="content" rows="3" cols="60"></textarea></div>
                <div><input type="submit" value="Sign Guestbook"></div>
              </form>
            </body>
          </html>""")

class Guestbook(webapp2.RequestHandler):
    def post(self):
        self.response.out.write('<html><body>You wrote:<pre>')
        self.response.out.write(cgi.escape(self.request.get('content')))
        self.response.out.write('</pre></body></html>')

app = webapp2.WSGIApplication([('/', MainPage),
                              ('/sign', Guestbook)],
                              debug=True) 
```

# php - PHP 搜索功能打印所有记录，而不是那些搜索

> ID：14187345
> 
> 赞同：0
> 
> 时间：2013-01-06T22:11:43.357
> 
> 标签：php, sql, search

我刚刚在 PHP 中创建了一个非常简单的搜索功能，但遇到了一些问题。搜索功能向数据库发送查询，并打印结果，但它不打印我想要的结果。它应该打印那些类似于用户输入的记录，但它只打印每条记录。

我的表格如下：

```
<form action="<?php echo $_SERVER['PHP_SELF']; ?>" method="post">
     <input  type="text" name="name"> 
     <input  type="submit" name="submit" value="Search"> 
</form> 
```

使其搜索的 PHP 代码是：

```
if(isset($_POST['submit'])) 
    { 
     require ('mysqli_connect.php');
     include ('config.php');

    $term = $_POST['term'];
        $q = "SELECT  name, producer, jamtypes, user FROM Jam WHERE name LIKE '%" . $term .  "%'";
        $sql = @mysqli_query ($dbc, $q);

     while ($row = mysqli_fetch_array($sql)){

        echo "<br />";
         echo 'Name: '.$row['name'];
         echo '<br/> Producer: '.$row['producer'];
         echo '<br/> Created By: '.$row['user'];
         echo '<br/> Category: '.$row['jamtypes'];
         echo '<br/>';

        }
  } 
```

多谢你们

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T22:15:22.667

你的表单域是`name`，不是`term`，所以你的 PHP 应该是

```
$term = $_POST['name']; 
```

因为`$term`由于值不正确而为空白，所以您的查询将返回所有结果。（您的查询看起来像`SELECT name, producer, jamtypes, user FROM Jam WHERE name LIKE '%&'`）

仅供参考，打开 error_reporting 并报告通知会告诉你这一点。始终使用错误报告和显示所有错误进行开发。

# opengl - 如何在顶点着色器中使用计时器来为 OpenGL 中的点大小设置动画

> ID：14187346
> 
> 赞同：2
> 
> 时间：2013-01-06T22:11:51.353
> 
> 标签：opengl, timer, shader, point

我正在尝试实现一个点云，其中不同点的大小应根据与它们相关的不确定值而变化。比方说，如果这个值为零，则大小应该是恒定的，如果它接近 1，那么这些点的半径应该越来越多。首先，点的大小应该增加，达到最大值后，它们应该减小直到最小值，依此类推。描述这种现象的函数可能是：

```
pointSize = x +/- c * pointUncertainty, where x = standard point size 
                                              c = scaling constant 
```

根据我的阅读，这可以通过将一个统一的计时器变量传递给我的顶点着色器并计算其中的点大小来实现。但是，所有点应该同时变化，这意味着不确定性为 1 的点和不确定性为 0.5 的点应该同时达到它们的最小和最大值 pointSize。此外，整个过程不应依赖于帧速率。

我不确定完成这项工作的最佳方法是什么，如何最好地实现增加-减少-增加-模式以及在哪里放置必要的 OpenGL (4.2) 命令。

编辑：我仍然希望得到这个问题的答案，因为我不清楚如何实现这种动画效果的整个过程。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T08:23:20.690

您可以传递带有每个点的值的纹理 1D。然后使用[texelFetch](http://www.opengl.org/sdk/docs/tutorials/ClockworkCoders/texturing.php) [()](http://www.opengl.org/sdk/docs/manglsl/xhtml/texelFetch.xml)检索值。您可以使用[原子计数器](http://www.geeks3d.com/20120309/opengl-4-2-atomic-counter-demo-rendering-order-of-fragments/)（如果使用 OpenGL 4.2）或[gl_vertexID](http://www.opengl.org/sdk/docs/manglsl/xhtml/gl_VertexID.xml)来执行此操作。也看看[这个](https://stackoverflow.com/questions/7954927/glsl-passing-a-list-of-values-to-fragment-shader)问题和[这个](https://stackoverflow.com/questions/9043845/glsl-per-vertex-fixed-size-array)第一，接受的答案还建议了其他解决方案，例如 UBO。虽然如果您的点云很大，那么[Buffer Textures](http://www.opengl.org/wiki/Buffer_Texture)就是您所需要的。

让我们采用[缓冲区纹理](http://www.opengl.org/wiki/Buffer_Texture)方法：

*   您创建一个纹理缓冲区并用将定义您的点目标大小的值填充它。（阅读我在上面放置的链接如何设置它。
*   在顶点着色器中，您可以通过 texelFetch 采样访问这些值。正如我所说，您可以使用 gl_VertexID 按当前顶点进行采样，（类似这样）：

    统一采样器缓冲点缓冲区；

    void main() { float destSize = texelFetch(pointsBuffer, gl_VertexID).x; ... }

*   [现在，您可能希望根据某个数量将点](http://www.opengl.org/sdk/docs/manglsl/xhtml/gl_PointSize.xml)大小从默认值插入到目标大小。是的，介于 0 和 1 之间的计时器输入可以完成这项工作。使用[mix()](http://www.opengl.org/sdk/docs/manglsl/xhtml/mix.xml)内置方法从默认目的地。为了更有趣，通过基于时间的 sin() 或 cos() :)

*   正如您提到的 OpenGL 超级棒，它有一章解释了纹理缓冲区的工作原理。再读[一遍。](http://renderingwonders.wordpress.com/2011/01/30/chapter-09-%E2%80%93-advanced-buffers-beyond-the-basics-%E2%80%93-hdr-msaa/)您要做的不是火箭科学，也不是初学者水平。所以请耐心等待 - 这总是很好的提示使用 OpenGL。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-26T18:47:33.703

首先...感谢您的回答。我只使用顶点着色器就可以解决问题。我想这是我希望得到的解决方案。也许有同样问题的人可以从中受益：

我的顶点着色器的一部分看起来像这样：

```
 ... 
 "  float standardPointSize = 100.0;"
 "  float timeScale = standardPointSize / my_loopDuration;"
 "  float currentTime = mod(my_time, my_loopDuration);"
 "  float offset = currentTime * timeScale * in_uncertainty;"
 "  if(currentTime < my_loopDuration / 4)"
 "  {"
 "      gl_PointSize = standardPointSize - 4 * offset;"
 "  }"
 "  else if(currentTime >= my_loopDuration / 4 && currentTime < my_loopDuration / 2)"
 "  {"
 "      gl_PointSize = standardPointSize - standardPointSize * in_uncertainty + 4 * offset - 1 * in_uncertainty * standardPointSize;"
 "  }"
 "  else if(currentTime >= my_loopDuration / 2 && currentTime < 3 * my_loopDuration / 4)"
 "  {"
 "      gl_PointSize = standardPointSize + 4 * offset - 2 * in_uncertainty * standardPointSize;"
 "  }"
 "  else if(currentTime >= 3 * my_loopDuration / 4 && currentTime <= my_loopDuration)"
 "  {"
 "      gl_PointSize = standardPointSize + standardPointSize * in_uncertainty - 4 * offset + 3 * in_uncertainty * standardPointSize;"
 "  }"
 ... 
```

my_time 和 my_loopDuration 是统一变量。第一个使用 glutGet(GLUT_ELASED_TIME) 设置，第二个是任意数字。

# ios - 如何在每个段中创建具有不同字体的 UISegmentedControl？

> ID：14187348
> 
> 赞同：1
> 
> 时间：2013-01-06T22:11:55.550
> 
> 标签：ios, uisegmentedcontrol

如何在每个段中创建具有不同字体的 UISegmentedControl？我知道我可以使用`setTitleTextAttributes: forState:`，但这一次为所有按钮设置了相同的字体。我正在尝试创建这样的东西： ![例子](../Images/777721ca4a6c72cba3a4fc0afe77d31f.png)

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T22:51:49.410

您应该使用`– setTitle:forSegmentAtIndex:`UISegmentedControl，并通过使用 NSString UIKit Additions 之一向他传递 NSString 的自定义绘制。

看看这个链接：http: [//developer.apple.com/library/ios/#documentation/uikit/reference/NSString_UIKit_Additions/Reference/Reference.html](http://developer.apple.com/library/ios/#documentation/uikit/reference/NSString_UIKit_Additions/Reference/Reference.html)

# sql - sqlite中简单字符串表的奇怪行为

> ID：14187349
> 
> 赞同：2
> 
> 时间：2013-01-06T22:11:59.783
> 
> 标签：sql, database, sqlite

我正在尝试将 md5 校验和存储在 sqlite 表中，并且它几乎一直运行良好（对于数万个文件）。但是对于一个特定的文件，事情变得很奇怪。在我看来，下面示例中的校验和似乎有一些混淆 sqlite 的“神奇”特性。

```
SQLite version 3.6.22
Enter ".help" for instructions
sqlite> CREATE TABLE files (md5 STRING UNIQUE NOT NULL);
sqlite> INSERT INTO files (md5) values ("8534112824210843669373e916873875");
sqlite> INSERT INTO files (md5) values ("9534112824210843669373e916873875");
SQL error: column md5 is not unique
sqlite> SELECT * FROM files;
Inf
sqlite> 
```

请注意，第二个字符串相似，但明显不同。您可以尝试使用几乎任何其他字符串，它工作正常。这种行为的原因是什么？我在 sqlite 中发现了一个错误吗？

**已解决**无论出于何种原因，“STRING”列类型在 sqlite 中具有“数字亲和性”，这意味着如果可能，它将被解释为数字。做我想做的事情的正确方法是使用“TEXT”列类型。无论如何，感谢您的回答！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-06T23:38:29.200

无论出于何种原因，列`STRING`类型在 SQLite 中具有“数字亲和性”，这意味着如果可能，它将被解释为数字。

校验和`8534112824210843669373e916873875`类似于一个浮点值，因为它恰好包含一个`e`（使用指数表示法使它看起来像一个浮点数）。因此，它确实被解释为一个数字。

存储普通文本字符串的正确方法是使用`TEXT`列类型。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-06T22:18:59.943

我最好的猜测是你应该使用单引号而不是双引号：

```
INSERT INTO files (md5) values ('8534112824210843669373e916873875');
INSERT INTO files (md5) values ('9534112824210843669373e916873875'); 
```

这是字符串的正确分隔符。

根据[文档](http://www.sqlite.org/lang_keywords.html)，当您将某些内容放在双引号中时，它将被视为标识符。这两个值恰好看起来像非常大的浮点数，采用伪科学格式——你知道，6.023e23 是一个有效数字。我的猜测是这些被转换为最大的浮点值或非数字，所以两者都是相等的。

在对 SQLFiddle 进行了一些测试之后，这种行为似乎是字符串的工作方式。考虑：

```
select 1e2  --> 100
select '1e2'  --> 1e2
select cast('1e2' as string)  --> 100
select cast('1e2' as varchar(255))  --> 1e2 
```

你能把表中的数据类型从字符串改成varchar吗？这是因为 string 对 numeric 和 varchar 具有亲和力（根据[this](http://www.sqlite.org/datatype3.html)）。

# ruby-on-rails - Excel 数据库加载缓慢的页面

> ID：14187351
> 
> 赞同：1
> 
> 时间：2013-01-06T22:12:12.850
> 
> 标签：ruby-on-rails, database, performance, excel, page-load-time

我正在使用大约 1600 行和 4 列的 Excel 电子表格来填充数据库以在 Ruby 应用程序中显示。这导致页面加载时间超过 20 秒。我怎样才能提高性能？

从 db\seeds.rb：

```
oo = Excelx.new("RatingsDB.xlsx")
oo.default_sheet = oo.sheets.first

2.upto(oo.last_row) do |line|
    Rating.create(name: oo.cell(line,'B'), score: oo.cell(line,'C'), when_rated: oo.cell(line,'A'), comment: oo.cell(line,'D'))
end 
```

从 app\controllers\ratings_controller.rb：

```
 def index
    @ratings_by_name = Rating.paginate(:order => 'name ASC', :page => params[:page], :per_page =>10, :conditions => ['name like ?', "%#{params[:search]}%"])
    @ratings_by_score = Rating.paginate(:order => 'score DESC', :page => params[:page], :per_page =>10, :conditions => ['name like ?', "%#{params[:search]}%"])

    respond_to do |format|
      format.html # index.html.erb
      format.json { render json: @ratings_by_name }
    end
  end 
```

从 app\views\ratings\index.html.erb：

```
<div class="tabbable">
  <ul class="nav nav-pills">
    <li class="active"><a href="#tab1" data-toggle="tab">By Name</a></li>
    <li><a href="#tab2" data-toggle="tab">By Score</a></li>
    <li><form class="navbar-search">
      <input type="text" class="search-query span3" placeholder="Search" name="search">
      <div class="icon-search"></div>
     </form></li>
  </ul>

  <div class="tab-content">
    <div class="tab-pane active" id="tab1">
      <% @ratings_by_name.each do |rating| %>
      <div class="rating">
        <div class="row">
          <div class="span7">
            <strong><%= rating.name %></strong>
            <div class="meta">
                | <%= link_to 'View', rating %> | 
              <span class="admin">
                <%= link_to 'Edit', edit_rating_path(rating) %> | 
              </span>
              Rated on <%= rating.when_rated %>
            </div>
          </div>   
          <div class="span1">
            <%= rating.score %>
          </div>
        </div>
      </div>
      <% end %>
      <%= will_paginate @ratings_by_name %>   
    </div> 
```

# javascript - 添加 OnError 后出现异常错误

> ID：14187352
> 
> 赞同：1
> 
> 时间：2013-01-06T22:12:29.750
> 
> 标签：javascript, syntax, onerror

希望有人可以提供帮助。

我有一个 java 脚本，可以在我的 html 页面中创建许多图像。但如果图像丢失（未找到），我想显示默认图像（none.png）。所以使用上面的onerror方法我改变了下面的工作行

从

```
aelem.innerHTML += "<img src='/AjaxZfc/ViewClient.aspx?public=only&name=Extensions/row/" + itab + ".png' alt=" + TabNode.text + " />"; 
```

至

```
 aelem.innerHTML += "<img src='/AjaxZfc/ViewClient.aspx?public=only&name=Extensions/row/" + itab + ".png' alt=" + TabNode.text + " onerror="this.onerror=null;this.src='/AjaxZfc/ViewClient.aspx?public=only&name=Extensions/row/none.png';" />"; 
```

但是我的脚本现在失败并说

第 88 行 ..（上面的行）char 180（我认为是单引号 ' ）预期为“;”

请你帮忙

谢谢

小号

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T22:21:53.427

您应该使用反斜杠转义所有`inner`双引号：

```
aelem.innerHTML += "<img src=\"/AjaxZfc/ViewClient.aspx?public=only&name=Extensions/row/" + itab + ".png\" alt=\"" + TabNode.text + "\" onerror=\"this.onerror=null;this.src='/AjaxZfc/ViewClient.aspx?public=only&name=Extensions/row/none.png';\" />"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T22:25:12.173

您必须按如下方式使用它

```
aelem.innerHTML += "<img src='/AjaxZfc/ViewClient.aspx?public=only&name=Extensions/row/" + itab + ".png' alt=" + TabNode.text + " onerror='this.onerror=null;this.src=\'/AjaxZfc/ViewClient.aspx?public=only&name=Extensions/row/none.png\';' />"; 
```

你写作的方式不是一个好的选择。总是更喜欢使用函数而不是编写内联函数。

你可以使用以下

```
aelem.innerHTML += "<img src='/AjaxZfc/ViewClient.aspx?public=only&name=Extensions/row/" + itab + ".png' alt=" + TabNode.text + " onerror='ChangeSource(this)' />"; 
```

然后新建一个函数

```
function ChangeSource(self) {
    self.onerror=null;
    self.src='/AjaxZfc/ViewClient.aspx?public=only&name=Extensions/row/none.png';
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-06T22:25:44.810

在引号内使用引号时必须更加小心。让我们将您的字符串连接拆分为加号：

```
aelem.innerHTML += "<img src='/AjaxZfc/ViewClient.aspx?public=only&name=Extensions/row/" +
 itab +
 ".png' alt=" +
 TabNode.text +
 " onerror="this.onerror=null;this.src='/AjaxZfc/ViewClient.aspx?public=only&name=Extensions/row/none.png';" />"; 
```

问题出在最后一行，你想写 onerror="something" 但是你已经有整个图像的 html 代码在双引号中，所以它没有被正确解释（整个 this.onerror... 部分不被视为string - 我认为当您查看 Stackoverflow 如何为您的代码着色时，您可以很容易地看到它）。

在此示例中，您不能轻易将 onerror=".." 更改为 onerror='..' 因为在 onerror 语句中，您还必须在 src 属性中使用单引号。解决此问题的一种方法是使用反斜杠转义一些引号。

# .net - WebRole 和 HttpHandler 中不同的 AppDomain

> ID：14187353
> 
> 赞同：1
> 
> 时间：2013-01-06T22:12:30.377
> 
> 标签：.net, azure

我有一个 web 项目 (asp.net mvc) 在 windows azure 中部署为 web 角色。对于网络角色，我有一个继承自 RoleEntryPoint 的 WebRole 类。我重写了 OnStart() 方法来初始化一些静态类。

在同一个项目的 RequestHandler (IHttpHandler) 中，我使用这些静态类，但它们没有被初始化——我必须再次在 Global.asax 中初始化它们。我认为它们属于不同的应用领域。

我没有在真正的天蓝色环境中测试过这种行为，只在模拟器中测试过。

有没有办法来解决这个问题？我需要静态类在 WebRole 类和请求处理程序之间共享数据。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T10:51:51.143

WebRole.cs 在与您的实际 Web 应用程序不同的进程中运行（[在此处](http://blogs.msdn.com/b/windowsazure/archive/2010/12/02/new-full-iis-capabilities-differences-from-hosted-web-core.aspx)解释）：

![在此处输入图像描述](../Images/5438155404de053d48e8779a6c8bc90b.png)

如果您希望您的 Web 应用程序使用静态类，您将需要使用 Global.asax。如果您不想重复代码，请考虑将静态属性存储在不同的类中，并在 WebRole.cs 和 Global.asax 中初始化它们，如下所示：

```
public static class MyStaticThingie
{
    public static string XmlContentThingie { get; private set; }
    public static Container IoCContainer { get; private set; }

    public static void Init()
    {
        IoCContainer = ...;
        XmlContentThingie = File.ReadAllText("Somefile.xml");
    }
}

public class WebRole : RoleEntryPoint
{
    public override bool OnStart()
    {
        MyStaticThingie.Init();

        var something = MyStaticThingie.IoCContainer.GetSomething();
        something.DoSomething();

        return base.OnStart();
    }
}

public class Global : System.Web.HttpApplication
{
    void Application_Start(object sender, EventArgs e)
    {
        MyStaticThingie.Init();
    }
} 
```

# javascript - 如何通过 javascript 验证 facebook 用户的安全性？

> ID：14187355
> 
> 赞同：-2
> 
> 时间：2013-01-06T22:12:46.953
> 
> 标签：javascript, facebook, authentication, login, facebook-javascript-sdk

我需要一个始终相同的 facebook 用户的唯一 ID 代码，因此我可以将其与 FB 用户 ID 一起保存在我的网站数据库中，以便用户通过 facebook 进一步登录。不幸的是，authResponse 只包含临时 ID：

```
authResponse: {
   accessToken: '...', // expire
   expiresIn:'...',
   signedRequest:'...', // expire
   userID:'...'
} 
```

我无法仅使用 FB 用户 ID 登录用户...这太不安全了，因为我必须通过 javascript 将 authResponse 信息发送到 php。（PHP SDK 不适用于我的网络空间 [无 root 访问权限]）。

有什么解决办法吗？或者也许是另一种在不使用 PHP SDK 的情况下登录/验证 Facebook 用户进入我的网站的方式？

感谢帮助！

**编辑：**
提交我的问题后，我发现了这个类似的帖子：[如何通过 Facebook 的 Javascript SDK 安全地授权用户](https://stackoverflow.com/questions/14186146/how-to-securely-authorize-a-user-via-facebooks-javascript-sdk)

提问者提到了一种在后续步骤中通过 facebook 通过 cookie 提供的加密信息对用户进行身份验证的方法。
我现在将尝试解密此 cookie 信息，就像我在“通过 facebook 注册”部分所做的那样。使用我的 appID 和 securityID。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T14:35:13.950

通过加密的 cookie 信息对 facebook 用户进行身份验证的方法很好：

这里的代码：

```
// PHP script which get visitor's FB ID over $_GET['fbid'] (for example through ajax or javascript redirect)
if(isset($_GET['fbid'])) {
    define('FACEBOOK_APP_ID', 'YOUR APP ID');
    define('FACEBOOK_SECRET', 'YOUR SECRET ID');

    function parse_signed_request($signed_request, $secret) {
        list($encoded_sig, $payload) = explode('.', $signed_request, 2);

        // decode the data
        $sig = base64_url_decode($encoded_sig);
        $data = json_decode(base64_url_decode($payload), true);

        if (strtoupper($data['algorithm']) !== 'HMAC-SHA256') {
                error_log('Unknown algorithm. Expected HMAC-SHA256');
                return null;
        }

        // check sig
        $expected_sig = hash_hmac('sha256', $payload, $secret, $raw = true);
        if ($sig !== $expected_sig) {
            error_log('Bad Signed JSON signature!');
            return null;
        }

        return $data;
    }

    function base64_url_decode($input) {
        return base64_decode(strtr($input, '-_', '+/'));
    }

    // Check if Facebooks cookie is set
    if(isset($_COOKIE['fbsr_' . FACEBOOK_APP_ID])) {
        $response = parse_signed_request($_COOKIE['fbsr_' . FACEBOOK_APP_ID], FACEBOOK_SECRET);

        // Check if userID sent by visitor is the same like decrypted userID given from cookie
        if($response['user_id'] == $_GET['fbid']) {
            // Login script here
            echo "Successfully authenticated!";
        } else {
            // userID sent by visitor is modified
            echo "Please don't use others FB ID!";
        }
    } else {
        // Facebook cookie is not set
        echo "Please allow cookies!";
    }

} 
```

# python - Django 模型交互和显示更改

> ID：14187356
> 
> 赞同：0
> 
> 时间：2013-01-06T22:13:16.757
> 
> 标签：python, django

我一直在 Django 遇到这个奇怪的问题。在网站中，当我创建模型并重定向到我列出模型的页面时，新模型尚未收听。然后，当我刷新页面时，模型就在那里。如何确保在重定向之前完成数据库调用？感觉不同步和错误。删除模型时也会发生这种情况。感谢帮助。

PS 我的应用程序托管在 Google App Engine 上，我使用的是 Django-non-rel。

下面是一些创建对象的代码：

```
def new_object(request, template_name, parent=None):
  form = ObjectForm(request.POST or None, user=request.user)
  if form.is_valid():
    model = form.save()
    model.owner = request.user
    model.parent = parent
    model.save()     
    if parent:
        return HttpResponseRedirect(parent.get_absolute_url())
    else:
        return HttpResponseRedirect('/')

  data = { 'form' : form, 'parent': parent } 
  context = RequestContext(request)    
  return render_to_response(template_name, data, context) 
```

对象的保存功能

```
def save(self, *args, **kwargs):
   ''' On save, update timestamps '''
   if not self.id:
        self.created_date = datetime.datetime.today()
   self.modified_date = datetime.datetime.today()

   if self.parent:
       self.parent.modified_date = self.modified_date
       self.parent.save() 
```

# cocoa-touch - 当我在项目之间拖动空白区域时，为什么我的 UICollectionView 不滚动？

> ID：14187363
> 
> 赞同：3
> 
> 时间：2013-01-06T22:14:10.173
> 
> 标签：cocoa-touch, scroll, uicollectionview

我正在创建一个网格布局`UICollectionView`，但只有当我按下图像时，滚动似乎才起作用。如果我按下空白区域，视图不会滚动。如何为背景和图像上的印刷机启用滚动？

例如，在下面的屏幕截图中，只有当我按下白色方块时滚动才有效，但当我按下方块之间的黑色时滚动无效。

![](../Images/5df900e5f5c4a80332552ed6cec7fae6.png)

我认为我没有任何滚动特定代码，但如果您希望我添加特定代码示例，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T00:45:00.993

如果您设置`backgroundColor`or `backgroundView`，`UICollectionView`当触摸视图中的任何位置（包括示例中的白色方块之间）时，它将滚动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-01T00:31:08.133

最后我解决了这个问题。这是我所做的：

我注意到问题是我的 UICollectionViewCell 有 userInteractionEnabled = YES。我尝试将此值更改为 NO，然后滚动开始工作。UICollectionViewCells 正在拦截触摸并且 Collection 视图滚动不起作用。

但是我有一个附带的问题：一旦我触摸了一个单元格，didSelectItemAtIndexPath 方法就没有被调用。

我的解决方案是添加一个 UITapGestureRecognizer 来检测是否已触摸单元格并手动调用此方法。

将此添加到 viewDidLoad 方法：

```
UITapGestureRecognizer *singleTap = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(singleTapGestureCaptured:)];
[self.collectionView addGestureRecognizer:singleTap]; 
```

这是 singleTapGestureCaptured 方法：

```
- (void)singleTapGestureCaptured:(UITapGestureRecognizer *)gesture
{
    CGPoint touchPoint=[gesture locationInView:self.collectionView];
    NSIndexPath* indexPath = [self.collectionView indexPathForItemAtPoint:touchPoint];
    [self collectionView:self.collectionView didSelectItemAtIndexPath:indexPath];
} 
```

希望这对你有帮助！

# windows-8 - 如何在 Windows 8 中预览 PSD？

> ID：14187372
> 
> 赞同：1
> 
> 时间：2013-01-06T22:15:55.107
> 
> 标签：windows-8, photoshop, psd

我希望能够看到我的 PSD 的缩略图。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T22:39:14.257

应该在 Windows 8 上工作

[http://thecustomizewindows.com/2010/10/enable-thumbnail-view-for-psd-files/](http://thecustomizewindows.com/2010/10/enable-thumbnail-view-for-psd-files/)

我认为在 Windows 7 中也是如此。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T00:23:35.080

内置的缩略图查看器非常慢。我建议使用 ACDsee 图片查看器进行缩略图查看和更快的图片浏览。

# json - 在jsp中使用gson将字符串转换为json

> ID：14187374
> 
> 赞同：1
> 
> 时间：2013-01-06T22:15:58.810
> 
> 标签：json, string, jsp, gson

我在一个字符串中有一个非常简单的 json：

```
{"username" : "a", "active" : 0} 
```

我想将此字符串转换为某种 json 对象。我只需要使用jsp获取用户名的值。如果有帮助，我已经设置了 gson。

提前感谢您的帮助，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T23:03:52.653

定义一个用于存储 JSON 的 java 类，例如：

```
package com.onabai;

public class User {
    public String username = "";
    public int active = 0;
} 
```

然后从 JSP 解析 JSON 将是：

```
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<%@ page import="com.google.gson.Gson" %>
<%@ page import="com.onabai.User" %>

<html>
<head>
    <title>Powered by Zafu: OnaBai</title>
</head>
<body>
<%
    String json = "{\"username\" : \"a\", \"active\" : 0}";
    Gson gson = new Gson();
    User user = gson.fromJson(json, User.class);
    out.println("username:" + user.username);
%>
</body>
</html> 
```

*编辑：*如果你只需要`username`你可以定义`User`为：

```
package com.onabai;

public class User {
    public String username = "";
} 
```

只能访问`username`.

# java - 如何在 Java 中正确获取线程名称？

> ID：14187383
> 
> 赞同：26
> 
> 时间：2013-01-06T22:16:57.277
> 
> 标签：java, multithreading

我有这个类用于在 Java 中创建线程

```
package org.vdzundza.forms;

import java.awt.Graphics;
import java.awt.Graphics2D;

public class DrawThread extends Thread {
    private static final int THREAD_SLEEP = 500;
    public CustomShape shape;
    private Graphics g;

    public DrawThread(CustomShape shape, Graphics g) {
        this.shape = shape;
        this.g = g;
    }

    @Override
    public void run() {
        while (true) {
            try {
                Thread.sleep(THREAD_SLEEP);
                Graphics2D g2d = (Graphics2D) g;
                g2d.setColor(this.shape.getColor());
                g2d.fill(this.shape.getShape());
                System.out.println(String.format("execute thread: %s %s",
                        Thread.currentThread().getName(), this.getName()));
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        }
    }
} 
```

控制台将以下文本显示为输出

```
execute thread: red rectangle Thread-2
execute thread: yellow ellipse Thread-3 
```

我创建新线程的代码：

```
customShapes[0] = new CustomShape(
new Rectangle2D.Float(10, 10, 50, 50), Color.RED,
    "red rectangle");
customShapes[1] = new CustomShape(new Ellipse2D.Float(70, 70, 50, 50),
Color.YELLOW, "yellow ellipse");
for (CustomShape cshape: customShapes) {
    Thread t = new Thread(new DrawThread(cshape, this.getGraphics()),
    cshape.getName());
    threads.add(t);
    t.start();
} 
```

我的问题是：为什么`Thread.currentThread().getName()`返回正确的线程名称而`this.getName()`返回另一个？

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2013-01-06T22:21:57.407

> 为什么`Thread.currentThread().getName()`返回正确的线程名称而`this.getName()`返回其他名称？

您的`DrawThread`课程`extends Thread`，但随后您通过以下方式开始：

```
new Thread(new DrawThread(...)); 
```

这是不正确的。这意味着创建的*实际*线程 与`Thread`. 应该实现而*不是*扩展线程。它应该是：`DrawThread``DrawThread``Runnable`

 *```
public class DrawThread implements Runnable { 
```

您的代码有效，因为`Thread`它也是一个`Runnable`. 因为有两个线程对象，所以当您调用不是实际运行的线程`this.getName()`的对象时，它的名称没有正确设置。`DrawThread`仅设置了包装线程的名称。在`DrawThread`代码内部，您应该调用`Thread.currentThread().getName()`以获取正在运行的线程的真实名称。

最后，你的课应该是`DrawRunnable`if it `implements Runnable`。:-)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-01-06T22:22:06.923

您正在将您的实例传递`DrawThread`给`Thread(Runnable)`构造函数。它不在乎您的课程是否扩展`Thread`；它只关心它`implements Runnable`。

启动的线程是由 - 创建的线程，`new Thread(...)`您没有在该线程上设置名称。

一般来说，扩展`Thread`是不好的做法，应始终避免。您已经快到了，因为您没有`start`类的实例，而是将其传递给单独的`Thread`实例。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-06T22:22:43.273

涉及两个对象，包含 run 方法的 DrawThread 对象，以及使用它作为 Runnable 创建的新线程。

this.getName 获取未启动的 DrawThread 的名称。当前线程是您启动的线程。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-06-29T18:47:37.953

**简单的调用：**

```
new DrawThread().start(); 
```

开始新线程

```
DrawThread drawThread;              // declare object of class DrawThread 
drawThread = new DrawThread();      // instantiate object of class DrawThread
drawThread.start();                 // call start to start DrawThread 
```

（DrawThread 正在扩展 Thread 类）因此涉及：

```
 public synchronized void start() {
        checkNotStarted();

        hasBeenStarted = true;

        nativeCreate(this, stackSize, daemon);   // here Thread is created 
  } 
```

u call is ike **PUT THREAD INSIDE THREAD** (AS RUNNABLE) 通过调用：

```
public Thread(Runnable runnable) {
    create(null, runnable, null, 0);
} 
```*

# asp.net-mvc - MVC 和实体框架 - 如何从多个表/导航属性中选择列值

> ID：14187386
> 
> 赞同：0
> 
> 时间：2013-01-06T22:17:21.933
> 
> 标签：asp.net-mvc, entity-framework, linq-to-entities

我是使用 MVC 和 LINQ to Entity 的新手。我不知道如何从为每个表定义的导航属性的多个表中选择列值。

下面是表的结构：

表：MasterTable
字段：MasterID (PK)、CaseNumber、Status、[OtherFields....]
导航属性：DetailsTable、Clients

表：DetailsTable
字段：DetailsID (PK)、MasterID (FK)、InsuranceId (FK)、
DetailsS​​tatus 导航属性：MasterTable、Insurance

表：客户
字段：CustID (PK)、CustFName、CustFName、Address_id、Phone_id、MasterID (FK)
导航属性：订单、地址、电话

表：保险
字段：InsuranceId (PK)、InsuranceName、Address1、Address2、ZipCode、状态
导航属性：客户、详细信息表、地址

表：地址
字段：Address_id (PK)、Address1、Address2、ZipCode、State
导航属性：State

表：状态
字段：State_id (PK)、StateAbbrev
导航属性：国家

表：电话
字段：Phone_id (PK)、Home、Work、Mobile

我如何能够提取详细信息数据：
- MasterTable 中的 CaseNumber、Status
- InsuranceName、Address1、Address2、ZipCode、State 来自 Insurance 表（*基于 DetailsTable 中的 InsuranceId*）
- DetailsTable 中的 DetailsS​​tatus - CustFName、CustFName ,Address1, Address2, ZipCode, 来自客户表的状态（*基于 Customers.MasterID = MasterTable.MasterID *）

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T09:23:27.917

这只是投影，看起来像：

```
var query = from master in dbContext.MasterTables
            select {
                master.CaseNumber,
                master.Status,
                Details = master.DetailTables.Select(detail => new {
                    detail.DetailStatus,
                    detail.Insurance.InsuranceName, 
                    detail.Insurance.Address1,
                    detail.Insurance.Address2,
                    detail.Insurance.ZipCode,
                    detail.Insurance.State 
                },
                Customers = master.Clients.Select(customer => new {
                    customer.CustFName,
                    customer.CustLName,
                    customer.Address.Address1,
                    customer.Address.Address2,
                    customer.Address.ZipCode,
                    customer.Address.State
                }
            }; 
```

我不确定它是否正是您想要的，但它应该让您知道如何进行此类查询。此查询使用匿名类型进行投影，但您也可以使用自定义视图模型。

你也可以这样做：

```
var query = dbContext.MasterTables
                     .Include(m => m.Clients)
                     .Include(m => m.DetailsTables.Select(d => d.Insurance)); 
```

它会简单地加载所有相关客户、详细信息和保险的主数据。之后，您可以在代码中进行投影或直接在视图中使用实体。

它会

# twitter-bootstrap - Twitter 模态框何时不显示 包含模态是从无限滚动加载的

> ID：14187387
> 
> 赞同：0
> 
> 时间：2013-01-06T22:17:26.033
> 
> 标签：twitter-bootstrap, modal-dialog, infinite-scroll

我有无限滚动设置，因此当浏览器点击此代码时：

```
 <nav id='page-nav'>
            <a href='http://localhost:8888/plum/_pages/feeds_gen/feed2.php'></a>
    </nav> 
```

它将加载每个连续的 feed2.php，然后是 feed3.php，然后是 feed4.php 等，直到给定目录中没有更多的 feed?.php 文件。这是无限滚动javascript：

```
$container.infinitescroll({
          navSelector  : '#page-nav',    
          nextSelector : '#page-nav a', 
          itemSelector : '.item',
          animate      : false,
          loading: {
              msgText: '<i class="icon-th loadingicon"><p style="font-size:12px; font-family: Georgia,"Times New Roman",Times,serif;">loading...</p> </i>',
              finishedMsg: '<i class="icon-ok loadingicon"><p style="font-size:12px; font-family: Georgia,"Times New Roman",Times,serif;">loaded</p></i>',
              img: 'images/blank.png'
            }
          }, 
```

最后这里是 modal 的 html ：

```
 <div class='yo'> 
        <div id='article6e96d894690f0b8189684405c57840c0' class='modal hide fade in bigModal' style='display: none;'>  
            <div class='modal-header'>  
                <a class='close' data-dismiss='modal'>×</a>  
                <h3>New Tax Code Most Progressive Since 1979\. </h3>  
            </div>  
    <div class='modal-body'>   
        <p> 6 Jan 2013 | 9:00 pm CET</p>    
        Tax Code May Be the Most Progressive Since 1979<div readability="80"><p>Republicans resisted increasing tax rates and aimed for lower revenue targets, arguing that spending was the budget's prvere income-tax burden for people at a low level of income. It was actually kind of appalling," said Alan D. Viard, a tax expert at the American Enterprise Institute, a right-of-center research group in Washington. "Policy makers in both parties realized that was bad policy and started whittling away at it" by expanding credits and tinkering with tax rates.</p><p>After those changes and the new law, comparing average tax rates for poor households and wealthy households, 2013 might be the most progressive tax code since 1979\. But economists cautioned that measuring progressivity is tricky. "It's not like there is some scientific measure of progressivity all economists agreed upon," said Leonard E. Burman, a professor of public affairs at Syracuse University. "People look at different numerical measures and they've changed in different ways at different income levels."</p><p>Mr. Viard said that over time the code had become markedly rich, even if I'm getting taxed much more than a low-income person" would be, Mr. Williams of the Tax Policy Center added.</p></div><a href='http://t.co/m6inGvk6' class='btn btn-success'>Source</a>  
    <a href='#' class='btn' data-dismiss='modal'>Close</a>

    </div>  

</div> <!--END YO --> 
```

这是启动模态框的 HTML：

```
 <a data-toggle='modal' id='article_button2' href='#article6e96d894690f0b8189684405c57840c0' >New Tax Code Most Progressive Since 1979.</a> 
```

所以，基本上当你点击`<a data-toggle='modal' id='article_button2' href='#article6e96d894690f0b8189684405c57840c0' >New Tax Code Most Progressive Since 1979.</a>`

然后模态应该弹出。我遇到的问题是`<nav>`模式加载的任何页面都不会加载，但问题是 HTML 在所有 feed2.php feed3.php 等上的顺序都是正确的。

当无限滚动加载 feed2.php 时，是否有其他方法可以使模式出现？

提前感谢大家的耐心和帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T15:55:44.223

嘿，你可以试试

```
 <script>
jQuery(document).ready(function($){
$(".post").infinitescroll({

    loading: {
        img: "<?php echo get_template_directory_uri(); ?>/images/loading.gif",
    },
    "nextSelector":"#nav-below .nav-previous a",
    "navSelector":"#nav-below",
    "itemSelector":".post",
    "contentSelector":"#content"
}, function(newElements){ 
  //callback
$('[data-toggle="modal"]').on('click', function(event){
event.preventDefault()
    // update modal header with contents of button that invoked the modal
    $('#myModalLabel').html( $(this).html() );
    //fixes a bootstrap bug that prevents a modal from being reused
    $('#utility_body').html('<div class="loading"></div>').load(
        $(this).attr('href'),
        function(response, status, xhr) {
            if (status === 'error') {
                //console.log('got here');
                $('#utility_body').html('<p>Sorry, but there was an error:' + xhr.status + ' ' + xhr.statusText+ '</p>');
            }
            return this;
        }

    );
});
}
);
});
</script> 
```

我正在输入加载代码以在无限滚动时回调函数。希望我的答案对你来说没有过期:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-16T09:00:26.230

I Wayan Widyana 的另一个答案是一个很好的答案，它引导我解决我的问题，这或多或少与描述的相同。

基本上，在 Infinite Scroll 中的 jQuery 加载事件之后，Bootstrap 模态的 javascript 设置代码需要重新初始化。这是通过使用 Infinite Scrolls 的可选回调重新运行初始模式设置代码来完成的，该回调（显然）在成功加载新内容时被触发。

可以在此处找到有关此的更多信息：

[http://www.infinite-scroll.com/infinite-scroll-jquery-plugin/](http://www.infinite-scroll.com/infinite-scroll-jquery-plugin/)

# javascript - JQuery 滚动到下一个/上一个 div

> ID：14187388
> 
> 赞同：1
> 
> 时间：2013-01-06T22:17:43.660
> 
> 标签：javascript, jquery

任何想法为什么此代码（使用 scrollTo 插件）仅适用于 jquery-1.4.2.min.js 以及如何更改它以使其适用于最新版本的 JQuery？

[http://webdesignerwall.com/tutorials/scrollto-posts-with-jquery](http://webdesignerwall.com/tutorials/scrollto-posts-with-jquery)

谢谢 ：）

```
<script type="text/javascript" src="js/jquery-1.4.2.min.js"></script>
<script type="text/javascript" src="js/jquery.scrollTo-min.js"></script>
<script type="text/javascript">
$(function() {

function scroll(direction) {

    var scroll, i,
            positions = [],
            here = $(window).scrollTop(),
            collection = $('.post');

    collection.each(function() {
        positions.push(parseInt($(this).offset()['top'],10));
    });

    for(i = 0; i < positions.length; i++) {
        if (direction == 'next' && positions[i] > here) { scroll = collection.get(i); break; }
        if (direction == 'prev' && i > 0 && positions[i] >= here) { scroll = collection.get(i-1); break; }
    }

    if (scroll) {
        $.scrollTo(scroll, {
            duration: 750       
        });
    }

    return false;
}

$("#next,#prev").click(function() {        
    return scroll($(this).attr('id'));        
});

$(".scrolltoanchor").click(function() {
    $.scrollTo($($(this).attr("href")), {
        duration: 750
    });
    return false;
});

});
</script> 
```

编辑：

只是想让我的意图在反馈后稍微清楚一点..

我想使用最新版本的 JQuery 1.8.3，而不是 1.4.2。但是，当我使用 1.8.3 时，单击时带有 class="post" 的 scrollTo #next 或 #prev 似乎不起作用。当我使用 1.4.2 时，它确实如此。我愿意接受有关全新代码的建议，但是我今天必须至少尝试了 20 次，但没有一个成功。至少这是可行的......使用旧版本的 JQuery......这与我的新插件不兼容:(我是一个真正的新手。

基本上，当用户单击此处标题中的箭头时：http: [//thomasgrist.tumblr.com/](http://thomasgrist.tumblr.com/)他们应该在 Tumblr .post 中上下滚动

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T22:21:05.923

```
$('#container').animate({
     scrollTop: <value>
}, 500); 
```

你实际上并不需要那个插件。您可以使用上面的代码片段滚动到偏移量。

编辑：

假设您有一个带有以下标记的菜单：

```
<ul class="menu">
    <li><a href="#" data-for="section_2">Section 2</a></li>
    <li><a href="#" data-for="section_3">Section 3</a></li>
    <li class="last"><a href="#" data-for="section_4">Section 4</a></li>
</ul> 
```

...那么 Javascript 代码将如下所示：

```
$('.menu li a').click(function() {
    $('#container').animate({
        scrollTop: $('.' + $(this).data('for')).position().top + $('#container').scrollTop()
    }, 500);
    return false;
}); 
```

如果你真的在滚动，`body`那么就`$('#container')`变成了`$('html, body')`。它既是为了兼容 IE `html`，也是为了兼容。`body`

我没有使用`html`and`body`元素，因为在 iOS 5 上存在一些问题。因此，该问题的解决方法如下所示：

```
<body>
  <div id="container">
    rest of the page comes here
  </div>
</body> 
```

以及为此的CSS代码：

```
#container {
  position: absolute;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  overflow-y: auto;
} 
```

所以在你的情况下，我假设你有一些这样的标记：

```
<div id="container">
   <div class="post active"></div>
   <div class="post"></div>
   <div class="post"></div>
   <a id="next" href="#">Next</a>
</div> 
```

和一些JS：

```
$('#next').click(function() {
    $('#container').animate({
        scrollTop: $('.post.active').next().position().top + $('#container').scrollTop()
    }, 500);
    $('.post.active').removeClass('active').next().addClass('active');
    return false;
}); 
```

当然，您还需要窗口上的滚动事件侦听器来检查哪个帖子在视口中，以便您可以向其中添加“活动”类。

# assembly - NASM 为 dd 生成的程序集说明

> ID：14187390
> 
> 赞同：2
> 
> 时间：2013-01-06T22:17:52.067
> 
> 标签：assembly, nasm, cpu-registers

我一直在尝试使用 NASM 在 Linux 中进行汇编，以便我可以理解[OSDev 上的 loader.s 脚本](http://wiki.osdev.org/Bare_Bones)。

我发现有趣的一件事是使用 dd 声明变量时生成的程序集。我进行了一些测试，并将输出放在下面。本质上，我只是分配不同的数字并查看在目标文件（而不是可执行文件）中生成了哪些程序集。

```
$ cat test1.s
global _start

section .text
    dd 0x0

_start:
    mov eax, 1
    mov ebx, 0
    int 80h

$ nasm -f elf test1.s ; objdump -d test1.o

test1.o:     file format elf32-i386

Disassembly of section .text:

00000000 <_start-0x4>:
   0:   00 00                   add    %al,(%eax)
    ...

00000004 <_start>:
   4:   b8 01 00 00 00          mov    $0x1,%eax
   9:   bb 00 00 00 00          mov    $0x0,%ebx
   e:   cd 80                   int    $0x80 
```

.

```
$ cat test2.s
global _start

section .text
    dd 0x0
    dd 0x5

_start:
    mov eax, 1
    mov ebx, 0
    int 80h

$ nasm -f elf test2.s ; objdump -d test2.o

test2.o:     file format elf32-i386

Disassembly of section .text:

00000000 <_start-0x8>:
   0:   00 00                   add    %al,(%eax)
   2:   00 00                   add    %al,(%eax)
   4:   05 00 00 00 b8          add    $0xb8000000,%eax

00000008 <_start>:
   8:   b8 01 00 00 00          mov    $0x1,%eax
   d:   bb 00 00 00 00          mov    $0x0,%ebx
  12:   cd 80                   int    $0x80 
```

.

```
$ cat test3.s
global _start

section .text
    dd 0x0
    dd 0x5
    dd 0xf

_start:
    mov eax, 1
    mov ebx, 0
    int 80h

$ nasm -f elf test3.s ; objdump -d test3.o

test3.o:     file format elf32-i386

Disassembly of section .text:

00000000 <_start-0xc>:
   0:   00 00                   add    %al,(%eax)
   2:   00 00                   add    %al,(%eax)
   4:   05 00 00 00 0f          add    $0xf000000,%eax
   9:   00 00                   add    %al,(%eax)
    ...

0000000c <_start>:
   c:   b8 01 00 00 00          mov    $0x1,%eax
  11:   bb 00 00 00 00          mov    $0x0,%ebx
  16:   cd 80                   int    $0x80 
```

.

```
$ cat test4.s
global _start

section .text
    dd 0x0
    dd 0x5
    dd 0xf
    dd 0x16

_start:
    mov eax, 1
    mov ebx, 0
    int 80h

$ nasm -f elf test4.s ; objdump -d test4.o

test4.o:     file format elf32-i386

Disassembly of section .text:

00000000 <_start-0x10>:
   0:   00 00                   add    %al,(%eax)
   2:   00 00                   add    %al,(%eax)
   4:   05 00 00 00 0f          add    $0xf000000,%eax
   9:   00 00                   add    %al,(%eax)
   b:   00 16                   add    %dl,(%esi)
   d:   00 00                   add    %al,(%eax)
    ...

00000010 <_start>:
  10:   b8 01 00 00 00          mov    $0x1,%eax
  15:   bb 00 00 00 00          mov    $0x0,%ebx
  1a:   cd 80                   int    $0x80 
```

我的问题是为什么我们最初要向 eax 寄存器添加内容，然后随着数据的增长修改其他寄存器，如 edx 和 esi？分配该数据不应该使用寄存器，尤其不应该添加它们。为什么我永远看不到正确的变量被放入寄存器（第一个问题的答案可能会回答这个问题）？例如，我`add $0xb8000000,%eax`在分配 0x5 时看到了该指令，但该指令中没有 0x5。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-06T22:21:07.547

当你用 声明一个 DWORD 时`dd 0`，它实际上只是在输出二进制文件中放置 4 个字节的零。当您反汇编二进制文件时，它会将其解释为代码（当您打算将其作为数据时）。碰巧的操作码`add %al,(%eax)`是`00 00`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-19T00:32:05.083

您在 .text 部分中声明了这些变量，这就是发生这些添加的原因，要摆脱它，只需声明 .data 部分，这些额外的添加将不会发生。

# regex - Perl 正则表达式匹配 ? 的第一个实例 跨越多条线路

> ID：14187391
> 
> 赞同：2
> 
> 时间：2013-01-06T22:17:55.763
> 
> 标签：regex, perl, matching, multiline

我正在尝试使用正则表达式解析电子邮件回复。我的回复看起来像：

```
This is my response.
Some text here

?

?

From: Lastname, Firstname

Sent: Saturday, January 05, 2013 7:37 PM

To: Lastname, Firstname

Subject: Some Subject

?

Some Text 
```

我有兴趣将所有内容解析到第一个？我尝试过将单行模式与`$response =~ /^(.*)\?\n/s;`. 但这会让我回到最后？任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-06T22:31:32.507

`.*`是贪婪的。非贪婪版本`.*?`应该可以工作。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-06T22:34:30.337

到目前为止，最有效的方法是使用否定字符类：

```
 while ($response =~ / ( [^?]* \? ) /xg) { ... } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-06T22:32:10.977

您需要非贪婪模式`.*`：

```
$response =~ /^(.*?)\?\n/s 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-06T22:38:13.133

用不贪婪的表情来做这件事是不必要的。`?`您可以将所有文本与以via开头的第一行匹配

```
/^((?:(?!^\?).)*)/sm 
```

如果你只想匹配第一个`?`做它

```
/^([^?]*(?=\?))/s 
```

# java - Restlet 2.1.1 内部 HTTPS 连接器

> ID：14187399
> 
> 赞同：0
> 
> 时间：2013-01-06T22:19:06.743
> 
> 标签：java, ssl, https, restlet

我尝试从 restlet 2.0.15 更新到 2.1.1。我没有收到任何错误，我可以启动我的应用程序。使用默认的 restlet 连接器，但是当我尝试通过 https:/url:port/ 访问我的 ssl 安全内容时，我总是会超时并且绝对没有日志。HTTP 连接器工作正常。

我也尝试使用简单的框架，但是restlet只在简单的HTTP连接器上启动，而https仍然在内部？

这是我当前的配置：

```
this.componentHTTPS = new Component();
this.componentHTTP = new Component();

Server serverHTTPS = new Server(Protocol.HTTPS, this.sslPort);
Server serverHTTP = new Server(Protocol.HTTP, this.port);
    serverHTTPS.setContext(this.componentHTTPS.getContext().createChildContext());

Router routerHTTP = new Router(serverHTTP.getContext());
String redirectTarget = this.sslURI + ":" + this.sslPort;
Redirector redirector = new Redirector(serverHTTP.getContext(),
            redirectTarget, Redirector.MODE_CLIENT_PERMANENT);
Extractor extractor = new Extractor(serverHTTP.getContext(), redirector);

extractor.extractFromQuery("", "", false);
routerHTTP.attach("/", extractor);
componentHTTP.getServers().add(serverHTTP);
componentHTTPS.getServers().add(serverHTTPS);

Series<Parameter> parametersHTTPS = serverHTTPS.getContext().getParameters();

// increase maximumSeries<Parameter>ds (RESTlet default is 10)
parametersHTTPS.add("maxThreads", this.maxThreads);
parametersHTTPS.add("sslContextFactory","org.restlet.ext.ssl.PkixSslContextFactory");
parametersHTTPS.add("keystorePath", this.keystorePath);
parametersHTTPS.add("keystorePassword", this.keystorePassword);
parametersHTTPS.add("keystoreType", this.keystoreType);
parametersHTTPS.add("keyPassword", this.keyPassword);
parametersHTTPS.add("needClientAuthentication", "false");

componentHTTPS.getDefaultHost().attach("/", webApplication);

// Start the http redirect component
componentHTTP.getDefaultHost().attach("/",
            new RedirectApplication(redirectTarget));

this.componentHTTPS.start();
this.componentHTTP.start(); 
```

其他人有这个问题或知道解决方案吗？在之前的 restlet 2.0.* 版本中，我们的代码运行良好。

问候

# ruby - RVM 正在尝试使用错误的 Ruby 版本

> ID：14187404
> 
> 赞同：1
> 
> 时间：2013-01-06T22:19:51.757
> 
> 标签：ruby, rvm, rvmrc

我已经安装了 Ruby 1.9.3-p327 并且可以使用它，并且我的 .rvmrc 文件包含以下内容：

`rvm use ruby-1.9.3`

但是当我进入项目目录时，出现错误：

> 未安装 ruby​​-1.9.3-p362。
> 
> 要安装：'rvm install ruby​​-1.9.3-p362'`

为什么会发生？我不想使用 p362，我需要 p327，我已经安装了它！

也许是因为我之前安装了 p362 并以某种方式错误地删除了它？我用过`rvm remove 1.9.3-p362`。提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T22:31:04.137

当前的 RVM 考虑`Ruby 1.9.3`和`Ruby 1.9.3-p362`等效。RVM 的未来版本将采用另一个值。它假定您的意思是它已知的用于潜在安装的最新/最高编号修订，这不是基于安装的内容。您可以通过当前`rvm install 1.9.3`安装的方式对此进行测试`1.9.3-p362`。

而是尝试`Ruby 1.9.3-p327`在您的`.rvmrc`文件中使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T22:22:35.677

也许您正在访问的文件夹中有一个“.rvmrc”文件，因此 rvm 将自动加载指定的版本。

只需删除该 .rvmrc 文件或更改该文件以匹配您安装的 rvm ruby​​ 版本

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-06T22:31:51.727

运行“rvm list”以查看 RVM 知道的 Ruby 安装列表。RVM 很可能会从意想不到的人那里获取配置。此外，不要忘记查看“rvm debug”的输出，这将 100% 准确地告诉您 RVM 的 Ruby 安装位置。

祝你好运。

# common-lisp - Common Lisp 函数返回错误的值

> ID：14187406
> 
> 赞同：0
> 
> 时间：2013-01-06T22:20:20.537
> 
> 标签：common-lisp

我正在尝试项目 euler 问题来学习常见的 lisp，但我很早就被困住了。关于问题 1，问题是从 1 到 1000 的整数之和。我认为下面的代码应该这样做，但它总是返回值`end`（如果是 mod 3 或 mod 5）或 0。

```
(defun mod3or5 (n)                                                                 
  (cond                                                                            
    ((equal (mod n 5) 0) n)                                                        
    ((equal (mod n 3) 0) n)                                                        
    (0))))                                                                         

(defun mod-sum (start end)                                                         
  (cond                                                                            
    ((equal start end) (mod3or5 start))                                            
    (+ (mod3or5 start) (mod-sum (+ start 1) end)))) 
```

例如

```
(mod-sum 1 9)
=> 9
(mod-sum 1 8)
=> 0 
```

我希望答案分别是 23 和 14。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-06T22:26:43.483

给定的每个表格`cond`都有表格`(condition exp1 ... expn)`。如果`condition`为真，它将评估所有表达式并返回 的值`expn`。如果`condition`为假，它将继续下一个表格。

你的最后一个表格是这样的：`(+ (mod3or5 start) (mod-sum (+ start 1) end))`。所以这里`+`是条件（它总是为真，因为`+`它是一个函数，因此不是`nil`），`(mod3or5 start)`是第一个表达式（将被评估，但不返回），`(mod-sum (+ start 1) end)`是最后一个表达式（将被评估然后返回）。

中的“其他分支”`cond`是通过选择`t`作为条件来实现的。所以你的最后一个表格应该是这样的：

```
(t (+ (mod3or5 start) (mod-sum (+ start 1) end))) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T23:11:00.567

我之前发布过这个，但它是在Scheme中，所以我决定稍微重写一下，`loop`用于更改：

```
(defun euler-1 ()
  (loop with x = (list 3 2 1 3 1 2 3)
     for i in (nconc x x)
     while (< (+ steps i) 1000)
     summing i into steps
     summing steps into result
     finally (return result))) 
```

这就是你可以做到的方式，避免取模（因为它很昂贵）。您还将平均步 2 个数字（跳过那些您不必添加的数字）。

# r - 计算 R 中加权离散随机变量的均值和方差

> ID：14187408
> 
> 赞同：0
> 
> 时间：2013-01-06T22:20:42.740
> 
> 标签：r, weighted, weighted-average

我有以下数据框：

```
dat <- read.table(text="  X prob
1 1  0.1
2 2  0.2
3 3  0.4
4 4  0.3", header=TRUE) 
```

是否有任何内置函数或优雅的方法来计算 R 中离散随机变量的均值和方差？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T22:39:42.573

基础 R 中有一个`weighted.mean`函数，而 Hmisc 包有一堆 wtd.* 函数。

```
> with(dat, weighted.mean(X, prob))
[1] 2.9

require(Hmisc)
>  wtd.var(x=dat$X, weights=dat$prob)
[1] Inf
# Huh ?  On investigation the weights argument is suppsed to be replicate weights
# So it's more appropriate to use normwt=TRUE
> wtd.var(x=dat$X, weights=dat$prob, normwt=TRUE)
[1] 1.186667 
```

Thomas Lumley 的调查包提供的内容远不止这个简单的示例所示。它具有为各种统计建模程序处理复杂加权方案的机制：

```
require(survey)
> dclus1<-svydesign(id=~1, weights=~prob, data=dat)
>   v<-svyvar(~X, dclus1)
> v
  variance     SE
X   1.1867 0.7011 
```

这些是样本统计数据，而不是为抽象随机变量计算的方差。这个结果似乎确实适用于统计系统，但可能不是概率作业问题的正确答案。

# haskell - 小代码片段导致 ghc 不终止

> ID：14187413
> 
> 赞同：9
> 
> 时间：2013-01-06T22:20:57.910
> 
> 标签：haskell, ghc

这个小的[haskell 代码片段](http://hpaste.org/80395)导致 ghc 在编译期间不会终止：

```
{-# LANGUAGE BangPatterns #-}
{-# OPTIONS_GHC -O2 #-}

import qualified Data.Vector.Unboxed.Mutable as MV
import Data.Vector.Unboxed ((!))
import qualified Data.Vector.Unboxed as V
import Control.Monad (forM_)

similar :: V.Vector Char -> Int
similar v = l + sum (map (similar' 1 1) checks)
  where
    (l,checks) = let h = V.head v in V.foldl'  
        (\(i,is) c -> if c == h then (i+1,i:is) else (i+1,is)) (1,[]) (V.tail v)
    similar' !r !n !i = if i < l-1 && v!(n) == v!(i+1) then similar' (r+1) (n+1) (i+1)
        else r

main :: IO ()
main = do
    n <- getLine
    v <- MV.replicate (read n) 0
    forM_ [1..read n] $ \n' -> do
      v' <- getLine
      MV.unsafeWrite v (n'-1) (similar . V.fromList $ v')
    V.unsafeFreeze v >>= V.mapM_ print 
```

我尝试了 ghc 7.4.1 和 7.6.1 并且都没有终止。当我使用`ByteString`s 而不是`Vector`s 时，代码运行良好。这是 ghc 问题还是库问题？还是我的代码中某处有问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-06T23:00:01.497

这似乎是一个 GHC 问题。

编译通过使用vector-0.10.0.1的ghc-7.0.2和使用vector-0.7.0.1的ghc-7.0.4，并使用带有vector-0.7.1的ghc-7.2.1，使用ghc-7.2.2挂起vector-0.9、ghc-7.4.1 与 vector-0.9.1、ghc-7.4.2 与 vector-0.9.1 和 ghc-7.6.1 与 vector-0.9.1 和 vector-0.10.0.1。

编译挂在`SpecConstr`pass 中，`vector`包**大量**使用了它。我要开一张[票](http://hackage.haskell.org/trac/ghc/ticket/7555)。好吧，[有人更快](http://hackage.haskell.org/trac/ghc/ticket/7553)。

# ios - 它是否记录了数组“instantiateWithOwner”返回的任何地方以特定方式排序？

> ID：14187419
> 
> 赞同：6
> 
> 时间：2013-01-06T22:21:27.357
> 
> 标签：ios, cocoa-touch, interface-builder

我最近看到了一些用于`instantiateWithOwner`以`UITableView`这种方式加载单元格的代码示例：

`cell = [nib instantiateWithOwner:self options:nil][0];`

虽然它比将属性出口作为原型单元更清洁、更紧凑，但我想知道是否可以保证（也记录在案）接口构建器中的第一个顶级对象将始终是`instantiateWithOwner`. 在这一点上可能是这种情况，但如果没有记录（未定义），它可能会在未来发生变化，从而给具有多个顶级对象并像这样实例化单元格的 nib 带来麻烦。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T17:34:11.457

我找不到任何记录返回的数组顺序的地方`instantiateWithOwner`，但文档*确实*谈到[了 nib 加载代码调用 awakeFromNib 的顺序](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/LoadingResources/CocoaNibs/CocoaNibs.html)：

> `awakeFromNib`无法保证 nib 加载代码调用对象方法的顺序。

我的假设是，这意味着返回的数组的顺序`instantiateWithOwner`也不能保证。为了*保证*从 xib 中拉出多个对象时的顺序，我通常首先通过接口构建器为每个对象的标签配置一个唯一（升序）编号。然后，您的代码将如下所示：

```
NSArray *cells = [[nib instantiateWithOwner:self options:nil] sortedArrayUsingDescriptors:@[[NSSortDescriptor sortDescriptorWithKey:@"tag" ascending:YES]]];
cell = cells[0]; 
```

# php - 使用 PHP cURL 将文件上传到远程服务器

> ID：14187420
> 
> 赞同：0
> 
> 时间：2013-01-06T22:21:27.397
> 
> 标签：php, post

我想将文件从一个网站传输到这个网站 gulfup.com 使用`POST`

我的代码（它包含没有上传文件的问题）：

```
<?php

$the_file = "http://downloads.wordpress.org/plugin/wp-super-cache.1.2.zip";

$ch = curl_init();
curl_setopt($ch, CURLOPT_HEADER, 0);
curl_setopt($ch, CURLOPT_VERBOSE, 0);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_HTTPHEADER, array("Content-type: multipart/form-data"));
curl_setopt($ch, CURLOPT_USERAGENT, "Mozilla/5.0 (X11; Linux i686; rv:6.0) Gecko/20100101 Firefox/6.0Mozilla/4.0 (compatible;)");
curl_setopt($ch, CURLOPT_URL, 'http://www.gulfup.com/index.php');
curl_setopt($ch, CURLOPT_POST, true);
$post = array(
    'file_1_' => "$the_file"
);
curl_setopt($ch, CURLOPT_POSTFIELDS, $post);
$response = curl_exec($ch);
if(curl_errno($ch)) {
    echo 'Error: ' . curl_error($ch);
}
else {
    echo $response;
}

?> 
```

从电脑上传的网站代码：

```
<form id="uploader" name="uploader" action="http://www.gulfup.com/index.php" method="post" enctype="multipart/form-data" onsubmit="form_submit();">
<div class="uploadfile"><input name="file_1_" id="file_1_" size="70" type="file"></div>
<br id="br_1_">
<div class="uploadfile"><input name="file_2_" id="file_2_" size="70" type="file"></div>
<br id="br_2_">
<div class="uploadfile"><input name="file_3_" id="file_3_" size="70" type="file"></div>
<br id="br_3_">
<div class="uploadfile"><input name="file_4_" id="file_4_" size="70" type="file"></div>
<br id="br_4_">
<div class="uploadfile"><input name="file_5_" id="file_5_" size="70" type="file"></div>
<br id="br_5_">
<div class="uploadfile"><input name="file_6_" id="file_6_" size="70" type="file"></div>
<br id="br_6_">
<div class="uploadfile"><input name="file_7_" id="file_7_" size="70" type="file"></div>
<br id="br_7_">
<div class="uploadfile"><input name="file_8_" id="file_8_" size="70" type="file"></div>
<br id="br_8_">
<div class="uploadfile"><input name="file_9_" id="file_9_" size="70" type="file"></div>
<br id="br_9_">
<div class="uploadfile"><input name="file_10_" id="file_10_" size="70" type="file"></div>
<br id="br_10_">
<br>

<span class="bn_up"><button type="submit" name="submitr" class="btn" id="submitr"><span>Upload</span></button></span>

<div class="clr"></div>
</form> 
```

我的代码有什么问题？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-07T02:24:08.213

尝试编辑第一行

```
$the_file = "http://downloads.wordpress.org/plugin/wp-super-cache.1.2.zip"; 
```

至

```
$the_file = fetch_remote_file("http://downloads.wordpress.org/plugin/wp-super-cache.1.2.zip"); 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-06T22:29:53.940

好像[http://dtbaker.com.au/random-bits/uploading-a-file-using-curl-in-php.html](http://dtbaker.com.au/random-bits/uploading-a-file-using-curl-in-php.html)你忘记了 post 数组中的 @ （at 字符）

# qt - 选中 Qt WebKit 句柄复选框

> ID：14187422
> 
> 赞同：0
> 
> 时间：2013-01-06T22:21:32.383
> 
> 标签：qt, checkbox, qtwebkit, qwebview, qwebpage

我需要处理 QWebView (QWebPage) 中复选框的选中状态。

**更多细节：**

HTML中有一些复选框。我们希望在检查其中一些时对应用程序进行更改。为此，我们需要知道它何时发生了变化。

怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T00:46:12.813

这是不容易的。这是一个解决方法，它不完美但足够实用。

创建 的子类`QObject`，例如`Notifier`。这将是您从网络世界到原生世界的**桥梁。**如果选中复选框，则无论您想要实现什么更改都应该直接放在此处，或者您可以通过信号/插槽机制将其进一步转发到链中。

[使用addToJavaScriptWindowObject](http://doc.qt.digia.com/qt/qwebframe.html#addToJavaScriptWindowObject)将此对象的实例`Notifier`注入您的网页。它将附加到全局对象。现在，使用 DOM 的[addEventListener](http://docs.webplatform.org/wiki/dom/methods/addEventListener)为复选框添加一个新的侦听器，侦听器除了调用桥的回调之外什么都不做，例如. [可以通过使用evaluateJavaScript](http://doc.qt.digia.com/qt/qwebframe.html#evaluateJavaScript)执行一小段 JavaScript 代码来执行此侦听器调整。`window``window.notifier.doSomething()`

这个技巧之所以奏效，是因为[QtWebKit 内部桥接](http://doc.qt.digia.com/qt/qtwebkit-bridge.html)器理解一个 QObject 实例（尽管是自省的）并使其属性和插槽可从 JavaScript 世界访问。

# maven - Maven，archetype:generate，是否有任何用于此的 GUI 工具？

> ID：14187423
> 
> 赞同：3
> 
> 时间：2013-01-06T22:21:35.527
> 
> 标签：maven

当我启动**mvn archetype:generate**时，为了生成一个骨架项目，搜索那庞大的数字和名称列表真的很烦人。是否有任何 GUI 工具可以做到这一点？我真的很想要一个 GUI 工具，其中“原型：生成”项目类型被很好地分组和排序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-03T20:11:38.590

[eclipse](http://www.eclipse.org/) with [m2e](http://eclipse.org/m2e/)提供了一个带有 Archetype 选择的“New Maven Project”向导。

![在此处输入图像描述](../Images/0ce019feffcf69b56f982ed73c4616a0.png)

我想其他带有 Maven 集成的 IDE 将提供类似的功能。

# ruby-on-rails - 轮胎和排序搜索的问题

> ID：14187432
> 
> 赞同：0
> 
> 时间：2013-01-06T22:22:16.673
> 
> 标签：ruby-on-rails, elasticsearch, tire

我正在尝试使用轮胎宝石进行排序搜索，但我总是收到此错误：

解析失败 [未找到 [职业] 的映射以便排序]]

我的代码有什么问题？以下是我的用户模型

```
class User
  include Mongoid::Document
  include Mongoid::Timestamps
  include Tire::Model::Search
  include Tire::Model::Callbacks

  belongs_to :occupation

  field :name, :type => String, :default => ""
  field :email, :type => String, :default => ""
  field :kind, :type => String, :default => ""

  def to_indexed_json
    { id: id,
      name: name,
      email: email,
      kind: kind,
      occupation: occupation.try(:name),
      created_at: created_at,
      updated_at: updated_at
    }.to_json
  end

  mapping do
    indexes :id, :type => 'integer'
    indexes :name, :type => 'String'
    indexes :email, :type => 'String'
    indexes :kind, :type => 'String'
    indexes :occupation, :type => 'String'
    indexes :created_at, :type => 'Date'
    indexes :updated_at, :type => 'Date'
  end

  def self.search q, params={}
    tire.search page: (params[:page] || 1)  do |search|
      search.query do |query|
        query.string q
      end
      search.sort do |sort|
        sort_column = params[:sort] || 'occupation'
        sort_direction = params[:direction] || 'asc'
        sort.by(sort_column.to_sym, sort_direction)
      end
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T08:05:42.480

你能试试这个吗？我猜您是在 to_indexed_json 中发送职业名称，并且您正在尝试对整个职业模型进行排序。

```
class User
  include Mongoid::Document
  include Mongoid::Timestamps
  include Tire::Model::Search
  include Tire::Model::Callbacks

  belongs_to :occupation

  field :name, :type => String, :default => ""
  field :email, :type => String, :default => ""
  field :kind, :type => String, :default => ""

  def to_indexed_json
    { id: id,
      name: name,
      email: email,
      kind: kind,
      occupation: occupation.try(:name),
      created_at: created_at,
      updated_at: updated_at
    }.to_json
  end

  mapping do
    indexes :id, :type => 'integer'
    indexes :name, :type => 'String'
    indexes :email, :type => 'String'
    indexes :kind, :type => 'String'
    indexes :occupation, :type => 'object' do
        indexes :name, :type => 'String'
    end
    indexes :created_at, :type => 'Date'
    indexes :updated_at, :type => 'Date'
  end

  def self.search q, params={}
    tire.search page: (params[:page] || 1)  do |search|
      search.query do |query|
        query.string q
      end
      search.sort do |sort|
        sort_column = params[:sort] || 'occupation.name'
        sort_direction = params[:direction] || 'asc'
        sort.by(sort_column, sort_direction)
      end
    end
  end
end 
```

# javascript - jQuery 给背景滚动更慢的印象

> ID：14187434
> 
> 赞同：3
> 
> 时间：2013-01-06T22:22:25.693
> 
> 标签：javascript, jquery, css, scroll

我有以下代码，它只是为了给人一种 div 滚动比另一个慢的印象，但是背景 div 在滚动时有点摇晃。

任何想法为什么会发生这种情况以及我如何能够解决它？

**编辑：这在所有浏览器中似乎都不是问题，所以我想我现在正在寻找一种更安全的方法来实现这种效果......**

[http://jsfiddle.net/KRv5V/](http://jsfiddle.net/KRv5V/)

```
<head>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>

<script type="text/javascript">
$(document).ready( function() {
    $(window).scroll(function() {
      var scrollTop = $(window).scrollTop();
      var divam = 1.2;
      $(".sky").css({
          "top":scrollTop/divam+"px",
          "height":10000-(Math.round(scrollTop/divam))+"px"
      });
    });
});
</script>

<style type="text/css">
.sky {
    height:10000px; 
    width:100%; 
    position:absolute; 
    top:0px; 
    left:0px; 
    background-image:url(http://library.thinkquest.org/06aug/02339/clouds45.jpg); 
    z-index:1;
}

.red {
    height:10000px; 
    width:50%; 
    position:absolute; 
    top:0px; 
    right:25%; 
    background-image:url(http://www.charting-sustainability.org/writings/culture/red/red-pirate.jpg); 
    z-index:2; 
    background-position:center;
}
</style>

</head>

<body>

<div class="sky"></div>
<div class="red"></div>

</body> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-09T10:38:35.873

我自己对此进行了一些更改并使其运行更顺畅，因为我真的不需要 Oliver Cooper 指导我的插件中的所有功能，尽管该插件可能是为未来留出更多空间的更好选择适应。

这是我改进的代码。

```
<head>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>

<script type="text/javascript">
$(document).ready( function() {
    $(window).scroll(function() {
        var scrollTop = $(window).scrollTop();
        var divam = 20;
        $("body").css({
            "background-position":"0px -"+scrollTop/divam+"px"     
        });
        $(".red").css({
            "margin-top":"-"+scrollTop+"px"
        });
    });
});
</script>

<style type="text/css">
    body {
        background-image:url(http://library.thinkquest.org/06aug/02339/clouds45.jpg);
        background-attachment: fixed;
        height:21000px;
    }

    .red {
        height:10000px; 
        width:50%; 
        position:fixed;
        top:400px;
        left:25%;
        background-image:url(http://www.charting-sustainability.org/writings/culture/red/red-pirate.jpg); 
        background-position:center;
        border-bottom:10px solid #000;
    }
</style>

</head>

<body>

    <div class="sky"></div>
    <div class="red"></div>

</body> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-06T22:40:59.213

您正在尝试实现“视差滚动”效果。我建议您查看一些文章，例如[本教程](http://webdesign.tutsplus.com/tutorials/complete-websites/create-a-parallax-scrolling-website-using-stellar-js/)和[本文档](http://markdalgleish.com/projects/stellar.js/docs/)。如果您需要更多帮助，请询问，我已经用这种设计制作了一些网站。

# javascript - 显示没有标记或 DOM 更改的消息

> ID：14187439
> 
> 赞同：0
> 
> 时间：2013-01-06T22:22:52.610
> 
> 标签：javascript, html, spring, grails, internationalization

我正在阅读 Grails in Action 一书，并了解域类中的部分约束以引入验证。

当我转到由 Grails 生成的“创建”表单时，我只是单击了“创建”按钮，而没有输入任何提示“请填写此字段”消息的数据。

我查看了 FireBug 和 Chrome 开发者工具中的标记，发现了一些有趣的东西：没有明确的脚本标记（除了底部的一个用于淡入/淡出动画的标记）。同样，当显示消息时，firebug 不会显示对 dom 或 html 标记的更改。

文档说消息是通过 Spring 的 i18n 支持显示的……但我的问题是：这到底是如何完成的。我研究了标题和​​ HTML 标记，但我没有看到任何会提示消息通过 Javascript 或 HTML 显示的内容。

这种事情是如何在网页中完成的？

（澄清：Grails 2.2，Firefox 中的 Firebug，Chrome 中的开发者工具。即：两个不同的浏览器显示相同的消息）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T23:27:00.117

Grails 2.0+ 中的新模板使用 HTML5，因此尽可能使用客户端验证来避免服务器往返。我认为它只适用于空白：假。

您将看到用于自定义验证的 Grails 验证消息，以及没有 HTML5 模拟的标准验证。

# c++ - QListWidget 不允许图标大小大于 200

> ID：14187441
> 
> 赞同：1
> 
> 时间：2013-01-06T22:22:59.183
> 
> 标签：c++, qt, qt5

`QListWidget::setIconSize`尺寸 > 200x200 似乎没有任何效果。是有意的，还是我做错了什么？文档中没有提到这种上限。是否存在限制图标大小的另一个属性？

我正在使用 Qt 5。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-07T14:38:22.017

您的源图像似乎具有您所遇到的图标大小限制。`QListWidget`不会绘制大于源图像的图标。

您应该使用更大的源图像。

# java - Adb.exe（Android 调试桥）无法安装 .apk

> ID：14187444
> 
> 赞同：1
> 
> 时间：2013-01-06T22:23:08.467
> 
> 标签：java, android, emulation, adb

每当我使用 adb 在我的模拟器或设备上安装 Android 应用程序时，它都会显示“无法在设备超时时安装*** .apk。

我尝试了相同问题中提供的所有解决方案：

*   我将 ADB 连接超时从 5000 --> 60000
*   我重新启动了亚行
*   我重新启动了电脑。

但是，这些方法似乎都不起作用。我在 Windows Vista 32 位上运行 ADB。是 Windows Vista 的问题吗？在我的 Windows 7 计算机上运行时，ADB 可以安装 apk。我不能使用 Windows 7 的唯一原因是它的处理器太慢（模拟器以 2 fps 运行）

顺便说一句，当我在命令行中使用“adb devices”命令时，ADB 似乎识别出了我的手机或模拟器。由于某种原因，它无法安装 .apk 或推送或拉取文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T22:45:37.900

这是我以前经历过的。当我使用通用 USB 电缆或未正确插入时，它往往会发生（对我而言）。确实有很多事情可能是错误的。例如，您可能需要重新启动设备，您可能需要尝试不同的 USB 端口。这类事情没有明确的解决方案。

# php - joomla 编程

> ID：14187448
> 
> 赞同：0
> 
> 时间：2013-01-06T22:24:15.880
> 
> 标签：php, joomla

我是 joomla 编程的新手。我正在修改一个已经编写好的模板，它是一个基本版本。我想为我网站中的每个项目启用评论选项并将它们存储在我的数据库中，并在我的网站的侧面板上显示我的数据库中最近的 10 条评论。（如 facebook 中的用户活动）。是否有任何扩展能够做到这一点？

有人可以指导我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T22:27:06.117

我建议使用[K2](http://getk2.org)，它是一个非常扩展的文章管理器，并且包括一个评论系统。

如果您不想使用完全独立的文章管理器，那么您始终可以安装与标准 Joomla 文章集成的[JComments等组件。](http://extensions.joomla.org/extensions/contacts-and-feedback/articles-comments/9985)

将来，请务必查看[JED](http://extensions.joomla.org)，它是 Joomla 扩展的目录，包括商业和非商业。我相信总会有适合您需求的东西;）

# windows - Win64异常堆栈行走不显示条目

> ID：14187450
> 
> 赞同：5
> 
> 时间：2013-01-06T22:25:13.610
> 
> 标签：windows, delphi, winapi

在阅读 Win64 结构化异常跟踪（来自[针对 x64 异常处理支持编程，第 7 部分：将它们放在一起，或构建堆栈遍历例程](http://www.nynaeve.net/?p=113)）时，我转换了代码[StackWalk64.cpp](http://www.nynaeve.net/Code/StackWalk64.cpp)。

```
procedure DumpExceptionStack();
var
  LContext : CONTEXT;
  LUnwindHistoryTable : _UNWIND_HISTORY_TABLE;
  LRuntimeFunction : Pointer;
  LImageBase : ULONGLONG;
    HandlerData : Pointer;
    EstablisherFrame : ULONG64;
    NvContext : KNONVOLATILE_CONTEXT_POINTERS;

  LLineNumber                    : integer;
  LModuleName                    : UnicodeString;
  LPublicAddr                    : pointer;
  LPublicName                    : UnicodeString;
  LUnitName                      : UnicodeString;
begin
    //
    // First, we'll get the caller's context.
    //
  RtlCaptureContext(LContext);

    //
    // Initialize the (optional) unwind history table.
    //
  LUnwindHistoryTable := Default(_UNWIND_HISTORY_TABLE);

  // LUnwindHistoryTable.Unwind := True;

    //
    // This unwind loop intentionally skips the first call frame, as it shall
    // correspond to the call to StackTrace64, which we aren't interested in.
    //
  repeat
        //
        // Try to look up unwind metadata for the current function.
        //
        LRuntimeFunction := RtlLookupFunctionEntry(LContext.Rip,
                                               LImageBase,
                                               LUnwindHistoryTable);

    NvContext := Default(KNONVOLATILE_CONTEXT_POINTERS);

    if not Assigned(LRuntimeFunction) then
    begin
            //
            // If we don't have a RUNTIME_FUNCTION, then we've encountered
            // a leaf function.  Adjust the stack approprately.
            //

      //LContext.Rip  := (ULONG64)(*(PULONG64)Context.Rsp);
      LContext.Rip  := ULONG64(Pointer(LContext.Rsp)^);
            LContext.Rsp := LContext.Rsp + 8;
    end
    else
    begin
            //
            // Otherwise, call upon RtlVirtualUnwind to execute the unwind for
            // us.
            //
            RtlVirtualUnwind(UNW_FLAG_NHANDLER,
                       LImageBase,
                       LContext.Rip,
                       LRuntimeFunction,
                       LContext,
                       HandlerData,
                       EstablisherFrame,
                       NvContext);
    end;

        //
        // If we reach an RIP of zero, this means that we've walked off the end
        // of the call stack and are done.
        //
    if LContext.Rip = 0 then
      Break;

        //
        // Display the context.  Note that we don't bother showing the XMM
        // context, although we have the nonvolatile portion of it.
        //
    if madMapFile.GetMapFileInfos(Pointer(LContext.Rip),
                                  LModuleName,
                                  LUnitName,
                                  LPublicName,
                                  LPublicAddr,
                                  LLineNumber) then
    begin
      Writeln(Format('%p %s.%s %d', [Pointer(LContext.Rip), LUnitName, LPublicName, LLineNumber{, LSEHType}]));
    end;
  until LContext.Rip = 0;
end; 
```

然后我用以下方式调用它：

```
procedure Main();
begin
  try
    try
      try
        try
          DumpExceptionStack();
        finally
          //
        end;
      except
        on E : Exception do
         raise
      end;
    except
      on E : Exception do
       raise
    end;
  except
    on E : Exception do
     raise
  end;
end; 
```

当我运行应用程序（只是一个控制台应用程序）时，我只得到一个条目，`Main`但我预计会有四个（三个嵌套异常，最后一个）。

难道是我误解了，`DumpExceptionStack`只会在抛出异常时给出我感兴趣的结果？如果是这样，获取所有异常堆栈（如果可能的话）所需的更改是什么 - 即。有四个输出`Main`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-06T22:56:52.360

x64 异常模型是基于表的，与基于堆栈的 x86 模型不同。这意味着异常堆栈不存在。无论如何，我从未见过尝试包含异常和 finally 块的 stalk walk 例程。这个没什么不同。它遍历函数调用堆栈。

单个函数中的异常流由范围表控制。在您的函数中，如果您的代码在调用点引发异常`DumpExceptionStack`，则多个范围表条目与异常位置匹配。异常由最里面的匹配范围处理。范围的开始地址和结束地址之间的距离可以用来推断哪个范围是最里面的。如果该最内层范围不处理异常或重新引发异常，则要求下一个最内层范围处理它。依此类推，直到函数的所有匹配范围都用完为止。

# jquery - 选择隐藏同级的表行

> ID：14187456
> 
> 赞同：0
> 
> 时间：2013-01-06T22:25:49.907
> 
> 标签：jquery

我有一个具有以下结构的 html 表：

```
<table>
<tbody>
  <tr><th>heading1</th></tr>
  <tr style="display: none"> <td>data1</td></tr>
  <tr style="display: none"> <td>data1</td></tr>
</tbody>

<tbody>
  <tr><th>heading2</th></tr>
  <tr> <td>data1</td></tr>
  <tr style="display: none"> <td>data1</td></tr>
</tbody>
</table> 
```

我正在寻找一种方法来选择该表中包含标题的行，但其所有兄弟姐妹都被隐藏，在此示例中，标题2 不会被选中，因为只有一行被隐藏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T22:32:53.277

我认为这应该这样做：

```
$("th").filter(function(){
    return !$(this).parent().nextAll().is(":visible");
}); 
```

[http://jsfiddle.net/4fpgs/](http://jsfiddle.net/4fpgs/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T22:33:40.807

```
var tr = $('tr:first-child').filter(function() {
  return $(this).siblings(':hidden').length == $(this).siblings().length;
}); 
```

示例：http: [//jsfiddle.net/u6Qj5/1/](http://jsfiddle.net/u6Qj5/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-06T22:30:00.447

```
$('table th').filter(function() {
  var $tr = $(this).parent().siblings('tr');
  return $tr.filter(':hidden').length == $tr.length;
}).parent(); 
```

# c# - 读取 POST 请求 XML - 布尔值始终读取为 false

> ID：14187461
> 
> 赞同：2
> 
> 时间：2013-01-06T22:26:39.177
> 
> 标签：c#, xml, wcf, boolean

我正在开发托管在 IIS 中的 WCF RESTful Web 服务。我目前正在处理一个相当简单的发布请求，将以下 XML 发送到端点：

```
<StockListRequestData xmlns="http://myWebService.com/endpoint">
<UserID>2750</UserID>
<StockDatabase>stockLeekRoadVenue</StockDatabase>
<InStockOnly>true</InStockOnly>
</StockListRequestData> 
```

此 XML 与`DataContract`我的 Web 服务上的 a 匹配：

```
[DataContract(Namespace = "http://myWebService.com/endpoint")]
public class StockListRequestData
{
    [DataMember]
    public string UserID { get; set; }

    [DataMember]
    public string StockDatabase { get; set; }

    [DataMember]
    public bool InStockOnly { get; set; }
} 
```

问题是`<InStockOnly>true</InStockOnly>`元素，当我将它设置为时`true`，`false`它总是被解释为`false`......

这是处理请求的代码：

```
public StockListResponseData GetListOfProducts(StockListRequestData requestData)
    {
        var stockList = new StockList(requestData.InStockOnly, requestData.StockDatabase);
        StockListResponseData response;
        if (stockList.Any())
        {
            var stockArray = new Stock[stockList.Count];
            var i = 0;
            foreach (var s in stockList)
            {
                stockArray[i] = s;
                i++;
            }
            response = new StockListResponseData
                           {
                               StockList = stockArray,
                               WasSuccessful = true,
                           };
            return response;
        }
        response = new StockListResponseData
                       {
                           WasSuccessful = false
                       };
        return response;
    } 
```

`StockList`班级：

```
[DataContract]
public class StockList : List<Stock>
{
    public StockList(bool inStockOnly, string stockDb)
    {
        if (inStockOnly)
        {
            // Get only products that are in stock
            var conn = AndyServerDatabase.ConnectToStockMovementByDb(stockDb);
            conn.Open();
            // Compile SQL query
            var q = new SqlCommand(null, conn) { CommandText = "SELECT StockID, Name, PerBox FROM Stock WHERE InStock = 1;" };

            // Execute query
            var rdr = q.ExecuteReader();

            // Check that the output isn't null
            if (rdr.HasRows)
            {
                while(rdr.Read())
                {
                    var id = Convert.ToInt32(rdr[0]);
                    var name = rdr[1].ToString();
                    var perBox = Convert.ToInt32(rdr[2]);
                    Add(new Stock(id, name, perBox));
                }
                conn.Close();
            }
            // Output is null
            conn.Close();
        }
        else
        {
            // Get all products
            // Get only products that are in stock
            var conn = AndyServerDatabase.ConnectToStockMovementByDb(stockDb);
            conn.Open();
            // Compile SQL query
            var q = new SqlCommand(null, conn) { CommandText = "SELECT StockID, Name, PerBox FROM Stock;" };
            q.Prepare();

            // Execute query
            var rdr = q.ExecuteReader();

            // Check that the output isn't null
            if (rdr.HasRows)
            {
                while (rdr.Read())
                {
                    var id = Convert.ToInt32(rdr[0]);
                    var name = rdr[1].ToString();
                    var perBox = Convert.ToInt32(rdr[2]);
                    Add(new Stock(id, name, perBox));
                }
                conn.Close();
            }
            // Output is null
            conn.Close();
        }
        // Add();
    }
} 
```

结果 XML：

```
<StockListResponseData xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
    <StockList xmlns:a="http://schemas.datacontract.org/2004/07/SMS">
        <a:Stock>
            <a:Id>1</a:Id>
            <a:Name>Smirnoff Vodka (70cl)</a:Name>
            <a:PerBox>6</a:PerBox>
            <a:Quantity>0</a:Quantity>
            <a:Remains>0</a:Remains>
        </a:Stock>
        <a:Stock>
            <a:Id>2</a:Id>
            <a:Name>Jagermeister (70cl)</a:Name>
            <a:PerBox>6</a:PerBox>
            <a:Quantity>0</a:Quantity>
            <a:Remains>0</a:Remains>
        </a:Stock>
    </StockList>
    <WasSuccessful>true</WasSuccessful> 
```

我希望这足以继续下去，我已经被难住了很长时间，只是无法弄清楚为什么它会以这种方式表现..如果您需要我没有包含的其他代码，请随时询问。

非常感谢，

安迪

编辑：

添加一些上下文以显示正在发生的事情：

例如，我知道：

```
 <a:Stock>
        <a:Id>2</a:Id>
        <a:Name>Jagermeister (70cl)</a:Name>
        <a:PerBox>6</a:PerBox>
        <a:Quantity>0</a:Quantity>
        <a:Remains>0</a:Remains>
    </a:Stock> 
```

将其`InStock`行设置为 0，这意味着如果我传入`true`.

我已将 StockList 构造函数更改`if(inStockOnly)`为`if(!inStockOnly)`- 然后我传入`<InStockOnly>true</InStockOnly>`- 当它到达 StockList 构造函数时，它会被反转并显示正确的数据 - 所以在它到达此`if`语句时它必须将其读取为假。

如果我传入`<InStockOnly>false</InStockOnly>`它仍然显示“正确”的结果，因此它会读取它为假，直到它得到反转！

同样，如果我将其保留为`if(inStockOnly)`并传入`<InStockOnly>false</InStockOnly>`它会显示数据`false`！

我还添加`requestData.InStockOnly`到 StockListResponseData DataContract 并在那里显示它输出`requestData.InStockOnly`as的值`false`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T23:56:01.207

您的发现使我得到了解释，并且有人遇到了与您类似的问题：

[WCF DataContract DataMember 命令？](https://stackoverflow.com/questions/3816478/wcf-datacontract-datamember-order) [http://msdn.microsoft.com/en-us/library/ms729813.aspx](http://msdn.microsoft.com/en-us/library/ms729813.aspx)

> 接下来是当前类型的不具有 DataMemberAttribute 属性集的 Order 属性的数据成员，按字母顺序排列。

当没有明确指定数据成员的顺序时，它们的序列化顺序是按字母顺序排列的。这就解释了为什么 InStockOnly 在移到顶部时起作用，因为它是按字母顺序排列的第一个。另一方面，为什么 StockDatabase 工作有点神秘，因为那是在 UserId 按字母顺序之后（如果 StockDb 为空，AndyServerDatabase.ConnectToStockMovementByDb() 是否使用默认值？）。

为了争论起见，如果出于某种原因您想保留那里的订单，您可以这样做：

```
[DataContract(Namespace = "http://myWebService.com/endpoint")]
public class StockListRequestData
{
    [DataMember(Order = 0)]
    public string UserID { get; set; }

    [DataMember(Order = 1)]
    public string StockDatabase { get; set; }

    [DataMember(Order = 2)]
    public bool InStockOnly { get; set; }
} 
```

事实上，明确指出顺序可能是一种好习惯，因此稍后添加新属性不会破坏任何内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-30T19:32:38.120

我尝试了上面的建议，但它仍然没有奏效！继续搜索并找到另一个解决方案，实际上将“指定”属性设置为 true：

```
PackageImagesPayload payload = new PackageImagesPayload();
payload.UsesSplitBy = usesSplitBy;
payload.UsesSplitBySpecified = true; 
```

# javascript - 使用位置的水平 jquery 滚动器：绝对；不断滚动

> ID：14187463
> 
> 赞同：2
> 
> 时间：2013-01-06T22:26:48.973
> 
> 标签：javascript, jquery, horizontal-scrolling, absolute

我已经做到了这一点，它适用于实心宽度的 div，但无法弄清楚如何在 div 的宽度发生变化时对其进行操作。

**问题：如何让这个函数考虑每个“回合”后不同的 div 宽度？**

```
var horizontalScroller = function($elem) {
    var left = parseInt($elem.css("left"));
    var temp = -1 * $('#horizontalScroller li').width();
    if(left < temp) {
        left = $('#horizontalScroller').width();
        $elem.css("left", left);
    }
    $elem.animate({ left: (left-60) }, 2000, 'linear', function () {
      horizontalScroller($(this));
    });
}

$(document).ready(function() {
    var i = 0;
    $("#horizontalScroller li").each(function () {
          $(this).css("left", i);
          i += $(this).width();
          horizontalScroller($(this));
    });

}); 
```

*工作示例（固定宽度）： http: [//jsfiddle.net/GL5V3/](http://jsfiddle.net/GL5V3/)*
*工作示例（不同宽度）：http: [//jsfiddle.net/wm9gt/](http://jsfiddle.net/wm9gt/)*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-09T04:08:41.900

好吧，这有点有趣，了解您的代码是如何工作的，但是在我这样做之前...

我将其重写为：（[工作小提琴）](http://jsfiddle.net/Khez/9ban8/)

```
function horizontalScroller(ulSelector) {
  var horizontalSpan=0;
  var collection=[];
  function animate(index) {
    var cur=collection[index];
    var left=parseInt(cur.elem.css('left'));
    if(left < cur.reboundPos) {
        left+=horizontalSpan;
        console.log(left);
        cur.elem.css('left',left);
    }
    cur.elem.animate(
      { left: (left-60) },
      2000,
      'linear',
      function () {animate(index)}
    );
  }
  $(ulSelector).find('li').each(function() {
    var $this=$(this);
    var width=$this.width();
    $this.css('left',horizontalSpan);
    collection.push({reboundPos: -1 * width, elem: $this});
    horizontalSpan+=width;
    animate(collection.length-1);
  });
  console.log(collection);
  console.log(horizontalSpan);
}

$(document).ready(function() {
    horizontalScroller('#horizontalScroller');
}); 
```

然后我回到你的代码并做了这个：

```
var horizontalSpan = 0;// swapped i for a "global" variable
var horizontalScroller = function($elem) {
    var left = parseInt($elem.css("left"));
    var temp = -1 * $elem.width();// updated to the correct width
    if(left < temp) {// now out of bounds is properly calculated
        left += horizontalSpan;// proper "wrapping" with just one addition
        $elem.css("left", left);
    }
    $elem.animate({ left: (left-60) }, 2000, 'linear', function () {
      horizontalScroller($(this));
    });
}

$(document).ready(function() { 
    $("#horizontalScroller li").each(function () {
          $(this).css("left", horizontalSpan);// horizontalSpan!!!
          horizontalSpan += $(this).width();// horizontalSpan!!!
          horizontalScroller($(this));
    });
}); 
```

如果您有问题或想稍微调整一下。我很高兴你能帮助你。但我希望你能自己管理。

PS我最初的评论很粗鲁，你的水平滚动是好的*竖起大拇指*（但你希望其中一些`.width()`调用的值会有所不同）

# loops - 从满足条件向量的向量中擦除元素

> ID：14187466
> 
> 赞同：0
> 
> 时间：2013-01-06T22:27:09.083
> 
> 标签：loops, vector, physics

```
for (int i=0;i<matSize;i++) 
{

    if(condition[i]==1)
    {
    displacement.erase (displacement.begin()+i);
    }

 } 
```

这个循环有什么问题？我正在尝试从满足条件的位移矢量中删除元素。我无法让擦除循环工作。有人可以帮助我吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T16:46:12.867

我会冒昧地假设这是 C++，而您正在使用 std::vector。

假设向量中有 5 个元素。擦掉一个后，还剩多少？接下来你会检查哪一个，你会数多高？

更明确地说，假设它是

```
[0, 10, 20, 30, 40] 
```

并且你想擦除 10 和 20。所以当`i`是 1 时，你测试 10 并擦除它；现在向量是

```
[0, 20, 30, 40] 
```

然后您`i`增加到 2，并检查 30，*完全错过了 20*。当您迭代结束时（即`i`4 时），您将遇到更大的麻烦。

解决方案很简单，您可以通过在一个小而简单的向量上尝试您的代码并查看您正在测试和擦除哪些元素来发现所有这些。

# c# - WPF：当 IsEnabled=false 时获取 MouseEnter 事件

> ID：14187468
> 
> 赞同：5
> 
> 时间：2013-01-06T22:27:33.217
> 
> 标签：c#, wpf, event-handling, mouseevent

当控件被禁用时，我想为自定义控件处理 MouseEnter 事件。有没有办法处理它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T08:06:05.750

[`UIElement.IsEnabled`](http://msdn.microsoft.com/en-us/library/system.windows.uielement.isenabled.aspx)记录您看到的行为的文档：

> 未启用的元素不参与命中测试或焦点，因此不会成为输入事件的来源。

对我来说，合乎逻辑的结论是，如果您确实想处理鼠标事件，则不要禁用控件。相反，请使用其他方法来实现您想要的。例如，如果它是一个输入控件，将其设为只读而不是禁用可能就足够了。您的问题并没有真正解释您为什么要这样做，所以我无法猜测适合您的方法是什么。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-07T08:06:44.413

`ContentControl`也许您可以用一个（必须始终启用）围绕您的自定义控件并`MouseEnter`处理`ContentControl`.

# ios - Splitviewcontroller 逻辑不对，重复内容

> ID：14187469
> 
> 赞同：0
> 
> 时间：2013-01-06T22:27:35.013
> 
> 标签：ios, xcode, ipad, uisplitviewcontroller

我正在尝试将我的 iphone 应用程序移植到 Ipad，逻辑不适用于`splitviewcontroller`.

在`viewDidLoad`我调用一个更新视图的函数并使用`setSearchResult`（覆盖设置器）

问题是每次我在添加到它`masterviewcontroller`的内容中选择一行而不是删除旧内容时..`detailviewcontroller`

我认为这给了我一个问题：

```
 CGRect framephoto = CGRectMake(0, 85, 320, 186);
        carousel = [[iCarousel alloc] initWithFrame:framephoto];
        [self.scrollview addSubview:carousel]; 
```

和这张表（自定义毫克）

```
 // the tables grid
    CGSize tablesGridSize = IPAD_TABLES_GRID;
    tablesGrid = [MGBox boxWithSize:tablesGridSize];
    tablesGrid.contentLayoutMode = MGLayoutGridStyle;
    [self.scrollview.boxes addObject:tablesGrid]; 
```

我认为，因为每次我选择一行并到达这些代码时，它都会添加另一个。

我不是专业人士，所以也许这个问题很愚蠢，但欢迎每个提示.. 处理这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T23:22:12.180

不幸的是，处理这个问题的最好方法是使用你应该已经在你的应用程序中使用的 UINavigationController。解决您的问题的一个简单方法是在添加新子视图之前删除所有子视图（也许您必须保护对 the`iCarousel`和 the的引用`tablesGrid`）。更好的方法是只更新您已经分配的视图的数据。

# css - div之间的灵活距离

> ID：14187470
> 
> 赞同：0
> 
> 时间：2013-01-06T22:27:40.947
> 
> 标签：css, html

我正在尝试制作相同大小的 div 列表。我需要这样做。我将 div 与左浮动对齐，假设 5 个 div 在 1 行中有空间，第 6 个 div 将在其下方。现在我需要做的是从这 5 个 div 中剩余的额外空间，应该在这 5 个 div 之间平均分配。

假设每个 div 有 200px 并且屏幕有 1100px 宽度。现在 5 个 div 之间必须有 25px。200 像素 + 25 像素 + 200 像素 + 25 像素 + 200 像素 + 25 像素 + 200 像素 + 25 像素 + 200 像素。

提前谢谢你，丹尼尔。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T15:44:08.157

我尝试的是您的 div 的 % 宽度和边距的 % 宽度。由于您希望每行有 5 个 div，因此您可以在没有空格或边框的情况下最多做 20%。在下面的 jsfiddle 中，我使用了 17% 的宽度和 2% 的左边距设置。如果需要，您可以自定义第一个 div 样式以不向左填充。

```
.cell {
    height:30%;
    width:17%;
    background:#ff0000;
    border:1px solid black;
    margin-bottom:2em;
    float:left;
    margin-left:2%;
}

http://jsfiddle.net/aKn4n/ 
```

当您缩小和扩大浏览器窗口时，您几乎可以在第一行保留 5 个 div。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-11T14:25:36.153

您可以在示例中向左浮动一个宽度为 25px 的空 div，或者您使用 25px 的百分比表示 1100 将是 2%

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-11T14:03:49.543

我个人会尝试给每个 div 一个边距，如下所示：

```
div{
    margin: 0px 12.5px;
} 
```

这将有望均匀分布所有 div。

# c - 使用按位运算符的 Mandelbrot 函数

> ID：14187475
> 
> 赞同：-2
> 
> 时间：2013-01-06T22:28:11.797
> 
> 标签：c, fractals, bit-manipulation

我正在渲染 buddhabrot 分形，我正在寻找一些优化/加速，我想知道尝试使用按位运算符执行 z = z^2 + c 是否值得。我已经把它简化了一点。

```
 double zi2 = z.i*z.i;
   double zr2 = z.r*z.r;
   double zir = z.i*z.r;
   while (iterations < MAX_BUDDHA_ITERATIONS && zi2 + zr2 < 4) {

         z.i = c.i;
         z.i += zir;
         z.i += zir;
         z.r = zr2 - zi2 + c.r;
         zi2 = z.i*z.i;
         zr2 = z.r*z.r;
         zir = z.i*z.r;
         iterations++;
   } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T23:43:12.860

`z^2+c`可以封装在[融合乘加](https://en.wikipedia.org/wiki/Multiply%E2%80%93accumulate_operation)运算中。这在某些处理器上可作为单指令使用，并且在其他处理器上也可用。在它不可用的处理器中，它通常是优化的或可优化的。例如，C99 定义了[fma](http://publib.boulder.ibm.com/infocenter/zos/v1r12/index.jsp?topic=/com.ibm.zos.r12.bpxbd00/fma.htm)系列函数来提供它。所以我想说你想要的可能已经发生了，如果没有，有一种非常易读的方法来保证它是。

一般来说，任何时候你的潜意识都应该高度怀疑，用你刚刚构想的不那么可读、不那么可维护、更难调试的解决方案 X 来替换可读、可维护的代码会更快。可读性和可维护性不仅对于编写好代码非常重要，对于共享代码和讨论其正确性也非常重要；计算机速度很快，编译器相当不错。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T22:44:30.173

编译器不在按位运算中执行此操作......它是 CPU 及其 ALU，它们使用按位运算，当然，对于一个单词的所有位，甚至在现代处理器中一次同时发生多个机器代码指令（如 multipy） .

你所问的毫无意义......好吧，如果你正在编程一个 FPGA，它可能是有道理的，但我假设你不是......

# javascript - 使用鼠标裁剪和插入形状不规则的图像

> ID：14187480
> 
> 赞同：0
> 
> 时间：2013-01-06T22:28:26.990
> 
> 标签：javascript, html

我已经裁剪了不规则形状的图像。我需要将图像插入裁剪部分。我已经使用 HTML5 和 JavaScript (kinetic.js) 来做到这一点（参见：http://imgur.com/Lyt3j [）](http://imgur.com/Lyt3j)。我已经完成了区域绘图。我不想要矩形、多边形等形状。我需要一个用户定义的形状，应该使用鼠标进行裁剪。

任何人都可以帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T22:54:08.857

看一下 2d 上下文的[合成设置](http://www.html5canvastutorials.com/advanced/html5-canvas-global-composite-operations-tutorial/)。这些允许您使用路径或图像在画布上执行遮罩。当您`.fillPath`使用实体`fillColor`和在上面创建`context.globalCompositeOperation = 'destination-in'`的路径时，将不会绘制路径，并且仅保留路径内部覆盖的图像部分。其余的将是 alpha 透明的。相反，当您使用该`'source-out'`操作时，您会在绘制路径的画布中创建一个透明的“洞”。

因此，当您有一个带有源图像（要插入的图像）的画布、带有目标图像（要插入另一个图像的图像）和路径的画布时，有几种方法可以做到这一点。

a) 您使用 绘制源画布的路径`source-in`，因此您有一个正确形状的图形。然后将复合操作设置回源画布`source-over`，然后将其设置到目标画布上。`drawImage`这将裁剪源画布上的图像，因此请确保在您仍然需要它时事先创建一个副本。

b）您绘制目标图像的路径`destination-out`以擦除路径所包围的区域，将合成操作设置为`destination-atop`，然后`drawImage`将源图像设置为目标图像，然后将其插入到目标透明部分的“后面”。此变体对源画布是非破坏性的。请记住在完成时将 globalCompositeOperation 设置回`source-over`，否则其他画布操作可能不再按照您的预期执行。

c) 就像在 b) 中一样，您使用`destination-out`在目标画布上切出一个洞，然后将合成操作设置为正常设置`source-over`并将目标绘制到源上。您现在在源画布上拥有完整的图像。

# cuda - CUDA 中的一维 fftshift

> ID：14187481
> 
> 赞同：2
> 
> 时间：2013-01-06T22:28:40.347
> 
> 标签：cuda, fft

我正在 CUDA 中设置一维 fftshift。我的代码如下

```
__global__ void fftshift(double2 *u_d, int N)
{
    int i = blockDim.x * blockIdx.x + threadIdx.x;

    double2 temp;

    if(i< N/2)
    {
        temp.x =  u_d[i].x;
        temp.y =  u_d[i].y;

        u_d[i].x =u_d[i+N/2].x;
        u_d[i].y =u_d[i+N/2].y;

        u_d[i+N/2].x = temp.x;
        u_d[i+N/2].y = temp.y;
    }
} 
```

有没有比上面显示的更聪明的方法来在 CUDA 中执行 fftshift？

提前致谢。

**也许更好的解决方案**

我发现也许以下解决方案可能是一个不错的选择

```
__global__ void fftshift(double2 *u_d, int N)
{
    int i = blockDim.x * blockIdx.x + threadIdx.x;

    if(i < N)
    {
        double a = pow(-1.0,i&1);
        u_d[i].x *= a;
        u_d[i].y *= a;
    }
} 
```

它包括将要转换的向量乘以`1`s 和`-1`s 的序列，这等效于乘以 exp(-j *n* pi) 并因此等效于共轭域中的移位。

您必须在应用 CUFFT 之前和之后调用此内核。

一个优点是避免了内存移动/交换，这个想法可以立即扩展到 2D 案例，请参阅[CUDA Device To Device transfer成本昂贵](https://stackoverflow.com/questions/6063619/cuda-device-to-device-transfer-expensive/14203369#14203369)。

**关于对称数据**

该解决方案似乎不仅限于对称数据。试试下面的 Matlab 代码，将这个想法应用于完全复杂的随机矩阵（高斯幅度和均匀相位）。

```
N1=512;
N2=256;

Phase=(rand(N1,N2)-0.5)*2*pi;
Magnitude=randn(N1,N2);

Im=Magnitude.*exp(j*Phase);

Transform=fftshift(fft2(ifftshift(Im)));

n1=0:(N1-1);
n2=0:(N2-1);
[N2,N1]=meshgrid(n2,n1);
Im2=Im.*(-1).^(N1+N2);
Im3=fft2(Im2);
Im4=Im3.*(-1).^(N1+N2);

100*sqrt(sum(abs(Im4-Transform).^2)/sum(abs(Transform).^2)) 
```

返回的归一化均方根误差将是`0`，确认`Transform=Im4`。

**提高速度**

[根据NVIDIA 论坛](https://devtalk.nvidia.com/default/topic/527302/cuda-programming-and-performance/coalesced-memory-access-and-global-memory-load-store-efficiency-with-complex-arithmetics-in-cuda/?offset=3#3729796)收到的建议，可以通过更改指令来提高速度

```
double a = pow(-1.0,i&1); 
```

至

```
double a = 1-2*(i&1); 
```

避免使用缓慢的套路`pow`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-10-03T22:35:55.613

经过大量时间和 cuFFT 回调功能的介绍，我可以为我自己的问题提供一个有意义的答案。

上面我提出了一个“也许更好的解决方案”。经过一些测试，我意识到，如果不使用回调 cuFFT 功能，该解决方案会更慢，因为它使用`pow`. 然后，我探索了使用的两种替代方法`pow`，例如

```
float a     = (float)(1-2*((int)offset%2));

float2  out = ((float2*)d_in)[offset];
out.x = out.x * a;
out.y = out.y * a; 
```

和

```
float2  out = ((float2*)d_in)[offset];

if ((int)offset&1) {

    out.x = -out.x;
    out.y = -out.y;

} 
```

但是，对于标准 cuFFT，上述所有解决方案都需要两个单独的内核调用，一个用于 fftshift，另一个用于 cuFFT 执行调用。但是，使用新的 cuFFT 回调功能，上述替代解决方案可以作为`__device__`函数嵌入到代码中。

所以，最后我得到了下面的比较代码

```
#include "cuda_runtime.h"
#include "device_launch_parameters.h"

#include <stdio.h>
#include <assert.h>

#include <cufft.h>
#include <cufftXt.h>

//#define DEBUG

#define BLOCKSIZE 256

/**********/
/* iDivUp */
/**********/
int iDivUp(int a, int b) { return ((a % b) != 0) ? (a / b + 1) : (a / b); }

/********************/
/* CUDA ERROR CHECK */
/********************/
#define gpuErrchk(ans) { gpuAssert((ans), __FILE__, __LINE__); }
inline void gpuAssert(cudaError_t code, const char *file, int line, bool abort=true)
{
    if (code != cudaSuccess)
    {
        fprintf(stderr,"GPUassert: %s %s %d\n", cudaGetErrorString(code), file, line);
        if (abort) exit(code);
    }
}

/*********************/
/* CUFFT ERROR CHECK */
/*********************/
// See http://stackoverflow.com/questions/16267149/cufft-error-handling
#ifdef _CUFFT_H_
// cuFFT API errors
static const char *_cudaGetErrorEnum(cufftResult error)
{
    switch (error)
    {
        case CUFFT_SUCCESS:
            return "CUFFT_SUCCESS";

        case CUFFT_INVALID_PLAN:
            return "CUFFT_INVALID_PLAN";

        case CUFFT_ALLOC_FAILED:
            return "CUFFT_ALLOC_FAILED";

        case CUFFT_INVALID_TYPE:
            return "CUFFT_INVALID_TYPE";

        case CUFFT_INVALID_VALUE:
            return "CUFFT_INVALID_VALUE";

        case CUFFT_INTERNAL_ERROR:
            return "CUFFT_INTERNAL_ERROR";

        case CUFFT_EXEC_FAILED:
            return "CUFFT_EXEC_FAILED";

        case CUFFT_SETUP_FAILED:
            return "CUFFT_SETUP_FAILED";

        case CUFFT_INVALID_SIZE:
             return "CUFFT_INVALID_SIZE";

        case CUFFT_UNALIGNED_DATA:
            return "CUFFT_UNALIGNED_DATA";
    }

    return "<unknown>";
}
#endif

#define cufftSafeCall(err)      __cufftSafeCall(err, __FILE__, __LINE__)
inline void __cufftSafeCall(cufftResult err, const char *file, const int line)
{
    if( CUFFT_SUCCESS != err) {
        fprintf(stderr, "CUFFT error in file '%s', line %d\n %s\nerror %d: %s\nterminating!\n",__FILE__, __LINE__,err, \
                            _cudaGetErrorEnum(err)); \
        cudaDeviceReset(); assert(0); \
    }
}

/****************************************/
/* FFTSHIFT 1D INPLACE MEMORY MOVEMENTS */
/****************************************/
__global__ void fftshift_1D_inplace_memory_movements(float2 *d_inout, unsigned int N)
{
    unsigned int tid = threadIdx.x + blockIdx.x * blockDim.x;

    if (tid < N/2)
    {
        float2 temp = d_inout[tid];
        d_inout[tid] = d_inout[tid + (N / 2)];
        d_inout[tid + (N / 2)] = temp;
    }
}

/**********************************************/
/* FFTSHIFT 1D INPLACE CHESSBOARD - VERSION 1 */
/**********************************************/
__device__ float2 fftshift_1D_chessboard_callback_v1(void *d_in, size_t offset, void *callerInfo, void *sharedPtr) {

    float a     = (float)(1-2*((int)offset%2));

    float2  out = ((float2*)d_in)[offset];
    out.x = out.x * a;
    out.y = out.y * a;
    return out;
}

__device__ cufftCallbackLoadC fftshift_1D_chessboard_callback_v1_Ptr = fftshift_1D_chessboard_callback_v1;

/**********************************************/
/* FFTSHIFT 1D INPLACE CHESSBOARD - VERSION 2 */
/**********************************************/
__device__ float2 fftshift_1D_chessboard_callback_v2(void *d_in, size_t offset, void *callerInfo, void *sharedPtr) {

    float a = pow(-1.,(double)(offset&1));

    float2  out = ((float2*)d_in)[offset];
    out.x = out.x * a;
    out.y = out.y * a;
    return out;
}

__device__ cufftCallbackLoadC fftshift_1D_chessboard_callback_v2_Ptr = fftshift_1D_chessboard_callback_v2;

/**********************************************/
/* FFTSHIFT 1D INPLACE CHESSBOARD - VERSION 3 */
/**********************************************/
__device__ float2 fftshift_1D_chessboard_callback_v3(void *d_in, size_t offset, void *callerInfo, void *sharedPtr) {

    float2  out = ((float2*)d_in)[offset];

    if ((int)offset&1) {

        out.x = -out.x;
        out.y = -out.y;

    }
return out;
}

__device__ cufftCallbackLoadC fftshift_1D_chessboard_callback_v3_Ptr = fftshift_1D_chessboard_callback_v3;

/********/
/* MAIN */
/********/
int main()
{
    const int N = 131072;

    printf("N = %d\n", N);

    // --- Host side input array
    float2 *h_vect = (float2 *)malloc(N*sizeof(float2));
    for (int i=0; i<N; i++) {
        h_vect[i].x = (float)rand() / (float)RAND_MAX;
        h_vect[i].y = (float)rand() / (float)RAND_MAX;
    }

    // --- Host side output arrays
    float2 *h_out1 = (float2 *)malloc(N*sizeof(float2));
    float2 *h_out2 = (float2 *)malloc(N*sizeof(float2));
    float2 *h_out3 = (float2 *)malloc(N*sizeof(float2));
    float2 *h_out4 = (float2 *)malloc(N*sizeof(float2));

    // --- Device side input arrays
    float2 *d_vect1; gpuErrchk(cudaMalloc((void**)&d_vect1, N*sizeof(float2)));
    float2 *d_vect2; gpuErrchk(cudaMalloc((void**)&d_vect2, N*sizeof(float2)));
    float2 *d_vect3; gpuErrchk(cudaMalloc((void**)&d_vect3, N*sizeof(float2)));
    float2 *d_vect4; gpuErrchk(cudaMalloc((void**)&d_vect4, N*sizeof(float2)));
    gpuErrchk(cudaMemcpy(d_vect1, h_vect, N*sizeof(float2), cudaMemcpyHostToDevice));
    gpuErrchk(cudaMemcpy(d_vect2, h_vect, N*sizeof(float2), cudaMemcpyHostToDevice));
    gpuErrchk(cudaMemcpy(d_vect3, h_vect, N*sizeof(float2), cudaMemcpyHostToDevice));
    gpuErrchk(cudaMemcpy(d_vect4, h_vect, N*sizeof(float2), cudaMemcpyHostToDevice));

    // --- Device side output arrays
    float2 *d_out1; gpuErrchk(cudaMalloc((void**)&d_out1, N*sizeof(float2)));
    float2 *d_out2; gpuErrchk(cudaMalloc((void**)&d_out2, N*sizeof(float2)));
    float2 *d_out3; gpuErrchk(cudaMalloc((void**)&d_out3, N*sizeof(float2)));
    float2 *d_out4; gpuErrchk(cudaMalloc((void**)&d_out4, N*sizeof(float2)));

    float time;
    cudaEvent_t start, stop;
    cudaEventCreate(&start);
    cudaEventCreate(&stop);

    /*******************************************/
    /* cuFFT + MEMORY MOVEMENTS BASED FFTSHIFT */
    /*******************************************/
    cufftHandle planinverse; cufftSafeCall(cufftPlan1d(&planinverse, N, CUFFT_C2C, 1));
    cudaEventRecord(start, 0);
    cufftSafeCall(cufftExecC2C(planinverse, d_vect1, d_vect1, CUFFT_INVERSE));
    fftshift_1D_inplace_memory_movements<<<iDivUp(N/2, BLOCKSIZE), BLOCKSIZE>>>(d_vect1, N);
#ifdef DEBUG
    gpuErrchk(cudaPeekAtLastError());
    gpuErrchk(cudaDeviceSynchronize());
#endif
    cudaEventRecord(stop, 0);
    cudaEventSynchronize(stop);
    cudaEventElapsedTime(&time, start, stop);
    printf("Memory movements elapsed time:  %3.3f ms \n", time);
    gpuErrchk(cudaMemcpy(h_out1, d_vect1, N*sizeof(float2), cudaMemcpyDeviceToHost));

    /****************************************/
    /* CHESSBOARD MULTIPLICATION V1 + cuFFT */
    /****************************************/
    cufftCallbackLoadC hfftshift_1D_chessboard_callback_v1_Ptr;

    gpuErrchk(cudaMemcpyFromSymbol(&hfftshift_1D_chessboard_callback_v1_Ptr, fftshift_1D_chessboard_callback_v1_Ptr, sizeof(hfftshift_1D_chessboard_callback_v1_Ptr)));
    cufftHandle planinverse_v1; cufftSafeCall(cufftPlan1d(&planinverse_v1, N, CUFFT_C2C, 1));
    cufftResult status = cufftXtSetCallback(planinverse_v1, (void **)&hfftshift_1D_chessboard_callback_v1_Ptr, CUFFT_CB_LD_COMPLEX, 0);
    if (status == CUFFT_LICENSE_ERROR) {
        printf("This sample requires a valid license file.\n");
        printf("The file was either not found, out of date, or otherwise invalid.\n");
        exit(EXIT_FAILURE);
    } else {
        cufftSafeCall(status);
    }
    cudaEventRecord(start, 0);
    cufftSafeCall(cufftExecC2C(planinverse_v1, d_vect2, d_out2, CUFFT_INVERSE));
    cudaEventRecord(stop, 0);
    cudaEventSynchronize(stop);
    cudaEventElapsedTime(&time, start, stop);
    printf("Chessboard v1 elapsed time:  %3.3f ms \n", time);

    gpuErrchk(cudaMemcpy(h_out2, d_out2, N*sizeof(float2), cudaMemcpyDeviceToHost));

    // --- Checking the results
    for (int i=0; i<N; i++) if ((h_out1[i].x != h_out2[i].x)||(h_out1[i].y != h_out2[i].y)) { printf("Chessboard v1 test failed!\n"); return 0; }

    printf("Chessboard v1 test passed!\n");

    /****************************************/
    /* CHESSBOARD MULTIPLICATION V2 + cuFFT */
    /****************************************/
    cufftCallbackLoadC hfftshift_1D_chessboard_callback_v2_Ptr;

    gpuErrchk(cudaMemcpyFromSymbol(&hfftshift_1D_chessboard_callback_v2_Ptr, fftshift_1D_chessboard_callback_v2_Ptr, sizeof(hfftshift_1D_chessboard_callback_v2_Ptr)));
    cufftHandle planinverse_v2; cufftSafeCall(cufftPlan1d(&planinverse_v2, N, CUFFT_C2C, 1));
    status = cufftXtSetCallback(planinverse_v2, (void **)&hfftshift_1D_chessboard_callback_v2_Ptr, CUFFT_CB_LD_COMPLEX, 0);
    if (status == CUFFT_LICENSE_ERROR) {
        printf("This sample requires a valid license file.\n");
        printf("The file was either not found, out of date, or otherwise invalid.\n");
        exit(EXIT_FAILURE);
    } else {
        cufftSafeCall(status);
    }
    cudaEventRecord(start, 0);
    cufftSafeCall(cufftExecC2C(planinverse_v2, d_vect3, d_out3, CUFFT_INVERSE));
    cudaEventRecord(stop, 0);
    cudaEventSynchronize(stop);
    cudaEventElapsedTime(&time, start, stop);
    printf("Chessboard v2 elapsed time:  %3.3f ms \n", time);

    gpuErrchk(cudaMemcpy(h_out3, d_out3, N*sizeof(float2), cudaMemcpyDeviceToHost));

    // --- Checking the results
    for (int i=0; i<N; i++) if ((h_out1[i].x != h_out3[i].x)||(h_out1[i].y != h_out3[i].y)) { printf("Chessboard v2 test failed!\n"); return 0; }

    printf("Chessboard v2 test passed!\n");

    /****************************************/
    /* CHESSBOARD MULTIPLICATION V3 + cuFFT */
    /****************************************/
    cufftCallbackLoadC hfftshift_1D_chessboard_callback_v3_Ptr;

    gpuErrchk(cudaMemcpyFromSymbol(&hfftshift_1D_chessboard_callback_v3_Ptr, fftshift_1D_chessboard_callback_v3_Ptr, sizeof(hfftshift_1D_chessboard_callback_v3_Ptr)));
    cufftHandle planinverse_v3; cufftSafeCall(cufftPlan1d(&planinverse_v3, N, CUFFT_C2C, 1));
    status = cufftXtSetCallback(planinverse_v3, (void **)&hfftshift_1D_chessboard_callback_v3_Ptr, CUFFT_CB_LD_COMPLEX, 0);
    if (status == CUFFT_LICENSE_ERROR) {
        printf("This sample requires a valid license file.\n");
        printf("The file was either not found, out of date, or otherwise invalid.\n");
        exit(EXIT_FAILURE);
    } else {
        cufftSafeCall(status);
    }
    cudaEventRecord(start, 0);
    cufftSafeCall(cufftExecC2C(planinverse_v3, d_vect4, d_out4, CUFFT_INVERSE));
    cudaEventRecord(stop, 0);
    cudaEventSynchronize(stop);
    cudaEventElapsedTime(&time, start, stop);
    printf("Chessboard v3 elapsed time:  %3.3f ms \n", time);

    gpuErrchk(cudaMemcpy(h_out4, d_out4, N*sizeof(float2), cudaMemcpyDeviceToHost));

    // --- Checking the results
    for (int i=0; i<N; i++) if ((h_out1[i].x != h_out4[i].x)||(h_out1[i].y != h_out4[i].y)) { printf("Chessboard v3 test failed!\n"); return 0; }

    printf("Chessboard v3 test passed!\n");

    return 0;
} 
```

**GTX 480 上的结果**

```
N         Mem mov   v1      v2      v3 
131072    0.552     0.136   0.354   0.183 
262144    0.536     0.175   0.451   0.237 
524288    0.661     0.283   0.822   0.290 
1048576   0.784     0.565   1.548   0.548 
2097152   1.298     0.952   2.973   0.944 
```

**特斯拉 C2050 的结果**

```
N         Mem mov   v1      v2      v3 
131072    0.278     0.130   0.236   0.132 
262144    0.344     0.202   0.374   0.206 
524288    0.544     0.378   0.696   0.387 
1048576   0.909     0.695   1.294   0.695 
2097152   1.656     1.349   2.531   1.349 
```

**开普勒 K20c 的结果**

```
N         Mem mov   v1      v2      v3 
131072    0.077     0.076   0.136   0.076 
262144    0.142     0.128   0.202   0.127 
524288    0.268     0.229   0.374   0.230 
1048576   0.516     0.433   0.717   0.435 
2097152   1.019     0.853   1.400   0.855 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-06T22:45:56.070

如果空间不是问题（并且仅对一个维度使用 fftshift），则创建大小为 1.5 x N，并在末尾`u_d`写入第一个元素。`N/2`然后你可以移动`u_d`到`u_d + N / 2`

这是你可以做到的。

```
double2 *u_d, *u_d_begin;
size_t bytes = N * sizeof(double2);
// This is different from bytes / 2 when N is odd
size_t half_bytes = (N / 2) * sizeof(double2);
CUDA_CHK(cudaMalloc( &u_d, bytes + half_bytes ));
u_d_begin = u_d;
...
// Do some processing and populate u_d;
...
// Copy first half to the end
CUDA_CHK(cudaMemcpy(u_d + N, u_d, half_bytes, cudaMemcpyDeviceToDevice));
u_d = u_d + N /2; 
```

# actionscript-3 - 黑名单跨域策略文件

> ID：14187484
> 
> 赞同：0
> 
> 时间：2013-01-06T22:29:10.470
> 
> 标签：actionscript-3, crossdomain.xml

是否可以使用用于 Flash/AS3 的跨域策略文件来指定黑名单？即允许除了列出的所有URL？到目前为止，我只将它与白名单一起使用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T22:54:10.980

该[规范](http://www.adobe.com/devnet-docs/acrobatetk/tools/AppSec/CrossDomain_PolicyFile_Specification.pdf)似乎只支持白名单；所有设置的形式都是“允许访问来自”，而不是“拒绝访问来自”。

# c# - UDP 上的 Windows Phone 摄像头馈送“非常”慢

> ID：14187487
> 
> 赞同：5
> 
> 时间：2013-01-06T22:29:18.690
> 
> 标签：c#, udp, windows-phone-7.1, asyncsocket

我一直在从事一个私人项目，我想学习如何在 Windows 手机上编程，有一次我开始摆弄插座和摄像头，一个好主意浮现在脑海中的视频源（我什至想尝试）。

但现在我在这里，我有一些很好的东西，它就像一个魅力，但 Lumia 800 不能足够快地通过 for 循环。它每发送一个帧，让我们说 7-8 秒，我认为这很奇怪，因为它应该足够强大。感觉和看起来就像在没有色情片的 56k 调制解调器上观看色情片。

我还意识到一帧是 317000 像素，每帧总计大约 1MB 我还发送 xy 坐标，所以我的每帧占用 2.3MB 仍然在以不同的方式解决这个问题以保持它下来。所以我猜我需要做圆顶魔术才能使位置和像素值都达到可接受的大小。因为 atm 我会以可接受的速度将其启动，因此至少需要 60MB/s 才能获得 30fps 之类的速度，但那是另一天的问题。

```
//How many pixels to send per burst (1000 seems to be the best)
    const int PixelPerSend = 1000;
    int bSize = 7 * PixelPerSend;
    //Comunication thread UDP feed   
    private void EthernetComUDP() //Runs in own thread
    {
        //Connect to Server
        clientUDP = new SocketClientUDP();
        int[] ImageContent = new int[(int)cam.PreviewResolution.Height *   (int)cam.PreviewResolution.Width];
        byte[] PacketContent = new byte[bSize];
        string Pixel,l;
        while (SendingData)
        {
            cam.GetPreviewBufferArgb32(ImageContent);
            int x = 1, y = 1, SenderCount = 0;
            //In dire need of a speedup
            for (int a = 0; a < ImageContent.Length; a++) //this loop
            {
                Pixel = Convert.ToString(ImageContent[a], 2).PadLeft(32, '0');

                //A - removed to conserve bandwidth
                //PacketContent[SenderCount] = Convert.ToByte(Pixel.Substring(0, 8), 2);//0
                //R
                PacketContent[SenderCount] = Convert.ToByte(Pixel.Substring(8, 8), 2);//8
                //G
                PacketContent[SenderCount + 1] = Convert.ToByte(Pixel.Substring(16, 8), 2);//16
                //B
                PacketContent[SenderCount + 2] = Convert.ToByte(Pixel.Substring(24, 8), 2);//24

                //Coordinates
                //X
                l = Convert.ToString(x, 2).PadLeft(16, '0');
                //X bit(1-8)
                PacketContent[SenderCount + 3] = Convert.ToByte(l.Substring(0, 8), 2);
                //X bit(9-16)
                PacketContent[SenderCount + 4] = Convert.ToByte(l.Substring(8, 8), 2);

                //Y
                l = Convert.ToString(y, 2).PadLeft(16, '0');
                //Y bit(1-8)
                PacketContent[SenderCount + 5] = Convert.ToByte(l.Substring(0, 8), 2);
                //Y bit(9-16)
                PacketContent[SenderCount + 6] = Convert.ToByte(l.Substring(8, 8), 2);

                x++;
                if (x == cam.PreviewResolution.Width)
                {
                    y++;
                    x = 1;
                }

                SenderCount += 7;
                if (SenderCount == bSize)
                {
                    clientUDP.Send(ConnectToIP, PORT + 1, PacketContent);
                    SenderCount = 0;
                }
            }
        }
        //Close on finish
        clientUDP.Close();
    } 
```

为了简单起见，我尝试使用单独发送像素

```
BitConverter.GetBytes(ImageContent[a]); 
```

而不是我创建的字符串解析混乱（要修复只是想要一个概念证明）但是做简单的 BitConverter 并没有加快速度。

所以现在我的最后一个想法是 UDP 发送方套接字女巫与 msdn 库中的那个大致相同。

```
 public string Send(string serverName, int portNumber, byte[] payload)
    {
        string response = "Operation Timeout";
        // We are re-using the _socket object that was initialized in the Connect method
        if (_socket != null)
        {
            // Create SocketAsyncEventArgs context object
            SocketAsyncEventArgs socketEventArg = new SocketAsyncEventArgs();
            // Set properties on context object
            socketEventArg.RemoteEndPoint = new DnsEndPoint(serverName, portNumber);
            // Inline event handler for the Completed event.
            // Note: This event handler was implemented inline in order to make this method self-contained.
            socketEventArg.Completed += new EventHandler<SocketAsyncEventArgs>(delegate(object s, SocketAsyncEventArgs e)
            {
                response = e.SocketError.ToString();
                // Unblock the UI thread
                _clientDone.Set();
            });
            socketEventArg.SetBuffer(payload, 0, payload.Length);
            // Sets the state of the event to nonsignaled, causing threads to block
            _clientDone.Reset();
            // Make an asynchronous Send request over the socket
            _socket.SendToAsync(socketEventArg);
            // Block the UI thread for a maximum of TIMEOUT_MILLISECONDS milliseconds.
            // If no response comes back within this time then proceed
            _clientDone.WaitOne(TIMEOUT_MILLISECONDS);
        }
        else
        {
            response = "Socket is not initialized";
        }
        return response;
    } 
```

总而言之，我最终得到了 3 个解决方案

1.  接受失败（但这不会发生，所以让我们看看 2）

2.  减少发送的数据量（破坏质量 640x480 我认为足够小）

3.  找到明显的问题（谷歌和朋友的好主意用完了，这就是我在这里的原因）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T00:03:34.617

几乎可以肯定，问题在于数据的混乱。将 1 兆字节的二进制数据转换为数兆字节的文本，然后提取和发送单个字符将增加每字节源数据的大量开销。循环遍历单个像素以构建发送缓冲区将需要（相对而言）地质时间尺度。

最快的方法可能是从相机中获取二进制数据的缓冲区，并通过一次 UDP 写入发送它。仅在必要时处理或分解手机上的数据，并小心直接访问原始二进制数据 - 不要将其全部转换为字符串然后再转换回二进制。您添加到此过程中的每个额外方法调用只会增加开销。如果您必须使用循环，请尝试在循环外尽可能多地进行预计算，以最大限度地减少每次迭代所做的工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T22:59:56.567

我想到了几件事：#1 将原始图像数组分解成几块以通过网络发送。不确定 Linq 在 Windows Phone 上是否可用，但类似[这样](https://stackoverflow.com/questions/1008785/c-cleanest-way-to-divide-a-string-array-into-n-instances-n-items-long)。
#2 由于处理时间和内存使用情况，从 to 转换`int`到`string`to`byte`将非常低效。更好的方法是将`int`数组的块`byte`直接批量复制到数组中。[例子](https://stackoverflow.com/questions/5896680/int-array-to-byte-array)

# html - 更改当前导航项

> ID：14187488
> 
> 赞同：0
> 
> 时间：2013-01-06T22:29:22.963
> 
> 标签：html, asp.net-mvc-4

我试图更改我的 ASP.Net MVC 4 项目中的导航项。我找到了一些示例，但它们不适用于需要的菜单方式（请参阅代码）：

```
 <nav>
        <ul>
            <li>
                <a href="/StartMenu/Index" class="current" title="Dashboard">
                    <i class="icon-map-marker"></i>
                    Dashboard
                </a>
            </li>

            <li>
                <a href="/StartMenu/Forms" title="Forms Stuff">
                    <i class="icon-edit"></i>
                    Forms Stuff
                </a>
            </li> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T22:40:53.283

如果您要做的只是确保单击的最后一个链接有`class="current"`您可以执行此操作

```
$("a").click(function() {
  $("a").removeClass("current");
  $(this).addClass("current");
}) 
```

# android - Android中的平等废话

> ID：14187492
> 
> 赞同：0
> 
> 时间：2013-01-06T22:29:52.583
> 
> 标签：android, database, equality, http-get

问题是我希望我从网页调用`grabURL`中读取的文本绝对等于我`String lorem`在`onPostExecute`.

但安卓说：“不，它没有！”

为什么我认为 Android 在平等方面不正确？

1）堆栈跟踪截图：

![堆栈跟踪](../Images/0433c57e1b6f35b5231d5b01f53b993e.png)

2) 截图：

![不等于](../Images/78836a5659c9a695a9b3b126af08aaf7.png)

3）您可以`String lorem = "Lorem ipsum dolor sit amet";`在我的课堂上找到向下，并查看我正在阅读的网页的源代码：

![源代码](../Images/2f7c23d16aa11d76521d3b103dcc29f0.png)

我的课程的源代码：

```
public class MainActivity extends Activity {
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        grabURL("http://www.cyberweb.pp.ua/x/o.html");

    }

    public void grabURL(String url) {
        new GrabURL().execute(url);
    }

    private class GrabURL extends AsyncTask<String, Void, Void> {
        private final HttpClient Client = new DefaultHttpClient();
        private String Content;
        private String Error = null;

        protected Void doInBackground(String... urls) {
            try {

                HttpGet httpget = new HttpGet(urls[0]);
                ResponseHandler<String> responseHandler = new BasicResponseHandler();
                Content = Client.execute(httpget, responseHandler);

            } catch (ClientProtocolException e) {
                Error = e.getMessage();
                cancel(true);
            } catch (IOException e) {
                Error = e.getMessage();
                cancel(true);
            }

            return null;
        }

        protected void onPostExecute(Void unused) {

            String lorem = "Lorem ipsum dolor sit amet";

            if (Error != null) {
                Toast.makeText(MainActivity.this, Error, Toast.LENGTH_LONG)
                        .show();
            } else {

                TextView xyu = (TextView) findViewById(R.id.xyu);
                TextView xyu1 = (TextView) findViewById(R.id.xyu1);
                TextView xyu2 = (TextView) findViewById(R.id.xyu2);

                xyu.setText(Content);
                xyu1.setText(lorem);

                Log.v("lorem", lorem);
                Log.v("Content", Content);

                String eq = null;

                if (Content.length() != lorem.length()) {
                       Log.v("length?", "Different length");
                    }

                if (Content.trim().equalsIgnoreCase(lorem.trim())) {

                    xyu2.setText("EQUAL");
                    eq = "EQUAL";
                    Log.v("equal?", eq);
                }

                else {

                    xyu2.setText("NOT EQUAL");
                    eq = "NOT EQUAL";
                    Log.v("equal?", eq);
                }

            }
        }

    }
} 
```

这个问题快把我逼疯了。

Сan有人猜会发生什么？先感谢您！

最后的堆栈跟踪：

![在此处输入图像描述](../Images/fdbc44ab32070ab07005f9450cfc94f4.png)

**该问题是由网页编码引起的。将编码更改为 时，相等是正确的** `UTF-8`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T22:32:06.750

您不能使用`==`Java 中的比较字符串。使用`equals()`.

这里的答案非常详细地描述*了原因*：[如何比较 Java 中的字符串？](https://stackoverflow.com/q/513832/1267661)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-06T22:44:17.133

也尝试比较长度：

```
final int cl = Content.length();
final int ll = lorem.length();
if (cl != ll) {
   Log.v("TAG", "Different length (Content=" + cl + ", lorem=" + ll + ")");
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-06T22:31:52.370

不要`==`用于字符串比较。

相反`.equals()`，它实际上会检查每个字符串的内容并返回正确的结果。

```
if (Content.equals(lorem)) {
    //etc... 
```

编辑：如果你仍然没有得到平等，你可以试试这个：

```
if (Content.trim().equalsIgnoreCase(lorem.trim())) {
        //etc... 
```

这会修剪所有空白*并*执行检查，而不考虑大小写。检查两个字符串是您最多可以做的。

# android - 为什么 Android Eclipse 项目不会更新图形？

> ID：14187497
> 
> 赞同：1
> 
> 时间：2013-01-06T22:30:40.107
> 
> 标签：android, nine-patch

经过一个月的开发，我的项目突然决定拒绝更新我的按钮图形。我把我现有的 9patch 按钮调亮了一点，保存了它，现在它不会在我的设备上更新。Eclipse 显示新图形（最终），但设备再现是旧按钮。我必须手动清理，但这样做我的 9patch 已损坏且无法扩展。我已经阅读[了我的 9 Patch Image 停止工作](https://stackoverflow.com/questions/7934689/my-9-patch-image-stopped-working)并包含了 jar，但我尝试更改的 9patch 仍然不会在我的设备上更新，或者它更新为带有黑色 9patch 标记的标准固定大小图像。如果我从资源中删除 9patch 并用另一个按钮替换它，它就可以工作。

基本上，就好像我的项目变得虚伪了。我反复使用过 Clean... 和资源 Refresh，但效果不佳。一旦它甚至说我在清理后手动编辑了 R.java 文件......我可以做一些超级清理重置的事情吗？

tldr; 当我更改图形时，新图形不会在设备上更新。我使用刷新和项目/清理，但这打破了 9patch。怎么了？

# javascript - onclick() javascript 属性与复选框保持一致

> ID：14187501
> 
> 赞同：1
> 
> 时间：2013-01-06T22:31:05.413
> 
> 标签：javascript, html, onclick

我在这里有一个非常简单的 javascript 程序，它可以在单击时更改另一个图像的图像以显示它已被选中，但是我似乎无法使其与我的复选框保持同步，有时它会不同步并导致我的 php 表单有问题

代码：

```
<script type="text/javascript">
function func()
{
    var img1= document.getElementById("img1");

    if(img1.name == "on")
    {
        img1.src = "images/" + "img1a.jpg";
        img1.name = "off";
    }
    else
    {
        img1.src = "images/" + "img1.jpg";
        img1.name = "on";
    }
}
</script>

</head>

<body>
<form>
<p align="center">
<input type="checkbox" name="interest1" id="interest1" value="x">
<input type="checkbox" name="interest2" id="interest2" value="x">
<input type="checkbox" name="interest3" id="interest3" value="x"></p>   
<p align="center">
<label for="interest1" id="label-interest1"><img src="images/img1.jpg" width="781" height="800" onclick="func()" id="img1" /></label>
<label for="interest2" id="label-interest2"><img src="/images/img2.jpg" width="781" height="800" /></label>
<label for="interest3" id="label-interest3"><img src="/images/img3.jpg" width="781" height="800" /></label></P><!-- code making checkbox be an image-->
</form> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T23:07:48.380

`if(img1.name == "on")`您可以检查`checkbox.checked`相应复选框的状态，而不是检查。

**编辑：**对于踢腿和咯咯笑，这是一个使用 jQuery的[jsFiddle示例。](http://jsfiddle.net/m3C6e/2/)

# php - 在每个月的开始/结束时显示占位符空间的日历（月中的某天、周中的某天）

> ID：14187503
> 
> 赞同：0
> 
> 时间：2013-01-06T22:31:23.837
> 
> 标签：php, mysql, calendar

我在 mySQL 表中设置了一个日历，我试图通过月历（1 月、2 月、3 月）输出日期，这些日历说明了前几个月和下个月的“缺失天数”。

因此，如果我想为 2013 年 1 月制作日历，而 1 月 1 日是星期二——我很难编写一种方法来显示 12 月 30 日星期日和 12 月 31 日星期一充当“空间填充物”或你有什么...... 。 明白我的意思了吗？

我很难弄清楚如何输出这些信息。

数据结构和数据如下：

表名：`sched_calendar_table`

```
dt  y   q   m   d   dw  monthName   dayName w   isWeekday   isHoliday   holidayDescr    isPayday
2010-01-01  2010    1   1   1   6   January Friday  0   1   1   New Year's Day  0
2010-01-02  2010    1   1   2   7   January Saturday    0   0   0       0
2010-01-03  2010    1   1   3   1   January Sunday  1   0   0       0
2010-01-04  2010    1   1   4   2   January Monday  1   1   0       0
2010-01-05  2010    1   1   5   3   January Tuesday 1   1   0       0 
```

我计划使用表格创建每个月历。

所以代码的初始部分是：

```
echo '<table>';
$sql="SELECT * FROM sched_calendar_table WHERE y=2013";
$result=mysql_query($sql);
while($row=mysql_query($result)){
 echo '<tr><td>'; // .. unsure how to account for the placeholder days that aren't part of the month being displayed... how to do this?
}
echo '</table>'; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T23:00:16.770

快速函数，按周返回所有日期，从星期一开始，以星期日结束（即使日期来自月后/月前）。

```
function getWeekDays($month, $year)
{
    $dFrom = new DateTime("$year-$month-01");
    $dTo = clone $dFrom;
    if (($N = $dFrom->format('N')) > 1) {
        $dFrom->modify('-' . ($N - 1) . ' day');
    }
    $dTo->add(new DateInterval('P1M'));
    if (($N = $dTo->format('N')) < 7) {
        $dTo->modify((8 - $N) . ' day');
    }

    $p = new DatePeriod($dFrom, new DateInterval('P1D'), $dTo);

    $datesByWeek = array();
    foreach ($p as $d) {
        $datesByWeek[ $d->format('W') ][] = $d;
    }
    return $datesByWeek;
} 
```

例子：

```
print_r( getWeekDays(1, 2013) ); 
```

现在你有了代表当前月份的所有日期，所以你可以做数据库魔术......

如何从此数据中输出表格，请参阅 >[查找一个月的每周期间（从星期一开始）](https://stackoverflow.com/questions/12317909/find-weekly-periods-starting-on-a-monday-for-a-month/12324474#12324474)

# javascript - 如何在 Ember.js 中手动更新视图？

> ID：14187505
> 
> 赞同：8
> 
> 时间：2013-01-06T22:31:35.090
> 
> 标签：javascript, ember.js

我在我的应用程序中使用 Ember.js，但是有一点我更新了视图上下文（控制器）的属性，但是在更新之后，有一个解析器（MathJax）查看要解析的更新字段的 dom把它变成数学。然而，即使更新正在发生，它也会发生在 mathjax 查找更新之后。我需要做的是强制 ember 更新视图或等待 ember 更新，然后我告诉 mathjax 解析 html。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-07T03:15:09.390

这是一个相当常见的用例。要指定应在属性更改传播后执行的代码，请使用观察者。Ember 在成功传播更改后触发观察者。例如：

```
App.MathView = Ember.View.extend({
  controller: null,
  template: Ember.Handlebars.compile("<div>{{myProperty}}</div>"),

  myPropertyDidChange: function() {
    // From here the controller value is changed but DOM has not been updated
    Ember.run.next(this, function() {
      // This code will run when after changes have propagated to the DOM 
      // Call MathJax parser here
      // If needed you can access the view's DOM element via this.$()
      alert("New property value is in dom: "+  this.$().text());
    });
  }.observes('controller.myProperty')
}); 
```

请参阅 Ember 管理异步指南和 Ember.run 的 API 文档：http: //emberjs.com/guides/understanding-ember/managing-asynchrony/ [http://emberjs.com/api/classes/Ember.run.html](http://emberjs.com/guides/understanding-ember/managing-asynchrony/) #method_next

# drupal - Drupal 7.18：避免使用多语言造成的重复内容？

> ID：14187510
> 
> 赞同：0
> 
> 时间：2013-01-06T22:32:05.833
> 
> 标签：drupal

我有一个 Drupal 项目。

*   我正在使用 Drupal 7.18。
*   我创建了一个名为“Popularity”的分类法，它有 3 个元素：Popular、New、Most Rated。
*   我在 drupal 中添加了第二种语言，
*   我将我的分类法翻译成第二语言。例如，它是“土耳其语”。
*   我创建了一个包含与该分类相关的字段的内容。假设它是“C编程”。
*   我在相关领域选择了“新”分类项目。
    *   之后，我将刚刚创建的内容翻译成土耳其语，
*   现在我有两个内容，但它们是相互翻译的形式。

无论如何，英文内容中的名称“New”变成了土耳其内容中的“Yeni”。我的问题是，当我创建一个显示“New”或“Yeni”内容的视图时，我在表中看到两个内容，但我想要仅查看与网站当前语言具有相同语言的内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T18:06:58.337

将`Content: Language`过滤器添加到您的视图中，设置为`Current user's language`.

# ruby-on-rails-3 - destroy 与 destroy_all

> ID：14187513
> 
> 赞同：5
> 
> 时间：2013-01-06T22:32:20.557
> 
> 标签：ruby-on-rails-3, activerecord

我需要知道何时使用`:dependent => :destroy_all`以及何时使用`:dependent => :destroy`

如果我的模型 has_many 子模型并且我使用了会发生`:dependent => :destroy`什么？它只会破坏第一个子模型吗？

这行代码错了吗：

```
has_many books, :dependent => :destroy 
```

会是这样吗：

```
has_many books, :dependent => :destroy_all 
```

?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-08T00:39:10.767

这会毁掉所有的书。他们全部。

```
has_many books, :dependent => :destroy 
```

要记住的重要一点是，这`:dependent => :destroy`将导致`#destroy`在每一本关联的书中调用该方法。通过调用每本书，将为每本书执行`#destroy`任何`before_destroy`或回调。`after_destroy`

自然，如果您有很多相关书籍，则此过程可能会很昂贵。

无效，也许你在`:destroy_all`想`:delete_all`. 与`:delete_all`( 而不是`:destroy`) 的不同之处在于 Rails 将发出一条 SQL 语句来删除所有相关的书籍记录。不会`#destroy`对任何 Book 记录调用任何方法，并且不会执行`before_destroy`或`after_destroy`回调。

好处是单个 SQL 语句从数据库中删除记录的效率比调用`#destroy`每条记录的效率高很多倍。

了解这一点非常重要。如果您`*_destroy`在 Book 模型上有任何回调，您应该知道定义`:dependent => :delete_all`将具有忽略您在 Book 模型上定义的任何回调的效果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T00:22:11.190

我很确定第一行是正确的，第二行是不正确的。

这是文档中特定部分的链接：

[http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html#method-i-has_many-label-Options](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html#method-i-has_many-label-Options)

我的理解是，`:dependent`它将遍历关联并调用给定的函数，这意味着要调用的函数`:destroy`是正确的。（`:destroy_all`仅对收藏有效。）

我希望这会有所帮助。

# c - inet_aton 转换 010.000.000.001 错误？

> ID：14187515
> 
> 赞同：7
> 
> 时间：2013-01-06T22:32:29.900
> 
> 标签：c, sockets, inet-aton

我在`inet_aton`转换网络地址时遇到问题。下面的代码可以很好地转换地址`10.0.0.1`

```
char *x1;
struct sockaddr_in si_other;
inet_aton("10.0.0.1", &si_other.sin_addr);
printf("si_other.sin_addr =%lu\n",si_other.sin_addr);
x1 = inet_ntoa(si_other.sin_addr);
printf("x1=%s\n",x1); 
```

它输出：

```
si_other.sin_addr =16777226
x1=10.0.0.01 
```

到目前为止没有问题。`010.000.000.001`但是，该函数在传递时工作起来很奇怪

```
char *x2;
struct sockaddr_in si_other2;
inet_aton("010.000.000.001", &si_other2.sin_addr);
printf("si_other2.sin_addr =%lu\n",si_other2.sin_addr);
x2 = inet_ntoa(si_other2.sin_addr);
printf("x2=%s\n",x2); 
```

输出：

```
si_other.sin_addr2 =16777224
x2=8.0.0.01 
```

该函数在`192.168.0.1`和`192.168.000.001`被传递时工作正常。

谁能解释我是什么问题以及如何解决问题？（注意：我需要`010.000.000.001`在我的代码中传递 IP 地址）

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-06T22:35:07.227

前导 0 被[解释为表示数字是八进制的](http://en.wikipedia.org/wiki/Dot-decimal_notation#Caveat)。010（八月）== 8（十二月）。您需要修改输入以`inet_aton`避免这种情况，或者以不同的方式自行转换。

```
const char *str = "010.000.000.001";
inet_aton(str[0] == '0' ? str+1:str, &si_other.sin_addr); 
```

是最简单的解决方案，但最好先修复任何（`snprintf`？）产生字符串以避免混淆。

（就目前而言，该解决方案仍不适用于许多边缘情况，包括“001.0.0.1”、“0xF.0.0.1”、“1”和更多有效的 IPv4 地址）。

您可以使用 简单地“规范化”您的输入`sscanf`，即使您一开始就无法控制它的生成方式（尽管在我看来，这确实应该是一个错误）：

```
#include <stdio.h>
#include <stdlib.h>

int main() {
  const char *str="010.020.030.040";
  int parts[4];
  sscanf(str, "%d.%d.%d.%d", parts+0, parts+1, parts+2, parts+3);
  char *out = NULL;
  asprintf(&out, "%d.%d.%d.%d", parts[0], parts[1], parts[2], parts[3]);
  printf("%s\n", out);
  free(out);
  return 0;
} 
```

# css - 在CSS中的repeat-y上翻转背景图像

> ID：14187516
> 
> 赞同：2
> 
> 时间：2013-01-06T22:32:42.227
> 
> 标签：css

我有一个渐变图像作为我的网站的背景，我在使它在所有页面大小下看起来都正确时遇到了问题。图像是 291x1080，我让它做一个重复-x。这适用于所有不大于 1080p 的页面。但是，对于内容较多的页面或分辨率大于 1080p 的屏幕，背景后面会出现一个空白。我不想做一个简单的repeat-y，因为没有过渡的从浅到深的渐变会很奇怪。有没有办法在每次使用 CSS 进行重复时翻转背景图像？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T22:46:57.457

我的建议：有织物纹理和渐变，而不是图像。

例如：

```
body{
     background-image: url("/static/img/background.png") repeat, linear-gradient(top, #000000, #123456);
} 
```

您应该确保添加浏览器支持标签（-webkit 等）

如需进一步参考，请查看以下内容： [如何在同一元素上组合背景图像和 CSS3 渐变？](https://stackoverflow.com/questions/2504071/is-it-possible-to-combine-a-background-image-and-css3-gradients)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T22:47:10.673

这是执行此操作的 css：

```
body {
    ...
    background: #eeeeee url("/static/img/background.png") 0 0 repeat-x;
    ...
} 
```

# ruby-on-rails - Rails 中的 Foregin 键关系

> ID：14187517
> 
> 赞同：0
> 
> 时间：2013-01-06T22:32:47.970
> 
> 标签：ruby-on-rails

没有在 Rails 中更新的外键存在问题。

我有一个包含 3 个模型的应用程序。

用户、评论和评论。

用户有很多评论，评论有很多评论。当我添加新评论时，我想将 User_id 和 Review_id 添加到评论表中。

评论是从表单传递的。我在以下语句中更新了 user_id

```
 @comment = current_user.comments.build(params[:comment]) in the comment controller 
```

除了作为foregin键的reviews_id之外，所有内容都被插入到评论表中。据我了解，这将通过模型中的关联自动完成。不是这种情况还是我的模型中缺少某些东西。

用户模型

```
 class User < ActiveRecord::Base
    attr_accessible :email, :name, :password, :password_confirmation
    has_secure_password

    has_many :microposts, dependent: :destroy
    has_many :reviews, dependent: :destroy
    has_many :comments, dependent: :destroy 

    end 
```

评论模型

```
 class Review < ActiveRecord::Base
    attr_accessible :review_text, :tumb_up_down, :rating, :name
belongs_to :user
    has_many :comments, dependent: :destroy 
```

评论模型

```
 class Comment < ActiveRecord::Base
attr_accessible :comments, :review_id, :user_id
belongs_to :reviews 
```

评论控制器代码

```
 def create
    @comment = current_user.comments.build(params[:comment])

   if @comment.save
         redirect_to 'static_pages/home' #{:action => 'show', :id } 
    else
   redirect_to 'static_pages/home'
end 
```

结尾

最后是传递值的形式。我是否应该在其中包括 review_id。

```
 <div class="field">
    <%= form_for(@comment) do |f| %>
    <%= render 'shared/error_messages', object: f.object %>

<%= f.label :comments %>
    <%= f.text_area :comments, placeholder: "Add your words of wisdom" %>

    </div>
    <%= f.submit "Add", class: "btn btn-large btn-primary" %>
    <% end %> 
```

# javascript - 在旧浏览器中显示表情符号

> ID：14187520
> 
> 赞同：0
> 
> 时间：2013-01-06T22:33:03.513
> 
> 标签：javascript, unicode

假设我的网站中有一些特殊字符，例如 ,。不幸的是，尽管像这样的图标非常有用，但它们并不适用于所有浏览器。

对于那些没有出现在其中的浏览器，我有哪些选择？是否可以使用 JavaScript 将它们替换为更友好的东西，例如**+**号？我可以以某种方式破解网站以加载其他字符集吗？我显然可以使用图像，但就目前而言，如果可以的话，我宁愿避免这种情况——我希望它与周围的文本颜色相匹配，并且该文本可能会发生变化。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T23:15:05.983

“” U+1F44D 竖起大拇指等特殊字符大多不起作用。这主要不取决于浏览器，而是取决于字体：很少有字体包含此类字符，您不能指望 Joe Q. Public 的计算机包含其中任何一个。在实践中，例如 U+1F44D 可以在 Segoe UI Symbol（可能预装在最新的 Windows 系统中）和 Symbola（需要用户下载的免费字体）中找到。有关一般性，请参阅我[在 HTML 中使用特殊字符的指南](http://www.cs.tut.fi/~jkorpela/html/characters.html)。

当然可以使用 JavaScript 将特殊字符替换为其他字符，但没有简单的方法来决定何时需要这样做。这样做总是会使使用特殊字符毫无意义。检查系统是否具有包含字符的字体很棘手。– 请注意，在 JavaScript 中使用像 U+1F44D 这样的字符需要小心，因为它是一个非 BMP 字符，并且对应于JavaScript 字符串的*两个*连续组件，即高代理代码单元和低代理代码单元。

使用图像是一种自然的选择，尽管它需要小心（图像应该足够大并且按比例缩小以匹配文本字体大小）。而且你需要为不同的文本颜色提供不同的图像，因为 CSS 缺乏用于为图像着色的实用工具，恐怕。

您可以通过`@font-face`. 在 U+1F44D 的情况下，Symbola 似乎是唯一的选择。它相当大，但这些天可能不会太大。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-09T04:30:54.040

您应该包含一个支持您要使用的表情符号字符的网络字体。

要在 CSS 中包含图标字体，请使用以下代码：

```
@font-face {
    font-family: 'myfont';
    src:url('fonts/myfont.eot?-td2xif');
    src:url('fonts/myfont.eot?#iefix-td2xif') format('embedded-opentype'),
        url('fonts/myfont.woff?-td2xif') format('woff'),
        url('fonts/myfont.ttf?-td2xif') format('truetype'),
        url('fonts/myfont.svg?-td2xif#myfont') format('svg');
    // Different URLs are required for optimal browser support
    // Make sure to :
    // 1) replace the URLs with your font's URLs
    // 2) replace `#myfont` with the name of your font
    font-weight: normal; // To avoid the font inherits boldness
    font-style: normal; // To avoid font inherits obliqueness or italic
}

.emoji {
    font-family: 'myfont', Verdana, Arial, sans-serif; // Use regular fonts as fallback
    speak: none; // To avoid screen readers trying to read the content
    font-style: normal; // To avoid font inherits obliqueness or italic
    font-weight: normal; // To avoid the font inherits boldness
    font-variant: normal; // To avoid the font inherits small-caps
    text-transform: none; // To avoid the font inherits capitalization/uppercase/lowercase
    line-height: 1; // To avoid the font inherits an undesired line-height
    -webkit-font-smoothing: antialiased; // For improved readability on Webkit
    -moz-osx-font-smoothing: grayscale; // For improved readability on OSX + Mozilla
} 
```

然后，您可以像这样包含您的符号：

```
<span class="icon">&#128077;</span> 
```

如果您不知道支持您的角色的网络字体，您可以使用[**Icomoon 应用**](https://icomoon.io/app/#/select)轻松自己创建一个。另请参阅我的开源[**Emoji 图标字体**](https://github.com/jslegers/emoji-icon-font)，了解我使用 Icomoon 应用程序创建的支持 Emoji 字符的图标字体示例。

* * *

更多信息：

*   [**使用 Unicode 补充多语言平面符号创建 webfont**](https://stackoverflow.com/questions/19824628/create-webfont-with-unicode-supplementary-multilingual-plane-symbols/27410391#27410391)

# php - 使用 JavaScript 强制 Google Chrome POST/GET

> ID：14187524
> 
> 赞同：0
> 
> 时间：2013-01-06T22:33:30.923
> 
> 标签：php, javascript, google-chrome

我在这里交叉发布这个问题。几天后没有答案，我意识到核心问题可能更多是网络开发问题，而不是 Wordpress。

我原来的问题：[https ://wordpress.stackexchange.com/questions/78037/wp-click-track-plugin-help](https://wordpress.stackexchange.com/questions/78037/wp-click-track-plugin-help)

细节：

（注意：wordpress 插件开发者已经承认放弃了这个插件，所以我一个人。）

插件位置：[http](http://wordpress.org/extend/plugins/wp-click-track/) ://wordpress.org/extend/plugins/wp-click-track/ 插件内有问题的文件：ajax.js 和 click-tracker.php

几年来我一直在使用 WP-Click-Track 插件，效果很好。该插件的基础是`a href's`在帖子中找到，并用一点javascript重写它们。当用户单击链接时，javascript 向插件报告，插件将链接、标题和计数保存到 MySQL 表中。很直接。

即使经过几年的未开发，该插件仍然可以在 Firefox 和 IE 上很好地工作。然而，似乎在最新一轮 Chrome 更新中，插件不会跟踪它们，除非链接（内部或外部）包含`target="_blank"`. 这对于面向外部的链接很好，但我不想在新窗口中打开内部链接。这对用户来说很烦人。

我可以在 JavaScript 中看到插件要求浏览器执行`POST`for `XMLHttpRequest`，但在查看我的 Apache 日志后，Chrome 似乎正在执行`GET`不包含`target="_blank"`.

*这就是我认为 stackoverflow 的用武之地：*有没有办法（通过另一个 JavaScript 小程序？）强制 Chrome 始终执行 POST 以便跟踪这些链接？

# web-services - 在基于互联网的面向服务的计算中，将接口与实现分离的价值是什么？

> ID：14187529
> 
> 赞同：3
> 
> 时间：2013-01-06T22:34:17.737
> 
> 标签：web-services, soap, interface, wsdl, uddi

原因是否像普通的多模块应用程序编程那样 - 所以客户端可以只使用接口而不必担心实现细节？

请注意，我说的是 WSDI/UDDI/SOAP，而不是普通的应用程序接口。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T17:29:57.843

WSDL 具有[抽象部分和具体部分](http://en.wikipedia.org/wiki/File:WSDL_11vs20.png)，它们是分开的，以允许重用这些定义。同一个合约可以绑定到许多具体的网络协议和消息格式。

这种定义的重用，在[UDDI](http://en.wikipedia.org/wiki/Universal_Description_Discovery_and_Integration)的上下文中 意味着**一个接口，多个实现。**

UDDI 的一个想法是可以在运行时发现所需的 Web 服务。您可以进入注册表并查找某个 WSDL 契约的实现：

> **超越食谱：接口和实现**
> 
> [...]
> 
> 如果三个不同的公司实现了相同的 WSDL 文件，并且一个客户端软件为该 WSDL 接口创建了代理/存根代码，那么客户端软件可以使用相同的代码库与所有这三个实现进行通信
> 
> [...]
> 
> *   [http://www2.sys-con.com/itsg/virtualcd/webservices/archives/0103/januszewski/index.html](http://www2.sys-con.com/itsg/virtualcd/webservices/archives/0103/januszewski/index.html)

至少那是理论。[在实践中它变成了另一种方式](https://stackoverflow.com/questions/1525045/is-the-public-uddi-movement-dead-or-was-it-ever-alive)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T22:48:57.093

简短的回答是没有。当您通过 WSDL 发布 Web 服务时，您如何实现它并不重要。使用您的服务的客户端应用程序将从 WSDL 生成适当的代码，无论您是否为后端 Web 服务定义了接口。也就是说，在 Web 服务前面添加一个接口是相当浪费时间的。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-06T22:55:45.623

尖头发的老板决定他希望应用程序以不同的方式工作，在不同的屏幕顺序中，因为：

1.  他在网球俱乐部的妻子朋友认为这样会更好。

2.  严格的用户测试表明基于不同的应用程序流程或使用步骤顺序的客户转化率更高。

3.  您想提供您网站的白标版本（类似于特许经营权）。

在上述情况下，只需要重写图形元素，这样做的人不需要了解任何关于数据库或复杂的后端数据处理的知识。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-06T22:59:17.443

分离接口和实现可帮助您保持设计松散耦合。随着需求的变化，您可以独立于接口更改实现。

# php - PHP没有从ajax接收formData对象

> ID：14187533
> 
> 赞同：3
> 
> 时间：2013-01-06T22:34:38.263
> 
> 标签：php, javascript, jquery, ajax

我正在测试向 PHP 发送一个 formData 对象（我正在关注[http://net.tutsplus.com/tutorials/javascript-ajax/uploading-files-with-ajax/](http://net.tutsplus.com/tutorials/javascript-ajax/uploading-files-with-ajax/)），但我很难将它从地面。首先，创建 formData 对象并填充：

```
var formdata = new FormData();
formdata.append('my_key','my_value'); 
```

然后我使用 jQuery 的 ajax 调用是：

```
 $.ajax({
     url: 'php_upload.php',
     type: 'POST',
     cache: false,
     data: formdata,
     processData: false,
     contentType: false,
     success: function (response) {
     console.log(response);
  }
  }); 
```

使用 php_upload.php 文件包含：

```
<?php
    echo $_FILES['my_key']['name'];
?> 
```

但是我在控制台中得到一个未定义的索引：my_key 错误。

任何人都知道我可能做错了什么？多年来一直在挠头。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-06T22:38:07.377

您还没有向 FormData 添加任何文件，只是一个可以通过`$_POST['my_key']`.

要传递文件，FormData.append 的第二个参数必须是 a[`FILE`](https://developer.mozilla.org/en-US/docs/DOM/File)或 a [`BLOB`](https://developer.mozilla.org/en-US/docs/DOM/blob)。

# html - 用词拖放

> ID：14187537
> 
> 赞同：4
> 
> 时间：2013-01-06T22:34:58.413
> 
> 标签：html, drag-and-drop

我怎么能修改下一个代码，做一个拖放的话？
这样当我选择句子的一个词时，我可以拖动

[http://jsbin.com/ejenub/1/edit](http://jsbin.com/ejenub/1/edit)

```
 <!DOCTYPE HTML>
<html>
<head>
<style type="text/css">
#div1 {width:350px;height:70px;padding:10px;border:1px solid #aaaaaa;}
#div2 {width:350px;height:70px;padding:10px;border:1px solid #aaaaaa;}
</style>
<script>
function allowDrop(ev)
{
ev.preventDefault();
}
function drag(ev)

{

ev.dataTransfer.setData("Text",ev.target.id);
}
function drop(ev)
{
ev.preventDefault();
var data=ev.dataTransfer.getData("Text");
ev.target.appendChild(document.getElementById(data));
}
</script>
</head>
<body>
verbs
<div id="div1" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
<br>
adjetives
<div id="div2" ondrop="drop(event)" ondragover="allowDrop(event)"></div>
<br>
<div id="drag1" draggable="true" ondragstart="drag(event)">I play the guitar</div>
<div id="drag2" draggable="true" ondragstart="drag(event)">The piano is black</div
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-06T23:04:05.333

所有单词都应包含在 span 或其他节点中，这里是工作示例，无需修改源 html ;) [http://jsbin.com/ejenub/3](http://jsbin.com/ejenub/3)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T22:51:26.640

您需要将每个单词包装在 HTML 元素中，例如`<span>`. [这是您的示例的修改版本](http://jsbin.com/ejenub/5/edit)，它显示了单词的拖放。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-06-05T17:57:15.410

我升级了这个：

*   您不能再将单词拖到其他单词中，而是将它们放在容器中它们的前面。
*   CSS 自动将第一个单词大写，在单词之间放置一个空格，并在末尾添加一个句点。
*   在此示例中，您要在两个句子内或两个句子之间移动单词。 [https://jsbin.com/hayizegisi/edit?html，输出](https://jsbin.com/hayizegisi/edit?html,output)

```
<!DOCTYPE HTML>
<html>
<head>
<style type="text/css">
  .container {width:350px;height:70px;padding:10px;border:1px solid #aaaaaa;}
  span {cursor: grabbing;}
  span::before {content:" "}
  span:first-child {text-transform:capitalize}
  span:first-child:before {content:""}
  span:last-child:after {content:"."}
</style>
<script>

  function allowDrop(ev)
  {
    ev.preventDefault();
  }

  function drag(ev)
  {
    ev.dataTransfer.setData("Text",ev.target.id);
  }

  function drop(ev)
  {
    console.log(ev)
    ev.preventDefault();
    var data=ev.dataTransfer.getData("Text");
    if (ev.target.classList.contains('container')) {
      var container = ev.target;
      container.appendChild(document.getElementById(data));
    } else {
      container = ev.target.parentElement;
      container.insertBefore(document.getElementById(data), ev.target);
    }
  }
/*  function insertAfter(newNode, referenceNode) {
    referenceNode.parentNode.insertBefore(newNode, referenceNode.nextSibling);
    }*/
</script>
</head>
<body>
  <div class='container' ondrop="drop(event)" ondragover="allowDrop(event)">
    <span id="word1" draggable="true" ondragstart="drag(event)">I</span>
    <span id="word2" draggable="true" ondragstart="drag(event)">play</span>
    <span id="word3" draggable="true" ondragstart="drag(event)">the</span>
    <span id="word4" draggable="true" ondragstart="drag(event)">guitar</span>
  </div>
  <div class='container' ondrop="drop(event)" ondragover="allowDrop(event)">
    <span id="word5" draggable="true" ondragstart="drag(event)">the</span>
    <span id="word6" draggable="true" ondragstart="drag(event)">piano</span>
    <span id="word7" draggable="true" ondragstart="drag(event)">is</span>
    <span id="word8" draggable="true" ondragstart="drag(event)">black</span>
  </div>
</body>
</html> 
```

# ios - UIScrollView 和故事板

> ID：14187542
> 
> 赞同：-1
> 
> 时间：2013-01-06T22:35:36.560
> 
> 标签：ios, xcode

所以我正在学习如何使用滚动视图，并且我已经成功地工作了一个。

使用 xib 文件时，使用滚动视图很容易，因为我可以在背景/工作区上放置滚动视图并设置大小，我希望标签和按钮如何放在它上面等等，然后当我准备好了，把整个东西移到我的视图上。

我目前正在处理的项目使用情节提要，因此我无法将滚动视图放在工作区上并正确调整大小和排列。

有解决方法吗？最好的方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T00:39:54.667

您只需将滚动视图添加到情节提要视图控制器的视图之一的视图中，然后您可以使用它执行与在 xib 文件中可以执行的相同的操作。此外，即使您的项目使用故事板，也没有理由不能拥有 xib 文件。

# jquery - 如何让 .each 在 JQuery 中传递 HTMLAnchorElement？

> ID：14187545
> 
> 赞同：0
> 
> 时间：2013-01-06T22:36:07.673
> 
> 标签：jquery

> **可能重复：**
> [为什么警报 AnchorElement (<a>) 会提醒 href 属性？](https://stackoverflow.com/questions/11076627/why-alert-anchorelement-a-alerts-the-href-attribute)

`.each`使用而不是 href 值时，是否可以让 JQuery 传递 HTMLAnchorElement 对象？[我在http://jsbin.com/welcome/70301/edit](http://jsbin.com/welcome/70301/edit)创建了一个演示。我希望它会弹出，`[object HTMLDivElement]`然后是`[object HTMLAnchorElement]`，但第二个弹出窗口显示的`http://twitter.com/js_bin`是锚元素的 href ( )。为什么？如何获得所需的行为？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T22:40:36.043

如果您登录到控制台而不是警报，则可以正常工作。ALert 不是用于元素的好工具，或者就此而言，一般来说，它不是调试的好工具。如果您不熟悉浏览器控制台，请搜索。将为您节省大量时间猜测代码中发生的事情

# c# - 如何在 C# 中为控制台写入行中的字符串保留一组字母

> ID：14187546
> 
> 赞同：6
> 
> 时间：2013-01-06T22:36:18.290
> 
> 标签：c#, console.writeline

好的，所以基本上我想要类似的东西

```
Console.WriteLine(
    "{0}:   {1}/{2}hp    {3}/{4}mp   {5}", 
    character.Identifier, 
    character.CurrentHealth, 
    character.MaxHealth,
    character.CurrentMagic, 
    character.MaxMagic, 
    character.Fatigue
    ); 
```

然后让 character.Identifier （基本上是一个名称）有一组字母，如果需要，它将用空格替换，以便可以打印

```
Josh:   20/20hp    20/20mp   3 
```

或者

```
J:      20/20hp    20/20mp   3 
```

但是 HP 然后 mp 和其他一切总是一致的。我知道它可能是 {0:} 之一，但我想不出一个有效的

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-06T22:40:33.353

符号中的第二个参数`{0}`可以为您提供一个固定宽度的字段，因此如果您希望标识符（名称）的长度始终为 10 个字符并且左对齐，您可以使用`{0,-10}`

MSDN 也是此类问题的一个很好的资源，如果您阅读[String.Format](http://msdn.microsoft.com/en-us/library/system.string.format.aspx)的文档，它有一个固定宽度表的示例，可能与您想要的类似。

此外，正如 Hogan 的回答正确指出的那样，`:`如果您希望它紧挨着名称，则必须将其附加到格式字符串之外的字符串。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-06T22:44:45.943

您可以使用以下方法用空格右填充字符串：

```
character.Identifier.PadRight(10); 
```

这应该给你你所追求的格式。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-06T22:43:36.880

我相信这会做你想要的：

```
const int colWidth = 10;
Console.WriteLine("{0,-"+colWidth.ToString()+"}{1,-"+colWidth.ToString()+"}{2,-"+colWidth.ToString()+"}{3}", 
    (character.Identifier+":").PadRight(colWidth+1).Remove(0,colWidth),
    (character.CurrentHealth+"/"+character.MaxHealth+"hp").PadRight(colWidth+1).Remove(0,colWidth),
    (character.CurrentMagic+"/"+character.MaxMagic+"mp").PadRight(colWidth+1).Remove(0,colWidth),
    (character.Fatigue,colWidth)); 
```

这将在字符串末尾添加空格，然后截断结果。
请参阅 String.Format 的文档

**笔记**

我将 附加`:`到格式字符串之外的名称，然后“合并” hp 和 mp 部分，然后将它们放在一个列中。

# python - GEvent PyWSGI SSL 非常缓慢

> ID：14187548
> 
> 赞同：4
> 
> 时间：2013-01-06T22:36:34.053
> 
> 标签：python, ssl, gevent

我正在使用`gevent.pywsgi`带有 SSL 的服务器，当使用 IE 或 Chrome 时，流量在内容大小的 10 倍到 100 倍之间，传输速度非常非常慢。Firefox 对此表示满意。如果我改用`stunnel`提供 SSL（具有相同的证书），一切正常。

我在这里做了一个独立的测试用例：http: [//dl.dropbox.com/u/7138409/Chrome-Test.zip](http://dl.dropbox.com/u/7138409/Chrome-Test.zip)

发生在 Python 2.6 和 2.7 以及不同的 gevent 版本上。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-02-10T16:57:30.023

这个错误的愚蠢是**压倒性**的。首先，我使用 Wireshark 剖析了流，令我惊讶的是，我看到响应的每个字节都在其自己的 SSL 段中传输。问题变成了我从我的 WSGI 处理程序返回原始字节串，而正确的方法是将它们返回包含在一个列表中！

这是一个工作示例：

```
import gevent
import gevent.pywsgi

ssl = {
    'certfile':  'ajenti.crt',
    'keyfile': 'ajenti.key',
    'ciphers': 'RC4',
}

def dispatch(env, s_r):
    s_r('200 OK', [('Content-Type', 'text/plain')])
    s = 'a' * 1000
    return [s]

server = gevent.pywsgi.WSGIServer(
    ('0.0.0.0', 8001),
    application=dispatch,
    **ssl
)

server.serve_forever() 
```

# c# - 实体框架检索导航属性

> ID：14187552
> 
> 赞同：2
> 
> 时间：2013-01-06T22:37:14.487
> 
> 标签：c#, asp.net, entity-framework, asp.net-mvc-4

我正在使用 EF 5，并且启用了延迟加载。当我从数据库中检索实体时，它工作得很好。

这是我的问题。我有一个通用存储库来执行数据库操作。

```
 public int Update(T t) //Update method implemented at repository layer
    {
        dbSet.Attach(t);
        context.Entry(t).State = EntityState.Modified;
        return context.SaveChanges();
    }

    public T Update(T t, int id) //This Method calls the above method to
    {
        if (Update(t) > 0)
        {
            //Now entity is updated so retrieve the entity from the database.
            return Get(id); //This line of code doesn't return entity with reference. It does return the updated entity.
        }
        return null;
    } 
```

现在，当我使用主键查询实体以获取更新的实体时，它给了我更新的实体，但是没有任何引用属性。我不能在这里使用延迟加载，因为它会引发异常。

更新实体后，我注意到 dbSet.Local 具有更新的实体。所以我在检索更新的实体之前尝试清除，但没有运气。我也尝试通过上下文重新加载实体，但它不会重新加载导航属性。我不能像使用通用存储库一样使用引用属性。我能完成的唯一方法是处理和创建上下文和数据库集的新实例。

我想返回填充了关系属性的更新实体。有没有人有好的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-15T04:22:06.770

> 我启用了延迟加载
> 
> 我正在附加 POCO 实体

我从您的评论中假设，在您的应用程序的某个地方，您正在像这样实例化您的实体，因此`new MyEntity()`延迟加载将不起作用，因为它不是代理 POCO。

考虑到您说您启用了延迟加载，最简单的方法是使用代理 POCO。那就是使用下面的来实例化一个实体，无论它在哪里：

```
MyEntity entity = MyContext.MyEntities.Create(); 
```

延迟加载应该适合你。如果您不想这样做或者这不起作用，那么最好的选择是从数据库中提取现有实体（作为动态代理）并从您的 POCO 中填充。因此，在您的存储库更新方法中：

**编辑**

我应该注意，也可以在不往返数据库的情况下执行此操作。看评论。

```
public T Update(T poco)
{
  //get the entity from db
  T proxyPoco = context.Set<T>().Find(id);

  //alternatively just create the proxy, set the id and attach.
  //no db retrieval.
  //T proxyPoco = context.Set<T>.Create();
  //proxyPoco.Id = poco.Id;
  //context.Set<T>.Attach(proxyPoco);

  if(proxyPoco == null) 
  {
    //throw an exception or handle case where the entity is not found.
    //unecessary if using alternative above.
  }
  else 
  {
    //set the proxy poco values using your original poco
    context.Entry<T>(proxyPoco).CurrentValues.SetValues(poco);
  }
  context.SaveChanges();
  return proxyPoco;
} 
```

因为您返回代理 POCO 延迟加载应该可以工作。其他不太理想的选择是：

1.  丢弃上下文并再次获取实体。
2.  使用反射显式加载该实体的引用和集合。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T22:42:13.683

SaveChanges 返回一个`int`. 你想要实体回来，试试这个：

```
public T Update(T t)
{
    dbSet.Attach(t);
    context.Entry(t).State = EntityState.Modified;
    context.SaveChanges();
    return t;
} 
```

# php - 是否可以在 Travis CI 中使用自定义变量？

> ID：14187555
> 
> 赞同：2
> 
> 时间：2013-01-06T22:37:44.910
> 
> 标签：php, testing, composer-php, travis-ci, packagist

我知道有一些默认变量可用于在不同环境下进行测试，例如（用于 PHP 项目）之类的`SYMFONY_VERSION`.

我的问题很简单：是否可以定义一个*自定义*变量，用于测试另一个包的一些特定版本（我依赖于它）？

我试过了：

```
env:
  - SYMFONY_VERSION=2.0.*
  - SYMFONY_VERSION=2.1.*
  - BUZZ_VERSION=0.6
  - BUZZ_VERSION=0.*

before_script:
  - composer require symfony/dependency-injection:${SYMFONY_VERSION} 
        kriswallsmith/buzz:${BUZZ_VERSION} 
```

但它不起作用，由于“未定义的索引”，我的构建失败：

![在此处输入图像描述](../Images/ea9c24ff4fb61bf2db641592486a4533.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T23:16:10.747

[http://about.travis-ci.org/docs/user/build-configuration/#Set-environment-variables](http://about.travis-ci.org/docs/user/build-configuration/#Set-environment-variables)

1.  您需要在一个构建中同时使用 symfony 和 Buzz，因此需要将它们放在一行中
2.  `*`应引用通配符 ( )

加起来：

```
env:
  - SYMFONY_VERSION="2.0.*" BUZZ_VERSION="0.6"
  - SYMFONY_VERSION="2.1.*" BUZZ_VERSION="0.*" 
```

# iphone - 如何在 UITableView 中使用 iOS NSJSONSerialization 解析 Twitter 搜索结果？

> ID：14187556
> 
> 赞同：0
> 
> 时间：2013-01-06T22:37:51.597
> 
> 标签：iphone, ios, json, uitableview, nsjsonserialization

我在使用内置 iOS JSON 解析器解析 Twitter 搜索结果时遇到问题。

```
NSDictionary *resultorig = [NSJSONSerialization JSONObjectWithData:self.responseData options: NSJSONReadingMutableContainers error: &err];
NSMutableArray *result = [resultorig objectForKey:@"results"];
NSLog(@"%@", result); 
```

我正在使用此网址搜索 Twitter：[http ://search.twitter.com/search.json?q=%23xbox](http://search.twitter.com/search.json?q=%23xbox)

其中打印出：

```
{"completed_in":0.013,"max_id":288030748135530498,"max_id_str":"288030748135530498","next_page":"?page=2&max_id=288030748135530498&q=%23xbox","page":1,"query":"%23xbox","refresh_url":"?since_id=288030748135530498&q=%23xbox","results":[{"created_at":"Sun, 06 Jan 2013 21:14:16 +0000","from_user":"momarkmagic","from_user_id":41954598,"from_user_id_str":"41954598","from_user_name":"Mark Molnar","geo":null,"id":288030748135530498,"id_str":"288030748135530498","iso_language_code":"en","metadata":{"result_type":"recent"},"profile_image_url":"http:\/\/a0.twimg.com\/profile_images\/342500438\/avat_normal.jpg","profile_image_url_https":"https:\/\/si0.twimg.com\/profile_images\/342500438\/avat_normal.jpg","source":"&lt;a href=&quot;http:\/\/twitter.com\/&quot;&gt;web&lt;\/a&gt;","text":"RT @conceptartworld: Check out Halo 4 Concept Art by Thomas Scholes! http:\/\/t.co\/JdDr40XM #xbox #illustration http:\/\/t.co\/AKjZGKgN","to_user":null,"to_user_id":0,"to_user_id_str":"0","to_user_name":null},{"created_at":"Sun, 06 Jan 2013 21:14:07 +0000","from_user":"DeJesusRaymond","from_user_id":57501625,"from_user_id_str":"57501625","from_user_name":"Raymond DeJesus\u0950","geo":null,"id":288030711229861888,"id_str":"288030711229861888","iso_language_code":"da","metadata":{"result_type":"recent"},"profile_image_url":"http:\/\/a0.twimg.com\/profile_images\/3069994571\/4b2761d7571bb012354f7efd47c71eb2_normal.jpeg","profile_image_url_https":"https:\/\/si0.twimg.com\/profile_images\/3069994571\/4b2761d7571bb012354f7efd47c71eb2_normal.jpeg","source":"&lt;a href=&quot;http:\/\/instagr.am&quot;&gt;Instagram&lt;\/a&gt;","text":"#360 #xbox #swag #thuglife. http:\/\/t.co\/Q0mteFMA","to_user":null,"to_user_id":0,"to_user_id_str":"0","to_user_name":null},{"created_at":"Sun, 06 Jan 2013 21:13:59 +0000","from_user":"ShotzLiam_3","from_user_id":598301611,"from_user_id_str":"598301611","from_user_name":"Liam","geo":null,"id":288030679453798400,"id_str":"288030679453798400","iso_language_code":"en","metadata":{"result_type":"recent"},"profile_image_url":"http:\/\/a0.twimg.com\/profile_images\/2866443960\/9c7349d8672774cae56aedfcc1955b31_normal.jpeg","profile_image_url_https":"https:\/\/si0.twimg.com\/profile_images\/2866443960\/9c7349d8672774cae56aedfcc1955b31_normal.jpeg","source":"&lt;a href=&quot;http:\/\/twitter.com\/download\/iphone&quot;&gt;Twitter for iPhone&lt;\/a&gt;","text":"@FifaaGiveaways can I have some coins #xbox","to_user":"FifaaGiveaways","to_user_id":943979888,"to_user_id_str":"943979888","to_user_name":"Free UT Giveaways"},{"created_at":"Sun, 06 Jan 2013 21:13:28 +0000","from_user":"Kuvaga","from_user_id":83686315,"from_user_id_str":"83686315","from_user_name":"Kut V. \u26a1","geo":null,"id":288030544850206720,"id_str":"288030544850206720","iso_language_code":"es","metadata":{"result_type":"recent"},"profile_image_url":"http:\/\/a0.twimg.com\/profile_images\/3060318139\/af19b6a35cdf09e4f54e12835e18093e_normal.jpeg","profile_image_url_https":"https:\/\/si0.twimg.com\/profile_images\/3060318139\/af19b6a35cdf09e4f54e12835e18093e_normal.jpeg","source":"&lt;a href=&quot;http:\/\/twitter.com\/download\/iphone&quot;&gt;Twitter for iPhone&lt;\/a&gt;","text":"Este es el que te dije @GarcIA_MGM #Xbox http:\/\/t.co\/04N9fESH","to_user":null,"to_user_id":0,"to_user_id_str":"0","to_user_name":null},{"created_at":"Sun, 06 Jan 2013 21:13:24 +0000","from_user":"benzybk","from_user_id":275588581,"from_user_id_str":"275588581","from_user_name":"Benzy Babykutty","geo":null,"id":288030531063541762,"id_str":"288030531063541762","iso_language_code":"en","metadata":{"result_type":"recent"},"profile_image_url":"http:\/\/a0.twimg.com\/profile_images\/3040249039\/d741b8ccfdb9d130be72eadd77471adc_normal.jpeg","profile_image_url_https":"https:\/\/si0.twimg.com\/profile_images\/3040249039\/d741b8ccfdb9d130be72eadd77471adc_normal.jpeg","source":"&lt;a href=&quot;http:\/\/twitter.com\/download\/iphone&quot;&gt;Twitter for iPhone&lt;\/a&gt;","text":"RT @TheSunNewspaper: The next Xbox versus the PS4, we take a look at what to expect. http:\/\/t.co\/SdFzZUYv #xbox #ps3 #gaming","to_user":null,"to_user_id":0,"to_user_id_str":"0","to_user_name":null},{"created_at":"Sun, 06 Jan 2013 21:13:13 +0000","from_user":"Lewis_Whitfield","from_user_id":53468672,"from_user_id_str":"53468672","from_user_name":"ImLatchingOntoYou.","geo":null,"id":288030482623516672,"id_str":"288030482623516672","iso_language_code":"en","metadata":{"result_type":"recent"},"profile_image_url":"http:\/\/a0.twimg.com\/profile_images\/3008431805\/15b78d1e299047711e5ab6da0cbe3e28_normal.jpeg","profile_image_url_https":"https:\/\/si0.twimg.com\/profile_images\/3008431805\/15b78d1e299047711e5ab6da0cbe3e28_normal.jpeg","source":"&lt;a href=&quot;http:\/\/instagr.am&quot;&gt;Instagram&lt;\/a&gt;","text":"Completed Forza Horizon! Yay #xbox #xbox360 #forza #completed #sad #intense #best #game #ever http:\/\/t.co\/AedVwph0","to_user":null,"to_user_id":0,"to_user_id_str":"0","to_user_name":null},{"created_at":"Sun, 06 Jan 2013 21:12:51 +0000","from_user":"sexyboy529","from_user_id":394412198,"from_user_id_str":"394412198","from_user_name":"Sexyboy","geo":null,"id":288030392844435456,"id_str":"288030392844435456","iso_language_code":"en","metadata":{"result_type":"recent"},"profile_image_url":"http:\/\/a0.twimg.com\/sticky\/default_profile_images\/default_profile_5_normal.png","profile_image_url_https":"https:\/\/si0.twimg.com\/sticky\/default_profile_images\/default_profile_5_normal.png","source":"&lt;a href=&quot;http:\/\/twitter.com\/&quot;&gt;web&lt;\/a&gt;","text":"RT @Sam_James96: My life is dedicated to xbox today. #xbox #GTA5","to_user":null,"to_user_id":0,"to_user_id_str":"0","to_user_name":null},{"created_at":"Sun, 06 Jan 2013 21:12:28 +0000","from_user":"Andreact93","from_user_id":211217957,"from_user_id_str":"211217957","from_user_name":"Andrea Gazzo","geo":null,"id":288030296312537090,"id_str":"288030296312537090","iso_language_code":"da","metadata":{"result_type":"recent"},"profile_image_url":"http:\/\/a0.twimg.com\/profile_images\/1771937572\/foto_twitter_normal.jpg","profile_image_url_https":"https:\/\/si0.twimg.com\/profile_images\/1771937572\/foto_twitter_normal.jpg","source":"&lt;a href=&quot;http:\/\/instagr.am&quot;&gt;Instagram&lt;\/a&gt;","text":"#xbox360 #controller #game #halo4 #games #gamers #xbox #modded #led #blue http:\/\/t.co\/bTkCuyT0","to_user":null,"to_user_id":0,"to_user_id_str":"0","to_user_name":null},{"created_at":"Sun, 06 Jan 2013 21:12:24 +0000","from_user":"2xMolly2xBlunt","from_user_id":259448291,"from_user_id_str":"259448291","from_user_name":"\u2665Rihanna\u2665BabyDaddy\u2665\ue420","geo":null,"id":288030277299736577,"id_str":"288030277299736577","iso_language_code":"en","metadata":{"result_type":"recent"},"profile_image_url":"http:\/\/a0.twimg.com\/profile_images\/2956632635\/442f652a4e993f26d285e80ccb57910a_normal.png","profile_image_url_https":"https:\/\/si0.twimg.com\/profile_images\/2956632635\/442f652a4e993f26d285e80ccb57910a_normal.png","source":"&lt;a href=&quot;http:\/\/twitter.com\/&quot;&gt;web&lt;\/a&gt;","text":"Time to play 2k who wanna play #RT #2K13 #XBOX","to_user":null,"to_user_id":0,"to_user_id_str":"0","to_user_name":null},{"created_at":"Sun, 06 Jan 2013 21:12:23 +0000","from_user":"_kdog","from_user_id":118113755,"from_user_id_str":"118113755","from_user_name":"Kirsten Thomson","geo":null,"id":288030276670611458,"id_str":"288030276670611458","iso_language_code":"en","metadata":{"result_type":"recent"},"profile_image_url":"http:\/\/a0.twimg.com\/profile_images\/3061762292\/c8d1047d30ab44a6ee922500bce85370_normal.jpeg","profile_image_url_https":"https:\/\/si0.twimg.com\/profile_images\/3061762292\/c8d1047d30ab44a6ee922500bce85370_normal.jpeg","source":"&lt;a href=&quot;http:\/\/instagr.am&quot;&gt;Instagram&lt;\/a&gt;","text":"I love skyrim so much. #skyrim #Lynda #Clyde #ilovewater #xbox #sarahando http:\/\/t.co\/bM2dSIkZ","to_user":null,"to_user_id":0,"to_user_id_str":"0","to_user_name":null},{"created_at":"Sun, 06 Jan 2013 21:12:10 +0000","from_user":"ReeceAxten","from_user_id":405803362,"from_user_id_str":"405803362","from_user_name":"ReeceAxten\u00ae","geo":null,"id":288030220164952064,"id_str":"288030220164952064","iso_language_code":"tl","metadata":{"result_type":"recent"},"profile_image_url":"http:\/\/a0.twimg.com\/profile_images\/3074248109\/0fa728912afd324e8722169c4efc3ab2_normal.jpeg","profile_image_url_https":"https:\/\/si0.twimg.com\/profile_images\/3074248109\/0fa728912afd324e8722169c4efc3ab2_normal.jpeg","source":"&lt;a href=&quot;http:\/\/twitter.com\/download\/iphone&quot;&gt;Twitter for iPhone&lt;\/a&gt;","text":"Fifa anyone? #xbox","to_user":null,"to_user_id":0,"to_user_id_str":"0","to_user_name":null},{"created_at":"Sun, 06 Jan 2013 21:11:02 +0000","from_user":"karlheath6","from_user_id":984240522,"from_user_id_str":"984240522","from_user_name":"Karl heath","geo":null,"id":288029933144518657,"id_str":"288029933144518657","iso_language_code":"en","metadata":{"result_type":"recent"},"profile_image_url":"http:\/\/a0.twimg.com\/profile_images\/3007892972\/4988eca8a918c2fa1b28b48d0f0980df_normal.jpeg","profile_image_url_https":"https:\/\/si0.twimg.com\/profile_images\/3007892972\/4988eca8a918c2fa1b28b48d0f0980df_normal.jpeg","source":"&lt;a href=&quot;https:\/\/mobile.twitter.com&quot;&gt;Mobile Web (M2)&lt;\/a&gt;","text":"RT @Retroshock316: For a chance 2 win #DirtShowdown for #Xbox, follow @Retroshock316 + RT this. Winner announced when we hit 2k followers. #Comp #Competition","to_user":null,"to_user_id":0,"to_user_id_str":"0","to_user_name":null},{"created_at":"Sun, 06 Jan 2013 21:10:45 +0000","from_user":"SWARNERx","from_user_id":244070634,"from_user_id_str":"244070634","from_user_name":"- Shell Warner\u2717","geo":null,"id":288029861786820609,"id_str":"288029861786820609","iso_language_code":"en","metadata":{"result_type":"recent"},"profile_image_url":"http:\/\/a0.twimg.com\/profile_images\/3071322789\/ba7c82da179f851fea6a4a12ad66c0bd_normal.jpeg","profile_image_url_https":"https:\/\/si0.twimg.com\/profile_images\/3071322789\/ba7c82da179f851fea6a4a12ad66c0bd_normal.jpeg","source":"&lt;a href=&quot;http:\/\/twitter.com\/&quot;&gt;web&lt;\/a&gt;","text":"back to #xbox .#Blackops2 add me : SWARNERx . #Zombies.","to_user":null,"to_user_id":0,"to_user_id_str":"0","to_user_name":null},{"created_at":"Sun, 06 Jan 2013 21:10:26 +0000","from_user":"headshotcola","from_user_id":1064288336,"from_user_id_str":"1064288336","from_user_name":"Xbox_Headshotcola","geo":null,"id":288029783584022528,"id_str":"288029783584022528","iso_language_code":"en","metadata":{"result_type":"recent"},"profile_image_url":"http:\/\/a0.twimg.com\/sticky\/default_profile_images\/default_profile_6_normal.png","profile_image_url_https":"https:\/\/si0.twimg.com\/sticky\/default_profile_images\/default_profile_6_normal.png","source":"&lt;a href=&quot;http:\/\/twitter.com\/download\/android&quot;&gt;Twitter for Android&lt;\/a&gt;","text":"People buy #ForzaHorizon it is such a good game best racing game you would #xbox","to_user":null,"to_user_id":0,"to_user_id_str":"0","to_user_name":null},{"created_at":"Sun, 06 Jan 2013 21:10:15 +0000","from_user":"joecurry281186","from_user_id":338231824,"from_user_id_str":"338231824","from_user_name":"Joe Curry","geo":{"coordinates":[52.092676,-1.836255],"type":"Point"},"id":288029737761263616,"id_str":"288029737761263616","iso_language_code":"en","metadata":{"result_type":"recent"},"profile_image_url":"http:\/\/a0.twimg.com\/profile_images\/2402359791\/image_normal.jpg","profile_image_url_https":"https:\/\/si0.twimg.com\/profile_images\/2402359791\/image_normal.jpg","source":"&lt;a href=&quot;http:\/\/twitter.com\/download\/iphone&quot;&gt;Twitter for iPhone&lt;\/a&gt;","text":"Just deleted a load of content to install FableIII and its still running like crap #xbox #ffs","to_user":null,"to_user_id":0,"to_user_id_str":"0","to_user_name":null}],"results_per_page":15,"since_id":0,"since_id_str":"0"} 
```

我正在尝试在 tableview 的每一行中显示推文文本，但它与我当前的代码崩溃：

```
NSDictionary *aTweet = [result objectAtIndex:indexPath.row];
cell.theTweet.text = [aTweet objectForKey:@"text"];
NSLog(@"%@", [aTweet objectForKey:@"text"]); 
```

我究竟做错了什么？任何帮助将不胜感激，因为我几乎整天都在尝试修复此崩溃。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T23:26:00.963

我终于想通了。它在树的解析中。我解析不正确。我需要按如下方式遍历树：

```
for (NSDictionary *newDictionary in result) {
 NSString *tweetNew = [newDictionary objectForKey:@"text"];
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T09:54:43.313

您获得的 JSON 响应是有效的。所以在通常情况下，解析它应该没有任何问题。

就我个人而言，我是 SBJson 用于 JSON 解析的粉丝。请参考这个链接

```
http://stig.github.com/json-framework/ 
```

如果您可以将传入的数据映射到模型类，那就太好了。要将数据映射到模型类，您可以使用任何 KVC 包装器。

希望这可以帮助。

# php - 退出时停止脚本中间执行

> ID：14187557
> 
> 赞同：-2
> 
> 时间：2013-01-06T22:38:04.940
> 
> 标签：php

在用户操作中，我通过 AJAX 调用运行后端系统脚本，该调用在完成之前不会输出。问题是用户很容易通过启动脚本然后离开页面来浪费资源。目标是在退出时跳出 while 循环。

首先，我让它在启动时将一个文件添加到缓存中，并在每次迭代时检查它。这可以正常工作，因为如果我通过另一个 AJAX 调用更改文件值，它将退出。

所以我的问题是，当你离开页面时，我怎样才能打破这个循环？

我唯一的猜测是执行 JS onunload AJAX 调用来更改缓存文件，但由于显而易见的原因，这是一种糟糕且高度不可靠的方法。谢谢

**//编辑//**

所以我给了connection_aborted 一个ignore_user_abort 机会。这是代码的一个非常淡化的版本。

```
ignore_user_abort(true);
set_time_limit(0);

$handle=opendir($dir);
if($handle)
{
    while(false!==($file=readdir($handle))&&!connection_aborted())
    {
       sleep(1);
       unlink($dir."/".$file);
    }
} 
```

因此，即使在我离开页面后，文件仍会从文件夹中删除。我的目标是跳出这个循环，如果你离开这个页面，就停止所有的取消链接。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T22:45:24.213

你可以检查[`connection_aborted()`](http://php.net/manual/en/function.connection-aborted.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T22:45:57.287

> 在用户操作中，我通过 AJAX 调用运行后端系统脚本，该调用在完成之前不会输出。问题是用户很容易通过启动脚本然后离开页面来浪费资源。目标是在退出时跳出 while 循环。

你应该检查一下：

*   [http://php.net/manual/en/function.ignore-user-abort.php](http://php.net/manual/en/function.ignore-user-abort.php)
*   [http://php.net/manual/en/function.connection-aborted.php](http://php.net/manual/en/function.connection-aborted.php)

听起来他们可以解决你的问题。

# android - 如何使 httprequest 成为异步任务的示例

> ID：14187559
> 
> 赞同：4
> 
> 时间：2013-01-06T22:38:08.433
> 
> 标签：android, asynchronous, httprequest

全部，

我有一个小型功能应用程序，它根据 buttonclick 发送的用户输入向服务器发出 httprequest。我正在寻找一些帮助，使我的小应用程序与 SDK 11+ 兼容，方法是将此 httprequest 设为异步任务。

我花了几天时间阅读异步任务，了解原理，以及使 httprequest 远离 UI 线程的原因。

但是我只是无法让代码在我的情况下工作。我什至无法编译它。我已经包含在我的功能代码下面（即在尝试使 httprequest 异步之前）

我会非常感谢一些具体的帮助。我为我的垃圾代码道歉，并且已经回答了这个问题的变体。

在此先感谢杰米

我的 MainActivity 代码如下：

```
package com.jrcdesign.ebookbeamer;
import java.io.IOException;
import org.apache.http.client.ClientProtocolException;
import java.util.ArrayList;
import java.util.List;
import org.apache.http.client.HttpClient;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.NameValuePair;
import org.apache.http.client.entity.UrlEncodedFormEntity;
import org.apache.http.message.BasicNameValuePair;
import android.app.Activity;
import android.os.Bundle;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;
import android.widget.Toast;
import android.widget.Spinner;
import android.view.View.OnClickListener;

public class MainActivity extends Activity {

Button sendButton;
Button btnSubmit;
EditText msgTextField;
EditText msg2TextField;
Spinner spinner1;

/** Called when the activity is first created. */

@Override
public void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);
    // load the layout
    setContentView(R.layout.main);        

    // make message text field object
    msgTextField = (EditText) findViewById(R.id.msgTextField);
    msg2TextField = (EditText) findViewById(R.id.msg2TextField);

    // make send button object
    sendButton = (Button) findViewById(R.id.sendButton);
    btnSubmit = (Button) findViewById(R.id.btnSubmit);    
    addListenerOnButton();
    addListenerOnSpinnerItemSelection(); 

}            

    public void addListenerOnSpinnerItemSelection() {
    spinner1 = (Spinner) findViewById(R.id.spinner1);
    spinner1.setOnItemSelectedListener(new CustomOnItemSelectedListener());
    }

    // get the selected dropdown list value
    public void addListenerOnButton() {

    spinner1 = (Spinner) findViewById(R.id.spinner1);
    btnSubmit = (Button) findViewById(R.id.btnSubmit);

    btnSubmit.setOnClickListener(new OnClickListener() {

      @Override
      public void onClick(View v) {

        Toast.makeText(MainActivity.this,
        "OnClickListener : " + 
                  "\nSpinner 1 : "+ String.valueOf(spinner1.getSelectedItem()),
            Toast.LENGTH_SHORT).show();

      msgTextField.setText("" + String.valueOf(spinner1.getSelectedItem()));

      }

    });
    }

    // Called when the SEND button is pressed
    // Need to make this an async task

    public void send(View v)
{
   // get the message from the message text box
    msgTextField.setText("" + String.valueOf(spinner1.getSelectedItem()));
    String msg = msgTextField.getText().toString();  
    String msg2 = msg2TextField.getText().toString();  

    if (msg.length()>0)
    {
        HttpClient httpclient = new DefaultHttpClient();
        HttpPost httppost = new HttpPost("http://54.235.198.96/test1.php");
     try {
       List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(2);
       nameValuePairs.add(new BasicNameValuePair("id", msg2));
       nameValuePairs.add(new BasicNameValuePair("message", msg));
       httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));

       httpclient.execute(httppost);
       msgTextField.setText(""); // clear text box
       msg2TextField.setText(""); // clear text box

       Toast.makeText(MainActivity.this,
                "Your request is being processed",
                    Toast.LENGTH_LONG).show();

     } catch (ClientProtocolException e) {
         // TODO Auto-generated catch block
     } catch (IOException e) {
         // TODO Auto-generated catch block
     }

    }
    else
    {
        // display message if text fields are empty
        Toast.makeText(getBaseContext(),"All fields are required",Toast.LENGTH_SHORT).show();
    }

}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T23:36:35.870

这是您的异步​​类：

```
private class AsyncTaskDownloadSomething extends
        AsyncTask<String[], String, String> {

    DataClassLentABook  mData;

    @Override
    protected void onPreExecute() {
        super.onPreExecute();
        //Do some prepartations over here, before the task starts to execute
        //Like freeze the button and/or show a progress bar

    }

    @Override
    protected String doInBackground(String... urls) {
        // Task starts executing.
        String url = urls[0];

        // Execute HTTP requests here, with one url(urls[0]),
        // or many urls using the urls table
        // Save result in myresult

        return myresult;

    }

    protected void onPostExecute(String result) {
               //Do modifications you want after everything is finished
               //Like re-enable the button, and/or hide a progressbar
               //And of course do what you want with your result got from http-req

    }
} 
```

要执行你的异步任务，当你的按钮被点击时，只需要这样写：

```
new AsyncTaskDownloadSomething().execute(someURL); 
```

# android - 什么可以防止自动重建 R 类？

> ID：14187561
> 
> 赞同：-1
> 
> 时间：2013-01-06T22:38:36.883
> 
> 标签：android, eclipse, adt, eclipse-adt

目前我对 ADT 和 Eclipse 有一个奇怪的问题。R 文件不会自动重建 - 我总是需要清理才能看到更改（例如在 strings.xml 中插入字符串之后）。我使用 ADT 21 和 Eclipse 3.8 - 知道在哪里可以解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T22:42:35.990

可以禁用 eclipse 中的设置，`build automatically`但其中一个 xml 文件也可能存在错误。通常只需清理然后构建就足以完全摆脱它，但您也可以尝试删除 R 然后清理/构建。

# android - 使用安卓应用登录网站

> ID：14187563
> 
> 赞同：1
> 
> 时间：2013-01-06T22:39:40.817
> 
> 标签：android, post, login, httpclient

如何通过 android 应用程序登录网站（[http://www.myhopaccount.co.nz/CWP/](http://www.myhopaccount.co.nz/CWP/) - - - - 您将被重定向到实际网站）？我已经在这里查看了几乎所有的问题。每次我发送数据，当我检索信息时，我总是从登录页面获取信息。

任何人都可以向我显示用于通过应用程序登录该网站的代码，或将我链接到有用的地方吗？我尝试了不同的方法（jsoup、httpclient），但仍然没有。

这是我最近的尝试：（用户名/密码是从文本字段中获取的）

```
Thread thread = new Thread() {
    public void run() {
        HttpClient httpclient = new DefaultHttpClient();
        HttpPost httppost = new HttpPost("myhopaccount.co.nz/CWP/");

        try {
            List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(2);
            nameValuePairs.add(newBasicNameValuePair("ctl00$contentPlaceHolder$UsernameTextBox", username));
            nameValuePairs.add(new BasicNameValuePair("ctl00$contentPlaceHolder$PasswordTextBox", password));
            httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));

            HttpResponse response = httpclient.execute(httppost);
            Log.v("StatusCode", "Response from server: " + response.getStatusLine().getStatusCode());

            } catch (ClientProtocolException e) {
                System.out.println("CPE: " + e.getMessage());
            } catch (IOException e) {
                System.out.println("IOE: " + e.getMessage());
            }
        }
    };
thread.start(); 
```

在此之前，我尝试了这个解决方案：[通过 Android 应用程序登录 https 网站](https://stackoverflow.com/questions/6443401/performing-login-to-https-website-via-android-app)

但是，这仅返回了登录页面的源代码。

# mysql - 多列和排序

> ID：14187566
> 
> 赞同：1
> 
> 时间：2013-01-06T22:40:09.150
> 
> 标签：mysql, max

我已经尝试了几个小时来让我的 SQL 查询按价格排序。开始了：

桌子`INFO`

```
id (unique id)
mid (some id)
name 
```

桌子`PRICES`

```
id (some unique id)
fuid (id for showing wich entry from INFO this price is connected to)
dated (date) 
```

SQL查询：

```
select INFO.id, INFO.mid, INFO.name, PRICES.price, PRICES.dated
from INFO, PRICES
WHERE INFO.id = PRICES.fuid
ORDER BY PRICES.dated asc
limit 100 
```

我想要的结果是所有条目的列表，`INFO`其中包含 的最新价格`PRICES`。只限最新价格，一单一价`INFO`。

我得到了什么：我得到了一个唯一条目列表，`INFO`但我得到的是在 中输入的第一个价格`PRICES`，而不是最新的。

我无法`max()`帮助我对价格列进行排序。有谁知道如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T22:59:02.287

你用过`GROUP BY`吗`MAX()`？以下使用`MAX()`and`GROUP BY`可能会满足您的需要：

```
select INFO.id, INFO.mid, INFO.name, PRICES.price, MAX(PRICES.dated) 
from INFO, PRICES 
where INFO.id = PRICES.fuid
group by INFO.id, INFO.mid, INFO.name, PRICES.price
order by INFO.name asc 
limit 100 
```

请注意，`ORDER BY`列可以是您想要的任何内容；它不必是`MAX(PRICES.dated)`。

**编辑**：我明白你的意思。您可以使用像这个[SQL Fiddle](http://sqlfiddle.com/#!2/ce1cb/2)这样的临时表。

# php - 如何使邮件形成工作

> ID：14187567
> 
> 赞同：0
> 
> 时间：2013-01-06T22:40:23.523
> 
> 标签：php, html, css, email, forums

我知道这个网站上被问了很多，但我只需要知道如何去做。

我在**CSS3**上有一个用于电子邮件表单的 html 代码。留给我的唯一一件事就是让它发挥作用。我的网站与我的电子邮件在同一台服务器上。

这是编码。

```
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>HTML5 Contact Form</title>
    <link rel="stylesheet" media="screen" href="styles.css" >
</head>
<body>
<form class="contact_form" action="#" method="post" name="contact_form">
    <ul>
        <li>
             <h2>Contact Us</h2>
             <span class="required_notification">* Denotes Required Field</span>
        </li>
        <li>
            <label for="name">Name:</label>
            <input type="text"  placeholder="John Doe" required />
        </li>
        <li>
            <label for="email">Email:</label>
            <input type="email" name="email" placeholder="john_doe@example.com" required />
            <span class="form_hint">Proper format "name@something.com"</span>
        </li>
        <li>
            <label for="website">Website:</label>
            <input type="url" name="website" placeholder="http://johndoe.com" required pattern="(http|https)://.+"/>
            <span class="form_hint">Proper format "http://someaddress.com"</span>
        </li>
        <li>
            <label for="message">Message:</label>
            <textarea name="message" cols="40" rows="6" required ></textarea>
        </li>
        <li>
            <button class="submit" type="submit">Submit Form</button>
        </li>
    </ul>
</form>
</body>
</html> 
```

CSS

```
/* === Remove input autofocus webkit === */
*:focus {outline: none;}

/* === Form Typography === */
body {font: 14px/21px "Lucida Sans", "Lucida Grande", "Lucida Sans Unicode", sans-serif;}
.contact_form h2, .contact_form label {font-family:Georgia, Times, "Times New Roman", serif;}
.form_hint, .required_notification {font-size: 11px;}

/* === List Styles === */
.contact_form ul {
    width:750px;
    list-style-type:none;
    list-style-position:outside;
    margin:0px;
    padding:0px;
}
.contact_form li{
    padding:12px; 
    border-bottom:1px solid #eee;
    position:relative;
} 
.contact_form li:first-child, .contact_form li:last-child {
    border-bottom:1px solid #777;
}

/* === Form Header === */
.contact_form h2 {
    margin:0;
    display: inline;
}
.required_notification {
    color:#d45252; 
    margin:5px 0 0 0; 
    display:inline;
    float:right;
}

/* === Form Elements === */
.contact_form label {
    width:150px;
    margin-top: 3px;
    display:inline-block;
    float:left;
    padding:3px;
}
.contact_form input {
    height:20px; 
    width:220px; 
    padding:5px 8px;
}
.contact_form textarea {padding:8px; width:300px;}
.contact_form button {margin-left:156px;}

    /* form element visual styles */
    .contact_form input, .contact_form textarea { 
        border:1px solid #aaa;
        box-shadow: 0px 0px 3px #ccc, 0 10px 15px #eee inset;
        border-radius:2px;
        padding-right:30px;
        -moz-transition: padding .25s; 
        -webkit-transition: padding .25s; 
        -o-transition: padding .25s;
        transition: padding .25s;
    }
    .contact_form input:focus, .contact_form textarea:focus {
        background: #fff; 
        border:1px solid #555; 
        box-shadow: 0 0 3px #aaa; 
        padding-right:70px;
    }

/* === HTML5 validation styles === */   
.contact_form input:required, .contact_form textarea:required {
    background: #fff url(images/red_asterisk.png) no-repeat 98% center;
}
.contact_form input:required:valid, .contact_form textarea:required:valid {
    background: #fff url(images/valid.png) no-repeat 98% center;
    box-shadow: 0 0 5px #5cd053;
    border-color: #28921f;
}
.contact_form input:focus:invalid, .contact_form textarea:focus:invalid {
    background: #fff url(images/invalid.png) no-repeat 98% center;
    box-shadow: 0 0 5px #d45252;
    border-color: #b03535
}

/* === Form hints === */
.form_hint {
    background: #d45252;
    border-radius: 3px 3px 3px 3px;
    color: white;
    margin-left:8px;
    padding: 1px 6px;
    z-index: 999; /* hints stay above all other elements */
    position: absolute; /* allows proper formatting if hint is two lines */
    display: none;
}
.form_hint::before {
    content: "\25C0";
    color:#d45252;
    position: absolute;
    top:1px;
    left:-6px;
}
.contact_form input:focus + .form_hint {display: inline;}
.contact_form input:required:valid + .form_hint {background: #28921f;}
.contact_form input:required:valid + .form_hint::before {color:#28921f;}

/* === Button Style === */
button.submit {
    background-color: #68b12f;
    background: -webkit-gradient(linear, left top, left bottom, from(#68b12f), to(#50911e));
    background: -webkit-linear-gradient(top, #68b12f, #50911e);
    background: -moz-linear-gradient(top, #68b12f, #50911e);
    background: -ms-linear-gradient(top, #68b12f, #50911e);
    background: -o-linear-gradient(top, #68b12f, #50911e);
    background: linear-gradient(top, #68b12f, #50911e);
    border: 1px solid #509111;
    border-bottom: 1px solid #5b992b;
    border-radius: 3px;
    -webkit-border-radius: 3px;
    -moz-border-radius: 3px;
    -ms-border-radius: 3px;
    -o-border-radius: 3px;
    box-shadow: inset 0 1px 0 0 #9fd574;
    -webkit-box-shadow: 0 1px 0 0 #9fd574 inset ;
    -moz-box-shadow: 0 1px 0 0 #9fd574 inset;
    -ms-box-shadow: 0 1px 0 0 #9fd574 inset;
    -o-box-shadow: 0 1px 0 0 #9fd574 inset;
    color: white;
    font-weight: bold;
    padding: 6px 20px;
    text-align: center;
    text-shadow: 0 -1px 0 #396715;
}
button.submit:hover {
    opacity:.85;
    cursor: pointer; 
}
button.submit:active {
    border: 1px solid #20911e;
    box-shadow: 0 0 10px 5px #356b0b inset; 
    -webkit-box-shadow:0 0 10px 5px #356b0b inset ;
    -moz-box-shadow: 0 0 10px 5px #356b0b inset;
    -ms-box-shadow: 0 0 10px 5px #356b0b inset;
    -o-box-shadow: 0 0 10px 5px #356b0b inset;

} 
```

如果有人可以帮助我，那将是一个爆炸。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T23:24:11.357

好的。我创建了经过测试和工作的**PHP**代码。

首先用这个替换你的**HTML** cede

```
<form class="contact_form" action="submit.php" method="post" name="contact_form">
    <ul>
        <li>
             <h2>Contact Us</h2>
             <span class="required_notification">* Denotes Required Field</span>
        </li>
        <li>
            <label for="name">Name:</label>
            <input type="text" name="name"  placeholder="John Doe" required />
        </li>
        <li>
            <label for="email">Email:</label>
            <input type="email" name="email" placeholder="john_doe@example.com" required />
            <span class="form_hint">Proper format "name@something.com"</span>
        </li>
        <li>
            <label for="website">Website:</label>
            <input name="website" type="url" name="website" placeholder="http://johndoe.com" required pattern="(http|https)://.+"/>
            <span class="form_hint">Proper format "http://someaddress.com"</span>
        </li>
        <li>
            <label for="message">Message:</label>
            <textarea name="message" cols="40" rows="6" required ></textarea>
        </li>
        <li>
            <button class="submit" type="submit">Submit Form</button>
        </li>
    </ul>
</form> 
```

你的**CSS**将是相同的，**PHP**代码是这样的：

```
<?php

$name = $_POST['name'];
$email = $_POST['email'];
$website = $_POST['website'];
$message = $_POST['message'];
$to = 'your@email.com';
$headers = 'From: '.$email."\r\n" .'Reply-To: '.$email."\r\n" .'X-Mailer: PHP/' . phpversion();
$subject = $subject;

$body.='Name: '.$name."\n";
$body.='Email: '.$email."\n";
$body.='Website: '.$website."\n";
$body.='Message: '."\n".$message."\n";

if(mail($to, $subject, $body, $headers)) {
    die('Mail sent');
} 
else {
    die('Error: Mail failed');
}
?> 
```

在**PHP**`$to`上写你的电子邮件。

 **注意：您**需要**在`submit.php`**

# sql - 在 Informix 中将 DATETIME 转换为 Unix 纪元

> ID：14187569
> 
> 赞同：2
> 
> 时间：2013-01-06T22:40:25.423
> 
> 标签：sql, informix, datediff

我有一个 DATETIME 列：

`SELECT mytime FROM mytable;`

```
mytime
--------------------
1/6/2013 10:41:41 PM 
```

我想编写一个 SQL 语句，以 Unix 时间格式（自 Unix 纪元以来的秒数 - 01/01/1970 00:00:00）返回时间为`INTEGER`. 我曾尝试使用`DATEDIFF`，`CAST`但没有运气。这是**Informix**数据库。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-06T23:39:07.643

假设该`mytime`列是 DATETIME YEAR TO SECOND 列（尽管问题中显示了格式），那么下面的存储过程就可以完成这项工作。它的评论比程序多，但评论解释了它在做什么。

```
{
#   "@(#)$Id: tounixtime.spl,v 1.6 2002/09/25 18:10:48 jleffler Exp $"
#
# Stored procedure TO_UNIX_TIME written by Jonathan Leffler (previously
# jleffler@informix.com and now jleffler@us.ibm.com).  Includes fix for
# bug reported by Tsutomu Ogiwara <Tsutomu.Ogiwara@ctc-g.co.jp> on
# 2001-07-13\.  Previous version used DATETIME(0) SECOND TO SECOND
# instead of DATETIME(0:0:0) HOUR TO SECOND, and when the calculation
# extended the shorter constant to DATETIME HOUR TO SECOND, it added the
# current hour and minute fields, as documented in the Informix Guide to
# SQL: Syntax manual under EXTEND in the section on 'Expression'.
# Amended 2002-08-23 to handle 'eternity' and annotated more thoroughly.
# Amended 2002-09-25 to handle fractional seconds, as companion to the
# new stored procedure FROM_UNIX_TIME().
#
# If you run this procedure with no arguments (use the default), you
# need to worry about the time zone the database server is using because
# the value of CURRENT is determined by that, and you need to compensate
# for it if you are using a different time zone.
#
# Note that this version works for dates after 2001-09-09 when the
# interval between 1970-01-01 00:00:00+00:00 and current exceeds the
# range of INTERVAL SECOND(9) TO SECOND.  Returning DECIMAL(18,5) allows
# it to work for all valid datetime values including fractional seconds.
# In the UTC time zone, the 'Unix time' of 9999-12-31 23:59:59 is
# 253402300799 (12 digits); the equivalent for 0001-01-01 00:00:00 is
# -62135596800 (11 digits).  Both these values are unrepresentable in
# 32-bit integers, of course, so most Unix systems won't handle this
# range, and the so-called 'Proleptic Gregorian Calendar' used to
# calculate the dates ignores locale-dependent details such as the loss
# of days that occurred during the switch between the Julian and
# Gregorian calendar, but those are minutiae that most people can ignore
# most of the time.
}

CREATE PROCEDURE to_unix_time(d DATETIME YEAR TO FRACTION(5)
                                DEFAULT CURRENT YEAR TO FRACTION(5))
            RETURNING DECIMAL(18,5);
    DEFINE n DECIMAL(18,5);
    DEFINE i1 INTERVAL DAY(9) TO DAY;
    DEFINE i2 INTERVAL SECOND(6) TO FRACTION(5);
    DEFINE s1 CHAR(15);
    DEFINE s2 CHAR(15);
    LET i1 = EXTEND(d, YEAR TO DAY) - DATETIME(1970-01-01) YEAR TO DAY;
    LET s1 = i1;
    LET i2 = EXTEND(d, HOUR TO FRACTION(5)) -
                DATETIME(00:00:00.00000) HOUR TO FRACTION(5);
    LET s2 = i2;
    LET n = s1 * (24 * 60 * 60) + s2;
    RETURN n;
END PROCEDURE; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-01-22T05:05:15.723

函数`dbinfo('utc_current')`返回纪元时间（自 1970-01-01 00:00:00 UTC 以来的秒数）。

# python - 使用 __slots__ 子类化一个类

> ID：14187571
> 
> 赞同：3
> 
> 时间：2013-01-06T22:40:34.423
> 
> 标签：python, subclass, slots

我正在尝试子类化 Scrapy`XPathSelector`并修补以支持 CSS3 选择器。

`XPathSelector`定义如下：

```
class XPathSelector(object_ref):
    __slots__ = ['doc', 'xmlNode', 'expr', '__weakref__']

    def __init__(self, response=None, text=None, node=None, parent=None, expr=None):
        if parent is not None:
            self.doc = parent.doc
        ... 
```

我继承`XPathSelector`并覆盖`__init__`：

```
class CSSSelector(XPathSelector):
    def __init__(self, *args, **kwargs):
        translator = kwargs.get('translator', 'html').lower()

        if 'translator' in kwargs:
            del kwargs['translator']

        super(XPathSelector, self).__init__(*args, **kwargs) 
```

当我尝试使用时，`CSSSelector`我得到`AttributeError`s和的错误。手动添加这些插槽也无济于事。`doc``xmlNode``expr``CSSSelector`

用 s 子类化一个类的正确方法是`__slot__`什么？

* * *

我的完整代码在这里：

```
"""
Extends `XPathSelector` to allow CSS3 selectors via the `cssselect` library.
"""

from cssselect import HTMLTranslator, GenericTranslator
from scrapy.selector import XPathSelector, XPathSelectorList

__all__ = ['CSSSelector', 'CSSSelectorList']

class CSSSelector(XPathSelector):
    __slots__ = ['doc', 'xmlNode', 'expr', 'translator']

    def __init__(self, *args, **kwargs):
        translator = kwargs.get('translator', 'html').lower()

        if 'translator' in kwargs:
            del kwargs['translator']

        super(CSSSelector, self).__init__(*args, **kwargs)

        if translator == 'html':
            self.translator = HTMLTranslator()
        elif translator == 'xhtml':
            self.translator = HTMLTranslator(xhtml=True)
        elif translator == 'xml':
            self.translator = GenericTranslator()
        else:
            raise ValueError("Invalid translator: %s. Valid translators are 'html' (default), 'xhtml' and 'xml'." % translator)

    def _select_xpath(self, xpath):
        if hasattr(self.xmlNode, 'xpathEval'):
            self.doc.xpathContext.setContextNode(self.xmlNode)
            xpath = unicode_to_str(xpath, 'utf-8')

            try:
                xpath_result = self.doc.xpathContext.xpathEval(xpath)
            except libxml2.xpathError:
                raise ValueError("Invalid XPath: %s" % xpath)

            if hasattr(xpath_result, '__iter__'):
                return CSSSelectorList([self.__class__(node=node, parent=self, expr=xpath) for node in xpath_result])
            else:
                return CSSSelectorList([self.__class__(node=xpath_result, parent=self, expr=xpath)])
        else:
            return CSSSelectorList([])

    def select(self, selector):
        xpath = self.translator.css_to_xpath(selector)

        return self._select_xpath(xpath)

    def attribute(self, name):
        return self._select_xpath('self::@' + name)

    def text(self):
        return self._select_xpath('self::text()')

class CSSSelectorList(XPathSelectorList):
    def attribute(self, name):
        return [x.attribute(name) for x in self]

    def text(self, name):
        return [x.text() for x in self] 
```

我可以很好地初始化类：

```
>>> css_selector = CSSSelector(response) 
```

但我`AttributeError`到处都是：

```
>>> css_selector.select('title')
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
<ipython-input-150-d21b0f17d4cc> in <module>()
----> 1 css_selector.select('title')

<ipython-input-147-c855c7eaf9fa> in select(self, selector)
     57 
     58 
---> 59         return self._select_xpath(xpath)
     60 
     61 

<ipython-input-147-c855c7eaf9fa> in _select_xpath(self, xpath)
     34 
     35     def _select_xpath(self, xpath):
---> 36         if hasattr(self.xmlNode, 'xpathEval'):
     37             self.doc.xpathContext.setContextNode(self.xmlNode)
     38             xpath = unicode_to_str(xpath, 'utf-8')

AttributeError: xmlNode 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-06T22:47:12.870

使用没有任何问题`__slots__`。问题是你没有从子类调用`__init__`。`XPathSelector`

而不是`super(XPathSelector, self)`应该有`super(CSSSelector, self)`：

```
class CSSSelector(XPathSelector):
    def __init__(self, *args, **kwargs):
        # ...
        super(CSSSelector, self).__init__(*args, **kwargs) 
```

在 Python 中查看关于 super 的一个很好的主题：[使用 __init__() 方法理解 Python super()](https://stackoverflow.com/questions/576169/understanding-python-super-and-init-methods)。

## UPD。

对于它的价值，如果你用 扩展一个类`__slots__`，通常你也应该添加`__slots__`一个子类，至少是一个空的。否则，无论如何都会创建一个实例字典，从而使`__slots__`基类实际上毫无用处。来自[Python 参考](http://docs.python.org/2/reference/datamodel.html#slots)：

> 声明的作用`__slots__`仅限于定义它的类。因此，子类将有一个`__dict__`除非它们也定义`__slots__`（它必须只包含任何*附加*插槽的名称）。

# php - 仅显示来自今天日期的 mysql 数据库中的数据

> ID：14187574
> 
> 赞同：-2
> 
> 时间：2013-01-06T22:40:46.177
> 
> 标签：php, mysql

我想使用 PHP 过滤我的结果，以仅显示今天插入的表中的数据。格式如下：

`date`表格中的列`daily`格式`2013-01-06 17:36:11`。如何使用 PHP 过滤查询以仅显示今天的查询？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T22:42:56.400

```
WHERE DATE(`date`) = DATE(NOW()) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T23:06:47.383

**在 sql 查询**的 where 子句中做更好的做法。扩展宇智波斑的回答：如果您使用的是 MySQL，您的查询将类似于：

```
SELECT * FROM daily WHERE DATE(`date`) = DATE(NOW()). 
```

如果出于某种奇怪的原因（我**不推荐）****必须**在 PHP 中执行此操作，则必须循环查询结果并将每个数据库行的日期字段与 PHP 中的今天日期进行比较。

 **```
//setup the array our filtered results will go in
$filteredResults = array();

//get the timestamp for 12:00:00am and 11:59:59pm today 
$greaterThanThisTime = mktime(0,0,0,date('n'),date('j'),date('Y'));
$lessThanThisTime = mktime(23,59,59,date('n'),date('j'),date('Y'));

//loop the database results
foreach($dbResults as $i=>$row) {
  $rowTimeStamp = strtotime($row['date']);
  if($rowTimeStamp>=$greaterThanThisTime && $rowTimeStamp<=$lessThanThisTime) {
    $filteredResults[] = $row;
  }
}

//continue to do whatever you need, using $filteredResults as your results 
```**

# regex - 在 Haskell 中匹配正则表达式模式的模式

> ID：14187577
> 
> 赞同：10
> 
> 时间：2013-01-06T22:41:08.567
> 
> 标签：regex, haskell, pattern-matching

在 Scala 中，我有一个像这样的正则表达式模式匹配：

```
val Regex = """(\d{4})/(\d{2})/(\d{2})""".r
val Regex(year, month, day) = "2013/01/06" 
```

结果是：

```
year: String = 2013
month: String = 01
day: String = 06 
```

如何在 Haskell 中完成类似的结果？换句话说，我可以匹配包含组的正则表达式并将组分配给标识符吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-06T23:01:32.383

这对我有用：

```
Prelude Text.Regex.Posix> "2013/01/06" =~ "([0-9]+)/([0-9]*)/([0-9]*)" :: (String,String,String,[String])
("","2013/01/06","",["2013","01","06"]) 
```

（OS X 上的 ghci 7.4.2）

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-01-07T15:23:32.157

扩展[Chris 的答案](https://stackoverflow.com/a/14187742/96233)，以下工作与我的 Scala 版本类似：

```
ghci> :m +Text.Regex.Posix
ghci> let (_, _, _, [year, month, day]) ="2013/01/06" =~ "([0-9]+)/([0-9]*)/([0-9]*)" :: (String,String,String,[String])
ghci> year
"2013"
ghci> month
"01"
ghci> day
"06" 
```

# android - 如何让菜单键在 Mac 上的 VirtualBox/Android x86 上工作？

> ID：14187579
> 
> 赞同：3
> 
> 时间：2013-01-06T22:41:22.480
> 
> 标签：android, macos, android-emulator, virtualbox, android-x86

我正在尝试使用 VirtualBox 和 Android x86 作为 Android SDK 附带的仿真器的更快替代方案，该仿真器非常滞后，无法在我的 2GHz 四核 Mac 上使用 16GB 内存。

本教程让我启动并运行，它看起来很活泼： http: [//www.bobbychanblog.com/2011/07/faster-android-emulator-alternative-using-virtualbox/](http://www.bobbychanblog.com/2011/07/faster-android-emulator-alternative-using-virtualbox/)

设置它不适合胆小的人，但总体上看起来是一个不错的选择。问题是，它将 PC 键盘上的上下文菜单键（底行，通常在 Windows 键旁边）映射到 Android 的菜单键。作为 Mac 用户，我没有这个密钥。

显然没有办法将它映射到其他东西，也没有办法用按钮或鼠标点击来模拟它。

这个线程有很多人要求它，但没有真正的解决方案： [http ://code.google.com/p/live-android/wiki/howtouse](http://code.google.com/p/live-android/wiki/howtouse)

一个人有一个需要编译 squashfs 工具（不管是什么）的方案，但是当他们开始谈论在 Solaris 机器上编译时我失去了兴趣 :)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T22:41:22.480

最后我发现这个键也称为“应用程序键”，并找到了一种在 Mac 上重新映射到它的方法。这个线程引导我找到解决方案：

[http://www.applevis.com/podcast/episodes/new-updated-remapping-keys-your-macs-keyboard-enhance-voiceover-experience](http://www.applevis.com/podcast/episodes/new-updated-remapping-keys-your-macs-keyboard-enhance-voiceover-experience)

诀窍是安装 PCKeyboardHack，它可以将某些键重新映射到任何键码。

确实没有太多好的选择。我选择了数字键盘上的回车键，并将其重新映射到键码 110，即 PC 应用程序键。奇迹般有效。

![PCKeyboardHack 屏幕](../Images/da86bda4f7f48ec720d49dd846d61540.png)

# javascript - javascript：可以添加在默认行为之后运行的事件处理程序吗？

> ID：14187585
> 
> 赞同：2
> 
> 时间：2013-01-06T22:41:49.970
> 
> 标签：javascript, event-handling

我有一个事件处理程序，我想在该事件的默认 javascript 处理发生后执行。

这可能吗？

编辑：例如：每次触发按键事件时，我都会记录有关该按键的事件信息（类似于 console.log）。现在，当我按下退格键并通过事件处理程序查看字段内容时，文本字段的值会生成没有退格键的值，因为事件处理程序在实际删除最后一个字母之前抓取了字段的内容。

在这种情况下，我希望发生默认的退格事件，然后在完成时触发我的事件处理程序。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-06T22:55:38.807

我相信您的问题是由监听 keypress 事件而不是[keyup](http://api.jquery.com/keyup/)事件引起的。基本上这意味着您在将字符放入 dom 之前获取 textarea 的值。

尝试将您的按键处理程序更改为按键处理程序。

一个例子是：

```
$('input, textarea').keyup(function(ev) {

    console.log( $(this).val() );

}); 
```

编辑：发现[这个](https://stackoverflow.com/questions/4690330/jquery-keypress-backspace-wont-fire)问题似乎是你的确切问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T23:05:19.657

我看到除了问题中的名称之外还有一个不同的问题。在这方面，+1 Sam :)。

但是，我想在这里解决这个问题，而不仅仅是分支。有一种方法可以处理特定的按键事件或默认为一个。

`keypress`气泡。所以使用一个全局的，然后在本地需要它的任何地方，使用`e.stopPropagation()`它来阻止它冒泡。这是它的工作演示：http: [//jsfiddle.net/2EwhR/](http://jsfiddle.net/2EwhR/)

这是html：

```
<div id="d1">_</div>
<br><hr>
<div id="d2"><input id="i1" type="text" /></div> 
```

js：

```
var d1 = document.getElementById("d1");
window.onkeypress = function(ev){
 d1.innerHTML = "keyCode: " + ev.keyCode;
};
var d2 = document.getElementById("d2");
var i1 = document.getElementById("i1");
d2.onkeypress = function(ev){
  d1.innerHTML = "blocked";
  ev.stopPropagation();
}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-06T22:53:21.810

这将是在事件冒泡到浏览器后运行自定义代码的一种方式，即首先将输入的值添加到文本字段，然后稍后您的自定义函数将运行。如果你愿意，你可以把这个时间缩短很多。

```
$("input").on("keypress", function () {
  setTimeout(function () {
    alert("new value should have been already added to text field. Now we are executing some custom stuff");
  }, 1000);
  return true;
}); 
```

[工作演示](http://jsfiddle.net/GEvww/)

# javascript - 使用 coffeescript 运行我的 node.js 应用程序时，module.exports 没有缓存

> ID：14187586
> 
> 赞同：3
> 
> 时间：2013-01-06T22:41:56.570
> 
> 标签：javascript, node.js, coffeescript

假设我有一个应用程序：

./app.coffee：

```
express = require "express"
module.exports = app = express()
require "./models" 
```

./models/index.coffee

```
app = require "../app" 
```

然后我运行命令：`coffee app.coffee`

问题是代码的运行方式与预编译时不同。

`node`当我使用（已编译）运行我的应用程序时：

*   `app.coffee`要求_`models`
*   `models`需要`app`并返回`module.exports`(app)

当我运行我的应用程序时`coffee`：

*   `app.coffee`要求_`models`
*   `models`需要`app`但应用程序再次运行并再次需要模型

运行我的应用程序时，module.exports 似乎无法正常工作`coffee`。或者也许我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T02:11:15.913

Node 具有用于管理[模块周期](http://nodejs.org/api/modules.html#modules_cycles)`coffee`的更改行为，在使用可执行文件时似乎不受支持：

> 当存在循环`require()`调用时，模块可能在返回时尚未执行完毕。
> 
> [...]
> 
> `main.js`加载时，`a.js`然后`a.js`依次加载`b.js`。此时，`b.js`尝试加载`a.js`. 为了防止无限循环，将导出对象的**未完成副本**`a.js`返回给`b.js`模块。`b.js`然后完成加载，并将其导出对象提供给`a.js`模块。

如果可以的话，尽量避免循环。一种可能的选择是：

```
express = require "express"
module.exports = app = express()
models = require "./models"
models app 
```

```
module.exports = (app) ->
  # ... 
```

# php - php数值数组处理

> ID：14187589
> 
> 赞同：0
> 
> 时间：2013-01-06T22:42:08.137
> 
> 标签：php, arrays, variables

我正在尝试从文本框发布的数据中处理一个数组。
我编写了以下代码来修剪每一行，除了一件事之外，我几乎所有的东西都工作得很好。我相信我需要通过这个 GeoIP 函数迭代我的数字数组：
`$record = geoip_record_by_addr($gi,$value);`，但它只处理数组中的最后一个 IP，而不是整个东西。

我的 var_dump：字符串（12）“65.87.12.213”字符串（12）“13.15.200.36”

```
$gi = geoip_open("/tmp/GeoIPCity.dat",GEOIP_STANDARD);

$iips = explode("\n", $_POST["ip"]);
$iiips=array_map('trim',$iips);
foreach($iiips as $key => $value) {
    $record = geoip_record_by_addr($gi,$value);
}
print $record->city . "\n";
print $record->region . " " . "\n";
print $record->country_name . "\n";

$record1 = $record->city . " " . $record->region . " " . $record->country_name;

var_dump($record1); 
```

有没有人可以帮忙？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T22:44:44.053

在`foreach`循环内部，你一直覆盖`$record`变量，所以最后你有最后一个。

将所有记录存储到另一个数组中，你应该没问题。

所以这只是你犯的一个或多或少简单的错误。

```
$records = array();
foreach ($iiips as $key=>$value) {
    $records[] = geoip_record_by_addr($gi, $value);
}

foreach ($records as $record) {

    echo $record->city, "\n",
         $record->region, "\n",
         $record->country_name, "\n";

    $record_string = $record->city . " " . $record->region . " " . $record->country_name;

    var_dump($record_string);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T22:48:24.277

而不是`$record = geoip_record_by_addr($gi,$value);`，请执行以下操作：

```
$record = array();
foreach($iiips as $value) { // key isnt needed.
    array_push($record, geoip_record_by_addr($gi,$value));
} 
```

然后您就可以`$record`按照您的预期自由使用 的内容了。在任何循环中重新分配变量都会每次更改该特定变量的值。PHP 不知道您正在使用数组，除非您告诉它。

# ios - 跟踪指定 UIViewController 子类的所有触摸

> ID：14187594
> 
> 赞同：1
> 
> 时间：2013-01-06T22:42:37.170
> 
> 标签：ios, cocoa-touch, uitouch, uicollectionview, touchesbegan

我想跟踪指定的 UIViewController 子类中的所有用户触摸，例如 MyViewController。

由于这个 UIViewController 可能包含 UIKit-Elements，例如 UIButtons 等。我想在 MyViewController 的视图中的其他视图之上放置一个清晰的触摸跟踪 UIView。

现在我将触摸事件发送到 UIView，但我不知道如何将触摸委托给其他子视图。

我已经尝试遍历所有 MyViewController 的视图子视图（触摸跟踪 UIView 除外）并向它们发送 touchesBegan:withEvent:、touchesMoved:withEvent: 等。

但这不适用于 UICollectionViews。

我基本上需要的是跟踪 MyViewController 的视图框架中的所有触摸事件。MyViewController 本身可以继承需要响应触摸事件的各种其他视图。

我还在这里（http://stackoverflow.com/questions/8423174/detecting-all-touches-in-an-app）找到了继承 UIWindow 并覆盖 sendEvent 的想法：这在我的情况下是可能的，但后来我无论 MyViewController 是否可见，都必须启用/禁用触摸跟踪。另外我还不知道如何区分 touchesBegan:withEvent、touchesMoved:withEvent: 等。

提前致谢。

干杯，浴缸

在 MyViewController.m

```
- (void)loadView
{
    [super loadView];

    VETouchTrackingView *touchTrackingView;
    touchTrackingView = [[VETouchTrackingView alloc] initWithFrame:self.view.frame];
    touchTrackingView.userInteractionEnabled = YES;

    self.touchTrackingView = touchTrackingView;
    [self.view addSubview:self.touchTrackingView];
    [self.view bringSubviewToFront:self.touchTrackingView];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T03:50:26.433

我设法通过覆盖我的 UIWindow 子类中的 sendEvent: 来获得我需要的触摸跟踪。

这很好用。

这里是任何也需要这个的人的 github 项目：[https ://github.com/bhr/BHTouchTracking](https://github.com/bhr/BHTouchTracking)

# php - 在页脚中显示 topLinks 作为页眉

> ID：14187595
> 
> 赞同：0
> 
> 时间：2013-01-06T22:42:43.387
> 
> 标签：php, magento, magento-1.7

我正在调整主题 Magento Modern 以用作新主题，并且我还需要在页脚的页眉中显示 topLinks。我发现一两个帖子试图展示该怎么做，但我并没有真正让它发挥作用。有人可以为我提供一种简单的方法来将此块插入页脚，确保它也保留在页眉中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T22:52:03.593

幸运的是，这可以使用布局更新指令来完成，因为标准页脚块模板会回显所有子级。使用原始的**topLinks**块实例很重要，因为它的内容由多个模块更新。您可以通过在自定义主题中创建*local.xml*`insert()`文件并将块添加到页脚来添加这些：

```
<?xml version="1.0" encoding="UTF-8"?>
<layout>
    <reference name="footer">
        <action method="insert">
            <block>top.links</block>
        </action>
    </reference>
</layout> 
```

# entity-framework - 生成 CodeFirst 重复外键 - EntityFramework

> ID：14187596
> 
> 赞同：1
> 
> 时间：2013-01-06T22:42:54.630
> 
> 标签：entity-framework, foreign-keys, code-first

好的，您可以在下面看到我的简化模型。如果我遗漏了映射，那么每次我在下面的示例代码中添加一个相关的新集合（例如**请求**或**邀请）时，都会在我的基本****BusinessCardActions**表中的数据库中生成各种重复的键。

 ****```
// DbContext 

public DbSet<BusinessCardAction> BusinessCardActions { get; set; }

// Classes
public abstract class BusinessCardAction
{
    public Int32 Id { get; set; }
    public User User { get; set; }
    public Int32 UserId { get; set; }
    public Int32 OtherUserId { get; set; }
    public User OtherUser { get; set; }
    public Guid UniqueId { get; set; }
    public String Email { get; set; }
    public String OtherEmail { get; set; }
    public Int32 UserAction { get; protected set; }
    public DateTime ActionDate { get; set; }
}
public abstract  class StatusAction : BusinessCardAction
{
    public Int32 Status { get; set; }
    public String Password { get; set; }
}
public class Request : StatusAction
{
    public Int32 InviteId { get; set; }
}
public class Acceptance : BusinessCardAction
{
}
public class Nudge : BusinessCardAction
{
}

public class User
{
    public Int32 Id { get; set; }
    public ICollection<Associate> AssociatedUsers { get; set; }
    public ICollection<Request> Requests { get; set; }
    public ICollection<Invite> Invites{ get; set; }
    public ICollection<BusinessCardAction> RecentActions { get; set; }
} 
```

现在，如果在派生类之间无法在我的基类中共享外键列，那么我对这些重复列没有什么大问题。但这不是发生的事情。以下插入后的链接中显示的数据表明它们都共享所需的**UserId**列。

我创建了一些测试代码，并在添加数据后添加了指向结果的链接。

```
var accept = new Acceptance()
    {
        Email = "tsie@mail.com",
        OtherUserId = 2,
        UserId = 1,
        OtherEmail = "jaim@l8.ca",
        Associate = "James",
        ActionDate = DateTime.Now
    };
var invite = new Invite()
    {
        Email = "tsie@ail.com",
        OtherUserId = 2,
        UserId = 1,
        OtherEmail = "jai@llev8.ca",
        Status = 1,
        Password = "Password",
        ActionDate = DateTime.Now
    };
var request = new Request()
    {
        Email = "tst@mail.com",
        OtherUserId = 2,
        UserId = 1,
        OtherEmail = "jai@llev8.ca",
        Password = "********",
        Status = 2,
        ActionDate = DateTime.Now
    };

var nudge = new Nudge()
    {
        Email = "tsi@ail.com",
        OtherUserId = 2,
        UserId = 1,
        OtherEmail = "jai@lev8.ca",
        ActionDate = DateTime.Now
    };
_businessCardActionService.Data.BusinessCardActions.Add(accept);
_businessCardActionService.Data.BusinessCardActions.Add(invite);
_businessCardActionService.Data.BusinessCardActions.Add(request);
_businessCardActionService.Data.BusinessCardActions.Add(nudge);
_businessCardActionService.Save(); 
```

通过此链接查看前面插入后的 BusinessCardActionsData [http://screencast.com/t/JKBcpaCT742](http://screencast.com/t/JKBcpaCT742)

如您所见，不同类型的存储在基类表中。不幸的是，表格末尾有一些流氓未使用的列似乎无用。我一直在尝试映射它们，以便这些列在生成的代码中消失。

这是类的映射部分。

...

```
modelBuilder.Entity<Nudge>()
    .HasRequired(i => i.User)
    .WithMany()
    .HasForeignKey(i => i.UserId)
    .WillCascadeOnDelete(false);

modelBuilder.Entity<Acceptance>()
    .HasRequired(a => a.User)
    .WithMany()
    .HasForeignKey(a => a.UserId)
    .WillCascadeOnDelete(false);

modelBuilder.Entity<Nudge>()
    .HasRequired(i => i.OtherUser)
    .WithMany()
    .HasForeignKey(i => i.OtherUserId)
    .WillCascadeOnDelete(false);

modelBuilder.Entity<Acceptance>()
    .HasRequired(a => a.OtherUser)
    .WithMany()
    .HasForeignKey(a => a.OtherUser)
    .WillCascadeOnDelete(false); 
```

我只是得到以下错误，而不是一个很好生成的数据库表，这在某种程度上是有道理的，但同时不知何故让我很恼火。也许有办法做到这一点，但我还没有找到它。

在类型“Ellevate.BusinessCards.Models.BusinessCardAction”上声明的导航属性“用户”已配置有冲突的多重性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T03:45:45.703

您有两个来自实体的`Act`引用。`U2`在这种情况下，您需要为这两个编写绑定，因为 EF 不知道要映射哪个外键。

```
modelBuilder.Entity<ACT>()
    .HasRequired(a => a.OtherU2)
    .WithMany(u2=>u2.OtherActs)
    .HasForeignKey(a => a.OtherU2Id)
    .WillCascadeOnDelete(false);

modelBuilder.Entity<ACT>()
    .HasRequired(a => a.U2)
    .WithMany(u2=>u2.OtherActs)
    .HasForeignKey(a => a.U2Id)
    .WillCascadeOnDelete(false); 
```

我认为要给出确切的答案，我们需要更多信息。好像你错过了一些匿名化你的实体的东西。在此处查看更多信息[Entity Framework Code First - 来自同一个表的两个外键](https://stackoverflow.com/questions/5559043/entity-framework-code-first-two-foreign-keys-from-same-table)****

# javascript - 如何确定我当前正在处理最后一个 touchmove 事件？

> ID：14187600
> 
> 赞同：2
> 
> 时间：2013-01-06T22:43:15.400
> 
> 标签：javascript, html, dom-events, multi-touch, touchmove

正如我在[本主题](https://stackoverflow.com/a/14176911/340947)中确定的那样，该`touchmove`事件可能会根据被触摸的元素组合分批发送。

如果我有三个手指分别触摸不同的元素，但我仍然希望能够一起处理所有三个手指的运动（例如，定义这三个元素的共同父元素上的交互），我基本上必须合并来自触摸事件的数据，这些数据可能以`touchmove`每个设备输入样本的三个事件的“块”形式发出。

虽然一个简单的解决方法是“制作一个大的覆盖元素”并以通常的方式处理它，但我打算追求将复杂 DOM 结构上的复杂操作包装在一段易于部署的代码中的圣杯。

因此很明显，我想要么使用`touches`last-inbound 中列表外的数据`touchmove`，要么收集`changedTouches`每个`touchmove`. 我目前一直在编写一个跟踪触摸标识符的例程，一旦它看到一个重复的，它就会知道我们正在查看`touchmove`下一组中的第一个（下一个输入刻度）。

这显然不是最理想的，因为我现在在处理输入时引入了长达 16 毫秒的延迟。

我确实想出了一些可行的方法：如果事件是按照触摸的顺序发送的`identifiers`，那么当我处理以`changedTouches`对应于创建的最高编号的触摸结尾的列表时`identifier`（我从事件`touchstart`），那么这足以表明我已经`touchmoves`从硬件接收到当前时间步长的所有信息。

更新：我实现的是一个跟踪*其中一个*手指的变量，一旦它在 a 中看到那个手指`touchmove` `changedTouches`，它就会运行一个循环来处理`touches`. 这完全无法提供正确的信息。它检查的一次触摸可能不会移动，在这种情况下`changedTouches`会为它生成 no。

我还能做什么？

# ruby-on-rails - 使用 Capistrano、Unicorn 和 RVM 在 VPS 上部署 Rails

> ID：14187602
> 
> 赞同：2
> 
> 时间：2013-01-06T22:43:43.153
> 
> 标签：ruby-on-rails, deployment, nginx, capistrano, unicorn

之上

```
cap deploy:cold 
```

我的 capistrano 食谱效果很好，但在这部分卡住了：

```
 * 2013-01-06 23:07:08 executing `deploy:start'
  * executing "/etc/init.d/seventysix_unicorn start"
    servers: ["xxxxxxxxxxxxx"]
    [xxxxxxxxxxxxx] executing command
  ** [out :: xxxxxxxxxxxxx] Password: 
```

并永远在这里等待。访问网页后，我可以看到 nginx 运行正常，但 unicorn 没有。即使我通过以下方式手动启动独角兽：

```
cd $APP_ROOT; bundle exec unicorn -c $APP_ROOT/config/unicorn.rb 
```

并重新加载页面，页面似乎正在处理某些事情（指示浏览器中进度的圆圈图标正在旋转）但大约 30 秒后，它停止，将我重新路由到默认的 500.html。

这是我的部署配置。

**nginx.conf**

```
 1 upstream unicorn {
  2   server unix:/tmp/unicorn.seventysix.sock fail_timeout=0;
  3 }
  4 
  5 server {
  6 
  7   listen 80 default deferred;
  8   server_name www.example.com example.com;
  9   root /home/mr_deployer/apps/seventysix/current/public;
 11 
 12   location ^~ /assets/ {
 13     gzip_static on;
 14     expires max;
 15     add_header Cache-Control public;
 16   }
 17 
 18   try_files $uri/public $uri @unicorn;
 19 
 20   location @unicorn {
 21     proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
 22     proxy_set_header Host $http_host;
 23     proxy_redirect off;
 24     proxy_pass http://unicorn;
 26   }
 27 
 28   error_page 500 502 503 504 /500.html;
 29   client_max_body_size 4G;
 30   keepalive_timeout 10;
 31 
 32 } 
```

**独角兽.rb**

```
 1 root = "/home/mr_deployer/apps/seventysix/current"
  3 
  4 working_directory root
  5 pid "#{root}/tmp/pids/unicorn.pid"
  6 stderr_path "#{root}/log/unicorn.log"
  7 stdout_path "#{root}/log/unicorn.log"
  8 
  9 listen "/tmp/unicorn.seventysix.sock"
 10 worker_processes 2
 11 timeout 30 
```

**unicorn_init.sh**

```
 1 #!/bin/sh

 28 APP_ROOT=/home/mr_deployer/apps/seventysix/current
 29 RAILS_ENV=production
 32 USER=mr_deployer
 33 
 34 PID=$APP_ROOT/tmp/pids/unicorn.pid
 35 CMD="cd $APP_ROOT; bundle exec unicorn -c $APP_ROOT/config/unicorn.rb -E $RAILS_ENV -D"
 38 
 39 action="$1"
 40 set -u
 41 
 42 old_pid="$PID.oldbin"
 43 
 44 cd $APP_ROOT || exit 1
 45 
 46 sig () {
 47   test -s "$PID" && kill -$1 `cat $PID`
 48 }
 49 
 50 oldsig () {
 51   test -s $old_pid && kill -$1 `cat $old_pid`
 52 }
 53 
 54 case $action in
 55 
 56 start)
 57   sig 0 && echo >&2 "Already running" && exit 0
 58   su $USER -c "$CMD"
 59   ;;
 60 
 61 stop)
 62   sig QUIT && exit 0
 63   echo >&2 "Not running"
 64   ;;
 65 
 66 force-stop)
 67   sig TERM && exit 0
 68   echo >&2 "Not running"
 69   ;;
 70 
 71 restart|reload)
 72   sig HUP && echo reloaded OK && exit 0
 73   echo >&2 "Couldn't reload, starting '$CMD' instead"
 74   su $USER -c "$CMD"
 75   ;;
 76 
 77 upgrade)
 78   if sig USR2 && sleep 2 && sig 0 && oldsig QUIT
 79   then
 80     n=$TIMEOUT
 81     while test -s $old_pid && test $n -ge 0
 82     do
 83       printf '.' && sleep 1 && n=$(( $n - 1 ))
 84     done
 85     echo
 86     if test $n -lt 0 && test -s $old_pid
 87     then
 88       echo >&2 "$old_pid still exists after $TIMEOUT seconds"
 89     exit 1
 90   fi
 91   exit 0
 92   fi
 93   echo >&2 "Couldn't upgrade, starting '$CMD' instead"
 94   su $USER -c "$CMD"
 95   ;;
 96 reopen-logs)
 97   sig USR1
 98   ;;
 99 
100 *)
101 
102 echo >&2 "Usage: $0 <start|stop|restart|upgrade|force-stop|reopen-logs>"
103   exit 1
104   ;;
105 esac 
```

**部署.rb**

```
 1 require "bundler/capistrano"
  2 
  3 set :rvm_ruby_string, '1.9.3-p125@seventysix'
  4 
  5 require "rvm/capistrano" # Load RVM's capistrano plugin.
  6 
  7 server "176.58.126.11", :web, :app, :db, primary: true
  8 
  9 set :application, "seventysix"
 10 set :user, "mr_deployer"
 11 set :deploy_to, "/home/#{user}/apps/#{application}"
 12 set :deploy_via, :remote_cache
 13 set :use_sudo, false
 14 
 15 set :scm, "git"
 16 set :repository, "git@github.com:ofcan/#{application}.git"
 17 set :branch, "master"
 18 
 19 default_run_options[:pty] = true
 20 ssh_options[:forward_agent] = true
 21 
 22 after "deploy", "deploy:cleanup" # keep only the last 5 releases
 23 
 24 namespace :deploy do
 25 
 26   %w[start stop restart].each do |command|
 27     desc "#{command} unicorn server"
 28       task command, roles: :app, except: {no_release: true} do
 29       run "/etc/init.d/#{application}_unicorn #{command}"
 30     end
 31   end
 32 
 33   task :setup_config, roles: :app do
 34     sudo "ln -nfs #{current_path}/config/nginx.conf /etc/nginx/sites-enabled/#{application}"
 35     sudo "ln -nfs #{current_path}/config/unicorn_init.sh /etc/init.d/#{application}_unicorn"
 36     run "mkdir -p #{shared_path}/config"
 37     put File.read("config/database.example.yml"), "#{shared_path}/config/database.yml"
 38     puts "Now edit the config files in #{shared_path}."
 39   end
 40 
 41   after "deploy:setup", "deploy:setup_config"
 42 
 43   task :symlink_config, roles: :app do
 44     run "ln -nfs #{shared_path}/config/database.yml #{release_path}/config/database.yml"
 45   end
 46 
 47   after "deploy:finalize_update", "deploy:symlink_config"
 48     desc "Make sure local git is in sync with remote."
 49     task :check_revision, roles: :web do
 50       unless `git rev-parse HEAD` == `git rev-parse github/master`
 51       puts "WARNING: HEAD is not the same as github/master"
 52       puts "Run `git push` to sync changes."
 53       exit
 54     end
 55   end
 56 
 57   before "deploy", "deploy:check_revision"
 58 
 59 end 
```

我也在使用 RVM。我知道 RVM 文档建议为独角兽创建包装器，但我不知道如何创建它。另外，为什么 Unicorn 在 VPS 上使用我之前说的那个命令手动启动时会超时？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T10:07:47.950

本周我遇到了类似的问题，使用 Nginx 1.2.6。

我将拍摄所有可能解决这个问题的解决方案，我花了很多时间让它发挥作用。评论是否对您有用：

1.  我删除了 gzip（整个`location ^~ /assets/`节点）。我不知道为什么它不起作用，而且我在 S3 上托管资产，所以我不太在意。

2.  要从 bash 脚本访问 unicorn，您有两种选择：使用`bundle`或使用已启动的可执行文件：

### 将独角兽与*捆绑*一起使用：

您需要在您的 APP_ROOT 中自动信任 RVM，方法是在您的主目录中创建一个文件：`/home/mr_deployer/.rvmrc`其内容为：

```
export rvm_trust_rvmrcs_flag=1 
```

然后，如果您还没有，请将`.rvmrc`文件添加到您的 APP_ROOT

```
rvm --create use  "1.9.3-p125@seventysix" 
```

最后更改`;`为`&&`：

```
cd $APP_ROOT && bundle exec unicorn -c $APP_ROOT/config/unicorn.rb 
```

### 或者，使用带有*rvm 启动可执行文件*的独角兽：

在你的服务器上运行这个：

```
rvm wrapper 1.9.3-p125@seventysix bootup unicorn 
```

然后，您的命令应如下所示

```
 /home/mr_deployer/.rvm/bin/bootup_unicorn -c $APP_ROOT/config/unicorn.rb -E $RAILS_ENV -D 
```

我应该补充一点，我是`service unicorn_blah`从我的部署者用户运行的，它工作正常。没有 root 或 sudo。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T22:47:53.793

我*认为*您的 unicorn start 命令作为 sudo 运行并且需要密码（未设置 sudoless 密码）。

我的假设是您的 capistrano 脚本的其余部分已正确执行并且它已连接到远程服务器以执行此操作（因此这不是 SSH 请求交互式登录）。

> 并重新加载页面，页面似乎正在处理某些事情（指示浏览器中进度的圆圈图标正在旋转）但大约 30 秒后，它停止，将我重新路由到默认的 500.html。

这是 nginx 尝试连接到下游（独角兽）服务器并在默认超时（30 秒）后超时，并返回 500。

这很奇怪，因为这意味着 unix 套接字处于活动状态（否则 nginx 将返回错误的网关，而不是服务器错误），但套接字没有响应。

# jsf - 从未呈现的 ViewScoped bean 添加的 FacesMessage

> ID：14187606
> 
> 赞同：3
> 
> 时间：2013-01-06T22:44:40.517
> 
> 标签：jsf, jakarta-ee, jsf-2

我有一个具有以下方法的 ViewScoped bean：

```
public Item getItem()  
{
     try {
          itemID = Integer.parseInt(
             FacesContext.getCurrentInstance().getExternalContext()
                         .getRequestParameterMap().get("itemID"));  
     } catch(NumberFormatException ex) {
          FacesContext.getCurrentInstance().addMessage(null, new FacesMessage(
                       FacesMessage.SEVERITY_ERROR, "Item lookup error", null));
          return null;  
     }  
     return itemsDAO.findByID(itemID);
} 
```

该方法采用 ViewID 参数并使用`itemsDAO`. 如果 itemID 不是整数，我想通过捕获`NumberFormatException`并在其中添加消息来显示 FacesMessage。然而，这不起作用。上面的`FacesMessage`代码片段中的不呈现在下面的视图标签内`h:messages globalOnly="true" infoClass="info" errorClass="error"`

我怀疑在`FacesContext`调用该方法时它不可用，但我不知道如何处理这个异常。

更新1：

关于使用 viewParam 使用内置转换和验证的建议。我不知道在这种情况下这将如何工作。itemID 是从“索引”视图传递的，其中列出了所有项目，如下所示。每个项目标题都是指向 viewItem 页面的链接，其中 itemID 通过 URL 传递。鉴于索引视图有很多项目，在这种情况下，如何使用 viewParam 将 itemID 传递给 viewItem 视图？

索引.xhtml

```
<code>
 <ui:repeat var="item" value="#{ItemViewBean.items}">
       <div id="item">
        <h:link value="#{item.title}" outcome="viewItem">
        <f:param name="itemID" value="#{item.id}"></f:param>
        </h:link>
        <p><h:outputText value="#{item.description}"></h:outputText> <br />
        Address: <h:outputText value="#{item.address}"></h:outputText></p>
        <span class="itemFooter">
        Submitted By: <h:outputText value="#{item.user.username}"></h:outputText> On
        <h:outputText value="#{item.postDate}"></h:outputText>
        </span>
       <hr />
       </div>
       </ui:repeat>
</code> 
```

更新 2：我想出了一个解决这个问题的方法。如果发生异常，我将错误 FacesMessage 放在 Flash 对象中并重定向到某个错误页面。我仍然不明白为什么不能简单地将 FacesMessage 添加到 FacesContext 并显示在视图上。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T23:29:05.687

鉴于您正在遍历`ExternalContext#getRequestParameterMap()`，您似乎正在拦截 GET 请求。鉴于它发生在 getter 方法中（[糟糕！！](https://stackoverflow.com/questions/2090033/why-jsf-calls-getters-multiple-times/2090062#2090062)），它似乎仅在`item`要呈现引用该属性的组件时执行。

因此，假设上述假设成立，那么当`<h:messages>`组件在视图中声明在引用该属性的组件*之前，就会出现此问题。*`item`然后将新消息添加到面孔上下文中为时已晚。那个`<h:messages>`时候*已经*渲染了。

我至少想不出与此特定问题症状相匹配的其他合理原因。该问题基本上有2个解决方案：

1.  将`<h:messages>`移到引用该属性的组件*之后*`item`，以便在添加 faces 消息*后呈现它。*

2.  在预渲染视图事件期间执行业务作业`<f:event>`，最好结合`<f:viewParam>`将请求参数设置为 bean 属性。`<f:viewParam>`鉴于您的不良吸气剂方法的唯一工作是转换价值，您甚至可以单独使用 a与转换器组合。

不用说选项 2 是首选，因为您目前基本上在滥用/解决一些基本的 JSF 概念。其中，业务逻辑不属于 getter。

例如

```
<f:metadata>
    <f:viewParam id="itemID" name="itemID" value="#{bean.item}"
        required="true" requiredMessage="Invalid page access. Please use a link from within the system."
        converter="itemConverter" converterMessage="Unknown item ID."
    />
</f:metadata>
<h:message for="itemID" /> 
```

和

```
private Item item; // +getter +setter 
```

这`itemConverter`只是一个`Converter`实现，其中请求参数被转换为方法中的`Item`实例`getAsObject()`。

### 也可以看看：

*   [<f:metadata>、<f:viewParam> 和 <f:viewAction> 可以用来做什么？](https://stackoverflow.com/questions/6377798/what-can-fmetadata-and-fviewparam-be-used-for/6377957#6377957)
*   [JSF 2.0 中的通信 - 处理 GET 请求参数](http://balusc.blogspot.com/2011/09/communication-in-jsf-20.html#ProcessingGETRequestParameters)

# ios - NSFetchedResultsController 没有将数据更新到 UITableViewController

> ID：14187610
> 
> 赞同：0
> 
> 时间：2013-01-06T22:44:55.273
> 
> 标签：ios, xcode, core-data, nsfetchedresultscontroller

我有这个功能：

```
- (void)initFetchRequest
{
    NSManagedObjectContext *context = self.managedObjectContext;
    NSFetchRequest *request = [[NSFetchRequest alloc] init];
    request.entity = [NSEntityDescription entityForName:@"Shindy" inManagedObjectContext:self.managedObjectContext];
    // Configure the request's entity, and optionally its predicate.
    NSSortDescriptor *sortDescriptor = [[NSSortDescriptor alloc] initWithKey:@"details" ascending:YES];
    NSArray *sortDescriptors = [[NSArray alloc] initWithObjects:sortDescriptor, nil];
    [request setSortDescriptors:sortDescriptors];

    fetchedResultsController = [[NSFetchedResultsController alloc]
                                              initWithFetchRequest:request
                                              managedObjectContext:context
                                              sectionNameKeyPath:nil
                                              cacheName:nil];

    NSError *error = nil;
    [self.managedObjectContext executeFetchRequest:request error:&error];
    [fetchedResultsController performFetch:&error];

    if (![self.fetchedResultsController performFetch:&error]) {
        NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
    }    
} 
```

在我的`viewDidLoad`方法中使用以下内容

```
NSURL *url = [NSURL fileURLWithPath:[NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) lastObject]];
document = [[UIManagedDocument alloc] initWithFileURL:url];
self.managedObjectContext = document.managedObjectContext;

[self initFetchRequest]; 
```

最后，这在我的`cellForRowAtIndexPath`

```
Shindy *shindy = [fetchedResultsController objectAtIndexPath:indexPath];
cell.textLabel.text = shindy.details; 
```

数据是从另一个控制器输入的，当我回到这个控制器时，`UITableViewController`它没有更新。

我在这里想念什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T23:21:47.500

如果您从另一个视图控制器返回（例如在导航控制器中弹出），`viewDidLoad`则不会调用您的。因此您的数据不会被更新。如果你想让这种情况发生，你应该实现[NSFetchedResultsControllerDelegate](http://developer.apple.com/library/ios/#documentation/CoreData/Reference/NSFetchedResultsControllerDelegate_Protocol/Reference/Reference.html)和 set `fetchedResultsController.delegate = self;`。每当发生更改时，它将更新您的表。有一个不太优雅的解决方案可以调用您的`initFetchRequest`方法，`viewWillAppear`但我会推荐第一个解决方案。希望这可以帮助！

# forms - 在 Wordpress 3.5 上的自己的插件中显示媒体上传器

> ID：14187611
> 
> 赞同：1
> 
> 时间：2013-01-06T22:44:59.877
> 
> 标签：forms, wordpress, media, uploader

我对新 WordPress 3.5 中的媒体上传器没有什么问题。我创建了自己的插件来上传图片。我正在使用这段代码 JS：

```
<script type="text/javascript">
    var file_frame;

    jQuery('.button-secondary').live('click', function( event ){

        event.preventDefault();

        if ( file_frame ) {
            file_frame.open();
            return;
        }

        file_frame = wp.media.frames.file_frame = wp.media(
            {
                title: 'Select File',
                button: {
                    text: jQuery( this ).data( 'uploader_button_text' )
                },
                multiple: false
            }
        );

        file_frame.on('select', function() {
            attachment = file_frame.state().get('selection').first().toJSON();
            jQuery('#IMGsrc').val(attachment.url);
        });

        file_frame.open();
    });
</script> 
```

代码工作正常，但不幸的是表单似乎不完整。当我选择任何图片时，右侧不会显示“附件显示设置”。我不知道为什么。我尝试向媒体添加选项：

```
displaySettings: true,
displayUserSettings: true 
```

但它也不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-09T06:07:40.673

页面是否`<script type="text/html" id="tmpl-attachment-details">...`在源代码中有模板？如果没有，您需要调用 wp_print_media_templates()，从 wp-includes/media-template.php 编写样式

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-25T03:59:59.360

这是我使用的代码。资料来源： http: [//mikejolley.com/2012/12/using-the-new-wordpress-3-5-media-uploader-in-plugins/](http://mikejolley.com/2012/12/using-the-new-wordpress-3-5-media-uploader-in-plugins/) 它似乎工作得很好，但左边的侧边栏不见了。（故意的，但无论如何我都不想要它）。

```
<?php wp_enqueue_media(); ?>

<script>

function showAddPhotos() {

// Uploading files
var file_frame;

// event.preventDefault();

// If the media frame already exists, reopen it.
if ( file_frame ) {
  file_frame.open();
  return;
}

// Create the media frame.
file_frame = wp.media.frames.file_frame = wp.media({
  title: jQuery( this ).data( 'uploader_title' ),
  button: {
    text: jQuery( this ).data( 'uploader_button_text' ),
  },
  multiple: false  // Set to true to allow multiple files to be selected
});

// When an image is selected, run a callback.
file_frame.on( 'select', function() {
  // We set multiple to false so only get one image from the uploader
  attachment = file_frame.state().get('selection').first().toJSON();

  // Do something with attachment.id and/or attachment.url here
});

// Finally, open the modal
file_frame.open();

}
</script> 
```

# php - 没有设置主机头

> ID：14187613
> 
> 赞同：1
> 
> 时间：2013-01-06T22:45:23.090
> 
> 标签：php, curl

我有一个 PHP 脚本可以为我的网站缓存做准备。

我正在尝试绕过 Nginx 前端并从 Apache 后端获取标头。

以下示例有效（通过命令行）：

```
curl -I -H "Host: example.com" 127.0.0.1 
```

但是，当我尝试在 PHP 中做同样的事情时 - 它没有。

```
$headers = array("Host: example.com");
$url = "127.0.0.1";
$ch = curl_init();
curl_setopt ($ch, CURLOPT_URL, $url);
curl_setopt ($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt ($ch, CURLOPT_CONNECTTIMEOUT, 60);
curl_setopt ($ch, CURLOPT_HEADER, true);
curl_setopt ($ch, CURLOPT_NOBODY, true);
curl_setopt ($ch, CURLOPT_HTTPHEADER, $headers);
$ret = curl_exec ($ch);
curl_close ($ch);

echo "$ret"; 
```

这总是返回我的 apache 虚拟主机文件中列出的第一个网站——而不是“主机”http 标头中列出的网站。

知道为什么它可以通过命令行正常工作 - 但不是在 php 脚本中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T22:50:35.540

我不知道这是否可能，但是我会尝试在初始化时传递 URL：

```
$ch = curl_init($url); 
```

然后*不*与`curl_setopt`. 这只是一个测试建议，不能保证这会有所帮助。所以更冗长的评论。

您还可以启用详细模式并*查看*curl 为请求标头发送的具体内容，我在此处的答案中对此进行了概述：[错误请求。通过主机和系统上的 curl 连接到站点](https://stackoverflow.com/a/9571305/367456)。这应该显示幕后发生的事情，如果您尚未嗅探网络流量，这将非常有用。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-06T22:52:12.050

我想[这](http://php.net/manual/en/function.curl-setopt.php#53445)就是答案。

“改为这样做：

```
$host = "www.example.com"; 
$url = "http://$host/"; 

$ch = curl_init(); 

curl_setopt($ch, CURLOPT_URL, $url); 
```

"

# windows-phone-7 - 应用程序发布后 WP7 推送通知不起作用

> ID：14187617
> 
> 赞同：0
> 
> 时间：2013-01-06T22:45:38.727
> 
> 标签：windows-phone-7, push-notification, toast, mpns

我正在为我的手机应用程序使用 toast 通知。当应用程序首次在某人的手机上启动时，它将获取推送通知 URL，然后将其存储在我们的数据库中，以便我们可以将通知发送给用户。

在测试中，使用模拟器和在我的 HTC WP7 上进行测试，发现并上传了通知。

现在应用程序在商店中，通知 URL 将作为 NULL 到达服务器。在应用仪表板中，我得到以下信息：

缺少经过身份验证的推送通知的证书：经过身份验证的推送通知的证书

这会导致问题吗？如果是这样，我该如何获得这个证书？我在任何地方都找不到与此相关的任何内容。

下面是一个代码片段，它在测试中有效，但由于发布到商店总是返回 NULL：

```
private void BindChannel()
    {
        channel = HttpNotificationChannel.Find(channelName);

        if (channel == null || channel.ChannelUri == null)
        {
            if (channel != null) DisposeChannel();

            channel = new HttpNotificationChannel(channelName);
            channel.ChannelUriUpdated += channel_ChannelUriUpdated;
            channel.Open();
        }
        else
        {
            StorageSettings.StoreSetting("NotifyURL", channel.ChannelUri.AbsoluteUri); 
        }

        SubscribeToChannelEvents();

        if (!channel.IsShellTileBound) channel.BindToShellTile();
        if (!channel.IsShellToastBound) channel.BindToShellToast();

        string notificationUri = string.Empty;

        if (StorageSettings.TryGetSetting<string>("NotifyURL", out notificationUri))
        {
            if (notificationUri != channel.ChannelUri.AbsoluteUri)
            {
                StorageSettings.StoreSetting("NotifyURL", channel.ChannelUri.AbsoluteUri);
            }
        }
        else
        {
            if (channel.ChannelUri != null)
            {
                StorageSettings.StoreSetting("NotifyURL", channel.ChannelUri.AbsoluteUri);
            }
        }

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T10:47:36.900

实际上，我也得到了空 url，但在我这边，它的 WNS 在一段时间后没有响应，它会正常工作。

我认为下面的链接可能会对你有所帮助

[推送通知概述](http://msdn.microsoft.com/en-in/library/windows/apps/hh913756.aspx)

[如何使用 Windows 推送通知服务 (WNS) 进行身份验证 (Windows)](http://msdn.microsoft.com/en-in/library/windows/apps/hh465407.aspx)

# phpbb - phpbb错误的发布顺序

> ID：14187619
> 
> 赞同：0
> 
> 时间：2013-01-06T22:45:52.057
> 
> 标签：phpbb, phpbb3

我在我的 phpbb 板上有这个问题，有时当两个用户在同一分钟发帖时，他们的帖子显示顺序错误。甚至在其他用户决定回复之前，第一个帖子已经可见，然后当用户发布时，该帖子会显示在上一个帖子之前。

一些用户还报告论坛“时钟”比实际时间晚两分钟。

我在网上的任何地方都找不到类似的问题。有谁知道可能是什么导致了这个问题？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T20:35:18.820

我把这个告诉了主机，虽然他们否认这是服务器时间问题，但在我报告后它被修复了。我的猜测是问题是由服务器集群中的同步问题引起的（并且主机不想承认它）。该问题在（有问题的）服务器更新后不久首次出现。

# android - iOS和Android跨平台游戏开发

> ID：14187629
> 
> 赞同：-1
> 
> 时间：2013-01-06T22:47:22.940
> 
> 标签：android, ios, cross-platform, cocos2d-x

我和我的朋友正在创办一家专注于移动设备应用程序开发的公司。他是 Android 人，所以他精通 Java，而我是 iOS 人，了解 Objective-C。我们正在开发我们的第一款游戏，我们想知道，保持跨设备体验一致的最佳方式是什么？我们考虑过使用 Cocos2D-x，但我们都没有太多的 C++ 经验。尝试 Cocos2D-x 是否值得，或者是否可以为两个平台编写原生应用程序并保持相同的用户体验？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T22:59:40.890

我认为你应该在一个平台上开发游戏，然后移植到另一个平台。同时在 2 个平台上编写同一个游戏听起来像是一场噩梦。iOS 和 Android 都有各自的问题。Cocos2d-x 听起来很有希望用于多平台开发，但这完全取决于您要玩的游戏类型。
如果你要为每个平台做原生，无论你们中的哪一个是更强大的程序员，我都会先在那个平台上工作。解决游戏问题，然后移植。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T05:53:57.537

这真的给了我开发移动应用程序的动力，因为我也想开发自己的移动应用程序。但正如我在上面的评论中看到的那样，很高兴知道我们应该专注于一个平台来首先开发并做好一个良好的开端。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-06T23:41:24.137

作为 iOS 和 Android 开发的跨平台开发解决方案，请考虑[Xamarin](http://xamarin.com/)。

它将减少将整个代码从一个平台移植到另一个平台的工作量，通过在 iOS 和 Android 之间共享非可视化逻辑，同时访问原生 GUI 小部件的外观和感觉。一个人可能会得到原生的外观，但它是另一个故事来获得感觉。

成功测试后，Xamarin 跨平台方法的主要区别在于逻辑可以在 iOS 和 Android 之间共享，而 GUI 可以使用本机 GUI 工具构建。

PS 我不是为 Xamarin 工作或与 Xamarin 有任何关系。

# c - 具有函数 c 的动态矩阵

> ID：14187632
> 
> 赞同：0
> 
> 时间：2013-01-06T22:48:25.607
> 
> 标签：c, function, dynamic, matrix, malloc

我必须使用 C 中的函数制作动态矩阵。我做了这个：

```
#include <stdio.h>
#include <malloc.h>
int r=3;
int c=3;
int i;
void matrix(int *** m)
{
    m=(int***)malloc(r*sizeof(int*));
    for(i=0; i<c;i++)
    {
       m[i]=(int**)malloc(c*sizeof(int));
    }
};
int main()
{
    int **mat;
    matrix(&mat);
    mat[0][0]=1;
    mat[0][1]=2;
    printf("%d %d", mat[0][0], mat[0][1]);
    system("pause");
} 
```

但它崩溃说有问题。在哪里？:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T22:53:08.553

当您传递`&mat`到时`matrix`，`***m`指示`m`持有 的位置`mat`。即`mat = *m`。考虑到这一点，您将不得不以下列方式更改 malloc。

```
void matrix(int *** m)
{
    //m=(int***)malloc(r*sizeof(int*));
    *m = (int **)malloc(r*sizeof(int*));
    for(i=0; i<c;i++)
    {
       //m[i]=(int**)malloc(c*sizeof(int));
       (*m)[i]=(int*)malloc(c*sizeof(int)); // it was *m[i]=..
    }
} 
```

**编辑**修复了一个错误

**编辑**正如 Johnathan 在评论中提到的，实现此功能的更好方法如下。

```
int **matrix(int rows, int cols)
{
    int i, j;
    int **mat = (int **)malloc(rows * sizeof(int *));
    for (i = 0; i < rows; i++) {
       mat[i] = (int *)malloc(cols * sizeof(int));
       // If you prefer to initialize values, uncomment the following line
       // for(j = 0; j < cols; j++) mat[i][j] = 0;
    }
    return mat;
} 
```

# facebook-graph-api - 获取 Facebook 页面 access_token appcelerator arg 缺失

> ID：14187635
> 
> 赞同：0
> 
> 时间：2013-01-06T22:48:52.067
> 
> 标签：facebook-graph-api, titanium-mobile, appcelerator-mobile

我有这个试图从 facebook 获取页面访问令牌。

我正在用 appcelerator 钛做这个。

```
 Ti.Facebook.requestWithGraphPath(Titanium.App.Properties.getString("sidnamn"), {fields: 'access_token'}, function(resp) {
    if(resp.access_token) {
        Ti.API.info(resp.access_token);

        }   }); 
```

当我运行这个我得到这个错误：

message = "函数的参数数量无效。预期 4 个参数，收到：3 in -[FacebookModule requestWithGraphPath:] (FacebookModule.m:440)";

那么我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T00:16:37.680

```
argument one = target
argument two = data
argument three = method (POST/GET)
argument four = callback 
```

我的回答没有解决您的目标或数据的质量，但您的第三个参数不是 POST/GET

# django - Google App Engine 因缺少环境变量 DJANGO_SETTINGS_MODULE 而中止

> ID：14187640
> 
> 赞同：1
> 
> 时间：2013-01-06T22:49:11.720
> 
> 标签：django, google-app-engine

[这是Google App Engine 和 Django 支持](https://stackoverflow.com/questions/14137404/google-app-engine-and-django-support)的后续问题：

本教程适用于空项目，但是当我尝试将现有 Django 应用程序部署到 Google App Engine 时，它​​开始抛出错误：

```
Traceback (most recent call last):
  File "/python27_runtime/python27_lib/versions/1/google/appengine/runtime/wsgi.py", line 223, in Handle
    result = handler(dict(self._environ), self._StartResponse)
  File "/python27_runtime/python27_lib/versions/third_party/django-1.4/django/core/handlers/wsgi.py", line 219, in __call__
    self.load_middleware()
  File "/python27_runtime/python27_lib/versions/third_party/django-1.4/django/core/handlers/base.py", line 39, in load_middleware
    for middleware_path in settings.MIDDLEWARE_CLASSES:
  File "/python27_runtime/python27_lib/versions/third_party/django-1.4/django/utils/functional.py", line 184, in inner
    self._setup()
  File "/python27_runtime/python27_lib/versions/third_party/django-1.4/django/conf/__init__.py", line 40, in _setup
    raise ImportError("Settings cannot be imported, because environment variable %s is undefined." % ENVIRONMENT_VARIABLE)
ImportError: Settings cannot be imported, because environment variable DJANGO_SETTINGS_MODULE is undefined. 
```

第二个，这可能是相关的：

```
Traceback (most recent call last):
  File "/python27_runtime/python27_lib/versions/1/google/appengine/runtime/wsgi.py", line 223, in Handle
    result = handler(dict(self._environ), self._StartResponse)
  File "/python27_runtime/python27_lib/versions/third_party/django-1.4/django/core/handlers/wsgi.py", line 219, in __call__
    self.load_middleware()
  File "/python27_runtime/python27_lib/versions/third_party/django-1.4/django/core/handlers/base.py", line 39, in load_middleware
    for middleware_path in settings.MIDDLEWARE_CLASSES:
  File "/python27_runtime/python27_lib/versions/third_party/django-1.4/django/utils/functional.py", line 184, in inner
    self._setup()
  File "/python27_runtime/python27_lib/versions/third_party/django-1.4/django/conf/__init__.py", line 42, in _setup
    self._wrapped = Settings(settings_module)
  File "/python27_runtime/python27_lib/versions/third_party/django-1.4/django/conf/__init__.py", line 95, in __init__
    raise ImportError("Could not import settings '%s' (Is it on sys.path?): %s" % (self.SETTINGS_MODULE, e))
ImportError: Could not import settings 'settings' (Is it on sys.path?): No module named settings 
```

我已经按照教程修改了我的 settings.py。该应用程序部署没有问题，并且同步数据库也可以正常工作；数据库和所有必需的表都已到位。

我发现了对错误消息的[引用](https://groups.google.com/forum/?fromgroups=#!topic/google-appengine/lJorqc0p3MA)，如日志中所示，但其建议的修复没有帮助。

有什么想法可能导致这种情况吗？

**编辑：**

为了缩短这个已经很长的问题，我删除了之前发布的`wsgi.py`文件。我与这个问题无关。

**编辑2：**

我想我做了一个小的改进，GAE 现在抱怨：

```
ImportError: No module named properties 
```

我认为我的 app.yaml 文件中可能缺少一个条目，但我不知道可能是哪个文件。我发现了一些关于缺少模块的参考资料，但没有一个反映这个错误消息......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T14:22:26.497

经过多次试验和错误，我设法解决了这个问题，尽管部分是：

我没有设法`PyCharm`部署我现有的项目（还）。由于我渴望在 GAE 上运行一个版本，因此我采用了不同的方法，并`project 2`在我的本地计算机上创建了一个新的空 Django 项目 ()。

我首先使用运行良好的[本教程](http://howto.pui.ch/post/39245389801/tutorial-django-on-appengine-using-google-cloud-sql)部署了空白项目。`models.py`然后，我将我现有的 PyCharm 项目中的文件复制到`project 2`并添加了一个`properties`使用该`models.py`文件的应用程序。最初这是错误的，因为 GAE 一直抱怨它找不到我的`properties`应用程序。在摆弄它之后，它突然出现在我的管理员中。我不确定是什么导致了最初的问题，但它现在正在工作。

对我来说成功的关键：

我在 settings.py 的最顶部添加了以下内容：

```
import os
ROOT_PATH = os.path.dirname(__file__) 
```

...然后将默认值替换为`STATIC_ROOT`：

```
STATIC_ROOT = ROOT_PATH + os.sep + 'static' 
```

然后我跑了：

```
python manage.py collectstatic 
```

从`project 2`. 这会收集 Django 管理员使用的所需静态文件（图像文件、css 文件等）

所以，我目前有一个在 GAE 上运行的原始项目的精简版本。缺少的东西：

*   `grappelli`用于更具风格的管理界面的原始项目。我不确定这是否会在 GAE 上运行。**编辑：在 GAE 上部署 Grappelli 相当容易。只需将 Grappelli 包复制到您的项目目录并运行`manage.py collectstatic`. 还根据文档添加 grappelli url。重新部署。完毕。**

*   原始项目使用一个名为`templated_email`从我的应用程序发送模板电子邮件的模块`properties`。同`grappelli`：我不确定 GAE 是否支持。希望它能在 GAE 上运行，因为它对我的特定应用程序至关重要。**编辑：我碰到了[这个](http://venodesigns.net/2010/07/13/rendering-emails-from-django-templates/)使 templated_email 过时的小宝石，让我可以插入 GAE 邮件系统。**

老实说，这种方法部分违背了 PyCharm 的优势，后者应该完全支持开箱即用的 Django 和 GAE。它可能需要一些额外的研究和调整才能启动和运行。

显然，对上述任何评论或见解表示赞赏！

# git - 基于两个未合并的分支在分支上工作

> ID：14187643
> 
> 赞同：3
> 
> 时间：2013-01-06T22:49:35.277
> 
> 标签：git

我有两个功能分支，我还不能合并到 master 中。现在我需要处理第三个特性，它依赖于之前的两个特性。我如何处理该功能而不需要将分支合并到 master 上并保持它们拆分，以便可以单独对它们进行代码审查？

一个更直接的问题：如果我将 feature1 合并到 feature2 中，我仍然可以对 feature1 和随后的 feature2 发出拉取请求吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T22:55:55.437

在您的第一个问题上，您可以为功能 3 创建一个新分支，然后将两个分支合并到其中。

关于第二个问题，是的，您可以将功能 1 合并到功能 2 中，然后当您准备好时，将功能 1 合并到主功能中，然后在该功能 2 之后。

您需要确保使分支保持最新。

*   确保功能 1 和功能 2 都具有最新的主合并。
*   确保功能 3 收到功能 1 和功能 2 的合并，如果他们得到进一步的提交

您可以管理它并使事情更整洁的另一种方法是创建一个临时分支并将功能 1 和功能 2 合并到其中，然后从临时分支创建功能 3 并在工作完成时将其合并回来。然后，当您准备好将整个 staging 分支合并到 master 中时。这取决于您延迟将功能 1 和功能 2 合并到 master 的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T22:53:10.233

您可以从 FeatureA 拆分一个分支，然后将 FeatureB 合并到其中。这样，您就有了一个具有这两个功能的分支。

几点注意事项：

*   它可能会使您的工作树比应有的更加混乱。
*   如果进一步提交 FeatureA 或 FeatureB，您将不会在新的 FeatureC 分支中获得它们。

# java - 在 Java 中获取客户端的每个 IP 地址的问题

> ID：14187645
> 
> 赞同：1
> 
> 时间：2013-01-06T22:50:08.263
> 
> 标签：java

我在获取 Java 中的每个 IP 地址时遇到问题。当我打开 GUI 选择您要使用的 IP 时，我调用：

```
private List<String> getIP() {
    List<String> outputList = new ArrayList<String>();
    try {
        InetAddress localIP = InetAddress.getLocalHost();
        InetAddress[] everyIPAddress = InetAddress.getAllByName(localIP
                .getCanonicalHostName());
        if (everyIPAddress != null && everyIPAddress.length > 1) {
            for (int i = 0; i < everyIPAddress.length; i++) {
                if (!everyIPAddress[i].toString().contains(":")) {
                    outputList.add(everyIPAddress[i].toString());
                }
            }
        }
    } catch (UnknownHostException e) {
        System.out.println("Error finding IP Address");
    }
    return outputList;
} 
```

此方法获取客户端拥有的所有 IPv4 地址。我知道 IPv6 地址包含冒号，所以我不会在列表中添加任何带有冒号的地址。

然后，按下按钮更改 IP 地址。但是，我注意到，当机器只有一个 IPv4 地址时（您从拥有 Hamachi 之类的服务中获得两个地址），它将返回一个空异常。如果只有一个地址，我将如何获取客户端的每个 IP 地址而不返回空异常？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-06T23:06:03.843

```
if (everyIPAddress != null && everyIPAddress.length > 1) { 
```

应该

```
if (everyIPAddress != null && everyIPAddress.length >= 1) { 
```

或者

```
if (everyIPAddress != null && everyIPAddress.length > 0) { 
```

# gcc - 使 Xcode 在链接目标文件时运行 g++

> ID：14187646
> 
> 赞同：0
> 
> 时间：2013-01-06T22:50:12.077
> 
> 标签：gcc, cuda, g++, xcode4.5

我正在尝试在 XCode 4.5.2 中构建一个小样本 CUDA 代码 matrixMul.cu。我做了：

1.  运行 nvcc 以将 .cu 文件编译为目标文件的自定义脚本。
2.  然后让 xcode 将其与 cuda lib 链接以生成最终的可执行 matrixMul

但是，在链接阶段，xcode 总是在 .o 文件而不是 g++ 上运行 gcc，因此会导致错误：

```
/Applications/Xcode.app/Contents/Developer/usr/bin/gcc -arch x86_64 -isysroot ...
Undefined symbols for architecture x86_64:
"std::ios_base::Init::Init()", referenced from:
  __static_initialization_and_destruction_0(int, int)in matrixMul.o
"std::ios_base::Init::~Init()", referenced from:
  ___tcf_0 in matrixMul.o
ld: symbol(s) not found for architecture x86_64
collect2: ld returned 1 exit status 
```

我不知道如何让 XCode 运行 g++ 而不是 gcc 来链接目标文件。我在项目中只有 .cu 文件，所以没有 .cpp 表明它是 c++。但是，当我一开始创建 xcode 项目时，我确实选择了 C++。无论我在构建设置中选择 Apple LLVM 编译器还是 LLVM GCC，它都会为我运行 gcc。

谢谢！加里

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T20:10:13.973

事实证明，我不能强制 XCode 使用 g++ 进行链接，但有一个解决方法，我将 -lstdc++ 添加到“其他链接器标志”部分，使 gcc 为我链接 c++ 库。

它现在有效，但我不太确定这是否是唯一/最好的解决方案。如果有人有其他解决方案，请告诉我。

加里

# c++ - 在嵌套匿名结构上忽略 C++ 私有修饰符

> ID：14187647
> 
> 赞同：12
> 
> 时间：2013-01-06T22:50:16.683
> 
> 标签：c++, nested, private, access-modifiers, anonymous-struct

以下示例代码在 Visual C++ 中编译得很好：

```
class Test {
private:
    struct {
        struct {
            int privateData;
        };
    };
};

int main(int, char **)
{
    Test test;
    test.privateData = 0;
    return 0;
} 
```

但为什么？我预计会出现编译器错误，因为`privateData`函数 main 应该无法访问该成员，因为它应该`private`像它的容器的容器一样。我知道无名结构不是官方 C++ 的一部分，但这种设计是愚蠢的。

顺便说一句，我还尝试更改`private`into`protected`和`struct`into `union`：看起来编译器拒绝尊重嵌套在另一个匿名结构或联合中的匿名结构和联合的访问修饰符。

有人可以解释这个功能吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-10T00:43:44.160

是的，这是一个错误。微软承认，反馈报告[在这里](https://connect.microsoft.com/VisualStudio/feedback/details/520784/access-to-private-fields-inside-anonymous-unions-and-structs-is-strangely-relaxed)。

目前，该错误处于“无法修复”状态，尚不清楚何时（如果有的话）它会得到解决。有一个有点奇怪的解决方法，由 Edison Design Group 编写的 Visual Studio 中内置的 IntelliSense 解析器确实抱怨它。您会看到红色曲线和消息：

> 错误：成员“Test.privateData”（在第 10 行声明）不可访问

# emacs - 让操作系统接管特定的键绑定？

> ID：14187649
> 
> 赞同：3
> 
> 时间：2013-01-06T22:50:28.383
> 
> 标签：emacs, elisp

我正在使用 OS X Lion 并具有允许我在 VirtualBox 和语言输入中切换屏幕等的键绑定。我想知道我是否可以在我的`.emacs`文件中包含一些内容，这将允许操作系统接管某些绑定，例如 ,`C-<right>`等`C-K`，而不是 Emacs 给我一个错误，这些组合是未定义的？

# php - 当我在过滤器中使用 forward 时，整个布局被渲染了两次

> ID：14187652
> 
> 赞同：2
> 
> 时间：2013-01-06T22:50:53.420
> 
> 标签：php, symfony-1.4

奇怪，但它是真的。我的过滤器.yml：

```
# You can find more information about this file on the symfony website:
# http://www.symfony-project.org/reference/1_4/en/12-Filters

rendering: ~
security:  ~

# insert your own filters here

myFilter:
  class: myFilter

cache:     ~
execution: ~ 
```

这个过滤器：

```
<?php
class MyFilter extends sfFilter
{
    /**
     * @return
     */
    public function execute ($filterChain)
    {
        if ($this->isFirstCall())
        {
            if NOT LOGGED IN
            {
                $this->getContext()->getUser()->setFlash ('error', 'login again!');
                $this->getContext()->getController()->forward('glbl', 'empty');
            }
        }

        $filterChain->execute();
    }
}
?> 
```

> 我想要的帽子？while 站点始终需要登录用户 - 或者您只能看到登录页面。当您没有登录或同时退出时，URL 必须保留，并获得登录页面，您应该会看到一个“空”模块（登录部分显示在其他地方）。

但它会渲染整个布局两次。甚至`<html>`标签也是重复的。怎么了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T10:04:24.057

尝试添加

```
throw new sfStopException(); 
```

前锋之后：

```
<?php
class MyFilter extends sfFilter
{
    /**
     * @return
     */
    public function execute ($filterChain)
    {
        if ($this->isFirstCall())
        {
            if NOT LOGGED IN
            {
                $this->getContext()->getUser()->setFlash ('error', 'login again!');
                $this->getContext()->getController()->forward('glbl', 'empty');
                throw new sfStopException();
            }
        }

        $filterChain->execute();
    }
}
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T01:34:33.367

尝试更改`->forward(`为`->redirect(`

# java - Java LWJGL Slick TTF 模糊

> ID：14187653
> 
> 赞同：0
> 
> 时间：2013-01-06T22:50:56.337
> 
> 标签：java, lwjgl, blur, truetype, slick2d

我在同时渲染纹理和真实字体时遇到了一些麻烦。

以下屏幕截图描述了我的问题：

这完美地显示了字体渲染。这是在我使用纹理之前。 [http://i.imgur.com/sUnoz.png](http://i.imgur.com/sUnoz.png)

这显示了更改为纹理后的字体。一切都变得模糊。

[http://i.imgur.com/gyhrZ.png](http://i.imgur.com/gyhrZ.png)

我不知道如何解决这个问题。我试过启用和禁用各种东西，但我无法弄清楚。

这是我的代码：

总帐初始化：

```
 glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    glOrtho(0, Display.getWidth(), Display.getHeight(), 0, 1, -1);
    glMatrixMode(GL_MODELVIEW);
    glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);
    glDisable(GL_DEPTH_TEST);
    glClearColor(0, 0, 0, 0);
    glEnable(GL_TEXTURE_2D); 
```

精灵渲染：

```
 glEnable(GL_BLEND);
        glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);

        glPushMatrix();
        glBindTexture(GL_TEXTURE_2D, this.textureID);
        glBegin(GL_QUADS);
        {
            glTexCoord2f(0, 0);
            glVertex2f(0, 0);

            glTexCoord2f(1, 0);
            glVertex2f(this.width, 0);

            glTexCoord2f(1, 1);
            glVertex2f(this.width, this.height);

            glTexCoord2f(0, 1);
            glVertex2f(0, this.height);
        }
        glEnd();
        glPopMatrix(); 
```

纹理加载器：

```
 public static int loadTexture(BufferedImage image) {

    int[] pixels = new int[image.getWidth() * image.getHeight()];
    image.getRGB(0, 0, image.getWidth(), image.getHeight(), pixels, 0,
            image.getWidth());

    ByteBuffer buffer = BufferUtils.createByteBuffer(image.getWidth()
            * image.getHeight() * BYTES_PER_PIXEL); // 4 for RGBA, 3 for RGB

    for (int y = 0; y < image.getHeight(); y++) {
        for (int x = 0; x < image.getWidth(); x++) {
            int pixel = pixels[y * image.getWidth() + x];
            buffer.put((byte) ((pixel >> 16) & 0xFF)); // Red component
            buffer.put((byte) ((pixel >> 8) & 0xFF)); // Green component
            buffer.put((byte) (pixel & 0xFF)); // Blue component
            buffer.put((byte) ((pixel >> 24) & 0xFF)); // Alpha component.
                                                        // Only for RGBA
        }
    }

    buffer.flip(); // FOR THE LOVE OF GOD DO NOT FORGET THIS

    // You now have a ByteBuffer filled with the color data of each pixel.
    // Now just create a texture ID and bind it. Then you can load it using
    // whatever OpenGL method you want, for example:

    int textureID = glGenTextures(); // Generate texture ID
    glBindTexture(GL_TEXTURE_2D, textureID); // Bind texture ID

    // Setup wrap mode
    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL12.GL_CLAMP_TO_EDGE);
    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL12.GL_CLAMP_TO_EDGE);

    // Setup texture scaling filtering
    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);
    glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);

    // Send texel data to OpenGL
    glTexImage2D(GL_TEXTURE_2D, 0, GL_RGBA8, image.getWidth(),
            image.getHeight(), 0, GL_RGBA, GL_UNSIGNED_BYTE, buffer);

    // Return the texture ID so we can bind it later again
    return textureID;
} 
```

如有必要，我愿意提供更多信息。任何帮助表示赞赏，在此先感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-14T05:54:55.177

我知道这个问题是 6 个月前在给出这个答案时提出的，但我只是想让其他人知道，以防他们遇到同样的问题。

我在尝试渲染图像时也遇到了同样的问题，我的解决方法是在完成渲染后取消绑定纹理。

```
glEnable(GL_BLEND);
glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);

glPushMatrix();
glBindTexture(GL_TEXTURE_2D, this.textureID);
glBegin(GL_QUADS);
{
    glTexCoord2f(0, 0);
    glVertex2f(0, 0);

    glTexCoord2f(1, 0);
    glVertex2f(this.width, 0);

    glTexCoord2f(1, 1);
    glVertex2f(this.width, this.height);

    glTexCoord2f(0, 1);
    glVertex2f(0, this.height);
}
glEnd();
glPopMatrix();
glBindTexture(GL_TEXTURE_2D, 0); 
```

# javascript - 文档和图像点击优先级

> ID：14187654
> 
> 赞同：-1
> 
> 时间：2013-01-06T22:51:16.230
> 
> 标签：javascript, events, dom

我有一个文件。我无法改变它。
它有一个图像。
图像具有 onclick 事件 (imageCallback)。

我还有一个书签。我想做`document.onclick = documentCallback;`
并且我想`documentCallback`优先考虑：它应该首先运行。并且`imageCallback`在我关闭书签之前根本不应该运行。

我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T23:00:27.907

删除你的 imageCallback 函数，并在你的 document.onclick 中查找事件源：

html:

```
<img id="id-of-your-img" src="..."> 
```

javascript:

```
document.onclick = function (event) {

  // do what needs to be done first

  //do whatever you want to do when the img was clicked
  if(event.srcElement.id === 'id-of-your-img') {

  }
}; 
```

编辑（我想我现在知道你想要实现什么（提示“书签”很重要）：

```
var yourimg = document.getElementById('your-img-id')
  , imgCallback = yourimg.onclick;
yourimg.onclick = function () {};

document.onclick = function (event) {

  // do what needs to be done first

  if(event.srcElement === yourimg) {
    imgCallback();
  }
}; 
```

这里做了什么？我们获取图像，覆盖当前的点击处理程序（但将其保存到我们的 imgCallback-Var 中。当点击文档时，我们做任何我们想做的事情，然后看看事件源是否是我们的图像。如果是，我们执行我们的imgCallback-Function。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T23:18:06.517

通过 addEventListener 添加事件处理程序并将 useCapture 参数设置为 true：

```
document.addEventListener('click', documentCallback, true) 
```

事件可以分两个阶段进行调度，冒泡阶段和捕获阶段，捕获阶段是第一位的，你应该[看看这个](http://www.quirksmode.org/js/events_order.html)

# version-control - Azure 移动服务中服务器端脚本的源代码控制

> ID：14187659
> 
> 赞同：2
> 
> 时间：2013-01-06T22:52:08.237
> 
> 标签：version-control, server-side-scripting, azure-mobile-services

我使用 Azure 移动服务作为我的移动应用程序的后端。尽管我尽了最大努力，但我的服务器端脚本现在变得越来越复杂。有没有一种方法可以让我的服务中的表的插入、更新、读取、删除脚本保存在源代码控制中，并且可能有办法从 Visual Studio 中部署它们？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-07T03:40:55.487

您是否检查过节点[Azure 命令行工具](http://www.windowsazure.com/en-us/develop/nodejs/how-to-guides/command-line-tools/)？这可能会解决您的问题。这些工具允许您从您的开发机器巧妙地管理您的移动服务。新添加的移动服务 cli 工具还支持下载您的脚本。只需在 Azure Powershell 中运行以下命令：

```
azure mobile script download <service_name> <script_name> 
```

脚本名称语法如下：

1.  对于表：table/.{insert|read|update|delete}
2.  苹果推送通知：shared/apnsFeedback
3.  调度器：调度器/

将脚本下载并放置到本地文件系统后，您可以将它们置于使用移动服务的客户端的源代码控制中，或者将它们放入自己的 git 存储库中。但是，您不能将源代码控制存储库与您的移动服务同步。为了上传您对脚本所做的任何更改，您需要再次在 Azure-CLI 中执行以下命令：

```
azure mobile script upload <service_name> <script_name> 
```

我不确定您是否可以一次上传多个脚本。您可能可以使用我[在 github 上看到 Glenn Block 发布的](https://gist.github.com/4415326)一些 Azure-CLI 自动化脚本。这可以让您以某种方式自动上传脚本作为构建工作流程的一部分。

编辑：

我发现了更多资源可以帮助您解决这个问题：

*   [开始使用 CLI 并备份您的脚本](http://www.thejoyofcode.com/Getting_started_with_the_CLI_and_backing_up_your_scripts_Day_4_.aspx)
*   [更多 CLI – 改变您的移动服务工作流程](http://www.thejoyofcode.com/More_CLI_ndash_changing_your_Mobile_Services_workflow_Day_5_.aspx)

这些是 Josh Twist 提供的一些很棒的资源。我相信他们会把你推向正确的方向。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-04T22:54:26.730

自从回答了这个问题后，Azure 移动服务中添加了一项新功能 - 与 Git 源代码控制集成。基本上，您可以在移动服务的仪表板中启用此功能，并将其转换为 Git 存储库中的存储，您可以克隆/拉取和推送更新到该存储库。

[您可以在http://www.windowsazure.com/en-us/develop/mobile/tutorials/store-scripts-in-source-control/](http://www.windowsazure.com/en-us/develop/mobile/tutorials/store-scripts-in-source-control/)上的教程中找到更多信息。

# hangout - 将 Google Hangout 发布为公开

> ID：14187663
> 
> 赞同：5
> 
> 时间：2013-01-06T22:52:32.897
> 
> 标签：hangout

我一直在尝试让 Google Hangout 今天公开发布，但一定遗漏了一些东西……我花了几个小时阅读帖子并重新阅读 Google + Hangout API 上的页面。

1.  我去了 Chrome 网上应用店并支付了 5 美元。
2.  我构建了 API，还获得了 oauth2 ID。XML 代码在网上已经到位，就像它应该的那样。我填写了您的服务条款、隐私政策和支持联系信息的 URL。并选中该框以将其公开。

如果有人可以帮助我弄清楚是什么让我陷入困境，我将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-26T02:30:09.523

您是否尝试启动环聊应用程序？尝试使用[测试链接](https://developers.google.com/+/hangouts/button#test)进行测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-29T13:29:24.260

目前（10/2014），Google+ 仅通过其 API 提供只读访问权限。我读到选择的 Google 合作伙伴对 API 有更多访问权限，但标准访问权限级别不允许写入访问权限。

希望这可以帮助。

以下是支持我上述主张的参考资料。

Google+ 平台 [https://code.google.com/p/google-plus-platform/issues/detail?id=41#c181](https://code.google.com/p/google-plus-platform/issues/detail?id=41#c181)

Google+ 会获得完整的读/写 API 吗？ [http://techcrunch.com/2012/12/30/will-google-ever-get-a-full-readwrite-api/](http://techcrunch.com/2012/12/30/will-google-ever-get-a-full-readwrite-api/)

通过 API [创建 Google Plus 事件 通过 API 创建 Google Plus 事件](https://stackoverflow.com/questions/13772944/create-google-plus-events-via-api)

如何 [在 Google+ 墙上发帖 如何在 Google+ 墙上发帖](https://stackoverflow.com/questions/7570327/how-to-post-in-google-plus-wall)

# excel - Excel 复杂排序 - 返回低/高值

> ID：14187664
> 
> 赞同：1
> 
> 时间：2013-01-06T22:52:34.837
> 
> 标签：excel, vba, sorting

我正在尝试对从 csv 文件导入的数据进行排序。数据如下：

```
Columns
 A | B
--------
t1 | 1
t3 | 9
t1 | 2
t2 | 5
t1 | 1
t3 | 13
t1 | 3
t3 | 11
t2 | 4
t2 | 7
t3 | 10
t3 | 10 
```

我想要类似这样的输出：

```
 Columns
 D  |  E  |  F
----------------
t1  |  1  |  3
t2  |  4  |  7
t3  |  9  |  13 
```

说明：基本上我需要做的是从 B 列中为 A 列中的每个不同值找到最低和最高值，并将它们整齐地列出，如第二个示例所示。

我以前使用过 VBA，所以如果这必须通过 VBA 来完成，那很好。我只是不知道如何完成这项任务。任何帮助，将不胜感激。

编辑：忘了提一下，如果可以使任务更简单，如果我必须根据 col A 手动按字母顺序对数据进行排序（从而将相同的值放在一起）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T23:12:54.797

我同意@chrisneilsen 的观点，即数据透视表是最好的选择。如果您打算使用公式，则可以尝试使用以下内容（均以数组形式输入 - `Ctrl+Shift+Enter`）：

在 cell`E1`中，这将代表最小值：

```
=MIN(IF($A$1:$A$12=D1,1,MAX($B$1:$B$12)+1)*$B$1:$B$12) 
```

在 cell`F1`中，它将代表最大值：

```
=MAX(IF($A$1:$A$12=D1,1,MIN($B$1:$B$12)-1)*$B$1:$B$12) 
```

一般的想法是检查列`A`中的哪些值等于您的目标值（列`D`）。结果将`1`是一个匹配的数组，并`MIN`以列的最大值 + 1 为例。这样做是因为我们希望将其设置为一个不可能达到的值您当前的设置，因此最大值 + 1 将确保`MIN`返回一个合法的值。

![在此处输入图像描述](../Images/22ca78bfea1eed8cd10a284a0008e76a.png)

这是一个使用 Excel 2007 的数据透视表。要创建数据，请将列标题添加到您的数据中，选择您的数据，然后在功能区中单击`Insert -> Pivot Table`。在对话框中，您决定要放置它的位置（它通常放置在新工作表中，因此您可以根据需要保留默认值 - 我将其保留在同一个工作表中以进行说明）。从那里，您可以通过拖动每个字段来排列它，使其与图片匹配。对于`Max/Min`字段，只需将`Value`字段拖入该`Values`部分两次。然后，在实际的数据透视表中，您可以右键单击列中的一个值，然后选择`Summarize Data By -> Min`按每个键的最小值进行汇总：

![在此处输入图像描述](../Images/d5b66e0748ed20fcb94e95ce1c544e30.png)

# java - GL_QUADS 渲染我不希望的样子

> ID：14187665
> 
> 赞同：0
> 
> 时间：2013-01-06T22:52:39.440
> 
> 标签：java, eclipse, opengl, lwjgl

我正在使用 LWJGL/Open GL 来绘制一个立方体。问题是它没有按正确的顺序绘制面，也没有在正确的位置渲染立方体！这是 Block.java：

```
 package src;

import static org.lwjgl.opengl.GL11.GL_QUADS;
import static org.lwjgl.opengl.GL11.glBegin;
import static org.lwjgl.opengl.GL11.glColor3f;
import static org.lwjgl.opengl.GL11.glTranslatef;
import static org.lwjgl.opengl.GL11.glVertex3f;

import static org.lwjgl.opengl.GL11.*;

public class Block {
    private float x;
    private float y;
    private float z;
    private Chunk chunk;

public Block(float arg1, float arg2, float arg3, Chunk arg4) {
    x = arg1;
    y = arg2;
    z = arg3;
    chunk = arg4;
}

public void renderBlock() {

    // glTranslatef(0, 0, 0);
    // Texture tx =
    chunk.getWorld().getGame().getTexture(0).bind();
    glBegin(GL_QUADS);
    {
        // Top Face
        glTexCoord2f(0, 0);
        glVertex3f(x - 1, y + 1, z - 1);
        glTexCoord2f(0, 1);
        glVertex3f(x, y + 1, z - 1);
        glTexCoord2f(1, 1);
        glVertex3f(x, y + 1, z);
        glTexCoord2f(1, 0);
        glVertex3f(x - 1, y + 1, z);

        // Bottom Face
        glTexCoord2f(0, 0);
        glVertex3f(x - 1, y, z - 1);
        glTexCoord2f(0, 1);
        glVertex3f(x, y, z - 1);
        glTexCoord2f(1, 1);
        glVertex3f(x, y, z);
        glTexCoord2f(1, 0);
        glVertex3f(x - 1, y, z);

        // Front Face
        glTexCoord2f(0, 0);
        glVertex3f(x, y + 1, z - 1);
        glTexCoord2f(0, 1);
        glVertex3f(x, y, z - 1);
        glTexCoord2f(1, 1);
        glVertex3f(x, y, z);
        glTexCoord2f(1, 0);
        glVertex3f(x, y + 1, z);

        // Back Face
        glTexCoord2f(0, 0);
        glVertex3f(x - 1, y + 1, z - 1);
        glTexCoord2f(0, 1);
        glVertex3f(x - 1, y, z - 1);
        glTexCoord2f(1, 1);
        glVertex3f(x - 1, y, z);
        glTexCoord2f(1, 0);
        glVertex3f(x - 1, y + 1, z);

        // BackFace
        glTexCoord2f(0, 0);
        glVertex3f(x - 1, y + 1, z - 1);
        glTexCoord2f(0, 1);
        glVertex3f(x, y + 1, z - 1);
        glTexCoord2f(1, 1);
        glVertex3f(x, y, z - 1);
        glTexCoord2f(1, 0);
        glVertex3f(x - 1, y, z - 1);

        // FrontFace
        glTexCoord2f(0, 0);
        glVertex3f(x - 1, y + 1, z);
        glTexCoord2f(1, 0);
        glVertex3f(x, y + 1, z);
        glTexCoord2f(1, 1);
        glVertex3f(x, y, z);
        glTexCoord2f(0, 1);
        glVertex3f(x - 1, y, z);

    }
    glEnd();

}

public float getX() {
    return x;
}

public float getY() {
    return y;
}

public float getZ() {
    return z;
}
} 
```

这是 Render.java：

```
 package src;

import static org.lwjgl.opengl.GL11.GL_COLOR_BUFFER_BIT;
import static org.lwjgl.opengl.GL11.GL_DEPTH_TEST;
import static org.lwjgl.opengl.GL11.glClear;
import static org.lwjgl.opengl.GL11.glEnable;
import static org.lwjgl.opengl.GL11.glEnd;
import static org.lwjgl.opengl.GL11.glLoadIdentity;
import static org.lwjgl.opengl.GL11.glPopMatrix;
import static org.lwjgl.opengl.GL11.glPushMatrix;

import java.util.logging.Level;
import java.util.logging.Logger;

import org.lwjgl.LWJGLException;
import org.lwjgl.input.Mouse;
import org.lwjgl.opengl.Display;
import org.lwjgl.opengl.DisplayMode;

public class Render {

Game game;

public Render(Game arggame) {
    game = arggame;
}

public void initDisplay() {
    try {
        Display.setDisplayMode(new DisplayMode(1280, 720));
        Display.create();
    } catch (LWJGLException ex) {
        Logger.getLogger(Main.class.getName()).log(Level.SEVERE, null, ex);
    }
}

public void renderLoop() {
    glClear(GL_COLOR_BUFFER_BIT);
    glLoadIdentity();

    game.cam.useView();

    glPushMatrix();
    {

        renderBlocks(game.world);

        glEnd();
    }
    glPopMatrix();
    Display.update();

}

public void renderBlocks(World arg1world) {
    for (int i = 0; i < 125; i++) {
        if (arg1world.chunkIndex[i] != null) {
            for (int j = 0; j < 32768; j++) {
                if (arg1world.chunkIndex[i].blockIndex[j] != null) {
                    arg1world.chunkIndex[i].blockIndex[j].renderBlock();
                }
            }
        }
    }
}
} 
```

块似乎比应该的要低 2 个块，我认为可以通过编辑 glVertex3f 来修复它，但是为什么它不能正确渲染，因为它使用了位置变量。glTranslate 只会让一切变得更糟（做一些指数变化）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T07:35:53.130

您似乎没有使用深度缓冲区。我不知道 LWJGL 的详细信息，但我希望看到一些在 initDisplay() 中创建深度缓冲区的选项，在某个地方启用 GL_DEPTH_TEST 并将 GL_DEPTH_BUFFER_BIT 添加到 glClear() 中。那应该可以解决您的面部订购问题。

其他一些问题：你有一个双 glEnd()（renderLoop() 中的那个）没有对应的 glBegin()，它不应该受到伤害，但如果你开始检查它们会导致 glErrors（你应该这样做）。

你的 glTranslatef() 不应该做任何事情，因为它是 (0,0,0)。但是如果你真的想用真实值使用它，你需要在每个被翻译的对象周围（即在 renderBlock() 的开头/结尾）执行 glPushMatrix()/glPopMatrix()，否则它们会累积。

您选择的顶点坐标有点奇怪。通常人们将原点放置在对象的中心（即对 XYZ 使用 +/-1 坐标）或在左下角（即对 XYZ 使用 0/1 坐标）。这应该不是问题，但可能会导致一些意想不到的转变。

# c# - 用户控制选项卡

> ID：14187666
> 
> 赞同：2
> 
> 时间：2013-01-06T22:52:48.837
> 
> 标签：c#, dynamic-usercontrols

我为选项卡制作了一个简单的用户控件，但是当我调用它时，它显示得非常小，并且可以将其调整为任何大小，这里是代码。我错了什么？

```
public class tabController : UserControl
{
    public tabController(string id)
    {
        InitializeComponent(id);
    }
    public void InitializeComponent(string id)
    {
        TabControl tabControl;
        TabPage tab1, tab2, tab3, tab4, tab5, tab6, tab7, tab8, tab9, tab10;
        tabControl = new TabControl();
        tabControl.Location = new Point(500, 250);
        tabControl.Size = new Size(500, 500);
        tabControl.ClientSize = new Size(500, 500);
        var xmlData = Binder.fSelect.GetData(3, 1, 1, 0, "", "", 0, 25);

    StringReader sr = new StringReader(xmlData);
    //dsData.ReadXml(xmlData);
    //string xmlString = sw.ToString();
    DataSet ds = new DataSet();
    ds.ReadXml(sr);

    int i = 0;
    for (i = 0; i <= ds.Tables[0].Rows.Count - 1; i++)
    {
        //string v = ds.Tables[0].Rows[i].ItemArray[2].ToString();
        if ((ds.Tables[0].Rows[i].ItemArray[4].ToString()) == "114")
        {
            if (i == 0)
            {
                tab1 = new TabPage(ds.Tables[0].Rows[i].ItemArray[1].ToString());
                tabControl.TabPages.Add(tab1);
            }
        }
    } 
    tabControl.Dock = DockStyle.Fill;
    this.Controls.Add(tabControl); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-19T08:57:01.183

嗨

尝试使用用户控件的 Dockstyle 属性来`Dockstyle.Fill`调用它。

# java - 直接从字节数组播放声音 - Java

> ID：14187667
> 
> 赞同：1
> 
> 时间：2013-01-06T22:52:49.237
> 
> 标签：java, audio, io, bytearray, wav

我正在尝试使用以下方法播放存储为字节数组的声音：

```
byte[] clickSamples = getAudioFileData("sound.wav");
ByteBuffer buffer = ByteBuffer.allocate(bufferSize*2);
int tick = 0;

for (int i = 0; i < clickSamples.length; i++) {
    buffer.putShort((short) clickSamples[i]);
    tick++;
    if (tick >= bufferSize/SAMPLE_SIZE) {
        line.write(buffer.array(), 0, buffer.position());
        buffer.clear();
        tick = 0;
    }
} 
```

很难解释出了什么问题。我听到了声音，但这只是一种“嗖嗖”的声音。

我想将此方法与字节缓冲区等一起使用，因为我的整个应用程序都是围绕它构建的。使用 Clip 或 AudioInputStream 并不是一个真正的选择。

所以我想我的问题是：

**如何使用字节缓冲区直接从我的字节数组播放声音？**

感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T01:51:31.980

我设法让它工作。这是我的新代码：

```
 int tick = 0;
    for (int i = 0; i < clickSamples.length; i++) {
        tick++;
        if (tick >= bufferSize/SAMPLE_SIZE) {
            line.write(clickSamples, i-tick+1, tick);
            buffer.clear();
            tick = 0;
        }
    } 
```

这似乎是一种播放声音的复杂方式，就像使用 AudioInputStream 一样，但现在我可以对每个滴答++进行计算，并且如果需要，我可以干预准确的时间。

如果这听起来很傻，并且有更简单的方法可以做到这一点，请告诉我。

此外，它听起来如此失真的原因是 ByteBuffer 似乎彻底改变了我的样本值。什么原因我不知道。如果有人知道，请告诉我！

谢谢你。:)

# javascript - 为什么有必要将函数调用包装在函数体中

> ID：14187668
> 
> 赞同：6
> 
> 时间：2013-01-06T22:52:53.767
> 
> 标签：javascript

我经常在 JavaScript 中看到类似下面的内容：

```
$("#sendButton").click(function() {
    sendForm();
} 
```

为什么有必要将调用包装在`sendForm()`函数内部？我认为这样做会更具可读性和更少的打字。

```
$("#sendButton").click(sendForm); 
```

每种方法的优点/缺点是什么？谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-06T23:04:48.037

通常有两种情况，您希望使用前者而不是后者：

1.  如果您需要在调用函数之前对参数进行任何后处理。

2.  如果你在一个对象上调用一个方法，如果你使用第二种形式，作用域（这个引用）会有所不同

例如：

```
MyClass = function(){
    this.baz = 1;    
};

MyClass.prototype.handle = function(){
    console.log(this.baz);    
};

var o = new MyClass();

$('#foo').click(o.handle);
$('#foo').click(function(){
    o.handle();
}); 
```

控制台输出：

```
undefined
1 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T00:56:32.450

现在可能答案太多了，但两者之间的区别在于 的值`this`，即范围，进入`sendForm`。（论点也会有所不同。）让我解释一下。

根据 JavaScript 规范，调用这样的函数：`sendForm();`调用没有上下文对象的函数。这是给定的 JavaScript。

但是，当您将函数作为参数传递时，例如：`$(...).click(sendForm)`，您只需传递对该函数的引用以供以后调用。您还没有调用该函数，而只是像对象引用一样传递它。仅当函数跟随它们时才调用函数（ and`()`除外，稍后讨论）。在任何情况下，如果最终有人调用此函数，那么有人可以选择调用该函数的范围。`call``apply`

在我们的例子中，那个人是 jQuery。当您将函数传递给 时`$(...).click()`，jQuery 稍后将调用该函数并将范围 (this) 设置为单击事件的 HTML 元素目标。你可以试试：`$(...).click(function() { alert(this); });`，会得到一个代表 HTML 元素的字符串。

因此，如果你给 jQuery 一个匿名函数的引用，上面写着`sendForm()`，jQuery 将在调用该函数时设置作用域，然后该函数将在`sendForm`没有作用域的情况下调用。本质上，它将清除`this`. 试试看：`$(...).click(function() { (function() { alert(this); })(); });`。在这里，我们有一个匿名函数调用匿名函数。我们需要内部匿名函数周围的括号，以便 () 应用于该函数。

相反，如果你给 jQuery 一个对命名函数的引用`sendForm`，jQuery 将直接调用这个函数并给它它承诺总是给的范围。

所以你的问题的答案现在变得更加明显：如果你需要`this`在开始工作时指向点击的元素目标，请`sendForm`使用`.click(sendForm)`. 否则，两者都可以正常工作。你可能不需要`this`，所以跳过匿名函数。

对于那些好奇的人，可以通过使用 JavaScript 标准来强制作用域，`apply`或者`call`（[请参阅此处](https://stackoverflow.com/questions/1986896/what-is-the-difference-between-call-and-apply)了解两者之间的差异）。使用点运算符时也会分配范围，例如 in: `obj.func`，它要求 JavaScript 调用`this`指向的函数`obj`。（所以理论上你可以`obj`在调用函数时强制成为作用域，方法是：`obj.foo = (reference to function); obj.foo(); delete obj.foo;`但这是使用 apply 的一种非常丑陋的方式。

jQuery 使用Function`apply`调用具有范围的单击处理程序，也可以在函数调用上强制参数，事实上 jQuery 确实将参数传递给它的单击处理程序。`sendForm`因此，这两种情况之间还有另一个区别：当您从匿名函数调用并且不传递任何参数时，参数（不仅是作用域）会丢失。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-06T23:02:25.930

在这里，您定义了一个可以内联调用多个函数的匿名事件处理程序。调试很脏而且很难，但是人们这样做是因为他们很懒，而且他们可以。

它也可以像您的第二个示例（我如何定义事件处理程序）一样工作：

```
$("#sendButton").click(sendForm) 
```

通过内联定义事件处理程序，您可以获得将事件数据传递给多个函数的能力，并且您可以将`this`范围限定为事件对象：

```
$("#sendButton").click(function(event) {
    sendForm();
    doSomethingElse(event);
    andAnotherThing(event);
    // say #sendButton is an image or has some data attributes
    var myButtonSrc = $(this).attr("src");
    var myData = $(this).data("someData");
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-06T23:12:56.980

如果您所做的只是调用`sendForm`，那么最后，您包含的两个示例之间没有太大区别。

```
$("#sendButton").click(function(event) {
    if(event.someProperty) { /* ... */ }
    else { sendForm({data: event.target, important: 'yes'}); }
} 
```

然而，在上面的例子中，我们可以处理从 传递给回调的参数`click()`，但是如果 sendForm 函数已经具备处理这个的能力，那么没有理由不将 sendForm 作为回调参数，如果这真的是你的全部是做。

```
function sendForm(event) {
    // Do something meaningful here.
}

$("#sendButton").click(sendForm); 
```

请注意，在程序中处理不同逻辑层的位置取决于您；您可能已将某些通用功能封装在一个`sendForm`函数中，然后将其传递给此类函数，该函数在调用自身`sendFormCallback`之前处理事件/回调处理的临时业务。`sendForm`

如果您在回调密集的环境中工作，明智的做法是将重要功能与回调触发器本身分开，以避免[回调地狱](http://callbackhell.com/)并提高源代码的可维护性和可读性。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-06T23:26:46.957

这只是锁定范围。当您将其包装`sendForm()`在关闭当前范围的匿名函数中时。换句话说，`this`遗嘱将被保留。如果您只是通过`sendForm`，那么任何调用都`this`将来自调用范围。
这是一个学习 javascript 范围和质疑约定的好问题。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-06T23:00:26.663

不，第二个例子是完全有效的。

99.9% 的 jQuery 示例使用第一种表示法，这并不意味着您需要忘记基本的 JavaScript 语法。

# facebook - facebook box_count 不起作用

> ID：14187671
> 
> 赞同：0
> 
> 时间：2013-01-06T22:53:10.787
> 
> 标签：facebook

我在 Facebook Developers 页面中创建了一个 Box Count，但计数始终为 0，并且 facebook 页面有喜欢...。

盒子计数的 URL 是：[https ://www.facebook.com/plugins/follow.php?href=https%3A%2F%2Fwww.facebook.com%2FartesanatoEraUmaVez&layout=box_count&show_faces=true&width=450&app_id=100541743441397&locale=pt_PT&sdk= joey&channel=http%3A%2F%2Fstatic.ak.facebook.com%2Fconnect%2Fxd_arbiter.php%3Fversion%3D18%23cb%3Df39d850ef%26origin%3Dhttp%253A%252F%252Fartesanatoeraumavez.com%252Ff2199292d4%26domain%3Dartesanatoeraumavez 26relation%3Dparent.parent](https://www.facebook.com/plugins/follow.php?href=https%3A%2F%2Fwww.facebook.com%2FartesanatoEraUmaVez&layout=box_count&show_faces=true&width=450&app_id=100541743441397&locale=pt_PT&sdk=joey&channel=http%3A%2F%2Fstatic.ak.facebook.com%2Fconnect%2Fxd_arbiter.php%3Fversion%3D18%23cb%3Df39d850ef%26origin%3Dhttp%253A%252F%252Fartesanatoeraumavez.com%252Ff2199292d4%26domain%3Dartesanatoeraumavez.com%26relation%3Dparent.parent)

这是 Facebook 的一个简单缓存问题吗？还是我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T01:11:36.550

那不是一个类似的盒子。那是一个订阅/关注按钮。对于 facebook 页面或网站，您应该使用带有 box_count 布局的点赞按钮或点赞框 [https://developers.facebook.com/docs/reference/plugins/like/](https://developers.facebook.com/docs/reference/plugins/like/) https://developers.facebook.com/docs /reference/plugins/like-box/

# c# - 私有财产的设定值

> ID：14187672
> 
> 赞同：3
> 
> 时间：2013-01-06T22:53:10.917
> 
> 标签：c#, properties, mocking

我正在尝试测试我的课程

```
public class Parser
{

    private static IDictionary<String, Regex> PhrasesToRegexp { get; set; }

    public static void InitPhrases(IList<String> Phrases, Boolean useDeclination )
    {
        throw new NotImplementedException();
    }

    ...

    public ParsingResults Find(String source)
    {
        HtmlDocument doc = new HtmlDocument();
        doc.LoadHtml(source);
        return new ParsingResults(FindUrls(doc), CountPhrases(doc));
    }

    private IList<String> FindUrls(HtmlDocument source)
    {
        return source.DocumentNode.SelectNodes("//a[@href]").
            Select(link => link.GetAttributeValue("href", "")).ToList();
    }

    private IDictionary<String, int> CountPhrases(HtmlDocument source)
    {
        IDictionary<String, int> results = new Dictionary<String, int>();
        foreach (String key in PhrasesToRegexp.Keys)
        {
            results.Add( key , 0 );
        }

        foreach (HtmlNode node in source.DocumentNode.SelectNodes("//p"))
        {
            foreach (String phrase in results.Keys)
            {
                results[phrase] += PhrasesToRegexp[phrase].Matches
                    (Regex.Replace(node.InnerText, @"<(.|\n)*?>", string.Empty)).Count;
            }
        }
        return results;
    }

} 
```

问题是属性`PhrasesToRegexp`已（将）初始化`InitPhrases`，我正在尝试为方法 Find 编写单元测试。基本上我需要设置这个私有属性的值`PhrasesToRegexp`。有没有办法做到这一点？我不是模拟专家，但我认为他们不会这样做，因为这个属性和测试方法在同一个对象中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T23:41:34.410

您可以添加一个专门用于单元测试的新构造函数，但我建议尽量减少对您的类的任何更改以使其可单元测试。支持单元测试的专业化通常意味着您没有测试将在最终应用程序中运行的实际代码。你对它的专业化程度越高，就越难确保真正的代码得到了全面的测试，并且更有可能将不需要的副作用引入到被测代码中。

相反，（如果可能的话）我尝试像客户端一样使用该类 - 如果您构建实例并像客户端那样调用该方法，那么您不需要在私有状态下闲逛，并且您的单元测试将准确测试任何客户端代码将使用什么。此外，如果您更改类的内部工作方式，您的测试更有可能保持有效/有效，因为单元测试没有特殊的途径，您可以忘记与代码更改保持同步。

如果您更喜欢公开属性并直接刺激它，那么将其更改为`internal`并使用`InternalsVisibleTo`是一种标准方法，但这会冒犯我的封装感，因为它对每个人来说都是永久性的。另一个程序员怎么知道你的意思是“用于测试的内部”而不是“嘿，我们是好朋友，请尽情享受我的内部状态”。如果我们在想要进行单元测试时将其丢弃，那么私有有什么用？因此，另一种保持代码私有的方法是使用特殊的构建进行单元测试，它设置了一个#define 以允许您公开您想要访问以进行测试的私有内容，同时在您的正常构建中将它们保留为私有。

一种方法是对属性本身施加蛮力（但这可能非常混乱）：

```
#if UNIT_TEST
    public
#else
    private
#endif
int MyPrivateProperty { get; set; } 
```

或者，一种更简洁的方法（但更多的工作）是保留原始代码并添加访问方法，以最大程度地减少您无意中破坏/更改被测代码的机会。

```
private int MyProperty { get; set; }

#if UNIT_TEST
    public int AccessMyProperty
    {
        get { return(MyProperty); }
        set { MyProperty = value; }
    }
#endif 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-02-17T11:02:26.880

在我的单元测试项目中，我创建了一个扩展原始类的 MockClass，没有重写任何方法或属性。

*   **原始类**：私有的属性被提升为受保护的。
*   **模拟类**：创建了一个设置受保护属性的公共方法。

使用这种方法，您不必将可见性更改为内部，这比受保护的要明显得多。当然，这也意味着如果开发人员想要访问您的属性，他可以通过扩展您的类来访问您的属性，就像您的单元测试一样。

```
public class Parser
{
      protected static IDictionary<String, Regex> PhrasesToRegexp { get; set; }
      ...
}

public class MockParser : Parser
{
     public MockParser() : base()
     {
     }

     public void AddPhraseToRegexp(String key, Regex value)
     {
         // Add it
         PhrasesToRegexp.Add(key, value);
     }

     public void CreatePhrasesToRegexp(IDictionary<String, Regex> newDict)
     {
         // Create a new Dictionary
         PhrasesToRegexp = newDict;
     }
} 
```

**注意：这不适用于静态或密封类**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-06T22:58:25.920

这可能取决于您使用的模拟框架。我通常使用 Moq 或 NMock2，在这些情况下，可行的选择是：

1）使属性内部而不是私有，这允许您在单元测试中设置它。如果您的单元测试在单独的项目中，您可能必须使用 InternalsVisibleTo 属性。

2) 为将接受 PhrasesToRegexp 的单元测试目的创建一个单独的构造函数

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-06T22:59:34.653

1）而不是`private`您应该将其声明为`internal`.

2）在 AssemblyInfo.cs 你应该添加程序集，从那里你的类将被访问如下

```
[assembly: InternalsVisibleTo("MainFormUnitTests")] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-06T23:26:14.490

对我来说，之所以会出现这个问题，是因为您在解析器中表达了两种不同的关注点。

1.  短语和正则表达式的快速参考缓存
2.  解析逻辑

我建议将这两个问题分成两个不同的类别。此外，您可能希望在某些时候清除静态字典的内存（或使缓存无效）。

如果您在接口后面取出缓存逻辑，`ICachePhrasesAndRegex`那么您可以轻松地模拟依赖项以进行测试。

# c++ - 从用户定义的类/指向成员函数的指针子类化编辑控件

> ID：14187674
> 
> 赞同：1
> 
> 时间：2013-01-06T22:53:14.120
> 
> 标签：c++, c, winapi, subclass, editbox

我想我和之前的许多人一样落入了同样的陷阱，我试图在 win32 API 编程上强加一个很好的 OO 方法。没有 MFC，没有 AFX，我什至没有使用 VC++，我使用 C::B 和 gcc。

我认为我正在尝试做的事情是不可能的，但是由于 MFC 存在（尽管我没有使用它），所以必须有某种方法。

我创建了一个包含多个窗口控件的类。它实现了 WM_CREATE 和 WM_COMMAND 的处理程序，并跟踪我的一小组控件（ID 代码和 HWND）周围的所有相关数据。

它适用于按钮、静态控件，甚至是轻量级 GDI 方法，但是当我尝试对编辑控件进行子类化时，这一切都崩溃了。

真的，我只是想捕获“回车”键，但正如任何曾经走过这条路的人都会证明的那样，当编辑控件获得焦点时，父窗口不会收到 WM_KEYDOWN 或 WM_COMMAND，我们只能自己实现过程。超级跛脚。

好的，如果 editProc 是全局或静态的，那么子类化编辑控件就可以了。我知道这是因为 SetWindowLongPtr 需要一个函数地址，而这个概念对于成员函数来说是模糊的。

所以我的类的对象在父 WndProc 中被声明为“静态”。但是该函数不是“静态的”，因为这样我就无法访问非静态数据成员（完全违背了本练习的目的）。我希望因为对象本身是静态的，所以我应该能够正确定义其成员函数之一的地址。

以前尝试过的读者要么已经放弃并使用 MFC 或其他东西，要么可能找到了一个聪明的解决方法。

我将让这个示例代码完成剩下的讨论：（简化 - 不会这样编译）

```
/**** myprogram.c ****/
#include "MyControlGroup.h"

int winMain(){ // etc... }

LRESULT CALLBACK WndProc(HWND hWnd, UINT msg, WPARAM wParam, LPARAM lParam)
{
    // object is static becuse it only needs to be initialized once
    static MyControlGroup myControl; 

    if (msg == WM_CREATE)
        myControl.onWMCreate(hWnd);

    else if (msg == WM_COMMAND)
        myControl.onWMCommand( wParam, lParam );

    else if (msg == WM_DESTROY) 
        PostQuitMessage(0);

    return DefWindowProcW(l_hWnd, l_msg, l_wParam, l_lParam);
} 
```

我的班级的头文件：

```
/**** MyControlGroup.h ****/
class MyControlGroup
{
private:
    HWND m_hWndParent;
    HWND m_hWndEditBox;
    int  m_editBoxID;
public:
    MyControlGroup();
    void onWMCreate(HWND);
    void onWMCommand(WPARAM, LPARAM);

    // want to find a way to pass the address of this function to SetWindowLongPtr
    LRESULT myEditProc(HWND hWnd, UINT msg, WPARAM wParam, LPARAM lParam);
}; 
```

...和实施：

```
/**** MyControlGroup.cpp ****/
static int staticID = 1;
MyControlGroup::MyControlGroup()
{
    m_editBoxID = staticID++;
}

void MyControlGroup::onWMCreate(HWND hWnd)
{
    // My control group has buttons, static controls, and other stuff which are created here with CreateWindowW.  It also has an edit control:
    m_hWndEditBox = CreateWindowW(L"EDIT", L"initial text", WS_CHILD | WS_VISIBLE | WS_BORDER, 10, 10, 150, 20, hWnd, (HMENU)m_editBoxID, NULL, NULL);

    /* 
    To subclass the edit control, I need a pointer to my customized proc.  That means I 
    need a pointer-to-member-function, but SetWindowLongPtr needs a pointer to global or 
    static function (__stdcall or CALLBACK, but not __thiscall).
    */

    // I'd like to do something like this, adapted from a great write-up at
    // http://www.codeproject.com/Articles/7150/Member-Function-Pointers-and-the-Fastest-Possible

    LERSULT (MyControlGroup::*myEditProcPtr)(HWND, UINT, WPARAM, LPARAM);
    myEditProcPtr = &MyControlGroup::myEditProc;

    // Up to now it compiles ok, but then when I try to pass it to SetWindowLongPtr, I get 
    // an "invalid cast" error.  Any ideas?
    SetWindowLongPtr(m_hWndEditBox, GWLP_WNDPROC, (LPARAM)myEditProcPtr);
}

void MyControlGroup::onWMCommand(WPARAM wParam, LPARAM lParam){ /* process parent window messages.  Editboxes don't generate WM_COMMAND or WM_KEYDOWN in the parent :''( */}

LRESULT MyControlGroup::myEditProc(HWND hWnd, UINT msg, WPARAM wParam, LPARAM lParam)
{
    // process messages like IDOK, WM_KEYDOWN and so on in the edit control
} 
```

即使我完成了这项工作，我仍然需要想办法将父 WndProc 的地址传递给 myEditProc 以获得返回值，但在我克服这一点之前，没有必要担心这一点。

提前感谢您的阅读！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T23:28:58.133

`myEditProc`必须是静态函数。完成后，您可以直接传递函数的地址，而无需通过中间变量：

```
static LRESULT myEditProc(HWND hWnd, UINT msg, WPARAM wParam, LPARAM lParam);
...
SetWindowLongPtr(m_hWndEditBox, GWLP_WNDPROC, (LPARAM)myEditProc); 
```

要从静态函数访问您的类数据，您可以将其保存在编辑控件的 userdata 字段中，例如：

```
// before sub-classing the control
SetWindowLongPtr(m_hWndEditBox, GWLP_USERDATA, (LPARAM)this);

// in the sub-class procedure
MyControlGroup* pThis = (MyControlGroup*)GetWindowLongPtr(m_hWndEditBox, GWLP_USERDATA); 
```

但正如@K-ballo 建议`SetWindowSubclass`的那样，除非您想要与 pre-XP 兼容，否则绝对是这样做的方法。它自动为您处理子类化过程，让您关联一个`this`自动传递给子类过程的用户数据指针（例如 ），并在最后安全地处理删除子类。

# apache - 无法缩短我的 MediaWiki 站点 URL？哪里 指示？

> ID：14187676
> 
> 赞同：2
> 
> 时间：2013-01-06T22:53:26.630
> 
> 标签：apache, mediawiki

我在 Host Gator 上使用基本托管计划。我安装了 MediaWiki，我得到了其中的 URL `index.php?title=`，即`www.domain.com/index.php?title=Main_Page`

我想删除该`index.php?title=`部分，只显示页面标题。我正在遵循[http://www.mediawiki.org/wiki/Manual:Short_URL/Page_title_--_Windows_%26_Apache_without_403_on_Special_Pages](http://www.mediawiki.org/wiki/Manual:Short_URL/Page_title_--_Windows_%26_Apache_without_403_on_Special_Pages)的说明，不确定这是否是我应该使用的正确说明。

说明的第 1 步表明“如果您配置了 vHosts，请将以下 Rewrite 指令插入到相应的`<VirtualHost>`指令中。否则，将其插入到`<directory>`您的 wiki 根目录的指令中：”并插入：

```
RewriteEngine On    
RewriteRule ^/(.*):(.*) /index.php/$1:$2 
```

`<directory>`该指令位于何处？我应该将代码插入到哪个文件中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-16T16:39:12.617

该[`<directory>`块](http://httpd.apache.org/docs/2.2/mod/core.html#directory)是 httpd.conf Apache 配置文件指令。

在共享主机环境中，您通常无法直接访问他的文件。您仍然可以访问[.htaccess 文件](http://httpd.apache.org/docs/current/howto/htaccess.html)，该文件允许使用大多数配置指令。

在您的 Web 根目录（与`index.php`和相同的目录`LocalSettings.php`）创建一个 .htaccess 并在此文件中写入 RewriteEngine / RewriteRules 指令。

如果失败，请遵循本指南，更适合您的情况： [http ://www.mediawiki.org/wiki/Manual:Short_URL/Apache](http://www.mediawiki.org/wiki/Manual:Short_URL/Apache)

# scala - 查询表时，shark/spark 抛出 NPE

> ID：14187678
> 
> 赞同：4
> 
> 时间：2013-01-06T22:53:30.910
> 
> 标签：scala, nullpointerexception, classnotfoundexception, apache-spark, shark-sql

Shark/spark wiki 的开发部分非常简短，因此我尝试编写代码以编程方式查询表。这里是 ...

```
object Test extends App {
  val master = "spark://localhost.localdomain:8084"
  val jobName = "scratch"

  val sparkHome = "/home/shengc/Downloads/software/spark-0.6.1"
  val executorEnvVars = Map[String, String](
    "SPARK_MEM" -> "1g",
    "SPARK_CLASSPATH" -> "",
    "HADOOP_HOME" -> "/home/shengc/Downloads/software/hadoop-0.20.205.0",
    "JAVA_HOME" -> "/usr/lib/jvm/java-1.6.0-openjdk-1.6.0.0.x86_64",
    "HIVE_HOME" -> "/home/shengc/Downloads/software/hive-0.9.0-bin"
  )

  val sc = new shark.SharkContext(master, jobName, sparkHome, Nil, executorEnvVars) 
  sc.sql2console("create table src")
  sc.sql2console("load data local inpath '/home/shengc/Downloads/software/hive-0.9.0-bin/examples/files/kv1.txt' into table src")
  sc.sql2console("select count(1) from src")
} 
```

我可以创建表 src 并将数据加载到 src 中，但是最后一个查询抛出 NPE 并失败，这是输出...

```
13/01/06 17:33:20 INFO execution.SparkTask: Executing shark.execution.SparkTask
13/01/06 17:33:20 INFO shark.SharkEnv: Initializing SharkEnv
13/01/06 17:33:20 INFO execution.SparkTask: Adding jar file:///home/shengc/workspace/shark/hive/lib/hive-builtins-0.9.0.jar
java.lang.NullPointerException
    at shark.execution.SparkTask$$anonfun$execute$5.apply(SparkTask.scala:58)
    at shark.execution.SparkTask$$anonfun$execute$5.apply(SparkTask.scala:55)
    at scala.collection.IndexedSeqOptimized$class.foreach(IndexedSeqOptimized.scala:34)
    at scala.collection.mutable.ArrayOps.foreach(ArrayOps.scala:38)
    at shark.execution.SparkTask.execute(SparkTask.scala:55)
    at org.apache.hadoop.hive.ql.exec.Task.executeTask(Task.java:134)
    at org.apache.hadoop.hive.ql.exec.TaskRunner.runSequential(TaskRunner.java:57)
    at org.apache.hadoop.hive.ql.Driver.launchTask(Driver.java:1326)
    at org.apache.hadoop.hive.ql.Driver.execute(Driver.java:1118)
    at org.apache.hadoop.hive.ql.Driver.run(Driver.java:951)
    at shark.SharkContext.sql(SharkContext.scala:58)
    at shark.SharkContext.sql2console(SharkContext.scala:84)
    at Test$delayedInit$body.apply(Test.scala:20)
    at scala.Function0$class.apply$mcV$sp(Function0.scala:34)
    at scala.runtime.AbstractFunction0.apply$mcV$sp(AbstractFunction0.scala:12)
    at scala.App$$anonfun$main$1.apply(App.scala:60)
    at scala.App$$anonfun$main$1.apply(App.scala:60)
    at scala.collection.LinearSeqOptimized$class.foreach(LinearSeqOptimized.scala:59)
    at scala.collection.immutable.List.foreach(List.scala:76)
    at scala.collection.generic.TraversableForwarder$class.foreach(TraversableForwarder.scala:30)
    at scala.App$class.main(App.scala:60)
    at Test$.main(Test.scala:4)
    at Test.main(Test.scala)
FAILED: Execution Error, return code -101 from shark.execution.SparkTask13/01/06 17:33:20 ERROR ql.Driver: FAILED: Execution Error, return code -101 from shark.execution.SparkTask
13/01/06 17:33:20 INFO ql.Driver: </PERFLOG method=Driver.execute start=1357511600030 end=1357511600054 duration=24>
13/01/06 17:33:20 INFO ql.Driver: <PERFLOG method=releaseLocks>
13/01/06 17:33:20 INFO ql.Driver: </PERFLOG method=releaseLocks start=1357511600054 end=1357511600054 duration=0> 
```

但是，我可以通过在 bin/shark-withinfo 调用的 shell 中输入 select * from src 来查询 src 表

您可能会问我如何在由“bin/shark-shell”触发的 shell 中尝试该 sql。好吧，我无法进入那个外壳。这是我遇到的错误...

[https://groups.google.com/forum/?fromgroups=#!topic/shark-users/glZzrUfabGc](https://groups.google.com/forum/?fromgroups=#!topic/shark-users/glZzrUfabGc)

[编辑 1]：这个 NPE 似乎是由 SharkENV.sc 导致的，所以我添加了

```
shark.SharkEnv.sc = sc 
```

在执行任何 sql2console 操作之前。然后它抱怨 scala.tools.nsc 的 ClassNotFoundException，所以我手动将 scala-compiler 放在类路径中。之后，代码又抱怨了另一个 ClassNotFoundException，我不知道如何修复它，因为我确实将鲨鱼罐放在了类路径中。

```
13/01/06 18:09:34 INFO cluster.TaskSetManager: Lost TID 1 (task 1.0:1)
13/01/06 18:09:34 INFO cluster.TaskSetManager: Loss was due to java.lang.ClassNotFoundException: shark.execution.TableScanOperator$$anonfun$preprocessRdd$3
    at java.net.URLClassLoader$1.run(URLClassLoader.java:217)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:205)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:321)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:266)
    at java.lang.Class.forName0(Native Method)
    at java.lang.Class.forName(Class.java:264) 
```

[编辑 2]：好的，我想出了另一个代码，它可以通过完全按照鲨鱼的源代码来实现我想要的，如何初始化交互式 repl。

```
System.setProperty("MASTER", "spark://localhost.localdomain:8084")
System.setProperty("SPARK_MEM", "1g")
System.setProperty("SPARK_CLASSPATH", "")
System.setProperty("HADOOP_HOME", "/home/shengc/Downloads/software/hadoop-0.20.205.0")
System.setProperty("JAVA_HOME", "/usr/lib/jvm/java-1.6.0-openjdk-1.6.0.0.x86_64")
System.setProperty("HIVE_HOME", "/home/shengc/Downloads/software/hive-0.9.0-bin")
System.setProperty("SCALA_HOME", "/home/shengc/Downloads/software/scala-2.9.2")

shark.SharkEnv.initWithSharkContext("scratch")
val sc = shark.SharkEnv.sc.asInstanceOf[shark.SharkContext]

sc.sql2console("select * from src") 
```

这很丑陋，但至少它有效。欢迎任何关于如何编写更健壮的代码的评论！

对于希望以编程方式对 Shark 进行操作的人，请注意所有 hive 和 Shark jar 都必须在您的 CLASSPATH 中，并且 scala 编译器也必须在您的类路径中。另一个重要的事情是 hadoop 的 conf 也应该在类路径中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-26T22:04:14.980

我相信问题是你的 SharkEnv 没有初始化。我正在使用 Shark 0.9.0（但我相信您也必须在 0.6.1 中初始化 SharkEnv），并且我的 SharkEnv 以以下方式初始化：

```
// SharkContext
val sc = new SharkContext(master, 
    jobName, 
    System.getenv("SPARK_HOME"), 
    Nil, 
    executorEnvVar)

// Initialize SharkEnv
SharkEnv.sc = sc

// create and populate table
sc.runSql("CREATE TABLE src(key INT, value STRING)")
sc.runSql("LOAD DATA LOCAL INPATH '${env:HIVE_HOME}/examples/files/kv1.txt' INTO TABLE src")

// print result to stdout
println(sc.runSql("select * from src"))
println(sc.runSql("select count(*) from src")) 
```

另外，尝试在没有聚合函数的情况下从 src 表中查询数据（带有“select count(*) ...”的注释行），当数据查询正常时我遇到了类似的问题，但是 count(*) 抛出异常，通过添加*mysql修复-connector-java.jar*到*yarn.application.classpath*在我的例子中。

# javascript - FireFox 中的 javascript 数组

> ID：14187680
> 
> 赞同：1
> 
> 时间：2013-01-06T22:53:53.803
> 
> 标签：javascript, jquery, firefox, variables

发生了一件奇怪的事情，真的不知道如何解决这个问题。谷歌搜索时我也没有找到有用的东西。

我有一个包含以下内容的 html 表单：

```
<label for="gebied">Gebieden</label>
<div class="button button-selected"><input type="checkbox" name="areas" value="nederland" checked="checked" />Nederland</div>
<div class="button button-selected"><input type="checkbox" name="areas" value="europa" checked="checked" />Europa</div>
<div class="button button-selected"><input type="checkbox" name="areas" value="wereld" checked="checked" />De Wereld</div> 
```

然后使用 javascript (jQuery) 检查哪些已检查，哪些未检查：

```
var areas = [];
$('input[name=areas]:checked').each(function(){
areas.push($(this).val());
 }); 
```

这是`createShortUrl();`在相关代码中从内部调用的：

```
$(function() {
    //Handle things when a buttons is clicked
    $("div.button").click(function() {
        //Find the input field for the clicked div
        var input = $(this).find(':input');
        var inputName = $(input).attr('name');
        //Handle checkboxes, which define the gebied
        if ($(input).is(':checkbox')) {
            //Change the classes
            input.prop('checked', !input[0].checked);
            $(this).toggleClass('button-selected');
        }
        //Handle radio
        if ($(input).is(':radio')) {
            $('form').find('input[name=' + inputName + ']').each(function() {
                $(this).parent('div').toggleClass('button-selected');
                $(this).prop('checked', !input[0].checked);
            });
        }
        //Clicking means something chanhes; create a new short url
        createShortUrl();
    });
}); 
```

奇怪的是，在 Firefox 中，当我之前检查过其中的一些时，它们仍停留在区域数组中。即使我取消选中其中一些，它们也会留在数组中，反之亦然。但是在 Safari 中调试时，它就像一个魅力！

然后，当我取消选中所有内容时，数组为空。重新检查一些，并在数组中有。

那么，有什么想法，Firefox 发生了什么？看起来 FF 正在缓存，即使经过几次刷新，前一个数组也是如此。尽管我

> 变量区域 = []

我希望在其中清空并重建它....

[它在这里](http://topografieindeklas.nl/jouw-boekje)直播，在点击底部的大按钮后触发。

任何想法都更受欢迎！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T11:20:46.053

问题在于您的事件处理程序。问题是，您修改元素状态的方式在 Firefox 中不起作用。您应该使用`attr()`而不是`prop()`更改`checked`状态。

**工作代码：**替换`.prop()`为`.attr()`.

```
//Handle things when a buttons is clicked
$("div.button").click(function() {
    console.log("Click");

    //Find the input field for the clicked div
    var input = $(this).find(':input');
    var inputName = $(input).attr('name');

    //Handle checkboxes, which define the gebied
    if ($(input).is(':checkbox')) {
        //Change the classes
        console.log("check");
        input.attr('checked', !input[0].checked);
        $(this).toggleClass('button-selected');
    }

    //Handle radio
    if ($(input).is(':radio')) {
        $('form').find('input[name=' + inputName + ']').each(function() {
            $(this).parent('div').toggleClass('button-selected');
            $(this).attr('checked', !input[0].checked);
        });
    }
    //Clicking means something chanhes; create a new short url
    createShortUrl();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T11:02:59.567

您正在将输入的*值*（这些是字符串）推送到静态数组中。没有理由在 Firefox 或任何其他浏览器中与 DOM 一起更新此数组。

如果您要将 DOM 元素本身存储在数组中并从中检索值，那将是另一回事。

# ruby-on-rails - Rails / execjs 找不到 Node.js

> ID：14187681
> 
> 赞同：7
> 
> 时间：2013-01-06T22:53:55.013
> 
> 标签：ruby-on-rails, ruby, node.js, centos, execjs

我通过从 root 用户编译和安装 node.js 来安装它。我想这可能是挂断的地方。从运行 rails 应用程序的用户那里，我检查了 node.js。

```
$ which node
/usr/local/bin/node 
```

当我启动我的 Rails 应用程序（Rails 3.2.9）时，我得到了普遍无益的“我们很抱歉，但出了点问题”。检查生产错误日志，我发现未找到 Javascript 运行时。这很令人困惑，因为它显然已安装。所以我开始强制 Node javascript 运行时。我编辑了 config/boot.rb 以包括：

```
ENV['EXECJS_RUNTIME'] = 'Node' 
```

我再次检查了我的应用程序，同时查看了生产日志。这次我得到了错误

```
ActionView::Template::Error (Node.js (V8) runtime is not available on this system 
```

还是一头雾水。我去了 execjs gem 并将运行时命令更改为确切的安装路径。

```
Node = ExternalRuntime.new(
  :name        => "Node.js (V8)",
  :command     => "/usr/local/bin/node",
  :runner_path => ExecJS.root + "/support/node_runner.js",
  :encoding    => 'UTF-8'
) 
```

我仍然得到同样的错误。节点已安装并可供用户访问，但 gem/rails 似乎无法使用它。服务器运行 CentOS 6.3。导致抛出错误的特定 javascript 文件是 jquery.nivo.slider.pack.js。从 nivo 下载后我没有编辑它。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-06-03T16:15:20.110

所以，我在 CentOS 5.10 上安装了 Ruby 2.0.0 和 Rails 4.0.2，使用 Apache2 和 Passenger。我尝试的第一步是打开 rails 控制台并输入以下命令：

```
ExecJS.runtime 
```

它返回以下值：

> #<ExecJS::ExternalRuntime:0x99ab380 @name="Node.js (V8)", @command=["nodejs", "node"],@runner_path="/home/foo/vendor/bundle/ruby/2.0\. 0/gems/execjs-2.1.0 /lib/execjs/support/node_runner.js", @encoding="UTF-8", @deprecated=false, @binary="node">

这意味着该节点确实已安装并检测到，但由于某种原因它无法正常工作。

因此，我尝试了网站上的示例：

```
ExecJS.eval("'red yellow blue'.split(' ')") 
```

我得到了正确的回应。所以，现在我想知道为什么乘客没有拿起它。

然后，我注意到乘客显示了路径变量，它看起来像：

> /home/foo/vendor/bundle/ruby/2.0.0/bin:/usr/local/rvm/gems/ruby-2.0.0-p481/bin:/usr/local/rvm/gems/ruby-2.0.0 -p481@global/bin:/usr/local/rvm/rubies/ruby-2.0.0-p481/bin:/usr/kerberos/bin:/sbin:/usr/sbin:/bin:/usr/bin:/ usr/local/rvm/bin:/home/foo/bin

但是，它似乎缺少`usr/local/bin`. 我不是 Linux 专家，所以对我来说，解决这个问题的最简单方法是使用符号链接。所以，我执行`ln -s /usr/local/bin/node /usr/bin/node`. 您可能要注意，我使用命令找到了我的 nodejs 的路径`find / -name node`。

然后我刷新了我的 Web 应用程序，你不知道它有效吗？所以，如果它对我有用，我希望它可以帮助别人。

**更新（可能更好的方式）：** 这可能是一种更好的方式。我们可以像这样从源代码编译它：

```
mkdir ~/install
cd ~/install
wget https://nodejs.org/dist/v7.2.1/node-v7.2.1.tar.gz
tar xvf node-v7.2.1.tar.gz
cd node-v7.2.1
./configure --prefix=/usr/
make && make install 
```

这样，Node.js 将安装在Passenger 期望的路径中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-03T08:20:39.987

我在我的 centos 6.3 系统上使用源代码安装 nodejs 时遇到了类似的问题。它已成功安装，但我一直无法编译我的 ror 应用程序资产，直到我明确将 PATH 设置为它的安装位置（nodejs）

[root]# make install
...
安装 /usr/local/lib/node_modules/npm/html/doc/folders.html
符号链接 ../lib/node_modules/npm/bin/npm-cli.js -> /usr/ local/bin/npm
更新 /usr/local/bin/npm 的 shebang 到 /usr/local/bin/node

[root]# export PATH=/usr/local/bin:$PATH

现在它起作用了。希望有帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-06T23:18:51.167

我不知道这是否会有所帮助，但请检查您的 $PATH 该节点是否在其中。另外，如果你想使用 node，你应该使用 rvm。检查您的节点安装是否正确完成。

# c# - 远程连接到cpanel中的mysql数据库

> ID：14187682
> 
> 赞同：1
> 
> 时间：2013-01-06T22:53:57.613
> 
> 标签：c#, mysql, connection-string, cpanel

我在 C# 中有一个应用程序，我想在 cpanel 中远程连接到 mysql 数据库，我的代码是：

```
static string MyConString = SERVER= remoteDomin.com;DATABASE=XXX;UID=XXX;PASSWORD=XXX;";
MySqlConnection connection = new MySqlConnection(MyConString); 
```

但这不能成功并抛出`MySql.Data.MySqlClient.MySqlException`：

> 用户 'XXXr'@'adsl-109-74-46-204.dynamic.yemennet.ye' 的访问被拒绝（使用密码：YES）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T01:22:47.357

“在 cpanel 中”是什么意思？您的 MySQL 服务器是否在托管服务提供商处运行？您的客户端在本地计算机上吗？如果是这样，这意味着您正在尝试通过公共互联网在您的 MySQL 客户端和服务器之间进行连接。看起来这当然是你想要做的。

许多托管服务提供商不允许这样做。您的确实如此，因为您收到的消息表明 MySQL 服务器正在拒绝您的特定连接请求。

您需要在 MySQL 数据库中授予访问权限，以便

```
XXXr@% 
```

或许

```
XXXr@adsl-109-74-46-204.dynamic.yemennet.ye 
```

可以访问您的数据库。第一个选项授予尝试从任何主机连接的用户 XXXr 的访问权限。第二个提到与您当前的 ADSL 访问 IP 号码一起使用的主机名。

如果您不知道如何通过您的 cpanel 授予此用户权限（也称为用户访问权限），请向您的托管服务提供商的技术支持寻求帮助。

您的托管服务提供商（运行 MySQL 服务器并提供对它的 cpanel 访问的服务）可能不允许这样做。通常认为允许来自公共互联网的 MySQL 数据库连接有些不安全。

# mercurial - mercurial中书签的目的是什么？

> ID：14187686
> 
> 赞同：3
> 
> 时间：2013-01-06T22:54:13.267
> 
> 标签：mercurial

我读到了 mercurial 中的书签，每个来源都说它就像 git 分支，每次提交时都会更新书签，但我真的不明白它的目的是什么。任何指导将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-06T23:41:10.397

来自[Mercurial 维基](http://mercurial.selenic.com/wiki/BookmarksExtension)：

> 书签是对提交的引用，在进行新提交时会自动更新。如果您使用 hg 书签功能，则功能书签指的是当前变更集。当您工作和提交更改时，书签将随着您所做的每一次提交而前进。书签将始终指向您工作中的最新版本。由于书签在提交到它们指向的变更集时会自动更新，因此它们对于跟踪不同的头特别有用。因此，它们可用于尝试新功能或提取尚未审核的更改。

我还建议阅读[这篇文章](http://stevelosh.com/blog/2009/08/a-guide-to-branching-in-mercurial/#branching-with-bookmarks)，以了解在 Mercurial 中分支的各种方法的概述。

我建议不要使用书签并试图找到它们的用途，而是找到一个您认为在您的团队中自然使用的过程，然后找到 Mercurial 在该过程的上下文中如何最好地处理分支，无论是使用书签还是克隆或什么你。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-09T23:19:41.703

在 Mihai Danila 的优点中添加一些小细节：

简而言之，书签很像：*“没有永久移动日志的可移动标签”*。

在“可移动标签”属性之上构建了各种功能，例如合并来自其他克隆的书签、在您提交书签时自动移动书签等。但基本思想几乎就是这样。您可以附加到变更集的符号名称，很像“标签”，但可以根据需要在历史记录中任意向前或向后移动。

您绝对可以在书签之上构建一个分支方案。事实上，Mercurial 本身已经为开发团队用来协调 Mercurial 自身开发的两个书签采用了名称“crew”和“crew-stable”。但你不必这样*做*。

我 100% 同意 Mihai 所写的内容：“不要使用书签并试图找到它们的用途，而是找到一个您认为在您的团队中自然使用的过程，然后找出 Mercurial 在这个过程，无论是书签还是克隆，或者你有什么”。

# bash - Linux/Unix zipsplit vs split 命令的好处

> ID：14187690
> 
> 赞同：0
> 
> 时间：2013-01-06T22:54:30.390
> 
> 标签：bash, ftp, split, zip

你什么时候从 Linux/Unix 命令行使用 zipsplit 和 split？

我不得不从命令行分解一个大的 zip 文件以防止 ftp 超时（是的，我使用的是被动模式），有人建议使用 zipsplit。此命令不会分解为小于最大文件的单元，并且当我尝试在另一侧重新加入时，一切都没有正确重新加入。split 命令让我可以将任何文件分解成任意大小，并通过一个简单的 cat 命令重新连接。

我只是很沮丧，只是不明白为什么 zipsplit 与 split 相比存在。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-06T22:58:31.200

`zipsplit`将 zip 文件拆分为更小的有效、可读、可解压缩的 zip 文件。使用`split`，您无法对碎片做任何有用的事情，直到您重新加入它们。

# javascript - 如何在 Ruby on Rails 项目中使用 JavaScript 解码 HTML 实体

> ID：14187692
> 
> 赞同：0
> 
> 时间：2013-01-06T22:54:32.927
> 
> 标签：javascript, ruby-on-rails, html-entities

我正在处理 Ruby on Rails 和 JavaScript。
主要的基本思想是我在模型的类函数中创建一个对象，并在 JavaScript 中调用这个函数。那里的**问题是****HTML 实体被编码**的任何地方。

现在详细说明：
在我的模型函数`getData(firstOpt, secondOpt, amount)`中，我创建了一个如下所示的对象（当我在 ruby​​ 控制台中调用该函数时）：

```
[#<JobCompact build_compact_id: 324>, #<JobCompact build_compact_id: 325>, #<JobCompact build_compact_id: 325>] 
```

现在我将它放入一个数组中（因为我想稍后在该数组中有更多条目）在第一个位置：

```
data[0] = firstLang 
```

（注意：我也试过 -> data[0] = firstLang.to_json）

最后我只返回数组数据。现在我在 JavaScript 中调用该函数：

```
var curData = <%= BuildCompact.getData("ruby", "rubinius", 15) %>; 
```

错误是：`Uncaught SyntaxError: Unexpected token ILLEGAL`
因为它将我的 ruby​​ 函数结果转换为：var curData = `[[#&lt;JobCompact id: 841, language: &quot;ruby&quot;, version: &quot;1.609481891837258&quot;`etc。

我还尝试解码结果：
`var curData = htmlentities((<%= BuildCompact.getData("ruby", "rubinius", 15) %>).toString());`

还有许多其他变体，但我无法弄清楚。有没有人遇到过类似的问题？

注意：我希望该帖子不是重复的，因为我不知道在哪里编码（在 Ruby 或 Javascript 中）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T16:50:42.280

好的，我的问题的答案是：

```
var curData = <%=raw BuildCompact.getData("ruby", "rubinius", 500).to_json %>; 
```

# silverstripe - 在循环图像上调用方法

> ID：14187694
> 
> 赞同：0
> 
> 时间：2013-01-06T22:55:06.580
> 
> 标签：silverstripe

我遵循了使用 UploadField（使用 DataExtension 扩展图像）创建简单图像库的教程。我正在为我的画廊使用 BulkImageUploader 扩展，但我想我会尝试使用本机 SS 功能。我可以遍历模板中的 GalleryImages 并获得对 $URL、$Title 等的访问权限，但是我将如何调用我在每个循环的 Image 或 Image 模板方法上的 ImageExtension 中创建的方法？

例如：

```
$Image.setWidth(80) 
```

不起作用。也没有

```
$File.setWidth(80). 
```

我希望能够缓存所有调整大小的图像。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T13:17:15.380

我可以在这里找到关于 SSbits 问题的答案：[http](http://www.ssbits.com/snippets/2009/resizing-an-image-in-a-custom-img-tag/) ://www.ssbits.com/snippets/2009/resizing-an-image-in-a-custom-img-tag/ 。

在图像的上下文中，必须直接使用方法名称，而不是使用`$Image`or 。`$File`例如。`$CroppedImage(200,200).URL`或`$SetWidth(80)`。

# html - Chrome flexbox 拖放重绘错误？

> ID：14187703
> 
> 赞同：0
> 
> 时间：2013-01-06T22:56:05.103
> 
> 标签：html, google-chrome, drag-and-drop, flexbox

我正在学习 HTML 5 拖放并遵循本教程：

[http://html5doctor.com/native-drag-and-drop/](http://html5doctor.com/native-drag-and-drop/)

我已经让它工作了，但考虑到我的最终目的是构建一个小页面，可以将图像从一个 div 拖放到另一个，我正在做的是获取拖动元素的 id，然后做一个该元素的 .appendChild 到可以放置图像的 div 中。

它工作正常，但似乎在 Chrome（在 OSX 上）上存在重绘错误，因为一旦我将三个图像中的一个拖到放置目标，它就会被添加，但它的幽灵仍然在原始 div 上。有时它会通过滚动页面消失，有时它不会。

如果我删除了使原点/目标成为弹性框的 CSS，它可以正常工作，没有重影。

以下是我的 html/css/js，但我也把它放在了这里：http: [//jsfiddle.net/3JznW/](http://jsfiddle.net/3JznW/)

```
<!doctype html>
<html>
<head>
<meta charset="utf-8" />
<title> Drag and Drop </title>
<script src="http://html5demos.com/h5utils.js"></script>
<style>

.fbox
{
    display: -webkit-flex;
    display: flex;
    -webkit-justify-content: space-around;
    justify-content: space-around;
    -webkit-align-items: center;
    align-items: center;
}

#origin {
    width: 600px;
    height: 120px;
    background-color: silver;   
}
#origin > div
{
    margin-top: 10px;
    background-color: DeepSkyBlue;
}

#drop {
    background-color: lightblue;
    width: 800px;
    height: 300px;
}

</style>
</head>
<body>
<div id="wrapper">
    <div id="origin" class="fbox">
        <img src="http://placehold.it/140x100" id="one" title="one" />
        <img src="http://placehold.it/170x100" id="two" title="two" />
        <img src="http://placehold.it/190x100" id="three" title="three" />
    </div>
    <p />
    <div id="drop" class="fbox">
    </div>
</div>

<script>

var dragItems = document.querySelectorAll("img");

for (var i = 0; i < dragItems.length; i++) {

    addEvent(dragItems[i], 'dragstart', function (event) {

        event.dataTransfer.setData("Text", this.id);
        console.log("dragged the id!! " + this.id);

  });
}

var drop = document.querySelector('#drop');

addEvent(drop, 'dragover', cancel);
addEvent(drop, 'dragenter', cancel);

addEvent(drop, 'drop', function (event) {

  if (event.preventDefault) {
    event.preventDefault(); 
  }

  var id = event.dataTransfer.getData('Text');

  var elem = document.getElementById(id);

  drop.appendChild(elem);

  return false;
});

function cancel(event) {
  if (event.preventDefault) {
    event.preventDefault();
  }
  return false;
}

</script>
</body>
</html> 
```

这个问题是因为我的代码而发生的吗？或者这会是一个 Chrome 错误吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T02:05:35.450

好吧，没有人回答，这在 Safari 中运行良好，所以它必须是一个 Chrome (v23.0) 错误。

我为解决拖放 div 的重影所做的工作是淡入/淡出原始 div，这似乎可以解决它。

# javascript - 在javascript中使用变量

> ID：14187705
> 
> 赞同：0
> 
> 时间：2013-01-06T22:56:14.060
> 
> 标签：javascript, json, google-maps-api-3

从谷歌地图API文档中我得到了这个工作：

```
var flightPlanCoordinates = [
    new google.maps.LatLng(37.772323, -122.214897),
    new google.maps.LatLng(21.291982, -157.821856),
    new google.maps.LatLng(-18.142599, 178.431),
    new google.maps.LatLng(-27.46758, 153.027892)
  ]; 
```

我试图做的是用我自己的循环复制这段代码，这样我就可以使用以前存储的坐标，如下所示：

```
var output;
$.getJSON('DisplayMap.php',  function(data) {
        var output = "[ ";
        for (var i in data.b) {
            output+= "new google.maps.LatLng" + "(" + data.b[i].Ya + ", " + data.b[i].Za + ")," + " ";
        }

       output+= "]";
        document.getElementById("placeholder").innerHTML=output;
    alert(output);
  });

                output+= "]"; 
```

我检查了输出，它看起来完全符合我的要求。但是，当我像这样替换它时不起作用：

```
var flightPlanCoordinates = output; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T23:04:03.387

在您的新代码中，您正在构建一个字符串而不是一个数组。你应该有这样的东西：

```
var output = [];

for (var i in data.b) {
    output.push(new google.maps.LatLng(data.b[i].Ya, data.b[i].Za));
} 
```

此外，您创建了一个名为`output`inside 和 outside 的变量，我对此感到有些困惑`getJSON`。请记住，这`getJSON`是异步的，您将无法在`getJSON`调用后立即从内部使用该变量。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-06T23:05:12.220

您必须设置正确的 javascript`Array`而不是字符串。像这样：

```
var output = [];
$.getJSON('DisplayMap.php',  function(data) {
        for (var i in data.b) {
            output.push(new google.maps.LatLng(data.b[i].Ya, data.b[i].Za));
        }
  }); 
```

# python - Python 3.3 中非常奇怪的错误

> ID：14187712
> 
> 赞同：0
> 
> 时间：2013-01-06T22:56:56.500
> 
> 标签：python, string

好的，所以我做了这个小函数，它允许我将一个字符串变成 32 个字符的乘数，但是当我使用 String .replace 时，我得到了一些非常非常奇怪的错误。既然它让我拉我的头发，你们能不能看看我错过了什么。

```
Variables:
        self.blockSize = 32
        self.interrupt = '$^EnD#Block^$'
        self.filler = '#'

Functions:
    def pad(self, data):
        joint1 = ''.join([data, self.interrupt])
        joint2 = self.filler * ((self.blockSize - len(joint1)) % self.blockSize) 
        return ''.join([joint1, joint2])

    def unpad(self, data):
        data = str(data).rstrip(self.interrupt)
        return data.replace(self.filler, '')

Call:
p = e.pad('this is not a very good idea  yo')
print(p)
print(e.unpad(p))

Output:
    Jans-MacBook-Pro:test2 jan$ ../../bin/python3 data.py 
    this is not a very good idea  yo123$^EnD#Block^$################
    this is not a very good idea  yo123
    Jans-MacBook-Pro:test2 jan$ ../../bin/python3 data.py 
    this is not a very good idea  yo$^EnD#Block^$###################
    this is not a very good idea  y
    Jans-MacBook-Pro:test2 jan$ 
```

它使 o in yo 消失。啊啊啊！但是，如果我之后添加一些随机数，什么都不会消失。

解决方案 - 编辑：我的错。我放错了self.filler和self.interrupt。我现在好尴尬。代码应该是：

```
def unpad(self, data):
    data = str(data).rstrip(self.filler)
    return data.replace(self.interrupt, '') 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-06T23:01:51.717

阅读以下[文档](http://docs.python.org/2/library/stdtypes.html#str.rstrip)`rstrip`：

> chars 参数是一个字符串，指定要删除**的字符集。**

`rstrip`删除传递的字符集中*存在的**所有*尾随字符。它不会按顺序删除由这些字符组成的尾随子字符串。 给，也给。*`'abczyx'.rstrip('xyz')``'abc'``'abczyx'.rstrip('zyx')``'abc'`*

# sql - 从条件返回的日期开始生成日期 - SQL

> ID：14187715
> 
> 赞同：0
> 
> 时间：2013-01-06T22:57:23.230
> 
> 标签：sql, date

根据我之前提出[的链接问题，](https://stackoverflow.com/questions/13777730/table-date-column-comparison-with-a-generated-dates-list-mysql)[可以使用 a](https://stackoverflow.com/questions/13777730/table-date-column-comparison-with-a-generated-dates-list-mysql)[和 a生成](https://stackoverflow.com/questions/13777730/table-date-column-comparison-with-a-generated-dates-list-mysql)[`series of dates`具有指定的 A。`interval``variable``static date`](https://stackoverflow.com/questions/13777730/table-date-column-comparison-with-a-generated-dates-list-mysql)但是，当有一个`where`生成开始日期的子句时，`dates generation`似乎停止并且只显示第一个间隔日期。我还检查了其他帖子，我发现的那些帖子，**[例如 1](https://stackoverflow.com/questions/11141507/how-to-generate-a-range-of-dates-in-sql-server)，[例如 2](https://stackoverflow.com/questions/11337905/selecting-non-existent-data-with-mysql/11338539#11338539)，[例如 3](https://stackoverflow.com/questions/271595/getting-dates-between-a-range-of-dates?rq=1)**用 a`static date`或使用 CTE 显示。我正在寻找一个**没有** `storedprocedures/functions`...的解决方案

**这有效：**

```
SELECT DATE(DATE_ADD('2012-01-12', 
INTERVAL @i:=@i+30 DAY) ) AS dateO
FROM members, (SELECT @i:=0) r
where @i < DATEDIFF(now(), date '2012-01-12') 
; 
```

**这些不会：**

```
SELECT DATE_ADD(date '2012-01-12', 
INTERVAL @j:=@j+30 DAY) AS dateO, @j
FROM `members`, (SELECT @j:=0) s
where @j <= DATEDIFF(now(), date '2012-01-12') 
and mmid = 100
;

SELECT DATE_ADD(stdate, 
INTERVAL @k:=@k+30 DAY) AS dateO, @k
FROM `members`, (SELECT @k:=0) t
where @k <= DATEDIFF(now(), stdate)
and mmid = 100
; 
```

*   [SQLFIDDLE 参考](http://sqlfiddle.com/#!2/15dcb/24)

**预期成绩：**

与第一个查询结果相同，因为它开始生成带有`stDate`of 的日期`mmid=100`。

最好这样，`ANSI SQL`它可以[按此查询得到支持，并获得 14](https://stackoverflow.com/questions/418318/generate-a-range-of-dates-using-sql)`MYSQL, SQL Server/MS Access SQL`票[`Oracle`并`trunc`具有`rownum`](https://stackoverflow.com/questions/418318/generate-a-range-of-dates-using-sql)`PostGres`功能`generatge_Series`。**我想知道这是*错误*还是*限制*`MYSQL`？**

* * *

PS：我之前也问过类似的问题。它是基于`static date values`where 是基于一个基于条件的表列中的日期值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T23:43:02.047

确保跨平台兼容性的最简单方法是使用日历表。以最简单的形式

```
create table calendar (
  cal_date date primary key
);

insert into calendar values
('2013-01-01'),
('2013-01-02'); -- etc. 
```

有很多方法可以生成插入日期。

不是使用 WHERE 子句来*生成*行，而是使用 WHERE 子句来选择行。要选择今年 10 月，只需

```
select cal_date
from calendar
where cal_date between '2013-10-01' and '2013-10-31'; 
```

它相当紧凑——365,000 行涵盖 1000 年。这应该涵盖大多数业务场景。

如果您需要跨平台的日期算术，您可以添加一个计数列。

```
drop table calendar;
create table calendar (
  cal_date date primary key,
  tally integer not null unique check (tally > 0)
);

insert into calendar values ('2012-01-01', 1); -- etc. 
```

要选择以 30 天为间隔的所有日期，从 2012 年 1 月 12 日开始，到日历年年底结束，请使用

```
select cal_date
from calendar
where ((tally - (select tally
                 from calendar
                 where cal_date = '2012-01-12')) % 30 ) = 0;

cal_date
--
2012-01-12
2012-02-11
2012-03-12
2012-04-11
2012-05-11
2012-06-10
2012-07-10
2012-08-09
2012-09-08
2012-10-08
2012-11-07
2012-12-07 
```

如果您的“mmid”列保证没有间隙——日历表的一个不言而喻的要求——你可以使用“mmid”列代替我的“tally”列。

# android - achartengine 准备好实时绘图了吗？

> ID：14187716
> 
> 赞同：9
> 
> 时间：2013-01-06T22:57:31.530
> 
> 标签：android, achartengine

我正在尝试绘制一些实时数据，这里的“实时”意味着 < 10 毫秒的数据，理想情况下尽可能低。我已经能够让 Android 如此快速地获取和处理数据，但 ACE 看起来并不是为实时使用而设计的。第一个症状是垃圾收集器像没有明天一样启动并完全杀死应用程序。我正在以“滑动窗口”方式可视化数据，因此我并不期望 ACE 实时绘制千分之几的点。我已经看过它，并且 XYChart 的 onDraw 在看起来很方便并且可能使代码更具可读性但并不是真正需要的情况下肯定会分配非常多的。这甚至可能比以前更糟，所以它可能还没有被注意到。

`return mXY.subMap(start, stop);`

为了：

`return new TreeMap<Double, Double>(mXY.subMap(start, stop));`

这会创建巨大的分配（尽管仍然由原始 subMap 支持），当 onDraw 正在进行时将更新排队并稍后在原子更新或该行上的某些东西上处理它们可能会更好，以避免并发问题。

真正的**遗憾**是**ACE 的速度确实足够满足我的需要**。它可以完美地在我的硬件上完成我需要的工作，但是由于它在重绘上分配了如此多的资源，因此 Android 对 GC 感到很疯狂。它很快就会在 GC 运行时开始分配，所以它必须等待，我的应用程序开始看起来像定格动画电影。

但真正的问题是：期望能够使用 ACE 实时（低于 200 毫秒的刷新率）重新绘制 4 或 6 个折线图（平板电脑应用程序）是否合理，或者它根本没有为这种滥用做好准备？如果答案是否定的。您还有其他选择吗？

**编辑 20130109：** 修订版 471 对小型数据集进行了相当大的改进。2.000 点 / 4 个图表 / 100 毫秒刷新率是可行且流畅的。日志仍然会疯狂地看到“GC_CONCURRENT freed”（大约 10/秒），但没有“WAIT_FOR_CONCURRENT_GC blocked”，这是让您的应用停止运动的表现。在 3.000 点/1 个图表/100 毫秒时，它显然**不**平滑。我们再次在 logcat 和口吃应用程序上遇到“WAIT_FOR_CONCURRENT_GC 被阻止”的雪崩。再次看起来我们没有速度问题，只有内存管理问题。

*看起来我可能会要求 ACE 变魔术，但在重构所有代码以检索和存储 1KHz 的遥测数据后，我碰上了这堵墙。一旦我终于看到我的应用程序在完全不触发 GC 的情况下实时检索和存储所有这些内容，我在尝试绘制图表时用 ACE 拉扯我的头发:)*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-08T11:23:37.720

首先感谢您提出的好问题和您提出的观点。对于在该方法下完成的巨大内存分配，您绝对是正确的`onDraw()`。我修复了这个问题并签入了 SVN 中的代码。我还在方法中添加了一个同步块，例如在重绘期间向数据集添加新数据时`onDraw()`希望它不会抛出。`ConcurrentModificationException`

请从 SVN 签出代码并执行 ant dist 以构建新的 AChartEngine jar 文件并将其嵌入到您的应用程序中。请[在此处](http://code.google.com/p/achartengine/source/checkout)查看说明。

回答您的问题：AChartEngine 绝对可以用于动态图表。您报告的问题是一个阻碍，但现在应该修复它。我已经使用它编写了动态图表。但是，您需要确保不会向数据集添加 100000 个数据值。可以从数据集中删除旧数据以获得性能。

如果它们有多达几千个点，绘制 5 个左右的折线图绝对是合理的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-24T12:52:48.383

好的，所以在寻找另一个图形库一段时间后，我发现没有什么足够好的 :) 这让我再次研究 ACE，最后我做了一个小补丁，虽然远非理想，但它使它对我“可用”。

在 XYSeries.java 我添加了一个新方法：

```
/**
* Removes the first value from the series.
* Useful for sliding, realtime graphs where a standard remove takes up too much time.
* It assumes data is sorted on the key value (X component).
*/
public synchronized void removeFirst() {
  mXY.removeByIndex(0);
  mMinX = mXY.getXByIndex(0);
} 
```

我发现除了内存问题之外，还有一些高速帧速率下的实际速度问题。我在删除功能上花费了大约 90% 的时间，因为我删除了滚动到视野之外的点。原因是当您删除一个 min|max 点时，ACE 调用 InitRange 迭代每个点以重新计算它在内部使用的那些 min/max 点。由于我每秒处理 1000 个遥测帧并且视口很小（由 ACE 内存分配策略强制），因此我经常在删除功能上达到最小/最大点。我创建了一种新方法，用于删除系列的第一个点，通常在您添加一个使该点滚动出视口的点后立即调用该方法。如果您的点按键值排序（经典的 dateTime 系列），那么我们可以调整 mminX，这样视口仍然看起来不错并且做得非常快。我们不能使用当前的 ACE 实现快速更新 minY 或 maxY（虽然我没有研究过），但是如果您设置了适当的初始范围，则可能不需要它。事实上，我不时使用我拥有的额外信息手动调整范围，因为我知道我在绘制什么以及不同时间点的正常范围是多少。

因此，这对其他人来说可能已经足够了，但我坚持认为，对于任何严肃的实时图形，ACE 上仍然需要内存分配重构。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T22:18:36.870

经过大力优化我的应用程序上的其他所有内容后，我仍然无法让它以我所理解的“实时”绘图。该库很棒，而且速度非常快，但是每个 onDraw 分配内存的方式不可避免地会触发大量垃圾收集，这会与其自己的分配发生冲突，因此 android 会暂时冻结您的应用程序，从而导致与“实时”图形完全不兼容的卡顿。这里的“口吃”可以在 50-250 毫秒（是毫秒）之间，但这足以杀死一个实时应用程序。

只要您不要求它们是“实时的”（10 帧/秒，（<100ms 刷新率）或您所谓的“平滑”），AChartengine 将允许您创建“动态”图表。

如果有人需要更多关于核心问题的信息，或者为什么我说库足够快但内存分配模式最终导致性能问题，请查看[Google I/O 2009 - Writing Real-Time Games for Android](http://www.youtube.com/watch?v=U4Bk5rmIpic "Google I/O 2009 - 为 Android 编写实时游戏")

# css - 在 Twitter 引导程序中更改悬停样式？

> ID：14187718
> 
> 赞同：0
> 
> 时间：2013-01-06T22:57:45.420
> 
> 标签：css, twitter-bootstrap, hover

我有一个用于关注按钮的纯 CSS（显示）解决方案：

```
<span class="follow-status following">
    <a href="#" class="btn btn-follow" data-user-id="123">
        <span class="following-text"><i class="icon-ok"></i> Following</span>
        <span class="follow-text"><i class="icon-plus"></i> Follow</span>
        <span class="unfollow-text"><i class="icon-remove"></i> Unfollow</span>
    </a>
</span> 
```

例如，我想根据显示的内容更改悬停时的文本。然而，a 元素有填充，并且样式化 span 看起来真的很尴尬。- 我应该覆盖 A 填充并将其转移到跨度中吗？- 我应该以不同的方式编写 HTML 吗？- 我应该只通过 JS 切换适用的文本/样式吗？- 别的？

您可以看到外部跨度具有“以下”类

```
.follow-status span { display:none }
.following .following-text { display: block}
.following:hover .following-text { display: none}
.following:hover .unfollow-text { display: block} 
```

您将如何在 twitter 引导程序范围内实现这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T23:46:05.190

就个人而言，我会从锚点内的跨度中删除所有填充/边距，并将您的 CSS 填充/边距等应用于锚点元素。这样你就可以在未来证明自己，以防你想在锚元素中添加不同的元素。

# visual-studio-2008 - 错误 C2057 与 HANDLE

> ID：14187720
> 
> 赞同：0
> 
> 时间：2013-01-06T22:57:58.727
> 
> 标签：visual-studio-2008

我尝试用 ms visual c++ 2008 编译[flushmem.cpp](http://chadaustin.me/download/flushmem.cpp)，但得到错误：.\flushmem.cpp(69) : error C2057: expected constant expression at line: HANDLE processes[processCount]; 和警告： .\flushmem.cpp(63) : 警告 C4244: 'initializing' : 从 'unsigned __int64' 转换为 'unsigned int'，可能会丢失行中的数据： unsigned processCount = (totalPageFile +approximateProcessConsumption - 1) /近似过程消耗；

怎么解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T23:37:20.730

Visual Studio 2008 编译器不支持将变量作为自动数组的大小。在行中：

```
 HANDLE processes[processCount]; 
```

**processCount**是一个变量，编译器只接受一个常量。您将需要一个符合 C99 的编译器，或者您需要更改上面的代码行来分配数组。例如：

```
HANDLE* processes = new HANDLE[processCount]; 
```

如果您分配数组，您还需要在完成后将其删除：

```
delete [] processes; 
```

# c# - 在 IE 扩展中显示本地图标

> ID：14187723
> 
> 赞同：3
> 
> 时间：2013-01-06T22:58:36.850
> 
> 标签：c#, internet-explorer, plugins, https, bho

我已阅读以下[文章](http://social.msdn.microsoft.com/forums/en-US/ieextensiondevelopment/thread/84f96fa0-8b72-4293-97b4-1b497adbee6a/)。我正在尝试使用 BHO 扩展嵌入图标。但是， res:// 协议在 HTTPS 站点中不起作用。是否有解决方法或替代方法可以在 HTTPS 站点中显示本地图像？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T23:17:01.840

回答我自己的问题...

可以将图像嵌入为 BASE64 字符串。例如，

```
myImg.setAttribute('src', "data:image/png;base64,iVBORw0KG........"); 
```

这样，您就不需要使用 res:// 协议。您可以在运行时以 BASE64 对图像进行编码（例如，在加载扩展时）或提前对其进行编码（如本例中）。最重要的是，这也适用于 HTTPS。

# iphone - Dev、AdHoc 和 App Store 构建的不同设置

> ID：14187741
> 
> 赞同：3
> 
> 时间：2013-01-06T23:01:31.483
> 
> 标签：iphone, ios, xcode, app-store

我想为我的开发、临时和应用商店版本起不同的名称。

目前，我只能使用[Chris Miles 的博客文章](http://blog.chrismiles.info/2011/04/ios-dev-beta-production-builds.html)为 Dev 和 AdHoc/AppStore 构建设置不同的设置。

但由于 Adhoc 和 App Store 构建都使用这些`Archive`设置，我找不到区分它们的方法。是否可以？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T01:05:44.047

您可以做的是设置两个目标，一个用于 adhoc，一个用于应用商店。然后，您可以在 Build Settings 部分中为每个自定义构建设置。

# jquery - 添加类上的 addClass() 之后的 JQuery 函数

> ID：14187744
> 
> 赞同：1
> 
> 时间：2013-01-06T23:01:42.440
> 
> 标签：jquery, addclass

```
$('#closecallout').click(function() {
    $('.callout').animate({"right" : "-260px"}, 500).addClass('calloutclosed');
});
$('.calloutclosed').hover(function() {
    $(this).animate({"right" : "0px"}, 500);
}, function() {
    $(this).animate({"right" : "-260px"}, 500);
}); 
```

单击功能旨在“隐藏”标注框，然后，当悬停时，它将重新回到焦点。

为什么悬停功能不起作用？是因为它们都在一个`jQuery(function($){ });`?

我应该采取什么措施来纠正这个问题？

[http://jsfiddle.net/R5Dmu/](http://jsfiddle.net/R5Dmu/)

非常感谢所以

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-06T23:07:14.227

要根据元素的当前类触发事件，您需要将事件委托与[`.on()`](http://api.jquery.com/on/).

```
$('#closecallout').click(function() {
    $('.callout').animate({"right" : "-260px"}, 500).addClass('calloutclosed');
});
$(document).on('mouseover', '.calloutclosed', function() {
    $(this).animate({"right" : "0px"}, 500);
}).on('mouseout', '.calloutclosed', function() {
    $(this).animate({"right" : "-260px"}, 500);
}); 
```

[**演示**](http://jsfiddle.net/R5Dmu/1/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-06T23:07:35.977

当您调用点击功能时，您需要添加类并实现悬停功能。在您的代码中，您在单击事件上添加了类，但未实现悬停功能。您在准备好的文档上实现悬停功能，然后 Jquery 可以找到带有 calloutclosed 类的选择器，因为还没有点击事件。

检查这个：

```
jQuery(function ($) {

//CALLOUT
$('#closecallout').click(function () {
    $('.callout').animate({
        "right": "-260px"
    }, 500)
    $('.callout').addClass('calloutclosed');

    $('.calloutclosed').hover(function () {
        $(this).animate({
            "right": "0px"
        }, 500);
    }, function () {
        $(this).animate({
            "right": "-260px"
        }, 500);
    });

});
}); 
```

# jquery - 接收用户输入文本字段的数据

> ID：14187747
> 
> 赞同：0
> 
> 时间：2013-01-06T23:01:44.190
> 
> 标签：jquery

标记

```
<div id="tool_wrapper">
Tip: <input class="input_mod" id="tip_tip" type="text"/>
Text: <input class="input_mod" id="text_tip" type="text" />
<input type="submit" class="modbutton" id="sub_tip" />
</div> 
```

jQuery

```
$(function(){
  var a = $('#tip_tip').text();
  var b = $('#text_tip').val();
  var text = $('#text_editor_textarea');
$('#sub_tip').click(function(e){
   e.preventDefault();
     text.val(text.val()+'[mod=' + a + ']' + b + '[/mod]');
  });
}); 
```

好的，所以在 jQuery 上面`var a` `var b`一个是`.text();`，另一个是`.val()`我知道我想声明我已经尝试了这两个然后我也尝试了这个

```
$(function(){
  var a = $('#tip_tip').val(function(){
       $(this).text()
});
  var b = $('#text_tip').val(function(){
       $(this).text()
});
  var text = $('#text_editor_textarea');
$('#sub_tip').click(function(e){
   e.preventDefault();
     text.val(text.val()+'[mod=' + a + ']' + b + '[/mod]');
  });
}); 
```

尽管渲染的标记看起来像这样，但它让我比第一个 jQuery 走得更远

`[mod=[object Object]][object Object][/mod]`

这当然不是我想要的。有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T23:07:28.927

你可以试试这个

```
$(function(){
var text = $('#text_editor_textarea');
$('#sub_tip').click(function(e){
    e.preventDefault();
    var a = $('#tip_tip').val();
    var b = $('#text_tip').val();
    text.val(text.val()+'[mod=' + a + ']' + b + '[/mod]');
  });
}); 
```

[**演示**](http://jsfiddle.net/h6HFc/)。

# c# - 如何从 c# 更改 selenium WebDriver 优先级？

> ID：14187748
> 
> 赞同：0
> 
> 时间：2013-01-06T23:01:48.627
> 
> 标签：c#, selenium, selenium-firefoxdriver

我试图让我的测试在专用服务器上运行得更快。我注意到，通常测试运行缓慢，但是当我增加 firefox 优先级（默认情况下低于正常）时，它们运行得更快。

我正在寻找一种`FirefoxDriver`可以让我选择进程优先级的设置，但我找不到。

谁能指出我如何在硒中设置网络驱动程序优先级？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T10:24:18.673

我不同意你这样做的原因，我认为简单地改变优先级*并不是*解决问题的方法。

没有公开的 API 可以执行此操作，因此您可以为此向 Selenium 开发人员发送请求 ( [http://code.google.com/selenium](http://code.google.com/selenium) )。

因此，您必须在Selenium 创建浏览器会话**后更改优先级进程。**

您将需要找到该过程：

```
var fireFoxProcesses = Process.GetProcessesByName("firefox"); 
```

这将返回一组`Process`对象，但是，如果您正在运行一个又一个测试，则应该只`firefox.exe`打开一个进程。这是我的假设。因此，我们得到了实际的进程对象：

```
// should only be one, unless you are opening a few tests in concurrently.
var actualFirefoxProcess = fireFoxProcesses.First(); 
```

最后，更改它的优先级：

```
actualFirefoxProcess.PriorityClass = ProcessPriorityClass.High; 
```

我想这可能会有点不可靠。

**编辑**

至于“用户创建的”Firefox 和由 Selenium 运行的 Firefox 的区别，您可以查看 firefox 进程的父进程。也就是说，是什么进程启动了 Firefox 进程？

复制代码没有意义，但这个解决方案对我来说效果很好：[如何获取应用程序父进程的 PID](https://stackoverflow.com/questions/2531837/how-can-i-get-the-pid-of-the-parent-process-of-my-application) ...这会变得很棘手，因为用户可以通过多种方式启动 Firefox，但如果他们使用的是快捷方式/start 菜单列表项，父进程将是**explorer**。

您没有提到您用于运行测试的解决方案。无论是通过 Visual Studio 的 Test Runner、NUnit 自己的 GUI、TeamCity、CruiseControl、Jenkins、TFS 还是其他一些 CI 解决方案，但您需要检查启动 Firefox 进程的原因，以确定它是否是“用户创建的”Firefox实例或来自 Selenium 测试的一个。

# java - 未调用 Android 函数

> ID：14187751
> 
> 赞同：0
> 
> 时间：2013-01-06T23:02:17.113
> 
> 标签：java, android, function

我的片段中的这个函数被另一个在单击按钮时调用的函数调用。`getGridVals()`一开始在我的`calculate()`函数中调用，但没有像应有的那样在`Log`from中输出任何内容。 只有被输出 但是，在我的函数中，值被输出。`getGridVals()`
`Log.v("test", "HI");``calculate()``Log`

```
public void calculate(){ 
    int[][] pegs = new int[3][3];
    getGridVals();// this is not working

////////This loop isnt working either for some reason, its just not even outputting anything
    for(int i=1;i<9;i++)
        Log.e("etC", etCollectionB[i]);

    int k=0;
    for(int i=0;i<3;i++)
        for(int j=0;j<3;j++)
        {
            if(etCollectionB[k].equals(""))
                pegs[i][j] = 0;
            else
                pegs[i][j] = Integer.valueOf(etCollectionB[k]);
            Log.e("Value", String.valueOf(pegs[i][j]));
            k++;
        }

} 
```

* * *

```
 public boolean getGridVals(){

        for(int i=1;i<9;i++)
        {
            EditText tempText1 = new EditText(mContext);
            tempText1.setText((CharSequence) mGrid.getItemAtPosition(i));
                    //this doesn't output
            Log.v("temp text ", tempText1.getText().toString());
                    //this outputs 
                    Log.v("test", "HI");

        }

        //this too doesnt output
        Log.d("et collection 1", String.valueOf(etCollectionB[1]));
        for(int i=0;i<9;i++)
        {
            etCollectionB[i] = (String) mGrid.getItemAtPosition(i);
            Log.e("etCollectionB", etCollectionB[i]);

        }
            return true;
        //return false;
        //return etCollectionB;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T01:50:57.430

哦，哇，我想通了。这是一个愚蠢的错误。这是因为没有从中检索到任何内容，`tempText1.getText().toString(),`所以日志甚至没有出现，因为没有任何内容可以输出。谢谢大家。

# java - 是什么阻止了 android 应用程序外部与带有身份验证的应用程序引擎的通信？

> ID：14187757
> 
> 赞同：1
> 
> 时间：2013-01-06T23:03:36.160
> 
> 标签：java, android, google-app-engine

如果这是重复的，对不起，我试着看

我在 google 上阅读了有关应用程序引擎身份验证选项的文档

如果我在 android 和 gae 之间只使用简单的 POST 'protocol'，

我显然可以验证我的 POST 以确保它们来自“帐户持有人”

但是是什么阻止了有人在我的应用程序之外注册、登录或发送帖子？

我的 android 应用程序中是否有一些种子/签名“说”，“嘿，这是专门来自我的 android 应用程序的通信”？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T05:25:13.823

没有真正的方法可以阻止某人冒充您的客户，您可以想到的几乎所有数字方法都可以复制到其他数字设备上。

您需要问自己的问题是，您为什么关心客户不是“真正的”客户。

# java - 其他类中的 Spring 和 Hibernate 注入

> ID：14187762
> 
> 赞同：0
> 
> 时间：2013-01-06T23:04:05.740
> 
> 标签：java, spring, hibernate, spring-mvc

我是新学科

我有配置

并尝试注入它

```
@Controller 
public class HelloController {
    @Autowired
    HibernateTemplate hibernateTemplate;

    @RequestMapping(value = "/hello.htm", method = RequestMethod.GET)  
    public @ResponseBody String save() throws Exception {
       hibernateTemplate.save(new Some(Long.valueOf("33"), Integer.valueOf("1"), Double.valueOf("1"), Short.valueOf("0")));    
    }
} 
```

这行得通。

但是如果我尝试在其他类中使用 @Autowired 我有 NPE 示例

```
public class SomeFacade extends AbstractFacade<Some> {

    @Autowired
    HibernateTemplate hibernateTemplate;

    @Override
    public HibernateTemplate getHibernateTemplate() {
        return hibernateTemplate;
    }

} 
```

并将其用于

```
@Controller 
public class HelloController {

    @RequestMapping(value = "/hello.htm", method = RequestMethod.GET)  
    public @ResponseBody String save() throws Exception {
        SomeFacade df = new SomeFacade();
        HibernateTemplate ht = df.getHibernateTemplate();
    }
} 
```

我有“ht”是空的

我不知道该代码中发生了什么以及为什么它不起作用，我认为这是因为我的类没有在 xml 文件中注册。请帮助这个例子。谢谢你！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T00:23:00.430

就像@GreybeardedGeek 说它需要是一个Spring bean。您可以将 @Component 注释添加到您的类中，以便由 spring 管理：

```
@Component
public class SomeFacade extends AbstractFacade<Some> {

    @Autowired
    HibernateTemplate hibernateTemplate;

    @Override
    public HibernateTemplate getHibernateTemplate() {
        return hibernateTemplate;
    }

} 
```

不要忘记在您的 xml 文件（根上下文）中添加组件扫描，如果它不存在的话：

```
<context:component-scan base-package="your.package" /> 
```

如果您使用此解决方案，请注入组件而不是使用 new 关键字：

```
@Controller 
public class HelloController {

    @Autowired
    private SomeFacade df;

    @RequestMapping(value = "/hello.htm", method = RequestMethod.GET)  
    public @ResponseBody String save() throws Exception {
        HibernateTemplate ht = df.getHibernateTemplate();
    }
} 
```

# sql - Oracle 返回行 - Crystal 报表不返回

> ID：14187764
> 
> 赞同：0
> 
> 时间：2013-01-06T23:04:16.820
> 
> 标签：sql, crystal-reports, oracle11g

我有一个我在 Oracle 中创建的视图。它返回行，但是当我通过 Crystal Reports 使用它时，我没有得到任何行。我在视图后面的查询中将其缩小到这个 CTE：

```
WITH PERIODS AS (
  SELECT
    ROWNUM-13 RN,
    TO_DATE('01-JUL-' || TO_CHAR(ADD_MONTHS(TRUNC(SYSDATE),-6), 'YYYY')) AS FISCAL_YEAR_START,
    ADD_MONTHS(TO_DATE('01-JUL-' || TO_CHAR(ADD_MONTHS(TRUNC(SYSDATE),-6), 'YYYY')), ROWNUM-13) AS MONTH
  FROM
    DUAL
  CONNECT BY
    ROWNUM <= 24
) 
```

这很奇怪，好像我用以下内容替换了这个 CTE，它可以工作（第二个查询是原始报告的内容，但由于查找财政年度的逻辑问题，它必须更改）。

```
WITH PERIODS AS (
  SELECT
    ROWNUM-13 RN,
    ADD_MONTHS(TRUNC(sysdate,'yyyy'),6) AS FISCAL_YEAR_START,
    TRUNC(ADD_MONTHS(ADD_MONTHS(TRUNC(sysdate,'yyyy'),6), ROWNUM-13),'MONTH') MONTH
  FROM
    DUAL
  CONNECT BY
    ROWNUM <= 24
) 
```

知道为什么第二个 CTE 会导致 Crystal 报告不提取任何记录吗？两个查询肯定都返回了行，只是 Crystal Reports 不喜欢第一个查询（尽管我不明白为什么，因为我认为 Crystal 会简单地向 Oracle 查询数据，而不会被后面的内容所困扰风景？！）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T23:33:29.373

不知道为什么，但我将 CTE 更改为以下内容并且它有效：

```
 SELECT
    ROWNUM-13 RN,
    ADD_MONTHS(TRUNC(ADD_MONTHS(SYSDATE,6),'YYYY'),-6) AS FISCAL_YEAR_START,
    ADD_MONTHS(ADD_MONTHS(TRUNC(ADD_MONTHS(SYSDATE,6),'YYYY'),-6), ROWNUM-13) MONTH
  FROM
    DUAL
  CONNECT BY
    ROWNUM <= 24 
```

我仍然很想知道为什么视图后面的查询会影响 Crystal Reports！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-08T06:01:48.847

在您的第一个查询中，这一行：-

```
TO_DATE('01-JUL-' || TO_CHAR(ADD_MONTHS(TRUNC(SYSDATE),-6), 'YYYY')) AS FISCAL_YEAR_START 
```

将简化为：-

```
TO_DATE('01-JUL-2012') 
```

Oracle 将使用默认日期格式进行转换。

当您通过 Crystal Reports 连接时，可能设置不同。更好的做法是通过向 TO_DATE 提供第二个参数来显式设置日期格式。

Crystal Reports 是否报告了 ORA 错误，例如`ORA-01861: literal does not match format string`？

# javascript - 执行自定义函数 onChange

> ID：14187766
> 
> 赞同：0
> 
> 时间：2013-01-06T23:04:32.667
> 
> 标签：javascript, html, dom

**纯 JavaScript。**

我在 HTML 页面中有一个复选框。我要执行

```
App.setCheckedProperty(name, val); 
```

`name`复选框的名称属性在哪里，`val`真/假表示选中。

如何实施？我在网上找不到任何关于它的材料。

**更新**：

```
<input type="checkbox" name="smth" onChange="<WHAT TO DO HERE?>" checked /> 
```

最终执行必须相等：

```
App.setCheckedProperty("smth", false); 
```

**UPD2**：

`this.name`是否有类似`this.checked`JavaScript 的结构？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T23:21:27.217

你不应该在你的 html 中“内联”。这只是不好的做法。我想你想要做的是循环几个复选框？

看到这段代码：

```
// declare all vars that you need and find all input-elements
var i, input, inputs = document.getElementsByTagName('input');

// loop over all input-elements
for(i = 0; i <= inputs.length; i++) {
  input = inputs[i];

  // if the current element is a checkbox
  if(input.type === 'checkbox') {

    //append a click-handler to that checkbox
    input.onclick = function () {

      // if the checkbox is clicked, you can find the name and the checked-property
      App.setCheckedProperty(this.name, this.checked);
    };   
  }
} 
```

和一个工作示例（我只是提醒而不是 App.setCheckedProperty）：http: [//jsfiddle.net/5wExJ/](http://jsfiddle.net/5wExJ/)

# javascript - 在 div 外部单击时如何创建取消选择的功能

> ID：14187774
> 
> 赞同：1
> 
> 时间：2013-01-06T23:05:21.763
> 
> 标签：javascript, function, select, html, click

我有一个双击时选择 div 的功能，问题是我之后无法取消选择它，这是脚本 CSS：

```
 div.editable
    {
        border: solid 2px Transparent;
        padding-left: 15px;
        padding-right: 15px;
    }

    div.editable:hover
    {
        border-color: black;
    }

</style> 
```

脚本：

```
 // Uncomment the following code to test the "Timeout Loading Method".
    // CKEDITOR.loadFullCoreTimeout = 5;

    window.onload = function() {
        // Listen to the double click event.
        if ( window.addEventListener )
            document.body.addEventListener( 'dblclick', onDoubleClick, false );
        else if ( window.attachEvent )
            document.body.attachEvent( 'ondblclick', onDoubleClick );

    };

    function onDoubleClick( ev ) {
        // Get the element which fired the event. This is not necessarily the
        // element to which the event has been attached.
        var element = ev.target || ev.srcElement;

        // Find out the div that holds this element.
        var name;

        do {
            element = element.parentNode;
        }
        while ( element && ( name = element.nodeName.toLowerCase() ) &&
            ( name != 'div' || element.className.indexOf( 'editable' ) == -1 ) && name != 'body' );

        if ( name == 'div' && element.className.indexOf( 'editable' ) != -1 )
            replaceDiv( element );
    }

    var editor;

    function replaceDiv( div ) {
        if ( editor )
            editor.destroy();

        editor = CKEDITOR.replace( div );
    }

</script> 
```

分区：

```
<div class="editable" style="height:490px;overflow:auto;" id="text2">
<p>Click Here to edit</p>";
</div> 
```

我想要实现的是当我单击外部或单击另一个对象或按钮时，div 将自动取消选择。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T23:11:09.880

与您已经处理双击的方式相同：

```
// Listen to the click event.
if ( window.addEventListener )
  document.body.addEventListener( 'click', yourCallback, false );
else if ( window.attachEvent )
  document.body.attachEvent( 'click', yourCallback ); 
```

此事件将触发，直到另一个单击处理程序附加到 的子元素`body`。在`yourCallback`您可以结束编辑模式。

# java - 切换图例可见性时 TChart 崩溃？

> ID：14187775
> 
> 赞同：0
> 
> 时间：2013-01-06T23:05:24.163
> 
> 标签：java, android, teechart

当我在不同`TChart`系列之间切换时，如果在运行之间切换图例可见性，则会出现异常。例如

1.  显示条形图。图例可见。
2.  显示饼图。传说无形。
3.  显示条形图。图例可见。
4.  碰撞！

这是重新绘制控件时导致未捕获异常的行：

```
chart.getLegend().setVisible(true); 
```

在每次运行之间，我执行以下操作：

```
chart.setAutoRepaint(false);
chart.removeAllSeries();
// Build chart...
chart.setAutoRepaint(true);
chart.refreshControl(); 
```

`TChart`专家们，我怎样才能避免这种崩溃？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T13:37:49.503

这对我来说并不崩溃。我可以多次从 Bar 切换到 Pie 没有问题。

```
package com.steema.test;

import android.app.Activity;
import android.os.Bundle;
import android.view.View;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemSelectedListener;
import android.widget.ArrayAdapter;
import android.widget.LinearLayout;
import android.widget.Spinner;

import com.steema.teechart.TChart;
import com.steema.teechart.styles.Bar;
import com.steema.teechart.styles.Pie;
import com.steema.teechart.themes.ThemesList;

public class AndroidTestActivity extends Activity implements OnItemSelectedListener{

    private TChart tChart1;

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        LinearLayout group = (LinearLayout) findViewById(R.id.linearLayoutTchart);

        tChart1 = new TChart(this);
        group.addView(tChart1);
        ThemesList.applyTheme(tChart1.getChart(), 1);

        Spinner spinner = (Spinner) findViewById(R.id.series_spinner);
        ArrayAdapter<CharSequence> adapter = ArrayAdapter.createFromResource(this, R.array.series_array, android.R.layout.simple_spinner_item);
        adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
        spinner.setAdapter(adapter);
        spinner.setOnItemSelectedListener(this);
    }

    @Override
    public void onItemSelected(AdapterView<?> arg0, View arg1, int arg2, long arg3) {
        tChart1.setAutoRepaint(false);
        tChart1.removeAllSeries();
        switch (arg2) {
        case 0:
            Bar bar1 = new Bar(tChart1.getChart());
            bar1.fillSampleValues();
            tChart1.getLegend().setVisible(true);
            break;
        case 1:
            Pie pie1 = new Pie(tChart1.getChart());
            pie1.fillSampleValues();
            tChart1.getLegend().setVisible(false);
            break;
        }
        tChart1.setAutoRepaint(true);
        tChart1.refreshControl();
    }

    @Override
    public void onNothingSelected(AdapterView<?> arg0) {

    }
} 
```

这是我的 main.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent">
    <TextView  
        android:layout_width="fill_parent" 
        android:layout_height="wrap_content" 
        android:text="@string/hello"/>
    <Spinner android:id="@+id/series_spinner"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content" />
    <LinearLayout android:id="@+id/linearLayoutTchart" 
        android:layout_width="fill_parent" 
        android:layout_height="wrap_content"/>
</LinearLayout> 
```

这里是我的strings.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<resources>
    <string name="hello">TeeChartJava for Android testing application!</string>
    <string name="app_name">AndroidTest</string>
    <string-array name="series_array">
        <item>Bar</item>
        <item>Pie</item>
    </string-array>
</resources> 
```

* * *

**更新1：** 如果我在`tChart1.getLegend().setSeries(tChart1.getSeries(0));`上面添加他`case 1`：

```
 case 1:
        Pie pie1 = new Pie(tChart1.getChart());
        pie1.fillSampleValues();
        tChart1.getLegend().setSeries(tChart1.getSeries(0));
        tChart1.getLegend().setVisible(false);
        break; 
```

然后我在选择回 Bar 系列时收到一条错误消息。这是因为我们已将图例设置为使用饼系列（我们第一次选择饼图），当我们选择条形图时我们已删除该饼图系列，但图例仍引用已删除的饼图系列。请检查您是否为图例设置了有效的系列。IE：

```
 case 0:
        Bar bar1 = new Bar(tChart1.getChart());
        bar1.fillSampleValues();
        tChart1.getLegend().setSeries(tChart1.getSeries(0));
        tChart1.getLegend().setVisible(true);
        break;
    case 1:
        Pie pie1 = new Pie(tChart1.getChart());
        pie1.fillSampleValues();
        tChart1.getLegend().setSeries(tChart1.getSeries(0));
        tChart1.getLegend().setVisible(false);
        break; 
```

清除系列列表后将设置`getLegend().setSeries(null)`下一个版本。`removeAllSeries()`

# android - 动态更改列表视图适配器中的数据

> ID：14187778
> 
> 赞同：0
> 
> 时间：2013-01-06T23:05:48.107
> 
> 标签：android, android-listview, baseadapter

我有一个列表视图，它有一个自定义适配器，其中每一行左侧都有一个文本视图，右侧有一个编辑文本，用户可以使用它来修改条目值。

默认情况下，放置在每个视图内的 EditText 视图中的值是从传递给适配器的字符串数组中获取的。

我想知道如何允许用户编辑这些值并将结果保存回同一个字符串数组中。

我尝试添加一个文本更改侦听器，因此当用户编辑该值时，新字符串将放置在原始字符串数组中的适当位置。这样做的问题是，当用户滚动时，文本更改侦听器被激活，并且数组中的值被空白字符串覆盖。

这是一些代码：

```
public EditTagsListViewAdapter(Context context, String[] objectKeys, String[] objectValues) {
        super();
        this.context = context;
        this.objectKeys = objectKeys;
        this.objectValues = objectValues;
    }

    @Override
    public int getCount() {
        return objectKeys.length;
    }

    @Override
    public String[] getItem(int position) {
        String[] item = new String[2];
        item[0] = objectKeys[position];
        item[1] = objectValues[position];
        return item;
    }

    @Override
    public long getItemId(int position) {
        return position;
    }

    @Override
    public View getView(final int position, View convertView, ViewGroup parent) {
        ViewHolder holder = null;

        LayoutInflater mInflater = (LayoutInflater)context.getSystemService(Activity.LAYOUT_INFLATER_SERVICE);
        if (convertView == null) {
            convertView = mInflater.inflate(R.layout.edit_osm_tag_row, null);
            holder = new ViewHolder();
            holder.key = (TextView) convertView.findViewById(R.id.tagKey);
            holder.value = (EditText) convertView.findViewById(R.id.tagValue);

            convertView.setTag(holder);
        }
        else {
            holder = (ViewHolder) convertView.getTag();
        }

        String[] rowItem = (String[]) getItem(position);

        holder.key.setText(rowItem[0]);
        if(rowItem[1].equals("null")) {
            holder.value.setText("");
        } else {
            holder.value.setText(rowItem[1]);
        }

        holder.value.addTextChangedListener(new TextWatcher() {

            @Override
            public void onTextChanged(CharSequence s, int start, int before, int count) {
                // TODO Auto-generated method stub

            }

            @Override
            public void beforeTextChanged(CharSequence s, int start, int count,
                    int after) {
                // TODO Auto-generated method stub

            }

            @Override
            public void afterTextChanged(Editable s) {
                objectValues[position] = s.toString();
                Log.i(TAG, "Added changes to adapter");

            }
        });

        return convertView;
    }

    static class ViewHolder {
        protected TextView key;
        protected EditText value;
    } 
```

我在之后将一些edittext值设置为空白，`if(rowItem[1].equals("null")) {`因为变量objectValues中的一些值将被设置为字符串“null”，但我希望它们显示为空白。

希望这是有道理的。有谁知道我怎么能做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T23:20:26.270

一般来说，您的数据源不应与您的视图/适配器紧密耦合。这意味着您可以更改该数据源中的数据，而不管您的视图是否正在使用它。当用户想要更改数据时，只需更新您的源（您的数组），然后指示适配器/视图重绘。

某些适配器可能会在您更改其内容时遇到问题，但如果您从头开始实现自己的适配器，或者使用松散耦合的适配器类，您不应该遇到任何问题。

如果您使用的是扩展 BaseAdapter 的适配器，您可以简单地调用 notifyDataSetChanged()，适配器应该会找出其余的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-06T23:13:51.317

当用户在键盘上按“Enter”时，您可以使用 OnEditorActionListener 来保存更改，而不是 TextWatcher。

```
editText.setOnEditorActionListener(new OnEditorActionListener() {
    @Override
    public boolean onEditorAction(TextView v, int actionId, KeyEvent event) {
        if(actionId == EditorInfo.IME_NULL && event.getAction() == KeyEvent.ACTION_DOWN) {
            objectValues[position] = v.getText().toString();
            return true;
        }

        return false;
    }
}); 
```

# asp.net-mvc-3 - 闪光灯播放器或银灯？

> ID：14187782
> 
> 赞同：0
> 
> 时间：2013-01-06T23:06:19.737
> 
> 标签：asp.net-mvc-3

我想创建一个帮助视频并将主题放在我的网站上。我在互联网上进行了一些搜索，以找到最好的方法。使用flash player还是使用微软银光技术来做到这一点？

最适合我的开源视频播放器是什么？

我的网站在 .net4.0 上的 mvc3 razor 上，我的视频是 .wvm 格式当然我可以将主题转换为任何其他格式

请指导我其中哪一个更好并且具有优势而不是其他？

谢谢大家

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T23:10:44.687

我的建议是既不使用，也使用 HTML 5 和[Video](http://www.w3schools.com/html/html5_video.asp)元素。

Flash 和 Silverlight 现在正在成为 Web UI 的弃用技术。

[您可以使用诸如modernizr](http://modernizr.com/)之类的第三方库来检测浏览器功能并做出相应响应。

此[页面](https://github.com/Modernizr/Modernizr/wiki/HTML5-Cross-Browser-Polyfills)包含跨浏览器的 polyfill，请在页面中搜索视频

# c - OpenGL中的位图渲染方法？

> ID：14187783
> 
> 赞同：2
> 
> 时间：2013-01-06T23:06:24.350
> 
> 标签：c, opengl, image-processing, bitmap

我最近一直在用纯 C 语言研究一点位图解析器，只是为了了解更简单图像格式的低级工作原理。到目前为止，使用维基百科关于位图文件的[文章](http://en.wikipedia.org/wiki/.bmp)，我已经能够（至少我认为）正确解析信息 - 至少大部分是这样。

问题是我不太确定从那里做什么：因为我一直在使用 3.1 上下文，所以我可以访问更多现代化的功能，这很好，尽管我仍然迷路了。我有一个带有 GLFW 的窗口设置，到目前为止还没有真正呈现任何东西，因为我一直专注于解析/低级细节。

由于我非常努力地避免查看实际的代码示例，**如果有人可以向我解释渲染位图所涉及的过程是什么，只使用 OpenGL/GLFW 和 ISO C 标准库，那就太棒了。**

虽然我有几个着色器，并且我能够毫无问题地加载它们，但我认为我需要做的是渲染一个符合尺寸（宽度，高度）的[不可见]四边形图像本身，然后将像素数据传递给 OpenGL。然而，主要问题是着色器的设置如下：

**顶点着色器**

```
#version 150
#extension GL_ARB_separate_shader_objects : enable

layout(location = 0) in vec2 Position;
layout(location = 1) in vec2 UV_In;

out vec2 UV;

void main()
{
    gl_Position = vec4( Position, 0.0f, 1.0f );
    UV = UV_In;
} 
```

**片段着色器**

```
#version 150
#extension GL_ARB_separate_shader_objects : enable

in vec2 UV;

out vec3 Output;

uniform sampler2D TheSampler;

void main()
{
    Output = texture2D( TheSampler, UV ).rgb;
} 
```

而且我不确定如何获得着色器所需的实际 UV 坐标。我在想我需要生成顶点，将它们存储在一个数组中，并`glVertexAttribPointer(...)`按照 UV 坐标调用一些东西，但我不确定我应该从图像中使用什么数据来获得这个，或者即使我是否已经在函数中解析了它。我想这将涉及使用内部/外部 for 循环（外部表示 x，内部表示 y）以行/列方式抓取图像。不过，我对此感到有些困惑，我不确定这是否是我需要的。

无论哪种方式，任何有关如何做到这一点的建议都将不胜感激。

* * *

解析图像的实际代码（`HEADER_LENGTH`= 54 字节）：

```
GLuint Image_LoadBmp( const char* fname, image_bmp_t* data )
{   
    uint8_t  header[ HEADER_LENGTH ];

    FILE* f = fopen( fname, "rb" );

    if ( !f )
    {
        printf( "ERROR: file \"%s\" could not be opened [likely] due to incorrect path. :/ \n", fname );

        return 0; // return false
    }

    data->filename = strdup( fname ); // TODO: write a wrapper for strdup which exits program on NULL returns

    const size_t num_bytes_read = fread( ( void* )header, sizeof( uint8_t ), HEADER_LENGTH, f );

    if ( num_bytes_read != HEADER_LENGTH )
    {
        printf( "ERROR: file \"%s\" could not be opened due to header size being " _SIZE_T_SPECIFIER " bytes; "\
                "this is an invalid format. \n", fname, num_bytes_read );

        return 0;
    }

    if ( header[ 0 ] != *( uint8_t* )"B" || header[ 1 ] != *( uint8_t* )"M" )
    {
        printf( "ERROR: file \"%s\" does NOT have a valid signature \n", fname );

        return 0;
    }

    data->image_size         = *( uint32_t* )&( header[ 0x22 ] );
    data->header_size        = ( uint32_t )( header[ 0x0E ] );
    data->width              = ( uint32_t )( header[ 0x12 ] );
    data->height             = ( uint32_t )( header[ 0x16 ] );
    data->pixel_data_pos     = ( uint32_t )( header[ 0x0A ] );
    data->compression_method = ( uint8_t )( header[ 0x1E ] );
    data->bpp                = ( uint8_t )( header[ 0x1C ] );

    // TODO (maybe): add support for other compression methods

    if ( data->compression_method != CM_RGB )
    {
        puts( "ERROR: file \"%s\" does NOT have a supported compression method for this parser; \n" \
              "\t Currently, the compression methods supported are: \n" \
              "\t - BI_RGB \n\n"
             );

        return 0;
    }

    return 1;
} 
```

根据从当前图像收集的图像信息，我的调试输出如下所示：

```
Info for "assets/sprites/nave/nave0001.bmp" {  
     Size        = 3612      Header Size = 40  
     Width       = 27      Height      = 43  
     Pixel Array Address = 54      Compression Method  = 0  
     Bits Per Pixel      = 24
 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T23:50:10.647

首先让我说：您阅读标题的方法几乎是完美的。唯一的缺点：您的代码不处理 Endianess，并且您正在截断标题的字段（对于任何尺寸大于 255 的图像，它都会中断。

这是一个修复

```
data->image_size = (uint32_t)header[0x22] | (uint32_t)header[0x23] << 8 | (uint32_t)header[0x24] << 16 | (uint32_t)header[0x25] << 24; 
```

大于 8 位的所有其他字段的模式相同。每个标头字段的强制转换对于防止截断是必要的。将其转换为目标变量类型。也不必担心性能，现代编译器将其转换为非常高效的代码。

到目前为止，您的功能仍然缺乏读取图像数据。我只是假设数据稍后会在一个字段`data->pixels`中。

读入图像后，您可以将其传递给 OpenGL。OpenGL 在所谓的“纹理对象”中管理其图像。通常的节是：

1.  使用 glGenTextures 创建纹理对象名称
2.  使用 glBindTexture 绑定纹理对象
3.  在所有 GL_UNPACK_… 参数上使用 glPixelStorei 设置像素传输参数
4.  使用 glTexImage2D 5 上传纹理。

    *   转向 mipmap

    或者

    *   生成 Mipmap。

这如下

```
GLuint texName;
glGenTexture(1, &texName);
glBindTexture(GL_TEXTURE_2D, texName);

glPixelStorei(GL_UNPACK_SWAP_BYTES, GL_FALSE);
glPixelStorei(GL_UNPACK_LSB_FIRST, GL_FALSE);
glPixelStorei(GL_UNPACK_ROW_LENGTH, 0);   // could also be set to image size, but this is used only
glPixelStorei(GL_UNPACK_IMAGE_HEIGHT, 0); // if one wants to load only a subset of the image
glPixelStorei(GL_UNPACK_SKIP_PIXELS, 0);
glPixelStorei(GL_UNPACK_SKIP_ROWS, 0);
glPixelStorei(GL_UNPACK_SKIP_IMAGES, 0);
glPixelStorei(GL_UNPACK_SKIP_ALIGNMENT, 4); // that one's pretty important. For TrueColor DIBs the alignment is 4

GLenum internalformat;
switch(data->bpp) {
case 24:
    internalformat = GL_RGB; break;

case 32:
    internalformat = GL_RGBA; break;
}

glTexImage2D(GL_TEXTURE_2D, 0, internalformat,
             data->width, data->height, 0
             GL_BRGA, GL_UNSIGNED_INT_8_8_8_8, data->pixels);

glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR); 
```

GL_UNSIGNED_INT_8_8_8_8 类型需要解释。你看，DIB 将 32 位无符号整数视为复合颜色结构。事实上，在 Windows 中你可以找到一种颜色类型，它是一个类型定义的整数。这就是 DIB 中包含的内容。通过使用具有 4×8 分量整数类型的 BGRA 格式，我们使 OpenGL 以该格式解压缩像素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T23:32:27.080

这里有很多，您可能需要将其分解为多个问题，但这里是概述：

您不需要将实际的像素数据传递给着色器；您需要做的是使用像素数据预先在 GL 中创建一个纹理对象，然后在着色器中引用该纹理。您需要绘制的实际几何图形（正如您所怀疑的那样）只有一个四边形，它的四个角和相应的纹理坐标（在这种情况下是微不足道的，角上的每个轴只有 0.0 和 1.0）。

着色器的神奇之处在于片段着色器将针对输出中的每个像素运行，您只需在 GL 提供给您的着色器的不同纹理坐标处对纹理进行采样。

（如果您是 GL 新手，请先尝试以某种固定颜色绘制一个简单的四边形以使其正常工作，然后再尝试将 BMP 数据放入纹理中。）

# javascript - 为什么 d3 的 select() 和 selectAll() 在这里表现不同？

> ID：14187784
> 
> 赞同：12
> 
> 时间：2013-01-06T23:06:35.850
> 
> 标签：javascript, d3.js

我正在玩[阻力倍数示例](http://bl.ocks.org/1557377)，我注意到一些我无法解释的事情。

在这个片段中：

```
var svg = d3.select("body").selectAll("svg")
    .data(d3.range(16).map(function() { return {x: width / 2, y: height / 2}; }))
    .enter().append("svg")
    .attr("width", width)
    .attr("height", height); 
```

我`selectAll`改为`select`. 它仍然有效，但现在`svg`元素被添加到标签*之后。*`</body>`如您所料，带有 的原始代码`selectAll`将它们添加到`<body>`标记之后。

由于原始 html 不包含硬编码`<svg>`元素，我认为两者`select`都只`selectAll`返回空选择。所以我无法弄清楚为什么它们会导致不同的行为。

我只是在寻找一个解释。谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2015-02-07T22:36:16.563

select 和 selectAll 之间的基本区别在于 select 压缩了现有选择的层次结构，而 selectAll 保留了它。

因此，当您一个接一个地使用 selectAll 时，结果将很像嵌套的 for 循环列表。

[http://bost.ocks.org/mike/nest/](http://bost.ocks.org/mike/nest/)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-30T20:02:03.190

查看 Mike Bostock 关于 select/selectAll 的帖子：[嵌套选择](http://bost.ocks.org/mike/nest/)

去引用：

> select 和 selectAll 之间有一个重要的区别：select 保留现有的分组，而 selectAll 创建一个新的分组。因此，调用 select 会保留原始选择的数据、索引甚至父节点！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-12-02T14:01:57.533

这里的其他答案有点偏离，并且没有引用正确的来源；这仅与嵌套相关。[D3 的作者在他的连接](http://bost.ocks.org/mike/join/)概念中对此进行了解释。我在这里查看完整性：

你有两组（数组）：

1.  驱动可视化的数据集；
2.  表示该数据集中每个数据项的 HTML 元素。

在应用程序运行期间的任何给定时间，这些集合*可能并不完全相同*。所以我们做一些管理来确保它们在任何时候都匹配（每个处理帧）。想象一个实时数据集（流）——也许上次我们只有 98 个元素，现在我们有 100 个。页面仍然有 98 个`<div>`，但现在我们需要再创建 2 个。这*正是*您的代码中自动发生的情况：

1.  通过调用`.selectAll("svg")`您是在说，“创建一组`<svg>`元素*，即使它们不存在*。” 另一种说法是，“假设我们可以选择一组`<svg>`与我们给出的数据集匹配的 s。现在，继续创建该组。”
2.  ...这正是`.enter().append(...)`当时所做的。相反，如果我们的新数据集的元素太多（因为我们以前在数据集中的元素比现在多），`.exit().remove(...)`将处理这个问题。

`enter`是我们需要创建的一组元素；`exit`是我们需要删除的。

您`.selectAll("svg")`不会返回任何内容，但由于它更像是一个建议而不是命令，因此它会在 中创建它需要的内容`.enter().append("svg")`，以匹配给定的数据集。

# vb.net - 按值排序 VB 字典，然后遍历排序值

> ID：14187795
> 
> 赞同：0
> 
> 时间：2013-01-06T23:08:31.970
> 
> 标签：vb.net, dictionary, visual-studio-2012

我有一个（字符串，整数）字典。我需要先按整数对字典进行排序，然后在循环中使用每个整数值。例如，字典包含 cat 2、dog 1、rat 3...ordered 将是 dog 1、cat 2、rat 3。然后我会得到第一个值 1，用它执行一些函数，得到下一个值 2 ，用它执行一些功能，依此类推，直到字典结束。

到目前为止，我有：

```
Dim ordered = newdictionary.OrderBy(Function(x) x.Value)
   ordered.Select(Function(x) x.Value) 
```

有什么好方法可以做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T23:17:48.453

这似乎是你真正想要的：

```
For Each value In newdictionary.Values.OrderBy(Function(i) i)
    ' do something with the value '
Next 
```

现在您正在循环`int`字典的有序值

[`Dictionary<TKey, TValue>.Values`财产](http://msdn.microsoft.com/en-us/library/vstudio/ekcfxy3x.aspx)

**根据您想要包含索引的评论进行**编辑以检查下一个元素是否等于当前元素：****

 **```
Dim values = newdictionary.Values.
    Select(Function(i, index) New With {.Num = i, .Index = index}).
    OrderBy(Function(x) x.Num)
For Each value In values
    Dim nextElement = values.ElementAtOrDefault(value.Index + 1)
    If nextElement Is Nothing OrElse nextElement.Num <> value.Num Then
        ' next value is different or last element
    Else
        ' next number same 
    End If
Next 
```**

# c# - 使用 sql 命令查找记录 - sql 中的树结构

> ID：14187797
> 
> 赞同：0
> 
> 时间：2013-01-06T23:09:00.120
> 
> 标签：c#, sql, sql-server

所以我有这张表，上面有我用于家谱网站的所有祖先的姓名和出生/死亡日期。关键是 ID，所有子项的 ParentID 项将设置为与父项的 ID 相同。

```
ID - int (key)
FirstName - string
Lastname - string
Born - int
Died - int
ParentID - int
hasChildren - bool 
```

我想以某种类型的树结构显示它（这是稍后的另一个问题） - 现在我只是在 GridView 中显示它们。我在每一行的开头都有一个按钮，称为 Branch。当您在某人的记录上单击分支时，它会调用一个选择函数来检索所选记录的 ID，因此我可以执行 SELECT 命令来搜索所有具有与所选记录的 ID 匹配的 ParentID 的记录。在这样做时，我将使用所选记录的所有子项（父项）重新填充网格。由于我不想在网格中显示 ID 和 ParentID，我无法使用以下方法检索它：

```
GridViewRow row = GridView1.Rows[GridView1.SelectedIndex]; 
```

我的想法是：

```
 SqlDataSource ds = (SqlDataSource)GridView1.DataSourceObject;
    string selectstring = "SELECT [ID],[FirstName],[MiddleName],[LastName],[BirthDate],[DeathDate],[ParentID],[hasChild] FROM [test2].[dbo].[Geneology] where ParentID = " + x;
    SqlDataSource2.SelectCommand = selectstring; 
```

其中 x 是所选记录 ID 的字符串。我似乎无法弄清楚如何在不显示在 gridview 中的情况下检索所选记录的 ID。我在创建数据源时选择了所有列，但隐藏了 ID 和 ParentID。现在它们不包含在 gridview 的行中。关于如何解决这个问题的任何想法？我希望这能很好地解释它。

[编辑] 好的 - 我修好了。我必须将 DataKey 设置为 ID，以便 GridView.SelectedValue 返回 ID。它现在工作。我只需要弄清楚如何在不使用所有记录重新填充网格的情况下返回一级。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T00:47:43.233

也许您正在寻找一种叫做分层查询的东西。

在 Oracle 中，你会做类似的事情：

```
select t.*
from table t
connect by t.id = t.parent_id
start with t.id = my_id 
```

编辑：现在我再次阅读了您的问题，我认为您在谈论一些 C# 东西，我对此一无所知，所以不要介意我的回答

# java - 16 位以上的音频格式如何工作？

> ID：14187799
> 
> 赞同：2
> 
> 时间：2013-01-06T23:09:18.940
> 
> 标签：java, audio, bytearray, wav

我正在尝试用 Java 编写一些基本的声音编辑程序，但是我的 16 位 WAVE 文件格式遇到了很多麻烦。

当我问 Java 它认为我的声音文件有多少样本时，它给出的数字是我预期的两倍。当我告诉 Java 生成一个 80000 字节样本的正弦波时，它播放了 1 秒而不是 2 秒（即使采样率约为每秒 40000 次）。

经过一番搜索，我意识到我的文件的“帧大小”是 2，“样本”实际上是 2 个字节而不是 1 个字节，这被称为 16 位音频文件。作为一个实验，我将声音文件写入一个字节数组，每隔一个字节设置为 0，然后播放结果。当我只保留奇数样本时，声音文件播放时会带有一点点静态噪音。当我只保留偶数时，静态噪音会在没有声音文件的情况下自行播放。这让我认为偶数字节包含奇数字节中静态的精确逆，其中包含要播放的实际声音。当一起播放时，偶数字节使奇数字节中的静态静音，从而提高声音保真度。

[这个网站](http://home.roadrunner.com/~jgglatt/tech/wave.htm#POINTS "这个网站")很好地解释了 16 位声音编码的基础知识。但是，对我来说，继续逐字节编辑文件还不够好。如何对 16 位（或更大）的声音文件进行逐字节编辑，同时仍保持其更高的保真度？用每个样本 16 位而不是 8 位编码声音的公式是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-03T15:04:49.293

> 如何对 16 位（或更大）的声音文件进行逐字节编辑...？

这个问题没有任何意义。当你说“逐字节编辑”时，你真的应该说“逐个样本”。在这种情况下，每个样本都是 16 位（或两个字节），将样本分开是没有意义的。这就像试图在文本编辑器中只编辑每个字母的上半部分。

数字音频流的单个通道是一个数字序列（又名样本）。每个样本都代表了声波在某个时刻施加在麦克风振膜上的压力。在 8 位声音文件中，只有 256 个可能值，而在 16 位声音文件中，有 65536 个可能值。16 位文件具有更高的分辨率。

> 这让我认为偶数字节包含奇数字节中静态的精确逆，其中包含要播放的实际声音。

这是有道理的。信号处理中“噪声”的定义是你听到的和你想听到的之间的区别。当您将所有奇数字节清零时，您踩到了每个样本的低位部分。通过改变样本，你引入了一些你不想听到的东西（即噪音）。当您将偶数字节归零时，您将杀死所有高位，因此也杀死了大部分信号。保留在低位字节中的内容与您在第一个实验中引入的噪声完全相反。（你的耳朵无法分辨给定声波和同一声波的倒数之间的区别。）

样本值和压力之间没有绝对的映射关系，但您应该知道以下几点：

1) 样品是签名还是未签名？每个样本都有一个值，该值必须介于某个最小值和某个最大值之间。如果（16 位）样本有符号，则最小值为 -32768（0x8000），最大值为 32767（0x7FFF），中间为 0。如果样本无符号，则最小值为 0，最大值为 65535 (0xFFFF)。弄错了，您会立即知道，因为您将听到的只是*巨大的*噪音。

2) 样本是线性的吗？样本值总是与某事成正比。如果它们与声压级成正比，则称为“线性编码”。但它们可能与声压的对数或声压的某些其他函数成正比。非线性编码几乎总是 8 位，它们通常只在电话等特殊应用中遇到。如果您正在处理 16 位或更大的样本，那么它们几乎肯定是线性的。

# java - 将 C# 包装器与 Java 应用程序中的 C API 一起使用时出现异常

> ID：14187800
> 
> 赞同：1
> 
> 时间：2013-01-06T23:09:30.203
> 
> 标签：java, c++, api, debugging, visual-studio-debugging

我正在尝试使用 C API 中的 C# 代码。C API 实际上可从 Java 应用程序中获得。

我创建了一个 C++/CLI 包装器来调用一个简单的 C# 函数，并使用一个简单的 C++ 控制台应用程序验证了它的工作原理。我还编写了 C++ dll，它可以与随 Java 程序发布的 C API 一起成功运行。尽管当我尝试使用同一个程序来调用 C++/CLI 包装器时，主机 Java 程序会立即退出而没有任何错误。然后我尝试实例化 C++/CLI 对象并在 try/catch 块中调用成员函数，但它仍然立即退出。这是我的代码：

```
try
{
CutLoggerGraphWrapper obj;
obj.SetRdoc(1.234);
}
catch (exception & e)
{
    AllocConsole();
    freopen("CONIN$", "r", stdin);
    freopen("CONOUT$", "w", stdout);
    freopen("CONOUT$", "w", stderr);
    cout << e.what() << endl;
    FreeConsole();
} 
```

当我将 Visual Studio 中的调试会话附加到 Java 应用程序 (javaw.exe) 时，它会在“CutLoggerGraphWrapper obj”行出现故障。

我尝试将我的 dll 放置在多个位置，包括与 Java 应用程序 dll 位于同一文件夹中，然后放置在 PATH 环境变量中列出的文件夹中。我在想它可能没有加载包装器或 C# dll。这并没有改变什么。我无法从 Visual Studio 的输出中理解问题所在。这是来自输出窗口的消息。有什么建议么？

```
'javaw.exe' (Win32): Loaded 'C:\cgtech70\windows64\jre\bin\javaw.exe'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\ntdll.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\kernel32.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\KernelBase.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\advapi32.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\msvcrt.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\sechost.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\rpcrt4.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\user32.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\gdi32.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\lpk.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\usp10.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\imm32.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\msctf.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\nvinitx.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\cgtech70\windows64\jre\bin\server\jvm.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\winmm.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\cgtech70\windows64\jre\bin\hpi.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\psapi.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\cgtech70\windows64\jre\bin\verify.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\cgtech70\windows64\jre\bin\java.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\cgtech70\windows64\jre\bin\zip.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\cgtech70\windows64\jre\bin\awt.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\winspool.drv'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\ole32.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\shell32.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\shlwapi.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\uxtheme.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\cgtech70\windows64\jre\bin\fontmanager.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\dwmapi.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\cryptbase.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\apphelp.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\cgtech70\windows64\jre\bin\net.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\ws2_32.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\nsi.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\mswsock.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\wship6.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\cgtech70\windows64\jre\bin\nio.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\cgtech70\windows64\jre\bin\jpeg.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Program Files (x86)\DisplayFusion\Hooks\AppHookx64_678D2E40-CE87-49FD-B8A9-B7BDE75F14AB.dll'. Module was built without symbols.
'javaw.exe' (Win32): Loaded 'C:\Windows\winsxs\amd64_microsoft.windows.common-controls_6595b64144ccf1df_5.82.7601.17514_none_a4d6a923711520a9\comctl32.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\clbcatq.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\oleaut32.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\cgtech70\windows64\vericut\CGTech.dll'. Module was built without symbols.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\wsock32.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\winsxs\amd64_microsoft.vc80.crt_1fc8b3b9a1e18e3b_8.0.50727.6195_none_88e41e092fab0294\msvcr80.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\avifil32.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\msacm32.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\msvfw32.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\opengl32.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\glu32.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\ddraw.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\dciman32.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\setupapi.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\cfgmgr32.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\devobj.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\cgtech70\windows64\jre\bin\jawt.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\comdlg32.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\netapi32.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\netutils.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\srvcli.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\wkscli.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\WSHTCPIP.DLL'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\nlaapi.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\NapiNSP.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\pnrpnsp.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\dnsapi.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\winrnr.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\IPHLPAPI.DLL'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\winnsi.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\FWPUCLNT.DLL'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\rasadhlp.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\netbios.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\sspicli.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\cgtech70\windows64\jre\bin\dcpr.dll'. Cannot find or open the PDB file.
The thread 0x1688 has exited with code 0 (0x0).
First-chance exception at 0x0000000002C380E0 in javaw.exe: 0xC0000005: Access violation reading location 0x0000000000000028.
'javaw.exe' (Win32): Loaded 'C:\Dev\CutLogger\Build\Release\OptiAPI.dll'. Symbols loaded.
'javaw.exe' (Win32): Loaded 'C:\cgtech70\windows64\vericut\CutLoggerWrapper.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\mscoree.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\msvcr110d.dll'. Symbols loaded.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\msvcp110d.dll'. Symbols loaded.
'javaw.exe' (Win32): Loaded 'C:\cgtech70\windows64\vericut\opapi.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\msvcp110.dll'. Symbols loaded.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\msvcr110.dll'. Symbols loaded.
'javaw.exe' (Win32): Loaded 'C:\Windows\Microsoft.NET\Framework64\v4.0.30319\mscoreei.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\Microsoft.NET\Framework64\v4.0.30319\clr.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\System32\msvcr110_clr0400.dll'. Cannot find or open the PDB file.
First-chance exception at 0x000007FEFD96A49D (KernelBase.dll) in javaw.exe: 0x04242420 (parameters: 0x0000000031415927, 0x000007FEE7E60000, 0x000000000C3FDD40).
'javaw.exe' (Win32): Loaded 'C:\Windows\assembly\NativeImages_v4.0.30319_64\mscorlib\9da5bb33cd1c34b7851c088f0cf749cc\mscorlib.ni.dll'. 
'javaw.exe' (Win32): Loaded 'C:\cgtech70\windows64\vericut\CutLoggerWrapper.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\cgtech70\windows64\vericut\CutLoggerWrapper.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Unloaded 'C:\cgtech70\windows64\vericut\CutLoggerWrapper.dll'
'javaw.exe' (Win32): Loaded 'C:\Windows\Microsoft.NET\Framework64\v4.0.30319\clrjit.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\Microsoft.NET\Framework64\v4.0.30319\diasymreader.dll'. Cannot find or open the PDB file.
'javaw.exe' (Win32): Loaded 'C:\Windows\assembly\NativeImages_v4.0.30319_64\System\e3305bdbd03ef919051aa7f2783ac32a\System.ni.dll'. 
First-chance exception at 0x000007FEFD96A49D in javaw.exe: Microsoft C++ exception: EEFileLoadException at memory location 0x000000000C3FA640.
First-chance exception at 0x000007FEFD96A49D in javaw.exe: Microsoft C++ exception: [rethrow] at memory location 0x0000000000000000.
First-chance exception at 0x000007FEFD96A49D in javaw.exe: Microsoft C++ exception: EEFileLoadException at memory location 0x000000000C3FA640.
First-chance exception at 0x000007FEFD96A49D in javaw.exe: Microsoft C++ exception: [rethrow] at memory location 0x0000000000000000.
First-chance exception at 0x000007FEFD96A49D in javaw.exe: Microsoft C++ exception: EEFileLoadException at memory location 0x000000000C3FA640.
First-chance exception at 0x000007FEFD96A49D (KernelBase.dll) in javaw.exe: 0xE0434352 (parameters: 0xFFFFFFFF80070002, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x000007FEE7E60000).
First-chance exception at 0x000007FEFD96A49D in javaw.exe: Microsoft C++ exception: [rethrow] at memory location 0x0000000000000000.
First-chance exception at 0x000007FEFD96A49D (KernelBase.dll) in javaw.exe: 0xE0434352 (parameters: 0xFFFFFFFF80070002, 0x0000000000000000, 0x0000000000000000, 0x0000000000000000, 0x000007FEE7E60000).
First-chance exception at 0x00000000083170A1 (jvm.dll) in javaw.exe: 0xC0000005: Access violation reading location 0x00000000E0000000.
First-chance exception at 0x00000000083170A1 (jvm.dll) in javaw.exe: 0xC0000005: Access violation reading location 0x00000000E0000000.
The thread 0x17ac has exited with code 1 (0x1).
The thread 0x1238 has exited with code 1 (0x1).
The thread 0xf7c has exited with code 1 (0x1).
The thread 0x9c0 has exited with code 1 (0x1).
The thread 0x1080 has exited with code 1 (0x1).
The thread 0x6c0 has exited with code 1 (0x1).
The thread 0xadc has exited with code 1 (0x1).
The thread 0xcb0 has exited with code 1 (0x1).
The thread 0x1704 has exited with code 1 (0x1).
The thread 0x178c has exited with code 1 (0x1).
The thread 0x1544 has exited with code 1 (0x1).
The thread 0x1254 has exited with code 1 (0x1).
The thread 0xf0 has exited with code 1 (0x1).
The thread 0x16bc has exited with code 1 (0x1).
The thread 0x510 has exited with code 1 (0x1).
The thread 0xc44 has exited with code 1 (0x1).
The thread 0x44c has exited with code 1 (0x1).
The thread 0x15c8 has exited with code 1 (0x1).
The thread 0x1154 has exited with code 1 (0x1).
The thread 0x7fc has exited with code 1 (0x1).
The thread 0xd8c has exited with code 1 (0x1).
The thread 0xee4 has exited with code 1 (0x1).
The thread 0x165c has exited with code 1 (0x1).
The thread 0xaa8 has exited with code 1 (0x1).
The thread 0x9c4 has exited with code 1 (0x1).
The thread 0x15b0 has exited with code 1 (0x1).
The thread 0x16fc has exited with code 1 (0x1).
The thread 0x141c has exited with code 1 (0x1).
The thread 0xec0 has exited with code 1 (0x1).
The thread 0x13d0 has exited with code 1 (0x1).
The thread 0x17e8 has exited with code 1 (0x1).
The thread 0xd44 has exited with code 1 (0x1).
The thread 0x1630 has exited with code 1 (0x1).
The thread 0x1204 has exited with code 1 (0x1).
The thread 0x7f8 has exited with code 1 (0x1).
The thread 0x14ac has exited with code 1 (0x1).
The thread 0x1340 has exited with code 1 (0x1).
The thread 0x428 has exited with code 1 (0x1).
The thread 0x5ec has exited with code 1 (0x1).
The program '[4796] javaw.exe' has exited with code 1 (0x1). 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-08T15:36:09.643

我找到了解决问题的方法，原来是 C++/CLI 包装器和 C# dll 的位置。我必须在 (appdirectory)/jre/bin 中找到 dll。在看到同一目录中的一些 microsoft dll 后，我得出了这个结论。

# java - Docx4j 缓冲图像

> ID：14187810
> 
> 赞同：0
> 
> 时间：2013-01-06T23:11:06.960
> 
> 标签：java, drawing, bufferedimage, docx4j

我正在使用 docx4j 来操作 docx。我想做的是为所有表中的每个图像制作缓冲图像。我有 org.docx4j.wml.Drawing 的实例，有没有办法从中制作缓冲图像？

源代码大多是从某个地方下载的。

仅相关部分：

```
 for (Object o : children ) {                   
            System.out.println("  " + o.getClass().getName() );
            if ( o instanceof javax.xml.bind.JAXBElement) {
                System.out.println("      " +  ((JAXBElement)o).getName() );
                System.out.println("      " +  ((JAXBElement)o).getDeclaredType().getName());

                // TODO - unmarshall directly to Text.
                if ( ((JAXBElement)o).getDeclaredType().getName().equals("org.docx4j.wml.Text") ) {
                    org.docx4j.wml.Text t = (org.docx4j.wml.Text)((JAXBElement)o).getValue();
                    System.out.println("      " +  t.getValue() );

                } else if ( ((JAXBElement)o).getDeclaredType().getName().equals("org.docx4j.wml.Drawing") ) {
                    org.docx4j.wml.Drawing d   = (org.docx4j.wml.Drawing)((JAXBElement)o).getValue();
                    describeDrawing(d);

                } 
```

这将基本上通过表格中的单元格并确定它是文本还是图片

我想从图片中制作缓冲图像。

完整的源代码：

```
 import java.util.List;
import javax.xml.bind.JAXBContext;
import javax.xml.bind.JAXBElement;

import org.docx4j.dml.picture.Pic;
import org.docx4j.dml.wordprocessingDrawing.Anchor;
import org.docx4j.dml.wordprocessingDrawing.Inline;
import org.docx4j.openpackaging.io.SaveToZipFile;
import org.docx4j.openpackaging.packages.WordprocessingMLPackage;
import org.docx4j.openpackaging.parts.WordprocessingML.MainDocumentPart;
import org.docx4j.wml.Body;

public class Test {

    public static JAXBContext context = org.docx4j.jaxb.Context.jc; 

    /**
     * @param args
     */
    private static WordprocessingMLPackage wordMLPackage;

    public static void main(String[] args) throws Exception {

        //String inputfilepath = "/home/dev/workspace/docx4j/sample-docs/jpeg.docx";
        String inputfilepath = "C:\\Users\\Blizzard\\Desktop\\VSE\\15.docx";

        boolean save = false;
        String outputfilepath = "C:\\Users\\Blizzard\\Desktop\\VSE\\112.docx";  

        // Open a document from the file system
        // 1\. Load the Package
        wordMLPackage = WordprocessingMLPackage.load(new java.io.File(inputfilepath));

        // 2\. Fetch the document part       
        MainDocumentPart documentPart = wordMLPackage.getMainDocumentPart();

        // Display its contents 
        System.out.println( "\n\n OUTPUT " );
        System.out.println( "====== \n\n " );   

        org.docx4j.wml.Document wmlDocumentEl = (org.docx4j.wml.Document)documentPart.getJaxbElement();
        Body body =  wmlDocumentEl.getBody();

        List <Object> bodyChildren = body.getEGBlockLevelElts();

        walkJAXBElements(bodyChildren);         

        // Save it

        if (save) {     
            SaveToZipFile saver = new SaveToZipFile(wordMLPackage);
            saver.save(outputfilepath);
        }
    }

    static void walkJAXBElements(List <Object> bodyChildren){

        for (Object o : bodyChildren ) {

            if ( o instanceof javax.xml.bind.JAXBElement) {

                System.out.println( o.getClass().getName() );
                System.out.println( ((JAXBElement)o).getName() );
                System.out.println( ((JAXBElement)o).getDeclaredType().getName() + "\n\n");

                if ( ((JAXBElement)o).getDeclaredType().getName().equals("org.docx4j.wml.Tbl") ) {
                    org.docx4j.wml.Tbl tbl = (org.docx4j.wml.Tbl)((JAXBElement)o).getValue();
                    describeTable(tbl);
                }
            } else if (o instanceof org.docx4j.wml.P) {
                System.out.println( "Paragraph object: ");

                if (((org.docx4j.wml.P)o).getPPr() != null
                        && ((org.docx4j.wml.P)o).getPPr().getRPr() != null
                        && ((org.docx4j.wml.P)o).getPPr().getRPr().getB() !=null) {
                    System.out.println( "For a ParaRPr bold!");
                }

                walkList( ((org.docx4j.wml.P)o).getParagraphContent());
            }
        }
    }

    static void walkList(List children){

        for (Object o : children ) {                    
            System.out.println("  " + o.getClass().getName() );
            if ( o instanceof javax.xml.bind.JAXBElement) {
                System.out.println("      " +  ((JAXBElement)o).getName() );
                System.out.println("      " +  ((JAXBElement)o).getDeclaredType().getName());

                // TODO - unmarshall directly to Text.
                if ( ((JAXBElement)o).getDeclaredType().getName().equals("org.docx4j.wml.Text") ) {
                    org.docx4j.wml.Text t = (org.docx4j.wml.Text)((JAXBElement)o).getValue();
                    System.out.println("      " +  t.getValue() );

                } else if ( ((JAXBElement)o).getDeclaredType().getName().equals("org.docx4j.wml.Drawing") ) {
                    org.docx4j.wml.Drawing d   = (org.docx4j.wml.Drawing)((JAXBElement)o).getValue();
                    String relation = describeDrawing(d);

                }

            } else if (o instanceof org.w3c.dom.Node) {
                System.out.println(" IGNORED " + ((org.w3c.dom.Node)o).getNodeName() );                 
            } else if ( o instanceof org.docx4j.wml.R) {
                org.docx4j.wml.R  run = (org.docx4j.wml.R)o;
                if (run.getRPr()!=null) {
                    System.out.println("      " +   "Properties...");
                    if (run.getRPr().getB()!=null) {
                        System.out.println("      " +   "B not null ");                     
                        System.out.println("      " +   "--> " + run.getRPr().getB().isVal() );
                    } else {
                        System.out.println("      " +   "B null.");                                             
                    }
                }
                walkList(run.getRunContent());              

            } else {

                System.out.println(" IGNORED " + o.getClass().getName() );

            }
//          else if ( o instanceof org.docx4j.jaxb.document.Text) {
//              org.docx4j.jaxb.document.Text  t = (org.docx4j.jaxb.document.Text)o;
//              System.out.println("      " +  t.getValue() );                  
//          }
        }
    }

    static void describeTable( org.docx4j.wml.Tbl tbl ) {

        // What does a table look like?
        boolean suppressDeclaration = false;
        boolean prettyprint = true;
        System.out.println( org.docx4j.XmlUtils.marshaltoString(tbl, suppressDeclaration, prettyprint) );

        // Could get the TblPr if we wanted them
         org.docx4j.wml.TblPr tblPr = tbl.getTblPr();

         // Could get the TblGrid if we wanted it
         org.docx4j.wml.TblGrid tblGrid = tbl.getTblGrid();

         // But here, let's look at the table contents
         for (Object o : tbl.getEGContentRowContent() ) {

             if (o instanceof org.docx4j.wml.Tr) {

                 org.docx4j.wml.Tr tr = (org.docx4j.wml.Tr)o;

                 for (Object o2 : tr.getEGContentCellContent() ) {

                        System.out.println("  " + o2.getClass().getName() );
                        if ( o2 instanceof javax.xml.bind.JAXBElement) {

                            if ( ((JAXBElement)o2).getDeclaredType().getName().equals("org.docx4j.wml.Tc") ) {
                                org.docx4j.wml.Tc tc = (org.docx4j.wml.Tc)((JAXBElement)o2).getValue();

                                // Look at the paragraphs in the tc
                                walkJAXBElements( tc.getEGBlockLevelElts() );

                            } 

                            else {
                                // What is it, if it isn't a Tc?
                                System.out.println("      " +  ((JAXBElement)o).getName() );
                                System.out.println("      " +  ((JAXBElement)o).getDeclaredType().getName());
                            }
                        } else {
                            System.out.println("A  " + o.getClass().getName() );                            
                        }

                 }

             } else {
                System.out.println("C  " + o.getClass().getName() );
             }

         }

    }

    static String describeDrawing( org.docx4j.wml.Drawing d ) {

        System.out.println(" describeDrawing " );
        String vrat = null;
        if ( d.getAnchorOrInline().get(0) instanceof Anchor ) {

            System.out.println(" ENCOUNTERED w:drawing/wp:anchor " );
            // That's all for now...

        } else if ( d.getAnchorOrInline().get(0) instanceof Inline ) {

            // Extract w:drawing/wp:inline/a:graphic/a:graphicData/pic:pic/pic:blipFill/a:blip/@r:embed

            Inline inline = (Inline )d.getAnchorOrInline().get(0);

            Pic pic = inline.getGraphic().getGraphicData().getPic();

            //pic.

            vrat = pic.getNvPicPr().getCNvPr().getName();

            System.out.println( "image name: " +   vrat);
            //bordel(inline);

        } else {

            System.out.println(" Didn't get Inline :(  How to handle " + d.getAnchorOrInline().get(0).getClass().getName() );
        }
        return vrat;
    }

} 
```

我尝试添加一些方法，但我变得非常绝望：

```
private static void bordel(org.docx4j.wml.Drawing d){
        MainDocumentPart documentPart = wordMLPackage.getMainDocumentPart();
        RelationshipsPart relsPart = documentPart.getRelationshipsPart();
        Relationships rels = relsPart.getRelationships();
        List<Relationship> relsList = rels.getRelationship();

        for (Relationship r : relsList) {

            JAXBElement el = printInfo(relsPart.getPart(r));
            if (el != null) {

                   if ( el.getDeclaredType().getName().equals("org.docx4j.wml.Drawing") ) {

                        org.docx4j.wml.Drawing c   = (org.docx4j.wml.Drawing) el.getValue();
                        if (c.equals(d)){
                            System.out.println( "I found part");
                        }

                    }
             }

        }           
    } 
```

在单元格中的每个图像上调用此方法并尝试找到我相信我可以转换为缓冲图像的部分

但是将 Part 转换为 JAXBElement 的下一个方法总是返回 null

```
public static JAXBElement printInfo(Part p) {

        JAXBElement el = null;

        if (p instanceof JaxbXmlPart) {

            Object o = ((JaxbXmlPart)p).getJaxbElement();

            if (o instanceof javax.xml.bind.JAXBElement) {
                //sb.append(" containing JaxbElement:" + XmlUtils.JAXBElementDebug((JAXBElement)o) );
                el= (JAXBElement) o;
            } else {
                //sb.append(" containing JaxbElement:"  + o.getClass().getName() );
            }
        }

        return el;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T05:14:53.783

以下代码将为您找到图像关系：

```
 BlipFinder bf = new BlipFinder();
    new TraversalUtil(paragraphs, bf);

    for (CTBlip imageReference : bf.blips) {

        if (imageReference.getLink() != null
                && !imageReference.getLink().equals("")) {

            Relationship existingRel = docxPkg.getMainDocumentPart()
                    .getRelationshipsPart().getRelationshipByID(
                            imageReference.getLink());

            :

        } else if (imageReference.getEmbed() != null) {

            String relId = imageReference.getEmbed();

            Relationship r = docxPkg.getMainDocumentPart().getRelationshipsPart().getRelationshipByID(relId);
            if (r.getTargetMode()!=null 
                    && r.getTargetMode().toLowerCase().equals("external")) {
                :

            } else {

                BinaryPartAbstractImage oldPart = (BinaryPartAbstractImage)docxPkg.getMainDocumentPart().getRelationshipsPart().getPart(relId);

                : 

            }

        } else {
            log.error("HELP! neither linked nor embedded?");
        }

    }
}

    static class BlipFinder extends CallbackImpl {

        List<CTBlip> blips = new ArrayList<CTBlip>();  

        @Override
        public List<Object> apply(Object o) {

            if (o instanceof CTBlip)
                blips.add((CTBlip)o);

            return null;
        } 
```

在指定的情况下，给你一个 BinaryPartAbstractImage。有了它，你就可以为所欲为……

# c# - 如何通过 Visual Studio DTE 添加安装项目？

> ID：14187815
> 
> 赞同：0
> 
> 时间：2013-01-06T23:11:48.237
> 
> 标签：c#, visual-studio-2008, setup-project

我正在尝试使用该`IWizard`界面开发模板 Visual Studio 2008 解决方案。到目前为止，我已经能够成功地将多个项目添加到解决方案中。我现在希望将 Web 设置项目放入已经指定特定项目的项目输出的解决方案中。

我读到`.vdproj`文件不能成为模板的一部分，因此请查看任何其他可用的替代选项。

我尝试过但没有奏效的一个选项是将`.vdproj`文件的内容保存在向导中，并在生成解决方案后将其写出。我想知道是否可以使用 Visual Studio`ExecuteCommand`添加项目并在设置项目中添加输出组而不显示 UI。

以前有人试过吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-13T19:53:38.333

我找到了答案。

`.vdproj`在向导中保存文件内容的方法有效。但是，在将内容写入文件并将其添加为项目之前，必须在保存的文本中替换将在安装项目 (`Project Output`或) 中使用的项目的 GUID。`Content Files`

将项目添加到解决方案后，Visual Studio 会添加一个唯一的项目 GUID，并且必须使用 Visual Studio SDK 读取此 GUID 并替换为实际`.vdproj`文件文本。

# ruby - 红宝石转换日期

> ID：14187817
> 
> 赞同：0
> 
> 时间：2013-01-06T23:11:55.780
> 
> 标签：ruby, mechanize

我有一个页面将其作为日期 new Date(1357106400000) （我相信是 Javascript）返回。

如何使用 Ruby 进行转换。我试过了：

Date.new(1357106400000) DateTime.new(1357106400000) 和许多其他人，但我无法获得正确的显示日期。

返回的日期应为 12/09/2012

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T23:20:56.353

在 Javascript 中：

```
> new Date(1357106400000)
Wed Jan 02 2013 06:00:00 GMT+0000 (GMT Standard Time) 
```

在红宝石中：

```
>  require 'date'
> DateTime.strptime("1357106400000", "%Q")
=> #<DateTime: 2013-01-02T06:00:00+00:00 ((2456295j,21600s,0n),+0s,2299161j)> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T23:22:29.143

我相信自纪元以来您已经获得了以毫秒为单位的时间，而您正在寻找的功能是[Time#at](http://www.ruby-doc.org/core-1.9.3/Time.html#method-c-at)。但是您需要在调用之前将其下转换为几秒钟。例如：

```
[holt@Michaela ~]$ irb
irb(main):001:0> Time.at(1357106400000)
=> Wed Dec 28 00:00:00 +0000 44974
irb(main):002:0> Time.at(1357106400000 / 1000)
=> Wed Jan 02 06:00:00 +0000 2013
irb(main):003:0> 
```

不是您认为的确切日期，但可能仍然正确。希望有帮助！

# version-control - 你能在 Perforce 中分享一个客户端规范吗？

> ID：14187818
> 
> 赞同：3
> 
> 时间：2013-01-06T23:12:10.363
> 
> 标签：version-control, perforce, collaboration

让每个人都在 Perforce 中为一个项目创建同一个客户端似乎毫无意义，那么，有没有人可以在 Perforce 中创建一个“公共”客户端，每个人都可以从中同步？

**编辑**：我的意思是像你在 Perforce 中根据客户规范创建的客户

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T14:47:03.720

我相信，如果您使用术语“工作区”而不是“客户端”，则更容易理解架构。Perforce 应用程序在本地磁盘的指定区域（称为工作区）中管理文件。顾名思义，您的工作区是您进行大部分工作的地方。即使在同一个工作站上，您也可以拥有多个客户端工作区。

由于两个不同的用户通常在不同的工作站或笔记本电脑上独立工作，因此他们每个人都需要自己的代码副本，并且每个人都需要自己的工作空间，以便他们可以控制何时与服务器中的更改同步。

如果你和我试图在一个工作站上共享一个代码副本，我们很快就会发现自己对谁的更改是谁的更改感到困惑；我们更容易独立工作，并将我们的更改合并为单独的提交到服务器。

如果您的问题是客户端定义很复杂，视图定义非常复杂，那么您可能希望研究“模板客户端”功能：使用您喜欢的视图和选项设置一个主客户端，然后您的其他用户可以使用“client -t”创建从模板客户端复制视图和选项详细信息的工作区定义。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-06T23:32:43.833

可以这样做，但不建议这样做。由于 Perforce 会在服务器端记录同步到每个客户端的文件，因此您可能会遇到以下情况：

1.  用户 Fred 使用共享客户端进行同步并获得一组新文件。
2.  在提交任何更改之前，用户 Jim 使用共享客户端进行同步，但什么也得不到，因为 Perforce 服务器认为客户端已经拥有最新的文件集。

Jim 可以使用“p4 sync -f”来解决这个问题，这将强制将所有最新文件同步到他的工作区，但这是围绕 Perforce 设计使用方式的一个混搭。

Perforce 客户端在服务器上占用的资源方面非常轻量级，因此最好不要共享客户端。

我试图在在线 Perforce 文档中找到关于为什么不应共享客户端的更完整解释，但这并不是很有帮助。[如果您碰巧有一本，那么“Practical Perforce”](http://shop.oreilly.com/product/9780596101855.do)一书有我见过的最好的概述。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-07T15:22:47.803

使用 Bryan 提到的模板工作区，或考虑使用流。在流框架中，您只需定义一次流视图（组合），就会自动生成工作区。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-24T16:57:23.923

p4 sync -f 太慢了。因为首先它将删除您本地的所有文件，然后从中央仓库重新加载文件！有一个棘手的方法。当想要同步 -f 时，它是创建一个 haslist 并进行同步。细节是1，获取clientspec，2，将其保存到本地。3、删除客户端 4、使用保存的clientspec创建一个相同的客户端。因此我们节省了删除本地文件的时间。

# ruby-on-rails - 为什么我的 polymorphic_type 字段没有被 rails 自动分配

> ID：14187820
> 
> 赞同：1
> 
> 时间：2013-01-06T23:12:26.637
> 
> 标签：ruby-on-rails, ruby-on-rails-3, polymorphic-associations, single-table-inheritance

我将单表继承与多态关联结合使用。这是我的模型。

```
class ChangeInformation < ActiveRecord::Base
  belongs_to :eventable, :polymorphic => true
end

class Race < ActiveRecord::Base
  has_many :track_condition_changes, :as => :eventable, :class_name => "ChangeInformation"
  #other associations omitted
end

class TrackConditionChange < ChangeInformation

end 
```

change_informations 表具有以下字段：

```
type               #sti field
change_code
eventalbe_id       #polymorphic id
eventable_type     #polymorphic type
description 
```

当我使用以下创建方法时：

```
TrackConditionChange.create(:change_code => 1, :eventable_id => 3 :description => "test") 
```

创建了一个 TrackConditionChange 记录，其中填充了 type 字段，但是，未填充 eventable_type 字段（应该是 Race）。我的印象是 rails 会自动填充此字段，类似于 STI 类型字段。是我有错误的印象还是我的关联设置有问题。

感谢您的输入。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T02:26:30.093

如果你只传入 eventable_id，它怎么知道它是什么类型？您将必须传递整个事件对象或基于 track_condition_changes 关系构建它：

**1.传递事件对象：**

```
race = Race.find(3)
TrackConditionChange.create(:change_code => 1, :eventable => race, :description => "test") 
```

**2.根据关系构建并保存：**

```
race = Race.find(3)
race.track_condition_changes << TrackConditionChange.new(:change_code => 1, :description => "test") 
```

# batch-file - .exe 文件从内部执行

> ID：14187822
> 
> 赞同：0
> 
> 时间：2013-01-06T23:12:34.860
> 
> 标签：batch-file, exe, iexpress

如果我创建一个文件`foo.exe`，并且它包含文件`bar.bat`、、`baz.bat`和，我可以从内部`qux.bat`调用吗？我的意思是，如果是在执行时执行的文件？`baz.bat``bar.bat``bar.bat``foo.exe`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T07:59:16.293

我使用 winrar（而不是 iexpress）自解压存档做了类似的事情。

机制如下：

1.  首先，它会将所有内容提取到指定文件夹（或临时文件夹 %TEMP%/random_name 中）
2.  然后它将调用初始可执行文件/脚本或“提取后运行的脚本”。在您的情况下，它是 bar.bat。
3.  该可执行脚本可以反过来调用任何其他脚本/可执行文件。（在您的示例中为 baz.bat）

可以肯定的是，更改文件 bar.bat 以包含以下脚本：

```
@echo off
cd
explorer .
pause 
```

这将打印目录名称，它已提取并使用 explorer.exe 打开目录。然后您可以验证您的 baz.bat 是否在同一目录中。如果需要，请提供相对路径。

# 3d - 如何获取加载的 OBJ/MTL 模型的表面坐标？

> ID：14187827
> 
> 赞同：0
> 
> 时间：2013-01-06T23:13:31.647
> 
> 标签：3d, coordinates, three.js

编辑编辑：

我还应该提到我的模型是按比例缩放的。我不确定这是否会影响 intersectsObject 方法。但它显然会影响我试图绘制并以米为单位测量的线（使用已知比率）。这条线并不总是映射到正确的表面。我需要做什么来解决这个问题？

**澄清：**

**我需要在模型表面上选择两个点后测量一条线，并以米为单位输出。但是，使用我的模型，似乎我无法选择模型上每个表面上的每个点，有时它会选择表面后面的其他点（当然相对于相机）......**

有没有人对此有任何见解？一些表面是平面，因为没有厚度 - 也许这是一个问题。

* * *

编辑：所以我通过调用 ray.intersectsObjects.. 的重载方法来完成这项工作，该方法使用以下方法调用：

```
var intersects = ray.intersectObjects( scene.children, true ); 
```

但是，**它不适用于模型上的每个表面。有什么想法吗？**

* * *

所以我有一个使用three.js在webGL中加载的建筑物模型，特别是使用OBJMTL加载器加载的。

使用常规方式，即

```
var vector = new THREE.Vector3( mouse.x, mouse.y, 1 );
projector.unprojectVector( vector, camera );

var ray = new THREE.Ray( camera.position, vector.subSelf( camera.position ).normalize() );

// create an array containing all objects in the scene with which the ray intersects
var intersects = ray.intersectObjects( scene.children ); 
```

当我的鼠标悬停在模型上时，我找不到任何对象，并且调试器说 intersects 没有初始化。

我像这样加载我的建筑物

```
var loader = new THREE.OBJMTLLoader();
loader.addEventListener( 'load', function ( event ) {

var object = event.content;

object.position.y = 8;
object.scale.x = object.scale.y = object.scale.z = 8;
scene.add( object );
objects.push(object);

});
loader.load( 'oakley/building.obj', 'oakley/building.mtl' ); 
```

您可以在其中看到 scene.add() 调用。

那么，我是在做一些愚蠢的事情，还是没有办法使用这种方式检测加载模型的面部碰撞？

如果没有，是否有解决方法？

# web - 如何更改 prestashop 主题中菜单栏的文本？

> ID：14187830
> 
> 赞同：0
> 
> 时间：2013-01-06T23:13:50.037
> 
> 标签：web, prestashop

**嗨，

有人可以告诉我如何编辑菜单栏的文本，因为我尝试在源代码中进行更改，但这是不可能的，因为 html 代码隐藏在 prestashop 主题中（他们使用 tpl 文件）。

所以有可能改变??**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T21:44:09.520

我不确定您是如何尝试通过代码更改它的。还原所有更改，您可以使用翻译工具更改所有前台和后台翻译（包括已安装的模块）的文本。

在 1.4 中，它位于 Tools>Translations 下，在 1.5 中，它位于 Localization>Translations 中

然后，您可以导航到正确的翻译、后台、前台、已安装的模块等。我希望这会有所帮助！

# python - 使用 64 位 Windows 和 Python 3.3 安装 Python 包

> ID：14187832
> 
> 赞同：1
> 
> 时间：2013-01-06T23:14:10.640
> 
> 标签：python, window, 64-bit, packages

我读到有一个不错的文本转语音包，名为 pyttsx，可以包含在我的 Python 脚本中。一旦我尝试安装 pyttsx，事情就会开始迅速崩溃。pyttsx 适用于 Python 2.6（也许是 2.7？）而不是 3.3。我安装了 2.7 和 3.3（也可移植 Python 2.7 和 3.2），但我无法让 setuptools 或 easy_install 工作。我安装了部分分发，但我可能在安装结束时看到了一些错误，所以我不确定它是否正常工作，无论如何它不会安装 pyttsx。有一个 Windows .exe 程序可以让你安装 Python 包，但它不适用于 64 位 Python。几天来我一直在寻找答案，但找不到足够具体的答案。

如何在 64 位 Windows 7 上安装带有 64 位 Python 3.3 的 Python 包，或者这是否可能？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T23:20:39.467

有史以来最好的来源！

[这个人是个坏人。](http://www.lfd.uci.edu/~gohlke/pythonlibs/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-10T17:39:04.280

安装分发后，启动要使用的 python.exe。

在 python 交互中，运行以下代码：

```
from setuptools.command import easy_install

easy_install.main(["-U", "package"]) 
```

将“包”替换为您要安装的任何内容。

# c# - 如果使用“使用”，使用 var 类型很重要

> ID：14187835
> 
> 赞同：3
> 
> 时间：2013-01-06T23:14:46.157
> 
> 标签：c#

以下是等价的吗？在某些情况下
使用类型很重要吗？`var`

目前使用这个：

```
static int ReturnIDfromDb(string sqlString, string outputParam) {
    var connectionString = ConfigurationManager.ConnectionStrings["xxx"].ConnectionString;
    using(var conn = new SqlConnection(connectionString))
    using(var comm = new SqlCommand(sqlString, conn)) {
        ...
    }
} 
```

这不是更具体吗？

```
static int ReturnIDfromDb(string sqlString, string outputParam) {
    var connectionString = ConfigurationManager.ConnectionStrings["xxx"].ConnectionString;
    using(SqlConnection conn = new SqlConnection(connectionString))
    using(SqlCommand comm = new SqlCommand(sqlString, conn)) {
        ...
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-06T23:17:10.310

对于编译器来说是一样的。严重地。`var`变成硬编码。

但是，在某些情况下您必须使用 var，因为您不知道类型。

`IQueryable`(LINQ) 允许您投影：

......

```
.Select (x=> new { Name = x.Name; }).ToArray(); 
```

在这种情况下，你会得到一个 - 匿名类型的数组，所以......

它一定要是

var 结果数组

因为此时您不能命名类型。

但`var`只是编译器的事情。Resharper 的代码约定说：使用 var，而不是类型。这些天我倾向于同意。

编译后也是一样。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-06T23:18:57.190

如果您明确定义变量将包含的对象类型，在这种情况下，通过在类名上使用 new 关键字，那么您可以`var`简单地用作快捷方式，而不必键入两次类名。没有任何技术差异。

使用`var`更容易输入和阅读，例如：

```
Dictionary<int, MyLongNamedObject> dictionary = new Dictionary<int, MyLongNamedObject>(); 
```

或者

```
var dictionary = new Dictionary<int, MyLongNamedObject>(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-06T23:17:42.977

这些是等价的。

`var`始终与实际使用表达式的编译时类型等效（尽管更短）。

但是，当使用匿名类型时，您需要使用`var`，因为没有您可以自己编写的特定命名类型。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-06T23:22:14.300

`var`关键字本身不是“类型” 。`var`要求编译器自动为您推断类型。没有区别..

关键字的使用`var`归结为个人或团队偏好。尝试保持一致，并尝试仅在人脑一眼就能推断出类型的地方使用它。

例如：

```
// bad
var customers = GetCustomers();

// good
var customers = GetListOfCustomers(); 
```

鉴于智能感知可以挽救生命，以上内容可能是个人偏好。但它在审查代码时会有所帮助。

它对于缩短嵌套泛型类型的声明也很有用（例如，值也是包含字符串列表的字典的字典）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-06T23:31:03.370

## 这些代码是完全等价的。

`var`**当您不知道** 或**不需要了解类型**案例时，它会更有用。

假设我们有`Car`阶级和`Cleaners`财产。当我们编写这样的代码时；

```
Car c = new Car();
var cleaner = c.Cleaners; 
```

**我们不需要知道**`cleaner`is`IEnumerable<Cleaner>`或什么的类型`BindingList<Cleaner>`。如果我们使用`IEnumerable<Cleaner>`or`BindingList<Cleaner>`在这种情况下，这可能是一个问题。因为返回类型可能是这些类型之一。在这种情况下使用`var`，我们不在乎`cleaner`.

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-01-07T03:24:42.483

我尝试指定一个反映代码实际需要的类或接口。这让我相信未来的更改不会破坏其他代码。

我会使用：

```
static int ReturnIDfromDb(string sqlString, string outputParam) {
    string connectionString = ConfigurationManager.ConnectionStrings["xxx"].ConnectionString;
    using(DbConnection conn = new SqlConnection(connectionString))
    using(DbCommand comm = conn.CreateCommand()) {
        comm.CommandText = sqlString;
        ...
    }
} 
```

如果我以后决定从 a 更改为 a `SqlConnection`，`OracleConnection`我相信任何使用`conn`or`comm`变量都不需要修改。

`~Connection`请注意，如果您需要具体或`~Command`类的独特功能，这可能并不总是合适的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-01-06T23:18:31.070

它是完全等价的，我不认为使用 var，如果可以的话，会有所作为。

但是，您有时必须使用 var。

# ruby - 使用首选默认值展开数组

> ID：14187836
> 
> 赞同：7
> 
> 时间：2013-01-06T23:14:52.890
> 
> 标签：ruby, arrays, default-value

[Array#[]=](http://www.ruby-doc.org/core-1.9.3/Array.html#method-i-5B-5D-3D)的文档指出

> 如果索引大于数组的当前容量，则数组会自动增长。

当它确实自动增长时，它会使用`nil`值：

```
arr = []
arr[2] = "!"
arr # => [nil, nil, "!"] 
```

是否可以指定前两个值的默认值？

目前，我正在做

```
arr = []
index = 2
currently_uninitialized_value_range = (arr.length)...(index)
default_values = currently_uninitialized_value_range.map{ "" }
arr[currently_uninitialized_value_range] = default_values
arr[index] = "!"
arr # => ["", "", "!"] 
```

这有点冗长。

我使用的是数组，而不是哈希，因为它们代表我将要输入到电子表格中的值，而我正在使用的库 (Axlsx) 更喜欢逐行添加数据。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T00:03:48.337

使用哈希作为数组怎么样？它可能看起来像这样：

```
h = Hash.new do |hash,key|
  0.upto(key) { |i| hash[i] = "" unless hash.has_key?(i) }
end

h[5]
h[0] #=> ""
h[4] #=> ""
h.keys #=> [0, 1, 2, 3, 4, 5] 
```

也许这种方法需要一些额外的调整来满足您的需求，例如您可以定义方法`size`等。

PS 获取数组

```
h.values #=> ["", "", "", "", "", ""] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-07T03:33:42.540

[`Array#fill`](http://www.ruby-doc.org/core-1.9.3/Array.html#method-i-fill)可能是你的票。

```
arr = []

index = 2
arr.fill( "", arr.length...index )
arr[index] = "!"
# => ["", "", "!"]

index = 5
arr.fill( "", arr.length...index )
arr[index] = "!"
# => ["", "", "!", "", "", "!"]

index = 1
arr.fill( "", arr.length...index )
arr[index] = "!"
#=> ["", "!", "!", "", "", "!"] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-07T02:47:54.253

我快速查看了`Array`文档，但没有发现任何有用的信息......

...但是如果我理解得很好，您需要在将数据导出到电子表格之前`nil`用空字符串 ( ) 替换值。`""`在这样做之前调用`to_s`数组的每个元素怎么样？：

```
arr.map! &:to_s 
```

# javascript - 通过 jQuery 修复背景图像高度

> ID：14187840
> 
> 赞同：0
> 
> 时间：2013-01-06T23:15:14.483
> 
> 标签：javascript, jquery

我有一个页面模板结构。与以下

```
<body>
<div class=bg></div>
<header>
...
</header>
<content>
...
</content>
<footer>
..
</footer> 
```

我的内容 div 有一个 li 类，当单击 li 时，左移 1600px。

我想在我的网站上全屏显示我的 bg 课程。但我不知道如何通过 jQuery 来做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T23:16:51.070

尝试这样做，如果你想在整个页面上显示 bg，它需要在正文中：

```
<body class="bg"> 
```

# intuit-partner-platform - OAuthRequestValidator 访问令牌和访问令牌秘密

> ID：14187841
> 
> 赞同：1
> 
> 时间：2013-01-06T23:15:22.187
> 
> 标签：intuit-partner-platform, quickbooks-online

我正在尝试使用 Intuit IPP 将帐户添加到 QuickBooks Online：

[https://ipp.developer.intuit.com/0010_Intuit_Partner_Platform/0200_DevKits_for_Intuit_Partner_Platform/0100_IPP_.NET_DevKit/Query_Filters/QuickBooks_Online](https://ipp.developer.intuit.com/0010_Intuit_Partner_Platform/0200_DevKits_for_Intuit_Partner_Platform/0100_IPP_.NET_DevKit/Query_Filters/QuickBooks_Online)

如何获取访问令牌和访问令牌秘密？这是我的代码：

```
class Program
{
    static string appToken = "xxx";
    static string oAuthConsumerKey = "xxx";
    static string oAuthConsumerSecret = "xxx";

    static void Main(string[] args)
    {
        OAuthRequestValidator oauthValidator = new OAuthRequestValidator(appToken, "", oAuthConsumerKey, oAuthConsumerSecret);
        ServiceContext context = new ServiceContext(oauthValidator, appToken, "1234", IntuitServicesType.QBD);
        DataServices dataServices = new DataServices(context);

        Account account = new Account();
        account.Desc = "TEST PLEASE DELETE";
        string guid = Guid.NewGuid().ToString("N");
        guid = guid.Substring(0, 30);
        account.Name = guid;
        account.Type = Intuit.Ipp.Data.Qbd.AccountTypeEnum.Liability;
        account.TypeSpecified = true;
        account.Subtype = "Accounts Payable";
        Account resultAccount = dataServices.Add(account) as Account;

    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T13:25:17.130

Joseph，
供将来参考和其他人参考，您的问题的文档位于此处：

[IPP Oauth 文档](https://ipp.developer.intuit.com/0010_Intuit_Partner_Platform/0025_Intuit_Anywhere/0020_Connect/0010_From_Within_Your_App/Implement_OAuth_in_Your_App)

问候，
杰瑞德

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-06T23:42:34.487

我想到了。看这里的第 6 步：

[http://ippblog.intuit.com/blog/2012/09/ode-to-oauth-and-rest-apis-and-how-i-love-thee-not.html](http://ippblog.intuit.com/blog/2012/09/ode-to-oauth-and-rest-apis-and-how-i-love-thee-not.html)

# javascript - 在 PhoneGap 应用程序中，PhoneGrap 是否会将我的代码转换为本机代码？

> ID：14187842
> 
> 赞同：1
> 
> 时间：2013-01-06T23:15:29.047
> 
> 标签：javascript, android, cordova

我今天才开始尝试PhoneGap。我以前听说过它，我一直认为它会将 HTML 和 Javascript 翻译成本机代码。试了之后觉得设备是直接执行HTML/Javascript/CSS？

我对PhoneGap 所做的事情感到困惑。我的设备是执行原始 HTML/Javascript/CSS 还是执行翻译后的本机代码？

顺便说一句，我正在Android上开发。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-06T23:16:35.257

PhoneGap 在设备的本机浏览器中执行您的 Javascript。

它不编译任何东西，尽管浏览器的 JITter 可能会。

# android - 为安卓选择数据库

> ID：14187844
> 
> 赞同：1
> 
> 时间：2013-01-06T23:15:56.287
> 
> 标签：android, sql, database, sqlite

我正在观看有关数据库的 android 教程。他们创建一个类并扩展 SQLiteOpenHelper。然后他们将为数据库名称创建一个静态的最终字符串。当您请求可写数据库时，它将始终使用静态字符串进行选择。用于选择不同数据库的约定是什么？只需创建另一个类并扩展 SQLiteOpenHelper？您还可以使用 intent.putExtra 或类似方法将 SQLiteDatabase 从一个活动传递到另一个活动吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T23:23:18.300

> 用于选择不同数据库的约定是什么？

处理的`SQLiteOpenHelper`不仅仅是数据库名称。它处理模式版本、创建、升级等......所以我希望约定是定义另一个类并扩展`SQLiteOpenHelper`。

> 您可以使用 intent.putExtra 或类似方法将 SQLiteDatabase 从一个活动传递到另一个活动吗？

不，你不能。但是您可以创建描述数据库的类的新对象（扩展的对象`SQLiteOpenHelper`，并从中请求数据库。在内部`SQLiteOpenHelper`保持与数据库的单个可写连接。

# php - 如果用户单击浏览器按钮，如何显示消息？

> ID：14187850
> 
> 赞同：1
> 
> 时间：2013-01-06T23:16:49.250
> 
> 标签：php, javascript, jquery, html, ajax

我的问题是，如果按下浏览器按钮，是否可以显示一条消息，以便能够显示一条消息，说明用户是应该离开页面还是留在页面上？如果用户在某个页面上尝试更改 url，是否也可以显示一条消息？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T23:26:45.363

1.  需要服务器端来确保这一点。在服务器上，开始评估时，您应该首先拥有开始屏幕 URL。您必须对其进行编程，以便在开始评估后（单击开始后），它会转到考试 URL，并且您的评估始终会被保存 - 当用户返回时，使用服务器端技巧有它，而不是显示开始屏幕，它重定向回正确的页面（以仍然保持历史记录的方式），显示仍然包含数据的考试，并弹出警告不要单击返回按钮。然后，如果用户再次执行此操作，它会再次执行相同的操作。

2.  您必须拥有它，以便始终保存考试。unload javascript 事件可用于通过 alert() 通知他们不应该离开考试，仅此而已。onbeforeunload 事件可用于尝试让他们选择留下，但不应依赖它，因为它不适用于每个浏览器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T00:30:01.817

按照评论中的建议使用`onbeforeunload`。有各种各样的例子，比如这个：[http ://www.4guysfromrolla.com/demos/OnBeforeUnloadDemo1.htm](http://www.4guysfromrolla.com/demos/OnBeforeUnloadDemo1.htm)

如果你想调出用户必须点击的按钮，你需要做一些浏览器检测，因为大多数浏览器在它们显示的窗口上都有确定/取消按钮，但 Chrome 有“离开这个页面”和“继续使用”这一页”。

# .net - .NET 进程被终止时的通知

> ID：14187853
> 
> 赞同：1
> 
> 时间：2013-01-06T23:17:07.640
> 
> 标签：.net

我的 .NET 应用程序正在使用 Process.Start(".\path\to\process.exe") 启动第二个进程。当这个进程在执行期间被另一个进程杀死时，有没有办法得到通知？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-06T23:20:27.027

您正在返回的实例中寻找[`Exited`事件。](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.exited.aspx)`Process`

# php - 如何区分 CRON 作业和 PHP 中的人类用户？

> ID：14187857
> 
> 赞同：1
> 
> 时间：2013-01-06T23:17:49.260
> 
> 标签：php, unix, cron

> **可能重复：**
> [PHP - 如何最好地确定当前调用是来自 CLI 还是 Web 服务器？](https://stackoverflow.com/questions/933367/php-how-to-best-determine-if-the-current-invocation-is-from-cli-or-web-server)

我在我的托管服务器上创建了一个日常 CRON 作业，当然它在 UNIX 上运行。

我将以下命令放入：

```
/usr/bin/php /home/myusername/public_html/foo/foo.php 
```

然后，正如预期的那样，它`foo.php`每天都执行此操作。

但这`foo.php`包含重要信息，我不希望随机的人（不要粗鲁）去`http://www.mywebsite.com/foo/foo.php`执行脚本。

那么我可以做些什么来区分 CRON 作业和 PHP 中的人类用户呢？

我最近看到执行 CRON 作业时，没有给出 IP 地址（`$_SERVER['REMOTE_ADDR']`为空）。但我不确定这是否是侥幸。

我尝试在 Google 上搜索此主题，但无济于事。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T23:20:41.243

您可以将 cron 脚本放在 web 根目录之外，例如在`/home/myusername/cron`.

或者，如果由于 FTP 限制，这不是一个选项，您可以向 cron 脚本添加一个参数：

```
/usr/bin/php /home/myusername/....../foo.php cron 
```

然后检查：

```
if( $_SERVER['argv'][0] != "cron") die("This is a cron script, you cannot access it."); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T00:51:11.273

我过去用过这个

```
if (php_sapi_name() != "cli") {
    throw new Exception("someone tried to run this script outside of cli");
} 
```

该`php_sapi_name()`函数可以告诉您谁在运行脚本。这是文档页面：[php_sapi_name](http://au1.php.net/php_sapi_name)

# ruby-on-rails - 在Rails中上传CSV文件并处理记录以显示在页面上而不保存文件？

> ID：14187859
> 
> 赞同：19
> 
> 时间：2013-01-06T23:18:02.910
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, paperclip

我正在学习 Rails，并试图创建一个文件上传页面来处理 CSV 数据，而不使用我的数据库或模型。我还试图避免使用任何宝石，例如回形针或载波波。

我取得了一些进展，但由于某种原因，我的代码无法正常工作。我没有得到 CSV 文件中显示的记录`import.html.erb page.`

当我单击页面上的上传按钮：localhost:3000/upload 时，它会在提交后正确地将我重定向到预期的页面，但文件中的行不会出现。

有谁知道为什么页面不显示 CSV 文件中的记录？

上传文件视图（index.html.erb）：

```
<%= form_tag({:action => :import}, multipart: true) do %>
  <%= file_field_tag :file %>
  <%= submit_tag( "Import" ) %>
<% end %> 
```

控制器（upload_controller.rb）：

```
class UploadController < ApplicationController
  def index
  end

  def import
    rowarray = Array.new
    myfile = params[:file]

    CSV.foreach(myfile.path) do |row|
      rowarray << row
      @rowarraydisp = rowarray
    end
  end
end 
```

结果视图（import.html.erb）：

```
<% @rowarraydisp.each do |row| %>
  <%= row %>
<% end %>
<h1>File has been uploaded. Check</h1> 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-07T03:08:25.110

```
CSV.foreach(myfile.path) do |row|
  rowarray << row
  @rowarraydisp = rowarray
end 
```

应该写成：

```
@rowarraydisp = CSV.read(myfile.path) 
```

根据以下文档`CSV.read`：

> 用于将 CSV 文件转换为数组数组。

您的`import.html.erb`文件被使用了两次，用于您的 ERB 的两个不同示例。实际文件和实际代码是什么？

```
<% @rowarraydisp.each do |row| %>
  <%= row %>
<% end %> 
```

将尝试将 CSV 文件中的子数组发送`row`到浏览器，但是，如果不知道 ERB 或数据是什么，除了一行数据的内容之外，很难说输出将是什么。

# android - 列表视图还是滚动视图？

> ID：14187864
> 
> 赞同：0
> 
> 时间：2013-01-06T23:18:38.590
> 
> 标签：android, listview, scrollview

目前，我正在使用带有 LinearLayout 的 ScrollView。我想实现一个快照功能。我最好使用 ListView 吗？甚至可以使用我当前的设置实现快照功能吗？我想让事情变得简单。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T23:25:32.073

通过“快照功能”，我假设您的意思是分页，以便用户可以像 Play Store 或 ICS Dialer 应用程序一样从一侧滑动到另一侧。虽然是的，但您可以使用 ScrollView 或任何数量的其他解决方案自己实现这一点，但我认为您*不应该*这样做，因为您可以使用 Android 的`ViewPager`类。

`ViewPager`是一个美妙的视图，它使用片段集合作为单个布局中的页面。这将为您的用户提供一个非常熟悉且一致的界面，并将为您节省大量非常困难的代码。

# php - file_get_contents 和浏览器会话

> ID：14187865
> 
> 赞同：1
> 
> 时间：2013-01-06T23:18:45.750
> 
> 标签：php, external, file-get-contents

我有以下代码：

```
$homepage = file_get_contents("https://example.com/specific_page");
echo $homepage; 
```

浏览器已经有一个我需要访问的站点会话，所以如果我在新选项卡中打开 url，页面将被正确加载。

问题是 php 脚本将我重定向到“您未登录”页面。请注意，即使我重新启动浏览器，该 url 仍然可用。

任何想法如何在不编写登录网站的代码的情况下获取内容？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T23:25:44.893

如果一个网站可以访问您在任意外部网站上的数据，那将是一个巨大的安全问题。想象一下：`file_get_contents('https://yourbank.com/all-your-details')`.

您可以做到这一点的唯一方法是在外部网站上向用户询问他/她的登录凭据并手动登录。但是，这将是不可靠的，因为身份验证过程可能会改变（并且向某人询问他/她的密码是非常粗鲁的）。

这通常是 Web 服务 API 的用途，但如果您感兴趣的站点没有可用的 API，那么您就会陷入困境。

* * *

如果您已经知道网站的登录凭据，那么您可以使用 Blauesocke 概述的方法将它们硬编码到脚本中，但如果详细信息对当前用户来说是唯一的，这将不起作用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-06T23:27:04.357

PHP 运行服务器端，因此它有自己的会话处理，没有链接到您的浏览器会话。您可以使用[cURL](http://php.net/curl)和类似的[选项](http://php.net/manual/en/function.curl-setopt.php)`CURLOPT_COOKIEJAR`来执行此操作。使用[cURL](http://php.net/curl)，您可以通过 PHP 登录并保持您请求的网站的 PHP 会话。您将在我链接的 cURL 文档中找到大量示例。

# c++ - Mac 上的 OpenCV 未打开 USB 网络摄像头

> ID：14187866
> 
> 赞同：5
> 
> 时间：2013-01-06T23:18:46.220
> 
> 标签：c++, macos, opencv, webcam

我没有成功使用[OpenCV](http://en.wikipedia.org/wiki/OpenCV)的 VideoCapture.open(int) 从运行 Mac OS X v10.7 (Lion)的[MacBook Pro](http://en.wikipedia.org/wiki/MacBook_Pro)中的 USB 网络摄像头获取视频捕获。使用 open(0) 成功从 iSight 摄像头获取捕获。但我没有任何运气试图找到网络摄像头。

网络摄像头已安装并与[Skype](http://en.wikipedia.org/wiki/Skype)和[macam](http://webcam-osx.sourceforge.net/)驱动程序应用程序配合良好。

这是我正在使用的代码的一部分：

```
VideoCapture cap; 
for (int i = 1; i < 1500; i++) {
    if (cap.open(i))
    {
        cout << "Found camera %d\n" << i;
        break;
    }
}
if(!cap.isOpened()) {  // Check if we succeeded
    return -1;
} 
```

如果我用 0 初始化`i`，它会立即找到 iSight 摄像头。如果我用 1 初始化`i`，那么它会在`i`= 500 时再次找到 iSight。

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T00:23:20.093

尝试在没有此行的情况下运行您的代码：`break;`. 您可能会发现不止一台摄像头，其中一台将是网络摄像头。
请注意，参数 of`cap.open`不仅是摄像头的数量 - 它还定义了您要使用的 API：

摄像头调度方式：`index`为摄像头编号。

*   如果给定一个从 0 到 99 的索引，它会尝试找到第一个
*   可以访问给定相机索引的 API。
*   添加 100 的倍数以选择 API（来自 cap.cpp 的评论）

可能性（取自 highgui_c.h）：

```
CV_CAP_ANY      =0,     // autodetect  
CV_CAP_MIL      =100,   // MIL proprietary drivers  
CV_CAP_VFW      =200,   // platform native  
CV_CAP_V4L      =200,
CV_CAP_V4L2     =200,  
CV_CAP_FIREWARE =300,   // IEEE 1394 drivers  
CV_CAP_FIREWIRE =300,  
CV_CAP_IEEE1394 =300,  
CV_CAP_DC1394   =300,  
CV_CAP_CMU1394  =300,  
CV_CAP_STEREO   =400,   // TYZX proprietary drivers  
CV_CAP_TYZX     =400,  
CV_TYZX_LEFT    =400,  
CV_TYZX_RIGHT   =401,  
CV_TYZX_COLOR   =402,  
CV_TYZX_Z       =403,  
CV_CAP_QT       =500,   // QuickTime  
CV_CAP_UNICAP   =600,   // Unicap drivers  
CV_CAP_DSHOW    =700,   // DirectShow (via videoInput)  
CV_CAP_PVAPI    =800,   // PvAPI, Prosilica GigE SDK  
CV_CAP_OPENNI   =900,   // OpenNI (for Kinect)  
CV_CAP_OPENNI_ASUS =910,   // OpenNI (for Asus Xtion)  
CV_CAP_ANDROID  =1000,  // Android  
CV_CAP_XIAPI    =1100,   // XIMEA Camera API  
CV_CAP_AVFOUNDATION = 1200  // AVFoundation framework for iOS (OS X Lion will have the same API) 
```

可能`CV_CAP_AVFOUNDATION = 1200`是您正在寻找的 - 尝试从 1200 开始循环，不要忘记删除`break;`，我认为您会找到您正在寻找的。

# grails-2.1 - Grails 2.1.1 和 spring 安全消息

> ID：14187869
> 
> 赞同：2
> 
> 时间：2013-01-06T23:19:13.773
> 
> 标签：grails-2.1

有人遇到登录失败的错误消息没有出现吗？

我正在将 grails 1.3.7 应用程序升级到 grails 2.1.1，并且我在 spring 安全核心功能方面遇到了 2 个问题。

首先，如果我尝试无效登录，则身份验证失败，但没有错误消息，只有 {} 在 Flash 消息中。

其次，我使用这样的方法来获取当前的活动会话数。它不再准确，因为它只是增加并且无法识别注销。

```
def getCurrentSessionCount(){
    def sessioncount = 0
    sessionRegistry.getAllPrincipals().each{
        sessioncount += sessionRegistry.getAllSessions(it, false).size()
    }
    return sessioncount;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T02:09:57.333

好的，这是 LoginController 如何填充错误消息的不同之处。在 1.3.7 和以前的安全插件中，代码如下所示：

```
msg = SpringSecurityUtils.securityConfig.errors.login.expired 
```

但对于 2.1.1 和升级后的 spring 安全插件 1.2.7.3，代码需要使用如下上下文：

```
msg = g.message(code: "springSecurity.errors.login.disabled") 
```

会话计数与添加会话侦听器所需的 web.xml 修改有关，但是在新的 spring 3.0 中它已被移动，因此新条目应如下所示：

```
<listener>
    <listener-class>org.springframework.security.web.session.HttpSessionEventPublisher</listener-class>
</listener> 
```

# php - PHP Post调用不返回变量

> ID：14187871
> 
> 赞同：0
> 
> 时间：2013-01-06T23:19:25.050
> 
> 标签：php, javascript, html, forms, post

我有一个隐藏的输入字段，我使用 jquery 填充了一些任意值，例如：

```
function foo() {
    // Obtains the contents of a div within the current page
    var $elem = $("#something").html();
    // Places the contents of the div into a hidden input field
    $("#hidden").val($elem);
} 
```

在调试这个东西时，我可以看到 elem 变量从所需的 div 中获取 html，但看不到该变量是否传递给隐藏的输入字段值。

我有一个表格：

```
<form method="POST" action="file.php" target="_blank">
    <input id="hidden" type="hidden" value=""/>
    <input type="submit" onmouseover="foo()" value="Download"/>
</form> 
```

提交后执行file.php：

```
<?php
    $html = $_POST["hidden"];
    echo $html;
?> 
```

echo 调用什么也不返回，我得到的只是一个空白页。我想知道为什么隐藏输入字段的值没有被更改，或者为什么在 POST 调用期间它没有被传递。

一些进一步的实验表明，即使我将隐藏字段的值设置为一些随机值：

```
<input id="hidden" type="hidden" value="Some Value"/> 
```

在PHP文件执行过程中仍然没有获取到。echo 调用不返回任何内容。我获取此隐藏输入字段的值有什么问题？我非常谨慎地使用 PHP，但过去在 POST 提交时从表单获取值没有问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-06T23:21:44.817

您需要为输入字段命名才能使用 $_POST 在 php 中访问它

```
<input id="hidden" name="hidden" type="hidden" value=""/> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-06T23:21:39.957

你应该只指出`name`属性

```
<form method="POST" action="file.php" target="_blank">
    <input name="hidden" id="hidden" type="hidden" value=""/>
    <input type="submit" onmouseover="foo()" value="Download"/>
</form> 
```

# backbone.js - 对象不响应下划线随机播放

> ID：14187875
> 
> 赞同：0
> 
> 时间：2013-01-06T23:20:13.617
> 
> 标签：backbone.js, underscore.js

我正在使用下划线（1.3.0）进行骨干项目。Underscore 有一个 shuffle 方法

创建一个集合

```
countries = new Countries
child 
```

检查长度

```
countries.length
0 
```

获取数据（使用下划线方法，获取）

```
 countries.fetch();
    Object
XHR finished loading: "http://localhost:3000/countries". jquery.js:8215 
```

现在它的长度为四

```
 countries.length
    4 
```

尝试返回一个随机打乱的数组 countries.shuffle(); TypeError: Object [object Object] 没有方法'shuffle'

shuffle 否则在我的环境中有效

```
 _.shuffle([1, 2, 3, 4, 5, 6]);
[2, 1, 4, 5, 6, 3] 
```

我看过 Ryan Bates 的骨干 Railscast，他基本上做同样的事情，但他的作品。不过，其中一个区别是，当他创建 Collection 对象时，它具有不同的返回值

```
entries = new Raffler.Collections.Entries()
entries #return value 
```

但是，当我创建一个集合时，它返回 'child'

```
 countries = new Countries
    child 
```

但我认为这没有什么不同，因为我仍然可以调用 country.fetch(); 这是一种下划线方法。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T23:43:18.757

您可能正在使用旧版本的 Backbone，或者与您的 Backbone 版本不兼容的下划线版本。

包含该`Collection.shuffle`方法的第一个 Backbone 版本是 0.9.0。当时的文档没有指定下划线的最低版本，但对于 Backbone 0.9.1，最低版本是`> 1.3.1`. 对于当前的 Backbone 版本 (0.9.9)，它是`> 1.4.3`.

此外，`fetch`不是下划线方法。

# c# - 为什么无法解析 DateTime？

> ID：14187889
> 
> 赞同：0
> 
> 时间：2013-01-06T23:22:11.600
> 
> 标签：c#

我正在尝试解析从文件中读取的 DateTime，日期的格式是：

`19/10/2005 12:00:00 a.m.`

我正在使用的代码是：

```
string Fecha = dbRow["FECHA"].ToString().Trim();
DateTime fechamov;
if (!DateTime.TryParseExact(Fecha, "dd/MM/yyyy HH:mm:ss tt", CultureInfo.InvariantCulture, DateTimeStyles.None, out fechamov)) {
    fechamov = DateTime.Now;
    System.IO.File.AppendAllText(pathString, "Corregir nota: " + dbRow["NOTA"].ToString().Trim() + Environment.NewLine);
} 
```

但在我设置之前`DateTime.Now`它总是得到值`01/01/0001 12:00:00 a.m.`

我一直在尝试不同的格式，但它不起作用，我做错了什么，有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T23:24:32.010

将小时部分设为小写

```
"dd/MM/yyyy hh:mm:ss tt" 
```

大写“H”表示 24 小时制。

我认为它不应该`AM`像`a.m`Slaks 所说的那样。

# ruby-on-rails - 来自数据远程和 html 的 Kaminari 索引与链接混淆

> ID：14187892
> 
> 赞同：0
> 
> 时间：2013-01-06T23:22:35.053
> 
> 标签：ruby-on-rails, kaminari

我有一个模型（嵌套）的索引视图，它永远不会从模型中调用，而是从几个不同的模型中呈现。一个视图可以使用 JS 或 html 呈现索引。对于 JS，它是在显示视图中的 #related div 和数据远程链接中。另一个选项使用相同的控制器操作来呈现它只有 html。

一切都很好，直到我添加了 Kaminari 分页。在完整页面视图中，没有#related div，因此分页不起作用。我将胆量分解成一个部分并添加了一个#related div 并渲染了部分。从 js 我只是从 JS 渲染了部分。这在完整页面视图中工作正常，但在显示页面中它会呈现部分，但链接不起作用，看起来它呈现整个显示页面。在另一个选项卡上点击然后返回到 Progressions 选项卡会加载部分内容，并且一切正常。只是在显示页面的初始加载时，我无法使页面链接正常工作。

我可以先加载另一个不使用分页的选项卡并解决我的问题，但这是您访问此页面的主要信息。

有任何想法吗？

编辑代码请求

控制器动作方法。这个控制器中的 index 方法也设置了@progressions

```
def progressions
  authorize! :read, Progression
  @stage = Stage.find(params[:id])
  @progressions = @stage.progressions_by_score.page(params[:page]).per(20)
  if params[:status] && !params[:status].blank? && @progressions
    @progressions =  @progressions.where(status: params[:status]).page(params[:page]).per(20)
  end
  respond_to do |format|
    format.js 
    format.html {render :template => "progressions/index"}
  end
end 
```

阶段视图中的progressions.js.erb 文件

```
$("#related").html("<%= escape_javascript(render('progressions/index'))%>"); 
```

显示视图中的关系 div。这几乎是我的脚手架模板，我在其中显示或链接到相关信息。这`<div id="related">`是任何日期远程链接将加载数据的地方。在初始加载时，它会加载 _index 部分。

```
<div class="relations">
  <span class="navspan">
    <%= link_to 'Progressions: Status ->', progressions_stage_path(@stage), :'data-remote' => true, 
      :onclick => '$("#progression_status").val("")'  %> 
    <span class="huh">
      <%= hidden_field_tag :stage_id, params[:id]%>
      <%= select_tag :progression_status, options_for_select(Progression.statuses["all"], params[:status]), 
        :prompt => 'All', :class => 'f-left' %>
    </span>
    <%= link_to 'Assessors', assessors_stage_path(@stage), :'data-remote' => true %> 
    <%= link_to 'Events', events_stage_path(@stage), :'data-remote' => true %> 
    <%= link_to 'Select', select_stage_path(@stage) if can? :select_candidates, @stage %> 
    <%= link_to 'Ad Mgmt', edit_ad_stage_path(@stage) if can? :manage_ad, @stage %> 
  </span>
  <div class="f-clear"></div>
  <div id="related">
    <%= render "progressions/index"%>
  </div>
</div> 
```

index.html.haml 文件

```
#related
  = render "progressions/index" 
```

_index.html.haml 文件只是一个列出进程的索引表，但它确实包含：

```
= paginate @progressions,  :remote => true 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T11:17:02.543

发布一些代码后不久，我回到记忆中并使用 javascript 加载相关的 div。我试图远离 javascript，但在这种情况下，我在添加`:id => "status_id"`到进度链接后将其添加到页面末尾：

```
<script type="text/javascript" charset="utf-8">
  $(document).ready(function() {
    $("#status_link").trigger("click");
  })
</script> 
```

虽然这解决了我的问题，但我仍然不明白为什么初始 html 响应不响应相关 div 中的页面链接。我会把它作为其他东西来学习。在弄清楚如何仅在显示页面的初始加载时触发后，我会将其放入咖啡脚本中。

# php - 获取数组中的第 n 个键/值？

> ID：14187895
> 
> 赞同：-1
> 
> 时间：2013-01-06T23:23:38.143
> 
> 标签：php, arrays, multidimensional-array

有一个这样的数组：

```
Array
(
    [0] => stdClass Object
        (
            [url] => https://is0.Z0V.jpg
            [width] => 370
            [height] => 370
        )

    [1] => stdClass Object
        (
            [url] => https://is1.et/derived_pi0V_300x300.jpg
            [width] => 300
            [height] => 300
        )

    [2] => stdClass Object
        (
            [url] => https://is1.n100x100.jpg
            [width] => 100
            [height] => 100
        )

    [3] => stdClass Object
        (
            [url] => https://is1.t/dZ0V_36x36.jpg
            [width] => 36
            [height] => 36
        )

) 
```

我如何只从这个 foreach 中获取 [2] 并将其插入：

```
foreach($fotoSuggSizes as $fotoSuggSize100)
    {

        $image_urlSugg100[] = array("urlx100"=>$fotoSuggSize100->url);

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T23:26:51.297

您可以使用以下方法在现有数组中的特定偏移处插入另一个数组[`array_splice`](http://php.net/array_splice)：

```
$insert = array("urlx100"=>$fotoSuggSize100->url);
array_splice($fotoSuggSizes, 2, 0, array($insert)); 
```

但是，如果这就是您要寻找的，我不能完全确定您的问题。

另一种方式是：

```
$image_urlSugg100[] = array("urlx100" => $fotoSuggSizes[2]->url); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T23:28:13.687

另一种方法如下：

```
foreach($fotoSuggSizes as $n => $fotoSuggSize100)
{
   if ($n != 2) continue;
   $image_urlSugg100[] = array("urlx100"=>$fotoSuggSize100->url);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-06T23:28:20.723

原来的数组叫`$fotoSuggSize100`?

```
$image_urlSugg100[] = array("urlx100"=>$fotoSuggSize100[2]->url); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-06T23:28:51.067

也许我错过了重点，但是：

```
$image_urlSugg100[] = array("urlx100"=>$fotoSuggSizes[2]->url); 
```

或者，如果由于某种原因您特别想使用该`foreach()`方法：

```
foreach ($fotoSuggSizes as $k => $v)
{
    if ($k == 2)
    {
         $image_urlSugg100[] = array("urlx100"=>$v->url);
    }
} 
```

# c++ - C ++不允许我在初始化列表中使用其他构造函数

> ID：14187896
> 
> 赞同：1
> 
> 时间：2013-01-06T23:24:06.567
> 
> 标签：c++, c++11, constructor

我正在尝试让构造函数在其初始化列表中调用其他构造函数，因为我没有重复的逻辑。这是我的 .h 文件的样子：

```
class Button : public Component
{
public:
    Button(int x, int y, int width, int height, string normalSrc, string hoverSrc, string downSrc);
    Button(int x, int y, int width, int height, string normalSrc, string hoverSrc, string downSrc, Uint8 r, Uint8 g, Uint8 b);
    Button(int x, int y, int width, int height, string src) : Button(x, y, width, height, src, src, src) { }
    Button(int x, int y, int width, int height, string src, Uint8 r, Uint8 g, Uint8 b) : Button(x, y, width, height, src, src, src, r, g, b) { }
    ~Button(); 
```

但是当我尝试编译时（使用 -std=c++0x 作为额外的编译器标志）我得到这个错误：

```
In file included from /home/villages/Desktop/ogam-january-pipes/src/Vesper/Ui/Button.cpp:8:0:
/home/villages/Desktop/ogam-january-pipes/src/Vesper/Ui/Button.h: In constructor ‘Button::Button(int, int, int, int, std::string)’:
/home/villages/Desktop/ogam-january-pipes/src/Vesper/Ui/Button.h:29:60: error: type ‘Button’ is not a direct base of ‘Button’
/home/villages/Desktop/ogam-january-pipes/src/Vesper/Ui/Button.h: In constructor ‘Button::Button(int, int, int, int, std::string, Uint8, Uint8, Uint8)’:
/home/villages/Desktop/ogam-january-pipes/src/Vesper/Ui/Button.h:30:87: error: type ‘Button’ is not a direct base of ‘Button’
make[2]: *** [CMakeFiles/Villages.dir/src/Vesper/Ui/Button.cpp.o] Error 1
make[1]: *** [CMakeFiles/Villages.dir/all] Error 2
make: *** [all] Error 2 
```

我究竟做错了什么？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-06T23:26:59.457

> 我究竟做错了什么？

您使用了错误的编译器/版本。*委托构造函数*特性是*C++11*特性，并不是所有的编译器都赶上了。

根据[这张表，](http://wiki.apache.org/stdcxx/C++0xCompilerSupport) *GCC从**4.7*开始支持它，从*3.0开始支持**Clang*，从 2012年*11 月 CTP开始支持**MSVC*。

# git - Git 中是否有类似于 Mercurial 的命令服务器的东西？

> ID：14187904
> 
> 赞同：0
> 
> 时间：2013-01-06T23:24:59.080
> 
> 标签：git, version-control, administration

Mercurial 的命令服务器允许通过特殊协议通过管道向 Mercurial 存储库发出命令……它就像某种“网络服务”。

[https://www.mercurial-scm.org/wiki/CommandServer](https://www.mercurial-scm.org/wiki/CommandServer)

Git 中是否有类似的东西来操作远程 Git 存储库来做你需要的事情？（比如切换到另一个分支或更新到另一个版本）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T23:28:32.337

不确切知道，mercurial 命令服务器做什么，但通常`git`用作`ssh`其主要远程协议。

```
ssh serverName "cd /path/to/repo; git pull"
ssh serverName "git --git-dir=/path/to/repo pull" 
```

向远程 ssh 服务器发送一个 shell 命令`serverName`。只要您登录的用户有权执行此操作，您就可以完成远程`git`安装所提供的一切。

# c++ - 从主应用程序中取消停靠子窗口

> ID：14187906
> 
> 赞同：0
> 
> 时间：2013-01-06T23:25:06.677
> 
> 标签：c++, winapi

假设我有一个很大的应用程序，里面有几个子窗口。（[示例](http://quartushelp.altera.com/11.1/mergedProjects/global/image/gl_image_display_tabs_child_windows.gif)）

现在，我正在尝试将其中一个“内部窗户”取消停靠到一个新的锯齿状窗户上，我可以在整个地方移动！

到目前为止我做了什么：

```
HWND oldHWND = SetParent(hwnd, NULL);
SendMessage(oldHWND, WM_SYSCOMMAND, SC_CLOSE, 0); 
```

这一切都很好，但我无法移动新窗口，也无法关闭它，因为没有窗框也没有关闭按钮。

你对我有什么建议吗？

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T02:35:04.470

使用框架/关闭按钮等为未停靠的“浮动”窗口注册一个合适的窗口类，然后使未停靠的窗口成为该窗口的子级。

# javascript - 在 html5 画布中绘制 youtube

> ID：14187914
> 
> 赞同：3
> 
> 时间：2013-01-06T23:26:42.537
> 
> 标签：javascript, html, video, canvas, youtube

这是 Detect play event in youtube 包装的后续问题[MediaElement.js](https://stackoverflow.com/questions/14166857/detect-play-event-in-youtube-wrapped-via-mediaelement-js)。我试图检测问题中的播放或点击事件，但由于跨域问题（可能）而无法做到这一点。我还发现你直接将 youtube 剪辑绘制到画布上，它不会被复制（将是空白的），像这样：

```
<!DOCTYPE html>
<html>
<head>
  <title>video in canvas</title> 
  <link rel="stylesheet" href="mediaelementplayer.css" />

  <script src="jquery.js"></script>
  <script src="mediaelement-and-player.min.js"></script>

  <script> 
  $(document).ready( function() {
    $('#v').mediaelementplayer();

    var v = $('#v')[0];
    var canvas = $('#c')[0];
    var context = canvas.getContext('2d');

    console.log('play event entered');
    draw(v, context, 640, 360);
  });

  function draw(v, c, w, h) {
    // if(v.paused || v.ended)  return false;
    console.log("draw event entered");
    c.drawImage(v, 0, 0, w, h);
    setTimeout(draw, 20, v, c, w, h);
  }
  </script> 
</head>

<body>
  <video width="640" height="360" id="v" preload="none">
    <source type="video/youtube" src="http://www.youtube.com/watch?v=nOEw9iiopwI"/>
  </video>
  <canvas id="c" width="640" height="360"></canvas> 
</body>
</html> 
```

有人知道在画布上绘制 youtube 流的其他更有前途的方法吗？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-06T23:31:01.387

您不能使用画布`drawImage`绘制来自不同域的 <video> 或 <img>。

也许您可以通过您的服务器代理 Youtube 流，但这可能违反 Youtube TOS

# c# - 如何从 C# 中的捕获函数中捕获值

> ID：14187916
> 
> 赞同：0
> 
> 时间：2013-01-06T23:26:45.463
> 
> 标签：c#, regex

当我想使用`Capture`C# 中的函数捕获值时遇到问题。我的代码在字符串中查找许多模式，所以我使用匹配集合，然后对于每个匹配我使用`Capture`函数。但是当我想更换`captureOut.value`它时它不起作用。

我的代码：

```
MatchCollection matches = Regex.Matches(string, @"\d*\.*\d+\s")

foreach (Match matchOut in matches)
{
    foreach (Capture captureOut in matchOut.Captures)
    Match match1 = Regex.Match(captureOut.Value, @"\d*\.*\d+");
::::: //}
     output = Regex.Replace(output,captureOut.Value, Function1);
}
// i change the value of pattern based on the output of function 1 
```

我的这部分代码，不知为什么`capture out.value`不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T23:58:01.633

仅当您的正则表达式中有组时，使用捕获属性才有意义，即包含在 ( ) 中的部分正则表达式。由于您的正则表达式没有，因此只有一个捕获的组，它是与正则表达式匹配的整个字符串。

# java - 如何在java中操作类

> ID：14187922
> 
> 赞同：0
> 
> 时间：2013-01-06T23:27:07.353
> 
> 标签：java, javascript, class, dynamic

我知道几种编程语言。其中大多数是脚本语言，如 lua、perl、JS、ruby 等。

但最近，我开始使用 Java 进行编程，它运行起来很安静。所以我一直在想JS中存在的某个函数。构造函数的原型，也就是。为了进一步理解我的问题到底是什么，我将在 JS 中做一个例子。假设您要创建一个狗的应用程序。

```
function dog (){
this.property1 = value;
this.propertr2 = value2;
this.propertyN = valueN;
//etc.
}

//now, I will create several instances of the constructor in JS

var snoopy = new dog();
var buddy = new dog(); 
```

我知道的关于 JS 的令人敬畏的部分是，您可以使用以下原型关键字动态更改构造函数的信息以及构造函数的所有实例（在 JS 中调用它）：

```
 dog.prototype.bark = function () {
 console.log("Woof!");
 }; 
```

并且 THIS 不仅改变了关于构造函数的信息，因此每只用构造函数创建的狗都会知道如何吠叫，它也改变了，所以构造函数的所有实例都获得了原型插入的信息，在这种情况下，教狗如何吠叫。我们可以在下一个示例中看到：

```
var someOtherDog = new dog ();
someOtherDog.bark(); //output will be: Woof!
snoopy.bark();       //output will also be: Woof!
buddy.bark();        //you guessed it! it will also be: Woof! 
```

因此，使用 JS 中的这个原型关键字，我可以操作构造函数及其实例。现在，我的问题是：

如何在 java 中操作类及其实例？这甚至可能吗？如果是这样; 我应该怎么做才能在java中做类似的事情？

```
class dog
{
    private String hairColor;
    public dog ()
    {
        hairColor = "Brown";
    }
    public static void main (String args[])
    {
        dog snoopy = new dog ();
        dog buddy = new dog ();
        //now, how do I manipulate the class like I did in JS?
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T23:33:34.287

问题是 lua 和 JavaScript 都是基于原型的，Java 不是。您可以使用反射来完成类似的事情，但不是在 JavaScript 级别。[反射](http://docs.oracle.com/javase/tutorial/reflect/index.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T23:39:20.430

JavaScript 中的继承是由原型链完成的。基本上，当`bark`在对象中找不到时`snoopy`，会在其原型中查找`snoopy.prototype`。如果在那里找到，则使用该版本。如果不是（例如在调用 时`bark.toString()`），则遍历原型链，直到找到具有该成员的原型。原型本身在所有“实例”之间共享，并且由于它只是一个普通对象，您可以稍后添加或删除成员。

Java中的继承是基于类的。除非重新编译并重新加载整个类，否则不能在运行时从类定义中添加或删除成员。这是一种不同的编程范式，这意味着您必须使用其他技术和模式对其进行（稍微）不同的编程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-06T23:34:02.493

如果需要，您可以即时创建匿名类。

假设你有一堂课：

```
class Dog {
    String name;
    Dog(String name) { this.name = name; }
    void bark() { System.out.println(name + " says 'woof!'"); }

    public static void main(String...args) { 
        Dog snoopy = new Dog("snoopy");
        snoopy.bark();
    }

} 
```

这是结果

```
c:\files\j>javac Dog.java

c:\files\j>java Dog
snoopy says 'woof!' 
```

现在伙计，他不说 woof - 他说 ruff！所以我们像这样即时创建一个

```
class Dog {
    String name;
    Dog(String name) { this.name = name; }
    void bark() { System.out.println(name + " says 'woof!'"); }

    public static void main(String...args) { 
        Dog snoopy = new Dog("snoopy");
        snoopy.bark();
        Dog buddy = new Dog("buddy") {
            @Override void bark() { System.out.println(name + " says 'ruff!'"); }
        };
        buddy.bark();
    }

} 
```

这导致

```
c:\files\j>javac Dog.java

c:\files\j>java Dog
snoopy says 'woof!'
buddy says 'ruff!' 
```

如果你想永久地改变每条狗，那会变得更加困难，但可以通过策略模式来完成。

假设我们有以下内容

```
abstract class BarkingStrategy {
    public abstract void doBark(Dog dog);
}

class TypicalBarkingStrategy extends BarkingStrategy {
    public void doBark(Dog dog) { System.out.println(dog.getName() + " says 'woof!'"); }
}

class AggressiveBarkingStrategy extends BarkingStrategy {
    public void doBark(Dog dog) { System.out.println(dog.getName() + " says 'Rrrruff!'"); }
}

class Dog {
    // notice this is static - that means it belongs to the class itself, not 
    // any particular instance of it - similar to prototype
    static BarkingStrategy bark = new TypicalBarkingStrategy();
    String name;
    Dog(String name) { this.name = name; }
    String getName() { return name; }
    void bark() { bark.doBark(this); }
} 
```

然后您可以执行以下操作

```
public static void main(String...args) {
    Dog snoopy = new Dog("snoopy");
    snoopy.bark();
    Dog.bark = new AggressiveBarkingStrategy();
    snoopy.bark();
} 
```

这导致

```
c:\files\j>javac Dog.java

c:\files\j>java Dog
snoopy says 'woof!'
snoopy says 'Rrrruff!' 
```

# ruby - *::（星号双冒号）在Ruby中做了什么？

> ID：14187925
> 
> 赞同：13
> 
> 时间：2013-01-06T23:27:39.960
> 
> 标签：ruby, syntax, scope, splat

我今天在浏览 Rails 代码时偶然发现了[这个片段](https://github.com/rails/rails/blob/807e176aba7804cad8d630d04f3b771011be4fe6/activerecord/lib/active_record/connection_adapters/column.rb#L262)：

```
new_date(*::Date._parse(string, false).values_at(:year, :mon, :mday)) 
```

星号双冒号（或 splat-双冒号，如果你愿意的话）有`*::Date`什么作用？

大概它与特别命名空间`Date`类的范围有关......但作者有必要包含它而不是仅仅使用标准`Date`类。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-06T23:37:24.950

我读错了代码；它根本不是“*::”运算符。

这是正在发生的事情：

*   `Date`在全局范围内查找类 ( `::Date`)
*   调用`_parse()`以获取值的哈希值
*   调用`values_at`将散列转换为数组
*   在将数组转换为方法调用的多个参数的典型功能中使用星号运算符
*   call `new_date()`，将数组元素传递给它的`year`、`mon`和`mday`参数。

`*`和运算符之间缺乏空间`::`使其令人困惑。:-\

# wordpress - Wordpress 样式表未在前端更新

> ID：14187936
> 
> 赞同：0
> 
> 时间：2013-01-06T23:28:32.783
> 
> 标签：wordpress, wordpress-theming, stylesheet

我正在为由其他人构建的客户端开发一个网站，但我遇到了样式表未在前端更新的问题

该站点是[http://www.hamiltonkarate.co.nz/](http://www.hamiltonkarate.co.nz/)，我尝试更新样式表和页脚文件。现在页脚文件更新，但样式表没有。我尝试从服务器中删除样式表，但它仍然存在，即使我在服务器上找不到任何缓存文件。

另一个奇怪的部分是，如果我进入仪表板中的主题编辑器，它会在那里显示我更新的样式表。我已经检查了相对路径等，我已经调试过，但我无法找出为什么工作表没有更新。我已经尝试过努力刷新、其他浏览器/计算机，甚至是隐身模式，但都没有运气。

我已将更新的 css 上传到[http://www.hamiltonkarate.co.nz/wp-content/themes/hamiltonkarate/css/screen.css](http://www.hamiltonkarate.co.nz/wp-content/themes/hamiltonkarate/css/screen.css)，如果我在开发人员工具中更新 CSS 链接，它工作正常。

谁能看到这里可能出了什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T13:10:54.820

请检查您的 css 文件的文件权限。它应该是可写的

# javascript - 在 Backbone 中表示任意深度嵌套列表的最简单方法

> ID：14187944
> 
> 赞同：2
> 
> 时间：2013-01-06T23:30:15.003
> 
> 标签：javascript, jquery, backbone.js, hierarchical-data, nested-lists

我是 Backbone 的新手。我有一个任意深度的嵌套列表，其中列表中的每个节点都可能有一个子集合。例如：

```
item 1
  item a
    item i
    item ii
  item b
  item c
item 2
item 3
etc 
```

我想知道使用 Backbone 表示此数据结构的最简单方法是什么。

如果重要的话，我在最初加载整个结构或根据需要加载每个级别之间没有偏好。无论是最简单的。

我宁愿不走 Backbone-Relational 的路线，因为我觉得这样的事情有点矫枉过正。

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T23:54:46.690

我会制作一个简单的模型，可能会将默认属性`children`设置为`new Collection`（如果需要）。主要部分是从 JSON 数据加载到模型。

```
var MyModel = Backbone.Model.extend({

});
var MyCollection = Backbone.Collection.extend({
    model: MyModel,
    load: function(data) {
        for(var i in data) {
            if (_.isString(data[i])) {
                this.add(new MyModel({
                    title: data[i]
                }));
            } else {
                var collection = new MyCollection();
                collection.load(data[i]);
                this.add(new MyModel({
                    title: i,
                    children: collection
                }));
            }
        }
    }
});

var collection = new MyCollection();
collection.load({
    'item1': {
        'item a': ['item i', 'item ii'],
        0: 'item b',
        1: 'item c'
    },
    0: 'item2',
    1: 'item3'
});
console.log(collection); 
```

只有在这个示例中带有“0”和“1”键的项目才会进入集合的开头，但你可以看到这个想法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T15:19:50.733

假设您的数据结构看起来像这样

```
[
  {
    title: "item 1",
    nodes: [
      {title: "item a",
        nodes: [
          {title: "item i"},
          {title: "item ii"}
        ]
      },
      {title: "item b"
      }
    ]
  },
  {
    title: "item 2"
  }
] 
```

您可以通过覆盖模型的 parse 方法来设置层次结构：

```
var Node = Backbone.Model.extend({
  parse: function(data) {
    this.nodes = new Nodes(data.nodes, {parse: true});
    return _.omit(data, 'nodes');
  }
});

var Nodes = Backbone.Collection.extend({
  model: Node
});

var c = new Nodes(data_structure, {parse: true}); 
// parse: true is only needed if you pass the data as an argument 
```

`Node.parse`从数据哈希中提取`nodes`属性以在对象上构建自定义属性，然后返回其余属性以让 Backbone 处理其他属性。然后，您可以使用 访问该集合`model.nodes`。还有一个可以玩的小提琴[http://jsfiddle.net/C8HGY/](http://jsfiddle.net/C8HGY/)

# c# - DrawingGroup - 交叉线程

> ID：14187947
> 
> 赞同：1
> 
> 时间：2013-01-06T23:31:14.453
> 
> 标签：c#, wpf, thread-safety, drawing, multithreading

我有一个有两个字段和一些绘图方法的类：

```
public class DrawingTool
{
    private readonly DrawingGroup _drawingGroup;
    private DrawingImage _imageSource;

    public DrawingTool()
    {
        _drawingGroup = new DrawingGroup();
        _imageSource = new DrawingImage(_drawingGroup);
    }

    public DrawingImage GetImageSource()
    {
        return _imageSource;
    }

    public void DrawSomething()
    {
        using (DrawingContext dc = _drawingGroup.Open()) // HERE'S AN ERROR - _drawing group is being used by another thread (InvalidOperationException)
        {
           // draw something here
        }
    }
} 
```

这是一个`WPF`项目，所以我也有一个`Image`：

```
<Image x:Name="MyImage" Width="320" Height="240"></Image> 
```

我设置了来源：

```
_drawingTool = new DrawingTool();
Dispatcher.Invoke(() => MyImage.Source = _drawingTool.GetImageSource());

_device.FrameReady += (sender, args) => Dispatcher.Invoke(() =>
{
    _drawingTool.DrawSomething();
}); 
```

我从评论中得到一个错误......我试图调用`DrawSomething()`方法并`CheckAccess()`在`_drawingGroup`内部使用`DrawSomething()`- 没有帮助。如何使其工作成为可能？提前感谢您的帮助！

**[编辑 1.]**
也许我应该使用不同于`DrawingGroup`?

**[编辑 2.]**
没人知道吗？:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T21:15:12.943

好的，我找到了解决方案......这真的很明显......我必须在主线程中（在主窗口构造函数中）初始化整个绘图工具，然后设置`MyImage.Source`（也在同一个地方）。现在一切都会好起来的！:)

# asp.net-mvc - 多个文件上传多次复制一个文件

> ID：14187948
> 
> 赞同：0
> 
> 时间：2013-01-06T23:31:32.660
> 
> 标签：asp.net-mvc, file-upload

我正在尝试上传多个文件并在视图中遍历它们。但不是上传 X 个文件，而是多次上传第一个文件 X 次（例如，如果我上传了 3 个文件，则上传 3 次）。在目标文件夹中，仅保存一个文件。

它似乎可以识别存在的文件数量，那么为什么不遍历它们呢？

我应该提一下，我对 asp.net/c# 很陌生（更习惯于经典/vb），所以如果我遗漏了一些明显的东西，我深表歉意......

# 代码：

```
public class ViewDataUploadFilesResult
{
    public string Name { get; set; }
    public int Length { get; set; }
}

public ActionResult UploadMultipleFiles()
{
    var r = new List<ViewDataUploadFilesResult>();

    foreach (string file in Request.Files)
    {
        HttpPostedFileBase hpf = Request.Files[file];//as HttpPostedFileBase;
        if (hpf.ContentLength == 0)
            continue;

        string basepath = Server.MapPath("/Images");
        string savedFileName = Path.Combine(basepath, Path.GetFileName(hpf.FileName));

        hpf.SaveAs(savedFileName);

        r.Add(new ViewDataUploadFilesResult()
        {
            Name = savedFileName,
            Length = hpf.ContentLength
        });
    }          
    return View(r);
} 
```

# 示例结果：

```
 <li>Uploaded: C:\Users...sonatrach.jpg totalling 3581 bytes.</li>
    <li>Uploaded: C:\Users...sonatrach.jpg totalling 3581 bytes.</li>
    <li>Uploaded: C:\Users...sonatrach.jpg totalling 3581 bytes.</li> 
```

我一直在研究 Scott Hanselman 的帖子：[http ://www.hanselman.com/blog/ABackToBasicsCaseStudyImplementingHTTPFileUploadWithASPNETMVCIncludingTestsAndMocks.aspx](http://www.hanselman.com/blog/ABackToBasicsCaseStudyImplementingHTTPFileUploadWithASPNETMVCIncludingTestsAndMocks.aspx)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T00:17:41.793

可能不是您正在寻找的答案，但我会推荐一种不同的方法。那篇博文很老了。我使用[plupload jquery 插件](http://www.plupload.com/)进行多文件上传。非常容易使用，非常容易实现。这是在另一个问题中发布的关于如何使用 MVC 实现的示例。在示例中，将为您尝试上传的每个文件调用 Upload 方法。

[在 MVC3 中使用 plupload](https://stackoverflow.com/questions/6094296/using-plupload-with-mvc3)

希望有帮助。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-07T00:49:08.157

这可能无法回答您的问题，但它是另一种上传文件的方式。

尝试这个：

```
[HttpPost]
public ActionResult Upload(IEnumerable<HttpPostedFileBase> files)
{
    if (files != null && files.Count() > 0)
    {
        foreach (var uploadedFile in files)
        {
            if (uploadedFile.ContentType != "image/vnd.dwg") 
            {
                return RedirectToAction("List");
            }

            var appData = Server.MapPath("~/app_data");
            var filename = Path.Combine(appData, Path.GetFileName(uploadedFile.FileName));
            uploadedFile.SaveAs(filename);                    
        }
    }

    return RedirectToAction("Success");
} 
```

并修改标记，使文件输入命名为文件：

```
<input type="file" name="files" />
<input type="file" name="files" />
...// many inputs type file 
```

“最初由 Darin Dimitrov 发布”，链接：[使用 C# 和 MVC3 的 HttpFileCollectionBase 问题上传多个文件](https://stackoverflow.com/questions/9500550/upload-multiple-files-using-httpfilecollectionbase-issue-with-c-sharp-and-mvc3)

# java - 如何避免实例化？

> ID：14187954
> 
> 赞同：1
> 
> 时间：2013-01-06T23:32:16.923
> 
> 标签：java

> **可能重复：**
> [这里的 instanceof 检查有什么问题吗？](https://stackoverflow.com/questions/13204215/anything-wrong-with-instanceof-checks-here)

我有这个代码

```
public static int getNumberOfOwned(Player owner, String type){
    int count = 0;      
    for (Field f: board.fieldList)
        if (type == "Shipping" && f instanceof Shipping) 
            if (((Shipping)f).getOwnedBy() == owner)
                count++;
        else if (type == "Brewery" && f instanceof Brewery) 
            if (((Brewery)f).getOwnedBy() == owner)
                count++;
    return count;
} 
```

我不认为这是非常优雅和未来的证明。我怎样才能避免那些 instanceof 运算符。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T23:37:33.447

您始终可以使用枚举，并使用`Field`返回类型的方法。在这里，我将进一步推测您*不想*更新某些类型的计数，因此枚举也被“装饰”了一个布尔值，表示：

```
enum FieldType {
    SHIPPING(true),
    BREWERY(true),
    NOTME(false);

    private final boolean countUpdate;

    FieldType(boolean countUpdate) { this.countUpdate = countUpdate; }
    public boolean mustUpdateCount() { return countUpdate; }
};

abstract class Field {
    protected final FieldType type;
    protected Field(FieldType type) { this.type = type; }
    public final FieldType getType() { return type; }
    public final boolean mustUpdateCount() { return type.mustUpdateCount(); }
}

class Brewery implements Field {
    Brewery() {
        super(BREWERY);
    }
} 
```

并在您的代码中：

```
FieldType expectedType = Enum.valueOf(type.toUpperCase());

for (Field f: board.fieldlist) {
    if (field.getType() != expectedType)
        continue;
    if (!f.getOwnedBy().equals(owner))
        continue;
    // Correct type, owned by the correct guy:
    // check that we must update; if so, update
    if (expectedType.mustUpdateCount())
        count++;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T23:38:01.623

由于`Shipping`和`Brewery`派生自`Field`，`Field`因此可以提供一个告诉您其类型的 getter，例如`getFieldType()`. 当`Shipping`或`Brewery`被实例化时，它们会设置适当的值，或者您将它们`getFieldType()`抽象化并拥有`Shipping`并`Brewery`实现它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-06T23:41:09.590

`Shipping.class`将或传递`Brewery.class`给您的函数，而不是代表该类的字符串，并检查您的 Field 是否属于该类：

```
public static int getNumberOfOwned(Player owner, Class<? extends Field> type){
    int count = 0;      
    for (Field f: board.fieldList) {
        if (type.isInstance(f) && f.getOwnedBy() == owner) {
            count++;
        }   
    }
    return count;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-06T23:45:12.373

最好的解决方案是使用访问者模式来解决这个问题，你可以在这里查看：[访问者模式](http://en.wikipedia.org/wiki/Visitor_pattern)

至少它是处理问题的面向对象的方式，但它肯定需要比您当前的解决方案更多的编码。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-06T23:38:50.730

将“ `isType(String type)`”方法添加到字段。就此而言，也将“ `isOwnedBy(String owner)`”添加到 Field 中。

```
for (Field f: board.fieldList)
    if (f.isType(type) && f.isOwnedBy(owner))
        count++;
return count; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-06T23:47:09.030

首先建议您使用“==”运算符来测试对象的相等性，这在大多数情况下都是错误的，在这种情况下肯定是错误的:)

如果您想确定一个对象是否属于特定类型，您可以使用 instanceof 运算符，查看它们是否具有相同的类引用（在这里您可以使用“==”运算符）或尝试强制转换并检查异常，最后一个选项更像是一种幻想，因为在现实世界中你不应该尝试这个。

我不太确定你要做什么，但你绝对可以定制你的对象以避免 instanceof/class/cast 的东西，比如：

```
class Foxtrot implements Sub {
    private  SubType type = SubType.ATACK;

    public SubType getType() {
        return type;
    }
}

interface Sub {
    enum SubType{ ATACK, BOOMER }

    public SubType getType();
} 
```

您可以将对象视为 Sub 接口的实现，并使用他们的 getType() 方法检查它们是什么类型，它应该几乎可以工作。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2013-01-06T23:42:27.763

你应该重写这段代码

1) 类字段添加方法getType()；

2）代码：

```
public static int getNumberOfOwned(Player owner, String type){
  int count = 0;      
  for (Field f: board.fieldList){
    if (f.getType.equals(type)&& f.getOwnedBy().equesl(owner))
    count++;
  }
  return count; 
```

}

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2013-01-06T23:43:09.540

`string getTypeString()`创建 Field 的属性，并避免使用一堆 if 语句（检查）使`type.equals(f.getTypeString())`getOwnedBy 成为 Field 的属性，并且不要使用强制转换。（没有所有者的字段可以返回 null）

# java - 另一个与 Java CRC32 实现相关的问题

> ID：14187955
> 
> 赞同：0
> 
> 时间：2013-01-06T23:32:19.810
> 
> 标签：java, crc32

我的问题是使用此[实现](http://www.jonh.net/~jonh/md5/CRC32.java)时；Java CRC32 计算不同于 C# 使用查找表的 CRC32 计算。

以下是我正在使用的 CRC32 代码：

```
public static int CalculateCRCWithTable(byte[] data){
    int crc = 0;
    for (byte b : data) {
        crc = CRCTable[(crc & 0xff) ^ (b & 0xff)] ^ (crc >>> 8) ;
    }
    //crc = crc ^ 0xffffffff; // flip bit/sign
    return (crc);       
} 
```

从文件中读取：

```
public static byte[] readFromFileToByteArray(String fileName) throws IOException {
    BufferedInputStream fis = new BufferedInputStream(new FileInputStream(fileName));
    byte [] bytes = IOUtils.toByteArray(fis);
    for (byte b : bytes){
        b = (byte) (b & 0xff);          
    }
    return bytes;       
} 
```

当用一个简单的文本文件测试 Java CRC32 计算时，CRC 计算（有时）是正确的，与 C# 相同，但指向一个可执行/二进制文件，然后我开始看到不同的结果。

（将示例数据从评论移到问题部分）： 字符串：“简单 CRC32 计算测试” 十六进制值：

```
73 69 6D 70 6C 65 20 43 52 43 33 32 20 63 61 6C 63 75 6C 61 74 69 6F 6E 20 74 65 73 74 
```

两者都使用查找表实现：

*   “预期/正确”C# 的 CRC32 计算：3347067236
*   Java CRC32 计算：-947900060

在一个类似的线程中，有人提到为 Java 实现无符号整数 32 应该可以解决这个问题。

任何指针将不胜感激，谢谢。

已解决：感谢 Mark 的验证！考虑到这一点，只需以下内容即可获得正确的 CRC32 计算：

```
String tmp = Integer.toHexString(crc);      
long lCRC = Long.parseLong(tmp, 16); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-07T18:47:09.513

您在评论中提供的两个值（它们应该移到问题中）在它们的低 32 位中完全相等。3347067236 = 2 ^(32) - 947900060。它们都是 0xc7803164。你没有问题。

# node.js - 从特定版本的 Git 安装 npm

> ID：14187956
> 
> 赞同：214
> 
> 时间：2013-01-06T23:32:25.113
> 
> 标签：node.js, npm

假设我已经为 Node.js 编写了一个我想保密的模块。我知道我可以（应该）添加以下行：

```
"private": "true" 
```

到`package.json`文件，我也知道我可以`npm install`使用文件系统路径或指向 git 存储库（包括 GitHub）的链接来使用此模块。

我也知道我可以将这样的文件系统路径或指向 git repo 的链接放入`package.json`中，因此该`dependencies`部分可能看起来像这样：

```
"dependencies": {
  "myprivatemodule": "git@github.com:..."
} 
```

我现在想要的不是链接到最新版本，而是链接到特定版本。我知道的唯一可能性是使用其 ID 链接到特定提交。但这比使用版本号（例如`0.3.1`.

所以我的问题是：是否可以指定这样的版本号并让 npm 在 git 存储库中搜索包含此版本的最新提交？

如果没有，您如何在您的项目中解决此问题？您是否使用提交 ID，或者是否有更好的解决方案？

* * *

## 回答 #1

> 赞同：280
> 
> 时间：2013-08-05T02:09:13.007

接受的答案对我不起作用。这是我从 github 拉包的操作：

```
npm install --save "git://github.com/username/package.git#commit" 
```

或者在 package.json 上手动添加：

```
"dependencies": {
  "package": "git://github.com/username/package.git#commit"
} 
```

* * *

## 回答 #2

> 赞同：222
> 
> 时间：2013-01-06T23:54:56.633

必须通过[指定](https://docs.npmjs.com/files/package.json#dependencies)[描述符](https://docs.npmjs.com/files/package.json#dependencies)来安装依赖[项](https://docs.npmjs.com/files/package.json#dependencies)。[`registry`](https://docs.npmjs.com/misc/registry)[`version`](https://docs.npmjs.com/files/package.json#dependencies)

如果您的项目不应该公开共享，您当然可以[创建和使用自己的注册表。](https://docs.npmjs.com/misc/registry#can-i-run-my-own-private-registry)[`registry.npmjs.org`](http://registry.npmjs.org/)

但是，如果它不在注册表中，则必须通过[URL](https://docs.npmjs.com/files/package.json#urls-as-dependencies)或[Git URL](https://docs.npmjs.com/files/package.json#git-urls-as-dependencies)引用它。要使用 Git URL 指定版本，请在末尾包含适当的[`<commit-ish>`](https://www.kernel.org/pub/software/scm/git/docs/#_identifier_terminology)，例如标签，作为[URL 片段](https://en.wikipedia.org/wiki/Fragment_identifier)。

例如，对于名为 的标签`0.3.1`：

```
"dependencies": {
  "myprivatemodule": "git@github.com:...#0.3.1"
} 
```

> **注意**：上面的代码片段显示的基本 URL 与问题中发布的相同。
> 
> 剪断部分（`...`）应填写：
> 
> ```
> "myprivatemodule": "git@github.com:{owner}/{project}.git#0.3.1" 
> ```
> 
> 而且，当 SSH 访问不可用时，将需要不同的地址格式：
> 
> ```
> "myprivatemodule": "git://github.com/{owner}/{project}.git#0.3.1" 
> ```

* * *

根据您的操作系统，您还可以[`link`](https://docs.npmjs.com/cli/link)在另一个文件夹中找到从 Github 克隆的依赖项。

* * *

## 回答 #3

> 赞同：85
> 
> 时间：2014-12-24T01:14:37.137

如果版本是指标签或版本，那么 github 会为这些提供下载链接。例如，如果我想安装[fetch](https://github.com/github/fetch)版本 0.3.2（它在 npm 上不可用），那么我添加到我的`package.json`under `dependencies`：

```
"fetch": "https://github.com/github/fetch/archive/v0.3.2.tar.gz", 
```

与提交散列方法相比，唯一的缺点是散列保证不代表更改的代码，而标签可以被替换。幸好这种情况很少发生。

**更新：**

这些天来，我使用的方法是 GitHub 服务依赖项的紧凑表示法：

```
"dependencies": {
  "package": "github:username/package#commit"
} 
```

提交可以是任何提交的东西，比如标签。对于 GitHub，您甚至可以删除首字母`github:`，因为它是默认值。

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2018-07-27T14:34:33.980

`username/package`此命令从特定的 git commit安装 npm 包：

```
npm install https://github.com/username/package#3d0a21cc 
```

这`3d0a21cc`是提交哈希的前 8 个字符。

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2018-03-03T06:08:56.477

[我对上面](https://stackoverflow.com/a/27630247/241296)@qubyte 的示例评论被砍掉了，所以这里有一些更容易阅读的东西......

[上面](https://stackoverflow.com/a/18049685/241296)描述的@surjikal 方法适用于分支提交，但它不适用于我尝试包含的*树提交。*

* * *

归档模式也适用于提交。比如[取](https://github.com/github/fetch)@a2fbf83

**npm**：

```
npm install  https://github.com/github/fetch/archive/a2fbf834773b8dc20eef83bb53d081863d3fc87f.tar.gz 
```

**纱线**：

```
yarn add  https://github.com/github/fetch/archive/a2fbf834773b8dc20eef83bb53d081863d3fc87f.tar.gz 
```

**格式**：

```
 https://github.com/<owner>/<repo>/archive/<commit-id>.tar.gz 
```

* * *

这是需要该模式的*树提交：*`/archive/`

```
yarn add  https://github.com/vuejs/vuex/archive/c3626f779b8ea902789dd1c4417cb7d7ef09b557.tar.gz 
```

对于相关的[vuex 提交](https://github.com/vuejs/vuex/tree/c3626f779b8ea902789dd1c4417cb7d7ef09b557)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2020-05-06T17:25:25.330

我需要运行两个版本的[tfjs-core](https://github.com/tensorflow/tfjs-core)，发现都需要在安装后构建。

包.json：

```
"dependencies": {
  "tfjs-core-0.14.3": "git://github.com/tensorflow/tfjs-core#bb0a830b3bda1461327f083ceb3f889117209db2",
  "tfjs-core-1.1.0": "git://github.com/tensorflow/tfjs-core#220660ed8b9a252f9d0847a4f4e3c76ba5188669"
} 
```

然后：

```
cd node_modules/tfjs-core-0.14.3 && yarn install && yarn build-npm && cd ../../
cd node_modules/tfjs-core-1.1.0  && yarn install && yarn build-npm && cd ../../ 
```

最后，使用库：

```
import * as tf0143 from '../node_modules/tfjs-core-0.14.3/dist/tf-core.min.js';
import * as tf110 from '../node_modules/tfjs-core-1.1.0/dist/tf-core.min.js'; 
```

这很好用，但肯定是#hoodrat

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2019-01-23T19:53:05.650

我在这里描述了我在运行时遇到的一个问题`npm install`——包没有出现在`node_modules`.

问题是已安装包的`name`值`package.json`与导入包的名称不同（`package.json`我的项目的键）。

因此，如果您安装的项目名称是`some-package`(name value in its `package.json`)，那么在`package.json`您的项目中写入：`"some-package": "owner/some-repo#tag"`。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-01-07T13:44:41.987

如果您使用多个模块执行此操作并希望对版本有更多控制权，您应该考虑拥有自己的私有 npm 注册表。

通过这种方式，您可以将您的模块发布到您的私有 npm 注册表，并以与公共模块相同的方式使用 package.json 条目。

[https://docs.npmjs.com/files/package.json#dependencies](https://docs.npmjs.com/files/package.json#dependencies)

# ios - 强制设置NeedsDisplay

> ID：14187961
> 
> 赞同：0
> 
> 时间：2013-01-06T23:33:03.937
> 
> 标签：ios, cocoa-touch, uikit, setneedsdisplay

我有一个使用 CoreGraphics 和 drawRect 绘制齿轮的例程。我使用了一个按钮来推进这些阶段的齿轮：

-(IBAction)advanceButtonPressed:(id)sender{

```
stage=stage+1;

if (stage==4) stage=0;

[self setNeedsDisplay]; 
```

}

绘制齿轮的例程在drawRect中，根据stage的vale将轮齿绘制到新的位置，传给drawRect。在四个步骤中，每个按钮按下一个，齿轮转到新位置（围绕圆圈的一个部分。）

我更改了 buttonPressed 例程，让它循环执行四个阶段，所以我只需要按一次按钮，但它不起作用：

-(IBAction)buttonPressed:(id)sender{

```
for (stage=0;stage<4;stage++){

    NSLog(@"%i",stage);

[self setNeedsDisplay];
} 
```

}

我的 NSLog 显示该阶段经历了它的四个值，就像在前面的例程中一样。但是 setNeedsDisplay 只执行一次（正如 drawRect 中的 NSLog 跟踪所证实的那样），因此齿轮显示在其最终位置，而不是中间阶段。看起来 setNeedsDisplay 仅在按钮例程完成时才执行，尽管它位于循环内。

有没有办法强制它执行？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T23:49:58.383

无论你多久打电话，iPhone 每秒只更新 60 次屏幕`setNeedsDisplay`。您的循环将在不到 1/60 秒的时间内执行。这就是为什么你只会看到最后一个状态。

如果您想通过一个按钮显示所有四种状态，那么您可以使用计时器或`performSelector: afterDelay`显示所有四种状态。有点复杂，但你去。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-01-06T23:41:40.820

调用 setNeedsDisplay 只是标记要在下一个绘图周期重绘的视图。

要在您的方法期间重绘它，您可以显式调用 drawRect：

# android - 捕捉 Android 随机崩溃提示

> ID：14187962
> 
> 赞同：1
> 
> 时间：2013-01-06T23:33:08.360
> 
> 标签：android, testing, random, crash

我的测试团队抱怨他们在我的 Android 应用程序中遇到无法重现的随机崩溃。了解这些崩溃原因的最佳方法是什么？Flurry 和其他分析工具不会将整个崩溃日志发送给我，它们只会发送几行无济于事的信息。

捕捉这些随机崩溃原因的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T23:37:29.467

我认为他们必须使用 Play 商店中的 LogCat 应用程序。例如： [aLogcat（免费）- logcat](https://play.google.com/store/apps/details?id=org.jtb.alogcat)。崩溃后，他们可以查看 LogCat 信息并与您共享。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T05:39:44.330

您可以做的一件非常好的事情是为主 UI 线程设置您自己的[UncaughtExceptionHandler](https://developer.android.com/reference/java/lang/Thread.UncaughtExceptionHandler.html)并将您需要的所有信息发送到您的网络服务或 GoogleAlalytics（v.2 Analytics 具有适用于 Android 设备的此类功能）。

如果您没有自己的网络服务，您可以集成第三方服务，例如[HockeApp](http://hockeyapp.net)。它执行几乎相同的操作，但“开箱即用”，您只需在应用程序中编写一行代码。

希望对你有帮助！

# javafx - 传递参数 JavaFX FXML

> ID：14187963
> 
> 赞同：216
> 
> 时间：2013-01-06T23:33:12.743
> 
> 标签：javafx, parameters, dependency-injection, parameter-passing, fxml

如何将参数传递给 javafx 中的辅助窗口？有没有办法与相应的控制器进行通信？

例如：用户从 a 中选择一个客户`TableView`并打开一个新窗口，显示客户的信息。

```
Stage newStage = new Stage();
try 
{
    AnchorPane page = (AnchorPane) FXMLLoader.load(HectorGestion.class.getResource(fxmlResource));
    Scene scene = new Scene(page);
    newStage.setScene(scene);
    newStage.setTitle(windowTitle);
    newStage.setResizable(isResizable);
    if(showRightAway) 
    {
        newStage.show();
    }
} 
```

`newStage`将是新的窗口。问题是，我找不到告诉控制器在哪里查找客户信息的方法（通过将 id 作为参数传递）。

有任何想法吗？

* * *

## 回答 #1

> 赞同：298
> 
> 时间：2013-01-07T05:19:27.600

**使用 MVC**

这个答案的大部分集中在直接调用以将参数从调用类传递给控制器​​。

相反，如果您想将调用者和控制器解耦并使用更通用的架构，该架构涉及具有可设置和可侦听属性的模型类来实现控制器间通信，请参阅以下基本概述：

*   [使用 JavaFx 应用 MVC](https://stackoverflow.com/questions/32342864/applying-mvc-with-javafx)

**推荐方法**

这个答案列举了将参数传递给 FXML 控制器的不同机制。

对于小型应用程序，我强烈建议将参数直接从调用者传递给控制器​​——它简单、直接且不需要额外的框架。

对于更大、更复杂的应用程序，如果您想在应用程序中使用[依赖注入](http://www.martinfowler.com/articles/injection.html)或[事件总线](https://github.com/google/guava/wiki/EventBusExplained)机制，则值得研究一下。

**将参数直接从调用者传递给控制器**

通过从 FXML 加载器实例中检索控制器并调用控制器上的方法以使用所需的数据值对其进行初始化，将自定义数据传递给 FXML 控制器。

类似于以下代码：

```
public Stage showCustomerDialog(Customer customer) {
  FXMLLoader loader = new FXMLLoader(
    getClass().getResource(
      "customerDialog.fxml"
    )
  );

  Stage stage = new Stage(StageStyle.DECORATED);
  stage.setScene(
    new Scene(loader.load())
  );

  CustomerDialogController controller = loader.getController();
  controller.initData(customer);

  stage.show();

  return stage;
}

...

class CustomerDialogController {
  @FXML private Label customerName;
  void initialize() {}
  void initData(Customer customer) {
    customerName.setText(customer.getName());
  }
} 
```

如示例代码所示，构造了一个新的 FXMLLoader，即`new FXMLLoader(location)`. 该位置是一个 URL，您可以通过以下方式从 FXML 资源生成这样的 URL：

```
new FXMLLoader(getClass().getResource("sample.fxml")); 
```

*注意不要在 FXMLLoader 上使用静态加载函数，否则您将无法从加载器实例中获取控制器。*

FXMLLoader 实例本身从不了解域对象。您不直接将应用程序特定的域对象传递给 FXMLLoader 构造函数，而是：

1.  在指定位置基于 fxml 标记构造 FXMLLoader
2.  从 FXMLLoader 实例中获取控制器。
3.  在检索到的控制器上调用方法以向控制器提供对域对象的引用。

此博客（由另一位作者撰写）提供了一个替代但类似的[示例](https://web.archive.org/web/20160612045146/http://ed4becky.net/homepage/javafx-from-the-trenches-singleton-controllers/)。

**在 FXMLLoader 上设置控制器**

```
CustomerDialogController dialogController = 
    new CustomerDialogController(param1, param2);

FXMLLoader loader = new FXMLLoader(
    getClass().getResource(
        "customerDialog.fxml"
    )
);
loader.setController(dialogController);

Pane mainPane = loader.load(); 
```

您可以在代码中构造一个新的控制器，将您想要的任何参数从调用者传递到控制器构造函数中。构造控制器后，您可以在调用*实例*方法*之前将其设置在 FXMLLoader 实例上。*`load()`

 **要在加载器上设置控制器（在 JavaFX 2.x 中），您也不能`fx:controller`在 fxml 文件中定义属性。*

由于 FXML 中定义的限制`fx:controller`，我个人更喜欢从 FXMLLoader 中获取控制器，而不是将控制器设置到 FXMLLoader 中。

**让控制器从外部静态方法中检索参数**

[Sergey在 Controller.java 文件中对 Javafx 2.0 How-to Application.getParameters()](https://stackoverflow.com/a/10136403/1155209)的回答举例说明了此方法。

**使用依赖注入**

FXMLLoader 通过允许您在 FXMLLoader 上设置自定义控制器工厂来支持 Guice、Spring 或 Java EE CDI 等依赖注入系统。这提供了一个回调，您可以使用该回调创建具有由相应依赖注入系统注入的依赖值的控制器实例。

答案中提供了使用 Spring 进行 JavaFX 应用程序和控制器依赖注入的示例：

*   [在 JavaFX (JPA Repo, Service) 中添加 Spring 依赖注入](https://stackoverflow.com/questions/57887944/adding-spring-dependency-injection-in-javafx-jpa-repo-service)

[afterburner.fx 框架](https://github.com/AdamBien/afterburner.fx)与使用它的示例[air-hacks 应用程序](https://github.com/AdamBien/airhacks-control)举例说明了一种非常好的、干净的依赖注入方法。afterburner.fx 依赖于 JEE6 [javax.inject](http://docs.oracle.com/javaee/6/api/javax/inject/package-summary.html)来执行依赖注入。

**使用事件总线**

Greg Brown，最初的 FXML 规范创建者和实现者，经常建议考虑使用事件总线，例如 Guava [EventBus](https://github.com/google/guava/wiki/EventBusExplained)，在 FXML 实例化控制器和其他应用程序逻辑之间进行通信。

> EventBus 是一个简单但功能强大的发布/订阅 API，带有注释，允许 POJO 在 JVM 中的任何位置相互通信，而无需相互引用。

**后续问答**

> 在第一种方法上，为什么要返回 Stage？该方法也可以是无效的，因为您已经给出了命令 show(); 就在返回阶段之前；。您如何通过返回 Stage 来计划使用情况

它是解决问题的功能性解决方案。从`showCustomerDialog`函数返回一个阶段，以便外部类可以存储对它的引用，该类可能希望稍后执行某些操作，例如基于在主窗口中单击按钮来隐藏阶段。另一种面向对象的解决方案可以将功能和阶段引用封装在 CustomerDialog 对象中，或者让 CustomerDialog 扩展阶段。封装 FXML、控制器和模型数据的自定义对话框的面向对象接口的完整示例超出了此答案的范围，但对于任何倾向于创建的人来说，这可能是一篇有价值的博文。

* * *

**[由名为@dzim](https://stackoverflow.com/users/1281217/bgmf)的 StackOverflow 用户提供的附加信息**

*Spring Boot 依赖注入示例*

关于如何做到这一点“Spring Boot 方式”的问题，有一个关于 JavaFX 2 的讨论，我在附加的永久链接中回答了这个问题。该方法仍然有效，并于 2016 年 3 月在 Spring Boot v1.3.3.RELEASE 上进行了测试： [https ://stackoverflow.com/a/36310391/1281217](https://stackoverflow.com/a/36310391/1281217)

* * *

有时，您可能希望将结果传回给调用者，在这种情况下，您可以查看相关问题的答案：

*   [JavaFX FXML 参数从控制器 A 传递到 B 并返回](https://stackoverflow.com/questions/48173320/javafx-fxml-parameter-passing-from-controller-a-to-b-and-back/48217255#48217255)

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2018-06-26T20:14:22.230

> 我意识到这是一篇非常古老的帖子，并且已经有了一些很好的答案，但我想制作一个简单的 MCVE 来演示一种这样的方法，并让新的编码人员能够快速看到这个概念的实际应用。

在本例中，我们将使用 5 个文件：

1.  **Main.java** - 仅用于启动应用程序并调用第一个控制器。
2.  **Controller1.java** - 第一个 FXML 布局的控制器。
3.  **Controller2.java** - 第二个 FXML 布局的控制器。
4.  **Layout1.fxml** - 第一个场景的 FXML 布局。
5.  **Layout2.fxml** - 第二个场景的 FXML 布局。

*所有文件都在这篇文章的底部完整列出。*

**目标：**演示从`Controller1`to传递值，`Controller2`反之亦然。

**程序流程：**

*   第一个场景包含 a `TextField`、 a`Button`和 a `Label`。单击时`Button`，将加载并显示第二个窗口，包括在`TextField`.
*   在第二个场景中，还有 a `TextField`、 a`Button`和 a `Label`。将`Label`显示在`TextField`第一个场景中输入的文本。
*   在第二个场景中输入文本`TextField`并单击其后`Button`，第一个场景`Label`会更新以显示输入的文本。

这是一个非常简单的演示，肯定可以代表一些改进，但应该使概念非常清晰。

代码本身也有一些关于正在发生的事情和如何发生的细节的注释。

> **编码**

**主.java：**

```
import javafx.application.Application;
import javafx.stage.Stage;

public class Main extends Application {

    public static void main(String[] args) {
        launch(args);
    }

    @Override
    public void start(Stage primaryStage) {

        // Create the first controller, which loads Layout1.fxml within its own constructor
        Controller1 controller1 = new Controller1();

        // Show the new stage
        controller1.showStage();

    }
} 
```

**控制器1.java：**

```
import javafx.fxml.FXML;
import javafx.fxml.FXMLLoader;
import javafx.scene.Scene;
import javafx.scene.control.Button;
import javafx.scene.control.Label;
import javafx.scene.control.TextField;
import javafx.stage.Stage;

import java.io.IOException;

public class Controller1 {

    // Holds this controller's Stage
    private final Stage thisStage;

    // Define the nodes from the Layout1.fxml file. This allows them to be referenced within the controller
    @FXML
    private TextField txtToSecondController;
    @FXML
    private Button btnOpenLayout2;
    @FXML
    private Label lblFromController2;

    public Controller1() {

        // Create the new stage
        thisStage = new Stage();

        // Load the FXML file
        try {
            FXMLLoader loader = new FXMLLoader(getClass().getResource("Layout1.fxml"));

            // Set this class as the controller
            loader.setController(this);

            // Load the scene
            thisStage.setScene(new Scene(loader.load()));

            // Setup the window/stage
            thisStage.setTitle("Passing Controllers Example - Layout1");

        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    /**
     * Show the stage that was loaded in the constructor
     */
    public void showStage() {
        thisStage.showAndWait();
    }

    /**
     * The initialize() method allows you set setup your scene, adding actions, configuring nodes, etc.
     */
    @FXML
    private void initialize() {

        // Add an action for the "Open Layout2" button
        btnOpenLayout2.setOnAction(event -> openLayout2());
    }

    /**
     * Performs the action of loading and showing Layout2
     */
    private void openLayout2() {

        // Create the second controller, which loads its own FXML file. We pass a reference to this controller
        // using the keyword [this]; that allows the second controller to access the methods contained in here.
        Controller2 controller2 = new Controller2(this);

        // Show the new stage/window
        controller2.showStage();

    }

    /**
     * Returns the text entered into txtToSecondController. This allows other controllers/classes to view that data.
     */
    public String getEnteredText() {
        return txtToSecondController.getText();
    }

    /**
     * Allows other controllers to set the text of this layout's Label
     */
    public void setTextFromController2(String text) {
        lblFromController2.setText(text);
    }
} 
```

**控制器2.java：**

```
import javafx.fxml.FXML;
import javafx.fxml.FXMLLoader;
import javafx.scene.Scene;
import javafx.scene.control.Button;
import javafx.scene.control.Label;
import javafx.scene.control.TextField;
import javafx.stage.Stage;

import java.io.IOException;

public class Controller2 {

    // Holds this controller's Stage
    private Stage thisStage;

    // Will hold a reference to the first controller, allowing us to access the methods found there.
    private final Controller1 controller1;

    // Add references to the controls in Layout2.fxml
    @FXML
    private Label lblFromController1;
    @FXML
    private TextField txtToFirstController;
    @FXML
    private Button btnSetLayout1Text;

    public Controller2(Controller1 controller1) {
        // We received the first controller, now let's make it usable throughout this controller.
        this.controller1 = controller1;

        // Create the new stage
        thisStage = new Stage();

        // Load the FXML file
        try {
            FXMLLoader loader = new FXMLLoader(getClass().getResource("Layout2.fxml"));

            // Set this class as the controller
            loader.setController(this);

            // Load the scene
            thisStage.setScene(new Scene(loader.load()));

            // Setup the window/stage
            thisStage.setTitle("Passing Controllers Example - Layout2");

        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    /**
     * Show the stage that was loaded in the constructor
     */
    public void showStage() {
        thisStage.showAndWait();
    }

    @FXML
    private void initialize() {

        // Set the label to whatever the text entered on Layout1 is
        lblFromController1.setText(controller1.getEnteredText());

        // Set the action for the button
        btnSetLayout1Text.setOnAction(event -> setTextOnLayout1());
    }

    /**
     * Calls the "setTextFromController2()" method on the first controller to update its Label
     */
    private void setTextOnLayout1() {
        controller1.setTextFromController2(txtToFirstController.getText());
    }

} 
```

**布局1.fxml：**

```
<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.AnchorPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.VBox?>
<AnchorPane xmlns="http://javafx.com/javafx/9.0.1" xmlns:fx="http://javafx.com/fxml/1">
    <VBox alignment="CENTER" spacing="10.0">
        <padding>
            <Insets bottom="10.0" left="10.0" right="10.0" top="10.0"/>
        </padding>
        <Label style="-fx-font-weight: bold;" text="This is Layout1!"/>
        <HBox alignment="CENTER_LEFT" spacing="10.0">
            <Label text="Enter Text:"/>
            <TextField fx:id="txtToSecondController"/>
            <Button fx:id="btnOpenLayout2" mnemonicParsing="false" text="Open Layout2"/>
        </HBox>
        <VBox alignment="CENTER">
            <Label text="Text From Controller2:"/>
            <Label fx:id="lblFromController2" text="Nothing Yet!"/>
        </VBox>
    </VBox>
</AnchorPane> 
```

**布局2.fxml：**

```
<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.AnchorPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.VBox?>
<AnchorPane xmlns="http://javafx.com/javafx/9.0.1" xmlns:fx="http://javafx.com/fxml/1">
    <VBox alignment="CENTER" spacing="10.0">
        <padding>
            <Insets bottom="10.0" left="10.0" right="10.0" top="10.0"/>
        </padding>
        <Label style="-fx-font-weight: bold;" text="Welcome to Layout 2!"/>
        <VBox alignment="CENTER">
            <Label text="Text From Controller1:"/>
            <Label fx:id="lblFromController1" text="Nothing Yet!"/>
        </VBox>
        <HBox alignment="CENTER_LEFT" spacing="10.0">
            <Label text="Enter Text:"/>
            <TextField fx:id="txtToFirstController"/>
            <Button fx:id="btnSetLayout1Text" mnemonicParsing="false" text="Set Text on Layout1"/>
        </HBox>
    </VBox>
</AnchorPane> 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2016-01-12T04:05:07.950

这是一个通过命名空间将参数传递给 fxml 文档的示例。

```
<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.VBox?>
<VBox xmlns="http://javafx.com/javafx/null" xmlns:fx="http://javafx.com/fxml/1">
    <BorderPane>
        <center>
            <Label text="$labelText"/>
        </center>
    </BorderPane>
</VBox> 
```

定义`External Text`命名空间变量的值`labelText`：

```
import javafx.application.Application;
import javafx.fxml.FXMLLoader;
import javafx.scene.Parent;
import javafx.scene.Scene;
import javafx.stage.Stage;

import java.io.IOException;

public class NamespaceParameterExampleApplication extends Application {

    public static void main(String[] args) {
        launch(args);
    }

    @Override
    public void start(Stage primaryStage) throws IOException {
        final FXMLLoader fxmlLoader = new FXMLLoader(getClass().getResource("namespace-parameter-example.fxml"));

        fxmlLoader.getNamespace()
                  .put("labelText", "External Text");

        final Parent root = fxmlLoader.load();

        primaryStage.setTitle("Namespace Parameter Example");
        primaryStage.setScene(new Scene(root, 400, 400));
        primaryStage.show();
    }
} 
```

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2013-01-07T00:02:20.303

javafx.scene.Node 类有一对方法 setUserData(Object) 和 Object getUserData()

您可以使用它来将您的信息添加到节点。

因此，您可以调用 page.setUserData(info);

如果设置了信息，控制器可以检查。此外，如果需要，您可以使用 ObjectProperty 进行反向数据传输。

在此处查看文档：http: [//docs.oracle.com/javafx/2/api/javafx/fxml/doc-files/introduction_to_fxml.html](http://docs.oracle.com/javafx/2/api/javafx/fxml/doc-files/introduction_to_fxml.html) 在短语“在第一个版本中，handleButtonAction() 被标记为@FXML允许控制器文档中定义的标记调用它。在第二个示例中，按钮字段被注释以允许加载器设置其值。initialize() 方法也被类似地注释。

因此，您需要将控制器与节点相关联，并为节点设置用户数据。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2016-04-28T22:25:12.743

**这工作..**

**请记住，当您第一次打印传递值时，您将得到 null，您可以在加载 Windows 后使用它，对于您想要为任何其他组件编写代码的所有内容都是如此。**

> 第一控制器

```
try {
    Stage st = new Stage();
    FXMLLoader loader = new FXMLLoader(getClass().getResource("/com/inty360/free/form/MainOnline.fxml"));

    Parent sceneMain = loader.load();

    MainOnlineController controller = loader.<MainOnlineController>getController();
    controller.initVariable(99L);

    Scene scene = new Scene(sceneMain);
    st.setScene(scene);
    st.setMaximized(true);
    st.setTitle("My App");
    st.show();
} catch (IOException ex) {
    Logger.getLogger(LoginController.class.getName()).log(Level.SEVERE, null, ex);
} 
```

> 另一个控制器

```
public void initVariable(Long id_usuario){
    this.id_usuario = id_usuario;
    label_usuario_nombre.setText(id_usuario.toString());
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-10-22T14:14:44.353

您必须创建一个上下文类。

```
public class Context {
    private final static Context instance = new Context();
    public static Context getInstance() {
        return instance;
    }

    private Connection con;
    public void setConnection(Connection con)
    {
        this.con=con;
    }
    public Connection getConnection() {
        return con;
    }

    private TabRoughController tabRough;
    public void setTabRough(TabRoughController tabRough) {
        this.tabRough=tabRough;
    }

    public TabRoughController getTabRough() {
        return tabRough;
    }
} 
```

您只需使用初始化设置控制器实例

```
Context.getInstance().setTabRough(this); 
```

您可以在整个应用程序中使用它，只需使用

```
TabRoughController cont=Context.getInstance().getTabRough(); 
```

现在您可以将参数从整个应用程序传递给任何控制器。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2019-01-31T12:17:49.160

是的你可以。
您需要添加第一个控制器：

```
YourController controller = loader.getController();     
controller.setclient(client); 
```

然后在第二个声明一个客户端，然后在控制器的底部：

```
public void setclien(Client c) {
    this.client = c;
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-11-20T00:48:45.187

这是使用 Guice 注入的控制器的示例。

```
/**
 * Loads a FXML file and injects its controller from the given Guice {@code Provider}
 */
public abstract class GuiceFxmlLoader {

   public GuiceFxmlLoader(Stage stage, Provider<?> provider) {
      mStage = Objects.requireNonNull(stage);
      mProvider = Objects.requireNonNull(provider);
   }

   /**
    * @return the FXML file name
    */
   public abstract String getFileName();

   /**
    * Load FXML, set its controller with given {@code Provider}, and add it to {@code Stage}.
    */
   public void loadView() {
      try {
         FXMLLoader loader = new FXMLLoader(getClass().getClassLoader().getResource(getFileName()));
         loader.setControllerFactory(p -> mProvider.get());
         Node view = loader.load();
         setViewInStage(view);
      }
      catch (IOException ex) {
         LOGGER.error("Failed to load FXML: " + getFileName(), ex);
      }
   }

   private void setViewInStage(Node view) {
      BorderPane pane = (BorderPane)mStage.getScene().getRoot();
      pane.setCenter(view);
   }

   private static final Logger LOGGER = Logger.getLogger(GuiceFxmlLoader.class);

   private final Stage mStage;
   private final Provider<?> mProvider;
} 
```

下面是loader的具体实现：

```
public class ConcreteViewLoader extends GuiceFxmlLoader {

   @Inject
   public ConcreteViewLoader(Stage stage, Provider<MyController> provider) {
      super(stage, provider);
   }

   @Override
   public String getFileName() {
      return "my_view.fxml";
   }
} 
```

请注意，此示例将视图加载到 BoarderPane 的中心，它是舞台中场景的根。这与示例（我的特定用例的实现细节）无关，但决定保留它，因为有些人可能会觉得它有用。

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2018-03-15T12:29:43.747

您可以决定使用公共可观察列表来存储公共数据，或者只是创建一个公共 setter 方法来存储数据并从相应的控制器中检索

* * *

## 回答 #10

> 赞同：-2
> 
> 时间：2019-08-28T05:16:20.313

为什么要回答一个 6 岁的问题？
使用任何编程语言的最基本概念之一是如何从一种（窗口、表单或页面）导航到另一种。此外，在进行此导航时，开发人员通常希望从一个（窗口、表单或页面）传递数据并显示或使用传递的数据
虽然这里的大多数答案都提供了很好的示例，但我们认为我们会启动它一个缺口或两个或三个
我们说三个是因为我们将在三个（窗口、表单或页面）之间导航，并使用静态变量的概念在（窗口、表单或页面）周围传递数据
我们还将包含一些决策代码，同时我们导航

```
public class Start extends Application {

    @Override
    public void start(Stage stage) throws Exception {
        // This is MAIN Class which runs first
        Parent root = FXMLLoader.load(getClass().getResource("start.fxml"));
        Scene scene = new Scene(root);
        stage.setScene(scene);
        stage.setResizable(false);// This sets the value for all stages
        stage.setTitle("Start Page"); 
        stage.show();
        stage.sizeToScene();
    }

    public static void main(String[] args) {
        launch(args);
    } 
} 
```

启动控制器

```
public class startController implements Initializable {

@FXML Pane startPane,pageonePane;
@FXML Button btnPageOne;
@FXML TextField txtStartValue;
public Stage stage;
public static int intSETonStartController;
String strSETonStartController;

@FXML
private void toPageOne() throws IOException{

    strSETonStartController = txtStartValue.getText().trim();

        // yourString != null && yourString.trim().length() > 0
        // int L = testText.length();
        // if(L == 0){
        // System.out.println("LENGTH IS "+L);
        // return;
        // }
        /* if (testText.matches("[1-2]") && !testText.matches("^\\s*$")) 
           Second Match is regex for White Space NOT TESTED !
        */

        String testText = txtStartValue.getText().trim();
        // NOTICE IF YOU REMOVE THE * CHARACTER FROM "[1-2]*"
        // NO NEED TO CHECK LENGTH it also permited 12 or 11 as valid entry 
        // =================================================================
        if (testText.matches("[1-2]")) {
            intSETonStartController = Integer.parseInt(strSETonStartController);
        }else{
            txtStartValue.setText("Enter 1 OR 2");
            return;
        }

        System.out.println("You Entered = "+intSETonStartController);
        stage = (Stage)startPane.getScene().getWindow();// pane you are ON
        pageonePane = FXMLLoader.load(getClass().getResource("pageone.fxml"));// pane you are GOING TO
        Scene scene = new Scene(pageonePane);// pane you are GOING TO
        stage.setScene(scene);
        stage.setTitle("Page One"); 
        stage.show();
        stage.sizeToScene();
        stage.centerOnScreen();  
}

private void doGET(){
    // Why this testing ?
    // strSENTbackFROMPageoneController is null because it is set on Pageone
    // =====================================================================
    txtStartValue.setText(strSENTbackFROMPageoneController);
    if(intSETonStartController == 1){
      txtStartValue.setText(str);  
    }
    System.out.println("== doGET WAS RUN ==");
    if(txtStartValue.getText() == null){
       txtStartValue.setText("");   
    }
}

@Override
public void initialize(URL url, ResourceBundle rb) {
    // This Method runs every time startController is LOADED
     doGET();
}    
} 
```

第一页控制器

```
public class PageoneController implements Initializable {

@FXML Pane startPane,pageonePane,pagetwoPane;
@FXML Button btnOne,btnTwo;
@FXML TextField txtPageOneValue;
public static String strSENTbackFROMPageoneController;
public Stage stage;

    @FXML
private void onBTNONE() throws IOException{

        stage = (Stage)pageonePane.getScene().getWindow();// pane you are ON
        pagetwoPane = FXMLLoader.load(getClass().getResource("pagetwo.fxml"));// pane you are GOING TO
        Scene scene = new Scene(pagetwoPane);// pane you are GOING TO
        stage.setScene(scene);
        stage.setTitle("Page Two"); 
        stage.show();
        stage.sizeToScene();
        stage.centerOnScreen();
}

@FXML
private void onBTNTWO() throws IOException{
    if(intSETonStartController == 2){
        Alert alert = new Alert(AlertType.CONFIRMATION);
        alert.setTitle("Alert");
        alert.setHeaderText("YES to change Text Sent Back");
        alert.setResizable(false);
        alert.setContentText("Select YES to send 'Alert YES Pressed' Text Back\n"
                + "\nSelect CANCEL send no Text Back\r");// NOTE this is a Carriage return\r
        ButtonType buttonTypeYes = new ButtonType("YES");
        ButtonType buttonTypeCancel = new ButtonType("CANCEL", ButtonData.CANCEL_CLOSE);

        alert.getButtonTypes().setAll(buttonTypeYes, buttonTypeCancel);

        Optional<ButtonType> result = alert.showAndWait();
        if (result.get() == buttonTypeYes){
            txtPageOneValue.setText("Alert YES Pressed");
        } else {
            System.out.println("canceled");
            txtPageOneValue.setText("");
            onBack();// Optional
        }
    }
}

@FXML
private void onBack() throws IOException{

    strSENTbackFROMPageoneController = txtPageOneValue.getText();
    System.out.println("Text Returned = "+strSENTbackFROMPageoneController);
    stage = (Stage)pageonePane.getScene().getWindow();
    startPane = FXMLLoader.load(getClass().getResource("start.fxml")); 
    Scene scene = new Scene(startPane);
    stage.setScene(scene);
    stage.setTitle("Start Page"); 
    stage.show();
    stage.sizeToScene();
    stage.centerOnScreen(); 
}

private void doTEST(){
    String fromSTART = String.valueOf(intSETonStartController);
    txtPageOneValue.setText("SENT  "+fromSTART);
    if(intSETonStartController == 1){
       btnOne.setVisible(true);
       btnTwo.setVisible(false);
       System.out.println("INTEGER Value Entered = "+intSETonStartController);  
    }else{
       btnOne.setVisible(false);
       btnTwo.setVisible(true);
       System.out.println("INTEGER Value Entered = "+intSETonStartController); 
    }  
}

@Override
public void initialize(URL url, ResourceBundle rb) {
    doTEST();
}    

} 
```

第二页控制器

```
public class PagetwoController implements Initializable {

@FXML Pane startPane,pagetwoPane;
public Stage stage;
public static String str;

@FXML
private void toStart() throws IOException{

    str = "You ON Page Two";
    stage = (Stage)pagetwoPane.getScene().getWindow();// pane you are ON
    startPane = FXMLLoader.load(getClass().getResource("start.fxml"));// pane you are GOING TO
    Scene scene = new Scene(startPane);// pane you are GOING TO
    stage.setScene(scene);
    stage.setTitle("Start Page"); 
    stage.show();
    stage.sizeToScene();
    stage.centerOnScreen();  
}

@Override
public void initialize(URL url, ResourceBundle rb) {

}    

} 
```

以下是所有 FXML 文件

```
<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.Button?>
<?import javafx.scene.layout.AnchorPane?>
<?import javafx.scene.text.Font?>

<AnchorPane id="AnchorPane" fx:id="pagetwoPane" prefHeight="400.0" prefWidth="600.0" xmlns="http://javafx.com/javafx/8.0.60" xmlns:fx="http://javafx.com/fxml/1" fx:controller="atwopage.PagetwoController">
   <children>
      <Button layoutX="227.0" layoutY="62.0" mnemonicParsing="false" onAction="#toStart" text="To Start Page">
         <font>
            <Font name="System Bold" size="18.0" />
         </font>
      </Button>
   </children>
</AnchorPane>
```

```
<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.layout.AnchorPane?>
<?import javafx.scene.text.Font?>

<AnchorPane id="AnchorPane" fx:id="startPane" prefHeight="200.0" prefWidth="400.0" xmlns="http://javafx.com/javafx/8.0.60" xmlns:fx="http://javafx.com/fxml/1" fx:controller="atwopage.startController">
   <children>
      <Label focusTraversable="false" layoutX="115.0" layoutY="47.0" text="This is the Start Pane">
         <font>
            <Font size="18.0" />
         </font>
      </Label>
      <Button fx:id="btnPageOne" focusTraversable="false" layoutX="137.0" layoutY="100.0" mnemonicParsing="false" onAction="#toPageOne" text="To Page One">
         <font>
            <Font size="18.0" />
         </font>
      </Button>
      <Label focusTraversable="false" layoutX="26.0" layoutY="150.0" text="Enter 1 OR 2">
         <font>
            <Font size="18.0" />
         </font>
      </Label>
      <TextField fx:id="txtStartValue" layoutX="137.0" layoutY="148.0" prefHeight="28.0" prefWidth="150.0" />
   </children>
</AnchorPane>
```

```
<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.layout.AnchorPane?>
<?import javafx.scene.text.Font?>

<AnchorPane id="AnchorPane" fx:id="pageonePane" prefHeight="200.0" prefWidth="400.0" xmlns="http://javafx.com/javafx/8.0.60" xmlns:fx="http://javafx.com/fxml/1" fx:controller="atwopage.PageoneController">
   <children>
      <Label focusTraversable="false" layoutX="111.0" layoutY="35.0" text="This is Page One Pane">
         <font>
            <Font size="18.0" />
         </font>
      </Label>
      <Button focusTraversable="false" layoutX="167.0" layoutY="97.0" mnemonicParsing="false" onAction="#onBack" text="BACK">
         <font>
            <Font size="18.0" />
         </font></Button>
      <Button fx:id="btnOne" focusTraversable="false" layoutX="19.0" layoutY="97.0" mnemonicParsing="false" onAction="#onBTNONE" text="Button One" visible="false">
         <font>
            <Font size="18.0" />
         </font>
      </Button>
      <Button fx:id="btnTwo" focusTraversable="false" layoutX="267.0" layoutY="97.0" mnemonicParsing="false" onAction="#onBTNTWO" text="Button Two">
         <font>
            <Font size="18.0" />
         </font>
      </Button>
      <Label focusTraversable="false" layoutX="19.0" layoutY="152.0" text="Send Anything BACK">
         <font>
            <Font size="18.0" />
         </font>
      </Label>
      <TextField fx:id="txtPageOneValue" layoutX="195.0" layoutY="150.0" prefHeight="28.0" prefWidth="150.0" />
   </children>
</AnchorPane>
```*

# php - ios客户端<>php后端加密

> ID：14187966
> 
> 赞同：0
> 
> 时间：2013-01-06T23:34:01.790
> 
> 标签：php, objective-c, security, encryption

这可能是对我的问题的一种虚假描述，我不确定这是否最好发布在 Stackoverflow 或超级用户上。

我的问题如下，我正处于构建测验 ios-app 的计划阶段。在某些情况下，它实际上会每月分发实物奖品，这意味着安全性必须足够严格以减少作弊的可能性。我将在带有 Apache 和经过认证的 SSL (Rapid-SSL) 的 debian 服务器上用 PHP 构建后端。

我的猜测是，对于每个问题，它都需要将它来回发送到服务器，以便服务器对答案进行身份验证，并让用户知道答案是否正确。对于某些情况（非中奖测验），我什至想返回正确答案。

我的问题是，安全方面的最佳方法是什么？我是否应该对来回发送的数据进行编码，如果是这样......如何以及使用什么（是否有一些我可以使用的常见编码类型，例如 base64 或类似的）？

***编辑***
我的意思是编码，而不是加密。我更新了问题

此外，对于身份验证，我正在考虑使用 Facebook OAuth 登录。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T23:41:30.963

如果您通过 SSL 发送，则数据肯定已经加密。想想看，最大的担心是身份验证。确定提交问题的用户实际上就是那个用户。为此，我将使用简单的密码身份验证。而且因为一切都通过 SSL，这应该足够了。在这种情况下，最大的担忧是用户端的恶意软件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T00:20:41.803

让我详细解释一下：

a) 如果您害怕中间人攻击或在发送到服务器（或从服务器接收数据）之前修改您的数据包，SSL 会阻止他们。

b）如果您想阻止黑客/调试器/逆向者，如果他们反转您的代码并且您的代码提交例如 SSL 中的高分，他们也可以轻松提交，如下所示：

https://yoursite.com/submithighscore.php?score=[SCORE] 即使你使用 https，当黑客泄露 URL、分数提交方法和 HTTP 参数时，他们也可以使用简单的 curl 命令提交虚假结果。

因此，在这种情况下，您可以实现一种高级加密算法，例如使用已知算法对数据进行加密，并对您的应用程序进行一些特定的更改，从而保护您的应用程序不被逆转（这有点困难）。它将阻止大多数黑客/逆向者。

如果你选择了一个好的密钥交换算法和加密模式，除了注入代码或修改你的代码之外，为黑客伪造它是很困难的。这一次你必须采取一切防倒车措施。即使您在这里使用公钥加密而没有采取防逆向措施，黑客也可以在您的应用程序中注入代码，例如将 X 点添加到每个提交点，它只需要一条汇编指令。

无论如何，很难有一个真正真正安全的系统，逆向者逆向，密码破解者试图找出你的加密算法并试图破解它。但是您也可以尽最大努力阻止大多数黑客。

# javascript - 滑动切换导航仅适用于主页

> ID：14187969
> 
> 赞同：0
> 
> 时间：2013-01-06T23:34:07.870
> 
> 标签：javascript, jquery, wordpress, nav

有问题的网站：http: [//mtthwbsh.com](http://mtthwbsh.com)

对于我的移动导航，我使用以下脚本来切换它的打开/关闭：

```
$(document).ready(function(){
/* toggle nav */
$("#menu-icon").on("click", function(){
    $(".nav").slideToggle();
    $(this).toggleClass("active");
    $("#menu-icon img").toggleClass("rotate");
});
}); 
```

这在主页上可以正常工作，但在内部页面上它不会切换，并且在搜索和查看结果时，整个导航都会消失。我正在使用条件标签在内部页面上加载单独的导航，但不确定这是否是问题所在。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-06T23:41:12.357

你的 smoothscroll.js 抛出一个错误，这可能会阻止你的 javascript 的其余部分被执行：

```
Uncaught TypeError: Cannot read property 'top' of undefined 
```

当它正在搜索似乎丢失的 id "#work" 时会发生这种情况

# android - 致命错误：android_native_app_glue.h：没有这样的文件或目录

> ID：14187970
> 
> 赞同：2
> 
> 时间：2013-01-06T23:34:23.337
> 
> 标签：android, c++, eclipse, android-ndk

所以，我无法停止收到错误消息

> 致命错误：android_native_app_glue.h：没有这样的文件或目录

在尝试编译应用程序时。真的吓到我了。我已经在项目设置中指定了**android_native_app_glue**的路径，但这没有任何意义。我还可以做些什么？

*（操作系统视窗 7）*

制作文件看起来像

```
LOCAL_PATH := $(call my-dir)

include $(CLEAR_VARS)

LOCAL_MODULE := droidblaster
LOCAL_SRC_FILES := Main.cpp EventLoop.cpp Log.cpp
LOCAL_LDLIBS := -landroid -llog
LOCAL_STATIC_LIBRARIES := android_native_app_glue

$(call import-module,android/native_app_glue)

include $(BUILD_SHARED_LIBRARY) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-06T11:11:59.747

这可能很晚使文件没有指向正确的库使用

```
LOCAL_STATIC_LIBRARIES := android_native_app_glue 
```

[Malte Schmitz](https://stackoverflow.com/users/1683939/malte-schmitz)的回答中遗漏了这一点

你也可以参考

> android-ndk-文件夹\sources\android\native_app_glue\Android.mk

请参考 NDK 中给出的示例源

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-07T17:08:39.917

I think you can fix it this way:
Try first calling:

```
include $(BUILD_SHARED_LIBRARY) 
```

and after that

```
$(call import-module,android/native_app_glue) 
```

like this:

```
LOCAL_PATH := $(call my-dir)

include $(CLEAR_VARS)

LOCAL_MODULE := droidblaster
LOCAL_SRC_FILES := Main.cpp EventLoop.cpp Log.cpp
LOCAL_LDLIBS := -landroid -llog
LOCAL_STATIC_LIBRARIES := cpufeatures
LOCAL_STATIC_LIBRARIES += android_native_app_glue
LOCAL_STATIC_LIBRARIES += ndk_helper

include $(BUILD_SHARED_LIBRARY) 

$(call import-module,android/native_app_glue) 
```

but maybe you just forgot to include it in your files?

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-09T07:51:46.050

如果它对某人有用，您需要在 Project Properties -> C/C++ General -> Paths and Symbols 中包含路径 /path/to/android-ndk/sources/android/native_app_glue（通过 GNU C 和 GNU C++ 语言项）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-09-08T13:11:32.100

利用：

```
LOCAL_STATIC_LIBRARIES := cpufeatures android_native_app_glue ndk_helper 
```

为我工作。

# jquery - 一个链接 + 一键点击 = 多个事件

> ID：14187971
> 
> 赞同：0
> 
> 时间：2013-01-06T23:34:46.413
> 
> 标签：jquery

我找到了多个答案并尝试了所有答案，但没有一个能正常工作......

我在输入中有一个加减号按钮，用于更新项目的数量。有用。当用户单击 +1 按钮时，我需要添加第二个事件，还需要在 -1 按钮上添加第二个事件。添加第二个事件时无法正常运行！这是代码：

```
$("#inc<?php echo"$key"; ?>").bind({

click: function(){

    $(":text[name='qty<?php echo"$key"; ?>']").val(Number($(":text[name='qty<?php echo"$key"; ?>']").val()) + 1);

    var totalItems = parseFloat($("#qty<?php echo"$key"; ?>").val());
    var priceItem = parseFloat(<?php echo"$priceProduct"; ?>).toFixed(2);
    var totalValue = parseFloat(priceItem * totalItems).toFixed(2);
    $("#subtotal<?php echo"$key"; ?>").html("&#128; "+ totalValue).toFixed(2);

},

click: function(){

    prod_id = "<?php echo"$key"; ?>";
    $.ajax({
    type: "POST",
    url: "updateproduct2cart.php",
    data: "itemid="+prod_id+"&act=update"
    });

}
}); 
```

这可以防止 +/- 按钮触发。并触发另一个函数（旨在删除表格行）！！！这部分代码够吗？需要全部的东西吗？无论如何，谢谢你的帮助:)

编辑：下面的代码工作正常......不要问我为什么，但确实如此！:)

```
 $("#inc<?php echo"$key"; ?>").on('click', function(){

    prod_id = "<?php echo"$key"; ?>";
    $.ajax({
    type: "POST",
    url: "updateproduct2cart.php",
    data: "itemid="+prod_id+"&act=update&qty=up"
    });

    $(":text[name='qty<?php echo"$key"; ?>']").val(Number($(":text[name='qty<?php echo"$key"; ?>']").val()) + 1);

    var totalItems = parseFloat($("#qty<?php echo"$key"; ?>").val());
    var priceItem = parseFloat(<?php echo"$priceProduct"; ?>).toFixed(2);
    var totalValue = parseFloat(priceItem * totalItems).toFixed(2);
    $("#subtotal<?php echo"$key"; ?>").html("&#128; "+ totalValue).toFixed(2);

    }); 
```

HTML：

```
<tr name="prodItemi2" id="prodItemi2"><th id="prodItemi2" scope="row">Title of product #2</th>
  <td>black</td><td><span id="itemPi2">€ 39.95</span></td><td> 
   <button class="SCbutton" id="deci2">-</button>
     <input type="text" class="SCinput3" size="2" value="1" name="qtyi2" id="qtyi2">
      <button class="SCbutton" id="inci2">+</button></td><td>
        <span id="subtotali2">€ 39.95</span></td><td>

  <input type="radio" value="XL" name="sizei2"> XL 
  <input type="radio" checked="checked" value="L" name="sizei2"> L 
  <input type="radio" value="M" name="sizei2"> M </td><td>
  <span id="showSizei2">L</span></td><td>

  <a onclick="removeItem(this)" id="deleteItemi2" href="#"><img alt="" src="img/deleteItem.png"></a></td></tr> 
```

# javascript - JSON对象已知非空值的字段返回空字符串

> ID：14187972
> 
> 赞同：1
> 
> 时间：2013-01-06T23:34:49.637
> 
> 标签：javascript, json, google-chrome-extension

我有一个包含各种社交指标的共享计数的对象。该对象如下所示：

```
Object{
delicious: 0,
facebook: {
    comments: 0,
    likes: 0,
    shares: 0,
    total: 0,
},
linkedIn: 1,
pinterest: 0,
twitter: 9
} 
```

这是我用来尝试访问我的对象的一些测试代码：

```
 console.log(bg.results);
    console.log(bg.results["facebook"]);
    console.log(bg.results.facebook);

Object.keys(bg.results).forEach(function(key){
    console.log(bg.results);
    console.log(key + "->" + bg.results[key]);
}); 
```

上面的对象是我在控制台中看到的，所以我知道 bg.results 中的字段包含数据。问题是，当我尝试使用点语法或使用 object["key"] 访问这些字段中的任何一个时，我得到一个空字符串作为结果。我搜索并找不到其他遇到同样问题的人。有谁知道为什么会发生这种情况？

一些附加信息：我的代码正在 chrome 扩展的上下文中运行。我正在从弹出页面访问该对象，并且该对象的数据是从我的背景页面提供的。

谢谢您的帮助。

**更新**

Chrome 处理我的代码的方式发生了一些有趣的事情。bg.results 中的数据由我的后台页面上的一个名为 update 的函数提供。在我的程序中，根据用户的设置，有两种调用更新的方法。当从我的背景页面的上下文中调用 update() 时，一切正常并按预期运行。当从我的弹出页面调用 update() 时，当我尝试访问任何字段时会得到空字符串。

这似乎是一个对于如何处理 chrome 扩展非常特殊的错误，因此专家在这类事情上的任何输入都会很棒。感谢大家的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T17:48:52.990

I've concluded that my values were not completely loaded into the results object when I was trying to access them. I can only speculate as to why I could see the values when I printed the results object to the console (and could not access them at that point) but was not able to access them until later. Below is the solution I used for this problem.

```
function checkLoaded(results){
    var isLoaded = true;
    $.each(results, function(key, value){
        if(value === "" || value === undefined){
            isLoaded = false;   
        }
    });

    setTimeout(function(){
         if(!isLoaded){
            checkLoaded(results);
         }
         else{
            displayHandler(results);
         }
    }, 500);

} 
```

If anyone knows why I could see the values in the console but could not access them, I'd appreciate an explanation. But otherwise, if anyone else encounters a problem like this, try setting up a delay to make sure that your values are completely loaded into your collection.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-07T00:02:13.000

1.）您的代码应该可以工作。facebook 本身就是一个对象，因此您需要考虑这一点，并且可能使用递归函数！

2.) 为什么不使用 for-in-loop 遍历对象属性？

```
for(key in bg.results) {
   console.log(key);
} 
```

3.) 示例递归函数

```
function recursiveExample(obj) {
  var current;
  for(key in obj) {
   current = obj[key];
   if(typeof current === 'object' && !Array.isArray(current)) {
     recursiveExample(current);  
   }
   console.log("key: " + key + " - value" + current);
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T01:19:54.327

这只是一个猜测（因为您还没有发布任何相关的数据加载代码），但我怀疑您可能正在做这样的事情：

```
chrome.extension.sendMessage({myAction: "update"}, function(response) {
     bg.results = response;
});

// we try to use bg.results, but the sendMessage callback won't be run until later on
Object.keys(bg.results).forEach(function(key){
    console.log(bg.results);
    console.log(key + "->" + bg.results[key]);
}); 
```

传递给的异步回调在当前函数堆栈清除*后*`sendMessage`运行（即，一旦 JavaScript 线程用完其他事情要做），所以在您尝试使用它之前不会发生。相反，使用*回调*中的结果：*`bg.results = response`*

 **```
chrome.extension.sendMessage({myAction: "update"}, function(response) {
     bg.results = response;

    // now it works, because this code is inside the callback
    Object.keys(bg.results).forEach(function(key){
        console.log(bg.results);
        console.log(key + "->" + bg.results[key]);
    });
}); 
```

也许您实际上并没有使用`chrome.extension.sendMessage`，但您必须使用一些异步操作（可能是 Ajax，也可能是另一个 Chrome API 调用）。我不确定该方法是什么，因为您没有发布任何数据加载代码。**

# python - Python3：检查方法是否是静态的

> ID：14187973
> 
> 赞同：6
> 
> 时间：2013-01-06T23:34:59.660
> 
> 标签：python, python-3.x, static, static-methods, introspection

类似问题（与 Python2 相关：[Python: check if method is static](https://stackoverflow.com/questions/8727059/python-check-if-method-is-static)）

让我们考虑以下类定义：

```
class A:
  def f(self):
    return 'this is f'

  @staticmethod
  def g():
    return 'this is g' 
```

在 Python 3 中`instancemethod`不再存在，一切都是函数，因此与 Python 2 相关的答案将不再有效。

正如我所说，一切都是函数，所以我们可以调用`A.f(0)`，但我们当然不能调用`A.f()`（参数不匹配）。但是，如果我们创建一个实例`a=A()`并调用Python，则将作为第一个参数`a.f()`传递给函数。调用阻止发送它或捕获- 所以必须有一种方法来测试这是否是静态方法。`A.f``self``a.g()``self`

那么我们可以在 Python3 中检查一个方法是否被声明为`static`？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-07T00:08:11.167

```
class A:
  def f(self):
    return 'this is f'

  @staticmethod
  def g():
    return 'this is g'
print(type(A.__dict__['g']))
print(type(A.g))

<class 'staticmethod'>
<class 'function'> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2018-05-20T12:24:11.530

对于 Python 3.2 或更高版本，用于[`inspect.getattr_static()`](https://docs.python.org/3/library/inspect.html#inspect.getattr_static)在不调用描述符协议的情况下检索属性：

> 在不触发动态查找的情况下通过描述符协议检索属性，`__getattr__()`或`__getattribute__()`.

在结果上使用`isinstance(..., staticmethod)`：

```
>>> from inspect import getattr_static
>>> isinstance(getattr_static(A, 'g'), staticmethod)
True 
```

该函数可以处理实例和类，并将为您扫描完整的类层次结构：

```
>>> class B(A): pass
...
>>> isinstance(getattr_static(B, 'g'), staticmethod)  # inherited
True
>>> isinstance(getattr_static(B(), 'g'), staticmethod)  # instance, inherited
True 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-05-10T19:16:59.250

我需要这个解决方案，并根据@root 的回答写了以下内容

```
def is_method_static(cls, method_name):
    # http://stackoverflow.com/questions/14187973/python3-check-if-method-is-static
    for c in cls.mro():
        if method_name in c.__dict__:
            return isinstance(c.__dict__[method_name], staticmethod)
    raise RuntimeError("Unable to find %s in %s" % (method_name, cls.__name__)) 
```

# sip - SIP SUBSCRIBE 收到多个 NOTIFY

> ID：14187974
> 
> 赞同：1
> 
> 时间：2013-01-06T23:35:04.380
> 
> 标签：sip, voip, pjsip, subscribe

我正在编写一个 SIP 客户端，但在使用`SUBSCRIBE`现有客户端（不同的免费软件）时遇到了一些奇怪的问题

我正在使用自己的服务器，但这不是问题，因为如果我`SUBSCRIBE`从不同的客户端 (pjsip) 执行，一切正常。

我正在发送这条`SUBSCRIBE`消息：

```
SUBSCRIBE sip:3009@10.0.0.4 SIP/2.0
Via: SIP/2.0/UDP 10.0.0.7:5060;rport;branch=z9hG4bKPj3893ccd****************
Max-Forwards: 70
From: <sip:10.0.0.7>;tag=023a965a14a143eb8*******
To: sip:3009@10.0.0.5;tag=8cfb7*********
Contact: <sip:10.0.0.7:5060;ob>
Call-ID: bf5d48fe8ca0***************
CSeq: 14388 SUBSCRIBE
Route: <sip:10.0.0.5;lr;ftag=023a965a14a143eb8*********>
Event: presence
Expires: 600
Supported: replaces, 100rel, timer, norefersub
Accept: application/pidf+xml, application/xpidf+xml
Allow-Events: presence, message-summary, refer
Content-Length:  0 
```

在那条消息之后，收到一条消息`OK`，但随后我收到一条`NOTIFY`消息，说明其他客户端自从他注册到服务器后所做的每一次状态更改。

不同的客户不会发生此问题..

如果重要的话，我正在`Visual Studio 2008`Windows 7 64bit 上开发

有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-07T10:19:15.917

从评论来看，问题似乎是您没有向客户端发送有效响应，因此它正在发送每个 NOTIFY 请求的多次重传。

要生成有效响应，关键方面是您必须将 Via 分支参数和 CSeq 设置为与请求相同的值，请参阅[RFC 3261，第 17.1.3 节](https://www.rfc-editor.org/rfc/rfc3261#section-17.1.3)。

# sql - 尝试在一个事务中查询然后更新表

> ID：14187978
> 
> 赞同：1
> 
> 时间：2013-01-06T23:35:59.140
> 
> 标签：sql, sql-server, sql-server-2008-r2

存储过程的规范是：从我的表中
选择并返回（顺序并不重要，只要找到的前 1 个就可以了），一旦我选择了该记录，就需要对其进行标记，以免它被选中再次。`Id``tb_r12028dxi_SandpitConsoleProofClient``'P'`

这是存储过程：

```
ALTER PROCEDURE [dbo].[r12028dxi_SandpitConsoleProofSweep]
    @myId INT OUTPUT
AS

/*
DECLARE @X INT
EXECUTE [xxx].[dbo].[r12028dxi_SandpitConsoleProofSweep] @X OUTPUT
SELECT @X
*/

DECLARE @NumQueue INT = (
            SELECT [cnt] = COUNT(*) 
            FROM xxx.DBO.tb_r12028dxi_SandpitConsoleProofClient
            WHERE [Status] IS NULL
            );
IF @NumQueue > 0 
    BEGIN

        BEGIN TRANSACTION;

        DECLARE @foundID INT = (SELECT TOP 1 Id FROM xxx.DBO.tb_r12028dxi_SandpitConsoleProofClient WHERE [Status] IS NULL);

        UPDATE x
        SET x.[Status] = 'P'
        FROM xxx.DBO.tb_r12028dxi_SandpitConsoleProofClient x
        WHERE x.Id = @foundID 

        SET @myId = @foundID;

        RETURN;

        COMMIT TRANSACTION;

    END;
GO 
```

它正在返回错误消息：

> *EXECUTE 之后的事务计数表明 BEGIN 和 COMMIT 语句的数量不匹配。先前计数 = 0，当前计数 = 1。*

我刚刚添加了`Update`脚本，`BEGIN TRANSACTION;`并且`COMMIT TRANSACTION;`在此之前它看起来像下面这样运行良好......

```
ALTER PROCEDURE [dbo].[r12028dxi_SandpitConsoleProofSweep]
    @myId INT OUTPUT
AS

/*
DECLARE @X INT
EXECUTE [xxx].[dbo].[r12028dxi_SandpitConsoleProofSweep] @X OUTPUT
SELECT @X
*/

DECLARE @NumQueue INT = (
            SELECT [cnt] = COUNT(*) 
            FROM xxx.DBO.tb_r12028dxi_SandpitConsoleProofClient
            WHERE [Status] IS NULL
            );
IF @NumQueue > 0 
    BEGIN

    SELECT TOP 1 @myId = Id FROM xxx.DBO.tb_r12028dxi_SandpitConsoleProofClient;
    RETURN;

    END;
GO 
```

我添加了`BEGIN TRANSACTION;`/`COMMIT TRANSACTION;`因为我想确保数据被读入输出变量并且更新发生。我应该省略程序的这一部分吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-06T23:39:12.457

你有“返回；” 在“提交交易”之前；意思是“提交交易”；永远不会被执行。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-07T15:06:49.777

作为[@Andrew Bickerton 完全合理建议](https://stackoverflow.com/a/14193354/297408)的替代方案，您还可以使用[CTE](http://msdn.microsoft.com/en-us/library/ms175972.aspx "WITH common_table_expression (Transact-SQL)")和[`ROW_NUMBER()`](http://msdn.microsoft.com/en-us/library/ms186734.aspx "ROW_NUMBER (Transact-SQL)")函数，如下所示：

```
WITH ranked AS (
  SELECT
    Id,
    [Status],
    rnk = ROW_NUMBER() OVER (ORDER BY Id)
  FROM xxx.DBO.tb_r12028dxi_SandpitConsoleProofClient
  WHERE [Status] IS NULL
)
UPDATE ranked
SET
  [Status] = 'P',
  @myId = Id
WHERE rnk = 1
; 
```

该`ROW_NUMBER()`函数将排名分配给 where 的所有行`[Status] IS NULL`，这允许您仅更新特定的行。

在这种情况下，使用 CTE 作为 UPDATE 语句的直接目标是绝对合法的，因为 CTE 只从一个表中提取行。（这类似于在 UPDATE 语句中使用[视图。）](http://msdn.microsoft.com/en-us/library/ms187956.aspx#languageReferenceRemarksToggle "CREATE VIEW (Transact-SQL) – 备注")

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-07T09:45:50.850

给你想要的：

> 一旦我选择了该记录，就需要将其标记为“P”，以免再次被选中。

您可以在单个语句中实现这一点（而不是在交易中）

```
ALTER PROCEDURE [dbo].[r12028dxi_SandpitConsoleProofSweep]
    @myId INT OUTPUT
AS
BEGIN
    UPDATE x
        SET x.[Status] = 'P',
            @myID = x.ID
        FROM xxx.DBO.tb_r12028dxi_SandpitConsoleProofClient x
        /* a sample join to get your single row in an update statement */
        WHERE x.ID = (SELECT MIN(ID)
                      FROM xxx.DBO.tb_r12028dxi_SandpitConsoleProofClient sub
                      WHERE ISNULL(sub.[Status], '') != 'P')
END 
```

注意：在处理并发处理时（即：两个线程试图从单个队列中进行选择），更多的是关于锁定行为，而不是在单个事务中进行。

# ruby-on-rails - rails 3 协会试图限制返回数据

> ID：14187982
> 
> 赞同：0
> 
> 时间：2013-01-06T23:36:35.307
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我完全承认这是用户缺乏经验，但这是我的问题

我有 2 个相关的模型

```
 class User < ActiveRecord::Base
  belongs_to :team

  class Team < ActiveRecord::Base
  has_many :users 
```

我想要做的是显示与登录用户属于同一团队的所有用户。所以基本上从用户那里选择 team_id = my team_id

我不确定我是否可以/应该在控制器或视图中执行此操作，但我无法工作。

在我的控制器中，我有这个返回所有团队的所有用户

```
 @users = User 
```

这是 SELECT `users`.* FROM`users`

我也可以使用我的 current_user 方法返回当前用户的信息

```
 @users = current_user.team 
```

这是 SELECT `teams`.* FROM `teams`WHERE `teams`。`id`= 3

我不知道如何获取 team_id = current_user team_id 的所有用户的列表？

还想知道最好在控制器中还是在视图中尝试这个？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-06T23:51:09.053

正如@apneadiving 所建议的，使用`curent_user.team.users`将返回用户列表。但我只是想建议您将这种行为包装在一个方法中。因此，例如，您可以在`User`模型中包含以下内容：

```
class User < ActiveRecord::Base

  belongs_to :team

  def coworkers
    team.users
  end
end 
```

然后在你的控制器中你可以做

```
def an_action
  @coworkers = current_user.coworkers
end 
```

最后，在您的视图中，您可以遍历此列表以显示它们

```
@coworkers.each do |coworker|
  ... 
```

# cuda - Cuda 5.0 链接错误

> ID：14187983
> 
> 赞同：1
> 
> 时间：2013-01-06T23:36:42.400
> 
> 标签：cuda, nvcc

`CUDA 4.2`我的项目在 Linux 机器上的开发环境下编译得很好。

最近升级到 了`CUDA 5.0`，现在编译失败，出现以下错误信息。

```
In file included from /opt/cuda/bin/crt/link.stub:79:0:
/tmp/tmpxft_000018c8_00000000-1_GPUReax_dlink.reg.c:2:1: error: redefinition of 'const unsigned char def_module_id_str__NV_MODULE_ID []'
/tmp/tmpxft_000018c8_00000000-1_GPUReax_dlink.reg.c:1:1: error: 'const unsigned char def_module_id_str__NV_MODULE_ID [19]' previously defined here
/tmp/tmpxft_000018c8_00000000-1_GPUReax_dlink.reg.c: In function 'void __cudaRegisterLinkedBinary__NV_MODULE_ID(void (*)(void**), void*, void*)':
/tmp/tmpxft_000018c8_00000000-1_GPUReax_dlink.reg.c:2:1: error: redefinition of 'void __cudaRegisterLinkedBinary__NV_MODULE_ID(void (*)(void**), void*, void*)'
/tmp/tmpxft_000018c8_00000000-1_GPUReax_dlink.reg.c:1:1: error: 'void __cudaRegisterLinkedBinary__NV_MODULE_ID(void (*)(void**), void*, void*)' previously defined here 
```

我正在使用一台linux机器

```
mctesla 93 $ uname -a
Linux mctesla.cs.purdue.edu 3.7.1 #1 SMP Fri Dec 28 12:08:12 EST 2012 x86_64 Intel(R) Xeon(R) CPU E5606 @ 2.13GHz GenuineIntel GNU/Linux
mctesla 94 $ 
```

有人可以评论如何使用 CUDA 5.0 环境解决此问题。

更新 - - -

感谢您非常及时的评论。

我昨天整天都在追这个问题..查看编译器输出后，我注意到以下行....（下面用***分隔）

nvcc -I。-I/opt/cuda/include -D__USE_GPU__ -arch=sm_20 -Xptxas=-v -L/opt/cuda/lib64 -lm -lz -lcuda -lcudart GMRES.o QEq.o allocate.o analyze.o bond_orders.o box.o force.ofour_body_interactions.o grid.o init_md.o integration.o list.o lookup.o neighbors.o param.o pdb_tools.o print_utils.o reset_utils.o restart.o single_body_interactions.o system_props.o three_body_interactions o traj.o two_body_interactions.o vector.o testmd.o cuda_utils.o cuda_copy.o cuda_init.o reduction.o center_mass.o helpers.o validation.o matrix.o matvec.o -o GPUReax

在 /opt/cuda/bin/crt/link.stub:79:0:( ******* ) /tmp/tmpxft_0000345f_00000000-1_GPUReax_dlink.reg.c:2:1 中包含的文件中：错误：重新定义 'const unsigned char def_module_id_str__NV_MODULE_ID [] ' /tmp/tmpxft_0000345f_00000000-1_GPUReax_dlink.reg.c:1:1: 错误：'const unsigned char def_module_id_str__NV_MODULE_ID [19]' 之前在这里定义

* * *

错误来自文件 link.stub 文件，这是 CUDA 5.0 安装中的新文件。CUDA 4.2 安装中不存在此文件。

如果这有助于某人指出问题。

谢谢您的帮助。

苏迪尔·凯拉萨

* * *

顺便说一句，这是我的 Makefile

```
CC    = g++ 
NVCC   = nvcc

LIBS    = -L/opt/cuda/lib64 -lm -lz -lcuda -lcudart

CFLAGS  = -I.  -Wall -O3 -funroll-loops -fstrict-aliasing
NVCCFLAGS  = -I.  -I/opt/cuda/include -D__USE_GPU__ -arch=sm_20 -Xptxas=-v

#-finline-functions  -finline-limit=15 -g#-DTEST -pg -ldl -rdynamic -g
DEFS    = $(CFLAGS)
NVCCDEFS = $(NVCCFLAGS)

FLAG    = $(DEFS) $(INCS) $(LIBS)
NVCCFLAG = $(NVCCDEFS) $(LIBS)

OBJ      = GMRES.o QEq.o allocate.o analyze.o bond_orders.o \
     box.o forces.o four_body_interactions.o \
     grid.o init_md.o integrate.o list.o \
     lookup.o neighbors.o param.o pdb_tools.o \
     print_utils.o reset_utils.o \
     restart.o single_body_interactions.o \
     system_props.o three_body_interactions.o \
     traj.o two_body_interactions.o vector.o \
     testmd.o \
     cuda_utils.o cuda_copy.o cuda_init.o reduction.o \
     center_mass.o helpers.o validation.o matrix.o matvec.o

all:   beta

beta: $(OBJ) Makefile
   $(NVCC) $(NVCCFLAG) $(OBJ) -o GPUReax

param.o: param.c param.h mytypes.h traj.o
   $(CC) $(DEFS) -c param.c

traj.o: traj.c traj.h mytypes.h 
   $(CC) $(DEFS) -c traj.c

restart.o: restart.c restart.h mytypes.h box.h
   $(CC) $(DEFS) -c restart.c

pdb_tools.o: pdb_tools.c pdb_tools.h mytypes.h box.h list.h restart.h param.h
    $(CC) $(DEFS) -c pdb_tools.c

print_utils.o: print_utils.h print_utils.c
    $(CC) $(DEFS) -c print_utils.c

grid.o: grid.h grid.c
   $(CC) $(DEFS) -c grid.c

analyze.o: analyze.h analyze.c
   $(CC) $(DEFS) -c analyze.c

integrate.o: integrate.h integrate.c
   $(CC) $(DEFS) -c integrate.c

vector.o: vector.h vector.cu
   $(NVCC) $(NVCCDEFS) -c vector.cu

system_props.o: system_props.h system_props.cu
   $(NVCC) $(NVCCDEFS) -c system_props.cu

cuda_copy.o: cuda_copy.h cuda_copy.cu
   $(NVCC) $(NVCCDEFS) -c cuda_copy.cu

cuda_utils.o: cuda_utils.h cuda_utils.cu
   $(NVCC) $(NVCCDEFS) -c cuda_utils.cu

cuda_init.o: cuda_init.h cuda_init.cu
   $(NVCC) $(NVCCDEFS) -c cuda_init.cu

reduction.o: reduction.h reduction.cu
   $(NVCC) $(NVCCDEFS) -c reduction.cu

center_mass.o: center_mass.h center_mass.cu
   $(NVCC) $(NVCCDEFS) -c center_mass.cu

box.o: box.h
   $(NVCC) $(NVCCDEFS) -c box.cu

init_md.o: init_md.h init_md.cu
   $(NVCC) $(NVCCDEFS) -c init_md.cu

helpers.o: helpers.h helpers.cu
   $(NVCC) $(NVCCDEFS) -c helpers.cu

GMRES.o: GMRES.h GMRES.cu
   $(NVCC) $(NVCCDEFS) -c GMRES.cu

neighbors.o: neighbors.cu neighbors.h
   $(NVCC) $(NVCCDEFS) -c neighbors.cu

reset_utils.o: reset_utils.h reset_utils.cu mytypes.h list.h vector.h
   $(NVCC) $(NVCCDEFS) -c reset_utils.cu

list.o: list.h
   $(NVCC) $(NVCCDEFS) -c list.cu

forces.o: forces.h forces.cu
   $(NVCC) $(NVCCDEFS) -c forces.cu

allocate.o: allocate.h allocate.cu
   $(NVCC) $(NVCCDEFS) -c allocate.cu

lookup.o: lookup.h lookup.cu
   $(NVCC) $(NVCCDEFS) -c lookup.cu

two_body_interactions.o: two_body_interactions.h two_body_interactions.cu
   $(NVCC) $(NVCCDEFS) -c two_body_interactions.cu

bond_orders.o: bond_orders.h bond_orders.cu
   $(NVCC) $(NVCCDEFS) -c bond_orders.cu

single_body_interactions.o: single_body_interactions.h single_body_interactions.cu
   $(NVCC) $(NVCCDEFS) -c single_body_interactions.cu

three_body_interactions.o: three_body_interactions.h three_body_interactions.cu
   $(NVCC) $(NVCCDEFS) -c three_body_interactions.cu

four_body_interactions.o: four_body_interactions.h four_body_interactions.cu
   $(NVCC) $(NVCCDEFS) -c four_body_interactions.cu

validation.o: validation.h validation.cu
   $(NVCC) $(NVCCDEFS) -c validation.cu

matrix.o: matrix.h matrix.cu
   $(NVCC) $(NVCCDEFS) -c matrix.cu

QEq.o: QEq.h QEq.cu
   $(NVCC) $(NVCCDEFS) -c QEq.cu

matvec.o: matvec.h matvec.cu
   $(NVCC) $(NVCCDEFS) -c matvec.cu

testmd.o: testmd.cu mytypes.h param.o traj.o restart.o pdb_tools.o list.o vector.o
   $(NVCC) $(NVCCDEFS) -c testmd.cu

clean:
   rm -f *.o *~ core 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T18:30:26.300

当我想编译时遇到了同样的问题`sm_35`。我通过替换`NVCCFLAGS`变量中的部分来解决它：

```
-arch=sm_20 by -gencode arch=compute_10,code=sm_10 -gencode arch=compute_20,code=sm_20 -gencode arch=compute_30,code=sm_30 -gencode arch=compute_35,code=sm_35 
```

希望能帮助到你。

# javascript - 如何在 jQuery 中重复一个函数？

> ID：14187984
> 
> 赞同：0
> 
> 时间：2013-01-06T23:37:12.047
> 
> 标签：javascript, html, jquery

我尝试在此函数中使用无限循环，但是，当我设置该函数时，`setInterval`该函数不会重复。问题是当用户发送表单并且时间间隔过去之后。该功能停留在发送的消息上，而不是从头开始。请看我的[JSBin](http://jsbin.com/65hyn/last)。

**Javascript：**

```
$(function(){

  function show_fb() {
    $("#feedback_box").show("slow");    
  }

  function hideAll() {
    $("#feedback_box").hide("slow");
  }

  $("#feedback_box #close").click(function() { // When the X is pressed
    $("#feedback_box").hide("slow"); // Hide the form
  });

  setInterval(show_fb,1000); // Show the form after 6 seconds , you can change 6000 to anything you like    

  $("#feedback_form").submit(function() { //When the form is submitted

    $('#feedback_form #fb_title').css('background-color','#4444FF').text('Sending...').slideDown(900); //show "Sending" message

    $.post("form_submit.php",{ mesaj:$('#mesaj').val(),rand:Math.random() } ,function(data) { //subimit the feedback via AJAX

        $('#feed_subm').attr("disabled", "false"); //disable the "SEND" button
        $('#feedback_form #fb_title').css('background-color','#C33').text('Thank You!').slideDown(900); //Shows a thank you message
        setTimeout(hideAll,2000); // Hide the form after 2 seconds

    });

  });

  return false; //Tells the code not to post the form physically

}); 
```

**HTML：**

```
</head>
<body>

    <div id="feedback_box"> 
        <form id="feedback_form"> 
            <span id="fb_title">Give us some feedback :)</span><span id="close">X</span> 
            <textarea id="mesaj"></textarea> 
            <input type="submit" value="Send" class="mysubm" id="feed_subm"/> 
        </form> 
    </div>

</body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-07T02:25:47.077

你可以像这样在 jQuery 中重复一个函数：

**Javascript：**

```
$(document).ready(function() {

  // First we will create the function that will be repeated
  function repeat() {

    setTimeout(function() {

      // Enter your code that you want to repeat in here

      repeat(); // This is where the function repeats

    }, 1); // Where 1 is the delay (in milliseconds)

  }

  repeat(); // Here we are initially firing the function

}); 
```

在上面的示例中，我不明白为什么您需要不断重复一个函数，但是您的问题是*如何在 jQuery 中重复一个函数？*

我认为这意味着*如何在 jQuery 中重复一个函数？*

好吧，这就是你的答案。

# php - HTML 嵌入表格

> ID：14187991
> 
> 赞同：0
> 
> 时间：2013-01-06T23:37:40.937
> 
> 标签：php, mysql, html-table

我遇到了一个奇怪的问题。这是我的代码的粗略版本：

```
<table>
<table>
<tr><td>
while(mysql_fetch())
{
<table>
<tr><td>Hi</td></tr>
</table>
}
</td></tr>
</table>
</table> 
```

我的问题是，在 while 循环中创建的表是在新行（行）上创建的，而它应该打印在同一行中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T23:44:23.360

```
<table>
    <table>
        <tr>
            while(mysql_fetch()) {
                <td>
                    <table>
                        <tr><td>Hi</td></tr>
                    </table>
                </td>
            }
        </tr>
    </table>
</table> 
```

应该管用。这是一个[演示](http://jsfiddle.net/Ut6Pr/)

# php - 从 php stdin 保存大文件

> ID：14187993
> 
> 赞同：3
> 
> 时间：2013-01-06T23:38:11.263
> 
> 标签：php, post, stream

请告诉我从 php stdin 保存大文件的最佳方法。iOS 开发人员将大型视频内容发送到服务器，我必须将其存储到文件中。

我用视频数据读取标准输入线程并将其写入文件。例如，以这种方式：

```
$handle = fopen("php://input", "rb");    
while (!feof($handle)) {
      $http_raw_post_data .= fread($handle, 8192);
} 
```

用什么功能比较好？file_get_contents 或 fread 还是别的什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-06T23:56:43.363

我同意@hek2mgl 将其视为多部分表单上传最有意义，但如果您无法更改输入界面，那么您可以[`file_put_contents()`](http://php.net/manual/en/function.file-put-contents.php)在流上使用而不是自己循环文件。

```
$handle = fopen("php://input", "rb");  
if (false === file_put_contents("outputfile.dat", $handle))
{
  // handle error
}
fclose($handle); 
```

它比遍历文件更干净，而且可能更快（我没有测试过）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-06T23:47:46.097

不要使用`file_get_contents`，因为它会尝试将文件的所有内容加载到字符串中

[来自 PHP 文档](http://php.net/manual/en/function.file-get-contents.php)

> [file_get_contents()](http://php.net/manual/en/function.file-get-contents.php)是将文件内容读入字符串的首选方法。如果您的操作系统支持，它将使用内存映射技术来提高性能。

确定您只想在服务器上创建电影文件.. 这是一种更有效的方法

```
$in = fopen("php://input", "rb");
$out = fopen('largefile.dat', 'w');

while ( ! feof($in) ) {
    fwrite($out, fread($in, 8192));
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-23T22:45:33.383

如果您使用 nginx 作为网络服务器，我想推荐[nginx 上传模块](http://www.grid.net.ru/nginx/upload.en.html)，可以恢复上传。

# java - 为什么这段代码不能编译？

> ID：14187995
> 
> 赞同：0
> 
> 时间：2013-01-06T23:38:36.617
> 
> 标签：java, inheritance, constructor

我试图理解为什么这段代码会编译：

```
public class A {
}

public class B extends A {
  public B() {
  }
} 
```

虽然这段代码没有：

```
public class A {
  public A(int n) {
  }
}

public class B extends A {
  public B() {
  }
} 
```

我的意思是，A类在这两种情况下都没有一个空白构造函数吗？如果是这样，为什么它不起作用？

提前致谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-06T23:39:31.543

当超类只有带参数的构造函数时，您需要从子类显式调用超类的构造函数，如下所示。

```
public B() {
    super(2);// passing an int value to your super class cons
} 
```

> 在这两种情况下，A 类都没有空白构造函数吗？

不。如果您声明了构造函数，那么编译器将不包含默认构造函数，因此`class A`在情况 2 中您没有默认的无参数构造函数，并且您必须从子类构造函数显式地进行超级调用。

# smalltalk - 特征 smalltalk 中的实例变量

> ID：14187996
> 
> 赞同：4
> 
> 时间：2013-01-06T23:38:45.270
> 
> 标签：smalltalk, traits, pharo

在 Pharo Smalltalk 中使用特征时是否可以使用 instanceVariables？

```
Trait named: #Personnel
uses:{}
category: 'Test' 
```

我想添加一些其他类可以从这些特征中使用的变量。这在 Smalltalk 中可能吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-07T08:11:10.133

不。特征是**无状态**的可组合单元，简单来说就是：没有属性，只有方法。

更详细的解释可以看一下：[http ://scg.unibe.ch/archive/papers/Scha03aTraits.pdf](http://scg.unibe.ch/archive/papers/Scha03aTraits.pdf)

# java - 在 Java 中的双重算术中得到错误的答案

> ID：14187997
> 
> 赞同：1
> 
> 时间：2013-01-06T23:38:45.523
> 
> 标签：java, math, floating-point, double

> **可能重复：**
> [双重计算产生奇数结果](https://stackoverflow.com/questions/8253789/double-calculation-producing-odd-result)

我正在用 Java 编写一个处理大量双重算术的程序。我最终到了需要添加 0.6666666666666666 和 -0.666666666666667 的地步。但是，我得到的答案是 -3.3306690738754696E-16。

换句话说，

```
double d1 = 0.6666666666666666;
double d2 = -0.666666666666667;
System.out.println(d1 + d2); 
```

打印出“-3.3306690738754696E-16”。为什么会这样？

先感谢您。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-06T23:42:37.137

`double`s 不是完全准确的，并且不是每个小数都可以完美地表示为 a `double`（参见[this](http://en.wikipedia.org/wiki/Floating_point_number#Accuracy_problems)）。出于所有实际目的，`-3.3306690738754696E-16`是`0`*。但是，如果您需要更高的精度，请使用[`BigDecimal`](http://docs.oracle.com/javase/7/docs/api/java/math/BigDecimal.html). 请记住，这种替代方法不会像使用原始`double`s 那样有效。由您决定是否需要此级别的准确性并相应地做出选择。

*：显然，这个数字并不完全是零，但对于大多数现实世界的计算和计算来说，*这么*小的值是微不足道的。以米为单位，这个值小于质子和中子的直径——即非常非常小。这就是我所说的“出于所有*实际*目的”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-06T23:43:11.947

`double`values 不能精确地表示所有值，这就是一个例子。您可以`BigDecimal`改用：

```
BigDecimal bd1 = new BigDecimal("0.6666666666666666");
BigDecimal bd2 = new BigDecimal("-0.666666666666667");
System.out.println(bd1.add(bd2)); 
```

输出：

```
-4E-16 
```