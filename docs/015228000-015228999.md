# StackOverflow 问答 15228000-15228999

# c# - 动作控制器模型中的 C# MVC 和 DateTime

> ID：15228003
> 
> 赞同：7
> 
> 时间：2013-03-05T15:42:54.363
> 
> 标签：c#, jquery, asp.net-mvc, datetime

我有这个控制器动作：

```
[HttpGet]
public ActionResult CreateForm(Models.ReminderModel model)
{
    if (model.FkUserId == null && model.FkRoleId == null) {
        model.FkUserId = UserSession.Current.UserId;
        model.ReminderDate = DateTime.UtcNow;
    }

    return View(model);
} 
```

如果没有指定 URL 参数，该操作会正常运行，但是当我指定一些数据时，一切都会设置*BUT* `ReminderDate`。例如，请求是用

```
model[0][name]:FkUserId
model[0][value]:2
....
model[2][name]:ReminderDate
model[2][value]:2013-03-09T10:33:04.934Z
... 
```

**注意**：参数是序列化视图 jQuery，直到现在都可以正常工作。这是我们第一次尝试将`DateTime`回传给控制器动作。

在动作控制器中，`model.FKUserId`将正确设置，但`ReminderDate`将设置为`"0001-01-01T00:00:00.000Z"`.

我错过了什么？

****更新****

事实证明，C# 不适用于 ISO 格式的日期时间字符串。它更喜欢UTC。类似的东西`2013-03-05T16:23:00.000Z`需要作为`u20130305212358000`（EST）发送。绑定也足够了，但我认为这是最好的解决方案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T16:19:29.897

你会得到那个日期，`1/1/0001`因为当 MVC 找不到要提供的值，或者由于某种原因无法应用可用值时，日期的默认值仍然存在，即`DateTime`for`1/1/0001`或`DateTime.MinValue`. 如果您使用`DateTime?`，您将看到 null。

最好使用 Fiddler 或 Firebug 来检查请求并查看发送的值是什么。它很可能需要调整。您还可以通过 Form 集合检查当前表单的响应，也可以自己手动转换值。

一些替代方案是 MVC 模型绑定（尽管有些人提到了这种方法的缺点）。下面列出了更多信息：

*   [http://weblogs.asp.net/melvynharbour/archive/2008/11/21/mvc-modelbinder-and-localization.aspx](http://weblogs.asp.net/melvynharbour/archive/2008/11/21/mvc-modelbinder-and-localization.aspx)
*   [Asp.net MVC 中的自定义 DateTime 模型绑定器](https://stackoverflow.com/questions/2356601/custom-datetime-model-binder-in-asp-net-mvc)

# javascript - 在javascript中的固定时间后停止执行函数

> ID：15228004
> 
> 赞同：7
> 
> 时间：2013-03-05T15:42:58.003
> 
> 标签：javascript, jquery, web-worker

我需要让一个函数运行固定的秒数，然后终止。我可以使用 jQuery 或网络工作者，但我尝试这样做直接失败了。

Tks 的帮助现在有效：

```
startT = new Date().getTime();
i = 1;

while(true){
    now = new Date().getTime();
    if( (now - startT) > 100) {
        break;
    } 

    i++;
}

alert(i); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T15:45:13.843

您提出的方法不起作用，因为Javascript（大部分）是单线程的-循环以无限循环开始，因此`setTimeout`处理程序永远不会被调用，因此`keepGoing`永远不会被设置，因此循环无法完成。

确定函数完成的绝对时间是最简单的，并且每隔一段时间（即不是在每次迭代中）检查当前时间是否已超过该点。

选择一些迭代，让您在经过时间的测试效率和您准备让函数拥有的“加班”量之间取得合理的折衷。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T15:45:26.567

Count 开始无限循环，您的代码永远不会到达 setTimeout()。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T15:46:20.980

三个问题：

*   您的超时设置为在一毫秒内触发
*   您`setTimeout`将无法到达，因为`count`永远不会完成
*   您`alert`应该在,`count`之后`while`或从`setTimeout`回调内部调用。

解决这些问题，您的代码应该可以工作。不过，我可能已经预先设置了结束日期，并与`while`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-05T16:17:55.933

我不知道目的是什么，但你必须打断

```
function count() {
    while(keepGoing) {
        i = i+1;
    }
} 
```

一段时间，以便有机会`keepGoing`在同时运行的其他地方进行更改。你也永远不会这样做：

```
while(keepGoing) {
    i = i+1;
} 
```

您完全阻塞了**所有**线程......您将不得不将函数的工作分成小块并使用 setTimeout 或 setInterval 小批量运行它，如下所示，同时接近您可能想要的：

```
var piece_n=0;
var keepGoing = true; 
var interval_id = setInterval(function () {
    if(keepGoing){
        //do_a_short_piece_of_work(piece_n);
        piece_n++;
    }else{
        clearInterval(interval_id);
    }
},500); //ticking every half second

setTimeout(function () { keepGoing = false; }, 10000); //run for a small bit more than 10 to 10.5 seconds + do_a_short_piece_of_work() execution time 
```

如果您只需要 10 秒而不会饿死剩下的，您将需要在一系列 setTimeout 中进行调整，并且您需要提前知道一点（超过下一个滴答声），以便您可以在确切时间设置最后一个 setTimeout（咨询当前日期和保存的初始日期）。一切都可以分成更小的块，比如 CPU 的指令 :)

# ruby-on-rails - rspec 测试 url 参数

> ID：15228005
> 
> 赞同：0
> 
> 时间：2013-03-05T15:43:05.817
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, rspec, rspec-rails

我需要一些帮助来编写一些 rpsec 测试以从 url 接收参数。从视图生成的 url 看起来像

```
localhost:3000/tests/?my_id=2 
```

我的控制器只是接收参数。

```
@my_id = params[:my_id] 
```

我可能需要测试一个参数是否被传递，如果是，它是否是一个整数。我应该在我的控制器中测试它还是应该在我的 rspec 中测试它。

如果 ?my_id 没有通过，我不需要测试它。(localhost:3000/tests/) 我没有写太多单元测试。如果有人能指出我正确的方向，那就太好了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T17:32:05.833

如果您选择在控制器中执行此操作，则可以检查它并使用控制器输出的规范进行验证。如果您选择编写规范，也可以这样做。但这不会很好。

我对您的建议是在您的控制器中制作它并使用规范验证控制器输出。为控制器编写规范只是为了验证输出数据，而不是业务。

# ruby - Ruby，FuzzBert，无法将 Proc 转换为字符串（TypeError）

> ID：15228007
> 
> 赞同：1
> 
> 时间：2013-03-05T15:43:13.743
> 
> 标签：ruby, testing, fuzzy

我正在尝试使用 FuzzBert，但我无法使随机生成器工作。

此示例来自[官方存储库](https://github.com/krypt/FuzzBert/blob/master/examples/template.rb) ：

```
require 'fuzzbert'

fuzz "Web App" do
  deploy do |data|
    #send JSON data via HTTP
  end

  data "template" do
    t = FuzzBert::Template.new <<-EOS
      { user: { id: ${id}, name: "${name}" } }
    EOS
    t.set(:id) { FuzzBert::Generators.cycle(1..10000) }
    t.set(:name) { FuzzBert::Generators.random }
    t.generator
  end
end 
```

当我运行它（*fuzzbert myfile.rb*）时，我遇到了这个错误：

```
fuzzbert-1.0.1/lib/fuzzbert/template.rb:17:in `block (2 levels) in to_data': can't     convert Proc into String (TypeError) 
```

我试过撬解释器，我有同样的错误：

```
> t = FuzzBert::Template.new '{ user: { name: "${name}" } }'
> t.set(:name) { FuzzBert::Generators.random }
> t.to_data
TypeError: can't convert Proc into String
from /home/you/.rbenv/versions/1.9.3-p327-perf/lib/ruby/gems/1.9.1/gems/fuzzbert-1.0.1/lib/fuzzbert/template.rb:17:in `block (2 levels) in to_data' 
```

我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T17:59:31.163

Unfortunately, this was simply a bug. It has been fixed and I also released a new version 1.0.3 with updated examples. The above example would now be written as

```
require 'fuzzbert'

fuzz "Web App" do
  deploy do |data|
    #send JSON data via HTTP
  end

  data "template" do
    t = FuzzBert::Template.new <<-EOS
      { user: { id: ${id}, name: "${name}" } }
    EOS
    t.set(:id, FuzzBert::Generators.cycle(1..10000))
    t.set(:name, FuzzBert::Generators.random)
    t.generator
  end
end 
```

# javascript - JavaScript 结果黑客不起作用

> ID：15228016
> 
> 赞同：2
> 
> 时间：2013-03-05T15:43:30.537
> 
> 标签：javascript, asp.net-mvc-3, new-window

问题：让这个黑客工作我缺少什么？

对于我正在开发的 MVC 应用程序，我遇到了一个“不寻常”的案例。

我们使用 ActiveReports 生成某些报告，对于被允许的用户，在我们的布局上显示一个 ActionLink，允许访问这些报告，这些报告在新窗口中打开。该项目的方向是*所有*报告都应在新窗口中打开。

但是，有一个异常值我无法应用简单的 ActionLink 修复，因为我们使用由几乎一个下拉列表和一个文本字段组成的覆盖来访问此报告。这些组合被馈送到控制器，该控制器根据给定条件返回对动作的重定向（有一些特定的检查应该只发生在服务器上，因此我们不只是在这个覆盖层上的 JavaScript 中执行此操作对话。）

现在，我不想让像 MVC 这样的小限制（直接）不允许我重定向到新窗口阻止我，所以我尝试了给定的 JavaScriptResult hack，因为这已经是一种过时的情况，而且看起来尽管是一个黑客，但对于我的问题来说，这是最简单和最可维护的解决方案：

```
public ActionResult GenerateFooReport(string someInfo)
{
    // HACK: MVC does not allow redirects to open a new window, so
    //       return some JavaScript that forces a new window open.
    string script = "window.open('/controller/action?param=" + someInfo + "');";
    return JavaScript(script);
} 
```

当然，当我运行`Foo`导致此方法触发的操作（的输入，正确的下拉选项）时，我会看到以下输出：

```
window.open('/controller/action?param=foo') 
```

...而不是关于那段 JavaScript 应该自动打开的报告。

虽然我知道这种用法（在大多数情况下）被认为是一种反模式，但我不能随意修改 UI 以适应更可接受的用法。

问题：让这个黑客工作我缺少什么？

**编辑：**尝试了另一种也不起作用的替代实现：

```
private ActionResult GenerateFooReport(string someInfo)
{
    // HACK: MVC does not allow redirects to open a new window, so
    //       return some JavaScript that forces a new window open.
    string script = "<script>window.open('/controller/action?param=" + someInfo + "');</script>";
    return Content(script);
} 
```

这同样没有效果。

**编辑：**另一个不成功的黑客尝试：

```
private ActionResult GenerateFooReport(string someInfo)
{
    // HACK: MVC does not allow redirects to open a new window, so
    //       return a redirect to a url that executes javascript that
    //       opens the new window.
    string script = "javascript:window.open('/controller/action?param=" + someInfo + "');";
    return Redirect(script);
} 
```

**编辑：**这种情况的邪恶影响很大！新的方向已经出现，以避免控制器中的这些邪恶操作，而是在 JavaScript 中执行它们。话虽如此，我仍然对让 hack 工作的实际方法感到好奇，只是为了我自己的启迪。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-08T18:34:53.363

尝试直接调用 jquery .load 函数。

```
return JavaScript("$('#targetdiv').load('controller/action?param="+someInfo+"');"); 
```

# php - 你能用 echo 把 PHP 放在 PHP 里面吗？

> ID：15228026
> 
> 赞同：15
> 
> 时间：2013-03-05T15:43:54.590
> 
> 标签：php, html

在 html 中大量使用 PHP 的小片段的情况下，例如 Wordpress，您可以在 PHP 回显中使用 PHP 吗？

例子：

```
<?php 
    echo "<?php the_author_meta('description'); ?>";
?> 
```

尽管这可能是不必要的，但它甚至可以做到吗？如果不是，PHP 的一个方面似乎仍然让我感到有些困惑，那就是在输出 HTML 时如何结束和重新启动 PHP。

例如，克里斯在这里的回答：[如何在 PHP 中回显 HTML？](https://stackoverflow.com/questions/1100354/how-can-i-echo-html-in-php)- 我非常想`?>`在他的示例末尾加上 a ，但这会导致错误。有人可以向我指出一些全面信息的方向，说明在与 HTML 混合时如何使用 PHP 启动/停止，HTML 本身可能在其中使用 PHP 片段。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-05T15:52:41.400

尝试：

```
<?php
    echo htmlspecialchars("<?php the_author_meta('description'); ?>");
?> 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-03-05T15:50:43.300

您不能让 PHP 回显更多要评估的 PHP 代码，因为 PHP 会一次性解释您的代码。如果你有，比如说，`<?php echo '<?php echo "hello"; ?>'; ?>`你会从字面上得到文本，`<?php echo "hello"; ?>`作为输出，而解释器不会接触它。

但是，您可以随意进出 PHP：

```
<?php
echo "I am going to be interpreted by PHP.";
?>
I am not interpreted by PHP.
<?php
echo "But I am again.";
?> 
```

如果您认为需要输出本身重新评估的 PHP 代码，总有更好的方法来完成此操作。如果你给出一个你想要完成的具体例子（真实案例），那么这里的人会很乐意提供帮助。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-05T15:50:40.220

关于：“PHP 的一个方面似乎仍然让我有些困惑，那就是在输出 HTML 时如何结束和重新启动 PHP。”

```
<?php
// Do some wicked cool stuff in PHP here.
?>
<html>
<body>
Output some html here
<?php
//More awesome PHP stuff here.
?>
Back to html
</body>
</html>
<?php
// You can do any final stuff you want to do here.
?> 
```

或者你的意思更像是这样的：

```
<table>
<?php 
foreach($person as $p){
  echo "<tr>";
  echo "<td>".$p['name']."</td>";
  echo "</tr>";
}
?>
</table> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-05T15:47:46.080

是的，但这是一个可怕的想法。在这种情况下，您应该只编写函数。如果您想将多个事件“链接”在一起，请创建您自己的函数来执行此操作（例如`function describe() {the_author_meta('description');}`）

通常，您需要意识到介于两者之间`<?php`的任何内容都`?>`将被视为 PHP 块并由引擎解析。这些块中的任何东西都保持原样。如果您有具体问题，请具体询问；）

# jakarta-ee - java.lang.IllegalStateException：当 AsyncContext#complete() 时未暂停

> ID：15228031
> 
> 赞同：0
> 
> 时间：2013-03-05T15:44:00.633
> 
> 标签：jakarta-ee, servlets, glassfish

有时我的 Servlet 以这个异常结束：

```
 WARNING: StandardWrapperValve[HeartBeatServlet]: PWC1406: Servlet.service() for servlet HeartBeatServlet threw exception
java.lang.IllegalStateException: Not Suspended
    at com.sun.grizzly.tcp.Response.resume(Response.java:768)
    at org.apache.catalina.connector.Request.asyncComplete(Request.java:3993)
    at org.apache.catalina.connector.AsyncContextImpl.complete(AsyncContextImpl.java:242)
    at com.northcane.talkeen.HeartBeatServlet.doPost(HeartBeatServlet.java:47)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:688)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:770)
    at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1550)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:281)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)
    at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:655)
    at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:595)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:161)
    at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:331)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:231)
    at com.sun.enterprise.v3.services.impl.ContainerMapper$AdapterCallable.call(ContainerMapper.java:317)
    at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:195)
    at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:860)
    at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:757)
    at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1056)
    at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:229)
    at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
    at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
    at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
    at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
    at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
    at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
    at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
    at java.lang.Thread.run(Thread.java:722) 
```

这是我的 Servlet 的源代码。它唯一要做的就是处理来自 javascript 客户端的长轮询请求，并将 POST 上收到的消息发送给所有这些请求：

```
import java.io.IOException;
import java.io.PrintWriter;
import java.util.ArrayList;
import java.util.LinkedList;
import java.util.List;
import javax.servlet.AsyncContext;
import javax.servlet.ServletResponse;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

@WebServlet(name = "HeartBeatServlet", urlPatterns = {"/HeartBeatServlet"}, asyncSupported = true)
public class HeartBeatServlet extends HttpServlet {

    private List<AsyncContext> asyncContextList = new LinkedList<>();

    @Override
    public void doGet(HttpServletRequest request, HttpServletResponse response) {
        AsyncContext asyncContext = request.startAsync(request, response);
        asyncContext.setTimeout(30000);
        asyncContextList.add(asyncContext);
    }

    @Override
    public void doPost(HttpServletRequest request, HttpServletResponse response) {
        String test = request.getParameter("message");
        List<AsyncContext> asyncContexts = new ArrayList<>(asyncContextList);
        asyncContextList.clear();
        for (AsyncContext asyncContext : asyncContexts) {
            ServletResponse res = asyncContext.getResponse();
            res.setContentType("text/html");
            try {
                PrintWriter out = asyncContext.getResponse().getWriter();
                out.println(test + " <br />");
                out.flush();
                asyncContext.complete();
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
    }
} 
```

我做错了什么吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-01T18:11:43.690

（代码有多线程问题。请参阅this [SO answer](https://stackoverflow.com/a/3106909/1733060)了解如何解决它们。）

该代码将 GET 请求的 AsyncContext 存储在 List 中，并在 POST 上完成 GET 响应。但是由于超时，GET 响应可能已经隐式完成（由 servlet 容器触发）并且存储的 AsyncContext 不会反映这一点。因此，当您检索此存储的 AsyncContext 并尝试完成 GET 请求时，servlet 容器找不到需要恢复的**挂起GET 请求。**因此出现了 IllegalStateException。

请也参考这个间接回答这个问题的其他[答案。](https://stackoverflow.com/a/15458018/1733060)

# r - R：尝试使用 apply 转换 for 循环

> ID：15228039
> 
> 赞同：1
> 
> 时间：2013-03-05T15:44:16.097
> 
> 标签：r, loops, for-loop, apply, correlation

我正在尝试将两个 for 循环转换为一个应用函数和一个 for 循环，希望这会加快我的计算速度。我知道使用 apply 并不能保证更快的计算，但我想尝试一下（也是为了学习经验来熟悉 apply）

我想做的是；

计算两个矩阵的每一行的 pearson 相关系数，并得到 p 值。

两个矩阵的尺寸都约为 3000 X 100

现在我的代码看起来像这样，它已经运行了好几天......

```
cnt <- 1; 
res_row1 <- c();
res_row2 <- c();
res_corr <- c();
res_pval <- c();
for (i in (1:dim(m1)[1])) { 
  for (j in (1:dim(m2)[1])) { 
    c <- cor.test(as.matrix(m1[i,]), as.matrix(m2[j,])); 

    res_row1[cnt] <- rownames(m1)[i];
# need both row names in the output files 
    res_row2[cnt] <- rownames(m2)[j]; 

    res_corr[cnt] <- c$estimate; 
    res_pval[cnt] <- c$p.value;   
#   Storing the results for output

cnt<-cnt+1; 

  }
  comp <- (i / dim(m1[1]) * 100; 
  cat(sprintf("Row number of file 1 = %f | %f percent complete \n", i, comp))

}
results <- cbind(res_row1, res_row2, res_corr, res_pval) 
```

你们能帮帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T15:57:02.920

看一下手册`cor`：

> 如果“x”和“y”是矩阵，则计算“x”列和“y”列之间的协方差（或相关性）。

所以，我想试试：

```
cor(t(m1), t(m2)) 
```

对于 p 值，尝试使用 double`apply`函数：

```
R > x <- matrix(rnorm(12), 4, 3)
R > y <- matrix(rnorm(12), 4, 3)
R > cor(t(x), t(y))
        [,1]    [,2]    [,3]     [,4]
[1,]  0.9364  0.8474 -0.7131  0.67342
[2,] -0.9539 -0.9946  0.9936 -0.07541
[3,]  0.8013  0.9046 -0.9752 -0.25822
[4,]  0.3767  0.5541 -0.7205 -0.72040
R > t(apply(x, 1, function(a) apply(y, 1, function(b) cor(b, a))))
        [,1]    [,2]    [,3]     [,4]
[1,]  0.9364  0.8474 -0.7131  0.67342
[2,] -0.9539 -0.9946  0.9936 -0.07541
[3,]  0.8013  0.9046 -0.9752 -0.25822
[4,]  0.3767  0.5541 -0.7205 -0.72040
R > t(apply(x, 1, function(a) apply(y, 1, function(b) cor.test(b, a)$p.value)))
       [,1]    [,2]    [,3]   [,4]
[1,] 0.2283 0.35628 0.49461 0.5297
[2,] 0.1940 0.06602 0.07231 0.9519
[3,] 0.4083 0.28034 0.14201 0.8337
[4,] 0.7541 0.62615 0.48782 0.4879
R > cor.test(x[1,], y[1,])$p.value
[1] 0.2283
R > cor.test(x[1,], y[2,])$p.value
[1] 0.3563 
```

# xaml - Windows Store App 样式资源似乎无法正常工作

> ID：15228042
> 
> 赞同：0
> 
> 时间：2013-03-05T15:44:24.203
> 
> 标签：xaml, windows-runtime, windows-store-apps, winrt-xaml, app.xaml

我有一个看起来像这样的样式资源： **编辑：添加代码样式**

```
<Style x:Key="PageHeaderTextStyle" TargetType="TextBlock" BasedOn="{StaticResource HeaderTextStyle}">
    <Setter Property="TextWrapping" Value="NoWrap"/>
    <Setter Property="VerticalAlignment" Value="Bottom"/>
    <Setter Property="Margin" Value="0,0,30,40"/>
    <Setter Property="Foreground" Value="White" />
</Style> 
```

这是启动应用程序时添加的标准样式，但由于某种原因，我所有的页眉都使用黑色作为前景色而不是白色。

**编辑：这是我如何应用样式的示例**

```
<TextBlock x:Name="pageTitle" Grid.Column="1" Text="{Binding Group.Title}" Style="{StaticResource PageHeaderTextStyle}" /> 
```

在 App.xaml 中，我将 RequestedTheme 设置为“Dark”。

我哪里做错了？

# c# - 在 Informix 中确定锁所有者

> ID：15228043
> 
> 赞同：1
> 
> 时间：2013-03-05T15:44:25.920
> 
> 标签：c#, asp.net, sql, informix

我有一个 asp.net 应用程序，在某些情况下会在查询期间返回锁定错误。这很好，但我希望能够做的是记录锁的所有者以跟踪可能的行为问题（人们以更新模式打开应用程序，然后在很长一段时间内保持这种状态。）

有没有办法让 Informix 错误报告除了表之外的锁的所有者（这是它现在返回的内容）？我确实看到了[检查表是否在 Informix 中被锁定，](https://stackoverflow.com/questions/4471182/check-if-table-is-locked-in-informix)它告诉如何查询 syslocks 视图以获取锁列表，但这可能是一个广泛的列表，我只想记录我遇到失败的特定锁的所有者询问。

如果版本有所不同，我正在使用 Informix 10.0。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T01:10:59.817

简短的回答是，没有办法让 Informix 报告谁拥有您的会话遇到的锁。它不是作为标准提供的，也没有办法改变它。

# c++ - PyString_FromStringAndSize 导致分段错误

> ID：15228053
> 
> 赞同：2
> 
> 时间：2013-03-05T15:44:37.760
> 
> 标签：c++, python, python-extensions

我对 python 有一个奇怪的段错误。这是有问题的代码：

```
const std::string &fullName = child.getFullName();
const char *fName = fullName.c_str();
const int len = fullName.size();

printf(":: %02d --> %s\n", len, fName);

PyObject *item = PyString_FromStringAndSize(fName, len);
PyList_Append( list, item); 
```

我把 printf 放在那里，希望得到提示。但是长度和 fName 值是正确的。那里没有空值！

这是我从 gdb 获得的跟踪信息：

```
#0  0x0000000000423e00 in PyObject_Malloc ()
#1  0x0000000000513a3f in PyString_FromStringAndSize ()
#2  0x00007ffff554aa5e in recurseObject (list=0x9f5f38, obj=...)
    at file.cpp:59
#3  0x00007ffff554aa74 in recurseObject (list=0x9f5f38, obj=...)
    at file.cpp:62
#4  0x00007ffff554aa74 in recurseObject (list=0x9f5f38, obj=...)
    at file.cpp:62
#5  0x00007ffff554ad27 in listObjects (self=<optimized out>, args=<optimized out>)
    at file.cpp:73 
```

任何的想法 ？我试着环顾四周，但找不到关于这个主题的任何确切信息。

编辑：只是为了给这个问题增加更多的模糊性。仅当我在脚本中使用它时才会出现此错误。当我在 Python 中从命令行调用它时，一切正常！

编辑：这是我从 valgrind 得到的：

```
==27681== Invalid read of size 8
==27681==    at 0x423E00: PyObject_Malloc (in /usr/bin/python2.7)
==27681==    by 0x513A3E: PyString_FromStringAndSize (in /usr/bin/python2.7)
==27681==    by 0x7953DB4: recurseObjectChildren(_object*, Alembic::Abc::v4::IObject const&) (iarchive.cpp:55)
==27681==    by 0x7953DCA: recurseObjectChildren(_object*, Alembic::Abc::v4::IObject const&) (iarchive.cpp:58)
==27681==    by 0x7953DCA: recurseObjectChildren(_object*, Alembic::Abc::v4::IObject const&) (iarchive.cpp:58)
==27681==    by 0x7953F26: iArchive_getIdentifiers(_object*, _object*) (iarchive.cpp:69)
==27681==    by 0x498909: PyEval_EvalFrameEx (in /usr/bin/python2.7)
==27681==    by 0x498601: PyEval_EvalFrameEx (in /usr/bin/python2.7)
==27681==    by 0x498601: PyEval_EvalFrameEx (in /usr/bin/python2.7)
==27681==    by 0x49F1BF: PyEval_EvalCodeEx (in /usr/bin/python2.7)
==27681==    by 0x4A9080: PyRun_FileExFlags (in /usr/bin/python2.7)
==27681==    by 0x4A9310: PyRun_SimpleFileExFlags (in /usr/bin/python2.7)
==27681==  Address 0xffffffffffffff00 is not stack'd, malloc'd or (recently) free'd
==27681== 
==27681== 
==27681== Process terminating with default action of signal 11 (SIGSEGV)
==27681==  Access not within mapped region at address 0xFFFFFFFFFFFFFF00
==27681==    at 0x423E00: PyObject_Malloc (in /usr/bin/python2.7)
==27681==    by 0x513A3E: PyString_FromStringAndSize (in /usr/bin/python2.7)
==27681==    by 0x7953DB4: recurseObjectChildren(_object*, Alembic::Abc::v4::IObject const&) (iarchive.cpp:55)
==27681==    by 0x7953DCA: recurseObjectChildren(_object*, Alembic::Abc::v4::IObject const&) (iarchive.cpp:58)
==27681==    by 0x7953DCA: recurseObjectChildren(_object*, Alembic::Abc::v4::IObject const&) (iarchive.cpp:58)
==27681==    by 0x7953F26: iArchive_getIdentifiers(_object*, _object*) (iarchive.cpp:69)
==27681==    by 0x498909: PyEval_EvalFrameEx (in /usr/bin/python2.7)
==27681==    by 0x498601: PyEval_EvalFrameEx (in /usr/bin/python2.7)
==27681==    by 0x498601: PyEval_EvalFrameEx (in /usr/bin/python2.7)
==27681==    by 0x49F1BF: PyEval_EvalCodeEx (in /usr/bin/python2.7)
==27681==    by 0x4A9080: PyRun_FileExFlags (in /usr/bin/python2.7)
==27681==    by 0x4A9310: PyRun_SimpleFileExFlags (in /usr/bin/python2.7)
==27681==  If you believe this happened as a result of a stack
==27681==  overflow in your program's main thread (unlikely but
==27681==  possible), you can try to increase the size of the
==27681==  main thread stack using the --main-stacksize= flag.
==27681==  The main thread stack size used in this run was 8388608.
==27681== 
==27681== HEAP SUMMARY:
==27681==     in use at exit: 5,126,103 bytes in 5,336 blocks
==27681==   total heap usage: 14,574 allocs, 9,238 frees, 12,498,954 bytes allocated
==27681== LEAK SUMMARY:
==27681==    definitely lost: 76 bytes in 3 blocks
==27681==    indirectly lost: 240 bytes in 10 blocks
==27681==      possibly lost: 671,180 bytes in 1,124 blocks
==27681==    still reachable: 4,454,607 bytes in 4,199 blocks
==27681==         suppressed: 0 bytes in 0 blocks
==27681== Reachable blocks (those to which a pointer was found) are not shown.
==27681== To see them, rerun with: --leak-check=full --show-reachable=yes 
```

不太清楚这意味着什么！而且我仍然不明白为什么它在那里失败。我尝试了不同的方法，例如克隆字符串 fullName 以确保它是分配的新内存。甚至使用了新的 char[] 并在其中复制了全名。还是同样的问题，在同一个地方。

有人知道吗？它在 Python 中很常见吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T13:22:06.053

我不知道如何解释，但这绝对是因为堆之前某处损坏了。所以我设法跟踪错误的来源。

FTW：类似于：

```
Bob bob;
new (&bob) Bob(someParameter); 
```

可能不是那么超级安全！在某些情况下，它是完美的，但并非无处不在。

# python - 如何在python中计算段落中的句子数量

> ID：15228054
> 
> 赞同：1
> 
> 时间：2013-03-05T15:44:41.930
> 
> 标签：python

这是我到目前为止所拥有的，但我的段落只包含 5 个句号，因此只有 5 个句子。但它继续返回 14 作为答案。谁能帮忙？？

```
file = open ('words.txt', 'r')
lines= list (file)
file_contents = file.read()
print(lines)
file.close()
words_all = 0
for line in lines:
    words_all = words_all + len(line.split())
    print ('Total words:   ', words_all)
full_stops = 0
for stop in lines:
    full_stops = full_stops + len(stop.split('.'))
print ('total stops:    ', full_stops) 
```

这是txt文件

车床是一种根据规则表操作胶带上的符号的设备。尽管图灵机很简单，但它可以用来模拟任何计算机算法的逻辑，并且在解释计算机内部 CPU 的功能时特别有用。“图灵”机器由艾伦图灵在 1936 年描述，他称其为“自动（自动）机器”。图灵机并非旨在作为一种实用的计算技术，而是作为一种代表计算机的假设设备。图灵机帮助计算机科学家了解机械计算的局限性。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-05T15:52:57.950

使用正则表达式。

```
In [13]: import re
In [14]: par  = "This is a paragraph? So it is! Ok, there are 3 sentences."
In [15]: re.split(r'[.!?]+', par)
Out[15]: ['This is a paragraph', ' So it is', ' Ok, there are 3 sentences', ''] 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-05T15:48:41.050

如果一行不包含句点，`split`将返回一个元素：行本身：

```
>>> "asdasd".split('.')
    ['asdasd'] 
```

因此，您正在计算行数加上句点数。你为什么要把文件分成几行？

```
with open('words.txt', 'r') as file:
    file_contents = file.read()

    print('Total words:   ', len(file_contents.split()))
    print('total stops:    ', file_contents.count('.')) 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2018-11-07T18:17:38.520

最简单的方法是：

```
import nltk
nltk.download('punkt')
from nltk.tokenize import sent_tokenize

sentences = 'A Turning machine is a device that manipulates symbols on a strip of tape according to a table of rules. Despite its simplicity, a Turing machine can be adapted to simulate the logic of any computer algorithm, and is particularly useful in explaining the functions of a CPU inside a computer. The "Turing" machine was described by Alan Turing in 1936, who called it an "a(utomatic)-machine". The Turing machine is not intended as a practical computing technology, but rather as a hypothetical device representing a computing machine. Turing machines help computer scientists understand the limits of mechaniacl computation.'

number_of_sentences = sent_tokenize(sentences)

print(len(number_of_sentences)) 
```

输出：

```
5 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-05T15:47:58.717

尝试

```
print "total stops: ", open('words.txt', 'r').read().count(".") 
```

细节：

```
with open("words.txt") as f:
    data = f.read()
    print "total stops: ", data.count(".") 
```

# jsp - 在没有 JSTL 的情况下访问模型属性？

> ID：15228057
> 
> 赞同：-1
> 
> 时间：2013-03-05T15:44:50.547
> 
> 标签：jsp, spring-mvc, jstl

我正在使用 Spring MVC，并且在 JSTL 的交叉依赖项方面遇到了很多问题。是否有从原始 jsp 中访问模型属性的有效方法？例如，我如何在不使用 JSTL 的情况下翻译这个循环？

```
<tbody>
    <c:forEach items="${things}" var="thing">
        <tr>
            <td><c:out value="${thing.name}"/></td>
            <td><c:out value="${thing.description}"/></td>
        </tr>
    </c:forEach>
</tbody> 
```

我已经尝试了一些变体

```
<tbody>
    <% for (int i = 0; i < ${things}.length; i++ %>
        <tr>
            <td><${things[i].name}/></td>
            <td><${things[i].description}/></td>
        </tr>
    </c:forEach>
</tbody> 
```

但我无法获得正确的语法，并且几乎网络上的每个示例都使用 JSTL。

PS 我希望因为放弃 JSTL 而受到抨击，但严重的是，这个错误是荒谬的：

```
java.lang.AbstractMethodError: javax.servlet.jsp.PageContext.getELContext()Ljavax/el/ELContext; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T17:25:29.287

让我优先考虑以下内容：使用 JSTL 被认为是“最佳实践”

也就是说，没有什么能阻止您使用小脚本访问模型对象。例如，您可以执行以下操作：

```
<%
  Foo foo = null;
  foo = (Foo)request.getAttribute("foo");
%> 
```

但是，同样，这并不是一个真正推荐的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T22:49:12.910

最终，我最终使用了 JSTL（根据“最佳实践”）。我需要做很多排除来覆盖 Hadoop 引入的一些依赖项。这是我的排除列表：

[java.lang.AbstractMethodError: javax.servlet.jsp.PageContext.getELContext()Ljavax/el/ELContext;](https://stackoverflow.com/questions/542383/why-do-i-get-an-abstractmethoderror-when-setting-a-jstl-variable/15231992#15231992) [抽象错误](https://stackoverflow.com/questions/542383/why-do-i-get-an-abstractmethoderror-when-setting-a-jstl-variable/15231992#15231992)

# java - JAVA netbeans 的组合框问题

> ID：15228061
> 
> 赞同：0
> 
> 时间：2013-03-05T15:45:00.480
> 
> 标签：java, swing, netbeans, jcombobox, itemlistener

我正在尝试加载 2 个组合框；第二个组合框必须在第一个组合更改后加载。我正在使用netbeans，我尝试了几次，但它不起作用......要加载的项目必须与第一个组合中选择的项目的例外相同。

```
 private void firstTeamComboBoxItemStateChanged(java.awt.event.ItemEvent evt)
{                                                   
        loadSecondTeamComboBox();
    }                                                  

    private void loadSecondTeamComboBox()
    {
        String[] theTeamsInTheLeague2 = league.loadTeamsInLeague(secondTeam.getLeague());
        secondTeamComboBox.addItem("Select a Team");
        for(int i = 0; i < theTeamsInTheLeague2.length; i++)
            if (!(theTeamsInLeague2[i].equals(firstTeam.getLeague()))
                secondTeamComboBox.addItem(theTeamsInTheLeague2[i]);
    }

    private void loadFirstTeamComboBox()
    {
        String[] theTeamsInTheLeague1 = league.loadTeamsInLeague(firstTeam.getLeague());
        firstTeamComboBox.addItem("Select a Team");
        for(int i = 0; i < theTeamsInTheLeague1.length; i++)
            firstTeamComboBox.addItem(theTeamsInTheLeague1[i]);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-07T22:24:52.723

一种方法是覆盖`setSelectedItem()`并`DefaultComboBoxModel`保留对 的引用`otherTeamModel`，并根据需要从 更新它`allTeamsInTheLeague`。

```
class MyComboBoxModel extends DefaultComboBoxModel {
    private DefaultComboBoxModel otherTeamModel;

    public MyComboBoxModel(DefaultComboBoxModel otherTeamModel) {
        this.otherTeamModel = otherTeamModel;
    }
    @Override
    public void setSelectedItem(Object item) {
        super.setSelectedItem(item);
        otherTeamModel.removeAllElements();
        // add all allTeamsInTheLeague except item
    }
} 
```

# java - 可以在xml bean java spring中配置HttpSession对象吗

> ID：15228063
> 
> 赞同：0
> 
> 时间：2013-03-05T15:45:10.723
> 
> 标签：java, spring, model-view-controller, javabeans, httpsession

我可以在 spring bean xml 配置文件中配置 HttpSession 吗？我必须创建 HttpSession fectory，这样我就可以在任何地方使用所有会话对象。

有没有办法用xml配置文件将对象放在HttpSession下？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T17:49:20.610

你可以用`DelegatingHttpSessionListenerProxy`与框架类似的方式编写一个`DelegatingFilterProxy`.

例如（非常简单且未经测试）

```
public class DelegatingHttpSessionListenerProxy implements HttpSessionListener {
    private HttpSessionListener delegate;
    private WebApplicationContext wac;

    @Override
    public void sessionCreated(HttpSessionEvent event) {
        if (wac == null) {
            wac = findWebApplicationContext(event);
        }

        if (wac != null) {
            delegate = wac.getBean(HttpSessionListener.class);
            delegate.sessionCreated(event);
        }
    }

    @Override
    public void sessionDestroyed(HttpSessionEvent event) {
        if (wac == null) {
            wac = findWebApplicationContext(event);
        }

        if (wac != null) {
            delegate = wac.getBean(HttpSessionListener.class);
            delegate.sessionDestroyed(event);
        }
    }

    protected WebApplicationContext findWebApplicationContext(HttpSessionEvent event) {
        return WebApplicationContextUtils.getWebApplicationContext(event.getSession().getServletContext());
    } 
```

然后，在 web.xml 中注册代理并在应用程序上下文中管理您的实际实现。

# css - 为什么 Wordpress 不分配 我习惯于 Wordpress 自动将 IE 特定 ID 属性添加到 HTML 标记，以编写特定于 Internet Explorer 的 css 类。我刚刚注意到，当我在 IE9 中查看该站点时，此功能当前不起作用。 在 IE8... 在 IE9... 问问题 问问题 2013-03-05T15:45:15.890 1344 次 This question shows research effort; it is useful and clear 0 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. 我习惯于 Wordpress 自动将 IE 特定 ID 属性添加到 HTML 标记，以编写特定于 Internet Explorer 的 css 类。我刚刚注意到，当我在 IE9 中查看该站点时，此功能当前不起作用。 在 IE8... 在 IE9... 这是预期的行为吗？有人知道为什么是这样吗？ 可能是因为 IE8 和之前的所有奇怪的怪癖需要黑客才能解决，IE9 相对不错，所以可能不需要为其添加额外的定义。 csswordpressinternet-explorerinternet-explorer-9 4 3 回答 3 This answer is useful 2 您的 Wordpress 主题中可能已经定义了类似的内容： > 这些条件注释将被 IE 读取，并将 ID 添加到 HTML。这可能是为了加载一些 CSS，或者是特定于那个版本的 IE。 如果你愿意，你可以这样写： 并在其中添加一些特定于 IE9 的内容。 于 2013-03-05T15:49:13.217 回答 This answer is useful 1 可能是因为 IE8 和之前的所有奇怪的怪癖需要黑客才能解决，IE9 相对不错，所以可能不需要为其添加额外的定义。 于 2013-03-05T15:46:41.300 回答 This answer is useful 0 可能是因为 IE9 被认为是一个里程碑，它解决了过去困扰 WordPress 的许多问题。 如果您仍然想要这种功能，为什么不使用这样的条件注释： > 好多了对吧？这当然会进入header.php你的主题。 希望有帮助，米奇。 于 2013-03-05T15:50:28.613 回答 Related 1 javascript - 将环境细节注入 AngularJS 控制器 1 java - java swing中找不到列错误消息 1 mysql - 如何在 mysql 中为第一行选择一个唯一值，然后对该值不显示任何内容，但显示所有记录？ 2 php - 使用 shell_exec 的 GPG 加密不适用于浏览器，但适用于终端 1 ios - 在 ios 中的 openCV 示例中未启动 iOS 模拟器 1 wpf - 如何布局控件并使其可调整大小 1 android - 使用 SDK 在 twitter 上共享 android 图像 1 google-app-engine - GAE 数据存储 ID 2 android - 我们可以分享 GooglePlus_ClientID 和 GoogkePlus_simpleAPI_key 吗？ 3 internet-explorer - IE中的骨干路由器 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：15228066
> 
> 赞同：0
> 
> 时间：
> 
> 标签：css, wordpress, internet-explorer, internet-explorer-9

我习惯于 Wordpress 自动将 IE 特定 ID 属性添加到 HTML 标记，以编写特定于 Internet Explorer 的 css 类。我刚刚注意到，当我在 IE9 中查看该站点时，此功能当前不起作用。

在 IE8...

```
<html id="ie8" lang="en-US"> 
```

在 IE9...

```
<html lang="en-US"> 
```

这是预期的行为吗？有人知道为什么是这样吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T15:49:13.217

您的 Wordpress 主题中可能已经定义了类似的内容：

```
<!--[if IE 6]> <html id="ie6" <?php language_attributes(); ?>> <![endif]-->
<!--[if IE 7]> <html id="ie7" <?php language_attributes(); ?>> <![endif]-->
<!--[if IE 8]> <html id="ie8" <?php language_attributes(); ?>> <![endif]-->
<!--[if !(IE 6) | !(IE 7) | !(IE 8)]><!--> <html <?php language_attributes(); ?>> <!--<![endif]--> 
```

这些[条件注释](http://msdn.microsoft.com/en-us/library/ms537512%28v=vs.85%29.aspx)将被 IE 读取，并将 ID 添加到 HTML。这可能是为了加载一些 CSS，或者是特定于那个版本的 IE。

如果你愿意，你可以这样写：

```
<!--[if IE 9]> <html id="ie9"> <![endif]--> 
```

并在其中添加一些特定于 IE9 的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T15:46:41.300

可能是因为 IE8 和之前的所有奇怪的怪癖需要黑客才能解决，IE9 相对不错，所以可能不需要为其添加额外的定义。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T15:50:28.613

可能是因为 IE9 被认为是一个里程碑，它解决了过去困扰 WordPress 的许多问题。

如果您仍然想要这种功能，为什么不使用这样的条件注释：

```
<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="ie ie6" <?php language_attributes(); ?>> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" <?php language_attributes(); ?>> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" <?php language_attributes(); ?>> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--><html <?php language_attributes(); ?>> <!--<![endif]-->
<head>
</head>
<body>
</body>
</html> 
```

好多了对吧？这当然会进入`header.php`你的主题。

希望有帮助，米奇。

# c# - 如何使用 WinRT StreamSockets 接收数据包上传确认？

> ID：15228067
> 
> 赞同：5
> 
> 时间：2013-03-05T15:45:16.997
> 
> 标签：c#, sockets, windows-8, tcp, windows-runtime

`StreamSocket`我有一个 WinRT 应用程序，它使用和执行上传`DataWriter`。它跟踪上传所用的时间，然后计算吞吐量。

我遇到的问题是我的吞吐量比 Wireshark 显示的要高得多。这是因为我的上传循环完成并在 WinRT 框架实际将数据发送到网络层之前获取结束时间戳。我发现无法从框架接收数据包实际到达网络层的确认。该`DataWriter` `StoreAsync`方法仅返回您存储的字节数，这是我在存储它们之前就知道的。

其他框架（例如 Windows Phone）有一个回调，它会在您的数据包发送后触发，并告诉您上传了多少字节。我在 WinRT 中没有找到任何等价物，我不得不接受一个循环来记录我在`StoreAsync`函数中提交了多少字节。

有没有办法从框架中确认何时以及实际发送了多少字节到网络层？

更新：我尝试了@polkduran 的建议，虽然它们帮助减轻了一些数据包丢失，但在较小的文件上传 (100KB) 中我仍然遇到严重的数据包丢失。对于较大的文件（4MB 和 10MB），所有数据包都在发送，但结束时间仍然相差几秒钟，这会显着扭曲吞吐量计算（与 Wireshark 跟踪相比）。我的猜测是回调只是稍微减慢了上传速度，而不是提供实际的数据包上传确认。

我仍在寻找解决此问题的方法。

**编辑：我与微软创建了一个关于这个问题的支持票。他们的官方回应是在 WinRT 框架中没有办法确认一个数据包实际上已经被上传。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T16:20:51.653

我没有尝试过，但是您可以在对象的方法返回的[`Completed`](http://msdn.microsoft.com/en-us/library/windows/apps/windows.storage.streams.datawriterstoreoperation.completed)回调属性中分配一个处理程序。[`DataWriterStoreOperation`](http://msdn.microsoft.com/en-us/library/windows/apps/windows.storage.streams.datawriterstoreoperation)[`StoreAsync`](http://msdn.microsoft.com/en-us/library/windows/apps/windows.storage.streams.datawriter.storeasync)[`DataWritter`](http://msdn.microsoft.com/en-us/library/windows/apps/br208154.aspx)

或者

您可以直接使用返回操作的属性中的[`WriteAsync`](http://msdn.microsoft.com/en-us/library/windows/apps/windows.storage.streams.ioutputstream.writeasync)方法。[`OutputStream`](http://msdn.microsoft.com/en-us/library/windows/apps/windows.networking.sockets.streamsocket.outputstream)[`StreamSocket`](http://msdn.microsoft.com/en-us/library/windows/apps/br226882.aspx)[`IAsyncOperationWithProgress`](http://msdn.microsoft.com/en-us/library/windows/apps/br206594.aspx)

# objective-c - 打开在 UIWebview 上查看的任何 PDF

> ID：15228069
> 
> 赞同：1
> 
> 时间：2013-03-05T15:45:23.010
> 
> 标签：objective-c, uiwebview

好吧，过去几周我一直在搜索和测试，我是这个 xcode 的新手，但我知道足以让应用程序启动并运行。所以我一直遇到的问题是添加这个开放功能。我可以让它与本地 pdf 一起工作（我在应用程序上手动和本地加载的 pdf），但我似乎无法让它适用于我目前在应用程序上查看的 PDF。假设我打开了一个 PDF，其中一个我没有加载到应用程序上，我什至不知道 URL 是什么，一个随机的，我似乎无法弄清楚如何获得打开操作按钮工作。这是我的代码。哦，顺便说一句，我正在尝试打开 Adob​​e Reader，我可以再次使用本地 pdf 成功完成它，我已经安装了应用程序和一切。请帮忙！

1.）注意：我知道这会在本地加载 PDF 有效：

```
- (IBAction)shareButton:(id)sender;{

    NSString * currentURL = _webview.request.URL.absoluteString;
    NSString * filename = [currentURL stringByDeletingPathExtension];
    NSLog(filename);
    NSString * filePath = [[NSBundle mainBundle]pathForResource:@"OOP_ObjC" ofType:@"pdf"];
    NSLog(filePath);
    docController =[UIDocumentInteractionController interactionControllerWithURL:[NSURL fileURLWithPath:currentURL]];
    docController.delegate = self;
    docController.UTI = @"com.adobe.pdf";
    [docController presentOpenInMenuFromBarButtonItem:_shareButton animated:YES];

    [super viewDidLoad] 
} 
```

* * *

2.) 注意：这就是我一直试图用来下载 PDF 并在本地加载的内容。但我不断收到`-[NSURL initFileURLWithPath:];`零字符串参数'

```
- (IBAction)shareButton:(id)sender;{

     NSString * currentURL = _webview.request.URL.absoluteString;
     NSString * filename = [currentURL stringByDeletingPathExtension];
     NSData *pdfData = [[NSData alloc] initWithContentsOfURL:[NSURL URLWithString:filename]];

     //Store the Data locally as PDF File

     NSString *resourceDocPath = [[NSString alloc] initWithString:[[[[NSBundle mainBundle]  resourcePath] stringByDeletingLastPathComponent] stringByAppendingPathComponent:@"Documents"]];
     NSString *filePath = [resourceDocPath stringByAppendingPathComponent:@"mypdf.pdf"];
    [pdfData writeToFile:filePath atomically:YES];

    //Now create Request for the file that was saved in your documents folder

    NSURL *url = [NSURL fileURLWithPath:filePath];
    NSURLRequest *requestObj = [NSURLRequest requestWithURL:url];
    [webView setUserInteractionEnabled:YES];
    [webView setDelegate:self];
    [webView loadRequest:requestObj];

    NSLog(filePath);
    NSString * path =
    [[NSBundle mainBundle]pathForResource:filePath ofType:@"pdf"];
    docController =[UIDocumentInteractionController interactionControllerWithURL:[NSURL fileURLWithPath:path]];
    docController.delegate = self;
    docController.UTI = @"com.adobe.pdf";
    [docController presentOpenInMenuFromBarButtonItem:_shareButton animated:YES];

    [super viewDidLoad] 
} 
```

* * *

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T15:52:59.457

```
 NSString * path =
    [[NSBundle mainBundle]pathForResource:filePath ofType:@"pdf"]; 
```

在第二种方法（webView 一）中，您正在搜索应用程序包中的文件..但是您将其保存在应用程序的文档文件夹中..不是应用程序包。删除该行

并改变这个

```
docController =[UIDocumentInteractionController interactionControllerWithURL:[NSURL fileURLWithPath:path]]; 
```

**至**

```
docController =[UIDocumentInteractionController interactionControllerWithURL: url]; // url is of the file that you saved by downloading. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T13:40:36.087

当然，在 Shaggy 的帮助下找到了答案，请竖起大拇指，这样每个人都可以看到如何让它工作，（因为它确实花了我几个月的时间！）我添加了所有代码。

```
#import <UIKit/UIKit.h>

@interface NinthViewController : UIViewController  <UIDocumentInteractionControllerDelegate> {
    IBOutlet UIWebView *webView;
    UIDocumentInteractionController *docController;
}
- (IBAction)shareButton:(id)sender;
@property (weak, nonatomic) IBOutlet UIActivityIndicatorView *activityind;
@property (weak, nonatomic) NSTimer *timer;
@property (nonatomic, retain) UIDocumentInteractionController *docController;
@end 
```

* * *

```
#import "NinthViewController.h"

@interface NinthViewController ()
@end
@implementation NinthViewController
@synthesize docController;

-(void)webView:(UIWebView *)X didFailLoadWithError:(NSError *)error {
    UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Error" message:@"Can't connect. Please check your internet connection and try again." delegate:self cancelButtonTitle:@"Ok" otherButtonTitles:@"Try again", nil];
    [alert show];

}

//Implement the 'Try again' button action
- (void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex{
    if (buttonIndex == 1) {
        NSURL *url = [NSURL URLWithString:@"YOUR MAIN  URL SITE"];
        NSURLRequest *req = [NSURLRequest requestWithURL:url];
        [[NSURLCache sharedURLCache] removeAllCachedResponses];
        [webView loadRequest:req];
    }
}

- (void)viewDidLoad
{
    NSString *website = @"YOUR MAIN URL SITE";
    NSURL *url = [NSURL URLWithString:website];
    NSURLRequest *requestUrl = [NSURLRequest requestWithURL:url];
    (webView.scalesPageToFit = YES);
    [webView loadRequest:requestUrl];
    [webView addSubview:_activityind];
    _timer = [NSTimer scheduledTimerWithTimeInterval:(1.0/2.0) target:self selector:@selector(loading) userInfo:nil repeats:YES];
}

- (IBAction)shareButton:(id)sender
{
    NSString * currentURL = webView.request.URL.absoluteString;
    NSData *pdfData = [[NSData alloc] initWithContentsOfURL:[NSURL URLWithString:currentURL]];
    NSString *resourceDocPath = [[NSString alloc] initWithString:[[[[NSBundle mainBundle]  resourcePath] stringByDeletingLastPathComponent] stringByAppendingPathComponent:@"Documents"]];
    NSString* theFileName = [[currentURL lastPathComponent] stringByDeletingPathExtension];
    NSString *filePath = [resourceDocPath stringByAppendingPathComponent:[theFileName stringByAppendingString:@".pdf"]];
    [pdfData writeToFile:filePath atomically:YES];
    NSURL *url = [NSURL fileURLWithPath:filePath];
    [NSURLRequest requestWithURL:url];
    [webView setUserInteractionEnabled:YES];
    docController =[UIDocumentInteractionController interactionControllerWithURL:url];
    docController.delegate = self;
    [docController presentOpenInMenuFromBarButtonItem:sender animated:YES];
    [super viewDidLoad];
}

-(void)loading {

    if (!webView.loading)
        [_activityind stopAnimating];
    else
        [_activityind startAnimating]; 
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}
@end 
```

# wpf - F# dispatcher.invoke 和委托方法

> ID：15228079
> 
> 赞同：6
> 
> 时间：2013-03-05T15:45:35.653
> 
> 标签：wpf, f#, dispatcher

我寻找这个问题的解决方案很长时间没有成功。

我正在将我的一些 C# 代码移植到 F#，并且我正在努力使用 Dispatcher.Invoke 来获取 WPF 元素。由于我是 F# 的菜鸟，我唯一确定的是问题出在椅子和键盘之间。

这是我的 C# 代码：

```
foreach (var k  in ChartList.Keys)            
        {
            ChartList[k].Dispatcher.Invoke(
              System.Windows.Threading.DispatcherPriority.Normal,
              new Action(
                delegate()
                {
                    ChartList[k].Width = area.Width / totalColsForm;
                    ChartList[k].Height = area.Height / totalRowsForm;
                    ChartList[k].Left = area.X + ChartList[k].Width * currentCol;
                    ChartList[k].Top = area.Y + ChartList[k].Height * currentRow;
                    ChartList[k].doShow();
                }
            ));
         } 
```

我正在努力的部分是新的 Action(delegate() ... )。编译器不喜欢我的任何翻译尝试。

这个片段在 F# 中的翻译是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-05T16:51:33.127

该`Invoke`方法有几个重载，所以如果你有一些不完全正确的操作，你可能会遇到一些奇怪的错误，因为类型检查器不知道要调用哪个重载。我刚试过这个，效果很好：

```
open System
open System.Windows.Controls
open System.Windows.Threading

let b = Button()
b.Dispatcher.Invoke(
    DispatcherPriority.Normal,
    Action(fun () -> 
        b.Content <- "foo"
    )) |> ignore 
```

# javascript - 窗口调整大小后调用函数的问题

> ID：15228080
> 
> 赞同：-4
> 
> 时间：2013-03-05T15:45:36.107
> 
> 标签：javascript, jquery, window-resize

我在让它工作时遇到问题。我正在使用 jQuery 来调用在调整浏览器窗口大小时运行的 resizeWindow 函数。resizeWindow 函数确实按预期工作，但是，调整浏览器窗口大小似乎并没有调用该函数再次运行。

```
$(document).ready(function(){
    //Bind the window onresize event
    $(window).bind('resize', resizeWindow);

    //Call resizeWindow() function immediately to intially set elements
    $(window).bind('load', resizeWindow);
});

function resizeWindow(){
    //Find all the container parent objects
    $('.container').each(function(){
            //Initialize the height variable
            var maxHeight = 0;

            //Cache the jQuery object for faster DOM access and performance
            var $borders = $(this).find('.border');

            //Find all the border child elements within this specific container
            $borders.each(function(){
                    //Get current element's height
                    var thisHeight = $(this).height();

                    //Check if the current height is greater than the max height thus far
                    //If so, change max height to this height
                    if (thisHeight>maxHeight) maxHeight = thisHeight;
            });

            //Now that we have the maximum height of the elements,
            //set that height for all the .border child elements inside the parent element
            $borders.height(maxHeight);
    });
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T15:53:52.793

我相信您在第一次调用该函数时手动设置了边框的高度，它会在调整窗口大小时停止调整大小。

尝试在之后添加此行`var $borders`：

```
$borders.css({height:'auto'}); 
```

# css - 背景 img 响应式设计

> ID：15228081
> 
> 赞同：0
> 
> 时间：2013-03-05T15:45:36.713
> 
> 标签：css, twitter-bootstrap, responsive-design

我正在尝试在背景图像上使用悬停，如下所示：

```
.featuredimg{background: url('[imgPathHere]');
             width:370px;
             height:430px;}
.featuredimg:hover{background: url('[imgPathHere]')0px -430px;} 
```

问题是我正在使用 twitter 引导程序，以便该站点具有响应性。如何在允许图像缩放的同时继续使用背景 img 悬停。现在，无论窗口大小如何，图像都保持相同的宽度和高度。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T16:25:44.830

使用**:before / :after**或**background-size**属性来缩放背景图像。

# ios - 通过 layoutSubviews 自定义 UIAlertButton => UIAlertButton class not found

> ID：15228088
> 
> 赞同：1
> 
> 时间：2013-03-05T15:46:00.247
> 
> 标签：ios, objective-c, xcode, ipad, uialertview

我正在尝试使用本[教程](http://mobile.tutsplus.com/tutorials/iphone/ios-sdk-uialertview-custom-graphics/)实现自定义警报视图。这篇文章中的所有内容都运行良好，但它并没有谈到自定义 UIAlertButton。然后，我尝试通过 layoutSubviews 方法对其进行自定义：

```
- (void)layoutSubviews
{
    for (UIView *subview in self.subviews){ //Fast Enumeration
        if ([subview isMemberOfClass:[UIImageView class]]) {
            subview.hidden = YES; //Hide UIImageView Containing Blue Background
        }
        if ([subview isMemberOfClass:[UILabel class]]) { //Point to UILabels To Change Text
            UILabel *label = (UILabel*)subview; //Cast From UIView to UILabel
            label.textColor = [UIColor colorWithRed:210.0f/255.0f green:210.0f/255.0f blue:210.0f/255.0f alpha:1.0f];
            label.shadowColor = [UIColor blackColor];
            label.shadowOffset = CGSizeMake(0.0f, 1.0f);
        }
        if ([subview isMemberOfClass:[UIAlertButton class]]) {
            // do blablabla
        }
    }
} 
```

特别是我添加的是：

```
if ([subview isMemberOfClass:[UIAlertButton class]]) {
     // do blablabla
} 
```

但是找不到 UIAlertButton 类，为什么？谢谢

编辑：这是我的最终工作代码，感谢 nsguliver。

CustomAlertView.h

```
#import <UIKit/UIKit.h>

@interface CustomAlertView: UIAlertView {
    NSMutableArray *fakeButtonIndexList;
    NSMutableArray *buttonList;
}

-(void)addCustomButton:(NSString*)title;

@end 
```

CustomAlertView.m

```
#import "CustomAlertView.h"

@implementation CustomAlertView

-(id) initWithTitle:(NSString *)title message:(NSString *)message delegate:(id)delegate cancelButtonTitle:(NSString *)cancelButtonTitle otherButtonTitles:(NSString *)otherButtonTitles, ... {
    self = [super initWithTitle:title message:message delegate:delegate cancelButtonTitle:cancelButtonTitle otherButtonTitles:otherButtonTitles, nil];

    if (self) {
        buttonList = [NSMutableArray array];
        fakeButtonIndexList = [NSMutableArray array];
    }

    return self;
}

-(void)layoutSubviews {
    for (UIView *subview in self.subviews){ //Fast Enumeration

        // Image de fond
        if ([subview isMemberOfClass:[UIImageView class]]) {
            subview.hidden = YES; //Hide UIImageView Containing Blue Background
        }
        // Label
        if ([subview isMemberOfClass:[UILabel class]]) { //Point to UILabels To Change Text
            UILabel *label = (UILabel*)subview; //Cast From UIView to UILabel
            label.shadowColor = [UIColor blackColor];
            label.shadowOffset = CGSizeMake(0.0f, 1.0f);
        }
    }
}

-(void)drawRect:(CGRect)rect {
    //////////////GET REFERENCE TO CURRENT GRAPHICS CONTEXT
    CGContextRef context = UIGraphicsGetCurrentContext();

    //////////////CREATE BASE SHAPE WITH ROUNDED CORNERS FROM BOUNDS
    CGRect activeBounds = self.bounds;
    CGFloat cornerRadius = 10.0f;
    CGFloat inset = 6.5f;
    CGFloat originX = activeBounds.origin.x + inset;
    CGFloat originY = activeBounds.origin.y + inset;
    CGFloat width = activeBounds.size.width - (inset*2.0f);
    CGFloat height = activeBounds.size.height - (inset*2.0f);

    CGRect bPathFrame = CGRectMake(originX, originY, width, height);
    CGPathRef path = [UIBezierPath bezierPathWithRoundedRect:bPathFrame cornerRadius:cornerRadius].CGPath;

    //////////////CREATE BASE SHAPE WITH FILL AND SHADOW
    CGContextAddPath(context, path);
    CGContextSetFillColorWithColor(context, [UIColor colorWithRed:40.0f/255.0f green:40.0f/255.0f blue:40.0f/255.0f alpha:1.0f].CGColor);
    CGContextDrawPath(context, kCGPathFill);

    //////////////CLIP STATE
    CGContextSaveGState(context); //Save Context State Before Clipping To "path"
    CGContextAddPath(context, path);
    CGContextClip(context);

}

-(void)show {
    [super show];

    // On redéfinit les frames des boutons
    NSInteger indexCustomButton = 0;
    for (NSString *indexStr in fakeButtonIndexList) {

        UIButton *customButton = (UIButton*)[buttonList objectAtIndex:indexCustomButton];
        UIButton *fakeButton = (UIButton*)[self.subviews objectAtIndex:[indexStr integerValue]];
        [customButton setFrame:fakeButton.frame];

        indexCustomButton++;
    }
}

-(void)addCustomButton:(NSString *)title {
    [self addButtonWithTitle:title];
    UIButton *fakeButton = [self.subviews lastObject];
    [fakeButton setHidden:YES];
    [fakeButtonIndexList addObject:[NSString stringWithFormat:@"%d",[self.subviews count]]];

    UIButton *button = [UIButton buttonWithType:UIButtonTypeCustom];
    [button setFrame:fakeButton.frame];
    [button setTitle:title forState:nil];
    [button setBackgroundColor:[Templates getColor:@"color"]];
    [button.layer setCornerRadius:5.0f];

    [buttonList addObject:button];
    [self addSubview:button];
}

@end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T16:11:14.947

您可以`UIAlertView`通过首先将两个按钮标题保留为`nil`然后添加自定义按钮来自定义按钮的一种方法`subview`，您可以`CustomAlertView` 查看以下代码测试我自己。

```
CustomAlertVIew *alert =[[CustomAlertVIew alloc]initWithTitle:@"title" message:@"message" delegate:nil cancelButtonTitle:nil otherButtonTitles:nil, nil];

// add the custom button
UIImage *buttonImage = [UIImage imageNamed:@"image.png"];

//create the button and assign the image
UIButton *alertButton = [UIButton buttonWithType:UIButtonTypeCustom];
[self.alertButton setFrame:CGRectMake(x,y,buttonImage.size.width,buttonImage.size.height)];

[alertButton setBackgroundImage:buttonImage forState:UIControlStateNormal];
alertButton.titleLabel.font = [UIFont boldSystemFontOfSize:12];
[alertButton setTitle:@"Done" forState:UIControlStateNormal];
[alertButton addTarget:self action:@selector(backMethod)  forControlEvents:UIControlEventTouchUpInside];

[alert addSubview:alertButton];
[alert show]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-27T12:30:39.767

您的问题已经得到很好的回答，但我的解决方案可能更短更清晰。首先，我创建了一个变量来跟踪子视图数组中的按钮索引。我假设 AlertViewButtons 是最后的子视图：

```
int buttonIndexInSubviews = (self.subviews.count - self.numberOfButtons); 
```

然后我遍历子视图，如图所示，而 if 语句的形成方式不同。诀窍是将 AlertViewButton 转换为超类。

```
if (subview == [self.subviews objectAtIndex:buttonIndexInSubviews]) {
        UIButton *button = (UIButton*)subview;

        //Here you can change the button appearance via the variable
        //E.g. button.titleLabel.shadowOffset = CGSizeMake(0.0f, 0.0f);

        buttonIndexInSubviews++;
    } 
```

顺便说一句，这种解决方法得到了 Apple 的批准。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-22T15:40:05.203

或者您可以像这样测试 UIAlertButton 类：

```
if ([subview isMemberOfClass:NSClassFromString(@"UIAlertButton")]) {
    // do your customizing here...
} 
```

# java - 动态调用方法

> ID：15228092
> 
> 赞同：1
> 
> 时间：2013-03-05T15:46:05.233
> 
> 标签：java, reflection

我需要一点帮助，如果您知道如何解决我的问题，请告诉我。

假设我有这门课：

```
public testClass{

    public int example1(){
    return 2;
    }
    public int example2(){
    return 0;
    }
    public int example3(){
    return 456;
    }
} 
```

我想要一种方法，它可以做同样的事情，但以一种动态的方式

```
public int methodeSwitch(int a){
   if (a==1){return method1;}
   if (a==2){return method2;}
   if (a==3){return method3;}
   return null;
} 
```

我的问题是我有一个包含 50 多个字段的庞大类（dto），所以我想根据我目前使用的字段使用 getter 和 setter（是的，动态的）。我知道如何访问字段（使用 java.lang.Field，wouuu），但我不知道如何通过名称转换方法（将动态创建）。

只是给我一个提示将是惊人的！

谢谢法比恩

编辑：澄清一下，我必须编写一个基本上使用我班级的每个设置器的方法，所以如果我可以使用类似的东西

```
useMethod("set"+fields[i]+"();"); 
```

这会很有帮助，并且可以防止我编写数十行代码。

再次感谢帮助的人！;)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T15:58:34.630

您需要使用反射从您的类中获取声明的方法。我假设这些方法存在于您要在其上调用 getter/setter 的类中，这`fields`是一个`String[]`字段名称。

```
private Object callGet(final String fieldName) throws NoSuchMethodException, IllegalAccessException, IllegalArgumentException, InvocationTargetException {
    final Method method = getClass().getDeclaredMethod("get" + fieldName.substring(0, 1).toUpperCase() + fieldName.substring(1));
    return method.invoke(this, (Object[]) null);
}

private void callSet(final String fieldName, final Object valueToSet) throws NoSuchMethodException, IllegalAccessException, IllegalArgumentException, InvocationTargetException {
    final Method method = getClass().getDeclaredMethod("set" + fieldName.substring(0, 1).toUpperCase() + fieldName.substring(1), new Class[]{valueToSet.getClass()});
    method.invoke(this, new Object[]{valueToSet});
} 
```

您还可以查看[Commons BeansUtil](http://commons.apache.org/proper/commons-beanutils//)，这是一个专为执行此操作而设计的库...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T15:51:34.357

您可以使用反射 API 和`Method.invoke`：

[http://docs.oracle.com/javase/6/docs/api/java/lang/reflect/Method.html#invoke%28java.lang.Object,%20java.lang.Object...%29](http://docs.oracle.com/javase/6/docs/api/java/lang/reflect/Method.html#invoke%28java.lang.Object,%20java.lang.Object...%29)

事件虽然我相信这不是一个好的做法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T16:00:49.477

使用反射，您可以尝试这样的事情。

```
public int methodeSwitch(int a)  {
    Map<Integer,String> methods = new HashMap<Integer,String>();
    methods.put(1, "example1");
    methods.put(2, "example2");
    methods.put(3, "example3");

    java.lang.reflect.Method method;
    try {
        method = this.getClass().getMethod(methods.get(a));
        return (Integer) method.invoke(this);
    } catch(Exception ex){//lots of exception to catch}
    return 0;
} 
```

这只是一个概念证明。当然，您应该在另一个地方初始化您的动态方法（静态初始化），并检查`methods.get(a)`它是否不在有效范围内等。

# vba - 在用户可见之前隐藏打开的工作簿

> ID：15228095
> 
> 赞同：1
> 
> 时间：2013-03-05T15:46:17.233
> 
> 标签：vba, excel

我像这样进入工作簿打开事件：

```
Private WithEvents App As Application ' For handling events

' Event handler for when THIS workbook is opened.
Private Sub Workbook_Open()
    Set App = Application ' Set App variable so we can add event handlers
    App.EnableEvents = True ' Set raise events = true.
End Sub

' Event handler to handle the event when a new workbook is open (ie. when Raven Viewer exports to a new workbook in excel
Private Sub App_WorkbookOpen(ByVal Wb As Workbook)
    Wb.Windows(1).Visible = False
End Sub 
```

它隐藏了在此电子表格打开时打开的所有工作簿......但在短时间内，它们对用户可见。有什么办法可以防止这种情况吗？

我试图防止当前打开的工作簿失去任何焦点。

工作簿未使用 VBA 打开。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T18:33:04.053

使用 `App_WindowActivate`似乎对我来说效果更好，但我并不积极：

```
Private Sub App_WindowActivate(ByVal Wb As Workbook, ByVal Wn As Window)
If Not Wn Is ThisWorkbook.Windows(1) Then
    Application.EnableEvents = False
    Wn.Visible = False
    ThisWorkbook.Windows(1).Visible = True
    Application.EnableEvents = True
End If
End Sub 
```

# sql - 将 SQL 查询转换为 MS-Access SQL

> ID：15228105
> 
> 赞同：1
> 
> 时间：2013-03-05T15:46:49.093
> 
> 标签：sql, ms-access

只是试图让我的 SQL 查询在 MS-Access 中工作，但它不想。我试图找到一个指南或关于这个的东西，因为我知道它发生了很多时间并且它通常只是添加一些括号，但是尽管我做了所有尝试，我仍然无法让这个查询工作：

```
SELECT t1.Name AS lev1, t2.Name as lev2, t3.Name as lev3, t4.Name as lev4
FROM Folder AS t1
LEFT JOIN Folder AS t2 ON t2.Parent = t1.ObjId 
LEFT JOIN Folder AS t3 ON t3.Parent = t2.ObjId 
LEFT JOIN Folder AS t4 ON t4.Parent = t3.ObjId 
WHERE t1.ObjId = '123456789'; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T15:52:47.573

MS Access 需要在每个连接周围加上括号。当您有多表连接时，您将有几个：

```
SELECT t1.Name AS lev1, t2.Name as lev2, t3.Name as lev3, t4.Name as lev4
FROM ((Folder AS t1
LEFT JOIN Folder AS t2 ON t2.Parent = t1.ObjId)
LEFT JOIN Folder AS t3 ON t3.Parent = t2.ObjId)
LEFT JOIN Folder AS t4 ON t4.Parent = t3.ObjId 
WHERE t1.ObjId = '123456789'; 
```

格式化后看起来像这样：

```
SELECT t1.Name AS lev1, t2.Name as lev2, t3.Name as lev3, t4.Name as lev4
FROM 
(
    (
        Folder AS t1
        LEFT JOIN Folder AS t2 ON t2.Parent = t1.ObjId
    )
    LEFT JOIN Folder AS t3 ON t3.Parent = t2.ObjId
)
LEFT JOIN Folder AS t4 ON t4.Parent = t3.ObjId 
WHERE t1.ObjId = '123456789'; 
```

# c# - 使用 system.diagnostics 服务器端跟踪时活动范围的粒度

> ID：15228108
> 
> 赞同：1
> 
> 时间：2013-03-05T15:47:15.503
> 
> 标签：c#, .net, trace, system.diagnostics

我正在使用 System.Diagnostics 中的跟踪功能，并且遇到了各种各样的问题。我已经在我的应用程序中实现了自我跟踪，没有任何问题，但是我正在努力寻找一些最佳实践。或者更简单地说，我理解如何，但不知道为什么。

我有一个 RESTful 客户端/服务器应用程序，其中客户端是 Web 浏览器，服务器不会在其他任何地方进行任何调用（例如，没有 WCF 调用其他服务器进程）。

我试图弄清楚的概念是活动的概念。跟踪在概念上分组在一起，允许您查看特定活动的所有跟踪消息。在单个页面加载期间，我将对各种类进行多次调用，从数据库中获取数据，对数据执行业务逻辑等。

Activity 应该有多细？“页面加载是单个 Activity”或“每个方法调用都是新的子 Activity”的极端情况？或者是中间的东西，也许：'数据访问调用和页面加载的业务逻辑调用都是子活动，其他一切都在主页加载活动之下'？

另一个概念是`CorrelationManager.StartLogicalOperation`方法的概念。同样，它的实现并不棘手，但要理解为什么要使用它。这似乎允许您在逻辑操作名称下将一组跟踪分组在一起。然而，这里似乎与跟踪活动组的概念有重叠。这两个概念应该一起使用吗？为什么/在什么情况下您会使用其中一种？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T20:09:38.760

我认为这些概念（活动和逻辑操作）是正交的。你可以有一个里面有很多 LogicalOperations 的 Activity。或者，您可以有一个 Activity 可以更改的 LogicalOperation。我猜想 Activity 比 LogicalOperation 更高级别会更常见。

我这么说可能不是很有帮助，但是就组织日志记录而言，由您决定什么对您和您的应用程序最有意义。

我怀疑一个请求导致一个活动是很常见的。

您可能会发现帮助类有助于更轻松地管理 Activity 和 LogicalOperation。像这样的东西：

```
class ActivityScope : IDisposable
{
  Guid oldActivity;
  ActivityScope()
  {
    oldActivity = System.Diagnostics.CorrelationManager.ActivityId;
    System.Diagnostics.CorrelationManager.ActivityId = Guid.NewGuid();
  }

  public void Dispose()
  {
    System.Diagnostics.CorrelationManager.ActivityId = oldActivity;
  }
}

class LogicalOperationScope : IDisposable
{
  public LogicalOperationScope(string logicalOperation)
  {
    System.Diagnostics.CorrelationManager.StartLogicalOperation(logicalOperation);
  }

  public void Dispose()
  {
    System.Diagnostics.CorrelationManager.StopLogicalOperation();
  }
} 
```

你可以像这样使用它们：

```
void ServiceARequest()
{
  using (new ActivityScope())
  {
    //Do some stuff

    using (new LogicalOperationScope("SomeWork"))
    {
      DoSomeWork();

      for (int i = 0; i < 10; i++)
      {
        using (new LogicalOperationScope(string.Format("nested {0}", i))
        {
          DoNestedWork(i);
        }
      }
    }
  }
}

void DoSomeWork()
{
  using (new LogicalOperationScope("DoSomeWork"))
  {
  }
}

void DoNestedWork(int level)
{
} 
```

显然，我的示例重于诊断代码而轻于实际代码，但您明白了。如果拥有 ActivityId 或 LogicalOperation 对您有意义，请尝试使用与此类似的“范围”类来管理它们。

祝你好运！

# ruby-on-rails - 如果独角兽工人重生过快，Monit 会在停止独角兽工人时超时

> ID：15228109
> 
> 赞同：2
> 
> 时间：2013-03-05T15:47:16.217
> 
> 标签：ruby-on-rails, timeout, unicorn, monit

我正在尝试用 monit 监控独角兽工人，所以当他们达到一定的内存阈值时，它会优雅地杀死他们。

**问题：**

当我告诉 monit 重新启动一个工作人员时，它首先尝试停止它，触发我的`/etc/init.d/unicorn kill_worker 0`脚本命令。

```
# my /etc/monit/config.d/unicorn file
check process orly_unicorn_worker_0 with pidfile /tmp/unicorn.orly.0.pid
  start program = "/bin/true"
  stop program = "/etc/init.d/unicorn_orly kill_worker 0" 
```

当我通过`top`命令监视进程时，我看到了工人是如何被杀死的，以及主人如何用另一个 pid 产生一个新的工人。

但是，Monit 会等待一段时间并在其日志中抛出“停止失败”错误。它实际上是在等待 30 秒并超时。

一旦超时，monit 会识别出`restart action is done`，然后注意到 worker PID 已更改并继续按预期监视进程。

结果一切正常，monit 能够在需要时重新启动工作人员并继续监视它们，但是日志中充满了错误，Web 界面`execution failed`在工作人员上显示了令人讨厌（且令人困惑）的错误状态，我猜它会如果设置了错误的电子邮件警报，则发送错误的电子邮件警报。

这是日志的相关部分，当我尝试通过 Web 界面重新启动工作人员时（注意它也与工作人员的父 PID 混淆）：

```
[UTC Mar  5 13:29:17] info     : 'orly_unicorn_worker_0' trying to restart
[UTC Mar  5 13:29:17] info     : 'orly_unicorn_worker_0' stop: /etc/init.d/unicorn_orly
[UTC Mar  5 13:29:47] error    : 'orly_unicorn_worker_0' failed to stop
[UTC Mar  5 13:29:47] info     : 'orly_unicorn_worker_0' restart action done
[UTC Mar  5 13:29:47] error    : 'orly_unicorn_worker_0' process PID changed to 13699
[UTC Mar  5 13:29:49] error    : 'orly_unicorn_worker_0' process PPID changed to 0
[UTC Mar  5 13:30:19] info     : 'orly_unicorn_worker_0' process PID has not changed since last cycle
[UTC Mar  5 13:30:19] error    : 'orly_unicorn_worker_0' process PPID changed to 13660
[UTC Mar  5 13:30:49] info     : 'orly_unicorn_worker_0' process PPID has not changed since last cycle 
```

我花了很长时间才弄清楚，但是这里发生的事情是工人被杀死然后很快重生，以至于 monit 甚至没有注意到变化。

我的猜测是，monit 在执行停止操作时会读取`/tmp/unicorn.orly.0.pid`以获取进程的 pid，然后查看该进程是否仍然存在。

然而，由于*kill-respawn worker 操作*发生得如此之快，monit 并没有意识到 worker 的 pid 已经改变并一直在等待（全新的）worker 死亡。然后它超时，然后它意识到pid实际上已经改变并且它正常运行。

**我发现的肮脏解决方案：**

为了证明这个假设，我试图减慢提到的*kill-respawn worker 操作*。所以我编辑了 unicorn 配置文件，让新工作人员在`/tmp/unicorn.orly.0.pid`.

我是这样做的：

```
after_fork do |server, worker|
  sleep 3

  # write down the new worker PID so monit can monitor it
  child_pid = server.config[:pid].sub(".pid", ".#{worker.nr}.pid")
  system("echo #{Process.pid} > #{child_pid}")
end 
```

而且效果非常好：晴天鸟语花香，网络界面现在显示`process running`状态不错，日志显示一切顺利，看看：

```
[UTC Mar  5 13:30:44] info     : 'orly_unicorn_worker_0' trying to restart
[UTC Mar  5 13:30:44] info     : 'orly_unicorn_worker_0' stop: /etc/init.d/unicorn_orly
[UTC Mar  5 13:30:45] info     : 'orly_unicorn_worker_0' stopped
[UTC Mar  5 13:30:45] info     : 'orly_unicorn_worker_0' start: /bin/true
[UTC Mar  5 13:30:46] info     : 'orly_unicorn_worker_0' restart action done 
```

**问题：**

有没有实现这一目标的*监控方式？*让我的工人睡 3 秒钟似乎不是一个好的解决方案。有任何想法吗？

我知道这不是 monit 的正常情况。我们打破了monit的*重启过程循环*，因为我们不希望`start program`monit执行任何操作，而是让独角兽主进程处理它（如这里解释：http: [//www.stopdropandrew.com/ 2010/06/01/where-unicorns-go-to-die-watching-unicorn-workers-with-monit.html](http://www.stopdropandrew.com/2010/06/01/where-unicorns-go-to-die-watching-unicorn-workers-with-monit.html) )

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T00:26:24.073

在我们的环境中，monit 监控 unicorn master，unicorn master 监控它的孩子。我们使用一个简单的 cron 来监控 unicorn worker，如果超过内存阈值就将其杀死：

```
 #!/usr/bin/env ruby
    #       

    def get_mem(pid)
      pid = pid.to_i
      mem = 0 
      if File.exist?("/proc/#{pid}/status")
        File.read("/proc/#{pid}/status").each_line do |status|
          next unless status =~ /^VmRSS:\s+(\d+) kb/i
          mem = $1.to_i / 1024
        end     
      end     
      mem     
    end     

    %x{pgrep -f 'unicorn worker'}.each_line do |pid|
      Process.kill('QUIT', pid.to_i) if (get_mem pid) >= 300
    end 
```

当孩子被杀死时，独角兽主人会注意到并自动重生一个新的。我很确定独角兽工作者会在当前请求完成后遵守 QUIT 信号关闭。

# ios - 如何制作像 Instagram/Keek/Vine 这样的用户界面

> ID：15228110
> 
> 赞同：-4
> 
> 时间：2013-03-05T15:47:20.733
> 
> 标签：ios, xcode, user-interface, interface-builder, instagram

我正在使用 Interface builder 构建我的第一个应用程序界面，并且我想要构建一个应用程序界面，例如 Instagram。我知道这个问题非常笼统，但是任何指向这个方向的东西都会很棒。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T17:52:07.973

如果这是您的第一个应用程序，我认为这不是要问的问题，但我从 instagram 应用程序中看到的是：

*   UIVIEW（父）
    *   UIVIEW（标签栏）与底部对齐
        *   UIButton（主页）
        *   UIButton（探索）
        *   UIButton（凸轮）
        *   UIButton（收藏夹）
        *   UIButton（配置文件）
    *   UIView（主要内容），占用剩余空间

然后对每个组件都有一个视图

（家）

*   界面视图
    *   UIView（顶栏）
        *   UIImageView（徽标）
        *   UIButton（刷新）
    *   UITableView，占用剩余空间
        *   标题部分是 UIView，具有：
            *   图片的 UIImageView
            *   名称的 UIButton
            *   时钟图标的 UIImageView
            *   前一段时间的UILabel
        *   细胞可以
            *   图片单元格
            *   心脏细胞
            *   评论单元格
        *   部分页脚是操作按钮

（探索）

*   界面视图
    *   顶栏的 UIView
        *   标题的UILabel
        *   UIButton 刷新
    *   搜索栏的 UIView（滚动时隐藏）
        *   搜索字段背景的 UIImage
        *   带有占位符的 UITextfield
        *   最初隐藏的 UIButton
    *   用于操作按钮的 UIView（最初隐藏或位于搜索栏下方）
    *   用于搜索建议的 UITableView（最初隐藏）
    *   UIScrollView

等等等等……

您可以继续，只需分析视图如何在每个部分中拉伸、移动、显示或隐藏；并了解原生组件可以做什么以及什么是自定义组件。我想你可以继续剩下的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T15:55:42.780

首先要做的事情：

*   仔细检查这些应用程序以了解它们使用的 UI 组件是什么。
*   如果在默认控件中不可用，请搜索一些自定义库。在 [CocoaControls](http://www.cocoacontrols.com/)和[Github上搜索](https://github.com/)
*   做出详细的设计布局。解决

# asp.net-mvc - MVC ELMAH 和 SQL Azure

> ID：15228112
> 
> 赞同：26
> 
> 时间：2013-03-05T15:47:30.467
> 
> 标签：asp.net-mvc, azure, azure-sql-database, elmah, elmah.mvc

背景故事：我们主要将 AWS 用于一切（托管、数据库、通知等）。现在，我正在考虑将数据库端迁移到 SQL Azure，因为我们在 AWS RDS 上收到了疯狂的账单。所以我试图做的就是在 SQL Azure 中创建一个数据库并更新连接字符串以指向新的数据库。过去，ELMAH（此特定实现：[https](https://github.com/alexanderbeletsky/elmah.mvc) ://github.com/alexanderbeletsky/elmah.mvc ）在过去完美无缺。

当前情况：我刚刚在 SQL Azure 中创建了一个新数据库，并立即注意到了关键差异，即不支持：

ON [PRIMARY]、非集群键等。

我很好地迁移了我的数据库（现在），但是当我将 ELMAH 的更新脚本应用到数据库并尝试进入该工具时，我得到了错误！

**我以某种方式确信这是一个数据库问题**，因为如果我删除： `<errorLog type="Elmah.SqlErrorLog, Elmah" connectionStringName="DefaultConnection"/>` 基本上默认 ELMAH 将所有内容存储在本地，我就可以访问 ELMAH。

有人让 ELMAH 在 SQL Azure 上工作吗？你能给我生成表和存储过程的 SQL 脚本吗？

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2013-03-05T16:10:49.160

这是我在 SQl Azure 上用于 ELMAH 数据库的 db 脚本：

```
--~Changing index [dbo].[ELMAH_Error].PK_ELMAH_Error to a clustered index.  You may    want to pick a different index to cluster on.
SET ANSI_NULLS ON
SET QUOTED_IDENTIFIER ON
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].    [ELMAH_Error]') AND type in (N'U'))
BEGIN
CREATE TABLE [dbo].[ELMAH_Error](
[ErrorId] [uniqueidentifier] NOT NULL,
[Application] [nvarchar](60) NOT NULL,
[Host] [nvarchar](50) NOT NULL,
[Type] [nvarchar](100) NOT NULL,
[Source] [nvarchar](60) NOT NULL,
[Message] [nvarchar](500) NOT NULL,
[User] [nvarchar](50) NOT NULL,
[StatusCode] [int] NOT NULL,
[TimeUtc] [datetime] NOT NULL,
[Sequence] [int] IDENTITY(1,1) NOT NULL,
[AllXml] [nvarchar](max) NOT NULL,
CONSTRAINT [PK_ELMAH_Error] PRIMARY KEY CLUSTERED 
(
[ErrorId] ASC
)WITH (STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF)
)
END

IF NOT EXISTS (SELECT * FROM sys.indexes WHERE object_id = OBJECT_ID(N'[dbo].[ELMAH_Error]') AND name = N'IX_ELMAH_Error_App_Time_Seq')
CREATE NONCLUSTERED INDEX [IX_ELMAH_Error_App_Time_Seq] ON [dbo].[ELMAH_Error] 
(
[Application] ASC,
[TimeUtc] DESC,
[Sequence] DESC
)WITH (STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, DROP_EXISTING = OFF, ONLINE  = OFF)
GO
IF NOT EXISTS (SELECT * FROM dbo.sysobjects WHERE id =     OBJECT_ID(N'[DF_ELMAH_Error_ErrorId]') AND type = 'D')
BEGIN
ALTER TABLE [dbo].[ELMAH_Error] ADD  CONSTRAINT [DF_ELMAH_Error_ErrorId]  DEFAULT (newid()) FOR [ErrorId]
END

GO
SET ANSI_NULLS ON
SET QUOTED_IDENTIFIER ON
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ELMAH_GetErrorsXml]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [dbo].[ELMAH_GetErrorsXml]
(
@Application NVARCHAR(60),
@PageIndex INT = 0,
@PageSize INT = 15,
@TotalCount INT OUTPUT
)
AS 

SET NOCOUNT ON

DECLARE @FirstTimeUTC DATETIME
DECLARE @FirstSequence INT
DECLARE @StartRow INT
DECLARE @StartRowIndex INT

SELECT 
    @TotalCount = COUNT(1) 
FROM 
    [ELMAH_Error]
WHERE 
    [Application] = @Application

-- Get the ID of the first error for the requested page

SET @StartRowIndex = @PageIndex * @PageSize + 1

IF @StartRowIndex <= @TotalCount
BEGIN

    SET ROWCOUNT @StartRowIndex

    SELECT  
        @FirstTimeUTC = [TimeUtc],
        @FirstSequence = [Sequence]
    FROM 
        [ELMAH_Error]
    WHERE   
        [Application] = @Application
    ORDER BY 
        [TimeUtc] DESC, 
        [Sequence] DESC

END
ELSE
BEGIN

    SET @PageSize = 0

END

-- Now set the row count to the requested page size and get
-- all records below it for the pertaining application.

SET ROWCOUNT @PageSize

SELECT 
    errorId     = [ErrorId], 
    application = [Application],
    host        = [Host], 
    type        = [Type],
    source      = [Source],
    message     = [Message],
    [user]      = [User],
    statusCode  = [StatusCode], 
    time        = CONVERT(VARCHAR(50), [TimeUtc], 126) + ''Z''
FROM 
    [ELMAH_Error] error
WHERE
    [Application] = @Application
AND
    [TimeUtc] <= @FirstTimeUTC
AND 
    [Sequence] <= @FirstSequence
ORDER BY
    [TimeUtc] DESC, 
    [Sequence] DESC
FOR
    XML AUTO

' 
END
GO
SET ANSI_NULLS ON
SET QUOTED_IDENTIFIER ON
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ELMAH_GetErrorXml]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [dbo].[ELMAH_GetErrorXml]
(
@Application NVARCHAR(60),
@ErrorId UNIQUEIDENTIFIER
)
AS

SET NOCOUNT ON

SELECT 
    [AllXml]
FROM 
    [ELMAH_Error]
WHERE
    [ErrorId] = @ErrorId
AND
    [Application] = @Application

' 
END
GO
SET ANSI_NULLS ON
SET QUOTED_IDENTIFIER ON
IF NOT EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].    [ELMAH_LogError]') AND type in (N'P', N'PC'))
BEGIN
EXEC dbo.sp_executesql @statement = N'
CREATE PROCEDURE [dbo].[ELMAH_LogError]
(
@ErrorId UNIQUEIDENTIFIER,
@Application NVARCHAR(60),
@Host NVARCHAR(30),
@Type NVARCHAR(100),
@Source NVARCHAR(60),
@Message NVARCHAR(500),
@User NVARCHAR(50),
@AllXml NVARCHAR(MAX),
@StatusCode INT,
@TimeUtc DATETIME
)
AS

SET NOCOUNT ON

INSERT
INTO
    [ELMAH_Error]
    (
        [ErrorId],
        [Application],
        [Host],
        [Type],
        [Source],
        [Message],
        [User],
        [AllXml],
        [StatusCode],
        [TimeUtc]
    )
VALUES
    (
        @ErrorId,
        @Application,
        @Host,
        @Type,
        @Source,
        @Message,
        @User,
        @AllXml,
        @StatusCode,
        @TimeUtc
    )

' 
END
GO 
```

SQL Azure 是 SQL 的特殊版本，它不支持某些内容。

您是否使用 SQL Azure 迁移向导迁移您的数据库？

# loops - 使用外部文件获取 mime 类型列表

> ID：15228120
> 
> 赞同：1
> 
> 时间：2013-03-05T15:47:49.373
> 
> 标签：loops, wordpress, mime-types

我即将实现下面的过滤器/功能，以便能够控制用户可以上传到我正在处理的 Wordpress 应用程序的文件类型。但是，mime 类型的列表很长，我不想将其直接放入 functions.php 中，而是循环访问包含不同 mime 类型的外部文件。

如何才能做到这一点？

```
<?php
     add_filter('upload_mimes', 'custom_upload_mimes');

     function custom_upload_mimes ( $existing_mimes = array() ) {

         $existing_mimes['ppt'] = 'application/vnd.ms-powerpoint';
         ...+ ~50 more...

         return $existing_mimes;
     }
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T23:55:33.150

`functions.php`不是放这个**的地方**，你应该建立一个插件。

检查 Codex：[编写插件](https://codex.wordpress.org/Writing_a_Plugin)。

基本上：

```
<?php
/*
Plugin Name: Site Mime Types
*/

add_filter('upload_mimes', 'custom_upload_mimes');        

function custom_upload_mimes ( $existing_mimes = array() ) {

     $existing_mimes['ppt'] = 'application/vnd.ms-powerpoint';
     ...+ ~50 more...

     return $existing_mimes;
 } 
```

看到这个 WordPress 答案：[把我的代码放在哪里：plugin 或 functions.php？](https://wordpress.stackexchange.com/q/73031/12615)

如果您真的想为此读取外部文件，请检查此[搜索查询](https://stackoverflow.com/search?q=config.ini+%5Bphp%5D)。

# ios6 - setViewControllers 没有根据 topViewController 设置正确的方向

> ID：15228121
> 
> 赞同：1
> 
> 时间：2013-03-05T15:47:54.610
> 
> 标签：ios6, uiviewcontroller, uinavigationcontroller, rotation

我使用 a`UINavigationController`在我的应用程序中呈现内容。我将我的控制器保存在一个单独的字典中，并且在用户交互时，我使用正确的`UIViewContoller`. 每个视图控制器都实现

```
- (BOOL)shouldAutoRotate; 
```

和

```
- (NSUInteger)supportedInterfaceOrientations; 
```

但是当我尝试将视图控制器设置为我的导航控制器时：

```
[self setViewControllers:[NSArray arrayWithObject:controller] animated:NO]; 
```

应用程序不会根据控制器支持的方向旋转

例如，手机是横向的，而我的视图控制器只支持纵向。如何使设备旋转为纵向？

代码：我的导航控制器子类

```
- (BOOL)shouldAutorotate{
    return [[self topViewController] shouldAutorotate];
}

- (NSUInteger)supportedInterfaceOrientations{
    return [[self topViewController] supportedInterfaceOrientations];
}

- (UIInterfaceOrientation)preferredInterfaceOrientationForPresentatio{
    return [[self topViewController] preferredInterfaceOrientationForPresentation];
} 
```

我的控制器：

```
- (BOOL)shouldAutorotate{
    return YES;
}

- (NSUInteger)supportedInterfaceOrientations{    
    if (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPhone) {
        return UIInterfaceOrientationMaskPortrait;
    }
    return UIInterfaceOrientationMaskAll;
}

- (UIInterfaceOrientation)preferredInterfaceOrientationForPresentation{
    return UIInterfaceOrientationPortrait;
} 
```

文档指出，为了调用`supportedInterfaceOrientations`，`shouldAutorotate`必须返回 YES。

有任何想法吗？？

# java - 将多条记录返回给一次显示一条记录的视图的 Spring MVC 应用程序

> ID：15228125
> 
> 赞同：0
> 
> 时间：2013-03-05T15:48:01.937
> 
> 标签：java, spring, spring-mvc, pagination

我有一个捕获公民信息的表格，所以我有一个 Citizens 类

**公民课**

```
public class Citizens implements Serializable{

    private int socialSecurityNumber;
    private String fName;
    private String lName;
    private String oName;
    private String photo;
    private int countryId;
    private String addLn1;
    private String addLn2;
    private String addLn3;...... 
```

**基于 where_clause 返回一个公民列表/单个记录的**DAO类，可以是任何值或值的组合。****

 **```
if(where_clause != null){
        //add WHERE to string
        where_clause = "WHERE " + where_clause;
        //get length of string 
        int where_clause_length = where_clause.length();
        //remove last 'and' from string
        where_clause = where_clause.substring(0, where_clause_length - 5);

        logger.info(where_clause);
    }       

    String sql = "SELECT socialSecurityNumber, fName, lName, oName, photo, countryId, addLn1, addLn2, addLn3," 
                +"genderId, ethnicityId, skinColorId, eyeColorId, hairColorId, occupationId, phoneNo, maritalStatusId," 
                +"noticableFeatures, weight, height, citizenTypeId, dob "
                +"FROM crimetrack.tblcitizens " + where_clause;

    logger.debug(sql);

    List<Citizens> listOfCitizens = getJdbcTemplate().query(sql, new CitizensMapper());     
    return listOfCitizens; 
```

在**控制器**中会发生以下情况：

```
if (user_request.equals("Query")){
   logger.debug("about to preform query");
   if(citizenManager.getListOfCitizens(citizen).isEmpty()){
      model.addAttribute("icon","ui-icon ui-icon-circle-close");
      model.addAttribute("results","Notice: Query Caused No Records To Be Retrived!");                           
 }

 model.addAllAttributes(citizenManager.getListOfCitizens(citizen));

 return new ModelAndView("citizen_registration");
 }                   
} 
```

这里的问题是此查询返回 3 条记录，但视图上只显示最后一条记录。下面是jsp的样子，它使用spring表单标签。我想要做的是添加下一条记录按钮，当用户单击下一条记录时，我想移动到列表中的下一条记录并将其显示给用户。如何实现这一点，如果不能使用这种方法完成，那么最好的方法是什么。我正在阅读有关**分页**的信息，但是我不确定如何将其实现到此应用程序中。有人可以帮助我或指导我如何解决这个问题：

**jsp**

```
<form:form id="citizenRegistration" name ="citizenRegistration" method="POST" commandName="citizens" action="citizen_registration.htm">
                    <div id="divRight" class="mainDiv">             
                        <div class="divGroup" id="divCharInfo"> 
                            <label id="status"></label>                             
                            <div id="camera"></div>             
                            <div><p><canvas id="canvas" height="240" width="320"></canvas><canvas id="canvas2" height="240" width="320"></canvas><form:errors path="photo" class="errors"/></div>
                                    <form:input path="photo" id="photo" type="hidden"/>
                                    <input  id="upload" type="button" value="Take Photo">
                                    <input  id="retake" type="button" value="Re-Take Photo">

                            <ol>
                                <li>
                                    <label>Select Gender</label>
                                    <form:select path="genderId" id="genderId" title="Select Your Gender">
                                    <form:options items = "${gender.genderList}" itemValue="genderId" itemLabel="genderDesc" />
                                    </form:select>
                                    <form:errors path="genderId" class="errors"/>
                                </li>               

                                <li><form:label for="weight" path="weight">Enter Weight <i>(lbs)</i></form:label>
                                    <form:input path="weight" id="weight" title="Enter Weight"/><form:errors path="weight" class="errors"/>
                                </li> 

                                <li><form:label for="height" path="height">Enter Height <i>(feet)</i></form:label>
                                    <form:input path="height" id="height" title="Enter Height"/><form:errors path="height" class="errors"/>
                                </li> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T16:24:04.753

试试这个......在控制器中

```
model.addAttribute("citizens",citizenManager.getListOfCitizens(citizen)); 
```

现在在您的 jsp 中执行以下操作： 1\. 在 jsp 页面顶部

`<%@taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>`

添加此代码 2\. 现在将此代码添加到您的 html 正文中

```
<c:forEach items="${citizens}" var="citizen">
First name:- ${citizen.fName} , Last Name:- ${citizen.lName}
</c:forEach> 
```

希望这可以帮助**

# asp.net - VB 2012，空 Web 项目，登录表单...但是错误

> ID：15228127
> 
> 赞同：0
> 
> 时间：2013-03-05T15:48:07.170
> 
> 标签：asp.net, vb.net, visual-studio-2012

以下[演练：创建具有成员资格和用户登录的网站](http://msdn.microsoft.com/en-us/library/879kf95c%28v=vs.100%29.aspx)我收到错误：

关键

1.  制作空 Web 项目后
2.  然后制作 Default.aspx
3.  然后制作 Login.aspx
4.  然后在 Login.aspx 上添加登录表单

但是错误

> WebForms UnobtrusiveValidationMode 需要 'jquery' 的 ScriptResourceMapping。请添加一个名为 jquery（区分大小写）的 ScriptResourceMapping。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T17:49:53.213

`Application_Start`尝试在Global.asax 事件中添加以下内容：

```
ScriptManager.ScriptResourceMapping.AddDefinition("jquery", 
    new ScriptResourceDefinition
{
  Path = "~/scripts/jquery-1.9.1.min.js",
  DebugPath = "~/scripts/jquery-1.9.1.min.js",
  CdnPath = "http://code.jquery.com/jquery-1.9.1.min.js",
  CdnDebugPath = "http://code.jquery.com/jquery-1.9.1.js"
}); 
```

`Path`将and替换为`DebugPath`您的实际`.js`路径。也看看[这个](https://stackoverflow.com/questions/12452109/asp-net-2012-unobtrusive-validation-with-jquery)答案。

# unit-testing - 如何 Junit 测试 servlet 过滤器

> ID：15228128
> 
> 赞同：3
> 
> 时间：2013-03-05T15:48:09.467
> 
> 标签：unit-testing, servlets, junit, servlet-filters

无论如何要对过滤器进行单元测试，如下所示？

```
public void doFilter(ServletRequest req, ServletResponse res, FilterChain chain) throws IOException,
    ServletException {
    HttpServletRequest request = (HttpServletRequest) req;
    HttpServletResponse response = (HttpServletResponse) res;
    String param = request.getParameter("param");

    if (param == null) {
        response.sendError(400, "param can't be null");
        return;
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-06T07:41:49.843

是的，有，这是一种方法。在这里，我正在模拟 HttpServletRequest 和 HttpServletResponse 并通过定义期望来断言方法调用。这里我正在使用 JMock。

```
public class SampleFilterTest {

  private Mockery context = new Mockery();

  private SampleFilter sampleFilter = new SampleFilter();
  private HttpServletRequest request;
  private HttpServletResponse response;

  @BeforeMethod
  public void setUp() throws Exception {
    request = context.mock(HttpServletRequest.class);
    response = context.mock(HttpServletResponse.class);
  }

  @Test
  public void sampleFilterTest() throws IOException, ServletException {
    context.checking(new Expectations() {{
      oneOf(request).getParameter("param");
      will(returnValue(null));
      oneOf(response).sendError(400, "param can't be null");
    }});
    sampleFilter.doFilter(request, response, null);
  }
} 
```

在这里我是说当 request.getParmeter 被调用时使用“param”然后返回 null，response.sendError 使用 400 和“param can't be null”参数，应该被调用。

# sql-server - 如何使用时间字段添加日期时间字段

> ID：15228132
> 
> 赞同：5
> 
> 时间：2013-03-05T15:48:29.450
> 
> 标签：sql-server, tsql, datetime, time, sql-server-2012

我必须在 SQL Server 2012 中使用 T-SQL`time`为现有价值添加价值。`datetime`

我在想[DATEADD](http://msdn.microsoft.com/en-us/library/ms186819.aspx)函数它可能是一个解决方案，但它不是......

也许我已经以某种方式`time`转换为`datetime`？

所以我有

> 开始日期 2013-02-18 18:34:40.330（日期时间）
> 
> 间隔 00:11:00.0000000（时间）
> 
> 结束日期 ？tsql ? （约会时间）

有什么线索吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-03-05T16:06:42.830

```
DECLARE @d DATETIME = '2013-02-18T18:34:40.330',
        @t TIME(7)  = '00:11:00.0000000';

SELECT EndDate = DATEADD(SECOND, DATEDIFF(SECOND, 0, @t), @d); 
```

结果：

```
EndDate
-----------------------
2013-02-18 18:45:40.330 
```

现在，您真的不应该将*间隔*存储在`time`列中。`time`旨在表示一个*时间点*，而不是*持续时间*。当间隔 >= 24 小时时会发生什么？您应该存储事件的开始时间和结束时间（这些事情通常至少与持续时间一样相关），并且您始终可以从这些点计算持续时间。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-03-05T15:56:38.630

尝试这样的事情。注意：我在这里不花毫秒

```
declare @dt datetime = getdate()
declare @t time = '01:35:45'

select dateadd(second, 
                  datepart(hour,@t) * 3600 + 
                  datepart(minute,@t) * 60 + 
                  datepart(second,@t),
                  @dt) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-06-13T10:20:59.860

*我最近一直在使用 Azure-DB，并尝试了下面的代码。这在 SQL 2012 中不起作用。有关 SQL 日期算术的更多信息，请参阅这篇文章： [Azure-DB 与 sql-server 2008R2 中的日期时间和时间算术差异](http://social.msdn.microsoft.com/Forums/windowsazure/en-US/8c163ac8-dae7-4d95-ad8f-3e4b52c3965d/difference-in-datetime-and-time-arithmetic-in-sql-azure-vs-sql-server-2008-r2?forum=ssdsgetstarted)*

我参加聚会有点晚了，但是由于缺少明显的方法...

```
DECLARE @StartDate datetime
DECLARE @Interval time
DECLARE @EndDate datetime
SET @StartDate = '2013-02-18 18:34:40.330'
SET @Interval = '00:11:00.000000'

SET @EndDate = @StartDate + @Interval

SELECT @StartDate StartDate, @Interval Interval, @EndDate EndDate

Output:
StartDate                  Interval             EndDate
2013-02-18 18:34:40.330    00:11:00.0000000    2013-02-18 18:45:40.330 
```

# web-services - 将盐与 URL 中的散列安全密钥一起传递

> ID：15228134
> 
> 赞同：1
> 
> 时间：2013-03-05T15:48:33.310
> 
> 标签：web-services, security, authentication, salt

所以我正在尝试针对第三方网络应用程序进行身份验证。此第三方 Web 应用程序的文档建议使用第三方 Web 应用程序提供的我们的安全密钥并使用盐对其进行哈希处理。然后，他们希望我们将生成的盐与散列的安全密钥一起传递，该密钥在 URL 中被称为秘密。我的理解是第三方网络应用程序将使用安全密钥并使用 URL 中提供的盐对其进行哈希处理，以查看它是否与 URL 中传递的秘密匹配。这似乎是一个重大的安全风险。有人可以解释为什么这会或不会是安全风险吗？

文档 [http://wiki.kayako.com/display/DEV/Kayako+REST+API](http://wiki.kayako.com/display/DEV/Kayako+REST+API)

样品请求

```
https://example.domain.com/api/index.php
 ?e=/Module/Controller/Action
 &parameterA=valueA
 &parameterB=valueB
 &parameterC=valueC
 &apikey=d75a00ef-08b6-5b04-5d29-d3b7ca46138a
 &salt=itobgt701t5nat7oor9z4t813edc5t8d
 &signature=MzNiNjk4ZmUyY2FlNjQ5YmRkNjA0YjkyYTQ0NmY5OTQ4MGVkYTIwMzZjMzFkYmJjMzk4MzgzNjNiMzZjYTE4NQ== 
```

# c# - 将控件 ID 传递给文本更改事件的自定义方法

> ID：15228140
> 
> 赞同：1
> 
> 时间：2013-03-05T15:48:46.430
> 
> 标签：c#, asp.net, webforms

我想编写一个方法来处理 webform 上多个服务器控件的文本更改事件。当文本更改事件触发时，我需要将控件 ID 传递给我的方法。换句话说，当我的方法被调用时，我必须弄清楚是哪个控件导致文本更改事件触发。这可能吗？通常我会使用命令参数属性，但我认为这不适用于文本框和列表框控件。有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T15:54:32.987

在 TextChanged 函数中使用`Sender`（第一个）参数：

```
protected void TextBox1_TextChanged(object sender, EventArgs e)
{
        TextBox tb = sender as TextBox;

        if (tb != null)
        {
            string id = tb.ID;
        }
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T15:54:28.907

您的事件处理程序有两个参数：`object sender, eventargs e`

sender 参数就是您要查找的参数。它实际上是对调用事件处理程序的对象的引用，您只需将其转换为正确的类型。

```
 TextBox fooBar = sender as TextBox; 
```

那么如果你愿意，你可以得到这个名字：

```
 if(fooBar.Name == "someName") { ... } 
```

# php - 条件语句中的“&”运算符

> ID：15228141
> 
> 赞同：0
> 
> 时间：2013-03-05T15:48:52.533
> 
> 标签：php

我在 Services_JSON php 库中找到了这串代码：

```
if ($this->use & SERVICES_JSON_LOOSE_TYPE) {
    $stk = array(SERVICES_JSON_IN_OBJ);
    $obj = array();
} else {
    $stk = array(SERVICES_JSON_IN_OBJ);
    $obj = new stdClass();
} 
```

我的问题是关于第一行。单个**“&”**运算符有什么作用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T15:49:26.970

这是 PHP 位运算`AND`符： http: [//php.net/manual/en/language.operators.bitwise.php](http://php.net/manual/en/language.operators.bitwise.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T15:55:48.730

&& 表示“和”（逻辑运算符），但单个“&”是按位运算符，对位进行二进制比较。

这是来自 php.net 的手册：http: [//us2.php.net/manual/en/language.operators.bitwise.php](http://us2.php.net/manual/en/language.operators.bitwise.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T16:19:51.560

不仅要解释 & 的作用，还要解释这个按位与运算符在这种情况下可能用于什么，看看

```
<?php
define('SOME_FLAG', 1);
define('SERVICES_JSON_LOOSE_TYPE', 2);
define('ANOTHER_FLAG', 4);

foo(0);
foo(7);
foo(SERVICES_JSON_LOOSE_TYPE|ANOTHER_FLAG);

function foo($value) {
    echo "foo($value)\n";

    bar($value, SOME_FLAG);
    bar($value, SERVICES_JSON_LOOSE_TYPE);
    bar($value, ANOTHER_FLAG);

    if ( $value & SOME_FLAG ) {
        echo "  SOME_FLAG set\n";
    }
    else {
        echo "  SOME_FLAG NOT set\n";
    }

    if ( $value & SERVICES_JSON_LOOSE_TYPE ) {
        echo "  SERVICES_JSON_LOOSE_TYPE set\n";
    }
    else {
        echo "  SERVICES_JSON_LOOSE_TYPE NOT set\n";
    }

    if ( $value & ANOTHER_FLAG ) {
        echo "  ANOTHER_FLAG set\n";
    }
    else {
        echo "  ANOTHER_FLAG NOT set\n";
    }
    echo "\n";
} 

function bar($value, $flag) {
    printf("  value|  %08s (%d)\n", decbin($value), $value);
    printf("  flag |& %08s (%d)\n", decbin($flag), $flag);
    printf("  and  |= %08s (%d)\n", decbin($value & $flag), $value & $flag);
    echo "\n";
} 
```

输出是

```
foo(0)
  value|  00000000 (0)
  flag |& 00000001 (1)
  and  |= 00000000 (0)

  value|  00000000 (0)
  flag |& 00000010 (2)
  and  |= 00000000 (0)

  value|  00000000 (0)
  flag |& 00000100 (4)
  and  |= 00000000 (0)

  SOME_FLAG NOT set
  SERVICES_JSON_LOOSE_TYPE NOT set
  ANOTHER_FLAG NOT set

foo(7)
  value|  00000111 (7)
  flag |& 00000001 (1)
  and  |= 00000001 (1)

  value|  00000111 (7)
  flag |& 00000010 (2)
  and  |= 00000010 (2)

  value|  00000111 (7)
  flag |& 00000100 (4)
  and  |= 00000100 (4)

  SOME_FLAG set
  SERVICES_JSON_LOOSE_TYPE set
  ANOTHER_FLAG set

foo(6)
  value|  00000110 (6)
  flag |& 00000001 (1)
  and  |= 00000000 (0)

  value|  00000110 (6)
  flag |& 00000010 (2)
  and  |= 00000010 (2)

  value|  00000110 (6)
  flag |& 00000100 (4)
  and  |= 00000100 (4)

  SOME_FLAG NOT set
  SERVICES_JSON_LOOSE_TYPE set
  ANOTHER_FLAG set 
```

这是一种测试是否在值中设置了某个标志的方法。
查看 php 文档，例如[preg_match_all](http://php.net/manual/en/function.preg-match-all.php)的文档：

```
旗帜
    可以是以下标志的组合 [...]
    PREG_PATTERN_ORDER [...]
    PREG_SET_ORDER [...]
    PREG_OFFSET_CAPTURE [...]

```

你会`Can be a combination of the following flags...`在文档中多次找到这个东西。这些函数/方法背后的代码正是使用按位与运算符进行的那种检查。

# ajax - Magento，重新定义定价方式，根据数量重新加载价格

> ID：15228149
> 
> 赞同：0
> 
> 时间：2013-03-05T15:49:21.027
> 
> 标签：ajax, magento, reload

我正在尝试构建一种新的定价方法，我想根据产品视图中的数量和选项重新加载价格（在添加到购物车之前）。

使用 Ajax 控制器，我设法解决了第二个问题：当您修改数量时，我可以更改价格框内容

但我的问题是：code/core/Mage/Catalog/Product/Type/Price.php 中有很多不同的模型函数，所以我不知道我需要修改什么函数。也许它位于 js/varien/product.js 中的其他位置。

我不得不承认：我有点迷路了。

非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T18:23:53.933

在 Magento 中，“购物车”和添加到“购物车”是报价系统的一部分。每个报价都有几个报价项目，这些项目基本上是购物车中每个“项目”的数量、配置和价格。

如果您已经在产品页面上持续更新价格，您应该能够使用观察者模型来观察`<sales_quote_save_after>`事件并根据所需数量修改某些商品的价格。这将在他们每次更改购物车中的数量或首次将实际商品添加到购物车时触发。

# php - Laravel“使用模型”和我的数据库表

> ID：15228152
> 
> 赞同：0
> 
> 时间：2013-03-05T15:49:25.920
> 
> 标签：php, laravel, laravel-3

我的数据库中有几个表。`Blogs`, `Users`, `Posts`,`Tags`是主要的。我也有链接表：`User_blogs`, `Blog_posts`& `Post_tags`。

我的问题是如何使用 Laravel 的类和方法，如`belogs_to()`, `has_many()`. 我需要有人来阐明它。我已经阅读了很多文章和文档，但我仍然感到困惑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T18:35:49.617

通常，如果您正确设置表，laravel 足够智能，可以检测多对多关系 在中间表/数据透视表中两个表名都不应该是复数形式，因此您应该将`Users`, `Blogs`, `Posts`,`Tags`作为您的个人表和`User_Blog`,作为您`Blog_Post`的`Post_Tag`中间表表。在这些表中，列应正确反映`tablename_id`（小写），因此其他列`User_Blog`应包含 3个列`id`，等等。`user_id``blog_id`

在您的模型中，您只需要设置多对多关系

```
class User extends Eloquent
{
     public function blogs()
     {
         return $this->has_many_and_belongs_to('Blog');
     }
} 
```

每个模型依此类推。如果更改结构不是一个选项，那么只需像这样在多对多关系中添加表名`return $this->has_many_and_belongs_to('Blog', 'User_blogs');`

# javascript - .length 和 [0] 有什么区别来检查是否存在具有 ID 的元素

> ID：15228154
> 
> 赞同：3
> 
> 时间：2013-03-05T15:49:32.337
> 
> 标签：javascript, jquery

我已经看到了两种方法来检查页面上是否存在具有特定 ID 的元素，我想知道为什么第二种方法有效。

我见过的一种方法如下，我想我理解了：

```
if ( $('#elementID').length > 0 ) {
  //Do something
}
else {
  //Do something else
} 
```

我看到的另一种我不太理解的方法如下：

```
if ( $('#elementID')[0] ) {
  //Do something
}
else {
  //Do something else
} 
```

[0] 是什么意思？我通常会看到 [...] 用于数组，所以这是返回数组吗？

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T15:52:13.273

jQuery 选择器返回一个与选择器匹配的值数组。

第一个示例检查该数组的长度。第二个示例尝试检查第一个元素是否存在。

```
if ( $('elementID').length > 0 ) {
  //checks the length of the array.  If the selector hit at least 1 element it does something

if ( $('elementID')[0] ) {
  //Tries to check if the first element exists.  
  //This really should work in this case, because jQuery will return jquery objects 
  //but in the general case for checking arrays is dangerous because will be incorrect for falsy values 
```

所以最后，两者都是“如果选择了元素”的简写

我最初说第二个很危险。在 jQuery 案例中这实际上不是真的，因为 jQuery/DOM 对象总是真实的。一般来说，虽然通过使用来检查元素是否存在是很危险的，`if(element)`因为这对于 0 或“”之类的值将返回 false。因此，如果您不确定，我会推荐第一个约定，因为它在更广泛的情况下更安全。但对于这种特殊情况，任何一个选项都有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-05T15:54:16.107

一个 jQuery 包装的对象的所有元素/等都以类似数组的方式存储在内部，因此为什么`.length`可以使用它，并且您可以查看选择器是否返回任何结果。

```
$('#elementID').length 
```

由于 jQuery 以类似数组的方式存储它们，因此您可以使用典型的`[]`括号表示法单独访问它们。注意，这也将返回一个**原始的 javascript** HTMLElement。它删除了从中包装的 jQuery。

```
$('#elementID')[0] // returns the 1st element 
```

由于在这种情况下，两者都返回一个**真实**的结果，它将继续进入**if**语句。

* * *

```
// On a side note: make sure to _not_ do simply:
if ( $('#elementID') ) { } 
```

jQuery 将返回一个空的 jQuery 包装对象（将是 -truthy-），继续执行*if*语句。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T15:57:32.880

为您指明正确的方向：

```
var test = document.getElementById('test') //returns a HTML DOM Object
var test = $('#test') //returns a jQuery Object
var test = $('#test')[0] //returns a HTML DOM Object 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-05T16:04:53.410

它们实际上都与 jQuery 没有直接关系。$(selector) 返回一个匹配选择器的 jQuery 对象数组。因此，您可以使用 Array.length 属性来检查有多少匹配项。同样，您可以通过它的从零开始的索引访问数组中的任何项目。$(selector)[0] 将返回数组中的第一个 HtmlElement 对象，而 $(selector)[1] 将返回第二个。等等。

虽然 if ($(selector)[0]) 在某些情况下可能有效，但它不会返回布尔值，因此条件有缺陷，不应使用。相反，使用 $(selector).length > 0。

# python - 将控制权交还给 Unix shell 脚本

> ID：15228156
> 
> 赞同：-1
> 
> 时间：2013-03-05T15:49:36.953
> 
> 标签：python, unix

我正在从 unix "Hello.sh" 调用 python 脚本

```
echo "Executing python script"
java weblogic.WLST weblogic_generate.py $myh $myp
echo "Completed Execution" 
```

但是在执行 python 脚本后，控件不会返回到 unix，并且不会打印 echo "Completed Execution"。你能建议我怎样才能让它工作吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T16:01:22.900

添加

```
sleep 3 
```

作为最后一行，所以它在显示后等待 3 秒`Completed Execution`

# jquery - 角度动画

> ID：15228157
> 
> 赞同：6
> 
> 时间：2013-03-05T15:49:37.023
> 
> 标签：jquery, animation, angularjs

目前我在 ng-click 控制器中有这行代码

`$(".message").show(300).delay(900).hide(300);`

虽然它工作得非常好，但我被告知我绝不能在控制器内进行动画/jQuery/DOM 操作。有没有另一种方法可以做到这一点，而不涉及大量的胡闹？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-05T17:01:03.127

编写一个简单的指令来监视其属性：

```
app.directive('animateMe', function() {
   return function(scope, element, attrs) {
      scope.$watch(attrs.animateMe, function() {
         element.show(300).delay(900).hide(300);
      })
   }
}) 
```

将该指令放在要设置动画的 HTML 元素上。让 ng-click 切换模型/范围属性。

```
<a ng-click="animateToggle = !animateToggle">animate</a>
<div animate-me="animateToggle">...</div> 
```

更多代码，是的。但是现在你有了一些可重用的东西（而且你不需要选择器）。

[小提琴](http://jsfiddle.net/mrajcok/mqVGV/)

在小提琴中，我将 ng-hide 添加到 div 以便它最初不会出现。

* * *

**更新**：
Angular 1.1.4 现在有一个[ngAnimate](http://code.angularjs.org/1.1.4/docs/api/ng.directive%3angAnimate)指令。虽然它不像编写自己的动画指令那样灵活，但它可以处理许多场景。[ng-show](http://code.angularjs.org/1.1.4/docs/api/ng.directive%3angShow)（和 ng-hide）指令支持`show`和`hide` [动画方法](http://code.angularjs.org/1.1.4/docs/api/ng.%24animator#Methods)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-04T22:33:11.670

我建议您使用 AngularJS 1.1.4 Core 中提供的新 ngAnimate 指令。

[在这里](http://www.yearofmoo.com/2013/04/animation-in-angularjs.html)阅读更多

# regex - 如何从perl中带有附加字符的变量中提取路径

> ID：15228158
> 
> 赞同：0
> 
> 时间：2013-03-05T15:49:38.643
> 
> 标签：regex, perl

我正在尝试`/temp/bin/usr/`从变量中提取

```
$path  = /temp/bin/usr/... 
```

使用 perl。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T15:53:23.720

使用`File::Basename`. 它是 Perl 版本 5 中的核心模块。从[文档中](http://search.cpan.org/perldoc?File%3a%3aBasename)：

```
use File::Basename;

($name,$path,$suffix) = fileparse($fullname, @suffixlist);
$name = fileparse($fullname, @suffixlist);

$basename = basename($fullname, @suffixlist);
$dirname  = dirname($fullname); 
```

这听起来像是`dirname($path)`你所追求的。

您也可以简单地使用正则表达式

```
$path =~ s/\.+$//; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T16:07:51.010

如果你需要的只是删除那些'..'，最后有很多方法。

例如：

1)

```
my $str="/temp/bin/usr/..."; 
($str) =~ s/\.+$//; 
print $str; 
```

2)

```
my $str="/temp/bin/usr/..."; 
$str = substr($str, 0, index($str, "."));
print $str; 
```

3)

```
my $str="/temp/bin/usr/..."; 
$str = (split /\./, $str)[0];
print $str; 
```

还有更多！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T16:04:16.220

要提取路径的一部分，例如前三个目录，一种方法是使用`splitdir`module的方法`File::Spec`，例如：

```
printf "%s\n", join q|/|, (File::Spec->splitdir( $path ))[0..3]; 
```

如果要删除这些点，请在最后一个斜杠后使用与它们匹配的正则表达式，例如：

```
$path =~ s|(/)\.+\s*$|$1|; 
```

# asp.net - 在绑定标签中显示来自 SQL 的换行符

> ID：15228159
> 
> 赞同：2
> 
> 时间：2013-03-05T15:49:42.987
> 
> 标签：asp.net

我在显示从 SQL 数据库中提取到`DataList`或类似控件中的换行符时遇到问题。我在插入字符时会保留这些字符，并且快速`SELECT`语句会显示换行符。但是，当我将数据拉入数据列表时，它会显示空格而不是换行符。代码当前如下所示：

```
<asp:Label ID="CommentLabel" runat="server" Text='<%# Eval("Comment").ToString().Replace(Environment.NewLine, "<br />") %>' /> 
```

我也看到了使用建议`Server.HTMLEncode`，我也想这样做，但是没有一个在这种情况下使用它的例子，而且我对它的尝试没有产生明显的差异，比如：

```
<asp:Label ID="CommentLabel" runat="server" Text='<%# Server.HTMLEncode(Eval("Comment").ToString()).Replace(Environment.NewLine, "<br />") %>' /> 
```

我在这里错过了一些难题吗？

编辑：在多行文本框中通过 Enter 创建新行。我不确定这是否会产生与包含的字符不同的字符`Environment.Newline`，但生成的 HTML 会显示`<span>`带有适当换行符的标签，但没有`<br />`标签，所以我猜它是不同的。如果是这样，要替换的合适角色是什么？

EDIT2：项目模板的代码

```
<ItemTemplate>
    <tr style="font-weight:bold">
        <td>
            Comment ID: <asp:Label ID="CommentIDLabel" runat="server" Text='<%# Eval("CommentID") %>' />
            Commenter: <asp:Label ID="CommenterLabel" runat="server" Text='<%# Eval("Username") %>' />
            Comment Date: <asp:Label ID="DateLabel" runat="server" Text='<%# Eval("Date") %>' />
        </td>
    </tr>
    <tr>
        <td>
            <asp:Label ID="CommentLabel" runat="server" Text='<%# (Eval("Comment")).Replace(Environment.NewLine, "<br />") %>' />
        </td>
    </tr>
</ItemTemplate> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T19:56:05.277

正如 Augustin Meriles 在他的评论中所说，问题在于在多行文本框中按 Enter 键不使用包含在`Environment.NewLine`. 一些调查它的人发现它正在写入`vbCr`而`vbLf`不是使用`vbCrLf`. 知道了这一点，改变我的替换方法修复了它。

```
<asp:Label ID="CommentLabel" runat="server" Text='<%# (Eval("Comment")).Replace(vbCr, "").Replace(vbLf, vbCrLf).Replace(Environment.NewLine, "<br />") %>' /> 
```

这在整个视图中实现了可识别且统一的换行符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T16:09:56.167

观察你的页面生成的 html 代码，你会看到如下内容：

```
<table id="GridView1">
<tr>
<td>
hello<br/>hello
</td>
</tr>
</table> 
```

但是如果您将 gridviews（或其他控件）列类型转换为模板字段，您将看到如下内容：

```
<table id="GridView1">
<tr>
<td>
 <span id="GridView1_Label1_0">hello <br/>hello</span>
</td>
</tr>
</table> 
```

现在里面有换行符！所以总而言之，您只需要将列转换为模板字段。

# java - JGroups ipAddress 已经在魔法地图中；请确保所有键都是唯一的

> ID：15228161
> 
> 赞同：1
> 
> 时间：2013-03-05T15:49:45.500
> 
> 标签：java, runtime-error, jgroups

在使用 JGroups 几天没有打嗝后，我突然收到了这个我无法破译的错误。有人对这个问题有任何想法吗？

```
Caused by: java.lang.Exception: key 1 (org.jgroups.stack.IpAddress) is already in magic map; please make sure that all keys are unique
    at org.jgroups.conf.ClassConfigurator.init(ClassConfigurator.java:95)
    at org.jgroups.conf.ClassConfigurator.<clinit>(ClassConfigurator.java:60)
    ... 18 more
Exception in thread "Timer-0" java.lang.AbstractMethodError: gnu.xml.dom.DomDocument.getXmlStandalone()Z
    at com.sun.org.apache.xalan.internal.xsltc.trax.DOM2TO.setDocumentInfo(DOM2TO.java:377)
    at com.sun.org.apache.xalan.internal.xsltc.trax.DOM2TO.parse(DOM2TO.java:131)
    at com.sun.org.apache.xalan.internal.xsltc.trax.DOM2TO.parse(DOM2TO.java:98)
    at com.sun.org.apache.xalan.internal.xsltc.trax.TransformerImpl.transformIdentity(TransformerImpl.java:683)
    at com.sun.org.apache.xalan.internal.xsltc.trax.TransformerImpl.transform(TransformerImpl.java:727)
    at com.sun.org.apache.xalan.internal.xsltc.trax.TransformerImpl.transform(TransformerImpl.java:340)
    at java.util.prefs.XmlSupport.writeDoc(XmlSupport.java:276)
    at java.util.prefs.XmlSupport.exportMap(XmlSupport.java:355)
    at java.util.prefs.FileSystemPreferences$7.run(FileSystemPreferences.java:622)
    at java.util.prefs.FileSystemPreferences$7.run(FileSystemPreferences.java:615)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.util.prefs.FileSystemPreferences.writeBackCache(FileSystemPreferences.java:614)
    at java.util.prefs.FileSystemPreferences.syncSpiPrivileged(FileSystemPreferences.java:801)
    at java.util.prefs.FileSystemPreferences.access$2300(FileSystemPreferences.java:50)
    at java.util.prefs.FileSystemPreferences$12.run(FileSystemPreferences.java:771)
    at java.util.prefs.FileSystemPreferences$12.run(FileSystemPreferences.java:769)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.util.prefs.FileSystemPreferences.syncSpi(FileSystemPreferences.java:768)
    at java.util.prefs.AbstractPreferences.sync2(AbstractPreferences.java:1332)
    at java.util.prefs.AbstractPreferences.sync2(AbstractPreferences.java:1337)
    at java.util.prefs.AbstractPreferences.sync2(AbstractPreferences.java:1337)
    at java.util.prefs.AbstractPreferences.sync2(AbstractPreferences.java:1337)
    at java.util.prefs.AbstractPreferences.sync(AbstractPreferences.java:1323)
    at java.util.prefs.FileSystemPreferences.sync(FileSystemPreferences.java:747)
    at java.util.prefs.FileSystemPreferences.flush(FileSystemPreferences.java:824)
    at java.util.prefs.FileSystemPreferences.syncWorld(FileSystemPreferences.java:464)
    at java.util.prefs.FileSystemPreferences.access$1200(FileSystemPreferences.java:50)
    at java.util.prefs.FileSystemPreferences$3.run(FileSystemPreferences.java:432)
    at java.util.TimerThread.mainLoop(Timer.java:555)
    at java.util.TimerThread.run(Timer.java:505) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-07T09:51:02.160

好的，发现库 gnujaxp.jar 与 JGroups 混淆了。希望这可以帮助有人遇到这个奇怪的错误。我不知道它是否可以被认为是 JGroups 中的错误。

# linux-kernel - 在多核系统上设置 cpu 亲和性和调度的顺序 (Linux 2.6)

> ID：15228164
> 
> 赞同：1
> 
> 时间：2013-03-05T15:49:48.077
> 
> 标签：linux-kernel, operating-system, scheduling

我对在多核系统（Linux 2.6）上设置 cpu 亲和力和调度的顺序有一些疑问

假设（假设情况）我有一个进程，并且我已将其设置为与 core1 的亲和性，并在两者之间暂停该进程（进入睡眠模式），当它被暂停时，我将此进程的 CPU 亲和性更改为 core2。现在这个进程会先在 core1 上运行，然后在唤醒时转移到 core2，还是会在后台直接转移到 core2？

类似的东西：（如果可以以某种方式完成）我在任务结构中创建了一个新条目，但从一开始就将这个新进程置于睡眠模式。当处于睡眠模式时，该进程是否根据其设置的亲和力分配给某个核心？或者，该进程仅在它开始运行时才被分配给某个核心（根据其亲和性）（然后同时当该进程在开始时处于休眠状态时，该进程被保留在哪个核心的睡眠队列中）？

我认为每个核心都有自己的调度程序副本并维护自己的就绪队列（SMP处理器），那么哪个进程在核心之间迁移进程？

（在某些方面我可能是错的，可能是我假设了很多，但感谢分享你的知识）

谢谢

# jquery - 设置相等的高度并在调整大小时更改它

> ID：15228168
> 
> 赞同：1
> 
> 时间：2013-03-05T15:49:54.597
> 
> 标签：jquery, resize, equal-heights

我有一个响应式布局，为此我需要一些高度相等的 div，它们会在调整大小时自动改变高度。

我用这个脚本设置相等的高度：

```
$(window).load(function() {
$('.test').css({
    'height': $('.test').height()
});
}); 
```

这是我的 HTML 结构：

```
 <div class="row front-rows">
        <div class="span3">
            <div id="post">
                <div class="front-row-image">
                    <a href="#"></a>
                </div>
                <div class="test">
                    <h2>Test</h2>
                    <div class="text">Lorem Ipsum dolore</div>
                    <div class="read-more-link">
                        <a href="#"><span class="pull-left">Read More</span></a>
                    </div>
                </div>
            </div>
        </div>
    </div> 
```

但是当设置高度时，当我调整大小时它会保持这个高度，我不知道如何在调整大小时再次改变大小？

页面加载时应设置相等的高度 - 并在每次调整大小时更改。

任何人都可以帮忙吗？:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T15:52:56.720

使用[`resize()`](http://api.jquery.com/resize/)功能：

```
$(window).resize(function() {  
    $('.test').css({
        'height': $('.test').height()
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T15:53:03.893

使用`.resize()`而不是 .load() [http://api.jquery.com/resize/](http://api.jquery.com/resize/)

尽管为了您的最终目标，我根本不会使用 javascript/jquery。`height`您可能可以使用带有百分比值的CSS 属性来实现您正在寻找的东西。

看起来 BenM 比我快几秒钟。

# java - 使用接口实现时的“不可转换类型”

> ID：15228169
> 
> 赞同：0
> 
> 时间：2013-03-05T15:49:55.593
> 
> 标签：java, interface

尝试将接口的实现强制转换为接口时遇到意外错误（“不可转换的类型”）。

我得到了以下界面

```
public interface IAbc {...} 
```

以及另一个类中的以下方法

```
public class SomeClass {
    public doSomething(Iterable<IAbc> abcs) {...}
} 
```

我写了以下课程

```
public class MyAbc implements IAbc {...} 
```

我在其他地方有这样的方法

```
public class MyClass {
    public Iterable<MyAbc> getMyAbcs() {...}
} 
```

我希望我可以将它们很好地链接起来，如下所示：

```
public void doSomethingWithThings(SomeClass sc, MyClass mc) {
    sc.doSomething(mc.getMyAbcs());
} 
```

但 NetBeans 给了我以下错误：

> 错误：需要不可转换的类型
> `sc.doSomething(mc.getMyAbcs());`
> ：
> 发现可迭代：可迭代

我尝试铸造，但`Iterable<IAbc> abc = (Iterable<IAbc>)mc.getMyAbcs();`导致同样的错误。

如何将接口实现的 Iterable 传递给期望接口 Iterable 的方法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-05T15:52:40.773

`Iterable<MyAbc>`不是一个，即使**是**一个。`Iterable<IAbc>``MyAbc``IAbc`

尝试像这样的通配符：

```
public doSomething(Iterable<? extends IAbc> abcs) {...} 
```

这与数组相反，数组：`MyAbc[]`是`Iabc[]`

这是一个很好的教程更多[http://docs.oracle.com/javase/tutorial/extra/generics/wildcards.html](http://docs.oracle.com/javase/tutorial/extra/generics/wildcards.html)

# openerp - 我如何在创建表单中拥有初始默认值

> ID：15228171
> 
> 赞同：2
> 
> 时间：2013-03-05T15:50:04.770
> 
> 标签：openerp

我有一个代表 URL 书签的类

```
from openerp.osv import osv, fields

class jbbookmark_jbbookmark(osv.osv):

    _name = "jbbookmark.jbbookmark"
    _description = "Bookmark"

    def default_get(self, cr, uid, fields, context=None):
        res = super(jbbookmark_jbbookmark, self).default_get(cr, uid, fields,     context=context)

        res.update({'name': 'initial value test'})
        res.update({'description': 'initial value test'})
        return res

     _columns = {
         'name': fields.char('URL', required=True, translate=True),
         'description': fields.text('Description'),
         'title': fields.char('Name', size=20, required=True),
    }
     _defaults = {
         'name':'test URL',
    } 
```

添加记录时，我尝试设置表单字段的初始值，但字段只是空白。我怎样才能让这些值显示在表单视图中

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T04:54:33.127

您应该将值分配给字典中的键，而不是更新。

这肯定会奏效。

```
def default_get(self, cr, uid, fields, context=None):
    res = super(jbbookmark_jbbookmark, self).default_get(cr, uid, fields,     context=context)
    res['name'] = 'initial value test'
    res['description'] = 'initial value test'
    return res 
```

# apache - 带有 htaccess 的人类可读 url

> ID：15228174
> 
> 赞同：1
> 
> 时间：2013-03-05T15:50:13.690
> 
> 标签：apache, .htaccess, mod-rewrite

我的网站根文件夹中有这样的 .htaccess：

```
DirectoryIndex index.php
RewriteEngine On

Options -indexes

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule (.*) index.php 
```

这是由一些已安装的 CMS 创建的。

我有一个名为的文件夹，例如，`test`在根文件夹中。问题是：

*   如何从全局（根 htaccess）重写规则中删除此文件夹

*   这个文件夹有它自己的htaccess。在那里添加什么以允许我这样做：

> ```
>  site.com/test/some-data
>    --->
>    site.com/test/?id=some-data 
> ```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T16:04:35.847

如果我理解正确，您可以在根目录的 .htaccess 文件中尝试此操作：

```
Options +FollowSymlinks -MultiViews
RewriteEngine On
RewriteBase /

RewriteCond %{REQUEST_URI} !index\.php     [NC]
RewriteCond %{REQUEST_URI} !test           [NC]
RewriteRule (.*)           index.php       [L,NC]

RewriteCond %{QUERY_STRING} ^$
RewriteRule ^test/([^/]+)/? /test/?id=$1   [L,NC] 
```

目录中不需要另一个 .htaccess 文件`/test`。只使用这个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T18:13:58.753

如果你想在你的测试目录中有一个单独的 .htaccess，这个就足够了

```
RewriteEngine On

RewriteCond %{QUERY_STRING} !.
RewriteRule .+ ?id=$0 
```

# java - 为什么 java.io.Serializable 不是一个类？

> ID：15228175
> 
> 赞同：3
> 
> 时间：2013-03-05T15:50:25.317
> 
> 标签：java, class, serialization, interface, overriding

我知道这个问题听起来很奇怪，但我想知道为什么`java.io.Serializable`接口被精确地实现为接口而不是类？

让我想到这一点的原因是，我们正在讨论覆盖*/*`readObject`方法`writeObject`，而根据定义，我们不会*覆盖*它们（即我们的`Serializable`对象没有已经实现这些方法的超类型）。

因此，如果`Serializable`它是一个类，它可能已经实现了*默认* `readObject`的/`writeObject`方法，并且扩展的类可能已经能够*真正*覆盖所述方法。

* * *

这是一个**无效**的解决方法，可以说明我的话：

```
public class Serializable implements java.io.Serializable {

    private static final long serialVersionUID = 356223041512972356L;

    protected void readObject(ObjectInputStream stream) throws IOException, ClassNotFoundException {
        stream.defaultReadObject();
    }

    protected void writeObject(ObjectOutputStream stream) throws IOException {
        stream.defaultWriteObject();
    }

}

public class MyClass extends Serializable {

    private static final long serialVersionUID = -5437634103734137046L;

    @Override
    protected void readObject(ObjectInputStream stream) throws IOException, ClassNotFoundException {
        super.readObject(stream);
        // custom readObject method
    }

} 
```

PS：提供的解决方法不起作用，因为`readObject`/`writeObject`方法必须声明为`private`while mine are `protected`。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-05T15:51:08.123

因为如果你想从*另一个*类继承并实现`Serializable`. 这是 Java 在选择不支持真正的多重继承时所做的一般权衡。

您会注意到，Java 2.0 语言（Groovy 和 Scala）通过他们所谓的特征或 mixins 扭转了这一决定——它们的设计非常*精确*，因此您可以“混合”例如`Serializable`功能，而无需从逻辑上派生出来——您可能会将您的观点作为证据，Java 会很好地听取您的意见。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-05T15:52:10.590

如果`java.io.Serializable`是一个类，您将无法从另一个基类继承。

换句话说，它要么是继承，要么是序列化。

# jquery - jstree加载时将默认选定节点设置为root

> ID：15228179
> 
> 赞同：1
> 
> 时间：2013-03-05T15:50:33.453
> 
> 标签：jquery, jstree

我有以下 jquery 代码，它利用 jstree 插件来构建树，搜索 a 并选择树。当我用户选择一个节点时，它会打开一个新的浏览器选项卡。当我第一次加载第一页时，我需要默认选择根顶级根节点。我在ui下尝试了initial_select，但它不起作用。有任何想法吗？

```
$(document).ready(function(){
     $("#tree").jstree({  
        "xml_data" : {  
             "ajax" :   {  
                 "url" : "jstree.xml" 
                      },  
                "xsl" : "nest"
                        },  
            "themes" : {  

                "theme" : "classic",  
                "dots" : true,  
                "icons" : true 

                        },  
            "ui":       {
                "initially_select" : [ "root" ]
                "save_selected" : false
                        },

            "search" :  {  

                    "case_insensitive" : true,  
                    "ajax" : {  
                     "url" : "jstree.xml" 
                            }  
                        }, 
    "plugins" : ["themes", "xml_data", "ui","types", "search", "cookies"] 

    }).bind("select_node.jstree", function (event, data) {
        $("#tree").jstree("toggle_node", data.rslt.obj);

        var isTeamNode = false;
        var node_id = data.rslt.obj.attr("id");
            if (node_id.indexOf("team") >= 0)
                {
                    isTeamNode = true;
                    $.cookie("example", node_id, { path: '/', expires:7 });
                    window.open('new_tab.html', '_newtab');
                }
        }); 
```

# sql - 使用 where 扫描所有表而不是执行 where 查询视图

> ID：15228184
> 
> 赞同：0
> 
> 时间：2013-03-05T15:50:41.353
> 
> 标签：sql, postgresql, view

我创建了一个视图，它是几个表的联合。

```
create view report as
select date,a,b,0,0 from table1
union all
select date,0,0,c,d from table2 
```

我选择日期的位置：

```
select * from report where date = '2013-01-01' 
```

我查看说明，我看到 where 过滤器在执行结束时执行（在追加之后）。我如何以这样一种方式创建视图，即在追加之前每个表上的位置。

谢谢你

在 postgres9.1 中使用

解释 ::（表和列重命名以保护隐私）

```
"Aggregate  (cost=127286.88..127286.89 rows=1 width=8)"
"  ->  Subquery Scan on external_reports  (cost=0.00..127254.46 rows=12969 width=8)"
"        Filter: (external_reports.date = '2012-09-09 00:00:00'::timestamp without time zone)"
"        ->  Append  (cost=0.00..94831.27 rows=2593855 width=54)"
"              ->  Result  (cost=0.00..71.38 rows=10 width=112)"
"                    ->  Append  (cost=0.00..71.38 rows=10 width=112)"
"                          ->  Seq Scan on report1  (cost=0.00..14.26 rows=2 width=112)"
"                                Filter: ((x)::text = 'ADS'::text)"
"                          ->  Seq Scan on report2  (cost=0.00..14.26 rows=2 width=112)"
"                                Filter: ((x)::text = 'ADS2'::text)"
"                          ->  Seq Scan on report3  (cost=0.00..14.26 rows=2 width=112)"
"                                Filter: ((x)::text = 'ADS3'::text)"
"                          ->  Seq Scan on report4  (cost=0.00..14.26 rows=2 width=112)"
"                                Filter: ((x)::text = 'ADS4'::text)"
"                          ->  Seq Scan on report5  (cost=0.00..14.26 rows=2 width=112)"
"                                Filter: ((x)::text = 'ADS5'::text)"
"              ->  Seq Scan on report6  (cost=0.00..65421.34 rows=2459934 width=54)"
"              ->  Subquery Scan on "*SELECT* 7"  (cost=0.00..4739.22 rows=133911 width=52)"
"                    ->  Seq Scan on report___  (cost=0.00..3400.11 rows=133911 width=52)" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T07:57:58.103

似乎没有办法做到这一点。由于每个 select 都是分开的，并且在 select 之后执行 union，所以每个 select 将在哪里完成。

# java - RegexFileFilter 在 jboss 7 中运行时表现不同

> ID：15228188
> 
> 赞同：0
> 
> 时间：2013-03-05T15:50:46.097
> 
> 标签：java, jboss7.x, apache-commons, java-io, apache-commons-io

我需要根据文件的名称和扩展名对文件进行排序。我为此使用 apache commons-io RegexFileFilter。文件名模式是这样的：“filename.xml.20130101200”或“filename.xml.20130101200.inprog”，其中数字是简单的时间戳。

```
FileFilter regexFilter = new RegexFileFilter( ".*\\d{12}|.*inprog" );
File[] suitableFiles = dir.listFiles( regexFilter ); 
```

如果包含这些文件的这个目录在我的主目录“/home/user/files”中，那么使用 jboss 运行时一切正常。但是当我将文件夹更改为“/tmp/files/”时，过滤器会找到扩展名为“.inprog”的文件。当我记录目录中的文件数时，它显示正确的数量。我编写了简单的主程序进行测试，一切正常，即使文件在 /tmp/files 中。Jboss 位于我的主文件夹中。

可能是什么问题呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T15:29:22.350

问题出在正则表达式中。正则表达式字符串取自 oracle 数据库表。当我把它改成“.*\d{12}| *.inprog”，去掉一个反斜杠，它就开始工作了。".* [0-9]{12}|.*inprog" 也可以正常工作

# hibernate - Hibernate - 允许引用未保存的瞬态实例

> ID：15228196
> 
> 赞同：0
> 
> 时间：2013-03-05T15:51:19.420
> 
> 标签：hibernate

我正在使用 Hibernate 保存与其他表有关系的表的记录，但我需要允许空引用，而不保存子对象。

情况是这样的：A类有相关的对象b和c，当我保存一个A实例时，我想保存b和c的空引用。

表结构如下：

```
id (PK) | id_tr_inner_costs | release_id | requirement_id | task_id | hours | total_cost 
```

requirements_id 和/或 task_id 可以为空，在这种情况下应该这样设置。

可能吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T16:40:19.277

Hibernate will set those ID's to null if the references are null at the time of saving. So something like this:

```
A instanceOfA = ...;
instanceOfA.setRelease(null);
instanceOfA.setTask(null);
session.save(instanceOfA); 
```

should result in you having a row in the A table that has `NULL` for both `release_id` and `task_id`.

This is detailed very lightly in the [Hibernate docs](http://docs.jboss.org/hibernate/orm/3.3/reference/en-US/html/mapping.html#mapping-types-entitiesvalues):

> With the exception of collections, all built-in Hibernate types support null semantics.

ie, if something is null in Java, then it will be null in the database.

# peoplesoft - 集成代理 - 用户 ID 未获得 GETWSDL 授权

> ID：15228200
> 
> 赞同：0
> 
> 时间：2013-03-05T15:51:27.953
> 
> 标签：peoplesoft

我正在尝试让 Web 服务在 PeopleSoft 中工作以访问组件接口。我收到以下错误。但是 UserID 可以访问集成代理 Web 服务，包括 GETWSDL。有任何想法吗？

![在此处输入图像描述](../Images/2835c867fa014b21f2012397aae35af0.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T08:56:29.677

转到集成代理 > 集成设置 > 节点以打开本地节点。

确保默认用户 ID 有效且帐户未被锁定。

或者只是设置为“匿名”。

# objective-c - 我的打印方法无法使用 UTF8String

> ID：15228203
> 
> 赞同：2
> 
> 时间：2013-03-05T15:51:31.997
> 
> 标签：objective-c

我有两个课程，歌曲课程和播放列表课程。

这是 Song.h：

```
#import <Foundation/Foundation.h>

@interface Song : NSObject

@property (nonatomic, copy) NSString *artist, *title, *album, *time;

-(void) setSong:(NSString *)theSongName andArtist:(NSString *)theArtist andAlbum:(NSString *)theAlbum andPlayingTime:(NSString *)theTime;

@end 
```

宋.m

```
@implementation Song

@synthesize title, album, artist, time;

-(void) setSong:(NSString *)theSongName andArtist:(NSString *)theArtist andAlbum:(NSString *)theAlbum andPlayingTime:(NSString *)theTime{

    self.title = theSongName;
    self.artist = theArtist;
    self.album = theAlbum;
    self.time = theTime;
}

@end 
```

播放列表.h

```
@interface PlayList : NSObject

@property (nonatomic, copy) NSString *playListName;
@property (nonatomic, copy) NSMutableArray *songsCollection;

-(void) addSongToPlayList:(Song *) someSong;
-(void) removeSongFromPlayList:(Song *) theSong;
-(void) print;

@end 
```

播放列表.m：

```
@implementation PlayList

@synthesize songsCollection, playListName;

-(void) addSongToPlayList:(Song *) someSong{

    [songsCollection addObject:someSong];
}

-(void) removeSongFromPlayList:(Song *)theSong{

    [songsCollection removeObjectIdenticalTo:theSong];
}

-(void) print{

        NSLog(@"================= Playlist Name: %@ =============", playListName);
    for (Song *nextSong in songsCollection){
        NSLog(@"Artist         Song         Album         Time");
        NSLog(@"------         ----         -----         ----");
        NSLog(@"%s             %s           %s            %s  ", [nextSong.artist UTF8String], [nextSong.title UTF8String], [nextSong.album UTF8String], [nextSong.time UTF8String]);
        NSLog(@"=================================================");
    }
}

@end 
```

该`print`方法给我带来了问题，它只打印这一行：

`NSLog(@"================= Playlist Name: %@ =============", playListName);`

主文件

```
#import <Foundation/Foundation.h>
#import "Song.h"
#import "PlayList.h"

int main(int argc, const char * argv[])
{

    @autoreleasepool {

        Song *song1 = [[Song alloc] init];
        [song1 setSong:@"Flying away" andArtist:@"Madona" andAlbum:@"Love collection" andPlayingTime:@"3:52"];

        PlayList *playList1 = [[PlayList alloc] init];
        [playList1 setPlayListName:@"Cool Soongs to listen"];

        [playList1 addSongToPlayList:song1];
        [playList1 print];

    }
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T15:55:29.153

`songsCollection`问题是由于其属性的定义，您没有正确填充数组（即它是空的）：

```
 @property (nonatomic, copy) NSMutableArray *songsCollection; 
```

您需要将其更改为 (ARC)：

```
 @property (nonatomic, strong) NSMutableArray *songsCollection; 
```

或（MRR）：

```
 @property (nonatomic, retain) NSMutableArray *songsCollection; 
```

还将所有引用从 更改`songsCollection`为类`self.songsCollection`内`PlayList`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T16:10:16.430

你还没有`alloc`+ `init`ed `songsCollection`。

在 PlayList.m 中创建一个`init`方法并放在下面

```
- (id)init
{
    self = [super init];
    if (self) {
        songsCollection=[NSMutableArray new];
    }
    return self;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T16:04:03.740

试试这个。

```
NSLog(@"================= Playlist Name: %@ =============", self.playListName); 
```

`songsCollection`数组可能没有有效的内存。使用强。在你的方法中实例化它

```
-(id)init
{
    self=[super init];
    self.songsCollection =[[NSMutableArray alloc]initWithCapacity:3];
    return self;
} 
```

# ruby-on-rails - 如何在设计中为密码页面应用自定义布局？

> ID：15228207
> 
> 赞同：0
> 
> 时间：2013-03-05T15:51:44.707
> 
> 标签：ruby-on-rails, ruby-on-rails-3, devise, passwords

我正在处理一个需要为密码页面添加新布局的现有项目。我似乎找不到足够完整的答案来获得我需要的工作。我在 application_controller.rb 中的内容是：

```
class ApplicationController < ActionController::Base
  protect_from_forgery

  layout :layout_by_resource

  protected

  def layout_by_resource
    if devise_controller?
      'signin'
    else
      'application'
    end
  end
end 
```

根据我的阅读，这需要以某种方式更改为这种格式：

```
config.to_prepare do
  Devise::SessionsController.layout "devise"
  Devise::RegistrationsController.layout proc{ |controller| user_signed_in? ? "application" : "devise" }
  Devise::ConfirmationsController.layout "devise"
  Devise::UnlocksController.layout "devise"            
  Devise::PasswordsController.layout "devise"        
end 
```

...但是试图把它和我所拥有的东西放在一起不起作用或破坏一切。

谁能解释这些部分是如何组合在一起的？上面的代码在哪里？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T00:37:41.460

没有人回答，可能是因为这是一个愚蠢的问题。

一旦我意识到一个打算进入配置（application.rb）而另一个进入控制器（application_controller.rb），事情就解决了。

# hadoop - 在独立模式下执行 hadoop 示例时权限被拒绝

> ID：15228208
> 
> 赞同：0
> 
> 时间：2013-03-05T15:51:47.367
> 
> 标签：hadoop, mapreduce

我正在尝试在独立模式下运行 hadoop。当我尝试执行命令时

```
bin/hadoop jar hadoop-mapred-examples-0.21.0.jar grep input output 
```

我收到以下错误：

```
laxmikant@laxmikant-Inspiron-1464:~/Work/hadoop-0.21.0$ bin/hadoop jar hadoop-mapred-  examples-0.21.0.jar grep input output
/home/laxmikant/Work/hadoop-0.21.0/bin/hadoop-config.sh: line 189:     /home/laxmikant/java/jdk1.7.0_04/bin/java: Permission denied
bin/hadoop: line 120: /home/laxmikant/java/jdk1.7.0_04/bin/java: Permission denied
bin/hadoop: line 120: exec: /home/laxmikant/java/jdk1.7.0_04/bin/java: cannot execute:     Permission denied 
```

如何消除错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T18:44:46.713

您正在运行的用户似乎`hadoop`没有运行权限`java`。但是通过查看 java 的二进制文件所在的路径（/home/laxmikant/java/），用户`laxmikant`或 root 用户应该可以轻松访问它。因此，如果您尝试以用户身份执行它`laxmikant`并且仍然收到错误，那么，可能没有正确安装 Java。还要确保`JAVA_HOME`在 hadoop 的 conf/hadoop-env.sh 中正确设置。

# sql - 如何根据其他两列返回最大日期？

> ID：15228209
> 
> 赞同：1
> 
> 时间：2013-03-05T15:51:47.813
> 
> 标签：sql, ms-access, ms-access-2007, maxdate

我一直无法找到这个问题的答案，所以我希望这里有人可以提供帮助。我需要为每个 ID 返回每个课程的最大日期。我一直在使用子查询从另一列中选择最大日期，但似乎找不到一种方法来考虑这两列。数据看起来像这样：

```
ID    Course    CourseDate
1     DD        1/14/2013
1     DD        1/16/2013
1     CC        2/22/2013
1     CC        2/15/2013
2     DD        1/16/2013 
```

我希望得到如下所示的结果：

```
ID    Course    CourseDate
1     DD        1/16/2013
1     CC        2/22/2013
2     DD        1/16/2013 
```

非常感谢您的帮助！非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T15:52:50.323

使用`GROUP BY`和`MAX()`

```
SELECT  ID, Course, MAX(CourseDATE) MAx_DATE
FROM    TableName
GROUP   BY ID, Course 
```

# java - 使用这个。或超级。当调用存在于超类和子类中的方法时

> ID：15228215
> 
> 赞同：3
> 
> 时间：2013-03-05T15:52:00.200
> 
> 标签：java, oop, inheritance, reference, this

有一个名为 Champion 的类，它有一个 Skill 数组作为实例变量。

它实现了一个名为“public final Skill[] getSkills()”的方法，其中 Skill[] 是另一个名为 Skill 的对象的数组。

有一个名为 Support 的子类实现了一个名为“public final boolean canHeal()”的方法，该方法检查方法 canHeal 中的技能数组。

我应该写“Skill[] x = this.getSkills()”还是：Skill[] x = super.getSkills()”来获取 Skill 数组，为什么？

请记住，getSkills 方法仅在 Champion 类中定义，在 Support 类中没有被覆盖。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T15:55:08.137

该`super`关键字允许您调用您的类覆盖或隐藏的方法的基类版本。

如果你的类没有单独的`getSkills()`方法，`super`将没有效果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-05T15:57:33.963

我认为最好在没有`super`.

首先 - 现在有区别。将来，如果您在课堂上重写此函数，将很难发现（或至少需要注意）。

如果您覆盖您的函数，您可能希望在`super.getSkills()`其中调用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T16:06:19.510

你都不应该这样做。添加`this.`只是多余的，`super.`如果将来您覆盖，添加可能会破坏您的课程`getSkills()`。所以就这样做：

```
Skill[] x = getSkills(); 
```

在当前情况下它只会调用超类中定义的方法，如果将来你有理由重写`getSkills()`（例如因为你的类使用了不同的方式，或者有额外的条件），它将被自动使用；这比继续调用超类方法更有可能是正确的行为。

一般来说，`super.someMethod()`如果需要，您应该只在被覆盖的方法内部调用（例如，不重复某些逻辑或副作用）。仅当您确定不想要自己的实现，而是您的超类的实现时，才应该在另一种方法中使用它。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-03-05T15:55:53.003

我认为您可以使用任何一种，因为 Support 是冠军，但使用 super.getSkills 会使代码更清楚地表明您正在调用超类中的方法。

# java - 如何要求我的 Spring 应用程序中的所有请求处理程序都具有 @PreAuthorize

> ID：15228217
> 
> 赞同：1
> 
> 时间：2013-03-05T15:52:01.377
> 
> 标签：java, spring, security, spring-security

我想将 Spring 安全应用程序切换到注释，但我想确保每个请求都有自己的`@PreAuthorize`注释，然后才允许在外部调用它。

是否可以为此设置 Spring Security 策略？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T17:02:31.037

据我所知，没有办法定义这种政策。

但是您可以设置一个 Spring MVC 拦截器，它将在运行时检查相应处理程序方法上是否存在 PreAuthorize 注释：

```
public class PreAuthorizeChecker implements HandlerInterceptor {

    @Override
    public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception {
        if (handler instanceof HandlerMethod) {
            HandlerMethod hm = (HandlerMethod) handler;
            PreAuthorize annotation = AnnotationUtils.findAnnotation(hm.getMethod(), PreAuthorize.class);
            if (annotation == null) {
                // prevent access to method wihout security restrictions
                throw new RuntimeException("Rights are not defined for this handler");
            }

        }
        return true;
    }
.....
} 
```

# sql - 针对表列运行最长匹配前缀的最佳方法是什么？

> ID：15228220
> 
> 赞同：0
> 
> 时间：2013-03-05T15:52:09.043
> 
> 标签：sql, postgresql, longest-prefix

我需要对表中的列运行最长匹配前缀，而不仅仅是单个值。对于单个值，我使用类似`SELECT value, prefix as lmp FROM aTable WHERE SUBSTRING(value,1, LENGTH(prefix)) = prefix ORDER BY prefix DESC limit 1`.

问题是，如果它是针对许多记录进行的，它将需要进行表扫描并逐个获取值，并且将需要客户端和服务器之间的大量流量。

有没有办法在涉及子查询但不涉及存储过程的单个查询中做到这一点？我正在使用 PostgreSQL 8.4。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T16:03:55.720

您可以使用 CTE 将值放入表中并执行以下操作：

```
with list as (
    select 'abc' as prefix union all
    . . .
)
select value, lmp
from (SELECT value, prefix as lmp,
             row_number() over (partition by value order by len(prefix) desc) as seqnum
      FROM aTable join
           list l
           on SUBSTRING(value,1, LENGTH(prefix)) = prefix
     ) t
where seqnum = 1 
```

这会将循环完全移动到服务器上，这应该会更快一些。

# javascript - Twitter Bootstrap Affix - 如何坚持到底？

> ID：15228224
> 
> 赞同：20
> 
> 时间：2013-03-05T15:52:14.983
> 
> 标签：javascript, jquery, css, twitter-bootstrap, affix

我已经阅读了文档，我觉得我所做的正是他们在示例中展示的内容。然而，当我尝试它时，我无法让它工作。我希望它以类似于文档的方式工作。它`position:fixed`在滚动过去页眉之后变成，然后一旦它接触到页脚，它就会变成`position:absolute`并粘在底部。

* * *

## 演示：http: [//jsfiddle.net/uvnGP/1/](http://jsfiddle.net/uvnGP/1/)

## JS

```
$("#account-overview-container").affix({
    offset: {
        top: $("header").outerHeight(true),
        bottom: $("footer").outerHeight(true)
    }
}); 
```

## SASS

```
#account-overview-container {
    &.affix{
        top:10px;
        bottom:auto;
    }

    &.affix-top{
        //Do I need this?
    }

    &.affix-bottom{
        position:absolute;
        top:auto;
        bottom:140px;
    }
} 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2014-02-19T23:25:09.697

您的代码有一些更改，但该解决方案适用于可变页眉和页脚高度、响应宽度，并且可以更改为固定页眉。

链接在这里

[http://jsfiddle.net/uvnGP/131/](http://jsfiddle.net/uvnGP/131/)

问题是，当词缀到达底部时，容器中添加了**顶部**和**底部css 样式（#sidebar），修复它的方法是将****底部**样式重置为*auto*，这样只有**顶部**样式会在你的容器上行动

这是代码：

```
var headerHeight = $('header').outerHeight(true); // true value, adds margins to the total height
var footerHeight = $('footer').innerHeight();
$('#account-overview-container').affix({
    offset: {
        top: headerHeight,
        bottom: footerHeight
    }
}).on('affix.bs.affix', function () { // before affix
    $(this).css({
        /*'top': headerHeight,*/    // for fixed height
            'width': $(this).outerWidth()  // variable widths
    });
}).on('affix-bottom.bs.affix', function () { // before affix-bottom
    $(this).css('bottom', 'auto'); // THIS is what makes the jumping
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-11T13:40:16.660

如果您不介意在标记中使用“数据-”属性而不是 SASS，这应该可以：

[http://www.bootply.com/l95thIfavC](http://www.bootply.com/l95thIfavC)

您还会看到我删除了 JS 词缀。

**HTML**

```
<div class="well well-small affix-top" data-spy="affix" data-offset-top="150" id="account-overview-container"> 
```

**CSS**

```
body{
    position:relative;
}
header,
footer{
    background: #ccc;
    padding:40px 0;
    text-align:center;
}
header{
    margin-bottom: 10px;
}

.affix-top {
    top: 155px;
    position:absolute;
}
.affix {
    bottom:140px;
} 
```

**Bootstrap 3 的更新**

要使用`affix-bottom`，您基本上需要设置页脚的高度或附加元素下方的空间。这是一个例子： http: [//www.bootply.com/l95thIfavC](http://www.bootply.com/l95thIfavC)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-06-02T23:31:34.300

我设法让它在我的应用程序中工作，这是使底部样式与传递给附加调用的底部一致的问题。如果您的页脚具有固定高度并且最近定位的父级是主体，那么为两者传递相同的值就很重要了。[这对于此处](https://github.com/twitter/bootstrap/blob/v2.3.2/docs/assets/css/docs.css#L845)和[此处](https://github.com/twitter/bootstrap/blob/v2.3.2/docs/assets/js/application.js#L21)所见的 Bootstrap 2.3 文档来说已经足够好了。

--

现在假设您没有固定高度的页脚：

第 1 步：最近定位的父级（偏移父级）

首先，我们使用绝对定位将其粘贴到底部，但由于您最近定位的父级将是主体（包括您的页脚），因此您没有固定的底部值。为了解决这个问题，我们必须创建一个新的定位父对象，它包含除了页脚之外的所有内容（重要：页眉也可能在外面）。设置`position: relative;`为顶部`.container`或其祖先之一（重要：页脚必须在此元素之后）。

第 2 步：页脚高度

现在，你的底部是相对于它的容器而不是 body，但是 affix 的底部值（用于知道何时将词缀贴到底部）仍然是相对于 body 的末端，所以你必须给它传递一个函数计算容器之后元素的高度，如果它只是页脚，那么这就足够了`$('footer').outerHeight(true)`：

第 3 步：故障排除

现在，一切都正确了，但是三件事仍然可能导致不正确的摇杆位置和疯狂的闪烁：

1.  除了您没有考虑到的页脚之外的其他视觉元素，例如第二个页脚或并不总是显示的，例如有用的[rails-footnotes gem](https://github.com/josevalim/rails-footnotes)；

2.  将元素附加到 DOM 的浏览器扩展，如果它们被隐藏或不在流中，那么你不应该计算它们的高度，更简单的解决方法是只计算你的应用程序知道的元素，但是扩展可能会结束打破你的应用程序。您可以通过使用未安装扩展程序的浏览器或配置来测试扩展程序是否会导致您出现问题，或者只是转到“色情模式”（Chromium 上的隐身模式（`Ctrl`+ `Shift`+ `n`），Firefox 上的隐私浏览（`Ctrl`+ `Shift`+ `p`)) 如果您没有启用扩展。

3.  Javascript 库也会将元素附加到 DOM，你也不应该计算它们的高度。

要解决这些问题，您可以**尝试**使用整个单词（CoffeeScript with Underscore.js）：

```
_($('footer').nextAll(':visible').addBack())
  .filter((el) -> el.offsetParent?)
  .reduce(((memo, el) -> memo + $(el).outerHeight(true)), 0) 
```

同样的事情，使用 Javascript 和 jQuery.fn.each：

```
var sum = 0
$('footer').nextAll(':visible').each(function() {
  this.offsetParent != null && sum += $(this).outerHeight(true)
}
return sum 
```

或者你可以只考虑你知道的元素（我更喜欢这个，我为挑战编码的另一个）：

```
$('footer').outerHeight(true) + ($('#footnotes_debug').outerHeight(true) || 0) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-12-19T18:49:31.280

简短回答：请注意，`box-sizing: border-box;`如果您使用边框，您的词缀内的内容不会被使用。

说明：`offset()`affix.js 中用于计算元素相对于文档的当前位置的 jQuery 函数没有考虑边框。

> 注意：jQuery 不支持获取隐藏元素的偏移坐标或考虑在 body 元素上设置的边框、边距或填充。

因此，如果您的词缀内的内容有一个边框并且它`box-sizing`被设置为`border-box`，那么高度将包括边框但偏移量不会，导致计算词缀使用稍微偏离。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-03-04T09:25:43.283

Paco Rivera 的解决方案有效！但不是按照他想要的方式。Wat 真正消除了闪烁（跳跃）问题是这一行：

```
.on('affix.bs.affix', function () { // before affix
    $(this).css({
        'width': $(this).outerWidth()  // variable widths
    });
}) 
```

很奇怪，您甚至不必设置 CSS 宽度。只需阅读此参数即可。我将代码简化为以下片段，它仍然有效：

```
.on('affix.bs.affix', function () { // before affix
    $(this).width();
}); 
```

我会一直保持这种状态，直到 Bootstrap Affix 插件的下一个版本发布，我希望他们能一劳永逸地修复它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-07-10T01:10:37.910

如果您在小提琴上稍微增加窗口大小，您的小提琴似乎可以按需要工作。考虑到网站在词缀中断的维度上将无法使用，您应该忽略它，或者更改布局以使用较小的空间，而不是尝试解决问题。文档中的引导词缀不用于较小的分辨率，我会效仿。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-12-10T16:58:28.887

一种可能的解决方案是通过如下设置完全忽略这种`affix-bottom`情况`bottom: null`：

```
$("#my-selector").affix({
    offset: {
        top: $("#some-thing").outerHeight(true),
        bottom: null
    }
}); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-01-20T06:08:27.537

只需替换引导程序中附加的代码段，如下所示。

这是 -

```
this.$element.offset({ top: document.body.offsetHeight - offsetBottom - this.$element.height() }) 
```

这取代了它

```
this.$element.offset({ top: scrollHeight - offsetBottom - this.$element.height() }) 
```

干杯。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-11-26T09:52:51.380

我通过一些试错过程完成了这项工作，但这对我有用。

JS

```
$(document).ready(function() {
var SidebarTop = $('#your-affix').offset().top - x; //adjust x to meet your required positioning
    SidebarBottom = $('.site-footer').outerHeight() + x;

    $('#your-affix').affix({
        offset: {
        top: SidebarTop,
        bottom: SidebarBottom
        }
    });
}); 
```

CSS

```
#your-affix.affix {
    top: boo px; //the px from top of the window where you want your sidebar
                 //be when you scroll
    width: foo px; //your sidebar width
  }
#your-affix.affix-bottom {
    position: absolute;
    width: foo px; //your sidebar width
} 
```

在此代码之后，当我的侧边栏到达页脚时，它会“取消固定”。并在到达底部偏移选项时停止跳转到站点顶部。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-08-03T08:54:02.870

`position: absolute`为`.affix-top`&`.affix-bottom`和设置。`position: fixed`_`.affix`

根据官方[文档](http://getbootstrap.com/javascript/#positioning-via-css)

# matlab - Matlab 函数表示

> ID：15228225
> 
> 赞同：-1
> 
> 时间：2013-03-05T15:52:15.583
> 
> 标签：matlab

我知道，如果我想生成 y=sin(2x) 的 y 值，我可以这样做：

```
y = sin(0:.01:2*2); 
```

但是，如果我想生成 y = 0 的值，除非 x 是 1 的倍数或 sqrt(2) 点 y=1，我将如何解决这个问题？我必须围绕这些值创建一个窗口并希望步长足够小以捕获它吗？谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T16:18:29.220

使用逻辑条件。例如，从 some `y(x)`then开始`y(y==1)`将针对此条件生成 y 值，并在其他位置生成零。对于更通用的条件，您可以使用`mod`等`ismember`。您将遇到的另一个问题是将整数与浮点数匹配，您必须先四舍五入，然后使用上面提到的函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T17:12:21.013

好的我明白了。同样，浮点算术不做相等，所以你的例子不起作用。此外，由于您以谨慎的间隔对函数进行采样，因此很难捕获 delta 函数。所以不要这样做。相反，如果您正在寻找标准的分段函数，那么这个想法是：

```
x = 0:.01:2;
x1_locations = x < 1;
x2_locations = ~x;
y = zeros(size(x));
y(x1_locations) = sin(2*x(x1_locations));
y(x2_locations) = cos(3*x(x2_locations)); 
```

再说一次，这不起作用的原因`x1_locations = (floor(x/sqrt(2)) == x/sqrt(2))`是，你永远不会碰到 x 的确切位置来显示这个，即使你这样做了，浮点表示中的舍入错误仍然可能会让你错过位置。如果您可以使用近似值，请使用与您感兴趣的值的最大绝对差。

# c# - 从 C# 中的 HttpRequest 对象中提取 SOAP 方法

> ID：15228226
> 
> 赞同：0
> 
> 时间：2013-03-05T15:52:18.070
> 
> 标签：c#, .net, web-services, soap, asmx

我有一个每次调用 WebService 时都会调用的日志记录方法，用于记录有关调用的信息。我需要能够提取为记录目的而调用的服务方法名称。

如何仅使用传递给日志记录函数的 HttpRequest 对象来执行此操作？

```
 public static void LogApiCall(HttpRequest  httpRequest, string resultText = "Success", int resultCode = 0)
   {
      // Need to get the SOAP method named called from httpRequest here...
   } 
```

**更新：**

这是我最终从接受的答案中使用的代码（稍作修改）。此代码经过测试和验证可以正常工作。

```
/// <summary>
/// Returns the Soap method name called from the http request object.
/// </summary>
public static string SoapMethod(HttpRequest httpRequest)
{

    var bodyRequest = XDocument.Parse(GetDocumentContents(httpRequest));

    if (bodyRequest.Root == null) 
        return httpRequest.Url.AbsoluteUri; 

    var element = bodyRequest.Root.Elements().Where(e => e.Name.LocalName == "Body").Elements().FirstOrDefault();

    return element != null ? element.Name.LocalName : httpRequest.Url.AbsoluteUri;
}

/// <summary>
/// Converts the input stream to a string for XML parsing.
/// </summary>
private static string GetDocumentContents(HttpRequest request)
{
    string documentContents;

    request.InputStream.Position = 0;
    using (var receiveStream = request.InputStream)
    {
        using (var readStream = new StreamReader(receiveStream, request.ContentEncoding))
        {
            documentContents = readStream.ReadToEnd();
        }
    }

    return documentContents;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T16:19:14.460

```
public static void LogApiCall(HttpRequest httpRequest, string resultText = "Success", int resultCode = 0)
{

    XDocument bodyRequest = XDocument.Parse(GetDocumentContents(httpRequest));
    string methodName = bodyRequest.Root
                                    .Elements()
                                    .Where(e => e.Name.LocalName == "Body")
                                    .Elements()
                                    .FirstOrDefault().Name.LocalName;
}

private static string GetDocumentContents(HttpRequest request)
{
    string documentContents;
    using (Stream receiveStream = request.InputStream)
    {
        using (StreamReader readStream = new StreamReader(receiveStream, Encoding.UTF8))
        {
            documentContents = readStream.ReadToEnd();
        }
    }
    return documentContents;
} 
```

# ruby-on-rails - ror 中的多个布局

> ID：15228228
> 
> 赞同：7
> 
> 时间：2013-03-05T15:52:27.487
> 
> 标签：ruby-on-rails, layout

昨天刚开始使用 Ruby on Rails。在我的 layouts/application.html.erb 我有：

```
<!DOCTYPE html>
<html>
  <head>
    <title><%= full_title(yield(:title)) %></title>
    <%= stylesheet_link_tag    "application", media: "all" %>
    <%= javascript_include_tag "application" %>
    <%= csrf_meta_tags %>  
  </head>
  <body>
    <%= render 'layouts/header' %>
    <div class="container">
      <%= yield %>
    </div>
    <%= render 'layouts/footer' %>
  </body>
</html> 
```

来自 php ->codeigniter 背景，我假设渲染类似于 $this->load->view(''); 在代码点火器中。
虽然这很好用，但我希望有多个应用程序布局文件，例如

1.  布局/应用程序默认值
2.  布局/应用程序全宽（用于全宽页面）
3.  等等..

在 codeigniter 中，您只需声明您希望使用的模板/布局文件，但由于 ruby​​ on rails 有点神奇（它为您做了很多事情），我假设它默认调用应用程序布局。我想知道是否有办法选择我想要的布局文件？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2014-03-17T16:17:06.707

@Deefour 提供了正确的资源，这是一个很好的快速示例，说明如何在 Rails 4 中实现这一点。

在控制器中，您可以指定要在哪里获取特定操作的布局，并对使用的布局进行非常精细的控制。

```
class PagesController < ApplicationController
  layout "fullwidth", except: [:index, :faqs]

  def popout
    # Render this action with specific layout
    render layout: "popout"
    #renders with views/layouts/popout.html.erb
  end

  def index
    #renders with views/layouts/application.html.erb
  end

  def about_us
    #renders with views/layouts/fullwidth.html.erb
  end

  def team
    #renders with views/layouts/fullwidth.html.erb
  end

  def logo
    #renders with views/layouts/fullwidth.html.erb
  end

  def faqs
    #renders with views/layouts/application.html.erb
  end
end 
```

***application.html.erb***是 rails 标准布局文件。我假设它存在，它是默认的后备！

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-03-05T16:03:40.230

你正在寻找[`layout`](http://api.rubyonrails.org/classes/AbstractController/Layouts/ClassMethods.html#method-i-layout)方法。

[本 Rails 指南](http://guides.rubyonrails.org/layouts_and_rendering.html)将帮助您，特别是[Find Layouts](http://guides.rubyonrails.org/layouts_and_rendering.html#finding-layouts)。我将在此处提供更多详细信息，但前面提到的文档和指南提供了足够多的示例和使用说明。

# ruby-on-rails - 获取关联以显示其所有所属模型的问题

> ID：15228230
> 
> 赞同：0
> 
> 时间：2013-03-05T15:52:34.783
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.2

我正在为我的大学创建一个注册系统。

我有两个模型，一个是存在`Register`，另一个是存在`Student`。A`Register`有很多`Students`，我在各自的`.rb`文件中描述了以下内容：

```
class Student < ActiveRecord::Base
 belongs_to :register
attr_accessible :first_name, :last_name, :university_id

class Register < ActiveRecord::Base
  belongs_to :student
  belongs_to :module_class
  belongs_to :event
  has_many :students
  attr_accessible :date, :present, :time_of_arrival, :student_id, :module_class_id, :event_id 
```

表格看起来像这样，来自`schema.rb`文件：

```
 create_table "registers", :force => true do |t|
    t.integer  "student_id"
    t.boolean  "present"
    t.integer  "module_class_id"
    t.integer  "event_id"
    t.time     "time_of_arrival"
    t.date     "date"
    t.datetime "created_at",      :null => false
    t.datetime "updated_at",      :null => false
  end

  add_index "registers", ["event_id"], :name => "index_registers_on_event_id"
  add_index "registers", ["module_class_id"], :name => "index_registers_on_module_class_id"
  add_index "registers", ["student_id"], :name => "index_registers_on_student_id" 
```

我现在的问题是，我希望能够查看注册表中的学生列表，以便将他们标记为存在或缺席（`register/1`例如）。这是它目前的样子： ![在此处输入图像描述](../Images/f720d967252d461360b9adf6e9626e7b.png)

但是，目前我只能将一个学生分配给一个寄存器，并且`Present`出现复选框（这是在`register/new`页面中）![新注册页面的打印屏幕](../Images/1bb7f7013febdf09bb37f3dda9318c19.png)。

`register`索引本身如下所示 ：![在此处输入图像描述](../Images/7cacaf3c20d68e9893cf71e7fd2d7beb.png)

我将`simple_form`gem 用于表格，以防提供更多线索。

编辑：从 RubyMine 添加图表以显示依赖关系： ![在此处输入图像描述](../Images/0736f70597d2ad52b3c1f453252f9c2c.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T20:04:39.120

你说一个寄存器有很多学生，那你为什么在你的寄存器表中使用`belongs_to :student`并添加一个`student_id`列？

# php - !$a - $a 的结果应该是什么

> ID：15228234
> 
> 赞同：1
> 
> 时间：2013-03-05T15:52:42.833
> 
> 标签：php, math

我有这个代码：

```
$a = 1;
$a = !$a - $a;
echo $a; 
```

我在想`!0`- 开玩笑，但输出是`-1`. 不幸的是，我不明白为什么结果是`-1`. 如果有人解释，那就太好了。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-05T15:54:07.637

如果你这样做`var_dump(!$a);`，你会发现它`!$a`不再是整数了。这是一个`boolean false`，并不是因为它`1`在你的情况下的原始价值。看看这个：

```
$a = 5;
$a = !$a - $a; 
echo $a;    // output: -5 
```

您可能也有兴趣执行以下操作：

```
$a = 5;
$a = false - $a;
echo $a;     // output: -5 
```

所以，正如你所看到的，`!$a`意思是`false`它翻译成`0`. 所以，根据你的例子，我们有这样的事情：

```
$a = 1;
$a = !$a - $a; 
```

这相当于：

```
$a = 0 - 1; 
```

这是`-1`。

此外，`true`还翻译为`1`。你想确定吗？试试看：

```
$a = 5;
$a = true - $a;
echo $a;    // output: -4 
```

我想现在应该足够清楚了！让我知道它是否仍然令人困惑。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-05T16:02:59.887

这是因为一元 NOT在减法*之前*被评估，即它的评估如下：

```
$a = (!$a) - $a; 
```

*在这里，`!$a`=>也因为减法而被强制`false`转换。`0`*

为了得到你所期望的，你应该加上括号：

```
$a = !($a - $a); 
```

另请参阅：[运算符优先级](http://php.net/manual/en/language.operators.precedence.php)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T15:55:07.970

嗯`$a`是 1

因此`NOT $a`which 为`!$a`假（转换为 0）

```
0 - 1 = -1 
```

运算符`!`是逻辑非运算符

# java - 运算符^在java中代表什么？

> ID：15228235
> 
> 赞同：0
> 
> 时间：2013-03-05T15:52:46.080
> 
> 标签：java

我只是在代码中看到它，所以我尝试了这个：

```
int i = 30;
System.out.println(i^3); 
```

结果是：

> 29

这是什么 ？谢谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-05T15:53:39.837

这是 Xor -[排他的按位或](http://en.wikipedia.org/wiki/Bitwise_operation#XOR).

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-05T15:58:41.437

`^`它是一个异或运算符（XOR）。它实际上是按位求和 % 2。

```
11110 (30)
00011 (3)
----------
11101 (29) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-05T15:54:02.753

`^`在 Java 中是[XOR 运算符](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/operators.html)

XOR 代表按位异或。IE：

`0 XOR 0 = 0`

`0 XOR 1 = 1`

如果位不同（独占），则输出为 1，否则为 0。

所以按照你的例子：

`11110 XOR 00011 = 11101 = 29`

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-03-05T15:54:20.593

它被称为[**按位异或运算符**](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/opsummary.html)

# android - XAPKFile 无法解析为类型

> ID：15228237
> 
> 赞同：2
> 
> 时间：2013-03-05T15:52:48.367
> 
> 标签：android

当我尝试将 APK 扩展功能添加到我当前的应用程序时，我遇到了那个烦人的编译错误。“XAPKFile 无法解析为类型”。

[这](http://developer.android.com/google/play/expansion-files.html)是我用来将 APK 扩展文件添加到我的项目中的指南。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T15:57:32.903

我已经用了几个小时，直到我通过谷歌找到了一个地方，有人定义了这个：

```
private static class XAPKFile {
        public final boolean mIsMain;
        public final int mFileVersion;
        public final long mFileSize;

        XAPKFile(boolean isMain, int fileVersion, long fileSize) {
            mIsMain = isMain;
            mFileVersion = fileVersion;
            mFileSize = fileSize;
        }
} 
```

所以，如果你遇到同样的错误，你唯一需要检查的是你是否定义了这个类。Android 不提供它。这可能是因为您可能不想将 FileSize 放在代码中......或者只是因为有一个错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-13T09:54:31.053

**您可以在 extras 项目的SampleDownloaderActivity**中找到这个类，其中还包括一个非常有用的 APK 扩展文件实现示例。如果您下载了**Google Play 扩展库**（[通过 SDK 管理器](http://i.stack.imgur.com/ZjFH9.png)），您可以在以下位置找到它：

*YourPathToAndroidSdk/extras/google/play_apk_expansion/downloader_library*

为方便起见，我将此类与 XAPKFile 的 xAPKS 数组一起复制粘贴到此处（在扩展库的 v3 中可以找到）：

```
/**
 * This is a little helper class that demonstrates simple testing of an
 * Expansion APK file delivered by Market. You may not wish to hard-code
 * things such as file lengths into your executable... and you may wish to
 * turn this code off during application development.
 */

private static class XAPKFile {
    public final boolean mIsMain;
    public final int mFileVersion;
    public final long mFileSize;

    XAPKFile(boolean isMain, int fileVersion, long fileSize) {
        mIsMain = isMain;
        mFileVersion = fileVersion;
        mFileSize = fileSize;
    }
}

/**
 * Here is where you place the data that the validator will use to determine
 * if the file was delivered correctly. This is encoded in the source code
 * so the application can easily determine whether the file has been
 * properly delivered without having to talk to the server. If the
 * application is using LVL for licensing, it may make sense to eliminate
 * these checks and to just rely on the server.
 */
private static final XAPKFile[] xAPKS = {
        new XAPKFile(
                true, // true signifies a main file
                3, // the version of the APK that the file was uploaded
                   // against
                687801613L // the length of the file in bytes
        ),
        new XAPKFile(
                false, // false signifies a patch file
                4, // the version of the APK that the patch file was uploaded
                   // against
                512860L // the length of the patch file in bytes
        )            
}; 
```

# web-services - 在 JBoss AS 7 OSGi 容器中创建 Web 服务

> ID：15228240
> 
> 赞同：0
> 
> 时间：2013-03-05T15:52:50.600
> 
> 标签：web-services, osgi, jboss7.x

我对 OSGi（和 JBoss）还很陌生，所以如果我遗漏了文档中的某些内容，请原谅我 - 我已经搜索了一天左右。

我正在尝试创建托管在 JBoss OSGi 容器中的 Web 服务。目标是能够命中`http://localhost:8080/getStuff`和接收 JSON 对象。这在 OSGi 中可能吗？如果是这样，这在 JBoss7 的 OSGi 容器中是否可能？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T13:37:26.940

绝对有可能 - 我怀疑通过谷歌搜索“OSGi webservice example”会比包含“JBoss ...”找到更好的结果，同时搜索实现示例（[Jersey](http://jersey.java.net)、[CXF](http://cxf.apache.org/)等）。

您可以创建一个 WAB，它本质上只是一个带有 OSGi 元数据的 WAR，它导入依赖项而不是将它们嵌入到 WEB-INF/lib 中。JBoss 使用[PaxWeb](http://team.ops4j.org/wiki/display/paxweb/Pax+Web)来提供 WAB/WAR 支持（它包装了一个 Jetty 实例）。

像[Jersey](http://jersey.java.net)和[CXF](http://cxf.apache.org/)这样的项目声明它们在 OSGi 上工作，因此除了您的服务之外，从 web 容器的角度来看，它与 Java EE 环境中的 web 服务相同。

JBoss 特定示例：[https](https://docs.jboss.org/author/display/JBOSGI/Provided+Examples) ://docs.jboss.org/author/display/JBOSGI/Provided+Examples （虽然没有看到 WS 示例）。

# sass - 生成精灵时添加前导斜线的指南针

> ID：15228243
> 
> 赞同：0
> 
> 时间：2013-03-05T15:52:55.407
> 
> 标签：sass, compass-sass

我刚刚用指南针生成了一个精灵，但由于某种原因，它在生成的类 url 中添加了一个前导斜杠。是否可以覆盖它或者我的 config.rb 有什么问题？

谢谢你的帮助。

乔

配置.rb >

```
http_path = "/"
css_dir = "/"
sass_dir = "/"
images_dir = "img"
javascripts_dir = "js" 
```

萨斯>

```
@import "spr/*.png";
@include all-spr-sprites; 
```

生成的 CSS >

```
.spr-sprite, .spr-female, .spr-male {
  background: url('/img/spr-s88dfc99cac.png') no-repeat;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T16:14:28.600

抱歉，我一发布问题，就在这里找到了另一个问题的答案...

[制作精灵时，指南针在图像前面投掷正斜线](https://stackoverflow.com/questions/10769179/compass-throwing-in-forward-slash-in-front-of-images-when-making-sprites?rq=1)

回答：

默认情况下，指南针对所有资产使用绝对路径。

要更改此行为，请将此行添加到您的 config.rb：

```
relative_assets = true 
```

否则，您还可以更改“http_path”选项以指向您的项目站点在部署服务器上的位置。

# couchbase - Couchbase 在 Asp.net 中不起作用

> ID：15228250
> 
> 赞同：0
> 
> 时间：2013-03-05T15:53:04.273
> 
> 标签：couchbase

我在安装了 Service Pack 1 的 Windows Server 2008 R2 上安装了 Cachebase Server，默认设置。

现在，我正在尝试测试服务器，但无法正常工作。这就是我所拥有的：

```
class Program
{
    static void Main(string[] args)
    {
        var config = new CouchbaseClientConfiguration();
        config.Urls.Add(new Uri("http://192.168.1.4:8091/pools/default"));
        config.Bucket = "default";
        var client = new CouchbaseClient(config);

        // this line of code takes about 10-15 seconds to execute, and always returns false
        bool result = client.Store(StoreMode.Set, "key_10", "value to save", TimeSpan.FromMinutes(5));

        // this line of code always returns null
        var savedValue = client.Get("key_10");
    }
} 
```

我做错了什么？我认为它与防火墙没有任何关系，因为当我在浏览器中访问 url 时，它会返回一个 Json 对象。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T15:55:53.533

我相信您想`/default`从网址中删除 。

尝试`config.Urls.Add(new Uri("http://192.168.1.4:8091/pools"));`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T21:17:07.713

Are you running the app on the server or another machine? You are mentioning the Firewall so I guess you have ensured the correct ports are opened as described [here](http://www.couchbase.com/docs/couchbase-manual-2.0/couchbase-bestpractice-secondfirewall.html)

The reason why I'm asking is because I do think there's a handshake being done using HTTP and then it changes protocol. If that is the case, you might need the other ports to be opened if you access it from another computer.

# android - GridView 在 MDPI 中适合屏幕，但不适合 HDPI 和 XHDPI

> ID：15228252
> 
> 赞同：0
> 
> 时间：2013-03-05T15:53:04.957
> 
> 标签：android, android-layout, android-gridview

网格视图图像不适合 hdpi 和 xhdpi。它适合 mdpi 模拟器和设备。我的图像尺寸如下（它遵循 3:4:6:8 的比例）。

ldpi 366*225 mdpi 488*300 //它适合模拟器和设备屏幕 hdpi 732*450 Xhdpi 976*600

第一个图像（MDPI）正确适合屏幕，第二个图像（XHDPI 与 HDPI 相同）不适合？

![MDPI](../Images/bc6c55f50580e97c9fee3b496b6fb043.png)

![XHDPI](../Images/3e00d3763239578787f025b4b280ab26.png)

**菜单活动：**

```
GridView gridView = (GridView) findViewById(R.id.gridview);

    gridView.setAdapter(new ImageAdapter(this));

    gridView.setOnTouchListener(new OnTouchListener(){
        @Override
        public boolean onTouch(View v, MotionEvent event) {
            if(event.getAction() == MotionEvent.ACTION_MOVE){
                return true;
            }
            return false;
        }
    });

    gridView.setScrollBarStyle(View.SCROLLBARS_INSIDE_OVERLAY); 
    gridView.setVerticalScrollBarEnabled(false); 
```

**ImageAdapter.java：**

```
public class ImageAdapter extends BaseAdapter {

    private Context mcontext;

    public ImageAdapter(Context c) {
        mcontext=c;
    }

    public int getCount() {
        return mThumbIds.length;
    }

    public Object getItem(int position) {
        return null;
    }

    public long getItemId(int position) {
        return 0;
    }

    public View getView(int position, View convertView, ViewGroup parent) {

        ImageView imageView ;

        if(convertView==null)
        {
            imageView = new ImageView(mcontext);
            //imageView.inflate(mcontext, R.layout.mainmenu_griditem,null);
            ImageView.inflate(mcontext, R.layout.mainmenu_griditem,null);

            WindowManager wm = (WindowManager) mcontext.getSystemService(Context.WINDOW_SERVICE);

            Display display = wm.getDefaultDisplay();
            DisplayMetrics outMetrics = new DisplayMetrics ();
            display.getMetrics(outMetrics);

            float density  = mcontext.getResources().getDisplayMetrics().density;

            Log.i("image","density->"+density);
            float dpHeight = outMetrics.heightPixels / density;
            Log.i("image","dpHeight->"+dpHeight);
            float dpWidth  = outMetrics.widthPixels / density;
            Log.i("image","dpWidth->"+dpWidth);

            int width=(int) (dpWidth/2);
            int height=(int) (dpHeight/2.3);

            Log.i("image","Image Width->"+width);
            Log.i("image","Image height->"+height);

            //int width=(int) (dpWidth);
            //int height=(int) (dpHeight);

            //imageView.setLayoutParams(new GridView.LayoutParams(width,height));

            imageView.setLayoutParams(new GridView.LayoutParams(width,height));

            //imageView.setLayoutParams(new GridView.LayoutParams(parent.getWidth()/2,parent.getHeight()/2));

            //imageView.setLayoutParams(new GridView.LayoutParams(imageView.getWidth(),imageView.getHeight()));

            //imageView.setBackgroundColor(000000);
            //imageView.setLayoutParams(new GridView.LayoutParams(400,200));
            //imageView.setLayoutParams(new GridView.LayoutParams());
            imageView.setScaleType(ImageView.ScaleType.FIT_XY);
            //imageView.setScaleType(ImageView.ScaleType.CENTER_CROP);
            //imageView.setPadding(40,40,40,40);
        }
        else
        {
            imageView=(ImageView)convertView;
        }

        imageView.setImageResource(mThumbIds[position]);
        return imageView;
    }

    // references to our images
    private Integer[] mThumbIds = {
            R.drawable.mainmenu1, R.drawable.mainmenu2,
            R.drawable.mainmenu3, R.drawable.mainmenu4
    };
} 
```

我尝试了很多但没有帮助。

**mainmenugriditem.xml：**

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

    <ImageView android:id="@+id/mm_grid_image"
        android:layout_width="match_parent"
        android:layout_height="match_parent"

       />
    <TextView android:id="@+id/mm_grid_text"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:labelFor="@id/mm_grid_image"/>

</RelativeLayout> 
```

**MDPI 的 Logcat 输出：（Emulator-7" WSVGA-tablet-1024*600:mdpi）**

![Logcat-MDPI](../Images/b62385d74032ffc77548862f3498d4cb.png)

**XHDPI 的 Logcat 输出：（Emulator-Galaxy Nexus-4.65"-720*1280:xhdpi）**

![Logcat-XHDPI](../Images/fda279bd7045a6da416fffdf4ff0afb7.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T04:13:38.207

嗨，如果不是这样创建的话，您是否为不同的屏幕尺寸创建了单独的文件夹

**布局-小**

**大版面**

**布局-xlarge**

因此，您将布局 XML 文件复制到这些文件夹中，并在 Palette 窗口中检查 Xhdpi 的预览，默认屏幕尺寸为 10"，以便您可以在布局中调整网格视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T01:46:25.407

我为 MDPI 分辨率设计了位图（因为 MDPI 中 1 px=1 dp）。[然后使用http://labs.skinkers.com/content/android_dp_px_calculator/](http://labs.skinkers.com/content/android_dp_px_calculator/)转换为其他分辨率桶

修改以下代码：

**改变这个：**

```
 Log.i("image","density->"+density);
                float dpHeight = outMetrics.heightPixels / density;
                Log.i("image","dpHeight->"+dpHeight);
                float dpWidth  = outMetrics.widthPixels / density;
                Log.i("image","dpWidth->"+dpWidth); 
```

**至 ：**

```
 float dpHeight = outMetrics.heightPixels;
            float dpWidth  = outMetrics.widthPixels; 
```

# python - 字典的总和值

> ID：15228257
> 
> 赞同：0
> 
> 时间：2013-03-05T15:53:15.743
> 
> 标签：python, dictionary, sum, scipy

我正在尝试对具有类 int 值的字典切片的值求和。

这是我的代码：

```
from scipy.stats import poisson

inventories = 4 # states
mu = 1 # value for lambda
prob = []
for i in range(inventories):
     prob.append(poisson.pmf(i, mu))

Transitions = {}
for i in range(inventories):
    for j in range(inventories-1,-1,-1):
        if i - j < 0:
            Transitions[0,i,j] = 0
        elif j <> 0:
            Transitions[0,i,j] = prob[i-j]
        elif j == 0:
            Transitions[0,i,j] = 1 
```

如果你运行它，我试图让最后一行代码对每个 i 的所有 j 求和。我是一名 MATLAB 编码员，所以我习惯了矩阵，我认为这让我很困惑。任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T16:27:26.267

您可以使用列表推导对字典进行切片：

```
>>> l=[v for (k,v) in Transitions.iteritems() if k[1] == 3]
>>> sum(l)
1.9196986029286058 
```

这给出了 i = 3 对 j 的总和。要对 i 求和，请替换`k[1]`为`k[2]`。

总而言之，像这样的列表理解非常快，尽管我不能说它们在 scipy 矩阵中的排名如何。

你也可以花哨：

```
>>> l=[sum([v for (k,v) in Transitions.iteritems() if k[1] == i]) for i in range(1,4,1)]
>>> l
[1.3678794411714423, 1.7357588823428847, 1.9196986029286058] 
```

这为您提供了每一行的总和。

* * *

所以以上是基于我对问题的误解。对不起，OP :(

我认为您想用以下内容替换该行：

```
Transitions[0,i,j] = sum([Transitions[0,i,k] for k in range(1,i+1,1)]) 
```

# mongodb - 在这里拔头发... MongoDB 查询

> ID：15228260
> 
> 赞同：0
> 
> 时间：2013-03-05T15:53:34.083
> 
> 标签：mongodb, querying

简单查询不适用于我的 mongodb 数据库。

当我在控制台中运行时

```
db.quads.find({}); 
```

我得到了“quads”集合中的所有文档，其中之一是：

```
{ "subject" : "u:http://dbpedia.org/resource/Tim_Berners-Lee", "predicate" : "u:http://dbpedia.org/ontology/abstract", "object" : "l:\"Sir Timothy John Berners-Lee KBE, OM, FRS (TimBL ou TBL) é um físico britânico, cientista da computação e professor do MIT. É o criador da World Wide Web, tendo feito a primeira proposta para sua criação em março de 1989\. Em 25 de dezembro de 1990, com a ajuda de Robert Cailliau e um jovem estudante do CERN, implementou a primeira comunicação bem-sucedida entre um cliente HTTP e o servidor através da internet. Berners-Lee é o diretor do World Wide Web Consortium (W3C), que supervisiona o desenvolvimento continuado da web. Também é o fundador da Fundação World Wide Web e é um pesquisador sênior e titular e fundador da cadeira de 3Com no Laboratório de Inteligência Artificial e Ciência da Computação do MIT (CSAIL). É um diretor da The Web Science Research Initiative (WSRI) e um membro do conselho consultivo do Centro de Inteligência Coletiva do MIT. Em abril de 2009, foi eleito como membro da Academia Nacional de Ciências dos Estados Unidos, sediada em Washington, D.C. Em 2004, Timothy venceu o Millennium Technology Prize, o que lhe rendeu um milhão de euros.\"@pt", "graph" : "u:http://example.org/people", "_id" : ObjectId("5134aa893fff1d490400009c") } 
```

人们会期望运行这样的查询......

```
db.quads.find({"subject" : "u:http://dbpedia.org/resource/Tim_Berners-Lee"}); 
```

...我会得到至少一个文档，因为有一个带有“主题”字段的文档，其值为“u: [http://dbpedia.org/resource/Tim_Berners-Lee](http://dbpedia.org/resource/Tim_Berners-Lee) ”。

但我什么也没得到......我也尝试了通配符查询：

```
db.quads.find({"subject" : "/.*Tim_Berners-Lee.*/"}); 
```

无济于事......我做错了什么？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-27T20:18:01.773

我能够使用这两种方法获得预期的结果：

db.quads.find({"subject" : /.*Tim_Berners-Lee.*/}); 和 db.quads.find({"subject" : "u: [http://dbpedia.org/resource/Tim_Berners-Lee](http://dbpedia.org/resource/Tim_Berners-Lee) "});

也许您正面临一些 shell windows 编码问题，请按照您所说的列出所有文档，并确保输出作为 find 命令的输入值。如果可能，请尝试从另一台机器连接，或者如果您使用的是 windows，请尝试 cygwin，或者尝试从 linux 机器连接。

问候， 莫西

# java - 使用 Apache 的秒表收集指标，需要澄清

> ID：15228263
> 
> 赞同：0
> 
> 时间：2013-03-05T15:53:42.740
> 
> 标签：java, performance, stopwatch

请考虑以下代码段：

```
 StopWatch stopWatch = new StopWatch();
    stopWatch.start();

    Thread.sleep(1000);  //< ---- event 1

    stopWatch.split();

    Thread.sleep(2000);  //< ---- event 2

    stopWatch.split();

    Thread.sleep(3000);  //< ---- event 3

    System.out.println(stopWatch.getStartTime());
    System.out.println(stopWatch.getSplitTime());
    System.out.println(stopWatch.toString());
    System.out.println(stopWatch.toSplitString()); 
```

似乎使用`StopWatch`我可以将单个事件分解为许多子事件，但即便如此，我如何收集这些信息？例如，查看上面的代码，是否可以识别出有 3 个事件，第一个耗时 1 秒，第二个耗时 2 秒，第三个耗时 3 秒？

请告诉我。

如果秒表不是一种方法，是否有一个现有的库可以用于这样的事情？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T16:09:19.670

getSplitTime() 方法返回最新的分割时间。您应该在相关拆分后调用它。

但是，我会使用新的 stopWatch 来测量每个事件（最好使用一个专用方法），这样您就不必减去持续时间来获得每个事件的时间。

# oauth-2.0 - 错误 100 此授权码已被使用

> ID：15228267
> 
> 赞同：2
> 
> 时间：2013-03-05T15:53:50.943
> 
> 标签：oauth-2.0, facebook-authentication, facebook-access-token, facebook-authorization

我有一个简单的登录按钮，可引导用户：

[https://graph.facebook.com/oauth/authorize?client_id=APP_ID&redirect_uri=CALLBACK_URL&type=web_server&scope=publish_stream,offline_access,email,friends_likes,user_likes](https://graph.facebook.com/oauth/authorize?client_id=APP_ID&redirect_uri=CALLBACK_URL&type=web_server&scope=publish_stream,offline_access,email,friends_likes,user_likes)。

回调请求处理程序`CALLBACK_URL`获取`code`参数并将其传递给：

[https://graph.facebook.com/oauth/access_token?client_id=APP_ID&client_secret=APP_SECRET&code=CODE&redirect_uri=REQUEST_URL](https://graph.facebook.com/oauth/access_token?client_id=APP_ID&client_secret=APP_SECRET&code=CODE&redirect_uri=REQUEST_URL)

并期望包含访问令牌的响应（请注意，这`REQUEST_URL`是来自 Facebook 的传入重定向的 URL）。这在 99% 的情况下都会成功，但偶尔我会得到这个：

`{"error":{"message":"This authorization code has been used.", "type": "OAuthException","code": 100}}`.

我知道该代码只能使用一次，有效期为 10 分钟，但我们会立即兑换代码，并且我们的日志记录表明我们只发送一次它以获得访问令牌。

有没有其他人见过这个？

Facebook是否有可能发回错误的错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-29T18:55:45.677

在受保护的函数中`parseSignedRequest($signed_request`）在返回之前添加这些行

```
/*
 * This method sets new code, and does not update persistent data,
 * that leads to persistent data loss and duplicate call to oAuth.
 * Duplicate call to oAuth with same auth code leads to error.
 * So persistent data must be changed alongside code changes.
 */
$this->setPersistentData('code', $data['code']); 
```

**这是一个临时解决方案，我不是 Facebook 开发人员。**

# c - 数组返回类型

> ID：15228270
> 
> 赞同：-4
> 
> 时间：2013-03-05T15:53:57.777
> 
> 标签：c

```
#include<stdio.h>
#include<string.h>
#define MAX 30

void push(char );

char stack[MAX];
int tos=0;

int main(){
    char str[]="Arijit Saha";
    char *final;
    final=(char *)rev(str);
    printf("%s",final);
    rev(str);
    getch();
    return 1;
}

char* rev(char s[]){
    int i;
    for(i=0;i<strlen(s);i++)
        push(s[i]);
    char reverse[strlen(s)];

    for(i=0;i<strlen(s);i++)
        reverse[i]=pop();

    return reverse;

}

void push(char c){
    stack[tos]=c;
    tos++;
}
int pop(){
    tos--;
    return stack[tos+1];

} 
```

这些是错误消息..

```
Compiler: Default compiler
    Executing  gcc.exe...
    gcc.exe "C:\TC\BIN\stringrevusingstack.c" -o "C:\TC\BIN\stringrevusingstack.exe"   -g3  -I"C:\TC\INCLUDE"  -I"C:\Dev-Cpp\include"  -I"C:\Program Files\ImageMagick-6.7.4-Q16\include"   -L"C:\Dev-Cpp\lib" -L"C:\TC\LIB" -L"C:\Program Files\ImageMagick-6.7.4-Q16\lib" -g3 
    C:\TC\BIN\stringrevusingstack.c:20: error: conflicting types for 'rev'
    C:\TC\BIN\stringrevusingstack.c:14: error: previous implicit declaration of 'rev' was here

    C:\TC\BIN\stringrevusingstack.c: In function `rev':
    C:\TC\BIN\stringrevusingstack.c:28: warning: function returns address of local variable

    Execution terminated 
```

怎么了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T15:58:26.017

`c:14: error: previous implicit declaration of 'rev' was here`

您的错误是因为您`rev()`在`main()`. 要么将你的函数移到 main 之上，要么添加一个原型。

`c28: warning: function returns address of local variable`

你的警告是因为你试图返回一个局部变量的地址，你不能这样做。当您离开函数时，局部变量超出范围，因此您需要执行其他操作（例如通过添加`malloc()`/`free()`调用使用动态数组）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T16:02:16.660

在这段代码中：

```
char* rev(char s[]) {
    char reverse[strlen(s)];
    ...
    return reverse;
} 
```

`reverse`是一个具有自动存储持续时间的临时数组，一旦执行离开此函数的范围，就会被释放。您返回一个成为*悬空指针的指针*。
尝试访问该指针指向的内存会产生**未定义的行为**。

除了您应该使用 动态分配它之外`malloc`，请注意`strlen`返回字符串的长度，您还需要用于终止字符 ( `'\0'`) 的空间。你应该`reverse`这样创建：

```
char* reverse = malloc(strlen(s) + 1); 
```

并且不要忘记分配`'\0'`给`reverse`. 也不要忘记该函数的调用者负责释放已分配的内存`malloc`，即调用者应该调用`free`返回的指针。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T15:57:13.610

`char reverse[strlen(s)];`在堆栈上。函数完成后，它现在无效，但您正在返回它的地址。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-05T15:57:18.520

调用函数中不再存在具有*自动存储持续时间的变量。*访问它会导致未定义的行为（任何事情都可能发生）。在这里，您`reverse`从中返回`rev`，这是一个局部变量。

而是动态分配内存：

```
int *reverse = malloc(strlen(s)); /* + 1 for '\0' character ? */ 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-05T15:59:00.197

reverse 是一个本地数组。它在函数退出时被销毁，但您返回指向其内容的指针。理想情况下，您应该通过函数将数据加载到其中的参数来返回数组，即

```
void MyFuncReturnsArray(int* myArr, int n)
{
   for(int i = 0; i < n; ++i)
      myArr[i] = i;
} 
```

代替

```
int* MyFuncReturnsArray()
{
     int myArr[10];
     for(int i = 0; i < 10; ++i)
        myArr[i] = i;
     return myArr

} 
```

# ruby-on-rails - Ruby 中的多重继承……从多个控制器类继承。

> ID：15228271
> 
> 赞同：1
> 
> 时间：2013-03-05T15:53:58.790
> 
> 标签：ruby-on-rails, ruby, multiple-inheritance

我有一个 Rails 应用程序。我的所有控制器都继承自 a`BaseController`继承自`ApplicationController::Base`This 用于将我的部分组织到单独的命名空间中。它工作得很好。

这是问题所在。

我正在尝试使用 Devise gem，但`Devise::SessionsController`找不到我的部分，这些部分存储在名为 Base 的文件夹中。我的解决方案是创建一个继承自`Devise::SessionsController`这样的本地控制器：

```
module Account
  class SessionsController < Devise::SessionsController
  end
end 
```

问题是这个本地`SessionsController`仍然需要从我的继承，`BaseController`所以它可以找到我的部分。说得通？

基本控制器代码：

```
module Account
  class BaseController < ApplicationController
  end
end 
```

应用控制器代码：

```
class ApplicationController < ActionController::Base
  protect_from_forgery

end 
```

我一直在阅读有关 mixins 的文章，但看不到如何使用 mixins 来解决这个问题，因为我没有任何方法可以从类中导入......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T18:09:16.693

解决这个问题的方法很简单，就是让你的局部路径更加明确。因此，在我的示例中，在我的应用程序布局文件中，我更改了部分路径：

```
<%= render "menu" %> 
```

对此：

```
<%= render "account/base/menu" %> 
```

这是有效的，因为 rails 在常规位置查找部分，但找不到它并引发错误。在将部分放入 HTML 时准确指定可以找到部分的位置可以解决 Rails 或任何宝石不知道您的部分在哪里的问题。

# c# - 什么会导致 UDP 套接字上的 ConnectionReset？

> ID：15228272
> 
> 赞同：2
> 
> 时间：2013-03-05T15:54:00.357
> 
> 标签：c#, sockets, rtsp, rtp

我正在尝试使用托管媒体聚合 C# 库 ( [http://net7mma.codeplex.com](http://net7mma.codeplex.com) ) 来处理来自 Freebox 机顶盒的 RTSP/RTP 流。

尽管该库可以与示例 RTSP 提要一起正常工作，但在使用来自我的机顶盒的提要时，RTP 侦听器套接字（一个简单的 UDP 套接字侦听特定端口上的每个收入）抛出 SocketException：ConnectionReset，当然没有数据在接收时显示（数据显示在 Wireshark 中）。

通过 SocketIO 技巧抑制 E_CONNRESET 并没有太大作用，仍然没有数据进入套接字。

什么会导致这种行为？

（如有必要，我可以提供来源或 Wireshark 跟踪）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-05T19:12:55.367

[微软解释](http://msdn.microsoft.com/en-us/library/windows/desktop/bb736550%28v=vs.85%29.aspx)SIO_UDP_CONNRESET的真正含义：

> SIO_UDP_CONNRESET（操作码设置：I，T==3）
> 
> ```
> Windows XP:  Controls whether UDP PORT_UNREACHABLE messages are reported.
> - Set to TRUE to enable reporting.
> - Set to FALSE to disable reporting. 
> ```

问题实际上**不是连接重置**而是**可达性**。

[MSDN 解释](http://msdn.microsoft.com/en-us/library/windows/desktop/ms740120%28v=vs.85%29.aspx)错误 WSAECONNRESET：

> WSAECONNRESET
> 
> 虚电路被远程端执行硬或异常关闭复位。应用程序应该关闭套接字；它不再可用。**在 UDP 数据报套接字上，此错误表明先前的*发送*操作导致 ICMP 端口不可达消息**。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T16:10:22.813

我是net7mma的作者。

我非常感谢您在尝试解决此问题方面的帮助。

WinSock 或 Windows 网络堆栈的其他部分可能存在错误。我很想知道这是否发生在 Mono Also 上。

但是，根据与 OP 的一些对话，这似乎发生的原因是 Freebox 在端口上发送数据包，该端口与描述请求中指示的端口不同。

当我有机会在我的项目页面上发布一些关于这个的信息时，我想确保人们搜索这个和 Freebox 得到最好的信息。

在`RtpClient -> RecieveData`

改变 ：

```
received = socket.Receive(m_Buffer, received, Math.Min(socket.Available,  m_Buffer.Length), SocketFlags.None, out error); 
```

至

```
var tc = GetContextBySocketHandle(socket.Handle);
EndPoint fbRtp = new IPEndPoint(tc.RemoteRtp.Address, 0);//Any port
received = socket.ReceiveFrom(m_Buffer, SocketFlags.None, ref fbRtp); 
```

这应该允许您的套接字在任何端口上接收，因为 stb 没有正确报告 rtp 或 rtcp 端口，如果您有超过 1 个客户端并且您决定使用此代码，请小心，因为您可能会无意中接收来自另一个流的数据包或即使您只使用单个客户端，同一流的 Rtcp 端口也可能无意中在此接收中偷偷发送数据包。

如果可行，最好的做法是从 RtspClient 和 RtpClient 派生并制作一个可以优雅地处理此问题的 FreeboxRtspClient 和 FreeboxRtpClient。

如果有人可以找到盒子在不同端口上发送数据包的原因的押韵，我很乐意在当前实现中进行更改，因此不需要推导。

附在这里： http: [//net7mma.codeplex.com/workitem/16024](http://net7mma.codeplex.com/workitem/16024)

您可以找到显示整个对话的 Pcap 捕获。

-杰伊

# sql - SQL Group BY，每个组的前 N 个项目

> ID：15228273
> 
> 赞同：11
> 
> 时间：2013-03-05T15:54:01.337
> 
> 标签：sql, sql-server

我有一个 SQL 查询，它可以在给定的商店中获得前 5 名售出的商品。

```
SELECT TOP 5 S.UPCCode, SUM(TotalDollarSales) FROM Sales S
WHERE S.StoreId = 1
GROUP BY S.UPCCode
ORDER BY SUM(S.TotalDollarSales) desc 
```

销售表有 -> UPCCode、SaleDate、StoreId、TotalDollarSales

我正在寻找一个查询，它将在单个查询中返回每个商店销售的前 5 件商品。我可以编写多个查询并使用联合，但它似乎效率不高。

如何在单个查询中获得每家商店的前 5 件销售商品。

提前致谢。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-03-05T15:58:28.270

```
;WITH s AS 
(
  SELECT StoreID, UPCCode, tds, rn = ROW_NUMBER()
  OVER (PARTITION BY StoreID ORDER BY tds DESC)
  FROM 
  (
    SELECT StoreID, UPCCode, tds = SUM(TotalDollarSales)
    FROM Sales
    GROUP BY StoreID, UPCCode
  ) AS s2
)
SELECT StoreID, UPCCode, TotalDollarSales = tds
FROM s
WHERE rn <= 5
ORDER BY StoreID, TotalDollarSales DESC; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-05T15:58:07.583

尝试这个：

```
select ss.StoreId,is.*
from (select distinct StoreId from Sales) ss
cross apply (SELECT TOP 5 S.UPCCode, SUM(TotalDollarSales) as SumTotalDollarSales FROM Sales S
             WHERE S.StoreId = ss.StoreId
             GROUP BY S.UPCCode
             ORDER BY SUM(S.TotalDollarSales) desc) is 
```

# iphone - dispatch_async 没有被调用

> ID：15228277
> 
> 赞同：1
> 
> 时间：2013-03-05T15:54:13.897
> 
> 标签：iphone, ios, cocoa-touch

我在将 JSON 数据存储到单个对象的数组中时遇到问题。似乎问题出在处理 JSON 请求的 dispatch_asynch 的执行中。当我在方法之前创建一个断点而不是单步执行应用程序时，它似乎只是通过发送到 dispatch_async 的块。

```
dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);
dispatch_async(queue, ^{
    NSError *error = nil;
    NSURL *url = [NSURL URLWithString:@"http://sleepy-dusk-3603.herokuapp.com/companies.json"];
    NSString *json = [NSString stringWithContentsOfURL:url
                                              encoding:NSASCIIStringEncoding
                                                 error:&error];
    NSLog(@"\nJSON: %@ \n Error: %@", json, error);

    if(!error) {
        NSData *jsonData = [json dataUsingEncoding:NSASCIIStringEncoding];
        NSDictionary *jsonDict = [NSJSONSerialization JSONObjectWithData:jsonData
                                                                 options:kNilOptions
                                                                   error:&error];
        NSArray *tempArray = [NSArray arrayWithObjects:@"Call Support Desk", @"Call Genius Bar", nil];

        for (NSString *name in [jsonDict valueForKeyPath:@"name"]) {
            NSString *tempString = [[NSString alloc] initWithString:name];
            Company *company = [[Company alloc] initWithName:tempString available_actions:tempArray];
            [self addCompany:company]; 
```

我非常感谢大家在这个问题上的帮助和支持。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T16:23:51.180

```
 if(!error) {
...
      }
else
{
    NSLog(@"%@",[error localizedDescription]);
} 
```

记录错误并找出发生了什么

我尝试过的这段代码运行良好

```
dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);
dispatch_async(queue, ^{
    NSError *error = nil;
    NSURL *url = [NSURL URLWithString:@"http://sleepy-dusk-3603.herokuapp.com/companies.json"];
    NSString *json = [NSString stringWithContentsOfURL:url
                                              encoding:NSASCIIStringEncoding
                                                 error:&error];
    NSLog(@"\nJSON: %@ \n Error: %@", json, error);

    if(!error) {
        NSData *jsonData = [json dataUsingEncoding:NSASCIIStringEncoding];
        NSDictionary *jsonDict = [NSJSONSerialization JSONObjectWithData:jsonData
                                                                 options:kNilOptions
                                                                   error:&error];
        NSArray *tempArray = [NSArray arrayWithObjects:@"Call Support Desk", @"Call Genius Bar", nil];

        for (NSString *name in [jsonDict valueForKeyPath:@"name"]) {
            NSString *tempString = [[NSString alloc] initWithString:name];
            NSLog(@"%@",tempString);
        }
    }
}); 
```

回复

```
2013-03-05 22:02:44.312 newTrial[4711:12303] 
JSON: [{"created_at":"2013-03-04T00:09:06Z","id":1,"name":"Apple","updated_at":"2013-03-04T00:09:06Z","actions":[{"created_at":"2013-03-04T00:09:07Z","id":1,"name":"Call Support Desk","updated_at":"2013-03-04T00:09:07Z"},{"created_at":"2013-03-04T00:09:07Z","id":2,"name":"Call Genius Bar","updated_at":"2013-03-04T00:09:07Z"}]},{"created_at":"2013-03-04T02:01:49Z","id":2,"name":"Comcast","updated_at":"2013-03-04T02:01:49Z","actions":[{"created_at":"2013-03-04T02:01:49Z","id":3,"name":"Account Services","updated_at":"2013-03-04T02:01:49Z"}]}] 
 Error: (null)
2013-03-05 22:02:51.766 newTrial[4711:12303] Apple 
```

所以我对问题的假设是您将值存储到数组的位置。检查它是否正确初始化问题可能在这里

```
Company *company = [[Company alloc] initWithName:tempString available_actions:tempArray];
[self addCompany:company]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T16:44:27.973

它对我来说就像一个魅力：

```
dispatch_queue_t _queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);
dispatch_async(_queue, ^{
    NSError *_error = nil;
    NSURL *_url = [NSURL URLWithString:@"http://sleepy-dusk-3603.herokuapp.com/companies.json"];
    NSData *_json = [NSData dataWithContentsOfURL:_url];
    if (_json) {
         id _response = [NSJSONSerialization JSONObjectWithData:_json options:kNilOptions error:&_error];
         if (!_error) {
            // do whatever you want to do here...
         } else {
            NSLog(@"%@", _response);
         }
    }
}); 
```

* * *

回应是：

```
(
        {
        actions =         (
                        {
                "created_at" = "2013-03-04T00:09:07Z";
                id = 1;
                name = "Call Support Desk";
                "updated_at" = "2013-03-04T00:09:07Z";
            },
                        {
                "created_at" = "2013-03-04T00:09:07Z";
                id = 2;
                name = "Call Genius Bar";
                "updated_at" = "2013-03-04T00:09:07Z";
            }
        );
        "created_at" = "2013-03-04T00:09:06Z";
        id = 1;
        name = Apple;
        "updated_at" = "2013-03-04T00:09:06Z";
    },
        {
        actions =         (
                        {
                "created_at" = "2013-03-04T02:01:49Z";
                id = 3;
                name = "Account Services";
                "updated_at" = "2013-03-04T02:01:49Z";
            }
        );
        "created_at" = "2013-03-04T02:01:49Z";
        id = 2;
        name = Comcast;
        "updated_at" = "2013-03-04T02:01:49Z";
    }
) 
```

# visual-studio - 如何使用来自 NuGet 的 nUnit.Runners

> ID：15228280
> 
> 赞同：22
> 
> 时间：2013-03-05T15:54:19.740
> 
> 标签：visual-studio, nunit, nuget

我只是尝试使用 nuGet 安装 nUnit 测试运行器，但我看不到如何执行测试运行器。当我安装包时，它似乎在运行，当我尝试从 nuget 控制台安装时，它表明包已经安装——但我没有看到任何跑步者的迹象。

如果重要的话，我会在 UAC 上运行，并且我不会以管理员身份运行 VS。

注意：我确实通过安装 nUnit MSI 来实现这一点，并且我确实开始使用 VS 2012 插件。但是，nuget 包不起作用，这让我很烦恼。所以，在学术上，我想知道我错过了什么。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-03-05T16:49:14.367

NUnit 测试运行器实际上直接集成到现有的 Visual Studio 测试运行器（测试资源管理器）中（从菜单：`Test`-> `Windows`-> `Test Explorer`）。因此，它不会出现在任何地方。只需将 NUnit 测试添加到您的项目中，它们现在就会神奇地出现在测试资源管理器中，并在您点击`>`按钮时运行。

您需要使用[Visual Studio 库](http://visualstudiogallery.msdn.microsoft.com/6ab922d0-21c0-4f06-ab5f-4ecd1fe7175d)或`Tools`->`Extensions and Updates`菜单中的测试运行程序，而不是 NuGet 包。原因是 Test Runner 安装到 Visual Studio 中（而不是安装到您的项目中）。

正如@Jan 提到的，现在有一个`NUnit.Runners`包，您也可以将其添加到您的解决方案中。这应该为命令行构建添加 NUnit 运行程序，但这不会将 NUnit VisualStudio 测试运行程序注册到 Visual Studio。NUnit Runners 允许您从命令行 (msbuild) 运行测试。您还可以通过使用`vstest.console.exe`Visual Studio 目录中的 运行测试来完成此操作：`C:\Program Files (x86)\Microsoft Visual Studio 12.0\Common7\IDE\CommonExtensions\Microsoft\TestWindow`.

## 更新

随着对 Visual Studio 2013 的更新，Microsoft 允许将测试运行程序作为[NuGet 包附加到项目](https://www.nuget.org/packages/NUnitTestAdapter/)中。这样，它们会自动与您的项目保持同步，并且可以设置为自动更新。也不需要在构建服务器上安装测试运行器。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-06-19T02:01:35.683

当您使用 NuGet Pacakage Manager 安装 NUnit.Runners 包时，它会在 下创建并填充 NUnit.Runners 文件夹`[SolutionDir]\packages`，但该文件夹不会在项目构建时自动更新或恢复，因为安装程序不会将 NUnitRunners 条目放入项目中的`packages.config`文件。

如果您希望包在构建时自动恢复，您可以将缺少的行添加到`packages.config`：

```
<?xml version="1.0" encoding="utf-8"?>
<packages>
  <package id="NUnit" version="2.6.2" targetFramework="net45" />
  <package id="NUnit.Runners" version="2.6.2" targetFramework="net45" />
</packages> 
```

我不确定这是否有任何缺点，但似乎有效！

# java - Hbase 0.94.xxx 和 Jetty 8.xxx

> ID：15228287
> 
> 赞同：1
> 
> 时间：2013-03-05T15:54:34.833
> 
> 标签：java, jetty, hbase, slf4j, nosuchmethoderror

首先，我是 HBase 和 Jetty 8 的新手。

我一直试图让 Hbase 0.94.xx 和嵌入式 Jetty 8.x 一起玩得很好。

我从 Lars 那里获取了示例代码并将 Hush 更新为使用 0.94。这是我所做的 HBase 0.94 更新。 [https://github.com/yepher/hbase-book/blob/master/hush/pom.xml](https://github.com/yepher/hbase-book/blob/master/hush/pom.xml)当我将 Jetty 版本从“7.3.1.v20110307”更改为“8.1.4.v20120524”时。通过更改导入可以轻松解决“凭据”的编译错误。Hush 服务器将正常启动，但最终我得到了这个异常：

```
Exception in thread "main" java.lang.NoSuchMethodError:
org.slf4j.spi.LocationAwareLogger.log(Lorg/slf4j/Marker;Ljava/lang/String;ILjava/lang/String;[Ljava/lang/Object;Ljava/lang/Throwable;)V
    at
org.eclipse.jetty.util.log.JettyAwareLogger.log(JettyAwareLogger.java:601)
    at
org.eclipse.jetty.util.log.JettyAwareLogger.warn(JettyAwareLogger.java:425)
    at org.eclipse.jetty.util.log.Slf4jLog.warn(Slf4jLog.java:64)   at
org.eclipse.jetty.util.component.AbstractLifeCycle.setFailed(AbstractLifeCycle.java:199)
    at
org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:69)
    at com.hbasebook.hush.HushMain.main(HushMain.java:112) 
```

这是 maven 的“包含 sl4j”的输出

```
[hush (master)]$ mvn dependency:tree -Dincludes=org.slf4j
Unable to find a $JAVA_HOME at "/usr", continuing with system-provided Java...
[INFO] Scanning for projects...
Downloading: http://repo1.maven.org/maven2/org/mortbay/jetty/jetty-maven-plugin/8.1.4.v20120524/jetty-maven-plugin-8.1.4.v20120524.pom
Downloaded: http://repo1.maven.org/maven2/org/mortbay/jetty/jetty-maven-plugin/8.1.4.v20120524/jetty-maven-plugin-8.1.4.v20120524.pom (7 KB at 14.5 KB/sec)
Downloading: http://repo1.maven.org/maven2/org/mortbay/jetty/jetty-integration-project/8.1.4.v20120524/jetty-integration-project-8.1.4.v20120524.pom
Downloaded: http://repo1.maven.org/maven2/org/mortbay/jetty/jetty-integration-project/8.1.4.v20120524/jetty-integration-project-8.1.4.v20120524.pom (12 KB at 298.1 KB/sec)
Downloading: http://repo1.maven.org/maven2/org/mortbay/jetty/jetty-maven-plugin/8.1.4.v20120524/jetty-maven-plugin-8.1.4.v20120524.jar
Downloaded: http://repo1.maven.org/maven2/org/mortbay/jetty/jetty-maven-plugin/8.1.4.v20120524/jetty-maven-plugin-8.1.4.v20120524.jar (70 KB at 758.4 KB/sec)
[INFO]                                                                         
[INFO] ------------------------------------------------------------------------
[INFO] Building HBase URL Shortener 1.0
[INFO] ------------------------------------------------------------------------
[INFO] 
[INFO] --- maven-dependency-plugin:2.1:tree (default-cli) @ hush ---
[INFO] com.hbasebook:hush:war:1.0
[INFO] \- org.apache.hbase:hbase:jar:0.94.3:compile
[INFO]    +- org.slf4j:slf4j-api:jar:1.4.3:compile
[INFO]    \- org.slf4j:slf4j-log4j12:jar:1.4.3:compile
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 2.987s
[INFO] Finished at: Tue Mar 05 09:51:40 CST 2013
[INFO] Final Memory: 8M/81M
[INFO] ------------------------------------------------------------------------ 
```

我尝试了很多东西，比如排除 SL4J，明确包括 SL4j。我确定我错过了一些简单但不太确定它是什么的东西。

作为另一个参考点，我尝试了这个项目[https://github.com/steveliles/jetty-embedded-spring-mvc-noxml/blob/master/pom.xml](https://github.com/steveliles/jetty-embedded-spring-mvc-noxml/blob/master/pom.xml)但是当我将 HBase/core 添加到 pom.xml 我开​​始得到与上述相同的问题。

有人有适用于 Jetty 8.x 和 HBase 0.94.xx 的 pom.xml 吗？

编辑：

我添加了更多 slf4j 排除项，然后明确包含 slf4j

```
<dependency>
    <groupId>org.slf4j</groupId>
    <artifactId>slf4j-log4j12</artifactId>
    <version>1.6.4</version>                        
</dependency> 
```

我在这里用工作代码更新了 Huch 项目：[https ://github.com/yepher/hbase-book](https://github.com/yepher/hbase-book)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T16:18:48.860

当您的类路径中有多个`LocationAwareLogger`具有不同版本的类时，会引发此异常。您可以简单地`grep -R LocationAwareLogger *.jar`在您的 lib 目录中执行 a 并找出包含该类的 jar。然后你可以将它排除在你的`pom.xml`.

编辑：我已经下载了你的 repo 并将它安装在我的机器上。运行`grep`命令后，我得到以下输出：

```
eric@localhost:hbase-book$ grep -R 'org/slf4j/spi/LocationAwareLogger' hush/target/hush/WEB-INF/lib/*.jar
Binary file hush/target/hush/WEB-INF/lib/slf4j-api-1.6.4.jar matches
eric@localhost:hbase-book$ grep -R 'org/slf4j/LoggerFactory' hush/target/hush/WEB-INF/lib/*.jar
Binary file hush/target/hush/WEB-INF/lib/slf4j-api-1.6.4.jar matches 
```

看起来您没有`slf4j`完全排除使用错误的`groupId`/`artifactId`组合。您需要更新您的 pom 并再次测试。

注意jetty中包含的日志库版本可能与hbase冲突，没有通用的解决方案，你需要弄清楚使用哪个版本并排除另一个。

# javascript - 将图像序列绑定到滚动事件

> ID：15228291
> 
> 赞同：4
> 
> 时间：2013-03-05T15:54:45.807
> 
> 标签：javascript, jquery, animation, scroll

我有一个`div`里面有一些堆叠的图像。滚动事件应该控制显示的图像。所以我不想在用户滚动时启动动画，我想根据滚动位置更改图片。

我真的很难解决这个问题，但我的想法是计算图像，获取页面的高度，然后将图像的数量除以页面的高度。这样我就可以为框架定义“区域”——但我不知道这是否可行。

这种技术有什么最佳实践吗？它是如何工作的？

这是我到目前为止的代码 - 非常简单：http: [//jsfiddle.net/mxQd8/1/](http://jsfiddle.net/mxQd8/1/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T20:00:14.357

我无法将鼠标滚轮插件上传到小提琴，所以我无法直接演示。你想要的代码是这样的：

```
$(document).ready(function () {
    var container = $('#container'),
    // # of pictures
        nImg = 0;    // active picture
        imgNum = $('#container img').length;

    container.mousewheel(function(event, delta, deltaX, deltaY) {
        if(deltaY>0){
             nImg++;   
        }else{
             nImg--;   
        }
        if(nImg>=imgNum){ nImg = 0; }
        if(nImg<0){ nImg = imgNum-1; }

        $(".animated").each(function(){ $(this).removeClass("show") });
        $(".animated").eq(nImg).addClass("show");
    });
}); 
```

基本上，您只需要测试滚动上的 deltaY 是负数还是正数（向上滚动或向下滚动）。基于此，您将显示下一个或上一个图像。

这将非常快速地滚动 - 您可能需要创建一个`setTimeout`以将滚动锁定 250/500 毫秒，具体取决于您希望动画运行的速度。它也会循环——如果你不想让它循环，你必须写一些不同的东西。我必须参加一个会议，但我希望这能让你开始 - 如果我能做任何其他事情来帮助我，请告诉我！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T19:19:36.420

我已经为这个问题编写了一个 jQuery 插件：看看[jQuery Transe](http://github.com/yckart/jquery.transe.js)。

# ruby-on-rails - 盆景服务器宕机了怎么办？

> ID：15228293
> 
> 赞同：1
> 
> 时间：2013-03-05T15:54:53.047
> 
> 标签：ruby-on-rails, ruby, heroku, elasticsearch, tire

我正在将 ElasticSearch 与 Tire 一起使用，并将我的应用程序托管在 Heroku 上。

昨晚，当盆景服务器关闭时，我的整个应用程序崩溃了。当我尝试将应用程序部署到 Heroku 时，Tire 尝试连接并创建索引，并抛出错误，因此我不得不将我的`Tire`代码从所有模型移动到`unless`语句中：

```
unless ENV['ES_DISABLED'] 
  # Elastic Search
  #
  include Tire::Model::Search
  include Tire::Model::Callbacks
  index_name INDEX_NAME

  tire.mapping do
    indexes :id, :type => 'string', :index => :not_analyzed
    indexes :content, analyzer: 'snowball', boost: 100
  end
end 
```

当然，我将`ES_DISABLED`常量设置为`true`Heroku。

我想为将来类似的错误做好准备。有没有更好的方法来避免它们？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T18:44:17.993

嗯，这很奇怪。当模型不存在时，Tire 确实会尝试为模型创建索引，但它不会关闭应用程序。

请注意，我能够做到这一点：

```
$ ps aux | grep java
121:karmi           7197   0.0  0.0  2432768    472 s003  R+    7:37PM   0:00.00 grep java

$ bundle exec rails console
Loading development environment (Rails 3.2.11)
Article
Skipping index creation, cannot connect to Elasticsearch
(The original exception was: #<Errno::ECONNREFUSED: Connection refused - connect(2)>)
=> Article(id: integer, title: string, content: text, author: string, published_on: date, created_at: datetime, updated_at: datetime)
Article.search '*'
Errno::ECONNREFUSED: Connection refused - connect(2)
    from /Users/karmi/.rbenv/versions/1.9.3-p0/lib/ruby/1.9.1/net/http.rb:762:in `initialize'
  ...
    from /Users/karmi/Playground/ElasticSearch/Tire/tire/lib/tire/search.rb:35:in `results' 
```

您**不应该**将您的 etc 定义包装`mapping`在 begin/rescue 中——相反，您应该`rescue_from`在应用程序代码中使用一种或其他方式来通知用户搜索功能不起作用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T06:23:55.097

尼克和 Bonsai.io 在这里。对于影响您的应用程序的中断，我深表歉意。你可以在我们的博客上找到我的[完整验尸报告。](http://go.bonsai.io/W3YXOz)

除非我弄错了，否则我相信`tire.mapping`在 Rails 评估和加载模型类时，Tire 会在运行方法调用时尝试创建索引。

看起来这种情况在[问题 #180](https://github.com/karmi/tire/issues/180)和[提交 (0df58dce)](https://github.com/karmi/tire/commit/0df58dce35335e4dae2ffb07a5e2cf9a3e99c863)问题中得到了部分解决`ECONNREFUSED`，但这不包括来自与较大集群断开连接的节点的 503 错误响应，就像我们的集群所经历的那样。

也许这会对 Tire 提出一个很好的拉取请求，以便在测试索引存在或以其他方式尝试创建索引和映射时类似地挽救 50 倍错误？

或者，您也可以将`tire.mapping`呼叫包装`begin/rescue`在您的最后。

# java - 连接到安装在 AIX 机器中的 DB2 服务器时出现 IO 错误

> ID：15228295
> 
> 赞同：0
> 
> 时间：2013-03-05T15:55:02.037
> 
> 标签：java, jdbc

当我尝试使用连接池对象在 DB2 中执行查询时，我遇到了严重的问题。我的应用程序部署在 WebSphere 7 中并位于 AIX 机器上，而 DB2 正在运行另一个 AIX 机器。问题是间歇性的。当我搜索`server.log`文件时，我得到了以下异常捕获。

```
java.net.SocketException: There is no process to read data written to a pipe. at 
java.net.SocketOutputStream.socketWrite0(Native Method) at 
java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:103) at 
java.net.SocketOutputStream.write(SocketOutputStream.java:147) at 
com.ibm.db2.jcc.t4.fb.b(fb.java:1685) at 
com.ibm.db2.jcc.t4.fb.a(fb.java:1633) at 
com.ibm.db2.jcc.t4.a.D(a.java:416) at 
com.ibm.db2.jcc.t4.a.r(a.java:380) at 
com.ibm.db2.jcc.am.n.a(n.java:219) at
com.ibm.db2.jcc.am.go.b(go.java:4302) at 
com.ibm.db2.jcc.am.go.fc(go.java:741) at 
com.ibm.db2.jcc.am.go.executeQuery(go.java:711) 
```

但是如果我尝试创建一个连接对象，则不会出现上述问题，只有现有连接池对象存在问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T17:37:43.887

在分析连接对象后，我已经修复了它。基本上有时连接池对象会出现问题，连接对象不会关闭，但系统 IO 可能会导致上述问题。要解决此问题，只需使用 JDBC Api connection.isValid(0) 验证连接。如果您将值提供为 o ，则表示没有指定执行超时，基本上上述方法验证连接管道是否按预期工作。如果它返回 true 则没有问题，我们可以使用返回 false 的相同对象，然后编写适当的逻辑来创建连接对象。

# android - 在选项卡式 ActionBar 上的片段之间导航

> ID：15228300
> 
> 赞同：2
> 
> 时间：2013-03-05T15:55:10.070
> 
> 标签：android, android-fragments, nested, android-actionbar, android-tabs

据我环顾四周，我没有为我的代码想出好的最终解决方案。我正在尝试实现类似这样的布局：

动作栏

```
 ----Tab 1 ---Fragment 1 - Fragment 2
 ----Tab 2 ---Fragment 3 - Fragment 4
 ----Tab 3 ---Fragment 5 - Fragment 6 
```

我的问题是，当我从 Fragment 1 访问 Fragment 2 时，可能会发生两件事，具体取决于实现。A）来自片段 1 的内容仍在屏幕上。B）当我从 Fragment 2 访问 Tab 2 时，Fragment 2 中的内容仍然可见，当我再次按下 Tab1 时，Tab2 中的内容仍在屏幕上。

我知道这可能不完全有意义，但我尝试过嵌套片段实现和一些自定义 backstack 实现，但我无法理解如何做到这一点。

更准确地说，我无法从 Fragment 2 正确“返回”到 Fragment 1。我无法从 Fragment 2 切换到 Tab2，然后再返回 Tab1（Fragment1）。

谁能帮我？具有三个简单片段（没有内部片段）的操作栏的实现完美地工作。

以下是我之前的一些输入：

*   [https://github.com/commonsguy/cw-omnibus/blob/master/ViewPager/Fragments/src/com/commonsware/android/pager/EditorFragment.java](https://github.com/commonsguy/cw-omnibus/blob/master/ViewPager/Fragments/src/com/commonsware/android/pager/EditorFragment.java)
*   [如何在片段中导航？](https://stackoverflow.com/questions/10025171/how-to-navigate-in-fragments)
*   [在选项卡内切换片段](https://stackoverflow.com/questions/10502786/switching-fragments-within-tab)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T17:28:01.357

我正在寻找一个类似的例子，发现android SDK中有一个很好的例子，叫做Honeycomb Gallery。我认为它在 SDK 3.0+ API 示例中。您可以使用您的 SDK 管理器下载该软件包，然后您可以创建一个示例项目并选择 Honeycomb Gallery（假设您使用的是 eclipse）。

# django - django admin：如何自定义字段集中的一个字段？

> ID：15228301
> 
> 赞同：8
> 
> 时间：2013-03-05T15:55:12.693
> 
> 标签：django, admin, fieldset

我尝试在 django admin 的字段集中制作一个字段以仅显示某些数据，但根据[django 文档](https://docs.djangoproject.com/en/dev/ref/contrib/admin/#django.contrib.admin.ModelAdmin.list_display)，仅显示一个示例`list_display`可以自定义。我尝试了类似的方法，`fieldsets`如下所示：

在模型.py 中：

```
def ports_with_same_scanner(self):
    return PortList.objects.filter(scanner=self.scanner)
ports_with_same_scanner.short_description = 'port_lists' 
```

在 admin.py 中，这不起作用：

```
fieldsets = (
            ('Scan Template', { 
            'fields': ( ('name', 'scanner', 'ports_with_same_scanner',), 'comment', ('in_use',
                'fc_growing', 'nc_growing'), 'nvt_prefs')
            }),
) 
```

但是，如果我这样做：

```
list_display = ('name', 'scanner', 'ports_with_same_scanner', 'comment', 'in_use', 'fc_growing', 'nc_growing', 'nvt_prefs') 
```

`ports_with_same_scanner`作品很好。问题是我不想将显示从 更改`fieldsets`为`list_display`，我想知道如何实现相同的功能。谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2016-04-20T07:46:41.073

我不知道过去是否真的有问题......我总是使用简单的方法 - 将方法名称添加到`readonly_fields = ()`

例子：

**`models.py`**

```
class My(models.Model):

    def custom_name(self):
        return 'test'
    custom_name.allow_tags = False
    custom_name.short_description = 'custom_name' 
```

**`admin.py`**

```
class MyAdmin(admin.ModelAdmin):
    fieldsets = (
            (None, {
                    'fields': ('custom_name', )
            }),
    )
    readonly_fields = ('custom_name', ) 
```

它必须工作 Django >=1.7 似乎该方法可以应用于早期版本的 Django^ 但我没有测试

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-05T17:30:11.713

在模型级别应用过滤器会起作用吗？如果是这样，您可以使用模型的[.limit_choices_to](https://docs.djangoproject.com/en/1.5/ref/models/fields/#django.db.models.ForeignKey.limit_choices_to)属性`ForeignKeyField`。

或者，您可以覆盖 modelAdmin 类的[formfield_for_foreignkey](https://docs.djangoproject.com/en/1.5/ref/contrib/admin/#django.contrib.admin.ModelAdmin.formfield_for_foreignkey)属性。

就像是 -

```
class YourModelAdmin(admin.ModelAdmin):
    def formfield_for_foreignkey(self, db_field, request, **kwargs):
        if db_field.name == "ports_with_same_scanner":
            kwargs["queryset"] = PortList.objects.filter(scanner=self.scanner)
        return super(YourModelAdmin, self).formfield_for_foreignkey(db_field, request, **kwargs) 
```

（抱歉，如果我误解了这个问题）

# eclipse - 将 Maven Web 应用程序运行到 Tomcat

> ID：15228302
> 
> 赞同：2
> 
> 时间：2013-03-05T15:55:13.317
> 
> 标签：eclipse, maven, tomcat, build, m2eclipse

运行 Web 应用程序时，Tomcat 出现问题。这是我的相关部分`pom.xml`：

```
<build>
<plugins>
    <plugin>
      <groupId>org.apache.tomcat.maven</groupId>
      <artifactId>tomcat7-maven-plugin</artifactId>
      <version>7</version>
    </plugin>
</plugins>
</build> 
```

当我使用**m2eclipse** ( `tomcat:run`) 运行时，出现此错误：

```
[INFO] Scanning for projects...
[WARNING] The POM for org.apache.tomcat.maven:tomcat7-maven-plugin:jar:7 is missing, no dependency information available
[WARNING] Failed to retrieve plugin descriptor for org.apache.tomcat.maven:tomcat7-maven-plugin:7: Plugin org.apache.tomcat.maven:tomcat7-maven-plugin:7 or one of its dependencies could not be resolved: Failed to read artifact descriptor for org.apache.tomcat.maven:tomcat7-maven-plugin:jar:7
[INFO]                                                                         
[INFO] ------------------------------------------------------------------------
[INFO] Building ourtest 0.0.1-SNAPSHOT
[INFO] ------------------------------------------------------------------------
[WARNING] The POM for org.apache.tomcat.maven:tomcat7-maven-plugin:jar:7 is missing, no dependency information available
[WARNING] Failed to retrieve plugin descriptor for org.apache.tomcat.maven:tomcat7-maven-plugin:7: Plugin org.apache.tomcat.maven:tomcat7-maven-plugin:7 or one of its dependencies could not be resolved: Failed to read artifact descriptor for org.apache.tomcat.maven:tomcat7-maven-plugin:jar:7
[INFO] 
[INFO] >>> tomcat-maven-plugin:1.1:run (default-cli) @ ourtest >>>
[INFO] 
[INFO] --- maven-resources-plugin:2.5:resources (default-resources) @ ourtest ---
[debug] execute contextualize
[INFO] Using 'UTF-8' encoding to copy filtered resources.
[INFO] skip non existing resourceDirectory C:\Users\user\Documents\EclipseProjects\ourtest\src\main\resources
[INFO] 
[INFO] --- maven-compiler-plugin:2.3.2:compile (default-compile) @ ourtest ---
[INFO] Compiling 7 source files to C:\Users\user\Documents\EclipseProjects\ourtest\target\classes
[INFO] -------------------------------------------------------------
[ERROR] COMPILATION ERROR : 
[INFO] -------------------------------------------------------------
[ERROR] Unable to locate the Javac Compiler in:
  C:\Program Files\Java\jre7\..\lib\tools.jar
Please ensure you are using JDK 1.4 or above and
not a JRE (the com.sun.tools.javac.Main class is required).
In most cases you can change the location of your Java
installation by setting the JAVA_HOME environment variable.
[INFO] 1 error
[INFO] -------------------------------------------------------------
[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 1.317s
[INFO] Finished at: Tue Mar 05 15:50:20 GMT+01:00 2013
[INFO] Final Memory: 6M/15M
[INFO] ------------------------------------------------------------------------
[ERROR] Failed to execute goal org.apache.maven.plugins:maven-compiler-plugin:2.3.2:compile (default-compile) on project ourtest: Compilation failure
[ERROR] Unable to locate the Javac Compiler in:
[ERROR] C:\Program Files\Java\jre7\..\lib\tools.jar
[ERROR] Please ensure you are using JDK 1.4 or above and
[ERROR] not a JRE (the com.sun.tools.javac.Main class is required).
[ERROR] In most cases you can change the location of your Java
[ERROR] installation by setting the JAVA_HOME environment variable.
[ERROR] -> [Help 1]
[ERROR] 
[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR] 
[ERROR] For more information about the errors and possible solutions, please read the following articles:
[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoFailureException 
```

我测试了很多配置，`pom.xml`但没有结果。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-08-01T22:29:11.403

尝试改变两件事：

1) 更新 tomcat7-maven-plugin 版本为 2.1

2）使用“mvn tomcat7：运行”

指定的版本不存在，您使用的命令将运行旧的 codehaus 插件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T16:49:49.797

请参阅与此问题相关的 M2Eclipse[常见问题解答。](https://docs.sonatype.org/display/M2ECLIPSE/Project+FAQ#ProjectFAQ-UnabletolocatetheJavacCompilerError)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-11T11:36:03.630

要检查您的 JAVA_HOME 环境变量，您需要在命令行 (WIN) 中键入 java --version。这可以告诉你如果你的系统。使用 JDK 或 JRE。您也可以转到 MyComputer -> Properties -> Advanced -> environment variables 并在列表中查看 JAVA_HOME 是什么（我不使用 Win 的英文版，因此名称可能有点不同）。要在 Eclipse 中更改 JRE（我正在使用 Juno），请转到 Project Properies -> Java Build Path -> Libraries Tab -> Add a JDK lib if not present。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-25T21:14:29.013

Maven 可能在 JRE 而不是 JDK 中寻找编译器 确保将类路径设置为 JDK

[找不到 Javac 编译器](https://stackoverflow.com/questions/10812668/unable-to-locate-the-javac-compiler)

# android - android应用转换动画忽略持续时间

> ID：15228303
> 
> 赞同：0
> 
> 时间：2013-03-05T15:55:14.677
> 
> 标签：android, animation

我正在尝试设置一些自定义进度条动画，类似于我在 xCode 中设置的方式。

在 xCode 中，我可以使用块代码来设置这样的动画

```
 [UIView animateWithDuration:3.0
                              delay:0.0f
                            options:UIViewAnimationOptionCurveEaseIn
                         animations:^(void)
         {
             imgView_p.frame = CGRectMake(0, 0, 100, 100);

                         completion:^(BOOL finished)
         {
             //Do something in here

         }]; 
```

因此，我可以获取一个 imageView 并将其框架扩展为我想要的任何内容，它会在我传入的持续时间内为该新框架设置动画。

在Android中我发现了这个

```
Animation a = new Animation()
                    {
                        @Override
                        protected void applyTransformation(float interpolatedTime, Transformation t) 
                        {
                             animateMe.getLayoutParams().height = 300;
                             animateMe.requestLayout();
                        }

                        @Override
                        public boolean willChangeBounds() {
                            return true;
                        }
                    };
                    a.setDuration(3000);
                    animateMe.setAnimation(a); 
```

基本上这是一个垂直条，它将在 3 秒内增加高度。然而它忽略了 setDuration(3000) 并且动画只是立即应用，这真的很烦人。我知道我一定错过了一些东西，但我看不到什么，其他人能指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T16:11:20.653

这是因为您只是在 applyTransformation 方法中设置了视图的最终高度。您应该使用插值时间并进行计算。让我们说

```
(just a random silly way, do as you wish)
float h = currentHeight + interpolatedTime;
animateMe.getLayoutParams().height = (int) h;
animateMe.requestLayout(); 
```

这样，您将在定义的持续时间内增加高度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T15:57:17.460

您正在寻找[`.setStartOffset(3000)`](http://developer.android.com/reference/android/view/animation/Animation.html#setStartOffset%28long%29). 这将在动画开始之前添加 3000 毫秒的延迟。

`startAnimation(a)`您通过调用而不是调用来启动动画`setAnimation(a)`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T09:22:05.960

终于回来了，我设法找到了这个链接

[在 LinearLayout 中更改 LayoutParams 的动画](https://stackoverflow.com/questions/9695981/animation-in-changing-layoutparams-in-linearlayout)

使用他创建的这个家伙动画类，它现在似乎工作得很好。

# charts - Crystal Reports 两年的月度对比图

> ID：15228304
> 
> 赞同：0
> 
> 时间：2013-03-05T15:55:17.937
> 
> 标签：charts, crystal-reports

我们正在使用 Crystal Reports 2011 生成包含多个图表的报告。一个图表特别需要显示两年多的每个月的消耗量 (MBTU)。我们希望将相似的月份并排排列，以便轻松查看月份之间的差异。这是一个模型，展示了我们希望图表的外观。唯一的区别是我们要显示整整十二个月；十月至九月。

![月度消费比较](../Images/a6ff9651b00435107584c28e19af0a2d.png)

我们的数据源结构如下：

```
entity      'the entity we are summarizing
consumption 'raw consumption in MBTU
date        'this is a date field that includes month and year 
```

但是，我们无法让我们的图表以这种方式显示。我们完成的工作如下所示。

![在此处输入图像描述](../Images/fc7ff91bac30900bc610d86345ec79ec.png)

我们没有 2012 年 9 月以后的数据，这就是 2012 年 10 月、11 月、12 月为空白的原因。然而，我们确实有 2011 年 1 月、2 月、3 月的数据，但由于某种原因没有显示。此外，我们希望图表从 10 月开始并一直持续到 9 月。

我们在图表专家中的参数设置为：

更改时：@MonthName 和 @Year（按此顺序） 显示值：消费

关于如何在 Crystal Reports 中实现我们想要的效果有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T19:03:11.003

1.  `we do have data for Jan, Feb, Mar of 2011 but it is not displaying for some reason`
    首先，您应该对此进行调查。您的数据集可能不是您认为的那样。

2.  您可以在数据源和图表之间添加 SQL 层。您可以在 Crystal 本身、数据源等处执行此操作。这取决于您的整个设置。在这个 SQL 层中，您可以进行大量自定义编码，甚至按月交叉表您的数据以显示完全没有数据的月份。但是，一个 Where 子句就足够了，例如`Where date>='20111001' and date <'20121001'`

# blackberry - 访问客户端 WebSQL 数据库

> ID：15228306
> 
> 赞同：0
> 
> 时间：2013-03-05T15:55:21.680
> 
> 标签：blackberry, blackberry-webworks, web-sql

有谁知道任何工具，可以在 BlackBerry 设备或模拟器上访问和查询 WebSQL 数据库？

我有两个问题，如何打开和查看模拟器的本地文件系统dmp文件？（或者是真实设备的内部文件存储。）

那么，一旦您可以访问文件系统，哪些工具可以打开其中的数据库？

对于iOS开发，我一直在下载沙箱，打开包，然后使用MesaSQLite访问数据库。我正在尝试为 BB 做类似的事情，这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T15:12:13.883

对于任何追随我的人...

经过广泛的研究，我发现没有办法做到这一点，而且我很确定你做不到。

但是，在`bbwp`编译时添加`-d`到命令行会启用应用程序中的 Web Inspector，因此您可以使用浏览器会话导航到数据库并查看数据，以及在需要时导航文件系统。

此外，如果您添加`/fs-sdcard /fs-sdcard-root="c:\whatevs-you-want-here"`到模拟器的命令行，您可以外部化 SD 卡文件系统，不幸的是，没有办法对设备的内部文件系统执行相同操作。

# reporting-services - 使用图表系列中的参数值在 SSRS 2008 中进行钻取报告？

> ID：15228312
> 
> 赞同：2
> 
> 时间：2013-03-05T15:55:33.030
> 
> 标签：reporting-services, ssrs-2008

我正在为我的公司创建一个仪表板系统，它由在**Reporting Services 2008**中设计的 Excel、图形和仪表报告组成。

我有一个饼图，其中包含前 5 种最佳产品以及分配给每种产品的被保险方的数量。我想通过单击图表的系列区域（产品描述）来增强这一点，并希望它打开/取消隐藏另一个报告，该报告将进一步显示有关所选产品的更多详细信息。

如何做到这一点？我知道有些表达式可以与 javascript 一起使用，但我不想添加我不完全理解的内容，而且一旦它被签署给客户，我将不会维护这个报告项目。这意味着任何支持这个系统的人都必须具备我用来使报告正常工作的所有技能。

我尝试通过创建主报告，然后添加一个单独的报告，其中包含一个存储产品名称的参数。这是数据的过滤器 从最初的报告中，我可以添加一个操作设置来指示报告导航到我更详细的报告，默认情况下它需要传递所选项目的值。

我的问题是我不确定如何设置我单击的选定系列值，以便将其传递给具有产品价值的另一个报告。我怎样才能达到这个要求？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T16:11:41.140

以下步骤假设您已设置详细报告并使用与主报告上的图表系列值相关的参数值。无论图表类型（饼图、条形图、柱形图等）如何，这都应该有效。

1.  右键单击图表上的系列并选择`Series Properties` ![系列属性](../Images/ed715393e1c25a2c54b4e61c64a33bd8.png)

2.  在`Action`窗格中，选择`Go to Report`，指定详细报告路径和名称，并定义要传递给详细报告的参数名称和值。 ![系列动作](../Images/2c2099bc09b8840ddc39502150701f5c.png)

# r - 将几个数据框单独的列（年、日、年、小时、分钟、秒）转换为 R 中的日期对象/时间戳

> ID：15228324
> 
> 赞同：1
> 
> 时间：2013-03-05T15:56:02.770
> 
> 标签：r, date, dataframe

首先，让我说我一直希望[在单独的列中发布日期和时间，在 R 中转换为日期时间，](https://stackoverflow.com/questions/8896901/dates-and-times-in-separate-columns-convert-to-datetime-in-r)但它不适用于这种情况。

我有一个包含多个测量值的 CSV 文件，从第 1 列到第 5 列，我有以下形式的数据戳：Year、DayOfYear、Hour、Minute、Second。类似这样的 var 名称**dat**：

```
 Year Day Hour Min  Sec. E1.S1 E1.S2 E1.S3 E1.S4 E1.S5 E1.S6 E1.S7 E1.S8 E2.S1 E2.S2 E2.S3 E2.S4 E2.S5
1 2003 241    0   1  5.87 0.296 0.394 0.657 0.427 0.362 0.559 0.460 0.460 0.526 0.362 0.362 0.493 0.460
2 2003 241    0   5 18.52 0.486 0.543 0.572 0.629 0.372 0.457 0.429 0.829 0.486 0.400 0.286 0.543 0.457
3 2003 241    0  10 10.65 0.514 0.629 0.371 0.657 0.457 0.657 0.429 0.429 0.314 0.400 0.286 0.286 0.343
4 2003 241    0  15  2.76 0.575 0.301 0.411 0.630 0.274 0.466 0.466 0.548 0.438 0.329 0.438 0.493 0.301
5 2003 241    0  20  7.06 0.329 0.274 0.657 0.329 0.521 0.247 0.356 0.246 0.411 0.356 0.438 0.520 0.356
6 2003 241    0  25 11.35 0.486 0.314 0.343 0.372 0.314 0.343 0.457 0.343 0.257 0.343 0.229 0.543 0.372 
```

我需要的是在一个时间戳字段中“加入”所有这 5 个日期字段，以便我可以正确绘制数据并在 R 中使用它。

我查看了**ISOdatetime**函数，但我无法让它工作（而且它似乎没有 dayOfYear 字段）。我还查看了**POSIXlt**并尝试了类似的方法：

```
test = within(dat, datetime <- as.POSIXlt(paste(Year, Day, Hour, Min, Sec.),
                                          format = "%Y %D %H %M %S")) 
```

但我得到的只是一个空的日期时间字段附加到我的数据框。

有任何想法吗？

**编辑：**

问题出在 dayOfYear 格式字段句柄中，正如下面帖子中指出的正确答案。我需要使用 %j 而不是 %D ，这足以获得日期时间的列。由于 POSIXlt 似乎只使用整数秒，我更正了秒数：

```
teste = within(dat, datetime <- as.POSIXlt(paste(Year, Day, Hour, Min, round(Sec.)),
                                          format = "%Y %j %H %M %S")) 
```

谢谢你们！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T16:21:12.193

这里是使用`strptime`格式 %j 的解决方案：作为十进制数 (001–366) 的年份。

我假设 dat，是你的 data.frame，首先我粘贴日期列

```
dat$date <- paste(paste(dat$Year,dat$Day,sep='/'),paste(dat$Hour,dat$Min,dat$Sec,sep=':')) 
```

然后我申请`strptime`

```
dat$date <- strptime(dat$date,format ='%Y/%j %H:%M:%S')

dat$date
[1] "2003-08-29 00:01:05" "2003-08-29 00:05:18" "2003-08-29 00:10:10" "2003-08-29 00:15:02" "2003-08-29 00:20:07" "2003-08-29 00:25:11" 
```

PS：这里所有的日期都是同一天

# php - 是否可以通过 php 的 IP 地址将网站用户限制在 50 英里半径范围内

> ID：15228325
> 
> 赞同：1
> 
> 时间：2013-03-05T15:56:02.817
> 
> 标签：php, ip

我想开发一个网站，如果用户在我的客户办公楼半径 50 英里范围内，则该网站会阻止用户访问该网站的某些区域。

是否可以通过查看某人的 IP 地址用 php 可靠地判断某人在哪里？我有一种有趣的感觉，我在某处看到无法通过他们的 IP 确切地知道某人在哪里。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T15:58:29.613

50英里，不。但是，您可以使用地理位置数据库来限制对特定邮政编码集中特定 IP 的访问。您的准确性会有很大差异，如果有人使用代理，即使有这些限制，他们也可以访问您的网站。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T15:58:03.850

> 是否可以通过查看某人的 IP 地址用 php 可靠地判断某人在哪里？

不。

GeoIP 数据库具有可变的精度级别（取决于地址），人们可以使用代理。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T15:59:12.833

不。除非您是他们的 ISP，否则不可能可靠地*使用某人的 IP 地址。*即便如此……我自己的 IP 跟踪到我实际居住地以北 60 英里的位置，所以如果你的办公室就在隔壁，我仍然可以访问你的网站。这还没有考虑代理。

如果您想保护网站的某些部分，请使用密码。这是唯一真正的选择。

# azure - 无法从给定链接下载 .publishsettings

> ID：15228327
> 
> 赞同：0
> 
> 时间：2013-03-05T15:56:22.307
> 
> 标签：azure, dotnetnuke

我想使用 Azure Accelerator Wizard 6.3 for Windows Azure 安装 DDN。我一开始就失败了，因为向导要我提供一个发布设置文件。因为我在本地没有，所以我想在“下载发布设置文件”下载一个，我将访问[https://windows.azure.com/download/publishprofile.aspx](https://windows.azure.com/download/publishprofile.aspx)

当我想点击“这里”时，什么也没有发生。我也不完全明白这个文件应该包括什么，也许我可以自己写？

谢谢，克里斯。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T16:05:29.727

您看过 Windows Azure 网站上的 DotNetNuke 吗？这可能是一个更简单的设置。

至于 publishsettings 文件，在您使用 Microsoft 帐户进行身份验证后，您的浏览器应该会自动提示您下载该文件。.publishsettings 文件包含一个 base64 编码证书，用于管理与您的 Microsoft 帐户关联的所有 Windows Azure 订阅。它还包含所有订阅的列表（名称和订阅 ID）。访问该 URL，除了生成 .publishsettings 文件外，还将在 Windows Azure 中为您的所有订阅创建管理证书。

# node.js - 你如何通过像 Squid 这样的 HTTP 转发代理来使用 node-restify 客户端？

> ID：15228333
> 
> 赞同：0
> 
> 时间：2013-03-05T15:56:45.853
> 
> 标签：node.js, squid, restify

我可以使用 Node.js 通过 Squid 发出 HTTP 请求，并通过一些路径与 URL 处理和标头更改的技巧：

```
var http = require('http');
var host = "lvhubproxy01";

var options = {
  host: host,
  port: 3128,
  path: "http://images.joyent.com/images",
  headers: {
    Host: 'images.joyent.com'
  }
};

var req = http.request(options, function(res) {
  console.dir('STATUS: ' + res.statusCode);
  console.log('HEADERS: ' + JSON.stringify(res.headers));
});

req.end(); 
```

我也想通过 Squid 发送 node-restify 请求，但我找不到任何关于如何执行此操作的指示。

你如何通过像 Squid 这样的 HTTP 转发代理来使用 node-restify 客户端？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-31T16:58:14.730

你可以看看使用这个包装器：[https](https://gist.github.com/jeffwhelpley/5417758) ://gist.github.com/jeffwhelpley/5417758 不是很干净，但也许它可以帮助你。

# iis - iis url-rewrite 文件路径问题

> ID：15228334
> 
> 赞同：1
> 
> 时间：2013-03-05T15:56:57.293
> 
> 标签：iis, url-rewriting

在一个名为**project**的文件夹中，我有一个可以接受参数的 .php 文件。

我正在使用这个规则：

```
<rule name="Friendly" stopProcessing="true">
    <match url="^phrasecat/(.+)$" />
    <conditions>
        <add input="{REQUEST_FILENAME}" matchType="IsFile" negate="true" />
        <add input="{REQUEST_FILENAME}" matchType="IsDirectory" negate="true" />
    </conditions>
    <action type="Rewrite" url="index.php?phrasecat={R:1}" />
</rule> 
```

为了像这样重定向请求：

```
www.domain.com/project/phrasecat/word1 
```

至

```
www.domain.com/project/index.php?phrasecat=word1 
```

这样做是为了获得友好的网址。

它可以工作，但问题是，IIS 认为短语猫是一个真正的目录，因此所有包含的文件（javascript/css/图像）都不会被包含，因为短语猫文件夹不存在，所以一切都是乱码。

有没有办法通过重定向规则解决这个问题？我不想手动创建文件夹并将资源第二次放在那里。

先感谢您

# c# - C# Windows 应用程序中的文件下载功能

> ID：15228335
> 
> 赞同：-4
> 
> 时间：2013-03-05T15:56:57.717
> 
> 标签：c#

我有一个 C# **Windows**应用程序。我需要实现一个功能，将 CSV 模板下载给用户，他/她可以填写和上传。

该文件只需要在解决方案中。

谁能建议我任何解决方案？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T16:01:48.403

如果要从特定网站下载文件，请使用 Webclient 类（添加对 System.Web 的引用）

```
WebClient webClient = new WebClient();
webClient.DownloadFile("http://mysite.com/myfile.csv", @"c:\Temp\myfile.csv"); 
```

# java - 更改外观会更改 JTextPane 的颜色？

> ID：15228336
> 
> 赞同：3
> 
> 时间：2013-03-05T15:56:57.823
> 
> 标签：java, swing, colors, look-and-feel, nimbus

我有`JTextPane`一个不同的背景和前景颜色。现在当 L&F 更改为 Nimbus L&F 时，我`JTextPane`的颜色发生了变化。怎么会？只有这个类有这样的问题。而其他人工作得很好。有什么问题？

这就是我改变 L&F 的方式：

```
for (javax.swing.UIManager.LookAndFeelInfo info : 

javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(PlayBackVoice.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(PlayBackVoice.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(PlayBackVoice.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(PlayBackVoice.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } 
```

另一方面，在设置此 L&F 之前，颜色变化非常好。或者这些陈述运作良好：

```
 jtp.setBackground(Color.BLACK);
     jtp.setForeground(Color.WHITE); 
```

知道有什么问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T16:18:41.027

Swing 组件将它们的外观和感觉委托给`ComponentUI`对象。作为 Swing 的一部分，为每个组件定义了接口：`ButtonUI`它们`JButton`委托给、`LabelUI`for `JLabel`、`TextUI`for`JTextPane`等。

每个 Swing 外观都包含每个接口的实现。例如。`MetalButtonUI`, `MetalLabelUI`, 等等，它们以外观和感觉想要的方式绘制该组件。

当您调用`UIManager.setLookAndFeel`它时，它会在该组实现中进行交换。

一切都非常聪明，但令人讨厌的是，每种外观都不必尊重您的任何前景/背景/边框等设置。

幸运的是，Nimbus 将其所有颜色定义为 UIManager 键。

所以，你可以做这样的事情来覆盖它的默认颜色：

```
UIManager.put("nimbusBase", Color.BLACK); 
```

完整列表请参见此处：

[http://www.ce.unipr.it/people/poggi/teaching/docs/javaSE7.0Tutorial/uiswing/lookandfeel/_nimbusDefaults.html](http://www.ce.unipr.it/people/poggi/teaching/docs/javaSE7.0Tutorial/uiswing/lookandfeel/_nimbusDefaults.html)

**更新**

虽然，这么说来，看起来 Nimbus 玩起来一点都不好！有些人很幸运地用这个覆盖了 Nimbus 颜色：

```
Color bgColor = new Color("99999");
UIDefaults defaults = new UIDefaults();
defaults.put("EditorPane[Enabled].backgroundPainter", bgColor);
jeditorpane.putClientProperty("Nimbus.Overrides", defaults);
jeditorpane.putClientProperty("Nimbus.Overrides.InheritDefaults", true);
jeditorpane.setBackground(bgColor); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-09-25T08:19:57.883

这是对 Spoon 先生更新的轻微更新。其实代码

```
defaults.put("EditorPane[Enabled].backgroundPainter", bgColor); 
```

错误，因为 put 调用的第二个参数应该是实现 Painter 接口的对象。

正确的代码序列（选择 Nimbus LAF）是

```
UIDefaults defaults = UIManager.getLookAndFeelDefaults();
defaults.put("TextPane[Enabled].backgroundPainter", 
    new javax.swing.plaf.nimbus.AbstractRegionPainter() {

        @Override
        protected AbstractRegionPainter.PaintContext getPaintContext() {
            return new AbstractRegionPainter.PaintContext(null, null, false);
        }

        @Override
        protected void doPaint(Graphics2D g, JComponent c, 
                int width, int height, Object[] extendedCacheKeys) {
            g.setColor(bgColor);
            g.fillRect(0, 0, width, height);
        }
    });
jtxtPane.putClientProperty("Nimbus.Overrides", defaults);
jtxtPane.putClientProperty("Nimbus.Overrides.InheritDefaults", false); 
```

# c++ - inotify 不触发文件修改通知

> ID：15228337
> 
> 赞同：7
> 
> 时间：2013-03-05T15:56:59.373
> 
> 标签：c++, linux, filesystems, inotify

我一直在调整[这里](http://www.ibm.com/developerworks/linux/library/l-ubuntu-inotify/index.html)的示例，以使其反复监视文件以进行“修改”。我的代码在[这里](http://pastebin.com/tK83Fx5X)。在我的测试中，inotify 通知仅在文件第一次“修改”（即`touch`“编辑”）时触发。对该文件的任何后续修改都不会导致触发任何通知。`stat`显示“修改”时间已更改。此外，修改代码以删除手表并在每次通知触发时重新添加（即移动`inotify_add_watch`并在我的[示例](http://pastebin.com/tK83Fx5X)`inotify_rm_watch`中的`while(1)`循环内）无助于解决此问题。

我想知道这里是否有人可以帮助解决我可能做错的事情。另外，虽然我添加了一个手表`IN_ALL_EVENTS`，但我真的只关心`IN_MODIFY`事件。不确定这是否有任何区别。

另外，这个用例不起作用吗？我应该改变我的方法来观看目录吗？请指教。

TIA。

编辑 1：如[themel](https://stackoverflow.com/a/15231268/391113)所述，处理`i`需要一些修复。然而，即使是固定版本也不会触发后续文件系统“事件”的通知。此外，在目录而不是文件上添加监视会表现出类似的非确定性行为。

编辑 2：我想根据[这个答案得到这个](https://stackoverflow.com/a/12274214/391113)[asio + inotify 示例](http://pastebin.com/v7HEabjv)。不幸的是，这个例子根本不适合我。任何帮助将非常感激。TIA。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-06T02:21:55.153

在主题修复之后，在我的测试中，您的代码在查看目录时可以正常工作。观看文件时，`event->len`为零，您的代码会忽略通知。

在 printf 语句中`event->len`删除并全部`event->name`替换为的测试后，它在查看文件时也可以正常工作。`file_path`

PS：刚注意到你提到`touch`。

`touch`发送以下事件：

```
IN_OPEN
IN_ATTRIB
IN_CLOSE_WRITE 
```

没有 IN_MODIFY

另外，不要`vim`像我刚才那样通过编辑它来测试修改 - 它会在改组工作副本和交换时删除文件，这会删除手表。`pico`作品。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-05T18:24:59.977

您的处理`i`已损坏，您永远不会在循环中将其重置为 0。这会导致任何后来的 inotify 事件仅在它们比它们之前的最长事件长时才被考虑，这可能不是您想要的。

[固定版本](http://pastebin.com/F1DimeDM)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-12-06T21:25:22.143

监控单个文件时 event->len 将为 0，因为不返回文件名。我注意到很多示例程序都有这个问题。

# oracle - 甲骨文正则表达式

> ID：15228339
> 
> 赞同：-2
> 
> 时间：2013-03-05T15:57:05.627
> 
> 标签：oracle, plsql, plsqldeveloper

我有以下数据字符串，如何使用 oracle 正则表达式单独获取数字最后两个字符始终是“RC”或“RN”。如果找不到数字，则返回 0。

```
1AEABCRC

1AEABC1RC

1AEABC1RN

1AEABC2RN 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T17:23:02.977

```
select 
   nvl(regexp_substr(column_name, '(\d*)(RC|RN)$', 1, 1, null, 1), 0)
from table_name; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T17:02:32.910

你可以尝试这样的事情：

```
select nvl(regexp_replace(regexp_substr(v, '\d+(RC|RN)$'), '(\d+)(RC|RN)$', '\1'), 0)
from t; 
```

[这是一个 sqlfiddle 演示](http://www.sqlfiddle.com/#!4/46a3c/24)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T00:44:26.227

这似乎有效。不知道您是否希望将数字作为数字或愿意将其用作字符，但是：

```
select nvl(substr(regexp_replace('1AEABCRC','^1[A-Z]+'),1,1),to_char(0,'9')) from dual;
select nvl(substr(regexp_replace('1AEABC1RC','^1[A-Z]+'),1,1),to_char(0,'9')) from dual;
select nvl(substr(regexp_replace('1AEABC1RN','^1[A-Z]+'),1,1),to_char(0,'9')) from dual;
select nvl(substr(regexp_replace('1AEABC2RC','^1[A-Z]+'),1,1),to_char(0,'9')) from dual; 
```

当然，您可以用列名或变量等替换字符串文字。显然，如果数字达到两位数，将不起作用。

# javascript - 在 SlideToggle nag 上添加活动类

> ID：15228352
> 
> 赞同：1
> 
> 时间：2013-03-05T15:57:37.040
> 
> 标签：javascript, jquery, submenu, nav

我正在尝试编辑这段代码以在我单击的元素上添加一个“活动”类，并在我单击导航的另一个项目时自动将其删除...

```
 var firstTime = true;
    $("#nav a").click(function() {
    var divname = this.name;
    $(this).addClass( "active", "fast", "easeOutBounce" );
    if (!firstTime) {
        if ($(".slid").hasClass(divname)) {
            firstTime = true;
            $(".slid").removeClass("slid").slideUp();
        } else {

            $(".slid").removeClass('slid').slideUp(500, function() {
                $("." + divname).slideToggle().addClass("slid");

            });
        }
    } else {
        $("." + divname).slideDown().addClass("slid");
        firstTime = false;
    }

}); 
```

我应该在哪里添加 .removeClass("active") 以使这项工作......？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T16:05:24.503

我认为最好的方法是检查它是否处于活动状态，只有在这种情况下，才更改活动元素。

这样，您的解决方案将更加高效。

```
if (this.className.indexOf('active') == -1) {
    //remove class from actual selected
    var selected = $('#nav a.active');
    selected.removeClass( "active").text('');
    // add class here
    $(this).addClass( "active", "fast", "easeOutBounce" );
    $(this).text('active');
} else {
    $(this).removeClass( "active").text('');
} 
```

[在这里](http://jsfiddle.net/markus85/6LHd9/27/)尝试一个有效的例子

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T15:59:22.167

就这样做

```
var firstTime = true;
$("#nav a").click(function() {
var divname = this.name;
//Remove existing 'active' class
$('.active').removeClass('active');
$(this).addClass( "active", "fast", "easeOutBounce" );
[...] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T16:00:08.630

```
var firstTime = true;
    $("#nav a").click(function() {
    var divname = this.name;
    $('#nav a.active').removeClass('active');
    $(this).addClass( "active", "fast", "easeOutBounce" );
    if (!firstTime) {
        if ($(".slid").hasClass(divname)) {
            firstTime = true;
            $(".slid").removeClass("slid").slideUp();
            $('#nav a.active').removeClass('active');
        } else {

            $(".slid").removeClass('slid').slideUp(500, function() {
                $("." + divname).slideToggle().addClass("slid");

            });
        }
    } else {
        $("." + divname).slideDown().addClass("slid");
        firstTime = false;
    }

}); 
```

# javascript - 回调返回 jQuery 对象时 .map() 出错

> ID：15228353
> 
> 赞同：4
> 
> 时间：2013-03-05T15:57:41.333
> 
> 标签：javascript, jquery

[http://jsfiddle.net/mblase75/NfzbA/](http://jsfiddle.net/mblase75/NfzbA/) -- 使用 jQuery 1.9.1

```
var $opts = $('.plant-page').map(function (i, el) {
    return $('<option>');
}).appendTo('#change-page select'); 
```

JavaScript 控制台中的错误说：`Uncaught TypeError: Cannot read property 'ownerDocument' of undefined`

当我切换到 jQuery 1.8.3 时，结果如预期 - 选项元素附加到选择：http: [//jsfiddle.net/mblase75/NfzbA/2/](http://jsfiddle.net/mblase75/NfzbA/2/)

难道我做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T15:57:41.333

在 jQuery 1.9.1 中，如果我重写`.map()`回调函数以返回 DOM 元素而不是 jQuery 对象，它将按预期工作：http: [//jsfiddle.net/mblase75/NfzbA/3/](http://jsfiddle.net/mblase75/NfzbA/3/)

```
var $opts = $('.plant-page').map(function (i, el) {
    return $('<option>').text(this.id)[0];
}).appendTo('#change-page select'); 
```

当我将此作为 jQuery 错误 ( [http://bugs.jquery.com/ticket/13567](http://bugs.jquery.com/ticket/13567) ) 提交时，有人告诉我：

> 分辨率设置为*notabug*
> 
> 您正在尝试附加一个 jQuery 对象内的 jQuery 对象，因为您通过`$.fn.map()`. 这不受支持，但很明显。我们通常不会列出不能在 jQuery 集合中的所有内容，因为做错的可能性是无限的。你的重写看起来更好。

所以：尽管这在 jQuery 1.8 中有效，但它被认为是对预期行为的回归，而不是错误。`.map()`回调应该总是返回 DOM 元素而不是 jQuery 对象。

# php - 在将数据发送到操作链接或人工 POST 请求之前解析数据

> ID：15228355
> 
> 赞同：1
> 
> 时间：2013-03-05T15:57:45.670
> 
> 标签：php, javascript

我有一个表格，它有`action="http://anotherhost.com"`。但是我有一个问题，在将它发送到另一台主机之前，我需要将输入的数据保存到数据库中，这里有一个问题，怎么做？

我有想法，但不知道如何实现。
1）更改`action="http://anotherhost.com"`到我的站点，解析输入的数据并添加到数据库中，但之后我需要模拟对另一台主机的人工 POST 请求。
2）首先用JS（AJAX）解析它，解析后，让表单发送到另一个主机。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T16:22:50.227

您的第二个选择可能是最好的选择，这样的事情应该可以工作！

[http://jsfiddle.net/7Sq3J/](http://jsfiddle.net/7Sq3J/)

```
$('form').submit(function(event) {
    $.post('http://example.net/', $('form').serialize(), function(data){
        // handle returned data in here
    });
}); 
```

这将使用 POST 请求，并将您在表单中发送的所有内容发送到[http://example.net/](http://example.net/)

# c# - 当用户将显示设置为中等 (125%) 时，文本框/表单项被截断

> ID：15228356
> 
> 赞同：1
> 
> 时间：2013-03-05T15:57:48.567
> 
> 标签：c#, vb.net, winforms

我有一个用 VB.net 编写的**Windows 窗体应用程序。**我的用户告诉我，当他们转到“**控制面板”>“显示**”并将“文本大小”设置为中 (125%) 时，表单上的文本框和下拉框会被截断。我已将表单上的**AutoScaleMode**设置为 DPI，但这无济于事。有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-05T16:09:17.843

您可以采取几种不同的方法：

1.  将所有表单和用户控件上的 AutoScaleMode 设置更改为“无”，并确保您的标签等足够长，以便在最常见的 DPI 设置中处理 UI 的文本。例如，测试各种 DPI - 如果它适用于 100%、125% 和 150%，那么您的状态会非常好。

2.  切换到 WPF（说起来容易做起来难）。

3.  尝试让它在 AutoScaleMode 设置为 DPI 的情况下工作——这很难做到——如果你研究这个，你会发现让它正常工作并非易事。

# jquery - 移动设备 - 在 x 时间内没有触发触摸事件

> ID：15228358
> 
> 赞同：1
> 
> 时间：2013-03-05T15:57:52.257
> 
> 标签：jquery, mobile, touch

我正在一个移动网站上工作，如果 10 秒内没有触摸事件，我需要显示幻灯片。我已经尝试了很多东西，但还没有完全做到。

这是我到目前为止的代码：

```
window.setTimeout(function(){
    $('#slideshow').show();
    $('#slideshow').animate({
        opacity:1   
    }, 800);
}, 3000);

$('#slideshow').click(function(){
    //alert('helo');
    $('#slideshow').animate({
        opacity:0   
    }, 800, function(){
        $('#slideshow').hide();
    });

}); 
```

这可行，但我需要在这么多秒的不活动后触发显示和不透明动画。任何人都做过这个并且有一个快速的解决方案。谢谢

**更新代码：**

```
 var waiting = window.setTimeout(function(){
                $('#slideshow').show();
                $('#slideshow').animate({
                    opacity:1   
                }, 800);
            }, 3000);

    var activity = $(window).click();

    $(document).on('activity', function() { 
        clearTimeout(waiting); 
            waiting = window.setTimeout(function(){
                $('#slideshow').show();
                $('#slideshow').animate({
                    opacity:1   
                }, 800);
            }, 3000);
    });

    $('#slideshow').click(function(){
        $('#slideshow').animate({
            opacity:0   
        }, 800, function(){
            $('#slideshow').hide();
        });

    }); 
```

这还不是很有效......最初它确实有效。幻灯片确实会等待 3 秒才会出现，如果有任何活动，幻灯片会持续重置，但幻灯片已经出现然后被删除它不会重新出现...？

任何想法谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T16:01:17.523

定义“活动”，每当触发“活动”时，让它清除 setTimeout，然后再次启动它。

```
var waiting = window.setTimeout(function(){ });
$(document).on('activity', (function() { 
    clearTimeout(waiting); 
    waiting = window.setTimeout(function(){ });
}); 
```

# php - SVN 在 Windows 下的 NetBeans 中进行 PHP 开发？

> ID：15228360
> 
> 赞同：0
> 
> 时间：2013-03-05T15:57:59.200
> 
> 标签：php, svn, netbeans

我在 Windows 下使用 NetBeans 进行 PHP 开发。

现在我手动控制版本（带有日期和时间的简单复制项目目录）。

我觉得我需要更好的东西，可以跟踪变化的东西。

**我想在这里咨询经验丰富的 PHP 开发人员，他们独自工作（不是团队合作）**。

我假设，我需要学习很多关于 SVN、SVN 与 IDE 集成、使用 SVN 等的知识。

我想知道的事情：

*   学习SVN可能需要多少时间，在我的情况下花时间学习是否值得？SVN 并不是那么简单，我担心我需要花费大量时间才能获得生产力的好处。

*   我想知道有多少专业的 PHP 开发人员在使用 SVN，它的效果如何。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T17:43:19.463

SVN 学习起来并不复杂。[这里](http://svnbook.red-bean.com/)的手册是一个很好的免费资源。有许多工具可以使日常开发人员级别的工作变得简单且非侵入性。

如果你以前没有使用过任何版本控制，而且你总是一个人工作，那么你几乎可以选择任何 VCS，无论是 SVN、Git（很多人更喜欢 Git，但说学习曲线有点陡峭比SVN）或任何其他。

重要的是您选择一个系统并使用它。版本控制可以像您想的那样简单，但是如果您的代码对您来说甚至很重要，那么您必须准备好一些东西。

# javascript - JavaScript 兼容的正则表达式不允许零或任何字符？

> ID：15228363
> 
> 赞同：1
> 
> 时间：2013-03-05T15:58:03.747
> 
> 标签：javascript, regex

我需要一个正则表达式来禁止：

```
 0
 0123
 abcd-)(^&%$!"!"£ etc` 
```

允许：

```
1234567890 
```

到目前为止，我有以下内容，但失败了

> `/^[1-9]|[1-9]\d+$/`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T16:00:57.673

试试这个正则表达式

```
/^[1-9][0-9]*$/ 
```

# objective-c - 通过 instantiateViewControllerWithIdentifier 将代码与 Storyboard 中的视图控制器组合

> ID：15228364
> 
> 赞同：2
> 
> 时间：2013-03-05T15:58:04.397
> 
> 标签：objective-c, xcode, storyboard, viewcontroller

我正在学习 Objective-C，遇到了一些对我来说没有意义的东西。

当我们在 Storyboard 中绘制了一个视图控制器 (VC) 时，您可以通过代码调用此 VC，方法是在 Storyboard ID 中输入一个字符串（单击 Storyboard 中的 VC，在 Utilities 侧边栏，Identity Inspector 选项卡，Identity 部分）使用 instantiateViewControllerWithIdentifier方法。

在我的示例中，我在 Storyboard 中绘制了一个独立的 UIViewController，并将 Storyboard ID 设置为“orderList”。在代码中，我可以通过以下代码**Code1**调用此视图：

```
UIViewController *ordersVC = [self.storyboard instantiateViewControllerWithIdentifier:@"orderList"]; 
```

如果我创建一个名为“SCVCOrders”的 UIViewController 的子类，并在其中插入一些代码来修改它的外观 - 比如设置标题或更改背景颜色，我认为我可以使用此代码**Code2**来组合绘制的 VC使用 SCVCOrders 中的代码：

```
SCVCOrders *ordersVC = [self.storyboard instantiateViewControllerWithIdentifier:@"orderList"]; 
```

但它没有将它们结合起来。它只使用情节提要中绘制的内容。所以接下来，在 Storyboard 中，我将绘制的 VC 的类设置为 SCVCOrders。现在**Code2**给了我组合的外观，但**Code1 也是**如此。我由此得出的结论是 Storyboard 优先于实例化代码。Xcode 不在乎我将视图编码为哪个类，它只会查看 Storyboard 来解决这个问题。这个对吗？

我想能够将我的代码叠加在我在 Storyboard 中绘制的内容之上会很有用。使用我的示例，我想将绘制的 VC 保留为泛型类。并使用**Code2**在绘制的 VC 之上分层代码。或者我们还能如何实现这样的目标？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T18:37:02.953

`instantiateViewControllerWithIdentifier`将返回存储在情节提要中的任何类。将此方法返回的类存储在具有不同类类型的指针中不会改变它实际上是什么类型的对象。

也就是说，如果你有一条鱼并称它为老虎，它并不会改变它真的是一条鱼的事实。

# google-maps-api-3 - 使用google map api v3，但地图分成正方形

> ID：15228365
> 
> 赞同：-2
> 
> 时间：2013-03-05T15:58:04.447
> 
> 标签：google-maps-api-3

我正在使用 Google Maps API v3 创建地图。当我在我的网页中使用它时，我看到地图分成了正方形。之前，我在另一个网页中使用该代码并且 ui 运行良好。我找不到问题。

看到这张图片：[http ://uphinh.ssc.vn/images/205Untitled.png](http://uphinh.ssc.vn/images/205Untitled.png)

代码：

```
<div id="infomation" style="height:35%;">
        <div id="map" style="width:66%; height:99.5%; float:left">

        </div>
        <div id="myinfo" style="width:33.4%;height: 99.5%; float:left">
            <p id="mylocation"></p>
            <button id="changeMyLocation" onClick="changeMyLocation()">Change</button>
        </div>
    </div> 
```

我希望有人可以帮助我找到错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T21:36:42.083

我认为您需要检查 #map div {} 的 CSS

您的 div 边界正在传播。我认为可能是

```
#map div div {border:0} 
```

可能会解决您的问题。

编辑总是假设您将地图容器称为 #map 而不是 #map_container 或其他名称。

# c++ - 系统文件检查器

> ID：15228366
> 
> 赞同：0
> 
> 时间：2013-03-05T15:58:04.807
> 
> 标签：c++

我正在使用 API SfcIsFileProtected() 来验证文件是否已集成，即使我手动更改系统文件检查器下的 dll 或只是删除它，这个 API 似乎总是返回 true。

顺便说一句 - 从命令行我得到的答案是违反了这个特定的文件。

这是我正在使用的代码：

```
 BOOL result = SfcIsFileProtected(NULL, fileName);
if (FALSE == result) {
    std::cout << fileName << " is not integrated" << std::endl;
}
else {
    std::cout << fileName << " TRUE TRUE TRUE it is integrated" << std::endl;
}
return result; 
```

关于如何获得在 Windows 7 平台中使用此 API 的可靠答案的任何想法？

# php - 链接到由数组构造的表中的 url

> ID：15228369
> 
> 赞同：0
> 
> 时间：2013-03-05T15:58:10.887
> 
> 标签：php, html

如何从下面的代码中制作 $v->Url 部分：

```
<a href="Url">Link text</a> 
```

所以如果网址很长，我的手机不会“爆炸”？

```
foreach($array as $k=>$v){
    print "
    <tr>      
      <td>" . $v->Status . "</td>
      <td>" . $v->Url . "</td>
    </tr>";
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T16:01:27.993

我假设链接文本存储在成员 var 中`$v`。试试这个：

```
foreach($array as $k=>$v){
    print "
    <tr>
      <td>{$v->Status}</td>
      <td><a href=\"{$v->Url}\">{$v->Text}</a></td>
    </tr>";
} 
```

当然，`$v->Text`如果成员在您的应用程序中具有不同的名称，您将不得不重命名。

# multithreading - Vici 冷却存储附加线程

> ID：15228371
> 
> 赞同：1
> 
> 时间：2013-03-05T15:58:14.420
> 
> 标签：multithreading, mono, xamarin.ios, coolstorage, vici

我有一个相对较小的 iPhone 和 Android 单点触控项目，并计划添加 WP7。我在 SQLite 上使用 vici coolstorage 作为 ORM，它对我来说效果很好，但是有一个问题。它使用 db 为每个线程创建额外的线程。由于应用程序是大规模并行的，我已经达到了线程的限制，所以我想改变它。我发现线程创建是在 CSConfig.cs 中执行的，其中*每次*从不同线程调用 GetDB 都会创建一个新线程：

```
 internal static CSDataProvider GetDB(string strContext)
    {
        if (_threadData == null)
            _threadData = new ThreadData();

        return _threadData.GetDB(strContext);
    } 
```

被`_threadData`标记`[ThreadStatic]`。我想每次我使用 ORM 时都会调用这个 GetDB（我将 CSConfig 中的默认 DB 设置为我的 DB）。线程是在`ThreadData`构造函数内部创建的。线程执行这个函数：

```
 private void CleanupBehind()
        {
            _callingThread.Join();

            foreach (CSDataProvider db in _threadDbMap.Values)
                db.Dispose();
        } 
```

因此，基本上它等待调用者终止，然后处理数据库连接。

问题是，我怎样才能覆盖这种行为，或者让 GC 处理数据库连接，或者`Dispose()`在调用线程终止之前调用自己（我使用 DB 控制所有线程，所以我可以做到）。我知道当线程结束时不让 ORM 处理断开连接是不好的，但是我不能为每个工作线程使用一个额外的线程。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T20:05:44.560

好的，我知道回答自己的问题很糟糕，但仍然如此。也许它可以帮助某人。我已经做了一个解决方法，即在`CSConfig`. 我已经完全删除了线程创建，并在使用数据库的任何线程终止之前调用了清理。因此我没有多余的线程。

它引起了一个问题：我在某些情况下使用强制线程终止，主要是当线程在网络操作中时。因此，有时我必须遍历所有数据库连接并删除任何属于死线程的连接。

但毕竟我的线程数几乎减少了两倍。

# javascript - 如何使用 Flot Charts 制作简单的条形图而不是堆积条形图？

> ID：15228372
> 
> 赞同：1
> 
> 时间：2013-03-05T15:58:16.873
> 
> 标签：javascript, flot, bar-chart

我正在使用 Flot 图表绘制条形图。它工作正常。以下是代码：

```
var d1 = [
            [1,20],
            [2,30],
            [3,15],
            [4,45],
            [5,79]
            ];

                $.plot($("#mychart"), [d1], {
                grid: {
                        show: true,
                        clickable: true, 
                        hoverable: true

                },
                    series: {
                        stack: 0,

                        bars: {
                            show: true,
                            barWidth: 0.6,
                            fill: 0.6,
                            align:'center'
                        }
                    },

                colors: ["#F4A70C"]

                }); 
```

我的数据是从服务器动态获取的。即使这样也很好。问题是我正在使用以下命令来重绘图表：

```
 flot.setData(data);
            flot.setupGrid();
            flot.draw(); 
```

我得到的输出是一个堆积条形图。我希望每次都呈现一个新的条形图。我设置了stack=0，但这似乎没有任何影响。请指导我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T17:38:28.117

堆栈插件将 null、undefined 和 false 以外的值视为 true。所以用'false'替换你的零，你应该没问题。

# dictionary - J2ME 离线字典应用

> ID：15228375
> 
> 赞同：0
> 
> 时间：2013-03-05T15:58:24.003
> 
> 标签：dictionary, java-me

我想开发一个 j2me 字典应用程序。我可以使用文本文件来存储字典单词而不是使用 rms 吗？

如何根据用户的需要检索单词？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T16:13:13.230

您可以使用文本文件，但我认为该解决方案不能很好地扩展并且搜索速度会很慢。文本文件解决方案的最佳情况是，您将按字母顺序对其进行排序，然后您必须搜索您要查找的单词。听起来慢得令人痛苦。RMS 听起来是更好的解决方案

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T16:13:41.170

您可以将数据存储在文件中是的。如何在J2ME中读取文件内容之前已经有问答，请看：

*   [在 J2ME 中从文件中读取内容](https://stackoverflow.com/questions/8473382/reading-content-from-file-in-j2me)
*   [读取 j2me 中的文件内容](https://stackoverflow.com/questions/6069879/read-file-contents-in-j2me)，
*   [在 J2ME 中读取文本文件](https://stackoverflow.com/questions/739691/reading-text-file-in-j2me)
*   [如何在 j2me 中读取/写入文本文件](https://stackoverflow.com/questions/5204373/how-to-read-write-text-file-in-j2me)

从性能的角度来看，使用 RMS 系统可能会更好，每次需要单词时打开和解析文件可能效率不高。

然而，使用这些文件作为将信息获取到设备上的方式似乎是合理的（而不是在安装 midlet 之后下载该数据）。

# javascript - 检测设备颜色

> ID：15228382
> 
> 赞同：6
> 
> 时间：2013-03-05T15:58:38.213
> 
> 标签：javascript, ios

我不知道网络应用程序中是否有可供 javascript 访问的元数据，以判断 iPhone 具有哪种颜色。基本上我想做的是检测 iPhone 的颜色，然后使用与颜色相关的样式表。

![在此处输入图像描述](../Images/26dd6d9b0026e7e89b179ef85dd4a6d5.png)

**编辑**忘记了这个问题。

有没有办法检测 iDevice 的颜色？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T16:01:01.133

型号是这样做的方法，例如：

> **MD381** - 黑色 iPhone 4S
> **MC920** - 白色 iPhone 4S

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T16:03:04.027

[这个关于 iOS 的类似问题](https://stackoverflow.com/questions/8463212/detecting-color-of-iphone-ipod-touch)的公认答案（截至 2012 年初）说不，你无法检测 iPhone 或 iPod Touch 的颜色。有一些关于通过序列号识别设备颜色的猜测，但在普通 Web 应用程序中通过 Javascript 提取序列号似乎是不可能的。

# android - 使用按钮在 Android 上从布局 1 更改为布局 2

> ID：15228386
> 
> 赞同：1
> 
> 时间：2013-03-05T15:58:51.350
> 
> 标签：android, layout, button

我有两个布局，我想在单击按钮时相互更改。它们是这样的全屏视图：

```
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:background="#FF0000"
tools:context=".FullscreenActivity" > 
```

我希望它们在单击时在它们之间进行更改

```
 <Button
 android:id="@+id/green_button"
 style="?buttonBarButtonStyle"
 android:layout_width="0dp"
 android:layout_height="wrap_content"
 android:layout_weight="1"
 android:text="@string/green" /> 
```

我是否应该更改 src/com.example.layout/fullscreenactivity.java onClick() 中的某些内容，或者我可以在哪里更改以使这种情况发生？

非常感谢提前

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T16:04:36.250

```
rb = (Button) findViewById(R.id.green_button);
rb.setOnClickListener(new View.OnClickListener() {

    @Override
    public void onClick(View v) {
            setContentView(R.layout.OtherLayout);
// now in order to use other layout button, image or any child function you have to declare it under the                 setContentView(R.layout.OtherLayout);

    }
}); 
```

请接受答案:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T16:02:25.693

最简单的方法是同时应用 FrameLayouts，并且`onClickListener`只改变一个到`visible`另一个的可见性`gone`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T16:05:57.730

是的，在您使用框架布局和按钮的活动中，您必须为按钮添加一个侦听器以及单击按钮时发生的适当操作（在您的情况下 - 更改布局）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-05T16:08:47.877

您可以做的一件事是在一个`xml`文件中声明两种布局，然后用于`setVisibility(View.GONE)`删除特定布局。您可以在[这个](https://stackoverflow.com/questions/4570236/android-change-layout-dynamically)stackoverflow 问题中看到这一点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-05T16:11:03.247

```
layout1 = (FrameLayout)findViewById(R.id.frameLayout1);
layout2 = (FrameLayout)findViewById(R.id.frameLayout2);
layout2.setVisibility(View.GONE);
mButton = (Button)findViewById(R.id.green_button);

mButton.setOnClickListener(new View.OnClickListener() {

    @Override
    public void onClick(View v) {
            layout1.setVisibility(View.GONE);
            layout2.setVisibility(View.VISIBLE);

    }
}); 
```

# vba - 将文本中的数据解析为excel列

> ID：15228387
> 
> 赞同：0
> 
> 时间：2013-03-05T15:58:52.940
> 
> 标签：vba, excel, vbscript

我想解析文本文件的以下部分，以便将“DVA”下的增量数字作为我确定的单元格范围放入列中。我想对第二列中以 S 开头的序列号执行相同的操作，也在我确定的范围内。它们之间有一个`|`分隔符，我想`DAU SNo.-C0`成为我搜索的字符串。

我在想：搜索`DAU SNo.-C0`，然后以某种方式跳过两行并将下面的内容复制到 Excel 中，将数据解析为两列并确定应该放置的单元格范围。

```
 DAU SNo.-C0
+-------------------------+
|DVA|          0          |
+-------------------------+
| 0 | S1050360701270      |
| 1 | S1050344701369      |
| 2 | S1050360701315      |
| 3 | S1021360701337      |
| 4 | S1050360701367      |
| 5 | S1050332701350      |
| 6 | S1050360701584      |
+-------------------------+ 
```

这就是我所拥有的：已更新

```
Do While i < UBound(strAll)
       If (InStr(1, strAll(i), "DAU SNo.-C0", vbTextCompare) > 0) Then
          i = i + 4 'Skip 4 lines to get to first SN
          Do Until InStr(1, strAll(i), "+", vbTextCompare) > 0 'Loop until line includes "+"
             strSNO = Split(strAll(i), "|", -1, vbTextCompare)
             'put strSNO into next cell in column A
             i = i + 1
          Loop
       End If
    i = i + 1
    Loop
   Next 
```

我尝试了几种将拆分字符串放入列中的下一个单元格的方法，但我无法让它工作。除了实际复制值（注释在代码中的位置）之外的所有单词。我通过打印 strSNO(1) 和 strSNO(2) 验证了其余部分是否有效。

任何方向、解释或代码都会有所帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T16:13:38.873

找到该行后，使用 VBA`Split`函数，`|`用作分隔符。它将一个字符串拆分为一个数组。

示例：如果您这样做：

```
strTest = Split(">| 0 | S1050360701270", "|", -1, vbTextCompare) 
```

它会像`strTest(1) = 0`,一样出来`strTest(2) = S1050360701270`。

您可能还想`strAll = Split(objReadFile.ReadAll, vbCrLf, -1, vbTextCompare)`先将整个文本文件导入 VBA（有时更快），然后使用整数变量遍历每一行 - 这意味着当您发现“DAU SNo.-C0”时可以跳过几行" 字符串，而不必阅读每个字符串。

======编辑======

尝试将代码中的 do 循环替换为以下内容：

```
Dim strAll() As String, strSNO() As String, i As Integer
strAll = Split(objReadFile.ReadAll, vbCrLf, -1, vbTextCompare) 'Gets each line from file
i = LBound(strAll)
Do While i < UBound(strAll)
    If (InStr(1, strAll(i), "DAU SNo.-C0", vbTextCompare) > 0) Then
        i = i + 4 'Skip 4 lines to get to first | 0 | S1050360701270 | line
        Do Until InStr(1, strAll(i), "+", vbTextCompare) > 0 'Loop until line includes "+"
            strSNO = Split(strAll(i), "|", -1, vbTextCompare)
            'This will add them to the next available row in A / B... change as needed
            Range("A60000").End(xlUp).Offset(1, 0).Value = Trim(strSNO(1))
            Range("B60000").End(xlUp).Offset(1, 0).Value = Trim(strSNO(2))
            i = i + 1
        Loop
    End If
    i = i + 1
Loop 
```

# c - 使用 scanf() 进行输入验证

> ID：15228388
> 
> 赞同：5
> 
> 时间：2013-03-05T15:58:57.820
> 
> 标签：c, validation, input, integer

我有一个程序，它接受用户的整数并在加法运算中使用这个数字。

我用来接受号码的代码是这样的：

```
scanf("%d", &num); 
```

如何验证输入，以便如果用户输入带小数点的字母或数字，屏幕上会显示错误消息？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-05T16:00:07.237

您应该使用`scanf`返回值。来自[`man scanf`](http://linux.die.net/man/3/scanf)：

> ### 返回值
> 
> 这些函数返回成功匹配和分配的输入项的数量，该数量可能少于提供的数量，或者在早期匹配失败的情况下甚至为零。

所以它可能看起来像这样：

```
if (scanf("%d", &num) != 1)
{
    /* Display error message. */
} 
```

请注意，它不适用于“带小数点的数字”。为此，您应该使用解析，`strtol`例如。它可能有点复杂。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T16:50:11.240

`scanf`使用`%s`转换说明符或使用将输入作为文本读取`fgets`，然后使用`strtol`库函数进行转换：

```
#define MAX_DIGITS 20 // maximum number of decimal digits in a 64-bit integer

int val;
int okay = 0;

do
{
  char input[MAX_DIGITS+2]; // +1 for sign, +1 for 0 terminator
  printf("Gimme a number: ");
  fflush(stdout);
  if (fgets(input, sizeof input, stdin))
  {
    char *chk = NULL; // points to the first character *not* converted by strtol
    val = (int) strtol(input, &chk, 10);
    if (isspace(*chk) || *chk == 0)
    {
      // input was a valid integer string, we're done
      okay = 1;
    }
    else
    {
      printf("\"%s\" is not a valid integer string, try again.\n", input);
    }
  }
} while (!okay); 
```

# javascript - Javascript：将内联代码注入 html 标签

> ID：15228390
> 
> 赞同：0
> 
> 时间：2013-03-05T15:59:04.320
> 
> 标签：javascript, google-analytics, inline, inject

我想将我的 Google Analytics 跟踪事件代码内联添加到我的**输入**html 标记中：

```
<input class="addtobag"> 
```

有东西

```
<input class="addtobag" onClick="_gaq.push(['_trackEvent', 'Videos', 'Play', 'Baby\'s First Birthday']);"> 
```

我问这个是因为我无权访问包含标签的文件，所以我无法手动进行更改，所以我正在寻找一个我将放在**头部**的 javascript 代码，以便当该页面加载时，跟踪事件代码将被自动注入。

我希望通过我的**输入类**而不是通过**id**调用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T16:01:36.423

为什么要内联？

```
document.getElementById('ctl00_mainContentPlaceHolder_lvLookProducts_ctrl0_buyArea3493_btnAddToCart').onclick = function () {
    _gaq.push(['_trackEvent', 'Videos', 'Play', 'Baby\'s First Birthday']);
}; 
```

* * *

要按类名执行此操作，您需要做更多的逻辑：

```
var inputs = document.getElementsByClassName('AddToBag'),
    i = inputs.length;

while(i--) {
    inputs[i].onclick = function () {
        _gaq.push(['_trackEvent', 'Videos', 'Play', 'Baby\'s First Birthday']);
    }; 
} 
```

按类名获取会返回一个列表，因此您必须循环以应用处理程序。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-05T18:46:02.723

jQuery 是你的朋友。

[如何使用 jQuery 替换 div 的 innerHTML？](https://stackoverflow.com/questions/1309452/how-to-replace-innerhtml-of-a-div-using-jquery)

```
$("#regTitle").html("Hello World"); 
```

**编辑**

猜猜我没有读过这个，但仍然是相同的原理。

```
$(".addtobag").click(_gaq.push(['_trackEvent', 'Videos', 'Play', 'Baby\'s First Birthday'])); 
```

[http://api.jquery.com/click/](http://api.jquery.com/click/)

# sql-server - SugarCRM 项目和 SQL Server 约束问题/错误

> ID：15228391
> 
> 赞同：2
> 
> 时间：2013-03-05T15:59:06.453
> 
> 标签：sql-server, sql-server-2008, sql-server-2005, constraints, sugarcrm

我被困在一个问题上，希望有人对此有一些经验。它涉及我在过去三年中从事的一个开源 (FREE) 项目。它是 SugarCRM CE/PRO/ENT 的可安装包。

JJWDesign 用于 SugarCRM 的 Google 地图

[http://www.sugarforge.org/projects/jjwgooglemaps/](http://www.sugarforge.org/projects/jjwgooglemaps/)

有几个人在安装过程中报告了 MS SQL 的约束错误。使用 MySQL 运行 SugarCRM 的服务器没有这个问题。报告是在安装地图包期间发生错误。不幸的是，我无法测试 MS SQL，也无法更改数据库层或 SugarCRM 的安装处理。

错误：

> 2012 年 5 月 17 日 12:28:50 [6508][1][致命] 更改表 jjwg_maps_lat 列时出错
> ：jjwg_markers：查询失败：ALTER TABLE
> jjwg_markers DROP CONSTRAINT DF__jjwg_mark__jjwg___7B7B4DDC ALTER
> TABLE jjwg_markers_lat ALTER COLUMN jj NULL ALTER
> TABLE jjwg_markers ADD DEFAULT '0.00000000' FOR jjwg_maps_lat :::
> [Microsoft][SQL Server Native Client 10.0][SQL
> Server]'DF__jjwg_mark__jjwg___7B7B4DDC' 不是约束。
> [Microsoft][SQL Server Native Client 10.0][SQL Server]无法删除
> 约束。请参阅以前的错误。

最近报告了另一个错误。

> SQL 错误：[Microsoft][SQL Server Native Client 10.0][SQL
> Server]'DF__jjwg_mark__jjwg___1EC48A19' 不是约束。
> [Microsoft][SQL Server Native Client 10.0][SQL Server]无法删除
> 约束。查看以前的错误..

SugarCRM 论坛主题：SugarCRM 论坛无法帮助解决这个问题，这就是我在 stackoverflow.com 上发帖的原因。

[http://forums.sugarcrm.com/f6/jjwdesign-google-maps-addon-installation-issue-80206/](http://forums.sugarcrm.com/f6/jjwdesign-google-maps-addon-installation-issue-80206/)

似乎 Float 字段类型是问题的原因。SugarCRM 认为它需要从该字段中删除一个约束，但是当它尝试这样做时，该约束不存在。也许有一种方法可以设置 MS SQL 来忽略这些类型的错误？

谢谢，杰夫沃尔特斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T16:32:41.833

我一直在其他 MSSQL 安装上看到这一点。当涉及到快速修复/重建（或您所看到的安装过程）时，SugarCRM 不能很好地处理 MSSQL。它总是生成这个 SQL。我只是告诉我的客户忽略它。显然，这不是像您这样的可分发解决方案的最佳答案。

# java - 不推荐使用返回 Hibernate SessionFactory 对象的 buildSessionFactory() 方法，如何解决？

> ID：15228392
> 
> 赞同：0
> 
> 时间：2013-03-05T15:59:06.187
> 
> 标签：java, database, hibernate, orm

我是 Hibernate 的新手，我正在阅读这篇文章来研究这个 ORM 框架：[http ://www.tutorialspoint.com/hibernate/hibernate_examples.htm](http://www.tutorialspoint.com/hibernate/hibernate_examples.htm)

我已经阅读了该站点以前的所有 Hibernate 教程，直到现在对我来说都非常清楚。

唯一的“问题”是我没有使用 Hibernate 3.6.4-Final（如本教程系列中使用的那样），但我使用的是最新的 Hibernate **4.1.9-Final**版本。

我已经实现了这个示例并且运行良好，但 Eclipse 说我不赞成使用主类**ManageEmployee**的指令。

不推荐使用的指令是调用**buildSessionFactory()**以下指令：

```
factory = new Configuration().configure().buildSessionFactory();` 
```

如何替换它以创建一个不被弃用的新工厂？

肿瘤坏死因子

安德烈亚

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T16:29:29.603

在 Hibernate 4 中，不推荐使用 buildSessionFactory()。此示例包含您可以使用的代码，尽管有 buildSessionFactory ()。

```
private static SessionFactory sessionFactory;
private static ServiceRegistry serviceRegistry;

private static SessionFactory configureSessionFactory() throws HibernateException {
    Configuration configuration = new Configuration();
    configuration.configure();
    serviceRegistry = new ServiceRegistryBuilder().applySettings(configuration.getProperties()).buildServiceRegistry();        
    sessionFactory = configuration.buildSessionFactory(serviceRegistry);
    return sessionFactory;
} 
```

您可以在[Hibernate 4 简单示例中获得更多详细信息](http://www.roseindia.net/hibernate/Hibernate4Example.shtml)

# jquery - 如果直接调用函数，jqGrid 上的“loadComplete”事件将不起作用。如果我们将它包装在匿名函数中，它可以正常工作

> ID：15228393
> 
> 赞同：0
> 
> 时间：2013-03-05T15:59:12.223
> 
> 标签：jquery, jqgrid

如果我使用这个：

```
loadComplete: rowCount() 
```

它不工作。
如果我们直接打电话，我想知道为什么它不起作用的原因。

代码片段：

```
function rowCount() {
    var recCount = $("#fbDetailTable").jqGrid('getGridParam', 'records');
    if (recCount == 0) {
        displayMessage("Freight bill not found");
    } else {
        displayMessage("Freight bill found");
    }
}

function getFreightBill() {
    var frtBill = document.getElementById("freightBill").value;
    if (isNaN(frtBill)) {
        displayMessage("Freight bill contain digits alone");
    } else {
        var intTemplate = {
            sorttype: "integer",
            formatter: "text",
            align: "center"
        };
        var dateTemplate = {
            sorttype: "date",
            formatter: "date",
            align: "center"
        };
        $("#fbDetailTable").jqGrid('GridUnload');
        $("#fbDetailTable").jqGrid({
            url: "/BSNReportBatch/rs/FBService/getFB?fB=" + frtBill,
            datatype: "json",
            colNames: ["Store Number", "Order Number", "SKU number",
                "Shipped Quantity", "Order Created Date"],
            colModel: [{
                name: "strNbr",
                template: intTemplate
            }, {
                name: "orderNbr",
                template: intTemplate
            }, {
                name: "skuNbr",
                template: intTemplate
            }, {
                name: "shpdQty",
                template: intTemplate
            }, {
                name: "ordCrtDt",
                template: dateTemplate
            }],
            cmTemplate: {
                width: 180
            },
            jsonReader: {
                repeatitems: false,
                id: "strNbr",
                root: function (obj) {
                    return obj;
                }
            },
            pager: "#fbPager",
            rowNum: 50,
            rowList: [50, 100, 200],
            sortName: "strNbr",
            sortOrder: "desc",
            gridview: true,
            autoencode: true,
            height: "auto",
            viewrecords: true,
            loadonce: true,
            caption: "Order Details",
            loadComplete: function () {
                rowCount();
            }
        });
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T16:06:29.543

立即使用`loadComplete: rowcount()`调用`rowcount()`并将其返回值传递给`loadComplete`而不是传递`rowcount`给`loadComplete`. 您所要做的就是删除`()`to 而不是传递函数本身。

```
loadComplete: rowcount 
```

# php - PHP 3rd 方午餐订购

> ID：15228400
> 
> 赞同：0
> 
> 时间：2013-03-05T15:59:33.593
> 
> 标签：php, windows-server

我正在尝试为 Strava.cz 制作第三方午餐订购系统。我已经制作了一个应该这样做的图书馆。除 strava_czChoose 函数外，一切正常。它不会引发错误，但什么也不做。他们的服务器基于 Windows ASPX，因此很难理解所有传输的数据。这是整个代码：

```
<?php
/**
 * Additional function for DOMDocument
 * * * * *
 * @param DOMDocument $DOMDocument Document where you want to search
 * @patam string $className Name of the class you are searching of
 * * * * *
 */
function getElementsByClassName(\DOMDocument $DOMDocument, $className) {
 $Elements = $DOMDocument->getElementsByTagName("*");
 $Matched = array();

 for($i=0;$i<$Elements->length;$i++) {
  if(in_array($ClassName, explode(' ', $Elements->item($i)->attributes->getNamedItem('class')->nodeValue))) {
   $Matched[]=$Elements->item($i);
  }
 }

 return $Matched;
}

$strava_czHeader="User-Agent:(none; StravaCekujNET; Linux x86_64; rv:1.0)\r\nAccept:(text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8)\r\nAccept-Language:(cs,sk;q=0.8,en;q=0.6,en-gb;q=0.4,en-us;q=0.2)\r\nAccept-Encoding:(gzip, deflate)\r\nDNT:(1)\r\nConnection:(keep-alive)\r\n";
$strava_czHandle="n/a";

/**
 * * * * * * * * * * * * * * * *
 * Přihlášení (strava_czLogin) *
 * * * * * * * * * * * * * * * *
 * @param int|string $machine Zařízení (4 číslice, string v případě, že začíná nulou)
 * @param int|string $user Uživatel (10 číslic, string v případě, že začíná nulou)
 * @param string $pass Heslo pro přihlášení
 * * * * *
 */
function strava_czLogin($machine,$user,$pass){
 global $strava_czHeader;
 global $strava_czHandle;

 //Zašle první požadavek > $dom
 $src = file_get_contents('http://m.strava.cz/Stravnik/formprihlaseni.aspx',false,stream_context_create(array('http'=>array('header' => $strava_czHeader))));
 $dom = new domDocument;        //Vytvoří DOM
 $doc->strictErrorChecking = false;
  $src = mb_convert_encoding($src, 'HTML-ENTITIES', "UTF-8");
 $dom->loadHTML($src);         //Načte HTML
 unset($http_response_header, $src); //Uvolní paměť

 //Zpracuje přijatá data a zjistí klíč > $key
 $query['viewstate'] = $dom->getElementById('__VIEWSTATE')->getAttribute('value');
 $query['eventvalidation'] = $dom->getElementById('__EVENTVALIDATION')->getAttribute('value');
 $key = '?__EVENTTARGET'.
     '&__EVENTARGUMENT'.
     '&__VIEWSTATE='.urlencode($query['viewstate']).
     '&__EVENTVALIDATION='.urlencode($query['eventvalidation']).
     '&ctl00%24ContentPlaceHolder1%24txtZarizeni='.urlencode($machine).
     '&ctl00%24ContentPlaceHolder1%24txtUzivatel='.urlencode($user).
     '&ctl00%24ContentPlaceHolder1%24txtHeslo='.urlencode($pass).
     '&ctl00%24ContentPlaceHolder1%24butOdeslat=Odeslat';
 unset($dom, $query);  //Uvolní paměť

 //Zašle požadavek > $src, $http_response_header
 $src = file_get_contents('http://m.strava.cz/Stravnik/formprihlaseni.aspx'.$key,false,stream_context_create(array('http'=>array('header' => $strava_czHeader))));
 unset($key, $src); //Uvolní paměť

 //Zpracuje přijaté sušenky (mňam!)
 $i = 1;
 $strava_czHandle = array();
 $strava_czHandle['cookies'] = "";
 foreach ($http_response_header as $value) {
  $preg = preg_match('/^Set-Cookie:\s*.[^=]*=.[^;]*/m', $value, $matches);
  if ($preg) {
   foreach ($matches as $match) {
    $strava_czHandle['cookies'] .= substr($match, 12); //Zápis do handleru
    //Substring proto, aby se do handleru nezapisovalo i "SetCookie: "
   }
  }
 }
 unset($i, $http_response_header, $matches, $match, $value); //Uvolní paměť

 //Případně vyhodí chybu
 if ($strava_czHandle['cookies']==""){throw new Exception("noResult");}
}

/**
 * * * * * * * * * * * * * * * *
 * Odhlášení (strava_czLogout) *
 * * * * * * * * * * * * * * * *
 */
function strava_czLogout(){
 global $strava_czHandle;

 if ($strava_czHandle=="n/a") {throw new Exception("notLogged");}

 //Zašle požadavek
 $src = file_get_contents('http://m.strava.cz/Stravnik/odhlaseni.aspx',false,stream_context_create(array('http'=>array('header' => $strava_czHeader."Cookie: ".$strava_czHandle['cookies']."\r\n"))));

 //Zkontroluje správnost přijatých dat
 if (preg_match('/<form.*[^>]action="Default.aspx".*[^>]>/m',$src)){
  $strava_czHandle="n/a";
 } else {
  throw new Exception("unknownError");
 }
}

/**
 * * * * * * * * * * * * * * * * * * * * *
 * Získání jídelníčku (strava_czGetList) *
 * * * * * * * * * * * * * * * * * * * * *
 */
function strava_czGetList(){
 global $strava_czHeader;
 global $strava_czHandle;

 if (!$strava_czHandle||$strava_czHandle=="n/a") {throw new Exception("notLogged");}

 //Zašle požadavek > $dom
 $src = file_get_contents('http://m.strava.cz/Stravnik/objednavky.aspx',false,stream_context_create(array('http'=>array('header' => $strava_czMozHeader."Cookie:".$strava_czHandle['cookies']."\r\n"))));
 $dom = new domDocument;              //Vytvoří DOM
 $doc -> strictErrorChecking = FALSE;
  $src = mb_convert_encoding($src, 'HTML-ENTITIES', "UTF-8");
 $dom -> loadHTML($src);              //Načte HTML
 unset($http_response_header, $src); //Uvolní paměť

 //Zpracuje přijatá data > $nodeArray, $xpath
 $tbl = $dom -> getElementById('tblObjednavky') -> childNodes;
 $nodeArray=array(); $j=-1; $class = null;
 foreach ($tbl as $item) {
  if (($item -> getAttribute('class')) === 'tblObjednavkyDatum') {$j++;}
  $nodeArray[$j][] = $item;
 }
 $xpath = new DOMXPath($dom);
 unset($dom, $tbl, $j, $class, $item);

 /*
  Vytvořeno dvourozměrné pole. První rozměr určuje den a druhý konkrétní node
  (0 pro řádek s datem, vyšší číslo pro řádek s jídlem).
 */

 //Roztřídí přijatá data > $result
 $result = array();
 $i = 0;
 foreach ($nodeArray as $item) {
  $result[$i]['chosen'] = null;
  $result[$i]['choosable'] = false;
  $result[$i]['day'] = null;
  $j = -1;
  foreach ($item as $subitem) {
   if ($j > -1) {
    //Nastaví hodnoty, které jsou pro každou volbu individuální
    $result[$i]['name'][$j] = substr($xpath -> evaluate('./td[4]', $subitem) -> item(0) -> textContent, 4);

    /*
       Lowercase
       Všechny bílé znaky převést na mezeru a zakázat více mezer za sebou (chování jako HTML bez white-space:pre)
       Za každou tečku a čárku, za kterou není mezera, přidat mezeru.
    */
    $result[$i]['name'][$j] = preg_replace('([\.,])', '$0 ', $result[$i]['name'][$j]);
    $result[$i]['name'][$j] = preg_replace('/\s+/m',' ', mb_strtolower($result[$i]['name'][$j], 'utf-8'));

    if ($xpath -> evaluate('./td[2]/img', $subitem) -> length) {$result[$i]['chosen'] = $j;}
    $x = $xpath -> evaluate('./td[3]/span/input', $subitem);
    if ($x -> length) {
     $result[$i]['choosable'] = true;
     $result[$i]['day'] = $x -> item(0) -> getAttribute('name');
     $result[$i]['lunch'][$j] = $x -> item(0) -> getAttribute('value');
    }
   }
   $j++;
  }
  //Nastaví hodnoty, které platí pro celý den
  $result[$i]['date'] = $item[0] -> textContent;
  /* TODO Převést datum na DD/MM/YYYY */
  $i++;
 }

 //Vrátí výsledné hodnoty
 if ($result == array()) {throw new Exception("noResult");} else {return $result;}
}

/**
 * * * * * * * * * * * * * * * * * * * *
 * Objednávání jídel (strava_czChoose) *
 * * * * * * * * * * * * * * * * * * * *
*/
function strava_czChoose($list) {
 global $strava_czHeader;
 global $strava_czHandle;

 if (!$strava_czHandle||$strava_czHandle=="n/a") {throw new Exception("notLogged");}

 //Pošle první požadavek (získá ty mrkvosofťácký "chujoviny", jak by řekl Keby) > $dom, $list
 $src = file_get_contents('http://m.strava.cz/Stravnik/objednavky.aspx',false,stream_context_create(array('http'=>array('header' => $strava_czMozHeader."Cookie:".$strava_czHandle['cookies']."\r\n"))));
 $dom = new domDocument; //Vytvoří DOM
 $doc->strictErrorChecking = false;
  $src = mb_convert_encoding($src, 'HTML-ENTITIES', "UTF-8");
 $dom->loadHTML($src);   //Načte HTML
 unset($http_response_header,$src);

 //Zpracuje data a zjistí klíč > $key, $list
 $query['viewstate'] = $dom->getElementById('__VIEWSTATE')->getAttribute('value');
 $query['eventvalidation'] = $dom->getElementById('__EVENTVALIDATION')->getAttribute('value');
 $key = '?_EVENTTARGET=butOdeslat'.
        '&_EVENTARGUMENT'.
        '&_VIEWSTATE='.urlencode($query['viewstate']).
        '&_EVENTVALIDATION='.urlencode($query['eventvalidation']);
 unset($dom,$query);

 //Ze zadání vytvoří string dotazu > $data, $key
 $data = '';
 foreach ($list as $day => $lunch) {
  $data .= '&'.urlencode($day).'=radObjednavka'.urlencode($lunch);
 }
 var_dump('http://m.strava.cz/Stravnik/objednavky.aspx'.$key.$data);

 //Pošle druhý požadavek (odešle objednávku), případně vyhodí error
 file_get_contents('http://m.strava.cz/Stravnik/objednavky.aspx'.$key.$data,false,stream_context_create(array('http'=>array('header' => $strava_czMozHeader."Cookie:".$strava_czHandle['cookies']."\r\n"))));
 if (preg_match('/500/',$http_response_header)) {throw new Exception("unknownError");}
}

try {strava_czLogin(/*secret*/);}
 catch (Exception $e) {exit("</div><div>Přihlášení se nezdařilo, chyba: ".($e -> getMessage()));}
try {$r=strava_czGetList();}
 catch (Exception $e) {exit("</div><div>Zjištení jídel se nezdařilo, chyba: ".($e -> getMessage()));}
try {strava_czChoose(array('2013-03-121' => 'P754'));}
 catch (Exception $e) {exit("</div><div>Chyba při odesílání objednávek: ".($e -> getMessage()));}
try {strava_czLogout();}
 catch (Exception $e) {exit("</div><div>Odhlaseni se nezdařilo, chyba: ".($e -> getMessage()));}
var_dump($r);
?> 
```

我不知道怎么了。抱歉评论，他们是捷克语，你可以使用谷歌翻译，但它的翻译不是*doubleplusgood*。谢谢你的帮助，m93a

**编辑：**我发现如果服务器返回 HTTP 302，这是一个可接受的选择。我得到 HTTP 200。我什至尝试使用 POST 而不是 GET，但我仍然得到 200。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T22:14:36.693

最后，我找到了原因。我彻底比较了浏览器的 HTTP 请求和我的应用程序的请求，发现`__EVENTTARGET`应该设置为“butOdeslat2”。还有一些小错误，但我很快发现并修复了它们。

现在一切都很完美。

# php - 执行的 PHP/SQL 错误

> ID：15228402
> 
> 赞同：0
> 
> 时间：2013-03-05T15:59:40.580
> 
> 标签：php, sql, pdo

```
<?php
$dbhost="host";
$dbusername="user";
$dbpassword="pass";
$dbname="db";

try {
  # MySQL with PDO_MYSQL
  $DBH = new PDO("mysql:host=$dbhost;dbname=$dbname", $dbusername, $dbpassword);
  echo "Connected Successfully";
}
catch(PDOException $e) {
    echo $e->getMessage();
}

#  close the connection  
$DBH = null; 
?> 
```

在我的服务器上运行它时，我收到以下错误：

```
Parse error: parse error, unexpected '{' in /home/web/i/htdocs/search/pdo.php on line 7 
```

我正在尝试进行测试以使用 PDO 将变量保存到数据库，并被告知 PDO 是安全地将变量存储到数据库的方法。请让我知道为什么我会收到错误以及如何解决它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T16:47:04.620

我已经运行了您的代码并且没有收到解析错误。看起来一切都很好。也许您的运行方式与您在此处发布的方式不同。

# ruby - 生成带有大写字母的 XML 根？

> ID：15228404
> 
> 赞同：0
> 
> 时间：2013-03-05T15:59:46.503
> 
> 标签：ruby, xml

我正在使用[xml/mapping](http://xml-mapping.rubyforge.org/)库，这是我生成 XML 的方式：

```
xml = user.save_to_xml
str = String.new
xml.write(str,2) 
```

结果与我想要的有点不同。它生成带有小写字母的 XML 标记：

```
<user PK=...
 ...
</user> 
```

但我需要标签以大写字母开头：

```
<User PK=...
 ...
</User> 
```

如何使用大写字母强制生成？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T16:10:55.447

您可以像这样覆盖默认值`root_element_name`：

```
User.root_element_name "User" 
```

如果要修改所有类的默认值，则需要覆盖`default_root_element_name`定义为的方法：

```
# The default root element name for this class. Equals the class
# name, with all parent module names stripped, and with capital
# letters converted to lowercase and preceded by a dash;
# e.g. "Foo::Bar::MySampleClass" becomes "my-sample-class".
def default_root_element_name
  self.name.split('::')[-1].gsub(/^(.)/){$1.downcase}.gsub(/(.)([A-Z])/){$1+"-"+$2.downcase}
end 
```

# html - 在描述中显示带有 html 解释的 wordpress blogroll

> ID：15228409
> 
> 赞同：1
> 
> 时间：2013-03-05T16:00:26.833
> 
> 标签：html, wordpress

我愿意使用 wordpress 的 blogroll 功能在我的网站上显示合作伙伴列表。我想知道如何使用`Description`wordpress 链接页面中的字段来接受 html 标签`<a>`等`<p>`？

我可以显示`description`，但它不解释标签。例如，如果我输入描述

```
This is the description of our partner. His <a href="www.bla.com">Website</a> is cool 
```

然后我会在网站上得到与纯文本相同的文本，没有链接！

我怎样才能做到？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T00:04:11.403

有关将来从核心中删除链接并转换为插件的[相关核心票证。](http://core.trac.wordpress.org/ticket/21307)

* * *

`Description`要在字段中（和字段中）启用 HTML 标记`Notes`，请使用以下代码：

```
// Disable the removal of HTML tags
remove_filter( 'pre_link_description', 'wp_filter_kses' );
remove_filter( 'pre_link_notes', 'wp_filter_kses' );

// Enable HTML tags the same way as in posts content
add_filter( 'pre_link_description', 'wp_filter_post_kses' );
add_filter( 'pre_link_notes', 'wp_filter_post_kses' ); 
```

# ruby-on-rails - 如何设置临时使用复选框？

> ID：15228410
> 
> 赞同：0
> 
> 时间：2013-03-05T16:00:35.227
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我在消息表中`models/message.rb`没有两`send_to_all`列。
在这里，我只想使用`send_to_all`复选框标志来切换模式以一次向所有用户发送消息。

我怎样才能做到这一点？

**意见/消息/new.html.erb**

```
<%= f.check_box :send_to_all, :label => 'Send to all Users'  %> Check if you want to send to all users at once. 
```

**消息控制器.rb**

```
 if params[:messages][:send_to_all]
        The action to send the same message to all users 

    else        
        The action to send the message to a user

    end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T16:24:10.323

如果您没有模型，则无法创建与对象关联的表单，因此您必须使用`form tag helpers`.

可以像这样创建一个复选框：

```
check_box_tag 'send_to_all' 
```

导致：

```
<input id="send_to_all" name="send_to_all" type="checkbox" value="1" /> 
```

[在这里](http://api.rubyonrails.org/classes/ActionView/Helpers/FormTagHelper.html#method-i-check_box_tag)查看更多助手。

因此，要使用与模型无关的表单，您可以执行以下操作：

```
<% form_tag '/your_route' do -%>
  <div><%= check_box_tag 'send_to_all' %></div>
  <div><%= submit_tag 'Save' %></div>
<% end -%> 
```

# java - 没有 ItemListener 也能正常工作，但是当我添加它时，它给了我一个 NullPointerException

> ID：15228411
> 
> 赞同：2
> 
> 时间：2013-03-05T16:00:35.803
> 
> 标签：java, multithreading, swing, user-interface, calendar

我为我的班级制作了一个简单的摇摆程序，它根据 ComboBox 中的选定索引更改时区和其他一些东西。当方法 run() 如下所示时工作正常：

```
public void run() {
        while(true){
            Calendar c = Calendar.getInstance();
            int h = c.get(Calendar.HOUR);
            int m = c.get(Calendar.MINUTE);
            int s = c.get(Calendar.SECOND);
            l.setText(""+h+":"+m+":"+(s<10?"0"+s:s));
            try {
                t.sleep(1000);
            } catch (InterruptedException ex) {}
        }
    } 
```

但是，当我尝试重新定义它并使时间更改起作用时，我在这一行中得到一个空指针异常：

```
p.cb.addItemListener(new ItemListener() { 
```

方法 run() 看起来像这样，它不会工作。有任何想法吗？

```
public void run() {
    while(true){

        p.cb.addItemListener(new ItemListener() {

            @Override
            public void itemStateChanged(ItemEvent e) {
                Calendar c = Calendar.getInstance();
                int h = c.get(Calendar.HOUR);
                int m = c.get(Calendar.MINUTE);
                int s = c.get(Calendar.SECOND);
                int index = p.cb.getSelectedIndex();

                if(index == 0){
                    l.setText(""+h+":"+m+":"+(s<10?"0"+s:s));
                }
                else if(index == 1){
                    l.setText(""+(h-6)+":"+m+":"+(s<10?"0"+s:s));
                }
                else if(index == 2){
                    l.setText(""+(h-1)+":"+m+":"+(s<10?"0"+s:s));
                }
                else if(index == 3){
                    l.setText(""+(h-6)+":"+m+":"+(s<10?"0"+s:s));
                }
                else if(index == 4){
                    l.setText(""+(h+8)+":"+m+":"+(s<10?"0"+s:s));
                }
            }

        });

        try {
            t.sleep(1000);
        } catch (InterruptedException ex) {}
    }
} 
```

如果有人感到困惑，p 是 JFrame 类的一个实例，而 cb 是对 JFrame 类中 ComboBox 的引用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T16:02:29.740

A`NullPointerException`被抛出是因为要么`p`或`cb`有一个`null`值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T17:35:11.307

你的线程现在没有意义了。它每秒钟向组合框添加一个 ItemListener，但每个 ItemListener 都在做同样的事情。此外，您的线程正在修改 EDT 之外的 gui 元素。您需要在 EDT 上添加 ItemListener。

我假设您尝试做的是每隔几秒或更改组合框时更新标签。

您应该在没有线程的情况下执行此操作，而是使用 Swing Timer 和 ItemListener 的组合。

```
// called on the EDT
void setup() {
     // create gui elements
     p.cb.addItemListener(new ItemListener() {
        updateTimeLabel();
     }
     new Timer(1000, new ActionListener() {
        public void actionPerformed(ActionEvent evt) {
           updateTimeLable()
        }
     });
 }

 private void updateTimeLabel() {
     Calendar c = Calendar.getInstance();
     int h = c.get(Calendar.HOUR);
     int m = c.get(Calendar.MINUTE);
     int s = c.get(Calendar.SECOND);
     int index = p.cb.getSelectedIndex();

     if(index == 0){
        l.setText(""+h+":"+m+":"+(s<10?"0"+s:s));
     }
     else if(index == 1){
         l.setText(""+(h-6)+":"+m+":"+(s<10?"0"+s:s));
     }
     else if(index == 2){
         l.setText(""+(h-1)+":"+m+":"+(s<10?"0"+s:s));
     }
     else if(index == 3){
          l.setText(""+(h-6)+":"+m+":"+(s<10?"0"+s:s));
     }
     else if(index == 4){
          l.setText(""+(h+8)+":"+m+":"+(s<10?"0"+s:s));
     }
 } 
```

至于为什么现在出现空指针异常，这可能是由于访问尚未初始化的不同变量、内存可见性问题、线程竞争条件或修改 EDT 之外的 GUI 元素引起的。如果你删除你的线程，除了第一个之外，所有这些条件都会消失。然后很容易确保在调用 addItemListener 方法之前初始化 p.cb。

此外，您确实应该使用比 p、cb、l 更具描述性的名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T18:36:16.963

> 如果有人感到困惑，p 是 JFrame 类的一个实例，而 cb 是对 JFrame 类中 ComboBox 的引用。

JFrame 的实例？你为什么要遵循这种方法？只需调用`ComboBox`变量并添加监听器！`p`似乎是`NULL`。

# java - 强制 JVM 在没有页面缓存的情况下执行所有 IO（例如 O_DIRECT）

> ID：15228412
> 
> 赞同：12
> 
> 时间：2013-03-05T16:00:39.963
> 
> 标签：java, linux, jvm

我正在对用 Java 编写的应用程序进行一些基准测试。实验很重要，结果不受页面缓存的影响（我用的是linux）

因此，避免页面缓存的最佳方法是在打开文件时使用 O_DIRECT。因此，我更改了 jre 源代码中的相应代码。

我的方法非常适用于通过（例如写作）的所有事情`FileOutputStream`，但它不适用于`FileInputStream`（例如阅读）。

将 O_DIRECT 添加到 的 open-call 时`FileInputStream`，JVM 无法加载任何类：

```
Error: Could not find or load main class perf.TestDirectIO 
```

这个错误不是类路径问题，因为我可以通过使用“未破解”的 JVM 来修复它。

所以打开文件似乎有问题。

对于有关如何解决此问题的任何建议，我感到非常高兴。

如果有人想做类似的事情，我已经[在我的博客中记录了整个 hack](http://rmnotes.wordpress.com/2013/03/05/hacking-o_direct-into-the-java-jvm-or-how-to-build-the-jvm-on-arch-linux/)。

* * *

作为参考，这些是我对 JVM 代码所做的更改：

`jdk/src/share/native/java/io/FileInputStream.c`：

```
 @@ -58,7 +60,8 @@
 JNIEXPORT void JNICALL
 Java_java_io_FileInputStream_open(JNIEnv *env, jobject this, jstring path) {
-    fileOpen(env, this, path, fis_fd, O_RDONLY);
+    fileOpen(env, this, path, fis_fd, O_RDONLY | O_DIRECT); // this is the change that causes all the problems
 } 
```

此更改有效 `jdk/src/solaris/native/java/io/FileOutputStream_md.c`：

```
@@ -55,8 +55,10 @@
 JNIEXPORT void JNICALL
 Java_java_io_FileOutputStream_open(JNIEnv *env, jobject this,
                                    jstring path, jboolean append) {
     fileOpen(env, this, path, fos_fd,
-             O_WRONLY | O_CREAT | (append ? O_APPEND : O_TRUNC));
+             O_WRONLY | O_DIRECT | O_CREAT | (append ? O_APPEND : O_TRUNC));
 } 
```

我还更改了热点 jre 以确保内存对齐（这是 O_DIRECT 的要求） `hotspot/src/share/vm/runtime/os.cpp`：

```
+# include <mm_malloc.h>
...
-  u_char* ptr = (u_char*)::malloc(size + space_before + space_after);
+  u_char* ptr = (u_char*)::_mm_malloc(size + space_before + space_after,512); 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2014-03-13T21:36:18.943

旧帖子，但我最近写了一个名为[Jaydio](https://github.com/smacke/jaydio)的小型库，希望能解决这个确切的问题。也许你会发现它很有用。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-03-05T16:17:09.357

> ```
>  "The thing that has always disturbed me about O_DIRECT is that the
>    whole interface is just stupid, and was probably designed by a deranged
>    monkey on some serious mind-controlling substances  [*]." 
> ```
> 
> [*] 换句话说，它是一种甲骨文。

--[来自 Transmeta 的 Linus Torvalds，2002 年 5 月 11 日](http://yarchive.net/comp/linux/o_direct.html)

检查注释部分[`man 2 open`](https://www.kernel.org/doc/man-pages/online/pages/man2/open.2.html)：

> O_DIRECT
> 
> O_DIRECT 标志可能会对 用户空间缓冲区的长度和地址以及I/O的*文件偏移量施加对齐**限制。*在 Linux 中，对齐限制因文件系统和内核版本而异....
> 
>  *在 Linux 2.4 下，传输大小，以及用户缓冲区和文件偏移的对齐方式都必须是文件系统逻辑块大小的倍数。在 Linux 2.6 下，对齐到 512 字节边界就足够了。……
> 
> 总之，O_DIRECT 是一个潜在的强大工具，应谨慎使用。建议应用程序将 O_DIRECT 的使用视为默认禁用的性能选项。*

 *我认为，JRE（类加载器）中有一些 FileInputStream 的用法，其读取的偏移量或大小未与 512 字节对齐。（对于[高级格式](http://en.wikipedia.org/wiki/Advanced_Format)，最小对齐可能更大，甚至 4096 字节或一个 4K 页。）

未对齐偏移的内核行为是灰色区域，这里有一些信息：[RFC: Clarifying Direct I/O Semantics, Theodore Ts'o, tytso@mit, LWN, 2009](http://lwn.net/Articles/348739/)

其他有趣的讨论在这里：[Linux: Accessing Files With O_DIRECT](http://kerneltrap.org/node/7563) (kerneltrap, 2007)

嗯，当 DIRECT 发生故障时，似乎应该回退到缓冲 I/O。所有使用 DIRECT 的 IO 操作都是同步的。可能是一些 DMA 影响？还是`O_DIRECT`和的组合`mmap`？

*更新：*

感谢 strace 输出。这是错误（`grep O_DIRECT`，然后检查文件描述符操作）：

```
28290 open("...pact/perf/TestDirectIO.class", O_RDONLY|O_DIRECT) = 11
28290 fstat(11, {st_mode=S_IFREG|0644, st_size=2340, ...}) = 0
28290 fcntl(11, F_GETFD)                = 0
28290 fcntl(11, F_SETFD, FD_CLOEXEC)    = 0
...skip
28290 stat("...pact/perf/TestDirectIO.class", {st_mode=S_IFREG|0644, st_size=2340, ...}) = 0
...skip
28290 read(11, "\312\376\272\276\0\0\0003\0\215\n\0-\0D\t\0E\0F\7\0G\n\0\3\0D\10\0H\n"..., 1024) = 1024
28290 read(11, 0x7f1d76d23a00, 1316)    = -1 EINVAL (Invalid argument) 
```

未对齐的读取大小会导致`EINVAL`错误。你的类文件是 2340 字节长，它是 1024+1316 字节，没有对齐。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-04-07T14:15:15.093

您可以利用[Java Native Access (JNA)](https://github.com/twall/jna)在 Java 下使用 O_DIRECT 。[此处](http://www.nicecode.eu/java-streams-for-direct-io/)提供了启用 O_DIRECT 的 InputStream 和 OutputStream 的实现。*

# codeigniter - 带有 CodeIgniter 电子邮件类的 MMS

> ID：15228413
> 
> 赞同：1
> 
> 时间：2013-03-05T16:00:41.920
> 
> 标签：codeigniter, email, format, mms

我目前正在开发一个应用程序，该应用程序将通过电子邮件或彩信向用户发送选定的优惠券。我遇到的问题是客户收到彩信时的显示。在 Android 上，图像显示为视频，而在 iOS 上，消息的所有内容都是错误的。

这是正在发送的标头的示例：

```
User-Agent: none
Date: Tue, 5 Mar 2013 10:45:12 -0500
From: 
Return-Path: 
Subject: =?utf-8?Q?Your_Requested_Coupon?=
To: ##########@txt.att.net
Reply-To: "webadministrator@domain.com" 
X-Sender: webadministrator@domain.com
X-Mailer: none
X-Priority: 3 (Normal)
Message-ID: <51361308f1651@domain.com>
Mime-Version: 1.0

Content-Type: multipart/mixed; boundary="B_ATC_51361309002f2"

This is a multi-part message in MIME format.
Your email application may not support this format.

--B_ATC_51361309002f2
Content-Type: multipart/alternative; boundary="B_ALT_51361308f3595"

--B_ALT_51361308f3595
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 8bit

--B_ALT_51361308f3595
Content-Type: text/html; charset=utf-8
Content-Transfer-Encoding: quoted-printable

--B_ALT_51361308f3595--

--B_ATC_51361309002f2
Content-type: image/jpeg; name="promo3.jpg"
Content-Disposition: attachment;
Content-Transfer-Encoding: base64

....
IMAGE ENCODING HERE
....

--B_ATC_51361309002f2-- 
```

和 CI 代码：

```
$this->email->from('webadministrator@domain.com');
$this->email->to('XXXXXXXXXX@PHONE_MESSAGE_CENTER.COM');
$this->email->subject('Your Requested Coupon');
$this->email->message($this->load->view('sms_email', '', TRUE));
$this->email->attach('/path/to/image.jpg'); //I've also tried passing a second param 'inline' to change the Content-Disposition to inline 
```

有谁知道是否可以使用内置的电子邮件类来完成此操作，还是我需要编写特定的标题才能正确显示图片消息？

彩信是否有适当的消息格式：文本或 html？，是否有适当的方法附加图像供 iOS 查看？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-24T20:14:08.827

尝试使用电子邮件地址从网络发送彩信，例如@mms.att.com，最终会让您被网络阻止。如果没有网络或彩信合作伙伴的支持，就没有解决此问题的干净方法。目前最好的解决方案是发送一条带有网络移动广告链接的短信。

顺便说一句，我建议使用像 cdyne 或 twilio 这样的提供商来发送短信（也不要尝试通过电子邮件地址发送短信！）您也可以尝试简单地连接 3g/4g 调制解调器并修改驱动程序以编程方式发送短信/彩信。去那个风险自负..

# php - 如何使用 PHP 从 SOAP Web 服务访问返回的对象

> ID：15228414
> 
> 赞同：0
> 
> 时间：2013-03-05T16:00:43.533
> 
> 标签：php, web-services, soap, soap-client

我正在尝试使用基于 SOAP 的 web 服务 uisng PHP。以下是示例代码。我需要知道/学习如何访问返回的对象元素？请注意我是 PHP 新手

```
 $url = 'http://www.webservicex.net/uszip.asmx?WSDL';
    $soap = new SoapClient($url, array(
        "trace"      => 1,      // enable trace to view what is happening
        "exceptions" => 0,      // disable exceptions
        "cache_wsdl" => 0) );
    try {
        $result = $soap->GetInfoByZIP(array('USZip' => '97219'));

        echo($result->$CITY);
        //print_r( $soap->GetInfoByZIP(array("USZip" => "97219")));
    } catch (SoapFault $e) {
        echo "Error: {$e->faultstring}";
    } 
```

我得到以下异常

```
Notice: Undefined variable: CITY 

Fatal error: Cannot access empty property 
```

但是，当我执行上面的注释行时，它会返回以下响应

```
 stdClass Object
(
    [GetInfoByZIPResult] => stdClass Object
        (
            [any] => <NewDataSet xmlns=""><Table><CITY>Portland</CITY><STATE>OR</STATE><ZIP>97219</ZIP><AREA_CODE>503</AREA_CODE><TIME_ZONE>P</TIME_ZONE></Table></NewDataSet>
        )

) 
```

所以这意味着正在返回数据，但我无法像在 .NET 中那样访问它

谁能帮助我如何在 PHP 中访问这个对象，为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T16:10:06.477

首先，您正在使用 $CITY 变量来访问 $result 属性并且您还没有定义它。

所以如果你想在“result”对象中获得“CITY”属性，你应该通过“$result->City”来完成。

根据你得到的结果 - 它是一个 xml 字符串，而不是对象。如果你想访问字符串这样做：

```
$result->GetInfoByZIPResult->any 
```

您可以使用 DomDocument 或 simplexml lib 加载字符串。

# java - MongoOperations “id” 选择器返回 null

> ID：15228417
> 
> 赞同：1
> 
> 时间：2013-03-05T16:00:54.193
> 
> 标签：java, spring, mongodb

我在 Spring-data-mongodb 1.1.1.RELEASE 中使用 MongoOperations 接口，任何使用“id”作为选择器的查询都返回 null：`Query.query(Criteria.where("id").is("5X")))`

但是，当我使用带有 Java 驱动程序的 Mongo 类并运行查询时，它按预期工作。IE：`dbCollection.find(Query.query(Criteria.where("id").is("5X")).getQueryObject()));`

根据我的研究，这应该适用于 MongoOperations 界面，并且选择器“id”不应与“_id”选择器冲突。有没有人遇到过这个问题，或者有人知道发生了什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T16:16:00.477

原因是没有`id`，但有`_id`- 试试看。在 mongodb 中，PK 默认字段具有“_id”名称。

如果您只需要通过 id 查找文档，如果您使用 Spring 或执行类似操作，为什么不使用类似`findById(id)`in mongoTemplate 的内容：

```
DBCollection coll = db.getCollection(getCollectionName());
DBObject searchById = new BasicDBObject("_id", new ObjectId(idString));
DBObject found = coll.findOne(searchById); 
```

在春天 mongo 尝试：

```
YourObject obj= mongoTemplate.findOne(new Query(Criteria.where("id").is("5X")),  YourObject.class, "yourCollectionName"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-11T08:26:59.080

它不喜欢不是文档 ID 的名为“id”的字段。使用 @Field("id") 注释将其映射到类中。

```
import org.springframework.data.mongodb.core.mapping.Field;
...
@Field("id") 
public int id; 
```

# git - 使用 git add --patch 以交互方式添加大块的一部分

> ID：15228419
> 
> 赞同：7
> 
> 时间：2013-03-05T16:00:57.817
> 
> 标签：git

`git add --patch`如果选择后显示的块`split`仍然太大，我如何才能以交互方式添加一些行/块的一部分？

```
@@ -2,9 +2,17 @@ Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed
 diam nonumy eirmod tempor invidunt ut labore et dolore magna
 aliquyam erat, sed diam voluptua. At vero eos et accusam et
 justo duo dolores et ea rebum. Stet clita kasd gubergren, no
+Ut wisi enim ad minim veniam, quis nostrud exerci tation
+ullamcorper suscipit lobortis nisl ut aliquip ex ea commodo
+consequat. Duis autem vel eum iriure dolor in hendrerit in
+vulputate velit esse molestie consequat, vel illum dolore eu
+feugiat nulla facilisis at vero eros et accumsan et iusto
+odio dignissim qui blandit praesent luptatum zzril delenit
+augue duis dolore te feugait nulla facilisi.
 sea takimata sanctus est Lorem ipsum dolor sit amet. Lorem
 ipsum dolor sit amet, consetetur sadipscing elitr, sed diam
 nonumy eirmod tempor invidunt ut labore et dolore magna
 aliquyam erat, sed diam voluptua. At vero eos et accusam et
 justo duo dolores et ea rebum. Stet clita kasd gubergren, no
 sea takimata sanctus est Lorem ipsum dolor sit amet. 
```

**更新**

由于 SO 用户[avivir](https://stackoverflow.com/users/1230403/avivr)正确注释“拆分”，可能是一个有效的选项。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-05T16:00:57.817

如果您只想添加一个大块的一部分，您可以从显示的菜单中选择编辑：

```
Stage this hunk [y,n,q,a,d,/,e,?]? 
```

这将启动您的编辑器，您可以在其中从将要添加到索引的大块中删除不需要的行。更改是虚拟的，即您的文件不会更改。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-05T18:35:28.287

使用 's'（拆分）选项`git add --patch`。

这将导致 git 将其拆分为更小的块。然后，您将收到每个新帅哥的菜单（这是原版的一部分），您可以在其中选择将其上演、进一步拆分等。

# java - 为什么在声明变量时建议尽可能使用最窄的范围？

> ID：15228426
> 
> 赞同：2
> 
> 时间：2013-03-05T16:01:16.010
> 
> 标签：java, variables, optimization

当声明**Java**变量时
为什么它建议尽可能使用最窄的范围
像这样

*它的推荐*

```
if (x>3) {
double d = someCalculation();
// ......
System.out.println("...");
} else {
// No use of d
System.out.println("...");
} 
```

*它不推荐*

```
double d = someCalculation();
if (x>3) {          
// ......
System.out.println("...");
} else {
// No use of d
System.out.println("...");
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T16:03:55.887

更容易阅读、维护和证明程序是正确的。

无论如何，[这个答案](https://stackoverflow.com/a/8803806/1339987)很好地涵盖了它。

还尝试搜索“限制变量范围”（[示例命中](http://www.nickhodges.com/post/Limiting-Scope.aspx)）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-05T16:05:18.297

一旦作用域执行，作用域内声明的所有变量都有资格进行垃圾收集，因此如果不再需要这些变量，则需要携带这些变量。

在您的情况下，一旦`if(...) {...}`执行块`d`就有资格获得 GC

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T16:04:49.810

因为当你声明一个变量时，它会被创建并在内存中保留一个空间。即使您不使用此变量，也会创建空间。仅在需要时声明变量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-05T16:03:44.520

因为需要它的范围必须声明它，而在不需要的地方它可能是一个不相关的变量。这个问题的答案在于：你为什么要把东西放在与它们无关的地方？我希望你通常不会——至少从你十几岁开始就不会。

想想当年地板上的所有衣服，没有一个妈妈知道哪些是干净的，哪些是脏的。她是把它们都洗干净，还是把它们都扔掉，还是什么？此类技术中的内存管理也是如此。正在使用什么？我可以移动什么？我可以处理什么？等等

在这些情况下保持干净的作用域等有很多好处，除了这只是一件很自然的事情。在某些情况下，范围内的代码片段可以被视为“工作单元”，如果重用变量（名称+类型），它还可以防止数据冲突。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-05T16:06:55.813

出于同样的原因，您不会为了得到这个答案而在您的 stackoverflow 个人资料上发布您来自任何国家/地区的电话号码、电子邮件地址和公民身份证号码。您以最简单的方式管理变量，以防止混乱、提高可读性并减少潜在的混乱。

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-03-05T16:05:21.303

同样在您的示例中，无论是否需要，您都将执行 someCalculation() 。效率不是很高。

# java - 许多实体的休眠性能

> ID：15228436
> 
> 赞同：0
> 
> 时间：2013-03-05T16:01:32.513
> 
> 标签：java, performance, hibernate, nhibernate

我有以下代码行：

> log4net.LogManager.GetLogger("m").Debug(DateTime.Now.ToString("hh:mm:ss.fff") + "Check-1");
> 
> 设置 setting = session.CreateQuery("from Setting s").UniqueResult< Setting>();
> 
> log4net.LogManager.GetLogger("m").Debug(DateTime.Now.ToString("hh:mm:ss.fff") + "Check-2");

上面的代码在不到毫秒的时间内执行（Check-1 和 Check-2 中的时间相同，它以毫秒为单位测量时间，代码中未显示使用的标准）。

但在这种情况下：

> IList<票>票= session.CreateQuery("从票").List<票>();
> 
> foreach(Ticket t in ticket)
> {
> t.Dosomething = 5;
> log4net.LogManager.GetLogger("m").Debug(DateTime.Now.ToString("hh:mm:ss.fff") + "Check-1"); 设置 setting = session.CreateQuery("from Setting s").UniqueResult< Setting>(); log4net.LogManager.GetLogger("m").Debug(DateTime.Now.ToString("hh:mm:ss.fff") + "Check-2");
> }

上面的代码是处理大量数据的巨大处理代码的简化版本，我需要在 foreach 循环中进行另一个查询。forech 循环中的查询在 500 毫秒内执行。票证集合包含 15000 行。

我已经重构了代码（在 foreach 中没有查询），但是我很感兴趣，为什么单独执行相同的查询不需要时间来执行，但是如果在首先加载大量实体​​之后执行，它会变得如此缓慢？

但是在上面的相同场景中，如果我对第二个查询使用不同的会话，它会立即执行。

当我需要在大量实体的 foreach 循环中执行另一个查询时，有什么建议如何处理这种情况？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T09:37:41.707

NHibernate 默认跟踪会话中加载的对象（一级缓存）。当进行查询时，NHibernate 会检查某些加载的对象是否有可能影响查询结果的更改——这些更改必须刷新到数据库中，以便查询可以返回正确的结果。加载的对象越多，此过程所需的时间就越长。

NHibernate 和 ISession 针对加载的对象数量相对较少进行了优化，这不是问题。

这些是提高批处理场景性能的一些技巧：

*   尝试将工作分成更小的部分，这些部分可以在单独的事务和会话中独立运行。

*   如果您已将工作分成更小的部分，则可以在战略点（在每个独立部分之后）使用`session.Flush()`和`session.Clear()`来刷新更改并将跟踪对象的数量保持在合理的水平。使用这种策略，所有部分都可以在同一个事务中运行。

*   查看`session.FlushMode`以禁用自动刷新查询。使用`FlushMode.Commit`或`Never`结合对 的显式调用`Flush()`。但是查询的结果可能不会反映之前在同一工作单元中执行的更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T16:05:05.893

在迭代票证之前，尝试使用投影将票证加载到 DTO 中。Hibernate 会跟踪会话中所有已加载的对象，直到它刷新，使用投影仅加载您需要的数据将意味着 Hibernate 不需要加载和跟踪对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T16:09:00.550

加入两个表并获得结果总是比获取第一个表记录、迭代然后获取第二个表记录更好。

给你更多的要求

# php - 如何停止域中子目录的虚 url

> ID：15228438
> 
> 赞同：0
> 
> 时间：2013-03-05T16:01:37.643
> 
> 标签：php, .htaccess, vanity-url

我创建了一个登录界面，用户可以在那里注册用户名。现在我想给每个用户一个虚 URL，比如 example.com/user。我为此使用 .htaccess 重写条件和 php。一切正常，除了当我尝试使用**example.com/chat/xx**之类的网址时，它会显示一个带有“xx”id 的个人资料页面。相反，它应该抛出一个 404 页面（这就是我想要的）。我希望只有当用户输入“example.com/user”而不是像“example.com/xyz/user”这样的子目录时，这个虚荣网址才有效。这可能吗 ？

htaccess——

```
RewriteEngine on
RewriteCond %{REQUEST_FILENAME}.php -f [OR]
RewriteCond %{REQUEST_FILENAME} -d 
RewriteRule ^([^\.]+)$ $1.php [NC]
RewriteCond %{REQUEST_FILENAME} >""
RewriteRule ^([^\.]+)$ profile.php?id=$1 [L] 
```

使用的php——

```
if(isset($_GET['id']))
// fetching user data and displaying it
else
header(location:index.php); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T16:53:09.200

然后你必须匹配一个没有斜杠的 URL`/`路径

```
RewriteEngine on
RewriteRule ^/?([^/\.]+)$ profile.php?id=$1 [L] 
```

此正则表达式`^([^\.]+)$`匹配所有*不*带点的内容`.`，例如

*   一种
*   bcd
*   你好吗
*   聊天/xx

但它不匹配

*   测试.php
*   你好世界
*   聊天/xx.bar

这个`^/?([^/\.]+)$`工作原理相同，除了它也不允许斜线`/`。即它允许所有内容，除了 URL 路径，包含点`.`或斜线`/`。

有关 Apache 正则表达式的更多详细信息，请参阅[词汇表 - 正则表达式 (Regex)](http://httpd.apache.org/docs/current/glossary.html#regex)和[Rewrite Intro - 正则表达式](http://httpd.apache.org/docs/current/rewrite/intro.html#regex)。

# spring - @ActiveProfile 和 spring.profiles.active

> ID：15228441
> 
> 赞同：4
> 
> 时间：2013-03-05T16:01:39.760
> 
> 标签：spring, properties, configuration, applicationcontext, profiles

这是我的 applicationContext 定义的一部分，用于检索一些属性。

```
 <!-- get some properties -->
<context:property-placeholder
        ignore-resource-not-found="false" ignore-unresolvable="false"
        location="classpath:/properties/${spring.profiles.active:test}/some.properties"/> 
```

如您所见，我让 spring.profiles.active 决定将读取哪些属性。我的测试注释为：

```
@ActiveProfile("integration") 
```

您猜对了，我的 spring bean 配置文件实际上与部署/测试应用程序的环境相匹配。我的位置属性仍然被解析为“/properties/test/some.properties”。这当然是因为 spring.profiles.active 在这种情况下似乎没有得到解决。

我怎样才能获得正确的属性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T17:05:25.327

这是因为系统属性**可能**`@ActiveProfiles`会激活活动配置文件（但如果它以另一种方式工作）。

像这样：

```
<beans profile="dev,prod,qa">
    <context:property-placeholder location="classpath:some.properties" ignore-unresolvable="true"/>
</beans>

<beans profile="test">
    <context:property-placeholder location="classpath:some-test.properties" ignore-unresolvable="true"/>
</beans> 
```

另外，您可以尝试更改 `location="classpath:/properties/${spring.profiles.active:test}/some.properties"` 为 `location="classpath:/properties/${spring.profiles.active}/some.properties"`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-06T11:12:37.723

见票：[https ://jira.springsource.org/browse/SPR-8982#comment-88498](https://jira.springsource.org/browse/SPR-8982#comment-88498)

有人已经提出了这个要求：

> 通过“-Dspring.profiles.active”或其他 systemProperty 从命令行覆盖由 test 在运行时指定的 @ActiveProfile 的选项

我的评论：

> 那或者它应该设置属性spring.profiles.active。

# html - 使用 wget 将外部网站编译为 .chm

> ID：15228442
> 
> 赞同：0
> 
> 时间：2013-03-05T16:01:39.727
> 
> 标签：html, wget, chm

有一个网站，特别是[http://thisquantumworld.com](http://thisquantumworld.com)

这是一个带有相互关联链接的纯文本站点。我想把这个网站上的内容作为阅读材料。我可以（而且我确实）使用 wget 将网站下载为 html。

但是，最好将其作为 .chm 文件。在这种情况下，它也很容易再分发。

**谁能建议一种将网站下载为 .chm 的方法（也许使用 wget）？**我没有使用 .chm 文件的经验，也不知道它们是如何工作的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-23T03:05:47.900

为此目的（将网站转换为 chm），我使用 Windows 免费软件工具[Web2Chm](http://webtochm.converterfreeware.com/my/web2chm-setup.exe)。

它工作得很好，我几乎可以肯定——它也可以在 Linux 中的 Wine 下工作。

如果您只想使用 wget，我认为您的任务可以使用 python 脚本来解决。

# android - 如何将屏幕旋转锁定到当前状态

> ID：15228448
> 
> 赞同：1
> 
> 时间：2013-03-05T16:01:52.820
> 
> 标签：android, screen-orientation

我正在尝试将屏幕方向锁定到调用应用程序时的位置，以免在屏幕旋转时崩溃（是的，我使用过

> android:configChanges="方向|keyboardHidden"

并且它在低 Android 版本上运行良好，但似乎对于更高版本应该是

> android:configChanges="方向|keyboardHidden|screenSize"

并且较低的android版本不支持screenSize参数）。

所以，我试过这个解决方案（1）：

> setRequestedOrientation (getResources().getConfiguration().orientation);

还有另一个（2）：

> setRequestedOrientation ( getScreenOrientation() );

在哪里，

```
public int getScreenOrientation()
{
    Display getOrient = getWindowManager().getDefaultDisplay();
    int orientation = Configuration.ORIENTATION_UNDEFINED;

        if(getOrient.getWidth() < getOrient.getHeight()){
            orientation = Configuration.ORIENTATION_PORTRAIT;
        }else { 
             orientation = Configuration.ORIENTATION_LANDSCAPE;
        }

    return orientation;
} 
```

并且，在两种情况下（1 和 2），结果都是：当我以纵向启动应用程序时，它工作正常。屏幕方向锁定为纵向模式。但是，当我在横向进行时，它会不断改变方向。

我做错了什么？提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T16:25:42.977

您的方向配置的问题在于，即使在启动应用程序时设备处于横向，应用程序仍将以纵向模式创建，然后在需要时切换到横向。一般来说，除非它是一个游戏，否则你不应该真的强迫方向。您应该修复应用程序，使其不会因方向更改而崩溃。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T16:07:36.423

难道你不能做一个常数，`Configuration.ORIENTATION_PORTRAIT`只是`getOrient`在使用方法2时将它与它进行比较。然后如果它们相等，则将其设置为纵向，否则将其设置为横向。

# javascript - Javascript 获取浏览器的默认字体大小

> ID：15228451
> 
> 赞同：2
> 
> 时间：2013-03-05T16:02:04.913
> 
> 标签：javascript, browser, fonts

我正在尝试获取我的浏览器用来显示警报、提示等的字体大小和字体系列。所以我这样做了：
alert(document.body.style.fontFamily); 但它向我显示了一个空白警报。我哪里错了？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-05T16:38:15.090

好吧，我同意 Kolink 上面所说的，但您可能还想尝试一下：

```
<body id="body">
<script>
var theCSSprop = window.getComputedStyle(document.body,null).getPropertyValue("font-family");
console.log(theCSSprop); // output: serif
</script>
</body> 
```

使用上面的代码，打开 FF 并更改 Proportional 设置后，您可能会看到输出也发生了变化。玩得开心 ：）

![在此处输入图像描述](../Images/65da1ea503aca8aa6c290f3783ed8890.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T16:03:27.763

诸如警报（确认、提示）框之类的控件由操作系统呈现，而不是由浏览器呈现。你无法控制这一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T16:08:40.937

`***SomeElement***.style.***SomeStyle***``style`只选择元素属性中定义的样式。因此，如果您没有特别拥有，`<body style="font-family:blah">`那么您将没有结果。

可以使用 来从样式表中获取样式`getComputedStyle`，但这需要在旧版 IE 中使用 shim：

```
window.getComputedStyle = window.getComputedStyle || function(e) {return e.currentStyle;}; 
```

此外，这并不是您真正想要的。

理论上，您可以像这样获得网页上的默认文本样式：

```
window.getComputedStyle(document.createElement('div')).fontFamily; 
```

但是，这不一定（并且通常不是）与警报和提示中使用的字体相同。这些是由操作系统而不是浏览器呈现的，因此很遗憾无法知道用户是否在他们的设置中更改了字体。如果有帮助，我相信此类框的默认设置是`Arial 10pt`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-05T17:21:43.353

您不能直接测量对话框，但可以使用**关键字**将元素的字体设置为浏览器系统字体并检查该元素。

您可以使用 style="font:message-box" 动态创建隐藏元素，此示例使用页面的现有 css：

```
<!doctype html>
<html lang="en">
<head>
<meta charset= "utf-8">
<title>Small Page</title>
<style>
.message{border:2px black ridge;font:message-box}
</style>

</head>
<body>

<div class="message">

<p><strong>"Here's another fine mess you've gotten us in."- 
        <em> Oliver Hardy</em></strong></p>
</div>

<script>
onload= function(){
    var who= document.getElementsByTagName('div')[0],props;
    if(window.getComputedStyle){
        who= getComputedStyle(who, ''),
        props= ['font-family', 'font-size', 'font-weight', 
        'line-height'].map(function(itm){
            return itm+': '+who.getPropertyValue(itm);
        });     
    }
    else if(who.currentStyle){//IE<9
        who= who.currentStyle;
        props= ['fontFamily', 'fontSize', 'fontWeight',
        'lineHeight'].map(function(itm){
            return itm+': '+ who[itm];
        });
    }
    alert(props.join('\n'));
}

if(!Array.prototype.map){//IE<9
    Array.prototype.map= function(fun, scope){
        var T= this, L= T.length, A= Array(L), i= 0;
        if(typeof fun== 'function'){
            while(i<L){
                if(i in T){
                    A[i]= fun.call(scope, T[i], i, T);
                }
                ++i;
            }
            return A;
        }
    }
}

</script>
</body>
</html> 
```

# ios - NSFetchedResultsController 在多个部分中有项目？

> ID：15228456
> 
> 赞同：0
> 
> 时间：2013-03-05T16:02:21.227
> 
> 标签：ios, objective-c, core-data, nsfetchedresultscontroller

我有一个托管对象来表示地图上的一个点。这些点有零多类型。我还想显示一个分段的表格视图。当类型是 MapPOI 对象上的单个值时，我使用 NSFetchedResultsController 进行此操作。但是现在类型是在不同的对象中，与“MapPOI”之间的关系称为“类型”，我该如何编写查询（可以吗？）

原来的：

```
- (NSFetchedResultsController *)newFetchedResultsControllerWithSearch:(NSString *)searchString
{
    NSFetchRequest *request = [NSFetchRequest fetchRequestWithEntityName:@"MapPOI"];

    if(searchString.length)
    {
        request.predicate = [NSPredicate predicateWithFormat:@"name CONTAINS[cd] %@", searchString];
    }
    request.sortDescriptors = [NSArray arrayWithObjects:[NSSortDescriptor sortDescriptorWithKey:@"type" ascending:YES ],[NSSortDescriptor sortDescriptorWithKey:@"name" ascending:YES ],nil ];

    NSFetchedResultsController *aFetchedResultsController = [[NSFetchedResultsController alloc] initWithFetchRequest:request
                                                                                                managedObjectContext:self.campus.managedObjectContext
                                                                                              sectionNameKeyPath:@"type"
                                                                                                       cacheName:nil];
    aFetchedResultsController.delegate = self;

    NSError *error = nil;
    if (![aFetchedResultsController performFetch:&error])
    {
       NSLog(@"Error performing institution fetch with search string %@: %@, %@", searchString, error, [error userInfo]);
    }

    return aFetchedResultsController;
} 
```

我试过类似的东西

```
NSFetchedResultsController *aFetchedResultsController = [[NSFetchedResultsController alloc] initWithFetchRequest:request
                                                                                            managedObjectContext:self.campus.managedObjectContext
                                                                                              sectionNameKeyPath:@"types.name"
                                                                                                       cacheName:nil]; 
```

但这导致

```
Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: 'Invalid to many relationship in setPropertiesToFetch: (types.name)' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T17:35:54.643

非常灵活，`NSFetchedResultsController`可以与各种视图一起使用，而不仅仅是表视图。

`sectionNameKeyPath`当然是错的。它显然必须是一对一的关系。假设一个人`MapPOI`只能有一种类型，那么关键路径应该是`@"type.name"`.

但是，如果一个`MapPOI`可以有多种类型，则可以执行以下操作：

获取类型实体而不是 POI 实体。您不需要部分键路径。现在`objectAtIndexPath:indexPath.row`将获取一个`Type`托管对象。

对于节数，请使用

```
self.fetchedResultsController.fetchedObjects.count 
```

对于章节标题，请使用

```
[[self.fetchedResultsController.fetchedObjects objectAtIndex:section] name]; 
```

对于部分使用的行数

```
Type *type = [self.fetchedResultsController.fetchedObjects objectAtIndex:section];
type.mapPOIs.count; 
```

并且应该很明显如何用`MapPOI`实体填充单元格。

# java - 以金字塔形式打印字符串

> ID：15228457
> 
> 赞同：2
> 
> 时间：2013-03-05T16:02:25.050
> 
> 标签：java, string

我喜欢以 Pyramid 格式逐个字母地打印作为用户输入的字符串。例如 - 当用户将输入作为“字符串”提供时，输出应该是：

```
 s
    s t
   s t r
  s t r i
 s t r i n
s t r i n g 
```

我试过一个小程序，但它没有以金字塔形式排列单词。该程序是

```
 import java.io.*;
    import java.util.Scanner;
    import java.lang.String;

    public class Mainer {
    public static void main(String args[]){
       try
       {
           Scanner sc = new Scanner(System.in);
           String s;
           int l;
           System.out.println("Enter the String : ");
           s = sc.nextLine();
           l = s.length();
           for(int i=0; i<l;i++)
           {

               for(int j=0;j<i;j++)
               {
                   System.out.printf("%c ",s.charAt(j));
               }
               System.out.printf("%c\n",s.charAt(i));
           }         

       }
       catch(Exception e)
       {
           System.err.println(e);
       }
    }
} 
```

上面程序的输出是（当输入字符串时）输入字符串：字符串

```
s
s t
s t r
s t r i
s t r i n
s t r i n g 
```

你能把它安排成第一个例子吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T16:07:05.893

所以你的程序需要做的是用空格填充文本。在您的第一个示例中，您的第一个输出实际上是一个字母，但与最后一个输出的中间字母的位置相同。

所以伪代码的第一个输出看起来像：

```
String padding = (text.length/2) number of spaces;
// The padding on the left.
Print padding
// The letter to print.
Print first letter 
```

请记住，填充的长度将随着您在该迭代中输出的文本的长度而变化。但我不会告诉你。那会毁了所有的乐趣:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-05T16:15:59.623

在输出之前，您需要在字符串前面添加字符串长度的一半作为空格数（填充）。但是每次迭代时减去 1 个空格以创建形状。

或者另一种说法是，您正在获取原始字符串的长度并打印出您未打印的字符的空格数。

```
for(int x = 0; x < l - i; x++) {
    System.out.print(" ");          
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T16:05:57.483

只需编写另一个 for 循环来打印空格

```
for(int i=0; i<l;i++)
{

    for(int j=0; j<l-(i+1); j++)
    {
        System.out.print(" ");
    }

    for(int j=0;j<i;j++)
    {
        System.out.printf("%c ",s.charAt(j));
    }
    System.out.printf("%c\n",s.charAt(i));
} 
```

作为记录，您可能需要对此进行调整。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-05T16:25:42.767

**这是作弊吗？（只有一个循环）**

```
String s = "string";
        int len = s.length();           
        String tmp = "";
        for (char c : s.toCharArray()) {
            tmp += tmp.length() > 0 ? " " + String.valueOf(c) : String.valueOf(c);
            System.out.printf("%" + (len + tmp.length() - 1) + "s\n", tmp);
            len--;
        } 
```

输出：

```
 s
    s t
   s t r
  s t r i
 s t r i n
s t r i n g 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-05T16:15:17.657

这应该够了吧

```
import java.io.*;
import java.util.Scanner;
import java.lang.String;

public class Mainer {
public static void main(String args[]){
   try
   {
       Scanner sc = new Scanner(System.in);
       String s;
       int l;
       System.out.println("Enter the String : ");
       s = sc.nextLine();
       l = s.length();
       for(int i=0; i<l;i++)
       {
           int padding = s.length() - i;
           if (padding> 0) {
               System.out.printf("%" + padding + "s", " ");
           }
           for(int j=0;j<i;j++)
           {
               System.out.printf("%c ",s.charAt(j));
           }
           System.out.printf("%c\n",s.charAt(i));
       }         

   }
   catch(Exception e)
   {
       System.err.println(e);
   }
}
} 
```

# c# - 将 LINQ 表达式转换为没有 DB 上下文的 SQL 文本

> ID：15228460
> 
> 赞同：17
> 
> 时间：2013-03-05T16:02:30.700
> 
> 标签：c#, .net, sql, linq, expression-trees

LINQ to SQL 或 LINQ to Entities 已经能够将 LINQ 转换为 SQL 文本字符串。但我希望我的应用程序在不使用 db 上下文的情况下进行转换——这反过来意味着一个活动的数据库连接——这两个提供者都需要。

我想将 LINQ 表达式转换为等效的 SQL 字符串 for `WHERE`and`ORDER BY`子句，而不依赖于 DB 上下文，以使以下存储库接口工作：

```
public interface IStore<T> where T : class 
{
     void Add(T item);
     void Remove(T item);
     void Update(T item);
     T FindByID(Guid id);

     //sure could use a LINQ to SQL converter!
     IEnumerable<T> Find(Expression<Func<T, bool>> predicate);
     IEnumerable<T> FindAll();
} 
```

### 问题

它主要是我感兴趣的表达式树遍历和转换。有人知道我可以合并以在这种自定义上下文中使用的现有库（nuget？）吗？

因为它是我已经建立了我自己的工作“LINQ 转换为 SQL 文本”工具，类似于在我上面的存储库中工作的这个[表达式树到 SQL 示例。](http://blogs.msdn.com/b/mattwar/archive/2007/07/31/linq-building-an-iqueryable-provider-part-ii.aspx)它允许我编写如下代码：

```
IRepository<Person> repo = new PersonRepository();
var maxWeight = 170;
var results = repo.Find(x => (x.Age > 40 || x.Age < 20) && x.Weight < maxWeight); 
```

但是我的代码和该示例是原始的（并且该示例本身依赖于 LINQ to SQL db 上下文）。例如，两者都不处理“LIKE”语句的生成。

我不期望或不需要处理所有可能的 LINQ 查询的生成器工具。例如，我不担心处理和生成连接或包含。事实上，再过 20 个小时，我自己的自定义代码可能会涵盖我关心的所有情况（主要是“WHERE”和“ORDER BY”语句）。

但同时我觉得我不应该编写自己的自定义代码来做到这一点。如果我坚持自己编写，那么如果有人能指出我可以反映和模仿的特定类（NHibernate、EF 等），我仍然会感兴趣。我问的是要查看的特定类，如果你知道的话，因为我不想花几个小时筛选一个大型工具的代码，只是为了找到我需要的部分。

这并不重要，但如果有人想知道我为什么不简单地使用 LINQ to SQL 或 LINQ to Entities ......对于我的特定应用程序，我只是更喜欢使用诸如[Dapper](https://code.google.com/p/dapper-dot-net/)之类的工具。

**用例** 无论是我自己完成了工具的构建，还是找到了第 3 方库，以下是“LINQ to SQL 文本字符串”有用的原因：

*   我在方法中键入的谓词`IRepository.Find`具有智能感知和基本的编译时检查。
*   我提出的 IStore 接口可以实现用于 DB 访问或 Web 服务访问。澄清一下，如果我可以将 LINQ“WHERE/ORDER BY”谓词转换为 SQL“WHERE/ORDER BY”子句，那么......
    *   Dapper 可以直接使用 SQL 字符串。
    *   与 LINQ 表达式不同，SQL 字符串可以发送到 WCF 服务以用于直接 DB 访问（它本身可能不使用 Dapper）。
    *   [WCF 服务可以使用自定义代码](http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx)将 SQL 字符串反序列化回 LINQ 语句。 [Eric Lippert 对此发表了评论](https://stackoverflow.com/a/6443868/284758)。
*   UI 可以使用 IQueryable 机制动态生成谓词以提供给存储库

简而言之，这样的工具有助于根据 DDD 实现存储库的“规范”或“查询对象”概念，并且不会依赖 EF 或 LINQ to SQL。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T18:59:00.697

正确地执行此操作确实非常复杂，尤其是如果现在，您似乎对表达式树（`IQueryable`用于表示查询的内容）了解不多。

但是，如果您真的想开始（或者只是想知道需要做多少工作），请查看 Matt Warren 的 17 部分系列[*Building an IQueryable provider*](http://blogs.msdn.com/b/mattwar/archive/2008/11/18/linq-links.aspx)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-07-03T03:40:33.420

我可以确认这是一项相当大的工作量，只适合最有经验的 .NET 开发人员。精通C#，具有多种语言的经验，包括T-SQL是必须的。必须非常精通 C#（或 VB.NET）和 T-SQL，因为他们必须将使用前者的翻译器编写到后者中。此外，这属于元编程领域，它被认为是计算机科学的一个相当先进的分支。涉及很多抽象思维。层层叠叠的抽象概念。

如果所有这些都不是障碍，那么这个练习实际上会非常愉快和有益，至少在第一个月左右。我注意到这些提供商的一个常见问题是，一开始的不灵活和有问题的设计选择导致后来的困难和hacky修复等。尽可能提前计划，清楚地了解整个过程，不同阶段，组件正确识别层并且担心会使开发它变得容易得多。我在一个提供者中看到的最大错误是——未能将输出查询分解为多个部分——选择、来自、位置和排序依据。每个部分都应始终由其自己的对象表示，然后在最后组合在一起。我在关于如何在下面链接的系列中编写提供程序的端到端教程中解释了这种方法。包含一个示例项目，带有简化/教程变体和从头开始为项目制作的完整版本。找时间写这篇文章本身就是一个挑战。

*   如何在 C# 中编写 LINQ to SQL 提供程序：
    *   [介绍](http://www.devbible.com/post/15/How_to_write_a_LINQ_to_SQL_provider_in_C_sharp_and_NET_40_part_1_of_4/)
    *   [表达访客](http://www.devbible.com/post/16/How_to_write_a_LINQ_to_SQL_provider_in_C_sharp_and_NET_40_part_2_of_4-expression_visitor/)
    *   [Where 子句访问者](http://www.devbible.com/post/17/How_to_write_a_LINQ_to_SQL_provider_in_C_sharp_and_NET_40_part_3_of_4-where_clause_visitor/)
    *   [编译表达式树](http://www.devbible.com/post/18/How_to_write_a_LINQ_to_SQL_provider_in_C_sharp_and_NET_40_part_4_of_4-compiling_expression_trees/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-07-12T03:14:23.120

这是我不久前简要研究过的事情。您可能想查看[http://iqtoolkit.codeplex.com/](http://iqtoolkit.codeplex.com/)和/或[http://expressiontree.codeplex.com/](http://expressiontree.codeplex.com/)的想法。正如其他人所提到的，如果您不将范围限制在您真正需要的最小功能集，则构建 Linq 查询提供程序绝非易事。

如果您的目标与根据 DDD 的存储库的“规范”或“查询对象”概念相关，那么这可能不是最好的方向。与 CRUD 之类的技术相关抽象不同，关注领域行为可以表达的方式可能更有效率，而对技术相关抽象的直接依赖最少。正如 Eric Evans 最近所讨论的，他对在最初描述 DDD 时对技术构建块（例如存储库）的关注感到遗憾。

# java - 下载 Excel 文件后重新加载 JSP 页面

> ID：15228462
> 
> 赞同：2
> 
> 时间：2013-03-05T16:02:33.673
> 
> 标签：java, javascript, excel

我的 JSP 页面中有一个链接，用户使用它来下载 Excel 文件。当用户单击该链接时，控制器会转到一个 java 脚本函数，在该函数中我会显示一个动态图像（如进度条），然后它将被重定向到动作类。执行 java 代码后，会出现一个弹出窗口，要求用户打开/保存文件。由于页面没有刷新，进度条一直在运行，我无法隐藏它。

有谁知道如何使用 Javascript 解决这个问题，因为我对 Jquery 没有太多想法。

提前致谢。

```
function generateRnDFootPrint(){ 

progressBar.showBar();     // progress bar appears 

location.href='<%= contextPath %>/saveMTP.do?method=getRnDFootPrintReport&orgCode=<%=orgCode%>&orgId=<%=orgId%>'; 

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T16:47:22.707

试试下面的......我只是在函数的末尾添加一行：

```
function generateRnDFootPrint(){ 

progressBar.showBar();     // progress bar appears 

location.href='<%= contextPath %>/saveMTP.do?method=getRnDFootPrintReport&orgCode=<%=orgCode%>&orgId=<%=orgId%>'; 

setTimeout(function(){progressBar.hideBar();},2000);

} 
```

我希望它能解决问题......如果它没有，那么你应该有一个隐藏栏并调用它的函数，就像在注释行中一样；）

萨卢多斯。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T16:18:22.120

你可以做的是给一个`id`下载链接

```
<a id="download-link" href="your_value_here">Download Link</a> 
```

在 JavaScript 中

```
var link=document.getElementById("download-link");
link.onclick=function(){
  progressbar.hide();
} 
```

如果你想要 jQuery 版本

```
$("#download-link").click(function(){
   progressbar.hide();
}); 
```

# reporting - 如何在 QlikView 中获取两个 aggr 的 aggr？

> ID：15228463
> 
> 赞同：0
> 
> 时间：2013-03-05T16:02:36.423
> 
> 标签：reporting, business-intelligence, qlikview

如果我想从成员 ID 聚合的两个状态中查找列的最大值，这应该有效吗？

```
=Aggr(
    MaxString(
        Aggr(NODISTINCT MinString({[State1]}DATE_STRING),MBR_ID)
        +
        Aggr(NODISTINCT MinString({[State2]}DATE_STRING),MBR_ID)
) , MBR_ID) 
```

所以如果我有这些数据：

```
MBR ID          DATE_STRING
1               20120101
1               20120102
1               20120103 
```

State1 选择了 20120101，State2 选择了 20120103，我的表达式将为成员 1 返回 20120103。

谢谢！

**编辑**：在 SQL 中，这看起来像：

```
WITH MinInfo (DATE_STRING, MBR_ID)
AS (SELECT MIN(DATE_STRING), MBR_ID FROM Table WHERE TYPE IN ('State1', 'State2') GROUP BY MBR_ID, TYPE)
SELECT MAX(DATE_STRING) DATE_STRING, MBR_ID FROM MinInfo GROUP BY MBR_ID 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-16T14:56:35.623

如果您将其转换为实际日期字段，则更容易实现您的目标假设您使用的是 MBR_ID 为维度的图表，如果您想要最大日期（最新日期），您可以执行以下操作：

```
=nummax(Max({[State1]}DATE_STRING),Max({[State2]}DATE_STRING)) 
```

要转换为日期，您可以使用此函数：

`date#(DATE_STRING,'[text format of the date]')`

（对我来说，日期格式看起来像 YYYYMMDD，但如果它的日期是月份，你会使用 YYYYDDMM）

我建议您在脚本中对其进行格式化，这样您每次需要使用该日期时就不必担心它。

# java - 如何使进度条的进度摆动？

> ID：15228464
> 
> 赞同：2
> 
> 时间：2013-03-05T16:02:37.050
> 
> 标签：java, swing, concurrency, event-dispatch-thread, jprogressbar

我想创建一个在设备中安装文件的应用程序。但是我在实现进度时遇到了问题，我在框架中使用来调用要安装的类的代码如下所示，execShellCmd 是调用安装到所有设备的方法。value 是 Install 类给出的静态值。我想实现一个用于安装和评估的进度条，以便提供安装进度。

```
private void jButton2ActionPerformed(java.awt.event.ActionEvent evt) {
     Thread t;  
        t = new Thread(){   
        private int postion;
     public void run(){  
        Install install = new Install();
        int position = 0;
        String fileName = directory;
        String shellCommand = fileName;

       // for (int position =0; postion < 105;position +5) {
                jProgressBar1.setValue(Install.value);
                try {
                        Thread.sleep(500);
                } catch (InterruptedException e) {
                }
                position += 5;
        //}
        install.execShellCmd(shellCommand);
        //jTextArea1.setText(error.err.toString());
        }

        };
        t.start();
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T16:29:19.517

As shown [here](https://stackoverflow.com/a/15121864/230513), you can use `ProcessBuilder` to execute your script. Parse the combined streams, obtained from `getInputStream()`, to assess the script's actual progress. Use that information to condition your [`JProgresBar`](http://docs.oracle.com/javase/tutorial/uiswing/components/progress.html). To preserve liveness in the GUI, do this in the `doInBackground()` method of a [`SwingWorker`](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/worker.html), from which you can invoke `setProgress()`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T18:27:49.580

嗯..据说这种线程方式不适合JProgressBar。相反，移动`Timer`. 我在线程内部使用 JProgressBar 时遇到了同样的问题。使用以下链接获取更多信息，它也有工作示例

[http://www.coderanch.com/t/566728/GUI/java/JProgressBar-Napkin-feel-working](http://www.coderanch.com/t/566728/GUI/java/JProgressBar-Napkin-feel-working)

是的，看看我在下面的回答

[更新jProgressBar的方法是什么？](https://stackoverflow.com/questions/10587931/what-is-the-ways-updating-jprogressbar)

# ruby-on-rails - Rails：基于布尔属性对数据进行排序和过滤

> ID：15228466
> 
> 赞同：1
> 
> 时间：2013-03-05T16:02:45.487
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2

我有一个“项目”的基本模型，目前只有属性名称：字符串，活动：布尔。在索引视图上，我希望能够拥有三个链接：活动项目、非活动项目和所有项目。这些链接将根据 :active 布尔值的状态显示相应的项目。最初，我通过提供如下链接参数来设置视图：

```
link_to "Active Projects", {:action => 'index', :active => true} 
```

然后在控制器中：

```
if params[:active] == "true"
  @projects = Project.find(:all, :conditions => {:active => true})
elsif params[:active] == "false"
  @projects = Project.find(:all, :conditions => {:active => false})
else
  @projects = Project.all 
```

这似乎有点麻烦，特别是因为将来我想要多个过滤器，比如截止日期和客户端。什么是实现高级排序/过滤操作的好方法/gem，而不用大量代码填充控制器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T16:25:49.460

您可以将参数构造为哈希，并将其传递给条件：

```
# example:
params = {
  :filters => {
    :active => true,
    :name => 'Boby',
    # etc...
  }
}

filters = params[:filters]
@projects = Project.where(filters) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T16:24:14.357

我会推荐使用`where`语句..还有你的代码重构：

```
@projects = Project.all
@projects = @projects.where(active: params[:active]) if params[:active].present? 
```

然后，如果存在额外的参数，您可以继续堆叠项目，如下所示：

```
@projects = @projects.where(awesome_sauce: params[:awesome_sauce]) if params[:awesome_sauce].present? 
```

# statistics - 如果将两个分类器用于不一致的数据，如何以适当的方式合并它们

> ID：15228471
> 
> 赞同：2
> 
> 时间：2013-03-05T16:03:15.580
> 
> 标签：statistics, machine-learning

我的数据集由两个不相交的子集组成。有两个具有置信度度量的不同分类器，每个分类器只能在一个确定的子集上工作。我需要提高我的系统对整个数据的准确性，所以我需要“组合”这些分类器的置信度。关键是分类器的尺度可能有很大的不同，例如，在一个置信水平上，错误和接受可能会有很大的不同。也许有一种方法可以将两个分类器的置信度转换为某种统一的尺度？准确度是指在固定错误率（例如，数据集的 10%）下最大化接受水平

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T16:27:21.650

如何制作第三个分类器，它将利用你的 2 个分类器（输入），它的输出应该是你所期望的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T08:34:16.777

如何通过提升组合分类器。题为“Boosting Localized Classifiers in Heterogeneous Databases”的论文给出了更多细节。

# ios - 首次加载后如何在 UICollectionView 中选择一些项目？

> ID：15228472
> 
> 赞同：13
> 
> 时间：2013-03-05T16:03:15.800
> 
> 标签：ios, xcode, uicollectionview, uicollectionviewcell

我试着写

`[self collectionView:myCollectionView didSelectItemAtIndexPath:selectedIndexPath]`

和 UICollectionViewCell 在 vi​​ewDidLoad 中的 selected=YES，它确实实现了该方法`didSelectItemAtIndexPath`，但未选择单元格。

我在 UICollectionViewCell 子类的`(void)setSelected:(BOOL)selected`. 加载视图后，手动选择功能起作用。但我不能让它在视图第一次加载后自动选择一些项目。

我尝试在以下位置编写代码：

`- (UICollectionViewCell *)collectionView:(UICollectionView *)collectionView cellForItemAtIndexPath:(NSIndexPath *)indexPath`

和

`- (void)collectionView:(UICollectionView *)collectionView didSelectItemAtIndexPath:(NSIndexPath *)indexPath`，都不好。

我发现它首先运行`viewDidLoad`，`didSelectItemAtIndexPath`然后`cellForItemAtIndexPath`，似乎我无法在`indexPath`（我知道的）之前获取单元格`cellForItemAtIndexPath`，因为在此之前该单元格不存在。那么如何在`UICollectionView`第一次加载后选择一些项目呢？

对不起我糟糕的英语。提前致谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-05T16:10:24.317

不确定，如果您的问题正确，但这是一个可能的解决方案：

在例如`viewWillAppear:`做

```
[self.collectionView reloadData];
NSIndexPath *selection = [NSIndexPath indexPathForItem:THE_ITEM_TO_SELECT 
                                             inSection:THE_SECTION];
[self.collectionView selectItemAtIndexPath:selection 
                                  animated:YES 
                            scrollPosition:UICollectionViewScrollPositionNone]; 
```

请记住，以编程方式调用“selectItemAtIndexPath”不会调用相关的委托方法；如果需要，您必须在代码中调用它们。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2016-03-23T18:40:29.940

在我的情况下`selectItemAtIndexPath`没有效果之后`reloadData`，所以我不得不在完成块中调用它`performBatchUpdates`：

```
collectionView.dataSource = ...
collectionView.delegate = ...

let indexPath = ...

collectionView.performBatchUpdates(nil) { _ in
  collectionView.selectItemAtIndexPath(indexPath, animated: false, scrollPosition: .None)
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2017-05-06T16:17:33.230

斯威夫特 3

实现这个覆盖函数，你的 collectionview 是在哪里创建的。假设我们有 1 个部分 1 行，例如 Instagram 故事。

```
 override func viewDidAppear(_ animated: Bool) {
        // Auto Select First Item
        self.myCollectionView.performBatchUpdates(nil) { _ in
            self.myCollectionView.selectItem(at: IndexPath(item: 0, section: 0), animated: false, scrollPosition: [.centeredHorizontally])
            self.collectionView(self.myCollectionView, didSelectItemAt : IndexPath(item: 0, section: 0))
        }
    } 
```

# ios - UIKit 的 contentScaleFactor 的 CoreGraphics 等价物是什么？

> ID：15228473
> 
> 赞同：0
> 
> 时间：2013-03-05T16:03:20.547
> 
> 标签：ios, xcode, core-graphics, quartz-graphics, quartz-2d

UIKit 的 contentScaleFactor 的 CoreGraphics 等价物是什么？

我正在使用 UKit PDF 创建功能创建 PDF，它允许渲染到 PDF 上下文。但是，我需要降低生成的 PDF 的质量。我们已经使用 UIKit 的 contentScaleFactor 属性实现了这一点（渲染到 UIView），它是图形空间和像素空间之间的转换因子。但是，我需要在没有 UIView 的情况下将这种魔法和巫术应用于 CGContextRef，但我不知道我应该做什么。

任何其他关于如何降低 PDF 质量的建议将不胜感激。

谢谢

编辑：我的输入是 PDF 文档。我正在使用 CoreGraphics 从另一个 PDF 重新创建 PDF，但该过程可能会很慢，具体取决于某些 PDF 页面的图形强度。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T16:32:31.567

创建上下文时，请指定原始 PDF 的一小部分的宽度和高度：

```
 CGContextRef context = CGBitmapContextCreate(NULL, 
                                    pdfSize.width / 4, 
                                    pdfSize.height/4, 
                                    8,                      
                                    0,   
                                    colorSpace, 
                                    kCGImageAlphaPremultipliedLast | kCGBitmapByteOrder32Big); 
```

然后在此处根据需要将其缩小。然后你可以这样做：

```
CGImageRef cgImage = CGBitmapContextCreateImage(ctx);
UIImage *reflectionImage = [UIImage imageWithCGImage:cgImage scale:4.0 orientation:up]; 
```

或者您可以在新的放大上下文中绘制 cgImage 图像，这取决于您要执行的操作。

# html - 如何在 HTML 中创建布局，如附加链接中所示

> ID：15228474
> 
> 赞同：-4
> 
> 时间：2013-03-05T16:03:24.537
> 
> 标签：html, layout

伙计们，我正在设计我将发布的网站。我看到了微软 Surface 的这个页面[http://www.microsoft.com/Surface/en-US 。](http://www.microsoft.com/Surface/en-US)我想知道他们是如何制作这些彩色布局的。我尝试使用`<p></p>`属性创建布局，而不是在其中写入任何文本，使文本颜色和背景颜色与使用填充属性扩展的颜色相同，`<p></p>`但问题仍然是边缘周围有空格的页面。如果您有任何建议，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T16:07:34.373

不确定我是否完全理解，但从你所说的可能是正文边距和填充没有设置为零

```
<style>

body{
  margin:0px;
  padding:0px;
}

</style> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T16:12:51.883

用于`<div>`创建彩色部分，对于内部，您可以使用表格（避免）或无语义的流体网格系统。

# email - Postfix - 限制端口 25 只接收来自邮件服务器的邮件

> ID：15228476
> 
> 赞同：1
> 
> 时间：2013-03-05T16:03:29.263
> 
> 标签：email, postfix-mta, sasl

我已经配置了我的后缀，以便我服务器下的用户将通过端口 587 发送邮件，而端口 25 将仅用于接收来自邮件服务器的邮件。

我成功了，在连接到端口 25 时，邮件服务器之外的邮件是不允许的，并且由于中继访问被拒绝而被拒绝。而在端口 587 上，客户端能够将邮件发送到外部邮件服务器。

为了实现这一点，我在 main.cf 中设置了

```
smtpd_recipient_restriction=permit_mynetworks, reject_unauth_destination 
```

那就是我删除了 permit_sasl_authenticated。

如果我添加此条件，则允许将邮件发送到网络之外，如果我删除条件，则任何人都可以连接到端口 25，并且由于没有身份验证，因此可以向本地收件人发送任意数量的邮件。

我可以在端口 25 上使用 sasl 身份验证，但阻止它在我的网络之外中继邮件的方式是什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-04T09:02:35.420

在管理 postfix 方面，我绝不精通，但我知道您总是可以*覆盖*每个守护程序级别的限制。

看一下 postfix's `master.cf`，特别是`-o smtpd_xxx`条目和 google 的例子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-12-05T07:55:12.833

Postfix 允许基于两个标准进行中继：

*   身份验证（您删除了它！）
*   网络（这由 $mynetworks 控制）

我建议您将 mynetworks 变量设置为单个 IP 和 localhost，例如：

```
mynetworks = ip.of_ser.ver, 127.0.0.1 
```

# php - CakePHP：检索数据

> ID：15228478
> 
> 赞同：0
> 
> 时间：2013-03-05T16:03:35.643
> 
> 标签：php, arrays, cakephp

在我看来，我一直在检索某种数据。我必须列出某个“工作”的信息，该“工作”具有已存储在数据库中的不同属性。例如，我想列出“加权”字段。打印我这个`debug($this->viewVars)`（代表存储在数据库中的内容）：

```
'JobValues' => array(
            (int) 0 => array(
                'id' => '1',
                'yearly_job_id' => '1',
                'institution_type_id' => '1',
                'norm_rate' => '5',
                'weighting' => '5.00',
                'standard_value' => '5.00',
                'education_weeks' => '5.0',
                'group_distribution' => '0.50',
                'YearlyJob' => array(
                    'id' => '1',
                    'year_id' => '1',
                    'job_id' => '1',
                    'full_time_jobs_needed' => true,
                    'education_count_needed' => true,
                    'is_care' => true
                ), 
```

通常我只会打印这个：`echo([JobValue][weighting]);`，但中间有一个数字，所以`echo([JobValue][1][weighting]);`不会导致成功。我可以在我的视图（或模型）中实现什么？任何建议都将受到高度赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T05:02:26.083

为了打印数据，如果只有一个顶层数组，只需将其删除。`print_r(array_shift($foo['JobValues']['weighting']));`

如果同一级别上有多个数组，则需要执行 a`foreach`来迭代每个记录。

# google-plus - 有没有办法像在 Facebook 上一样在 Google+ 上注册应用程序？

> ID：15228486
> 
> 赞同：1
> 
> 时间：2013-03-05T16:03:50.480
> 
> 标签：google-plus, access-token, facebook-access-token

特别是我对获得没有过期时间的**应用程序访问令牌**的可能性感兴趣 ，就像我对 Facebook 所做的那样。

我想通过服务器代表用户发布，我发现 Facebook 的程序非常有用和方便，我们只在第一次请求用户权限。

我已经在这种社交网络互动中工作了仅仅三周，所以我很乐意听到任何类型的建议或批评。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T16:42:13.127

Google+ 目前没有公开的写入 API。有一些与他们合作的合作伙伴（例如 HootSuite）提供了此功能，但他们对它的访问速度非常缓慢。有关详细信息，请参阅[https://developers.google.com/+/api/pages-signup](https://developers.google.com/+/api/pages-signup)。

Google+ 确实有一个 Moments 的概念，它是您的应用中发生的活动，这些活动会报告给 Google+，用户以后可能希望分享这些活动，或者可能会在有限的不通知的情况下向其圈子中的人提供这些活动。这可能不是您想要的，但可能满足某些需求。有关更多信息和如何使用它的示例，请参阅[https://developers.google.com/+/api/latest/moments 。](https://developers.google.com/+/api/latest/moments)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T16:06:55.313

简而言之，不，目前在 Google+ 中无法做到这一点。通常，Google plus 的应用程序是只读的。

# java - 如何在 Java 或 JSP 中实现 Jaccard 索引？

> ID：15228493
> 
> 赞同：2
> 
> 时间：2013-03-05T16:04:03.993
> 
> 标签：java, mysql, jsp, similarity

我在计算 Jaccard 相似度以使用 MySQL 销售交易数据库中的交易 ID 查找类似书籍时遇到这个问题：

t1=Java、Ruby、C

t2=Java、C#、Python

t3= C#、VB、C

....ETC

Java 交集的大小 = 2; （我们怎么能找到它？）

union 的大小 = 3，（我们怎样才能找到它？）

Jaccard 相似度 = (交集/并集) = 2/3

但我不明白如何找出两个向量的“交集”和“并集”，或者如何在 Java/JSP 中实现它。

请帮助我，非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T16:19:34.707

您需要使用标准[Set](http://docs.oracle.com/javase/6/docs/api/java/util/Set.html)类之一。您可以对集合进行交叉、联合和大小计算。

# windows-8 - launchUriAsync 是否适用于 .edu 网站？

> ID：15228496
> 
> 赞同：1
> 
> 时间：2013-03-05T16:04:15.097
> 
> 标签：windows-8, windows-runtime, uri, windows-store-apps, winjs

我创建了一个 JavaScript Windows Store 空白应用程序，并将以下代码添加到其中。

```
var url = new Windows.Foundation.Uri("http://www.google.com")
Windows.System.Launcher.launchUriAsync(url); 
```

在调试我的程序时，上面会启动 google，但如果我放置一个 .edu 站点或以 .aspx 结尾的东西，则该站点将无法启动。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T16:41:38.333

我无法重现这一点。也许您这样做的方式会导致问题。

为了尝试复制，这就是我所做的。

1.  从 JavaScript Blank 应用模板开始。
2.  `<p>`向 default.html 添加了一个按钮，位于元素后面的行：`<input id="Button1" type="button" value="Launch" />`
3.  在调用 WinJS.UI.ProcessAll 之后，为 default.js 中的按钮添加了一个事件处理程序：`document.getElementById("Button1").addEventListener("click", launchUri);`
4.  在 default.js 中添加了 launchUri 函数，如下所示：

启动Uri：

```
function launchUri() {
    var uri = new Windows.Foundation.Uri("http://www.communitymegaphone.com/Default.aspx");
    Windows.System.Launcher.launchUriAsync(uri);
} 
```

对我来说工作正常，包括 aspx（如上所示）以及 .edu 地址。

如果您仍然无法使其工作，请发布一些附加代码以获取上下文。

希望有帮助。

有关 Windows 应用商店应用开发的更多信息，请注册[Generation App](http://bit.ly/gd30tolaunch)。

# c# - SqlException INSERT 语句与 FOREIGN KEY 约束冲突

> ID：15228497
> 
> 赞同：0
> 
> 时间：2013-03-05T16:04:14.897
> 
> 标签：c#, sql, sql-server

INSERT 语句与 FOREIGN KEY 约束冲突`FK_Kupovina_Kupac`。冲突发生在数据库`OnlineApoteka`、表`dbo.Kupac`、列“ID”中。该语句已终止。

我真的很困惑我不知道为什么我们不允许？我在 throw ex 中报告了一个错误；?

```
public static void Kupi(long lekID, int kolicina, double cena, long nacinIsporukeID, string korisnickoIme)
{
    SqlConnection con = new SqlConnection();
    try
    {
        con.ConnectionString = ConfigurationManager.ConnectionStrings["OnlineApotekaConnectionString"].ConnectionString;
        con.Open();

        string updateLager = @"
        UPDATE  Lager
        SET Kolicina=Kolicina-@Kolicina
        WHERE LekID=@LekID";

        SqlCommand cmd = new SqlCommand(updateLager, con);
        cmd.Parameters.AddWithValue("@LekID", lekID);
        cmd.Parameters.AddWithValue("@Kolicina", kolicina);

        cmd.ExecuteNonQuery();

        string insertIntoKupovina=@"
            INSERT INTO Kupovina (KupacID, LekID, Datum, Kolicina, Cena, NacinIsporukeID) 
            VALUES (@KupacID, @LekID, @Datum, @Kolicina, @Cena, @NacinIsporukeID)";

        cmd = new SqlCommand(insertIntoKupovina, con);
        cmd.Parameters.AddWithValue("@KupacID", KupacAdapter.GetID(korisnickoIme));
        cmd.Parameters.AddWithValue("@LekID", lekID);
        cmd.Parameters.AddWithValue("@Datum", DateTime.Now.Date);
        cmd.Parameters.AddWithValue("@Kolicina", kolicina);
        cmd.Parameters.AddWithValue("@Cena", cena);
        cmd.Parameters.AddWithValue("@NacinIsporukeID", nacinIsporukeID);

        cmd.ExecuteNonQuery();

    }
    catch (Exception ex)
    {
        throw ex;
    }
    finally
    {
        con.Close();
    }
} 
```

我有一个购买按钮的例行事件。当您单击 Kupi 时，应从表中删除 Lager 卷并放置在 Kupac Kupovina

```
protected void kupiButton_Click(object sender, EventArgs e)
{
    KupovinaAdapter.Kupi(Convert.ToInt64(kupovinaGreedView.SelectedDataKey["LekID"].ToString()),
        Convert.ToInt32(kolicinaTextBox.Text),
        Convert.ToInt64(kupovinaGreedView.SelectedDataKey["Cena"].ToString()),
        Convert.ToInt64(nacinIsporukeDropDownList.SelectedValue),
        User.Identity.Name);
}

protected void kupovinaGreedView_SelectedIndexChanged(object sender, EventArgs e)
{
    if (!String.IsNullOrEmpty(kupovinaGreedView.SelectedDataKey["Lek"].ToString()))
    {
        LekLabel.Text = kupovinaGreedView.SelectedDataKey["Lek"].ToString();
    }

    if (!String.IsNullOrEmpty(kupovinaGreedView.SelectedDataKey["Kolicina"].ToString()))
    {
        kolicinaValidator.MaximumValue = kupovinaGreedView.SelectedDataKey["Kolicina"].ToString();
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T16:07:55.403

您收到错误的原因是数据库模式的定义方式。特别地，该表`Kupac`用于与该表的关系`Kupovina`，因此`KupacID`in`Kupovina`必须与表中`ID`字段的值匹配`Kupac`。

`Kupovina`因此，您不能使用表`KupacID`中尚不存在的a将记录插入`Kupac`表中 - 这是违反外键约束的。

你有两个选择：

1.  确保首先在 Kupac 表中插入一条记录
2.  如果这具有商业意义，则从数据库模式中删除外键约束

但是您应该检查`KupacAdapter.GetID(korisnickoIme)`应该提供`KupacID`值的输出。如果此方法由于某种原因未返回有效 ID（来自`Kupovina`表中的 ID），则插入将失败，如上所述。

如果您想知道为什么异常没有开始*“处理”*而不是因为您的 catch 块中的代码。您基本上是在接受异常并重新抛出它，这有点毫无意义。你还不如根本没有 catch 块..

```
try {
   // ...
}
catch (Exception ex) {
    throw ex;    //  <--- this just re-throws the same exception that was caught!
}
finally { 

} 
```

在大多数情况下，几乎等同于：

```
try {
   // ...
}    
finally { 

} 
```

不同之处仅在于与异常一起保留了多少堆栈跟踪，但异常仍然冒泡了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T16:07:49.767

该`Kupac`表中没有`KupacID`您尝试插入到`Kupovina`表中的值

表中的`KupacID`列`Kupac`是主键，而表中的`KupacID`列`Kupovina`是指向主键的外键

阅读[外键](http://blogs.lessthandot.com/index.php/DataMgmt/DBProgramming/MSSQLServer/foreign-keys)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T16:07:57.557

是的，您正在捕获密钥违规`catch (Exception ex)`- 但是您然后在那里重新抛出异常。

您在调用例程中有错误处理程序吗？

`throw ex`- 不“处理”错误 - 它只是引发另一个错误（尽管在这种情况下是同一个错误 - 已被捕获的那个）

如果您期待这个*特定的错误*，那么您应该通过 - 捕获这个特定的错误`catch (SqlException ex)`，然后检查这个特定的错误。如果*不是*这个错误，那么`throw ex;`备份调用堆栈......如果*是*这个错误，那么你可以忽略（但最好首先避免这种插入......）

# python - 如何在 python os.path.exists 中使用变量

> ID：15228500
> 
> 赞同：0
> 
> 时间：2013-03-05T16:04:21.463
> 
> 标签：python, linux

这是我的代码

```
[root@04 ~]# python
Python 2.4.3 (#1, May  5 2011, 16:39:10)
[GCC 4.1.2 20080704 (Red Hat 4.1.2-50)] on linux2
Type "help", "copyright", "credits" or "license" for more information.
>>> import os.path
>>> pid = open('/var/run/httpd.pid' , 'r').read()
>>> print pid
24154
>>> os.path.exists('/proc/',pid)
Traceback (most recent call last):
File "<stdin>", line 1, in ?
TypeError: exists() takes exactly 1 argument (2 given) 
```

即使我尝试跟随，它也不起作用。如何`pid`在`os.path.exists`命令中使用变量？

```
>>> os.path.exists('/proc/'+pid)
False
>>> 
```

**编辑 ：**

如果我手动输入 PID 号，它可以工作

```
>>> print pid
24154

>>> os.path.exists('/proc/24154')
True
>>> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-05T16:12:51.260

问题是`http.pid`它不仅包含数字，还包含换行符。由于 Python 的`read`与 shell 的反引号不同，它不会去除尾随换行符，因此该`pid`变量包含一个类似的字符串，`"12345\n"`并且您的代码正在测试是否`"/proc/12345\n"`存在。

要更正此问题，请调用[`strip()`](http://docs.python.org/2/library/string.html#string.strip)您从文件中读取的字符串：

```
os.path.exists(os.path.join('/proc', pid.strip())) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-05T16:05:26.907

最好的解决方案是在[`os.path.join()`](http://docs.python.org/3.3/library/os.path.html#os.path.join)这里使用：

```
os.path.exists(os.path.join('/proc/', pid)) 
```

但是请注意，您的连接应该有效（尽管与 相比，它更脆弱且不推荐`os.path.join()`），所以您确定路径确实存在吗？`False`意味着它有效并且路径不存在。

[文档](http://docs.python.org/3.3/library/os.path.html#os.path.exists)说明：

> 如果 path 引用现有路径或打开的文件描述符，则返回 True。对于损坏的符号链接返回 False。在某些平台上，**如果未授予对请求的文件执行 os.stat() 的权限，即使路径物理存在，此函数也可能返回 False。**

重点补充。这意味着如果路径确实存在，您可能会遇到权限问题。

# java - Maven AppAssembler 找不到类

> ID：15228501
> 
> 赞同：7
> 
> 时间：2013-03-05T16:04:21.910
> 
> 标签：java, maven, appassembler

[尝试按照他们的教程](https://devcenter.heroku.com/articles/create-a-java-web-application-using-embedded-tomcat)修改现有的 Java/Tomcat 应用程序以在 Heroku 上部署，并遇到 AppAssembler 找不到入口类的一些问题。运行 target/bin/webapp（或部署到 Heroku）会导致`Error: Could not find or load main class org.stopbadware.dsp.Main`

但是，执行`java -cp target/classes:target/dependency/* org.stopbadware.dsp.Main`运行正常。这是 pom.xml 的相关部分：

```
 <plugin>
      <groupId>org.codehaus.mojo</groupId>
      <artifactId>appassembler-maven-plugin</artifactId>
      <version>1.1.1</version>
      <configuration>
          <assembleDirectory>target</assembleDirectory>
          <programs>
              <program>
                  <mainClass>org.stopbadware.dsp.Main</mainClass>
                  <name>webapp</name>
              </program>
          </programs>
      </configuration>
      <executions>
          <execution>
              <phase>package</phase>
              <goals>
                  <goal>assemble</goal>
              </goals>
          </execution>
      </executions>
    </plugin> 
```

我的猜测是`mvn package`导致 AppAssembler 不使用正确的类路径，有什么建议吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-12-02T16:49:44.697

您的工件的包装必须设置为`jar`，否则找不到主类。

```
<pom>
  ...
  <packaging>jar</packaging>
  ...
</pom> 
```

工件本身被添加到类路径的末尾，因此除了 JAR 文件之外没有任何效果。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-11-03T00:26:43.223

尝试：

```
mvn clean package jar:jar appassembler:assemble 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-06T10:06:30.890

首先，您使用的是旧版本的[appassembler-maven-plugin](http://www.mojohaus.org/appassembler/appassembler-maven-plugin/)，当前版本是 1.3。

我不明白你为什么要定义

```
<assembleDirectory>target</assembleDirectory> 
```

文件夹。有一个很好的默认值。所以通常你不需要它。除此之外，您不需要定义绑定到包阶段的显式执行，因为[appassembler-maven-plugin 默认绑定到包阶段](http://www.mojohaus.org/appassembler/appassembler-maven-plugin/assemble-mojo.html)。

此外，您可以使用[useWildcardClassPath](http://www.mojohaus.org/appassembler/appassembler-maven-plugin/assemble-mojo.html#useWildcardClassPath)配置选项来缩短您的类路径。

```
 <configuration>
     <useWildcardClassPath>true</useWildcardClassPath>
     <repositoryLayout>flat</repositoryLayout>
     ...
   </configruation> 
```

并且生成的脚本的调用显示错误取决于文件夹中所有依赖项所在的存储库的位置与定义的生成脚本中的位置不同。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-06T14:24:52.083

`"$BASEDIR"/classes`能够通过添加到生成的脚本中的 CLASSPATH 行来解决这个问题。由于脚本在每次调用时都会被重写，`mvn package`所以我编写了一个简短的脚本来调用`mvn package`然后添加所需的类路径条目。

显然有点破解，但经过 8 个多小时的尝试更“正确”的解决方案，现在必须这样做。肯定会采用更优雅的方式来纠正此处建议的类路径。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-12-31T21:53:50.313

您可以设置[CLASSPATH_PREFIX](http://www.mojohaus.org/appassembler/appassembler-maven-plugin/usage-script.html)环境变量：

```
export CLASSPATH_PREFIX=target/classes 
```

它将被添加到生成脚本的类路径中。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-12-22T14:26:07.350

前段时间我正在阅读该教程并且遇到了非常相似的问题。我采用了一种不同的方法，它对我非常有效。

首先，如前所述，您需要将 POM 的类型保持为`jar`( `<packaging>jar</packaging>`) - 因此，`appassembler`插件将从您的类生成一个 JAR 文件并将其添加到类路径中。因此，多亏了这一点，您的错误就会消失。

请注意，本教程 Tomcat 是从应用程序源目录中实例化的。在很多情况下这就足够了，但是请注意，使用这种方法，您将无法使用 Servlet`@WebServlet`注释，因为`/WEB-INF/classes`源代码是空的，并且 Tomcat 将无法扫描您的 servlet 类。因此`HelloServlet`，该教程中的 servlet 将不起作用，除非您按照[此处](https://stackoverflow.com/questions/26089902/webservlet-annotation-doesnt-work-with-tomcat-8)所述添加一些额外的 Tomcat 初始化（资源配置） （顺便说一句，您会发现更多关于该资源配置的 SO 问题）。

我做了一些不同的方法：

我在此期间运行一个`org.apache.maven.plugins:maven-war-plugin`插件（`exploded`目标）`package`并将该生成的目录用作我的应用程序的源目录。使用这种方法，我的 Web 应用程序目录将`/WEB-INF/classes`“填充”类。这反过来将允许 Tomcat 正确执行扫描作业（即 Servlet`@WebServlet`注释将起作用）。

我还必须在启动器类中更改我的应用程序的源：

```
public static void main(String[] args) throws Exception {
    // Web application is generated in directory name as specified in build/finalName
    // in maven pom.xml
    String webappDirLocation = "target/embeddedTomcatSample/";
    Tomcat tomcat = new Tomcat();

    // ... remaining code does not change 
```

我添加的对 POM 的更改 - 包括`maven-war-plugin`在`appassembler`插件之前：

```
...
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-war-plugin</artifactId>
    <version>2.5</version>
    <executions>
        <execution>
            <phase>package</phase>
            <goals>
                <goal>exploded</goal>
            </goals>
        </execution>
    </executions>
</plugin>
... 
```

请注意，`exploded`目标被调用。

我希望小小的改变对你有所帮助。

* * *

关于该教程和 maven 构建的另一条评论：请注意，编写该教程是为了展示构建应用程序并在 Heroku 中运行它是多么简单。但是，这不是 Maven 构建的最佳方法。

Maven 建议您应该坚持每个 POM 生成一个工件。在您的情况下，应该有两个工件：

*   Tomcat 启动器
*   Tomcat Web 应用程序

两者都应该构建为单独的 POM，并作为来自父 POM 的模块引用。如果您查看该教程的复杂性，则将其拆分为两个模块没有多大意义。但是，如果您的应用程序变得越来越复杂（并且启动器获得了一些额外的配置等），那么进行“拆分”将很有意义。事实上，已经创建了一些“Tomcat 启动器”库，因此您也可以使用其中的一个。

# ruby - 是否可以使用 xpath 搜索相应标签的值来获取输入的值？

> ID：15228509
> 
> 赞同：0
> 
> 时间：2013-03-05T16:04:42.057
> 
> 标签：ruby, xpath, selenium-webdriver

鉴于此 HTML 标记：

```
<tr>
  <td class="label">Description</td>
  <td class="data"><div>QA Test Customer</div></td>
</tr> 
```

尝试编写一个 Ruby 方法，该方法将采用两个参数“Description”和“QA Test Customer”，并使用 Selenium WebDriver 和 XPath 断言带有标签“Description”的输入值实际上是“QA Test Customer”。

不熟悉xpath，所以我很挣扎。我知道我需要一个 xpath 字符串：

```
"find a <td> with class of 'label' that has a value of 'Description' then get the value of the <div> embedded in the following <td> with class of 'data' 
```

任何指针都非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T16:10:57.627

```
//td[@class='label' and .='Description']/following-sibling::td[@class='data']/div 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T16:17:15.330

这是为 Nokogiri 写的。我不知道 Selenium 是使用 Nokogiri 还是它自己的 XML 解析器，所以它可能无济于事......

我更喜欢 CSS，因为它通常不那么冗长且更容易理解：

```
require 'nokogiri'

doc = Nokogiri::HTML(<<EOT)
<tr>
  <td class="label">Description</td>
  <td class="data"><div>QA Test Customer</div></td>
</tr>
EOT

doc.at('td.label + td.data').text
=> "QA Test Customer"

doc.at('td.label + td.data').text == 'QA Test Customer'
=> true 
```

这只是寻找第一个，`<td class="label">`然后是它的兄弟`<td class="data">`，但我们也可以添加对文本的搜索：

```
!!doc.at(%Q/td[class="label"]:contains("Description") + td[class="data"] div:contains("QA Test Customer")/)
=> true 
```

把它变成你可以调用的方法变成：

```
def td_match(doc, s1, s2)
  !!doc.at(%Q/td[class="label"]:contains("#{ s1 }") + td[class="data"] div:contains("#{ s2 }")/)
end 
```

并在 IRB 中调用它：

```
irb(main):024:0> def td_match(doc, s1, s2)
irb(main):025:1>     !!doc.at(%Q/td[class="label"]:contains("#{ s1 }") + td[class="data"] div:contains("#{ s2 }")/)
irb(main):026:1>   end
=> nil
irb(main):027:0> td_match(doc, 'Description', 'QA Test Customer')
=> true 
```

稍微清理一下：

```
def td_match(doc, s1, s2)
  !!doc.at(
    %Q/td[class="label"]:contains("#{ s1 }") + td[class="data"] div:contains("#{ s2 }")/
  )
end 
```

或者，通过将其添加到 Nokogiri::HTML::Document：

```
class Nokogiri::HTML::Document
  def td_match(s1, s2)
    !!self.at(
      %Q/td[class="label"]:contains("#{ s1 }") + td[class="data"] div:contains("#{ s2 }")/
    )
  end
end

doc.td_match('Description', 'QA Test Customer')
=> true 
```

# php - php图像调整大小创建质量较低的图像

> ID：15228512
> 
> 赞同：0
> 
> 时间：2013-03-05T16:04:52.227
> 
> 标签：php, gd

我正在使用简单的图像调整大小方法

```
list($width, $height) = getimagesize($filename);
$new_width = $width * $percent;
$new_height = $height * $percent;

$image_p = imagecreatetruecolor($new_width, $new_height);
$image = imagecreatefromjpeg($filename);
imagecopyresampled($image_p, $image, 0, 0, 0, 0, $new_width, $new_height, $width, $height);

imagejpeg($image_p, null, 100); 
```

Eventhoug 我已经将质量最大化，当涉及到较小的图像尺寸时，生成的图像质量很差（原始 500 像素到新的 100 像素）。

有没有其他方法可以提高图像质量？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T16:10:04.073

是的，有一种方法可以提高质量：如果可能的话，使用[ImageMagick](http://php.net/manual/en/book.imagick.php)而不是 GD 库。GD 库的质量很差。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-21T08:51:08.047

尝试这个

```
<?php

header('Content-type: image/jpeg');

$image = new Imagick('image.jpg');

// If 0 is provided as a width or height parameter,
// aspect ratio is maintained
$image->thumbnailImage(100, 0);

echo $image;

?> 
```

来源[http://php.net/manual/en/imagick.examples-1.php](http://php.net/manual/en/imagick.examples-1.php)

# php - 如何在 RedHat 6 上安装 PHP 并将其与 Oracle 连接

> ID：15228515
> 
> 赞同：1
> 
> 时间：2013-03-05T16:04:56.593
> 
> 标签：php, linux, oracle, apache, redhat

我需要为另一个人维​​护一个项目。这个项目是连接PHP和Oracle的，但是我在Redhat上设置的时候，系统显示这个错误：

> 在 ... 中调用未定义的函数 oci_connect()

我想我缺少 OCI8 扩展，需要安装它。

我阅读并尝试[了这个链接](http://miao5.blogspot.com/2011/10/enabling-php-oci8-extension-on-linux.html)，但我无法运行`yum install php-devel`，因为 Redhat 显示我没有这个包。

# php - user_login 和 password_login 正确，但不工作 PDOPHP

> ID：15228517
> 
> 赞同：0
> 
> 时间：2013-03-05T16:04:59.173
> 
> 标签：php, login, pdo

我正在尝试让我的登录脚本使用 PDO 工作。我遇到的问题是，当用户输入他/她的用户名和密码时，即使密码正确，它也会转到显示不正确的代码部分。我可以做些什么来解决这个问题，我可以在哪里实现 PDO 错误以显示可能有助于诊断问题。

index.php 中的登录脚本

```
<?
//Login Script
if (isset($_POST["user_login"]) && isset($_POST["password_login"])) {
    $user_login = preg_replace('#[^A-Za-z0-9]#i', '', $_POST["user_login"]); // filter everything but numbers and letters
    $password_login = preg_replace('#[^A-Za-z0-9]#i', '', $_POST["password_login"]); // filter everything but numbers and letters
    $password_login=md5($password_login);
    $db = new PDO('mysql:host=localhost;dbname=socialnetwork', 'root', 'abc123');
    $db->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
    $sql = "SELECT id FROM users WHERE username = ':user_login' AND password = ':password_login' LIMIT 1";
    $db->prepare($sql);
    if ($db->execute(array(
    ':user_login' => $user_login,
    ':password_login' => $password_login))); {
        if ($sql->rowCount() > 0){
            while($row = $sql->fetch($sql)){
                $id = $row["id"];
            }
            $_SESSION["id"] = $id;
            $_SESSION["user_login"] = $user_login;
            $_SESSION["password_login"] = $password_login;
            exit("<meta http-equiv=\"refresh\" content=\"0\">");
        } else {
            echo 'Either the password or username you have entered is incorrect. Please check them and try again!';
            exit();
        }
    }
}
?> 
```

索引.php

```
<? include("inc/incfiles/header.inc.php"); ?>
<?
$reg = @$_POST['reg'];
//declaring variables to prevent errors
$fn = ""; //First Name
$ln = ""; //Last Name
$un = ""; //Username
$em = ""; //Email
$em2 = ""; //Email 2
$pswd = ""; //Password
$pswd2 = ""; //Password 2
$d = ""; //Sign up Date
$u_check = ""; //Check if username exists
//registration form
$fn = @$_POST['fname'];
$ln = @$_POST['lname'];
$un = @$_POST['username'];
$em = @$_POST['email'];
$em2 = @$_POST['email2'];
$pswd = @$_POST['password'];
$pswd2 = @$_POST['password2'];
$d = date("y-m-d"); // Year - Month - Day

if ($reg) {
    if ($em==$em2) {
        // Check if user already exists
        $statement = $db->prepare('SELECT username FROM users WHERE username = :username');
            if ($statement->execute(array(':username' => $un))) {
                if ($statement->rowCount() > 0){
                    //user exists
                    echo "Username already exists, please choose another user name.";
                    exit();
                }
            }
                    //check all of the fields have been filled in
                        if ($fn&&$ln&&$un&&$em&&$em2&&$pswd&&$pswd2) {
                            //check that passwords match
                                if ($pswd==$pswd2) {
                                    //check the maximum length of username/first name/last name does not exceed 25 characters
                                        if (strlen($un)>25||strlen($fn)>25||strlen($ln)>25) {
                                            echo "The maximum limit for username/first name/last name is 25 characters!";
                                        }
                                        else
                                            {
                                                //check the length of the password is between 5 and 30 characters long
                                                    if (strlen($pswd)>30||strlen($pswd)<5) {
                                                        echo "Your password must be between 5 and 30 characters long!";
                                                    }
                                                    else
                                                        {
                                                            //encrypt password and password 2 using md5 before sending to database
                                                                $pswd = md5($pswd);

                                                                $pswd2 = md5($pswd2);

                                                                $db->setAttribute( PDO::ATTR_ERRMODE, PDO::ERRMODE_WARNING );
                                                                $sql = 'INSERT INTO users (username, first_name, last_name, email, password, sign_up_date)';
                                                                $sql .= 'VALUES (:username, :first_name, :last_name, :email, :password, :sign_up_date)';

                                                                $query=$db->prepare($sql);

                                                                $query->bindParam(':username', $un, PDO::PARAM_STR);
                                                                $query->bindParam(':first_name', $fn, PDO::PARAM_STR);
                                                                $query->bindParam(':last_name', $ln, PDO::PARAM_STR);
                                                                $query->bindParam(':email', $em, PDO::PARAM_STR);
                                                                $query->bindParam(':password', $pswd, PDO::PARAM_STR);
                                                                $query->bindParam(':sign_up_date', $d, PDO::PARAM_STR);

                                                                $query->execute();

                                                                $query=$db->prepare($sql);

                                                                $array = array(
                                                                ':username' => $un,
                                                                ':first_name' => $fn,
                                                                ':last_name' => $ln,
                                                                ':email' => $em,
                                                                ':password' => $pswd,
                                                                ':sign_up_date' => $d);
                                                                $query->execute($array);

                                                                die("<h2>Welcome to Rebel Connect</h2>Login to your account to get started.");
                                                        }
                                            }
                                }
                                else {
                                    echo "Your passwords do not match!";
                                }
                        }
                else
                    {
                        echo "Please fill in all fields!";
                    }
            }
    else {
        echo "Your e-mails don't match!";
    }
}
?>
<?
//Login Script
if (isset($_POST["user_login"]) && isset($_POST["password_login"])) {
    $user_login = preg_replace('#[^A-Za-z0-9]#i', '', $_POST["user_login"]); // filter everything but numbers and letters
    $password_login = preg_replace('#[^A-Za-z0-9]#i', '', $_POST["password_login"]); // filter everything but numbers and letters
    $password_login=md5($password_login);
    $db = new PDO('mysql:host=localhost;dbname=socialnetwork', 'root', 'abc123');
    $db->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
    $sql = "SELECT id FROM users WHERE username = ':user_login' AND password = ':password_login' LIMIT 1";
    $db->prepare($sql);
    if ($db->execute(array(
    ':user_login' => $user_login,
    ':password_login' => $password_login))); {
        if ($sql->rowCount() > 0){
            while($row = $sql->fetch($sql)){
                $id = $row["id"];
            }
            $_SESSION["id"] = $id;
            $_SESSION["user_login"] = $user_login;
            $_SESSION["password_login"] = $password_login;
            exit("<meta http-equiv=\"refresh\" content=\"0\">");
        } else {
            echo 'Either the password or username you have entered is incorrect. Please check them and try again!';
            exit();
        }
    }
}
?>
<table class="homepageTable">
        <tr>
            <td width="60%" valign="top">
             <h2>Already a member? Login below.</h2>
             <form action="index.php" method="post" name="form1" id="form1">
                <input type="text" size="25" name="user_login" id="user_login" placeholder="username" />
                <br />
                <input type="password" size="25" name="password_login" id="password_login" placeholder="password" />
                <br />
                <input type="submit" name="button" id="button" value="Login to your account!">
             </form>
            </td>
            <td width="40%" valign="top">
             <h2>Sign up below...</h2>
            <form action="#" method="post">
            <input type="text" size="25" name="fname" placeholder="First Name" value="<? echo $fn; ?>">
            <input type="text" size="25" name="lname" placeholder="Last Name" value="<? echo $ln; ?>">
            <input type="text" size="25" name="username" placeholder="Username" value="<? echo $un; ?>">
            <input type="text" size="25" name="email" placeholder="Email" value="<? echo $em; ?>">
            <input type="text" size="25" name="email2" placeholder="Re-enter Email" value="<? echo $em2; ?>">
            <input type="password" size="25" name="password" placeholder="password" value="<? echo $pswd; ?>">
            <input type="password" size="25" name="password2" placeholder="Re-enter Password" value="<? echo $pswd2; ?>"><br />
            <input type="submit" name="reg" value="Sign Up!">
            </form>
            </td>
        </tr>
</table>
</body>
</html> 
```

注销.php

```
<?
session_start();
session_destroy();
header("Location: index.php");
?> 
```

主页.php

```
<?
session_start();
$user = $_SESSION["user_login"];
//If the user is not logged in
if (!isset($_SESSION["user_login"])) {
    header("location: index.php");
    exit();
}
else
{
//If the user is logged in
echo "Hi, $user, You're logged in<br />Welcome to what is soon to be your NEWSFEED 
<a href=\"logout.php\">Logout?</a>
";
}
?> 
```

header.inc.php

```
<?
include ("inc/scripts/db_connect.inc.php");
session_start();
if (!isset($_SESSION["user_login"])) {

}
else
{
header("location: home.php");
}
?>
<html>
<head>
<link href="css/main.css" rel="stylesheet" type="text/css">
<title>Rebel Reach - PHS Student Social Network</title>
</head>
<body>
<div class="headerMenu">
      <div id="wrapper">
            <div class="logo">
                  <img src="img/find_friends_logo.png">
            </div>
            <div class="search_box">
                  <form method="get" action="search.php" id="search">
                  <input name="q" type="text" size="60" placeholder="Search..." />
                  </form>
            </div>
            <div id="menu">
                  <a href="#">Home</a>
                  <a href="#">About</a>
                  <a href="#">Sign Up</a>
                  <a href="#">Login</a>
            </div>
      </div>
</div>
<br />
<br />
<br />
<br /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T16:24:38.397

**不是答案**，而是对您的代码的一些建议，这些建议不适合评论。你可以大大减少你的代码；实际上你不应该经常重复功能......你可以减少：

```
$fn = ""; //First Name
$ln = ""; //Last Name
...
$fn = @$_POST['fname'];
$ln = @$_POST['lname'];
... 
```

像这样写一半：

```
$fn = (!empty($_POST['fname'])) ? $_POST['fname'] : '';
$ln = (!empty($_POST['lname'])) ? $_POST['lname'] : '';
$un = (!empty($_POST['username'])) ? $_POST['username'] : '';
$em = (!empty($_POST['email'])) ? $_POST['email'] : '';
$em2 = (!empty($_POST['email2'])) ? $_POST['email2'] : '';
$pswd = (!empty($_POST['password'])) ? $_POST['password'] : '';
$pswd2 = (!empty($_POST['password2'])) ? $_POST['password2'] : ''; 
```

此外，尽管这需要一些其他更改，但您可以通过将其写入如下数组中来将其减少到几行：

```
// Retrieve user data
foreach (array('fname', 'lname', 'username', 'email', 'email2', 'password', 'password2') as $Value)
  $User[$Value] = (!empty($_POST[$Value])) ? $_POST[$Value] : ''; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T19:57:54.630

重新解决您的“致命错误：在 ... 第 110 行调用未定义的方法 PDO::execute()”问题：

“execute()”是 PDOStatement 中的一种方法，而不是 PDO，这就是为什么你的“$db->e​​xecute...”会爆炸的原因。

（我知道这应该是评论，但我还不允许。对不起）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T16:18:56.820

我认为你的问题在这里：

```
"SELECT id FROM users WHERE username = ':user_login' AND password = ':password_login' LIMIT 1"; 
```

当您使用 PDO 准备方法时，例如？或：不要使用单引号 (')。

像这样纠正它：

```
"SELECT id FROM users WHERE username = :user_login AND password = :password_login LIMIT 1"; 
```

我希望现在它会起作用！

# php - 在php中从字符串转换为日期

> ID：15228519
> 
> 赞同：2
> 
> 时间：2013-03-05T16:05:04.520
> 
> 标签：php, sql, string, date

我环顾四周，但不断收到错误消息。

我有以下字符串：

```
$date = "25 Jan 2013 07:30 PM"; 
```

但我需要将它作为单独的日期和时间字段添加到 sql 中。有什么建议可以将其转换为日期而不是字符串？当我尝试使用类似的东西时

```
strtotime($date); 
```

我最终得到：

```
1359142200 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T16:07:03.337

选项1：

```
$date = date("Y-m-d", strtotime("25 Jan 2013 07:30 PM"));
$time = date("H:i:s", strtotime("25 Jan 2013 07:30 PM")); 
```

选项 2

```
$datetime = DateTime::createFromFormat("j M Y H:i A", "25 Jan 2013 07:30 PM");
$date = $datetime->format("Y-m-d");
$time = $datetime->format("H:i:s"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T16:06:51.603

为获得最佳结果，请转换`$date`为`DateTime`对象，[`DateTime::createFromFormat`](http://www.php.net/manual/en/datetime.createfromformat.php)然后用于[`DateTime::format`](http://www.php.net/manual/en/datetime.format.php)获取单独字段的值。

例子：

```
$dt = DateTime::createFromFormat("d M Y H:i A", "25 Jan 2013 07:30 PM");

$date = $dt->format("Y-m-d");
$time = $dt->format("H:i:s"); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-05T16:09:34.983

所以你只是想让他们分开？就像是：

```
$year_month_day = date('Y/m/d', strtotime($date));
$timestamp = date('H:i:s', strtotime($date)); 
```

更多信息：[http ://www.php.net/manual/en/function.date.php](http://www.php.net/manual/en/function.date.php)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-03-05T16:09:59.450

如果您希望它作为时间戳，那么`strtotime()`使用 PHP 函数：- [http://php.net/manual/en/function.strtotime.php](http://php.net/manual/en/function.strtotime.php)

如果您希望它采用 MySQL 日期格式字符串，那么`strtotime()`结合使用`date()`将是这样的答案：-

```
$db_date = date("Y-m-d H:i:s", strtotime($date) ); 
```

# asp.net - asp.net 通过RequiredFieldValidator 验证

> ID：15228522
> 
> 赞同：0
> 
> 时间：2013-03-05T16:05:11.447
> 
> 标签：asp.net, validation

我的页面上有两个按钮，我只想为其中一个触发验证器，而不是两者。

*   第一个按钮在母版页中。
*   页面中的第二个。

我不想要第一个按钮触发`RequiredFieldValidator`我设置的`UseSubmitBehavior="False"`按钮它对我不起作用

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T16:15:39.370

[验证组](http://weblogs.asp.net/scottgu/archive/2004/10/24/246945.aspx)允许对一组控件应用验证。它特别适用于页面上有多个按钮并且一个按钮应该触发对一组控件和另一个按钮的验证的另一组。它可以通过将验证组属性设置为验证器控件以及按钮控件上的某个字符串值来实现。

# django - 又一个 Django 和 jQuery 自动完成新手

> ID：15228524
> 
> 赞同：0
> 
> 时间：2013-03-05T16:05:20.103
> 
> 标签：django, jquery-ui, jquery-ui-autocomplete

在 stackoverflow 中搜索类似问题并尝试不同的“修复”后，我必须说我被困在这里了。我只是想使用 jQuery-ui 实​​现一个简单的自动完成功能，但不知何故，它不显示任何自动完成的名称，尽管在数据库中加载了一些。我向您展示我的逻辑和模板。

**模型.py**

```
class Usuario(models.Model):
  nombre = models.CharField(max_length=128)
  facultad = models.ForeignKey(Facultad, null=False, blank=False)
  carrera = models.ForeignKey(Carrera, null=False, blank=False)
  dni = models.PositiveIntegerField(unique=True)
  direccion = models.CharField(max_length=128)
  telefono = models.CharField(max_length=64)
  email = models.EmailField(max_length=254)
  fechaingreso = models.DateTimeField(null=False, blank=False)
  creadopor = models.ForeignKey(User, default=0)

  def __unicode__(self):
      return self.nombre 
```

**网址.py**

```
url(r'^get_usuarios/', 'get_usuarios', name='get_usuarios'), 
```

**prestar.html**

```
<script type="text/javascript">
$(function() {
  $("#usuarios").autocomplete({
    source: "{% url get_usuarios %}",
    minLength: 2,
  });
}); 
```

```
<div class="ui-widget">
      <label for="usuarios">Usuarios: </label>
      <input id="usuarios">
    </div>

<script src="{{ STATIC_URL }}js/jquery-1.9.1.min.js"></script>
<script src="{{ STATIC_URL }}js/jquery-ui-1.10.1.custom.min.js"></script> 
```

（最后一部分继承自 base.html，位于模板的末尾）

**视图.py**

```
def get_usuarios(request):
  if request.is_ajax():
      q = request.GET.get('term', '')
      usuarios = Usuario.objects.filter(nombre__icontains=q)[:20]
      results = []
      for usuario in usuarios:
          usuario_json = {}
          usuario_json['id'] = usuario.id
          usuario_json['label'] = usuario.nombre
          usuario_json['value'] = usuario.nombre
          results.append(usuario_json)
      data = simplejson.dumps(results)
  else:
      data = 'fail'
  mimetype = 'application/json'
  return HttpResponse(data, mimetype) 
```

特别是我怀疑这是否

```
usuario_json['id'] = usuario.id
usuario_json['label'] = usuario.nombre
usuario_json['value'] = usuario.nombre 
```

是正确的，因为我无法意识到它们到底是什么意思。

*感谢任何希望照亮我的人！*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T10:42:26.957

像往常一样自动解决愚蠢的错误。**应该在使用之前**导入 jQuery-ui 。

# xml - ORA-22806: 不是对象或 REF: 生成 XML 输出时出错

> ID：15228526
> 
> 赞同：0
> 
> 时间：2013-03-05T16:05:21.887
> 
> 标签：xml, oracle

我试图通过创建一个过程来创建一个 XML 输出文件，并将该过程用于并发请求。请找到下面的包过程代码。

并发程序出错

> “原因：FDPSTP 由于 ORA-19202 失败：XML 处理中发生错误 ORA-22806：不是对象或 REF”。

```
CREATE OR REPLACE PACKAGE BODY xx_outbound_xml1
AS
   PROCEDURE xx_insert_outbound_xml1 (
      errbuff   OUT   VARCHAR2,
      errcode   OUT   NUMBER
   )
   IS
      ln_ctx        DBMS_XMLGEN.ctxhandle;
      lc_xml_clob   CLOB;
   BEGIN
      ln_ctx :=
         DBMS_XMLGEN.newcontext
            (   'SELECT XMLELEMENT("litleRequest",
                              XMLATTRIBUTES('
             || 'to_char(sysdate,''DDMMYYYHH24MI:SS'')'
             || ' AS "Id"                   ),
                (SELECT 
                    XMLAGG(
                        XMLELEMENT(
                        evalname(Decode((select order_type FROM my_orders WHERE order_id = mo.order_id),''CO'',''"Credit"'',''"Sale"'')).getstringval(),
                        XMLFOREST (
                        mo.order_id AS "orderId",
                        mo.order_type as "orderType"
                                    )
                                )
                        )
  FROM my_orders mo
                )
            ) xml
 FROM dual'
            );
      DBMS_XMLGEN.setrowsettag (ln_ctx, NULL);
      DBMS_XMLGEN.setrowtag (ln_ctx, NULL);
      --DBMS_XMLGEN.setNullHandling(ln_ctx,dbms_xmlgen.EMPTY_TAG);
      lc_xml_clob := DBMS_XMLGEN.getxml (ln_ctx);
      lc_xml_clob := REPLACE (lc_xml_clob, '<XML>', '');
      lc_xml_clob := REPLACE (lc_xml_clob, '</XML>', '');
      DBMS_XSLPROCESSOR.clob2file (lc_xml_clob,
                                   'INBOUNDFOLDER',
                                   'output.xml',
                                   0
                                  );
      DBMS_LOB.freetemporary (lc_xml_clob);
   END xx_insert_outbound_xml1;
END xx_outbound_xml1; 
```

如果订单类型是 CO，那么标签应该是 Credit，或者如果 order_type 是 SO，那么标签应该是 Sales。

我的输出应该是这样的：

![输出](../Images/260ad3fde1d9b7cce4284dad70f70ca9.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T17:15:12.857

您不需要将 DBMS_XMLGEN 与 XML 函数一起使用，因为它已经是 XML！错误也来自您尝试调用`getstringval`非`XMLType`对象的事实。

而是这样做：

```
create or replace package body xx_outbound_xml1
as
   procedure xx_insert_outbound_xml1 (
      errbuff   out   varchar2,
      errcode   out   number
   )
   is
      ln_ctx        dbms_xmlgen.ctxhandle;
      lc_xml_clob   clob;
   begin
     select xmlserialize(document
              xmlelement(
                "litleRequest",
                xmlattributes(to_char(sysdate,'DDMMYYYHH24MI:SS')  AS "Id"),
                xmlagg(
                  xmlelement(
                    evalname(Decode(order_type, 'CO','Credit','Sale')),
                    xmlforest (
                      mo.order_id AS "orderId",
                      mo.order_type as "orderType"
                    )
                  )
                )
              )
            ) xml
     into lc_xml_clob
     from my_orders mo;

    dbms_xslprocessor.clob2file (lc_xml_clob,
                                 'INBOUNDFOLDER',
                                 'output.xml',
                                 0
                                );
   end xx_insert_outbound_xml1;
end xx_outbound_xml1;
/ 
```

例如，使用该代码（加上我在 xmlserialize 中添加了“缩进”，以便在此处更容易看到）：

```
SQL> var b varchar2(2000)
SQL> var c number
SQL> exec xx_outbound_xml1.xx_insert_outbound_xml1(:b, :c)

PL/SQL procedure successfully completed.

SQL> host cat /tmp/output.xml
<litleRequest Id="05030131727:20">
  <Sale>
    <orderId>1132339612</orderId>
    <orderType>SO</orderType>
  </Sale>
  <Credit>
    <orderId>1132339530</orderId>
    <orderType>CO</orderType>
  </Credit>
  <Sale>
    <orderId>1132339116</orderId>
    <orderType>SO</orderType>
  </Sale>
  <Credit>
    <orderId>1132338886</orderId>
    <orderType>CO</orderType>
  </Credit>
</litleRequest>

SQL> select * from my_orders;

  ORDER_ID OR
---------- --
1132339612 SO
1132339530 CO
1132339116 SO
1132338886 CO

SQL> 
```

# python - 使用2个键的字典很容易找到最大值？

> ID：15228532
> 
> 赞同：1
> 
> 时间：2013-03-05T16:05:30.240
> 
> 标签：python

我对 python 还很陌生，我需要关于如何实现这一点的建议。我不确定使用的最佳结构是什么。

我需要一个字典类型结构，它有 2 个键作为值。我需要使用两个键检索值，但通过任一键删除值。我还需要能够找到最大值并返回键（如果最大值重复，则返回键列表）

基本上，这是为了找到图表上任意 2 个点之间的最长距离。我将有一个点列表，我可以计算所有距离，但在任何时候我都需要获得最大距离以及它连接的点。可以随时删除任何点，因此我需要能够删除连接到这些点的值。

显然没有现有的结构可以做到这一点，所以我必须编写自己的课程，但有没有人建议从哪里开始？起初我打算使用带有元组键的字典，但是有没有一种快速的方法可以找到最大值并获取键（或键列表 - 可能存在重复值）。另外，如何轻松删除元组的单个部分的值？

我不是要求任何人为我解决这个问题，我正在努力学习，但任何建议都会有所帮助。提前致谢。

# php - 将 PHP 文件上传到 MySQL mediumblob 的错误

> ID：15228540
> 
> 赞同：2
> 
> 时间：2013-03-05T16:06:18.187
> 
> 标签：php, mysql, file-upload, blob, multipartform-data

我有一个脚本，旨在允许用户上传 DOC、DOCX、PDF 和 TXT 类型的文件。文件确实会上传，尽管没有换行符。例如，像这样的 TXT 文件：

```
//////////
THIS IS A TEXT FILE
////////// 
```

被下载回来：

```
//////////THIS IS A TEXT FILE////////// 
```

现在这不是文本文件的“大”问题，但这种换行符的丢失完全破坏了 PDF、DOC 和 DOCX 类型。

同样，在记事本中查看的 PDF 最初看起来像这样：

```
%PDF-1.5
%µµµµ
1 0 obj
<</Type/Catalog/Pages 2 0 R/Lang(en-US) /StructTreeRoot 10 0 R/MarkInfo<</Marked true>>>>
endobj
2 0 obj
.... 
```

但是，在上传和下载之后，它看起来像一个长字符串，缺少一些字符：

```
%PDF-1.5%µµµµ1 0 obj<>>>endobj2 0 obj 
```

因此，在 Adob​​e PDF 阅读器中打开文件时，它说它已损坏。

* * *

这是我用来上传文件的 PHP 脚本的摘录：

```
$_POST['request_id'] = $_POST['rid'];
    $tmpName = $_FILES['exam_file']['tmp_name'];
    $_POST['name'] = $_FILES['exam_file']['name'];
    $_POST['type'] = $_FILES['exam_file']['type'];
    $_POST['size'] = $_FILES['exam_file']['size'];
    //File types allowed are PDF, DOC, DOCX, TXT
    if ( ( $_POST['type'] == "application/pdf") || ($_POST['type'] == "application/msword") || ($_POST['type'] == "application/vnd.openxmlformats-officedocument.wordprocessingml.document") || ($_POST['type'] == "text/plain") ){
        $fp = fopen($tmpName, 'r');
        $content = fread($fp, filesize($tmpName));
        fclose($fp);
        $file_id = $model -> addFiles($_POST, $content);    
    } 
```

* * *

$model中的addFiles()函数如下：

```
function addFiles($data, $file){
    $table = 'faculty_files';
    $data = parent::clean($data);
    $keys = array('request_id', 'name', 'type', 'size', 'content');
    $data = parent::cleanAndPick( $keys, $data );
    $data['content'] = $file;
    $data['faculty_user_id'] = $_SESSION['user_details']['id'];
    $data['inserted_on'] = date('Y-m-d H:i:s');
    parent::insert( $table, $data );
    return mysql_insert_id();
} 
```

`parent::insert()`只需获取所有相关的详细信息，例如表名和字段，并将它们放入 SQL 语句中。

这是功能，`parent::clean()`虽然`$file`没有通过它运行：

```
public function clean($data = NULL){
  $data = str_replace("\n", "", $data);
  $data = str_replace("\r", "", $data);
  $data = stripslashes($data);
  return mysql_real_escape_string($data);
} 
```

功能`parent::cleanAndPick()`

```
public function cleanAndPick($keys, $data = NULL) {

    $clean = array();
    foreach ($keys as $key) {
        if (array_key_exists($key, $data))
            $clean[$key] = $this -> clean($data[$key]);
    }
    return $clean;

} 
```

功能`parent::insert()`

```
protected function insert($table, $data ) {

    //Build sql
    $data = $this -> clean($data);
    $sql = "INSERT INTO " . $this -> clean($table);
    $sql .= " (" . implode(",", array_keys($data)) . ") VALUES (";
    foreach ($data as $value)
        $sql .= ($value == NULL ? "NULL," : "'" . $value . "',");
    $sql = substr($sql, 0, -1) . ")";
    return $this -> query($sql);

} 
```

* * *

这是我用来下载文件的 PHP 脚本：

```
$file = $model -> retrieveFile($_POST['fid']);
header("Content-length: " . $file[0]['size'] . "");
header("Content-type: " . $file[0]['type'] . "");
header("Content-Disposition:attachment; filename=" . $file[0]['name'] . "");
print $file[0]['content']; 
```

* * *

我不知道是什么导致了这个问题。我将不胜感激任何意见！

编辑：有人在[PHP 论坛](http://php.net/manual/en/function.fopen.php)上遇到了类似的问题。摘录：

> 我一直在尝试在 Linux 服务器上上传和读取 Mac OS 文件，但没有成功。许多记录仅使用以下内容显示只有一个大：

```
<?php $fhandle = fopen($file, 'r'); ?>    or  <?php $fhandle =
> fopen($file, 'rb'); ?> 
```

> 但是，它确实可以这样工作：

```
> <?php  ini_set('auto_detect_line_endings', TRUE);  $fhandle =
> fopen($file, 'r');  ?> 
```

我确实尝试过，但它对我不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T16:12:41.307

`fopen($tmpName, 'rb');`如果您不想对其内容进行任何更改，请使用。

然后这个：

```
protected function insert($table, $data ) {
  //Build sql
  $data = $this -> clean($data); //<---- here...... 
```

# neo4j - 缓慢的 neo4j 密码查询

> ID：15228545
> 
> 赞同：6
> 
> 时间：2013-03-05T16:06:34.707
> 
> 标签：neo4j, cypher, neography

我试图找出为什么我的密码查询运行如此缓慢（仅 5000 个节点需要 2-5 秒）。该查询试图查找个人资料在他的网络中可以访问的所有工作（他的朋友或他的朋友的朋友在同一家公司工作的工作）

这是查询：

```
Start current_profile= node:node_auto_index(neoid_unique_id = "Profile:1")
 Match current_profile-[r:friendships*0..2]->friends-[:roles]->company-[:positions]->jobs
 return distinct company.fmj_id 
```

我尝试缩减查询以查看我做错了什么，即使这个简单的查询也需要太长时间：

```
START root=node(0)
Match root-[:job_subref]->j-[:jobs]->jobss
return jobss 
```

我做错什么了吗？

我正在使用基于neography gem的neoid

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-12T07:13:54.453

试试这个查询怎么样

```
Start current_profile= node:node_auto_index(neoid_unique_id = "Profile:1")
Match current_profile-[r:friendships*0..2]->friends
WITH friends
friends-[:roles]->company-[:positions]->jobs
RETURN company.fmj_id 
```

# html - 如何使用纯 CSS 在 HTML 元素顶部创建带有轮廓的三角形提示？

> ID：15228547
> 
> 赞同：2
> 
> 时间：2013-03-05T16:06:36.793
> 
> 标签：html, css

![](../Images/ade13c6147e10d54c06aec937e6751ac.png)

您可能已经在 Facebook、Google、Twitter 等网站上看到过这种带有三角形箭头提示的框。幸运的是，我也用纯 CSS 创建了一个。

这是代码：

> HTML：

```
<div class="box"><h3>This box contains a triangular arrow tip on top of it.</h3></div> 
```

> CSS：

```
.box { position: relative; background: #fff; color: #000; padding: 8px; border: 1px solid #ccc; }

.box:after {content: ""; position: absolute; display: block; width: 0; top: -15px; right: auto; bottom: auto; left: 5px; border-width: 0 10px 15px; border-style: solid; border-color: #fff transparent; } 
```

你可以看到三角形的尖端是纯白色的。如果您研究 CSS，您会发现提示的白色实际上是边框的颜色。

现在我正在寻找的是三角形尖端表面上的（例如灰色）边框或轮廓。因为提示的颜色来自边框，所以我不能使用第二个边框，因为没有这样的东西。我试过大纲，但它似乎不起作用。任何帮助如何用纯 CSS 做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-05T16:15:52.670

利用`:before`伪元素在第一个后面放置一个类似的箭头。

这是[http://cssarrowplease.com](http://cssarrowplease.com)上使用的技术。

[根据您的示例查看它的实际操作](http://jsfiddle.net/SJ797/)。

```
.box:before {
    content:"";
    position: absolute;
    display: block;
    width: 0;
    top: -16px;
    right: auto;
    bottom: auto;
    left: 3px;
    border-width: 0 12px 17px;
    border-style: solid;
    border-color: #ccc transparent;
    z-index: -1;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-05T16:36:48.357

不要使用边框来创建三角形。只需使用您应用 CSS 转换的伪元素。

# [*演示*](http://codepen.io/thebabydino/pen/oJCze)

结果：

![结果](../Images/ddbee78dcdc8263ee47bb2ec6b607100.png)

**HTML**：

```
<ul class='drop-down'>
  <li><a href='#'>Suggestions</a></li>
  <li><a href='#'>Friends (8)</a></li>
  <li><a href='#'>Friend Requests</a></li>
  <li><a href='#'>My Requests</a></li>
  <li><a href='#'>People I blocked</a></li>
</ul> 
```

相关**CSS**：

```
.drop-down {
  position: relative;
  border: solid 1px #ccc;
  background: white;
}
.drop-down:before {
  position: absolute;
  top: -.56em; left: 1em;
  border-left: solid 1px #ccc;
  border-top: solid 1px #ccc;
  width: 1em; height: 1em;
  transform: rotate(45deg);
  background: inherit;
  content: '';
}

/* variations */
.drop-down:first-child:before {
  transform: rotate(60deg) skewX(30deg) scaleY(.866);
}
.drop-down:nth-child(3):before {
  border-right: solid 1px #ccc;
  border-left: none;
  transform: rotate(-60deg) skewY(30deg) scaleX(.866);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T16:15:50.630

您可以使用 UTF-8“向上箭头”和一些绝对定位和文本阴影来做到这一点：

你的容器：

```
.boxArrow {
    margin-top:30px;
    height:100px;
    width:100px;    
    border:1px solid #000000;
    position:relative;
} 
```

箭头：

```
.boxArrow:before {
    content: "\25B2";
    font-size:16px;
    color:#ffffff;
    position:absolute;
    top:-15px;
    left:30px;
    text-shadow: -1px 0 black, 0 1px white, 1px 0 black, 0 -1px black;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-10-31T04:24:33.520

为了简单、轻松和快速的工作，您可以使用 jQuery UI：http: [//jqueryui.com/tooltip/#custom-style](http://jqueryui.com/tooltip/#custom-style)

# bash - empty variable when send to background using export

> ID：15228550
> 
> 赞同：0
> 
> 时间：2013-03-05T16:06:39.540
> 
> 标签：bash, for-loop, background

I'm building a sitemap from mysql and to speed things-up I would like to send my function to the background. When I do so, the `"$SITEMAP"` variable appears empty.

what I've tried is setting export `SITEMAP="$SITEMAP"`

```
for ((i=0; i<CNT; i++)); do
    xml() {
        ...
        export SITEMAP="$SITEMAP"
    }
    xml &
    echo -e "$SITEMAP"
done 
```

ps: without sending to background the "xml" function, script works correctly.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T16:16:09.357

Because the background shell is a different process. The rest is explained e.g. [here](https://stackoverflow.com/questions/496702/can-a-shell-script-set-environment-variables-of-the-calling-shell).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T16:17:54.950

When you call

```
 xml & 
```

you start a different process, then the `export` is valid only in the environement of the latter.

Remove the `&` and it will work

# actionscript-3 - 动作脚本 3 静态方法

> ID：15228563
> 
> 赞同：1
> 
> 时间：2013-03-05T16:07:10.510
> 
> 标签：actionscript-3, oop, static-methods

我是 Action-script OOP 的新手，我需要知道如何像这个例子一样链接方法

`I.$(button).bind('click',clickButton).bind('rollover',overButton).bind('rollout',outButton)`

首先，我需要删除`I.`仅像 jQuery 一样使用美元符号 :) 来选择 MovieClip 并对其应用任何操作，因为这样我使用静态方法操作脚本限制我只使用静态属性保存最后一个在这里调用动作的是类代码，以了解我的意思：

```
package com.MAIN
{
    import flash.display.Sprite;
    import flash.events.MouseEvent;

    public class I extends Sprite
    {
        private static var cSelector:Sprite;

        public static function $(selector:Sprite)
        {
            cSelector = selector
            return I;
        }

        public static function alpha(val:Number)
        {
            cSelector.alpha = val;
            return I;
        }

        // bind mouse event to the element
        public static function bind(EventStr,func:Function)
        {
            var func1:Function = function(e:MouseEvent){
                func(cSelector);
            }
            // select the event from the list
            if(typeof(EventStr) == 'string'){
                // map the events in lowercase
                var events:Object = {click:'CLICK',rollover:'ROLL_OVER',rollout:'ROLL_OUT',dblclick:'DOUBLE_CLICK',mousedown:'MOUSE_DOWN',mousemove:'MOUSE_MOVE',mouseout:'MOUSE_OUT',mouseover:'MOUSE_OVER',mouseup:'MOUSE_UP',mousewheel:'MOUSE_WHEEL'};
                // check if the event exists in the list
                if(events[EventStr] && MouseEvent[events[EventStr]]){
                    cSelector.addEventListener(MouseEvent[events[EventStr]],func1);
                }
            }else if(typeof(EventStr) == 'object'){
                // add the event
                cSelector.addEventListener(EventStr,func1);
            }
            return I;
        }

        public static function remove()
        {
            cSelector.parent.removeChild(cSelector);
            return I;
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T15:18:01.450

给你，朝着正确的方向迈出几步。然而，这是一个非常非常非常糟糕的想法。

```
//$.as
package
{
    import flash.display.DisplayObject;

    //NOTE: there's NO class definition

    public function $( selector : DisplayObject ) : IDisplayObject
    {
        //traverse displaylist to find <code>selector</code>
        //and return an instance of IDisplayObject that holds the reference        
    }
}

//IDisplayObject.as
package
{
    public interface IDisplayObject{
        function alpha( value : Number ) : IBinding;
    }
}

//IBinding.as
package jquery
{
    public interface IBinding{
        function bind( eventName : String, callback : Function, ...parameters ):void;
    }
} 
```

一旦您创建了这些的具体实现，您可以执行以下操作：

```
$( someMC ).alpha( .5 ).bind( 'click', function(){ trace( 'what a miraculously crappy idea !!!!' ) } ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T17:15:30.217

你可以这样尝试：

```
interface Test {
  function doBla(): Test
  function moreBla(): Test
}

public class StaticTest {
  private static const instance: Test = new InternalTest()

  public static doBla() : Test {
    return instance.doBla();
  }

  public static moreBla() : Test {
    return instance.moreBla();
  }
}

internal class InternalTest implements Test {
  function doBla(): Test {
    trace("bla");
    return this;
  }

  function moreBla(): Test {
    trace("more bla");
    return this;
  }
} 
```

# windows - 在 XP 中强制使用多个 NIC 进行外部路由

> ID：15228568
> 
> 赞同：0
> 
> 时间：2013-03-05T16:07:29.680
> 
> 标签：windows, networking, routing, nic, loopback

没有 TCP/IP 知识的新手警报... 我正在尝试设置一个生产测试平台，通过在 XP PC 上安装 6 个 NIC 卡来测试嵌入式 6 路以太网交换机。我开始使用两个 NIC 来证明这一点，它们都在同一个子网上，手动 IP 地址为 172.16.0.1 / 172.16.0.2。路由表（`route print`）显示（我相信）两个环回条目：

```
=====================================================
172.16.0.0     255.255.255.0    172.16.0.1  172.16.0.1
172.16.0.0     255.255.255.0    172.16.0.2  172.16.0.2
172.16.0.1     255.255.255.255  127.0.0.1   127.0.0.1
172.16.0.2     255.255.255.255  127.0.0.1   127.0.0.1
172.16.255.255 255.255.255.255  172.16.0.1  172.16.0.1
172.16.255.255 255.255.255.255  172.16.0.2  172.16.0.2
===================================================== 
```

我想删除环回条目并将它们替换为“始终外部”路由条目。即，如果您`ping 172.16.0.1`的数据包使用适配器 172.16.0.2，并由交换机路由回 172.16.0.1，如果您`ping 172.16.0.2`的数据包离开 172.16。 0.1，并通过交换机路由回 172.16.0.2，从而对电缆、交换机 IC、磁性等进行基本的连接测试。

：（ `route add 172.16.0.1 mask 255.255.255.255 172.16.0.2`在我看来，这似乎是唯一指定使用 172.16.0.2 将数据包发送到目的地 172.16.0.1）的命令失败，并显示“路由添加失败：路由参数不正确”

While :`route add 172.16.0.2 mask 255.255.255.255 172.16.0.1`被接受，但我不能`ping 172.16.0.2`

我确实在您的旧帖子中找到了一些非常好的解释，说明表格中每一行的含义，但我显然不太了解发生了什么。我有点担心自动生成的路由表已将两个适配器指定为网关，但我不太了解其中的含义。

最终，在盒子里有 6 个 NIC，我希望能够制作一个表格，让我能够使用交换机上的每个端口。

非常感谢大卫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-15T16:44:36.397

您可以使用 ping 来执行此操作。首先将 NIC 设置为具有静态 IP 地址。我会给你一个带有 2 个 NIC 的示例。NIC1 设置为 192.168.0.2，NIC2 设置为 192.168.0.1。然后运行命令：

ping 192.168.0.2 –s 192.168.0.1 –t

我想你会发现，如果你拔掉外部环回电缆，测试就会失败，如果你再插回去，它就会通过。有关 ping 的更多帮助，请键入 ping -?

您可能必须禁用 Windows 防火墙才能让 ping 流量通过。

# java - getListenerList 或 getListeners

> ID：15228571
> 
> 赞同：1
> 
> 时间：2013-03-05T16:07:34.953
> 
> 标签：java, javabeans, event-listener

我很好奇应该使用哪种方法从 EventListenerList 中检索侦听器列表。Oracle 文档示例显示 getListenerList ，然后在 fireXXXEvent 方法中向后遍历它，但我想知道 getListeners 是否会是更好的选择？

```
 listeners = listenerList.getListenerList();
     for (int i = listeners.length - 2; i >= 0; i -= 2) 
```

或者

```
 listeners = listenerList.getListeners(ListenerClass.class);
     for (ListenerClass listener : listeners) { 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T16:39:40.180

If all your Listeners are of a single, known class, the second form is much simpler and less prone to error. If you have maybe two types of listeners, use the second form twice.

If you have a mish-mash of listeners of different classes, use the first form, which IMO is some of the ugliest, grossest, hackiest, least Object Oriented code ever written.

p.s. IMO (admittedly biased cause I really dislike the EventListenerList implementation) you should consider writing your own EventListenerList class using a `CopyOnWriteArrayList` or `CopyOnWriteArraySet`, which are ideally suited for this task.

# javascript - 使用 js/html 将帖子发送到 URL

> ID：15228573
> 
> 赞同：3
> 
> 时间：2013-03-05T16:07:36.490
> 
> 标签：javascript, html

我正在尝试查找是否可以仅使用 html 和 javascript 将 POST 发送到 url。据此[这](http://en.wikipedia.org/wiki/Same_origin_policy)是不可能的。有知识的人可以告诉我这可能吗？如果它是怎么做的？ad1 不使用 jQuery

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T16:09:00.113

如果您认为 jQuery 是 JavaScript，那么它肯定是。

看这里：

[http://api.jquery.com/jQuery.post/](http://api.jquery.com/jQuery.post/)

如果您将来在开发中要做很多此类事情，我强烈建议您习惯使用 jQuery。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-05T16:11:30.080

如果你真的想你可以使用[XMLHttpRequest](https://en.wikipedia.org/wiki/XMLHttpRequest)。所有主流浏览器都支持它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-05T16:12:43.443

> 我正在尝试查找是否可以仅使用 html 和 javascript 将 POST 发送到 url。

是的

> 据此*这*是不可能的。

不会。一般来说，同源策略会阻止您*读取*来自不同来源的数据。飞行前检查有时会阻止您发送数据，但有[几种方法可以规避该政策](https://stackoverflow.com/questions/3076414/ways-to-circumvent-the-same-origin-policy)。

> 如果它是怎么做的？ad1 不使用 jQuery

[XMLHttpRequest](https://developer.mozilla.org/en-US/docs/DOM/XMLHttpRequest)和[jQuery.ajax](http://api.jquery.com/jQuery.ajax/)都有很好的文档记录。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-05T16:10:34.820

根据文章，如果 URL 不在同一来源，则不可能。这是出于安全原因。

如果它在同一个来源（域）内，那么它是可能的。

纯 JS（无框架）示例：http: [//www.w3schools.com/ajax/ajax_xmlhttprequest_send.asp](http://www.w3schools.com/ajax/ajax_xmlhttprequest_send.asp)

# html - 未编码的 & 和大写

> ID：15228574
> 
> 赞同：1
> 
> 时间：2013-03-05T16:07:38.850
> 
> 标签：html, css, urlencode, ampersand, capitalize

问候大家，

我想知道是否有人注意到这种不一致并知道如何解决它。

示例：http: [//jsfiddle.net/p5G2N/](http://jsfiddle.net/p5G2N/)

**前提：**

多个单词由未编码的 & 符号连接；没有空格。

`<p>Goodevening&goodnight</p>`

**结果：**

Chrome/IE：无法将字符解释为 & 符号，从而破坏了预期的大写样式。显示为：**Goodevening&Goodnight** [不正确 - 注意晚安的大写 G，因为它是一个单词，所以不应该大写]

Firefox：设法正确解释未编码的＆符号并将字符串视为单个单词。显示为：**晚安和晚安**[正确]

**问题：**

如何让 Chrome/IE 尊重样式（大写）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T16:11:57.117

`&amp` *应该*用过`&`。从[W3 规范](http://www.w3.org/TR/html4/charset.html#h-5.3.2)：

> 作者应该使用`"&amp;"`(ASCII decimal 38) 而不是`"&"`避免与字符引用的开头混淆（实体引用打开分隔符）。作者还应该`"&amp;"`在属性值中使用，因为在 CDATA 属性值中允许字符引用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-05T16:38:50.983

TL;DR: Your expectation is incorrect. `goodbye&goodnight` has two word-separation points, one on each side of the ampersand. Whether the ampersand is encoded or not is irrelevant.

* * *

As far as I know, CSS doesn't fully specify what a "word" is, but there is a recommendation to use the Unicode standard word separation algorithm, which you can find [here (UAX29)](http://www.unicode.org/reports/tr29/#Word_Boundaries).

An informal summary is that a word is a sequence of letters, numbers or "Connector_Punctuation" symbols (ties), and possibly containing "MidLetter", "MidNum" or "MidNumLet" symbols (there's a list in the referenced document), depending on the immediate context of the symbol. `&` is not in any of those categories, so a UAX29-conformant word-separation algorithm should split words before and after an `&`.

A word separation algorithm may take language into account. Indeed, it may do just about anything, but it's supposed to be unsurprising for a native speaker of the language. Non-programmers would probably be surprised if `word&word` were considered one word.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T16:10:26.850

如果要`&`在 HTML 中使用 - 符号，请`&amp;`改用。

# javascript - 客户端缓存（使用 JavaScript）

> ID：15228577
> 
> 赞同：1
> 
> 时间：2013-03-05T16:07:50.677
> 
> 标签：javascript, performance, api, caching, offline-caching

我有一个 API，我在客户端通过 JS 查询，然后在页面上显示结果（再次通过 JS）。

我有每秒 5 个查询的限制。在现实生活中，我可以在一个循环中发送最多 11 个 API 调用。

**我需要的：**

1.  我需要以某种方式绕过 11 个查询限制，因为通常我需要在一个循环中进行大约 50 个调用。

2.  我需要确保我不会在每次页面刷新时发送相同的 API 请求。

显而易见的解决方案是缓存。为了符合速度要求，理想情况下我想在客户端缓存数据。

**问题：**

如何？由于 4KB 的大小限制，我认为 cookie 不是一个好的解决方案。我听说过 Google-gears（他们用于 Offline-Gmail。）但最近的搜索结果显示它不再存在。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T16:11:08.803

您可以使用 localstorage，但前提是您需要在浏览器刷新之间保留缓存。如果不这样做，则可以使用内存，例如将其保存在数组或结果中。

# php - php 安全且可扩展的文件管理

> ID：15228580
> 
> 赞同：1
> 
> 时间：2013-03-05T16:07:53.627
> 
> 标签：php, mysql, file, upload

我有一个使用 UserCake 和 PHPMyEdit 开发的 PHP 网站，我的数据存储在 MySQL 中。现在我也想以一种我可以控制不同用户的访问权限的方式上传 PDF 文件，并且该解决方案必须适用于大量文件上传。

我想知道在 MySQL 中存储 PDF 文件是否适合我的目的？

如果不是什么是最好的和现成的解决方案？

谢谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T17:44:43.737

在数据库上存储二进制文件通常不是一个好主意。

**存储在数据库中的优点：**

*   它允许您利用数据库的安全机制
*   在数据库上存储 blob 还意味着您永远不必担心重复的文件名。
*   也意味着当上传出错时，您可以回滚事务，您不必四处寻找损坏的文件并将它们从磁盘中删除。

**存储在数据库中的缺点：**

*   您必须序列化文件以写入和反序列化以读取它们，这比仅写入/读取文件要慢得多；
*   更高的内存使用率（想象加载一个包含许多行的结果集，所有行都带有 blob）
*   将使您的数据库备份非常、非常繁重和缓慢。
*   Blob 通常以 4kb 的块为单位传输到数据库，对于比这更大的文件，这会给您带来大量开销。

从数据库中检索文件路径并将文件直接流式传输给用户通常更快。

编辑：我深思熟虑，并提出了存储在数据库中的另外两个优点。只是编辑扮演魔鬼的拥护者，给你所有的信息，让你自己决定哪种方法更适合你的情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T17:50:38.380

您可以在数据库中保留 pdf 的相对路径。这样，您可以避免 DB 上的所有开销。

如果您要存储 PDF 本身，那必须有非常充分的理由。

# node.js - 如何在 Brunch 中设置环境变量

> ID：15228581
> 
> 赞同：2
> 
> 时间：2013-03-05T16:07:53.713
> 
> 标签：node.js, express, brunch, chaplinjs

我们正在开发一个在早午餐之上使用卓别林的应用程序。

我们正在使用 3rd 方 API，并且我们有**不同的代币用于开发和生产**。

我想知道是否可以在早午餐中设置环境变量。我想将所有内容编译为纯 html/js。

有没有办法使用类似的东西来编译项目`brunch build -env staging`？如果是这样，我该如何定义这些变量？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T16:25:55.737

[https://github.com/brunch/brunch/issues/332](https://github.com/brunch/brunch/issues/332)

1）使用`brunch cmd --environment ...`

2) 使用`BRUNCH_ENV=development brunch cmd`+`process.env.BRUNCH_ENV`

# ruby-on-rails - 使用 MiniTest 进行模型测试？

> ID：15228582
> 
> 赞同：1
> 
> 时间：2013-03-05T16:07:53.890
> 
> 标签：ruby-on-rails, ruby, minitest

我正在使用 MiniTest 框架，并想编写一个模型测试。这是我的测试代码：

```
it "must find or create authentication" do
  auth = Authentication.find_by_provider_and_uid( @auth.provider,
  @auth.uid )
  val = auth.nil?
  if val==true
    Authentication.create_with_omniauth @auth
  end
end 
```

此测试检查该`Authentication.find_by_provider_and_uid`方法是否存在，如果`auth`为 nil，它将创建一个新的`auth`.

我用一个`if`从句写的，但我不知道它是否正确。我怎样才能纠正这个测试？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T16:36:05.197

因为您的问题中没有代码，所以我假设您正在使用[minitest-rails](https://github.com/blowmage/minitest-rails)并对其进行了正确配置，因为这是我最熟悉的。

假设您有以下代码：

```
class Authentication < ActiveRecord::Base
  def self.find_by_provider_and_uid provider, uid
    self.where(provider: provider, uid: uid).first_or_initalize
  end
end 
```

此外，我会假设你有以下夹具数据`test/fixtures/authentications.yml`

```
test_auth:
  provider: twitter
  uid: abc123
  user: test_user 
```

我将进行类似于以下的测试：

```
describe Authentication do

  describe "find_by_provider_and_uid" do

    it "retrieves existing authentication records" do
      existing_auth = authentications :test_auth
      found_auth = Authentication.find_by_provider_and_uid existing_auth.provider, existing_auth.uid
      refute_nil found_auth, "It should return an object"
      assert found_auth.persisted?, "The record should have existed previously"
      assert_equal existing_auth, found_auth
    end

    it "creates a new authentication of one doesn't exist" do
      new_auth = Authentication.find_by_provider_and_uid "twitter", "IDONTEXIST"
      refute_nil new_auth, "It should return an object"
      assert new_auth.new_record?, "The record should not have existed previously"
    end

  end

end 
```

FWIW，我不喜欢这种方法的名称。名称类似于动态查找器，但行为不同。我会将方法重命名为`for_provider_and_uid`.

# mysql - 使用mysql如何在字符串中查找第一次出现的字母

> ID：15228583
> 
> 赞同：2
> 
> 时间：2013-03-05T16:07:55.147
> 
> 标签：mysql, sql

使用 mysql 我需要找到子字符串中任何字母第一次出现的位置。例如，如果我的字符串是这样的，`123456A12345`那么我需要找到 A 的位置。我的主要目标是获取字母表之前的所有数字。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T16:10:31.407

如果要获取所有数字，只需通过添加 0 将字符串转换为整数：

```
select '12345abc'+0 
```

返回 12345。

这不处理前导 0。而且，它不适用于任何长度的表达式，但它可以快速解决您的问题。

# asp.net - 从 Web 服务器获取数据

> ID：15228589
> 
> 赞同：1
> 
> 时间：2013-03-05T16:08:04.263
> 
> 标签：asp.net, asmx

我有一个托管在 IIS 上的非常简单的 Web 服务，如果您调用任何 Web 方法，这基本上会引发一些异常。在托管 web 服务的同一系统中安装了第三方应用程序，它们拦截 webmethod 并获取有关未处理异常的所有信息（如方法名称、异常类型、堆栈跟踪、代码等）。任何需要此异常信息的人都可以使用第三方应用程序订阅事件对象。所以我在 IIS 进程本身中编写了事件订阅代码。

所以流程是这样的，测试客户端将调用基本上抛出一些异常的 webmethod，第三方应用程序捕获这些异常，并且订阅异常信息的人将以 XML 格式获取这些信息。

现在我希望在我的测试客户端中访问 XML 信息，有什么方法可以实现吗？我不确定这是否可行，因为我是网络服务世界的新手，如果这没有任何意义，请原谅。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T13:07:41.560

我为这个问题找到了两个解决方案，1）使用 HttpModule 编辑 Http 响应并在响应本身中添加异常信息 xml。2) 有不同的 exe 将在后台运行并使用 3rd 方应用程序提供的 API 订阅异常信息事件。一旦 exe 收到任何失败事务的异常信息，exe 将在某些共享存储中写入相同的信息。就我而言，我使用的是 Azure 表存储。

# python - os.rename 给出错误

> ID：15228590
> 
> 赞同：0
> 
> 时间：2013-03-05T16:08:11.183
> 
> 标签：python, operating-system

我试图让我的代码查找特定文件，然后用我在其他地方定义的 newName 重命名它们。我正在尝试调试此代码，但在尝试实现 os.rename 时我想不出我做错了什么。在我在 stackoverflow 上找到的其他解决方案中，我将 SRC 和 DST 视为 os.path.joins。任何人都可以提供任何见解吗？

```
if os.path.exists(curr_dir + '\\Output\\Fab'):
        for (path, dirs, files) in os.walk(curr_dir + '\Output\Fab'):
            for f in files:
                name, ext = os.path.splitext(f)
                newName = replacement + ext
                os.rename(os.path.join(path, f), os.path.join(path, newName ) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T16:10:12.940

在 Windows 上，如果目标文件已经存在，则会出现错误。

使用 '/' 而不是 '\' 这样它就不会转义下一个字符。

在您使用的第二行，`\`而不是`\\`.

# asp.net - 上传后如何清除文件？

> ID：15228592
> 
> 赞同：0
> 
> 时间：2013-03-05T16:08:17.437
> 
> 标签：asp.net, vb.net, file-upload

我正在使用visual developer 2012，并有一个简单的表单将文件上传到服务器，然后将文件名输入到另一个表中。无论出于何种原因，它都会运行两次并在第二个表中输入两次值：

```
Protected Sub BtnUploadImg_Click(sender As Object, e As EventArgs) Handles BtnUploadImg.Click
    If IsPostBack Then
        ' Dim CurrentPath As String = Server.MapPath("C:\DSimages\")
        If FileUpLoad1.HasFile = True Then
            Try
                FileUpLoad1.SaveAs("C:\DSimages\" & _
                   FileUpLoad1.FileName)
                Label1.Text = "File name: " & _
                   FileUpLoad1.PostedFile.FileName & "<br>" & _
                   "File Size: " & _
                   FileUpLoad1.PostedFile.ContentLength & " kb<br>" & _
                   "Content type: " & _
                   FileUpLoad1.PostedFile.ContentType
                ImageDataSource.InsertParameters("ImgName").DefaultValue = FileUpLoad1.PostedFile.FileName
            Catch ex As Exception
                Label1.Text = "ERROR: " & ex.Message.ToString()
            End Try
        Else
            Label1.Text = "You have not specified a file."
        End If
    End If

    ImageDataSource.Insert()
    FileUpLoad1.PostedFile.InputStream.Dispose()     

End Sub 
```

* * *

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T16:17:39.517

您在页面加载事件下是否有相同的代码？回发将触发这两个事件，因此如果您这样做，它将运行两次。

# ios - iOS 使用 TabBar 改变显示的视图

> ID：15228594
> 
> 赞同：0
> 
> 时间：2013-03-05T16:08:30.473
> 
> 标签：ios, uistoryboard, xcode-storyboard

我的主导航有一个主 TabBarController。在 1 个选项卡下，我有一个控制器，顶部有另一个 TabBar。如果可能，我希望能够使用此 TabBar 在同一控制器内的 2 个视图之间切换。

我的想法是在我的故事板中有一个 ScrollView 和一个 TableView 在彼此之上，然后在选择适当的选项卡时在 2 个主视图上使用 setHidden:（切换 1 隐藏和显示另一个）。

但问题是在情节提要中，我永远无法让他们玩得很好。当我尝试定位 1 个视图时，它总是成为它后面的视图的子视图。例如，我的 ScrollView 定位良好，但是当我将 TableView 移动到位时，TableView 成为 ScrollView 的子项 - 因此，如果我隐藏 ScrollView，我将永远无法取消隐藏 TableView。

在情节提要左侧的场景表下，我可以将视图定位为主视图的子视图（正确），而 ScrollView 或 TableView 不会成为另一个的子视图（正确）。但是，每当我这样做时，我所做的定位就会丢失，并且所有东西都在错误地浮动。

也许我正在以一种不好的方式改变这种观点，或者有没有办法让故事板发挥得很好？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T16:54:00.027

If I understand you correctly, you want the following:

*   TabBarController A - Your primary navigation, lets say it has 3 tabs A1, A2, A3
*   TabBarController B - Nested in a tab (e.g. A3) of the primary navigation, it has 2 tabs B1, B2
*   B1 - A scrollView
*   B2 - A tableView

To do this you don't need to set hidden, just use TabBarController B to present views in the same way TabBarController A does.

The screenshot below shows the storyboard layout:

NB - In order to link a TableViewController to a TabBarController in storyboards you control-drag from the TabBarController to the TableViewController and select 'Relationship segue - view controllers' from the pop up menu.

![enter image description here](../Images/7e6ad6e40bec40518141cbfe40dc1d4e.png)

# javascript - 来自弹出窗口的 javascript 调用类

> ID：15228596
> 
> 赞同：0
> 
> 时间：2013-03-05T16:08:36.247
> 
> 标签：javascript, callback, popup, parent-child, parent

有没有办法从弹出窗口回调一个类对象。

我知道有办法回调一个函数：

```
window.opener.MyFunction(); 
```

但我想知道，如何调用类方法

```
new Profile('me', 'id'); 
```

我不知道该怎么做，但只是给你一个想法

```
window.opener.'new Profile('me', 'id');'; 
```

> 是的，我知道，它不是有效的 js 代码，但它只是为了给你一个想法:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T16:10:32.623

`Profile`是 的一个属性`window.opener`。
您可以像使用任何其他属性一样使用它：

```
new window.opener.Profile(...); 
```

`new`是作用于函数的运算符；您可以将它与任何返回函数的表达式一起使用。
你甚至可以写

```
new (function() { ...}) (...); 
```

有关此行为的更多病态极端案例，请参阅[此答案](https://stackoverflow.com/a/5938845/34397)。

# javascript - 如何使用 jquery 找到 div 最深的孩子

> ID：15228600
> 
> 赞同：1
> 
> 时间：2013-03-05T16:08:46.430
> 
> 标签：javascript, jquery

我试图在`div`jquery 指定的元素中找到最深的元素。但是使用的代码正在生成`error` `TypeError: parent.children is not a function`.

我从这个[链接中找到了这段代码](https://stackoverflow.com/questions/4188933/how-do-i-select-the-innermost-element)

代码是：

```
function findDeepestChild(parent) {

    var result = {depth: 0, element: parent};

    parent.children().each(         //Here I getting the error TypeError: parent.children is not a function
        function(idx) {
            var child = $(this);
            var childResult = findDeepestChild(child);
            if (childResult.depth + 1 > result.depth) {
                result = {
                    depth: 1 + childResult.depth, 
                    element: childResult.element};
            }
        }
    );

    return result;
}
---------------------------------------------------------------------------------------
        $(document).on('keypress','#sendComment', function(e) {
    if(e.keyCode==13){
        var itemId=$('#findbefore').prev('.snew').attr('id');//
        var item=findDeepestChild(itemId);
        alert(item);
    }
}); 
```

我`divs`的是：

```
<div id="S04" class="snew" style="display: block;">
    <div class="author-image"></div>
    <span>xyz shared the image xyz</span>
    <div class="s-content">
        <div class="s-message"></div>
        <div class="shpicture">
            <img class="SharedImage" width="100%" height="100%" data-shareid="1" data-alid="1" data-id="1" alt="xyz" src="data:image/jpeg;base64,">
        </div>
    </div>
</div>
<div class="SPcommentbox">
    <div class="comment">
        <div class="commenter-image"></div>
        <div class="addcomment">
            <input class="commentbox" type="text" placeholder="Write a comment...">
        </div>
    </div>
</div> 
```

我需要`img`从这些中找到。

请任何人帮助我....谢谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T16:10:37.183

您使用字符串调用它，但它需要一个 jQuery 实例。

代替

```
var itemId=$('#findbefore').prev('.snew').attr('id');//
var item=findDeepestChild(itemId); 
```

你可能想要

```
var item=findDeepestChild($('#findbefore').prev('.snew')); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T16:10:50.463

您正在传入`itemId`，这是给定元素的 ID 属性。我认为您要传递的是元素本身。只需删除`attr`呼叫，留下这个：

```
var item = findDeepestChild($("#findbefore").prev(".snew")); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T16:25:13.250

要获得最深的嵌套元素，请使用

```
$("#" + parent).find("*").last().siblings().addBack() 
```

[http://jsfiddle.net/6ymUY/1/](http://jsfiddle.net/6ymUY/1/)

然后你可以得到 id 数据属性

```
item.data("id") 
```

[http://jsfiddle.net/6ymUY/2/](http://jsfiddle.net/6ymUY/2/)

完整代码：

```
function findDeepestChild(parent) {
    return $("#" + parent).find("*").last().siblings().addBack();
}
var item=findDeepestChild("S04");
console.log(item)

console.log(item.data("id")); 
```

# intellij-idea - AppCode CMD + F12 菜单 IOS 返回类型

> ID：15228608
> 
> 赞同：0
> 
> 时间：2013-03-05T16:09:13.303
> 
> 标签：intellij-idea, app-code, appcode

当我在 AppCode 中执行`CMD`+`F12`时，我会看到一个方法列表（很高兴也能看到属性，这可能吗？）但我不容易看到它们的返回类型是什么来找出我正在寻找的方法。

有没有办法查看方法列表、它们的返回类型和参数类型（就像在 Java 中一样），我现在看到的只是参数键和方法名称。

谢谢！

# javascript - 输入和文本功能

> ID：15228612
> 
> 赞同：1
> 
> 时间：2013-03-05T16:09:17.947
> 
> 标签：javascript, function, input

我正在尝试创建一个函数，将您单击的文本按从框 1 到框 3 的顺序放入 3 个输入框中。但是使用下面的函数，文本同时出现在框 1 和框 3 中，然后出现在框 2 中。我怎样才能解决这个问题？

```
function setInput(id){
if(hasbeenset)
{
    document.getElementById("myinput2").value= id;
}
else if
(hasbeenset=true)

{
    document.getElementById("myinput").value=id;

}
   else 
    (hasbeenset=true)
   {
    document.getElementById("myinput3").value=id;

   }

   } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-05T16:11:52.370

语法错误，因为您没有为`else if`:

```
}
else if {  // invalid syntax 
```

你应该有：

```
}
else if ( condition goes here ) { 
```

更新：

通过您的编辑，您现在有两个问题。

```
else if
(hasbeenset=true) 
```

这将*设置* `hasbeenset`为 true，并且将始终成功，因为表达式的计算结果为 true。

```
else 
(hasbeenset=true) 
```

这是无效的语法，`else`块从不接受表达式。

# php - preg_replace 的奇怪行为

> ID：15228614
> 
> 赞同：-2
> 
> 时间：2013-03-05T16:09:22.753
> 
> 标签：php, regex

我想切换链接的协议。如果是http，应该变成https，https应该变成http。我正在使用 pre_replace 但出了点问题。

有人可以查看我的代码并告诉我在思考过程中缺少什么吗？

这是代码：

```
 $pattern = array(
                0 => '/^(http\:)/',
                1 => '/^(https\:)/'
            );
            $replace = array(
                0 => 'https:',
                1 => 'http:'
            );

            ksort($pattern);
            ksort($replace);

            $url = 'http://someurl.com';

            echo $url."<br />";

            $url = preg_replace($pattern, $replace, trim($url),1);

            die($url); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T16:17:38.930

1.  你不需要 escape `:`，它不是特殊字符。
2.  您不需要捕获组`()`。
3.  您不需要调用`ksort()`，您的数组在声明它们时已经按键排序。
4.  您的代码似乎将“http”替换为“https” **，**并将“https”替换为“http”。为什么？

`$url = preg_replace('/^http:/', 'https', trim($url));`如果您只是想强制使用 https，它将正常工作。

## 编辑

我仍然不知道为什么有人想要同时切换 http/https，但是你去吧：

```
function protocol_switcheroo($url) {
  if( preg_match('/^http:/', $url) ) {
    return preg_replace('/^http:/', 'https:', $url); // http to https
  } else if( preg_match('/^https:/', $url) ) {
    return preg_replace('/^https:/', 'http:', $url); // https to http
  } else {
    return $url; // for URIs with protocols other than http/https
  }
} 
```

您需要将要替换的调用分开，以免像问题中的原始代码那样意外地将它们链接起来。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T16:24:37.623

这不适用于 http -> https（但适用于 https -> http）的原因是 preg_replace() 首先使用第一组键/变量 (0) 将 http 更改为 https，然后立即返回https -> http，因为每个数组中的第二组变量 (1) 是另一个有效匹配项。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T16:37:06.243

```
//$url = 'http://example.com/https://www';
$url = 'https://example.com/http://www';

$url = (0 === strpos($url, 'http:'))
    ? substr_replace($url, 's:', 4, 1)
    : substr_replace($url, '', 4, 1);

echo $url; 
```

这将转换`HTTP -> HTTPS`和`HTTPS -> HTTP`

它不使用速度较慢的正则表达式，也不使用`str_replace()`可能无意中替换 URL 其他部分的正则表达式。它只会替换第一个前缀。

Breakdown ：查看 URL 是否以HTTPS开头，`http:`是否会替换第 5 个字符。否则，它将用任何内容替换第 5 个字符，使其成为 HTTP。`:``s:``s`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-05T16:27:19.790

您的网址被替换了两次。首先，第一个表达式匹配并`http://someurl.com`变为`https://someurl.com`。然后，第二个表达式匹配并`https://someurl.com`变为`http://someurl.com`。

使用另一个示例更容易看到：

```
echo preg_replace(
    array('/fox/',  '/turtle/'),
    array('turtle', 'sparrow'),
 'fox', 1); 
```

...打印出来`sparrow`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-05T16:43:13.057

您遇到的问题是`preg_replace()`两个替换一个接一个，因此在第一个运行后，第二个会反转第一个的效果。

您需要在一个表达式中指定这两种模式才能让它们一起运行。

我建议使用`preg_replace_callback()`而不是`preg_replace()`. 有了这个，您可以编写更复杂的输出表达式，从而更容易将它们组合成一个模式。像这样的东西可以解决问题：

```
$outputString = preg_replace_callback(
    '/^(http|ftp)(s)?(:)/',
    function($matches) {return $matches[1].($matches[2]=='s'?'':'s').':';},
    $inputString
); 
```

希望有帮助。

[编辑]在 OP 发表评论后，编辑了代码，使其适用于`ftp`/`ftps`和`http`/ 。`https`

# visual-studio - 有没有办法让 Visual Studio 11 智能感知忽略 boost 库

> ID：15228616
> 
> 赞同：6
> 
> 时间：2013-03-05T16:09:27.047
> 
> 标签：visual-studio, boost, intellisense

Intellisense 需要*很*长时间来解析整个 boost 头文件，这也是使 Visual Studio 11 难以使用的原因之一。特别是在我们公司同时拥有许多分支机构的工作流程中。有没有办法：

1.  有一个“主”Intellisense 数据库，它被解析一次并在未来的解决方案/项目中重用？
2.  还是阻止 Intellisense 深入研究 boost？

# grails - 在域对象上设置日历属性

> ID：15228619
> 
> 赞同：0
> 
> 时间：2013-03-05T16:09:35.697
> 
> 标签：grails, grails-2.2

我今天在我的代码中遇到了一个有趣的问题。我正在使用 Grails 2.2.0。

这是代码

```
def user = lookupUserClass().get(params.id)
log.info "[update]user.subscriptionExpiryDate1: " + user.subscriptionExpiryDate
user.subscriptionExpiryDate = Calendar.getInstance();
log.info "[update]user.subscriptionExpiryDate2: " + user.subscriptionExpiryDate
if (user.subscriptionExpiryDate instanceof Calendar ) {
    log.error "***** Is A Calendar Instance ***"
} else if (user.subscriptionExpiryDate instanceof String ) {
    log.error "***** Is A String Instance ***"
}  else {
    log.error "***** Is Something else ***"
}

if (!user.save()) {
    log.error "[update]Error occured saving user. Errors are: "
    user.errors.each { err -> log.error err; }
    render view: 'edit', model: buildUserModel(user)
    return
} else {
    log.info "[update]Successfully saved user"
} 
```

`subscriptionExpiryDate`是我`User`对象中的日历属性。

当我执行保存时，出现以下错误

> 无法将类型“java.lang.String”的属性值转换为属性“subscriptionExpiryDate”所需的类型“java.util.Calendar”；嵌套异常是 java.lang.IllegalArgumentException：无法解析日期：无法解析日期：05/03/2013

谁能解释一下为什么我会在上面的代码中看到这个错误，因为没有什么突出的

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-01T12:14:07.370

这个问题已经按照安德鲁斯的建议解决了

# android - Android DialogPreference 中的上下文菜单...有可能吗？

> ID：15228626
> 
> 赞同：0
> 
> 时间：2013-03-05T16:10:00.357
> 
> 标签：android, contextmenu, dialog-preference

我正在尝试在`DialogPreference`Android 应用程序中创建上下文菜单（如果相关，则针对 API 级别 8）。我已经设法`ListView`通过轻微的黑客攻击来显示菜单（当单击 a 中的项目时），但我不知道如何处理任何生成的命令。到目前为止，我所拥有的是：

*   在我的`onItemClick`处理程序中，我执行以下操作：

    ```
    list.setOnCreateContextMenuListener (new ContextMenuGenerator(control, position));
    list.showContextMenuForChild (control);
    list.setOnCreateContextMenuListener (null); 
    ```

*   `ContextMenuGenerator`执行以下操作：

    ```
    public class ContextMenuGenerator implements OnCreateContextMenuListener
    {
        // additional code redacted - not necessary for this question

        @Override
        public void onCreateContextMenu (ContextMenu menu, View v, ContextMenuInfo menuInfo)
        {
             new MenuInflater(context).inflate (R.menu.address_set_preference_popup, menu); 
        }
    } 
    ```

这会导致在正确的时间显示正确的菜单，但我不知道选择一个项目后会发生什么。我认为是在创建时`onContextItemSelected(MenuItem)`调用的，但我不知道如何从那里获取我可以处理该事件的代码——我没有看到任何子类化的方式，似乎也没有办法将外部侦听器附加到它或. 还有其他我没有想到的方法吗？`Dialog``DialogPreference``Dialog``ContextMenu`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T16:09:27.073

可能无法将侦听器附加到 Dialog 或`ContextMenu`自身，但事实证明包含的单个`MenuItem`s*确实*支持侦听器接口。因此，答案是这样修改：`ContextMenu`*`ContextMenuGenerator`*

 *```
 @Override
    public void onCreateContextMenu (ContextMenu menu, View v, ContextMenuInfo menuInfo)
    {
        new MenuInflater(context).inflate (R.menu.address_set_preference_popup, menu);
        for (int i = 0; i < menu.size (); i ++)
            menu.getItem (i).setOnMenuItemClickListener (listener);
    } 
```

where`listener`是`OnMenuItemClickListener`我传递给构造函数并存储在字段中的。*

# c - C中的全局文件指针声明

> ID：15228627
> 
> 赞同：1
> 
> 时间：2013-03-05T16:10:02.190
> 
> 标签：c, file, pointers, global

全局文件指针声明存在一些问题，因此我遇到了分段错误。GDB 表明它专门出现在函数的`fscanf`行中`sourceToStream`。任何帮助，将不胜感激。

```
#define SOURCE_CODE "source_code.txt"           
#define CHARACTER_STREAM "character_stream.txt"

static FILE* in_fp;
static FILE* out_fp;

void sourceToStream() {
    char buf;

    while(fscanf(in_fp, "%c", &buf) != EOF) {
        if (buf == '\%')
            while(buf!='\n' && buf !='\r' && buf!=EOF)
                fscanf(in_fp, "%c", &buf);

        if(buf != '\n' && buf != '\r' && buf != '\t' && buf != ' ')
            fprintf(out_fp, "%c", buf);
    }
}

int main() {

    in_fp = fopen(SOURCE_CODE, "r");
    out_fp = fopen(CHARACTER_STREAM, "w");

    sourceToStream();

    fclose(in_fp);
    fclose(out_fp);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T16:18:16.363

> 执行第一个 fopen() (gdb) p in_fp $1 = (FILE *) 0x0
> (gdb) p *in_fp 无法访问地址 0x0 处的内存后，GDB 给出以下输出

这意味着您的文件没有正确打开，或者更具体地说， source_code.txt 没有打开以供阅读。

由于您没有在打开命令中包含路径，因此请确保它们位于当前工作目录（您从中执行二进制文件的目录）并确保您具有读/写权限。

因为[`fopen()`](http://www.cplusplus.com/reference/cstdio/fopen/)您可以检查生成的文件句柄是否为 NULL，如果是则打印错误消息：

```
 in_fp = fopen(SOURCE_CODE, "r");
    if(in_fp == NULL) {
        perror("Failed to open the source");
        return EXIT_FAILURE;
    } 
```

例如，如果该文件不存在，您将得到如下信息：

> 打开源失败：没有那个文件或目录

# iphone - 区分动态生成的按钮

> ID：15228629
> 
> 赞同：0
> 
> 时间：2013-03-05T16:10:05.660
> 
> 标签：iphone, ios, objective-c, arrays, cocoa-touch

我在视图控制器上有十个选项，每个选项都“推送”到显示特定数量按钮的同一个新视图控制器（**对于每个选项，可能有不同数量的按钮可用，范围从 3 个按钮到 15 个**）。[目前，我的代码的性能与此问题](https://stackoverflow.com/questions/2646297/add-a-multiple-buttons-to-a-view-programatically-call-the-same-method-determin)上发布的答案相似。

所有这些按钮都是使用 for 循环为每个选项动态创建的（数量显然取决于数组的长度）：

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if(option 1) {
    Array contains different values...
    }

    if(option 2) {
    Array contains different values...
    }

    etc...

    for(int i = 0; i < xCoordinatePosition.count; i++) {
       UIButton *imageOne = [UIButton buttonWithType:UIButtonTypeCustom];
       [imageOne setTag:i];
       [imageOne addTarget:self action:@selector(webViewChanged:) forControlEvents:UIControlEventTouchUpInside];
    }
} 
```

如您所见，我为每个按钮设置了一个标签以区分动态创建的按钮，因为我希望每个按钮`UIWebView`在选择时显示不同。

当我选择了一个选项并 NSLog 结果页面上每个按钮的结果标签时，我得到了我想要的回复：1、2、3 等。

```
- (IBAction)webViewChanged:(UIButton*)sender
{
    NSLog(@"%d", sender.tag);
} 
```

问题是，**对于所有选项按钮，我希望每个按钮都有一个唯一的编号**- 目前我的十个选项中的每一个都返回标签为 1、2、3 等最多十个的按钮，而我需要第一个选项返回使用 1-10，第二个选项返回 11-20 等，因为每个单独的按钮都会返回一些独特的东西。

## 例如：

**单击一个选项上标记为 7 的按钮将带来与单击另一个选项上标记为 7 的按钮完全不同的 Web 视图，因此我需要区分每个按钮。**

有谁知道我如何设置标签，以便每个选项都是唯一的（而不是像当前一样将当前选择的选项的每个按钮设置为唯一的）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T16:26:37.467

只需使用另一个整数变量，它的值是 10 的倍数。

```
int factor;
if(option 1)
{
   factor = 0;
}
if(option 2)
{
   factor = 10;
} 
etc.. 
```

然后把标签作为，

```
[imageOne setTag:i+factor]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T16:28:31.750

如果我正确理解了您的问题，解决问题的一种方法是为每个选项设置一个基本标签，例如 100、200、...

所以，在你的`prepareForSegue`：

```
int baseTag;

if(option 1) {
  // Array contains different values...
  baseTag = 100;
}

if(option 2) {
  // Array contains different values...
  baseTag = 200;
}

// etc... 
```

在 for 循环中，简单地说：

```
[imageOne setTag: baseTag + i]; 
```

对于选项 1，您的图像标签将从 101 开始，对于选项 2，从 201 开始，等等。

# clojure - Partition by a seq of integers

> ID：15228634
> 
> 赞同：9
> 
> 时间：2013-03-05T16:10:15.917
> 
> 标签：clojure

What would be a more idiomatic way to partition a seq based on a seq of integers instead of just one integer?

Here's my implementation:

```
(defn partition-by-seq
  "Return a lazy sequence of lists with a variable number of items each
  determined by the n in ncoll.  Extra values in coll are dropped."
  [ncoll coll]
  (let [partition-coll (mapcat #(repeat % %) ncoll)]
    (->> coll
         (map vector partition-coll)
         (partition-by first)
         (map (partial map last))))) 
```

Then `(partition-by-seq [2 3 6] (range))` yields `((0 1) (2 3 4) (5 6 7 8 9 10))`.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T16:38:23.157

Your implementation looks fine, but there could be a more simple solution which uses simple recursion wrapped in `lazy-seq`(and turns out to be more efficient) than using map and existing partition-by as in your case.

```
(defn partition-by-seq [ncoll coll]
  (if (empty? ncoll)
    '()
    (let [n (first ncoll)]
      (cons (take n coll)
            (lazy-seq (partition-by-seq (rest ncoll) (drop n coll))))))) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-05T19:34:58.167

A variation on Ankur's answer, with a minor addition of laziness and `when-let` instead of an explicit test for `empty?`.

```
 (defn partition-by-seq [parts coll]
    (lazy-seq
      (when-let [s (seq parts)]
        (cons
          (take (first s) coll)
          (partition-by-seq (rest s) (nthrest coll (first s))))))) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-05T16:26:33.787

```
(first (reduce (fn [[r l] n]
                 [(conj r (take n l)) (drop n l)])
               [[] (range)]
               [2 3 6]))

=> [(0 1) (2 3 4) (5 6 7 8 9 10)] 
```

# c++ - 使用 ostream 在 SDL 中使用 opengl 打印分数？

> ID：15228642
> 
> 赞同：0
> 
> 时间：2013-03-05T16:10:25.477
> 
> 标签：c++, sdl

我正在使用以下代码在 SDL 屏幕中打印：

```
SDL_GL_RenderText(  timer, font, color, &position);
sprintf(timer," Time : %d",time); 
```

由于我在 C++ 上进行项目，并且`sprintf`C 样式函数也是如此，所以我不应该使用 sprintf，我正在尝试使用`ostringstream`，但我不确定如何使用它。

有人发布等效的 c++ 样式（使用 ostringstream 或等效）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T16:21:22.350

您可以在任何文档或示例中找到的代码示例..

```
#include <sstream>

std::ostringstream str;
str << "Time: " << time;

// get the std::string
str.str();
// get the C char*
str.str().c_str();

// reset the string stream
str.str("Initial value"); 
```

所以如果你想使用 C char 数组

```
const char* text = str.str().c_str();
SDL_GL_RenderText(text, font, color, &position); 
```

`std::strbuf`实现此目的的另一种方法是使用自定义and包装对 SDL_GL_RenderText 的调用`std::ostream`，这将允许执行以下操作：

```
gl_out << font << color << position << "Timer :" << time << std::flush; 
```

根据字体，颜色和位置有一个真实的类型，而不是像 void* 或简单的 int。如果是这种情况，您可以使用自定义类型包装它们。

这种方法有点复杂，需要对标准 C++ 库中的流管理有很好的理解，但它比 IMO 优雅得多。虽然我从未在 OpenGL 上尝试过，但它可以与 syslog（具有日志级别规范）和其他文本输出媒体一起使用。

# php - 带有 Javascript 和 php 的聊天框

> ID：15228648
> 
> 赞同：-2
> 
> 时间：2013-03-05T16:10:37.210
> 
> 标签：php, javascript, jquery, sql

我正在尝试**仅**使用JavaScript、PHP 和 SQL（确切地说是 PostgreSQL）创建一个聊天框。目前，我必须每 X 秒使用一次 AJAX 请求检查新消息。

现在这里有一些问题。最大的可能是发送到服务器的请求数量。这种活动连接可能会成为带宽杀手。

另一件事是，我们将这些消息保存在我们的数据库中。总是。现在，如果我们检查新消息，我们不想检查整个消息表来只获取我们的新消息。这就是为什么我只想找到新消息并将它们发送给客户。

我见过[棘轮](http://socketo.me/)。看起来非常有趣。不幸的是，这不是现在的解决方案。我有点想自己学习这样做，而不是依赖第三方工具。

从我用谷歌搜索的内容来看，毕竟我需要的不仅仅是这个。如果您对使用某些东西有任何建议，我很想听听。但我现在有点需要在 PHP/SQL/JS 组合中做这个聊天框。

我将如何处理这样的事情？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T16:21:14.113

我个人对这些语言的聊天客户端的偏好包括让 JavaScript 保存最后加载的消息的 ID，并在每次 AJAX 调用时将其传递回 PHP 脚本。然后 PHP 可以查询数据库，只请求 ID 高于给定 ID 的消息。

当用户首次加载页面时，您可以通过加载最近的 10 条消息或最近 5 分钟的消息或任何最适合您的方式来决定如何处理它。

我让 AJAX 每五秒查询一次服务器，即使有大量用户，它的负载也不会太大。

话虽如此，还有更有效的解决方案，包括服务器通知客户端新消息，但它们要复杂得多！如果您不愿意使用预制的解决方案，您应该坚持使用简单的 AJAX 轮询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T16:24:55.180

我要做的是将消息存储在数据库中，并使用 PHP 插入/检索消息，您可以通过会话和不同用户的登录使其变得尽可能复杂，并且在前端您应该使用[jQuery ajax 方法](http://api.jquery.com/jQuery.ajax/)来使用[json_encode](http://php.net/manual/es/function.json-encode.php)调用以 json 或 xml 形式回答的 PHP 方法，以便 javascript 可以解释此信息。

因此，在您的前端代码中，您可以在用户发送消息（将 Enter 键绑定到输入）并使用[setInterval](http://www.w3schools.com/jsref/met_win_setinterval.asp)进行轮询时执行 ajax 发布请求，或者您可以使用[像 APE 这样的推送库](http://www.ape-project.org/)来实现推送系统这将使用更少的带宽，但这将需要更好的服务器并在服务器中配置一个 Cron，以便每次有新消息时都会检查。

关于数据库，您可以确定哪个用户使用该用户 IP 发送了消息并将其存储在消息表中。

# jquery - 不知道如何配置 jquery 文件树

> ID：15228650
> 
> 赞同：0
> 
> 时间：2013-03-05T16:10:38.157
> 
> 标签：jquery, css, file, tree, filetree

[刚刚在http://www.abeautifulsite.net/blog/2008/03/jquery-file-tree/](http://www.abeautifulsite.net/blog/2008/03/jquery-file-tree/)看到了一个文件树，不知道怎么配置。我想手动添加项目和子项目，但我不知道如何做到这一点。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T16:37:13.870

### 笔记：

你知道你不需要手动添加项目吗？如果是这样，请阅读本节。如果您确实想手动添加项目，请继续下一部分。图书馆通过“连接器”为您解决这个问题。下载库时，您将拥有一个包含各种语言连接器的子文件夹。我正在运行 IIS 服务器，所以我使用`jqueryFileTree.aspx` 连接器。在我的 JavaScript 中，我运行以下代码将文件树添加到元素`#filetree`：

```
$('#filetree').fileTree({
    root: '/',
    script: '/jqueryFileTree.aspx'
}, function(filename) {
    alert('You selected ' + filename);
}); 
```

所以添加项目实际上只是将文件或目录添加到`root`参数引用的路径中。

### 手动添加项目

如果您真的想手动添加项目，您需要首先查看底层 DOM 元素的结构。这是一个例子：

```
<div id="filetree" class="">
<ul class="jqueryFileTree" style="">
    <li class="directory expanded">
        <a href="#" rel="/sub/">sub</a>
        <ul class="jqueryFileTree" style="">
            <li class="file ext_txt">
                <a href="#" rel="/sub/file3.txt">file3.txt</a>
            </li>
        </ul>
    </li>
    <li class="file ext_txt"><a href="#" rel="/file1.txt">file1.txt</a></li>
    <li class="file ext_txt"><a href="#" rel="/file2.txt">file2.txt</a></li>
</ul>
</div> 
```

正如您在此示例中所见，FileTree 已添加到`<div id="#filetree"/>`. 根文件夹由 first 表示，该`<ul/>`文件夹中的每个项目由 a 表示，`<li/>`其类为`'file'`或`'directory'`。在本示例的目录中，另一个`<ul/>`具有相同格式的目录嵌套在“sub”下，`<li/>`以表示“sub”文件夹的内容。这是一个可以无限期地继续下去的递归结构。

手动添加项目就像使用 jQuery.append() 或 jQuery.appendTo() 添加`<li/>`具有正确属性的新项目一样简单。您只需要选择正确的元素作为添加项目的目标。

文件的一个示例是：

```
var liFile = $('<li/>',{
    'class' = 'file ext_txt'
}).append(
    $('<a/>',{
        'href' = '#',
        'rel'  = '/file4.txt'
    }).append(
        'file4.txt'
    )
); 
```

这将创建以下 HTML：`<li class="file ext_txt"><a href="#" rel="/file4.txt">file4.txt</a></li>`.

现在只需选择正确的元素来添加它。如果您只是将其添加到根目录，这应该很容易，只需执行以下操作：

```
$('#filetree ul').append(liFile); 
```

您还可以查看 FileTree 库的源代码。它只有大约 60 行代码（如果您排除注释）。

# json - 如何在 Node.js 中解析包含“NaN”的 JSON 字符串

> ID：15228651
> 
> 赞同：30
> 
> 时间：2013-03-05T16:10:38.353
> 
> 标签：json, node.js, gson

有一个 node.js 应用程序正在接收包含文字 NaN 的 JSON 数据字符串，例如

```
 "[1, 2, 3, NaN, 5, 6]" 
```

`JSON.parse(...)`这在 Node.js 中崩溃。如果可以的话，我想将其解析为一个对象。

我知道`NaN`不是 JSON 规范的一部分。大多数 SO 链接（[在 json 中发送 NaN](https://stackoverflow.com/questions/6601812/sending-nan-in-json)）建议修复输出。

在这里，虽然数据是在我无法控制的服务器中生成的，但它是由一个商业 Java 库生成的，我可以在其中看到源代码。它由 Google 的 Gson 库生成：

```
private Gson gson = (new GsonBuilder().serializeSpecialFloatingPointValues().create()); 
... 
gson.toJson(data[i], Vector.class, jsonOut) 
```

所以这似乎是一个合法的来源。根据[Gson API Javadoc](http://google-gson.googlecode.com/svn/trunk/gson/docs/javadocs/com/google/gson/GsonBuilder.html#serializeSpecialFloatingPointValues%28%29)，它说我应该能够解析它：

> JSON 规范的第 2.4 节不允许特殊的双精度值（NaN、Infinity、-Infinity）。但是，Javascript 规范（参见第 4.3.20、4.3.22、4.3.23 节）允许这些值作为有效的 Javascript 值。此外，大多数 JavaScript 引擎将毫无问题地接受 JSON 中的这些特殊值。因此，在实际层面上，接受这些值作为有效的 JSON 是有意义的，即使 JSON 规范不允许它们。

尽管如此，这在 Node.js 和 Chrome 中都失败了： `JSON.parse('[1,2,3,NaN,"5"]')`

**JSON.parse() 中是否有要设置的标志？或者接受`NaN`作为文字的替代解析器？**

我已经在谷歌上搜索了一段时间，但似乎找不到关于这个问题的文档。

[PHP：如何将无穷大或 NaN 数字编码为 JSON？](https://stackoverflow.com/questions/13581843/php-how-to-encode-infinity-or-nan-numbers-to-json/13582033#13582033)

* * *

## 回答 #1

> 赞同：51
> 
> 时间：2013-03-05T16:13:18.163

> 有一个 node.js 应用程序正在接收包含文字 NaN 的 JSON 数据字符串，例如

然后你的 NodeJS 应用程序**没有**接收[JSON](http://json.org)，它接收到的文本有点类似于 JSON。`NaN`不是有效的 JSON 令牌。

三个选项：

### 1.获取源正确生成JSON

这显然是首选课程。数据不是 JSON，应该修复，这将解决您的问题。

### `NaN`2.以简单的方式容忍：

`null`您可以在解析之前将其替换为，例如：

```
var result = JSON.parse(yourString.replace(/\bNaN\b/g, "null")); 
```

...然后`null`在结果中处理 s 。但这很简单，它不允许字符`NaN`出现在某个字符串中的可能性。

或者，旋转 Matt Ball 的`reviver`想法*（现已删除）*，您可以将其更改为特殊字符串（如`"***NaN***"`），然后使用 reviver 将其替换为 real `NaN`：

```
var result = JSON.parse(yourString.replace(/\bNaN\b/g, '"***NaN***"'), function(key, value) {
    return value === "***NaN***" ? NaN : value;
}); 
```

...但是假设角色`NaN`从未出现在适当的位置，那么这同样具有头脑简单的问题。

### 3.使用*（颤抖！）* `eval`

***如果您知道并信任此数据的来源，并且在传输过程中不可能被篡改***，那么您可以使用`eval`来解析它而不是`JSON.parse`. 由于`eval`允许完整的 JavaScript 语法，包括`NaN`，它有效。希望我的警告足够大胆，让人们明白我只会在*极*少数情况下推荐这个。但同样，请记住`eval`允许任意执行代码，因此如果字符串有任何被篡改的可能性，请不要使用它。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-04-25T06:51:35.160

当您处理任何数学或行业数据时，`NaN`它非常方便（通常也是无穷大）。它是自 IEEE754 以来的行业标准。

这显然是为什么一些库，尤其是 GSON，允许您将它们包含在它们生成的 JSON 中，从而失去标准纯度并获得理智。

当您交换复杂的动态对象时，Revival 和正则表达式解决方案在实际项目中无法可靠使用。

并且`eval`也有问题，其中一个是当 JSON 字符串很大时它很容易在 IE 上崩溃，另一个是安全风险。

这就是为什么我编写了一个特定的解析器（用于生产）：[JSON.parseMore](https://github.com/Canop/JSON.parseMore)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2018-11-07T09:59:53.883

您可以使用[JSON5](https://json5.org/)库。项目页面的引用：

> JSON5 数据交换格式 (JSON5) 是 JSON 的超集，旨在通过扩展其语法以包含来自 ECMAScript 5.1 的一些产品来缓解 JSON 的一些限制。
> 
> 这个 JavaScript 库是 JSON5 解析和序列化库的官方参考实现。

如您所料，它确实支持解析 NaN（与 Python 等序列化它们的方式兼容）：

```
JSON5.parse("[1, 2, 3, NaN, 5, 6]")
> (6) [1, 2, 3, NaN, 5, 6] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-03-11T19:36:41.640

正确的解决方案是重新编译解析器，并为源代码库贡献一个“allowNan”布尔标志。这是其他库的解决方案（想到了python）。

好的 JSON 库将允许解析几乎任何与 JSON 类似且带有正确标志的东西（perl 的 JSON.pm 非常灵活）......但是在编写消息时，它们会生成标准 JSON。

IE：让房间比你发现的更干净。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-08-10T14:56:14.330

只是对 TJ Crowder 已经足够全面的回复的一个小补充，我宁愿使用

```
var result = JSON.parse(yourString.replace(/\bNaN\b/g, '"NaN"')); 
```

因为我实际上需要知道它是否是 NaN 值。

此外，我会在 fetch 或 axios GET 请求中执行此操作，前提是默认 JSON 解析失败并且数据以字符串形式出现。

```
const StringConstructor = "".constructor;

if (data.constructor === StringConstructor) {
    data = JSON.parse(tableData.data.replace(/\bNaN\b/g, '"NaN"'))
} 
```

# python - 在 pyx/pxd 文件中使用函数工厂为 C 库生成 cython 函数包装器

> ID：15228654
> 
> 赞同：4
> 
> 时间：2013-03-05T16:10:47.787
> 
> 标签：python, numpy, cython, python-c-extension

我正在重新评估将外部 C 库包装到 Python 中的不同方法。我很久以前就选择使用简单的 Python C API，它快速、简单、独立，而且，正如我所想的那样，它是面向未来的。然后我偶然发现了`PyPy`，它显然不打算支持 CPython API，但将来可能会成为一个有趣的替代方案......因此我正在寻找更高级别的入口点。`ctypes`速度很慢，所以现在我又回到了`cython`，这似乎在努力支持 PyPy。

我的库有许多具有相同签名的函数，因此我广泛使用 C 预处理器宏来生成 Python 模块。我认为这在 cython 中会变得更舒服，因为我可以访问整个 Python 语言。但是，我在为我的函数包装器编写工厂时遇到了麻烦：

```
import cython
from numpy cimport ndarray, double_t

cimport my_c_library

cdef my_c_library.data D

ctypedef double_t DTYPE_t

cdef parse_args(ndarray[DTYPE_t] P, ndarray[DTYPE_t] x, ndarray[DTYPE_t] y):
    D.n = P.size
    D.m = x.size
    D.P = <double*> P.data
    D.x = <double*> x.data
    D.y = <double*> y.data

def _fun_factory(name):
    cpdef fun(ndarray[DTYPE_t] P, ndarray[DTYPE_t] x, ndarray[DTYPE_t] y):
        parse_args(P, x, y)
        getattr(my_c_library, name)(&D)
        return y
    return fun

fun1 = _fun_factory('fun1')
fun2 = _fun_factory('fun2')
# ... many more function definitions ... 
```

cython 编译器抱怨：“这里不允许 C 函数定义”，指的是`cpdef`内部`_fun_factory`。这里有什么问题？我认为`pyx`文件就像普通的 python 文件一样。除了从单独的 python 脚本动态生成文件之外，有没有办法让它工作`pyx`，例如`setup.py`？

我也很惊讶 cython 不允许我这样做：

```
ctypedef ndarray[double_t, ndim=1] p_t 
```

清理代码。为什么这不起作用？

我知道那里有自动`C -> cython`翻译器，但我不愿意让自己依赖这样的第 3 方工具。但是，如果您认为它已准备好用于生产，请随时提出建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T16:16:34.150

`pyx`文件与 Python 文件不同，因为您可以匹配 C 和 Python 函数，并且对您可以使用 C (`cdef`或`cpdef`) 函数执行的操作有一些限制。一方面，您不能在运行时动态生成 C 代码，而这正是您的代码试图做的。由于`fun`实际上只是在对参数进行类型检查后执行一些 Python 代码，因此您不妨将其设为常规 Python 函数：

```
def fun(P, x, y):
    parse_args(P, x, y)
    getattr(my_c_library, name)(&D)
    return y 
```

`parse_args`将进行相同的参数检查，因此您不会丢失任何内容。（不过，我不确定是否`getattr`适用于'd'的 C 库`cimport`。你可能也想要`import`它。）

至于`ctypedef`，这可能是 Cython 中的一些限制/错误，还没有人能够修复。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T18:12:11.837

在玩了更多之后，以下似乎有效：

```
def _fun_factory(fun_wrap):
    def fun(P, x, y):
        parse_args(P, x, y)
        fun_wrap()
        return y
    return fun

def _fun1(): my_c_library.fun1(&D)
def _fun2(): my_c_library.fun2(&D)
# ... many more ...

fun1 = _fun_factory(_fun1)
fun2 = _fun_factory(_fun2)
# ... many more... 
```

所以似乎不可能对像这样的表达式使用任何 Python 操作`my_c_library.fun1(&D)`，显然需要按原样输入。只有在已经生成了第一组 Python 包装器时，才能在第二次传递中使用该工厂。这并不比显而易见的更优雅：

```
cpdef fun1(ndarray[DTYPE_t] P, ndarray[DTYPE_t] x, ndarray[DTYPE_t] y):
    parse_args(P, x, y)
    my_c_function.fun1(&D)
    return y

# ... many more ... 
```

在这里，`cpdef`可以毫无问题地使用。所以我要采用复制粘贴方法......将来还有人对 Cython 的预处理器宏感兴趣吗？

# c# - WriteLine into files - Same position for text sections

> ID：15228658
> 
> 赞同：1
> 
> 时间：2013-03-05T16:10:53.387
> 
> 标签：c#, formatting

I'm generating a list of names and values. Unformatted it looks like this:

```
 - Atrox (Jesse Stone) - Level: 4
 - InternetInk (Benjamin Chiryoku) - Level: 4
 - Eliot_Ness (James Carter) - Level: 4
 - Kones (Dmitri Schukov) - Level: 4
 - 611er (Falk vanAlk) - Level: 3
 - Julian (Linus Torvalds) - Level: 2
 - Bot (Staat) - Level: 1
 - Hawke (Garen Hawke) - Level: 1 
```

But I want it to look like this:

```
- Atrox (Jesse Stone)                   - Level: 4
- InternetInk (Benjamin Chiryoku)       - Level: 4
- Eliot_Ness (James Carter)             - Level: 4
- Kones (Dmitri Schukov)                - Level: 4
- 611er (Falk vanAlk)                   - Level: 3
- Julian (Linus Torvalds)               - Level: 2
- Bot (Staat)                           - Level: 1
- Hawke (Garen Hawke)                   - Level: 1 
```

My line for writing is:

`fileWriter.WriteLine(" - " + player.accountName + " (" + player.charName + ") - Level: " + player.level);`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T16:16:17.097

Use [String.PadRight()](http://msdn.microsoft.com/en-us/library/36f2hz3a%28v=vs.100%29.aspx) method:

```
public string FormatPlayerInfo(string accountName, string charName, string level)
{
    int padRight = 45;
    string account = String.Format("- {0} ({1})", accountName,
                                                charName)
                            .PadRight(padRight);
    return String.Format("{0} - Level: {1}", account, level);
} 
```

Usage:

```
file.WriteLine(FormatPlayerInfo(
                 player.accountName, 
                 player.charName, 
                 player.level)); 
```

# javascript - 在node.js和jade上解析带有多个复选框的表单结果

> ID：15228660
> 
> 赞同：1
> 
> 时间：2013-03-05T16:10:55.823
> 
> 标签：javascript, forms, node.js, pug, checkbox

我有这个表格，但我找不到以数组形式返回结果的方法。如何做呢？我正在尝试获取此表单结果，以便可以将它们保存为 mongodb 文档中的字段。我知道保存它的过程，但不知道如何以有用的方式检索它。

```
form.form-inline(type = 'checkbox', action='/settings', method='post')
    label.checkbox.inline
        input#inlineCheckbox1(type='checkbox',value='en')
        | English
    label.checkbox.inline
        input#inlineCheckbox2(type='checkbox',value='ger')
        | German
    label.checkbox.inline
        input#inlineCheckbox3(type='checkbox',value='spa')
        | Spanish
    label.checkbox.inline
        input#inlineCheckbox3(type='checkbox',value='it')
        | Italian
    label.checkbox.inline
        input#inlineCheckbox3(type='checkbox',value='jap')
        | Japanese
    p
        button.btn(type='submit') Save 
```

更新

我在服务器上使用过 var arr = Object.keys(req.body) 但我只得到“英语”，没有别的......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T17:17:58.313

1.  表单类型不应为“复选框”。
2.  为每个复选框命名。
3.  使用 req.body 中的指定名称（它们应该是 true/undefined）。

# jqgrid - jqGrid 重载服务器

> ID：15228663
> 
> 赞同：0
> 
> 时间：2013-03-05T16:11:03.937
> 
> 标签：jqgrid, refresh, restore

我有一个表格，里面有我想要排序和过滤的数据。

我实现了一个自动刷新功能，每次都从服务器加载数据，但我想恢复排序和过滤选项，我可以这样做。

我使用`trigger("reloadGrid",[{current:true}])`，将数据类型设置为 json ，以便在函数中从服务器检索数据，并在带有 a`autorefresh`的方法中使用排序和过滤选项，如其他 stackoverflow 问题中所述。`loadcomplete``setTimeout`

这行得通，但是每次刷新网格时，我都会在一秒钟内看到带有完整数据的网格，没有排序也没有过滤，然后数据在本地排序/过滤。

鉴于我想要 5 秒的自动刷新，有没有办法可以阻止该方法在`reloadGrid`有服务器请求但等待刷新显示时显示完整数据？`reload``loadComplete`

函数中使用的重载`autorefresh`：

```
$("#MyGrid").jqGrid("setGridParam",{url:"list.php", datatype:"json"}).trigger("reloadGrid",[{current:true}]); 
```

模型 ：

```
jQuery("#MyGrid").jqGrid({
  url:'list.php',  
  datatype: "json",
  loadonce:true,
  ...
  loadComplete: function(){
    if ($("#MyGrid").jqGrid("getGridParam", "datatype") !== "local") {
      setTimeout(function () {
        $("#MyGrid").jqGrid("setGridParam",{search:srch,postData:post});
      })
    };
  } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-30T13:10:36.980

您可以使用 setInterval JavaScript 函数进行自动刷新

```
var grid = $("#list"),
intervalId = setInterval(
    function() {
        grid.trigger("reloadGrid",[{current:true}]);
    },
    60000); // Every 1 min 
```

要停止网格重新加载，您可以使用另外一个 JavaScript 函数：

```
clearInterval(intervalId); 
```

在“reloadGrid”中，我使用了鲜为人知的参数 current:true，这里描述了它来保留网格中的当前选择。

您可以[按给定的时间间隔查看 Reload Jqgrid](https://stackoverflow.com/questions/5297007/reload-jqgrid-by-given-interval)

# c# - XMLDSig X509SerialNumber 太大而不能成为 int，XSD 验证失败

> ID：15228666
> 
> 赞同：2
> 
> 时间：2013-03-05T16:11:08.460
> 
> 标签：c#, digital-signature, x509certificate, x509certificate2, xml-dsig

我正在尝试使用 X509 证书创建 XMLDSig。我从 MS ( [http://msdn.microsoft.com/en-us/library/system.security.cryptography.xml.x509issuerserial.aspx](http://msdn.microsoft.com/en-us/library/system.security.cryptography.xml.x509issuerserial.aspx) ) 运行逐字示例，它生成下面的 XML。XML 的问题在于 X509SerialNumber 字段太长而不能成为 int，而这正是 XSD 指定它必须的。因此，当我尝试对签名进行 XSD 验证时，它会失败。

我收到的错误消息是：“ [http://www.w3.org/2000/09/xmldsig#:X509SerialNumber](http://www.w3.org/2000/09/xmldsig#:X509SerialNumber) ”元素无效 - 值“72620403068401703770138453672807553309”根据其数据类型“ [http://www. w3.org/2001/XMLSchema:integer](http://www.w3.org/2001/XMLSchema:integer) ' - 字符串 '72620403068401703770138453672807553309' 不是有效的整数值。

如何获得 X509SerialNumber 的正确值？

提前致谢！

```
<Signature xmlns="http://www.w3.org/2000/09/xmldsig#">
  <SignedInfo>
    <CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315" />
    <SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1" />
    <Reference URI="">
      <Transforms>
        <Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature" />
      </Transforms>
      <DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1" />
      <DigestValue>zSI5ZAMmQ+8u7R2rP7aAPT6nNQw=</DigestValue>
    </Reference>
  </SignedInfo>
  <SignatureValue>Tx4rqqDae4vdi5sTjARf0AlBiIGWnx2D8ET+ogGD9FtjrX4ZuYlsOG03Zk5KPKDpC/T45XlWaZpZdCtvAWtv0zwL1/jXxlU2BomQFNXm7rb9YoqlTh8nISStiZKizhmMQynW6GRsXGIpkK37Hnip4c8H1U+eSC/taKW4oyUmg40W64+ZyntovpBt2GqIJQu4AFvMfiF2azV9pg/qZ7IYNOgwmrUG6F0t2RhT2hqR9YRePjrfyIebZvYrLwjTQPXGOzzc2utRILAEhzGNSqsvpf5YeVrmuX75E8Zs3JuaicXu4mgDPYxNNVE2membNQMl6ggllfFjxPnvIofbb/KJ4Q==</SignatureValue>
  <KeyInfo>
    <X509Data>
      <X509IssuerSerial>
        <X509IssuerName>CN=XMLDSIG_Test</X509IssuerName>
        <X509SerialNumber>72620403068401703770138453672807553309</X509SerialNumber>
      </X509IssuerSerial>
      <X509Certificate>MIIDIDCCAgygAwIBAgIQNqIuTm7QSrZClm5/JrLZHTAJBgUrDgMCHQUAMCMxITAfBgNVBAMeGABYAE0ATABEAFMASQBHAF8AVABlAHMAdDAeFw0xMDAxMDEwNjAwMDBaFw0yMDAxMDEwNjAwMDBaMCMxITAfBgNVBAMeGABYAE0ATABEAFMASQBHAF8AVABlAHMAdDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAMl9hSOn53/2W2//EC8HUgwO7Hwpqx0/yTwth0w3amefwZcfu/+7k9rB+mnviCy6G/9uGzb0Mld+L3RVXisAx9zr2l6LVFjzImY1alwZ01z6AiDdllFPqO7BoSJSozMh0k+vdVQYR3lvgLNyKxXmrTayIWhioQeteIo6HuChz8HI/DNdzoO8axGbLuhy34pogG1gAQr3pTn16Pkd4Mu02KoRz90dryt09wuAk1P/jsePYHBeLQeJSLGojWp1sqypxr25FQiqJantyVLXRRmv7IauTTThSSNrREMcTzbpCx7B4tvyocNwGZysYcdJVsyjbxJRLqutQDlID6QykqkL9O8CAwEAAaNYMFYwVAYDVR0BBE0wS4AQ0N2edJbnLN9AE7hLcICPNaElMCMxITAfBgNVBAMeGABYAE0ATABEAFMASQBHAF8AVABlAHMAdIIQNqIuTm7QSrZClm5/JrLZHTAJBgUrDgMCHQUAA4IBAQC5Nf5SGjqIzQqVnwJbP22RqSHrITAPlymGYfP/qST8Q9V5h5aX8idcGMt3lShUbexXAlKcpQLO4ZzUrjjP3H5Jc659sRSDaeqHGXE0ZMTJpvwA871WH/sGZ8tB7/yuHVsP9hPTImwwDCWx9mYDz8LxpvK11beq/tEilZQxLTvMP0MuT5A6YdCcCc4GkeDV0KVFF+VLEO8OkaWDVXUNMe/AJBHrXuHbQPrUb7s67FKH+b/2GVjBBkM6YI9JtL/A96Y2uf6drhOz6C7wfky2XQOe/7v87/YGEshObBawBA1/OB1AVa+A2WVOosisEGi7iJqszQTdF6TLqGB5eDsiZCH2</X509Certificate>
    </X509Data>
  </KeyInfo>
</Signature> 
```

我正在使用来自以下 URL 的 XSD：

[http://www.w3.org/2000/09/xmldsig#](http://www.w3.org/2000/09/xmldsig#)

这是我验证 XSD 的代码：

```
 XmlElement xmlDigitalSignature = signedXml.GetXml();

    var xEl = XElement.Parse(xmlDigitalSignature.OuterXml);
    var xDoc = XDocument.Load(xEl.CreateReader());

    XSDValidator.ValidateSignature(xDoc);

public class XSDValidator
{
    public static void ValidateSignature(XDocument document)
    {
        var schemaSet = new XmlSchemaSet();
        var assm = Assembly.GetExecutingAssembly();
        using (var stream = assm.GetManifestResourceStream("JayTest1.XMLSignature.xsd"))
        {
            schemaSet.Add(XmlSchema.Read(stream, null));
        }
        var isValid = true;
        string errorMessage = null;

        document.Validate(schemaSet, (o, e) =>
        {
            errorMessage = e.Message;
            isValid = false;
        });
        if (!isValid)
        {
            Console.WriteLine("XSD is not valid: " + errorMessage);
        }
        else
        {
            Console.WriteLine("GOOD!");
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T12:11:15.797

根据[RFC 5280 ，](http://www.ietf.org/rfc/rfc5280.txt) *序列号可以预期包含长整数：*

> 证书用户必须能够处理最多 20 个八位字节的序列号值。符合标准的 CA 不得使用超过 20 个八位字节的 serialNumber 值。

*（关于序列号的第 4.1.2.2 节）*

您的序列号**7262040306 8401703770 1384536728 07553309**只有 38 位数字，即使它们是十六进制数字，也可以轻松地放入 20 字节长的整数中。

在[XML 签名语法和处理（第二版）](http://www.w3.org/TR/xmldsig-core/)（和[模式文件](http://www.w3.org/TR/xmldsig-core/xmldsig-core-schema.xsd)）中，元素`X509SerialNumber`被定义为

```
<element name="X509SerialNumber" type="integer"/> 
```

根据定义，`integer`它允许任意整数值：

> **整数**是通过将*fractionDigits*的值固定为 0从**十进制***派生*而来的。这导致了整数的标准数学概念。整数的*值空间*是无限集{...,-2,-1,0,1,2,...}。整数的*基本类型*是十进制。

 ******（[XML Schema Part 2: Datatypes](http://www.w3.org/TR/2001/REC-xmlschema-2-20010502/#integer)的第 3.3.13 节）*

因此，您可能想要检查您的架构文件或您的 XSD 验证器。

**编辑**

虽然您的代码基于[XML 签名语法和处理](http://www.w3.org/2000/09/xmldsig#)而不是[XML 签名语法和处理（第二版）](http://www.w3.org/TR/xmldsig-core/)，但我的回答是，这并没有什么区别，因为在这两种情况下`X509SerialNumber`都被定义为`integer`没有进一步限制。

因此，这是您的验证器的问题。我不知道这是一个错误还是仅仅是一些配置或定制问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-05-22T18:01:50.290

.NET XSD 验证器`xs:integer`尝试通过将其解析为 C# `decimal`( [https://referencesource.microsoft.com/#System.Xml/System/Xml/Schema/DataTypeImplementation.cs,2874](https://referencesource.microsoft.com/#System.Xml/System/Xml/Schema/DataTypeImplementation.cs,2874) , [https://referencesource .microsoft.com/#System.Xml/System/Xml/XmlConvert.cs,3e8716fb1936c48d](https://referencesource.microsoft.com/#System.Xml/System/Xml/XmlConvert.cs,3e8716fb1936c48d)）。

十进制的范围为正 79,228,162,514,264,337,593,543,950,335 到负 79,228,162,514,264,337,593,543,950,335 ( [https://docs.microsoft.com/en-us/dotnet/api/system.decimal?view=netframework-4.7](https://docs.microsoft.com/en-us/dotnet/api/system.decimal?view=netframework-4.7) )，或 2 位。

此限制确实超过了[http://www.w3.org/TR/2001/REC-xmlschema-2-20010502/#decimal](http://www.w3.org/TR/2001/REC-xmlschema-2-20010502/#decimal)的最小值：

> 注意：所有·最低限度符合·处理器·必须·支持十进制数，至少有 18 个十进制数字（即，有 18 个·totalDigits）。但是，··最低限度符合··处理器··可能·对它们准备支持的最大十进制位数设置应用程序定义的限制...

如果您觉得这阻碍了这些类型的有效使用（不仅仅是测试场景，尽管这些也很重要）[https://github.com/dotnet/corefx/issues/](https://github.com/dotnet/corefx/issues/)将是搜索要投票的问题的地方（或找不到，创建一个新的）。*****

# sql - 如何在 SQL Server 中引用触发器的“新”、“旧”行？

> ID：15228670
> 
> 赞同：1
> 
> 时间：2013-03-05T16:11:16.363
> 
> 标签：sql, sql-server

所以我是 SQLite 的 SQL Server 新手，我习惯于使用 New|Old 关键字。我看到有些人使用该`inserted`值来引用新创建的行，但这仅适用于插入而不适用于更新。如何获得类似于`New`我在此查询中使用的内容？

```
create trigger ports_country_id_in_check
on [SISTEMA].Puerto
after insert, update
AS
BEGIN
  update [SISTEMA].Puerto
  set country_id = (select secuencia from [SISTEMA].Pais where codigo = New.pais_asociado)
  where [SISTEMA].Puerto.secuencia = New.secuencia
end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T16:14:39.473

插入也将适用于更新。一个更新的行将被视为已删除和插入的行。因此，您可以检查过去和现在的情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-10T02:27:44.167

```
create trigger ports_country_id_in_check
on [SISTEMA].Puerto
after insert, update
AS
BEGIN
  Declare @pais_asociado, @secuencia int

  select @pais_asociado = Puerto.pais_asociado, @secuencia = Puerto.secuencia
  from Puerto join inserted
  where Puerto.secuencia = inserted.secuencia

  update [SISTEMA].Puerto
  set country_id = (select secuencia from [SISTEMA].Pais where codigo = @pais_asociado)
  where [SISTEMA].Puerto.secuencia = @secuencia
end 
```

# c# - LINQ to Entities 字符串对列进行十进制

> ID：15228671
> 
> 赞同：4
> 
> 时间：2013-03-05T16:11:18.257
> 
> 标签：c#, asp.net, linq, entity-framework

我已经把这个问题研究到死了。每个人和他们的兄弟都想知道如何将 int 或 decimal 转换为字符串，但我找不到任何使用 EF 进行相反操作的示例。

我的数据源在数据库中有一个 varchar 类型的 order total_amt 列。原因是源数据已加密。解密器就地这样做。我可以将其重写为解密到临时表，然后将这些结果插入到正确类型的表中，但这需要分配更多的工作，无论是现在还是在我们扩展应用程序的数据库更新期间。

我希望能够投射列，但我不知道如何使用 Linq 和 EF 做到这一点。

```
public ActionResult Orders_Read([DataSourceRequest]DataSourceRequest request) {
var db = new Ecommerce_DecryptedEntities();
var orders = from s in db.Orders
                where s.Order_Complete == true
                select new { 
                    s.Order_Id, 
                    s.MySEL_Name, 
                    s.MySEL_EMail, 
                    s.MySEL_Bus_Name,
                    s.Total_Amt,
                    s.Order_Complete_DateTime
                };
DataSourceResult result = orders.ToDataSourceResult(request);
return Json(result, JsonRequestBehavior.AllowGet);
} 
```

注意：结果需要是 iQueryable。我真的不想列出这个，因为这会从数据库中提取所有数据。这被绑定到 Telerik KendoUI Grid，该网格正在传递分页、排序和其他参数（请注意，它使用传入的请求转换为 KendoUI 的 ToDataSourceResult，其中包含上述分页、排序等数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T16:20:55.987

您必须先获取数据，`List<Order>`然后才能投射任何您想要的东西。

```
var orders = 
    from s in
        ((from o in db.Orders
        where o.Order_Complete
        select o).ToList())
    select new { 
        s.Order_Id, 
        s.MySEL_Name, 
        s.MySEL_EMail, 
        s.MySEL_Bus_Name,
        Double.Parse(s.Total_Amt),
        s.Order_Complete_DateTime
    }; 
```

我认为 EMS 方式在您的代码中看起来会更好；）

```
var orders =
    db.Orders.Where(s => s.Order_Complete).ToList().Select(s => new { /*...*/ } 
```

转换后`ToList()`，您已经获得了基于数据对象并可以对其进行修改，如果您不这样做，您可以使用`Double.Parse`，因为 EF 正在尝试在数据库中查找例如存储过程并且会抛出异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T21:12:39.220

您是否尝试过模型定义的函数？

```
<Function Name="ConvertToDecimal" ReturnType="Edm.Decimal">
     <Parameter Name="myStr" Type="Edm.String" />
     <DefiningExpression>
          CAST(myStr AS Edm.Decimal(12, 2))
     </DefiningExpression>
 </Function> 
```

检查这个答案：[Convert string to decimal in group join linq query](https://stackoverflow.com/questions/12216043/convert-string-to-decimal-in-group-join-linq-query#answer-12217789)

# sql - T-SQL 中的 LIKE 查询

> ID：15228674
> 
> 赞同：0
> 
> 时间：2013-03-05T16:11:19.753
> 
> 标签：sql, sql-server, tsql, wildcard, where

通过以下使用 LIKE 的查询，我没有得到想要的结果。我可以使用 WHERE 子句吗？

```
UPDATE TABLE
SET ALPHA = 'ABC'
WHERE ALPHA LIKE 'ABC%' 

UPDATE TABLE
SET ALPHA = 'ABCCC' 
WHERE ALPHA LIKE ‘ABCC%'

Bt90Abc Abc
bt91Abc Abc
bt19abcCC      ABCCC
bt16abcSTAT ABC 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T16:23:04.417

您可以使用`CASE`语句来执行更新：

```
update yourtable 
set alpha = case 
              when alpha like '%abcc%' then 'ABCC'
              when alpha like '%abc%' then 'ABC'
              else alpha
            end
where alpha like '%abc%'; 
```

请参阅[SQL Fiddle with Demo](http://sqlfiddle.com/#!3/4d36fb/1)。

`LIKE`这将使用您的值更新与 中的条件匹配的任何行。如果没有，则`alpha`不会更新该值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T16:20:26.200

粗略一看，您可能会在这里遇到两个突出的问题。

-字符串比较区分大小写，您正在搜索大写字母，而它可能包含小写字母。尝试在 where 子句中的列周围放置一个 UPPER。

-其次，您似乎正在搜索不以 ABC 开头的 ABC 字符串。在这种情况下，您应该使用 '%ABC%' 作为 where 子句。

为了获得更好的输入，您应该提供有关您的问题的更多信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T16:20:58.237

通过阅读您的评论：

```
UPDATE TABLE
SET ALPHA = CASE WHEN ALPHA IN ('bt90abc','bt91abc') THEN 'ABC' 
                 WHEN ALPHA IN ('bt19abc')  THEN 'ABCCC'
            ELSE ALPHA END
WHERE ALPHA IN ('bt90abc','bt91abc','bt19abc') 
```

# opengl - 预乘 Alpha 和 Alpha 测试

> ID：15228678
> 
> 赞同：3
> 
> 时间：2013-03-05T16:11:22.760
> 
> 标签：opengl, directx, shader, alpha

我有一个应该用于 alpha 混合或 alpha 测试的着色器，但传入的颜色值是预乘的 alpha 值。

在使用预乘 alpha 时，是否有一种简单/标准的方法可以让它为 alpha 混合和 alpha 测试产生“正确”的结果？

例如，如果我的着色器的最终结果是`RGBA(1,0,0,0.75)`直接 alpha 并且因此是`RGBA(0.75,0,0,0.75)`预乘 alpha，则结果应该`RGBA(1,0,0,0.75)`在 alpha 测试时保留。

如果我们进行 alpha 测试，也许一种选择是“划分”alpha 通道，即除以`R`上面的值`A`，以便我们得到`0.75/0.75 = 1.0`原始红色值。但是当 alpha 变为 0 时，这变得不确定。

假设后台缓冲区是`RGBA(1,1,1,1)`，并且我正在使用部分透明的绿色`RGBA(0,1,0,0.75)`（直接 alpha）进行渲染。颜色作为预乘 alpha 传入`RGBA(0,0.75,0,0.75)`。当 alpha*混合*时，我使用 one + invsrcalpha 混合并获得最终颜色`RGBA(0.25,1,0.25,1)`。所以我的绿色通道保持在 100%，因为后台缓冲区有 100% 的绿色，我原来的绿色也是如此，所以在绿色通道上没有办法低于 100%。

在进行Alpha*测试*时，不会进行混合。相反，我的绿色将作为`RGBA(0,0.75,0,1)`. 但我想要的颜色是`RGBA(0,1,0,1)`。

# regex - 如何在两个标记之间捕获文本？

> ID：15228680
> 
> 赞同：0
> 
> 时间：2013-03-05T16:11:28.787
> 
> 标签：regex

为了清楚起见，我创建了这个：

[http://rubular.com/r/ejYgKSufD4](http://rubular.com/r/ejYgKSufD4)

我的弦：

```
http://blablalba.com/foo/bar_soap/foo/dir2
http://blablalba.com/foo/bar_soap/dir
http://blablalba.com/foo/bar_soap 
```

我的正则表达式：

```
\/foo\/(.*) 
```

这将返回：

```
/foo/bar_soap/dir/dir2
/foo/bar_soap/dir
/foo/bar_soap 
```

但我只想

```
/foo/bar_soap 
```

有什么想法可以实现这一目标吗？如上所示，我想要 foo 之后的所有内容，直到第一个正斜杠。

提前致谢。

编辑。我只想要文本，`foo`直到下一个正斜杠之后。某些目录也可能被命名为`foo`，这会导致不正确的结果。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T16:16:36.033

`.`将匹配任何内容，因此您应该将其更改为`[^/]`（而不是斜线）：

```
\/foo\/([^\/]*) 
```

其他一些答案使用`+`而不是`*`. 这可能是正确的，具体取决于您想要做什么。Using`+`强制正则表达式匹配至少一个非斜杠字符，因此该 URL 将不匹配，因为斜杠后面没有尾随字符：

[http://blablalba.com/foo/](http://blablalba.com/foo/)

使用`*`相反将允许匹配，因为它匹配“零个或多个”非斜杠字符。因此，您是否应该使用`+`或`*`取决于您想要允许的匹配项。

***更新***

如果您也想过滤掉[查询字符串](http://en.wikipedia.org/wiki/Query_string)，您还可以过滤`?`，它必须位于所有查询字符串的前面。（我认为您在下面发布的示例实际上缺少前导`?`）：

```
\/foo\/([^?\/]*) 
```

但是，与其推出自己的解决方案，不如直接[`split`从 URI 模块](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/uri/rdoc/URI.html#method-c-split)中使用。您可以使用`URI::split`获取 URL 的*路径*部分，然后使用`String#split`将其拆分为`/`，并获取第一个。这将处理 URL 的所有奇怪情况。您可能还没有想到的是带有指定*片段*的 URL ，例如：

[http://blablalba.com/foo#bar](http://blablalba.com/foo#bar)

您还需要添加`#`到您的过滤字符类来处理这些。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T16:13:15.553

`\/foo\/([^\/]+)`

`[^\/]+`给你一系列不是正斜杠的字符。

括号导致正则表达式引擎将匹配的内容存储在一个组`([^\/]+)`中，因此您可以`bar_soap`退出整个匹配`/foo/bar_soap`

例如，在 javascript 中，您将获得匹配的组，如下所示：

```
regexp = /\/foo\/([^\/]+)/ ;
match = regexp.exec("/foo/bar_soap/dir");
console.log(match[1]);  // prints bar_soap 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T16:13:27.773

你可以试试这个正则表达式

```
/\/foo\/([^\/]+)/ 
```

# jquery - 获取表中某个类的元素的值

> ID：15228682
> 
> 赞同：0
> 
> 时间：2013-03-05T16:11:31.387
> 
> 标签：jquery, html-table

我有一张表，我在下面粘贴了它的代码。我想在这里使用 jQuery 来获取类位置的值（即 0 ）。我写了一个jQuery： `$('.row').children('td').find('.position').val();`

但是我没有得到想要的结果！

```
<tr style="background-color: rgb(200, 200, 200);" id="node-25275" class="child-of-node-0 row byte_lenght_1 initialized">
<td style="padding-left: 34px;"> abcd </td>
<td style="padding-left: 15px">  loc_type  </td>
<td style="padding-left: 15px">  <input id="main_type">  </td>
<td class="length" style="padding-left: 15px">   1  </td>
<td class="position" style="padding-left: 15px">  0  </td>
<td style="padding-left: 15px">   <input type="hidden" name="row" value="25275"></td>
</tr> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-05T16:13:03.777

```
$('.row').find('td.position').text(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T16:14:09.050

尝试这个：

```
$('td.position').text() 
```

# xcode - Xcode 4.6 - 分发配置文件的“未找到有效签名身份”

> ID：15228683
> 
> 赞同：5
> 
> 时间：2013-03-05T16:11:33.297
> 
> 标签：xcode, app-store, distribution, provisioning

我正在检查向 App Store 提交应用程序的过程，我在这里遇到了一些麻烦。我一直在关注[本教程](http://developer.apple.com/library/ios/#documentation/ToolsLanguages/Conceptual/YourFirstAppStoreSubmission/SubmitYourApp/SubmitYourApp.html#//apple_ref/doc/uid/TP40011375-CH7-SW1)。

我创建了一个分发配置文件，我将其下载并添加到 Window - Organizer - Devices 中，拖入侧边栏中“库”标题下的“Provisioning Profiles”中。我看到的是这样的：

![这是它的图像。](../Images/422e3f0c9749fa12e12748a2702a1508.png)

我已经尝试撤销我的所有证书并将它们再次添加到我的钥匙串访问中，但它没有帮助。即使在 Xcode 中刷新配置文件之后。

另外，我读到如果我改变我正在使用的机器，这种情况经常发生，但这不是我的情况。我已经在同一台 Mac 上开发了该应用程序，我现在正在使用。

如果需要，我愿意提供更多信息以帮助解决此问题。提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-03-05T16:20:19.437

检查事项：

1.  确保在 Keychain Access 中您需要使用的证书中存储了私钥。 ![钥匙串访问](../Images/fa8ae29791c4442b64b795ec31f55eb5.png)

2.  确保包标识符与您拥有的 AppID 完全匹配（除非您使用通配符标识符）

3.  确保您选择的配置文件使用创建的证书。 ![配置文件](../Images/2938df61a76acb4ea74f235c3237769d.png)

4.  确保您下载了该配置文件并使用它来签署目标的分发设置。

如果这一切都完成了，它应该可以正常工作。

此外，我还谈到了 iOS 的证书和配置。 [这是](http://irockios.com/wp-content/uploads/2013/02/iOS-Enterprise-Development-Keynote.pdf)主题演讲 PDF 的链接，它解释了我如何做事的过程。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-09-28T23:57:43.667

只需重新启动 XCode。

有时一切都通过文档完成，但 XCode 无法正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T17:10:59.880

如果您仍然被此问题困扰，请尝试再次执行整个过程。

转到钥匙串，删除所有 iPhone 证书，然后做一些日常工作。由于某种原因，我以前遇到过这个问题，所以我只是重做。好在不需要很长时间，只需 5 分钟 :)

希望这可以帮到你。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-22T21:54:27.000

**解决方案**：我通过简单地选择开发配置文件和身份并构建和运行然后切换回分发配置文件和分发身份，解决了我最近运行的这个问题。

**背景**：我的构建昨晚工作，我切换到不同的分支，尝试以相同的方式签名，但它只是继续失败/说没有匹配的有效签名身份）。

我尝试重新启动 Xcode，重新启动 Mac，删除无效/过期的配置文件等。然后只是出于测试运行的需要，我切换到开发配置文件（我正在使用分发配置文件测试 IAP），然后当我切换回来时，它刚刚工作！

在此过程中奇怪的一件事是设备上的配置文件似乎与我在磁盘上的配置文件不匹配，并且在此过程中，当我尝试将磁盘上的配置文件添加到设备时，它没有突出显示为有效选择（我的开发者是）。

即使在运行之后，设备仍然显示相同 mobileprovision 的某些不同版本（不同的初始代码和到期日与我所拥有的不同。我在共享设备环境中工作，所以我没有完全访问/可见性这些版本都来自哪里）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-09-25T17:48:26.830

我通过打开 KeyChain Utility 并删除过期的配置文件解决了这个问题。我按照所有说明在developers.apple.com 的会员页面更新了我的个人资料。

然后用 Xcode 4.6 打开我的应用程序。在 Build Settings 下用我的名字选择 iPhone Developer。

我的问题是旧的开发人员资料 ID 和新的 ID 相同，我没有意识到这一点。删除旧的允许使用新的。

# java - 日历视图原型

> ID：15228696
> 
> 赞同：0
> 
> 时间：2013-03-05T16:12:44.310
> 
> 标签：java, javascript, prototype

我想使用[http://calendarview.org/](http://calendarview.org/)中的日历来选择一个日期并将该日期发送到一个 servlet，该 servlet 会获取该周的信息。

如何获取我选择的日期的值？当我查看 HTML 时，它不在其中。它是使用一些 AJAX 设置的吗？如果是这样，我如何获得该值？有什么方法可以在选择日期后自动调用 servlet？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T16:16:16.200

当然，一旦单击日期，您可以调用任何 javascript 可以调用的方法，如果它使用 AJAX，则可能不需要...，只要知道您可以使用非常 sim javascript 创建类似的动态日历。

# html - 如何防止html5页面缓存？

> ID：15228697
> 
> 赞同：29
> 
> 时间：2013-03-05T16:12:45.510
> 
> 标签：html, caching

我将一个普通的 HTML 页面转换为具有响应式布局的 HMTL5/CSS3，并且出于安全原因（由安全人员规定），该页面绝不能缓存。

以前使用的页面`<meta http-equiv="Pragma" content="no-cache">`并`<meta http-equiv="Expires" content="-1">`防止页面被缓存。

什么在 HTML5 中取代了它？如何防止 html 页面在客户端缓存？

我花了一周时间阅读清单文件，但它们似乎与我想要的完全相反，因为明确附加清单文件会导致它附加到缓存的页面。

并且请不要让我回到 w3c 关于现在允许哪些元元素的定义——我知道 HTML5 不包含`cache-control`or元素`Pragma`。`meta`

我需要知道它包含的内容会阻止页面被缓存。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2013-03-05T16:24:36.703

在代码的开头你需要使用这个：

```
<!DOCTYPE html>
<html manifest="manifest.appcache">
... 
```

然后`manifest.appcache`用这样的内容创建：

```
缓存清单

# 缓存清单版本 1.0

# 没有缓存

网络：
*

```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-07-04T02:42:50.890

我非常不喜欢 appcache。它几乎工作得很好，但可能是一个真正的无情的痛苦。在进行一些代码重构时，我意识到注销后，我可以浏览回最后一页。当然，刷新浏览器会强制用户重新登录，但这是不希望的。

搜索并查看选项后，我开始有点沮丧。我不想使用 appcache。然后我意识到我的代码在销毁会话后重定向到登录页面并有了一个想法，如果我重定向到主页怎么办？瞧，页面已加载，会话检查（当然不存在），用户重定向到登录。问题解决了。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-09-25T04:26:09.720

很长一段时间以来，我一直在为同样的问题苦苦挣扎。对我有用的东西——至少到目前为止——在 Chrome、FF 和 IE 中执行以下操作：

1) 引用清单文件 据`<html lang="nl" manifest="filename.appcache">`我了解，这将缓存此 HTML 文档中的所有内容，因此需要一个清单文件防止这种情况发生：

2）使用具有以下内容的清单文件 filename.appcache 基本上说：对于所有文件，不要从缓存中读取，而是从网络服务器中读取：

```
CACHE MANIFEST
# 2015-09-25 time 20:33 UTC v 1.01 
NETWORK:
* 
```

3) 需要第三步：**每次您上传网站的（部分）更新时，还要**通过更改注释（#）行中的日期和时间戳来更改清单文件。为什么？因为如果您不更改清单文件，它将不会被读取，它将默认为第 1 步，从而缓存并从缓存中读取。然而，清单文件被改变的事实强制再次读取清单文件，从而强制再次应用其中的“不从缓存读取而是从网络服务器读取”指令。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-10-05T15:38:03.960

先前的[答案](https://stackoverflow.com/a/32774798/5374772) 可能无法始终如一地防止缓存或清除 chrome 中的现有缓存，但有一种解决方法。

1) 要清除 chrome 中的现有缓存，可能需要**更新网站的*所有*文件**（例如，通过链接到每个页面上的新 css 文件）**以及缓存清单的更新，**然后才能清除 chrome 中的现有缓存页面的第二次访问（因为页面呈现方式的“流程”：第一次访问页面时，浏览器读取并缓存清单，同时继续从现有缓存加载。仅在第二次访问将读取并应用新存储的更新清单）。

2）如果这些都没有帮助，可以**在清单文件本身中包含一个脚本**来检查新的清单，如果找到，重新加载它并使用新的清单。这起到了作用，并解决了我测试的所有剩余情况，文件在 chrome 中保持持久缓存。我在Jason Stimpel的[这个页面上找到了这个脚本。](https://developer.teradata.com/blog/js186040/2011/11/html5-cache-manifest-an-off-label-usage)

```
<script type="text/javascript">
window.addEventListener('load', function (e) {
window.applicationCache.addEventListener('updateready', function (e) {
        window.location.reload();
    }, false);
}, false);
</script> 
```

# javascript - 获取裁剪元素的 boundingClientRect

> ID：15228698
> 
> 赞同：1
> 
> 时间：2013-03-05T16:12:51.250
> 
> 标签：javascript, svg

我需要获取已被裁剪的 SVGElement 的 boundingClientRect - 使用此信息，我想将 HTML 元素放置在 SVG 元素的顶部。

我的 SVG 看起来像这样（简化，原来的有多个级联视口和多个级联变换）：

```
<svg width="96" height="80">
  <clippath id="clip">
    <path d="M 0 0 L 96 0 L 96 80 L 0 80 Z"/>
  </clippath>
  <g clip-path="url(#clip)">
    <image x="0" y="-8" width="96" height="96" xlink:href="…" transform="…"/>
  </g>
</svg> 
```

我想将 HTML 元素放在 SVGGElement 之上。为此，我得到了 boundingClientRect

*   被定位的 HTMLElement
*   HTMLElements 父级
*   元素 ？这使我可以在应用了 Clipping 的情况下获得 SVGGelement 的 boundingClientRect

在 Chrome 中，这是通过获取 SVGPathElement 的 boundingClientRect 来实现的。在 Opera 和 Firefox 中，生成的 clientRect 的宽度和高度为 0（可能是因为路径元素没有显示）。SVGGelement 本身的 boundingClientRect 从包含的 SVGImageElement 获取其尺寸，而不管应用的剪辑路径如何。

我尝试通过 SVGUseElement 引用 SVGPathElement 并获取它的 boundingClientRect - 这似乎有效。

是否真的有必要引入另一个设置为可见性隐藏和指针事件的 DOM 元素：无或有人知道更好的解决方案吗？

# visual-c++ - 如何将数据加载到 MFC 应用程序向导生成的属性数据库类中？

> ID：15228705
> 
> 赞同：1
> 
> 时间：2013-03-05T16:13:07.970
> 
> 标签：visual-c++, mfc, visual-studio-2012, atl, visual-c++-2012

使用 Visual C++ 2012 中的 MFCApplication 向导，如果选中“生成属性数据库类”，则会生成具有一些特殊语法（属性 C++ 类）的标头，如下所示：

```
// MFCApplication2Set.h: interface of the CMFCApplication2Set class
//

#pragma once

// code generated on March-05-13, 9:26 AM

[
    db_source(L"Provider=SQLNCLI11.1;..."),
    db_table(L"dbo.tblEmployee")
]
class CMFCApplication2Set
{
public:
... big list of stuff that corresponds to the fields in your db table omitted ...
} 
```

上面的头文件对应一个大部分为空的实现文件：

```
// MFCApplication2Set.cpp : implementation of the CMFCApplication2Set class
//

#include "stdafx.h"
#include "MFCApplication2.h"
#include "MFCApplication2Set.h"

#ifdef _DEBUG
#define new DEBUG_NEW
#endif

// CMFCApplication2Set implementation 
```

那是整个实现类。请注意：

A. 没有在任何地方指定父类名称。B. 这里有一些“Visual C++ 魔法”，也就是说，作为现代 C++ 的新手，我迷路了。 `db_source`记录[在这里](http://msdn.microsoft.com/en-us/library/ws9w5a0e%28v=vs.110%29.aspx)，但文档很薄，或者至少对我来说是不透明的。

问题：

1.  当我第一次看到它时，我被这个语法迷住了，但我发现它可能是Visual C++中这个[属性特性的一个变体。](http://msdn.microsoft.com/en-us/library/windows/apps/hh877381.aspx)就是这样，对吧？

2.  我打算如何使用这些生成的“属性数据库类”对象？我找到[了这个文档](http://msdn.microsoft.com/en-us/library/wda1743k.aspx)，但是如果您仔细查看该文档，该代码示例向人们展示了旧方式和新方式，并没有告诉我我想知道什么是如何使用 IDE 无法使用的这个新对象给我任何文档或代码完成功能。此外，由于生成的代码`CMFCApplication2Set`向导生成的类没有引用任何类型或类名，我迷路了。如果我什至可以使用一些 IDE 功能来知道什么方法和东西被神奇地注入了这个神奇的神秘对象，我会更好。我能想到的唯一想法就是学习旧方法并从旧的两个分离的 ATL 类型世界中学习所有可以调用的东西，然后以某种方式学习将它们组合起来。

简而言之，我正在寻找实际使用其中一个属性数据库类实例（变量）所需了解的最低语法，因为它们是由向导在新的 MFC 应用程序中生成的。下面显示的实例是 MFC 文档类的成员，`CMFCApplication2Set m_MFCApplication2Set`并被声明为 MFC 文档类中的字段。

我尝试过的是使用这个“无类型对象”。该对象似乎有很多数据字段 (m_X)，并且只有一种方法显示在 IDE 代码完成中，称为`GetRowSetProperties`. 由于发生了任何魔法或注入，这个生成的属性数据库类（它不会明显继承任何东西）在编辑时和编译时对我来说完全是一个谜。

这是我只是试图检查这个东西，看看它是否在它的构造函数运行时初始化了自己：

```
BOOL CMFCApplication2Doc::OnNewDocument() {     if (!CDocument::OnNewDocument())        return FALSE;

        TRACE( m_MFCApplication2Set.m_AStringFieldName); // outputs NOISE.

    return TRUE; } 
```

在编译时和编辑时，IDE 没有给我任何关于这个“匿名”类所涉及的类型的帮助，该类从无到有继承，但是由于我猜测的那些属性的某种注入，它获得了很多秘密权力。在调试时，我可以看到这个 C++ 类中不仅仅是一堆数据字段，但这仍然不能帮助我知道如何使用它。使用其中一个从数据库中获取记录集的最小代码示例会很棒。

![在此处输入图像描述](../Images/52ce40e0b9268dcb8afebcee74e23940.png)

更新：调用`OpenDataSource`很有趣，因为它可以编译，但 IDE 认为它不应该是有效的。尽管如此，它运行，并返回 0 作为结果，但这实际上并没有初始化这个[CThingyThatVisualStudioGaveYouThatYouDontKnowWhatItIs](http://www.ifwiki.org/index.php/The_Hitchhiker%27s_Guide_to_the_Galaxy)：

![在此处输入图像描述](../Images/40be309a45e211f9db86ec17c6b03552.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T20:13:11.003

这是属性化 C++ 代码的弃用功能。预处理器扩展代码并用实际的基类替换属性。如果您启用这些中间文件的生成，您会更清楚：

![在此处输入图像描述](../Images/3b67de4a145a14a8353cdfad55f0bf52.png)

您将`XXX.mrg.cpp`生成`XXX.mrg.h`文件，您可以查看并查看转发给编译器的*真实C++ 代码。*

属性将被替换的基类、映射[`BEGIN_COLUMN_MAP`](http://msdn.microsoft.com/en-us/library/k8ef5853%28v=vs.80%29.aspx)等替换。属性源代码很紧凑，但该功能已被弃用，并且查看扩展代码应该很容易（如有必要）剥离属性并将扩展代码直接复制到源代码中. 使用 DB 属性很容易，而使用 COM 属性更难，因为内部依赖关系最复杂。

# javascript - 文本调整大小仅适用于部分内容

> ID：15228706
> 
> 赞同：1
> 
> 时间：2013-03-05T16:13:08.780
> 
> 标签：javascript, css, wordpress

我在我的 wordpress 网站中添加了一些 javascript 来调整文本大小。它似乎只适用于某些内容（即标题和电子邮件注册）。

[http://test.hestiacare.co.uk/](http://test.hestiacare.co.uk/)

知道如何将其应用于所有内容吗？

```
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script type="text/javascript" language="javascript">
$(document).ready(function(){
  // Reset Font Size
  var originalFontSize = $('html').css('font-size');
    $(".resetFont").click(function(){
    $('html').css('font-size', originalFontSize);
  });
  // Increase Font Size
  $(".increaseFont").click(function(){
    var currentFontSize = $('html').css('font-size');
    var currentFontSizeNum = parseFloat(currentFontSize, 10);
    var newFontSize = currentFontSizeNum*1.2;
    $('html').css('font-size', newFontSize);
    return false;
  });
  // Decrease Font Size
  $(".decreaseFont").click(function(){
    var currentFontSize = $('html').css('font-size');
    var currentFontSizeNum = parseFloat(currentFontSize, 10);
    var newFontSize = currentFontSizeNum*0.8;
    $('html').css('font-size', newFontSize);
    return false;
  });
});
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T16:29:34.987

它可能与此有关，在`style.css`：

```
.entry-content {
    font-size: 13px;
} 
```

如果我将其注释掉，则正文会随其他所有内容一起调整大小。如果有其他内容没有调整大小，您可能需要找到类似的像素大小的条目。

# extjs - Extjs4 将所有网格数据保存在一个表中

> ID：15228713
> 
> 赞同：1
> 
> 时间：2013-03-05T16:13:21.547
> 
> 标签：extjs

我知道如何从网格的选定行中获取值，就像这样：

```
var records = Ext.getCmp('My_Grid').getSelectionModel().getSelection();
var record  = records.length === 1 ? records[0] : null;
alert(record.get('name')); 
```

但我想要的是获取`name`网格的所有行。为此，我使用了上面的方法，编写了这个函数：

```
var MonTableau = new Array();
for (var j=0; j<=Ext.getCmp('My_Grid').getStore().getCount()-1; j++) {
Ext.getCmp('My_Grid').getView().select(j);
var records = Ext.getCmp('My_Grid').getSelectionModel().getSelection();
var record  = records.length === 1 ? records[0] : null;
MonTableau[j+1]=record.get('name');
                } 
```

但它不专业，我想要更简单和专业的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T16:33:23.893

ExtJS 存储提供了一个函数，它为存储中*缓存*（已加载）的每个记录[`each`](http://docs.sencha.com/ext-js/4-1/#!/api/Ext.data.Store-method-each)应用传递：`fn`

 *```
var myStore = Ext.getCmp('My_Grid').getStore();
myStore.each(function(rec) {
    console.log(rec.get('name'));
}); 
```

PS我正在使用`console.log();`而不是`alert();`我认为从浏览器日志中读取所有内容更容易。*

# javascript - JS 的参数 - 这是最好的方法？

> ID：15228714
> 
> 赞同：3
> 
> 时间：2013-03-05T16:13:24.457
> 
> 标签：javascript, jquery, html, regex, performance

我想加载一个 JS，他的行为应该根据一个参数而有所不同。我认为这样做的方法之一可能是：

```
<script src="script.js?type=a" type="text/javascript"></script>
<script src="script.js?type=b" type="text/javascript"></script>
... 
```

然后，我将使用正则表达式获取参数，例如：

```
function getURLParameter(name) {
    return decodeURIComponent((new RegExp('[?|&]' + name + '=' + '([^&;]+?)(&|#|;|$)').exec(location.search)||[,""])[1].replace(/\+/g, '%20'))||null;
} 
```

（上面的函数来自[这里](https://stackoverflow.com/questions/1403888/get-url-parameter-with-jquery)）。

但是，我不确定这是否是最好的方法。您是否建议任何其他方式来执行此操作，例如在 JS 中加载全局变量`<script></script>`，然后从 JS 中读取它们？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-05T16:16:21.263

一般来说，组织代码可能有更好的方法，但配置参数比 URL 查询更简单的方法是简单地使用参数调用定义的函数：

外部脚本（foo.js）：

```
function foo(param) {
    console.log(param);
} 
```

HTML：

```
<script src="foo.js"></script>
<script>foo("parameter value");</script> 
```

编辑：这是一个“配置”参数而不立即调用任何东西的示例（基本上，一个简单的闭包）：

```
function (param) {
    $(document).ready(function () {
        // Use param
    });
} 
```

`$(document).ready`已经是一个异步调用，所以这比其他方法更简单，但通常您可以使用 IIFE（立即调用函数表达式）：`(function (param) { })(paramValue)`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T16:16:46.960

您提供的`getURLParameter`功能将使用您在地址栏中看到的 URL，而不是`<script>`加载的那个。

为此，您需要替换`location.search`为

```
Array.prototype.pop.call(document.getElementsByTagName('script')).getAttribute("src"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T16:17:19.237

您可以在 php 中制作 javascript 并使用

```
var parameters = <?php echo json_encode($_GET); ?>
function getURLParameter(name) {
    return parameters[name];
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-05T16:15:29.740

我会在获取外部脚本之前设置一个全局变量，然后在内部使用它：

```
<script>var someParameter = 'a';</script>
<script src="script.js"></script> 
```

# vba - VBA循环条件在任意行数后停止评估

> ID：15228717
> 
> 赞同：2
> 
> 时间：2013-03-05T16:13:25.650
> 
> 标签：vba, loops, excel, for-loop, while-loop

这是我的代码。代码本身似乎可以工作，但由于某种原因，条件语句在第 32645 行之后停止。我尝试将所有变量切换为 Long，但没有帮助。

此外，如果我让它从第 32646 行开始，然后在后面的随机行 (~18000) 停止，则代码可以工作。它停止的数据似乎没有相似之处。最初我尝试了一个指定开始行和结束行的 for 循环，但这也不起作用，所以我尝试了 while 循环（理论上两者都应该工作，但似乎都没有）。

它需要能够处理 130,000 + 行，知道为什么会发生这种情况吗？

**问题**

循环停止运行而没有错误，通过添加一个消息框，我知道我的行递增变量在最后一行结束，但根据工作簿，条件语句在任意行数后停止评估。

如果我从第一次运行停止的下面的行开始运行脚本，它可以工作，但同样适用于（可能不同的）任意数量的步骤。

*笔记*

我已将所有变量设为“长”类型。我使用了选项显式。

```
data_row = CLng(InputBox("Please enter the row number of the first data entry"))
Worksheets.Add(After:=Worksheets(1)).name = "Formatted_Output"

Set ws = Sheets("Formatted_Output")
Worksheets(1).Activate
LastCol = ActiveSheet.UsedRange.Columns(ActiveSheet.UsedRange.Columns.Count).Column
LastRow = ActiveSheet.UsedRange.Rows(ActiveSheet.UsedRange.Rows.Count).row
data_col = LastCol

 'loop through entries to get account and permissions
 increment = data_row
 Do Until increment = LastRow
    If Cells(data_row, data_col) = "" Then
        data_col = data_col - 1
    Else
   ' ~> For illegal ==> access denied permission that throws errors
        If Cells(data_row, data_col).Value = "==>access denied" Then
            permissions = "access denied" 'remove illegal =
            ws.Cells(output_row, 3).Value = permissions 'print permissions to output file
        Else
            permissions = Cells(data_row, data_col).Value 'cell should be permission cell of each row
            ws.Cells(output_row, 3).Value = permissions 'print permissions to output file
        End If

        data_col = data_col - 1 'domain / account cell is now highlighted

        If InStrRev(Cells(data_row, data_col).Value, "?") > 0 Then

            account = Split(Cells(data_row, data_col).Value, "?")(1) & Str(unknown_count) ' separate domain name and unknown id
            unknown_count = unknown_count + 1 ' counting the number of unkown accounts found
            ws.Cells(output_row, 2) = account 'print unknown account Id to output

            domain_bit = Split(Cells(data_row, data_col).Value, "?")(0) '' get separate domain name from id cell
            data_col = data_col - 1 'domain second from end cell is now highlighted

            Do While data_col > 0 'generate domain from rest of row
                domain_bit = Cells(data_row, data_col).Value & domain_bit 'domain built backwards
                data_col = data_col - 1 'check next column for more of location name
            Loop

            ws.Cells(output_row, 1) = domain_bit
                'data_col = LastCol
                'data_row = data_row + 1
                'output_row = output_row + 1

        ElseIf InStrRev(Cells(data_row, data_col).Value, "\") > 0 Then

            account = Split(Cells(data_row, data_col).Value, "\")(1) 'separate account ID
            ws.Cells(output_row, 2) = account 'print account ID to oputput

            domain_bit = Split(Cells(data_row, data_col).Value, "\")(0)
            data_col = data_col - 1 'domain second from end cell is now highlighted

            Do While data_col > 0 'generate domain from rest of row
                domain_bit = Cells(data_row, data_col).Value & domain_bit 'domain built backwards
                data_col = data_col - 1 'check next column for more of location name
            Loop

            ws.Cells(output_row, 1) = domain_bit 'output to file

        Else
                         account = Cells(data_row, data_col).Value 'account is just whole cell whether empty or one word no path
            ws.Cells(output_row, 2) = account 'print account ID to oputput

            data_col = data_col - 1 'domain second from end cell is now highlighted (since no domain in account cell)
            Do While data_col > 0 'generate domain from rest of row
                domain_bit = Cells(data_row, data_col).Value & domain_bit 'domain built backwards
                data_col = data_col - 1 'check next column for more of location name
            Loop

            ws.Cells(output_row, 1) = domain_bit 'output to file
        End If

    data_col = LastCol
    data_row = data_row + 1
    output_row = output_row + 1
    End If

'Next increment
ws.Range("E" & 1) = unknown_count
increment = increment + 1

If increment = LastRow Then
    MsgBox (Str(increment) & "=" & Str(LastRow))
End If

Loop 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T12:02:42.150

我相信您的第一个总体 if 语句没有按照应有的方式进行，如果发现它是真的`data_row`变量不会增加，从而禁用自动行增加。

如果这是您想要的，那么`increment`变量需要在 if 语句中移动，因为它会增加而与`data_row`变量无关。

我认为a`for-next`会更好：

```
for data_row = 1 to LastRow
    'do some stuff
next 
```

这将循环遍历所有行 1 到`LastRow`每次迭代。

* * *

**添加了更好的答案：**

```
Do Until increment > LastRow
    ...
    data_col = LastCol
    data_row = data_row + 1
    output_row = output_row + 1
    increment = increment + 1
    End If

    If increment > LastRow Then
        MsgBox (Str(increment) & ">" & Str(LastRow))
    End If
Loop 
```

# c - C void 指针算术

> ID：15228723
> 
> 赞同：5
> 
> 时间：2013-03-05T16:13:54.527
> 
> 标签：c, pointers

我认为在 gcc 中，void * 和 char * 在指针运算方面的处理方式相同，即 void * “指向”内存中的单个字节，所以下面的代码

```
void *p;
p = malloc(sizeof(void));
printf("%p %p\n",p,p+1); 
```

确实返回`0x984a008 0x984a009`。同样， void ** 指向一个指针，因此递增 1 实际上意味着递增 4 个字节（在 32 位操作系统上），即

```
void **p;
p = (void **) malloc(sizeof(void *));
printf("%p %p\n",p,p+1); 
```

返回`0x984a008 0x984a00c`。但是，下面的代码让我感到困惑

```
void **p, *p1;
p = (void **) malloc(sizeof(void *));
p1 = (void **) p;
printf("%p %p\n",p1,p1+1); 
```

既然又回来了`0x984a008 0x984a009`。这里发生了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-05T16:29:26.157

Ignoring the possible undefined behaviour of `void` pointer arithmetic for the moment...

The type of `p1` is `void *`.

You can't change a variable's type by assigning a value of a different type to it. `p1` will always stay `void *`.

Any expression of a different type assigned to it will implicitly be cast to `void *` (or give an error if it can not).

Thus it's essentially the same as the first example.

**EDIT:**

As far as I know, casting from one pointer type to another doesn't actually do anything, its main purpose is for type-checking.

A pointer is just a memory address, a number, so essentially the memory looks something like: (post-assignment)

```
 p1       p2
void *   void** <- these types are fixed and known during compilation
------   ------
|1234|   |1234|         at address 1234 = the 4 bytes from malloc
------   ------
  ^
  |
this value is the only thing that will change by assigning p1 to a different value 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-05T16:30:21.830

You should use `char *` instead of `void *`, since arithmetic on pointer to `void` is a gcc extension.

```
char *p1 = /* ... */;

printf("%p %p\n", p1, p1+1); 
```

Whatever points `p`, the pointer arithmetic on `p` uses `char *` type (not `char **`).

If you write:

```
char *p1 = /* ... */;

printf("%p %p\n", p1, (char**)p1+1); 
```

Pointer arithmetic uses `char **`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-05T16:28:05.737

使用 操作时`void *`，增量为1。使用 时`void **`，它是指针的大小。

在使您感到困惑的操作中，您的`void *`演员 to`void **`被隐式地重新转换为`void *`. 就好像你这样做了：

```
long a, b, c;
c = a + (int) b; 
```

你投到`b`，`int`但是你想用 a 操作`long`，所以它被投回了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-05T16:25:37.207

void 指针不能递增。这是未定义的行为。

相关问题： [将 void 指针增加一个字节？两个？](https://stackoverflow.com/questions/6449935/increment-void-pointer-by-one-byte-by-two)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-06-27T14:24:52.543

我知道我要在一年多后发帖，但我碰巧遇到了这个问题，这让我很感兴趣。

我同意@Dukeling 的观点，即您不能仅通过强制转换来更改变量的类型。但这似乎取决于编译器认为`void`是什么。以这个示例程序为例，看看结果输出。`vp`请注意，和之间的唯一区别`vp2`是.`sizeof()``malloc()`

编译于：`gcc (Debian 4.7.2-5) 4.7.2`
编译行：`gcc -o void_test void_test.c`

```
#include <stdio.h>
#include <stdlib.h>

int main(int argc, char **argv) {
  void *vp, *vp2;

  printf("sizeof(void)   = %d\n", sizeof(void));
  printf("sizeof(void *) = %d\n", sizeof(void *));
  printf("sizeof(char)   = %d\n", sizeof(char));
  printf("sizeof(char *) = %d\n\n", sizeof(char *));

  vp = (void *) malloc(sizeof(void));
  vp2 = (void *) malloc(sizeof(void *));

  printf("vp    = %p\n", vp);
  printf("vp+1  = %p\n", vp+1);
  printf("vp2   = %p\n", vp);
  printf("vp2+1 = %p\n", vp2+1);

  return 0;
} 
```

给出以下输出：

```
$ ./void_test 
sizeof(void)   = 1
sizeof(void *) = 8
sizeof(char)   = 1
sizeof(char *) = 8

vp    = 0x1ee3010
vp+1  = 0x1ee3011
vp2   = 0x1ee3010
vp2+1 = 0x1ee3031 
```

# c++ - 使用 g++ 编译但仍然给出错误“未定义符号：__gxx_personality_v0”

> ID：15228724
> 
> 赞同：0
> 
> 时间：2013-03-05T16:13:57.130
> 
> 标签：c++, parallax, stamp

我正在尝试从 ubuntu 运行基本标记。我下载了 bstamp.sourceforge.net 。我尝试使用带有 -lstdc++ 和 g++ 的 gcc 更改生成文件。请提出修复建议。卡住了几个小时。bstamp_tokenize.cpp 的源代码在这里：[http ://pastebin.com/Q9f1m2iG bstamp_run 的源代码在这里：](http://pastebin.com/Q9f1m2iG) [http](http://pastebin.com/KLEf8SBF) ://pastebin.com/KLEf8SBF

这是我得到的错误：

```
**main_server@main-server:~/Desktop/bstamp$ bstamp_tokenize robot.bs2 robot.tok
/usr/local/lib/libbstamptokenizer.so: undefined symbol: __gxx_personality_v0: Success
./tokenizer.so: undefined symbol: __gxx_personality_v0: Success** 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-12-02T16:41:40.413

您应该添加`-lgnustl_static`编译行以使其运行。

# c# - 设计和通用列表清理

> ID：15228739
> 
> 赞同：0
> 
> 时间：2013-03-05T16:14:50.650
> 
> 标签：c#, design-patterns

我有观察者设计模式，附加/分离所需的观察者是通过静态方法完成的。我故意使用静态方法，因为每个节点的观察者列表在内存方面可能会花费很多。如果从设计的角度来看我错了，请告诉我（使用静态方法和变量是否正确？）。

```
 public static void Attach(FormComponentObserverBase observer)
    {
        observers.Add(observer);
    }

    public static void Detach(FormComponentObserverBase observer)
    {
        observers.Remove(observer);
    }

    public static void DetachAll()
    {
        if (observers == null)
        {
            return;
        }

        foreach (var o in observers)
        {
            Detach(o);
        }
    }

    public static void Notify(MyObservedObject c)
    {
        if (observers == null)
        {
            return;
        }

        foreach (var o in observers)
        {
            o.Update(c);
        }
} 
```

观察者正在观察树对象结构。由于树在内存方面很昂贵，我想确保我不会在内存中保留任何额外的东西。我尝试实现 IDisposable 接口并通过 Dispose 方法，我想清理观察者和其他不必要的实例相关对象。就观察者通用列表而言，以下内容是否足以使观察者列表符合垃圾收集条件？

```
DetachAll();
observers = null; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T16:32:28.647

假设`Remove`实际上从列表中删除了观察者，那么就这个数据结构而言，您不需要做任何其他事情。没有特别的理由来设置`observers = null`. 这只释放了用于观察者列表的少量内存，并且使您的代码复杂化，因为您必须`null`到处检查。例如，如果您的`DetachAll`sets `observers = null`，那么您`Attach`必须是：

```
if (observers == null)
{
    // create observers list
}
observers.Add(observer); 
```

我不建议`Dispose`在`Detach`方法中调用观察者，因为观察者可能仍然是一个活动对象。

您可能不希望这是静态的。从灵活性和可测试性的角度来看，您最好使用实例对象。如果你真的需要确保你的程序不能创建它的多个实例，你可以实现一个单例设计模式，但这可能不是必需的。

# c# - 如何在 WPF 中将自定义对象绑定到 ListBox

> ID：15228741
> 
> 赞同：1
> 
> 时间：2013-03-05T16:15:02.657
> 
> 标签：c#, wpf, binding, listbox, custom-object

我是 WPF 的新手，所以如果我的问题很愚蠢，请接受我的道歉。

我正在创建一个食品订购系统，它由两个主要部分组成，“食品菜单”和“订单列表”。当用户从食物菜单中选择一个项目时，它将被添加到代表订单列表的列表框控件中。

我已经为“OrderLine”创建了一些自定义对象： `Order`, `OrderLine`,`Item`以及 Collection 类 , 。`OrderLineCollection`它们如下所示：

```
public class Order
{
    public string ID { get; set; }
    public DateTime DateTime { get; set; }
    public double TotalAmt { get; set; }
    public OrderLineCollection LineItems { get; set; }
}

public class OrderLine
{
    public Item Item { get; set; }
    public double UnitPrice { get; set; }
    public int Quantity { get; set; }
    public double SubTotal { get { return unitPrice * quantity; } }
}

[Serializable]
public class OrderLineCollection : CollectionBase
{
    public OrderLine this[int index]
    {
        get { return (OrderLine)List[index]; }
        set { List[index] = value; }
    }
}

public class Item
{
    public string ID { get; set; }
    public string Name { get; set; }
    public string Description { get; set; }
    public double UnitPrice { get; set; }
    public byte[] Image { get; set; }
} 
```

我的`ListBox`控件有一个`DataTemplate`，以便为每个项目显示更多详细信息。XAML 如下：

```
<Page x:Class="FoodOrdering.OrderList"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      Title="Order List">
    <ListBox Name="lbxOrder" HorizontalContentAlignment="Stretch">            
        <ListBox.ItemTemplate>
            <DataTemplate>
                <Grid Margin="5">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="30"/>
                        <ColumnDefinition Width="80"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition/>
                        <RowDefinition Height="40"/>
                    </Grid.RowDefinitions>
                    <TextBlock Grid.Row="0" Grid.Column="0" Grid.RowSpan="2" Text="{Binding item.name}"/>
                    <TextBlock Grid.Row="0" Grid.Column="1" Text="x "/>
                    <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding quantity}" Margin="10,0,0,0"/>
                    <TextBlock Grid.Row="0" Grid.Column="2" Text="{Binding subTotal, Converter={StaticResource priceConverter}}" HorizontalAlignment="Right"/>
                    <Button Grid.Row="1" Grid.Column="2" Margin="0,5,0,0" Click="btnDelete_Click">Delete</Button>
                </Grid>
            </DataTemplate>
        </ListBox.ItemTemplate>
    </ListBox>
</Page> 
```

因此，当添加项目时，列表框将如下图所示： [https ://dl.dropbox.com/u/6322828/orderList.png](https://dl.dropbox.com/u/6322828/orderList.png)

在代码隐藏中，我创建了一个`currentOrder`用于存储当前订单的静态变量，它将被其他类/方法使用。

并且每次更改其值时，`LoadCurrentOrder()`都会调用以下愚蠢的方法来刷新 ListBox 视图。

```
public partial class OrderList : Page
{
    public static Order currentOrder = new Order();
    public OrderList()
    {
        InitializeComponent();
        LoadCurrentOrder();
    }

    public void LoadCurrentOrder()
    {
        lbxOrder.Items.Clear();
        foreach (OrderLine ol in currentOrder.LineItems)
            lbxOrder.Items.Add(ol);
    }
} 
```

我的问题是如何以优雅的方式（例如使用`Resources` `ItemsSource`等）绑定数据而不是使用上述方法，以便每次更改变量的值时ListBox都会自动更新？

我试过

```
lbxOrder.ItemsSource = currentOrder; 
```

但它不起作用，因为 currentOrder 不是`System.Collections.IEnumerable`对象。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T16:23:29.357

1 - 不要创建自己的集合类型，.Net 框架基类库已经拥有几乎所有你需要的东西。

删除`OrderLineCollection`并使用`ObservableCollection<OrderLine>`.

2 - 尝试遵守 MVVM 约定。这意味着您不应在代码中操作 UI 元素。

```
public OrderList()
{
    InitializeComponent();
    LoadCurrentOrder();
    DataContext = this;
} 
```

然后在 XAML 中：

```
<ListBox ItemsSource="{Binding LineItems}" HorizontalContentAlignment="Stretch"> 
```

3 - 不要在 XAML 中命名 UI 元素，除非您需要在 XAML 中引用它们。每当您发现自己想要在过程代码中操作 UI 元素时，这将帮助您重新考虑您的方法。

4 - 习惯 C# 命名约定。属性名称应该是“正确大小写”（IE`LineItems`而不是`lineItems`）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T16:17:39.103

您所要做的就是将`lineItems`属性变为`ObservableCollection<yourType>`. 然后，当这个集合发生变化（添加、删除项目）时，列表框将自动刷新。

如果您的问题是订单本身发生了变化，您需要刷新列表框。然后您需要做的就是实现`INotifyPropertyChanged`，当订单发生变化时，触发属性已更改的通知，UI 将通过绑定刷新。

至于以更优雅的方式绑定。您可以绑定到`currentOrder.lineItems`：

```
lbxOrder.ItemsSource = currentOrder.lineItems;//this should be an observable collection if you intend to have items change 
```

# java - 或 if 语句中带有 int 的操作数

> ID：15228742
> 
> 赞同：1
> 
> 时间：2013-03-05T16:15:03.503
> 
> 标签：java, eclipse, int, operand

我的问题是程序没有像我预期的“他”那样读取代码。

我有

```
if (hero.getPos() == (6 | 11 | 16)) {
    move = new Object[] {"Up", "Right", "Left"};
} else {
    move = new Object[] {"Up", "Down", "Right", "Left"};
} 
```

当 hero 位置为 6 时，程序仍然转到 else。

这是为什么？是因为操作数吗？如果是，我应该如何改变它？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-05T16:15:48.800

采用：

```
if (hero.getPos() == 6 || hero.getPos() == 11 || hero.getPos() == 16)) { 
```

这将做你想要的。

您所做的是与将按[位或](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/op3.html)在这些数字之间进行比较`hero.getPos()`的结果。`(6|11|16)`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-05T17:05:30.523

其他答案是正确的，只是您可能会使用 Sets 的想法不同。

```
static final Set<Integer> positions = new HashSet<Integer>();
static{
    positions.add(6);
    positions.add(11);
    positions.add(16);
}

if (positions.contains(hero.getPos())){
    move = new Object[] {"Up", "Right", "Left"};
} else {
    move = new Object[] {"Up", "Down", "Right", "Left"};
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-05T16:16:31.883

你不能那样做。它按位对 3 数进行排序。

你必须这样做：

```
if (hero.getPos() == 6 || hero.getPos() == 11 | hero.getPos() == 16)) {
    move = new Object[] {"Up", "Right", "Left"};
} else {
    move = new Object[] {"Up", "Down", "Right", "Left"};
} 
```

你看出区别了吗？`|`是按位或，`||`而是逻辑或。另请注意，您必须每次都重写比较。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-05T16:20:31.370

`(6 | 11 | 16)`将首先评估为 31（二元运算），即`6 != 31`. 不是你想要的。

更好的是检查每个位置（你只有 3 个，所以内联很好，更多考虑使用循环）：

```
if (hero.getPos() == 6 || hero.getPos() == 11 | hero.getPos() == 16)) {
    move = new Object[] {"Up", "Right", "Left"};
} else {
    move = new Object[] {"Up", "Down", "Right", "Left"};
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2010-01-04T19:46:21.580

不，您将需要检查`ci.getNumber() == ...`每个值，或者将它们添加到集合中并检查`myCollection.contains(ci.getNumber())`。但是，如果您根据几个已知值检查方法，您可能需要重新考虑代码的结构。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2010-01-04T19:46:55.730

使用以下答案：

[如何测试数组是否包含某个值？](https://stackoverflow.com/questions/1128723/in-java-how-can-i-test-if-an-array-contains-a-certain-value)

您可以创建一个数字数组并检查您的 ci.getNumber() 是否在其中。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2010-01-04T19:47:04.963

没有这样的运营商。但是，如果您要比较数字，则可以使用 switch 进行模拟。方法如下：

```
int aNumber = ci.getNumber();
swithc(aNumber) {
    case 6252001:
    case 5855797:
    case 6251999: {
        ...
        break;
    }
    default: {
        ... // Do else.
    }
} 
```

希望这可以帮助。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2010-01-04T19:47:20.627

不，您可以创建`Set<Integer>`一次然后使用它，或者只是：

```
int number = ci.getNumber();
if (number == 6252001 || number == 5855797 || number == 6251999) 
```

我还会考虑将这些数字更改为常量，以便获得更有意义的代码。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2012-01-16T03:46:38.787

```
boolean theyAretheSame = num1 == num2 ? (num1 == num3 ? true:false):false; 
```

我必须承认我没有检查过这个，但逻辑看起来是正确的。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2010-01-04T19:46:16.307

您可以将所有数字放在一个集合中，然后使用该`contains()`方法。除此之外，我不相信有任何特殊的语法可以像你想要的那样进行比较。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2010-01-04T19:46:42.610

Java不会让你这样做。您可以进行哈希查找（这有点过头了）或 case 语句，或大喇叭丑陋的多重比较：

```
if ((n==1 ) || (n==2) || ... 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2010-01-04T19:55:49.940

不..您必须单独比较它们。

# indexing - 熊猫数据框：在进行涉及两个数据框的算术运算时如何在多个索引级别上进行匹配

> ID：15228744
> 
> 赞同：3
> 
> 时间：2013-03-05T16:15:06.080
> 
> 标签：indexing, dataframe, match, pandas, hierarchical

我在主索引上有一个具有三个级别的 DataFrame：

```
from pandas import *
df_multi = DataFrame(np.random.rand(6,2), index = [['CF', 'CF', 'CF', 'DA', 'DA','DA'], ['x', 'y', 'y', 'x', 'y', 'y'], ['a', 'b', 'a', 'a', 'a', 'b']], columns = ['PC1', 'PC2'])
df_multi.index.names =['l1','l2','l3']

In [5]: df_multi
Out[5]: 
       PC1       PC2
l1 l2 l3                    
CF x  a   0.118061  0.473159
   y  b   0.159534  0.407676
      a   0.466731  0.163322
DA x  a   0.152799  0.333438
   y  a   0.632725  0.965348
      b   0.737112  0.834592 
```

现在我想在第三级求和，然后将每个元素除以其相应的总和以获得第三级的份额（例如，`(CF, x, a)`除以`(CF, x, a)`和`(CF, y, a)`等`(CF, y, a) + (CF, y, b)`）

```
In [6]: df_multi.sum(level = [0, 1])
Out[6]: 
    PC1       PC2
l1 l2                    
CF x   0.118061  0.473159
   y   0.626265  0.570998
DA x   0.152799  0.333438
   y   1.369837  1.799940 
```

和

```
df_multi_share = df_multi.div(df_multi.sum(level = [0, 1]), level=[0, 1]) 
```

但是，这不起作用。我正在寻找一个通用的解决方案，不仅限于百分比份额的计算，它使我能够在多个级别上进行算术匹配。仅使用一个级别时它确实有效，例如

```
df_multi = DataFrame(np.random.rand(4,2), index = [['CF', 'CF', 'DA', 'DA'], ['1', '2', '1', '2']], columns = ['PC1', 'PC2'])

df_single = DataFrame(np.random.rand(3,3), index = ['1', '2', '3'], columns = ['PC1', 'PC2', 'PC3'])

df_combined = df_multi.mul(df_single, level = 1) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T17:47:49.820

这听起来像是一份工作`transform`。

```
df_multi.groupby(level=[0,1]).transform(lambda x: x/x.sum()) 
```

相关文档： http: [//pandas.pydata.org/pandas-docs/stable/groupby.html#transformation](http://pandas.pydata.org/pandas-docs/stable/groupby.html#transformation)

# sql-server-2008 - 在不使用 .NET 的情况下从 SQL Server 2008 FILESTREAM 字段中提取数据

> ID：15228746
> 
> 赞同：1
> 
> 时间：2013-03-05T16:15:16.627
> 
> 标签：sql-server-2008, filestream

我们在 sql server 文件流中有 200 多个演出数据。谁能建议我有没有更快的方法来检索这些文件？我们可以使用“bcp”来获取这些文件吗？

# ios - 检测父类变量或属性被objective-c中的其他子类更改

> ID：15228748
> 
> 赞同：1
> 
> 时间：2013-03-05T16:15:17.787
> 
> 标签：ios, objective-c

我有父 UIViewController A 有一些属性。我有继承自 A 的子 UIViewController B、C、D。

我的问题是：在 B 中，我更改了 Parent 属性值。C，D如何知道父值从B更改？

基本上我想在孩子之间共享财产。

提前致谢。

代码示例；

```
@interface A : UIViewController{
NSString *string1; //This is just example
}
@property (nonatomic, strong) NSString *string2;
@end 
```

孩子B

```
@interface B : A
@end

@implementation B
//here I change string1 and string2;
@end 
```

孩子 C

```
@interface C : A
@end

@implementation C
//here I want to get changed string1 and string2 by Child A;
@end 
```

儿童 D

```
@interface D : A
@end

@implementation D
//here I want to get changed string1 and string2 by Child A;
@end 
```

目前，我正在使用**Singleton**来存储所有值并且运行良好，但我认为在这种情况下**应该有更好的方法吗？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T17:20:28.303

我想您可以做的最简单的事情是拥有继承的属性，但覆盖父视图中的 getter 和 setter，以便它读取/写入静态变量。

```
@interface A : UIViewController
@property (nonatomic, strong) NSString *sharedString;
@end

@implementation A

static NSString* _sSharedString;

- (NSString*) sharedString {
   return _sSharedString;
}

- (void) setSharedString: (NSString*) aString {
   _sSharedString = aString;
}

@end 
```

您可能希望同步属性。

考虑到代码，这将改变所有孩子的价值。我知道这就是您所需要的（仅值共享），但是如果您还需要在值更改时发出通知，您可以添加一些方法来在值更改时通知子项（实例）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T16:23:00.323

您可以让父类在其属性更改时发送消息。子类可以为该消息实现一个方法，并在其中做任何他们必须做的事情来适应变化。

我似乎记得这样的东西已经内置到 Cocoa 虽然......

啊。这里是。查看[Key-Value Observation](http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/KeyValueObserving/KeyValueObserving.html)。只要属性符合 KVC，Cocoa 会在属性更改时自动发送消息。您只需要在孩子中实现一个方法来处理它们，并订阅更改事件。

所以在你的孩子班上，你会说类似

```
[self addObserver:self
       forKeyPath:@"thePropertyName"
          options:NSKeyValueObservingOptionNew
          context:nil]; 
```

并有一个类似的方法

```
-(void) observeValueForKeyPath:(NSString*)keyPath
                      ofObject:(id)observee
                        change:(NSDictionary*)change
                       context:(void*)context
{
    // here's where the magic happens
} 
```

`keyPath`将是更改的属性的名称，`change`并将包含具有常量名称的某个键下的新值（名称的`NSKeyValueChangeNewKey`，不带引号）。（您通常也可以只查找新属性。）

如果要观察很多属性，那么每个孩子订阅每个属性的更改可能会很麻烦。你如何处理这取决于一切到底是如何相关的，但是嗯。不得不如此关心父母本身就是一种气味……

# python - 通过字符串查找解析全局命名空间中的 Python 对象

> ID：15228749
> 
> 赞同：3
> 
> 时间：2013-03-05T16:15:19.423
> 
> 标签：python

假设您想要对象名称字符串末尾的对象：示例字符串是`'first_class.second_class.third_class.id'`，字符串列表都采用 形式`'X1object.X2object...XNobject.what_you_want_is_here_object'`。

在每种情况下，您都知道存在 X1object 的活动实例，无论其具体名称如何。对于示例字符串，代码已经调用了`first_class`. 您可以使用 加载`first_class`，`globals['first_class']`并且通常`X1object`使用 加载`globals['X1object']`。

您想要的是字符串末尾的对象（通常是一个值）。因此，对于示例字符串，您需要`id = first_class.second_class.third_class.id`. 有没有一种简单的方法来转换字符串以获取其最终对象？

下面是我为处理这个问题而创建的代码，但这似乎是一种蛮力方法，依次获取每个属性，直到找到最后一个。

```
first_class = FirstClass()
first_class = go_do_something_wild_in_first_class(first_class)
...

attribute = 'first_class.second_class.third_class.id'
attribute_pieces = attribute.split('.')

fetch_attribute = lambda attribute, name: \
    attribute[name] if attribute == globals() else \
    getattr(attribute, name)

for name in attribute_pieces: # I changed the code from using an index to using a name
    if name == attribute_pieces[0]:
        attribute = fetch_attribute(globals(), name)
    else:
        attribute = fetch_attribute(attribute, name)

id = attribute 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T16:36:27.083

您可以使用[`reduce()`](http://docs.python.org/3/library/functions.html#reduce)：

```
def resolve_object(name):
    names = name.split('.')
    return reduce(getattr, names[1:], globals()[names[0]]) 
```

在这里，我们只是简单地查找`names[0]`为一个全局，然后遍历其余的名称，`getattr`为到目前为止的结果中的每个名称做一个。

演示：

```
>>> class Foo(object): pass
... 
>>> first_class = Foo()
>>> first_class.second_class = Foo()
>>> first_class.second_class.third_class = Foo
>>> first_class.second_class.third_class.id = 'baz'
>>> resolve_object('first_class.second_class.third_class.id')
'baz' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T16:29:39.420

有一个名为 zope.dottedname 的 Python 库，它完全符合您的要求：

[https://pypi.python.org/pypi/zope.dottedname](https://pypi.python.org/pypi/zope.dottedname)

它将任意字符串解析为 Python 命名空间中的相应对象，包括对象的属性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T16:35:25.753

你应该使用[importlib](http://docs.python.org/2/library/importlib.html)

```
attribute = 'first_class.second_class.third_class.id'
attribute_pieces = attribute.split('.')

id = getattr(importlib.import_module('.'.join(attribute_pieces[:-1]), attribute_pieces[-1]) 
```

# charts - 柱形图的不同颜色

> ID：15228751
> 
> 赞同：0
> 
> 时间：2013-03-05T16:15:22.343
> 
> 标签：charts, extjs4.1

我正在使用 ExtJS 来呈现图表，但我的柱形图对于所有系列都具有相同的颜色。这个系列需要不同的颜色。只发生在柱形图、条形图和面积图上，折线图工作正常。

我的代码：

```
Ext.Ajax.request({
        method: 'get',
        url: Webapp.link('chart/' + key),
        success: function(response){
            var resposta = Ext.JSON.decode(response.responseText);
            var chart = Ext.create('Hemisphere.view.chart.Chart', {
                axes: resposta.chart.axes,
                series: resposta.chart.series,
                store: store (The store is defined previously)
            });
            panel.removeAll();
            panel.add(chart);
            }
        }
    }); 
```

任何人都可以帮助我吗？谢谢。 ![在此处输入图像描述](../Images/d3bacd2962ebd4941ff7bb0133ae470b.png)

一个系列代码示例。

![在此处输入图像描述](../Images/f6012267a8dc5c42273998f391529260.png)

![在此处输入图像描述](../Images/9b6d9368478ae790d342600ffca0012b.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T16:35:53.357

`renderer`您可以使用`series`.

Ext 文档有一个这样的工作示例：

[http://docs.sencha.com/ext-js/4-1/#!/example/charts/Column2.html](http://docs.sencha.com/ext-js/4-1/#!/example/charts/Column2.html)

```
 series: [{
            type: 'column',
            renderer: function(sprite, storeItem, barAttr, i, store) {
                barAttr.fill = colors[i % colors.length];
                return barAttr;
            }
            .
            .
        }] 
```

# azure - 无法从特定服务器连接到 azure

> ID：15228752
> 
> 赞同：1
> 
> 时间：2013-03-05T16:15:24.307
> 
> 标签：azure, azureservicebus

我有一个无法连接到我的队列的 Azure 服务总线队列。在我的电脑上它运行良好，在我们的开发服务器上它也运行良好。我们已经将它部署在我们的测试盒上，并且在尝试从队列接收消息时出现此错误：

> Microsoft.ServiceBus.Messaging.MessagingCommunicationException：无法连接到 net.tcp://jeportal.servicebus.windows.net:9354/。连接尝试持续了 00:00:14.9062482 的时间跨度。TCP错误码10060：连接尝试失败，因为连接的一方在一段时间后没有正确响应，或者连接失败，因为连接的主机没有响应168.62.48.238:9354。---> System.ServiceModel.EndpointNotFoundException：无法连接到 net.tcp://jeportal.servicebus.windows.net:9354/。连接尝试持续了 00:00:14.9062482 的时间跨度。TCP错误代码10060：连接尝试失败，因为连接方在一段时间后没有正确响应，或建立连接失败，因为连接的主机未能响应 168.62.48.238:9354。---> System.Net.Sockets.SocketException：连接尝试失败，因为连接方一段时间后没有正确响应，或者连接失败，因为连接的主机没有响应168.62.48.238:9354

我们已经禁用了防火墙，但它仍然无法正常工作，关于故障排除有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T18:57:04.433

如果这与防火墙设置有关，您可能需要尝试将连接模式设置为 Http。更多详细信息，请访问 [http://msdn.microsoft.com/en-us/library/windowsazure/microsoft.servicebus.connectivitysettings.mode.aspx](http://msdn.microsoft.com/en-us/library/windowsazure/microsoft.servicebus.connectivitysettings.mode.aspx) 和：http: [//msdn.microsoft.com/en-us/library/windowsazure/ microsoft.servicebus.connectivitymode.aspx](http://msdn.microsoft.com/en-us/library/windowsazure/microsoft.servicebus.connectivitymode.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T16:46:25.420

尝试将绑定的超时时间增加到 1 分钟，并手动将服务器应用程序添加为 Windows 防火墙中的例外。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-07T13:31:36.697

所以这最终成为一个简单的网络防火墙受到限制的问题。我们已经告诉我们的 SA 为 9354 去 sb 打开端口。他们说他们确实打开了它们……但他们没有。我和他们一起走过，我们发现它没有打开

# android - TalkBack 在我自己的应用程序中不起作用

> ID：15228756
> 
> 赞同：0
> 
> 时间：2013-03-05T16:15:42.530
> 
> 标签：android

我在冰淇淋三明治中启用了 TalkBack。而且它不会说按钮，在我开发的应用程序中列出视图。为什么会这样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T16:26:20.787

您需要向`android:contentDescription`小部件添加属性，以便它们可以通过 TalkBack 访问。引用[文档](http://developer.android.com/guide/topics/ui/accessibility/apps.html)：

> 使用 android:contentDescription 属性向应用程序中的用户界面控件添加描述性文本。特别注意 ImageButton、ImageView 和 CheckBox。

# java - 从 MS Access 输出获取 Unicode 数据将是“???????????????????”

> ID：15228761
> 
> 赞同：2
> 
> 时间：2013-03-05T16:15:57.247
> 
> 标签：java, connection, ms-access-2007, ms-access-2010

我正在使用 MS Access & MySQL ，在访问输入这个词

*   کوردستان ی عیراق （这是使用 unicode 的库尔德语言）

我的代码是：

```
try{
      String path ="src\\Database.accdb";
      Class.forName("sun.jdbc.odbc.JdbcOdbcDriver").newInstance();
      Connection c = DriverManager.getConnection(""
              + "jdbc:odbc:Driver={Microsoft Access Driver (*.mdb, *.accdb)}; DBQ="+path);
      Statement s = c.createStatement();
      ResultSet rs = s.executeQuery("select * from mytable");
      rs.next();
      jTextArea1.setText(rs.getString(1));

  }catch(Exception ex){
    JOptionPane.showMessageDialog(null, ex.getMessage());

  } 
```

访问输出是 `??????????????`

但是使用 MYSQL，输出是 کوردستان ی عیراق

为什么 ？？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T16:35:51.473

当您尝试建立连接时，您应该为属性设置适当的字符集，例如：

```
java.util.Properties prop = new java.util.Properties();
prop.put("charSet", "UTF8"); // Not tested..
Connection c = DriverManager.getConnection(
           "jdbc:odbc:Driver={Microsoft Access Driver (*.mdb, *.accdb)}; DBQ="+path, prop); 
```

查看[JDBC-ODBC 桥](http://docs.oracle.com/javase/1.4.2/docs/guide/jdbc/bridge.html)的文档以获取更多详细信息

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T15:30:28.543

如果您只是想从 MS Access 数据库中获取数据并且不需要运行复杂的查询，您可能需要查看[Jackcess](http://jackcess.sourceforge.net/)项目，这是一个用于打开 MS Access 文件的本地跨平台 Java API。它目前不支持运行 SQL 查询，但它*确实*让您无需通过（易碎的）jdbc-odbc 桥即可访问所有数据。它还支持使用索引（通过 IndexCursor）查找数据。

（免责声明，我是主要作者）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T16:31:35.140

来自微软论坛：

```
If your connection character set is utf8, then you should run this query right 
after connecting to DB:

SET NAMES 'utf8'; 

Also your DB and tables and columns should have utf8_general_ci or other type of 
utf8 collation. 
```

希望这可以帮助

# java - 安卓弹出窗口

> ID：15228770
> 
> 赞同：0
> 
> 时间：2013-03-05T16:16:10.707
> 
> 标签：java, android

我想在我的应用程序中创建一个带有输入文本字段和确定和取消按钮的弹出窗口：

这是我在 MainActivity 中的代码：

```
forgotPassword.setOnClickListener(new View.OnClickListener() {

                public void onClick(View v) {
                    View pview = inflater.inflate(R.layout.forgot_password_popup,(ViewGroup)findViewById(R.layout.login));

                    final PopupWindow pw = new PopupWindow(inflater.inflate(R.layout.forgot_password_popup,(ViewGroup)findViewById(R.layout.login)));
                    pw.showAtLocation(v, Gravity.LEFT,0,0);
                    pw.update(8,-70,150,270);

                    //if onclick written here, it gives null pointer exception.
                    Button okbtn=(Button)pview.findViewById(R.id.okbtn);
                    Button cancelbtn = (Button)pview.findViewById(R.id.cancelbtn);
                    final EditText emailText = (EditText) pview.findViewById(R.id.EmailText);
                    okbtn.setOnClickListener(new OnClickListener()
                    {
                        public void onClick(View v)
                        {
                            try {
                                ParseUser.requestPasswordReset(emailText.getText().toString());
                            } catch (ParseException e) {
                                // TODO Auto-generated catch block
                                e.printStackTrace();
                            }
                        }
                    });

                    cancelbtn.setOnClickListener(new OnClickListener()
                    {
                        public void onClick(View v)
                        {
                            pw.dismiss();

                        }
                });

                }
            }); 
```

这是我忘记的password_popup.xml：

```
<?xml version="1.0" encoding="utf-8"?>

 <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical" >

     <EditText
         android:id="@+id/EmailText"
         android:layout_width="fill_parent"
         android:layout_height="wrap_content"
         android:layout_marginTop="5dip"
         android:hint="Enter Email Address"
         android:inputType="textEmailAddress"
         android:password="true"
         android:singleLine="true" />

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content" >

        <Button
            android:id="@+id/okbtn"
            android:layout_width="80dp"
            android:layout_height="wrap_content"
            android:layout_marginLeft="50dp"
            android:text="OK" />

        <Button
            android:id="@+id/cancelbtn"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginLeft="50dp"
            android:text="Cancel" />
    </LinearLayout>

    </LinearLayout> 
```

但是它被切断了（我看不到文本字段或取消按钮，而且弹出窗口没有任何背景（我想要透明背景）

而且，我不能点击确定按钮，所以我的代码有问题

我很乐意帮忙

这是它的样子：

[http://img827.imageshack.us/img827/9545/capturehdv.png](http://img827.imageshack.us/img827/9545/capturehdv.png)

多谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T16:20:00.860

简单的解决方案是采用透明图像并将其设置为弹出布局的背景。

也试试

```
android:background=@null 
```

# python - Python NLTK：计算单词列表并使用有效英文单词生成概率

> ID：15228775
> 
> 赞同：0
> 
> 时间：2013-03-05T16:16:19.520
> 
> 标签：python, nlp, nltk

我有一个脏文档，其中包含无效的英语单词、数字等。我只想获取所有有效的英语单词，然后计算我的单词列表与有效英语单词总数的比率。

例如，如果我的文档有以下句子：

```
sentence= ['eishgkej he might be a good person. I might consider this.'] 
```

我只想数数和数`"he might be a good person. I might consider this"`数`"might"`。

所以，我得到了答案 2/10。

我正在考虑使用下面的代码。但是，我需要改变的不是线`features[word] = 1`而是特征的数量......

```
 all_words = nltk.FreqDist(w.lower() for w in reader.words() if w.lower() not in english_sw)

 def document_features(document):
     document_words = set(document)
     features = {}
     for word in word_features:
         if word in document_words:
             features[word] = 1
         else:
             features[word]=0
     return features 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T16:50:58.490

根据[文档](http://nltk.googlecode.com/svn/trunk/doc/api/nltk.probability.FreqDist-class.html#count)，您可以使用它`count(self, sample)`来返回`FreqDist`对象中单词的计数。所以我认为你想要这样的东西：

```
 for word in word_features:
     if word in document_words:
         features[word] = all_words.count(word)
     else:
         features[word]= 0 
```

或者您可以使用索引，即`all_words[word]`应该返回与`all_words.count(word)`

如果你想要单词的频率，你可以做`all_words.freq(word)`

# spring - Mockito @InjectMocks 如何工作？

> ID：15228777
> 
> 赞同：19
> 
> 时间：2013-03-05T16:16:21.917
> 
> 标签：spring, dependency-injection, mockito, autowired

这是我的问题：

我有几个 Web 服务类来测试它们是否都从通用服务继承了它们的方法。我认为我可以按功能区域（即三组测试方法，每组依赖于不同的底层 DAO 方法调用）分解测试套件，而不是为每个测试套件编写单元测试。

我建议做的是：

```
@Mock StateDAO mockedStateDao;
@Mock CountyDAO mockedCountyDao;
@Mock VisitorDAO mockedVisitorDao; 
```

然后调用：

```
@InjectMocks CountyServiceImpl<County> countyService = new CountyServiceImpl<County>();
@InjectMocks StateServiceImpl<State> stateService = new StateServiceImpl<State>();
@InjectMocks VisitorServiceImpl<Visitor> visitorService = new VisitorServiceImpl<Visitor>(); 
```

我如何确定每个 mockedDAO 都会被注入到正确的服务中？自动连接所有三个（而不是使用@InjectMocks）会更容易吗？

我正在使用 Spring、Hibernate 和 Mockito ......

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-03-11T17:45:15.787

好吧，尼古拉斯的回答几乎是正确的，但不要只看[InjectMocks](https://javadoc.io/page/org.mockito/mockito-core/latest/org/mockito/InjectMocks.html)的 javadoc ，它包含更多细节；）

对我来说，在一个测试中拥有这么多服务是很奇怪的，作为一个单元测试或作为一个集成测试感觉不正确。在单元测试中这是错误的，因为你有太多的合作者，它看起来不像面向对象（或 SOLID）。在集成测试中，这很奇怪，因为您测试与数据库集成的代码没有模拟它。

对于 1.9.5 中的快速参考，您有：

> 标记应执行注入的字段。
> 
> 允许速记模拟和间谍注入。最大限度地减少重复的模拟和间谍注入。Mockito 将尝试仅通过构造函数注入、setter 注入或属性注入按顺序注入模拟，如下所述。如果以下任一策略失败，则 Mockito 不会报告失败；即您必须自己提供依赖项。
> 
> 1.  **构造函数注入；**选择最大的构造函数，然后使用仅在测试中声明的模拟来解析参数。
>     
>     
>     
>     *注意：*如果找不到参数，则传递 null。如果需要不可模拟的类型，则不会发生构造函数注入。在这些情况下，您必须自己满足依赖关系。
>     
>     
> 2.  **属性设置器注入；**mocks 会先通过 type 来解析，然后，如果有多个相同类型的 property，则通过 property name 和 mock name 的 match。
>     
>     
>     
>     *注意 1：*如果您有相同类型（或相同擦除）的属性，最好使用匹配属性命名所有 @Mock 注释字段，否则 Mockito 可能会混淆并且不会发生注入。
>     
>     
>     
>     *注意 2：*如果 @InjectMocks 实例之前没有初始化并且有一个无参数的构造函数，那么它将使用这个构造函数进行初始化。
>     
>     
> 3.  **现场注入；**mocks 会先通过 type 来解析，然后，如果有多个相同类型的 property，则通过 field name 和 mock name 的匹配来解析。
>     
>     
>     
>     *注意 1：*如果您有相同类型（或相同擦除）的字段，最好将所有 @Mock 注释字段命名为匹配字段，否则 Mockito 可能会混淆并且不会发生注入。
>     
>     
>     
>     *注意 2：*如果 @InjectMocks 实例之前没有初始化并且有一个无参数的构造函数，那么它将使用这个构造函数进行初始化。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-02-03T16:18:53.327

如果您有多个服务并且想在基于 Spring 的环境中用 Mock-Objects 替换 DAO，我建议使用 Springockito：[https ://bitbucket.org/kubek2k/springockito/wiki/Home](https://bitbucket.org/kubek2k/springockito/wiki/Home)

这里也提到了： [Injecting Mockito mocks into a Spring bean](https://stackoverflow.com/questions/2457239/injecting-mockito-mocks-into-a-spring-bean)

然后您的 Testclass 可能如下所示：

```
@RunWith (SpringJUnit4ClassRunner.class)
@ContextConfiguration (loader = SpringockitoContextLoader.class, locations =    {"classpath:/org/example/package/applicationContext.xml"})
public class NameOfClassTest {

    @Autowired
    @ReplaceWithMock 
    StateDAO mockedStateDao;

    @Autowired
    @ReplaceWithMock 
    CountyDAO mockedCountyDao;

    @Autowired
    @ReplaceWithMock 
    VisitorDAO mockedVisitorDao; 
```

在您的 @Test 或 @Before Methode 中，您可以使用标准的 Mockito 方式设置您的模拟：

```
Mockito.doReturn(null).when(mockedCountyDao).selectFromDB(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T16:36:12.483

好吧，静态方法[`MockitoAnnotations.initMocks(Object)`](https://javadoc.io/page/org.mockito/mockito-core/latest/org/mockito/MockitoAnnotations.html#initMocks-java.lang.Object-)用于引导整个过程。

我不确定它是如何工作的，因为我没有浏览过源代码，但我会像这样实现它：

1.  使用注释扫描传递`Object`的类以查找成员变量。`@Mock`
2.  对于每一个，创建该类的模拟，并将其设置为该成员。
3.  使用注释扫描传递`Object`的类以查找成员变量。`@InjectMocks`
4.  扫描每个找到的成员的类，寻找它具有的成员，这些成员可以注入在 (2) 中创建的模拟对象之一（即，该字段是父类/接口，或与声明的模拟对象相同的类类）并将其设置为该成员。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-05T16:35:37.563

没关系，在网上查看 - InjectMocks 注释将带有 @Mock 注释的任何内容视为一个字段，并且是静态范围的（类范围），所以我真的不能保证模拟会转到正确的服务。这在某种程度上是一个尝试在功能级别而不是类级别进行单元测试的思想实验。我想我会用 Spring 自动装配这些东西......

# python - 如何在 Python 的嵌套对象中设置属性？

> ID：15228782
> 
> 赞同：1
> 
> 时间：2013-03-05T16:16:43.230
> 
> 标签：python, object, nested, nested-attributes, setattr

我正在第一次尝试 Python。

我需要遍历日志，解析日志条目，然后更新一个对象，其中包括日志中列出的机器的嵌套对象。

这就是我所拥有的：

```
import re
format_pat= re.compile( 
    r"(?P<host>(?:[\d\.]|[\da-fA-F:])+)\s" 
    r"(?P<identity>\S*)\s" 
    r"(?P<user>\S*)\s"
    r"\[(?P<time>.*?)\]\s"
    r'"(?P<request>.*?)"\s'
    r"(?P<status>\d+)\s"
    r"(?P<bytes>\S*)\s"
    r'"(?P<referer>.*?)"\s'
    r'"(?P<user_agent>.*?)"\s*' 
)

from json import JSONEncoder
class MyEncoder(JSONEncoder):
    def default(self, o):
      return o.__dict__ 

# JSON response object
class ResponseObject(object):
    def __init__(self, dict):
      self.__dict__ = dict

# check for JSON response object
try:
    obj
except NameError:
    obj = ResponseObject({})

test = ['2001:470:1f14:169:15f3:824f:8a61:7b59 - SOFTINST [14/Nov/2012:09:32:31 +0100] "POST /setComputer HTTP/1.1" 200 4 "-" "-" 102356']

# log loop
for line in test:
  try:
    # try to create object from log entry
    m = format_pat.match(line)
    if m:
      res = m.groupdict()
      res["status"] = int(res["status"])

      # register machine if not done
      if not hasattr(obj, res["user"]):
        setattr(obj, res["user"], {"downtime":"0","flag":"false","downstart":"0","init":res["time"],"last":"","uptime":"","downtime":"","totaltime":""})

      machine = getattr(obj, res["user"])
      flag = machine["flag"]
      start = machine["downstart"]
      down = machine["downtime"]
      last = machine["last"]

      print "done"
      # set last
      last = res["time"]

      # PROBLEM this does not work
      setattr(machine, last, res["time"])
      print machine

    else:
      print "nope"
  except:
      print "nope base"

print MyEncoder().encode(obj) 
```

我在尝试时遇到的错误`setattr()`是

```
AttributeError: 'dict' object has no attribute '' 
```

但我怕事情没有这么简单……

**问题：**
如何`last`使用“setattr”更新嵌套对象中的值？还是有另一种更新嵌套对象属性的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T16:21:31.360

我认为你需要这样做：

```
setattr(machine, 'last', res["time"]) 
```

由于[setattr](http://docs.python.org/2/library/functions.html#setattr)需要一串要设置的属性名称

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T17:13:26.823

不要使用`setattr`. 只需`"last"`为每个`machine`字典的键分配一个值。

（实际上你回答了你自己的问题！）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T16:39:07.320

I don't understand why, but I can set the value of `last` like this:

```
 print machine
  print machine["last"]
  print res["time"]

  # this works
  machine["last"] = res["time"]

  print machine 
```

If someone can explain, would be nice :-)

# c# - C# 代表教程工作

> ID：15228785
> 
> 赞同：3
> 
> 时间：2013-03-05T16:16:46.423
> 
> 标签：c#, delegates

我以前没有使用过代表，我正在尝试按照我书中的教程来弄清楚它们。

到目前为止，我已经了解到委托可以与返回相同类型对象的类的方法一起使用，并且与进行调用的委托相同的对象重载（如果我错了，请纠正我）。

在我正在编写的教程中，将以下代码添加到汽车类中：

```
public delegate void CarEngineHandler(string msgForCaller);

private CarEngineHandler listOfHandlers;

public void RegisterWithCarEngine(CarEngineHandler methodToCall)
{
   listOfHandlers = methodToCall;
} 
```

在`Main`控制台应用程序中，调用以下代码：

```
static void Main(string[] args)
{
    Car c1 = new Car("Slugbug", 100, 10);

    c1.RegisterWithCarEngine(new Car.CarEngineHandler(OnCarEngineEvent));

    Console.WriteLine("**** Speeding Up ******");
    for (int i = 0; i < 6; i++)
        c1.Accelerate(20);
    Console.ReadLine();
}

public static void OnCarEngineEvent(string msg)
{
    Console.WriteLine("\n***** Message From Car Object *****");
    Console.WriteLine("=> {0}", msg);
    Console.WriteLine("*************************************\n");
} 
```

这是`Accelerate`方法：

```
public void Accelerate(int delta)
{
    if (carIsDead)
    {
        if (listOfHandlers != null)
            listOfHandlers("Sorry, this car is dead...");
    }
    else
    {
        CurrentSpeed += delta;

        if (10 == (MaxSpeed - CurrentSpeed) && listOfHandlers != null)
        {
            listOfHandlers("Careful buddy! Gunna Blow!");
        }
    }

    if (CurrentSpeed >= MaxSpeed)
        carIsDead = true;
    else
        Console.WriteLine("CurrentSpeed = {0}", CurrentSpeed);
} 
```

我很困惑到底`listofHandlers`是如何在这里工作的？我知道这不是任何代码的错误，但我想更多地了解代表的实际工作方式？检查那`listofHandlers`是`null`让我失望...

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-05T16:50:58.770

### 定义委托

在 C# 中，您可以创建指向方法的指针。这样的指针称为 a `Delegate`。委托*只是一个带有方法的普通对象*。它只能指向具有匹配参数类型和匹配返回类型的方法。

```
delegate string MyHandler(int value1, string value2); 
```

> 定义一个委托类型，该类型可以指向一个以 ( `int`, `string`) 作为参数类型的方法并返回一个`string`.

您可以将这样的委托（指向方法的指针）存储在字段中。

```
MyHandler myhandler; 
```

这个委托只是一个对象，所以它可以是任何对象`null`。

### 创建新委托

给定一个方法：

```
string X(int v1, string v2) { /* ... */ } 
```

您可以创建一个指向该方法的新委托：

```
myHandler = new MyHandler(X); 
```

或者，感谢语法糖，您可以使用以下更短的语法：

```
myHandler = X; 
```

### 调用委托

在以后的任何时候，您都可以调用委托所指向的方法。

```
int i = 10;
string s = String.Empty;
string result = myHandler.Invoke(i, s); 
```

或者，再次感谢语法糖：

```
int i = 10;
string s = String.Empty;
string result = myHandler(i, s); 
```

当然，`myHandler`can be `null`，所以你需要先检查一下，否则你会得到一个`NullReferenceException`. 毕竟，你不能在`null`.

```
myHandler = null;
myHandler.Invoke(10, ""); 
```

所以，他们检查：

```
string result;
if (myHandler != null)
    result = myHandler(i, s); 
```

或几乎等效，在 C# 6 中：（请注意，`result`将是`null`when `myHandler`is `null`。）

```
string result = myHandler?.Invoke(i, s); 
```

### 为什么是代表？

如果要使用相同的代码调用不同的方法，可以传递一个委托，该委托指向要调用的方法，作为对象中的参数或字段。这就是在 .NET 中实现事件的方式，以及 LINQ 工作的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T16:21:31.450

空检查是因为您可能没有`listofHandlers`，如果没有，它将是`null`。就像调用具有值的类的方法`null`是非法的一样，调用`null`也是不允许的委托。

委托提供了一种抽象方法调用的方法。在 Java 中，您使用定义单个方法的接口，而 C# 只允许您直接使用委托。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T16:21:38.340

`listOfHandlers`就像一个引用变量，除了方法。

现在，如果它甚至不包含方法，您不想调用`listOfHandlers`包含的任何方法，因此您检查以确保它不是`null`第一个。

`null`委托是尚未为其定义方法的委托。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-05T16:21:39.990

Delegates 是 .Net 中的一种引用类型，并且与所有其他引用类型一样，都使用`null`to start 的值进行初始化。`null`检查只是查看它是否已初始化为一个值。如果没有侦听器，则调用委托不会报告任何内容

# c# - 一个 WrapPanel，其中的选择将面板划分为显示详细视图？

> ID：15228788
> 
> 赞同：8
> 
> 时间：2013-03-05T16:16:59.500
> 
> 标签：c#, wpf, xaml

*   滚动是水平的
*   触摸驱动。
*   项目向下流动，然后进入下一列
*   触摸一个项目会将面板滚动到一个设定点，因此详细视图将始终位于同一位置。
*   下一列将“中断”并向右移动，以在所选项目的上下文中显示详细信息窗格。
*   触摸任何可见项目（在不同的列中）将“关闭”显示的细节，然后将新选定的项目动画到左侧静态点并再次切掉下一列以显示细节。触摸同一列中的任何可见项目只会执行淡出动画。

以下是一些简单的模拟：

![](../Images/4e1bfa21bad49a6d7b957879306233f4.png)

![](../Images/89759ed1218fffd3fb261a9e4814c005.png)

其中 90% 对我来说很简单，但是创建一个可以“分离”自身以显示项目的包装面板的过程在很大程度上让我难以理解。任何意见，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T17:36:25.747

解决方案之一是：

您可以通过更改其中一些按钮的边距来分隔包装面板内的按钮（**在 grid 内**）（当然，如果您想保持按钮大小并避免将它们移动到下一行，您还需要更改窗口的大小）。

例如，如果您有 4 列和三行名为按钮 1、2、3 等的按钮...当单击第一列中的按钮时，按钮 2、6、10 得到：

```
 new thickness(space,0,0,0); 
```

这将按变量空间的值移动右侧的所有按钮；

接着

```
 window.width += space; 
```

然后将作为网格子级的文本框定位在具有宽度空间的合适位置。

撤消时

```
 new thickness(0,0,0,0);

      window.width -= space; 
```

它对我很有效，但我对其他解决方案很好奇。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-06T03:04:48.657

这听起来像是一项有趣的任务，所以我决定按照你想要的方式实现一些东西。我想我可以分享它，以便您可以改进它或根据自己的喜好使用它。首先，这项任务超出了我*仅*在XAML 中实现的技能。我不是说做不到，只是有点难。相反，我实现了自己的 Panel 类型（称为`GapPanel`）。这听起来可能更糟，但它仍然有一些好处，例如实现`RoutedEvent`s 以在 XAML 中响应动画的可能性。

所以，这是代码的负载。首先是 XAML

```
<Window x:Class="SlidingWrapPanel.SecondAttempt"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:SlidingWrapPanel"
        Title="Wrapped items with details pane" Height="250" Width="600">
    <Window.Resources>
        <ControlTemplate TargetType="Button" x:Key="ItemButtonTemplate">
            <ControlTemplate.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Trigger.EnterActions>
                        <BeginStoryboard>
                            <Storyboard>
                                <ColorAnimation Storyboard.TargetName="ButtonBorder"
                                            Storyboard.TargetProperty="(Border.Background).(SolidColorBrush.Color)"
                                            To="#999999" Duration="0:0:0.5" />
                            </Storyboard>
                        </BeginStoryboard>
                    </Trigger.EnterActions>
                    <Trigger.ExitActions>
                        <BeginStoryboard>
                            <Storyboard>
                                <ColorAnimation Storyboard.TargetName="ButtonBorder"
                                            Storyboard.TargetProperty="(Border.Background).(SolidColorBrush.Color)"
                                            To="#3e3e3e" Duration="0:0:0.5" />
                            </Storyboard>
                        </BeginStoryboard>
                    </Trigger.ExitActions>
                </Trigger>
            </ControlTemplate.Triggers>
            <Border x:Name="ButtonBorder" Background="#3e3e3e" BorderBrush="#222" BorderThickness="1">
                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" Content="{TemplateBinding Content}" Margin="0" />
            </Border>
        </ControlTemplate>
        <Style x:Key="ItemGridStyle" TargetType="{x:Type Grid}">
            <Setter Property="Background" Value="#3e3e3e"/>
            <Setter Property="Width" Value="150"/>
            <Setter Property="Height" Value="100"/>
            <Setter Property="Margin" Value="1"/>
        </Style>
        <Style x:Key="ItemButtonStyle" TargetType="{x:Type Button}">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Template">
                <Setter.Value>
                    <Binding Source="{StaticResource ItemButtonTemplate}"/>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="DetailsGridStyle" TargetType="{x:Type Grid}">
            <Setter Property="Background" Value="#3e3e3e"/>
            <Setter Property="Width" Value="160"/>
            <Setter Property="HorizontalAlignment" Value="Left"/>
            <Setter Property="RenderTransform">
                <Setter.Value>
                    <TranslateTransform X="-160" />
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="DetailsTextStyle" TargetType="{x:Type TextBlock}">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontFamily" Value="Segoe WP Light"/>
            <Setter Property="Margin" Value="15"/>
        </Style>
        <Storyboard x:Key="ExpandColumnAnimation">
            <DoubleAnimation Storyboard.TargetProperty="GapWidth" Storyboard.TargetName="ItemsPanel"
                             From="0" To="{Binding ActualWidth, ElementName=DetailsPanel}" Duration="0:0:0.75">
                <DoubleAnimation.EasingFunction>
                    <QuinticEase EasingMode="EaseOut"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
            <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.X)"
                                           Storyboard.TargetName="DetailsPanel">
                <DiscreteDoubleKeyFrame KeyTime="0" Value="{Binding GapX, ElementName=ItemsPanel}"/>
            </DoubleAnimationUsingKeyFrames>
        </Storyboard>
        <Storyboard x:Key="CollapseColumnAnimation">
            <DoubleAnimation Storyboard.TargetProperty="GapWidth" Storyboard.TargetName="ItemsPanel"
                             To="0" Duration="0:0:0.5">
                <DoubleAnimation.EasingFunction>
                    <QuinticEase EasingMode="EaseIn"/>
                </DoubleAnimation.EasingFunction>
            </DoubleAnimation>
            <DoubleAnimationUsingKeyFrames Storyboard.TargetProperty="(UIElement.RenderTransform).(TranslateTransform.X)"
                                           Storyboard.TargetName="DetailsPanel">
                <DiscreteDoubleKeyFrame KeyTime="0:0:0.5" Value="-160"/>
            </DoubleAnimationUsingKeyFrames>
        </Storyboard>
    </Window.Resources>
    <Grid>
        <Grid>
            <Grid x:Name="DetailsPanel" Style="{StaticResource DetailsGridStyle}">
                <ScrollViewer>
                    <TextBlock Style="{StaticResource DetailsTextStyle}">
                        <Run Text="Details" FontSize="18"/>
                        <LineBreak />
                        <Run Text="Some text"/>
                    </TextBlock>
                </ScrollViewer>
            </Grid>
        </Grid>
        <local:GapPanel x:Name="ItemsPanel">
            <local:GapPanel.Triggers>
                <EventTrigger RoutedEvent="local:GapPanel.ColumnChanged">
                    <BeginStoryboard Storyboard="{StaticResource ExpandColumnAnimation}"/>
                </EventTrigger>
                <EventTrigger RoutedEvent="local:GapPanel.CloseGap">
                    <BeginStoryboard Storyboard="{StaticResource CollapseColumnAnimation}"/>
                </EventTrigger>
            </local:GapPanel.Triggers>
            <Grid Style="{StaticResource ItemGridStyle}">
                <Button Style="{StaticResource ItemButtonStyle}" Content="Item 1" />
            </Grid>
            <Grid Style="{StaticResource ItemGridStyle}">
                <Button Style="{StaticResource ItemButtonStyle}" Content="Item 2" />
            </Grid>
            <Grid Style="{StaticResource ItemGridStyle}">
                <Button Style="{StaticResource ItemButtonStyle}" Content="Item 3" />
            </Grid>
            <Grid Style="{StaticResource ItemGridStyle}">
                <Button Style="{StaticResource ItemButtonStyle}" Content="Item 4"/>
            </Grid>
            <Grid Style="{StaticResource ItemGridStyle}">
                <Button Style="{StaticResource ItemButtonStyle}" Content="Item 5"/>
            </Grid>
            <Grid Style="{StaticResource ItemGridStyle}">
                <Button Style="{StaticResource ItemButtonStyle}" Content="Item 6"/>
            </Grid>
            <Grid Style="{StaticResource ItemGridStyle}">
                <Button Style="{StaticResource ItemButtonStyle}" Content="Item 7"/>
            </Grid>
            <Grid Style="{StaticResource ItemGridStyle}">
                <Button Style="{StaticResource ItemButtonStyle}" Content="Item 8"/>
            </Grid>
            <Grid Style="{StaticResource ItemGridStyle}">
                <Button Style="{StaticResource ItemButtonStyle}" Content="Item 9"/>
            </Grid>
            <Grid Style="{StaticResource ItemGridStyle}">
                <Button Style="{StaticResource ItemButtonStyle}" Content="Item 10"/>
            </Grid>
            <Grid Style="{StaticResource ItemGridStyle}">
                <Button Style="{StaticResource ItemButtonStyle}" Content="Item 11"/>
            </Grid>
            <Grid Style="{StaticResource ItemGridStyle}">
                <Button Style="{StaticResource ItemButtonStyle}" Content="Item 12"/>
            </Grid>
        </local:GapPanel>
    </Grid>
</Window> 
```

和面板的（可憎的）..

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Input;

namespace SlidingWrapPanel {
    public class GapPanel : Panel, INotifyPropertyChanged {
        private readonly IDictionary<UIElement, int> columns;
        private readonly IDictionary<int, double> gapCoordinates;
        private object opened;

        public static readonly DependencyProperty GapColumnProperty =
            DependencyProperty.Register("GapColumn", typeof(int), typeof(GapPanel), new FrameworkPropertyMetadata(default(int), FrameworkPropertyMetadataOptions.AffectsRender, columnChanged));

        public static readonly DependencyProperty GapWidthProperty =
            DependencyProperty.Register("GapWidth", typeof(double), typeof(GapPanel), new FrameworkPropertyMetadata(default(double), FrameworkPropertyMetadataOptions.AffectsRender));

        public static readonly RoutedEvent ColumnChangedEvent;
        public static readonly RoutedEvent CloseGapEvent;

        static GapPanel() {
            ColumnChangedEvent = EventManager.RegisterRoutedEvent("ColumnChanged", RoutingStrategy.Bubble, typeof(RoutedEvent), typeof(GapPanel));
            CloseGapEvent = EventManager.RegisterRoutedEvent("CloseGap", RoutingStrategy.Bubble, typeof(RoutedEvent), typeof(GapPanel));
        }

        public GapPanel() {
            columns = new Dictionary<UIElement, int>();
            gapCoordinates = new Dictionary<int, double>();
            GapWidth = 0;
            GapColumn = -1;
        }

        public int GapColumn {
            get { return (int)GetValue(GapColumnProperty); }
            set { SetValue(GapColumnProperty, value); }
        }

        public double GapWidth {
            get { return (double)GetValue(GapWidthProperty); }
            set { SetValue(GapWidthProperty, value); }
        }

        public double GapX {
            get {
                double value;
                gapCoordinates.TryGetValue(GapColumn, out value);
                return value;
            }
        }

        public event PropertyChangedEventHandler PropertyChanged;

        public event RoutedEventHandler ColumnChanged {
            add { AddHandler(ColumnChangedEvent, value); }
            remove { RemoveHandler(ColumnChangedEvent, value); }
        }

        public event RoutedEventHandler CloseGap {
            add { AddHandler(CloseGapEvent, value); }
            remove { RemoveHandler(CloseGapEvent, value); }
        }

        protected override Size ArrangeOverride(Size finalSize) {
            Point location = new Point();
            double position = 0;
            double columnWidth = 0;
            int col = 0;
            foreach (UIElement child in Children) {
                columnWidth = Math.Max(columnWidth, child.DesiredSize.Width);
                position += child.DesiredSize.Height;
                if (position > finalSize.Height && columnWidth > 0) {
                    location.X += columnWidth;
                    if (col == GapColumn) {
                        location.X += GapWidth;
                    }
                    ++col;
                    columnWidth = 0;
                    position = child.DesiredSize.Height;
                    location.Y = 0;
                }
                columns[child] = col;
                child.Arrange(new Rect(location, child.DesiredSize));

                location.Y = position;
            }

            return finalSize;
        }

        protected override Size MeasureOverride(Size availableSize) {
            double width = 0, height = 0;
            double position = 0;
            double columnWidth = 0;
            int col = 0;
            foreach (UIElement child in Children) {
                child.Measure(availableSize);

                columnWidth = Math.Max(columnWidth, child.DesiredSize.Width);
                position += child.DesiredSize.Height;
                if (position > availableSize.Height && columnWidth > 0) {
                    width += columnWidth;
                    ++col;
                    columnWidth = child.DesiredSize.Width;
                    position = child.DesiredSize.Height;
                    height = Math.Max(height, child.DesiredSize.Height);
                }
                gapCoordinates[col] = width + columnWidth;
            }

            return new Size(width + GapWidth, height);
        }

        protected override void OnVisualChildrenChanged(DependencyObject visualAdded, DependencyObject visualRemoved) {
            base.OnVisualChildrenChanged(visualAdded, visualRemoved);
            UIElement element = visualAdded as UIElement;
            if (element != null) {
                element.PreviewMouseLeftButtonDown += expandAtVisual;
            }
            element = visualRemoved as UIElement;
            if (element != null) {
                element.PreviewMouseLeftButtonDown -= expandAtVisual;
            }
        }

        private void expandAtVisual(object sender, MouseButtonEventArgs e) {
            // find element column
            int column = columns[(UIElement)sender];
            GapWidth = 0;
            GapColumn = column;
            if (opened == sender) {
                RaiseEvent(new RoutedEventArgs(CloseGapEvent, this));
            }
            opened = sender;
        }

        private void onPropertyChanged(string propertyName) {
            PropertyChangedEventHandler handler = PropertyChanged;
            if (handler != null) handler(this, new PropertyChangedEventArgs(propertyName));
        }

        private static void columnChanged(DependencyObject d, DependencyPropertyChangedEventArgs e) {
            ((GapPanel)d).onPropertyChanged("GapX");
            ((GapPanel)d).RaiseEvent(new RoutedEventArgs(ColumnChangedEvent, d));
        }
    }
} 
```

如果您觉得有什么需要我解释的，请发表评论。

另外，我不禁要宣传 Adam Nathan 的《WPF4 Unleashed》一书。本书对我在上面所做的所有事情进行了详细的解释，因此对于任何想要了解更多关于 WPF 的人来说，它都是一个很好的资源。

# css - CSS font-family 值什么时候应该使用引号？

> ID：15228792
> 
> 赞同：9
> 
> 时间：2013-03-05T16:17:04.917
> 
> 标签：css, fonts, font-face

CSS 'font-family' 的值什么时候应该有引号？

`font-family: arial`和都见过`font-family: "arial"`。

作为一个具体的例子，我以这种方式声明一个字体：

```
@font-face {
    font-family: 'entypo';
    font-style: normal;
    font-weight: 400;
    src: url('/css/fonts/entypo.woff') format('woff');
} 
```

让元素使用这个字体系列的正确 CSS 是什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-05T16:18:42.210

只有当字体本身有空格时才需要引号，例如`"Times New Roman"`.

`Arial`不需要引号，但有些人使用引号等`"Arial"`更一致。这只是个人喜好。

在贾斯汀的以下评论中看到：`font-family: times new roman;`不带引号的作品（[JSFiddle](http://jsfiddle.net/HMVHr/)）。

您可以按照通常的预期调用 new `@font-face`using 。`font-family: 'entypo';`（[链接](http://www.css3.info/preview/web-fonts-with-font-face/)）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T16:21:00.717

只想从这里回答：

[http://www.w3.org/TR/CSS2/fonts.html#font-family-prop](http://www.w3.org/TR/CSS2/fonts.html#font-family-prop)

为避免转义错误，建议引用包含空格、数字或连字符以外的标点符号的字体系列名称：

body { font-family: "新世纪教科书", serif }

必须引用恰好与关键字值相同的字体系列名称（“inherit”、“serif”、“sans-serif”、“monospace”、“fantasy”和“cursive”），以防止与关键字混淆同名。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T17:06:43.050

根据 CSS 2.1[规范，如果字体名称包含](http://www.w3.org/TR/CSS2/fonts.html#value-def-family-name)[标识符字符](http://www.w3.org/TR/CSS2/syndata.html#value-def-identifier)以外的字符（这是一个比“Ascii 字母和数字”更广泛的概念）和空格，则字体名称*需要用引号引起来。*如此是正确的，例如当然也是如此。`font-family: foo bar``font-family: entypo`

编码风格是一个不同的问题。引用特定的字体系列名称总是正确的（与通用名称相反`sans-serif`），所以`font-family: "entypo"`也是正确的。

从理论上讲，如果特定字体系列名称与通用名称一致（我认为没有人创建过这样的字体）或者如果它的名称包含前导或尾随空格或连续空格（但没有在他的意义上，一个人会以这种方式命名他的字体）。

# namespaces - 教义 2 命名空间问题

> ID：15228811
> 
> 赞同：1
> 
> 时间：2013-03-05T16:17:43.520
> 
> 标签：namespaces, doctrine-orm

我正在使用 Zend Framework 1 和 Bisna 库来集成 Doctrine 2。我使用 Doctrine 2 CLI 从我的数据库模型生成了我的实体。这一切都很好，除了关联记录的设置方法。他们接受的参数必须是一个特定的命名空间（`\Category`这里）。

```
class Article
{
    public function setCategory(\Category $category = null) {
        $this->category = $category;
        return $this;
    }
} 
```

但是，当我这样做时：

```
$article    = $this->em->getRepository('\Application\Entity\Article')->find(1);

$category   = new \Application\Entity\Category();
$category->SetName('New Category');

$article->setCategory($category); 
```

我收到以下致命错误：`Argument 1 passed to Application\Entity\CategoryField::setCategory() must be an instance of Category, instance of Application\Entity\Category given`.

当我将 setter 方法更改为接受`\Application\Entity\Category`对象时，它当然可以工作。我应该为每个生成的方法都这样做，还是有其他选择？这是我第一次使用命名空间，所以可能很简单。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-17T17:00:14.140

您始终可以将其添加到类文件的顶部：`use \Application\Entity\Category;`然后稍后简单地引用它，如下所示：`public function setCategory(Category $category = null)`

查看： http: [//php.net/manual/en/language.namespaces.importing.php](http://php.net/manual/en/language.namespaces.importing.php)了解更多信息`use`

否则，您将不得不引用完整的命名空间，否则您的应用程序不知道这`\Category`是对`\Application\Entity\Category`

# android - 在android中裁剪图像

> ID：15228812
> 
> 赞同：38
> 
> 时间：2013-03-05T16:17:44.447
> 
> 标签：android, image, android-crop

我想对图像进行裁剪，我发现了一些非常有用的图像，但不知何故就像没有使未选择的区域变暗，所以我想知道有人知道怎么做吗？或引导我走向正确的方向？我发现的在线教程显示，它会使所选区域变暗，但是当我使用它时，它不会。请帮助我，非常感谢，并为我的英语不好感到抱歉。

我使用的教程的链接。

[裁剪图像教程 1](http://mobile.tutsplus.com/tutorials/android/capture-and-crop-an-image-with-the-device-camera/)

[裁剪图像教程 2](http://www.londatiga.net/featured-articles/how-to-select-and-crop-image-on-android/)

我希望它是这样的。

![我希望它是这样的](../Images/4b7e0380f5958962dacbb14d1aaa8d4c.png)

```
editButton.setOnClickListener(new Button.OnClickListener(){

        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub
            Intent goEdit;
            goEdit = new Intent(PreviewActivity.this, CropImage.class);
            goEdit.putExtra("image-path", path);
            goEdit.putExtra("scale", true);
            goEdit.putExtra("fileName", nameFromPath);
            //finish();
            checkEdit = true;
            startActivityForResult(goEdit,0);

        }
}); 
```

**编辑** 我使用此按钮侦听器通过调用 CropImage 类活动来调用cropImage 文件。这是一个自定义意图，而不是android内部的裁剪功能，但我认为它是它的副本，以便使其支持所有版本，但是当我调用它时，所选区域没有变亮，我不知道问题出在哪里，谁能指导我？谢谢 这是我正在使用的库[drioid4you 裁剪图像](https://github.com/chemalarrea/CropImage/tree/master/src/com/droid4you/util/cropimage)

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2013-03-06T04:36:58.570

您可以使用默认的 android Crop 功能吗？

这是我的代码

```
private void performCrop(Uri picUri) {
    try {
        Intent cropIntent = new Intent("com.android.camera.action.CROP");
        // indicate image type and Uri
        cropIntent.setDataAndType(picUri, "image/*");
        // set crop properties here
        cropIntent.putExtra("crop", true);
        // indicate aspect of desired crop
        cropIntent.putExtra("aspectX", 1);
        cropIntent.putExtra("aspectY", 1);
        // indicate output X and Y
        cropIntent.putExtra("outputX", 128);
        cropIntent.putExtra("outputY", 128);
        // retrieve data on return
        cropIntent.putExtra("return-data", true);
        // start the activity - we handle returning in onActivityResult
        startActivityForResult(cropIntent, PIC_CROP);
    }
    // respond to users whose devices do not support the crop action
    catch (ActivityNotFoundException anfe) {
        // display an error message
        String errorMessage = "Whoops - your device doesn't support the crop action!";
        Toast toast = Toast.makeText(this, errorMessage, Toast.LENGTH_SHORT);
        toast.show();
    }
} 
```

宣布：

```
final int PIC_CROP = 1; 
```

在顶部。

在 onActivity 结果方法中，编写以下代码：

```
@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
    super.onActivityResult(requestCode, resultCode, data);

    if (requestCode == PIC_CROP) {
        if (data != null) {
            // get the returned data
            Bundle extras = data.getExtras();
            // get the cropped bitmap
            Bitmap selectedBitmap = extras.getParcelable("data");

            imgView.setImageBitmap(selectedBitmap);
        }
    }
} 
```

这对我来说很容易实现，并且还显示了较暗的区域。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2018-08-23T11:43:13.423

这个库：[Android-Image-Cropper](https://github.com/ArthurHub/Android-Image-Cropper)对 CropImages 来说非常强大。目前它在 github 上有 3,731 颗星。

您将使用几行代码裁剪图像。

1 - 将依赖项添加到 buid.gradle (Module: app)

```
compile 'com.theartofdev.edmodo:android-image-cropper:2.7.+' 
```

2 - 将权限添加到 AndroidManifest.xml

```
<uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE"/>
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/> 
```

3 - 将 CropImageActivity 添加到 AndroidManifest.xml

```
<activity android:name="com.theartofdev.edmodo.cropper.CropImageActivity"
 android:theme="@style/Base.Theme.AppCompat"/> 
```

4 - 根据您的要求，从以下情况之一开始活动。

```
// start picker to get image for cropping and then use the image in cropping activity
CropImage.activity()
.setGuidelines(CropImageView.Guidelines.ON)
.start(this);

// start cropping activity for pre-acquired image saved on the device
CropImage.activity(imageUri)
.start(this);

// for fragment (DO NOT use `getActivity()`)
CropImage.activity()
.start(getContext(), this); 
```

5 - 在 onActivityResult 中获取结果

```
@Override
public void onActivityResult(int requestCode, int resultCode, Intent data) {
  if (requestCode == CropImage.CROP_IMAGE_ACTIVITY_REQUEST_CODE) {
    CropImage.ActivityResult result = CropImage.getActivityResult(data);
    if (resultCode == RESULT_OK) {
      Uri resultUri = result.getUri();
    } else if (resultCode == CropImage.CROP_IMAGE_ACTIVITY_RESULT_ERROR_CODE) {
      Exception error = result.getError();
    }
  }
} 
```

您可以进行多种[自定义](https://github.com/ArthurHub/Android-Image-Cropper/wiki)，如将纵横比或形状设置为矩形、椭圆形等。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-09-13T14:43:03.690

我找到了一个非常酷的库，试试这个。这真的很流畅且易于使用。

[https://github.com/TakuSemba/CropMe](https://github.com/TakuSemba/CropMe)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-02-15T06:14:51.350

希望你一切顺利。你可以使用我的代码来裁剪图像。你只需要创建一个类并将这个类用于你的`XMl`类`java`。 [裁剪图像](https://gist.github.com/pookie13/1ad1623bec8d7ee76b66)。您可以将您选择的图像裁剪成圆形和方形，并有许多选项。希望它对你有用。因为这对你来说是完全可以管理的，你可以根据你的需要改变它。

好好工作 ：）

# assembly - 字节比较

> ID：15228813
> 
> 赞同：-1
> 
> 时间：2013-03-05T16:17:50.540
> 
> 标签：assembly, x86, nasm

我正在编写一个简单的汇编代码，但是，我得到了那个错误：

> test.asm:30: 错误：应有逗号、冒号或行尾

好的，在第 30 行我有这个代码：

```
cmp byte ptr [129],0    ;anything in the line segment? 
```

好的..我试过这个：

```
mov [direct_segment],ax ;segment for Direct information
cmp byte ptr [ax+4],0    ;anything in the line segment? 
```

好的，但是，错误是一样的:(

我怎么能解决这个问题？？？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-05T16:23:16.423

`byte ptr`是 MASM 语法。对于 NASM，它应该是`byte`，所以你的第一个例子应该是`cmp byte [129],0` （参见例如[这个语法指南](http://www.ibm.com/developerworks/linux/library/l-gas-nasm/index.html)）。

# iphone - iPhone SDK：webviews 的不同实例

> ID：15228816
> 
> 赞同：1
> 
> 时间：2013-03-05T16:17:56.593
> 
> 标签：iphone, ios, xcode4, uiwebview

在 xcode 中，例如，当您在 webview 中显示 facebook 并登录时，在另一个 webview 中打开另一个 facebook 实例将显示 facebook 登录以及 webviews 是否已链接。我想知道是否有办法加载不同的 webview 实例，这样一个实例就不会以任何方式与另一个实例对齐。例如，Google chrome 可以在他们的应用程序中执行此操作，其中常规选项卡和隐身选项卡使用不同的 webview 实例。我尝试了很多不同的东西，但到目前为止没有任何效果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T16:41:59.803

也许您可以做的一件事是，如果您不希望用户在返回 web 视图时登录，请清除 Cookie。

```
// Clear Cookies
NSHTTPCookie *cookie;
NSHTTPCookieStorage *storage = [NSHTTPCookieStorage sharedHTTPCookieStorage];
for (cookie in [storage cookies]) {
    [storage deleteCookie:cookie];
}
[[NSUserDefaults standardUserDefaults] synchronize]; 
```

将其放在加载 WebView 之前，用户将不会登录。

# linux - 使用 ssh 和本地脚本执行远程 bash，结束时将终止远程执行

> ID：15228817
> 
> 赞同：0
> 
> 时间：2013-03-05T16:17:59.197
> 
> 标签：linux, bash, ssh, remote-access

我使用公钥（无密码）在服务器上使用 ssh 登录。
这是我想用 bash 自动化的命令：

```
ssh user@ip
cd path
./bash0.sh parameter1 paramter2 & <-- this is a loop and is working on remote server in background
exit <-- exit form ssh

./bash1.sh <-- starting local bash
ssh user@ip pkill bash0.sh <-- kill the process at the end of the bash1.sh. From terminal is ok, but from bash? 
```

问题是在`cd path`之后立即执行`./bash0.sh paramter1 parameter2 &`and 然后退出 ssh 而不等待`./bash0.sh`完成。
我不能这样做`ssh user@ip ./path/bash0.sh paramter1 paramter2`，因为 bash 文件包含相对路径。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T16:21:21.103

简单的方法：

```
./bash1.sh && ssh user@ip pkill bash0.sh 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T16:51:58.487

您可以通过 ssh 发送多个命令，方法是用分号分隔它们：

```
ssh user@ip "cd path;./bash0.sh parameter1 parameter2 & exit" 
```

（`exit`不需要，但仅用于显示如何在 之后附加更多命令`&`）

并且`ssh user@ip pkill bash0.sh`应该从 bash 脚本中工作。您的终端可能也只是 bash。

编辑：有关,和运算符的详细说明，请参阅[http://www.skorks.com/2010/05/executing-multiple-commands-a-bash-productivity-tip/](http://www.skorks.com/2010/05/executing-multiple-commands-a-bash-productivity-tip/)。`;``&``&&`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T09:34:45.970

找到了解决方案：

```
ssh user@ip "cd path && ./bash0.sh parameter1 paramter2" &
/bash1.sh <-- starting local bash
ssh user@ip pkill bash0.sh 
```

“”非常重要。

# android - 使用 ListView 和适配器的空白活动

> ID：15228819
> 
> 赞同：0
> 
> 时间：2013-03-05T16:18:08.750
> 
> 标签：android, android-listview, android-arrayadapter

我正在学习将 ListViews 与适配器一起使用。我在此处发布的代码来自 [Here](http://www.androidhive.info/2012/02/android-custom-listview-with-image-and-text/) This is my class（相当于教程中的 MainActvity 类）的教程之一，其中我正在初始化 ListView 并向适配器提供数据。

```
setContentView(R.layout.searchresultrowlayout);
  try {
        jsonarray1=searchscreen.searchresults();

    } catch (JSONException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
ArrayList<HashMap<String, String>> propertylist=new ArrayList<HashMap<String, String>> ();

    for(int i=0;i<jsonarray1.length();i++){

        HashMap<String,String> propertymap=new HashMap<String,String> ();
        try {
            jsonobject=jsonarray1.getJSONObject(i);

        Log.d("json", jsonobject.getString("id"));
            propertymap.put("propertytype",jsonobject.getString("propertytype") );

            propertylist.add(propertymap);   

        } catch (JSONException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

    }  

    list=(ListView)findViewById(R.id.list);

    adapter=new PropertySearchArrayAdapter(this,propertylist);
  //      Log.d("adapter", propertylist.get(1).get("price").toString());
    list.setAdapter(adapter);  

    list.setOnItemClickListener(new OnItemClickListener() {

        @Override
        public void onItemClick(AdapterView<?> parent, View view,
                int position, long id) {

        }
    }); 
```

这是我的适配器类

```
public class PropertySearchArrayAdapter extends BaseAdapter{

private Activity activity;
private ArrayList<HashMap<String,String>> data;
private static LayoutInflater inflater=null;
//public ImageLoader imageloader;

public PropertySearchArrayAdapter(Activity context, ArrayList<HashMap<String,String>> d){

    activity=context;
    data=d;
    inflater=(LayoutInflater)activity.getSystemService(Context.LAYOUT_INFLATER_SERVICE);

}

@Override
public View getView(int position,View convertview, ViewGroup parent){

    View rowview=convertview;
    if(convertview==null){
                rowview=inflater.inflate(R.layout.searchlist_row, null);}

        //ViewHolder viewholder=new ViewHolder();
        TextView propertyType=(TextView) rowview.findViewById(R.id.propertytype); //propertytype

    HashMap<String,String> property= new HashMap<String,String> ();
    property= data.get(position);

    propertyType.setText(property.get("propertytype"));
    Log.d("adaptertext", property.get("propertytype"));

    return rowview;

}

@Override
public int getCount() {
    // TODO Auto-generated method stub
    return 0;
}

@Override
public Object getItem(int arg0) {
    // TODO Auto-generated method stub
    return null;
}

@Override
public long getItemId(int arg0) {
    // TODO Auto-generated method stub
    return 0;
} 
```

}

这些是 XML

```
 searchresultrowlayout
<?xml version="1.0" encoding="utf-8"?>
  <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"

android:layout_width="fill_parent"
android:layout_height="wrap_content"
android:orientation="vertical" >

    <ListView
    android:id="@+id/list"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:divider="#b5b5b5"
    android:dividerHeight="1dp"
    android:listSelector="@drawable/list_selector" />

</LinearLayout> 
```

搜索列表行

```
<?xml version="1.0" encoding="utf-8"?>

<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="wrap_content"
android:background="#FFFFFF"
android:orientation="horizontal"
android:padding="5dip" >

<!-- Property type-->
<TextView
    android:id="@+id/propertytype"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"

    android:textColor="#040404"
    android:typeface="sans"
    android:textSize="15dip"
    android:textStyle="bold"/>

</RelativeLayout> 
```

其他 XMLs list_selector,gradient_bg.xml,gradient_bg_hover.xml 我取自[教程](http://www.androidhive.info/2012/02/android-custom-listview-with-image-and-text/)本身。

我的问题是，当我推动应该显示列表视图的活动时（通过按钮单击上一个活动的意图），出现的屏幕完全是黑色和空白的。请帮帮我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T18:02:40.040

如果您希望`ListView`显示数据，您的适配器必须使用该方法返回它包含（或想要显示）的项目数，`getCount()`而不是`0`（在这种情况下，适配器将被视为空并且不会显示任何内容）：

```
@Override
public int getCount() {       
    return data.size();
} 
```

# java - 如何在java中将成员函数作为参数传递？

> ID：15228820
> 
> 赞同：1
> 
> 时间：2013-03-05T16:18:09.270
> 
> 标签：java

我的`collect()`函数调用`Foo.f()`. 我想让`Foo.f()`自己成为我函数的参数。这在Java中可能吗？

*   如何将`Foo.f()`or （或返回 a 的`Foo.g()`任何其他函数）传递给我的函数？`Foo``String`
*   是否有一个已经存在的函数来遍历集合并收集调用每个集合项的方法的结果？

.

```
class Foo {
    public String f() { return "f"; }
    public String g() { return "g"; }
    // ...
}

public List<String> collect(List<Foo> foos)
{
    List<String> result = new ArrayList<String>();

    for (final Foo foo: foos) {
        result.add(foo.f());  // I want Foo.f to be a parameter
    }

    return result;
} 
```

**更新**

我想指出一个事实，即我不仅调用同一个函数，而且调用集合`f`中所有项目的成员函数`List<Foo>`。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-05T16:23:11.090

在 Java 8 中，你可以做

```
collect(foos, Foo::f);

public List<String> collect(List<Foo> foos, Function<Foo,String> func)
{
    List<String> result = new ArrayList<String>();

    for (final Foo foo: foos) {
        result.add(func.apply(foo));
    }

    return result;
} 
```

或使用蒸汽 API

```
Stream<Foo> foos = ...;
Stream<String> strs = foos.map(Foo::f); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-05T16:22:02.400

您可以使用接口

```
 interface Foo
  {
      String fn();
  } 
```

并将接口传递给方法

```
 void anyMethod(Foo f)
 {
   f.fn();
 } 
```

你不需要创建一个具体的`Foo`，只需`Foo`匿名创建

```
 new Foo() {

  @Override
  public String fn()
  {
   return "something";
  }
}; 
```

在 Java 8 中，您不需要匿名实现接口。您可以改用 lambda 表达式。

```
 anyMethod(()-> "something"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T16:23:33.503

在Java中，您不应该将方法作为参数传递，但您可以将对象作为参数传递。

它被称为[Strategy Pattern](http://en.wikipedia.org/wiki/Strategy_pattern)，你需要使用接口。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-05T16:29:03.200

您可以使用如下界面：

```
interface IFoo {
    String getString();
} 
```

然后以自定义方式实现它：

```
class F implements IFoo {
    public String getString() {
        return "f";
    }
}

class G implements IFoo {
    public String getString() {
        return "g";
    }
} 
```

并让您的函数列出所有实现的内容`IFoo`：

```
public List<String> collect(List<? extends IFoo> foos)
{
    List<String> result = new ArrayList<String>();

    for (final IFoo foo: foos) {
        result.add(foo.getString());
    }

    return result;
} 
```

用法：

```
for (String a : collect(Arrays.asList(new F(), new G()))) {
    System.out.println(a);
}
    //Prints f and g 
```

# wordpress - Wordpress 获取当前类别 ID

> ID：15228823
> 
> 赞同：19
> 
> 时间：2013-03-05T16:18:20.437
> 
> 标签：wordpress

我正在尝试获取我正在查看的类别页面的当前 ID。

我检查了[the_category_ID](http://codex.wordpress.org/Function_Reference/the_category_ID)

但是当我使用时，这与我的结果相呼应

```
<?php $catID = the_category_ID(); ?> 
```

有没有办法让它将值返回给变量以便隐藏？

* * *

## 回答 #1

> 赞同：46
> 
> 时间：2013-03-05T17:40:25.543

`$cat`当您在类别页面中时，当前类别 ID 位于全局变量中。

您可以使用以下方法对其进行测试：

```
<?php echo "Current Category ID is: " . $cat ;?> 
```

例如，当您在此页面时`http://example.com/category/test`

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-03-05T16:35:59.487

尝试以下

`$catID = get_query_var( 'cat' );`

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-08-07T11:35:06.790

```
$category= get_queried_object();
echo $category->term_id; 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-04-02T15:40:23.067

`the_category_ID`已于 2003年[弃用](http://codex.wordpress.org/Function_Reference/the_category_ID)。

试试这个：

```
if (is_category()) {
    $category = get_category(get_query_var('cat'));
    $cat_id = $category->cat_ID;
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-06-12T17:33:40.237

功能`the_category_ID`已弃用。您需要改用`get_the_category()`函数。例如：

```
$category = get_the_category(); 
echo $category[0]->cat_name; 
```

在 wordpress codex 上查看更多信息：[get_the_category](http://codex.wordpress.org/Function_Reference/get_the_category)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2016-10-14T15:30:06.223

此代码当前用于获取类别 ID：

```
<?php
$category = get_the_category(); 
echo $category[0]->cat_ID;
?> 
```

今天是 2016 年 10 月 18 日，这对我有用。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-05T16:48:44.190

这会写入变量而不是回显

```
<?php $catID = the_category_ID($echo=false);?> 
```

* * *

## 回答 #8

> 赞同：-3
> 
> 时间：2015-09-16T13:17:54.580

您将在变量中获得当前类别 ID，

```
<?php $catID = the_category_ID($echo);?> 
```

这不直接打印，只要给打印语句那个时候就打印。

# android - (Android) 如果我有水平滚动，如何将 TextView 放在屏幕的中心（不在布局或父视图中）？

> ID：15228825
> 
> 赞同：0
> 
> 时间：2013-03-05T16:18:24.253
> 
> 标签：android, textview

这是我的问题：我有一个（水平的）非常大`View`的，当然，我有一个滚动来并排移动它。我想把 a`TextView`放在中间，但我想要这样，当我水平滚动并且`View`移动时，它会`TextView`停留在屏幕的中心。

如果我使用`android:gravity="center"`或类似的东西，因为视图非常大，除非我在视图的中心，否则我不会在中心看到 TextView（不是在开始，也不是在最后），但我需要`TextView`在整个滚动过程中位于中心。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T16:25:39.417

我认为您可以通过将元素设置在中间来实现这一点，方法是将其 x 原点（使用左填充或左外边距？）设置为`(scrollview.width/2 - textview.width/2)`，然后在滚动视图滚动时添加**scrollview.offset.x**（添加监听器到得到这个）所以它仍然保持在相对中心。

然而，最简单的方法可能是放置一个 FrameLayout，其中包含 ScrollView 并在其上方放置 TextView，然后您可以使用重力属性将其居中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T16:22:31.117

大概您的内容都在 ScrollView 中。您需要将 TextView 置于此滚动视图之外：然后您可以使用“ [Android 将视图覆盖在所有内容之上？](https://stackoverflow.com/questions/7519160/android-overlay-a-view-ontop-of-everything) ”中描述的技术将 TextView 放置在您想要的位置。

# eclipse - 在 Eclipse 中调试 Web 应用程序

> ID：15228826
> 
> 赞同：1
> 
> 时间：2013-03-05T16:18:28.200
> 
> 标签：eclipse, debugging, tomcat, web-applications

我想通过 Eclipse 调试一个 webapp。webapp 将在我在 Eclipse 中配置的 Tomcat 7 实例上运行，因此包括 Tomcat 的启动在内的一切都将在 Eclipse 中完成。

现在，我的问题是在这种情况下调试 webapp 的最佳方法是什么。是否可以进行本地调试，或者唯一的解决方案是远程调试。

我知道如何进行远程调试，但鉴于一切都是在 Eclipse 中完成的，我想看看是否有更好的方法来做这件事。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T16:24:48.620

点击`Run`-> `Debug Configurations...`。在左侧，您应该列出您的 Tomcat 服务器。（如果没有，您首先必须在首选项中定义它）。

配置您的 VM 设置和您需要的任何内容，然后只需单击`Debug`右下角的 。

您的服务器现在应该以调试模式启动，并在断点处停止。

从现在开始，服务器将包含在工具栏中调试按钮的弹出菜单中。

或者，您可以添加*服务器*视图 ( `Window`-> `Show View`-> `Servers`)，选择您的服务器并通过右键单击在调试中启动它

# php - 日期格式的php字符串，加上12小时

> ID：15228832
> 
> 赞同：6
> 
> 时间：2013-03-05T16:18:32.583
> 
> 标签：php, datetime, strtotime

`string`我的 php 数组中有这个对象

“2013-03-05 00:00:00+00”

我想在 PHP 中的条目中添加 12 小时，然后以相同的格式将其保存回字符串

我相信这涉及将字符串转换为日期对象。但我不确定日期对象有多聪明，以及是否需要告诉它格式化参数，或者它是否应该只接受字符串

```
$date = new DateTime("2013-03-05 00:00:00+00");
$date->add("+12 hours");
//then convert back to string or just assign it to a variable within the array node 
```

我从这种方法或我尝试过的类似方法中取回了空值

你会如何解决这个问题？

谢谢，感谢您的见解

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-03-05T16:20:28.603

更改`add()`为`modify()`。`add()`需要一个 DateInterval 对象。

```
<?php
$date = new DateTime("2013-03-05 00:00:00+00");
$date->modify("+12 hours");
echo $date->format("Y-m-d H:i:sO"); 
```

[看到它在行动](http://codepad.viper-7.com/6RBHvp)

下面是一个使用 DateInterval 对象的示例：

```
<?php
$date = new DateTime("2013-03-05 00:00:00+00");
$date->add(new DateInterval('PT12H'));
echo $date->format("Y-m-d H:i:sO"); 
```

[看到它在行动](http://codepad.viper-7.com/c10ZB6)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-05T16:28:34.713

更改此行

```
$date->add("+12 hours"); 
```

和

```
$date->add(new DateInterval("PT12H")); 
```

这将使您的约会时间增加 12 小时

查看[DateInterval 构造函数](http://www.php.net/manual/en/dateinterval.construct.php)页面以了解如何构建`DateInterval`字符串

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-07-12T02:20:48.400

用它来增加时间，

```
$date1= "2014-07-03 11:00:00";
$new_date= date("Y-m-d H:i:s", strtotime($date1 . " +3 hours"));
echo $new_date; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-02-21T09:17:51.147

如果您有动态间隔，这种方式将避免 $dateDiff 格式错误的错误：

```
$dateDiff = "12 hours";
$interval = DateInterval::createFromDateString($dateDiff);
$date = new DateTime("2013-03-05 00:00:00+00");
$date->add($interval);
echo $date->format("Y-m-d H:i:sO"); 
```

# rest - Windows Azure Graph AD 使用 Rest API 创建组

> ID：15228833
> 
> 赞同：0
> 
> 时间：2013-03-05T16:18:32.543
> 
> 标签：rest, azure, azure-ad-graph-api

我正在尝试使用 Windows azure Graph for Office365 的其余 API 创建一个组。我将 xml 有效负载传递给 url [https://graph.windows.net/49aa83c813-59c999-4e29-a753-25fd8caebe93/Group](https://graph.windows.net/49aa83c813-59c999-4e29-a753-25fd8caebe93/Group)

我传递的payLoad是

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?><entry xmlns="http://www.w3.org/2005/Atom" xmlns:d="http://schemas.microsoft.com/ado/2007/08/dataservices" xmlns:m="http://schemas.microsoft.com/ado/2007/08/dataservices/metadata"><content type="application/xml"><m:properties><d:DisplayName>testingGroup</d:DisplayName><d:Description>Test group</d:Description><d:MailEnabled>true</d:MailEnabled><d:DirSyncEnabled>false</d:DirSyncEnabled><d:SecurityEnabled>false</d:SecurityEnabled><d:ObjectType>Group</d:ObjectType><d:MailNickname>firstGroup</d:MailNickname><d:Mail>firstGroup@companyName.us</d:Mail></m:properties></content></entry> 
```

我收到 400 错误作为响应。谁能告诉我正确的 XML payLoad 可以通过吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T02:30:31.167

首先，您的请求 URI 不正确。要使用 Graph API 0.8 版创建组，应采用以下格式：

[https://graph.windows.net/yourtenantdomainname.com/Group](https://graph.windows.net/yourtenantdomainname.com/Group)

您的租户也可能是 *.onmicrosoft.com 地址。其他几件事：该服务当前不支持设置 DirSyncEnabled 或 Mail 属性。它们都是只读的。目前您需要将 MailEnabled 设置为 false 并将 SecurityEnabled 设置为 true。

要使用 0.8 版本创建组，您的请求将如下所示：

```
POST https://graph.windows.net/yourtenantname.com/Groups HTTP/1.1
Authorization: Bearer eyJ0eXAiOiJK...vYiFqfkg
Host: graph.windows.net
Content-Type: application/atom+xml
x-ms-dirapi-data-contract-version: 0.8
Content-Length: 725

<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<entry xmlns="http://www.w3.org/2005/Atom" xmlns:d="http://schemas.microsoft.com/ado/2007/08/dataservices" xmlns:m="http://schemas.microsoft.com/ado/2007/08/dataservices/metadata">
  <content type="application/xml">
    <m:properties>
      <d:DisplayName>testingGroup</d:DisplayName>
      <d:Description>Test group</d:Description>
      <d:MailEnabled>false</d:MailEnabled>
      <d:ObjectType>Group</d:ObjectType>
      <d:SecurityEnabled>true</d:SecurityEnabled>
      <d:MailNickname>firstGroup</d:MailNickname>
    </m:properties>
  </content>
</entry> 
```

请注意，最近发布了 0.9 版 Graph API：http: [//blogs.msdn.com/b/aadgraphteam/archive/2013/03/03/0-9-version-of-azure-active-directory-graph-now -available.aspx](http://blogs.msdn.com/b/aadgraphteam/archive/2013/03/03/0-9-version-of-azure-active-directory-graph-now-available.aspx)

如果您想使用最新版本的 API 创建组，这就是使用 XML 作为有效负载的请求的外观（注意 URI 中的 camelCase 属性和“组”）：

```
POST https://graph.windows.net/yourtenantname.com/groups?api-version=0.9 HTTP/1.1
Authorization: Bearer eyJ0eXAi...YiFqfkg
Host: graph.windows.net
Content-Type: application/atom+xml
Content-Length: 627

<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<entry xmlns="http://www.w3.org/2005/Atom" xmlns:d="http://schemas.microsoft.com/ado/2007/08/dataservices" xmlns:m="http://schemas.microsoft.com/ado/2007/08/dataservices/metadata">
  <content type="application/xml">
    <m:properties>
      <d:displayName>testingGroup</d:displayName>
      <d:description>Test group</d:description>
      <d:mailEnabled>false</d:mailEnabled>
      <d:objectType>Group</d:objectType>
      <d:securityEnabled>true</d:securityEnabled>
      <d:mailNickname>firstGroup</d:mailNickname>
    </m:properties>
  </content>
</entry> 
```

最后只是为了好玩，如果您想使用新支持的最小 JSON，有效负载将如下所示：

```
{
    "displayName": "testingGroup",
    "description": "Test group",
    "mailNickname": "firstGroup",
    "mailEnabled": false,
    "securityEnabled": true
} 
```

# google-app-engine - 转向 ZIG ZAG 合并与最佳索引

> ID：15228838
> 
> 赞同：1
> 
> 时间：2013-03-05T16:18:49.313
> 
> 标签：google-app-engine, indexing, objectify

我的应用程序当前定义了所需的所有最佳索引。但慢慢地我开始遭受爆炸索引问题的困扰，所以我想改变我的策略并开始使用“zig-zag”合并，如此[处](https://developers.google.com/appengine/articles/indexselection)所述。

我的实体`Contact`有 3 个排序顺序：

*   `lastModified`ASC

*   `fullNameUpperCase`ASC + DESC

它有 4 个过滤器：

*   `contactProfile`

*   `contactStatus`

*   `contactType`

*   `searchFields`（模拟'startsWith...'的不等式查询）

searchFields 是一个特例，因为我用它来模拟像这样的“startswith”

```
 query = query.filter("searchFields >= ", criteria.getSearchString().toUpperCase());
 query = query.filter("searchFields <= ", criteria.getSearchString().toUpperCase() + "\ufffd"); 
```

按照文章中的解释，我需要定义

```
 (number of filters + 1) * (number of orders) = 5 * 3 = 15. 
```

*   **我的主要问题！**：

下面的新定义似乎在开发服务器上工作，但**不是第一次**。第一次应该进行 zigzag 合并的新组合时，开发服务器仍然会抛出 DatastoreNeedIndexException。第二次重复相同的查询，查询运行并返回预期的结果。在对结果进行分页时也会发生这种情况。第一次查询下一页时，抛出异常。重复作品。有人也见过这种行为吗？这是开发服务器问题还是我遗漏了什么？还是这个最初不完整的索引构建可能......例如，当我第一次组合这些过滤器时，开发服务器抱怨它作为索引丢失：

```
<datastore-index kind="Contact" ancestor="true" source="manual">
    <property name="contactProfile" direction="asc"/>
    <property name="status" direction="asc"/>
    <property name="fullNameUpperCase" direction="desc"/>
</datastore-index> 
```

以下是实体 Contact 的新索引定义：

```
<!-- SORT ORDERS -->
<datastore-index kind="Contact" ancestor="true" source="manual">
    <property name="fullNameUpperCase" direction="asc" />
</datastore-index>
<datastore-index kind="Contact" ancestor="true" source="manual">
    <property name="fullNameUpperCase" direction="desc" />
</datastore-index>
<datastore-index kind="Contact" ancestor="true" source="manual">
    <property name="lastModified" direction="desc" />
</datastore-index>
<!-- FILTER: SEARCHFIELDS -->
<datastore-index kind="Contact" ancestor="true" source="manual">
    <property name="fullNameUpperCase" direction="asc" />
    <property name="searchFields" direction="asc" />
</datastore-index>
<datastore-index kind="Contact" ancestor="true" source="manual">
    <property name="fullNameUpperCase" direction="desc" />
    <property name="searchFields" direction="asc" />
</datastore-index>
<datastore-index kind="Contact" ancestor="true" source="manual">
    <property name="lastModified" direction="desc" />
    <property name="searchFields" direction="asc" />
</datastore-index>
<!-- FILTER: CONTACTSTATUS -->
<datastore-index kind="Contact" ancestor="true" source="manual">
    <property name="fullNameUpperCase" direction="asc" />
    <property name="status" direction="asc" />
</datastore-index>
<datastore-index kind="Contact" ancestor="true" source="manual">
    <property name="fullNameUpperCase" direction="desc" />
    <property name="status" direction="asc" />
</datastore-index>
<datastore-index kind="Contact" ancestor="true" source="manual">
    <property name="lastModified" direction="desc" />
    <property name="status" direction="asc" />
</datastore-index>
<!-- FILTER: CONTACTTYPE -->
<datastore-index kind="Contact" ancestor="true" source="manual">
    <property name="fullNameUpperCase" direction="asc" />
    <property name="contactType" direction="asc" />
</datastore-index>
<datastore-index kind="Contact" ancestor="true" source="manual">
    <property name="fullNameUpperCase" direction="desc" />
    <property name="contactType" direction="asc" />
</datastore-index>
<datastore-index kind="Contact" ancestor="true" source="manual">
    <property name="lastModified" direction="desc" />
    <property name="contactType" direction="asc" />
</datastore-index>
<!-- FILTER: CONTACTPROFILE -->
<datastore-index kind="Contact" ancestor="true" source="manual">
    <property name="fullNameUpperCase" direction="asc" />
    <property name="contactProfile" direction="asc" />
</datastore-index>
<datastore-index kind="Contact" ancestor="true" source="manual">
    <property name="fullNameUpperCase" direction="desc" />
    <property name="contactProfile" direction="asc" />
</datastore-index>
<datastore-index kind="Contact" ancestor="true" source="manual">
    <property name="lastModified" direction="desc" />
    <property name="contactProfile" direction="asc" />
</datastore-index> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T15:13:04.963

在我将排序顺序移动到组合索引中的最后一个属性后，它不起作用的问题得到了解决。

所以例如

```
<datastore-index kind="Contact" ancestor="true" source="manual">
    <property name="fullNameUpperCase" direction="asc" />
    <property name="status" direction="asc" />
</datastore-index> 
```

不得不成为。

```
<datastore-index kind="Contact" ancestor="true" source="manual">
    <property name="status" direction="asc" />
    <property name="fullNameUpperCase" direction="asc" />
</datastore-index> 
```

所以最后一个属性是排序顺序。

其次，必须将 seachFields 视为排序顺序，我必须进行组合。索引现在变成 5 个排序顺序：

*   最后修改的 ASC

*   全名大写字母 ASC + DESC

*   搜索字段 ASC + DESC

3个过滤器：

*   联系方式

*   联系状态

*   联系人类型

    （过滤器数量 + 1）*（订单数量）= 4 * 5 = 20 个索引。

这是功能齐全的列表：

```
<!-- SORT ORDERS -->
<datastore-index kind="Contact" ancestor="true" source="manual">
    <property name="fullNameUpperCase" direction="asc" />
</datastore-index>
<datastore-index kind="Contact" ancestor="true" source="manual">
    <property name="fullNameUpperCase" direction="desc" />
</datastore-index>
<datastore-index kind="Contact" ancestor="true" source="manual">
    <property name="lastModified" direction="desc" />
</datastore-index>
<datastore-index kind="Contact" ancestor="true" source="manual">
    <property name="searchFields" direction="asc" />
</datastore-index>
<datastore-index kind="Contact" ancestor="true" source="manual">
    <property name="searchFields" direction="desc" />
</datastore-index>
<!-- FILTER: CONTACTSTATUS -->
<datastore-index kind="Contact" ancestor="true" source="manual">
    <property name="status" direction="asc" />
    <property name="fullNameUpperCase" direction="asc" />
</datastore-index>
<datastore-index kind="Contact" ancestor="true" source="manual">
    <property name="status" direction="asc" />
    <property name="fullNameUpperCase" direction="desc" />
</datastore-index>
<datastore-index kind="Contact" ancestor="true" source="manual">
    <property name="status" direction="asc" />
    <property name="lastModified" direction="desc" />
</datastore-index>
<datastore-index kind="Contact" ancestor="true" source="manual">
    <property name="status" direction="asc" />
    <property name="searchFields" direction="asc" />
</datastore-index>
<datastore-index kind="Contact" ancestor="true" source="manual">
    <property name="status" direction="asc" />
    <property name="searchFields" direction="desc" />
</datastore-index>
<!-- FILTER: CONTACTTYPE -->
<datastore-index kind="Contact" ancestor="true" source="manual">
    <property name="contactType" direction="asc" />
    <property name="fullNameUpperCase" direction="asc" />
</datastore-index>
<datastore-index kind="Contact" ancestor="true" source="manual">
    <property name="contactType" direction="asc" />
    <property name="fullNameUpperCase" direction="desc" />
</datastore-index>
<datastore-index kind="Contact" ancestor="true" source="manual">
    <property name="contactType" direction="asc" />
    <property name="lastModified" direction="desc" />
</datastore-index>
<datastore-index kind="Contact" ancestor="true" source="manual">
    <property name="contactType" direction="asc" />
    <property name="searchFields" direction="asc" />
</datastore-index>
<datastore-index kind="Contact" ancestor="true" source="manual">
    <property name="contactType" direction="asc" />
    <property name="searchFields" direction="desc" />
</datastore-index>
<!-- FILTER: CONTACTPROFILE -->
<datastore-index kind="Contact" ancestor="true" source="manual">
    <property name="contactProfile" direction="asc" />
    <property name="fullNameUpperCase" direction="asc" />
</datastore-index>
<datastore-index kind="Contact" ancestor="true" source="manual">
    <property name="contactProfile" direction="asc" />
    <property name="fullNameUpperCase" direction="desc" />
</datastore-index>
<datastore-index kind="Contact" ancestor="true" source="manual">
    <property name="contactProfile" direction="asc" />
    <property name="lastModified" direction="desc" />
</datastore-index>
<datastore-index kind="Contact" ancestor="true" source="manual">
    <property name="contactProfile" direction="asc" />
    <property name="searchFields" direction="asc" />
</datastore-index>
<datastore-index kind="Contact" ancestor="true" source="manual">
    <property name="contactProfile" direction="asc" />
    <property name="searchFields" direction="desc" />
</datastore-index> 
```

PS：我删除了有关如何将生产环境迁移到新索引的附加问题，如果需要，我将发布一个新问题；

# c# - 如何从 C# 连接到正在运行的 Outlook 实例

> ID：15228845
> 
> 赞同：4
> 
> 时间：2013-03-05T16:19:11.990
> 
> 标签：c#, .net-4.0, excel-2007, office-interop, outlook-2007

在 VBA 中，我通常`appOutlook = GetObject(, "Outlook.Application")`用来获取 Outlook 的运行实例，如果 Outlook 没有运行，它会引发错误。我通常在 excel 中执行此操作，但现在我想看看是否可以通过迁移到 C# 并从那里获得更好的结果。我需要做的是从 Outlook 复制电子邮件并将它们粘贴到 excel 中，以便将电子邮件中的表格作为单元格值而不是 html 粘贴到电子表格中。但是，我不太确定如何执行此操作。我通常使用`Activator.CreateInstance`，但它会创建一个新实例。如何连接到 Excel 和 Outlook 的当前实例？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-05T16:22:11.803

您可以[`System.Runtime.InteropServices.Marshal.GetActiveObject()`](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal.getactiveobject.aspx)用于此目的。

（请参阅[此相关问题](https://stackoverflow.com/q/3770784/501250)。）

# assembly - 如何比较8086中的输入数字？

> ID：15228851
> 
> 赞同：0
> 
> 时间：2013-03-05T16:19:36.750
> 
> 标签：assembly, x86-16

问题是要求用户输入任何数字。并将输入的数字与预定义的常数进行比较。然后输出一条消息，表明输入的数字大于或小于或等于定义的数字。在这个例子中，我的预定义数字是 27。

我的代码是：

```
 .MODEL small
   .STACK 100h
   .DATA
promptmsg DB 'Please enter a number [1..100]',13,10,'$'
greatermsg db 'You have entered a greater number', 13, 10, '$'
lessmsg db 'You have entered a lesser number', 13 , 10, '$'
correctmsg db 'You have hit the right number', 13, 10, '$'
numbr dw 27
   .CODE
   .startup
   mov  ax,@data
   mov  ds,ax                   
   lea dx, promptmsg
   mov  ah,9    
   int  21h                     
   mov ah, 0ah
   int 21h
   mov ah, 9
   int 21h
   mov bx, numbr
   cmp ax, bx
   jb lesser
   ja greater
correct:
   mov dx, offset correctmsg
   mov ah, 09h
   int 21h
   jmp endexe
greater:
   mov dx, offset greatermsg
   mov ah, 09h
   int 21h
   jmp endexe
lesser:
   mov dx, offset lessmsg
   mov ah, 09h
   int 21h
endexe:
   mov  ah,4ch                 ;DOS terminate program function
   int  21h                    ;terminate the program
   END 
```

如果我输入任何数字，无论它大于或小于或等于预定义的数字，它总是跳到更大。我的代码是否有任何问题，无法识别我的输入号码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T17:14:20.957

我在您的代码中看到了这一行：

```
mov bx, ans 
```

但是，我没有在任何地方看到“ans”的定义。您指的是 'numbr' 吗？

我看到了其他一些问题。您的代码似乎认为 int 21h/ah=0ah 操作的结果将通过 ax 寄存器返回一个数字。它不会。根据[我在谷歌搜索时发现的第一个引用](http://spike.scu.edu.au/~barry/interrupts.html#ah0a)，该操作在 ds:dx 引用的缓冲区中返回一个字符串。其中，顺便说一句，您的代码没有明确建立——当调用 int 21h/ah=0ah 时，ds:dx 仍然指向 promptmsg，因此该操作将覆盖提示。

所以看起来代码打印了提示，要求输入，然后将输入打印回给用户。到了比较的时候：

```
cmp ax, bx 
```

您已经将 9 放入 ax 的上半部分，因此总是采用“更大”的路径是有道理的。但同样，这并不重要，因为读取指令不会通过 ax 返回输入数据，而是在 ds:dx 指向的缓冲区中返回。

但是，即使您确实加载了 ds:dx 引用的第一个字节，您的代码仍然无法按预期工作。您需要将一系列 ASCII 字符转换为数字。即，'9' -> 9，'100' -> 100。这将需要更多代码。

# jquery - 如何使用 JQuery 一次为一个列表设置动画

> ID：15228855
> 
> 赞同：0
> 
> 时间：2013-03-05T16:19:56.257
> 
> 标签：jquery, list, animation

我正在尝试复制这种效果[http://www.officialwaynerooney.com/social](http://www.officialwaynerooney.com/social)

到目前为止我有这个

```
 $(document).ready(function(){
        $(window).scroll(function(){
            var scrollTop = 100;
            if($(window).scrollTop() >= scrollTop){
                $('li').animate();  
                //Animation
            }
        })
    }) 
```

但显然它会为所有列表项设置动画。如何最好一次定位一个列表项。我只是想不出最好的方法是什么。

谢谢，

马特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T16:27:57.427

循环遍历每个`li`并对每个应用单独的动画调用。

```
$('li').each(function(i) {
    $(this).animate();
}); 
```

`$(this)`在循环内部根据或`i`（列表中元素的索引）的属性设置动画，例如`$(this).delay(i * 50).animate(/* other properties */)`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T16:39:58.700

For the initial animations:

```
$('li').each(function(i) {
    if($(this).offset().top < $(window).height()){
        $(this).delay(i * 50).animate();
    }
}); 
```

And this for the ones beyond the initial window:

```
var oldTop = 0;

$(window).scroll(function(){
    var scrollTop = $(window).scrollTop();
    if(scrollTop > oldTop ){
         $('li:hidden').each(function(i) {
             if($(this).offset().top < $(window).height() + scrollTop){
                  $(this).delay(i * 50).animate();
             }
       });
       oldTop = scrollTop;
    }
}) 
```

**Note**: I'm using the `:hidden` psuedo-selector assuming the `li`'s are hidden initially. if they're not, you can have them all have an initial class and check for that, and remove it when animating. Or something, there's lots of ways you can check if it's been animated.

# php - ajax Json 返回 null

> ID：15228858
> 
> 赞同：0
> 
> 时间：2013-03-05T16:20:13.910
> 
> 标签：php, jquery, ajax, json

我用 json 响应对 php 进行了简单的 ajax 调用。我已经多次写过这些，但从未遇到过这个问题。

Ajax 通过“id”参数很好地发送，PHP 接收它，它是否工作并发送回 json 响应，这是问题开始的地方。其中一个参数始终为空，原因我似乎找不到。我已经手动测试了 php，它返回了两个值。我已经检查了 ajax 以查看它是否恢复了 id 参数，它确实如此。所以问题出在发送 json 响应的某个地方，它被 jquery ajax 接收。

```
 // This gets the paramaters from the url
 theParams = parseURLParams(document.URL);

 // ^^ it returns an id, like this  {"id":"4a17bcb93fe3fac3978671a66959d902"}

 $.ajax({
    url: 'viewer_code.php',
    type: 'GET',
    dataType: 'json',
    data: {id: theParams.id},
    success: function(dataImg) { 

    alert(dataImg.imgUrl);

    }
}); 
```

和 PHP（一切看起来都很好，所有都将被清理）

```
 $id = $_GET['id'];

    $q = "SELECT * FROM `images` WHERE id = '$id'";
    if(!($result_set = mysql_query($q))) die(mysql_error());
        $row = mysql_fetch_array($result_set);

        $thumb = $row['thumb'];
        $image = $row['image'];

        header('Content-Type: application/json');
        echo json_encode(array("imgUrl" => $image, "id" => $id)); 
```

当手动测试 PHP 时，它返回： {"imgUrl":"pictures/75de7c1c30d956113f937a8e685f7e50.jpg","id":"4a17bcb93fe3fac3978671a​​66959d902"}

总是返回 null 的是 imgUrl，有人知道为什么会这样吗？哦，我已经尝试从 GET 切换到 POST，正如之前关于 SO 的问题所建议的那样，但这没有任何区别。

非常感谢您的帮助，干杯：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T16:46:01.103

你有没有尝试而不是`id: theParams.id`使用`id: 1`我在尝试处理不正确的 json 变量时遇到了一个大问题。

另一方面，我正在做类似的代码，但没有

```
header('Content-Type: application/json'); 
```

您是否尝试过您的 php 文件`echo json_encode(array("imgUrl" => 'image.jpg', "id" => '1'));`根据这些测试，也许我可以为您提供更多帮助

# json - 在 JSON three.js 中解析字符串

> ID：15228860
> 
> 赞同：0
> 
> 时间：2013-03-05T16:20:16.597
> 
> 标签：json, three.js, webgl

我是 Three.js 的新手。我需要使用 Three.js 的 JSONLoader 从 JSON 文件中获取“DbgName”：“mtl”。这是我的示例 three.js 的 JSON 文件

```
{"metadata" :
{"formatVersion" : 3.1,
"sourceFile" : "json",
"generatedBy" : "json",
"vertices" : 20,
"faces" : 81,
"normals" : 0,
"colors" : 0,
"uvs" : 0,
"materials" : 4},

"scale" : 1.000000,
"materials": [{
"DbgColor" : 15658734,
"DbgIndex" : 0,
"DbgName" : "mtl1",
"colorAmbient" : [0.0, 0.0, 0.0],
"colorDiffuse" : [0.64, 0.64, 0.64],
"colorSpecular" : [0.165, 0.165, 0.165],
"illumination" : 2,
"opticalDensity" : 1.0,
"specularCoef" : 154.901961,
"transparency" : 1.0
}
]} 
```

任何人都可以给出一些相同的建议..谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T07:33:49.790

`THREE.JSONLoader`不是通用的 JSON 加载器：它从具有特定属性的 JSON 文件加载网格和材质。

为了加载你自己的东西，你仍然可以使用（复制粘贴）加载器的 AJAX 请求部分，这里是：[https ://github.com/mrdoob/three.js/blob/r56/src/loaders/JSONLoader .js#L29](https://github.com/mrdoob/three.js/blob/r56/src/loaders/JSONLoader.js#L29)

请注意，一旦您获得了文件文本，就可以使用标准浏览器提供的函数[轻松地将其解析为 JS 对象：](https://github.com/mrdoob/three.js/blob/r56/src/loaders/JSONLoader.js#L43)`var mystuff = JSON.parse(fileTextContents)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T14:36:04.487

我通过这种方式从json文件中获取了材料名称......

```
var loader = new THREE.JSONLoader();
loader.load(url,function(geometry,material){
....some code stuff........
var mName = materials.name;
....some code stuff.....
} 
```

# php - 如何处理不同环境的 php 重定向

> ID：15228861
> 
> 赞同：0
> 
> 时间：2013-03-05T16:20:17.550
> 
> 标签：php, redirect

我正在开发一个 php 应用程序，该应用程序涉及创建会话并在成功创建会话后将用户重定向到仪表板页面。我目前使用以下代码：

```
if ($success) {
    header("Location: http://www.mydomain.com/dashboard.php");
} 
```

我正在努力使我的应用程序可供其他人下载并在他们自己的服务器上使用，因此我正在寻找另一种方法来编写上面的重定向代码，以便它不限于仅`mydomain.com`. 您如何处理任何域的 php 重定向？可以`header()`使用相对路径，例如`header("Location: ./dashboard.php");`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T16:22:11.340

最好的方法是保存一个`configuration.php`文件，您可以在其中存储所有这些信息（根据最终用户需求定制）并从该文件中检索您需要的所有信息。

这个文件可以用初始化脚本或类似的东西“组成”（如果你有一个后台，甚至直接存储在数据库中，或者让你的后台本身可写这个文件，*所有的风险都是这样的*）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T16:33:19.607

过去我使用`$_SERVER`全局来获取当前网站的域。

```
echo $_SERVER['SERVER_NAME']; 
```

这种方法的一个缺点是应用程序可能不在顶级目录中运行。所以，通常我所做的是在 index.php 中（所有请求都通过 index.php 路由）我用基本路径和域定义了一个常量，所以是这样的：

```
define('BASE_PATH', 'http://' . $_SERVER['HTTP_HOST'] . pathinfo($_SERVER['PHP_SELF'])['dirname']); 
```

# statistics - 我如何解释非显着的交互作用？

> ID：15228866
> 
> 赞同：0
> 
> 时间：2013-03-05T16:20:29.460
> 
> 标签：statistics, interaction, interpretation

以下是测试男性在特定就业市场中是否收入较低的输出：

```
Income=b1*education+b2*male+b3*male*education 
```

其中 b1=100（重要），b2=-50（不重要），b3=10（不重要）

我应该如何解释这种工作是否对男性不利？从系数中，我知道

1.  如果是女性，收入=100*edu；
2.  如果是男性，收入=100*edu-50+10*edu=110*edu-50，

但是我在这里关心的是b2，b3都是微不足道的，那么我该如何解释整个故事呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T16:28:59.697

这不是这个问题的正确位置，但你可以看到，保持其他一切持续教育对收入有积极影响。此外，您需要更多数据才能准确地做到这一点，可能存在一些样本偏差，或者一个文件的影响可能会在另一个文件中得到体现。例如，也许男性更有可能在该领域接受高等教育。另一种有趣的方法是估计两个独立的方程。一个给女性，一个给男性，然后估计男性如果是女性会做什么，反之亦然。

# asp.net - 在特定页面而不是整个网站上应用 https

> ID：15228869
> 
> 赞同：0
> 
> 时间：2013-03-05T16:20:33.473
> 
> 标签：asp.net, iis-7

我已经通过 IIS 在我的本地网站中应用了 http 和 https。当我通过 https 加载我的第一页时。在按钮上单击我调用javascript函数导航到另一个页面，即

```
function redirect() {
            window.location("Page2.aspx");
        } 
```

协议保持不变。为什么呢？以及如何在我网站的特定页面上应用 https？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T16:24:52.797

试过这个，

```
window.location.href = "https:" + window.location.href.substring(window.location.protocol.length); 
```

我在这里找到它：[https ://stackoverflow.com/a/4723302/1172872](https://stackoverflow.com/a/4723302/1172872)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T16:31:01.677

如果您想完全使用 HTTPS 并强制所有用户使用 HTTPS，您可以使用 Microsoft 的 URL Rewrite 扩展程序，用于 IIS。你可以在这里找到它[http://www.iis.net/downloads/microsoft/url-rewrite](http://www.iis.net/downloads/microsoft/url-rewrite)

使用 URL 重写，它可以像设置规则一样简单，以便所有用户都被重定向到 HTTPS，而不管他们尝试导航到什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T16:31:12.287

试试这个正则表达式。

```
url = url.replace(/^http:\/\//i, 'https://'); 
```

# javascript - 在自定义 dojo amd 模块中的 xhr 请求后调用同级方法

> ID：15228875
> 
> 赞同：1
> 
> 时间：2013-03-05T16:20:52.927
> 
> 标签：javascript, dojo, amd

我有一个用于 dojo 的 amd 的自定义模块，如下所示：

```
define(
  "my/moduleName",
  [//dependencies], 
  function(xhr) {
    return {
      method1: function() {
        xhr.get({
          url: "myurl",
          load: function(data) {
            //handle data
            this.method2(data) //< THIS CAUSES ERROR: 'this.method2 is not a function'
          }
        });
      },

      method2: function(data) {
        //process data
      }
    }
} 
```

我怀疑我的问题是`xhr.get`创建了一个延迟对象，并且`method2`没有在该对象中定义，而是在“我的/模块”对象上定义。

完成后如何`method1`拨打电话？`method2``xhr`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T16:29:16.470

您需要存储当前`this`上下文，因为一旦您在`load`函数上下文`this`中就是 xhr 对象。

`var that = this;`然后`that`根据需要在任何其他闭包内使用通用约定。

在调用之前存储`this`类似于这样：

```
define(
    "my/moduleName", [ //dependencies], 
function (xhr) {
    return {
        method1: function () {
            var that = this; //<-- store this context

            xhr.get({
                url: "myurl",
                load: function (data) {
                    //handle data
                    that.method2(data); //<-- use that , the stored context
                }
            });
        },

        method2: function (data) {
            //process data
        }
    }
} 
```

* * *

[**演示**](http://jsfiddle.net/Mn4Q8/)- 存储`this`以备后用在另一个封闭

* * *

# xml - VFP 中的 XMLTOCURSOR 错误

> ID：15228876
> 
> 赞同：0
> 
> 时间：2013-03-05T16:20:55.007
> 
> 标签：xml, xml-parsing, visual-foxpro

我尝试在 VFP 9.2 中使用 XMLTOCURSOR()。有一个错误'xml 解析错误 xml 文档必须有一个顶级元素。第 0 行，位置 0（空）'

如果我使用 ?XMLTOCURSOR('your.XML', 'test', 512)，它会返回一行

这是我的文件，your.xml：

```
<?xml version="1.0" encoding="ISO-8859-1" standalone="no" ?>  <Donnees>
    <DonneesAsset>
        <Asset>RPF 052_V3</Asset>
        <Date Jour='8' Mois='4' Annee='2009' Heures='10' Minutes='11' Secondes='50'/>
        <Mesure>
            <Capteur>Report</Capteur>
            <Enrichie>Scheduled</Enrichie>
        </Mesure>
        <Mesure>
            <Capteur>Customer Proximity</Capteur>
            <Enrichie>At 22,1 km South East from EBTS Hasselt</Enrichie>
            <Unite>km</Unite>
        </Mesure>
        <Mesure>
            <Capteur>Proximity Eurocities</Capteur>
            <Enrichie>At 17,4 km North West from Liege -- Belgium --</Enrichie>
            <Unite>km</Unite>
        </Mesure>
        <Mesure>
            <Capteur>Customer Zone</Capteur>
            <Enrichie>Maasmechelen Zone - St Truiden Zone - V3 Kiewit Zone</Enrichie>
        </Mesure>
        <Mesure>
            <Capteur>Speed avg</Capteur>
            <Enrichie>42,1</Enrichie>
            <Unite>km/h</Unite>
        </Mesure>
        <Mesure>
            <Capteur>Movement GPS</Capteur>
            <Enrichie>Driving</Enrichie>
        </Mesure>
        <Mesure>
            <Capteur>City</Capteur>
            <Enrichie>Tongeren</Enrichie>
        </Mesure>
        <Mesure>
            <Capteur>Code</Capteur>
            <Enrichie>3700</Enrichie>
        </Mesure>
        <Mesure>
            <Capteur>Country</Capteur>
            <Enrichie>Belgium</Enrichie>
        </Mesure>
        <Mesure>
            <Capteur>Position GPS</Capteur>
            <Enrichie>50.76619N 5.4713593E</Enrichie>
        </Mesure>
        <Mesure>
            <Capteur>Speed</Capteur>
            <Enrichie>40</Enrichie>
            <Unite>km/h</Unite>
        </Mesure>
        <Mesure>
            <Capteur>Heading</Capteur>
            <Enrichie>NE</Enrichie>
        </Mesure>
        <Mesure>
            <Capteur>Distance</Capteur>
            <Enrichie>13</Enrichie>
            <Unite>km</Unite>
        </Mesure>
        <Mesure>
            <Capteur>Distance timer</Capteur>
            <Enrichie>17</Enrichie>
            <Unite>min</Unite>
        </Mesure>
        <Mesure>
            <Capteur>Door</Capteur>
            <Enrichie>CLOSED</Enrichie>
        </Mesure>
        <Mesure>
            <Capteur>Ignition</Capteur>
            <Enrichie>ON</Enrichie>
        </Mesure>
        <Mesure>
            <Capteur>Compressor</Capteur>
            <Enrichie>OFF</Enrichie>
        </Mesure>
        <Mesure>
            <Capteur>PWR Supply</Capteur>
            <Enrichie>EXTERNAL</Enrichie>
        </Mesure>
    </DonneesAsset>
</Donnees> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T21:58:03.270

那是因为顶层内只有一个元素。也就是说，您拥有作为 Donnees 的顶级级别，并且在其中，有一个 DonneesAsset 记录。

尝试改用 XMLAdapter 类。它有更多的灵活性。

# css - Css类在同一样式中定义多种字体

> ID：15228878
> 
> 赞同：1
> 
> 时间：2013-03-05T16:20:56.887
> 
> 标签：css, fonts, stylesheet

在我的 css 类中，我看到定义了这种样式：

```
.x-window-dlg .ext-mb-textarea {
    font:normal 12px tahoma,arial,helvetica,sans-serif;
} 
```

现在 tahoma、arial 和 helvetica 都是不同的字体。那么当我选择这种风格时，会应用哪一种呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T16:22:18.153

在某些浏览器中，某些字体不受支持。

如果不支持 tahoma，则应用 arial，

如果不支持 arial，则适用 helvetica....

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T16:22:21.397

字体是按出现的顺序选择的。

因此，在您的情况下，Tahoma 将显示访问者操作系统中是否存在，然后是 Arial，然后是 Helvetica 等等

有时您想为不同的访问者平台提供不同的相似字体。

有关哪些是要使用的核心字体的更多信息，请参阅此链接[http://en.wikipedia.org/wiki/Core_fonts_for_the_Web](http://en.wikipedia.org/wiki/Core_fonts_for_the_Web)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T16:24:25.733

如果您列出多个字体系列，则将选择第一个。其他的是备用，以防第一个加载失败。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-05T16:55:49.070

[字体选择是根据规范](http://www.w3.org/TR/CSS21/fonts.html#algorithm)逐个字符进行的，尽管浏览器可能对此有困难。所以对于内容中的任何一个字符，浏览器都会检查 Tahoma 是否包含它，如果没有，它会检查 Arial 等。当然，如果用户的计算机中缺少某些字体，则在此过程中会跳过它。

# ajax - 返回 XML 时的 JSONP 数据类型

> ID：15228882
> 
> 赞同：0
> 
> 时间：2013-03-05T16:21:03.287
> 
> 标签：ajax, jsonp

我正在玩 JSONP。我理解（也许）这个概念，但在实施上有点倒退。

我拥有的是一个 Web 服务器，它从 URL 字符串生成 XML 结果。正如我所研究的，JSONP 应该可以解决跨域问题，但预期的返回数据仍然是 JSON 数组。因此，如果服务器返回 XML，我如何让我的 ajax 脚本识别并解析它？

这是我的代码：

```
var usdaurl = 'http://eligibility.sc.egov.usda.gov/eligibility/eligibilityservice?eligibilityType=Property&requestString=<?xml version="1.0"?><Eligibility xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="/var/lib/tomcat5/webapps/eligibility/Eligibilitywsdl.xsd"><PropertyRequest StreetAddress1="'+street+'" StreetAddress2="" StreetAddress3="" City="'+city+'" State="'+state+'" County="" Zip="'+zip+'" Program="RBS"></PropertyRequest></Eligibility>';
var clbk = function(xml){
          var usda = $('Property').attr('Eligibility');
       };

$.ajax({
    url: usdaurl,
    dataType: 'jsonp',
    jsonpCallback: 'clbk'
}); 
```

此外，我得到的错误是 XML 响应中无法识别的字符。

```
Uncaught SyntaxError: Unexpected token < 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T16:29:45.357

`jsonp` has to be supported by the service you are requesting from, otherwise [SOP](https://developer.mozilla.org/en-US/docs/JavaScript/Same_origin_policy_for_JavaScript) would be totally useless. There is this misconception that if you want to make a cross origin request you just use jsonp. `jsonp`(also [CORS](https://developer.mozilla.org/en-US/docs/HTTP/Access_control_CORS)) is a method for providers to allow users to get their content without the SOP restriction, its not a way for anyone to just by pass Same origin policy.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T03:32:54.567

您可以设置一个代理来对 xml/html/soap/whatever 进行字符串化并将其包装在回调中。

这是一个使用 cgi shell 脚本的示例（我总是使用 gzip 压缩输出，因为 99.9% 的支持 javascript 的浏览器也支持 gzip）

```
#!/bin/sh
CB=${QUERY_STRING%%&*}
URL=${QUERY_STRING#*&}
case "$CB" in
    callback=*)
        printf "Content-Encoding: gzip\nContent-type: application/javascript\r\n\r\n"
        while ([ ! "$ONCE" ])   do
            printf "${CB##*=}(\""
            wget --no-check-certificate -U "NetSurf/2.9 (Linux; i686)" -T 20 -O - "$URL" \
                | tr -c [\ -~] " " |sed 's/[\]/\\\\/g;s/["]/\\"/g'
            printf "\")"
            ONCE=1
        done | gzip -9fc
    ;;
    *)exit;;
esac 
```

这是一个示例用法，假设您的服务器位于 localhost 并且脚本位于 /cgi-bin/xml2jsonpgz.cgi（busybox 的 httpd 的典型位置） 它使用回调中返回的字符串将整个 uri 楔入一个`<div>`标签，但是您那么它可以在 DOM 上做你想做的事。

```
<html><head><title>test</title></head><body><div id="notaniframe"></div>
<script>
    function dummy(data){alert(data);document.getElementById("notaniframe").innerHTML=data}
    Loaded=0
    setTimeout(function(){if(!Loaded)alert("load failed")},30000);
</script>
<script onload='Loaded=1;alert("loaded")' src="http://localhost/cgi-bin/xml2jsonpgz.cgi?callback=dummy&http://stackoverflow.com"></script>
</body></html> 
```

基本用法是：设置 src=urlOfCgiScript+"?callback="+callBackName+"&"+url 并设置回调来处理字符串。

您可以对 json 数据做同样的事情，但转义的复杂性较低。

# emacs - 在 emacs 中可以快速（重复）撤消吗？

> ID：15228883
> 
> 赞同：22
> 
> 时间：2013-03-05T16:21:06.180
> 
> 标签：emacs, editor, undo

我使用 emacs，但我对它的撤消有疑问。

（对不起，也许这是一个愚蠢的问题，但我在互联网上没有找到任何关于它的信息，而它应该是任何编辑器的基本功能）。

要调用每个撤消步骤，我需要按“Ctrl-x”，然后按“u”。但是如果我已经完成了 200 步并且我想撤消它们，我的手和手指会因为重复 'Ctrl-x' 然后 'u' 200 次而感到可怕的疼痛，更不用说这个操作大约需要 5 分钟。

例如，在 Microsoft Word 中（以及许多其他编辑器中）撤消是 Ctlr-Z，但您可以按住 Ctlr-Z 并且多个撤消步骤运行得很快。这在emacs中可以实现吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-03-05T16:24:05.590

按住`Alt`，键入`2` `0` `0`，然后按`CTRL+x` `u`。

这为您接下来要执行的操作（例如撤消）提供了 200 的参数，因此它会应用该操作 200 次。

顺便说一句，`CTRL+/`如果您想使用更少的击键，也映射到“撤消”。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-03-05T16:24:41.180

`ctrl`+`/`与 MS Word 功能基本相同。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-05T16:29:38.237

Finally I found additional way of doing so: C-x u C-x z z z z z

But ctrl / is easier.

Many thanks to brbcoding

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-10-31T09:56:23.507

撤消树是一种在最近更改的历史中导航的模式。我认为最好使用此模式进行深度撤消

# android - 在 BlackBerry PlayBook 2.1 上移植 Android APK（带 GPS_Provider）

> ID：15228884
> 
> 赞同：0
> 
> 时间：2013-03-05T16:21:06.923
> 
> 标签：android, blackberry-playbook, blackberry-android

我们正在尝试将 Android APK 移植到 BlackBerry Playbook 2.1。为此，我们遵循[http://developer.blackberry.com/android/documentation/gettingstarted.html](http://developer.blackberry.com/android/documentation/gettingstarted.html)中给出的步骤。

我们开发了一个示例应用程序，它以`TextView`. 该应用程序在 Android 设备上运行良好。然后我们将其转换为 BAR 文件。我们还检查了兼容性列表，发现只有一个徽标大小问题不是主要问题。但是，应用程序在 BlackBerry 上崩溃。

我们正在使用`LocationManager.GPS_PROVIDER`和`LocationManager.NETWORK_PROVIDER`。两者都可用，因为以下条件在 BlackBerry 设备上返回 true：

```
if (GetLocation.mGPSLocationManager.isProviderEnabled(LocationManager.GPS_PROVIDER)) {
    //this line of code write log into a file
    Log.debug(this.getClass() + " :: Caller :: " + caller,"Found GPS Provider");
    GetLocation.mGPSLocationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 10000, 10,GetLocation.mGPSLocationListener);
} 
```

以下代码似乎存在问题：

```
private class GPSLocationListener implements LocationListener {

    public void onLocationChanged(Location location) {
        ....
        ....
    }
} 
```

请让我们知道您的意见。

# sql-server - AppFabric 缓存和 SQL 依赖关系

> ID：15228888
> 
> 赞同：1
> 
> 时间：2013-03-05T16:21:15.490
> 
> 标签：sql-server, appfabric, microsoft-sync-framework, appfabric-cache

我正在考虑为我的应用程序使用 AppFabric 缓存，但不清楚如何让它做我想做的事。我在 1 个位置有 1 个 SQL 集群。我在全球拥有 200 多台应用服务器。我想在每个位置放置一个 AppFabric 缓存集群，以便应用程序服务器可以快速访问 SQL 对象。除了快速访问之外，我还需要他们在无法访问 SQL 集群的情况下访问数据。

有一个 HR 应用程序可以直接更新 SQL 集群，以便数据发生变化。应用程序服务器还将更新许多位置的 AppFabric 缓存。所有这些数据都需要保持同步。以下是我的问题：

1.  当数据库发生变化时，缓存将如何更新？我读到 SQLDependency 是我需要的，但我也读到一旦发生更改，我的整个缓存将被刷新并且必须重新同步。我只想将更改的对象发送到多个缓存进行更新。

2.  如果 SQL 集群不可访问并且缓存找不到正在请求的对象，会发生什么情况？

3.  有没有更好的方法来做我想做的事情？这更多的是关于 SQL 对象的可用性，而不是关于性能。正在研究 MS Sync 框架...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T15:48:43.043

AppFabric 不支持像 SqlCacheDependency 这样的缓存依赖对象，但您可以做的是为 AppFabric 创建一个读取/写入缓存提供程序。此提供程序知道您的 SQL Server 数据库的结构，因此它可以从数据库中检索信息，*并且*可以在您进行更新时更新您的数据库。*您的应用程序服务器会更新 AppFabric 缓存，因此您的缓存始终包含最新版本的数据，然后缓存会将更新异步*写入数据库。

为了应对 HR 应用程序更新后端数据库，您可以将缓存中的项目配置为根据生存时间值过期，随后对缓存的请求将刷新缓存的版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-28T06:28:12.110

我知道您之前发布过这个，但是有一些缓存解决方案可以让您利用缓存依赖项与主要数据源同步。在您的情况下，SQL 依赖的例子可用于 NCache。使用 NCache，您可以有多个选项与数据库同步，并且一旦此类选项为“通读”。所以本质上，当数据库发生变化时，依赖的对象会自动从缓存中删除，如果启用了读取，那么缓存服务器会自动检索对象的新副本。您可以在此处阅读有关[数据库同步的更多信息](http://www.alachisoft.com/ncache/database-synchronization.html)

# android - Android NEXT_ALARM_FORMATTED 字符串到毫秒

> ID：15228889
> 
> 赞同：1
> 
> 时间：2013-03-05T16:21:15.580
> 
> 标签：android, date, alarm, milliseconds

现在我可以在字符串值中获取下一个警报。我想在几毫秒内得到它。这是我尝试过的，但它不起作用。我也使用 Locale.US，但希望它适用于任何语言环境。请指教

```
String nextAlarm = android.provider.Settings.System.getString(getContentResolver(), android.provider.Settings.System.NEXT_ALARM_FORMATTED);

    DateFormat format = new SimpleDateFormat("EEE hh:mm aa", Locale.US);
    long nextAlarmTime = 0;
    try {
        Date date = format.parse(nextAlarm);
        nextAlarmTime = date.getTime();
    } catch (Exception e) {
    }

    long curTime = System.currentTimeMillis();
    long diff = nextAlarmTime - curTime;

    //diff would represent the time in milliseconds 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-02-01T23:46:08.793

在具有 API 21 及更高版本的设备上，您可以通过以下方式实现毫秒数`getSystemService()`：

```
if (android.os.Build.VERSION.SDK_INT >= android.os.Build.VERSION_CODES.LOLLIPOP) {
    AlarmManager.AlarmClockInfo info = 
        ((AlarmManager)getSystemService(Context.ALARM_SERVICE)).getNextAlarmClock();
    if (info != null) {
        long alarmTime = info.getTriggerTime();
        SimpleDateFormat simpleDateFormat = 
            new SimpleDateFormat("yyyy-MM-dd hh:mm a", Locale.US);
        Log.d(getClass().getSimpleName(),
            simpleDateFormat.format(new Date(alarmTime)));
    }
} 
```

在旧设备上，您必须在数据库中查找警报字符串：

```
String nextAlarm = Settings.System.getString(getContentResolver(),
                       Settings.System.NEXT_ALARM_FORMATTED); 
```

检索到的字符串的格式取决于运行设备的区域设置。字符串由

*   时间的数字（阿拉伯，印度，...？）

*   字符串来自

    ```
    String[] weekdays = DateFormatSymbols.getInstance().getShortWeekdays(); 
    ```

*   字符串来自

    ```
    String[] amPm = DateFormatSymbols.getInstance().getAmPmStrings(); 
    ```

您不能依赖 weekday-time-AmPm-components 的顺序。例如，AmPm-String 并不总是放在最后。在韩国，它通常放在工作日和时间之间。

* * *

我的解决方案：

**报警时间工具.java**：

```
import java.util.Calendar;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

public class AlarmTimeTool {

    public static long getNextAlarm(String alarm, String[] weekdays, String[] amPm) {
        int alarmHours = -1, alarmMinutes = -1;
        int alarmWeekday = -1; // Calendar.SUNDAY = 1; Calendar.SATURDAY = 7;
        int alarmAmPm = -1; // Calendar.AM = 0; Calendar.PM = 1;

        for (String piece: alarm.split("\\s")) {
            if (alarmWeekday == -1) {
                alarmWeekday = getWeekday(piece, weekdays);
                if (alarmWeekday != -1) {
                    continue;
                }
            }
            if (alarmHours == -1) {
                int[] hoursMinutes = getTime(piece);
                alarmHours = hoursMinutes[0];
                alarmMinutes = hoursMinutes[1];
                if (alarmHours != -1) {
                    continue;
                }
            }
            if (alarmAmPm == -1) {
                alarmAmPm = getAmPm(piece, amPm);
            }
        }

        if (alarmWeekday == -1 || alarmHours == -1) {
            throw new RuntimeException("could not fetch alarm week or hour");
        }

        Calendar now = Calendar.getInstance();
        Calendar nextAlarm = Calendar.getInstance();
        nextAlarm.set(Calendar.DAY_OF_WEEK, alarmWeekday);
        nextAlarm.set(Calendar.MINUTE, alarmMinutes);
        nextAlarm.set(Calendar.SECOND, 0);
        nextAlarm.set(Calendar.MILLISECOND, 0);
        if (alarmAmPm == -1) {
            nextAlarm.set(Calendar.HOUR_OF_DAY, alarmHours);
        } else {
            nextAlarm.set(Calendar.AM_PM, alarmAmPm);
            nextAlarm.set(Calendar.HOUR, alarmHours % 12);
        }
        if (nextAlarm.before(now)) {
            nextAlarm.add(Calendar.DAY_OF_MONTH, 7);
        }

        return nextAlarm.getTimeInMillis();
    }

    private static int[] getTime(String piece) {
        int hours = -1;
        int minutes = -1;

        // Android only (\d has different meanings):
        Pattern p = Pattern.compile("(\\d{1,2})\\D(\\d{2})");

        Matcher m = p.matcher(piece);
        if (m.find()) {
            hours = Integer.parseInt(m.group(1));
            minutes = Integer.parseInt(m.group(2));
        }
        int[] hoursMinutes = {hours, minutes};
        return hoursMinutes;
    }

    private static int getWeekday(String piece, String[] weekdays) {
        for (int i = 1; i < weekdays.length; i++) {
            if (piece.contains(weekdays[i])) {
                return i;
            }
        }
        return -1;
    }

    private static int getAmPm(String piece, String[] amPm) {
        for (int i = 0; i < amPm.length; i++) {
            if (piece.contains(amPm[i])) {
                return i;
            }
        }
        return -1;
    }
} 
```

**MainActivity.java**：

```
import android.app.Activity;
import android.os.Bundle;
import android.provider.Settings;
import android.util.Log;

import java.text.DateFormatSymbols;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.Locale;

public class MainActivity extends Activity {
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        String nextAlarm = Settings.System.getString(getContentResolver(),
                Settings.System.NEXT_ALARM_FORMATTED);
        if (nextAlarm != null && !nextAlarm.isEmpty()) {
            Log.d(getClass().getSimpleName(), nextAlarm);
            String[] weekdays = DateFormatSymbols.getInstance().getShortWeekdays();
            String[] amPm = DateFormatSymbols.getInstance().getAmPmStrings();
            long alarmTime = AlarmTimeTool.getNextAlarm(nextAlarm, weekdays, amPm);
            SimpleDateFormat simpleDateFormat =
                    new SimpleDateFormat("yyyy-MM-dd hh:mm a", Locale.US);
            Log.d(getClass().getSimpleName(), simpleDateFormat.format(new Date(alarmTime)));
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-06-06T22:20:42.693

Date 的代码不是毫秒 ;-) 但接下来调用 getTime() ，您将以毫秒为单位获得时间。

我在我的小应用程序中使用这个代码来计算我应该睡觉的时间，基于下一个闹钟的时间。它是通过 2 小时尝试不同的方法创建的，因此可以肯定它可能会被优化。

```
 public static Date getNextAlarm(Context context) {
    // let's collect short names of days :-)        
    DateFormatSymbols symbols = new DateFormatSymbols();
    // and fill with those names map...
    Map<String, Integer> map = new HashMap<String, Integer>();
    String[] dayNames = symbols.getShortWeekdays();
    // filing :-)
    map.put(dayNames[Calendar.MONDAY],Calendar.TUESDAY);
    map.put(dayNames[Calendar.TUESDAY],Calendar.WEDNESDAY);
    map.put(dayNames[Calendar.WEDNESDAY],Calendar.THURSDAY);
    map.put(dayNames[Calendar.THURSDAY],Calendar.FRIDAY);
    map.put(dayNames[Calendar.FRIDAY],Calendar.SATURDAY);
    map.put(dayNames[Calendar.SATURDAY],Calendar.SUNDAY);
    map.put(dayNames[Calendar.SUNDAY],Calendar.MONDAY);
    // Yeah, knowing next alarm will help.....
    String nextAlarm = Settings.System.getString(context.getContentResolver(),Settings.System.NEXT_ALARM_FORMATTED);
    // In case if it isn't set.....
    if ((nextAlarm==null) || ("".equals(nextAlarm))) return null;
    // let's see a day....
    String nextAlarmDay = nextAlarm.split(" ")[0];
    // and its number....
    int alarmDay = map.get(nextAlarmDay);

    // the same for day of week (I'm not sure why I didn't use Calendar.get(Calendar.DAY_OF_WEEK) here...
    Date now = new Date();      
    String dayOfWeek = new SimpleDateFormat("EE", Locale.getDefault()).format(now);     
    int today = map.get(dayOfWeek);

    // OK, so let's calculate how many days we have to next alarm :-)
    int daysToAlarm = alarmDay-today;
    // yep, sometimes it will  be negtive number so add 7.
    if (daysToAlarm<0) daysToAlarm+=7;

    // Now we will build date, and parse it.....
    try {
        Calendar cal2 = Calendar.getInstance();
        String str = cal2.get(Calendar.YEAR)+"-"+(cal2.get(Calendar.MONTH)+1)+"-"+(cal2.get(Calendar.DAY_OF_MONTH));

        SimpleDateFormat df  = new SimpleDateFormat("yyyy-MM-d hh:mm");

        cal2.setTime(df.parse(str+nextAlarm.substring(nextAlarm.indexOf(" "))));
        cal2.add(Calendar.DAY_OF_YEAR, daysToAlarm);
        // and return it
        return cal2.getTime();
    } catch (Exception e) {

    }
    // in case if we cannot calculate...
    return null;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-01T13:26:42.460

Looking at [Alarms.java in alarm clock app](https://android.googlesource.com/platform/packages/apps/AlarmClock/+/master/src/com/android/alarmclock/Alarms.java), which is responsible for setting this variable, the correct format is either "E h:mm aa" or "E k:mm" depending on 12/24 hour mode. I parse it using SimpleDateFormat and copy the valid fields using Calendar over to current date:

```
String format = android.text.format.DateFormat.is24HourFormat(context) ? "E k:mm" : "E h:mm aa";
Calendar nextAlarmCal = Calendar.getInstance();
Calendar nextAlarmIncomplete = Calendar.getInstance();
nextAlarmIncomplete.setTime(new SimpleDateFormat(format).parse(nextAlarm));

// replace valid fields of the current time with what we got in nextAlarm
int[] fieldsToCopy = {Calendar.HOUR_OF_DAY,Calendar.MINUTE,Calendar.DAY_OF_WEEK};
for (int field : fieldsToCopy) {
   nextAlarmCal.set(field, nextAlarmIncomplete.get(field));
}
nextAlarmCal.set(Calendar.SECOND, 0);

// if the alarm is next week we have wrong date now (in the past). Adding 7 days should fix this 
if (nextAlarmCal.before(Calendar.getInstance())) {
   nextAlarmCal.add(Calendar.DATE, 7);
} 
```

# c++ - Boost线程不会正确增加值

> ID：15228893
> 
> 赞同：0
> 
> 时间：2013-03-05T16:21:25.137
> 
> 标签：c++, multithreading, boost-thread

所以，我有这段代码似乎不起作用：（下面有更多详细信息）

```
#include <boost/thread.hpp>
#include <boost/bind.hpp>
#include <Windows.h>

using namespace std;

boost::mutex m1,m2;

void * incr1(int thr, int& count) {
    for (;;) {
    m1.lock();
    ++count;
    cout << "Thread " << thr << " increased COUNT to: " << count << endl;

    m1.unlock();
    //Sleep(100);

        if (count == 10) {
        break;
        }
    }
    return NULL;
}

int main() {    
    int count = 0;

    boost::thread th1(boost::bind(incr1,1,count));
    boost::thread th2(boost::bind(incr1,2,count));

    th1.join();
    th2.join();

    system("pause");
    return 0;
} 
```

基本上，它有一个接受两个参数的函数：一个数字（以区分哪个线程调用它）和一个通过引用传递的整数变量“count”。这个想法是每个线程都应该在运行时增加 count 的值。但是，结果是它增加了自己的 count 版本，因此结果是：

```
Thread 1 increased count to 1
Thread 2 increased count to 1
Thread 1 increased count to 2
Thread 2 increased count to 2
Thread 1 increased count to 3
Thread 2 increased count to 3 
```

而不是每个线程将计数增加到下一个数字：

```
Thread 1 increased count to 1
Thread 2 increased count to 2
Thread 1 increased count to 3
Thread 2 increased count to 4
Thread 1 increased count to 5
Thread 2 increased count to 6 
```

如果我通过简单地调用此函数两次来运行此代码，它会按预期工作。如果我使用线程，它不会。

完整的初学者在这里。关于我为什么愚蠢的任何见解？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T16:24:18.403

它`boost::bind`不能将 int 解析为引用。您需要使用参考包装器：

```
boost::bind( incr1, 1, boost::ref(count) ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T16:23:53.720

因为你需要使用`boost::ref`通过引用传递一些东西`boost::bind`。

```
boost::thread th1(boost::bind(incr1,1,boost::ref(count))); 
```

# c++ - 在一组 shared_ptr 中搜索

> ID：15228895
> 
> 赞同：3
> 
> 时间：2013-03-05T16:21:29.093
> 
> 标签：c++, boost, shared-ptr, boost-multi-index, multi-index

我有一个对象：

```
class Object {
public:
  boost::shared_ptr<QString> const& name() const {reutrn _name;}
private:
  boost::shared_ptr<QString> _name;
}; 
```

还有一个 multi_index 集

```
typedef
    boost::multi_index_container<
        Object,
        boost::multi_index::indexed_by<
            boost::multi_index::ordered_unique<
                boost::multi_index::const_mem_fun<
                    Object,
                    boost::shared_ptr<QString> const&,
                    & Object::name>,
                StringPointerLess> > >
    ObjectSet; 
```

现在，如果我想在集合中找到一些东西，`QString` 我需要复制它以在堆中分配并创建`shared_ptr`。

是否可以避免这种不必要的复制操作，保持原样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T07:00:44.547

一种更简单的方法：将以下成员函数添加到`StringPointerLess`比较谓词中：

```
struct StringPointerLess{
  ...
  bool operator()(boost::shared_ptr<QString> const& x,const QString& y)const{
    return *x<y;
  }
  bool operator()(const QString& x,boost::shared_ptr<QString> const& y)const{
    return x<*y;
  }
  ...
}; 
```

现在您可以通过简单地提供所需的内容进行查找`QString`：

```
IteratorType find( MyContainerType const& container, QString const& key )
{
   return container.find( key );
} 
```

Boost.MultiIndex 文档中的[特殊查找操作部分](http://www.boost.org/libs/multi_index/doc/tutorial/basics.html#special_lookup)解释了这背后的魔力。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T16:28:54.020

是的，您仍然需要创建一个 shared_ptr 但您可以使用一个不会删除您的对象的自定义删除器，然后将其作为堆栈中的指针传递。

当然，您的问题之一是您`shared_pointer`的不是`const`，所以如果您有一个`const QString &`，您要么必须复制它，要么`const_cast`. 我会做后者，但由你决定怎么做。

我们不想在传入 QString 的任何地方都这样做，所以让我们编写一个函数：

```
struct no_op_functor
{
 public:
   template< typename T > operator()( T* ) const
   {
   }
};

IteratorType find( MyContainerType const& container, QString const& key )
{
   boost::shared_ptr< QString > keyShared( const_cast<QString *>(&key), no_op_functor() );
   return container.find( keyShared );
} 
```

# .net-4.0 - SQL Server 开源查询分析器

> ID：15228896
> 
> 赞同：0
> 
> 时间：2013-03-05T16:21:30.100
> 
> 标签：.net-4.0, open-source, sql-server-2008-r2, query-analyzer

我的团队将为我们部门的各个团队开发一些内部工具，并且我希望支持许多特定于数据库的任务（SQL Server 2008 R2/SQL Server 2012）。

我不想花大量时间复制现有的 UI 功能，只想添加一些有用的功能。最初我们正在考虑为 SSMS 编写一些插件，但事实证明它没有很好的文档记录。

我突然想到，我们可以从一些开源查询分析器类型的项目开始。我在 CodeProject 上找到了 QASharp，但我想知道是否有更新的东西。我们有 2008 R2 并且很快也会使用 2012，所以我想从最近的东西开始。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T17:43:17.730

经过大量搜索后，我发现在**Query ExPlus**中寻找的东西看起来是一个可行的候选者。

[http://sourceforge.net/projects/queryexplus/?source=dlp](http://sourceforge.net/projects/queryexplus/?source=dlp)

# node.js - Express.js - 过滤 URL 中的数字和字符串

> ID：15228901
> 
> 赞同：4
> 
> 时间：2013-03-05T16:21:36.657
> 
> 标签：node.js, filter, express

我想知道是否可以在查询本身中检查 Express.js URL 查询的特定格式（正则表达式）（无需输入回调。）

具体来说，我想执行不同的操作，具体取决于查询 URL 是字符串还是数字（如用户 ID 和用户名）：

```
app.get('/:int', function(req, res){
    // Get user info based on the user id.
}

app.get('/:string', function(req, res){
    // Get user info based on the user name.
} 
```

我可以在 的第一个参数中过滤数字吗`app.get`，或者除了在回调中进行测试之外是不可能的：

```
/(\d)+/.test(req.params.int)
/(\w)+/.test(req.params.string) 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-03-05T16:55:03.527

您可以使用括号为命名参数指定模式：

```
app.get('/:int(\\d+)', function(req, res){
    // Get user info based on the user id.
}

app.get('/:string(\\w+)', function(req, res){
    // Get user info based on the user name.
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-05T16:49:03.003

express 路由器也接受正则表达式作为第一个参数。

```
app.get(/(\d+)/, function(req, res, next) {})
app.get(/(\w+)/, function(req, res, next) {}) 
```

# android - Android - 无法让布局使用 75% 的屏幕

> ID：15228904
> 
> 赞同：0
> 
> 时间：2013-03-05T16:21:40.027
> 
> 标签：android, layout, android-linearlayout

现在我有我的应用程序的主屏幕，屏幕的顶部 50% 使用按钮/内容，底部 50% 只显示徽标。但是我似乎无法更改它，以便徽标仅占据屏幕底部的 25%。

我在顶部使用了 3 的 layout_weight，在底部使用了 1，但是这导致底部徽标现在占据了屏幕区域的 95%，并且主区域中的所有内容不再可见。对外部容器使用 weightSum 并没有奏效，也没有尝试将 layout_width/height 更改为 fill_parent 或 wrap_content 组合。

我已经使用 layout_weight 阅读了其他帮助线程并阅读了文档，这一切看起来都非常简单，并且在内容区域中使用它们没有问题，我不确定为什么这给我带来了麻烦，有人可以帮我吗？

这是我的代码：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:orientation="vertical"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:gravity="center_vertical"
android:textColor="#000000"
android:background="#faff67"
>
 <LinearLayout
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:gravity="center"
    android:background="@drawable/backing"
    android:paddingTop="5dp"
    android:paddingRight="3dp"
    android:paddingLeft="3dp"
    android:paddingBottom="3dp"
    android:layout_margin="3dp"
android:layout_weight="3"
    >

    <!-- Main content area stuff -->

 </LinearLayout>
<LinearLayout
android:id="@+id/main"
android:layout_width="wrap_content" 
android:layout_height="wrap_content"
android:paddingTop="0dp"
android:layout_weight="1"
   >
<ImageView  android:scaleType="fitCenter"
            android:contentDescription="Logo"
            android:src="@drawable/logo"
            android:id="@+id/front_logo"
            android:padding="1sp"
            android:layout_height="fill_parent"
            android:layout_width="fill_parent"></ImageView>
</LinearLayout>
</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T16:26:22.753

使用时`android:layout_weight`，应设置`android:layout_height="0dp"`加权分量。否则，在某些情况下，布局高度将胜过权重。

当然，这是垂直布局。对于水平，使用`android:layout_width="0dp"`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T16:27:36.973

您错误地使用了**weight**属性。每当您设置权重参数时，您应该将相应的宽度或高度设置为 0dp。因此，更改将权重分配给**0dp 的布局的高度。**

```
android:layout_height="0dp" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T16:30:11.180

用这个

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:background="#faff67"
android:orientation="vertical"
android:textColor="#000000" >

<LinearLayout
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:layout_weight="1"
    android:background="#123123"
    android:gravity="center"
    android:orientation="vertical" >
</LinearLayout>

<LinearLayout
    android:id="@+id/main"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:layout_weight="3" >

    <ImageView
        android:id="@+id/front_logo"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:contentDescription="Logo"
        android:padding="1sp"
        android:scaleType="fitCenter"
        android:src="@drawable/logo" >
    </ImageView>
</LinearLayout>

</LinearLayout> 
```

# javascript - 根据内容高度的变化自动调整 iFrame 高度？

> ID：15228912
> 
> 赞同：0
> 
> 时间：2013-03-05T16:22:13.757
> 
> 标签：javascript, jquery, iframe

关于 iframe 和 javascript 的问题在这里。

我一直在尝试让 iframe 自动将其高度调整为内容的高度。

做一次的简单方法是使用：

```
var iframe = document.createElement("iframe");
...
iframe.height = iframe.contentWindow.document.height; 
```

但是，如果内容高度发生变化，例如向页面添加评论，我怎样才能让它自动更改。

有没有我可以观看的事件（我认为没有）？

我想尝试在没有 jQuery 的情况下执行此操作，但如果有必要，我会不情愿地使用它:)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T16:40:59.463

您可以在 iframe 中添加新评论后执行此操作，但前提是 iframe 位于同一域中

```
 $(window.parent.document).find('body iframe').height($('html').height()); 
```

# c# - 如何在 WebPartZone 中加载 highchart 脚本

> ID：15228917
> 
> 赞同：3
> 
> 时间：2013-03-05T16:22:26.673
> 
> 标签：c#, javascript, asp.net, highcharts, web-parts

所以我正在尝试制作一个类似仪表板的页面。为此，我使用了 WebParts 组件。

例如，我正在使用：

```
<asp:WebPartZone ID="WebPartZone2" runat="server">
<ZoneTemplate>
</ZoneTemplate>
</asp:WebPartZone> 
```

在这个 ZoneTemplate 中，我想“加载”我的 highchart（通过脚本）。我的折线图 highchart 的脚本是：

```
 <script>
            $(function () {
    var chart;
    $(document).ready(function() {
        chart = new Highcharts.Chart({
            chart: {
                renderTo: 'lineChartDiv',
                type: 'line'
            },
            title: {
                text: 'Monthly Average Temperature'
            },
            subtitle: {
                text: 'subtitel'
            },
            xAxis: {
                categories: <%=Xaxis %>
            },
            yAxis: {
                title: {
                    text: 'Temperature (°C)'
                }
            },
            tooltip: {
                enabled: false,
                formatter: function() {
                    return '<b>'+ this.series.name +'</b><br/>'+
                        this.x +': '+ this.y +'°C';
                }
            },
            plotOptions: {
                line: {
                    dataLabels: {
                        enabled: true
                    },
                    enableMouseTracking: false
                }
            },
            series: [{
                name: 'Tokyo',
                data: [7.0, 6.9, 9.5, 14.5, 18.4, 21.5, 25.2, 26.5, 23.3, 18.3, 13.9, 9.6]
            }, {
                name: '<%=SeriesYaxis2name %>',
                data: <%=SeriesYaxis2 %>
                //data: [3.9,4.2,5.7,8.5,11.9,15.2,17.0,16.6,14.2,10.3,6.6,4.8]
            }]
        });
    });

});
        </script> 
```

到目前为止，我只在进入页面时设法加载了完整的脚本。我希望它加载到我的“区域模板”中，以便我可以在该框架内显示它并在必要时调整大小等。我该怎么做呢？

也许我对这一切都错了。也许有更好的方法通过“类似小部件”框架（在本例中为 .NET WebParts）中的脚本加载高图。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-23T19:48:31.847

你在用什么.net 框架？，我在框架 2.0 中遇到了同样的问题，我必须创建一个 Web 用户控件，并在那里导入你需要的所有东西，比如 highcharts 和 jquery 框架。

在 3.5 上，您可以动态添加它。

# ruby-on-rails - 启用js时Mod Pagespeed添加noscript

> ID：15228919
> 
> 赞同：1
> 
> 时间：2013-03-05T16:22:29.673
> 
> 标签：ruby-on-rails, mod-pagespeed, turbolinks

我安装了 apache mod pagespeed，一切正常。

我在我的 ruby​​ (1.9.3) 和 rails (3.2) 应用程序上使用它。我最近安装了 gem 'turbolinks'。

现在，我网站上的 URL 在`?ModPagespeed=noscript`斜杠后添加。在我添加 turbolinks 之前，这并没有发生。

为什么页面速度工具会将 ?ModPagespeed=noscript 附加到 URL 的末尾，我该如何防止这种情况发生？

如果关闭一些 mod pagespeed 选项有帮助，那么我也许可以在没有性能损失的情况下做到这一点，例如，缩小 js 是我在预编译中预先部署的事情，同样，Rails 资产管道在结合方面做得很好单独的 .js 和 .css 文件编译成单个文件等。因此，关闭`combine javascript`不会有问题。但是，我不知道这是否是导致它的原因，因为我暗示我相信这与 turbolinks、我的应用程序的 http 请求和 pagespeed 模块的交互有关，只是没有注意到 js 已打开。

我必须承认我觉得奇怪的是，我什至在网上找不到与此类似的查询。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T20:00:02.950

重定向到 ?ModPagespeed=noscript 发生在块中的元标记中。mod_pagepseed 在应用需要 JavaScript 才能运行的过滤器时插入此块。一个示例是lazyload_images，其中标记指向空白图像，而JavaScript 被插入到页面中以指向正确的图像。

*优化*JavaScript 文件不需要这些块；这种优化对禁用 JS 的浏览器无效。

# php - PHP curl > SOAP 获取的数据在获取信息时遇到问题

> ID：15228925
> 
> 赞同：0
> 
> 时间：2013-03-05T16:22:37.377
> 
> 标签：php, soap, curl, xml-parsing

我最近问了一个关于在 PHP 中使用 SOAP 的不同问题，但从那时起我就厌倦了客户端服务器响应永远无法正常工作。相反，我切换到可以指定所有内容的 cURL，现在我得到了正确的响应。

我的问题在于从这些数据中获取信息。在过去的 2 天里，我尝试了教程，其中大部分我都试过了，但是当我将相同的方法应用于我自己的数据时，我得到了空的结果。我>认为<这是因为xml标签在名称中使用空格或类似的东西我不知道。

如果有人可以在这里直接指出我，将不胜感激。就像获得 1 条信息向我展示如何那样简单，我不需要为我完成所有工作。谢谢你。

XML 返回如下：

```
<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema"><soap:Body><FetchStockResponse xmlns="http://www.wics.nl"><FetchStockResult><DS><xs:schema id="rsVoorraad" xmlns="" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:msdata="urn:schemas-microsoft-com:xml-msdata" xmlns:msprop="urn:schemas-microsoft-com:xml-msprop"><xs:element name="rsVoorraad" msdata:IsDataSet="true" msdata:Locale="" msprop:PROGRESS.brejected="False" msprop:PROGRESS.bdata_source_mod="False"><xs:complexType><xs:choice minOccurs="0" maxOccurs="unbounded"><xs:element name="Voorraad" msdata:Locale="" msprop:PROGRESS.brejected="False" msprop:PROGRESS.bdata_source_mod="False" msprop:PROGRESS.errorString="" msprop:PROGRESS.bundo="True" msprop:PROGRESS.bimage_flag="False"><xs:complexType><xs:sequence><xs:element name="ArtikelCode" msprop:PROGRESS.user_order="0" msprop:PROGRESS.position="2" type="xs:string" minOccurs="0" /><xs:element name="ArtikelGroepCode" msprop:PROGRESS.user_order="1" msprop:PROGRESS.position="3" type="xs:string" minOccurs="0" /><xs:element name="Omschrijving" msprop:PROGRESS.user_order="2" msprop:PROGRESS.position="4" type="xs:string" minOccurs="0" /><xs:element name="VariantCode" msprop:PROGRESS.user_order="3" msprop:PROGRESS.position="5" type="xs:string" minOccurs="0" /><xs:element name="Type" msprop:PROGRESS.user_order="4" msprop:PROGRESS.position="6" type="xs:string" minOccurs="0" /><xs:element name="Aantal" msprop:PROGRESS.init_value="0" msprop:PROGRESS.user_order="5" msprop:PROGRESS.position="7" type="xs:decimal" default="0" minOccurs="0" /><xs:element name="OrderVoorraad" msdata:Locale="" msprop:PROGRESS.brejected="False" msprop:PROGRESS.bdata_source_mod="False" msprop:PROGRESS.errorString="" msprop:PROGRESS.bundo="True" msprop:PROGRESS.bimage_flag="False" minOccurs="0" maxOccurs="unbounded"><xs:annotation><xs:appinfo><msdata:Relationship name="relOrder" msdata:parent="Voorraad" msdata:child="OrderVoorraad" msdata:parentkey="Type ArtikelCode" msdata:childkey="Type ArtikelCode" /></xs:appinfo></xs:annotation><xs:complexType><xs:sequence><xs:element name="Type" msprop:PROGRESS.user_order="0" msprop:PROGRESS.position="2" type="xs:string" /><xs:element name="ArtikelCode" msprop:PROGRESS.user_order="1" msprop:PROGRESS.position="3" type="xs:string" /><xs:element name="VariantCode" msprop:PROGRESS.user_order="2" msprop:PROGRESS.position="4" type="xs:string" /><xs:element name="Ordernummer" msprop:PROGRESS.init_value="0" msprop:PROGRESS.user_order="3" msprop:PROGRESS.position="5" type="xs:int" default="0" /><xs:element name="Regelnummer" msprop:PROGRESS.init_value="0" msprop:PROGRESS.user_order="4" msprop:PROGRESS.position="6" type="xs:int" default="0" /><xs:element name="Referentie" msprop:PROGRESS.user_order="5" msprop:PROGRESS.position="7" type="xs:string" minOccurs="0" /><xs:element name="Plaats" msprop:PROGRESS.user_order="6" msprop:PROGRESS.position="8" type="xs:string" minOccurs="0" /><xs:element name="Leverdatum" msprop:PROGRESS.user_order="7" msprop:PROGRESS.position="9" type="xs:dateTime" minOccurs="0" /><xs:element name="Aantal" msprop:PROGRESS.init_value="0" msprop:PROGRESS.user_order="8" msprop:PROGRESS.position="10" type="xs:decimal" default="0" minOccurs="0" /></xs:sequence></xs:complexType></xs:element></xs:sequence></xs:complexType></xs:element></xs:choice></xs:complexType><xs:unique name="idxOrderVoorraad" msdata:PrimaryKey="true"><xs:selector xpath=".//OrderVoorraad" /><xs:field xpath="Type" /><xs:field xpath="ArtikelCode" /><xs:field xpath="VariantCode" /><xs:field xpath="Ordernummer" /><xs:field xpath="Regelnummer" /></xs:unique></xs:element></xs:schema><diffgr:diffgram xmlns:msdata="urn:schemas-microsoft-com:xml-msdata" xmlns:diffgr="urn:schemas-microsoft-com:xml-diffgram-v1"><rsVoorraad xmlns=""><Voorraad diffgr:id="Voorraad1" msdata:rowOrder="0"><ArtikelCode>WAVETEST</ArtikelCode><ArtikelGroepCode>ALG</ArtikelGroepCode><Omschrijving>Wave test artikel</Omschrijving><VariantCode /><Type>Beschadigd</Type><Aantal>0</Aantal></Voorraad><Voorraad diffgr:id="Voorraad2" msdata:rowOrder="1"><ArtikelCode>WAVETEST</ArtikelCode><ArtikelGroepCode>ALG</ArtikelGroepCode><Omschrijving>Wave test artikel</Omschrijving><VariantCode /><Type>Beschikbare voorraad</Type><Aantal>97</Aantal></Voorraad><Voorraad diffgr:id="Voorraad3" msdata:rowOrder="2"><ArtikelCode>WAVETEST</ArtikelCode><ArtikelGroepCode>ALG</ArtikelGroepCode><Omschrijving>Wave test artikel</Omschrijving><VariantCode /><Type>Gereserveerd</Type><Aantal>0</Aantal></Voorraad><Voorraad diffgr:id="Voorraad4" msdata:rowOrder="3"><ArtikelCode>WAVETEST</ArtikelCode><ArtikelGroepCode>ALG</ArtikelGroepCode><Omschrijving>Wave test artikel</Omschrijving><VariantCode /><Type>In backorder</Type><Aantal>0</Aantal></Voorraad><Voorraad diffgr:id="Voorraad5" msdata:rowOrder="4"><ArtikelCode>WAVETEST</ArtikelCode><ArtikelGroepCode>ALG</ArtikelGroepCode><Omschrijving>Wave test artikel</Omschrijving><VariantCode /><Type>In orderverwerking</Type><Aantal>5</Aantal><OrderVoorraad diffgr:id="OrderVoorraad1" msdata:rowOrder="0"><Type>In orderverwerking</Type><ArtikelCode>WAVETEST</ArtikelCode><VariantCode /><Ordernummer>554712</Ordernummer><Regelnummer>1</Regelnummer><Referentie>test decimalen</Referentie><Plaats>Testdorp</Plaats><Leverdatum>2012-02-14T00:00:00+01:00</Leverdatum><Aantal>2</Aantal></OrderVoorraad><OrderVoorraad diffgr:id="OrderVoorraad2" msdata:rowOrder="1"><Type>In orderverwerking</Type><ArtikelCode>WAVETEST</ArtikelCode><VariantCode /><Ordernummer>741124</Ordernummer><Regelnummer>1</Regelnummer><Referentie>test auto mail DHL</Referentie><Plaats>Heerhugowaard</Plaats><Leverdatum>2012-09-07T00:00:00+02:00</Leverdatum><Aantal>1</Aantal></OrderVoorraad></Voorraad><Voorraad diffgr:id="Voorraad6" msdata:rowOrder="5"><ArtikelCode>WAVETEST</ArtikelCode><ArtikelGroepCode>ALG</ArtikelGroepCode><Omschrijving>Wave test artikel</Omschrijving><VariantCode /><Type>Te ontvangen</Type><Aantal>0</Aantal></Voorraad><Voorraad diffgr:id="Voorraad7" msdata:rowOrder="6"><ArtikelCode>WAVETEST</ArtikelCode><ArtikelGroepCode>ALG</ArtikelGroepCode><Omschrijving>Wave test artikel</Omschrijving><VariantCode /><Type>Vrije voorraad</Type><Aantal>100</Aantal></Voorraad><Voorraad diffgr:id="Voorraad8" msdata:rowOrder="7"><ArtikelCode>WAVETEST2</ArtikelCode><ArtikelGroepCode>ALG</ArtikelGroepCode><Omschrijving>Wave test 2</Omschrijving><VariantCode /><Type>Beschadigd</Type><Aantal>19</Aantal></Voorraad><Voorraad diffgr:id="Voorraad9" msdata:rowOrder="8"><ArtikelCode>WAVETEST2</ArtikelCode><ArtikelGroepCode>ALG</ArtikelGroepCode><Omschrijving>Wave test 2</Omschrijving><VariantCode /><Type>Beschikbare voorraad</Type><Aantal>0</Aantal></Voorraad><Voorraad diffgr:id="Voorraad10" msdata:rowOrder="9"><ArtikelCode>WAVETEST2</ArtikelCode><ArtikelGroepCode>ALG</ArtikelGroepCode><Omschrijving>Wave test 2</Omschrijving><VariantCode /><Type>Gereserveerd</Type><Aantal>0</Aantal></Voorraad><Voorraad diffgr:id="Voorraad11" msdata:rowOrder="10"><ArtikelCode>WAVETEST2</ArtikelCode><ArtikelGroepCode>ALG</ArtikelGroepCode><Omschrijving>Wave test 2</Omschrijving><VariantCode /><Type>In backorder</Type><Aantal>0</Aantal></Voorraad><Voorraad diffgr:id="Voorraad12" msdata:rowOrder="11"><ArtikelCode>WAVETEST2</ArtikelCode><ArtikelGroepCode>ALG</ArtikelGroepCode><Omschrijving>Wave test 2</Omschrijving><VariantCode /><Type>In orderverwerking</Type><Aantal>0</Aantal></Voorraad><Voorraad diffgr:id="Voorraad13" msdata:rowOrder="12"><ArtikelCode>WAVETEST2</ArtikelCode><ArtikelGroepCode>ALG</ArtikelGroepCode><Omschrijving>Wave test 2</Omschrijving><VariantCode /><Type>Te ontvangen</Type><Aantal>0</Aantal></Voorraad><Voorraad diffgr:id="Voorraad14" msdata:rowOrder="13"><ArtikelCode>WAVETEST2</ArtikelCode><ArtikelGroepCode>ALG</ArtikelGroepCode><Omschrijving>Wave test 2</Omschrijving><VariantCode /><Type>Vrije voorraad</Type><Aantal>0</Aantal></Voorraad></rsVoorraad></diffgr:diffgram></DS><AantRec /></FetchStockResult></FetchStockResponse></soap:Body></soap:Envelope> 
```

正如您所看到的那样，我必须在客户端服务器上使用wavetest“hello world”返回，同时让它工作。如果有人可以告诉我如何检索例如“ArtikelCode”

或者如何获得所有“Voorraad diffgr:id="id_name" 也很好

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T20:33:51.167

Wrikken 说的很对，我没有正确理解命名空间及其对输出的影响。

像他建议的那样再次搜索后，我发现这个问题帖子最有帮助

[PHP 使用 SimpleXML 处理命名空间](https://stackoverflow.com/questions/8275643/php-handling-namespace-with-simplexml)

# gnu-make - 如何禁用 Gnu Make 3.82 版的自动完成

> ID：15228930
> 
> 赞同：0
> 
> 时间：2013-03-05T16:22:54.210
> 
> 标签：gnu-make

升级到 3.82 版本的 Gnu Make 后，我发现它支持目标自动完成。

对于某些发行版，它可能真的很有帮助

但是，对于 OpenWrt Linux Distribution，它可能会很麻烦，因为部分构建通常如下所示

```
# make package/path/{clean,install} V=99 
```

但是我们不能进行 PATH 自动完成，因为 Gnu Make 现在非常“智能”，它会打印出可能的 make 目标以供您选择，而不是执行 PATH 自动完成

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-02T11:12:58.617

> 升级到 3.82 版本的 Gnu Make 后，我发现它支持目标自动完成。

这不太可能是有道理的。你的shell完成是由......你的shell完成的。因此，请从您的 shell 配置中删除对 Make 的完成支持。

# javascript - require.js 和 r.js 依赖项

> ID：15228933
> 
> 赞同：3
> 
> 时间：2013-03-05T16:22:59.840
> 
> 标签：javascript, optimization, backbone.js, requirejs

我的应用程序一直运行良好，但今天我决定试一试 r.js。

现在我的树（它的一部分）看起来像

*   索引.html
*   资产
    *   js
        *   需要.js
        *   r.js
        *   main.js
        *   成分
            *   下划线.js
            *   jQuery.js
            *   骨干.js
            *   jqueryuijs
        *   楷模
            *   选举.js
        *   收藏品
            *   选举.js
        *   意见
            *   应用程序.js
            *   选举.js

在我的 index.html 文件中，我有 `<script data-main="assets/js/main" src="assets/js/require.js"></script>`

这是 main.js

```
require.config({
    paths: {
        jquery: 'http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min',
        underscore: 'components/underscore/underscore-min',
        backbone: 'components/backbone/backbone-min',
        jqueryui: 'components/jqueryui/jquery-ui-1.10.1.custom.min'
    },

    shim: {
        'backbone': {
            deps: ['underscore', 'jquery'],
            exports: 'Backbone'
        },

        'jqueryui': ['jquery']
    }

});

require(['views/app'], function(App) {

    var router = Backbone.Router.extend({
        routes: {
            '': 'root',
            'year(/:year)': 'year'
        },

        root: function() {
            new App();
        },

        year: function(year) {
            new App({
                year: year
            });
        }
    });

    r = new router();
    Backbone.history.start({
        // pushState: true
    });
}); 
```

在我的模块中，我指的是我的文件，例如`assets/js/views/election.js`或`assets/js/models/election.js`

但是当我用这个 build.js 运行 r.js

```
({
    // baseUrl: "assets/",
    paths: {
        jquery: 'http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min',
        underscore: 'components/underscore/underscore-min',
        backbone: "components/backbone/backbone-min",
        jqueryui: 'components/jqueryui/jquery-ui-1.10.1.custom.min'
    },
    name: "main",
    out: "main-built.js"
}) 
```

我明白了`Error: ENOENT, no such file or directory '/Users/alex/Dropbox/www/animated-elections/assets/js/assets/js/collections/elections.js'`。我明白这意味着什么，我不明白为什么它会`assets/js`在我的路径中添加另一个。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T16:38:25.707

r.js 位于您的 app 目录中，而不是像[setup 示例](http://requirejs.org/docs/optimization.html#setup)中指定的那样与其同级。

我没有对此进行测试，但 r.js 可能假设任何模块调用都应该与它所在的位置相关。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T16:37:27.347

我相信`require.js`应该与主文件放在同一个文件夹中，即。在文件夹旁边`assets`而不是在里面。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-10T15:07:11.203

在 build.js 文件中添加此代码。

```
baseUrl: ".",
paths: {
    jquery: 'http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min',
    underscore: 'components/underscore/underscore-min',
    backbone: "components/backbone/backbone-min",
    jqueryui: 'components/jqueryui/jquery-ui-1.10.1.custom.min',
    'views/app': 'empty:',
    'views/election': 'empty:',
    //and so with others
},
name: "main",
out: "main-built.js" 
```

问候。-

# ember.js - ember.js Ember.Select multiple=true 预选值

> ID：15228934
> 
> 赞同：2
> 
> 时间：2013-03-05T16:23:00.650
> 
> 标签：ember.js

我正在使用多选视图：

```
{{view Ember.Select
  multiple="true"
  contentBinding="App.filtersProductController"
  selectionBinding="App.filtersController.products"
  optionLabelPath="content.fullName"
  optionValuePath="content.id"
  isVisibleBinding="App.filtersController.productListBox"}} 
```

是否可以在“选择”框中预选多个值并以编程方式更改所选值？背景：我想将三个“选择”框设置的不同组合保存为书签。加载书签时，我必须设置“选择”框的值。
谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-05T18:25:26.813

是的。在您的控制器中，您必须创建一个属性以在使用`Ember.Select`.

在下面的代码中，我将 Greetings 设置为选择框的内容，在列出这些 Greetings 的控制器中（检查`ApplicationRoute`），我还有一个名为的属性`selectedItems`，我将其绑定到`Select`并且我正在使用其他几个属性来过滤我想要预选的值（1 和 3），以防在视图加载时尚未选择任何项目。

这将呈现一个多选框，其中 id 为 1 或 3 的项目标记为选中。你可以在这里看到源代码：http: [//jsfiddle.net/schawaska/Y8P4m/](http://jsfiddle.net/schawaska/Y8P4m/)

车把：

```
<script type="text/x-handlebars">
    <h1>Test</h1>
    {{view Ember.Select
           multiple="true"
           selectionBinding="controller.selectedItems"
           contentBinding="controller"
           optionLabelPath="content.text"
           optionValuePath="content.id"}}
</script> 
```

JavaScript：

```
window.App = Ember.Application.create();

App.Store = DS.Store.extend({
    revision: 11,
    adapter: 'DS.FixtureAdapter'
});

App.Greeting = DS.Model.extend({
    text: DS.attr('string'),
    when: DS.attr('date'),
    selected: false,
    isSelected: function() {
        return this.get('selected');
    }.property('selected')
});

App.ApplicationController = Em.ArrayController.extend({
    preselected: function() {
        return this.get('content').filter(function(greeting) {
            return greeting.get('id') == 1 ||
                   greeting.get('id') == 3;
        });  
    }.property('content.@each'),
    selectedItems: function() {
        if(this.get('selected.length') <= 0) {
           return this.get('preselected'); 
        } else {
            return this.get('selected');
        }
    }.property('selected', 'preselected'),
    selected: function() {
        return this.get('content').filter(function(greeting) {
            return greeting.get('isSelected');
        })
    }.property('content.@each')
});

App.Greeting.FIXTURES = [
    {id: 1, text: 'First', when: '3/4/2013 2:44:52 PM'},
    {id: 2, text: 'Second', when: '3/4/2013 2:44:52 PM'},
    {id: 3, text: 'Third', when: '3/4/2013 2:44:52 PM'},
    {id: 4, text: 'Fourth', when: '3/4/2013 3:44:52 PM'}
];

App.ApplicationRoute = Em.Route.extend({
    setupController: function(controller) {
        controller.set('model', App.Greeting.find());
    }
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-07T21:57:24.890

我创建了一个包含单个和多个“选择”元素的完整示例。您可以通过编程方式或使用“选择”GUI 元素设置默认值并更改所选值。控制器代码：

```
// class for single selects
App.SingleSelectFilterController = Ember.ArrayController.extend({
  selection: null,
  active: true,
  update: function(id) {
    this.set("selection", id);
  },
  getSelectedId: function() {
    return this.get("selection");
  }
});

// class for multi selects
App.MultiSelectFilterController = Ember.ArrayController.extend({
  selection: null,
  active: true,
  update: function(selectionIds) {
    // Workaround: Reinitializing "content". How to do it well?
    var contentCopy = [];
    for(i = 0; i < this.get("content").length; i++) {
      contentCopy.push(this.get("content")[i]);
    }
    this.set("content", contentCopy);
    this.set("selection", selectionIds);
  },
  selected: function() {
    var me = this;
    return this.get('content').filter(function(item) {
      for(i = 0; i < me.get("selection").length; i++) {
        if(me.get("selection")[i] === item.get('id')) { return true; }
      }
      return false;
    });
  }.property('content.@each'),
  getSelectedIds: function() {
    var ids = [];
    for(i = 0; i < this.get("selected").length; i++) {
      ids.push(this.get("selected")[i].get("id"));
    }
    return ids;
  }
});

// create single and multi select controllers
App.metricController = App.SingleSelectFilterController.create();
App.metricController.set("content", App.filterData.get("metrics"));
App.metricController.set("selection", "views");    // set default value for single select element
App.platformController = App.MultiSelectFilterController.create();
App.platformController.set("content", App.filterData.get("platforms"));
App.platformController.set("selection", ["plat-black"]);  // set default value for multi select element 
```

完整示例： http:
[//jsfiddle.net/7R7tb/2/](http://jsfiddle.net/7R7tb/2/)

感谢 MilkyWayJoe 的帮助！

也许有人知道如何解决这个问题（参见上面的代码注释）？

# php - PHP - 检查页面是否在移动或桌面浏览器上运行

> ID：15228937
> 
> 赞同：31
> 
> 时间：2013-03-05T16:23:01.083
> 
> 标签：php, html, css, mobile

在我的 PHP 页面中，我应该根据页面是在移动浏览器还是桌面浏览器下运行显示两种不同的文本内容。有没有办法在 PHP 中执行这个控制？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2013-03-05T16:27:55.113

这里有一个非常好的 PHP 库来检测移动客户端：http: [//mobiledetect.net](http://mobiledetect.net)

使用它很容易只显示移动设备的内容：

```
include 'Mobile_Detect.php';
$detect = new Mobile_Detect();

// Check for any mobile device.
if ($detect->isMobile()){
   // mobile content
}
else {
   // other content for desktops
} 
```

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2014-05-26T16:21:21.460

我使用了 Robert Lee 的答案，效果很好！只需写下我正在使用的完整功能：

```
function isMobileDevice(){
    $aMobileUA = array(
        '/iphone/i' => 'iPhone', 
        '/ipod/i' => 'iPod', 
        '/ipad/i' => 'iPad', 
        '/android/i' => 'Android', 
        '/blackberry/i' => 'BlackBerry', 
        '/webos/i' => 'Mobile'
    );

    //Return true if Mobile User Agent is detected
    foreach($aMobileUA as $sMobileKey => $sMobileOS){
        if(preg_match($sMobileKey, $_SERVER['HTTP_USER_AGENT'])){
            return true;
        }
    }
    //Otherwise return false..  
    return false;
} 
```

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2013-03-05T16:29:56.530

如果需要，您可以手动进行。

参考： http: [//php.net/manual/en/function.get-browser.php](http://php.net/manual/en/function.get-browser.php)

```
preg_match('/windows|win32/i', $_SERVER['HTTP_USER_AGENT'])

preg_match('/iPhone|iPod|iPad/', $_SERVER['HTTP_USER_AGENT']) 
```

你甚至可以把它变成一个脚本

```
$device = 'Blackberry'

preg_match("/$device/", $_SERVER['HTTP_USER_AGENT']) 
```

这是一个小清单

```
 '/windows nt 6.2/i'     =>  'Windows 8',
                        '/windows nt 6.1/i'     =>  'Windows 7',
                        '/windows nt 6.0/i'     =>  'Windows Vista',
                        '/windows nt 5.2/i'     =>  'Windows Server 2003/XP x64',
                        '/windows nt 5.1/i'     =>  'Windows XP',
                        '/windows xp/i'         =>  'Windows XP',
                        '/windows nt 5.0/i'     =>  'Windows 2000',
                        '/windows me/i'         =>  'Windows ME',
                        '/win98/i'              =>  'Windows 98',
                        '/win95/i'              =>  'Windows 95',
                        '/win16/i'              =>  'Windows 3.11',
                        '/macintosh|mac os x/i' =>  'Mac OS X',
                        '/mac_powerpc/i'        =>  'Mac OS 9',
                        '/linux/i'              =>  'Linux',
                        '/ubuntu/i'             =>  'Ubuntu',
                        '/iphone/i'             =>  'iPhone',
                        '/ipod/i'               =>  'iPod',
                        '/ipad/i'               =>  'iPad',
                        '/android/i'            =>  'Android',
                        '/blackberry/i'         =>  'BlackBerry',
                        '/webos/i'              =>  'Mobile' 
```

浏览器

```
 '/msie/i'       =>  'Internet Explorer',
                        '/firefox/i'    =>  'Firefox',
                        '/safari/i'     =>  'Safari',
                        '/chrome/i'     =>  'Chrome',
                        '/opera/i'      =>  'Opera',
                        '/netscape/i'   =>  'Netscape',
                        '/maxthon/i'    =>  'Maxthon',
                        '/konqueror/i'  =>  'Konqueror',
                        '/mobile/i'     =>  'Handheld Browser' 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2017-07-21T09:29:32.727

该脚本应该可以工作：

```
<?php

        $useragent=$_SERVER['HTTP_USER_AGENT'];
        if(preg_match('/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i',$useragent)||preg_match('/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i',substr($useragent,0,4)))

        { 
            //echo "mobile";
        }
        else{
           // echo "desktop";
        }
?> 
```

我在这里遇到了它：http: [//detectmobilebrowsers.com/](http://detectmobilebrowsers.com/)。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-03-05T16:25:53.453

有许多很棒的开源项目可以让检测变得更容易。举两个：

1.  [**PHP移动检测**](http://mobiledetect.net/)
2.  [**WURFL**](http://wurfl.sourceforge.net/php_index.php)

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2018-01-22T13:42:21.877

```
<?php //-- Very simple variant
$useragent = $_SERVER['HTTP_USER_AGENT']; 
$iPod = stripos($useragent, "iPod"); 
$iPad = stripos($useragent, "iPad"); 
$iPhone = stripos($useragent, "iPhone");
$Android = stripos($useragent, "Android"); 
$iOS = stripos($useragent, "iOS");
//-- You can add billion devices 

$DEVICE = ($iPod||$iPad||$iPhone||$Android||$iOS||$webOS||$Blackberry||$IEMobile||$OperaMini);

if ($DEVICE !=true) {?>

<!-- What you want for all non-mobile devices. Anything with all HTML codes-->

<?php }else{ ?> 

<!-- What you want for all mobile devices. Anything with all HTML codes --> 
<?php } ?> 
```

# php - 将 php-resque 与 Laravel 一起使用时出现“已定义常量 CRLF”错误

> ID：15228940
> 
> 赞同：0
> 
> 时间：2013-03-05T16:23:07.230
> 
> 标签：php, redis, laravel, resque, php-resque

我`php-resque`在 Ubuntu 12.04 上与 Laravel 3 一起运行。

**问题：**当作业在 resque 中排队时，我收到以下错误：

```
Unhandled Exception

Message:

Constant CRLF already defined
Location:

/var/www/dev/vendor/chrisboulton/php-resque/lib/Redisent/Redisent.php on line 10 
```

错误是什么意思，我们该如何解决？

**PHP**

```
// Enqueue in Resque        
$data = array(
    'name'                  => $name,
    'email'                 => $email,
    'created_at'            => DB::raw('NOW()')
);
Resque::enqueue('queue', 'exampleWorker', $data); 
```

* * *

但是，当我尝试使用 排队作业时`artisan`，它可以工作！

**任务**

```
class Queue_Task
{
    public function run()
    {
        // Autoload composer vendors.
        require path('composer').DS.'autoload.php';

        $args = array('name' => 'John Smith');
        Resque::enqueue('MyAppName', 'ExampleWorker', $args);

        echo "Resque job queued.\n";
        return;
    }
} 
```

**输出**

```
PHP Notice:  Constant CRLF already defined in /var/www/dev/vendor/chrisboulton/php-resque/lib/Redisent/Redisent.php on line 10

Notice: Constant CRLF already defined in /var/www/dev/vendor/chrisboulton/php-resque/lib/Redisent/Redisent.php on line 10
Resque job queued. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T16:31:51.290

这是一个猜测，但我想说如果您希望这两个软件一起工作，那么第 10 行`/var/www/dev/vendor/chrisboulton/php-resque/lib/Redisent/Redisent.php`的第二`define('CRLF', 'something')`个可能应该被注释掉。

# image-processing - 如何在 Matlab 中计算运行时内存？

> ID：15228946
> 
> 赞同：0
> 
> 时间：2013-03-05T16:23:20.790
> 
> 标签：image-processing, matlab, matlab-deployment

今天我正在开发一篇 IEEE 论文。在那篇论文中提到了运行时内存。Matlab中如何计算程序的运行时内存？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T16:32:10.493

```
profile on

SOME CODE

profile off

profile_info = profview   %HTML string of the memory profile 
```

# wpf - MoonlightDesktop 是否适合将 wpf 应用程序移植到 Linux？

> ID：15228950
> 
> 赞同：3
> 
> 时间：2013-03-05T16:23:34.813
> 
> 标签：wpf, mono, moonlight

我了解 Xamarin 不再支持 Moonlight，但我有一个在 Windows 上编写的 WPF 应用程序，我想移植到 Linux。我想避免重写 UI 代码。我遇到了一个名为 MoonlightDesktop ( [http://www.mono-project.com/MoonlightDesktop](http://www.mono-project.com/MoonlightDesktop) ) 的 Xamarin 项目，看起来像我需要的，但是关于它的讨论很少。我可以使用它来移植我的应用程序吗？如果可以，为什么 Xamarin 不将其作为他们推荐的跨平台 UI 库之一推送？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T13:05:53.070

月光[死了](http://www.infoq.com/news/2012/05/Miguel-Moonlight)。所以不幸的是，这听起来不像是一个方向。

我也不知道任何其他跨平台 WPF 兼容工具包。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-16T06:18:21.863

看来可以按照这篇文章中的描述来完成：

[http://walking-in-moonlight.blogspot.com/2011/05/run-wpf-applications-on-linux.html](http://walking-in-moonlight.blogspot.com/2011/05/run-wpf-applications-on-linux.html)

# jquery - ReferenceError: cleanSearch 未定义

> ID：15228953
> 
> 赞同：0
> 
> 时间：2013-03-05T16:23:38.667
> 
> 标签：jquery

我正在使用reveal jQuery插件在我的网页上创建一个模式：

我在页面底部添加了如下脚本：

```
<script type="text/javascript" src="../Scripts/jquery-1.8.1.min.js"></script>
<script type="text/javascript" src="../Scripts/plugins.js"></script>
<script type="text/javascript" src="../Scripts/script.js"></script> 
```

我在 plugins.js 中有显示插件

并创建了以下脚本来添加模式弹出窗口：

```
var ORC = ORC || {};

// Reveal Modal Popup
function modalPopup(linkID, modalID) {
    $(linkID).click(function (e) {
        e.preventDefault();
        $(modalID).reveal({
            animation: 'none',
            animationspeed: 200,
            closeonbackgroundclick: false,
            dismissmodalclass: 'close'
        });
        return false;
    });
}

ORC.init = function () {
    //Ts&Cs
    modalPopup('#selectTerms', '#contentTerms');
    //Privacy
    modalPopup('#selectPrivacy', '#contentPrivacy');
};

$(ORC.init); 
```

但我收到以下错误：

```
ReferenceError: cleanSearch is not defined 
```

当我单击模式弹出窗口上的关闭链接时。

有没有人遇到过这个问题？

**[JSFiddle](http://www.jsfiddle.net/zidski/pSBfw)**

# sql-server - 如何将 DD/MM/YYYY 00:00:0000 转换为 MM/YYYY 并将其保留为日期格式而不是字符串

> ID：15228954
> 
> 赞同：0
> 
> 时间：2013-03-05T16:23:39.853
> 
> 标签：sql-server

如何将`DD/MM/YYYY 00:00:0000`其`MM/YYYY`转换为日期格式而不是字符串`MS SQL`

我尝试了很多选择，但仍然没有找到合适的选择。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T16:41:07.770

只是您不能将日期保留`mm/yyyy` *为*`date/datetime`. 但是您可以将其保留为字符串，并在需要时转换回如下日期。

[Sql-Server 小提琴示例](http://sqlfiddle.com/#!3/d41d8/10424)

```
declare @dt datetime = getdate(),
    @mmyyyy varchar(7)

--To format as mm/yyyy
select @mmyyyy = right(convert(varchar(10), @dt, 103),7)

--To convert back to datetime type from  mm/yyyy varchar
select @mmyyyy [mm/yyyy],
       convert(datetime,'01/'+ @mmyyyy,103) back_To_Date 
```

# arrays - plpgsql 函数没有结果

> ID：15228955
> 
> 赞同：0
> 
> 时间：2013-03-05T16:23:46.627
> 
> 标签：arrays, function, postgresql, plpgsql

我在plpgsql中完成了以下功能。它工作正常并且它返回`'OK'`，但由于某种原因它在表中没有输入任何内容`temp`。

```
CREATE OR REPLACE FUNCTION public.get_route(node integer[])
  RETURNS character varying AS
$BODY$DECLARE 
    i int := 0;
    _r record;
    vertex int;

BEGIN

    FOREACH i IN ARRAY node

    LOOP

    IF( i < (array_length(node, 1) - 1))

    THEN

        FOR _r IN EXECUTE 'select * from shortest_path(''
                   select id as id, source_id::int4 as source, target_id::int4 as target, cost, reverse_cost
                           from network_of_point'','|| node[i] ||','|| node[i+1] ||', true, true)'

        LOOP
            vertex := _r.vertex_id;

            EXECUTE 'insert into temp
                 select nextval(''road_intersection_id_seq''), point
                 from distinct_network_point
                 where distinct_network_point.id ='|| vertex;

        END LOOP;

    i = i + 1;

    END IF;

    END LOOP;

RETURN 'OK';

END;$BODY$ 
```

以下是我用来调用该函数的 synatx：

```
select get_route('{2,7}') 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T18:47:19.193

它不起作用，因为这条线

```
IF( i < (array_length(node, 1) - 1)) 
```

您正在测试`2`or `7`（取自您的示例）是否小于数组的长度，即 value `2`。

那是因为您的下一个查询永远不会执行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T19:39:46.113

由于这一行，代码的内部部分从未执行。

```
IF( i < (array_length(node, 1) - 1)) 
```

实际上你是`i`从节点数组中提取值

```
FOREACH i IN ARRAY node 
```

它具有价值`2`或`7`与您的示例一样，并且您将`i`其视为错误的节点索引。我创建了一个单独的`int`变量值，现在我们可以`i`用作数组索引。

*我认为你想实现这一目标。*

```
CREATE OR REPLACE FUNCTION public.get_route(node integer[])
  RETURNS character varying AS
$BODY$
DECLARE
    i int := 1;
    _r record;
    vertex int;
    value int;

BEGIN

    FOREACH value IN ARRAY node
    LOOP
        IF( i < (array_length(node, 1)))
        THEN
            FOR _r IN EXECUTE 'select * from shortest_path(''
                select id as id, source_id::int4 as source, target_id::int4 as target, cost, reverse_cost
                        from network_of_point'','|| node[i] ||','|| node[i+1] ||', true, true)'
           LOOP
            vertex := _r.vertex_id;
            EXECUTE 'insert into temp
                select nextval(''road_intersection_id_seq''), point
                from distinct_network_point
                where distinct_network_point.id ='|| vertex;

           END LOOP;
        i = i + 1;
        END IF;
    END LOOP;

    RETURN 'OK';
END;
$BODY$ language plpgsql; 
```

# android - 移除 Spinner 上的按下颜色

> ID：15228956
> 
> 赞同：4
> 
> 时间：2013-03-05T16:23:49.450
> 
> 标签：android, colors, spinner, pressed

我想删除单击 Spinner 时出现的蓝色（我正在使用 Holo 测试我的应用程序）。

我的代码：

```
 ArrayAdapter<String> array_adapter = new ArrayAdapter<String> (getActivity(), 
            R.layout.spinner_item, string_array);
    array_adapter.setDropDownViewResource(R.layout.spinner_item);

    Spinner spinner = (Spinner) getView().findViewById(R.id.spinner);
    spinner.setAdapter(array_adapter); 
```

spinner_item.xml

```
<TextView xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/spinner_text"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:textAllCaps="true"
    android:background="@drawable/item"
    style="@style/EquidiaTheme.MySpinner" /> 
```

和 item.xml

```
<selector xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:state_pressed="true" android:drawable="@android:color/transparent" />
    <item android:state_selected="true" android:drawable="@android:color/transparent" />
    <item android:drawable="@android:color/transparent" />
</selector> 
```

这行不通。任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T16:34:27.330

定制`android:spinnerDropDownItemStyle`

[样式化操作栏下拉菜单](https://stackoverflow.com/questions/11479186/styling-actionbar-dropdown-menu)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-13T10:24:04.880

当我这样做时，当我选择它时，我能够摆脱项目上的蓝色矩形：首先我声明我想在 values.xml 中使用的颜色：

```
<resources>
   <drawable name="red_color">#ff0000</drawable>
   <drawable name="blue_color">#0000ff</drawable>
   <drawable name="green_color">#00ff00</drawable>
   <drawable name="transparent_color">#00000000</drawable>
</resources> 
```

比我在 Styles.xml 中定义自定义样式

```
<resources>
    <style name="Theme.Spinner" parent="android:Theme.Holo">
        <item name="android:attr/listChoiceBackgroundIndicator">@drawable/transparent_color</item>
   </style>
</resources> 
```

在样式中，我只能使用资源中定义的颜色（直接在样式中设置颜色，例如：@android:color/XXX 或 #XXX 不起作用）

毕竟我在活动中应用它们。我使用 Xamarin，所以代码可能是：

```
[Activity( Label = "TestLayouts", MainLauncher = true, Icon = "@drawable/icon", Theme="@style/Theme.Spinner")] 
```

但对于 android 它应该是： `<activity android:theme="@style/Theme.Spinner">`

我将此答案用作参考：可 [点击视图中的默认选择器背景](https://stackoverflow.com/questions/9250215/default-selector-background-in-clickable-views)

还要摆脱微调器本身的蓝色矩形，请使用：

```
 <Spinner 
   android:background="@null" 
```

您需要同时使用两者来完全删除蓝色矩形。也可能这种风格属性可以帮助你：

```
 <item name="android:attr/colorPressedHighlight">#FF0000</item>
    <item name="android:attr/colorLongPressedHighlight">#FF0000</item>
    <item name="android:attr/listChoiceIndicatorSingle">@drawable/red_color</item> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-11-09T16:09:00.630

没有主题的解决方案。如果您只有几个微调器，则非常理想。

创建一个带有状态的可绘制（xml）（[https://developer.android.com/guide/topics/resources/drawable-resource.html#StateList](https://developer.android.com/guide/topics/resources/drawable-resource.html#StateList)）

对状态 PRESSED 和 NORMAL 使用相同的图像

然后将其用作背景：

```
mySpinner.setBackgroundResource(R.drawable.my_spinner_state_drawable) 
```

额外提示：

*   您可以使用系统资源中的系统可绘制（图像）：例如“@android:drawable/btn_dropdown_normal”。它更易于维护并提供更原生的外观和感觉。
*   参考[http://androiddrawables.com/Buttons.html](http://androiddrawables.com/Buttons.html)

# c# - Microsoft.Data.Schema.ScriptDom 解析器的速度

> ID：15228959
> 
> 赞同：3
> 
> 时间：2013-03-05T16:23:52.757
> 
> 标签：c#, tsql, sql-parser

我正在使用 Microsoft.Data.Schema.ScriptDom 和 Microsoft.Data.Schema.ScriptDom.Sql 库来解析 SQL 并将“TOP #”添加到 SQL 选择语句中。我们这样做是为了在某些情况下限制结果集。

我刚开始使用这个库，我注意到解析 SQL 并不是很快。我没有检测代码来实际测量速度，但它很明显，在半秒到一整秒之间。这并不可怕，但我也不会称之为快速。

我的代码如下所示：

```
 var Parser = new TSql100Parser(true);      
  TextReader reader = new StringReader(sql);
  IList<ParseError> errors;
  var fragments = Parser.Parse(reader, out errors); 
```

我用谷歌搜索了这个并没有发现任何关于速度的抱怨，所以我想知道我是否做错了什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T19:00:28.727

看来微软的库不是你所说的快。我做了更多的谷歌搜索，我不是唯一一个看到这个问题的人。如果你真的需要解析 SQL，有一些替代方案。它们没有 Microsoft 库的功能，但它们似乎表现良好。

[黄金解析系统](http://goldparser.org/)

[穷人的 T-SQL 格式化程序](http://architectshack.com/PoorMansTSqlFormatter.ashx)

# sql - 获取最近的非空记录

> ID：15228964
> 
> 赞同：4
> 
> 时间：2013-03-05T16:24:07.377
> 
> 标签：sql, sql-server, sql-server-2008-r2

我正在尝试获取最新记录并找到不`NULL`匹配的记录。问题是我的子查询返回多个结果。

**数据集**

```
| 身份证 | DD | SIG_ID | DCRP |
--------------------------------------
| 1 | 2010-06-01 | 1 | 专家 |
| 2 | 2010-09-01 | 1 | 专家 |
| 3 | 2010-12-01 | 1 | 专家 |
| 4 | 2010-12-01 | 1 | 专家二 |
| 5 | 2011-03-01 | 1 | 专家二 |
| 6 | 2011-06-01 | 1 | (空) |
| 7 | 2010-06-01 | 2 | 高级 |
| 8 | 2010-09-01 | 2 | 高级 |
| 9 | 2010-09-01 | 2 | 高级 |
| 10 | 2010-12-01 | 2 | 高级二 |
| 11 | 2011-03-01 | 2 | (空) |
| 12 | 2011-03-01 | 2 | 高级 |
| 13 | 2010-06-01 | 3 | (空) |
| 14 | 2010-09-01 | 3 | (空) |
| 15 | 2010-12-01 | 3 | (空) |
```

**询问**

```
SELECT a.sig_id, a.id, 
  CASE
    WHEN b.dcrp IS NULL
      THEN
        (SELECT dcrp
         FROM tbl
         WHERE sig_id = a.sig_id
           AND id < a.id
           AND dcrp IS NOT NULL)
      ELSE b.dcrp
  END AS dcrp
FROM
  (SELECT sig_id, MAX(id) id
  FROM tbl
  GROUP BY sig_id) a
LEFT JOIN
  (SELECT id, dcrp
   FROM tbl
   WHERE dcrp IS NOT NULL) b ON b.id = a.id 
```

**期望的结果**

`dcrp`获取每个最新的`sig_id`：

```
| 身份证 | DD | SIG_ID | DCRP |
--------------------------------------
| 5 | 2011-03-01 | 1 | 专家二 |
| 12 | 2011-03-01 | 2 | 高级 |
| 15 | 2010-12-01 | 3 | (空) |
```

[SQL小提琴](http://sqlfiddle.com/#!3/98421/6)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-05T16:32:03.317

您可以使用以下内容：

```
;WITH CTE AS
(
    SELECT *, ROW_NUMBER() OVER(PARTITION BY SIG_ID 
                                ORDER BY CASE WHEN DCRP IS NOT NULL THEN 0 ELSE 1 END,
                                DD DESC) RN
    FROM tbl
)
SELECT *
FROM CTE 
WHERE RN = 1 
```

还有[小提琴](http://sqlfiddle.com/#!3/98421/20)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-05T16:37:14.460

```
;with si as (
  select distinct sig_id from tbl
)

select * 
from si
cross apply (select top 1 * from tbl where si.sig_id=tbl.sig_id order by case when dcrp is null then 1 else 0 end asc,dd desc) sii 
```

和提琴手： [http ://sqlfiddle.com/#!3/8e267/2/0](http://sqlfiddle.com/#!3/8e267/2/0)

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-03-05T16:31:00.400

由于子查询返回超过 1 行，SQLFiddle 中的查询失败。
添加`TOP 1`修复。请检查是否正常。

```
THEN
        (SELECT TOP 1 dcrp
         FROM tbl
         WHERE sig_id = a.sig_id
           AND id < a.id
           AND dcrp IS NOT NULL) 
```

# python - Windows 上的 gevent TCP 服务器

> ID：15228973
> 
> 赞同：1
> 
> 时间：2013-03-05T16:24:32.850
> 
> 标签：python, windows, tcp, nonblocking, gevent

到目前为止，我一直在尝试使用 gevent 创建一个 TCP 服务器，但没有（任何重大）成功。我认为问题出在 Windows 中（我之前在 Windows 下遇到过一些套接字问题）。我在Windows7下使用Python2.7、gevent0.13。这是我的代码：

```
from gevent import socket
from gevent.server import StreamServer

def handle_echo(sock, address):
    try:
        fp = sock.makefile()
        while True:
            # Just echos whatever it receives
            try:
                line = fp.readline()
            except Exception:
                break
            if line:
                try:
                    fp.write(line)
                    fp.flush()
                except Exception:
                    break
            else:
                break
    finally:
        sock.shutdown(socket.SHUT_WR)
        sock.close()

server = StreamServer(("", 2345), handle_echo)
server.server_forever() 
```

此实现类似于您可以在此处找到的实现：

[http://blog.pythonisito.com/2012/08/building-tcp-servers-with-gevent.html](http://blog.pythonisito.com/2012/08/building-tcp-servers-with-gevent.html)

现在没有错误，服务器似乎工作正常，但是它没有读取（因此发送）任何东西。是否有可能`sock.makefile()`在 Windows7 下无法正常工作？或者问题可能出在其他地方？

我试图`sock.makefile()`用简单的替换

```
while True:
    line = sock.recv(2048) 
```

但是这个操作显然会阻塞。

我也尝试将 gevent`spawn`与`sock.setblocking(0)`. 现在这更好并且它工作了，但是它一次不能处理超过 300 个连接。

我将在 Linux 上做一些测试，看看它是否有所作为。同时，如果您有任何想法，请随时与我分享。干杯!

**更新**原始代码在 Ubuntu 12.04 下做同样的事情。那么我应该如何实现gevent TCP服务器？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T19:38:17.573

你给服务器发了什么？确保它被换行符终止。否则 readline() 将不起作用。

如果您认为自己在代码中做正确的事情，您还可以使用 tcpdump 或 wireshark 来查看 TCP 层发生了什么。

# javascript - 在 Mac 上检测 32 位和 64 位 Firefox 的 Javascript

> ID：15228980
> 
> 赞同：2
> 
> 时间：2013-03-05T16:24:42.733
> 
> 标签：javascript, macos, firefox

在 mac 上，是否有一个 javascript 对象来测试 firefox 是作为 32 位还是 64 位应用程序运行的？

我有一个使用插件的页面，该插件仅在 FireFox 下且仅在 32 位模式下受 Mac 支持。使用用户代理，很容易检测浏览器，但我找不到检测浏览器是在 32 位还是 64 位模式下运行的方法。

# java - JNLP 不下载操作系统资源

> ID：15228984
> 
> 赞同：2
> 
> 时间：2013-03-05T16:24:51.100
> 
> 标签：java, jnlp, java-web-start

我一直在编写一个使用 WebStart 的程序，但我似乎遇到了问题。我注意到无论我做什么，我都无法让 WebStart 下载操作系统特定的 jar。

下面你会看到我的 JNLP 文件。Wehn 你看看资源你会注意到我有一些操作系统和体系结构独立的 jars，然后我有一些依赖于操作系统的 jars 和 nativelibs。

目前，核心和通用文件夹中的所有内容都将正确加载，但没有其他内容。如果我创建一个单独的 jnlp 文件来链接我的计算机所需的所有内容，它将下载并加载得很好（几乎没有什么问题需要弄清楚）。

这是我的 JNLP 文件，你看到什么地方出了问题吗？

```
<?xml version='1.0' encoding='utf-8' ?>
<jnlp
    spec="1.0+"
    codebase="http://xxxx.xxxxxxxxxxxxxxxx.xxx/java/"
    href="MyApp.jnlp?k=14&amp;d=dGMDES%2Bgs0A3d03HbVKkD4T7ONIby1a5NZGMVkwHzsV7tydBs2eoPvyHfeXlNpcxD8H8Wt1kRePtxBuOswZ%2FxA%3D%3D">
    <information>
        <title>Program Name</title>
        <vendor>Company</vendor>
        <description></description>
        <description kind="short"</description>
    </information>
    <update check="always" policy="always" />
    <resources>
        <j2se version="1.7+" href="http://java.sun.com/products/autodl/j2se" />
        <property name="sun.awt.disableMixing" value="false"/>
        <jar href="core/Utilities.jar" size="146289" main="false" download="lazy" />
        <jar href="core/DPFP.jar" size="40239" main="false" download="lazy" />
        <jar href="core/SigPad.jar" size="8293" main="false" download="lazy" />
        <jar href="core/SoapService.jar" size="741035" main="false" download="lazy" />
        <jar href="core/Marketing.jar" size="857781" main="false" download="lazy" />
        <jar href="core/App.jar" size="1172429" main="true" download="eager" />
        <jar href="core/Element.jar" size="506791" main="false" download="lazy" />
        <jar href="universal/ekitspell.jar" size="330488" main="false" download="lazy" />
        <jar href="universal/DJNativeSwing.jar" size="111941" main="false" download="lazy" />
        <jar href="universal/DJNativeSwing-SWT.jar" size="580006" main="false" download="lazy" />
        <jar href="universal/SigPlus2_57.jar" size="125633" main="false" download="lazy" />
        <jar href="universal/japura.jar" size="296730" main="false" download="lazy" />
        <jar href="universal/miglayout15-swing.jar" size="81697" main="false" download="lazy" />
        <jar href="universal/ekit.jar" size="171833" main="false" download="lazy" />
        <jar href="universal/RXTXcomm.jar" size="67856" main="false" download="lazy" />
        <jar href="universal/commons-codec-1.7.jar" size="281608" main="false" download="lazy" />
        <jar href="universal/json_simple-1.1.jar" size="18827" main="false" download="lazy" />
    </resources>
<resources os="Linux">
    <nativelib href="lib/linux/SigUsb.jar" size="108657" download="eager" />
    <nativelib href="lib/linux/rxtx-native-linux.jar" size="175917" download="eager" />
    <jar href="linux/dpfpenrollment.jar" size="334610" main="false" download="lazy" />
    <jar href="linux/dpfpverification.jar" size="37114" main="false" download="lazy" />
    <jar href="linux/dpotapi.jar" size="67688" main="false" download="lazy" />
    <jar href="linux/dpotjni.jar" size="14398" main="false" download="lazy" />
</resources>
<resources os="Mac\ OS">
    <jar href="mac/OS/swt_mac.jar" size="1794474" main="false" download="lazy" />
</resources>
<resources os="Mac\ OS X">
    <nativelib href="lib/mac/OSX/rxtx-native-macosx.jar" size="111183" download="eager" />
    <jar href="mac/OSX/swt_mac.jar" size="1794474" main="false" download="lazy" />
</resources>
<resources os="Windows" arch="x86">
    <nativelib href="lib/windows/rxtx-native-windows.jar" size="178321" download="eager" />
    <nativelib href="lib/windows/x86/SigUsb.jar" size="39385"  download="eager" />
    <jar href="windows/dpfpenrollment.jar" size="334610" main="false" download="lazy" />
    <jar href="windows/dpfpverification.jar" size="37114" main="false" download="lazy" />
    <jar href="windows/dpotapi.jar" size="67688" main="false" download="lazy" />
    <jar href="windows/dpotjni.jar" size="14398" main="false" download="lazy" />
    <jar href="windows/x86/swt_windows_x86.jar" size="2007870" main="false" download="lazy" />
</resources>
<resources os="Windows" arch="x86_64">
    <nativelib href="lib/windows/rxtx-native-windows.jar" size="178321" download="eager" />
    <nativelib href="lib/windows/x86_64/SigUsb.jar" size="48092"  download="eager" />
    <jar href="windows/dpfpenrollment.jar" size="334610" main="false" download="lazy" />
    <jar href="windows/dpfpverification.jar" size="37114" main="false" download="lazy" />
    <jar href="windows/dpotapi.jar" size="67688" main="false" download="lazy" />
    <jar href="windows/dpotjni.jar" size="14398" main="false" download="lazy" />
    <jar href="windows/x86_64/swt_windows_x86_64.jar" size="2064877" main="false" download="lazy" />
</resources>
    <application-desc main-class="opt.companyname.app.Main">
        <argument>k=14</argument>
        <argument>d=dGMDES+gs0A3d03HbVKkD4T7ONIby1a5NZGMVkwHzsV7tydBs2eoPvyHfeXlNpcxD8H8Wt1kRePtxBuOswZ/xA==</argument>
    </application-desc>
    <security>
        <all-permissions/>
    </security>
</jnlp> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-06T10:35:06.163

Java Web Start 描述符中的“Resource”标签有两个关键元素，可以实现高效的 Java 应用程序部署。资源标签的一个重要属性是“os”属性。此属性允许您为应用程序的部署指定特定平台。“os”属性中的选项可以是“Windows”、“Linux”、“Mac OS X”等。

下一个相关的资源属性是“arch”属性。此属性允许指定处理器架构。“arch”属性的相关值包括“x86”和**“amd64”（即使是Intel 64bit）**

您需要正确指定使用那些特定操作系统相关库的**架构版本。**
其他**拱**值可以是：

```
<resources os="Linux"  arch="i386 x86" >  
...
</resources>

<resources os="Linux"  arch="amd64" >  
...
</resources>

<resources os="Windows"  arch="x86" >  
...
</resources>

<resources os="Windows"  arch="amd64" >  
...
</resources>

<resources os="Mac\ OS\ X" arch="x86_64" >  
...
</resources>

<resources os="Mac\ OS\ X" arch="i386 x86">  
...
</resources> 
```

希望这可以帮助。

# php - 无法下载 og:image，尽管可以通过调试器访问

> ID：15228986
> 
> 赞同：0
> 
> 时间：2013-03-05T16:24:52.957
> 
> 标签：php, facebook, image, share

我们是一个完全用 PHP 编写的网站，我们使用 facebook 元标记，因为我们提供 facebook 分享、点赞等...

问题是当我们从我们的网站分享到 Facebook 的链接时，它会正确显示图片，但是尝试从另一个用户转发相同的链接时，会删除图片并仅显示链接。

使用 FB 调试工具进行进一步故障排除显示以下错误消息：无法下载 og:image‎‏：无法下载 og:image 标签的 url 引用的图像。</p>

奇怪的是，图像已经在调试器中看到和访问了！！

示例页面： http: [//fbcomics.com/home/index/92/date/1462](http://fbcomics.com/home/index/92/date/1462)

调试器： [https ://developers.facebook.com/tools/debug/og/object?q=http%3A%2F%2Ffbcomics.com%2Fhome%2Findex%2F92%2Fdate%2F1462](https://developers.facebook.com/tools/debug/og/object?q=http%3A%2F%2Ffbcomics.com%2Fhome%2Findex%2F92%2Fdate%2F1462)

非常感谢您的合作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-30T10:19:39.210

问题自己解决了。Facebook 似乎需要某个时间（我认为是几周）来存储页面信息，包括使用其爬虫的图片。

如果您遇到这种情况，很可能您需要等待一段时间才能共享您的新页面。

谢谢，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T16:37:39.767

我认为您可能需要`urlencode()`将 url 值放入 og:image 元标记的内容属性中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T15:46:07.167

这可能与最近的 Facebook 错误有关。[https://developers.facebook.com/bugs/239522122851150](https://developers.facebook.com/bugs/239522122851150)

# tfsbuild - 尽管选择了 Release，TFS Build 仍在构建多个配置

> ID：15228992
> 
> 赞同：6
> 
> 时间：2013-03-05T16:25:16.713
> 
> 标签：tfsbuild

当我构建（TFS 2012）时，我的 4 个解决方案具有要构建的配置 = Any CPU|Release 它正在构建所有这些作为 Release，其中 2 个作为 Debug | 混合平台，其中之一是 Debug | 任何 CPU。

如果我将它设置为发布，我希望它只进行发布构建。谁能给我一些关于为什么它也在做一些调试版本的见解？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T16:50:41.987

需要检查的几件事：

*   您是否在 Build Configuration 中指定了多个要构建的配置？在构建配置中，转到`Process`选项卡，然后`Items to Build`-> `Configurations to Build`。
*   其次，查看您的解决方案配置。然后，您可以通过`Build`Visual Studio 中的菜单访问此内容`Configuration Manager`。在这里，您可以编辑给定指定解决方案配置的项目应该如何构建。

**更新**

*   如果您自定义了构建过程模板，请尝试将其剥离回默认模板，看看问题是否仍然存在。

# linq - 在 group by 之后重新排序 linq 语句

> ID：15228993
> 
> 赞同：0
> 
> 时间：2013-03-05T16:25:17.113
> 
> 标签：linq

基本上，我有一个类似的声明

```
Contents
.Where(x=>x.CategoryId==5 && x.Status==1)
.GroupBy(q=>q.VersionId)
.OrderByDescending(q=>q.Key)
.Take(100)  
.Select(q => new { VersionId = q.Key, MajorVersion = q.Max(x => x.MajorVersion) }) 
```

目前，它看起来像下面。但我想将 MajorVersion 字段重新排序为降序...

```
VersionId     MajorVersion
387276        2
365015        1
355427        3
369865        1 
```

我怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T16:30:10.850

Select returns an `IEnumerable` so you can do further sorting/ordering etc after.

```
Contents
.Where(x => x.CategoryId == 5 && x.Status == 1)
.GroupBy(q => q.VersionId)
.OrderByDescending(q => q.Key)
.Take(100)  
.Select(q => new { VersionId = q.Key, MajorVersion = q.Max(x => x.MajorVersion) })
.OrderByDescending(x => x.MajorVersion); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T16:27:37.623

只需移动`OrderByDescending`. 然后，您将能够按选择中的字段进行排序。（因为您将调用由返回的匿名类型的 IQueryable ）`Select`
`OrderByDescending``Select()`

# jquery-ui - Wijmo 网格 - 单击特定列时防止选择行

> ID：15228994
> 
> 赞同：1
> 
> 时间：2013-03-05T16:25:21.117
> 
> 标签：jquery-ui, wijmo

我有一个允许行选择的 Wijmo Grid，每当用户单击任何列时。我添加了一列来显示带有特定记录附加信息的工具提示。问题是单击此列时，Wijmo 会自动选择当前行。

我已经阅读了文档，在选择一行或单击一行之前没有任何事件。该`selectionChanged`事件在这种情况下没有用，因为它在选择一行后被触发。

我无法添加 tr click 事件处理程序并制作 `e.preventDefault,`，因为在这种情况下工具提示不会出现。

根据单击的列，如何防止行选择？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T16:03:48.407

没有本地方法可以做到这一点。您可以做的是，处理 currentCellChanging 事件并根据单击的单元格将 'selectionMode' 选项设置为无。

```
var isLoaded = false;
$("#gridview2").wijgrid({    
loading: function (e, args) {
   isLoaded = false;
},
loaded: function (e, args) {
   isLoaded = true;
},
currentCellChanging: function (e, args) {
   if (isLoaded) {
      if (args.cellIndex == 5) {
         $(this).wijgrid({ selectionMode: 'none' });
      }
      else {
         $(this).wijgrid({ selectionMode: 'singleRow' });
      }
   }                    
}
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-10T12:18:16.383

使用 selectionMode="none" 工作正常，默认情况下不选择任何内容

# algorithm - 如何使用boost将复杂多边形划分为简单多边形？

> ID：15228997
> 
> 赞同：1
> 
> 时间：2013-03-05T16:25:28.643
> 
> 标签：algorithm, boost

我正在寻找将复杂多边形（自相交多边形）转换为简单凸多边形。

```
-----------------------------------------
 - -               
   - -
     - -
       - -
         - -
           - -
             -
           - -
         - -
       - -
     - -
    - -
   - -
   ----------------------

```

上图应生成两个多边形（三角形）。

我正在研究 boost 库并寻找使用 boost 库的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T03:30:47.940

让我们假设您的初始多边形是 ...xa,xb,....,xc,xd,.... （其中 xi 是顶点），并且边 xa,xb 和 xc,xd 相交。然后你有两个多边形：....xa,xe,xd,... 和 xe,xb,...,xd。

现在，如果两个多边形相交，它们必须在两个地方（或偶数个地方）相交。如果两个多边形 ....xa,xb,...xc,xd,.... 和 ...xe,xf,....xg,xh,... 相交于 (xa,xb) (xe ,xf) 和 (xc,xd) (xg,xh) 你有两组新多边形，有两个新顶点 xi 和 xj（我会让你弄清楚这些多边形的确切性质）。

然后有一些算法可以计算出相交的线段对列表。

结合这三部分，你就得到了你的算法。