# StackOverflow 问答 13592000-13592999

# asp.net - SQLExpress 错误上的本地数据库

> ID：13592004
> 
> 赞同：0
> 
> 时间：2012-11-27T19:55:51.913
> 
> 标签：asp.net, .net, sql-server, database, web-services

我有一个简单的 Web 服务，可以运行和查询一个简单的`.mdf`数据库。

我正在使用 IIS 并使其成为一个工作应用程序。

我可以从任何地方激活此 Web 服务上的每个功能。

但是当我尝试查询数据库时，我得到了这个错误：

> *System.Data.SqlClient.SqlException (0x80131904)：无法打开登录请求的数据库“网关”。登录失败。
> 11-27 21:32:01.437：W/System.err(765)：用​​户 'IIS APPPOOL\masn' 登录失败。*

我的连接字符串是：

```
<add name="gatewayConnectionString" 
     connectionString="Data Source=.\SQLEXPRESS;Initial Catalog=gateway;Integrated Security=True" 
     providerName="System.Data.SqlClient"/> 
```

那么我怎样才能让它工作呢？更改我的连接字符串？在某处更改权限？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T20:46:57.320

The error says the account under which your web service is running can't access the database. In the connection string you have specified a trusted connection, so the account specified in IIS for your service's app pool will be used to log into the SQL server.

The solution is to give the app pool account (IIS APPPOOL\masn) access to the `gateway` database, or change the connection string to include a user name and password that has access to it, like so:

```
<add name="gatewayConnectionString" connectionString="Data Source=.\SQLEXPRESS;Initial Catalog=gateway;User ID=someuser;Password=somepassword" providerName="System.Data.SqlClient"/> 
```

Using a trusted connection is the better way to go, since you don't have to store a password somewhere.

# mysql - 返回当前年份的所有 mySQL 记录

> ID：13592005
> 
> 赞同：18
> 
> 时间：2012-11-27T19:55:55.563
> 
> 标签：mysql

在 mySQL 中，我想返回`start_date`在当年（如 2012 年，而不是在过去一年时间段内）的记录计数和（作为单独的查询）来自前一年（现在的情况是 2011 年）。

我的开始日期是这样存储的：`2012-12-02`。我正在使用 PHP。

非常感谢我如何形成这些查询的帮助。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-11-27T20:00:33.357

```
SELECT COUNT(*)
 FROM TABLE1
 WHERE YEAR(START_DATE) = YEAR(CURDATE()); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-27T19:58:28.927

您可能希望使用[**YEAR**](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_year)函数从日期中获取 YEAR 并使用相同的比较。

```
 SELECT COUNT(*)
 FROM TABLE1
 WHERE YEAR(START_DATE) = 2012; 
```

与上一年分开查询：

```
 SELECT COUNT(*)
 FROM TABLE1
 WHERE YEAR(START_DATE) = 2011; 
```

要获得明智的年份计数：

```
 SELECT COUNT(b.YEAR), b.YEAR
 FROM TABLE1 AS a JOIN 
    (SELECT DISTINCT YEAR(START_DATE) AS YEAR from TABLE1) AS b
    ON YEAR(START_DATE) = b.YEAR
 GROUP BY b.YEAR; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-27T20:00:26.090

两个建议：

您可以使用日期过滤数据：

```
select count(*) from tbl where start_date >= '2012-01-01' 
```

或者

```
select count(*) from tbl where start_date between '2012-01-01' and '2012-12-31' 
```

此外，您可以使用以下`year()`功能过滤数据：

```
select count(*) from tbl where year(start_date) = 2012 
```

希望这可以帮助你

* * *

如果您使用 PHP（或任何其他高级编程语言），您可以在运行时构建您的查询字符串以满足您的需求（例如过滤不同年份的记录）。

要显示 2012 年之前的记录数`start_date`，只需更改`where`条件：

```
select... where year(start_date) < 2012 
```

或者

```
select... where start_date < '2012-01-01' 
```

# c#-4.0 - 在 Jenkins 和 NUnit 中调试 C#

> ID：13592012
> 
> 赞同：0
> 
> 时间：2012-11-27T19:56:37.560
> 
> 标签：c#-4.0, jenkins, jenkins-plugins, nunit-console

我需要在詹金斯开始测试 Nunit 之前启动一个调试项目，可以这样做吗？

我有一个包含 15 个项目的解决方案，如果我不开始调试 nunit 所有测试返回错误，我需要调试所有解决方案以便在 nunit 中进行测试

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-27T12:33:15.427

您可以通过添加新目标在 jenkins 中运行单元测试：

```
<target name="build-debug" description="Build and run tests">
    <echo message="Building the debug configuration" />
    <exec program="${msbuild}" commandline='"${rng-solution}" /v:m /nologo /property:WarningLevel=0 /t:Rebuild /p:Configuration="Debug" /p:Platform="Any CPU"' />
    <echo message="Running unit tests" />
    <nunit2>
        <formatter type="Plain" />
        <formatter type="Xml" outputdir="${main-directory}\BuildResults\" usefile="true" extension=".xml"/>
        <test assemblyname="${main-directory}\Projects\MyUnitTests\bin\MyUnitTests.dll">
        </test>
    </nunit2>
</target> 
```

这将运行您的单元测试。谢谢

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-10T15:37:08.797

解决方案是使用一些管道插件，毕竟它们会让你执行第一步（每个都必须是不同的工作，可能在共享工作区中），并且它们也可以是有条件的，在状态之前读取步骤。

# c# - EF5 Code First TransactionScope 无需升级到 MSDTC

> ID：13592015
> 
> 赞同：1
> 
> 时间：2012-11-27T19:56:59.853
> 
> 标签：c#, .net, entity-framework, transactionscope

我首先使用 EF5 代码，我需要`SaveChanges()`在同一个事务中包装多个调用。我对使用 transactionScope 比较陌生，似乎无法调整它的选项来完成我想要做的事情。

以下代码位于一个服务类中，该服务类被注入了我的 DbContext 类的实例。我不会在此类中的任何位置创建额外的 DbContext 实例。

起初我尝试了以下方法。代码很好很干净，但它会在函数中的`SaveChanges`方法期间尝试升级到 DTC 。`GenerateInvoice`

```
using (var scope = new TransactionScope())
{
    // This function does some work and calls SaveChanges
    Guid invoiceId = GenerateInvoice(cart);  

    // This function also does some querying and calls SaveChanges
    DeleteCart();

    // Transaction should only commit if both functions above were successful
    scope.Complete();

} 
```

我做了一些研究并将代码更改为以下不会升级为 DTC 的代码，但我不确定这是否是最好的方法。

```
IObjectContextAdapter adapter = (IObjectContextAdapter)_context;

adapter.ObjectContext.Connection.Open();

using (var scope = new TransactionScope())
{

    // This function does some work and calls SaveChanges
    Guid invoiceId = GenerateInvoice(cart);  

    // This function also does some querying and calls SaveChanges
    DeleteCart();

    // Transaction should only commit if both functions above were successful
    scope.Complete();

    adapter.ObjectContext.Connection.Close();

} 
```

`SaveChanges`有没有一种更简单的方法可以在不升级到 DTC的情况下首先通过多个 EF5 代码获得事务支持？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T20:24:22.743

不是我发现的。这也很有意义。`SaveChanges()`通过多次调用，您可能会打开与数据库的多个连接。跨这些连接协调事务的唯一方法是使用分布式事务（因此是 MSDTC）。

我能想出的最佳解决方案是只调用`SaveChanges()`一次。这可能意味着重组一些代码，但最好是所有需要事务性的实体都同时提交。

仅调用`SaveChanges()`一次还允许 EF 更改跟踪器使用其缓存并节省大量应用程序和数据库之间的通信。

# c# - 单元测试模型 - 建议

> ID：13592019
> 
> 赞同：4
> 
> 时间：2012-11-27T19:57:11.150
> 
> 标签：c#, oop, unit-testing

我有一个多人参与的项目。我一直在为我们的项目构建单元测试。（我知道这些应该从第一天开始就在那里，但我是在项目开始后加入的。）

我们有很多模型，有很多属性。我想知道您是否会建议我创建单元测试来测试这些模型是否正确实例化并设置属性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T20:03:49.003

我不会测试它们是否为 ORM 框架正确加载。但是，如果它们有一些逻辑，我会添加测试，例如：

```
private IList<User> _allUsers;

public IEnumerable<User> GetActiveUser
{
   get { return _allUsers.Where(u => u.IsActive);
} 
```

这可能需要一些测试来确保您只获得活跃用户。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T20:08:51.053

测试模型是否被您使用的任何框架或数据访问层以及模型本身内置的任何业务逻辑正确持久化。

我喜欢使用 NUnit + Fluent Assertions 在持久性操作之前和之后比较模型（例如创建和保存模型，并确保它正确检索所有值）。

请注意，它不一定是持久性。也许您的模型是一个视图模型，并由映射器从业务实体映射。我也会测试一下。基本上，您想测试模型是否正确地通过了某些层或逻辑，而不是测试模型本身（当然，除了内置的任何业务逻辑）。测试语言或框架特性/编译器是否正常工作，就像测试属性工作的情况一样，在我看来是浪费时间。

粗略的例子：

```
 // arrange
  var expected = new PersonModel
                  {
                     FirstName = "John",
                     LastName = "Doe",
                     DateOfBirth = DateTime.Now
                     // etc
                   }

   // act
   var id = InsertModelAndReturnId(expected);
   var actual = RetrieveModelById(id);

   // assert
   actual.ShouldHave().AllProperties().EqualTo(expected); // ShouldHave is from Fluent Assertions. This line makes sure expected and actual have the same values after being persisted and retrieved 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T20:19:44.630

在大多数情况下，您应该专注于逻辑而不是数据。这意味着您不应该测试**state**，而应该测试**行为**。

您的属性背后可能有一些行为。例如，改变一个属性的状态应该会影响其他一些属性的值（但在这种情况下，我们仍然会测试行为而不是状态）。

每个单元测试都应该讲述一个关于被测类的故事 (c)。太多无用的单元测试会隐藏有关系统的相关或重要信息，实际上会降低而不是增加可维护性。

务实，将测试添加到系统的最重要部分，并首先涵盖最复杂的业务逻辑，然后将它们移至系统的其他部分。

# database - 为什么 UUID 标准很复杂，我应该遵循它们吗？

> ID：13592027
> 
> 赞同：3
> 
> 时间：2012-11-27T19:57:46.707
> 
> 标签：database, standards, guid, uuid

[RFC 4122](http://www.ietf.org/rfc/rfc4122.txt)相当详细地定义了[UUID 。](http://en.wikipedia.org/wiki/Universally_unique_identifier)当前定义了 5 个变体，全部为 128 位，但位的派生方式各不相同。

为什么要关心遵守特定的变体？一旦创建了 ID，使用 UUID 的人为什么需要知道它是如何构造的？

特别是，如果我要使用变体 4（完全随机），遵循 RFC 将随机位从 128 减少到 122（变体 4b 位，保留 2 位）似乎是一种浪费。我不遵循 RFC 并使用所有 128 位随机性不是更好吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-28T08:28:16.903

如果您不遵守规则，那么您的 ID 可能会与其他算法之一生成的 ID 发生冲突。

由于某些算法（例如 v1）是确定性的，如果您的算法在版本字段中意外生成带有“1”的 GUID，攻击者可能会强制发生 GUID 冲突：他们将 MAC 地址设置为与您的 GUID 的最后一部分匹配并等待时间匹配开始部分。然后他们点击提交并繁荣，GUID 冲突，数据库爆炸，资金被转移到开曼群岛。每种算法都旨在避免与自身发生冲突，但它无法防止与其他算法发生冲突。只要遵守规则。不要试图对那些额外的 6 位鬼鬼祟祟。

# java - 将回调从 JavaScript 传递到 Java (Android)

> ID：13592029
> 
> 赞同：1
> 
> 时间：2012-11-27T19:57:55.243
> 
> 标签：java, javascript, android, cordova

我正在使用 HTML5/JavaScript 开发适用于 Android 的应用程序。遇到限制，我想从 JavaScript 中调用在 Java 代码中实现的函数。更准确地说，我想创建某种类型的对话框。这相当容易（我只会给出一个粗略的轮廓/存根）：

```
public class MyClass () {
    // other stuff

    public void createMyDialog (/* arguments */) {
        DialogBuilder builder = ...
        builder.setItems(myItems, new DialogInterface.OnClickListener () {
            @Override
            public void OnClick (DialogInterface dialog, int which) {
                droidGap.loadUrl(/* what now? */);
            }
        });
    }
} 
```

然后这个类被显示给 JavaScript

```
MyClass myClass = new MyClass();
appView.addJavascriptInterface(myClass, "myClass"); 
```

到现在为止还挺好。我现在可以`window.myClass.createMyDialog()`从 JavaScript 中访问。*但是*，我想做的是传递一个回调，该回调将使用`which`变量作为参数调用。这意味着有一个像

```
public void createMyDialog (final String callback) 
```

并用类似的东西调用它

```
window.myClass.createMyDialog(
    function (which) {
        alert(which);
    }
); 
```

我可以让它工作，我将函数作为字符串传递（在函数周围使用）并从 Java`String()`调用。`appView.loadUrl("javascript:(" + callback + ")(" + which + ");");`没关系，这个解决方案感觉不是很干净，它有一个很大的缺点 - 终于说到重点了。因为在 JavaScript 中，我实际上是`createMyDialog`从一个类中调用的，我想做这样的事情：

```
function myJSClass () {
    this.myVar = -1;

    this.myFunc = function () {
        window.myClass.createMyDialog(
            function (which) {
                this.myVar = which;
            }
        );
    }
}

var myObj = new myJSClass();
myObj.myFunc(); 
```

现在的问题是，上面的解决方案`this`将引用`window`而不是类实例。这不是一个新问题，但是没有一个典型的解决方案（`var _this = this`在调用之外存储和 using`_this.myVar = which`或 using `bind`）作为上下文`this`完全丢失，因为该函数将从 Java 调用。

我知道这必须是可能的，因为 PhoneGap 框架提供`navigator.notification.confirm`的功能几乎完全符合我的要求。去这里的路是什么？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T05:41:10.067

首先，你真的应该[写一个 Plugin](http://docs.phonegap.com/en/2.2.0/guide_plugin-development_index.md.html#Plugin%20Development%20Guide)。我们已经遇到了许多 Java/JS 和 JS/Java 问题，因此您应该利用我们测试过的代码。

其次，您将需要在 UI 线程上运行您的对话框。如果你不这样做，就会有问题。

第三，如果您想在发生对话操作时从 Java 调用特定的成功/错误回调，您可以通过 PluginResult 类来实现。如果设置成功条件，将调用成功回调，反之亦然。

查看 PG 代码以获取通知，其中包含许多对话框的示例：

[https://git-wip-us.apache.org/repos/asf?p=cordova-android.git;a=blob;f=framework/src/org/apache/cordova/Notification.java;h=958ab26b842b41326523b9fa154aa8c71885c8ab; hb=头](https://git-wip-us.apache.org/repos/asf?p=cordova-android.git;a=blob;f=framework/src/org/apache/cordova/Notification.java;h=958ab26b842b41326523b9fa154aa8c71885c8ab;hb=HEAD)

# java - 在 Java (Android) 中运行 javascript 文件

> ID：13592034
> 
> 赞同：1
> 
> 时间：2012-11-27T19:58:06.913
> 
> 标签：java, javascript, android

我有一个网站，我想从一个 android 应用程序登录，为了提交带有正确信息的 POST 请求，他们需要一些散列值。该网站的方式是通过 javascript 文件。我尝试跟踪它，但我无法获得与本地网站相同的结果。

所以我决定下载他们的javascript文件并在java中运行它。

我的问题是我无法弄清楚如何在他们的文件中运行特定的方法。

到目前为止，这是我的代码，它非常简单。

```
public void hashIt(String valueForMethod1, String valueForMethod2){
    final ScriptEngineManager sem = new ScriptEngineManager();
    ScriptEngine engine = sem.getEngineByName("JavaScript");
    try {
        engine.eval(new java.io.FileReader("res/raw/theirFile.js"));
    } catch (FileNotFoundException e) {
        e.printStackTrace();
    } catch (ScriptException e) {
        e.printStackTrace();
    }
} 
```

任何帮助将非常感激 ：）

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T20:02:10.783

您可以使用`Invocable`调用已加载的 Javascript 的方法

```
Invocable inv = (Invocable) engine;
inv.invokeFunction("foo", "bar"); // invoke foo("bar") 
```

请参阅此[页面](http://docs.oracle.com/javase/6/docs/technotes/guides/scripting/programmer_guide/index.html#invoke)以获取更深入的介绍

**编辑**

正如 Morrison Chang 所说，显然`javax.script`Android 上没有命名空间，因此您可以查看他在评论中提供链接的线程。

# xml - 如何从 Pentaho 报告中引入 XML

> ID：13592036
> 
> 赞同：0
> 
> 时间：2012-11-27T19:58:12.727
> 
> 标签：xml, xsd, olap, pentaho, mondrian

在我环顾 Pentaho 应用程序/插件之后。有许多与 Pentaho 报告相关的应用程序/插件。有谁知道，如果我想要能够链接 Pentaho 报告（甚至是我的数据库来构建报告）的 XML，我需要使用什么应用程序或插件来将 XML 带出并在第三方中使用应用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T10:54:16.353

正如我在这个答案中解释的那样

[我如何在 Saiku 中管理示例数据源](https://stackoverflow.com/questions/15828780/how-i-manage-the-sample-datasource-in-saiku/15830354?noredirect=1#comment22596471_15830354)

-您必须在管理面板中为数据库创建 JNDI 连接，然后才能在双服务器用户面板中可视化 xml 文件。

# php - php。延期。调用现有的 PHP 函数

> ID：13592037
> 
> 赞同：19
> 
> 时间：2012-11-27T19:58:21.273
> 
> 标签：php, c, php-extension

所以我决定为php写一个扩展。一切似乎都很好，只是我遇到了一个小问题。

我`php-5.4.9`有源代码。有`ext/standard/mail.c`很棒的功能的文件

```
PHPAPI int php_mail(char *to, char *subject, char *message, char *headers, char *extra_cmd TSRMLS_DC) 
```

在我的扩展中，`acme.c`我包含

```
...
#include "php.h"
#include "ext/standard/php_mail.h"
#include "php_ini.h"
... 
```

所以`php_mail`感觉很好，工作正常。但是，很明显，我想使用从`mail.c`第 101 行开始到第 189 行结束的代码（[http://pastie.org/5444192](http://pastie.org/5444192) 5-93 粘贴中的相应行）。所以我突然想到了（虽然在某些方面很尴尬）为什么不打电话`PHP_FUNCTION(mail)`？到那时我找不到那个宏，实际上我想知道实现这个想法的最佳方法。

我的内部 zend 工程师（新手）建议我使用[call_user_function](http://www.php-editors.com/php_manual/zend-api.call-user-function.html)

```
ZEND_API int call_user_function(HashTable *function_table, zval **object_pp, zval *function_name, zval *retval_ptr, zend_uint param_count, zval *params[] TSRMLS_DC); 
```

但我不知道如何调用它。

问题！**如何（非常**`mail`欢迎使用函数示例）调用由 ? 定义的函数？**`PHP_FUNCTION`**

 *** * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-11-27T21:28:05.337

弄清楚函数如何工作的最简单方法是在 lxr.php.net 上搜索它。出现的第一个示例在 readline 中：http: [//lxr.php.net/xref/PHP_TRUNK/ext/readline/readline.c#474](http://lxr.php.net/xref/PHP_TRUNK/ext/readline/readline.c#474)

for 的用法`mail`类似。给定 zvals ( `to_zval`, `from_zval`, `msg_zval`) 的参数，调用非常简单：

```
zval *params = { to_zval, from_zval, msg_zval };
zend_uint param_count = 3;
zval *retval_ptr;

zval function_name;
INIT_ZVAL(function_name);
ZVAL_STRING(&function_name, "mail", 1);

if (call_user_function(
        CG(function_table), NULL /* no object */, &function_name,
        retval_ptr, param_count, params TSRMLS_CC
    ) == SUCCESS
) {
    /* do something with retval_ptr here if you like */
}

/* don't forget to free the zvals */
zval_ptr_dtor(&retval_ptr);
zval_dtor(&function_name); 
```

如果您还没有 zvals 参数，那么您可以使用`MAKE_STD_ZVAL`and创建它们`ZVAL_STRING`。**

# c# - XNA Game Studio 4.0 碰撞问题我不知道为什么我的脚本不工作

> ID：13592043
> 
> 赞同：0
> 
> 时间：2012-11-27T19:58:33.163
> 
> 标签：c#, xna-4.0

好的，所以我正在制作一个 2d 游戏，我也是新的病态复制/粘贴我的整个 Game.cs 脚本除了 Program.cs 之外，我的项目中没有其他分类

```
public class Game1 : Microsoft.Xna.Framework.Game
{
    GraphicsDeviceManager graphics;
    SpriteBatch spriteBatch;

    public Game1()
    {
        graphics = new GraphicsDeviceManager(this);
        Content.RootDirectory = "Content";
    }

    protected override void Initialize()
    {

        base.Initialize();
    }

    bool hasJumped = true;

    Vector2 velocity;
    Texture2D player;
    Texture2D ground1;

    Vector2 playerPosition = new Vector2(30, 30);
    Vector2 ground1p1 = new Vector2(0,430);
    Vector2 ground1p2 = new Vector2(200,430);
    Vector2 ground1p3 = new Vector2(0, 310);
    Vector2 ground1p4 = new Vector2(200, 310);

    protected override void LoadContent()
    {
        spriteBatch = new SpriteBatch(GraphicsDevice);

        player = Content.Load<Texture2D>("Player");
        ground1 = Content.Load<Texture2D>("Ground1");

    }

    protected override void UnloadContent()
    {

    }

    protected override void Update(GameTime gameTime)
    {
        KeyboardState newState = Keyboard.GetState();

        if ((playerPosition.Y > 0) && (playerPosition.Y < graphics.GraphicsDevice.Viewport.Height-player.Height))
        {

            playerPosition += velocity;

        }

        if (Keyboard.GetState().IsKeyDown(Keys.Right)&&playerPosition.X <=(graphics.GraphicsDevice.Viewport.Width-player.Width))
        {

                velocity.X = 3f;

        }

        else if (Keyboard.GetState().IsKeyDown(Keys.Left) && (playerPosition.X >= 0))
        {

                velocity.X = -3f;

        }
        else velocity.X = 0f;
        if (Keyboard.GetState().IsKeyDown(Keys.Up)&& hasJumped==false)
        {
            playerPosition.Y -= 10f;
            velocity.Y = -4f;
            hasJumped = true;
        }
        if (hasJumped==true)
        {
            velocity.Y += 0.10f;
        }
        if (DetectPlayerAndGround1Collision2(playerPosition,ground1p1,player,ground1) == true)
        {
            hasJumped = false;
            velocity.Y = 0f;
        }
        if (DetectPlayerAndGround1Collision2(playerPosition, ground1p2, player, ground1) == true)
        {
            hasJumped = false;
            velocity.Y = 0f;
        }

        if (hasJumped == false)
        {
            velocity.Y = 0f;
        }

        base.Update(gameTime);
    }

    protected override void Draw(GameTime gameTime)
    {
        GraphicsDevice.Clear(Color.CornflowerBlue);

        spriteBatch.Begin(SpriteSortMode.BackToFront, BlendState.AlphaBlend);
        spriteBatch.Draw(ground1,ground1p1 , Color.White);
        spriteBatch.Draw(ground1, ground1p2, Color.White);

        spriteBatch.Draw(ground1, ground1p4, Color.White);

        spriteBatch.Draw(player, playerPosition, Color.White);
        spriteBatch.End();
        base.Draw(gameTime);
    }

 public Boolean DetectPlayerAndGround1Collision2(Vector2 playerPositionM,Vector2 groundPositionM,Texture2D playerM,Texture2D groundM)
    {

        if (playerPositionM.Y <= groundPositionM.Y + groundM.Height && playerPositionM.Y > groundPositionM.Y)
        {   
            if (playerPositionM.X < groundPositionM.X && (playerPositionM.X + playerM.Width < groundPositionM.X + groundM.Width && playerPositionM.X + playerM.Width > groundPositionM.X)) { return true; }
            else if (playerPositionM.X + playerM.Width > groundPositionM.X + groundM.Width && (playerPositionM.X < groundPositionM.X + groundM.Width && playerPositionM.X > groundPositionM.X)) { return true; }
            else if ((playerPositionM.X > groundPositionM.X && playerPositionM.X < groundPositionM.X + groundM.Width) && (playerPositionM.X + playerM.Width < groundPositionM.X + groundM.Width && playerPositionM.X + playerM.Width > groundPositionM.X)) { return true; }
        }
    }

} 
```

有人能告诉我为什么当我在它的边缘时我从我的“ground1”精灵中掉下来吗？我完全不知道我的剧本有多么错误我最后的希望是问一个比我更熟练的人，或者我可能是盲人，我看不到什么愚蠢的谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T21:29:17.917

当您尝试检测正方形 A 与正方形 B 的碰撞时，您需要注意很多点。

以一个简单的物理系统为例，其中盒子 A 可以上升并且必须下降，并且我们正在尝试检查盒子 A 的底部与盒子 B 的碰撞，那么您需要先检查 A 和 B 的两个点您可以确定碰撞。

我将把这两个点定义为 AO（A 原点左下角）和 AE（A 扩展右下角）。“地面”也存在相同的两个点。

在运动中，除非盒子 A 的移动速度非常慢，否则你可能会在坠落时垂直落入盒子 B 的边界内。所以首先你需要看看盒子A的底部是接触还是穿过盒子B的顶部：

```
A.O.Y <= B.E.Y && A.O.Y > B.O.Y 
```

现在，如果返回为假，那么我们仍在下降，如果返回为真，我们要么在 B 的顶部，要么在 B 的内部。

现在你知道你在正确的高度或在平台内，你可以开始检查 A 是否在 B 的顶部：

挂在左边缘，或中间某处，但不在右侧：

```
A.O.X < B.O.X && (A.E.X < B.E.X && A.E.X > B.O.X) 
```

挂在右侧边缘，或中间某处，但不在左侧：

```
A.E.X > B.E.X && (A.O.X < B.E.X && A.O.X > B.O.X) 
```

中间某处：

```
(A.O.X > B.O.X && A.O.X < B.E.X) && (A.E.X < B.E.X && A.E.X > B.O.X) 
```

如果这些条件之一为真，则其他两个为假，因此将它们放在一起检查所有三个：

```
 EDIT:

flag = false

        If A.O.Y <= B.E.Y && A.O.Y > B.O.Y THEN
            If A.O.X < B.O.X && (A.E.X < B.E.X && A.E.X > B.O.X) THEN
                set flag to true
            ELSE IF A.E.X > B.E.X && (A.O.X < B.E.X && A.O.X > B.O.X) THEN
                set flag to true
            ELSE IF (A.O.X > B.O.X && A.O.X < B.E.X) && (A.E.X < B.E.X && A.E.X > B.O.X) THEN
                set flag to true

return flag 
```

因此，阅读以上内容，我们首先检查您是否垂直在平台上。然后我们按顺序检查，挂在左边缘？悬在右边缘？在界限内？如果这三个中的任何一个为真，我们将其发回，否则我们返回假。

我希望这会有所帮助。

# ios - iOS - 延迟符号绑定失败

> ID：13592044
> 
> 赞同：0
> 
> 时间：2012-11-27T19:58:34.270
> 
> 标签：ios

我的 iOS 5.1 设备/模拟器上出现此错误。在 iOS 5.0 和 6.0 上没有发生。它发生在这一行之后：

```
[(MyAppAppDelegate *)[UIApplication sharedApplication].delegate callFullScreenView:viewController.view]; 
```

由于某种原因，它无法访问 callFullScreenView 并触发此错误：

```
dyld: lazy symbol binding failed: Symbol not found: _objc_setProperty_nonatomic
  Referenced from: /var/mobile/Applications/86A386A7-C779-4E3C-9FA2-894B33D22806/MyApp.app/MyApp
  Expected in: /usr/lib/libobjc.A.dylib

dyld: Symbol not found: _objc_setProperty_nonatomic
  Referenced from: /var/mobile/Applications/86A386A7-C779-4E3C-9FA2-894B33D22806/MyApp.app/MyApp
  Expected in: /usr/lib/libobjc.A.dylib 
```

有任何想法吗？

问候！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T13:49:18.680

我已经多次遇到此错误......如果您遇到此错误，请将您的部署目标设置为 4.3。默认为 6 最新版本。

仅供参考：这是重复：

[ARC 适用于 iOS 6 但不适用于 iOS5.1](https://stackoverflow.com/questions/13657770/arc-is-working-in-ios-6-but-not-work-in-ios5-1)

# android - Android 4.0+ VoiceMailContract 没有显示正确的结果

> ID：13592046
> 
> 赞同：-2
> 
> 时间：2012-11-27T19:58:58.053
> 
> 标签：android, voicemail

Android 语音邮件合同代码：

```
 public void voiceMail(Context ctx) {
    if (Build.VERSION.SDK_INT >= 14) {
        try {
            final String selection = VoicemailContract.Voicemails.IS_READ + "=0";
            final String sortOrder = VoicemailContract.Voicemails.DATE + " DESC";
            String uri = VoicemailContract.Voicemails.CONTENT_URI + "?"
                    + VoicemailContract.PARAM_KEY_SOURCE_PACKAGE + "="
                    + getPackageName();
            Cursor cursor = ctx.getContentResolver().query(Uri.parse(uri), null,
                    selection, null, sortOrder);
            TextView tv = (TextView)findViewById(R.id.textView1);
            tv.setText("You have "+cursor.getCount()+" voice mail");
            cursor.close();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
} 
```

它总是向我显示 0 个语音邮件，我也想集成谷歌语音邮件，提前谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T22:18:39.303

对我有用的代码：

```
 Cursor cursor = null;
    try {
        cursor = mContentResolver.query(mBaseUri, FULL_PROJECTION,
                filter != null ? filter.getWhereClause() : null,
                null, getSortBy(sortColumn, sortOrder));
        while (cursor.moveToNext()) {
            // A performance optimisation is possible here.
            // The helper method extracts the column indices once every time it is called,
            // whilst
            // we could extract them all up front (without the benefit of the re-use of the
            // helper
            // method code).
            // At the moment I'm pretty sure the benefits outweigh the costs, so leaving as-is.
        }
        Log.v(TAG,"Unread Voicemails:"+cursot.getCount());
        return results;
    } finally {
        cursor.close();
    } 
```

我只需要更改内容uri，但仍然间接相同，但它也对我有用，您也可以参考android sdk中“VoicemailProviderDemo”的示例项目

注意：此代码仅适用于 android 4.0+

# asp.net - 如何在VB中创建一个带有超链接的li

> ID：13592047
> 
> 赞同：-4
> 
> 时间：2012-11-27T19:59:01.880
> 
> 标签：asp.net, vb.net

我只想知道如何在 Visual Basic 中创建带有超链接的 li

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T00:11:35.300

```
<ul>
   <li><asp:HyperLink id="HyperLink1" runat="server" NavigateUrl="~/Default.aspx" /></li>
</ul> 
```

# asp.net-mvc-4 - MVC 模型实例化

> ID：13592056
> 
> 赞同：3
> 
> 时间：2012-11-27T19:59:32.013
> 
> 标签：asp.net-mvc-4, html.dropdownlistfor, asp.net-mvc-viewmodel

我没有掌握 MVC 模型的一些概念基础知识，我希望得到一些有用的澄清。

在我的 MVC 4 Web 应用程序中，我有一个为 DropDownList 构建 IEnumerable<SelectListItem> 的视图模型，如果我在视图中执行此操作：

```
@model MyApp.Models.MyModel

@Html.DropDownListFor(x => x.MyThingID, Model.MySelectList, "Select...") 
```

我收到“对象引用未设置为对象的实例”错误。

但如果我这样做：

```
@model MyApp.Models.MyModel

@{ var myModel = new MyApp.Models.MyModel(); }
@Html.DropDownListFor(x => x.MyThingID, myModel.MySelectList, "Select...") 
```

有用。但是这种显式实例化对我来说看起来和感觉都非常错误，我不确定我是否应该在控制器中做任何事情，此时这只是一个简单的“返回 View()”ActionResult。

我找不到太多好的指导，最终我正在尝试实现一些级联下拉菜单，所以我需要更好地了解它是如何工作的。如果您有时间和意愿提供帮助，我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T20:01:33.857

您应该将模型传递给视图。您可以在控制器代码中执行此操作：

```
return View(myModel); 
```

代替

```
return View(); // without the model! 
```

你的模型是 MyApp.Models.MyModel 的类型。只需初始化它并通过它。

```
public ActionResult YourAction()
{
    var myModel = new MyApp.Models.MyModel();
    // do other actions or put more data inside myModel
    return View(myModel);
} 
```

# java - Java 说这 2 个 Date 对象不相等

> ID：13592063
> 
> 赞同：4
> 
> 时间：2012-11-27T20:00:03.467
> 
> 标签：java, date

我正在使用 Gson 将 java.util.Date 对象转换为 Json，然后将 Json 转换回 java.util.Date 对象：

```
 Date date = new Date();
    System.out.println("date=" + date + "; date.getTime()=" + date.getTime());
    String json = gson.toJson(date);
    System.out.println("date in json format=" + json);
    Date newDate = gson.fromJson(json, Date.class);
    System.out.println("newDate=" + newDate + "; gettime=" + date.getTime());
    if (!newDate.equals(date)) {
        System.out.println("dates are not the same - bad");
    }
    else
        System.out.println("dates are the same - good"); 
```

2 个 Date 对象应该相等，但从输出中可以看出，它们不是：

```
date=Fri Nov 23 12:18:21 EST 2012; date.getTime()=1353691101023
date in json format="Nov 23, 2012 12:18:21 PM"
newDate=Fri Nov 23 12:18:21 EST 2012; gettime=1353691101023
dates are not the same - bad 
```

当 Date.equals() 方法的 Javadoc 说“当且仅当 getTime 方法为两者返回相同的 long 值时，两个 Date 对象相等”时，Date 对象如何不同？从输出中可以看出，两个 Date 对象都为 getTime() 返回相同的值。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-27T20:01:43.543

错误对象的第三次`println()`打印：`getTime()`

```
System.out.println("newDate=" + newDate + "; gettime=" + date.getTime());
                                                         ^^^^ should be newDate 
```

我怀疑一旦你打印出来`newDate.getTime()`，你会发现它与`date.getTime()`.

# c# - 在 Membership.ValidateUser 中获取用户组

> ID：13592064
> 
> 赞同：1
> 
> 时间：2012-11-27T20:00:04.920
> 
> 标签：c#, asp.net, membership-provider, custom-membershipprovider

我正在使用表单身份验证和成员资格提供程序。当我调用 Membership.ValidateUser(logon.UserName,logon.Password) 时，它只返回一个布尔值，指示该用户是否有效。但我希望用户被退回。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T20:26:43.547

```
 string userName = "someuser";
        string password = "";
        MembershipUser user = null;
        if (Membership.ValidateUser(userName,password))
        {
            user = Membership.GetUser(userName);
        } 
```

# c# - 将类型 'System.Dynamic.DynamicObject 转换为 System.Collections.IEnumerable

> ID：13592065
> 
> 赞同：10
> 
> 时间：2012-11-27T20:00:08.087
> 
> 标签：c#, javascriptserializer, dynamicobject

我成功地使用 MVC3 中的 JavaScriptSerializer 将 json 字符串反序列化为动态对象。我不知道如何将它转换为我可以枚举的东西。下面的 foreach 代码行是我的最新尝试，但它错误：“无法将类型'System.Dynamic.DynamicObject'隐式转换为'System.Collections.IEnumerable'。如何转换或转换以便可以遍历字典?

```
 public dynamic GetEntities(string entityName, string entityField)
        {
           var serializer = new JavaScriptSerializer();
            serializer.RegisterConverters(new[] { new                        MyProject.Extensions.JsonExtension.DynamicJsonConverter() });
           dynamic data = serializer.Deserialize(json, typeof(object));
           return data;
        }

 foreach (var author in GetEntities("author", "lastname")) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-29T10:55:48.963

鉴于您对“GetEntities”的示例用法，请尝试将其返回类型更改为`IEnumerable<T>`（或者，尽管强烈不推荐，但至少为`IEnumerable<dynamic>`）。您需要在方法中进行一些过滤，以根据“entityName”输入参数提取适当的实体。虽然，尚不清楚其他输入参数（'entityField'）的预期用途是什么。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-29T20:50:31.787

DynamicObject 继承自 IDictionary，因此您可以将其强制转换为 IDictionary。

```
public IDictionary<string, object> GetEntities(string entityName, string entityField)
    {
       var serializer = new JavaScriptSerializer();
        serializer.RegisterConverters(new[] { new MyProject.Extensions.JsonExtension.DynamicJsonConverter() });
       dynamic data = serializer.Deserialize(json, typeof(object));
       return data as IDictionary<string, object>;
    }

foreach (var author in GetEntities("author", "lastname")) 
```

# php - 从查询中以模态显示数据

> ID：13592066
> 
> 赞同：2
> 
> 时间：2012-11-27T20:00:12.907
> 
> 标签：php, ajax, twitter-bootstrap, modal-dialog

我有这张表，里面有数据和一个链接，可以在模式中显示详细信息

```
<td><a data-toggle="modal" class="btn" href="#modal_detail" id="<?php echo $rows['id']; ?>">Detail</a></td> 
```

这是模态

```
<div id="modal_detail" class="modal hide fade">
    <div class="modal-header">
      <button class="close" data-dismiss="modal">&times;</button>
      <h3>Detail Product</h3>
    </div>
    <div class="modal-body">            
        <div id="modalContent" style="display:none;">
        Here i want to display data from query about the detail of a product (name, price etc)      
        </div>
    </div>
    <div class="modal-footer">
      <a href="#" class="btn btn-info" data-dismiss="modal" >Close</a>
    </div>
</div> 
```

这是php文件

```
if(isset($_GET['detail'])) {
    include_once('../libs/class.database.php');
    $k = new Database();
    $link=$k->connect(); 
    $query = $link->query("SELECT name,price FROM products ORDER BY date_created ASC");
    $result=$query->fetchAll();
} 
```

对于javascript如下

```
$("a[data-toggle=modal]").click(function() {
    var id_beli = $(this).attr('id');

    $.ajax({
        cache: false,
        type: 'GET',
        url: 'controller/modalPembelian.php',
        data: 'detail=' + id_beli,
        success: function(data) {
            $('#modal_detail').show();
            $('#modalContent').show().html(data); //this part to pass the var
        }
    });
}); 
```

我的问题是如何将 php 文件（产品详细信息）中的查询数据显示到模态窗口中。模态很好，它可以显示和隐藏，但数据不在那里。

我尝试了很多方法并搜索教程，但它仍然是一样的。

谁能告诉我一些如何使用 ajax 将数据显示到 twitter 引导模式中的示例。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-12-21T16:56:57.010

您还可以使用并`find()`放置`data``html()`

```
success: function (data) {
   console.log(data);
   modal.find('#modalContent').html(data);
} 
```

此处的完整描述：[使用带有 AJAX 的 Bootstrap Modal 从 MySQL 导入数据](http://thecomputerstudents.com/web/using-bootstrap-modal-ajax-import-data-mysql/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T21:42:22.250

查看[jschr 的引导模式](http://jschr.github.com/bootstrap-modal/)

它是一个引导模式插件，允许您使用 ajax 调用将数据插入到模式中，并在我们等待数据被检索时显示加载图像。

我正在考虑的另一种方法是使用事件来尝试加载数据，这是一个示例，未经过 100% 测试，但我相信它应该可以工作

```
$('#modal_detail').on('show', function(){
  var id_beli = $(this).attr('id');
  $('#modalContent').html('Loading..')

  $.ajax({
      cache: false,
      type: 'GET',
      url: 'controller/modalPembelian.php',
      data: 'detail=' + id_beli,
      success: function(data) {
        $('#modalContent').html(data); //this part to pass the var
      }
  });
}) 
```

# jquery - AJAX 不工作后 jQuery 弹出对话框关闭

> ID：13592071
> 
> 赞同：1
> 
> 时间：2012-11-27T20:00:42.050
> 
> 标签：jquery, asp.net, jquery-ui, razor, popup

我在论坛上发现了同样的问题，但无论如何我都无法修复它我有一个登录表单。就像是：

```
 @using (Ajax.BeginForm("LogIn", "Account", null, new AjaxOptions
    {
        HttpMethod = "Post",
        UpdateTargetId = "result",
        InsertionMode = InsertionMode.Replace,
        LoadingElementId = "loginspinner",
        OnSuccess = "OnTryLogin"
    }, new { id = "loginform"}))
    {
        <div>
            <div class="editor-field">
                @Html.TextBoxFor(m => m.UserName, new { id = "loginusername"})
                @Html.ValidationMessageFor(m => m.UserName)
            </div>
.............................. 
```

我显示弹出窗口（部分视图），例如：

```
$.get(loginaction, function (data) {
            var div;
            var divId = '#popupforlogin';
            div = $(divId);
            $(div).html(data);
            $(div).dialog({
                modal: true,
                resizable: false,
                autoOpen: false,
            });
            $(div).dialog('open');
            // ....
} 
```

我有：

```
function OnTryLogin(result) {
            if (result.success == true) {
                var fullPath = '@Url.Content("~/Account")' + '/LogOff';
                var userName = result.userName;
                $('#popupforlogin').dialog('close');
                //......
} 
```

所以问题是它`dialog('close')`不起作用。

我错在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T20:21:36.227

你实际上应该用来`$('#popupforlogin').dialog({ autoOpen: false });`初始化它。然后您可以使用`$('#popupforlogin').dialog('open');`打开对话框并`$('#popupforlogin').dialog('close');`关闭它。

从[这里](https://stackoverflow.com/questions/366854/jquery-ui-dialog-box-close-function)

# .net - 基于任务的异步模式的“Hello World”？

> ID：13592075
> 
> 赞同：6
> 
> 时间：2012-11-27T20:00:57.993
> 
> 标签：.net, multithreading, task-parallel-library

由于基于任务的异步模式现在是推荐的路线（根据 MSDN @ [here](http://msdn.microsoft.com/en-us/library/hh156548.aspx)和[here](http://msdn.microsoft.com/en-us/library/hh873175.aspx)），我将如何将`hello world`下面的简单代码转换为基于任务的异步模式？

让我们假设我对此一无所知`Tasks`，并且我试图演示工作人员的输入和输出以及从“主”调用。

```
class Program
{
    static void Main(string[] args)
    {
        Worker wk = new Worker();
        string result = wk.DoWork(1000);
        Console.WriteLine(result);
        Console.WriteLine("Main says, Hello World!");
        Console.ReadLine();
    }

}
class Worker
{
    public string DoWork(int delay)
    {
        Console.WriteLine("Worker says, working ...");
        Thread.Sleep(delay); // represents the 100ms+ workload            
        return "Worker says, I'm done! Hello World!";
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-28T18:18:44.923

这取决于您到底想要做什么异步。如果`Thread.Sleep()`代表一些 CPU 密集型工作，那么您不会从使用 TAP 中获得太多收益。

如果你想让等待内部`DoWork()`异步，这意味着将签名从更改`string`为`async Task<string>`，然后使用`await Task.Delay()`而不是`Thread.Sleep()`。

如果您还想进行`Main()`异步操作，则可以，如果您使用的是 C# 7.1 或更高版本。

如果您使用的是旧版本的 C#，那么它就变成了。您可以做的是在实际中创建异步`MainAsync()`然后同步。这意味着主线程将被阻塞，但我们需要它来保持应用程序处于活动状态。此外，将异步与同步混合通常不是一个好主意（尤其是因为它经常导致死锁），但在这种情况下没关系。`Wait()``Main()``await``Wait()`

如果我们使`Main()`异步，那么阻塞`ReadLine()`异步也很好。没有`Console.ReadLineAsync()`，但我们可以使用`Console.In`它。

因此，最终代码如下所示：

```
class Program
{
    static void Main()
    {
        MainAsync().Wait();
    }

    static async Task MainAsync()
    {
        var worker = new Worker();
        string result = await worker.DoWork(1000);
        Console.WriteLine(result);
        Console.WriteLine("Main says, Hello World!");
        await Console.In.ReadLineAsync();
    }
}

class Worker
{
    public async Task<string> DoWork(int delay)
    {
        Console.WriteLine("Worker says, working ...");
        await Task.Delay(delay); // represents the 100ms+ workload
        return "Worker says, I'm done! Hello World!";
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-28T07:25:09.577

我了解您想`DoWork()`在单独的线程上执行并返回结果。虽然荒谬，因为在这个例子中线程不会实现任何东西，下面是这个的代码。

```
class Program
{
    static void Main(string[] args)
    {
        Worker wk = new Worker();
        Task<string> task = Task.Factory.StartNew(() => wk.DoWork(1000));
        Console.WriteLine(task.Result);
        Console.WriteLine("Main says, Hello World!");
        Console.ReadLine();
    }

} 
```

`Task.Factory.StartNew()`接受委托并立即开始在单独的线程上执行它。它返回一个`Task`表示操作的对象。 `task.Result`将阻塞当前线程，直到`DoWork()`返回。

# jquery-ui - 在 YUI 3.1.2 中可调整大小

> ID：13592076
> 
> 赞同：1
> 
> 时间：2012-11-27T20:01:12.420
> 
> 标签：jquery-ui, resize, yui, yui3, yui2

我需要将我的代码库从使用 jQuery (1.7.2) 和 jQueryUI (1.8.6) 组件切换到等效的 YUI 组件；并且根据客户限制，它必须是 3.1.2 版本。

但是，我没有找到任何可以在 3.1.2 版本中调整元素大小的内容（其中包含似乎存在的 3.1.2 唯一文档）。

jQuery 调整大小如下所示：

```
$J = jQuery.noConflict(true);
$J("#myElement").resizable('destroy'); 
```

[YUI 2 调整大小](http://developer.yahoo.com/yui/resize/)如下所示：

```
new YAHOO.util.Resize('myElement'); 
```

[YUI 3 Resize](http://yuilibrary.com/yui/docs/resize/)看起来像这样（但没有出现在 3.1.2 中）：

```
YUI().use('resize', function(Y) { $Y = Y; });
new $Y.Resize({node: '#myElement'}); 
```

**我如何在 YUI 3.1.2 中做到这一点？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T20:37:08.563

有两个问题。

首先，调整大小模块从 YUI 3.3.0 开始可用。

其次，即使调整大小可用，上面的代码实际上也不起作用。您需要在 use() 函数回调中调用 YUI 方法*，*如下所示：

```
YUI().use('resize', function (Y) {
    new Y.Resize({ node: '#myElement' });
}); 
```

有关工作示例，请参阅[Resize 的文档，并确保在继续之前](http://yuilibrary.com/yui/docs/resize/)[阅读 use() 方法和 YUI 全局对象](http://yuilibrary.com/yui/docs/yui/index.html)。

# r - ifelse：将 1 列中的条件分配给另一列和多个语句

> ID：13592077
> 
> 赞同：0
> 
> 时间：2012-11-27T20:01:12.957
> 
> 标签：r

我有一个data.frame。我正在尝试使用第 2、3、4 列中的值在 col1 中分配一个值。这可能吗？

```
dat<-data.frame(col1=c(1,2,3,4,5), col2=c(1,2,3,4,"U"), col3=c(1,2,3,"U",5), col4=c("U",2,3,4,5))
dat1=data.frame(col1=ifelse(dat$col2=="U"|dat$col3=="U"|dat$col4=="U", dat$col1=="U", dat$col1))

col1
0
2
3
0
0 
```

为什么我在 U 应该在的地方得到一个 0？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T20:04:59.483

不要在`ifelse`函数内赋值。

```
dat1=data.frame(col1=ifelse(dat$col2=="U"|dat$col3=="U"|dat$col4=="U", 
                "U", 
                dat$col1))
dat1
  col1
1    U
2    2
3    3
4    U
5    U 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T20:37:09.700

你可能想使用这个：

```
 dat1 <- data.frame(col1=ifelse(dat$col2=="U"|dat$col3=="U"|dat$col4=="U", "U", dat$col1))
    # I changed the dat$col1=="U"  to just  "U" 
```

* * *

如果问题是`"Why am I getting a 0 where a U should be?"`答案，则取决于您为`ifelse(.)`语句的 if-TRUE 部分分配的内容。

你的 ifelse 声明基本上说

```
 if any of columns 2 through 4 are U
 then assign the value of `does column 1 == "U"`   <-- Not sure if this is what you want
 else assign the value of column 1 
```

因此，当您的 ifelse 测试评估为 时`TRUE`，您返回的是 的值`col1=="U"`，但被强制转换为整数。即：0 为 FALSE，1 为 TRUE

您还可以利用 T/F 被评估为 1/0 来清理您的代码：

```
 # using the fact that rowSums(dat[2:4]=="U") will be 0 when "U" is not in any column:
 ifelse(rowSums(dat[2:4]=="U")>0, "U", dat$col1) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T20:21:28.490

`any()`让这样的事情更整洁

```
head(dat)
  col1 col2 col3 col4
1    1    1    1    U
2    2    2    2    2
3    3    3    3    3
4    4    4    U    4
5    5    U    5    5

apply(dat,1, function(x)any(x=='U'))
[1]  TRUE FALSE FALSE  TRUE  TRUE
dat[apply(dat,1, function(x)any(x=='U')), 1] <-'U'

dat
  col1 col2 col3 col4
1    U    1    1    U
2    2    2    2    2
3    3    3    3    3
4    U    4    U    4
5    U    U    5    5 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-27T20:37:06.957

一个简单的方法是：

```
dat$col1[as.logical(rowSums(dat[-1]=="U"))] <- "U"

  col1 col2 col3 col4
1    U    1    1    U
2    2    2    2    2
3    3    3    3    3
4    U    4    U    4
5    U    U    5    5 
```

# r - 向ggplot添加点时如何将x和y坐标作为变量？

> ID：13592082
> 
> 赞同：0
> 
> 时间：2012-11-27T20:01:28.307
> 
> 标签：r, ggplot2

我正在向 ggplot 添加一个点，如何将 x 和 y 坐标作为变量？我试过这段代码，但它不起作用

```
func <- function(data){

  meanx <- mean(data[,1])
  meany <- mean(data[,2])

  p <- ggplot(data, aes(x = data[,1], y = data[,2]))
  p + 
  geom_point(size = 5, shape = 19, color = "#00FF00",
         aes(x = meanx, y = meany))

}

func(iris) 
```

我有以下错误：

```
Error in eval(expr, envir, enclos) : object 'meanx' not found 
```

任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T20:13:40.950

一种解决方案是更换

```
geom_point(size = 5, shape = 19, color = "#00FF00", aes(x = meanx, y = meany)) 
```

和

```
annotate("point",size = 5, shape = 19, color = "#00FF00", x = meanx, y = meany) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T20:25:15.710

错误消息是由于数据帧`meanx`而`meany`不是数据帧的一部分，该数据帧在函数`data`中指定为参数的值。`data``ggplot`

如果您将参数添加`data = data.frame(meanx, meany)`到`geom_point`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T20:40:51.483

一种选择是使用`aes_string`，就像 Justing 说的那样。这正是您所要求的，使用字符串来分配美学。但是，正如 Sven 建议的那样，最好将 meanx 和 meany 放入 data.frame 中。

# c++ - 在工作中遇到这个“operator ClassName *”。这是什么意思？

> ID：13592084
> 
> 赞同：5
> 
> 时间：2012-11-27T20:01:31.460
> 
> 标签：c++

带有此代码的类是 ClassName 指针的引用类，即：

```
class ClassName;

class ClassRef
{
    ClassName* m_class;
    ...
    operator ClassName *() const { return m_class; }
... 
```

我假设这用于指针有效性检查，例如：

```
ClassRef ref(new ClassName())
if (ref) { bla bla bla } 
```

我的想法正确吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-27T20:03:54.473

这是转换运算符的重载。每当`ClassRef`需要将对象转换为`ClassName`指针类型时，都会调用此运算符。

所以;

```
ClassRef r;
ClassName * p = r; 
```

将利用这个重载。

# python - 端口扫描后 Python 网络套接字崩溃

> ID：13592087
> 
> 赞同：2
> 
> 时间：2012-11-27T20:01:40.407
> 
> 标签：python, networking, port, port-scanning

关于这个问题： [多端口网络应用程序](https://stackoverflow.com/questions/13130116/multi-port-network-application)

我要感谢**abarnert**给予我的所有帮助。现在的问题是程序崩溃并给了我：

错误：[错误 104] 对等方重置连接

当我对正在运行的 python 服务进行端口扫描时，就会发生这种情况。

# haskell - Haskell中的强制定向布局

> ID：13592088
> 
> 赞同：-1
> 
> 时间：2012-11-27T20:01:43.013
> 
> 标签：haskell

我在 Haskell 中实施 Force Directed Layout 时遇到了一些麻烦。该算法基于将整个图视为一个物理系统，将力施加到节点上，将它们拉得更近或推得更远。对 Haskell 来说很新，所以你能告诉我在 Haskell 中绘制图形、对象和可视化事物的模块。或者从这个算法开始的一些想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T21:31:22.480

> 绘制图形的模块

也许是[graphviz](http://hackage.haskell.org/package/graphviz)，或者对于更完整的解决方案，您可以尝试[force-layout](http://hackage.haskell.org/package/force-layout)，这是 Google 上第一次点击“force layout haskell”。

# mongodb - 用另一个列表（MongoDB 或 Scala）替换模型子列表

> ID：13592090
> 
> 赞同：2
> 
> 时间：2012-11-27T20:01:43.993
> 
> 标签：mongodb

我的文档结构如下：

```
{
   "name":"CategoryChildLevel2",
   "parentId":"2",
   "otherAttribute":"anyVal",
   "breadcrumb":[
      {
         "name":"RootCategory",
         "id":"1"
      },
      {
         "name":"CategoryChildLevel1",
         "id":"2"
      },
      {
         "name":"CategoryChildLevel2",
         "id":"3"
      }
   ]
} 
```

我想要的是能够运行一个查询：

替换以开头的面包屑数组

```
 {
         "name":"RootCategory",
         "id":"1"
      },
      {
         "name":"CategoryChildLevel1",
         "id":"2"
      } 
```

将此子序列替换为

```
 {
         "name":"RootCategory",
         "id":"1"
      },
      {
         "name":"AnotherCategory",
         "id":"4"
      }
      {
         "name":"AnotherCategory2",
         "id":"5"
      } 
```

所以最终的结果是

```
{
   "name":"CategoryChildLevel2",
   "parentId":"2",
   "otherAttribute":"anyVal",
   "breadcrumb":[
      {
         "name":"RootCategory",
         "id":"1"
      },
      {
         "name":"AnotherCategory",
         "id":"4"
      },
      {
         "name":"AnotherCategory2",
         "id":"5"
      },
      {
         "name":"CategoryChildLevel2",
         "id":"3"
      }
   ]
} 
```

我们可以在 MongoDB 中做到这一点吗？或者至少`array startsWith`使用普通查询语言或 map/reduce 检索我们应该更新（查询）的项目？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T14:38:26.250

从 Mongo 2.2 开始，您可以在更新的查询选择器中使用数组[点表示法来执行此操作：](http://docs.mongodb.org/manual/core/document/#dot-notation)

```
db.test.update({
    'breadcrumb.0.id': '1',
    'breadcrumb.1.id': '2'
}, {
    $set: {
        'breadcrumb.1': {
            name: "AnotherCategory",
            id: "4"
        }
    }
}, {multi: true}) 
```

在以前的版本中，您必须使用这样的[`$where`](http://docs.mongodb.org/manual/reference/operator/where/)查询选择器来执行`update`此操作：

```
db.test.update({
    'breadcrumb.id': '2',
    // Check the name fields as well here, if necessary.
    $where: "this.breadcrumb.length > 1 && this.breadcrumb[0].id === '1' && this.breadcrumb[1].id === '2'"
}, {
    $set: {
        'breadcrumb.1': {
            name: "AnotherCategory",
            id: "4"
        }
    }
}, { multi: true}) 
```

查询的`'breadcrumb.id': '2'`组件将有助于提高性能，因为它将限制慢速`$where`必须操作的文档数量。

# javascript - 按下回车时自动“继续” Sublime 中的注释块？

> ID：13592091
> 
> 赞同：6
> 
> 时间：2012-11-27T20:01:43.827
> 
> 标签：javascript, comments, sublimetext2

我敢肯定那里有答案，但由于这个问题和关键字的模糊性，这很困难。

我想要的只是一个评论插件或在 Eclipse 中模仿 Java 的答案，其中：

```
/* 
 * This is a description of a function in Javascript
 * When I press return a line like this
 *
 * should appear (above) and allow me to continue the comment block
 * and be surrounded by the following
 */ 
```

**更新/回答**

几分钟后，我发布了这个用户 pst 进来并改写了我的问题以使其真正有意义。搜索后，我找到了 DocBlockr。效果很好，谢谢两位！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-27T20:10:23.290

从 DocBlockr 包开始。

如果您输入并对齐第一个`*`，它将插入以下起始`*`s。

```
/*
 * <-- Type and align that one, hit <RETURN>...
 * <-- This one will be inserted and aligned automatically. 
```

如果您插入双星号，它将插入前导`*`s 而没有提示：

```
/**
 * <-- Inserted automatically. 
```

如果您处于函数的开头，它也会为您放入 JsDoc 内容。

# c# - 反射 C# 从列表中获取自定义属性

> ID：13592103
> 
> 赞同：1
> 
> 时间：2012-11-27T20:02:48.170
> 
> 标签：c#, asp.net-mvc-3, reflection

我想从模型实现动态 WebGrid 创建。

想法是通过使用属性注释模型属性来从模型“描述”创建网格。

```
class Model
{
   public List<Product> Products {get;set;}

}

class Product 
{
   [GridColumn]
   public String Name {get;set;}
   ....

} 
```

然后我想通过反射获取此属性标记的所有属性。

```
public WebGridColumns[] ColumnsFromModel(object model)
{
   // Here model is List<T> so how get all custom attributes of List<T> ?

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T20:29:46.147

您可以创建一个简单的扩展方法，该方法将从接口的实现中获取所需的属性（该[`ICustomAttributeProvider`接口](http://msdn.microsoft.com/en-us/library/system.reflection.icustomattributeprovider.aspx)由可以具有属性的 .NET 构造的任何表示形式实现）：

```
public static IEnumerable<T> GetCustomAttributes(
    this ICustomAttributeProvider provider, bool inherit) where T : Attribute
{
    // Validate parameters.
    if (provider == null) throw new ArgumentNullException("provider");

    // Get custom attributes.
    return provider.GetCustomAttributes(typeof(T), inherit).
        Cast<T>();
} 
```

从那里，它是`PropertyInfo`一个类型上所有实例的调用，如下所示：

```
var attributes = 
    // Get all public properties, you might want to
    // call a more specific overload based on your needs.
    from p in obj.GetType().GetProperties()

    // Get the attribute.
    let attribute = p.GetCustomAttributes<GridColumnAttribute>().
        // Assuming allow multiple is false.
        SingleOrDefault().

    // Filter out null properties.
    where attribute != null

    // Map property with attribute.
    select new { Property = p, Attribute = attribute }; 
```

从那里，您可以在任何对象实例上调用该[`GetType`方法](http://msdn.microsoft.com/en-us/library/system.object.gettype.aspx)并通过上述查询运行它以获取[`PropertyInfo`](http://msdn.microsoft.com/en-us/library/system.reflection.propertyinfo.aspx)实例和应用于它的属性。

# javascript - 使用 ObjectID 数组查询用户故事详细信息

> ID：13592104
> 
> 赞同：3
> 
> 时间：2012-11-27T20:02:48.613
> 
> 标签：javascript, sdk, rally

我一直在使用 Lookback API 从 Rally 环境中查询用户故事。虽然查询功能比 WsapiDataStore 更强，但通过允许我使用 RPM 层次结构进行查询，它似乎无法返回完整数据字段的值，例如 Owner 和 Project。而是返回这些字段的 OID。为了解决这个问题，我的想法是首先进行一个 Lookback API 查询，以获取我关心的 RPM 层次结构中的所有故事 OID。我将捕获故事 OID 并将它们保存在一个数组中。然后，我可以使用 WsapiDataStore 查询来获取与数组中的 OID 匹配的故事的详细信息。使用 Lookback API 时，我可以选择使用“in”运算符，因此查询将如下所示：

```
{
    property: 'ObjectID',
    operator: 'in',
    value: [ '71352862', '44523976', '61138496' ]
} 
```

但是，我不能在 WsapiDataStore 中使用此功能。此外，当我尝试在一个长查询字符串中将它们全部“或”在一起时，我收到有关无效请求的错误。我认为查询字符串太长了，因为在大多数情况下我要搜索大约 1000 个用户故事。我宁愿不必为每个 OID 单独查询，但现在这似乎是唯一的解决方案。有没有办法从 Lookback API 获取完整的详细信息，或者至少使用 WsapiDataStore 查询上的数组进行过滤？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-08-13T18:10:18.367

ObjectID 现在支持`in`运算符。

从[WSAPI 文档](https://rally1.rallydev.com/slm/doc/webservice/)：

[![ObjectID WSAPI 文档](../Images/d26efdd870dbfc392283c1a63540157b.png)](https://i.stack.imgur.com/Z0fgn.png)

这是一个示例用法：`(ObjectID in 1,2,3)`

# c - 使用 scanf() 检测读取非数字

> ID：13592106
> 
> 赞同：3
> 
> 时间：2012-11-27T20:03:03.870
> 
> 标签：c, scanf

嘿大家谢谢你的建议。不幸的是，我不允许使用此类功能。所以我写了这段代码，它适用于 1 个问题。如果我输入让我们说“hhjk”，它会吓坏的。我想在第一个'h'被检测为非数字后清除缓冲区..听说过函数 fflush 但我无法理解它..

```
int get_int() 
{
    char inp; /*inp, for input*/
    int number; /*the same input but as integer*/
    int flag=0; /*indicates if i need to ask for new input*/

    do  {
        flag=0; /*indicates if i need to ask for new input*/

        scanf("%c",&inp);

        if (inp<48 || inp>57 ) /*this means it is not a number*/
        {
            inp=getchar(); /*Here i clear the buffer, the stdin for new input*/
            printf("Try again...\n");
            flag=1;
        }
        else
          if (inp>53 && inp<58 && flag!=1) /*this means it is a number but not in the 0-5 range*/
          {
              inp=getchar(); /*here i clear the buffer, the stdin so i can get a new input*/
              flag=1;
          }

        } while (flag);

    number=inp-48; /*takes the ascii value of char and make it an integer*/ 
    return number;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T20:16:47.490

一个简单的方法是输入一个字符串，然后检查以确保其中的所有内容都是一个字符。我们可以使用`strtol()`检查，因为它[在无法进行转换时返回 0](http://www.cplusplus.com/reference/cstdlib/strtol/)，唯一的条件是因为您希望 0 是有效输入，所以我们必须在检查上设置一个特殊条件：

```
int main()
{
    char input[50];  // We'll input as a character to get anything the user types
    long int i = 0;
    do{
        scanf("%s", input);  // Get input as a string
        i = strtol(input, NULL, 10);  // Convert to int
        if (i == 0 && input[0] != '0') { // if it's 0 either it was a numberic 0 or
            printf("Non-numeric\n");     // it was not a number
            i = -1;   // stop from breaking out of while()
        }
        else if(i<0 || i > 5)
            printf("wrong\n");
    }while (i < 0 || i >5);
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T20:49:48.820

另一种方法是对 scanf 系列使用很少见的 %[] 格式。在下面的代码中，我有 %[0-9]。这给我们的只是数字。（没有显示返回码等）

```
do {
        if ((scanf("%[0-9]%c", input, &nl) == 2) && (nl == '\n')) {
                value = strtol(input, NULL, 0);
        } else {
                value = -1;
        }
} while ((0 <= value) && (value <= 5)); 
```

# memory-management - 直接修改内存中传递参数的字符串

> ID：13592108
> 
> 赞同：2
> 
> 时间：2012-11-27T20:03:07.617
> 
> 标签：memory-management, com, webbrowser-control, autohotkey, beforenavigate2

是否可以修改 COM 事件方法传递的函数参数的内存值？COM 对象中的属性值需要编辑。

`Refresh`我正在尝试为 ActiveX 控件设置自定义用户代理，如果用户选择或打开链接页面，则使用自定义标题重新导航加载页面不成功。该`Navigate()`方法中设置的标题也不适用于框架页面。

根据 MSDN ( [http://msdn.microsoft.com/en-us/library/aa768326%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/aa768326%28v=vs.85%29.aspx) )，标头值的参数作为 ByRef 传递。

所以我试着简单地给它一个新的价值，但它没有用。

所以现在我想如果直接改变内存中存储的值就可以实现。所以我尝试了以下但它不起作用。

任何想法？

```
oWB := new WebBrowser("http://sofiablue.net/")

Class WebBrowser
{

    __New(strURL) { 

        static WB
        Gui, New, Resize 
        Gui, Add, ActiveX, vWB w780 h580 , Shell.Explorer  
        Gui, show, w800 h600

        ComObjConnect(WB, this) 

        WB.Navigate(strURL  
            , "_self"
            , null
            , null
            , "User-Agent: tester")
        Loop
           Sleep 10
        Until (WB.readyState=4 && WB.document.readyState="complete" && !WB.busy)    

    }

    BeforeNavigate2(oParams*) {
        ; oParams[6] := "User-Agent: modified" ; this does not work.
        ; StrPut("User-Agent: modified", oParams.GetAddress(6)) ; does not work     
        this.StrPutVar("User-Agent: modified", oParams[6], "utf-16")    ; does not work
    }

    StrPutVar(string, ByRef var, encoding)
    {
        ; Ensure capacity.
        VarSetCapacity( var, StrPut(string, encoding)
            ; StrPut returns char count, but VarSetCapacity needs bytes.
            * ((encoding="utf-16"||encoding="cp1200") ? 2 : 1) )
        ; Copy or convert the string.
        return StrPut(string, &var, encoding)
    }       
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T07:43:10.837

AutoHotkey 对 COM 事件的 ByRef 参数的支持非常有限。

COM 参数通过 VARIANTARG 结构数组传递。调用者通过将变量的地址存储在变体中并将类型设置为`VT_BYREF`与参数的 var 类型的按位或组合来支持 ByRef，例如`VT_VARIANT`.

某些语言（如 VBScript）`VT_BYREF|VT_VARIANT`默认提供类型（0x400C）的变体；当参数的类型未知时，也许支持 ByRef。因此，AutoHotkey 会自动取消引用这些变体。因此，您的`BeforeNavigate2`方法永远不会收到引用，也无法输出到它的任何`ByRef Variant`参数。

对于更具体类型的任何`ByRef`参数，例如`ByRef Cancel As Boolean`，参数（在脚本中）应该接收一个表示引用的对象。例如，`ComObjType(Cancel)`将返回`VT_BYREF|VT_BOOL`(0x400B) 并返回可以存储布尔值`ComObjValue(Cancel)`的变量的地址。以下可用于存储*真*值：`VARIANT_BOOL`

 *```
if (ComObjType(Cancel) = 0x400B)  ; Safety check
    NumPut(-1, ComObjValue(Cancel), "short") 
```

VT_DISPATCH、VT_UNKNOWN 和 VT_BSTR 类型的 ByRef 输入/输出参数有附加要求。如果前一个值非 NULL，则必须先将其释放。对于 VT_BSTR，必须使用`SysAllocString`（必须通过 DllCall 调用）分配新字符串。*

# c# - 如何使用 JavaScript 变量在 JavaScript 函数中获取 ASP.NET ClientID？

> ID：13592109
> 
> 赞同：0
> 
> 时间：2012-11-27T20:03:06.960
> 
> 标签：c#, javascript, asp.net, controls

我希望能够在 JavaScript 函数中获取 ASP.NET 控件的 ClientID。我还希望能够传入一个包含控件名称的 var，以便不同的控件可以使用相同的函数。

例如，如果我想使用一个名为 Button1 的控件，这可以正常工作：

```
function doStuffToButton1Control()
{
    var buttonControl = document.getElementById('<%= Button1.ClientID %>');
    //do stuff with buttonControl
} 
```

但是当我尝试使控件名称动态化时出现错误。我正在尝试将 ClientID 调用串在一起，如下所示：

```
function doStuffToGenericControl(controlName)
{
    var dynamicControl = document.getElementById('<%= ' + controlName + '.ClientID %>');
    //do stuff with dynamicContorl
} 
```

我在创建字符串时尝试使用双引号或单引号，但错误始终是“字符串文字中的字符过多”或“字符文字中的字符过多”。控件存在并且名称正确传递（由 测试`alert(name)`）。

有没有更好的方法来解决这个问题，还是我错过了一些明显的东西？

谢谢！

**更新：**此功能将在母版页上。任何数量的子页面都会调用它。例如，一个子页面可能有一个这样调用它的 ASP 控件：

```
<asp:LinkButton ID="Button2" runat="server" OnClientClick="doStuffToGenericControl('Button2')">...</asp:LinkButton> 
```

但是另一个页面可能有这个也调用它的 ASP 控件：

```
 <asp:LinkButton ID="Button4" runat="server" OnClientClick="doStuffToGenericControl('Button4')">...</asp:LinkButton> 
```

但是，这些控件的 ID 通常会在呈现时由 ASP.NET 更改，因此它们最终看起来像，例如，`MainContent_Button2`而不是只是`Button2`. 为了解决这个问题，我传统上只是使用`<%= Button1.ClientID %>`，但由于我希望任意数量的控件都能够使用这个功能，所以我遇到了一些麻烦。

**更新 2：**我可以通过`this`调用`getAttribute`来获得我需要的东西。（显然，这仅在您所指的控件是您正在单击的控件时才有效，但这正是我所需要的）像这样：

```
function doStuffToGenericControl(controlName)
{
     var controlID = controlName.getAttribute('id');
     var control = document.getElementById(controlID);
     //do stuff with control
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T13:47:09.240

而不是传递控件名称，为什么不通过在函数中传递它来传递控件本身，如下所示：

```
 <asp:LinkButton ID="Button2" runat="server" OnClientClick="doStuffToGenericControl(this)">...</asp:LinkButton> 
```

你的功能将是：

```
function getGenericControl(control)
{
    var dynamicControl = control;
    alert(dynamicControl.id);
    //do stuff whatever you want with dynamicContorl
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T20:06:12.497

'`<%= Button1.ClientID %>'`是在 asp.net 页面渲染上用控件 ID 替换的东西，

但是当您在客户端传递变量时，您应该传递 id 并在没有任何 % 范围的情况下使用它

所以试试这个

```
function getGenericControl(control)
{
    var dynamicControl = control;
    alert(dynamicControl);
    //do stuff with dynamicContorl
} 
```

**更新**

您可以使用 <%= ClientID %> 为上述方法生成参数，因此只需像这样更改 OnClientClicks 并使用上述方法

```
<asp:LinkButton ID="Button2" runat="server" OnClientClick="doStuffToGenericControl(this)">...</asp:LinkButton> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T20:08:40.867

如果可能的话，我强烈建议使用一个类，

```
var elems = document.getElementsByTagName('*'), i;
    for (i in elems) {
        if((' ' + elems[i].className + ' ').indexOf(' ' + matchClass + ' ')
                > -1) {
            elems[i].innerHTML = content;
        }
    } 
```

# iphone - IOS 中的内存管理问题（收到内存警告。）

> ID：13592114
> 
> 赞同：0
> 
> 时间：2012-11-27T20:03:29.237
> 
> 标签：iphone, objective-c, ios, xcode

我有一个空白屏幕，我单击相机按钮并拍照，然后该照片作为 UIVIew 出现在我的空白屏幕上，我正在将多个图像从相机添加到空白屏幕。问题是有时我可以在空白屏幕上添加多个图像，但有时当我捕获图像时，空白屏幕上的所有图像都会消失，只显示当前图像。并在日志中。它告诉我收到内存警告。这是我的代码。我想我现在正确地释放我的对象。但是当我最后添加 [object release] 时，我的应用程序崩溃了。

```
 -(void)AddImagesToCanvasWithGesture{

    if(imageFromPicker.size.width > imageFromPicker.size.height || imageFromPicker.size.width == imageFromPicker.size.height)
    {
        holderView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 180, 160)];
    }
    else{
        holderView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, 160, 240)];
    }
    UIImageView *imageview = [[[UIImageView alloc] initWithFrame:[holderView frame]];
    [imageview setImage:imageFromPicker];
    //[imageview setTag:101];
    //[holderView setTag:102];
    //NSLog(@"Tag By Default %d",(arc4random()%100)+10);
    [holderView setTag:(int)objectDelegate.tagForHolderView];
    [imageview setTag:((int)objectDelegate.tagForHolderView)+1];
    [holderView addSubview:imageview];
    //[imageview canBecomeFirstResponder];

    UIPinchGestureRecognizer *pinchRecognizer = [[UIPinchGestureRecognizer alloc] initWithTarget:self action:@selector(scale:)];
    [pinchRecognizer setDelegate:self];
    [holderView addGestureRecognizer:pinchRecognizer];

    UIRotationGestureRecognizer *rotationRecognizer = [[UIRotationGestureRecognizer alloc] initWithTarget:self action:@selector(rotate:)];
    [rotationRecognizer setDelegate:self];
    [holderView addGestureRecognizer:rotationRecognizer];

    UIPanGestureRecognizer *panRecognizer = [[UIPanGestureRecognizer alloc] initWithTarget:self action:@selector(move:)];
    [panRecognizer setMinimumNumberOfTouches:1];
    [panRecognizer setMaximumNumberOfTouches:1];
    [panRecognizer setDelegate:self];
    [holderView addGestureRecognizer:panRecognizer];

    UITapGestureRecognizer *tapRecognizer = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(tapped:)];
    [tapRecognizer setNumberOfTapsRequired:1];
    [tapRecognizer setDelegate:self];
    [holderView addGestureRecognizer:tapRecognizer]; 

    UILongPressGestureRecognizer *gestureRecognizer = [[UILongPressGestureRecognizer alloc] initWithTarget:self action:@selector(gestureHandler:)];
    [holderView addGestureRecognizer:gestureRecognizer];

    [holderView.layer setBorderColor: [[UIColor whiteColor] CGColor]];
    [holderView.layer setBorderWidth: 3.0];
    [self.view addSubview:holderView];
    objectDelegate.tagForHolderView+=2;
    for(UIButton *b in self.view.subviews) {
        if([b isKindOfClass:[UIButton class]]) {
            [self.view bringSubviewToFront:b];
        }

        [self.view sendSubviewToBack:imageViewForBackground];
        //[holderView setHidden:YES];

    }

} 
```

我怎样才能释放它们，我应该在哪里调用释放方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T20:38:24.270

从您在上面添加的代码片段中，很明显您没有正确释放对象。`init`您拥有您或`retain`或您有责任释放它们的每个对象，`copy`除非您使用 ARC。（上面的代码适用于 ARC）。

您拥有所有手势识别器和图像视图的所有权，您应该在不再需要它们时立即释放它们。例如...`imageView`对象必须在之后释放

`[holderView addSubview:imageview];`

和

`pinchRecognizer`应该在之后立即释放

`[holderView addGestureRecognizer:pinchRecognizer];`

其他手势识别器也是如此。

我猜你的代码的其他部分也有类似的问题，最终应用程序收到内存警告。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T20:14:12.180

当你遇到内存问题时，如果你有一个名为

```
- (void)didReceiveMemoryWarning 
```

它会被调用并允许您释放空间。如果您使用的是 ARC，只需将您的 UIImageView 设置为 nil，如果没有，请调用：

```
[imageview release]; 
```

# android - android横向屏幕中的tabhost

> ID：13592115
> 
> 赞同：0
> 
> 时间：2012-11-27T20:03:33.653
> 
> 标签：android, android-layout, tabs, android-tabhost, landscape

我在纵向屏幕上使用标签，但在横向屏幕模式下我不能这样做。我想要做什么；

[http://imgur.com/M2L87](http://imgur.com/M2L87)

我怎么能做那个屏幕？

我这样做是为了纵向屏幕模式。这里是；

```
<?xml version="1.0" encoding="utf-8"?>
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
>
<TabHost 

android:id="@android:id/tabhost" 
android:layout_width="fill_parent"

android:layout_height="fill_parent">

<LinearLayout 
xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:orientation="vertical"
android:background="#FFFFFF" >

<TabWidget 
         android:id="@android:id/tabs"
         android:layout_width="fill_parent" 
         android:layout_height="wrap_content" />

    <FrameLayout 
        android:id="@android:id/tabcontent"

        android:layout_width="fill_parent" 
        android:layout_height="fill_parent">
 </FrameLayout>

 <LinearLayout
 android:layout_width="fill_parent"
 android:layout_height="fill_parent"
 android:orientation="horizontal" >

 <ImageButton
    android:id="@+id/imageButton1"
    android:layout_width="162dp"
    android:layout_height="wrap_content"
    android:background="#FFFFFF"
    android:scaleType="fitCenter"
    android:src="@drawable/1" />

  <ImageButton
    android:id="@+id/imageButton2"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:background="#FFFFFF"
    android:scaleType="fitCenter"
    android:src="@drawable/2" />

 </LinearLayout>

 <LinearLayout
 android:layout_width="fill_parent"
 android:layout_height="wrap_content"
 android:orientation="horizontal" >

<ImageButton
    android:id="@+id/imageButton3"
   android:layout_width="162dp"
    android:layout_height="wrap_content"
    android:background="#FFFFFF"
    android:scaleType="fitCenter"
    android:src="@drawable/3" />

<ImageButton
    android:id="@+id/imageButton4"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:background="#FFFFFF"
    android:scaleType="fitCenter"
    android:src="@drawable/4" />
    </LinearLayout>

  <LinearLayout 
  android:layout_width="fill_parent"
  android:layout_height="wrap_content"
  android:orientation="horizontal" >

  <ImageButton
    android:id="@+id/imageButton5"
    android:layout_width="162dp"
    android:layout_height="wrap_content"
     android:src="@drawable/5" 
     android:background="#FFFFFF"
     android:scaleType="fitCenter"/>

 <ImageButton
     android:id="@+id/imageButton6"
   android:layout_width="fill_parent"
    android:layout_height="wrap_content" 
     android:src="@drawable/6"
     android:background="#FFFFFF"
     android:scaleType="fitCenter"/>

 </LinearLayout>

 <LinearLayout 
  android:layout_width="fill_parent"
  android:layout_height="wrap_content"
  android:orientation="horizontal" >

  <ImageButton
    android:id="@+id/imageButton7"
    android:layout_width="162dp"
    android:layout_height="wrap_content"
    android:background="#FFFFFF"
    android:scaleType="fitCenter"
    android:src="@drawable/7" />

  <ImageButton
     android:id="@+id/imageButton8"
     android:layout_width="fill_parent"
     android:layout_height="wrap_content"
     android:src="@drawable/8"
     android:background="#FFFFFF"
     android:scaleType="fitCenter"/>

  </LinearLayout>

  <LinearLayout
  android:layout_width="fill_parent"
  android:layout_height="wrap_content"
  android:orientation="horizontal" >

  <ImageButton
    android:id="@+id/imageButton9"
    android:layout_width="162dp"
    android:layout_height="wrap_content"
    android:background="#FFFFFF"
    android:scaleType="fitCenter"
    android:src="@drawable/9" />

  <ImageButton
    android:id="@+id/imageButton10"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="#FFFFFF"
    android:scaleType="fitCenter"
    android:src="@drawable/10" />

  </LinearLayout>

  </LinearLayout>
  </TabHost>

  </ScrollView> 
```

这是我用于纵向屏幕的 main.xml 并且可以正常工作。

# java - 用流读取 unicode 文本文件？

> ID：13592116
> 
> 赞同：0
> 
> 时间：2012-11-27T20:03:34.790
> 
> 标签：java

所以我试图从文件中读取文本数据并且我弄乱了 Unicode 字符，但它似乎无法正确解析 Unicode 字符。我不完全确定我做错了什么，因为我最近开始学习更多关于 Java 的知识，所以如果有人能指出可能的错误或导致这种行为的原因，我将不胜感激。

代码：

```
BufferedReader br = new BufferedReader(new InputStreamReader(new FileInputStream("C:\\hello.txt"), "UTF8"));
            char[] buffer = new char[128];
            int len = br.read(buffer);

            for (int i = 0; i < len; i++) {
                System.out.print(buffer[i]);
            } 
```

文件内的字符是：**Øßà**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T21:17:07.543

你没有错过破折号吗？：UTF-8

[如果您使用的是 google 的 Guava 库，那么Charsets](http://docs.guava-libraries.googlecode.com/git/javadoc/com/google/common/base/Charsets.html)有常量。

然后你可以使用：

```
String text =  com.google.common.io.Files.toString(new File("C:\\hello.txt"), Charsets.UTF_8); 
```

**编辑**

大概是因为[这个](https://stackoverflow.com/a/5965794/1089998)吧？

# c# - 一个抽象类继承另一个抽象类问题

> ID：13592118
> 
> 赞同：5
> 
> 时间：2012-11-27T20:03:39.327
> 
> 标签：c#, .net, inheritance, abstract-class, encapsulation

我有一个继承模式，如下所示：

```
public abstract class BaseAttachment
{
    public abstract string GetName();
}

public abstract class BaseFileAttachment:BaseAttachment
{
    public abstract string GetName();
}

public class ExchangeFileAttachment:BaseFileAttachment
{
    string name;
    public override string GetName()
    {
        return name;
    }
} 
```

我基本上想调用 ExchangeFileAttachment 类的 GetName() 方法；但是，上面的声明是错误的。对此的任何帮助表示赞赏。谢谢

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-11-27T20:12:26.107

我看到的两个直接问题是您的最终`ExchangeFileAttachment`类已声明`abstract`，因此您将永远无法实例化它。除非你有另一个层次的继承，你没有向我们展示，否则调用它是不可能的——没有办法访问它。另一个问题是它`BaseFileAttachment`有一个隐藏`GetName()`在`BaseAttachment`. 在您向我们展示的结构中，它是多余的，可以省略。因此，“更正”的代码看起来更像：

```
public abstract class BaseAttachment
{
    public abstract string GetName();
}

public abstract class BaseFileAttachment : BaseAttachment
{
}

public class ExchangeFileAttachment : BaseFileAttachment
{
    string name;
    public override string GetName()
    {
        return name;
    }
} 
```

我在引号中加上了更正，因为这个用例仍然没有多大意义，所以我希望你能提供更多信息，或者这对你来说更有意义。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-11-27T20:10:09.393

只需从以下位置删除重新声明`BaseFileAttachment`：

```
public abstract class BaseFileAttachment : BaseAttachment
{
} 
```

`BaseFileAttachment`已经从 继承了抽象`GetName`声明`BaseAttachment`。如果您真的想在 中再次提及它`BaseFileAttachment`，请使用`override`关键字：

```
public abstract class BaseFileAttachment : BaseAttachment
{
    public override abstract string GetName(); // that's fine as well
} 
```

# multithreading - 调用 ls 或 rm 之类的二进制文件是不好的 Perl 做法吗？

> ID：13592122
> 
> 赞同：3
> 
> 时间：2012-11-27T20:03:47.570
> 
> 标签：multithreading, perl, process, fork

我发现在 perl 中很容易执行以下操作：

```
 print "File not found, valid files are:\n\n".`ls DIRECTORY | grep 'php'`;

   `rm -rf directory`

   my @files_list = split("\n", `ls DIRECTORY | grep 'FILE_NAME_REGEX'`) 
```

做这样的事情是不好的做法吗？我发现这样做比煞费苦心地实现每一件事要容易得多。我将 Perl 视为 bash 的高级版本。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-27T20:09:00.763

使用外部二进制文件是：

1.  非常低效
2.  可能不安全
3.  不可移植（谢谢@friedo）
4.  懒惰的......在大多数情况下，如果您寻找它，有一个 Perl 模块会做您想做的事情

在这种特殊情况下，请查看[`File::Glob`](http://search.cpan.org/~dom/perl-5.12.5/ext/File-Glob/Glob.pm)模块。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-27T20:24:48.420

这有点取决于程序的预期寿命。如果它是您只打算自己使用的东西，或者它是一次性的，那很好。这就是它最初的设计目的：“最初设计为 UNIX 操作系统的胶水语言……”（Programming Perl，第 2 版，第 ix 页）。

另一方面，如果它是一个需要大量使用、分布广泛、在多个操作系统上运行等的程序，那么最好使用内置插件和通过 CPAN 提供的许多软件包。

无论哪种方式，您应该总是使用 unlink 函数而不是调用 rm，以及使用 grep 或 map 函数而不是调用 grep。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-11-27T20:36:30.997

现在提出不同意见。[TMTWOTDI](http://en.wikipedia.org/wiki/There%27s_more_than_one_way_to_do_it)，正如@transistor1 在评论中所说。我还可以调用 Perl 的[Whitituptitude 功能](http://en.wiktionary.org/wiki/Citations%3amanipulexity)。如果你比模块更熟悉`cp`，如果你不担心可移植性，如果你的程序可以承受启动一两个额外进程的性能损失（提示：它可能可以），Perl 可以很容易地将这些工具集成到您的程序中，使用任何可用的工具尽可能快地完成任务并没有错。`mv``File::Copy`

哎呀，有时在那些一次性任务中，Unix 实用程序是完成这项工作的正确工具，即使你知道如何在 Perl 中完成这项工作。

```
# I need log.err plus the next two oldest and the next two newest 
# files in the current directory. Should I say

chomp(@f = qx[ls -t | grep -C2 log.err]);

# or

@e = sort { -M $a <=> -M $b } glob("*");
($i) = grep { $e[$_] eq 'log.err' } 0..$#e;
@f = @e[$i-2 .. $i+2];

# or

use Acme::OlderNewer::FileFinder;
@f = find_oldernewer_files(".", "log.err", -2, +2);

# ?  Or suppose I want a list of all the *.pm files under all 
# directories in @INC, and we lucked out so that nothing in @INC
# has any spaces or special characters. 
# Is my script any less useful for saying

chomp(@f = `find @INC -name \\*.pm`);

# than

use File::Find;
find( sub { /\.pm$/ && push @f, $File::Find::name }, @INC ); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-11-27T20:12:49.220

使用反引号通常较慢且有些不安全，并且根据您想要的操作，perl 并不难，您只需要知道该怎么做。例如：

```
print "File not found, valid files are\n\n", grep /php/, glob 'DIRECTORY/*';
unlink glob 'directory/*'; 
rmdir 'directory';
my @files = grep /REGEX/, glob 'DIRECTORY/*'; 
```

Perl 是为适应懒惰而构建的，但是您使用 bash 执行的大多数正常操作都可以在 perl 中轻松完成。不学习如何去做是你的决定，但我认为如果你经常这样做，它会让你的事情变得更容易。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-28T02:08:41.017

与大多数工程问题一样，答案是“这取决于。”。

将 Perl 视为一种脚本语言会牺牲可移植性、可维护性、执行速度和其他属性，以便在您在最短的时间内完成之前完成任务。做出这些牺牲的后果不是一成不变的，而是程序复杂性的一个函数。你的程序越复杂，你就越有可能在可维护性方面付出更多，而不是你在whipitupitude中获得的收益，并且你越有可能通过炮轰做出错误的选择。

这里没有普遍正确的答案。在某些情况下，您需要一个脚本才能工作一次。在其他情况下，您需要它工作几次，但它很短。而在其他情况下，您正在编写跨数百个源文件的数万行的应用程序。使用它的场景决定了哪种工具最合适，而不是某种完美的规则。

有时，您会看到这种方法被嘲笑为“懒惰”。就是这样。当你的参数发生变化时，你是否考虑到上述情况并保持改变方法的意愿，决定了你是在从事好的懒惰还是坏的懒惰。真正懒惰的人知道，有时最懒惰的事情就是重新开始。

# java - 我可以在没有 JDK 的情况下运行 .jar 文件吗？

> ID：13592123
> 
> 赞同：1
> 
> 时间：2012-11-27T20:03:46.400
> 
> 标签：java

> **可能重复：**
> [如何将我的 Java 程序转换为 .exe 文件？](https://stackoverflow.com/questions/147181/how-can-i-convert-my-java-program-to-an-exe-file)

是否可以在不安装 JDK 或 JRE SDK 的情况下在 PC 中运行 jar 文件？转换成exe还是其他方式？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T20:11:25.287

在 .Net => [http://www.ikvm.net/](http://www.ikvm.net/)中运行 jar 文件（Java 的另一个 VM）
或者您可以将 java 转换为 exe 使用：[http](http://www.duckware.com/jexepack/index.html)
://www.duckware.com/jexepack/index.html 由您可以使用 gcc.gnu.org/java（“GCJ”另一个 Gcc Gnu 编译器）在独立的可执行文件中编译 java

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T20:05:40.317

jar 文件是一个 java 档案。JRE 是此类文件的运行时环境，它依赖于它。没有任何类型的 java 运行时环境，你就做不到。

但是，很多环境已经拥有它，因此您不必单独安装它。

不需要 JDK/SDK。

请注意，将 jar 文件转换为 exe 不会改变它仍然需要 java 运行时环境才能运行的事实。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-27T20:06:13.627

您不需要“JDK”或“JRE SDK”，但至少需要“JRE”。您可以将其转换为 EXE，但您仍然需要包含与 JRE 具有所有相同信息的库。

例如，对于 VC++，您需要该版本的运行时库来运行这样的程序。

# java - JSP 中的 try 块代码太大

> ID：13592127
> 
> 赞同：0
> 
> 时间：2012-11-27T20:04:11.437
> 
> 标签：java, jsp, struts, jstl

我有一个 JSP 页面，它显示一个包含几行的表格。在编译时一切看起来都很好，在运行时我得到这个“代码太大而无法尝试块”错误。我看到我应该溢出 JSP 并包含几个。但是我的 JPS 不允许，因为所有内容都与带有几个 tr 和 td 的表一起使用。所以我cldnt分裂。还有其他方法吗？或者我怎样才能将 JSP 洒在一张桌子上？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T20:20:37.393

前面已经说过，数据模型和视图的分离有其优势。

但是，您也可以在 JSP 中使用方法；输出也可以在方法中完成`%>...<%`。

JSP 声明进来`<%! ... %>`。

```
<%!

private void f(JspWriter out) throws Exception {
    out.println("hello");
}

private void tr(String a, String b) throws Exception {
   %><tr><td><%= a %></td><td><%= b %></td></tr>
   <%
}

%>
<%
    f(out);
%>
<table>
<%
    tr("good day", "bonan tagon");
    tr("good night", "bonan nokton");
%>
</table> 
```

# android - 有人可以解释我们在 Xamarin 中编译 android 代码时生成的文件（单声道 for android）吗？

> ID：13592132
> 
> 赞同：3
> 
> 时间：2012-11-27T20:04:23.320
> 
> 标签：android, mono, xamarin

当我使用 Xamarin（Android 的单声道）在 C# 中编译我的代码时，我看到在`bin/`目录中创建了以下 5 个文件。

1.  解决方案名称.解决方案名称.apk
2.  解决方案名称.解决方案名称签名.apk
3.  SolutionName.dll（应用程序扩展）
4.  SolutionName.dll.mdb（Microsoft Access 数据库）
5.  SolutionName.pdb（程序调试数据库）

有人可以解释这些文件的含义以及是否可以使用这些文件手动部署我的应用程序（不使用 Xamarin）？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-28T13:53:13.817

1.  SolutionName.SolutionName.apk 是未签名的 Android 包
2.  SolutionName.SolutionName-Signed.apk 是签名的Android包
3.  SolutionName.dll 只是动态库
4.  SolutionName.dll.mdb 是 Mono 调试符号（不是 Microsoft Access 数据库）
5.  SolutionName.pdb 是 .NET 调试符号

# delphi - JCL TEvaluator 类中预定义了哪些函数

> ID：13592136
> 
> 赞同：4
> 
> 时间：2012-11-27T20:04:40.263
> 
> 标签：delphi, delphi-7

有谁知道`TEvaluator`Delphi 7 的 JCL 类中包含哪些预定义函数（例如 ABS 函数）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T20:36:33.677

不包含任何标准功能`Math.pas`。默认评估解析器中实现的所有内容是运算符`or`, `xor`, `and`, `not`, `mod`, `+`, `-`, `/`, `*`, `<`, `>`, `<=`, `>=`, `=`, `div`, `cmp`, `bor`, `bxor`, `band`, `bnot`, `shl`, 和`shr`. （我在快速检查源代码时发现了很多，根据@David 的评论我错过了一些。）

您可以很容易地向评估器添加功能（包括那些属于 Delphi RTL 的功能）。它甚至显示在演示中，它添加了来自 JCL 单元之一的功能。

`JCL\examples\common\expreval`默认情况下，在文件夹中找到的 JCL 评估程序示例 (ExprEvalExample.dpr)将 a作为参数传递`TComboBox.Items`给`Init`函数 in ，该参数由以下代码填充（在同一例程中给出函数），函数来自：`ExprEvalExampleLogic.pas``FuncList``TEasyEvaluator``JclMath.pas`

```
 with FuncList do
  begin
    Add('LogBase10');
    Add('LogBase2');
    Add('LogBaseN');
    Add('ArcCos');
    Add('ArcCot');
    Add('ArcCsc');
    Add('ArcSec');
    Add('ArcSin');
    Add('ArcTan');
    Add('ArcTan2');
    Add('Cos');
    Add('Cot');
    Add('Coversine');
    Add('Csc');
    Add('Exsecans');
    Add('Haversine');
    Add('Sec');
    Add('Sin');
    Add('Tan');
    Add('Versine');
    Add('ArcCosH');
    Add('ArcCotH');
    Add('ArcCscH');
    Add('ArcSecH');
    Add('ArcSinH');
    Add('ArcTanH');
    Add('CosH');
    Add('CotH');
    Add('CscH');
    Add('SecH');
    Add('SinH');
    Add('TanH');
  end; 
```

这些将是演示应用程序中支持的功能。您可以以类似的方式添加自己的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T20:10:52.480

不包括预定义的功能。有标准的算术运算符：+、-、*、div 和 mod。还有所有标准的逻辑和位运算符。但是没有什么像 abs、sin、exp、log 等。你必须把它们放在你自己里面。添加功能非常容易，我认为这是一个很好的设计，可以让您准确选择您的评估者支持的内容。

# php - 将对象拆分/拆分为数组并嵌套在循环中

> ID：13592137
> 
> 赞同：0
> 
> 时间：2012-11-27T20:04:41.590
> 
> 标签：php, arrays, loops

大家好，我有点卡住了，需要一些帮助。我有一个返回以下内容的查询

```
Array
(
[0] => stdClass Object
    (
        [id] => 1
        [username] => Joe Blogs
        [user_number] => JB222
        [email] => jb@kemail.com
        [job_title] => Teacher
        [contractor] => Direct Hire
        [campus] => Male Humanities
        [role] => Teacher
        [section_number] => 11111 | 213312 | 232121 | 432231
        [stid] => 89,91,95,94
        [classroom] => 2621,1329,1428,3123
        [subject] => English | Physics | English | Maths
    )

) 
```

我需要能够将其分解，以便我可以循环遍历 stid、部分、教室和主题，作为嵌套循环的一部分。我想将部分和教室一起加入，并将 stid 分开，以便我可以在链接中使用它。我也想把班级分开。

```
 -----------------------------------------------
                                     |    sections    |  classroom   |   Teacher    |
                                     -----------------------------------------------
this would be a link with stid 89 -> | English 11111  |    2621      |  Joe Blogs   |
this would be a link with stid 91 -> | Physics 213312 |    1329      |              |
                                     | English 232121 |    1428      |              |
                                     | Maths   432231 |    3123      |              |
                                     ----------------------------------------------- 
```

我尝试了不同的东西，但无法让它们工作。以下是我尝试过的，但我可以弄清楚如何将每个 stid 作为链接中的值。如果班级为空，我还尝试使用 if 语句说 N/A 但这也不起作用。

旧代码

```
<ul>

@if ( empty($teacher->subject) )
N/A 
@else   
 <?php 
     $sections = explode(' | ',$teacher->section_number );
 $subjects = explode(' | ',$teacher->subject);  
 $data = array_combine($sections,$subjects); ?>

      @foreach ( $data as $section=>$class)     
      <li>{{ $section . " - " .$class }}</li>
      @endforeach

@endif

</ul>
</td>
<td> 
<ul>

 <?php $classrooms = explode(',',$teacher->classroom); ?>
@foreach ( $classrooms as $room)    
    <li>{{ $room }}</li>
@endforeach

</ul> 
```

任何帮助，将不胜感激。特别是对我哪里出错的一些解释。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T20:17:23.413

```
/* NEEDED FOR TESTING 
$teacher = new StdClass;
$teacher->id = 1;
$teacher->username = 'Joe Blogs';
$teacher->user_number = 'JB222';
$teacher->email = 'jb@jbkemail.com';
$teacher->job_title = 'Teacher';
$teacher->contractor = 'Direct Hire';
$teacher->campus = 'Male Humanities';
$teacher->role = 'Teacher';
$teacher->section_number = '11111 | 213312 | 232121 | 432231';
$teacher->stid = '89,91,95,94';
$teacher->classroom = '2621,1329,1428,3123';
$teacher->subject = 'English | Physics | English | Maths';
*/

$stid = explode(",",$teacher->stid);
$classroom = explode(",",$teacher->classroom);
$subject = explode(" | ",$teacher->subject);

foreach($stid as $k=>$s){
    echo $subject[$k].' '.$classroom[$k].' '.$s.'<br>';
} 
```

# ios - 如何将文件从 iPhone 发送到我的服务器？

> ID：13592138
> 
> 赞同：1
> 
> 时间：2012-11-27T20:04:42.327
> 
> 标签：ios, sql-server, vb.net, file-upload, ftp

我已经看到了很多关于这个主题的问题和答案，但不幸的是，它们似乎都没有足够接近我的需求。这个问题是关于iOS和vb2010的。

我创建了一个与我的服务器通信的应用程序（此时，“我的服务器”实际上是我用于开发的 Win7 机器。最终它将移动到实际的服务器）。后端是一个连接 iPhone 应用程序和 SQL Server 数据库的 VB 程序。一个特定的端口对计算机开放，那里的一切都很好。我能够从数据库中检索数据并将其与应用程序一起显示在 iPhone 上，并且还能够将应用程序中的记录保存到数据库中。这一切都非常酷，我真的很高兴。

项目的最后阶段需要将相机图像上传到服务器。这是我觉得很时髦的部分。

到目前为止，我已经能够将图像保存为 iPhone 磁盘上的文件。现在我需要更好地了解如何将该文件传输到服务器上的目录。

我知道有许多使用“post”方法的技术，但据我了解，这需要 PHP 或 ASP 页面来完成。FTP一般使用20和21端口。我真正想要的是能够设置现有的软件来接收来自应用程序的上传请求，然后将自己置于接收模式。这不需要打开另一个端口，我可以定制 VB 代码来处理我喜欢的文件。

我真正需要了解的是，如何让这两个程序进行文件传输？假设我可以使用相同的端口是否合理？

# php - 如何在 PHP 中对数组进行分组？

> ID：13592139
> 
> 赞同：-1
> 
> 时间：2012-11-27T20:04:56.083
> 
> 标签：php, arrays

如何按 houseid 对该数组进行分组？

```
Array
(
    [0] => stdClass Object
        (
            [id] => 1111
            [houseid] => 58
            [price] => 2995
        )

    [1] => stdClass Object
        (
            [id] => 1112
            [houseid] => 58
            [price] => 4050
        )

    [2] => stdClass Object
        (
            [id] => 1114
            [houseid] => 60
            [price] => 1695
        )

    [3] => stdClass Object
        (
            [id] => 1115
            [houseid] => 60
            [price] => 2250
        )

    [4] => stdClass Object
        (
            [id] => 1116
            [houseid] => 60
            [price] => 2295
        )
) 
```

我需要计算一个 houseid 的总价并做一些数学/条件，如果将这个数组分组会很容易......

我可以把这个数组格式化成类似的东西吗

```
Array
(
    [58] => stdClass Object(
        [0] => stdClass Object
        (
            [id] => 1111
            [price] => 2995
        )
        [1] => stdClass Object
        (
            [id] => 1112
            [houseid] => 58
            [price] => 4050
        )
    )
    [60] => stdClass Object(
        [0] => stdClass Object(
            [id] => 1114
            [price] => 1695
        )
        [1] => stdClass Object
        (
            [id] => 1115
            [price] => 2250
        )
        [2] => stdClass Object
        (
            [id] => 1116
            [price] => 2295
        )
) 
```

或者任何人都可以建议我，如何循环原始数组来计算房子的总价格？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T20:10:16.673

您可以使用`array_reduce`

```
$data = array_reduce($data, function ($a, $b) {
    $id = $b->houseid;
    unset($b->houseid);
    $a[$id][] = $b;
    return $a;
});

var_dump($data); 
```

输出

```
array (size=2)
  58 => 
    array (size=2)
      0 => 
        object(stdClass)[1]
          public 'id' => int 1111
          public 'price' => int 2995
      1 => 
        object(stdClass)[2]
          public 'id' => int 1112
          public 'price' => int 4050
  60 => 
    array (size=3)
      0 => 
        object(stdClass)[3]
          public 'id' => int 1114
          public 'price' => int 1695
      1 => 
        object(stdClass)[4]
          public 'id' => int 1115
          public 'price' => int 2250
      2 => 
        object(stdClass)[5]
          public 'id' => int 1116
          public 'price' => int 2295 
```

[完整的现场演示](http://eval.in/3977)

# java - 继续做事直到输入空行

> ID：13592143
> 
> 赞同：0
> 
> 时间：2012-11-27T20:05:00.733
> 
> 标签：java, string, while-loop, sentinel

由于某种原因，我无法让它工作。我有一个读取交易的应用程序，当输入一个空行时，它需要打印出一些东西。

```
 int transationCount = 0;
    while(sc.hasNext())
    {
        String trans = sc.next();

            String mode = trans.substring(0, 1);
            Double amount = Double.valueOf(trans.substring(1));

            if(mode.equals("C"))
            {
                c.charge(amount);
                ps.println(c.getBalance());
                transationCount = transationCount + 1;
            }
            else if(mode.equals("P"))
            {
                c.pay(amount);
                ps.println(c.getBalance());
                transationCount = transationCount + 1;
            }
    }
    ps.println(c.getBalance());
    ps.println(transationCount); 
```

我试过了

```
while(sc.hasNext() && !(sc.next().equals(""))) 
```

不工作。我也尝试在 while 循环中添加

```
else if (!(trans.equals("")) {break;} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T20:07:38.830

默认情况下，扫描仪将忽略空行，因为它不是有效的令牌。

您可以手动检查该行是否为空：

```
public static void main(String[] args) throws Exception {
    Scanner sc = new Scanner(System.in);

    while(true) {
        String line = sc.nextLine();
        if (line.isEmpty()) {
            System.out.println("Empty line entered");
        } else {
            System.out.println("received line: " + line);
            String[] tokens = line.split("\\s+");
            System.out.println("tokens: " + Arrays.toString(tokens));
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T20:25:33.503

您的 Scanner 使用默认分隔符（空格）来标记输入。这意味着标记是单词，无论它们在哪一行。

```
some

word 
```

只返回两个令牌，完全一样

```
some word 
```

您真正需要的是分别获取行，以便区分哪一行是空的，哪一行包含某些内容。为此，请使用新行作为分隔符：

```
Scanner.useDelimiter("\\n"); 
```

或者您也可以使用 BufferedReader，请参阅[BufferedReader.readLine()](http://docs.oracle.com/javase/1.5.0/docs/api/java/io/BufferedReader.html#readLine%28%29)

请注意，同一行上的两个单词现在将包含在同一`trans`字符串中。您可以使用 String.split 方法分别获取每个单词。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-08-14T06:21:03.157

*那么如果输入一个空行，我将如何逃避 while 循环呢？还有其他方法吗？– 信息日*

您可以在您的上方/上方使用**标签**`while loop`，并在遇到 emptyLine 时将其打破

或者你可以使用

```
Scanner sc = new Scanner(System.in);
String line = sc.nextLine();
 while(! line.isEmpty()){

} 
```

`line.isEmpty()`**为空****时**返回*true* ，因此进入while循环的条件将变为**false**，因为现在在while循环中我们有（**！**（true））等于（false），因此while循环不会执行。**`line`**

# javascript - 当用户单击外部图像时尝试更改标记的图标

> ID：13592144
> 
> 赞同：0
> 
> 时间：2012-11-27T20:05:11.580
> 
> 标签：javascript, google-maps

所以想法是改变标记的“图标”属性。我对 javascript 不是很好，所以它真的让我发疯。我拥有的是一张地图，它初始化了一个空白的标记（没有图纸），然后我在 div 的左侧有一些选择。

我想要的是更改该特定实例的（标记）图标图形。

到目前为止，这是我的代码。我需要以某种方式附加一个侦听器，该侦听器根据我在地图之外的一些选项更改此图标图片。

```
<script type="text/javascript">
    var zind = google.maps.Marker.MAX_ZINDEX;

var $map;
var $latlng;
var overlay;
function initialize() {
    var $latlng = new google.maps.LatLng(<?php echo $model->lat; ?>, <?php echo $model->lon; ?>);

    var myOptions = {
        zoom: 16,
        center: $latlng,
        mapTypeId: google.maps.MapTypeId.ROADMAP,
        mapTypeControlOptions: {
            style: google.maps.MapTypeControlStyle.DROPDOWN_MENU,
            position: google.maps.ControlPosition.TOP_LEFT },
        zoomControl: true,
        zoomControlOptions: {
            style: google.maps.ZoomControlStyle.LARGE,
            position: google.maps.ControlPosition.LEFT_TOP
        },
        scaleControl: true,
        scaleControlOptions: {
            position: google.maps.ControlPosition.TOP_LEFT
        },
        streetViewControl: false,

        panControl:false

    };
    $map = new google.maps.Map(document.getElementById("map"),
    myOptions);

    var Vmarker = new google.maps.Marker({
        position: $latlng,
        title: 'Point A',
        map: $map,
        icon: '<?php echo Yii::app()->request->baseUrl; ?>/images/library/td_icons/map/ico_blanco.png',
        zIndex: 500,
        draggable: true

    });
    overlay = new google.maps.OverlayView();
    overlay.draw = function() {};
    overlay.setMap($map); 
```

我已经添加了类似的东西，我想更改 Vmarker 的图标属性，但我不知道应该怎么做？

```
 $(document).ready(function() {
    initialize();

    $("#ico_beer").click(function() {

        var icon = $(this).attr('src');
        google.maps.event.addListener(Vmarker, 'click', function() { 
            Vmarker.icon : icon;   

        });
    }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T21:46:30.227

您想知道当用户单击图标 div 时如何更改图标属性的代码吗？如果是这样，请尝试此代码。

```
<!DOCTYPE html>
<html>
  <head>
    <script src="http://code.jquery.com/jquery-1.8.3.min.js"></script>
    <script src="https://maps.googleapis.com/maps/api/js?sensor=false"></script>
    <script type="text/javascript">
      var zind = google.maps.Marker.MAX_ZINDEX;

      var map;
      var latlng;
      var overlay;
      var Vmarker;
      function initialize() {
        var latlng = new google.maps.LatLng(35, 138);

        var myOptions = {
          zoom : 16,
          center : latlng,
          mapTypeId : google.maps.MapTypeId.ROADMAP,
          mapTypeControlOptions : {
            style : google.maps.MapTypeControlStyle.DROPDOWN_MENU,
            position : google.maps.ControlPosition.TOP_LEFT
          },
          zoomControl : true,
          zoomControlOptions : {
            style : google.maps.ZoomControlStyle.LARGE,
            position : google.maps.ControlPosition.LEFT_TOP
          },
          scaleControl : true,
          scaleControlOptions : {
            position : google.maps.ControlPosition.TOP_LEFT
          },
          streetViewControl : false,
          panControl : false

        };
        map = new google.maps.Map($("#map")[0], myOptions);

        Vmarker = new google.maps.Marker({
          position : latlng,
          title : 'Point A',
          map : map,
          icon : '',
          zIndex : 500,
          draggable : true
        });
        overlay = new google.maps.OverlayView();
        overlay.draw = function() {
        };
        overlay.setMap(map);
      }

      $(document).ready(function() {
        initialize();

        $(".icons").click(function() {
            var icon = $(this).find("img").attr('src');
            Vmarker.setIcon(icon);
        });
      });
    </script>
    <style type="text/css">
      #map {
        width: 75%;
        height: 100%;
        position : absolute;
        left : 0;
        top : 0;
      }

      .icons {
        border : 1px solid #ccc;
        width : 100%;
        height : 40px;
        line-height : 40px;
        overflow : hidden;
        cursor : pointer;
      }
      #bar {
        position : absolute;
        right : 0;
        top : 0;
        width : 25%;
        height : 100%;
      }
      #frame {
        position : relative;
        width : 500px;
        height : 300px;
      }
    </style>

  </head>
  <body>
    <div id="frame">
      <div id="map"></div>
      <div id="bar">
        <div class='icons'><img src="beergarden.png">Beer Garden!</div>
        <div class='icons'><img src="fastfood.png">FastFood</div>
      </div>
    </div>
  </body>
</html> 
```

![在此处输入图像描述](../Images/525d8e71fc24671fb973381d96773514.png)![在此处输入图像描述](../Images/5d3227eddefdf80fe11ed836cbd67a06.png)

# java - 某些 RGB 值似乎无法转换为颜色对象

> ID：13592148
> 
> 赞同：1
> 
> 时间：2012-11-27T20:05:31.310
> 
> 标签：java, image, graphics, colors, rgb

我有这种方法：

```
public void SaveImageOntoObject(String filepath) throws IOException {

      BufferedImage image = ImageIO.read(getClass().getResourceAsStream(filepath));
      this.width = image.getWidth();
      this.height = image.getHeight();
      this.ResetPointInformation();
      for (int row = 0; row < width; row++) {
         for (int col = 0; col < height; col++) {
            this.PointInformation[row][col] = new Color(image.getRGB(col, row));
        }
     }
  } 
```

它将图像的文件路径作为输入，将每个像素的 RPG 值转换为颜色对象，然后将其存储到调用方法的对象的二维数组 PointInformation 中。

**现在我的问题：**

虽然有些图片像这样：

![在此处输入图像描述](../Images/b4a0c5d8581b599bfdb0a95c8e6b0830.png)

像魅力一样工作，其他人像这样：

![在此处输入图像描述](../Images/4f6881d8aecc3465749fdf22f5e89e5c.png)

让我以错误结束：

```
Exception in thread "main" java.lang.ArrayIndexOutOfBoundsException: Coordinate out of bounds!
at sun.awt.image.ByteInterleavedRaster.getDataElements(ByteInterleavedRaster.java:318)
at java.awt.image.BufferedImage.getRGB(BufferedImage.java:888)
at Drawing.Object2D.SaveImageOntoObject(Object2D.java:75)** (that's the class whose object's my method works on) 
```

为什么会这样？似乎 Java 无法将某些 RGB 值转换为颜色？

你能告诉我如何让它工作吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T20:32:49.840

错误消息实际上是这样说的：“索引超出范围”。看来，你混淆了你的坐标和它们的界限。 `getRGB`将参数`x`(range 0 .. `width`) 作为第一个参数，将`y`(range 0 .. `height`) 作为第二个参数。

```
this.width = image.getWidth();
this.height = image.getHeight();

for (int row = 0; row < height; row++) {        // swapped the ...
    for (int col = 0; col < width; col++) {     // ... bounds
        this.PointInformation[row][col] = new Color(image.getRGB(col, row));
    }
} 
```

您的第一个示例具有宽度 = 高度，因此不会出现问题。

# c# - 从资源加载图像

> ID：13592150
> 
> 赞同：33
> 
> 时间：2012-11-27T20:05:35.973
> 
> 标签：c#, image, resources, picturebox

我想像这样加载图像：

```
void info(string channel)
{
    //Something like that
    channelPic.Image = Properties.Resources.+channel
} 
```

因为我不想做

```
void info(string channel)
{
    switch(channel)
    {
        case "chan1":
            channelPic.Image = Properties.Resources.chan1;
            break;
        case "chan2":
            channelPic.Image = Properties.Resources.chan2;
            break;
    }
} 
```

这样的事情可能吗？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2012-11-27T20:17:49.523

您始终可以使用which 返回此类使用`System.Resources.ResourceManager`的缓存。`ResourceManager`由于`chan1`和`chan2`代表两个不同的图像，您可以使用`System.Resources.ResourceManager.GetObject(string name)`which 返回与您的输入匹配的对象与项目资源

**例子**

```
object O = Resources.ResourceManager.GetObject("chan1"); //Return an object from the image chan1.png in the project
channelPic.Image = (Image)O; //Set the Image property of channelPic to the returned object as Image 
```

**注意**：如果在项目资源中找不到指定的字符串，`Resources.ResourceManager.GetObject(string name)`可能会返回。`null`

谢谢，
我希望你觉得这有帮助:)

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-11-27T20:17:07.400

您可以使用以下方法执行此操作[`ResourceManager`](http://msdn.microsoft.com/en-us/library/system.resources.resourcemanager.aspx)：

```
public bool info(string channel)
{
   object o = Properties.Resources.ResourceManager.GetObject(channel);
   if (o is Image)
   {
       channelPic.Image = o as Image;
       return true;
   }
   return false;
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2014-05-30T11:30:28.440

试试这个WPF

```
StreamResourceInfo sri = Application.GetResourceStream(new Uri("pack://application:,,,/WpfGifImage001;Component/Images/Progess_Green.gif"));
picBox1.Image = System.Drawing.Image.FromStream(sri.Stream); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-11-27T20:31:11.587

如果您的图像在资源文件中，ResourceManager 将起作用。如果它只是您项目中的一个文件（假设是根目录），您可以使用以下方式获取它：

```
System.Reflection.Assembly assembly = System.Reflection.Assembly.GetExecutingAssembly();
System.IO.Stream file = assembly .GetManifestResourceStream("AssemblyName." + channel);
this.pictureBox1.Image = Image.FromStream(file); 
```

或者，如果您在 WPF 中：

```
 private ImageSource GetImage(string channel)
    {
        StreamResourceInfo sri = Application.GetResourceStream(new Uri("/TestApp;component/" + channel, UriKind.Relative));
        BitmapImage bmp = new BitmapImage();
        bmp.BeginInit();
        bmp.StreamSource = sri.Stream;
        bmp.EndInit();

        return bmp;
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-12-16T09:52:07.983

```
 this.toolStrip1 = new System.Windows.Forms.ToolStrip();
    this.toolStrip1.Location = new System.Drawing.Point(0, 0);
    this.toolStrip1.Name = "toolStrip1";
    this.toolStrip1.Size = new System.Drawing.Size(444, 25);
    this.toolStrip1.TabIndex = 0;
    this.toolStrip1.Text = "toolStrip1";
    object O = global::WindowsFormsApplication1.Properties.Resources.ResourceManager.GetObject("best_robust_ghost");

    ToolStripButton btn = new ToolStripButton("m1");
    btn.DisplayStyle = ToolStripItemDisplayStyle.Image;
    btn.Image = (Image)O;
    this.toolStrip1.Items.Add(btn);

    this.Controls.Add(this.toolStrip1); 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2014-12-09T18:53:17.973

您可以在项目中添加图像资源，然后（右键单击项目并选择“*属性*”项）以这种方式访问​​它：

```
this.picturebox.image = projectname.properties.resources.imagename; 
```

# c# - 使用 .net 的消息服务客户端连接到 IBM WMQ 时如何传递身份验证信息

> ID：13592152
> 
> 赞同：3
> 
> 时间：2012-11-27T20:05:36.480
> 
> 标签：c#, .net, ibm-mq

我们正在使用 c# 开发一个控制台应用程序来访问 IBM WMQ。我们正在使用 IBM Message Service Client for .net (XMS) 和 WebSphere MQ 客户端。以下是代码示例：

```
 XMSFactoryFactory xff = XMSFactoryFactory.GetInstance(XMSC.CT_WMQ);
            IConnectionFactory cf = xff.CreateConnectionFactory();
            cf.SetStringProperty(XMSC.WMQ_HOST_NAME, "host");
            cf.SetIntProperty(XMSC.WMQ_PORT, 1445);
            cf.SetStringProperty(XMSC.WMQ_CHANNEL, "channel");
            cf.SetIntProperty(XMSC.WMQ_CONNECTION_MODE, XMSC.WMQ_CM_CLIENT);
            cf.SetStringProperty(XMSC.WMQ_QUEUE_MANAGER, "queueManager");
            cf.SetIntProperty(XMSC.WMQ_BROKER_VERSION, XMSC.WMQ_BROKER_V1);
            cf.SetStringProperty(XMSC.USERID, @"userid");
            cf.SetStringProperty(XMSC.PASSWORD, @"");

            IConnection conn = cf.CreateConnection();
            conn.ExceptionListener = new ExceptionListener(OnXMSExceptionReceived);
            Console.WriteLine("connection created");
            ISession sess = conn.CreateSession(false, AcknowledgeMode.AutoAcknowledge); 
```

我们不断收到以下错误：CWSMQ0044E：用户无权连接到队列管理器。应用程序试图在未经授权的情况下连接到队列管理器。确保该用户的队列管理器上存在适当的权限。

但是我们使用spring集成访问同一个MQ是没有问题的。这是弹簧集成的设置：

```
<bean id="connectionFactoryWBI" class="com.ibm.mq.jms.MQQueueConnectionFactory">
    <property name="hostName" value="${hostName}" />
    <property name="port" value="${port}" />
    <property name="queueManager" value="${queueManager}" />
    <property name="channel" value="${channel}" />
    <property name="transportType" value="1" />
</bean>

<bean id="connectionFactoryWBIWithCredentials" class="org.springframework.jms.connection.UserCredentialsConnectionFactoryAdapter">
    <property name="targetConnectionFactory" ref="connectionFactoryWBI" />
    <property name="username" value="${username}" />
</bean> 
```

我是 XMS 和 .net 的新手，不知道如何传递身份验证信息以连接到 MQ。任何建议都非常受欢迎！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T04:28:02.457

XMS .NET 和 MQ JMS 客户端的工作方式略有不同。当连接到队列管理器时，XMS .NET 首先发送当前登录的 Windows 用户 ID，然后发送应用程序指定的用户 ID。如果这两个用户 id 相同，则创建连接。但是，如果它们不同，那么您将得到`CWSMQ0044E`错误。这基本上是 MQ 原因代码 2035，MQRC_NOT_AUTHORIZED。但是，对于 MQ JMS，只发送应用程序指定的用户 ID，不发送 Windows 用户 ID。因此，您看不到错误。

有多种方法可以解决您在使用 XMS .NET 时遇到的问题：
1) 使用 MQ 服务器端安全出口。
2) 通道认证记录（从 MQ v7.1 开始提供）

这个问题已经在[这里](https://stackoverflow.com/questions/7310632/websphere-mq-7-c-sharp-xms-connection-using-a-different-user?rq=1)讨论过了。

# makefile - GNU Make：在先决条件中使用过滤器功能

> ID：13592154
> 
> 赞同：3
> 
> 时间：2012-11-27T20:05:39.867
> 
> 标签：makefile, gnu-make

我想编译一些 C++ 文件，我绝对必须将所有目标文件放在一个单独的构建目录中，但存储完全平坦，即没有任何进一步的子目录。我知道使用 VPATH 的常见解决方案，它是这样的：

```
SOURCES = foo/one.cpp \
    foo/bar/two.cpp \
    foo/bar/sub/three.cpp

OBJDIR = obj

VPATH=$(dir $(SOURCES))

OBJECTS = $(addprefix $(OBJDIR)/, $(notdir $(SOURCES:%.cpp=%.o)))

$(OBJDIR)/%.o : %.cpp
    @echo Should compile: $(filter %/$*.cpp, $(SOURCES))
    @echo Compiling $<

all: $(OBJECTS) 
```

这个例子非常有效：我在“obj”子目录中获得了三个目标文件 one.o、two.o、three.o（您可以假设它只是存在）。

现在这是使用 VPATH 时的问题：如果碰巧有一个文件 'foo/three.cpp'，那么*它将*被编译而不是在 SOURCES 变量中命名的 'foo/bar/sub/three.cpp'。不，我不能重命名任何一个文件；这个名字冲突只是存在，我对此无能为力。

所以我的问题是：如何告诉 Make*只*使用出现在 SOURCES 变量中的“.cpp”文件？我认为最好的解决方案是在目标的先决条件中使用“过滤器”语句。我认为这应该可以使用二次扩展，但我不知道如何处理'％'。例如，我试过

```
 .SECONDEXPANSION:
$(OBJDIR)/%.o : $$(filter %/$$*.cpp, $(SOURCES)) 
```

但这不起作用。

* * *

**更新**：在 Tripleee 的帮助下，我设法使用以下方法完成了这项工作：

```
define make-deps
$(OBJDIR)/$(notdir $(1:%.cpp=%.o)): $1
endef

$(foreach d, $(SOURCES), $(eval $(call make-deps,$d)))

%.o : 
    @echo Should compile $^ into $@
    @echo Compiling $^ 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T20:42:05.857

我怀疑解决您的问题的最简单方法是明确摆脱`VPATH`并记录每个依赖项。这可以很容易地从您的`SOURCES`定义中获得；也许您想定义一个函数，但实际上归结为：

```
obj/one.o: foo/one.cpp
obj/two.o: foo/bar/two.cpp
obj/three.o: foo/bar/sub/three.cpp 
```

实际规则可以保留，只是它不应该再包含内联依赖项，并且您可以跳过`obj/`子目录，因为它在每个依赖项中显式声明：

```
%.o : # Dependencies declared above
    @echo Should compile $^ into $@
    @echo Compiling $^ 
```

我将规则更改为使用`$^`，而不是`$<`在您拥有多个依赖项的情况下。对于您的情况，这可能是正确的或错误的；如果不是您需要的，请还原更改。

为了不需要手动维护依赖关系，您可能希望`%.d`为每个`%.cpp`文件生成。请参阅[GNU Make 手册](http://www.gnu.org/software/make/manual/html_node/Automatic-Prerequisites.html)。（我试图通过使用 a 来做到这一点`define`，但似乎你不能用`foreach`循环声明依赖关系。）

针对评论中的问题，这不应以任何方式影响并行构建；当`VPATH`. 没有新的依赖关系，也没有新的规则。

# javascript - Ready vs ReadyDeprecated

> ID：13592156
> 
> 赞同：2
> 
> 时间：2012-11-27T20:05:51.453
> 
> 标签：javascript, rally

因此，在我的自定义 KanbanBoard 应用程序中，我最近注意到 READY 绿色边框已经消失。

我已经开始尝试调试，但似乎无法理解发生了什么。

在我的板上，用户可以单击 READY 图标，边框变为绿色，在查看故事时，它显示 READY 为真。一切都很好。

当我按下 F5 时，绿色边框消失了，但就绪字段仍然为真。认为这是我所做的，所以删除了所有 CSS 覆盖，但板仍然无法工作。

调试也是如此，直接从桌面运行 HTML，现在甚至卡上都没有就绪按钮。

查到这里，发现如果没有ready列，按钮是不会出现的。

所以我曾经在我的 getAdditionalFields 函数中有“Ready”，因为我尝试过“isReady”，“ReadyDeprecated”。但似乎无法进入这个领域。

我检查了 API Docs 并从文档中查询，尝试了 READY 和 READYDEPRECATED，它们返回不同的结果集。

在调试器中，我看到了 ReadDeprecated 字段，但没有 Ready 字段。但是查看一个故事，我看到一个布尔值的就绪字段，我设置为 true 的卡片仍然显示为 true，尽管没有绿色边框......

关于去哪里的任何建议？我缺少任何背景吗？很确定这是以前的工作......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T21:23:27.027

在最近的版本中，Rally 为我们所有的工件添加了对 Ready 的支持。当我们在 1.38 版本的 API 中添加 Ready 标志时。当我们这样做时，我们将任何名为 Ready 的自定义字段更改为 ReadyDeprecated。

一个简单的解决方法是将您的应用程序更改为使用当前版本的 API 到最新版本的 WSAPI。

您可以通过将 apiVersion 添加到脚本包含来更改 AppSDK 1.0 应用程序以使用更新版本的 WSAPI。

```
src="/apps/1.32/sdk.js?apiVersion=1.38" 
```

使用 wsapiVersion 属性可以在 SDK 2.0 应用程序中完成相同的操作。

```
src="/apps/2.0p/sdk.js?wsapiVersion=1.38" 
```

# castle-windsor - 如果使用 Castle LoggingFacility，客户端应用程序是否还需要引用 Log4Net？

> ID：13592160
> 
> 赞同：0
> 
> 时间：2012-11-27T20:06:02.527
> 
> 标签：castle-windsor, castle

我问这个的原因是如果 log4net.dll 不在 GAC 中，也不在当前的 Executing Assembly 目录中，casting Logging 工具将找不到它。

我已经构建了一个类库，多个客户端应用程序将使用它来使用 Castle 和 Windsor 进行日志记录，我注意到我根本不需要在我的类库中引用 log4net.dll，它只需要能够在运行时查看 dll。

所以我只是想知道引用真正应该在哪里，因为如果我把它放在我的类库中，即使本地复制是真的，它也不会复制到客户端，我认为因为它实际上从未直接使用过。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T22:03:21.683

您肯定需要提供 log4net.dll 才能让 Castle 日志记录工具正常工作（假设您已将日志记录工具配置为使用 log4net）。您是正确的，您不再需要在项目中直接引用 log4net，因为您现在将使用 Castle.Core 的 ILogger 接口来实际编写日志消息。您的应用程序仍然依赖于 log4net，尽管是间接的。

Visual Studio 通常会正确处理这些类型的“间接”引用（A 取决于 B 取决于 C）（它将 C 复制到 A 的输出目录）。但是，当 C 在执行构建的机器上的 GAC 中时，它不会*复制*间接引用（它不会将 C 复制到 A 的输出目录）。

我的猜测是你的开发机器上有 log4net.dll GAC'd。

要解决此问题，您需要从 GAC（以及您将构建应用程序的任何机器上的 GAC）中删除 log4net.dll，或者您必须*在*顶级可执行文件（项目 A在上面的示例中）*并将*“本地复制”设置为 true。这会强制编译器将 dll 复制到输出目录。

这个问题也在[这个 SO question中讨论过](https://stackoverflow.com/questions/353617/)

# python - 在python中获取文件名

> ID：13592161
> 
> 赞同：0
> 
> 时间：2012-11-27T20:06:07.007
> 
> 标签：python, python-2.7

我有以下代码来获取特定目录中的文件名列表

```
import sys,os

data_files = [x[2] for x in os.walk(os.path.dirname(sys.argv[0]))]
print data_files 
```

输出类似于

```
[['bar.py',  'foo.py', 'foo.pyc', 'fooBar', 'fooBar.py', 'tar.py', 'tar.pyc']] 
```

我想解析这个列表并只将一个特定的文件名传递给另一个函数

例如：我想解析上面的列表？（它是一个列表吗？）并且只将 tar.py 传递给另一个函数，即名称 tar ，以便另一个函数可以像使用它一样

```
import filename ( in this case tar) 
```

我是 python 新手，尝试了很多列表解析的东西，但无法提取名称。任何帮助，将不胜感激

我正在使用 python 2.7

感谢您的时间

编辑：

我想出了如何解析列表

```
data_files = [x[2] for x in os.walk(os.path.dirname(sys.argv[0]))]
hello = data_files[0]
print hello[0].split(".")[0] 
```

问题是当我尝试将文件名分配给变量时

```
var = hello[0].split(".")[0] 
```

并使用`import var`

但我不确定 python 是否允许导入这样的模块，因为它不将 var 视为变量而是模块名称。我怎样才能克服这个

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T20:43:58.010

我对列表解析的含义有些困惑。它是一个列表，如果您想删除所有文件扩展名，您可以使用列表理解来完成，并按照 fastreload 的建议进行拆分。

```
new_list = [x.split('.')[0] for x in data_files] 
```

如果您需要逐步查看每个文件的列表，您可以使用

```
for file in data_files:
    your code goes here 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T20:51:08.727

如果你知道你的元素在哪个索引，你可以这样做`file_list[index_of_your_element].split('.')[0]`，例如：

```
file_list = ['bar.py',  'foo.py', 'foo.pyc', 'fooBar', 'fooBar.py', 'tar.py', 'tar.pyc']
print l[5].split('.')[0] == 'tar' 
```

将打印`true`。您的问题有点令人困惑，您对元素了解多少，您想如何使用它？

# python - 将数字从一个列表移动到另一个列表的最快方法

> ID：13592166
> 
> 赞同：0
> 
> 时间：2012-11-27T20:06:23.370
> 
> 标签：python, list, optimization, iteration

我有一个清单：

```
list1=[1,8,2,9,3,8,7,10] 
```

我想知道将以上所有值拉到“7”并将它们放入新列表中的绝对最快方法。我不想使用 for 循环，当列表中有数亿个项目时，这会花费太长时间。

所以理想情况下是这样的：

```
list1=[1,8,2,9,3,8,7,10]
list2=AboveNumber(7,list1)
print list2
>>>[8,9,8,10] 
```

感谢您的任何建议！处理时间赞赏！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T20:40:09.497

我不会太担心维护排序顺序和使用`numpy`：

```
import numpy as np
a = np.arange(50)
print a[a >= 7]

#[ 7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31
 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49] 
```

如果您有已排序的项目，则可以使用该`bisect`模块（或`numpy`有自己的方法来处理已排序的数据）：

```
import bisect

items = range(50)
index = bisect.bisect_left(items, 7)
print items[index:]
# [7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49] 
```

并按排序顺序添加项目：

```
bisect.insort_left(items, 3)
print items
#[0, 1, 2, 3, 3, 4, 5, .. snip ...] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T20:48:17.093

如上所述，第一个解决方案是对列表进行排序并仅保留感兴趣值之后的部分。使用 ipython 单元格 timeit

```
data = randint(10,size=2000) 
```

天真的方法

```
%%timeit
[ i for i in data if i>7 ]
# 1.8 ms per loop 
```

排序方法

```
data2 = sorted(data)
import bisect

%%timeit
data2[bisect.bisect(data2,7):]
# 13.6 us per loop 
```

但总的来说，如果您必须处理数值数据，我强烈建议您使用**numpy**库。用朴素的方法已经几乎和排序方法一样快了

```
import numpy as np
adata = np.array(data)

%%timeit
adata[adata>7]
# 28.5 us per loop 
```

但即使使用 numpy 数组，您也可以使用排序方法：

```
adata.sort()

%%timeit
adata[adata.searchsorted(7):]
# 2.1 us per loop 
```

数组越大，numpy 数组的性能越好，它接近于优化的 C 例程（实际上，它们是一堆优化的 C 代码，你只需支付调用 python 包装器的重载）

### 编辑：

请注意，速度之间的关系随数组大小而变化。朴素的 numpy 方法和列表的排序方法对于大约 5*10^5 个元素的速度相同，而在相同的大小下，带有排序数组的 numpy 方法或多或少快 3000 倍。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T20:12:05.350

AboveNumber 不能做任何魔术。如果列表是无序的，它必须遍历列表中的所有项目。

您可以通过按顺序维护列表来优化这一点，即确保列表始终在插入或擦除之后排序。

如果列表是有序的，您可能会通过二进制搜索找到您的“平均值”，这比遍历所有列表要快得多，然后在该位置剪切列表。

# sip - Linphone 没有发送 re-INVITE 消息

> ID：13592173
> 
> 赞同：6
> 
> 时间：2012-11-27T20:06:47.167
> 
> 标签：sip, kamailio

我正在尝试使用 Linphone 作为 UA 和 Kamailio 作为 SIP 代理/注册器来实现 SIP 通话中移动性。我开始在同一网络 (A) 中的两个 UA 之间进行通信，然后将其中一个 UA 移动到网络 (B)。根据 RFC 3261，linphone（或任何其他符合它的 UA）应向其他 UA（另一个使用 linphone 的用户）发送 re-INVITE 消息，以便通知他网络中的新 IP (B)，但这没有发生，linphone 没有发送 re-INVITE ..... 对话停止。你能帮忙解决这个问题吗？我想知道 linphone 是否默认支持 re-INVITE 功能？如果不是我怎么能激活它？或者，如果您在我描述的架构中发现缺陷/问题，请告诉如何修复它。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2020-06-21T06:16:01.913

这是一篇旧帖子，但作为更新：Linphone 如今（2020 年）支持通话中移动性。它会在每次网络更改时发送带有“主题：媒体更改”的 reINVITE。

# python - 改变单词的一部分

> ID：13592174
> 
> 赞同：1
> 
> 时间：2012-11-27T20:06:49.533
> 
> 标签：python, string, list

我试图弄清楚如何做到这一点：

```
>>>sentence = "There's something right there."
>>>change_s(sentence)
['there', 'his', 'something', 'right', 'there.']
>>>sentence = "it's Patrick's car."
>>>change_s(sentence)
['it', 'his', 'Patrick', 'his', 'car.'] 
```

所以基本上我想将“'s”更改为“his”（即使它在语法上不正确）并将这些单词放在一个列表中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T20:08:14.923

```
In [6]: sentence = "There's something right there."

In [7]: sentence.replace("'s", " his").split()
Out[7]: ['There', 'his', 'something', 'right', 'there.'] 
```

# c# - asp.net selectedvalue 有条件地绑定

> ID：13592182
> 
> 赞同：0
> 
> 时间：2012-11-27T20:07:49.200
> 
> 标签：c#, asp.net

我喜欢做一个条件绑定。例如，如果 SelectedValue 为空，我喜欢将其绑定到“太平洋时间”。以下不起作用，但会让您了解我正在尝试做的事情

```
 SelectedValue='<%# Bind("Zone") ?? "Pacific Time" %>' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T20:12:34.460

我知道这不是您要问的，但是在您的数据源中，如果它为 NULL，您能否将值设为 Pacific？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T20:16:23.723

这应该工作

```
SelectedValue='<%# Bind("Zone") != null ? (string)Bind("Zone") : "Pacific Time" %>' 
```

# asp.net-mvc - MVC 应用程序中的报表向导

> ID：13592183
> 
> 赞同：0
> 
> 时间：2012-11-27T20:07:55.230
> 
> 标签：asp.net-mvc, visual-studio-2010, reporting

经过一番研究，我了解到只要视图引擎是 web 表单而不是 razor，我们就可以在 mvc 应用程序中使用 sql server 报告。

我一直在尝试遵循的教程是：

[使用 Visual Studio 2010 创建 ASP.net 报告](http://weblogs.asp.net/rajbk/archive/2010/05/09/creating-an-asp-net-report-using-visual-studio-2010-part-1.aspx)

问题出在第 2 部分。我找不到列为数据源的本地类。唯一的选择是建立一个新的 xsd 文件来连接数据库。如何让我的报告将我的数据存储库用作其数据源？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T21:06:13.287

功劳归于 TNCodeMonkey！

不仅要先编译项目，我们还必须在 MVC Web 应用程序的根文件夹中有一个 index.aspx 文件。

我不知道为什么。但是一旦魔术文件到位，数据源就会填充我所有的 dll。

# javascript - 如何按各自的顺序从数组中选择每个元素？（jQuery，JS）

> ID：13592186
> 
> 赞同：2
> 
> 时间：2012-11-27T20:08:15.997
> 
> 标签：javascript, jquery

我的代码：

我知道我的 for 循环将所有数组元素分配给变量 pickSound，这就是为什么我只剩下它只播放最后一个元素的原因。那么我怎样才能让它按顺序播放每个元素并在完成后重新开始。

```
 function show() {
        var sounds = new Array(
            "audio/basement.mp3",
            "audio/roll.mp3",
            "audio/gatorade.mp3",
            "audio/half.mp3",
            "audio/hotdogs.mp3",
            "audio/keys.mp3",
            "audio/heil.mp3",
            "audio/money.mp3",
            "audio/ours.mp3",
            "audio/pass.mp3"
        );

        for (var i = 0; i < sounds.length; i++){
    var pickSound = sounds[i];     
        }

        $('#divOne').html("<embed src=\""+ pickSound +"\" hidden=\"true\" autostart=\"true\" />");
        return false;
    }; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T20:33:53.727

您可以尝试使用`audio`元素和`ended`事件。

HTML：

```
<audio id="audio" controls preload></audio> 
```

JS：

```
(function() {
    var audioEl = document.getElementById('audio'),
        counter = -1,
        songs = [
            'http://forestmist.org/wp-content/uploads/2010/04/html5-audio-loop.mp3',
            'http://www.quackit.com/music/good_enough.mp3',
            'http://forestmist.org/wp-content/uploads/2010/04/html5-audio-loop.mp3',
            'http://www.quackit.com/music/good_enough.mp3'];

    function nextSong() {
        audioEl.removeEventListener('ended', nextSong);

        if (songs[++counter]) {
            audioEl.src = songs[counter];
            audioEl.addEventListener('ended', nextSong);
            audioEl.play();
        } else {
            alert('All done!');
        }
    }

    nextSong();
}());​ 
```

[**演示**](http://jsfiddle.net/mUdfw/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T20:26:34.037

> *“我应该补充一点，每次点击按钮都会播放一个新的声音。所以可以随时播放一个新的声音。”*

我认为这意味着声音不会在自动循环中连续播放。您打算单击按钮播放下一个声音然后停止？

在下面的代码中，`nextSound`变量保存了接下来应该播放的任何声音的索引。单击按钮时（根据需要插入按钮的 ID 或其他选择器），将使用与该索引关联的文件名，然后使用[模运算符](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Arithmetic_Operators#.25_.28Modulus.29)`nextSound`递增以在到达数组末尾时循环回零。

```
$(document).ready(function() {
   var sounds = ["audio/basement.mp3",
                 "audio/roll.mp3",
                 "audio/gatorade.mp3",
                 "audio/half.mp3",
                 "audio/hotdogs.mp3",
                 "audio/keys.mp3",
                 "audio/heil.mp3",
                 "audio/money.mp3",
                 "audio/ours.mp3",
                 "audio/pass.mp3"],
       nextSound = 0;

    $("#yourButtonIDHere").click(function() {
       $('#divOne').html("<embed src=\""+ sounds[nextSound] +"\" hidden=\"true\" autostart=\"true\" />");
       nextSound = (nextSound + 1) % sounds.length;
    });
}); 
```

另请注意，通常建议使用方括号`[]`数组文字语法而不是`new Array()`.

# windows - 将 CDialogBar 与 CToolbar 水平对接

> ID：13592187
> 
> 赞同：0
> 
> 时间：2012-11-27T19:29:31.410
> 
> 标签：windows, visual-c++, visual-c++-6

我需要水平显示一个 CToolbar (m_wndToolBar) 和一个 CDialogBar (m_wndDlgBarSid1)（即彼此相邻，而不是彼此上方）。父框架派生自 CMDIFrameWnd。

我已经尝试了各种变化来让它工作。虽然我可以将 CDialogBar 正确定位到 CToolbar 的右侧，但我无法保持定位，尽管 WINDOWPLACEMENT 机制工作正常（注册表是在程序退出时编写的）；每当程序运行时，CToolbar 显示在左侧停靠，CDialogBar 显示在其下方，也停靠在左侧。我正在使用（perforce）MFC 和 Visual C++ 6.0。这是代码，稍微编辑以删除调试打印输出等：

```
int CMainFrame::OnCreate(LPCREATESTRUCT lpCreateStruct)
{
   if (CMDIFrameWnd::OnCreate(lpCreateStruct) == -1)
   {
      return -1;
   }
   if (!m_wndToolBar.Create(this) || !m_wndToolBar.LoadToolBar(IDR_MAINFRAME) )
   {
      return -1;      // fail to create
   }
   if (!m_wndDlgBarSid1.Create(this, IDD_DIALOGBAR_SID1, CBRS_ALIGN_TOP, AFX_IDW_DIALOGBAR))
   {
      return -1;        // fail to create
   }

   WINDOWPLACEMENT wp ;
   CString sSection = "DialogBarSettings";
   CString sEntry = "Sid1";
   if ( ReadWindowPlacement( &wp, sSection, sEntry ))
   {
      BOOL bSWP = m_wndDlgBarSid1.SetWindowPlacement( &wp );
      RecalcLayout();
   }

   m_wndToolBar.SetBarStyle(m_wndToolBar.GetBarStyle() | CBRS_TOOLTIPS | CBRS_FLYBY | CBRS_SIZE_DYNAMIC);
   m_wndToolBar.GetToolBarCtrl().ModifyStyle( 0, TBSTYLE_FLAT, 0 ) ;
   m_wndDlgBarSid1.SetBarStyle(m_wndToolBar.GetBarStyle() | CBRS_SIZE_DYNAMIC | CBRS_TOP | CBRS_GRIPPER | CBRS_TOOLTIPS | CBRS_FLYBY ) ;

   m_wndToolBar.EnableDocking(CBRS_ALIGN_ANY);
   EnableDocking(CBRS_ALIGN_ANY);
   DockControlBar(&m_wndToolBar);

   m_wndDlgBarSid1.EnableDocking(CBRS_ALIGN_TOP | CBRS_ALIGN_BOTTOM);
   DockControlBar(&m_wndDlgBarSid1,AFX_IDW_DOCKBAR_TOP);

   return 0;
} 
```

有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-15T04:26:41.023

在返回零之前粘贴下面的代码。这将加载之前保存的对接状态。

```
CDockState dockState;
dockState.LoadState(L"CTRLBARSDOCKSTATE.INI");
SetDockState(dockState);
RecalcLayout(); 
```

要在窗口关闭时保存当前停靠状态，请将以下代码粘贴到 CMainFrame::OnClose() 覆盖中。

```
CDockState dockState;
GetDockState(dockState);
dockState.SaveState(L"CTRLBARSDOCKSTATE.INI");//File name can be of your choice 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T21:58:42.920

使用 CReBar 结束，这非常接近我的需要。

# python - 编译 pygraphviz：无法识别的命令行选项 '-mno-cygwin'

> ID：13592192
> 
> 赞同：17
> 
> 时间：2012-11-27T20:08:37.247
> 
> 标签：python, mingw32, pygraphviz

在 Windows 7 上，尝试编译 pygraphviz 时，我运行

```
 python setup.py build -c mingw32 
```

我明白了

> C:\MinGW\bin\gcc.exe -mno-cygwin -mdll -O -Wall "-IC:\Program Files (x86)\Graphv iz 2.28\include\graphviz" -Ic:\Python27\include -Ic:\ Python27\PC -c pygraphviz/g raphviz_wrap.c -o build\temp.win-amd64-2.7\Release\pygraphviz\graphviz_wrap.o cc1.exe：错误：无法识别的命令行选项'-mno-cygwin' 错误：命令' gcc' 失败，退出状态为 1

那个'-mno-cygwin'来自哪里？通过 pygraphviz-1.1 目录搜索显示没有出现“no-cygwin”。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-12-12T16:14:34.060

看到这个答案：[https ://stackoverflow.com/a/6035864/1516291](https://stackoverflow.com/a/6035864/1516291)

简而言之，您可能需要`distutils\cygwinccompiler.py`在 python 安装目录中修改以删除`-mno-cygwin`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-01-24T10:11:12.160

我遇到了同样的问题，已通过将字符串“-mno-cygwin”的实例替换为“”中的“”来解决`C:\Python27\Lib\distutils\cygwinccompiler.py`

即原始代码：

```
 self.set_executables(compiler='gcc -mno-cygwin -O -Wall',
                         compiler_so='gcc -mno-cygwin -mdll -O -Wall',
                         compiler_cxx='g++ -mno-cygwin -O -Wall',
                         linker_exe='gcc -mno-cygwin',
                         linker_so='%s -mno-cygwin %s %s'
                                    % (self.linker_dll, shared_option,
                                       entry_point)) 
```

更新代码：

```
 self.set_executables(compiler='gcc "" -O -Wall',
                         compiler_so='gcc "" -mdll -O -Wall',
                         compiler_cxx='g++ "" -O -Wall',
                         linker_exe='gcc ""',
                         linker_so='%s "" %s %s'
                                    % (self.linker_dll, shared_option,
                                       entry_point)) 
```

你使用什么版本的 GCC 编译器？如果您使用 GCC 3.4.4，您将不会遇到此问题，否则您需要将“-mno-cygwin”字符串替换为上面提到的空引号，特别是对于 GCC 4.3.7。

# c - GPU 代码运行速度比 CPU 版本慢

> ID：13592194
> 
> 赞同：6
> 
> 时间：2012-11-27T20:08:40.633
> 
> 标签：c, cuda, gpgpu

我正在开发一个应用程序，它将字符串分成几部分并将每个部分分配给一个块。在每个块中，文本被逐个字符地扫描，一个共享的 int 数组，D 将由不同的线程根据读取的字符并行更新。在每次迭代结束时检查 D 的最后一个元素，如果满足条件，则在文本对应的位置将全局 int 数组 m 设置为 1。此代码在 NVIDIA GEForce Fermi 550 上执行，运行速度甚至比 CPU 版本还要慢。我刚刚在这里包含了内核：

```
__global__ void match(uint32_t* BB_d,const char* text_d,int n, int m,int k,int J,int lc,int start_addr,int tBlockSize,int overlap ,int* matched){
    __shared__ int D[MAX_THREADS+2];
    __shared__ char Text_S[MAX_PATTERN_SIZE];
    __shared__ int DNew[MAX_THREADS+2];
    __shared__ int BB_S[4][MAX_THREADS];
    int w=threadIdx.x+1;

    for(int i=0;i<4;i++)
    {
        BB_S[i][threadIdx.x]= BB_d[i*J+threadIdx.x];
    }

    {
        D[threadIdx.x] = 0;
        {
            D[w] = (1<<(k+1)) -1;

            for(int i = 0; i < lc - 1; i++)
            {
                D[w] = (D[w] << k+2) + (1<<(k+1)) -1;
            }
        }
        D[J+1] = (1<<((k+2)*lc)) - 1;
    }
    int startblock=(blockIdx.x == 0?start_addr:(start_addr+(blockIdx.x * (tBlockSize-overlap))));
    int size= (((startblock + tBlockSize) > n )? ((n- (startblock))):( tBlockSize));

    int copyBlock=(size/J)+ ((size%J)==0?0:1);
    if((threadIdx.x * copyBlock) <= size)
        memcpy(Text_S+(threadIdx.x*copyBlock),text_d+(startblock+threadIdx.x*copyBlock),(((((threadIdx.x*copyBlock))+copyBlock) > size)?(size-(threadIdx.x*copyBlock)):copyBlock));
    memcpy(DNew, D, (J+2)*sizeof(int));
    __syncthreads();
    uint32_t initial = D[1];
    uint32_t x;
    uint32_t mask = 1;
    for(int i = 0; i < lc - 1; i++)mask = (mask<<(k+2)) + 1;
    for(int i = 0; i < size;i++)
    {
        {
            x =  ((D[w] >> (k+2)) | (D[w - 1] << ((k + 2)* (lc - 1))) | (BB_S[(((int)Text_S[i])/2)%4][w-1])) & ((1 << (k + 2)* lc) - 1);
            DNew[w] = ((D[w]<<1) | mask)
                & (((D[w] << k+3) | mask|((D[w +1] >>((k+2)*(lc - 1)))<<1)))
                & (((x + mask) ^ x) >> 1)
                & initial;
        }
        __syncthreads();
        memcpy(D, DNew, (J+2)*sizeof(int));
        if(!(D[J] & 1<<(k + (k + 2)*(lc*J -m + k ))))
        {
            matched[startblock+i] = 1;
            D[J] |= ((1<<(k + 1 + (k + 2)*(lc*J -m + k ))) - 1);
        }
    }
} 
```

我对 CUDA 不是很熟悉，所以我不太了解共享内存库冲突等问题。这可能是这里的瓶颈吗？

如所问，这是我启动内核的代码：

```
#include <stdio.h>
#include <assert.h>
#include <cuda.h>
#define uint32_t unsigned int
#define MAX_THREADS 512
#define MAX_PATTERN_SIZE 1024
#define MAX_BLOCKS 8
#define MAX_STREAMS 16
#define TEXT_MAX_LENGTH 1000000000
void calculateBBArray(uint32_t** BB,const char* pattern_h,int m,int k , int lc , int J){};
void checkCUDAError(const char *msg) {
    cudaError_t err = cudaGetLastError();
    if( cudaSuccess != err) 
    {   
            fprintf(stderr, "Cuda error: %s: %s.\n", msg, 
                            cudaGetErrorString( err) );
            exit(EXIT_FAILURE);
    }    
}
char* getTextString() {
 FILE *input, *output;
 char c;
 char * inputbuffer=(char *)malloc(sizeof(char)*TEXT_MAX_LENGTH);

int numchars = 0, index  = 0;

input = fopen("sequence.fasta", "r");
c = fgetc(input);
while(c != EOF)
{
inputbuffer[numchars] = c;
numchars++;
c = fgetc(input);
}
fclose(input);
inputbuffer[numchars] = '\0'; 
return inputbuffer;
}

int main(void) {
const char pattern_h[] = "TACACGAGGAGAGGAGAAGAACAACGCGACAGCAGCAGACTTTTTTTTTTTTACAC";
char * text_h=getTextString();  //reading text from file, supported upto 200MB currently

int k = 13;
int i;
int count=0;
char *pattern_d, *text_d;     // pointers to device memory
char* text_new_d;
int* matched_d;
int* matched_new_d;
uint32_t* BB_d;
uint32_t* BB_new_d;
int* matched_h = (int*)malloc(sizeof(int)* strlen(text_h));
cudaMalloc((void **) &pattern_d, sizeof(char)*strlen(pattern_h)+1);
cudaMalloc((void **) &text_d, sizeof(char)*strlen(text_h)+1);
cudaMalloc((void **) &matched_d, sizeof(int)*strlen(text_h));
cudaMemcpy(pattern_d, pattern_h, sizeof(char)*strlen(pattern_h)+1, cudaMemcpyHostToDevice);
cudaMemcpy(text_d, text_h, sizeof(char)*strlen(text_h)+1, cudaMemcpyHostToDevice);
cudaMemset(matched_d, 0,sizeof(int)*strlen(text_h));

int m = strlen(pattern_h);
int n = strlen(text_h);

uint32_t* BB_h[4];
    unsigned int maxLc = ((((m-k)*(k+2)) > (31))?(31/(k+2)):(m-k));
unsigned int lc=2;   // Determines the number of threads per block
    // can be varied upto maxLc for tuning performance
if(lc>maxLc)
{
    exit(0);
}
unsigned int noWordorNfa =((m-k)/lc) + (((m-k)%lc)  == 0?0:1);
cudaMalloc((void **) &BB_d, sizeof(int)*noWordorNfa*4);
if(noWordorNfa >= MAX_THREADS)
{
    printf("Error: max threads\n");
    exit(0);
}

calculateBBArray(BB_h,pattern_h,m,k,lc,noWordorNfa);  // not included this function

for(i=0;i<4;i++)
{
    cudaMemcpy(BB_d+ i*noWordorNfa, BB_h[i], sizeof(int)*noWordorNfa, cudaMemcpyHostToDevice);
}
int overlap=m;
int textBlockSize=(((m+k+1)>n)?n:(m+k+1));
cudaStream_t stream[MAX_STREAMS];
for(i=0;i<MAX_STREAMS;i++) {
    cudaStreamCreate( &stream[i] );
    }

int start_addr=0,index=0,maxNoBlocks=0;
if(textBlockSize>n)
{
    maxNoBlocks=1;
}
else
{
     maxNoBlocks=((1 + ((n-textBlockSize)/(textBlockSize-overlap)) + (((n-textBlockSize)%(textBlockSize-overlap)) == 0?0:1)));
}
int kernelBlocks = ((maxNoBlocks > MAX_BLOCKS)?MAX_BLOCKS:maxNoBlocks);
int blocksRemaining =maxNoBlocks;
printf(" maxNoBlocks %d kernel Blocks %d \n",maxNoBlocks,kernelBlocks);
while(blocksRemaining >0)
{
kernelBlocks = ((blocksRemaining > MAX_BLOCKS)?MAX_BLOCKS:blocksRemaining);
printf(" Calling %d Blocks with starting Address %d , textBlockSize %d \n",kernelBlocks,start_addr,textBlockSize);
match<<<kernelBlocks,noWordorNfa,0,stream[(index++)%MAX_STREAMS]>>>(BB_d,text_d,n,m,k,noWordorNfa,lc,start_addr,textBlockSize,overlap,matched_d);
start_addr+=kernelBlocks*(textBlockSize-overlap);;
blocksRemaining -= kernelBlocks;
}
cudaMemcpy(matched_h, matched_d, sizeof(int)*strlen(text_h), cudaMemcpyDeviceToHost);
checkCUDAError("Matched Function");
for(i=0;i<MAX_STREAMS;i++)
    cudaStreamSynchronize( stream[i] ); 
    // do stuff with matched
    // ....
    // ....
free(matched_h);cudaFree(pattern_d);cudaFree(text_d);cudaFree(matched_d);
    return 0; 
```

}

每个块启动的线程数取决于长度 pattern_h（最多可以是上面的 maxLc）。在这种情况下，我预计它会在 30 左右。这还不足以看到大量的并发性吗？至于块，我认为一次启动超过 MAX_BLOCKS (=10) 个是没有意义的，因为硬件只能同时调度 8 个

**注意**：我没有 GUI 访问权限。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T01:30:50.890

使用您正在使用的所有共享内存，如果连续线程没有从共享数组中的连续地址读取，您可能会遇到银行冲突......这可能会导致内存访问的序列化，这反过来会破坏并行性能你的算法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T21:55:33.433

我简要地查看了您的代码，但看起来您将数据来回发送到 gpu 会在总线上造成瓶颈？你试过分析它吗？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-28T22:59:47.987

我发现我在每个线程中将整个数组 Dnew 复制到 D，而不是仅复制每个线程应该更新 D[w] 的部分。这将导致线程串行执行，尽管我不知道它是否可以称为共享内存库冲突。现在它为足够大的模式（=更多线程）提供了 8-9 倍的加速。这比我预期的要少得多。我将尝试按照建议增加块数。我不知道如何增加线程数

# javascript - 根据为多个项目编写的数量的总价格

> ID：13592201
> 
> 赞同：0
> 
> 时间：2012-11-27T20:09:08.933
> 
> 标签：javascript, html

你好，我正在制作一个购物车系统，但我被困在总产品数量的计算中，我希望用户从下拉列表中选择一个价格，然后在输入数量时它会更新总瞬间，另一个也是如此项目 。我为结构做了一个 js fiddle 任何人都可以通过简单的 javascript 帮助我实现这一点吗？

[http://jsfiddle.net/nVCY4/25/](http://jsfiddle.net/nVCY4/25/)

下拉结构就像

```
<select id="TIPR1" class="table-select" title="Please select">
   <option value="31">Field Box $31</option>
   <option value="29">Lodge Box $29</option>
   <option value="19">Bleachers $19</option>
</select>

function CalculateTotal(frm) {
    var order_total = 0

    // Run through all the form fields
    for (var i=0; i < frm.elements.length; ++i) {

        // Get the current field
        form_field = frm.elements[i]

        // Get the field's name
        form_name = form_field.name

        // Is it a "product" field?
        if (form_name.substring(0,4) == "TIQT") {

            // If so, extract the price from the name
            //item_price = parseFloat(form_name.substring(form_name.lastIndexOf("_") + 1))
            var test = "TIPR1,TIPR2";
            //test = test + i;
            var e = document.getElementById(test);
            item_price = e.options[e.selectedIndex].value;

            // Get the quantity
            item_quantity = parseInt(form_field.value)

            // Update the order total
            if (item_quantity >= 0) {
                order_total += item_quantity * item_price
            }
        }
    }

    // Display the total rounded to two decimal places
    document.getElementById("order_total").firstChild.data = "$" + 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T20:16:39.423

我确实鼓励你自己尝试一些东西，绝对***最好***的学习方式就是做事。

如果你包含 jQuery 或类似的库，这很容易。

这是一个例子：http: [//jsfiddle.net/nVCY4/26/](http://jsfiddle.net/nVCY4/26/)

```
var selects = $('select');
var inputs = $('input');
selects.change(calculate);
inputs.keyup(calculate);

function calculate(){
    var runningTotal = 0;
    selects.each(function(i){
        var val = parseInt($(this).val());
        var qty = inputs.eq(i).val();
        runningTotal += (val*qty);
    });
    $('#grandtotal').html("Grand-total: "+runningTotal);
}​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T21:41:43.300

Here is a possible solution.. actually, several possible solutions. I don't know how these fields look in the context of the entire form. So one of the methods I show below may work better for you than another one.

I have updated your HTML code only a tiny bit: I made the IDs on the SELECT elements unique so that they could be called easily from the JS.

In the JS code there are three different ways to call your fields and get the values. ONLY ONE must be allowed to run. The others need to be removed or commented out.

This also goes for the bottom portion where you set the value of the total. You did not provide HTML that shows what the order total looks like. So I provided samples for several different ways.

This code is untested, and provided as a way to show you possible solutions to this issue. There are at least 10 more that I can think of off the top of my head, but these are (I think) the best match for the HTML code sample you have provided.

```
<div id="content">
    <table border="1">
        <tr>
            <th>Book Cover</th>
            <th>Title & Author</th>
            <th>Price</th>
            <th>Quantity</th>
        </tr>
        <tr>
            <td class="image">
                <a href="cover2.html" onClick="return openNewWindow(this.href, 475, 725);"><img alt="Book Cover" src="images/covers/2artfielding.png" /></a>
            </td>
            <td class="title">
                <p class="table"><b>The Art of Fielding</b></p>
                <p class="table"><i>by Chad Harbach</i></p>
            </td>
            <td class="price">
               <select id="TIPR1" class="table-select" title="Please select">
                    <option value="31">Field Box $31</option>
                    <option value="29">Lodge Box $29</option>
                    <option value="19">Bleachers $19</option>
                </select>
            </td>
            <td class="quantity">
                <input type="text" id="artquantity" value="1" /><br />
            </td>
        </tr>
        <tr>
            <td class="image"><a href="cover5.html" onClick="return openNewWindow(this.href,475, 725);"><img alt="Book Cover" src="images/covers/18thelovers.png" /></a></td>

            <td class="title">
                <p class="table"><b>The Lover's Dictionary</b></p>
                <p class="table"><i>by David Levithan</i></p>
            </td>
            <td class="price">
               <select id="TIPR2" class="table-select" title="Please select">
                    <option value="31">Field Box $31</option>
                    <option value="29">Lodge Box $29</option>
                    <option value="19">Bleachers $19</option>
                </select>
            </td>

            <td class="quantity">
                <input type="text" id="loverquantity" value="1" /><br />
            </td>
        </tr>

        <tr>
            <td class="image"><a href="cover4.html)" onClick="return openNewWindow(this.href,475, 725);"><img alt="Book Cover" src="images/covers/11nightcircus.png" /></a></td>
            <td class="title">
                <p class="table"><b>The Night Circus</b></p>

                <p class="table"><i>by Erin Morgenstern</i></p>
            </td>
            <td class="price">
               <select id="TIPR3" class="table-select" title="Please select">
                    <option value="31">Field Box $31</option>
                    <option value="29">Lodge Box $29</option>
                    <option value="19">Bleachers $19</option>
                </select>
            </td>
            <td class="quantity">
                <input type="text" id="nightquantity" value="1" /><br />
            </td>

        </tr>
        </table>
        <br />
        <p class="totals" id="grandtotal">Grand-total:</p>
</div>

<script type="text/javascript">
function CalculateTotal(frm) {
    var order_total = 0.00;
    var form_select, form_input;

    //*****************************************************************
    //Option 1: Call the fields directly
    //*****************************************************************
    form_select = document.getElementById("TIPR1");
    form_input = document.getElementById("artquantity");
    order_total += (parseFloat(form_select.options[form_select.selectedIndex].value) * parseFloat(form_input.value));

    form_select = document.getElementById("TIPR2");
    form_input = document.getElementById("loverquantity");
    order_total += (parseFloat(form_select.options[form_select.selectedIndex].value) * parseFloat(form_input.value));

    form_select = document.getElementById("TIPR3");
    form_input = document.getElementById("nightquantity");
    order_total += (parseFloat(form_select.options[form_select.selectedIndex].value) * parseFloat(form_input.value));
    //*****************************************************************

    //*****************************************************************
    //Option 2: Create an array and loop through them
    //*****************************************************************
    var selectIDs = ["TIPR1", "TIPR2", "TIPR3"];
    var inputIDs  = ["artquantity", "loverquantity", "nightquantity"];

    foreach(var i in selectIDs) {
        form_select = document.getElementById(selectIDs[i]);
        form_input = document.getElementById(inputIDs[i]);
        order_total += (parseFloat(form_select.options[form_select.selectedIndex].value) * parseFloat(form_input.value));
    }
    //*****************************************************************

    //*****************************************************************
    //Option 3: Assuming there are the same number of SELECTs as INPUTs
    //*****************************************************************
    var selects = document.getElementById("content").getElementsByTagName("select");
    var inputs  = document.getElementById("content").getElementsByTagName("input");

    foreach(var i in selects) {
        form_select = selects[i];
        form_input = inputs[i];
        order_total += (parseFloat(form_select.options[form_select.selectedIndex].value) * parseFloat(form_input.value));
    }
    //*****************************************************************

    //*****************************************************************
    //Display the total rounded to two decimal places
    //*****************************************************************
    tot_val = "$" + parseFloat(order_total).toFixed(2);

    //I don't know what "order_total" is here since you didn't show it in an example...
    // - Here is the code to set it if it's an input
    document.getElementById("order_total").value = tot_val;

    // - ...if it's a block level element like a DIV or P
    document.getElementById("order_total").innerHTML = tot_val;

    // - ...or if it's a block level child of the element
    document.getElementById("order_total").firstChild.innerHTML = tot_val;
    //*****************************************************************
}
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T20:12:52.320

将您想要的逻辑添加到 onchange 事件中，如下所示：

```
<select id="TIPR1" onchange="f()" class="table-select" title="Please select"> 
```

其中 f 是选择某些内容时要调用的函数。

# java - 如何使用供应商 mime 类型测试版本化 REST 应用程序？

> ID：13592202
> 
> 赞同：1
> 
> 时间：2012-11-27T20:09:17.760
> 
> 标签：java, rest, jersey

我有一个使用 Jersey 的 rest servlet，我想使用供应商类型对其进行版本控制。这是代码：

```
@Path("/data")
public class UploadData {

    @POST
    @Path("/test")
    @Consumes("application/vnd.blah.data-v1.0.0+xml")
    public void addCustomerData(String xml) {
        System.out.println("xml =  " + xml);
    }
} 
```

我正在使用 Chrome 的附加组件来测试它（Simple Rest Client），但无论我做什么，我总是会返回“415 Unsupported Media Type”错误。

我必须修改客户端的标题还是我可以在 xml 中指定的东西？我希望仍然能够使用 Chrome 插件而不是自定义编写的客户端。

# php - 在cakePHP中的json序列化后回显一些东西

> ID：13592203
> 
> 赞同：2
> 
> 时间：2012-11-27T20:09:18.907
> 
> 标签：php, json, cakephp, jsonp, cakephp-2.0

如何在 cakePHP json/xml 响应的末尾回显某些内容？

我需要这个来添加 JSONP 支持（因为我需要在开头添加回调和'）；' 在末尾

控制器使用这个：

```
public function json() {

     //...code to populate $jsonObjects

     $this->set('objetos',$jsonObjects);
     $this->set('_serialize', 'objetos');
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T20:41:18.287

首先，我假设您已设置路由以正确处理 JSON/XML 响应

在您的路线文件中：

```
Router::parseExtensions('json'); 
```

其次，您需要确保对示例的调用使用`.json`扩展名或 Accept 标头是`application/json`

然后检查控制器中的回调

```
public function json() {

    //...code to populate $jsonObjects

    // check for callback and set it
    // note: you should do Sanitize::clean() or something like that to
    // prevent code injection
    if ($this->request->params['callback']) {
        $this->set('callback', $this->request->params['callback']);
    }

    $this->set('objetos',$jsonObjects);
    $this->set('_serialize', 'objetos');
} 
```

在您的视图文件（例如：View/Users/json/index.ctp）中，您应该有这样的内容：

```
if (isset($callback)) {
    echo $callback . '('.json_encode($objetos).')';
} else {
    echo json_encode($objetos);
} 
```

我使用了类似的东西，但没有测试上面的确切示例，因此您可能需要对其进行清理。还要确保你清理了回调变量，这样你就不会因为准确地输出查询字符串参数中的内容而留下安全漏洞。

# java - Java - 在 COUNTDOWNLATCH 中计数

> ID：13592208
> 
> 赞同：1
> 
> 时间：2012-11-27T20:09:34.027
> 
> 标签：java, countdownlatch

在运行每个线程时，为什么即使在前一个线程已经调用 countdown.countDown() 并将 Latch Count 减 1 之后，countdown.getCount() 总是打印“3”？

我有点担心 Java 如何知道 Latch Count 已达到 0，以便它可以释放所有 3 个线程。

```
import java.util.concurrent.CountDownLatch;

class b {
static final CountDownLatch countdown = new CountDownLatch(3);

public static void main(String[] args) {

    for (int i = 0; i < 3; ++i) {
        Thread t = new Thread() {
            public void run() {
                System.out.printf("Starting on %d other threads.\n",
                        countdown.getCount());
                countdown.countDown();
                System.out.printf("new on %d other threads.\n",
                        countdown.getCount());
                try {
                    countdown.await(); // waits until everyone reaches this
                                        // point
                    // System.out.println("Go again : "
                    // +countdown.getCount());
                } catch (Exception e) {
                }
            }
        };
        t.start();

    }
    System.out.println("Go");
} 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T20:12:00.750

您正在并行启动 3 个线程。根据它们启动的速度，它们都可以在任何线程设法调用之前打印“3” `countDown()`（至少对于“Starting on ...”行）。然而，“new on ...”行应该打印出介于 2 和 0 之间的某个数字范围。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-08T09:41:05.947

当线程并行运行时，所有三个线程都打印“Starting on 3..”是绝对有可能的，并且直到线程执行countDown（），计数才会改变。要真正了解发生了什么，我建议您在打印语句之前添加 System.nanoTime() 和线程名称，如下所示：

```
...
Thread t = new Thread("Thread-" + i) { 
...
System.out.printf("%d> %s: Starting on %d other threads.\n", System.nanoTime(), getName(), countdown.getCount());
countdown.countDown();
System.out.printf("%d> %s: new on %d other threads.\n", System.nanoTime(), getName(), countdown.getCount()); 
```

有时您会得到如下所示的输出，这可能会让您觉得 Thread-2 忽略了 Thread-1 对 countDown 的调用：

```
1407489646569321000> Thread-0: Starting on 3 other threads.
1407489646569324000> Thread-1: Starting on 3 other threads.
1407489646602463000> Thread-1: new on 1 other threads.
1407489646569513000> Thread-2: Starting on 3 other threads.
1407489646602107000> Thread-0: new on 2 other threads.
1407489646603275000> Thread-2: new on 0 other threads. 
```

然而，事实并非如此，我们可以通过查看时间戳来验证正确的操作顺序。输出中的混淆是由于线程调度中固有的不可预测性，具体取决于哪个线程获得 cpu 拼接。

话虽如此，它们可能并不总是打印 3，这取决于线程调度或延迟。例如，尝试放置一个 Thread.sleep(..) ，如下所示：

```
public static void main(String[] args) throws Exception {
    for (int i = 0; i < 3; ++i) {
        Thread t = new Thread() {
            public void run() {
                 /* As before */
            }
        };
        t.start();
        Thread.sleep(100); // Artificial Delay
    }
} 
```

现在你应该看到不同的结果，如下所示：！

```
1407490223575404000> Thread-0: Starting on 3 other threads.
1407490223607879000> Thread-0: new on 2 other threads.
1407490223676233000> Thread-1: Starting on 2 other threads.
1407490223676818000> Thread-1: new on 1 other threads.
1407490223777623000> Thread-2: Starting on 1 other threads.
1407490223778221000> Thread-2: new on 0 other threads. 
```

在内部，CountDownLatch 维护一个先进先出的等待队列（参见 AbstractQueuedSynchronizer）。count的值是同步的，等待的线程只有在count变为0或者其他线程中断等待线程时才会释放。这是闩锁用来跟踪所有线程何时到达闩锁的机制。

如果您有兴趣了解测试上下文中的闩锁，请查看[http://razshahriar.com/2014/08/testing-asynchronous-code-in-java-with-countdownlatch/](http://razshahriar.com/2014/08/testing-asynchronous-code-in-java-with-countdownlatch/ "使用 CountDownLatch 测试异步代码") 希望这有助于澄清您对程序行为。

# android - 如何处理由于屏幕旋转导致的片段中的 AsyncTask 不完整

> ID：13592211
> 
> 赞同：3
> 
> 时间：2012-11-27T20:09:46.473
> 
> 标签：android

我有一个应用程序，它通过片段容器（在选项卡上）打开几个片段（实际上是 3 个），第一个片段使用 AsyncTask 将提要下载到应用程序中。屏幕旋转时会出现问题 - 应用程序崩溃。我通过将 PostExecute 中的数据加载到私有静态变量中来临时处理这个问题，但是当用户第一次进入应用程序时，仍然会出现这个问题。

这似乎是一个非常普遍或猖獗的问题，但我无法在这里找到彻底的解决方案。我确实理解这是因为屏幕旋转导致配置更改，因为 AsyncTask 在与 UI 线程并行的线程上运行。在这个阶段我确实避免使用 Java 线程/执行程序/执行程序服务，因为 AsyncTask 中似乎有一个现成的工具

我无法中断进程以成功重新启动活动或片段并丢弃初始的后续 AsyncTask 调用..

换句话说，当屏幕旋转等配置发生连续变化时，如何销毁片段中的 AsyncTask。您的帮助将不胜感激。

```
public class MolyListFragment extends Fragment {
public final static String MOLY_ARTICLE_DATA = "No Details";
private static final String TAG = "MOLY";
private static ArrayList<MolyPg> mMolyPgs = null;

@Override
 public void onCreate(Bundle savedInstanceState) {
  super.onCreate(savedInstanceState);
}

@Override
public void onActivityCreated(Bundle savedInstanceState) {
    super.onActivityCreated(savedInstanceState);
    if (mMolyPgs == null) {
        new MolyLoadTask().execute(getResources().getString(R.string.mly_feed));
    }
    else
        displayMlicles (mMolyPgs); //this displays the arrayList out of static mMolyPgs
}

private class MolyLoadTask extends AsyncTask<String, Void, ArrayList<MolyPg>> {
@Override
protected ArrayList<MolyPg> doInBackground(String... urls) {
        String myUrl = urls[0];
        ArrayList<MolyPg> myMlPgs = null;
    try {
            myMlPgs =  loadXmlFromNetwork(myUrl);
    } catch (MalformedURLException e) {
        Log.d(TAG, "MalformedURLException", e);
    } catch (IOException e) {
            getResources().getString(R.string.connection_error);
    } catch (XmlPullParserException e) {
            getResources().getString(R.string.xml_error);
    }

    return myMlPgs;
    }

    @Override
    protected void onPostExecute(ArrayList<MolyPg> result) {
        super.onPostExecute(result);

        Do some acrobatics here
    }
........    
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T21:14:02.267

您可以使用多种解决方案，但它们都有一个共同的主题……您不应该将长期运行的操作如此紧密地直接绑定到您的用户界面类。

如果我要提出一个建议，通常有两种可能效果很好：

*   实现您`AsyncTask`的自定义内部`AsyncTaskLoader`，您可以在每次`Fragment`重新启动时连接到该自定义以检索数据或等待它返回。您需要实现许多回调方法，因此您需要参考文档（[链接](https://developer.android.com/reference/android/content/AsyncTaskLoader.html)）。您可能还想查看源代码`CursorLoader`以获取另一个实现示例`AsyncTaskLoader`。
*   在您的应用程序中创建一个“数据” `Fragment`，其唯一目的是管理您的后台任务并在可用时提供信息。这个片段将没有 UI 组件（即不要覆盖`onCreateView()`），您将调用`setRetainInstance()`因此`FragmentManager`只保留一个。当您添加带有常量标签值的片段时，您 UI 中的所有其他组件都可以通过 轻松找到它`FragmentManager`以检索数据。有关这方面的更多信息，请参阅文档部分[添加没有 UI 的片段](http://developer.android.com/guide/components/fragments.html#Adding)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T20:30:53.117

如果您使用的是片段，则应该使用 Loaders。检查文档：

[http://developer.android.com/reference/android/app/LoaderManager.html](http://developer.android.com/reference/android/app/LoaderManager.html)

该片段将找到任何以前创建的加载器并“重新连接”，因此您可以从中获取结果。

也有一些方法可以“重新连接”AsyncTasks，但最好只使用 Loaders。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T21:03:20.060

您可以使用[setRetainInstance()](http://developer.android.com/reference/android/app/Fragment.html#setRetainInstance%28boolean%29)，但是正如文档所说，这只能与不在后台堆栈中的片段一起使用

# java - 带和不带 JAXBElement 的 jaxb 解组器

> ID：13592215
> 
> 赞同：1
> 
> 时间：2012-11-27T20:10:14.943
> 
> 标签：java, jaxb, unmarshalling

我有以下 JAXB 注释类（使用 XJC 生成）

```
@XmlAccessorType(XmlAccessType.FIELD)
    @XmlType(name = "ReplicateTransactionDataNotificationType", namespace = "http://esb.pkobp/adapter/calypso/tradekast/transaction", propOrder = {
        "operationContext",
        "transactionData"
    })
    public class ReplicateTransactionDataNotificationType
        implements Serializable
    {

        @XmlElement(name = "OperationContext", required = true)
        protected OperationContextType operationContext;
        @XmlElement(name = "TransactionData")
        protected TransactionDataType transactionData;

        public OperationContextType getOperationContext() {
            return operationContext;
        }

        public void setOperationContext(OperationContextType value) {
            this.operationContext = value;
        }

        public TransactionDataType getTransactionData() {
            return transactionData;
        }

        public void setTransactionData(TransactionDataType value) {
            this.transactionData = value;
        }

    } 
```

当以下列方式解组时，一切正常：

```
JAXBContext ctx = JAXBContext.newInstance(ReplicateTransactionDataNotificationType.class);
    Unmarshaller unmarshaller =  ctx.createUnmarshaller();
    JAXBElement<ReplicateTransactionDataNotificationType> result;
    result = unmarshaller.unmarshal(new StreamSource(new ByteArrayInputStream(xmlString.getBytes())), ReplicateTransactionDataNotificationType.class); 
```

当以下列方式解组它时，它会崩溃并出现异常

```
(ReplicateTransactionDataNotificationType)unmarshaller.unmarshal(new StringReader(xmlString)); 
```

例外：

```
javax.xml.bind.UnmarshalException: unexpected element (uri:"http://esb.pkobp/adapter/calypso/tradekast/transaction", local:"caltradetran_ReplicateTransactionDataNotification"). Expected elements are (none)
    at com.sun.xml.bind.v2.runtime.unmarshaller.UnmarshallingContext.handleEvent(UnmarshallingContext.java:642)
    at com.sun.xml.bind.v2.runtime.unmarshaller.Loader.reportError(Loader.java:254)
    at com.sun.xml.bind.v2.runtime.unmarshaller.Loader.reportError(Loader.java:249)
    at com.sun.xml.bind.v2.runtime.unmarshaller.Loader.reportUnexpectedChildElement(Loader.java:116)
    at com.sun.xml.bind.v2.runtime.unmarshaller.UnmarshallingContext$DefaultRootLoader.childElement(UnmarshallingContext.java:1049)
    at com.sun.xml.bind.v2.runtime.unmarshaller.UnmarshallingContext._startElement(UnmarshallingContext.java:478)
    at com.sun.xml.bind.v2.runtime.unmarshaller.UnmarshallingContext.startElement(UnmarshallingContext.java:459)
    at com.sun.xml.bind.v2.runtime.unmarshaller.SAXConnector.startElement(SAXConnector.java:148)
    at org.apache.xerces.parsers.AbstractSAXParser.startElement(Unknown Source)
    at org.apache.xerces.impl.XMLNSDocumentScannerImpl.scanStartElement(Unknown Source)
    at org.apache.xerces.impl.XMLNSDocumentScannerImpl$NSContentDispatcher.scanRootElementHook(Unknown Source)
    at org.apache.xerces.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch(Unknown Source)
    at org.apache.xerces.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown Source)
    at org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)
    at org.apache.xerces.parsers.XML11Configuration.parse(Unknown Source)
    at org.apache.xerces.parsers.XMLParser.parse(Unknown Source)
    at org.apache.xerces.parsers.AbstractSAXParser.parse(Unknown Source)
    at org.apache.xerces.jaxp.SAXParserImpl$JAXPSAXParser.parse(Unknown Source)
    at com.sun.xml.bind.v2.runtime.unmarshaller.UnmarshallerImpl.unmarshal0(UnmarshallerImpl.java:211)
    at com.sun.xml.bind.v2.runtime.unmarshaller.UnmarshallerImpl.unmarshal(UnmarshallerImpl.java:184)
    at javax.xml.bind.helpers.AbstractUnmarshallerImpl.unmarshal(AbstractUnmarshallerImpl.java:137)
    at javax.xml.bind.helpers.AbstractUnmarshallerImpl.unmarshal(AbstractUnmarshallerImpl.java:194)
    at myPackage.XMLTranslationResolver.main(KondorXMLTranslationResolver.java:120) 
```

有人可以解释这种奇怪的行为吗？

被解组的 XML 文件粘贴在下面：

```
<?xml version="1.0" encoding="UTF-8"?>
<caltradetran:caltradetran_ReplicateTransactionDataNotification xmlns:xs="http://www.w3.org/2001/XMLSchema"
                                                                xmlns:fn="http://www.w3.org/2005/xpath-functions"
                                                                xmlns:caltradetran="http://esb.pkobp/adapter/calypso/tradekast/transaction"
                                                                xmlns:tran="http://esb.pkobp/cdm/treasury/transaction">
   <OperationContext>
      <RequestID>98573c9c-6167-4edb-a5ff-8ad3db9983ef</RequestID>
      <EventSource>KONDOR</EventSource>
      <EventDate>2012-11-13T12:13:42.937+01:00</EventDate>
   </OperationContext>
   <TransactionData>
      <ExternalReferenceKp>FWD57658</ExternalReferenceKp>
      <DealTableID>95</DealTableID>
      <Action>INS</Action>
      <TransactionAdditionalData>
         <ExternalReferenceKp>FWD57658</ExternalReferenceKp>
         <ExternalReferenceTr/>
         <ClientPID>123456</ClientPID>
         <ProductSubType>FXForward</ProductSubType>
         <SourceSystem>Kondor+</SourceSystem>
         <AdditionalParameterList>
            <Parameter>
               <Name>TransactionType</Name>
               <ValueType>string</ValueType>
               <StringValue>Spekulacja</StringValue>
            </Parameter>
            <Parameter>
               <Name>ReceiveFrom_AccountNo</Name>
               <ValueType>string</ValueType>
               <StringValue>test</StringValue>
            </Parameter>
            <Parameter>
               <Name>ReceiveFrom_SettleMethod</Name>
               <ValueType>string</ValueType>
               <StringValue>DIRECT</StringValue>
            </Parameter>
            <Parameter>
               <Name>ReceiveTo_AccountNo</Name>
               <ValueType>string</ValueType>
               <StringValue>test</StringValue>
            </Parameter>
            <Parameter>
               <Name>ReceiveTo_SettleMethod</Name>
               <ValueType>string</ValueType>
               <StringValue>DIRECT</StringValue>
            </Parameter>
            <Parameter>
               <Name>PayFrom_AccountNo</Name>
               <ValueType>string</ValueType>
               <StringValue>test</StringValue>
            </Parameter>
            <Parameter>
               <Name>PayFrom_SettleMethod</Name>
               <ValueType>string</ValueType>
               <StringValue>DIRECT</StringValue>
            </Parameter>
            <Parameter>
               <Name>PayTo_AccountNo</Name>
               <ValueType>string</ValueType>
               <StringValue>test</StringValue>
            </Parameter>
            <Parameter>
               <Name>PayTo_SettleMethod</Name>
               <ValueType>string</ValueType>
               <StringValue>DIRECT</StringValue>
            </Parameter>
         </AdditionalParameterList>
      </TransactionAdditionalData>
      <ForwardDeal>
         <FILE>1105_133831_INS.00057658.00072904</FILE>
         <ACTION>INS</ACTION>
         <TRANS_ID>72904</TRANS_ID>
         <XACTKEY>350000000353842604</XACTKEY>
         <OPERATIONS>3</OPERATIONS>
         <MAIN_DEAL_TABLE_ID>95</MAIN_DEAL_TABLE_ID>
         <MAIN_DEAL_ID>57658</MAIN_DEAL_ID>
         <ORIGINAL_TYPE_OF_EVENT>K</ORIGINAL_TYPE_OF_EVENT>
         <DEALS_INSTRUMENT_ID>13</DEALS_INSTRUMENT_ID>
         <DEALS_OPERATION_ID>0</DEALS_OPERATION_ID>
         <MESSAGE_SOURCE>RealTime</MESSAGE_SOURCE>
         <DEALS_OPERATION>INSERT</DEALS_OPERATION>
      </ForwardDeal>
   </TransactionData>
</caltradetran:caltradetran_ReplicateTransactionDataNotification> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T22:11:28.527

您需要`ObjectFactory`在创建`JAXBContext`. `ObjectFactory`包含`@XmlElementDecl`包含根元素信息的注释。我建议`JAXBContext`在生成模型的包名称上创建。

**了解更多信息**

*   [http://blog.bdoughan.com/2012/07/jaxb-and-root-elements.html](http://blog.bdoughan.com/2012/07/jaxb-and-root-elements.html)

# python - 从 Python 启动一个完全独立的进程

> ID：13592219
> 
> 赞同：32
> 
> 时间：2012-11-27T20:10:19.737
> 
> 标签：python, windows-installer, popen

我正在尝试从 python 启动一个完全独立的进程。我不能使用像 os.startfile 这样简单的东西，因为我需要传递参数。目前我正在使用 subprocess.popen ，它可以让我完成 90% 的工作。

```
args = ["some_exe.exe", "some_arg", "another_arg"]
subprocess.Popen(args, creationflags=DETACHED_PROCESS | CREATE_NEW_PROCESS_GROUP, stdout=subprocess.PIPE, stderr=subprocess.PIPE, stdin=subprocess.PIPE) 
```

将 popen 与 std* 的分离创建标志和管道一起使用确实会启动一个新进程，该进程在父进程死亡后仍然存在。所以这一切都很好。问题是新的“子”进程仍然持有父进程的虚拟句柄。因此，如果我尝试卸载父 exe（我的 python 脚本通过 pyinstaller 捆绑到一个 exe 中），msiexec 会抱怨父 exe 仍在使用中。

所以目标是产生一个完全独立的进程来运行“some_exe.exe”，它没有任何句柄回到原始进程。

注意：这适用于 Windows XP 及更高版本。我正在Win7上开发。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-11-27T21:46:54.347

我想我找到了答案。通过使用`Popen`with，`close_fds = True`我能够启动一个独立且没有父句柄的进程。

对于文档，请查看[此处](http://docs.python.org/2/library/subprocess.html)并搜索`close_fds`.

> 或者，在 Windows 上，如果 close_fds 为真，则子进程将不会继承任何句柄。请注意，在 Windows 上，您不能将 close_fds 设置为 true，也不能通过设置 stdin、stdout 或 stderr 来重定向标准句柄。

请注意，此解决方案仅适用于 Windows。我不知道任何 *nix 系统。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-27T21:24:04.707

我在[这里](https://stackoverflow.com/questions/89228/calling-an-external-command-in-python/92395#92395)找到了这个：

在 windows (win xp) 上，父进程在 longtask.py 完成工作之前不会完成。这不是您在 CGI 脚本中想要的。该问题并非特定于 Python，在 PHP 社区中的问题是相同的。

解决方法是把 DETACHED_PROCESS[进程创建标志](https://msdn.microsoft.com/en-us/library/windows/desktop/ms684863(v=vs.85).aspx)传递给 win API 中底层的[CreateProcess](https://msdn.microsoft.com/en-us/library/windows/desktop/ms682425(v=vs.85).aspx)函数。如果你碰巧安装了 pywin32，你可以从 win32process 模块导入标志，否则你应该自己定义它：

DETACHED_PROCESS = 0x00000008

pid = subprocess.Popen([sys.executable, "longtask.py"], creationflags=DETACHED_PROCESS).pid

# java - 奇怪的延迟加载异常

> ID：13592223
> 
> 赞同：2
> 
> 时间：2012-11-27T20:10:31.153
> 
> 标签：java, spring, jpa

我有一个基于 Spring 的 webapp，我的问题是在我的代码更改后，我开始出现延迟加载异常。下面我详细描述一下情况：

**在一开始的时候**

我有一个 Account 和 Word 实体。一个帐户可以有多个单词，一个单词可以分配给多个帐户。

**Account.class**

```
@ManyToMany(targetEntity = Word.class, fetch = FetchType.LAZY)
@JoinTable(name = "account_word", joinColumns = {@JoinColumn(name="account_id")}, inverseJoinColumns = {@JoinColumn(name="word_id")})
@OrderBy("word")
private List<Word> words; 
```

**词类**

```
@ManyToMany(targetEntity = Account.class, fetch = FetchType.LAZY, mappedBy = "words")
@JsonIgnore
private List<Account> accounts; 
```

除了每个帐户只能有一个“WordForToday”，它由在 Account.class 中映射的 Word 实体表示，如下所示：

```
@OneToOne
@JoinColumn(name="word_for_today")
private Word wordForToday; 
```

一切正常。特别是我有一个@Scheduled 方法，它每天调用一次来更改每个帐户的“WordForToday”：

**WordServiceImpl.class**

```
@Transactional
@Service
public class WordServiceImpl implements WordService {

@Autowired
AccountDao accountDao;

@PersistenceContext
EntityManager entityManager;

@Override
@Scheduled(cron="0 0 0 * * ?")
public void setNewWordsForToday() {
    logger.info("Starting setting new Words For Today");
    List<Account> allAccounts = accountDao.listAccounts();
    for(Account account : allAccounts) {    
        if(hasListAtLeastOneWordWithDefinitionWhichIsNotSetAsWordForToday(account.getWords(), account.getUsername())) {
            account.setWordForToday(getUserRandomWordWithDefinition(account.getUsername()));
            entityManager.persist(account);
        }
    }
    logger.info("Setting new Words For Today ended");
}

@Override
@Transactional
public List<Word> listUserWords(String username) {
    try {
        Account foundAccount = accountDao.findUserByUsername(username);
        List<Word> userWords = foundAccount.getWords();
        userWords.size();
        return userWords;
    } catch (UserNotFoundException unf) {
        logger.error("User not found: " + username, unf.getMessage());
        return Collections.emptyList();
    }
}
} 
```

**AccountDaoImpl.class**

```
@Override
public Account findUserByUsername(String username) throws UserNotFoundException {
    CriteriaQuery<Account> c = cb.createQuery(Account.class);
    Root<Account> r = c.from(Account.class);
    try {
        c.select(r).where(cb.equal(r.get("username"), username));
        Account foundAccount = entityManager.createQuery(c).getSingleResult();
        return foundAccount;
    } catch(NoResultException nre){
        throw new UserNotFoundException();
    }
}

@Override
public List<Account> listAccounts() {
    CriteriaQuery<Account> cq = cb.createQuery(Account.class);
    Root<Account> account = cq.from(Account.class);
    cq.select(account);
    TypedQuery<Account> q = entityManager.createQuery(cq);
    List<Account> accounts = q.getResultList();
    return accounts;
} 
```

上面这段代码没有延迟加载异常。懒惰正确提取的单词。

* * *

**那么那么**

我必须为每个帐户实现单词组，所以我在我的项目中添加了新的组实体。现在除了没有改变的“WordForToday”之外，Account 和 Word 之间没有直接关系。现在一个Account可以有多个Groups，并且一个Account只能分配一个Group[单向一对多与连接表]。

**Account.class**

```
@OneToMany(fetch = FetchType.LAZY)
@JoinTable(name = "account_wordgroup", joinColumns = {@JoinColumn(name="account_id")}, inverseJoinColumns = {@JoinColumn(name="wordgroup_id")})
@OrderBy("name")
private List<Group> groups; 
```

此外，一个组可以有多个单词，一个单词可以分配给多个组。

**组类**

```
@ManyToMany(targetEntity = Word.class, fetch = FetchType.EAGER)
@OrderBy(value="word")
@JoinTable(name = "wordgroup_word", joinColumns = {@JoinColumn(name="wordgroup_id")}, inverseJoinColumns = {@JoinColumn(name="word_id")})
private List<Word> words; 
```

**词类**

```
@ManyToMany(targetEntity = Group.class, fetch = FetchType.LAZY, mappedBy = "words")
@JsonIgnore
private List<Group> groups; 
```

并且上面使用此实体的每个 CRUD 方法都可以正常工作。我只有上面提到的**setNewWordsForToday()**方法有问题，现在看起来像这样（我重构了一点代码）：

**WordServiceImpl.class**

```
@Transactional
@Service
public class WordServiceImpl implements WordService {

@Autowired
AccountDao accountDao;

@PersistenceContext
EntityManager entityManager;

@Autowired
GroupService groupService;

@Override
@Scheduled(cron="0 0 0 * * ?")
@Transactional
public void setNewWordsForToday() {
    logger.info("Starting setting new Words For Today");
    List<Account> allAccounts = accountDao.listAccounts();
    for(Account account : allAccounts) {    
        if(hasListAtLeastOneWordWithDefinitionWhichIsNotSetAsWordForToday(listUserWords(account), account)) {
            account.setWordForToday(getUserRandomWordWithDefinition(account));
            entityManager.persist(account);
        }
    }
    logger.info("Setting new Words For Today ended");
}

@Override
@Transactional
public List<Word> listUserWords(Account account) {
    List<Group> userGroups = groupService.listUserGroups(account);
    List<Word> userWords = new ArrayList<Word>();
    for(Group userGroup : userGroups) {
        userWords.addAll(userGroup.getWords());
    }
    return userWords;
}
} 
```

**GroupServiceImpl.class**

```
@Transactional
@Service
public class GroupServiceImpl implements GroupService {

@Override
@Transactional
public List<Group> listUserGroups(Account account) {
    List<Group> userGroups = account.getGroups();
    userGroups.size();
    return userGroups;
} 
```

}

AccountDaoImpl.class 没有改变。现在，当调用 @Scheduled 方法时，我有这个延迟加载异常：

```
 ERROR [org.springframework.scheduling.support.MethodInvokingRunnable] - Invocation of method 'setNewWordsForToday' on target class [class pl.net.grodek.snd.service.WordServiceImpl] failed
 org.hibernate.LazyInitializationException: failed to lazily initialize a collection of role: pl.net.grodek.snd.model.Account.groups, no session or session was closed
at org.hibernate.collection.internal.AbstractPersistentCollection.throwLazyInitializationException(AbstractPersistentCollection.java:394)
at org.hibernate.collection.internal.AbstractPersistentCollection.throwLazyInitializationExceptionIfNotConnected(AbstractPersistentCollection.java:386)
at org.hibernate.collection.internal.AbstractPersistentCollection.readSize(AbstractPersistentCollection.java:126)
at org.hibernate.collection.internal.PersistentBag.size(PersistentBag.java:242)
at pl.net.grodek.snd.service.GroupServiceImpl.listUserGroups(GroupServiceImpl.java:63)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597)
at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:309)
at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:183)
at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:150)
at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:110)
at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:202)
at $Proxy48.listUserGroups(Unknown Source)
at pl.net.grodek.snd.service.WordServiceImpl.listUserWords(WordServiceImpl.java:83)
at pl.net.grodek.snd.service.WordServiceImpl.setNewWordsForToday(WordServiceImpl.java:333)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
at java.lang.reflect.Method.invoke(Method.java:597)
at org.springframework.util.MethodInvoker.invoke(MethodInvoker.java:273)
at org.springframework.scheduling.support.MethodInvokingRunnable.run(MethodInvokingRunnable.java:65)
at org.springframework.scheduling.support.DelegatingErrorHandlingRunnable.run(DelegatingErrorHandlingRunnable.java:51)
at org.springframework.scheduling.concurrent.ReschedulingRunnable.run(ReschedulingRunnable.java:81)
at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:441)
at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
at java.util.concurrent.FutureTask.run(FutureTask.java:138)
at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$301(ScheduledThreadPoolExecutor.java:98)
at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:206)
at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
at java.lang.Thread.run(Thread.java:662) 
```

我想我什么都试过了，我不知道该怎么做。它现在阻止了我几天，所以请任何人帮助我:(

**PS：我当然在使用 OpenEntityManagerInViewFilter。**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T20:22:27.833

任务调度程序直接在服务实现上执行该方法，而不是通过代理，因此它不会在该范围内拾取`@Transactional`并启动 Hibernate Session。

尝试创建另一个连接到其中的 bean`WordService`并将调度放在那里，以便您在`WordService`代理上调用该方法。那应该清除它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T20:30:03.753

如果 Affe 解决方案不起作用，我在您的方法实现中看到的不同之处是：

```
getUserRandomWordWithDefinition(account.getUsername()); 
```

替换为实体：

```
getUserRandomWordWithDefinition(account); 
```

在您调用随机词时，您是否有可能关闭您的交易？因为返回字或发送帐户参数？

# r - 如何在 Shiny 应用程序中的函数之间传递数据

> ID：13592225
> 
> 赞同：11
> 
> 时间：2012-11-27T20:10:42.337
> 
> 标签：r, function, shiny

我有一个闪亮的应用程序，其中 server.r 包括以下代码

```
shinyServer(function(input, output) {

  data <- reactive(function() {
   # some processing
   df # dataframe with columns: name,date,count 
 })

  output$plot1 <- reactivePlot(function() {
   # boxplot based on df$count grouped by df$name
 })

 output$plot2 <- reactivePlot(function() {
   # linegraph based on x=df$date, y=df$count grouped by df$name
 })
}) 
```

我如何构造它，以便我可以在 reactivePlots 中引用 df$count 等我在反应函数中创建的“数据”

干杯

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-11-27T21:32:40.963

使用`data()$count`. 这`()`是您检索反应函数值的方式，并且您可以`data`从两个反应图函数中看到这一事实只是 R 范围规则的自然结果。

# database - 更简单的查询与更简单的数据库

> ID：13592227
> 
> 赞同：0
> 
> 时间：2012-11-27T20:10:49.983
> 
> 标签：database, database-design

在我的网站上，我有一个论坛，您可以在其中发起话题、回复话题、删除您的帖子、举报他人的帖子等。

我决定进行抽象并创建一个名为的表，该表`activity`将存储`user_id`, `time`（每个活动共有的字段）和活动类型（线程、响应、报告、删除）和`effective_id`（`id`对应于各自的桌子）。

一开始，这似乎是个好主意，因为它有助于避免冗余，并且可以更容易地查找某个用户所做的事情，而无需询问每个表。但同时，这种抽象会导致更复杂的查询（例如，必须`INNER JOIN`在几乎每个简单查询中使用），现在我在处理更复杂的查询时遇到了麻烦。

所以我的问题是：我做出了正确的决定吗？在现实生活环境中拥有一个完美的数据库是否如此重要，即使它会导致非常昂贵的查询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T20:20:27.340

我想我会朝着与您 3-5 年前相同的方向前进，但现在我更倾向于为您描述的活动采用更简单、更扁平的数据库设计，而不是采用更规范化的方法。

我对 CQRS 和任务驱动 UI 的使用和理解确实帮助我意识到了这一点——尽管它可能与您的情况无关。

本质上，我曾经优化我的数据库，以便插入、更新和删除非常有效，但这会导致连接许多表以进行简单的选择。问题是 80% 的时间，用户想要选择。因此，针对用户大部分时间所做的事情优化我的数据库结构确实有助于提高应用程序的整体性能，并且在我看来，有助于系统的维护和可扩展性。

我正在对您的应用程序以及您正在尝试做的事情做出一些假设，但是对我来说，活动表听起来像是可以从队列中提供并由监视队列的单独工作进程/线程构建的东西对于工作项。当找到这些工作项（命令？？）时，工作进程将展平数据并更新适当的活动表。当你去查询你的活动表时，你基本上是在做一个简单的`SELECT * FROM ACTIVITY`（虽然我不推荐`SELECT *`查询——命名你的列）。所以你在插入/更新你的活动表时受到了打击，但你的选择表现很棒。

我希望这有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T20:14:58.020

关系数据库系统的全部意义在于关联数据（通过在正确的表中分离实体），这样做可以引入连接。这是正常的，也是一种很好的数据库设计技术。

许多数据库初学者试图避免连接并添加来自各种实体的属性以避免必须进行`INNER`连接，但这不是一个合适的技术，从长远来看会咬你。联接是有原因的，当您需要关联数据时应该使用联接。

在您的示例中，您实质上是在创建一个“日志”文件。应用程序上的活动只是用户正在做什么的日志。问问自己，什么会更好，一个日志用于帖子，一个日志用于报告，一个日志用于删除，一个日志用于多个日志表或一个简单的日志表，其中包含关于用户发起的活动的 referenceID（这实际上是一个FK）。答案是您需要一个包含外键的日志表，让您了解用户启动的内容（删除、添加、标志等）。

但是，您想问自己的问题是，当用户只想获取此数据时，您为什么要显示活动信息。您可以始终保持此数据正常化，但仅在需要时选择它。我不明白你为什么要加入这个活动表。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-28T02:46:28.293

从您的问题中，我不确定您拆分所有活动的共同特征的目的是什么，也不确定复杂查询以何种方式给您带来麻烦。

活动类型（线程、响应、报告、删除）的描述当然看起来像是类型和子类型的经典案例，也称为类和子类。这种情况有两种经典的设计模式，称为单表继承和类表继承。这两种设计模式都有标签。还有另一种设计模式，共享主键，可以与类表继承结合使用，效果很好。

从 STI 到 CTI 的转变确实涉及一些表格分解，它类似于您描述的分解。SPK 的使用消除了对每个专用子类表的单独 id 字段的需要，也消除了对单独类型字段的需要。这可能会导致比您最终遇到的查询更简单的查询。没有看到这些查询，就不可能知道。

值得注意的是，这种分解不是“规范化”，因为它符合任何标准范式 2NF 到 5NF。但是这些正常形式关注的是更新的简单性，而不是查询的简单性。

考虑到数据的使用方式，进行了良好的设计。有时我们会在此过程中学到这一点。我不知道完美的设计是什么样的。我认为我们总是在权衡取舍。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-27T20:14:33.490

您是否考虑过非规范化数据库？在这里查看更多信息：[http](http://en.wikipedia.org/wiki/Denormalization) ://en.wikipedia.org/wiki/Denormalization 。

# mysql - 如何在我的服务器上生成 mysql 锁定超时错误？

> ID：13592231
> 
> 赞同：2
> 
> 时间：2012-11-27T20:11:17.083
> 
> 标签：mysql, locking, timeout

我的mysql服务器有时会给我这样的错误（我在日志中看到它们），我知道是什么导致了现在检查这个我需要自己做出这种情况（后来，当我修复我的应用程序时，再次测试它，以确保它不再发生）

生成mysql锁定超时错误的最佳方法是什么？my.cnf 中应该改变什么，然后我应该如何使用 mysqlslap？（至于现在我只设法在 shell 中得到“太多的连接”错误消息 :) 顺便说一句 - 它是 centos 上的 bash，mysql Ver 14.14 Distrib 5.1.66

帮帮我的人！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T21:31:31.853

## 建议 #1

假设你的数据使用 InnoDB 存储引擎，你需要配置[**innodb_lock_wait_time**](http://dev.mysql.com/doc/refman/5.1/en/innodb-parameters.html#sysvar_innodb_lock_wait_timeout)它的默认值是 50 秒。

您可以自行决定降低它。也许是低得离谱的东西（比如 1）

## 建议 #2

如果您启用了[innodb_file_per_table](http://dev.mysql.com/doc/refman/5.1/en/innodb-parameters.html#sysvar_innodb_file_per_table)，您还可以使用[**innodb_open_files阻塞打开文件的数量**](http://dev.mysql.com/doc/refman/5.1/en/innodb-parameters.html#sysvar_innodb_open_files)

## 建议#3

我建议您创建一个测试脚本，故意将同一行更新数十次（甚至数百次）。然后，让 mysqlslap 启动该脚本数百次。

# java - 将 URI 字符串解析为名称-值集合

> ID：13592236
> 
> 赞同：322
> 
> 时间：2012-11-27T20:11:58.820
> 
> 标签：java, parsing, uri, namevaluecollection

我有这样的URI：

```
https://google.com.ua/oauth/authorize?client_id=SS&response_type=code&scope=N_FULL&access_type=offline&redirect_uri=http://localhost/Callback 
```

我需要一个带有解析元素的集合：

```
NAME               VALUE
------------------------
client_id          SS
response_type      code
scope              N_FULL
access_type        offline
redirect_uri       http://localhost/Callback 
```

确切地说，我需要 C#/.NET[`HttpUtility.ParseQueryString`](https://docs.microsoft.com/en-us/dotnet/api/system.web.httputility.parsequerystring?view=netcore-3.1)方法的 Java 等效项。

* * *

## 回答 #1

> 赞同：398
> 
> 时间：2012-11-27T20:35:22.120

如果您正在寻找一种不使用外部库来实现它的方法，以下代码将为您提供帮助。

```
public static Map<String, String> splitQuery(URL url) throws UnsupportedEncodingException {
    Map<String, String> query_pairs = new LinkedHashMap<String, String>();
    String query = url.getQuery();
    String[] pairs = query.split("&");
    for (String pair : pairs) {
        int idx = pair.indexOf("=");
        query_pairs.put(URLDecoder.decode(pair.substring(0, idx), "UTF-8"), URLDecoder.decode(pair.substring(idx + 1), "UTF-8"));
    }
    return query_pairs;
} 
```

您可以使用 访问返回的地图`<map>.get("client_id")`，问题中给出的 URL 将返回“SS”。

**添加了更新** URL 解码

**更新**由于这个答案仍然很受欢迎，我制作了上述方法的改进版本，它处理具有相同键的多个参数和没有值的参数。

```
public static Map<String, List<String>> splitQuery(URL url) throws UnsupportedEncodingException {
  final Map<String, List<String>> query_pairs = new LinkedHashMap<String, List<String>>();
  final String[] pairs = url.getQuery().split("&");
  for (String pair : pairs) {
    final int idx = pair.indexOf("=");
    final String key = idx > 0 ? URLDecoder.decode(pair.substring(0, idx), "UTF-8") : pair;
    if (!query_pairs.containsKey(key)) {
      query_pairs.put(key, new LinkedList<String>());
    }
    final String value = idx > 0 && pair.length() > idx + 1 ? URLDecoder.decode(pair.substring(idx + 1), "UTF-8") : null;
    query_pairs.get(key).add(value);
  }
  return query_pairs;
} 
```

**更新**Java8版本

```
public Map<String, List<String>> splitQuery(URL url) {
    if (Strings.isNullOrEmpty(url.getQuery())) {
        return Collections.emptyMap();
    }
    return Arrays.stream(url.getQuery().split("&"))
            .map(this::splitQueryParameter)
            .collect(Collectors.groupingBy(SimpleImmutableEntry::getKey, LinkedHashMap::new, mapping(Map.Entry::getValue, toList())));
}

public SimpleImmutableEntry<String, String> splitQueryParameter(String it) {
    final int idx = it.indexOf("=");
    final String key = idx > 0 ? it.substring(0, idx) : it;
    final String value = idx > 0 && it.length() > idx + 1 ? it.substring(idx + 1) : null;
    return new SimpleImmutableEntry<>(
        URLDecoder.decode(key, "UTF-8"),
        URLDecoder.decode(value, "UTF-8")
    );
} 
```

使用 URL 运行上述方法

`https://stackoverflow.com?param1=value1&param2=&param3=value3&param3`

返回此地图：

```
{param1=["value1"], param2=[null], param3=["value3", null]} 
```

* * *

## 回答 #2

> 赞同：358
> 
> 时间：2012-11-27T20:17:25.170

# [org.apache.http.client.utils.URLEncodedUtils](http://hc.apache.org/httpcomponents-client-ga/httpclient/apidocs/org/apache/http/client/utils/URLEncodedUtils.html)

是一个可以为你做的知名图书馆

```
import org.apache.hc.client5.http.utils.URLEncodedUtils

String url = "http://www.example.com/something.html?one=1&two=2&three=3&three=3a";

List<NameValuePair> params = URLEncodedUtils.parse(new URI(url), Charset.forName("UTF-8"));

for (NameValuePair param : params) {
  System.out.println(param.getName() + " : " + param.getValue());
} 
```

输出

```
one : 1
two : 2
three : 3
three : 3a 
```

* * *

## 回答 #3

> 赞同：142
> 
> 时间：2016-09-06T12:18:59.233

如果您使用的是 Spring 框架：

```
public static void main(String[] args) {
    String uri = "http://my.test.com/test?param1=ab&param2=cd&param2=ef";
    MultiValueMap<String, String> parameters =
            UriComponentsBuilder.fromUriString(uri).build().getQueryParams();
    List<String> param1 = parameters.get("param1");
    List<String> param2 = parameters.get("param2");
    System.out.println("param1: " + param1.get(0));
    System.out.println("param2: " + param2.get(0) + "," + param2.get(1));
} 
```

你会得到：

```
param1: ab
param2: cd,ef 
```

* * *

## 回答 #4

> 赞同：57
> 
> 时间：2014-05-20T06:22:09.977

使用 google Guava 并分两行完成：

```
import java.util.Map;
import com.google.common.base.Splitter;

public class Parser {
    public static void main(String... args) {
        String uri = "https://google.com.ua/oauth/authorize?client_id=SS&response_type=code&scope=N_FULL&access_type=offline&redirect_uri=http://localhost/Callback";
        String query = uri.split("\\?")[1];
        final Map<String, String> map = Splitter.on('&').trimResults().withKeyValueSeparator('=').split(query);
        System.out.println(map);
    }
} 
```

这给了你

```
{client_id=SS, response_type=code, scope=N_FULL, access_type=offline, redirect_uri=http://localhost/Callback} 
```

* * *

## 回答 #5

> 赞同：42
> 
> 时间：2017-10-26T15:50:24.757

我发现的最短方法是这样的：

```
MultiValueMap<String, String> queryParams =
            UriComponentsBuilder.fromUriString(url).build().getQueryParams(); 
```

**更新：** `UriComponentsBuilder`来自春天。这里[是链接](https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/web/util/UriComponentsBuilder.html)。

* * *

## 回答 #6

> 赞同：25
> 
> 时间：2018-02-03T06:01:28.817

对于 Android，如果您在项目中使用[OkHttp](https://github.com/square/okhttp)。你可以看看这个。它简单而有用。

```
final HttpUrl url = HttpUrl.parse(query);
if (url != null) {
    final String target = url.queryParameter("target");
    final String id = url.queryParameter("id");
} 
```

* * *

## 回答 #7

> 赞同：22
> 
> 时间：2016-05-21T22:35:05.720

# 纯Java 11

给定要分析的 URL：

```
URL url = new URL("https://google.com.ua/oauth/authorize?client_id=SS&response_type=code&scope=N_FULL&access_type=offline&redirect_uri=http://localhost/Callback"); 
```

此解决方案收集对列表：

```
List<Map.Entry<String, String>> list = Pattern.compile("&")
   .splitAsStream(url.getQuery())
   .map(s -> Arrays.copyOf(s.split("=", 2), 2))
   .map(o -> Map.entry(decode(o[0]), decode(o[1])))
   .collect(Collectors.toList()); 
```

另一方面，此解决方案收集地图（假设在 url 中可以有更多具有相同名称但不同值的参数）。

```
Map<String, List<String>> list = Pattern.compile("&")
   .splitAsStream(url.getQuery())
   .map(s -> Arrays.copyOf(s.split("=", 2), 2))
   .collect(groupingBy(s -> decode(s[0]), mapping(s -> decode(s[1]), toList()))); 
```

两种解决方案都必须使用实用函数来正确解码参数。

```
private static String decode(final String encoded) {
    return Optional.ofNullable(encoded)
                   .map(e -> URLDecoder.decode(e, StandardCharsets.UTF_8))
                   .orElse(null);
} 
```

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2018-01-25T20:42:53.743

如果您使用的是 servlet doGet 试试这个

```
request.getParameterMap() 
```

> *返回此请求参数的 java.util.Map。*
> 
> *返回： 一个不可变的 java.util.Map，其中包含作为键的参数名称和作为映射值的参数值。参数映射中的键是字符串类型。参数映射中的值是字符串数组类型。*
> 
> （[Java 文档](https://docs.oracle.com/javaee/6/api/javax/servlet/ServletRequest.html#getParameterMap())）

* * *

## 回答 #9

> 赞同：11
> 
> 时间：2019-05-02T08:47:03.430

在 Android 上，包***android.net***中有一个 Uri 类。请注意，**Uri**是**android.net**的一部分，而**URI**是**java.net**的一部分。

Uri 类有许多函数可以从查询中提取键值对。 [![在此处输入图像描述](../Images/63099e70609e8d88af4e0bde0dc5bec1.png)](https://i.stack.imgur.com/Rmjey.png)

以下函数以 HashMap 的形式返回键值对。

在 Java 中：

```
Map<String, String> getQueryKeyValueMap(Uri uri){
    HashMap<String, String> keyValueMap = new HashMap();
    String key;
    String value;

    Set<String> keyNamesList = uri.getQueryParameterNames();
    Iterator iterator = keyNamesList.iterator();

    while (iterator.hasNext()){
        key = (String) iterator.next();
        value = uri.getQueryParameter(key);
        keyValueMap.put(key, value);
    }
    return keyValueMap;
} 
```

在科特林：

```
fun getQueryKeyValueMap(uri: Uri): HashMap<String, String> {
        val keyValueMap = HashMap<String, String>()
        var key: String
        var value: String

        val keyNamesList = uri.queryParameterNames
        val iterator = keyNamesList.iterator()

        while (iterator.hasNext()) {
            key = iterator.next() as String
            value = uri.getQueryParameter(key) as String
            keyValueMap.put(key, value)
        }
        return keyValueMap
    } 
```

* * *

## 回答 #10

> 赞同：8
> 
> 时间：2015-05-15T22:19:08.977

如果您使用的是 Java 8，并且愿意编写一些可重用的方法，那么您可以在一行中完成。

```
private Map<String, List<String>> parse(final String query) {
    return Arrays.asList(query.split("&")).stream().map(p -> p.split("=")).collect(Collectors.toMap(s -> decode(index(s, 0)), s -> Arrays.asList(decode(index(s, 1))), this::mergeLists));
}

private <T> List<T> mergeLists(final List<T> l1, final List<T> l2) {
    List<T> list = new ArrayList<>();
    list.addAll(l1);
    list.addAll(l2);
    return list;
}

private static <T> T index(final T[] array, final int index) {
    return index >= array.length ? null : array[index];
}

private static String decode(final String encoded) {
    try {
        return encoded == null ? null : URLDecoder.decode(encoded, "UTF-8");
    } catch(final UnsupportedEncodingException e) {
        throw new RuntimeException("Impossible: UTF-8 is a required encoding", e);
    }
} 
```

但这是一条非常残酷的路线。

* * *

## 回答 #11

> 赞同：8
> 
> 时间：2019-05-15T15:38:10.623

[Netty](https://netty.io/)还提供了一个很好的查询字符串解析器，称为`QueryStringDecoder`. 在一行代码中，它可以解析问题中的 URL。我喜欢，因为它不需要捕捉或投掷`java.net.MalformedURLException`。

在一行中：

```
Map<String, List<String>> parameters = new QueryStringDecoder(url).parameters(); 
```

在此处查看 javadocs：[https ://netty.io/4.1/api/io/netty/handler/codec/http/QueryStringDecoder.html](https://netty.io/4.1/api/io/netty/handler/codec/http/QueryStringDecoder.html)

这是一个简短的、独立的、正确的示例：

```
import io.netty.handler.codec.http.QueryStringDecoder;
import org.apache.commons.lang3.StringUtils;

import java.util.List;
import java.util.Map;

public class UrlParse {

  public static void main(String... args) {
    String url = "https://google.com.ua/oauth/authorize?client_id=SS&response_type=code&scope=N_FULL&access_type=offline&redirect_uri=http://localhost/Callback";
    QueryStringDecoder decoder = new QueryStringDecoder(url);
    Map<String, List<String>> parameters = decoder.parameters();
    print(parameters);
  }

  private static void print(final Map<String, List<String>> parameters) {
    System.out.println("NAME               VALUE");
    System.out.println("------------------------");
    parameters.forEach((key, values) ->
        values.forEach(val ->
            System.out.println(StringUtils.rightPad(key, 19) + val)));
  }
} 
```

这会产生

```
NAME               VALUE
------------------------
client_id          SS
response_type      code
scope              N_FULL
access_type        offline
redirect_uri       http://localhost/Callback 
```

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2019-09-19T19:28:47.807

# 用于解码 URI 查询部分（包括解码和多参数值）的即用型解决方案

## 注释

[我对 @Pr0gr4mm3r 在https://stackoverflow.com/a/13592567/1211082](https://stackoverflow.com/a/13592567/1211082)中提供的代码不满意。基于 Stream 的解决方案不执行 URLDecoding，可变版本笨拙。

因此，我制定了一个解决方案

*   可以将 URI 查询部分分解为`Map<String, List<Optional<String>>>`
*   可以处理相同参数名称的**多个值**
*   可以**正确表示没有值的参数** （`Optional.empty()`而不是`null`）
*   **通过正确**解码参数名称**和**值**`URLdecode`**
***   基于 Java 8 Streams*   可直接使用（请参阅下面包含导入的代码）*   允许正确的错误处理（这里通过将检查的异常`UnsupportedEncodingException`转换为允许与流相互作用的运行时异常`RuntimeUnsupportedEncodingException`。（将常规函数包装到抛出检查异常的函数中是一件痛苦的事情。Scala`Try`在 Java 语言默认值中不可用。）**

 **## Java 代码

```
import java.io.UnsupportedEncodingException;
import java.net.URLDecoder;
import java.util.*;
import static java.util.stream.Collectors.*;

public class URIParameterDecode {
    /**
     * Decode parameters in query part of a URI into a map from parameter name to its parameter values.
     * For parameters that occur multiple times each value is collected.
     * Proper decoding of the parameters is performed.
     * 
     * Example
     *   <pre>a=1&b=2&c=&a=4</pre>
     * is converted into
     *   <pre>{a=[Optional[1], Optional[4]], b=[Optional[2]], c=[Optional.empty]}</pre>
     * @param query the query part of an URI 
     * @return map of parameters names into a list of their values.
     *         
     */
    public static Map<String, List<Optional<String>>> splitQuery(String query) {
        if (query == null || query.isEmpty()) {
            return Collections.emptyMap();
        }

        return Arrays.stream(query.split("&"))
                    .map(p -> splitQueryParameter(p))
                    .collect(groupingBy(e -> e.get0(), // group by parameter name
                            mapping(e -> e.get1(), toList())));// keep parameter values and assemble into list
    }

    public static Pair<String, Optional<String>> splitQueryParameter(String parameter) {
        final String enc = "UTF-8";
        List<String> keyValue = Arrays.stream(parameter.split("="))
                .map(e -> {
                    try {
                        return URLDecoder.decode(e, enc);
                    } catch (UnsupportedEncodingException ex) {
                        throw new RuntimeUnsupportedEncodingException(ex);
                    }
                }).collect(toList());

        if (keyValue.size() == 2) {
            return new Pair(keyValue.get(0), Optional.of(keyValue.get(1)));
        } else {
            return new Pair(keyValue.get(0), Optional.empty());
        }
    }

    /** Runtime exception (instead of checked exception) to denote unsupported enconding */
    public static class RuntimeUnsupportedEncodingException extends RuntimeException {
        public RuntimeUnsupportedEncodingException(Throwable cause) {
            super(cause);
        }
    }

    /**
     * A simple pair of two elements
     * @param <U> first element
     * @param <V> second element
     */
    public static class Pair<U, V> {
        U a;
        V b;

        public Pair(U u, V v) {
            this.a = u;
            this.b = v;
        }

        public U get0() {
            return a;
        }

        public V get1() {
            return b;
        }
    }
} 
```

## 斯卡拉代码

...为了完整起见，我忍不住要在 Scala 中提供以简洁和美观为主的解决方案

```
import java.net.URLDecoder

object Decode {
  def main(args: Array[String]): Unit = {
    val input = "a=1&b=2&c=&a=4";
    println(separate(input))
  }

  def separate(input: String) : Map[String, List[Option[String]]] = {
    case class Parameter(key: String, value: Option[String])

    def separateParameter(parameter: String) : Parameter =
      parameter.split("=")
               .map(e => URLDecoder.decode(e, "UTF-8")) match {
      case Array(key, value) =>  Parameter(key, Some(value))
      case Array(key) => Parameter(key, None)
    }

    input.split("&").toList
      .map(p => separateParameter(p))
      .groupBy(p => p.key)
      .mapValues(vs => vs.map(p => p.value))
  }
} 
```

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2016-06-02T19:01:52.043

使用上述注释和解决方案，我使用 Map<String, Object> 存储所有查询参数，其中对象可以是字符串或 Set<String>。解决方案如下。建议先使用某种 url 验证器来验证 url，然后调用 convertQueryStringToMap 方法。

```
private static final String DEFAULT_ENCODING_SCHEME = "UTF-8";

public static Map<String, Object> convertQueryStringToMap(String url) throws UnsupportedEncodingException, URISyntaxException {
    List<NameValuePair> params = URLEncodedUtils.parse(new URI(url), DEFAULT_ENCODING_SCHEME);
    Map<String, Object> queryStringMap = new HashMap<>();
    for(NameValuePair param : params){
        queryStringMap.put(param.getName(), handleMultiValuedQueryParam(queryStringMap, param.getName(), param.getValue()));
    }
    return queryStringMap;
}

private static Object handleMultiValuedQueryParam(Map responseMap, String key, String value) {
    if (!responseMap.containsKey(key)) {
        return value.contains(",") ? new HashSet<String>(Arrays.asList(value.split(","))) : value;
    } else {
        Set<String> queryValueSet = responseMap.get(key) instanceof Set ? (Set<String>) responseMap.get(key) : new HashSet<String>();
        if (value.contains(",")) {
            queryValueSet.addAll(Arrays.asList(value.split(",")));
        } else {
            queryValueSet.add(value);
        }
        return queryValueSet;
    }
} 
```

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2018-06-25T13:23:19.467

我尝试了一个 Kotlin 版本，看看这是如何在 Google 中获得最高结果的。

```
@Throws(UnsupportedEncodingException::class)
fun splitQuery(url: URL): Map<String, List<String>> {

    val queryPairs = LinkedHashMap<String, ArrayList<String>>()

    url.query.split("&".toRegex())
            .dropLastWhile { it.isEmpty() }
            .map { it.split('=') }
            .map { it.getOrEmpty(0).decodeToUTF8() to it.getOrEmpty(1).decodeToUTF8() }
            .forEach { (key, value) ->

                if (!queryPairs.containsKey(key)) {
                    queryPairs[key] = arrayListOf(value)
                } else {

                    if(!queryPairs[key]!!.contains(value)) {
                        queryPairs[key]!!.add(value)
                    }
                }
            }

    return queryPairs
} 
```

以及扩展方法

```
fun List<String>.getOrEmpty(index: Int) : String {
    return getOrElse(index) {""}
}

fun String.decodeToUTF8(): String { 
    URLDecoder.decode(this, "UTF-8")
} 
```

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2021-09-19T17:16:21.087

正如您在具有单个参数定义时所指出的那样，有很多答案适用于您的查询。在某些应用程序中，处理一些额外的查询参数边缘情况可能很有用，例如：

*   参数值列表，例如`param1&param1=value&param1=`含义`param1`设置为`List.of("", "value", "")`
*   无效排列，例如`querypath?&=&&=noparamname&`.
*   在地图中使用不为空的空字符串`a=`意味着“a”是`List.of("")`匹配 web servlet 处理

这使用带有过滤器和 groupingBy 的 Stream 来收集到`Map<String, List<String>>`：

```
public static Map<String, List<String>> getParameterValues(URL url) {
    return Arrays.stream(url.getQuery().split("&"))
            .map(s -> s.split("="))
            // filter out empty parameter names (as in Tomcat) "?&=&&=value&":
            .filter(arr -> arr.length > 0 && arr[0].length() > 0)
            .collect(Collectors.groupingBy(arr -> URLDecoder.decode(arr[0], StandardCharsets.UTF_8),
                     // drop this line for not-name definition order Map:
                     LinkedHashMap::new, 
                     Collectors.mapping(arr -> arr.length < 2 ? "" : URLDecoder.decode(arr[1], StandardCharsets.UTF_8), Collectors.toList())));
} 
```

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2019-05-02T12:02:04.530

Kotlin 的答案，最初参考来自[https://stackoverflow.com/a/51024552/3286489](https://stackoverflow.com/a/51024552/3286489)，但通过整理代码并提供了 2 个版本，并使用不可变集合操作来改进版本

用于`java.net.URI`提取查询。然后使用下面提供的扩展功能

1.  假设您只想要查询的最后一个值，即`page2&page3`会得到`{page=3}`，请使用以下扩展功能

```
 fun URI.getQueryMap(): Map<String, String> {
        if (query == null) return emptyMap()

        return query.split("&")
                .mapNotNull { element -> element.split("=")
                        .takeIf { it.size == 2 && it.none { it.isBlank() } } }
                .associateBy({ it[0].decodeUTF8() }, { it[1].decodeUTF8() })
    }

    private fun String.decodeUTF8() = URLDecoder.decode(this, "UTF-8") // decode page=%22ABC%22 to page="ABC" 
```

2.  假设您想要查询的所有值的列表，即`page2&page3`会得到`{page=[2, 3]}`

```
 fun URI.getQueryMapList(): Map<String, List<String>> {
        if (query == null) return emptyMap()

        return query.split("&")
                .distinct()
                .mapNotNull { element -> element.split("=")
                        .takeIf { it.size == 2 && it.none { it.isBlank() } } }
                .groupBy({ it[0].decodeUTF8() }, { it[1].decodeUTF8() })
    }

    private fun String.decodeUTF8() = URLDecoder.decode(this, "UTF-8") // decode page=%22ABC%22 to page="ABC" 
```

使用方法如下

```
 val uri = URI("schema://host/path/?page=&page=2&page=2&page=3")
    println(uri.getQueryMapList()) // Result is {page=[2, 3]}
    println(uri.getQueryMap()) // Result is {page=3} 
```

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2018-11-16T17:10:28.357

在这里回答，因为这是一个流行的线程。这是 Kotlin 中使用推荐`UrlQuerySanitizer`api 的干净解决方案。[见官方文档](https://developer.android.com/reference/android/net/UrlQuerySanitizer)。我添加了一个字符串生成器来连接和显示参数。

```
 var myURL: String? = null

    if (intent.hasExtra("my_value")) {
        myURL = intent.extras.getString("my_value")
    } else {
        myURL = intent.dataString
    }

    val sanitizer = UrlQuerySanitizer(myURL)
    // We don't want to manually define every expected query *key*, so we set this to true
    sanitizer.allowUnregisteredParamaters = true
    val parameterNamesToValues: List<UrlQuerySanitizer.ParameterValuePair> = sanitizer.parameterList
    val parameterIterator: Iterator<UrlQuerySanitizer.ParameterValuePair> = parameterNamesToValues.iterator()

    // Helper simply so we can display all values on screen
    val stringBuilder = StringBuilder()

    while (parameterIterator.hasNext()) {
        val parameterValuePair: UrlQuerySanitizer.ParameterValuePair = parameterIterator.next()
        val parameterName: String = parameterValuePair.mParameter
        val parameterValue: String = parameterValuePair.mValue

        // Append string to display all key value pairs
        stringBuilder.append("Key: $parameterName\nValue: $parameterValue\n\n")
    }

    // Set a textView's text to display the string
    val paramListString = stringBuilder.toString()
    val textView: TextView = findViewById(R.id.activity_title) as TextView
    textView.text = "Paramlist is \n\n$paramListString"

    // to check if the url has specific keys
    if (sanitizer.hasParameter("type")) {
        val type = sanitizer.getValue("type")
        println("sanitizer has type param $type")
    } 
```

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2019-08-12T08:37:35.280

这是我使用**reduce**和**Optional**的解决方案：

```
private Optional<SimpleImmutableEntry<String, String>> splitKeyValue(String text) {
    String[] v = text.split("=");
    if (v.length == 1 || v.length == 2) {
        String key = URLDecoder.decode(v[0], StandardCharsets.UTF_8);
        String value = v.length == 2 ? URLDecoder.decode(v[1], StandardCharsets.UTF_8) : null;
        return Optional.of(new SimpleImmutableEntry<String, String>(key, value));
    } else
        return Optional.empty();
}

private HashMap<String, String> parseQuery(URI uri) {
    HashMap<String, String> params = Arrays.stream(uri.getQuery()
            .split("&"))
            .map(this::splitKeyValue)
            .filter(Optional::isPresent)
            .map(Optional::get)
            .reduce(
                // initial value
                new HashMap<String, String>(), 
                // accumulator
                (map, kv) -> {
                     map.put(kv.getKey(), kv.getValue()); 
                     return map;
                }, 
                // combiner
                (a, b) -> {
                     a.putAll(b); 
                     return a;
                });
    return params;
} 
```

*   我忽略了重复的参数（我取最后一个）。
*   我`Optional<SimpleImmutableEntry<String, String>>`以后习惯于忽略垃圾
*   减少从一个空映射开始，然后在每个 SimpleImmutableEntry 上填充它

如果你问，**reduce**需要在最后一个参数中使用这个奇怪的组合器，它只在并行流中使用。它的目标是合并两个中间结果（这里是 HashMap）。

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2020-12-06T17:07:12.443

如果你碰巧在类路径上有 cxf-core 并且你知道你没有重复的查询参数，你可能想要使用[UrlUtils.parseQueryString](https://cxf.apache.org/javadoc/latest/org/apache/cxf/common/util/UrlUtils.html#parseQueryString-java.lang.String-)。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2021-09-08T17:12:20.667

如果只需要来自字符串的 URL 之后的参数。然后以下代码将起作用。我只是假设简单的 URL。我的意思是没有严格和快速的检查和解码。就像在我的一个测试用例中一样，我得到了 Url，我知道我只需要参数的值。网址很简单。无需编码解码。

```
String location = "https://google.com.ua/oauth/authorize?client_id=SS&response_type=code&scope=N_FULL&access_type=offline&redirect_uri=http://localhost/Callback";
String location1 = "https://stackoverflow.com?param1=value1&param2=value2&param3=value3";
String location2 = "https://stackoverflow.com?param1=value1&param2=&param3=value3&param3";

    Map<String, String> paramsMap = Stream.of(location)
        .filter(l -> l.indexOf("?") != -1)
        .map(l -> l.substring(l.indexOf("?") + 1, l.length()))
        .flatMap(q -> Pattern.compile("&").splitAsStream(q))
        .map(s -> s.split("="))
        .filter(a -> a.length == 2)
        .collect(Collectors.toMap(
            a -> a[0], 
            a -> a[1],
            (existing, replacement) -> existing + ", " + replacement,
            LinkedHashMap::new
        ));

    System.out.println(paramsMap); 
```

谢谢

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2018-06-07T18:04:20.393

只是对 Java 8 版本的更新

```
public Map<String, List<String>> splitQuery(URL url) {
    if (Strings.isNullOrEmpty(url.getQuery())) {
        return Collections.emptyMap();
    }
    return Arrays.stream(url.getQuery().split("&"))
            .map(this::splitQueryParameter)
            .collect(Collectors.groupingBy(SimpleImmutableEntry::getKey, LinkedHashMap::new, **Collectors**.mapping(Map.Entry::getValue, **Collectors**.toList())));
} 
```

mapping 和 toList() 方法必须与顶级答案中未提及的收集器一起使用。否则会在IDE中抛出编译错误

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2018-01-19T03:13:36.377

如果您使用的是 Spring，`@RequestParam Map<String,String>` 请在控制器方法中添加类型参数，Spring 将为您构建地图！

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2021-06-21T12:51:09.510

[Eclipse Jersey REST](https://eclipse-ee4j.github.io/jersey/)框架通过[`UriComponent`](https://github.com/eclipse-ee4j/jersey/blob/master/core-common/src/main/java/org/glassfish/jersey/uri/UriComponent.java). 例子：

```
import org.glassfish.jersey.uri.UriComponent;

String uri = "https://google.com.ua/oauth/authorize?client_id=SS&response_type=code&scope=N_FULL&access_type=offline&redirect_uri=http://localhost/Callback";
MultivaluedMap<String, String> params = UriComponent.decodeQuery(URI.create(uri), true);
for (String key : params.keySet()) {
  System.out.println(key + ": " + params.getFirst(key));
} 
```**

# objective-c - 指向对象枚举/标签以获取字符串，

> ID：13592239
> 
> 赞同：0
> 
> 时间：2012-11-27T20:12:03.590
> 
> 标签：objective-c

我需要获取一个按钮枚举以在需要按钮名称的方法中使用。

```
enum {
    Arle = 1,
    Bain, 
    ...   
};

arle = [UIButton buttonWithType:UIButtonTypeCustom];
arle.tag = Arle; 
```

我不能指向 arle.tag 因为它是双精度而不是字符串，有什么我可以指向的，以获得 @"Arle" 的结果吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T20:15:08.003

不，C 中没有办法将枚举自动转换为字符串。

**编辑：**

您必须手动转换：

```
static inline NSString *enum2String(int value)
{
    switch(value) {
        case Arle: return @"Arle";
        case Bain: return @"Bain";
        default: return nil;
    }
} 
```

# sql - 从数据中删除特殊/不可打印的字符

> ID：13592241
> 
> 赞同：1
> 
> 时间：2012-11-27T20:12:06.053
> 
> 标签：sql, sql-server, xml, sql-server-2008, special-characters

我的 sql 表中有特殊字符，想删除这些特殊字符。

我有一个函数可以去除所有破坏 XML 的字符。

```
fn_RemoveBadXMLChars(data) 
```

它做这样的事情：

```
REPLACE(@ResultVar,'ÿ','') 
```

有没有更简单的方法来删除每个特殊字符而不是有 100 个替换语句？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T20:21:34.817

您可以创建一个过滤表，其中包含要替换的每个值的记录，如下所示：

```
CREATE TABLE FilterTable (
    FilterCharacter nchar(1) primary key
)

INSERT INTO FilterTable SELECT 'ÿ'
INSERT INTO FilterTable SELECT 'o' 
```

然后使用一个变量来替换您的过滤器表，如下所示：

```
DECLARE @ResultVar nvarchar(50)
SET @ResultVar = 'Bobbÿ'

SELECT @ResultVar = REPLACE(@ResultVar, FilterCharacter, '')
FROM FilterTable   

SELECT @ResultVar 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T20:34:31.993

我喜欢 LittleBobbyTables 的回答，但另一种方法是将你的函数代码更改为这样的

```
 declare @value as varchar(100) = ' 98;;445498ÿThis is test     ';
   declare @len as int = LEN(@value);
   declare @i as int = 1;
   declare @work as varchar(1);
   declare @retValue as varchar(max) = '';
   declare @asciiValue as int

   while @i <= @len begin
     set @i = @i + 1;
     set @work = SUBSTRING(@value,@i,1);
     set @asciiValue = ASCII(@work);    
     -- Allow space(32) though } (125)
     if (@asciiValue between 32 and 125) and @asciiValue not in (38) -- Exclude
       set @retValue = @retValue + @work;
  end
  print @retValue 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-07-31T15:45:23.997

我结合了一些我找到的解决方案，最后我得到了这个结果：

```
CREATE FUNCTION [dbo].[RemoveSpecialChars] (@Input VARCHAR(MAX))
RETURNS VARCHAR(MAX)
BEGIN
DECLARE @Expression NVARCHAR(50) = '[^A-Za-z0-9]'
DECLARE @pos INT = PATINDEX('%' + @Expression + '%', @Input)

WHILE @Pos > 0
BEGIN
    SET @Input = STUFF(@Input, @pos, 1, '')
    SET @Pos = PATINDEX('%' + @Expression + '%', @Input)
END
RETURN @Input
END 
```

您可以通过修改@Expression 来定义要保留的字符。如果你想保留所有字符和数字加上'@'你会改变

```
DECLARE @Expression NVARCHAR(50) = '[^A-Za-z0-9]' 
```

到

```
DECLARE @Expression NVARCHAR(50) = '[^@A-Za-z0-9]' 
```

这将删除除字符、数字和“@”之外的所有内容。

# c++ - 遍历一个字符串并将其与另一个进行比较以检查第一个中的字符是否进入第二个

> ID：13592243
> 
> 赞同：0
> 
> 时间：2012-11-27T20:12:11.897
> 
> 标签：c++, string

我该怎么做？一整天我一直在到处寻找解决方案:(它在c ++中，所有问题都在标题中，谢谢

```
if(fp.is_open())
{
    while(getline(fp, buff))
    {
        if(buff.length() == lung)
        {
            // check if the characters are in the string

            while(found != string::npos)
            {
                cout << i << "\r";

                for(int x = 0; x < buff.length(); ++x)
                {
                    found = lettere_possibili.find(buff[x]);

                    if(found == string::npos)
                    {
                        continue;
                    }
                }

                ++i;        
            }

            j = 0;
        }

        ++k;
    }

    fp.close();
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T20:18:40.210

这个问题并不完全清楚，但在我看来，您似乎正在寻找`find_first_not_of()`：

```
bool containsOnlyCharsFromPossibili = (buff.find_first_not_of(lettere_possibili) == string::npos); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T20:24:47.883

```
#include <iostream>

void find_chars(const std::string &first, const std::string &second)
{
    std::string::const_iterator s;

    for (s = second.begin(); s != second.end(); ++s)
    {
        if (first.find(*s) != std::string::npos)
        {
            std::cout << *s << " is in " << second << "\n";
        }
    }
}

int main()
{
    find_chars("abc", "abcdef");
} 
```

这是输出：

```
a is in abcdef
b is in abcdef
c is in abcdef 
```

# java - Java，volatile 也能保证可见性吗？

> ID：13592253
> 
> 赞同：3
> 
> 时间：2012-11-27T20:13:00.220
> 
> 标签：java, concurrency

```
public class Stuff {
  private final Timer timer = new Timer(true);
  public static final int DEFAULT_TIMEOUT = 1500;
  private volatile int timeout = DEFAULT_TIMEOUT;

  public void doStuff(OtherStuff) {
     ...
     timer.schedule(timeout, ...);
  }

  public void setTimeout(int timeout) {
     this.timeout = timeout;
  }

  public int getTimeout() {
    return timeout;
  }

} 
```

此类的实例仅从 1 个线程访问，但可以从另一个类更改的超时变量除外。在我的例子中是一个 JMX bean，这意味着可以在运行时从管理界面更改超时。

doStuff() 可以运行 100 次/秒，而 setTimeout() 可以每周运行一次 - 因此执行 setTimeout() 的人和执行 doWork() 的人之间的顺序并不重要。

`timeout`对于这种情况，使volatile 足够吗？内存模型会保证从一个线程设置此方法对`doStuff()`方法可见吗？

另一个看起来安全的替代方案就是：

```
public class Stuff {
  private final Timer timer = new Timer(true);
  public static final int DEFAULT_TIMEOUT = 1500;
  private int timeout = DEFAULT_TIMEOUT;
  public void doStuff(OtherStuff) {
     ...
     timer.schedule(getTimeout(), ...);
  }

  public void synchronized setTimeout(int timeout) {
     this.timeout = timeout;
  }
   public int synchronized getTimeout() {
    return timeout;
  }
} 
```

这两种方法中的哪一种更受欢迎？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-27T20:15:43.230

从可见性的角度来看，这两种方法是等效的。在对同一 volatile 变量进行写入之后发生的任何对 volatile 的读取都可以保证看到写入。

因此，如果一个线程写入`timeout = newValue;`，随后调用的任何其他线程`timer.schedule(timeout)`都可以看到`newValue`。

此保证在[JLS 17.4.5](http://docs.oracle.com/javase/specs/jls/se7/html/jls-17.html#jls-17.4.5)中指定：

> 对 volatile 字段（第 8.3.1.4 节）的写入发生在对该字段的每次后续读取之前。

我会简单地使用 volatile ，因为它提供的保证已经足够，并且清楚地表明了您的意图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-05-19T08:25:18.623

尽管该示例的两种方法都是等效的，但我认为（由于问题的普遍性）值得讨论一下：

volatile 变量的可见性影响超出了 volatile 变量**本身**的值。如果问题是“ volatile 是否也能保证同一个 volatile 变量的可见性？”。答案是肯定的。

但是不能保证在写入该变量之前使用的（如果有）其他变量的可见性。

来自[完全不稳定的可见性保证](http://tutorials.jenkov.com/java-concurrency/volatile.html)。

例子：

> 当线程 A 写入 volatile 变量并且随后线程 B 读取相同的变量时，在写入 volatile 变量之前对 A 可见的**所有变量的值在读取 volatile 变量****之后**对 B 可见。

# vb.net - 在默认浏览器中打开所有超链接

> ID：13592254
> 
> 赞同：1
> 
> 时间：2012-11-27T20:13:01.060
> 
> 标签：vb.net, windows-forms-designer

我花了过去 3 小时试图找到解决方案，但没有得到太多。有些很接近，但对我有用。（Process.Start 或 shell 对我不起作用，因为我希望特定网站中的所有超链接都在默认浏览器而不是 IE 中打开。下面是我正在使用的代码。

提前致谢。

```
 Try
        If IsConnectionAvailable("http://google.com") = True Then
            MapBrowser.Navigate("http://localhost")
            '  Me.BackgroundImage = System.Drawing.Image.FromFile(ImgBackground)
        Else
            MapBrowser.Navigate("http://yahoo.com")
          Timer4.Start()
        End If

    Catch ex As Exception
        MsgBox(ex.Message())
    End Try 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T20:20:09.093

在浏览器控件上捕获`Navigating`事件，然后处理要在新窗口中打开的事件。 `Process.Start()`将打开默认浏览器。如果它为您打开 IE，则 IE 是您的默认浏览器。

```
Private Sub webBrowser1_Navigating( _
    ByVal sender As Object, ByVal e As WebBrowserNavigatingEventArgs) _
    Handles webBrowser1.Navigating

    If Not (e.Url = "some URL you don't want to pop up in new window") Then
        Process.Start(e.Url.ToString())
        e.Cancel = true
    End If
End Sub 
```

未经测试，但你明白了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T21:25:59.560

```
Private Sub webBrowser1_Navigating(ByVal sender As Object, ByVal e As WebBrowserNavigatingEventArgs) Handles webBrowser1.Navigating
'if the url isnt a part of your site
If Not e.Url.ToString().Contains("http://yoursite.com") Then
    Process.Start(e.Url.ToString())
    e.Cancel = true
End If
End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-17T16:05:18.430

以 Brad 的示例为基础，您可以进行如下操作，它将加载 Web 浏览器控件中的第一页以及默认浏览器中的所有后续链接：

```
Private Sub Form1_Leave(sender As Object, e As EventArgs) Handles Me.FormClosing
    OpenAllInBrowser = False   ' This is to reset the variable to False, because
End Sub                        ' sometimes closing the form doesn't reset the variables.

Private Sub WebBrowser1_DocumentCompleted(sender As Object, e As WebBrowserDocumentCompletedEventArgs) Handles WebBrowser1.DocumentCompleted
    OpenAllInBrowser = True
End Sub

Private OpenAllInBrowser As Boolean = False

Private Sub webBrowser1_Navigating(ByVal sender As Object, ByVal e As WebBrowserNavigatingEventArgs) Handles WebBrowser1.Navigating
    If OpenAllInBrowser Then
        Process.Start(e.Url.ToString())
        e.Cancel = True
    End If
End Sub 
```

希望这可以帮助。

# c++ - 什么是 DX::ThrowIfFailed？

> ID：13592255
> 
> 赞同：8
> 
> 时间：2012-11-27T20:13:06.020
> 
> 标签：c++, visual-c++, c++-cx

我最近又回到了 C++。我已经离开使用 C# 的 C++/CLI 至少一年了，我有点生疏了。我正在查看适用于 Windows 8 的 Direct3D 应用程序的基本示例，但找不到任何解释

```
 DX::ThrowIfFailed 
```

做。从它所说的内容来看，如果 DirectX 中的某些东西失败了，它将执行某些东西，但从实现来看，它似乎被用于初始化东西，作为 Direct3D 的基础演示：

```
 Platform::String^ text = "Hello, DirectX!";

DX::ThrowIfFailed(
    m_dwriteFactory->CreateTextLayout(
        message->Data(),
        message->Length(),
        m_textFormat.Get(),
        700, // maxWidth.
        1000, // maxHeight.
        &m_textLayout
        )
    ); 
```

有人可以向我解释这个功能是如何工作的。我看到它分散在示例中，但没有多少谷歌搜索可以减轻适当的文档。提前谢谢你！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-27T20:16:35.463

此函数将失败的 HRESULT 转换为异常。它是在 DirectXHelper.h 中定义的，它是 Direct3D 应用程序模板的一部分：

```
inline void ThrowIfFailed(HRESULT hr)
{
    if (FAILED(hr))
    {
        // Set a breakpoint on this line to catch Win32 API errors.
        throw Platform::Exception::CreateException(hr);
    }
} 
```

如果您使用的是 Visual Studio，则可以右键单击`ThrowIfFailed`代码中的任何实例并选择“转到定义”。这将打开包含定义的文件并导航到其位置。

> 有关此帮助程序的更多信息，请参阅[GitHub](https://github.com/Microsoft/DirectXTK/wiki/ThrowIfFailed)

# unit-testing - 在单元测试中模拟我自己的服务

> ID：13592259
> 
> 赞同：6
> 
> 时间：2012-11-27T20:13:20.963
> 
> 标签：unit-testing, mocking, angularjs

我有一项服务将我的其他几个服务作为依赖项。我如何模拟它进行单元测试？

```
myApp.factory('serviceToTest',
           ['serviceDependency',
    function(serviceDependency) {
        return function(args) {
            return cond(args) ? serviceDependency() : somethingElse();
        };
    }
]); 
```

在上面的示例中，我想模拟出来，`serviceDependency`以便验证它是否被调用。我怎样才能做到这一点？

我可以在测试中执行以下操作：

```
describe("Services", function() {
    describe('serviceToTest', function() {

        myApp.factory('serviceDependency', function() {
            var timesCalled = 0;
            return function() {
                return timesCalled++;
            }
        });

        it('should do foo', inject(function(serviceToTest, serviceDependency) {
            serviceToTest(["foo", "bar", "baz"]);
            expect(serviceDependency()).to.equal(1);
        });
    });
}); 
```

这适用于需要模拟的测试，但它会影响随后所有其他测试的状态，这显然是一个问题。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-01T21:18:19.883

如果我理解正确，您想测试一个依赖于另一个服务的服务并模拟每个测试的依赖关系。如果是这样，假设我们`car`有一个依赖于 a 的 a `engine`：

```
var app = angular.module('plunker', [])
  .factory('car', function(engine) {
     return {
       drive : function() {
         return 'Driving: ' + engine.speed();
       }
     }
  })
  .value('engine', {
    speed : function() {
      return 'fast';
    }
  }); 
```

然后你想测试一辆汽车并模拟一个引擎。有两种方法：或者通过定义一个新模块，我们可以在其中重新定义一个引擎：

```
describe('Testing a car', function() {
  var testEngine;

  beforeEach(function(){
    testEngine = {};
    angular.module('test', ['plunker']).value('engine', testEngine);
    module('test');
  });   

  it('should drive slow with a slow engine', inject(function(car) {
    testEngine.speed = function() {
      return 'slow';
    };
    expect(car.drive()).toEqual('Driving: slow');
  }));
}); 
```

在这里工作的笨蛋：http://plnkr.co/edit/ueXIzk? [p =preview](http://plnkr.co/edit/ueXIzk?p=preview)

一个更简单的替代方案，基于 JavaScript 的动态特性：

```
describe('Testing a car', function() {
  var testEngine;

  beforeEach(module('plunker'));
  beforeEach(inject(function(engine){
    testEngine = engine;
  }));

  it('should drive slow with a slow engine', inject(function(car) {
    testEngine.speed = function() {
      return 'slow';
    };
    expect(car.drive()).toEqual('Driving: slow');
  }));
}); 
```

[http://plnkr.co/edit/tlHnsJ?p=preview](http://plnkr.co/edit/tlHnsJ?p=preview)

另一种选择是使用 Jasmine 的间谍：

```
describe('Testing a car', function() {
  var testEngine;

  beforeEach(module('plunker'));
  beforeEach(inject(function(engine){
    testEngine = engine;
  }));

  it('should drive slow with a slow engine', inject(function(car) {
    spyOn(testEngine, 'speed').andReturn('slow');
    expect(car.drive()).toEqual('Driving: slow');
  }));
}); 
```

[http://plnkr.co/edit/K4jczI?p=preview](http://plnkr.co/edit/K4jczI?p=preview)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-02-24T07:56:23.150

我在尝试将模拟服务注入另一个提供商时遇到了同样的问题。

Pete Bacon Darwin 的这篇文章让我走上了正轨：[https ://groups.google.com/d/msg/angular/TvBknXnjRyQ/xtCDkJyqp6MJ](https://groups.google.com/d/msg/angular/TvBknXnjRyQ/xtCDkJyqp6MJ)

这是一个示例应用程序：

```
angular.module('MyApplication', [])
    .service('MyServiceDependency', [function(){
        // Behaviour here.
    }])
    .factory('MyFactory', ['MyServiceDependency', function(MyServiceDependency){
        // Behaviour here.
    }]); 
```

我们想模拟`MyServiceDependency`测试的行为，`MyFactory`所以我们这样编写测试：

```
describe(function(){

    var MyFactory;

    beforeEach(function(){
        // 1\. Include your application module for testing.
        angular.mock.module('MyApplication');

        // 2\. Define a new module.
        // 3\. Define a provider with the same name as the one you want to mock (in our case we want to mock 'MyServiceDependency'.
        angular.module('MyAppMock', [])
            .service('MyServiceDependency', function(){
                // Define you mock behaviour here.
            });

        // 4\. Include your new mock module - this will override the providers from your original module.
        angular.mock.module('MyAppMock');

        // 5\. Get an instance of the provider you want to test.
        inject(function($injector){
            // `MyFactory` will receive the mocked version of `MyServiceDependency`.
            MyFactory = $injector.get('MyFactory');
        });
    });

    it('MyFactory does something special', function(){
        MyFactory(); // Test your provider.
    });

}); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-28T09:29:53.167

这是我的开源项目中的一个示例：[https](https://github.com/lucassus/mongo_browser/blob/f1faf1b89a9fc33ef4bc4eced386c30bda029efa/spec/javascripts/app/services_spec.js.coffee#L25) ://github.com/lucassus/mongo_browser/blob/f1faf1b89a9fc33ef4bc4eced386c30bda029efa/spec/javascripts/app/services_spec.js.coffee#L25 （对不起coffeescript）。通常在规范中，您必须创建并包含一个覆盖给定服务的新模块。

# java - 使用 java 获取正在运行的应用程序列表，然后向其发送按键

> ID：13592261
> 
> 赞同：0
> 
> 时间：2012-11-27T20:13:25.047
> 
> 标签：java, psexec, awtrobot

java甚至可以做到这一点吗？我知道它应该是“沙盒”，但我想要做的是：

1.  打开我的java程序
2.  有一个组合框，里面装满了正在运行的程序（运行时 exec？）
3.  在我选择了正在运行的程序之后，我想在一定的延迟后反复向该程序发送一个密钥（机器人？），如果它被最小化，在后台等，应该没关系

所以我想我的问题真的是如何选择将密钥发送到的程序？

我一直在看机器人类，但我似乎找不到我会使用的正确方法

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T20:24:35.353

如果我是你，我会使用操作系统特定的[运行时](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Runtime.html)方法。使用它来调用操作系统方法。

[在这里](http://www.rgagnon.com/javadetails/java-0014.html)查看一些示例。

# javascript - 在 Google Groups 中设置文本，发布消息正文但不显示？

> ID：13592263
> 
> 赞同：2
> 
> 时间：2012-11-27T20:13:34.583
> 
> 标签：javascript, google-chrome-extension, textbox, contenteditable, content-script

我的扩展程序在内容脚本中写入 Google 网上论坛“新主题”页面的主题和消息正文。

更新的主题显示得很好；它是输入类型“文本”，所以一切都很简单。然而，主体是一个代表文本框的 div，当我写入它时，不会出现更新：

[（点击查看大图。）
![相关 HTML 截图](../Images/a694a46d0d093995816e2a9e6b6bcf21.png)](https://i.stack.imgur.com/XRz5o.png)

我尝试先将焦点设置到该领域，但这没有效果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T03:49:57.817

您如何尝试设置文本？[**显示您的代码！**](https://meta.stackexchange.com/q/156810/148310)

***初始***设置`contenteditable`元素的典型方法如下：

```
var messageBody         = document.getElementById ("p-b-0");
messageBody.innerHTML   = '<p>Line 1.</p><p>Line 2.</p>'; 
```

* * *

请注意， using`innerHTML`会擦除之前文本框上可能存在的任何内容——这对于这个问题的场景来说是可以的。

（对于更高级的更改/编辑，加载 jQuery 并使用它在编辑框中添加/删除/替换节点。但是，这是不同搜索和/或问题的主题。）

# php - 执行 php 脚本后定位 cronjobs

> ID：13592268
> 
> 赞同：2
> 
> 时间：2012-11-27T20:13:53.943
> 
> 标签：php, crontab

所以我正在制作一些 cronjobs 来自动执行一些脚本。我正在使用以下命令制作 cronjobs：

```
exec('echo -e "`crontab -l`\nmin hour day month year wget http://... | crontab -'); 
```

我的问题是这些 cronjobs 被写入哪里？我检查了我服务器上的 crontab，但它们不存在……它们是在我的服务器上作为匿名用户编写的吗？

# android - 从 Web 服务接收数据并使用 AsyncTask 将它们绑定到 Spinner 时出错

> ID：13592270
> 
> 赞同：0
> 
> 时间：2012-11-27T20:13:57.153
> 
> 标签：android, asp.net, web-services, ksoap2

我正在尝试从返回的 Web 服务方法接收数据，`list (of string)`我已经`ASP.NET`像这样创建它

```
<WebMethod()> _
Public Function HelloWorld() As List(Of String)
    Dim names As New List(Of String)
    names.Add("aaa")
    names.Add("bbb")
    names.Add("ccc")
    Return names
End Function 
```

* * *

像这样的调用结果

```
<string>aaa</string>
<string>bbb</string>
<string>ccc</string> 
```

现在我需要接收此数据并将其放入 Spinner

我做 ...

```
public class MainActivity extends Activity 
{

private Spinner myspinner;
private static final String METHOD_NAME = "HelloWorld";  
private static final String NAMESPACE = "http://tempuri.org";   
private static final String SOAP_ACTION = "http://tempuri.org/HelloWorld";
private static final String URL = "http://www.xxxxxxxxxxx.com/ws/AndroidMethods.asmx";
private String[] Values;

private void SektorDoldur()
{
    SoapObject request = new SoapObject(NAMESPACE, METHOD_NAME);
    SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
    envelope.dotNet = true;     
    envelope.setOutputSoapObject(request);
    HttpTransportSE androidHttpTransport = new HttpTransportSE(URL);
    androidHttpTransport.debug = true;
try 
    {
       androidHttpTransport.call(SOAP_ACTION, envelope);
       SoapObject response = (SoapObject) envelope.getResponse();
       Values = new String[response.getPropertyCount()];
       for(int i=0;i<response.getPropertyCount();i++)
          {     
           Values[i] = response.getPropertyAsString(i).toString();
          }      
    }
catch (Exception e)
    {
    e.printStackTrace(); 
    }
}

@Override
public void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    myspinner = (Spinner)findViewById(R.id.spinner1);
    new MyTask().execute();
}
public class MyTask extends AsyncTask<Void, Void, String>
{

String response = "";
public void onPreExecute() 
  {
    super.onPreExecute();
  }
    @Override
protected String doInBackground(Void... arg0)
{
       SektorDoldur();
       return "";
}
@Override
public void onPostExecute(String res)
{

    ArrayAdapter<String> adapter = new ArrayAdapter<String>(this,android.R.layout.simple_spinner_item, Values);
    adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
    myspinner.setAdapter(adapter);           
}
}
} 
```

此行有错误

```
ArrayAdapter<String> adapter = new ArrayAdapter<String>this,android.R.layout.simple_spinner_item, Values); 
```

在`onPostExecute`方法中

你能帮我做那个吗...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T20:18:05.483

> 构造函数 ArrayAdapter(MainActivity.MyTask, int, String[]) 未定义

在这一行：

```
ArrayAdapter<String> adapter = new ArrayAdapter<String>(this, android.R.layout.simple_spinner_item, Values); 
```

`this`指的是 MyTask 类，而不是您期望的 Activity 的上下文。您需要传递对有效上下文的引用，例如：

```
ArrayAdapter<String> adapter = new ArrayAdapter<String>(MainActivity.this, android.R.layout.simple_spinner_item, Values); 
```

* * *

**添加**

> 如何从二维中检索列表，例如
> 
> ```
> Public Class NameAndvalue
>     Public name As String
>     Public value As String
> End Class 
> ```
> 
> 我需要在微调器中显示名称以及单击某个项目时的值...

一种方法是使用`List<Map<String, String>> values`将每个`name`和存储`value`在 Map 中，并`name`使用 SimpleAdapter 在 Spinner 中显示您的字符串：

```
SimpleAdapter adapter = new SimpleAdapter(this, values, 
        android.R.layout.simple_spinner_item, 
        new String[] {"name"}, new int[] {android.R.id.text}); 
```

最后，在您的`onItemSelected()`方法中，您现在可以使用`value`值而不是`name`值。

# java - 使用 JTidy 抓取 Java 屏幕 - 解析 HTML 值

> ID：13592271
> 
> 赞同：1
> 
> 时间：2012-11-27T20:14:00.090
> 
> 标签：java, html, screen-scraping, scrape, jtidy

所以我想要完成的是从网络系列中抓取一个 IMDB 网页以获取数据。问题是当我将页面转换为 DOM 对象并尝试获取值时，它并不像看起来那么容易。

例如：我使用 getElementsByTagName("h1") -> 它返回 1 个值，所以我知道我可以得到什么值（在这种情况下是节目的名称）。但是当我想提取节目评级时，它被隐藏在 Div 中并且很难查找。所以我尝试使用 getElementById(id of the element) 来获取该id的元素（div），这样我就可以缩短搜索时间。

但它返回一个空值？抓取此类页面的最简单方法是什么？

这是一个代码片段 public final class IMDBExtractor { private String imdbId;

```
public IMDBExtractor(String imdbId) {
    this.imdbId = imdbId;
}

public synchronized TvShow extractTvShow() throws IOException {
    TvShow show = new TvShow();

    //access imdb url
    URL url  = new URL("http://www.imdb.com/title/" + imdbId);
    URLConnection uc = url.openConnection();
    uc.addRequestProperty("User-Agent",
            "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)");
    uc.connect();

    //Tidy up HTML
    Tidy tidy = new Tidy();
    tidy.setXmlOut(true);
    tidy.setShowWarnings(false);
    Document doc = tidy.parseDOM(uc.getInputStream(), null);
    //Set show attributes
     show.setImdbId(imdbId);
     show.setTitle(extractSeriesName(doc));
     show.setRating(extractRating(doc));
    return show;
}

private String extractSeriesName(Document doc) throws IOException {
  return doc.getElementsByTagName("h1").item(0).getChildNodes().item(0).getNodeValue();
}

private Double extractRating(Document doc) throws IOException {
    System.out.println(doc.getElementById("content-2-wide").getNodeName());
    return null;
} 
```

}

在这种情况下我要抓取的页面是： [箭头](http://www.imdb.com/title/tt2193021/)

所有 imdb 页面都有相同的模型，所以这不是问题，你们知道一个简单的方法吗？

# javascript - Javascript - innerHTML 属性

> ID：13592273
> 
> 赞同：1
> 
> 时间：2012-11-27T20:14:05.613
> 
> 标签：javascript, html, innerhtml

我正在使用 innerHTML 函数在 HTML 中动态创建一个下拉菜单并使用某些参数填充它。这是我的代码：

```
for (i in categories) {
    var cat_name = i;
    var cats = categories[cat_name];

    P2_txt.innerHTML += cat_name;       

    if (cats.length > 2) {
        // Drop Down Menu Needed
        P2_txt.innerHTML += '<select>';

        for (var j = 0; j < cats.length; j++) {
            P2_txt.innerHTML += '<option>'+cats[j]+'</option>';
        }

        P2_txt.innerHTML += '</select>';
    }   
} 
```

但是，当我运行它时，会生成以下 HTML 代码：

```
<select></select>
<option>Value of cats[0]</option>
<option>Value of cats[1]</option>
<option>Value of cats[2]</option> 
```

而不是我想要的，这是：

```
<select>
    <option>Value of cats[0]</option>
    <option>Value of cats[1]</option>
    <option>Value of cats[2]</option>
</select> 
```

有什么想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-27T20:15:46.020

当您修改`innerHTML`它时，它会立即解析到 DOM 中......因此您有效地添加了一个`select`元素，然后是一堆`option`超出预期层次结构的元素。

所以，你要么：

1.  构建*整个*组合框标记，*然后*将其添加到 `innerHTML`
2.  **或者**使用 DOM 方法[`createElement`](https://developer.mozilla.org/en-US/docs/DOM/document.createElement)等等 [`appendChild`](https://developer.mozilla.org/en-US/docs/DOM/Node.appendChild)而不是丑陋的字符串连接。

```
var categories = {
    "Domestic": ["Tabby", "Siamese"],
    "Wild": ["Cougar", "Tiger", "Cheetah"]
  },
  cats,
  combo,
  frag = document.createDocumentFragment();

for (var category in categories) {

  cats = categories[category];

  frag.appendChild(document.createTextNode(category));

  combo = document.createElement("select");

  for (var i = 0, ln = cats.length; i < ln; i++) {
    combo.appendChild(document.createElement("option")).textContent = cats[i];
  }

  frag.appendChild(combo);
}

document.body.appendChild(frag);
```

​</p>

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T20:15:51.150

除非您附加*完整*的HTML ，否则切勿使用`+=`with 。`innerHTML`

 *因此，您应该创建一个字符串，`var str = ""; ... str += "...";`，然后附加它：`P2_txt.innerHTML += str;`。*

# jquery - MVC4 jQuery Mobile 日期时间选择器格式仅限 MM/YYYY

> ID：13592275
> 
> 赞同：0
> 
> 时间：2012-11-27T20:14:20.710
> 
> 标签：jquery, asp.net-mvc, mobile, formatting, datepicker

我需要能够输入日期，但需要 jQuery Mobile 日期选择器才能接受 MM/YYYY 数据。解决这个问题会很棒。谢谢。

这就是我所拥有的...

看法：

```
 <h3>Search Dates</h3>
 <div data-role="fieldcontain">
    <div class="editor-label">
        @Html.LabelFor(m => m.SearchBeginDate)
    </div>
    <div class="editor-field">
        @Html.TextBoxFor(m => m.SearchBeginDate)
        @Html.ValidationMessageFor(m => m.SearchBeginDate)
    </div>

    <div class="editor-label">
        @Html.LabelFor(m => m.SearchEndDate)
    </div>
    <div class="editor-field">
         @Html.EditorFor(m => m.SearchEndDate)
         @Html.ValidationMessageFor(m => m.SearchEndDate)
    </div>
    <br />
</div> 
```

模型：

```
 [Required]
    [Display(Name = "Begin Date")]
    [DisplayFormat(ApplyFormatInEditMode = true, DataFormatString = "{0:MM/yyyy}")]
    public DateTime SearchBeginDate { get; set; }

    [Required]
    [DisplayFormat(ApplyFormatInEditMode = true, DataFormatString = "{0:MM/yyyy}")]
    [Display(Name = "End Date")]
    public DateTime SearchEndDate { get; set; } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T21:08:21.427

使用“日期”的 HTML5 输入类型属性。这将允许对日期和时间进行本机控制。

```
<input type="date" /> 
```

# c# - 在安装期间在 .Net 安装程序中测试 Oracle 连接，无需先安装 Oracle 客户端

> ID：13592288
> 
> 赞同：1
> 
> 时间：2012-11-27T20:15:14.590
> 
> 标签：c#, .net, oracle, 64-bit

我们有一个需要能够连接到 Oracle 的 64 位 .net Web 应用程序。要求之一是在安装期间我们收集数据库连接信息并测试我们可以连接。安装程序似乎作为 32 位进程运行，并且我包含 64 位 Oracle 客户端文件，一旦安装了所有内容，这应该没问题，但即使我先手动安装即时客户端，安装程序也会失败（可能是由于到客户端是 64 位）。

有人有什么好的建议吗？*在安装后*更改运行配置实用程序的要求并不是不可能的，至少在我看来不是；我还没有真正由商务人士来管理它。

更新：我现在在看 Wix。我们目前正在使用 .vdproj，据我了解，Wix 是在 VS 2012 中创建设置项目的方式。

更新 2：更多背景知识：我们正在从 System.Data.OracleClient（弃用）转换为官方 Oracle 发行版。以前我们引用了 OracleClient 程序集并且一切正常。现在我正在尝试从自定义操作中引用 Oracle.ManagedDataAccess 程序集，但在安装过程中出现“找不到程序集”错误。

# .net - 在特定应用程序中查找 MessageBox？

> ID：13592290
> 
> 赞同：1
> 
> 时间：2012-11-27T20:15:19.010
> 
> 标签：.net, winapi, findwindow, findwindowex

我们已经实施了一个解决方案，给我们的内部用户一个他们需要重新部署我们的应用程序的唠叨消息。我们正在使用文件系统观察程序来监视网络并寻找运行良好的特定文件中的更改。大多数功能都在一个基表单类中实现，我们的应用程序的大多数表单都继承自该基表单类。在重新部署应用程序之前，将每五分钟显示一个新消息框。它让他们感到厌烦，以至于它可以有效地让他们重新部署，但让他们在需要时完成他们所做的任何事情。

如果用户离开他们的办公桌，当他们返回时可能会有 20 多个消息框，就会遇到问题。所以我们要做的是弄清楚他们是否已经关闭了消息框。如果他们没有解雇，就没有理由再展示一个。

他们不仅可以运行多个实现此功能的不同应用程序，还可以运行多个相同的应用程序，只是连接到不同的环境。

我用 FindWindow 成功找到了消息框，但我不知道它属于哪个应用程序的哪个特定实例，所以我不能假设它属于当前实例。我希望 FindWindowEx 通过将消息框所有者的句柄传递给 api 调用来工作，但我没有成功。它总是返回零。

我将展示的代码在 vb.net 中，但我精通 c# 和 vb.net，所以解决方案的形式无关紧要。

无论如何，这里是抛出通知的代码：

```
Private Sub InitDeploymentCheck()
    moDeploymentCheck = New TRS.Deployment.TRSDeploymentCheck(EnvironmentVariables.Environment, AppDomain.CurrentDomain.BaseDirectory.Contains("bin"), MDIMain)
    AddHandler moDeploymentCheck.DeploymentNeeded,
        Sub()
            moTimer = New Timer()
            moTimer.Interval = 300000 '5 minutes
            moTimer.Enabled = True
            AddHandler moTimer.Tick,
                Sub()
                    'check to see if the message box exist or not before throwing up a new one
                    MessageBox.Show(MDIMain, "There is a recent critical deployment, please re-deploy STAR to get latest changes.", "Critical Deployment", MessageBoxButtons.OK, MessageBoxIcon.Warning)
                End Sub
            MessageBox.Show(MDIMain, "There is a recent critical deployment, please re-deploy STAR to get latest changes.", "Critical Deployment", MessageBoxButtons.OK, MessageBoxIcon.Warning)
        End Sub 
```

我能够找到窗口：

```
Dim handle As IntPtr = FindWindow(Nothing, "Critical Deployment") 
```

这就是我尝试使用 FindWindowEX 查找窗口的方式：

```
Dim t As IntPtr = FindWindowEx(200398, IntPtr.Zero, "Form", "Critical Deployment") 
```

200398 是上面 mdimain 的句柄。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T22:06:41.403

为什么不只使用一个命名的[EventWaitHandle](http://msdn.microsoft.com/en-us/library/system.threading.eventwaithandle.aspx)来指示当前是否显示这些消息框之一？您的所有应用程序都可以订阅该事件。当应用程序看到该显示消息框时，它会检查是否设置了等待句柄。如果未设置，则应用程序设置事件并显示消息框。当消息框被关闭时，应用程序会重置事件。如果在选中时设置了事件*，*则应用程序不会显示该消息。

这比`FindWindow`and容易多了`EnumWindows`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T21:56:30.097

获得`HWND`窗口句柄后，您可以使用`GetWindowLong(GWL_HINSTANCE)`或`GetWindowThreadProcessId()`检查窗口属于哪个应用程序实例。用于`EnumWindows()`枚举所有顶级窗口，您的回调函数在其中检查每个报告窗口的标题和进程实例，直到找到您要查找的匹配项。

# java - 如何从 java 将数据 CLOB 和 BLOB 类型发送到数据库

> ID：13592291
> 
> 赞同：1
> 
> 时间：2012-11-27T20:15:18.623
> 
> 标签：java, oracle, jdbc, blob, clob

我需要使用 java 将一些 clob 和 blob 类型的数据插入到我的数据库中。但是通过使用它显示的以下代码来完成此任务

```
 import java.io.*;
           import java.sql.*;
           import java.util.*;
           public class InsertusrProf
           {
    public static Connection prepareConnection()throws ClassNotFoundException,SQLException
{
    String dcn="oracle.jdbc.driver.OracleDriver";
    String url="jdbc:oracle:thin:@JamesPJ-PC:1521:skprk";
    String usname="system";
    String pass="Theking123";
    Class.forName(dcn);
    return DriverManager.getConnection(url,usname,pass);
}
public static void InsTable(String uname,Blob photo1,Blob video1,Blob music1,Clob notes1,Clob messages1,String link,String frd,Clob cmt,String lik,String ulik,Blob shrs,Clob qst,Clob answ,Blob updt,String thms,Clob wrd,String langs,String rlgn,String prvc,String hbs,String fvt,String qlf,String comm,String grp,String pgs,Clob ntfcn,String rqst,Clob tps,String cty,String tg)throws ClassNotFoundException,SQLException
{
    StringBuilder sb=new StringBuilder(1024);;
    sb.append("insert into ").append(uname).append("(PHOTO,VIDEO,MUSIC,NOTES,MESSAGES,LINKS,FRIENDS,COMMENTS,LIKES,UNLIKES,SHARES,QSTNS,ANS,UPDATES,THEMS,WORDS,LANGUAGES,RELEGION,PRIVACY,HOBBIES,FAV,QULIFICATION,COMMUNITIES,GRPS,PAGES,NOTIFICATION,REQUESTS,TIPS,CITY,TAG)values(?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)");
    String stmnt=sb.toString();
    Connection con=prepareConnection();
    PreparedStatement ps=con.prepareStatement(stmnt);
    ps.setString(1,uname);

    File fl=new File("photo1");
    FileInputStream fis=new FileInputStream(fl);
    ps.setBinaryStream(2,fis,(int)fl.length());

    File fl1=new File("music1");
    FileInputStream fis1=new FileInputStream(fl1);
    ps.setBinaryStream(3,fis1,(int)fl1.length());

    File fl2=new File("video1");
    FileInputStream fis2=new FileInputStream(fl2);
    ps.setBinaryStream(4,fis2,(int)fl2.length());

    File fl3=new File("shrs");
    FileInputStream fis3=new FileInputStream(fl3);
    ps.setBinaryStream(12,fis3,(int)fl3.length());

    File fl4=new File("updt");
    FileInputStream fis4=new FileInputStream(fl4);
    ps.setBinaryStream(15,fis4,(int)fl4.length());

    File fl5=new File(notes1);
    FileReader fr=new FileReader(fl5);
    ps.setCharacterStream(5,(int)fl5.length());

    File fl6=new File("messages1");
    FileReader fr1=new FileReader(fl6);
    ps.setCharacterStream(6,(int)fl6.length());

    ps.setString(7,"link");

    ps.setString(8,"frd");

    File fl7=new File("cmt");
    FileReader fr2=new FileReader(fl7);
    ps.setCharacterStream(9,(int)fl7.length());

    ps.setString(10,"lik");

    ps.setString(11,"ulik");

    File fl8=new File("qst");
    FileReader fr3=new FileReader(fl8);
    ps.setCharacterStream(13,(int)fl8.length());

    File fl9=new File("answ");
    FileReader fr4=new FileReader(fl9);
    ps.setCharacterStream(14,(int)fl9.length());

    ps.setString(16,"thms");

    File fl0=new File("wrd");
    FileReader fr5=new FileReader(fl0);
    ps.setCharacterStream(17,(int)fl0.length());

    ps.setString(18,"langs");

    ps.setString(19,"rlgn");

    ps.setString(20,"prvc");

    ps.setString(21,"hbc");

    ps.setString(22,"fvt");

    ps.setString(23,"qlf");

    ps.setString(24,"comm");

    ps.setString(25,"grp");

    ps.setString(26,"pgs");

    File fls=new File("ntfcn");
    FileReader fr=new FileReader(fls);
    ps.setCharacterStream(27,(int)fls.length());

    ps.setString(28,"rqst");

    File fls1=new File("tps");
    FileReader fr7=new FileReader(fls1);
    ps.setCharacterStream(29,(int)fls1.length());

    ps.setString(30,"cty");

    ps.setString(31,"tg");

    int i=executeUpdate();

    System.out.println("<<<<<<<Record Inserted Successfully>>>>>>> Count :"+i);

    con.close();
}
public static void main(String args[])throws Exception
{
    String uname="james";
    Blob photo1=img1.jpeg;
    Blob video1="Wildlife.wma";
    Blob music1="Lelepadi.mp3";
    Clob notes1="CreateTable.java";
    Clob messages1="CreateTable.java";
    String link="aaaaa";
    String frd="bbbb";
    Clob cmt="CreateTable.java";
    String lik="asadssfds";
    String ulik="zxzxxzcx";
    Blob shrs="img1.jpeg";
    Clob qst="CreateTable.java";
    Clob answ="CreateTable.java";
    Blob updt="img1.jpeg";
    String thms="bgfvdft";
    Clob wrd="CreateTable.java";
    String langs="erdgdfgf";
    String rlgn="bngfhgfh";
    String prvc="zxcsdw";
    String hbs="bgnbvc";
    String fvt="tgfhfghjfgh";
    String qlf="mklkopi";
    String comm="mbnfchgeshgw";
    String grp="bgyeadb";
    String pgs="hfhfj";
    Clob ntfcn="CreateTable.java";
    String rqst="ghfhgfh";
    Clob tps="CreateTable.java";
    String cty="jjkhgjghjk";
    String tg="qwewr";
    InsTable(uname,photo1,video1,music1,notes1,messages1,link,frd,cmt,lik,ulik,shrs,qst,answ,updt,thms,wrd,langs,rlgn,prvc,hbs,fvt,qlf,comm,grp,pgs,ntfcn,rqst,tps,cty,tg);
}
} 
```

上面的代码产生以下错误

```
 C:\Users\James P J\Documents\javaprog\skypark\InsertusrProf.java:45: error: no suitable   constructor found for File(Clob)
    File fl5=new File(notes1);
             ^
constructor File.File(URI) is not applicable
  (actual argument Clob cannot be converted to URI by method invocation conversion)
constructor File.File(File,String) is not applicable
  (actual and formal argument lists differ in length)
constructor File.File(String,String) is not applicable
  (actual and formal argument lists differ in length)
constructor File.File(String) is not applicable
  (actual argument Clob cannot be converted to String by method invocation conversion)
constructor File.File(String,File) is not applicable
  (actual and formal argument lists differ in length)
constructor File.File(String,int) is not applicable
  (actual and formal argument lists differ in length)
   C:\Users\James P J\Documents\javaprog\skypark\InsertusrProf.java:47: error: no suitable method found for setCharacterStream(int,int)
    ps.setCharacterStream(5,(int)fl5.length());
      ^
method PreparedStatement.setCharacterStream(int,Reader) is not applicable
  (actual argument int cannot be converted to Reader by method invocation conversion)
method PreparedStatement.setCharacterStream(int,Reader,long) is not applicable
  (actual and formal argument lists differ in length)
method PreparedStatement.setCharacterStream(int,Reader,int) is not applicable
  (actual and formal argument lists differ in length)
 C:\Users\James P J\Documents\javaprog\skypark\InsertusrProf.java:51: error: no suitable method found for setCharacterStream(int,int)
    ps.setCharacterStream(6,(int)fl6.length());
      ^
method PreparedStatement.setCharacterStream(int,Reader) is not applicable
  (actual argument int cannot be converted to Reader by method invocation conversion)
method PreparedStatement.setCharacterStream(int,Reader,long) is not applicable
  (actual and formal argument lists differ in length)
method PreparedStatement.setCharacterStream(int,Reader,int) is not applicable
  (actual and formal argument lists differ in length)
  C:\Users\James P J\Documents\javaprog\skypark\InsertusrProf.java:59: error: no suitable method found for setCharacterStream(int,int)
    ps.setCharacterStream(9,(int)fl7.length());
      ^
method PreparedStatement.setCharacterStream(int,Reader) is not applicable
  (actual argument int cannot be converted to Reader by method invocation conversion)
method PreparedStatement.setCharacterStream(int,Reader,long) is not applicable
  (actual and formal argument lists differ in length)
method PreparedStatement.setCharacterStream(int,Reader,int) is not applicable
  (actual and formal argument lists differ in length)
    C:\Users\James P J\Documents\javaprog\skypark\InsertusrProf.java:67: error: no suitable method found for setCharacterStream(int,int)
    ps.setCharacterStream(13,(int)fl8.length());
      ^
method PreparedStatement.setCharacterStream(int,Reader) is not applicable
  (actual argument int cannot be converted to Reader by method invocation conversion)
method PreparedStatement.setCharacterStream(int,Reader,long) is not applicable
  (actual and formal argument lists differ in length)
method PreparedStatement.setCharacterStream(int,Reader,int) is not applicable
  (actual and formal argument lists differ in length)
    C:\Users\James P J\Documents\javaprog\skypark\InsertusrProf.java:71: error: no suitable method found for setCharacterStream(int,int)
    ps.setCharacterStream(14,(int)fl9.length());
      ^
method PreparedStatement.setCharacterStream(int,Reader) is not applicable
  (actual argument int cannot be converted to Reader by method invocation conversion)
method PreparedStatement.setCharacterStream(int,Reader,long) is not applicable
  (actual and formal argument lists differ in length)
method PreparedStatement.setCharacterStream(int,Reader,int) is not applicable
  (actual and formal argument lists differ in length)
   C:\Users\James P J\Documents\javaprog\skypark\InsertusrProf.java:77: error: no suitable method found for setCharacterStream(int,int)
    ps.setCharacterStream(17,(int)fl0.length());
      ^
method PreparedStatement.setCharacterStream(int,Reader) is not applicable
  (actual argument int cannot be converted to Reader by method invocation conversion)
method PreparedStatement.setCharacterStream(int,Reader,long) is not applicable
  (actual and formal argument lists differ in length)
method PreparedStatement.setCharacterStream(int,Reader,int) is not applicable
  (actual and formal argument lists differ in length)
  C:\Users\James P J\Documents\javaprog\skypark\InsertusrProf.java:98: error: variable fr is already defined in method InsTable(String,Blob,Blob,Blob,Clob,Clob,String,String,Clob,String,String,Blob,Clob,Clob,Blob,String,Clob,String,String,String,String,String,String,String,String,String,Clob,String,Clob,String,String)
    FileReader fr=new FileReader(fls);
               ^
   C:\Users\James P J\Documents\javaprog\skypark\InsertusrProf.java:99: error: no suitable method found for setCharacterStream(int,int)
    ps.setCharacterStream(27,(int)fls.length());
      ^
method PreparedStatement.setCharacterStream(int,Reader) is not applicable
  (actual argument int cannot be converted to Reader by method invocation conversion)
method PreparedStatement.setCharacterStream(int,Reader,long) is not applicable
  (actual and formal argument lists differ in length)
method PreparedStatement.setCharacterStream(int,Reader,int) is not applicable
  (actual and formal argument lists differ in length)
     C:\Users\James P J\Documents\javaprog\skypark\InsertusrProf.java:105: error: no suitable method found for setCharacterStream(int,int)
    ps.setCharacterStream(29,(int)fls1.length());
      ^
method PreparedStatement.setCharacterStream(int,Reader) is not applicable
  (actual argument int cannot be converted to Reader by method invocation conversion)
method PreparedStatement.setCharacterStream(int,Reader,long) is not applicable
  (actual and formal argument lists differ in length)
method PreparedStatement.setCharacterStream(int,Reader,int) is not applicable
  (actual and formal argument lists differ in length)
          C:\Users\James P J\Documents\javaprog\skypark\InsertusrProf.java:111: error: cannot find symbol
    int i=executeUpdate();
          ^
    symbol:   method executeUpdate()
      location: class InsertusrProf
       C:\Users\James P J\Documents\javaprog\skypark\InsertusrProf.java:120: error: cannot find symbol
    Blob photo1=img1.jpeg;
                ^
     symbol:   variable img1
         location: class InsertusrProf
         C:\Users\James P J\Documents\javaprog\skypark\InsertusrProf.java:121: error: incompatible types
    Blob video1="Wildlife.wma";
                ^
      required: Blob
        found:    String
       C:\Users\James P J\Documents\javaprog\skypark\InsertusrProf.java:122: error: incompatible types
    Blob music1="Lelepadi.mp3";
                ^
    required: Blob
     found:    String
      C:\Users\James P J\Documents\javaprog\skypark\InsertusrProf.java:123: error: incompatible types
    Clob notes1="CreateTable.java";
                ^
     required: Clob
     found:    String
  C:\Users\James P J\Documents\javaprog\skypark\InsertusrProf.java:124: error: incompatible types
    Clob messages1="CreateTable.java";
                   ^
       required: Clob
    found:    String
     C:\Users\James P J\Documents\javaprog\skypark\InsertusrProf.java:127: error: incompatible types
    Clob cmt="CreateTable.java";
             ^
    required: Clob
    found:    String
      C:\Users\James P J\Documents\javaprog\skypark\InsertusrProf.java:130: error: incompatible types
    Blob shrs="img1.jpeg";
              ^
        required: Blob
   found:    String
      C:\Users\James P J\Documents\javaprog\skypark\InsertusrProf.java:131: error: incompatible types
    Clob qst="CreateTable.java";
             ^
        required: Clob
        found:    String
       C:\Users\James P J\Documents\javaprog\skypark\InsertusrProf.java:132: error: incompatible types
    Clob answ="CreateTable.java";
              ^
      required: Clob
    found:    String
      C:\Users\James P J\Documents\javaprog\skypark\InsertusrProf.java:133: error: incompatible types
    Blob updt="img1.jpeg";
              ^
    required: Blob
       found:    String
   C:\Users\James P J\Documents\javaprog\skypark\InsertusrProf.java:135: error: incompatible types
    Clob wrd="CreateTable.java";
             ^
     required: Clob
    found:    String
     C:\Users\James P J\Documents\javaprog\skypark\InsertusrProf.java:145: error: incompatible types
    Clob ntfcn="CreateTable.java";
               ^
       required: Clob
      found:    String
     C:\Users\James P J\Documents\javaprog\skypark\InsertusrProf.java:147: error:  incompatible types
    Clob tps="CreateTable.java";
             ^
   required: Clob
    found:    String
24 errors

  Tool completed with exit code 1 
```

我需要在 InsTable 方法中使用参数插入信息

我尝试使用不带引号的参数，例如

```
 File fl=new File(photo1);
       FileInputStream fis=new FileInputStream(fl);
    ps.setBinaryStream(2,fis,(int)fl.length()); 
```

但很无奈

我在网上搜索了这个问题的解决方案，我发现网站中提供了类似类型的代码：

```
 http://www.java2s.com/Tutorial/Java/0340__Database/BlobandClobdatatype.htm 
```

如果有人知道解决这个问题。那么请帮助我

提前致谢....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T20:54:34.237

您的参数“notes1”是一个`Clob`. 我不知道您为什么要尝试使用对象创建`File`对象`Clob`。“notes1”是文件名吗？那么它应该被声明为 a `String`，而不是 a `Clob`。它是否意味着`Clob`包含文件名？然后你需要从 Clob 的字符流中读取文件名，即 `BufferedReader r = new BufferedReader(notes1.getCharacterStream());`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-12T00:39:39.797

我数了30“？” 您的答案中的 JDBC 查询字符串中的字符。但是，您只能绑定其中的 24 个。即使某些值是`null`，您仍然需要绑定它们。

如果您打算将它们`null`放在数据库中，则将`null`值绑定到：

```
// Could be Types.CLOB, Types.INTEGER, or something else
ps.setNull(25, Types.VARCHAR); 
```

# java - 消息为空时如何隐藏jface.dialogs.TitleAreaDialog消息光标

> ID：13592296
> 
> 赞同：0
> 
> 时间：2012-11-27T20:15:30.673
> 
> 标签：java, eclipse, eclipse-plugin, jface

我使用jface.dialogs.TitleAreaDialog，在消息区，我一般设置为空 setMessage("", IMessageProvider.NONE); 并且只有在发生错误时才会分配消息，例如 setMessage(DialogMessages.MSG_ERROR, IMessageProvider.INFORMATION);

我的问题是，每当消息设置为“”时，用户在使用 TAB 按钮移动鼠标光标时可以在 UI 上看到鼠标光标，也可以直接单击空白文本字段，但不是能够在那里输入任何内容。

我根本不想显示鼠标光标，谁能告诉我如何修改它？多谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T08:37:10.690

我认为没有任何简单的方法可以实现这一目标。TitleAreaDialog 不允许您访问或更改标题中的该消息控件具有足够的灵活性。

但是，如果您非常讨厌这个，您可以访问消息控件的父级，`Composite#setTabList(Control[])`并使用不包含此`Text`控件的子级列表来执行操作。您可以通过覆盖来获取消息控件的父级，`createContents`并且返回的控件是该消息文本的父级。那将停止对其进行标记。

但是如果有人点击它，你就有问题了。要解决这个问题，请看[这里](http://www.eclipse.org/forums/index.php/m/371289/)。这将为您提供摆脱该问题的良好提示。

# mysql - C Realloc 附加字符串 MySQL 连接器

> ID：13592300
> 
> 赞同：2
> 
> 时间：2012-11-27T20:15:47.253
> 
> 标签：mysql, c, memcpy, realloc, strcat

我试图遍历每个数据库结果，并在最后一个字符串中用逗号分隔每行的单个字段。我知道这可以单独在 MySQL 中完成，但是我需要在每个结果上运行函数，这样使用 mysql only 方法是不可能的。

每隔几次运行，我就会得到一个段错误，不需要的字符被添加到输出中，例如 Linux 内部的“^H^G”或十六进制代码（08 和 07）。它编译正确，我只希望我能得到一致的结果。此代码在线程内，但所有变量都是当前线程的本地变量。

最终字符串应该是用户字符串字符。

这是我尝试使用的最新代码。

```
MYSQL dbh;
MYSQL *dbh_p;
MYSQL_RES *res;
MYSQL_ROW row;
char *userstring = NULL;
char *userstring_r;
size_t userstringsize = 0;
size_t rowsize = 0;

/* Database Connect Code Here [Connects Successfully] */

if(mysql_query(dbh_p,query) == 0) {
    res = mysql_store_result(dbh_p);
    if(mysql_num_rows(res) > 0) {
        while((row = mysql_fetch_row(res))) {
            rowsize = strlen(row[0]) * sizeof(char);
            userstringsize += rowsize + 1;
            userstring_r = (char *) realloc(userstring,userstringsize + 1);

            printf("%d %d %p\n", rowsize, userstringsize, userstring_r);
            if(userstring_r != NULL) {
                /* Where the Issue Is */
                userstring = userstring_r;
                strcat(userstring,row[0]);
                strcat(userstring,",");
            }else{
                free(userstring);
                printf("Error With Realloc\n");
                mysql_thread_end();
                pthread_exit(NULL);
            }
        }
    }
    mysql_free_result(res);
}else{
    printf("Query Error: %s\n",mysql_error(&dbh));
} 
```

-- 编辑 -- 输出：

```
9 10 0x7fe5f4014d90
14 25 0x7fe5f4014d90
9 35 0x7fe5f4014d90
11 47 0x7fe5f4014d90
... (same format and pointer value);
*** glibc detected *** ./pthread: realloc(): invalid next size: 0x00007fe5f4014d90 *** 
```

即使我将线程限制为 1，这也是结果。

感谢您的任何帮助或可能的问题。我不需要完整的代码，只需要提示/提示和可能的修复。我尝试过 strncat、memcpy 和更改各种大小，但没有任何运气。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T21:23:21.523

好的，我想我知道出了什么问题：

第一次`userstring`分配，它没有初始化为空字符串！基本上`strcat`一直将新数据放在它找到第一个`\0`字节的任何地方，这可能是任何地方。

您需要以某种方式检查它是否是第一次，并对其进行初始化。就像是：

```
if (userstringsize == 0)  // First time
{
    userstringsize += rowsize + 1;
    userstring_r = (char *) malloc(userstringsize + 1);
    strcpy(userstring_r, "");  // Initialise to empty string
}
else
{
    userstringsize += rowsize + 1;
    userstring_r = (char *) realloc(userstring,userstringsize + 1);
} 
```

# java - EasyMock——测试类中的模拟方法？

> ID：13592302
> 
> 赞同：6
> 
> 时间：2012-11-27T20:15:53.047
> 
> 标签：java, junit, easymock

在我的代码中，我有时会在同一个类中调用公共或私有方法。这些方法不适合被拉到自己的类中。我调用的这些方法中的每一个都在它们自己的单元测试中进行了测试。

那么，如果我的类 A 中有一个方法调用类 A 中的每个方法，是否有某种方法可以模拟调用？我当然可以剪切和粘贴我的期望/模拟行为，但这不仅乏味，而且混淆了测试的重点，违反了模块化，并且由于无法控制返回的内容而使测试更加困难。

如果没有，这种事情的通常解决方案是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T20:57:43.467

听起来您正在寻找部分模拟......这是一篇涵盖它们的博客文章： [http ://www.jroller.com/alessiopace/entry/partial_mocks_with_easymock](http://www.jroller.com/alessiopace/entry/partial_mocks_with_easymock)

这需要 EasyMock ClassExtension，但遗憾的是它不能模拟私有方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T22:28:15.110

This can be done with EasyMock 2.2 class extension, or EasyMock 3.0 and on (which includes class extension.)

Partial mocking is documented here:

[http://www.easymock.org/EasyMock2_2_2_ClassExtension_Documentation.html](http://www.easymock.org/EasyMock2_2_2_ClassExtension_Documentation.html)

The syntax is fairly simple. You specify the class you're mocking and which methods you're mocking. In this example, imagine that the class is "Dog" and it has two methods, "eat" and "eatUntilFull". You might put this code in the eatUntilFull test:

```
mockDog = createMockBuilder(Dog.class).addMockedMethod("eat").createMock(); 
```

You can then treat that like any other mock.

Caveats:

1) Calling one method within your class from another might be an indication of poor design -- can you abstract out that logic to another class?

2) Even if you can't, there may be no problem in letting your method call another method itself during the test. This may be the preferred behavior.

3) You still can't target private methods, so you may want to set them as package-private instead of private.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T20:49:39.520

一般来说，如果您需要模拟私有方法（或您正在测试的同一类上的公共方法），您应该考虑将该方法中的代码移至另一个类。

从测试的角度来看，您正在测试的方法*如何*归档预期状态（无论它是否调用其他方法）应该是无关紧要的。重要的兴趣点应该是方法执行的状态变化，而不是它调用的方法。

# ruby-on-rails - 使用 Washout gem 的格式错误的 XML 响应

> ID：13592307
> 
> 赞同：1
> 
> 时间：2012-11-27T20:16:15.543
> 
> 标签：ruby-on-rails, soap, qbwc

我正在使用[Washout Gem](https://github.com/roundlake/wash_out)从 Rails 3.2.8 连接到 Quickbooks Web 连接器。我需要将返回格式设置为“ `<tns:AuthenticateResult>`”，但我一直找不到方法。相反，我得到“ `<AuthenticateResult xsi:type="tns:AuthenticateResult">`”。我试过同时改变蛇形和驼峰值。任何帮助将不胜感激。

* * *

## 我需要的

```
<?xml version="1.0" encoding="UTF-8"?>
<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns1="http://developer.intuit.com/">
    <SOAP-ENV:Body>
        <ns1:authenticateResponse>
            <ns1:authenticateResult>
                <ns1:string>15c9ce293bd3f41b761c21635b14fa06</ns1:string>
                <ns1:string></ns1:string>
            </ns1:authenticateResult>
        </ns1:authenticateResponse>
    </SOAP-ENV:Body> 
```

## 我得到了什么

```
<?xml version="1.0" encoding="UTF-8"?>
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:tns="http://developer.intuit.com/">
  <soap:Body>
    <tns:authenticateResponse>
      <AuthenticateResult xsi:type="tns:AuthenticateResult">
        <String xsi:type="xsd:string">abf36037372fa6cf089dbdbc33b11771908afe57</String>
        <String xsi:type="xsd:string"></String>
      </AuthenticateResult>
    </tns:authenticateResponse>
  </soap:Body> 
```

## 我的代码

```
soap_action "authenticate",
              :args => {:strUserName => :string, :strPassword => :string},
              :return => { :authenticate_result => [{string: [:string]}]}
  def authenticate
    username = params[:strUserName]
    password = params[:strPassword]
    if (Role.find_by_token(username))
      if QuickbooksImportStatus.find_by_token(username).blank?
        QuickbooksImportStatus.create(:username => User.find(Role.find_by_token(username).user_id).username)
      end
      render :soap => {:authenticate_result => [{string: [username, '']}]}
    end
  end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-11T08:03:35.010

我们增加了实现这一点的能力。关注[https://github.com/roundlake/wash_out/issues/73上的讨论](https://github.com/roundlake/wash_out/issues/73)

# static-analysis - 是否有像 ASM for Java Bytecode 这样的 CIL 静态分析库？

> ID：13592308
> 
> 赞同：6
> 
> 时间：2012-11-27T20:16:19.417
> 
> 标签：static-analysis, cil, java-bytecode-asm, cci

我正在寻找一个用于对 CIL 代码进行自定义静态代码分析的**库。**[阅读：我对已经像这里](http://en.wikipedia.org/wiki/List_of_tools_for_static_code_analysis#.NET)显示的那样进行静态分析的工具不感兴趣。

对于使用 Java 字节码的自定义分析，我使用了 ASM，我喜欢它提供的功能和良好的文档。快速谷歌搜索“CIL 静态分析库”并没有产生任何似乎提供 ASM 功能的东西。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-28T09:07:20.090

[Mono.Cecil](http://www.mono-project.com/Cecil)是可用的 CIL 分析的最佳库。它是免费的、开源的、完整的、轻量级的、健壮的和快速的。除了读CIL，它还可以写CIL。它还支持 PDB 文件。

许多静态分析工具多年来一直依赖 Cecil。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T07:08:35.823

我发现最接近的是 Microsoft 的[FxCop](http://msdn.microsoft.com/en-us/library/bb429476(v=vs.80).aspx)实用程序。[（此处](http://archive.msdn.microsoft.com/codeanalysis/Release/ProjectReleases.aspx?ReleaseId=553)的独立下载链接，1.36 似乎已经消失，但有人[在另一个 SO 问题上将其重新上传到他们的 Dropbox](https://stackoverflow.com/a/3114939/1122135)）

它肯定与 C/C++ 静态分析工具相去甚远，但话又说回来，C# 是一种托管语言，其中静态分析工具检查的许多常见错误是不可能的。

此外，[维基百科上有一个 .NET 静态分析工具的简短列表](http://en.wikipedia.org/wiki/List_of_tools_for_static_code_analysis#.NET)，可能值得一看。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T20:17:43.470

看看反射器：www.reflector.net/

# python - 在 gstreamer 中获取视频的高度和宽度？

> ID：13592315
> 
> 赞同：2
> 
> 时间：2012-11-27T20:16:48.043
> 
> 标签：python, linux, gstreamer

我正在为使用 gstreamer 的 linux 开发 wx Python 媒体 ctrl（感觉 wx 小部件版本必须是自定义编译的）......而且我发现 gstreamer 要么很糟糕，要么没有很好的文档，因为它是最令人困惑的事情。这是我当前的代码，我认为我要做的是获取 MESSAGE_TAG 类型的消息并从那里做一些事情，但我现在还不确定，当我当前运行它时，我得到一个错误。

代码

```
'''
Adapts GStreamer to fit wx.media.MediaCtrl
Why?
    - Yes wx.media.MediaCtrl has a gstreamer backend
      but it is useless and well doesn't even work 
      because apparently the wx widgets C++ code
      needs to be compiled with gstreamer support
      now why they don't do that for the linux
      build that will be running on Linux with 
      a likely hood of using gstreamer I have no
      clue why but they don't.

Largely Ported from wxWidgets old code.
'''
import os

import wx
from wx.lib.newevent import NewCommandEvent
import gst
import gobject

from twisted.python import log

# Start threads otherwise watching messages from other threads gives us a segfault
gobject.threads_init()

# States
# might not be the numbers wx.media.MediaCtrl uses
MEDIASTATE_PLAYING = 0
MEDIASTATE_PAUSED =  1 
MEDIASTATE_STOPPED = 2

# Events
media_loaded_event  , EVT_MEDIA_LOADED   = NewCommandEvent()
media_play_event    , EVT_MEDIA_PLAY     = NewCommandEvent()
media_pause_event   , EVT_MEDIA_PAUSE    = NewCommandEvent()
media_stop_event    , EVT_MEDIA_STOP     = NewCommandEvent()
media_finished_event, EVT_MEDIA_FINISHED = NewCommandEvent()

class GstreamerCtrl(wx.Panel):

    def __init__(self, parent, id):
        wx.Panel.__init__(self, parent, id, size = (0,0))
        loop = gobject.MainLoop()
        self.context = loop.get_context()

        # use GetState to get new state
        self.state = gst.STATE_NULL # current state 

        self.no_resource = True

        self.video_size = (0,0)

        self.caps = []

        self.paused_playback_position = 0

        wx.CallLater(500, self.gstreamer_loop)

        self.playbin = gst.element_factory_make("playbin2")

        # Code from http://www.majorsilence.com/pygtk_audio_and_video_playback_gstreamer
        bus = self.playbin.get_bus()
        bus.add_signal_watch()
        bus.enable_sync_message_emission()
        bus.connect("message", self.on_message)
        bus.connect('sync-message::element', self.on_sync_message)

        self.Bind(wx.EVT_WINDOW_DESTROY, self.OnWinDestroy, self)

    def on_sync_message(self, bus, message):
        # Code from http://pythonide.blogspot.com/2008/03/howto-write-wxpython-video-player-with.html
        # See  also http://pygstdocs.berlios.de/pygst-tutorial/videomixer.html
        print "===================="
        if message.structure is None:
            return
        message_name = message.structure.get_name()
        print message_name
        if message_name  == 'prepare-xwindow-id':
            imagesink = message.src
            imagesink.set_property('force-aspect-ratio', True)
            imagesink.set_xwindow_id(self.GetHandle())

    def SetInitialSize(self):
        pass# for cross compartibilitry with others but gstreamer does it automatically

    def on_message(self, bus, message):
        if message.type == gst.MESSAGE_STATE_CHANGED:
            # http://pygstdocs.berlios.de/pygst-reference/class-gstmessage.htm
            state = message.parse_state_changed()#current state [oldstate, newstate, pendingstate]
            self.state = state[1]# update the state (we don't have to do this if it is a repeat because it was set the first time around)
            if self.state == gst.STATE_READY:# if this is the first load state (sense it isn't a repeat and it is a STATE_READY)
                print "Firing EVT_MEDIA_LOADED"
                self._send_event(media_loaded_event)

        # get gstreamer information
        elif message.type == gst.MESSAGE_TAG:
            self.caps.append(message)
            # is this where we get the size; why is it so unclear  

        # Detect end of stream and set state to to NULL
        # Code From http://www.majorsilence.com/pygtk_audio_and_video_playback_gstreamer
        elif message.type == gst.MESSAGE_EOS:
            log.msg("Gstreaner [Debug]: EOS")
            # end of file so stop and say at the end
            self.Stop()
            # at end of file
            self._send_event(media_finished_event)

        elif message.type == gst.MESSAGE_ERROR:
            (err, debug) = message.parse_error()
            print "Gstreamer [ERROR]: %s" % err
            print "Gstreamer [Debug]: %s" % debug
            # Some unknown error have to set to null not anything else cause could be error with path name
            self.playbin.set_state(gst.STATE_NULL)
            self._send_event(media_stop_event)
            self._send_event(media_finished_event)

    def gstreamer_loop(self):
        self.context.iteration(True)
        wx.CallLater(500, self.gstreamer_loop)

    def _send_event(self, event):
        print "Firing an event"
        evt = event(self.GetId())
        wx.PostEvent(self, evt)

    def Load(self, file_path):
        self.no_resource = False
        self.paused_playback_position = 0
        file_path = os.path.abspath(file_path)
        print "Loading File " + file_path
        print "Loading through URI file://"
        self.LoadURI("file://" + file_path )
        return True

    def LoadURI(self, uri):
        self.no_resource = False
        log.msg("URI: %s" % uri)
        self.paused_playback_position = 0
        self.playbin.set_state(gst.STATE_NULL) 
        self.playbin.set_property("uri", uri)
        print self.state
        # Start download
        self.playbin.set_state(gst.STATE_PLAYING)
        self.playbin.set_state(gst.STATE_PAUSED)
        return True

    def Play(self):
        if self.no_resource:
            return False # see stop() for why false here but true for stop
        self.playbin.set_state(gst.STATE_PLAYING)
        print "Firing EVT_MEDIA_PLAY"
        self._send_event(media_play_event)
        return True

    def Pause(self):
        if self.no_resource:
            return False # see stop() for why false here but true for stop
        self.paused_playback_position = self.Tell() 
        self.playbin.set_state(gst.STATE_PAUSED)        
        print "Firing EVT_MEDIA_PAUSE"
        self._send_event(media_pause_event)
        return True

    def Stop(self):
        # it seeems that to stop on gstreamer you set the state to paused
        # and then set the stream position to 0
        # why not just have STOPPED state or have NULL be stopped
        # What is used in wxWidgets code now set
        if self.no_resource:
            # confirms stop was good because we are "stopped" play pause however say they failed because not "playing" or "paused"
            print "Firing EVT_MEDIA_STOPPED"
            self._send_event(media_stop_event)
            return True
        self.paused_playback_position = 0
        self.Seek(0)
        self.playbin.set_state(gst.STATE_PAUSED)
        print "Firing EVT_MEDIA_STOPPED"
        self._send_event(media_stop_event)
        return True

    def GetState(self):
        # Stop  - 0
        # Pause - 1
        # Play  - 2    
        state = self.state
        # see http://gstreamer.freedesktop.org/data/doc/gstreamer/head/gstreamer/html/GstElement.html#gst-element-get-state
        if state == gst.STATE_PAUSED:
            if self.paused_playback_position == 0:
                return MEDIASTATE_STOPPED
            else:
                return MEDIASTATE_PAUSED
        elif state == gst.STATE_PLAYING:
            return MEDIASTATE_PLAYING
        else:# Other states (NULL, READY, etc)
            return MEDIASTATE_STOPPED

    def SetVolume(self, volume):
        # wx media media ctrl takes a value between 0.0 and 1.0
        # gstreamer takes a value between 0 and 10
        # maybe not volume seems funny
        # try setting it to * 10 again still weird setting it back
        self.playbin.set_property("volume", volume)

    def Tell(self):
        if self.state != gst.STATE_PLAYING:
            # Any other state other than playing return the paused time otherwise something strange could be returned
            return self.paused_playback_position
        time_format = gst.Format(gst.FORMAT_TIME) #time in nanoseconds
        try:
            data = self.playbin.query_position(time_format)
        except gst.QueryError:
            return -1
        position = int(data[0] / 1000000.0)
        return position

    def Length(self):
        time_format = gst.Format(gst.FORMAT_TIME) #time in nanoseconds
        try:
            data = self.playbin.query_duration(time_format)
        except gst.QueryError:
            return -1
        length = int(data[0] / 1000000.0)
        return length

    def Seek(self, position):
        if self.no_resource:
            return False
        print "Seeking to %s" % position
        if position < 0 or position > self.Length():
            return
        self.paused_playback_position = position
        position_ns = position * 1000000
        self.playbin.seek_simple(gst.FORMAT_TIME, gst.SEEK_FLAG_FLUSH, position_ns)
        return True

    def OnWinDestroy(self, event):
        self.playbin.set_state(gst.STATE_NULL)

if __name__ == "__main__":
    a = wx.App(False)
    f = wx.Frame(None, -1, size = (500,300))

    PlayerSizer = wx.BoxSizer(wx.VERTICAL)
    PlayerSizer.Add(self.player, flag = wx.LEFT | wx.RIGHT | wx.BOTTOM | wx.EXPAND, border = 10, proportion = 1)
    f.d = GstreamerCtrl(f, -1)
    f.Show()
    wx.CallLater(10000, f.d.LoadURI,  "http://www.tools4movies.com/dvd_catalyst_profile_samples/Harold%20Kumar%203%20Christmas%20bionic.mp4")
    a.MainLoop() 
```

当前误差

> 程序“Test.py”收到 X Window 系统错误。这可能反映了程序中的错误。错误是“BadValue（整数参数超出操作范围）”。（详情：serial 62 error_code 2 request_code 133 minor_code 19） （程序员注意：通常X错误是异步报告的，也就是说，你会在导致错误后一段时间收到错误。要调试你的程序，请使用--同步命令行选项来改变这种行为。如果你在 gdk_x_error() 函数上中断，你可以从你的调试器中得到一个有意义的回溯。）

# uitableview - 如何将 Xcode 故事板表格单元格链接到其他故事板？

> ID：13592317
> 
> 赞同：0
> 
> 时间：2012-11-27T20:17:04.210
> 
> 标签：uitableview, uistoryboard, uistoryboardsegue

我遇到了一个问题，我在一个故事板中有大约 200 个“场景/控制器。这会导致大量延迟并占用我在 Xcode 中的内存。所以我的想法是，因为所有这些都链接到一个 UITableView。为什么不能将场景/控制器拆分为单独的故事板并相应地链接它们。

现在的问题是我在情节提要模式下创建了静态单元格。所以这个 UITable 里面有 30 行。

如何调用 30 行中的每一行，并让它们链接到单独的故事板？？？我最初的想法是给每个单元格一个重用标识符。但即便如此，我也不知所措。

请问有人可以帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T16:34:31.533

我想到了。万一其他人遇到这个问题，这里的解决方案..

确保在您的主控制器上添加所有 .h 文件对我来说，它们将是

```
#import "tabbar26.h" 
```

现在这是我添加的使它工作的代码

```
- (UITableViewCell *)tableView:(UITableView *)tableView
     cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
UITableViewCell *cell = [super tableView:tableView
                   cellForRowAtIndexPath:indexPath];
cell.accessoryType = UITableViewCellAccessoryNone;

NSUInteger row = [indexPath row];

            if (row == 1)
        {
            NSLog(@"hi");

        }

        if (row == 27)
        {
        }
 }

return cell;
} 
```

上面这部分，真的不需要。我只是用它来记录。

下面是你真正需要的:)

```
 -(void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath      {

NSUInteger row = [indexPath row];

if (row == 0)
{
    NSLog(@"hi2");
    }

if (row == 25)
{
    NSLog(@"bye2");
    UIStoryboard *tabbar26 = [UIStoryboard storyboardWithName:@"tabbar26" bundle:nil];
       UIViewController *Tab1_ViewController = [tabbar26 instantiateInitialViewController];
     [self.navigationController pushViewController:Tab1_ViewController animated:(YES)];
}

[self.tableView reloadData];
} 
```

# sql - GROUP BY，进一步排序结果

> ID：13592322
> 
> 赞同：0
> 
> 时间：2012-11-27T20:17:19.553
> 
> 标签：sql, group-by

好的，所以我有一个按功能分组，按 Y 分组。

分组可能有 5 个不同的值：A、B、C、D、E。然后我将如何将相同的值按另一个值分组，所以如果我有 2 个数据值返回为 A，怎么办我将它们进一步分组？

```
GROUP BY Y
GROUP BY X (WHERE column1=column1)? 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T20:25:45.990

您可以添加由分隔的多个列`,`

```
select a, b, c, avg(d)
from mytable
group by a, b, c; 
```

# java - 线程“主”java.io.FileNotFoundException 中的异常：错误

> ID：13592325
> 
> 赞同：9
> 
> 时间：2012-11-27T20:17:25.947
> 
> 标签：java, eclipse, file-io, exception-handling, java.util.scanner

我正在使用 Eclipse 来编译和运行我的 java 代码。

**这是我得到的错误。**

```
Exception in thread "main" java.io.FileNotFoundException: file.txt (The system cannot find the file specified)
    at java.io.FileInputStream.open(Native Method)
    at java.io.FileInputStream.<init>(Unknown Source)
    at java.util.Scanner.<init>(Unknown Source)
    at helloworld.main(helloworld.java:9) 
```

**这是我的代码**

```
import java.io.File;
import java.io.IOException;
import java.util.Scanner;

public class helloworld {

    public static void main(String[] args) throws IOException {
        Scanner KB = new Scanner(new File("file.txt"));
        while (KB.hasNext()) {
            String line = KB.nextLine();
            System.out.println(line);
        }

    }
} 
```

**File.txt**
我在项目的同一文件夹中创建了 file.txt。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-11-27T20:20:08.877

您的文件应该直接在项目文件夹下，而不是在任何其他子文件夹中。

所以，如果你的项目文件夹是`MyProject`，它的文件夹结构（虽然不完整）应该是这样的： -

```
MyProject +- src +
          |      |
          |      +-- Your source file
          +- file.txt 
```

它不应该是`under src`文件夹。

* * *

或者，您可以提供以下相对于项目文件夹的路径以在以下位置搜索文件`src folder`：-

```
new File("src/file.txt"); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-27T20:20:39.900

尝试将完整路径传递给文件，例如：

```
new File("/usr/home/mogli/file.txt") 
```

或者，如果您在 Windows 中：

```
new File("C:/Users/mogli/docs/file.txt") 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-27T20:22:07.270

遵循@rohit Jains 方法或提供**文件的****绝对路径**，例如：

 **```
 Scanner KB = new Scanner(new File("C:/JsfProjects/Project/file1.txt"));
            while (KB.hasNext()) {
                String line = KB.nextLine();
                System.out.println(line);
            } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-04-02T04:45:14.370

在 Windows 中尝试给出这样的真实路径

```
"C:\\Users\\mogli\\docs\\file.txt" 
```

它对我有用。**

# .net - 让 WPF 应用程序看起来像 Metro 风格，即使在 Windows 7 中？（窗口 Chrome / 主题 / 主题）

> ID：13592326
> 
> 赞同：127
> 
> 时间：2012-11-27T20:17:28.213
> 
> 标签：.net, wpf, windows-7, windows-8, microsoft-metro

我喜欢新 Office 套件和 Visual Studio 上的窗口镶边：

![在此处输入图像描述](../Images/e47501950795f1c62fa90b6a7585ef16.png)

当然，我仍在为 Windows 7 开发应用程序，但我想知道是否有一种快速简便的方法（阅读：WPF 样式或 Windows 库）来模拟这种样式。我过去做过一些窗口镀铬样式，但是让它看起来和表现得恰到好处真的很棘手。

有谁知道是否有现有的模板或库可以为我的 WPF 应用程序添加“现代 UI”外观和感觉？

* * *

## 回答 #1

> 赞同：153
> 
> 时间：2013-03-20T09:51:30.763

我所做的是创建自己的窗口和样式。因为我喜欢控制一切，我不希望一些外部库只是为了使用它的 Window。我在 GitHub 上查看了已经提到[的 MahApps.Metro](https://github.com/MahApps/MahApps.Metro)

![MahApps](../Images/423106ca9d60fea574cd4df41f0a2b4a.png)

以及[GitHub 上非常漂亮的 Modern UI](https://github.com/firstfloorsoftware/mui)。（仅限 .NET4.5）

![现代用户界面](../Images/91ac7619389c28baf80f87143e5e7407.png)

还有一个是[极乐](http://elysium.codeplex.com/)世界，但我真的没有尝试过这个。

![极乐世界](../Images/63542f60dd9cb6075b14c81028544a60.png)

当我看到它是如何完成的时，我所做的风格真的很简单。现在我有了自己的 Window，我可以用 xaml 做任何我想做的事情……对我来说，这是我自己做的主要原因。**我也为你做了一个 :) 我可能应该说，如果不探索Modern UI**，我将无法做到这一点，这是很大的帮助。我试图让它看起来像 VS2012 Window。它看起来像这样。

![我的窗口](../Images/4244c7d7221c55a2483da48a9baacb69.png)

这是代码（请注意它的目标是 .NET4.5）

```
public class MyWindow : Window
{

    public MyWindow()
    {
        this.CommandBindings.Add(new CommandBinding(SystemCommands.CloseWindowCommand, this.OnCloseWindow));
        this.CommandBindings.Add(new CommandBinding(SystemCommands.MaximizeWindowCommand, this.OnMaximizeWindow, this.OnCanResizeWindow));
        this.CommandBindings.Add(new CommandBinding(SystemCommands.MinimizeWindowCommand, this.OnMinimizeWindow, this.OnCanMinimizeWindow));
        this.CommandBindings.Add(new CommandBinding(SystemCommands.RestoreWindowCommand, this.OnRestoreWindow, this.OnCanResizeWindow));
    }

    private void OnCanResizeWindow(object sender, CanExecuteRoutedEventArgs e)
    {
        e.CanExecute = this.ResizeMode == ResizeMode.CanResize || this.ResizeMode == ResizeMode.CanResizeWithGrip;
    }

    private void OnCanMinimizeWindow(object sender, CanExecuteRoutedEventArgs e)
    {
        e.CanExecute = this.ResizeMode != ResizeMode.NoResize;
    }

    private void OnCloseWindow(object target, ExecutedRoutedEventArgs e)
    {
        SystemCommands.CloseWindow(this);
    }

    private void OnMaximizeWindow(object target, ExecutedRoutedEventArgs e)
    {
        SystemCommands.MaximizeWindow(this);
    }

    private void OnMinimizeWindow(object target, ExecutedRoutedEventArgs e)
    {
        SystemCommands.MinimizeWindow(this);
    }

    private void OnRestoreWindow(object target, ExecutedRoutedEventArgs e)
    {
        SystemCommands.RestoreWindow(this);
    }
} 
```

这里的资源：

```
<BooleanToVisibilityConverter x:Key="bool2VisibilityConverter" />

<Color x:Key="WindowBackgroundColor">#FF2D2D30</Color>
<Color x:Key="HighlightColor">#FF3F3F41</Color>
<Color x:Key="BlueColor">#FF007ACC</Color>
<Color x:Key="ForegroundColor">#FFF4F4F5</Color>

<SolidColorBrush x:Key="WindowBackgroundColorBrush" Color="{StaticResource WindowBackgroundColor}"/>
<SolidColorBrush x:Key="HighlightColorBrush" Color="{StaticResource HighlightColor}"/>
<SolidColorBrush x:Key="BlueColorBrush" Color="{StaticResource BlueColor}"/>
<SolidColorBrush x:Key="ForegroundColorBrush" Color="{StaticResource ForegroundColor}"/>

<Style x:Key="WindowButtonStyle" TargetType="{x:Type Button}">
    <Setter Property="Foreground" Value="{DynamicResource ForegroundColorBrush}" />
    <Setter Property="Background" Value="Transparent" />
    <Setter Property="HorizontalContentAlignment" Value="Center" />
    <Setter Property="VerticalContentAlignment" Value="Center" />
    <Setter Property="Padding" Value="1" />
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="{x:Type Button}">
                <Grid Background="{TemplateBinding Background}">
                    <ContentPresenter x:Name="contentPresenter"
                          HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                          VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                          SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                          Margin="{TemplateBinding Padding}"
                          RecognizesAccessKey="True" />
                </Grid>
                <ControlTemplate.Triggers>
                    <Trigger Property="IsMouseOver" Value="True">
                        <Setter Property="Background" Value="{StaticResource HighlightColorBrush}" />
                    </Trigger>
                    <Trigger Property="IsPressed" Value="True">
                        <Setter Property="Background" Value="{DynamicResource BlueColorBrush}" />
                    </Trigger>
                    <Trigger Property="IsEnabled" Value="false">
                        <Setter TargetName="contentPresenter" Property="Opacity" Value=".5" />
                    </Trigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
</Style>

<Style x:Key="MyWindowStyle" TargetType="local:MyWindow">
    <Setter Property="Foreground" Value="{DynamicResource ForegroundColorBrush}" />
    <Setter Property="Background" Value="{DynamicResource WindowBackgroundBrush}"/>
    <Setter Property="ResizeMode" Value="CanResizeWithGrip" />
    <Setter Property="UseLayoutRounding" Value="True" />
    <Setter Property="TextOptions.TextFormattingMode" Value="Display" />
    <Setter Property="Template">
        <Setter.Value>
            <ControlTemplate TargetType="local:MyWindow">
                <Border x:Name="WindowBorder" Margin="{Binding Source={x:Static SystemParameters.WindowNonClientFrameThickness}}" Background="{StaticResource WindowBackgroundColorBrush}">
                    <Grid>
                        <Border BorderThickness="1">
                            <AdornerDecorator>
                                <Grid x:Name="LayoutRoot">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="25" />
                                        <RowDefinition Height="*" />
                                        <RowDefinition Height="15" />
                                    </Grid.RowDefinitions>
                                    <ContentPresenter Grid.Row="1" Grid.RowSpan="2" Margin="7"/>
                                    <Rectangle x:Name="HeaderBackground" Height="25" Fill="{DynamicResource WindowBackgroundColorBrush}" VerticalAlignment="Top" Grid.Row="0"/>
                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Top" WindowChrome.IsHitTestVisibleInChrome="True" Grid.Row="0">
                                        <Button Command="{Binding Source={x:Static SystemCommands.MinimizeWindowCommand}}" ToolTip="minimize" Style="{StaticResource WindowButtonStyle}">
                                            <Button.Content>
                                                <Grid Width="30" Height="25" RenderTransform="1,0,0,1,0,1">
                                                    <Path Data="M0,6 L8,6 Z" Width="8" Height="7" VerticalAlignment="Center" HorizontalAlignment="Center"
                                                        Stroke="{Binding Foreground, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=Button}}" StrokeThickness="2"  />
                                                </Grid>
                                            </Button.Content>
                                        </Button>
                                        <Grid Margin="1,0,1,0">
                                            <Button x:Name="Restore" Command="{Binding Source={x:Static SystemCommands.RestoreWindowCommand}}" ToolTip="restore" Visibility="Collapsed" Style="{StaticResource WindowButtonStyle}">
                                                <Button.Content>
                                                    <Grid Width="30" Height="25" UseLayoutRounding="True" RenderTransform="1,0,0,1,.5,.5">
                                                        <Path Data="M2,0 L8,0 L8,6 M0,3 L6,3 M0,2 L6,2 L6,8 L0,8 Z" Width="8" Height="8" VerticalAlignment="Center" HorizontalAlignment="Center"
                                                            Stroke="{Binding Foreground, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=Button}}" StrokeThickness="1"  />
                                                    </Grid>
                                                </Button.Content>
                                            </Button>
                                            <Button x:Name="Maximize" Command="{Binding Source={x:Static SystemCommands.MaximizeWindowCommand}}" ToolTip="maximize" Style="{StaticResource WindowButtonStyle}">
                                                <Button.Content>
                                                    <Grid Width="31" Height="25">
                                                        <Path Data="M0,1 L9,1 L9,8 L0,8 Z" Width="9" Height="8" VerticalAlignment="Center" HorizontalAlignment="Center"
                                                            Stroke="{Binding Foreground, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=Button}}" StrokeThickness="2"  />
                                                    </Grid>
                                                </Button.Content>
                                            </Button>
                                        </Grid>
                                        <Button Command="{Binding Source={x:Static SystemCommands.CloseWindowCommand}}" ToolTip="close"  Style="{StaticResource WindowButtonStyle}">
                                            <Button.Content>
                                                <Grid Width="30" Height="25" RenderTransform="1,0,0,1,0,1">
                                                    <Path Data="M0,0 L8,7 M8,0 L0,7 Z" Width="8" Height="7" VerticalAlignment="Center" HorizontalAlignment="Center"
                                                        Stroke="{Binding Foreground, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=Button}}" StrokeThickness="1.5"  />
                                                </Grid>
                                            </Button.Content>
                                        </Button>
                                    </StackPanel>
                                    <TextBlock x:Name="WindowTitleTextBlock" Grid.Row="0" Text="{TemplateBinding Title}" HorizontalAlignment="Left" TextTrimming="CharacterEllipsis" VerticalAlignment="Center"  Margin="8 -1 0 0"  FontSize="16"  Foreground="{TemplateBinding Foreground}"/>
                                    <Grid Grid.Row="2">
                                        <Path x:Name="ResizeGrip" Visibility="Collapsed" Width="12" Height="12" Margin="1" HorizontalAlignment="Right"
                                        Stroke="{StaticResource BlueColorBrush}" StrokeThickness="1" Stretch="None" Data="F1 M1,10 L3,10 M5,10 L7,10 M9,10 L11,10 M2,9 L2,11 M6,9 L6,11 M10,9 L10,11 M5,6 L7,6 M9,6 L11,6 M6,5 L6,7 M10,5 L10,7 M9,2 L11,2 M10,1 L10,3" />
                                    </Grid>
                                </Grid>
                            </AdornerDecorator>
                        </Border>
                        <Border BorderBrush="{StaticResource BlueColorBrush}" BorderThickness="1" Visibility="{Binding IsActive, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Window}}, Converter={StaticResource bool2VisibilityConverter}}" />
                    </Grid>
                </Border>
                <ControlTemplate.Triggers>
                    <Trigger Property="WindowState" Value="Maximized">
                        <Setter TargetName="Maximize" Property="Visibility" Value="Collapsed" />
                        <Setter TargetName="Restore" Property="Visibility" Value="Visible" />
                        <Setter TargetName="LayoutRoot" Property="Margin" Value="7" />
                    </Trigger>
                    <Trigger Property="WindowState" Value="Normal">
                        <Setter TargetName="Maximize" Property="Visibility" Value="Visible" />
                        <Setter TargetName="Restore" Property="Visibility" Value="Collapsed" />
                    </Trigger>
                    <MultiTrigger>
                        <MultiTrigger.Conditions>
                            <Condition Property="ResizeMode" Value="CanResizeWithGrip" />
                            <Condition Property="WindowState" Value="Normal" />
                        </MultiTrigger.Conditions>
                        <Setter TargetName="ResizeGrip" Property="Visibility" Value="Visible" />
                    </MultiTrigger>
                </ControlTemplate.Triggers>
            </ControlTemplate>
        </Setter.Value>
    </Setter>
    <Setter Property="WindowChrome.WindowChrome">
        <Setter.Value>
            <WindowChrome CornerRadius="0" GlassFrameThickness="1" UseAeroCaptionButtons="False" />
        </Setter.Value>
    </Setter>
</Style> 
```

* * *

## 回答 #2

> 赞同：51
> 
> 时间：2013-03-19T13:07:56.943

我最终选择的解决方案是[MahApps.Metro](http://mahapps.com/MahApps.Metro/)（[github](https://github.com/MahApps/MahApps.Metro/)），（在现在在两个软件上使用它之后）我认为它是一个出色的 UI 工具包*（感谢[Oliver Vogel](https://stackoverflow.com/questions/13592326/making-wpf-applications-look-metro-styled-even-in-windows-7-window-chrome-t/15500408#comment20895299_13592326)的建议）*。

![窗口样式](../Images/c60482e50bbc2368f4dad7c55db10872.png)

它只需极少的工作即可为应用程序设置皮肤，并且对标准 Windows 8 控件进行了改编。它非常坚固。

![文本框水印](../Images/bbb71ebe25206728c25220a49c2a424e.png)

Nuget 上有一个版本：

> 您可以使用 GUI（右键单击您的项目，管理 Nuget 引用，搜索“MahApps.Metro”）或通过控制台安装 MahApps.Metro：
> 
> PM> 安装包 MahApps.Metro

它也是**免费**的——即使用于商业用途。

## *2013 年 10 月 29 日更新：*

我发现 MahApps.Metro 的 Github 版本包含当前 nuget 版本中不可用的控件和样式，包括：

## 数据网格：

![在此处输入图像描述](../Images/d0e58096e2c07d7708999d6c931e3121.png)

## 清洁窗口：

![在此处输入图像描述](../Images/12e8b60f6bb53fed826524340bbf5477.png)

## 飞出：

![在此处输入图像描述](../Images/a1844a8eedbce5c8c1ffeecc07b3115c.png)

## 瓷砖：

![在此处输入图像描述](../Images/153d0c149670fca7a064a4f5606823fd.png)

github 存储库非常活跃，有相当多的用户贡献。我建议检查一下。

* * *

## 回答 #3

> 赞同：44
> 
> 时间：2013-04-22T10:56:40.477

我会推荐[WPF 的 Modern UI](https://github.com/firstfloorsoftware/mui)。

它有一个非常活跃的维护者，它很棒而且免费！

![WPF 的现代 UI（示例应用程序的屏幕截图](../Images/faaeffc5fe519915c06af1e392b09fa0.png)

我目前正在将一些项目移植到 MUI，第一个（同时第二个）印象就是哇！

要查看 MUI 的运行情况，您可以下载基于 MUI 的[XAML Spy 。](http://xamlspy.com/)

**编辑：**在 WPF 中使用 Modern UI 几个月，我很喜欢它！

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2013-04-15T13:58:38.927

根据[Kapitán Mlíko 对](https://stackoverflow.com/a/15520170/84873)上述来源的回答，我将其更改为使用以下内容：

![Marlett 字体示例](../Images/ac967c1c5e571f24aa4a216cc30cb1c5.png)

对于最小化、恢复/最大化和关闭按钮，最好使用 Marlett 字体而不是路径数据点。

```
<StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Top" WindowChrome.IsHitTestVisibleInChrome="True" Grid.Row="0">
<Button Command="{Binding Source={x:Static SystemCommands.MinimizeWindowCommand}}" ToolTip="minimize" Style="{StaticResource WindowButtonStyle}">
    <Button.Content>
        <Grid Width="30" Height="25">
            <TextBlock Text="0" FontFamily="Marlett" FontSize="14" VerticalAlignment="Center" HorizontalAlignment="Center" Padding="3.5,0,0,3" />
        </Grid>
    </Button.Content>
</Button>
<Grid Margin="1,0,1,0">
    <Button x:Name="Restore" Command="{Binding Source={x:Static SystemCommands.RestoreWindowCommand}}" ToolTip="restore" Visibility="Collapsed" Style="{StaticResource WindowButtonStyle}">
        <Button.Content>
            <Grid Width="30" Height="25" UseLayoutRounding="True">
                <TextBlock Text="2" FontFamily="Marlett" FontSize="14" VerticalAlignment="Center" HorizontalAlignment="Center" Padding="2,0,0,1" />
            </Grid>
        </Button.Content>
    </Button>
    <Button x:Name="Maximize" Command="{Binding Source={x:Static SystemCommands.MaximizeWindowCommand}}" ToolTip="maximize" Style="{StaticResource WindowButtonStyle}">
        <Button.Content>
            <Grid Width="31" Height="25">
                <TextBlock Text="1" FontFamily="Marlett" FontSize="14" VerticalAlignment="Center" HorizontalAlignment="Center" Padding="2,0,0,1" />
            </Grid>
        </Button.Content>
    </Button>
</Grid>
<Button Command="{Binding Source={x:Static SystemCommands.CloseWindowCommand}}" ToolTip="close"  Style="{StaticResource WindowButtonStyle}">
    <Button.Content>
        <Grid Width="30" Height="25">
            <TextBlock Text="r" FontFamily="Marlett" FontSize="14" VerticalAlignment="Center" HorizontalAlignment="Center" Padding="0,0,0,1" />
        </Grid>
    </Button.Content>
</Button> 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-12-16T09:44:01.340

如果你愿意付钱，我强烈推荐你[Telerik Components for WPF](http://www.telerik.com/products/wpf/overview.aspx)。它们提供了很棒的[样式/主题](http://www.telerik.com/products/wpf/overview.aspx#professional-looking-themes)，并且有针对 Office 2013 和 Windows 8 的特定主题（编辑：还有 Visual Studio 2013 主题样式）。然而，那里提供的不仅仅是样式，实际上你会得到一大堆非常有用的控件。

以下是它的实际效果（取自 Telerik 样本的屏幕截图）：

![Telerik 仪表板示例](../Images/e3b25ee274ac053bde07ae0ed26a36ff.png)

![Telerik CRM 仪表板示例](../Images/0ee79b71ff120e2c83ee610eb9e92deb.png)

这是[Telerik 执行仪表板示例](http://demos.telerik.com/wpf/executivedashboard/)的链接（第一个屏幕截图）和[CRM 仪表板](http://demos.telerik.com/wpf/crm/)的链接（第二个屏幕截图）。

他们提供 30 天的试用期，试一试！

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-12-29T18:22:17.047

看看这个[带有可选发光边框的 WPF 地铁风格窗口](https://github.com/laila111111/MetroWindow)。

这是一个独立的应用程序，使用 Microsoft.Windows.Shell（包括在内）之外的任何其他库来创建带有可选发光边框的 Metro 风格窗口。

一直支持 Windows 到 XP (.NET4)。

# sql - Oracle 在 where 子句中应用过滤器之前是否获取所有行？

> ID：13592329
> 
> 赞同：0
> 
> 时间：2012-11-27T20:17:36.940
> 
> 标签：sql, oracle, oracle10g, oracle11g, rownum

> **可能重复：**
> [Oracle 是否在评估 rownum 之前获取所有行？](https://stackoverflow.com/questions/13579414/does-oracle-fetch-all-the-rows-before-evaluating-rownum)

如果我在有 100k 行的表上运行以下查询

```
select * from 
(
 select rownum rownumber, fname, lastname
 from customers
) where rownumber between 1 and 100; 
```

Oracle 是否获取所有 100k 然后过滤获取的行列表以获得前 100 行，或者它是否有一种巧妙的方式过滤到前 100 行而不获取所有 100k 行？

有没有办法找出 Oracle 在上面的例子中实际上是如何进行 fetch 的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T20:35:15.283

首先，由于您的内部查询没有进行任何排序，您的查询返回任意 100 行。如果这是试图构建一个查询以对结果进行分页，这不是正确的方法，因为它效率不高，而且因为它不正确——返回的行集很可能会随着时间而改变，而行可能很容易出现在结果的许多不同页面上或根本没有页面上。

但是，通过查看查询计划来了解何时应用过滤器很容易。我将建立一个`FOO`100,000 行的普通表

```
SQL> drop table foo;

Table dropped.

SQL> create table foo
  2  as
  3  select level col1
  4    from dual
  5   connect by level <= 100000;

Table created. 
```

现在，启用自动跟踪，禁止显示实际数据并运行查询

```
SQL> set autotrace traceonly;

SQL> select *
  2    from (select rownum rn, col1
  3            from foo)
  4   where rn between 1 and 100;

100 rows selected.

Execution Plan
----------------------------------------------------------
Plan hash value: 3193632835

----------------------------------------------------------------------------
| Id  | Operation           | Name | Rows  | Bytes | Cost (%CPU)| Time     |
----------------------------------------------------------------------------
|   0 | SELECT STATEMENT    |      |   101K|  2577K|    47   (3)| 00:00:01 |
|*  1 |  VIEW               |      |   101K|  2577K|    47   (3)| 00:00:01 |
|   2 |   COUNT             |      |       |       |            |          |
|   3 |    TABLE ACCESS FULL| FOO  |   101K|  1288K|    47   (3)| 00:00:01 |
----------------------------------------------------------------------------

Predicate Information (identified by operation id):
---------------------------------------------------

   1 - filter("RN"<=100 AND "RN">=1)

Note
-----
   - dynamic sampling used for this statement (level=2)

Statistics
----------------------------------------------------------
          0  recursive calls
          0  db block gets
        164  consistent gets
          0  physical reads
          0  redo size
       2504  bytes sent via SQL*Net to client
        590  bytes received via SQL*Net from client
          8  SQL*Net roundtrips to/from client
          0  sorts (memory)
          0  sorts (disk)
        100  rows processed 
```

如果您查看查询计划，您可以看到我们在应用谓词`FOO`之前进行了全表扫描。`rn between 1 and 100`所以整个结果集就物化了（一致get的个数大致就是表中的block个数）。

如果您使用了更合适的分页查询（例如，Tom Kyte 有一篇关于分页的[Oracle 杂志文章，并且](http://www.oracle.com/technetwork/issue-archive/2007/07-jan/o17asktom-093877.html)[在 askTom](http://asktom.oracle.com/pls/apex/f?p=100:11:0%3a%3a%3a%3aP11_QUESTION_ID:127412348064)上对分页进行了更长的讨论），您会在查询计划中看到这样的`SORT ORDER BY STOPKEY`内容，告诉您 Oracle 知道它可以停止在某个点之后进行处理。

# javascript - Javascript禁用文件输入鼠标在工具提示上

> ID：13592330
> 
> 赞同：1
> 
> 时间：2012-11-27T20:17:40.270
> 
> 标签：javascript, css, input

我有一个自定义样式的文件上传按钮，它是通过使用 hack 实现的，您可以在其中放置一个不透明度为 0 的标准文件输入，直接位于自定义按钮的后面。我希望文件输入默认的“未选择文件”鼠标悬停在用户将鼠标悬停在我的自定义按钮上时不会出现。

反正有没有阻止该工具提示出现？

此外，文件输入似乎完全说明了鼠标移动事件，并且它们不会在我的自定义按钮上触发，有没有办法防止文件输入像那样捕获鼠标输入？

# perl - 这个 cat/tr/perl 命令管道有什么作用？

> ID：13592331
> 
> 赞同：-1
> 
> 时间：2012-11-27T20:17:40.367
> 
> 标签：perl

我对 Perl 不熟悉。我想知道运行这个有什么效果：

```
 cat file_name | tr -d '\000' | perl -pi -e 's/[^\n\040-\176]/#/g' >  new_file.out 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T20:24:15.327

读取名为“file_name”的文件，删除所有符号`\000`（Null symbol），将所有不是`\n`或之间的符号替换`\040-\0176`为`#`，最后将结果写入“new_file.out”

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T20:38:36.180

这做了两件事：

1.  从文件中删除任何空值
2.  用“#”字符替换任何不可打印的字符。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-27T20:46:56.897

perl与`-pi`我有关，因为`-i`意味着“就地修改输入文件”并且那里没有输入文件。

我相信可以通过删除`cat`和 `tr 并仅使用来缩短整个命令行

```
perl -pe 's/[^\n\040-\176]/#/g' file_name >  new_file.out 
```

然后您实际上可以利用`-i`开关并使用

```
perl -p -i -e's/[^\n\040-\176]/#/g' file_name 
```

并且清理后的版本将放入文件中`file_name`。

如果您想要一个安全的备份版本，请更改`-i`为`-i.bak`，它会将新内容放入`file_name`并保留旧内容`file_name.bak`。

**注意**：我的版本不完全等效。请参阅下面的评论。

# python - Python: Installation of MPlayer/MEncoder for Windows

> ID：13592334
> 
> 赞同：0
> 
> 时间：2012-11-27T20:17:45.070
> 
> 标签：python

I am trying to install MPlayer for Windows, and using the command line

```
os.system("mencoder...") 
```

I want to be able to compile a series of images into a time-lapse video. The problem is that I am getting the following error:

```
'C:\Python27\Lib\MPlayer-1.1\mencoder' is not recognized as an internal or external command, operable program or batch file. 
```

So my question is, when extracting the MPlayer-1.1.tar.gz file, where are you supposed to put the folder so that the command line will run properly in Windows?

I downloaded MPlayer from here: [http://www.mplayerhq.hu/design7/dload.html](http://www.mplayerhq.hu/design7/dload.html).

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T20:31:38.750

From my understanding, you downloaded the source code of MPlayer which you cannot run via command line. You have to compile the whole project perhaps. Otherwise download the binaries just like Dan D said.

# android - 带有 facebook 集成的 Android 显示配置错误的错误

> ID：13592345
> 
> 赞同：0
> 
> 时间：2012-11-27T20:18:51.550
> 
> 标签：android, facebook

我有一个简单的代码如下：

```
package com.my_fb_app2;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;

import com.facebook.android.AsyncFacebookRunner;
import com.facebook.android.DialogError;
import com.facebook.android.Facebook;
import com.facebook.android.Facebook.DialogListener;
import com.facebook.android.FacebookError;

public class MainActivity extends Activity {

Facebook facebook = new Facebook("118649691627381");
AsyncFacebookRunner mAsyncRunner = new AsyncFacebookRunner(facebook);

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    facebook.authorize(this, new DialogListener() {
        @Override
        public void onComplete(Bundle values) {}

        @Override
        public void onFacebookError(FacebookError error) {}

        @Override
        public void onError(DialogError e) {}

        @Override
        public void onCancel() {}
    });
}

@Override
public void onActivityResult(int requestCode, int resultCode, Intent data) {
    super.onActivityResult(requestCode, resultCode, data);

    facebook.authorizeCallback(requestCode, resultCode, data);
}
} 
```

运行 keytool 并提供密码给我哈希为： LlpxIc8nZd7s3uwvfBffXiIoJrQ= 我已经保存在我的 Facebook 应用程序中。

当我在模拟器上运行这个程序时，程序运行为inteded，即询问登录信息，然后在验证后显示hello world！但是当我在我的 Galaxy s3 上运行它时，打开应用程序会显示以下页面。此处提供的屏幕截图[http://msu-footprints.org/2011/Aditya/screen.jpg](http://msu-footprints.org/2011/Aditya/screen.jpg)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T20:27:36.043

您的模拟器很可能没有安装 Facebook 应用程序，这就是它工作的原因（它使用 Web 视图代替）。无论如何，如果您收到此错误，则意味着您的代码是正常的，并且 Facebook 上的应用程序首选项配置错误。我的猜测是应用程序的哈希键生成不正确。您可以尝试为另一个密钥库生成它并使用该密钥库签署应用程序

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T03:15:14.380

正在为我的 64 位计算机使用开放 ssl 32 位版本，它创建了错误的哈希键。

# ruby - 红宝石的最佳实践需要

> ID：13592348
> 
> 赞同：0
> 
> 时间：2012-11-27T20:19:00.207
> 
> 标签：ruby, continuous-integration, require

我正在设置自动端到端浏览器测试（Selenium Webdriver + Ruby），目的是使它们能够在我的本地或 CI 服务器上运行。如何要求运行测试所需的所有文件（页面对象）？设置文件夹结构的最佳方法是什么，以便我可以轻松地要求并维护我的页面对象目录中的组织？

```
#I am trying to eliminate all the absolute paths below
#require "C:\\Users\\workspace\\FalconQA\\PageObjects\\Users\\userdata.rb"
#require "C:\\Users\\workspace\\FalconQA\\PageObjects\\Users\\user.rb"
#require "C:\\Users\\workspace\\FalconQA\\PageObjects\\General\\nav.rb"
#require "C:\\Users\\workspace\\FalconQA\\PageObjects\\General\\login.rb"
#require "C:\\Users\\workspace\\FalconQA\\PageObjects\\General\\dash.rb"
#require "C:\\Users\\workspace\\FalconQA\\PageObjects\\members\\manageMembers.rb"
#require "C:\\Users\\workspace\\FalconQA\\PageObjects\\members\\accountsReceivable.rb"
#require "C:\\Users\\workspace\\FalconQA\\PageObjects\\members\\createMember.rb"
#require "C:\\Users\\workspace\\FalconQA\\PageObjects\\members\\newPayment.rb"
#require "C:\\Users\\workspace\\FalconQA\\PageObjects\\members\\createInvoice.rb"

#This doesn't seem to work 
Dir['\\FalconQA\\*.rb'].each { |f| require f }

require "selenium-webdriver"
require 'test-unit'
gem 'test-unit'
class FAL001 < Test::Unit::TestCase 
  def testFAL001
    $user = User.new("tester2")
    login = Login.new 
    login.username($user.name)
    login.password($user.password)
    login.submit.members.noImmediateDropDown.accountsRecievable("NAme").newPayment.createInvoice
    $user.stop
  end
  def testFAL002 
    puts " THis is a test "
  end
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T20:21:16.833

你可以试试：

```
Dir['test-case-folder/test*.rb'].each { |f| require f } 
```

# c# - 如何使用便携式库从 html 元素中获取内容？

> ID：13592349
> 
> 赞同：3
> 
> 时间：2012-11-27T20:18:58.550
> 
> 标签：c#, html-parsing, portable-class-library

我想从中“下载” HTML`http://www.google.com/search?q=stack+overflow`并获取前 5 个结果的`title`和`url`。

在便携式图书馆中，我相信我无法访问`HtmlDocument`并且`HtmlAgilityPack`无法工作，还是我错了？

我怎样才能完成这项任务，让 lib 至少能够在 Windows Store Apps 和 Windows Phone 上执行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T22:26:24.410

`download`内容很常见，使用 WebClient（[MSDN 文档](http://msdn.microsoft.com/library/system.net.webclient%28v=vs.110%29.aspx)）你能访问 System.Net 命名空间吗？

# scheme - 在 DrRacket 中编译 SICP 图片练习？

> ID：13592352
> 
> 赞同：12
> 
> 时间：2012-11-27T20:19:40.170
> 
> 标签：scheme, lisp, racket, sicp

我正在通过 SICP 作为自学并在第 2 章中的图片语言部分。我一直在使用 DrRacket 进行早期练习，但是在尝试基于“画线”进行练习时出现编译错误本书这一部分的图片功能。

具体来说，这段代码...

```
(define (segments->painter segment-list)   
 (lambda (frame)     
  (for-each     
   (lambda (segment)        
    (draw-line         
     ((frame-coord-map frame) (start-segment segment))         
     ((frame-coord-map frame) (end-segment segment))))      
 segment-list))) 
```

...产生此错误...

```
draw-line: unbound identifier in module in: draw-line 
```

所以我在这个论坛上做了一些研究并安装了 Neil Van Dyke 提供的 SICP 包（[http://www.neilvandyke.org/racket-sicp/#(part._usage)](http://www.neilvandyke.org/racket-sicp/#(part._usage))）。我按照所有步骤操作，按照指示将语言更改为 SICP，但仍然出现相同的错误。

我假设这个包的目的是定义这个“内置”函数（以及书中的其他函数）。只是为了预测一些问题，我在文件中没有“require”语句，并使用“#lang planet neil/sicp”来指定语言而不是使用菜单（我还尝试使用菜单将语言更改为 SICP 并获取一个更奇怪的错误；请参阅下面的后记）。我的环境是Windows 7，DrRacket的版本是5.3.1。

也许我只是犯了一个菜鸟错误；任何见解将不胜感激。

谢谢。

PS：对于那些感兴趣的人，当我使用菜单将语言设置为“SICP（PLaneT 1.17）”时，对于我尝试编译的任何定义（即使是最琐碎的），我都会收到以下错误...

```
<unsaved editor>:1:0: #%top-interaction: unbound identifier;
also, no #%app syntax transformer is bound in: #%top-interaction 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-27T20:33:28.513

在 Racket 中，这些定义解决了我在 SICP 第 2 章中的图纸问题，我成功地解决了之后的练习：

```
(require graphics/graphics)
(open-graphics)
(define vp (open-viewport "A Picture Language" 500 500))

(define draw (draw-viewport vp))
(define (clear) ((clear-viewport vp)))
(define line (draw-line vp))

(define (make-vect x y)
  (cons x y))

(define (xcor-vect v)
  (car v))

(define (ycor-vect v)
  (cdr v))

(define (add-vect v1 v2)
  (make-vect (+ (xcor-vect v1)
                (xcor-vect v2))
             (+ (ycor-vect v1)
                (ycor-vect v2))))

(define (sub-vect v1 v2)
  (make-vect (- (xcor-vect v1)
                (xcor-vect v2))
             (- (ycor-vect v1)
                (ycor-vect v2))))

(define (scale-vect s v)
  (make-vect (* s (xcor-vect v))
             (* s (ycor-vect v))))

(define (make-frame origin edge1 edge2)
  (list origin edge1 edge2))

(define (origin-frame f)
  (car f))

(define (edge1-frame f)
  (cadr f))

(define (edge2-frame f)
  (caddr f))

(define (frame-coord-map frame)
  (lambda (v)
    (add-vect
     (origin-frame frame)
     (add-vect (scale-vect (xcor-vect v)
                           (edge1-frame frame))
               (scale-vect (ycor-vect v)
                           (edge2-frame frame)))))) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-28T18:59:45.037

我要感谢 alinsoar、flamingo 和 Oscar 提供的非常有用的建议。

我决定采用 Oscar 的方法，它（显然）使用球拍图形库，而不是 Neil Van Dyke 放在一起的特殊软件包（我只是没有运气）。这是我的代码的重要部分（省略了不依赖于图形库的定义）：

```
#lang racket
(require graphics/graphics)
(open-graphics)
(define vp (open-viewport "A Picture Language" 500 500))

(define draw (draw-viewport vp))
(define (clear) ((clear-viewport vp)))
(define line (draw-line vp))

;need a wrapper function so that the graphics library works with my code...
(define (vector-to-posn v)
  (make-posn (car v) (car(cdr v))))

(define (segments->painter segment-list)   
  (lambda (frame)     
   (for-each     
     (lambda (segment)        
      (line         
        (vector-to-posn ((frame-coord-map frame) (start-segment segment)))         
        (vector-to-posn ((frame-coord-map frame) (end-segment segment)))))      
      segment-list))) 
```

所以，有几点需要注意：

1) 如上所述，这使用标准球拍语言，而不是 Neil Van Dyke 实施目的的 SICP 语言。

2）这个库中的'draw-line'函数将视口（基本上是一个窗口）作为参数，并创建一个函数，该函数采用两个坐标作为参数（以及一个我没有使用的可选颜色参数）。然而，在这种情况下，“坐标”并不是练习使用的简单向量。坐标是结构 'posn' 的实例，它基本上只是 x 和 y 值的包装器。

这种 posn 数据类型的存在意味着我必须先用 posn 构造函数包装我的向量，然后才能在“segments-painter”函数中使用它们。（'vector-to-posn' 函数就是这个包装器）。另请注意，本书对“segments-painter”的定义中使用的“draw-line”一词已替换为“line”，其定义为（draw-line vp）。

3) 有趣的是，球拍图形库定义的视口坐标与我预期的有点不同。坐标 (0 0) 是框架中的**左上角**（我猜想是左下角），而 (1 1) 是右下角。（请注意，这里我说的是单位正方形。在我在上面的代码中使用的框架中，右下角的真实坐标是（500 500）。）

由于我正在进行的练习（2.49）涉及绘制关于水平轴对称的图形，所以这个小皱纹无关紧要，否则它可能会让你感到惊讶。我突然想到，解决这种“反转”的一种方法是使用书中的“翻转”功能，但我没有花时间去做。

再次感谢所有的帮助！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-28T07:00:53.193

我也使用 DrRacket 进行 SICP 练习。因此，为了使用绘图功能，您应该在源文件的顶部添加以下行：

```
(require (lib "racket/draw"))
(require racket/class) 
```

然后你应该设置图形上下文，如下所示：

```
(define target (make-bitmap 100 100))
(define dc (new bitmap-dc% [bitmap target])) 
```

在此之后，您可以画一条线：

```
(send dc draw-line
  (x1 y1) (x2 y2)
  (x3 y3) (x4 y4)) 
```

并将结果保存到文件中：

```
(send target save-file "foo.png" 'png) 
```

这是[我](https://github.com/flaming0/SICP/blob/master/ch2/ex2-49.scm)对第 2 章练习的解决方案

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-01-06T14:27:11.407

对于大多数练习，从planet 加载sicp 模块并在每个文件的顶部添加以下语言声明就足够了：

`#lang planet neil/sicp`

对于图片语言问题，请改用：

`#lang planet neil/sicp (#%require sicp-pict)`

缺少以下内容：

海浪：

```
(define wave
  (segments->painter
   (list
    (make-segment (make-vect 0.20 0.00) (make-vect 0.35 0.50))
    (make-segment (make-vect 0.35 0.50) (make-vect 0.30 0.60))
    (make-segment (make-vect 0.30 0.60) (make-vect 0.15 0.45))
    (make-segment (make-vect 0.15 0.45) (make-vect 0.00 0.60))
    (make-segment (make-vect 0.00 0.80) (make-vect 0.15 0.65))
    (make-segment (make-vect 0.15 0.65) (make-vect 0.30 0.70))
    (make-segment (make-vect 0.30 0.70) (make-vect 0.40 0.70))
    (make-segment (make-vect 0.40 0.70) (make-vect 0.35 0.85))
    (make-segment (make-vect 0.35 0.85) (make-vect 0.40 1.00))
    (make-segment (make-vect 0.60 1.00) (make-vect 0.65 0.85))
    (make-segment (make-vect 0.65 0.85) (make-vect 0.60 0.70))
    (make-segment (make-vect 0.60 0.70) (make-vect 0.75 0.70))
    (make-segment (make-vect 0.75 0.70) (make-vect 1.00 0.40))
    (make-segment (make-vect 1.00 0.20) (make-vect 0.60 0.48))
    (make-segment (make-vect 0.60 0.48) (make-vect 0.80 0.00))
    (make-segment (make-vect 0.40 0.00) (make-vect 0.50 0.30))
    (make-segment (make-vect 0.50 0.30) (make-vect 0.60 0.00))))) 
```

罗杰斯：
替换为替代原语`einstein`

如果你还想为练习 2.49 实现自己版本的 sicp-pict 模块，可能最简单的方法是使用 htdp 教学语言中的图像库。将以下内容放在程序的顶部：

```
#lang sicp
(#%require 2htdp/image)
(#%require lang/posn)
(#%require racket/base)

(define *current-image* empty-image)  

(define (*new-image* new-frame)
  (define (xy->posn x y)
    (let ((v ((frame-coord-map new-frame) (make-vect x y))))
      (make-posn (xcor-vect v) (ycor-vect v))))
  (set! *current-image*
        (polygon
         (list
          (xy->posn 0 0)
          (xy->posn 0 1)
          (xy->posn 1 1)
          (xy->posn 1 0))
         "solid"
         "white")))  

(define (draw-line start end)
    (set! *current-image*
        (add-line
         *current-image*
         (xcor-vect start)
         (ycor-vect start)
         (xcor-vect end)
         (ycor-vect end)
         "black")))  

(define (paint-in-frame painter frame)
    (*new-image* frame)
    (painter frame)
    *current-image*))  

(define (paint painter)
    (paint-in-frame
        painter
        (make-frame
            (make-vect 0 150)
            (make-vect 150 0)
            (make-vect 0 -150)))) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-06-30T15:02:24.027

我的方法稍微简单一些：尽管只是自己实现了它们，但不要使用您自己的 Ex.2.49 定义，而是使用您获得的内置函数

```
#lang sicp
(#%require sicp-pict) 
```

诚然，这并不令人满意，但它可以快速完成工作，让您专注于做练习的重要部分，而不是摆弄解决方法。

# c# - FOR XML 到数据集

> ID：13592356
> 
> 赞同：1
> 
> 时间：2012-11-27T20:19:49.483
> 
> 标签：c#, xml, tsql, ado.net

我正在尝试使用 SQL“FOR XML”子句生成的 xml 加载 ac# 数据集。似乎如果我格式化 XML 以便包含架构，则不会加载数据。如果我离开模式，我会得到数据，但不是正确的数据类型。

如何从使用 FOR XML 子句生成的 XML 加载数据集，以便加载类型信息和数据？（FOR XML AUTO|RAW,XMLDATA|XMLSCHEMA 的某种组合？？？）

**更新**

将其更改为使用从字符串构建的 XmlReader 而不是从 SqlXml 变量创建的读取器允许将类型信息和数据都带入数据集，只要架构信息包含在 xml 中。当然，我认为这意味着对 xml 进行额外的解析。有更好的解决方案吗？

```
 string xml = cmd.Parameters["@xml"].Value.ToString();
            StringReader str = new StringReader(String.Format(@"<root>{0}</root>", xml));
            System.Xml.XmlReader xmr = System.Xml.XmlReader.Create(str);
            ds.ReadXml(xmr); 
```

SQL：

```
ALTER PROCEDURE prc_GetXmlData @xml XML OUTPUT
AS
BEGIN
    IF OBJECT_ID('test') IS NOT NULL
        DROP TABLE test
    CREATE TABLE test (field1 INT, field2 BIT, field3 MONEY, field4 VARCHAR(8000))

    INSERT INTO test 
        (field1, field2, field3, field4)
    VALUES
        (3, 1, 99.45, 'testvalue')

    --what combination????
    SELECT @xml = (SELECT * FROM test FOR XML RAW, XMLDATA)
END 
```

C＃：

```
static void Main(string[] args)
    {
        try
        {
            SqlConnection con = new SqlConnection(<<connectionstring>>);
            SqlCommand cmd = new SqlCommand("prc_GetXmlData", con);
            cmd.CommandType = CommandType.StoredProcedure;
            cmd.Parameters.Add("@xml", SqlDbType.Xml).Direction = ParameterDirection.Output;
            try
            {
                con.Open();
                cmd.ExecuteNonQuery();
            }
            finally
            {
                if (con.State == ConnectionState.Open)
                    con.Close();
            }

            System.Data.SqlTypes.SqlXml sqlXml = (System.Data.SqlTypes.SqlXml)cmd.Parameters["@xml"].SqlValue;
            DataSet ds = new DataSet();
            ds.ReadXml(sqlXml.CreateReader());

            for (int t = 0; t < ds.Tables.Count; t++)
            {
                Console.WriteLine("Column DataTypes:");
                for (int c = 0; c < ds.Tables[t].Columns.Count; c++)
                {
                    Console.WriteLine("ds.Tables[{0}].Columns[{1}].DataType={2}", t, c, ds.Tables[t].Columns[c].DataType);
                }

                Console.WriteLine("Rowcount:{0}", ds.Tables[0].Rows.Count);
            }
        }
        catch (Exception ex)
        {
            Console.WriteLine(ex);
        }

            Console.WriteLine();
            Console.WriteLine("Press any key to exit...");
            Console.ReadKey(true);

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-31T16:07:59.363

将从该过程返回的 xml 字符串传递给 ReadXml()。它将填充您的数据集。

```
string xml = "<your xml string>";
DataSet ds= new DataSet();
ds.ReadXml(xml); 
```

# cordova - navigator.notification.alert 为 IOS 上的 1 个呼叫触发 4 个警报 - jquery mobile - phonegap 2.2.0

> ID：13592357
> 
> 赞同：2
> 
> 时间：2012-11-27T20:19:52.353
> 
> 标签：cordova, jquery-mobile, alert

不知道这里发生了什么......但是假设用户输入他们的 PIN 并点击 GO 按钮，当 PIN 无效时执行以下代码：

```
navigator.notification.alert(
    "Invalid PIN entry. Please try again.",
    alertDismissed,
    "ETA Security",
    ""
);

function alertDismissed(){
    //does nothing
} 
```

这是第一次工作（并且只要我不离开并返回就重复）......但是当我在页面之间导航时（jquery mobile：一切都在一个页面上[index.html]）并回来输入另一个PIN。 ..我再次调用navigator.notification.alert，但这一次，它显示了4次警报（5、6，每次我返回页面，它都会添加另一个警报）！

有任何想法吗？

**

**编辑**- 添加了完整的示例

** 用户单击使用 ajax 的链接进入数据库，该数据库返回包含列表的 json 对象。

数据库调用是一个ajax调用：

```
$.ajax({
  cache: false,
  type: "POST",
  url: "my url telling the database to return the FIF list JSON object",
  data: sFrmData,
  success: function(ajaxResponse){
      eval(ajaxResponse);
      wait(0);
  }
}); 
```

ajax 调用返回：

```
 getFifs({"rows":[
           {
        "ID":"12345",
            "CONF":"1",
            "LINK":"http://www.cnn.com",
            "DIS":"My FIF",
            "CONFIRM_CODE":"flightxyz",
            "DESCRIP":"Fif showing blah blah blah"
           }
          ]}
        ); 
```

在 getFifs 函数中，下方的 CONFIRM BUTTON 区域是调用警报的位置 (etajs.showAlert(\'Confirm Error\'...)

```
//Build the list of FIFs
function getFifs(oJson){
    //change JQM page to fifs
    $.mobile.changePage("#fifs", "none", false, true);
    var strLi=" ";
    var arrayCnt=0;
    var numTotal=0; 

    $("#listFif").empty();
    strLi+='<ul data-role="listview" data-inset="true" data-theme="d">';

    $.each(oJson.rows,function(){
      numTotal++;
      var disname=this.DIS;
      var fifid=this.ID;
      var fiflink=this.LINK;
      var descrip=this.DESCRIP;
      var conf=this.CONF;

      strLi+='<li><font size=5>' + disname + '</font><br>';

//******************************************
//CONFIRM BUTTON    
      strLi+='<div data-mini="true" data-role="controlgroup" data-type="horizontal">';
      strLi+='<a href="#fifCode" onclick="if(fifViewArray['+arrayCnt+']==1){etajs.setIdHolder('+fifid+');"}else{etajs.showAlert(\'Confirm Error\',\'You must first View the FIF before confirming it!\',etajs.alertDismissed);";} ';
      strLi+='data-rel="dialog" data-theme="c" data-role="button">Confirm</a>';
      strLi+='</div>';
      strLi+='<div style="white-space:normal;">Description:<font color=gray> ' + descrip + '</font></div>';
      strLi+='</li>';
    }); //end loop

    strLi+='</ul><Br><Br>';
    $("#listFif").append(strLi).trigger("create");    
    updateScrolling("wrapperFifs"); 
}         

function showAlert(strTitle,strMessage,strCallback){
    navigator.notification.alert(
        strMessage,  // message
        strCallback, // callback to invoke with index of button pressed
        strTitle, // title
        '' // buttonLabels
    );
}

</SCRIPT>

    <!--FIFs Page-->
    <div id="fifs" data-role="page">
        <div id="wrapperFifs" class="iscroll_wrapper"  style="padding-top:0px;">
            <div class="scroller" id="listFif"></div>
        </div>
    </div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T20:56:32.397

你在哪里附加点击处理程序？如果它在 pageshow 上设置或作为页面创建中的委托事件设置，则最终可能会出现重复的处理程序。

移动事件绑定代码或返回 false 所以只有一个运行应该修复它

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T20:53:20.840

这是因为 jQM 的工作方式，它不是错误。

如果您在某个元素或操作上绑定事件，则每次重新访问该页面时，该事件都会再次绑定。因此，每次重新加载页面都更加绑定。

可以这样避免：

1.  如果事件与 .bind( 或 .on( 绑定，然后再与 .unbind( 或 .off( 绑定

2.  使用 jQuery 事件过滤器并在尝试绑定之前检查事件是否已绑定。你可以在[这里](http://www.codenothing.com/archives/2009/event-filter/)找到它。

例子：

$('#button:Event(!click)').each(function(){ // 按钮没有绑定点击事件，现在绑定 });

另一个[例子](https://stackoverflow.com/questions/12477772/navigator-notification-alert-is-not-working-in-cordova-2-0-0-js)，2 比 1：

```
$('document:Event(!deviceready)').each(function(){
    $('#button').unbind();
    $('#button').bind('click', function(e) {
         navigator.notification.alert("PhoneGap is working");
    });
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-05T18:14:24.707

好的！最后！！！我不敢相信......所以这就是我修复它的方法。我将列表中的锚点更改为带有 onclick 的输入类型 = 按钮...

这是之前的动态列表视图项：

```
strLi+='<a href="javascript:void(0)" data-rel="dialog" data-role="button">Confirm</a>'; 
```

这是链接点击设置（我尝试了所有可能的方法，但这只是其中一种。我还在锚点中尝试了 onclick）

```
$('.fifconfbut').live('click', function() {
    checkFif(); //This function call fires multiple times upon returning to the page
    return(false);
}); 
```

和工作代码！

```
strLi+='<input onclick="checkFif();" type=button data-rel="dialog" data-role="button" value="Confirm">';

//This is the function that gets called when the item is clicked
function checkFif(){
    etajs.showAlert('Confirm Error','blah blah blah',etajs.alertDismissed);
    return(false);

} 
```

我想知道的是为什么锚点会触发多个点击事件而按钮不会触发？

# javascript - 如何使用 javascript 检索 cookie 的到期日期

> ID：13592360
> 
> 赞同：2
> 
> 时间：2012-11-27T20:20:02.910
> 
> 标签：javascript, cookies

> **可能重复：**
> [如何从 javascript 获取 cookie 过期日期/创建日期？](https://stackoverflow.com/questions/3274875/how-to-get-cookie-expiration-date-creation-date-from-javascript)

我一直无法找到这个问题的可靠答案。我有一个 cookie 设置为在用户登录后 15 天内过期。我想让用户知道他们每次重新访问该页面时还剩下多少天。

这怎么可能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T20:27:23.437

如果您无法首先通过服务器端检索它，那么您必须求助于使用客户端技巧，因为您无法直接在客户端访问它。诀窍是通过使用 localStorage 来存储 cookie 元信息，您可以实现这一点。例如，在设置 cookie 时，请执行以下操作：

```
document.cookie = 'mycookie=blah;expires=[expiredate];';
localStorage['mycookie'] = JSON.stringify({ 
   expires : '[expiredate]',
   otherdata: whatever
}); 
```

然后，您可以根据需要检查其元数据。如果 cookie 不存在，意味着它不在 document.cookie 中，您应该在脚本中删除该 cookie 的 localStorage。

最好的方法是通过服务器端并将其作为一些 var 输出到页面，如果必须但可以肯定的是，不要在其他 cookie 中存储有关 cookie 的更多信息，因为这只会不必要地膨胀请求。

# c++ - C ++在基类本身中覆盖基类的抽象方法？

> ID：13592370
> 
> 赞同：4
> 
> 时间：2012-11-27T20:20:46.173
> 
> 标签：c++, class, overriding, abstract-class, derived-class

如果我有这样的基类：

```
class Base {
    public:
        Base(){}
        virtual void foo()=0;
}; 
```

现在，如果我从 Base 类派生出任何类，它将不得不覆盖`foo()`.

如果我也想要`foo()`Base 类的行为怎么办？所以这个基类有它自己的`foo`，最重要的是，它的每一个都必须覆盖`foo`？那可能吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-27T21:09:30.257

如果您执行以下操作：

```
class Base {
    public:
        Base(){}
        virtual void foo() = 0;
};
void Base::foo() {
{ 
     cout << "Hello";
} 
```

您将获得一个抽象类，因此您将*无法*创建 Base 类的对象 b 并通过调用 b.foo() 让它使用您的 foo() 实现。

所以这不是你想要的！下一个问题是，如果您永远无法使用它，为什么允许您为 Base::foo 提供实现。好吧，其实你可以！虽然不是直接的。

```
class Deriv : public Base {
    public:
        Deriv(){}
        virtual void foo();
};
void Deriv::foo() 
{ 
     Base::foo(); cout << "  world!";
} 
```

如您所见，派生类可以使用 Base::foo( *)*。

回到你的问题。答案是您*可以*完全按照您指定的方式进行操作，除了 Base 类将是抽象的。

另一种方法是做大多数人做的事情，而不是在 Base.xml 中为 foo() 提供实现时指定 =0。这意味着派生类*可以*覆盖 foo() 但不是*必须*的。在我看来，这实际上是完全有道理的：在 Base::foo() 的默认实现有意义的派生类中，你保留它，但对于那些需要不同的东西，你覆盖它。

更新：我试图想出一个实际需要问题所问的场景并想出了这个：

想象一下 Document 及其派生类表示文档类型，并且 Document 包含一个虚拟方法 getClassIcon()，它返回表示文档类型的图标的图像文件的 URL。Document 有一个图标（代表通用文档的东西）是有意义的，并且要求所有派生类重写 getClassIcon() 以提供它们自己的图标也是有意义的。

话虽如此，在这个特定示例中，似乎很容易找到替代设计：使 Document::getClassIcon() 成为纯虚拟方法 (=0)（使 Document 成为抽象类）并将 OtherDocument 添加为其派生类之一，给出它以前执行过 getClassIcon Document 。PDFDocument、MSWordDocument 等都需要根据需要覆盖 getClassIcon()。这种重新设计可能会揭示的是，以前的设计（由允许问题所要求的 C++ 的虚构版本支持）将基类的角色、文档和类地位的角色混为一谈对于不属于任何已知类型的文档，OtherDocument。当然，这一切都在旁观者的眼中：-) 有人可能会争辩说，第二种设计仅仅是必要的，因为语言中缺少功能。我想我们（在很大程度上）根据我们所说的（计算机）语言来思考。:-)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T20:21:59.527

您可以为纯虚拟方法提供一个实现：

```
class Base {
  ...
  virtual void foo()=0;
}

void Base::foo() {
     ... implementation goes here ...
} 
```

该类仍然是抽象的。如果您不希望它抽象，则必须删除`=0`. 但是，一旦这样做，就不能强制派生类提供它们自己的实现。

换句话说，你必须做出选择。

# java - ListActivity TwoLineListItem 替代方案

> ID：13592371
> 
> 赞同：14
> 
> 时间：2012-11-27T20:20:51.430
> 
> 标签：java, android, listactivity

我注意到 TwoLineListItem 自 API 17 起已弃用。如果我按如下方式设置 ListActivity 适配器，有什么替代方法？：

```
ArrayAdapter<File> adapter = new ArrayAdapter<File>(this,android.R.layout.simple_list_item_2,filesArrayList){
            @Override
            public View getView(int position, View convertView, ViewGroup parent){
                final TwoLineListItem row;
                if(convertView == null){
                    LayoutInflater inflater = (LayoutInflater)getApplicationContext().getSystemService(Context.LAYOUT_INFLATER_SERVICE);
                    row = (TwoLineListItem)inflater.inflate(android.R.layout.simple_list_item_2, null);
                }else{
                    row = (TwoLineListItem)convertView;
                }
                row.getText1().setText(filesArrayList.get(position).getTitle());
                row.getText2().setText2(filesArrayList.get(position).getDescription());
                return row;
            }

        }; 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-27T20:27:28.913

只需将 TwoLineListItem 源代码剪切并粘贴到您自己的布局中：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:orientation="vertical">

    <TextView android:id="@+id/text1"
        android:textSize="16sp"
        android:textStyle="bold"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"/>

    <TextView android:id="@+id/text2"
        android:textSize="16sp"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"/>

</LinearLayout> 
```

（请注意，我更改了 id 以保持一致性。）

现在使用一个 ViewHolder 来保持对两个 TextView 的引用：

```
public View getView(int position, View convertView, ViewGroup parent){
    ViewHolder holder;
    if(convertView == null){
        // You should fetch the LayoutInflater once in your constructor
        LayoutInflater inflater = (LayoutInflater)getApplicationContext().getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        convertView = inflater.inflate(R.layout.list_item_2, null);

        // Initialize ViewHolder here
    }else{
        holder = (ViewHolder) convertView.getTag();
    }

    File file = filesArrayList.get(position);
    holder.text1.setText(file.getTitle());
    holder.text2.setText2(file.getDescription());
    return convertView;
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-03T20:05:06.327

我是这样做的：

> ```
>  mAdapter = new ArrayAdapter<String>(getActivity(), android.R.layout.simple_list_item_2, mListItems)
>     {
>         @Override
>         public View getView(int position, View convertView, ViewGroup parent)
>         {
>             View row;
>             if(convertView == null)
>             {
>                 row = (View)mInflater.inflate(android.R.layout.simple_list_item_2, parent, null);
>             }
>             else
>             {
>                 row = (View)convertView;
>             }
>             TextView v = (TextView) row.findViewById(android.R.id.text1);
>             v.setText(mListItems[position]);
>             v = (TextView) row.findViewById(android.R.id.text2);
>             v.setText(mListSubItems[position]);
>             return row;
>         }
>     }; 
> ```

```
 ListView lv = (ListView) getActivity().findViewById(R.id.runsListView);
    lv.setAdapter(mAdapter);
    lv.setOnItemClickListener(mMessageClickedHandler); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-19T18:39:33.537

First 已被弃用，因此这对您来说并不算太糟糕。因为它将永远受到支持。;)

***[如果它没有坏，就不要修理它。](https://en.wiktionary.org/wiki/if_it_ain%27t_broke,_don%27t_fix_it)***

您可以自由使用任何布局！如果您使用模式选择，**只需添加一些背景来响应所选状态，例如：**

```
android:background="?android:attr/activatedBackgroundIndicator" 
```

# php - Magento：随着购物车商品数量的增加，性能下降

> ID：13592380
> 
> 赞同：4
> 
> 时间：2012-11-27T20:21:27.180
> 
> 标签：php, oop, magento

运行 Magento Enterprise 1.9，我注意到购物车中有 20 多件商品，网站变得*非常*缓慢。比如，“10 秒加载一个页面”很慢。当我将其增加到 100 个项目时，该网站变得完全无法使用。

这甚至不在购物车或结帐页面上！它在任何页面上。

我可以做些什么来减轻这种性能影响：

1) 在全球范围内，在所有页面上？

和

2) 在购物车/结帐页面上？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-28T01:14:27.820

太多的观察者观察和评论他们在购物车中观察到的每条产品线。如果你不做可下载的产品或乱搞 RSS，这些模块可以在它们的控制文件中设置为 active=false 来关闭模块，让观察者去牧场并加速购物车功能。

他们的开销是惊人的......随着行数的增加，结账速度会呈指数级增长。

`app/etc/modules/Mage_Downloadable.xml`将**<active>**行设置为`false`.

`app/etc/modules/Mage_All.xml`找到Mage_Rss 的**<active>**行并设置为`false`

Rafael Kassner 提出了造成这种情况的原因[http://www.kassner.com.br/en/2011/01/07/magento-slow/](http://www.kassner.com.br/en/2011/01/07/magento-slow/)

标准免责声明、YMMV、在开发服务器上进行测试等，然后在您的实时服务器上释放。

[http://www.magentocommerce.com/boards/v/viewreply/306872/](http://www.magentocommerce.com/boards/v/viewreply/306872/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T20:46:02.937

Magento 是一个非常复杂和灵活的系统，因为它的 MVC 系统和 EAV 数据库结构，但因此它非常耗费资源。您需要优化您的服务器以处理此问题。这些有用的指南是[http://www.magentocommerce.com/whitepaper/](http://www.magentocommerce.com/whitepaper/)。考虑 apache、mysql 和 php 设置。

除此之外，您还需要像 APC 或 Memcached 这样的缓存系统来停止在每个请求上加载所有 magento 文件。根据流量、并发用户等，您将需要一个强大的服务器。我正在运行一个具有 16GB 内存的专用四核 ubuntu 服务器和一个专用数据库服务器来运行我的商店。

关于 100 件商品的购物车，这真的可能发生吗？在购物车页面上，magento 将从数据库中加载所有 100 种产品，这将非常密集，因此如果发生这种情况，您需要查看上述所有要点。

安装 APC 非常简单，并且会立即产生戏剧性的效果。另一方面，调整服务器更多的是尝试错误。互联网上有很多工具可以帮助解决这个问题，我会首先使用负载影响测试来查看它一次可以处理多少用户以及每秒的请求数等。

还有一些模块可以开始缓存整个页面，但不确定这是否有助于您的 100 件购物车场景，这主要是我认为的数据库瓶颈。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-28T16:10:39.463

我认为这与 Magento 如何使用其属性有关。放慢速度的不是数据库请求本身（总共大约 0.06 秒）。

我遇到了同样的问题，而且可配置的产品也很慢。

我发现一些网页的代码可以优化属性处理。（这当然意味着更多的内存缓存:-)

# html - HTML 5 缓存：window.applicationCache.abort(); 不工作

> ID：13592382
> 
> 赞同：4
> 
> 时间：2012-11-27T20:21:27.270
> 
> 标签：html, html5-appcache

我正在开发一个带有离线模式的小型移动 WebApp。如果清单文件已更改，有什么方法可以防止自动更新？如果用户的互联网连接不好，他不应该被迫下载所有文件，而是应该收到一条消息，以便他以后可以更新文件。

我试过

```
window.addEventListener('load', function(e) {    
  window.applicationCache.addEventListener('ondownloading', function(e) {
      window.applicationCache.abort();
  }, false);
}, false); 
```

但它不起作用。在 Safari 6.0.2 和 Chrome Canary 中都没有。

只有当用户使用以下代码手动单击我的“更新”按钮时，应用程序才应该更新文件：

```
var appCache = window.applicationCache;
appCache.update();

if (appCache.status == window.applicationCache.UPDATEREADY) {
  appCache.swapCache();  // The fetch was successful, swap in the new cache.
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-07-28T20:30:16.610

雅法的回答不起作用。（至少在铬）。

无论我们做什么，appcache 都会自动更新，因此控制客户端何时从服务器获取更新的唯一方法是在每个客户端（每个浏览器）的基础上管理每个缓存清单。

浏览器将需要创建一个 BrowserID GUID 并将其存储在 localStorage 中。当它请求缓存清单时，它应该在 URL 中包含 browserID。当服务器发送缓存清单时，它会将其缓存在服务器端。对清单的每个后续请求都会返回缓存的版本。

当用户按下 Sync 按钮时，浏览器会发送一个包含浏览器 ID 的 Cache Bust 请求。这会导致具有该 BrowserID 的下一个缓存清单请求返回更新的清单，而不是缓存的版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-13T14:13:07.210

您不需要将`downloading` `addEventListener`调用包装在`window` `load`事件中，`applicationCache`对象从一开始就在那里。

你正在监听一个`ondownloading`事件，但没有一个名为那个的事件，你不需要`on`.

`checking`但是，您可能希望通过事件更快地捕获更新过程。您也不必打电话`abort`，因为该`checking`事件是可以取消的。

```
var blockUpdates = true;

window.applicationCache.addEventListener('updating', function(event) {
    if (blockUpdates) {
        event.preventDefault();
    }
}, false);

function updateButtonPressed() {
    blockUpdates = false;
    window.applicationCache.update();
}

window.applicationCache.addEventListener('updateready', function() {
    // but what do we do here?
}, false); 
```

但是当你有更新时你应该怎么做？`swapCache`将使用更新的缓存，但仅适用于新请求，您可能已经在页面上获得了旧文件。用新资产替换旧资产的最简单方法是重新加载页面。您可以自动执行此操作，但这可能会对用户造成干扰，最好告诉他们有更新准备好，并提供一个重新加载页面的按钮。

# javascript - 如何检索css3旋转中的角度？

> ID：13592384
> 
> 赞同：9
> 
> 时间：2012-11-27T20:21:30.593
> 
> 标签：javascript, jquery, css

我有以下代码设置元素的旋转角度：

```
$('#1-link-2')
                .css('height', length)
                .css('-webkit-transform', 'rotate(' + angle + 'deg)')
                .css('-moz-transform', 'rotate(' + angle + 'deg)')
                .css('-o-transform', 'rotate(' + angle + 'deg)')
                .css('-ms-transform', 'rotate(' + angle + 'deg)')
                .css('transform', 'rotate(' + angle + 'deg)'); 
```

其中角度是先前动态计算的（它基于鼠标的位置）。

我需要能够检索角度。我为初学者尝试了这个：

```
var angle= $("#1-link-2").css('-webkit-transform');
    $('#node-title').html(angle);   //just to print it to the screen for me 
```

它给了我这个文本

```
matrix(0.5425908601788315, -0.839997118120292, 0.839997118120292, 0.5425908601788315, 0, 0) 
```

如何检索以度为单位的角度？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T00:40:34.550

第一个值是旋转角度的余弦值，第二个值是旋转角度的正弦值 - 只要您没有在该元素上累积任何变换。使用您最喜欢的数学库来计算反正弦和余弦。

.54 的反余弦为 54ish 或 306 度。-0.83 的反正弦是 234ish 或 306 度。

哎，正确答案一定是306度。

如果您忘记了几何，这里[是复习。](http://www.regentsprep.org/Regents/math/algtrig/ATT7/sincostan.htm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-11-06T04:19:01.847

看到这个[帖子](https://css-tricks.com/get-value-of-css-rotation-through-javascript/)：

```
var el = document.getElementById("thing");
var st = window.getComputedStyle(el, null);
var tr = st.getPropertyValue("-webkit-transform") ||
         st.getPropertyValue("-moz-transform") ||
         st.getPropertyValue("-ms-transform") ||
         st.getPropertyValue("-o-transform") ||
         st.getPropertyValue("transform") ||
         "FAIL";

// With rotate(30deg)...
// matrix(0.866025, 0.5, -0.5, 0.866025, 0px, 0px)
console.log('Matrix: ' + tr);

// rotation matrix - http://en.wikipedia.org/wiki/Rotation_matrix

var values = tr.split('(')[1].split(')')[0].split(',');
var a = values[0];
var b = values[1];
var c = values[2];
var d = values[3];

var scale = Math.sqrt(a*a + b*b);

console.log('Scale: ' + scale);

// arc sin, convert from radians to degrees, round
var sin = b/scale;
// next line works for 30deg but not 130deg (returns 50);
// var angle = Math.round(Math.asin(sin) * (180/Math.PI));
var angle = Math.round(Math.atan2(b, a) * (180/Math.PI));

console.log('Rotate: ' + angle + 'deg'); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-07-17T12:28:16.940

```
function getRotationDegrees(obj) {
  var matrix = obj.css("-webkit-transform") ||
  obj.css("-moz-transform")    ||
  obj.css("-ms-transform")     ||
  obj.css("-o-transform")      ||
  obj.css("transform");
  if(matrix !== 'none') {
    var values = matrix.split('(')[1].split(')')[0].split(',');
    var a = values[0];
    var b = values[1];
    var angle = Math.round(Math.atan2(b, a) * (180/Math.PI));
  } else { var angle = 0; }
  return (angle < 0) ? angle +=360 : angle;
}

angle1 = getRotationDegrees($('#1-link-2')); 
```

# c# - 将 Word 导出到 XPS c#

> ID：13592388
> 
> 赞同：1
> 
> 时间：2012-11-27T20:21:40.653
> 
> 标签：c#, ms-word, xps

作为应用程序的一部分，我需要一个窗口，用户可以在其中以一种对他们来说很清楚它是只读的方式来预览 Office 文档。此外，窗口只是屏幕的一部分，因此使用功能区打开完整版的 Office 应用程序需要一点空间。用户将浏览大量文档，因此必须快速，速度是关键。

我发现了这一点，在谷歌、这个网站和其他网站的大力帮助下：它以只读方式显示文档；查看。它将 xpsfil 发送回 Windows 窗体以进行查看，而不会占用屏幕上的空间；查看。速度; 哦不。太慢了。有没有人知道一种更好的快速查看办公文档的方法，并且对用户来说显然是只读的？帮助很大

```
 private readonly string TEMP = Environment.ExpandEnvironmentVariables("%tmp%");
    private  object nullObject = Type.Missing;

    private string ConvertWordtoXps(string wordDocName)
    {
        Microsoft.Office.Interop.Word.Application wordApp = new Microsoft.Office.Interop.Word.Application();
        wordApp.Documents.Open(wordDocName, ConfirmConversions: false, ReadOnly: true);
        string xpsFileName = String.Concat(TEMP, "\\", Path.GetFileNameWithoutExtension(wordDocName), ".xps");

        try
        {
            //wordApp.ActiveDocument.ExportAsFixedFormat(xpsFileName, WdExportFormat.wdExportFormatXPS, false, WdExportOptimizeFor.wdExportOptimizeForOnScreen, WdExportRange.wdExportAllDocument, 1, 1, WdExportItem.wdExportDocumentContent, false, true, WdExportCreateBookmarks.wdExportCreateNoBookmarks, false, true, false, nullObject);
            wordApp.ActiveDocument.SaveAs2(xpsFileName, FileFormat: WdSaveFormat.wdFormatXPS);
            return xpsFileName;
        }
        catch (Exception e)
        {
            MessageBox.Show(e.Message);
        }
        finally
        {
            ((Microsoft.Office.Interop.Word._Application)wordApp).Quit(SaveChanges: false, OriginalFormat: nullObject, RouteDocument: nullObject);
        }
        return null;

    } 
```

# string - 如何知道段落中出现最多的单词是什么？(Matlab)

> ID：13592390
> 
> 赞同：3
> 
> 时间：2012-11-27T20:21:53.243
> 
> 标签：string, matlab, octave

我有一个很大的段落，想知道其中出现最多的单词是什么。谁能指出我正确的方向？任何示例和解释都会有所帮助。谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T21:05:32.397

这是一种非常 MATLAB-y 的方法。我试图清楚地命名变量。玩弄每一行并检查结果以了解其工作原理。主力功能：`unique`和`hist`

```
% First produce a cell array of words to be analyzed
paragraph_cleaned_up_whitespace = regexprep(paragraph, '\s', ' ');
paragraph_cleaned_up = regexprep(paragraph_cleaned_up_whitespace, '[^a-zA-Z0-9 ]', '');
words = regexpi(paragraph_cleaned_up, '\s+', 'split');

[unique_words, i, j] = unique(words);
frequency_count = hist(j, 1:max(j));
[~, sorted_locations] = sort(frequency_count);
sorted_locations = fliplr(sorted_locations);
words_sorted_by_frequency = unique_words(sorted_locations).';
frequency_of_those_words = frequency_count(sorted_locations).'; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T22:06:04.933

这是一个简单的解决方案，应该很快。

```
example_paragraph = 'This is an example corpus. Is is a verb?';

words = regexp(example_paragraph, ' ', 'split');
vocabulary = unique(words);
n = length(vocabulary);
counts = zeros(n, 1);
for i=1:n
    counts(i) = sum(strcmpi(words, vocabulary{i}));
end

[frequency_of_the_most_frequent_word, idx] = max(counts);
most_frequent_word = vocabulary{idx}; 
```

您还可以[在此处](https://stackoverflow.com/q/11555527/1705967)查看答案，以从单词数组中获取最常见的单词。

# java - 如何设计一个 Web 解析器来与 Applet 交互？

> ID：13592391
> 
> 赞同：0
> 
> 时间：2012-11-27T20:21:56.413
> 
> 标签：java, applet, web-scraping

对不起，如果我的问题很简单，但我想知道是否可以以编程方式与小程序交互，读取它提供的输出（一种网络抓取）。

假设某个网站公开了一个小程序，是否可以通过 Java 等编程语言通过 POST/GET 请求（或其他类似方式）从中提取内容。我的交互是“像黑匣子一样”，因为我无法访问服务器环境。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T21:05:15.847

不明白你的意思。小程序是`Swing`在浏览器上下文中运行的应用程序，当您“点击”小程序的 URL 时，浏览器实际上会下载相应的 jar。
但是有一些方法可以“操纵”小程序，例如按下按钮或以编程方式获取值，这就是自动化 UI 套件所做的。老实说，我不知道他们是怎么做到的。似乎是动态的反编译和分析

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T21:07:20.937

不确定通过 JavaScript 进行的通信是否适合您，但您可以从 JavaScript 调用小程序中的任何公共方法，如下所示：

<applet 名称=myapplet ...> </applet>

你的小程序可能有这样的方法：

public String returnAString() {
return "这是一个字符串";
}

因此，要从该方法中获取值，您可以这样调用它：

var stringFromApplet = document.myapplet.returnAString();

您还可以像这样从小程序调用回您的 JavaScript：

getAppletContext().showDocument("javascript:myJavaScriptMethod()");

# python - 用于在 Ruby 或 Python 中操作 Excel 和 Libreoffice Calc 表的库

> ID：13592393
> 
> 赞同：0
> 
> 时间：2012-11-27T20:22:04.883
> 
> 标签：python, ruby, excel, libraries, libreoffice

我有两个不同的电子表格，其中包括学生项目组的成绩和另外三个电子表格，其中包括与部分相关的学生 ID。

我想将这两张不同的表格结合起来，在他们的 ID 附近给出学生的个人成绩。我打算编写一个脚本而不是手动执行。因此，我正在寻找一个与 Ruby 或 Python 一起使用的好库。有没有这样的图书馆可以满足我的目的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T21:20:48.367

这看起来已经在这里回答了[Python - Reading a spreadsheet](https://stackoverflow.com/questions/10227200/python-reading-a-spreadsheet)

我认为保存为 .csv 并使用 python 内置的 .csv 支持是最好的选择：[http ://docs.python.org/library/csv.html](http://docs.python.org/library/csv.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T21:39:37.790

Python 库：
* 对于 ODS 文件，您可以尝试：[http](http://simple-odspy.sourceforge.net/)
://simple-odspy.sourceforge.net/ * 对于 Excel 文件：[http ://scienceoss.com/read-excel-files-from-python/](http://scienceoss.com/read-excel-files-from-python/)

# shopify - Shopify - 有没有办法确定 api 响应中的折扣代码类型

> ID：13592396
> 
> 赞同：0
> 
> 时间：2012-11-27T20:22:36.987
> 
> 标签：shopify

当折扣代码应用于订单时，它们在订单中的引入方式是 2 字段数组，代码和金额。不过，在管理界面中，Shopify 用户可以选择代码类型是绝对金额、百分比还是免费送货。

在 api 响应中，有没有办法确定使用的代码是免费送货还是其他代码？这导致我们的同步出现问题，因为与一般订单行项目相比，不同地点的运费处理方式不同。

谢谢你，布兰登

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T21:02:45.893

**简短**的回答：不，你无法区分。

**长答案**：在内部，免费送货代码实际上应用于购物车中的项目，直至所选送货方式的价值，然后将运费金额应用于顶部。

这样做的结果是 Shopify 上存储的三种折扣类型之间没有区别。它们都只是从订单小计中扣除的美元金额。因此，您无法判断运费是否打折，因为从来没有打折。

# android - 使用 Robotium 进行跨活动测试

> ID：13592397
> 
> 赞同：1
> 
> 时间：2012-11-27T20:22:40.610
> 
> 标签：android, testing, android-activity, robotium, accounts

我必须编写一个测试，基本上打开 Android->Accounts and sync -> Add Accounts -> *（然后填写登录信息）* 并返回 Accounts and sync 并检查是否已添加帐户。

目前我能做的最好的事情是创建一个打开Android添加帐户的测试然后我必须手动添加帐户然后我对打开帐户和同步页面进行自动测试然后另一个测试检查我是否能够发送REST -http 调用我的服务器，显示已添加帐户。

我想知道是否有办法让它在一个流程中工作并自动化整个过程。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T21:04:02.117

您可以使用使用 monkeyrunner 的[AndroidViewClient 。](http://dtmilano.blogspot.com/)通过这样做，您将可以控制整个设备，而不仅仅是您的应用程序。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-29T22:00:45.503

您可能想要的是使用来自 android 的新的 android 测试框架。

[http://developer.android.com/tools/testing/testing_ui.html](http://developer.android.com/tools/testing/testing_ui.html)

# c - 我如何理解这个 C 类型声明？

> ID：13592400
> 
> 赞同：5
> 
> 时间：2012-11-27T20:22:45.440
> 
> 标签：c, declaration

```
double (*bar(int, double(*)(double,double[])))(double); 
```

在查看演讲幻灯片时，我发现留给学生的练习：

> `bar`简单来说，这个 C 声明中的类型是什么？

*请*帮助我完成这个。我什至不知道从哪里开始，除了某些东西最终会返回双倍。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-27T20:26:50.787

如果您不确定是否始终可以使用 K&R 中描述的 cdecl 实用程序，如下所示：

```
$ cdecl
Type `help' or `?' for help
cdecl> explain double (*bar(int, double(*)(double,double[])))(double);
declare bar as function 
(int, pointer to function (double, array of double) returning double)
returning pointer to function (double) returning double 
```

所以 bar 是一个函数，它接受一个`int`和一个指向一个函数的指针，该函数接受一个`double`并`double[]`返回一个`double`：

```
double(*)(double,double[])) 
```

bar 返回一个指向另一个函数的指针，该函数接受 a`double`并返回 a`double`

```
double(*)(double) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-27T20:57:49.430

[这个答案是通过使用螺旋法则](http://c-faq.com/decl/spiral.anderson.html)的能力带给你的。能够通过从未知元素开始并阅读它来理解复杂的表达式（首先解决括号中的问题）。阅读代码时非常有用的技能。

```
 bar                                            - bar
        bar()                                          - is a function
        bar(int, )                                     - which takes an int...
        bar(int, (*)())                                - and a function pointer
        bar(int, double(*)())                          - which returns a double
        bar(int, double(*)(double, ))                  - and takes a double...
        bar(int, double(*)(double, double[]))          - and an array of doubles
      (*bar(int, double(*)(double, double[])))         - and returns a pointer
      (*bar(int, double(*)(double, double[])))()       - to a function
      (*bar(int, double(*)(double, double[])))(double) - taking a double
double(*bar(int, double(*)(double, double[])))(double) - which returns a double 
```

那是艰难的方式......当然有一些网站可以让这更容易，例如[cdecl](http://cdecl.org/)网站；但是，即使您无法上网，也能够阅读代码是件好事。

# objective-c - 拖动 UIScrollView 时的 EXC_BAD_ACCESS

> ID：13592405
> 
> 赞同：1
> 
> 时间：2012-11-27T20:23:22.960
> 
> 标签：objective-c, ios, uiscrollview, uiscrollviewdelegate

在控制器中，我正在创建一个 UIScrollView。我正在尝试将此视图控制器设置为 UISCrollview 委托并实现委托的方法以添加（稍后）UIPageControl。

我读了一些，发现[了这个链接](https://stackoverflow.com/questions/3686803/uiscrollview-exc-bad-access-crash-in-ios-sdk)，[这个其他链接](https://stackoverflow.com/questions/13082157/uiscrollview-does-not-work-with-exc-bad-access)和其他链接，还有一些有用的教程在网络上，但我不明白我做错了什么。每次滚动 UIScrollView 时，应用程序都会因 EXC_BAD_ACCESS 错误而崩溃。

这是我的 .h 文件

```
#import <UIKit/UIKit.h>

@interface StatsViewController : UIViewController <UIScrollViewDelegate> {
     UIScrollView *scrollView;
     UIPageControl *pageControl;
}

@end 
```

然后在我的 .m 文件中，我正在创建滚动视图并尝试像这样定义委托方法：

```
- (void)viewDidLoad {
     [super viewDidLoad];
     NSInteger boxWidth = self.view.frame.size.width;
     NSInteger boxHeight = 412;
    scrollView = [ [UIScrollView alloc] initWithFrame:CGRectMake(0, 0,      self.view.frame.size.width, boxHeight)];
    scrollView.pagingEnabled = TRUE;
    scrollView.delegate = self;

     NSInteger numberOfViews = 2;

    StatBreatheCounter *breatheCounter = [ [StatBreatheCounter alloc] init];
    breatheCounter.view.frame = CGRectMake(0, 0, boxWidth, boxHeight);
    [scrollView addSubview:breatheCounter.view];

    BreatheLocationViewController *breatheLocation = [ [BreatheLocationViewController alloc] init];
    breatheLocation.view.frame = CGRectMake(320, 0, boxWidth, boxHeight);
    [scrollView addSubview:breatheLocation.view];

     scrollView.contentSize = CGSizeMake(self.view.frame.size.width * numberOfViews, boxHeight);
     [self.view addSubview:scrollView]; 
```

}

```
 - (void)scrollViewDidScroll:(UIScrollView *)sender {
     NSLog(@"RUNNING");
 } 
```

...但是每次我在滚动视图上滑动时，应用程序都会崩溃。现在，我在 Ojective-C 上相当出色，但我觉得我错过了一些东西。浏览所有内容表明委托可以提前释放，并且当用户触发操作时，没有人在处理该方法（抱歉解释:)）。...但是如果委托它是视图控制器本身，它怎么能被释放呢？

如您所见，我很困惑:(任何帮助将不胜感激

- 编辑：我将在此处包含建立的解决方案，感谢您的评论和回答。当我发布我的问题时，我非常确信错误来自我创建 UIScrollView 并设置其委托的方式，以至于我没有意识到问题是（正如一切所暗示的那样，顺便说一句:)）我正在分配StateViewController 在其父级中没有声明对它的任何“强”引用（再次，抱歉解释，我真的是一个 n00b）。非常感谢您帮助我指出正确的方向

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T21:44:36.410

看起来您在滚动期间失去了对委托的引用。我会调查 StatsViewController 周围的任何其他发布事件或其他可能导致它被取消引用的事件。

# jquery - 单击按钮时的jquery对话框

> ID：13592408
> 
> 赞同：5
> 
> 时间：2012-11-27T20:23:35.973
> 
> 标签：jquery, jquery-ui

我试图让一个 jquery 对话框在单击按钮时启动，但似乎没有工作。任何帮助，将不胜感激：

```
 $('#wrapper').dialog({
        autoOpen: false,
        title: 'Basic Dialog'
    });
    $('#opener').click(function() {
        $(this).dialog('open');
        return false;
    }); 
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script src="https://code.jquery.com/ui/1.12.0/jquery-ui.min.js"></script>
<button id="opener">Open the dialog</button>
    <div id="wrapper">
    <p>Some txt goes here</p>
    </div>
```

谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-27T20:27:09.537

这条线

```
$(this).dialog('open');  // this here corresponds to the #opener div 
```

应该是

```
$('#wrapper').dialog('open'); 
```

还有额外的大括号.. 如果这是**DOM** Ready 处理程序`});` 的右大括号，则可以忽略

 ****[检查小提琴](http://jsfiddle.net/sushanth009/cWG2w/)**

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T20:31:04.317

确保您引用了 jQuery 和 jQueryUI 库，如下面的示例所示。

尝试这个：

```
<html>
    <head>
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
        <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.8.23/jquery-ui.min.js"></script>
        <link href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.23/themes/smoothness/jquery-ui.css" rel="stylesheet" type="text/css" media="all" />

        <script type="text/javascript">
            $(document).ready(function() {

                $('#wrapper').dialog({
                    autoOpen: false,
                    title: 'Basic Dialog'
                });
                $('#opener').click(function() {
                    $('#wrapper').dialog('open');
//                  return false;
                });
            });
        </script>
    </head>
<body>

<button id="opener">Open the dialog</button>
<div id="wrapper">
    <p>Some txt goes here</p>
</div> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-04-02T10:04:17.320

试试这个代码，它对我有用。

```
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>jQuery UI Dialog - Default functionality</title>
<link rel="stylesheet" href="http://code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
<script src="http://code.jquery.com/jquery-1.10.2.js"></script>
<script src="http://code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
<link rel="stylesheet" href="https://jqueryui.com/resources/demos/style.css">
<script>
$(document).ready(function() {
  $(function() {
    console.log('false');
    $( "#dialog" ).dialog({
        autoOpen: false,
        title: 'Test'
    });
  });

  $("button").click(function(){
    console.log("click");
        $(this).hide();
        $( "#dialog" ).dialog('open');
    });
}); 
</script>
</head>
<body>
<button id="open">Open Dialog box</button> 
<div id="dialog" title="Basic dialog">
<p>This is the default dialog which is useful for displaying information. The dialog window can be moved, resized and closed with the 'x' icon.</p>
</div>
</body>
</html> 
```**

# windows - openerp gtk 客户端 6.1 - 表单选项卡标签

> ID：13592411
> 
> 赞同：2
> 
> 时间：2012-11-27T20:23:54.397
> 
> 标签：windows, gtk, client, openerp

在新的 openERP gtk 客户端 6.1 中，一个新功能有时会引起混乱。**表单视图**中某条记录的**标签标签**现在是这样的：

 **`Object: (Id, Name)`

而不是好的'ol

`Object`

有时它只是添加记录的名称而不是名称和 ID，这取决于对象的名称是否是 many2one 字段。
我一直试图查明在新的 gtk 客户端代码中添加的位置，但我找不到它。我认为它在 /bin/widget/view/form_gtk 但我不确定。

另一件事，一旦你的好人告诉我新代码添加在哪里，在基于 linux 的操作系统上修改客户端很容易，但是如何在 windows 上修补客户端而不是构建新的 exe 安装程序？如果有人能就此事分享一些见解，我将不胜感激。我已经在启动板上看到了这个[Create exe open erp client GTK](https://code.launchpad.net/~openerp/openerp/win-installer-trunk)，但是当我在 XP 上一步一步地跟随它时，我遇到了错误。我认为它已经过时了。提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T05:03:31.017

在项目 lp:openerp-tools 你会找到解决方案。有创建.exe 的官方脚本。

顺便说一句，您不需要重新创建 .exe，您可以在 Windows 上将 python 作为脚本运行（就像在 Linux 中一样，我从不支持 Windows，但我知道在最终客户端中这是常见的问题。

问候，我希望它可以帮助你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-10T04:20:32.177

不...

在 openerp-tools 中构建 .exe 的工具，而不是标签问题，如果你知道一点 python + gtk，这真的很容易。

但是顺便说一句，如果您为未来需要像您这样的人发布您找到的解决方案，那应该很酷......

问候。**

# ruby-on-rails - 基于路由设置外键关联

> ID：13592413
> 
> 赞同：0
> 
> 时间：2012-11-27T20:24:03.133
> 
> 标签：ruby-on-rails, ruby-on-rails-3

这是我现在的代码...

```
class Article < ActiveRecord::Base
  has_many :registrations

class Registration < ActiveRecord::Base
  belongs_to :article

#app/views/articles/show.html.erb
    <%= link_to 'Register', new_registration_path({:article_id => @article}) %>

#app/views/registrations/_form.html.erb
  <%= f.hidden_field :article_id %>

#app/controllers/registrations_controller.rb
 def new
    @registration = Registration.new
    @registration.article = Article.find params[:article_id] 
```

..这很管用。但是，我想摆脱 app/views/articles/show.html.erb 中的代码并使用路由来执行此操作...

```
 <%= link_to 'Register', new_article_registration_path(@article) %> 
```

...而且我还想摆脱我在注册视图中使用的 hte hidden_​​field。我知道我需要向我的控制器添加一个构建方法，但我不确定是否应该将它添加到文章或注册控制器。任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T20:48:16.040

在你的`routes.rb`你可以制作嵌套资源：

```
resources :articles do
  resources :registrations
end 
```

然后你可以在你的助手中使用[polymorphic_url](http://api.rubyonrails.org/classes/ActionDispatch/Routing/PolymorphicRoutes.html#method-i-polymorphic_url)方法的“魔法”来创建你的链接：`link_to`

```
<%= link_to 'Register', [:new, @article, :registration] %> 
```

# image - drupal中的图像显示

> ID：13592417
> 
> 赞同：0
> 
> 时间：2012-11-27T20:24:26.673
> 
> 标签：image, drupal, gallery

我想在 drupal 的主页上创建一个图片库。每个图像都将由用户上传，并且据我所知，将保存在 drupal 的某个图像目录文件夹中。我的问题涉及我最近收到的一个提示，以回应一般性辩论是否将图像存储为 mysql 中的 blob 是否好。提示是将图像的文件名存储在 mysql 中，这样您基本上仍然可以对文件进行排序。我想知道即使文件 url 可以这么说，这是否可能。应该有可能不是吗？我是编程新手，您看到并希望根据定义的排序功能定期刷新我主页上的图像。我将不胜感激对这个问题的任何回应。干杯。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T08:08:04.277

您可以使用内容类型和视图模块在 Drupal 7 中创建图库。

1.  首先使用图库名称（admin/structure/types/add）创建新的内容类型。
2.  然后将图像字段添加到图库内容类型并保存。
3.  如果你想要图像的缩略图，你应该创建一个图像样式。例如，使用 thumbnail_custom 名称创建图像样式并添加合适的效果（admin/config/media/image-styles/add）。您将在下一步的视图中使用此图像样式。
4.  然后创建一个具有画廊视图名称的新视图。取消选中创建页面，选中创建块，输入块标题和您想要的每页项目（管理员/结构/视图/添加）。
5.  在来自块详细信息的过滤条件中，添加内容类型库。
6.  在字段中添加出现在 node:gallery 中的内容图像，然后选择 thumbnail_custom 作为图像样式选项。
7.  保存视图。
8.  此视图块出现在块部分中，您可以为其选择区域。
9.  如果您希望此块仅出现在首页，请在可见性设置的部分页面中配置此块，选中“仅列出的页面”选项，然后`<front>`在 textarea 中输入“”短语。

# jquery - 选择带有类的 div，除非它有另一个类的祖先

> ID：13592423
> 
> 赞同：1
> 
> 时间：2012-11-27T20:24:59.453
> 
> 标签：jquery

十分钟前问了这个问题，但意识到我使用了“父母”一词而不是“祖先”。我正在寻找指代具有特定祖先的类的东西。

如何选择没有特定类的父级的所有输入？

在这里，我只想获取没有父类的输入

```
$(document).ready(function() {

    $("div:not(.not-ancestor) > input[type='text']").css('color', '#FF1200');
});​ 
```

[http://jsfiddle.net/MFtv3/3/](http://jsfiddle.net/MFtv3/3/)

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T20:31:07.753

您可以使用过滤器并使用最接近（）来检查元素上方是否有父元素以及您要查找的类，如下所示：

```
$("div > input[type='text']").filter(function() {
    return !$(this).closest('.not-ancestor').length;
}).css('color', '#FF1200'); 
```

[**小提琴**](http://jsfiddle.net/MFtv3/6/)

**编辑**

要获取元素集合以供进一步使用：

```
var elems = $("div > input[type='text']").filter(function() {
                return !$(this).closest('.not-ancestor').length;
            });

elems.css('color', 'red');
elems.each(function(idx, elem) {
    $(elem).data('index', idx);
}); 
```

# vb.net - 调整图像大小并保持纵横比

> ID：13592425
> 
> 赞同：2
> 
> 时间：2012-11-27T20:25:10.167
> 
> 标签：vb.net, image, algorithm, resize, aspect-ratio

我正在尝试制作放大/缩小按钮，但无论出于何种原因，我都无法弄清楚如何保持纵横比并将图像大小调整为 90% 或 110%

问题是我正在尝试这样做，以便当您单击缩小按钮 4 次，然后单击放大按钮 4 次时，图像将是其原始大小。没有定义宽度，因为我试图使新宽度为现有宽度的 90%/110%，但显然乘以 0.9 和 1.1 并不能正确地做到这一点。

我目前有以下代码..

```
 Dim source As New Bitmap(PictureBox1.Image)
    Dim NewWidth As Integer = source.Width * 0.9
    Dim NewHeight As Integer = NewWidth * (source.Height / source.Width) 
```

任何帮助表示赞赏。我敢肯定我只是想多了，但我会很感激一些指导:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T20:28:03.593

*最好的方法是从原始*图像的副本开始每次调整大小操作。让您的按钮代表总缩放系数（例如，为 + 添加 0.1 缩放，为 - 减去 0.1 缩放）。

您希望每次都从原始图像开始，否则由于放大和缩小固有的插值，连续操作会迅速扭曲图像。

# android - 发送到手机时布局展开

> ID：13592428
> 
> 赞同：1
> 
> 时间：2012-11-27T20:25:16.437
> 
> 标签：android, xml, layout, resize, center

我想知道是否可以在布局问题上获得一些帮助。基本上，我需要三件事（最终更多）才能出现在屏幕上，中间是做自己的事情。

我需要它看起来像下图（但在其他图片上显示空间背景）：

[![](../Images/3bbc04496e03f10b6432fc6f567a7fd4.png)](https://i.stack.imgur.com/KRN8e.jpg)

但它看起来像这样（这是来自 Nexus One AVD 和我的 Galaxy Nexus 手机）：

[![](../Images/eb2426d7596de342a2f277f42e403e55.png)](https://i.stack.imgur.com/gu7rR.jpg)

或者它会在屏幕中间显示“请选择您已经知道的变量”文本。我有一个显示良好的主屏幕。我尝试了不同的布局、不同的高度、手动输入高度和宽度，但我似乎无法让它为我工作。

这是“损坏” xml 布局的代码...

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:gravity="center_horizontal" >

<TextView
    android:id="@+id/app_name"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="@string/app_name"
    android:textAppearance="?android:attr/textAppearanceLarge"
    android:textColor="#FFFFFF"
    android:textSize="28sp" />

<TextView
    android:id="@+id/recommend_instructions"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_below="@+id/app_name"
    android:layout_centerHorizontal="true"
    android:gravity="center_horizontal"
    android:text="@string/recommend_instructions"
    android:textAppearance="?android:attr/textAppearanceSmall" />

<Button
    android:id="@+id/button_submit"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentBottom="true"
    android:layout_alignParentLeft="true"
    android:layout_alignParentRight="true"
    android:text="@string/button_submit" />

</RelativeLayout> 
```

`RelativeLayout`已经能够让我接近，但我希望有人能够查看我的 XML 文件并让我知道是否有任何你可以看到会导致中间文本重新大小的东西。我尝试使用`gravity='center_horizontal'`带有占位符布局的 a 将其保持在顶部，但它一直在扩展。所以我知道，要么“大统一理论”正在扩展到大约中间点并向下推，要么它正在将自己张贴在屏幕中间。

我认为这是`gravity = 'center'`我之前的代码，但我改变了它，它仍然存在问题。

任何帮助是极大的赞赏。

再次，我希望有人可以帮助我弄清楚是什么重新调整了我的文本代码的大小。

# python - 无法为 ForeignKey 字段分配值（用户 ID）

> ID：13592433
> 
> 赞同：1
> 
> 时间：2012-11-27T20:25:42.523
> 
> 标签：python, django, django-models

我收到以下错误： `Cannot assign "<django.db.models.fields.related.ForeignKey>": "Worry.user" must be a "User" instance.`

我试图将当前用户的 id 分配给我刚刚创建的对象。

这是我的models.py的一部分：

 `````
from django.contrib.auth.models import User  
from django.forms import ModelForm  
from django.db import models  

    class UserForm (ModelForm) :  
        class Meta:  
            model = User        
    class Worry(models.Model) :    
        user = models.ForeignKey(User) #Many worries to 1 user relation 
```

This is part of my views.py:` 

```
from django.db import models  
from django.shortcuts import render_to_response, redirect, get_object_or_404  
from django.template import RequestContext  
from django.contrib.auth.models import User  
from holaProy.models import UserForm, Worry, WorryForm, Statistics, StatisticsForm  
def worry_add (request):  
    form = WorryForm (request.POST or None)  
    if form.is_valid():      
        wform.user = models.ForeignKey('User')  #HERE IS THE PROBLEM I THINK
        wform.save()  
        return redirect (index)  
    return render_to_response ('holaProy/worry_add.html', {'worry_form': form}, context_instance = RequestContext(request))</code> 
```

我应该如何做才能成功地将当前用户 ID 分配给实际担忧实例的“用户”字段？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T20:28:28.553

确实，问题在于这一行：

```
wform.user = models.ForeignKey('User') 
```

`wform.user`应该设置为一个`User`实例。像这样的东西：

```
user = request.user    # Retrieve proper user according to your needs
wform.user = user 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T20:32:33.947

那就是您遇到问题的地方。

基本上，您正在搜索一个字符串。您需要先获取实际的数据库对象。尝试这个：

```
User = User.objects.get(pk='User')
wform.user = models.ForeignKey('User')  #Now User refers to the database object, not a string 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T20:28:56.263

尝试：

```
def worry_add(request):
    form = WorryForm(request.POST or None)
    if request.method == 'POST' and form.is_valid():
        worry = form.save(commit=False)
        worry.user = #assign this to an instance of a User object
        worry.save() 
````

# javascript - 使用 Javascript 在复制和粘贴时剥离样式

> ID：13592437
> 
> 赞同：2
> 
> 时间：2012-11-27T20:26:07.560
> 
> 标签：javascript, html, styles, copy-paste

我有一个客户希望能够从其页脚中的文本中剥离样式，该文本当前为白色并粘贴为白色文本。是否有一个 javascript 函数可以让我轻松地做到这一点？我发现了这个：[http](http://bavotasan.com/2010/add-a-copyright-notice-to-copied-text/) ://bavotasan.com/2010/add-a-copyright-notice-to-copied-text/并认为这可能至少是我如何完成这项任务的一瞥。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T21:37:47.040

通常是“粘贴接收器”控制可以粘贴的内容，而不是控制可以复制的内容。

您最好有一个“复制此”按钮，该按钮实际上将隐藏的、无样式的副本版本复制到剪贴板中。

# vb.net - 压缩文件夹中的所有文件

> ID：13592448
> 
> 赞同：2
> 
> 时间：2012-11-27T20:26:54.220
> 
> 标签：vb.net, microsoft-metro, zip, windows-runtime, access-denied

我对 WinRT 开发平台有点陌生，它已经让我发疯了（我是一名长期的 .Net 开发人员，所有那些被删除的 API 都很烦人）我在压缩所有文件时遇到问题Windows.Storage.ApplicationData.Current.TemporaryFolder 这是我当前的代码（VB.Net，基于 MSDN 代码，“文件”是我将所有文件放入的 zip 文件）：

```
Using zipMemoryStream As New MemoryStream()
Using zipArchive As New Compression.ZipArchive(zipMemoryStream, Compression.ZipArchiveMode.Create)
    For Each fileToCompress As Windows.Storage.StorageFile In (Await Windows.Storage.ApplicationData.Current.TemporaryFolder.GetFilesAsync())
        Dim buffer As Byte() = WindowsRuntimeBufferExtensions.ToArray(Await Windows.Storage.FileIO.ReadBufferAsync(fileToCompress))
        Dim entry As ZipArchiveEntry = zipArchive.CreateEntry(fileToCompress.Name)
        Using entryStream As Stream = entry.Open()
            Await entryStream.WriteAsync(buffer, 0, buffer.Length)
        End Using
    Next
End Using
Using zipStream As Windows.Storage.Streams.IRandomAccessStream = Await file.OpenAsync(Windows.Storage.FileAccessMode.ReadWrite)
    Using outstream As Stream = zipStream.AsStreamForWrite()
        Dim buffer As Byte() = zipMemoryStream.ToArray()
        outstream.Write(buffer, 0, buffer.Length)
        outstream.Flush()
    End Using
End Using
End Using 
```

它构建得很好，但是当我启动代码时，出现异常：UnauthorizedAccessException：访问被拒绝。（HRESULT 异常：0x80070005 (E_ACCESSDENIED)）在线：WindowsRuntimeBufferExtensions.ToArray(blahblah... 我想知道怎么了。知道吗？

提前致谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T06:04:00.827

我用 C# 重写了你的方法来尝试一下：

```
var file = await ApplicationData.Current.LocalFolder.CreateFileAsync("test.zip");

using (var zipMemoryStream = new MemoryStream())
{
    using (var zipArchive = new System.IO.Compression.ZipArchive(zipMemoryStream, System.IO.Compression.ZipArchiveMode.Create))
    {
        foreach (var fileToCompress in (await ApplicationData.Current.TemporaryFolder.GetFilesAsync()))
        {
            var buffer = WindowsRuntimeBufferExtensions.ToArray(await FileIO.ReadBufferAsync(fileToCompress));
            var entry = zipArchive.CreateEntry(fileToCompress.Name);
            using (var entryStream = entry.Open())
            {
                await entryStream.WriteAsync(buffer, 0, buffer.Length);
            }
        }
    }

    using ( var zipStream = await file.OpenAsync(Windows.Storage.FileAccessMode.ReadWrite))
    {
        using (var outstream = zipStream.AsStreamForWrite())
        {
            var buffer = zipMemoryStream.ToArray();
            outstream.Write(buffer, 0, buffer.Length);
            outstream.Flush();
        }
    }
} 
```

它完美地工作 - 它按预期在本地文件夹中创建 zip 文件。由于您在调用中遇到异常`ToArray`，原因可能是您尝试打开的文件已经从其他地方锁定。如果您自己创建这些文件，或者只是访问它们，请确保您关闭了流。

要测试此方法，您可以在 temp 文件夹中手动创建一个文件夹，将几个文件放入其中，然后在该文件夹（文件位于`C:\Users\<Username>\AppData\Local\Packages\<PackageName>\TempState`）上运行该方法，以排除任何其他错误原因。

# prolog - Prolog，大文本中单词的频率

> ID：13592450
> 
> 赞同：0
> 
> 时间：2012-11-27T20:27:00.443
> 
> 标签：prolog, word-frequency

> 给定一个相当长的文本，我需要找出某个单词出现了多少次。就像夏洛克小说一样，如果我输入夏洛克，给我 200 次或类似的东西。

到目前为止，我知道如何使用我实现的此功能读取列表，发布在下面。我感谢所有的帮助，不知道下一步该做什么或如何做。

> read_list(L) :- read(N), N \= end_of_file -> L = [N|Ns], !, read_list(Ns) ; L = [] 。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T20:48:55.997

read/1 获取一个*术语*，后跟 . 但为了讨论，让我们忽略这个事实。

如果您只对词频感兴趣，为什么要建立一个列表？只需计算单词*和*匹配项，并在文件末尾计算频率：

```
word_freq(W, Freq) :-
  word_count(W, 0, Total, 0, Match),
  Total > 0 -> Freq is Match / Total.

word_count(W, TotSoFar, Tot, MatchSoFar, Match) :-
  (  read(N),
     N \= end_of_file
  -> T1 is TotSoFar + 1,
     (  N == W
     -> M1 is MatchSoFar+1
     ;  M1 is MatchSoFar
     ),
     word_count(W, T1, Tot, M1, Match)
   ; TotSoFar = Tot,
     MatchSoFar = Match
   ). 
```

测试：

```
?- word_freq(a,F).
|: a.
|: b.
|: c.
|: a.
|: F = 0.5. 
```

**编辑**而不是 read/1，让我们定义一个 read_word(W)，其中一个单词只是一个字母数字序列

```
read_word(SoFar, W) :-
    get_code(C),
    (   C == -1
    ->  ( SoFar == [] -> W = end_of_file ; reverse(SoFar, W) )
    ;   code_type(C, alnum)
    ->  read_word([C|SoFar], W)
    ;   reverse(SoFar, W)
    ). 
```

配备如此丑陋的代码，并将 read/1 替换为 read_word/1，我们得到

```
?- word_freq("ab",F).
|: a ab abc
|: F = 0.3333333333333333. 
```

请注意，现在我传递的是*字符串*，而不是原子。

# java - 如何暂停其他正在进行的流式阅读器线程

> ID：13592453
> 
> 赞同：0
> 
> 时间：2012-11-27T20:27:18.117
> 
> 标签：java, swing, network-programming, thread-safety, swingworker

例如，如果我尝试在服务器程序上构建一个文件传输机制，通过利用他们自己现有的连接套接字将一个文件字节从发送者 A 发送到用户 B，那么如何避免它与所有正在进行的聊天流交错进入，即在这两个线程之间保持明确的等待和通知，除了在服务器端创建一个额外的服务器套接字......</p>

非常感谢凯夫

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T20:37:29.020

为您的应用程序创建一个消息协议，以区分各种消息类型。然后创建一个“文件块”消息和一个“聊天”消息以及您需要的任何其他消息。

伪代码：

```
// sending method
public synchronized void send(Message msg) {
  // write message to socket ...
}

// receiving method
while(true) {
  Message msg = readMessage(); // read message from socket
  handleMessage(msg); // may want to push this work to another thread
} 
```

# c# - Windows 手机应用程序、WebBrowser、iframe 和谷歌地图不能一起工作

> ID：13592459
> 
> 赞同：1
> 
> 时间：2012-11-27T20:27:52.067
> 
> 标签：c#, windows-phone-7, google-maps, iframe, windows-phone-7.1

我遇到了 iframe 和 WebBrowser 的问题。在我的应用程序中，我有一个带有 WebBrowser 的页面，该页面转到特定的 url，并且应该显示一个谷歌地图（嵌入 iframe）。但是，事实并非如此。收到错误*“此内容无法在框架中显示。为帮助保护您输入本网站的信息的安全性，此内容的发布者不允许其在框架中显示。”*

但是，如果我使用模拟器浏览器访问此 url，一切正常，与我的电脑中的 ie 相同。我还测试了其他没有 iframe 的 url，并且 WebBrowser 工作正常。我也尝试了 webBrowser.NavigateToString 与 url 相同的代码，但也不起作用。我在 iframe 中的地图 url 末尾确实有 &output=embed。还尝试在 html 中使用我的 api 密钥。

接下来我应该尝试什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T13:56:21.013

我要回答自己。在c#中添加这一行

```
webBrowser1.IsScriptEnabled = true; 
```

这在 xaml

```
IsScriptEnabled="True" 
```

成功了。因此，默认情况下，WebBrowser 控件中禁用脚本。嗯，现在我知道了。

从这里找到答案：http: [//www.jeffblankenburg.com/2010/10/18/31-days-of-windows-phone-day-18-webbrowser-control/](http://www.jeffblankenburg.com/2010/10/18/31-days-of-windows-phone-day-18-webbrowser-control/)

# ios - 标记 UIElement 或子类化控件之间的性能差异或更好的代码重用？

> ID：13592464
> 
> 赞同：0
> 
> 时间：2012-11-27T20:28:00.663
> 
> 标签：ios, uitableview, uielement

我想知道这两种在`UITableViewCell`.

选项 A：在您的故事板文件中，在您的 s 上`UITableViewCell`，将您`UIElement`的 s 拖到`UITableViewCell`, 标记每个`UIelement`. 然后在：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
   UITableViewCell *cell = [tableView dequeueReuseableCellIdentifier:@"MyCell"];

   UILabel *aLabel = [cell viewWithTag:TAG_FROM_IB];
   aLabel.text = @"my text";

   UIImageView *aImageView = [cell viewWithTag:TAG_FROM_IB];
   aImageView.image = [UIImage imageNamed:@"myImage.png"];

   return cell;
} 
```

选项 B：将`UIElement`s 拖到`UITableViewCell`情节提要中的 s 上。创建 的自定义子类`UITableViewCell`，将 的类更改为`UITableViewCell`新的自定义子类，通过以下方式访问属性：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
   MyTableViewCell *cell = [tableView dequeueReuseableCellIdentifier:@"MyTableViewCell"];

   cell.aLabel.text = @"my text";

   cell.aImageView.image = [UIImage imageNamed:@"myImage.png"];

   return cell;
} 
```

我只是想知道是否有“首选”或“更好”`UITableViewCell`的方式来创建 custom 。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T20:35:53.313

绝对没有。二！

它更简洁：使用起来更干净、更清晰！性能方面它也很出色，但那不是一个可衡量的数量......

+（恕我直言）性能绝不应该是设计决策的**最初**原因。

# php - 无需表单的 Javascript 输入验证

> ID：13592465
> 
> 赞同：0
> 
> 时间：2012-11-27T20:28:01.317
> 
> 标签：php, javascript, jquery, validation, input

我正在制作这个快速的互联网应用程序，用户在其中填写输入字段，然后单击“下一步”按钮。我在 W3Schools 上阅读了有关如何快速轻松地进行 Javascript*表单*验证的文章，但我想知道是否有一种方法可以在没有表单的情况下完成基本相同的事情（即`document.getElementById("myInput").value`；但这不起作用）。不想要表单的原因是，当单击“下一步”按钮时，它会执行页面动画然后转到下一页，并且我不希望任何表单提交延迟；（只需要一个输入和一个单击的按钮调用动画然后设置`window.location`）。

我正在做的验证类型只是检查该字段是否为空，所以我想做这样的事情：

**JavaScript：**

```
function ValidateFields() {
  var x = document.getElementById("myInput").value;
  if(x == null || x == '') {
    $(".error-msg").animate({opacity: "1"}, 400);
    return false;
  } else {
    $("body").animate({"margin-left": "-200px", opacity: "1"}, 400);
    setInterval("NextPage()", 800); // double animation time
  }
}
function NextPage() {
  window.location = "next.html?uid=false";
} 
```

**HTML：**

```
<input type="text" id="myInput" placeholder="" />
<input type="button" value="Next" onclick="return ValidateFields()" /> 
```

但显然，它不会起作用（缺乏对应关系和基本结构^(（笑）)）。

注意：我知道 Javascript 或任何客户端验证并不理想，但我已经平衡了可能性和后果，一旦我将页面放在服务器上并启动它，我也会考虑使用 ASP 或 PHP 支持它，*如果*我注意到一些互联网流行的奇怪爆发，我并没有真正期待。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T20:35:26.130

我不确定在`.val()`没有表格的情况下做一个会很好（跨浏览器）。我会添加`form`，然后在按钮`.click`功能上这样做......

给按钮一个 id

```
<input type="button" id="mybutton" value="Next" /> 
```

和`.click`...

```
$("#mybutton").click(function(e) {
  e.preventDefault();
  ValidateFields();
} 
```

这样点击按钮不会提交表单

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T20:44:57.457

由于您使用的是 jQuery，因此您可以尝试将输入文本值读取为

```
var x = $("#myInput").val(); 
```

或者可以检查长度如下

```
if ($("#myInput").length){

} 
```

希望能帮助到你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T20:57:14.817

这段代码似乎工作（用 Chrome 测试）：

```
<html>
<head>
    <title>This works</title>
</head>
<body>
    <input type="text" id="myInput" placeholder="" />
    <input type="button" value="Next" onclick="return ValidateFields();" />
    <div class="error-msg" style="opacity:0">Some error message</div>

    <script type="text/javascript">        
        function ValidateFields() {
          var x = document.getElementById("myInput").value;
          if(x == null || x == '') {
            $(".error-msg").animate({opacity: "1"}, 400);
            return false;
          } else {
            $("body").animate({"margin-left": "-200px", opacity: "1"}, 400);
            setTimeout("NextPage()", 800); // double animation time
          }
        }
        function NextPage() {
            window.location = "http://www.yahoo.com"; //just a test
        }
    </script>    
</body>
</html>​ 
```

让我知道您是否需要更多。

# spring-mvc - 无法从 START_OBJECT 令牌中反序列化 org.joda.time.DateTime 或 LocalDate 的实例

> ID：13592467
> 
> 赞同：18
> 
> 时间：2012-11-27T20:28:05.183
> 
> 标签：spring-mvc, jackson

v2.1.1，[乔达模块。](https://github.com/FasterXML/jackson-datatype-joda)

我可以在单元测试中使用 objectMapper.readValue(file, pojo .class); 将 json 文件转换为 pojo；

但是，当 Spring RESTTemplate 客户端调用[默认的 json 转换器](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/http/converter/json/MappingJacksonHttpMessageConverter.html)来转换包含具有 Joda 类型（DateTime 或 LocalDate）的域对象的 inputStream 时，它会生成错误：`objectMapper.readValue(httpInputMessage.getBody(), javaType)`

```

com.fasterxml.jackson.databind.JsonMappingException：无法反序列化 START_OBJECT 令牌中的 org.joda.time.DateTime 实例
来源：org.mortbay.jetty.HttpParser$Input@46a09b；行：1，列：752
在 com.fasterxml.jackson.databind.JsonMappingException.from(JsonMappingException.java:164)
在 com.fasterxml.jackson.databind.DeserializationContext.mappingException（DeserializationContext.java:599）
在 com.fasterxml.jackson.databind.DeserializationContext.mappingException（DeserializationContext.java:593）
在 com.fasterxml.jackson.datatype.joda.deser.DateTimeDeserializer.deserialize(DateTimeDeserializer.java:51)
在 com.fasterxml.jackson.datatype.joda.deser.DateTimeDeserializer.deserialize(DateTimeDeserializer.java:21)
在 com.fasterxml.jackson.databind.deser.SettableBeanProperty.deserialize(SettableBeanProperty.java:375)
在 com.fasterxml.jackson.databind.deser.BeanDeserializer._deserializeUsingPropertyBased(BeanDeserializer.java:559)
在 com.fasterxml.jackson.databind.deser.BeanDeserializer.deserializeFromObjectUsingNonDefault(BeanDeserializer.java:393)
在 com.fasterxml.jackson.databind.deser.BeanDeserializer.deserializeFromObject(BeanDeserializer.java:289)
在 com.fasterxml.jackson.databind.deser.BeanDeserializer.deserialize(BeanDeserializer.java:121)
在 com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:226)
在 com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:203)
在 com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:23)
在 com.fasterxml.jackson.databind.deser.SettableBeanProperty.deserialize(SettableBeanProperty.java:375)
在 com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeSetAndReturn(MethodProperty.java:106)
在 com.fasterxml.jackson.databind.deser.BuilderBasedDeserializer.deserializeFromObject(BuilderBasedDeserializer.java:326)
在 com.fasterxml.jackson.databind.deser.BuilderBasedDeserializer.deserialize(BuilderBasedDeserializer.java:143)
在 com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:226)
在 com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:203)
在 com.fasterxml.jackson.databind.deser.std.CollectionDeserializer.deserialize(CollectionDeserializer.java:23)
在 com.fasterxml.jackson.databind.deser.SettableBeanProperty.deserialize(SettableBeanProperty.java:375)
在 com.fasterxml.jackson.databind.deser.impl.MethodProperty.deserializeSetAndReturn(MethodProperty.java:106)
在 com.fasterxml.jackson.databind.deser.BuilderBasedDeserializer.deserializeFromObject（BuilderBasedDeserializer.java：

```

LocalDate 也会出现同样的问题

```
com.fasterxml.jackson.databind.JsonMappingException：意外令牌 (START_OBJECT)，预期 START_ARRAY：预期 JSON 数组、字符串或数字
来源：org.mortbay.jetty.HttpParser$Input@d297c0；行：1，列：51
在 com.fasterxml.jackson.databind.JsonMappingException.from(JsonMappingException.java:164)
在 com.fasterxml.jackson.databind.DeserializationContext.wrongTokenException（DeserializationContext.java:692）
在 com.fasterxml.jackson.datatype.joda.deser.LocalDateDeserializer.deserialize(LocalDateDeserializer.java:50)
……

```

为什么调用链在一种情况下传递 START_OBJECT 而在另一种情况下传递 START_ARRAY？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-06-06T21:57:32.227

为了解决类似的问题，我做了以下事情，

如果您使用的是 maven，我从[http://mvnrepository.com/artifact/com.fasterxml.jackson.datatype/jackson-datatype-joda/2.2.1](http://mvnrepository.com/artifact/com.fasterxml.jackson.datatype/jackson-datatype-joda/2.2.1)下载了 jackson-datatype-joda-2.2.1.jar依赖项定义是也有。

然后我为我的应用程序中的每个 LocalDate 字段添加了一个注释，如下所示：

```
@JsonDeserialize(using=LocalDateDeserializer.class)
private LocalDate releasedDate; 
```

进口看起来像这样：

```
import com.fasterxml.jackson.databind.annotation.JsonDeserialize;
import com.fasterxml.jackson.datatype.joda.deser.LocalDateDeserializer; 
```

问题消失了。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-28T03:45:16.360

我认为这与序列化器和反序列化器之间的一些差异有关；这样一个产生另一个（我认为 Joda 模块实际上在注册时写入了一个整数数组）。这很可能是因为缺少反序列化程序或序列化程序注册。

默认情况下，没有任何额外处理，Jackson 会认为 Joda 类型只是 POJO，并使用 getter/setter。但是 Joda 模块使用更紧凑的表示形式（字符串、数组）。所以可能发生的是序列化端没有使用 Joda 模块；和反序列化是。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-02-08T13:30:01.213

您应该在 joda-time 中同时使用序列化和反序列化；针对您尝试保存和获取的那些字段。
通过这样做，我们将把双方的职责都交给 jackson（java 到 mongo/json 和 mongo/json 到 java 的转换）。

示例代码：

```
@JsonDeserialize(using= LocalDateDeserializer.class)
@JsonSerialize(using = LocalDateSerializer.class)
LocalDate dateFieldToBeConverted 
```

这些是进口：

```
import com.fasterxml.jackson.databind.annotation.JsonDeserialize

import com.fasterxml.jackson.databind.annotation.JsonSerialize

import com.fasterxml.jackson.datatype.joda.deser.LocalDateDeserializer

import com.fasterxml.jackson.datatype.joda.ser.LocalDateSerializer

import org.joda.time.LocalDate 
```

完成此操作后，mongo 上的简单 save 和 findOne 查询（通过 java repo 类）将毫无问题地工作。希望这可以帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-10-17T12:00:16.227

这里的关键问题是 Spring 以不同于 Jersey 的方式转换 JodaTime。

这是我必须在我的`app-servlet.xml`：

```
<mvc:annotation-driven>
    <mvc:message-converters>
        <bean class="org.springframework.http.converter.json.MappingJackson2HttpMessageConverter">
            <property name="objectMapper">
                <bean class="no.bouvet.jsonclient.spring.JsonClientJackson2ObjectMapperFactoryBean"/>
            </property>
        </bean>
    </mvc:message-converters>
</mvc:annotation-driven> 
```

在这里，您可以从[java-json-client](https://github.com/bouvet-openlab/java-json-client)库中找到[no.bouvet.jsonclient.spring.JsonClientJackson2ObjectMapperFactoryBean](https://github.com/bouvet-openlab/java-json-client/blob/master/json-client/src/main/java/no/bouvet/jsonclient/spring/JsonClientJackson2ObjectMapperFactoryBean.java)

# ajax - 为json填充下拉传递函数参数

> ID：13592468
> 
> 赞同：0
> 
> 时间：2012-11-27T20:28:10.173
> 
> 标签：ajax, json

如何将参数从发送 url 和 id 的函数传递到“foodName”？即你能做类似函数的事情吗： call('/url/to/foodlist', "foodList", "food"); 并替换 var input = item.food;?

下面是工作代码，但想要一个更通用的函数，然后必须在函数中使用部分名称（替换 foodName 使其不在此函数中）

```
function call(url, id){
var string = '';
$.ajax({
type: "GET",
url: url,
success: function (item)
if (item != '') {
  var input = item.foodName;
  for (var i = 0; i < input.length; i++) {
  string += = '<option value=' + input[i].name + '">' + input[i].name + '</option>';
  }
$('#' + id). append(string);
} 
```

});

call('/url/to/foodlist', "foodList");

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T20:29:39.860

```
function call(url, id, paramName){
var string = '';
$.ajax({
type: "GET",
url: url,
success: function (item)
if (item != '') {
  var input = item[paramName]; // you can access to the properties using braces
  for (var i = 0; i < input.length; i++) {
  string += = '<option value=' + input[i].name + '">' + input[i].name + '</option>';
  }
$('#' + id). append(string);
} 
```

# android - 数据库连接丢失后访问 SQLite 数据库

> ID：13592473
> 
> 赞同：1
> 
> 时间：2012-11-27T20:28:29.177
> 
> 标签：android, sqlite

谁能解释我为什么会发生以下情况。这是使用 SQLite db 的 Android 应用程序。

1.  应用程序将新数据添加到数据库中，这些数据存储在外部存储器中。
2.  同时这个外存不可用（比如我挂载到PC上）。
3.  当外部存储器再次可用时，我无法以**只读**模式访问 db。但是，如果我尝试以**读写**模式打开它，它会顺利进行。为什么？

我编写了代码（如下），它处理了这个问题并且效果很好，但我仍然不明白**为什么**。

这与**剩余**的打开连接或类似的东西无关。为了确保，我从设备上完全删除了我的应用程序并重新安装它。但即使在那之后，db 在**只读**模式下也不可用。db以**读写**模式打开一次后，下次可能以**只读模式打开，没有任何问题。**

当我说“不可用”时，我的意思是 db 可以很好地打开，但是对 db 的任何查询都因 IO 错误而失败。

```
 SQLiteDatabase db = SQLiteDatabase.openDatabase(f.getPath(), null, SQLiteDatabase.OPEN_READONLY | SQLiteDatabase.NO_LOCALIZED_COLLATORS);

        if (!testQuery(db))
        {
            Utils.logD("Failed to open db at path: " + f + ". Trying recovering...");
            db.close();
            db = SQLiteDatabase.openDatabase(f.getPath(), null, SQLiteDatabase.NO_LOCALIZED_COLLATORS);
            if (!testQuery(db))
            {
                Utils.logD("Failed to open db at path: " + f + " (noway)");
                db.close();
                return null;
            }
        }

        Utils.logD("DATABASE OPENED! " + db.hashCode()); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T07:45:59.950

如果在事务仍处于活动状态时使数据库不可用，则必须在数据库再次处于一致状态之前回滚该事务。此回滚需要写入权限。

这意味着只有当数据库永远不会更改时，您才应该以只读模式打开数据库。

# python - 读取由 Python f.write() 写出的 Fortran-90 文件

> ID：13592475
> 
> 赞同：1
> 
> 时间：2012-11-27T20:28:41.157
> 
> 标签：python, arrays, fortran90, read-write

所以有人写了这段代码，它输出一些粒子的 x,y,z 位置。

```
 if rs.contains_block(file+'.hdf5',"POS ",parttype=1):
        d1 = rs.read_block(file, "POS ",parttype=1,verbose=False)
        blocksize = struct.pack('I', len(d1)*8*3)
        f.write(blocksize)
        for i in range(len(d1)):
            for j in range(3):
                data = struct.pack('d',d1[i][j])
                f.write(data)
        f.write(blocksize)
        print 'Position real', d1, k
    else:
        data = struct.pack('I',0)
        f.write(data)
        f.write(data) 
```

或者基本上：

```
 for i = 1:Nparticles
             for j = 1:3
                write xyz[i][j]
             end
        end 
```

现在我试图在 F90 中读回这个：

```
 real*4,   allocatable :: pos(:,:)
  N=sum(Nparticles)
  open (1, file=filename, form='unformatted')
  allocate(pos(1:3,1:N))
  read (1) pos
  close(1) 
```

当我打印前三行时，我得到：

```
 do i =1,3
      print *, pos(1:3,i)
  end do

  >>   0.00000000       2.61613369      -2.00000000    
       1.88289821      -2.00000000       1.96834707    
       2.00000000       2.61616445       2.00000000 
```

现在我确定位置范围从 0 到 25，所以到处都得到 -2.0000 是令人担忧的。我的朋友 Python 写出 (f.write()) 有什么我需要告诉 Fortran 在读入期间执行的操作，以便正确输出位置吗？主角？分配修正？我使用了 Python 读入，前 3 个条目得到以下信息：

```
 >>> pos = rs.read_block("filename","POS ",parttype=1)
 >>> pos(1:3,:)
    array([[ 12.49398994,  21.89432526,   6.23691988],
           [ 12.48858261,  21.89297867,   6.23258686],
           [ 12.48777962,  21.89576149,   6.23423147], 
```

当我在上面阅读 Fortran 时，这不是我得到的。

谢谢。

# python - Python - 混淆如何编写读取文件以更新动态字典以进行查找

> ID：13592477
> 
> 赞同：0
> 
> 时间：2012-11-27T20:28:42.577
> 
> 标签：python, django, linux

我在 python 中是一个完全的菜鸟：我将如何重构下面的代码，以便字典**d**实际上是文件系统上的一个文件，如果在 fr 中找到一个新的电子邮件地址，它会通过电子邮件和下一个增量 int id 附加到文件系统上?

这是**fr**文件的文件结构：

```
7@comp1.COM|4|11|GDSPV
7@comp1.COM|16|82|GDSPV
13@comp1.COM|16|82|GDSPV 
```

下面是我的程序..它用 id 屏蔽电子邮件地址。请注意，目前，我已经对 d 字典进行了硬编码。

```
 d= {
    '7@comp1.COM': '199',
    '8@comp4.COM': '200',
    '13@comp1.COM': '205'
    }

fr = open(sys.argv[1], 'r')
fw = open("masked_"+sys.argv[1], 'w')

cnt = 0
i = 1
line_list = []

for line in fr:
    columns = line.split("|")
    looking_for = columns[0] # this is what we need to search
    if looking_for in d:
        # by default, iterating over a dictionary will return keys
        new_line = d[looking_for]+'|'+'|'.join(columns[1:])
        line_list.append(new_line)
fw.writelines(line_list)

fr.close()
fw.close() 
```

我也想通过这个程序发送多个文件。其中数百个使用通配符或其他东西 (*) 作为 fr 文件阅读器。您能否将其包含在解决方案中是可能的。谢谢！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T00:08:27.503

看一下python[`shelve`](http://docs.python.org/2/library/shelve.html)模块。它是一个字典类型的对象，对文件系统是持久的（在后台使用pickle）。

```
import shelve

filename = sys.argv[1]
d = shelve.open(filename)

d.update({
    '7@comp1.COM': '199',
    '8@comp4.COM': '200',
    '13@comp1.COM': '205'
})

d.close()

d = shelve.open(filename)
print d
#{'8@comp4.COM': '200', '7@comp1.COM': '199', '13@comp1.COM': '205'}

d.keys()
#['8@comp4.COM', '13@comp1.COM', '7@comp1.COM']

d['13@comp1.COM']
#'205' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T20:48:29.393

`I would like to maintain and persist the dictionary d in a file.`

[泡菜](http://docs.python.org/2/library/pickle.html)

`Also I would like to send multiple files through this program.`

[球体](http://docs.python.org/2/library/glob.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T23:41:41.787

我编写了解决方案。

```
#!/usr/bin/python

d = {}

line_list=[]
fr = open(sys.argv[2], 'r')
fw = open(sys.argv[3]+"/masked_"+sys.argv[1], 'w')

with open(sys.argv[1], 'r+') as f:
    for line in f:
       (key, val) = line.split()
       d[key] = val

for line in fr:
    columns = line.split("|")
    looking_for = columns[0] # this is what we need to search
    if looking_for in d:
        # by default, iterating over a dictionary will return keys
        new_line = d[looking_for]+'|'+'|'.join(columns[1:])
        line_list.append(new_line)
    else:
        new_idx = str(len(d)+1)
        d[looking_for] = new_idx
        kv = open(sys.argv[3], 'r+')
        kv.write(looking_for+" "+new_idx)
        kv.close()
        new_line = d[looking_for]+'|'+'|'.join(columns[1:])
        line_list.append(new_line)

fw.writelines(line_list) 
```

# c# - Live SDK LiveAuthClient.InitializeAsync 错误

> ID：13592484
> 
> 赞同：1
> 
> 时间：2012-11-27T20:28:50.827
> 
> 标签：c#, windows-phone-7, onedrive, windows-live

在我的应用程序上工作以允许备份到 Skydrive，我能够让“登录”按钮正常工作。经过进一步完善后，我开始使用 LiveAuthClient.InitializeAsync 但似乎无论我把它放在哪里（UI线程与否）或者我通过什么范围，我总是会收到错误消息：

```
"An unhandled exception of type 'System.Runtime.Serialization.InvalidDataContractException' occurred in System.Windows.ni.dll" 
```

使用以下调用堆栈：

```
System.Windows.ni.dll!MS.Internal.JoltHelper.OnUnhandledException(object sender, System.UnhandledExceptionEventArgs args)
[Native to Managed Transition]
[Managed to Native Transition]
System.Windows.ni.dll!System.Net.Browser.ClientHttpWebRequest.InvokeGetResponseCallback.AnonymousMethod__1b(object state2)
mscorlib.ni.dll!System.Threading.QueueUserWorkItemCallback.WaitCallback_Context(object state)
mscorlib.ni.dll!System.Threading.ExecutionContext.RunInternal(System.Threading.ExecutionContext executionContext, System.Threading.ContextCallback callback, object state, bool preserveSyncCtx)
mscorlib.ni.dll!System.Threading.ExecutionContext.Run(System.Threading.ExecutionContext executionContext, System.Threading.ContextCallback callback, object state, bool preserveSyncCtx)
mscorlib.ni.dll!System.Threading.QueueUserWorkItemCallback.System.Threading.IThreadPoolWorkItem.ExecuteWorkItem()
mscorlib.ni.dll!System.Threading.ThreadPoolWorkQueue.Dispatch()
mscorlib.ni.dll!System.Threading._ThreadPoolWaitCallback.PerformWaitCallback()
[Native to Managed Transition] 
```

代码：

```
Microsoft.Live.LiveAuthClient auth = new Microsoft.Live.LiveAuthClient("ClientId");
        auth.InitializeCompleted += auth_InitializeCompleted;
        auth.InitializeAsync(new string[] { "wl.signin", "wl.offline_access", "wl.skydrive_update" });
```

使用 Windows Phone 7.1 和 VS 2012 express for Windows Phone 和 Live SDK 版本 5。任何帮助/见解将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T19:49:34.663

可能的愚蠢答案，但是...

我想“ClientId”只是您发布的代码中的占位符，对吧？

否则，您在 App 注册后获得的正确 ClientId 应该在那里

# linux - ARM9 内核 2.6.10 GPIO 引脚中断返回 IRQ_HANDLED

> ID：13592493
> 
> 赞同：1
> 
> 时间：2012-11-27T20:29:32.950
> 
> 标签：linux, arm, masking, gpio

我试图更好地理解在基于 GPIO 引脚的中断处理程序（上半部分）和 GPIO 引脚硬件中使用的“return IRQ_HANDLED”语句之间的交互。特别是，考虑设备已将 GPIO 引脚拉低以指示它需要注意的假设情况。这会导致调用相关的（上半部分）中断处理程序。现在假设上半部分处理程序排队了一些工作，然后返回“return IRQ_HANDLED”，但是无论出于何种原因，生成它的设备上的中断都没有被清除（即设备将 GPIO 引脚保持在低状态）。调用“return IRQ_HANDLED”是否会导致重新生成中断？我在以下文章的背景下问这个问题：

[http://www.makelinux.net/books/lkd2/ch06lev1sec4](http://www.makelinux.net/books/lkd2/ch06lev1sec4)

“可重入和中断处理程序 Linux 中的中断处理程序不需要是可重入的。当给定的中断处理程序正在执行时，相应的中断线在所有处理器上被屏蔽，防止接收到同一条线上的另一个中断。通常所有其他中断都被启用，所以其他中断被服务，但当前行总是被禁用。因此，同一个中断处理程序永远不会同时调用来服务嵌套中断。这大大简化了中断处理程序的编写。

上面的注释表明，在调用中断处理程序时，该中断的中断线被屏蔽。我试图弄清楚“return IRQ_HANDLED”的调用是否是取消屏蔽中断线的原因。并且，关于上述假设情况，如果我“返回 IRQ_HANDLED”但设备尚未真正清除其中断，因此仍将 GPIO 引脚保持在低（触发）状态，会发生什么情况。更具体地说，这是否会导致再次生成中断，从而使处理器永远没有机会完成第一次发生中断时排队的工作。即，这是否会导致中断风暴，其中处理器可能被无休止地中断，从而不允许任何有用的处理发生。

提前致谢，

吉姆

PS：我不清楚启用/禁用中断（特别是与特定 GPIO 引脚关联的中断）和屏蔽/取消屏蔽相同的 GPIO 中断之间的区别。

# sqlalchemy - session.add(self) 不向数据库添加记录

> ID：13592494
> 
> 赞同：1
> 
> 时间：2012-11-27T20:29:39.863
> 
> 标签：sqlalchemy

这里总新手。尝试使用 sqlalchemy 但遇到了问题。

```
class Establishment(Base):
__tablename__ = 'establishments'

estaID = Column(String(5), primary_key=True)
typeID = Column(String(2), ForeignKey('types.typeID'))

type = relationship("Type", backref=backref('estabs', order_by=estaID))

def __init__(self, id):
    self.estaID = id

    try:
        session = Session()

        existsEsta = session.query(Establishment).filter(Establishment.estaID == self.estaID).one()
        session.close()

        self.typeID = existsEsta.typeID

    except NoResultFound, e:
        session = Session()

        print "Establishment: ", self.estaID, "does not yet exist."
        type = Type(raw_input("Please enter type: "))

        self.typeID = type.gettypeID()

        print "Adding establishment", self.estaID, self.typeID

        session.add(self)

        session.commit 
```

出于某种原因， session.add(self) 没有将记录添加到数据库中。我很难弄清楚发生了什么，因为这个“建立”类是在另一个类（相同的算法，不同的变量名）之后建模的，它工作得很好。

关于我在哪里出错的想法？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T20:44:17.670

尝试`session.commit()`代替`session.commit`.

# jquery-ui - 在 jQuery UI 对话框中使用 video.js 会出现第二个视频和重复播放的问题

> ID：13592496
> 
> 赞同：2
> 
> 时间：2012-11-27T20:29:40.300
> 
> 标签：jquery-ui, dialog, video.js

# 语境

我有一个页面，其中包含一堆指向 jQuery UI 对话框的链接，这些对话框中包含 video.js 播放器。

# 问题

当您第一次单击其中一个链接时，一切正常。

当您单击后续时间时，您会遇到问题。通过使所有 id 唯一，我已经解决了打开第二个不同视频的问题。

但是，这似乎无助于再次打开同一个视频；所以我什至让这些播放器的 id 是唯一的（请参阅下面的`id`属性以`<video>`包含视频的*哈希*以及`rand`.

# 定义的问题

我看到的情况是，一旦您关闭对话框，浏览器就会继续下载视频源。这意味着随后的对话打开会创建更多的视频下载等等。

# 问题

1.  如何阻止视频下载？
2.  有没有比我正在做的更好的重新初始化方法。
3.  当有人点击关闭按钮时，有没有更好的方法来关闭视频？

# 代码

## jQuery UI 对话框窗口加载了以下 HTML

```
<video id="<?php echo $viLibraryItem->getHash().rand() ?>" class="video-js vjs-default-skin" width="320" height="240"
       controls="controls" preload="auto" data-setup="{}"
       poster="<?php echo viLibraryItem::getWebPath() .'/'. $viLibraryItem->getVideoFilenamePoster() ?>">
    <source src="<?php echo $viLibraryItem->getFullWebPath() ?>" type="video/mp4"></source>
    <!-- Flash Fallback. Use any flash video player here. Make sure to keep the vjs-flash-fallback class. -->
    <object id="flash_fallback_1" class="vjs-flash-fallback" width="320" height="240" type="application/x-shockwave-flash"
      data="<?php echo _compute_public_path('flowplayer-3.2.7.swf', 'swf', 'swf', true)?>">
      <param name="movie" value="<?php echo _compute_public_path('flowplayer-3.2.7.swf', 'swf', 'swf', true)?>" />
      <param name="allowfullscreen" value="true" />
      <param name="flashvars" value='config={"playlist":["<?php echo viLibraryItem::getWebPath() ?>/<?php echo $viLibraryItem->getFilename() ?>", {"url": "<?php echo _compute_public_path($viLibraryItem->getFilename(), viLibraryItem::getWebPath(), 'swf')?>","autoPlay":false,"autoBuffering":true}]}' />
      <!-- Image Fallback. Typically the same as the poster image. -->
      <img src="<?php echo viLibraryItem::getWebPath() .'/'. $viLibraryItem->getVideoFilenamePoster() ?>" width="320" height="240" alt="Poster Image"
        title="No video playback capabilities." />
    </object>
</video> 
```

## 对话框的 Javascript

```
video_play_click_event: function(event) { 
    $.loading(); 
    $('<div title="'+$(this).attr('title')+'">').load($(this).attr('href'), function(responseText, textStatus){ 
      $.loading(); 
      $this = $(this); 
      $this.dialog({ 
        width: 320, 
        height: 400, 
        modal: true, 
        buttons: { 
          Close: function() { 
            $(this).dialog( "destroy" ); 
          }, 
        }, 
        open: function(event, ui) { 
            id = $(this).find('.video-js:first').attr('id'); 
            _V_(id); 
            $(this).css({overflow: 'hidden', padding: '0'}); 
        }, 
        beforeClose: function() { 
            $('.video-js').player().pause(); 
            $('.video-js').remove(); 
        } 
      }); 
    }); 
    return false; 
  } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T12:47:20.707

I have many videos in a given page and I was facing the same issue. But the below approach worked well for me.

NOTE: Change the MYID for each video in the page.

```
jQuery(document).ready(function(){
   jQuery("a#videolink").fancybox({
      frameWidth: 800, 
      frameHeight: 450,
      overlayShow: true,
      overlayOpacity: 0.7
   });
});

<a id="videolink" href="#MYID" title="Test Video">
  <img src="mp4test.jpg" width="248" height="145" />
</a>

<div style="display:none">
      <video id="MYID" poster="mp4test.jpg" class="video-js vjs-default-skin" 
             controls preload="auto" width="300" height="300" data-setup="{}" >
        <source src="mp4test.mp4" type='video/mp4'>
    </video>
</div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T21:54:44.037

我不知道这是否是解决这个问题的正确答案；但是，我最终将我的 javascript 更改为如下所示。

秘密是设置 src="" 让浏览器停止缓冲。这会在控制台上引发我真的不喜欢的视频错误；但现在它有效。

```
video_play_click_event: function(event) {
    $.loading();
    $('<div title="'+$(this).attr('title')+'">').load($(this).attr('href'), function(responseText, textStatus){
      $.loading();
      $this = $(this);
      $this.dialog({
        width: 320,
        height: 400,
        modal: true,
        buttons: {
          Close: function() {
            $(this).dialog('close');
          },  
        },  
        open: function(event, ui) {
            id = $(this).find('.video-js:first').attr('id');
            _V_(id);
            $(this).css({overflow: 'hidden', padding: '0'});
        },  
        beforeClose: function() {
            $('.video-js').player().pause();
            $('.video-js video').attr('src', '');
            $('.video-js').remove();
        }   
      }); 
    }); 
    return false;
  } 
```

# sql - 使用 SELECT UNION 并从一个表中返回两列的输出

> ID：13592499
> 
> 赞同：4
> 
> 时间：2012-11-27T20:29:57.583
> 
> 标签：sql, oracle, select, union

我正在创建一个查询表中男性和女性演员的数量。我目前的陈述是这样的：

```
Select COUNT(ActorGender) “Male Actors” 
from (tblActor ta WHERE ta.ActorGender in(‘m’)
UNION
Select COUNT(ActorGender) “Female Actors” 
from tblActor ta 
WHERE ta.ActorGender in(‘f’); 
```

输出最终是：

```
Male Actors
-----------
          7
         21 
```

我希望输出看起来像：

```
Male Actors   Female Actors
-----------   -------------
          7              21 
```

我正在寻找一种**不使用 CASE WHEN 或 THEN 子句**的替代方法。

提前感谢您一如既往的帮助。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-27T20:53:20.133

另一种方式（不`CASE`表达）：

```
SELECT 
  ( SELECT COUNT(*)
    FROM tblActor 
    WHERE ActorGender = 'm' 
  ) AS MaleActors
, ( SELECT COUNT(*)
    FROM tblActor 
    WHERE ActorGender = 'f' 
  ) AS FemaleActors
FROM 
    dual ; 
```

以及更多的`CROSS`加入解决方案：

```
SELECT m.MaleActors, f.FemaleActors
FROM 
  ( SELECT COUNT(*) AS MaleActors
    FROM tblActor 
    WHERE ActorGender = 'm' 
  ) m
  CROSS JOIN
  ( SELECT COUNT(*) AS FemaleActors
    FROM tblActor 
    WHERE ActorGender = 'f' 
  ) f  ; 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-27T20:32:43.490

这会做：

```
SELECT  COUNT(CASE WHEN ActorGender = 'm' THEN 1 ELSE NULL END) MaleActors,
        COUNT(CASE WHEN ActorGender = 'f' THEN 1 ELSE NULL END) FemaleActors
FROM tblActor 
WHERE ActorGender IN ('m','f') 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-11-27T20:59:21.113

另一种不使用案例的方法：

```
select sum(males) as "Male Actors", sum(females) as "Female Actors" 
from 
(select count(actorGender) as Males, 0 as Females
from tblActor 
where actorGender = 'm'
union all
select 0 as males, count(actorGender) as Females
from tblActor
where actorGender = 'f') 
```

应该导致

```
Male Actors    Female Actors
-----------    -------------
7              21 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-11-27T21:02:23.470

如果您使用的是 Oracle 11g+，那么您可以使用`PIVOT`：

```
select *
from
(
  select actorgender
  from tblActor
) src
pivot
(
  count(actorgender)
  for actorgender in ('m' MaleActors, 'f' FemaleActors)
) piv 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!4/cd39e/3)

结果将是：

```
| MALEACTORS | FEMALEACTORS |
-----------------------------
|          4 |            5 | 
```

或者您可以使用 a`CROSS JOIN`来获得相同的结果：

```
select m.MaleActors, f.FemaleActors
from 
(
  select count(ActorGender) MaleActors, 'm' Gender
  from tblActor
  where ActorGender = 'm'
) m
cross join
(
  select count(ActorGender) FemaleActors, 'f' Gender
  from tblActor
  where ActorGender = 'f'
) f 
```

# c++ - 截然不同的输出 C++ 蒙特卡罗近似

> ID：13592502
> 
> 赞同：2
> 
> 时间：2012-11-27T20:30:09.640
> 
> 标签：c++

使用随机数生成器对 Pi 进行 C++ 近似，输出在我运行 Ubuntu 的 AMD 64 机器上完全符合预期，但是在我的学校机器上，我实现的第二个算法被破坏了，并且希望了解原因。代码如下：

```
#ifndef RANDOMNUMBER_H_
#define RANDOMNUMBER_H_

class RandomNumber {
public:
RandomNumber() {
    x = time(NULL);
    m = pow(2, 19); //some constant value
    M = 65915 * 7915; //multiply of some simple numbers p and q
    method = 1;
}
RandomNumber(int seed) {
    x = ((seed > 0) ? seed : time(NULL));
    m = pow(2, 19); //some constant value
    method = 1; //method number
    M = 6543 * 7915; //multiply of some simple numbers p and q
}
void setSeed(long int seed) {
    x = seed; //set start value
}

void chooseMethod(int method) {
    this->method = ((method > 0 && method <= 2) ? method : 1); //choose one of     two method
}

long int linearCongruential() { //first generator, that uses linear congruential method
    long int c = 0; // some constant
    long int a = 69069; //some constant
    x = (a * x + c) % m; //solution next value
    return x;
}

long int BBS() { //algorithm Blum - Blum - Shub
    x = (long int) (pow(x, 2)) % M;
    return x;
}
double nextPoint() { //return random number in range (-1;1)
    double point;
    if (method == 1) //use first method
        point = linearCongruential() / double(m);
    else
        point = BBS() / double(M);
    return point;
}
private:
long int x; //current value
long int m; // some range for first method
long int M; //some range for second method
int method; //method number
};

#endif /* RANDOMNUMBER_H_ */ 
```

和测试类：

```
#include <iostream>
#include <stdlib.h>
#include <math.h>
#include <iomanip>
#include "RandomNumber.h"
using namespace std;

int main(int argc, char* argv[]) {
cout.setf(ios::fixed);
cout.precision(6);
RandomNumber random;
random.setSeed(argc);
srand((unsigned) time(NULL));
cout << "---------------------------------" << endl;
cout << "   Monte Carlo Pi Approximation" << endl;
cout << "---------------------------------" << endl;
cout << " Enter number of points: ";
long int k1;
cin >> k1;
cout << "Select generator number: ";
int method;
cin >> method;
random.chooseMethod(method);
cout << "---------------------------------" << endl;
long int k2 = 0;
double sumX = 0;
double sumY = 0;
for (long int i = 0; i < k1; i++) {
    double x = pow(-1, int(random.nextPoint() * 10) % 2)
            * random.nextPoint();
    double y = pow(-1, int(random.nextPoint() * 10) % 2)
            * random.nextPoint();
    sumX += x;
    sumY += y;
    if ((pow(x, 2) + pow(y, 2)) <= 1)
        k2++;

}
double pi = 4 * (double(k2) / k1);
cout << "M(X)  = " << setw(10) << sumX / k1 << endl; //mathematical expectation of x
cout << "M(Y)  = " << setw(10) << sumY / k1 << endl; //mathematical expectation of y
cout << endl << "Pi = " << pi << endl << endl; //approximate Pi

return 0;
} 
```

第二种方法在我的实验室机器上始终返回 4.000，但在我的个人机器上返回相当接近的近似值。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T20:45:19.953

一方面，您使用的 BBS 生成器将始终返回`1`.

由于您的程序不带任何参数，因此它`argc`可能是`1`. 你作为种子传递`argc`（为什么？），所以初始`x`值为`1`。

`BBS()`有以下逻辑：

```
x = (long int) (pow(x, 2)) % M; 
```

显然，`1`平方模`M`给出`1`，所以`x`永远不会改变。

**当您使用这样的生成器运行模拟时，您的程序将始终输出`4`.**

`x0`PS Wikipedia对[Blum Blum Shub](http://en.wikipedia.org/wiki/Blum_Blum_Shub)的初始值有以下说法：

> 种子`x0`应该是一个与`M`（即不是 的因数）`p`而不是or互质的整数。`q``x0``1``0`

# c++ - 类名和枚举值之间的冲突：没有命名空间可以解决吗？

> ID：13592504
> 
> 赞同：0
> 
> 时间：2012-11-27T20:30:16.473
> 
> 标签：c++, enums, namespaces, name-clash

```
class cippa{};

enum close{ cippa };

int main(){
    new cippa();    //bad here
} 
```

使用`::cippa`也无济于事。有没有办法解决这个问题而无需将`enum`或`class`单独放置`namespace`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T20:32:38.483

使用 消除歧义`new class cippa`。如果类名和枚举数（或函数/变量）名在同一范围内声明，则类名是隐藏的。您可以通过 访问它`class name`。如果类型名称是枚举名称，则相同。你可以通过`enum name`

```
#include <unistd.h>

// oops, close is now hidden! but we know a trick..
enum close c = cippa; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T21:44:27.367

使用 C++11，如果你这样做了

```
class cippa;
enum class close { cippa }; 
```

那么类`cippa`和枚举值`close::cippa`不会发生冲突。

顺便说一句，这基本上是在做

```
class close{
public:
  enum enum_t{cippa};
}; 
```

但是，`close`您需要使用`close::enum_t`来访问枚举类型，而不是。 `close::cippa`保持不变。

# command - 从 rake 任务中运行 rake ts:index

> ID：13592507
> 
> 赞同：1
> 
> 时间：2012-11-27T20:30:24.523
> 
> 标签：command, rake, system, task, sphinx

我正在运行 Rails 2.3.5。

在我的项目中，我在 lib/tasks 中有以下 rake 任务（test_task.rake）：

```
desc 'test_synchro_task'
task :test_synchro_task => :environment do
    # A bunch of things that are properly executed (basically I am inserting 
    # in the database)...
    # ...
    # and once the above is done, I want the following to be executed,
    # the sphinx index to be rebuild, but it is NOT :
    system("cd /sites/project/app")
    system("RAILS_ENV='staging' rake ts:index")
end 
```

我通过包含以下条目的 crontab 触发任务的执行：

```
13 14 * * * cd /sites/project/app && /sites/ruby/bin/rake RAILS_ENV=staging test_task 
```

除了任务中的 2 个系统行之外，哪个 id 正确调用和执行。

请注意，当我将这两个系统行放在我的项目脚本目录中的 ruby​​ test.rb 文件中时，并使用 ruby​​ 命令手动运行它：

```
ruby test.rb 
```

这 2 个系统命令已正确执行，并且索引已正确重建。

在我的 rake 任务中，我尝试通过以下方式替换这两个系统行：

```
%x["cd /sites/project/app"]
%x["RAILS_ENV='staging' rake ts:index"] 
```

或通过

```
@cmd="cd /sites/project/app; RAILS_ENV='staging' rake ts:index"
`#{@cmd}` 
```

但 rake ts:index 仍未执行。

知道为什么吗？

非常感谢。

伊夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T16:17:10.823

Problem resolved:

1- In the ruby script, I found that the $?.exitstatus was 127, which is "command not found".

2- This hinted me to a PATH problem occurring in the context of cron.

3- Found that post: [http://dewful.com/?p=157](http://dewful.com/?p=157) titled "Ruby - Cron Not Working For Ruby Script".

4- Added the PATH in the crontab and everything works fine.

Yves

# javascript - 如何获取 XDomainRequest 对象中的错误信息？

> ID：13592511
> 
> 赞同：4
> 
> 时间：2012-11-27T20:31:03.463
> 
> 标签：javascript, onerror, xdomainrequest

我看到调用了我的错误处理方法，**但**由于没有参数，我不知道如何检查它是**哪种**错误。

```
var xdr = new XDomainRequest();
xdr.onerror = function(e){
  alert(e);
} 
```

在上面的例子`e`中是*undefined*。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T20:48:55.550

执行 CORS 时，错误消息不可用。XDomainRequest**的***定义* 就是*cross-origin*。

 ***请参阅[此讨论](https://stackoverflow.com/questions/4844643/is-it-possible-to-trap-cors-errors)以及[此定义](http://www.w3.org/TR/cors/#handling-a-response-to-a-cross-origin-request)。***

# tcp - wireshark 按端口计数数据包

> ID：13592513
> 
> 赞同：0
> 
> 时间：2012-11-27T20:31:09.343
> 
> 标签：tcp, wireshark, packets

我有一个非常大的跟踪文件，并且正在尝试使用 Wireshark 来确定哪个目标端口发送给它的数据包最多。有没有办法获取发送到特定端口的数据包计数？还是按发送端口的数据包数排序？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T07:36:55.313

你可以在 lua中编写一个简单的 wireshark[监听器。](http://wiki.wireshark.org/Lua/Taps)

```
local tap 

local ports = {} 

local function packet(pinfo, tvb, userdata)
    -- store number of packets per each port
    local port = pinfo.dst_port
    ports[port] = (ports[port] or 0) + 1
end

local function draw(userdata)

    local maxi,maxv = 0,0
    -- print all gathered statictics and find max
    for i,v in pairs(ports) do
        print(i .. ":",  v)
        if maxv < v then
            maxi,maxv = i,v
        end
    end
    print ("Max:", maxi, maxv)
end

local function reset(userdata)
    ports = {}
end

local function show_ports()
    tap = Listener.new()
    tap.packet = packet
    tap.draw = draw 
    tap.reset = reset 
end

register_stat_cmd_arg('ports', show_ports) 
```

试试看：

```
tshark -X lua_script:ports.lua -z ports -r in.pcap 
```

# http - 创建 MAMP localhost 后无法加载 http

> ID：13592515
> 
> 赞同：1
> 
> 时间：2012-11-27T20:31:11.117
> 
> 标签：http, mamp

我目前正在使用[http://thomaskinkadegallery.com](http://thomaskinkadegallery.com) - 但是，现在我已经在本地计算机上设置了 localhost (http://thomaskinkadegallery.com:8888)，我无法再访问远程服务器了。我得到一个页面超时。我在另一台计算机上检查了该页面，它工作得很好。

是什么阻止了我机器上的网站？

# javascript - setTimeout to detect changes in a text field

> ID：13592520
> 
> 赞同：-1
> 
> 时间：2012-11-27T20:31:28.750
> 
> 标签：javascript, iframe, textarea

I wonder why the following sample code doesn't work properly:

```
<!DOCTYPE html>
<html>

    <head>
        <title></title>
        <style type="text/css">
            textarea, iframe {
                display:block;
                width:300px;
                height:100px;
                margin:3px;
                padding:3px;
                border:1px solid #CCC;
            }
        </style>
    </head>

    <body>
        <textarea id="field" onfocus="getFocus();" onblur="loseFocus();">This is some text.</textarea>
        <iframe name="target"></iframe>
        <script>
            var textarea = document.getElementById('field');
            var iframe = window.target.document;

            function displayResult() {
                if (textarea.value) {
                    iframe.open();
                    iframe.write(textarea.value);
                    iframe.close();
                }
                window.setTimeout(displayResult, 10);
            }

            function getFocus() {
                if (textarea.value == textarea.defaultValue) {
                    textarea.value = '';
                }
            }

            function loseFocus() {
                if (textarea.value == '') {
                    textarea.value = textarea.defaultValue;
                }
            }
            displayResult();
        </script>
    </body>

</html> 
```

Demo: [http://jsfiddle.net/RainLover/4ksMR/](http://jsfiddle.net/RainLover/4ksMR/)

The iframe content is supposed to get updated in real time -- as soon as the textarea content changes by keyboard or mouse. This approach is an alternative to the `oninput` event. But since `oninput` isn't well-supported across different browsers I decided to create a timer to compare the current text field value with its value in 10 milliseconds before.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T20:47:11.867

> *"Let me give an example: enter a sentence into the text field. Then select/highlight it. Now press the 'Delete' button on your keyboard. You won't see the same thing on the iframe"*

The problem is this line:

```
if (textarea.value) { 
```

If `textarea` is blank, i.e., the `.value` is an empty string, then the if condition is falsy and the copy to the iframe doesn't happen. Just remove the `if`.

Demo: [http://jsfiddle.net/4ksMR/1/](http://jsfiddle.net/4ksMR/1/)

(Note that this was the *only* case where I was able to duplicate your problem that changes were not reflected in the iframe.)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T20:41:06.157

why are you "polling" for changes? just append a keyup-handler (which notifies you when someone has typed into your textarea-field)

```
textarea.onkeyup = function() {
    // do whatever you want to do here
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T20:45:58.507

reconsider your implementation, here is simple sample with jquery, but surely it might be done on any other lib or even core JS

[http://jsbin.com/oraxeb/1](http://jsbin.com/oraxeb/1)

Just think about such improvements like:

1.  not every keyUp should works, for example Ctrl or arrows or shift or bunch or others, that's will improve performance

2.  initial default text - quite simple

3.  probably something else)

# asp.net - ASP.NET System.NullReferenceException：对象引用未设置为对象的实例

> ID：13592521
> 
> 赞同：0
> 
> 时间：2012-11-27T20:31:37.610
> 
> 标签：asp.net, connection, connection-string

我有以下代码

```
private string conn(string name)
    {
        return ConfigurationManager.ConnectionStrings[String.Format("{0}ConnectionString", name)].ConnectionString;
    } 
```

但是我在返回语句中不断收到以下错误。

> System.NullReferenceException：对象引用未设置为对象的实例

你能告诉我这有什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T20:39:33.090

您的代码查找名为 name +“ConnectionString”的连接字符串。看起来您的 web.config 没有具有此名称的连接字符串。添加具有生成名称的连接字符串或更改如下代码：

```
 private string conn(string name)
    {
        var coll = ConfigurationManager.ConnectionStrings[String.Format("{0}ConnectionString", name)];
        if (coll != null)
        {
            return coll.ConnectionString;
        }
        else
        {
            return null;
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T20:38:01.487

如果连接字符串返回 null，则会出现此错误，这意味着您没有设置通常在 web.config 文件中设置的连接字符串

```
<connectionStrings>
    <add name="connectionString" connectionString="Server=  (local);Database=sampledb;Trusted_Connection=true;" providerName="System.Data.SqlClient"/> 
</connectionStrings> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T20:38:21.807

如果传入方法的参数名称为 null 会发生什么？

您应该查看这篇[文章](https://stackoverflow.com/questions/13293603/how-to-tell-configurationmanager-connectionstrings-to-pull-specific-connection-s)，以及 SO 上已经提供的其他答案。

# windows - 在 Windows 上获取 Renesas USB 3.0 主机控制器驱动程序的版本

> ID：13592523
> 
> 赞同：0
> 
> 时间：2012-11-27T20:31:42.070
> 
> 标签：windows, usb

较早版本的 Renesas USB 3.0 主机控制器存在可能导致问题的问题。为了提醒我的客户注意这些问题，我需要检测过时的版本。为此，我想检索与瑞萨 USB 3.0 主机控制器实用程序相同的运行驱动程序版本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T20:31:42.070

使用 OSR IrpTracker，我已经确定了 IOCTL 和结构。这是打开每个 Renesas USB 主机控制器的设备接口并查询版本号的示例代码。

```
#include <initguid.h>
#include <windows.h>
#include <setupapi.h>
#include <stdlib.h>
#include <winioctl.h>

#include <pshpack1.h>

DEFINE_GUID(GUID_DEVINTERFACE_NUSB3XHC,              0xac051b02L, 0x603b, 0x4b3c, 0xb1, 0x4b, 0x95, 0xc9, 0x26, 0x8d, 0xe0, 0x81);

struct NUSB3XHC_DRIVER_VERSION
{
    UCHAR Major;
    UCHAR Minor;
    UCHAR Build;
    UCHAR Revision;
    UCHAR Unknown[2]; // no idea what this is -- {0, 0} on my machine
};

struct NUSB3XHC_FIRMWARE_VERSION
{
    USHORT BcdVersion; // UI displays this as BCD
};

#define IOCTL_NUSB3XHC_GET_DRIVER_VERSION CTL_CODE(FILE_DEVICE_UNKNOWN, 0x800, METHOD_BUFFERED, FILE_ANY_ACCESS)

#define IOCTL_NUSB3XHC_GET_FIRMWARE_VERSION CTL_CODE(FILE_DEVICE_UNKNOWN, 0x808, METHOD_BUFFERED, FILE_ANY_ACCESS)

#include <poppack.h>

BOOL GetVersion(LPCTSTR DevicePath, NUSB3XHC_DRIVER_VERSION* DriverVersion, NUSB3XHC_FIRMWARE_VERSION* FirmwareVersion)
{
    HANDLE hDevice = CreateFile(DevicePath, GENERIC_ALL, 0, NULL, OPEN_EXISTING, FILE_ATTRIBUTE_NORMAL, NULL);
    if (hDevice == NULL)
        return FALSE;

    BOOL success = FALSE;
    DWORD returned;
    if (DeviceIoControl(hDevice, IOCTL_NUSB3XHC_GET_DRIVER_VERSION, NULL, 0, DriverVersion, sizeof(NUSB3XHC_DRIVER_VERSION), &returned, NULL))
    {
        success = (returned == sizeof(NUSB3XHC_DRIVER_VERSION));
    }

    if (DeviceIoControl(hDevice, IOCTL_NUSB3XHC_GET_FIRMWARE_VERSION, NULL, 0, FirmwareVersion, sizeof(NUSB3XHC_FIRMWARE_VERSION), &returned, NULL))
    {
        success = success && (returned == sizeof(NUSB3XHC_FIRMWARE_VERSION));
    }

    CloseHandle(hDevice);

    return success;
}

int _tmain(int argc, _TCHAR* argv[])
{
    int crap = IOCTL_NUSB3XHC_GET_FIRMWARE_VERSION;

    HDEVINFO hDevInfo = SetupDiGetClassDevs(&GUID_DEVINTERFACE_NUSB3XHC, NULL, NULL, DIGCF_DEVICEINTERFACE | DIGCF_PRESENT);
    if (hDevInfo != INVALID_HANDLE_VALUE)
    {
        SP_DEVICE_INTERFACE_DATA devIfaceData;
        devIfaceData.cbSize = sizeof(SP_DEVICE_INTERFACE_DATA);

        DWORD Index = 0;

        do
        {
            if (!SetupDiEnumDeviceInterfaces(hDevInfo, NULL, &GUID_DEVINTERFACE_NUSB3XHC, Index, &devIfaceData))
                break; // hopefully ERROR_NO_MORE_ITEMS

            DWORD requiredSize;
            SetupDiGetDeviceInterfaceDetail(hDevInfo, &devIfaceData, NULL, NULL, &requiredSize, NULL);
            // returns with ERROR_INSUFFICIENT_BUFFER

            PSP_DEVICE_INTERFACE_DETAIL_DATA devIfaceDetailData =
                (PSP_DEVICE_INTERFACE_DETAIL_DATA) malloc(requiredSize);
            devIfaceDetailData->cbSize = sizeof(SP_DEVICE_INTERFACE_DETAIL_DATA);

            if (SetupDiGetDeviceInterfaceDetail(hDevInfo, &devIfaceData, devIfaceDetailData, requiredSize, NULL, NULL))
            {
                NUSB3XHC_DRIVER_VERSION driverVersion;
                NUSB3XHC_FIRMWARE_VERSION firmwareVersion;
                if (GetVersion(devIfaceDetailData->DevicePath, &driverVersion, &firmwareVersion))
                {
                    _tprintf(_T("%s: driver version: %d.%d.%d.%d, firmware version: %x\n"), devIfaceDetailData->DevicePath,
                        driverVersion.Major,
                        driverVersion.Minor,
                        driverVersion.Build,
                        driverVersion.Revision,
                        firmwareVersion.BcdVersion);
                }
                else
                {
                    _tprintf(_T("Failed getting version data from %s.\n"), devIfaceDetailData->DevicePath);
                }
            }

            free(devIfaceDetailData);

            ++Index;
        }
        while(1);
    }

    return 0;
} 
```

# jquery - 无限滚动，第一关掉页 - 同位素问题

> ID：13592526
> 
> 赞同：0
> 
> 时间：2012-11-27T20:31:48.700
> 
> 标签：jquery, jquery-isotope

使用同位素产生砌体效应

当我加载页面并向下滚动时，为了添加更多项目，我正在使用行为方法 twitter，所以我基本上点击了更多，但第一次点击时，项目“落”在页面上，我不知道为什么- 之后它可以接受但第一次点击不是

这是我正在使用的完整代码

```
$(document).ready(function () {

//$(function() {

  var $container = $('#wall');

  // isotope
  $container.isotope({
    itemSelector: '.wish_wrap_indiv',
    animationEngine : "best-available",
    getSortData: {
            name: function($element) {
                return $element.data('name');
            },

            site: function($element) {
                return $element.data('site');
            },

            date_added: function($element) {
                return $element.data('date_added');
            }

        }
  });

  // trigger Isotope layout again after images have loaded
  $container.imagesLoaded( function() {
    $container.isotope('reLayout');
  });

  // filter items when filter link is clicked
    $('#options a').click(function(){
      var selector = $(this).attr('data-filter');
      $container.isotope({ filter: selector });
      return false;
    });

    var $optionSets = $('#options .option-set'),
      $optionLinks = $optionSets.find('a');

    $optionLinks.click(function(){
    var $this = $(this);
    // don't proceed if already selected
    if ( $this.hasClass('selected') ) {
      return false;
    }
    var $optionSet = $this.parents('.option-set');
    $optionSet.find('.selected').removeClass('selected');
    $this.addClass('selected');

    });

  // infinite scroll
  $container.infinitescroll({
    navSelector  : "#page_nav",
                 // selector for the paged navigation (it will be hidden)
  nextSelector : "#page_nav a",
                 // selector for the NEXT link (to page 2)
  itemSelector : ".wish_wrap_indiv",
                 // selector for all items you'll retrieve
  behavior: "twitter",

  loading : {
            'finishedMsg' : 'No more wishes to load.',
            'img' : 'http://wishesandgifts.com/images_/icons/loading_sml.gif',
            'selector' : '#wall'
        }
    },
    // call Isotope as a callback
    function(newElements) {
      var $newElems = $(newElements);
      $newElems.imagesLoaded(function(){
        $container.isotope('insert', $newElems );
      });
    }
  );

}); 
```

我正在使用`$(document).ready(function () {`但也尝试过`$(function () {`

我还尝试使用“附加”插入新项目，但结果仍然相同。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-02T02:03:48.763

通过声明图像 W & H 修复

# javascript - 动态 Getter 和 Setter - 为什么这不起作用？

> ID：13592527
> 
> 赞同：2
> 
> 时间：2012-11-27T20:31:52.680
> 
> 标签：javascript, dynamic, getter-setter

我正在尝试创建一个动态构建自己的 getter 和 setter 的对象：

```
function Person( properties ) { // 'properties' is an object literal

    this._private = properties; // private by convention

    for ( key in this._private ) {

        this[key] = function() {

            return this._private[key];
        }
    }
} 
```

**我希望，这会创造出这样的东西：**

```
var jack = new Person({

    working:true,
    age:33,
    gender:'male'
});

jack.working() --> true
jack.age() --> 33
jack.gender() --> 'male' 
```

**问题是，它总是返回 'male'**，如下所示：

```
jack.working() --> 'male'
jack.age() --> 'male'
jack.gender() --> 'male' 
```

**我错过了什么？**哦，这只是一个概念证明。我知道这不是在 JavaScript 中创建 getter 和 setter 的完美解决方案。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-27T20:36:58.070

你有一个经典的范围界定问题。创建一个新函数来创建范围`key`：

```
function Person(properties) { // 'properties' is an object literal
    var key;

    this._private = properties; // private by convention
    this.buildGetter = function (key) {
        this[key] = function () {
            return this._private[key];
        }
    };
    for (key in this._private) {
        this.buildGetter(key);
    }
} 
```

**示例：http:** [//jsfiddle.net/SEujb/](http://jsfiddle.net/SEujb/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T20:51:41.180

每个人都说 eval 是邪恶的，但有时它是无法避免的：

```
function Person( properties ) { // 'properties' is an object literal

    this._private = properties; // private by convention

    for ( key in this._private ) {

        eval("this[key] = function() { return this._private['"+key.toString()+"'];}");
    }
} 
```

jsFiddle：http: [//jsfiddle.net/pitaj/9sWbe/1/](http://jsfiddle.net/pitaj/9sWbe/1/)

# java - 从apache HttpResponse java获取重定向Uri

> ID：13592530
> 
> 赞同：0
> 
> 时间：2012-11-27T20:32:07.280
> 
> 标签：java, redirect, httpresponse

图书馆员方法返回 apache HttpResponse 对象。我需要获取重定向 Uri。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T20:38:43.260

我认为您可以使用 `Location`标题：

```
response.getLastHeader("Location").getValue(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T15:23:20.957

要获得重定向 Uri，您必须做两件事：

1.  设置重定向到您的 HttpClient 实例：

    HttpClient httpclient = getNewHttpClient(); HttpClientParams.setRedirecting(httpclient.getParams(), false); // 检测重定向所必需的

2.  请求后从 HttpResponse 实例获取重定向 Uri：

    response.getLastHeader("位置").getValue();

# .htaccess - .htaccess 用查询字符串重写 URL

> ID：13592535
> 
> 赞同：3
> 
> 时间：2012-11-27T20:32:36.970
> 
> 标签：.htaccess, url, mod-rewrite, rewrite

我已经尝试了在 stackoverflow 上发布的大量解决方案，但似乎没有什么对我有用。我想重写我网站上的一些 URL 以使其对搜索引擎友好。

我想要这样的 URL：- [http://www.mysite.com/index.php?filter=accounts](http://www.mysite.com/index.php?filter=accounts) 显示为：- [http://www.mysite.com/accounts](http://www.mysite.com/accounts)

网络上的许多帖子都将其作为解决方案：-

```
RewriteRule ^([^/]+)/?$ index.php?filter=$1 [QSA,L] 
```

但这无济于事。

我的站点是一个 Joomla CMS 站点，并且已经在 .htaccess 文件中进行了一些重写。难道是我把我的新 RewriteRule 放错了地方？

这是未添加我的新 RewriteRule 的完整 .htaccess 文件

```
Options +FollowSymLinks
RewriteEngine On

# prevents people from accessing anything with phpMyAdmin
RewriteRule phpMyAdmin - [F]

# force canonical www if request is for non-www or has port number etc
RewriteCond %{HTTP_HOST} !^(www\.mysite\.com)?$
RewriteRule (.*) http://www.mysite.com/$1 [R=301,L]

RewriteCond %{QUERY_STRING} mosConfig_[a-zA-Z_]{1,21}(=|\%3D) [OR]
RewriteCond %{QUERY_STRING} base64_encode[^(]*\([^)]*\) [OR]
RewriteCond %{QUERY_STRING} (<|%3C)([^s]*s)+cript.*(>|%3E) [NC,OR]
RewriteCond %{QUERY_STRING} GLOBALS(=|\[|\%[0-9A-Z]{0,2}) [OR]
RewriteCond %{QUERY_STRING} _REQUEST(=|\[|\%[0-9A-Z]{0,2})
RewriteRule .* index.php [F]
RewriteBase /
RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]
RewriteCond %{REQUEST_URI} !^/index\.php
RewriteCond %{REQUEST_URI} (/[^.]*|\.(php|html?|feed|pdf|raw))$ [NC]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule .* index.php [L] 
```

任何帮助将非常感激。:-)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T21:09:58.630

**更新**

现在经过测试。试试这个：

```
RewriteEngine On
RewriteRule ^([a-zA-Z0-9-=_?]+)/?$ index.php?filter=$1 [L] 
```

**.htaccess**进入根目录。

请求的 URL 是*http://www.mysite.com/accounts/*但可以是任何东西：*http://www.mysite.com/apples/*。

注意：地址栏中显示的 URL 是在该地址栏中输入的 URL。我假设不是*http://www.mysite.com/index.php?filter=accounts*因为我猜重定向的目的是用更友好的替换它（*http://www.mysite.com/accounts* )，这是必须在地址栏中键入的内容，而不是相反。有点令人困惑，但我希望它是有道理的。

要对其进行测试，请在根目录的 index.php 中仅包含以下代码。

```
<?php 

if ($_GET['filter'] == 'accounts') {
echo "This is Accounts<br /><br />";    
}else {
echo "This is INDEX<br /><br />";       
}

?> 
```

至于将重写规则放在.htaccess 中的什么位置，我不知道。我想您必须在实际规则之前和之后尝试一下。

# updates - 通过网络在多台计算机上刷新 BIOS？

> ID：13592538
> 
> 赞同：0
> 
> 时间：2012-11-27T20:32:42.540
> 
> 标签：updates, bios

这可能是一个荒谬的问题，但有没有办法通过网络升级多台机器的 bios？

-我们有多台联想机器需要我们手动进行的 BIOS 更新。

- 我们使用 GhostCast 将 Windows 映像投射到我们的计算机上。

我四处搜寻，发现有人问类似的问题，但没有回应。

有什么可能性，或者这不可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T18:27:27.257

取决于 BIOS 和公司——我不知道联想提供了哪些选项。

某些戴尔商务舱（Optiplex/Lattitude/???），您可以使用戴尔提供的几种不同工具中的一种，从一个简单的实用程序，您可以使用更新的代码和设置（包括密码，如果需要） ) 然后你可以使用你最喜欢的方法推出，直到需要整个 SQL 服务器的基于服务器的怪物。（但是一旦它开始工作，它就会扫描网络并报告那里的内容，与它的内部存储库进行比较等）

如果 comps 支持 vPro 或任何带外管理，和/或您可以实现 PXE 引导，您可能会一起破解一些东西 - 取决于您正在谈论的 comps 数量，以及联想如何实现事物。

# java - 转换器 Java XML CDATA 重复行

> ID：13592539
> 
> 赞同：1
> 
> 时间：2012-11-27T20:32:42.710
> 
> 标签：java, xml, transformer

我在 JDK 7 中使用转换器来写出一些 XML，并且我在 CDATA 中有一个 freemarker 模板，如下所示：

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<fileExport append="false" automaticExport="false" automaticExportWithErrors="true" exportDir="C:\Users\bÃ¤nn\Desktop" exportFileName="&lt;date&gt; &lt;time&gt; &lt;barcode&gt;" exportType="Excel" splitFiles="false">
  <exportTemplate><![CDATA[Date,RackBarcode,Row,Col,tubeBarcode,OrientationBarcode
<#list racks as rack>
<#list rack.containers as container>
${scandate?datetime},${rack.barcode},${container.textRow},${container.col + 1},${container.barcode},${rack.orientationBarcode}
</#list>
</#list>]]></exportTemplate>
  <scanTimeQuestionsTemplate><![CDATA[<#if scanTimeQuestionsEnabled>
Scan Time Questions

<#list scanTimeQuestions as question>
${question.shortName} : ${question.answer}
</#list>

</#if>]]></scanTimeQuestionsTemplate>
  <excelExportTemplate writeHeader="true">
    <excelExportColumn columnDataFormatting="d/M/yyyy HH:mm" columnDataFromString="DATETIME" columnHeader="Scan Time"/>
    <excelExportColumn columnDataFormatting="" columnDataFromString="RACK_BARCODE" columnHeader="Rack Barcode"/>
    <excelExportColumn columnDataFormatting="" columnDataFromString="ORIENTATION_BARCODE" columnHeader="Orientation Barcode"/>
    <excelExportColumn columnDataFormatting="" columnDataFromString="TUBE_ROW_TEXT" columnHeader="Tube Row"/>
    <excelExportColumn columnDataFormatting="" columnDataFromString="TUBE_COLUMN" columnHeader="Tube Column"/>
    <excelExportColumn columnDataFormatting="" columnDataFromString="TUBE_BARCODE" columnHeader="Tube Barcode"/>
    <excelExportColumn columnDataFormatting="d/M/yyy HH:mm:ss" columnDataFromString="DATETIME" columnHeader="Scan Datetime"/>
  </excelExportTemplate>
</fileExport>

</#if>

]]></scanTimeQuestionsTemplate>
  <excelExportTemplate writeHeader="false">
    <excelExportColumn columnDataFormatting="d/M/yyyy HH:mm" columnDataFromString="DATETIME" columnHeader="Scan Time"/>
    <excelExportColumn columnDataFormatting="" columnDataFromString="RACK_BARCODE" columnHeader="Rack Barcode"/>
    <excelExportColumn columnDataFormatting="" columnDataFromString="ORIENTATION_BARCODE" columnHeader="Orientation Barcode"/>
    <excelExportColumn columnDataFormatting="" columnDataFromString="TUBE_ROW_TEXT" columnHeader="Tube Row"/>
    <excelExportColumn columnDataFormatting="" columnDataFromString="TUBE_COLUMN" columnHeader="Tube Column"/>
    <excelExportColumn columnDataFormatting="" columnDataFromString="TUBE_BARCODE" columnHeader="Tube Barcode"/>
  </excelExportTemplate>
</fileExport> 
```

但是，当我在 Windows 计算机上写出这个时，变压器会在输出的 CDATA 中添加一个额外的 \r，所以我有：

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<fileExport append="false" automaticExport="false" automaticExportWithErrors="false" exportDir="C:\Users\benn\Desktop" exportFileName="" exportType="text" splitFiles="false">
  <exportTemplate><![CDATA[Date,RackBarcode,Row,Col,tubeBarcode,OrientationBarcode

<#list racks as rack>

<#list rack.containers as container>

${scandate?datetime},${rack.barcode},${container.textRow},${container.col + 1},${container.barcode},${rack.orientationBarcode}

</#list>

</#list>

]]></exportTemplate>
  <scanTimeQuestionsTemplate><![CDATA[<#if scanTimeQuestionsEnabled>

Scan Time Questions

<#list scanTimeQuestions as question>

${question.shortName} : ${question.answer}

</#list>

</#if>

]]></scanTimeQuestionsTemplate>
  <excelExportTemplate writeHeader="false">
    <excelExportColumn columnDataFormatting="d/M/yyyy HH:mm" columnDataFromString="DATETIME" columnHeader="Scan Time"/>
    <excelExportColumn columnDataFormatting="" columnDataFromString="RACK_BARCODE" columnHeader="Rack Barcode"/>
    <excelExportColumn columnDataFormatting="" columnDataFromString="ORIENTATION_BARCODE" columnHeader="Orientation Barcode"/>
    <excelExportColumn columnDataFormatting="" columnDataFromString="TUBE_ROW_TEXT" columnHeader="Tube Row"/>
    <excelExportColumn columnDataFormatting="" columnDataFromString="TUBE_COLUMN" columnHeader="Tube Column"/>
    <excelExportColumn columnDataFormatting="" columnDataFromString="TUBE_BARCODE" columnHeader="Tube Barcode"/>
  </excelExportTemplate>
</fileExport> 
```

所以基本上 \r\n 正在变成 \r\r\n - 我已经看到一些关于 Xalan 这样做的消息，但我正在使用 JDK 7 提供的任何东西作为后台引擎；有没有人看到这个，我可以设置一个属性来停止变压器在我的 CDATA 中放置一个额外的换行符>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T21:08:37.113

我已经看到了一些冗长的解决方法（搜索“xalan newline”），所以我会做什么：

1.  确保源代码只有 Unix 行尾`\n`（编辑器设置）。
2.  `System.setProperty("file.encoding", "\n");`

可能 1\. 就足够了，因为 2\. 很丑。

# css - div 内的 div 位置

> ID：13592541
> 
> 赞同：-1
> 
> 时间：2012-11-27T20:32:50.510
> 
> 标签：css, html

好吧，我希望[内部](http://jsbin.com/welcome/54029/edit)div 位于包含 div 的底部。

我尝试过底部：0px；但它不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T20:36:04.040

您需要`position: absolute;`与`bottom: 0;`. 您可能需要`position:relative;`在外部 div 上（取决于您的结构）。

# database - Django，主从之间智能路由

> ID：13592542
> 
> 赞同：1
> 
> 时间：2012-11-27T20:32:56.983
> 
> 标签：database, django, router

我有一个 django 应用程序，它有一个输入数据的前端和一个提供数据的 API。有一个主/从设置，所以我使用数据库路由器来管理对主控的写入和从从属的读取。

```
import random
from django.conf import settings

class DBMasterSlaveRouter(object):
    def db_for_read(self, model, **hints):
        if len(settings.DB_SLAVES) >= 1:
            return random.choice(settings.DB_SLAVES)
        else:
            return settings.DB_MASTER

    def db_for_write(self, model, **hints):
        return settings.DB_MASTER

    def allow_syncdb(self, db, model):
        return True 
```

我遇到的问题是在前端，用户输入数据并点击保存，页面重新加载并从从属加载数据（这发生得非常快），因为主从之间存在滞后，负载不会反映最新输入。我不想延迟页面加载。现在我必须`using('default')`强制从前端的 master 读取

任何想法如何解决这一问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-27T22:57:03.310

看起来这是答案：

[https://github.com/jbalogh/django-multidb-router](https://github.com/jbalogh/django-multidb-router)

# visual-studio-2010 - 由于定期网络访问，visual studio 2010 非常慢。怎么解决？

> ID：13592544
> 
> 赞同：1
> 
> 时间：2012-11-27T20:33:01.853
> 
> 标签：visual-studio-2010

我的 Visual Studio 2010 突然变得异常缓慢。几乎每次鼠标点击后，VS 都会挂起大约 10 秒。我发现了一个相关的问题，提出网络流量可能是原因：

[视觉工作室非常非常慢](https://stackoverflow.com/questions/11873470/visual-studio-very-very-slow)

我注意到当我在工作中将笔记本电脑插入扩展坞时问题消失了。然后我发现当我关闭 WLAN 时问题也消失了（没有额外的互联网连接）。

我检查了[进程监视器](http://technet.microsoft.com/en-us/sysinternals/bb896645.aspx)，发现 Visual Studio 确实执行了很多网络请求，但是当 WLAN 关闭时（显然）没有这样做。

这是过程监视器的打印屏幕：

![ProcessMonitor 的屏幕截图](../Images/d2b31faab1d2f53eca3826cad15d44ef.png)

现在，问题已经确定，但我真的不知道如何解决它。有谁知道如何解决这个问题？

亲切的问候， Jaap Kokorian

# windows-phone-7 - Direct3D-XAML 应用程序的激活永远不会被触发

> ID：13592545
> 
> 赞同：0
> 
> 时间：2012-11-27T20:33:04.737
> 
> 标签：windows-phone-7, xaml, windows-phone, lifecycle, windows-phone-8

我只是在测试一个由 Visual Studio 2012 生成的 Windows Phone 8 Direct3D XAML 应用程序。我注意到，从附加到的 PhoneApplicationService 事件（启动、激活、关闭、停用），Activated 永远不会被调用。我一直在试图弄清楚如何做到这一点。

我试过了：

*   打开应用程序，点击 Windows 按钮，然后重新打开应用程序。
*   打开应用程序，点击后退按钮并重新打开应用程序。
*   来自警报应用程序的警报会在应用程序上显示一个窗口

我可以在设备或模拟器上做什么来获得被激活的调用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T10:06:25.330

你的尝试是错误的。当您重新打开应用程序或在主屏幕上点击关闭时，您将获得 Launching 事件。要激活，您需要在应用程序处于活动状态时按 Windows 键，然后按返回键。这将使您返回到您的应用程序并触发 Activated 事件。

你在你的案例中得到的是：

*   启动 -> 停用 -> 启动
*   启动 -> 关闭 -> 启动
*   屏幕被遮挡

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T21:22:06.557

打开另一个应用程序然后返回到您的应用程序是您需要做的所有事情才能让激活启动。您如何测试激活？

# c# - 这是如何抛出 InvalidCastException

> ID：13592546
> 
> 赞同：1
> 
> 时间：2012-11-27T20:33:12.760
> 
> 标签：c#, .net, anonymous-methods

以下代码片段在 foreach 循环中引发 InvalidCastException：

> 无法将“System.Windows.Forms.StatusStrip”类型的对象转换为“System.Windows.Forms.GroupBox”类型。

我只是不明白这是怎么可能的......然后我又是一个菜鸟，所以它可能很愚蠢。

```
 private void doSlide(GroupBox MoveThis)
    {
        //location 12,27
        var t = Task.Factory.StartNew(() =>
            {
                ExecuteSecure(() =>
                    {
                            foreach (GroupBox box in this.Controls)
                            {
                                if (box != MoveThis)
                                {
                                    box.Left = (-1) * box.Width;
                                }
                                else
                                {
                                    do
                                    {
                                        if (box.Left > 12)
                                            box.Left--;
                                        else
                                            box.Left++;
                                    }
                                    while (box.Left != 12);
                                }
                            }

                    });
            });
    } 
```

这是执行安全的代码

```
private void ExecuteSecure(Action a)
        {
            if (InvokeRequired)
                BeginInvoke(a);
            else a();
        } 
```

基本上我有一个固定大小的表单和几个组框，在任何给定点上只有一个是可见的。当我们需要使一个新的 GroupBox 可见时，我们调用 DoSlide(GroupBox) 并指定我们想要使其可见的 groupbox。然后应该将表单上的每个 GroupBox 移动到位置 (-Box.Width,27)，但指定的表单除外，它会滑动（递增或递减 box.left）进入视图。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-27T20:36:11.067

你想用

```
this.Controls.OfType<GroupBox>() 
```

在你的 foreach 中。This.Controls 返回所有控件，而不仅仅是 GroupBoxes。扩展方法将`OfType<T>`集合过滤为您指定的类型。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-27T20:36:47.890

当您遍历每个控件时，您应该确定控件的类型，而不仅仅是假设它们都是 GroupBox 对象

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-27T20:39:34.533

`Controls`并非集合中的每个控件都是`GroupBox`（显然），但`foreach`试图将它们内联。

所以，把你的循环改成这样：

```
foreach (var control in this.Controls)
{
    if(control is GroupBox)
    {
        if (control != MoveThis)
        {
            control.Left = (-1) * control.Width;
        }
        else
        {
            do
            {
                if (control.Left > 12)
                    control.Left--;
                else
                    control.Left++;
            }
            while (control.Left != 12);
        }
    }
} 
```

**编辑：**值得注意的是，这可能会非常慢，因为您正在评估表单中每个控件的类型。John Kraft 和 Steve 都建议的代码应该将控件集合过滤为那些`GroupBox`，这样可能会产生更好的性能......

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-27T20:37:35.370

this.Controls 集合包含所有表单第一级控件，因此并非其中的每个控件都是 GroupBox。您只需要获取 GroupBox 控件

使用此语法更改循环

```
foreach (GroupBox box in this.Controls.OfType<GroupBox>())
{
   ....
} 
```

# php - 如何使用 PHP 对范围内的数字进行分组

> ID：13592547
> 
> 赞同：4
> 
> 时间：2012-11-27T20:33:18.967
> 
> 标签：php, algorithm, sorting

假设我在数组中有以下数字序列：

```
$numbers = array(1,3,2,23,24,25,26, 8) 
```

如何在范围内打印它们，例如：

> 数字是 1-3、23-26、8。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-27T20:50:28.000

这是一个简单的版本，创建`groups`包含您的范围

```
<?php
$numbers = array(1,3,2,23,24,25,26,8);
sort($numbers);
$groups = array();

for($i = 0; $i < count($numbers); $i++)
{
    if($i > 0 && ($numbers[$i - 1] == $numbers[$i] - 1))
        array_push($groups[count($groups) - 1], $numbers[$i]);
    else // First value or no match, create a new group
        array_push($groups, array($numbers[$i])); 
}

foreach($groups as $group)
{
    if(count($group) == 1) // Single value
        echo $group[0] . "\n";
    else // Range of values, minimum in [0], maximum in [count($group) - 1]
        echo $group[0] . " - " . $group[count($group) - 1] . "\n";
} 
```

输出是

```
1 - 3
8
23 - 26 
```

现在，如果你的范围的顺序很重要，就像你在问题中描述的那样，你仍然可以对你的组进行排序......从我所看到的，你想要范围首先是单个值？这可以通过添加来完成

```
function groupRanges($a, $b)
{
    if(count($a) == 1)
        if(count($b) == 1)
            return 0; // equal
        else
            return 1; // so $b is considered less than

    if(count($b) == 1)
        return -1; // so $a is considered less than

    return 0; // both are ranges, keep them there... could be adjusted to compare the size of each range
}

usort($groups, "groupRanges"); 
```

就在 and 之前`foreach`，输出变为：

```
1 - 3
23 - 26
8 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T08:49:06.360

昨天不能发这个，所以我很晚了。认为它足够优雅，可以分享它。

```
<?php

$numbers = array(1, 3, 2, 23, 24, 25, 26, 8);
sort($numbers);
$result = array();

while (count($numbers) > 0)
{
    $begin = reset($numbers);
    $end = array_shift($numbers);

    while (in_array($end + 1, $numbers))
    {
        $end = array_shift($numbers);
    }
    $beginAndEnd = array_unique(array($begin, $end));
    $result[] = implode('-', $beginAndEnd);
}
var_dump($result);
?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T20:58:43.013

我知道我参加聚会有点晚了，但我不得不这样做。

```
<?php
$numbers = array(1,3,2,23,24,25,26,8);
sort($numbers);
$x=0;
$output = array();
foreach($numbers as $k=>$n){
    if(isset($numbers[$k+1]) && $numbers[$k+1]==$n+1){
        $output[$x][]=$n;
    }elseif(isset($output[$x][count($output[$x])-1]) && $output[$x][count($output[$x])-1]+1==$n){
        $output[$x][]=$n;
    }else{
        $x++;
        $output[$x][] = $n;
        $x++;
    }
}
foreach($output as $o){
    echo $o[0];
    if(isset($o[count($o)-1]) && $o[count($o)-1]!=$o[0]){
        echo ' - '.$o[count($o)-1];
    }
    echo '<br>';
}?> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-27T20:45:25.130

```
$numbers = array(1,3,2,23,24,25,26,8);

$result = array();

$sorted = $numbers;
sort($sorted);

$current = null;
foreach ($sorted as $v) {
    if (is_null($current)) {
        $current = array($v, $v);
    } else {
        if ($current[1] + 1 == $v) {
            $current[1] = $v;
        } else {
            $result[] = $current;
            $current = array($v, $v);
        }
    }
}

$result[] = $current;

$arranged = array();

foreach ($numbers as $v) {
    foreach ($result as $k => $r) {
        if ($v >= $r[0] && $v <= $r[1]) {
            $arranged[] = $r;
            unset($result[$k]);
            break;
        }
    }
}

var_dump($arranged); 
```

[http://ideone.com/i2YGod](http://ideone.com/i2YGod)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-27T21:10:52.403

首先对数组进行排序，比如 array `A`。然后对其进行二分查找。说数组的大小`n`：

取`A[n/2]`, 处的元素`n/2`。

if `A[n/2]-A[n/4] = n/2-n/4`, then `A[n/2]`和`A[n/4]`是否在同一个组中——跳过`A[3n/8]`并检查`A[n/8]`是否`A[n/2]-A[n/8] = n/2-n/8`.

如果`A[n/2]-A[n/4] != n/2-n/4`，那么您手头有两组——一组在，另一组 `A[n/2]`在`A[n/4]`。检查`A[n/8]`它是否在同一组中 `A[n/4]`。检查`A[3/8]`它是否与 同组`A[n/2]`，如果不是，是否在组中`A[n/4]`。

您也可以将它与排序算法结合使用，但我认为这不值得。这是快速的——在对数时间内并且是模块化的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-27T22:36:52.977

```
$sorted = $numbers; 
sort($sorted);
$sorted[] = null;  # add a null so the last iteration stores the final range
$ranges = array();
$end = null;
$start = null;

foreach ($sorted as $x) {
    if ($start === null) {
        # first iteration.  New range, but there's no previous one to mention
        $start = $x;
    }
    elseif ($x !== $end + 1) {
        # non-contiguous values == new range.
        # squirrel away the one we were just working on, and start fresh
        $ranges[] = ($start === $end) ? "$start" : "$start-$end";
        $start = $x;
    }
    $end = $x;
}

$ranges_str = implode(', ', $ranges); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-04-19T23:47:21.403

```
function get_ranges($numbers) {
sort($numbers);
$ranges=array();
while(current($numbers)){
$start=current($numbers);
$next=next($numbers);
$current=$start;
while( ($next-$current)==1){
    $current=$next;
    $next=next($numbers);
}
$ranges[]=array('start'=>$start,'end'=>$current);
}

return $ranges;

} 
```

# android - 开始使用适用于 Android 的 Amazon Mechanical Turk

> ID：13592553
> 
> 赞同：0
> 
> 时间：2012-11-27T20:33:50.183
> 
> 标签：android, mechanicalturk

我一直在开发一个使用相机拍摄图像的应用程序，我想将图像发送到亚马逊的 Mechanical turk 服务，并从该服务中获取他的图像描述。

我完全不知道如何做到这一点。我目前已经为 mturk 设置了 java sdk。我找不到任何关于我必须如何进行的文件。我能否直接从我的应用程序发送机械土耳其人请求，还是必须通过后端服务器发送？如果有人能指出我正确的方向，我将不胜感激。

谢谢，

缺口

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T15:32:07.693

您无需运行服务器。Java API“在后台”将您连接到 Amazon 服务器，您可以自由地使用 API。

您需要先向 Amazon Web Services 和 Amazon MTurk 注册并获得访问密钥和秘密访问密钥 ( [https://portal.aws.amazon.com/gp/aws/securityCredentials](https://portal.aws.amazon.com/gp/aws/securityCredentials) )，这将使您能够直接访问他们的 API .

这是包含详细信息的 Java 安装链接[http://aws.amazon.com/code/695](http://aws.amazon.com/code/695)。

另外，请记住在测试时使用沙箱，而不是实时站点。

# android - 动态文本视图属性

> ID：13592557
> 
> 赞同：0
> 
> 时间：2012-11-27T20:34:08.063
> 
> 标签：android, android-layout

我想动态创建一个文本视图并设置属性。

```
LinearLayout timeBar = (LinearLayout)findViewById(R.id.linear_layout_cells);
TextView tv = new TextView(this);
timeBar.addView(tv); 
```

我需要能够设置高度以匹配父级，宽度为零，重量将是 100 的百分比，我还需要设置背景颜色。这甚至可能吗？

非常感谢任何帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T20:37:23.227

是的，只需创建一个[LinearLayout.LayoutParams](http://developer.android.com/reference/android/widget/LinearLayout.LayoutParams.html)实例。它有一个宽度、高度和重量的构造函数。然后，调用`tv.setLayoutParams()`。

在这种情况下，您使用`LinearLayout.LayoutParams`是因为您`TextView`正在进入`LinearLayout`. 这是一个更正式的例子：

```
LinearLayout timeBar = (LinearLayout)findViewById(R.id.linear_layout_cells);
TextView tv = new TextView(this);
float weight = 0.5f; //your value goes here.
tv.setLayoutParams(new LinearLayout.LayoutParams(0, ViewGroup.LayoutParams.MATCH_PARENT, weight));
timeBar.addView(tv); 
```

# jquery - jQuery .html() 方法会泄漏内存吗？

> ID：13592562
> 
> 赞同：13
> 
> 时间：2012-11-27T20:34:53.097
> 
> 标签：jquery, memory, memory-leaks

我正在构建一个`requestAnimationFrame`包含对 jQuery`html()`方法调用的循环的游戏。它只是更新游戏动作旁边的状态窗口中的文本。

我注意到 Chrome 的时间线监视器，DOM 节点在每分钟上千个！当我从以下位置更改代码时：

```
// creates a ton of DOM nodes
$("#readout").html(data); 
```

至

```
// DOM nodes does not increase over time
document.getElementById('readout').innerHTML = data; 
```

“内存泄漏”消失了。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-04T09:59:28.043

简短的回答：没有。

长答案：您的页面/代码中可能还有其他内容。

内存泄漏通常是由 Javascript 引擎和 DOM 之间的循环引用引起的。例如：

```
var div = document.getElementById('divId');
div.onclick = function() {
    doSomething(div);
}; 
```

该脚本获取对页面上 div 的引用。到目前为止，我们很好。下一行将一个函数分配给 DOM 上的事件处理程序，创建从 DOM 到 Javascript 引擎的引用 - 泄漏的一半。函数体使用标签，它创建了一个闭包——标签引用与函数一起保存，以供将来调用它。这样就完成了标签 -> 函数 (DOM -> JS) 和函数 -> 标签 (JS -> DOM) 之间的循环引用，因此 2 将位于内存中，直到浏览器的进程被销毁。

因此，为了使您提到的任何一行代码泄漏，它必须消除带有如上所述附加事件的标签（或遵循类似模式的数据）。但是，jQuery 的 .html(string) 不遗余力地阻止了这些：

```
// Remove element nodes and prevent memory leaks
elem = this[i] || {};
if ( elem.nodeType === 1 ) {
    jQuery.cleanData( getAll( elem, false ) );
    elem.innerHTML = value;
} 
```

因此，它会遍历您正在运行 .html(string) 的标签内的*所有*标签，并在它们上运行 cleanData() ，这反过来又会这样做：

```
jQuery.removeEvent( elem, type, data.handle ); 
```

从而防止泄漏。

因此，为了使用这种方法而*不是*浏览器内置的 .innerHTML 泄漏内存，您必须触发一些非常模糊的浏览器错误（似乎不太可能），或者更有可能发生其他事情而您误会了对于 jQuery 的 .html（字符串）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-06T19:11:11.177

总是使用`.empty().html(...)`而不是仅仅使用`.html()`

`.empty()`将事件侦听器与您要移除的 DOM 对象解除绑定，并优雅地移除它们。

# windows - 使用 VB.Net 强制关闭受保护的服务

> ID：13592563
> 
> 赞同：0
> 
> 时间：2012-11-27T20:34:57.220
> 
> 标签：windows, vb.net, service

我的 Windows 的一些正在运行的服务（主要是安全软件服务）无法停止。这些服务的启动/停止选项被禁用。如何使用我的 vb.net 强制关闭这些服务？

我正在使用 Windows 7 64 位。我要关闭的服务是我的安全软件的防火墙服务。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T21:28:41.207

假设服务有对应的进程，可以试试[Taskkill](http://technet.microsoft.com/en-us/library/bb491009.aspx)：

```
Taskkill /f 
```

您可以使用[Shell](http://msdn.microsoft.com/en-us/library/xe736fyk%28v=vs.71%29.aspx)从您的程序中运行上述内容。

或使用[Process.Start ，如此](http://msdn.microsoft.com/en-us/library/system.diagnostics.process.start.aspx)[处](https://stackoverflow.com/questions/258416/shellexecute-equivalent-in-net)建议。

# entity-framework-5 - VS 2012 EF 5 使用 .net 4 和数据库优先分层应用程序概念

> ID：13592564
> 
> 赞同：1
> 
> 时间：2012-11-27T20:35:09.180
> 
> 标签：entity-framework-5

我从 VS2005 升级到 VS2012，专门用于在 .Net 4、.Net 4.5 中编码，并使用 EF5。我是 EF 的新手。我有 Julie 的 EF 书，但它主要谈论 EF4 和 POCO，它让我在尝试实施 EF5 时感到困惑。

我的主机目前只允许我运行 .Net 4。我正在尝试在新数据库上使用 EF5。我首先尝试了 Code 来生成我的数据库，但我无法让它生成数据库。所以我先创建了数据库，然后用EF5从数据库中生成了模型。我想要的是一个使用 ASP.NET 表单、数据访问层和业务层的分层网站。我打算构建的业务层，因此我可以使用 ObjectDataSource 与一些 Web 服务一起拉入网页，以使用级联下拉菜单。

我创建了我的 NameX.edm 模型，但 tt 文件没有相同的名称，它们有 Model1.tt 和 Model1.Context.tt 的名称不同，为什么。Model1.Context.tt 也是空的。我正在尝试创建运行 EF5 DbContext 的 POCO 类，但我无法让它看到 edm 模型。我在某处读到 EF5 会自动创建 POCO。我在这里没有看到大局。我的问题是我没有使用 .Net4.5 吗？

我拥有的是一个 ASP.NET 应用程序项目、一个 EF 项目、一个 POCO 项目，并打算拥有一个具有业务逻辑的第四个项目。如何正确生成 EF 和 POCO 类？我想要一个分层的应用程序来很好地扩展。下一个问题如何让 POCO 类与业务逻辑对话？我的数据库是 SQL。我习惯于编写存储过程来通过业务逻辑完成所有事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T21:13:44.367

如果您使用的是模型优先技术，请确保您有对*System.Data.Entity*和*System.Data.Entity.Design*的引用。此外，您还需要创建对 EntityFramework.dll 的引用。它默认位于*c:\Program Files\Microsoft ADO.NET Entity Framework Feature CTP5\Binaries\EntityFramework.dll 中*。如果找不到它，请确保您已通过包管理器控制台安装了实体框架。为此，请打开工具、库包管理器、包管理器控制台，然后键入*Install-Package EntityFrameWork*。

接下来，您要向项目中添加新项目。右键单击您的解决方案，转到添加，然后选择新项目。您想从左侧的 Common Items 部分中选择 Data，然后选择 ADO.NET Entity Data Model。

接下来选择从数据库生成。在下一个屏幕中，如果您尚未设置与服务器的连接，请单击*New Connection...*，否则从下拉框中选择您的数据库。您需要选择是否要在配置文件中包含连接字符串信息。这取决于您需要应用程序的安全性。如果您选择不这样做，则需要将此信息作为代码中的参数传递。同样在底部，您很可能希望将自动生成的实体名称更改为更易于使用的名称。该名称将是您的 DBContext 类的名称！

接下来，您要选择您希望 EF 为其创建 POCO 的表。如果您想要所有表格，只需勾选表格项目。视图和存储过程也是如此。

单击完成后，您应该会在设计模式下看到所有精美的 POCOS 都摆在您面前。**注意**如果您的所有表都没有主键，我建议您修复它！如果您没有设置主键，或者您的表中的命名约定阻止 VS 为您隐式创建它们，VS 会向您吐口水。

这是一个快速启动和运行的小教程。您现在可以使用 DBContext 对象从 POCOS 中持久化和提取数据。例如，如果您将 DBContext 类命名为 *Gary_Bettman_Sucks*，并且您想从名为*NHL*的表中创建一条新记录，您将执行以下操作：

```
Dim context as New Gary_Bettman_Sucks

Dim PullMyGoalie as New NHL With {
    .Goals = 0,
    .Playoffs = False
}

context.Set(Of NHL).Add(PullMyGoalie)
context.SaveChanges() 
```

我**强烈**建议您考虑在您的设计中实现存储库模式，以鼓励代码重用，这将使您的生活更加轻松。

希望这可以帮助！

# javascript - 更新 gRaphael 折线图列值

> ID：13592566
> 
> 赞同：2
> 
> 时间：2012-11-27T20:35:14.707
> 
> 标签：javascript, jquery, raphael, graphael

我有一个 gRaphael 折线图，我使用下面的函数在点击时更新，我遇到的问题是当我尝试设置列值时，它没有生效。像这样...

```
 var iniGraph   = Raphael("graph"),
        chart = iniGraph.linechart(
                0,5,
                $('#graph').width(),$('#graph').height(),
                xVals,yVals,
                { nostroke: false, symbol: ["circle",""], width: 1.5, smooth: true, shade: true, colors: ['#008cc2', '#7500c6'] }
         ).hoverColumn(function(){
                // AFTER UPDATE THESE VALUES STILL REMAIN UNCHANGED
                console.log(this.values[0]+" | "+this.values[1]);
         },function(){
                // do nothing
         });

    function animateChart(graph,curChart,newX,newY)
    {
        // generate the new chart
        var newChart = graph.linechart(
                0,5,
                $('#graph').width(),$('#graph').height(),
                newX,
                newY,
                { nostroke: false, symbol: ["circle",""], width: 1.5, smooth: true, shade: true, colors: ['#008cc2', '#7500c6'] }
         );

        // THIS DOES NOT WORK, THE ORIGINAL VALUES REMAIN AFTER UPDATE 
        curChart.eachColumn(function(){
            this.values[0] = 12341234;
            this.values[1] = 12341234;
        });

        // animate the symbols
        $.each(curChart.symbols[0],function(i,symbol){
            symbol.animate({ cx: newChart.symbols[0][i].attr("cx"),cy: newChart.symbols[0][i].attr("cy") }, 200);
        });

        // animate the lines
        $.each(curChart.lines,function(i,line){
            line.animate({ path: newChart.lines[i].attr("path") }, 200);
        });

        // remove the new chart
        newChart.remove();
    } 
```

我创建了一个初始图形并创建了折线图，然后我使用该`animateChart`函数将折线图设置为动画/更新为它的新值，我遇到的问题是在悬停时，`animateChart`函数运行后值保持不变，所以我坚持使用图表的初始值，这并不理想，因为我必须让列值更新为我指定的新值。

所以基本上，当我动画/更新折线图时如何更新列值？

我有点走投无路了……谢谢。

# html - 向下浮动的 HTML 表格

> ID：13592569
> 
> 赞同：1
> 
> 时间：2012-11-27T20:35:28.153
> 
> 标签：html, css, layout, html-table

[https://eportal.enlinx.com/test/rates.php](https://eportal.enlinx.com/test/rates.php) 是我正在构建的网络工具，但我无法让显示正常工作。我希望这三列在标题外观的底部边框下方显示表格。想法是在这三个主要列中的每一个中都有两列的表格，因为每种运输方式的结果将显示在类型名称右侧的列中。奇怪的是，表格看起来的距离与表格中的行数成正比？

这是 HTML 和 CSS 文件：

（HTML）：

```
<?php 
    include 'rates_header.php';

    // Rates Calculation Call

?>

            <!-- Header-type bar for freight calculation input -->
            <div id="inputBar">
                <!-- Warehouse List -- JUST Salt Lake City for now (store as address) -->
                <span>
                    <p>Warehouse</p>
                    <select>
                        <option id="warehouse">Enlinx -- Salt Lake City</option>
                    </select>
                </span>

                <!-- Country >> Fill by database query? * Choose one default country for now! -->
                <span>
                    <p>Country</p>
                    <select>
                        <option id="country">US</option>
                    </select>
                </span>

                <!-- City -->
                <span>
                    <p>City</p>
                    <input id="city" type="text" value="Seattle" />
                </span>

                <!-- State -->
                <span>
                    <p>State</p>
                    <select>
                        <option id="state">WA</option>
                    </select>
                </span>

                <!-- Zipcode of Destination -->
                <span>
                    <p>Zip</p>
                    <input type="text" id="zipcode" value="98115" />
                </span>

                <!-- Weight of Package -->
                <span>
                    <p>Weight</p>
                    <input type="text" id="weight" value="2.00" />
                </span>

                <!-- Method -->
                <span>
                    <p>Method</p>
                    <select>
                        <option value="commercial">Commercial</option>
                        <option value="residential">Residential</option>
                    </select>
                </span>

                <!-- Dimensions -->
                <span>
                    <p>Dimensions in inches (LxWxH)</p>
                    <input type="text" id="length" /> x <input type="text" id="width" /> x <input type="text" id="height" />
                </span>
            </div>

            <!-- Freight Results Body && Shipping-type selection -->
            <div id="freightBody">

                <div id="FedExDiv">
                    <span class='caption'>
                        <h3>FedEx</h3>
                    </span>
                    <table> <!--... Third Party Billing options LEFT OUT -- what do with? -->
                        <tr>
                            <th><span class='service'>FedEx 2Day Commercial</span></th>
                            <th><span class='result' id='FedEx2DayCommercialResult'></span></th>
                        </tr><br />
                        <tr>
                            <th><span class='service'>FedEx 2Day Residential</span></th>
                            <th><span class='result' id='FedEx2DayResidentialResult'></span></th>
                        </tr><br />
                        <tr>
                            <th><span class='service'>FedEx 2Day</span></th>
                            <th><span class='result' id='FedEx2DayResult'></span></th>
                        </tr><br />
                        <tr>
                            <th><span class='service'>FedEx Economy Puerto Rico Collect</span></th>
                            <th><span class='result' id='FedExEconomyPuertoRicoCollectResult'></span></th>
                        </tr><br />
                        <tr>
                            <th><span class='service'>FedEx Economy Puerto Rico Pre-Paid</span></th>
                            <th><span class='result' id='FedExEconomyPuertoRicoPre-PaidResult'></span></th>
                        </tr><br />
                        <tr>
                            <th><span class='service'>FedEx Express Saver</span></th>
                            <th><span class='result' id='FedExExpressSaverResult'></span></th>
                        </tr><br />
                        <tr>
                            <th><span class='service'>FedEx Ground</span></th>
                            <th><span class='result' id='FedExGroundResult'></span></th>
                        </tr><br />
                        <tr>
                            <th><span class='service'>FedEx International Collect</span></th>
                            <th><span class='result' id='FedExInternationalCollectResult'></span></th>
                        </tr><br />
                        <tr>
                            <th><span class='service'>FedEx International Economy</span></th>
                            <th><span class='result' id='FedExInternationalEconomyResult'></span></th>
                        </tr><br />
                        <tr>
                            <th><span class='service'>FedEx International Pre-Paid</span></th>
                            <th><span class='result' id='FedExInternationalPre-PaidResult'></span></th>
                        </tr><br />
                        <tr>
                            <th><span class='service'>FedEx International Priority</span></th>
                            <th><span class='result' id='FedExInternationalPriorityResult'></span></th>
                        </tr><br />
                        <tr>
                            <th><span class='service'>FedEx Priority Overnight</span></th>
                            <th><span class='result' id='FedExPriorityOvernightResult'></span></th>
                        </tr><br />
                        <tr>
                            <th><span class='service'>FedEx Priority Puerto Rico Collect</span></th>
                            <th><span class='result' id='FedExPriorityPuertoRicoCollectResult'></span></th>
                        </tr><br />
                        <tr>
                            <th><span class='service'>FedEx Priority Puerto Rico Pre-Paid</span></th>
                            <th><span class='result' id='FedExPriorityPuertoRicoPre-PaidResult'></span></th>
                        </tr><br />
                        <tr>
                            <th><span class='service'>FedEx Saturday Priority</span></th>
                            <th><span class='result' id='FedExSaturdayPriorityResult'></span></th>
                        </tr><br />
                        <tr>
                            <th><span class='service'>FedEx SmartPost</span></th>
                            <th><span class='result' id='FedExSmartPostResult'></span></th>
                        </tr><br />
                        <tr>
                            <th><span class='service'>FedEx Standard Overnight</span></th>
                            <th><span class='result' id='FedExStandardOvernightResult'></span></th>
                        </tr><br />
                    </table>
                </div>

                <div id="UPSDiv">
                    <span class='caption'>
                        <h3>UPS</h3>
                    </span>
                    <table>
                        <tr>
                            <th><span class='service'>UPS 2nd Day Air</span></th>
                            <th><span class='result' id='UPS2ndDayAirResult'></span></th>
                        </tr><br />
                        <tr>
                            <th><span class='service'>UPS 2nd Day Air Puerto Rico</span></th>
                            <th><span class='result' id='UPS2ndDayAirPuertoRicoResult'></span></th>
                        </tr><br />
                        <tr>
                            <th><span class='service'>UPS 3Day Select</span></th>
                            <th><span class='result' id='UPS3DaySelectResult'></span></th>
                        </tr><br />
                        <tr>
                            <th><span class='service'>UPS Ground</span></th>
                            <th><span class='result' id='UPSGroundResult'></span></th>
                        </tr><br />
                        <tr>
                            <th><span class='service'>UPS Ground Residential</span></th>
                            <th><span class='result' id='UPSGroundResidentialResult'></span></th>
                        </tr><br />
                        <tr>
                            <th><span class='service'>UPS International</span></th>
                            <th><span class='result' id='UPSInternationalCollectResult'></span></th>
                        </tr><br />
                        <tr>
                            <th><span class='service'>UPS International Pre-Paid</span></th>
                            <th><span class='result' id='UPSInternationalPre-PaidResult'></span></th>
                        </tr><br />
                        <tr>
                            <th><span class='service'>UPS Next Day Air</span></th>
                            <th><span class='result' id='UPSNextDayAirResult'></span></th>
                        </tr><br />
                        <tr>
                            <th><span class='service'>UPS Next Day Air Saver</span></th>
                            <th><span class='result' id='UPSNextDayAirSaverResult'></span></th>
                        </tr><br />
                        <tr>
                            <th><span class='service'>UPS Worldwide Expedited</span></th>
                            <th><span class='result' id='UPSWorldwideExpeditedResult'></span></th>
                        </tr><br />
                        <tr>
                            <th><span class='service'>UPS Worldwide Express</span></th>
                            <th><span class='result' id='UPSWorldwideExpressResult'></span></th>
                        </tr><br />
                        <tr>
                            <th><span class='service'>UPS Worldwide Express Collect</span></th>
                            <th><span class='result' id='UPSWorldwideExpressCollectResult'></span></th>
                        </tr><br />
                        <tr>
                            <th><span class='service'>UPS Worldwide Express Plus</span></th>
                            <th><span class='result' id='UPSWorldwideExpressPlusResult'></span></th>
                        </tr><br />
                        <tr>
                            <th><span class='service'>UPS Worldwide Express Plus Collect</span></th>
                            <th><span class='result' id='UPSWorldwideExpressPlusCollectResult'></span></th>
                        </tr><br />
                        <tr>
                            <th><span class='service'>UPS Worldwide Saver</span></th>
                            <th><span class='result' id='UPSWorldwideSaverResult'></span></th>
                        </tr><br />
                        <tr>
                            <th><span class='service'>UPS Worldwide Saver Collect</span></th>
                            <th><span class='result' id='UPSWorldwideSaverCollectResult'></span></th>
                        </tr><br />
                    </table>
                    <input id='calculateButton' class='button' type='button' value='Save Money!' />
                </div>

                <!-- jQuery: Handle button -->
                <script>
                    $(document).ready(function() {

                        $('#calculateButton').click(function() {

                            var input = [];
                            var service_class = document.getElementsByClassName('service');

                            // Get the shipment info
                            input[0] = 'ARIIX';
                            input[1] = $('#country').val();
                            input[2] = $('#state').val();
                            input[3] = $('#city').val();
                            input[4] = $('#zipcode').val();
                            input[5] = $('#weight').val();

                            // Grab all the service types
                            for(var i = 0; i < service_class.length; i++)
                                input.push(service_class[i].innerText);

                            console.log(input);

                            // AJAX POST back to this page with the results of the freight request
                            /*
                            $.post("calc.php", {input: input}, function(data) {

                                //var response = JSON.parse(data);

                                //alert(data.indexOf('<ERROR>'));

                                // Make sure valid values were entered for all fields!
                                if (data.indexOf('<ERROR>') != -1)
                                    alert(data);
                                else
                                {
                                    alert(data);
                                    //console.log(response);
                                }

                                //$('#UPSWorldwideSaverCollectResult').append(data);
                            });
                            */
                            $.ajax({
                                type: 'POST',
                                url: "calc.php",
                                data: {input: input},
                                success: function(data) {

                                    //var response = JSON.parse(data);
                                    //alert(response[0].valueOf());
                                    console.log(data);
                                    alert(data);
                                },
                                failure: function(data) {
                                    alert(data);
                                }
                            });

                        });
                    }); 

                </script>

                <div id="USPSDiv">
                        <span class='caption'>
                        <h3>USPS</h3>
                    </span>
                    <table>
                        <tr>
                            <th><span class="service">USPS Best Way Cost</span></th>
                            <th><span class='result' id='USPSBestWayCostResult'></span></th>
                        </tr><br />
                        <tr>
                            <th><span class="service">USPS Express Mail</span></th>
                            <th><span class='result' id='USPSExpressMailResult'></span></th>
                        </tr><br />
                        <tr>
                            <th><span class="service">USPS First Class Mail</span></th>
                            <th><span class='result' id='USPSFirstClassMailResult'></span></th>
                        </tr><br />
                        <tr>
                            <th><span class="service">USPS Media Mail</span></th>
                            <th><span class='result' id='USPSMediaMailResult'></span></th>
                        </tr><br />
                        <tr>
                            <th><span class="service">USPS Parcel Post Mail</span></th>
                            <th><span class='result' id='USPSParcelPostMailResult'></span></th>
                        </tr><br />
                        <tr>
                            <th><span class="service">USPS Priority Mail</span></th>
                            <th><span class='result' id='USPSPriorityMailResult'></span></th>
                        </tr><br />
                    </table>
                </div>

            </div>

<?php include 'footer.php'; ?> 
```

（CSS）：

```
#container
{
position: absolute;
height: 100%;
width: 100%;
}

.header
{
position: relative;
height: 20%;
width: 100%;
}
#logo
{
position: relative;
float: left;
height: 100%;
width: 20%;
background: white url('logo.png') no-repeat center;
background-size: 100%;
}

.Body
{
display: table;
position: absolute;
height: 80%;
width: 100%;
background-color:Gainsboro;
}
#inputBar
{
border-top: 2px solid;
border-bottom: 2px solid;
overflow: hidden;
white-space: nowrap;
text-align: center;
margin: 0 auto;
background-color: DarkGray;
}
#freightBody
{
height: 95%;
width: 100%;
font-size: 115%;
background-color: Gainsboro;
}

#FedExDiv
{
float: left;
height: 100%;
width: 32%;
margin-left: 1%;
background-color: blue;
}
#UPSDiv
{
float: left;
height: 100%;
width: 32%;
margin-left: 1%;
}
#USPSDiv
{
float: left;
height: 100%;
width: 32%;
margin-left: 1%;
}

span
{
display:table;
float: left;
margin-right: 1%;
margin-left: 1%;
text-align: center;
}
.service { background-color:red;    }
.result { height: 5%; width: 10%; background-color: white;  }

.row
{
height: 5%;
width: 35%;
}

{
font-weight: bold;
}
.button
{
width:20%;
height: 10%;
margin: 0 25% 0 25%;
}

.caption
{
float: left;
width: 100%;
background-color: white;
font-weight: bold;
font-size: 120%;
border-bottom: 2px solid;
} 
```

在过去半小时左右的时间里，我一直坐着查看我的 CSS，并试图在谷歌上搜索一些相关的内容，但到目前为止我什么也没有，我看不出我做错了什么。

有任何想法吗？

注意：我忘了提及 - HTML 和 BODY 标记以及 DOC COMMENT 包含在包含的页眉/页脚 PHP 文件中。可能很明显，但我只是想确保我提到了这一点。

# c++ - 可以使用 memcpy() 复制包含指针的结构吗？

> ID：13592570
> 
> 赞同：4
> 
> 时间：2012-11-27T20:35:34.937
> 
> 标签：c++, struct, memcpy

前几天我在考虑这个问题，我很好奇这是否是一个坏主意……假设有一个结构包含指向字符串数组的指针。memcpy() 会在下面的示例中复制“名称”数组指针吗？编辑：在这个例子中，std 是不可访问的。

```
struct charMap
{ 
  unsigned char * name;   
  unsigned char id;       
};
typedef struct charMap CharMapT;

class ABC
{
  public:
  ABC(){}
  void Function();
  CharMapT* structList;
}

void ABC::Function ()
{
  CharMapT list[] = 
  {
    {"NAME1", 1},
    {"NAME2", 2}, 
    {"NAME3", 3}
  };

  structList = new CharMapT[sizeof(list)];
  memcpy(structList, &list, sizeof(list));
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-27T21:10:21.143

呈现的代码中有几个错误，我将首先讨论这些错误，然后是我的指针与数组的股票描述。

```
struct charMap
{ 
  unsigned int * name;   
  unsigned int id;       
};
typedef struct charMap CharMapT; 
```

这声明了一个结构类型，其中包括指向 unsigned int 作为第一个成员（名称）和一个 int 作为第二个成员（id）的指针。在具有默认字节打包的 32 位系统上，这将是**8 字节**宽（32 位指针 = 4 字节，32 位有符号整数 = 4 字节）。如果这是一台 64 位机器，指针将是 8 字节宽，int 仍然可能是 32 位宽，使结构大小为**12 字节**。

**有问题的代码**

```
void ABC::Function ()
{
  CharMapT list[] = 
  {
    {"NAME1", 1},
    {"NAME2", 2}, 
    {"NAME3", 3}
  };

  structList = new CharMapT[sizeof(list)];
  memcpy(structList, &list, sizeof(list));
} 
```

这会分配 CharMapT 结构的动态数组。多少？比你想象的更多。将返回数组`sizeof(list)`的字节数。`list[]`由于 CharMapT 结构为 8 字节宽（见上文），这将是 3 * 8 或**24 个 CharMapT 项**（如果使用 64 位指针，则为 36 项）。

然后我们将`memcpy()`24**字节**（或 36 字节）从`list`（`&`in`&list`是不必要的）到新分配的内存。这将复制超过 3 个 CharMapT 结构，而我们分配的其他 21 个结构保持不变（超出它们的初始默认构造）。

注意：您正在将 a 初始化为`const char *`声明为 的字段`unsigned int *`，因此即使编译了基本数据类型也会有所不同。假设您修复了结构并将指针类型更改为`const char *`，则 const 数据段中某处的静态字符串常量的地址（“NAME”常量的地址）将分配给 structList[0] 中元素的指针变量.name、structList[2].name 和 structList[3].name 分别。

这不会复制指向的*数据*。它只会复制指针*值*。如果您想要数据的副本，那么您必须对它们进行原始分配（malloc、new 等）。

更好的是，使用 an `std::vector<CharMapT>`、 use `std::string`for`CharMapT::name`和 use`std::copy()`来复制源代码（甚至直接赋值）。

我希望这能解释你在寻找什么。

* * *

**指针与数组辱骂**

**永远不要**将指针与数组混淆。指针是一个保存*地址*的*变量。*就像变量保存整数值，或者变量保存字符类型一样，指针中保存的值是地址*`int``char`*

 *数组是不同的。它也是一个变量（显然），但它不能是左值，并且几乎每个通常使用它的地方都会发生转换。从概念上讲，转换会产生一个临时指针，该指针指向数组的数据类型，并保存第一个元素的地址。有时该概念不会*发生*（例如应用地址运算符）。

```
void foo(const char * p)
{
}

char ar[] = "Hello, World!";
foo(ar); // passes 'ar', converted to `char*`, into foo. 
         // the parameter p in foo will *hold* this address 
```

或这个：

```
char ar[] = "Goodbye, World!";
const char *p = ar;  // ok. p now holds the address of first element in ar
++p;                 // ok. address in `p` changed to address (ar+1) 
```

但不是这个：

```
char ar[] = "Goodbye, World!";
++ar; //  error. nothing to increment. 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-27T20:39:16.897

它不会复制您指向的实际数据`name`。它将复制指针，您将有 2 个指针指向 2 个对象中的同一位置（对于 2 个数组中的每对对象）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-27T20:40:13.260

您在这里真正需要知道的是，这`memcpy`将为您提供一些原始副本。因此，您将拥有两个指向相同数据的具有相同值（即地址）的指针。

在旁注中，您已声明`name`为指向 的指针`int`，这在这里当然是错误的。它应该是一个`const char*`. 此外，由于这是 C++ 而不是 C，因此如果有一天成为复杂类型`std::copy`，它不会巧妙地破坏您的代码，因此您会得到更好的服务。`charMap`同样，在大多数情况下，更喜欢`std::string`而不是。`const char*`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-27T21:05:01.517

调用时您的使用`sizeof()`是错误的`new`。`CharMapT`您正在分配一个元素数组。您必须指定元素的数量，但您指定的是字节数。所以你需要解决这个问题：

```
structList = new CharMapT[sizeof(list) / sizeof(CharMapT)]; 
```

修复后，结果`memcpy()`将`structList`包含原始数据的精确副本`list[]`。这意味着`structList[N].name`指针将包含与指针相同的值`list[N].name`，因此它们都将指向字符串值的相同物理内存。

如果要对字符串值进行深层复制，则必须单独分配它们，例如：

```
void ABC::Function ()
{
    CharMapT list[] = 
    {
        {"NAME1", 1},
        {"NAME2", 2}, 
        {"NAME3", 3}
    };

    int num = sizeof(list) / sizeof(CharMapT);
    structList = new CharMapT[num];
    for (int i = 0; i < num; ++i)
    {
        int len = strlen(list[i].name);
        structList[i].name = new char[len+1];
        strcpy(structList[i].name, list[i].name);
        structList[i].name[len] = 0;

        structList[i].id = list[i].id;
    }
    ...
    for (int i = 0; i < num; ++i)
        delete[] structList[i].name;
    delete[] structList;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-27T21:05:56.083

我想添加到@EdS。的答案：

如果你这样做，你的代码就是比 c 风格的 c++ 代码更多的**c++ ：**

```
#include<string>
#include<vector>

struct CharMap
{ 
  CharMap(const std::string& name, unsigned char id); // only needed if you don't use -std=c++11
  std::string name;   
  unsigned char id;       
};
CharMap::CharMap(const std::string& name, unsigned char id):
  name(name),
  id(id)
{}

class ABC
{
public:
  ABC(); // or ABC() = default; if you use -std=c++11
  void Function();
private:
  std::vector<CharMap> structList;
}

ABC::ABC(){} // not needed with -std=c++11

void ABC::Function ()
{
  // This works with -std=c++11:
  //structList = 
  //{
  //  {"NAME1", 1},
  //  {"NAME2", 2}, 
  //  {"NAME3", 3}
  //}; 

  // without c++11:
  structList = std::vector<CharMap>(3);
  structList[0] = CharMap("NAME1",1); // don't worry about copies, we have RVO (check wikipedia or SO)
  structList[1] = CharMap("NAME2",2);
  structList[2] = CharMap("NAME2",3);
} 
```

为什么不`std::vector`用于制作数组？你可以这样做：

```
#include<vector>

std::vector<CharMapT> structList(list.size()); 
```

它也更安全，避免使用指针可以减少由于错误使用`sizeof`运算符而导致内存泄漏或错误的机会。

我想你并不真正想要一个 structList，它的元素与列表的*内存大小*一样多。（如果列表是两倍，这可能是列表中元素数量的许多倍。）

此外，`memcpy`如果 list 也是一个向量（实际上是 ac 函数），则实际上没有必要。你只需做一个简单的赋值操作：

```
structList = list; // given that list is a vector. 
```

这将复制 memcpy 之类的元素。*

# javascript - 对为什么我在 Salesforce 中使用 jquery/jsremoting 失去变量范围感到困惑

> ID：13592571
> 
> 赞同：0
> 
> 时间：2012-11-27T20:35:35.660
> 
> 标签：javascript, jquery, salesforce, apex-code

代码对我来说看起来不错，这就是为什么我对 G_SResult 变量失去作用域感到困惑。它在 ready 函数上方全局声明，但在屏幕截图中不可见。在屏幕截图中，您将看到 4 个突出显示的警报表达式。带有红点的那个是它返回未定义的地方。其他警报返回正确的值。

代码截图。----> [http://i.imgur.com/nNIBk.png](http://i.imgur.com/nNIBk.png)

```
function Savedat(){
          var Surveyz=new Survey();
          Surveyz.Name=j$('#survey_name').val();
          var SResult;
          var QuestionOrder=1;
          var id;
          //alert(G_SResult+'----first');
          //alert(typeof G_SResult === 'undefined');
          Visualforce.remoting.Manager.invokeAction('{!$RemoteAction.SV_CreateSurvey.insertSurvey}'
              ,Surveyz
              ,function(Survey_result, event){
                console.log(Survey_result);
                SResult=Survey_result;

             j$('[name="p_Q"]').each(function(){
                 elId=this.id;
                 var elNum=elId.substring(1);

                 QType=j$('input[name=ctrlSel'+elNum+']:checked').val();
                 Quest=new Question();
                 Quest.Question__c=j$(this).val();
                 Quest.Question_Input_Type__c=QType;

                 SResult=Survey_result;
                 G_SResult=SResult;
                  alert(G_SResult+'---1'); 
                 Visualforce.remoting.Manager.invokeAction('{!$RemoteAction.SV_CreateSurvey.insertQuestion}'
                      ,Quest
                      ,function(Question_result, event){
                        console.log(Question_result);

                        var SQLink=new SurveyQL();
                        SQLink.SG_Survey__c=SResult;
                        SQLink.Survey_Question__c=Question_result;
                        SQLink.QOrder__c=(QuestionOrder);
                        Visualforce.remoting.Manager.invokeAction('{!$RemoteAction.SV_CreateSurvey.insertSurveyLink}'
                              ,SQLink
                              ,function(SurveyLink_result, event){
                                console.log(SurveyLink_result);
                         });

                        j$('[name="A'+elNum+'"]').each(function(){

                             SA=new SurveyAnswer();
                             SA.Answer__c=j$(this).val();
                             SA.Survey_Question__c=Question_result;

                             Visualforce.remoting.Manager.invokeAction('{!$RemoteAction.SV_CreateSurvey.insertAnswer}'
                              ,SA
                              ,function(Answer_result, event){
                                console.log(Answer_result);

                             });
                        });
                     QuestionOrder++;

                 });
                 alert(G_SResult+'----2'); 
             });

            alert(G_SResult+'----3'); 
         });

    setTimeout(function(){Work();}, 1000);

} 
```

万一有人出于某种原因遇到此问题，解决方案是……（两个代码块都已作为工作示例进行了编辑）

```
function Work()
{
    //Semaphore like
    if (typeof G_SResult === 'undefined')//(G_SResult == undefined)
    {
      //run stuff here
        setTimeout(function(){Work();}, 1000);
    }
    else
    {
      alert(G_SResult+'----5');

      //G_SResult = null;
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T20:39:09.323

该变量存在于另一个范围内。它在匿名函数中声明

```
function Savedat(){

    // [ Code .. ]

    j$('[name="p+Q]').each(

        function(){

            // [ Code.. ]

            G_SResult = 999;
            // G_SResult didnt exist and is therefore declared locally.
            // It implies "var G_SResult = 999"
        }
    );

    // G_SResult undefined here.. because it is outside the scope where it was defined.
} 
```

并且在`Savedat(){}`函数中不存在

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T20:39:16.973

看起来`Visualforce.remoting.Manager`方法是**异步的。**

# sql - TSQL 存储函数

> ID：13592574
> 
> 赞同：2
> 
> 时间：2012-11-27T20:35:56.313
> 
> 标签：sql, sql-server, tsql, sql-server-2012

我正在尝试在 SQL Server 2012 中编写一个表值函数，它根据输入参数调用另一个表值函数，这是一个示例

```
CREATE FUNCTION [dbo].[fnMyLastFilterFunction] 
(   
    @Param1 VARCHAR(64),
    @Param2 VARCHAR(64),
    @Param3 INT,
    @StartDate DATETIME,
    @EndDate DATETIME
)
RETURNS TABLE 
AS
RETURN 
(

    IF (@Param3 = 0)
    BEGIN
        SELECT t1.Col1, t1.Col2, t1.Col3, t1.Col4
        FROM fnMyFirstFilterFunction(@Param1,@Param2) t1
        WHERE t1.DateTimeEnd BETWEEN @StartDate AND @EndDate
    END

) 
```

当我执行此操作时，出现两个错误：

1.  关键字“IF”附近的语法不正确
2.  ')' 附近的语法不正确（即最后一个右括号）

在表值函数中是否可能有这样的条件？基本上我试图实现一个过滤系统，从“ **fnMyFirstFilterFunction** ”中的所有数据开始。因此**“fnMyLastFilterFunction”**获取该数据并按@start 和@end 日期对其进行过滤。我正在使用存储的函数来分离过滤阶段。我的 SQL 已经生锈了，所以如果有更好的方法，我愿意接受。

更新：

SpectralGhost 的建议编译得很好，但是如果在函数体中我希望逻辑根据@Param3 的值调用不同的函数呢？如下所示：

```
IF (@Param3 = 0)
    BEGIN
        SELECT t1.Col1, t1.Col2, t1.Col3, t1.Col4
        FROM fnMyFirstFilterFunction(@Param1,@Param2) t1
        WHERE t1.DateTimeEnd BETWEEN @StartDate AND @EndDate
    END
ELSE IF (@Param3 = 1)
    BEGIN
        SELECT t1.Col1, t1.Col2, t1.Col3, t1.Col4
        FROM fnOtherFilterFunction(@Param1,@Param2) t1
        WHERE t1.DateTimeEnd BETWEEN @StartDate AND @EndDate
    END 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-27T20:44:17.627

去掉 IF 并用这个查询替换。

```
 SELECT t1.Col1, t1.Col2, t1.Col3, t1.Col4
 FROM fnMyFirstFilterFunction(@Param1,@Param2) t1
 WHERE t1.DateTimeEnd BETWEEN @StartDate AND @EndDate
 AND @Param3 = 0 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T21:00:38.007

对于编辑，请尝试

```
 SELECT t1.Col1, t1.Col2, t1.Col3, t1.Col4
 FROM fnMyFirstFilterFunction(@Param1,@Param2) t1
 WHERE t1.DateTimeEnd BETWEEN @StartDate AND @EndDate
 AND @Param3 = 0
 UNION ALL
 SELECT t1.Col1, t1.Col2, t1.Col3, t1.Col4
 FROM fnOtherFilterFunction(@Param1,@Param2) t1
 WHERE t1.DateTimeEnd BETWEEN @StartDate AND @EndDate
 AND @Param3 = 1 
```

由于@Param3 永远不会同时为 0 和 1，这在逻辑上等同于 if 语句。

# php - php exec 与 vboxmanage 启动虚拟服务器。

> ID：13592578
> 
> 赞同：0
> 
> 时间：2012-11-27T20:36:20.057
> 
> 标签：php, virtualbox

我正在尝试做一个简单的项目来使用 PHP 脚本启动 VirtualBox VM。我的服务器是 win 7 Ultimate 并运行 php5.3 我正在使用 vboxmanage.exe 来启动服务器。cmd 在批处理文件中效果很好，或者直接输入到 cmd 行中。

当我使用：

```
exec("path to vboxmange.exe" startvm "vm name"); 
```

它不起作用。如果我将代码更改为：

```
exec(dir); 
```

它工作正常。我做了一些搜索，每个人似乎都提到了 IIS_IUSRS 的权限。我将它设置为在 vboxmanage.exe 上读取并执行并尝试为 cmd.exe 执行此操作，但似乎无法让它允许我执行此操作，尽管它似乎没有必要，因为它可以运行其他 cmd，如 dir。

我的另一个理论是 exec 将整个 cmd 包装在 "" 中，当我尝试手动将其输入到 cmd 行时，这不起作用。我试图修剪它，但这不起作用，因为 exec 添加了它，所以我之前所做的任何事情都无法阻止它。

对另一种方法或它可能是什么的任何建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T20:58:27.067

从[`exec`PHP 手册中](http://php.net/manual/en/function.exec.php)：

> 注意：启用安全模式后，您只能执行 safe_mode_exec_dir 中的文件。出于实际原因，目前不允许在可执行文件的路径中包含 .. 组件。

检查你`safe_mode_exec_dir`在你的值`php.ini`。我猜想默认情况下它会相当严格。

如果这不起作用，请查看评论。特别是，[此评论](http://www.php.net/manual/en/function.exec.php#110131)可能对您有所帮助。

# objective-c - 在目标 c 的已解析字符串中删除 '

> ID：13592584
> 
> 赞同：1
> 
> 时间：2012-11-27T20:36:40.203
> 
> 标签：objective-c, json, string, parsing, character-encoding

在我的 Objective C 程序中，我将 Json 解析为字符串。但是在我得到的结果字符串中

我 & # 39 ; ve

中间的

> 我有

您能否建议如何将其重新格式化以显示 ' 而不是 ' ;

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T20:45:32.260

你可以试试开源的 Google Tolbox for Mac`NSString+HTML` [类别](http://google-toolbox-for-mac.googlecode.com/svn/trunk/Foundation/GTMNSString+HTML.h)。它包含许多以这种方式处理 HTML 实体的方法。（实施文件位于[此处](http://google-toolbox-for-mac.googlecode.com/svn/trunk/Foundation/GTMNSString+HTML.m)）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T21:44:30.190

这取决于这是唯一的情况还是您需要更通用的解决方案。对于这种情况，您可以使用：

```
[inputString stringByReplacingOccurrencesOfString:@" & # 39 ; " withString:@"'"]; 
```

# php - PHP 我应该写评论/文档吗

> ID：13592585
> 
> 赞同：0
> 
> 时间：2012-11-27T20:36:40.120
> 
> 标签：php, coding-style

一旦我在“清洁代码”一书中读到不应该写注释，因为它们会弄乱代码。

然而，另一方面，“kohana”代码（作为众多代码之一）在几乎每一行代码之前都包含大量文档和注释。

我正在创建将来将由用户程序员使用的项目......那我应该如何写评论？

为了更清楚地说明这一点 - 我应该：

*   在每节课之前写文档？
*   在每个方法之前写文档？
*   为每个方法写@param，@return...？
*   为几乎每一行代码编写注释以使其更清晰？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T20:40:19.387

你应该：

*   每节课前写文档
*   在每个方法之前编写文档
*   为每个公共方法编写@param、@return...

对每一行代码的注释不是太必要，但我建议在代码行中添加注释，否则这些代码会不清楚或晦涩难懂。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T20:40:25.657

我在两种主要情况下写评论/文档：

*   当程序所做的事情不是**很明显**时。即使现在看起来很明显，也不会在 6 个月内出现，也不会出现在另一个试图维持你工作的人身上。
*   当变量/参数/属性类型不明确时。那是我添加文档块的时候。

大多数（所有）体面的 IDE 都有折叠甚至隐藏评论的机制。不要因为一本书告诉你，或者因为你认为它“乱七八糟”而放弃它们。

凌乱是一个主观的术语。我认为写一条评论可以为未来的你节省 10 个小时的头痛。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T20:40:27.217

老实说，我会考虑未来的读者。他们会从评论中受益吗？在我自己的情况下，我只对我没有写的评论感到遗憾，很少对我写的不必要的评论感到遗憾。很多时候我都在想“我不可能忘记这一点”......并且做到了。

作为替代方案，您还可以维护带有完整注释的代码的单独副本，以及删除大部分/所有注释的发布版本。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-27T20:44:42.717

无论你读过什么书说不应该写评论，你应该立即扔掉并永远忘记。我不在乎你是否是唯一会使用代码的人，你仍然应该记录它。

对我来说，如果您正在编写将被其他开发人员使用的代码，我会尝试坚持使用 PHPDoc (JavaDoc) 文档样式，这意味着您要尽可能彻底地记录每个类、方法、属性等。这带来的一个好处是，许多 IDE 实际上会使用此信息来完成代码，从而使您的应用程序更易于使用。

现在在代码块本身中，我认为您不需要注释每一行（尤其是那些很明显您在做什么的行），但是注释代码的不同部分、不同的逻辑分支等很有用。

我还建议的一件事是使用对其目的有意义的变量名（简单计数器除外）。人们常常变得可爱，想要使用 3-4 个字母的变量名，因为一些错误的观点认为这会使他们在打字时花费大量时间，或者使他们的代码更短。如果您需要一个长名称`product_catalog_iterator`来描述一个类，对我来说这比`prodcatit`或相似更好。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-27T20:47:53.317

我相信不要写评论。而是编写自我注释的代码。我的意思是你的函数和变量描述了它们的作用。例如，您可以通过两种方式编写它：

```
function foo1($a, $b, $c){
 return md5($a . $b . $c);
} 
```

或者你可以写

```
function encryption($pepper, $content, $salt){
 return md5($pepper . $content . $salt);
} 
```

在这个例子中，第一个你不知道它在做什么，但是第二个，你确切地知道它在做什么。唯一一次我觉得需要评论是在你编写了真正的 hacky 代码之后，这些代码花了你很长时间才弄清楚如何去做，并且不太清楚它在做什么。然而，这应该介于两者之间。

文档不是一个好主意的原因是因为通常发生的情况是您在首次创建函数时以及在错误修复和维护之后编写了很好的注释。评论从未更新，现在评论说的是该功能没有做的事情，并且提供了混乱而不是帮助。

# javascript - FB.Canvas.setSize 不受官方支持

> ID：13592586
> 
> 赞同：0
> 
> 时间：2012-11-27T20:36:47.533
> 
> 标签：javascript, facebook, api, canvas, tabs

目前我有两个使用 Facebook javascript API 开发的工作应用程序。两者都位于选项卡中，而不是画布中。今天我去检查一些更改并在控制台上收到此消息：

“FB.Canvas.setSize 方法不受 Facebook 官方支持，很快将被删除”

关于什么可以用来替换“setSize”的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T21:40:33.987

您最好的替代品是[`FB.setAutoGrow`](https://developers.facebook.com/docs/reference/javascript/FB.Canvas.setAutoGrow/).

但我认为该消息可能是一个错误，所以我正在调查它。

# php - 如何在 CI 的 order 子句中忽略小写和大写？

> ID：13592590
> 
> 赞同：-1
> 
> 时间：2012-11-27T20:36:57.643
> 
> 标签：php, codeigniter

我有这个从数据库获取用户的功能：

```
function get_users_limited($offset, $limit)
{
    $q = $this->db->select('*')
              ->from('users')
              ->join('user_profiles', 'user_profiles.user_id = users.id'  )
              ->order_by('users.username asc')
              ->limit($limit, $offset)
              ->get();
    return $q;
} 
```

我想按用户名 asc 对结果进行排序，但问题是它在 A 和 a 以及 B 和 b 等之间产生了差异。

问题是结果如下所示：

```
Albert
Bob
Caesar
axnGuy
blackboy83
c3p0 
```

我想要这个：

```
Albert
axnGuy
Bob
blackboy83
Caesar
c3p0 
```

任何建议如何在 CodeIgniter 中忽略小写和大写？

**我需要 CI 特定的解决方案！**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T20:54:26.267

我不熟悉那里的 php，并且您没有指定您使用的字符集。此外，它没有特别提到，但我假设我们在这里谈论的是 MySQL。

假设 MySQL，假设您使用的是 utf8 字符集。

您可以在选择中选择不同的排序规则（对 utf8 有效），例如

```
SELECT `name` COLLATE utf8_unicode_ci as `name` FROM `owners`; 
```

这里的表是 utf8 字符集，我在列上使用 utf8_unicode_ci（不区分大小写的 ci）排序模式`name`。

如果您使用的是 latin1 的默认字符集，您会执行以下操作：

```
SELECT `name` COLLATE latin1_general_ci as `name` FROM `owners`; 
```

等等

完全不熟悉您的 PHP，但我认为它看起来像这样：

```
function get_users_limited($offset, $limit)
{
    $q = $this->db->select('users.username COLLATE latin1_general_ci as c1, user_profiles.* ')
              ->from('users')
              ->join('user_profiles', 'user_profiles.user_id = users.id'  )
              ->order_by('c1 asc')
              ->limit($limit, $offset)
              ->get();
    return $q;
} 
```

指定字符集的排序规则子集不会设置或更改该列/表上的默认排序规则。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T20:39:49.970

这与数据库的整理有关。将其更改为一些 _ci 变体（不区分大小写）并尝试相同的查询。

# html - Rails，模板错误

> ID：13592591
> 
> 赞同：0
> 
> 时间：2012-11-27T20:37:03.370
> 
> 标签：html, ruby-on-rails-3

我的生产服务器有一些问题。在我当地，一切都很好。生产日志中的错误：

```
Started GET "/" for 127.0.0.2 at 2012-11-27 21:30:39 +0100
Processing by HomeController#index as HTML
  Rendered home/index.html.erb within layouts/application (1.0ms)
  Rendered layouts/_heads-main.html.erb (1.8ms)
Completed 500 Internal Server Error in 6ms

ActionView::Template::Error (modern.css isn't precompiled):
    1:     <meta name="viewport" content="width=device-width, initial-scale=1.0">
    2:     <title><%= content_for?(:title) ? yield(:title) : "Zapust.pl - życie granicy, przejścia graniczne, kamery, chat" %></title>
    3:     <meta name="description" content="<%= content_for?(:description) ? yield(:description) : "Zapust.pl - życie granicy, przejści$
    4:     <%= stylesheet_link_tag("modern") %>
    5:     <%= stylesheet_link_tag("front") %>
    6:     <%= stylesheet_link_tag("modern-responsive") %>
    7:     <%= stylesheet_link_tag("popup") %>
  app/views/layouts/_heads-main.html.erb:4:in `_app_views_layouts__heads_main_html_erb__3671184199177623191_17240242720'
  app/views/layouts/application.html.erb:4:in `_app_views_layouts_application_html_erb__829205250877960417_17238366080' 
```

我在我的配置中将编译选项设置为 true。在网络浏览器的屏幕上：

```
We're sorry, but something went wrong. 
```

我什至删除了应用程序布局文件，但仍然出现此错误。tmp/cache 为空。缓存在哪里？怎么了 ？

命令 bundle exec rake assets:precompile --trace 出错：

```
rake aborted!
/usr/home/mitchpolska/domains/zapust.pl/public_ror/app/assets/javascripts/tiny_mce/plugins/spellchecker/editor_plugin.js has a invalid UTF-8 byte sequence
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/sprockets-2.1.3/lib/sprockets/utils.rb:18:in `block in read_unicode'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/sprockets-2.1.3/lib/sprockets/utils.rb:12:in `tap'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/sprockets-2.1.3/lib/sprockets/utils.rb:12:in `read_unicode'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/sprockets-2.1.3/lib/sprockets/context.rb:171:in `evaluate'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/sprockets-2.1.3/lib/sprockets/processed_asset.rb:12:in `initialize'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/sprockets-2.1.3/lib/sprockets/base.rb:241:in `new'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/sprockets-2.1.3/lib/sprockets/base.rb:241:in `block in build_asset'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/sprockets-2.1.3/lib/sprockets/base.rb:262:in `circular_call_protection'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/sprockets-2.1.3/lib/sprockets/base.rb:240:in `build_asset'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/sprockets-2.1.3/lib/sprockets/index.rb:89:in `block in build_asset'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/sprockets-2.1.3/lib/sprockets/caching.rb:19:in `cache_asset'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/sprockets-2.1.3/lib/sprockets/index.rb:88:in `build_asset'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/sprockets-2.1.3/lib/sprockets/base.rb:163:in `find_asset'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/sprockets-2.1.3/lib/sprockets/index.rb:56:in `find_asset'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/sprockets-2.1.3/lib/sprockets/processed_asset.rb:106:in `block in build_required_assets'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/sprockets-2.1.3/lib/sprockets/processed_asset.rb:100:in `each'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/sprockets-2.1.3/lib/sprockets/processed_asset.rb:100:in `build_required_assets'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/sprockets-2.1.3/lib/sprockets/processed_asset.rb:16:in `initialize'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/sprockets-2.1.3/lib/sprockets/base.rb:241:in `new'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/sprockets-2.1.3/lib/sprockets/base.rb:241:in `block in build_asset'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/sprockets-2.1.3/lib/sprockets/base.rb:262:in `circular_call_protection'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/sprockets-2.1.3/lib/sprockets/base.rb:240:in `build_asset'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/sprockets-2.1.3/lib/sprockets/index.rb:89:in `block in build_asset'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/sprockets-2.1.3/lib/sprockets/caching.rb:19:in `cache_asset'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/sprockets-2.1.3/lib/sprockets/index.rb:88:in `build_asset'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/sprockets-2.1.3/lib/sprockets/base.rb:163:in `find_asset'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/sprockets-2.1.3/lib/sprockets/index.rb:56:in `find_asset'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/sprockets-2.1.3/lib/sprockets/bundled_asset.rb:16:in `initialize'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/sprockets-2.1.3/lib/sprockets/base.rb:244:in `new'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/sprockets-2.1.3/lib/sprockets/base.rb:244:in `build_asset'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/sprockets-2.1.3/lib/sprockets/index.rb:89:in `block in build_asset'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/sprockets-2.1.3/lib/sprockets/caching.rb:19:in `cache_asset'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/sprockets-2.1.3/lib/sprockets/index.rb:88:in `build_asset'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/sprockets-2.1.3/lib/sprockets/base.rb:163:in `find_asset'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/sprockets-2.1.3/lib/sprockets/index.rb:56:in `find_asset'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/actionpack-3.2.8/lib/sprockets/static_compiler.rb:23:in `block in compile'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/sprockets-2.1.3/lib/sprockets/base.rb:212:in `block in each_logical_path'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/sprockets-2.1.3/lib/sprockets/base.rb:200:in `block (2 levels) in each_file'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/sprockets-2.1.3/lib/sprockets/base.rb:190:in `each'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/sprockets-2.1.3/lib/sprockets/base.rb:190:in `each_entry'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/sprockets-2.1.3/lib/sprockets/base.rb:198:in `block in each_file'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/sprockets-2.1.3/lib/sprockets/base.rb:197:in `each'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/sprockets-2.1.3/lib/sprockets/base.rb:197:in `each_file'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/sprockets-2.1.3/lib/sprockets/base.rb:210:in `each_logical_path'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/actionpack-3.2.8/lib/sprockets/static_compiler.rb:18:in `compile'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/actionpack-3.2.8/lib/sprockets/assets.rake:56:in `internal_precompile'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/actionpack-3.2.8/lib/sprockets/assets.rake:70:in `block (3 levels) in <top (required)>'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `call'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `block in execute'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `each'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `execute'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/rake-0.9.2.2/lib/rake/task.rb:158:in `block in invoke_with_call_chain'
/usr/local/mydevil/ruby19/lib/ruby/1.9/monitor.rb:211:in `mon_synchronize'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/rake-0.9.2.2/lib/rake/task.rb:151:in `invoke_with_call_chain'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/rake-0.9.2.2/lib/rake/task.rb:144:in `invoke'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/actionpack-3.2.8/lib/sprockets/assets.rake:60:in `block (3 levels) in <top (required)>'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `call'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `block in execute'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `each'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `execute'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/rake-0.9.2.2/lib/rake/task.rb:158:in `block in invoke_with_call_chain'
/usr/local/mydevil/ruby19/lib/ruby/1.9/monitor.rb:211:in `mon_synchronize'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/rake-0.9.2.2/lib/rake/task.rb:151:in `invoke_with_call_chain'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/rake-0.9.2.2/lib/rake/task.rb:144:in `invoke'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/rake-0.9.2.2/lib/rake/application.rb:116:in `invoke_task'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `block (2 levels) in top_level'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `each'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `block in top_level'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/rake-0.9.2.2/lib/rake/application.rb:88:in `top_level'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/rake-0.9.2.2/lib/rake/application.rb:66:in `block in run'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/rake-0.9.2.2/lib/rake/application.rb:63:in `run'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/rake-0.9.2.2/bin/rake:33:in `<top (required)>'
/usr/local/mydevil/ruby19/bin/rake:23:in `load'
/usr/local/mydevil/ruby19/bin/rake:23:in `<main>'
Tasks: TOP => assets:precompile:primary
rake aborted!
Command failed with status (1): [/usr/local/mydevil/ruby19/bin/ruby19 /usr/...]
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/rake-0.9.2.2/lib/rake/file_utils.rb:53:in `block in create_shell_runner'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/rake-0.9.2.2/lib/rake/file_utils.rb:45:in `call'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/rake-0.9.2.2/lib/rake/file_utils.rb:45:in `sh'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/rake-0.9.2.2/lib/rake/file_utils_ext.rb:39:in `sh'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/rake-0.9.2.2/lib/rake/file_utils.rb:80:in `ruby'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/rake-0.9.2.2/lib/rake/file_utils_ext.rb:39:in `ruby'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/actionpack-3.2.8/lib/sprockets/assets.rake:12:in `ruby_rake_task'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/actionpack-3.2.8/lib/sprockets/assets.rake:21:in `invoke_or_reboot_rake_task'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/actionpack-3.2.8/lib/sprockets/assets.rake:29:in `block (2 levels) in <top (required)>'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `call'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/rake-0.9.2.2/lib/rake/task.rb:205:in `block in execute'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `each'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/rake-0.9.2.2/lib/rake/task.rb:200:in `execute'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/rake-0.9.2.2/lib/rake/task.rb:158:in `block in invoke_with_call_chain'
/usr/local/mydevil/ruby19/lib/ruby/1.9/monitor.rb:211:in `mon_synchronize'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/rake-0.9.2.2/lib/rake/task.rb:151:in `invoke_with_call_chain'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/rake-0.9.2.2/lib/rake/task.rb:144:in `invoke'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/rake-0.9.2.2/lib/rake/application.rb:116:in `invoke_task'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `block (2 levels) in top_level'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `each'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/rake-0.9.2.2/lib/rake/application.rb:94:in `block in top_level'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/rake-0.9.2.2/lib/rake/application.rb:88:in `top_level'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/rake-0.9.2.2/lib/rake/application.rb:66:in `block in run'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/rake-0.9.2.2/lib/rake/application.rb:133:in `standard_exception_handling'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/rake-0.9.2.2/lib/rake/application.rb:63:in `run'
/usr/home/mitchpolska/domains/zapust.pl/public_ror/vendor/bundle/ruby/1.9/gems/rake-0.9.2.2/bin/rake:33:in `<top (required)>'
/usr/local/mydevil/ruby19/bin/rake:23:in `load'
/usr/local/mydevil/ruby19/bin/rake:23:in `<main>'
Tasks: TOP => assets:precompile 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T17:16:28.900

您的 tiny mce 版本在某处有一个无效字符，导致资产预编译崩溃。

按照此处的建议使用小 mce gem：[Rails assets pipeline 导致问题](https://stackoverflow.com/questions/6890368/rails-assets-pipeline-causing-problems)

或者，尝试找到适用于资产管道的微型 mce 版本

# templates - Jade 模板 - 动态属性

> ID：13592592
> 
> 赞同：21
> 
> 时间：2012-11-27T20:37:05.020
> 
> 标签：templates, pug

我想为一些 html 元素动态创建属性。

在我的情况下，我想根据`user.role`.

因此，如果`user`有权编辑某些字段，我不想在元素上放置禁用属性。否则，我确实想要它。

我知道我可以用这些方法做到这一点：

### - 方法 1 - 使用条件

```
if (user.role === 1)
   input(type='text', name='foo')
else
   input(type='text', name='foo', disabled) 
```

### - 方法 2 - 纯 HTML

```
- var disabledAttr = (user.role === 1) ? "disabled" : "";
| <input type="text" name="foo" #{ disabledAttr} /> 
```

方法 1 不好，因为我需要重复一些代码。使用方法 2 我不需要重复代码，但我必须使用纯 HTML 而不是 Jade 标记。

我试过这样的事情：

```
input(type='text', name='foo', #{ disabledAttr} ) 
```

但是jade生成如下代码：

```
<input type="text" name="foo" disabledattr="" /> 
```

有更好的主意吗？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-11-28T21:10:05.433

Jade 在需要弄清楚如何渲染属性时非常聪明。您可以使用这一行玉标记呈现您的禁用属性

```
input(type='text', name='foo', disabled=role!==1) 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-10-14T17:12:27.227

您可以有条件地使用一堆属性：

```
input(type='text')&attributes(user.role === 1 ? {'disabled': 'true'} : {'class': 'admin', 'ng-model': 'vm.model.name', 'ng-click': 'vm.click()'}) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-05-29T07:24:23.580

这种语法对我有用：

```
input(placeholder!="<%= translate('Add new item') %>") 
```

其中 translate 是一个返回翻译文本的函数。

# c++ - Linux 和 Windows 的 wchar_t 的区别和转换

> ID：13592598
> 
> 赞同：0
> 
> 时间：2012-11-27T20:37:15.713
> 
> 标签：c++, visual-c++, g++, wchar

我从[这个](https://stackoverflow.com/questions/4383946/conflicts-definition-of-wchar-t-string-in-c-standard-and-windows-implementati)和[这个](http://social.msdn.microsoft.com/Forums/br/vclanguage/thread/e00358e5-1dab-4c92-8676-112445494f9e)线程中了解到，在 Windows 中，wchar_t 是 16 位的，而对于 Linux，wchar_t 是 32 位的。

我有一个客户端-服务器架构（仅使用管道而不是套接字）——我的服务器是基于 Windows 的，客户端是 Linux。

服务器有一个 API 可以从客户端检索主机名。当客户端基于 Windows 时，它可以只执行 GetComputerNameW 并返回 Wide-String。但是，当客户端基于 Linux 时，事情就会变得一团糟。

作为第一种天真的方法，我使用 mbstowcs() 希望将 wchar_t* 返回到 Windows 服务器端。但是，这个 LPWSTR（我的 linux 客户端有 typedef wchar_t* LPWSTR）在 Windows 上是无法识别的，因为它期望它的 wchar_t 是 16 位的。

那么，将 linux 上 gethostname() 的输出转换为 char* 为 unsigned short（16 位）是我唯一的选择吗？

提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-27T20:48:01.797

您必须决定如何通过网络传输数据的实际协议。这里有几个选项，虽然可能 UTF-8 通常是最明智的选项 - 这也意味着在 linux 下您基本上可以按原样使用数据（没有理由使用 wchar_t 开始，尽管您显然可以将其转换为您想要的任何内容想）。

在 Windows 下，您必须将 UTF-8 转换为 Windows 需要的 UTF-16（不完全是，但很好），如果您想发送数据，您必须将其转换为 UTF-8。幸运的是，windows分别为[这些目的提供了这个](http://msdn.microsoft.com/en-us/library/windows/desktop/dd374130%28v=vs.85%29.aspx)[功能](http://msdn.microsoft.com/en-us/library/windows/desktop/dd319072%28v=vs.85%29.aspx)。

显然，您可以决定您想要的任何编码不一定是 UTF-8，过程是相同的：接收数据时将其转换为操作系统的本机格式，发送时将其转换为您的在线编码。如果您不使用 utf-8，[iconv可以在 linux 上运行。](http://manpages.courier-mta.org/htmlman3/iconv.3.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T20:53:46.187

您最好为通过管道发送的数据选择标准字符编码，然后要求所有机器使用该编码发送数据。

Windows 使用 UTF-16LE，因此您可以选择在管道上使用 UTF-16LE，然后 Windows 机器可以按原样发送其 UTF-16LE 编码的字符串，但 Linux 机器必须根据需要与 UTF-16LE 进行转换。

或者您可以选择 UTF-8，这将减少网络带宽，但 Windows 和 Linux 机器都必须根据需要转换为/从 UTF-8。对于网络通信，UTF-8 会是更好的选择。

在 Windows 上，您可以使用`MultiByteToWideChar()`和`WideCharToMultiByte()`与`CP_UTF8`代码页。

在 Linux 中，使用`iconv()`API 以便您可以指定 UTF-8 字符集进行编码/解码。

# php - PHP json_encode 到 Python 命令行参数 - 时髦的字符

> ID：13592605
> 
> 赞同：2
> 
> 时间：2012-11-27T20:37:40.753
> 
> 标签：php, python, json, string, command-line

> **可能重复：**
> [当我使用 json.loads 时，u 是什么？](https://stackoverflow.com/questions/9200962/what-are-the-us-when-i-use-json-loads)

尝试通过 json_encode 将一些字符串数据编码为 PHP 中的 json 并将其传递给同一服务器上的我的 python 脚本：

该数据将包含引号，并将具有一个包含 url 字符串的嵌入式数组。

```
$data =array("test.com", array("http://google.com", "http://cnn.com"), "ASDASDASD");
$jsonified = json_encode($data);
shell_exec("python /path_to_script/script.py '".$jsonified."'"); 
```

这有望将数据作为第一个参数运行脚本。

现在，我有点担心它可以正确加载到一个东西中：

```
import json
import sys

encoded = sys.argv[1]
print "ENCODED: ", encoded

decoded = json.loads(encoded)
print "DECODED: ", decoded 
```

我这样称呼它：

```
~$ python json-test.py '["test.com", ["http://www.google.com", "http://cnn.com"], "ASDASDASDASD"]'
ENCODED: ["test.com",["http://www.google.com", "http://cnn.com"], "ASDASDASDASD"]
DECODED: [u'test.com', [u'http://www.google.com', u'http://cnn.com'], u'ASDASDASDASD'] 
```

'u'是怎么回事？我也希望这会以某种方式顺利进行，这是否正确？

# web - RavenDB windows 服务如何为网页提供服务？

> ID：13592610
> 
> 赞同：1
> 
> 时间：2012-11-27T20:38:06.657
> 
> 标签：web, windows-services, ravendb

我将 RavenDB 作为 Windows 服务运行。它如何提供网页服务？我在 RavenDB 文件夹结构中看不到任何 HTML 或 ASPX 文件。

此外，当我启动服务并运行此命令时：

> 网络统计-an | 找到“8080”

我得到这个结果：

> TCP 0.0.0.0:8080 0.0.0.0:0
> 监听 TCP [::]:8080 [::]:0 监听

如果 windows 服务正在侦听**TCP** 8080，那么为什么我可以通过**HTTP**从浏览器访问 Raven Studio ？

```
http://server:8080/raven/studio.html 
```

我知道我遗漏了一些基本的东西，但我不确定这是如何结合在一起的，我想知道，因为我认为它会帮助我弄清楚如何保护 DB 和 Raven Studio。有人可以解释一下吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T21:03:05.737

HTTP 是 TCP 之上的一层。 **使用 netstat 之类的工具，所有**Web 服务器都将显示为 TCP。

您不需要 html 或 aspx 文件来使用 http。如果您作为服务或控制台模式运行，raven 在内部使用[System.Net.HttpListener 。](http://msdn.microsoft.com/en-us/library/vstudio/34xswsd2.aspx)（它也可以在 IIS 内部运行，或者直接嵌入到您的应用程序中）。

关于安全性，RavenDB 有很多选择：

*   Windows 身份验证
*   [匿名访问](http://ravendb.net/docs/http-api/http-api-security)
*   [身份验证](http://ravendb.net/docs/server/bundles/authentication)
*   [混合模式](https://groups.google.com/group/ravendb/browse_thread/thread/d87a67d0b1a516c)

# linq - 将 IQueryable 转换为列表 类型

> ID：13592611
> 
> 赞同：0
> 
> 时间：2012-11-27T20:38:09.753
> 
> 标签：linq

我刚刚`LINQ`从 DAL 执行了一个查询，并获得了一个带有嵌入`ILIST`对象的记录集合，如下所示

```
string name
date   startDate
date  endDate
ILIST<MyType> ImbeddedList (this contains more columns like recordID, sentDate, dueDate) 
```

我需要返回一个`LIST<T>`网格来限制。

我在编写`LINQ`语句以过滤出`IQueryable`集合对象时遇到了一些问题。

在我下面的声明中：

```
IQueryable<All_DATA> cases = dalObject.GetData();
var mylist = cases.Select(s => {s.name, s.startDate, s.endDate,s.ImbeddedList????}).ToList(); 
```

当我到达从 dalObject 返回的 ImbeddedList 时，智能感知不会显示 ImbeddedList 中的字段。如何正确编写`LINQ`语句以过滤 ImbeddedList 对象中的更多字段？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T21:04:01.340

据我了解，您可以做的是

**从获取完整列表`ImbeddedList`**

```
var mylist = cases.Select(s => {s.name, s.startDate, s.endDate, s.ImbeddedList}).ToList(); 
```

**并从`ImbeddedList`**

```
var mylist = cases.SelectMany(s => s.ImbeddedList)
                  .Select(IItem => { IItem.Field1, IItem.Field2 }).ToList(); 
```

更多信息请参考：

1.  [Linq SelectMany 运算符](http://www.codethinked.com/the-linq-selectmany-operator)
2.  [LINQ - Get all items in a List within a List?](https://stackoverflow.com/q/3267079/468718)
3.  [Using LINQ, select list of objects inside another list of objects](https://stackoverflow.com/q/3934583/468718)
4.  [Use Google Search: "linq select list within list"](https://www.google.co.in/webhp?q=linq%20select%20list%20within%20list)

# c# - 如何打印文本文件中隐藏字段的值？

> ID：13592613
> 
> 赞同：0
> 
> 时间：2012-11-27T20:38:18.530
> 
> 标签：c#, javascript, field, hidden

我一直在尝试获取用户在文本框中输入的值以存储在隐藏字段中，因为我需要将其从客户端发送到服务器端，但我什至不确定隐藏字段中存储的内容. 如何将该值发送或复制到文本文件中？所以分解我的问题：

*   取用户输入的文本框中的值并将其存储在隐藏字段中。
*   将值打印到文本文件中

提前感谢您，因为我对 C# 和 JavaScript 很陌生

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T20:42:05.647

您可以做的是将值复制到页面的可见部分。

给定以下 HTML：

```
<div id="output"></div>
<input type="hidden" name="testfield" /> 
```

使用以下 JS：

```
document.getElementById('output').innerHTML = document.forms[0].testfield.value; 
```

...然后打印页面。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T20:41:04.377

使用调试器并在服务器端检查传递的值比在服务器端写入文本文件要好得多。

或者，大多数浏览器都有开发人员模式，可让您查看通过网络发送的数据。例如，在 IE 中，按 F12，单击网络，然后单击开始捕获。这将允许您查看所有表单字段中正在发送的数据，包括隐藏的字段。

如果你真的想写入一个文本文件，你可以使用

```
File.WriteAllText(myPath, myText); 
```

[http://msdn.microsoft.com/en-us/library/ms143375.aspx](http://msdn.microsoft.com/en-us/library/ms143375.aspx)

# python - python pandas数据帧线程安全吗？

> ID：13592618
> 
> 赞同：21
> 
> 时间：2012-11-27T20:38:31.140
> 
> 标签：python, thread-safety, pandas

我正在使用多个线程来访问和删除我的 pandas 数据框中的数据。正因为如此，我想知道熊猫数据帧是线程安全的吗？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2019-03-27T17:07:06.323

不，熊猫不是线程安全的。而且它以令人惊讶的方式不是线程安全的。

*   当另一个线程正在使用时，我可以从熊猫数据框中删除吗？

胡思乱想！没有。而且一般不会。甚至对于 GIL 锁定的 python 数据结构也不行。

*   我可以在别人写的时候从 pandas 对象中读取吗？
*   我可以在我的线程中复制 pandas 数据框并进行复制吗？

当然不。有一个长期悬而未决的问题：[https ://github.com/pandas-dev/pandas/issues/2728](https://github.com/pandas-dev/pandas/issues/2728)

实际上，我认为这是非常合理（即预期）的行为。我不希望能够同时写入和读取或复制任何数据结构，除非：i）它是为并发设计的，或者 ii）我对该对象*和所有视图对象都有一个排他锁派生自它*（`.loc`,`.iloc`是视图，pandas 可能有其他视图）。

*   我可以在没有其他人写入的情况下读取 pandas 对象吗？

对于 Python 中的几乎所有数据结构，答案都是肯定的。对于熊猫，没有。看来，这不是目前的设计目标。

通常，如果没有人执行变异操作，您可以对对象执行“读取”操作。不过，你必须要小心一点。一些数据结构，包括 pandas，执行记忆化，以缓存昂贵的操作，否则这些操作在功能上是纯的。在 Python 中实现无锁记忆通常很容易：

```
@property
def thing(self):
    if _thing is MISSING:
        self._thing = self._calc_thing()
    return self._thing 
```

...它简单而安全（假设分配是安全的原子的——并非所有语言都如此，但在 CPython 中，除非你重写`__setattribute__`）。

Pandas、series 和 dataframe 索引在第一次使用时是惰性计算的。我希望（但我在文档中看不到保证）它们以类似的安全方式完成。

对于所有库（包括熊猫），如果没有人执行变异操作，我*希望*所有类型的只读操作（或更具体地说，“功能纯”操作）都是线程安全的。我认为这是一个“合理的”容易实现的、常见的、较低的线程安全标准。

但是，对于 pandas，您**不能**假设这一点。*即使您可以保证没有人对您的对象执行“功能不纯”的操作（例如写入单元格、添加/删除列），pandas 也不是线程安全的。*

这是一个最近的例子：[https](https://github.com/pandas-dev/pandas/issues/25870) ://github.com/pandas-dev/pandas/issues/25870 （它被标记为 .copy-not-threadsafe 问题的副本，但它似乎可能是一个单独的问题）。

```
s = pd.Series(...)
f(s)  # Success!

# Thread 1:
   while True: f(s)  

# Thread 2:
   while True: f(s)  # Exception ! 
```

... 失败`f(s): s.reindex(..., copy=True)`，它返回结果 a 作为新对象——你会认为它在功能上是纯的和线程安全的。不幸的是，事实并非如此。

这样做的结果是，我们无法在生产环境中将 pandas 用于我们的医疗保健分析系统——我现在不鼓励将它用于内部开发，因为它会使只读操作的内存中并行化变得不安全。（！！）

这种`reindex`行为很奇怪而且令人惊讶。如果有人对它失败的原因有任何想法，请在此处回答： [pandas.Series.reindex(, copy=True) 的这种用法中线程不安全的根源是什么？](https://stackoverflow.com/questions/55347139/whats-the-source-of-thread-unsafety-in-this-usage-of-pandas)

维护者将此标记为 [https://github.com/pandas-dev/pandas/issues/2728](https://github.com/pandas-dev/pandas/issues/2728)的副本。我很怀疑，但如果`.copy`是来源，那么*几乎所有的熊猫*在任何情况下都不是线程安全的（这是他们的建议）。

！

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2012-11-27T22:01:48.797

可以以线程安全的方式访问底层 ndarray 中的数据，并自行承担修改风险。删除数据会很困难，因为更改 DataFrame 的大小通常需要创建一个新对象。我想在未来的某个时候改变这一点。

# css - 将随机空白添加到 subnav li 的

> ID：13592622
> 
> 赞同：0
> 
> 时间：2012-11-27T20:38:47.247
> 
> 标签：css, navigation

[http://www.occmedjackson.com/services/](http://www.occmedjackson.com/services/)

请参阅左侧边栏导航。最后一个 LI 不应该掉下来。查看源代码，没有理由这样做。但是，当我在 chrome 中检查它时，我看到生成的代码中出现了一个随机双引号（不显示）。这似乎是推动这一点的原因。只有当我们的客户使用 Dreamweaver 添加到菜单时才会发生这种情况，但当我使用 Dreamweaver 时不会发生这种情况。

任何想法这是什么，是什么导致它，或者防止它发生的解决方案（或者添加一些 js 或 css 来修复它，如果它发生了）？事实上，我每次都需要重新创建菜单来修复。

谢谢！富有的！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T21:18:09.763

看起来有问题的字符是`<li> <--` 如果您删除 > 的右括号和`<a`标签的左括号并输入您自己的空格，那么空格就会消失。您的用户可能会在 MS Word（或其他一些编辑软件）中输入他们的代码并将其粘贴到 Dreamweaver 中。

代替`><`

# javascript - 根据窗口中的元素位置用jquery定位弹出菜单

> ID：13592623
> 
> 赞同：2
> 
> 时间：2012-11-27T20:38:56.820
> 
> 标签：javascript, jquery, css, popup, positioning

我确信可能有人问过这个问题，但我找不到正确的解决方案..

我需要在鼠标悬停的图标上显示一个菜单，该图标可以放置在页面的任何位置。示例代码在这里：（[http://jsfiddle.net/Qfjdk/2/](http://jsfiddle.net/Qfjdk/2/)）这显示了弹出窗口，但是如果我将代码从

```
#nav {
    margin:0; 
    padding:0; 
    list-style:none;
    float: left;
} 
```

到

```
#nav {
    margin:0; 
    padding:300px; 
    list-style:none;
    float: right;
} 
```

可以看出，菜单的位置总是在下方居中。我想根据图标的显示位置更改菜单的位置。

如果图标元素右对齐，我想将菜单定位在图标的右边缘。如果图标元素位于显示页面的左下角，我希望左下角的菜单与左上角的元素对齐，等等。

我不是在寻找算法，而是在寻找设置参数的正确方法.. 感谢您的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T22:34:55.570

我将首先定义您想要支持多少个替代方案（例如，4：右上角、右下角、左上角或左下角的按钮），并使用这些不同的选项创建一组类（.pos1、 .pos2、.pos3、.pos4)。

然后我会使用 JS 或 jQuery 来计算图标相对于窗口的偏移量。根据该结果，我将为弹出窗口提供您之前创建的正确类。您可以在加载时执行此操作，也可以在调整窗口大小时执行此操作。例如，计算向右的距离并应用 css 更改（您可以改为应用一个类，但这只是为了说明它是如何工作的）：

```
var callback = function () {

// when hover on an element, calculate offset to right

        $('.yourElement').mouseover(function(){ 
            var currentElement = $(this);
            var distanceRight = $(window).width() - ($(currentElement).offset().left + $(currentElement).width());

            // If the distance is less than 50, then do...          
            if (distanceRight < 50) {
                $('.yourPopup').css("left","-200px");
            }
            else {}
        });
    };

    $(document).ready(callback);
    $(window).resize(callback); 
```

# visual-studio-2010 - 报表查看器 VS2010

> ID：13592624
> 
> 赞同：0
> 
> 时间：2012-11-27T20:38:58.657
> 
> 标签：visual-studio-2010, report-viewer2010

我在 Visual Studio 中有一个我编写的程序的报告。我的问题是我想按部门然后按供应商名称对报告进行排序。但是，我的问题是 Department 和 SupplierName 在不同的数据集中。那么如何对两个不同的数据集进行排序呢？现在我的报告只使用一个数据集，而不是供应商名称，它是供应商ID。

报告示例（原样）：

![按原样报告](../Images/5aee4cdf5be37d038c047f92e6843783.png)

数据集：

![数据集](../Images/3229b7017305bfbf4e926ed08a0fcb22.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-29T19:40:51.313

一个可能的解决方案是创建一个结合两个数据集的数据集。然后只需创建具有相同列标题的表并添加两种排序。

要添加数据集，只需右键单击项目 -> 添加新项目 -> 数据 -> 数据集

我相信这将是唯一的方法，因为数据集与表相关联，并且任何一个表只能有一个数据集。

希望这可以帮助。

# c - C Strtok 段错误

> ID：13592625
> 
> 赞同：0
> 
> 时间：2012-11-27T20:39:00.540
> 
> 标签：c, segmentation-fault, strtok

我不确定为什么以下代码会出现段错误：

```
char * buffer = "SIZE";
char * tempString;
tempString = strtok(buffer, " ");
if(strcmp(tempString, "SIZE") == 0){    
    tempString = strtok(NULL, " ");           <----Faulting here
} 
```

由于没有任何东西可以标记，tempString 不应该等于 NULL 吗？感谢您提前提供任何帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-27T20:43:12.177

有两个问题：

首先，`strtok`第一个参数需要一个可修改的字符串，而`buffer`在您的示例中不是。试试这个：

```
char buffer[] = "SIZE"; 
```

其次，`strcmp`不处理`NULL`哪个`strtok`可以返回：

```
if (NULL != tempString && strcmp(tempString, "SIZE") == 0) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T21:56:40.773

[只需按照参考文献](http://www.cplusplus.com/reference/cstring/strtok/)所述检查标记化的元素，如果您遵循它，您就有了一个干净的方法。

正确代码：

```
char buffer[] = "SIZE";
char * tok;
tok = strtok(buffer, " ");
while(tok != NULL)
{
  if(strcmp(tok, "SIZE") != 0)    
    break;
  tok = strtok(NULL, " ");        //   <----Faulted here
} 
```

是的，它可能会跳过缓冲区中的多个“SIZE”字，所以它比你最初做的要多一点，但是对于其他程序员来说更容易阅读（以后也更容易回忆起它）。

# sql - 存储过程 sql server 2008 NOT IN

> ID：13592636
> 
> 赞同：1
> 
> 时间：2012-11-27T20:39:31.657
> 
> 标签：sql, sql-server-2008, select, inner-join

我创建了一个查询，允许我使用以下代码查看公司名称 = Best Baths 的客户订购的所有商品。

```
Select co.OrderID, cu.FName + '  ' + cu.SName as 'Name', 
cu.Address1 + ', ' + cu.Address2 + ', ' + cu.Address3 as 'Dispatch Address', 
cu.PostCode, 
ma.MaterialName as 'Item',
mi.Price as 'Item Price',
co.DateOrdered as 'Order Date',
pm.DateReceived,

CASE WHEN la.Status = 'Blocked' THEN 'Blocked' ELSE 'Active' END AS Status

from Customers cu
-- inner join the following to find customers orders and cost
inner join CustomerOrder co on co.CustomerID = cu.CustomerID
inner join ItemOrder io on co.ID = io.ItemOrderID
inner join materialItem mi on io.MaterialID = mi.MaterialItemID
inner join Material ma on io.MaterialID = ma.MaterialItemID
left join ItemForInvoice ifi on io.ItemOrderID = ifi.ItemOrderID
left join Invoice iv on ifi.InvoiceItemID = iv.InvoiceItemID
left join PaymentMethod pm on iv.InvoiceID = pm.InvoiceID
left join LockedAccount la on pm.PaymentID = la.PaymentID
inner join Suppliers su on mi.SupplierID = su.SuppliersID
inner join SupplierDetails sd on su.SuppliersID = sd.SuppliersID
Where su.SuppliersName = 'Best Baths' 
```

我现在想创建一个显示尚未订购的商品的查询，有人能指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T20:44:37.457

从您的查询中不清楚什么表是什么，但基本查询类似于

```
SELECT items.id, COUNT(orders.itemid) AS cnt
FROM items
LEFT JOIN orders ON items.id = orders.itemid
GROUP BY items.id
HAVING (cnt = 0) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-28T08:41:39.237

Annoscia，看这个例子：

```
(SELECT coll FROM TableA)
EXCEPT
(SELECT coll FROM TableB) 
```

意思是：

```
SELECT DISTINCT coll
  FROM TableA 
 WHERE NOT EXISTS (SELECT * 
                     FROM TableB 
                    WHERE TableA.col1 = TableB.col1) 
```

对于你的情况，它会是这样的：

```
Select co.OrderID, cu.FName + '  ' + cu.SName as 'Name', 
cu.Address1 + ', ' + cu.Address2 + ', ' + cu.Address3 as 'Dispatch Address', 
cu.PostCode, 
ma.MaterialName as 'Item',
mi.Price as 'Item Price',
co.DateOrdered as 'Order Date',
pm.DateReceived,    
CASE WHEN la.Status = 'Blocked' THEN 'Blocked' ELSE 'Active' END AS Status

from Customers cu
-- inner join the following to find customers orders and cost
inner join CustomerOrder co on co.CustomerID = cu.CustomerID
inner join ItemOrder io on co.ID = io.ItemOrderID
inner join materialItem mi on io.MaterialID = mi.MaterialItemID
inner join Material ma on io.MaterialID = ma.MaterialItemID
left join ItemForInvoice ifi on io.ItemOrderID = ifi.ItemOrderID
left join Invoice iv on ifi.InvoiceItemID = iv.InvoiceItemID
left join PaymentMethod pm on iv.InvoiceID = pm.InvoiceID
left join LockedAccount la on pm.PaymentID = la.PaymentID
inner join Suppliers su on mi.SupplierID = su.SuppliersID
inner join SupplierDetails sd on su.SuppliersID = sd.SuppliersID

EXCEPT

Select co.OrderID, cu.FName + '  ' + cu.SName as 'Name', 
cu.Address1 + ', ' + cu.Address2 + ', ' + cu.Address3 as 'Dispatch Address', 
cu.PostCode, 
ma.MaterialName as 'Item',
mi.Price as 'Item Price',
co.DateOrdered as 'Order Date',
pm.DateReceived,

CASE WHEN la.Status = 'Blocked' THEN 'Blocked' ELSE 'Active' END AS Status

from Customers cu
-- inner join the following to find customers orders and cost
inner join CustomerOrder co on co.CustomerID = cu.CustomerID
inner join ItemOrder io on co.ID = io.ItemOrderID
inner join materialItem mi on io.MaterialID = mi.MaterialItemID
inner join Material ma on io.MaterialID = ma.MaterialItemID
left join ItemForInvoice ifi on io.ItemOrderID = ifi.ItemOrderID
left join Invoice iv on ifi.InvoiceItemID = iv.InvoiceItemID
left join PaymentMethod pm on iv.InvoiceID = pm.InvoiceID
left join LockedAccount la on pm.PaymentID = la.PaymentID
inner join Suppliers su on mi.SupplierID = su.SuppliersID
inner join SupplierDetails sd on su.SuppliersID = sd.SuppliersID
Where su.SuppliersName = 'Best Baths' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T21:12:57.210

如果您正在寻找尚未订购的材料（即项目），那么 NOT EXISTS 子句将很有效。您只需要通过 ItemOrder 表检查它是否没有参与到订单中。

```
Select ma.MaterialName as [Item],
       mi.Price as [Item Price]
  from Material ma
  join materialItem mi on io.MaterialID = mi.MaterialItemID
 where not exists (select *
                     from ItemOrder io
                    where io.MaterialID = ma.MaterialItemID) 
```

**以后请**不要使用 ( `'`) 单引号引用列别名，请使用方括号。

# c# - 在 Dispose() 中等待 Backgroundworker

> ID：13592641
> 
> 赞同：1
> 
> 时间：2012-11-27T20:39:54.977
> 
> 标签：c#, .net, winforms, multithreading, backgroundworker

再会！

我有自定义`popupcontainer control`组合框，您可以在其中放置其他控件，它们将出现在弹出窗口中。就我而言，它包含`datagrid`. 我想让它快速工作——只有当用户决定弹出我的控件时，我才需要那个数据网格。我决定将数据网格的创建移到其他线程并使用`Backgroundworker`它，因为它非常适合 UI，而且我不想弄乱 Control.Invoke。这是我的简化代码：

```
 protected override void  OnCreateControl()
    {
        base.OnCreateControl();
        CreateContainer();
    }
    protected virtual void CreateContainer()
    {
        _worker = new BackgroundWorker();
        _worker.DoWork += DoActionsOnAsyncWork;
        _worker.RunWorkerCompleted += AsyncWorker_RunWorkerCompleted;
        _worker.RunWorkerAsync(this);
    }
    protected void DoActionsOnAsyncWork(object sender, DoWorkEventArgs e)
    {
        var _grid = ///Create and initialize local grid here
        e.Result = _grid; // Throw it to RunWorkerCompleted event
    }
    private void AsyncWorker_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
    {
        if (!e.Cancelled && e.Error == null && !IsDisposed && !IsDisposing)
        {
            if (!_closing)
            {
              this.Grid = e.Result as MyGrid;
              AttachEventHandlersToGrid();
            } else
              (e.Result as MyGrid).Dispose(); // Get rid of grid
        }

        // Get rid of worker
        _worker.DoWork -= DoActionsOnAsyncWork;
        _worker.RunWorkerCompleted -= AsyncWorker_RunWorkerCompleted;
        _worker.Dispose();
        _worker = null;
    }
    protected override void Dispose(bool disposing)
    {
        if (disposing)
        {
            WaitForBackgroundWorker();
            // Dispose other stuff
            ...
        }
        base.Dispose(disposing);
    }

    protected void WaitForBackgroundWorker()
    {
        if (_worker == null ||
            !_worker.IsBusy)
            return;
        _closing = true;

        while (_worker != null && _worker.IsBusy)
            Application.DoEvents(); // Hack throw worker.RunWorkerCompleted on top of msg queue
    } 
```

现在，我需要等待`_worker`才能正确处理我的控件（表单范围更大）。此外，`_worker`还`grid`需要进行处理。`backgroundworker`我的问题是 - 如果没有 Application.DoEvents() ，我该如何等待。因为有时（通常在远程桌面上 - 也许其他一些绘画算法？）它会导致整个应用程序挂起。调用堆栈：

```
 mscorlib.dll!System.Threading.WaitHandle.InternalWaitOne(System.Runtime.InteropServices.SafeHandle waitableSafeHandle, long millisecondsTimeout, bool hasThreadAffinity, bool exitContext) + 0x1f bytes     
 mscorlib.dll!System.Threading.WaitHandle.WaitOne(long timeout, bool exitContext) + 0x23 bytes   
 mscorlib.dll!System.Threading.WaitHandle.WaitOne(int millisecondsTimeout, bool exitContext) + 0x1c bytes    
 System.Windows.Forms.dll!System.Windows.Forms.Control.WaitForWaitHandle(System.Threading.WaitHandle waitHandle) + 0x96 bytes    
 System.Windows.Forms.dll!System.Windows.Forms.Control.MarshaledInvoke(System.Windows.Forms.Control caller, System.Delegate method, object[] args, bool synchronous) + 0x34b bytes   
 System.Windows.Forms.dll!System.Windows.Forms.Control.Invoke(System.Delegate method, object[] args) + 0x50 bytes    
 System.Windows.Forms.dll!System.Windows.Forms.WindowsFormsSynchronizationContext.Send(System.Threading.SendOrPostCallback d, object state) + 0x56 bytes     
 System.dll!Microsoft.Win32.SystemEvents.SystemEventInvokeInfo.Invoke(bool checkFinalization, object[] args) + 0x66 bytes    
 System.dll!Microsoft.Win32.SystemEvents.RaiseEvent(bool checkFinalization, object key, object[] args) + 0x110 bytes     
 System.dll!Microsoft.Win32.SystemEvents.RaiseEvent(object key, object[] args) + 0xe bytes   
 System.dll!Microsoft.Win32.SystemEvents.OnUserPreferenceChanged(int msg, System.IntPtr wParam, System.IntPtr lParam) + 0x76 bytes   
 System.dll!Microsoft.Win32.SystemEvents.WindowProc(System.IntPtr hWnd, int msg, System.IntPtr wParam, System.IntPtr lParam) + 0x2c6 bytes   
 [Native to Managed Transition]  
 [Managed to Native Transition]  
 System.Windows.Forms.dll!System.Windows.Forms.Application.ComponentManager.System.Windows.Forms.UnsafeNativeMethods.IMsoComponentManager.FPushMessageLoop(System.IntPtr dwComponentID, int reason, int pvLoopData) + 0x357 bytes    
 System.Windows.Forms.dll!System.Windows.Forms.Application.ThreadContext.RunMessageLoopInner(int reason, System.Windows.Forms.ApplicationContext context) + 0x33d bytes  
 System.Windows.Forms.dll!System.Windows.Forms.Application.ThreadContext.RunMessageLoop(int reason, System.Windows.Forms.ApplicationContext context) + 0x5f bytes    
 System.Windows.Forms.dll!System.Windows.Forms.Application.DoEvents() + 0x18 bytes   
 MyControl.WaitForBackgroundWorker() Line 874 + 0x1b bytes        
 ...  // Many recursive disposes    
 Form.Dispose() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T21:10:57.713

因为这条线：

```
while (_worker != null && _worker.IsBusy)
            Application.DoEvents(); // Hack throw worker.RunWorkerCompleted on top of msg queue 
```

即使 DoWork 已经完成，您的 while 循环也会阻止 RunWorkerCompleted 执行，因为它们在同一个线程中（while 循环继续执行。

像这样更改代码：

```
private void AsyncWorker_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
        {
            if (!e.Cancelled && e.Error == null && !IsDisposed && !IsDisposing)
            {
                if (!_closing)
                {
                    this.Grid = e.Result as MyGrid;
                    AttachEventHandlersToGrid();
                }
                else
                {
                    (e.Result as MyGrid).Dispose(); // Get rid of grid
                }
            }

            // Get rid of worker
            _worker.DoWork -= DoActionsOnAsyncWork;
            _worker.RunWorkerCompleted -= AsyncWorker_RunWorkerCompleted;
            _worker.Dispose();
            _worker = null;
            if(_closing)
                this.Dispose(); //call Dispose again, now you know that worker has finished
        }
        protected bool HasBackgroundWorkerFinished()
        {
            if (_worker == null ||
                !_worker.IsBusy)
                return true;
            _worker.CancelAsync();
            _closing = true; //this means that worker is busy
            return false;
        }
        protected override void Dispose(bool disposing)
        {
            bool dispose = true;
            if (disposing)
            {
                dispose = HasBackgroundWorkerFinished();
                if (dispose)
                {
                    // Dispose other stuff
                }
            }
            if(dispose) //don't dispose if worker didn't finish
                base.Dispose(disposing);
        } 
```

将 _worker 设置为接受取消并多次添加此代码

```
if (_worker.CancellationPending)
{
        e.Cancel = true;
        return;
} 
```

到所有主要代码部分之间的 DoWork 代码

# excel - 用于匹配单元格的 Excel 公式

> ID：13592642
> 
> 赞同：0
> 
> 时间：2012-11-27T20:39:55.283
> 
> 标签：excel, if-statement, spreadsheet, formula

我有一个这样的excel电子表格：

```
 - A  Column A - AB 12
 - B  Column B - AB 12
 - C  Does Column A match Column B? - Y 
```

但是，列信息是通过查询从数据库系统中提取的，有时值如下：

```
 - A  Column A - AB12
 - B  Column B - AB 12
 - C  Does Column A match Column B? - N 
```

我实际上他们确实匹配，我需要适应吗？可以这样做吗？我当前的第 3 列有这个公式：

`=IF(A3=B3,"Y","N")`

当它应该是yes时返回no。帮助？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T20:48:55.180

...`Substitute`在比较它们之前，您始终可以使用该功能从单元格中删除所有空格：

```
=IF(SUBSTITUTE(A3," ","")=SUBSTITUTE(B3," ",""), "Y", "N") 
```

# .net - 如何为大约 100 个客户实现“新邮件图标”？中央服务器轮询或本地客户端轮询？

> ID：13592643
> 
> 赞同：1
> 
> 时间：2012-11-27T20:40:05.737
> 
> 标签：.net, wcf, sql-server-2008, long-polling, polling

以下场景：我们有一个数据库表，其中存储了用户的新邮件消息。当用户运行我们的客户端应用程序时，当该用户的条目插入到数据库表中时，应用程序需要显示一个新邮件已到达的图标。

大约 100 个用户将同时登录。

据我所知，有两种解决方案：

1.  在中央服务器上实现服务。该服务器定期轮询数据库。此外，客户端在启动时需要向服务器注册，以便在收到用户的新消息时回调它们。好：更少的数据库轮询。不好：中心元素的编码更多。
2.  每个客户端都自己轮询数据库。轮询需要大约每分钟发生一次，所以我有 100 个客户端每分钟轮询数据库。馊主意？还是还可以？

那么，你会选择哪个选项？

我们的客户端使用 .NET 4.0，数据库使用 MS SQL Server 2008。

此外，如果您投票支持解决方案 1：WCF 服务会是一个好主意吗？围绕我的场景的任何链接或想法将不胜感激。

谢谢大家！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T05:36:46.637

现在跳出框框思考一下，您可能想要探索的另一个选项（特别是如果您已经有一个向应用程序公开内容的网络服务器）是使用一个将为您提供长轮询支持的库。例如，[SignalR](http://signalr.net/)。这样您就可以避免来自客户端的轮询，而只需担心接收通知。

[这是](http://blog.maartenballiauw.be/post/2011/12/06/Using-SignalR-to-broadcast-a-slide-deck.aspx)有关如何从控制台应用程序以及标准 web/js 实现中使用 SignalR 的教程。

现在，您遇到的另一个问题是不断轮询数据库以进行更改。您也可以通过使用`SqlDependency`ADO.net 和 SQL Server 中的功能（服务代理和通知）来避免这种情况。

[这是](http://www.codeproject.com/Articles/12335/Using-SqlDependency-for-data-change-events)一个使用这种实时通知方法的示例聊天应用程序。

根据并发客户端的实际数量，您甚至可以直接从客户端建立依赖关系（但**不**建议这样做）。

所以现在，结合这两者，您可以让您的服务器知道所有连接的客户端，并且您可以使用`SqlDependency`它仅在`Messages`表中的数据真正发生变化时触发更新。在这种情况下，您可能必须使用 ConnectionManager 获取 Hub，如[SignalR 的 wiki 底部](https://github.com/SignalR/SignalR/wiki/Hubs)所示，标题为*“Broadcasting over a Hub from outside of a Hub”*。

我相信这种替代方案将比快速轮询方法更好地扩展，并将大大减少客户端和服务器之间以及服务器和数据库之间的整体流量。

但是，请注意，如果您在网络农场中进行部署，您可能需要对 SignalR 当前对它的支持进行更多研究。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-10-01T08:18:45.157

选择选项 1。更多的代码，但更多的可扩展性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T20:44:25.910

我倾向于选择选项 1。更少的客户端与数据库交谈是一件好事，如果您稍后需要更改数据库或在其中添加一些其他逻辑，它会更容易。WCF 服务可能适用于此。

# javascript - Xdomain ajax html scrape在jquery中包装数据respose时加载图像

> ID：13592649
> 
> 赞同：0
> 
> 时间：2012-11-27T20:40:21.030
> 
> 标签：javascript, jquery, scrape

我正在尝试发出跨域请求以获取 html，对其进行缓存，然后遍历缓存的 html 以提取数据并最终将其放在页面上。这是有效的，但它浪费了 http reqs。

问题是，一旦我`data.responseText`用 jquery包装，`$(data.responseText)`它就会发出 40 个 http 请求来拉入图像。

是否可以在没有额外图像请求的情况下将 jquery html 对象缓存在变量中？

在这里使用这个 x-domain hack： [https ://github.com/padolsey/jQuery-Plugins/blob/master/cross-domain-ajax/jquery.xdomainajax.js](https://github.com/padolsey/jQuery-Plugins/blob/master/cross-domain-ajax/jquery.xdomainajax.js)

```
getPage: (baseUrl) ->
  console.log("beg scraping")
  $.ajax
    url: baseUrl,
    type: "get",
    dataType: "",
    success: (data) =>      
      frag = data.responseText
      @page = $(frag) # cache in object, now 40 extra reqs.
      # this doesn't work, only returns images
      #@page = $(frag).find('[src]').remove()
      console.log "Scraping done"
    error: (status) ->
      #window.pushError("getPage error: #{status}") 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T05:30:44.867

您可以快速搜索文本并删除所有`<img>`元素。然后创建 jQuery 对象：

```
var no_images = $(data.responseText.replace(/<img[^>]*>/g, '')); 
```

这是另一个您可能会发现有用的线程：

[将 HTML 字符串加载到 jQuery 中而不请求图像](https://stackoverflow.com/questions/11006216/load-an-html-string-into-jquery-without-requesting-images)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-07T23:32:14.220

或者，如果您想保留图像而不自动请求它们，则可以将 src 属性替换为不会自动获取的内容。例如

```
page.replace(/src/g, 'source'); 
```

这会将 src 引用保留在“源”下，并且不会自动加载图像。

# git - 多用户 Github 拉取请求

> ID：13592653
> 
> 赞同：35
> 
> 时间：2012-11-27T20:40:40.310
> 
> 标签：git, github

是否可以修改其他人已经开始的拉取请求？

假设我维护项目 X，并且用户 A 向我发送了拉取请求。有些事情我想在合并之前进行更改，并且可以自己快速完成。我怎样才能简单地做到这一点并将其全部保存在一个 PR 中？

这甚至可能吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-11-28T10:58:49.587

你可以这样做：

在你的回购中，

```
git checkout -b new-branch 
```

然后将用户 A 的提交拉入您的新分支：

```
git pull git://github.com/[User A]/[project-name].git 
```

之后，您可以在新分支中随意更改它。当您测试并满足您的更改时，您可以将其合并到您的主分支中：

```
git checkout master
git merge new-branch 
```

好的，现在您有了用户 A 的代码和您的更改。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2016-10-10T17:19:31.563

我意识到这是一个老问题，但 GitHub 最近引入了一些新功能，可以实际更新另一个用户提交的拉取请求。

当您创建新的拉取请求时，您会看到一个标有“**允许维护者编辑**”的复选框。这是默认启用的。

*有了这个，任何对作为拉取请求目标*的存储库具有提交访问权限的人也将能够将更改推送到作为拉取请求来源的存储库*分支。*

这在团队环境中尤其有用，在这种环境中，每个人都可以提交对“主”存储库的访问权限，但所有工作都在各个分支中的功能分支上完成。这意味着如果有一个开放的 PR 需要一些更改并且主要作者不可用，团队中的其他人可以直接进行必要的更新，而不是关闭现有 PR 并打开一个新 PR。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-27T21:04:02.120

假设您对用户的 github 存储库具有**读写**访问权限，您可以推送到拉取请求来自的分支。

它位于合并拉取请求按钮之前的拉取请求底部。

> 您可以通过推送到 yyyy/zzzzz 上的 XXXXX 分支向此拉取请求添加更多提交

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-08-14T14:36:41.093

不幸的是，不，以下不起作用：

`git push -f upstream my-updates:refs/pull/999/head ... ! [remote rejected] my-updates -> refs/pull/999/head (deny updating a hidden ref) error: failed to push some refs ...`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-06-03T19:26:55.660

不可能，但是您可以向他们的分支提交第二个拉取请求，如果他们决定合并它，它将更新原始拉取请求。

* * *

## 回答 #6

> 赞同：-3
> 
> 时间：2012-11-27T20:45:09.513

有可能的！您所要做的就是检查他们拉取请求中的分支并进行所需的更改。在您提交并推送这些更改后，它们应该会反映在 Github 的拉取请求中。

# wordpress - 注册后自动登录 - Wordpress

> ID：13592654
> 
> 赞同：1
> 
> 时间：2012-11-27T20:40:41.507
> 
> 标签：wordpress, function, login, registration, frontend

我正在一个网站上工作，我有一个前端注册表单，它可以正常工作，但现在我在自动登录和成功注册后重定向时遇到了困难。我在我的主题函数文件中尝试了一些插件和代码，但似乎都没有。那么如何在注册成功后自动登录呢？任何帮助将不胜感激。

```
<?php
if(get_option('users_can_register')) {
//Check whether user registration is enabled by the administrator
?>

<?php

if($_POST){
    //We shall SQL escape all inputs
    $username = $wpdb->escape($_REQUEST['username']);
    if(empty($username)) {
        echo "<span style='color:#FF0000'><strong>Error..</strong></span><br /><br />You have to fill in the username.";
        exit();
    }
    $email = $wpdb->escape($_REQUEST['email']);
    if(!preg_match("/^[_a-z0-9-]+(\.[_a-z0-9-]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]{2,4})$/", $email)) {
        echo "<span style='color:#FF0000'><strong>Error..</strong></span><br /><br />please use a calid e-mailadress.";
        exit();
    }

    $pass1 = $wpdb->escape($_REQUEST['pass1']);
$pass2 = $wpdb->escape($_REQUEST['pass2']);
if ($pass1 != $pass2){
    echo "<span style='color:#FF0000'><strong>Error..</strong></span><br /><br />please use a passwords don't match.";
        exit();

}
$random_password = $pass1;
    $status = wp_create_user( $username, $random_password, $email );
    if ( is_wp_error($status) )
        echo "<span style='color:#FF0000'><strong>Feil..</strong></span><br /><br />Username allready exist. please try another one.";
    else {
        $from = get_option('admin_email');
        $headers = 'From: '.$from . "\r\n";
        $subject = "Registration ok!";
        $msg = "Welcome, you are now registered. Here is your username and password.\Info:\Username: $username\Password: $random_password";
        wp_mail( $email, $subject, $msg, $headers );
        echo "<strong>You are now registered. An e-mail is now sent to you with your username and password..";
    }

    exit();

}
 else
{
//Embed the register form and javascript here

?>

<div id="result"></div>
<div style="padding-top:5px;"><h2 style="font-size:16px;color:#06f;">Register</h2></div>

<form id="wp_signup_form" action="" method="post">
<p><label>Username<br />
<input type="text" name="username" style="width:250px; margin-bottom:3px;"></label></p>
<p><label>E-Mail<br />
<input type="text" name="email" style="width:250px; margin-bottom:3px;"></label></p>
<p><label>Password<br />
<input type="password" name="pass1" style="width:250px; margin-bottom:3px;"></label></p>
<p><label>Repeat Password<br />
<input type="password" name="pass2" style="width:250px; margin-bottom:3px;"></label></p>
<br />
<input type=checkbox name="termsnp">By registering I agree to the terms and policy<br /><br />
<input type="submit" id="submitbtn" name="submit" value="Register" class="knapp" style="padding:8px;">
</form>
<script type="text/javascript">                         
$("#submitbtn").click(function() {
$('#result').html('<img src="<?php bloginfo('template_url'); ?>/images/loader.gif" class="loader" />').fadeIn();
var input_data = $('#wp_signup_form').serialize();
$.ajax({
type: "POST",
url:  "<?php echo "http://" . $_SERVER['HTTP_HOST'] . $_SERVER['REQUEST_URI']; ?>",
data: input_data,
success: function(msg){
$('.loader').remove();
$('
<div>').html(msg).appendTo('div#result').hide().fadeIn('slow');
}
});
return false;

});
</script>
<?php
// embedded

}
?>

<?php
    }
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2017-02-12T10:01:15.770

注册后自动登录使用此代码

```
 $userdata = array(
        'user_login' => esc_attr($username),
        'user_email' => esc_attr($email),
        'user_pass' => esc_attr($password),
        'first_name' => esc_attr($first_name),
        'last_name' => esc_attr($last_name),
        'display_name' => esc_attr($first_name.' '.$last_name),
    );
    $register_user = wp_insert_user($userdata);
    if (!is_wp_error($register_user)) {
        wp_set_current_user( $register_user, $username );
        wp_set_auth_cookie( $register_user );
        do_action( 'wp_login', $username );
    } else{
         echo $register_user->get_error_message();
    } 
```

和重定向使用这个

```
wp_redirect( site_url('my-account') ); exit; 
```

用您成功的网址替换 site_url('my-account')

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T07:17:29.087

我没有找到要使用的更正编码，所以我最终做的是使用插件 Formidable Pro 创建一个注册表单，该注册表单在成功注册后登录并重定向。- [http://formidablepro.com/](http://formidablepro.com/)

# javascript - 在 MongoDB 中检索 n 级深度子文档

> ID：13592656
> 
> 赞同：13
> 
> 时间：2012-11-27T20:40:44.590
> 
> 标签：javascript, mongodb

我在 mongoDB 中有一个深度嵌套的文档，我想获取单个子对象。

例子：

```
{
   "schoolName": "Cool School",
   "principal": "Joe Banks",
   "rooms": [
      {
         "number": 100
         "teacher": "Alvin Melvin"
         "students": [
            {
               "name": "Bort"
               "currentGrade": "A"
            },
            // ... many more students
         ]
      },
      // ... many more rooms
   ]
} 
```

[最近 Mongo 更新为允许使用$elemMatch 投影](http://docs.mongodb.org/manual/reference/projection/elemMatch/)进行 1 级深度子对象检索：

```
var projection = { _id: 0, rooms: { $elemMatch: { number: 100 } } };
db.schools.find({"schoolName": "Cool School"}, projection);
// returns { "rooms": [ /* array containing only the matching room */ ]  } 
```

但是当我尝试以同样的方式获取一个学生（2 级深）时，我得到一个错误：

```
var projection = { _id: 0, "rooms.students": { $elemMatch: { name: "Bort" } } };
db.schools.find({"schoolName": "Cool School"}, projection);
// "$err": "Cannot use $elemMatch projection on a nested field (currently unsupported).", "code": 16344 
```

**有没有办法在 mongoDB 文档中检索任意深度的子对象？**

我正在使用 Mongo 2.2.1

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-11-02T20:42:41.257

我最近问了一个类似的问题，并且可以提供一个适当的通用答案（请参阅[Using MongoDB's positional operator $ in a deep nested document query](https://stackoverflow.com/questions/26676481/using-mongodbs-positional-operator-in-a-deeply-nested-document-query)）

此解决方案仅支持 Mongo 2.6+，但从那时起您可以使用聚合框架的 $redact 函数。

这是一个示例查询，它应该只返回您的学生 Bort。

```
db.users.aggregate({

    $match: { schoolName: 'Cool School' }

}, {

    $project: {

        _id: 0,
        'schoolName': 1,
        'rooms.number': 1,
        'rooms.students': 1

    }

}, {

    $redact: {
        $cond: {
            "if": {
                $or: [{
                    $gte: ['$schoolName', '']
                }, {
                    $eq: ['$number', 100]
                }]
            },
            "then": "$$DESCEND",
            "else": {
                $cond: {
                    "if": {
                        $eq: ['$name', 'Bort']
                    },
                    "then": "$$KEEP",
                    "else": "$$PRUNE"
                }
            }
        }
    }

}); 
```

$redact 可用于通过在匹配的文档中递归地匹配或修剪子文档来进行子查询。

[您可以在此处阅读 $redact](http://docs.mongodb.org/manual/reference/operator/aggregation/redact/)以了解更多关于正在发生的事情，但我确定的设计模式具有以下要求：

*   编校条件适用于**每个**子文档级别，因此您需要在每个级别都有一个唯一字段，例如，您不能将数字作为两个房间的键，学生说
*   它仅适用于数据字段而不是数组索引，因此如果您想知道嵌套文档的返回位置（[例如更新它](https://stackoverflow.com/questions/18173482/mongodb-update-deeply-nested-subdocument)），您需要将其包含在文档中并将其维护
*   **$redact 中的$or**语句的每个部分都应与您想要的特定级别的文档相匹配
*   **因此， $or**语句的每个部分都需要包含与该级别文档的唯一字段的匹配项。例如，`$eq: ['$number', 100]`匹配编号为 100 的房间
*   如果您没有在某个级别指定查询，则仍需要包含唯一字段。例如，如果它是一个字符串，您可以将其与`$gte: ['$uniqueField': '']`
*   最后一个文档级别进入**第二个**if 表达式，以便保留所有该文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T21:00:34.227

我现在手边没有 mongodb 2.2，所以我无法测试这个，但是你试过了吗？

```
var projection = { _id: 0, rooms: { $elemMatch: { "students.name": "Bort" } } };
db.schools.find({"schoolName": "Cool School"}, projection); 
```

# python - 字符串比较翻译程序

> ID：13592657
> 
> 赞同：0
> 
> 时间：2012-11-27T20:40:50.210
> 
> 标签：python, string

这是我在上一个问题中提到的与我的程序有关的另一个问题。我正在制作的程序是一个程序，它会以一种语言显示一个单词并要求翻译成另一种语言。然后它会显示它是对还是错。但是，当我测试它是否有效时，它会显示所有版本的不正确，即使答案是正确的。如何让它只显示适当的消息？例如，如果正确的说（'Correct！'），如果有错误的说（'不正确。正确的答案是*_* '）

这就是我所拥有的：

```
if words == 'ano' and translation == 'um':
            print('Correct!')
        else:
            print('Incorrect.')
            print('The correct answer is: um.')

        if words == 'ima' and translation == 'now':
            print('Correct!')
        else:
            print('Incorrect.')
            print('The correct answer is: now.')

        if words == 'eego' and translation == 'english':
            print('Correct!')
        else:
            print('Incorrect.')
            print('The correct answer is: english.')

        if words == 'hai' and translation == 'yes':
            print('Correct!')
        else:
            print('Incorrect.')
            print('The correct answer is: yes.')

        if words == 'gakusei' and translation == 'student':
            print('Correct!')
        else:
            print('Incorrect.')
            print('The correct answer is: student.')

        if words == '...go' and translation == 'language':
            print('Correct!')
        else:
            print('Incorrect.')
            print('The correct answer is: language.')

        if words == 'kookoo' and translation == 'high school':
            print('Correct!')
        else:
            print('Incorrect.')
            print('The correct answer is: high school.')

        if words == 'gogo' and translation == 'pm':
            print('Correct!')
        else:
            print('Incorrect.')
            print('The correct answer is: pm.')

        if words == 'gozen' and translation == 'am':
            print('Correct!')
        else:
            print('Incorrect.')
            print('The correct answer is: am.')

        if words == '...sai' and translation == 'years old':
            print('Correct!')
        else:
            print('Incorrect.')
            print('The correct answer is: years old.')

        if words == '...san' and translation == 'mr/ms':
            print('Correct!')
        else:
            print('Incorrect.')
            print('The correct answer is: mr/ms.')

        if words == 'ji' and translation == "o'clock":
            print('Correct!')
        else:
            print('Incorrect.')
            print("The correct answer is: o'clock.")

        if words == 'jin' and translation == 'people':
            print('Correct.!')
        else:
            print('Incorrect.')
            print('The correct answer is: people.')

        if words == 'senkoo' and translation == 'major':
            print('Correct!')
        else:
            print('Incorrect.')
            print('The correct answer is: major.')

        if words == 'sensei' and translation == 'teacher':
            print('Correct!')
        else:
            print('Incorrect.')
            print('The correct answer is: teacher.')

        if words == 'soo desu' and translation == "that's right":
            print('Correct!')
        else:
            print('Incorrect.')
            print("The correct answer is: that's right.")

        if words == 'daigaku' and translation == 'college/university':
            print('Correct!')
        else:
            print('Incorrect.')
            print('The correct answer is: college/university.')

        if words == 'denwa' and translation == 'telephone':
            print('Correct!')
        else:
            print('Incorrect.')
            print('The correct answer is: telephone.')

        if words == 'tomodachi' and translation == 'friend':
            print('Correct.!')
        else:
            print('Incorrect.')
            print('The correct answer is: friend.')

        if words == 'namae' and translation == 'name':
            print('Correct!')
        else:
            print('Incorrect.')
            print('The correct answer is: name.')

        if words == 'nan/nani' and translation == 'what':
            print('Correct!')
        else:
            print('Incorrect.')
            print('The correct answer is: what.')

        if words == 'nihon' and translation == 'japan':
            print('Correct!')
        else:
            print('Incorrect.')
            print('The correct answer is: japan.')

        if words == '...nensei' and translation == 'year student':
            print('Correct!')
        else:
            print('Incorrect.')
            print('The correct answer is: year student.')

        if words == 'han' and translation == 'half':
            print('Correct!')
        else:
            print('Incorrect.')
            print('The correct answer is: half.')

        if words == 'bangoo' and translation == 'number':
            print('Correct!')
        else:
            print('Incorrect.')
            print('The correct answer is: number.')

        if words == 'ryuugakusei' and translation == 'international student':
            print('Ccorect!')
        else:
            print('Incorrect.')
            print('The correct answer is: international student.')

        if words == 'watashi' and translation == 'I':
            print('Correct!')
        else:
            print('Incorrect.')
            print('The correct answer is: I.')

        if words == 'amerika' and translation == 'america':
            print('Correct!')
        else:
            print('Incorrect.')
            print('The correct answer is: america.')

        if words == 'igirisu' and translation == 'britain':
            print('Correct!')
        else:
            print('Incorrect.')
            print('The correct answer is: britain.')

        if words == 'oosutoraria' and translation == 'australia':
            print('Correct!')
        else:
            print('Incorrect.')
            print('The correct answer is: australia.')

        if words == 'kankoku' and translation == 'korea':
            print('Correct!')
        else:
            print('Incorrect.')
            print('The correct answer is: korea.')

        if words == 'suweeden' and translation == 'sweeden':
            print('Correct!')
        else:
            print('Incorrect.')
            print('The correct answer is: sweeden.')

        if words == 'chuugoku' and translation == 'china':
            print('Correct!')
        else:
            print('Incorrect.')
            print('The correct answer is: china.')

        if words == 'kagaku' and translation == 'science':
            print('Correct!')
        else:
            print('Incorrect.')
            print('The correct answer is: science.')

        if words == 'ajia kenkyuu' and translation == 'asian studies':
            print('Correct!')
        else:
            print('Incorrect.')
            print('The correct answer is: asian studies.')

        if words == 'keizai' and translation == 'economics':
            print('Correct!')
        else:
            print('Incorrect.')
            print('The correct answer is: economics.')

        if words == 'kokusaikankei' and translation == 'international relations':
            print('Correct!')
        else:
            print('Incorrect.')
            print('The correct answer is: international relations.')

        if words == 'konpyuutaa' and translation == 'computer':
            print('Correct!')
        else:
            print('Incorrect.')
            print('The correct answer is: computer.')

        if words == 'jinruigaku' and translation == 'anthropology':
            print('Correct!')
        else:
            print('Incorrect.')
            print('The correct answer is: anthropology.')

        if words == 'seeji' and translation == 'politics':
            print('Correct!')
        else:
            print('Incorrect.')
            print('The correct answer is: politics.')        

        if words == 'bijinesu' and translation == 'business':
            print('Correct!')
        else:
            print('Incorrect.')
            print('The correct answer is: business.')

        if words == 'bungaku' and translation == 'literature':
            print('Correct!')
        else:
            print('Incorrect.')
            print('The correct answer is: literature.')

        if words == 'rekishi' and translation == 'history':
            print('Correct!')
        else:
            print('Incorrect.')
            print('The correct answer is: history.')

        if words == 'shigoto' and translation == 'job' or translation == 'work' or translation == 'occupation':
            print('Correct!')
        else:
            print('Incorrect.')
            print('The correct answer is: "job" or "work" or "occupation".')

        if words == 'isha' and translation == 'doctor':
            print('Correct!')
        else:
            print('Incorrect.')
            print('The correct answer is: doctor.')

        if words == 'kaishain' and translation == 'office worker':
            print('Correct!')
        else:
            print('Incorrect.')
            print('The correct answer is: office worker.')

        if words == 'kookoosei' and translation == 'high school student' or translation == 'highschool student':
            print('Correct!')
        else:
            print('Incorrect.')
            print('The correct answer is: "high school student" or "highschool student".')

        if words == 'shufu' and translation == 'house wife':
            print('Correct!')
        else:
            print('Incorrect.')
            print('The correct answer is: house wife.')

        if words == 'daigakuinsei' and translation == 'graduate student':
            print('Correct!')
        else:
            print('Incorrect.')
            print('The correct answer is: graduate student.')

        if words == 'daigakusei' and translation == 'college student':
            print('Correct!')
        else:
            print('Incorrect.')
            print('The correct answer is: college student.')

        if words == 'bengoshi' and translation == 'lawyer':
            print('Correct!')
        else:
            print('Incorrect.')
            print('The correct answer is: lawyer.')

        if words == 'okaasan' and translation == 'mother' or translation == 'mom':
            print('Correct!')
        else:
            print('Incorrect.')
            print('The correct answer is: "mother or "mom".')

        if words == 'otoosan' and translation == 'father' or translation == 'dad':
            print('Correct!')
        else:
            print('Incorrect.')
            print('The correct answer is: "father or "dad".')

        if words == 'oneesan' and translation == 'older sister' or translation == 'big sister':
            print('Correct!')
        else:
            print('Incorrect.')
            print('The correct answer is: "older sister" or "big sister".')

        if words == 'oniisan' and translation == 'older brotehr' or translation == 'big brother':
            print('Correct!')
        else:
            print('Incorrect.')
            print('The correct answer is: "older brother" or "big brother".')

        if words == 'imooto' and translation == 'younger sister' or translation == 'little sister':
            print('Correct!')
        else:
            print('Incorrect.')
            print('The correct answer is: "younger sister" or "little sister".')

        if words == 'otooto' and translation == 'younger brother' or translation == 'little brother':
            print('Correct!')
        else:
            print('Incorrect.')
            print('The correct answer is: "younger brother" or "little brother".') 
```

* * *

编辑：这是上述代码之前的代码。不确定它是否会有所帮助。

```
words = ['ano', 'ima', 'eego', 'hai', 'gakusei', '...go', 'kookoo', 'gogo', 'gozen', '...sai', '...san', '...ji', '...jin', 'senkoo', 'sensei', 'soo desu', 'daigaku', 'denwa', 'tomodachi', 'namae', 'nan/nani', 'nihon', '...nensei', 'han', 'bangoo', 'ryuugakusei', 'watashi', 'amerika', 'igirisu', 'oosutoraria', 'kankoku', 'suweeden', 'chuugoku', 'kagaku', 'ajia kenkyuu', 'keizai', 'kokusaikankei', 'konpyuutaa', 'jinruigaku', 'seeji', 'bijinesu', 'bungaku', 'rekishi', 'shigoto', 'isha', 'kaishain', 'kookoosei', 'shufu', 'daigakuinsei', 'bengoshi', 'okaasan', 'otoosan', 'oneesan', 'oniisan', 'imooto', 'otooto']
    random.shuffle(words)

    index = 0
    while index < len(words):
        print(words[index])
        translation = input('Enter the translation: ')
        index += 1
        print() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T20:55:48.510

下面的代码不是更容易维护吗？

```
the_words = {'gakusei':'student',
             'hai':'yes',
             '...go':'language',
             'kookoo':'high school',
            }

the_word = 'GAKUSEI'
translation = 'Student'

the_word_lcase = the_word.lower()
if not the_word_lcase in the_words:
    print 'Unknown word: %s' % the_word
elif the_words[the_word_lcase] == translation.lower():
    print 'Correct!'
else:
    print 'The correct answer is: %s' % the_words[the_word_lcase]; 
```

在测试之前，我对其进行了编辑以使单词小写。只要您的主列表（the_words 字典）全部为小写，代码现在将忽略大小写。这当然取决于您希望验证的严格程度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T20:55:37.370

这是很多重复的代码。以下是一个框架，您可以基于该框架使用 a`dict`来存储翻译（因此它们保存在一个地方而不是`if`语句中），并且可以说不正确/正确的翻译是什么，以及当一个词不被认可。

```
translations = {
    'ano': 'um',
    'ima': 'now',
    'eego': 'english'
}

some_word = 'ano'

try:
    translated = translations[some_word]
    if translation == translated:
        print('Correct!')
    else:
        print('Ooops, that should be:', translated)
except KeyError as e:
    print("Sorry, I don't know", some_word) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T20:47:39.143

Nest your comparisons.

```
 if words == 'ima':
      if translation == 'now':
        print('Correct!')
      else:
        print('Incorrect.')
        print('The correct answer is: now.') 
```

# javascript - 提高 JQuery 查找的性能

> ID：13592664
> 
> 赞同：3
> 
> 时间：2012-11-27T20:41:15.797
> 
> 标签：javascript, jquery

我已经改编了教程中的以下代码，以根据内容过滤 li 元素：

```
$('#_selectSearch_' + index).keyup(function() {
       var filter = $(this).val();
       if(filter) {
          $('#_selectDrop_' + index).find("li:not(:contains(" + filter + "))").slideUp();
          $('#_selectDrop_' + index).find("li:contains(" + filter + ")").slideDown();
       } else {
          $('#_selectDrop_' + index).find("li").slideDown();
       }
    }); 
```

该代码工作得很好，但是在处理大型列表时非常慢，每次按键都会使浏览器停止几秒钟。我一直在环顾四周，得出的结论是，改进这一点的方法是以某种方式缓存列表而不是直接在 DOM 上操作，但不知道如何实现这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T21:41:20.880

If your main concern is performance the following code:

> 1.  caches element containing filter string.
> 2.  caches li elements.
> 3.  doesn't show or hide elements that are already in that state.
> 4.  uses indexOf which is very fast.
> 5.  if the user types letters under 500 milliseconds apart the showMatches will not run.

```
var selectSearch = $("#_selectSearch_" + index );
var li = $("#_selectDrop_" + index + " li");
var currentTimeout;

selectSearch.on( "keyup", function( ) {
    if( currentTimeout ) { window.clearTimeout( currentTimeout ) };
    currentTimeout = setTimeout( showMatches, 500 );

});

function showMatches( ) {
    var txt = selectSearch.val();

    for( var i = 0, len = li.length; i < len; i++ ) {

        var content = li[i].textContent ? li[i].textContent : li[i].innerText;

        if( txt && content.indexOf( txt ) > -1) {
            if( li[i].style.display !== "block" ) {
                li[i].style.display = "block";
            }
        } else {
            if( li[i].style.display !== "none" ) {
                li[i].style.display = "none";
            }
        }
    }
} 
```

Fiddle with 400 li elements [**here**](http://jsfiddle.net/GahDd/4/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T20:49:50.553

你可以缓存这个元素`$('#_selectDrop_' + index + ' li');`

```
$('#_selectSearch_' + index).keyup(function() {
    var $li = $('#_selectDrop_' + index + ' li');
    var filter = $(this).val();
    if (filter) {
        $li.not(":contains(" + filter + ")").slideUp();
        $li.contains(filter).slideDown();
    } else {
        $li.slideDown();
    }
});​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T21:25:28.670

我将尝试使用稍微修改（且未经测试）的版本：

```
$('#_selectSearch_' + index).on('keyup', function() {
    var filter = this.value,
        lis = document.getElementById('_selectDrop_' + index).getElementsByTagName('li'),
        len = lis.length,
        sup = 'textContent' in this;
    if (filter.length) {
        for (var i = len; i--) {
            var text = sup ? lis[i].textContent : lis[i].innerText;
            $(lis[i])[text.indexOf(filter) != -1 ? 'slideDown' : 'slideUp']();
        }
    } else {
        $(lis).slideDown();
    }
});​ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-27T20:45:53.450

```
$('#_selectSearch_' + index).keyup(function() {

   var filter = $(this).val();

   // by combining and cacheing all the way to the li
   // we save a lot of time, since it seems that's where you are doing
   // all your searching from

   var selectDrop = $('#_selectDrop_' + index + ' li');

   if (filter) {
      selectDrop.not(':contains("' + filter + '")').slideUp();
      selectDrop.contains(filter).slideDown();
   } 
   else {
      selectDrop.slideDown();
   }
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-27T20:45:18.833

```
drop = $('#_selectDrop_' + index + ' li');
$('#_selectSearch_' + index).keyup(function() {
   var filter = $(this).val();
   if(filter) {
      drop.find(":not(:contains(" + filter + "))").slideUp();
      drop.find(":contains(" + filter + ")").slideDown();
   } else {
      drop.slideDown();
   }
}); 
```

Drop 只会被缓存一次，然后在每次 keyup 时使用。这也使用了尽可能少的`find`

# binding - 淘汰“检查”绑定不起作用

> ID：13592669
> 
> 赞同：1
> 
> 时间：2012-11-27T20:41:42.147
> 
> 标签：binding, checkbox, knockout.js

我是淘汰赛的新手，我发现了一个复选框绑定示例，这在我的网站中可能非常有用。示例链接：http: [//knockoutjs.com/documentation/checked-binding.html](http://knockoutjs.com/documentation/checked-binding.html)

我试图将它应用到我的页面但它不起作用，然后我尝试复制这个示例而不进行任何更改，但它仍然不起作用。我在不同的浏览器（Chrome、Firefox、IE）上尝试过，包括不同版本的淘汰库，但仍然没有用。我不知道我做错了什么，请帮忙！

下面是这个例子的代码：

```
<!DOCTYPE html>
<head>
<script type='text/javascript' src='http://ajax.aspnetcdn.com/ajax/knockout/knockout-2.1.0.js'></script>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Dokument bez tytułu</title>
</head>

<body>
<p>Send me spam: <input type="checkbox" data-bind="checked: wantsSpam" /></p>
<div data-bind="visible: wantsSpam">
Preferred flavors of spam:
<div><input type="checkbox" value="cherry" data-bind="checked: spamFlavors" /> Cherry</div>
<div><input type="checkbox" value="almond" data-bind="checked: spamFlavors" /> Almond</div>
<div><input type="checkbox" value="msg" data-bind="checked: spamFlavors" /> Monosodium Glutamate</div>
</div>

<script type="text/javascript">
var viewModel = {
    wantsSpam: ko.observable(true),
    spamFlavors: ko.observableArray(["cherry","almond"]) // Initially checks the Cherry and Almond checkboxes
};

// ... then later ...
viewModel.spamFlavors.push("msg"); // Now additionally checks the Monosodium Glutamate  checkbox
</script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T20:52:43.357

您正在查看的是一个片段，而不是一个完整的示例。你需要做几件事。

你需要`applyBindings`：

```
ko.applyBindings(viewModel); 
```

并且您需要在 DOM 加载后执行此操作（否则淘汰赛会变得非常不安）。

这是一个[例子](http://jsfiddle.net/Gdz7H/2/)

我已经稍微更新了我的示例，以便更容易看到复选框实际上是绑定的。复选框列表下有一个 spamFlavors 列表，当您选中和取消选中复选框时会发生变化。

# iphone - 在新的开始屏幕后启动应用程序时出错

> ID：13592671
> 
> 赞同：1
> 
> 时间：2012-11-27T20:41:56.933
> 
> 标签：iphone, ios

我在我的应用程序中添加了一个新的开始屏幕，但它不再工作了。它添加了标题、.m 和 .xib 文件。

首先，错误：

由于未捕获的异常“NSInvalidArgumentException”而终止应用程序，原因：“ *** -[__NSPlaceholderArray initWithObjects:count:]：尝试从对象 [0] 插入 nil 对象”

这是控制器（我没有改变任何东西）：

```
#import "StartViewController.h"

@interface StartViewController ()

@end

@implementation StartViewController

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
    // Custom initialization
    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view from its nib.
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.

}

@end 
```

这是 AppDelegate 中的启动代码：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
    // Override point for customization after application launch.
    if ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPhone) {
        self.viewController = [[StartViewController alloc] initWithNibName:@"StartViewController" bundle:nil];
    } else {
        //self.viewController = [[ViewController alloc] initWithNibName:@"ViewController_iPad" bundle:nil];
    }
    self.window.rootViewController = self.viewController;

    UINavigationController *navController = [[UINavigationController alloc] initWithRootViewController:self.viewController];
    self.window.rootViewController = navController;

    [self.window makeKeyAndVisible];
    //    [self.window addSubview:navController.view];

    return YES;
} 
```

.xib 称为 StartViewController.xib，只有几个标签和按钮。还没有任何联系。我尝试删除所有内容，但发生了同样的错误。

我进入了调试器，它进入了新控制器的构造函数，以及 viewdidload 方法。异常`[self.window makeKeyAndVisible];`在委托中的行引发。

如果我只是更改将新控制器连接到旧控制器的线路，`self.viewController = [[ViewController alloc] initWithNibName:@"ViewController_iPhone" bundle:nil];`则应用程序将再次运行。

它是什么？它一定是非常基本的东西，但我找不到。

# asp.net - 防止以编程方式访问动态数据表

> ID：13592688
> 
> 赞同：1
> 
> 时间：2012-11-27T20:43:23.197
> 
> 标签：asp.net, database, entity-framework, dynamic-data

我有一个使用动态数据设置的许多数据库的管理部分。当用户登录时，他们会看到一个他们有权修改的数据库列表（这个列表保存在一个单独的数据库中，该数据库与用户的登录信息相关联，并且还列出了他们可以查看的表）。单击数据库后，表格列表随即显示在动态数据站点的同一 default.aspx 页面上的第二个网格视图中。

我找到了一种方法来将显示的表限制为与允许表的数据库条目相对应的表，但是，在查看表条目时，与他们无权访问的表的任何外键关联都显示为动态数据超链接直接带你去那些桌子。

Soooo，如果你还在我身边，谢谢你。 ~~我的想法是在绑定元模型的 global.asax 文件中进行检查，而不是为应该无法访问的表搭建脚手架。这可以通过编程方式完成吗？我会发布一些代码，但我不确定需要什么。这是我认为可以进行编辑的地方：~~

```
foreach (var table in metaModel.Value.Tables)
                    {
                        var tablePermission = authorizedTables.Any(p => p == table.Name);
                        if (tablePermission) continue;

                        //Next lines are possible ways in?
                        var canThisBeSetSomehow = table.Attributes.OfType<ScaffoldTableAttribute>().FirstOrDefault();
                        table.Scaffold = false;
                    } 
```

假设“authorizedTables”是一个字符串[]，在上面的场景中保存了我的表名。有没有办法获取元模型并对其进行编辑，以便每个用户都无法访问剩余的表？

# .net - PrincipalSearcher.FindByIdentitiy() 内存泄漏

> ID：13592689
> 
> 赞同：0
> 
> 时间：2012-11-27T20:43:32.600
> 
> 标签：.net, directoryservices

在[MSDN 条目](http://msdn.microsoft.com/en-us/library/bb345628%28v=vs.90%29.aspx)中`PrincipalSearcher.FindByIdentitiy()`，Gary Caldwell 指出（在社区内容的底部）使用此方法会导致内存泄漏，因为“底层实现使用`DirectorySearcher`但`SearchResultsCollection`不调用 dispose，`SearchResultsCollection`如文档所述。” `Dispose()`此泄漏显然还导致在使用`PrincipalSearcher.FindAll()`或`PrincipalSearcher.FindOne()`作为解决方法时需要调用显式。

此条目是针对 .NET 3.5 制作的，但未列出针对 .NET 4.0 及更高版本的问题。谁能确认此问题是否已解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T21:16:14.047

快速浏览一下 Reflector 表明它已被修复 `System.DirectoryServices.AccountManagement.ADStoreCtx` `FindPrincipalByIdentRefHelper`：

```
DirectorySearcher searcher = new DirectorySearcher(this.ctxBase);
SearchResultCollection results = null;
try
{
   ...
}
catch (COMException exception)
{
    throw ExceptionHelper.GetExceptionFromCOMException(exception);
}
finally
{
    searcher.Dispose();
    if (results != null)
    {
        results.Dispose();
    }
} 
```

# grails - 如何获取 Grails 应用程序的绝对路径

> ID：13592691
> 
> 赞同：0
> 
> 时间：2012-11-27T20:43:37.703
> 
> 标签：grails

在我的应用程序中，如果客户端被授权，登录控制器应该返回重定向 URL：

```
<path to grails app> + <another controller, method, params> 
```

如何获取应用程序 URL？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T21:14:07.213

您应该能够使用 grails 标记[作为方法调用](http://grails.org/doc/latest/guide/theWebLayer.html#tagsAsMethodCalls)来构建 URL 。 [createLink](http://grails.org/doc/latest/ref/Tags/createLink.html)可能是您想要的。这具有`action`、`controller`和作为获取控制器操作的完整 URL 的选项（您可能需要按照文档中的说明配置基本 URL）`params`。`absolute`在第一个链接的示例中，类似这样的内容将获取该资源的绝对 URL：

```
g.createLink(action:"myact", controller:"somecontroller", params:[foo:'bar', boo:'far'], absolute:true) 
```

# xml - 在 XML 中分离 zip 任务

> ID：13592695
> 
> 赞同：1
> 
> 时间：2012-11-27T20:43:59.373
> 
> 标签：xml, vb.net, zip

所以我有一个看起来像这样的 XML...

```
<?xml version="1.0" encoding="UTF-8"?>

<!--XML Backup.-->
-<Jobs> 
-<Job> 
 <JobName>a</JobName>
   <Source>C:\Users\Public\Pictures\Samplepictures\Lighthouse.jpg</Source> 
    <Source>C:\Users\Public\Pictures\Sample Pictures\Penguins.jpg</Source>  
    <Source>C:\Users\Public\Pictures\Sample Pictures\Tulips.jpg</Source>  
    <Destination>C:\Users\Public\Pictures\Sample Pictures\a.zip</Destination>
   <Timestamp>11/26/2012 6:18:00 PM</Timestamp> 
 </Job> 
-<Job> 
<JobName>b</JobName> 
  <Source>C:\Users\Public\Pictures\demo photo\1 - Copy.JPG</Source>    
  <Source>C:\Users\Public\Pictures\demo photo\1.JPG</Source> 
  <Source>C:\Users\Public\Pictures\demo photo\2 - Copy.JPG</Source> 
  <Destination>C:\Users\Public\Pictures\demo photo\b.zip</Destination> 
  <Timestamp>11/26/2012 6:18:19 PM</Timestamp> 
 </Job> 
</Jobs> 
```

我希望每个标有“工作”的父节点都被压缩。因此，第一个 zip 将是“a.zip”，其中包含“tulips.jpg”、“lighthouse.jpg”和“penguins.jpg” - 位于目的地。

第二个 zip 将是带有相应文件的“b.zip”。

现在，我在正确的目的地得到“a.zip”和“b.zip”——但每个 zip 都包含所有文件。

我现在的代码如下。

```
 Dim JobNodes As XmlNodeList
    Dim JobNode As XmlNode
    Dim baseDataNodes As XmlNodeList
    Dim bFirstInRow As Boolean

    JobNodes = doc.GetElementsByTagName("Job")
    For Each jobNode In JobNodes
        baseDataNodes = JobNode.ChildNodes
        bFirstInRow = True

        For Each baseDataNode As XmlNode In baseDataNodes

            Dim Source = baseDataNode.SelectNodes("descendant::Source")
            Dim Destin = baseDataNode.SelectNodes("descendant::Destination")
            Using zip As New ZipFile()

                For Each item As System.Xml.XmlElement In Source
                    zip.AddFile(item.InnerText, "Archive_" & DateString)
                Next

                For Each item As System.Xml.XmlElement In Destin
                    zip.Save(item.InnerText)
                Next
            End Using

            Console.Write(vbCrLf)

            Console.Write(baseDataNode.Name & ": " & baseDataNode.InnerText)
        Next

        Console.Write(vbCrLf)
        Console.Write(vbCrLf)
    Next 
```

另外，我很好奇“后代::”是否是必要的……如果是这样，它有什么作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T20:52:00.300

您的 nSource 和 nDestin 变量是文档中所有 Source 和 Destination 标记的列表，而不仅仅是当前 Job。在您的 baseDataNode 循环中，您需要为这些变量分配新值。我不知道您使用的 Api 是否良好，但我会尝试以下方法：

```
For Each baseDataNode As XmlNode In baseDataNodes
  Dim nSource = baseDataNode.SelectNodes("descendant::Source")
  Dim nDestin = baseDataNode.SelectNodes("descendant::Destination")
  ... 
```

* * *

编辑： [XmlNode.SelectNodes](http://msdn.microsoft.com/en-us/library/hcebdtae.aspx)采用[xpath](http://www.w3schools.com/xpath/xpath_intro.asp)字符串，“ [descendant::Source](http://www.w3schools.com/xpath/xpath_axes.asp) ”是一个 xpath 语句，它匹配当前节点的所有后代，即 Source 标记。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T15:01:26.003

对于任何寻找答案的人，请查看我想出的解决方案。

[代码] 子主（）

```
 Dim doc As New System.Xml.XmlDocument
    Dim myJob As New Atr.backup.Job

    doc.Load("C:\users\matt taylor\desktop\backup\backup.xml")
    myLogger = New Logger("C:\users\matt taylor\desktop\backup\" + DateTime.Now.ToString("yyyy-MM-dd") + ".log")

    Console.SetWindowSize(100, 25)

    Dim JobNodes As XmlNodeList = doc.GetElementsByTagName("Job")
    Dim JobNode As XmlNode
    Dim baseDataNodes As XmlNodeList

    For Each JobNode In JobNodes
        baseDataNodes = JobNode.ChildNodes()

        For Each baseDataNode As XmlNode In baseDataNodes

            myJob.jobName = JobNode.SelectSingleNode("JobName").Name
            myJob.jobSource = JobNode.SelectSingleNode("Source").Name
            myJob.jobDestination = JobNode.SelectSingleNode("Destination").Name
            myJob.jobTimeStamp = JobNode.SelectSingleNode("Timestamp").Name

            Dim Source = JobNode.SelectNodes("Source")
            Dim Destin = JobNode.SelectNodes("Destination")

            Using zip As New ZipFile()
                For Each item As System.Xml.XmlNode In Source
                    zip.AddFile(item.InnerText, JobNode.SelectSingleNode("JobName").InnerText & "_Archive_" & DateString)
                Next

                For Each item As System.Xml.XmlNode In Destin
                    zip.Save(item.InnerText)
                Next
            End Using

            Console.Write(vbCrLf)

            Console.Write(baseDataNode.Name & ": " & baseDataNode.InnerText)
            myLogger.Log(baseDataNode.Name & ": " & baseDataNode.InnerText)
        Next

        Console.Write(vbCrLf)
        Console.Write(vbCrLf)
    Next

    Console.Read()
End Sub[/CODE] 
```

然后我为一些例程创建了一个名为 JOB 的公共类。

[CODE]公开课工作

```
 Private name As String
    Private source As String
    Private destination As String
    Private timeStamp As String

    Public Property jobName() As String
        Get
            Return name
        End Get
        Set(value As String)
            name = value
        End Set
    End Property
    Public Property jobSource() As String
        Get
            Return source

        End Get
        Set(value As String)
            source = value
        End Set
    End Property
    Public Property jobDestination() As String
        Get
            Return destination
        End Get
        Set(value As String)
            destination = value
        End Set
    End Property
    Public Property jobTimeStamp() As String
        Get
            Return timeStamp
        End Get
        Set(value As String)
            timeStamp = value
        End Set
    End Property[/CODE] 
```

# ruby - rspec中的整数比较匹配器

> ID：13592697
> 
> 赞同：14
> 
> 时间：2012-11-27T20:44:00.707
> 
> 标签：ruby, rspec

假设`x`应该大于`y`。如何在 rspec 中对其进行编码？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2014-01-31T03:28:52.460

使用 rspec 2.14 和期望语法，可以这样表示：

```
expect(x).to be > y 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-27T20:48:00.640

现在手头没有 RSpec 来验证，但我认为这应该可行：

```
x.should > y 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-28T08:37:14.763

还有另一种匹配不等式的方法：

```
x.should be_greater_than_or_equal_to(y)
x.should be_less_than_or_equal_to(y)
x.should be_greater_than(y)
x.should be_less_than(y) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-27T20:47:50.120

这不适合你吗？

```
x.should be > y 
```

你也可以试试更直观的测试框架[——Specular](https://github.com/slivu/specular#assertions)

那么你就可以：

```
is?(x) > y
expect(x) > y
check(x) > y
etc. 
```

# ssas - 在 MDX 中过滤相对于 CurrentMember 的维度

> ID：13592698
> 
> 赞同：1
> 
> 时间：2012-11-27T20:44:04.857
> 
> 标签：ssas, mdx, olap, ssas-2008

我在完成一些我认为在 MDX 中应该相对简单的事情时遇到了一些麻烦。我想创建一个计算成员，它提供我在过去两周在给定时间点的一项措施的总和。我的时间维度如下：

```
TimeId    TradingDate   Day of Week
-----------------------------------
1000      11/1/2012     Thursday
1001      11/2/2012     Friday
1002      11/5/2012     Monday
1003      11/6/2012     Tuesday
...       ... 
```

让这件事变得特别困难的是，我的时间维度还不够完整。我的时间维度的成员只对应股票市场的交易日，而不是所有时间。这意味着不包括周末、节假日或股市休市的任何其他日子。这也意味着穿越时间的常规方法，例如`LAG`or`PARALLELPERIOD`不会在这里完全起作用。 `LAG(14)`例如，表示“14 个交易日”，在任何给定时间点都可能代表可变长度的实际时间。

在我的计算成员中，我试图使用 FILTER 来仅获取 CurrentMember 前两周内的时间成员。但是，我似乎无法弄清楚完成此操作的正确语法（如果有的话）。我想它会是这样的：

```
WITH MEMBER [Sum of Price Previous 2 Weeks] AS
    SUM(
        FILTER(
            [Time].[TimeId].Children
            , [Time].[TradingDate].MemberValue 
              >= VBA!DATEADD("ww", -2, [Time].[TradingDate].CurrentMember.MemberValue)
        )
        , [Price]
    ) 
```

然而，这并不完全奏效。我似乎无法将计算成员当前迭代的上下文与`FILTER`函数内部的单独上下文分开。换句话说，我不知道该怎么说：

> “在 中迭代集合时`FILTER`，将每次迭代的当前成员与计算成员范围内的 CurrentMember 的值进行比较”

我正在努力实现的目标是可能的吗？我可以采取不同的方法来完成我所追求的目标吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T21:26:53.653

您可以使用设置别名来引用 Filter 上下文中的外部 CurrentMember：

```
WITH MEMBER [Sum of Price Previous 2 Weeks] AS
        SUM(
            GENERATE([Time].[TradingDate].CurrentMember AS CurrentDateAlias,
                     FILTER(
                          [Time].[TimeId].Children
                          , [Time].[TradingDate].MemberValue 
                          >= VBA!DATEADD("ww", -2, CurrentDateAlias.Item(0).MemberValue)
                     )
            )
            , [Price]
        ) 
```

GENERATE 仅用于在某处定义别名。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-04T17:23:54.453

您将从计算成员获得的结果将取决于查询的轴。所以首先，确保你有`[Time].[TradingDate]`你的轴。

其次，您的`[Time].[TradingDate]`层次结构应该按键排序（我假设`TradingDate`是键）。

现在您可以使用此成员定义：

```
WITH MEMBER [Sum of Price Previous 2 Weeks] AS
    SUM(
        [Time].[TradingDate].CurrentMember.Lag(14):[Time].[TradingDate].CurrentMember, [Price]
    ) 
```

# actionscript-3 - 如何对多个 Flash 图层应用动作

> ID：13592705
> 
> 赞同：0
> 
> 时间：2012-11-27T20:44:25.263
> 
> 标签：actionscript-3, flash

我有 5 层，每层都有符号：a、b、c、d 和 e。当您将鼠标悬停在 b 上时，我正在尝试研究如何将以下操作应用于 a、c、d 和 e。

还有其他类似于 'gotoAndStop(0); 的动作吗？' 不是立即转到第 0 帧，而是按原路返回？

链接到 .Fla [http://www.fileden.com/files/2012/11/27/3370853/Untitled-2.fla](http://www.fileden.com/files/2012/11/27/3370853/Untitled-2.fla)

```
stop();

stage.addEventListener(MouseEvent.MOUSE_OVER, playMovie); function playMovie(event) { play(); }
stage.addEventListener(MouseEvent.MOUSE_OUT, stopMovie); function stopMovie(event) { gotoAndStop(0); }

stop(); 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T21:06:53.403

**编辑**

查看您的 .fla 后，以下是缺少/放错位置的内容：

1.  Flash 中的层除了 z 顺序/深度之外没有任何意义。您不能在代码中操作图层。您的所有动画都在同一时间线上，因此它们将始终一起播放。如果您希望单个项目在没有其他项目的情况下进行动画处理，则必须在其自己的时间轴上制作动画（不仅仅是它唯一的图层）。您可以通过双击访问您自己的符号时间线 - 在那里制作您的动画。

2.  要引用舞台上的项目，您需要给它们一个实例名称。您可以通过单击舞台上的项目来执行此操作，然后在属性面板中，您可以在其中输入实例名称的字段。为了使下面的代码正常工作，您需要分别给它们一个实例名称“a”、“b”、“c”、“d”、“e”。这与库中的符号名称不同（尽管它可以是相同的名称）。

* * *

你可以这样做的一种方法：

```
var btns:Vector.<MovieClip> = new Vector.<MovieClip>(); //create an array of all your buttons
btns.push(a,b,c,d,e); //add your buttons to the array

for each(var btn:MovieClip in btns){
    btn.addEventListener(MouseEvent.MOUSE_OVER, btnMouseOver);  // listen for mouse over on each of the buttons
    btn.addEventListener(MouseEvent.MOUSE_OUT, btnMouseOut);
}

function btnMouseOver(e:Event):void {
    for each(var btn:MovieClip in btns){ //loop through all your buttons
        if(btn != e.currentTarget){ //if the current one in the loop isn't the one that was clicked
            btn.play();

            try{
                btn.removeEventListener(Event.ENTER_FRAME,moveBackwards); //this will stop the backwards animation if running.  it's in a try block because it will error if not running
            }catch(err:Error){};
        }
    }
}

function btnMouseOut(e:Event):void {
    for each(var btn:MovieClip in btns){ //loop through all your buttons
        if(btn != e.currentTarget){ //if the current one in the loop isn't the one that was clicked
            goBackwards(btn);
        }
    }
} 
```

没有很好的方法可以向后播放时间线，但是有办法做到这一点。一种这样的方式：

```
//a function you can call and pass in the item/timeline you want played backwards
function goBackwards(item:MovieClip):void {
    item.stop(); //make sure the item isn't playing before starting frame handler below
    item.addEventListener(Event.ENTER_FRAME, moveBackwards); //add a frame handler that will run the moveBackwards function once every frame
}

//this function will move something one frame back everytime it's called
function moveBackwards(e:Event):void {
    var m:MovieClip = e.currentTarget as MovieClip; //get the movie clip that fired the event
    if(m.currentFrame > 1){ //check to see if it's already back to the start
        m.prevFrame();  //if not move it one frame back
    }else{
        m.removeEventListener(Event.ENTER_FRAME,moveBackwards); //if it is (at the start), remove the enter frame listener so this function doesn't run anymore
    }
} 
```

# java - 减小纹理的大小

> ID：13592706
> 
> 赞同：1
> 
> 时间：2012-11-27T20:44:32.703
> 
> 标签：java, andengine

对于我的应用程序，我有一个高分辨率的纹理。为了减小小屏幕的尺寸，我喜欢这样做：

```
@Override
public void onLoadResources(){
    Options options = new BitmapFactory.Options();
    options.inScaled = false;

    // calculation inSampleSize
    int sm = 1;
    if (cameraWidth+cameraHeight < 1280) sm = 2;// < 800x480
    if (cameraWidth+cameraHeight <  800) sm = 4;// < 480x320
    options.inSampleSize = sm;

    mTexture = new BitmapTextureAtlas(2048/sm, 2048/sm, TextureOptions.BILINEAR_PREMULTIPLYALPHA);
    // Loading bitmap
    sky_bm = BitmapFactory.decodeResource(getResources(), R.drawable.sky, options);
    sky_src = new BitmapTextureAtlasSource(sky_bm);

    skyRegion = TextureRegionFactory.createFromSource(mTexture, sky_src, 0, 0, false);

    mEngine.getTextureManager().loadTexture(mTexture); 
```

BitmapTextureAtlas源代码：

```
 public class BitmapTextureAtlasSource extends BaseTextureAtlasSource implements IBitmapTextureAtlasSource {

        private Bitmap mBitmap;

        public BitmapTextureAtlasSource(Bitmap pBitmap) {
            super(0,0);
            //this.mBitmap = pBitmap;
            this.mBitmap = pBitmap.copy(Bitmap.Config.ARGB_8888, false);
        }

        public int getWidth() {
            return mBitmap.getWidth();
        }

        public int getHeight() {
            return mBitmap.getHeight();
        }

        @Override
        public BitmapTextureAtlasSource clone() {
            return new BitmapTextureAtlasSource(Bitmap.createBitmap(mBitmap));
        }

        public Bitmap onLoadBitmap(Config pBitmapConfig) {
                return mBitmap;
        }

        @Override
        public IBitmapTextureAtlasSource deepCopy() {
            return null;
        }
    } 
```

但是当旋转屏幕时，我得到了错误：

```
FATAL EXCEPTION: GLThread 4895
java.lang.IllegalArgumentException: bitmap is recycled
    at android.opengl.GLUtils.texSubImage2D(GLUtils.java:220)
    at org.anddev.andengine.opengl.texture.atlas.bitmap.BitmapTextureAtlas.writeTextureToHardware(BitmapTextureAtlas.java:162)
    at org.anddev.andengine.opengl.texture.Texture.loadToHardware(Texture.java:116)
    at org.anddev.andengine.opengl.texture.TextureManager.updateTextures(TextureManager.java:146)
    at org.anddev.andengine.engine.Engine.onDrawFrame(Engine.java:507)
    at org.anddev.andengine.opengl.view.RenderSurfaceView$Renderer.onDrawFrame(RenderSurfaceView.java:154)
    at net.rbgrn.opengl.GLThread.guardedRun(GLThread.java:235)
    at net.rbgrn.opengl.GLThread.run(GLThread.java:94) 
```

请告诉我我做错了什么。我将不胜感激任何信息

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T01:00:55.370

我建议您将分辨率策略设置为`RatioResolutionPolicy`并让引擎为您进行缩放。

[http://andengine.wikidot.com/detect-screen-resolution](http://andengine.wikidot.com/detect-screen-resolution)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T14:10:20.890

我认为问题可能出在 onLoadBitmap 上，您应该返回一份副本。我建议你试试这个扩展 EmptyBitmapTextureAtlasSource 的实现：

```
public class BitmapTextureSource extends EmptyBitmapTextureAtlasSource {

private Bitmap mBitmap;

public BitmapTextureSource(Bitmap bitmap) {
    super(bitmap.getWidth(), bitmap.getHeight());
    mBitmap = bitmap;       
}

@Override
public Bitmap onLoadBitmap(Config pBitmapConfig) {
    return mBitmap.copy(pBitmapConfig, true);       
} 
```

}

# android - 使用 FFmpeg 检索专辑封面

> ID：13592709
> 
> 赞同：13
> 
> 时间：2012-11-27T20:44:38.383
> 
> 标签：android, audio, ffmpeg, java-native-interface, metadata

我正在开发一个依赖 FFmpeg 来检索音频元数据的 Android 应用程序。我知道可以使用 FFMpeg 以编程方式检索专辑封面。但是，一旦您解码了艺术作品（MP3 中的视频帧），如何生成图像文件（PNG）以在应用程序中使用？我到处搜索，但似乎找不到一个可行的例子。

编辑，这是解决方案：

```
#include <libavcodec/avcodec.h>
#include <libavformat/avformat.h>

void retrieve_album_art(const char *path, const char *album_art_file) {
    int i, ret = 0;

    if (!path) {
        printf("Path is NULL\n");
        return;
    }

    AVFormatContext *pFormatCtx = avformat_alloc_context();

    printf("Opening %s\n", path);

    // open the specified path
    if (avformat_open_input(&pFormatCtx, path, NULL, NULL) != 0) {
        printf("avformat_open_input() failed");
        goto fail;
    }

    // read the format headers
    if (pFormatCtx->iformat->read_header(pFormatCtx) < 0) {
        printf("could not read the format header\n");
        goto fail;
    }

    // find the first attached picture, if available
    for (i = 0; i < pFormatCtx->nb_streams; i++)
        if (pFormatCtx->streams[i]->disposition & AV_DISPOSITION_ATTACHED_PIC) {
            AVPacket pkt = pFormatCtx->streams[i]->attached_pic;
            FILE* album_art = fopen(album_art_file, "wb");
            ret = fwrite(pkt.data, pkt.size, 1, album_art);
            fclose(album_art);
            av_free_packet(&pkt);
            break;
        }

    if (ret) {
        printf("Wrote album art to %s\n", album_art_file);
    }

    fail:
        av_free(pFormatCtx);
        // this line crashes for some reason...
        //avformat_free_context(pFormatCtx);
}

int main() {
    avformat_network_init();
    av_register_all();

    const char *path = "some url";
    const char *album_art_file = "some path";

    retrieve_album_art(path, album_art_file);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2012-12-03T04:39:44.680

要以编程方式使用 ffmpeg，我认为您必须在 libavformat（它是 ffmpeg 的一部分）中调用[read_apic](http://ffmpeg.org/doxygen/trunk/id3v2_8c-source.html#l00441) ()。

从命令行，您显然可以这样做：

```
ffmpeg -i input.mp3 -an -vcodec copy cover.jpg 
```

命令行行为意味着封面艺术图像被视为只是另一个视频流（仅包含一帧），因此以通常的方式使用 libavformat 解复用流的视频部分应该会生成该图像。

解复用的示例代码：[ffmpeg/docs/examples/demuxing.c](http://ffmpeg.org/doxygen/trunk/demuxing_8c-source.html) 通过解复用 mp3 中的视频流获得的第一个（也是唯一的）AVPacket 将包含 JPEG 文件（仍然编码为 JPEG，未解码）。

```
AVFormatContext* fmt_ctx;
// set up fmt_ctx to read first video stream
AVPacket pkt;
av_read_frame(fmt_ctx, &pkt);
FILE* image_file = fopen("image.jpg", "wb");
int result = fwrite(pkt.data, pkt.size, 1, image_file);
fclose(image_file); 
```

如果有多个图像，我认为它们将被视为单独的视频流，而不是同一流中的单独数据包。第一个流将是具有最大分辨率的流。

所有这些都可能是在 read_apic() 内部实现的。

ID3v2 规范允许任何图像格式，但建议使用 JPEG 或 PNG。实际上，ID3 中的所有图像都是 JPEG。

**编辑**：将一些不太有用的位移到后记：

PS`ffmpeg -i input.mp3 -f ffmetadata metadata.txt`将生成一个包含元数据的类似 ini 的文件，但其中甚至没有引用图像，因此这不是一个有用的方法。

PS 一个 ID3v2 标签中可能有[多个图像](http://en.wikipedia.org/wiki/ID3#ID3v2_Embedded_Image_Extension)。当存在多于一张图像或多于一种类型的图像时，您可能需要处理这种情况。

PS ffmpeg 可能不是最好的软件。使用[id3lib](http://id3lib.sourceforge.net/)、[TagLib](http://taglib.github.com/)或 ID3 的其他[实现之一](http://id3.org/Implementations)。这些可以用作库（可从您选择的语言调用）或用作命令行实用程序。这里有 TagLib 的示例 C++ 代码：[How do I use TagLib to read/write coverart in different audio formats？](https://stackoverflow.com/questions/4752020/how-do-i-use-taglib-to-read-write-coverart-in-different-audio-formats)以及此处的 id3lib：[如何使用 id3lib 从音频文件中获取专辑封面](http://www.tejashwi.com/asknshare/7/how-to-get-album-art-from-audio-files-using-id3lib)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2019-01-06T10:07:05.170

作为上述答案的补充，我还需要一种调整输出图像大小的方法，因此我在尝试当前答案中的命令时找到了以下命令：

```
ffmpeg -i input.mp3 -filter:v scale=-2:250 -an output.jpeg 
```

所以这基本上将输出图像缩放到您想要的任何比率或值。

# php - PHP - 如何为溢出的 Foreach 制作页面？

> ID：13592722
> 
> 赞同：-2
> 
> 时间：2012-11-27T20:45:14.410
> 
> 标签：php, foreach

抱歉，这个标题毫无帮助，我正在尝试为我的 foreach 语句创建多个页面，因为它可以访问具有 100 行的数据库。我会将第一页的查询限制为 1,30，然后第二页限制为 31-60？如果是这样，我将如何编码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T20:50:14.880

```
$totalRows = 100;// Total rows
$perPage = 30;
$pages = ceil($totalRows/$perPage);
for ($i = 0; $i<=$pages; $i++)
{
    $sql = sprintf("SELECT * FROM table LIMIT %s, %s", $i*$perPage, $perPage);
    // Execute
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T20:53:14.003

查询可能会带来很大的开销，因此不要执行多个查询。相反，做一个查询，然后使用 PHP 将结果分解为您希望的结果。您可以使用循环计数器和 % 运算符来检查是否该休息了。

例如，如果您正在遍历结果并且您的循环变量是 $i，那么您可以执行以下操作：

```
if ( $i > 0 && $i % 30 == 0 ) {
    // Breaking action here ...
} 
```

检测循环的每 30 次迭代并实现您的逻辑。

# list - 如何将随机数量的列表元素分配给新列表

> ID：13592732
> 
> 赞同：-1
> 
> 时间：2012-11-27T20:45:35.570
> 
> 标签：list, erlang

我有一个类似的列表：

```
L = [[1,2,3],[4,5,6,7,8],[9,10,11]] 
```

我想随机选择元素，例如：

```
L1=[[1,2,3],[9,10,11]]
L2=[[1,2,3]]
L3=[[4,5,6,7,8],[9,10,11]]
L4=[[1,2,3]] 
```

我怎么能在erlang中做到这一点？

编辑：我还想保证所有元素至少会被选中一次。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T00:51:15.103

听起来您要做的是获取一个列表`[A, B, C, D, E]`并选择随机选择的元素，因此有时您会得到，有时会得到，有时`[A, C, E]`会得到`[B, C]`，`[E]`等等。元素本身就是列表的事实并没有在您给出的示例中似乎很重要。

基本上，这个想法是以某个概率 P 单独选择每个元素，这相当于为每个元素分配一个随机数，然后检查它是否小于 P。最有可能的是，对于您的情况，P = 0.5 - 每个元素都有一个50/50 的机会被选中。

所以，我认为这将解决你的问题。

```
random_subset(List) -> random_subset(List, 0.5).

random_subset(List, P) ->
    % Need to seed the random number generator
    {S1,S2,S3} = now(),
    random:seed(S1, S2, S3),
    % Assign a random value for each element in the list.
    Selections = [{E, random:uniform()} || E <- List],
    % Only keep elements where the random value is in the selected range
    [E || {E, RandomValue} <- Selections, RandomValue < P]. 
```

有更紧凑的方法来写这个，但我做了很长的路来解释正在发生的每一步。一个更简单的方法是使用[lists:filter/2](http://www.erlang.org/doc/man/lists.html#filter-2)：

```
random_subset(List, P) ->
    % Note: assuming the random number generator has already been seeded
    lists:filter(fun(_) -> random:uniform() < P end, List). 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T23:21:07.553

您可以使用[random](http://www.erlang.org/doc/man/random.html)模块生成一个新的随机长度列表，其中包含从 L 中随机选择的项目，必要时消除重复项。

# python - Database Mapping World Cities to Metropolitan Statistical Areas (and non-US MSA equivalents)

> ID：13592734
> 
> 赞同：12
> 
> 时间：2012-11-27T20:45:52.137
> 
> 标签：python, csv, geocoding, geography, google-ads-api

My problem is that I have a file with thousands of cities and I want to map city names to ([Metropolitan Statistical Areas](http://en.wikipedia.org/wiki/Metropolitan_Statistical_Area) and the MSA equivalent for non-US cities. There have been a bunch of posts here on similar questions. I'm using Python if that helps (ie in case there is a python package available similar to how the googlemaps python package works...)

1.  [Mapping Cities to Zip Codes](https://stackoverflow.com/questions/6588890/whats-the-best-way-to-lookup-the-us-county-a-us-city-resides-in). There is a good answer here that provides a csv with zip codes for every city in the US. But because the census data is published mapping US counties to MSA's, instead of US cities, I would still need to find a way to map back from zip codes to US cities.

2.  [Database of US Cities to MSA](https://stackoverflow.com/questions/1446259/database-of-us-metropolitan-area-names) This is essentially my question (at least the US portion), but it was not answered to the satisfaction of the poster, or my question.

3.  [Google's Geocoding Developer Site](https://stackoverflow.com/questions/2708276/cities-to-metropolitan-areas) The Google Geocoding developer's site has a useful CSV that has some US cities mapped to a Google Metro Region code. The problem is that it is not MSA. The old Google csv, [downloadable here](https://developers.google.com/adwords/api/docs/appendix/metrocodes?hl=iw-IL) does not say how the metro coding system was created. The [site](https://developers.google.com/adwords/api/docs/appendix/metrocodes?hl=iw-IL) also has a link to the new Google coding system based on Nielsen's DMA (designated market area) coding system.

I'm really just looking for a csv file that has city, state (if US), country, region code. Where region code is based on well-regarded standard (the US Census Bureau's MSA would be ideal for US cities, and having non-US country's census classifications for non-US cities would be ideal too). Does such a file exist? Alternatively, is there a python package that connects to some database such that I run my script on my input file and it outputs the corresponding region code?

Thanks very much!

**ANSWER**

For anyone interested, here is a pretty good file that maps US cities to counties: [http://www.census.gov/statab/ccdb/ccdbcityplace.html](http://www.census.gov/statab/ccdb/ccdbcityplace.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-05-26T12:41:20.423

我正在寻找类似的 MSA 级资源，并在 CartoDB 网站上发现了这张地图：[https ://common-data.cartodb.com/tables/cb_2013_us_cbsa_5m/public/map](https://common-data.cartodb.com/tables/cb_2013_us_cbsa_5m/public/map)

[![在此处输入图像描述](../Images/820861e245fa91f55937257c5229593f.png)](https://i.stack.imgur.com/28sT8.png)

您可以下载多种不同的格式，包括 GeoJSON 和 CSV。这是一个屏幕截图，显示了以 CSV 格式导出的数据的类型和值（因为这是原始海报的要求）：

[![在此处输入图像描述](../Images/bccb5951011d27610bf1ac3cf2e53cf0.png)](https://i.stack.imgur.com/9R9K3.png)

我希望这对遇到这篇文章的其他人有所帮助！

# java - LOG.trace enabled in maven 3

> ID：13592736
> 
> 赞同：1
> 
> 时间：2012-11-27T20:45:53.857
> 
> 标签：java, maven, logging, log4j, maven-3

I have a class: MyClass

```
private static final Log LOG = LogFactory.getLog(MyClass.class); 
```

Somewhere in my code I do a `LOG.trace()` only `LOG.isTraceEnabled()`

And a test for that MyClass which uses Junit4

the test is ran by maven (2.2.1) just fine and logs the other logs (I've set the log4j.xml to level=`INFO`)

But if I switch to maven 3.0.3, the log4j.xml gets overridden or it not pointing where is should be and all the levels of debug are enabled (debug, trace, etc.)

I want to disable, if possible trace logging as it works in maven 2.2.1\. There are hacky ways that I can do, I know, but I want to understand why is this happening?

Some of the key dependencies from the pom.xml

```
<dependency>
   <groupId>commons-logging</groupId>
   <artifactId>commons-logging</artifactId>
   <version>1.1.1</version>
</dependency>
 <dependency>
   <groupId>junit</groupId>
   <artifactId>junit</artifactId>
   <version>4.8.2</version>
   <scope>test</scope>
</dependency>
<dependency>
   <groupId>log4j</groupId>
   <artifactId>log4j</artifactId>
   <version>1.2.16</version>
</dependency>

<plugin>
  <groupId>org.apache.maven.plugins</groupId>
  <artifactId>maven-surefire-plugin</artifactId>
  <version>2.4.3</version>
</plugin> 
```

the test is ran with other test classes. (multi-module project) if I do `mvn clean test -Dtest=MyClassTest`, the logging don't get messed up, but if I do mvn clean test (for all the tests) the logging will not work okay anymore (this is still just in case for maven 3)

# coldfusion - 使用评估（）的字符串到数组失败

> ID：13592741
> 
> 赞同：1
> 
> 时间：2012-11-27T20:46:17.570
> 
> 标签：coldfusion, coldfusion-9

如何将字符串转换为数组

```
<cfscript>
    stResult = {    strData = "[1,2,3,4,5,6]"
                 ,  arInstant = [1,2,3,4,5,6]
               };

    //stResult.arData = evaluate(stResult.strData);  // this does not work
    //stResult.arData = evaluate("#stResult.strData#"); // nor does this

    writedump(stResult);
</cfscript> 
```

我正在尝试获得看起来像 arInstant 的东西。

有没有比条带化`[]`、转换为列表、然后转换为数组更好的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-28T17:01:26.220

您的数据是[JSON](http://json.org/)字符串，因此请使用**[deserializeJson](http://cfdocs.org/deserializeJson) ()**将其转换为数组。

用法：

```
Result.Data = deserializeJson(Result.Input); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T21:09:24.307

evaluate() 通常应该避免（参考：[1](http://cfprimer.blogspot.co.uk/2005/03/avoid-evaluate.html) , [2](http://www.danielgaspar.com/blog/2010/05/coldfusions-evaluate/) , [3](http://www.bryantwebconsulting.com/blog/index.cfm/2005/3/17/ditch_coldfusion_evaluate)）。试试怎么样：

```
stResult.arData = ListToArray(stResult.strData, "[],"); 
```

这将整个字符串视为一个列表，可能带有`[`and`]`和 and的分隔符`,`

它应该为您提供一个包含 6 个元素的数组。

当然，看起来你`stResult.arInstant`已经拥有了你需要的东西……你想做什么？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T22:40:40.403

对于这个特定的问题，“

有没有比条带化 []、转换为列表、然后转换为数组更好的方法？”

实际上，一旦去掉方括号，它就是一个列表，因此少了一步。

# asp.net-mvc - ASP MVC - 我需要定期检查我的数据库，我该怎么做？

> ID：13592743
> 
> 赞同：0
> 
> 时间：2012-11-27T20:46:23.510
> 
> 标签：asp.net-mvc, database, asp.net-mvc-3

我有一个用 ASP.MVC 编写的在线网站。现在，我需要定期检查一个表，如果它发生变化，我需要采取与修改其他表中的数据相关的进一步操作。我当然可以编写一个独立的应用程序来为我做这件事，但是我还有其他选择吗？我在问，因为也许有更好的东西我不知道。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T02:54:09.417

假设您使用的是 SQL Server，一个选项是将一个项目添加到[ASP.NET Cache](http://msdn.microsoft.com/en-us/library/system.web.caching.cache%28v=vs.100%29.aspx)，然后[`SqlCacheDependency`](http://msdn.microsoft.com/en-us/library/ms178604%28v=vs.100%29.aspx)在该项目上为要监视的表或行注册一个。[启动和运行它需要一些配置，这里](http://www.asp.net/web-forms/tutorials/data-access/caching-data/using-sql-cache-dependencies-vb)有一些说明（代码示例在 VB 中）。当您将项目添加到具有 的缓存时`SqlCacheDependency`，您可以指定在数据更改时触发的回调方法，这就是您更新相关表的方式。如果您正在运行 SQL Server，需要 Microsoft 提供的预定义解决方案，并且不介意设置过程以及其中包含的其他数据库表和配置，那么这将是一个不错的选择。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T14:52:45.800

我得到了满足我要求的答案。有一个叫做**Quartz.net**的东西可以按我的意愿工作。:)

# c++ - std::vector::push_back fails to add data to my vector

> ID：13592744
> 
> 赞同：1
> 
> 时间：2012-11-27T20:46:34.037
> 
> 标签：c++, vector

I have these two pieces of code that are messing up without throwing any errors:

The first piece is from a custom class which I am trying to push into an array.

```
class idRect {
    public:
        sf::FloatRect rect;
        int id;

        idRect(int _id, sf::FloatRect _rect) : id(_id), rect(_rect) {}
}; 
```

The second piece is where the function gets called.

```
if((deltaX + deltaY) < 500) { //Taxi distance calculation
    cout << endl << "Passed check" << endl;
    gloAreas.push_back(idRect(id, entity.getGlobalBounds()));
} 
```

gloAreas is a globally defined vector which contains idRect objects.

As said earlier I have observed from the console that "Passed check" outputs and that the size of my vector doesn't increase EDIT: globally.

Edit: The error also seems rather random and only happens for 1 in 6 instances of the objects calling the push_back functions.

I'm using SFML for the sf::FloatRect which is basically just a vector of 4 floats. getGlobalBounds() is another function from SFML that returns the bounding rectangle of a sprite in sf::FloatRect format.

Any ideas of what is going wrong?

Sincerely, BarrensZeppelin

EDIT 2: The error seems to have erupted due to a mix between my own incompetence and std::multiset's sorting, maybe I'll come back for that in another thread ^^ (With a sscce ofc) Thank you guys for you time and help.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T20:49:37.207

如果`gloAreas`定义为`static`，则它不是*真正*的全局变量。它将具有全局范围，但将为每个翻译单元创建一个副本。

对于全局，您需要`extern`在单个实现文件中声明并定义它。

免责声明：答案只是猜测，我的水晶球今天可能会关闭......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T21:04:03.623

我的水晶球回答：您已经`gloAreas`在内部范围内重新定义，如下所示：

```
vector<idRect> gloAreas; // defines global

void F( vector<idRect> gloAreas ) // defines local instance
{
  gloAreas.push_back(); // affects local instance
  return;               // destroys local instance 
}
int main() {
  F(gloAreas); // Copies global instance to parameter
               // global remains unchanged.
} 
```

# ruby-on-rails - How to see action of a webpage in Rails?

> ID：13592749
> 
> 赞同：-1
> 
> 时间：2012-11-27T20:47:17.850
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.2, action, erb

Is there a field or method I can lookup within an `.html.erb` file that will tell me the current action used to render the page? This code would be in a partial. I'm looking for something like this:

```
<% if @action == :new %>
  this is new
<% end %> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T20:54:16.810

是的，你有`action_name`并且`controller_name`为此目的。

**但请注意**：结果是一个字符串，而不是一个符号。

见[说明](http://guides.rubyonrails.org/action_controller_overview.html#routing-parameters)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T23:38:39.427

你可以做这样的事情。

```
<% if params[:action] ==  "new" %>
  # do something here
<% end %> 
```

# windows-8 - Jelly-Bean updated Galaxy Tab 2 7" can't connect to Windows 8

> ID：13592750
> 
> 赞同：1
> 
> 时间：2012-11-27T20:47:23.587
> 
> 标签：windows-8, usb, adb, android-4.2-jelly-bean, galaxy-tab

I've just updated my Galaxy Tab 2 7" to OS v4.1.1 (Jelly Bean). Since that I can't connect to my device (from my Windows 8 PC, via USB) anymore.
Most relevant to me is the fact that I can't even debug my Android apps using the tablet (which is actually the reason why I bought it). **Eclipse** does show it among the adb devices, but in an *offline* status.

The Android SDK is updated. I've tried to force the install of the drivers via the **android_winusb.inf** located in the

*\android-sdk-windows\extras\google\usb_driver*

folder, but it doesn't seem to carry the right pieces of information. Tampering the file by manually adding 'em seems to conflict with the along-coming *.cat* files.
I've also tried by installing **Kies**, but even that piece of software can't connect to the device.

What do you suggest? Thanks in advance.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T08:06:09.947

神奇的是，就在几分钟前，我的设备“从上方”传来了一个新的 OTA 更新。这解决了整个问题（在 PC 端没有采取任何行动）。

查看“关于设备”的数据表，Android 版本仍然是 4.1.1。
我没有跟踪以前的内核版本或内部版本号，所以我看不出它们是否以及如何改变；但我现在可以把它们写下来，以防其他人检查可能很重要：

```
内核版本
3.0.31 - 523998

内部编号
JRO03C.P3110XXCLK7

```

# iphone - Cocos2d (spacemanager) scale sprite to touch or projection guide line?

> ID：13592752
> 
> 赞同：0
> 
> 时间：2012-11-27T20:47:36.320
> 
> 标签：iphone, cocos2d-iphone

I'm applying an impulse to a sprite and I currently have an arrow behind the sprite to show which direction the sprite will be shot. But what I want to do is scale the arrow on its x axis to show the power of the impulse. How would I do this? I know how to scale on the x axis but how would I relate this to the touch, to do the impulse in using cgpoint in touchbegan and touchmoved. I want to do this OR show a guide line that will show the path the sprite will travel when the touch has ended. Thanks I'm using spacemanager for the physics.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T11:45:52.577

我设法缩放要触摸的箭头，我只是得到了触摸之间的距离，使其更小并限制了缩放。这是我的代码

```
arrow.scaleX = ccpDistance(birdPosition, pt1)/50;
    if (arrow.scaleX > 1.0) {
        arrow.scaleX = 1.0;
    } 
```

如果有人知道指南，我仍然喜欢看到并比较两者。谢谢

# matlab - How to make a block of matrices from large matrix in matlab?

> ID：13592754
> 
> 赞同：1
> 
> 时间：2012-11-27T20:47:40.547
> 
> 标签：matlab, matrix, octave

I have a 256x256 matrix from that I want to create block of 8x8 matrices. I have a below code which shows just one block i want all the blocks then subtract a number from each element of the matrix. When i do the subtract 128 from each element it doesn't show negative values rather showing only 0.

```
[x,y] = size(M);

for i=1:8
   for j=1:8
      k(i,j) = M(i,j);
   end
end

disp(k);

for a=1:size(k)
   for b=1:size(k)
     A(a,b) = k(a,b) - 128;
   end
end

disp(A); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T21:03:22.743

好吧，如果你必须减去一个固定值，最好这样做

```
M = M - 128; 
```

它更快。

你说你得到`0`的是价值而不是消极的；这可能是由于矩阵的类型`unsigned`（即这些人只是积极的）。转换为一般整数是必要的。尝试：

```
M = int16(M) - 128; 
```

为了获得我提出的分区，可以有更有效的方法，顺便说一句：

```
r = rand(256,256);            %// test case, substitute with your matrix M
[i j] = meshgrid(1:8:256);    %// lattice of indices      
idx = num2cell([ i(:) , j(:) ],2); %// cell version 

matr = cellfun( @(i) r(i(1):i(1)+7,i(2):i(2)+7), idx, 'UniformOutput',false); %// blocks 
```

matr 将按字典顺序包含所有子矩阵。例如

```
matr{2}

ans =

0.4026    0.3141    0.4164    0.5005    0.6952    0.1955    0.9803    0.5097
0.8186    0.9280    0.1737    0.6133    0.8562    0.7405    0.8766    0.0975
0.2704    0.8333    0.1892    0.7661    0.5168    0.3856    0.1432    0.9958
0.9973    0.8488    0.6937    0.2630    0.1004    0.5842    0.1844    0.5206
0.4052    0.0629    0.6982    0.1530    0.9234    0.1271    0.7317    0.3541
0.2984    0.3633    0.1510    0.0297    0.0225    0.7945    0.2925    0.0396
0.5097    0.0802    0.8744    0.1032    0.8523    0.6150    0.4845    0.5703
0.8635    0.0194    0.1879    0.5017    0.5297    0.6319    0.2406    0.5125 
```

说明：在 matlab 中，您可以有效地对矩阵和它们的切片进行操作。例如，您可以轻松复制子矩阵，例如第一个 8x8 矩阵是

```
 sub = M(1:8,1:8); 
```

你想要所有的子矩阵，因此你需要一种索引格来获得

```
 sub_ij = M(1+8*(i-1) : 7 * 8*(i-1) , 1+8*(j-1) : 7 * 8*(j-1)) 
```

即你需要格子

```
 (1+8*(i-1) : 7 * 8*(i-1) , 1+8*(j-1) : 7 * 8*(j-1))   % // for all i,j 
```

你可以使用`meshgrid`它。

最后你必须切断碎片，这就是最后两条指令所做的。特别是第一个生成索引（try `idx{1}`，...），第二个生成子矩阵（try `matr{1}`，...）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T03:50:34.153

希望这段[代码](http://www.mathworks.com/matlabcentral/answers/33103)对您有所帮助。它具有 16x16 的图像，可分为 4x4 块。您可以根据需要更改值并获得所需的输出。

# c++ - SDL return code 3 from SDL at strange place in code

> ID：13592755
> 
> 赞同：2
> 
> 时间：2012-11-27T20:47:48.053
> 
> 标签：c++, sdl, pixel

I am getting a 3 error code from an SDL executable, and it seems to be in a place where I pass a SDL color by value and I don't understand the reason.

```
void Map::draw(SDL_Surface *surface, int level){
//the surface is locked
if ( SDL_MUSTLOCK(surface) )
    SDL_LockSurface(surface);

long start= (long)level * this->xmax * this->ymax;
long end= (long)(level+1) * this->xmax * this->ymax;

for(long n=start; n<end; ++n){
    Node *pn= this->nodes+n;
    //exit(18); //exit code is 18
    draw_pixel_nolock(surface, pn->location.x, pn->location.y, colors[pn->content]);
}

//the surface is unlocked
if ( SDL_MUSTLOCK(surface) )
    SDL_UnlockSurface(surface); 
```

}

And the graphics function called is:

```
SDL_Color colors[]= { {0,0,0},  {0xFF,0,0},  {0,0xFF,0},  {0,0,0xFF} };

void PutPixel32_nolock(SDL_Surface * surface, int x, int y, Uint32 color)
{
    Uint8 * pixel = (Uint8*)surface->pixels;
    pixel += (y * surface->pitch) + (x * sizeof(Uint32));
    *((Uint32*)pixel) = color;
}

void PutPixel24_nolock(SDL_Surface * surface, int x, int y, Uint32 color)
{
    Uint8 * pixel = (Uint8*)surface->pixels;
    pixel += (y * surface->pitch) + (x * sizeof(Uint8) * 3);
#if SDL_BYTEORDER == SDL_BIG_ENDIAN
    pixel[0] = (color >> 24) & 0xFF;
    pixel[1] = (color >> 16) & 0xFF;
    pixel[2] = (color >> 8) & 0xFF;
#else
    pixel[0] = color & 0xFF;
    pixel[1] = (color >> 8) & 0xFF;
    pixel[2] = (color >> 16) & 0xFF;
#endif
}

void PutPixel16_nolock(SDL_Surface * surface, int x, int y, Uint32 color)
{
    Uint8 * pixel = (Uint8*)surface->pixels;
    pixel += (y * surface->pitch) + (x * sizeof(Uint16));
    *((Uint16*)pixel) = color & 0xFFFF;
}

void PutPixel8_nolock(SDL_Surface * surface, int x, int y, Uint32 color)
{
    Uint8 * pixel = (Uint8*)surface->pixels;
    pixel += (y * surface->pitch) + (x * sizeof(Uint8));
    *pixel = color & 0xFF;
}

//this function draws a pixel of wanted color on a surface at (x,y) coordinate
void draw_pixel_nolock(SDL_Surface *surface, int x, int y, SDL_Color s_color)
{  exit(19);//exit code is 3
    //SDL_MapRGB return a color map depending on bpp (definition)
    Uint32 color = SDL_MapRGB(surface->format, s_color.r, s_color.g, s_color.b);

    //byte per pixel
    int bpp = surface->format->BytesPerPixel;

    //here is checked the number of byte used by our surface
    switch (bpp)
    {
        case 1: // 1 byte =>  8-bpp
            PutPixel8_nolock(surface, x, y, color);
            break;
        case 2: // 2 byte => 16-bpp
            PutPixel16_nolock(surface, x, y, color);
            break;
       case 3: // 3 byte => 24-bpp
            PutPixel24_nolock(surface, x, y, color);
            break;
      case 4: // 4 byte => 32-bpp
            PutPixel32_nolock(surface, x, y, color);
            break;
    }
} 
```

The code returns error code 18 when I exit there, but never returns error code 19, and gives errror code 3 instead. What could possibly go wrong?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T14:44:13.830

没有看到整个代码很难说，但作为一般做法：

验证

```
long start= (long)level * this->xmax * this->ymax;
long end= (long)(level+1) * this->xmax * this->ymax; 
```

`start`并且`end`是`node`数组的有效偏移量，否则`this->node + n`将返回垃圾指针。

验证

```
Node *pn= this->nodes+n; 
```

不是指向对象`null`的**有效指针**`Node`

验证

```
pn->content 
```

在您的`colors`数组范围内

# iphone - iOS6 设备轮换受到限制

> ID：13592763
> 
> 赞同：0
> 
> 时间：2012-11-27T20:48:08.453
> 
> 标签：iphone, ios, ios6, autorotate

对于我的应用程序，我想让设备旋转但倒置。这工作正常。但是，我想阻止应用程序专门从

**横向左->横向右**-反之亦然

如果有人好奇，这是因为旋转会弄乱我的布局，因为它们每个都从一个共同点旋转

我认为可行的 iOS 5 代码是这样的：

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation {

    NSLog(@"Rotating");
    if((lastOrient == 3 && toInterfaceOrientation == 4) || (lastOrient == 4 && toInterfaceOrientation == 3)){
       lastOrient = toInterfaceOrientation;
       return NO;
    }

   lastOrient = toInterfaceOrientation;
   return YES;

} 
```

其中 3= 横向左侧和 4= 横向右侧

有关如何使用 iOS6 执行此操作的任何建议？还是完全不同的解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T21:17:41.490

shouldAutorotateToInterfaceOrientation 在 ios6 中已弃用。用这个：

```
- (BOOL)shouldAutorotate {

UIInterfaceOrientation orientation = [[UIDevice currentDevice] orientation];

if (lastOrientation==UIInterfaceOrientationPortrait && orientation == UIInterfaceOrientationPortrait) {
 return NO;

}

return YES;
} 
```

没有测试过这个代码。您可以获得有关这些帖子的更多信息： [shouldAutorotateToInterfaceOrientation is not working in iOS 6](https://stackoverflow.com/questions/12577879/shouldautorotatetointerfaceorientation-is-not-working-in-ios-6) [shouldAutorotateToInterfaceOrientation not being called in iOS 6](https://stackoverflow.com/questions/12260261/shouldautorotatetointerfaceorientation-not-being-called-in-ios-6)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T21:20:32.220

好的，我在这里回答了我自己的问题：

好消息是，绝对有办法做到这一点！所以这是基础知识：

在 iOS6 中，一般由 appDelegate 来处理应用程序是否可以旋转。然后，当设备收到旋转信号时，它会询问您的视图以了解其支持的方向。这是我实现我的代码的地方。事实上， shouldAutorotate() 在解决方案中没有任何作用。

所以我创建了一个变量来跟踪最后一个方向，并将其更改为

```
- (void)willRotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation duration:(NSTimeInterval)duration{ 
```

这样我可以比较方向

```
-(NSUInteger)supportedInterfaceOrientations
{
    NSLog(@"Last Orient = %d", lastOrient);
    NSUInteger orientations = UIInterfaceOrientationMaskPortrait;

    if (lastOrient != 3 && lastOrient != 4) {
        NSLog(@"All good, rotate anywhere");
        return UIInterfaceOrientationMaskAllButUpsideDown;
    }
    else if(lastOrient == 3){
        orientations |= UIInterfaceOrientationMaskLandscapeRight;
        NSLog(@"Can only rotate right");
    }
    else if(lastOrient == 4){
        orientations |= UIInterfaceOrientationMaskLandscapeLeft;
        NSLog(@"Can only rotate left");
    }

    return orientations;
} 
```

似乎对我有用。有点hack，但它做了它需要做的事情

# javascript - 给定动态数据时，Google Charts (Pie) 仅显示 Slivers

> ID：13592764
> 
> 赞同：0
> 
> 时间：2012-11-27T20:48:10.613
> 
> 标签：javascript, jquery, ruby-on-rails, ruby-on-rails-3

我试图在我的 Rails 应用程序中包含一个[谷歌饼图](https://google-developers.appspot.com/chart/interactive/docs/gallery/piechart)，我遇到了一个我认为特别奇怪的错误。

问题是，当我输入数字时，图表显示完美（将我的两个输入数字显示为饼图的两个组成部分，等于它们的总和），但是当我尝试为其提供动态数据时，它似乎 PICK UP 数据但是不要正确使用它——而是在空白图表中将这两个数字显示为条子。代码示例：

这完美地工作，变成了具有正确值的漂亮饼图（已售出和左侧，下图）：

```
<div id="chart_div"></div>

<script type="text/javascript" src="https://www.google.com/jsapi"></script>
<script type="text/javascript">
  google.load("visualization", "1", {packages:["corechart"]});
  google.setOnLoadCallback(drawChart);
  function drawChart() {
    var sold = 406;
    var left = 38; 
    var data = google.visualization.arrayToDataTable([
      ['Pounds', 'Sold/Left'],
      ['Pounds Sold', sold],
      ['Left', left]
    ]);

    var options = {

    };

    var chart = new google.visualization.PieChart(document.getElementById('chart_div'));
    chart.draw(data, options);
  }
</script> 
```

然而，这会生成一个带有悬停的图表，显示（在这种情况下）完全相同的数字（406 和 38），但两个图表部分非常小，约占图表交易量的 1%（与理想的 100%）。剩下的 99% 的图表是空白的：

```
<div id="chart_div" data-sold=<%= @animal.pounds_sold.to_i %> data-left=<%= @animal.pounds_left.to_i %> ></div>
// Here, the numbers equal 406 and 38, as in the above. 

<script type="text/javascript" src="https://www.google.com/jsapi"></script>
<script type="text/javascript">
  google.load("visualization", "1", {packages:["corechart"]});
  google.setOnLoadCallback(drawChart);
  function drawChart() {
    var sold = $(document).find('#chart_div').attr('data-sold');
    var left = $(document).find('#chart_div').attr('data-left');
    var data = google.visualization.arrayToDataTable([
      ['Pounds', 'Sold/Left'],
      ['Pounds Sold', sold],
      ['Left', left]
    ]);

    var options = {

    };

    var chart = new google.visualization.PieChart(document.getElementById('chart_div'));
    chart.draw(data, options);
  }
</script> 
```

一个可能的线索是，当我将鼠标悬停在此错误图表中的部分上时，虽然悬停显示正确的数字（406、38），但它表示这些部分分别仅占饼图的 1% 和 0.2%，即使其余部分饼图是空白的（并且没有悬停/悬停值）。

有什么想法吗？我猜我犯了一些 javascript/jquery 罪行，因为我对它很陌生，但我不知道是什么。

谢谢！

编辑——另一个奇怪的事情。我试图看看在动态数字和直数的混合场景中会发生什么，即对上面的动态版本进行以下修改：

```
...
var other = 50;
var sold = $(document).find('#chart_div').attr('data-sold');
var left = $(document).find('#chart_div').attr('data-left');
var data = google.visualization.arrayToDataTable([
  ['Pounds', 'Sold/Left'],
  ['Pounds Sold', sold],
  ['Left', left],
  ['Test', other]
]);
... 
```

这（对我来说）莫名其妙地导致根本没有图表。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T10:35:43.033

我认为问题在于您将每个条子的“值”指定为字符串。尝试将它们定义为一个`INT`，你的馅饼应该可以工作

# c# - 我应该使用不同的对象来锁定每个属性吗？

> ID：13592769
> 
> 赞同：5
> 
> 时间：2012-11-27T20:48:21.843
> 
> 标签：c#, multithreading, locking

我有一个类及其属性；对这些属性的访问**非常频繁地**由不同的线程完成。

为每个属性使用相同的对象（用于锁定语句）更有效吗？

```
private readonly object padlock = new object();

private string name;
private int age;

public string Name
{
   get
   {
      lock(padlock)
         return name;
   }

   set
   {
      lock(padlock)
         name = value;
   }
}

public int Age
{
   get
   {
      lock(padlock)
         return age;
   }

   set
   {
      lock(padlock)
         age = value;
   }
} 
```

或者为每个属性使用不同的对象？

```
private readonly object padlockName = new object();
private readonly object padlockAge = new object();

private string name;
private int age;

public string Name
{
   get
   {
      lock(padlockName)
         return name;
   }

   set
   {
      lock(padlockName)
         name = value;
   }
}

public int Age
{
   get
   {
      lock(padlockAge)
         return age;
   }

   set
   {
      lock(padlockAge)
         age = value;
   }
} 
```

第二个版本有意义吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T21:00:56.563

我什至不愿回答您提出的问题，因为我怀疑这些锁定模式中的任何一种都可以确保您的应用程序的正确性。他们不确保对象作为一个整体保持一致的状态——他们只是确保各个属性不会同时更新。换句话说，您已经以迂回的方式实现了原子读写。

例如，假设您有一个操作会增加`Age`. 如果两个不同的线程同时执行此操作，则最终结果可能是 (Age + 1) 或 (Age + 2)。

您很可能应该从对象中删除锁定，并让调用者酌情处理并发问题。一种简单的解决方案是在与对象交互期间锁定整个对象。例如：

```
lock(myObj){
  myObj.Age++;
  myObj.Name = "Bill";
} 
```

**更新**

为了扩展我的中间段落，`Age++`在两个不同线程上运行可能会产生不同结果的原因是因为`++`运算符不是原子的。大致相当于这个。

```
int temp = Age;
temp = temp + 1;
Age = temp; 
```

如果两个线程运行相同的东西，它可以像这样按顺序执行（为了清楚起见，我更改了临时变量的名称）：

```
int temp1 = Age; //thread 1
int temp2 = Age; //thread 2
temp1 = temp1 + 1;  //thread 1
temp2 = temp2 + 1; //thread 2
Age = temp1; //thread 1
Age = temp2; //thread 2 
```

锁定的目的是确保一个线程在另一个线程之前运行整个读-增量-写序列。但是您的锁定方案并没有做到这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T20:57:32.873

请注意，这在很大程度上取决于您的对象是如何被访问的。最终答案将通过衡量您在环境中的表现*并*采取行动以及特定于*您的*域的需求来确定（尽管您似乎在这里担心的是破坏用于支持属性的变量，而不是访问属性集群同时）。

也就是说，您必须平衡以下内容：

*   如果您有一个对象来锁定对对象上*所有*属性的访问，则访问不同属性的多个线程将相互等待完成。

*   如果*每个属性*有一个对象，那么访问不同的属性不会导致锁等待。

但是，我想说在这种情况下它没有实际意义，因为您似乎更担心这里的价值腐败。

[绝大多数类型（不包括多字段值类型）的赋值和读取都是原子的](http://msdn.microsoft.com/en-us/library/aa691278.aspx)，这意味着您不会破坏它们。

也就是说，在上面的示例中，您有一个类型`string`（引用类型）和一个属性的读取和写入`int`，这些操作是原子的，不会被来自多个线程的读取/写入破坏。

# build - VS2012 将 .xml 和 .pdf 从 NuGet 复制到 Release

> ID：13592770
> 
> 赞同：0
> 
> 时间：2012-11-27T20:48:27.427
> 
> 标签：build, visual-studio-2012, nuget

我刚刚开始使用 Visual Studio 2012 和 NuGet，我非常喜欢它。我正在使用的几个包——例如 AutoFac 和 CommonServiceLocator——除了 .dll 之外还有 .xml 和可能的 .pdb 文件。当我构建时，VS2012 将这些文件复制到 RELEASE 构建上的 bin/release - 我得到 .dll、.xml 和 .pdb。这非常适合调试，但我希望它不会在发布时发生。

我确认了项目的构建设置，它们没有生成调试符号。它似乎与我从 NuGet 获得的包有关。

我该如何控制它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T04:10:47.823

发生这种情况是因为包所有者将这些文件作为库文件包含在他们的包定义中。NuGet 允许人们自由地执行此操作，并且您看到的大多数其他行为是 Visual Studio 的默认行为，当 .xml 和 .pdb 文件与引用的程序集位于同一目录时。

您可以就您的疑虑联系包所有者，但正如您推测的那样，在发布之前将它们从站点中删除是安全的。

# javascript - 获取 DIV ID 然后更改 href 值

> ID：13592773
> 
> 赞同：2
> 
> 时间：2012-11-27T20:48:41.500
> 
> 标签：javascript, jquery, html

我有多个使用此 javascript 切换的 div

```
<script language="JavaScript">
    //here you place the ids of every element you want.
    var ids = new Array('a1', 'a2', 'a3', 'a4', 'a5', 'a6', 'a7', 'a8', 'a9', 'a10');

    function switchid(id) {
        hideallids();
        showdiv(id);
    }

    function hideallids() {
        //loop through the array and hide each element by id
        for (var i = 0; i < ids.length; i++) {
            hidediv(ids[i]);
        }
    }

    function hidediv(id) {
        //safe function to hide an element with a specified id
        if (document.getElementById) { // DOM3 = IE5, NS6
            document.getElementById(id).style.display = 'none';
        }
        else {
            if (document.layers) { // Netscape 4
                document.id.display = 'none';
            }
            else { // IE 4
                document.all.id.style.display = 'none';
            }
        }
    }

    function showdiv(id) {
        //safe function to show an element with a specified id
        if (document.getElementById) { // DOM3 = IE5, NS6
            document.getElementById(id).style.display = 'block';
        }
        else {
            if (document.layers) { // Netscape 4
                document.id.display = 'block';
            }
            else { // IE 4
                document.all.id.style.display = 'block';
            }
        }
    }
</script> 
```

然后每个 div 都有一些选项（是、否、继续等）从一个 div 切换到另一个

```
<div id='a1' style="display:block;">
                <div style="border-bottom: 1px solid black;margin-left:  auto; margin-right:  auto;text-align: center;">
                <i>"I'm sorry to hear you have lost your card.  I can cancel the lost card for your proection."</i><br />
                <b>Find the most recent card by checking it's ISSUE date.</b><br /><br />
                </div>
                &nbsp;
                <div style="margin-left:  auto; margin-right:  auto;text-align: center;">
                <span style="color:red;">Has the card been deactivated already?</span><br /><br />
        <a class="spl_btn btn_green" href="javascript:switchid('a2');" onclick="document.getElementById('back').href='javascript:switchid(\'a1\');';"><span><span>Yes</span></span></a>
        <a class="spl_btn btn_pink" href="javascript:switchid('a3');" onclick="document.getElementById('back').href='javascript:switchid(\'a1\');';"><span><span>No</span></span></a>
                </div>
                </div> 
```

然后在切换 div 之外我有一个后退按钮。如果您在选择一个选项时可以从上面看到，它会更改为相应的 div，然后切换后退按钮的 href 值。现在我唯一的问题是我有 2 个 div（数字 3 和 4），它们都有一个选项（在这种情况下没有）导致 5 或 6。这个特定的按钮我在一个 php 变量中像这样

```
<?php echo $addr_update; ?> 
```

然后他们自己的变量像这样工作

```
$project_id = $_GET["project_id"];
switch ($project_id) {
case "al":
    $addr_update = "<a class=\"spl_btn btn_pink\" href=\"javascript:switchid('a5');\"><span><span>No</span></span></a>";
    break; 
```

所以这个按钮有 32 个不同的变量。我希望能够将 onclick 事件添加到可能让它获取其 div id 的变量中，然后相应地更改后退按钮。

例如，您在 div 2 上并按 no，在这种情况下将引导您到 div 5 而不是 div 6。后退按钮需要指向 div 2。因为 div 2 和 div 3 都可以导致 5 或 6根据变量，我不能只添加 onclick 事件来更改后退按钮而不知道用户以前在哪里。

编辑：只是添加一点。如果您单击 DIV 2 上的选项，那么它会将后退按钮设置为 DIV 2。所以在我看来，如果我可以获取 DIV ID 然后将其应用于它的`href="javascript:switchid('a4');"`一部分，它应该很简单。有点像这样：

`<a class="spl_btn btn_green" href="javascript:switchid('a2');" **onclick="document.getElementById('back').href='javascript:switchid(\'a1\');'; Some sort of function that would grab the containing divs id and then put it in the .href value of the document.getElement part**"><span><span>Yes</span></span></a>`

希望这是有道理的，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T20:56:22.520

您可以在 div 上使用 data-attributes 来了解点击的位置：

```
<div id="div1" data-on-yes="div2" data-on-no="div3"></div> 
```

等等。

在您的脚本中，您可以读取该属性

```
document.getElementById('div1').getAttribute('data-on-yes') 
```

希望对您有所帮助，您的问题有点令人困惑；-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T21:59:51.253

除了数据属性，您还可以跟踪当前和上一个 id

```
<script type="text/javascript">
    //here you place the ids of every element you want.
    var ids = ['a1', 'a2', 'a3', 'a4', 'a5', 'a6', 'a7', 'a8', 'a9', 'a10'];

    function switchid(id) {
        if(id === current) {return;}
        hideallids();
        showdiv(id);
        current = id;
    }

    //previous and current id;
    var prev, current;

    function switchNext() {
        var next = this.getAttribute("data-next-id"); //get next id from data-attr
        prev = this.parentNode.parentNode.id; //get parent div's id
        switchid(next);
    }

    function switchPrev() { //For back link
        if(!prev) {return;}
        var curr = current; //store current id
        switchid(prev); //switch to what was previous
        prev = curr; //set prev to what was current. Not sure if you need this
    }

    function hideallids() {
        //loop through the array and hide each element by id
        for (var i = 0; i < ids.length; i++) {
            hidediv(ids[i]);
        }
    }

    function hidediv(id) {
        document.getElementById(id).style.display = 'none';
    }

    function showdiv(id) {
        document.getElementById(id).style.display = 'block';
    }
</script> 
```

标记

```
<div id='a1' style="display:block;">
                <div style="border-bottom: 1px solid black;margin-left:  auto; margin-right:  auto;text-align: center;">
                <i>"I'm sorry to hear you have lost your card.  I can cancel the lost card for your proection."</i><br />
                <b>Find the most recent card by checking it's ISSUE date.</b><br /><br />
                </div>
                &nbsp;
                <div style="margin-left:  auto; margin-right:  auto;text-align: center;">
                <span style="color:red;">Has the card been deactivated already?</span><br /><br />
        <a class="spl_btn btn_green" data-next-id="a2" href="#" onclick="switchNext.call(this);"><span><span>Yes</span></span></a>
        <a class="spl_btn btn_pink" data-next-id="a3" href="#" onclick="switchNext.call(this);"><span><span>No</span></span></a>
                </div>
                </div> 
```

对于后退按钮

```
 <a id="back" onclick="switchPrev.call(this);" href="#">Back</a> 
```

# objective-c - UIScrollView：更准确/精确的 contentOffset 值？

> ID：13592780
> 
> 赞同：3
> 
> 时间：2012-11-27T20:48:58.717
> 
> 标签：objective-c, ios, uiscrollview, contentoffset

我想知道是否有任何方法`contentOffset`可以获得更准确`contentOffset`的 当我的变化率非常小时，我试图执行一个动作，但是 0.5f 不够精确。`contentOffset``UIScrollView``contentOffset``UIScrollView`

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T22:18:45.203

您无法获得比`contentOffset`. 您可以使用常规`ds/dt`方程计算速度：

```
- (void)scrollViewDidScroll:(UIScrollView *)scrollView
{
    static CGFloat prevPos = 0.0; //you can store those in iVars
    static NSTimeInterval prevTime = 0.0;

    CGFloat newPos = scrollView.contentOffset.y;
    NSTimeInterval newTime = [NSDate timeIntervalSinceReferenceDate];

    double v = (newPos - prevPos)/(newTime - prevTime);

    prevPos = newPos;
    prevTime = newTime;
} 
```

但是，如果您感觉非常hacky，并且希望您的代码**不安全**，您可以`UIScrollView`使用此类别直接查看 的velocity iVars

```
@interface UIScrollView(UnsafeVelocity)
- (double) unsafeVerticalVelocty;
@end

@implementation UIScrollView(UnsafeVelocity)

- (double) unsafeVerticalVelocty
{
    double returnValue = 0.0;
    id verticalVel = nil;

    @try {
        verticalVel = [self valueForKey:@"_verticalVelocity"];
    }
    @catch (NSException *exception) {
        NSLog(@"KVC peek failed!");
    }
    @finally {
        if ([verticalVel isKindOfClass:[NSNumber class]]) {
            returnValue = [verticalVel doubleValue];
        }
    }

    return returnValue;
}

@end 
```

要获得水平速度，请替换`_verticalVelocity`为`_horizontalVelocity`. 请注意，您将获得的值似乎以不同的方式缩放。我再重复一遍：虽然这（可能）是你能获得的最佳速度值，但它非常脆弱，而且不能保证未来的发展。

# jsf - 需要让HashMap在一个键中添加（总和）多个值

> ID：13592781
> 
> 赞同：0
> 
> 时间：2012-11-27T20:49:00.470
> 
> 标签：jsf, hashmap, addition

我试图让一个按钮在同一个输入框中处理多个输入。我有 16 个输入框，每个输入框都有自己的 id# (YfProduct)，我将其用作我的 hashmap 的键。对于输入值，我有权重。用户将在他们希望的任意多个输入框中输入他们想要的任何双倍权重，然后单击一个按钮（a4j:commandButton）来激活下面的方法。

```
private HashMap<Integer, Double> storeWeight = new HashMap<Integer, Double>(); 

public void storeWeight(Yieldfl yieldfl){
    for (YieldItem row : yielditem) {
    storeWeight.put(row.getYfProduct(), row.getWeight());
    System.out.print(storeWeigt)}
} 
```

现在，此代码将使用右键设置适当的值，并用输入的新输入替换这些值并单击另一个按钮。但是，我要做的是让 bean 保存以前的值，并将输入的下一个值与具有相同键的上一个条目相加。因此，在用户输入结束时，HashMap 将包含 16 个键，每个键的各个值的总和相加。如果没有一些严肃的硬编码，我无法想出一种方法来做到这一点。非常感谢帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T22:11:39.167

所以这实际上是一个简单的解决方案，我将把解决方案放在这里，以防有人遇到类似的问题。这是我第一次使用 HashMap，所以我请了一位同事帮助我。我需要该值来调用密钥。

```
storeWeight.put(row.getYfProduct(), storeWeight.get(row.getYfProduct() + (row.getWeight())); 
```

并避免空指针：

```
public void storeWeight(Yieldfl yieldfl){
    for (YieldItem row : yielditem) {
        Double oldValue = storeWeight.get(row.getYfProduct());
        if (oldValue == null)
            oldValue = 0.0;
    storeWeight.put(row.getYfProduct(), oldValue + (row.getWeight()));
    row.setWeight(0.0);
    System.out.print(storeWeight);}
} 
```

# java - Java：同步套接字输入

> ID：13592783
> 
> 赞同：1
> 
> 时间：2012-11-27T20:49:09.417
> 
> 标签：java, php, multithreading, sockets, synchronize

我第一次尝试为 php 套接字服务器编写客户端，但遇到了一些麻烦，我有点被信息淹没了！

对于服务器，我们需要一个打开的连接，我希望我的客户端等到它接收到数据后再通知线程开始解析输入流。这是否可以在不使用循环的情况下实现？我宁愿能够调用 lock.notify()。

我也在看 NIO，这是我想要的可行选择吗？这是我到目前为止的代码，但同样，我只是想避免 for(;;) 甚至可能将接收到的消息排队，因为它们很可能只是 JSON

```
 Thread serverRecieve = new Thread(new Runnable() {
    @Override
    public void run() {
        try {
            for (;;) {
                if (in != null) {
                    String line;
                    while ((line = in.readLine()) != null) {
                        sout(line);
                    }
                } else {
                    sout("inputstream is null! Waiting for a second to test again");
                }
                try {
                    Thread.sleep(1000);
                } catch (InterruptedException ex) {
                    Logger.getLogger(WebManager.class.getName()).log(Level.SEVERE, null, ex);
                }
            }
        } catch (IOException ex) {
            Logger.getLogger(WebManager.class.getName()).log(Level.SEVERE, null, ex);
        }
    }
}); 
```

多谢你们！PS：我确实在这里查看了很多套接字线程，但决定问我需要什么会更容易。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T21:07:50.827

我认为您可以使用`while`循环并使用`in != null`as 设置条件：

```
 while(in == null){
       //wait for a second before checking the in stream again
       try {
            sout("inputstream is null! Waiting for a second to test again");
            Thread.sleep(1000);
       } catch (InterruptedException ex) {
          Logger.getLogger(WebManager.class.getName()).log(Level.SEVERE, null, ex);
       }    
    }

     //now your in is available. Read the data and proceed
     String line = null;
     while ((line = in.readLine()) != null) {
          sout(line);
     } 
```

`while`一旦`in`流可用，第一个循环将终止。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T21:31:25.377

如何创建`Runnable`用于从套接字读取的专用子类型，如下所示：

```
class Reader implements Runnable {

    private final Socket socket;
    private volatile boolean stopped;

    Reader(Socket socket) {
        this.socket = socket;
    }

    @Override
    public void run() {
        try {
            while (true) {
                int in = socket.getInputStream().read();
                // process in here
            }
        } catch (IOException e) {
            e.printStackTrace();
        } finally {
            try {
                if (!stopped) socket.close();
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
    }

    public void stop() {
        try {
            stopped = true;
            socket.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}

class Client {
    private volatile Reader reader;
    void start() {
        reader = new Reader(new Socket(serverHost, serverPort));
        Thread readerThread = new Thread(reader, "Reader-thread");
        readerThread.start();
    }
    void stop() {
        Reader reader = this.reader;
        // reader.stop() will close socket making `run()` method finish because of IOException
        // reader.socket is final, thus we have proper visibility of it's values across threads
        if (reader != null) reader.stop();
    }
} 
```

# python - 有没有办法使用 makefile 从 python 脚本生成可执行文件？

> ID：13592785
> 
> 赞同：0
> 
> 时间：2012-11-27T20:49:13.400
> 
> 标签：python, makefile

我有一个 python 脚本“MAlice.py”（main），它依赖于其他几个脚本，包括 yacc.py 和 lex.py 以及它们依次导入的任何内容。

我没有很多编写makefile的经验，我想知道如何使用此代码生成一个名为“compile”的可执行文件，以便有人可以调用：

```
make
./compile "someTestFile.alice" 
```

我在 Ubuntu 工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T21:10:12.767

我认为您正在寻找一种将您的 python 项目打包成一个独立的可执行文件的方法。它不是编译过程，而只是捆绑到可移植环境中。这将包括您的 python 解释器。

您可以查看 pyinstaller for linux 或 windows。和用于 osx 的 py2app（pyinstaller 也可以在 osx 上工作，只创建一个文件）

如果您所追求的是能够向某人提供源代码包并让他们能够运行构建命令，并拥有一个名为“compile”的可执行入口点，那么您想要的只是一个 setuptools 脚本。这将安装所有声明的依赖项，并将创建您定义的任何命名入口点。

[http://packages.python.org/an_example_pypi_project/setuptools.html](http://packages.python.org/an_example_pypi_project/setuptools.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T21:04:31.647

不编译 Python 脚本；他们被解释了。您可以通过将其添加为*第一行将*`MAlice.py`其自身变成可执行脚本：

 *```
#!/usr/bin/env python 
```

并使脚本可执行：

```
chmod a+x MAlice.py 
```

那么你可以像这样简单地运行它：

```
./MAlice.py "someTestFile.alice" 
```*

# sql - 我应该在 SQL Server 中使用 OR 语句还是 LIKE 语句？

> ID：13592786
> 
> 赞同：1
> 
> 时间：2012-11-27T20:49:14.567
> 
> 标签：sql, sql-server

我有一个查询，我正在做`INNER JOIN`几个子查询。在这个查询中，我使用了一个类似的`WHERE`子句，它有一个`LIKE`语句；`WHERE bookName LIKE '%INTERVIEWS%'`.

但是大约有五种不同的变体，`bookName`其中包含“INTERVIEWS”一词。那么，如果我`OR`为每个变体都做一个`LIKE`语句，或者我应该为所有变体做一个语句，查询的性能会更好吗？

- - - - - - - - - 编辑 - - - - - - - - -

`LIKE`以下是仅使用语句的查询的示例：

```
SELECT 
   *
FROM 
   books
WHERE
   bookName LIKE '%INTERVIEWS%'; 
```

以下是使用语句查询的示例`OR`：

```
SELECT 
   *
FROM 
   books
WHERE
   bookName = 'INTERVIEWS WITH CELEBRITIES'
   OR
   bookName = 'ONGOING INTERVIEWS WITH STUDENTS'
   OR
   bookName = 'POLITICIAN INTERVIEWS'
   OR
   bookName = 'INTERVIEWS WHICH FAILED'
   OR
   bookName = 'INTERVIEWS WITH PROGRAMMERS'; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T22:45:57.297

有多个方面需要考虑：

*   您没有`index`关于 bookName 列：在此无关紧要的上下文中，查询将通过执行聚集索引扫描或表扫描以相同的方式执行。
*   你`non clustered index`在 bookName 列上 有一个
    *   这是一个`non covering index`（场景 1）：在带有语句的第二个用例中`OR`，您可能会遇到`index tipping point`，查询优化器将决定**不**使用`non clustered index`. 在这种情况下`LIKE`，使用索引扫描会表现得更好。[在Kimberly Tripp 的博客](http://www.sqlskills.com/BLOGS/KIMBERLY/category/The-Tipping-Point.aspx)上阅读更多内容。
    *   这是一个`covering index`（场景 2）：覆盖索引没有临界点。在这种情况下，第二个查询将通过使用`index seek`where`LIKE`查询仍然必须执行`Index Scan`.

因此，如果性能很关键，请使用覆盖索引

以下是使用[Adventure Works的详细信息](http://msftdbprodsamples.codeplex.com/releases/view/93587)

方案 1

```
SELECT  *
FROM    Production.Product AS p
WHERE   Name LIKE '%mountain seat%'

SELECT  *
FROM    Production.Product AS p
WHERE   Name = 'LL Mountain Seat Assembly'
        OR Name = 'ML Mountain Seat Assembly'
        OR Name = 'HL Mountain Seat Assembly'
        OR Name = 'LL Mountain Seat/Saddle'
        OR Name = 'ML Mountain Seat/Saddle'
        OR Name = 'HL Mountain Seat/Saddle' 
```

![在此处输入图像描述](../Images/05c81897c0a729dd7f5ff5582e9d7400.png)

方案 2

```
SELECT  Name
FROM    Production.Product AS p
WHERE   Name LIKE '%mountain seat%'

SELECT  Name
FROM    Production.Product
WHERE   Name = 'LL Mountain Seat Assembly'
        OR Name = 'ML Mountain Seat Assembly'
        OR Name = 'HL Mountain Seat Assembly'
        OR Name = 'LL Mountain Seat/Saddle'
        OR Name = 'ML Mountain Seat/Saddle'
        OR Name = 'HL Mountain Seat/Saddle' 
```

![在此处输入图像描述](../Images/f1428cc87e139186b74ce957fb3e0a76.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T20:55:06.027

由于您是从性能角度询问 - 其他选择（例如包含和自由文本）可能会表现更好。请参阅[http://msdn.microsoft.com/en-us/library/ms187787.aspx](http://msdn.microsoft.com/en-us/library/ms187787.aspx)和[http://msdn.microsoft.com/en-us/library/ms176078.aspx](http://msdn.microsoft.com/en-us/library/ms176078.aspx)。

假设您正在开发的场景是用户搜索页面，自由文本可能是 SQL Server 开箱即用的更好选择，因为它支持词干（即在采访中的搜索将包括采访、采访、采访者等） . 除其他外，它还支持词库匹配。

还有其他非 SQL Server 选项可以使用，但入门门槛更高，例如 Lucene/SOLR。

编辑：开始使用 contains 和 freetext（或 containstable 和 freetexttable）需要您在数据库中启用全文索引。有关一些入门信息，请参阅[http://technet.microsoft.com/en-us/library/ms142497.aspx 。](http://technet.microsoft.com/en-us/library/ms142497.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T21:22:30.283

如果 bookName 列被索引并且表有大量列，那么第二个选项肯定会运行得更快，因为它将是 ab 索引扫描而不是表扫描。如果没有索引，那么它们将大致相同，因为它们都需要表扫描。

至于添加全文索引的想法，最好是长列的文本，而不是像这样的短名称。如果您需要性能并进行一系列完全匹配，我会坚持为该列编制索引。

# apache - Tortoise SVN 重定向循环 [CENTOS 5.8 / WHM]

> ID：13592789
> 
> 赞同：3
> 
> 时间：2012-11-27T20:49:25.257
> 
> 标签：apache, svn, tortoisesvn, centos, whm

希望有人可以在这里传播一些大师知识，因为我们一直在绞尽脑汁试图找出导致此错误的原因。

我们在 CENTOS 5.8 上运行 WHM/CPanel

我们有一个专门设置为服务器的子域作为 svn 存储库。我们已经创建了 VirtualHost 目录和配置文件。配置文件如下所示：

```
<IfModule mod_dav_svn.c>
 <Location />
  DAV svn
  SVNParentPath /home/<username>/public_html/svn
  SVNListParentPath On
  AuthType Basic
  AuthName "SVN Repo"
  AuthUserFile /home/<username>/.svn.htpasswd
  Require valid-user
 </Location>
</IfModule> 
```

我们使用 SVNParentPath 因为我们将有多个存储库。

我们的 repo 是使用 svnadmin create 创建的

当我们在浏览器中导航到它们时，它们显示得很好。我们可以看到顶级文件夹。当我们点击它们时，我们看到的只是修订号。我很确定这是正常的。

在 Tortoise 中，我们连接到 repo，例如：[http ://svn.ourserver.com/reponame](http://svn.ourserver.com/reponame)

我们已经浏览了我们能想到的所有论坛帖子，但无法通过重定向周期。任何知识将不胜感激。

*编辑* 我应该补充一点，我们正在获取身份验证窗口，所以我相信该部分设置正确。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T16:36:33.083

事实证明，我认为这更多的是对 svn 的设置方式以及 tortoiseSVN 需要如何访问它的误解。Tortoise 无法签出多个项目（我们知道。）我们忽略了创建存储库与创建项目不同。

一旦我们将 svn.mydomain.com 转换为 repo 本身，并在其中创建了一个项目，我们就可以毫无错误地检查它。

我要感谢所有试图提供帮助的人。我真的很感谢你的时间。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T22:45:15.027

*   站点根目录中的 repo 位置可能会在以后产生很大的不良影响（如果您在 ROOT 下有站点的非 dav 部分）
*   `SVNParentPath /home/<username>/public_html/svn/`（**斜杠**）会更好，不记得为什么

# php - html5地理位置到php变量

> ID：13592790
> 
> 赞同：0
> 
> 时间：2012-11-27T20:49:27.843
> 
> 标签：php, html, location

如何使用 HTML5 从 android 手机获取当前位置并将其分配给 $lat 和 $lon 等 php 变量？我有这样的代码，但我该如何使用它？

```
if(navigator.geolocation)
{
  navigator.geolocation.getCurrentPosition(function(position)
  {
  var lat = position.coords.latitude;
  var lng = position.coords.longitude;
  doSomething();

  });
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T20:51:54.737

JavaScript 是严格的客户端。您需要使用某种回发方式——AJAX 是为此选择的武器。从那里，将其存储在您为用户使用的任何会话中，瞧，工作完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T20:57:43.057

使用 AJAX 将坐标发送到 PHP 处理程序函数，以便您可以将它们存储在您想要的任何位置（数据库、会话等），并使处理程序将值发送到您的函数。

我建议使用处理函数，因为这是我的做事风格，但您可以直接将数据发送到您的函数。

此外，您可以选择时间触发的事件，例如每 5 秒发送一次数据或用户事件，从那里没有限制。

# c - 使用 getchar() while 循环；但是，结果有点奇怪

> ID：13592796
> 
> 赞同：2
> 
> 时间：2012-11-27T20:49:43.170
> 
> 标签：c

我正在学习“C 编程语言”（K&R），并进行了一项练习。练习是打印直到 EOF 之前的空格、制表符和换行符的数量。太好了，这行得通。但是，我开始变得聪明，并添加了您在下面看到的 printf()，实际上是“空格”或“制表符”或“换行符”。它*应该*在我输入时打印出来，但是，while 循环似乎只在我按 Enter 时运行。

编码：

```
#include <stdio.h>

int main(int argc, const char * argv[])
{

    int c, nb, nt, nl;

    nb = nt = nl = 0;

    while ((c = getchar()) != EOF) {
        if (c == ' ') {
            nb += 1;
            printf("Space\n");
        }
        if (c == '\t') {
            nt += 1;
            printf("Tab\n");
        }
        if (c == '\n') {
            nl += 1;
            printf("New Line\n");
        }

    }

    printf("%d spaces, %d tabs, %d newlines",nb,nt,nl);

    return 0;
} 
```

输出：

```
a b
Space
New Line
c d e
Space
Space
New Line
f   g
Tab
New Line
3 spaces, 1 tabs, 3 newlines 
```

我期望看到的是更像这样的东西：

```
a Spaceb
New Line
c Spaced Spacee
New Line
f   tabg
New Line
3 spaces, 1 tabs, 3 newlines 
```

那么，为什么我得到的是我得到的，而不是我所期望的？

而且，是的，如果我真的很关心，我会用“空格[s]”、“制表符[s]”和“换行符[s]”复数而不是基于值，但这只是一个练习. ;)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T20:54:02.613

您的终端处于规范模式 - 字符会累积到行尾。只有这样它们才会发送给用户（一个接一个）。

如果要立即响应，则必须将终端切换到原始模式。

PS。或多或少，像这样：

```
struct termios t;

tcgetattr (0, &t);

t.c_lflag &= ~ICANON;
t.c_cc [VMIN] = 1;
t.c_cc [VTIME] = 0;

tcsetattr (0, TCSANOW, &t); 
```

# node.js - 如何在猫鼬中构建多对多关系？

> ID：13592801
> 
> 赞同：1
> 
> 时间：2012-11-27T20:49:48.753
> 
> 标签：node.js, mongodb, mongoose

在我的应用程序中，用户有事件和组 - 事件可以（但不需要）属于组。我对非关系数据库还是新手，所以我想知道最佳实践来优化结构。

```
 var user = new mongoose.Schema({
        name: { type: String },
        events: [event],
        groups: [group]
    });

    var group = new mongoose.Schema({
        name: { type: String }
    }); 
```

这就是我感到困惑的地方。

```
 var event = new mongoose.Schema({
        name: { type: String }
        groups: ????
    }); 
```

我是否只保留一个引用组 ID 的数组？

如果我这样做，我将如何按组查找事件？

如果删除了一个组，我是否必须遍历每个事件才能删除引用？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T23:33:07.407

在 mongodb 中，您有两种选择。嵌入（子文档）与链接（另一个集合）

**嵌入与链接** 每种方法各有利弊。

**嵌入：** 您将其嵌套在文档中。

例如，您的文档可能看起来像

```
{
    name : 'name',
    events: [a,b,c],
    groups: [1,2,3]
} 
```

*   你会得到原子性，因为只涉及一个集合。
*   但是，值可能会重复

**链接**

在这里，您使用一种外键链接。[参考文档](http://docs.mongodb.org/master/single/index.html#document-references)

一个集合中的文档将引用另一个集合中的文档。**缺点**是你失去了原子操作。但是，您消除了重复。

如果要更新组和更新事件，并且它们位于不同的集合中，则必须自己处理原子更新。Mongodb 不会为您保证。

# jquery - 单击菜单时，jquery .click 功能不会触发

> ID：13592803
> 
> 赞同：0
> 
> 时间：2012-11-27T20:49:58.090
> 
> 标签：jquery, asp.net, function, menu

我正在使用 jquery.click 在我的 aspx 页面中使用菜单。在我的 asp.net 页面中。

如果页面不包含参数（例如“mypage.aspx”）点击功能可以正常工作并且我的菜单打开，但是当我打开带有参数的页面（例如“mypage.aspx?id=3）时，在页面中，我的点击功能没有'不起作用，菜单未打开。

这是我的 jquery.click 函数：

```
// Show menu
$("a.showMenu").click(function () {
    if (menuStatus != true) {
        $(".ui-page-active").animate({
            marginLeft: "165px",
        }, 300, function () {
            menuStatus = true
        });
        return false;
    } else {
        $(".ui-page-active").animate({
            marginLeft: "0px",
        }, 300, function () {
            menuStatus = false
        });
        return false;
    }
}); 
```

这是我在 mypage.aspx 中的 html 代码（打开菜单）

```
<a href="#" class="showMenu"><img src="images/icon-menu.png" alt="Menu" border="0" /></a> 
```

我能怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T20:55:56.317

这是一个很好的测试，只是为了看看 jQuery 是否工作：

```
// Show menu
$("a.showMenu").click(function () {
    alert('I am here'); // <---
    if (menuStatus != true) {
        $(".ui-page-active").animate({
            marginLeft: "165px",
        }, 300, function () {
            menuStatus = true
        });
        return false;
    } else {
        $(".ui-page-active").animate({
            marginLeft: "0px",
        }, 300, function () {
            menuStatus = false
        });
        return false;
    }
}); 
```

如果没有，那么您是否引用了 jQuery.js 文件？就像是：

```
 <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T21:05:22.857

正如评论所提到的；`menuStatus`是关键。最初设置在哪里？

我为你创建了一个 jsFiddle。我只是使用文本而不是您的图像，但它应该有所帮助。请注意，我正在初始化`menuStatus`为 false。

[jsFiddle在这里](http://jsfiddle.net/vbGRQ/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T21:09:12.830

我测试了你的代码并且它有效。我不确定你的问题在哪里。

[在这个提琴手中，我测试了你的代码并且它有效](http://jsfiddle.net/jupaol/vYZNR/2/)

[在这个提琴手中，我删除了`menuStatus`标志](http://jsfiddle.net/jupaol/5dPXv/)

为了删除`menuStatus`标志，我将`click`函数更改为：`toggle`

如果您可以更具体地了解您的错误，则更容易检测到问题

快乐编码！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-28T08:59:30.650

谢谢大家，但我自己找到了解决方案。

问题是，我在哪里创建了发送链接。

我的旧代码是：

```
 <a href="mypage.aspx?id=3" >Go to My Page</a> » 
```

我添加了 rel="external" 并且我的菜单每次都有效！

```
 <a href="mypage.aspx?id=3" rel="external">Go to My Page</a> » 
```

不管怎么说，还是要谢谢你！

# ruby-on-rails - 隐藏布尔表单字段

> ID：13592806
> 
> 赞同：3
> 
> 时间：2012-11-27T20:50:19.053
> 
> 标签：ruby-on-rails, simple-form, hidden-field

我有一个布尔值可以将评论设为公开或私有。

布尔值是提交中的一列，我现在以一种笨拙的方式工作，想从表单中删除复选框，替换为隐藏字段，以便用户看到的只是提交按钮，有条件的基于布尔状态：

提交#显示：

```
<% if @submission.comment_show == true %>
    <%= render "hide_comment_form" %>
    <%= render "comments/comment" %>
 <% else %>
    <%= render "show_comment_form" %>
 </div>
 <% end %> 
```

_show_comment_form

```
<%= simple_form_for [@contest, @submission] do |f| %>
   <div>
     <%= f.input :comment_show, label: false %>
     <%= hidden_field_tag :contest_id, @contest.id %>
         <%= f.submit "Make Comments Public", :class => 'btn btn-mini' %>
   </div>
 <% end %> 
```

_hide_comment_form

```
 <%= simple_form_for [@contest, @submission] do |f| %>
       <div class ="">
      <%= f.input :comment_show, label: false %>
      <%= hidden_field_tag :contest_id, @contest.id %>
      <%= f.submit "Make Comments Private", :class => 'btn btn-mini' %>
    </div>
 <% end %> 
```

我试过 hidden_​​field_tag，但没有任何运气让它工作。

另外，我看到了一些更高级的方法和路由来完成同样的事情： [http ://buckybits.blogspot.com/2011/09/simple-ajax-property-toggle-in-rails-30.html](http://buckybits.blogspot.com/2011/09/simple-ajax-property-toggle-in-rails-30.html)

但我更喜欢使用隐藏字段和条件来保持简单。

是否可以使用隐藏字段在表单中设置布尔值，还是必须使用自定义方法和路由？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T21:16:51.730

请参阅此 SO 问题的答案： [rails simple_form - hidden field - create?](https://stackoverflow.com/questions/5371480/rails-simple-form-how-do-i-create-a-hidden-field)

由于您使用的是简单表单，因此您可以执行以下操作：

```
 f.input :contest_id, :as => :hidden, :input_html => { :value => @contest.id } 
```

# c# - 安装 Azure 1.8 后出现客户端版本错误

> ID：13592807
> 
> 赞同：2
> 
> 时间：2012-11-27T20:50:21.533
> 
> 标签：c#, asp.net, windows, azure

我最近在我的机器上安装了 Azure SDK 1.8，但仍在使用运行 1.7.1 版的项目（VS2012 的 2012 年 6 月 SP1）。因为我这样做了，每次我尝试运行我的项目时，我都会收到以下错误：

```
 ErrorCode<ERRCA0019>:SubStatus<ES0001>:Check the client version. It should be within the allowed version range on the server. If necessary, upgrade the client to the allowed version.

[DataCacheException: ErrorCode<ERRCA0019>:SubStatus<ES0001>:Check the client version. It should be within the allowed version range on the server. If necessary, upgrade the client to the allowed version.]
   Microsoft.ApplicationServer.Caching.DataCache.ThrowException(ErrStatus errStatus, Guid trackingId, Exception responseException, Byte[][] payload, EndpointID destination) +767
   Microsoft.ApplicationServer.Caching.DataCache.ThrowException(ResponseBody respBody, EndpointID destination) +149
   Microsoft.ApplicationServer.Caching.DataCacheFactory.EstablishConnection(IEnumerable`1 servers, RequestBody request, Func`3 sendMessageDelegate, DataCacheReadyRetryPolicy retryPolicy) +967
   Microsoft.ApplicationServer.Caching.WcfClientProtocol.Initialize(IEnumerable`1 servers) +606
   Microsoft.ApplicationServer.Caching.DataCacheFactory.GetCache(String cacheName, CreateNewCacheDelegate cacheCreationDelegate, DataCacheInitializationViaCopyDelegate initializeDelegate) +1103
   Microsoft.ApplicationServer.Caching.DataCacheFactory.GetCache(String cacheName) +131
   Microsoft.Web.DistributedCache.DataCacheFactoryWrapper.CreateDataCacheFromFactory(DataCacheFactory factory, String cacheName) +63
   Microsoft.Web.DistributedCache.CacheHelpers.RunCacheCreationHooks(CacheConnectingEventArgs fetchingEventArgs, IDataCacheFactory dataCacheFactory, Object sender, EventHandler`1 fetchingHandler, EventHandler`1 fetchedHandler) +356
   Microsoft.Web.DistributedCache.DistributedCacheSessionStateStoreProvider.CreateInternalProvider(IHttpRuntime httpRuntime, SessionInitializationData initData, IDataCacheFactory dataCacheFactory, EventHandler`1 cacheFetching, EventHandler`1 cacheFetched) +447
   Microsoft.Web.DistributedCache.DistributedCacheSessionStateStoreProvider.GetInternalProvider() +315
   Microsoft.Web.DistributedCache.DistributedCacheSessionStateStoreProvider.ResetItemTimeout(HttpContext context, String id) +59
   System.Web.SessionState.SessionStateModule.BeginAcquireState(Object source, EventArgs e, AsyncCallback cb, Object extraData) +707
   System.Web.AsyncEventExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute() +12600474
   System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) +288 
```

我没有太多运气找到解决方案。一些论坛提到使用不同的 AppFabric 版本，但他们似乎都指的是在实际的 Azure 云服务中运行它，我什至无法让它在我的本地机器上运行。

有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T21:14:32.027

我在升级到 2012 年 10 月版本时遇到了类似的问题。我通过删除项目中的所有缓存引用，然后[从 NuGet 安装 Windows Azure 共享缓存包来](http://nuget.org/packages/WindowsAzure.Caching/)解决它。

我不确定生成的项目是否仍将使用 2012 年 6 月的 SDK 运行。但值得一试。

# amazon-s3 - Amazon SQS 队列：从队列中获取响应

> ID：13592813
> 
> 赞同：4
> 
> 时间：2012-11-27T20:50:49.977
> 
> 标签：amazon-s3, amazon-web-services, amazon-sqs

**图像处理系统。**

用户将照片上传到 S3。图像处理应用程序从 S3 获取照片并开始对其进行处理并返回输出。

**处理：** Webserver 正在向队列发送带有图像信息的 SQS 消息，图像处理服务器获取 SQS 消息并开始处理该图像。图像处理完成后，它将图像上传回 S3 并将 SQS 消息返回到队列。图像处理引擎位于 EC2 服务器上。

这是一个问题：网络服务器如何从图像处理服务器发送的队列中获取返回的 SQS 消息？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-27T21:19:48.700

不要将图像处理视为远程过程调用，其中有请求和响应——将其视为分布式系统中不同组件执行的一系列任务。用两个队列解决这个问题：`uploaded-images`和`processed-images`。

Web 服务器接受图像，将其放入 S3 中，并向`uploaded-images`队列发送一条消息，表明需要对其进行处理。

您的图像处理 EC2 实例等待消息到达`uploaded-images`队列，然后从 S3 检索图像，进行一些处理，并将结果放入 S3。然后他们向`processed-images`队列发送一条消息，表明图像已被处理。

您的 Web 服务器会轮询`processed-images`，并在处理完图像后执行它们需要做的任何事情：更新数据库、在短期缓存中设置一个条目以指示图像已完成处理等。

# sql - ORA-00913: 将 wm_concat 字符串插入表中的值过多

> ID：13592816
> 
> 赞同：0
> 
> 时间：2012-11-27T20:51:03.220
> 
> 标签：sql, oracle, plsql, ora-00913

当我使用 wm_concat 将几个元组连接成一个元组时。

例如

ID 项目
1 '苹果'
2 '桃子'
2 '香蕉'

```
 declare 
  v_name_l: varchar(100);
  v_name_b: varchar(100);
begin
     select wm_concat(Items) into v_name_l from Item group by ID having count(*)=1;
     select wm_concat(Items) into v_name_b from Item group by ID having count(*)=2;
     execute immediate ('Insert into  apr values('||v_name_l||','||v_name_b||')');
end; 
```

另一个表 apr 结构是
Name1 Name2

name1 和 nam2 是 varchar(100)；

有一个错误引发

```
*execute immediate execute immediate ('Insert into  apr values('||v_name_l||','||v_name_b||')')"

   ORA-00913: too many values 
```

我认为 wm_concat 将多行连接到一个字符串中；
我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T21:40:29.483

I think nothing wrong with wm_concat queries. You just need to escape quotes. Because you are referencing your query as string in this case lets say:

**v_name_l** is *`'apple, peach, banana'`* and **v_name_b** is '`x, y, z`'

So when you define as current query:

```
Insert into  apr values('||v_name_l||','||v_name_b||') 
```

Oracle translates to:

***Insert into apr values(apple, peach, banana, x, y, z)***

And database recognize every comma separated value as a column but the table has just two column instead of 6\. If you escape quotes:

```
Insert into  apr values('''||v_name_l||''','''||v_name_b||'''); 
```

then oracle will read like:

***Insert into apr values('apple, peach, banana', 'x, y, z');***

I hope that was the reason:)

# infragistics - AddNewRecord XamDataGrid

> ID：13592818
> 
> 赞同：2
> 
> 时间：2012-11-27T20:51:10.867
> 
> 标签：infragistics, xamdatagrid

在 AddNewRecord 行中输入值后，单击 XamDataGrid 上该行之外的任意位置似乎将该行添加到集合中。

如何防止鼠标单击将新行添加到集合中。

请提供任何帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T20:56:07.560

在 AddNewRecord 之外单击会结束记录的编辑模式，如果有更改，那么此时会提交更改，这意味着添加了新记录。如果您希望仅在按下回车键时允许提交记录，而不是通过单击网格中的另一条记录，那么您可以使用以下逻辑将鼠标左键设置为已处理：

```
private bool editingAddNewRecord = false;
void XamDataGrid1_EditModeEnded(object sender, Infragistics.Windows.DataPresenter.Events.EditModeEndedEventArgs e)
{
    this.editingAddNewRecord = false;
}

void XamDataGrid1_EditModeStarted(object sender, Infragistics.Windows.DataPresenter.Events.EditModeStartedEventArgs e)
{
    this.editingAddNewRecord = e.Cell.Record.IsAddRecord;
}

void XamDataGrid1_PreviewMouseLeftButtonDown(object sender, MouseButtonEventArgs e)
{
    if (editingAddNewRecord)
    {
        DataRecordPresenter drp = Infragistics.Windows.Utilities.GetAncestorFromType(e.OriginalSource as DependencyObject, typeof(DataRecordPresenter), true) as DataRecordPresenter;
        if (!(drp != null && drp.IsAddRecord))
        {
            e.Handled = true;
        }
    }           
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-05T22:17:24.623

感谢@alhalama的回答！

我注意到尽管您没有处理鼠标右键，即使我们执行您的解决方案也无法支持它。此外，使用您的解决方案，我无法编辑任何其他单元格，直到我在 Add New Row 记录上按 Enter 或 Escape （这可能是某些人想要的，但不是我）。这是我修改后的解决方案，当用户单击它时撤消对“添加新记录”行的单元格的更改，它还处理所有鼠标单击（左、右、中等）。

```
// Used to record when the user is editing a value in the Mass Edit row.
private DataRecord _addRecordCellBeingEdited = null;

private void XamDataGrid1_EditModeStarted(object sender, Infragistics.Windows.DataPresenter.Events.EditModeStartedEventArgs e)
{
    if (e.Cell.Record.IsAddRecord)
        _addRecordCellBeingEdited = e.Cell.Record;
}

private void XamDataGrid1_EditModeEnded(object sender, Infragistics.Windows.DataPresenter.Events.EditModeEndedEventArgs e)
{
    _addRecordCellBeingEdited = null;
}

private void XamDataGrid1_PreviewMouseDown(object sender, MouseButtonEventArgs e)
{
    if (_addRecordCellBeingEdited != null)
    {
        DataRecordPresenter drp = Infragistics.Windows.Utilities.GetAncestorFromType(e.OriginalSource as DependencyObject, typeof(DataRecordPresenter), true) as DataRecordPresenter;
        if (!(drp != null && drp.IsAddRecord))
        {
            _addRecordCellBeingEdited.CancelUpdate();
        }
    }  
} 
```

# java - 同时调用 2 个 Restful Web 服务。骡子可以用吗？

> ID：13592819
> 
> 赞同：0
> 
> 时间：2012-11-27T20:51:18.900
> 
> 标签：java, web-services, rest, jakarta-ee, mule

我有两个 RESTful 网络服务“A”和“B”。服务“A”在云中，服务“B”部署在 Mule 中。我们必须首先点击服务'A'以获得我们用来调用服务'B'的响应。

为了实现这一点，我们最初的想法是在服务'A'中接收请求，从数据库中获取响应，然后点击服务'B'并将结果返回给服务'A'，然后将响应返回给客户端。

我不喜欢这种方法，因为它会增加服务“A”和“B”之间的依赖关系。

有没有其他方法可以做到这一点？我读过骡子可能是一种选择。我可以在 Mule 中创建一个新的端点来执行这些步骤吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T21:05:57.253

为此，您可以使用“内容丰富”企业集成模式。

[此处](http://www.eaipatterns.com/DataEnricher.html)描述了此模式。

这里有一篇关于如何使用 Mule 执行此操作的文章[，](http://blogs.mulesoft.org/enrich-your-experience-orchestration-and-data-enrichment-with-mule-3-1/)如果您使用的是 Mule，那么它可能应该在其中实现。

# javascript - 对于 WinJS 应用程序，我应该使用 getElementById 还是直接引用元素？

> ID：13592821
> 
> 赞同：1
> 
> 时间：2012-11-27T20:51:26.083
> 
> 标签：javascript, windows-8, microsoft-metro

要引用此 DOM 元素：

```
<input id="chkBxCheezDoodles" type="checkbox" /> 
```

在 Windows 8 JS 应用程序中，我可以这样做：

```
document.getElementById("chkBxCheezDoodles").checked = true; 
```

或这个：

```
chkBxCheezDoodles.checked = true; 
```

什么时候（如果有的话）getElementById 优先于直接引用？使用 getElementById 是否被认为“更干净”？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T01:13:32.757

我的偏好是使用 getElementById，而不是依赖于将变量投影到全局命名空间中。这不会导致类似命名变量、冲突等问题。

恕我直言，我尽量不使用 ID，而是使用 querySelectors，无论是使用自定义属性还是特定的 CSS 类。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-28T01:44:18.530

我同意多米尼克的观点。我怀疑如果您使用 getElementById 而不是 querySelector，它可能会更高效，但我通常不关心那些五分钱的时间节省。您不想一直键入 document.querySelector，我也不喜欢每次都在 document.querySelector 和 querySelectorAll 之间做出决定。“让我们看看我期待一件事回来还是几件事回来？” 所以我将它们都包装在一个我在[ocho.js](http://codeshow.codeplex.com/SourceControl/changeset/view/16267#429359)库中调用 query 的函数中。我通常将它作为简单的“q”带入我的应用程序的全局命名空间中。这样我总是`q("#charlie")`可以得到名为“charlie”的元素或`q(".large")`获取所有大类的元素。如果只有一个，则返回 DOM 元素。如果有多个，则返回一个香草数组。这让我的生活更轻松。那我可以做...

```
q(".large").forEach(function(el) { el.style.fontSize = 'xx-large'; }); 
```

# matlab - 在 MATLAB 中的等高线图上绘制零值

> ID：13592822
> 
> 赞同：1
> 
> 时间：2012-11-27T20:51:40.477
> 
> 标签：matlab, octave, contour

我在等高线图上绘制 z 值，0 到 10。

当我包含数据 1 或更大时，我得到一个等高线图。如下所示：

```
longitude = [80 82 95]
latitude = [30 32 35]
temp = [1 4 6; 1 2 7; 3 5 7]

contourf(longitude,latitude,temp) 
```

现在，我想在等高线图上绘制零值。虽然我期待一种颜色代表零值，但我得到了一个白色方块。

```
longitude = [80 82 95]
latitude = [30 32 35]
temp = [0 0 0; 0 0 0; 0 0 0]

contourf(longitude,latitude,temp) 
```

非常感谢，阿曼达

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-07T08:47:10.537

正如伊萨克所说。在 a 中绘制常数数据`contourf`是不可能的。

当您尝试这样做时，您将从 Matlab 获得此警告：

```
 temp =
   0     0     0
   0     0     0
   0     0     0

  Warning: Contour not rendered for constant ZData 
  > In contourf>parseargs at 458
    In contourf at 63
    In TESTrandom at 45 
```

但是，如果您将一些数字设置为 0，则 contourf 可以正常工作：

```
longitude = [80 82 95];
latitude = [30 32 35];
temp = [0 4 6; 1 0 7; 0 5 9];

contourf(longitude,latitude,temp);
hcb = colorbar('horiz');        % colour bar
set(get(hcb,'Xlabel'),'String','Contourf Bar.') 
```

![上面代码产生的contourf](../Images/1f09f73b5f65ee4212b192948eb0be96.png)

# javascript - 简单的 jQuery 手风琴，可以跟踪高度变化以动画旁边的其他对象

> ID：13592824
> 
> 赞同：-1
> 
> 时间：2012-11-27T20:51:42.677
> 
> 标签：javascript, jquery, html, css, accordion

我需要创建一个手风琴，可以跟踪它对高度所做的调整。在大多数情况下，手风琴的容器会自动调整其高度，但我的手风琴是在一个相对定位的 div 内的绝对定位的 div 中，我需要调整相对定位的 div 的高度以及手风琴移动一些背景周围的图像。如果其他人需要类似的东西，这是我想出的结果（在 ahren 和 dmi3y 的帮助下）：

[http://jsfiddle.net/MSatE/48/](http://jsfiddle.net/MSatE/48/)

的HTML：

```
<div id="accordion">
    <h3>Sample Header 1</h3>
    <div>
        <p>
            Sample<br />
            More Sample Text<br />
            Yet More Sample Text<br />
            I wish I could come up with something more clever<br />
            This should be enough for you to see the problem
        </p>
    </div>
    <h3>Sample Header 2</h3>
    <div>
        <p>
            Sample<br />
            More Sample Text<br />
            Yet More Sample Text<br />
            I wish I could come up with something more clever<br />
            This should be enough for you to see the problem Sample<br />
            More Sample Text<br />
            Yet More Sample Text<br />
            I wish I could come up with something more clever<br />
            This should be enough for you to see the problem
        </p>
    </div>
</div> 
```

的CSS：

```
#accordion {
    width: 600px;
    border: 1px solid #C0C0C0;
    border-bottom: none;
    box-shadow: 0 0 5px #C0C0C0;
    -webkit-box-shadow: 0 0 5px #C0C0C0;
    margin: 30px auto;
    background: #FFF;
}

#accordion h3 {
    border-bottom: 1px solid #C0C0C0;
    padding: 10px;
}

#accordion div {
    display: none;
    padding: 20px;
    border-bottom: 1px solid #C0C0C0;
    background: #F4F4F4;
}

#accordion p {
    padding: 0;
    margin: 0;
}

#accordion h3:hover {
    cursor: pointer;
}

.forMeasure {
    position: absolute;
    visibility: hidden;
    display: block!important;
} 
```

javascript/jQuery:

```
$('#accordion h3').click(function(){
    var adjustment = 0;
    var div = $(this).next('div');

    if(div.css('display') == 'none')
    {
        adjustment += div.addClass('forMeasure').outerHeight();
        div.removeClass('forMeasure');
        div.slideDown();
        div.siblings('div').each(function(){
            if($(this).css('display') == 'block')
            {
                adjustment -= $(this).outerHeight();
                $(this).slideUp();
            }
        });
    }
    else
    {
        adjustment -= div.outerHeight();
        div.slideUp();
    }
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T21:07:15.073

我已经简化了你的手风琴...

[http://jsfiddle.net/MSatE/3/](http://jsfiddle.net/MSatE/3/)

```
$('#accordion h3').click(function(){
    $(this).next().slideDown().siblings('div').slideUp();
});​ 
```

我所做的唯一 CSS 更改：

```
#accordion div {
    position: relative; /* <-- changed to relative */
    display:none; /* <-- changed from visibility:hidden; to display:none; */
    padding: 20px;
    border-bottom: 1px solid #C0C0C0;
    background: #F4F4F4;
} 
```

**编辑**

根据要求...在动画开始之前检索手风琴新高度的方法...
[http://jsfiddle.net/MSatE/6/](http://jsfiddle.net/MSatE/6/)

```
$('#accordion h3').click(function(){
    /* Extra code to get the height of the new accordion once this div has been shown... */
    var $t = $(this);
    $t.siblings('div').filter(':visible').addClass('oldVisible');
    $t.next().show().siblings('div').hide();
    var height = $('#accordion').outerHeight();
    $t.next().hide().siblings('.oldVisible').show().removeClass('oldVisible');

    console.log(height);
    $t.next().slideDown().siblings('div').slideUp();
});​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T20:54:01.633

您检查过[jQueryUI 手风琴功能](http://jqueryui.com/accordion/)吗？如果没有，请查看他们的示例，将它们复制/粘贴到您网站上的文档中，然后花 10 分钟时间使用它。你会很高兴你做到了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T23:02:35.193

在这里，我稍微更改了您的 jquery 以获得我认为您所要求的内容。基本上现在内容 div 的高度涵盖了其中的所有内容。[http://jsfiddle.net/MSatE/9/](http://jsfiddle.net/MSatE/9/)

看起来非常简单，只需将以下行调整为 100%：

```
var div_height = $(this).height();
$(this).css('height', '100%'); 
```

希望这就是你要找的！问候，-Epik-

# playframework - 使用游戏创建受限页面！认证

> ID：13592830
> 
> 赞同：0
> 
> 时间：2012-11-27T20:52:28.487
> 
> 标签：playframework, play-authenticate

在我的网站上，主导航栏上有一个下拉菜单。我希望此下拉列表中的所有页面都受到限制 - 因此需要登录才能查看它们，如果用户未登录，他们将被重定向到登录屏幕。我已经集成了所有游戏！在我的项目中验证代码并查看示例项目*play-authenticate-usage*。在他们的示例中，他们有一个受限页面，该页面在 Application.java 中调用此方法：

```
@Restrict(Application.USER_ROLE)
public static Result restricted() {
    final User localUser = getLocalUser(session());
    return ok(restricted.render(localUser));
} 
```

此方法返回要查看的渲染页面。我尝试复制此方法，以便可以返回我想要的受限页面：

```
@Restrict(Application.USER_ROLE)
public static Result restrictedCreate() {
    final User localUser = getLocalUser(session());
    return ok(journeyCreator.render(localUser));
} 
```

我在路由文件中添加了这个新方法：

```
GET     /restricted                         controllers.Application.restrictedCreate() 
```

并通过下拉代码修改，以便调用我的新方法：

```
<li><a href="@routes.Application.restrictedCreate()"><i class="icon-plus-sign"></i> @Messages("journeys.dropdown.option1")</a></li> 
```

在这个阶段我遇到了一个编译错误：`error: method render in class journeyCreator cannot be applied to given types;`所以我检查了我试图渲染的页面*JourneyCreator.scala.html*并添加了`localUser: models.User = null`争论。我的*JourneyCreator.scala.html*现在看起来是这样的：

```
@(localUser: models.User = null, listJourneys: List[Journey], journeyForm: Form[Journey])

@import helper._

@main("Journey Creator", "journeys") {
        ......
    }
} 
```

然而，这样做会导致各种错误：在与*JourneyCreator.scala.html*`error: method render in class journeyCreator cannot be applied to given types;`相关的其他方法中。任何帮助表示赞赏。

 ** * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T10:07:18.567

您声明了视图的参数（它是函数），但没有传递它们，所以它导致了问题。

虽然在 Scala 函数中（类似于 PHP）你可以为参数设置默认值，但 Java 有问题，所以你需要在这个地方传递一些东西，它可能只是......`null`

```
public static Result restrictedCreate() {
    final User localUser = getLocalUser(session());
    return ok(journeyCreator.render(localUser, null, null));
} 
```

稍后`@if(localUser!=null){ ... }`在视图中使用条件以确保您拥有所需的内容。*

# string - Haskell 中的类型类

> ID：13592832
> 
> 赞同：4
> 
> 时间：2012-11-27T20:52:38.223
> 
> 标签：string, haskell, typeclass

我对 haskell 非常陌生，并试图实现一个小而简单的函数，它接受两个字符串并告诉我同一位置的相同字符的数量。

```
ed :: (Integral b) => [a] -> [a] -> b
ed _ [] = 0
ed [] _ = 0
ed [] [] = 0
ed (x:xs) (y:ys)
    | x == y = 1 + ed xs ys
    | otherwise = ed xs ys 
```

这不会运行，因为我的类型类定义是错误的。我有两个字符串，需要返回一个整数，因此我上面写的类型类定义。还有什么我需要做的吗？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-27T20:55:00.183

类型签名应该是

```
ed :: (Eq a, Integral b) => [a] -> [a] -> b 
```

这是因为您的定义`ed`包含表达式`x == y`。`x`并且`y`都有类型`a`；为了能够测试它们是否相等，这种类型必须实现`Eq`提供了`==`and`/=`运算符的 typeclass。

您收到的错误消息将包括以下内容：

> ```
> Could not deduce (Eq a) arising from a use of `=='
> from the context (Integral b)
>   bound by the type signature for ed :: Integral b => [a] -> [a] -> b
>   at /home/dave/tmp/so.hs:(2,1)-(5,26)
> Possible fix:
>   add (Eq a) to the context of
>     the type signature for ed :: Integral b => [a] -> [a] -> b 
> ```

它试图告诉你这一点。

（顺便说一句，当字符串长度不同时，您的代码无法处理这种情况。）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-27T20:59:48.217

由于 x == y，您需要添加一个 Eq 类型约束：

```
ed :: (Integral b, Eq a) => [a] -> [a] -> b 
```

您可以注释掉类型签名，在 ghci 中加载您的模块并让它找出类型签名：

```
Main> :t ed
ed :: (Eq a1, Num a) => [a1] -> [a1] -> a 
```

# windows - 让 Python 中的 import gtk.glade 在 Windows 上工作

> ID：13592838
> 
> 赞同：2
> 
> 时间：2012-11-27T20:53:07.090
> 
> 标签：windows, gtk, pygtk, glade

我正在尝试让一个在 Linux 上设计和运行的 Python 程序在 Windows 上运行。`import gtk.glade`我一直在寻找所需的每个库，但现在卡住了。（调用 glade 的代码会加载一个用于 GUI 布局的 .glade 文件。）

有人知道如何在 Windows 上获取 gtk.glade 吗？这是版本问题吗？我通过[http://www.gramps-project.org/wiki/index.php?title=Windows_installer#Dependencies_-_The_hard_way列出的前 5 个步骤安装了 pygtk](http://www.gramps-project.org/wiki/index.php?title=Windows_installer#Dependencies_-_The_hard_way)

# .net - 使用 HTMLAgilityPack 从 HTML 中选择值

> ID：13592840
> 
> 赞同：1
> 
> 时间：2012-11-27T20:53:07.997
> 
> 标签：.net, html-agility-pack

我需要一些关于如何使用 HTML Agility Pack 从一些 HTML 中提取值的帮助。（部分）HTML 是：

```
<HTML>
<BODY bgcolor="FFFFFF" onLoad="window.document.forms[0].p_wwwparam.focus();">
<BR>
<DIV ALIGN="CENTER">
<CENTER><U><font color="800040"><H2>Password Reset Form</H2></font></U></CENTER>
<BR>
<TABLE >
<TH ALIGN="CENTER" COLSPAN="2"><FONT COLOR="800040">Verification details for 
</FONT>WSCCD03</TH>
<TR>
<TD>EIN: </TD>
<TD>987654321</TD>
</TR>
<TR>
<TD>Full name: </TD>
<TD>Bob Bobbity</TD>
</TR>
</TABLE>
...... Rest of document 
```

我需要从包含 'EIN:' 的 td 中提取值，所以在这种情况下，我需要提取 '987654321'

任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T21:06:53.167

这应该工作

```
var text = doc.DocumentNode.SelectSingleNode("//td[text()='EIN: ']/../td[2]")
              .InnerText; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T21:06:39.453

您可以执行以下操作：

```
HtmlDocument doc = new HtmlWeb().Load("http://www.yoursite.com/yourpage.html");
HtmlNodeCollection trs = doc.DocumentNode.SelectNodes(".//tr");
HtmlNodeCollection tds = trs[0].SelectNodes(".//td");
var text = tds[1].InnerText; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T21:08:32.263

这是一个简单的代码，可让您获得第二个 td 值：

```
var htmlDoc = new HtmlDocument();

// Point to your HTML doc content here... :)
htmlDoc.Load(@"C:\Libs\HtmlAgilityPack.1.4.0\htmldocument.html");

var node = htmlDoc.DocumentNode.SelectNodes("//td").Skip(1).Take(1).Single();

System.Console.WriteLine(node.InnerText); 
```

# python - 使用相关矩阵对大型稀疏矩阵进行 PCA

> ID：13592841
> 
> 赞同：3
> 
> 时间：2012-11-27T20:53:11.787
> 
> 标签：python, matlab, numpy, machine-learning, sparse-matrix

我有一个大的（500k x 500k）稀疏矩阵。我想了解它的主要组成部分（事实上，即使只计算最大的 PC 也可以）。随机 PCA 效果很好，除了它本质上是寻找协方差矩阵的特征向量而不是相关矩阵。关于使用大型稀疏矩阵的协方差矩阵找到 PCA 的包的任何想法？最好在 python 中，尽管 matlab 和 R 也可以。

[（作为参考，这里](https://stackoverflow.com/questions/10718455/apply-pca-on-very-large-sparse-matrix)提出了一个类似的问题，但这些方法是指协方差矩阵）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T21:28:26.457

他们不是一回事吗？据我了解，相关矩阵只是由每个变量的标准偏差的乘积归一化的协方差矩阵。而且，如果我没记错的话，PCA 中是否存在缩放歧义？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T21:38:44.633

Have you ever tried irlba package in R - "The IRLBA package is the R language implementation of the method. With it, you can compute partial SVDs and principal component analyses of very large scale data. The package works well with sparse matrices and with other matrix classes like those provided by the Bigmemory package." you can check [here](http://bigcomputing.blogspot.de/2011/05/bryan-lewiss-vignette-on-irlba-for-svd.html) for details

# c++ - C++11 观察者模式（信号、槽、事件、改变广播器/监听器，或任何你想称呼它的东西）

> ID：13592847
> 
> 赞同：34
> 
> 时间：2012-11-27T20:53:30.693
> 
> 标签：c++, boost, c++11, signals, observer-pattern

随着 C++11 中所做的更改（例如包含`std::bind`），是否有推荐的方法来实现简单的单线程观察者模式，而不依赖于核心语言或标准库（如`boost::signal`）之外的任何东西？

**编辑**

如果有人可以发布一些代码来展示如何使用新的语言特性来减少依赖`boost::signal`，那仍然非常有用。

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-11-27T21:01:16.120

我认为这`bind`使得创建插槽*变得更容易（参见*[“首选”语法与“便携式”语法](http://www.boost.org/doc/libs/1_52_0/doc/html/signals/tutorial.html#id3284837)——这一切都将消失）。然而，观察员管理并没有变得不那么复杂。

但作为@R。Martinho Fernandes 提到：`std::vector<std::function< r(a1) > >`现在可以轻松创建 an ，而无需（人工）“纯虚拟”接口类。

* * *

根据要求：关于连接管理的想法 - 可能充满了错误，但你会明白的：

```
// note that the Func parameter is something
// like std::function< void(int,int) > or whatever, greatly simplified
// by the C++11 standard
template<typename Func>
struct signal {
  typedef int Key; // 
  Key nextKey;
  std::map<Key,Func> connections;

  // note that connection management is the same in C++03 or C++11
  // (until a better idea arises)
  template<typename FuncLike>
  Key connect( FuncLike f ) {
     Key k=nextKey++;
     connections[k]=f;
     return k;
  }

  void disconnect(Key k){
     connections.erase(k);
  }

  // note: variadic template syntax to be reviewed 
  // (not the main focus of this post)
  template<typename Args...>
  typename Func::return_value call(Args... args){
     // supposing no subcription changes within call:
     for(auto &connection: connections){
        (*connection.second)(std::forward(...args));
     }
  }
}; 
```

用法：

```
signal<function<void(int,int)>> xychanged;

void dump(int x, int y) { cout << x << ", " << y << endl; }

struct XY { int x, y; } xy;

auto dumpkey=xychanged.connect(dump);
auto lambdakey=xychanged.connect([&xy](int x, int y){ xy.x=x; xy.y=y; });

xychanged.call(1,2); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-10-03T03:43:15.197

由于您要代码，我的博客条目[C++11 信号系统的性能](https://testbit.eu/cpp11-signal-system-performance/)包含基于 C++11 功能的全功能信号系统的单文件实现，没有进一步的依赖关系（尽管是单线程的，它是性能要求）。

下面是一个简短的使用示例：

```
Signal<void (std::string, int)> sig2;
sig2() += [] (std::string msg, int d)   { /* handler logic */ };
sig2.emit ("string arg", 17); 
```

更多示例可以在这个[单元测试](https://github.com/tim-janik/rapicorn/blob/devel/rcore/tests/signal2.cc)中找到。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-04-04T22:25:26.373

我编写了自己的轻量级 Signal/Slot 类，它们返回连接句柄。面对异常，现有答案的关键系统非常脆弱。您必须格外小心地使用显式调用删除内容。我更喜欢将[RAII](http://en.wikipedia.org/wiki/Resource_Acquisition_Is_Initialization)用于开/关对。

我的库中一个值得注意的缺乏支持是无法从您的调用中获取返回值。我相信 boost::signal 有计算总返回值的方法。在实践中通常你不需要这个，我只是觉得它很杂乱，但我可能会想出这样一个返回方法来娱乐作为未来的练习。

关于我的课程的一件很酷的事情是 Slot 和 SlotRegister 课程。SlotRegister 提供了一个公共接口，您可以安全地链接到私有 Slot。这可以防止外部对象调用您的观察者方法。它很简单，但封装很好。

但是，我不相信我的代码是线程安全的。

```
//"MIT License + do not delete this comment" - M2tM : http://michaelhamilton.com 

#ifndef __MV_SIGNAL_H__
#define __MV_SIGNAL_H__

#include <memory>
#include <utility>
#include <functional>
#include <vector>
#include <set>
#include "Utility/scopeGuard.hpp"

namespace MV {

    template <typename T>
    class Signal {
    public:
        typedef std::function<T> FunctionType;
        typedef std::shared_ptr<Signal<T>> SharedType;

        static std::shared_ptr< Signal<T> > make(std::function<T> a_callback){
            return std::shared_ptr< Signal<T> >(new Signal<T>(a_callback, ++uniqueId));
        }

        template <class ...Arg>
        void notify(Arg... a_parameters){
            if(!isBlocked){
                callback(std::forward<Arg>(a_parameters)...);
            }
        }
        template <class ...Arg>
        void operator()(Arg... a_parameters){
            if(!isBlocked){
                callback(std::forward<Arg>(a_parameters)...);
            }
        }

        void block(){
            isBlocked = true;
        }
        void unblock(){
            isBlocked = false;
        }
        bool blocked() const{
            return isBlocked;
        }

        //For sorting and comparison (removal/avoiding duplicates)
        bool operator<(const Signal<T>& a_rhs){
            return id < a_rhs.id;
        }
        bool operator>(const Signal<T>& a_rhs){
            return id > a_rhs.id;
        }
        bool operator==(const Signal<T>& a_rhs){
            return id == a_rhs.id;
        }
        bool operator!=(const Signal<T>& a_rhs){
            return id != a_rhs.id;
        }

    private:
        Signal(std::function<T> a_callback, long long a_id):
            id(a_id),
            callback(a_callback),
            isBlocked(false){
        }
        bool isBlocked;
        std::function< T > callback;
        long long id;
        static long long uniqueId;
    };

    template <typename T>
    long long Signal<T>::uniqueId = 0;

    template <typename T>
    class Slot {
    public:
        typedef std::function<T> FunctionType;
        typedef Signal<T> SignalType;
        typedef std::shared_ptr<Signal<T>> SharedSignalType;

        //No protection against duplicates.
        std::shared_ptr<Signal<T>> connect(std::function<T> a_callback){
            if(observerLimit == std::numeric_limits<size_t>::max() || cullDeadObservers() < observerLimit){
                auto signal = Signal<T>::make(a_callback);
                observers.insert(signal);
                return signal;
            } else{
                return nullptr;
            }
        }
        //Duplicate Signals will not be added. If std::function ever becomes comparable this can all be much safer.
        bool connect(std::shared_ptr<Signal<T>> a_value){
            if(observerLimit == std::numeric_limits<size_t>::max() || cullDeadObservers() < observerLimit){
                observers.insert(a_value);
                return true;
            }else{
                return false;
            }
        }

        void disconnect(std::shared_ptr<Signal<T>> a_value){
            if(!inCall){
                observers.erase(a_value);
            } else{
                disconnectQueue.push_back(a_value);
            }
        }

        template <typename ...Arg>
        void operator()(Arg... a_parameters){
            inCall = true;
            SCOPE_EXIT{
                inCall = false;
                for(auto& i : disconnectQueue){
                    observers.erase(i);
                }
                disconnectQueue.clear();
            };

            for (auto i = observers.begin(); i != observers.end();) {
                if (i->expired()) {
                    observers.erase(i++);
                } else {
                    auto next = i;
                    ++next;
                    i->lock()->notify(std::forward<Arg>(a_parameters)...);
                    i = next;
                }
            }
        }

        void setObserverLimit(size_t a_newLimit){
            observerLimit = a_newLimit;
        }
        void clearObserverLimit(){
            observerLimit = std::numeric_limits<size_t>::max();
        }
        int getObserverLimit(){
            return observerLimit;
        }

        size_t cullDeadObservers(){
            for(auto i = observers.begin(); i != observers.end();) {
                if(i->expired()) {
                    observers.erase(i++);
                }
            }
            return observers.size();
        }
    private:
        std::set< std::weak_ptr< Signal<T> >, std::owner_less<std::weak_ptr<Signal<T>>> > observers;
        size_t observerLimit = std::numeric_limits<size_t>::max();
        bool inCall = false;
        std::vector< std::shared_ptr<Signal<T>> > disconnectQueue;
    };

    //Can be used as a public SlotRegister member for connecting slots to a private Slot member.
    //In this way you won't have to write forwarding connect/disconnect boilerplate for your classes.
    template <typename T>
    class SlotRegister {
    public:
        typedef std::function<T> FunctionType;
        typedef Signal<T> SignalType;
        typedef std::shared_ptr<Signal<T>> SharedSignalType;

        SlotRegister(Slot<T> &a_slot) :
            slot(a_slot){
        }

        //no protection against duplicates
        std::shared_ptr<Signal<T>> connect(std::function<T> a_callback){
            return slot.connect(a_callback);
        }
        //duplicate shared_ptr's will not be added
        bool connect(std::shared_ptr<Signal<T>> a_value){
            return slot.connect(a_value);
        }

        void disconnect(std::shared_ptr<Signal<T>> a_value){
            slot.disconnect(a_value);
        }
    private:
        Slot<T> &slot;
    };

}

#endif 
```

补充 scopeGuard.hpp：

```
#ifndef _MV_SCOPEGUARD_H_
#define _MV_SCOPEGUARD_H_

//Lifted from Alexandrescu's ScopeGuard11 talk.

namespace MV {
    template <typename Fun>
    class ScopeGuard {
        Fun f_;
        bool active_;
    public:
        ScopeGuard(Fun f)
            : f_(std::move(f))
            , active_(true) {
        }
        ~ScopeGuard() { if(active_) f_(); }
        void dismiss() { active_ = false; }
        ScopeGuard() = delete;
        ScopeGuard(const ScopeGuard&) = delete;
        ScopeGuard& operator=(const ScopeGuard&) = delete;
        ScopeGuard(ScopeGuard&& rhs)
            : f_(std::move(rhs.f_))
            , active_(rhs.active_) {
            rhs.dismiss();
        }
    };

    template<typename Fun>
    ScopeGuard<Fun> scopeGuard(Fun f){
        return ScopeGuard<Fun>(std::move(f));
    }

    namespace ScopeMacroSupport {
        enum class ScopeGuardOnExit {};
        template <typename Fun>
        MV::ScopeGuard<Fun> operator+(ScopeGuardOnExit, Fun&& fn) {
            return MV::ScopeGuard<Fun>(std::forward<Fun>(fn));
        }
    }

#define SCOPE_EXIT \
    auto ANONYMOUS_VARIABLE(SCOPE_EXIT_STATE) \
    = MV::ScopeMacroSupport::ScopeGuardOnExit() + [&]()

#define CONCATENATE_IMPL(s1, s2) s1##s2
#define CONCATENATE(s1, s2) CONCATENATE_IMPL(s1, s2)
#ifdef __COUNTER__
#define ANONYMOUS_VARIABLE(str) \
    CONCATENATE(str, __COUNTER__)
#else
#define ANONYMOUS_VARIABLE(str) \
    CONCATENATE(str, __LINE__)
#endif
}

#endif 
```

使用我的库的示例应用程序：

```
#include <iostream>
#include <string>
#include "signal.hpp"

class Observed {
private:
    //Note: This is private to ensure not just anyone can spawn a signal
    MV::Slot<void (int)> onChangeSlot;
public:
    typedef MV::Slot<void (int)>::SharedSignalType ChangeEventSignal;

    //SlotRegister is public, users can hook up signals to onChange with this value.
    MV::SlotRegister<void (int)> onChange;

    Observed():
        onChange(onChangeSlot){ //Here is where the binding occurs
    }

    void change(int newValue){
        onChangeSlot(newValue);
    }
};

class Observer{
public:
    Observer(std::string a_name, Observed &a_observed){
        connection = a_observed.onChange.connect([=](int value){
            std::cout << a_name << " caught changed value: " << value << std::endl;
        });
    }
private:
    Observed::ChangeEventSignal connection;
};

int main(){
    Observed observed;
    Observer observer1("o[1]", observed);
    {
        Observer observer2("o[2]", observed);
        observed.change(1);
    }
    observed.change(2);
} 
```

上述输出将是：

```
o[1] caught changed value: 1
o[2] caught changed value: 1
o[1] caught changed value: 2 
```

如您所见，插槽会自动断开死信号。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-10-10T21:12:28.400

这就是我想出的。

这假设不需要从广播信号的侦听器聚合结果。此外，“插槽”或​​ Signal::Listener 是回调的所有者。这应该与您的（我猜......）lambda可能正在捕获的对象一起使用，以便当该对象超出范围时，回调也将阻止它被调用。

您也可以使用其他答案中描述的方法以您可以查找的方式存储侦听器所有者对象。

```
template <typename... FuncArgs>
class Signal
{
    using fp = std::function<void(FuncArgs...)>;
    std::forward_list<std::weak_ptr<fp> > registeredListeners;
public:
    using Listener = std::shared_ptr<fp>;

    Listener add(const std::function<void(FuncArgs...)> &cb) {
        // passing by address, until copy is made in the Listener as owner.
        Listener result(std::make_shared<fp>(cb));
        registeredListeners.push_front(result);
        return result;
    }

    void raise(FuncArgs... args) {
        registeredListeners.remove_if([&args...](std::weak_ptr<fp> e) -> bool {
            if (auto f = e.lock()) {
                (*f)(args...);
                return false;
            }
            return true;
        });
    }
}; 
```

用法

```
Signal<int> bloopChanged;

// ...

Signal<int>::Listener bloopResponse = bloopChanged.add([](int i) { ... });
// or
decltype(bloopChanged)::Listener bloopResponse = ...

// let bloopResponse go out of scope.
// or re-assign it
// or reset the shared_ptr to disconnect it
bloopResponse.reset(); 
```

我也为此做了一个要点，并举了一个更深入的例子： [https ://gist.github.com/johnb003/dbc4a69af8ea8f4771666ce2e383047d](https://gist.github.com/johnb003/dbc4a69af8ea8f4771666ce2e383047d)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-30T03:30:06.853

我自己也尝试过。我的努力可以在这个 gist 中找到，它将继续发展。. .

[https://gist.github.com/4172757](https://gist.github.com/4172757)

我使用了不同的风格，更类似于 JUCE 中的更改通知，而不是 BOOST 信号。连接管理是使用一些 lambda 语法完成的，该语法通过复制进行一些捕获。到目前为止，它运行良好。

# apache - apache ssi 包含文件 abc.inc 失败（abc.html、abc.txt、abc.xxx、abc.INC 工作正常）

> ID：13592850
> 
> 赞同：1
> 
> 时间：2012-11-27T20:53:47.500
> 
> 标签：apache, server-side-includes

apache 2.2.15，+包含在目录容器和 XBitHack Full

somefile.html 有行 <!-- #include file="abc.inc" --> 此包含失败，“无法在日志中包含“abc.inc”

如果我将文件的扩展名（和 include 语句）更改为几乎任何内容（例如 abc.xxx、abc.txt、abc.html，甚至 abc.Inc 或 abc.INC），一切正常。只有 abc.inc 失败

我在 mime.types 中查找了 inc 的定义，对 httpd conf 文件/目录中的所有内容进行了 grep 处理。

不是一个大问题，但它让我很好奇。谢谢

# linux - /dev/random 权限被拒绝

> ID：13592855
> 
> 赞同：6
> 
> 时间：2012-11-27T20:54:05.000
> 
> 标签：linux, random, linux-kernel

我正在阅读有关随机数及其生成的信息。自从我开始编程以来，我就对随机性很感兴趣。我读到 Linux 内核也使用随机数生成架构。

```
The structure consists of a two-level cascaded sequence of pools coupled with 
CSPRNGs.
Each pool is a large group of bits which represents the current state of the 
random number generator. The CSPRNGs are currently based on SHA-1, but the 
kernel developers are considering a switch to SHA-3.

The kernel RNG produces two user-space output streams. One of these goes to 
/dev/urandom and also to the kernel itself; the latter is useful because there 
are uses for random numbers within the kernel. The other output stream goes to
/dev/random. The difference between the two is that /dev/random tries to estimate
how much entropy is coming into the system, and will throttle its output if there 
is insufficient entropy. By contrast, the /dev/urandom stream does not throttle
output, and if users consume all of the available entropy, the interface degrades
to a pure CSPRNG. 
```

因此，我兴奋地尝试进入并检查 /dev/random 和 /dev/urandom 中的内容。但它说，

```
root@ubuntu:/home/sunny# /dev/random
bash: /dev/random: Permission denied

root@ubuntu:/home/sunny# /dev/urandom
bash: /dev/urandom: Permission denied 
```

但是，当我使用“ls”命令检查时，我可以在 /dev 中看到“随机”。我想详细了解这一点。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-27T20:55:29.117

`/dev/random`不是可执行文件。试试`cat /dev/random`。或者，如果您不喜欢测试您的反应能力，`dd if=/dev/random bs=128 count=1`则会显示有限数量的随机垃圾。

# regex - 如何使用 QRegExp

> ID：13592860
> 
> 赞同：0
> 
> 时间：2012-11-27T20:54:22.707
> 
> 标签：regex, qt, qregexp

以下部分无法正常工作：

```
 QRegExp exp ("[À-Ÿà-ÿA-Za-z0-9\\-\\_]+");
  if (!formatedName.contains(exp)) {
    success = false;
  } 
```

此代码块用于验证用户输入的输入字符串。它应该只接受数字、法语和英语字符、破折号和下划线。

实际上，代码几乎可以正常工作。唯一的问题是如果我也输入合法字符，则接受特殊字符。因此，字符串 "!@#@" 将返回 false，但字符串 "hell!@^ooo" 将返回 true。

我应该如何正确使用正则表达式来只接受我的正则表达式？

谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T20:57:04.857

我建议添加`^`and`$`表示表达式应该覆盖整个字符串，而不仅仅是它的一部分。

```
QRegExp exp ("^[À-Ÿà-ÿA-Za-z0-9\\-\\_]+$");
  if (!formatedName.contains(exp)) {
    success = false;
  } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T20:57:22.277

您可以指定开始和结束分隔符以阻止正则表达式成功地将字符串与其中包含的正则表达式的*任何*部分匹配。

```
"^[À-Ÿà-ÿA-Za-z0-9\\-\\_]+$" 
```

这将确保检查整个字符串。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T22:47:08.470

您还可以使用[QRegExp::exactMatch()](http://qt-project.org/doc/qt-4.8/qregexp.html#exactMatch)，这基本上等同于用`^`and`$`字符包围您的正则表达式。

# android - 本地化字符串但保留跨度开始/结束信息

> ID：13592865
> 
> 赞同：0
> 
> 时间：2012-11-27T20:54:44.147
> 
> 标签：android, localization, colors

我的应用程序显示了各种消息，并且在这些消息中，某些部分`ForegroundColorSpan`添加了颜色范围（例如 ），因此它们与消息的其余部分具有不同的颜色。目前，它们都是硬编码的，因为它们是硬编码的，所以我确切地知道在哪里开始和结束我想要不同颜色的文本块的跨度。

我遇到的问题是，一旦我本地化了消息，我就无法弄清楚如何检测跨度应该从哪里开始和结束。例如：

硬编码：

'x 将主题更改为 oh hai' - 我知道从 char 23 到结尾应该改变颜色。

本地化为荷兰语：

'x veranderde het onderwerp te oh hai' - char 23 是另一回事。

（这是一个简单的例子，一些消息在多个位置有颜色）

所以我的问题是，在本地化之后，我怎样才能知道从哪里开始和结束一个跨度？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T21:05:26.527

我会说这是不可能的。您想如何了解一种语言的语法、词汇、翻译者认为什么是合适的……

但是你可以在你的翻译中插入标记——lile ##、@# 或其他任何东西，以指示这些块。然后你解析，捕捉这些标记的位置并将其用于跨度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-08T15:03:28.110

我决定将字符串设置为单一颜色，而不是进行一些复杂的解析。

# javascript - Javascript，传递鼠标事件

> ID：13592867
> 
> 赞同：0
> 
> 时间：2012-11-27T20:54:50.900
> 
> 标签：javascript, dom

我想要一种跨现代浏览器的方式来从一个 html 元素中获取鼠标事件并将其传递给另一个。

例如。

```
el1.addEventListener('mousemove', function(e) {
  el2.trigger('mousemove', e);
});

el2.addEventListener('mousemove', function(e) {
   //THIS SHOULD BE CALLED WHEN EITHER el1
}); 
```

jquery 解决方案还可以，但我更喜欢非 jquery 解决方案。这很简单吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T21:10:10.627

这是正确的代码

```
var el1 = document.getElementById('el1');
var el2 = document.getElementById('el2');

el1.onmousemove = function(e) {
    alert('el1 event');
    el2.onmousemove(e);
};
el2.onmousemove = function(e) {    
    alert('el2 event');
}; 
```

[演示](http://jsfiddle.net/7ncqq/)

如果您希望将事件参数`e`传递给`el2`' 事件，这很好。这个更新的[演示](http://jsfiddle.net/7ncqq/2/)显示了鼠标位置被传递。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T20:59:03.467

如果您接受 jQuery 答案，则代码如下：

```
// el1 and el2 are the jQuery objects of the DOM elements
el1.mousemove(function (event) {
    el2.mousemove(event);
}); 
```

在纯 JavaScript 中：

```
el1.onmousemove = function(e) {
    el2.onmousemove('mousemove', e);
};

el2.onmousemove = function(e) {

}; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T21:02:48.763

```
el1.addEventListener('mousemove', handler, false);
el2.addEventListener('mousemove', handler2, false);
function handler(e) {
    // do some stuff
    handler2.call(el2, e); // pass el2 as this reference, event as the argument.
}; 
```

不太确定这是否是您要查找的内容，只需命名事件处理程序并触发另一个。

如果您不需要`this`第二个处理程序中的引用，请`handler2(e);`改用。

延伸阅读：
[Function.prototype.call](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/call)

这是一个传递鼠标事件参数[的半生不熟的演示。](http://jsfiddle.net/rlemon/DPcb9/)我不确定 layerX/Y 的支持有多好，我只是用它来展示演示。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-27T21:04:09.880

本机应该这样工作

```
var evt;
el1.onmousemove = function() {
  evt = document.createEvent('MouseEvent');
  evt.initEvent('mousemove', true, true);
  el2.dispatchEvent(evt);
} 
```

你可以在`element.dispatchEvent`这里阅读：
[https ://developer.mozilla.org/en-US/docs/DOM/element.dispatchEvent](https://developer.mozilla.org/en-US/docs/DOM/element.dispatchEvent)

# javascript - Javascript - 通过键输入使表单输入看起来需要

> ID：13592868
> 
> 赞同：0
> 
> 时间：2012-11-27T20:54:55.997
> 
> 标签：javascript, forms

我有一个表单，它有五个文本输入，a 到 e。我设置了它，所以只有前两个通过 css:display 可见，我将后三个设置为 display:none。

我有我的javascript，因此它将最后一个输入设置为'b'，将下一个输入设置为'c'，并根据其他文本是否为空来更改最后一个和下一个变量。

option-a、option-b等为表单中文本框的id answer_answera、answer_answerb等为表单输入的类

```
<script>
  var last = 'b';
  var next = 'c';

  if (document.getElementById('option-c').value != null) {
    last = 'c';
    next = 'd';
  }

  if (document.getElementById('option-d').value != null) {
    last = 'd';
    next = 'e';
  }

  if (document.getElementById('option-e').value != null) {
    last = '';
    next = '';
  }

  $('#answer_answer'+last).keyup(function() {
    console.log('beg');
    var elem = document.getElementById('option-'+next);
    elem.style.display="block";
    console.log('hit this');
  })
  </script> 
```

这适用于第一个输入。当我输入表单输入 b 时，出现表单输入 c。但是，我想如何让它不断刷新，因为当我输入表单输入 c 时，表单输入 d 不会出现。我考虑过在整个最后一个块/keyup 函数周围放置一个 while 循环，但它使整个应用程序变慢并且无法正确加载。

感谢您的任何想法！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T04:44:01.360

在我们解决这个问题之前，让我们快速回顾一些 Javascript 概念。当您的文档首次加载时，`<script></script>`标签内的所有内容都将执行一次。这意味着将评估以下语句：

```
 var last = 'b';
  var next = 'c';

  if (document.getElementById('option-c').value != null) {
    last = 'c';
    next = 'd';
  }

  if (document.getElementById('option-d').value != null) {
    last = 'd';
    next = 'e';
  }

  if (document.getElementById('option-e').value != null) {
    last = '';
    next = '';
  } 
```

一旦它们被评估，它们将永远不会再次运行，直到您刷新页面。因此，当页面完成加载`last = 'b'`并且`next = 'c'`三个`if`语句都评估为 false 并且不执行（我假设文本字段在初始加载时为空）。以下代码也将执行一次：

```
$('#answer_answer'+last).keyup(function() {
    console.log('beg');
    var elem = document.getElementById('option-'+next);
    elem.style.display="block";
    console.log('hit this');
  }) 
```

但是，此代码绑定了一个“处理程序”（未来的承诺）以在给定用户操作的情况下执行某些代码。

*   动作是元素`keyup`上的事件。`'#answer_answer'+last`因为我们知道，`last = 'b'`当做出这个承诺时，这真的意味着`'#answer_answerb'`
*   承诺是执行以下代码：

    console.log('乞求'); var elem = document.getElementById('option-'+next); elem.style.display="块"; console.log('打这个');

因此，当您开始输入时，会显示`#answer_answerb`该`#answer_answerc`字段（请记住`next = 'c'`）。如果您在该字段中输入更多内容，`#answer_answerb`则该`#answer_answerc`字段仍然可见。现在我们知道您的代码所做的一切。

那么，我们该如何解决呢？猜一下？我们可以做出更多的承诺。完整代码：

```
<script>
      $('#answer_answerb).keyup(function() {
        var elem = document.getElementById('option-c');
        elem.style.display="block";
      })
      $('#answer_answerc).keyup(function() {
        var elem = document.getElementById('option-d');
        elem.style.display="block";
      })
      $('#answer_answerd).keyup(function() {
        var elem = document.getElementById('option-e');
        elem.style.display="block";
      })
</script> 
```

这将产生预期的效果，但很难维持。如果您决定添加更多文本字段，则必须为每个字段创建一个承诺。你可以在这里找到一个更优雅的解决你的问题的方法[http://jsfiddle.net/tppiotrowski/GkT2g/](http://jsfiddle.net/tppiotrowski/GkT2g/)

# c - 使用 scanf() 读取多行输入

> ID：13592875
> 
> 赞同：6
> 
> 时间：2012-11-27T20:55:26.403
> 
> 标签：c, scanf

相关代码片段：

```
char input [1024];

printf("Enter text. Press enter on blank line to exit.\n");
scanf("%[^\n]", input); 
```

这将读取整行，直到用户点击 [enter]，防止用户输入第二行（如果他们愿意）。

要退出，他们按 [enter]，然后再次按 [enter]。所以我尝试了各种 while 循环、for 循环和涉及新行转义序列的 scanf() 周围的 if 语句，但似乎没有任何效果。

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T20:59:24.777

尝试这个：

```
while (1 == scanf("%[^\n]%*c", input)) { /* process input */ } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-23T04:50:44.477

正如尚未指出的那样，`fgets()`这里比`scanf()`.

**您可以读取与标准输入**（键盘）关联的文件`fgets(input, 1024, stdin);`
在哪里的整行。 该函数从键盘读取每个字符，直到第一个换行符：'\n'（当然是在按下**ENTER**键后获得......）。**重要提示：**字符 '\n' 将成为数组**input**的一部分。 `stdin` **`fgets()`**

 ******现在，您的下一步是验证数组**input**中的所有字符（
从第一个字符到“\n”）是否为空白。
另外，请注意**输入**中第一个'\n'之后的所有字符都是垃圾，所以你不必检查它们。

你的程序可能如下：

```
char input[1024];
printf("Enter text. Press enter on blank line to exit.\n");
while (1) {
   if (fgets(input, 1024, stdin) == NULL)
     printf("Input Error...\n");
   else {
     /* Here we suppose the fgets() has reached a '\n' character... */
     for (char* s = input; (*s != '\n') && isspace(*s); s++)
        ; /* skipping blanks */
     if (*s == '\n')
        break; /* Blank line */
     else
        printf("%s\n", input); /* The input was not a blank line */
   }
} 
```

该代码必须写在您的`main()`块中，
更重要的是，必须首先包含标头`<ctype.h>`，
因为`isspace()`使用了该函数。
代码很简单：while***永远***执行，用户在每次迭代中输入一行，**if**语句检查是否发生了错误。
如果一切正常，则执行**for(;;)**语句，该语句探索数组**输入**以观察那里是否只有空白……或没有。**for**
迭代一直持续到找到 第一个换行符 '\n'，或者出现一个非空白字符。**什么** 时候 ****终止，这意味着保存在 中的最后一个分析字符`*s`是换行符（意味着所有早期字符都是空白），或者不是（意味着**input[]**中至少有一些非空白字符，所以**输入**是普通文本）。****

 ****> “ethernal”`while(1)`仅在读取空行的情况下才会被破坏（参见`break`第 11 行中的语句）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-23T17:22:19.513

OP 说“要退出，他们点击 [enter] 然后再次 [enter]”

```
unsigned ConsecutiveEnterCount = 0;
for (;;) {
  char buffer[1024];
  if (fgets(buffer, sizeof(buffer), stdin) == NULL) {
    break;  // handle error or EOF
  }
  if (buffer[0] == '\n') {
    ConsecutiveEnterCount++;
    if (ConsecutiveEnterCount >= 2 /* or 1, not clear on OP intent */) {
      break;
    }
  }
  else ConsecutiveEnterCount = 0;
  // Do stuff with buffer;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-05-30T06:30:26.460

> ...我尝试了各种 while 循环、for 循环和涉及新行转义序列的 scanf() 周围的 if 语句，但似乎没有任何效果。

*在阅读*之前，您似乎尝试了所有不应该尝试的东西！**AC 程序员*应该*阅读*手册***，以免他们遇到*未定义的行为*，这会导致像您所经历的那样令人头疼的行为。详细地说，你不能像学习Java 一样通过*猜测来学习 C。*

把这当作你的教训。**停止*猜测*并[开始*阅读*（`fscanf`手册）](http://pubs.opengroup.org/onlinepubs/9699919799/functions/fscanf.html)**！

根据该手册：

> `[`匹配一组预期字节（扫描集）中的**非空字节序列。**

重点是我的。您似乎在描述的是一个*空*的字节序列，这意味着*匹配**失败***。手册对*匹配失败*有什么说法？

> 成功完成后，**这些函数将返回成功匹配**和分配的输入项的数量；**如果发生早期匹配失败，此数字可以为零**。如果输入在第一次转换（如果有）完成之前结束，并且没有发生匹配失败，则应返回 EOF。如果在第一次转换（如果有）完成之前发生错误，并且没有发生匹配失败，则应返回 EOF...

同样，重点是我的……这告诉您，*与大多数其他 C 标准函数一样，**您需要检查返回值**！*例如，当您打电话给`fopen`您时，请按照`if (fp == NULL) { /* handle error */ }`.

**你的错误处理在哪里？**请注意，*返回值*不仅仅是*二进制选择*；在`n`执行转换的地方，`n+2`可能的返回值范围为：`EOF`, `0 .. n`. 在尝试使用*.*`fscanf`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-05-29T20:53:11.187

```
#include <stdio.h>
int main(){
    char arr[40];
    int i;
    for( i = 0; i < sizeof(arr); i +=2 ){
        scanf("%c%c",&arr[i],&arr[i+1]);
        if( arr[i] == '\n' && arr[i+1] == '\n' )
            break;
    }
    printf("%s", arr);
    return 0;    
} 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2016-06-22T21:59:11.923

**当您想从下一行读取输入时，您可以使用以下功能。**

```
scanf("%d \n",&a);
scanf("%d \n",&b);
scanf("%d ",&c); 
```

如果您从命令行提供输入，则在换行后将需要另一个输入。**********

# ruby-on-rails - 每个用户请求仅使用一次 before_filter

> ID：13592891
> 
> 赞同：0
> 
> 时间：2012-11-27T20:56:42.893
> 
> 标签：ruby-on-rails

`root_path`我有一个网站的移动版本，如果检测到移动设备（） ，主页加载（ ）将重定向到移动版本`home_mobile_path`。我在主页操作上放置了一个前置过滤器来检查设备，但我只希望它执行一次前置过滤器，以便允许用户访问主页（`root_path`），而无需总是被重定向到移动版本从移动设备查看实际主页。

可以为此制作另一个页面和路径，但这似乎不是很干

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T21:02:53.773

您可以在`session`哈希中存储一个标志并确保重定向只发生一次

```
unless session[:mobile_redirect]
  session[:mobile_redirect] = true
  redirect_to home_mobile_path
end 
```

# android - 带有加载对话框的 Android 应用程序 - 最佳方法

> ID：13592892
> 
> 赞同：0
> 
> 时间：2012-11-27T20:56:58.460
> 
> 标签：android, progressdialog, asynctaskloader

我是论坛的新手，也是安卓开发的新手。我在整个互联网和 stackoverflow 上进行了搜索，但我无法得到我的问题的实际答案。我想知道您对我的应用程序的最佳方法（处理程序、异步任务等）的看法。我有：

* ***1 - 单击时必须显示列表的按钮（数据是通过解析html响应获得的）**

**2 - 当列表未加载时，应用程序必须显示“加载”对话框**。**

现在我可以在单击按钮时加载列表，但有时（取决于 Internet 连接）可能需要很长时间，我想显示加载进度对话框。我尝试实现 AsyncTasks 但赢得了**onPostExecute**方法，对话框已关闭，但列表未显示在 UI 上，尽管它具有正确的数据。

谁能帮助我最好的方法？非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T21:00:44.417

您可以在这里选择两个明显的解决方案：

`ProgressBar`1）在您的布局 XML 中放入 a并将其设置为，`View.GONE`直到按下按钮，然后更改为`View.VISIBLE`，`View.GONE`完成后再次更改为。

2) 有一个单独的布局 XML，其中包含更多详细信息加载视图，并用于`setContentView`在请求期间在两者之间切换。

我经常采用这种`View.GONE` `ProgressBar`方法

# c# - 如何使用 DDD 和 SRP 实现可维护且松耦合的应用程序？

> ID：13592894
> 
> 赞同：13
> 
> 时间：2012-11-27T20:57:10.853
> 
> 标签：c#, wcf, design-patterns, architecture, domain-driven-design

问这个问题的原因是我一直想知道如何将所有这些不同的概念拼接在一起。有很多关于 DDD、依赖注入、CQRS、SOA、MVC 的示例和讨论，但没有太多关于如何以灵活的方式将它们组合在一起的示例。

**我的目标：**

1.  开发只需很少或无需修改即可独立运行的模块
2.  更改或修改 UI 应该尽可能简单（即 UI 应该尽可能少做，并且要“愚蠢”
3.  使用记录在案的模式和原则

为了更容易提出具体问题，主要架构现在如下所示：

![员工管理示例](../Images/85e59c566a52a7a232cbeffddb1941c2.png)

该示例显示如何向员工添加注释。员工管理是一种有界上下文。Employee 有几个属性，其中一个`ICollection<Note>`.

**在我的理解中，绑定上下文**是分隔代码的逻辑位置。每个 BC 都是一个模块。大多数时候，如果需要，我发现他们每个人都可以保证自己的 UI（即某些模块可能可用于 Windows 手机）。

**域**包含所有业务逻辑。

**基础设施**包含存储库实现，以及发送邮件、保存文件和不属于域的实用程序的服务。我正在考虑制作一些我必须在多个域（如发送电子邮件）中使用的通用服务功能，作为一种 API，我可以引用它来保存一些跨多个 BC 实现相同事物的代码。

**查询层**包含除 GetById 之外的所有查询，我需要在存储库中获取对象。查询层可以查询其他持久性实例，并且可能需要为每个 UI 更改一些。

Wcf 或 Web Api 是我的应用程序层，它可能属于基础设施而不是外部。该服务还设置了依赖关系，因此 UI 需要做的就是询问信息并发送命令。

该过程从蓝色箭头开始。阅读模型，因为它包含大部分信息。

在第 1 步中，此示例中的 EmployeeDto 只是一些员工属性，用于向用户显示他们需要记录的员工的用户信息（例如关于新体验的注释或类似内容）。

**所以，问题是：**

1.  实现这样的分层架构真的涉及这么多映射，还是我错过了什么？
2.  是否建议（甚至智能）使用 Wcf 服务来运行这样的主逻辑（它实际上是我的应用程序服务）
3.  如果我的 UI 层中没有我的域对象，是否有 Wcf 的替代品？
4.  这个实现有什么问题吗。有什么需要注意的坠落坑？

5.  你有什么好的例子可以推荐看，可以帮助我理解所有这些概念应该如何协同工作。

**更新：** 我现在已经阅读了大部分文章（相当多的阅读），除了付费书籍（需要更多时间做）。它们都是非常好的指针，将 Wcf 更多地视为适配器的方式似乎是对问题 2 的一个很好的回答。如果我打算走那条路，JGauffins 在他的框架上的工作也很有趣.

然而，正如下面的一些评论中提到的，我觉得一些例子倾向于推荐或实现事件和/或命令源、消息总线等。对我来说，现在就计划这种级别的扩展是过大的。与许多业务应用程序一样，这是一个“大量”（就内部应用程序而言，认为最多几千个）用户处理大量数据，而不是需要实现事件和命令的高度协作域队列通常与 CQRS 相关联以应对这种情况。

根据下面的答案，我将开始使用的方法将基于上面的模型和这样的答案：

1.  我只需要处理映射。利大于弊。

2.  我会将应用程序服务拉回基础架构，并将 Wcf 视为“适配器”

3.  我将使用命令对象并发送到应用程序服务。不要用域对象污染我的域。

4.  为了降低复杂性，我现在尝试在没有事件/命令来源、消息总线等的情况下进行管理。

此外，我只想链接到Udi Dahan关于 CQRS[的这篇博客文章，我认为这样的事情可以降低复杂性，除非真的需要它们。](http://www.udidahan.com/2011/10/02/why-you-should-be-using-cqrs-almost-everywhere%E2%80%A6/)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-27T21:30:20.810

1.  映射和图层之间存在权衡。存在某些映射的原因之一是适当的抽象不可用或不可行。因此，在层之间进行显式映射通常比尝试实现推断映射的框架更容易，但我离题了；这取决于对这个问题的哲学讨论。

2.  WCF 或 WebAPI 服务应该非常精简。将其视为[六边形架构](http://alistair.cockburn.us/Hexagonal+architecture)中的适配器。它应该将所有内容委托给应用程序服务。术语服务的混淆会导致混淆。总体而言，WCF 或 WebAPI 的目标是使您的域“适应”特定技术，例如 HTTP。WCF 可以被认为是在 DDD 术语中实现了一个**开放的主机服务。**

3.  您提到了 WebAPI，如果您想要 HTTP，它是一种替代方法。最重要的是，要意识到这个适配层的作用。正如您所说，最好让 UI 依赖于 DTO，并且通常是使用 WCF 或 WebAPI 或其他任何东西实现的服务合同。这使事情变得简单，并允许您在不影响开放主机服务的消费者的情况下改变域的实现。

4.  您应该始终注意不必要的复杂性。分层是一种权衡，有时它可能是矫枉过正的。例如，在一个主要是 CRUD 的应用程序中，没有必要分层这么多。此外，如上所述，不要将 WCF 服务视为应用程序服务。相反，请将它们视为传输技术和应用程序服务之间的适配器。反过来，将应用程序服务视为域的外观，无论您的域是使用 DDD 还是事务脚本方法实现的。

5.  真正帮助我理解的是关于六边形架构的参考文章。这样，您可以将您的域视为核心，并围绕它进行分层，使您的域适应基础架构和服务。你所拥有的似乎已经遵循了这些原则。[Vaughn Vernon 的《实现领域驱动设计](http://my.safaribooksonline.com/book/project-management/9780133039900)》是一个很好的、深入的资源，特别是关于架构的章节。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-28T16:18:37.727

> 实现这样的分层架构真的涉及这么多映射，还是我错过了什么？

是的。问题是它不是同一个对象。它是同一对象的不同表示，但专门针对每个用例。视图模型包含更新 GUI 的逻辑，DTO 专门用于传输（可能会被规范化以简化传输）。等等等等。它们可能看起来一样，但实际上并非如此。

您当然可以尝试将所有的修改都放在一个类中，但是当您的应用程序增长时，使用它不会很有趣。

> 是否建议（甚至智能）使用 Wcf 服务来运行这样的主逻辑（它实际上是我的应用程序服务）

你需要某种网络层。我不会让所有客户端应用程序都接触我的数据库。如果您弄乱了数据库模式（如果某些客户端仍在运行旧版本），它将造成维护噩梦。

通过使用服务器，维护版本差异要容易得多。

请注意，一旦使用 WCF 服务定义，就应将其视为常量。任何更改都应在新接口中定义（例如`MyService2`）。

> 如果我的 UI 层中没有我的域对象，是否有 Wcf 的替代品？

你可以看看我的框架。开始发帖：http: [//blog.gauffin.org/2012/10/writing-decoupled-and-scalable-applications-2/](http://blog.gauffin.org/2012/10/writing-decoupled-and-scalable-applications-2/)

> 这个实现有什么问题吗。

不是我能看到的。看起来你已经很好地掌握了这些概念以及应该如何使用它们。

> 有什么需要注意的坠落坑？

不要试图对查询和命令偷懒。不要让它们更通用以适应多个用例。当应用程序增长时，它会回来咬你。较小的类更容易维护。

> 你有什么好的例子可以推荐看，可以帮助我理解所有这些概念应该如何协同工作。

我链接的博客文章和该系列中的所有其他文章。

# sencha-touch-2 - 在面板中呈现列表

> ID：13592904
> 
> 赞同：0
> 
> 时间：2012-11-27T20:57:38.797
> 
> 标签：sencha-touch-2

我有一个面板，可以在其中呈现搜索表单。这行得通。我的问题是在该搜索表单下呈现一个列表（所以在同一个面板中）。

这是我到目前为止所做的：

```
Ext.define("TCM.view.UserSearch", 
{
    extend: "Ext.form.Panel",

    requires: 
    [
        "Ext.form.FieldSet",
        "Ext.List"
    ],

    xtype: "usersearch",

    config: 
    {
        scrollable:'vertical'
    },

    initialize: function () 
    {
        this.callParent(arguments);

        var clubsStore = Ext.create('TCM.store.Clubs');
        clubsStore.load();

        var usersStore = Ext.create('TCM.store.Users');

        var searchButton = 
        {
            xtype: 'button',
            ui: 'action',
            text: 'Search',
            handler: this.onSearchButtonTap,
            scope: this
        };

        var topToolbar = 
        {
            xtype: 'toolbar',
            docked: 'top',
            title: 'Search',
            items: [
                { xtype: 'spacer' },
                searchButton
            ]
        };

        var userClub = 
        {
            xtype: 'selectfield',
            store: clubsStore,
            name: 'clubId',
            label: 'Club',
            displayField : 'name',
            valueField : 'id',
            required: true
        };

        var userList = 
        {
            xtype: 'list',
            store: usersStore,
            itemTpl: '{name}',
            title: 'Search results'
        };

        this.add([
            topToolbar,
            { 
                xtype: "fieldset",
                items: [userClub]
            }, 
            userList
        ]);
    },

    onSearchButtonTap: function () 
    {
        console.log("searchUserCommand");
        this.fireEvent("searchUserCommand", this);
    }
}); 
```

我看不到在字段集（搜索表单）下呈现的任何内容。有什么问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T23:34:45.333

大多数时候，当您看不到组件时，是因为您没有为容器或高度设置[布局。](http://docs.sencha.com/touch/2-1/#!/api/Ext.Container-cfg-layout)

[您可以在此处找到有关布局的更多信息。](http://www.sencha.com/learn/intro-to-layouts-in-sencha-touch-2)

在您的情况下，您希望容器中有两个组件。因此，我建议使用[Vbox 布局](http://docs.sencha.com/touch/2-1/#!/api/Ext.layout.VBox)。

[这是一个例子](http://www.senchafiddle.com/#CBHvj)

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T05:27:05.783

我实际上在一个项目中使用了这样的东西试试这个......把它放在你的字段集的项目属性中......

```
 {
            xtype: 'searchfield',
            clearIcon: true,
            placeHolder: 'Type Some text'
        },
        {
            xtype: 'list',
            hidden:true,  //Initially hidden populate as user types something
            height: '150px',
            pressedDelay: 1,
            loadingText: '',
            store: 'listStore',
            itemTpl: '{\'What you want to be displayed as per your model field\'}'
        } 
```

在您的控制器中，为搜索字段的 keyup 事件编写一个处理程序，以使用相关数据加载存储并切换列表的隐藏属性。希望列表应该与搜索结果一起出现（为我工作并且看起来相当不错）。希望这可以帮助...

# jquery - jquery ui滑块-使用变量设置最大值的问题

> ID：13592907
> 
> 赞同：1
> 
> 时间：2012-11-27T20:57:43.310
> 
> 标签：jquery, jquery-ui, uislider, jquery-ui-slider

我有一个 jquery ui 滑块，我使用一个变量作为滑块的最大步长。问题是滑块在计算变量之前加载，当页面第一次加载时，所以滑块有问题 - 它无法识别最大步数。

我是否需要在代码中找到更好的位置来计算最大变量？还是有更好的选择来解决这个问题？

下面的代码：

```
 $("#slider").slider({
    min: 0,
    max: slider_max,
    step: 1, 
    slide: function (event, ui) {
           some code----
    }); 
```

slider_max = sorted_effective_date.length - 1；--- 在页面加载时计算

第一次加载页面并缓存变量后，滑块工作正常。

# html - HTML MP4 嵌入问题

> ID：13592910
> 
> 赞同：1
> 
> 时间：2012-11-27T20:57:52.573
> 
> 标签：html, css, video, embed

我是 HTML 的初学者，需要一些帮助......这件事让我发疯了 - 我想在我的网站中嵌入一个 HTML 片段，以便在不显示控件的情况下播放一次视频......我也想要它在许多浏览器上工作，经过 2 天的研究，我实现了下面的代码（哇哦！）。唯一的麻烦是当我把代码放在程序中的snippet中时，我无法控制它的位置（我想在它上面放一个小图像，无法得到它后面的视频......）请帮帮我！代码可以修复还是您知道替代方案？（我不想修改标题部分或安装脚本）

```
<video wdith="600" height="300" autoplay>
  <source src="https://sites.google.com/site/privateforsharingfilesbytt/home/docs/Eng.mp4" type="video/mp4" />
  Your browser does not support the video tag.
</video> 
```

[截图](https://sites.google.com/site/privateforsharingfilesbytt/home/docs/Screenshot.jpg) 谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T21:43:21.557

`img`这是一个在视频上叠加的快速示例：

```
<div>
    <img id="overlay_img" src="http://i.imgur.com/i5Gp6.png" width="150" height="150" />

    <video width="560" height="340" controls>
        <source src="http://media.html5media.info/video.mp4" type='video/mp4' />
    </video>
</div>​ 
```

[**JSFiddle 演示**](http://jsfiddle.net/QhZfZ/)

这个想法是使用`img`标签放置图像。然后，我给图像一个`id`我可以调整它在 CSS 中的位置。为了让图像实际覆盖在视频之上，我这样做了`position: absolute`，它允许我设置元素相对于其祖先的位置。

如果您想在图像周围移动，您需要指定`top`, `left`, `bottom`,`right`定位值。

# android - 自我消失的字符串作为Android中状态栏上的通知

> ID：13592911
> 
> 赞同：1
> 
> 时间：2012-11-27T20:57:55.507
> 
> 标签：android, android-notifications

我想在 Android 的状态栏上创建一个通知，它显示一个字符串并在指定时间段后消失而无需用户干预。

我不希望通知启动任何其他活动或服务。

我正在尝试不使用 NotificationCompat`setContentIntent()`并且我的应用程序正在崩溃`java.lang.IllegalArgumentException: contentIntent required`

**我的问题** 如何在不启动其他活动或服务的 Android 中创建自我消失的字符串通知？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T21:00:15.900

你需要`cancel()`自己做。最简单的方法是使用 AlarmManager，在显示通知发生后设置警报`now+offset`，然后取消通知。

# python - 将列表项与同一列表另一端的项匹配？

> ID：13592914
> 
> 赞同：3
> 
> 时间：2012-11-27T20:58:10.410
> 
> 标签：python, awk

我有一个任意偶数项目的列表。

输入数据：

```
Red
Orange
Yellow
Green
Blue
Violet 
```

输出数据：

```
Red -> Violet
Violet -> Orange
Orange -> Blue
Blue -> Yellow
Yellow -> Green
Green -> Red 
```

这个想法是最高的项目与最低的项目匹配，我想有点从堆栈的两端弹出东西。一旦堆栈用完，剩下的最后一场比赛就是我们开始的比赛。

我从这个开始：

```
awk '{a[NR]=$0} END {for (i=1;i<=NR;i++) {printf("%s -> %s\n",a[i],a[NR-i+1])}}' 
```

它从上到下匹配，但不会“弹出”。

这在awk中可能吗？

注意：我已标记此“python”，因为虽然我不知道如何在 python 中执行此操作，但我非常*想*知道，如果它比 awk 答案更优雅，我会接受 python 答案。:-)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T21:03:24.443

这是一个 Python 解决方案：

```
data = ['Red', 'Orange', 'Yellow', 'Green', 'Blue', 'Violet']
first = data[0]
while data:
    a, b = data[0], data[-1]
    data = data[1:-1]
    print '{} -> {}'.format(a, b)
    print '{} -> {}'.format(b, data[0] if data else first) 
```

这里的起点是数据列表，如果您需要从文件中读取输入，您可以使用以下内容来填充`data`：

```
data = [line.strip() for line in open(filename)] 
```

如果要从标准输入读取数据，可以使用以下命令：

```
import sys
data = [line.strip() for line in sys.stdin] 
```

为了有效地从列表的开头和结尾删除，请使用[collections.deque](http://docs.python.org/2/library/collections.html#collections.deque)。如果您从标准输入读取，这将是这样的：

```
import sys
import collections

data = collections.deque(line.strip() for line in sys.stdin)
first = data[0]
while data:
    a, b = data.popleft(), data.pop()
    print '{} -> {}'.format(a, b)
    print '{} -> {}'.format(b, data[0] if data else first) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T21:04:21.657

在我看来，您想逐个遍历输入数据。

根据您的代码，这是 awk 的开始：

```
[ghoti@pc ~]$ awk '{a[NR]=$0} END {for (i=2;i<=NR;i+=2) {printf("%-10s -> %s\n",a[i/2],a[NR-i/2+1]); printf("%-10s -> %s\n",a[NR-i/2+1],a[i/2+1]);}}' colours
Red        -> Violet
Violet     -> Orange
Orange     -> Blue
Blue       -> Yellow
Yellow     -> Green
Green      -> Green 
```

当然，这不处理最后一行中的“换行”情况。为此，我们可以稍微扩展一下代码。在这里，不再是 1-liner：

```
{a[NR]=$0}

END {
  for (i=2;i<NR;i+=2) {
    printf("%-10s -> %s\n",a[i/2],a[NR-i/2+1]);
    printf("%-10s -> %s\n",a[NR-i/2+1],a[i/2+1]);
  }
  printf("%-10s -> %s\n",a[i/2],a[NR-i/2+1]);
  printf("%-10s -> %s\n",a[NR-i/2+1],a[1]);
} 
```

注意 final 的最后一个选项的区别`printf()`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T21:24:43.140

由于您更喜欢 awk 解决方案，请尝试以下解决方案：

```
awk '{a[NR]=$0}END{
for (i=1;i<=NR;i++){
    t=NR-i+1;
    print a[i]"->"a[t]
    if(t!=i+1)
        print a[t]"->"a[i+1]
    else{
        print a[t]"->"a[1]
        exit;
    }
}
}' file 
```

测试

```
kent$  cat test.txt
Red
Orange
Yellow
Green
Blue
Violet

kent$  awk '{a[NR]=$0}END{
for (i=1;i<=NR;i++){
        t=NR-i+1;
        print a[i]"->"a[t]
        if(t!=i+1)
                print a[t]"->"a[i+1]
        else{
                print a[t]"->"a[1]
                exit;
        }
}
}' test.txt
Red->Violet
Violet->Orange
Orange->Blue
Blue->Yellow
Yellow->Green
Green->Red 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-27T23:02:26.617

不是 awk 或 python 的答案，但你已经收到了很多。这是使用 GNU coreutils 和 sed 的一种方法。

看到第一列是列表的顶部和底部的混合，并且第二列是相同的，但是行向上旋转了一个，有几个习语会有所帮助。

混合顶部和底部的行，但只抓取列表的上半部分：

```
len=$(wc -l < colours)
paste -d '\n' colours <(tac colours) | head -n $len > colours.mixed 
```

内容`colors.mixed`：

```
Red
Violet
Orange
Blue
Yellow
Green 
```

将行向上旋转一：

```
(tail -n+2 colours.mixed; head -n1 colours.mixed) > colours.mixed.rotated 
```

输出：

```
Violet
Orange
Blue
Yellow
Green
Red 
```

综合起来，这给出了预期的结果：

```
paste colours.mixed colours.mixed.rotated | sed 's/\t/ -> /' 
```

结果：

```
Red -> Violet
Violet -> Orange
Orange -> Blue
Blue -> Yellow
Yellow -> Green
Green -> Red 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-27T21:30:06.977

没有任何 IO，但假设它`colours`作为列表加载，然后是 Python 解决方案（尽管它可以进行一些调整以使其更懒惰）：

```
colours = ['Red', 'Orange', 'Yellow', 'Green', 'Blue', 'Violet']

from itertools import islice, chain, izip_longest

together = zip(colours, reversed(colours))
flattened = list(islice(chain.from_iterable(together), len(colours)))
for a, b in izip_longest(flattened, flattened[1:], fillvalue=flattened[0]):
    print '{} -> {}'.format(a, b)

Red -> Violet
Violet -> Orange
Orange -> Blue
Blue -> Yellow
Yellow -> Green
Green -> Red 
```

要获得`colours`，您可以使用：

```
import sys
colours = [line.strip() for line in sys.stdin] 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-27T21:44:28.187

这是另一个python解决方案。注意，该项的值`(i&1)`是 i 的低位，`(i<n-2)`如果 i 小于 n-2，该项的值为 1，否则为 0。

```
s = ['Red', 'Orange', 'Yellow', 'Green', 'Blue', 'Violet']
n=len(s); j, k = 0, n-1
for i in range(n):
    print s[j], s[k]
    j, k = k, (n-k-(i&1))*(i<n-2) 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-27T22:08:08.600

我对您要执行的操作感到非常困惑，因为您的起点似乎是一个脚本，它可以准确地产生您发布的所需输出！

显然我错过了一些东西，但这是你正在寻找的东西：

```
awk '{a[NR]=$0} END{bos=1; tos=NR; while (bos < tos) {print a[bos] " -> " a[tos]; delete a[tos--]; delete a[bos++] } }'  file
Red -> Violet
Orange -> Blue
Yellow -> Green 
```

我的脚本和你的不同之处在于，你的脚本会保持“a”不变，但是当我的脚本完成后，如果“a”中最初有偶数个元素，那么它将为空，但如果有奇数，那么初始中间元素将是“a”中剩下的所有元素。例如：

```
$ cat file                                                                    
Red
Orange
Yellow
Purple
Green
Blue
Violet

$ awk '{a[NR]=$0} END{bos=1; tos=NR; while (bos < tos) {print a[bos] " -> " a[tos]; delete a[tos--]; delete a[bos++] } for (i in a) print a[i] }'  file
Red -> Violet
Orange -> Blue
Yellow -> Green
Purple 
```

# r - 如何将gwindow放在R主窗口内

> ID：13592917
> 
> 赞同：0
> 
> 时间：2012-11-27T20:58:29.067
> 
> 标签：r, gwidgets

我正在使用`gwindow()`函数在 R 的 gwidgets 中打开新窗口。但它会在 Windows 中打开新窗口。我希望它在 R 主窗口中打开一个子**窗口**。我怎么能强迫它？有一个功能选项`parent`，`gwindow()`但我需要一个主 R 窗口的句柄......

# javascript - 动态 div 内容 + 向后保留浏览器上最后查看的 div

> ID：13592918
> 
> 赞同：0
> 
> 时间：2012-11-27T20:58:30.770
> 
> 标签：javascript, html

我正在使用动态 div 内容并在点击时在它们之间切换，效果很好，但是当用户在浏览器上向前和向后点击时，有没有办法保留最后查看的 div？谢谢。

```
 <script>
          $(".settings").click(function() {
            var id = this.id;
            if ($("." + $(this).attr('rel')).css('display') == 'none') {
                $('.n_tab').hide();
                $('.p_tab').hide();
                ($("." + $(this).attr('rel')).show());
            }

        });
     </script>

     <div class="settings" rel="n_tab">
            <div class="title info_2_Title">
                Notifications</div>
     </div>
     <div class="settings" rel="p_tab">
            <div class="title info_2_Title">
                Privacy</div>
     </div>

     <div id="MasterContainer">
       <div class="n_tab" style="display: none;"> the N DIV </div>
       <div class="p_tab" style="display: none;"> the P DIV </div> 
     </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T21:07:00.757

尝试使用[history.js 之](https://github.com/balupton/History.js/)类的库来设置它。在内部，它将使用`pushState`API，或者如果浏览器不支持，则回退到 url 片段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T22:24:09.380

您可以尝试在每个选项卡中添加一个 id，并在每次选择 div 时将其附加到对象或数组中。在点击事件之外定义一个数组`history = [];`，在您的点击事件中定义一个类似的数组

```
history.push($(this).id); 
```

如果您想保留更详细的数据，您可以使用 json 对象并附加到它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T07:30:43.917

感谢大家的帮助，但是在摆弄了 History.js 之后，我仍然无法让它工作，最后我使用了一个 cookie 来存储状态，然后在加载动态 div 的页面时检查它。

```
 $(function() {
            var x = $.cookie('tab_cookie');
            ($(x).show());
            if (x == '.m_tab') {
                var btn = document.getElementById('<%= btnLoadm.ClientID %>');
                if (btn) btn.click();
            }
        }); 
```

# linux - linux eclipse：运行一个shell命令作为预构建命令

> ID：13592919
> 
> 赞同：1
> 
> 时间：2012-11-27T20:58:35.523
> 
> 标签：linux, eclipse, eclipse-cdt

如何让 eclipse/CDT (Linux) 中的预构建步骤运行一个简单的 shell 命令，特别是 echo。我认为 Eclipse 对 PKG_CONFIG_PATH 的值搞砸了，想看看 Linux 认为该值是什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T21:14:48.907

在幕后，Eclipse 使用“make”。您可以简单地编辑项目的 makefile：

*   help.eclipse.org/galileo/index.jsp?topic=/org.eclipse.cdt.doc.user/concepts/cdt_c_makefile.htm

您还可以创建：

> “外部工具”，位于工具栏中的“调试”和“运行”按钮旁边。然后我告诉外部工具使用配置脚本和它的任何参数作为工具的参数运行 shell。
> 
> [http://www.eclipse.org/forums/index.php/t/61866/](http://www.eclipse.org/forums/index.php/t/61866/)

# php - Symfony 2 表单继承

> ID：13592920
> 
> 赞同：2
> 
> 时间：2012-11-27T20:58:36.260
> 
> 标签：php, symfony, doctrine-orm

我遇到了使用 symfony2 和教义 2 进行表单继承的问题。事情是这样的：

我有一个`users`没有什么特别的实体，只有几个字段，名称、电子邮件等......

```
Ferncoder\Devis\UserBundle\Entity\users:
  type: entity
  table: null
  fields:
    id:
      type: integer
      id: true
      unsigned: true
      nullable: false
      generator:
        strategy: AUTO
    name:
      type: string
      length: '45'
      nullable: false 
```

我有一个实体`craftsMans`，这个表与实体有 OneToOne 关系`users`。

```
Ferncoder\Devis\UserBundle\Entity\craftsMan:
  type: entity
  oneToOne:
    user:
      targetEntity: users
      joinColumn:
        name: user_id
        referencedColumnName: id
  table: null
  fields:
    id:
      type: integer
      id: true
      unsigned: true
      nullable: false
      generator:
        strategy: AUTO 
```

我已经生成了 2 个表单类`usersType`和`craftsmanType`. 为了创建我的 craftsMan 我已经完成了这样的表格：

```
class craftsManType extends AbstractType
{
    public function buildForm(FormBuilder $builder, array $options)
    {
        $builder
            ->add('user', new usersType())
            ->add('company', 'text')
            ->add('fieldOfActivities', 'text')
            ->add('legalForm', 'text')
            ->add('siret', 'text')
            ->add('website', 'text')
            ->add('description', 'textarea')
            ->add('services', 'textarea')
            ->add('employee', 'text')
            ->add('phone', 'text')
        ;
    } 
```

在我想获取字段值之前，我的表单看起来很酷。问题是我的`'user'`字段是作为数组而不是作为实体返回的。我错过了什么吗？如何从该字段生成我的用户对象`user`。我不觉得创建对象可能设置所有属性是最好的方法。

也许我错了。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T15:05:44.887

您必须设置 data_class 选项以返回对象而不是数组。下面的文档解释了当表单嵌入到另一个表单中时，有必要使用 data_class。

文档：[http ://symfony.com/doc/current/book/forms.html#book-forms-data-class](http://symfony.com/doc/current/book/forms.html#book-forms-data-class)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T00:55:56.173

在您的控制器中：

```
$form->getData()->getUser(); 
```

# apache-flex - 如何在 Flex 桌面原生 (Air) 应用程序上设置更高的分辨率？

> ID：13592921
> 
> 赞同：5
> 
> 时间：2012-11-27T20:58:36.540
> 
> 标签：apache-flex, air, resolution

我正在尝试更改在视网膜 macbook 上运行的 flex 本机应用程序（空气）应用程序的分辨率。浏览器中的 Flex 应用程序会自动以 160dpi 流畅地渲染所有内容，但如果我构建与 Air 安装应用程序相同的应用程序，它会以 72dpi 渲染，看起来不太好。我知道您可以在应用程序描述符文件中为移动应用程序设置分辨率，但这不是一个。另外，我也尝试在 WindowedApplication 标签上设置 applicationDPI 属性，但没有成功。有任何想法吗？谢谢...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-03-02T11:07:01.790

作为记录，要在运行在 Retina Macbook Pro 上的 AIR 桌面应用程序中启用高分辨率渲染，请在应用程序描述符 XML`<requestedDisplayResolution>high</requestedDisplayResolution>`的`<initialWindow>`部分中进行设置。需要 Adob​​e AIR 3.6 或更高版本。

[http://help.adobe.com/en_US/air/build/WSfffb011ac560372f2fea1812938a6e463-8000.html#WSfffb011ac560372f-4cb7055d12d779150e8-8000](http://help.adobe.com/en_US/air/build/WSfffb011ac560372f2fea1812938a6e463-8000.html#WSfffb011ac560372f-4cb7055d12d779150e8-8000)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-10T10:36:47.007

[http://gregsramblings.com/2010/05/06/scaling-an-adobe-air-application-to-fit-multiple-resolutions-and-netbooks/](http://gregsramblings.com/2010/05/06/scaling-an-adobe-air-application-to-fit-multiple-resolutions-and-netbooks/)

<mx:WindowedApplication xmlns:mx=" [http://www.adobe.com/2006/mxml](http://www.adobe.com/2006/mxml&quot) " ; width="1019" height="680" scaleX="0.8" scaleY="0.8" applicationComplete="init()" ...>

<mx:WindowedApplication xmlns:mx=" [http://www.adobe.com/2006/mxml](http://www.adobe.com/2006/mxml&quot) " ; width="1019" height="680" preinitialize="initScreenSize()" applicationComplete="init()" ... > ... ... 私有函数 initScreenSize():void{ var thisScreen:Screen = Screen.mainScreen; var newScaleX:Number = thisScreen.visibleBounds.width / 1019 * 0.98; var newScaleY:Number = thisScreen.visibleBounds.height / 680 * 0.98; var newScale:Number = Math.min(newScaleX,newScaleY,1); this.scaleX = newScale; this.scaleY = newScale; this.height = this.height * newScale; this.width = this.width *新规模；}

根据用户的分辨率缩放应用程序。这是代码：

# drupal - Drupal Commerce Kickstart v2 付款前批准订单

> ID：13592928
> 
> 赞同：3
> 
> 时间：2012-11-27T20:58:57.770
> 
> 标签：drupal, drupal-commerce, drupal-rules

我正在使用 commerce kickstart v2 构建概念验证电子商务解决方案

我希望实现一个系统，用户可以提交订单，但管理员必须在客户付款之前批准订单 - 我觉得我可以通过规则和额外的订单状态来做到这一点，但我无法弄清楚结账过程的哪一部分干预。继承人我到目前为止：

1.  额外订单状态“等待管理员批准”
2.  额外的订单状态“由管理员批准”
3.  当订单状态从“购物车”变为“结帐”并将订单设置为“等待管理员批准”时触发的规则
4.  当订单状态为“等待管理员批准”且路径包含“结帐”时触发的规则。此规则将用户重定向到显示“您的订单正在等待批准”的页面
5.  *管理员将订单状态更改为“已由管理员批准”后应允许用户结帐的规则*

上面的规则 5（斜体）给我带来了问题，无论我尝试什么 - 规则 #3 总是触发，即使在订单被批准后，这会导致用户被重定向。

问题出现了，因为一旦订单被设置为“由管理员批准”，它必须回到“购物车”，然后是“结帐”......然后触发规则 3，这让我很好地绕了一圈.

有什么提示或建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-23T12:31:23.553

对于规则 3 **，添加另一个条件：订单状态“由管理员批准”的数据比较，带有否定选项（底部的复选框）**。因此，如果您将订单状态更改为“由管理员批准”，则此规则将不再触发，因为此条件将返回 FALSE。

此外，在规则 5 中，您可以创建一个操作以向买家**发送包含结帐链接的电子邮件。**

# c# - 使用javascript禁用单击后提交按钮未触发

> ID：13592931
> 
> 赞同：0
> 
> 时间：2012-11-27T20:59:08.113
> 
> 标签：c#, javascript, asp.net-mvc

我试图在单击按钮后禁用它，以便无法双击它。

这就是我所拥有的：

```
<input id="btn" type="button" disabled="disabled" value="Log On" onclick="logonDisableSubmitButtons()"/> 
```

还有我的 javascript：

```
function logonDisableSubmitButtons(clickedButton) {

    $("input[type='button']").each(function() {
      if (this.name != clickedButton)
        $(this).attr("disabled", "disabled");
      else {
        //hiding the actually clicked button
        $(this).hide();
        //Creating dummy button to same like clicked button
        $(this).after('<input type="button" disabled="disabled" value="' + $(this).val() + '" class="' + $(this).attr('class') + '" />');
      }
    });

  } 
```

该按钮禁用，但它不提交表单。

单击后如何禁用它然后提交表单？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T21:02:01.307

使用`submit`输入而不是`button`输入：

```
<input id="btn" type="submit" disabled="disabled" value="Log On" onclick="logonDisableSubmitButtons()"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T21:22:14.123

`onclick`通过从输入中删除属性并简单地将 click 事件绑定到 上，您可以更轻松地管理它`$(document).ready();`，如下所示：

```
 <form id="myForm">
        <input type="submit" id="myInput" value="click me"/> <br />
        <input type="button" class="someClass" value="random button 1" />
        <input type="button" class="someClass" value="random button 2" />
        <input type="button" class="someClass" value="random button 3" />
        <input type="button" class="someClass" value="random button 4" />
    </form>

<script type="text/javascript">
$(document).ready(function(){
    $('#myInput').click(function(e){  
        e.preventDefault(); //<--this prevents the form from being submitted on click.        
        logonDisableSubmitButtons(this);
    });
});
function logonDisableSubmitButtons(clickedButton) {
    $(clickedButton).attr("disabled", "disabled");
    $("input[type='button']").each(function(i, input) {
            $(input).hide();
            $(this).after(
                '<input type="button" disabled="disabled" value="' + 
                $(this).val() + " from logonDisableSubmitButtons() method" +
                '" class="' +
                $(this).attr('class') + '" />'
            );
    });
    $("#myForm").submit(); //<--this will submit the form
}​
    </script> 
```

[这是](http://jsfiddle.net/eJUxW/2/ "工作提交示例")关于 jsFiddle 的一个工作示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T21:01:01.563

在禁用按钮的同一块中使用 submit() 方法手动提交表单。

# drupal - Drupal 6.x 添加更多模块 - 添加更多

> ID：13592932
> 
> 赞同：4
> 
> 时间：2012-11-27T20:59:13.770
> 
> 标签：drupal, drupal-6, drupal-webform

对于所有处理 Drupal 6.x 的人来说，一个简单的问题......

使用 Drupal 的 Add More 模块，有没有办法配置我的网络表单，这样我可以添加更多的特定字段的数量没有限制？

请看我的图片，例如：

![在此处输入图像描述](../Images/ee83f0368bdc8b8a693b33e3938f775d.png)

例如，我想让用户添加任意​​数量的标题。那可行吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-03T21:58:45.037

不幸的是，目前无法通过网络表单添加无限制的“添加另一个”功能。如果有一天这个功能真的成为现实，我怀疑它会被向后移植到模块的 Drupal 6 版本。来自网络表单模块作者（[quicksketch](http://drupal.org/node/354381#comment-2414234)）：

> 在这个问题上没有任何进展。支持多个值的能力需要大量的重新架构，包括更改 CSV 的生成方式、分析、数据库结构和 UI（适用于管理员和用户）。我不希望很快添加此功能。

有关更多信息，请参阅此线程：http: [//drupal.org/node/354381](http://drupal.org/node/354381)

我建议使用节点和 CCK 模块以及规则和视图来收集这些信息。

假设：

*   匿名用户可以填写当前表格
*   您需要某种方式来检索提交的数据
*   该网站的普通用户应该无法查看提交的内容

非常宽松的方向：

1.  创建一个内容类型并将当前 Web 表单包含的所有字段添加到其中。CCK 具有开箱即用存储无限值的能力。在字段设置页面的“全局设置”字段集中，为“值的数量”字段选择“无限制”。
2.  授予匿名用户在角色权限页面上创建 [your-new-content-type] 内容的权限。
3.  使用规则模块，创建一个触发“内容即将被查看”的新触发规则，条件为“内容具有类型 [your-new-content-type]”和重定向到主页的操作（或自定义错误您创建的页面）。（注意：这有点影响性能。有更好的方法来限制对这种内容类型的访问，但为了本教程，这是最容易解释的）
4.  使用 Views 模块，创建一个 Style 设置为 Table 的新视图。在字段部分的 [your-new-content-type] 中添加每个字段。在“访问”下选择“角色”并选择分配给您的用户的角色。添加一个“页面”显示，给它一个路径并保存。这是您将用于查看提交的页面。

可选的：

*   创建 [your-new-content-type] 节点时，使用规则模块向您自己（或提交者）发送电子邮件。

# java - 在 selenium 中使用 javascript 来监听 AJAX 请求

> ID：13592933
> 
> 赞同：1
> 
> 时间：2012-11-27T20:59:13.900
> 
> 标签：java, javascript, ajax, selenium

所以我知道如何使用 Selenium，我想创建一个聊天机器人。但是，我无权访问源代码，并且聊天是自定义编写的页面。此页面正在发出 GET 请求，然后该站点正在返回我想要的内容。我想使用 Selenium 运行 javascript（我知道该怎么做），它要么等待下一个 GET 返回，要么返回最新的 GET 返回。那时我可以解析出我不需要的东西。

我曾尝试寻找一个 javascript 函数来执行此操作，但我所能做的就是找到侦听请求而不是响应的函数。谢谢！注意：我将在接下来的一段时间内保持在此页面上的活动，所以如果您需要代码等，请务必询问！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T13:02:40.893

如何使用 fluentWait() 机制等待所有 ajax：

```
public WebElement fluentWait(final By locator){
        Wait<WebDriver> wait = new FluentWait<WebDriver>(driver)
                .withTimeout(30, TimeUnit.SECONDS)
                .pollingEvery(5, TimeUnit.SECONDS)
        .ignoring(org.openqa.selenium.NoSuchElementException.class);
        WebElement foo = wait.until(
                new Function<WebDriver, WebElement>() {
                    public WebElement apply(WebDriver driver) {
                        return driver.findElement(locator);
                    }
                }
        );
        return  foo;              }     ;

fluentWait(By.xpath(...blablabla...));
//fluentWait(By.cssSelector(...blablabla...)); 
```

然后能够像这样进行js注入：

```
 public void jsCodeExecution(String jsCode){
        JavascriptExecutor js = (JavascriptExecutor)driver;
        StringBuilder stringBuilder = new StringBuilder();
        stringBuilder.append(jsCode);
        js.executeScript(stringBuilder.toString());
    } 
```

或立即使用 jsInjection。[JavaScript 如何处理 AJAX 响应](https://stackoverflow.com/questions/7575589/how-does-javascript-handle-ajax-responses-in-the-background)

# php - 使用单页网站登录时出现问题

> ID：13592935
> 
> 赞同：-1
> 
> 时间：2012-11-27T20:59:23.590
> 
> 标签：php, javascript, login, logout

我的登录过程有问题。我正在使用会话并重新加载，以便我可以拥有一个单页网站。在 Chrome 上，这会增加一个 ? 所以 url 的结尾（任何时候 ? 存在，登录不起作用）。在 Firefox 和 Chrome 上，登录-注销过程只运行一次，然后登录停止工作。我的 index.php 页面上有一个 if 语句，它基本上是：

```
if($_SESSION["LoggedIn"] != true) {
    /*display login button*/
}
else {
    /*display logout button*/
} 
```

然后我设置我的脚本文件：

```
 $("#toolbarTitle-Login").click(function() {
        var loginEmail = $("#toolbarTextbox-Email").val();
        var loginPassword = $("#toolbarTextbox-Password").val();
        if (loginEmail != "") {
            $("#toolbarPleaseWait").text("Please wait...");
            $.post(
                'ajax/loginProcess.php', 
                {
                    'email': loginEmail,
                    'password': loginPassword
                },
                function (response) {
                    window.location.reload(true);
                }
            );
        }
    });

    $("#toolbarTitleLoggedIn-Logout").click(function() {
        $("#toolbarPleaseWait").text("Logging out...");
            $.post(
                'ajax/logoutProcess.php', 
                {
                },
                function (response) {
                    window.location.reload(true);
                }
            );
    }); 
```

然后我的处理页面loginProcess.php：

```
<?php
session_start();

include "../incl/databaseConnection.php";

$email = $connection->real_escape_string($_POST["email"]);
$password = $connection->real_escape_string(md5($_POST["password"]));

$sql = "SELECT clientId
        FROM clients
        WHERE (studentEmail = '$email' AND studentPassword = '$password') OR (parentEmail = '$email' AND parentPassword = '$password');";

if (!$result = $connection->query($sql)) {
    die ('There was an error running the query [' . $connection->error . ']');
}

$rows = $result->num_rows;
$row = $result->fetch_assoc();

if ($rows == 1) {
$_SESSION["loggedIn"] = true;
$_SESSION["clientId"] = $row["clientId"];

}
else if ($rows > 1) {
echo 'CHOOSE BETWEEN ACCOUNTS';
}
else if ($rows == 0) {
echo 'SHOW ERROR MESSAGE';
}

$connection->close();

?> 
```

下一个 logoutProcess.php：

```
<?php
session_start();
session_unset();

?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T22:03:08.753

终于让该死的东西工作了！您将需要`session_destroy()`在您的`logout.php`文件中使用并在您的 JS 中使用 AJAX 调用，以下是代码片段：

在你的 JS 中：

```
$.ajax({
    url: "logout.php",
    context: document.body
}).done(function() { 
    window.location.reload(true);
}); 
```

在您的 logout.php 文件中：

```
<?php
session_start();

session_destroy();
?> 
```

这应该有预期的结果。

还要注意，我没有遇到同样的问题？在 URL 的 和 处，根本不知道它来自哪里。只是提供了最简单的有效解决方案（至少对我来说是这样）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T01:25:56.850

好的，所以它最终是一个非常简单的修复。我没有包括`return false;`在我的 ajax 帖子下面。这导致页面在我按下提交按钮后立即重新加载（此操作发生在 jquery 触发之前），这是`<input type="submit">`. 这 ”？” 是此提交的指示，并表明没有未定义任何 POST 变量，否则它们将列在它旁边。

```
 $("#toolbarTitle-Login").click(function() {
        var loginEmail = $("#toolbarTextbox-Email").val();
        var loginPassword = $("#toolbarTextbox-Password").val();
        if (loginEmail != "") {
            $("#toolbarPleaseWait").text("Please wait...");
            $.post(
                'ajax/loginProcess.php', 
                {
                    'email': loginEmail,
                    'password': loginPassword
                },
                function (response) {
                    window.location.reload(true);
                }
            );
            return false;
        }
    });

    $("#toolbarTitleLoggedIn-Logout").click(function() {
        $("#toolbarPleaseWait").text("Logging out...");

        $.ajax({
            url: "ajax/logoutProcess.php",
            context: document.body
        }).done(function() { 
            window.location.reload(true);
        });
        return false;
    }); 
```

# flash - 网站上的 Flash 适用于 Flash 查看器 10，但不适用于 11

> ID：13592938
> 
> 赞同：0
> 
> 时间：2012-11-27T20:59:27.210
> 
> 标签：flash

在我的 DotNetNuke 网站上，我有一个 Flash 播放器，它显示旋转通过几张图像。 `http://www.capitoltrack.com/desktopmodules/Flash%20Image%20Rotator/DataSprings_FlashRotator.swf?cachekill=825&version=3.0&filename=/Portals/19/DataSprings_FlashImageRotator_988_3e2fcc72_b472_4b56_96d7_c432de5c138f.xml`

突然之间，它不再在 IE、Chrome 或 Firefox 中显示图像。我下载了版本 10 和 11 的独立 Flash 播放器。

上面的链接在 10 中有效，但在 11 中无效。知道为什么吗？...以及如何修复版本 11？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T23:42:42.283

由 Flash 更新到 11.5 修复。

# java - 通过 JWS 和生成的 JNLP 部署 Java 应用程序

> ID：13592940
> 
> 赞同：2
> 
> 时间：2012-11-27T20:59:31.260
> 
> 标签：java, tomcat, servlets, jnlp, java-web-start

我是相当自学的java，但我认为我有一个好主意，直​​到我无法让它工作。

部署我的服务器/客户端程序的最佳方式是什么？

可以说我的服务器已启动并忠实地等待连接。

我需要能够让客户端运行我的应用程序，但需要使用特定于用户的参数。

是什么阻止我在我的网站上的 servlet 中“动态”生成 JNLP（这样我就可以获得自定义参数），如下所示：

```
String jnlpCodebase = "http://" + request.getLocalAddr() + ":" + request.getLocalPort() + request.getContextPath();
out.println("<?xml version=\"1.0\" encoding=\"UTF-8\"?>");
out.println("<jnlp spec=\"1.0+\" codebase=\"" + jnlpCodebase + "\">");
out.println("<information>");
out.println("   <title>etc</title>");
out.println("   <vendor>etc</vendor>");
out.println("</information>");
out.println("<security>");
out.println("   <all-permissions/>");
out.println("</security>");
out.println("<resources>");
out.println("   <j2se version=\"1.6+\"/>");
out.println("   <jar href=\"web/MyGame.jar\" main=\"true\"/>");
out.println("</resources>");
out.println("<application-desc main-class=\"runtime.SSCCEServer\">");
out.println("   <argument>" + name + "</argument>");
out.println("</application-desc>");
out.println("</jnlp>"); 
```

（其中 name 是来自 servlet 的 java 变量）

用户单击一个按钮 -> 转发到生成 JNLP 并触发 JWS 的 servlet -> 下载应用程序 -> 用户呈现我可爱的客户端 GUI。

因为这没有发生。

我已将项目（包含此 servlet 和 WEB-INF 下的 jar 依赖项）部署为 WAR 文件，然后将其部署到 Tomcat 服务器。

WEB-INF 有 lib/、类（它只有上面描述的构建的 servlet .class 文件）和一个 web.xml（描述 servlet、到它的名称的映射并描述 JDBC 连接）。

谁能想到这个设计会失败的任何原因？我尝试过不使用代码库，但这会产生一些非常不直观的错误，至少目前，我的 JNLP 文件似乎很好（通过[http://pscode.org/janela/](http://pscode.org/janela/)验证），但是运行会给出：

```
#### Java Web Start Error:
#### Unable to load resource: .../MyGame.jar 
```

带有包装的异常

```
java.util.zip.ZipException: ZIP file must have at least one entry
at java.util.zip.ZipOutputStream.finish(Unknown Source)
at java.util.zip.DeflaterOutputStream.close(Unknown Source)
at java.util.zip.ZipOutputStream.close(Unknown Source)
at com.sun.deploy.net.HttpDownloadHelper.download(Unknown Source)
at com.sun.deploy.cache.Cache.downloadResourceToTempFile(Unknown Source)
at com.sun.deploy.cache.Cache.downloadResourceToCache(Unknown Source)
at com.sun.deploy.net.DownloadEngine.actionDownload(Unknown Source)
at com.sun.deploy.net.DownloadEngine.getCacheEntry(Unknown Source)
at com.sun.deploy.net.DownloadEngine.getCacheEntry(Unknown Source)
at com.sun.deploy.net.DownloadEngine.getResourceCacheEntry(Unknown Source)
at com.sun.deploy.net.DownloadEngine.getResourceCacheEntry(Unknown Source)
at com.sun.deploy.net.DownloadEngine.getResource(Unknown Source)
at com.sun.javaws.LaunchDownload$DownloadTask.call(Unknown Source)
at java.util.concurrent.FutureTask$Sync.innerRun(Unknown Source)
at java.util.concurrent.FutureTask.run(Unknown Source)
at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(Unknown Source)
at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
at java.lang.Thread.run(Unknown Source) 
```

谷歌对特定例外没有太多帮助，但如果没有正当理由说明这不应该起作用，我会继续尝试。

**编辑1：**更改了jar文件的布局并删除了一些库（特别是war文件中的mysql库？），因为不需要将它们与jar捆绑在一起。这已经停止了上述错误。我*认为*那里可能有问题？我还在 JNLP 中的 j2se 标记中添加了一个 href ......

```
<resources>
<j2se version="1.6+" href="http://java.sun.com/products/autodl/j2se"/>
<jar href="web/MyGame.jar" main="true"/>
</resources> 
```

这似乎现在在本地运行。

**编辑 2：**无论我在哪里放置必要的 ext 库，仍然无法通过 NoCLassDefFoundException (NCDFE)。log4j-1.2.17.jar 应该去哪里？我原本以为在 WAR 文件的 WEB-INF/lib 文件夹中，以及**Class-Path: 行。**在 META-INF/MANIFEST.MF 文件中的**lib/log4j-1.2.17.jar 。**但这仍然显示了 NCDFE，所以我将它风车到其他文件夹中，更改了清单，甚至尝试将 ext lib 放入 JAR 而不是 WAR，但无济于事。它应该去哪里..只是让我很清楚。（JAR 和 WAR 文件以及 WEB-INF 文件夹的清单中应该包含什么？）我在 t'internets 上查看了很多 NCDFE 帖子，我认为这一切都变得非常混乱。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T22:49:40.550

资源`web/MyGame.jar`应位于`web`您的战争文件的子目录中。那么你的战争中有以下布局吗？

```
app.war
  META-INF/
    MANIFEST.MF
  WEB-INF/
    web.xml
    classes/
      *.class
    lib/
      *.lib
  web/
    MyGame.jar 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T13:32:39.853

不幸的是，其中一个“玩弄并修复它”。我已将 MyGame.jar 与 .jsps（WAR 的根目录）放在同一个位置，MANIFEST 指的是 lib 文件夹中的扩展 jars（Class-Path:)。我确定我以前有过。

# javascript - javascript localStorage 和 1 个键中有多少数据

> ID：13592942
> 
> 赞同：1
> 
> 时间：2012-11-27T20:59:38.597
> 
> 标签：javascript, json, local-storage

> **可能重复：**
> [localStorage 值的最大大小是多少？](https://stackoverflow.com/questions/2989284/what-is-the-max-size-of-localstorage-values)

我正在考虑制作一个将 localStorage 视为更像一个 DB 的小库，其中 1 个键将是 1 个“表”，它的记录将是我通过 JSON 区分并由 /r 分隔的对象。

这意味着 1 个密钥中的数据可能会变得相当大。**所以我的问题是，您可以在 1 个密钥中存储多少数据。**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T21:05:55.213

我不相信可以存储在单个密钥中的数据大小有限制。但是，分配给域的整体存储空间存在特定于浏览器的（有时是可配置的）限制。5MB 是这里的标准，尽管实现方式有所不同。

# c++ - 尝试在多个 LED 上的 arduino 上淡入淡出的奇怪问题

> ID：13592945
> 
> 赞同：0
> 
> 时间：2012-11-27T20:59:51.073
> 
> 标签：c++, arduino

我正在尝试在 Arduino Uno 上的多个 LED 上测试 Fade。这是我写的代码

```
int led[2] = {9,10};           // the pin that the LED is attached to
int brightness[2] = {0,0};    // how bright the LED is
int fadeAmount[2] = {5,15};    // how many points to fade the LED by
long previousMillis[2] = {0,0};        // will store last time LED was updated

long interval[2] = {30, 50};
// the setup routine runs once when you press reset:
void setup()  { 
  // declare pin 9 to be an output:
   pinMode(led[0], OUTPUT);
   pinMode(led[1], OUTPUT);
   Serial.begin(9600);
 } 

 // the loop routine runs over and over again forever:
 void loop()  { 
   // set the brightness of pins:

   for (int counter = 0; counter < 2; counter++) {
     unsigned long currentMillis = millis();

     analogWrite(led[counter], brightness[counter]);
     Serial.print("LED ");
     Serial.print(led[counter]);
     Serial.print(": Brightness ");
     Serial.println(brightness[counter]);    

     if (currentMillis - previousMillis[counter] > interval[counter]) {
       // change the brightness for next time through the loop:
       brightness[counter] = brightness[counter] + fadeAmount[counter];

       // reverse the direction of the fading at the ends of the fade: 
       if (brightness[counter] == 0 || brightness[counter] == 255) {
         fadeAmount[counter] = -fadeAmount[counter] ; 
       }     
     }                         
   }
 } 
```

这是奇怪的事情。如果我注释掉串行内容（打印并开始），则淡入淡出不起作用。他们只是“闪烁”一点。

知道有什么问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T21:07:58.703

我想到了。看起来我忘记了一行代码。

```
 previousMillis[counter] = currentMillis; 
```

我应该把它放在代码中的第一个 if 语句中。我猜想通过使用串行打印进行观察的行为会减慢速度，以至于代码似乎可以正常工作。

男孩，我是不是觉得自己很愚蠢。

# c# - 使 xaml 数据触发器在 c# 代码中工作

> ID：13592946
> 
> 赞同：0
> 
> 时间：2012-11-27T20:59:53.327
> 
> 标签：c#, xaml

我是 xaml 的新手，下面有以下代码，我的问题是如何从 c# 代码调用 InvalidForeground 来更改复选框文本的颜色？

```
<ControlTemplate x:Key="ItemTemplate"
                                 TargetType="ListViewItem">
                    <StackPanel Orientation="Horizontal">                    
                        <CheckBox x:Name="CkBoxVisual">
                            <CheckBox.IsChecked>
                                <Binding Path="IsSelected"
                                         Mode="TwoWay">
                                    <Binding.RelativeSource>
                                        <RelativeSource Mode="TemplatedParent" />
                                    </Binding.RelativeSource>
                                </Binding>                                
                            </CheckBox.IsChecked>
                            <DataTrigger Binding="{Binding InvalidForeground, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}" Value="true">
                                <Setter TargetName="CkBoxVisual" Property="Foreground" Value="Red"/>
                            </DataTrigger>                       
                        </CheckBox>                    
                        <ContentPresenter />                    
                    </StackPanel>
                </ControlTemplate> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T00:34:51.190

在您的代码中，您没有调用任何内容。在其中，您希望更改依赖属性..

但是 Window 类型的控件没有名为“InvalidForeground”的依赖属性。这个触发器永远不会被触发。您的目标是什么，更改属性或收到更改通知（触发器）？

* * *

**编辑：**您必须遵循许多规则：

1）DataTrigger（RelativeSource）的Binding属性中引用的控件：

```
Binding="{Binding Path=InvalidForeground, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type Window}}}" 
```

必须有一个名为“InvalidForeground”的依赖属性，它可以正常工作，基于此，将不起作用：

```
{x:Type Window} 
```

它的类型必须声明，才会起作用，例如：

```
{x:Type my:ControlName} 
```

2) 例如，由 Trigger 或 DataTrigger 更改的属性永远不能明确说明。不管用：

```
<TextBlock Text="{Binding Any}" Foreground="#FFCCCCCC">
    <TextBlock.Style>
        <Style TargetType="TextBlock">
            <Style.Triggers>
                <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=TabItem, Mode=FindAncestor}, Path=IsSelected}" Value="True">
                    <Setter Property="Foreground" Value="Black"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>
    </TextBlock.Style>
</TextBlock> 
```

将工作：

```
<TextBlock Text="{Binding Any}">
    <TextBlock.Style>
        <Style TargetType="TextBlock">
            <Setter Property="Foreground" Value="#FFCCCCCC"/>
            <Style.Triggers>
                <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType=TabItem, Mode=FindAncestor}, Path=IsSelected}" Value="True">
                    <Setter Property="Foreground" Value="Black"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>
    </TextBlock.Style>
</TextBlock> 
```

3）使用RelativeSource检查Bindings的操作它们有一些特殊性（您应该对WPF的可视化树有所了解）。
[http://msdn.microsoft.com/en-us/library/ms743599.aspx](http://msdn.microsoft.com/en-us/library/ms743599.aspx)

4）您应该检查绑定是否正常工作，并且可以按照以下步骤操作：http: [//www.codeproject.com/Articles/244107/Debugging-WPF-data-bindings](http://www.codeproject.com/Articles/244107/Debugging-WPF-data-bindings)

# asp.net - 当前上下文中不存在名称绑定

> ID：13592947
> 
> 赞同：1
> 
> 时间：2012-11-27T20:59:56.523
> 
> 标签：asp.net

我喜欢进行条件绑定，因为该`Bind()`值可能为 null，在这种情况下，我喜欢将其默认为适当的值。

> 当前上下文中不存在名称“绑定”

如何解决？

```
 <EditItemTemplate>               
             <asp:DropDownList ID="ddlTimeZone" runat="server" DataSource='<%# TimeZoneInfo.GetZones().Select(s => s.Id) %>'
             SelectedValue='<%# Eval("TimeZone") != null ? Bind("TimeZone") : "" %>'>                
                <asp:ListItem Text="" Value=""/>
             </asp:DropDownList>                
          </EditItemTemplate> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T21:37:43.027

尝试

```
<%# Eval("TimeZone") != null ? Eval("TimeZone") : "" %> 
```

一个更优雅的解决方案（假设 C#）是

```
<%# Eval("TimeZone") ?? "" %> 
```

# javascript - 制作 关联

> ID：13592952
> 
> 赞同：2
> 
> 时间：2012-11-27T21:00:31.173
> 
> 标签：javascript, jquery, html

我无法建立链接。

我在 Magento 商店有一张幻灯片。主题是响应式的，滑块是 javascript。

这是我的代码：

```
<div id="camera_wrap" class="camera_wrap camera_orange_skin">
<div data-thumb="{{skin url='images/camera/slides/thumbs/slide1-thumb.png'}}" data-src {{skin url='images/camera/slides/b1.jpg'}}"></div>
</div> 
```

滑块显示图片和相关缩略图。我想让滑块可点击，但我无法让它工作。有任何想法吗？如果我放置

```
onclick="location.href='newurl.html';" 
```

在 div 内，图像未显示 :( 有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T21:03:41.563

```
<a href="newurl.html">My link</a> 
```

建立链接的最简单（也是最语义化）的方法是使用`<a>`元素。
如果您真的想采用 javascript 方式，您可以使用 jQuery 绑定处理程序

```
$('#camera_wrap').on('click', function(){
 // your code
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T21:07:22.810

不要使用内联点击...为您的 div 分配一个类和一个自定义数据属性。例子：

```
<div class="onclick-link" data-href="mylink.html">Some content here...</div> 
```

进而：

```
$('.onclick-link').unbind('click').click(function() {
    window.location.href = $(this).attr('data-href');
}); 
```

这可用于您想要转换为链接的所有 div，并分配类和 data-href 属性。

# php - php SDK $this->facebook->api('/me'); 已停止工作

> ID：13592953
> 
> 赞同：0
> 
> 时间：2012-11-27T21:00:32.657
> 
> 标签：php, facebook-graph-api

我正在使用最新的 PHP SDK。直到昨天，我的网站都通过 Facebook 进行了身份验证，从 Facebook 查询数据，并能够发布到 Facebook。

现在登录 Facebook 后，我的页面没有查询任何内容。我调用 $me = $this->facebook->api('/me')。$me 现在未定义。

我没有更改任何以前工作的代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T21:25:56.947

当前有一个错误[http://developers.facebook.com/bugs/412291762177195?browse=search_50b52ea44ab2c4d05746653](http://developers.facebook.com/bugs/412291762177195?browse=search_50b52ea44ab2c4d05746653)由于 SSL 证书而导致 Facebook 异常。由于 PHP 抛出异常，用户无效，因此 API 调用将不起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T06:49:49.387

已知的错误。已解决： http: [//developers.facebook.com/bugs/412291762177195 ?browse=search_50b5b3ac645046132144787](http://developers.facebook.com/bugs/412291762177195?browse=search_50b5b3ac645046132144787)

在此处下载新的 SDK：**https ://github.com/facebook/facebook-php-sdk**

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-04T14:24:44.010

同时您可以使用此代码来避免 SSL 异常

`Facebook::$CURL_OPTS[CURLOPT_SSL_VERIFYPEER]=false;`

# knockout.js - 尝试创建绑定处理程序将绑定应用于后代

> ID：13592956
> 
> 赞同：0
> 
> 时间：2012-11-27T21:00:43.007
> 
> 标签：knockout.js, kendo-ui

我正在尝试制作一个基于传递的内容创建模块的处理程序。这是我所拥有的：

```
ko.bindingHandlers.CreateModule = {
        init: function (element, valueAccessor, allBindingAccessor, viewModel, bindingContext) {
            var value = ko.utils.unwrapObservable(valueAccessor()),
                childContext;

            var module = $(element).kendoCustom();
            //var module = $(element)['kendo' + value]();

            childContext = bindingContext.createChildContext(module.data('kendoCustom').options);

            ko.applyBindingsToDescendants(childContext, element);
            return { controlsDescendantBindings: true };
        }
    };

var Custom = Widget.extend({
            init: function (element, options) {
                Widget.fn.init.call(this, element, options);
                this._create();
            },
            options: {
                name: 'Custom',
                isSimple: true,
                venues: ko.observableArray(),
                test: ko.computed(function () {
                    // Heres on of the main issues
                    return this.venues().length > 0 ? this.venues() : {};
                }),
                kendoGrid: {
                    data: this.test,
                    sortable: true,
                    scrollable: true,
                    columns: ['Name', 'Time','Event'],
                    height: '100%'
                },
                update: function () {  ...  }
            },
            _templates: {
                main: '<div style="height:100%"></div>',
                simple: '<div data-bind="kendoGrid: kendoGrid"></div>'
            },
            _create: function () {
                var that = this;
                that.options.update();
                that.element.append(that._templates.simple);
            }
        });

        ui.plugin(Custom); 
```

我无法弄清楚如何访问小部件中的属性。例如，在“测试”功能中，“this”总是指窗户……但我需要能够到达场地。如何从内部访问 Widget 中的其他属性？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T22:35:40.640

这可能不是一个正确的答案，但它似乎正在工作：

```
var Custom = Widget.extend({
        init: function (element, options) {
            Widget.fn.init.call(this, element, options);
            this._create();
        },
        options: {
            name: 'Custom',
            isSimple: true,
            venues: ko.observableArray(),
            kendoGrid: {
                data: this.test,
                sortable: true,
                scrollable: true,
                columns: ['Name', 'Time','Event'],
                height: '100%'
            }
        },
        _templates: {
            main: '<div style="height:100%"></div>',
            simple: '<div data-bind="kendoGrid: kendoGrid"></div>'
        },
        _create: function () {
            var that = this;
            that.options.kendoGrid.data = that.test();
            that.update();
            that.element.append(that._templates.simple);
        },
        test: function () {
                var that = this;
                return ko.computed(function () {
                    return that.options.venues().length > 0 ? that.options.venues() : {};
                });
            },
        update: function () {  ...  }
        }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T20:07:14.543

`ko.computed``this`接受第二个参数，这是您在运行计算的 observable 时想要的值。

```
_create: function () {
    this.options.kendoGrid.data = ko.computed(function () {
        return this.venues().length > 0 ? this.venues() : {};
    }, this.options);
    ...
}, 
```

# kineticjs - KineticJS 可以采用什么类型的颜色？

> ID：13592957
> 
> 赞同：4
> 
> 时间：2012-11-27T21:00:42.547
> 
> 标签：kineticjs

似乎缺乏关于`Color`KineticJS 中的内容的文档（如果我错了，请告诉我）

到目前为止，我通过反复试验发现，我实际上可以将以下内容传递给类中的`setFill`函数`Shape`：

```
someShape.setFill("red");
someShape.setFill("#FF0000");
someShape.setFill("rgb(255,0,0)"); 
```

但是，您不能传入：

```
someShape.setFill(0xff0000);
someShape.setFill("rgb(100%,0%,0%)");
someShape.setFill("hsl(360,100,100)");
someShape.setFill("hsv(360,100,100)"); 
```

这又是反复试验。某处有明确的清单吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-01T06:42:02.223

KineticJS 将 fill 属性传递给 canvas 上下文的 fillStyle 属性，它根据 CSS 颜色模型将字符串解析为 CSS 颜色：

[http://dev.w3.org/csswg/css3-color/](http://dev.w3.org/csswg/css3-color/)

我尝试了您提到的每种填充类型，它们实际上都对我有用，除了 hsv，在 Google Chrome 中。如果它们都不能正常工作，那是因为您使用的浏览器没有完全实现根据 W3C 规范的颜色解析

# c# - 确定枚举类型

> ID：13592959
> 
> 赞同：1
> 
> 时间：2012-11-27T21:00:49.737
> 
> 标签：c#, asp.net, enums

我有两个枚举器和一个采用枚举器的方法。它们称为 ABC 和 DEF，方法称为 TestMethod(Enum myEnum)。代码如下：

```
public enum ABC
{
    Zero,
    One,
    Two
};

public enum DEF
{
    Zero,
    One,
    Two
};

public void TestEnum(Enum myEnum)
{
    ...
} 
```

函数 TestEnum 接受任何枚举数。如何测试传入的参数属于两者中的哪一个？我可以盲目地开始使用 try / catch 强制转换来测试它，但这太丑了。有什么更清洁的方法吗？预先感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-27T21:02:05.293

> 如何测试传入的参数属于两者中的哪一个？

你可以打电话`GetType`：

```
Type type = myEnum.GetType(); 
```

请注意，在那之后你想用它*做*什么还不清楚。

或者：

```
if (myEnum is ABC)
{
}
else if (myEnum is DEF)
{
} 
```

编辑：如果您能够更改方法签名*并且*您的调用者将知道类型，那么根据 Jeppe 的评论，您可以使用：

```
public void TestEnum<T>(T value) where T : struct
{
    // Use typeof(T) here
} 
```

您不能`T`使用普通 C# 将其限制为 enum 类型......尽管有一些通过后处理应用此类约束的[hacky 方法来编写代码。](https://code.google.com/p/unconstrained-melody/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T21:37:51.323

斯基特先生已经搞定了，但是！

两种方法怎么样。

```
public void TestEnum(ABC abcEnum) {
    //do ABC stuff
}

public void TestEnum(DEF defEnum) {
    //do DEF stuff
} 
```

您可以获得所需的分支，但不必担心 if 语句是否正确。没错，这只是一个 if 语句，但如果添加枚举 GHI 会怎样。现在有一些未说明的输入供 TestEnum 处理。使用重载方法你会在编译时捕捉到它（或者更好的是，智能感知会捕捉到你）。

# php - 如何设计一个数据库来跟踪我家人拥有的书籍？

> ID：13592960
> 
> 赞同：2
> 
> 时间：2012-11-27T21:00:49.143
> 
> 标签：php, mysql, database

我不一定要寻找 MySQL 或 PHP 代码。相反，我试图了解如何设置所有内容。

我想使用 MySQL（并使用 PHP 更新它）创建我家人拥有的所有书籍的数据库。我想为家里的每个人设置不同的“书架”，这样我们就可以看到谁拥有某本书。

我的第一个想法是为所有标题、作者等设置一个表格，并为用户 ID 设置一个字段以显示谁拥有这本书。但是，我可能有一份饥饿游戏，我的祖母可能有一份饥饿游戏。我希望能够在两个书架上展示它。我的想法行之有效的唯一方法是，如果我们没有重复的书。

我的下一个想法是为每个用户使用不同的表，并有一个字段包含用户拥有的每本书的书 ID。我认为这将在小范围内起作用，但它似乎不是一个有效的设计。一旦我的网站稳定运行，我计划将数据库公开给我镇上的每个人（数千人）使用，所以我想从正确的设计开始。

这个应该怎么设计？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T21:08:27.370

```
BOOK
--------
book_id
title
other_book_related_info

PERSON
-------
person_id
name
other_person_info

BOOK_PERSON
-------------
book_id
person_id
possibly-dates-when-this-person-owned-this-book 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T21:10:39.343

这是非常基本的。所有者、书籍和作者应该是不言自明的。将任何其他字段添加到您想要的那些表中。bookshelf 和 book_authors 都是交叉引用表，因此每本书可以有多个所有者，每本书可以有多个作者。

```
**owner:**
owner_id
owner_name
...

**book:**
book_id
book_name
...

**author:**
author_id
author_name
...

**bookshelf:**
owner_id
book_id

**book_authors:**
book_id
author_id 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T23:04:50.660

您可能想区分这本书的所有权和当前拥有权，因为人们无疑会借钱。因此，BOOK 表（如果要扩展到 DVD 等，最好将其称为 ITEM）和 PERSON 表，以及所有权表 BOOK/MEDIA_OWNER，可能与 ITEM_LOAN 表一起有用。

您可能还希望允许对项目集进行分组，以便可以单独识别一本书的多卷或一个演出季的光盘。书籍（和电影等）也成系列出现，所以也要考虑如何表现它。

顺便说一句，一个普遍接受的规则是，如果一个作品的版本在两次印刷之间变化超过 20%，那么它就是一个新的印象，但它并不总是被授予一个新的 ISBN。取决于出版商。此外，书籍的层次结构基于作品 -< 版本 -< 印象，[这些人](http://www.editeur.org/ "这些人")将是与书籍相关的数据结构信息的良好来源。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-27T21:07:34.837

这是我能想到的一个简单的解决方案：

> Book Table : 所有独特书籍的列表
> 
> 用户书籍：包含用户 ID 和书籍 ID。多个用户可以拥有相同的标题。
> 
> 用户：用户列表；

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-27T21:12:31.980

这是另一个解决方案：

```
**** BOOK ***
book_id
book_title
book_desc
book_bought

*** USERS ***
user_id, 
name,
dateOfBirth

** Copies **
copy_id (PK)
user_id (FK)
book_id (FK)
NoOfCopies 
```

# java - 检查输入的数字

> ID：13592964
> 
> 赞同：1
> 
> 时间：2012-11-27T21:01:14.403
> 
> 标签：java, exception-handling, int, validation

我是 Java 新手。我创建此代码是为了检查输入字段中的字符串或数字。

```
try {
    int x = Integer.parseInt(value.toString());
} catch (NumberFormatException nFE) {
    // If this is a string send error message
    throw new ValidatorException(new FacesMessage(FacesMessage.SEVERITY_ERROR,
            "  " + findValue + " must be number!", null));
} 
```

如何创建相同的数字检查但`if(){}`不使用 try-catch？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T21:02:35.557

您可以使用`pattern`with`String#matches`方法：-

```
String str = "6";

if (str.matches("[-]?\\d+")) {
    int x = Integer.parseInt(str);
} 
```

`"[-]?\\d+"`模式将匹配任何序列`digits`，前面有一个可选的`-`符号。

`"\\d+"`表示匹配一位或多位数字。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T21:29:08.513

如果您真的不想显式捕获异常，那么您最好制作一个辅助方法。

例如。

```
public class ValidatorUtils {

    public static int parseInt(String value) {
        try {
            return Integer.parseInt(value);
        } catch (NumberFormatException e) {
            throw new ValidatorException(new FacesMessage(FacesMessage.SEVERITY_ERROR,
            "  " + findValue + " must be number!", null));
        }
    }
}

public static void main(String[] args) {

    int someNumber = ValidatorUtils.parseInt("2");
    int anotherNumber = ValidatorUtils.parseInt("nope");

} 
```

这样，您甚至不需要使用 if 语句，而且您的代码不必解析整数两次。

# ubuntu - 更改 sshd_config 后无法进入 Amazon EC2 实例

> ID：13592968
> 
> 赞同：0
> 
> 时间：2012-11-27T21:01:22.220
> 
> 标签：ubuntu, amazon-ec2, amazon, config, putty

我正在为一个学校项目运行一个 Amazon EC2 微实例（ubuntu 12.04.1）。我试图设置用户身份验证以登录到 shell 以消除以用户“ubuntu”身份登录的需要。

我研究了如何做到这一点，发现我需要编辑 sshd_config 文件。因此，我取消了注释“PasswordAuthentiation yes”的行。我没有重新启动 sshd 服务器（我发现在我已经退出 shell 之后我必须这样做）。

此外，我对 ubuntu 文件夹进行了 chmod 777 以允许访问其他用户（项目上下文所需）。

完成所有这些后，我退出了 shell 以查看我创建的新用户是否有效。我的问题不是关于新用户，而是我根本无法以任何人身份登录的事实。我使用的私钥文件和 PuTTY 设置与我已经使用了一段时间一样，但每次我输入“ubuntu”（或其他任何内容）登录时，我都会收到错误消息：

断开连接：没有可用的受支持的身份验证方法
（服务器发送：publickey）

我试图以 root 身份登录，但这显然没有在 sshd_config 文件中启用，因为它只是告诉我以 ubuntu 身份登录。

我知道问题不是一个混乱的 .ppk 文件，因为我创建了一个新实例来测试它，我可以很好地登录（两者都使用相同的密钥对）。

我对此进行了研究，似乎一种可能的解决方法是创建一个新实例，将 EBS 卷从混乱的实例中分离出来，并将其附加到新实例以编辑配置文件。但是，如果我这样做，我害怕丢失数据（如果涉及到这个，我如何确定我需要的所有数据都在那里？）。

我将不胜感激任何有关在服务器上至少将配置文件更改回其默认值的帮助（如果这会导致任何问题，可能还会更改 ubuntu 文件夹权限）。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T22:05:04.757

您需要在某个时候实际设置密码（大概是 sudo passwd ubuntu）。

在另一个实例上重新安装 EBS 的建议是合理的（从这种无法访问的实例问题中恢复的 SOP，如果只是将其丢弃并从头开始重新创建实例并不简单）。如果有疑问，请在弄乱卷之前对其进行快照。

# php - 名称不会改变，但路径会在数组中

> ID：13592969
> 
> 赞同：0
> 
> 时间：2012-11-27T21:01:37.953
> 
> 标签：php, arrays

所以我在理解如何迭代一个在 php 中看起来像这样的数组时遇到了问题：

```
 $styles = array(
   'css' => array(
       'name' => array(
          'core-css', 
          'bootstrap-css',
          'bootstrap-responsive-css'
        ),
       'path' => array(
           get_bloginfo('stylesheet_url'), 
           get_template_directory_uri() . '/lib/bootstrap/css/bootstrap.min.css',
           get_template_directory_uri() . '/lib/bootstrap/css/bootstrap.responsive.min.css'
        ),
    ),
 ); 
```

本质上，这种样式被传递给一个类的构造函数，然后在一个看起来像这样的方法中迭代数组（注意这个数组存储在一个名为 _options 的受保护值中的类级别，因此以下代码中的 $this->_options ：

```
foreach ( $this->_options as $key => $value ) {
    // load all the css files
    if (isset ( $this->_options ['css'] )) {
        foreach ( $value ['name'] as $name ) {
            foreach ( $value ['path'] as $path ) {
                wp_enqueue_style ( $name, $path );
            }

        }
     }
} 
```

这会吐出类似的东西：

*   核心css style.css
*   核心 CSS 引导程序
*   core-css 引导响应

.

问题现在应该很清楚，**名称永远不会改变**，我认为这**与我如何迭代数组有关，本质上是数组**。

因此，非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T21:05:53.120

`path`数组不是数组的一部分`name`，应该类似于：

```
foreach ( $this->_options as $key => $value ) {
    // load all the css files
    if (isset ( $this->_options ['css'] )) {
        foreach ( $value ['path'] as $k=>$path ) {
            wp_enqueue_style ( $value['name'][$k], $path );
        }
     }
} 
```

或者，您可以随时更改数组的结构：

```
$styles = array(
    'css' => array(
        array(
            'name'=>'core-css',
            'path'=>get_bloginfo('stylesheet_url')
        ),
        array(
            'name'=>'bootstrap-css',
            'path'=>get_template_directory_uri() . '/lib/bootstrap/css/bootstrap.min.css'
        ),
        array(
            'name'=>'bootstrap-responsive-css',
            'path'=>get_template_directory_uri() . '/lib/bootstrap/css/bootstrap.responsive.min.css'
        )
    )
);

foreach($this->_options as $key => $value){
    if (isset ( $this->_options ['css'] )) {
        foreach($this->_options ['css'] as $k=>$v){
             wp_enqueue_style ( $v['name'], $v['path'] );
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T21:06:41.757

希望订单匹配，否则您会遇到麻烦。像这样的东西：

```
if (isset($this->_options['css'])) {
    foreach ($this->_options['css']['name'] as $key => $name) {
        echo $name; // Your name
        echo $this->_options['css']['path'][$key]; // Your math
    }
} 
```

# xslt-1.0 - 如何在 xslt 中选择特定的节点集

> ID：13592970
> 
> 赞同：4
> 
> 时间：2012-11-27T21:01:49.583
> 
> 标签：xslt-1.0

我目前使用的 xslt 在根目录上生成所有标签。我需要得到`<row>`集合和`<config>`集合。

源 XML：

```
<root>
    <postdate>2011-03-30</postdate>
    <location>84</location>
    <meal>07:36</meal>
    <config>
        <postdate>2011-03-30</postdate>
        <location>84</location>
        <meal>07:36</meal>
        <checknumber>91339082011-03-30T07:36:12</checknumber>
    </config>
    <items>
        <row>
            <descriptor>7297364</descriptor>
            <qty>1</qty>
            <price>33</price>
            <value>33</value>
            <recordtype>1</recordtype>
            <postdate>2011-03-30</postdate>
            <location>84</location>
        </row>
        <row>
            <descriptor>7794473</descriptor>
            <qty>1</qty>
            <price>60</price>
            <value>60</value>
            <recordtype>1</recordtype>
            <postdate>2011-03-30</postdate>
            <location>84</location>
        </row>
    </items>
    <tenders>
        <row>
            <id>13</id>
            <value>117.99</value>
            <recordtype>2</recordtype>
            <postdate>2011-03-30</postdate>
            <location>84</location>
        </row>
    </tenders>
    <taxes>
        <row>
            <id>2</id>
            <value>8.25</value>
            <recordtype>3</recordtype>
            <postdate>2011-03-30</postdate>
            <location>84</location>
        </row>
    </taxes>
</root> 
```

尝试过 Xslt：

```
<xsl:stylesheet version="1.0" exclude-result-prefixes="msxsl" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:msxsl="urn:schemas-microsoft-com:xslt">
    <xsl:output method="xml" indent="yes" omit-xml-declaration="yes"/>
    <xsl:template match="row/*">
        <xsl:copy>
            <xsl:apply-templates select="@* | node()"/>
        </xsl:copy>
    </xsl:template>
</xsl:stylesheet> 
```

期望的输出：

```
<root>
    <config>
        <postdate>2011-03-30</postdate>
        <location>84</location>
        <meal>07:36</meal>
        <checknumber>91339082011-03-30T07:36:12</checknumber>
    </config>
    <row>
        <descriptor>7297364</descriptor>
        <qty>1</qty>
        <price>33</price>
        <value>33</value>
        <recordtype>1</recordtype>
        <postdate>2011-03-30</postdate>
        <location>84</location>
    </row>
    <row>
        <descriptor>7794473</descriptor>
        <qty>1</qty>
        <price>60</price>
        <value>60</value>
        <recordtype>1</recordtype>
        <postdate>2011-03-30</postdate>
        <location>84</location>
    </row>
    <row>
        <id>13</id>
        <value>117.99</value>
        <recordtype>2</recordtype>
        <postdate>2011-03-30</postdate>
        <location>84</location>
    </row>
    <row>
        <id>2</id>
        <value>8.25</value>
        <recordtype>3</recordtype>
        <postdate>2011-03-30</postdate>
        <location>84</location>
    </row>
</root> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-28T14:13:21.783

**这个简短而简单的转换**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:template match="node()|@*">
     <xsl:copy>
       <xsl:apply-templates select="node()|@*"/>
     </xsl:copy>
 </xsl:template>

 <xsl:template match=
  "node()[not(self::root or ancestor-or-self::config or ancestor-or-self::row)]">
  <xsl:apply-templates/>
 </xsl:template>
</xsl:stylesheet> 
```

**应用于提供的 XML 文档时：**

```
<root>
    <postdate>2011-03-30</postdate>
    <location>84</location>
    <meal>07:36</meal>
    <config>
        <postdate>2011-03-30</postdate>
        <location>84</location>
        <meal>07:36</meal>
        <checknumber>91339082011-03-30T07:36:12</checknumber>
    </config>
    <items>
        <row>
            <descriptor>7297364</descriptor>
            <qty>1</qty>
            <price>33</price>
            <value>33</value>
            <recordtype>1</recordtype>
            <postdate>2011-03-30</postdate>
            <location>84</location>
        </row>
        <row>
            <descriptor>7794473</descriptor>
            <qty>1</qty>
            <price>60</price>
            <value>60</value>
            <recordtype>1</recordtype>
            <postdate>2011-03-30</postdate>
            <location>84</location>
        </row>
    </items>
    <tenders>
        <row>
            <id>13</id>
            <value>117.99</value>
            <recordtype>2</recordtype>
            <postdate>2011-03-30</postdate>
            <location>84</location>
        </row>
    </tenders>
    <taxes>
        <row>
            <id>2</id>
            <value>8.25</value>
            <recordtype>3</recordtype>
            <postdate>2011-03-30</postdate>
            <location>84</location>
        </row>
    </taxes>
</root> 
```

**产生想要的正确结果：**

```
<root>
   <config>
      <postdate>2011-03-30</postdate>
      <location>84</location>
      <meal>07:36</meal>
      <checknumber>91339082011-03-30T07:36:12</checknumber>
   </config>
   <row>
      <descriptor>7297364</descriptor>
      <qty>1</qty>
      <price>33</price>
      <value>33</value>
      <recordtype>1</recordtype>
      <postdate>2011-03-30</postdate>
      <location>84</location>
   </row>
   <row>
      <descriptor>7794473</descriptor>
      <qty>1</qty>
      <price>60</price>
      <value>60</value>
      <recordtype>1</recordtype>
      <postdate>2011-03-30</postdate>
      <location>84</location>
   </row>
   <row>
      <id>13</id>
      <value>117.99</value>
      <recordtype>2</recordtype>
      <postdate>2011-03-30</postdate>
      <location>84</location>
   </row>
   <row>
      <id>2</id>
      <value>8.25</value>
      <recordtype>3</recordtype>
      <postdate>2011-03-30</postdate>
      <location>84</location>
   </row>
</root> 
```

**说明**：

1.  使用和覆盖**[身份规则](http://dpawson.co.uk/xsl/sect2/identity.html)**。

2.  正确使用`ancestor-or-self::`轴。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T23:47:30.583

我想通了。这个 xslt 对我有用。

```
<xsl:stylesheet version="1.0" exclude-result-prefixes="msxsl" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:msxsl="urn:schemas-microsoft-com:xslt">
    <xsl:output method="xml" indent="yes" omit-xml-declaration="yes"/>
    <xsl:template match="/">
        <root>
            <xsl:for-each select="//row">
                <row>
                    <xsl:apply-templates/>
                </row>
            </xsl:for-each>
            <xsl:for-each select="//config">
                <config>
                    <xsl:apply-templates/>
                </config>
            </xsl:for-each>
        </root>
    </xsl:template>
    <xsl:template match="*">
        <xsl:element name="{name()}">
            <xsl:value-of select="."/>
        </xsl:element>
    </xsl:template>
</xsl:stylesheet> 
```

# git - 如何重新链接 git repo 以从硬链接中受益

> ID：13592971
> 
> 赞同：1
> 
> 时间：2012-11-27T21:01:54.247
> 
> 标签：git

我有几个从远程仓库克隆的工作树。如果这些是从同一个本地存储库中克隆的，我会节省大量磁盘空间，因为克隆操作会硬链接存储库文件。

**是否可以从不同的来源重新克隆以生成硬链接？**

我意识到我可以更改 remotes.origin.url 但这不会删除并重新链接文件。Git 也只管理部分目录，因此删除它并以这种方式重新创建它并不容易。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T22:15:42.597

If space is a concern, you might even be interested in --shared flag from git clone. What would not even need hardlinks, so it would take even less space. From documentation:

```
When the repository to clone is on the local machine, instead of using hard links, automatically setup .git/objects/info/alternates to share the objects with the source repository. The resulting repository starts out without any object of its own. 
```

Why is deleting and recreating and issue - why not do a clone with hardlinks or shared, then copy over the files that are not managed by git `cp -R -n source target`, -n for

```
-n, --no-clobber
do  not  overwrite  an  existing  file  (overrides a previous -i option) 
```

# javascript - 其他浏览器是否有 onmove 等价物？

> ID：13592981
> 
> 赞同：0
> 
> 时间：2012-11-27T21:02:48.100
> 
> 标签：javascript, html, internet-explorer, firefox, google-chrome

长话短说，我需要跟踪文档大小何时发生变化。就像切换可扩展 div 一样。

在 IE 中，我可以使用 documentelement 的 onmove 事件，但我无论如何都找不到在任何其他浏览器中执行此操作，因为 onmove 是特定于 IE 的。

有什么建议么？

在有人问之前......不，我不能只附加到切换事件。

哦，我不能使用 jquery 或任何其他库（甚至更长的故事）。

谢谢！

编辑：看起来 onmove 在 ie9 中不起作用。有没有更好的方法来处理这个事件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T21:10:08.223

一种非常原始的方法是轮询文档更改并检查大小。看看这个：[stackoverflow.com/questions/1218445/is-there-any-ondocumentchange-event](https://stackoverflow.com/questions/1218445/is-there-any-ondocumentchange-event)

# ruby - 为具有相同 NAME / VALUE 的多个 INPUT 标签机械化 Page.Form.Action POST

> ID：13592983
> 
> 赞同：1
> 
> 时间：2012-11-27T21:02:54.013
> 
> 标签：ruby, mechanize

需要发布到现有网页（无需登录）并发布参数以进行提交，其中存在多个提交表单标签并包含具有相同 NAME 和 VALUE 标签的相同标签；例如，在同一页面上，此 INPUT Submit 在不同的 FORM 标记下重复 3 次：

`< INPUT TYPE='Submit' NAME='submit_button' VALUE='Submit Query' >`

[我的 Ruby 代码可以正常运行以识别表单标签上的字段，但在 page.forms[x].action 帖子上失败， https](https://pdb.nipr.com/html/PacNpnSearch) : //pdb.nipr.com/html/PacNpnSearch 出现 405 HTTPMethodNotAllowed - 未处理的响应。

红宝石代码：

```
class PostNIPR2
def post(url)
 button_count = 0
 agent = Mechanize.new
 page = agent.get(url)
 page.forms.each do |form|
  form.buttons.each do |button|
   if(button.value == 'Submit Query')
    button_count = button_count + 1
   if (button_count == 3) 
    btn_submit_license = button.name
    puts button
    puts btn_submit_license 
    puts button.value
   end
  end
 end    
end
begin
 uform = page.forms[1]
 uform.license = "0H20649"
 uform.state = "CA"
 uform.action = 'https://pdb.nipr.com/html/PacNpnSearch'
rescue Exception => e
 error_page = e.page
end
page = agent.submit(uform)
end
url = "https://pdb.nipr.com/html/PacNpnSearch.html"
p = PostNIPR2.new
p.post(url)
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T01:27:06.060

您的问题是如何选择该按钮？如果是这样：

```
form.button_with(:name => 'submit_button') 
```

或提交这样的表格：

```
next_page = form.submit form.button_with(:name => 'submit_button') 
```

此外，您出于某种原因正在更改表单的操作，这将解释 405s

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T06:25:42.227

你是对的，对评论代码感到抱歉 - 问题是使用输入参数更新并`form.license`发布-我这样做并收到了, 而对于[https://pdb.nipr.com/html/PacNpnSearch](https://pdb.nipr.com/html/PacNpnSearch) -- . 但是现在我已经更改了现在正确找到我需要发布到的表单的代码；然后我得到然后使用. 现在我得到了正确的结果。`form.state``form.submit``form.button_with(:name => 'Submit Query'``405 HTTPMethodNotAllowed``unhandled response``agent.page.form_with(:name => 'license_form')``form.button_with(:value => 'Submit Query')``agent.submit(form, button)`

# c# - uCommerce 2.6.1 DIBS“没有支付类型！缺少测试参数？”

> ID：13592988
> 
> 赞同：2
> 
> 时间：2012-11-27T21:03:03.227
> 
> 标签：c#, umbraco, umbraco-ucommerce, dibs

我一直在与 uCommerce 合作开发一个网上商店。我已将其设置为与 DIBS 支付服务集成，并且可以与 umbraco 4.7.2 一起正常工作。现在，我升级到 4.8.0 并收到消息“No paytype(s)！缺少测试参数？” 当我尝试继续进入 DIBS 交易页面时。

我不确定该错误是否源于升级。

这是我的付款请求代码：

```
if (ProductPolicy.Checked == true)
           {

                var po = b.PurchaseOrder;

                var plpo = PipelineFactory.Create<PurchaseOrder>("Basket");

                var pm = PaymentMethod.SingleOrDefault(x => x.Name == "DIBS");

                Library.CreatePayment(pm.Id);

                plpo.Execute(po);

                po.Save();

                Library.RequestPayments();

            } 
```

我无法在互联网上找到任何解决方案。任何帮助，将不胜感激。

提前致谢。布林克10

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-05T09:28:14.637

顶一下我之前的回答...

根据 DIBS 的说法，如果您在商店关闭测试模式后 DIBS 帐户仍处于测试模式，则会发生这种情况，反之亦然。

# php - 在存储过程中更新数组数据

> ID：13592990
> 
> 赞同：0
> 
> 时间：2012-11-27T21:03:17.610
> 
> 标签：php, mysql, codeigniter, stored-procedures, insert-update

所以这是我的问题。我知道这个网站上有很多关于这类问题的文献，但我对这些问题中的几个如何与我的问题交织在一起感到困惑。首先，我有一个行数据数组，需要根据该数组中的远程 id 值更新或插入，在这种情况下`value_c`。该数组对应于表 foo 中的一个行实例。基本上，如果数据库中存在匹配的记录，`value_c`则更新该记录，否则插入新的记录有效负载。数组的数据结构对应于我们db中表foo的行模式。这是架构（为安全起见进行了混淆）：

```
CREATE TABLE IF NOT EXISTS `foos` (
     `id` int(11) NOT NULL AUTO_INCREMENT,
     `value_a` varchar(13) DEFAULT NULL,
     `value_b` int(11) DEFAULT NULL,
     `value_c` int(11) DEFAULT NULL,
     .
     .
     .
     .
     `value_x` enum('enum_a','enum_b','enum_c','enum_d') DEFAULT NULL,
     `value_y` text,
     `value_z` enum('daily','monthly','weekly') DEFAULT NULL,
     `value_aa` tinyint(4) NOT NULL,
     `value_bb` varchar(1000) DEFAULT NULL,
PRIMARY KEY (`id`)
) ENGINE=InnoDB  DEFAULT CHARSET=latin1 AUTO_INCREMENT=829762 ; 
```

有很多数据，计划如下。对这些数据进行字符串化处理，将其发送到存储过程，然后根据需要进行更新或插入。类似于以下内容（请注意，这将发生在 codeigniter 中的模型中）：

```
public function update_or_insert($event_array_payload)
{
    // string-ify the data
    $mod_payload = implode('<delimiter>', $event_array_payload)

    //deal with NULLs in array
    $mod_payload = $this->deal_with_nulls($mod_payload);

    $this->stored_procedure_lib->update_or_insert_payload($mod_payload);
}

// then elsewhere in the stored procedure library
public function update_or_insert_payload($foo)
{
    $this->_CI->db->query('CALL update_or_insert_foo(\'$foo\')');
} 
```

我的问题如下。单个字符串值被传递到存储过程中。然后需要将其解析并放入单个更新或单个插入语句中。我可以为表的每一列创建一个变量，并创建`foo`一个循环来填充每个变量并以这种方式更新/插入，但是 foo 表很可能会被扩展，我不想进一步创建错误。有没有办法将数组的字符串表示的解析分开的内容动态放置到单个更新或插入语句中。我不确定这是否可能，但我觉得可能存在我不知道的解决方法。感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-11T03:17:26.463

这不是一个确定的答案，但它是一个尝试的选择。

如果您想避免在过程中发送许多参数，您可以创建一个名为的表`foos_tmp`，该表具有相同的结构`foos`，但具有一个附加字段`id_foos_tmp`（pk 和自动增量），然后在 table 中输入数组`foos_tmp`。然后，您只发送生成`id_foos_tmp`的表`foos_tmp`的过程，并在内部发送执行 SELECT`foos_tmp`表并获取您之前在数组中的数据的过程。

我希望它有所帮助。

问候。

# algorithm - 检测重复元素的序列

> ID：13592995
> 
> 赞同：5
> 
> 时间：2012-11-27T21:03:29.160
> 
> 标签：algorithm, sequence, repeat

我有一个随机数数组让我们说：

[10,11,12,14,15,16,17,18,19,20, **11** , **12** , **14,25,25,26,27,28,29** ]

我必须检测重复的序列（女巫实际上是错误的）

长度大于特定数字 (2)。

有什么好的算法吗？

我现在拥有的：

```
int minLenght = 3;
int[] data = {1,2,3};

for(int i = 0; i < data.length; i++){
    for(int j = 0; j < data.length; j++){
        if ( data[i] == data[j]){
            int l = 0;
            int ii = i;
            int jj = j;
            while(data[ii] == data[jj]){
                ii++;
                jj++;
                l++;
            }
            if(l >= minLenght){
                print('['+i+'-'+ii+'] same as ['+j+'-'+jj+']');
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T21:29:38.397

一种方法是将长度为 L（比您的特定长度大一个）的序列存储在哈希表中。

如果你发现一个序列已经在哈希表中，那么你发现了一个长度 >= L 的重复。

例如 Python 代码

```
A=[10,11,12,14,15,16,17,18,19,20,11,12,14,25,25,26,27,28,29]
S=set()
L=2+1
for i in xrange(len(A)-L+1):
    key=tuple(A[i:i+L])
    if key in S:
        print i
    else:
        S.add(key) 
```

这会打印出长度大于 2 的重复序列的位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T21:30:03.543

我不知道是否有一个特殊的算法，但我的建议是这样的：

```
loop1 over array[i]:
  loop2 over array[j] starting with i+1:
    dist=array[j]-array[i];
    if dist==specific_number:
      array_result.append(array[i] +""+""+array[j]) 
```

这将是我的简单逻辑。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-28T07:03:54.307

您可以使用正则表达式，但显示的列表格式不规则。我在下面使用 Python 并将列表格式“正则化”，然后将其转换为字符串，然后再应用正则表达式以查找重复的数字/非数字序列：

```
>>> import re
>>> numbers = [10,11,12,14,15,16,17,18,19,20, 11, 12, 14,25,25,26,27,28,29]
>>> sep = ', '
>>> txt = sep + sep.join(str(x) for x in numbers) + sep
>>> txt
', 10, 11, 12, 14, 15, 16, 17, 18, 19, 20, 11, 12, 14, 25, 25, 26, 27, 28, 29, '
>>> re.search(r'\D((?:\d+\D+){2,}).*\1', txt).groups()
('11, 12, 14, ',) 
```

我通常会尽量减少对正则表达式的使用，但这确实会检测到重复。

# javascript - 如何用 jQuery 替换 css 选择器？

> ID：13592997
> 
> 赞同：0
> 
> 时间：2012-11-27T21:03:32.320
> 
> 标签：javascript, jquery

我只想将`height`属性替换为`min-height`

这就是我通常更改值的方式，但不确定如何更改属性

```
 $('.mySelector').css('height','650px')

<div class="mySelector" style="cursor: -moz-grab; width: 1266px; height: 650px;"> 
```

我的道歉应该早些提到这一点

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-27T21:07:37.253

如果您在`height`属性中设置了高度，我认为您必须执行以下操作：

```
var selector = $('.mySelector');

// set the min-height to I guess whatever the height you had set was
selector.css('min-height', selector.attr('height'));

// remove that old height attribute
selector.removeAttr('height'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T21:15:00.403

如果您想删除 height 属性但将相同的值添加到 min-height*样式*属性，您可以这样做：

```
$('.mySelector').css('min-height', function() {
    return this.height;
}).removeAttr('height'); 
```

# node.js - 手动更改路由后 mediator.user 丢失

> ID：13592998
> 
> 赞同：2
> 
> 时间：2012-11-27T21:03:38.530
> 
> 标签：node.js, backbone.js, express, passport.js, chaplinjs

我正在构建一个带有护照本地身份验证的单页应用程序。用户经过身份验证并在返回用户对象`app.post "/login"` 后返回，我将其保存在其中`Chaplin.mediator.user`（如 facebook-example 中所示）。只要我不手动更改 URL，一切正常，但是当我更改 URL 并按 Enter 时，应用程序会再次加载，但是使用不同的路由 --> 前端没有用户。

我现在正在做的是每次手动更改路由时，我都会向服务器发送请求并在`req.user`. 收到用户后，应用程序继续其工作流程。它有效，但我认为这不是它的本意。如果您不等待响应，尽管您已登录，但您最终将没有用户对象。

我怎么解决这个问题？

**编辑：**我最终将用户保存在单独的 cookie 中。这就是我保存用户的方式：

```
 $.cookie.json = true;
  $.cookie 'user', user.toJSON() 
```

这就是我在页面加载后提取用户的方式：

```
 userCookie = $.cookie 'user'
  if userCookie?
    mediator.user = new Model JSON.parse userCookie 
```

您需要[jquery-cookie 插件](https://github.com/carhartl/jquery-cookie)才能使其工作。如果用户注销，请不要忘记删除 cookie。当然，我仍然对其他想法持开放态度。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T22:33:24.707

您应该在本地存储用户（也称为会话）。当`Backbone`应用程序加载时，如果用户实际上已经登录，您应该将用户路由到正确的位置。