# StackOverflow 问答 16120000-16120999

# java - 用于 HQL（Hiberante 查询语言）查询的 Jasper Report Print 中“union all”子句的替代解决方案

> ID：16120001
> 
> 赞同：0
> 
> 时间：2013-04-20T11:49:25.453
> 
> 标签：java, mysql, hibernate, jasper-reports, hql

我在我的应用程序中使用 Hibernate 和 Jasper Report。为了在碧玉报告中显示结果，我将 HQL 查询作为参数传递。在查询中我使用“union all”子句

如下

选择 a.bedId 作为 BED_ID，a.date 作为 FROM_DATE，b.transferDate 作为 TO_DATE，a.bedCharge 作为 BED_CHARGE
从 HmsIpdGeneral 作为 a，HmsIpdTransferDetail 作为 b 其中 a.mrNumber = b.mrNumber 和 a.ipdId = b.ipdId 和 a .bedId = b.fromBedNo

联合所有

选择 c.bedId 作为 BED_ID，c.date 作为 FROM_DATE，d.dateDischarge 作为 TO_DATE，c.bedCharge 作为 BED_CHARGE 从 HmsIpdGeneral 作为 c，HmsDischargeDetail 作为 d 其中 c.mrNumber = d.mrNumber 和 c.ipdId = d.patientId 和 c .bedId = d.bedId

在上面的查询中，我通过创建子查询来完成所需的输出，从 3 个 POJO 文件中收集一些值，这些文件是 HmsIpdGeneral、HmsIpdTransferDetail、HmsDischargeDetail。

这仅向我显示了第一部分子查询的结果（写在“union all”子句之前）。

如上所述，如何在不使用“union all”子句从子查询中获取值的情况下编写 HQL 查询。有什么方法可以替换 HQL 查询中的“union all”子句。

我需要的是在不使用“union all”子句的情况下组合两个子查询的结果，因为“union all”不适用于 HQL 查询以在 Jasper Report 中显示结果。

请向我建议“union all”子句的替代解决方案，该子句可用于组合来自两个子查询的结果。

===== 编辑 =======

在这里，我试图澄清我的情况。以下是我拥有的 3 个 pojo 文件结构。此应用程序适用于医院管理。我必须计算患者的 bed_charge 和详细信息，以显示他在哪张床上的哪一天到哪一天。如果患者入院，他的 BED_ID 将输入到 HmsIpdGeneral 表中，如果他转移到另一张床，那么值也会输入到 HmsIpdGeneral 表中。

HmsIpdTransferDetail 表保存有关转移患者和相应 BED_ID 的信息。

HmsDischargeDetail 表保存有关出院患者和相应空缺 BED_ID 的信息

我必须显示患者的详细信息，从哪个日期到哪个日期他在哪个 BED_ID 上，并且必须显示 BED_CHARGE。

这是 POJO 文件结构（为方便起见，我从结构中删除了无用的字段）

HmsIpdGeneral Table Structure // 保存 BED_ID 的信息，即在哪一天哪张床被分配给谁

```
 private Integer id;
 private String mrNumber;
 private String ipdId;    
 private String bedId;    // for BED_ID
 private double bedCharge;  // for BED_CHARGE
 private Date date;   // for FROM_DATE 
```

HmsIpdTransferDetail 表结构 // 保存转移到另一个 BED_ID 的患者信息

```
 private Integer transferId;
 private String mrNumber;
 private String ipdId;
 private String fromWardCode;
 private String toWardCode; 
 private String fromBedNo;  // for BED_ID from where patient is transfered
 private String toBedNo;    // for NEW BED_ID where patient is transfered 
 private Date transferDate; // for TO_DATE 
```

HmsDischargeDetail 表结构 // 保存患者出院信息，BED_ID 状态将变为空缺

```
 private String mrNumber;
 private String patientId; // ipdId will be inserted here    
 private String bedId; // for BED_ID where patient is last time shifted before discharge
 private Date dateAdmission;
 private Date dateDischarge;   // for TO_DATE 
```

特定 MrNumber 和 IpdId 的 Jasper 报告结构（使用查询执行）

床_ID || FROM_DATE || TO_DATE || BED_CHARGE

为了获得上述结果，我已经提到了我的查询。获得所需输出的另一种方法是什么。

我感谢所有宝贵的建议。

# ruby-on-rails - 如何远程调试rails 3.0.2

> ID：16120005
> 
> 赞同：1
> 
> 时间：2013-04-20T11:49:52.300
> 
> 标签：ruby-on-rails, ruby-on-rails-3, pry

我的应用程序中有一个错误，它只发生在“舞台”上，而不是本地发生。我想使用调试器并设置断点，以便可以在舞台上调试应用程序。

在本地，我使用 pry，甚至让 pry-remote 在本地工作，但无法让它在服务器上工作。

我不介意使用常规调试器或 pry 进行调试。

我经常遇到的问题：ArgumentError (non-absolute home)

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T12:21:09.850

如果您在测试时绝对没有将它放到生产环境中，我会推荐`better_errors`Gem。它绝对不适用于生产站点，因为它会暴露一些严重的安全问题

如果您将它包含在`:development`组中，它会在发生错误时在网页中为您提供一个控制台。

如果它没有引发致命错误，那么您可以将该`raise`方法扔到任何您想要充当断点的位置，您将无法继续，但它有助于在网页中进行类似操作的操作。

Ryan Bates 有一个很好的指南

[http://railscasts.com/episodes/402-better-errors-railspanel](http://railscasts.com/episodes/402-better-errors-railspanel)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T12:44:21.633

在本地重现错误的一种解决方案是在发生故障的同一环境中启动服务器。

```
$ RAILS_ENV=staging script/server 
```

# php - PHP注册问题

> ID：16120006
> 
> 赞同：0
> 
> 时间：2013-04-20T11:50:00.083
> 
> 标签：php, post, methods

我想知道这段代码中是否有任何错误/漏洞，也有人可以帮助我，因为我注册但它不会将数据插入数据库。如果有任何错误，请您纠正。我想要它，所以如果用户名存在，将它们重定向到错误？= 1，依此类推，密码不匹配。任何帮助表示赞赏。

注册.php

```
 <form action="register_acc.php" method="post">
                            <input type="text" name="username" class="input" value="" autocomplete="off" placeholder="Username" maxlength="25" /><br />
                                <br />
                            <input type="password" name="password" class="input" value="" autocomplete="off" placeholder="Password" maxlength="20" /><br />
                                <br />
                            <input type="password" name="password2" class="input" value="" autocomplete="off" placeholder="Password again" maxlength="20" /><br />
                                <br />
                            <input type="text" name="email" class="input" value="" autocomplete="off" placeholder="Email" maxlength="255" /><br />
                                <br />
                                <input type="submit" name="submit "class="submit" value="Sign up">
                        </form> 
```

register_acc.php

```
<?php
    error_reporting(1);
     include 'site/inc/config.php';

      if (isset($_POST['submit'])) {
session_start();

$username = $_POST['username'];
$password = md5($_POST['password']);
$pass_conf = md5($_POST['password2']);
$email = $_POST['email'];
$ip = $_SERVER['REMOTE_ADDR'];
$date= date("d-m-Y");

$q = "SELECT * FROM `users` WHERE username = '$username'";
$r = mysql_query($q);

if (empty($username)) {
    header("Location: register.php?error=1");
        exit;
}

if ($password != $pass_conf) {
    header("Location: /site/register.php?error=2"); 
        exit;
}

if (!filter_var($email, FILTER_VALIDATE_EMAIL)) {
    header("Location: /site/register.php?error=3"); 
        exit;
} 

if  (mysql_num_rows($r) == 0) {
    // Continue w/ registration, username is available!
    $query = "INSERT INTO `users` (id, username, password, email, ip, rank, reg_date)
    VALUES (0, '$username', '$password', '$email', '$ip', 1, '$date'())";
    $run = mysql_query($query);
    header("Location: /site/register.php?succsess=1"); 

}
          }
         else {
    header("Location: register.php?error=4");
           }
      ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T11:54:04.053

您不会将 $username 变量连接到查询中。尝试这个：

```
"SELECT * FROM `users` WHERE username = '".$username."'" 
```

此外，您的 INSERT 查询使用 date() 函数看起来有点奇怪。尝试这个：

```
$date = date("Y-m-d");
"INSERT INTO `users` (id, username, password, email, ip, rank, reg_date)
    VALUES (0, '$username', '$password', '$email', '$ip', 1, '".$date."')" 
```

编辑：脚本示例

```
<?php
if(!isset($_POST['username'])||!isset($_POST['email'])||!isset($_POST['password']))//enter more values if necessary
{
header("Location: error_page.php?error=1");
}
else
{
//do whatever, eg execute query
}
?> 
```

# c# - 如何在 WPF 中动态创建数据网格？

> ID：16120010
> 
> 赞同：3
> 
> 时间：2013-04-20T11:50:25.133
> 
> 标签：c#, wpf, data-binding, datagrid

我在 XAML 中有以下数据网格：

```
<DataGrid ItemsSource="{Binding View}" AutoGenerateColumns="False" IsReadOnly="True"
          GridLinesVisibility="None" CanUserAddRows="False" CanUserDeleteRows="False" 
          CanUserResizeColumns="False" CanUserResizeRows="False" 
          CanUserReorderColumns="False" >
    <DataGrid.ColumnHeaderStyle>
        <Style TargetType="{x:Type DataGridColumnHeader}">
            <Setter Property="FontWeight" Value="Bold" />
            <Setter Property="FontSize" Value="12" />
        </Style>
    </DataGrid.ColumnHeaderStyle>
    <DataGrid.Columns>
        <DataGridTextColumn Header="Type" Width="200" FontSize="12" 
                            Binding="{Binding Path=Name}" />
        <DataGridTemplateColumn Header="Ingredients" Width="*">
            <DataGridTemplateColumn.CellTemplate>
                <DataTemplate>
                  <DataGrid ItemsSource="{Binding Ingredients}" 
                            AutoGenerateColumns="False" IsReadOnly="True"
                            GridLinesVisibility="None" CanUserAddRows="False" 
                            CanUserDeleteRows="False" CanUserResizeColumns="False"
                            CanUserResizeRows="False" CanUserReorderColumns="False" >
                        <DataGrid.ColumnHeaderStyle>
                            <Style TargetType="{x:Type DataGridColumnHeader}">
                                <Setter Property="FontWeight" Value="Bold" />
                                <Setter Property="FontSize" Value="12" />
                            </Style>
                        </DataGrid.ColumnHeaderStyle>
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Ingredients" 
                                            Width="*" FontSize="12"
                                            Binding="{Binding Path=IngredientName}"/>
                            <DataGridTextColumn Header="Quantite" Width="*" 
                                          FontSize="12" Binding="{Binding Path=Qty}"/>
                        </DataGrid.Columns>
                    </DataGrid>
                </DataTemplate>
            </DataGridTemplateColumn.CellTemplate>
        </DataGridTemplateColumn>
    </DataGrid.Columns>
</DataGrid> 
```

我正在尝试找到一种方法来动态（在代码中）创建数据网格，以便我可以创建它的多个副本并在运行时将其绑定到不同的数据源。

这可能吗？任何人都知道我该如何处理像这样复杂的数据网格？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-20T13:27:38.990

首先，将尽可能多的不同设置移到可重用的`Styles`and`DataTemplates`中，在 DataGrid 本身中留下很少的内容：

```
<UserControl ... >

    <UserControl.Resources>
        <Style x:Key="GridHeaderStyle" TargetType="{x:Type DataGridColumnHeader}">
            <Setter Property="FontWeight" Value="Bold" />
            <Setter Property="FontSize" Value="12" />
        </Style>

        <Style x:Key="ReadOnlyGridStyle" TargetType="{x:Type DataGrid}" >
            <Setter Property="AutoGenerateColumns" Value="False" />
            <Setter Property="IsReadOnly" Value="True" />
            <Setter Property="GridLinesVisibility" Value="None" />
            <Setter Property="CanUserAddRows" Value="False" />
            <Setter Property="CanUserDeleteRows" Value="False" />
            <Setter Property="CanUserResizeColumns" Value="False" />
            <Setter Property="CanUserResizeRows" Value="False" />
            <Setter Property="CanUserReorderColumns" Value="False" />
            <Setter Property="ColumnHeaderStyle" Value="{StaticResource GridHeaderStyle}" />
        </Style>

        <DataTemplate x:Key="IngredientsCellTemplate" >
            <DataGrid ItemsSource="{Binding Ingredients}" 
                      Style="{StaticResource ReadOnlyGridStyle}" >
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Ingredients" Width="*" FontSize="12"
                                        Binding="{Binding Path=IngredientName}" />
                    <DataGridTextColumn Header="Quantite" Width="*" FontSize="12"
                                        Binding="{Binding Path=Qty}" />
                </DataGrid.Columns>
            </DataGrid>
        </DataTemplate>
    </UserControl.Resources>

    <!-- A DataGrid using our Styles: -->
    <DataGrid ItemsSource="{Binding View}" 
              Style="{StaticResource ReadOnlyGridStyle}" >
        <DataGrid.Columns>
            <DataGridTextColumn Header="Type" Width="200" FontSize="12"
                                Binding="{Binding Path=Name}" />
            <DataGridTemplateColumn Header="Ingredients" Width="*"
                                    CellTemplate="{StaticResource IngredientsCellTemplate}" />
        </DataGrid.Columns>
    </DataGrid>

</UserControl> 
```

然后使用现有样式在您的代码隐藏中创建新的 DataGrid 变得容易得多：

```
var datagrid = new DataGrid();
datagrid.Style = FindResource("ReadOnlyGridStyle") as Style;

datagrid.Columns.Add(new DataGridTextColumn()
{
    Header = "Type",
    Width = new DataGridLength(200),
    FontSize = 12,
    Binding = new Binding("Name")
});
datagrid.Columns.Add(new DataGridTemplateColumn()
{
    Header = "Ingredients",
    Width = new DataGridLength(1, DataGridLengthUnitType.Star),
    CellTemplate = FindResource("IngredientsCellTemplate") as DataTemplate
});

datagrid.ItemsSource = ... 
```

# jquery - 扩展 jquery-ui 菜单小部件失败，但它不应该

> ID：16120011
> 
> 赞同：1
> 
> 时间：2013-04-20T11:50:27.670
> 
> 标签：jquery, jquery-ui, extending, jquery-widgets

这只是一个简单的问题，因为我无法弄清楚这里的实际问题是什么，也许有人在扩展 jquery-ui 小部件方面有更多经验。

我试图改变`menu._close`方法中的一些行为，像这样扩展小部件：

```
( function($, undefined ) {
    $.widget('ui.menu', $.ui.menu, {
        _close: function(startMenu) {
            this._super('_close', startMenu)
                    console.log('extension works!')
        } 
    } )
} (jQuery) ); 
```

据我发现的消息来源，这是正确的方法。但现在，问题在于`_super`方法。它应该调用原始`menu._close`方法，并且确实如此 - 将唯一的参数传递`startMenu`给它。但是父方法失败了。

这是原始jquery-ui`menu._close`方法的来源：

```
_close: function( startMenu ) {
    if ( !startMenu ) {
        startMenu = this.active ? this.active.parent() : this.element;
    }

    startMenu
        .find( ".ui-menu" )
        .hide()
        .attr( "aria-hidden", "true" )
        .attr( "aria-expanded", "false" )
        .end()
        .find( "a.ui-state-active" )
        .removeClass( "ui-state-active" );
} 
```

现在，它告诉我`TypeError: startMenu.find is not a function`，是的，这不是因为`this.element`它不是一个实际的 jQuery 对象。但我的问题是，为什么？

**我只扩展了方法，没有改变任何功能，只在调用原始方法后**添加了一个调试消息，向它传递了唯一的参数。我在这里做错了什么？

提前致谢，周末愉快！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T12:39:54.597

[_super()](http://api.jqueryui.com/jQuery.widget/#method-_super)已经知道它应该调用哪个基方法，因此传递它的名称是多余的。

你只需要写：

```
_close: function(startMenu) {
    this._super(startMenu);
    console.log("extension works!");
} 
```

在您当前的代码中，传递给基本方法的第一个参数将是方法名称而不是`startMenu`，这确实会导致基本方法失败。

# android - Android可在多次调用的线程上运行

> ID：16120020
> 
> 赞同：1
> 
> 时间：2013-04-20T11:51:26.013
> 
> 标签：android, android-arrayadapter, asmack, android-handler

我正在尝试使用 aSmack 实现 MUC，但似乎无法使用 ArrayAdapter 正确更新 UI。**我已经在我的ChatService.java**中设置了我的监听器，如下所示：

```
connection.addPacketListener(new MessageListener(), new PacketFilter() {
            public boolean accept(Packet packet) {
                Message msg = (Message) packet;
                return msg.getBody() != null;
            }}); 
```

我的侦听器类如下所示：

```
private class MessageListener implements PacketListener {
    /**
     * Constructor.
     */
    public MessageListener() {
    }

    public void processPacket(Packet packet) {
        if(packet instanceof Message ) {
            Message message = (Message) packet;

            android.os.Message aosMessage = new android.os.Message();
            aosMessage.what = message.getType().ordinal();
            aosMessage.obj = message;
            messageHandler.handleMessage(aosMessage);

        }
    }

} 
```

现在问题如下；首先，我尝试通过处理程序更新 UI（处理程序在我的**ChatActivity.java**中定义）：

```
private final Handler messageHandler = new Handler() {
private Message chatMessage;

@Override
public void handleMessage(final android.os.Message msg) {
    chatMessage = (Message) msg.obj; 

    if(Message.Type.values()[msg.what].equals(Message.Type.groupchat)) {
        conversationArrayAdapter.add("Received group message:  " + chatMessage.getBody());
    } else if (Message.Type.values()[msg.what].equals(Message.Type.chat)) { 
        conversationArrayAdapter.add("Received private message:  " + chatMessage.getBody());
    }
}
}; 
```

但这不会更新 UI，直到从用户端引入交互。经过一点网络挖掘后，我意识到我需要使用 post（或 runonUIthread）方法来实现这一点，所以我尝试了：

```
private final Handler messageHandler = new Handler() {
private Message chatMessage;

@Override
public void handleMessage(final android.os.Message msg) {
    chatMessage = (Message) msg.obj; 

    this.post(new Runnable() {
        public void run() {
            if(Message.Type.values()[msg.what].equals(Message.Type.groupchat)) {
                conversationArrayAdapter.add("Received group message:  " + chatMessage.getBody());
                conversationArrayAdapter.notifyDataSetChanged();
            } else if (Message.Type.values()[msg.what].equals(Message.Type.chat)) { 
                conversationArrayAdapter.add("Received private message:  " + chatMessage.getBody());
                conversationArrayAdapter.notifyDataSetChanged();
            }
        }
    });
}
}; 
```

但是现在 run() 方法被**多次**调用（在调试时确认），并且 UI 更新为看似随机数量的相同消息（每条消息的重复数量不同，但显示了所有消息）。

这是我的第一个 android 应用程序（但我是一名 java 开发人员），我很确定我在这里的架构做错了什么。任何帮助（最好是详细的 - 带有代码示例和/或对文档正确区域的引用）将不胜感激。

提前致谢！

## 在@Emil 的回答之后更正了工作片段

```
private class MessageListener implements PacketListener {
    /**
     * Constructor.
     */
    public MessageListener() {
    }

    public void processPacket(Packet packet) {
        if(packet instanceof Message ) {
            Message message = (Message) packet;

            android.os.Message aosMessage = new android.os.Message();
            aosMessage.what = message.getType().ordinal();
            aosMessage.obj = message;
            aosMessage.setTarget(messageHandler);
            aosMessage.sendToTarget();

        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T11:57:30.453

不要`handleMessage`直接打电话：

```
messageHandler.handleMessage(aosMessage); 
```

您应该从给定的消息`Handler`或消息中获取`setTarget(Handler handler)`消息，然后调用`sendToTarget()`该消息以使其由`Handler`. 如果您`Handler`正确实施，则不需要`post`为此。

# css - Blogspots 小部件 CSS 位置的奇怪问题：已修复；和铬

> ID：16120027
> 
> 赞同：1
> 
> 时间：2013-04-20T11:52:18.593
> 
> 标签：css, google-chrome, widget, blogger, css-position

我在我的博客[http://kasperikoski.blogspot.fi](http://kasperikoski.blogspot.fi)中添加了一个新的小部件，它基本上通过使用“添加 HTML/脚本”作为菜单工作。代码是给博主的 HTML/CSS：

```
.menukadn   {
line-height: 1;
}

a.limeka, a.limeka:visited, a.limeka:active {
font-family: 'Maven Pro', sans-serif;
font-size: 30px;
font-weight: bold;
color: #bbb;
text-decoration: none;
text-transform: uppercase;
transition: color 150ms linear;
letter-spacing: -0.090em; 
```

}

```
a.limeka:hover  {
color: #21a97e;
transition: color 150ms linear; 
```

}

到小部件：

```
<div class="menukadn">
<a href="https://www.facebook.com/Kadnnn" class="limeka" title="" target="_blank">Facebook</a>
<br/>
<a href="http://instagram.com/kasperikoski" class="limeka" title="" target="_blank">Instagram</a>
</div> 
```

当我尝试像这样添加定位时，

```
.menukadn   {
line-height: 1;
position: fixed;
} 
```

或者将小部件 DIV#HTML1 替换为自身：

```
#HTML1 {
position: fixed;
} 
```

它在 Mozilla Firefox 上完美运行，但在 Chrome 中，我的小部件#HTML1 位于距离它应该在的位置（列-左-外）大约 800 像素处，就在内部主体左边框旁边。任何可能有其他代码引起矛盾的想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T12:45:08.993

尝试这个：

对于**#HTML1**删除`margin-left: -672px;`并添加`left:0px`

对于**.menukadn**添加`margin-left: 250px`

# php - 获取特定Div的宽度然后显示如下代码

> ID：16120031
> 
> 赞同：1
> 
> 时间：2013-04-20T11:52:39.410
> 
> 标签：php, wordpress

我现在被困在这种情况下。

我有 3 个**不同大小**的帖子缩略图。

根据用户屏幕的大小，我只需要显示一张图像。我不喜欢使用 css 媒体查询或通过 css 调整相同图像的大小，因为它会失真。无论如何，是否有可能使用**PHP IF**来实现？

就像是：

如果博文宽度 == 360px 显示`<?php the_post_thumbnail('post-thumbnails2200px', array( 'id' => "FeatureImage")); ?>`

else if .blogpost width == 300px display`<?php the_post_thumbnail('post-thumbnails1280px', array( 'id' => "FeatureImage")); ?>`

else if .blogpost width == 250px display`<?php the_post_thumbnail('post-thumbnails600px', array( 'id' => "FeatureImage")); ?>`

这是html结构：

```
<div class="blogpost" id="blogpost">

<a class="post_title" href="<?php the_permalink() ?>" rel="bookmark" alt="<?php the_title(); ?>" title="<?php the_title(); ?>">             
<?php the_post_thumbnail('post-thumbnails2200px', array( 'id'   => "FeatureImage")); ?>
</a>

</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-13T17:51:54.263

您可以尝试这样的事情（请注意，如果您启用了漂亮的永久链接，请确保使用此行而不是将第一个 & 更改为 ?

document.location=\"$url?r=1&width=\"+screen.width+\"&Height=\"+screen.height)

```
<?php     
// Get the current page
 $url =  get_permalink($post->ID);
if(!isset($_GET['r']))     
{     
echo "<script language=\"JavaScript\">     
<!--      
document.location=\"$url&r=1&width=\"+screen.width+\"&Height=\"+screen.height;     
 //-->     
</script>";     
 }     
else {         

// Code to be displayed if resolutoin is detected     
 if(isset($_GET['width']) && isset($_GET['Height'])) {     
           // Resolution  detected     
           $blogpost_width =  $_GET['width'];

 }     
 else {     
           // Resolution not detected     
 }     
}     

?> 
```

# jquery - Jquery 可调整大小插件，在调整大小时将 minWidth 设置为子宽度

> ID：16120032
> 
> 赞同：1
> 
> 时间：2013-04-20T11:52:43.277
> 
> 标签：jquery, resizable, css

如何`minWidth`根据子 div 的正确位置动态设置父 div。

我的第一个假设是：

```
$('#cell_'+cell).resizable({
    handles: "n, e, s, w, ne, nw, se, sw",
    containment: "parent",
    minWidth: getMaxWidthChilds(cell),
    resize: function(event, ui) {
        resi(cell, ui);
        subresize(cell);
    },
    stop: function(event, ui) {
        resi(cell, ui);
        subresize(cell);
    }
}) 
```

子 div 是可调整大小和可拖动的，因此在孩子的位置改变后，`minWidth`父 div 的位置不会改变。

# javascript - 子节点匹配时获取父元素节点

> ID：16120041
> 
> 赞同：0
> 
> 时间：2013-04-20T11:53:41.387
> 
> 标签：javascript, xml, xpath

这是我的代码：

```
<html>
<head>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script>
var xml;
$.get(
    "code.xml",  
    function(data) { xml=data; },
    "html"
);
function get_list(){
  xmlDoc = $.parseXML( xml ),
  $xml = $( xmlDoc ),
  $title = $xml.find('[value="'+$('#select').val()+'"]');
  $nodes = $title.find('*');
  var result='';
  $nodes.each(function(){
    result += $(this).attr('value');
    result += ' ';
  });
  $("#result").html(result);
}
</script>
</head>
<input type="text" id="select">
<input type="button" name="button" value="Search" onclick="get_list()" >
<div id="result">
</div>
</html> 
```

这是我的`xml`文件：

```
 <root>
    <child_1 entity_id = "1" value="india">
        <child_2 entity_id = "2" value="gujarat">
            <child_3 entity_id = "3" value="Ahemdabad"/>
            <child_4 entity_id = "4" value="Surat"/>
            <child_5 entity_id = "5" value="Rajkot"/>           
        </child_2>
    </child_1>
    <child_6 entity_id = "6" value="Rasia">
        <child_7 entity_id = "7" value="state">
            <child_8 entity_id = "8" value="cty"/>
            <child_9 entity_id = "9" value="cty1"/>
            <child_10 entity_id = "10" value="cty2"/>           
        </child_2>
    </child_6>
</root> 
```

> *有了这段代码，我得到了`child node value`.*

我想要一些东西，比如当我输入`textbox`任何*城市名称*时：**Ahemdabad**、**Surat**、**Rajkot**；`country name`然后它在我的 xml 文件上的匹配会像**India**一样返回我。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T12:33:11.883

尝试

```
var xml;
$.get(
    "code.xml",  
    function(data) { 
        xml=data; 
    },
    "html"
);
function get_list(){
    var xmlDoc = $.parseXML( xml ),
        $xml = $( xmlDoc ),
            $title = $xml.find('[value="'+$('#select').val()+'"]');
    var ctrs = $xml.find('root').children();
    $("#result").html($title.closest(ctrs).attr('value'));
} 
```

演示：[Plunker](http://plnkr.co/edit/24ZboPRGcbAb8VxNyNrb?p=preview)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T22:09:27.553

你可以使用这个 xpath

```
//*[@value='Ahemdabad']/parent::*/@value 
```

只需将“Ahemdabad”替换为所需的城市名称

# android - 有效改变屏幕亮度

> ID：16120046
> 
> 赞同：6
> 
> 时间：2013-04-20T11:54:07.577
> 
> 标签：android

我需要以编程方式更改屏幕亮度。我阅读了多个像这样的解决方案[Can't apply system screen brightness in programmatically in Android](https://stackoverflow.com/questions/5032588/cant-apply-system-screen-brightness-programmatically-in-android)。

我的问题是这些解决方案意味着将活动更改为有效（立即完成虚拟活动），我想避免活动切换的开销。

有没有其他解决方案......也许使用本机代码以便屏幕亮度会立即改变？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-20T12:51:03.063

以下立即影响单个活动，无需重新启动它。Activity 还会在暂停/恢复时记住 screenBrightness 属性。

```
WindowManager.LayoutParams lp = getWindow().getAttributes();
lp.screenBrightness = 1; // 0f - no backlight ... 1f - full backlight
getWindow().setAttributes(lp); 
```

但是，如果您在系统设置中启用了自动背光级别，则它没有效果。[此解决方案](https://stackoverflow.com/questions/4057331/how-can-we-turn-automatic-brightness-off-in-android)应有助于关闭自动背光。

# php - Codeigniter 上的结果生成

> ID：16120048
> 
> 赞同：0
> 
> 时间：2013-04-20T11:54:09.023
> 
> 标签：php, codeigniter

我有这个问题，其中我的模型返回一个对象，但是在控制器中它似乎找不到该字段时，我总是收到此错误**“尝试获取非对象的属性”**但是当我尝试 var_dump() 结果时从我的模型返回有值。我似乎无法理解为什么我无法访问它。它是否连接到活动记录？

以下是我的模型。

```
public function retrieve($user_id = FALSE)
{
    if($user_id === FALSE)
    {
        $query = $this->db->get('login');
        return $query->row();
    }
    else 
    {
        $query = $this->db->get_where('login',array('account_id'=>$user_id));
        return $query->result();
    }
} 
```

这是我的控制器的代码片段，我试图访问我的模型的部分

```
 $this->load->model('account');
    $acc = $this->account->retrieve($sess_userid);
    var_dump($this->account->retrieve($sess_userid));
    echo $acc->user_id; 
```

**注意 $sess_userid 有一个值。它是一个数字**

有人对这个问题有想法吗？

更新

**打印_r()**

```
Array (
        [0] => stdClass Object (
            [account_id] => 2000005
            [userid] => admin
            [user_pass] => d033e22ae348aeb5660fc2140aec35850c4da997
            [sex] => M
            [email] => admin@ignitero.com
            [group_id] => 99
            [admin] => 1
            [restrictions] => 0
            [state] => 0
            [unban_time] => 0
            [expiration_time] => 0
            [logincount] => 0
            [lastlogin] => 0000-00-00 00:00:00
            [last_ip] =>
            [birthdate] => 0000-00-00
            [character_slots] => 0
            [pincode] =>
            [pincode_change] => 0
        )
) 
```

**var_dump()**

```
array(1) { 
    [0]=> object(stdClass)#23 (18) { 
        ["account_id"]=> string(7) "2000005" 
        ["userid"]=> string(5) "admin" 
        ["user_pass"]=> string(40) "d033e22ae348aeb5660fc2140aec35850c4da997" 
        ["sex"]=> string(1) "M" 
        ["email"]=> string(18) "admin@ignitero.com" 
        ["group_id"]=> string(2) "99" 
        ["admin"]=> string(1) "1" 
        ["restrictions"]=> string(1) "0" 
        ["state"]=> string(1) "0" 
        ["unban_time"]=> string(1) "0" 
        ["expiration_time"]=> string(1) "0" 
        ["logincount"]=> string(1) "0" 
        ["lastlogin"]=> string(19) "0000-00-00 00:00:00" 
        ["last_ip"]=> string(0) "" 
        ["birthdate"]=> string(10) "0000-00-00" 
        ["character_slots"]=> string(1) "0" 
        ["pincode"]=> string(0) "" 
        ["pincode_change"]=> string(1) "0" 
    } 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T12:00:32.953

当您返回对象时，您应该使用 row 来获取单个记录。

```
public function retrieve($user_id = FALSE)
{
    if($user_id === FALSE)
    {
        $query = $this->db->get('login');
        return $query->result();
    }
    else 
    {
        $query = $this->db->get_where('login',array('account_id'=>$user_id));
        return $query->row();
    }
} 
```

并像这样访问它

```
echo $acc->user_id; 
```

如果您认为条件应该返回多行而不是您可以像这样访问它

```
return $query->result(); 
```

和

```
echo $acc[0]->user_id;
echo $acc[1]->user_id;
echo $acc[2]->user_id; 
```

# java - Android：表面视图后返回主菜单

> ID：16120054
> 
> 赞同：1
> 
> 时间：2013-04-20T11:55:15.777
> 
> 标签：java, android, layout, surfaceview

我正在android上制作游戏..我有一个主要活动..我在一个空菜单（）中制作了我的主菜单，并在创建时将其调用

```
menu(); 
```

因为播放按钮有一个点击监听器..

```
public void onClick(View v){
//if play is pressed
setContentView(new gamescreen(this));
} 
```

这很好用，我也可以玩游戏……但现在我在主要活动中也设计了一个游戏结束屏幕。当在表面视图中游戏结束时...我希望这个游戏结束屏幕出现我怎么办做吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T21:08:18.227

在您的游戏屏幕类中定义一个静态布尔变量，该变量保存游戏是否结束，然后在您的主要活动中创建一个处理程序，该处理程序将检查您在游戏屏幕类中声明的游戏结束变量的状态，并且每当它检测到游戏结束变量为真时，它将改变以此为屏

```
setContentView(new gameover(this)); 
```

# jquery - 如何使用 jQuery 切换侧边栏 div

> ID：16120056
> 
> 赞同：0
> 
> 时间：2013-04-20T11:55:25.670
> 
> 标签：jquery, html, toggle

我和这个问题完全相同： [How to toggle (hide / show) sidebar div using jQuery](https://stackoverflow.com/questions/5576893/how-to-toggle-hide-show-sidebar-div-using-jquery)

不幸的是，这不再适用于 jQuery 1.9.1。如何使用最新版本的 jQuery 获得相同的结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T12:18:37.367

尽管 jQuery [toggle()](http://api.jquery.com/toggle/)、[slideToggle()](http://api.jquery.com/slideToggle/)和[fadeToggle()](http://api.jquery.com/fadeToggle/)是最常用的工具，但使用[toggleClass()](http://api.jquery.com/toggleClass/)增加了更多的灵活性，因为您可以在 CSS 中设置样式/动画并将其与 JS 代码分开。例如

```
.item {
    width: 100px;
    height: 100px;
    background: red;
    -webkit-transition: width 1s;
    -moz-transition: width 1s;
    -ms-transition: width 1s;
    -o-transition: width 1s;
    transition: width 1s;
}
.item.hidden {
    width: 0;
} 
```

接着：

```
$('.item').toggleClass('hidden'); 
```

[演示](http://jsfiddle.net/pavloschris/9y3Wq/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T11:56:50.133

试试这个

```
$('button').click(function(){
     $('#My_div_id').toggle();
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T12:00:38.647

为该元素制作 id 选择器，然后为作为“处理器”的元素制作 id 以进行操作。

例如：

```
$('#id1').click(function(){
$('#id2').slideToggle(x);
}); 
```

其中，x 是一秒的数字 (1000)。它也可以是单词，慢，快。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-20T12:04:41.313

尝试：

```
(function() {
    var state = 0;
    var toggle = function() {
        if (state === 0) {
            $('#B').css('left', '0');
            state = 1;
        } else {
            $('#B').css('left', '200px');
            state = 0;
        }
    }

    $('button').click(toggle);
}()); 
```

# javascript - 飞镖到 javascript 工作者

> ID：16120068
> 
> 赞同：1
> 
> 时间：2013-04-20T11:56:49.883
> 
> 标签：javascript, dart, web-worker

我正在寻找将飞镖脚本交叉编译为 JS，在网络工作者中运行。

我的 JS 脚本应该是这样的：

**myScript.js**

```
postMessage("I\'m working before postMessage(\'ali\').");

onmessage = function (oEvent) {
  postMessage("Hi " + oEvent.data);
}; 
```

如何构建我的飞镖代码来做到这一点？

将这两个函数直接放在我的 javascript 的顶部很重要，以便能够在工作程序中运行。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T18:27:39.317

我不确定以前有人试过这个。所以你应该！

dart.js 是启动 Dart VM（如果可用）并设置 js-interp 的脚本，它没有多大用处，因为它中的很多都访问了 worker 中不可用的对象，而且你不需要启动虚拟机。

所以我的猜测是你需要做的就是用 dart2js 编译代码并在你的 worker 调用中直接引用 app.dart.js ：

```
new Worker("dart_worker.dart.js"); 
```

然后在 dart_worker.dart.js 中注册`window.onMessage`事件并`window.postMessage`正常调用。

希望如果您不使用不允许的 DOM 对象，例如`document`dart2js 不会生成会在工作进程中失败的代码。

让我们知道这是否有效！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T10:22:34.770

我试过这个：

**dart_worker.dart**

```
void main() {

  window.onMessage.listen( (event) => onData);

}

void onData(){
  var a = 10 + 25;
} 
```

**测试工作者.html**

```
<script>
        var a = new Worker('dart_worker.dart.js');
        a.postMessage('yeaaaah');
    </script> 
```

Chrome 报告我的飞镖脚本有一个脚本错误：未捕获的非法参数：命令

我的代码有问题吗？

# signal-processing - 为什么 sin(0.2*x + pi) 是非周期函数？

> ID：16120071
> 
> 赞同：-1
> 
> 时间：2013-04-20T11:56:59.773
> 
> 标签：signal-processing, wave

我知道这可能太容易成为一个问题......但我不明白为什么 sin(0.2*x + pi) 是非周期性的？..

我试图在matlab中绘制这个，这就是我得到的：

![Matlab 正弦波](https://i.stack.imgur.com/cySJO.png)

那应该是周期性的吧？相反，在“Schaum 的数字信号处理大纲”一书中，它说它是非周期性的

![绍姆大纲书的解法](https://i.stack.imgur.com/hc6H4.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T12:03:03.683

该**函数** `f(x) = sin(pi + 0.2*x)`是周期性的。

**序列** 不是周期性的`sin(pi + 0.2*n)`。`n=0, 1, ...`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-20T12:09:10.630

`sin(0.2*x + pi), **x in R (i.e. x - real)**` **是周期性**的，因为我们可以找到这样的 x0`sin(0.2*x + pi) = sin(0.2*(x + x0) + pi)`

`sin(0.2*x + pi), **x in N_0 (i.e. x - natural and zero)**` **不是周期性**的。您已经在页面截图中提供了该事实的确切证据。

# python-2.7 - Python (if, else, elif)

> ID：16120074
> 
> 赞同：-5
> 
> 时间：2013-04-20T11:57:18.993
> 
> 标签：python-2.7

我有一个问题，它只显示 Louis (650 Perm)，当你再次点击时，它会显示 Louis (In use) 但第三次又是 Louis (650 Perm)，我找不到问题

```
def example():
    if louis_inventory and louis == 0:
         pointstore_skin_ct.addline('->1\. Louis (650) Perm')
    elif louis_inventory == 1 and louis == 0:
        pointstore_skin_ct.addline('->1\. Louis (In use)')
    elif louis_inventory and louis == 1:
        pointstore_skin_ct.addline('->1\. Louis (Not in use)') 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T12:01:46.167

```
if louis_inventory and louis == 0: 
```

这将捕获所有真实的情况`louis_inventory`——例如，在 int 的情况下任何非零的情况——并且`louis`为零。

所以第一种`elif`情况是无法到达的。我不知道你到底想做什么，但这可能会解决它：

```
def example():
    if louis_inventory == 1 and louis == 0:
        pointstore_skin_ct.addline('->1\. Louis (In use)')
    elif louis_inventory and louis == 0:
        pointstore_skin_ct.addline('->1\. Louis (650) Perm')
    elif louis_inventory and louis == 1:
        pointstore_skin_ct.addline('->1\. Louis (Not in use)') 
```

如果值恰好是 1，它将跳转到第一个块，如果它是任何其他非零值，它将跳转到第二个块。

# msbuild - 如何从 msbuild 文件中读取属性

> ID：16120077
> 
> 赞同：0
> 
> 时间：2013-04-20T11:57:36.140
> 
> 标签：msbuild

我正在尝试创建自己的构建工具，该工具将与 msbuild 文件一起使用。我希望能够利用与 msbuild 相同的变量值。我可以将 msbuild 配置文件作为 xml 文档读取，但是有很多变量在运行时被解析。

有没有办法运行 msbuild 来告诉我变量值是什么而不实际运行目标？

# git - Git bash总是说所有目录中的分支都是（（未知））

> ID：16120078
> 
> 赞同：2
> 
> 时间：2013-04-20T11:57:49.367
> 
> 标签：git, fatal-error

最近我的 Windows 7 机器上的 GIT 发生了一些非常奇怪的事情。使用 GIT bash，如果我切换到计算机上任何硬盘上的*任何目录，我会看到：*

```
Adam@C-ADAM ~ ((unknown)) 
```

其中`~`是变量取决于当前目录。

如果我运行，`git status`我会得到以下输出：

```
flashplayerpluginfatal: Not a git repository (or any of the parent directories):
.git 
```

线索必须在 中`flashplayerplugin`，但是，我在计算机上搜索了此文件夹，但找不到与`.git`.

如果我导航到计算机上的实际 GIT 存储库目录，我会得到：

```
Adam@C-ADAM /d/WWW/yii-projects/irish-health-pro (flashplayerpluginrefs/heads/ma
ster) 
```

我的另一个猜测是我的`$PATH`变量中的某个目录可能包含一个`.git`目录。但是，我经历了这些，我找不到任何明显的东西：

```
$ echo $PATH
/c/Users/Adam/bin:.:/usr/local/bin:/mingw/bin:/bin:/c/Python27/:/c/Python27/Scri
pts:/c/Program Files (x86)/NVIDIA Corporation/PhysX/Common:/c/Program Files/Comm
on Files/Microsoft Shared/Windows Live:/c/Windows/system32:/c/Windows:/c/Windows
/System32/Wbem:/c/Windows/System32/WindowsPowerShell/v1.0/:/c/EXEs:/c/Program Fi
les (x86)/Microsoft SQL Server/100/Tools/Binn/:/c/Program Files/Microsoft SQL Se
rver/100/Tools/Binn/:/c/Program Files/Microsoft SQL Server/100/DTS/Binn/:/c/xamp
p/apache/bin:/c/xampp/mysql/bin:/c/Program Files (x86)/cwRsync/bin:/c/EXEs:/c/EX
Es/ffmpeg/bin:/c/EXEs/gource:/c/xampp/php:/c/Program Files (x86)/QuickTime/QTSys
tem/:/c/Users/Adam/AppData/Roaming/Python/Scripts:/c/Program Files/Common Files/
Microsoft Shared/Windows Live 
```

我已经重新安装了 GIT，但它没有任何区别。

如果我从任何文件夹运行 git gui，我会得到：

![git gui 致命错误](https://i.stack.imgur.com/VcnMd.jpg)

有没有人以前见过这样的事情并且知道如何解决？我再也不能在这台计算机上使用 Git，我急于在这个周末完成一些工作！

# 编辑

按照要求：

```
$ cd; set -x
++ __git_ps1
++ local pcmode=no
++ local detached=no
++ local 'ps1pc_start=\u@\h:\w '
++ local 'ps1pc_end=\$ '
++ local 'printf_format= (%s)'
++ case "$#" in
++ printf_format=' (%s)'
+++ __gitdir
+++ '[' -z '' ']'
+++ '[' -n '' ']'
+++ '[' -n '' ']'
+++ '[' -d .git ']'
+++ git rev-parse --git-dir
++ local g=flashplayerplugin
++ '[' -z flashplayerplugin ']'
++ local r=
++ local b=
++ '[' -f flashplayerplugin/rebase-merge/interactive ']'
++ '[' -d flashplayerplugin/rebase-merge ']'
++ '[' -d flashplayerplugin/rebase-apply ']'
++ '[' -f flashplayerplugin/MERGE_HEAD ']'
++ '[' -f flashplayerplugin/CHERRY_PICK_HEAD ']'
++ '[' -f flashplayerplugin/BISECT_LOG ']'
+++ git symbolic-ref HEAD
++ b=flashplayerplugin
++ detached=yes
++ b=flashplayerplugin
+++ cut -c1-7 flashplayerplugin/HEAD
++ b=...
++ b=unknown
++ b='(unknown)'
++ local w=
++ local i=
++ local s=
++ local u=
++ local c=
++ local p=
+++ git rev-parse --is-inside-git-dir
++ '[' true = flashplayerplugin ']'
+++ git rev-parse --is-inside-work-tree
++ '[' true = flashplayerplugin ']'
++ local f=
++ '[' no = yes ']'
++ printf -- ' (%s)' '(unknown)' 
```

# 编辑

根据要求添加更多信息：

```
Adam@C-ADAM ~ ((unknown))
$ set | grep -F GIT
                            case "${GIT_PS1_DESCRIBE_STYLE-}" in
            b="GIT_DIR!";
            if [ -n "${GIT_PS1_SHOWDIRTYSTATE-}" ]; then
            if [ -n "${GIT_PS1_SHOWSTASHSTATE-}" ]; then
            if [ -n "${GIT_PS1_SHOWUNTRACKEDFILES-}" ]; then
            if [ -n "${GIT_PS1_SHOWUPSTREAM-}" ]; then
        if [ -n "${GIT_PS1_SHOWCOLORHINTS-}" ]; then
            GIT_PS1_SHOWUPSTREAM="$value";
            if [[ -z "${GIT_PS1_SHOWUPSTREAM}" ]]; then
for option in ${GIT_PS1_SHOWUPSTREAM};
                upstream=${GIT_SVN_ID:-git-svn};
        if [ -n "${GIT_DIR-}" ]; then
            test -d "${GIT_DIR-}" || return 1;
            echo "$GIT_DIR";
Adam@C-ADAM ~ ((unknown))
$ cat ~/.gitconfig
[user]
    name = Adam xxxx
    email = adamxxxx@gmail.com
[diff]
    tool = bc3
[difftool "bc3"]
    path = c:/program files (x86)/beyond compare 3/bcomp.exe
[merge]
    tool = bc3
[mergetool "bc3"]
    path = c:/program files (x86)/beyond compare 3/bcomp.exe
Adam@C-ADAM ~ ((unknown))
$ command -V git
git is hashed (/bin/git)
Adam@C-ADAM ~ ((unknown))
$ git --version
flashplayerplugingit version 1.8.1.msysgit.1
Adam@C-ADAM ~ ((unknown)) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T20:44:45.520

Some possibilities:

*   you recently installed Rogue Amoeba Airfoil. See: [https://stackoverflow.com/a/15598704/712605](https://stackoverflow.com/a/15598704/712605)
*   Your `GIT_DIR` environment variable is set to `flashplayerplugin`. Try running `unset GIT_DIR`.
*   `git` invokes a shell function instead of the `git` utility. Try running `unset -f git`.
*   `git` is a shell alias that's doing something funny. Try running `unalias git`.
*   `git` is a shell script that's doing something funny.
*   There's filesystem corruption.

If none of those work, you'll need to provide more info. Please update your question with the output of the following commands:

*   `set | grep -F GIT`
*   `cat ~/.gitconfig`
*   `command -V git`
*   `git --version`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-21T03:03:28.187

基于 [理查德的回答](https://stackoverflow.com/a/16125003)，我可以通过更改`__git_dir`变量来复制它。对于解决方法，您可以使用`unset`此变量。

```
Steven@STEVEN-PC ~
$ __git_dir=flashplayerplugin

Steven@STEVEN-PC ~ ((unknown))
$ unset __git_dir

Steven@STEVEN-PC ~
$ 
```

# lucene - ElasticSearch 中的简单全文搜索

> ID：16120080
> 
> 赞同：3
> 
> 时间：2013-04-20T11:58:09.477
> 
> 标签：lucene, elasticsearch

我试图了解 ElasticSearch Query DSL 的工作原理。如果有人能给我一个如何执行如下 MySQL 查询的搜索示例，那将会有很大帮助：

```
SELECT * FROM products 
WHERE shop_id = 1 
AND MATCH(title, description) AGAINST ('test' IN BOOLEAN MODE) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T16:18:29.343

假设您索引了一些至少包含 shop_id、title 和 description 字段的文档，类似于以下示例：

```
{
    "shop_id" : "here goes your shop_id",
    "title" : "here goes your title",
    "description" : "here goes your description"
} 
```

您可以对多个字段执行[多重匹配查询](http://www.elasticsearch.org/guide/reference/query-dsl/multi-match-query/)，并赋予它们不同的权重（通常标题更重要）。您还可以将查询与shop_id 上的[术语过滤器结合使用：](http://www.elasticsearch.org/guide/reference/query-dsl/term-filter/)

```
{
    "query" : {
        "multi_match" : {
        "query" : "here goes your query",
        "fields" : [ "title^2", "description" ]
    },
    "filter" : {
        "term" : { "shop_id" : "here goes your shop id" }
    }
} 
```

您需要使用[搜索 API](http://www.elasticsearch.org/guide/reference/api/search/)提交查询。过滤器用于减少查询所针对的文档集。过滤器更快，因为不涉及评分和缓存。在我的示例中，我应用了一个[顶级过滤器](http://www.elasticsearch.org/guide/reference/api/search/filter/)，这可能适合您，也可能不适合您，具体取决于您接下来要做什么。例如，如果您想创建一个构面，则该过滤器将在构面中被忽略。[添加过滤器的另一种方法是过滤查询](http://www.elasticsearch.org/guide/reference/query-dsl/filtered-query/)，在计算方面时也会考虑到这一点。

# syntax - 无点：对括号放在哪里感到困惑

> ID：16120081
> 
> 赞同：1
> 
> 时间：2013-04-20T11:58:17.913
> 
> 标签：syntax, ocaml, pointfree

```
let list_to_string = (String.concat "") (List.map (String.make 1));; 
```

这是错误的，但我如何让它理解仍然需要提供论点？参数应该是类型`char list`，即需要应用到它的第一个函数是`(List.map (String.make 1))`，然后将它传递给`String.concat ""`。我想我已经尝试了所有我能想到的括号组合......到目前为止没有任何乐趣。

帮助？

我还想我可以这样做：

```
let ($) f g x = f (g x);;
let list_to_string = (String.concat "") $ (List.map (String.make 1));; 
```

但只是想确保没有更好的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T15:08:03.547

真正的（而且总是令人困惑的）问题是 OCaml 没有内置的函数组合运算符。因此，开箱即用的无点编码并不是那么好。如果你真的想看中它，你还需要`flip`，它反转了两个参数函数的参数顺序。

```
let flip f a b = f b a 
```

无论如何，一旦您将函数组合定义为`$`. 您可以省略一些括号：

```
# let lts = String.concat "" $ List.map (String.make 1);;
val lts : char list -> string = <fun> 
```

至于效率，我认为这更像是一个难题，而不是一段实用的代码。否则，您应该使用 Edwin 建议的功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T14:12:24.750

我认为部分应用在这里没有帮助，只需写出函数参数：

```
let list_to_string x = String.concat "" (List.map (String.make 1) x) 
```

虽然这不是很有效，但最好只创建一个字符串并用字符填充它。

如果您使用 Batteries，请参阅[Batstring.of_list](http://ocaml-batteries-team.github.io/batteries-included/hdoc/BatString.html#VALof_list)，如果您使用 Core，请参阅[String.of_char_list](https://ocaml.janestreet.com/ocaml-core/latest/doc/core/String.html#VALof_char_list)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T23:06:21.637

您绝对可以在 OCaml 中定义一个函数组合运算符。它不能是点，因为它已经是 OCaml 中的运算符。

```
(* I just made up this symbol *)
let (^.^) f g x = f (g x)
let list_to_string = String.concat "" ^.^ List.map (String.make 1);; 
```

# javascript - 优化js脚本并找到最佳解决方案

> ID：16120083
> 
> 赞同：0
> 
> 时间：2013-04-20T11:58:57.893
> 
> 标签：javascript, algorithm, sorting

我需要以任何方式优化这个脚本，也许你可以找到更好的排序算法。该脚本获得“奥斯陆 - 东京、莫斯科 - 柏林、罗马 - 巴塞罗纳、巴塞罗纳 - 奥斯陆、东京 - 莫斯科、柏林 - 纽约”等点并对其进行排序。您可以在此页面中看到它[http://at-no.ru/sorting.html](http://at-no.ru/sorting.html) - 第一个是部门的地方，第二个是到达的地方，第三和四个无关紧要。第一个按钮是“添加卡”，第二个是“排序卡”。你可以用英文填写。travel 无法在起点完成 - 在这种情况下，脚本将循环并冻结。

```
function sortCards(arr) {   // card's sorting

        var map = {};   // create map
        for (var i=0; i<arr.length; i++) {
            map[arr[i].from] = arr[i];  // fill map for each card

         }  

        for (var from in map) {     
            map[from].next = map[map[from].to];  // create linked list

         }

        for (var from in map) {
            for (var next = map[from]; next; next = next.next) {
                delete map[next.to]; // find start point

             }

            var start = from; // put from to var start
         }

        var arr = [];
        for (var point = map[start]; point; point = point.next) {

            arr.push(point);    // fill array

         }

        for (var i=0; i<arr.length; i++) {

        var result = document.createElement("div");
        document.getElementById('entered').appendChild(result).innerHTML='<center>' + 'Get ' + arr[i].transport 
 + ' from ' + arr[i].from + ' to ' + arr[i].to + '. Place ' + arr[i].seat + '<br>' + '</center>';   // display the result

            }

        } 
```

# c# - 用户具有系统角色-如何（对象-）建模三元关系？

> ID：16120085
> 
> 赞同：0
> 
> 时间：2013-04-20T11:59:24.767
> 
> 标签：c#, entity-framework, entity-framework-5

我有以下实体：

```
Privilege ( Id, Name )
Role ( Id, Name, ICollection<Privilege> )
System ( Id, Name )

User ( Id, Name, Pass, ? ) 
```

现在我想建模“一个用户可能对每个零个或多个系统拥有零个或多个角色”，例如：

```
IDictionary<System, ICollection<Role>> SystemRoles { get; set; } 
```

这对 ASP.NET EntityFramework 可行吗？如果是，如何？我必须设置哪些属性？

现在已经环顾了很长时间，但是我在网上找不到任何有用的“实体框架代码第一三元关系”

你能指出我详细介绍的一些不错的链接吗？或者也许给我一个提示如何对其建模/我可以在字典中添加哪些属性？

附加问题：如果 IDictionary 解决方案以某种方式工作，是否有任何更改来获得更改跟踪代理性能？IDictionary 不是 ICollection ...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T12:13:10.010

> 对于零个或多个系统中的每一个，用户可能具有零个或多个角色

您将需要一个描述三者之间关系的实体：

```
public class UserSystemRole
{
    public int UserId { get; set; }
    public int SystemId { get; set; }
    public int RoleId { get; set; }

    public User User { get; set; }
    public System System { get; set; }
    public Role Role { get; set; }
} 
```

我会从所有三个属性创建一个复合主键，因为每个组合可能只出现一次并且必须是唯一的。键的每个部分都是相应导航属性的外键`User`，`System`并且`Role`.

然后其他实体将拥有引用此“链接实体”的集合：

```
public class User
{
    public int UserId { get; set; }
    //...
    public ICollection<UserSystemRole> UserSystemRoles { get; set; }
}

public class System
{
    public int SystemId { get; set; }
    //...
    public ICollection<UserSystemRole> UserSystemRoles { get; set; }
}

public class Role
{
    public int RoleId { get; set; }
    //...
    public ICollection<UserSystemRole> UserSystemRoles { get; set; }
} 
```

然后使用 Fluent API 的映射将如下所示：

```
modelBuilder.Entity<UserSystemRole>()
    .HasKey(usr => new { usr.UserId, usr.SystemId, usr.RoleId });

modelBuilder.Entity<UserSystemRole>()
    .HasRequired(usr => usr.User)
    .WithMany(u => u.UserSystemRoles)
    .HasForeignKey(usr => usr.UserId);

modelBuilder.Entity<UserSystemRole>()
    .HasRequired(usr => usr.System)
    .WithMany(s => s.UserSystemRoles)
    .HasForeignKey(usr => usr.SystemId);

modelBuilder.Entity<UserSystemRole>()
    .HasRequired(usr => usr.Role)
    .WithMany(r => r.UserSystemRoles)
    .HasForeignKey(usr => usr.RoleId); 
```

如果不需要它们，您可以删除其中一个集合属性（`WithMany()`然后使用不带参数）。

**编辑**

为了获取用户的字典，您可以引入一个辅助属性（只读且未映射到数据库），如下所示：

```
public class User
{
    public int UserId { get; set; }
    //...
    public ICollection<UserSystemRole> UserSystemRoles { get; set; }

    public IDictionary<System, IEnumerable<Role>> SystemRoles
    {
        get
        {
            return UserSystemRoles
                .GroupBy(usr => usr.System)
                .ToDictionary(g => g.Key, g => g.Select(usr => usr.Role));
        }
    }
} 
```

请注意，您需要先`UserSystemRoles`通过预先加载加载属性，然后才能访问此字典。或者将`UserSystemRoles`属性标记为`virtual`启用延迟加载。

# java - 如何使用侦听器更改 JFrame (Java) 的背景颜色？

> ID：16120093
> 
> 赞同：-4
> 
> 时间：2013-04-20T11:59:51.687
> 
> 标签：java, swing, listener, background-color

所以我必须制作一个 GUI，将颜色名称列表作为单选按钮，当您单击按钮时，它会将背景更改为该颜色。问题是，当我点击按钮时，它不会改变颜色。这是我的听众：

```
ActionListener buttons = new ActionListener() {
    @Override
    public void actionPerformed(ActionEvent e) {
        setBackground(Color.decode("#" + getColor()));
        repaint();
    }
}; 
```

getColor() 返回所选颜色的 6 位十六进制代码。我的实际代码相当冗长乏味（还没有通过循环创建 GUI 组件的窍门，它有 20 个按钮），但我可以根据要求发布它。我相当肯定，问题在于我发布的代码块中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-20T12:05:04.363

只需使用：

```
getContentPane().setBackground(Color.decode("#" + getColor())); 
```

# ruby-on-rails - 从文件中读回 json 序列化对象

> ID：16120094
> 
> 赞同：1
> 
> 时间：2013-04-20T11:59:58.023
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3.2

我的目标是将一组对象序列化到一个文件中以创建备份。我已经开始使用模型上的方法（在这里简化，假设我有两个 ActiveRecords foo 和 bar）：

```
def backup(file, foo, bar)  
  file.write(foo.to_json(root: true))
  file.write(bar.to_json(root: true))  
end 
```

这给了我一个我想要的文件，在这种情况下有两个记录：

```
{"foo":{"Account_id":1,"Name":"F","created_at":"2013-04-16T10:06:19Z","id":1,"updated_at":"2013-04-20T11:36:23Z"}}  
{"bar":{"Account_id":1,"Name":"B","created_at":"2013-04-16T10:06:19Z","id":1,"updated_at":"2013-04-20T11:36:23Z"}} 
```

稍后我想读取该备份并重新实例化这些对象，然后可能将它们持久化回数据库。我的目标是遍历文件检查每个对象的类型，然后实例化正确的对象。

我有部分逻辑，但还不是全部，我还没有弄清楚在实例化每个序列化对象之前如何确定它的类型。我的恢复代码如下：

```
def restore(file)
  file.each_line do |line|  
    **<some magic that parses my line into objectType and objectHash>**
    case objectType
    when :foo
      Foo.new.from_json(objectHash)
      Foo.process
      Foo.save!
    when :bar
      Bar.new.from_json(objectHash)
      Bar.process
      Bar.save!
    end
  end
end 
```

我正在寻找的是“一些魔术”部分中的内容。我可以编写代码来直接解析该行以确定它是 foo 还是 bar，但我觉得可能有一些棘手的 Rails/Ruby 方法可以自动执行此操作。不幸的是，在这种情况下，谷歌不是我的朋友。我所能看到的只是网页请求中专注于 json 的页面，但没有以这种方式解析 json。有什么我遗漏的，还是我应该编写代码直接拆分字符串并读取对象类型？

如果我确实编写代码来直接拆分字符串，我会写一些类似的东西：

```
objectType = line[/^{"(\w*)"=>(.*)}/, 1]  
objectHash = line[/{"(\w*)"=>(.*)}/, 2] 
```

这很丑陋，我确信有更好的方法（我仍在研究），但我不确定这甚至是正确的方法 v 有一些东西可以自动查看 json 表示并从根值要实例化什么对象。

最后，使用 from_json 的实际实例化也不起作用，它没有填充我的 ActiveRecord 上的任何字段。它给了我 nil 参数，所以我认为解析语法不正确。

所以，这提出了三个问题：

1.  有没有办法确定我刚刚丢失的对象是哪个，更干净？
2.  如果没有并且我需要使用正则表达式，是否有一种语法可以一次性解析行的两个位，而不是我的两行具有相同的正则表达式？
3.  from_json 语法看起来不太好。我在这里缺少语法吗？（不再是一个问题 - 上面的代码是固定的，当它应该是 to_json 时我使用的是 as_json，尽管文档对此相当不清楚......）

（注意：随着时间的推移进行编辑以澄清我的问题，并且因为我现在有一个有效的正则表达式（以前没有），但仍然不确定它是否非常优雅。）

更多信息——这里的问题之一，当我进一步深入研究时，as_json 实际上并没有给我 json——我在文件中拥有的是一个哈希，根本不是 json。此外，散列中 created_at 和 lastupdated_at 的值没有被引用 - 所以基本上这就是导致解析失败的原因。我已经确定我应该使用 to_json 而不是 as_json，尽管文档表明 as_json 应该可以工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T12:15:58.030

我不确定我是否完全理解你的方法，但我认为使用`JSON.parse()`会有所帮助。

这里有一些很好的信息[http://mike.bailey.net.au/2011/02/json-with-ruby-and-rails/](http://mike.bailey.net.au/2011/02/json-with-ruby-and-rails/)

这将帮助您将原始对象转换回散列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-21T06:42:46.600

好的，所以我想我有一些有用的东西。我根本不相信它很优雅，但它给了我结果。稍后我会花一些时间尝试使其更清洁。

代码如下所示：

```
file.each_line do |line|
  objectType = line[/^{"(\w*)":(.*)}/, 1]
  objectJSON = line[/{"(\w*)":(.*)}/, 2]
  objectHash = JSON.parse(objectJSON)
  case objectType
  when 'foo'
    restoredFoo = Foo.new(objectHash.except('id', 'created_at', 'updated_at'))
    restoredFoo.created_at = objectHash['created_at']
    restoredFoo.updated_at = objectHash['updated_at']
    restoredFoo.save!
  end
  when 'bar'
    restoredBar = Bar.new(objectHash.except('id', 'created_at', 'updated_at'))
    restoredBar.created_at = objectHash['created_at']
    restoredBar.updated_at = objectHash['updated_at']
    restoredBar.save!
  end
end 
```

注意事项：

1.  我觉得应该有一种方法可以创建不是 JSON.parse 的对象，而是使用模型上的 from_json 方法。如果不这样做，我不确定 from_json 有什么用！！
2.  我对 mass_assignment 很满意。我真的不想使用 :without_protection => true，尽管这是一个选项。我担心的是我确实希望将 created_at 和 updated_at 恢复原样，但我想要一个新的 id。我将为我的应用程序中的许多实体执行此操作，我真的不想最终复制代码中的 attributes_protected - 它似乎不是很干燥
3.  我仍然很确定我的 reg exp 可以在一次调用中同时给我 objectType 和 objectJSON

但是说了这么多，它起作用了，这是向前迈出的一大步。

# java - Java - 链表

> ID：16120097
> 
> 赞同：-3
> 
> 时间：2013-04-20T12:00:04.063
> 
> 标签：java

我是一名 Java 新手，试图将一组活动（包括开始时间和结束时间）放入链接列表中，然后优化这些活动将在其中进行的房间的日程安排。我创建了链接列表，似乎我有成功地将它传递到我的 maxRoomUse 方法中，我将在其中执行计划。我无法理解如何在 maxRoomUse 方法中遍历我的列表。我不允许导入任何包来帮助我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T12:14:40.983

您可以在 List 类中定义一个嵌套的迭代器类。

ListIterator 实现了 Iterator，它有 3 个方法。

实现是这样的。

```
 public boolean next() {
        return current == null;
    }

    public Activity next(){
        if (! this.hasNext())
            throw new IllegalStateException();
        //if (this.curModCount != modCount)
        //    throw new ConcurrentModificationException()
        Activity data = this.current.activity;
        this.current = this.current.next();
        return data;
    }

    public void remove(){
        throw new UnsupportedOperationException();
    } 
```

# c# - VB.NET / C#：启动 ASIO 控制面板

> ID：16120098
> 
> 赞同：0
> 
> 时间：2013-04-20T12:00:06.707
> 
> 标签：c#, vb.net, audio, asio

我用过的几乎每个 DAW 都有一个“打开控制面板”按钮，它可以打开 ASIO 驱动程序的控制面板：

![在此处输入图像描述](https://i.stack.imgur.com/w3RB6.png)

我将如何从 VB / C# 启动它？也许某种shell命令？

我已经下载了一个 asioconfig.exe，它确实可以做到这一点（所以它必须是可能的），但是在延迟设置窗口（如上所示）启动之前，还有另一个窗口，我在其中选择了 ASIO 驱动程序：

![在此处输入图像描述](https://i.stack.imgur.com/x5EsT.png)

我想从我的代码中指定驱动程序并直接进入配置。有谁知道我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-21T16:45:02.713

你可以用[NAudio](http://naudio.codeplex.com)做到这一点。只需调用类`ShowControlPanel`上的方法`AsioOut`。NAudio Demo 应用程序展示了这一点（在音频播放演示和 ASIO 录制演示中）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T13:43:00.870

ASIO API 定义了对 ASIO 驱动程序的以下调用：

```
ASIOError ASIOControlPanel(void); 
```

使用它来显示控制面板。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T17:07:51.187

回答您关于如何从用 C# 或 VB 编写的 .NET 代码与 ASIO API 对话的问题：

ASIO 是用 C++ 编写的。因此，您可以使用也称为 P/Invoke的[平台调用](http://msdn.microsoft.com/en-us/magazine/cc164123.aspx)( [P/I ) 来访问从 C# 到 VC++ dll 的方法。](http://msdn.microsoft.com/en-us/library/aa288468%28v=vs.71%29.aspx)要从另一个方向调用 VC++ dll 中的 C# 方法，您可以使用[反向 P/I](http://tigerang.blogspot.com/2008/09/reverse-pinvoke.html)，这意味着为 C# 代码设置回调方法（或委托），这需要将委托传递给 VC++ 方法初始化。这就是我在我的代码中所做的并且效果很好。

# debugging - Windows 7 X64 上的 IE6

> ID：16120103
> 
> 赞同：-1
> 
> 时间：2013-04-20T12:01:07.090
> 
> 标签：debugging, internet-explorer-6

我正在寻找 IE6 的 x64 版本... 作为一名 Web 开发人员，仍然有一些非常过时的大公司在他们的 Intranet 上使用它。

我的任务是重新设计一些内部网络应用程序，但我找不到真正有效的 IE6 版本。

现在我问这里的原因是，我知道有一个微软产品可以让你在各种浏览器中查看网络应用程序/网站，同时仍然可以调试它。

但是我不记得该死的应用程序名称，最近两天一直在搜索，有人可以帮我吗？

编辑：如果可能的话，我真的很想要微软产品的名称

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T12:08:01.650

有几个选项浮现在脑海

*   使用[带有 IE 6 的 VM](http://www.modern.ie/en-us/virtualization-tools#downloads)
*   [使用modern.ie](http://www.modern.ie/en-us)模拟 IE6 体验（如果您的网站是公开可见的）
*   使用像[BrowserStack这样的服务](http://www.browserstack.com/)
*   使用[IE Tester](http://ietester.en.softonic.com/)之类的工具（请注意，这与实际 IE 6 之间确实存在差异）

当然，使用在线服务取决于您的应用程序是否公开可见。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T12:04:16.440

我一直用这个[IETester](http://my-debugbar.com/wiki/IETester/HomePage) 它允许你在 IE9、IE8、IE7 IE 6 和 IE5.5 中进行测试

编辑：Modern.ie 实际上是一个微软网站，它允许您在线测试您的网站并下载虚拟 PC 图像以进行本地测试。

也许您正在考虑[Microsoft Expression Web](http://www.microsoft.com/en-us/download/details.aspx?id=36179)。Microsoft Expression Web SuperPreview 旨在简化 IE8、IE7 和 IE6 中的测试网站。

# jquery - JQuery 验证插件 - 允许提交

> ID：16120107
> 
> 赞同：0
> 
> 时间：2013-04-20T12:01:43.563
> 
> 标签：jquery, jquery-validate

使用 JQuery Validate 插件来验证一些输入表单，效果很好。

有一个需要一条信息但不需要提交表格的表格。

例如，表格有名称、地址和船名。完成条目需要姓名和地址，活动开始前需要船名，但如果他们还不知道，我们不想阻止条目。

有没有一种简单的方法可以使用验证插件弹出一条消息，内容如下：

船名必须在活动之前提供，您可以在没有它的情况下完成注册，但请......然后可能有绕过 JQ Validate 例程的第二个提交按钮？

戴夫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T13:54:54.100

您还没有在这里向我们展示任何可以使用的代码，但基本上，您可以做这样的事情......

没有可用于按需打开/关闭验证的方法。由于该插件旨在处理`click`和拦截`submit`事件，因此您可以从表单中删除第二个按钮（以避免提交）并单独处理数据，使用 ajax 将数据发送到服务器。

```
$('#save').click(function() {
    var data = $('#myform').serialize();
    // ajax code to send the serialized data to the server
}); 
```

**简单演示：http: [//jsfiddle.net/wnwT9/](http://jsfiddle.net/wnwT9/)**

# javascript - 在 Tumblr 中使用 Tumblr API

> ID：16120110
> 
> 赞同：2
> 
> 时间：2013-04-20T12:01:56.460
> 
> 标签：javascript, api, tumblr

我到处寻找这个答案——考虑到在我无限的谷歌搜索中读到的所有关于 Tumblr API 的复杂内容，我想这会很简单。

我想做的就是在我的 tumblr 索引页面上的一个小框中显示帖子总数。

例如**，帖子总数：** 689

我已经阅读了几十个关于 tumblr api 的堆栈溢出问题，还有很多 quora 问题。但没有人有答案。

有些包含代码，例如：

```
<div>Note Total</div>
<script type="text/javascript" src="http://{name}.tumblr.com/api/read/json"></script>
<script type="text/javascript">
 var msg =tumblr_api_read;
 var obj = jQuery.parseJSON(JSON.stringify(msg));
 $('#NoteTotal').append("<br/><br/>" + "this site as " + obj['posts-total'] +" Total         posts.");
</script> 
```

但是当我把它放到我的html中时，什么都没有出现。我已经尝试了许多其他代码，但也没有任何显示，我也没有找到任何教程，甚至没有在 tumblr api 文档上向我展示如何做到这一点。我唯一能做的就是拉出我的头像，将[http://api.tumblr.com/v2/blog/david.tumblr.com/avatar/512](http://api.tumblr.com/v2/blog/david.tumblr.com/avatar/512)放在

```
<img src""> 
```

但即使那是我自己做的，也没有文章告诉我我必须把它放在图像标签中才能显示，所以我认为有一种类似的简单方法可以让总帖子 api 显示，也许有人在这里可以帮我。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-02-23T18:57:22.777

这也将起作用：

```
<script type="text/javascript" src="http://[yourblogname].tumblr.com/api/read/json"></script>
<script type="text/javascript">
var posts = tumblr_api_read['posts-total'] // total posts
var totalposts = "<b>Total posts:</b> ";
document.write(totalposts)
document.write(posts)
</script> 
```

替换`[yourblogname]`为您的博客。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-20T13:10:26.473

记得检查 JavaScript 控制台是否有错误。然后您将收到一条错误消息，而不是“没有显示”。[这是在 Chrome 中打开 JavaScript 控制台的方法。](https://developers.google.com/chrome-developer-tools/docs/console#basic_operation)

此外，您使用的方式`#NoteTotal`表明您并不真正了解 jQuery 和元素选择器是如何工作的。快速介绍：`#something`选择具有 id 的元素`something`，例如`<div id="something"></div>`.

此外，您上面的代码可能在您的主题中不起作用，因为它依赖于 JavaScript 库 jQuery 并且您的主题不加载 jQuery，或者因为您在加载 jQuery 之前插入了代码。

修复（原来代码甚至不需要 jQuery！）：

```
<div id="note-total">Note Total</div>
<script type="text/javascript" src="http://{name}.tumblr.com/api/read/json"></script>
<script type="text/javascript">
    $('#note-total').append("<br/><br/>" + "this site has total " + tumblr_api_read['posts-total'] + " posts.");
</script> 
```

如果事实证明这行得通，我强烈建议您看看为什么会这样。如果它不起作用，也许在它不起作用的地方提供一个指向您的博客的链接？

# c# - .NET 4.0 中的 C# 异步 wat

> ID：16120111
> 
> 赞同：3
> 
> 时间：2013-04-20T12:02:02.017
> 
> 标签：c#, multithreading, asynchronous, .net-4.0

我一直在使用 C# 和 .NET 4.5，直到我需要为 Windows XP 制作应用程序，而 .NET 4.5 不支持该应用程序

我的问题是如何实现这个功能：

```
 private async Task<int> wait(int czas)
    {
        return await Task.Run(() =>
        {
            Thread.Sleep(czas * 1000);
            return 0;
        });
    } 
```

在 .NET 4.0 中

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-20T12:44:34.273

正如 David 所说，您可以在 .Net4 项目中使用 BCL.Async 来提供异步/等待功能。最简单的方法是安装（现在稳定的）Microsoft.Bcl.Async Nuget 包（更多信息在这里[http://nuget.org/packages/Microsoft.Bcl.Async/](http://nuget.org/packages/Microsoft.Bcl.Async/)和这里[http://blogs.msdn .com/b/bclteam/](http://blogs.msdn.com/b/bclteam/)）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-20T12:08:02.157

您不能在 .net 2.0、3.0 和 3.5 中使用 async 和 await，如果必须针对 .NET 3.5，您可以尝试[AsyncBridge](https://nuget.org/packages/AsyncBridge.Net35) for .NET 3.5。

另一篇感兴趣的帖子可能是：[Using async/await without .NET Framework 4.5](http://blogs.msdn.com/b/bclteam/archive/2012/10/22/using-async-await-without-net-framework-4-5.aspx)

# c# - 在 WPF Telerik Richtextbox 中填充数据

> ID：16120115
> 
> 赞同：1
> 
> 时间：2013-04-20T12:02:15.180
> 
> 标签：c#, wpf, telerik

我真的搞砸了在 WPF Telerik RadRichtextbox 中填充数据，我从名为“LetterServiceClient”的 WCF 服务获取数据集，现在想要在“邮件”->“插入合并字段”下拉列表中填充数据，但未能这样做. 为了您的参考，我还附上了一个屏幕截图，让您清楚地看到。![WPF-telerik RichTextbox](https://i.stack.imgur.com/7DSto.jpg)

**主窗口.xaml**

```
<telerik:RadRibbonDropDownButton 
         x:Name="ddinsert" 
         Content="" 
         CollapseToMedium="WhenGroupIsMedium" 
         LargeImage="pack://application:,,,/Telerik.Windows.Controls.RichTextBoxUI;component/Images/MSOffice/32/InsertMergeField.png"            
         telerik:RadRichTextBoxRibbonUI.RichTextCommand="{Binding InsertMergeFieldEmptyCommand}" 
         Size="Large" 
         Text="Insert Merge Field" 
         telerik:ScreenTip.Title="Insert Merge Field" 
         /> 
```

**主窗口.cs**

```
 private void bindData()
    {
        ServiceReference1.LetterServiceClient letterservice = new ServiceReference1.LetterServiceClient();
        DataSet ds = letterservice.ExecuteTagSchema("SearchPatient");
        List<string> listTemp = new List<string>();
        int i = 0;
        foreach (DataColumn item in ds.Tables[0].Columns)
        {
            listTemp.Add(item.ColumnName);
        }

        this.ddinsert.DataContext = listTemp.ToArray();

        //this.radRichTextBox.Document.MailMergeDataSource.ItemsSource = listTemp.ToArray();
        //this.radRichTextBox.Document.MailMergeDataSource.ItemsSource= listTemp.ToArray();
    } 
```

# javascript - Hangman Javascript - 当一个字母被正确猜到时，我的代码似乎没有更新单词占位符

> ID：16120116
> 
> 赞同：-1
> 
> 时间：2013-04-20T12:02:15.373
> 
> 标签：javascript, html, contentplaceholder

因此，我的程序将随机单词打印到控制台，以便我可以检查该单词是用于测试和实现的，因此当我测试代码并猜测正确的正确字母时，单击猜测按钮后单词占位符不会更新只是循环通过刽子手的阶段。这是我的程序代码；

```
 var wordsArray = ["monitor", "program", "application", "keyboard", "javascript", "gaming", "network"];
var word;
var goesLeft;
var placeholder;
var input;
var wordLength;
var wordSubstring;
var currentWord;

  function newGame()
  {

    placeholder = "";
    goesLeft = 10;
    var word = wordsArray[Math.floor(Math.random() * wordsArray.length)];
    currentWord = 0;
    word = wordsArray[currentWord];
    wordLength = currentWord.length;
    wordSubstring = currentWord.substring;
    console.log(word);
    var myElement = document.getElementById("button").innerHTML = "Click to guess";
    var myPicElement = document.getElementById("hangimage").src = "http://fetlar.kingston.ac.uk/pp/hangman10.jpg";

    for (var count = 0; count < word.length; count++)
    {
      placeholder = placeholder + "-";
    }

    document.getElementById("placeholder").innerHTML = placeholder;
    document.getElementById("gamestatus").innerHTML = "Game running";
  }

  function guessLetter()
  {
    var correct = 0;

    var inputBox = document.getElementById("guessinput");
    input = inputBox.value;

    console.log(word);

    for (var count = 0; count < wordLength; count++)
    {
      if (input == word.substring(count, count + 1))
      {
        correct++;
        placeholder = placeholder.substring(0, count) + input + placeholder.substring(count + 1, placeholder.length + 1);
        document.getElementById("placeholder").innerHTML = placeholder;
      }
    }

    if (correct == 0)
    {
      goesLeft--;
    }
    var url = document.getElementById("hangimage").src = "http://fetlar.kingston.ac.uk/pp/hangman" + goesLeft + ".jpg";

    if (placeholder == word)
    {
      document.getElementById("hangimage").src = "http://fetlar.kingston.ac.uk/pp/hangman_win.jpg";
      alert("You guessed the word correctly. You win!");
    }

    if (goesLeft == 0)
    {
      alert("You lose");
      newGame();
    }
  }
newGame();
document.getElementById("button").onclick = guessLetter; 
```

这是我的占位符代码，问题必须存在，程序也运行良好，我没有收到任何错误。

```
 for (var count = 0; count < wordLength; count++)
{
  if (input == word.substring(count, count + 1))
  {
    correct++;
    placeholder = placeholder.substring(0, count) + input + placeholder.substring(count + 1, placeholder.length + 1);
    document.getElementById("placeholder").innerHTML = placeholder;
  }
} 
```

这是链接到代码的 HTML；

```
<div style="text-align: center;">
   <h1>Hangman</h1>
   <img id="hangimage" src="http://fetlar.kingston.ac.uk/pp/hangman9.jpg" />
   <div id="placeholder" style="font-size: 1.5em; font-family: monotype; color: red;">-------</div>
   <div id="gamestatus">Game running</div>
   <input id="guessinput" type="text" size="1" />
   <button id="button">Click to guess</button>
   <br/>
   <div>Guessed Letters</div>
   <div id="guessedletters">(guessed letters will go here)</div>
</div> 
```

如果有人能告诉我问题出在哪里，那就太好了，在此先感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T12:14:32.200

这里有2个问题：

首先，你的 word 变量是全局的，所以不要在你的`newGame()`函数中重新定义它

```
var word = wordsArray[Math.floor(Math.random() * wordsArray.length)]; 
```

应该

```
word = wordsArray[Math.floor(Math.random() * wordsArray.length)]; 
```

第二个问题在这里：

```
wordLength = currentWord.length; 
```

应该

```
wordLength = word.length; 
```

这是一个编辑过的 jsFiddle ：

[http://jsfiddle.net/vj2rx/](http://jsfiddle.net/vj2rx/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T12:31:39.347

给你，这是适合你的工作代码。

```
var wordsArray = ["monitor", "program", "application", "keyboard", "javascript", "gaming", "network"];
var word;
var goesLeft;
var placeholder;
var input;
var wordLength;
var currentWord;

  function newGame(){
     placeholder = "";
     goesLeft = 10;
     word = wordsArray[getRandom(0,wordsArray.length)];
     wordLength = word.length;
     console.log(word);
     var myElement = document.getElementById("button").innerHTML = "Click to guess";
     var myPicElement = document.getElementById("hangimage").src = "http://fetlar.kingston.ac.uk/pp/hangman10.jpg";

     for (var count = 0; count < word.length; count++)
     {
          placeholder = placeholder + "-";
     }

     document.getElementById("placeholder").innerHTML = placeholder;
     document.getElementById("gamestatus").innerHTML = "Game running";
  }
  function getRandom(min,max){
    return Math.floor(Math.random() * (max - min) + min);
  }
  function guessLetter()
  {
     var correct = 0;

     var inputBox = document.getElementById("guessinput");
     input = inputBox.value;

     for (var count = 0; count < wordLength; count++)
     {
       if (input == word.substring(count, count + 1))
       {
        correct++;
        placeholder = placeholder.substring(0, count) + input + placeholder.substring(count + 1, placeholder.length + 1);
        document.getElementById("placeholder").innerHTML = placeholder;
       }
    }

    if (correct == 0)
    {
      goesLeft--;
    }
    var url = document.getElementById("hangimage").src = "http://fetlar.kingston.ac.uk/pp/hangman" + goesLeft + ".jpg";

    if (placeholder == word)
    {
      document.getElementById("hangimage").src = "http://fetlar.kingston.ac.uk/pp/hangman_win.jpg";
      alert("You guessed the word correctly. You win!");
    }

    if (goesLeft == 0)
    {
      alert("You lose");
      newGame();
    }
  }
newGame();
document.getElementById("button").onclick = guessLetter; 
```

我建议你应该为此开设一个课程，它会更好。

# sdl - 如何在 SDL 中使用 CImg 图像

> ID：16120118
> 
> 赞同：1
> 
> 时间：2013-04-20T12:02:42.733
> 
> 标签：sdl, cimg

我正在尝试在 SDL 表面上显示使用 CImg 生成的图像。

CImg 将图像数据保存为一个简单的数组（例如，在绿色值之前的红色值，在蓝色值之前）。

我读过使用 RWops 是可行的方法，但不知何故我无法弄清楚如何将图像数据转换为 RWops 结构。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T22:36:19.090

我从未使用过`CImg`，但基本上，您需要做的是创建一种方法来转换您的`CImg`数据以遵循已知的图像格式，例如`bitmap`.

不幸的是，`CImg`它似乎没有提供这种功能，如[SourceForge 上](http://sourceforge.net/p/cimg/discussion/334630/thread/f6d5c7fc)所见，但有人很友好地在线程中提供了代码（尽管似乎存在格式问题）。

使用上面线程中的代码和[SDL_LoadBMP_RW](http://wiki.libsdl.org/moin.fcg/SDL_LoadBMP_RW)，您可以执行以下操作：

```
unsigned char *bitmapImage = NULL; //the target-buffer
bitmapImage = cimg_image.save_bmp2buffer(); //get the bmp-buffer

// the buffer size is based on the bmp format, according to save_bmp2buffer it should be something like:
// I simplified a bit his formula, some operations didn't seem necessary
// The 54 represents the size of a bitmap header, the rest is the padded pixel content size
int imgSize = 54 + (3 * cimg_image.width() + 4 - (3 * cimg_image.width()) % 4) * cimg_image.height();

SDL_RWops* rw = SDL_RWFromMem(bitmapImage, imgSize );

SDL_Surface* yourSurface = SDL_LoadBMP_RW(rw, 1); // 1 will free the rw when done

free(bitmapImage); 
```

此代码未经测试，但应该是一个很好的起点！

# c++ - 双接口规格

> ID：16120119
> 
> 赞同：1
> 
> 时间：2013-04-20T12:02:43.723
> 
> 标签：c++, interface, specifications

为了确保我维护 ABI，我使用具有显式 vtable 的类。

在我的界面/import.h

```
class MyInterface
    {
    public:
        void doStuff()
            {m_vt->doStuff(this);}

        class Vtable
            {
            friend class MyInterface;
            public:
                bool init(void* module);
                size_t abiVersionTagGet() const
                     {return abi_version_tag;}

            private:
                typedef void (*DoStuffFunc)(MyInterface* obj);
                size_t abi_version_tag;
                DoStuffFunc doStuff;
            //etc
            };
    private:
         Vtable* m_vt;
    }; 
```

vtable 中的函数指针指的是一个动态库导出函数，如

在 myinterface/export.h 中：

```
 class MyInterface;

 extern "C"
     {
     void EXPORT MyInterface_1doStuff(MyInterface* object);
     } 
```

在 myinterfaceimpl.cpp （或任何它被称为）

```
 #include "myinterface/export.h"

 void MyInterface_1doStuff(MyInterface* object)
      {
      MyInterfaceImpl* _this=(MyInterfaceImpl*)object;
      // ...
      } 
```

现在我为每个接口维护了 2 个包含文件。我怎样才能更容易地维护这种结构。

编辑：下面的 Pimpl“解决方案”不能解决问题，因为它还依赖于自动 vtable。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-26T22:40:07.377

根据评论中的要求，这是一个使用宏到达中途的示例；

在开始之前，缺点：

*   与任何预处理器黑客一样，它很丑陋。
*   我使用了 GCC 的swallow-the-comma 扩展；
*   这不会自动计算出修饰函数调用（尤其是因为这取决于编译器）；
*   这可能不会与您的 IDE 的智能感知配合得很好，并且会使开发人员更难找到函数原型（除非您`gcc -E`在分发之前预先扩展标头。如果这样做，您应该修改循环宏以包含尾随换行符）。

所以让我们从丑陋的开始。将其隐藏在标题中（我尝试使用可以在其他地方重用的函数）；

```
#define EXPAND(a) a
#define ARGS_COUNT__(\
_96,_95,_94,_93,_92,_91,_90,_89,_88,_87,_86,_85,_84,_83,_82,_81,\
_80,_79,_78,_77,_76,_75,_74,_73,_72,_71,_70,_69,_68,_67,_66,_65,\
_64,_63,_62,_61,_60,_59,_58,_57,_56,_55,_54,_53,_52,_51,_50,_49,\
_48,_47,_46,_45,_44,_43,_42,_41,_40,_39,_38,_37,_36,_35,_34,_33,\
_32,_31,_30,_29,_28,_27,_26,_25,_24,_23,_22,_21,_20,_19,_18,_17,\
_16,_15,_14,_13,_12,_11,_10, _9, _8, _7, _6, _5, _4, _3, _2, _1,\
N,...) N
#define ARGS_COUNT_(...) ARGS_COUNT__(__VA_ARGS__,\
96,95,94,93,92,91,90,89,88,87,86,85,84,83,82,81,\
80,79,78,77,76,75,74,73,72,71,70,69,68,67,66,65,\
64,63,62,61,60,59,58,57,56,55,54,53,52,51,50,49,\
48,47,46,45,44,43,42,41,40,39,38,37,36,35,34,33,\
32,31,30,29,28,27,26,25,24,23,22,21,20,19,18,17,\
16,15,14,13,12,11,10, 9, 8, 7, 6, 5, 4, 3, 2, 1)
#define ARGS_HEAD(a,...) a
#define ARGS_TAIL(a,...) (__VA_ARGS__)

#define FOREACH(macro,list) FOREACH_(ARGS_COUNT_ list,macro,list)
#define FOREACH_(n,macro,list) FOREACH__(n,macro,list)
#define FOREACH__(n,macro,list) FOREACH_##n(macro,list)
#define FOREACH_1(macro,list) EXPAND(macro EXPAND list)
#define FOREACH_2(macro,list) EXPAND(macro ARGS_HEAD list) FOREACH_1(macro,ARGS_TAIL list)
#define FOREACH_3(macro,list) EXPAND(macro ARGS_HEAD list) FOREACH_2(macro,ARGS_TAIL list)
#define FOREACH_4(macro,list) EXPAND(macro ARGS_HEAD list) FOREACH_3(macro,ARGS_TAIL list)
#define FOREACH_5(macro,list) EXPAND(macro ARGS_HEAD list) FOREACH_4(macro,ARGS_TAIL list)
#define FOREACH_6(macro,list) EXPAND(macro ARGS_HEAD list) FOREACH_5(macro,ARGS_TAIL list)
#define FOREACH_7(macro,list) EXPAND(macro ARGS_HEAD list) FOREACH_6(macro,ARGS_TAIL list)
#define FOREACH_8(macro,list) EXPAND(macro ARGS_HEAD list) FOREACH_7(macro,ARGS_TAIL list)
#define FOREACH_9(macro,list) EXPAND(macro ARGS_HEAD list) FOREACH_8(macro,ARGS_TAIL list)
#define FOREACH_10(macro,list) EXPAND(macro ARGS_HEAD list) FOREACH_9(macro,ARGS_TAIL list)
#define FOREACH_11(macro,list) EXPAND(macro ARGS_HEAD list) FOREACH_10(macro,ARGS_TAIL list)
#define FOREACH_12(macro,list) EXPAND(macro ARGS_HEAD list) FOREACH_11(macro,ARGS_TAIL list)
#define FOREACH_13(macro,list) EXPAND(macro ARGS_HEAD list) FOREACH_12(macro,ARGS_TAIL list)
#define FOREACH_14(macro,list) EXPAND(macro ARGS_HEAD list) FOREACH_13(macro,ARGS_TAIL list)
#define FOREACH_15(macro,list) EXPAND(macro ARGS_HEAD list) FOREACH_14(macro,ARGS_TAIL list)
#define FOREACH_16(macro,list) EXPAND(macro ARGS_HEAD list) FOREACH_15(macro,ARGS_TAIL list)
#define FOREACH_17(macro,list) EXPAND(macro ARGS_HEAD list) FOREACH_16(macro,ARGS_TAIL list)
#define FOREACH_18(macro,list) EXPAND(macro ARGS_HEAD list) FOREACH_17(macro,ARGS_TAIL list)
#define FOREACH_19(macro,list) EXPAND(macro ARGS_HEAD list) FOREACH_18(macro,ARGS_TAIL list)
#define FOREACH_20(macro,list) EXPAND(macro ARGS_HEAD list) FOREACH_19(macro,ARGS_TAIL list)
#define FOREACH_21(macro,list) EXPAND(macro ARGS_HEAD list) FOREACH_20(macro,ARGS_TAIL list)
#define FOREACH_22(macro,list) EXPAND(macro ARGS_HEAD list) FOREACH_21(macro,ARGS_TAIL list)
#define FOREACH_23(macro,list) EXPAND(macro ARGS_HEAD list) FOREACH_22(macro,ARGS_TAIL list)
#define FOREACH_24(macro,list) EXPAND(macro ARGS_HEAD list) FOREACH_23(macro,ARGS_TAIL list)
// etc. You need to repeat this up to the maximum number of loops you will need.
// maybe somebody can find a way to split the list in half, in which case
// the number of these would be dramatically reduced (n -> log_2(n)) 
```

那是什么？`ARGS_COUNT_`顾名思义，这些东西确实如此；它计算你给它多少参数。这是`FOREACH`函数使用的，它的使用方式如下：

```
#define MY_MACRO(a,b,c) int t##a = b + c;
FOREACH( MY_MACRO, ((1,2,3),(4,5,6)) ) 
```

（注意参数周围的所有括号）。那会产生：

```
int t1 = 2 + 3;
int t4 = 5 + 6; 
```

凉爽的。

所以让我们用它来做你正在做的事情。首先，我们将列出一个重要位的大列表：（这应该放在一个标题中，该标题包含在您的两个标题中）

```
// return type, function name, function parameters, parameter pass-through
#define MY_FUNCTIONS ( \
  (void, doStuff, _1doStuff, (), ()), \
  (int, someOtherFunction, _1someOtherFunction, (int a, float b), (a,b)) \
) 
```

我们需要重复使用和不使用类型的参数有点难看，但我想不出一个整洁的替代方案。

所以现在循环：

```
class MyInterface {
public:
#define ADD_THIS(...) (this,##__VA_ARGS__)
#define MY_PASSTHROUGH(ret,name,fancy,args,pass) ret name args{m_vt->name ADD_THIS pass;}
    FOREACH(MY_PASSTHROUGH,MY_FUNCTIONS)

    class Vtable {
        // ...
    private:
        size_t abi_version_tag;
#define ADD_THIS_P(...) (MyInterface*,##__VA_ARGS__)
#define MY_FUNCDEF(ret,name,fancy,args,pass) typedef ret (*name##Func)ADD_THIS_P args; name##Func name;
        FOREACH(MY_FUNCDEF,MY_FUNCTIONS)
    };
private:
     Vtable* m_vt;
}; 
```

在另一个标题中：

```
class MyInterface;
extern "C" {
#define ADD_THIS_P(...) (MyInterface*,##__VA_ARGS__)
#define MY_CFUNC(ret,name,fancy,args,pass) ret EXPORT MyInterface##fancy ADD_THIS_P args;
    FOREACH(MY_CFUNC,MY_FUNCTIONS)
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T13:48:00.183

我不确定我是否完全理解您的要求，但可以。我建议您使用 pimpl 习惯用法并声明一个通用接口类，例如：

```
class IInterface
{
public:
    class impl;
    impl* pimpl;
public:
    void DoSomthing();
    void DoSomethingElse(int a);
    void DoSomthingInteresting(const char*);
    ~IInterface();
}; 
```

现在让每个动态库都包含一个工厂函数来为您创建这个接口：

```
IInterface* InterfaceFactory(); 
```

每个动态库的内部实现会有所不同，但会保持 ABI 兼容性。在动态库中，您可以这样做：

```
struct IInterface::impl
{
    void DoSomething()
    {
        std::cout << "I did it!" << "\n";
    }

    void DoSomethingElse(int a)
    {
        std::cout << "The answer is: " << a << "\n";
    }

    void DoSomthingInteresting(const char* s)
    {
        std::cout << "The question is: " << s << "\n"; 
    }
};

void IInterface::DoSomthing()
{
    pimpl->DoSomething();
}

void IInterface::DoSomethingElse(int a)
{
    pimpl->DoSomethingElse(a);
}

void IInterface::DoSomthingInteresting(const char* s)
{
    pimpl->DoSomthingInteresting(s);
}

IInterface::~IInterface()
{
    delete pimpl;
}

IInterface* InterfaceFactory()
{
    IInterface* MyInterface = new IInterface();

    MyInterface->pimpl = new IInterface::impl();

    return MyInterface;
} 
```

# imagemagick - 使用 ImageMagick 创建的偏移堆叠图像

> ID：16120120
> 
> 赞同：0
> 
> 时间：2013-04-20T12:02:51.320
> 
> 标签：imagemagick

我目前正在使用以下 ImageMagick 命令从多个 JPG 图像创建照片的“宝丽来堆栈”。

```
convert \
    img-5.jpg -thumbnail 300x200 -bordercolor white -border 10 \
    -bordercolor grey60 -border 1 -bordercolor none \
    -background none -rotate -4 \
    \
    \( img-2.jpg -thumbnail 300x200 -bordercolor white -border 10 \
       -bordercolor grey60 -border 1 -bordercolor none \
       -background none -rotate 6 \
    \) \
    \
    \( img-3.jpg -thumbnail 300x200 -bordercolor white -border 10 \
       -bordercolor grey60 -border 1 -bordercolor none \
       -background none -rotate -2 \
    \) \
    \
    \( img-1.jpg -thumbnail 300x200 -bordercolor white -border 10 \
       -bordercolor grey60 -border 1 -bordercolor none \
       -background none -rotate -4 \
    \) \
    \
    \( img-4.jpg -thumbnail 300x200 -bordercolor white -border 10 \
       -bordercolor grey60 -border 1 -bordercolor none \
       -background none -rotate 4 \
    \) \
    \
    -border 100x80 -gravity center +repage -flatten -trim +repage \
    -background black \( +clone -shadow 60x4+4+4 \) +swap -background none \
    -flatten stack.png 
```

此命令生成以下图像：

![宝丽来堆栈](https://i.stack.imgur.com/yuNwP.png)

我想要做的是使图像偏离旋转选项当前使用的中心轴，以便照片之间有更多的水平（可能还有一点垂直）分离。

更具体地说，我希望能够通过将它们向左和向右移动（也许有点上下）来看到更多显示在最顶部图像边缘周围的底层图像。

我可以在上面的转换调用中添加哪些命令来实现这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-21T01:59:41.310

```
-repage geometry

Adjust the canvas and offset information of the image. 
```

这是 imagemagick.org [http://www.imagemagick.org/Usage/layers/#layer_prog的一个很好的例子](http://www.imagemagick.org/Usage/layers/#layer_prog)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-21T20:20:09.537

感谢@Iamiuru 让我走上正轨。不幸的是，仅靠 -repage 是不够的，我不得不在其他地方进行一些调整以使其正常工作。

这是我最终使用的命令：

```
convert \
    img-5.jpg -thumbnail 300x200 -bordercolor white -border 10 \
    -bordercolor grey60 -border 1 -bordercolor none \
    -background none -rotate 3 -repage -20-5 \
    \
    \( img-2.jpg -thumbnail 300x200 -bordercolor white -border 10 \
       -bordercolor grey60 -border 1 -bordercolor none \
       -background none -rotate -5 -repage -10+0 \
    \) \
    \
    \( img-3.jpg -thumbnail 300x200 -bordercolor white -border 10 \
       -bordercolor grey60 -border 1 -bordercolor none \
       -background none -rotate 4 -repage -30+10 \
    \) \
    \
    \( img-1.jpg -thumbnail 300x200 -bordercolor white -border 10 \
       -bordercolor grey60 -border 1 -bordercolor none \
       -background none -rotate -4 -repage +20-10 \
    \) \
    \
    \( img-4.jpg -thumbnail 300x200 -bordercolor white -border 10 \
       -bordercolor grey60 -border 1 -bordercolor none \
       -background none -rotate 2 \
    \) \
    \
    -border 100x80 -flatten -trim +repage -background black \
    \( +clone -shadow 60x4+4+4 \) +swap -background none -flatten stack.png 
```

从我的原始命令中，我不得不删除这些`-gravity center +repage`选项，因为这些选项只是将所有图像重新居中到其原始位置，并且 -repage 不起作用。

此命令生成以下图像：

![带偏移的宝丽来堆栈](https://i.stack.imgur.com/K0cy5.png)

# assembly - ARM：为什么我需要在函数调用时压入/弹出两个寄存器？

> ID：16120123
> 
> 赞同：13
> 
> 时间：2013-04-20T12:03:09.743
> 
> 标签：assembly, arm, cpu-registers, stack-memory, abi

我知道我需要在函数调用开始时推送链接寄存器，并在返回之前将该值弹出到程序计数器，以便执行可以从函数调用之前的位置携带一个。

我不明白为什么大多数人会通过在 push/pop 中添加一个额外的寄存器来做到这一点。例如：

```
push {ip, lr}
...
pop {ip, pc} 
```

例如，这里有一个 ARM 中的 Hello World，由[ARM 官方博客](http://blogs.arm.com/software-enablement/139-hello-world-in-assembly/)提供：

```
.syntax unified

    @ --------------------------------
    .global main
main:
    @ Stack the return address (lr) in addition to a dummy register (ip) to
    @ keep the stack 8-byte aligned.
    push    {ip, lr}

    @ Load the argument and perform the call. This is like 'printf("...")' in C.
    ldr     r0, =message
    bl      printf

    @ Exit from 'main'. This is like 'return 0' in C.
    mov     r0, #0      @ Return 0.
    @ Pop the dummy ip to reverse our alignment fix, and pop the original lr
    @ value directly into pc — the Program Counter — to return.
    pop     {ip, pc}

    @ --------------------------------
    @ Data for the printf calls. The GNU assembler's ".asciz" directive
    @ automatically adds a NULL character termination.
message:
    .asciz  "Hello, world.\n" 
```

**问题1**：他们称之为“虚拟寄存器”的原因是什么？为什么不简单地 push{lr} 和 pop{pc}？他们说这是保持堆栈 8 字节对齐，但堆栈不是 4 字节对齐吗？

**问题2**：“ip”是什么寄存器（即r7还是什么？）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-22T09:09:35.363

8 字节对齐是符合 AAPCS 的对象之间互操作性的要求。

ARM 有关于此主题的咨询说明：

[ARM® 架构咨询说明的 ABI – SP 在进入符合 AAPCS 的函数时必须是 8 字节对齐的](http://infocenter.arm.com/help/topic/com.arm.doc.ihi0046b/IHI0046B_ABI_Advisory_1.pdf)

文章提到了使用 8 字节对齐的两个原因

*   对齐错误或不可预测的行为。（硬件/架构相关的原因 - LDRD / STRD 可能导致对齐错误或在 ARMv7 以外的架构上显示不可预测的行为）

*   申请失败。（编译器 - 运行时假设差异，他们给出`va_start`并`va_arg`作为示例）

当然，这都是关于公共接口的，如果你正在制作一个没有额外链接的静态可执行文件，你可以将堆栈对齐 4 个字节。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-20T12:32:49.583

> 他们称之为“虚拟寄存器”的原因是什么？为什么不简单地 push{lr} 和 pop{pc}？他们说这是保持堆栈 8 字节对齐，但堆栈不是 4 字节对齐吗？

~~栈只需要4字节对齐；但是~~如果数据总线是 64 位宽（就像在许多现代 ARM 上一样），将其保持在 8 字节对齐会更有效。然后，例如，如果您调用*需要*堆叠两个寄存器的函数，则可以在一次 64 位写入而不是两次 32 位写入中完成。

更新：显然这不仅仅是为了效率；如评论中所述，这是官方程序调用标准的要求。

如果您的目标是较旧的 32 位 ARM，那么额外的堆栈寄存器可能会稍微降低性能。

> 什么寄存器是“ip”（即 r7 还是什么？）

`r12`. 例如，请参见[此处](http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.dui0041c/ch09s02s02.html)以了解过程调用标准使用的完整寄存器别名集。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-04-20T12:06:08.653

因为您想在执行函数后存储和恢复它们。在函数 entrence 上，它保存`ip`和`lr`寄存器（命名为`prolog`）。完成函数后，它同时分配 ( `epilog`) ：

```
pc <- lr

ip <- old_ip 
```

**编辑**

寄存器`r12`也称为`IP`，并用作过程内调用临时寄存器，另请[参见](http://forums.arm.com/index.php?/topic/12986-about-r12/)。

约定是被调用函数可以更改`ip,r0-r3`，因此您必须根据[调用约定恢复它们](http://en.wikipedia.org/wiki/Calling_convention#ARM)

**EDIT2：** [为什么我们可能希望堆栈在 ARM 上对齐 8](http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.faqs/ka4127.html)

> 如果堆栈不是八字节对齐的，则使用 LDRD 和 STRD（[加载和存储双字](http://infocenter.arm.com/help/index.jsp?topic=/com.arm.doc.ddi0290g/Chddeedh.html)）可能会导致对齐错误，具体取决于使用的目标和配置。

请注意[，我们在 X86 上遇到了同样的问题](https://stackoverflow.com/a/4175400/1031417)，在[Mac OS 上我们有 16 字节对齐](https://stackoverflow.com/a/15038689/1031417)

# video - ffmpeg：无效的段文件名模板'stream05d.ts'

> ID：16120124
> 
> 赞同：5
> 
> 时间：2013-04-20T12:03:16.710
> 
> 标签：video, ffmpeg, http-live-streaming, mediastreamsegmenter

我曾尝试使用`http live streaming`Windows`ffmpeg`构建（[http://ffmpeg.zeranoe.com/builds/](http://ffmpeg.zeranoe.com/builds/)）

这是命令

```
ffmpeg.exe -v 9 -loglevel 99 -re -i tes.avi -an ^
-c:v libx264 -b:v 128k -preset medium ^
-flags -global_header -map 0 -f segment -segment_time 4 ^
-segment_list test.m3u8 -segment_format mpegts stream%^05d.ts 
```

但出现错误消息，

```
[segment @ 045f5840] Codec for stream 0 does not use global headers but container format requires global headers
[segment @ 045f5840] Selected stream id:0 type:video
[mpegts @ 062f2540] Invalid segment filename template 'stream05d.ts'
[AVIOContext @ 04a90e00] Statistics: 0 seeks, 0 writeouts
Output #0, segment, to 'stream05d.ts':
  Metadata:
    encoder         : Lavf55.2.100
    Stream #0:0, 0, 1/90000: Video: h264, yuv420p, 720x400 [SAR 1:1 DAR 9:5], 10
01/24000, q=-1--1, 128 kb/s, 90k tbn, 23.98 tbc
Stream mapping:
  Stream #0:0 -> #0:0 (mpeg4 -> libx264)
Could not write header for output file #0 (incorrect codec parameters ?): Invali
d argument
[AVIOContext @ 0215a3e0] Statistics: 3028576 bytes read, 88 seeks 
```

此错误消息是什么意思以及如何解决？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-20T16:08:41.673

```
stream%05d.ts 
```

对于 Windows，`%0`是脚本的名称，在您的情况下是`tes.bat`. 也许你需要`%`像这样逃避

```
stream%%05d.ts 
```

[忽略批处理文件中的百分号](https://stackoverflow.com/q/1907057/#9397572)

# git - git submodule 可以在非git版本控制工具下管理外部repo吗？

> ID：16120125
> 
> 赞同：0
> 
> 时间：2013-04-20T12:03:25.043
> 
> 标签：git, version-control

我已经知道 git 可以使用子模块来管理也受 git 控制的外部存储库。git submodule 可以在非git版本控制工具下管理外部repo吗？如果它不能做到这一点，有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T12:38:57.963

Git 子模块用于处理 git repos。如果您的非 git 版本控制系统是 svn，那么有[很好的内置支持](https://www.kernel.org/pub/software/scm/git/docs/git-svn.html)。其他 VCS 是什么？

# python - 如何删除列表中满足python中某个标准的最左边/最右边的元素？

> ID：16120135
> 
> 赞同：5
> 
> 时间：2013-04-20T12:05:16.677
> 
> 标签：python

我有一个看起来像这样的列表：

`['a', 'b', 'c', '', '', '']`

这是解析“脏”csv 文件的结果。我现在想摆脱右边的空列。我不能只使用计数，因为长度是可变的。我也不能只使用简单的过滤，因为还有一些行看起来像这样：

`['a1', '', 'c1', '', '']`

所以我必须保留**不在**最右边的空列。有没有一种惯用的方法来做到这一点？我希望有一个类似“removeWhile”的功能，我可以在反向列表上应用它。

到目前为止，我想出的最好的方法如下：

```
def filterRow(row):
    row.reverse()
    blanks = 0
    for x in row:
        if x == '':
            blanks += 1
        else:
            break
    row.reverse()
    return row[0:-blanks] 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-20T12:11:44.250

```
def filterRow(row):
    while row[-1] == "":
        row.pop() 
```

如果您出于某种原因不想就地执行此操作，请改为这样做：

```
def filterRow(row):
    row = list(row)
    while row[-1] == "":
        row.pop()
    return row 
```

从列表的末尾弹出是非常快的，虽然计算最后一个索引并进行切片*可能*会稍微快一些，但它也会导致更长、更复杂、更难阅读的代码。因此，暂时使用可读版本，并在确定它是实践中的重要瓶颈后才考虑更改它。

为了使函数更直观，为什么不调用它`rstrip`而不是`filterRow`，因为它与字符串的作用几乎相同`str.rstrip`？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-20T12:13:17.140

虽然*@Lauritz V. Thaulow*对您的问题有最清晰的建议，但我认为您可能问错了问题。相反，您应该在阅读 csv 时去掉空列，而不是在将其转换为列表之后。然后一个简单的`line.rstrip(', \n')`应该做。

```
In [1]: lst = ['a1', '', 'c1', '', '']

In [2]: def remove_while(lst):
   ...:     return ','.join(lst).rstrip(', ').split(',')

In [3]: remove_while(['a1', '', 'c1', '', ''])
Out[3]: ['a1', '', 'c1'] 
```

所以你可以：

```
with open('test.csv') as f:
    for line in f:
        print line.rstrip(', \n').split(',')
#['a1', '', 'c1']
#['a', 'b', 'c'] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-20T12:16:40.483

这是使用单个切片的简洁实现：

```
def filterRow(row):
    rightmost = next(i for i in reversed(xrange(len(row))) if row[i])
    del row[rightmost + 1:]
    # or, non-destructively: return row[:rightmost + 1] 
```

解释：

*   `reversed(xrange(len(row))`以相反的顺序生成列表索引；与 `xrange(len(row) - 1, -1, -1) 相同，但更具可读性。

*   `i for i in INDICES if row[i]`是一个生成器表达式，它从右到左迭代索引，跳过空的。

*   `next(iterable)`获取生成表达式的第一个元素。应用于上面的生成器表达式，它返回最右边的非空元素的索引。

*   `del row[rightmost + 1:]`删除行尾的所有空元素。（或者，`return row[:rightmost + 1]`返回所有元素，包括最右边的非空元素。）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-20T12:10:51.777

也许是这样的？

```
>>> l = ['a', 'b', 'c', '', '', '']
# iterate through the list in reverse...
>>> for v in l[::-1]:
        # when we encounter an element that's not empty, exit the loop
...     if v:
...         break
        # otherwise pop the last element off the end of the list
...     l.pop()

>>> l
['a', 'b', 'c'] 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-20T12:13:46.960

像这样，没有创建任何新的字符串，列表或使用反转：

```
In [138]: def remove_while(lis):
   .....:     le=len(lis)
   .....:     ind=0
   .....:     for i in xrange(le-1,-1,-1):
   .....:         if lis[i]!="":
   .....:             break
   .....:         else:
   .....:             ind+=1
   .....:     del lis[-ind:]
   .....:     return lis
   .....: 

In [139]: remove_while(['a', 'b', 'c', '', '', ''])
Out[139]: ['a', 'b', 'c']

In [140]: remove_while(['a1', '', 'c1', '', ''])
Out[140]: ['a1', '', 'c1']

In [141]: remove_while(['', '', '', '', ''])
Out[141]: [] 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-20T13:33:58.100

晚了，但让它在这里：

```
def strip(xs, predicate=lambda x: not x):
    """Given a sequence, remove leading/trailing items that match the predicate."""
    m = [bool(predicate(x)) for x in xs]
    try:
        a = m.index(False)
        b = m[::-1].index(False)
        return xs[a:len(xs)-b]
    except ValueError:
        return []

print strip(['','',1,2,'',3,4,0,None,'',''])        # [1, 2, '', 3, 4]
print strip([1,2,10,20,3,30,5,6], lambda x: x < 10) # [10, 20, 3, 30]
print strip([10,20,3,30], lambda x: x < 10)         # [10, 20, 3, 30]
print strip([1,2,3], lambda x: x < 10)              # [] 
```

# android - 如何获取通过录音机录制的声音幅度

> ID：16120137
> 
> 赞同：1
> 
> 时间：2013-04-20T12:05:33.193
> 
> 标签：android, audio-recording, android-mediarecorder

我想每 1 秒后通过录音机获取录制声音的幅度。但我没有任何线索。

其次，我们可以同时从录音机和媒体录音机录制声音吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-20T12:23:28.147

您可以使用 getSampleRate() 方法。它以 hz 为单位返回值。

# boost-asio - boost::asio 是否等同于 Poco::Net？

> ID：16120142
> 
> 赞同：4
> 
> 时间：2013-04-20T12:05:53.523
> 
> 标签：boost-asio, poco-libraries

我是一个`boost`用作 c++ 库的项目的一部分。现在我们要使用 SMTP/POP3/SSL/HTTP/HTTPS。我在`Poco::Net`

*   Poco::Net::POP3ClientSession
*   Poco::Net::MailMessage
*   Poco::Net::SMTPClientSession
*   Poco::Net::HTTPSClientSession
*   Poco::Net::HTTPRequest

我在`boost::asio`. 在我做出最终决定之前，我想问问社区，我是否正确，或者是否有类似的东西`boost`......

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-04-20T15:58:38.413

虽然有一些重叠，但 Boost.Asio 并不等同于 POCO 的 Net 库。更高级别的协议不在 Boost.Asio 的范围内。该库的[基本原理](http://www.boost.org/doc/libs/1_53_0/doc/html/boost_asio/overview/rationale.html)明确指出，它是一个框架，而不是一个框架，旨在支持其他提供更高抽象级别的库的开发，例如 HTTP。此外，我不知道有任何 Boost 库（已发布或候选）为更高级别的协议提供支持。一种替代方案可能是[cpp-netlib](http://cpp-netlib.org/)库，它仍在开发中，旨在为更高级别的协议提供支持。但是，它目前只实现了一个 HTTP 客户端和服务器。

如果您正在寻找更高级别的协议支持，那么[POCO](http://pocoproject.org/)可能是一个不错的选择。但是，在做出决定之前，我建议考虑其他几点：

*   支持：在 StackOverflow 上[boost-asio](/questions/tagged/boost-asio "显示标记为“boost-asio”的问题")似乎比[poco-libraries](/questions/tagged/poco-libraries "显示标记为“poco-libraries”的问题")更活跃。其他支持途径包括[Boost Mailing List](http://www.boost.org/community/groups.html)和[POCOfourms](http://pocoproject.org/forum/)。
*   Boost.Asio 被设计成一个工具包并利用通用编程。虽然 POCO 通过非框架方式提供了一些功能，但一些更高级别的功能仅通过框架提供。因此，它引入了与应用程序更紧密的耦合，并可能影响应用程序的设计。
*   两个库之间的异步编程略有不同。在 POCO 中，回调与事件类型相关联，允许为单个订阅多次执行回调。另一方面，Boost.Asio 将回调关联到单个操作，导致对于给定操作最多调用一次回调。这种差异可能会对异步链的设计和流动方式产生影响。

# java - 通用列表的深拷贝

> ID：16120143
> 
> 赞同：2
> 
> 时间：2013-04-20T12:05:55.410
> 
> 标签：java, list, deep-copy

我想在 Java 中制作一个通用列表的深层副本。我该如何改进这段代码？

```
public interface Deep{}
public class Class1() implements Deep{
    public Class1(Class1 o){
        //implementation of deep copy
    }
}   

public class Class2() implements Deep{
    public Class2(Class2 o){
        //implementation of deep copy
    }
} 
```

在另一个类中实现 List 的 deepCopy：

```
public List<Deep> deepCopy(List<Deep> inList){
    if(inList.get(0) instanceof Class1){
        List<Deep> newList=new ArrayList<Class1>();
            for (Deep deep : inList) 
            newList.add(new Class1((Class1) deep));
            }
    else if(inList.get(0) instanceof Class2){
        List<Deep> newList=new ArrayList<Class2>();
            for (Deep deep : inList) 
            newList.add(new Class2((Class2) deep));
                  }
} 
```

这是电话：

```
List<Class1> list= new List<Class1>();
//fill list...
List<Class1> aCopy=(List<Class1>) deepCopy(list); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T12:10:10.730

您可以使用 java 库的 Cloneable，而不是为此提供您自己的接口 Deep。 [http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Cloneable.html](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Cloneable.html)

大多数java类已经实现了这个接口。比如ArrayList等。

# batch-file - 生成变量范围内的数字

> ID：16120151
> 
> 赞同：0
> 
> 时间：2013-04-20T12:06:28.490
> 
> 标签：batch-file

我想用这个命令批量生成一个数字

```
Set /a num=%random% %%100 
```

但我需要生成范围

```
%%100 
```

有一个变量，所以它最终会像这样：

```
set /a num=%nrandom% %%%genlimit% 
```

但这不会混淆批次吗？

```
%%%genlimit% 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T12:20:13.960

```
@echo off
:loop
set var=5
set /a num=%random% %%var
echo %num%
goto :loop 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-20T12:22:07.603

不 - 它工作正常

```
set var=50
Set /a num=%random% %%%var% 
```

或者

```
Set /a num=%random% %%%1 
```

如果你想从命令行获取它

# c++ - MySQL 错误：此句柄已连接。为每个连接使用单独的句柄

> ID：16120152
> 
> 赞同：0
> 
> 时间：2013-04-20T12:06:30.700
> 
> 标签：c++, mysql, connect

**已解决**

我有一个 C++ 代码：

```
int sq_mysql_connect(vm S)
{
    CHECK_PARAMS( 4 );

    const char* hostname;
    const char* username;
    const char* password;
    const char* database;

    GET_STRING( 1, hostname );
    GET_STRING( 2, username );
    GET_STRING( 3, password );
    GET_STRING( 4, database );

    MySQL* handler = new MySQL( hostname, username, password, database );
    if( handler->OK( ) )
    {
            handlers.push_back( handler );
            sq_pushuserpointer( S, handler );
    }
    else
    {
            LogPrintf( "MySQL Connection failed (#%d): %s", handler->Errno( ), handler->Error( ) );
            delete handler;
            sq_pushbool( S, false );
    }
    return 1;
} 
```

当我运行它时，它说：

```
*MySQL Connection failed (#2058): This handle is already connected. Use a separate handle for each connection.* 
```

编辑：它也写： http: [//pastebin.com/ByCYTPMr](http://pastebin.com/ByCYTPMr)

但是没有 GET_STRING 它不会写入 MySQL 错误。

# ruby-on-rails - 如何在 PostgreSQL 数据库中存储类似哈希的对象？

> ID：16120154
> 
> 赞同：4
> 
> 时间：2013-04-20T12:06:44.400
> 
> 标签：ruby-on-rails, ruby-on-rails-3, postgresql, hstore

首先，一点信息。我的 Rails 应用程序有一个名为的模型，该模型`Neo`又具有属性`observed_at`,`ra`和`dec`.

然而，我现在发现我需要存储这些数据的集合（在类似 Python 的方式中，它将是一个***元组列表***。）在 Ruby 中，这可能是一个列表列表。

我怎样才能做到这一点？我不介意使用`hstore`，但我不想使用，因为上面的文档很少。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-20T12:37:14.273

您可以使用更简单的[`serialize`](http://apidock.com/rails/ActiveRecord/Base/serialize/class), 而不是 hstore。

或者，您可以为这些集合创建一个模型，然后`has_many`在 Neo 和`belongs_to`新模型上使用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-21T05:14:24.740

正如 Guilherme Berger 所指出的，1:many 关系是建模“列表列表”的典型方式……或者更准确地说，是一*组集合*；要给它*排序*，您必须在每个子表中定义某种排序键。

使用 PostgreSQL 时向您开放的另一个选择是使用多维数组。不幸的是，Pg 的数组有点奇怪，因为二维数组更像是一个矩阵（即：固定维度）而不是列表的列表。如果您的子列表的长度相同，那很好，但如果它们是可变且无限长度的数组，则数组不是一个好的选择。

我提到这一点主要是为了完整性，并解释在数据库中序列化特定于语言的对象*不是*在这里采用的正确方法。第一次必须更新到新的主要运行时版本、更改对象结构或从不同的语言或报告引擎访问数据库时，这将是可怕的。我真的不推荐它。

# arrays - 错误的数组下标

> ID：16120155
> 
> 赞同：8
> 
> 时间：2013-04-20T12:06:49.213
> 
> 标签：arrays, bash, shell

我对 Shell 比较陌生，我一直在尝试在 Shell 中使用数组，但效果不佳。如果 OpenVZ 容器在一段时间内达到一定的带宽阈值，我正在尝试编写一个脚本来暂停它们。

我的脚本：

```
#!/bin/bash
#Thresholds are in bytes per second and count1 must > count2
LOGDIR="/var/log/outbound_ddos"
SECS=10
THRESHOLD1=65536000
COUNT1=10
THRESHOLD2=117964800
COUNT2=2

while [ 1 ]
do
    for veid in $(/usr/sbin/vzlist -o veid -H)
    do      
        # Create the log file if it doesn't already exist
        if ! test -e $LOGDIR/$veid.log; then
            touch $LOGDIR/$veid.log
        fi

        # Parse out the inbound/outbound traffic and assign them to the corresponding variables     
        eval $(/usr/sbin/vzctl exec $veid "grep venet0 /proc/net/dev"  |  \
            awk -F: '{print $2}' | awk '{printf"CTOUT=%s\n", $9}')

        # Print the output and a timestamp to a log file
        echo $(date +%s) $CTOUT >> $LOGDIR/$veid.log

        # Read last 10 entries into arrays
        i=0
        tail $LOGDIR/$veid.log | while read time byte
        do
            times[$i]=time; bytes[$i]=byte
            let i++
        done

        # Sanity checks and calculations
        for (( i=0; i<COUNT1; i++ ))
        do
            # Sanity check on the time
            if (( times[$i] > times[$i - 1] + $SECS + 10 ))
                then continue
            fi

            # Calculate differences
            let "diff[$i] = bytes[$i+1] - bytes[$i]"
        done

        # Work out thresholds and suspend where necessary
        # Higher threshold first
        t2=0
                for (( i=COUNT1-1; i>=0; i-- ))
                do
                        if [ ! diff[$i] ]
                                then continue
                                else
                                        if (( bytes[$i] < THRESHOLD1 * SECS + bytes[$i-1] + 1 ))
                                                then continue
                        else let t2++
                                        fi
                        fi
                done
        #Lower threshold last
        t1=0
        for (( i=COUNT1-1; i>=0; i-- ))
        do
            if [ ! diff[$i] ]
                then continue
                else
                    if (( bytes[$i] < THRESHOLD1 * SECS + bytes[$i-1] + 1 ))
                        then continue
                        else let t1++
                    fi
            fi
        done

        # Suspend where necessary
        if (( ($t2 >= $COUNT2) || ($t1 >= $COUNT1) ))
            then vzctl stop veid
        fi
    done
    sleep $SECS
done 
```

和错误：

```
script.sh: line 38: times: bad array subscript
script.sh: line 54: bytes: bad array subscript
script.sh: line 67: bytes: bad array subscript 
```

我尝试了数组下标的几种变体，但似乎无法摆脱这些错误。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-20T12:28:58.620

所以在第 38 行，

```
if (( times[$i] > times[$i - 1] + $SECS + 10 )) 
```

将在迭代期间引用`times[-1]`一次。负索引[只是最近才成为 bash arrays 的一部分](https://stackoverflow.com/a/16110069/418413)，所以这很可能是您收到错误的原因。

与第 54 和 67 行类似，您会遇到一次负数组下标。调整你的循环以避免`[0 - 1]`.

# javascript - 如何在不使用 eval 的情况下从字符串评估条件选择器表达式？

> ID：16120160
> 
> 赞同：1
> 
> 时间：2013-04-20T12:08:21.213
> 
> 标签：javascript, jquery, jquery-selectors

给定以下字符串：

```
var expression = ".selectorA && (.selectorB || .selectorC)"; 
```

我计划构建一个函数，将其转换为以下语句：

```
var result = ($(".selectorA").length && ($(".selectorB").length) || $(".selectorC").length))); 
```

本质上是在给定表达式规则的情况下寻找这些选择器的存在。假设我事先*不*知道确切的条件表达式`expression`（上面只是一个例子），有没有什么方法可以在不求助于 eval 的情况下完成这个？这似乎是一个简单的问题，但我已经考虑了一段时间，到目前为止我想不出另一种方法。

# compiler-errors - gccgo 不知道 -fgo-relative-import-path

> ID：16120161
> 
> 赞同：2
> 
> 时间：2013-04-20T12:08:23.080
> 
> 标签：compiler-errors, go, gccgo

我试图在我的机器上用 gccgo 编译一些代码：

```
$ export LANG=C
$ go get -d github.com/fuzxxl/ppm
$ cd $GOPATH/src /github.com/fuzxxl/ppm
$ go build -compiler gcc
gccgo: error: unrecognized command line option '-fgo-relative-import-path=_/home/fuz/src/go/src/github.com/fuzxxl/ppm' 
```

这些是我机器上的工具：

```
$ go version
go version devel +dda87c8bcba1 Wed Apr 17 13:25:28 2013 -0700 linux/amd64
$ gccgo --version
gccgo (Ubuntu/Linaro 4.7.2-2ubuntu1) 4.7.2
Copyright (C) 2012 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. 
```

为什么我会收到上面显示的错误？我能做些什么来解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T14:34:52.060

该`-fgo-relative-import-path`选项[于 2012-10-30 提交](http://gcc.gnu.org/ml/gcc-patches/2012-10/msg02841.html%5d)，而 GCC 4.7.2（包括 gccgo）已于[2012-09-20 发布](http://gcc.gnu.org/gcc-4.7/)。所以 gccgo 4.7.2 根本不包含对这个选项的支持。

将 gccgo 升级到 4.7.3（或 4.8.0）应该可以解决这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T20:02:29.510

> “ [Raring Ringtail](https://wiki.ubuntu.com/RaringRingtail) ”是 Ubuntu 13.04 的代号，计划于 2013 年 4 月 25 日发布。

GNU Go 编译器：[包（稀有）：gccgo-4.7 (4.7.3-1ubuntu1)](http://packages.ubuntu.com/raring/gccgo-4.7)

在此期间，我使用的是 Ubuntu 13.04 (Raring Ringtail) [Daily Build](http://cdimage.ubuntu.com/daily-live/current/)。

例如，

```
$ uname -a
Linux ubuntu 3.8.0-19-generic #29-Ubuntu SMP Wed Apr 17 18:16:28 UTC 2013 x86_64 x86_64 x86_64 GNU/Linux
$ gccgo --version
gccgo (Ubuntu/Linaro 4.7.3-1ubuntu1) 4.7.3

$ export GOPATH=/home/peter/gopath
$ export LANG=C
$ go get -d github.com/fuzxxl/ppm
$ cd $GOPATH/src/github.com/fuzxxl/ppm
$ go build -compiler gccgo
$ go install -compiler gccgo
$ 
```

# javascript - 无法在 Javascript 中更改上下文？

> ID：16120170
> 
> 赞同：1
> 
> 时间：2013-04-20T12:08:50.283
> 
> 标签：javascript

*我在这里打破我的头。*我有这个简单的代码：

```
function myFunc()
{
    this.a = "aaa";

    return {
        h: function ()
        {
                   alert(this.a);
        }
    }
}

var f = new myFunc();
console.log(f.h.apply(f)) //I'm expecting to see here : "aaa" but it says "undefined" 
```

`f.h`看起来*完全*像这样：

```
 function ()
 {
      alert(this.a);
     } 
```

所以`f`，*我`a`*试图*通过*.`apply`

但它不起作用。

我错过了什么？

*ps 还有其他选择。我知道。但为什么我的**特定**代码不起作用？*

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-20T12:12:12.770

`f`不包含 a，因为您返回一个“覆盖”默认对象的任意对象，否则该对象将包含 a。

如果你用过

```
function myFunc() {
  return {
    a:"aaa",
    h:function() { alert this.a; }
  }
} 
```

那么它会工作！

如果您想使用“私有”和“公共”变量，请像这样

```
function myFunc() {
  var a = "aaa";
  return {
    h:function() { alert a; }
  }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-20T12:13:30.713

如果要使用闭包，请创建`a`为局部变量。这将成为`a`外部世界无法直接访问的私有财产

```
function myFunc(){
    var a = "aaa";

    return {
        h: function ()   {
            alert(a);
        }
    }
}

var f = new myFunc();
console.log(f.h(f)) 
```

演示：[小提琴](http://jsfiddle.net/arunpjohny/44ZKZ/2/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-20T12:19:34.137

当你从函数中返回一个对象时，你得到的是那个对象，而不是由ˋnewˋ 关键字创建的对象。放置ˋaˋ 属性的对象不再退出。

将方法放在创建的对象中，而不是创建不同的对象：

```
function myFunc() {
  this.a = "aaa";

  this.h = function () {
    alert(this.a);
  }
} 
```

现在该对象包含该属性，因此您无需使用 apply 来获取正确的上下文：

```
var f = new myFunc();
console.log(f.h()) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-20T12:27:31.230

首先，跟踪您退回和打印物品的方式。当您应该只使用一个时，您正在尝试同时使用这两种`alert`工作。`console.log`此外，您正在尝试`console.log`返回不返回任何内容的函数的值。对于下面的示例，我选择使用`console.log`并保持函数不返回任何内容。下面，我解决了第一个问题：

```
function myFunc() {
    this.a = "aaa";
    return {h: function () {console.log(this.a);}}
}

var f = new myFunc();
f.h.apply(f); 
```

现在进入真正的问题。`this.a`返回`undefined`因为`this`绑定到不同的两个不同的事物（首先是 的实例`myFunc`，然后`f`是 ）您在代码中使用它的两次。您可以使用`console.log(this)`来验证这一点。

为了解决这个问题，绑定一个变量（我们称之为`self`），`this`以便您以后可以引用它。在 JavaScript 中，内部函数可以访问绑定在外部函数中的变量。（这称为[*闭包*](https://stackoverflow.com/q/111102)。）这允许我们以`self`下列方式使用：

```
function myFunc() {
    var self = this;
    this.a = "aaa";
    return {h: function() {console.log(self.a);}}
}

var f = new myFunc();
// f.h.apply(f); // replaced by next line; see first comment
f.h(); 
```

这会将行打印`aaa`到控制台。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-20T12:13:29.283

你正在失去关闭的范围，试试这个：

```
function myFunc()
{
    this.a = "aaa";
    that = this;
    return {
        h: function ()
        {
                   alert(that.a);
        }
    }
}

var f = new myFunc();
console.log(f.h.apply(f)) 
```

# c# - DbGeography 多边形到 JSON

> ID：16120171
> 
> 赞同：5
> 
> 时间：2013-04-20T12:09:03.190
> 
> 标签：c#, json, polygon

我将 DbGeography 多边形存储在数据库中。我的控制器从数据库中获取多边形，我需要将它们转换为 JSON。

```
 var polygons = db.Areas
    .Where(x => x.Type == type)
    .Select(x => new ViewArea
    {
       Id = x.Id,
       Type = x.Type,
       Rate = x.Rate,
       Polygon = x.Polygon,
    });
    return Json(polygons, JsonRequestBehavior.AllowGet); 
```

我尝试使用 getJSON 从服务器获取多边形，但无法将 DbGeography 转换为 JSON。怎么做，那个转换？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2014-03-20T20:12:37.983

首先，您可能不想要任何旧的 JSON，因为有一个标准[GeoJSON](http://geojson.org)。

您可以在 DbGeography 上使用如下所示的 NewtonSoft JsonConverter 属性：

```
 public class Foo
  {
      [JsonConverter(typeof(DbGeographyGeoJsonConverter))]
      public DbGeography Polygon { get; set; }
  } 
```

您可以将 Foo 的实例转换为 JSON，例如：

```
var foo = new Foo { Polygon = DbGeography.FromText(
                          "Polygon((22.3 77.4, 22.5 77.5, 22.7 77.5, 22.3 77.4))") };
var jsonText = JsonConvert.SerializeObject(foo); 
```

这应该给你类似的东西：

> {“多边形”：{“类型”：“多边形”，“坐标”：[[[22.3,77.4],[22.5,77.5],[22.7,77.5],[22.3,77.4]]]}}

现在，DbGeographyGeoJsonConverter 类有点复杂，我在下面提供的那个并不完整（这里有[一个更完整的版本](http://snipt.org/Rihji1)）。使用它生成的任何 JSON 就足够了。部分复杂性来自于它是从我用来处理地理空间知名二进制和知名文本的其他类中部分复制粘贴而来的。

```
using System;
using System.Collections.Generic;
using System.Data.Entity.Spatial;
using System.IO;
using System.Linq;
using System.Text.RegularExpressions;

using AplPed.Common;

using Newtonsoft.Json;
using Newtonsoft.Json.Linq;

/// <summary>
/// The <see cref="DbGeography"/> GeoJSON converter
/// </summary>
public class DbGeographyGeoJsonConverter : JsonConverter
{
    /// <summary>
    /// Well-known-binary point value.
    /// </summary>
    private const int PointWkb = 1;

    /// <summary>
    /// Well-known-binary line value.
    /// </summary>
    private const int LineStringWkb = 2;

    /// <summary>
    /// Well-known-binary polygon value.
    /// </summary>
    private const int PolygonWkb = 3;

    /// <summary>
    /// Well-known-binary multi-point value.
    /// </summary>
    private const int MultiPointWkb = 4;

    /// <summary>
    /// Well-known-binary multi-line value.
    /// </summary>
    private const int MultiLineStringWkb = 5;

    /// <summary>
    /// Well-known-binary multi-polygon value.
    /// </summary>
    private const int MultiPolygonWkb = 6;

    /// <summary>
    /// Well-known-binary geometry collection value.
    /// </summary>
    private const int GeometryCollectionWkb = 7;

    /// <summary>
    /// Well-known-binary line value.
    /// </summary>
    private static readonly Dictionary<int, string> WkbTypes = 
    new Dictionary<int, string>
    {
        { PointWkb, "Point" },
        { LineStringWkb, "LineString" },
        { PolygonWkb, "Polygon" },
        { MultiPointWkb, "MultiPoint" },
        { MultiLineStringWkb, "MultiLineString" },
        { MultiPolygonWkb, "MultiPolygon" },
        { GeometryCollectionWkb, "GeometryCollection" }
    };

    /// <summary>
    /// The types derived from <see cref="GeoBase"/> accessed by name.
    /// </summary>
    private static readonly Dictionary<string, Type> GeoBases =
    new Dictionary<string, Type>
    {
        { "Point", typeof(Point) },
        { "LineString", typeof(LineString) },
        { "Polygon", typeof(Polygon) },
        { "MultiPoint", typeof(MultiPoint) },
        { "MultiLineString", typeof(MultiLineString) },
        { "MultiPolygon", typeof(MultiPolygon) },
        { "GeometryCollection", typeof(Collection) },
    };

    /// <summary>
    /// Read the GeoJSON type value.
    /// </summary>
    /// <param name="jsonObject">
    /// The JSON object.
    /// </param>
    /// <param name="coordinateSystem">
    /// The coordinate System.
    /// </param>
    /// <returns>
    /// A function that can read the value.
    /// </returns>
    /// <exception cref="ArgumentException">
    /// Unexpected JSON.
    /// </exception>
    /// <remarks>
    /// Leaves the reader positioned where the value should start.
    /// </remarks>
    public static GeoBase ParseJsonObjectToGeoBase(JObject jsonObject, out int? coordinateSystem)
    {
        var type = jsonObject["type"];
        if (type == null)
        {
            throw new ArgumentException(string.Format("Expected a \"type\" property, found [{0}]", string.Join(", ", jsonObject.Properties().Select(p => p.Name))));
        }

        if (type.Type != JTokenType.String)
        {
            throw new ArgumentException(string.Format("Expected a string token for the type of the GeoJSON type, got {0}", type.Type), "jsonObject");
        }

        Type geoType;
        if (!GeoBases.TryGetValue(type.Value<string>(), out geoType))
        {
            throw new ArgumentException(
            string.Format(
            "Got unsupported GeoJSON object type {0}. Expected one of [{1}]",
            type.Value<string>(),
            string.Join(", ", GeoBases.Keys)),
            "jsonObject");
        }

        var geoObject = geoType == typeof(Collection) ? jsonObject["geometries"] : jsonObject["coordinates"];
        if (geoObject == null)
        {
            throw new ArgumentException(
            string.Format(
            "Expected a field named \"{0}\", found [{1}]",
            geoType == typeof(Collection) ? "geometries" : "coordinates",
            string.Join(", ", jsonObject.Properties().Select(p => p.Name))),
            "jsonObject");
        }

        var crs = jsonObject["crs"];
        coordinateSystem = crs != null ? ParseCrs(crs.Value<JObject>()) : null;

        var geo = (GeoBase)Activator.CreateInstance(geoType);
        geo.ParseJson(geoObject.Value<JArray>());
        return geo;
    }

    /// <inheritdoc/>
    public override void WriteJson(JsonWriter writer, object value, JsonSerializer serializer)
    {
        BinaryReader lebr;
        BinaryReader bebr;
        var geographyValue = value as DbGeography;
        int coordinateSystemId;
        if (geographyValue != null)
        {
            var br = new BinaryReader(new MemoryStream(geographyValue.AsBinary()));
            lebr = BitConverter.IsLittleEndian ? br : new ReverseEndianBinaryReader(br.BaseStream);
            bebr = BitConverter.IsLittleEndian ? new ReverseEndianBinaryReader(br.BaseStream) : br;
            coordinateSystemId = geographyValue.CoordinateSystemId;
        }
        else
        {
            var geometryValue = value as DbGeometry;
            if (geometryValue != null)
            {
                var br = new BinaryReader(new MemoryStream(geometryValue.AsBinary()));
                lebr = BitConverter.IsLittleEndian ? br : new ReverseEndianBinaryReader(br.BaseStream);
                bebr = BitConverter.IsLittleEndian ? new ReverseEndianBinaryReader(br.BaseStream) : br;
                coordinateSystemId = geometryValue.CoordinateSystemId;
            }
            else
            {
                throw new ArgumentException(
                string.Format("Expecting DbGeography or DbGeometry, got {0}", value.GetType().CSharpName()), "value");
            }
        }

        var jsonObject = WriteObject(lebr, bebr);
        jsonObject.Add(
        "crs",
        new JObject
        {
            new JProperty("type", "name"),
            new JProperty(
            "properties",
            new JObject { new JProperty("name", string.Format("EPSG:{0}", coordinateSystemId)) })
        });
        writer.WriteRawValue(jsonObject.ToString(Formatting.None));
    }

    /// <inheritdoc/>
    public override object ReadJson(JsonReader reader, Type objectType, object existingValue, JsonSerializer serializer)
    {
        // Load JObject from stream
        JObject jsonObject = JObject.Load(reader);

        // Create target object based on JObject
        object target = CreateDbGeo(jsonObject, objectType);

        // Populate the object properties
        serializer.Populate(jsonObject.CreateReader(), target);

        return target;
    }

    /// <inheritdoc/>
    public override bool CanConvert(Type objectType)
    {
        return objectType == typeof(DbGeography) || objectType == typeof(DbGeometry);
    }

    /// <summary>
    /// Parse the coordinate system object and return it's value.
    /// </summary>
    /// <param name="jsonObject">
    /// The JSON object.
    /// </param>
    /// <returns>
    /// The coordinate system value; null if couldn't parse it (only a couple EPSG-style values).
    /// </returns>
    private static int? ParseCrs(JObject jsonObject)
    {
        var properties = jsonObject["properties"];
        if (properties != null && properties.Type == JTokenType.Object)
        {
            var p = properties.Value<JObject>();
            var name = p["name"];
            if (name != null)
            {
                var s = name.Value<string>();
                if (!string.IsNullOrWhiteSpace(s))
                {
                    var m = Regex.Match(
                    s,
                    @"^\s*(urn\s*:\s*ogc\s*:\s*def\s*:crs\s*:EPSG\s*:\s*[\d.]*\s*:|EPSG\s*:)\s*(?<value>\d+)\s*$",
                    RegexOptions.ExplicitCapture | RegexOptions.IgnoreCase);
                    if (m.Success)
                    {
                        return int.Parse(m.Groups["value"].Value);
                    }
                }
            }
        }

        return null;
    }

    /// <summary>
    /// Get well known binary from a <see cref="JsonReader"/>.
    /// </summary>
    /// <param name="jsonObject">
    /// The JSON object.
    /// </param>
    /// <param name="defaultCoordinateSystemId">
    /// The default coordinate system id.
    /// </param>
    /// <returns>
    /// A tuple of the well-known-binary and the coordinate system identifier.
    /// </returns>
    /// <exception cref="ArgumentException">
    /// Unexpected JSON.
    /// </exception>
    private static Tuple<byte[], int> GetWellKnownBinary(JObject jsonObject, int defaultCoordinateSystemId)
    {
        var ob = new MemoryStream();

        int? coordinateSystemId;
        var geoBase = ParseJsonObjectToGeoBase(jsonObject, out coordinateSystemId);
        geoBase.WellKnownBinary(ob);

        return new Tuple<byte[], int>(ob.ToArray(), coordinateSystemId.HasValue ? coordinateSystemId.Value : defaultCoordinateSystemId);
    }

    /// <summary>
    /// Write a well-known binary object to JSON.
    /// </summary>
    /// <param name="lebr">
    /// The little-endian binary reader.
    /// </param>
    /// <param name="bebr">
    /// The big-endian binary reader.
    /// </param>
    /// <exception cref="ArgumentException">
    /// Unexpected well-known binary.
    /// </exception>
    /// <returns>
    /// The <see cref="JObject"/> for the given binary data.
    /// </returns>
    private static JObject WriteObject(BinaryReader lebr, BinaryReader bebr)
    {
        var jsonObject = new JObject();
        var br = lebr.ReadByte() == 0 ? bebr : lebr;
        int gtype = br.ReadInt32();
        string objTypeName;
        if (!WkbTypes.TryGetValue(gtype, out objTypeName))
        {
            throw new ArgumentException(
            string.Format(
            "Unsupported type {0}. Supported types: {1}",
            gtype,
            string.Join(", ", WkbTypes.Select(kv => string.Format("({0}, {1}", kv.Key, kv.Value)))));
        }

        jsonObject.Add("type", objTypeName);

        if (gtype == GeometryCollectionWkb)
        {
            var array = new JArray();
            int count = br.ReadInt32();
            for (int i = 0; i < count; ++i)
            {
                array.Add(WriteObject(lebr, bebr));
            }

            jsonObject.Add("geometries", array);
        }
        else
        {
            var array = new JArray();
            switch (gtype)
            {
            case PointWkb:
                array.Add(br.ReadDouble());
                array.Add(br.ReadDouble());
                break;
            case LineStringWkb:
                foreach (var a in WriteLine(br))
                {
                    array.Add(a);
                }

                break;
            case PolygonWkb:
                foreach (var a in WritePolygon(br))
                {
                    array.Add(a);
                }

                break;
            case MultiPointWkb:
                int pointCount = br.ReadInt32();
                for (int i = 0; i < pointCount; ++i)
                {
                    br = lebr.ReadByte() == 0 ? bebr : lebr;
                    gtype = br.ReadInt32();
                    if (gtype != PointWkb)
                    {
                        throw new ArgumentException(
                        string.Format("Expected a type of 1, got {0}", gtype),
                        "lebr");
                    }

                    array.Add(new JArray { br.ReadDouble(), br.ReadDouble() });
                }

                break;
            case MultiLineStringWkb:
                int lineCount = br.ReadInt32();
                for (int i = 0; i < lineCount; ++i)
                {
                    br = lebr.ReadByte() == 0 ? bebr : lebr;
                    gtype = br.ReadInt32();
                    if (gtype != LineStringWkb)
                    {
                        throw new ArgumentException(
                        string.Format("Expected a type of 2, got {0}", gtype),
                        "lebr");
                    }

                    var lineArray = new JArray();
                    foreach (var a in WriteLine(br))
                    {
                        lineArray.Add(a);
                    }

                    array.Add(lineArray);
                }

                break;
            case MultiPolygonWkb:
                int polygonCount = br.ReadInt32();
                for (int i = 0; i < polygonCount; ++i)
                {
                    br = lebr.ReadByte() == 0 ? bebr : lebr;
                    gtype = br.ReadInt32();
                    if (gtype != PolygonWkb)
                    {
                        throw new ArgumentException(
                        string.Format("Expected a type of 3, got {0}", gtype),
                        "lebr");
                    }

                    var polygonArray = new JArray();
                    foreach (var a in WritePolygon(br))
                    {
                        polygonArray.Add(a);
                    }

                    array.Add(polygonArray);
                }

                break;
            default:
                throw new ArgumentException(string.Format("Unsupported geo-type {0}", gtype), "lebr");
            }

            jsonObject.Add("coordinates", array);
        }

        return jsonObject;
    }

    /// <summary>
    /// Write a JSON polygon from well-known binary.
    /// </summary>
    /// <param name="br">
    /// Read from this.
    /// </param>
    /// <returns>
    /// The <see cref="JArray"/> enumerable for the polygon.
    /// </returns>
    private static IEnumerable<JArray> WritePolygon(BinaryReader br)
    {
        var ret = new List<JArray>();
        int ringCount = br.ReadInt32();
        for (int ri = 0; ri < ringCount; ++ri)
        {
            var array = new JArray();
            foreach (var a in WriteLine(br))
            {
                array.Add(a);
            }

            ret.Add(array);
        }

        return ret;
    }

    /// <summary>
    /// Write a JSON line from well-known binary.
    /// </summary>
    /// <param name="br">
    /// Read from this.
    /// </param>
    /// <returns>
    /// The <see cref="JArray"/> enumerable for the line.
    /// </returns>
    private static IEnumerable<JArray> WriteLine(BinaryReader br)
    {
        var ret = new List<JArray>();
        int count = br.ReadInt32() * 2;
        for (int i = 0; i < count; i += 2)
        {
            var array = new JArray { br.ReadDouble(), br.ReadDouble() };
            ret.Add(array);
        }

        return ret;
    }

    /// <summary>
    /// Create a <see cref="DbGeography"/> or <see cref="DbGeometry"/> from <paramref name="jsonObject"/>.
    /// </summary>
    /// <param name="jsonObject">
    /// The JSON object.
    /// </param>
    /// <param name="objectType">
    /// The object type.
    /// </param>
    /// <returns>
    /// The <see cref="DbGeography"/> or <see cref="DbGeometry"/> 
    /// </returns>
    /// <exception cref="ArgumentException">
    /// <paramref name="objectType"/> is not a <see cref="DbGeography"/> or <see cref="DbGeometry"/>.
    /// </exception>
    private static object CreateDbGeo(JObject jsonObject, Type objectType)
    {
        Func<Tuple<byte[], int>, object> returnValue;
        int defaultCoordinateSystemId;
        if (typeof(DbGeography).IsAssignableFrom(objectType))
        {
            returnValue = x => (object)DbGeography.FromBinary(x.Item1, x.Item2);
            defaultCoordinateSystemId = DbGeography.DefaultCoordinateSystemId;
        }
        else if (typeof(DbGeometry).IsAssignableFrom(objectType))
        {
            returnValue = x => (object)DbGeometry.FromBinary(x.Item1, x.Item2);
            defaultCoordinateSystemId = DbGeometry.DefaultCoordinateSystemId;
        }
        else
        {
            throw new ArgumentException(string.Format("Expected a DbGeography or DbGeometry objectType. Got {0}", objectType.CSharpName()), "objectType");
        }

        return jsonObject.Type == JTokenType.Null || jsonObject.Type == JTokenType.None ? null : returnValue(GetWellKnownBinary(jsonObject, defaultCoordinateSystemId));
    }

    /// <summary>
    /// A <see cref="BinaryReader"/> that expects byte-reversed numeric values.
    /// </summary>
    public class ReverseEndianBinaryReader : BinaryReader
    {
        /// <summary>
        /// Initializes a new instance of the <see cref="ReverseEndianBinaryReader"/> class.
        /// </summary>
        /// <param name="stream">
        /// The stream.
        /// </param>
        public ReverseEndianBinaryReader(Stream stream)
        : base(stream)
        {
        }

        /// <inheritdoc/>
        public override short ReadInt16()
        {
            return BitConverter.ToInt16(this.ReadBytes(2).Reverse().ToArray(), 0);
        }

        /// <inheritdoc/>
        public override int ReadInt32()
        {
            return BitConverter.ToInt32(this.ReadBytes(4).Reverse().ToArray(), 0);
        }

        /// <inheritdoc/>
        public override long ReadInt64()
        {
            return BitConverter.ToInt64(this.ReadBytes(8).Reverse().ToArray(), 0);
        }

        /// <inheritdoc/>
        public override ushort ReadUInt16()
        {
            return BitConverter.ToUInt16(this.ReadBytes(2).Reverse().ToArray(), 0);
        }

        /// <inheritdoc/>
        public override uint ReadUInt32()
        {
            return BitConverter.ToUInt32(this.ReadBytes(4).Reverse().ToArray(), 0);
        }

        /// <inheritdoc/>
        public override ulong ReadUInt64()
        {
            return BitConverter.ToUInt64(this.ReadBytes(8).Reverse().ToArray(), 0);
        }

        /// <inheritdoc/>
        public override float ReadSingle()
        {
            return BitConverter.ToSingle(this.ReadBytes(4).Reverse().ToArray(), 0);
        }

        /// <inheritdoc/>
        public override double ReadDouble()
        {
            return BitConverter.ToDouble(this.ReadBytes(8).Reverse().ToArray(), 0);
        }
    }

    /// <summary>
    /// Base class for the types that know how to parse JSON and write well-known binary.
    /// </summary>
    public abstract class GeoBase
    {
        /// <summary>
        /// The point well-known bytes descriptor.
        /// </summary>
        protected static readonly byte[] PointWkbs = BitConverter.GetBytes(PointWkb);

        /// <summary>
        /// The line-string well-known bytes descriptor.
        /// </summary>
        protected static readonly byte[] LineStringWkbs = BitConverter.GetBytes(LineStringWkb);

        /// <summary>
        /// The polygon well-known bytes descriptor.
        /// </summary>
        protected static readonly byte[] PolygonWkbs = BitConverter.GetBytes(PolygonWkb);

        /// <summary>
        /// The multi-point well-known bytes descriptor.
        /// </summary>
        protected static readonly byte[] MultiPointWkbs = BitConverter.GetBytes(MultiPointWkb);

        /// <summary>
        /// The multi-line-string well-known bytes descriptor.
        /// </summary>
        protected static readonly byte[] MultiLineStringWkbs = BitConverter.GetBytes(MultiLineStringWkb);

        /// <summary>
        /// The multi-polygon well-known bytes descriptor.
        /// </summary>
        protected static readonly byte[] MultiPolygonWkbs = BitConverter.GetBytes(MultiPolygonWkb);

        /// <summary>
        /// The collection well-known bytes descriptor.
        /// </summary>
        protected static readonly byte[] GeometryCollectionWkbs = BitConverter.GetBytes(GeometryCollectionWkb);

        /// <summary>
        /// Helper function to parse a <see cref="List{T}"/> of <see cref="Position"/>.
        /// </summary>
        /// <param name="array">
        /// Get JSON from this.
        /// </param>
        /// <returns>
        /// The parsed JSON.
        /// </returns>
        /// <exception cref="ArgumentException">
        /// Unexpected JSON.
        /// </exception>
        public static List<Position> ParseListPosition(JArray array)
        {
            if (array.Cast<JArray>().Any(l => l.Count < 2))
            {
                throw new ArgumentException(
                string.Format(
                "Expected all points to have greater than two points, got {0} with zero and {1} with one",
                array.Cast<JArray>().Count(l => l.Count == 0),
                array.Cast<JArray>().Count(l => l.Count == 1)),
                "array");
            }

            return array.Select(l => new Position { P1 = (double)l[0], P2 = (double)l[1] }).ToList();
        }

        /// <summary>
        /// Helper function to parse a <see cref="List{T}"/> of <see cref="List{T}"/> of <see cref="Position"/>.
        /// </summary>
        /// <param name="array">
        /// Get JSON from this.
        /// </param>
        /// <returns>
        /// The parsed JSON.
        /// </returns>
        /// <exception cref="ArgumentException">
        /// Unexpected JSON.
        /// </exception>
        public static List<List<Position>> ParseListListPosition(JArray array)
        {
            if (array.Cast<JArray>().Any(r => r.Cast<JArray>().Any(l => l.Count < 2)))
            {
                throw new ArgumentException(
                string.Format(
                "Expected all points to have greater than two points, got {0} with zero and {1} with one",
                array.Cast<JArray>().Sum(r => r.Cast<JArray>().Count(l => l.Count == 0)),
                array.Cast<JArray>().Sum(r => r.Cast<JArray>().Count(l => l.Count == 1))),
                "array");
            }

            return array.Select(r => r.Select(l => new Position { P1 = (double)l[0], P2 = (double)l[1] }).ToList()).ToList();
        }

        /// <summary>
        /// Helper function to parse a <see cref="List{T}"/> of <see cref="List{T}"/> of <see cref="List{T}"/> of <see cref="Position"/>.
        /// </summary>
        /// <param name="array">
        /// Get JSON from this.
        /// </param>
        /// <returns>
        /// The parsed JSON.
        /// </returns>
        /// <exception cref="ArgumentException">
        /// Unexpected JSON.
        /// </exception>
        public static List<List<List<Position>>> ParseListListListPosition(JArray array)
        {
            if (array.Cast<JArray>().Any(p => p.Cast<JArray>().Any(r => r.Cast<JArray>().Any(l => l.Count < 2))))
            {
                throw new ArgumentException(
                string.Format(
                "Expected all points to have greater than two points, got {0} with zero and {1} with one",
                array.Cast<JArray>().Sum(p => p.Cast<JArray>().Sum(r => r.Cast<JArray>().Count(l => l.Count == 0))),
                array.Cast<JArray>().Sum(p => p.Cast<JArray>().Sum(r => r.Cast<JArray>().Count(l => l.Count == 1)))),
                "array");
            }

            return array.Select(p => p.Select(r => r.Select(l => new Position { P1 = (double)l[0], P2 = (double)l[1] }).ToList()).ToList()).ToList();
        }

        /// <summary>
        /// Write the contents to <paramref name="sout"/> in well-known 
        /// binary format.
        /// </summary>
        /// <param name="sout">
        /// The stream to write the position to.
        /// </param>
        public abstract void WellKnownBinary(Stream sout);

        /// <summary>
        /// Parse JSON into the <see cref="GeoBase"/>-derived type.
        /// </summary>
        /// <param name="array">
        /// Get JSON from this.
        /// </param>
        public abstract void ParseJson(JArray array);
    }

    /// <summary>
    /// The position.
    /// </summary>
    public class Position : GeoBase
    {
        /// <summary>
        /// Gets or sets the first value of the position.
        /// </summary>
        public double P1 { get; set; }

        /// <summary>
        /// Gets or sets the second value of the position.
        /// </summary>
        public double P2 { get; set; }

        /// <inheritdoc/>
        public override void WellKnownBinary(Stream sout)
        {
            sout.Write(BitConverter.GetBytes(this.P1), 0, 8);
            sout.Write(BitConverter.GetBytes(this.P2), 0, 8);
        }

        /// <inheritdoc/>
        public override void ParseJson(JArray array)
        {
            if (array.Count < 2)
            {
                throw new ArgumentException(string.Format("Expected at least 2 points for a position, got {0}", array.Count), "array");
            }

            this.P1 = (double)array[0];
            this.P2 = (double)array[1];
        }
    }

    // ReSharper disable RedundantNameQualifier

    /// <summary>
    /// The point.
    /// </summary>
    public class Point : GeoBase
    {
        /// <summary>
        /// Gets or sets the position.
        /// </summary>
        public Position Position { get; set; }

        /// <inheritdoc/>
        public override void WellKnownBinary(Stream sout)
        {
            sout.WriteByte(BitConverter.IsLittleEndian ? (byte)1 : (byte)0);
            sout.Write(GeoBase.PointWkbs, 0, 4);
            this.Position.WellKnownBinary(sout);
        }

        /// <inheritdoc/>
        public override void ParseJson(JArray array)
        {
            this.Position = new Position();
            this.Position.ParseJson(array);
        }
    }

    /// <summary>
    /// The line string.
    /// </summary>
    public class LineString : GeoBase
    {
        /// <summary>
        /// Gets or sets the points.
        /// </summary>
        public List<Point> Points { get; set; }

        /// <inheritdoc/>
        public override void WellKnownBinary(Stream sout)
        {
            sout.WriteByte(BitConverter.IsLittleEndian ? (byte)1 : (byte)0);
            sout.Write(GeoBase.LineStringWkbs, 0, 4);
            sout.Write(BitConverter.GetBytes(this.Points.Count), 0, 4);
            foreach (var point in this.Points)
            {
                point.Position.WellKnownBinary(sout);
            }
        }

        /// <inheritdoc/>
        public override void ParseJson(JArray array)
        {
            if (array.Cast<JArray>().Any(l => l.Count < 2))
            {
                throw new ArgumentException(
                string.Format(
                "Expected all points to have greater than two points, got {0} with zero and {1} with one",
                array.Cast<JArray>().Count(l => l.Count == 0),
                array.Cast<JArray>().Count(l => l.Count == 1)),
                "array");
            }

            this.Points = array.Cast<JArray>().Select(l => new Point { Position = new Position { P1 = (double)l[0], P2 = (double)l[1] } }).ToList();
        }
    }

    /// <summary>
    /// The polygon.
    /// </summary>
    public class Polygon : GeoBase
    {
        /// <summary>
        /// Gets or sets the rings.
        /// </summary>
        public List<List<Position>> Rings { get; set; }

        /// <inheritdoc/>
        public override void WellKnownBinary(Stream sout)
        {
            sout.WriteByte(BitConverter.IsLittleEndian ? (byte)1 : (byte)0);
            sout.Write(GeoBase.PolygonWkbs, 0, 4);
            sout.Write(BitConverter.GetBytes(this.Rings.Count), 0, 4);
            foreach (var ring in this.Rings)
            {
                sout.Write(BitConverter.GetBytes(ring.Count), 0, 4);
                foreach (var position in ring)
                {
                    position.WellKnownBinary(sout);
                }
            }
        }

        /// <inheritdoc/>
        public override void ParseJson(JArray array)
        {
            this.Rings = GeoBase.ParseListListPosition(array);
        }
    }

    /// <summary>
    /// The multi-point.
    /// </summary>
    public class MultiPoint : GeoBase
    {
        /// <summary>
        /// Gets or sets the points.
        /// </summary>
        public List<Position> Points { get; set; }

        /// <inheritdoc/>
        public override void WellKnownBinary(Stream sout)
        {
            byte order = BitConverter.IsLittleEndian ? (byte)1 : (byte)0;
            sout.WriteByte(order);
            sout.Write(GeoBase.MultiPointWkbs, 0, 4);
            sout.Write(BitConverter.GetBytes(this.Points.Count), 0, 4);
            foreach (var point in this.Points)
            {
                sout.WriteByte(order);
                sout.Write(GeoBase.PointWkbs, 0, 4); // Point
                point.WellKnownBinary(sout);
            }
        }

        /// <inheritdoc/>
        public override void ParseJson(JArray array)
        {
            this.Points = GeoBase.ParseListPosition(array);
        }
    }

    /// <summary>
    /// The multi-line.
    /// </summary>
    public class MultiLineString : GeoBase
    {
        /// <summary>
        /// Gets or sets the line strings.
        /// </summary>
        public List<List<Position>> LineStrings { get; set; }

        /// <inheritdoc/>
        public override void WellKnownBinary(Stream sout)
        {
            byte order = BitConverter.IsLittleEndian ? (byte)1 : (byte)0;
            sout.WriteByte(order);
            // ReSharper disable once RedundantNameQualifier
            sout.Write(GeoBase.MultiLineStringWkbs, 0, 4);
            sout.Write(BitConverter.GetBytes(this.LineStrings.Count), 0, 4);
            foreach (var lineString in this.LineStrings)
            {
                sout.WriteByte(order);
                sout.Write(GeoBase.LineStringWkbs, 0, 4);
                sout.Write(BitConverter.GetBytes(lineString.Count), 0, 4);
                foreach (var position in lineString)
                {
                    position.WellKnownBinary(sout);
                }
            }
        }

        /// <inheritdoc/>
        public override void ParseJson(JArray array)
        {
            this.LineStrings = GeoBase.ParseListListPosition(array);
        }
    }

    /// <summary>
    /// The multi-polygon.
    /// </summary>
    public class MultiPolygon : GeoBase
    {
        /// <summary>
        /// Gets or sets the polygons.
        /// </summary>
        public List<List<List<Position>>> Polygons { get; set; }

        /// <inheritdoc/>
        public override void WellKnownBinary(Stream sout)
        {
            byte order = BitConverter.IsLittleEndian ? (byte)1 : (byte)0;
            sout.WriteByte(order);
            sout.Write(GeoBase.MultiPolygonWkbs, 0, 4);
            sout.Write(BitConverter.GetBytes(this.Polygons.Count), 0, 4);
            foreach (var polygon in this.Polygons)
            {
                sout.WriteByte(order);
                sout.Write(GeoBase.PolygonWkbs, 0, 4);
                sout.Write(BitConverter.GetBytes(polygon.Count), 0, 4);
                foreach (var ring in polygon)
                {
                    sout.Write(BitConverter.GetBytes(ring.Count), 0, 4);
                    foreach (var position in ring)
                    {
                        position.WellKnownBinary(sout);
                    }
                }
            }
        }

        /// <inheritdoc/>
        public override void ParseJson(JArray array)
        {
            this.Polygons = GeoBase.ParseListListListPosition(array);
        }
    }

    /// <summary>
    /// The <see cref="GeoBase"/> collection.
    /// </summary>
    public class Collection : GeoBase
    {
        /// <summary>
        /// Gets or sets the entries.
        /// </summary>
        public List<GeoBase> Entries { get; set; }

        /// <inheritdoc/>
        public override void WellKnownBinary(Stream o)
        {
            o.WriteByte(BitConverter.IsLittleEndian ? (byte)1 : (byte)0);
            o.Write(GeoBase.GeometryCollectionWkbs, 0, 4);
            o.Write(BitConverter.GetBytes(this.Entries.Count), 0, 4);
            foreach (var entry in this.Entries)
            {
                entry.WellKnownBinary(o);
            }
        }

        /// <inheritdoc/>
        public override void ParseJson(JArray array)
        {
            this.Entries = new List<GeoBase>();
            foreach (var elem in array)
            {
                if (elem.Type != JTokenType.Object)
                {
                    throw new ArgumentException(
                    string.Format("Expected object elements of the collection array, got {0}", elem.Type),
                    "array");
                }

                int? dummyCoordinateSystem;
                this.Entries.Add(DbGeographyGeoJsonConverter.ParseJsonObjectToGeoBase((JObject)elem, out dummyCoordinateSystem));
            }
        }
    }

    // ReSharper restore RedundantNameQualifier
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-03-11T22:22:34.560

我刚刚实现了@mheyman 所指的完整版本。@DiomedesDomínguez 已经在评论中发布了一个新链接，因为原来的链接已经死了，但我也会在这里添加它。

[https://raw.githubusercontent.com/MannusEtten/GeoJson/7fe1ae97aea43157c6eec0afbcde6cce266b0208/GeoJsonLibrary/DbGeographyGeoJsonConverter.cs](https://raw.githubusercontent.com/MannusEtten/GeoJson/7fe1ae97aea43157c6eec0afbcde6cce266b0208/GeoJsonLibrary/DbGeographyGeoJsonConverter.cs)

如果你`Newtonsoft.Json`已经安装了，你需要做两件事来让它工作。首先是下载nuget`Microsoft.SqlServer.Types`

[https://www.nuget.org/packages/Microsoft.SqlServer.Types/](https://www.nuget.org/packages/Microsoft.SqlServer.Types/)

> 要将使用空间数据类型的应用程序部署到未安装“SQL Server 的系统 CLR 类型”的计算机，您还需要部署本机程序集 SqlServerSpatial140.dll。此程序集的 x86（32 位）和 x64（64 位）版本都已添加到您的项目中的 SqlServerTypes\x86 和 SqlServerTypes\x64 子目录下。如果未安装 C++ 运行时，还包括本机程序集 msvcr120.dll。

如果您正在运行 Web 应用程序，请将其添加到`Global.asax`->`Application_Start()`并添加以下行：

```
SqlServerTypes.Utilities.LoadNativeAssemblies(Server.MapPath("~/bin"));; 
```

如果您有桌面应用程序，请在使用任何空间数据类型之前使用此行：

```
SqlServerTypes.Utilities.LoadNativeAssemblies(AppDomain.CurrentDomain.BaseDirectory); 
```

现在除了调用`CSharpName()`for的方法外，一切都解决了`Type`。在示例中是这样使用的：`value.GetType().CSharpName()`. 即使仅用于异常处理，我仍然喜欢使用完整的示例。

搜索方法我发现了以下线程：

[https://stackoverflow.com/a/17376472/3850405](https://stackoverflow.com/a/17376472/3850405)

```
public static string CSharpName(this Type type)
{
    var sb = new StringBuilder();
    var name = type.Name;
    if (!type.IsGenericType) return name;
    sb.Append(name.Substring(0, name.IndexOf('`')));
    sb.Append("<");
    sb.Append(string.Join(", ", type.GetGenericArguments()
                                    .Select(t => t.CSharpName())));
    sb.Append(">");
    return sb.ToString();
} 
```

当我添加这个时，我可以使用该应用程序。

您还可以查看以下项目以获取更多示例：

[https://github.com/MannusEtten/GeoJson/tree/master/GeoJsonLibrary](https://github.com/MannusEtten/GeoJson/tree/master/GeoJsonLibrary)

我也最终需要反过来，可以这样做：

```
DbGeography dbGeography = JsonConvert.DeserializeObject<DbGeography>(geoJson, new DbGeographyGeoJsonConverter()); 
```

# c++ - 如何使用 Windows 套接字模拟我用 C++ 编写的客户端服务器应用程序？

> ID：16120178
> 
> 赞同：0
> 
> 时间：2013-04-20T12:09:40.277
> 
> 标签：c++, network-programming, client-server, winsockets

我最近被要求编写一个客户端服务器应用程序，所以我使用 c++ 和 windows 套接字来完成这个工作，我在 LAN 上的两台电脑上进行了尝试，它运行良好。我的教授希望看到这个工作真正有效，但我认为可能会有一种模拟该应用程序并显示它无需连接两台电脑等即可工作的方法......我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T12:15:13.200

您不必模拟任何东西，只需在一台机器上运行它并使用 127.0.0.1（即 localhost 环回的地址）作为 IP 地址。我相信您应该有某种方法可以在客户端上指定服务器 IP 地址。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-20T12:19:36.137

您可以像连接到远程主机一样连接到“本地地址”，只需使用 127.0.0.1 作为 IP 地址。

此外，请记住为您的服务器和客户端使用不同的端口。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T12:34:16.147

不过，只需在一台机器上运行它们。

您所需要的只是一个为 IP up'n'running 配置的网络接口。

不需要任何物理网络电缆。

如果也没有可用的物理网络适配器，则可能会使用环回设备。它可以服务于`127.0.0.0/255.0.0.0`子网的所有地址。默认情况下，它是为地址设置的`127.0.0.1`。环回设备带有 TCP/IP 堆栈。

# iphone - 为 iOS 开发时要提交哪些文件

> ID：16120180
> 
> 赞同：0
> 
> 时间：2013-04-20T12:09:44.210
> 
> 标签：iphone, ios, git, development-environment

首先很抱歉，如果我的问题没有太大意义，但这将是我第一次正式使用 git 的第一个项目，我想知道有经验的人是如何做到的。

就在 iOS 中开发新应用程序时通常提交的文件而言，您的工作流程是什么。我的问题的原因是因为通常当您在 Xcode 中创建一个新项目时，它会创建一个文件夹结构，例如...

AppName - AppName > AppDelegate.h > AppDelegate.m > main.m 等... - AppName.xcodeproj

1 - 您是在主文件夹还是在第二个文件夹中创建您的 git 存储库？2 - 你提交 .xcodeproj 文件吗？3 - 你提交 Xcode 创建的所有文件和文件夹还是只提交你创建和修改的类？

正如我所说，我的问题可能没有太大意义，但我想听听你是什么以及如何开始提交一个新项目，在 iOS 中开发时你的 git 工作流程是什么。

我想我的部分困惑和恐惧是，如果我不提交必要的文件，然后我想恢复我所做的一些更改并且我想回到某个点，我将无法做到，因为我没有'不提交所有需要的文件。

我将在终端中执行此操作。

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T12:20:59.580

创建项目后，我立即复制我的默认`.gitignore`文件（您可以查看下面的 Gist）。这样我就不需要太关心 repo 中的内容，只需提交所有未被忽略的内容（包括 xcodeproj 文件夹 - 但不包括子目录 xcuserdata 例如）。

[https://gist.github.com/anonymous/5425805](https://gist.github.com/anonymous/5425805)

如果您提交不应该存在的文件，请使用`git rm --cached`并提交更改。`--cached`仅从 Git 中删除您的文件，但将您的本地版本保留在工作树中。

# algorithm - 着色特定类型的平面图

> ID：16120187
> 
> 赞同：2
> 
> 时间：2013-04-20T12:10:46.740
> 
> 标签：algorithm, planar-graph

我有一个特定类型的平面图，我发现搜索一种可以[合法地](http://en.wikipedia.org/wiki/Graph_coloring)为其顶点着色的算法很有趣。关于这种类型的图表，它非常简单和酷：

> 考虑任何具有**n>2**个顶点和**k**个叶子的树**T。**让我们将**G(T)**表示为由**T**构造的图，该图通过将其叶连接到**k** -cycle 以使**G(T)**是平面的方式。

 ******我想出的问题是用**3种颜色为****G(T)**着色。显然，作为平面图的**G(T)是****4**可着色的，但我认为（没有证据）由于其简单性，它几乎总是**3可着色的。**几乎总是意味着只有当**T**是一颗[星星](http://en.wikipedia.org/wiki/Star_%28graph_theory%29)并且只有奇数个叶子时，**G(T)**才是**4**可着色的。

 ******我正在寻找一些算法，或者也许可以证明我的假设可以很容易地转化为算法。我将非常感谢任何帮助和提示。

如果我不够清楚，我会举一个例子：

令 T 为一棵树，其边 E(T) = { {1,2}, {2,3}, {2,4}, {4,5} } 然后 E(G(T)) =集合：E(T) 和 { {1,5}, {5,3}, {3,1} }，因为我们将叶子 1,5,3 连接成一个循环。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T22:18:27.040

```
local Edges_of_Tree = {{1,2}, {2,3}, {2,4}, {4,5}}
local Cycle_of_Leaves = {1,5,3}

local color1 = 'Red'
local color2 = 'Green'
local color3 = 'Blue'

local vert = {}     
local vert_arr = {}  

local function add_edge(v1, v2)
   assert(v1 ~= v2)
   if not vert[v1] then
      vert[v1] = {deg = 0, adj = {}}
      table.insert(vert_arr, v1)
   end
   vert[v1].deg = vert[v1].deg + 1
   assert(not vert[v1].adj[v2], 'multiple edges between '..v1..' and '..v2)
   vert[v1].adj[v2] = true
end

for _, edge in ipairs(Edges_of_Tree) do
   local v1, v2 = unpack(edge)
   add_edge(v1, v2)
   add_edge(v2, v1)
end

table.sort(vert_arr)

local leaf_ctr = 0
local root
for v, vv in pairs(vert) do
   if vv.deg == 1 then
      leaf_ctr = leaf_ctr + 1
   else
      root = v
   end
end
assert(#vert_arr > leaf_ctr + 1, 'tree is a star')
assert(leaf_ctr == #Cycle_of_Leaves, 'invalid Cycle_of_Leaves')
for _, v in ipairs(Cycle_of_Leaves) do
   assert(vert[v] and vert[v].deg == 1 and vert[v].color == nil, 
      'invalid Cycle_of_Leaves')
   vert[v].color = false
end

local function recursive_paint_inodes(v, color, prev_v)
   assert(vert[v].color == nil, 'a cycle in tree found')
   vert[v].color = color
   local next_color = (color1..color2):gsub(color, '')
   for next_v in pairs(vert[v].adj) do
      if next_v ~= prev_v and vert[next_v].deg > 1 then
         recursive_paint_inodes(next_v, next_color, v)
      end
   end
end
recursive_paint_inodes(root, color1)

local front
for i = 1, leaf_ctr do
   local vv = vert[Cycle_of_Leaves[i]]
   vv.next = Cycle_of_Leaves[i % leaf_ctr + 1]
   vv.prev = Cycle_of_Leaves[(i - 2) % leaf_ctr + 1]
   local parent = next(vv.adj)
   if parent ~= next(vert[vv.prev].adj) then
      assert(not vert[parent].conn_to_leaf, 'graph is non-planar')
      vert[parent].conn_to_leaf = true
      front = Cycle_of_Leaves[i]
   end
end

vert[next(vert[vert[front].prev].adj)].color = color3
vert[front].color = color3

local tricolor = color1..color2..color3
local leaf = front
for i = 1, leaf_ctr - 1 do
   local prev_color = vert[leaf].color
   leaf = vert[leaf].next
   local parent_color = vert[next(vert[leaf].adj)].color
   local enabled_colors = tricolor:gsub(prev_color, ''):gsub(parent_color, '')
   vert[leaf].color = enabled_colors:match(color1)
      or enabled_colors:match(color2) or color3
end

for _, v in ipairs(vert_arr) do
   print(v..' '..vert[v].color)
end 
```

这段代码是用[Lua 编写](http://www.lua.org/manual/5.1/index.html)的。
你可以在[那里](http://codepad.org/5mMfTrDv)测试它。************

# javascript - 如何验证微调器提交的值

> ID：16120189
> 
> 赞同：0
> 
> 时间：2013-04-20T12:10:55.967
> 
> 标签：javascript, jquery, ajax, validation, jsf

我正在完成一个网络应用程序，并想在我的微调器上进行验证，它应该只让用户提交 1 到 50 之间的值，但是我想要的是如果用户删除了该值，例如输入 0，它要在网页上显示一条错误消息，通知用户这是不正确的，对微调器的支持已全部验证，因此如果输入值 0，则不会发生任何事情，但我只是在寻找一种通知方式用户对此，使用弹出窗口等

这是我的微调器代码

```
<h:body>
 <h:form id="myForm"> 
  <p>
   Number of copies (Max of 50) :
   <p:spinner id ="Copies" min="1" max="50" value="#{printerSettings.p}" size ="1"> 
   <!-- allows the user a choice of up to 50, this is more than enough for any situation, if needed this can be removed or raised -->
   <p:ajax update="p"/>
  </p:spinner>
  <div class="whiteSpace"/>   
  <h:outputText value="Copies that will be printed: &nbsp; #{printerSettings.p}" id="p"/>
 </p> 
```

我试图添加 javascript 验证但没有成功，正如您在我的另一个问题中看到的那样

我的问题是实现我的目标的最佳方法是什么，有没有人有我可以效仿的例子？

多谢你们：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T14:38:16.553

尝试添加这个：

```
<f:validateLongRange minimum="1" maximum="50" /> 
```

# javascript - 使用jQuery查找并用卢比符号替换美元符号

> ID：16120192
> 
> 赞同：0
> 
> 时间：2013-04-20T12:11:14.960
> 
> 标签：javascript, jquery, replace

这是我的代码，我在其中尝试`&#36;`使用 jQuery 将美元符号替换为 INR（印度卢比），但是它不起作用，因为这只是一个示例代码，所以它不是`ul >li`而且有点像，我的尝试是这样的 -`find text`我`replace text`试图首先收集整个 HTML，然后用`$`代码替换符号，但无论如何它都没有。

我的假设 - 在这个片段中`$(document).ready()`使用`$(this)`是指文档，让我知道**这是否是一个错误的假设**，因为我尝试尝试记住这件事。

请`DO NOT`提供任何链接/推荐以 CSS 方式或 Webrupee API 使用，这次保持对 jQuery 的简单 :)

**我的代码**-

```
<!DOCTYPE html>
<html>
<head>
    <title>Rupee Change - jQuery Flavour</title>
</head>

<body>
<p>This is a price listing with &#36; sign, Now I wanted to replace each dollar sign with rupee symbol</p>
<ul>
<li>&#36; 500</li>
<li>&#36; 600</li>
<li>&#36; 700</li>
<li>&#36; 800</li>
<li>&#36; 900</li>
</ul>

 <div id="showhtml"></div>
<script src="http://code.jquery.com/jquery-latest.js"></script>
<script type="text/javascript">
$(document).ready(function(){
$(this).html().replace("$", "<del>&#2352;</del>");
});
</script>
</body>
</html> 
```

仅供参考 - 我也尝试过这种处理方式但不工作:( [find-text-string-using-jquery](https://stackoverflow.com/questions/926580/find-text-string-using-jquery)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-20T12:29:25.723

$ 是 Regex 中的特殊字符。你需要逃避它。

```
$(document).ready(function(){
    var replaced = $('body').html().replace(/\$/g, "<del>&#2352;</del>");
    $('body').html(replaced);
}); 
```

# android - 将 View 类添加到默认布局

> ID：16120194
> 
> 赞同：0
> 
> 时间：2013-04-20T12:11:24.173
> 
> 标签：android, view

我是 Android 开发的新手。我有一个扩展 View 的类 DrawView，它就像一个简单的绘图应用程序

```
public class DrawView extends View implements OnTouchListener {

    Bitmap bitmap;
    Canvas bitmapCanvas;
    int color;

    // Position of finger down
    float pX, pY;

    // Position of finger up
    float mX, mY;

    // Create new path
    Path path = new Path();

    // Is view initialized?!
    boolean isInitialized;

    // Create new paint
    Paint paint = new Paint();

    int begX, begY, endX, endY = 0;         

    //DrawView constructor
    public DrawView(Context context) {
            // Initialize new view
            super(context);
            setFocusable(false);
            setFocusableInTouchMode(false);
            this.setOnTouchListener(this);
            requestLayout();

            paint.setAntiAlias(true);
            paint.setStyle(Style.STROKE);

            // There is no bitmap yet
            isInitialized = false;
    }

    //Initialize bitmap and canvas
    private void init() {

            bitmap = Bitmap.createBitmap(getWidth(), getHeight()/2, Bitmap.Config.RGB_565);
            bitmap.setPixel(72, 72, Color.BLACK);

            // Create new canvas and set bitmap
            bitmapCanvas = new Canvas();
            bitmapCanvas.setBitmap(bitmap);

            // ... set canvas background color
            bitmapCanvas.drawColor(Color.WHITE);

            // We're done with initialization
            isInitialized = true;
    }

    //Reset canvas
    public void reset(){
            bitmapCanvas.drawColor(Color.WHITE);  
    }

    //Handle event 'onDraw'
    @Override
    public void onDraw(Canvas canvas) {

            // Check if initialized
            if (!isInitialized)
                    init();

            // Draw bitmap!
            canvas.drawBitmap(bitmap, 0, 0, paint);
    }

    //Handle event 'onTouch'        
    public boolean onTouch(View view, MotionEvent event) {
            // Check event type

            switch (event.getAction()) {

            // Finger down
            case MotionEvent.ACTION_DOWN:

                    paint.setColor(Color.BLACK);
                    paint.setStrokeWidth(7f);
                    paint.setStrokeJoin(Paint.Join.ROUND);
                    paint.setStrokeCap(Paint.Cap.ROUND);
                    paint.setAntiAlias(true);

                    // Get current position
                    pX = event.getX();
                    pY = event.getY();                      

                    // Set beginning of path to (posX,posY)                     
                    path.moveTo(pX, pY);
                    begX= (int) pX;
                    begY = (int) pY;
                    bitmapCanvas.drawPoint(pX, pY, paint);

                    break;

            // Finger moves
            case MotionEvent.ACTION_MOVE:
                    mX = event.getX();
                    mY = event.getY();

                    // Set position of end of path
                    path.lineTo(mX, mY);
                    endX = (int) mX;
                    endY = (int) mY;

                    // Draw path
                    bitmapCanvas.drawPath(path, paint);

                    // Invalidate canvas (redraw the view)

                    invalidate();
                    break;

            // Finger up
            case MotionEvent.ACTION_UP:

                    mX = event.getX();
                    mY = event.getY();

                    if (mY == pY && mX == pX){                      
                        bitmapCanvas.drawPoint(pX, pY, paint);
                        invalidate();
                    }

                    path.reset(); 
                    break;

            }

            return true;
    }
} 
```

在我的默认布局中，我希望它包含 DrawView 和其他元素（按钮、textview ...）

如何将“默认布局”拆分为包含带有这些元素的 DrawView？谢谢

编辑：我应该把这段代码放在哪里以使 DrawView 正常工作

```
public class Draw extends Activity {
DrawView drawView;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    drawView = new DrawView(this);
    setContentView(drawView);
    drawView.requestFocus();
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T12:16:45.717

将带有全名的视图添加到布局中。例如：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
...>
<TextView.../>
<my.package.MyCustomView

    android:id="@+id/my_view"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    />
<Button.../>
</LinearLayout> 
```

这`MyCustomView`是扩展的 java 类的名称`View`，`my.package`是包含该类的包的名称。您可以看到可以添加`LayoutParams`到它，因为我添加了 layout_height 或 layout_width。

**编辑：**

如果你想在`XML`布局中使用你的自定义视图，你必须至少将这个构造函数添加到你的类中：

```
public MyCustomView(Context context, AttributeSet attrs){
    super(context, attrs);
    ...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T12:19:11.987

我不知道你实际上想要什么，但你可以根据你的要求使用任何布局这里是你的视图和分屏中的另一个视图的简单布局

```
<LinearLayout
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical">

<LinearLayout
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="horizontal"
    android:layout_weight="1">

    <TextView /> <!--your textview-->
    <TextView /> <!--your textview-->
    <TextView /> <!--your textview-->
</LinearLayout>

<com.androidapp.DrawView android:layout_width="match_parent"
      android:layout_height="match_parent"
      android:layout_weight="1"/>

</LinearLayout> 
```

这将为您的视图和另一个嵌套视图以相同的大小拆分屏幕`LinearLayout`

如果您想以换行大小显示您的内容，那么如果您在 DrawView 顶部显示并`wrap_content`在高度上使用，或者如果您在底部显示而不是在浮动中赋予它们 0.2 或o.3 的权重，则只需删除权重

**编辑** 定义两个构造函数

```
public DrawView(Context context) {
        // Initialize new view
        super(context);
        initObject();
}

public MyCustomView(Context context, AttributeSet attrs){
    super(context, attrs);
    initObject();
}

private void initObject(){
      setFocusable(false);
      setFocusableInTouchMode(false);
      this.setOnTouchListener(this);
      requestLayout();

      paint.setAntiAlias(true);
      paint.setStyle(Style.STROKE);

      // There is no bitmap yet
      isInitialized = false;
} 
```

# python - Django 在不同的模型字段上保存图像

> ID：16120197
> 
> 赞同：3
> 
> 时间：2013-04-20T12:11:46.190
> 
> 标签：python, django, django-signals, django-models

我有一个名为 Picture 的模型。当图像上传到这个模型中时，它会在保存前自动调整大小。

我的主要目标是将上传的图像重新调整为 2 个单独的图像。所以我可以将它用于不同的目的，比如小图片和大图片。所以我为实现这个目标所做的是创建另一个名为 small 的字段。代表小图片。

我的模型下面有 2 个函数，称为 save 和 small 。这些功能将自动重新调整图像大小。

我的计划是，当我将图像上传到模型时。我的保存功能将自动调整图像大小并将其保存到图像文件夹中，但我怎样才能让我的小功能从图像字段中获取该图像，以便它可以调整它的大小并将其保存到我的小字段中。

总而言之，它只是检索上传图像并在两个字段上调整图像大小。

```
class Picture(models.Model):
    user = models.ForeignKey(User)
    small = models.ImageField(upload_to="small/",blank=True,null=True)
    image = models.ImageField(upload_to="images/",blank=True)

    def save(self , force_insert=False,force_update=False):
        super (Picture,self).save(force_insert,force_update)

        pw = self.image.width
        ph = self.image.height
        mw = 500
        mh = 500

        if (pw > mw) or (ph > mh):
            filename = str(self.image.path)
            imageObj = img.open(filename)
            ratio = 1

            if ( pw > mw):
                ratio = mw / float(pw)
                pw = mw
                ph = int(math.floor(float(ph)* ratio))
            if ( ph > mh):
                ratio = ratio * ( mh /float(ph))
                ph = mh 
                pw = int(math.floor(float(ph)* ratio))

            imageObj = imageObj.resize((pw,ph),img.ANTIALIAS)
            imageObj.save(filename)

    def save(self , force_insert=False,force_update=False):
        super (Picture,self).save(force_insert,force_update)

        pw = self.image.width
        ph = self.image.height
        mw = 300
        mh = 300

        if (pw > mw) or (ph > mh):
            filename = str(self.image.path)
            imageObj = img.open(filename)
            ratio = 1

            if ( pw > mw):
                ratio = mw / float(pw)
                pw = mw
                ph = int(math.floor(float(ph)* ratio))
            if ( ph > mh):
                ratio = ratio * ( mh /float(ph))
                ph = mh 
                pw = int(math.floor(float(ph)* ratio))

            imageObj = imageObj.resize((pw,ph),img.ANTIALIAS)
            imageObj.save(filename) 
```

如果这没有意义，请提醒我，以便我修改它

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T12:21:48.197

您可以创建一个自定义字段（继承 ImageField）或创建一个 pre_save 信号来处理上传。

```
from django.db.models.signals import pre_save
from django.dispatch import receiver
from myapp.models import MyModel

class MyModel(models.Model):
    # other fields
    image = MyCustomImageField(sizes=(('small', '300x300'), ('large', '500x500'))) 
```

一个信号

```
@receiver(pre_save, sender=MyModel)
def process_picture(sender, **kwargs):
    # do resizing and storage stuff 
```

更多关于[信号](https://docs.djangoproject.com/en/dev/topics/signals/)和自定义[字段](https://docs.djangoproject.com/en/dev/howto/custom-model-fields/)的信息。

[自定义 ImageField 的工作示例。](https://github.com/django-lfs/lfs/blob/master/core/fields/thumbs.py)

# php - 在php中将hh：mm写成一个字符串加起来

> ID：16120199
> 
> 赞同：1
> 
> 时间：2013-04-20T12:12:06.343
> 
> 标签：php, function, time, strtotime

我试图从几次写成 php 中的字符串中得到总时间。

字符串时间：00.25、07.35、01.10、00.00、01.00、00.22

这样我应该得到 10hrs12mins 但我得到 11hrs03mins。

```
function add() 
{
    $midnight = strtotime('0.00');

    $extra = strtotime(hours($extratime));
    $taxi = strtotime(hours($taxitime));
    $flt = strtotime($flttime);
    $res = strtotime(hours($options->restime));
    $hold = strtotime(hours($holdtime));

    $totalseconds = $extra + $taxi + $flt + $res + $hold;

    return date("H.i", $midnight + $totalseconds);
} 
```

$holdtime、$taxitime、$extratime、$options->restime 都写为分钟，然后使用以下方法转换为小时：

```
function hours($min) 
{
    $mins = abs($min);
    $neg = ($min < 0) ? '-' : '' ;
    $hours = $mins / 60;
    $onlyhours = floor($hours);
    $onlymins = $mins - ($onlyhours*60);
    $time = sprintf("%s%d.%02d",$neg,$onlyhours,$onlymins);
    return $time;
} 
```

函数小时工作正常，但函数添加在显示后却没有，我得到 11.03，它应该是 10.12。

提前致谢，

马切伊。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T13:41:48.260

不要以小时为单位转换 $holdtime、$taxistime、$extratime、$options->restime。以分钟为单位添加这些持续时间：

```
$total = $holdtime + $taxitime + $extratime + $options->restime; 
```

然后以小时为单位转换 $total。

# ms-access - 检查 Null 值时的结果不一致（Jet DAO 与 ACE DAO）

> ID：16120202
> 
> 赞同：3
> 
> 时间：2013-04-20T12:12:12.590
> 
> 标签：ms-access, vb6, dao, jet

在访问 MDB 文件的 VB6 程序中，正在执行以下 SQL 查询：

```
> Select * FROM [table1] WHERE ([type] = 1 OR [type] = 2 OR [type] = 6)
> AND ([notes] = Null OR [notes] = '0') AND [date] >= 
> cvdate('09/03/2013') ORDER BY [date], [column2] 
```

如果我`Microsoft Access 14.0 Object Library`在程序中引用返回的记录集有`0`行。

如果我引用`Microsoft DAO 3.51 Object Library`返回的记录集有超过`100`行。

造成这种差异的原因是什么？两个提供者处理测试的方式有区别`Null`吗？这是 ACE DAO 访问旧 MDB 文件的重大更改吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-20T12:42:14.553

`WHERE ... [notes] = Null`是非标准的 SQL。[空值传播](http://en.wikipedia.org/wiki/Null_%28SQL%29#Null_propagation)可能会强制任何涉及`Null`返回的表达式`Null`。因此，表达式`[notes] = Null`（您打算成为布尔表达式）可以很好地返回`Null`，既不是`True`也不是`False`。

查询处理器处理该`Null`值的方式可能确实因一个数据库引擎而异：它可能解释`Null`为`False`，或者它可能只是忽略结果，或者它可能触发错误。另请注意，空传播可能会将您的整个 WHERE 子句折叠为`Null`if...

`(some other condition) AND (Null)`

...评估为`Null`.

标准 SQL 将是`([notes] IS NULL)`，Jet/ACE 等价物将是`IsNull([notes])`. 这两个都将始终返回`True`or `False`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-16T17:10:32.493

DAO 3.51 已经过时了。它在多年前被 DAO 3.6 取代。请改用 3.6，然后查看此版本的查询是否从 DAO 3.6 和 ACEDAO 返回相同的结果：

```
SELECT *
FROM [table1]
WHERE
        [type] IN (1,2,6)
    AND ([notes] Is Null OR [notes] = '0')
    AND [date] >= cvdate('09/03/2013')
ORDER BY [date], [column2]; 
```

# php - JSON属性进入循环

> ID：16120206
> 
> 赞同：0
> 
> 时间：2013-04-20T12:12:26.923
> 
> 标签：php, arrays, json

我已经将一些 XML 转换为 JSON 输出。现在，当我想循环值并想回显时。我很困惑，无法让它工作。我只需要是否有人可以给我想法或指出我错在哪里。

这是我的实际 JSON 输出。我已经在记事本中格式化了这个输出

```
{
   "@attributes":{
      "NMchs":"10"
   },
   "links":{
      "@attributes":{
         "fUrlBase":"http:\/\/synd.cricbuzz.com\/j2me\/1.0\/flags\/team_"
      }
   },
   "match":[
      {
         "@attributes":{
            "id":"3",
            "type":"T20",
            "srs":"Indian Premier League 2013",
            "mchDesc":"KOL vs CHN",
            "mnum":"26th Match",
            "vcity":"Kolkata",
            "vcountry":"India",
            "grnd":"Eden Gardens",
            "inngCnt":"1",
            "datapath":"http:\/\/synd.cricbuzz.com\/j2me\/1.0\/match\/2013\/2013_T20_LEAGUE\/KOL_CHN_APR20\/"
         },
         "state":{
            "@attributes":{
               "mchState":"inprogress",
               "status":"KOL elect to bat",
               "TW":"Kolkata",
               "decisn":"Batting",
               "addnStatus":"",
               "splStatus":""
            }
         },
         "Tm":[
            {
               "@attributes":{
                  "id":"63",
                  "Name":"Kolkata",
                  "sName":"KOL",
                  "flag":"0"
               }
            },
            {
               "@attributes":{
                  "id":"58",
                  "Name":"Chennai",
                  "sName":"CHN",
                  "flag":"0"
               }
            }
         ],
         "Tme":{
            "@attributes":{
               "Dt":"Apr 20 2013",
               "stTme":"10:30",
               "enddt":"Apr 20 2013"
            }
         },
         "mscr":{
            "inngsdetail":{
               "@attributes":{
                  "noofovers":"50",
                  "rrr":"0",
                  "crr":"6.49",
                  "cprtshp":"11(13)"
               }
            },
            "btTm":{
               "@attributes":{
                  "id":"63",
                  "sName":"KOL"
               },
               "Inngs":{
                  "@attributes":{
                     "desc":"Inns",
                     "r":"66",
                     "Decl":"0",
                     "FollowOn":"0",
                     "ovrs":"10.1",
                     "wkts":"4"
                  }
               }
            },
            "blgTm":{
               "@attributes":{
                  "id":"58",
                  "sName":"CHN"
               }
            }
         }
      }
   ]
} 
```

输出中有 4-5 个类似的数据。下面是我试图在其中循环字段以使用变量回显的文件。

```
<?php
require_once("xml2json.php");

$testXmlFile = 'test.xml';

$xmlStringContents = file_get_contents($testXmlFile); 
$jsonContents = "";

$jsonContents = xml2json::transformXmlStringToJson($xmlStringContents);
echo($jsonContents);

$obj = json_decode($jsonContents);

foreach ($obj->match as $match) {
    echo $match ->id,"<br>";
    echo $match ->attributes->type,"<br>";
    echo $match ->attributes->srs,"<br>";
    echo $match ->attributes->mchDesc,"<br>";
    echo $match ->attributes->mnum,"<br>";
    echo $match ->attributes->vcity,"<br>";
    echo $match ->attributes->vcountry,"<br>";
    echo $match ->attributes->grnd,"<br>";
    echo $match ->attributes->inngCnt,"<br>";
    echo $match ->attributes->state->attributes->mchState,"<br>";
    echo $match ->attributes->state->attributes->status,"<br>";
    echo $match ->attributes->state->attributes->TW,"<br>";
    echo $match ->attributes->state->attributes->decisn,"<br>";
    echo $match ->attributes->state->attributes->addnStatus,"<br>";
    echo $match ->attributes->state->attributes->splStatus,"<br>";
    echo $match ->attributes->Tm->attributes->id,"<br>";
    echo $match ->attributes->Tm->attributes->Name,"<br>";
    echo $match ->attributes->Tm->attributes->sName,"<br>";
    echo $match ->attributes->Tm->attributes->flag,"<br>";
    echo $match ->attributes->Tm->attributes->attributes->id,"<br>";
    echo $match ->attributes->Tm->attributes->attributes->Name,"<br>";
    echo $match ->attributes->Tm->attributes->attributes->sName,"<br>";
}
?> 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T12:51:59.853

您的 json 解码低于对结构的关注

```
 stdClass Object
(
   [@attributes] => stdClass Object
    (
        [NMchs] => 10
    )

   [links] => stdClass Object
    (
        [@attributes] => stdClass Object
            (
                [fUrlBase] => http://synd.cricbuzz.com/j2me/1.0/flags/team_
            )

    )

    [match] => Array
    (
        [0] => stdClass Object
            (
                [@attributes] => stdClass Object
                    (
                        [id] => 3
                        [type] => T20
                        [srs] => Indian Premier League 2013
                        [mchDesc] => KOL vs CHN
                        [mnum] => 26th Match
                        [vcity] => Kolkata
                        [vcountry] => India
                        [grnd] => Eden Gardens
                        [inngCnt] => 1
                        [datapath] => http://synd.cricbuzz.com/j2me/1.0/match/2013/2013_T20_LEAGUE/KOL_CHN_APR20/
                    )

                [state] => stdClass Object
                    (
                        [@attributes] => stdClass Object
                            (
                                [mchState] => inprogress
                                [status] => KOL elect to bat
                                [TW] => Kolkata
                                [decisn] => Batting
                                [addnStatus] => 
                                [splStatus] => 
                            )

                    )

                [Tm] => Array
                    (
                        [0] => stdClass Object
                            (
                                [@attributes] => stdClass Object
                                    (
                                        [id] => 63
                                        [Name] => Kolkata
                                        [sName] => KOL
                                        [flag] => 0
                                    )

                            )

                        [1] => stdClass Object
                            (
                                [@attributes] => stdClass Object
                                    (
                                        [id] => 58
                                        [Name] => Chennai
                                        [sName] => CHN
                                        [flag] => 0
                                    )

                            )

                    )

                [Tme] => stdClass Object
                    (
                        [@attributes] => stdClass Object
                            (
                                [Dt] => Apr 20 2013
                                [stTme] => 10:30
                                [enddt] => Apr 20 2013
                            )

                    )

                [mscr] => stdClass Object
                    (
                        [inngsdetail] => stdClass Object
                            (
                                [@attributes] => stdClass Object
                                    (
                                        [noofovers] => 50
                                        [rrr] => 0
                                        [crr] => 6.49
                                        [cprtshp] => 11(13)
                                    )

                            )

                        [btTm] => stdClass Object
                            (
                                [@attributes] => stdClass Object
                                    (
                                        [id] => 63
                                        [sName] => KOL
                                    )

                                [Inngs] => stdClass Object
                                    (
                                        [@attributes] => stdClass Object
                                            (
                                                [desc] => Inns
                                                [r] => 66
                                                [Decl] => 0
                                                [FollowOn] => 0
                                                [ovrs] => 10.1
                                                [wkts] => 4
                                            )

                                    )

                            )

                        [blgTm] => stdClass Object
                            (
                                [@attributes] => stdClass Object
                                    (
                                        [id] => 58
                                        [sName] => CHN
                                    )

                            )

                    )

            )

    )

 ) 
```

你应该改变 foreach 代码

```
 foreach ($obj->match as $match) {
    echo $match ->{'@attributes'}->type,"<br>";
    echo $match ->{'@attributes'}->srs,"<br>";
    echo $match ->{'@attributes'}->mchDesc,"<br>";
    echo $match ->{'@attributes'}->mnum,"<br>";
    echo $match ->{'@attributes'}->vcity,"<br>";
    echo $match ->{'@attributes'}->vcountry,"<br>";
    echo $match ->{'@attributes'}->grnd,"<br>";
    echo $match ->{'@attributes'}->inngCnt,"<br>";
    echo $match ->state->{'@attributes'}->mchState,"<br>";
    echo $match ->state->{'@attributes'}->status,"<br>";
    echo $match ->state->{'@attributes'}->TW,"<br>";
    echo $match ->state->{'@attributes'}->decisn,"<br>";
    echo $match ->state->{'@attributes'}->addnStatus,"<br>";
    echo $match ->state->{'@attributes'}->splStatus,"<br>";
    foreach($match ->Tm as $Tm){
       echo $Tm->{'@attributes'}->id,"<br>";
       echo $Tm->{'@attributes'}->Name,"<br>";
       echo $Tm->{'@attributes'}->sName,"<br>";
       echo $Tm->{'@attributes'}->flag,"<br>";
   }
} 
```

**输出为 html**

```
 T20<br>Indian Premier League 2013<br>KOL vs CHN<br>26th Match<br>Kolkata<br>India<br>Eden Gardens<br>1<br>inprogress<br>KOL elect to bat<br>Kolkata<br>Batting<br><br><br>63<br>Kolkata<br>KOL<br>0<br>58<br>Chennai<br>CHN<br>0<br> 
```

编辑：

[请参阅https://cdn.anonfiles.com/1366532327809.txt](https://cdn.anonfiles.com/1366532327809.txt)的 json 解码，它表明您需要 put`$obj->mchdata->match`而不是`$obj->match`将此代码更改为：

```
 foreach ($obj->mchdata->match as $match) {
    echo @$match ->{'@attributes'}->type,"<br>";
    echo @$match ->{'@attributes'}->srs,"<br>";
    echo @$match ->{'@attributes'}->mchDesc,"<br>";
    echo @$match ->{'@attributes'}->mnum,"<br>";
    echo @$match ->{'@attributes'}->vcity,"<br>";
    echo @$match ->{'@attributes'}->vcountry,"<br>";
    echo @$match ->{'@attributes'}->grnd,"<br>";
    echo $match ->{'@attributes'}->inngCnt,"<br>";
    echo @$match ->state->{'@attributes'}->mchState,"<br>";
    echo @$match ->state->{'@attributes'}->status,"<br>";
    echo @$match ->state->{'@attributes'}->TW,"<br>";
    echo @$match ->state->{'@attributes'}->decisn,"<br>";
    echo @$match ->state->{'@attributes'}->addnStatus,"<br>";
    echo @$match ->state->{'@attributes'}->splStatus,"<br>";
    foreach($match ->Tm as $Tm){
       echo @$Tm->{'@attributes'}->id,"<br>";
       echo @$Tm->{'@attributes'}->Name,"<br>";
       echo @$Tm->{'@attributes'}->sName,"<br>";
       echo @$Tm->{'@attributes'}->flag,"<br>";
   }
} 
```

**输出为 html**

```
T20<br>Indian Premier League 2013<br>DEL vs MUM<br>28th Match<br>Delhi<br>India<br>Feroz Shah Kotla<br>0<br>preview<br>Starts on Apr 21 at 10:30 GMT<br><br><br><br><br>61<br>Delhi<br>DEL<br>0<br>62<br>Mumbai<br>MUM<br>0<br>T20<br>Indian Premier League 2013<br>MOH vs PUNE<br>29th Match<br>Mohali<br>India<br>Punjab Cricket Association Stadium<br>0<br>preview<br>Starts on Apr 21 at 14:30 GMT<br><br><br><br><br>65<br>Punjab<br>MOH<br>0<br>183<br>Pune<br>PUNE<br>0<br>T20<br>Indian Premier League 2013<br>BLR vs JAI<br>27th Match<br>Bengaluru<br>India<br>M.Chinnaswamy Stadium<br>2<br>complete<br>Royal Challengers Bangalore won by 7 wkts<br>Bangalore<br>Fielding<br><br><br>59<br>Bangalore<br>BLR<br>0<br>64<br>Rajasthan<br>JAI<br>0<br>T20<br>Indian Premier League 2013<br>KOL vs CHN<br>26th Match<br>Kolkata<br>India<br>Eden Gardens<br>2<br>complete<br>Chennai won by 4 wkts<br>Kolkata<br>Batting<br><br><br>63<br>Kolkata<br>KOL<br>0<br>58<br>Chennai<br>CHN<br>0<br>T20<br>Indian Premier League 2013<br>BLR vs JAI<br>27th Match<br><br><br><br>2<br>Result<br>Royal Challengers Bangalore won by 7 wkts<br><br><br><br><br>59<br>Bangalore<br>BLR<br>0<br>64<br>Rajasthan<br>JAI<br>0<br>T20<br>Kenya tour of Namibia 2013<br>KEN vs NED<br>Only T20I<br><br><br><br>2<br>Result<br>Kenya won by 5 wkts<br><br><br><br><br>14<br>Ken<br>KEN<br>1<br>24<br>NED<br>NED<br>1<br> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T13:00:31.717

假设您的 XML 转换为正确的 JSON，并且 json_decode 返回 NULL 以外的内容。你可以用这个。此外，由于您在 JSON 中留下了“@”字符，因此您必须使用 PHP 特殊语法来检索该属性，因为 @ 符号对 PHP 变量无效。如果您从属性中删除“@”，那么您将能够使用 $match->attributes。

```
<?php
    $obj = json_decode( $jsonContents );

    foreach ( $obj->match as $match )
    {
        echo $match->{'@attributes'}->id . '<br>';
        echo $match->{'@attributes'}->type . "<br>";
        echo $match->{'@attributes'}->srs . "<br>";
        echo $match->{'@attributes'}->mchDesc . "<br>";
        echo $match->{'@attributes'}->mnum . "<br>";
        echo $match->{'@attributes'}->vcity . "<br>";
        echo $match->{'@attributes'}->vcountry . "<br>";
        echo $match->{'@attributes'}->grnd . "<br>";
        echo $match->{'@attributes'}->inngCnt . "<br>";
        echo $match->state->{'@attributes'}->mchState . "<br>";
        echo $match->state->{'@attributes'}->status . "<br>";
        echo $match->state->{'@attributes'}->TW . "<br>";
        echo $match->state->{'@attributes'}->decisn . "<br>";
        echo $match->state->{'@attributes'}->addnStatus . "<br>";
        echo $match->state->{'@attributes'}->splStatus . "<br>";
        foreach ( $match->Tm as $Tm )
        {
            echo $Tm->{'@attributes'}->id . "<br>";
            echo $Tm->{'@attributes'}->Name . "<br>";
            echo $Tm->{'@attributes'}->sName . "<br>";
            echo $Tm->{'@attributes'}->flag . "<br>";
        }
    }
?> 
```

这是我用来测试的一些示例 JSON（取自上面并已修复）。

```
<?php
$jsonContents = <<<EOT
{
   "@attributes":{
      "NMchs":"10"
   },
   "links":{
      "@attributes":{
         "fUrlBase":"http:\/\/synd.cricbuzz.com\/j2me\/1.0\/flags\/team_"
      }
   },
   "match":[
      {
         "@attributes":{
            "id":"3",
            "type":"T20",
            "srs":"Indian Premier League 2013",
            "mchDesc":"KOL vs CHN",
            "mnum":"26th Match",
            "vcity":"Kolkata",
            "vcountry":"India",
            "grnd":"Eden Gardens",
            "inngCnt":"1",
            "datapath":"http:\/\/synd.cricbuzz.com\/j2me\/1.0\/match\/2013\/2013_T20_LEAGUE\/KOL_CHN_APR20\/"
         },
         "state":{
            "@attributes":{
               "mchState":"inprogress",
               "status":"KOL elect to bat",
               "TW":"Kolkata",
               "decisn":"Batting",
               "addnStatus":"",
               "splStatus":""
            }
         },
         "Tm":[
            {
               "@attributes":{
                  "id":"63",
                  "Name":"Kolkata",
                  "sName":"KOL",
                  "flag":"0"
               }
            },
            {
               "@attributes":{
                  "id":"58",
                  "Name":"Chennai",
                  "sName":"CHN",
                  "flag":"0"
               }
            }
         ],
         "Tme":{
            "@attributes":{
               "Dt":"Apr 20 2013",
               "stTme":"10:30",
               "enddt":"Apr 20 2013"
            }
         },
         "mscr":{
            "inngsdetail":{
               "@attributes":{
                  "noofovers":"50",
                  "rrr":"0",
                  "crr":"6.49",
                  "cprtshp":"11(13)"
               }
            },
            "btTm":{
               "@attributes":{
                  "id":"63",
                  "sName":"KOL"
               },
               "Inngs":{
                  "@attributes":{
                     "desc":"Inns",
                     "r":"66",
                     "Decl":"0",
                     "FollowOn":"0",
                     "ovrs":"10.1",
                     "wkts":"4"
                  }
               }
            },
            "blgTm":{
               "@attributes":{
                  "id":"58",
                  "sName":"CHN"
               }
            }
         }
      }
   ]
}
EOT;
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T13:08:31.553

我正在详细说明：

如果您想将整个对象显示为带有分隔符的字符串，您可以使用递归函数[来实现，例如](http://ideone.com/UUmnOu)：

```
$obj = json_decode($json);

function objectToString($obj, $delimiter = PHP_EOL) {
    foreach($obj as $key=>$val) {

        if(is_object($val) || is_array($val)) {
           objectToString($val, $delimiter);
        } else {
            echo $key . '=> ' .$val . $delimiter;
        }
    }
}

objectToString($obj, '<br />'); 
```

但它并不是真正有用或仅用于调试，使用[print_r](http://php.net/print_r)函数更容易。

# c# - 反序列化 JSON 数据

> ID：16120208
> 
> 赞同：0
> 
> 时间：2013-04-20T12:12:36.160
> 
> 标签：c#, json, deserialization

我从 Twitter API SEARCH 获得了 JSON 数据。我正在尝试将这些数据反序列化为对象。

JSON 方案如下所示：

```
 {
      "element": INT,
      "element2": STRING,
       ..
       ..
      "Results":[
                   {
                      "user":STRING, 
                      "image":STRING,
                      ..
                      ..
                   }
                ]
   } 
```

如何使用 JSON Toolkit 或其他东西将这些 JSON 元素反序列化为对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T12:22:33.570

创建一个匹配 JSON 模式的类

```
public class Data
{
   public string Element{get;set;}
   public string Element2{get;set;}
   public List<Result> Results{get;set;}
}
public class Result
{
  public string User{get;set;}
  public string Image{get;set;}
} 
```

并使用[JSON.NET](http://james.newtonking.com/projects/json-net.aspx) 反序列化

```
var result = JsonConvert.DeserializeObject<Result>(json); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T13:49:54.263

如果您对正确的类型定义有疑问，您始终可以使用 Json.Net 使用动态反序列化：

```
var original = JsonConvert.DeserializeObject<dynamic>(jsonstring); 
```

然后基于它构建您想要的对象（例如，如果原始对象包含开销信息集，并且您不需要所有这些对象）：

```
var somepart = new {
                       E1 = original.element1,
                       E2 = original.element2
                   }; 
```

# ruby-on-rails - 将数据库更改为 Postgres，现在 Rspec 抛出错误：can't find object by id

> ID：16120211
> 
> 赞同：2
> 
> 时间：2013-04-20T12:12:54.117
> 
> 标签：ruby-on-rails, ruby, postgresql, testing, rspec

我已经格式化了我的计算机，并且在重新安装 Rails 时将我的数据库更改为 postgres，现在之前通过的一些测试失败了，例如以下代码：

```
describe "Tickets" do
  subject { page }

  describe "when creating a new ticket successfully" do
    before do
      login_as_user
      visit new_ticket_path
      fill_in "Subject", with: "Test ticket"
      fill_in "Description", with: "This is a test ticket"
      select 'Billing', from: "ticket[category]" 
      click_button "Submit Ticket"
      TicketNotifier.drain
      Sidekiq::Extensions::DelayedMailer.drain
    end

    specify { last_email.to.should include("my.email@gmail.com") }
    it { should have_selector('title', text: "Ticket #1") }
    it { should have_content("ticket has been submitted successfully") }
  end
end 
```

返回以下错误：

```
 10) Tickets when creating a new ticket successfully 
     Failure/Error: TicketNotifier.drain
     ActiveRecord::RecordNotFound:
       Couldn't find Ticket with id=366
     # ./app/workers/ticket_notifier.rb:5:in `perform'
     # ./spec/requests/blas_spec.rb:14:in `block (3 levels) in <top (required)>'

   # same error repeated a few times... 
```

或者：

```
context "should not be able to edit other user's website" do
  before { visit edit_rental_path(1) }

  it { should have_selector('title', text: "Your Websites") }
  it { should have_selector(notice, text: "You do not have access to this domain.") }
end 
```

抛出以下几个：

```
 2) Websites create a user with 2 websites log user out log in second user should not be able to edit other user's website 
     Failure/Error: before { visit edit_website_path(1) }
     ActiveRecord::RecordNotFound:
       Couldn't find Website with id=1
     # ./app/controllers/websites_controller.rb:116:in `correct_user'
     # ./spec/requests/websites_spec.rb:187:in `block (6 levels) in <top (required)>' 
```

那么，它是否为每个`it { should ... }`子句创建一个新对象？
即使我尝试以下类似的操作，它也无法通过 id 找到：

```
@site = Website.where(link: "http://google.com").first
visit website_path(@site) 
```

造成这些问题的原因是什么？

### 更新

我已经按照 depa 的建议清空了我的 gemset，现在我发布的第一个测试没有出错，即使我指定`it { should have_selector('title', text: "Ticket #1") }`. 来自票证的`#1`ID，因此出于某种原因，它正在像以前一样进行那些测试，但我仍然会在其他人身上遇到错误，除非我将它们更改为：

```
before do
   # create the ticket
   @ticket = Ticket.where(...).first
end

it { should have_selector('h2', text: "Ticket ##{@ticket.id}") } 
```

而以前如果我只是离开它，因为`Ticket #1`测试会通过。作为测试数据库的工作方式`postgres`和工作方式不同吗？`sqlite`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T16:29:58.427

我会尝试重置您的 gem 环境，从使用 RVM开始`gem pristine rspec-rails`，一直到现在`gem pristine capybara`为止。`rvm gemset empty`

# javascript - 0x800a01bd - JavaScript 运行时错误：对象不支持此操作

> ID：16120215
> 
> 赞同：1
> 
> 时间：2013-04-20T12:13:17.340
> 
> 标签：javascript

我正在阅读并尝试完成本教程： [http ://www.sitepoint.com/creating-a-simple-windows-8-game-with-javascript-input-and-sound/](http://www.sitepoint.com/creating-a-simple-windows-8-game-with-javascript-input-and-sound/)

昨天，我在这个论坛上写了一个错误，并解决了它，但是今天，我进入了最后一个，又遇到了一个错误。

我的 default.html 文件

```
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>CatapultGame</title>

    <!-- WinJS references -->
    <link href="//Microsoft.WinJS.1.0/css/ui-light.css" rel="stylesheet" />
    <script src="//Microsoft.WinJS.1.0/js/base.js"></script>
    <script src="//Microsoft.WinJS.1.0/js/ui.js"></script>

    <!-- CatapultGame references -->
    <link href="/css/default.css" rel="stylesheet" />
    <script src="/js/default.js"></script>
    <script src="js/CreateJS/easeljs-0.6.0.min.js"></script>
    <script src="js/CreateJS/preloadjs-0.2.0.min.js"></script>
</head>
<body>
    <canvas id="gameCanvas"></canvas>
</body>
</html> 
```

和 default.js 文件：

```
// For an introduction to the Blank template, see the following documentation:
// http://go.microsoft.com/fwlink/?LinkId=232509
(function () {
    "use strict";

    var app = WinJS.Application;
    var activation = Windows.ApplicationModel.Activation;
    WinJS.strictProcessing();

    var canvas, context, stage;
    var bgImage, p1Image, p2Image, ammoImage, p1Lives, p2Lives, title, endGameImage;
    var bgBitmap, p1Bitmap, p2Bitmap, ammoBitmap;
    var preload;

    // calculate display scale factor  - original game assets assume 800x480
    var SCALE_X = window.innerWidth / 800;
    var SCALE_Y = window.innerHeight / 480;
    var MARGIN = 25;
    var GROUND_Y = 390 * SCALE_Y;

    var LIVES_PER_PLAYER = 3;
    var player1Lives = LIVES_PER_PLAYER;
    var player2Lives = LIVES_PER_PLAYER;

    var isShotFlying = false;
    var playerTurn = 1;
    var playerFire = false;
    var shotVelocity;

    var MAX_SHOT_POWER = 10;
    var GRAVITY = 0.07;

    var isAiming = false;
    var aimPower = 1;
    var aimStart, aimVector;

    var FIRE_SOUND_FILE = "/sounds/CatapultFire.wav";
    var HIT_SOUND_FILE = "/sounds/BoulderHit.wav";
    var EXPLODE_SOUND_FILE = "/sounds/CatapultExplosion.wav";
    var LOSE_SOUND_FILE = "/sounds/Lose.wav";
    var AIM_SOUND_FILE = "/sounds/RopeStretch.wav";
    var WIN_SOUND_FILE = "/sounds/Win.wav";

    app.onactivated = function (args) {
        if (args.detail.kind === activation.ActivationKind.launch) {
            if (args.detail.previousExecutionState !== activation.ApplicationExecutionState.terminated) {
                // TODO: This application has been newly launched. Initialize
                // your application here.
            } else {
                // TODO: This application has been reactivated from suspension.
                // Restore application state here.
            }
            args.setPromise(WinJS.UI.processAll());
        }
    };

    function initialize() {
        canvas = document.getElementById("gameCanvas");
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        context = canvas.getContext("2d");

        canvas.addEventListener("MSPointerUp", endAim, false);
        canvas.addEventListener("MSPointerMove", adjustAim, false);
        canvas.addEventListener("MSPointerDown", beginAim, false)

        **var stage = new createjs.Stage(canvas);** <<========== HERE IS THE ERROR LINE !!!!

        // use preloadJS to get sounds and images loaded before starting

        preload = new createjs.PreloadJS();
        preload.onComplete = prepareGame;
        var manifest = [
        { id: "screenImage", src: "images/Backgrounds/gameplay_screen.png" },
        { id: "redImage", src: "images/Catapults/Red/redIdle/redIdle.png" },
        { id: "blueImage", src: "images/Catapults/Blue/blueIdle/blueIdle.png" },
        { id: "ammoImage", src: "images/Ammo/rock_ammo.png" },
        { id: "winImage", src: "images/Backgrounds/victory.png" },
        { id: "loseImage", src: "images/Backgrounds/defeat.png" },
        { id: "blueFire", src: "images/Catapults/Blue/blueFire/blueCatapultFire.png" },
        { id: "redFire", src: "images/Catapults/Red/redFire/redCatapultFire.png" },
        { id: "hitSound", src: HIT_SOUND_FILE },
        { id: "explodeSound", src: EXPLODE_SOUND_FILE },
        { id: "fireSound", src: FIRE_SOUND_FILE },
        { id: "loseSound", src: LOSE_SOUND_FILE },
        { id: "aimSound", src: AIM_SOUND_FILE },
        { id: "winSound", src: WIN_SOUND_FILE }
        ];
        preload.loadManifest(manifest);
    }

    function prepareGame()
    {
        // draw Bg first, others appear on top
        bgImage = preload.getResult("screenImage").result;
        bgBitmap = new createjs.Bitmap(bgImage);
        bgBitmap.scaleX = SCALE_X;
        bgBitmap.scaleY = SCALE_Y;
        stage.addChild(bgBitmap);

        // draw p1 catapult
        p1Image = preload.getResult("redImage").result;
        p1Bitmap = new createjs.Bitmap(p1Image);
        p1Bitmap.scaleX = SCALE_X;
        p1Bitmap.scaleY = SCALE_Y;
        p1Bitmap.x = MARGIN;
        p1Bitmap.y = GROUND_Y - p1Image.height * SCALE_Y;
        stage.addChild(p1Bitmap);

        // draw p2 catapult and flip
        p2Image = preload.getResult("blueImage").result;
        p2Bitmap = new createjs.Bitmap(p2Image);
        p2Bitmap.regX = p2Image.width;
        p2Bitmap.scaleX = -SCALE_X; // flip from right edge
        p2Bitmap.scaleY = SCALE_Y;
        p2Bitmap.x = canvas.width - MARGIN - (p2Image.width * SCALE_X);
        p2Bitmap.y = GROUND_Y - (p2Image.height * SCALE_Y);
        stage.addChild(p2Bitmap);

        // draw the boulder, and hide for the moment
        ammoImage = preload.getResult("ammoImage").result;
        ammoBitmap = new createjs.Bitmap(ammoImage);
        ammoBitmap.scaleX = SCALE_X;
        ammoBitmap.scaleY = SCALE_Y;
        ammoBitmap.visible = false; // hide until fired
        stage.addChild(ammoBitmap);

        // player 1 lives
        p1Lives = new createjs.Text("Lives Left : " + player1Lives, "20px sans-serif", "red");
        p1Lives.scaleX = SCALE_X;
        p1Lives.scaleY = SCALE_Y;
        p1Lives.x = MARGIN;
        p1Lives.y = MARGIN * SCALE_Y;
        stage.addChild(p1Lives);

        //player 2 lives
        p2Lives = new createjs.Text("Lives Left : " + player2Lives, "20px sans-serif", "red");
        p2Lives.scaleX = SCALE_X;
        p2Lives.scaleY = SCALE_Y;
        p2Lives.x = canvas.width - p2Lives.getMeasuredWidth() * SCALE_X - MARGIN;
        p2Lives.y = MARGIN * SCALE_Y;
        stage.addChild(p2Lives);

        // game title
        title = new createjs.Text("Catapult Wars", "30px sans-serif", "black");
        title.scaleX = SCALE_X;
        title.scaleY = SCALE_Y;
        title.x = canvas.width / 2 - (title.getMeasuredWidth() * SCALE_X) / 2
        title.y = 30 * SCALE_Y;
        stage.addChild(title);

        stage.update();
        startGame();
    }

    function startGame()
    {
        Ticker.setInterval(window.requestAnimationFrame);
        Ticker.addListener(gameLoop);
    }

    function gameLoop()
    {
        update();
        draw();
    }

    function update() {
        if (isShotFlying)
        {
            // shot in the air
            ammoBitmap.x += shotVelocity.x;
            ammoBitmap.y += shotVelocity.y;

            shotVelocity.y += GRAVITY; //apply gravity to the y(height) values only, obviously

            if (ammoBitmap.y + ammoBitmap.image.height >= GROUND_Y ||
                ammoBitmap.x <= 0 ||
                ammoBitmap.x + ammoBitmap.image.width >= canvas.width)
            {
                // missed
                isShotFlying = false; //stop shot
                ammoBitmap.visible = false;
                playerTurn = playerTurn % 2 + 1; // invert player ( switch between 1 and 2)
            }
            else if (playerTurn == 1)
            {
                if (checkHit(p2Bitmap)) {
                    // Hit
                    p2Lives.text = "Lives Left : " + --player2Lives;
                    processHit();
                }
            }
            else if (playerTurn == 2)
            {
                if (checkHit(p1Bitmap))
                {
                    // Hit
                    p1Lives.text = "Lives Left : " + --player1Lives;
                    processHit();
                }
            }

        }
            // No current shot, should either player fire ?
        else if (playerTurn == 1)
        {
            // does the player want to fire ?
            if (playerFire)
            {
                playerFire = false;
                ammoBitmap.x = p1Bitmap.x + (p1Bitmap.image.width * SCALE_X / 2);
                ammoBitmap.y = p1Bitmap.y;
                shotVelocity = aimVector;
                 fireShot();

            }
        }
        else if (playerTurn == 2)
        {
            // AI automatically fires (randomly on it's turn)
            ammoBitmap.x = p2Bitmap.x + (p2Bitmap.image.width * SCALE_X / 2);
            ammoBitmap.y = p2Bitmap.y;
            shotVelocity = new createjs.Point(
                Math.random() * (-4 * SCALE_X) - 3,
                Math.random() * (-3 * SCALE_Y) - 1);
            fireShot();
        }

    }

    // triggered by MSPointerDown event
    function beginAim(event)
    {
        if (playerTurn == 1)
        {
            if (!isAiming)
            {
                aimStart = new createjs.Point(event.x, event.y);
                isAiming = true;
            }
        }
    }

    // triggered by MSPointerMove event
    function adjustAim(event)
    {
        if (isAiming)
        {
            var aimCurrent = new createjs.Point(event.x, event.y);
            aimVector = calculateAim(aimStart, aimCurrent);
            // TODO write text and/or show aiming arrow on screen
            Debug.writeln("Aiming..." + aimVector.x + "/" + aimVector.y);
        }
    }

    // triggered by MSPointerUp event
    function endAim(event)
    {
        if (isAiming) {
            isAiming = false;
            var aimCurrent = new createjs.Point(event.x, event.y);
            aimVector = calculateAim(aimStart, aimCurrent);
            playerFire = true;
        }
    }

    function calculateAim(start, end)
    {
        // this only works for player 1
        var aim = new createjs.Point(
            (end.x - start.x) / 80,
            (end.y - start.y) / 80);
        aim.x = Math.min(MAX_SHOT_POWER, aim.x); // cap velocity
        aim.x = Math.max(0, aim.x); // fire forward only
        aim.y = Math.max(-MAX_SHOT_POWER, aim.y);/// cap velocity
        aim.y = Math.min(0, aim.y); // fire up only
        return aim;

    }

    function checkHit(target)
    {
        // EaselJS hit test doesn't factor in scaling
        // so use simple bounding box vs center of rock

        // get centre of rock
        var shotX = ammoBitmap.x + ammoBitmap.image.width / 2;
        var shotY = ammoBitmap.y + ammoBitmap.image.height / 2;

        // return wether center of rock is in rectangle bounding target player
        return (((shotX > target.x) &&
            (shotX <= target.x + (target.image.width * SCALE_X)))
            &&
            ((shotY >= target.y) &&
            (shotY <= target.y + (target.image.height * SCALE_Y))));
    }

    function fireShot()
    {
        playSound(FIRE_SOUND_FILE);
        ammoBitmap.visible = true;
        isShotFlying = true;
    }

    function processHit()
    {
        playSound(EXPLODE_SOUND_FILE);
        isShotFlying = false; // stop shot
        ammoBitmap.visible = false; // hide shot
        playerTurn = playerTurn % 2 + 1; // change player

        if ((player1Lives <= 0) || (player2Lives <= 0)) {
            endGame();
        }
    }

    function endGame()
    {
        Ticker.setPaused(true); // stop game loop

        // show win/lose graphic
        var endGameImage;
        if (player1Lives <= 0)
        {
            playSound(LOSE_SOUND_FILE);
            endGameImage = preload.getResult("loseImage").result;

        }
        else if (player2Lives <= 0)
        {
            endGameImage = preload.getResult("winImage").result;
            playSound(WIN_SOUND_FILE);
        }
        var endGameBitmap = new createjs.Bitmap(endGameImage);
        stage.addChild(endGameBitmap);
        endGameBitmap.x = (canvas.width / 2) - (endGameImage.width * SCALE_X / 2);
        endGameBitmap.y = (canvas.height / 2) - (endGameImage.height * SCALE_Y / 2);
        endGameBitmap.scaleX = SCALE_X;
        endGameBitmap.scaleY = SCALE_Y;
        stage.update();
    }

    function draw() {
        // EaselJS allows for easy updates
        stage.update();
    }

    function playSound(path)
    {
        var sound = document.createElement("audio");
        sound.src = path;
        sound.autoplay = true;
    }

    app.oncheckpoint = function (args) {
        // TODO: This application is about to be suspended. Save any state
        // that needs to persist across suspensions here. You might use the
        // WinJS.Application.sessionState object, which is automatically
        // saved and restored across suspension. If you need to complete an
        // asynchronous operation before your application is suspended, call
        // args.setPromise().
    };

    document.addEventListener("DOMContentLoaded", initialize, false);
    app.start();
})(); 
```

还有一个问题：当我尝试构建这个游戏时，我遇到了这样的错误：

*0x800a01bd - JavaScript 运行时错误：对象不支持此操作*

在我的代码中的标记位置

谢谢你的帮助 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T16:22:58.233

三个问题，我从之前的评论中报告它们：

*   easeljs 不在正确的文件夹中
*   mages/Catapults/Red/redFire/redC‌​atapultFire.png 丢失
*   更改`var stage = new createjs.Stage(canvas);`为`stage = new createjs.Stage(canvas);`您不必实例化教程中报告的该变量（[http://www.sitepoint.com/creating-a-simple-windows-8-game-with-javascript-game-basics-createjseaseljs/](http://www.sitepoint.com/creating-a-simple-windows-8-game-with-javascript-game-basics-createjseaseljs/)）

并关闭这个其他相关问题（[https://stackoverflow.com/a/16101960/975520](https://stackoverflow.com/a/16101960/975520)），我认为可以通过发布您的解决方案作为答案来解决。

# sql-server - 是否可以在当前程序中提交/回滚另一个程序事务

> ID：16120222
> 
> 赞同：0
> 
> 时间：2013-04-20T12:13:56.120
> 
> 标签：sql-server, web-services, sql-server-2008, stored-procedures, transactions

我有两个问题

1.我有两个存储过程。是否可以在我当前的过程中提交/回滚另一个过程的事务。

2.我有两个网络服务两个服务连接到同一个数据库或链接服务器数据库。一个网络服务成功了它的交易。移动到第二个 Web 服务时发生了一些错误。如果发生错误，我必须回滚以前的 Web 服务事务。？可能吗。如果有人解释与 ATM 等银行交易相关的内容

可能吗？如何？解释与银行业有关的几乎没有可理解的编码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-10T16:55:40.327

1.  不，必须从发出开始事务语句的同一连接发出提交。

2.  在这种情况下，您首先需要在数据表中附加一个“事务”字段或类似的东西，以唯一标识每个事务。如果第二个 Web 服务需要发出涉及第一个 Web 服务工作的回滚，它必须调用一个自定义进程，然后发出删除以查找您已构建到表中的事务标识符。db 引擎没有内置的功能来适应这个开箱即用。

# xml - 需要帮助来完成 DTD

> ID：16120223
> 
> 赞同：0
> 
> 时间：2013-04-20T12:13:57.030
> 
> 标签：xml, dtd

这是场景。

[http://img6.imageshack.us/img6/4451/capture1iw.png](http://img6.imageshack.us/img6/4451/capture1iw.png)

我已经为 4 个食谱创建了一个 dtd。但是你可以在咖啡蝴蝶蛋糕和咖啡摩洛哥鸡肉食谱中看到也有糖霜和调味酱的成分。但我不知道如何在我的 dtd 中指出这一点。所以请帮忙我来修改它。谢谢。

这是我的dtd。

```
<!DOCTYPE cookbook[
<!ELEMENT cookbook ( recipe+ ) >
<!ATTLIST recipe xml:id NMTOKEN #REQUIRED >
<!ELEMENT recipe ( title, ingredient+, time, method ) >
<!ATTLIST recipe servings(serves|makes) CDATA #REQUIRED >

<!ELEMENT title ( #PCDATA ) >

<!ELEMENT ingredient EMPTY >
<!ATTLIST ingredient name CDATA #REQUIRED >
<!ATTLIST ingredient quantity CDATA #REQUIRED >
<!ATTLIST ingredient unit(tsp|number|g|oz|tab|ml|pt) #REQUIRED>
<!ATTLIST ingredient brand CDATA #IMPLIED >

<!ELEMENT time EMPTY >
<!ATTLIST time quantity NMTOKEN #REQUIRED >
<!ATTLIST time unit NMTOKEN #REQUIRED >

<!ELEMENT method ( step+ ) >
<!ELEMENT step ( #PCDATA ) >

]> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T05:21:25.747

在我看来，Icing and Sause 的成分“数量”、“单位”和“品牌”不存在。因此，您可以将这些属性放在#IMPLIED 而不是#REQUIRED，或者您可以将这些属性的默认值设置为 N/A

# twitter-bootstrap - 无法在本地使用 jekyll 服务器运行 bootstrap 3

> ID：16120225
> 
> 赞同：3
> 
> 时间：2013-04-20T12:14:08.380
> 
> 标签：twitter-bootstrap, jekyll, twitter-bootstrap-3

我刚刚下载了[twitter bootstrap branch 3.0.0-wip](https://github.com/twitter/bootstrap/tree/3.0.0-wip)，编译时收到错误消息。

我还下载了[jekyll-boilerplate](https://github.com/necolas/jekyll-boilerplate)，它使用`jekyll server`.

难道我做错了什么？

**执行的命令：**

```
D:\Zain\github\bootstrap\source>jekyll --server 
```

**收到错误：**

```
Configuration from D:/Zain/github/bootstrap/source/_config.yml
Building site: ./docs -> ./_gh_pages
Liquid Exception: wrong number of arguments (1 for 0) in docs.html
C:/Ruby200/lib/ruby/gems/2.0.0/gems/yajl-ruby-1.1.0-x86-mingw32/lib/yajl.rb:72:in 'initialize'
C:/Ruby200/lib/ruby/gems/2.0.0/gems/yajl-ruby-1.1.0-x86-mingw32/lib/yajl.rb:72:in 'new'
C:/Ruby200/lib/ruby/gems/2.0.0/gems/yajl-ruby-1.1.0-x86-mingw32/lib/yajl.rb:72:in 'encode'
C:/Ruby200/lib/ruby/gems/2.0.0/gems/yajl-ruby-1.1.0-x86-mingw32/lib/yajl.rb:22:in 'dump'
C:/Ruby200/lib/ruby/gems/2.0.0/gems/pygments.rb-0.3.7/lib/pygments/popen.rb:225:in 'block in mentos'
C:/Ruby200/lib/ruby/2.0.0/timeout.rb:65:in 'timeout'
C:/Ruby200/lib/ruby/gems/2.0.0/gems/pygments.rb-0.3.7/lib/pygments/popen.rb:209:in 'mentos'
C:/Ruby200/lib/ruby/gems/2.0.0/gems/pygments.rb-0.3.7/lib/pygments/popen.rb:192:in 'highlight'
C:/Ruby200/lib/ruby/gems/2.0.0/gems/jekyll-0.12.1/lib/jekyll/tags/highlight.rb:54:in 'render_pygments'
C:/Ruby200/lib/ruby/gems/2.0.0/gems/jekyll-0.12.1/lib/jekyll/tags/highlight.rb:44:in 'render'
C:/Ruby200/lib/ruby/gems/2.0.0/gems/liquid-2.5.0/lib/liquid/block.rb:106:in 'block in render_all'
C:/Ruby200/lib/ruby/gems/2.0.0/gems/liquid-2.5.0/lib/liquid/block.rb:93:in 'each'
C:/Ruby200/lib/ruby/gems/2.0.0/gems/liquid-2.5.0/lib/liquid/block.rb:93:in 'render_all'
C:/Ruby200/lib/ruby/gems/2.0.0/gems/liquid-2.5.0/lib/liquid/block.rb:82:in 'render'
C:/Ruby200/lib/ruby/gems/2.0.0/gems/liquid-2.5.0/lib/liquid/template.rb:124:in 'render'
C:/Ruby200/lib/ruby/gems/2.0.0/gems/liquid-2.5.0/lib/liquid/template.rb:132:in 'render!'
C:/Ruby200/lib/ruby/gems/2.0.0/gems/jekyll-0.12.1/lib/jekyll/convertible.rb:79:in 'do_layout'
C:/Ruby200/lib/ruby/gems/2.0.0/gems/jekyll-0.12.1/lib/jekyll/page.rb:100:in 'render'
C:/Ruby200/lib/ruby/gems/2.0.0/gems/jekyll-0.12.1/lib/jekyll/site.rb:204:in 'block in render'
C:/Ruby200/lib/ruby/gems/2.0.0/gems/jekyll-0.12.1/lib/jekyll/site.rb:203:in 'each'
C:/Ruby200/lib/ruby/gems/2.0.0/gems/jekyll-0.12.1/lib/jekyll/site.rb:203:in 'render'
C:/Ruby200/lib/ruby/gems/2.0.0/gems/jekyll-0.12.1/lib/jekyll/site.rb:41:in 'process'
C:/Ruby200/lib/ruby/gems/2.0.0/gems/jekyll-0.12.1/bin/jekyll:264:in '<top (required)>'
C:/Ruby200/bin/jekyll:23:in 'load'
C:/Ruby200/bin/jekyll:23:in '<main>'
Build Failed 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-03-19T11:35:55.343

`Update: For Bootstrap version 3.3.4`

为了在`Twitter Bootstrap(v3.3.4)`本地运行文档，我执行了以下步骤，希望它可以帮助其他人。

**脚步：**

*   `gem install jekyll`（需要`Ruby`，`Rubygems`安装）
*   `git clone --branch gh-pages git://github.com/twitter/bootstrap.git`

    （现在`gh-pages`分支包含所有文档的东西）

*   `cd bootstrap`
*   `jekyll serve`
*   访问`http://127.0.0.1:4000/`默认服务器 url

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T10:52:43.670

它接缝，它不适用于 jekyll 2.0。尝试像 1.9.3 这样的旧版本。看：

[http://groups.google.com/forum/#!topic/rubyinstaller/yEuPjlPlMao](http://groups.google.com/forum/#!topic/rubyinstaller/yEuPjlPlMao)

**更新：**

我找到了一个描述 jekyll for windows 安装的页面，请看这里：

[http://www.madhur.co.in/blog/2011/09/01/runningjekyllwindows.html](http://www.madhur.co.in/blog/2011/09/01/runningjekyllwindows.html)

**更新 2：**

现在有一个 GitHub 项目：

[https://github.com/juthilo/run-jekyll-on-windows](https://github.com/juthilo/run-jekyll-on-windows)

> 该存储库旨在为 Windows 用户提供成功运行 Jekyll 的说明 - 不仅在创建 Jekyll 时，而且希望在未来通用解决方案再次过时时也如此。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-30T08:37:05.673

如果你想要关于 Bootstrap 3 的所有文档并且你不想安装 Jekyll，那么使用 httrack 到 windows 并保存你想要的页面。在 Youtube 上搜索该程序。

# jquery - jquery - 让 gps 脚本运行一次，不需要停止和开始按钮

> ID：16120226
> 
> 赞同：2
> 
> 时间：2013-04-20T12:14:09.880
> 
> 标签：jquery, mysql, geolocation

我是新来的，所以很好。我希望这个 gps 跟踪器在加载页面“gps.php”时自动向我的 mysql 数据库中写入一个单独的条目，如果你按下开始按钮，然后按下停止按钮，我就会得到这个工作。我想完全摆脱这些按钮，只需运行一次这个 jquery 脚本，然后向 mysql 表输入一次注入。

所有代码都在这里[http://cdpn.io/qkEvA](http://cdpn.io/qkEvA)

请您帮忙，我一直在为 WEEKS 苦苦挣扎（我不是程序员这个职业；）

```
$(document).ready(function() {

// how often should we send location data? in seconds
var sendInterval = 0.9;

var runnerId;
while (!runnerId){
    runnerId = prompt("Enter your album name:", "");
}
var intervalId;
var watchId;
var index = 0;

var formData = {};

$("#status p").text("Not tracking");
$('#start').on("click", startTrack);
$('#stop').on("click", stopTrack);

function startTrack(){
    if(navigator.geolocation){
        watchId = navigator.geolocation.watchPosition(geo_success, errorHandler,
        {enableHighAccuracy:true, maximumAge:30000, timeout:27000});
    }
    else{
        alert("Sorry, device does not support geolocation! Update your browser.");
    }
}

function stopTrack(){
    clearInterval(intervalId);
    navigator.geolocation.clearWatch(watchId);
    index = 0;
    $("#status p").text("Not tracking").removeClass("active").addClass("stopped");
    $("#start").removeAttr("disabled");
    $("#stop").attr("disabled", "disabled");
}

function geo_success(position){
    $("#status p").text("Tracking     active").removeClass("stopped").addClass("active");
    $("#start").attr("disabled", "disabled");
    $("#stop").removeAttr("disabled");

    lat = position.coords.latitude;
    lon = position.coords.longitude;

    formData.lat=lat;
    formData.lon=lon;

    if(index === 0){
        intervalId = setInterval(postData, sendInterval*1000);
    }

    index++;
}

function addTime(){
    // insert time in formData-object
    var d = new Date();
    var d_utc = ISODateString(d);

    formData.time=d_utc;

    // date to ISO 8601,
    // developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Date#Example.3a_ISO_8601_formatted_dates

function ISODateString(d){
        function pad(n){return n<10 ? '0'+n : n}
        return d.getUTCFullYear()+'-'
        + pad(d.getUTCMonth()+1)+'-'
        + pad(d.getUTCDate())+'D'
        + pad(d.getUTCHours()+2)+':'
        + pad(d.getUTCMinutes())+':'
        + pad(d.getUTCSeconds())+'T'
    }
}

function postData(){
    addTime();

    $.ajax({
        type:   'POST',
        url:    'save.php?file='+runnerId,
        data:   formData,
        async:  false,
    });
}

function errorHandler(err){ 
    if(err.code == 1) {
        alert("Error: Access was denied");
    }
    else if(err.code == 2) {
        alert("Error: Position is unavailable");
    }
}
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-30T08:31:54.970

如果您想在页面加载后立即开始跟踪并在页面关闭之前停止堆叠，您应该在代码中替换为：

```
$('#start').on("click", startTrack);
$('#stop').on("click", stopTrack); 
```

对此：

```
startTrack();
$( window ).on( 'unload', stopTrack ); 
```

并将此代码移动到`startTrack`函数定义下。

# javascript - 使用箭头键悬停

> ID：16120229
> 
> 赞同：1
> 
> 时间：2013-04-20T12:14:23.097
> 
> 标签：javascript, jquery, css, cross-browser

在我的项目中，我正在向元素`li`动态添加标签`ul`，然后当焦点位于`textarea`元素上时，我试图`li`在用户按下时在第一个元素上生成悬停效果`down arrow key`。不知何故，我的努力没有奏效。

我到目前为止尝试的代码如下：

[JS小提琴](http://jsfiddle.net/5hsCj/)

**HTML**

```
<textarea id="result" rows="4" cols="50"></textarea>
<ul class="autoComplete"></ul> 
```

* * *

**CSS**

```
.autoComplete li {
    background-color:#E1E1E1;
    cursor: hand;
    cursor: pointer;
}
.autoComplete li:hover {
    background-color:#BDBDBD;
} 
```

* * *

**js**

```
var result = $('#result');
var autoComplete = $('.autoComplete');
result.keydown(function (event) {
    if (event.keyCode == 40) {
        if (autoComplete.children('li').length > 0) {
            console.log('down');

            //should work with IE
            autoComplete.children(":first").focus().hover();
        }
    }
}); 
```

PS：**解决方案应该是跨浏览器（IE8+）**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T12:21:36.197

尝试

CSS

```
.autoComplete li {
    background-color:#E1E1E1;
    cursor: hand;
    cursor: pointer;
}
.autoComplete li.hover {
    background-color:#BDBDBD;
} 
```

JS

```
var result = $('#result');
var autoComplete = $('.autoComplete');
result.keyup(function (event) {
    console.log('keydown');
    if (event.keyCode == 40) {
        if (autoComplete.children('li').length > 0) {
            console.log('down');

            //should work with IE
            autoComplete.children(":first").mouseenter();
        }
    }
});

autoComplete.on('mouseenter', 'li', function(){
    $(this).addClass('hover');
}).on('mouseleave', 'li', function(){
    $(this).removeClass('hover');
}); 
```

演示：[小提琴](http://jsfiddle.net/arunpjohny/gb6Ws/2/)

# c++ - 为什么使用`XGetInputFocus`导致分段错误？

> ID：16120230
> 
> 赞同：2
> 
> 时间：2013-04-20T12:14:30.663
> 
> 标签：c++, c

* * *

```
Display *display;
display = XOpenDisplay(NULL);
Window window;
XGetInputFocus(display, &window, RevertToNone); 
```

* * *

在 XGetInputFocus 发生分段错误；哪里不对了 ？（程序用 xlib 编译，编译没有任何问题）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T13:47:33.623

`int revert; XGetInputFocus(display, &window, &revert);`应该修复它。

# android - 如何在 android asynctask 中使用 inputstream 作为参数？

> ID：16120234
> 
> 赞同：2
> 
> 时间：2013-04-20T12:14:37.837
> 
> 标签：android, android-asynctask

我正在制作一个 android 应用程序来跟踪股票详细信息，我将通过 csv（雅虎财经）检索数据。据我所知，在 android 4.0 中，无法在主线程上进行网络连接。因此，我将使用 asynctask 来建立连接。但是，我在参数方面遇到了一些问题。请问输入流类型可以作为参数使用吗？

```
public class StockDetails extends Activity {
    private InputStream is = null;
    private BufferedReader reader = null;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.stock_details);
        Intent i = getIntent();
        String stockNo = i.getStringExtra(MainActivity.STOCK_NO).toString();
        Log.i("Stock No", stockNo);
        String strURL = "http://download.finance.yahoo.com/d/quotes.csv?s="+ stockNo +".HK&f=nsl1opc1";
        Log.i("URL", strURL);
        class HostConnection extends AsyncTask<String, Void, InputStream> {
            private Exception ex;

            @Override
            protected void onPreExecute() {
                super.onPreExecute();
            }

            protected InputStream doInBackground(String... urls) {
                try {
                    // defaultHttpClient
                    DefaultHttpClient httpClient = new DefaultHttpClient();
                    HttpGet httpGet = new HttpGet(urls[0]);
                    HttpContext localContext = new BasicHttpContext();
                    HttpResponse httpResponse = httpClient.execute(httpGet, localContext);
                    HttpEntity httpEntity = httpResponse.getEntity();
                    return httpEntity.getContent();
                } catch (Exception e) {
                    this.ex = e;
                    return null;
                } 
            }
            @Override
            protected void onPostExecute(InputStream is) {
                super.onPostExecute(is);
                reader = new BufferedReader(new InputStreamReader(is));
            }
        }
        new HostConnection().execute(strURL);
        try {
            String line;
            while ((line = reader.readLine()) != null){
                String[] RowData = line.split(",");
                String name = RowData[0];
                String symbol = RowData[1];
                String currPrice = RowData[2];
                String open = RowData[3];
                String prevClose = RowData[4];
                String change = RowData[5];

                TextView stockName = (TextView)findViewById(R.id.stockName);
                stockName.setText(name);
                TextView stockSymbol = (TextView)findViewById(R.id.stockSym);
                stockSymbol.setText(symbol);
                TextView stockCurrPrice = (TextView)findViewById(R.id.currPrice);
                stockCurrPrice.setText(currPrice);
                TextView stockOpen = (TextView)findViewById(R.id.open);
                stockOpen.setText(open);
                TextView stockPrevClose = (TextView)findViewById(R.id.prevClose);
                stockPrevClose.setText(prevClose);
                TextView stockChange = (TextView)findViewById(R.id.change);
                stockChange.setText(change);
            }
        } catch (IOException ex) {
            ex.printStackTrace();
        } finally {
            try {
                is.close();
            } catch (IOException e) {
                e.printStackTrace();
            }
        }
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        ...
    }

} 
```

以上是我的代码，它无法执行语句`return httpEntity.getContent();`并跳转到异常部分。请帮忙。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T12:22:44.377

作为 Result 值类型使用`InputStream`是完全合法的，以及任何其他类。但是你必须知道 an 是`AsyncTask`异步执行的，所以如果你调用`new HostConnection().execute(strURL);`然后立即尝试使用在内部初始化的变量`AsyncTask`，你会遇到麻烦。`AsyncTask`您应该通过定义某种回调机制来等待完成其​​执行，或者在您的情况下，由于`AsyncTask`是一个内部类，您可以只推送`BufferedReader`与`onPostExecute()`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T12:46:41.300

如果您不想等待读取整个输入流，直到`onPostExecute`调用 read it in `doInBackground`。

当您读取重要结果时，通过实现将其发送回 UI 线程，[`onProgressUpdate`](http://developer.android.com/reference/android/os/AsyncTask.html#onProgressUpdate%28Progress...%29)但您可能应该`InputStream`在后台线程中处理并且不将其作为结果返回，因为您可能会遇到缓冲问题。

# html - 为什么默认选择的选项不受溢出影响：隐藏？

> ID：16120235
> 
> 赞同：7
> 
> 时间：2013-04-20T12:14:38.103
> 
> 标签：html, css

对于初学者，请检查此小提琴-> [http://jsfiddle.net/xV4s3/](http://jsfiddle.net/xV4s3/)

正如你所看到的，我们有一个包装器，`overflow: hidden`里面有一个`select`带有三个选项的 native 和一个`ul`样式，看起来像一个包含三个项目的 select。
现在，当您单击 ul 时，您可以看到它的高度变化（由于脚本），但由于`overflow: hidden`. 这按预期工作。

我的问题是关于 default`select`的选项，因为我在规范中找不到任何内容。
为什么他们不受影响`overflow: hidden`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T12:31:26.633

这可能只是一个实现细节。CSS2.1 关于[溢出控制](http://www.w3.org/TR/CSS21/visufx.html)的唯一内容是该`overflow`属性根据应用该属性的包含块来控制内容的溢出。它没有定义表单元素的行为和呈现等与此属性相关的内容。

正如我评论的那样，很明显下拉菜单不是作为包装器的后代创建的，甚至不是`select`元素。事实上，大多数浏览器可能会选择完全独立于画布并作为应用程序级别或系统级别的 UI 元素来呈现它（可能是出于可用性原因）。请注意，虽然您可以将 CSS 应用于`option`元素以影响下拉菜单的显示方式，但您实际上无法设置下拉菜单本身的样式。

# html - HTML 单选按钮和 Servlet

> ID：16120238
> 
> 赞同：3
> 
> 时间：2013-04-20T12:14:51.280
> 
> 标签：html, forms, servlets, input

我想显示一个网页[索引页面]，其中包含 3 个选项来选择汽车。可以通过单选按钮或文本框选择汽车。

选择特定的汽车时，Servlet应响应显示用户选择的客户端。此外，servlet 应该计算所选汽车的价格。但现在，我不谈价格，只是在浏览器上显示用户的选择。

我收到错误类型状态报告消息 /carShop/tish.com.CarServlet2 描述 请求的资源 (/carShop/tish.com.CarServlet2) 不可用。可能出了什么问题：-

```
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">

<TITLE> Welcome to CarShop </TITLE> 
</HEAD> 

<BODY> 

<FORM Action = "tish.com.CarServlet2"  METHOD=POST> 

<BR>Select a Type of Car:<BR> 

Brand <INPUT TYPE=text NAME="Brand" > <br>

Year <INPUT TYPE=text NAME="Year" > <br> 

<input type="checkbox" name="car" value="honda">Honda<br>
<input type="checkbox" name="car" value="nissan">Nissan<br>

<INPUT TYPE= SUBMIT NAME= "Submit " Value = "Submit the Selection">
<br>
<INPUT TYPE= RESET NAME = "RESET" Value = "Reset">

</FORM> 
</BODY>
</HTML> 
```

小服务程序：-

```
package tish.com;

import java.io.IOException;
import java.io.PrintWriter;

import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class CarServlet2 extends HttpServlet {
    private static final long serialVersionUID = 1L;

    protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {

        System.out.println("Testing my Car Sevlet");
        //System.out.println(arg0.getInitParameter("Year"));
        //config =arg0;

                String [] car = req.getParameterValues("car");

                PrintWriter writer = resp.getWriter();

            resp.setContentType("text/html");
            writer.print("<html> <body>");
            writer.print("<hl> Your choice is </hl>");

            for (String s: car)
            {

                writer.print("<l1>" + s+ "/l1>");

            }
            writer.print("</body></html> ");
            }   

    } 
```

网页.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd" id="WebApp_ID" version="3.0">

  <welcome-file-list>
    <welcome-file>index.html</welcome-file>
    <welcome-file>index.htm</welcome-file>
    <welcome-file>index.jsp</welcome-file>
    <welcome-file>Welcome.html</welcome-file>
    <welcome-file>default.htm</welcome-file>
    <welcome-file>default.jsp</welcome-file>
  </welcome-file-list>

  <servlet-mapping>
    <servlet-name>CarServlet2</servlet-name>
    <url-pattern>/CarServlet2</url-pattern>
  </servlet-mapping>

  <servlet>
    <servlet-name>CarServlet2</servlet-name>
    <servlet-class>tish.com.CarServlet2</servlet-class>
  </servlet>

</web-app> 
```

文件目录设置：

carShop/tish/com.CarServlet2

请帮助我理解我做错了什么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T12:21:32.520

您将 servlet 映射到 URL 模式`/CarServlet2`：

```
<servlet-mapping>
    <servlet-name>CarServlet2</servlet-name>
    <url-pattern>/CarServlet2</url-pattern>
</servlet-mapping> 
```

所以它被映射到绝对 URL `/carShop/CarServlet2`（因为`/carShop`是你的 webapp 的上下文路径）。

但是，在您的 servlet 中，您使用相对 URL `tish.com.CarServlet2`，解析为绝对 URL `/carShop/tish.com.CarServlet2`，这显然不是 servlet 映射到的 URL。您应该改用相对 URL `CarServlet2`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-06T08:40:58.797

在您的 .html 页面中，查看您给出的操作。只是让它的名字。我想在你这样做之后，它会好的.. 即 action="./CarServlet2" 而不是 action="tish.com.CarServlet2"。

# jboss7.x - Arquillian 中所有测试用例的单一部署

> ID：16120240
> 
> 赞同：21
> 
> 时间：2013-04-20T12:15:19.407
> 
> 标签：jboss7.x, jboss-arquillian

我们正在使用 arquillian-junit-container 1.0.0 最终版本进行 Junit 测试。

我们有这么多的测试类和每个测试类作为@Deployment 方法，所以当我一起运行所有测试时，它会产生内存和性能问题。

任何人都可以通过告诉我们如何避免每个类的多次部署来帮助我解决这个问题。我们如何在 Arquillian 中实现所有测试用例的单一部署？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2014-09-18T09:16:50.193

你还不能，正式地。

创建JIRA 问题[ARQ-197](http://issues.jboss.org/browse/ARQ-197)是为了支持针对单个部署运行多个测试类。**在2010年！**如果您想要此功能，请为它投票。

这是 Arquillian 投票最多的问题。它目前定于 2.0.0.CR1 版本，可能是下一个版本，但我在任何地方都找不到可以证实这一点的路线图/发布计划。

与此同时，还有 Arquillian Suite Extension（最新版本在[这里](http://github.com/ingwarsw/arquillian-suite-extension)）。它不是官方的，因此存在限制，但原始代码库是由 Arquillian 核心开发人员之一编写的，以证明他们最终可以支持 JUnit 套件。让这个支持成为官方的问题就[在这里](https://issues.jboss.org/browse/ARQ-567)，是 Arquillian 投票第二多的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-08T19:32:47.820

我想你是在问为什么 Arquillian 需要在运行测试时为每个测试类部署新的战争。我有 Petr Mensik 描述的部署方法，但是当您运行测试时，每个测试类仍将部署在它自己的战争中。将它放在超类中只会从更少的行的角度简化代码。这将意味着作为子类的每个测试类都将具有相同的部署。这意味着您的部署将是超级依赖集，因此比单独部署要大得多。我认为它更容易管理，而且物有所值，尤其是对于大型项目。

要回答您的问题，您似乎无法对测试进行分组并部署一场战争来进行测试，直到 2.0 版（今年年底到期？）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-22T06:28:51.087

为什么你应该在每个类中都有部署方法？我使用 Arquillian 对 Drone 和 Graphene 进行功能测试，我有一个带有部署方法的基类，Selenium Web 驱动程序的初始化，很少的 utils 方法，我的每个其他测试类都只是扩展这个类并重用我的 Web Driver 实例。

我不明白为什么这不适用于您的情况（甚至不扩展基类）。

好的，这就是它的外观

```
public class WebDriverTest extends Arquillian { //I am using TestNG

    @Drone
    protected WebDriver driver;

    @ArquillianResource
    private URL contextRoot;

    @Deployment(testable = false) //functional tests cannot run in container
    public static WebArchive createDeployment() {
        File archive = new File("target/myApp.war");
        ShrinkWrap.createFromZipFile(WebArchive.class, archive);
    }
}

public class TestClass extends WebDriverTest {

    @Test
    public void test1() {}

    @Test
    public void test2() {}
} 
```

这里一切正常。还要确保您有正确的 Maven 依赖项，这些依赖项必须存在才能运行功能测试（然后从这些 BOM 中为您需要的任何内容创建依赖项）

```
<dependencyManagement>
    <dependencies>
        <dependency>
            <groupId>org.jboss.arquillian.selenium</groupId>
            <artifactId>selenium-bom</artifactId>
            <version>${selenium.version}</version>
            <type>pom</type>
            <scope>import</scope>
        </dependency>
        <dependency>
            <groupId>org.jboss.arquillian</groupId>
            <artifactId>arquillian-bom</artifactId>
            <version>${arquillian-core.version}</version>
            <type>pom</type>
            <scope>import</scope>
        </dependency>
        <dependency>
            <groupId>org.jboss.arquillian.extension</groupId>
            <artifactId>arquillian-drone-bom</artifactId>
            <version>${arquillian-drone.version}</version>
            <type>pom</type>
            <scope>import</scope>
        </dependency>
    </dependencies>
</dependencyManagement> 
```

**编辑**

好的，所以根据这个[JIRA](https://issues.jboss.org/browse/ARQ-197)，你不会在 Arquillian 中看到这个功能，直到版本 2.0.0.CR1。所以我上面提到的代码是你现在能得到的最好的:-)

# java - Java - 在对象上调用 wait()，然后允许对象访问方法

> ID：16120248
> 
> 赞同：3
> 
> 时间：2013-04-20T12:16:26.217
> 
> 标签：java, multithreading, concurrency, wait

我有这个方法，它将线程作为参数。我希望这个方法能够让一个线程等待，如果没有一个线程等待，然后在另一个线程进入该方法时唤醒，以便它们两个可以交互。我想我已经接近了，但是在第一个线程上调用 wait() 之后，没有其他线程可以访问该方法。这是我的代码的极简版本：

```
// In the class 'Node'
public synchronized void trade(Thread thread)
{
    if (!threadWaiting)
    {
        threadWaiting = true;
        synchronized(thread)
        {
             try {
                 thread.wait();
             } catch (InterruptedException e) {...}
        }
    }
} 
```

我为遗漏任何明显的东西而道歉，我一直在寻找答案，但我是线程新手，所以我不知道要寻找什么。

所以我的问题是，当另一个线程试图进入 trade() 他们不能时，调试器就停在那里。

编辑：这是我要问的更多说明。恐怕我在原始帖子中不太清楚。

所以我有一个名为 Node 的类和另一个名为 Bot 的类。Bot 扩展线程以便它可以暂停。在程序开始时，会创建多个 Bot 对象并启动，然后每个 Bot 将调用 Node 的 trade() 方法并将自身传递给该方法。如果 Bot 是方法中的第一个，那么我希望它的线程在节点上等待，直到另一个 Bot 出现（等待的 Bot 将存储在节点中），此时两个 Bot 将交互。下面是我的伪代码方法的更清晰示例：

```
// Variable to hold the bot that is waiting.
private Bot waitingBot = null;
// Method belonging to Node.
public synchronized void trade(Bot currentBot)
{
    if (waitingBot == null)
    {
        waitingBot = currentBot;
        waitingBot.wait();
    }
    else
    {
        currentBot.interactWith(waitingBot);
        waitingBot.notify();
        waitingBot = null;
    }
} 
```

对不起，我原来的帖子的措辞。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T12:24:51.603

您的实现存在缺陷。您正在锁定传递的参数，这对于所有线程都是不同的，因此它们无法与等待通知交互。

编辑：我不确定您的目标到底是什么，但根据详细信息，这可能会有所帮助：EDIT2：添加了 lock()

```
private final Lock lck = new ReentrantLock();
private final Condition cnd = lck.newCondition();
private final AtomicBoolean threadwaiting = new AtomicBoolean(false);

public synchronized void trade(Thread thread)
{
    lck.lock();
    try{
    if(threadwaiting.get()){
      cnd.signalAll();
      threadwaiting.set(false);
      //perform your task
    }else{
      cnd.await();
      threadwaiting.set(true);
    }
    }
    } finally {
   lck.unlock()
 }

} 
```

编辑：查看您更新的帖子，您应该使用计数为 2 的 cyclicbarrier ，那么这应该可以为您解决所有问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T12:49:03.530

这是一个死锁，因为当你调用`thread.wait();`你释放线程对象锁。但是`this`同步方法上的对象锁定仍然存在，这就是为什么其他人无法进入它的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T12:29:56.473

类似于 loki 的代码，但有所改进

```
private final Lock lock = new ReentrantLock();
private final Condition cnd = lock.newCondition();
private final AtomicBoolean threadwaiting = new AtomicBoolean(false);

public void trade(Thread thread) {
    lock.lock();

    if (threadwaiting.get()) {
        cnd.signalAll();
        lock.unlock();
        // perform your task of second thread
    } else {
        threadwaiting.set(true);
        try {
            cnd.await();
            // perform your task of first thread
        } catch (InterruptedException e) {
        } finally {
            threadwaiting.set(false);
            lock.unlock();
        }
    }
} 
```

# c# - Linq to SQL - 按问题排序

> ID：16120251
> 
> 赞同：1
> 
> 时间：2013-04-20T12:16:36.943
> 
> 标签：c#, sql, linq

另一个分配块！

基本上问题是我不能让我的输出按降序排列价格，同时保持按国家分组。

我知道这可能很简单，但我似乎无法理解。

有什么解决办法吗？

谢谢！

这是问题：“6\. 允许用户按国家/地区降序查看销量前五的产品。（10 分）”

这是我的代码：

```
void MainWindow_Loaded(object sender, RoutedEventArgs e)
    {
        var q6 = (from t in northwind.Products
                 orderby t.UnitPrice descending
                 join o in northwind.Suppliers on t.SupplierID equals o.SupplierID
                 group t.UnitPrice by new {o.Country, t.UnitPrice} into grouped
                 select new
                 {
                     Output = grouped.Key

                 }).Take(5);                

        lbxTop5.ItemsSource = q6;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-21T05:04:06.487

> “6\. 允许用户按国家/地区降序查看销量前五的产品。（10分）”

我可以通过两种方式阅读。

A) 获取销量前五的产品，按国家/地区对这 5 种产品进行分组。或 B) 对于每个国家/地区，最畅销的五种产品是什么？

我认为B更有意义，所以我会做那个。

另外——什么是最畅销的产品？这个国家和它有什么关系？我认为客户的国家比供应商的国家更重要。另外 - 我认为 OrderDetails 中的 Quantity 可以告诉我哪些产品最畅销。注意：你的导师可能有其他想法，所以使用这些假设后果自负。

```
from c in northwind.Customers
from o in c.Orders  //all froms except first are calls to SelectMany (one to many)
from od in o.OrderDetails //navigational properties -> no need to write explicit joins
let p = od.Product  // now we go many to one, so we don't need SelectMany
group od
  by new {c.Country, Product = p }   //anon grouping key
  into productGroup
let country = productGroup.Key.Country
let product = productGroup.Key.Product
let quantity = productGroup.Sum(od2 => od2.Quantity)
group new {Product = product, Quantity = quantity} //anon group elements
  by country
  into countryGroup
select new {
  Country = countryGroup.Key,
  Summaries = countryGroup
    .OrderByDescending(summary => summary.Quantity)
    .ThenBy(summary => summary.Product.ProductId) //tiebreaker
    .Take(5)
    .ToList()
} 
```

# f# - 数组中值的 24 个平均值，基于它们所处的时间

> ID：16120253
> 
> 赞同：1
> 
> 时间：2013-04-20T12:16:43.660
> 
> 标签：f#

我有一条记录，其中包含一个 DateTime 数组和 2 个长度相同且按索引相关的双精度数组。

我想获得基于 DateTime 小时的 2 个双精度数组之间增量的平均值。所以我最终会有24个平均值。数组索引 0 中的所有数据都是相关的/同时发生，对于所有索引，依此类推。也许我应该有 1 个元组或记录数组，每个数组只包含一个日期时间和 2 个双精度数。

但无论如何，这就是我到目前为止所拥有的：

```
let data2 = [ for i in 0..data.Date.Length-1 do
                                    yield data.Date.[i].Hour, data.High.[i] - data.Low.[i]] 
```

这是我缺乏经验的最痛苦的地方。我唯一能想到的就是做某种匹配或 if 语句通过所有这些 24 小时 (0 - 23) 并且每个小时都有单独的可变值。必须有更简单的方法。到目前为止，我一直没有成功找到方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T12:19:16.900

我想你想做

```
let grouped = data2 |> Seq.GroupBy (fst) |> Seq.map (fun (a,b) -> Seq.average (b |> Seq.map (snd))) 
```

这里`Seq.groupBy`将对具有相同第一个元素的所有元素进行分组。然后你可以用 取平均值`Seq.average`。

笔记：

我认为您对 data2 的原始表达式最好写为

```
data.Date |> Array.mapi (fun i t -> t.Hour,data.High.[i]-data.Low.[i]) 
```

# xml - ASP 编辑 config.xml 位置

> ID：16120257
> 
> 赞同：1
> 
> 时间：2013-04-20T12:17:02.360
> 
> 标签：xml, config

我最近接管了一个网站，并将文件夹组织得如此之远，以至于我的所有内容都没有按顺序排列，但我设法改变了这一点。但是其中一个 asp 页面在根文件夹中找不到 config.xml。

错误代码： `Unable to load config file: 'The system cannot locate the object specified. ' (-2146697210)`

我想我已经确定了 .asp 文件中用于查找和加载配置的代码，但我不知道如何更改它以将其指向配置文件的新位置：

`公共子加载 DefaultXML

```
 If IsNull(stPath) Then
        stPath = Server.MapPath("/")
        stPath = Left(stPath, InstrRev(stPath,"\", Len(stPath)-2))   & "config.xml"
    End If
    LoadXML stPath  
End Sub 
```

我发现了一个与我有相同错误但功能不同的帖子，该帖子的解决方案是从以下位置安装最新的 msxml6.dll：http: [//www.microsoft.com/en-gb/download/details。 aspx?id=6276](http://www.microsoft.com/en-gb/download/details.aspx?id=6276)

现在，当我刷新时，我只是得到一个白屏，没有加载任何内容，也没有显示错误。

任何帮助都会非常好！赞赏！

谢谢！

# ruby - 比较 Ruby 中的两个数组

> ID：16120259
> 
> 赞同：5
> 
> 时间：2013-04-20T12:17:15.830
> 
> 标签：ruby

我想知道两个 Ruby 数组是否具有相同的元素，尽管不一定顺序相同。有没有本地方法可以做到这一点？Array 的相等运算符似乎检查项目是否相同，顺序是否相同，我需要放宽后一个条件。

这将非常容易编写，我只是想知道是否有本地成语。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-20T13:51:56.397

如果您也没有重复的项目，您可以使用[`Set`](http://www.ruby-doc.org/stdlib-2.0/libdoc/set/rdoc/Set.html)而不是`Array`：

> Set 实现了一组无重复的无序值。这是 Array 的直观互操作设施和 Hash 的快速查找的混合体。

例子：

```
require 'set'
s1 = Set.new [1, 2, 3]   # -> #<Set: {1, 2, 3}>
s2 = [3, 2, 1].to_set    # -> #<Set: {3, 2, 1}>
s1 == s2                 # -> true 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-20T12:30:52.703

```
[2,1].uniq.sort == [1,2].uniq.sort #=> true
[2,1,4].uniq.sort == [1,2].uniq.sort #=> false 
```

或者

```
a1 = [1,2,3]
a2 = [2,3,1]
p (a2-a1).empty? && (a1-a2).empty? #=> true

a1 = [1,2,3]
a2 = [4,3,1]
p (a2-a1).empty? && (a1-a2).empty? #=> false

a1 = [1,2,3]
a2 = [2,3,1,5]
p (a2-a1).empty? && (a1-a2).empty? #=> false 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-04-20T12:39:33.580

> 这将非常容易编写，我只是想知道是否有本地成语。

恐怕没有本地成语。

如果您的数组包含多个您想在两个数组上都计数的值，则必须使用[#sort](http://ruby-doc.org/core-2.0/Array.html#method-i-sort)将它们按相同的顺序排列。完成后，您可以轻松地比较它们：

```
a.sort == b.sort 
```

否则，您可以使用[#uniq](http://ruby-doc.org/core-2.0/Array.html#method-i-uniq)来提取数组的唯一值（以使其*更快*）并像上面一样使用[#sort](http://ruby-doc.org/core-2.0/Array.html#method-i-sort)：

```
a.uniq.sort == b.uniq.sort 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-20T19:19:30.847

```
a1 = [1, 2, 3, 4]
a2 = [4, 2, 1, 3]
(a1 & a2).size == a1.size # => true

a3 = [1, 2, 3, 5]
(a1 & a3).size == a1.size # => false 
```

# java - 在 Windows XP 上获取 Apppath

> ID：16120260
> 
> 赞同：2
> 
> 时间：2013-04-20T12:17:26.427
> 
> 标签：java, windows

使用以下代码，我想显示我的程序的位置：

```
 String myPath =  getClass().getProtectionDomain().getCodeSource().getLocation().getPath(); 
```

在 Windows 7 上它运行良好，所以我得到以下结果：

```
C:/Users/Admin/... 
```

但我的问题是 Windows XP。我得到以下网址：

```
C:/Dokumente%20und%20Einstellungen/Admin/... 
```

如何`%20`在代码中替换它？！

这不起作用：`myPath.replaceAll("%20"," ")`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T12:18:35.853

```
myPath.replaceAll("%20"," "); 
```

不会自行编辑`myPath`，它会返回一个您需要分配给变量的字符串。

```
myPath = myPath.replaceAll("%20"," "); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T12:31:31.847

您可以使用[JFileChooser](http://docs.oracle.com/javase/6/docs/api/javax/swing/JFileChooser.html)来查找目录。

```
String DefaultFolder=new JFileChooser().getFileSystemView().getDefaultDirectory().toString(); 
```

# download - 在 Windows 上同时下载具有大文件列表的多个文件

> ID：16120265
> 
> 赞同：1
> 
> 时间：2013-04-20T12:18:10.820
> 
> 标签：download, wget, aria2

我正在寻找一个可以同时下载（例如，大约 100 个并行文件）多个文件的程序。唯一的问题是，这个程序应该能够处理非常大的文件列表（比如 200MB 的链接），并且应该可以在 Windows 上运行。

至于现在，我已经测试了 aria2，但是当我加载我的文件列表时，我得到了内存不足的异常（aria 试图使用超过 4Gb 的内存！）。我也尝试使用mulk，但这东西不起作用（因为我不相信它现在加载我的文件列表大约两个小时，当生成这个列表并写入磁盘时花了我大约半分钟）。我还没有尝试使用 wget，但据我所知它不能并行下载，对吗？

有什么软件可以满足我的要求吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T13:51:07.910

使用 aria2，您可以使用`--deferred-input`选项来减少列表输入的内存占用。此外，将`--max-download-result`选项设置为低，例如 100，也可能会减少内存使用量。

# php - PHP - 从 forEach 选择表单中取回帖子

> ID：16120271
> 
> 赞同：1
> 
> 时间：2013-04-20T12:18:50.687
> 
> 标签：php, forms, foreach

我有一个网站，管理员可以选择添加一定数量的 bbcode 标签和相应的 html 标签。首先，他从 for Each 循环中的下拉选择表单中选择要添加的标签数量。根据他单击提交按钮时选择的标签数量，相应数量的输入标签会出现在第二个表单中，也是在 for Each 循环中。他填写 bbcode 和 html 输入并单击提交按钮。通常应该将标签添加到我的数据库中，但在这种情况下，当他单击提交时，表单会消失并且没有添加任何内容。

这是代码：

```
//FIRST FORM WHERE HE DECIDES HOW MANY TAGS TO ADD
<form id='nbbalises' action='config.ini.php' method='post' accept-charset='UTF-8'>
  <fieldset>
    <legend>How many tags ?</legend>
    <input type='hidden' name='submitted' id='submitted' value='1' /> 
    <?php

    echo '<select name="number">';
    $range = range(1,50,1);
    foreach ($range as $nb) {
      echo "<option value='$nb'>$nb</option>";
    }
    echo "</select>";

    ?>  

    <input type='submit' name='Submit' value='Submit' />
  </fieldset>
</form><br /> <br />

<?php 

if (!(empty($_POST['number']))) {
if ($_POST['number'] >= 1 && $_POST['number']<= 50){
    $number = $_POST['number'];
    $range2 = range(1,$number,1);
?>

//SECOND FORM WHERE I GENERATE THE INPUT DEPENDING ON THE NUMBER CHOSEN FROM FIRST FORM     
<form id='balises' action='config.ini.php' method='post' accept-charset='UTF-8'>
  <fieldset>
    <legend>Balises bbc : </legend>
    <input type='hidden' name='submitted' id='submitted' value='1' />

    <?php 

    foreach ($range2 as $nb2) {
      echo "<label>bbcode tag $nb2 :</label> 
        <input type='text' size='40' name='bbc$nb2' id='bbc$nb2' maxlength='40'  />
        <label>html tag $nb2 :</label> 
     <input type='text' size='40' name='html$nb2' id='html$nb2' maxlength='40'   />
         <br />";

     }

   }
   ?>
   <input type='submit' name='Submit2' value='Submit2' />
  </fieldset>
</form>

<?php 

//PROBLEM STARTS HERE, NOTHING WORKS UNDER HERE  
if (isset($_POST['Submit2'])){

  //CONNECT TO MY DATABASE      
  connectDB();
  for ($i=0; $i<$number ; $i++){

     if (!(empty($_POST["bbc$i"])) && (empty($_POST["html$i"]))) 

     //FUNCTION ADDS TAGS TO DATABASE       
     addBbc($_POST["bbc$i"], $_POST["html$i"]);

 }   
 mysql_close();
}

}

//MY FUNCTIONS TO ADD THE BBCODE AND HTML TO DATABASE

function connectDB(){
//connexion DB

$link = mysql_connect('127.0.0.1', 'USERNAME', 'PASSWORD');
if (!$link) {
    die('Erreur de connexion: ' . mysql_error());
}

$db = mysql_select_db('1213he200967',$link) or die("N'a pu selectionner
    1213he200967");    

mysql_query("SET NAMES 'utf8'");
    }

function addBbc($bbc, $html){

 $b = mysql_real_escape_string($bbc);
 $h = mysql_real_escape_string($html);

$query="INSERT INTO bbcode (BBC,HTML) VALUES ('$b','$h')";

$result = mysql_query($query) or  die("error");

if (!$result) {
    $message  = 'Invalid query: ' . mysql_error() . "\n";
    die($message);
    return false;
}
else return true;

   } 
```

![这是网站的样子](https://i.stack.imgur.com/gBmIs.jpg)

非常感谢，如果我的代码是业余的，我很抱歉，我只是从 php 开始。

**编辑** *发现我的问题的一部分*

```
$number = $_POST['number'];
$range2 = range(1,$number,1); 
```

这从 1 到用户在第一种形式中选择的数字。

```
for ($i=0; $i<$number ; $i++){

    if (!(empty($_POST["bbc$i"])) && (empty($_POST["html$i"]))) 

    //FUNCTION ADDS TAGS TO DATABASE       
    addBbc($_POST["bbc$i"], $_POST["html$i"]); 
```

这从 0 到 $number - 1

所以我把我的代码改成了这个。

```
for ($i=0; $i<$number ; $i++){
  $nb = $i + 1;
  if (!(empty($_POST["bbc$nb"])) && (empty($_POST["html$nb"]))) {
    addBbc($_POST["bbc$nb"], $_POST["html$nb"]);
  }
  else echo "$nb tags empty "; 
```

这工作得更好一些，但现在它转到上面的 else 并显示“2 个标签为空”，所以它仍然不能正常工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T19:17:20.217

好的解决它我最终决定将数据从第二种形式发布到另一个页面，我修改了我的代码。

```
for ($i=0; $i<$number ; $i++){
    $nb = $i + 1;

    $varBbc = 'bbc'.$nb;
    $varHtml = 'html'.$nb;

    if ((isset($_POST[$varBbc])) && (isset($_POST[$varHtml]))) {

        addBbc($varBbc, $varHtml);

    }

    else echo "$nb tags empty ";
} 
```

显然使用 !empty 代替 isset 在这种情况下不起作用，可能是因为 html 标签。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-20T12:53:22.443

$nb 应该用双引号引起来。

所以`echo "<option value='$nb'>$nb</option>"`

改成`echo "<option value='".$nb."'>$nb</option>";`

并且

```
if (!(empty($_POST['number']))) {
if ($_POST['number'] >= 1 && $_POST['number']<= 50){
    $number = $_POST['number'];
    $range2 = range(1,$number,1);
?> 
```

改成：

```
if (isset($_POST['submit'])) {
if ($_POST['number'] >= 1 && $_POST['number']<= 50){
    $number = $_POST['number'];
    $range2 = range(1,$number,1);
?> 
```

# mysql - 用于业务应用程序的 MySQL 数据类型？

> ID：16120274
> 
> 赞同：1
> 
> 时间：2013-04-20T12:19:11.900
> 
> 标签：mysql, sql, database, types

美好的一天，我对`MySQL`.

我`decimal`显然使用它是业务应用程序中准确性的最安全选择。但是，我发现当返回字段时，我的值是`999999999.99`，其中我的数据类型是 DECIMAL(10,2)。所以实际值已经溢出到`(10, 2)`参数之外。

即使我在逗号前指定了 10 个位置，在逗号后指定了 2 个位置，这是否正确。**MySQL仍然存储完整的数字**吗？

是否可以**关闭**逗号前后显示的最大位数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T13:48:06.987

> 即使我在逗号前指定了 10 个位置，在逗号后指定了 2 个位置，这是否正确。MySQL仍然存储完整的数字吗？

不，它不会。

首先，[您总共指定了 10 位数字](http://dev.mysql.com/doc/refman/5.6/en/fixed-point-types.html)；两个在小数点右边，八个在左边。

> 标准 SQL 要求 DECIMAL(5,2) 能够存储具有五位和两位小数的任何值，因此可以存储在薪水列中的值范围为 -999.99 到 999.99。

其次，如果有两个以上，MySQL 将默默地将最低有效数字转换为比例。这可能看起来像 MySQL 截断，但实际行为取决于平台。如果您提供太多最重要的数字，它将引发错误。

*最后，当您使用数据库时，显示*的位数与数据*类型*或存储的值范围无关。

# random - 在 Lua 中随机化数字，不重复

> ID：16120281
> 
> 赞同：6
> 
> 时间：2013-04-20T12:19:36.503
> 
> 标签：random, lua

我正在 Lua 中做一个项目，其中涉及随机数字而不重复。这是我的代码

```
for i = 1, 86000 do
    while rndom[num] ~= nil do
        num = math.random(1,95000)
     end
     rndom[num] = num
     for k=1, 11 do
        file2:write(input[num][k], " ")
     end
     file2:write("\n")
end 
```

基本上它给 rndom[num] 赋值，这样当随机数重复并且 rndom[num] ~= nil 时，它会再次随机化数字。我的问题是，加载时间太长，因为我的“i”越来越高，而且它会停止。我猜这是因为随机数生成器无法获得“nil”的 rndom[num]。我的意思是，赔率是多少？我想改善它的运行时间。谁能为我的问题提出更好的解决方案？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-20T13:27:12.723

最好生成具有`O(N)`时间复杂度的排列。

```
local n = 95000

local t = {}
for i = 1, n do
   t[i] = i
end

for i = 1, 86000 do
   local j = math.random(i, n)
   t[i], t[j] = t[j], t[i]
   for k = 1, 11 do
      file2:write(input[t[i]][k], " ")
   end
   file2:write"\n"
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T12:22:30.143

一个简单的解决方案是，`random`当您获得一个已经拥有的变量时，不要再次使用，而是尝试返回下一个可用的变量。这样你就可以保证有`O(N^2)`运行时间（最长）。

# php - php + mysql + 如何加逗号分割数据库中的字符串

> ID：16120283
> 
> 赞同：2
> 
> 时间：2013-04-20T12:20:08.333
> 
> 标签：php, mysql, explode, implode

我正在创建一个朋友请求页面，它需要将朋友请求作为一个数组，而不是用逗号分隔每个用户名。

我不知道使用内爆或爆炸我确实使用了两者但没有一个给我我想要的结果

当我按下 accpet 按钮时，我收到此错误

**警告：implode()：在第 59 行 C:\wamp\www\Unnamed Site 2\resources\friend_requests.php 中传递的参数无效**

谁能帮我 ？？？

# 朋友请求.php

```
<?php
session_start();

if($sessionlogin = isset($_SESSION['login']))
 {

   $login = ($_SESSION['login']);
   $userid = ($_SESSION['user_id']);
   $login_user = ($_SESSION['username']);
   $fname = ($_SESSION['first_name']);
   $lname = ($_SESSION['last_name']);
   $sessionaddres =($_SESSION['address']);

 // require_once('header.php'); 
 require_once('for members/scripts/connect.php');
  //find friend request
    $findrequests = mysql_query("SELECT * FROM friend_requests WHERE user_from = '$login_user'") or die(mysql_error());
$numrows = mysql_num_rows($findrequests);
   if($numrows == 0)
  {

      echo "YOU HAVE no friend Requests at this time";
      $user_from = "";

  }
    else
  {
       while($get_row =  mysql_fetch_assoc($findrequests))
     {
         $id = $get_row['id'];
         $user_to = $get_row['user_from'];
         $user_from = $get_row['user_to'];

            echo '' . $user_from .   '   wants to be  friend' . '<br />';

            //var_dump($user_from);
            //var_dump($user_to);
            //echo "your user_to is '$user_to'";
            //echo "your user_from is '$user_from'";

?>

<?php

 if(isset($_POST['acceptrequest'.$user_from]))
 {
     //select the friend array  row  from the logged in user
     $get_friend_check = mysql_query("SELECT friend_array FROM user WHERE user_name = '$login_user'") or die(mysql_error());
     $get_friend_row = mysql_fetch_assoc($get_friend_check);
     $friend_array = $get_friend_row['friend_array'];
     $friendArray_explode = implode(",", $friend_array);
     $friend_array_count = count($friendArray_explode);

     //select the friend array  row from the user  who sent the friend request 
     $get_friend_check_friend = mysql_query("SELECT friend_array FROM user WHERE user_name = '$user_from'") or die(mysql_error());
     $get_friend_row_friend = mysql_fetch_assoc($get_friend_check_friend);
     $friend_array_friend = $get_friend_row_friend['friend_array'];
     $friendArray_explode_friend = implode(",", $friend_array_friend);
     $friend_array_count_friend = count($friendArray_explode_friend);

     if($friend_array == "")
     {
       $friendArray_count = count(NULL);    

     }
        //var_dump($friendArray_count);

    if($friend_array_friend == "")
     {
       $friendArray_count_friend = count(NULL);  
     }

     if (@$friendArray_count == NULL)
     {
         $add_friend_query = mysql_query("UPDATE user SET friend_array = CONCAT(friend_array, '$user_from') WHERE user_name = '$login_user'");
     }

     if(@$friendArray_count_friend == NULL)
     {
         $add_friend_query = mysql_query("UPDATE user SET friend_array = CONCAT(friend_array, '$user_to') WHERE user_name = '$user_from'");
     }
     /*
     if(@$friendArray_count >= 1)
     {
         $add_friend_query = mysql_query("UPDATE user SET friend_array = CONCAT(friend_array, ',$user_from') WHERE user_name = '$login_user'");
     }
     /*
         if(@$friendArray_count_friend >= 1)
         {
         $add_friend_query = mysql_query("UPDATE user SET friend_array = CONCAT(friend_array, ',$user_to') WHERE user_name = '$user_from'");
     }

      */
     // for delete request  

     $delete_request = mysql_query("DELETE FROM friend_requests WHERE user_to = '$user_to' && user_from = '$user_from'") or die(mysql_error());

     echo "YOU are now friends!!";
    //header("Location: friend_requests.php");

 }

 if(isset($_POST['ignorerequest'.$user_from]))
 {
      $ignore_request = mysql_query("DELETE FROM friend_requests WHERE user_to = '$user_to' && user_from = '$user_from'")      or die(mysql_error());

     echo "Request ignored !!";
     header("Location: friend_requests.php");

 }

?><br />
<br />
<br />
<br />
<br />

<form action="friend_requests.php" method="post">
               <input type="submit" name="acceptrequest<?php echo $user_from; ?>" value="Accept">
               <input type="submit" name="ignorerequest<?php echo $user_from; ?>" value="Ignor">
</form>

<?php
   }
  }
 }

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T12:27:41.420

尝试这个

```
 $get_friend_check = mysql_query("SELECT friend_array FROM user WHERE user_name = '$login_user'") or die(mysql_error());

 $your_array = array();
 while ($get_friend_row = mysql_fetch_array($get_friend_check)) {
 $your_array[] = $get_friend_row['friend_array'];
 }

 $friendArray_explode = implode(",", $your_array);
 echo $friendArray_explode; 
```

*   你也可以直接在mysql中使用implode

像那样

```
$get_friend_check = mysql_query("SELECT group_concat(friend_array SEPARATOR ',')
                                 FROM user WHERE user_name = '$login_user'") 
or die(mysql_error()); 
```

# python - 我应该在 XAMPP 中使用什么 Python 插件

> ID：16120285
> 
> 赞同：2
> 
> 时间：2013-04-20T12:20:20.600
> 
> 标签：python, html, apache, xampp

嗨，这只是一个一般性问题，如果有人可以提供帮助，将不胜感激。

我正在为一个大学项目创建一个网站，我正在使用 XAMPP 开发该网站。我需要一个 Python 插件，因为我正在尝试创建一个用户可以在其中键入 Python 脚本的区域，并且响应将反映在相邻的 iframe 中。

我打算使用 mod_python 作为插件，但通过对此的研究我发现它现在已经死了，最终将不被支持。

有没有人对我应该使用什么有任何建议，因为我在网上找不到任何相关信息。

非常感谢安迪·罗斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T13:04:28.770

我已经发表了评论，但我会添加一些历史背景。

[`mod_python`](http://en.wikipedia.org/wiki/Mod_python)曾经是事实上的标准，至少是非官方的，但早在 2003 年，Python web-sig 提出的 Python Web 界面正式标准的提案被发布为[PEP333](http://www.python.org/dev/peps/pep-0333/)，通常称为 Python [Web 服务器网关接口](http://en.wikipedia.org/wiki/Web_Server_Gateway_Interface)，或 WSGI。

从那时起，[`mod_wsgi`](http://en.wikipedia.org/wiki/Mod_wsgi)被创建以支持新标准，虽然`mod_python`也可以与适当的包装器一起使用。

至于哪个“更好”，这是一个主观问题，但`mod_wsgi`似乎是大多数 Python 社区的首选。例如，[Django](https://www.djangoproject.com/)`mod_python`在 2011 年放弃了对 的支持。

# redis - Redis 绑定多个 IP

> ID：16120287
> 
> 赞同：51
> 
> 时间：2013-04-20T12:20:26.890
> 
> 标签：redis

在 redis.conf 中，正常设置是

绑定 127.0.0.1

我也想让redis听另一个ip（比如我本地的开发地址）

我试过了

绑定 127.0.0.1、123.33.xx.xx

但这不起作用。我在文档中或通过谷歌搜索找不到任何相关内容。希望有人可以提供帮助。

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2014-03-08T09:55:37.190

从 Redis 2.8 开始，确实可以绑定到多个 IP。只需用空格（不是逗号）分隔每个 IP。

```
bind 127.0.0.1 123.33.xx.xx 
```

[来源：官方默认配置](http://download.redis.io/redis-stable/redis.conf)

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2016-12-07T20:12:17.977

**这个答案没有过时，适用于旧版本和新版本**

理解的问题是Redis绑定**不**显示客户端机器的地址，而是显示应该建立连接的接口。在你的例子中，如果你的本地开发（客户端）地址是 123.33.xx.xx，并不意味着你必须把完全相同的地址作为绑定，否则 Redis 服务将无法启动。

因此，如果`ifconfig`在您的 Redis**服务器**机器上显示您有一些类似于此的网络接口：

```
eth0   Link encap:Ethernet  HWaddr 00:0c:... 
       inet addr:192.168.1.110  Bcast:192.168.1.255  Mask:255.255.255.0 
```

您可以将接口的地址**`192.168.1.110`**作为绑定，通过此接口对 Redis 的每个请求都应该成功。

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2013-11-12T05:42:01.037

自从：

> --[Redis 2.8 Release Candidate 1 (2.7.101)] 发布日期：2013 年 7 月 18 日

你可以：

> *   [新] 能够绑定多个 IP 地址。

干杯！！

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2016-10-05T23:03:50.183

**编辑：似乎正确的方法仍然是只有一行和一个或多个用空格分隔的 IP**

这边走：

```
bind 127.0.0.1 10.150.220.121 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-07-24T11:02:25.570

**编辑：这是一个过时的答案。请检查更新的答案以获得解决方案。**

您不能将 redis 设置为侦听**特定**的多个接口。如果需要多个接口，只需删除绑定线。

正如@taro 指出的那样，使用防火墙来限制访问。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-06-06T09:14:15.773

我也尝试找到该答案，就目前而言，这是不可能的，我在多个（但不是所有接口）上搜索答案时发现了这一点。这就是出现的[http://code.google.com/p/redis/issues/detail?id=497](http://code.google.com/p/redis/issues/detail?id=497)声明它不会被 redis 本身支持。

与 haproxy 结合使用，就不可能一次性将其放在 redis 前面。您需要使用不同的端口或其他端口，或者选择绑定 1 个 IP。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2019-11-15T16:52:36.160

这对我有用的唯一方法是添加单独的行：

```
bind 111.222.33.44
bind 127.0.0.1 ::1 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2021-02-20T03:37:53.477

```
bind 127.0.0.1 192.168.152.2 
```

**注意，我必须把 127.0.0.1 放在第一位，否则 192.x 将不会在系统启动时绑定。**然而，另一个`systemctl restart redis`就足够了——可能是一个错误？（Debian 10 和 Redis 5.0.3）

对于**macOS Homebrew**安装，请确保您正在编辑`/usr/local/etc/redis.conf`而不是模板文件：`/usr/local/Cellar/redis/6.2.6/.bottle/etc/redis.conf`

# hadoop - 猪加入 Cloudera VM

> ID：16120289
> 
> 赞同：1
> 
> 时间：2013-04-20T12:20:37.313
> 
> 标签：hadoop, nosql, apache-pig, cloudera

我尝试在 apache pig 中执行简单的连接。我使用的数据集来自[http://www.dtic.upf.edu/~ocelma/MusicRecommendationDataset/lastfm-1K.html](http://www.dtic.upf.edu/~ocelma/MusicRecommendationDataset/lastfm-1K.html)

这就是我在猪壳中所做的：

```
profiles = LOAD '/user/hadoop/tests/userid-profile.tsv' AS (id,gender,age,country, dreg);
songs = LOAD '/user/hadoop/tests/userid-timestamp-artid-artname-traid-traname.tsv' AS (userID, timestamp, artistID, artistName, trackID, trackName);
prDACH = filter profiles by country=='Germany' or country=='Austria' or country=='Switzerland';
songsDACH = join songs by userID, prDACH by id;
dump songsDACH; 
```

这是日志的一部分：

```
2013-04-20 01:01:33,885 [main] INFO org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MapReduceLauncher - 0% complete
2013-04-20 01:02:39,802 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MapReduceLauncher - 2% complete
2013-04-20 01:13:23,943 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MapReduceLauncher - 37% complete
2013-04-20 01:14:48,704 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MapReduceLauncher - 39% complete
2013-04-20 01:15:40,166 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MapReduceLauncher - 41% complete
2013-04-20 01:15:41,142 [main] WARN  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MapReduceLauncher - Ooops! Some job has failed! Specify -stop_on_failure if you want Pig to stop immediately on failure.
2013-04-20 01:15:41,143 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MapReduceLauncher - job job_1366403809583_0023 has failed! Stop running all dependent jobs
2013-04-20 01:15:41,143 [main] INFO  org.apache.pig.backend.hadoop.executionengine.mapReduceLayer.MapReduceLauncher - 100% complete
2013-04-20 01:15:43,117 [main] ERROR org.apache.pig.tools.pigstats.SimplePigStats - ERROR 2997: Unable to recreate exception from backed error: AttemptID:attempt_1366403809583_0023_m_000019_0 Info:Container killed by the ApplicationMaster. 
```

当我使用一小部分歌曲样本时，可以毫无问题地执行连接。有任何想法吗？

看起来这是 hdfs 设置的问题，因为我可以使用歌曲数据的子集（100000 个样本）执行连接。

PS我正在使用cloudera demo vm。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T11:45:41.097

您应该查看任务尝试的日志：将浏览器指向作业跟踪器 ( `http://[your-jobtracker-node]:50030`)，查找失败的作业，找到失败的任务尝试，浏览日志，您将能够看到实际的异常 - 我怀疑它可能与任务堆大小配置有关，但您必须先查看异常然后提出解决方案（配置更改等）。

# c# - 从格式错误的字体中获取正确的字符/字符串？

> ID：16120294
> 
> 赞同：1
> 
> 时间：2013-04-20T12:21:05.303
> 
> 标签：c#, winforms, unicode, fonts

我真的不知道该调用什么样的任务。对于某些字符/字符串，如果您将它们显示在带有某种字体的文本框中（我称之为字体 1），它会正确显示它们。但是如果将 TextBox 的字体更改为另一种字体（我称之为 Font 2），则字符/字符串可能会显示错误（错误的字体）。我想要的是如何将这些字符/字符串（如字体 2 所示）转换为一些相应的字符/字符串/值（如字体 1 所示）。我必须这样做，因为在我的语言中，没有任何像字体 2 中显示的字符那样的字符。

为了更清楚，例如：

*   我遇到过正确字符是“ă”的情况，但是还有另一个像“¨”这样的“表达式”，在字体 1 中将完全显示为“ă”，但在字体 2 中，它显示为“¨” '。'¨' 不是我的语言字母表中的字符/字母。看起来这与字体问题有关。这就像输入和输出的问题：

    1.  **输入**：奇怪/错误的字符（如'¨'）和该奇怪/错误字符正确显示的字体（如'ă'）。该字体是我上面所说的字体 1。
    2.  **输出**：正确的字符（如'ă'）。我确信这个字符应该在几乎 Unicode 字体中正确显示。所以正确显示输出的指定Font这里就不用说了，如果是输出的条件（选择一些指定的Font来正确显示输出），我想就可以了，因为我打算显示以某些固定字体输出字符。

我已经拥有的“转换器”之一（称它为转换器并不准确，可能是翻译器）是任何文本框。这应该称为翻译器，因为它可以帮助您将奇怪/错误的字符翻译成正确的字符（您可以看到输出），但它不是转换器，因为您无法掌握输出，例如，选择并将其复制到剪贴板并粘贴到另一个文本框（例如 Google 搜索框）。TextBox 像翻译器一样工作，它接收输入（为 Text 属性分配奇怪/错误的字符，为 Font 属性分配字体）并给出输出（正确的字符，但正如我所说，你只能看到它，而不是抓住/得到它，或者至少得到在另一个字体中正确显示的相应字符）。

如果这不能做到，恐怕我必须在我的表中添加一个名为' **FontName** '或' **FontFamily** '的列，这样每次我从我的表中查询文本时，我也必须查询相应的字体在我的表单/网格上正确显示文本。这是我所知道的最烦人的事情之一。

我希望你能理解我的问题。正如我所说，我什至不知道它是什么样的任务，但你可能知道。请帮帮我。

谢谢！

# 更新

我想举一个转换器的例子，把它看成这样的函数/方法：

```
public char GetCorrectChar(char c){
   switch(c){
      case '¨': 
         return 'ă';
      case 'Ç'
         return 'ầ';
      ....
   }
} 
```

这个函数是可以实现的，但是它需要我收集所有可能的对（输入字符和输出字符），我不确定它是否有效。谢谢！

# java - 我的资源文件在哪里

> ID：16120296
> 
> 赞同：3
> 
> 时间：2013-04-20T12:21:31.047
> 
> 标签：java, android, android-resources

我对 android 和存储选项（内部存储）有疑问。

我在“原始”目录中添加了一个 SSL 证书，我想将其写入存储。

目前我正在尝试使用此代码段：

```
 InputStream is = SA.getResources().openRawResource(R.raw.myResource);
           ByteArrayOutputStream buffer = new ByteArrayOutputStream();

           int nRead;
           byte[] data = new byte[16384];

           while ((nRead = is.read(data, 0, data.length)) != -1) 
           {
             buffer.write(data, 0, nRead);
           }

           buffer.flush();

           FileOutputStream fos = SA.openFileOutput("Resource.crt", 0);
           fos.write(buffer.toByteArray());
           fos.close();
           is.close();
           buffer.close();
           File f = new File(this.fileList()[0]);
           if(f.exists())
           {
               Log.v("File:", "Found");
           }
           else
           {
               Log.v("File:", "Not found");
           } 
```

找不到我的文件。我不知道为什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T13:11:27.763

我相信`fileList`只是返回文件名，但您还需要目录 try ：

```
File f = new File(context.getFilesDir(), filename);
if(f.exists()){
    ... 
```

在这里阅读：

[http://developer.android.com/training/basics/data-storage/files.html#WriteInternalStorage](http://developer.android.com/training/basics/data-storage/files.html#WriteInternalStorage)

# java - Conn.Connexion.insertUtilisateur (Connexion.java:50) 的线程“AWT-EventQueue-0”java.lang.NullPointerException 中的异常

> ID：16120300
> 
> 赞同：1
> 
> 时间：2013-04-20T12:22:01.627
> 
> 标签：java, sql, netbeans

我想通过 NetBeans 在我的数据库“sqlserver”中插入一些信息！！！连接很好但不知道 pb 是什么，真的这个 pb 让我抓狂！！！！！！！！！

请帮我！！！！

```
CODE:
package Conn;
import java.sql.Connection;
import java.sql.*;
import javax.swing.JOptionPane;

/**
*
1\. @author Nadia
*/
public class Connexion {

java.sql.Connection C;

private Connection C1;
String Nom;
    String Adresse;
    String MDP;
    String VMDP;
/**
 * Constructeur`enter code here`
 */
public Connexion() {
    //this.connection=ConnexionBDD.getInstance();

        try{
Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");
      C1=DriverManager.getConnection("jdbc:sqlserver://localhost\\A:1433databaseName=Authentif","sa","sqlserver");
Statement  stmt = C1.createStatement();
}

 catch(Exception e){}

}

//*************Insertion Utilisateur 
```

// public int insertUtilisateur(UserIdentit utilisateur) {

```
public void insertUtilisateur(String Nom,String Adresse,String MDP,String VMDP) {

    PreparedStatement pst;
try {

**pst = C1.prepareStatement("INSERT INTO Authentif.dbo.tab_authentif      (Nomc,Adressec,MDP,VMDP)"+"VALUES(?,?,?,?)");** *(ligne 50)*

        pst.setString(1,Nom);
                    pst.setString(2,Adresse);
                    pst.setString(3,MDP);
                    pst.setString(4,VMDP);
                    int res=pst.executeUpdate();
    } catch (SQLException ex) {
        JOptionPane.showMessageDialog(null,ex.getMessage());
    } 
```

} }

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T18:35:21.103

遵循 SQL Server[文档](http://msdn.microsoft.com/en-us/library/ms378428.aspx)

您需要在数据库键值对之前添加一个分号：

```
jdbc:sqlserver://localhost\\A:1433;databaseName=Authentif
                                  ^ 
```

这导致了`Connection`这里`null`。由于异常被静默捕获，因此不会出现异常消息。添加某种形式的通知，例如`printStackTrace`来电。最后，捕获最具体的异常，在本例中为`SQLException`. 这允许应用程序处理数据库特定的异常。

# javascript - 查找导致输入模糊的元素的 id

> ID：16120303
> 
> 赞同：1
> 
> 时间：2013-04-20T12:22:18.540
> 
> 标签：javascript, jquery, html

我需要找到导致文本输入模糊的单击元素并将其存储为变量。如何确定单击以导致输入“文本框”失去焦点的元素的 ID？我不知道我是否以正确的方式接近这个，但下面的代码是我到目前为止所拥有的。我试过`document.activeElement`了，但它只适用于输入，而不是 li 和锚标签等元素谢谢

javascript:

```
var elClicked;

$('textBox').blur(function(){
  elClicked = // what is the id of the element that caused blur?
  alert(elClicked);
}); 
```

html:

```
 <input type = "text" id = "textBox">

 <!-- example elements --> 

  <input type = button id = "element1" />
  <a href = "#" id = "element2">text</a>
  <ul><li id = "element3">list</li></ul> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T12:23:48.127

通过访问目标的 id 属性。

```
$('textBox').blur(function(){
  var target = event.explicitOriginalTarget || document.activeElement;
  elClicked = target ;
  alert(elClicked);
}); 
```

或者你可以尝试沿着这些思路

```
var elClicked;

$(document).mousedown(function(e) {
    elClicked = $(e.target);
});

$('textBox').blur(function(){
  alert(elClicked);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T12:31:17.003

您可以将锚标记的 id 存储在隐藏字段中，当它被单击时。取该值，您可以找到单击了哪个元素

# php - 为什么从数据库中检索的数据被两次添加到 php 数组中？

> ID：16120308
> 
> 赞同：0
> 
> 时间：2013-04-20T12:22:40.727
> 
> 标签：php, mysql, sql, arrays

我有一个包含列的简单用户表：用户名、密码、电子邮件、姓名、姓氏、出生日期、地址和城市。前三个是强制性的，但其余的可以为空。我正在连接到数据库并获取数组中的行并打印它。

```
$dbc=mysqli_connect(DB_HOST, DB_USER, DB_PASSWORD, DB_NAME);
$sql = "select * from user"; 
$data = mysqli_query($dbc, $sql) or die("query exec error");
//$json = array();
if(mysqli_num_rows($data)){
    while($row=mysqli_fetch_array($data)){
        //$json['Kullanici'][]=$row;
        print_r($row);
        echo "<br /><br />";
    }
}
mysqli_close($dbc);
//echo json_encode($json); 
```

但是输出是这样的：

```
Array ( [0] => ayse [username] => ayse [1] => b1b3773a05c0ed0176787a4f1574ff0075f7521e [password] => b1b3773a05c0ed0176787a4f1574ff0075f7521e [2] => ayse@hotmail.com [email] => ayse@hotmail.com [3] => [name] => [4] => [surname] => [5] => 0000-00-00 [birthdate] => 0000-00-00 [6] => [address] => [7] => istanbul [city] => istanbul )

Array ( [0] => baris [username] => baris [1] => 7c4a8d09ca3762af61e59520943dc26494f8941b [password] => 7c4a8d09ca3762af61e59520943dc26494f8941b [2] => bakkurt@hotmail.com [email] => bakkurt@hotmail.com [3] => BarÄ±ÅŸ [name] => BarÄ±ÅŸ [4] => [surname] => [5] => 0000-00-00 [birthdate] => 0000-00-00 [6] => [address] => [7] => [city] => ) 
```

问题是为什么同时存在 [0]=>baris 和 [username] => baris。我只期待用户名=> baris。我错了吗？我在哪里失踪？如果我解决了这个问题，我将通过删除注释将数组转换为 json。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T12:33:06.267

这不是问题，如果您查看该`mysqli_fetch_array()`函数的 PHP 文档，它接受一个参数`resulttype`；它确定是否将记录返回为仅具有数字索引、仅具有关联索引或两者都具有的数组（这就是您所拥有的）。
默认情况下，该函数使用`MYSQLI_BOTH`.
要单独获取数字索引：

```
while($row=mysqli_fetch_array($data, MYSQLI_NUM)){
    //this will always return with numeric indices alone
} 
```

有关更多信息，请在此处查看[PHP mysqli_fetch_array](http://php.net/manual/en/mysqli-result.fetch-array.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T12:32:50.017

如果你只需要`username => baris`

尝试**[mysqli_fetch_assoc](http://www.php.net/manual/en/mysqli-result.fetch-assoc.php)**。

> **礼貌**- **[http://www.php.net](http://www.php.net)**
> 
> 它返回一个表示结果集中获取的行的字符串关联数组，其中数组中的每个键表示结果集列之一的名称，如果结果集中没有更多行，则返回 NULL。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-20T12:34:27.857

我认为您正在寻找的是 resulttype 参数。看看这个页面：[mysqli_result::fetch_array](http://php.net/manual/en/mysqli-result.fetch-array.php)

您可能想像这样调用 fetch_array 函数：

```
mysqli_fetch_array($data, MYSQLI_ASSOC) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-20T12:34:30.097

尝试使用`mysqli_fetch_assoc()`而不是`mysqli_fetch_array()`.

`mysqli_fetch_array()`以枚举和关联方式获取数据，因此如果您只需要关联数组，请使用`mysqli_fetch_array()`.

如果您想了解更多信息，也可以[阅读文档。](http://php.net/manual/en/mysqli-result.fetch-array.php)

# user-interface - 垂直滚动时，scrollView 中的片段会闪烁

> ID：16120311
> 
> 赞同：2
> 
> 时间：2013-04-20T12:23:27.777
> 
> 标签：user-interface, android-fragments, scrollview

我有一个滚动视图，其中包含一个 web 视图、片段和一个视图寻呼机。当我垂直滚动片段部分闪烁。这是代码：

```
<FrameLayout
    android:id="@+id/mapViewContainer"
    android:layout_width="fill_parent"
    android:layout_height="100dp"
    android:background="@android:color/white"
    android:layout_below="@+id/layout_txt_mapContainer"
    android:layout_margin="10dp" >

    <fragment
        android:id="@+id/map"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        class="com.google.android.gms.maps.SupportMapFragment" />

    <View
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:background="@android:color/transparent" />
</FrameLayout> 
```

# javascript - 将参数从模型传递到 javascript

> ID：16120314
> 
> 赞同：1
> 
> 时间：2013-04-20T12:23:35.837
> 
> 标签：javascript, asp.net-mvc-3, google-maps, razor, google-api

所以我在一个 asp.net **MVC4**地理定位项目中工作，我的 foreach 循环有问题，我的地图只显示最后一个位置，这是我的视图代码：

```
@model  List<AgencyWebApplication.Models.HomeModel>
 @foreach(var ch in Model)
    {
    <script>
        var city = '@Html.Raw(ch.adress)';
        var attitude = '@Html.Raw(ch.attitude)';
        var longitude = '@Html.Raw(ch.longidue)';
        var indice = '@Html.Raw(ch.indice)';
        var array = [[city, attitude, longitude, indice]];
    </script>
    }
    <script src="@Url.Content("~/Scripts/Map.js")" type="text/javascript"></script>
    <input type="submit" name="Go" value="Go" onclick="getMap(array)" />
    <div id="map_canvas" style="width:600px; height:400px"></div> 
```

这是我的地图脚本代码：

```
function getMap(array) {

var myLatlng = new google.maps.LatLng(35.728329, -5.882750);
var mapOptions = {
    center: myLatlng,
    zoom: 17,
    mapTypeId: google.maps.MapTypeId.ROADMAP
};
var map = new google.maps.Map(document.getElementById("map_canvas"), mapOptions);

setMarkers(map, array);
}

function setMarkers(map, locations) {

for (var i = 0; i < locations.length; i++)
{
    var place = locations[i];
    var myLatLng = new google.maps.LatLng(place[1], place[2]);

    var marker = new google.maps.Marker({
        position: myLatLng,
        map: map,
        title: place[0],
        zIndex: place[3]
    });
}
return marker;
} 
```

因此，如果您有任何想法，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T13:14:45.400

将您的模型序列化为视图模型属性并在脚本中获取它

```
public class Geo{
 public string city{get;set;}
 public Decimal lat{get;set;}
 public Decimal lng {get;set;}
} 
```

和视图模型

```
public class ViewModel{
 //other props
 public string GeoData{get;set;}
} 
```

从数据库中填充它

```
 var ViewModel vm = new ViewModel();
 vm.GeoData = new JavaScriptSerializer.serialze(/*get the Geo data and pass it here*/); 
```

现在在视图中

```
<script>
 var geoData = $.parseJSON('@Html.Raw(Model.GeoData)');
 //here you can iterate the geo data and make use of it 
</script> 
```

未经测试的代码可能包含一些语法错误，也推荐使用[Json.Net](http://james.newtonking.com/projects/json-net.aspx)进行序列化

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T13:06:44.857

您的 foreach 每次都会重新分配变量“数组”，因此在加载页面时只有最后一个存在。尝试在浏览器中查看页面源代码，您会明白我的意思。

您每次都需要将新值连接到数组。也许在循环上方分配数组并在循环内执行 array.push() 。

# jquery - 点击后重复调用函数

> ID：16120317
> 
> 赞同：1
> 
> 时间：2013-04-20T12:23:52.137
> 
> 标签：jquery, refresh

我的代码有什么问题，当我只想在点击时调用一个函数，然后每 5 秒再次重复一次？

```
$("#ref").on("click", ".mc", function(event) {
   var ref_id = $(this).attr('ref_id');
      return getRef(ref_id);
      window.setInterval(function(ref_id){
       getRef(ref_id);
      }, 5000);
}); 
```

以及如何在二次点击时删除 setInterval？

感谢您的任何提示！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T12:24:38.197

函数中的所有内容都`return getRef(ref_id);`将被忽略。

您可能应该删除`return`关键字。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T12:27:59.677

> 我的代码有什么问题

您的代码永远不会到达对 的调用`setInterval`，因为您的

```
return getRef(ref_id); 
```

行结束函数。

> 如何在二次点击时删除 setInterval？

通过记住你是否有一个跑步。`setInterval`返回一个“计时器句柄”，它是一个 not 的数字，`0`您可以使用它来关闭它。因此，您可以使用初始化为 的变量`0`来记住您是否正在运行计时器（并记住句柄以便您可以将其关闭）：

```
(function() {
    // A handle for setInterval, 0 = not set
    var timer = 0;

    $("#ref").on("click", ".mc", function(event) {
       if (timer) {
          // Timer is set, cancel it
          clearInterval(timer);
          timer = 0;
       }
       else {
          // Timer is not set, set it
          var ref_id = $(this).attr('ref_id');
          // No `return` on the next line, it ends the function
          getRef(ref_id);
          timer = window.setInterval(function(ref_id){
             getRef(ref_id);
          }, 5000);
       }

       // If you need to return something from the click (for instance,
       // `false`), do so here
    });
})(); 
```

`getRef`在上面我假设你在停止计时器时根本不想打电话。

# php - 使用方法访问类并实例化它们

> ID：16120319
> 
> 赞同：3
> 
> 时间：2013-04-20T12:24:04.597
> 
> 标签：php, class, methods, get, instantiation

我已将要实例化的类存储在可通过 get 和 set 方法访问的变量中：

```
private $myClass;

public function setClass($myClass) {$this->myClass = $myClass;}
public function getClass() {return $this->myClass;} 
```

现在稍后我想使用 get 方法实例化这个类：

```
$instance = new $getClass()(); 
```

并且还可以使用它的一些静态属性：

```
$staticAttr = $getClass()::$attr; 
```

但是这两行都会引发错误，我想我已经找到了解决方案，但我真的不确定，我觉得我的问题是对如何做到这一点缺乏基本的了解。或者也许这只是一种糟糕的做法，因此非常气馁？我应该如何最好地解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T12:26:14.627

PHP 的语法不允许这样做。为了让这个工作，你只需要先将类名存储到一个变量中：

```
$class_name = $obj->getClass();
$instance = new $class_name(); 
```

访问静态属性也是如此：

```
$class_name = $obj->getClass();
$staticAttr = $class_name::$attr; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T12:28:52.627

这是错误的

```
$instance = new $getClass()(); 
```

而是这样做

```
$getClass = "classname";

$instance = new $getClass(); 
```

对于静态函数，请执行此操作

```
$getClass::getMethod(); 
```

对于静态成员

```
$getClass::$attr; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T12:32:43.460

将代码调整为工作对象：

```
class someObject {

  private $myClass;

  public function setClass($myClass) {$this->myClass = $myClass;}
  public function getClass() {return $this->myClass;}

} 
```

样本

```
$a = new someObject();

$a->setClass(new stdClass());
var_dump($a->getClass()); 
```

您可以访问`$a->getClass()->property`, 获取静态属性：

```
class Foo {
  public static $a = 'bar';
}

$a->setClass(new Foo());
$class = $a->getClass();

var_dump($class::$a); 
```

# java - 如何使用 Jodatime 列出给定月份中的所有日期

> ID：16120326
> 
> 赞同：1
> 
> 时间：2013-04-20T12:25:01.007
> 
> 标签：java, jodatime

我正在寻找一种使用 Jodatime 列出给定月份的所有日期的方法。有具体的代码示例会很棒。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T12:25:01.007

由于我找不到这个问题的答案，所以我在这里发布代码，以便有人可以找到它的用途：

```
// set your own print format here
private static final DateTimeFormatter DF=DateTimeFormat.forPattern("dd/MM/yyyy");

    private List<String> createMonthLabels(LocalDate month) {
    // add labels
    List<String> daysInMonthLabels = new ArrayList<String>();
    LocalDate firstDay = month.withDayOfMonth(1);
    LocalDate nextMonthFirstDay = firstDay.plusMonths(1);
    while (firstDay.isBefore(nextMonthFirstDay)) {
        daysInMonthLabels.add(DF.print(firstDay));
        firstDay = firstDay.plusDays(1);
    }

    return daysInMonthLabels;
} 
```

# youtube - 隐藏的 YouTube 播放器显示在按钮中

> ID：16120331
> 
> 赞同：1
> 
> 时间：2013-04-20T12:25:22.183
> 
> 标签：youtube, embed, hidden

此问题仅发生在 Chrome 上。

我的网站上有一个嵌入的 youtube 播放器，它隐藏在我的主要设计后面。一旦我显示

```
$("#trailer").show();
$("#flyer").hide(); 
```

然后再次隐藏播放器：

```
$("#trailer").hide();
$("#flyer").show(); 
```

我的主要设计表现得很奇怪：每当我将鼠标移到链接/按钮/任何可操作的东西上时，它都会显示隐藏播放器的一部分。

这是一个不工作的例子： http: [//movies.expaflyr.com/68721](http://movies.expaflyr.com/68721) （点击海报，然后点击“观看预告片”，关闭它，鼠标悬停会导致错误）

我不知道如何解决这个问题。有谁明白发生了什么？

# ruby - Mongoapper :minimum & :maximum vs. :length

> ID：16120332
> 
> 赞同：0
> 
> 时间：2013-04-20T12:25:40.570
> 
> 标签：ruby, activerecord, mongomapper

我尝试在 MongoMapper 中验证一个字符串：

```
key :title,       String, :require => true, :length => 4..30 
```

而且当字符串长于 4 个字符时，我总是得到错误“标题太短（最少 4 个字符）”。

如果我尝试

```
key :title,       String, :require => true, :minimum => 4, :maximum => 30 
```

它作为例外工作。有人可以解释为什么会发生这种情况或为什么第一件事是错误的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T16:08:28.103

MongoMapper 使用 Activerecord 验证。从他们的文档中：`validates :password, :length => { :in => 6..20 }` 所以你必须使用`:in`来表示你正在使用一个范围。请参阅[http://guides.rubyonrails.org/active_record_validations_callbacks.html#length](http://guides.rubyonrails.org/active_record_validations_callbacks.html#length)

# linux - 从文件名获取版本

> ID：16120335
> 
> 赞同：0
> 
> 时间：2013-04-20T12:25:50.760
> 
> 标签：linux, bash

我正在创建一个列出所有 jboss 版本的脚本。但是我遇到了一个问题。
Jboss 通常有不同的版本名称。
`jboss-4.0.0.tar.gz`
`jboss-4.0.4.GA.tar.gz`

我设法获得了版本（例如 4.0.0 或 4.0.4）。但我需要获得所有版本 4.0.4.GA

`ls -1 | grep jboss |sed -r 's/^.*-([0-9.]+)\..*/\1/'`

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T12:36:38.520

不要解析`ls`输出。

`ls`是一种交互式查看文件信息的工具。它的输出是为人类格式化的，并且会导致脚本中的错误。使用`globs`（就像我在这里做的那样）或`find`代替。了解原因： http: [//mywiki.wooledge.org/ParsingLs](http://mywiki.wooledge.org/ParsingLs)

```
$ ls -1
jboss-4.0.0.tar.gz
jboss-4.0.4.GA.tar.gz
foobar 
```

使用[grep](/questions/tagged/grep "显示标记为“grep”的问题")：

```
 $ printf -- '%s\n' * | grep -oP 'jboss-\K.*(?=\.tar\.gz)' 
```

或使用[awk](/questions/tagged/awk "显示标记为“awk”的问题")：

```
$ printf -- '%s\n' * | awk -F'jboss-|.tar.gz' '/jboss/{print $2}' 
```

或使用[perl](/questions/tagged/perl "显示标记为“perl”的问题")：

```
printf -- '%s\n' * | perl -lne '/jboss-(.*?)\.tar\.gz/ && print $1' 
```

## 输出

```
4.0.0
4.0.4.GA 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T12:35:54.780

```
$ cat test.sh
#!/bin/bash

for file in jboss-*.tar.gz; do
        [ -f "${file}" ] || continue
        version="${file#*-}"
        version="${version%.tar.gz}"
        echo "${version}"
done 
```

例子：

```
$ find
.
./test.sh
./jboss-4.0.0.tar.gz
./jboss-4.0.4.GA.tar.gz

$ ./test.sh
4.0.0
4.0.4.GA 
```

# java - 如何在活动和片段之间共享 TouchDB 的实例？

> ID：16120336
> 
> 赞同：0
> 
> 时间：2013-04-20T12:25:56.717
> 
> 标签：java, android, touchdb

目前我已经在我的主要活动中嵌入了一个 TouchDB 实例，现在已经达到了一个单独的片段需要访问它的地步，并且仅仅将数据从主要活动传递到其他活动是不够的。是否有推荐的方式在活动/片段之间共享相同的数据库实例？例如，在与我的应用程序类似的下图中，片段 b 需要访问数据库，但在手机上，它将附加到 Activity B 和平板电脑 Activity A（在我的情况下是主要活动）。

![在此处输入图像描述](https://i.stack.imgur.com/BDMUI.png)

从我的主要活动中提取数据库实现并将其放入单例类是推荐的方式吗？或者在每个活动/片段中实例化并销毁数据库？如果后者是首选方法，我的理解是正确的，除了主要活动之外，最好在片段中实现数据库而不是它们的相关活动？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-08T20:23:35.890

您**绝对**应该从您的视图代码中提取您的数据库代码。之后，您有很多选择，具体取决于您的应用程序的需要。

根据您的需要可能有用的模式：

*   控制反转 (IoC)
*   依赖注入
*   工厂
*   辛格尔顿

关于单例的旁注，您提到它是一种可能的解决方案。单例和全局静态对象之间几乎没有区别。它们有相似的弱点——它们引入了代码依赖，并且使用它们的代码很难编写自动化测试。主要区别在于 Singleton 可以控制何时首次创建底层对象——这可能对您的应用程序的影响最小。（如果您的数据库代码需要 10 秒才能加载，并且您想在加载期间显示启动画面，那么单例可能会有所帮助。）

# java - 从网站到安卓应用的照片

> ID：16120338
> 
> 赞同：0
> 
> 时间：2013-04-20T12:26:07.357
> 
> 标签：java, android, listview, jsoup

我使用 ListView 和 Jsoup 创建显示来自网站的照片的简单应用程序，任何人都可以告诉我为什么模拟器每次都会崩溃？代码有什么问题？

公共类 MainActivity 扩展 Activity{

```
private ListView listView;
@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.listview);
     listView = (ListView) findViewById( R.id.listview); 
     final ArrayList list = new ArrayList();

     Document doc = null;

    try {

        doc = (Document) Jsoup.connect("http://mongol.co.il/").get();
        Elements divs = ((Elements) doc).select("img[src$=.jpg]");

        for (org.jsoup.nodes.Element div : divs)
        {   
            list.add(div);
        }
    } catch (IOException e1) {
        // TODO Auto-generated catch block
        e1.printStackTrace();
    }

    ArrayAdapter adapter = new ArrayAdapter(this,
            android.R.layout.simple_list_item_1, list);
        listView.setAdapter(adapter);

} 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T12:40:50.433

不要在您的 中发出 http 请求，*我认为*`onCreate`这会在 ICS 及更高版本中引发异常，因为您正在阻塞 UI 线程。

 ** * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T12:46:57.313

您好，我的申请中也有这个。

解决方案相当简单：

所有网络操作都必须在 Asyntask 或 Thread 中完成

我个人使用这样的 Asynctask：

```
 private class LoadImages extends AsyncTask<Void, Void, Void> {

        @Override
        protected void onPostExecute(Void result) {
            // TODO Auto-generated method stub
            super.onPostExecute(result);
            // Here you can do any UI operations like textview.setText("test");
        }

        @Override
        protected Void doInBackground(Void... params) {
            // TODO Auto-generated method stub
Document doc = null;

    try {

        doc = (Document) Jsoup.connect("http://mongol.co.il/").get();
        Elements divs = ((Elements) doc).select("img[src$=.jpg]");

        for (org.jsoup.nodes.Element div : divs)
        {   
            list.add(div);
        }
    } catch (IOException e1) {
        // TODO Auto-generated catch block
        e1.printStackTrace();
    }
        return null;
    } 
```*

# codeigniter - CodeIgniter 数据库结果对齐不正确

> ID：16120341
> 
> 赞同：1
> 
> 时间：2013-04-20T12:26:28.947
> 
> 标签：codeigniter

我从数据库中得到结果并试图在页面上显示。但对齐不正确。我可以知道我该如何解决吗？

## **代码在视图**

```
<?php

        echo "<table align='center'>";

        echo "<tr>";
        echo "<td>  Language ID:  </td>";
        echo "</tr>";

        echo "<tr>";
        echo "<td> Language Name:  </td>";
        echo "</tr>";

        echo "<tr>";
        echo "<td> Date Posted :  </td>";
        echo "</tr>";

        if ($query == true) {
            foreach ($query as $row) {

                echo "<tr>";
                echo "<td>" . $row -> pk_bint_language_id . "</td>";
                echo "<td>" . $row -> vchr_language_name . "</td>";
                echo "<td>" . $row -> bint_language_level . "</td>";
                echo "<td>" . $row -> dat_updated_date . "</td>";

                echo "</tr>";

            }

        }

        echo "</table>";
        ?> 
```

输出：

![在此处输入图像描述](https://i.stack.imgur.com/lv9cP.jpg)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T12:51:31.267

You want to display `four` rows within the `foreach` loop, however you have only `three` in the header section. From what I can see you are missing `Language level` /added to the example/

```
 echo "<table align='center'>
          <tr>
            <td> Language ID:  </td>
            <td> Language Name:  </td>
            <td> Language Level:  </td>
            <td> Date Posted :  </td>
          </tr>";

    if ($query == true) {
        foreach ($query as $row) {

            echo "<tr>";
            echo "<td>" . $row -> pk_bint_language_id . "</td>";
            echo "<td>" . $row -> vchr_language_name . "</td>";
            echo "<td>" . $row -> bint_language_level . "</td>";
            echo "<td>" . $row -> dat_updated_date . "</td>";

            echo "</tr>";

        }

    }

    echo "</table>"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-21T01:03:23.497

您应该使用表头`th`而不是`td`. 至少这是一种更合适的方式。

```
<table border="1">
<tr>
<th>Header 1</th>
<th>Header 2</th>
</tr>
<tr>
<td>row 1, cell 1</td>
<td>row 1, cell 2</td>
</tr>
<tr>
<td>row 2, cell 1</td>
<td>row 2, cell 2</td>
</tr>
</table> 
```

您可以在 w3school [http://www.w3schools.com/html/html_tables.asp上查看](http://www.w3schools.com/html/html_tables.asp)

@bborisovs 的答案是正确的。但是如果你想使用 3 td 而不是 4 你也可以这样做

```
<td colspan="2"> //meainng this single 'td' with take two 'td' place 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T12:51:39.907

You seem to have **3** `<td>`s in the first table row (`<tr>`) with the static "Language ID:" and such, but you have **4** `<td>`s inside the `foreach()` loop. It seems like you are missing the "Language level" from the static `<td>`s.

I would recommend to use the `<thead>` and `<tbody>` tags as well.

# javascript - 如何在此 html 标记中通过 css 显示省略号

> ID：16120343
> 
> 赞同：1
> 
> 时间：2013-04-20T12:26:39.093
> 
> 标签：javascript, jquery, html, css

对于掌握 css 的人，我有一个非常小的问题。我有以下标记：

```
<li>
 <div>
  <span>Some text</span>
  <span>Some large amount of text</span>
 </div>
<li> 
```

而CSS是：

```
li
{
  width: 150px;
  height: 100px;
} 
```

现在我想在包含大量文本的第二个跨度内显示**省略号。**我怎样才能做到这一点 ？

有人可以帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T12:43:35.417

不知道为什么你向我们展示了你是如何设计`li`s 的，但是……</p>

```
<style>
li > span:nth-child(2):before {
    content: '\2026\0020';
}
</style>
<li>
    <span>Some text</span>
    <span>Some large amount of text</span>
</li> 
```

在 Unicode 中，U+2026 是水平省略号，U+0020 是空格。

演示：http: [//jsfiddle.net/5xWhx/](http://jsfiddle.net/5xWhx/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T13:13:04.217

如果您只有一个衬垫跨度，您所需要的就是这个。不需要伪元素

```
li span:nth-child(2) {
    display: block;
    overflow: hidden;
    white-space: nowrap;
    text-overflow: ellipsis;
} 
```

根据 caniuse.com 所有浏览器都支持这一点。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-20T12:52:56.217

假设您的结构总是像您标记的那样（如果没有，您可以使用类 - 无论如何可能是更好的方法），您可以使用`nth-child`选择器和`:after`（或`::after`）伪元素，您可以这样做：

```
<ul>
<li>
 <div>
  <span>Some text</span>
  <span>Some large amount of text</span>
 </div>
 </li>
 </ul> 
```

CSS：

```
/* Hide the text in the second span */
li span:nth-child(2){
    display:block;
    overflow:hidden;
    text-indent:100%;
    white-space:nowrap;
}

/* Create a pseudo-element after the first span with an ellipsis (UTF-8) as its content */
li span:nth-child(1):after{
    content:" \2026";
} 
```

[jsFiddle 示例](http://jsfiddle.net/Rykus0/ewZpz/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-20T15:00:59.957

我不确定从您的示例中是否需要动态解决方案。所以问你几个问题

*   你确定肯定会有比
    容器显示更多的文本吗？
*   第二个跨度中的此文本是否仅显示在一行或多行上？

我问这个是因为它`text-overflow:ellipsis;`只能在单行上工作，然后只能与`white-space:nowrap;`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-20T12:30:01.443

试试这个插件 -

[**http://plugins.jquery.com/ellipsis/**](http://plugins.jquery.com/ellipsis/)

```
$('#target').ellipsis({
    row: 2,
    char: '**'
}); 
```

您也可以尝试这种方式（*不完全支持*）

```
span{
    /* essential */
    text-overflow: ellipsis;
    width: 200px;
    white-space: nowrap;
    overflow: hidden;

    /* for good looks */
    padding: 10px;
} 
```

# android - Android 中的活动和清单

> ID：16120344
> 
> 赞同：2
> 
> 时间：2013-04-20T12:26:45.097
> 
> 标签：android, android-activity, manifest, default

我知道有很多关于此的问题，但我无法弄清楚为什么我的程序一直加载错误的活动，即使我已将正确的活动设为清单中的默认值。这是给大家的一些代码：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
      package="swin.examples"
      android:versionCode="1"
      android:versionName="1.0">
    <application android:icon="@drawable/icon" android:label="@string/app_name">
        <activity android:name="swin.examples.TemperatureConvertor"
                  android:label="@string/app_name">
        </activity>        
        <activity android:name="swin.examples.FeetToCmConvertor"
                  android:label="@string/app_name">
        </activity>
        <activity android:name="swin.examples.Main" android:label="@string/app_name">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>
</manifest> 
```

这就是我认为如果清单中没有问题的地方：

```
package swin.examples;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;

public class Main extends Activity 
{

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) 
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);
        initializeUI();
    }

private void initializeUI()
{
    Button btnCm = (Button)findViewById(R.id.btnFeet);
    btnCm.setOnClickListener(btnFeetListener);
    Button convertButton = (Button)findViewById(R.id.btnTemp);
    convertButton.setOnClickListener(btnTempListener);

}

/** Handle convert button click */ 
private OnClickListener btnTempListener = new OnClickListener() 
{
    public void onClick(View v) 
    {
            convertButtonClicked();
    }
};

private OnClickListener btnFeetListener = new OnClickListener() 
{
    public void onClick(View v) 
    {
            btnCmClicked();
    }
};

private void btnCmClicked()
{
    // set the sender and the receiver of the intent
    Intent intent = new Intent();
    intent.setClass(getApplicationContext(), swin.examples.FeetToCmConvertor.class);

    startActivity(intent); // transmit your intent

}

private void convertButtonClicked()
{
    // set the sender and the receiver of the intent
    Intent intent = new Intent();
    intent.setClass(getApplicationContext(), swin.examples.TemperatureConvertor.class);

    startActivity(intent); // transmit your intent  
}
} 
```

我无法解决，我希望你能帮助我！非常感谢您！

编辑：代码已更新，但仍然无法正常工作。如果这有帮助，这是日志消息：

```
[2013-04-20 22:44:20 - CombinedConvertor] Success!
[2013-04-20 22:44:21 - CombinedConvertor] Starting activity swin.examples.TemperatureConvertor on device emulator-5554
[2013-04-20 22:44:23 - CombinedConvertor] ActivityManager: Starting: Intent { act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] cmp=swin.examples/.TemperatureConvertor } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T12:31:43.757

适合`IntentFilter`主要`Activity`的是

```
<intent-filter>
    <action android:name="android.intent.action.MAIN" />
    <category android:name="android.intent.category.LAUNCHER" />
</intent-filter> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-21T04:19:39.770

有史以来最奇怪的错误。为其他人工作，而不是我。重新制作温度转换器活动，它现在可以工作了。谢谢你们每一个人的帮助！

# php - 在向会员资料支付商店贝宝金额后

> ID：16120345
> 
> 赞同：0
> 
> 时间：2013-04-20T12:26:49.603
> 
> 标签：php, mysql

我正在一个网站上工作，其他人将通过贝宝在网站上出售他们的东西，在从贝宝成功交易后，我很困惑如何在我的网站的个人资料中添加相同的金额。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T12:31:19.310

此页面显示了您在处理付款后可以从 PayPal 取回的内容。

[IPN 和 PDT 变量](https://www.x.com/developers/paypal/documentation-tools/ipn/integration-guide/IPNandPDTVariables#id091EB04C0HS)

这是我在 Codeigniter 中制作的示例。

```
/* Receives a form data from paypal that is processed after payment goes through.
 * It will update the database entry with a transaction id. 
 */
 function epayment_notify(){
    $this->load->model('pament_notice_model');

    echo "Hi<br>";
    $postvars = isset($_POST)? $_POST : array("no post");
    /* echo "</pre>Post Vars:<br><pre>";
    print_r($postvars);
    echo "</pre>Refurl:<br><pre>";
    Check for the transaction ID and put it in the pament_notice table if possible. 
    */
    if (isset($postvars['item_number']) &&  $postvars['item_number'] > 0 && isset($postvars['txn_id'])){

        /* make sure that payment_number is empty on this row. */ 
        log_message('info',"PayPal transaction received.");

        if ($this->pament_notice_model->make_sure_payment_number_is_empty($postvars['item_number'])){   
            //writes the message to the local log file in CI
            log_message('debug',"PayPal payment number is empty.");

            /* set the txn_id in the slot */
            $data = array('payment_number' => $postvars['txn_id']);
            $this->db->where('entry_id',$postvars['item_number']);
            $this->db->update('pament_notice',$data);
            log_message('debug',"payment number updated. item:".$postvars['item_number']);
            log_message('debug',"payment actual cost. payment_gross:".$postvars['payment_gross']);

        }  else {
            log_message('error',"PayPal transaction attempted on non-empty payment number.");
            if (isset($postvars['item_number']))
                log_message('error',"failed request item_number :".$postvars['item_number']);
            if (isset($postvars['txn_id']))
                log_message('error',"failed request txn_id:". $postvars['txn_id']); 
        }   

    } else {
        log_message('info',"PayPal payment transaction sent with invalid data.");
        if (!isset($postvars['item_number']))
            log_message('error',"item_number is not set");

        if (isset($postvars['item_number']))
            log_message('error',"failed request item_number :".$postvars['item_number']);

        if (!isset($postvars['txn_id']))
            log_message('error',"txn_id is not set\n");

        if (isset($postvars['txn_id']))
            log_message('error',"failed request txn_id:". $postvars['txn_id']); 
    }
} 
```

# java - 在 java .spring 中创建一个临时数据持有者。休眠

> ID：16120346
> 
> 赞同：2
> 
> 时间：2013-04-20T12:26:51.637
> 
> 标签：java, spring, hibernate

我从事一个为移动应用程序提供服务的项目，并且我应该制作一个监控移动项目的项目。我想制作一些报告来显示此时有多少消息以及其他一些类似的报告。

但我不想直接从数据库中获取监控项目中的查询。我想在内存中创建一个临时数据持有者并在其上保存最后 10 分钟的数据（如变量或列表），但我不知道技术上如何？我在我的项目中使用 Spring 和 Hibernate。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-21T13:50:38.790

首先，我们假设我们的程序每 10 分钟尝试刷新一个名为*SampleEntity的实体的报告。*这只是一个简单的 POJO。

```
public class SampleEntity
{
    // your fields and their getters and setters
} 
```

接下来我们有一个类，我称之为*SampleEntityDA*，它从 db 查询我们的报告所需的记录。**当您使用休眠时，您可以简单地将结果返回为 java.util.List**（我认为这是您的主要问题之一）。

```
public class SampleEntityDA
{
    public List<SampleEntity> queryFromDB()
    {
         // fetch records you need for your reports here
         Session session = ...
         return session.createQuery("from sampleEntity").list();
    }
} 
```

最后...

*每 10 分钟从 db 查询一次*...

要每 10 分钟从 db 查询一次，您可以简单地使用 java.util.Timer 类。

```
public class ReportTimer extends Observable
{
    private Timer timer;

    public static void main(String[] args)
    {
        // Your program starts from here
        new ReportTimer().start();
    }

    private void start()
    {
        // schedule method of Timer class can execute a task repeatedly.
        // This method accepts a TimerTask interface instance as its first parameter.I implement
        // it as an anonymous class. TimerTask interface has a run method. Code in this method will execute repeatedly.
        // Its second parameter is delay before task gets started to execute.
        // And its third parameter is the interval between each execution(10min in your case)
        timer = new Timer();
        timer.schedule(
                new TimerTask()
                {
                    @Override
                    public void run()
                    {
                        notifyObservers(
                            new SampleEntityDA().queryFromDB() // 10 minutes passed from the last query, now its time to query from db again...
                       );
                    }
                }, 100, 600000); // 600000ms = 10min
    }

    public void finish()
    {
        // call me whenever you get tired of refreshing reports
        timer.cancel();
    }
} 
```

最后，您需要每 10 分钟更新一次报告的数据持有者。

您可以通过*观察者模式*简单地做到这一点。正如您在 java 中所知道的，这是由 Observer 类和 Observable 接口完成的。所以 1) ReportTimer 需要扩展 Observer 类 2) 在 TimerTask 中我们需要通知监听器；这是通过 notifyObservers 方法完成的。

我们最后一堂课有刷新报告的职责。我称之为报告生成器。此类可随时刷新报告。它还有一个 java.util.List 字段，其中包含 db 的最新数据。每当其观察者（我的意思是 ReportTimer）通知它时，ReportGenerator 都会更新此字段。

```
public class ReportGenerator implements Observer
{

List<SampleEntity> list = new ArrayList<SampleEntity>();

@Override
public void update(Observable o, Object arg)
{
    // This method will automatically!?! executed whenever its observer notifies him.
    // The arg parameter consists the new records. you just need to put it in the list field.
    List<SampleEntity> list = (List<SampleEntity>) arg;
}

public void refreshReport()
{
    // you can easily refresh a report with data in list field
}

public void refreshAnotherReport()
{
    // you can easily refresh a report with data in list field
}
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T12:42:00.193

使用 map、hashMap 或 ConcurrentHashMap。做一个十分钟后更新地图的工作。

这是 [map](http://docs.oracle.com/javase/6/docs/api/java/util/Map.html)，[HashMap](http://docs.oracle.com/javase/6/docs/api/java/util/HashMap.html)，[ConcurrentHashMAP的链接](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ConcurrentHashMap.html)

# stored-procedures - Entity Framework Optimistic Concurrency with Update 存储过程（Julie Lerman 示例）

> ID：16120348
> 
> 赞同：0
> 
> 时间：2013-04-20T12:27:11.643
> 
> 标签：stored-procedures, entity-framework-5, updating, optimistic-concurrency

我在使用更新存储过程理解并发问题时遇到了一些困难。我正在关注 Julie Lerman 的 Programming Entity Framework，她在示例中给出了以下代码：

```
using (var context = new BAEntities())
        {
            var payment = context.Payments.First();
            if (payment.PaymentDate != null)
            {
                payment.PaymentDate = payment.PaymentDate.Value.AddDays(1);
            }
            var origRowVersion = payment.RowVersion;
            try
            { //BREAKPOINT #1
                context.SaveChanges();
                var newRowVersion = payment.RowVersion;
                if (newRowVersion == origRowVersion)
                {
                    Console.WriteLine("RowVersion not updated");
                }
                else
                {
                    Console.WriteLine("RowVersion updated");
                }
            }
            catch (OptimisticConcurrencyException)
            {
                Console.WriteLine("Concurrency Exception was thrown");
            }
        } 
```

更新 SP 看起来像：

```
UPDATE payments
SET paymentdate=@date,reservationID=@reservationID,amount=@amount, modifieddate=@modifiedDate
WHERE
paymentid=@paymentid AND ROWVERSION=@rowversion 
IF @@ROWCOUNT>0
SELECT RowVersion AS newTimeStamp FROM payments WHERE paymentid=@paymentid 
```

并且在映射中勾选了“使用原始值”复选框，如下所示： [https ://dl.dropboxusercontent.com/u/135754/updatemapping.png](https://dl.dropboxusercontent.com/u/135754/updatemapping.png)

现在，当我尝试：

1.  按原样运行代码，然后在调试器中检查的 newRowVersion 与 origRowversion 相同，但应用程序进入 'else' 子句（为什么它首先相同，我刚刚更改它？是调试器问题吗？）

2.  运行代码，但在 BREAKPOINT #1 我更新 Management Studio 中的支付对象时，SaveChanges 抛出 OptimisticConcurrencyException。我认为这是预期的结果。

每次我查看 SQL Profiler 时，都会将原始版本的时间戳发送到服务器。

然后，当我在时间戳值的 SP 映射中取消选中“使用原始值”时，一切都以与上述相同的方式工作......我不明白这一点。我测试错了吗？应用程序什么时候应该输入“if”子句？

提前感谢，干杯！

编辑：我添加了 newTimeStamp 作为更新 SP 映射的返回值。现在我可以看到 RowVersion 的更新值是从数据库中正确获取的。但我仍然看不出选中和未选中“使用原始值”之间的区别......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-28T18:59:38.643

我想我现在明白了。当我尝试在调用 savechanges 之前手动更改 rowversion（到随机字节 []）时：

1.  未选中使用原始值：“随机字节 []”被发送到数据库并用于更新存储过程（在 WHERE 子句中），导致 OptimisticConcurrencyException
2.  使用原始值检查：rowversion 最初从数据库下载时的值被发送并在更新存储过程中使用（在 WHERE 子句中）

我想这就是 Use Original Value 的用途……对我来说似乎有点奇怪，谁会在同一个 dbcontext 中手动更改它？

# java - 通过休眠插入数据库

> ID：16120349
> 
> 赞同：1
> 
> 时间：2013-04-20T12:27:16.237
> 
> 标签：java, hibernate, postgresql, insert

我创建了这个在我的 postgresql 数据库中创建的类：

```
@Entity
public class Test implements Serializable {

    @Id
    @GeneratedValue
    private Long id;

    @NotNull
    @Column(name="type")
    private String type;

    @NotNull
    @Column(name="test")
    private Integer test;

    @NotNull
    @Column(name="test_String")
    private String testString;

    @NotNull
    @Column(name="test_1")
    private Integer test1;

    @NotNull
    @Column(name="space")
    private String space; 
```

我想将其插入数据库：

```
 INSERT INTO test (id, type, test, test_String, test_1, space)
VALUES (0, "Type1" , 5, "String", 1, "room"); 
```

但是，即使我通过 postgresql 界面手动插入，我也会遇到异常：

```
FEHLER:  Spalte »Type1« existiert nicht
LINE 2: VALUES (0, "Type1" , 5, "String", 1, "room");
                   ^ 
```

我的查询有什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T12:32:59.673

您必须使用单引号传递字符串值。像这样：

```
INSERT INTO test (id, type, test, test_String, test_1, space)
VALUES (0, 'Type1' , 5, 'String', 1, 'room'); 
```

# sql - 使用sql查询通过关键字在表中插入当前系统时间

> ID：16120351
> 
> 赞同：0
> 
> 时间：2013-04-20T12:27:21.847
> 
> 标签：sql, oracle10g

就像**sysdate**插入当前日期一样，

有没有办法使用 sql 查询**只**插入**当前时间。**

例如 *insert into table_name values(sysdate); *

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T13:49:19.840

没有任何 Oracle 数据类型仅代表一小时/分钟/秒。有`DATE`各种`TIMESTAMP`表示时间点的类型，包括日期和时间。您没有说明为什么要尝试存储它，但您可以将时间作为偏移量存储在 NUMBER 列中，作为一天的分数。

因此，如果您想查找商店周一营业的时间，您可以：

```
TRUNC( SYSDATE ) + offset 
```

# assembly - ASM用C编译，从ASM返回值到C

> ID：16120354
> 
> 赞同：1
> 
> 时间：2013-04-20T12:27:40.850
> 
> 标签：assembly, floating-point, x86

我正在从头开始学习使用编程来学习 asm，但我找不到有关当前问题的任何帮助。

所以我制作了 3 个文件（asm 中的 2 个，c 中的 1 个）。

我希望我的 C 文件能够打印其他 2 个程序的输出。C中的文件：

```
iclude <stdio.h>

float a = 1;
float b = 2;
float c = 3;

extern float asm1 (float a, float b, float c);
extern float asm2 (float a, float b, float c);

int main ()
{

float count1= 0;
float count2= 0;

count1= asm1 (a, b, c);
count2= asm2 (a, b, c);

printf("Output : %f and %f \n", count1, count2);

return 0;
} 
```

ASM 中的文件几乎相同，文件编号 1 产生 x1，文件编号 2 产生 x2。文件编号 1 使每个变量都以 1 结尾（例如 a1，x1），而 asm 中的文件编号 2 以 2 结尾（例如 a2，x2）。

```
.align 32
.data

a1: .float 0
b1: .float 0
c1: .float 0
buf1: .float 0
x1: .float 0

four1: .float 4
two1: .float 2

.text
.global asm1

asm1:

xor %eax, %eax
xor %ebx, %ebx
xor %ecx, %ecx

pushl %ebp
movl %esp, %ebp
movl 8(%ebp), %ecx
movl 12(%ebp), %ebx
movl 16(%ebp), %eax
pushl %eax
pushl %ebx
pushl %ecx

movl %eax, c1
movl %ebx, b1
movl %ecx, a1

finit 
fld a1
fld c1

**more code**

fstp x1

movl %ebp, %esp
popl %ebp
ret 
```

我希望这个文件有 x1(x2) 作为返回值，它将显示在 printf 的 C 文件中。而不是这个，我得到-nan。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T12:35:06.673

要从函数返回浮点值，您需要将返回值留在 FPU 堆栈上。

像这样

```
 addf ...
 ; leave the value one the FPU stack, don't fstp 
```

# mvvm - 输入按键的敲除事件绑定导致奇怪的行为

> ID：16120356
> 
> 赞同：7
> 
> 时间：2013-04-20T12:27:44.173
> 
> 标签：mvvm, knockout.js, dom-events, keypress, html-input

长话短说，我想让用户在输入元素上按回车键，并在我的视图模型中调用某些方法。这是我的html输入：

```
<input id="searchBox" class="input-xxlarge" type="text" data-bind="value: searchText, valueUpdate: 'afterkeydown', event: { keypress: $parent.searchKeyboardCmd}"> 
```

这是我在vm中的方法：

```
searchKeyboardCmd = function (data, event) { if (event.keyCode == 13) searchCmd(); }; 
```

一切正常，`searchCmd`当我输入输入时调用，但问题是我不能在输入中输入任何内容，即我输入输入的所有内容都被忽略。预先感谢您的帮助。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-04-20T14:52:36.627

根据 KO 文档，`true`如果您希望继续执行默认操作，则必须从事件处理程序返回。

```
searchKeyboardCmd = function (data, event) {
    if (event.keyCode == 13) searchCmd();
    return true;
}; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-30T17:35:50.560

这是一个工作示例。

[http://jsfiddle.net/tlarson/qG6yv/](http://jsfiddle.net/tlarson/qG6yv/)

```
<!-- ko with: stuff -->
  <input id="searchBox" class="input-xxlarge" type="text" 
    data-bind="value: searchText, valueUpdate: 'afterkeydown', 
    event: { keypress: $parent.searchKeyboardCmd}">   
<!-- /ko --> 
```

和javascript：

```
var stuffvm = function(){
    var self = this;

    self.searchText = ko.observable();
};

var vm = function() {
    var self = this;

    self.stuff = new stuffvm();

    self.searchCmd = function() {
        console.log("search triggered");
    };

    self.searchKeyboardCmd = function (data, event) { 
        if (event.keyCode == 13) {
            self.searchCmd(); 
        }
        return true;
    }
}

ko.applyBindings(new vm()); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-20T16:13:02.147

[这是](http://jsfiddle.net/zWWzX/1/)一个小提琴，它演示了你试图做什么，并用 keyup 替换你的代码中的事件'keypress'，并仅用函数名称删除 $parent，除非文本字段在淘汰赛 foreach 循环内..这是下面修改的代码

```
<input id="searchBox" class="input-xxlarge" type="text" data-bind="value: searchText, valueUpdate: 'afterkeydown', event: { keyup: searchKeyboardCmd}" 
```

# java - 我需要用于 Eclipse 的 Tomcat 服务器吗

> ID：16120359
> 
> 赞同：0
> 
> 时间：2013-04-20T12:28:04.133
> 
> 标签：java, eclipse, tomcat

我现在在 Win-7 平台上使用 Eclipse 和 Google App Engine Development Server。我必须使用 Java 创建一个简单的网站。我很困惑，是否需要安装 Tomcat 服务器才能使用 Eclipse 框架开发基于 Java 的站点？Tomcat可以安装在Win-7平台上吗？请对此进行指导。如果有更好的框架可用，请建议（因为我是新手）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T12:32:04.683

GAE 开发服务器专门设计用于通过模拟实际的 GAE 环境来帮助您开发适用于 Google App Engine 的应用程序。如果您计划在 GAE 上部署 webapp，那么这就是您所需要的。

如果你想开发一个标准的 Java EE webapp，那么你确实需要一个标准的 Java EE web 容器。Tomcat 就是其中之一，但您也可以使用 Jetty、GlassFish、JBooss、Resin 或任何其他 Java EE Web 容器。而且由于它们都是用 Java 编写的，它们都是多平台的，都可以安装在 Windows 上。

Eclipse 也不是一个框架。这是一个IDE。使用 Eclipse、IntelliJ、NetBeans 或文本编辑器和 JDK 开发 webapp 不会改变 webapp 的任何内容。它们只是帮助您编写 Java 代码的工具。

# makefile - 创建自动生成文件以构建两个目标

> ID：16120360
> 
> 赞同：0
> 
> 时间：2013-04-20T12:28:04.503
> 
> 标签：makefile, cmake, qmake

我一直在寻找这个已经有一段时间了，我需要一个工具来为我的项目自动创建一个 makefile 我见过 qmake 和 cmake，问题是我有两个目标（客户端和服务器）它们都使用公共库（我写的），我希望它为我创建两个目标，cmake 和 qmake 不要这样做

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T12:35:42.253

```
set(servers_srcs
    server.cpp
    foo.cpp
    bar.cpp
)

set(client_srcs
    client.cpp
    xyz.cpp
    abc.cpp
)
set(library_srcs
    lib.cpp
)

add_library(library ${library_srcs})
add_executable(client ${client_srcs})
target_link_libraries(client library)
target_link_libraries(server library) 
```

这会自动创建您的 Makefile，其中包含三个目标：客户端服务器和库。

# machine-learning - 在 Weka 中处理有时间限制的实例

> ID：16120361
> 
> 赞同：1
> 
> 时间：2013-04-20T12:28:04.817
> 
> 标签：machine-learning, weka

我是 Weka 的新手。我正在针对每个实例都有矢量输入的数据集运行一些算法。例如：

```
Instance ID, Timestamp, Sensor 1, Sensor 2, ...
1, 1, <some data>, <some data>, ..
1, 2, <some data>, <some data>, ..
1, 3, <some data>, <some data>, ..
2, 1, <some data>, <some data>, ..
2, 2, <some data>, <some data>, ..
... 
```

Weka 中是否有一些设置我可以更改以允许程序根据每个实例的元组向量进行分类，而不是每一行？

# iphone - 手机网站的问题

> ID：16120367
> 
> 赞同：0
> 
> 时间：2013-04-20T12:29:04.420
> 
> 标签：iphone, mobile, browser, web, href

我正在移动网站上练习，但遇到了两个问题。

在我的 iPhone 上，我可以按下 Safari 浏览器中间的按钮并使用“添加到主屏幕”，以便在我的 iPhone 屏幕上的其他应用程序之间放置一个“应用程序图标”。当我按下我网站的图标时，它显然会将我重定向到我的网站并且（感谢 javascript 文件）隐藏了浏览器导航栏。但是，当我在网站上按下“a href”链接时，我会被带回 safari 浏览器并在那里打开它。

我想这是因为我是这样写的：

在我的手机上，我通过 IP 地址访问该网站。有没有办法解决这个问题？

--

另一个问题：

当我在 Safari 中使用“添加到主屏幕”时，我应该给它一个名字。它会自动使用我在 HMTL 文件中给出的“标题”。但是我应该如何给应用程序一个图标？它目前只是使用某种网站的屏幕截图作为图标..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T12:36:44.677

[iphone-app-icon-html-web-app-home-screen-icon](http://alvinalexander.com/iphone/iphone-app-icon-html-web-app-home-screen-icon)

iPhone Mobile Safari 网络浏览器可识别一个特殊的 HTML 标记，可让您将 iPhone 应用程序图标添加到 HTML 应用程序。以下是允许您将 iPhone 应用程序图标添加到 Web 应用程序的语法：

```
<link rel="apple-touch-icon" href="/my-app-icon.png" /> 
```

这个在 REL 字段中带有 apple-touch-icon 的 HTML 链接标记告诉 iPhone Mobile Safari 浏览器将此图标用作您的 Web 应用程序的应用程序图标。

iPad 和 iPhone 应用程序图标像素大小

要支持更高分辨率的 iPhone 4，您的 iPhone 应用程序图标应该是 114 x 114 像素的图标。较旧的 iPhone 使用 56x56 像素图标（或可能是 57x57），而 iPad 使用 72x72 像素图标，您提供的图像将按比例缩小并适用于所有这些设备。这是一个快速的总结：

```
iPhone 4 - 114x114 pixels
Older iPhone - 57x57 pixels
iPad (version 1) - 72x72 pixels 
```

如果您希望对应用程序图标大小进行更多控制，Apple 的文档显示了以下示例：

```
<link rel="apple-touch-icon" href="touch-icon-iphone.png" />
<link rel="apple-touch-icon" sizes="72x72" href="touch-icon-ipad.png" />
<link rel="apple-touch-icon" sizes="114x114" href="touch-icon-iphone4.png" /> 
```

# c# - 如何从 LocalFolder 中的路径打开和保存（编辑）xml文件

> ID：16120370
> 
> 赞同：0
> 
> 时间：2013-04-20T12:29:33.927
> 
> 标签：c#, xml, windows-8

我在本地文件夹中保存 xml 时遇到问题。我使用他们的变量。SelectFile 是带有名称文件的属性（例如goal.xml 或goal(1).xml 等）

```
 StorageFile storageFile = await ApplicationData.Current.LocalFolder.GetFileAsync(SelectFile);
                    XDocument document = XDocument.Load(storageFile.Path);
 XDocument document = XDocument.Load(storageFile.Path); 
```

此文件加载好，但加载文件，不保存。

```
 var elementStepOne = document.Elements("StepOne").Single();
                    elementStepOne.Value = "delete content";
                    document.Save(SelectFile); // in line I try other mean write. 
```

我如何保存这个文件？我想编辑此文档并保存。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T19:18:49.187

可能有很多方法可以做到这一点。一种方法是使用文件流来保存 xml：

```
StorageFile storageFile = await ApplicationData.Current.LocalFolder.GetFileAsync(SelectFile);
XDocument document = XDocument.Load(storageFile.Path);

var elementStepOne = document.Elements("StepOne").Single();
elementStepOne.Value = "delete content";

var file = await ApplicationData.Current.LocalFolder.CreateFileAsync(
    SelectFile, 
    CreationCollisionOption.ReplaceExisting);
using (var writeStream = await file.OpenStreamForWriteAsync())
{
    document.Save(writeStream);
} 
```

# python - 如何处理 C 和 Python 之间的 IPC？

> ID：16120373
> 
> 赞同：9
> 
> 时间：2013-04-20T12:30:02.090
> 
> 标签：python, c, ipc

我有一个包含两个进程的应用程序，一个在 C 中，一个在 Python 中。C 进程是完成所有繁重工作的地方，而 Python 进程处理用户界面。

C 程序每秒向一个大缓冲区写入 4 次，而 Python 进程读取此数据。至此，与 Python 进程的通信已由 AMQP 完成。我宁愿在两个进程之间设置一些内存共享，以减少开销并提高性能。

我在这里有什么选择？理想情况下，我会简单地让 Python 进程直接读取物理内存（最好从内存而不是磁盘），然后使用信号量或类似的东西处理竞争条件。然而，这是我几乎没有经验的事情，所以我会很感激我能得到的任何帮助。

我正在使用Linux顺便说一句。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2019-07-12T16:30:02.787

这个问题被问了很久。我相信提问者已经有了答案，所以我为后来的人写了这个答案。

```
/*C code*/

#include <stdio.h>
#include <string.h>
#include <errno.h>
#include <sys/ipc.h>
#include <sys/shm.h>

#define GETEKYDIR ("/tmp")
#define PROJECTID  (2333)
#define SHMSIZE (1024)

void err_exit(char *buf) {
    fprintf(stderr, "%s\n", buf);
    exit(1);
}

    int
main(int argc, char **argv)
{

    key_t key = ftok(GETEKYDIR, PROJECTID);
    if ( key < 0 )
        err_exit("ftok error");

    int shmid;
    shmid = shmget(key, SHMSIZE, IPC_CREAT | IPC_EXCL | 0664);
    if ( shmid == -1 ) {
        if ( errno == EEXIST ) {
            printf("shared memeory already exist\n");
            shmid = shmget(key ,0, 0);
            printf("reference shmid = %d\n", shmid);
        } else {
            perror("errno");
            err_exit("shmget error");
        }
    }

    char *addr;

    /* Do not to specific the address to attach
     * and attach for read & write*/
    if ( (addr = shmat(shmid, 0, 0) ) == (void*)-1) {
        if (shmctl(shmid, IPC_RMID, NULL) == -1)
            err_exit("shmctl error");
        else {
            printf("Attach shared memory failed\n");
            printf("remove shared memory identifier successful\n");
        }

        err_exit("shmat error");
    }

    strcpy( addr, "Shared memory test\n" );

    printf("Enter to exit");
    getchar();

    if ( shmdt(addr) < 0) 
        err_exit("shmdt error");

    if (shmctl(shmid, IPC_RMID, NULL) == -1)
        err_exit("shmctl error");
    else {
        printf("Finally\n");
        printf("remove shared memory identifier successful\n");
    }

    return 0;
} 
```

```
#python 

# Install sysv_ipc module firstly if you don't have this
import sysv_ipc as ipc

def main():
    path = "/tmp"
    key = ipc.ftok(path, 2333)
    shm = ipc.SharedMemory(key, 0, 0)

    #I found if we do not attach ourselves
    #it will attach as ReadOnly.
    shm.attach(0,0)  
    buf = shm.read(19)
    print(buf)
    shm.detach()
    pass

if __name__ == '__main__':
    main() 
```

C程序需要首先执行，不要在python代码执行之前停止它，它会创建共享内存段并向其中写入一些东西。然后 Python 代码附加相同的段并从中读取数据。

完成所有事情后，按回车键停止C程序并删除共享内存ID。

我们可以在这里看到更多关于 Python 的 SharedMemory：http: [//semanchuk.com/philip/sysv_ipc/#shared_memory](http://semanchuk.com/philip/sysv_ipc/#shared_memory)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-26T08:45:36.997

**建议 #1：** 最简单的方法应该是使用 TCP。您提到您的数据量很大。除非您的数据量太大，否则使用 TCP 应该没问题。确保在 C 和 Python 中创建单独的线程以通过 TCP 传输/接收数据。

**建议 #2：** Python 支持 C 上的包装器。一种流行的包装器是 **ctypes** - [http://docs.python.org/2/library/ctypes.html](http://docs.python.org/2/library/ctypes.html)

假设您通过共享内存熟悉两个 C 程序之间的 IPC，您可以为您的 python 程序编写一个 C 包装器，该程序从共享内存中读取数据。

还要检查以下关于 python 和 C++ 之间 IPC 的讨论： [Simple IPC between C++ and Python (cross platform)](https://stackoverflow.com/questions/6915191/simple-ipc-between-c-and-python-cross-platform)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T14:12:29.330

如何将举重代码编写为 C 中的库，然后提供 Python 模块作为包装器？这实际上是一种非常常用的方法，特别是它允许在 Python 中进行原型设计和分析，然后将性能关键部分移至 C。

如果您真的有理由需要两个进程，那么 Python 中有一个 XMLRPC 包应该可以促进此类 IPC 任务。无论如何，使用现有的框架而不是发明自己的 IPC，除非你能真正证明性能需要它。

# ruby-on-rails-3.2 - 如何允许具有强参数的 Rack::Test::UploadedFile？

> ID：16120375
> 
> 赞同：6
> 
> 时间：2013-04-20T12:30:07.670
> 
> 标签：ruby-on-rails-3.2, strong-parameters

我在 Rails 3.2 中使用 strong_parameters gem。为了测试图像上传过程，我有一个带有参数的传入 post 请求：

```
{"photo"=>{"image"=>#<Rack::Test::UploadedFile:0x000000069ce1f8 @content_type="image/png", @original_filename="test.png", @tempfile=#<Tempfile:/tmp/test.png20130420-9529-1xuka4v-1>>, "status"=>"approved", "in_use"=>false}, "controller"=>"member/photos", "action"=>"create"} 
```

如何允许分配图像属性？我试过了;

```
params.require(:photo).permit(:image) 
```

但它不起作用并说`Validation failed: Image can't be blank`。

当我允许使用它的所有参数时，`params.require(:photo).permit!`它工作正常。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-06-04T17:54:59.753

来自[http://api.rubyonrails.org/classes/ActionController/Parameters.html](http://api.rubyonrails.org/classes/ActionController/Parameters.html)

> PERMITTED_SCALAR_TYPES = [字符串、符号、NilClass、数字、TrueClass、FalseClass、日期、时间、StringIO、IO、ActionDispatch::Http::UploadedFile、**Rack::Test::UploadedFile** ]

所以你只需要允许它作为一个标量类型：

```
params.require(:photo).permit(:image) 
```

刚刚测试过`Rails 4.1.1`

# java - List remove(Object object) 何时以及为何返回 false

> ID：16120378
> 
> 赞同：4
> 
> 时间：2013-04-20T12:30:19.797
> 
> 标签：java, list

该方法何时以及为什么`boolean java.util.List.remove(Object object)`返回 false？

该文件指出

> [方法返回] 如果此 List 被此操作修改，则返回 true，否则返回 false。

为什么操作不会在 List 上生效？

（注意：我正在使用的 List 的实现是`ArrayList`）

**更新：** 我试图删除的对象确实存在于列表中。我将类添加到`List`（因此是参数`this`）并将`this`（在同一个类中）传递给 remove 方法。因此该对象应该存在于列表中（或不存在？）。

**更新：** 这是代码。看看`delay()`方法。在那里我尝试从`List`.

```
public class Timer extends Object {

    private static List<Timer> allTimers;
    private Long startTime;
    private int delayTime;
    private boolean registered;

    String name;

    public Timer(String name) {
        this.name = name;
        this.registered = true;
        allTimers.add(this);
        Log.d("SpaceDroid", "Foo: Created timer: " + name + " Size: " + this.allTimers.size());

    }

    public Timer(String name, int delayTime) {
        this(name);
        this.delayTime = delayTime;

    }

    public void setDelayTime(int delayTime) {
        this.delayTime = delayTime;

    }

    public boolean delay() {
        if(this.startTime == null) {
            this.startTime = System.currentTimeMillis();
        }

        if(startTime + this.delayTime < System.currentTimeMillis()) {
            if(this.registered) {
                Log.d("SpaceDroid", "Foo: Trying to remove timer: " + name);
                if(this.allTimers.remove(this)) {
                    Log.d("SpaceDroid", "Foo: Successfully removed timer: " + name);
                }
                else {
                    Log.d("SpaceDroid", "Foo: Did not remove timer: " + name);
                }

            }
            return true;

        }
        else {
            return false;

        }

    }

    // The same as resume, just renew the startTime

    public void reset() {
        this.startTime = null;
        this.registered = true;
        this.allTimers.add(this);

    }

    public void resume() {
        this.startTime = System.currentTimeMillis();

    }

    public void pause() {
        // Check if timer is still running
        if(!this.delay()) {
            // Calculate new delayTime
            delayTime = (int) ((startTime + this.delayTime) - System.currentTimeMillis());
            Log.d("SpaceDroid", "Foo: New delay time: " + delayTime + " for timer: " + name);

        }

    }

    public static void resumeAllTimers() {
        List<Timer> timers = new ArrayList<Timer>(Timer.allTimers);
        for (Timer timer : timers) {
            timer.resume();
        }

    }

    public static void pauseAllTimers() {
        List<Timer> timers = new ArrayList<Timer>(Timer.allTimers);
        for (Timer timer : timers) {
            timer.pause();
        }

    }

    public static void disposeAllTimers() {
        Timer.allTimers.clear();
        Timer.allTimers = null;

    }

    public static void initializeAllTimers() {
        allTimers = new ArrayList<Timer>();

    }

} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-20T12:33:06.357

如果`Object`传入的实际上不在列表中，它不会对列表产生任何影响，因此返回 false。

编辑（感谢 Jai）：该方法使用特定`Object`的 s`equals()`方法来确定它是否包含该对象。因此，如果您有自定义对象，请确保您覆盖该[`equals()`](http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html#equals%28java.lang.Object%29)方法，以及[`hashCode()`](http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html#hashCode%28%29)（以维护方法之间的一般合​​同）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-20T12:44:27.577

由于 List 是一个接口，因此它不会有一个具体的实现作为示例。但是从 ArrayList 中获取，如果出现以下情况，它将返回**false**：

*   您传递 null 并且列表中没有 null 对象，或者
*   你传递了一个未在列表中找到的对象

**来自 ArrayList.java**

```
 public boolean remove(Object o) {
         if (o == null) {
             for (int index = 0; index < size; index++)
                 if (elementData[index] == null) {
                     fastRemove(index);
                     return true;
                 }
         } else {
             for (int index = 0; index < size; index++)
                 if (o.equals(elementData[index])) {
                     fastRemove(index);
                     return true;
                 }
         }
         return false;
     } 
```

为了完整起见，添加 fastRemove 的代码：

```
 private void fastRemove(int index) {
      modCount++;
      int numMoved = size - index - 1;
      if (numMoved > 0)
          System.arraycopy(elementData, index+1, elementData, index,
                           numMoved);
      elementData[--size] = null; // Let gc do its work
  } 
```

证明：

```
public static void main(String[] args) {
        ArrayList l = new ArrayList();
        System.out.println("Removing null on empty list: " + l.remove(null));
        System.out.println("Removing an object that won't be found: " + l.remove(new Object()));
} 
```

结果：

```
Removing null on empty list: false
Removing an object that won't be found: false 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-20T12:33:58.447

从这个[文档](http://docs.oracle.com/javase/6/docs/api/java/util/List.html#remove%28java.lang.Object%29)

> 如果指定元素存在，则从该列表中删除第一次出现的指定元素（可选操作）。如果此列表不包含该元素，则它不变。更正式地说，删除具有最低索引 i 的元素，使得 (o==null ? get(i)==null : o.equals(get(i))) （如果存在这样的元素）。如果此列表包含指定的元素（或等效地，如果此列表因调用而更改），则返回 true。

# llvm - LLVM中算子的全称

> ID：16120379
> 
> 赞同：0
> 
> 时间：2013-04-20T12:30:47.750
> 
> 标签：llvm, instructions

如何在 LLVM 中获取运算符的全名？

我正在遍历块，然后，在他们的每条指令中，我都尝试获取操作员名称，但我只得到了其中的一部分。运行以下代码：

```
virtual bool runOnBasicBlock(BasicBlock &bb) {
    for (auto it(bb.begin()); it != bb.end(); ++it) {
        errs() << it->getName() << '\t' << *it << '\n';
    }
} 
```

我得到如下输出行：

```
icmp        %cmp = icmp slt i32 %i.0, %argc
icmp        %cmp1 = icmp sgt i32 %call, %max.0
add       %inc = add nsw i32 %i.0, 1 
```

我想得到`icmp slt`, `icmp sgt`, and `add nsw`, 而不是`icmp`and `add`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T13:15:59.757

好吧，`slt`和`sgt`其他的`icmp`只是论点。您可以使用`getPredicate`（方法`CmpInst`）访问它们。另请参阅中的有用功能`getPredicateText`。`lib/IR/AsmWriter.cpp`

对于类似的东西`nsw`，请查看方法`hasNoSignedWrap`和类似方法。

# c# - 如何对部分列值应用数据表排序

> ID：16120382
> 
> 赞同：0
> 
> 时间：2013-04-20T12:30:57.047
> 
> 标签：c#, asp.net, sorting, data-binding, datatable

我有一个`DataTable`. 我想使用 C#`Sort`函数对列应用排序。但我在列中有多个值（带分隔符 - Æ）。

所以我真的想对列的特定部分应用排序。有没有可能。

例如 - 我的`DataTable`专栏是`Tag`。列`Tag`有两个值 -`TagId + TagName`
现在我只想在`TagName`.

我能怎么做 ？

示例 - 我的`DataTable` `dt`

> 标签
> 
> 10ÆAA -------->( `TagId`Æ `TagName`)
> 
> 15ÆBB -------->( `TagId`Æ `TagName`)
> 
> 0ÆCC -------->( `TagId`Æ `TagName`)
> 
> 20ÆGG -------->( `TagId`Æ `TagName`)

在代码中 -

`dt.DefaultView.Sort = "Tag DESC";`// -- 我尝试这段代码，但它对整列应用排序

我想要这样的结果（根据排序`TagName`）

> 标签
> 
> 20ÆGG
> 
> 0ÆCC
> 
> 15ÆBB
> 
> 10ÆAA

不像这样（未排序`TagId`）

> 标签
> 
> 0ÆCC
> 
> 10ÆAA
> 
> 15ÆBB
> 
> 20ÆGG

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T12:45:55.567

你可以`Tag`用`TagId`和`TagName`列替换列吗？这将使您的数据结构变得有意义，进而使使用它（例如排序）变得有意义。如果没有，我认为这应该可行：

```
var ordered = dt.AsEnumerable().OrderByDescending(
 x => x.Field<string>("Tag").Substring(x.Field<string>("Tag").IndexOf("Æ") + 1)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T12:35:31.090

如果您有原始列，`datatable`那么您可以使用这些列进行排序。
否则，您将不得不遍历`data-table`每一行并创建一个新行并将`data-table`其用于您的代码。

# javascript - 无法使用 Prototype 扩展我的 javascript 对象

> ID：16120383
> 
> 赞同：0
> 
> 时间：2013-04-20T12:31:14.330
> 
> 标签：javascript

我有这个代码：

```
var Flippable = function( options, element ) {
    this.$el    = $( element );
    this._init( options );
};

Flippable.prototype     = {
    _init               : function( options ) {

        this.options        = $.extend( true, {}, $.Flips.defaults, options );
        this.$pages         = this.$el.children( 'div.f-page' );
        this.pagesCount     = this.$pages.length;
        this.History        = window.History;
        this.currentPage    = this.options.current;
        this._validateOpts();
        this._getWinSize();
        this._getState();
        this._layout();
        this._initTouchSwipe();
        this._loadEvents();
        this._goto();

    },
    foo: function(){alert("foo");}
} 
```

但是当我调用 Flipppable.foo() 时，我得到了未定义。我的语法关闭的任何想法？

谢谢！

克里斯

** 更新 **

我正在创建一个这样的插件：

```
$.fn.flippable = function( method ) {

// Method calling logic
if ( Flippable[method] ) {
  return Flippable[ method ].apply( this, Array.prototype.slice.call( arguments, 1 ));
} else if ( typeof method === 'object' || ! method ) {
  return Flippable._init.apply( this, arguments ); 
```

未捕获的类型错误：无法调用未定义的方法“应用”} else { $.error('方法'+方法+'不存在于 jQuery.flippable'); }

};

它在线上很糟糕：

```
return Flippable._init.apply( this, arguments ); 
```

_init 未定义。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T12:34:15.857

原型函数只能通过类的对象访问。而不是班级本身。这会奏效。

```
var oFlip = new Flippable();
oFlip.foo(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T12:39:21.000

您尝试使用 .apply 调用 foo 的方式必须这样做。

```
Flippable.prototype.foo.apply( this, arguments ); 
```

具有 foo 属性的对象是 Flippable 上的原型，而不是 Flippable 本身。

# c++ - 创建函数采用基类指针但调用派生类函数

> ID：16120394
> 
> 赞同：3
> 
> 时间：2013-04-20T12:32:13.793
> 
> 标签：c++, inheritance

我有两个类`A`（基础）和`B`（派生自`A`）：

```
class A { };

class B : public A
{
    int data;
public:
    int get_data() { return data; }
}; 
```

现在我有一个函数测试，它接受基类指针并调用派生类函数：

```
void test(A * ptr)
{
    ptr->get_data();
} 
```

但问题是`ptr`可能指向`A`' 对象或`B`' 对象。如果它指向`B`' 对象，则可以，但如果指向`A`' 对象，则有问题。

此外，我不想`get_data()`虚拟化，因为`data`它不是`A`' 对象的属性。

如何检查是否`ptr`指向`B`'s 对象？我能想到的一种解决方案是`dynamic_cast`检查它`NULL`。这是最好的解决方案还是我可以有更好的解决方案？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-20T12:34:32.730

这意味着您的`test`功能在撒谎。意思是它会接受一个指向任何`A`对象的指针，甚至是派生自. 你最好采取以下措施：`A``B``B*`

```
void test(B* ptr)
{
   ptr->get_data();
] 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-20T13:05:10.877

如果你可以改变`A`and的接口`B`（包括添加虚函数），如果你可以重新洗牌`test`函数中的代码，你可以使用“访问者模式”。这是一个使用更好命名`Base`和`Derived`类的示例：

```
class Visitor
{
public:
    void Visit(Base * B)
    {
    }

    void Visit(Derived * D)
    {
        int data = D->get_data();
    }
};

class Base
{
public:
    virtual void Accept(Visitor * V )
    {
        V->Visit(this);
    }
};

class Derived: public Base
{
public:
    int get_data()
    {
        return data;
    }

    virtual void Accept(Visitor * V )
    {
        V->Visit(this);
    }
private:
    int data;
}; 
```

这样你就可以遍历你的向量`Base*`，调用`Accept`每个元素，并且知道只有`Derived`元素`get_data`才会调用该方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T12:52:59.893

继承对 is-a 关系建模。显然，在您的代码中 B 不是 A 并且继承是错误的模型。您在评论中提到您有一个向量被传递给一个更大的封闭函数。我建议以下其中一项更合适：

```
 1\. std::vector<boost::any>
  2\. std::vector<boost::variant<A,B>> 
```

**编辑** 这是一个使用 boost 变体的示例：

```
class A
{
public:
    void DoIt()
    {
        std::cout << "did it!" << "\n";
    }
};

class B
{
public:
    void GetIt()
    {
        std::cout << "got it!" << "\n";
    }
};

typedef boost::variant<A,B> ab_t;
typedef std::vector<ab_t> list_ab;

void test(list_ab& list)
{
    std::for_each(std::begin(list), std::end(list), [](ab_t& item)
    {
        if(A* a = boost::get<A>(&item))
            a->DoIt();
        if(B* b = boost::get<B>(&item))
            b->GetIt();
    });
} 
```

* * *

## 回答 #4

> 赞同：-4
> 
> 时间：2013-04-20T13:02:34.977

你说实际上你有一个元素 A 或 B 的向量，那么你的测试函数看起来像：

```
void test( A ** ptr ) 
```

然后你可以使用重载的 C++ 能力来制作一个实用函数，正确的函数将被调用：

```
void test( A ** ptr ) {
    A * elem;
    int i=0;
    elem = ptr[i++];
    while(elem) {
        testElement(elem);
        elem = ptr[i++];
    }
}

void testElement( A * ptr ) { }
void testElement( B * ptr ) {
    ptr->get_data();
} 
```

# node.js - NodeJS 中的 Firebase 事务总是运行 3 次？

> ID：16120395
> 
> 赞同：5
> 
> 时间：2013-04-20T12:32:25.287
> 
> 标签：node.js, firebase

每当我在 NodeJS 中定义 Firebase 事务时，我注意到它总是运行三次——前两次使用空数据，最后第三次使用实际数据。这是正常的/有意的吗？

例如这段代码：

```
firebaseOOO.child('ref').transaction(function(data) {
    console.log(data);
    return data;
}); 
```

输出以下内容：

```
null
null
i1: { a1: true } 
```

我本来希望它只打印最后一项。

要回答评论中的问题，这里与回调相同：

```
firebaseOOO.child('ref').transaction(function(data) {
    console.log(data);
    return data;
}, function(error, committed, snapshot) {
    if (error) 
        console.log('failed');
    else if (!committed)
        console.log('aborted');
    else 
        console.log('committed');
    console.log('fin');
}); 
```

产生以下输出：

```
null
null
i1: { a1: true }
committed
fin 
```

在发布问题之前，我已经阅读了有关事务如何工作的详细信息，因此我尝试将 applyLocally 设置为 false，如下所示：

```
firebaseOOO.child('ref').transaction(function(data) {
    console.log('hit'); 
    return data; 
}, function(){}, false); 
```

但它仍然命中 3 次（只是仔细检查）所以我认为这是不同的东西。在进行交易之前获得“价值”确实按预期“工作”，因为它只命中一次，这与 applyLocally 的设置无关，所以我不确定 applyLocally 的作用是什么？这就是我在交易前获取价值的意思：

```
firebaseOOO.child('ref').once('value', function(data) {
    console.log('1');
    firebaseOOO.child('ref').transaction(function(data) {
        console.log('2');
        return data;
    });
}); 
```

输出：

```
1
2 
```

@Michael：如何利用这种行为？事务主要是为了让数据使用自己来修改自己——典型的增量++场景。因此，如果我需要在现有值 10 上加 1，并继续使用 11 的结果，则函数命中的前两次我将得到需要处理的错误结果 1，最后是正确的结果第三次命中11。我怎样才能利用这两个最初的 1？另一种情况（也许我不应该为此使用事务，但如果它像我预期的那样工作，它会使代码更清晰）是插入一个值（如果它尚不存在）。如果事务只命中一次，则 null 值将意味着该值不存在，因此您可以在这种情况下将计数器初始化为 1，否则将 1 添加到任何值。随着嘈杂的零点，

似乎从这一切中得到的收获是更频繁地使用“一次”模式？

一次交易模式：

```
firebaseOOO.child('ref').once('value', function(data) {
    console.log('1');
    firebaseOOO.child('ref').transaction(function(data) {
        console.log('2');
        return data;
    });
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-21T02:36:45.543

您在此处看到的行为与 Firebase 如何触发本地事件并最终与 Firebase 服务器同步有关。在这个具体的例子中，“运行 3 次”只会在你第一次运行代码时发生——之后，状态已经完全同步，从那时起它只会触发一次。此行为在此处详细说明：[https](https://www.firebase.com/docs/transactions.html) ://www.firebase.com/docs/transactions.html （请参阅“运行事务时，会发生以下情况”部分。）

例如，如果您在同一位置有一个未完成的 on()，然后在稍后的某个时间运行相同的事务代码，您会看到它只运行一次。这是因为在事务运行之前一切都是同步的（在理想情况下；除非有任何正常的冲突等）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-11-13T07:52:19.520

transaction() 将被多次调用，并且必须能够处理空数据。即使您的数据库中存在现有数据，在运行事务功能时也可能不会在本地缓存。

```
firebaseOOO.child('ref').transaction(function(data) {

if(data!=null){
    console.log(data);
    return data;
}
else {
   return data;
 }
}, function(error, committed, snapshot) {
    if (error) 
        console.log('failed');
    else if (!committed)
        console.log('aborted');
    else 
        console.log('committed');
    console.log('fin');
}); 
```

# html - 如何让 div 停留在页面视点的顶部

> ID：16120396
> 
> 赞同：1
> 
> 时间：2013-04-20T12:32:26.833
> 
> 标签：html, css

无论您向下滚动多远，我都试图让我的 div 保持在视点的顶部。到目前为止，这是我的代码：

```
<style type="text/css"> 
#mydiv {
    position:absolute;
    top: 50%;
    left: 50%;
    width:30em;
    height:18em;
    margin-top: -9em; /*set to a negative number 1/2 of your height*/
    margin-left: -15em; /*set to a negative number 1/2 of your width*/
    border: 1px solid #ccc;
    background-color: #f3f3f3;
}
</style>
<div id="mydiv">Test Div</div> 
```

我已经查找了很多关于此的内容，但没有任何工作。帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T12:35:27.690

这对我有用。

```
position: fixed; 
```

**提示**：好奇 xxx 是如何在 css 中实现的，可以随时查看已经使用它的网站的源代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T12:33:27.657

`position`将属性更改为`fixed`：

```
position: fixed; 
```

来自[MDN](https://developer.mozilla.org/en-US/docs/CSS/position)：

> **位置：固定**
> 不要为元素留出空间。相反，将其放置在相对于屏幕视口的指定位置，并且在滚动时不会移动。打印时，将其放置在每一页上的固定位置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T19:56:22.087

在您的程序中添加以下代码 clear : both; 顶部：0px；

# linux - Errr 'mongo.js:L112 错误：无法在 src/mongo/shell/mongo.js:L112 连接到服务器 127.0.0.1:27017'

> ID：16120397
> 
> 赞同：33
> 
> 时间：2013-04-20T12:32:37.507
> 
> 标签：linux, mongodb, centos, mongoose

我无法连接到[MongoDB](http://en.wikipedia.org/wiki/MongoDB)。在 Ubuntu 中它可以工作，但我现在在[CentOS](http://en.wikipedia.org/wiki/CentOS)中工作。这是错误消息：

> MongoDB shell 版本：2.4.2
> 连接到：测试
> Sat Apr 20 07:22:09.390 JavaScript 执行失败：错误：无法在 src/mongo/shell/mongo.js:L112 连接到服务器 127.0.0.1:27017
> 异常：连接失败

我尝试删除该`mongod.lock`文件，但它不起作用。

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2013-06-01T21:36:34.737

如果您运行的是 Ubuntu，则文件夹所有权存在问题。

运行这些命令：

1.  停止 MongoDB 服务

    ```
    sudo service mongodb stop 
    ```

2.  删除 MongoDB 锁定文件

    ```
    sudo rm /var/lib/mongodb/mongod.lock 
    ```

3.  将所有权从 root 更改为 MongoDB 路径

    ```
    sudo chown -R mongodb:mongodb /var/lib/mongodb/ 
    ```

4.  启动 MongoDB 服务

    ```
    sudo service mongodb start 
    ```

5.  测试 mongo 应用程序

    ```
    mongo 
    ```

然后你将能够成功执行（我希望）。

参考：[Stack Exchange 站点*数据库管理员*对*错误的回答：更改 mongodb 数据目录时无法连接到服务器 127.0.0.1:27017 src/mongo/shell/mongo.js:91*](https://dba.stackexchange.com/questions/23438/error-couldnt-connect-to-server-127-0-0-127017-src-mongo-shell-mongo-js91-wh/23441#23441)！

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2013-04-27T02:41:14.163

尝试删除 /var/lib/mongodb/mongod.lock 并重新启动 mongo 服务

```
sudo rm /var/lib/mongodb/mongod.lock
sudo service mongodb restart 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2013-05-08T10:02:45.660

此方法仅适用于您想要修复数据文件而不保留原始文件的情况。要查找 dbpath 所在的位置，请使用

```
vim /etc/mongodb.conf 
```

检查选项`dbpath=`。

（我有`dbpath=/var/lib/mongodb`。）

默认：`/data/db/`

典型位置包括`/srv/mongodb`或。`/var/lib/mongodb``/opt/mongodb`

将**/var/lib/mongodb**替换为您的**dbpath**

```
sudo rm /var/lib/mongodb/mongod.lock
sudo mongod --dbpath /var/lib/mongodb/ --repair
sudo mongod --dbpath /var/lib/mongodb/ --journal 
```

（确保您在运行上述行的终端中保持运行状态。不要按`Ctrl`+`C`或退出它。）`mongo`现在在另一个窗口中键入要启动的命令。

我希望这对你有用！对于那些想要在保留原始文件的同时修复数据文件的人，请参阅[`mongo`恢复](http://docs.mongodb.org/manual/tutorial/recover-data-following-unexpected-shutdown/)。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-05-07T09:09:17.090

我过去也有同样的问题。就我而言，我没有足够的可用空间来存放日志文件。释放一些空间解决了这个问题。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-08-12T15:24:58.443

我不知道为什么@lkrzysiak 的回答被否决了：它对我有用！可用空间不足也可能是我遇到此错误的原因，请参阅我得到的日志：

```
 Mon Aug 12 17:02:59.159 [initandlisten] recover : no journal files present, no recovery needed
    Mon Aug 12 17:02:59.159 [initandlisten] 
    Mon Aug 12 17:02:59.159 [initandlisten] ERROR: Insufficient free space for journal files
    Mon Aug 12 17:02:59.159 [initandlisten] Please make at least 3379MB available in /var/lib/mongodb/journal or use --smallfiles
    Mon Aug 12 17:02:59.159 [initandlisten] 
    Mon Aug 12 17:02:59.159 [initandlisten] exception in initAndListen: 15926 Insufficient free space for journals, terminating
    Mon Aug 12 17:02:59.159 dbexit: 
    Mon Aug 12 17:02:59.159 [initandlisten] shutdown: going to close listening sockets... 
```

经过一些清洁以释放一些空间后，它就像一个魅力！

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-08-19T12:47:50.373

我遇到了同样的问题。在 bin 内运行 mongod（你安装了 mongodb 的地方）对我有用。我也没有足够的空间。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-02-09T05:33:10.163

它可能是 $PATH 和权限问题的组合。

尝试以下步骤：

更新您的 $PATH 变量以指向您的 MongoDB bin 文件。在我的情况下 brew install MongoDB 到这个文件夹：

```
/usr/local/Cellar/mongodb/2.4.6/ 
```

为了更新您的 $PATH 变量，请执行以下操作：

```
$ sudo vi /etc/paths 
```

然后，按“i”在 Vi 中插入文本并将您的 MongoDB 路径附加到“路径”文件的末尾并重新启动终端。

```
/usr/local/Cellar/mongodb/2.4.6/bin 
```

使用 'Esc : w q' 保存并退出 Vi 编辑器。

使用 echo 显示您的路径变量：

```
$ echo $PATH
/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin:/usr/local/Cellar/mongodb/2.4.6/bin 
```

现在尝试检查 Mongo 版本，如果你得到关注，那么你就在正确的轨道上！

```
$ mongo --version
MongoDB shell version: 2.4.6 
```

现在我们需要创建数据库目录。我使用了 MongoDB 文档中建议的默认 '/data/db' 位置。我还创建了一个日志目录，以避免在 Mongo 尝试创建任何日志时出现任何权限问题。改变所有权，这将完成这项工作。

```
$ sudo mkdir /data/db
$ sudo mkdir /data/log
$ whoami
username
$ chown -R username /data 
```

现在，我们将为首次运行“mongod”命令时提供的 MongoDB 创建一个默认配置文件。现在，我还要指出，'mongod' 将启动一个服务，它将侦听传入的数据连接。这与执行“$service mysqld start”类似。让我们继续创建配置文件。请记住，我创建了非常基本的配置文件。但是，您可以添加许多其他变量来配置 MongoDB。这是我第一次玩 MongoDB，所以我知道的和我在 MongoDB 文档上读到的一样多！我创建了“mongodb.conf”。

```
$ sudo vi /etc/mongodb.conf 
```

添加以下内容：

```
fork = true
port = 27017
quiet = true
dbpath = /data/db
logpath = /data/log/mongod.log
logappend = true
journal = true 
```

请注意，MongoDB 服务器的默认端口是 27017。请使用您在第 5 步中创建的 dbpath 和 logpath 的路径。不要忘记关闭并保存 conf 文件。

现在我们都准备好启动我们的 MongoDB 服务了。打开终端的两个实例。在终端 1 中，输入：

```
$ sudo mongod -f /etc/mongodb.conf
about to fork child process, waiting until server is ready for connections.
forked process: 3516
all output going to: /data/log/mongod.log
child process started successfully, parent exiting 
```

如果您收到上述消息，则表明您已成功启动 Mongod 服务。

现在，要连接到它，在 Terminal 2 中输入以下内容：

```
$mongo test
MongoDB shell version: 2.4.6
connecting to: test
Server has startup warnings:
Tue Sep 3 16:55:43.527 [initandlisten]
Tue Sep 3 16:55:43.527 [initandlisten] ** WARNING: soft rlimits too low. Number of files is 256, should be at least 1000
> 
```

忽略警告，但您已成功连接到“测试”数据库！凉爽的！

就这样。当我第一次尝试在我的 Mac 上安装 MongoDB 副本时，我应用了这个解决方案。看看这是否对你也有帮助。

有关详细信息，您可以访问此处 - [http://arcanebytes.com/2013/09/03/mongodb-installation-on-mac-os-x/#comment-1036112094](http://arcanebytes.com/2013/09/03/mongodb-installation-on-mac-os-x/#comment-1036112094)。

我希望它有帮助！

干杯，钦梅

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-05-27T01:51:06.483

如果您在 /etc/mongo.conf 中更改了 mongoDB 的默认端口，也会出现此错误

在这种情况下，要通过外壳连接，请使用：-

```
$mongo 127.0.0.1:your_new_port_number 
```

或者

```
$mongo -u <user> -p <pass> --host <host> --port your_new_port_number 
```

来自[MongoDB 文档](http://docs.mongodb.org/manual/reference/program/mongo/#cmdoption-mongo--port)

# asp.net - 在 asp.net 服务器中保存文件

> ID：16120409
> 
> 赞同：1
> 
> 时间：2013-04-20T12:33:24.447
> 
> 标签：asp.net, file-io

我已经建立了一个管理面板，管理员将图像上传到服务器（它们实际上是产品的图像）

起初我根据我的 ProductObject.ID 命名它们，所以当管理员将图像上传到 id 为 45 的产品时，图像将被命名为 45_1 第二张图片 45_2

但是现在我想更改它，因为在将图像添加到现有产品时效果很好，但是使用图像创建新产品会出现问题，因为在保存图像时没有产品 ID

所以我想做的是每次管理员将图像保存到服务器时，让程序为其提供唯一编号并将这些编号（23423.jpg）保存在列表中并将此列表保存到文件中

我想知道的是如何将该列表保存到文件中，然后读取它，以便我知道图像名称是唯一的

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T13:48:05.397

为确保您拥有唯一的 ID，您应该使用 Guid。如果您愿意，可以在此之前添加产品标识符：

```
Guid g = Guid.NewGuid();
String filename = productId + "_" + g.ToString(); 
```

Guid**始终**是唯一的，因此您无需担心。但是，您需要将图像标识符保存在某处以供以后访问（根据您的喜好，在数据库或文件中）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T13:57:35.460

作为@nmat 所述使用 Guid 的替代方法，您还可以使用`Path.GetTempFileName`. （[http://msdn.microsoft.com/en-us/library/system.io.path.gettempfilename.aspx](http://msdn.microsoft.com/en-us/library/system.io.path.gettempfilename.aspx)）

当您确定要对文件执行什么操作时，这将为您提供一个唯一的文件名。

# android - Android 的资源“@id”机制在自定义 XML 文件中分配 id

> ID：16120412
> 
> 赞同：2
> 
> 时间：2013-04-20T12:33:43.310
> 
> 标签：android, xml, xsd

是否可以在我自己自定义的 XML 文件中使用 Android XML 文件中使用的`@id/name`和机制？`@+id/name`

在一个 Android 项目中，我有一个 XSD 架构文件和几个使用该架构的自定义 XML。
有些元素有一个`id`字段，我想以与为 android 元素分配 id 相同的方式分配该字段；确保在我的自定义 XML 文件中所有 id 都是唯一的。

**编辑**
原始问题的描述很差。让我澄清一下：
该`@id`机制可在自定义 XML 文件中使用，我可以编写

```
<myelem id="@+id/name"/> 
```

问题是当我尝试验证 XML 文件`@id/name`（或`@+id/name`）未被识别为`unsignedInt`id 字段的类型时。

```
cvc-attribute.3: The value '@+id/name' of attribute 'id' on element 'myelem' is not valid with respect to its type, 'unsignedInt'. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T12:57:38.760

您可以在资源 XML 文件中定义 ID 并在您的 XML 中使用它。

```
<item name="idname" type="id" /> 
```

然后，当您解析 XML 时，您可以将值与[资源](https://developer.android.com/reference/android/content/res/Resources.html#getIdentifier%28java.lang.String,%20java.lang.String,%20java.lang.String%29)中的值进行比较。

```
int id = getResources().getIdentifier(idname, "id", context.getPackageName()); 
```

# install4j - 在 install4j 中支持用户名/密码字段的最佳方式

> ID：16120413
> 
> 赞同：1
> 
> 时间：2013-04-20T12:33:43.367
> 
> 标签：install4j

我有一个 install4j 安装程序，它有一个自定义屏幕，提示安装软件的用户提供用户名/密码。我知道安装程序文本框将值存储到 install4j 变量中，这些变量保存在 resource.varfile 中。存储密码的最佳方式是什么？

我们有一种情况，IT 管理员将安装软件，但实际用户应该无法查看此密码。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-22T10:20:03.053

我打开了“将编码值写入响应文件”选项，将编码值写入 response.varfile。这种编码与Base64非常相似，但我花了一些时间尝试解码一个值并没有找到任何常见的做法，但想出了一些手动的工作顺序：

```
 String encoded = appProps.password;
   byte[] data = Base64.decode(encoded);
    for (int i = 0; i<data.length; i++) {
        data[i] = ((byte) (Math.abs(data[i])- 1)) ;
    }
    String decoded = new String(data); 
```

它经过测试并且工作正常，但我无法解释它并保证它会在未来工作。页面[页面](http://resources.ej-technologies.com/install4j/help/doc/indexRedirect.html?http&&&resources.ej-technologies.com/install4j/help/doc/helptopics/concepts/variables.html)说存在另一种基于保存到 java 首选项的方法，但它不是存储密码的安全方法。检索密码字段值的最佳做法是什么？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T15:11:04.853

出于安全原因，“密码”表单组件不会将其值写入响应文件。如果您选择表单组件的“将编码值写入响应文件”属性，则会将编码值写入响应文件。这根本不安全，但会阻止临时用户在响应文件中看到纯文本密码。

# knockout.js - 映射中的绑定尚未应用于视图

> ID：16120417
> 
> 赞同：0
> 
> 时间：2013-04-20T12:34:09.513
> 
> 标签：knockout.js

在我的网站中，我希望我的表单输入具有默认文本值，但没有这样的运气..

```
 vm = { codeIncrementer: ko.mapping.fromJS({ fromNum: "1", toNum: "10", incrementerOutput: "", incrementerInput: "test code;<></" }) }; 
```

当我尝试将它们放入控制台时，vm var 保持正确的值。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T12:55:37.557

对于输入标签，使用`value`绑定而不是`text`绑定。

```
<input type="text" data-bind="value: fromNum" ... /> 
```

代替

```
<input type="text" data-bind="text: fromNum" ... /> 
```

# asp.net - asp.net global.asax.cs 和 global.asax 的区别

> ID：16120425
> 
> 赞同：1
> 
> 时间：2013-04-20T12:34:30.993
> 
> 标签：asp.net, url-routing, global-asax

我的 global.asax 文件。这好像是

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.Security;
using System.Web.SessionState;
namespace xxxx
{
    public class Global : System.Web.HttpApplication
    {

        protected void Application_Start(object sender, EventArgs e)
        {

        }    
    }
} 
```

但是当我查看其他 global.asax 文件时，它看起来像

```
<%@ Application Language="C#" %>
<%@ Import Namespace="System" %>
<%@ Import Namespace="System.Diagnostics" %>

<script runat="server">

void Application_Start(object sender, EventArgs e)
{
    // Code that runs on application startup
}
</script> 
```

为什么我的 global.asax 文件与他们不同？我使用 4.0 框架。当我尝试路由时，我的项目看不到我的路由规则。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T14:58:21.763

你的“Global.asax”实际上是一个“Global.asax.cs”——你的 Global.asax 本身可能看起来像这样：

```
<%@ Application Codebehind="Global.asax.cs" Inherits="x.Global" Language="C#" %> 
```

这`Global.asax.cs`就是所谓的代码隐藏文件。这两种方法在功能上没有真正的区别——代码隐藏只是为了分离标记和服务器端代码之间的关注点而设计的。

这与您遇到的任何路由问题无关。

# ruby - 使用轮胎在 ElasticSearch 中设置属性类型而不设置 _type

> ID：16120427
> 
> 赞同：1
> 
> 时间：2013-04-20T12:34:33.540
> 
> 标签：ruby, elasticsearch, tire

我要索引的文档有一个名为 name 的属性`type`。当我使用轮胎存储它时，例如：

```
Tire.index 'mydocuments' do
   delete
   create
   store :name => name, :type => 'pdf'
   refresh
end 
```

然后这个文档是索引`_type = pdf`，因此我可以访问它`http://localhost:9200/mydocuments/pdf/id`。

但是我怎样才能改变这一点，类型是 （单数）而不是从来自文档源的`mydocument`我的实际属性中复制。`type`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-21T08:49:21.483

你可以为你的对象实现一个`document_type`方法，或者`_type`为一个 Hash 使用一个属性；见[https://github.com/karmi/tire/blob/master/lib/tire/index.rb#L456-L459](https://github.com/karmi/tire/blob/master/lib/tire/index.rb#L456-L459)

# unix - 想要从第 3 列从行尾开始排序 csv 文件而不是开始

> ID：16120435
> 
> 赞同：0
> 
> 时间：2013-04-20T12:35:38.597
> 
> 标签：unix, sorting, csv

我想使用 unix 排序命令对 csv 文件进行排序，并且没有列可以非常逐行但最后的第三列保持不变我将如何对该文件实施 unix 排序命令？

我试过排序 -t"," -k? 文件名.csv

但我不知道用 k 输入什么，因为它将是从一开始的列号，而不是从最后一列

样本数据

```
"Hotel_Dom","4STRAVELCOMPANY@GMAIL.COM","4STRAVELCOMPANY@GMAIL.CO","NH57014106349",1280082600,"B2B","10037"
"Hotel_Dom","68MHOSPITALITY@GMAIL.COM","68MHOSPITALITY@GMAIL.COM","NH5520894246",1280023222,"B2B","1670"
"DF","00000000@11111.COM","FLTINT1000130394756","12800231456","B2C","6799.2"
"Rail","00000.POO@GMAIL.COM","NR251764697478",1280084511,"B2C","2025" 
```

现在我想使用 unix 排序命令根据日期对其进行排序所以我已经将日期转换为自纪元以来的时间，但在我的 csv 起始列的数量上有所不同，所以我想将排序应用于从最后一行开始的第三行，它始终是日期

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T12:51:03.497

```
awk -F, '{print $(NF-2)FS$0}' filename.csv | sort -n |  sed 's/^[^,]*,//' 
```

希望这有效 +

# android - Android 拆分 ActionBar 填充

> ID：16120438
> 
> 赞同：2
> 
> 时间：2013-04-20T12:35:44.513
> 
> 标签：android, styles, android-actionbar, actionbarsherlock, padding

在我的应用程序中，我的屏幕顶部有一个操作栏，使用以下代码填充很好：

```
<style name="TestTheme" parent="Theme.Sherlock">
    <item name="actionButtonStyle">@style/MyActionButtonStyle</item>
    <item name="android:actionButtonStyle">@style/MyActionButtonStyle</item>
</style>

<style name="MyActionButtonStyle" parent="Widget.Sherlock.ActionButton">
    <item name="android:minWidth">32dip</item>
    <item name="android:padding">0dip</item>
</style> 
```

但是，此代码对我在清单中使用此代码时得到的 Split ActionBar 没有影响

```
android:uiOptions="splitActionBarWhenNarrow" 
```

这是拆分操作栏当前的样子：

![在此处输入图像描述](https://i.stack.imgur.com/U8LeX.jpg)

是否可以为按钮提供相等的间距/删除填充，以便它们都同样适合屏幕底部？我之前问过类似的问题，但是我认为我的问题并不清楚。任何反馈都会很棒，谢谢！

# c# - 无法更改 PCL 的目标框架

> ID：16120439
> 
> 赞同：1
> 
> 时间：2013-04-20T12:35:50.080
> 
> 标签：c#, windows-phone-7, windows-8, portable-class-library

我正在尝试创建一个跨平台项目，以便重用 Windows Phone (7.5) 和 WinRT 简单游戏中的大部分代码。我正在尝试使用可移植类库，现在官方支持 WinPhone 7.5 项目（Microsoft.Bcl.Async）中的异步操作。我在为 Bcl.Async 安装 NuGet 包时遇到问题（找不到兼容的框架），在谷歌搜索后我发现问题是我的 PCL 的目标是 Windows Phone 7（不是必需的 7.5）项目。

问题是，如果我尝试以 WinPhone 7.5 为目标，我会收到以下消息：

![自动降级到 Windows Phone 7](https://i.stack.imgur.com/q2lxW.png)

为什么我不能以 Windows Phone 7.5 为目标？有办法强制吗？（对不起，也许这是一个真正的菜鸟问题......但我无法在任何地方找到答案）。另请注意，这是一个有效的框架组合，如您可以在此处找到的 msdn 指南中所述：http: [//msdn.microsoft.com/en-us/library/gg597391.aspx](http://msdn.microsoft.com/en-us/library/gg597391.aspx)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-21T22:46:17.373

我找到了解决这个问题的方法......我是原因=）我正在尝试使用 MvvmCross 和 Xamarin 来编写跨平台代码，但是当我改变时我犯了一些错误Profile104 为我的 PCL 提供 Mono for Android 目标。删除这个解决了我的问题。

无论如何，感谢大家的回答。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T15:27:26.363

您只能在面向 .NET 4.5、Windows Store 和 Windows Phone 8 应用程序的 PCL 项目中使用`async`/ `await`。因为 Windows Phone 7.5 对异步的支持不是开箱即用的，并且依赖于开发人员的机器，所以您可能会遇到此类问题。我的第一个建议是[更新 SDK](http://go.microsoft.com/fwlink/?LinkId=276663)。

您应该以 Windows Phone 8 为目标，以使其在默认情况下正常工作。

# c++ - 在 C++ 中将字符串声明为 std:string

> ID：16120443
> 
> 赞同：2
> 
> 时间：2013-04-20T12:36:07.147
> 
> 标签：c++, string, private-members

这基于 GCC/G++，通常在 Ubuntu 上。

这是我完成的示例程序：

```
#include <iostream>

using namespace std;

int main()
{
    std::string c = "Test";
    cout << c;
    return 0;
} 
```

上面的代码工作正常。

但是我有两个问题我不太明白......

1.  将字符串声明编写为`std:string`（使用 one `:`）也可以正常工作。有什么不同？

2.  如果我在一个类中使用`std:string`(with one `:`) 来声明一个私有变量，我会收到一个错误**错误：'std' does not name a type**。此声明的示例：

```
class KType
{
private:
    std:string N;
}; 
```

有人可以解释这些问题吗？非常感谢！

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-20T12:38:21.683

> 将字符串声明编写为 std:string 也可以正常工作。有什么不同。

如果您以不同的方式格式化，差异会更明显：

```
std:
    string c = "Test"; 
```

您正在声明一个名为的*标签*`std`，并使用`string`已被转储到全局命名空间中的名称`using namespace std;`。将其正确编写为`std::string`，您使用的`string`是`std`命名空间中的名称。

> 如果我`std::string`在一个类中使用它来声明一个私有变量，我会得到一个错误错误：`‘std’ does not name a type.`

那是因为您不能将标签放在类定义中，只能放在代码块中。你必须在`std::string`那里正确地写它。（如果类是在头文件中定义的，那么`using namespace std`这比在源文件中更糟糕，所以我敦促你不要这样做。）

此外，如果您正在使用`std::string`，那么您应该`#include <string>`. 由于引入`<iostream>`的定义超出了需要，您的代码看起来像是意外工作，但您不能便携地依赖它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-20T12:37:20.493

您需要包含字符串类头：

```
#include <string> 
```

此代码有错字，缺少第二个冒号

```
std:string N; 
```

应该：

```
std::string N; 
```

使用单个冒号，它成为 goto 的标签，这可能不是您的意思。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-20T12:38:20.357

**第一个问题：**

首先，您缺少`#include <string>`指令。您不能自动依赖其他标题（例如`<iostream>`）到`#include`标题`<string>`。除此之外：

**第二个问题：**

> 将字符串声明编写为 std:string 也可以正常工作。有什么不同。

那是因为您在全局命名空间范围内有一个（邪恶的）`using`指令：

```
using namespace std; 
```

该指令的效果是将`std`命名空间中的所有名称都导入到全局命名空间中。这就是为什么完全合格`std::string`和不合格`string`会解析为同一类型的原因。

如果您省略了该指令，则在使用非限定名称`using namespace std;`时会出现编译器错误。`string`

**第三个问题：**

> 如果我在一个类中使用这个 std::string 来声明一个私有变量，我会得到一个错误错误：'std' 没有命名一个类型。此声明的示例：

您缺少一个冒号。那应该是：

```
std::string
//  ^ 
```

并不是

```
std:string
// ^ 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-20T12:38:05.340

> 将字符串声明编写为 std:string 也可以正常工作。有什么不同。

没有区别，除非您声明其他名为`string`. 在您的代码中，`string`并`std::string`引用相同的类型。`using namespace std`但不惜一切代价避免。

> 如果我在一个类中使用这个 std::string 来声明一个私有变量，我会得到一个错误错误：'std' 没有命名一个类型。此声明的示例：

您需要`#include <string>`才能使用`std::string`. 正在发生的事情是，在您的第一个代码示例中，`<iostream>`似乎包括`<string>`. 你不能依赖它。您必须包括`<string>`.

# ios6 - 限制 UITextField 中小数点前后的位数

> ID：16120444
> 
> 赞同：0
> 
> 时间：2013-04-20T12:36:07.613
> 
> 标签：ios6, uitextfield, limit, digits, uitextfielddelegate

我想限制在 UITextField 中输入的数字。这是我的代码

```
#define MAX_NO_OF_DIGITS_BEFORE_DECIMAL 8

 - (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string
{
    switch (textField.tag)
    {
        case BUY_ITEM_TEXTFIELD_TAG:
        {
            if (![textField.text length]>0) {
                textField.text = [CURRENCY_TYPE stringByAppendingFormat:@"%@",self.buyTextField.text];
            }
        }
            break;
        case BID_INCREMENT_TEXTFIELD_TAG:
        {
            if (![textField.text length]>0) {
       textField.text = [CURRENCY_TYPE stringByAppendingFormat:@"%@",self.bidTextField.text];
            }
        }
            break;
        case STARTING_BID_TEXTFIELD_TAG:
        {
            if (![textField.text length]>0) {
        textField.text = [CURRENCY_TYPE stringByAppendingFormat:@"%@",self.startingBidTextField.text];
            }
        }
            break;
        case SHIPPING_CHARGES_TEXTFILED:
        {
            if (![textField.text length]>0) {
         textField.text = [CURRENCY_TYPE stringByAppendingFormat:@"%@",self.chargesTextField.text];
            }
        }
            break;
        default:
            break;
    }

    NSString *newString = [textField.text stringByReplacingCharactersInRange:range withString:string];

    // Check if we have 8 digits before decimal points
    NSString *tempStr = [newString stringByReplacingOccurrencesOfString:CURRENCY_TYPE withString:@""];
    if ([tempStr length]==MAX_NO_OF_DIGITS_BEFORE_DECIMAL)
    {
        // Check if we have only 1 decimal point
        NSArray  *arrayOfString = [newString componentsSeparatedByString:@"."];
        if ([arrayOfString count] > 2 )
        {
            return NO;
        }
        else {
            textField.text = [NSString stringWithFormat:@"%@%@%@",CURRENCY_TYPE,tempStr,@"."];
        }
    }

    // Check if we have only 1 decimal point
    NSArray  *arrayOfString = [newString componentsSeparatedByString:@"."];
    if ([arrayOfString count] > 2 )
    {
        return NO;
    }

    // Check if we have only 2 digits after decimal point
    if([arrayOfString count]>=2)
    {
        NSString *sepStr=[NSString stringWithFormat:@"%@",[arrayOfString objectAtIndex:1]];
        return !([sepStr length]>2);
    }

    return YES;

} 
```

`12345678.8`但我的问题是当我输入 12345678 时，它会将小数点放在 8 之后并再次放置 8 所以我的输出看起来像`12345678.`

我想要实现的是

1) 用户只能在小数点前输入 MAX_NO_OF_DIGITS_BEFORE_DECIMAL 和小数点后 2 位数字

我不明白为什么最后 8 会在此重复。有谁能够帮我 ？

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-02-10T11:04:55.023

试试下面的代码

```
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range  replacementString:(NSString *)string 
```

{

```
NSString *newString = [textField.text stringByReplacingCharactersInRange:range withString:string];

// Check if we have 3 digits before decimal points
int maxNoOfDigitsBeforeDecimal = 3;
// Check if we have 2 digits after decimal points
int maxNoOfDigitsAfterDecimal = 2;

// Check if we have no decimal point yet and more than 3 digits are entered
NSArray  *arrayOfString = [newString componentsSeparatedByString:@"."];

if (([arrayOfString count] == 1 ) && ([newString length] > maxNoOfDigitsBeforeDecimal))
{
    return NO;
}

 // Check if we have only 1 decimal point
if ([arrayOfString count] > 2 )
    return NO;

// Check if we have only 2 digits after decimal point
if([arrayOfString count] >= maxNoOfDigitsAfterDecimal)
{
    NSString *sepStr = [NSString stringWithFormat:@"%@",[arrayOfString objectAtIndex:1]];
    return !([sepStr length] > maxNoOfDigitsAfterDecimal);
}

return YES; 
```

}

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T17:20:04.837

首先，将日志记录添加到每个步骤以查看发生的情况或调试。

问题是您正在修改字符串（以创建 newString 变量）。然后将句点添加到末尾并将其设置为文本字段的新值。然后你返回是（你后面的检查不使用新的文本字段值）。所以你添加“8”和句号，然后要求框架添加“8”。

# java - JNI 通过引用返回数据

> ID：16120445
> 
> 赞同：0
> 
> 时间：2013-04-20T12:36:07.753
> 
> 标签：java, java-native-interface

我正在为我的本机代码编写 JNI 包装器，我的代码是 fallows

我的Java本机方法->

```
public native static String GetMimo(String input, String out1,
        String out2); 
```

我的 C 原生方法 ->

```
jstring Java_test_mimo_mimojni_DataFecth_GetMimo( JNIEnv* env,String input, String output1, String output2);
{

char *outmimoOne , *outmimoTwo;
GetMimo(&outmimo, &outmimoTwo); // My Native code function call , it allocates the memory and fill the data 

return (*env)->(env,outmimoTwo);
} 
```

在这里，我想将数据 outmimoOne 返回到 output1 并将 outmimoTwo 返回到 output2 。由于我是 Java 新手，我如何将这两个变量作为我们在 C 中通过引用获取的方式返回到我的 java 调用中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T12:41:14.447

创建一个对象或数据结构，其中包含两个引用并返回：

```
public class Pair<T1, T2> {
    private final T1 x;
    private final T2 y;

    public Pair<T1, T2>(T1 a, T2 b) {
        this.x = a;
        this.y = b;
    }

    public T1 getX() { return this.x; }
    public T2 getY() { return this.y; }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T21:51:13.360

虽然我更喜欢*将结果作为返回值返回*，但这是 C 中的风格问题。如果你想在 Java 中模仿这种风格，你必须使用容器对象作为参数。传统的方法是传入一个数组对象，期望函数将结果设置到第一个元素中。由于在您的情况下，您使用的是字符串参数，因此您可以创建`java.lang.StringBuilder`对象并将其作为参数传递，并且该函数可以附加值。

无论哪种情况，您都必须在 C 端使用 JNI API 做大量工作，才能将您的值设置到参数对象中。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-20T12:40:48.187

你不能。在 Java 中，参数是按值传递的。因此，该方法接收到调用者对 out1（和 out2）的引用的*副本*。调用者不会看到您分配给此副本的任何内容，因为它是一个副本。

# python - 使用烧瓶不安分的多对多关系，发布一对多数据

> ID：16120446
> 
> 赞同：7
> 
> 时间：2013-04-20T12:36:28.427
> 
> 标签：python, many-to-many, flask, http-post, flask-restless

我的问题是关于如何使用 post 添加多个多对多的关系数据

我正在使用烧瓶、flask-SQLAlchemy、flask-restless 和 angularjs、json

我有一些这样的桌子

```
class Page(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    page_name = db.Column(db.String(10)) 

class Tag(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    tag_name = db.Column(db.String(10))

class PageTags(db.Model):
    page_id = db.Column(db.Integer, db.ForeignKey('page.id'),  primary_key=True)
    tag_id = db.Column(db.Integer, db.ForeignKey('tag.id'),  primary_key=True)
    info = db.Column(db.Text)

    tag = db.relationship('Tag', backref='tag')
    page = db.relationship('Page', backref='pagetags') 
```

我想发布这样的数据

```
{
    "id": 1,
    "page_name": "p1",
    "pagetags": [
        {
            "info": "pt1",
            "page_id": 1,
            "tag_id": 1
        },
        {
            "info": "pt2",
            "page_id": 1,
            "tag_id": 2
        }
        ]
} 
```

我希望将其添加到数据库中，这将创建三件事：

一页和两个pagetags。

我可以不安地做到这一点吗？以及怎么办？

提前欣赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-06T15:10:19.770

从[这里](https://flask-restless.readthedocs.org/en/latest/customizing.html#specifying-which-columns-are-provided-in-responses)：

```
apimanager.create_api( Page, include_columns = [
    'id', 'page_name', 'pagetags.info', 'pagetags.page_id', 'pagetags.tag_id'
] ) 
```

# javascript - 为 OSRM 路由获取 JSON

> ID：16120449
> 
> 赞同：0
> 
> 时间：2013-04-20T12:37:04.763
> 
> 标签：javascript, jquery, ajax, openstreetmap, osrm

我使用 cloudmade API 成功地在我的网站中实现了一个路由系统。我也想对 OSRM 路由系统 ( [https://github.com/DennisOSRM/Project-OSRM](https://github.com/DennisOSRM/Project-OSRM) ) 做同样的事情，但我在获取 OSRM json 输出时遇到了一些麻烦。

以下是从 cloudmade API 检索 json 的示例：

使用 $.ajax - [http://jsfiddle.net/mayooresan/FhfVW/2/](http://jsfiddle.net/mayooresan/FhfVW/2/)

```
$(function () {
$("#getJSON").click(function () {
    var url = "http://routes.cloudmade.com/c6f2762bfe00414f822a9dec443569f5/api/0.3/51.500,0.100,51.500,0.1001/car.js";
    $.ajax({
        async: false,
        dataType: "jsonp",
        url: url,
        success: function (data) {
            test = data.route_geometry;
            alert(test);
        }
    });
});
}); 
```

使用 $.getJSON - [http://jsfiddle.net/V3qgZ/72/](http://jsfiddle.net/V3qgZ/72/)

```
$(function () {

$("#getJSON").click(function () {

    $.getJSON("http://routes.cloudmade.com/c6f2762bfe00414f822a9dec443569f5/api/0.3/51.500,0.100,51.500,0.1001/car.js?callback=?", function (data) {
        var test = data.route_geometry;
        alert(test);
    });
});
}); 
```

OSRM 的服务器 API 位于此处：[https](https://github.com/DennisOSRM/Project-OSRM/wiki/Server-api) ://github.com/DennisOSRM/Project-OSRM/wiki/Server-api （查询的服务器位置位于[http://router.project-osrm.org](http://router.project-osrm.org)）。

将 url 与上面使用的相同坐标 ( [http://router.project-osrm.org/viaroute?loc=51.500,0.100&loc=51.500,0.1001](http://router.project-osrm.org/viaroute?loc=51.500,0.100&loc=51.500,0.1001) ) 放入浏览器检索一个 json 文件。但无论我尝试将它与 $.getJSON 或 $.ajax 一起使用 - 使用回调，设置数据类型，我都无法获取 json 数据，这让我发疯了！我确信这是可能的，因为它记录在 API 中。

非常感谢任何帮助。

缺口

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-02-19T16:04:03.283

时间过去了，我想我会回答这个问题，以防万一有人遇到同样的问题。

OSRM 的 JSON 响应与 Cloudmade 返回的不同。您问题中的 OSRM wiki 实际上回答了这个问题。来自 OSRM 的 JSON 已编码，您需要对此进行特殊处理。引用维基，

> 路线的几何形状以编码形式传输。

长话短说，有人已经为我们简化了工作。看看这个：[https ://github.com/perliedman/leaflet-routing-machine](https://github.com/perliedman/leaflet-routing-machine)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T13:32:09.620

这是 jquery 的事情：新版本默认添加一个回调参数，所以你的 url 最终会像[http://router.project-osrm.org/viaroute?loc=51.500,0.100&loc=51.500,0.1001&callback=jQuery1504317377423867583_1366895174226&_= 1366895275399](http://router.project-osrm.org/viaroute?loc=51.500,0.100&loc=51.500,0.1001&callback=jQuery1504317377423867583_1366895174226&_=1366895275399)。OSRM 不喜欢这样。

有关如何防止这种情况的建议，请参阅“[为什么使用 jQuery AJAX 请求将回调参数添加到查询字符串](https://stackoverflow.com/questions/5496773/why-callback-parameter-is-added-to-query-string-using-jquery-ajax-request)”的答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T12:45:37.643

试试这个：（实际上jQuery在内部解析json）

[检查这个小提琴](http://jsfiddle.net/vickyixltech/FhfVW/9/)

```
$(function () {

$("#getJSON").click(function () {

$.getJSON("http://routes.cloudmade.com/c6f2762bfe00414f822a9dec443569f5/api/0.3/51.500,0.100,51.500,0.1001/car.js?callback=?", function (data) {
    var test = data.route_geometry;
            alert(JSON.stringify(test));

    });
});
}); 
```

# javascript - 如何从html5中的图像中读取文本

> ID：16120461
> 
> 赞同：0
> 
> 时间：2013-04-20T12:38:27.470
> 
> 标签：javascript, html, html5-canvas

我想制作移动网络应用程序。这个应用程序的目的是它会从 jpg 图像中读取文本并将该文本保存在手机中。有没有办法使用 HTML5 从图像或照片中读取文本和数字（包含所有文本和数字，没有复杂的形状或其他东西）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T12:44:47.740

我怀疑 HTML5 是否包含 OCR 或图像处理的必要手段。然而，有适合此任务的本机和 java 库。但总的来说，OCR 和图像处理是相当先进的领域，你需要大量的知识来实现​​它。

这是可用于（并实际使用）手机中 OCR 的开源 Java 库：

[http://sourceforge.net/projects/javaocr/](http://sourceforge.net/projects/javaocr/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T13:00:47.843

使用简单欧几里得距离比较的库可能对此有所帮助。请参阅[此处](http://www.heatonresearch.com/fun/ocr)

# jsf - 如果我扩展 PrimeFaces DataTable，则不会在它中接收事件

> ID：16120462
> 
> 赞同：3
> 
> 时间：2013-04-20T12:38:41.670
> 
> 标签：jsf, primefaces, datatable

我正在扩展 PrimeFaces 数据表。当我这样做时，当我不扩展它时，我不再得到我收到的 Ajax 事件。这不是我在扩展中所做的任何事情，因为我删除了覆盖的 DataTable 中的所有方法，但仍然没有 Ajax 事件。

以下是相关代码：

```
public class MyDataTable extends DataTable {
} 
```

在我的 faces-config.xml 中：

```
<component>
    <component-type>org.primefaces.component.DataTable</component-type>
    <component-class>com.xxx.MyDataTable</component-class>
</component> 
```

就是这样......在这样做之后，DataTable 通常接收的事件（在我的情况下是 contextMenu 事件）不再被接收。除此之外，DataTable 似乎可以正常运行。

我是否需要做其他事情才能使事件顺利进行？我不知道这是我正在做的事情，PrimeFaces 错误还是 MyFaces 错误。

我得到了 PrimeFaces 源代码并在 queueEvent(event) 方法中放置了一个断点。如果我不扩展控件，它会被击中，但如果我扩展它则不会。

我正在使用 WebSphere 8.5.1 附带的 PrimeFaces 3.5 和 MyFaces 2.1.5 实现。

谢谢你的帮助。PrimeFaces 论坛上没有人回答我的问题，所以我真的很绝望......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-24T08:56:55.687

我将自定义数据表重命名为 DataTable 并获取 Ajax 事件。

```
public class DataTable extends org.primefaces.component.datatable.DataTable {
} 
```

# javascript - 使用一个下拉菜单更改多个元素

> ID：16120463
> 
> 赞同：0
> 
> 时间：2013-04-20T12:38:52.277
> 
> 标签：javascript, drop-down-menu, getelementsbyclassname

为什么这个小提琴不起作用：

[jsFiddle根据类名改变span内容](http://jsfiddle.net/Q4GQx/1/)

```
<label>Change:</label>
<select name="list" id="list">
<option value="Test_a" selected>Test_a</option>
<option value="Test_b">Test_b</option>
<option value="Test_c">Test_c</option>
<option value="Test_d">Test_d</option>
</select>
<br/>1: <span name="result" class="result">Test_a</span>
<br/>2: <span name="result" class="result">Test_a</span>
<br/>3: <span name="result" class="result">Test_a</span>

<script>
var list1 = document.getElementById('list');
var tag1 = document.getElementsByClassName('result');

for (var i = 0; i < elems.length; i++) {
list1.onchange = function () {
    tag1.innerHTML = this.value;
};
};
</script> 
```

我希望能够更改所有三个`spans`( `class="result"`) 以显示下拉菜单选项的相同值。

如果我使用`getElementById`并且只有一个`span`结果，它工作正常`id="result"`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T12:47:21.403

我想[这就是你所追求的](http://jsfiddle.net/Q4GQx/2/)。更改列表时，使用列表的值更新所有跨度。

```
var list = document.getElementById('list');
var spans = document.getElementsByClassName('result');

list.onchange = function () {
    for (var i = 0; i < spans.length; i++) {
        spans[i].innerHTML = this.value;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T12:50:26.063

> 为什么这个小提琴不起作用

因为`tag1`在您的代码中不是对单个 DOM 元素的引用，它会有一个`.innerHTML`属性，但是该方法返回匹配元素的[HTMLCollection](https://developer.mozilla.org/en-US/docs/DOM/HTMLCollection)，如果您想单独操作它们，则必须循环遍历：

```
list1.onchange = function () {
  for (var i=0, l=tag1.length; i<l; i++) {
    tag1[i].innerHTML = this.value;
  };
}; 
```

# mysql - 统计数据库中的总数

> ID：16120466
> 
> 赞同：1
> 
> 时间：2013-04-20T12:39:00.353
> 
> 标签：mysql

我想让用户可以看到他们来自哪里以及有多少评论并按国家/地区分组：

这个对吗？

```
<script type='text/javascript'>
 google.load('visualization', '1', {'packages': ['geochart']});
 google.setOnLoadCallback(drawRegionsMap);

  function drawRegionsMap() {
    var data = google.visualization.arrayToDataTable([
      ['Country', 'Politics'],
      <?php 
      $sql = mysql_query("SELECT country FROM comments WHERE userid = '$userid' AND GROUP BY country");
      $output = "";
      $countpeople = mysql_num_rows($sql); 
      while( $row = mysql_fetch_array($sql)){
          }
        echo $output;
      ?>
    ]);

    var options = {'backgroundColor': '#E9F6FD'};

    var chart = new google.visualization.GeoChart(document.getElementById('chart_div'));
    chart.draw(data, options);
};
</script> 
```

有没有办法进行 SELECT SUM？

感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T12:50:56.163

在发布的所有代码中，只有查询与此问题相关，因此您需要的查询是：

```
SELECT country, count(*) as total
FROM comments
WHERE userid = '$userid'
GROUP BY country 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T12:42:41.817

是的，您可以通过修改查询来做到这一点

```
$sql = mysql_query("SELECT sum(country) as total FROM comments WHERE userid = '$userid' AND GROUP BY country"); 
```

你可以出去投入

```
echo $row['total'] 
```

# python - Python：比较两个文件夹并将同名文件从一个文件夹移动到另一个文件夹

> ID：16120469
> 
> 赞同：1
> 
> 时间：2013-04-20T12:39:14.110
> 
> 标签：python

我在 Windows 中有两个文件夹。这两个文件都具有相同的名称但具有不同的扩展名。我正在尝试比较这两个文件夹，如果它们有同名的文件，我需要将它们从一个文件夹复制到另一个文件夹。

我已经使用批处理程序完成了这项工作，但我想使用 Python 来完成这项工作。我在这里搜索并得到了一些零碎的东西，但是我不确定我是否正确？你们能帮帮我吗？

```
exm1=[os.path.splitext(x)[0] for x in os.listdir(r'\Path') if os.path.splitext(x)[1]=='.trn']
exm2=[os.path.splitext(x)[0] for x in os.listdir(r'\Path') if os.path.splitext(x)[1]=='.trn'] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T13:03:22.713

您正在做的只是为了列出没有扩展名的基本名称。您缺少的是检测缺少的内容。

如果您可以轻松地重建目录 1 中的文件名；因为它们具有所有相同的扩展名，例如；然后我会在这里使用*[集合](http://docs.python.org/2/library/stdtypes.html#set-types-set-frozenset)*；sets 使列出两个目录之间的差异变得容易：

```
import os.path
import shutil

source = r'\Path1'
dest = r'\Path2'

sourcefiles = {os.path.splitext(x)[0] for x in os.listdir(source) if os.path.splitext(x)[1] == '.ext1'}
destfiles = {os.path.splitext(x)[0] for x in os.listdir(source) if os.path.splitext(x)[1] == '.ext2'}

for missing in sourcefiles - destfiles:   # calculate the difference
    sourcefile = os.path.join(source, missing + '.ext1')
    destfile = os.path.join(dest, missing + '.ext2')
    shutil.copy(sourcefile, destfile) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T13:04:37.087

这会将不在文件夹 1 中的所有文件复制到 2，反之亦然

```
import os
import shutil

folder1 = "C:\\path\\folder\\1\\"
folder2 = "C:\\path\\folder\\2\\"
data_folder1 = [(x[0], x[2]) for x in os.walk(folder1)]
data_folder2 = [(x[0], x[2]) for x in os.walk(folder2)]

x=0
for file in data_folder1[0][1]:
    if file not in data_folder2:
        shutil.copy(folder1+data_folder1[0][1][x], folder2+data_folder1[0][1][x])
    x+=1

y=0
for file in data_folder2[0][1]:
    if file not in data_folder1:
        shutil.copy(folder2+data_folder2[0][1][y], folder1+data_folder2[0][1][y])
    y+=1 
```

# java - 线程“主”java.lang.NoSuchFieldError 中的异常：DEF_CONTENT_CHARSET

> ID：16120471
> 
> 赞同：6
> 
> 时间：2013-04-20T12:39:29.233
> 
> 标签：java, solrj

您好，我尝试在我的 java 应用程序的 solr 中索引我的数据库中的一行。我已经添加了必要的罐子，但我不断收到这个错误。我的 solr 架构是正确的，我提出的请求只是向我的数据库添加新行，我希望它也被索引

这是错误

```
SLF4J: Failed to load class "org.slf4j.impl.StaticLoggerBinder".
SLF4J: Defaulting to no-operation (NOP) logger implementation
SLF4J: See http://www.slf4j.org/codes.html#StaticLoggerBinder for further details.
Exception in thread "main" java.lang.NoSuchFieldError: DEF_CONTENT_CHARSET
    at org.apache.http.impl.client.DefaultHttpClient.setDefaultHttpParams(DefaultHttpClient.java:175)
    at org.apache.http.impl.client.DefaultHttpClient.createHttpParams(DefaultHttpClient.java:158)
    at org.apache.http.impl.client.AbstractHttpClient.getParams(AbstractHttpClient.java:448)
    at org.apache.solr.client.solrj.impl.HttpClientUtil.setFollowRedirects(HttpClientUtil.java:223)
    at org.apache.solr.client.solrj.impl.HttpClientConfigurer.configure(HttpClientConfigurer.java:58)
    at org.apache.solr.client.solrj.impl.HttpClientUtil.configureClient(HttpClientUtil.java:115)
    at org.apache.solr.client.solrj.impl.HttpClientUtil.createClient(HttpClientUtil.java:105)
    at org.apache.solr.client.solrj.impl.HttpSolrServer.<init>(HttpSolrServer.java:155)
    at org.apache.solr.client.solrj.impl.HttpSolrServer.<init>(HttpSolrServer.java:128)
    at tan.indexSolr.<init>(indexSolr.java:195)
    at tan.indexSolr.main(indexSolr.java:51) 
```

这是我的代码

```
 public class indexSolr {
    private  Connection conn = null;
    private static HttpSolrServer  server;
      private Collection docs = new ArrayList();
      private int _totalSql = 0;
      private long _start = System.currentTimeMillis();

    public static void main(String[] args) throws SolrServerException, IOException, SQLException
    { String url = "http://localhost:8983/solr/db";

  indexSolr idxer = new indexSolr(url);

  idxer.doSqlDocuments();

  idxer.endIndexing();

    }

    private void doSqlDocuments() throws SQLException {

        try {
            Class.forName("org.postgresql.Driver");

            conn = DriverManager.getConnection(
                    "jdbc:postgresql://localhost:5432/biz_cat",
                    "postgres", "pos");
            java.sql.Statement st = null;
           st = conn.createStatement();
           ResultSet rs =   st.executeQuery("select * from pl_biz order by id DESC LIMIT 1");

          while (rs.next()) {

            SolrInputDocument doc = new SolrInputDocument();

            Integer  id = rs.getInt("id");
            String name = rs.getString("name");
            String midname = rs.getString("midname");
            String lastname = rs.getString("lastname");
            String frlsname = rs.getString("frlsname");
            String biz_subject = rs.getString("biz_subject");
            String company_type = rs.getString("company_type");
            String obshtina = rs.getString("obshtina");
            String main_office_town = rs.getString("main_office_town");
            String address = rs.getString("address");
            String role = rs.getString("role");
            String country = rs.getString("country");
            String nace_code = rs.getString("nace_code");
            String nace_text = rs.getString("nace_text");
            String zip_code = rs.getString("zip_code");
            String phone = rs.getString("phone");
            String fax = rs.getString("fax");
            String email = rs.getString("email");
            String web = rs.getString("web");
            String location = rs.getString("location");
            String geohash = rs.getString("geohash");
            Integer popularity = rs.getInt("popularity");

            doc.addField("id", id);
            doc.addField("name", name);
            doc.addField("midname", midname);
            doc.addField("lastname", lastname);
            doc.addField("frlsname", frlsname);
            doc.addField("biz_subject", biz_subject);
            doc.addField("company_type", company_type);
            doc.addField("obshtina", obshtina);
            doc.addField("main_office_town", main_office_town);
            doc.addField("address", address);
            doc.addField("role", role);
            doc.addField("country", country);
            doc.addField("nace_code", nace_code);
            doc.addField("nace_text", nace_text);
            doc.addField("zip_code", zip_code);
            doc.addField("phone", phone);
            doc.addField("fax", fax);
            doc.addField("email", email);
            doc.addField("web", web);
            doc.addField("location", location);
            doc.addField("geohash", geohash);
            doc.addField("popularity", popularity);

            docs.add(doc);
             ++_totalSql;

            if (docs.size() > 1) {
                 // Commit within 5 minutes.
                UpdateResponse resp = server.add(docs);
                System.out.println (resp);
              if (resp.getStatus() != 0) {
                log("Some horrible error has occurred, status is: " +
                      resp.getStatus());
              }
              docs.clear();
            }
          }
        }
        catch (Exception ex)
        {
          ex.printStackTrace();
        }
        finally {
          if (conn != null) {
            conn.close();
          }
        }

    }

     private void endIndexing() throws IOException, SolrServerException {
            if (docs.size() > 0) { // Are there any documents left over?
              server.add(docs, 300000); // Commit within 5 minutes
            }
            try 
            {
            server.commit(); 

            }
            catch (Exception ex)
            {

                ex.printStackTrace();
            }

            long endTime = System.currentTimeMillis();
            log("Total Time Taken: " + (endTime - _start) +
                 " milliseconds to index " + _totalSql +
                " SQL rows" );
          }

          private static void log(String msg) {
            System.out.println(msg);
          }

          private indexSolr(String url) throws IOException, SolrServerException {
              // Create a multi-threaded communications channel to the Solr server.
          try {    
            server = new HttpSolrServer(url);

            server.setSoTimeout(1000);  // socket read timeout
            server.setConnectionTimeout(1000);
            server.setMaxRetries(1); 

          }
               catch (Exception ex)
               {

                   ex.printStackTrace();

               }
          }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-04-04T20:45:57.290

> 此答案取自 @Pace 于 2013 年 4 月 20 日发表的评论
> 
> 我已将其标记为社区 wiki 帖子，正如[Question 所建议的那样，没有答案，但问题已在评论中解决](https://meta.stackoverflow.com/questions/251597/question-with-no-answers-but-issue-solved-in-the-comments)。

* * *

NoSuchFieldError 几乎总是由不兼容的版本引起的。

你有什么版本的 HttpClient？你在使用 Maven 吗？您是否可能有多个版本的 HttpClient？
检查这些事情，你应该找到你的答案。

# installation - 在组件标签上使用自动生成的 GUID 是否安全

> ID：16120473
> 
> 赞同：26
> 
> 时间：2013-04-20T12:39:38.940
> 
> 标签：installation, wix, windows-installer

我的场景是这样的：我希望安装程序**完全**删除旧版本（除应用程序在其生命周期内创建的文件之外的所有文件）并用新版本替换它。

在我的 Wix 脚本中，我将自动生成的 GUID（星号）用于产品 ID 和包 ID，而我将自己的 GUID 用于始终保持不变的 UpgradeCode。关于我的场景，我不确定是否可以安全地为组件标签使用自动生成的 GUID（星号）？

到目前为止，我使用的是 NSIS。我想尝试一下 Wix，但有点怀疑，因为论坛上的人说你需要大约 30 天来学习它，而一个人可以在 1-2 天内开始使用 NSIS。但是，对于典型用户需要的标准安装，我花了 2 天时间才获得使用 Wix 的非常好的安装程序包。如果你对 xml 有一点背景，你应该不用担心。感谢 Rob 和所有其他创建 Wix 的贡献者！

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-04-20T13:58:43.110

是的，自动引导`Component/@Guid`是安全的。它们非常特殊地完成，以确保 GUID 的生成方式在该组件的不同版本中是稳定的，这样 不会违反[组件规则。](http://robmensching.com/blog/posts/2003/10/18/component-rules-101)

此外，如果您不与其他产品共享组件**并且**您总是使用主要升级**并且**您提前安排主要升级，那么您根本不必担心组件 GUID，因为两个组件 GUID 定义永远不会启用同时机器。例如，`MajorUpgrade`元素的默认值正好为您提供：

```
<MajorUpgrade DowngradeErrorMessage='A newer version of [ProductName] is installed.' /> 
```

所以，答案是“是”。:)

# python - 使用 python/tkinter/sqlite 保存按钮

> ID：16120474
> 
> 赞同：1
> 
> 时间：2013-04-20T12:39:40.220
> 
> 标签：python, sqlite, tkinter

我有一个 tkinter 框架页面，其中包含用于输入客户详细信息的名称和地址的文本框。同一页面还有一个保存按钮，该按钮链接到另一种方法，该方法将文本框中的详细信息保存到 .sqlite 数据库。但是，当我单击按钮时，它显示“sqlite3.InterfaceError：错误绑定参数 1 - 可能不受支持的类型。” 一个不言自明的错误，但我不知道将输入更改为正确的。请，任何帮助将是惊人的，谢谢！

tk 帧间和页面布局 + 保存按钮的代码：

```
import tkinter as tk
import sqlite3

class Page(tk.Frame):
    def __init__(self, *args, **kwargs):
        tk.Frame.__init__(self, *args, **kwargs)
    def show(self):
        self.lift()

class Page1(Page):

    fName = ""
    sName = ""
    address1 = ""
    address2 = ""
    city = ""
    postCode = ""

    def __init__(self, *args, **kwargs):
        tk.Frame.__init__(self, *args, **kwargs)

        #Set up labels
        spaceLabel = tk.Label(self, text="")
        fNameLabel = tk.Label(self, text="First Name: ")
        sNameLabel = tk.Label(self, text="Last Name: ")
        address1Label = tk.Label(self, text="Address Line 1: ")
        cityLabel = tk.Label(self, text="City: ")
        postCodeLabel = tk.Label(self, text="Post Code: ")

        #Create string variables
        self.fName = tk.StringVar()
        self.sName = tk.StringVar()
        self.address1 = tk.StringVar()
        self.address2 = tk.StringVar()
        self.city = tk.StringVar()
        self.postCode = tk.StringVar()

        #Set up text entry boxes
        fNameBox = tk.Entry(self, textvariable = self.fName)
        sNameBox = tk.Entry(self, textvariable = self.sName)
        address1Box = tk.Entry(self, textvariable = self.address1)
        address2Box = tk.Entry(self, textvariable = self.address2)
        cityBox = tk.Entry(self, textvariable = self.city)
        postCodeBox = tk.Entry(self, textvariable = self.postCode)

        #Arrange Labels
        spaceLabel.grid(row=0, column=0)
        fNameLabel.grid(row=1, column=0, padx = 10, pady = 10)
        sNameLabel.grid(row=1, column=2, padx = 10, pady = 10)
        address1Label.grid(row=2, column=0, padx = 10, pady = 10)
        address2Label.grid(row=3, column=0, padx = 10, pady = 10)
        cityLabel.grid(row=4, column=0, padx = 10, pady = 10)
        postCodeLabel.grid(row=5, column=0, padx = 10, pady = 10)

        #Arrange text entry boxes
        fNameBox.grid(row=1, column=1, padx = 10, pady = 10)
        sNameBox.grid(row=1, column=3, padx = 10, pady = 10)
        address1Box.grid(row=2, column=1, padx = 10, pady = 10)
        address2Box.grid(row=3, column=1, padx = 10, pady = 10)
        cityBox.grid(row=4, column=1, padx = 10, pady = 10)
        postCodeBox.grid(row=5, column=1, padx = 10, pady = 10)

        #Save Details button
        saveCustomerDetails = tk.Button(self, text = "Save Details", command = self.SaveDetails)
        saveCustomerDetails.pack()
        saveCustomerDetails.grid(row=6,column=2,padx = 20, pady = 20)

    #When you click one save button, it should use this method to add the data
    # entry field text to the database.

    def SaveDetails(self):
         conn = sqlite3.connect('lanyard.db')
         c = conn.cursor()
         c.execute('PRAGMA foreign_keys = ON')
         conn.commit()

         customerData = [(None, self.fName, self.sName, self.address1, self.address2, self.city, self.postCode)]

         for element in customerData:
             c.execute("INSERT INTO Customers VALUES (?,?,?,?,?,?,?)", element)
         conn.commit()

         c.close()
         conn.close()

         fNameBox.delete(0, END)
         sNameBox.delete(0, END)
         address1Box.delete(0, END)
         address2Box.delete(0, END)
         cityBox.delete(0, END)
         postCodeBox.delete(0, END)

         print ("Saved") 
```

SQLite 数据库创建如下：

```
import sqlite3
conn = sqlite3.connect('lanyard.sqlite')
cursor = conn.cursor()

#Customers
cursor.execute('''DROP TABLE IF EXISTS Archive''')
cursor.execute('''CREATE TABLE IF NOT EXISTS Customers(
                Customer_Id INTEGER PRIMARY KEY,
                First_Name TEXT(20),
                Last_Name TEXT(20),
                Address_1 TEXT(20),
                Address_2 TEXT(20),
                City TEXT(20),
                Post_Code TEXT(20))''')

cursor.execute('''PRAGMA foreign_keys = ON''')

cursor.close()
conn.commit()
conn.close() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T14:29:11.867

sqlite 不知道是什么`StringVar`——你必须传递正常值。尝试像这样更改您的`customerData`列表：

```
customerData = [(None, self.fName.get(), self.sName.get(), 
                 self.address1.get(), self.address2.get(), 
                 self.city.get(), self.postCode.get())] 
```

# javascript - 为什么Javascript不检查所有复选框？

> ID：16120476
> 
> 赞同：-1
> 
> 时间：2013-04-20T12:39:44.970
> 
> 标签：javascript, jquery

我编写了一个脚本，当我单击第一个复选框时，它会检查所有复选框。当我在 HTML 中使用 onClick 事件时它工作得很好，但是当我试图不使用 onClick 事件时它不起作用。

这是HTML代码：

```
<table>

<tr>
    <td><input id="check-all" type="checkbox"/>
</tr>

<tr>
    <td><input id="check1"  type="checkbox" name="check"/>
</tr>

<tr>
    <td ><input id="check2"  type="checkbox" name="check"/>
</tr>

<tr>
    <td><input id="check3"  type="checkbox" name="check"/>
</tr> 
```

这是我要运行的 Javascript 代码，但不起作用。

```
var checkbox = document.getElementById("check-all");

checkbox.onclick = function () {
  checkboxes = document.getElementsByName('check');
  for(var i=0, n=checkboxes.length;i<n;i++) {
    checkboxes[i].checked = source.checked;
  }
} 
```

我刚开始使用 Javascript，我可能做错了什么。请指出。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T12:43:10.127

我认为你有一个未定义的变量：

```
var checkbox = document.getElementById("check-all");

checkbox.onclick = function () {
  checkboxes = document.getElementsByName('check');
  for(var i=0, n=checkboxes.length;i<n;i++) {
    checkboxes[i].checked = this.checked;
  }
} 
```

您需要用一个值替换未在任何地方定义的“源”，以获取“检查全部”的检查值，例如这个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T12:45:02.673

您的 source.checked 无效且使用错误

```
this.checked 
```

代替

```
source.checked 
```

# java - Java 扫描仪良好实践

> ID：16120480
> 
> 赞同：1
> 
> 时间：2013-04-20T12:39:55.567
> 
> 标签：java, exception, try-catch, java.util.scanner

我正在从文件中读取数据，并且我想使用 try/catch 块来处理异常。我写了我的代码。但是，eclipse 只声明了我的扫描仪对象就给了我一个错误，我不得不将它初始化为 null。下面我写了我的代码的两个版本。哪个被认为是更好的做法？此外，使用 try/catch 块是否比仅在构造函数/函数头的末尾抛出异常更好？

代码版本#1：

```
java.util.Scanner in = null;

try {
    in = new java.util.Scanner (f);
    /* use scanner */
} catch (FileNotFoundException e) {
    System.err.println("File was not found. Make sure the file exist.");
    System.err.println("Message: " + e.getMessage());
} catch (IOException e) {
    System.err.println("File could not be opened.");
    System.err.println("Message: " + e.getMessage());
} finally {
    in.close();
} 
```

代码版本#2：

```
try {
    java.util.Scanner in = new java.util.Scanner (f);
    /* use scanner */
    in.close();
} catch (FileNotFoundException e) {
    System.err.println("File was not found. Make sure the file exist.");
    System.err.println("Message: " + e.getMessage());
} catch (IOException e) {
    System.err.println("File could not be opened.");
    System.err.println("Message: " + e.getMessage());
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-20T12:45:43.347

没有一个片段是正确的。如果 Scanner 构造函数抛出异常，第一个将导致 NullPointerException，因为它在调用 close() 之前不检查 null。

如果 try 块中出现任何异常，第二个将无法关闭扫描仪。

显然，第一个比第二个更接近正确的代码。

关于异常的最佳选择，这是正确性的问题。如果该方法可以正确处理异常（这意味着在处理异常后程序将继续按预期工作），它应该捕获它。如果它不能，它应该将它传播给调用者并让它处理它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-20T12:54:52.210

Java 7 引入了“Try with Resources”，以帮助防止由于在代码版本 #2 等实例中保持打开的资源而导致的内存泄漏，奖励：它易于使用。

```
 try( Scanner in = new Scanner( System.in ) ) {

    } 
```

并做了。以上将在大括号之后自动关闭扫描器，无论大括号内部发生什么。

像往常一样，Catch 和 finally 块可能与 Try with Resources 一起出现，但并非必须如此。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-20T12:44:53.987

`in.close();`在代码版本 #2 中，如果在文件不会关闭之前抛出异常。版本 #1 没有这个问题。

您可以使用 try with resource 组合这两个版本

```
try (java.util.Scanner in = new java.util.Scanner (new File("your file"))){
    /* use scanner */
} catch (FileNotFoundException e) {
    System.err.println("File was not found. Make sure the file exist.");
    System.err.println("Message: " + e.getMessage());
} catch (IOException e) {
    System.err.println("File could not be opened.");
    System.err.println("Message: " + e.getMessage());
}
//"in" will be closed automatically 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-20T12:49:56.397

好吧，我认为第二个版本似乎很无奈。如果它确实在 try 块中引发了一些异常，则此代码将不会运行。

```
in.close(); 
```

为什么不把它放在 finally 块中？

# python - Matplotlib 灰度热图，具有视觉上不同的“NA”方块字段

> ID：16120481
> 
> 赞同：6
> 
> 时间：2013-04-20T12:39:58.490
> 
> 标签：python, matplotlib, heatmap

我正在创建要在出版物中使用的热图。该出版物仅限于黑白打印，因此我正在创建灰度热图。我遇到的问题是热图中有一些“不适用”的方块，我想在视觉上与其他单元格区分开来。我的理解是，如果热图在刻度的两端都有颜色，那么这可能（？）可以使用 numpy 的掩码数组，并且掩码字段可能只是显示为白色。问题是，我想使用从白色到黑色的全光谱来说明非 NA 数据的范围。有没有办法用其他一些视觉机制来区分 NA 细胞，比如删除线？

下面是带有掩码数组的灰度的最小示例（改编自[此处](https://stackoverflow.com/a/10757751/129475)）。NA 值可能在这里被掩盖了，您只是无法分辨，因为它使用的白色已经被用作有效光谱高端的颜色。

```
import numpy as np
from pylab import *

z = rand(10, 25)
z = np.ma.masked_array(z,mask=z>0.8)

c = pcolor(z)
set_cmap('gray')
colorbar()
c = pcolor(z, edgecolors='w', linewidths=1)
axis([0,25,0,10])
savefig('plt.png')
show() 
```

![在此处输入图像描述](https://i.stack.imgur.com/DBmLF.png)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-20T21:34:38.097

一个简单的解决方案是只孵化背景轴补丁。例如：

```
import numpy as np
import matplotlib.pyplot as plt
import matplotlib.cm as cm
np.random.seed(1977)

data = np.random.random((10,25))
data = np.ma.masked_greater(data, 0.8)

fig, ax = plt.subplots()
im = ax.pcolormesh(data, cmap=cm.gray, edgecolors='white', linewidths=1,
                   antialiased=True)
fig.colorbar(im)

ax.patch.set(hatch='xx', edgecolor='black')

plt.show() 
```

[![在此处输入图像描述](https://i.stack.imgur.com/TLyya.png)](https://i.stack.imgur.com/TLyya.png)

请注意，如果您不想在空单元格之间绘制边框，您可以`pcolor`使用`pcolormesh`. 例如，如果我们改变这一行：

```
im = ax.pcolormesh(data, cmap=cm.gray, edgecolors='white', linewidths=1,
                   antialiased=True) 
```

至：

```
im = ax.pcolor(data, cmap=cm.gray, edgecolors='white', linewidths=1) 
```

我们会得到：

[![在此处输入图像描述](https://i.stack.imgur.com/yDpmm.png)](https://i.stack.imgur.com/yDpmm.png)

区别是微妙的 - 相邻的空单元格之间不会用`pcolor`. `pcolor`您更喜欢哪种美学纯粹是个人的，但它突出了和之间的关键区别`pcolormesh`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-10-28T16:53:06.133

我无法通过添加补丁来重现乔的答案`ax.patch.set_hatch('x')`。相反，我必须根据这个[问题](https://stackoverflow.com/a/18403408/2573523)将补丁创建为矩形

```
import numpy as np
import matplotlib.pyplot as plt

import matplotlib.cm as cm
import matplotlib.patches as patches

data = np.random.random((10,25))
data = np.ma.masked_greater(data, 0.8)

fig, ax = plt.subplots()
im = ax.pcolormesh(data, cmap=cm.gray, edgecolors='white', linewidths=0)
fig.colorbar(im)

# ax.patch.set_hatch('x')  replaced by:
p = patches.Rectangle((0,0), 25, 10, hatch='xx', fill=None,zorder=-10)
ax.add_patch(p)

plt.show() 
```

而且，`pcolormesh`现在好像整理好了，可以在这里使用。

# wordpress - WordPress：发送页面后运行操作

> ID：16120482
> 
> 赞同：2
> 
> 时间：2013-04-20T12:40:11.450
> 
> 标签：wordpress, plugins, hook

我想在 Wordpress 博客中注册对某个帖子的所有访问。收集的数据被发送到外部服务器，我在其中收集此博客和其他来源的信息。

到目前为止，我解决这个问题的方法是使用 hook `wp_footer`，向远程服务器添加异步 JSONP 调用。但是这种方式给生成的 HTML 增加了一点开销，并且取决于用户是否启用了 javascript。

现在，我正在尝试做同样的事情，但通过 php 代码、使用 curl 或任何类似的库进行外部调用。这里的问题是增加了页面生成时间的延迟，这可能会影响用户体验。发送内容并关闭 HTTP 连接后有什么好的方法吗？Wordpress 挂钩`shutdown`是否有效？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-11-06T13:52:40.873

这对我有用。请注意，如果您不想依赖 WordPress 配置，PHP 具有本机关闭功能。从 send-server.com 你可以做这样的事情：

```
function do_php_shutdown_function(){
    //do your request here
    $param1 = urlencode($param1);
    $param2 = urlencode($param2);
    $request = "http://external-server.com/script.php?param1={$param1}&param2={$param2}";
    get_headers($request);
}
register_shutdown_function( 'do_php_shutdown_function'); 
```

在 external-server.com 上的 script.php 中，您将拥有如下内容：

```
header("Access-Control-Allow-Origin: http://sending-server.com");
header("HTTP/1.0 204 No Content");
$param1 = urldecode($_GET['param1']);
$param2 = urldecode($_GET['param2']);
//do stuff 
```

header("HTTP/1.0 204 无内容"); 应该立即关闭连接，但脚本将继续执行。有关更多信息，请参阅：[从 PHP 发送 HTTP 请求而不等待响应？](https://stackoverflow.com/questions/14359926/send-http-request-from-php-without-waiting-for-response)

# sql - SQL WHERE xx IN ('qq', 'ww'...) 性能 - 更多价值，更少时间？

> ID：16120485
> 
> 赞同：6
> 
> 时间：2013-04-20T12:40:30.483
> 
> 标签：sql, oracle

我终于问了我的第一个问题（尽管我是一个长期的跟踪者）。

前几天在工作中，一个 SQL 查询引起了我的注意。问题是`WHERE`子句中的性能，当使用`IN`运算符将​​索引与可能的值进行比较时。

```
SELECT   SUM (parts.quantity) AS quantity,
       concessions.concessionCode,
       concessions.description AS concessionDesc,
       parts.type,
       activities.activityCode,
       REPLACE (activities.activityCode, activities.lvl2 || '-', '') AS activityCodeDisplay,
       strings.activityDesc,
       strings.activityDesc2,
       strings.activityDesc3
FROM   tb_parts parts,
       tb_activities activities,
       tb_strings strings,
       tb_concessions concessions
WHERE       parts.activityCode = activities.activityCode
       AND parts.concessionCode = activities.concessionCode
       AND activities.concessionCode = concesions.concessionCode
       AND activities.concessionCode = strings.concessionCode
       AND activities.activityCode = strings.activityCode
       AND strings.language = 'ENG'
       --AND parts.concesionCode IN ('ZD', 'G9', 'TR', 'JS0')
       AND parts.concesionCode IN ('ZD', 'G9')
       AND parts.date >= TO_DATE ('01/01/2013 00:00:00', 'DD/MM/YYYY HH24:MI:SS')
       AND parts.date <= TO_DATE ('30/04/2013 23:59:59', 'DD/MM/YYYY HH24:MI:SS')
       AND parts.type IN ('U', 'M')
       AND parts.value = 'E'
GROUP BY   concesions.concessionCode,
       concesions.description,
       parts.type,
       activities.activityCode,
       REPLACE (activities.activityCode, activities.lvl2|| '-', ''),
       strings.activityDesc,
       strings.activityDesc2,
       strings.activityDesc3
ORDER BY   concesions.concessionCode; 
```

我遇到的问题是这样的 - 如果查询按原样运行（有两个值`IN`），则需要 30 秒。如果它使用四个值运行（就像在注释行中一样），则查询需要 5 秒。我希望将索引与多个值进行比较需要更多时间，但似乎并非如此。我在白天重复了几次“测试”，它们总是或多或少相同（30 +-1s，5 +-1s）。

任何关于为什么会以这种方式表现的见解都将不胜感激！

PS 我已经翻译了表格/列的名称，如果有任何差异，我很抱歉。

PPS我已经用joins重写了这段代码，它更快，但是这个异常背后的原因仍然困扰着我:)

**编辑**：终于上班了！经过一番修改，我已经能够为这两个版本创建执行计划，甚至为第三个版本的查询（**在**4 和 2 中都有值`where`，时间约为 600 毫秒）。另外，关于表格中的数据有几个问题，所以这里有一些信息：

```
All the stats are analyzed the day that queries were executed

Table parts 
           total rows           - 3.2  M 
           matches for 2 values - 1.08 M (~34%)
           matches for 4 values - 1.30 M (~41%)
Table activities
           total rows           - 3866 
           matches for 2 values - 321    (~ 8%)
           matches for 4 values - 644    (~16%)
Table strings 
           total rows           - 7436
           matches for 2 values - 642    (~ 8%)
           matches for 4 values - 1288   (~17%)

Index in_parts
           codConcession
           username
           date 
```

正因为如此，我认为在使用动态采样时（除了 +2/3s 之外）没有大的区别（如果我做得正确，也就是`/*+ dynamic_sampling(tb_parts 10) */`在`SELECT`关键字之后）

对于**两个值**：

```
----------------------------------------------------------------------------------------------------- 
| Id  | Operation                          | Name           | Rows  | Bytes | Cost (%CPU)| Time     | 
----------------------------------------------------------------------------------------------------- 
|   0 | SELECT STATEMENT                   |                |     1 |   186 |   864   (1)| 00:00:11 | 
|   1 |  SORT ORDER BY                     |                |     1 |   186 |   864   (1)| 00:00:11 | 
|   2 |   HASH GROUP BY                    |                |     1 |   186 |   864   (1)| 00:00:11 | 
|*  3 |    TABLE ACCESS BY INDEX ROWID     | tb_parts       |     1 |    37 |   818   (1)| 00:00:10 | 
|   4 |     NESTED LOOPS                   |                |     1 |   186 |   862   (1)| 00:00:11 | 
|   5 |      NESTED LOOPS                  |                |     1 |   149 |    44   (0)| 00:00:01 | 
|   6 |       NESTED LOOPS                 |                |    34 |  2108 |    10   (0)| 00:00:01 | 
|   7 |        INLIST ITERATOR             |                |       |       |            |          | 
|   8 |         TABLE ACCESS BY INDEX ROWID| tb_concesions  |     2 |    54 |     2   (0)| 00:00:01 | 
|*  9 |          INDEX UNIQUE SCAN         | pk_concession  |     2 |       |     1   (0)| 00:00:01 | 
|  10 |        TABLE ACCESS BY INDEX ROWID | tb_activities  |    17 |   595 |     4   (0)| 00:00:01 | 
|* 11 |         INDEX RANGE SCAN           | pk_activity    |    17 |       |     2   (0)| 00:00:01 | 
|  12 |       TABLE ACCESS BY INDEX ROWID  | tb_strings     |     1 |    87 |     1   (0)| 00:00:01 | 
|* 13 |        INDEX UNIQUE SCAN           | pk_string      |     1 |       |     0   (0)| 00:00:01 | 
|* 14 |      INDEX RANGE SCAN              | in_parts       |   454 |       |   648   (1)| 00:00:08 | 
----------------------------------------------------------------------------------------------------- 

PLAN_TABLE_OUTPUT                                                                                     
------------------------------------------------------------------------------------------------------

Predicate Information (identified by operation id):                                                   
---------------------------------------------------                                                   
   3 - filter("parts"."value"='E' 
              AND ("parts"."type"='M' OR "parts"."type"='U') 
              AND "parts"."activityCode"="activities"."activityCode")   

   9 - access("concessions"."concessionCode"='G9' 
              OR "concessions"."concessionCode"='ZD')  

  11 - access("activities"."concessionCode"="concessions"."concessionCode")                           
       filter("activities"."concessionCode"='G9' 
              OR "activities"."concessionCode"='ZD')               

  13 - access("activities"."concessionCode"="strings"."concessionCode" 
              AND "activities"."activityCode"="strings"."activityCode" 
              AND "strings"."language"='ENG')    
       filter("strings"."concessionCode"='G9' 
              OR "strings"."concessionCode"='ZD')                     

  14 - access("parts"."concessionCode"="activities"."concessionCode" 
              AND "parts"."date">=TO_DATE('2013-01-01 00:00:00', 
                                          'syyyy-mm-dd hh24:mi:ss') 
              AND "parts"."date"<=TO_DATE(' 2013-04-30 23:59:59', 
                                          'syyyy-mm-dd hh24:mi:ss'))                                                   
       filter("parts"."date">=TO_DATE('2013-01-01 00:00:00', 
                                      'syyyy-mm-dd hh24:mi:ss')               
              AND ("parts"."concessionCode"='G9' 
                   OR "parts"."concessionCode"='ZD') 
              AND "parts"."date"<=TO_DATE(' 2013-04-30 23:59:59', 
                                          'syyyy-mm-dd hh24:mi:ss')) 
```

对于**四个值**：

```
----------------------------------------------------------------------------------------------------
| Id  | Operation                         | Name           | Rows  | Bytes | Cost (%CPU)| Time     |
----------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT                  |                |     1 |   186 |  7412   (2)| 00:01:29 |
|   1 |  SORT ORDER BY                    |                |     1 |   186 |  7412   (2)| 00:01:29 |
|   2 |   HASH GROUP BY                   |                |     1 |   186 |  7412   (2)| 00:01:29 |
|   3 |    NESTED LOOPS                   |                |     1 |   186 |  7410   (2)| 00:01:29 |
|*  4 |     HASH JOIN                     |                |    17 |  1683 |  7393   (2)| 00:01:29 |
|*  5 |      HASH JOIN                    |                |   136 |  8432 |    21   (5)| 00:00:01 |
|   7 |        TABLE ACCESS BY INDEX ROWID| tb_concesions  |     4 |   108 |     2   (0)| 00:00:01 |
|*  8 |         INDEX UNIQUE SCAN         | pk_concession  |     4 |       |     1   (0)| 00:00:01 |
|*  9 |       TABLE ACCESS FULL           | tb_activities  |   644 | 22540 |    18   (0)| 00:00:01 |
|* 10 |      TABLE ACCESS FULL            | tb_parts       |  4310 |   155K|  7372   (2)| 00:01:29 |
|  11 |     TABLE ACCESS BY INDEX ROWID   | tb_strings     |     1 |    87 |     1   (0)| 00:00:01 |
|* 12 |      INDEX UNIQUE SCAN            | pk_string      |     1 |       |     0   (0)| 00:00:01 |
----------------------------------------------------------------------------------------------------

Predicate Information (identified by operation id):                                                 

PLAN_TABLE_OUTPUT                                                                                   
----------------------------------------------------------------------------------------------------
---------------------------------------------------                                                 

   4 - access("parts"."activityCode"="activities"."activityCode" 
              AND "parts"."concessionCode"="activities"."concessionCode")                              

   5 - access("activities"."concessionCode"="concessions"."concessionCode")                         

   8 - access("concessions"."concessionCode"='G9' 
              OR "concessions"."concessionCode"='JS0' 
              OR "concessions"."concessionCode"='TR' 
              OR "concessions"."concessionCode"='ZD')           

   9 - filter("activities"."concessionCode"='G9' 
              OR "activities"."concessionCode"='JS0' 
              OR "activities"."concessionCode"='TR' 
              OR "activities"."concessionCode"='ZD')             
  10 - filter("parts"."date">=TO_DATE(' 2013-01-01 00:00:00', 
                                      'syyyy-mm-dd hh24:mi:ss')             
              AND "parts"."value"='E' 
              AND ("parts"."type"='M' OR "parts"."type"='U') 
              AND ("parts"."concessionCode"='G9' 
                   OR "parts"."concessionCode"='JS0'
                   OR "parts"."concessionCode"='TR' 
                   OR "parts"."concessionCode"='ZD') 
              AND "parts"."date"<=TO_DATE(' 2013-04-30 23:59:59',    
                                          'syyyy-mm-dd hh24:mi:ss'))                                                            

  12 - access("activities"."concessionCode"="strings"."concessionCode" 
              AND "activities"."activityCode"="strings"."activityCode" 
              AND "strings"."language"='ENG')  
       filter("strings"."concessionCode"='G9' 
              OR "strings"."concessionCode"='JS0' 
              OR "strings"."concessionCode"='TR' 
              OR "strings"."concessionCode"='ZD') 
```

最后是**六个值**：

```
----------------------------------------------------------------------------------------------------
| Id  | Operation                         | Name           | Rows  | Bytes | Cost (%CPU)| Time     |
----------------------------------------------------------------------------------------------------
|   0 | SELECT STATEMENT                  |                |     1 |   186 |  4525   (1)| 00:00:55 |
|   1 |  SORT ORDER BY                    |                |     1 |   186 |  4525   (1)| 00:00:55 |
|   2 |   HASH GROUP BY                   |                |     1 |   186 |  4525   (1)| 00:00:55 |
|   3 |    NESTED LOOPS                   |                |     1 |   186 |  4523   (1)| 00:00:55 |
|*  4 |     HASH JOIN                     |                |     9 |   891 |  4514   (1)| 00:00:55 |
|*  5 |      HASH JOIN                    |                |   136 |  8432 |    21   (5)| 00:00:01 |
|   6 |       INLIST ITERATOR             |                |       |       |            |          |
|   7 |        TABLE ACCESS BY INDEX ROWID| tb_concesions  |     4 |   108 |     2   (0)| 00:00:01 |
|*  8 |         INDEX UNIQUE SCAN         | pk_concession  |     4 |       |     1   (0)| 00:00:01 |
|*  9 |       TABLE ACCESS FULL           | tb_activities  |   644 | 22540 |    18   (0)| 00:00:01 |
|  10 |      INLIST ITERATOR              |                |       |       |            |          |
|* 11 |       TABLE ACCESS BY INDEX ROWID | tb_parts       |  2155 | 79735 |  4493   (1)| 00:00:54 |
|* 12 |        INDEX RANGE SCAN           | in_parts       |  8620 |       |  1277   (1)| 00:00:16 |
|  13 |     TABLE ACCESS BY INDEX ROWID   | tb_strings     |     1 |    87 |     1   (0)| 00:00:01 |
|* 14 |      INDEX UNIQUE SCAN            | pk_string      |     1 |       |     0   (0)| 00:00:01 |
----------------------------------------------------------------------------------------------------

PLAN_TABLE_OUTPUT                                                                                   
----------------------------------------------------------------------------------------------------

Predicate Information (identified by operation id):                                                 
---------------------------------------------------                                                 

   4 - access("parts"."activityCode"="activities"."activityCode" 
   AND "parts"."concessionCode"="activities"."concessionCode")   

   5 - access("activities"."concessionCode"="concessions"."concessionCode")                         

   8 - access("concessions"."concessionCode"='G9' 
              OR "concessions"."concessionCode"='JS0' 
              OR "concessions"."concessionCode"='TR' 
              OR "concessions"."concessionCode"='ZD')           

   9 - filter("activities"."concessionCode"='G9' 
              OR "activities"."concessionCode"='JS0' 
              OR "activities"."concessionCode"='TR' 
              OR "activities"."concessionCode"='ZD')             

  11 - filter("parts"."value"='E' 
              AND ("parts"."type"='M' OR "parts"."type"='U'))                   

  12 - access(("parts"."concessionCode"='G9' 
                 OR "parts"."concessionCode"='ZD') 
              AND "parts"."date">=TO_DATE(' 2013-01-01 00:00:00', 
                                          'syyyy-mm-dd hh24:mi:ss') 
              AND "parts"."date"<=TO_DATE(' 2013-04-30 23:59:59', 
                                          'syyyy-mm-dd hh24:mi:ss'))            
       filter("parts"."date">=TO_DATE(' 2013-01-01 00:00:00', 
                                      'syyyy-mm-dd hh24:mi:ss')             
              AND "parts"."date"<=TO_DATE(' 2013-04-30 23:59:59', 
                                          'syyyy-mm-dd hh24:mi:ss'))        

  14 - access("activities"."concessionCode"="strings"."concessionCode" 
              AND "activities"."activityCode"="strings"."activityCode" 
              AND "strings"."language"='ENG')  
       filter("strings"."concessionCode"='G9'  
              OR "strings"."concessionCode"='JS0' 
              OR "strings"."concessionCode"='TR' 
              OR "strings"."concessionCode"='ZD') 
```

由于这是我第一次与执行计划会面，我只能猜测延迟的原因是什么。在 4 到 6 个值之间，我猜这是从 FULL ACCESS 到 ACCESS BY INDEX 的变化。此外，当访问表格时，四个值的过滤器（id 10）包含所有四个让步值；而对于六个值，两个让步值在访问部分，过滤器只包含日期、类型和值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-26T05:52:54.127

一般来说，出现这种异常的原因是查询优化器无法准确预测成本。准确了解成本的唯一方法是使用不同的执行计划多次实际运行该语句。相反，它使用统计数据来*估计*成本，有时估计是错误的。

当您比较“有两个值”和“有四个值”的执行计划时，您会发现后者的成本更高，并且计划完全不同。优化器可以在这两个执行计划之间进行选择，并且一定认为第一个具有两个值更好，而第二个具有四个值更好。然而，实际上，在这两种情况下，第二个都更好。

如果您仔细分析此类异常情况，您通常会得到一些见解，例如某些值组合在您的数据中被高估或低估。在统计数据中使用直方图可以为优化器提供更多线索，并且可以更好地处理“倾斜数据”，但其预测能力仍然有限。

实际上，解决方案就是您所做的：重写 SQL 直到获得可接受的性能。通常“提示”（在 Oracle 中）也可以为优化器提供更多线索。

# cordova - phonegap window.requestFileSystem 参数

> ID：16120489
> 
> 赞同：3
> 
> 时间：2013-04-20T12:40:56.847
> 
> 标签：cordova, filesystems

这个函数的第二个参数的目的是什么？它总是设置为零，但我从来没有发现它的用途。

window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, 成功, 失败);

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-30T08:37:25.770

此文本来自cordova.js：
@param size 表示应用程序预计需要多少存储空间（以字节为单位）

如果磁盘的可用性小于 size 参数，requestFileSystem 似乎会失败。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-06-03T11:41:20.957

语法：window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, onSuccess, onError);

描述 ：

这里第一个参数可以是LocalFileSystem.PERSISTENT/LocalFileSystem.TEMPORARY，第二个参数确定存储空间，第三个参数确定文件访问是否成功，第四个参数确定文件处理时出错。

# java - CardLayout 没有显示 JPanel

> ID：16120490
> 
> 赞同：0
> 
> 时间：2013-04-20T12:41:07.860
> 
> 标签：java, swing, awt, layout-manager, cardlayout

我正在为数据库做一个表格，我想使用 CardLayout。我解释一下情况：用户有两个选择：要么连接到他的帐户，要么他是新用户，他需要创建一个帐户。我有一个带有表单的第一个面板和另一个用于测试的面板（在该面板中，我将背景设置为黑色，以便在用户单击“新建”按钮时查看更改）。当我启动主程序时，我只有带有标题的窗口，没有别的。或者这不是我想要的，我的应用程序的第一步是显示表单。所以，如果有人能解释我的错误在哪里，我接受它:)

```
public class Accueil extends JFrame implements ActionListener {

    private CardLayout l = new CardLayout();
    private JPanel main = new JPanel(l);
    private JPanel change = new JPanel();
    private JPanel home = new JPanel(new BorderLayout());
    private JPanel title = new JPanel();
    private JPanel login = new JPanel(new BorderLayout());
    private JPanel login_title = new JPanel();
    private JPanel login_info = new JPanel();
    private JPanel copyright = new JPanel();
    private JLabel welcome = new JLabel("TEST");
    private JLabel connexion = new JLabel("Connexion");
    private JLabel mail = new JLabel("Mail : "); 
    private JTextField input_mail = new JTextField();
    private JLabel mdp = new JLabel("Password : ");
    private JTextField input_mdp = new JTextField();
    private JLabel who = new JLabel ("Are you a  : ");
    private JRadioButton client = new JRadioButton("Client", true);
    private JRadioButton developpeur = new JRadioButton("Developer", false);
    private ButtonGroup bg = new ButtonGroup();
    private JButton ok = new JButton("Login");
    private JButton annule = new JButton("Cancel");
    private JButton inscription = new JButton("New ?");
    private JLabel align = new JLabel("");

    public Accueil() {

        init_title();
        init_login();
        add_button();
        organize_frame();
        inscription.addActionListener(this);
        main.add(home, "Home");
        main.add(change, "Change");
        l.show(main, "Home");
        change.setBackground(Color.black);
        this.setTitle("test");
        this.setSize(600,600);
        this.setLocationRelativeTo(null);
        this.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        this.setVisible(true);
    }

    public void actionPerformed(ActionEvent arg0) {
        l.show(main, "Change");
    }

    private void organize_frame() { 
        home.add(title, BorderLayout.NORTH);
        home.add(login, BorderLayout.CENTER);
        home.add(copyright, BorderLayout.SOUTH);
    }

    private void init_title() { 
        welcome.setFont(build_font(35));
        welcome.setBorder(new EmptyBorder(20,0,0,0));
        title.setPreferredSize(new Dimension(600,80));
        title.add(welcome);
    }

    private void init_login() {
        setConnexion();
        user_input();
        align.setPreferredSize(new Dimension(215,50));
        organize_button();
        login.add(login_title, BorderLayout.NORTH);
        login.add(login_info, BorderLayout.CENTER);
    }

    private void setConnexion() {
        connexion.setFont(build_font(30));
        connexion.setBorder(new EmptyBorder(20,0,0,0));
        login_title.add(connexion);
        login_title.setPreferredSize(new Dimension(600,100));
    }

    private void user_input() {
        who.setFont(build_font(25));
        mail.setFont(build_font(25));
        mail.setBorder(new EmptyBorder(0,120,0,0));
        mdp.setFont(build_font(25));
        input_mdp.setFont(build_font(25));
        input_mail.setFont(build_font(25));
        input_mail.setPreferredSize(new Dimension(300,40));
        input_mdp.setPreferredSize(new Dimension(300,40));
        who.setFont(build_font(20));
        client.setFont(build_font(20));
        developpeur.setFont(build_font(21));
        login_info.add(who);
        login_info.add(client);
        login_info.add(developpeur);
        login_info.add(mail);
        login_info.add(input_mail);
        login_info.add(mdp);
        login_info.add(input_mdp);
        login_info.add(align);
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T12:43:06.650

您在哪里将使用 CardLayout 的 JPanel、main 添加到任何内容中？

答：你没有。要让它工作，必须将它添加到最终通向顶层窗口的组件中。必须显示它才能显示其“卡片”。

# java - Java - LWJGL 加载纹理，只有我加载的最新纹理有效

> ID：16120492
> 
> 赞同：0
> 
> 时间：2013-04-20T12:41:19.520
> 
> 标签：java, 3d, textures, lwjgl

我正在用 LWJGL 创建一个游戏，我目前正在实现纹理。（3D）当我使用我的方法只加载一个纹理时，它工作正常，但如果我加载 2 个或更多纹理，只有我加载的最新纹理是活动的，我只能使用那个......

看代码你就明白了：

我加载纹理的方法：

```
private int[] loadRTexture(String filename) {
    int[] twh = new int[3];
    ByteBuffer buf = null;
    int tWidth = 0;
    int tHeight = 0;

    try {
        // Open the PNG file as an InputStream
        InputStream in = new FileInputStream(filename);
        // Link the PNG decoder to this stream
        PNGDecoder decoder = new PNGDecoder(in);

        // Get the width and height of the texture
        tWidth = decoder.getWidth();
        tHeight = decoder.getHeight();
        twh[1] = tWidth;
        twh[2] = tHeight;   

        // Decode the PNG file in a ByteBuffer
        buf = ByteBuffer.allocateDirect(
                4 * decoder.getWidth() * decoder.getHeight());
        decoder.decode(buf, decoder.getWidth() * 4, Format.RGBA);
        buf.flip();

        in.close();
    } catch (IOException e) {
        e.printStackTrace();
        System.exit(-1);
    }

    // Create a new texture object in memory and bind it
    int texId = GL11.glGenTextures();
    GL13.glActiveTexture(GL13.GL_TEXTURE0);
    GL11.glBindTexture(GL11.GL_TEXTURE_2D, texId);

    // All RGB bytes are aligned to each other and each component is 1 byte
    GL11.glPixelStorei(GL11.GL_UNPACK_ALIGNMENT, 1);

    // Create a new texture object in memory and bind it    
    // Upload the texture data and generate mip maps (for scaling)
    GL11.glTexImage2D(GL11.GL_TEXTURE_2D, 0, GL11.GL_RGB, tWidth, tHeight, 0, 
            GL11.GL_RGBA, GL11.GL_UNSIGNED_BYTE, buf);
    GL30.glGenerateMipmap(GL11.GL_TEXTURE_2D);

    // Setup the ST coordinate system
    GL11.glTexParameteri(GL11.GL_TEXTURE_2D, GL11.GL_TEXTURE_WRAP_S, GL11.GL_REPEAT);
    GL11.glTexParameteri(GL11.GL_TEXTURE_2D, GL11.GL_TEXTURE_WRAP_T, GL11.GL_REPEAT);

    // Setup what to do when the texture has to be scaled
    GL11.glTexParameteri(GL11.GL_TEXTURE_2D, GL11.GL_TEXTURE_MAG_FILTER, 
            GL11.GL_NEAREST);
    GL11.glTexParameteri(GL11.GL_TEXTURE_2D, GL11.GL_TEXTURE_MIN_FILTER, 
            GL11.GL_LINEAR_MIPMAP_LINEAR);
    twh[0] = texId;
    return twh;
} 
```

我存储生成的 int texId = GL11.glGenTextures(); 在此方法之后的数组列表中。

然后当我想渲染这就是我绑定纹理的方式：

```
GL11.glBegin(GL11.GL_QUADS); // Start Drawing The Cube
    GL11.glBindTexture(GL11.GL_TEXTURE_2D, game.getResourceManager().getTextures().get(game.getResourceManager().getSpriteSheets().get(0).getTextureID()));
    GL11.glTexCoord2f(x, y);
    GL11.glVertex3f(1.0f, 1.0f, -1.0f); // Top Right Of The Quad (Top)
    GL11.glTexCoord2f(x, y+celly);
    GL11.glVertex3f(-1.0f, 1.0f, -1.0f); // Top Left Of The Quad (Top)
    GL11.glTexCoord2f(x+cellx, y+celly);
    GL11.glVertex3f(-1.0f, 1.0f, 1.0f); // Bottom Left Of The Quad (Top)
    GL11.glTexCoord2f(x+cellx, y);
    GL11.glVertex3f(1.0f, 1.0f, 1.0f); // Bottom Right Of The Quad (Top) 
```

这一行：

```
game.getResourceManager().getTextures().get(game.getResourceManager().getSpriteSheets().get(0).getTextureID()) 
```

获取生成的所需纹理int..（它得到正确的，我已经检查过。）

那么为什么会这样呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T00:25:45.893

如果您的纹理加载器有问题，请在此处试用我的： [LWJGL 纹理和字符串](https://stackoverflow.com/questions/10801016/lwjgl-textures-and-strings/10872080#10872080)

如果您真的不想这样做，请将您的代码与我的代码进行比较，看看是否有任何问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-12T07:35:06.340

调用 glBegin 后不能绑定纹理。这会搞砸一切，

# asp.net - 在 google plus 中共享具有来自数据库的动态内容的 aspx 页面

> ID：16120496
> 
> 赞同：0
> 
> 时间：2013-04-20T12:41:34.867
> 
> 标签：asp.net, share, meta-tags

我想通过我的 asp.net 网站在 google plus 中分享内容。我有一页名为 GooglePlusShare.aspx。Google Plus 采用它在 og:image 和 og:description 元标记中找到的任何内容。我想根据在查询字符串中传递的用户 ID 动态共享内容。og:image 和 og:description 元标记内容正在页面中完美设置，但 google plus 没有呈现它。

下面我在该页面上指定了元标记，它们是在页面加载时动态设置的。

```
<meta id="metaDescription" content="I just entered to win a KitchenAid Kitchen Suite From h.h.gregg - enter now at hhgregg.com/kitchenaid and watch to get a great recipe idea!" property="og:description" name="description">
<meta id="ogImg" content="http://img.youtube.com/vi/http://www.youtube.com/watch?v=OT1LFzO8k20/0.jpg" property="og:image"> 
```

任何人都可以帮助我。

在此先感谢，
普里亚

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T13:34:44.460

根据 Open Graph 介绍页面[http://ogp.me/](http://ogp.me/)，每个对象都需要 4 个元标记：

> *   og:title - 应该出现在图表中的对象的标题，例如“The Rock”。
> *   og:type - 对象的类型，例如“video.movi​​e”。根据您指定的类型，可能还需要其他属性。
> *   og:image - 应在图中表示您的对象的图像 URL。
> *   og:url - 对象的规范 URL，将在图中用作其永久 ID，例如“ [http://www.imdb.com/title/tt0117500/](http://www.imdb.com/title/tt0117500/) ”。

也许您需要在您的页面被识别之前实现所有 4 个？

# jquery - 带有 jQ uery 的复选框

> ID：16120499
> 
> 赞同：1
> 
> 时间：2013-04-20T12:41:51.347
> 
> 标签：jquery

这是jsfiddle [http://jsfiddle.net/6mk7m/9/](http://jsfiddle.net/6mk7m/9/)

我在 stackoverflow 上发现我需要创建 jsfiddle 帐户，这样我就可以向你们展示代码以便于阅读，（抱歉）如果我的英语不太好，

我目前正在学习jQuery，我不是专家，只是一个“初学者”，无论如何，

我做了一个复选框，我给了它一个 id = all

```
<input type="checkbox" id="all" /><span style='color:red'>All</span> 
```

我想要的是，当我点击这个带有这个特定**id**的复选框时，我想选中下面列出的这 3 个复选框

```
<input type="checkbox" name="us[]" value="google" />Google
<input type="checkbox" name="us[]" value="youtube" />Youtube
<input type="checkbox" name="us[]" value="friend" />Friend<br/><br/> 
```

所以这是我想出来的代码，

```
<script type="text/javascript">

$("document").ready(function() {

    $("input[id='all']").bind('click',function(){

        var all = $(this);

        console.log('status: ' + all.prop('checked'));

        if(all.prop('checked') == true)
        {
            //alert('now its true');
            $("input:checkbox").attr("checked","checked");
        }
        else if (all.prop('checked') == false){
            $("input:checkbox").removeAttr("checked");
        }

    })
})  
 </script> 
```

当我单击 id = all 的复选框时（**它选择所有复选框**）

现在，当我第二次单击 id = all 的复选框时（**它未选中所有复选框**）

***直到现在，每件事都受到欢迎***

现在，当我第三次单击 id = all 的复选框时出现问题

（**它不检查任何复选框**）但是，当我检查控制台时，我看到所有属性都等于选中 - 但是我没有在浏览器上看到它们选中的复选框我的意思是它们在中间没有这个**勾**号的复选框每个框，也许代码有问题，当我想点击超过 3 次时，我无法弄清楚为什么它不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-09-04T10:18:53.390

```
$(document).ready(function() {
    $('#selecctall').click(function(event) {  //on click 
        if(this.checked) { // check select status
            $('.checkbox1').each(function() { //loop through each checkbox
                this.checked = true;  //select all checkboxes with class "checkbox1"               
            });
        } else {
            $('.checkbox1').each(function() { //loop through each checkbox
                this.checked = false; //deselect all checkboxes with class "checkbox1"                       
            });         
        }
    });
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-20T12:50:52.820

这是一个具有正确行为的 jsFiddle。在 jQuery 的最新版本中，命令 prop() 应该用于更改元素的属性（而不是属性）。

[http://jsfiddle.net/6mk7m/10/](http://jsfiddle.net/6mk7m/10/)

请看下面的代码：

```
 if(all.prop('checked') == true)
    {
        //alert('now its true');
        $("input:checkbox").prop("checked",true);
    }
    else if (all.prop('checked') == false){
        $("input:checkbox").prop("checked",false);
    } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-20T12:57:38.767

```
$('#all').on('click', function(){
    $('input:checkbox[name="us[]"]').prop('checked', this.checked);
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-20T12:48:19.483

试试这个方法——

[工作小提琴](http://jsfiddle.net/mohammadAdil/6mk7m/12/)

```
$("input[id='all']").bind('click',function(){
        var all = $(this);
        console.log('status: ' + all.prop('checked'));
        if(all.is(':checked')){
            //alert('now its true');
            $("input:checkbox[name^='us']").prop("checked",true);
        }
        else{
            $("input:checkbox[name^='us']").prop("checked",false);
        }
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-20T12:55:21.817

为什么不让它变得超级简单：

```
$('#all').on("change",function(){
    $('input:checkbox').not('#all').each(function(a,b){
           var _checked=$('#all').is(":checked");
          $(b).prop('checked',_checked)
        });
}); 
```

看到这个[小提琴](http://jsfiddle.net/6mk7m/17/)

# azure - Windows Azure - 内部 IP 地址有什么用？

> ID：16120502
> 
> 赞同：7
> 
> 时间：2013-04-20T12:42:02.513
> 
> 标签：azure, azure-virtual-machine

我一直使用普通的公共 IP 在我的虚拟机之间进行通信。但是，正如我在门户中看到的那样，有一个内部 IP 地址，我想知道它的实际用途是什么？

是不是使用这个内部IP在VM之间进行通信会更快？这是否仅限于同一地理区域中的虚拟机？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-20T13:56:32.460

使用虚拟机，您可以使用外部 IP 地址（输入端点或实例输入端点）进行外部通信。前者是负载平衡的，而后者直接映射到特定的虚拟机实例。

在云部署中，您可能有多个虚拟机。他们每个人都可以通过IP/端口直接相互交谈。每个虚拟机都将被分配一个位于云部署网络本地的 IP 地址（也就是说，IP 地址是部署本地的；除非配置了虚拟网络，否则您无法与其他任何人的 VM 通信）。

内部直接 IP 的优势：您不需要启用任何类型的安全性。例如：如果你有一个只能在内部访问的 WCF 服务，你就不必担心 SSL、证书等。

@Eilistraee 的回答对性能进行了一项澄清：与外部 IP 地址通信不会受到任何惩罚。虽然请求确实被路由到数据中心的边缘，但您的呼叫实际上不会离开数据中心。此外：只要您在同一数据中心的虚拟机之间进行通信，就没有出站流量成本。

现在：使用云服务中的 Web/Worker 角色，您无需在内部与任何 IP 地址进行全权交谈。相反，您定义了特定的内部端点，它们最终映射到您的 Web 或工作人员实例上的特定端口（并且 Web 或工作人员角色的每个实例都将侦听同一端口，尽管您的代码必须手动选择哪个 Web/工作人员在该内部端点上与之交谈的实例）。

# drag-and-drop - jquery.event.drop 使用容差时过滤放置目标

> ID：16120503
> 
> 赞同：0
> 
> 时间：2013-04-20T12:42:07.367
> 
> 标签：drag-and-drop, jquery

我使用[jquery.event.drag/drop](http://threedubmedia.com/code/event/drop)完全重新排序树

对于重新排序，我使用基于[此演示的自定义“公差”功能](http://threedubmedia.com/code/event/drop/demo/reorder)

当树很小时，一切都很完美，但是有一些数据（> 2k）它很慢

作为树的打开和关闭节点，实际放置目标通常约为 50，但代码不希望过滤并且仍然在每个光标移动 2k 元素时计算..

我尝试了一些方法来过滤可用的放置目标，但没有任何成功

以 dropinit 事件为例：

```
return $(this).is( $availableDrop ); 
```

或在 $.drop 选项中设置过滤器选项

```
filter:".validdrop" 
```

我目前返回 0；当当前元素不是允许的元素时，在公差函数中...

它〜〜〜〜可用，但仍然慢得要命

我[用最少的东西设置了一个小提琴](http://jsfiddle.net/saBN6/17/)，*帮助我 Obi Wan Kenobi 你是我唯一的希望*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T14:34:41.537

好的，这是完整“直播”的原因，将所有内容提取到专用函数中，并在初始元素上使用经典的 init，未来的一项工作很棒。

```
$.fn.initDrag = function(){
    $(this).drag('init',draginit).drag('start',dragstart).drag('end',dragend).drag(indrag).drop('init',dropinit);
};

$(selector).initDrag(); 
```

[快速版小提琴:)](http://jsfiddle.net/saBN6/19/)

# session - Symfony2：新会话（）给出错误“会话已经开始......”

> ID：16120504
> 
> 赞同：0
> 
> 时间：2013-04-20T12:42:09.983
> 
> 标签：session, symfony, sessionid

我是symfony的业余爱好者。我想在我的代码中使用 Session_id

当我更改 php.ini 并将 session.auto.start 变量设置为**true**时，我会在 false 之后给出一个 symfony 错误，我应该使用这个参数

```
$session = new Session(); 
```

但现在我有一个新错误，当我执行 indexAction() 时：

```
An exception has been thrown during the rendering of a template ("Notice: A session had already been started - ignoring session_start() in C:\xampp\htdocs\artgirl\app\cache\dev\classes.php line 105") in "DotArtBundle:Basket:index.html.twig".
500 Internal Server Error - Twig_Error_Runtime
1 linked Exception: ErrorException » 
```

篮子控制器：

```
class BasketController extends Controller {
    public function getStaticAction(){
        $session = new Session();
        $session->start();

        $em = $this->getDoctrine()->getManager();
        $sql  = "Select ... where basket_id = '".$session->getId()."'";
    }
    //###############################################
    public function indexAction(){
      $user = new User();
      $form = $this->createFormBuilder($user)
                   ->add('username', 'text')
                   ->add('password', 'text')
                   ->add('email', 'text')
                   ->getForm();
    return $this->render('DotArtBundle:Artist:register.html.twig', array('form' => $form->createView(l)));
    }
} 
```

我在我的 base.html.twig 中使用 getStaticAction()

```
 {% set vPrice = render(controller('DotArtBundle:Basket:getStatic')) %} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T13:04:04.613

在 2.1 版中，他们改变了会话的工作方式，而不是自动启动，而是按需启动。

据我了解，Symfony 2 会话与 PHP 会话不兼容，并且 Symfony 替换了许多基本的 PHP 会话功能，因此您需要在 php.ini 中关闭自动启动并使用以下内容初始化会话：

```
use Symfony/Component/HttpFoundation/Session/Session;
$session = new Session();
$session->start(); 
```

然后，您应该可以在需要 ID 的任何地方执行以下操作：

```
$session = $this->getRequest()->getSession()->get('id'); 
```

Symfony[在这里解释了他们的会话处理](http://symfony.com/doc/master/components/http_foundation/sessions.html)，可能值得一读。

# windows - 无法在 Windows/Cygwin 上使用 perl 确定文件创建时间

> ID：16120509
> 
> 赞同：1
> 
> 时间：2013-04-20T12:42:58.797
> 
> 标签：windows, perl, file, cygwin

我写这个来找出给定文件的文件创建时间：

```
#!/usr/bin/perl
use strict;
use warnings;

use File::stat;

open (my $fh, '<', "abc.txt") or die "$!";
my $t = (stat($fh))[9];
print $t; 
```

但是，这不起作用，并给出：

```
Use of uninitialized value $t in print at ./tests.plx line 9. 
```

谁能指出我在这里做错了什么？或者这不能在 Windows/Cygwin 上的 perl (5.14.2) 上完成，我必须选择一些替代方法？

提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-20T12:45:02.390

`stat`from`File::stat`将返回`File::stat`对象。删除`use File::stat;`以获取数组或使用`my $t = stat($fh); print $t->atime;`.

# java - 在字符串中查找特定的特殊字符

> ID：16120514
> 
> 赞同：1
> 
> 时间：2013-04-20T12:43:33.697
> 
> 标签：java, regex, string, special-characters

我正在寻找一种正则表达式模式，以找出字符串变量中是否存在 4 个特定特殊字符中的任何一个：撇号 (') 和破折号 (-) 破折号 (-) 倒置问号 (¿)

我尝试了包含字符串的方法，但使用它我必须比较 4 次：

```
abc.contains("'")||abc.contains("-")||abc.contains("—")||abc.contains("¿") 
```

有没有更好的方法使用正则表达式？因为我必须对许多变量执行相同的操作。

我还可以知道以最短的方式专门找到了哪个字符吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-20T12:51:25.183

# mysql - 对使用 JDBC 的 Mysql 插入语句感到困惑

> ID：16120516
> 
> 赞同：0
> 
> 时间：2013-04-20T12:43:46.680
> 
> 标签：mysql, sql, jdbc, insert

我正在尝试将新行插入 MYSQL 数据库。问题实际上是如何构造用于准备语句的插入字符串。插入的新行具有新值，但从另一个表中获取其值的一列除外。我使用 H2 进行测试，这就是我构造字符串的方式。

```
"INSERT INTO RESERVATION CUSTOMER_CODE,ROOM_NUMBER,RESERVATION_DATE,START_DATE,END_DATE,
  TOTAL_PRICE) values(select CUSTOMER_CODE FROM CUSTOMER where EMAIL=?,?,?,?,?,?)" 
```

我认为插入字符串对于 MYSQL 是相同的，但它不起作用。我四处搜索并找到了这个答案[https://stackoverflow.com/a/26080/1788917](https://stackoverflow.com/a/26080/1788917)。所以我将字符串更改为；

```
"INSERT INTO RESERVATION  
 CUSTOMER_CODE,ROOM_NUMBER,RESERVATION_DATE,START_DATE,END_DATE,
  TOTAL_PRICE) select CUSTOMER_CODE FROM CUSTOMER where EMAIL=?,?,?,?,?,?" 
```

我认为它以某种方式起作用，因为错误发生了变化。但是现在MYSQL驱动告诉我还是有错误。不知何故，就好像引号超出了要求。这是错误

```
com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your
   SQL syntax; check the manual that corresponds to your MySQL server version for the 
   right syntax to use near ''A13','2013-04-20','2013-04-20','2013-04-24',14000.0' 
   at line ... 
```

这意味着它已经从另一个表中正确地获得了第一个值（CUSTOMER_CODE），但是其余的值被一起引用，这让我很困扰。我该如何解决这个...

我的错误在哪里？

我决定编写一个方法来获取客户代码，这样我就可以在没有任何选择查询的情况下插入语句。字符串现在看起来像这样

```
"INSERT INTO RESERVATION 
 (CUSTOMER_CODE,ROOM_NUMBER,RESERVATION_DATE,START_DATE,END_DATE,TOTAL_PRICE) 
 values(?, ?, ?, ?, ?, ?)" 
```

但是现在mysql驱动程序抱怨这样......

```
java.sql.SQLException: Parameter index out of range (2 > number of parameters, which 
    is 1).  at com.mysql.jdbc.SQLError.createSQLException(SQLError.java:1078) 
```

这是令人惊讶的，因为我放了 6 个问号而不是 1。错误出现在我将值设置到`?`占位符中的这些行的第二行。

```
preStatement.setLong(1, customer.getCustomerCode());
preStatement.setString(2, reservation.getRoomNumber());
preStatement.setDate(3, reservation.getReservationDate());
preStatement.setDate(4, reservation.getStartDate());
preStatement.setDate(5,reservation.getEndDate());
preStatement.setDouble(6, reservation.getTotalPrice()); 
```

那么为什么MYSQL驱动程序在我看来很好时抱怨参数数量。或者我忽略了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T13:14:08.217

您的两次尝试都包括：

```
where EMAIL=?,?,?,?,?,?" 
```

您的电子邮件只能等于一个值。也许你的意思是：

```
where EMAIL in (?,?,?,?,?,?)" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T12:52:05.317

你正在尝试做一些毫无意义的事情。

首先，您声明您打算插入

```
CUSTOMER_CODE,ROOM_NUMBER,RESERVATION_DATE,START_DATE,END_DATE, TOTAL_PRICE 
```

**但是你只提供 1 个值**CUSTOMER_CODE

要走的路是这样的

```
INSERT INTO RESERVATION  
CUSTOMER_CODE,ROOM_NUMBER,RESERVATION_DATE,START_DATE,END_DATE,TOTAL_PRICE) 
select CUSTOMER_CODE,ROOM_NUMBER,RESERVATION_DATE,START_DATE,END_DATE,TOTAL_PRICE where EMAIL=?; 
```

或者，如果您知道这些值

```
INSERT INTO RESERVATION  
CUSTOMER_CODE,ROOM_NUMBER,RESERVATION_DATE,START_DATE,END_DATE,TOTAL_PRICE) 
VALUES(?, ?, ?, ?, ?, ?); 
```

最后，您向 INSERT 声明的元素数量必须等于您插入的 VALUES，这些值可以显式声明（使用 VALUE 关键字），或者它们可能来自 SELECT 查询，在这种情况下，您不得使用 VALUE 关键字

# php - 从 localhost 但不是从服务器登录 horks

> ID：16120523
> 
> 赞同：0
> 
> 时间：2013-04-20T12:44:48.513
> 
> 标签：php, facebook, facebook-login

我按照 sdk 示例制作了一个脚本，如果我没有登录，它会给我一个登录按钮，如果我登录，它会给我一个注销按钮。当我在本地主机上开发它时一切正常，现在我已经移动到主机（freehostia.com）点击登录让我登录，但是 $user = $facebook->getUser(); 以某种方式返回 0（我现在它让我登录，就好像我在另一个我登录的选项卡中打开 facebook）并且我得到一个包含 code=xxxxxxx&state=xxxxx# *=*的链接 。Error_log 没有帮助导致没有任何记录。有人可以帮忙吗？

```
$facebook = new Facebook(array(
 'appId' => $appid,
 'secret' => $appsecret,
 'cookie' => false,
 ));
$user = $facebook->getUser();
$me=null;
echo $user;
 if ($user) {
 try {
    $me=$facebook->api('/me');
    $facebook->api('/me/feed','post', array(
        'message'=>'kalimera!'
    ));
    }
    catch (FacebookApiException $e)
    {
    error_log($e); 
    $user=null;
}
}
if ($me)
{
    $logoutUrl=$facebook->getLogoutUrl();
    echo "<a href='$logoutUrl'>Logout</a>";
}
else
{
    $loginUrl=$facebook->getLoginUrl(array(
        'scope'=>'publish_stream,read_friendlists'
    ));
    echo "<a href='$loginUrl'>Login</a>";
} 
```

此外，我在 php 上启用了 curl，并将会话路径设置为 session.save_path = "/"

# xna - XNA 与 Visual Studio 2012。/安装程序不工作

> ID：16120525
> 
> 赞同：2
> 
> 时间：2013-04-20T12:44:58.807
> 
> 标签：xna, devenv

我试图让 XNA 在 Visual Studio 2012 中工作，这样我就可以使用源代码控制，但我在这些步骤上遇到了困难。我已经阅读了许多页面，这些页面告诉您如何做到这一点，例如： [如何在 Visual Studio 2012 上安装 XNA 游戏工作室？](https://stackoverflow.com/questions/10881005/how-to-install-xna-game-studio-on-visual-studio-2012) 和 [http://ryan-lange.com/xna-game-studio-4-0-visual-studio-2012/](http://ryan-lange.com/xna-game-studio-4-0-visual-studio-2012/)

但我很难完成最后阶段，我似乎在谷歌上找不到任何东西。所以最后一步基本上是在管理员模式下从命令提示符运行它：“C:\Program Files (x86)\Microsoft Visual Studio 11.0\Common7\IDE\devenv.exe”/setup

我遇到的第一个问题是我的目录中没有 devenv，其他人说这是因为它被称为 WDExpress.exe 的快速添加而不是确实存在。然而问题是，当我用它替换 devenv.exe 并在 cmd 提示符下运行它时，实际上并没有发生任何事情。我没有收到任何错误，但也没有出现任何错误。它只是进入一个新行并忽略它。我也试过在最后输入 /h，而 /h 参数都没有提到 /setup，这让我担心它甚至可能不存在于 express 版本中。无论如何，有人可以为我解释一下这种情况吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-06-15T18:30:27.950

很快：尝试以管理员身份运行 Visual Studio，然后启动 Visual Studio 命令提示符（从工具菜单），然后运行`devenv.exe /setup`

我的 MSVS2010 有问题，我还必须运行 devenv.exe /setup。如果我以正常权限运行 MSVS，并启动 Visual Studio 命令提示符，执行后出现错误`devenv.exe /setup`：无法完成操作。

我也找不到`devenv.exe`你写的方式，所以我尝试在管理员模式下运行 MSVS：右键单击该程序并选择以管理员身份运行。再次打开 VS 命令提示符，并`devenv.exe /setup`为我执行正常工作。

您也可以尝试按照 smhnkmr 在[另一个 SO 页面上建议的方式运行程序](https://stackoverflow.com/questions/8300899/visual-studio-2010devenv-exe-outofmemory-exception-while-building-installer-fo)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-19T23:10:20.593

我在安装 XNA 扩展时也遇到了问题，当我尝试完成最后一步时，我也遇到了同样的错误。我总是收到错误：*无法完成操作* 我通过为我的 WDExpress.exe 创建快捷方式并将*/setup*添加到 Target 属性并以管理员身份启动快捷方式来修复它。

祝你好运！

# java - com.mongodb.DBObject / Java 的 BSON 序列化程序

> ID：16120533
> 
> 赞同：0
> 
> 时间：2013-04-20T12:45:32.923
> 
> 标签：java, mongodb, serialization, bson

嗨，任何人都知道一个 Java 库来帮助将 a 序列化/反序列`com.mongodb.DBObject`化为`BSON`二进制文件，反之亦然？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-10-06T09:12:49.337

这相当简单，您可以使用以下辅助方法：

```
public static byte[] encode(BSONObject bsonObject) {
    BSONEncoder encoder = new BasicBSONEncoder();
    return encoder.encode(bsonObject);
}

public static BSONObject readObject(InputStream is) throws IOException {
    BasicBSONDecoder encoder = new BasicBSONDecoder();
    return encoder.readObject(is);
}

public static BSONObject readObject(byte[] bsonObject) {
    BasicBSONDecoder encoder = new BasicBSONDecoder();
    return encoder.readObject(bsonObject);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-06-23T10:01:36.980

当您需要二进制 BSON，即 BSON 格式的字节数组时，您可以使用以下对：

```
public byte[] DBObjectToBSON(DBObject dbObject) {
    BasicBSONEncoder encoder = new BasicBSONEncoder();
    return encoder.encode(dbObject);
}

public DBObject BSONToDBObject(byte[] bson) {
    BasicBSONDecoder decoder = new BasicBSONDecoder();
    JSONCallback callback = new JSONCallback();
    decoder.decode(bson, callback);
    return (DBObject) callback.get();
} 
```

# python - 相关对象不显示

> ID：16120538
> 
> 赞同：0
> 
> 时间：2013-04-20T12:45:47.667
> 
> 标签：python, django

我想向用户在我的 django 网站上签出的对象显示相关对象。就像推荐一样。例如，当用户在 Las vegas 中单击某个状态的对象时，我希望 Las vegas 中的其他相关对象通过侧边栏显示。

就像当用户点击一个名为“拉斯维加斯的家”的链接时，当用户被重定向到显示家的页面时，在侧边栏上显示“拉斯维加斯的其他家”希望你明白我的意思吗？我尝试了以下代码，但它不起作用。整天都在为此奋斗，但没有成功。

楷模

```
class Finhall(models.Model):
    user=models.ForeignKey(User)
    name=models.CharField(max_length=250, unique=True)
    address=models.CharField(max_length=200)
    city=models.CharField(max_length=200)
    state=models.CharField(max_length=200, help_text='Las vegas')

    def __unicode__(self):
        return u'%s' % (self.name) 
```

意见：

```
def homedetail(request,finhall_id,slug):
    post=Finhall.objects.get(id=finhall_id,slug=slug) #show details of an object

    stateme=Finhall.objects.get(state)  #show similar objects based on state
    booms=Finhall.objects.filter(state=stateme)
    vips=booms.select_related()
    for vip in vips:
        print vip.id
    return render_to_response('postdetail.html',{'post':post,'vips':vips,'Finhall':Finhall},context_instance=RequestContext(request)) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T13:01:42.553

假设`state`派生自`post`您应该在模板中使用`filter`而不是`get`迭代，例如`stateme`

```
def home(request, finhall_id, slug):
    qs = Finhall.objects.all()

    try:
        finhall = qs.get(id=finhall_id, slug=slug)
    except Finhall.DoesNotExist:
        finhall = None

    if finhall:
        similar_finhalls = qs.filter(finhall.state)
    else:
        similar_finhalls = Finhall.objects.none()

    # other stuff

    return render_to_response('home.html', {
        'finhall': finhall,
        'similar_finhalls': similar_finhalls
    },context_instance=RequestContext(request)) 
```

# linux - 如何从现有脚本创建 shell 脚本？

> ID：16120545
> 
> 赞同：0
> 
> 时间：2013-04-20T12:46:58.323
> 
> 标签：linux, bash, shell, grep, echo

您好我想知道如何从现有的 shell 脚本创建 shell 脚本？我目前已经完成了一个应该创建的脚本，它看起来像这样：

```
#!/bin/bash

uptime=$(</proc/uptime)
uptime=${uptime%%.*}
user=$(whoami)
seconds=$(( uptime%60 ))
minutes=$(( uptime/60%60 ))
hours=$(( uptime/60/60%24 ))
days=$(( uptime/60/60/24 ))
echo -e "
\033[0;35m+++++++++++++++++++: \033[0;37mServer Data\033[0;35m :+++++++++++++++++++
\033[0;35m+  \033[0;37mHostname \033[0;35m= \033[1;32m`hostname`
\033[0;35m+    \033[0;37mKernel \033[0;35m= \033[1;32m`uname -r`
\033[0;35m+      \033[0;37mTime \033[0;35m= \033[1;32m`date +%k:%M:%S`
\033[0;35m+    \033[0;37mUptime \033[0;35m= \033[1;32m$days d ~ $hours h ~ $minutes m ~ $seconds s
\033[0;35m+       \033[0;37mCPU \033[0;35m= \033[1;32m`cat /proc/cpuinfo | grep 'model name' | cut -c 14-100 | uniq`
\033[0;35m+    \033[0;37mMemory \033[0;35m= \033[1;32m`cat /proc/meminfo | grep MemTotal | awk {'print $2'}` kB
\033[0;35m++++++++++++++++++++: \033[0;37mUser Data\033[0;35m :++++++++++++++++++++
\033[0;37m+  \033[0;37mUsername \033[0;35m= \033[1;32m$user
\033[0;35m+  \033[0;37mSessions \033[0;35m= \033[1;32m`who | grep $user | wc -l` of 14
\033[0;35m+++++++++++++++++++++++++++++++++++++++++++++++++++++\e[m 
" 
```

我看到的唯一问题是，像“cat”或“grep”这样的命令会让它们被解释出来，而不是被打印出来。所以这就是为什么我在这里问这样的事情怎么可能是一个。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T12:50:33.943

尝试使用*here-doc*和带有单引号的特殊技巧来执行此操作（无插值）：

```
cat<<'EOF'>script.sh
#!/bin/bash

uptime=$(</proc/uptime)
uptime=${uptime%%.*}
user=$(whoami)
seconds=$(( uptime%60 ))
minutes=$(( uptime/60%60 ))
hours=$(( uptime/60/60%24 ))
days=$(( uptime/60/60/24 ))
echo -e "
\033[0;35m+++++++++++++++++++: \033[0;37mServer Data\033[0;35m :+++++++++++++++++++
\033[0;35m+   \033[0;37mAddress \033[0;35m= \033[1;32m109.163.233.49
\033[0;35m+  \033[0;37mHostname \033[0;35m= \033[1;32m`hostname`
\033[0;35m+    \033[0;37mKernel \033[0;35m= \033[1;32m`uname -r`
\033[0;35m+      \033[0;37mTime \033[0;35m= \033[1;32m`date +%k:%M:%S`
\033[0;35m+    \033[0;37mUptime \033[0;35m= \033[1;32m$days d ~ $hours h ~ $minutes m ~ $seconds s
\033[0;35m+       \033[0;37mCPU \033[0;35m= \033[1;32m`cat /proc/cpuinfo | grep 'model name' | cut -c 14-100 | uniq`
\033[0;35m+    \033[0;37mMemory \033[0;35m= \033[1;32m`cat /proc/meminfo | grep MemTotal | awk {'print $2'}` kB
\033[0;35m++++++++++++++++++++: \033[0;37mUser Data\033[0;35m :++++++++++++++++++++
\033[0;37m+  \033[0;37mUsername \033[0;35m= \033[1;32m$user
\033[0;35m+  \033[0;37mSessions \033[0;35m= \033[1;32m`who | grep $user | wc -l` of 14
\033[0;35m+     \033[0;37mAdmin \033[0;35m= \033[1;32mSergey Ruslan
\033[0;35m+++++++++++++++++++++++++++++++++++++++++++++++++++++\e[m 
"
EOF 
```

# youtube - 检索 Youtube 节目 rss 提要

> ID：16120546
> 
> 赞同：0
> 
> 时间：2013-04-20T12:47:10.027
> 
> 标签：youtube, youtube-api, youtube-javascript-api, youtube-channels

有谁知道检索节目的 RSS 提要的方法。该节目发布了剧集，我想知道是否有任何方法可以检索带有更新的 xml 或某种 RSS 提要。示例节目链接是[http://www.youtube.com/show/beachgirlz/videos](http://www.youtube.com/show/beachgirlz/videos)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T20:03:49.703

好问题！你可以得到它，但实际上要得到你想要的东西有点挑战。

以下是目标示例：[https ://gdata.youtube.com/feeds/api/seasons/JQEfvHcfJjY/episodes?v=2](https://gdata.youtube.com/feeds/api/seasons/JQEfvHcfJjY/episodes?v=2)

问题是你如何到达那里！

我就是这样走到那一步的。

1.  找出创建节目的用户并使用以下 URL 访问用户创建的节目。[https://gdata.youtube.com/feeds/api/users/USERNAME/shows?v=2](https://gdata.youtube.com/feeds/api/users/USERNAME/shows?v=2)
2.  将其缩小到您想要的节目并转到该节目的供稿。[https://gdata.youtube.com/feeds/api/shows/SHOW_ID/content?v=2](https://gdata.youtube.com/feeds/api/shows/SHOW_ID/content?v=2)
3.  从那里你可以把它缩小到一个季节，最后得到你的剧集提要。[https://gdata.youtube.com/feeds/api/seasons/SEASON_ID/episodes?v=2](https://gdata.youtube.com/feeds/api/seasons/SEASON_ID/episodes?v=2)

# c# - 为什么真正的电子邮件大小比我的附件和文本大小要大？

> ID：16120550
> 
> 赞同：2
> 
> 时间：2013-04-20T12:47:28.377
> 
> 标签：c#, smtp, gmail, size, email-attachments

我有简单的代码来发送带有附件的电子邮件：

```
using (MailMessage mail = new MailMessage())
            {
                using (SmtpClient SmtpServer = new SmtpClient("smtp.gmail.com"))
                {

                    mail.From = new MailAddress("my_mail@gmail.com");
                    mail.Sender = new MailAddress("my_mail@gmail.com");
                    mail.To.Add("my_mail@gmail.com");
                    mail.Subject = "TEST";
                    mail.Body = "Test body message";

                    //Add attachment
                    System.Net.Mail.Attachment attachment;
                    attachment = new System.Net.Mail.Attachment("1568817207ComputationC.part1.rar"); //Size 24MB
                    mail.Attachments.Add(attachment);

                    SmtpServer.Port = 587;
                    SmtpServer.Credentials = new System.Net.NetworkCredential("my_mail@gmail.com", "password");

                    SmtpServer.EnableSsl = true;
                    SmtpServer.Timeout = 0;

                    SmtpServer.Send(mail);
                }
            } 
```

我的附件大小为 24MB + 一些文本 = 最大 25MB

我通过gmail收件箱中的“显示原始”选项测量了邮件的实际大小，然后我将此邮件下载到了我的硬盘上。

此外，当我测量我的应用程序发送电子邮件时发送的次数时，它显示为 33MB。

所以，我的问题是当我的附件 + 文本 = 最大 25MB :D 时，为什么这封电子邮件的实际大小是 33MB？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T12:57:01.390

因为您的电子邮件是[MIME 编码](http://en.wikipedia.org/wiki/MIME#Content-Transfer-Encoding)的 - 二进制数据从 8 位数据更改为（通常）7 位数据，以便在服务器之间可靠地传输。有几种不同的编码方案，但它们通常会为您的电子邮件大小增加 33% 的开销——因此 25Mb 的电子邮件实际上是 32.5Mb 的数据。

编辑：[此页面](http://en.wikipedia.org/wiki/Base64)对 Base64 编码有很好的解释，通常在发送电子邮件时使用：

> 每个输入字节的输出字节数约为 4 / 3（33% 开销），并且对于大量字节收敛到该值。更具体地说，给定 n 字节的输入，输出将是 4[n/3] 字节长，包括填充字符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T12:54:34.780

电子邮件附件使用 base64 编码从二进制形式（8 位）编码为仅 ASCII 字符（7 位）。因此，您不会在一个字节中使用所有 8 位，而仅使用 7 位，并且电子邮件的大小会变得更大。

# mongodb - 将 mongoDB 连接到 sencha 应用程序

> ID：16120557
> 
> 赞同：0
> 
> 时间：2013-04-20T12:48:24.657
> 
> 标签：mongodb, sencha-touch, mongoose

我对 sencha touch 非常陌生，目前正在开发一个包含类别列表的应用程序，当点击一个类别时，它会显示一个类别商家列表。我试图将我的数据库托管在 mongoLAB 上，拥有类别和商家表，我的主要问题是我找不到将我的应用程序与 mongoLAB 中托管的 MongoDB 表连接并用这些数据填充我的商店的方法，我意味着在我的应用程序中将我的商店与 mongoLAB 表连接起来的方式是什么，因为我有两个商店、类别和商家商店

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T06:08:42.893

如您所知 - “*代理被商店用来处理模型数据的加载和保存。有两种类型的代理：客户端和服务器。客户端代理的示例包括用于在浏览器内存中存储数据的内存和使用可用的 HTML 5 本地存储功能。服务器代​​理处理数据到远程服务器的封送处理，示例包括 Ajax、JsonP 和 Rest*。

现在，由于远程代理基本上在 AJAX 上工作，因此必须有一个可以与之交谈的 HTTP 端点（这与 Java 等不同，您可以使用相应的驱动程序连接到 DB）。所以基本上你必须通过 Web 服务公开你的 MongoDB，并且根据你选择的技术，你可以使用 Java、Php、Node.js 等轻松创建 Web 服务

# jquery - 索引所有内容并排除某些 div

> ID：16120558
> 
> 赞同：0
> 
> 时间：2013-04-20T12:48:32.373
> 
> 标签：jquery, indexing

我正在尝试像这样索引文档中的所有内容：

```
var index = $('body *').index(this); 
```

所以现在我想从所有项目中删除文本：

```
$('body *').contents().filter(function() {
  return this.nodeType == 3;
}).remove(); 
```

问题是我想从删除函数中排除某个元素。这个元素有一个数字作为文本，如下所示：

```
 <li id="2">2</li> 
```

所以 remove 函数不应该从`li`with中删除文本`id="2"`，根据它的`index(2)`. 我该怎么做呢？这就是我到目前为止所拥有的：[JsFiddle](http://jsfiddle.net/p83Rg/1/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T12:58:58.543

将其用作“非”元素的选择器...

```
var qw = $('li:eq(' + $("span").text() + ')'); 
```

看到这个更新的小提琴......

[http://jsfiddle.net/p83Rg/7/](http://jsfiddle.net/p83Rg/7/)

我强烈建议使用 ID 来识别跨度，因为如果页面上有任何其他跨度，这显然会中断:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T12:51:00.210

您可以使用选择器将其排除：

```
$('body *').not("li#2").contents().filter(function() {
  return this.nodeType == 3;
}).remove(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T12:51:44.923

在`.remove()`插入之前`.not('#2')`

# java - jackson vs json 简单的流解析

> ID：16120560
> 
> 赞同：4
> 
> 时间：2013-04-20T12:49:04.883
> 
> 标签：java, jackson, json-simple

我在 github 上有一个 json 库[https://github.com/jillesvangurp/jsonj](https://github.com/jillesvangurp/jsonj)

这个库有一个基于 json simple 的解析器，它使用一个处理程序类来完成创建我的库中的 JsonObject、JsonArray 和 JsonPrimitive 实例的所有工作。

我看到人们发布了各种基准测试，表明杰克逊解析器在性能方面与它一样好，而简单的 json 是较慢的选项之一。所以，为了看看我是否可以提高性能，我创建了一个替代解析器，它使用杰克逊流 API 并调用我用于原始解析器的相同处理程序。从功能的角度来看，这很好用，而且非常简单。

您可以在这里找到相关的类（JsonHandler、JsonParser 和 JsonParserNg）：[https ://github.com/jillesvangurp/jsonj/tree/master/src/main/java/com/github/jsonj/tools](https://github.com/jillesvangurp/jsonj/tree/master/src/main/java/com/github/jsonj/tools)

但是，我没有看到我运行的各种测试有任何改进。

所以，我的问题是：我应该看到任何改进吗？如果是，为什么？在我看来，至少在流 API 模式下，两个库的性能相似。

我会对其他人的经验非常感兴趣。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-21T19:48:14.003

不久前，我写了“[关于 Java JSON 处理的正确性能测试](http://www.cowtowncoder.com/blog/archives/2011/05/entry_455.html)”，列举了我在性能基准测试中看到的常见问题。有很多相对简单的方法可以搞乱比较。我假设你没有犯任何提到的错误，但值得一提。特别是关于使用原始输入的部分：很少有真正的 JSON 数据来自的情况`String`——所以一定要使用`InputStream`/ `OutputStream`（或字节数组）。

要注意的第二件事是，如果您使用树模型（如`JsonObject`），您已经添加了许多可能避免的开销：您正在构建一个`Map`/`List`结构，它使用 POJO 将使用的 3 倍内存；并且操作速度较慢。在这种情况下，实际的解析/生成开销通常是少数组件。有时树样式处理是有意义的，这是可以接受的开销。

因此，如果性能很重要，通常是：

1.  使用流式 API 构建您自己的对象——而不是内存中的树，或者
2.  使用与 POJO 的数据绑定。这可以接近 (1) 的速度

两者都比构建树（在某种程度上，序列化）更快。出于某种原因，许多开发人员以某种方式认为处理树表示与处理数据一样有效——事实并非如此，并且可以在[https://github.com/eishay/jvm-serializers等基准测试中看到](https://github.com/eishay/jvm-serializers)

我没有通过链接看到杰克逊相关的代码，所以我假设它按预期工作。要寻找的主要事情（wrt性能问题）实际上是：

1.  总是关闭`JsonParser`和`JsonGenerator`（需要一些回收）和
2.  重用`JsonFactory`和/或`ObjectMapper`实例：它们是线程安全的，通过这些对象重用某些组件（符号表、序列化程序）。
3.  如前所述，如果可能，请始终使用大多数原始输入/输出目标 ( `InputStream`, `OutputStream`)。

# java - Java EE 服务器上的 Exec 运行时

> ID：16120562
> 
> 赞同：1
> 
> 时间：2013-04-20T12:49:25.493
> 
> 标签：java, jakarta-ee, tomcat, runtime.exec

由于我的项目的某些原因，我需要在 Java EE 服务器上运行这个命令“gcc file.c -o file.exe”，我使用了这个 java 代码

```
try {  
        Runtime runtime = Runtime.getRuntime();
         String[] cmd={"cmd.exe","/C gcc " + a +".c" + " -o "+b};
         Process p = runtime.exec(cmd,null,null );
        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(p.getErrorStream()));
            String line = null;
            try {
               while((line = reader.readLine()) != null) {
                       System.out.println(line);
                }
            } finally {
                reader.close();
            }
        } catch(IOException ioe) {
            ioe.printStackTrace();

        }

        } 
    catch (Exception e) {System.out.println("erreur d'execution"); }

} 
```

该命令在 cmd 上完美运行，这段代码在 Java 应用程序上完美运行，我得到了我的输出（.exe）和我的错误。

一旦我稍后尝试在服务器上部署它（使用 JBoss 服务器），什么也没发生。我后来尝试从服务器执行 cmd 也没有发生任何事情。所以这是一种 Java EE 服务器问题。

我该如何解决？是否有其他服务器（例如 Tomcat）可以执行此代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T17:01:26.307

首先，使用 runtime.exe 生成进程违反了 EJB 规范，原因有很多。因此，正如他们所说，您一只手拿着枪，另一只手拿着子弹，如果您不了解这样做的含义，您很容易射中自己的脚。

您可以将此代码移动到 Servlet（仍部署到您选择的 JavaEE 容器中）以更加符合规范，但您仍然需要了解如果您的应用程序曾经在集群环境中运行，它将如何在集群环境中发挥作用。如果您需要该流程在数据库事务范围内进行交互，那么您会遇到更多问题，但假设这不是您的要求之一。

排除这些警告后，您当前的方法有一个重大缺陷，将导致不分青红皂白的线程死锁。当您启动一个进程时，您必须在它们自己的线程中管理 STDOUT/STDERR 流，以便缓冲区将耗尽而不会在两者之间出现死锁。您在这里没有这样做，您只是从您开始进程的同一线程中读取 InputStream。当你说“什么都没有发生”时，这很可能就是这里发生的事情。您是否对服务器进程进行了线程转储？

为了避免这种死锁，相信我，它们会在某个时候发生，使用类似于这里概述的模式：[为什么 runtime.exec() 挂起](http://vyvaks.wordpress.com/2006/05/27/does-runtimeexec-hangs-in-java/)

# c# - 使用多个控件过滤datagridview

> ID：16120564
> 
> 赞同：1
> 
> 时间：2013-04-20T12:50:11.147
> 
> 标签：c#, .net

我正在使用 Sqllite 数据库并使用五个组合框过滤 datagridview 并且它工作正常但我的问题是当我不在任何组合框中选择值时它不起作用因为我正在使用 AND 如果我将使用 OR 它会没有给我想要的结果，因为我想使用组合框中的所有选定值进行过滤。我的代码如下：

```
DataView dv = new DataView();
        string voterlist = "select * from voters";
        DataTable dt = Database.myAdapter(voterlist);
        dv = dt.DefaultView;
        dataGridView1.DataSource = dv;
        dv.RowFilter = string.Format("consname= '{0}' AND area = '{1}' AND pollingstn = '{2}' AND wardno = '{3}' AND policestn = '{4}'", combo_consname.SelectedItem, combo_Area.SelectedItem, combo_Polling.SelectedItem, combo_Ward.SelectedItem, combo_Police.SelectedItem); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T14:21:51.930

好吧，如果您希望允许用户不应用任何过滤，则`RowFilter`当至少其中一个`ComboBox`没有选定项目或根据您要提供的功能时，您不应该设置该属性，您可以`RowFilter`通过附加来构造：

```
" AND columnX = '" + yourValue + "'" 
```

一一且仅当 yourValue 为非 null 且非空字符串时。

当然，您不必以`RowFilter`字符串开头`AND`

# iframe - 如何处理 vimeo iframe 和定位固定元素？

> ID：16120567
> 
> 赞同：1
> 
> 时间：2013-04-20T12:50:35.960
> 
> 标签：iframe, video, position, fixed

我的网站：dwapotwory.com 使用嵌入 vimeo 视频。在 Safari (Mac) 和 Chrome (Win/Mac) 中，当 iframe 加载每个具有 position: fixed 的元素时（标题和左/右按钮 div）崩溃。

在 Safari 中没有 iframe 一切都很好：[http ://dwapotwory.com/1.html](http://dwapotwory.com/1.html)

在 Safari 中使用 iframe ...：[http ://dwapotwory.com/2.html](http://dwapotwory.com/2.html)

我将 iframe 包裹在 div 中，并在缩放浏览器窗口时设置为缩放，但这并没有导致问题（我尝试了一些响应式嵌入 vimeo 解决方案，但没有任何区别）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-01T19:02:50.423

所以我遇到了这个问题，因为我对视频（只是`video`标签，而不是实际`iframes`等）和固定位置的容器有类似的问题。

Safari 问题似乎很随机，在我的情况下，我通过将 -webkit-transforms 添加到固定容器来修复它，但在你的情况下，它显然可以通过将 z-index 设置为帧的绝对容器来解决，我通过直接在检查器中操作您的 DOM 来尝试，它似乎有效。

# ios - 如何在 NSMutableArray 中使用循环来获取任何索引处的对象

> ID：16120576
> 
> 赞同：0
> 
> 时间：2013-04-20T12:51:04.857
> 
> 标签：ios, objective-c, json, cocoa-touch, for-loop

我有这样的json文件：

```
{ "fileContent" : [ { "created" : "2013/04/11 - 10:00",
    "ext" : "sql",
    "modified" : "2013/04/11 - 10:00",
    "name" : "directorffdsgfg",
    "size" : "1577",
    "type" : "file"
  },
  { "created" : "2013/04/11 - 12:10",
    "ext" : "sql",
    "modified" : "2013/04/11 - 12:10",
    "name" : "directory02",
    "size" : "1577",
    "type" : "file"
  },
  { "created" : "2013/04/11 - 12:10",
    "ext" : "zip",
    "modified" : "2013/04/11 - 12:10",
    "name" : "jquery-mousewheel-master",
    "size" : "5213",
    "type" : "file"
  }
],
"files" : 9,
"folderContent" : [ { "created" : "2013/04/11 - 05:04",
    "ext" : "sql",
    "modified" : "2013/04/11 - 05:04",
    "name" : "Folder 2",
    "size" : "1577",
    "type" : "folder"
  },
  { "created" : "2013/04/15 - 09:08",
    "ext" : "zip",
    "modified" : "2013/04/15 - 09:08",
    "name" : "Folder 1",
    "size" : "11867",
    "type" : "folder"
  }
],
"folders" : 2
} 
```

我想从顶部 json 中获取文件内容中的唯一名称值并存储在对象中。但我不能。

这是我的代码：

**视图控制器.m**

```
#import "Object.h"
@implementation ViewController
{
    NSDictionary *titles;   //this variable for read json
    NSMutableData *Data;
    NSMutableArray *fileContent;
    NSString *janatan;
    NSString *number;
    NSInteger num;
    NSMutableArray *recipes;
}

@synthesize Table;

- (void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response
{
    Data = [[NSMutableData alloc]init];
}

- (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)theData
{
    [Data appendData:theData];
}

- (void)connectionDidFinishLoading:(NSURLConnection *)connection
{
    [UIApplication sharedApplication].networkActivityIndicatorVisible = NO;

    titles = [NSJSONSerialization JSONObjectWithData:Data options:kNilOptions error:nil];
    fileContent = [titles objectForKey:@"fileContent"];
    //NSLog(@"%@",fileContent);
    number = [titles objectForKey:@"files"];
    num = [number integerValue];
    NSLog(@"num : %d",num);
    for (int i = 0; i <= num; i++) {
        NSLog(@"%d",i);
        Object *obji = [Object new];

// this method should read many names in fileContent but not worke!!!
        janatan = [[fileContent objectAtIndex:i]objectForKey:@"name"];

        NSLog(@"%@",janatan);
        obji.nameLable = janatan; 
        if(!recipes){
            recipes = [NSMutableArray array];
        }
        [recipes addObject:janatan];
        NSLog(@"object : %@",recipes);
    }

    [Table reloadData];
}
- (void)connection:(NSURLConnection *)connection didFailWithError:(NSError *)error
{
    UIAlertView *errorView = [[UIAlertView alloc]initWithTitle:@"Error" message:@"The Connection has been LOST" delegate:self cancelButtonTitle:@"OK" otherButtonTitles: nil];
    [errorView show];
    [UIApplication sharedApplication].networkActivityIndicatorVisible = NO;
}
- (void)viewDidLoad
{
    [super viewDidLoad];
    [UIApplication sharedApplication].networkActivityIndicatorVisible = YES;
    NSURL *url =[NSURL URLWithString:@"http://192.168.1.105/janatan/root/developers/api/filemanager.php?key=5147379269&getlist=root"];
    NSURLRequest *request = [NSURLRequest requestWithURL:url];
    [[NSURLConnection alloc]initWithRequest:request delegate:self];

}

#pragma mark - Table view data source
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    // Return the number of sections.
    return 1;
}
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    // Return the number of rows in the section.
    return num;
}
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"cell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];    
    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    }

    return cell;
}
@end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T13:05:36.187

替换`for (int i = 0; i <= num; i++)` 为：

```
for (NSDictionary* dict in fileContent) {
    .......
    janatan = [dict objectForKey:@"name"];
    ....... 
} 
```

# android - Android 滑动展开视图

> ID：16120578
> 
> 赞同：5
> 
> 时间：2013-04-20T12:51:14.400
> 
> 标签：android, slide, drawer

我有一个如图所示的布局：

![布局](https://i.stack.imgur.com/KeOpG.jpg)

我希望用户能够向下拖动“显示详细信息...”部分以查看更多信息。我试过*SlidingDrawer*，但没有运气。是否有建议，例如一段代码或第三方组件可以解决问题？甚至是另一种适合直观显示更多信息的 UI 布局，不会过多地破坏用户体验。

这是我目前使用的 XML 布局，但它只是一个工作草案：

```
<?xml version="1.0" encoding="UTF-8"?>

<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
             android:layout_width="match_parent" 
             android:layout_height="match_parent">

  <fragment android:id="@+id/map"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:name="com.google.android.gms.maps.SupportMapFragment"/>

  <LinearLayout android:orientation="vertical" 
                android:layout_width="fill_parent" 
                android:layout_height="wrap_content" 
                android:layout_gravity="top"
                android:background="#A0000000">

    <TextView android:id="@+id/message_text_text"
              android:layout_height="wrap_content"
              android:layout_width="fill_parent"
              android:textColor="#FFFFFF"
              android:padding="10dip"
              android:textSize="13sp"/>

    <LinearLayout android:orientation="vertical" 
                  android:visibility="gone"
                  android:id="@+id/details"
                  android:layout_width="fill_parent" 
                  android:layout_height="wrap_content" 
                  android:layout_gravity="top"
                  android:padding="10dip">

      <ListView android:id="@+id/message_list_responses"
                android:layout_width="fill_parent"
                android:layout_marginTop="10dp"
                android:layout_marginLeft="30dp"
                android:layout_height="wrap_content" />  

    </LinearLayout>

    <TextView android:id="@+id/details_button"
              android:layout_height="wrap_content"
              android:layout_width="fill_parent"
              android:textColor="#FFFFFF"
              android:padding="5dip"
              android:onClick="onDetails"
              android:gravity="center"                
              android:clickable="true"
              android:background="#80000000"
              android:text="Show details..."
              android:textSize="11sp"/>
  </LinearLayout>

</FrameLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-03T13:07:09.127

考虑使用来自 GitHub 的 SlidingMenu 库。它非常灵活，你可以用它做任何事情。您只需调用以下命令即可滑动操作栏：

```
setSlidingActionBarEnabled(true); 
```

[https://github.com/jfeinstein10/SlidingMenu](https://github.com/jfeinstein10/SlidingMenu)

# java - 将字符串转换为“日期”类型

> ID：16120579
> 
> 赞同：3
> 
> 时间：2013-04-20T12:51:16.340
> 
> 标签：java, date, calendar

我已经使用日历类来获取当前日期。现在我想将该日期转换为日期格式，以便它可以以“yyyy-mm-dd”格式存储在数据库中。我尝试使用 SimpleDate 格式对其进行转换，但出现错误。代码如下。帮助。提前致谢。

```
class dateDemo
{
    public static void main(String args[])
    {

    String stringdate ;
    SimpleDateFormat sdf;
    String year,month,day;  

    Calendar currentDate;
    Date validity;

    currentDate = Calendar.getInstance();

    year = "" + currentDate.get( Calendar.YEAR );
    month = "" + currentDate.get( Calendar.MONTH );
    day = "" + currentDate.get( Calendar.DAY_OF_MONTH );

    stringdate = year+"/"+month+"/"+day;

    sdf = new SimpleDateFormat("yyyy-mm-dd");

    try
    {
    validity = sdf.parse ( stringdate );
    }

     catch(Exception e)
    {
            System.out.println(""+e);
    }

    System.out.println("Current Date is:"+stringdate);

    System.out.println("Date is"+validity);             

    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T12:59:12.883

我运行了你的代码并得到了`java.text.ParseException`. 只是为了消除错误，您可以简单地将程序中的“/”更改为“-”，但它不会为您提供正确的日期。

试试这个修改后的解决方案，采用 String、java.util.Date 和 java.sql.Date 格式：

```
class dateDemo {

    public static void main(String args[]) {

        SimpleDateFormat sdf;
        String validity = "";
        Date validityDate = null;
        java.sql.Date validateDateSql = null;

        Date currentDate = Calendar.getInstance().getTime();
        sdf = new SimpleDateFormat("yyyy-MM-dd");
        try {
            validity = sdf.format(currentDate);
            validityDate = sdf.parse(validity);
            validateDateSql = new java.sql.Date(validityDate.getTime());                    
        } catch (Exception e) {
            System.out.println("" + e);
        }
    }
} 
```

记下 SimpleDateFormat 设置：`yyyy-MM-dd`，而不是`yyyy-mm-dd`。这很重要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T13:31:49.517

阅读 Roxinus 的答案以获取正确的代码。

我建议您在编写代码时始终查看 Java API 的文档。它非常有用，您经常会发现如何使用该代码： [Java API 文档](http://docs.oracle.com/javase/7/docs/api/index.html?java/text/SimpleDateFormat.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-20T13:53:46.097

数据库连接器可以处理日期，不要将其转换为字符串，这不是一个好习惯。

您可以像这样重写代码：

```
PreparedStatement pstmt = connection.prepareStatement("INSERT INTO MyTable values(?)");
java.sql.Date sqlDate = new java.sql.Date(currentDate.getTime()); 
pstmt.setDate(1, sqlDate) 
```

# python - Matplotlib: How to work across several widgets? How to properly stop them?

> ID：16120583
> 
> 赞同：2
> 
> 时间：2013-04-20T12:51:38.810
> 
> 标签：python, matplotlib, widget, break

I wonder if anyone could help me with this problem in the application of the matplotlib widgets:

I have to work with the spectra of HII galaxies (these are simply a flat plots with some sudden peaks whose location is known to us). I need to "confirm" the location of these lines (you could say the thickness of the peaks on the plot) and determine the continuum level (this means the average y coordinate of the plot at the left and right regions of the peak). This is a simple task but given the number of plots and the number of lines in each plot I would like to use a short python code to simplify the process and avoid me missing some of the peaks.

I have watched the lectures of John Hunter on youtube and I believe I will be more than happy with the default widgets to use as my GUI, particularly the spanselector, press event and cursor event.

My problem is that I am not sure which is the right way to work with several widgets affecting the same graph: Currently my code opens a given spectrum and starts to display a fraction of the plot where I know my first line should be. Then it should continue by displaying the next line. At each loop it should perform something like this: (It is a copy from the spanselector example in matplotlib library adapted for this example)

```
import numpy as np
import matplotlib.pyplot as plt
from matplotlib.widgets import SpanSelector

def onselectPeak(xmin, xmax):
        indmin, indmax = np.searchsorted(x, (xmin, xmax))
        indmax = min(len(x)-1, indmax)
        print "Xmin " + str(indmin) + " at index " + str(indmin)
        print "Xmax " + str(indmax) + " at index " + str(indmax)
        ax.fill_between(x[indmin:indmax], -1.0, y[indmin:indmax],facecolor='Red',alpha=0.5)

def onselectLeftContinuum(xmin, xmax):
        indmin, indmax = np.searchsorted(x, (xmin, xmax))
        indmax = min(len(x)-1, indmax)      
        print "Leftmin " + str(indmin) + " at index " + str(indmin)
        print "Leftmax " + str(indmax) + " at index " + str(indmax)
        ax.fill_between(x[indmin:indmax], -1.0, y[indmin:indmax],facecolor='Blue',alpha=0.5)

def onselectRightContinuum(xmin, xmax):
        indmin, indmax = np.searchsorted(x, (xmin, xmax))
        indmax = min(len(x)-1, indmax)
        print "Xmin " + str(indmin) + " at index " + str(indmin)
        print "Xmax " + str(indmax) + " at index " + str(indmax)
        ax.fill_between(x[indmin:indmax], -1.0, y[indmin:indmax],facecolor='Blue',alpha=0.5)       

fig = plt.figure(figsize=(8,6))
ax = fig.add_subplot(111, axisbg='#FFFFCC')

x = np.arange(0.0, 10.0, 1.0)
y = [0.0,0.0,0.0,0.0,5.0,0.0,0.0,0.0,0.0,0.0,]

ax.plot(x, y, '-')
ax.set_ylim([-1.0,6.0])

ax.set_title('Press left mouse button and drag Line region')
span = SpanSelector(ax, onselectPeak, 'horizontal', useblit=True, rectprops=dict(alpha=0.5, facecolor='red') )

ax.set_title('Press left mouse button and drag left region of the continuum')
span = SpanSelector(ax, onselectLeftContinuum, 'horizontal', useblit=True, rectprops=dict(alpha=0.5, facecolor='blue') )

ax.set_title('Press left mouse button and drag right region of the continuum')
span = SpanSelector(ax, onselectRightContinuum, 'horizontal', useblit=True, rectprops=dict(alpha=0.5, facecolor='blue') )

plt.show()

print "Task Completed" 
```

To start there are two problems with this code:

1.  The plot jumps to the final span selection, ignoring the two previous
2.  The code does not stop. In all the examples of spanselector I have found, the codes keep running... I cannot find a way to stop them so I can continue with a loop...
3.  Finally, (but less important) the modifications of each area fill are not "remembered" well by the plot after each region selection

My first question is how to avoid these problems... The additional doubts I have are:

*   A) I think I could make this work by showing and closing the graphs before each span selector... but that will break my work flow...
*   B) Could I manage this with key events? How? Should it be a single key to move forward in the code? our should it be a single code for each widget I want to apply?
*   C) Would you please advice me any tutorial on matplotlib to learn how to manage the code flow with key events?

If you managed to read this very long question thanks a lot!

---EDIT

I have been working on this problem for the last week and I have finally started to understand how it should work:

1) Events and plt.show must be running all the time. Indeed, the latter is designed to be set implemented at the end of the code. The events call should be just before

2) To change the data on your figures you can use a key event. This post illustrates the right way to do it and it includes a class for it

[Using events with matplotlib in a for loop](https://stackoverflow.com/questions/14347630/using-events-with-matplotlib-in-a-for-loop?rq=1)

3) The problem with this structure is that your code must be fragmented in different methods. You need to make sure to define your variables in the main code so they can be imported across different methods (I am still struggling with this... I will post an example code when I am done)

One additional question: When I try to run the cursor widget with the spanselector widget the widgets glitches in a rather... painful way to the eye way... Is there anyway to avoid this? I have been playing with the cursor useblit widget but no luck

# php - 如何从使用按钮工厂创建的 Paypal 按钮获取返回结果

> ID：16120589
> 
> 赞同：0
> 
> 时间：2013-04-20T12:52:01.317
> 
> 标签：php, paypal

我使用按钮工厂创建了一个贝宝按钮，并在 php 文件中使用了提供的 html 代码，我提供了取消/返回和成功的 url。

现在我想在会话中获得价值或从贝宝请求获取它是否成功。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T13:26:48.217

虽然可以通过用户返回的url（即cancel、return、success）来检测交易是否成功，但这并不是一个很安全的方法。您最好将 PayPal 发回您数据库中的秘密链接的结果保存（假设您有一个），并在用户下次请求时检查。然后，您可以将数据库中的值插入到会话中。如果您注册了 PayPal 交易的开始，而 PayPal 尚未返回结果并且用户确实提出了请求，例如，您可能会显示一个页面，告诉用户在返回您的站点之前完成其交易。

# vb.net - 网上支付申请

> ID：16120592
> 
> 赞同：0
> 
> 时间：2013-04-20T12:52:10.173
> 
> 标签：vb.net, visual-studio-2012, paypal, paypal-adaptive-payments

我在 Visual Basic.net 中开发了一个试用应用程序 目前，为了让用户拥有完整版，他们需要为他们的计算机验证密钥。我的问题是：是否有可能加入一项功能，这样一旦用户支付了完整版的费用（通过 Paypal 或任何其他在线支付服务），密钥就会通过电子邮件或下载自动发送给他们？

这在 Visual Basic 中容易做到吗？如果没有，是否有另一种自动方式让用户在成功付款后接收应用程序的有效密钥？有人做过吗？如果是这样，您推荐什么服务？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T13:45:22.600

您可以自己在代码中执行此操作，但坦率地说，您也可以着手重新发明轮子。您所描述的内容和您想要实现的内容非常巧妙地属于软件许可领域，实际上您可能希望这对您自己来说是一个尽可能轻松的过程。您可以使用许多解决方案，谢天谢地，大多数解决方案还为您提供了先试用的机会。

我建议您将 infralution 许可系统作为一个以合理成本提供的示例（您可以从这里找到更多信息[http://www.infralution.com/licensing.html](http://www.infralution.com/licensing.html) ）我发现了这个成为一个完全称职的解决方案，在需要时提供出色的支持，并且比尝试构建自己的解决方案要容易得多。

# jquery - 从 jQuery 获取 css 过渡

> ID：16120593
> 
> 赞同：1
> 
> 时间：2013-04-20T12:52:12.850
> 
> 标签：jquery, css, transition

我目前正在尝试在转换开始时绑定一个事件。动画包含在焦点上调整大小的文本区域。

对于过渡结束，我们知道我们有：

```
jQuery(this).bind("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd", function() {
}); 
```

但是对于过渡结束，我可以使用什么？

注意：在我的情况下，animationstart 和 animationend 不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T13:40:11.457

如果过渡从 textarea 焦点开始，那么为什么不使用：

```
$('textarea').on('focus focusout', function() {
    $('div').html('started');
}).on("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd", function() {
    $('div').html('ended');
}); 
```

这是一个工作示例： http: [//jsfiddle.net/neYfj/5/](http://jsfiddle.net/neYfj/5/) - 它在转换开始时触发并添加一个`transitionend`事件。

# android - 如何在 macbook pro 上呈现/查看安卓屏幕？

> ID：16120599
> 
> 赞同：2
> 
> 时间：2013-04-20T12:52:52.977
> 
> 标签：android, macos

我正在寻找一种应用程序和软件，我可以使用它来在我的 Mac 上展示/查看我的 android 屏幕，就像谷歌在他们的主题演讲和演示文稿中使用的那样。所有的动作都来自手机，电脑屏幕上会显示我在手机上做的事情。我正在使用带有 4.2 的 Galaxy Nexus。我在屏幕上找到了机器人，但更新计算机屏幕的速度太慢。有谁知道任何其他应用程序？我更喜欢使用 USB 电缆的应用程序，但也欢迎使用 wifi 的解决方案。

非常感谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-20T12:54:49.270

您可以使用[MHL 到 HDMI](http://en.wikipedia.org/wiki/Mobile_High-Definition_Link)适配器从 Galaxy Nexus 输出视频。Galaxy Nexus 上的 Android 4.2 支持此功能。然后，您可以使用任何媒体卡适配器在笔记本电脑上进行 HDMI 输入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T13:02:43.747

Raghav 的回答是我知道的最好的方法，但是如果这不是你的选择，我过去曾使用[过它](https://play.google.com/store/apps/details?id=org.onaips.vnc)。

它有点慢，但在紧要关头工作，你不需要买任何新东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-10T21:10:00.677

到目前为止，我发现最好的是 droid@screen。

它需要许多步骤、下载、JAVA 组件、Adroid SDK 和其他位、其他一些调整和一个 JAR 文件，但它*确实*有效。

虽然通过 USB 数据线刷新屏幕有点慢。

我在 2 个月大的 macbook air 和三星 Galaxy Note 2 手机上运行 Yosemite。

祝你好运 ！

# java - 消费者生产者多线程消费者不会死

> ID：16120605
> 
> 赞同：1
> 
> 时间：2013-04-20T12:53:31.940
> 
> 标签：java, multithreading, producer-consumer

我有一个标准的生产者消费者问题。生产者将数据放入堆栈（缓冲区）消费者接受它。问题是当生产者结束生产数据时，消费者并没有死亡（并非总是如此）。

我想让消费者在生产者结束他的`for`循环后死去

```
for(int i = 0; i < 10; i++){
        try{
    //      sleep((int)(Math.random() * 1));                
        }catch(Exception e){e.printStackTrace();}
        b.put((int) (Math.random()* 10));
        System.out.println("i = " + i);
    }
    b.stop(); 
```

那么我将`b.stop()`which changes `running`field in称为`Buffer`false 和`notifiesAll()`

结束然后我得到：

```
i = 9 // number of iteration this is 10th iteration
Consumer 2.: no data to take. I wait.  Memory: 0
Consumer 1.: no data to take. I wait.  Memory: 0
Consumer 3.: no data to take. I wait.  Memory: 0 
```

他们应该死了，所以我做了方法 stop() 但它没有用。

代码正在运行，请检查

```
import java.util.Stack;

public class Buffer {
private static int SIZE = 4;
private int i;//number of elements in buffer
public Stack<Integer> stack;
private volatile boolean running;
    public Buffer() {
        stack = new Stack<>();
        running = true;
        i = 0;
    }
    synchronized public void put(int val){
        while (i >= SIZE) {
            try {
                System.out.println("Buffer full, producer waits");
                wait();
            } catch (InterruptedException exc) {
                exc.printStackTrace();
            }
        }   
        stack.push(val);//txt = s;
        i++;
        System.out.println("Producer inserted " + val + " memory: " + i);
        if(i - 1 == 0)
            notifyAll();
        System.out.println(stack);
    }

    public synchronized Integer get(Consumer c) {
        while (i == 0) {
            try {
                System.out.println(c + ": no data to take. I wait.  Memory: " + i);
                wait();
            } catch (InterruptedException exc) {
                exc.printStackTrace();
            }
        }   
        if(running){
            int data = stack.pop();
            i--;    
            System.out.println(c+  ": I took: " + data +" memory: " +  i);
            System.out.println(stack);
            if(i + 1 == SIZE){//if the buffer was full so the producer is waiting
                notifyAll();
                System.out.println(c +  "I notified producer about it");
        }
        return data;}
        else 
            return null;
    }

    public boolean isEmpty(){
        return i == 0;
    }
    public synchronized void stop(){//I THOUGH THIS WOULD FIX IT~!!!!!!!!!!!!!!
        running = false;
        notifyAll();
    }
    public boolean isRunning(){
        return running;
    }

} 
```

* * *

```
public class Producer extends Thread {
private Buffer b;
    public Producer(Buffer b) {
        this.b = b;
    }

    public void run(){
        for(int i = 0; i < 10; i++){
            try{
        //      sleep((int)(Math.random() * 1));                
            }catch(Exception e){e.printStackTrace();}
            b.put((int) (Math.random()* 10));
            System.out.println("i = " + i);
        }
        b.stop();
    }

} 
```

* * *

```
public class Consumer extends Thread {
    Buffer b;
    int nr;
    static int NR = 0;

    public Consumer(Buffer b) {
        this.b = b;
        nr = ++NR;
    }

    public void run() {
        Integer i = b.get(this);
        while (i != null) {
            System.out.println(nr + " I received : " + i);
            i = b.get(this);
        }
        System.out.println("Consumer " + nr + " is dead");
    }

    public String toString() {
        return "Consumer " + nr + ".";
}

} 
```

* * *

```
public class Main {

    public static void main(String[] args) {

        Buffer b = new Buffer();
        Producer p = new Producer(b);
        Consumer c1 = new Consumer(b);
        Consumer c2 = new Consumer(b);
        Consumer c3 = new Consumer(b);  
        p.start();
        c1.start();c2.start();c3.start();

    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T13:02:07.330

当缓冲区为空时，消费者开始等待。当收到通知时，它会检查缓冲区是否为空，如果仍然为空，则再次开始等待。`running`如果标志已设置为 false ，则不应再次开始等待：

```
while (i == 0 && running) {
    ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T13:03:11.127

`run()`您的for中的一个小修改`Consumer`：

```
public void run() {
    Integer i = b.get(this);
    while (i != null && i!=10) {
        System.out.println(nr + " I received : " + i);
        i = b.get(this);
    }
    System.out.println("Consumer " + nr + " is dead");
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T13:08:08.817

您的实现存在重大缺陷。变量 i 的修改不是线程安全的，这意味着您可以获得无法解释的结果。它可能导致竞争状况。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-09T10:23:13.067

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading;

namespace ThreadsConsolApp
{

        public sealed class ProducerConsumer
        {
            const int MagicNumber = 30;                                 // Indicates how many times to bounce between ping and pong threads 
            private Object m_lock = new Object();                       // Lock to protect counter increment 
            private Queue<int> m_queue = new Queue<int>();

            // Ctor 
            public ProducerConsumer()
            {
            }
            public void admin()
            {
                int i = 0;
                lock (m_lock)
                {
                    while (i <= MagicNumber)
                    {
                        Monitor.Wait(m_lock); //wait
                        Console.WriteLine("Controller = Produced " + i + " , Consumeed " + i);
                        Monitor.Pulse(m_lock); //release
                        i++;
                    }
                }
            }
            // Ping
            public void Producer()
            {
                int counter = 0;

                lock (m_lock)                                               // Allows only one thread at a time inside m_lock 
                {
                    while (counter <= MagicNumber)
                    {
                        Thread.Sleep(500);                               // Get data chunks from some source 
                        Monitor.Wait(m_lock);                           // Wait if the thread is busy. 'wait' will hold 
                                                                       //this loop until something else pulses it to release the wait. 
                        Console.WriteLine("producer {0}", counter);
                        m_queue.Enqueue(counter);//entring in queue
                        Monitor.Pulse(m_lock);                          // Releases consumer thread 
                        counter++;
                    }
                }
            }

            public void Consumer()
            {
                lock (m_lock)                                           // Allows only one thread at a time inside m_lock 
                {
                    Monitor.Pulse(m_lock);

                    while (Monitor.Wait(m_lock,1000))                  // Wait in the loop while producer is busy. Exit when producer times-out. 1000 = 1 second; ...
                                                                      //app will hang without this time-out value 
                    {
                        int data = m_queue.Dequeue();//dispatch from queue
                        Console.WriteLine("consumer {0}", data);
                        Monitor.Pulse(m_lock);                          // Release consumer 
                        Console.WriteLine("=====================");
                    }
                }
            }
        }

        class Program
        {
            static void Main(string[] args)
            {
                ProducerConsumer app = new ProducerConsumer();

                // Create 2 threads 
                Thread t_producer = new Thread(new ThreadStart(app.Producer));
                Thread t_consumer = new Thread(new ThreadStart(app.Consumer));
                Thread t_admin = new Thread(new ThreadStart(app.admin));

                // Start threads 
                t_admin.Start();
                t_producer.Start();
                t_consumer.Start();

                // Waith for the threads to complete 
                t_admin.Join();
                t_producer.Join();
                t_consumer.Join();

                Console.WriteLine("\nPress any key to complete the program.\n");
                Console.ReadKey(false);
            }
        }
    } 
```

# android - ActionBar 总是重新创建

> ID：16120608
> 
> 赞同：0
> 
> 时间：2013-04-20T12:53:54.303
> 
> 标签：android, android-actionbar, android-configchanges

我已经创建了操作栏和选项卡，就像我之前的帖子一样，

[片段webview java脚本功能不起作用](https://stackoverflow.com/questions/16077002/fragment-webview-java-script-function-is-not-working/)

[Android 操作栏中的菜单](https://stackoverflow.com/questions/16028911/menu-in-action-bar-android/)。

我已经在 ActionBar 中加载了 webview。在 web 视图中，我放置了一个用于捕获图像的按钮，并且**设备的相机打开并拍照，**然后我将值返回到加载的 html 文件。我已经**通过本机方法检查了 html 文件中的值，这很好**。但**总是重新创建操作栏**。而不是打开相机并将值返回到 webview，如果我试图**将任何字符串发送到 html 文件，它不会重新加载**。如果我在操作栏选项卡场景中启动任何活动，则只会调用两次 onCreate() 方法，因此会重新加载 html 页面。我已经指定了**“android:configChanges="orientation|keyboardHidden|screenSize"**对于所有的活动。如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T04:49:18.943

如果我们在**AndroidManifest.xml文件中提供所有****configChanges**属性，则启动的活动**不会总是重新创建**。但是在目标设备中，我们必须选中**“设置-->开发者选项-->应用程序-->不保留活动”**这个复选框**一定不要选中**。如果我们启用此复选框，则**一旦用户离开该活动，启动的活动就会被销毁**。不应选中此选项，然后始终不会重新创建已启动的活动。

 ********注意：**我已经在**Google Nexus S 4.1.2** Android 设备中检查了这一点。******

# symfony - 安装并启用 intl 扩展（用于验证器）

> ID：16120609
> 
> 赞同：0
> 
> 时间：2013-04-20T12:54:22.937
> 
> 标签：symfony, osx-mountain-lion, mamp

在 Symfony 配置过程中，建议安装并启用 intl 扩展。我遵循了本教程：[http](http://sunny.chotai.uk.com/?p=2) ://sunny.chotai.uk.com/?p=2 。

在**终端**中，我写了这个命令：

```
sudo port install php54-intl 
```

但后来我收到了这条消息：

```
Warning: The Command Line Tools for Xcode don't appear to be installed;
most ports will likely fail to build.
Warning: See http://guide.macports.org/chunked/installing.xcode.html
for more information.
--->  Computing dependencies for php54-intlError: Unable to execute port:
can't read "build.cmd": Failed to locate 'make' in path:
'/opt/local/bin:/opt/local/sbin:/bin:/sbin:/usr/bin:/usr/sbin'
or at its MacPorts configuration time location, did you move it?` 
```

为什么它不起作用以及如何解决它。我的配置是**MAMP 2.1.4**和**OS X 10.8.3**。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-17T13:29:18.350

您需要在 XCode 中安装 XCode 和命令行工具才能使 MacPorts 运行。

这也被列为[MacPorts 安装页面](http://www.macports.org/install.php#requirements)的要求之一。

# qt - 无法从定义的线程发射到主 UI 线程

> ID：16120615
> 
> 赞同：0
> 
> 时间：2013-04-20T12:54:40.393
> 
> 标签：qt, qt4

我的程序内的自定义线程中包含的发出不起作用。看来我的线程与主 UI 线程没有通信。在 c# 中，我们有线程调度程序来处理这个问题。QT呢？

这在线程内运行：

```
void myThread::run(){

    while(1)
    {
        //do something
        emit display("show the result");  //NOT WORKING, THOUGH CONNECTED
    }
} 
```

我的线程 xx; xx.start();

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-29T17:56:47.717

那是因为您似乎使用 QThread 错误。QThread 有一个事件循环，在您的情况下，该事件循环在您的 run() 函数中被阻止。

相反，您应该做的是实现一个 QObject，在其中放置要运行的代码，然后创建一个 vanilla QThread 并使用 QObject::moveToThread() 将您的 QObject 移动到该线程。这样就可以正常收发信号了，因为QThread的事件循环没有被阻塞。

请参阅：[https ://stackoverflow.com/a/13142366/856199](https://stackoverflow.com/a/13142366/856199)

# python-2.7 - 在 OS X 上拒绝 Python CGIHTTPServer 访问

> ID：16120621
> 
> 赞同：5
> 
> 时间：2013-04-20T12:55:16.913
> 
> 标签：python-2.7, permissions, osx-mountain-lion, cgihttpserver

尝试从浏览器触发 CGI 中的 Python 脚本时出现此错误；

```
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/CGIHTTPServer.py", line 251, in run_cgi
    os.execve(scriptfile, args, env)
OSError: [Errno 13] Permission denied
1.0.0.127.in-addr.arpa - - [20/Apr/2013 14:51:16] CGI script exit status 0x7f00 
```

我没有以 root ( `$ python-32 main.py`) 身份运行主进程。

[这个话题](https://stackoverflow.com/questions/11021369/python-cgihttpserver-crashes-with-oserror-errno-13-permission-denied)似乎对我不起作用。

使脚本可执行也不起作用（`$ chmod +x index.py`，`-rwxr-xr-x`）。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-20T13:08:55.217

终于让它工作了。这是基本脚本；

**索引.py**

```
#!/usr/bin/env python
import cgi
print 'Content-Type: text/html\n\n'
print ''
print 'test' 
```

**要求**

*   该文件需要是可执行的；`$ chmod +x index.py`
*   该文件需要有`#!/usr/bin/env python`

希望它可以帮助将来的人。

# linux - 如果没有传递参数，如何显示帮助文本

> ID：16120622
> 
> 赞同：8
> 
> 时间：2013-04-20T12:55:20.493
> 
> 标签：linux, bash

我最近一直在使用 getopts 并且我已经设置了所有内容。不过我有问题。我希望它能够工作，这样如果有人没有在命令行上输入参数，他们就会得到帮助文本，例如：

```
$ ./script
$ help: xyz - argument must be used. 
```

这就是我目前所拥有的。

```
#!/bin/bash

function helptext {
    # ...
}

function mitlicense {
    # ...
}

while getopts "hl" opt; do
  case $opt in
    h) helptext >&2
      exit 1
    ;;
    l) mitlicense >&2
      exit 0
    ;;
    \?) echo "Invalid option: -$OPTARG" >&2
      exit 1
    ;;
    :) echo "Option -$OPTARG requires an argument." >&2
      exit 1
    ;;
    *) helptext >&2
      exit 1
    ;;
  esac
done 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-20T13:00:09.353

使用 if 测试验证用户输入，如下所示。

如果 -z 后面的字符串的长度为零，则该`-z`选项返回 true。`test`

```
 if [ -z "$1" ]
 then
  helptext
  exit 1
 fi 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-20T12:57:35.717

尝试在您的脚本中使用它：

```
#!/bin/bash

[[ $@ ]] || { helptext; exit 1; }

# --- the rest of the script --- 
```

这行代码是布尔缩短的版本

```
if [[ $@ ]]; then
    true
else
    helptext
    exit 1
fi 
```

`$@`是脚本的所有参数

```
[[ $var ]] 
```

是的简写

```
[[ -n $var ]] 
```

请参阅[http://mywiki.wooledge.org/BashGuide/TestsAndConditionals](http://mywiki.wooledge.org/BashGuide/TestsAndConditionals)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-04-20T13:33:37.677

[Gilles Quenot 的回答](https://stackoverflow.com/users/465183/gilles-quenot)效果很好而且非常简洁；如果您正在寻找*更明确地表达意图*的解决方案，您可以尝试这些基于参数*计数*`$#`的解决方案：

```
[[ $# -gt 0 ]] || { helptext; exit 1; } 
```

或者，使用算术表达式：

```
(( $# > 0 )) ||  { helptext; exit 1; } 
```

最后，依赖于 0 评估为 false 和任何非零数为 true 的简写：

```
(( $# )) || { helptext; exit 1; } 
```

[William Pursell](https://stackoverflow.com/users/140750/william-pursell)提供了另一种变体，它既具有描述性又符合 POSIX：

```
test $# -gt 0 || { helptext; exit 1; } 
```

^(`test`/`[ ... ]`是 POSIX 实用程序/内置的，而类似的`[[ ... ]]`条件是`bash`- 特定的（as is `(( ... ))`）。
然而，一般来说，`bash`'`[[ ... ]]`提供更多的功能并且比`test`/更少的惊喜`[...]`。)

# html - 从返回的哈希中提取 .name

> ID：16120624
> 
> 赞同：0
> 
> 时间：2013-04-20T12:55:23.643
> 
> 标签：html, ruby-on-rails, ruby

我认为这可能比我做的更简单......

我目前在我的控制器（用户）中有这个

```
 def portfolios
    @title = "Portfolios"
    @user = User.find_by_permalink(params[:id])
    @portfolios = @user.portfolios
    @collections = @user.collections.find_all_by_portfolio_id(1)
    @collections = User.find_by_permalink(params[:id])
    render 'show_portfolios'
  end 
```

在我看来，这是：

```
 <% @portfolios.each do |portfolio| %>
    <tr>
      <td><%= image_tag("portfolioIcon.png", alt: "Portfolio Logo")%></td>
      <td><%= portfolio.name %></td><br/>
    </tr>

    <tr>
      <% (1..@user.collections.find_all_by_portfolio_id(portfolio).length).each do |collection| %>
        <td><%= @user.collections.find_all_by_portfolio_id(portfolio) %></td><br/>
      <% end %>
    </tr>
  <% end %> 
```

但它看起来返回一个位于方括号中的哈希：

```
[#<Collection id: 1, user_id: 1, portfolio_id: 1, name: "User-1-Portfolio-1-Collection-1", created_at: "2013-04-20 10:45:46", updated_at: "2013-04-20 10:45:46">] 
```

所以我不能只将 .name 放在它的末尾以返回“User-1-Portfolio-1-Collection-1”。

数据库的设置是这样的： 一个用户有许多投资组合和许多收藏。一个投资组合属于用户，通过一个连接表有很多收藏 一个收藏属于用户，通过一个连接表有很多投资组合

希望这是有道理的。

也许有一种更简单的方法可以在普通哈希中提取我所追求的信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T14:54:49.247

小心你的代码：

```
@collections = @user.collections.find_all_by_portfolio_id(1)
@collections = User.find_by_permalink(params[:id])

```

你在你的第一组返回值上`@collections`加上它后面的行。如果这些行之一应该分配给不同的实例变量，那么您正在浪费各种 CPU 周期并且有一个潜在的错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T13:24:26.917

如果portfolio 的值是`[#<Collection id: 1, user_id: 1, portfolio_id: 1, name: "User-1-Portfolio-1-Collection-1", created_at: "2013-04-20 10:45:46", updated_at: "2013-04-20 10:45:46">]`并且您希望访问它所拥有的Active Record 对象的名称，那么您必须这样做，`portfolio.first.name`因为portfolio 变量`array`在您的情况下是一个而不是Active Record 对象。

这样做`portfolio.first`将为您提供该数组中的第一个活动记录。

希望有帮助。

# cakephp - PDF在mac中保存时获得.html文件扩展名

> ID：16120627
> 
> 赞同：0
> 
> 时间：2013-04-20T12:56:10.807
> 
> 标签：cakephp, tcpdf

我有一个 CakePHP 应用程序，我在其中使用 tcpdf 生成我的 PDF，但是每当将 pdf 保存到 mac 计算机中时，它都会获得一个 .html 扩展名，并且在删除扩展名之前无法打开。但它只发生在mac上，如果我在windows上使用safari，文件会以.pdf格式下载。

任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T13:15:30.187

您是否尝试将 mime 类型设置为“application/pdf”？如果您不这样做，您的 mac 可能会添加扩展名，因为 mime 类型可能是“text/html”，而它没有与该类型匹配的扩展名。为什么 Windows 上的 safari 不这样做，我不确定。

# namespaces - 带限定符的命名空间是多余的

> ID：16120628
> 
> 赞同：2
> 
> 时间：2013-04-20T12:56:22.903
> 
> 标签：namespaces, resharper

我曾经在命名空间之外使用完全限定的命名空间，如下所示。

```
using D.E.F
namespace A.B.C
{ 
```

我最近开始使用 ReSharper，我注意到一条消息*Qualifier 是多余*的，对应于限定符**D**。结果我可以使用命名空间

```
namespace A.B.C
{
using E.F 
```

请注意，我没有在命名空间内使用**使用 DEF**。

这是 Resharper 试图报告的 Visual Studio 2012 中的新功能吗？我仍然不明白编译器如何理解真正的命名空间是**DEF**而不是**EF**？

# sockets - 如何在用户输入消息时接收其他用户的消息？

> ID：16120629
> 
> 赞同：0
> 
> 时间：2013-04-20T12:56:25.733
> 
> 标签：sockets

我需要使用 C++ 构建一个聊天室，它将在命令提示符下运行。如何将屏幕分成两部分，以便在用户输入消息时接收其他用户的消息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T13:06:16.683

一些指针：您可以使用`ncurses`：

1.  使用`getmaxx(stdscr)`and`getmaxy(stdscr)`发现终端的宽度和高度（宽度是列数，高度是行数）。
2.  用于`newwin(lines/2, cols, 0, 0);`放置上部窗口。然后再次使用它在下方放置第二个窗口（但这次将第一个零更改为`lines/2`.

如需完整文档，[请访问此处](http://invisible-island.net/ncurses/man/ncurses.3x.html)。

请注意，ncurses 是一个 C 库。

# image - j2me如何压缩图片

> ID：16120632
> 
> 赞同：2
> 
> 时间：2013-04-20T12:57:19.717
> 
> 标签：image, java-me

我正在制作一个 j2me 应用程序。在这个应用程序中，我想上传超过 1 MB 的图像。但是由于大多数手机的堆大小分配限制为 1 MB，所以当我尝试创建超过 1 MB 大小的图像输入流时，它会引发**OutOfMemory**异常。那么我如何在 j2me 应用程序中压缩图像以将其上传到服务器上。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T17:48:38.247

不要一次加载所有的图片，一张一张的上传图片，清除之前的图片会释放内存，调整图片大小会减小图片的大小。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T09:46:31.673

**您可以使用scale()**方法根据屏幕大小调整图像大小。如果您希望图像适合手机屏幕尺寸，请使用 Displayable.getWidth 和 getheight 方法。将它们作为 Scale(w,h) 传递给 Scale 方法，并在 Image 变量上调用 scale。大多数情况下，它会减小堆可以处理的图像大小。如果还高，则将图片分割成小字节再上传

# android - Android Manifest.xml 已损坏

> ID：16120633
> 
> 赞同：0
> 
> 时间：2013-04-20T12:57:21.320
> 
> 标签：android, debugging, android-manifest, corruption, parsing-error

我在最近的三个项目中遇到了无法调试的问题。在每个项目中创建每两三个活动后我得到的相同错误是：-

```
Parser Exception :  The markup in the document preceding the root element must be well formed. 
```

此错误出现在 AndroidManifest.xml 文件中。

为此，我正在使用 Google 提供的 ADT Eclipse。

这个错误是可调试的，还是我必须删除项目并重新开始，直到错误再次出现？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T13:40:58.667

```
package="com.example.sqlitenew"

android:versionCode="1"

android:versionName="1.0" >

<uses-sdk

    android:minSdkVersion="8"

    android:targetSdkVersion="17" />

<application

    android:allowBackup="true"

    android:icon="@drawable/ic_launcher"

    android:label="@string/app_name"

    android:theme="@style/AppTheme" >

    <activity

        android:name="com.example.sqlitenew.MainActivity"

        android:label="@string/app_name" >

        <intent-filter>

            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />

        </intent-filter>

    </activity>

</application> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T13:00:37.233

XML 中的每个标签都必须在根标签内，并且所有标签都必须完美关闭。否则会抛出错误：错误**解析器异常：根元素之前的文档中的标记必须格式**正确，表明根标记内的元素未正确关闭。

您的 XML 应采用以下格式

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.test"
    android:versionCode="1"
    android:versionName="1.0" >
    <application>
        <!-- activities declaration -->
    </application>
</manifest> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T14:17:30.027

您是否在两个操作系统之间交换项目文件？当我在 linux 和我的项目合作伙伴在 windows 上工作时，我也遇到了同样的错误。尝试`ctrl+shift+F`在 XML 文件中做。它对我有用。

# php - mysql_insert_id() 总是返回 0

> ID：16120641
> 
> 赞同：1
> 
> 时间：2013-04-20T12:58:23.487
> 
> 标签：php, mysql

我搜索了 4 个小时，但仍然找不到正确的答案，为什么这个函数返回 0。它昨天工作，但现在我对脚本做了一些更改（很多东西已经改变）......我知道有很多像我这样的话题，但我不能找到正确的答案。

我的 index.php 上有 4 个文本输入。我用我的 update.php 文件（POST 方法）捕获它们。

这是一块update.php

```
<?php
include "db.php";
connect_to_db();

require_once('recaptchalib.php');
$privatekey = "N/A";
$resp = recaptcha_check_answer ($privatekey,$_SERVER["REMOTE_ADDR"],$_POST["recaptcha_challenge_field"],$_POST["recaptcha_response_field"]);

if (!$resp->is_valid) {
    echo 'Tekst sa slike je pogresno prepisan. Vracamo Vas natrag.';
    echo '<meta http-equiv="refresh" content="5; URL=../">';

} else {
    $pic1 = $_POST["pic1"];
    $p1 = htmlspecialchars($pic1);
    $pic2 = $_POST["pic2"];
    $p2 = htmlspecialchars($pic2);
    $html = $_POST["html"];
    $h = htmlspecialchars($html);
    $link = $_POST["link"];
    $l = htmlspecialchars($link);

    $id = mysql_insert_id();

    $query = "INSERT INTO `koraci` (`id`, `p1`, `p2`, `h`, `l`) VALUES ({$id}, '{$p1}', '{$p2}','{$h}','{$l}')";
    $result = mysql_query($query) or die(mysql_error());
}

include_once("config.php");
?>
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=Windows-1250" />
<link rel="stylesheet" type="text/css" href="style.css" />
<title><?php echo $title; ?></title>
<script type="text/javascript" src="cufon-yui.js"></script>
<script type="text/javascript"  src="font.js"></script>
<script type="text/javascript">
    Cufon.set('fontSize', '20px').replace('body');
</script>
</head>

<body>
<?php include_once("analytics.php"); ?>
<h1><?php echo $title; ?></h1>
<br />
<textarea name="one"><center><img src="<?php echo $p1; ?>" id="Like"></center></textarea>
<br />
<textarea name="two"><iframe width=800 height=500 frameborder=0 src="<?php echo $id; ?>"></iframe></textarea>
<br />
</body>
</html> 
```

在我的 db.php 中是：

```
<?php
define("DB_SERVER", "N/A");
define("DB_USER", "N/A");
define("DB_PASS", "N/A");
define("DB_NAME", "N/A");

function connect_to_db() {
    $connection = mysql_connect(DB_SERVER, DB_USER, DB_PASS) or die("There was an error connecting to the database: " . mysql_error());
    mysql_select_db(DB_NAME);
    mysql_query("SET character_set_results = 'utf8', character_set_client = 'utf8', character_set_connection = 'utf8', character_set_database = 'utf8', character_set_server = 'utf8'");
    return $connection;
}
?> 
```

N/A 表示我不会分享这些细节。

我的 db.sql：

```
SET SQL_MODE="NO_AUTO_VALUE_ON_ZERO";
SET time_zone = "+01:00";

CREATE TABLE IF NOT EXISTS `koraci` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `p1` varchar(255) NOT NULL,
  `p2` varchar(255) NOT NULL,
  `h` varchar(255) NOT NULL,
  `l` varchar(255) NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=MyISAM  DEFAULT CHARSET=latin1 AUTO_INCREMENT=2 ;

INSERT INTO `koraci` (`id`, `p1`, `p2`, `h`, `l`) VALUES
(1, 'SOMETHING', 'SOMETHING', 'SOMETHING', 'SOMETHING'); 
```

所以基本上，它将所有内容发送到 db（我可以用我的 phpMyAdmin 看到）。

问题是，它总是返回 0 作为我回显的 id！

它没有显示任何错误（PHP 或 MySQL）。

[15:41] 我已将 update.php 更新为：

```
 if (!$resp->is_valid) {
    echo 'Tekst sa slike je pogresno prepisan. Vracamo Vas natrag.';
    echo '<meta http-equiv="refresh" content="5; URL=../">';

} else {
    $pic1 = $_POST["pic1"];
    $p1 = htmlspecialchars($pic1);
    $pic2 = $_POST["pic2"];
    $p2 = htmlspecialchars($pic2);
    $html = $_POST["html"];
    $h = htmlspecialchars($html);
    $link = $_POST["link"];
    $l = htmlspecialchars($link);

    $query = "INSERT INTO `koraci` (`id`, `p1`, `p2`, `h`, `l`) VALUES ({$id}, '{$p1}', '{$p2}','{$h}','{$l}')";
    $result = mysql_query($query) or die(mysql_error());

    $id = mysql_insert_id();
}
?> 
```

现在我遇到了这个错误：“您的 SQL 语法有错误；请查看与您的 MySQL 服务器版本相对应的手册，以了解在附近使用的正确语法”

[16:04] 如果我在查询后设置它，我可以看到查询中不包含 id。我说的是这个：

```
INSERT INTO `koraci` (`id`, `p1`, `p2`, `h`, `l`) VALUES (, 'SOMETHING', 'SOMETHING','SOMETHING','SOMETHING') 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-20T13:01:06.667

`mysql_insert_id`之后做`mysql_query`。

[请查看此处](http://php.net/manual/en/function.mysql-insert-id.php)的文档，并尝试不再使用这些`mysql*`功能，如红框中所述。这些功能存在安全问题。

> `mysql_insert_id`：检索前一个查询（通常是 INSERT）为 AUTO_INCREMENT 列生成的 ID。

在您的代码中，当您这样做时`mysql_insert_id`，没有插入。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-26T07:32:13.840

在我的情况下，我也有`AUTO_INCREMENT`，但我仍然总是得到 0。

我发现的**核心原因是用于 DB 连接的代码**。以前我使用的是导致返回 0 的代码

```
// THIS CODE RETURNS ALWAYS "0"
$con = @mysql_connect($mysql_db_hostname, $mysql_db_user, $mysql_db_password, $mysql_db_database);    
if (!$con) {
   echo "Failed to connect to MySQL: " . mysqli_connect_error();
} 
```

这是我使用的正确代码，它开始运行良好。

```
// THIS CODE RETURNS CORRECT VALUE OF LAST INSERTED ROW
$link = mysql_connect('localhost', 'root', '');
if (!$link) {
    die('Could not connect: ' . mysql_error());
}
mysql_select_db('openfire'); 
```

# spring - Spring 安全默认目标 url

> ID：16120642
> 
> 赞同：1
> 
> 时间：2013-04-20T12:58:26.563
> 
> 标签：spring, spring-security

我想在用户成功通过 Spring Security 身份验证时重新加载当前页面。default-target-url 应该是什么，还是我必须创建自定义身份验证入口点类？一些示例代码将非常有帮助。

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T15:54:00.373

这对我有用：

`<security:form-login login-page="/login.htm" default-target-url="/home.htm"/>`

login.htm 是我的应用程序对登录页面的映射，而 home.htm 是默认帐户主页，如果用户直接点击 login.htm url，则会显示给用户。

如果用户点击了除 login.htm 或 home.htm 之外的任何 url，需要用户登录，Spring security 会显示登录页面，登录后，用户会被带到最初请求的 url。你不必做任何特别的事情。

作为附加检查，请确保您`always-use-default-target="true"`在配置中没有，这将强制 Spring Security 在登录后始终显示默认目标 url。

希望这可以帮助。

# visual-studio-2012 - VS2012 生产力电动工具固定选项卡在运行时关闭

> ID：16120643
> 
> 赞同：7
> 
> 时间：2013-04-20T12:58:33.160
> 
> 标签：visual-studio-2012, productivity-power-tools

如果我打开一个保存的项目，其中包含从上次会话恢复的固定选项卡，那么当我下次运行我的解决方案时，固定选项卡将变为未固定。有没有办法关闭这种行为？我固定它们是有原因的，随着解决方案的增长，它变得非常令人沮丧。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-05-13T08:14:46.177

[我有同样的问题并在这里](http://social.msdn.microsoft.com/Forums/en-US/visualstudiogeneral/thread/34242a45-1758-4fb7-aa94-16ed1f539d7d/)找到了答案

转到`Tools -> Options -> Environment -> Tabs and Windows`并确保选中“如果文档从井中移除，则保持引脚状态”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-11-09T12:57:40.287

接受的答案在以前的版本中为我解决了这个问题，但在 VS2017 中，还要确保您没有启用“轻量级解决方案负载”。

要禁用，请右键单击解决方案资源管理器中的解决方案，然后选择“禁用轻量级解决方案加载”（如果可用）（可能在菜单底部）。

我的猜测是在 VS 启动期间尝试恢复 pin 选项卡时，如果项目尚未加载，则无法固定它们。

# javascript - 如何将值从一个 html 页面传递到 PHONEGAP 中的另一个 html 页面？

> ID：16120644
> 
> 赞同：1
> 
> 时间：2013-04-20T12:58:57.623
> 
> 标签：javascript, android, html, cordova, parameter-passing

我已经搜索了这个答案，我得到了 2 种回复，我发现我可以实现它。

他们是..

```
window.location.href=href='2ndpage.html?var id=results.rows.item(1).id'; 
```

*results.rows.item(1).id-**这是我从数据库中获取的值——它将是数据库中元素的 id 值。**

为了获得价值，我实现了这段代码..

```
 function onDeviceReady() 
    {var db =  window.sqlitePlugin.openDatabase("Database", "1.0", "Database",1000000); 
     console.log("processing onDeviceReady");
     db.transaction(getParameter,queryDB,errorCB);  
    }           

    function getParameter(paramName) 
    {   console.log("processsinggg parameter loop ");
    var searchString = window.location.search.substring(1),
        i, val, params = searchString.split("&");

         for (i=0;i<params.length;i++) {
                val = params[i].split("=");
            if (val[0] == paramName) {
            return unescape(val[1]);
        }
    console.log("valueeesss: "+val[1]);

  }return null;
} 
```

**它一直处理到这个循环并停止......认为我没有调用其他函数......我调用了queryDB（）；**

当它在代码中处理 queryDB

```
function queryDB(tx) 
{       tx.executeSql('SELECT * FROM table_name', [], querySuccess, errorCB);
        console.log("processing queryDB");
} 
```

它说因为 tx 没有定义..而它只是一个参数

我尝试打印输出...o/p 是..

```
results.rows.item(1).id 
```

我发现很难实现它......**可能也是因为我的错误......但是......**

我尝试的另一种方法是**FORM 方法**

```
<form name="2ndpart"  method="post">
id: <input type="hidden" name="id">
<input type="submit" value="results.rows.item(0).id">
</form> 
```

在第二页，我给了

```
function getUrlVars() {
var vars = {};
var parts = window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(m,key,value) {
    vars[key] = value;
});
return vars; 
```

}

它没有进入第二页它自己..因为它说不是一个功能。

哪种方法正确且最容易实施？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-24T06:02:47.470

这就是我们在 PHONEGAP 中将值从一个 html 传递到另一个 html 页面的方式

```
 function test()
        {
            window.location.href="index.html?var id=1";
        }

        <div id="test"><img src="img/test.png" onClick="test()"/></div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-24T14:56:25.853

除了 URL 参数，您还可以设置 localStorage、sessionStorage 或 cookie。在单页应用程序中，您可以只设置一些变量。

# c# - c#如何通过类返回返回一个列表？

> ID：16120649
> 
> 赞同：0
> 
> 时间：2013-04-20T12:59:10.430
> 
> 标签：c#, forms, list, return

我在一个班级中有一个列表，我试图返回以查看表单，但我无法从班级返回，我该怎么做？

在课堂上：

```
private List<Module> modules;

public void AddModule(Module add)
{
    modules.Add(add);
}

public List Modules
{
    get { return modules; }
} 
```

在表格上：

```
moduleTitleLabel.Text = cnet.Title;

stgOne.AddModule(cnet);

moduleList.DataSource = stgOne.Modules; 
```

我在退货时的列表上出现错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T13:00:29.087

您的数据类型不同：

```
private List<Module> modules;

public void AddModule(Module add)
{
    modules.Add(add);
}

// this one should be generic too
public List<Module> Modules
{
    get { return modules; }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T13:00:01.513

您缺少泛型类型参数，它应该是：

```
public List<Module> Modules
{
    get { return modules; }
} 
```

# jsf - 将大型 javaee jsf 应用程序部署为 portlet 的最佳方式

> ID：16120651
> 
> 赞同：2
> 
> 时间：2013-04-20T12:59:18.443
> 
> 标签：jsf, jakarta-ee, liferay, portlet

我正在使用 liferay 和 glassfish 应用程序服务器将我的 javaee jsf 应用程序部署为 portlet
如果有一个大约 5 mb 的小应用程序，则部署几乎是好的，这需要 10 秒来构建 war 文件和 10 秒来部署 war 文件
我问题是我有一个大约 100 mb 的大型应用程序，构建战争文件需要 40 秒，部署战争文件至少需要 2 分钟，以便
在我的应用程序中进行更改，并且在每次更改时部署我的应用程序以查看结果和测试我做了什么，等待很长时间很烦人和无聊

任何建议以更好的时间部署或测试更改

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-26T13:40:42.217

通常，如果您的 portlet 的大小往往如此之大，那将是一种难闻的气味。如果您已经有一个 Web 应用程序，为什么还要构建一个单一的 portlet？我的建议：

*   创建一个轻量级的 portlet，作为现有应用程序的前端，如果您愿意，可以作为最终用户的接口。这样，您的 Web 应用程序可以保持原样，在后端完成真正的工作。
*   是否可以将 Web 应用程序拆分为其功能部分？例如，一个搜索屏幕、一个过滤器、一个详细视图……如果是这样的话，可能会将您的应用程序拆分为多个 portlet，一起工作以完成工作。这样，您可以增加在页面上移动 portlet 的灵活性。

如果您别无选择，只能将 Web 应用程序作为一个整体进行部署，请确保应用程序的不同部分具有足够的模块化程度，可以单独进行测试（请参阅 Mark Chorley 的评论）。

# r - ar项目的文件和目录结构

> ID：16120652
> 
> 赞同：5
> 
> 时间：2013-04-20T12:59:33.980
> 
> 标签：r, class, pseudocode

在像 java 这样的通用编程语言中，每个文件通常对应一个类。

我刚开始使用 R。我想构建一个小程序，我想创建一个像这样的特定文件和目录结构

> ```
> Main.R # the main control script 
> MyClass.R # A class that is referenced from within Main.R 
> ProcessData.R # Another class that uses an object of MyClass.R as input 
> ```

所以我想做这样的事情（伪代码）：

Main.R

> ```
> myc <- new MyClass # create a new instance of MyClass from within Main.R
> pd <- new ProcessData 
> pd$processMyClass( myc ) # call a method in ProcessData that processes the myc object in some way 
> ```

所以这是相当抽象的，但我只是想知道这在 R 中是否原则上可行。

更新：我需要更具体。因此问题是：您如何通过保持与以下玩具程序相同数量的文件和结构将以下 java 程序转换为 R 程序？

主.java：

```
public static void main( String[] args ) {
    MyClass myc = new MyClass("SampleWord");
    ProcessData pd = new ProcessData();
    pd.processData( myc );
} 
```

MyClass.java

```
class MyClass {

    public String word;

    public MyClass( String word ) {
        this.word = word;
    }
} 
```

过程数据.java

```
class ProcessData.java {

    public void processData( MyClass myc ) {
        System.out.println( "pd.processData = " + myc.word );
    }

} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-20T13:54:12.370

# 班级制度

查看 R、S3、S4 和 Reference 类中的三个类系统。

```
## S3 methods, Section 5 of
RShowDoc("R-lang")

## S4 classes
?Classes
?Methods

## Reference classes
?ReferenceClasses 
```

具有 Java 背景的您会很想使用引用类，但它们具有“引用语义”和远距离操作（更改一个对象会更改另一个引用相同数据的对象），而大多数 R 用户希望“更改时复制” ' 语义。一个人可以在 S3 课程上取得很大进步，但在我看来，更严格的方法会采用 S4。S4 的特性会让你大吃一惊，部分原因是类系统更接近于普通的 lisp 对象系统而不是 java。

还有[其他意见和选择](https://stackoverflow.com/questions/3602154/when-does-it-pay-off-to-use-s4-methods-in-r-programming)。

# 基本实现

我不太确定您使用“ProcessData”的设计目标是什么；我会将您的两个类实现为一个类、一个泛型和一个在 MyClass 类上运行的泛型方法。

```
## definition and 'low-level' constructor
.MyClass <- setClass("MyClass", representation(word="character"))

## definition of a generic
setGeneric("processData", function(x, ...) standardGeneric("processData"))

setMethod("processData", "MyClass", function(x, ...) {
    cat("processData(MyClass) =", x@word, "\n")
}) 
```

这是完整且功能齐全的

```
> myClass <- .MyClass(word="hello world")
> processData(myClass)
processData(MyClass) = hello world 
```

这三个代码行可能放在两个文件中，“AllGenerics.R”和“MyClass.R”（包括方法）或三个文件“AllGenerics.R”、“AllClasses.R”、“processData-methods.R”（请注意，方法与泛型相关联，并在类上分派）。

# 附加实施

通常会添加一个对用户更友好的构造函数，例如，向用户提供有关预期数据类型的提示或执行复杂的参数初始化步骤

```
MyClass <- function(word=character(), ...)
{
    .MyClass(word=word, ...)
} 
```

通常，人们想要一个插槽访问器，而不是直接插槽访问。这可以是一个简单的函数（如图所示）或一个通用的 + 方法。

```
word <- function(x, ...) x@word 
```

如果要更新槽，则编写替换函数或方法。函数或方法通常具有三个参数，要更新的对象、可能的附加参数以及更新对象的值。这是一个通用的+方法实现

```
setGeneric("word<-", function(x, ..., value) standardGeneric("word<-"))

setReplaceMethod("word", c("MyClass", "character"), function(x, ..., value) {
    ## note double dispatch on x=MyClass, value=character
    x@word <- value
    x
}) 
```

一个有点棘手的替代实现是

```
setReplaceMethod("word", c("MyClass", "character"), function(x, ..., value) {
    initialize(x, word=value)
}) 
```

它使用`initialize`泛型和默认方法作为复制构造函数；如果同时更新多个插槽，这可能会很有效。

因为用户可以看到该类，所以希望使用“show”方法以用户友好的方式显示它，为此`getGeneric("show")`已经存在泛型 ( )

```
setMethod("show", "MyClass", function(object) {
    cat("class:", class(object), "\n")
    cat("word:", word(object), "\n")
}) 
```

现在我们的用户会话看起来像

```
> myClass
class: MyClass 
word: hello world 
> word(myClass)
[1] "hello world"
> word(myClass) <- "goodbye world"
> processData(myClass)
processData(MyClass) = goodbye world 
```

# 效率

R 在向量上有效地工作；S4课程也不例外。所以设计是一个类的每个槽代表一个跨越多行的列，而不是单行的元素。我们期望 slot 'word' 通常包含一个长度远大于 1 的向量，并且操作要作用于向量的所有元素。因此，人们会考虑到这一点来编写方法，例如，将 show 方法修改为

```
setMethod("show", "MyClass", function(object) {
    cat("class:", class(object), "\n")
    cat("word() length:", length(word(object)), "\n")
}) 
```

这是更大的数据对象（使用我的 Linux 系统上的文件）

```
> amer <- MyClass(readLines("/usr/share/dict/american-english"))
> brit <- MyClass(readLines("/usr/share/dict/british-english"))
> amer
class: MyClass 
word() length: 99171 
> brit
class: MyClass 
word() length: 99156 
> sum(word(amer) %in% word(brit))
[1] 97423
> amer_uc <- amer  ## no copy, but marked to be copied if either changed
> word(amer_uc) <- toupper(word(amer_uc))  ## two distinct objects 
```

所有这些都非常高效。

# 参考类“远距离行动”的危害

让我们回到 S4 类的一个更简单的实现，它具有直接的插槽访问，没有花哨的构造函数。这是美国字典和一个副本，已转换为大写

```
.MyClass <- setClass("MyClass", representation(word="character"))
amer <- .MyClass(word=readLines("/usr/share/dict/american-english"))
amer_uc <- amer
amer_uc@word <- toupper(amer_uc@word) 
```

请注意，我们已经大写`amer_uc`但不是`amer`：

```
> amer@word[99 + 1:10]
 [1] "Adana"      "Adar"       "Adar's"     "Addams"     "Adderley"  
 [6] "Adderley's" "Addie"      "Addie's"    "Addison"    "Adela"     
> amer_uc@word[99 + 1:10]
 [1] "ADANA"      "ADAR"       "ADAR'S"     "ADDAMS"     "ADDERLEY"  
 [6] "ADDERLEY'S" "ADDIE"      "ADDIE'S"    "ADDISON"    "ADELA" 
```

这确实是 R 用户所期待的——我创建了一个单独的对象并对其进行了修改；原始对象未修改。这是我的一个断言；也许我不知道 R 用户期望什么。我假设 R 用户并没有真正注意这是一个引用类这一事实，而是认为它只是另一个 R 对象，例如`integer()`向量或 a`data.frame`或`lm()`.

相比之下，这里是一个参考类的最小实现，以及类似的操作

```
.MyRefClass <- setRefClass("MyRefClass", fields = list(word="character"))
amer <- .MyRefClass(word=readLines("/usr/share/dict/american-english"))
amer_uc <- amer
amer_uc$word <- toupper(amer_uc$word) 
```

但是现在我们已经改变了`amer`和`amer_uc`！C 或 Java 程序员完全期望，但 R 用户不期望。

```
> amer$word[99 + 1:10]
 [1] "ADANA"      "ADAR"       "ADAR'S"     "ADDAMS"     "ADDERLEY"  
 [6] "ADDERLEY'S" "ADDIE"      "ADDIE'S"    "ADDISON"    "ADELA"     
> amer_uc$word[99 + 1:10]
 [1] "ADANA"      "ADAR"       "ADAR'S"     "ADDAMS"     "ADDERLEY"  
 [6] "ADDERLEY'S" "ADDIE"      "ADDIE'S"    "ADDISON"    "ADELA" 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-20T14:39:01.170

**参考类**下面我们尝试使用 R 以尽可能接近的方式复制问题中的 java 代码。在这方面，三个内置的 R 类系统（S3、S4、参考类）参考类似乎最接近这种风格。Reference Classes 是最新添加到 R 中的类系统，它的迅速普及可能是由于熟悉这种风格的 Java 程序员来到 R 的。

（如果您从中创建一个包，则省略所有源语句。）

Main.R 文件：

```
source("MyClass.R")
source("ProcessData.R")

main <- function() {
    myc <- new("MyClass", word = "SampleWord")
    pd <- new("ProcessData")
    cat("pd$processData =", pd$processData(myc), "\n")
} 
```

MyClass.R 文件：

```
setRefClass("MyClass", 
    fields = list(word = "character")
) 
```

ProcessData.R 文件：

```
setRefClass("ProcessData",
    fields = list(myc = "MyClass"),
    methods = list(
        processData = function(myc) myc$word
    )
) 
```

跑步：

```
source("Main.R")
main() 
```

**proto 包**[proto 包](http://r-proto.googlecode.com)实现了面向对象编程 的原型模型，它起源于 Self 编程语言，并在一定程度上存在于 javascript、Lua 中，尤其是[io 语言](http://iolanguage.org)的基础。[proto 可以很容易地模仿这种风格（如proto vignette](http://cran.r-project.org/web/packages/proto/index.html)的 Traits 部分中所讨论的）：

Main.R 文件：

```
source("MyClass.R")
source("ProcessData.R")  

library(proto)

main <- function() {
    myc <- MyClass$new("SampleWord")
    pd <- ProcessData$new()
    cat("pd$processData =", pd$processData(myc), "\n")
} 
```

MyClass.R 文件：

```
MyClass <- proto(
    new = function(., word) proto(word = word)
) 
```

ProcessData.R 文件：

```
ProcessData <- proto(
    new = function(.) proto(.), 
    processData = function(., myc) myc$word
) 
```

跑步：

```
source("Main.R")
main() 
```

更新：添加了原型示例。

更新 2：改进`main`并`MyClass`在参考类示例中。

# android - 将样式应用于 FrameLayout

> ID：16120654
> 
> 赞同：1
> 
> 时间：2013-04-20T12:59:52.450
> 
> 标签：android, android-listview, styles

我想要每个 ListView 行，有一个边框我在 drawable 文件夹中有一个 LayerList，名称是“border.xml”：

```
<layer-list xmlns:android="http://schemas.android.com/apk/res/android" >
    <item>
        <shape>
            <padding
                android:bottom="2dp"
                android:left="2dp"
                android:right="2dp"
                android:top="2dp" />

            <solid android:color="@color/azulViewPager" />
        </shape>
    </item>
    <item>
        <shape android:shape="rectangle" >
            <solid android:color="@color/grisFondoCuadros" />
        </shape>
    </item>

</layer-list> 
```

我想将此LayerList（如样式）应用于FrameLayout。我按以下方式进行。在名为 styles.xml 的文件中：

```
 <!-- Styles Shadows -->
    <style name="row_border" parent="@android:style/Theme">
        <item name="android:windowBackground">@drawable/border</item>
    </style> 
```

在 listview 行的 xml 中：

```
<FrameLayout
    style="@style/row_border"
    android:layout_width="match_parent"
    android:layout_height="wrap_content" > 
```

我的问题是 ListView 看起来和工作得很好，但从未应用过样式。我测试了很多选项，但没有成功

我很感激任何帮助

问候

# php - 如何更改配置以显示 php 页面？

> ID：16120658
> 
> 赞同：0
> 
> 时间：2013-04-20T13:00:04.217
> 
> 标签：php, apache

我在文件中有以下简单的 HTML/PHP 代码`example.php`

```
<html>
<head><title>PHP Example test page</title></head>

<body>

<h4>PHP Example</h4>

<?php
/* Display a text message */
echo “Hello, world! This is my first PHP program.”;
?>

</body>
</html> 
```

但是尝试打开此页面时浏览器是空的！httpd 正在运行并显示一个简单的 html 页面。我在文件中添加了以下两行`etc/httpd/conf/httpd.conf`：

```
LoadModule php5_module modules/libphp5.so
AddType application/x-httpd-php        php php5 
```

`php`在命令行上显示其版本 5.3.3。知道这次什么配置不正确吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T13:02:48.337

从外观上看，您已经复制粘贴了非标准的引号。尝试手动重新输入 " 字符。

# c++ - C unsigned char 算术运算不能按预期工作

> ID：16120661
> 
> 赞同：-2
> 
> 时间：2013-04-20T13:00:28.563
> 
> 标签：c++, type-conversion, arithmetic-expressions

这是我的代码片段；

```
Npp8u * imageHost;  
typedef unsigned char Npp8u;
...
for (int i=0;i<nHeight;++i)
    {
        for (int j=0;j<nWidth;++j)
        {
            printf("number_befre : %u\n",imageHost[i*nWidth+j] );
            imageHost[i*nWidth+j] = imageHost[i*nWidth+j]-Npp8u(min);
            imageHost[i*nWidth+j] = imageHost[i*nWidth+j]/(max-min);
            printf("number : %u\n",imageHost[i*nWidth+j] );
        }
    }
... 
```

一些值被分配给imageHost`max = 202`并`min = 0`从中提取。我通过调试对其进行了纠正，但`imageHost`整个元素的内容为 0。我还能做些什么来使这些陈述以合理的精度发挥作用？这是关于我使用的数据类型的限制吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T13:26:17.770

您正在尝试将数字标准化为 0.0 到 1.0 之间。但是您选择的数据类型不适合，因为它只能处理整数。你需要这样的代码

```
typedef unsigned char Npp8u;
Npp8u * imageHost = ...;
vector<float> normalizedImageHost(nHeight*nWidth)
...
for (int i=0;i<nHeight;++i)
{
    for (int j=0;j<nWidth;++j)
    {
        normalizedImageHost[i*nWidth+j] = (float)(imageHost[i*nWidth+j] - min)/
            (max - min);
    }
} 
```

另一种选择是保留`Npp8u`但使用比例因子。例如，我们可以将所有值乘以最大 Npp8u 值 255。

```
typedef unsigned char Npp8u;
Npp8u * imageHost = ...;
...
for (int i=0;i<nHeight;++i)
{
    for (int j=0;j<nWidth;++j)
    {
        imageHost[i*nWidth+j] = (Npp8u)((255.0*(imageHost[i*nWidth+j] - min))/
            (max - min));
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T13:15:15.370

**IF** `imageHost[i*nWidth+j]`小于`max-min`那时

```
imageHost[i*nWidth+j]/(max-min) 
```

将为零。因为`unsigned char`不能存储真实值之间`[0.0 .. 1.0]`

为了获得更好的准确性，您应该使用浮点运算。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T13:15:46.177

我想你的问题是 imageHost 内存。检查它的内存。（如果可能，发布前几行）或执行此操作并调试第一行变量值的程序（第二行上的断点）：

```
Npp8u  x=Npp8u(min);
imageHost[i*nWidth+j] = imageHost[i*nWidth+j]-x; 
```

你得到 imageHost 的内存（这样做）：

```
Npp8u ** imageHost=new *Npp8u*[nHeight];
for(int i=0;i<nHeight;i++)
     imageHost[i]=new Npp8u[nWidth]; 
```

# maven - Maven 战争构建将一些 jar 文件的旧版本放入生成的 .war 文件中

> ID：16120663
> 
> 赞同：2
> 
> 时间：2013-04-20T13:00:29.177
> 
> 标签：maven, build, war

我正在尝试使用 maven 构建一个（战争）项目，但是当我看到生成的战争文件时，它包含一些在 pom.xml 文件中不存在的旧 jar 文件，并且是其他一些 jar 文件的旧版本。我删除了.m2 文件夹，但问题仍然存在。我是maven的新手，知道吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-21T14:56:52.373

那些旧 jar 可能是[传递依赖](http://maven.apache.org/guides/introduction/introduction-to-dependency-mechanism.html#Transitive_Dependencies)。如果您使用的是 Eclipse，您可以使用 m2e 的 Dependency Graph 功能，否则您可以尝试使用[maven-graph-plugin](http://mvnplugins.fusesource.org/maven/1.4/maven-graph-plugin/index.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-04-07T14:27:03.620

问题是`mvn package`使用 ~/.m2/repository 中的 jar（如果它们存在）。并且复制（安装）仅在您这样做时完成`mvn install`。

# php - 如何临时保存 HTML POST 数据以供以后使用？

> ID：16120673
> 
> 赞同：0
> 
> 时间：2013-04-20T13:01:13.757
> 
> 标签：php, mysql

我将注册表单分为 3 个单独的 php 页面作为第 1 步、第 2 步和第 3 步。我想知道如何临时存储第 1 页和第 2 页的表单数据，直到用户到达第 3 步然后检索并发送数据当用户在完成第 3 个表单后单击第 3 页上的提交时，所有 3 个表单一次一起发送到数据库。

我应该使用 cookie 和/或会话和数据库进行临时存储吗？我看到有人建议使用隐藏的 html 输入，但我不明白。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T13:13:32.617

大多数时候，隐藏输入就可以了。

用法：例如，用户在第 2 步中发布了“name=David”。您的服务器收到了该表单数据，应将此行插入第 3 步：

```
<input type="hidden" name="name" value="David"> 
```

当用户完成第 3 步后，您的服务器将再次收到“name=David”，这样您就可以将所有数据作为一个整体来处理，而无需在服务器上存储任何数据。

如果没有第 3 步，第 1 步和第 2 步中的数据无用，请执行此操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T13:08:21.440

您可以使用 PHP 将输入数据变量存储到会话变量中`$_session`

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-20T13:10:45.543

最好将其保存在会话/cookie 中。请务必在提交后将其删除，否则每次用户访问该页面时，都将填充旧数据。他们所说的隐藏输入的意思是，在每一步，您的页面都将检索从上一页保存的数据，然后将它们隐藏在页面上`<input type="hidden" name="firstname" value="<?= $_POST['firstname']; ?>" />....`

# c# - Visual Basic C# 窗口窗体后台工作对象移动循环未按预期运行

> ID：16120674
> 
> 赞同：0
> 
> 时间：2013-04-20T13:01:19.627
> 
> 标签：c#, winforms, visual-studio-2012, backgroundworker

我目前正在尝试编写经典的蛇类游戏，用户使用键盘的箭头键在屏幕上引导蛇。到目前为止，我已经成功地整理出指示移动和键盘控制的代码，但是在尝试合并这些代码时遇到了问题。

为了移动蛇，我为每个箭头键使用单独的后台工作循环，如下所示：

```
 public void worker_DoWork(object sender, DoWorkEventArgs e)
        {

            for (int i = 0; i < 1000; i++)
            {
                if (abortloop == true)
                {
                    worker2 = null;
                    worker3 = null;
                    worker4 = null;
                    break;
                }
                while (Snake1.Top - 5 >= 8)
                {
                    {
                        this.Invoke((MethodInvoker)delegate()
                        {
                            Snake1.Top = Snake1.Top - 5;
                                 Refresh(); 
                        });
                        System.Threading.Thread.Sleep(500);

                    }
                }
            }
        } 
```

从键盘输入调用后台工作人员的位置：

```
 else if (e.KeyCode == Keys.W)
        {
            abortloop2 = true;
            abortloop3 = true;
            abortloop4 = true;
            if (worker == null && abortloop == true)
            {
                abortloop = false;
                worker = new BackgroundWorker();
                worker.DoWork += new DoWorkEventHandler(worker_DoWork);
                worker.RunWorkerAsync();
            }
        } 
```

可以说，所有这些代码都不会对程序产生致命错误，但是，在命令蛇向另一个方向移动时（在这种情况下，假设它当前正在向下移动并且我按下右箭头键），蛇将开始向适当的方向移动，但也可以向与以前相同的方向移动（按下右箭头键后，蛇开始对角线移动，而不是像我想要的那样向右移动）。这个问题根本不在于有 4 个单独的后台工作人员，因为如果我只对所有关键输入使用 1 个后台工作人员，也会出现同样的问题。

如果这里有人能帮忙，那就太好了。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-21T12:21:39.853

用 if 替换 while...

```
if (Snake1.Top - 5 >= 8) 
```

循环应该留在外面，你只想检查空间，而不是在内循环中不断减少 Top。;-)

# ios - 保存 UILabel 信息？

> ID：16120676
> 
> 赞同：1
> 
> 时间：2013-04-20T13:02:05.800
> 
> 标签：ios, objective-c, save

我正在为我的应用程序进行下一次更新，并尝试在应用程序关闭或切换页面时将信息保存在我的 UILabels 上。这就是我所拥有的，每次按下按钮时，它都会更新我的 UILabel 以将前一个数字加 1，即 value = 0 但是当按下按钮时 = 1，但是每次我重新加载页面时它似乎都会重置，我想知道他们是否是一种保存该信息的方法，如果是，你怎么能这样做？下面是我的一些代码。

头文件

```
//Here I have created two labels that get updated when button pressed.
IBOutlet UILabel *label1;
IBOutlet UILabel *label2;

}
//Here I have created two variables that correspond to the change in number.
@property (nonatomic) int i;
@property (nonatomic) int s; 
```

实施文件：

```
//Here I have instantiated the two variables in my viewWillAppear method.
- (void)viewWillAppear{

self.i = 0;
self.s = 0;

}

//Here I have my button that changes the value of the label.
-(IBAction)randomButton {

self.i++;
[self->label1 setText:[NSString stringWithFormat:@"%d", self.i]]; 
```

先谢谢了。回顾：如何保存我的 UILabel 的值，但允许它们在按下按钮时通过将值加 1 来更新？但我希望能够保存该价值并重新使用它。任何帮助将不胜感激。

更新：第 1 页（这是我的主页）

![在此处输入图像描述](https://i.stack.imgur.com/AL1dB.png)

第 2 页（我的统计页面/游戏页面）

![在此处输入图像描述](https://i.stack.imgur.com/HFhfq.png)

我希望能够保存那个号码，这是一个 UILabel。但是，当我玩了一会儿并获得高数字，然后在第二页的左上角按回，然后在第一页按 start agian 时，数字恢复为 0。我怎样才能让它们保持它们的价值？

这是我的问题（在.h中）： ![在此处输入图像描述](https://i.stack.imgur.com/vebu0.png)

这是我的问题（以 .m 为单位）： ![在此处输入图像描述](https://i.stack.imgur.com/JG71P.png)

再次更新：我的 .h 现在没有问题，但我的 .m 有很多： ![在此处输入图像描述](https://i.stack.imgur.com/LzlfA.png)

这是我的 AppDelegate.h ![在此处输入图像描述](https://i.stack.imgur.com/aWxak.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T13:08:49.183

编辑您的 AppDelegate.h

```
@interface AppDelegate : UIResponder <UIApplicationDelegate>

@property (strong, nonatomic) UIWindow *window;

//add thist 2 properties
@property (nonatomic, assign) NSUInteger counti;
@property (nonatomic, assign) NSUInteger counts;

@end 
```

然后为您的视图控制器编辑您的代码

```
- (void)viewWillAppear:(BOOL)animated{
AppDelegate *appDelegate = (AppDelegate *)[[UIApplication sharedApplication] delegate];

    [self->label1 setText:[NSString stringWithFormat:@"%d", appDelegate.counti]];
    [self->label2 setText:[NSString stringWithFormat:@"%d", appDelegate.counts]];
}

-(IBAction)randomButton {

    AppDelegate *appDelegate = (AppDelegate *)[[UIApplication sharedApplication] delegate];

    appDelegate.counti = appDelegate.counti+1 ;
    [self->label1 setText:[NSString stringWithFormat:@"%d", appDelegate.counti]];

} 
```

它应该工作

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T14:58:22.457

使用 NSUserDefaults 有什么问题吗？这样，它将在视图和应用程序关闭时保存。

将以下内容添加到您的按钮操作中：

```
NSUserDefaults *userDefaults = [NSUserDefaults standardUserDefaults];
[userDefaults setValue:aValue forKey:@"savedString1]; 
```

第一行用于快速访问。然后将值（aValue）存储在“savedString1”字符串下。

然后，根据您希望何时再次加载它，您将执行以下操作：

```
NSUserDefaults *userDefaults = [NSUserDefaults standardUserDefaults];
NSString *returnAValue = [userDefaults valueForKey:@"savedString1"]; 
```

然后，这将使用先前的值声明一个新的 NSString。您可以将其包含在 viewDidLoad 中。

您也可以存储整数/其他东西 -`integerForKey`加载时只需使用而不是 valueForKey，并声明一个整数。

希望能帮助到你？

# scheme - 球拍方案在函数中定义常量

> ID：16120688
> 
> 赞同：2
> 
> 时间：2013-04-20T13:03:18.637
> 
> 标签：scheme, racket

我是计划的初学者。我有这样的功能：

```
(define (getRightTriangle A B N) (
                            cond
                              [(and (integer? (sqrt (+ (* A A) (* B B)))) (<= (sqrt (+ (* A A) (* B B))) N))
                               (list (sqrt (+ (* A A) (* B B))) A B)
                               ]
                              [else (list)]

                            ) 
```

在这个函数中，我计算了 (sqrt (+ (* AA) (* BB))) 几次。我只想在这个函数的开头计算这个表达式一次（使常量或变量），但我不知道如何......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T13:34:46.173

你有几个选择，对于初学者，你可以使用这样的[`define`](http://doc.racket-lang.org/reference/define.html?q=define#%28form._%28%28lib._racket%2Fprivate%2Fbase..rkt%29._define%29%29)特殊形式：

```
(define (getRightTriangle A B N)
  (define distance (sqrt (+ (* A A) (* B B))))
  (cond [(and (integer? distance) (<= distance N))
         (list distance A B)]
        [else (list)])) 
```

或者[`local`](http://doc.racket-lang.org/htdp-langs/advanced.html?q=local&q=define#%28form._%28%28lib._lang%2Fhtdp-advanced..rkt%29._local%29%29)，如果使用一种高级教学语言，请使用：

```
(define (getRightTriangle A B N)
  (local [(define distance (sqrt (+ (* A A) (* B B))))]
    (cond [(and (integer? distance) (<= distance N))
           (list distance A B)]
          [else (list)]))) 
```

或者使用一种[`let`](http://doc.racket-lang.org/reference/let.html)特殊形式来创建局部变量，恕我直言，这是最干净的方式：

```
(define (getRightTriangle A B N)
  (let ((distance (sqrt (+ (* A A) (* B B)))))
    (cond [(and (integer? distance) (<= distance N))
           (list distance A B)]
          [else (list)]))) 
```

无论如何，请注意为变量选择一个好的名称（`distance`在这种情况下）是多么重要，并在表达式的其余部分引用该名称。此外，值得指出的是，使用的语言（初级、高级等）可能会限制可用的选项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T13:15:00.050

看一下*let*表单（及其相关的表单*let* *、*letrec*和*letrec* *）。好的描述是[http://www.scheme.com/tspl4/start.html#./start:h4](http://www.scheme.com/tspl4/start.html#./start:h4)和[http://www.scheme.com/tspl4/binding.html#./binding:h4](http://www.scheme.com/tspl4/binding.html#./binding:h4)。

# android - Android 中的多个微调器

> ID：16120691
> 
> 赞同：1
> 
> 时间：2013-04-20T13:03:38.623
> 
> 标签：android, android-widget

我的 Android Activity 中有两个微调器，我正在尝试编写用一种方法处理它们的 Java 代码。我试过这个，这就是我处理多个按钮时所做的，但这不起作用。

```
public void onItemSelected(AdapterView<?> parent, View v, int position, long id) {
    Log.d(TAG, "******** onItemSelected(" + position + ") **********");
    Log.d(TAG, "******** onItemSelected() View is (" + v + ") **********");
    switch(v.getId()) {
        case R.id.SpinnerTaxRate :
            ....
            break
        case R.id.SpinnerDiscount :
             ....
             break 
```

问题是没有为微调器设置 v.getId() 。我该如何纠正？

这是其中一个微调器的 XML（另一个非常相似）：

```
 <Spinner android:id="@+id/SpinnerTaxRate"
        android:layout_width="100dip"
        android:layout_height="wrap_content"
        android:drawSelectorOnTop="true"/> 
```

这是为 ItemSelectedListener 注册 Spinner 的代码。

```
 SpinnerTaxRate = (Spinner) findViewById(R.id.SpinnerTaxRate);
    SpinnerTaxRate.setOnItemSelectedListener(this); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-20T13:36:47.107

问题是您`v`正在`TextView`检查`Spinner`. 你想使用`AdapterView<?>`, 或者`parent`哪个是实际的 `Spinner

```
public void onItemSelected(AdapterView<?> parent, View v, int position, long id) {
Log.d(TAG, "******** onItemSelected(" + position + ") **********");
Log.d(TAG, "******** onItemSelected() View is (" + v + ") **********");
switch(parent.getId()) {
    case R.id.SpinnerTaxRate :
        ....
        break
    case R.id.SpinnerDiscount :
         ....
         break 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-20T13:16:47.047

```
switch(parent.getId()) {
    case R.id.SpinnerTaxRate:
        ....
        break 
```

改用这个。你用错了身份证

parent.getId() 返回您在布局中设置的相应视图 ID。在这里，您使用 SpinnerTaxRate 作为 id，但您与 spinner1 进行比较。所以比较正确的id。

**编辑** 我忽略了关键部分.. 而不是 v.getId() 使用 parent.getID()。父母。这里

```
parent  The AdapterView where the selection happened
v       The view within the AdapterView that was clicked 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T13:17:07.813

spinner的id与switch语句不对应

```
<Spinner android:id="@+id/Spinner1" <-----
        android:layout_width="100dip"
        android:layout_height="wrap_content"
        android:drawSelectorOnTop="true"/> 
```

这将导致您的 switch 语句执行。

```
public void onItemSelected(AdapterView<?> parent, View v, int position, long id) {
    Log.d(TAG, "******** onItemSelected(" + position + ") **********");
    Log.d(TAG, "******** onItemSelected() View is (" + v + ") **********");
    switch(parent.getId()) {
        case R.id.Spinner1 : <---
            ....
            break
        case R.id.Spinner2 :
             ....
             break 
```

# java - 安卓手势不起作用

> ID：16120692
> 
> 赞同：0
> 
> 时间：2013-04-20T13:03:49.667
> 
> 标签：java, android, gesture

这是我的主要 Java 文件，我还将包含我的 XML 文件，问题只是应用程序什么都不做，我需要让它滑动以更改页面`newPage()`但没有任何效果。我有一个不可见的按钮，但这种方法对于我试图对应用程序执行的操作来说不够流畅。

```
 package com.example.cardtrick;

 import android.os.Bundle;
 import android.view.MotionEvent;
 import android.view.View;
 import android.widget.Button;
 import android.app.Activity;
 import android.content.Intent;
 import android.content.pm.ActivityInfo;
 import android.view.GestureDetector.OnGestureListener;
 import android.view.GestureDetector;

 public class Trick extends Activity implements OnGestureListener
{

private GestureDetector gestureScanner;
Button testButton;

@SuppressWarnings("deprecation")
@Override
public void onCreate(Bundle savedInstanceState) 
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_trick);

    getRequestedOrientation();
    setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_NOSENSOR);

    setGestureScanner(new GestureDetector(this));

    setUp();

}

public void setUp()
{
    testButton = (Button) findViewById(R.id.btnHidden);     
    testButton.setText("");     
    testButton.setOnClickListener(new View.OnClickListener()
    {
        @Override
        public void onClick(View V)
        {   
            newPage();  
        }

    });
}
public void newPage()
{       
    Intent myIntent = new Intent(getApplicationContext(), Trick2.class);
    startActivity(myIntent);
}

@Override
public boolean onDown(MotionEvent e) 
{
    // TODO Auto-generated method stub
    newPage();
    return false;
}

@Override
public boolean onFling(MotionEvent e1, MotionEvent e2, float velocityX, float velocityY) 
{
    // TODO Auto-generated method stub
    newPage();
    return false;
}

@Override
public void onLongPress(MotionEvent e) 
{
    // TODO Auto-generated method stub
}

@Override
public boolean onScroll(MotionEvent e1, MotionEvent e2, float distanceX, float distanceY) 
{
    // TODO Auto-generated method stub
    return false;
}

@Override
public void onShowPress(MotionEvent e) 
{
    // TODO Auto-generated method stub
}

@Override
public boolean onSingleTapUp(MotionEvent e) 
{
    // TODO Auto-generated method stub
    newPage();
    return false;
}

/**
 * @return the gestureScanner
 */
public GestureDetector getGestureScanner() {
    return gestureScanner;
}

/**
 * @param gestureScanner the gestureScanner to set
 */
public void setGestureScanner(GestureDetector gestureScanner) {
    this.gestureScanner = gestureScanner;
}

}

<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:orientation="vertical"
android:screenOrientation="portrait"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:background="@drawable/backnorepeat"
android:gravity="center_horizontal"
tools:context=".Trick" >

<Button
    android:id="@+id/btnHidden"
    style="@style/FullscreenActionBarStyle"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_gravity="bottom" />

<ImageView
    android:id="@+id/imageView1"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:layout_gravity="center"
    android:contentDescription="@string/card"
    android:src="@drawable/diamonds" />

</FrameLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T13:27:48.580

您需要将 OnTouchListener 添加到活动中的所有视图中，以便在它们上捕获触摸事件。将此代码添加到您的 onCreate

```
 View.OnTouchListener gestureListener = new View.OnTouchListener() {
        public boolean onTouch(View v, MotionEvent event) {
            return gestureScanner.onTouchEvent(event);
        }
    };
    ImageView iview = (ImageView) findViewById(R.id.imageView1);
    iview.setOnTouchListener(gestureListener); 
```

现在您可以在 onFling() 中捕获事件。接下来，您必须确定滑动，查看答案以阅读如何：[https](https://stackoverflow.com/a/938657/2203164) ://stackoverflow.com/a/938657/2203164 。

编辑：为了捕捉 onFling() 你必须`return true`在你的 onDown() 中。

# java - 使用 properties.load() 时出现 NullPointerException

> ID：16120695
> 
> 赞同：3
> 
> 时间：2013-04-20T13:03:58.140
> 
> 标签：java, properties, nullpointerexception, fileinputstream

我对Java中的Properties有一点问题，也许你可以帮助我。

在下面的代码中，我将我的 Properties 对象写入 XML：

```
global.storeToXML(new FileOutputStream(propertiesPath + SEPERATOR + GLOBAL + FILEEXTENSION), ""); 
```

这工作正常并产生以下文件：

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
<properties>
<comment>test</comment>
<entry key="port">5001</entry>
<entry key="maxPlayers">1</entry>
</properties> 
```

但是，如果我尝试使用以下代码加载此文件：

```
FileInputStream fis = new FileInputStream(propertiesPath + SEPERATOR + GLOBAL + FILEEXTENSION);

if (fis != null)
 global.loadFromXML(fis); 
```

loadFromXML 方法抛出 NullPointerException。根据 Properties 的文档，这通常意味着 fis 将为空，显然不是。

我已经尝试了 load() 和 store() 方法（没有 XML）并且得到了同样的错误。当我尝试通过 fis 手动读取文件时，它工作正常。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T13:37:20.030

忘记初始化全局。抱歉这个愚蠢的问题。

# kotlin - Kotlin：如何将一个函数作为参数传递给另一个函数？

> ID：16120697
> 
> 赞同：243
> 
> 时间：2013-04-20T13:04:06.723
> 
> 标签：kotlin

给定函数 foo ：

```
fun foo(m: String, bar: (m: String) -> Unit) {
    bar(m)
} 
```

我们可以做的：

```
foo("a message", { println("this is a message: $it") } )
//or 
foo("a message")  { println("this is a message: $it") } 
```

现在，假设我们有以下功能：

```
fun buz(m: String) {
   println("another message: $m")
} 
```

有没有办法可以将 "buz" 作为参数传递给 "foo" ？就像是：

```
foo("a message", buz) 
```

* * *

## 回答 #1

> 赞同：355
> 
> 时间：2015-10-28T22:44:07.507

Use `::` to signify a function reference, and then:

```
fun foo(msg: String, bar: (input: String) -> Unit) {
    bar(msg)
}

// my function to pass into the other
fun buz(input: String) {
    println("another message: $input")
}

// someone passing buz into foo
fun something() {
    foo("hi", ::buz)
} 
```

[Since Kotlin 1.1](https://kotlinlang.org/docs/reference/whatsnew11.html#bound-callable-references) you can now use functions that are class members ("*Bound Callable References*"), by prefixing the function reference operator with the instance:

```
foo("hi", OtherClass()::buz)

foo("hi", thatOtherThing::buz)

foo("hi", this::buz) 
```

* * *

## 回答 #2

> 赞同：24
> 
> 时间：2016-05-28T04:49:18.393

关于成员函数作为参数：

1.  Kotlin 类不支持静态成员函数，所以不能像这样调用成员函数： Operator::add(5, 4)
2.  因此，成员函数不能与 First-class 函数一样使用。
3.  一个有用的方法是用 lambda 包装函数。它并不优雅，但至少它正在工作。

代码：

```
class Operator {
    fun add(a: Int, b: Int) = a + b
    fun inc(a: Int) = a + 1
}

fun calc(a: Int, b: Int, opr: (Int, Int) -> Int) = opr(a, b)
fun calc(a: Int, opr: (Int) -> Int) = opr(a)

fun main(args: Array<String>) {
    calc(1, 2, { a, b -> Operator().add(a, b) })
    calc(1, { Operator().inc(it) })
} 
```

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2017-05-23T10:48:43.880

**只需在方法名称前使用“::”**

```
fun foo(function: () -> (Unit)) {
   function()
}

fun bar() {
    println("Hello World")
} 
```

`foo(::bar)` **输出**：`Hello World`

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2017-08-18T11:22:54.423

科特林 1.1

使用`::`参考方法。

喜欢

```
 foo(::buz) // calling buz here

    fun buz() {
        println("i am called")
    } 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2019-03-19T07:52:15.723

如果你想传递**setter**和**getter**方法。

```
private fun setData(setValue: (Int) -> Unit, getValue: () -> (Int)) {
    val oldValue = getValue()
    val newValue = oldValue * 2
    setValue(newValue)
} 
```

用法：

```
private var width: Int = 1

setData({ width = it }, { width }) 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2021-03-25T16:09:39.857

这是一个简单的例子，我将乘法函数作为参数传递给另一个函数。

```
fun main(){
    result(10,3,::multiplication)// pass function as parameter wow kotlin amazing
}
fun multiplication(first:Int,second:Int):Int{
    return first*second
}
fun result(firstOne:Int,secondOne: Int,fn:(Int,Int)->Int){
    val result=fn(firstOne,secondOne)
    print(result)

} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2019-05-10T16:59:22.607

Jason Minard 的回答很好。这也可以使用`lambda`.

```
fun foo(m: String, bar: (m: String) -> Unit) {
    bar(m)
}

val buz = { m: String ->
    println("another message: $m")
} 
```

可以用`foo("a message", buz)`.

您也可以使用`typealias`.

```
typealias qux = (m: String) -> Unit

fun foo(m: String, bar: qux) {
    bar(m)
}

val buz: qux = { m ->
    println("another message: $m")
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-04-21T03:29:26.723

显然这还不被支持。

更多信息：

[http://devnet.jetbrains.com/message/5485180#5485180](http://devnet.jetbrains.com/message/5485180#5485180)

[http://youtrack.jetbrains.com/issue/KT-1183](http://youtrack.jetbrains.com/issue/KT-1183)

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-08-12T14:13:54.253

如果这是您使用该函数的唯一地方，您也可以使用 lambda 内联执行此操作

```
fun foo(m: String, bar: (m: String) -> Unit) {
    bar(m)
}

foo("a message") {
    m: String -> println("another message: $m")
}
//Outputs: another message: a message 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-11-28T00:37:34.467

另一个例子：

```
 fun foo(x:Int, Multiply: (Int) -> (Int)) {
    println(Multiply(x))
 }
 fun bar(x:Int):Int{
    return  x * x
 }
 foo(10, ::bar) 
```

* * *

## 回答 #11

> 赞同：-10
> 
> 时间：2013-04-20T22:44:21.157

Kotlin 目前不支持一流的函数。关于这是否是一个很好的添加功能一直存在争议。我个人认为他们应该。

# java - Android 警报接收器从未触发

> ID：16120702
> 
> 赞同：1
> 
> 时间：2013-04-20T13:04:27.880
> 
> 标签：java, android, date, alarmmanager, android-alarms

我正在尝试根据用户定义的值创建通知，但我的警报不起作用；它从未触发过。

片段代码：

```
// Set reminder
            // From java.util.Calendar;
            Calendar timeNow = Calendar.getInstance();
            timeNow.setTimeInMillis(System.currentTimeMillis());

            Calendar thatDate = Calendar.getInstance();
            thatDate.setTimeInMillis(System.currentTimeMillis());

            // add date and time to calender object

            //** Im trying to set the alarm for the 20th of April, 2013 at 14:03**
            thatDate.add(Calendar.MINUTE, 3 - timeNow.get(Calendar.MINUTE));
            thatDate.add(Calendar.MONTH, 3 - timeNow.get(Calendar.MONTH)); //Its April, so I did 3 not 4

            thatDate.add(Calendar.DAY_OF_MONTH,
                    20 - timeNow.get(Calendar.DAY_OF_MONTH));

            thatDate.add(Calendar.HOUR, 14 - timeNow.get(Calendar.HOUR));
            thatDate.add(Calendar.YEAR, 2013 - timeNow.get(Calendar.HOUR));

            Intent alarmintent = new Intent(getActivity(),
                    AlarmReceiver.class);
            alarmintent.putExtra("title", titleEt.getText().toString());
            alarmintent.putExtra("note", desc.getText().toString());

            PendingIntent sender = PendingIntent
                    .getBroadcast(getActivity(), ALARM_ID, alarmintent,
                            PendingIntent.FLAG_UPDATE_CURRENT
                                    | Intent.FILL_IN_DATA);

            /*
             * VERY IMPORTANT TO SET FLAG_UPDATE_CURRENT... This will send
             * the correct extra's informations to the AlarmReceiver class
             */

            // Get the AlarmManager service

            AlarmManager am = (AlarmManager) getActivity()
                    .getSystemService(Context.ALARM_SERVICE);
            am.set(AlarmManager.RTC_WAKEUP, thatDate.getTimeInMillis() - timeNow.getTimeInMillis(), sender); 
```

还有我的警报接收器代码：

```
public class AlarmReceiver extends BroadcastReceiver {

private static int NOTIFICATION_ID = 1;

@Override
public void onReceive(Context context, Intent intent) {

    NotificationManager mNotificationManager = (NotificationManager) context
            .getSystemService(Context.NOTIFICATION_SERVICE);
    NotificationManager manger = (NotificationManager) context
            .getSystemService(Context.NOTIFICATION_SERVICE);
    Notification notification = new Notification(
            R.drawable.ic_stat_reminder, "Todo Reminder",
            System.currentTimeMillis());
    PendingIntent contentIntent = PendingIntent.getActivity(context,
            NOTIFICATION_ID, new Intent(context, AlarmReceiver.class), 0);
    Bundle extras = intent.getExtras();
    String title = extras.getString("title");

    // Get the title and description of our Notification

    /*
     * Notification noti = new Notification.InboxStyle( new
     * Notification.Builder() .setContentTitle("5 New mails from " +
     * sender.toString()) .setContentText(subject)
     * .setSmallIcon(R.drawable.new_mail) .setLargeIcon(aBitmap))
     * .addLine(str1) .addLine(str2) .setContentTitle("")
     * .setSummaryText("+3 more") .build();
     */

    String note = extras.getString("note");
    notification.setLatestEventInfo(context, note, title, contentIntent);
    notification.flags = Notification.FLAG_INSISTENT;
    notification.defaults |= Notification.PRIORITY_MAX;
    // Set the default sound for our notification

    // notification
    manger.notify(NOTIFICATION_ID++, notification);

}
}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T13:08:46.867

仅使用`thatDate`. 时间`set`是实时的，而不是延迟。

```
 AlarmManager am = (AlarmManager) getActivity().getSystemService(Context.ALARM_SERVICE);
 am.set(AlarmManager.RTC_WAKEUP, thatDate.getTimeInMillis(), sender); 
```

# php - Mountain Lion - 更改配置文件 (php.ini) 路径

> ID：16120706
> 
> 赞同：0
> 
> 时间：2013-04-20T13:04:50.543
> 
> 标签：php, symfony-1.4

我试图让**Symfony 1.4**在我的 Mac 上运行。当我键入“ `./symfony doctrine:build --all`”创建数据库时，我收到错误“ `Couldn't located driver named mysql`”。我搜索了这个错误，并被告知我需要在 php.ini 中取消注释这个扩展。我已经这样做了，但我仍然遇到同样的错误！

当我在终端中键入“php --ini”时，我得到：

```
Configuration File (php.ini) Path: /usr/local/lib
Loaded Configuration File:         /usr/local/lib/php.ini
Scan for additional .ini files in: (none)
Additional .ini files parsed:      (none) 
```

我想更改此路径，以便在 XAMPP 中使用 php.ini。

关于如何做到这一点的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-21T07:11:38.007

在 XAMP-Bundle 中使用 PHP 二进制文件。我希望它位于类似`/Applications/XAMPP.app/Contents/Ressources/php/bin/php`. 但我目前无法验证这条路径。因此，您可能必须在`/Applications/XAMPP.app`文件夹中搜索它。也许`find /Applications/XAMPP.app -name php`可能会有所帮助。

因此，您可能希望在调用 symfony-executable 之前将该路径添加到路径文件中，方法是设置`PATH=/Applications/XAMPP.app/Contents/Ressources/php/bin:$PATH`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T13:09:10.173

感谢您的回复，但我最终设法完成了我的目标......

如果您在终端中运行“sudo pico /private/etc/paths”，则可以将 XAMPP 中 php 的路径添加到此文件的顶部，在我的例子中是“/Applications/XAMPP/xamppfiles/bin”。

如果您然后重新启动终端并运行“which php”，您将看到新路径。

谢谢

# c# - 无法使用 MonoDroid 和 MonoTouch 将 Json.Net 添加到可移植类库

> ID：16120713
> 
> 赞同：0
> 
> 时间：2013-04-20T13:05:59.190
> 
> 标签：c#, xamarin.android, json.net, mvvmcross

我不明白这篇文章 - [http://slodge.blogspot.co.uk/2013/01/almost-portable-binaries.html](http://slodge.blogspot.co.uk/2013/01/almost-portable-binaries.html)

我还是有点糊涂。你是说如果我们选择在我们的应用程序中使用 Json.Net 之类的东西，我们需要使用专门用于 MonoDroid 的版本和专门用于 MonoTouch 的版本吗？目前，我有一个包含我的视图模型的可移植类库。我的视图模型依赖于 Json。

当我尝试手动添加对 MvvmCross 中包含的 NewtonSoft 库的引用时，我收到一个编译时错误，提示：“找不到类型或命名空间名称‘Newtonsoft’（您是否缺少 using 指令或程序集引用？）”

如果我尝试通过 NuGet 添加 Json.Net，我会收到一条错误消息：“成功安装了 'Newtonsoft.Json 5.0.3'。成功卸载了 'Newtonsoft.Json 5.0.3'。安装失败。正在回滚......可以不安装包“Newtonsoft.Json 5.0.3”。您正在尝试将此包安装到以“portable-win+net45+MonoAndroid16+sl40+net10+wp71”为目标的项目中，但该包不包含任何程序集引用或与该框架兼容的内容文件。有关更多信息，请联系包作者。

到底是怎么回事？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T14:20:49.937

xamarin 产品中的 PCL 情况正在迅速发展 - 适当的 pcl 支持应该在几周内可用，并且也发生了较大的 mono2->mono3 更改。

在这些更改更加完整之前，情况是：

*   您可能可以在 droid 上使用现有的配置文件 2 和配置文件 104 PCL 作为二进制文件

*   您可能会在 iOS 上使用 PCL 二进制文件 - 但不太可能

*   为每个平台重建 PCL 是最安全的

特别是对于 json.net，我已经将一个版本与 mvx 捆绑了几个月，并且在 iOS 或 touch 上没有遇到问题，但我没有使用每个选项和代码路径 - 所以这种方法可能潜伏着 gremlins。

* * *

对于 droid 和 touch 的 nuget 支持，dsplaisted 将此添加到 nuget 2.5（英雄！） - 但到目前为止，我知道的唯一一个添加了对 xamarin nuget 目标的支持的软件包作者是我 - 请鼓励其他作者加入 - 也许通过向他们发送拉取请求？

# python - 连续取两个子字符串之间的值并临时存储它，然后在 python fileread 中以不同的顺序写入它们

> ID：16120714
> 
> 赞同：0
> 
> 时间：2013-04-20T13:06:07.637
> 
> 标签：python, file-io, kml, gpx

我正在阅读 .gpx 文件的正文，需要更改数据的格式，以便可以将其读取为 .kml

.kml 具有`lat`和`long`.gpx 的交换顺序，**因此我需要找到一种方法来连续获取两个子字符串之间的值并在以不同的顺序写入它们之前临时存储它**。.kml 也与之分开`<time>`，`<coords>`但这几乎是相同类型的任务。

我查看了许多资源，包括：

*   [Python：读取文本文件的一部分，](https://stackoverflow.com/questions/964993/python-reading-part-of-a-text-file)但我不只是在一个值之后，我需要它来处理大量数据点。
*   我也试过元素树。但无法让它飞起来

我试过了

```
lat = re.search('<trkpt lat="(.*)" lon="', x)
lon = re.search('" lon="(.*)">', x) 
```

这显然不适用于原始文件中的多个值。我的代码可能不是很pythonic（还）。编码：

```
def convert(fileName):
    f = open(fileName, "r")
    x = f.read()                
    x = re.sub(r'<trkpt lat="', '           <gx:coord>', x)
    x = re.sub(r'" lon="', ' ', x)
    x = re.sub(r'"><ele>', ' ', x)
    x = re.sub(r'</ele>', '</gx:coord>\n', x)
    x = re.sub(r'<speed>.*?</speed>', '', x)
    return x 
```

让我接近所需的格式。但是我不知道如何连续传递多个值，稍微交换它们并逐步重写

我是 python 新手....请发送帮助。谢谢！

*编辑*

以下是每种文件类型的示例（为清楚起见，我已删除每个文件的标题文本）

.gpx 看起来像这样，并且有时间和坐标并发。如您所见，每个数据点都存在于`<trkpt`和之间`</trkpt>`（.gpx 也有速度，有时还有其他需要清理的东西）：

`<trkseg> <trkpt lat="-33.8598" lon="151.17912"><ele>7.8</ele><speed>0.9013878</speed><time>2012-09-25T07:38:42Z</time></trkpt><trkpt lat="-33.859936" lon="151.17906"><ele>20.8</ele><speed>2.25</speed><time>2012-09-25T07:38:43Z</time></trkpt><trkpt lat="-33.859818" lon="151.17934"><ele>-3.4</ele><speed>1.5</speed><time>2012-09-25T07:38:45Z</time></trkpt> <trkpt lat="-33.859947" lon="151.17914"><ele>16.2</ele><speed>1.5</speed><time>2012-09-25T07:38:49Z</time></trkpt><trkpt lat="-33.860016" lon="151.1792"><ele>18.0</ele><speed>1.75</speed><time>2012-09-25T07:38:52Z</time></trkpt><trkpt lat="-33.86008" lon="151.17923"><ele>18.4</ele><speed>1.5811388</speed><time>2012-09-25T07:38:57Z</time></trkpt><trkpt lat="-33.86013" lon="151.17932"><ele>18.1</ele><speed>1.75</speed><time>2012-09-25T07:39:03Z</time></trkpt>`

好的....这是与`<when>`坐标分开的等效 .kml `<gx:coords>`。当然，每个人的数量总是相同的。您可以看到海拔（`<ele>`在 .gpx 中）是位置数据之后的坐标中未标记的数字。

`

```
 <when>2012-09-25T07:38:42Z</when>
        <when>2012-09-25T07:38:43Z</when>
        <when>2012-09-25T07:38:45Z</when>
        <when>2012-09-25T07:38:49Z</when>
        <when>2012-09-25T07:38:52Z</when>
        <when>2012-09-25T07:38:57Z</when>
        <when>2012-09-25T07:39:03Z</when>
        <gx:coord>151.17912 -33.8598 7.8</gx:coord>
        <gx:coord>151.17906 -33.859936 20.8</gx:coord>
        <gx:coord>151.17934 -33.859818 -3.4</gx:coord>
        <gx:coord>151.17914 -33.859947 16.2</gx:coord>
        <gx:coord>151.1792 -33.860016 18</gx:coord>
        <gx:coord>151.17923 -33.86008 18.4</gx:coord>
        <gx:coord>151.17932 -33.86013 18.1</gx:coord> 
```

`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-27T05:02:08.810

这是有效的，但速度很慢。对于 477k 的小 .gpx，它正在编写 207k 的 .kml，需要 198 秒才能完成。我的直觉是，它是`stringIO.stringIO(x)`如此缓慢。任何如何加快速度的想法都会很棒。

以下是我所做的关键片段：

```
f = open(fileName, "r")
x = f.read()
x = re.sub(r'\n', '', x, re.S) #remove any newline returns
name = re.search('<name>(.*)</name>', x, re.S)
print "Attachment name (as recorded from GPS device): " + name.group(1)

x = re.sub(r'<(.*)<trkseg>', '', x, re.S)  #strip header
x = x.replace("</trkseg></trk></gpx>",""); #strip footer
x = x.replace("<trkpt","\n<trkpt"); #make the file in lines
x = re.sub(r'<speed>(.*?)</speed>', '', x, re.S) #strip speed
x = re.sub(r'<extensions>(.*?)</extensions>', '', x, re.S) # strip out extensions 
```

然后

```
#.kml header goes here
kmlTrack = """<?xml version="1.0" encoding="UTF-8"?><kml xmlns="http://www.ope......etc etc 
```

然后

```
buf = StringIO.StringIO(x)
for line in buf:
            if line is not None:
                    timm = re.search('time>(.*?)</time', line, re.S)
                    if timm is not None:
                            kmlTrack += ("          <when>"+ timm.group(1)+"</when>\n")
                            checkSumA =+ 1
buf = StringIO.StringIO(x)
for line in buf:
            if line is not None:
                    lat = re.search('lat="(.*?)" lo', line, re.S)
                    lon = re.search('lon="(.*?)"><ele>', line, re.S)
                    ele = re.search('<ele>(.*?)</ele>', line, re.S)
                    if lat is not None:
                            kmlTrack += ("          <gx:coord>"+ lon.group(1) + " " + lat.group(1) + " " + ele.group(1) + "</gx:coord>\n")
                            checkSumB =+ 1
if checkSumA == checkSumB:
            #put a footer on
            kmlTrack += """     </gx:Track></Placemark></Document></kml>"""
else:
            print ("checksum error")
            return None

with open("Realbush2.kml", "a") as myfile:
            myfile.write(kmlTrack)
return ("succsesful .kml file-write completed in :" + str(c.seconds) + " seconds.") 
```

再一次，这是可行的，但**速度很慢**。如果有人可以看到如何加快速度，请告诉我！谢谢

# python - 如何将 Html + CSS 代码与 python 函数结合起来？

> ID：16120717
> 
> 赞同：0
> 
> 时间：2013-04-20T13:06:17.230
> 
> 标签：python, html, web-applications, cgi

我对网站开发的经验为零，但正在从事一个小组项目，我想知道是否可以在简单的 html/css 网站和我的 python 函数之间创建交互。所需功能：我必须从网站的文本框中输入一个简单的字符串，将其传递给我的 python 函数，该函数给我一个字符串列表作为输出。然后将此字符串列表传递回网站。我想要一个基本的教程网站来实现这一点。请不要给我一个指向 CGI python 网站的链接，因为我已经阅读过它，并且想要一个更基本和描述性的视图来了解它是如何完成的。我将衷心感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T15:23:16.053

首先，您需要了解 HTTP。它是一个基于文本的协议。

我假设“网站”是指用户代理，例如 FireFox。

现在，您谈论的是输入框，这意味着您已经处理了对内容的 HTTP 请求。在大多数 Web 应用程序中，这将是几个请求（一个用于动态生成的应用程序 HTML，另一个用于静态 css 和 js 文件）。

CGI**是以**编程方式检查已解析的 HTTP 请求并从您设置的对象创建 HTTP 响应的最基本方法。

现在您的应用程序已经足够简单了，您可以自己完成所有的 HTTP 解析，从而对正在发生的事情有一个基本的了解，但是您仍然需要了解如何开发一个可以侦听套接字的服务器。

为了避免所有这些，只需找到一个已经实现上述所有功能的 Python 应用程序服务器以及更多功能。有许多 python 应用程序服务器可供选择。使用具有较小学习曲线的东西来完成上述简单的事情。在这种类型中，有些被标记为“微框架”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T13:14:41.480

[您是否考虑过在 Google App Engine ( https://developers.google.com/appengine/](https://developers.google.com/appengine/) )上创建应用程序？他们的处理表单教程似乎描述了您的问题： [https ://developers.google.com/appengine/docs/python/gettingstartedpython27/handlingforms](https://developers.google.com/appengine/docs/python/gettingstartedpython27/handlingforms)

# java - 我可以在 xxxx-validation.xml 中为 List 配置验证吗？

> ID：16120718
> 
> 赞同：2
> 
> 时间：2013-04-20T13:06:23.490
> 
> 标签：java, struts2

现在在我的保存操作中，我定义了一个名为 booking 的模型，如下所示：

```
Class BookingAction {
       private Booking booking;
       ...
}

Class Booking {
  private String bookingNo;
  private String status;
  ...
  private List<Part>parts = new ArrayList<Part>(); 
  ...
}

Class Part {
  private String partNo;
  ...
} 
```

我还为该操作定义了一个验证 xml 文件，例如

```
<validators>
    <field name="booking.status">
        <field-validator type="requiredstring">
            <param name="trim">true</param>
            <message>${getText("MandatoryFieldEmpty",{"%{getText(\"BookingMain.status\")}"})}</message>
        </field-validator>
    </field>

    <field name="booking.bookedBy">
        <field-validator type="requiredstring">
            <param name="trim">true</param>
        <message>${getText("MandatoryFieldEmpty",{"%{getText(\"BookingMain.bookedBy\")}"})}</message>
    </field-validator>
    </field>
.... 
```

我也可以为 Part 定义这种配置吗？

零件在列表中，并且列表是 Booking 的财产，有人可以告诉我是否可以在 BookingAction-validation.xml 中验证零件吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-21T12:47:20.360

您可以使用[访客验证器](http://struts.apache.org/release/2.3.x/docs/visitor-validator.html)；

您应该在您的对象中添加与对象`<validator type="visitor">`相关的代码段以激活访问者验证；`parts``BookingAction-validation.xml`

然后，您需要在**Object**`Part-validation.xml` **的包下`Part`**创建一个（而不是对象的包`Action`），并在那里为单个 Part 元素指定规则。

`Struts2 Validation Interceptor`将通过使用第二个文件来验证列表的每个元素。

作为一个很好的副作用，如果您`List<Part>`在 another 中包含一个对象`Action`，您对 object 的验证`Part`将已经存在，无需在另一个文件中重写它（您只需在 Action-validation.xml 文件中声明验证器片段）。

* * *

编辑

`Bean-context-validation.xml`仅在某些特定情况下，您可以使用更具体的文件指定不同的上下文来触发对同一 bean 的进一步补充验证。

阅读[**这个详细的例子**](http://struts.apache.org/release/2.0.x/docs/validation-examples.html)，尤其是`Visitor Validation Example`（和以下`Visitor Validation with the Expression Validator`）部分。

# iphone - xcode 将目标从“iOS 设备”更改为模拟器

> ID：16120719
> 
> 赞同：1
> 
> 时间：2013-04-20T13:06:39.187
> 
> 标签：iphone, ios, xcode

我在 xcode 中有一个项目，一个月没碰它（忘记了它是如何工作的）。

现在我想将目标从“iOS 设备”更改为模拟器。

我一生都无法弄清楚我应该如何在 xcode 4.5.2 中做到这一点

-- 为清晰而编辑 --

![在此处输入图像描述](https://i.stack.imgur.com/nzNtg.png)

![在此处输入图像描述](https://i.stack.imgur.com/jiqxH.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-20T13:18:24.997

检查您的 X-Code 中是否安装了任何模拟器。（Xcode->首选项->下载->组件）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T13:08:32.657

像这样：

![在此处输入图像描述](https://i.stack.imgur.com/0N8AP.png)

Xcode 中的左上角：设置活动方案。

# c# - WP7 - 如何从 skydrive 下载和保存文件

> ID：16120721
> 
> 赞同：0
> 
> 时间：2013-04-20T13:07:01.367
> 
> 标签：c#, windows-phone-7, onedrive, live-sdk

我必须将文件从 skdrive 上的文件夹保存到我的隔离存储中（如果存在隔离存储中的文件，则覆盖它们）。

这是我的代码：

```
 private void RestoreData(LiveConnectClient liveClient, string storedFolderId)
    {
        liveClient.DownloadCompleted += liveClient_DownloadCompleted;
        liveClient.DownloadAsync(storedFolderId + "/content");
    }

    private void liveClient_DownloadCompleted(object sender, LiveDownloadCompletedEventArgs e)
    {
        Stream stream = e.Result;

        // HOW TO SAVE FILES ON IN THIS METHOD?
    } 
```

如何在方法 liveClient_DownloadCompleted 中保存文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T13:47:08.700

我找到解决方案：

```
private void liveClient_DownloadCompleted(object sender, LiveDownloadCompletedEventArgs e)
{
    Stream stream = e.Result;

    using (IsolatedStorageFile storage = IsolatedStorageFile.GetUserStoreForApplication())
    {
        using (IsolatedStorageFileStream fileToSave = storage.OpenFile("tasks.xml", FileMode.Create, FileAccess.ReadWrite))
        {
            stream.CopyTo(fileToSave);
            stream.Flush();
            stream.Close();
        }
    }
} 
```

# caliburn.micro - 如何将注入的 ViewModel 停用到 ContentControl 中

> ID：16120722
> 
> 赞同：1
> 
> 时间：2013-04-20T13:07:14.147
> 
> 标签：caliburn.micro

如何将注入的 ViewModel 停用到 ContentControl 中

```
[Import]
public IMyViewModel MyViewModel { get; set; }

public void ClickButton
{
   //This Method Not Deactive MyViewModel
   MyViewModel.Deactivate(true);
}

<ContentControl x:Name="MyViewModel" /> 
```

# jquery - 为什么我的 .autocomplete 不起作用？

> ID：16120724
> 
> 赞同：0
> 
> 时间：2013-04-20T13:07:21.597
> 
> 标签：jquery, json, cakephp, autocomplete

我正在使用此代码来获取带有区域的 json 以进行自动完成输入。json 正在工作，我可以用 firebug 看到它，但自动完成功能没有触发。

我只想使用返回的 json 作为自动完成的源。

```
$(document).ready(function() {
    $('#AdCityId').change(function() {
        var city = $('#AdCityId').val();
        $.ajax({
            url: "http://mydomain.com/classi/ads/getDistrictsByCity",
            type: "GET",
            data: {city: city},
            dataType: "json",
            success: function(result) {
                console.log(result);
                $( "#AdDistrict" ).autocomplete({
                  source: result
                });
            }
        });
    });
}) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T13:15:06.430

您应该查阅[Jquery UI 文档](http://jqueryui.com/autocomplete/#remote)。做这样的事情更容易。

```
$( "#AdCityId" ).autocomplete({
      source: "http://mydomain.com/classi/ads/getDistrictsByCity?city="+$('#AdCityId').val(),
      minLength: 2,
      select: function( event, ui ) {
        //do selecting stuff here if any
      }
    }); 
```

# java - 在 Java 中使用 TCP 实现文件上传

> ID：16120730
> 
> 赞同：0
> 
> 时间：2013-04-20T13:08:20.137
> 
> 标签：java, file-upload

我正在尝试为我的程序实现一个代码，该代码将允许用户从本地驱动器中选择文件，然后他们可以按下以上传到服务器

基本上我将不得不使用我将拥有的 TCP`Client.java`和`Server.java`

In`Client.java`将包括我`GUI`的所有程序部分，以及将发送到`Server.java`

在`Server.java`All it does is listen to the client.java and wait to get the specified file with the path and get it and put them in local folder

所以两者`Client.java`都`Server.java`在同一台计算机中

![在此处输入图像描述](https://i.stack.imgur.com/Fq5Xi.png)

我已经研究了这个[通过 TCP 传输的文件，](http://www.dreamincode.net/forums/topic/139154-transfer-a-file-over-tcp/)但它真正的作用是它会从客户端获取数据（仅作为文本的数据）并将其写入文件，但我的问题是我是否会实现与该链接相同，我将如何实现以使其获取文件并在本地目录中制作该文件的另一个副本？

# c# - 将资源图像转换为图像画笔 - c#

> ID：16120739
> 
> 赞同：0
> 
> 时间：2013-04-20T13:08:57.060
> 
> 标签：c#, image, brush

我想在运行时更改背景属性，我必须为它设置一个 ImageBrush。我在我的项目中添加了一些图像作为资源，现在我可以将它们用作 System.Drawing.Bitmap。

如何将 System.Drawing.Bitmap 转换为 ImageBrush ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T13:13:01.740

如果您使用代码隐藏来设置它，您可以这样做：

```
BitmapImage img; 

// get bitmapimage from resources and assign to img

ImageBrush brush = new ImageBrush();
brush.ImageSource = img;

myControl.Background = brush; 
```

如果您使用数据绑定，则需要实现 ValueConverter

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T13:15:25.933

从[如何在 WPF 中从 System.Drawing.Image 创建 ImageBrush？](https://stackoverflow.com/questions/8490599/how-to-create-imagebrush-from-system-drawing-image-in-wpf)：

```
var bitmapSource = Imaging.CreateBitmapSourceFromHBitmap(bitmap.GetHbitmap(),
                                                         IntPtr.Zero,
                                                         Int32Rect.Empty,
                                                         BitmapSizeOptions.FromEmptyOptions()
        );
bitmap.Dispose();
var brush = new ImageBrush(bitmapSource); 
```

“但是，此解决方案不会释放句柄的内存。有关如何消除内存泄漏的信息，请参阅[WPF CreateBitmapSourceFromHBitmap() 内存泄漏](https://stackoverflow.com/questions/1546091/wpf-createbitmapsourcefromhbitmap-memory-leak)”

# opengl - 翻转图像或反转不确定

> ID：16120742
> 
> 赞同：0
> 
> 时间：2013-04-20T13:10:08.287
> 
> 标签：opengl

我将 3 个图像并排放置，它给人一种镜子般的外观，不能用 + 或 - 号来判断，但你可以用行来判断，在这里看到它。

![图片](https://i.stack.imgur.com/WsbDu.jpg)

这是我使用的代码

```
 glBegin(GL_QUADS);

                  glTexCoord2f(0/4 + xoff,0/4 + yoff);       glVertex2f( x1,game->camera.height-y1);
                  glTexCoord2f(1.0/4 + xoff,0/4 + yoff);    glVertex2f( x2,game->camera.height-y1 );
                  glTexCoord2f(1.0/4 + xoff,1.0/4 + yoff); glVertex2f( x2,game->camera.height-y2 );
                  glTexCoord2f(0/4 + xoff,1.0/4 + yoff);    glVertex2f( x1,game->camera.height-y2 );

                glEnd(); 
```

我相信这正是我绘制坐标的方式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-29T08:35:55.000

只需在纹理或顶点（不是两者）上切换您的 y 坐标。

# java - Spring MVC 表单支持对象字段名称

> ID：16120743
> 
> 赞同：1
> 
> 时间：2013-04-20T13:10:12.047
> 
> 标签：java, spring-mvc, velocity, spring-3

是否可以指定一个文本输入字段`id`来绑定表单支持对象？我的表单使用第三方 javascript，我无法控制输入的`id`值。

例如：

```
<input id="something_with_underscores"> 
```

需要绑定到这个表单对象：

```
public class FormObject {
    private String field1;
    // other properties
    // getters and setters omitted
} 
```

请求映射：

```
@RequestMapping("/somewhere")
public String handlerMethod(@Valid FormObject form) {
    // do stuff with the form
} 
```

我将 Velocity 用于 html 模板，当使用 #springFormInput 宏时，它会尝试将`id`/绑定`name`为`FormObject.field1`. 我需要告诉它查看`something_with_underscores`值/绑定。我知道我`field1`的命名`something_With_Underscores`是否可行，但它与 Java 命名约定不匹配。

# java - 如何使用 java 和 hibernate 使用字节 [] 制作可搜索的字符串 ID

> ID：16120749
> 
> 赞同：0
> 
> 时间：2013-04-20T13:10:42.590
> 
> 标签：java, mysql, hibernate, jakarta-ee, rfid

我正在做一个 RFID 项目，我应该用 RFID 标签识别车辆。RFID 标签包含 14 个字节的数据。我的第一个线索是将数组的每个字节转换为这样的字符串：

```
public String convertByteToString(byte[] tag)
{
    String stringRfid ="";
    for(int i=0; i<14; i++)
      stringRfid = stringRfid + tag[i];
    return stringRfid;
} 
```

我不知道这是一个不起眼的解决方案还是什么。有人说，我引用它“在 BLOB 中存储原始字节 [] - 最安全和最有效的存储方式”。你能给我提示什么是最快、最简单、最有效的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T13:16:00.807

我会将字节数组转换为 base64 编码的可读字符串，并将该字符串存储在数据库中。它只会以 4/3 的比例增加大小（因此大约 20 个字节而不是 14 个字节），并将在数据库中存储可读、可索引和可​​打印的 ascii 字符串。

Guava 和 apache commons-codec 都有一个免费的 base64 编码器/解码器。

# python - 这个最长公共子序列正确吗？

> ID：16120751
> 
> 赞同：3
> 
> 时间：2013-04-20T13:11:02.103
> 
> 标签：python, algorithm, dynamic-programming

我刚刚编写了这个实现来找出使用动态编程的[最长递增子序列的长度。](http://en.wikipedia.org/wiki/Longest_increasing_subsequence)因此，对于输入为 [10, 22, 9, 33, 21, 50, 41, 60, 80]，LIS 为 6，其中一个为 [10, 22, 33, 50, 60, 80]。

当我运行以下代码时，我得到的正确答案为 6，复杂度为 O(n)。这是对的吗？

```
def lis(a):
    dp_lis     = []
    curr_index = 0
    prev_index = 0

    for i in range(len(a)):
        prev_index = curr_index
        curr_index = i

        print 'if: %d < %d and %d < %d' % (prev_index, curr_index, a[prev_index], a[curr_index])
        if prev_index < curr_index and a[prev_index] < a[curr_index]:
            print '\tadd ELEMENT: ', a[curr_index]
            new_lis = 1 + max(dp_lis)
            dp_lis.append(new_lis)
        else:
            print '\telse ELEMENT: ', a[curr_index]
            dp_lis.append(1)

    print "DP LIST: ", dp_lis
    return max(dp_lis)

if __name__ == '__main__':
    a = [10, 22, 9, 33, 21, 50, 41, 60, 80]
    print lis(a) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T15:57:47.330

使用这种正确、经过验证但效率低下的算法实现来检查您的结果——它是标准的递归解决方案，它不使用动态编程：

```
def lis(nums):
    def max_length(i):
        if i == -1:
            return 0
        maxLen, curLen = 0, 0
        for j in xrange(i-1, -1, -1):
            if nums[j] < nums[i]:
                curLen = max_length(j)
                if curLen > maxLen:
                    maxLen = curLen
        return 1 + maxLen
    if not nums:
        return 0
    return max(max_length(x) for x in xrange(len(nums))) 
```

检查是否`your_lis(nums) == my_lis(nums)`有尽可能多的带有数字的不同大小的输入列表，它们应该相等。在某些时候，对于长列表，我的实现会比你的慢得多。

作为进一步的比较点，这是我自己优化的动态编程解决方案。它在`O(n log k)`时间和`O(n)`空间中运行，返回沿途发现的实际最长递增子序列：

```
def an_lis(nums):
    table, lis = lis_table(nums), []
    for i in xrange(len(table)):
        lis.append(nums[table[i]])
    return lis

def lis_table(nums):
    if not nums:
        return []
    table, preds = [0], [0] * len(nums)
    for i in xrange(1, len(nums)):
        if nums[table[-1]] < nums[i]:
            preds[i] = table[-1]
            table.append(i)
            continue
        minIdx, maxIdx = 0, len(table)-1
        while minIdx < maxIdx:
            mid = (minIdx + maxIdx) / 2
            if nums[table[mid]] < nums[i]:
                minIdx = mid + 1
            else:
                maxIdx = mid
        if nums[i] < nums[table[minIdx]]:
            if minIdx > 0:
                preds[i] = table[minIdx-1]
            table[minIdx] = i
    current, i = table[-1], len(table)
    while i:
        i -= 1
        table[i], current = current, preds[current]
    return table 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T15:54:22.500

我经常实现动态编程算法。

我发现检查正确性的最佳方法是编写算法的强力版本，并将输出与小示例的动态编程实现进行比较。

如果两个版本的输出一致，那么您对正确性有合理的信心。

# c# - 在运行时以静态方法获取当前类？

> ID：16120753
> 
> 赞同：3
> 
> 时间：2013-04-20T13:11:09.757
> 
> 标签：c#, reflection, static, abstract

如何在抽象类的静态方法中获取当前类的类型（不是名称字符串，而是类型本身）？

```
using System.Reflection; // I'll need it, right?

public abstract class AbstractClass {

    private static void Method() {

        // I want to get CurrentClass type here

    }

}

public class CurrentClass : AbstractClass {

    public void DoStuff() {

        Method(); // Here I'm calling it

    }

} 
```

这个问题与这个问题非常相似：

[如何在运行时获取当前类名？](https://stackoverflow.com/questions/12035426/how-to-get-the-current-class-name-at-runtime)

但是，我想从静态方法中获取这些信息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T13:19:20.017

```
public abstract class AbstractClass
{
    protected static void Method<T>() where T : AbstractClass
    {
        Type t = typeof (T);

    }
}

public class CurrentClass : AbstractClass
{

    public void DoStuff()
    {
        Method<CurrentClass>(); // Here I'm calling it
    }

} 
```

您只需将类型作为泛型类型参数传递给基类，即可从静态方法访问派生类型。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T13:32:21.930

如果您仅从派生类调用此静态方法，则可以使用“System.Diagnostics.StackTrace”

```
abstract class A
{
    public abstract string F();
    protected static string S()
    {
        var st = new StackTrace();
        // this is what you are asking for
        var callingType = st.GetFrame(1).GetMethod().DeclaringType;
        return callingType.Name;
    }
}

class B : A
{
    public override string F()
    {
        return S(); // returns "B"
    }
}

class C : A
{
    public override string F()
    {
        return S();  // returns "C"
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-20T13:25:29.870

我认为您将不得不像其他建议一样传递它或创建一个堆栈框架，我相信如果您将整个堆栈跟踪放在一起，尽管它可能很昂贵。

请参阅[http://msdn.microsoft.com/en-us/library/system.diagnostics.stacktrace.aspx](http://msdn.microsoft.com/en-us/library/system.diagnostics.stacktrace.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-20T13:26:16.737

`static`如果您要在不传入类型的情况下调用该方法，则该方法不可能。你可以这样做：

```
public abstract class AbstractClass {
    protected void Method() {
        var t = GetType(); // it's CurrentClass
    }
} 
```

如果您还需要从`static`上下文中访问它，您可以添加一个重载，甚至是通用重载，例如：

```
public abstract class AbstractClass {
    protected static void Method<T>() {
        Method(typeof(T));
    }
    protected static void Method(Type t) {
        // put your logic here
    }
    protected void Method() {
        Method(GetType());
    }
} 
```

# ruby-on-rails - 在 ruby on rails 中使用 iconv 删除变音符号不起作用

> ID：16120754
> 
> 赞同：0
> 
> 时间：2013-04-20T13:11:25.650
> 
> 标签：ruby-on-rails, ruby, diacritics, iconv

我在 ruby​​ on rails 中使用 iconv 删除变音符号时遇到了一些问题

这是我的代码：

```
class Diacritics
  def removeDiacritics(text)
    dRemover = Iconv.new("ASCII//TRANSLIT", "UTF-8")
    text = dRemover.iconv(text).gsub(/[^a-zA-Z0-9 ]/, '')
  end
end 
```

这是输出：

```
1.9.3-p392 :001 > require "diacritics"
/usr/local/rvm/gems/ruby-1.9.3-p392@persoc/gems/activesupport-3.2.12/lib/active_support/dependencies.rb:251:in `block in require': iconv will be deprecated in the future, use String#encode instead.
 => true 
1.9.3-p392 :002 > remover = Diacritics.new
 => #<Diacritics:0x00000004237068> 
1.9.3-p392 :003 > text = "Dánský prezídent"
 => "Dánský prezídent" 
1.9.3-p392 :004 > remover.removeDiacritics(text)
 => "Dnsk prezdent" 
```

我期待“丹斯基总统”

fedora (httpd) 上的服务器 apache，使用 rvm 和 ruby​​ 1.9.3-p392

有谁能够帮我？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T14:43:08.340

您可以使用该`ActiveSupport::Inflector.transliterate`方法。

```
ActiveSupport::Inflector.transliterate("Dánsky prezídent") # => "Dansky prezident" 
```

如果你需要这个作为 url slug，那就更容易了。

```
"Dánsky prezídent".parameterize # => "dansky-prezident" 
```

# wcf - 远程服务器返回意外响应。(413) 请求的实体太大

> ID：16120758
> 
> 赞同：0
> 
> 时间：2013-04-20T13:12:14.403
> 
> 标签：wcf, c#-4.0, iis-7

当我从我的 WP7 将照片上传到我的 WCF Web 服务时，我收到“413 Request Entity Too Large”，无论我做什么，我都无法阻止它发生。

我对 Web 服务的绑定信息是：

```
<bindings>
  <basicHttpBinding>
    <binding name="uploadfilebinding" closeTimeout="10:01:00"
      maxBufferSize="2147483646" maxBufferPoolSize="2147483646"
      maxReceivedMessageSize="2147483646" openTimeout="10:01:00"
      receiveTimeout="10:10:00" sendTimeout="10:01:00"
      messageEncoding="Mtom" transferMode="StreamedRequest">
      <readerQuotas maxDepth="2147483646" maxStringContentLength="2147483646"
                    maxArrayLength="2147483646" maxBytesPerRead="2147483646"
                    maxNameTableCharCount="2147483646" />
    </binding>
  </basicHttpBinding>
</bindings> 
```

如您所见，我已将 maxReceivedMessageSize 设置为最高值，但无济于事，有人可以帮帮我吗？

我的服务器是“Windows Server 2008 R2 Standard”，该服务在 .NET 4 下运行。

提前致谢，

李

PS如果您需要更多信息，请询问，我会发布。

感谢您的回复：

由于这是一个 WP7 应用程序，客户端配置文件是由服务创建的名为“ServiceReferences.ClientConfig”的隐藏文件，其中的绑定现在为：

```
<bindings>
  <basicHttpBinding>
    <binding name="BasicHttpBinding_IMbcSync" closeTimeout="10:01:00"
      maxBufferSize="2147483647" maxReceivedMessageSize="2147483647" openTimeout="10:01:00"
      receiveTimeout="10:10:00" sendTimeout="10:01:00"
      transferMode="StreamedResponse">
    </binding>
  </basicHttpBinding>
</bindings> 
```

但我仍然遇到同样的错误。任何更多的建议将不胜感激？

李

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-22T02:02:51.303

您可以将多个位置增加到最大可能大小。其中一些与 WCF 相关，其中一些与 IIS 相关。除了评论中提到的选项外，请尝试在服务器端的配置文件中增加以下内容（maxRequestLength 和 maxAllowedContentLength）以照顾 IIS 端：

```
<system.web>
  <httpRuntime maxRequestLength="2147483647" useFullyQualifiedRedirectUrl="true"   executionTimeout="14400"/>
</system.web>

  <system.webServer>
   <modules runAllManagedModulesForAllRequests="true"/>
    <security>
     <requestFiltering allowDoubleEscaping="true">
      <requestLimits maxAllowedContentLength="2147483647"/>
      <fileExtensions allowUnlisted="true"/>
      <verbs allowUnlisted="true"/>
     </requestFiltering>
    </security>
  </system.webServer> 
```

# java - 用数据填充primefaces数据表

> ID：16120759
> 
> 赞同：1
> 
> 时间：2013-04-20T13:12:14.270
> 
> 标签：java, eclipse, jsf-2, primefaces, datatable

我正在使用primefaces（我使用PF 3.5）[数据](http://www.primefaces.org/showcase-labs/ui/datatableCellEditing.jsf)表，我想用我的数据库中的数据填充表。

```
<p:dataTable id="cars" var="car" value="#{productservice.getListOrderedByDate()}"
    editable="true" editMode="cell" widgetVar="productTable"> 
```

我的服务方法如下所示：

```
public List<Product> getListOrderedByDate() {
    log.trace("Returning list of Products...");
    log.info(productDAO.getProductsOrderedByDate());
    return productDAO.getProductsOrderedByDate();
} 
```

但是，当我在`xhtml`页面中呈现表格时，我会`No records found.`回来。

真的很感谢你的回答！！！

**更新**

```
 <p:dataTable var="product" value="#{productservice.getListOrderedByDate}"> 

                            <f:facet name="header"> Product  </f:facet>

                            <p:column headerText="id" style="width:15%">
                                <h:outputText value="#{product.id}" />
                            </p:column>

                            <p:column headerText="Object Type" style="width:15%">
                                <h:outputText value="#{product.objectType}" />
                            </p:column>

                            <p:column headerText="Price" style="width:15%">
                                <h:outputText value="#" />
                            </p:column>

                            <p:column headerText="For" style="width:15%">
                                <h:outputText value="#{product.for}" />
                            </p:column> 
```

**更新 2**

我的方法产品按日期排序：

```
public List<Product> getProductsOrderedByDate() {
  CriteriaBuilder cb = em.getCriteriaBuilder();
  CriteriaQuery<Product> criteria = cb.createQuery(Product.class);
  Root<Product> product = criteria.from(Product.class);

  criteria.select(product).orderBy(cb.desc(product.get("creationDate")));
  return em.createQuery(criteria).getResultList();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T13:15:23.300

我想问题是您以错误的方式设置值。

```
value="#{yourBean.listOfCars}" 
```

value 应该是一个可迭代的列表类型。

查看展示：[http ://www.primefaces.org/showcase/ui/datatableBasic.jsf;jsessionid=1c0z4mgiaz5531cqf4v78m79iy](http://www.primefaces.org/showcase/ui/datatableBasic.jsf;jsessionid=1c0z4mgiaz5531cqf4v78m79iy)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-20T14:39:27.967

您可以使用@Juvanis 解决方案，或者在您选择的情况下需要使用：

```
 <p:dataTable var="product" value="#{productservice.getListOrderedByDate()}"> 
```

代替：

```
 <p:dataTable var="product" value="#{productservice.getListOrderedByDate}"> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T14:38:16.020

您确定 value 属性正确吗？

在我看来应该是

```
 value="#{productservice.listOrderedByDate} 
```

并不是

```
value="#{productservice.getListOrderedByDate}" 
```

# sqlite - 无法加载文件或程序集“ServiceStack.OrmLite.SqliteNET”或其依赖项之一。

> ID：16120762
> 
> 赞同：0
> 
> 时间：2013-04-20T13:12:30.367
> 
> 标签：sqlite, ormlite-servicestack

我创建了 Asp.Net MVC 4 应用程序并使用“ServiceStack.OrmLite.Sqlite”。当我加载页面时，我看到以下错误。

无法加载文件或程序集“ServiceStack.OrmLite.SqliteNET”或其依赖项之一。试图加载格式不正确的程序

LOG：DisplayName = ServiceStack.OrmLite.SqliteNET（部分） WRN：为程序集提供了部分绑定信息：WRN：程序集名称：ServiceStack.OrmLite.SqliteNET | 域 ID：36 警告：仅提供部分程序集显示名称时会发生部分绑定。警告：这可能会导致活页夹加载不正确的程序集。WRN：建议为程序集提供完全指定的文本标识，WRN：由简单名称、版本、文化和公钥标记组成。警告：有关此问题的详细信息和常见解决方案，请参阅白皮书[http://go.microsoft.com/fwlink/?LinkId=109270](http://go.microsoft.com/fwlink/?LinkId=109270)。

我使用 Visual Studio 2012 Nuget 安装程序来加载文件。这意味着我拥有所有的依赖项。我已将我的项目设置为 32 位和 64 位来解决问题，但无论哪种情况，错误都是相同的。

ServiceStack.OrmLite.SqliteNET 可以在 .Net 4.5 运行时上运行吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T10:43:55.927

我在 .Net 4.0 上修复了同样的问题。我不认为这是与 CLR 版本相关的问题。更多的是与 Nuget 依赖相关的一个。

当我查看[融合日志](https://stackoverflow.com/questions/255669/how-to-enable-assembly-bind-failure-logging-fusion-in-net)时，我发现：

LOG：后策略参考：System.Data.SQLite，Version=1.0.84.0，Culture=neutral，... LOG：程序集名称为：System.Data.SQLite，Version=1.0.85.0，Culture=neutral，PublicKeyToken= db937bc2d44ff139 警告：比较程序集名称导致不匹配：内部版本号 ERR：程序集引用与找到的程序集定义不匹配。

看起来 SQLite Nuget 包已更新并且破坏了一些东西。

解决问题：我将 packages.config 中的引用更改为 1.0.84.0 版本。还原 Nuget 包并手动将两个 SQLite 程序集重新引用到解决方案级别包缓存中新创建的 84 版文件夹。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-10T16:13:28.450

GitHub上报告的[解决方案/问题：](https://github.com/ServiceStack/ServiceStack.OrmLite/issues/234)

解决方案是手动删除 System.Data.SQLite 依赖项，从 package.config 中删除引用，而不是使用“-Version 1.0.84.0”从 nuget 安装。

# security - Loadrunner 和安全问题

> ID：16120769
> 
> 赞同：0
> 
> 时间：2013-04-20T13:13:13.080
> 
> 标签：security, loadrunner

手动访问应用程序可以正常工作，使用 web_add_header 创建手动脚本可以正常工作，但是当使用 http 协议在 vugen 中记录时，网页会出现“页面无法显示”。什么会导致这种情况？我认为这与安全有关？我可以更改 vugen 中的一些设置以使其正常工作吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T22:51:28.860

查看系统中的凭据和浏览器供应商/版本。确保您拥有管理员权限并且您使用的是 32 位浏览器（VUGEN 是 32 位应用程序）是您的 LoadRunner 版本支持的浏览器

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T13:44:12.807

I don't know that this will solve your problem, but I have seen somewhat similar behavior when dealing with security certificates on SSL enable pages. Try installing or re-installing the security certificate for the site in IE before you try recording the script.

# php - ORDER BY 中的方程

> ID：16120771
> 
> 赞同：-2
> 
> 时间：2013-04-20T13:13:22.590
> 
> 标签：php, mysql, sql

这可能吗 ？并且在大约 10,000 个条目的表上进行查询会减慢服务器的速度吗？

我的查询目前是

```
SELECT title, number1, number2 ORDER BY number1 
```

我想做这样的事情

```
SELECT title, number1, number2 ORDER BY (number1 + (number2 *100)) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T13:17:39.013

尝试：

```
SELECT title, number1, number2, (number1 + (number2 *100)) as OrderCondition  
ORDER BY OrderCondition 
```

如果您不希望性能命中缓存结果并为其添加索引。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T13:19:33.653

您在表中创建第四列，例如“myindex”。在此列中，您输入方程式的结果。（这可以在 PHP 中完成，也可以在 INSERT 上使用触发器。）然后您只需按 myindex 选择 order。这应该更有效率。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T13:23:54.260

是的，可以这样做，您可以使用 rokburgar 建议的别名或仅包含`(number1 + (number2 *100))`，但是此计算也必须包含在`SELECT`语句中：

```
SELECT title, number1, number2, (number1 + (number2 *100)) ORDER BY (number1 + (number2 *100)) 
```

作为参考，您还可以在这里查看：[MySQL sort on a calculation](https://stackoverflow.com/questions/2369624/mysql-sort-on-a-calculation)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-20T15:32:39.030

一般来说，在使用数据库时，读取和写入数据的开销比计算的开销要多得多。要进行排序，使用文件排序，必须多次读取和写入数据。这将比额外的计算花费更长的时间。

因此，在查询使用文件排序的情况下，答案是计算在`order by`开销方面可以忽略不计。

另一方面，如果您要与以下内容进行比较：

```
select title, number1, number2
from t
order by number1 
```

*并且*你有一个索引`number1`，那么这将直接使用索引，绕过文件排序。在这种情况下，计算`order by`结果会导致成本更高的不同执行计划。

如果表达式`(number1 + (number2 *100))`是您真正关心的数据元素，您可能会考虑将其直接存储在数据库中并在其上构建索引，也许使用触发器来保持更新。

如果您知道它`number`始终在 0 到 99 之间，那么您将通过执行以下操作获得更好的性能：

```
order by number2, number1 
```

并在`(number2, number1)`.

# mysql - 这可以在 MySQL 中完成吗？组合的插入和查找查询

> ID：16120778
> 
> 赞同：1
> 
> 时间：2013-04-20T13:14:04.740
> 
> 标签：mysql, sql, jdbc, prepared-statement

有表用户和项目用户：用户名（varchar，无重复），密码（varchar），User_id（唯一自动增量INT）项目：Item_name（varchar），Item_id（唯一自动增量INT），Owner_id（必须来自用户user_id）

因此，您将获得一个 Item_name 和一个用户名。您想使用该信息在 Items 中创建一个新项目。因此，一方面您首先需要找出给定用户名的 User_id，然后将一个项目插入到 Items 表中，使 Owner_id 字段 = 您找到的 User_id。

抱歉，我对如何在一个声明中执行他的操作感到非常困惑。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T13:30:10.343

```
insert into item (item_name, owner_id) values (
    ?, (select u.user_id from user u where u.username = ?)
) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T14:10:40.713

```
insert into item (item_name, owner_id) 
select 'new_name', u.user_id 
from user u 
where u.username = 'old_name' 
```

# ios - 限制 UIbutton 的可触摸区域

> ID：16120781
> 
> 赞同：1
> 
> 时间：2013-04-20T13:14:26.053
> 
> 标签：ios, uibutton

这就是我设置按钮导航栏的方式

```
 UIButton *addEditButton = [UIButton buttonWithType:UIButtonTypeCustom];
    [addEditButton setImage:[UIImage imageNamed:@"edit.png"] forState:UIControlStateNormal];
    [addEditButton setFrame:CGRectMake(0, 0, 62, 31)]; used frame same as image

    [addEditButton addTarget:self action:@selector(EditTable) forControlEvents:UIControlEventTouchUpInside];
    UIBarButtonItem *addEdit = [[UIBarButtonItem alloc] initWithCustomView:addEditButton];
    self.navigationItem.leftBarButtonItem =addEdit; 
```

一切正常，但是当我触摸它的一侧时按钮被按下。如何解决这个问题有什么办法，所以只有当我触摸它时它才会被按下

就是这个图![在此处输入图像描述](https://i.stack.imgur.com/6Okag.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T14:03:05.763

我相信您遇到了这个问题，因为您设置的图像小于按钮的实际大小。请缩小按钮尺寸或提供更大的图像。

我希望这可以帮助你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-23T13:37:35.200

苹果已经设置了这个东西，以便用户可以顺利导航。建议不要进行将按钮放在导航栏按钮附近的设计。有一些方法可以做到，但改变这种事情并不好。就像回复消息和删除消息一样，两个按钮都靠近彼此

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-22T05:55:07.580

似乎它只是这样工作，但我还是想出了一个解决方案。

一个是您可以隐藏导航栏并确实使用工具栏。

其他是您可以在此之后添加另一个按钮并将其启用属性设置为 FALSE。

我不知道这是否合适，但似乎至少可以满足您的要求。

这是代码：

```
UIButton *addEditButton = [UIButton buttonWithType:UIButtonTypeCustom];
[addEditButton setFrame:CGRectMake(0, 0, 62, 31)];

[addEditButton setImage:[UIImage imageNamed:@"edit.png"] forState:UIControlStateNormal];

[addEditButton addTarget:self action:@selector(EditTable) forControlEvents:UIControlEventTouchUpInside];

UIButton *addEditButton1 = [UIButton buttonWithType:UIButtonTypeCustom];
[addEditButton1 setFrame:CGRectMake(63, 0, 30, 31)]; 

UIBarButtonItem *addEdit = [[UIBarButtonItem alloc] initWithCustomView:addEditButton];
UIBarButtonItem *addEdit1 = [[UIBarButtonItem alloc] initWithCustomView:addEditButton1];
addEdit1.enabled = FALSE;

NSMutableArray *buttonArray=[[NSMutableArray alloc]initWithCapacity:2];
[buttonArray addObject:addEdit];
[buttonArray addObject:addEdit1];

self.navigationItem.leftBarButtonItems =buttonArray; 
```

# visual-studio-2010 - VS2010 devenv.exe.config 问题

> ID：16120784
> 
> 赞同：0
> 
> 时间：2013-04-20T13:14:42.237
> 
> 标签：visual-studio-2010, visual-studio, configuration-files

我无法打开 vs2010。我有 windows 7 操作系统，它是 32 位机器。事件日志说

 ***“C:\Program Files\Microsoft Visual Studio 10.0\Common7\IDE\devenv.exe”的激活上下文生成失败。清单或策略文件“C:\Program Files\Microsoft Visual Studio 10.0\Common7\IDE\devenv. exe.Config”在第 13 行。无效的 Xml 语法。***

devenv.exe.config 文件损坏了很多垃圾字符我不知道它是如何损坏的。重置我的配置设置将是我的最后一个选项。我没有任何文件备份

我试图修复自己，我知道这是一个坏主意。修复文件后，我无法保存文件。我试图找出任何进程已使用 Procmon.exe 并使用另一个名为 unlockit 的软件锁定了该文件。没有进程锁定此配置文件。

有没有办法在不重置的情况下重新生成配置文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-03-26T21:26:18.210

尝试使用以管理员身份运行的文本编辑器（不是 Windows 用户帐户，程序管理员）修复文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T13:49:10.633

我能想到的唯一选择是创建 devenv.exe.config 的副本，然后重新生成 devenv.exe.config 并将副本中的其他设置粘贴到重新生成的 devenv.exe.config 中。

您应该考虑安装备份应用程序并定期备份您的开发机器。这将允许您在发生故障时恢复单个文件或恢复您的硬盘。当出现问题时，它确实可以节省时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-15T23:25:20.763

以管理员身份打开记事本。在记事本中打开 devenv.exe.config，进行更改并将其保存在同一位置。

它适用于 machine.config。

# mysql - JOIN 三张表，即使一张是空的

> ID：16120789
> 
> 赞同：3
> 
> 时间：2013-04-20T13:15:04.557
> 
> 标签：mysql, sql

我试图从三个表中获取值，即使一个表是空的。因为我可以根据`following.follow_id`行是否为空来使用 if else 语句。

```
SELECT user.id, user.username,user.email, userdetails.profile_img, following.follow_id 
FROM user 
JOIN userdetails ON user.id = userdetails.user_id 
JOIN following ON user.id = following.follow_id 
GROUP BY user.id; 
```

目前，它仅在 row 上有值时才给我该值`following.follow_id`。但是即使有一个空表，我也可以从 user_id 获得所有结果。

有什么线索吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-20T13:19:19.673

用“LEFT JOIN”替换“JOIN”，这意味着“INNER JOIN”应该可以解决问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T13:22:39.977

是的，您需要使用 OUTER 连接来完成此操作。

原因是当你只是说 JOIN 时，这实际上被解释为 INNER JOIN，在这种情况下，所有表中都需要匹配。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-20T13:23:55.393

现在，您正在对这 3 个表使用 INNER 联接。这意味着您将只取回在其他表中具有相应行的行。也就是说，如果给定的 user.id 没有对应的 following.follow_id 和 userdetails.user_id，那么该行将被忽略。

相反，如果您使用从用户到其他表的 LEFT JOIN（左外连接），我认为您应该得到您正在寻找的结果。

有关 INNER 与 OUTER 联接的更多信息，这个问题可能会有所帮助： [“INNER JOIN”和“OUTER JOIN”有什么区别？](https://stackoverflow.com/questions/38549/difference-between-inner-and-outer-join)

# windows-phone-7 - 如何将 DataContext 添加到用户控件的 xaml？

> ID：16120792
> 
> 赞同：0
> 
> 时间：2013-04-20T13:15:10.590
> 
> 标签：windows-phone-7, xaml

我试图在我的用户控件中设置：

```
d:DataContext="{d:DesignData ListItemDemoData.xaml}" 
```

但Visual Studio 声明它无法找到`ListItemDemoData`.`ListItemDemoData.xaml``ListItemDemoData`

奇怪，我做错了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T11:46:10.120

你可以在后面的代码上做到这一点。我有一个用于显示大图像的用户控件。我的控件的名称是 ImageViewer。现在我必须绑定图像源。所以，我创建了一个依赖属性，比如

```
 public static readonly DependencyProperty ValueProperty =
       DependencyProperty.Register("ImageSourceValue", typeof(string), typeof(ImageViewer),
       new PropertyMetadata(ValueChanged));

    public string ImageSourceValue
    {
        get { return (string)GetValue(ValueProperty); }
        set { SetValue(ValueProperty, value); }
    }

    /// <summary>
    /// Called when the value of ImageSourceValue is changed or set.
    /// </summary>
    public static void ValueChanged(DependencyObject sender, DependencyPropertyChangedEventArgs args)
    {
        // Get out of a static and into the instance ASAP.
        ImageViewer control = (ImageViewer)sender;
        control.ValueChanged();

    }

    private void ValueChanged()
    {
        //The value of ImageSourceValue is set at the time calling user control from your page.
        this.ImageSource = ImageSourceValue;

        this.DataContext = this;
    }

    public string ImageSource { get; set; } 
```

在将值绑定到将字符串图像路径转换为位图图像对象的图像控件时，我使用了转换器。string ImageSource 可以改为 BitmapImage 类型。并且当 ImageSourceValue 的值被赋值给 ImageSource 时就可以完成转换。

# ios6 - 调用 beginRefreshing 并且 contentOffset 为 0 时 UIRefreshControl 不显示刺

> ID：16120797
> 
> 赞同：11
> 
> 时间：2013-04-20T13:15:38.013
> 
> 标签：ios6, uitableview, uirefreshcontrol

**调用时我看不到加载微调器`beginRefreshing`**

```
[self.refreshControl beginRefreshing]; 
```

我的 UITableViewController 子类使用 UIRefreshControl

```
// refresh
    UIRefreshControl * refreshControl = [UIRefreshControl new];
    [refreshControl addTarget:self action:@selector(refreshTableView) forControlEvents:UIControlEventValueChanged];
    self.refreshControl = refreshControl; 
```

它与用户交互（当用户放下桌子时）完美地工作，然后微调器可见。

但是当我调用`beginRefreshing`viewDidLoad 时，我看不到微调器（仅当我向下拖动表格时）。

笔记：

*   self.refreshControl 引用是对的

*   在beginRefreshing之后没有立即调用reloadData或endRefreshing，但是有很长的延迟（通过网络加载数据），所以我没有取消beginRefreshing。

编辑： **这只发生在`contentOffset`属性`tableView`为 0 并且我调用时`[self.refreshControl beginRefreshing]`。漏洞？特征？**

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-04-27T09:55:55.283

对我来说它看起来像一个错误，因为它只发生在`contentOffset`属性`tableView`是`0`

我用以下代码（UITableViewController 的方法）修复了这个问题：

```
- (void)beginRefreshingTableView {

    [self.refreshControl beginRefreshing];

    if (self.tableView.contentOffset.y == 0) {

        [UIView animateWithDuration:0.25 delay:0 options:UIViewAnimationOptionBeginFromCurrentState animations:^(void){

            self.tableView.contentOffset = CGPointMake(0, -self.refreshControl.frame.size.height);

        } completion:^(BOOL finished){

        }];

    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-29T09:47:31.637

你的修复看起来不错，但我不认为这是一个错误。

当手动调用 beginRefreshing 方法时，

当没有可用的行/单元格时，刷新控件自动出现是有意义的。但是当有一些可用的单元格时，并且当我们手动调用开始刷新（我们基于计时器定期刷新的场景）时，它不应该动画/更改内容偏移量，因为如果他正在查看/阅读内容，它会分散用户的注意力一些可见的细胞。

# java - 如何使用 NIO 设计 Java 服务器？

> ID：16120799
> 
> 赞同：3
> 
> 时间：2013-04-20T13:15:51.563
> 
> 标签：java, sockets, concurrency, network-programming, nio

假设我正在编写服务器。服务器接受客户端连接，从网络读取请求，处理它们并发回结果。还假设我想手动处理所有套接字的东西（就像练习一样）。

我希望有一个线程来处理具有`java.nio`非阻塞 API 的套接字。当它完全读取一个请求时，它开始*异步*处理它（使用`Future`或将请求传递给另一个线程）并`selector`立即返回。

当处理完成时，“套接字线程”应该接收到通过套接字将其发送回客户端的响应。但是我不知道该怎么做。

这是否意味着上面的设计是错误的？您如何建议使用 实施服务器`java.nio`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-21T04:06:04.170

When a request is put in the queue, and the selector thread is in `selector.select()`, call `selector.wakeup()`. The selector thread executes loop like this:

```
while (selector.isOpen() && !Thread.interrupted()) {
    for (;;) {
        Request r=queue.poll(); // requests can be both to read and write
        if (r==null) {
            break;
        }
        processRequest(r);
    }

    selector.select(); // wait for next event

    // Iterate over the set of keys for which events are available
    Iterator<SelectionKey> selectedKeys = selector.selectedKeys().iterator();
    while (selectedKeys.hasNext()) {
        SelectionKey key = selectedKeys.next();
        selectedKeys.remove();
        processKey(key);
    }
} 
```

# python - Matplotlib 动画 fill_between 形状

> ID：16120801
> 
> 赞同：15
> 
> 时间：2013-04-20T13:15:56.043
> 
> 标签：python, animation, matplotlib, plot

我正在尝试为 matplotlib 中的 fill_between 形状设置动画，但我不知道如何更新 PolyCollection 的数据。举个简单的例子：我有两条线，我总是在它们之间填充。当然，线条会发生变化并且是动画的。

这是一个虚拟示例：

```
import matplotlib.pyplot as plt

# Init plot:
f_dummy = plt.figure(num=None, figsize=(6, 6));
axes_dummy = f_dummy.add_subplot(111);

# Plotting:
line1, = axes_dummy.plot(X, line1_data, color = 'k', linestyle = '--', linewidth=2.0, animated=True);
line2, = axes_dummy.plot(X, line2_data, color = 'Grey', linestyle = '--', linewidth=2.0, animated=True);
fill_lines = axes_dummy.fill_between(X, line1_data, line2_data, color = '0.2', alpha = 0.5, animated=True);

f_dummy.show();
f_dummy.canvas.draw();
dummy_background = f_dummy.canvas.copy_from_bbox(axes_dummy.bbox);

# [...]    

# Update plot data:
def update_data():
   line1_data = # Do something with data
   line2_data = # Do something with data
   f_dummy.canvas.restore_region( dummy_background );
   line1.set_ydata(line1_data);
   line2.set_ydata(line2_data);

   # Update fill data too

   axes_dummy.draw_artist(line1);
   axes_dummy.draw_artist(line2);

   # Draw fill too

   f_dummy.canvas.blit( axes_dummy.bbox ); 
```

问题是如何在每次调用 update_data() 时根据 line1_data 和 line2_data 更新 fill_between Poly 数据并在 blit 之前绘制它们（“#Update fill data too”和“#Draw fill too”）。我尝试了 fill_lines.set_verts() 没有成功并且找不到示例...

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-06-03T18:33:15.333

好的，正如有人指出的那样，我们在这里处理一个集合，所以我们将不得不删除并重绘。所以在`update_data`函数的某个地方，删除与之关联的所有集合：

```
axes_dummy.collections.clear() 
```

并绘制新的“fill_between”PolyCollection：

```
axes_dummy.fill_between(x, y-sigma, y+sigma, facecolor='yellow', alpha=0.5) 
```

需要一个类似的技巧来将未填充的等高线图覆盖在已填充的等高线图上，因为未填充的等高线图也是一个集合（我想是线条？）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-12-17T03:43:17.207

这不是我的答案，但我发现它最有用：

[http://matplotlib.1069221.n5.nabble.com/animation-of-a-fill-between-region-td42814.html](http://matplotlib.1069221.n5.nabble.com/animation-of-a-fill-between-region-td42814.html)

嗨 Mauricio，Patch 对象比线对象更难使用，因为与线对象不同的是，从用户提供的输入数据中删除了一个步骤。有一个类似于你想在这里做的例子：http: [//matplotlib.org/examples/animation/histogram.html](http://matplotlib.org/examples/animation/histogram.html)

基本上，您需要在每一帧修改路径的顶点。它可能看起来像这样：

```
from matplotlib import animation
import numpy as np
import matplotlib.pyplot as plt

fig, ax = plt.subplots()
ax.set_xlim([0,10000])

x = np.linspace(6000.,7000., 5)
y = np.ones_like(x)

collection = plt.fill_between(x, y)

def animate(i):
    path = collection.get_paths()[0]
    path.vertices[:, 1] *= 0.9

animation.FuncAnimation(fig, animate,
                        frames=25, interval=30) 
```

查看 path.vertices 以了解它们的布局。希望有帮助，杰克

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-07-13T10:12:56.163

如果您不想使用动画，或者从您的图形中删除所有内容以仅更新填充，您可以使用这种方式：

打电话`fill_lines.remove()`，然后再打电话`axes_dummy.fill_between()`来画新的。它在我的情况下有效。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-11-10T14:01:28.440

另一个可行的成语也是保留您绘制的对象的*列表*；此方法似乎适用于任何类型的绘图对象。

```
# plot interactive mode on
plt.ion()

# create a dict to store "fills" 
# perhaps some other subclass of plots 
# "yellow lines" etc. 
plots = {"fills":[]}

# begin the animation
while 1: 

    # cycle through previously plotted objects
    # attempt to kill them; else remember they exist
    fills = []
    for fill in plots["fills"]:
        try:
            # remove and destroy reference
            fill.remove()
            del fill
        except:
            # and if not try again next time
            fills.append(fill)
            pass
    plots["fills"] = fills   

    # transformation of data for next frame   
    x, y1, y2 = your_function(x, y1, y2)

    # fill between plot is appended to stored fills list
    plots["fills"].append(
        plt.fill_between(
            x,
            y1,
            y2,
            color="red",
        )
    )

    # frame rate
    plt.pause(1) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-11-09T20:21:06.887

初始化pyplot交互模式

```
import matplotlib.pyplot as plt

plt.ion() 
```

绘制填充时使用可选的标签参数：

```
plt.fill_between(
    x, 
    y1, 
    y2, 
    color="yellow", 
    label="cone"
)

plt.pause(0.001) # refresh the animation 
```

稍后在我们的脚本中，我们可以按标签选择以删除特定填充或填充列表，从而逐个对象地制作动画。

```
axis = plt.gca()

fills = ["cone", "sideways", "market"]   

for collection in axis.collections:
    if str(collection.get_label()) in fills:
        collection.remove()
        del collection

plt.pause(0.001) 
```

您可以对要删除的对象组使用相同的标签；或以其他方式根据需要使用标签对标签进行编码以满足需求

例如，如果我们将填充标记为：

“锥体1” “锥体2” “侧身1”

```
if "cone" in str(collection.get_label()): 
```

将排序以删除以“cone”为前缀的那些。

您也可以以相同的方式为线条设置动画

```
for line in axis.lines: 
```

# drupal - 如何从 ubercart 中删除 Cataloge URL

> ID：16120802
> 
> 赞同：0
> 
> 时间：2013-04-20T13:15:59.597
> 
> 标签：drupal, ubercart

如何从 url 中删除“目录”，例如我的网站 http://[my_site_address]/catalog 显示 unbercart 中的所有类别。

我想从 url 更改“目录”并将其替换为“存储”我尝试从视图中更改它，但它没有改变。指导我我是drupal的新手。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T13:50:31.897

您可以使用路径模块在配置下创建一个新的 URL 别名。它是 Drupal 核心的一部分，可能已经启用。

对于目录的其余部分（例如 www.site.com/catalog/1），您应该使用这个 Path Auto [http://drupal.org/project/pathauto](http://drupal.org/project/pathauto)模块来生效。

# android - MediaPlayer start->stop->start for MIDI 文件

> ID：16120809
> 
> 赞同：0
> 
> 时间：2013-04-20T13:16:43.443
> 
> 标签：android, android-mediaplayer

我看到 MediaPlayer 有问题，尝试对 MIDI 文件执行下一个序列 start()->stop()->start() 给我一个错误。

通过查看[MediaPlayer 状态图，](http://developer.android.com/reference/android/media/MediaPlayer.html)该序列应该与下一个代码一起使用：

```
void experiment() throws IllegalArgumentException, SecurityException, IllegalStateException, IOException {
    Context context = this;
    int resid = R.raw.teddybear;
    String packageName = getResources().getResourcePackageName(resid);
    Uri uri = Uri.parse("android.resource://" + packageName + "/"  + resid);
    MediaPlayer mp = new MediaPlayer();
    mp.setDataSource(context, uri);
    mp.prepare();
    mp.start();
    mp.stop();
    mp.prepare();
    mp.start();
} 
```

这是从调用第二个准备中得到的错误：

java.io.IOException：准备失败。：状态=0xFFFFFFFD

其他声音文件不存在此问题。

有没有人也遇到这种情况？难道我做错了什么？

我不是想到处走走——有很多:)

尝试的事情：

*   删除 stop 和 stop&prepare&start 允许播放此流。

*   我听说 MediaPlayer 没有立即更新其状态，所以我在方法之间添加了 sleep - 仍然是同样的问题。

*   更改文件类型解决了这个问题。

*   尝试几个 MIDI 文件会产生相同的结果。

*   注册一个 OnError 也没有奏效——他没有被叫到

难道这是一个错误？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-31T03:10:20.117

1.  正如您所说：更改文件类型解决了这个问题。
2.  试试 SoundPool

# android - 如何使用保存在外部 SD 上的 OSM 离线地图？

> ID：16120811
> 
> 赞同：3
> 
> 时间：2013-04-20T13:16:50.417
> 
> 标签：android, osmdroid

我目前正在尝试开发一个使用 osm 离线地图的 Android 应用程序。我想提供大量离线地图。这就是为什么我决定使用 Galaxy S2 的外部 SD 卡作为磁贴源的文件夹。

不幸的是，我无法在 Eclipse 的 ddms-file-explorer 中找到外部 sd 卡。我只找到了内部sd。

我使用 Windows 资源管理器将 osmdroid.zip 复制到外部 sd，但我的应用程序找不到它。我还编写了自己的 osmdroid 颠覆作为库来选择特定路径，但没有结果。可能，我没有尝试适当的路径。

我希望那里有人可以描述我，如何使用外部 sd 作为磁贴的存储。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-22T10:13:15.853

osmdroid 默认使用外部 sdcard 加载离线地图，因为它们是从 OpenStreetMapTileProviderConstants 中定义的 osmdroid 目录加载的：

```
/** Base path for osmdroid files. Zip files are in this folder. */
public static final File OSMDROID_PATH = new File(Environment.getExternalStorageDirectory(),
        "osmdroid"); 
```

要加载您的地图，您可以使用 MapTileFileArchiveProvider 或直接使用 MapTileFileArchiveProvider 本身的 MapTileProviderBasic。

这里有一个很好的解释 osmdroid 如何与离线地图一起工作：[https ://stackoverflow.com/a/8286276/891479](https://stackoverflow.com/a/8286276/891479)

在您的应用程序中使用 MapTileProviderBasic。这里的一些例子：[http ://www.androidadb.com/class/ma/MapTileProviderBasic.html](http://www.androidadb.com/class/ma/MapTileProviderBasic.html)

如果您的切片未加载，这也可能是因为您的 zip 中的目录结构错误，请不要忘记将切片源名称设置为基本目录：

/tilesourcename/zoomlevel/...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T14:04:49.077

在 Galaxy S2 中，外部 sd 卡通常位于`/sdcard/external_sd`. 因此，您可以通过指定其路径来打开文件：

```
File myFile = new File(/sdcard/external_sd/osmdroid.zip); 
```

然后您可以正常读取文件，但在您的情况下，您可能希望使用 a`ZipFile`来读取 zip 的内容。

# wordpress - Wordpress：如何在 wp_nav_menu 链接上添加推荐变量

> ID：16120814
> 
> 赞同：0
> 
> 时间：2013-04-20T13:17:01.883
> 
> 标签：wordpress, menu

我需要帮助！

wp_nav_menu() 创建一个 html 输出

```
<li id="xxx" class="xxx"><a  href="http://localhost/?page_id=1">home</a></li>
<li id="xxx" class="xxx"><a  href="http://localhost/?page_id=2">news</a></li>
<li id="xxx" class="xxx"><a  href="http://localhost/?page_id=3">reviews</a></li> 
```

我将如何向链接添加引用变量？像这些：

```
<li id="xxx" class="xxx"><a  href="http://localhost/?page_id=1&ref=abc">home</a></li>
<li id="xxx" class="xxx"><a  href="http://localhost/?page_id=2&ref=mno">news</a></li>
<li id="xxx" class="xxx"><a  href="http://localhost/?page_id=3&ref=xyz">reviews</a></li> 
```

任何帮助将不胜感激。

**更新**：我必须像这样获得字面名称（家庭、新闻和评论）：

```
<li id="xxx" class="xxx"><a  href="http://localhost/?page_id=1&ref=home">home</a></li>
<li id="xxx" class="xxx"><a  href="http://localhost/?page_id=2&ref=news">news</a></li>
<li id="xxx" class="xxx"><a  href="http://localhost/?page_id=3&ref=reviews">reviews</a></li> 
```

它将用作类别名称。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T13:21:50.553

您可以过滤导航菜单输出`functions.php`：

```
function add_ref_value( $items, $menu, $args ) {
    foreach ( $items as $item ) {
        // check some value in the $item object and generate ref value
    }
    return $items;
}

add_filter( 'wp_get_nav_menu_items', 'add_ref_value', null, 3 ); 
```

**更新：**实际上，我认为你最好使用这种方法：[http ://www.kriesi.at/archives/improve-your-wordpress-navigation-menu-output](http://www.kriesi.at/archives/improve-your-wordpress-navigation-menu-output)

这应该使生成和附加`ref`属性变得更加容易。

这里还有一些链接可以帮助您：

*   [http://core.trac.wordpress.org/browser/trunk/wp-includes/nav-menu-template.php#L10](http://core.trac.wordpress.org/browser/trunk/wp-includes/nav-menu-template.php#L10) - WP 源代码中的 nav menu walker 类
*   [http://wp.tutsplus.com/tutorials/creative-coding/understanding-the-walker-class/](http://wp.tutsplus.com/tutorials/creative-coding/understanding-the-walker-class/) - walker类的深入描述

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-21T05:58:09.057

解决它！我在第 86 行编辑了 nav-menu-template.php。

```
$attributes .= ! empty( $item->url )? ' href="'. esc_attr( $item->url) .'&ref=' .$item->title. '"' : ''; 
```

我添加了 &ref=' .$item->title。'

这可能对其他人有所帮助，特别是如果他们想从 url 中获取变量。

不过我想学习步行者课程....再次感谢@joe

# php - 使用媒体查询时如何显示不同尺寸的特色图片

> ID：16120819
> 
> 赞同：3
> 
> 时间：2013-04-20T13:17:12.750
> 
> 标签：php, wordpress, media-queries

由于特色图片设置了默认尺寸，例如：

```
add_image_size( 'post-thumbnails2200px', 360, 250, true );
add_image_size( 'post-thumbnails1280px', 250, 250, true );
add_image_size( 'post-thumbnails800px', 150, 250, true ); 
```

我的问题是如何在不使用 css max-width 或任何 css 样式的情况下显示不同尺寸的特色图像。

当我尝试不同的分辨率时，我无法显示它。实际上，我不知道该怎么做。当我使用 css 时，由于高度固定为 250 像素，它会变形。

我想知道你是否有人可以分享他们的 php if 和 else 脚本或 javascript 或任何东西。请帮忙！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T01:50:17.277

仅使用 Javascript 和 PHP：

**PHP**

您可以`the_post_thumbnail()`根据[codex](http://codex.wordpress.org/Function_Reference/the_post_thumbnail)使用各种图像尺寸：

```
the_post_thumbnail();                  // without parameter -> 'post-thumbnail'

the_post_thumbnail('thumbnail');       // Thumbnail (default 150px x 150px max)
the_post_thumbnail('medium');          // Medium resolution (default 300px x 300px max)
the_post_thumbnail('large');           // Large resolution (default 640px x 640px max)
the_post_thumbnail('full');            // Full resolution (original size uploaded)

the_post_thumbnail( array(100,100) );  // Other resolutions 
```

**Javascript**

您可以使用[这里](https://stackoverflow.com/questions/3437786/how-to-get-web-page-size-browser-window-size-screen-size-in-a-cross-browser-wa)`jQuery(window).width()`描述的寡妇大小。

通过将两者结合起来，您可以在循环内的主题模板文件中执行以下操作：

```
<script>
    if( jQuery(window).width() < 480 ) {
        <?php the_post_thumbnail('medium'); ?>
    }
    else if( jQuery(window).width() < 960 ) {
        <?php the_post_thumbnail('large'); ?>
    }
    else {
        <?php the_post_thumbnail('full'); ?>
    }
</script> 
```

警告：我现在没有一台机器可以测试这个，但如果上面的方法不起作用，请尝试用 etc. 替换`<?php the_post_thumbnail('medium'); ?>`（`image = <?php get_the_post_thumbnail($post_id, 'medium'); ?>;`参见有关`get_the_post_thumbnail()` [此处](http://codex.wordpress.org/Function_Reference/get_the_post_thumbnail)的信息）。

```
<?php $post_id = get_the_ID(); ?>

<div id=my-div></div>

<script>
    if( jQuery(window).width() < 480 ) {
        var image = <?php get_the_post_thumbnail($post_id, 'medium'); ?>;
    }
    else if( jQuery(window).width() < 960 ) {
        var image = <?php get_the_post_thumbnail($post_id, 'large'); ?>;
    }
    else {
        var image = <?php get_the_post_thumbnail($post_id, 'full'); ?>;
    }

    jQuery('#my-div').append(image);
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T19:39:14.203

我建议您使用[自适应图像](http://adaptive-images.com/)。你会喜欢的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-30T22:04:21.073

当我遵循本教程时，我在 wordpress 中获得了完美响应的特色和发布的图像：

[http://premium.wpmudev.org/blog/diy-truly-responsive-images-on-your-wordpress-website/](http://premium.wpmudev.org/blog/diy-truly-responsive-images-on-your-wordpress-website/)

使用非常棒的图片填充插件：

[https://github.com/scottjehl/picturefill](https://github.com/scottjehl/picturefill)

我回到这个帖子发布这个。但是我警告你，这个教程有点过时了，插件创建者已经切换到了 span，而不是 div。当您将手枪从袜子中拉出时，当您准备放弃并弹射时，请记住这一点。

# ruby-on-rails - 如何在 Rails 视图中为父子模型添加多个输入？

> ID：16120821
> 
> 赞同：1
> 
> 时间：2013-04-20T13:17:30.787
> 
> 标签：ruby-on-rails

我有一个非常简单的问题。

我的 Rails 应用程序中有一个表单，我希望用户在其中为多个项目填写一些内容。

更具体地说，我有一个这样的数组：

```
[
  {id: 1, title: 'foo'},
  {id: 2, title: 'bar'}, 
  {id: 3, title: 'baz'}
] 
```

对于每个项目，用户需要指定一个数量。所以我最终想要得到的数据应该是这样的：

```
{ 
  # other fields...
  items: [
    {id: 1, amount: 4}
    {id: 2, amount: 2}
    {id: 3, amount: 7}
} 
```

因此，表单中应该有三个输入允许用户指定。在我看来，这会是什么样子？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T14:17:26.803

这是一个粗略的例子：

```
class FooController < ApplicationController
  def new
    @foo = Foo.new
    3.times { @foo.items.build }
  end

  def create
    params[:items].each do |item|
      Foo.create(item)
    end
  end
end

<%= form_tag foo_path do %>
  <% @foo.each do |bar| %> 
    <%= fields_for "items[#{bar.id}]", bar do |b| %>
      <%= b.text_field :amount %>
    <% end %>
  <% end %>
<% end %> 
```

# php - mysqli bind_param() 应该是一个参考，给定的值

> ID：16120822
> 
> 赞同：26
> 
> 时间：2013-04-20T13:17:37.013
> 
> 标签：php, arrays, mysqli

无法弄清楚，是什么导致**了 mysqli_stmt::bind_param() 的错误参数 3 应该是一个参考，在...中给出的值**

```
PDO
$query = "INSERT INTO test (id,row1,row2,row3) VALUES (?,?,?,?)";
$params = array(1,"2","3","4");
$param_type = "isss";
$sql_stmt = mysqli_prepare ($mysqli, $query);
call_user_func_array('mysqli_stmt_bind_param', array_merge(array($sql_stmt, $param_type), $params));
mysqli_stmt_execute($sql_stmt); 
```

也试过OOP

```
OOP
$insert_stmt = $mysqli->prepare($query);
array_unshift($params, $param_type);
call_user_func_array(array($insert_stmt, 'bind_param'), $params);
$insert_stmt->execute(); 
```

但同样的错误，只是现在参数 2 引起了问题。

那么，$params 有什么问题呢？我需要 $params 是一个值数组。

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2013-04-20T13:30:49.640

**更新**

这个答案已经过时了。请在较新的 PHP 版本中使用扩展运算符，如 Stacky 回答的。

来自 php 文档：

> 将 mysqli_stmt_bind_param() 与 call_user_func_array() 一起使用时必须小心。请注意，mysqli_stmt_bind_param() 需要通过引用传递参数，而 call_user_func_array() 可以接受可以表示引用或值的变量列表作为参数。

在[mysqli-stmt.bind-param](http://php.net/manual/de/mysqli-stmt.bind-param.php)页面上，您有不同的解决方案：

例如：

```
call_user_func_array(array($stmt, 'bind_param'), refValues($params));

function refValues($arr){
    if (strnatcmp(phpversion(),'5.3') >= 0) //Reference is required for PHP 5.3+
    {
        $refs = array();
        foreach($arr as $key => $value)
            $refs[$key] = &$arr[$key];
        return $refs;
    }
    return $arr;
} 
```

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2017-10-13T07:34:40.873

在 PHP 5.6 中引入，您可以使用[`...`运算符](http://php.net/manual/en/migration56.new-features.php#migration56.new-features.variadics)（“扩展运算符”）以更少的麻烦达到相同的结果：

```
//object-oriented
$sql_stmt->bind_param($param_type, ...$params);

//procedural
mysqli_stmt_bind_param($sql_stmt, $param_type, ...$params); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-20T13:25:41.883

不知道为什么在代码中使用“PDO”一词，但这是其中唯一正确的词。使用[PDO](https://stackoverflow.com/tags/pdo/info)，并且使用 mysqli 准备好的语句不会遇到问题：

```
$query = "INSERT INTO test (id,row1,row2,row3) VALUES (?,?,?,?)";
$params = array(1,"2","3","4");
$stmt = $pdo->prepare($query);
$stmt->execute($params); 
```

只需看看这个干净简洁的代码，并将其与您需要的带有 mysqli 准备好的语句的代码进行比较。

# deployment - 如何使用vs2012和wdk8在目标操作系统上部署和测试minifilter驱动？

> ID：16120826
> 
> 赞同：0
> 
> 时间：2013-04-20T13:17:45.367
> 
> 标签：deployment, driver, minifilter

**我根据这个** [http://msdn.microsoft.com/zh-cn/library/hh439665(v=vs.85).aspx](http://msdn.microsoft.com/zh-cn/library/hh439665(v=vs.85).aspx)编写了我的第一个 kwdf 驱动程序。我没有错。但是当我使用 vs2012 创建和构建新的 Minifilter 驱动程序时，我不知道如何在 vmware 的目标操作系统上部署和测试它。

因为在kwdf的部署中，我可以按照这个链接页面的**部署和安装驱动**部分说的进行部署，但是在vs2012生成的minifilter驱动的inf文件中，我找不到minifilter驱动的硬件ID，所以我没有不知道如何为微过滤驱动程序做这些设置项。

这个问题让我发疯。如果您知道如何在 vs2012 中部署和测试微过滤器驱动程序，请告诉我。非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T13:36:29.177

从您引用示例 HW ID 的 MS 页面，`Root\KmdfSmall`它位于`[Standard.NT$ARCH$]`：

```
[Standard.NT$ARCH$]
%KmdfSmall.DeviceDesc%=KmdfSmall_Device, Root\KmdfSmall 
```

对于真正的硬件，请用适当的 ID 替换。

# php - 使用左外连接选择多个计数

> ID：16120829
> 
> 赞同：0
> 
> 时间：2013-04-20T13:18:00.520
> 
> 标签：php, mysql, ajax

我有 3 个表：`Product`, `Shares`,`Likes`由`ProductID`. 我想要做的是在一个查询中选择所有产品和这些产品`COUNT(shares)`。`COUNT(likes)`

首先，是否可以只使用一个查询？如果可能的话我该怎么做？最重要的是，当用户将鼠标悬停在进行 Ajax 调用并获得喜欢和共享数据时，我应该选择所有产品并显示吗？提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T13:22:38.090

干得好：

```
SELECT
    p.id AS 'product id',
    IFNULL(COUNT(DISTINCT s.id), 0) AS 'total shares',
    IFNULL(COUNT(DISTINCT l.id), 0) AS 'total likes'
FROM
    products p
    LEFT JOIN shares s ON s.product_id = p.id
    LEFT JOIN likes l ON l.product_id = p.id
GROUP BY p.id 
```

`IFNULL`将处理没有分享或点赞的情况；`DISTINCT`应该在那里，否则当加入喜欢时，一份分享将被多次计算（反之亦然）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T13:25:40.003

它可以在一个查询中完成。在我的头顶上像

```
SELECT 
   product_id,
   COUNT(likes.product_id) as likes, 
   COUNT(SELECT share_id FROM shares WHERE product_id = p.product_id) as shares
FROM product p 
LEFT JOIN likes USING(product_id) 
```

还是看表演吧。确保你有你的索引等

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T13:31:38.367

```
SELECT 
    p.ProductID,
    COUNT(s.ProductID) AS SharesCount,
    COUNT(l.ProductID) AS LikesCount
FROM
    Products p LEFT JOIN Shares s 
        ON P.ProductID = s.ProductID
    LEFT JOIN likes l 
        ON P.ProductID = l.ProductID

GROUP BY p.ProductID 
```

# java - 使用 JFreeChart 绘制每次旅行的时间

> ID：16120830
> 
> 赞同：1
> 
> 时间：2013-04-20T13:18:04.823
> 
> 标签：java, jfreechart

`System.out.println("Hello all that use Java && JFreeChart!");`

我正在编写一个应用程序，允许骑自行车的人（例如我自己）跟踪给定行程的平均速度、距离和时间。他们将输入该数据，然后会弹出一个带有图形信息的 JFrame。我有一个将 elapsedTime 转换为字符串格式的类（用于显示目的！），但我认为 JFreeChart 不能将它用于 Range 值。事实上，我查看了他们的 API 文档[http://www.jfree.org/jfreechart/api/javadoc/index.html](http://www.jfree.org/jfreechart/api/javadoc/index.html)，很快发现 Range() 只接受 double 类型的参数！不是字符串，不是时间，双倍。这是一个失望，因为我打算将显示的图表间隔设置为它们的最小时间和最大时间形成的间隔。有没有办法解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T13:21:10.603

根据我对问题的理解，您可以尝试：

```
double value = Double.parseDouble(string); 
```

但是，如果您输入基于时间的值，这显然不起作用。根据您所做的评论，也许一个[`TimeSeriesChart`](http://www.jfree.org/jfreechart/api/javadoc/org/jfree/chart/ChartFactory.html#createTimeSeriesChart%28java.lang.String,%20java.lang.String,%20java.lang.String,%20org.jfree.data.xy.XYDataset,%20boolean,%20boolean,%20boolean%29)from[`ChartFactory`](http://www.jfree.org/jfreechart/api/javadoc/org/jfree/chart/ChartFactory.html)可以解决您的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-21T14:09:14.917

这似乎`ChartFactory.createTimeSeriesChart()`是要走的路，但这是最令人失望的路。当然，您可以切换轴，但这对数据没有任何影响！解决这个问题的最聪明的方法是使用 XYLineChart，然后使用`RelativeDateFormat`：[http](http://www.jfree.org/jfreechart/api/javadoc/index.html) ://www.jfree.org/jfreechart/api/javadoc/index.html 。这样，您的范围值以 type 形式输入`long`，然后您只需带入 a `DateAxis`that has `RelativeDateFormat`。问题解决了。

# objective-c - 不同类别的模型结构

> ID：16120833
> 
> 赞同：0
> 
> 时间：2013-04-20T13:18:33.480
> 
> 标签：objective-c, model, structure

我正在创建一个应用程序，其中有不同的类别，这些类别有不同的项目，我想在表格视图中显示。每个项目都有一个标题、描述、网址和一张图片。该类别有一个标题和属于该类别的所有项目。

为这种结构创建模型的最佳方法是什么？

我在考虑一个名为 Category 的 NSObject，其中一个 NSString 用于标题，一个 NSMutableArray 用于项目。然后另一个 NSObject 使用 NSStrings 称为 Item。

我将使用所有数据解析 JSON。但是如何将 JSON 对象解析为正确的类别模型数组？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T14:08:04.670

你的模型看起来足够好。但为什么只`NSStrings`针对项目。根据您的描述项目模型类应如下所示：

```
@interface Item: NSObject{
    NSString *title;
    NSString *description;
    NSURL *itemURL;
    UIImage *image;
} 
```

您可以`NSJSONSerialization`用于解析 json。例如：

如果你有一个像下面这样的 json 字符串，你可以像下面这样解析它：

```
NSString *jsonString= @"{ \"category1\": [ { \"iTitle\" : \"item1\", \"iDescription\":\"desc1\"},{ \"iTitle\" : \"item2\", \"iDescription\":\"desc2\"}]}";
NSData *data = [jsonString dataUsingEncoding:NSUTF8StringEncoding];
NSDictionary *jsonObj = [NSJSONSerialization JSONObjectWithData:data options:NSJSONReadingMutableContainers error:&error]; 
```

如果要解析并将其放入类中，可以执行以下操作：

```
for (NSString *category in jsonObj) {
    Category *categoryObj = [[Category alloc] init];
    categoryObj.title = category;
    NSArray *itemArray = [jsonObj valueForKey:category];
    for (NSDictionary *item in itemArray) {
        Item *itemObj = [[Item alloc] init];
        itemObj.title = [item valueForKey:@"title"];
        itemObj.description= [item valueForKey:@"description"];
        [categoryObj.items addObject:itemObj];
    }
} 
```

遍历字典（或访问字符串中的 'category1'

```
@"{ \"tab1\": [{ \"category1\": [ { \"iTitle\" : \"item1\", \"iDescription\":\"desc1\"},{ \"iTitle\" : \"item2\", \"iDescription\":\"desc2\"}]}}" 
```

您可以使用 for in 循环。

```
NSDictionary *categoryDict = [[jsonObj valueForKey:"tab1"] objectAtIndex:0];
for (id key in categoryDict){
    NSLog(@"Key : %@",key);
    NSLog(@"Value: %@",[categorDict valueForKey:key];
} 
```

# python - 4-D numpy 数组字典：如何优化？

> ID：16120835
> 
> 赞同：4
> 
> 时间：2013-04-20T13:18:46.090
> 
> 标签：python, arrays, multidimensional-array, numpy

我在初始化 4-D numpy 张量字典时遇到了性能问题。

我有一个系数名称列表：

```
cnames = ['CN', 'CM', 'CA', 'CY', 'CLN' ...]; 
```

那不是固定大小的（它取决于上面的代码）。对于每个系数，我必须生成一个零的 4-D 张量 [nalpha X nmach X nbeta X nalt]（用于预分配目的），所以我这样做：

```
#Number of coefficients
numofc = len(cnames);

final_data = {};
#I have to generate <numofc> 4D matrixes
for i in range(numofc):
    final_data[cnames[i]]=n.zeros((nalpha,nmach,nbeta,nalt)); 
```

~~每个索引是 10 到 30 之间的整数。~~ 每个索引是 100 到 200 之间的整数

这需要大约 4 分钟。我怎样才能加快速度？还是我做错了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-20T13:52:42.250

您发布的代码不应花费 4 分钟来运行（除非`cnames`非常大或您的 RAM 非常少并且被迫使用交换空间）。

```
import numpy as np

cnames = ['CN', 'CM', 'CA', 'CY', 'CLN']*1000
nalpha,nmach,nbeta,nalt = 10,20,30,40
#Number of coefficients
numofc = len(cnames)

final_data = {}
#I have to generate <numofc> 4D matrixes
for i in range(numofc):
    final_data[cnames[i]]=np.zeros((nalpha,nmach,nbeta,nalt)) 
```

即使`cnames`有 5000 个元素，它也应该只需要几秒钟的时间：

```
% time test.py
real    0m4.559s
user    0m0.856s
sys 0m3.328s 
```

语句末尾的分号表明您有其他语言的经验。小心将该语言中的命令逐行翻译成 NumPy/Python。在 NumPy 中编码就像在 C 中一样是缓慢的秘诀。

特别是，尽量避免逐个元素地更新数组中的元素。这在 C 中运行良好，但在 Python 中非常慢。NumPy 通过委托使用 Fortran 或 Cython 或 C 或 C++ 编码的函数来实现速度。通过逐个元素更新数组，您正在使用速度不那么快的 Python 循环。

相反，请尝试根据对整个数组（或至少是数组切片）的操作来重新表述您的计算。

我可能对问题的原因猜测太多了。您需要[分析您的代码](http://docs.python.org/2/library/profile.html)，然后，如果您需要更具体的帮助，请发布分析结果以及有问题的代码（以[SSCCE](http://sscce.org/)的形式最有帮助）。

# c++ - 在 C++ 中从纯虚拟变为虚拟

> ID：16120841
> 
> 赞同：0
> 
> 时间：2013-04-20T13:19:44.000
> 
> 标签：c++, virtual

我有一个有 5 个子类的基类。

如果在我的基类中我有这个：

```
virtual CpuPort &getsecondDataPort()=0; 
```

那么这意味着必须为所有子类实现该方法，对吗？

但我不希望这样，因为我知道只有当我有特定子类的对象时我才会调用该方法，所以我认为我可以写这个：

```
virtual CpuPort &getsecondDataPort(); 
```

并仅在我想要的子类中实现它。但这给了我这个错误：

```
/base.cc:254: undefined reference to `vtable for BaseCPU' 
```

并在其他子类中：

```
undefined reference to `typeinfo for BaseCPU' 
```

其中 BaseCPU 是我的基类对象。

因为它是一个更大的库（实际上是模拟器）的一部分，所以我想尽可能少地进行更改。所以请不要建议像“只在你的子类中定义”这样的东西，因为我想遵循到目前为止的代码组织方式，除非这是解决问题的唯一方法。

知道为什么会发生这种情况吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T13:23:03.830

> 这意味着必须为所有子类实现该方法，对吗？

仅当您想创建这些子类的直接实例时。如果子类没有实现纯虚函数，它将是抽象的——这*本身*是允许的。

> 但这给了我这个错误：

这是因为虚函数已**声明，但未定义**。如果函数不是纯虚函数，则必须提供定义。

在这种情况下，您不能提供什么都不做的虚拟实现，因为您的函数应该返回一个引用，并且在不返回任何内容的情况下从一个值返回函数的末尾流出是**未定义的行为**（第 6.6.3/2 段） C++11 标准。

另一方面，如果你的基类有一个类型`CpuPort`为 (say)的数据成员，你可以这样做：`myCpuPort`

```
virtual CpuPort &getsecondDataPort() { return myCpuPort; } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T13:21:02.947

似乎唯一的解决方案是在基类中提供一个空实现（考虑到您的限制）。

考虑以下场景：

```
 struct Base
 {
    virtual void foo() = 0;
 };
 struct Derived1
 {
 };
 struct Derived2
 {
    virtual void foo() {};
 };

 Base* p1 = new Derived1;
 Base* p2 = new Derived2;
 p1->foo();
 p2->foo(); 
```

假设编译器让这段代码通过（它没有，这很好）。第二次通话会发生什么？

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-20T13:22:44.100

您已声明成员函数但未定义它。您需要提供`getsecondDataPort`.

```
CpuPort& BaseCPU::getsecondDataPort()
{
     return somevar_;
} 
```

# batch-file - 计划的批处理脚本卡在运行中

> ID：16120843
> 
> 赞同：1
> 
> 时间：2013-04-20T13:20:07.947
> 
> 标签：batch-file, task

我有一个从 CMD 运行的脚本正常运行，但是当我从任务调度程序运行它时，尽管它按预期执行了所有操作，但脚本状态挂在“正在运行”

这是脚本：

```
 @echo OFF
    tasklist /FI "IMAGENAME eq utorrent.exe" 2>NUL | find /I /N "utorrent.exe">NUL
    if "%ERRORLEVEL%"=="0" (echo UTorrent is running nothing to do) ELSE (
    echo UTorrent is not running, starting Utorrent!
    start C:\Users\Adonis\AppData\Roaming\uTorrent\uTorrent.exe
    )

    tasklist /FI "IMAGENAME eq steam.exe" 2>NUL | find /I /N "steam.exe">NUL
    if "%ERRORLEVEL%"=="0" (echo Steam is running nothing to do) ELSE (
    echo Steam is not running, starting Steam!
    start X:\Games\SteamLibrary\Steam.exe
    )

    exit 
```

谁能告诉我为什么会这样？IE 为什么脚本通过调度程序卡在运行状态？

有问题的操作系统是 Windows 8。它设置为仅在用户登录并具有最高权限时运行。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-21T08:05:47.533

尝试使用 /B 参数启动应用程序，以免停止脚本的执行。

我还改进了代码的语法：

```
@echo OFF

(Tasklist /FI "IMAGENAME eq utorrent.exe" | find /I "utorrent.exe">NUL && (
    Echo: UTorrent is running nothing to do)
) || (
    Echo: UTorrent is not running, starting Utorrent!
    Start /B "" "C:\Users\Adonis\AppData\Roaming\uTorrent\uTorrent.exe"
)

(Tasklist /FI "IMAGENAME eq steam.exe" | find /I "steam.exe">NUL && (
    Echo: Steam is running nothing to do)
) || (
    Echo: Steam is not running, starting Steam!
    Start /B "" "X:\Games\SteamLibrary\Steam.exe"
)

Exit 
```

# c# - 改进元数据计数搜索的想法

> ID：16120844
> 
> 赞同：2
> 
> 时间：2013-04-20T13:20:10.643
> 
> 标签：c#, search, nosql, metadata

我在一个分类网站上工作，我正在从 sql server 转换为 mongodb/no-sql，可能还有 node.js。我真的想提出一个更好的元数据过滤解决方案（例如 ebay 中的过滤器）。我目前将所有元数据放在一个表中

**元数据值表** AdvertID MetaDataValue PrentID 级别

如您所见，元数据采用分层结构。然后，我在此表上执行分组计数，以生成站点左窗格的过滤器计数。然后，当用户深入了解元数据选项时，我最终会按计数子查询进行递归分组。

正如您可以想象的那样，这在时间和性能上会有些昂贵。因为我不打算移动 no-sql 选项，所以我认为这是研究替代选项的好时机。我愿意接受任何建议，但这是一个爱好网站，所以我会寻找一个开源/免费的解决方案。

# mysql - 如何为所有远程用户要求 SSL

> ID：16120856
> 
> 赞同：30
> 
> 时间：2013-04-20T13:22:10.247
> 
> 标签：mysql, ssl, phpmyadmin

给定一个具有多个远程用户（表单用户`'joecool'@'192.168.1.2'`）的 MySQL 系统；是否有可以`REQUIRE SSL`用于所有远程用户的 SQL 语句？

单用户命令是：

```
GRANT USAGE ON *.* TO 'joecool'@'192.168.1.2' REQUIRE SSL; 
```

拥有“所有用户”版本会特别有用，因为[phpMyAdmin](http://www.phpmyadmin.net/home_page/index.php)在创建或修改用户时不支持 REQUIRE SSL 标志。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2014-11-13T11:58:38.923

Honza（以前）接受的答案似乎不正确，请参阅其评论。[由于MySQL 不支持用户名的通配符，](https://dev.mysql.com/doc/refman/5.7/en/grant.html#grant-accounts-passwords)因此似乎不可能使用`GRANT`查询同时更改多个用户。

正如您自己建议的那样，您可以`mysql.user`使用`UPDATE`查询直接更改表中的记录，并且按照 Marc Delisle 的建议，然后使用以下命令刷新权限：

```
FLUSH PRIVILEGES; 
```

另请参阅[dba.stackexchange.com > 如何授予多个用户权限](https://dba.stackexchange.com/questions/27920/how-to-grant-multiple-users-privileges-mysql)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-01-30T01:09:08.157

您可以`mysqld`使用[require_secure_transport](https://dev.mysql.com/doc/refman/5.7/en/server-system-variables.html#sysvar_require_secure_transport)进行配置。

```
[mysqld]
...
ssl-ca = ...
ssl-cert = ...
ssl-key = ...
...
require-secure-transport = ON 
```

> 此功能补充了优先考虑的每个帐户的 SSL 要求。例如，如果一个帐户是使用 REQUIRE SSL 定义的，则启用 require_secure_transport 并不能使用该帐户使用 Unix 套接字文件进行连接。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-08-24T18:06:22.757

是的，您可以直接修改 mysql.user 表（小心）。然后，您只需发出 FLUSH PRIVILEGES 语句即可将更改应用到正在运行的服务器。

# url-rewriting - 自定义用户 URL 如何工作？

> ID：16120870
> 
> 赞同：0
> 
> 时间：2013-04-20T13:23:09.363
> 
> 标签：url-rewriting, url-routing, social-networking

今天，出于好奇，我问了一个问题。

我说的是新网站.. Tumblr、Pinterest 和更多网站正在为他们的用户提供他们网站的自定义 URL，例如，我在 Tumblr 上的将是 maurocasas.tumblr.com 而不是 tumblr.com/maurocasas，就像 Facebook做。

我的问题是您如何处理这些 URL？我很好奇。有些网站还允许您将自己的域指向您的博客/网站，因此我可以将 maurocasas.com 指向我的 Tumblr。

他们怎么做到的？我很好奇。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T13:41:38.800

只要您可以控制域的 DNS 配置，这非常简单。只需设置一个指向您的网络服务器的通配符子域，然后只需解析传入请求的主机名的子域部分并将其用作用户名。您可能还必须配置您的网络服务器以支持它。

# c - 为什么 SIGINT 被发送到子进程并且什么都不做？

> ID：16120871
> 
> 赞同：1
> 
> 时间：2013-04-20T13:23:14.443
> 
> 标签：c, unix, signals, posix, ptrace

我正在为我的大学课程构建一个简单的调试器，但在处理 SIGINT 时遇到了问题。

我想要做的是当调试器进程（从现在开始 PDB）接收 SIGINT 信号时，将其传递给子进程（PDB 实际调试的那个）。

我正在这样做：

```
pid_t childid;

void catch_sigint(int sig)
{
    signal(SIGINT,SIG_DFL);
    kill(childid,sig);
}

int debuger (char *address, parm *vars)
{
    int ignore=1;
    int status;

    childid = fork();
    signal(SIGINT,catch_sigint);
    if(childid==0)
    {
        ptrace(PTRACE_TRACEME,0, NULL,NULL);
        if(execve(address,NULL,NULL)==-1)
        {
            perror("ERROR occured when trying to create program to trace\n");
            exit(1);
        }
    }
    else
    {
        int f_time=1;

        while(1)
        {
            long system_call;

            wait(&status);
            if(WIFEXITED(status))break;
            if(WIFSIGNALED(status))break;

            system_call = ptrace(PTRACE_PEEKUSER,childid, 4 * ORIG_EAX, NULL);

            if(!strcmp(vars->category,"process-control") || !strcmp(vars->category,"all"))      
                ignore = pr_calls(system_call,ignore,limit,childid,vars->mode); //function that takes the system call that is made and prints info about it
            if(!strcmp(vars->category,"file-management") || !strcmp(vars->category,"all"))
                ignore = fl_calls(system_call,ignore,limit,childid,vars->mode);

            if(f_time){ignore=1;f_time=0;}
            ptrace(PTRACE_SYSCALL,childid, NULL, NULL);
        }        
    }
    signal(SIGINT,SIG_DFL);
    return 0;
} 
```

该程序运行并派生一个子进程并执行一个程序以跟踪其系统调用。当它没有收到任何信号时，它工作正常。

但是当在一些跟踪过程中我按下 ctrl+c 我希望子进程停止并且 PDB 继续并停止（因为这条线`if(WIFSIGNALED(status))break;`。这永远不会发生。它跟踪的程序继续它的系统调用和打印。

跟踪程序是：

```
#include <stdio.h>

int main(void)
{
    for(;;) printf("HELLO WORLD\n");        
    return 0;
} 
```

即使在我按 ctrl+c 后，该程序仍继续打印 HELLO WORLD。

我还观察到 ptrace 在 ctrl+c 之后给出的系统调用是 -38 并且在信号从 1407（我认为是正常值）到 639 之后，等待状态仅更改一次，然后在下一次又回到 1407等待。

那么我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T20:09:55.410

它在这条线上的问题：

```
ptrace(PTRACE_SYSCALL,childid, NULL, NULL); 
```

它必须是这样的：

```
ptrace(PTRACE_SYSCALL,childid, NULL, signal_variable); 
```

`signal_variable`在全局范围内声明的 int 在哪里，以便处理程序和调试器可以看到它。它的起始值为 0。

信号处理程序现在接收信号并将其传递到此变量中，并在下一个循环中，当 ptrace 命令跟踪程序继续时，它也会向它发送信号。发生这种情况是因为当您跟踪程序时，被跟踪程序在接收到信号时停止执行并等待进一步的指令，以了解如何通过 ptrace 处理来自跟踪程序的信号。

# c# - 使用小时和分钟 int 变量设置 datetimepicker 值

> ID：16120877
> 
> 赞同：0
> 
> 时间：2013-04-20T13:24:01.220
> 
> 标签：c#, datetime, int, double

有问题。我想将两个双打转换为时间格式（HH：mm）（例如，2.5 等于 02:30）。我有一个小时 int 变量和一分钟 int 变量。问题是我不知道如何处理它们，我的意思是如何将它们导入日期时间选择器。开始时，时间存储在数组中的字符串中。

```
public {
    int hour = 5;
    int min =40;
    time.Value = new DateTime(hour, min);// ***this is a mistake***
} 
```

**日期选择器中**的结果应该是 05:40****

 *** * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T14:23:11.090

不确定您的要求，但如下所示，

```
time.Value = DateTime.Today.AddHours(hours).AddMinutes(minutes); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T19:38:22.283

想出了答案。

```
DetaTimePicker.Value = new DateTime(DateTime.Now.Year, DateTime.Now.Month, 
                   DateTime.Now.Day, hour integer, minute integer, 0); 
```

零是分钟。

多谢你们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-12-03T05:41:59.493

设定时间为 13:30

```
 DateTimePicker newDate = (DateTimePicker)rootcontrol;
 String format = "H:mm";
 DateTime dDate;
     try
      {
        DateTime.TryParseExact(answer, format, CultureInfo.InvariantCulture, DateTimeStyles.None, out dDate);
       newDate.Format = DateTimePickerFormat.Custom;
        newDate.Value = dDate;
      }
       catch (System.ArgumentOutOfRangeException)
     {
        newDate.Text = answer;
        Console.WriteLine("ERROR SET TIME:" + answer);
      } 
```**

# php - 任何可以显示所有字母数字的php函数？

> ID：16120878
> 
> 赞同：0
> 
> 时间：2013-04-20T13:24:03.290
> 
> 标签：php

我必须将变量定义为所有字母（大写和小写）和数字的字符串。目前我正在通过以下方式进行操作。

```
 $string = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz'; 
```

有没有其他方法来定义具有相同价值的 $string ？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-20T13:26:50.940

您可以为此使用 php 范围：

```
$string = join(array_merge(range(0, 9), range('A', 'Z'), range('a', 'z'))); 
```

# git - 什么命令使您当前的工作目录成为 git 中的“真实”副本？

> ID：16120880
> 
> 赞同：0
> 
> 时间：2013-04-20T13:24:21.167
> 
> 标签：git, heroku

我在 git 词汇方面遇到了困难。我正在查看备忘单，但我不明白哪个命令使我的存储库副本完全等于我当前的工作副本。所以我有我想在我的 PC 上推送到 Heroku 的内容，并且我想制作那个副本，所有 Heroku 在我推送时都会看到。命令是什么？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T13:37:47.857

这是一个最大限度地精简的解释，让您了解基础知识：

*   `git commit -a`：将工作树的快照记录到本地*提交*中。这仍然不会去远程，也不需要网络访问。您可以在发布之前创建任意数量的单独提交。

*   `git push`：将您的提交发布到远程服务器。如果远程有较新的提交会被你的推送破坏，推送将失败，你将不得不`pull`. （这相当于`svn commit`如果有更多最近的更改会失败，在这种情况下，您必须执行`svn update`并重复提交。）

*   `git pull`：将远程提交拉入您的本地历史记录和工作树。如果您有未推送的旧提交，这还将创建一个合并（创建混合）旧提交和新提交的提交。

虽然这足以让您入门，但我建议您学习 git 书籍或文章，因为否则您以后会遇到问题。无论你用 git 做什么，你的合作者肯定希望你理解合并、变基、分支和差异等概念。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T13:30:56.197

我真的很喜欢这个[视觉备忘单](http://ndpsoftware.com/git-cheatsheet.html)，我将所有新手都指向它。它显示了每个命令如何影响工作树、索引、本地和远程存储库。

有几点需要注意。您的工作副本（git 用语中的工作树）是您当前在磁盘上编辑的内容。它可能代表也可能不代表存储库中的最新提交。如果您已提交所有更改（`git status`返回干净），那么`git push`您想要使用什么来使 Heroku 的分支看起来像您的分支。我不知道您是如何设置的，但我假设您当前的分支正在跟踪远程 Heroku 存储库。

`git commit`记录您的更改，但`git push`和`git fetch`用于共享和检索更改。

# c++ - 指针包装器：取消引用运算符

> ID：16120882
> 
> 赞同：0
> 
> 时间：2013-04-20T13:24:57.663
> 
> 标签：c++, .net, pointers, c++-cli

我对 C++ 很陌生，作为练习（也许最终是 .Net 实用程序），我正在做一个指针包装器（实际上是在 C++/CLI 中，但这也适用于 C++）。**如果标记为1.**和**2.**的行被注释掉，这个指针包装器（称为`Apont`）当前的行为就像指针一样，如下面的测试所示：

 ****```
int main(array<System::String ^> ^args)
{
    double ia = 10; double ip = 10;
    double *p = &ip;                // pointer analogy
    Apont<double> ^a =
        gcnew Apont<double>(ia);    // equivalent to what's below, without errors
    a = ~ia;/* 1\.       IntelliSense: expression must have integral or unscoped enum type
                        error C2440: '=' : cannot convert from 'double' to 'Utilidades::ComNativos::Apont<T> ^'
                        error C2171: '~' : illegal on operands of type 'double'*/
    Console::WriteLine("ip = {0}; *p = {1}; ia = {2}; !a = {3}", ip, *p, ia, !a);
    ia = 20; ip = 20;
    Console::WriteLine("ip = {0}; *p = {1}; ia = {2}; !a = {3}", ip, *p, ia, !a);
    *p = 30;        // pointer analogy
    a->Valor = 30;  // does exacly what's below, without errors
    !a = 30;/* 2\.   IntelliSense: expression must be a modifiable lvalue
                    error C2106: '=' : left operand must be l-value */
    Console::WriteLine("ip = {0}; *p = {1}; ia = {2}; !a = {3}", ip, *p, ia, !a);
    //a->Dispose();
    Console::ReadKey();
    p = nullptr;
    return 0;
} 
```

这里有两件事我不喜欢，在代码注释中用**1.**和**2.标记，在有错误的行之前。**（`operator~`见**1.**）在 外部定义`Apont`，如下：

```
template<typename T> static Apont<T>^% operator ~(T& valor)
{
    return gcnew Apont<T>(valor);
} 
```

我认为这个必须在外部定义`Apont`，但我不确定。我不能很好地理解它产生的错误（当然，这些是在使用中，而不是在定义中）。

要设置`Apont`引用的实例的值，我必须使用一个属性（标记为**2.**的行不起作用，仅在设置用法中有错误），`Apont::Valor`它等效于 use `*p`。我想做的是当我`*p`用来获取**或设置**它指向的值时，`!a`在`Apont`. 这是`Apont::operator!()`的当前定义：

```
T operator !()
{
    return Valor;
} 
```

正如您在**2**中看到的那样（在代码中的注释中，在相应的错误之前），它不适用于设置值。也许我应该返回一个参考？制作另一个具有相同名称的运算符，可能在类之外？我尝试了几个选项，但是，我遇到了类似的错误，并且更加困惑。

问题是：如何创建一个行为类似于`&`（在本例中为`~`）的运算符和一个行为类似于`*`（在本例中`!`为 , 用于取消引用，但行为类似于`Apont::Valor`，您可以在下面看到其旧定义）的运算符？

```
property T Valor
{
    T get()
    {
        if (pointer != nullptr)             
            return *pointer;
        else if (eliminado && ErroSeEliminado) // means "disposed && ErrorIfDisposed"
            throw gcnew ObjectDisposedException("O objeto já foi pelo menos parcialmente eliminadao.");
        else if (ErroSeNulo) // means "ErrorIfNull"
            throw gcnew NullReferenceException();
        else
            return 0;
// don't worry, this is not default behavior, it is returned only if you want to ignore all errors and if the pointer is null
    }
    void set(T valor)
    {
        *pointer = valor;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T14:01:55.423

如果我正确理解了您的代码，您希望操作员`~`返回指针包装器的副本，并且操作员`!`充当取消引用？

在这种情况下，您可以在调用复制构造函数`operator ~`的类中定义一元。`Apont`如果`operator !`您想分配一个值，则必须确实返回一个引用。

我认为下面的 c++ 代码定义了你想要做什么（我重命名`Apont`为`A`）：

```
#include <iostream>

template<typename T>
struct A {
    T* payload;

    A(T *ptr)
        :payload(ptr) {}
    A(const A&other)
        :payload(other.payload) {}

    T& operator !(){
        return *payload;
    }

    T* operator ~(){
        return payload;
    }
};

int main(){
#define PRINT(X) std::cerr << #X << " = " << X << std::endl
    int i = 0;
    PRINT(i);

    A<int> a(&i);
    !a = 1;
    PRINT(i);

    A<int> b = ~a;
    !b = 2;
    PRINT(i);
} 
```

上面代码的输出是：

```
i = 0
i = 1
i = 2 
```

根据您的评论，您说您希望运算符`!`的行为与包装指针完全相同。您可以这样做，但随后语法会发生变化，您需要取消引用它以分配新值（因为它是一个指针......）。即类似的东西：

```
#include <iostream>

template<typename T>
struct A {
    T* payload;

    A(T *ptr): payload(ptr) {}

    // this now behaves like accessing the wrapped pointer directly
    T*& operator !(){
        return payload;
    }
};

int main(){
#define PRINT(X) std::cerr << #X << " = " << X << std::endl
    int i = 0;
    int j = 999;
    PRINT(i);

    A<int> a(&i);
    *(!a) = 1;  // note the change of syntax here
    PRINT(*!a); // and here

    !a = &j;    // but now you can change the wrapped pointer through the operator
    PRINT(*!a);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T16:20:08.613

为了清楚起见，让我回顾一下新的答案。

`!`正如我在之前的回答中所说，解决运算符很容易，只需添加参考即可。

所以对于 operator `~`，目标是让它表现得像`&`operator 并调用指针包装类的构造函数。

我不认为这是可能的。用户定义的对象当然是可能的，但我认为不可能为内置类型重载一元运算符。因此，根据您的喜好，有三种解决方案：

第一个完全符合您的要求，但会因原始类型而中断：

```
#include <iostream>

template<typename T>
struct A {
    T* payload;

    A()
        : payload(NULL){}
    A(T *ptr)
        : payload(ptr) {}

    T& operator !(){
        return *payload;
    }
};

// this will not work for primary types
template<typename T>
A<T> operator ~(T &b){
    return A<T>(&b);
}

struct B{
    int test;
};

int main(){
    B b; b.test = 4;

    A<B> a;
    a = ~b; // I think this is what you want
    std::cerr << (!a).test << std::endl;

    // this does not work
    //int i = 4;
    //A<int> a;
    //a = ~i;
} 
```

第二种解决方案：使用复合赋值运算符。优点是副作用很小，缺点是这不是很直观，可能会破坏您心中的好设计。

```
#include <iostream>

template<typename T>
struct A {
    T* payload;

    A() : payload(NULL){}

    T& operator !(){
        return *payload;
    }
};

template<typename T>
A<T>& operator &=(A<T> &a, T& b){ // should be friend of the above
    a.payload = &b;
    return a;
}

int main(){
    int i = 3;
    A<int> a;
    a &= i;
    std::cerr << !a << std::endl;
} 
```

第三种解决方案：重载基本赋值运算符。这写起来更直观，但有很多副作用：

```
#include <iostream>

template<typename T>
struct A {
    T* payload;

    A() : payload(NULL){}

    T& operator !(){
        return *payload;
    }

    A<T>& operator = (T & b) {
        payload = &b;
        return *this;
    }
};

int main(){
    int i = 3;
    A<int> a;
    a = i;
    std::cerr << !a << std::endl;
} 
```

有人可能有一个解决方案来劫持原始类型的运算符，但我想不出任何简单的解决方案。****

# mongodb - mongoexport 不会将任何记录写入 json 输出文件

> ID：16120884
> 
> 赞同：3
> 
> 时间：2013-04-20T13:25:15.030
> 
> 标签：mongodb, mongoexport

我尝试通过以下方式使用 mongoexport 从 MongoDB 导出 json 文件：

```
$ mongoexport --db db --collection ds --dbpath ~/db --out ds.json
exported 0 records
Sat Apr 20 23:13:18 dbexit: 
Sat Apr 20 23:13:18 [tools] shutdown: going to close listening sockets...
Sat Apr 20 23:13:18 [tools] shutdown: going to flush diaglog...
Sat Apr 20 23:13:18 [tools] shutdown: going to close sockets...
Sat Apr 20 23:13:18 [tools] shutdown: waiting for fs preallocator...
Sat Apr 20 23:13:18 [tools] shutdown: closing all files...
Sat Apr 20 23:13:18 [tools] closeAllFiles() finished
Sat Apr 20 23:13:18 [tools] shutdown: removing fs lock...
Sat Apr 20 23:13:18 dbexit: really exiting now 
```

我不明白为什么创建的json文件为空，因为数据库实际上包含以下数据：

```
$ mongo
MongoDB shell version: 2.2.3
connecting to: test
> use ds
switched to db ds
> db.ds.find().pretty()
{
    "_id" : "1_522311",
    "chr" : 1,
    "kg" : {
        "yri" : {
            "major" : "D",
            "minor" : "A",
            "maf" : 0.33036
        },
        "ceu" : {
            "major" : "C",
            "minor" : "A",
            "maf" : 0.05263
        }
    },
    "pos" : 522311
}
{
    "_id" : "1_223336",
    "chr" : 1,
    "kg" : {
        "yri" : {
            "major" : "G",
            "minor" : "C",
            "maf" : 0.473214
        },
        "ceu" : {
            "major" : "C",
            "minor" : "G",
            "maf" : 0.017544
        },
        "jptchb" : {
            "major" : "C",
            "minor" : "G",
            "maf" : 0.220339
        }
    },
    "pos" : 223336
} 
```

我做错了什么？

先感谢您。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T14:08:27.670

看来您有一个名为的数据库`ds`：

```
> use ds
switched to db ds 
```

`use ds`将当前数据库切换到`ds`数据库（`db`从 shell 只是当前数据库的别名）。

然后，您还有一个名为的集合`ds`：

```
> db.ds.find().pretty() 
```

因此，这意味着您有一个`ds`带有`ds`集合 ( `ds.ds`) 的数据库。

然后，您应该使用这样的导出，并将`--db`选项设置为`ds`（假设数据库的路径正确）：

```
mongoexport --db ds --collection ds --dbpath ~/db --out ds.json 
```

**3.0+ 更新**：`--dbpath`不可[用](https://docs.mongodb.com/manual/reference/program/mongoexport/#options)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-04-22T15:31:07.863

我知道这个答案可能不满足这个问题，但我希望它能帮助那些在**mongoexport 中苦苦挣扎的人不会将任何记录写入 json 输出文件**

我的问题是我使用了引号。例如：

```
$mongoexport --db 'my-database' --collection 'my-collection' --out ds.json 
```

但正确的查询是（不带引号）：

```
$mongoexport --db my-database --collection my-collection --out ds.json 
```

我在执行 a 时发现了这一点`$mongodump`，它创建了一个带引号的文件夹。这对我来说很陌生，但我知道 mongoexport 将引号解释为名称的一部分。所以当我删除它时，它锻炼得很好。

[![在此处输入图像描述](https://i.stack.imgur.com/R7fhc.png)](https://i.stack.imgur.com/R7fhc.png)

[![在此处输入图像描述](https://i.stack.imgur.com/kzB5x.png)](https://i.stack.imgur.com/kzB5x.png)

# html - Jquery移动错误样式问题

> ID：16120885
> 
> 赞同：2
> 
> 时间：2013-04-20T13:25:23.580
> 
> 标签：html, css, validation, jquery-mobile, stylesheet

我正在使用 jquery mobile 完全遵循以下示例： [http ://www.raymondcamden.com/demos/2012/jul/30/round3/register.html](http://www.raymondcamden.com/demos/2012/jul/30/round3/register.html)

如果您在桌面浏览器或宽屏中运行它，它会显示空字段验证错误，在文本字段（下拉列表除外）的情况下样式错误。

任何人指导我如何解决这个问题？简而言之，我想在每个字段下方显示错误，无论是小屏幕还是宽屏幕。（见附件截图）![在此处输入图像描述](https://i.stack.imgur.com/6m4wD.png)

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T17:47:28.430

我通过找到另外两个非常好的教程结束了这个问题：

[http://mobile.tutsplus.com/tutorials/mobile-web-apps/jquery-mobile-forms/](http://mobile.tutsplus.com/tutorials/mobile-web-apps/jquery-mobile-forms/) [http://leepowers.net/files/jqmv/examples/after.html](http://leepowers.net/files/jqmv/examples/after.html)

可以通过 css 和 jquery 轻松修改。

可能会帮助某人。

# zsh - grml 的 zsh 配置 - 多行命令重新回显

> ID：16120888
> 
> 赞同：0
> 
> 时间：2013-04-20T13:25:39.683
> 
> 标签：zsh, zshrc

我安装了 grml 的配置文件，这些文件中的某些内容似乎导致多行命令在执行之前重新回显自己。例如

```
user@machine ~ % cat << EOF
\`heredoc> this 
\`heredoc> that
\`heredoc> EOF

this
that
EOFthis
that
user@machine ~ % 
```

我查看了设置的选项，但似乎没有一个是负责任的。

你们知道如何禁用回声，这样上面就可以了

```
...
\`heredoc> EOF

this
that
user@machine ~ % 
```

（有或没有那个空行）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-03T08:59:25.340

使用抓取的配置：

```
# IMPORTANT: please note that you might override an existing
# configuration file in the current working directory! =>
wget -O .zshrc http://git.grml.org/f/grml-etc-core/etc/zsh/zshrc
# Optionally also grab the user configration:
# wget -O .zshrc.local  http://git.grml.org/f/grml-etc-core/etc/skel/.zshrc 
```

（从[这里](http://grml.org/zsh/)），我无法复制这个问题。我试图在有和没有用户配置的情况下进行复制（`~/.zshrc.local`在上述配置中）：

```
simont@charizard ~ % cat << EOF
\`heredoc> this
\`heredoc> that
\`heredoc> EOF
this
that
simont@charizard ~ % 
```

如果没有进一步的信息，很难对这个问题提供一个确凿的答案。要完全回答，需要做一些事情：

*   你的内容`~/.zshrc`，
*   [zsh 加载其他文件](http://linux.die.net/man/1/zshall)的内容[参见“启动/关闭文件”部分]。

我建议使用 加载新的 shell `zsh -f`，然后慢慢添加配置的部分，直到复制此行为。

# c++ - 是否可以读取在 Linux c++ 中的 udp 套接字缓冲区中缓冲了多少字节？

> ID：16120891
> 
> 赞同：2
> 
> 时间：2013-04-20T13:26:02.580
> 
> 标签：c++, linux

是否可以使用 c++ 在 Linux 的 udp 套接字缓冲区中读取缓冲了多少字节？不幸的是，FIONREAD 在 linux 下无法做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T14:27:29.250

如果您正在使用`recv`，或者`recvfrom`这将通过设置`flags`为来完成`MSG_PEEK`。

如果您使用另一种从套接字读取的方法，请告诉我，我会看看我能找到什么。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T14:02:43.147

有点。您可以获得当前数据报可用的字节数。当你打电话`recvfrom`给它时，传递`MSG_PEEK`标志。这将使数据报保持完整，但允许您查看数据并获取可用字节数。

```
recvfrom(socket, buffer, size, MSG_PEEK, &address, &address_len); 
```

# php - 使用递归函数为带有php数组的树结构数据创建json数据

> ID：16120892
> 
> 赞同：2
> 
> 时间：2013-04-20T13:26:13.747
> 
> 标签：php, mysql, json, yii

我有类别表：

```
CategoryID    CategoryName   ParentID
     1           Root          Null
     2           News            1
     3           Horoscope       1
     4           Sports          2
     5           National        2
     6           Daily           3
     7           Aries           6
     8           Weekly          3
     9           Aries           8 
```

我正在尝试创建树结构的 json 数据，如下所示：

```
[{
    "id":1,
    "text":"Root",
    "children":[{
        "id":2,
        "text":"News",
        "state":"closed",
        "children":[{
            "id":4,
            "text":"Sports"
        },{
            "id":5,
            "text":"National"
        }]
    },{
        "id":3,
        "text":"Horoscope",
        "children":[{
            "id":6,
            "text":"Daily",
                        "children":[{
                  "id":7,
                  "text":"Aries"
                  }],

         },{
            "id":8,
            "text":"Weekly",
                        "children":[{
                  "id":9,
                  "text":"Aries"
                  }],
            }
        }]
}] 
```

我有以下功能来呈现所有类别和子类别

```
 public function categoryData($parent)
    {                 
        $model=new Category();
        $cat=$model->findAllByAttributes(array('ParentCategoryID'=>$parent,'Status'=>2));

        $category = array();

        foreach($cat as $record) 
        {
          global $category;
          $category['id'][$record->CategoryID] = $record->CategoryID;
          $category['text'][$record->CategoryID] = $record->CategoryName;

          // $category['children'][$record->CategoryID] = array();

          //$names[] = $record->CategoryName;

          $this->categoryData($record->CategoryID);

        }
        //array_push($category['children'][$record->ParentCategoryID], $category['children'][$record->CategoryID]);
        return $category;
    } 
```

**问题：** 但上述操作没有以正确的格式将类别放入数组中，因此我可以通过应用 json_encode($category) 函数来创建上述 json 数据格式。

如何在树结构数组中使用递归函数放置类别数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T15:33:50.397

将`public $children = array()`属性添加到您的`Category`模型。然后遍历结果并在父`$children`数组中设置一个引用：

```
$categories = Category::model()->findAll(array('index'=>'id'));
foreach($categories as $category)
    $categories[ $category->id_parent ]->children[] = $category;

echo json_encode($categories); 
```

# java - 投注和寻找独特性

> ID：16120903
> 
> 赞同：1
> 
> 时间：2013-04-20T13:27:34.467
> 
> 标签：java

我在介绍课上一直在努力，我几乎完成了我的最后一个项目，基诺。它是一个投注游戏，根据您与庄家匹配的数字来奖励金钱。我在投注方面存在问题，他们从 100 美元开始，并被要求支付一定数量的钱。我不知道哪种方法仍然可以工作，因为我的方法不是 void，所以我不能返回多个数据值。

我的第二个问题，也许是更重要的一个，是它们必须是唯一的数字。为此，我需要每次都搜索数字数组以查看它们是否匹配，或者使用布尔数组来跟踪数字。我不知道我会如何做第二个，但我很清楚我会如何处理第一个。问题是我已经在使用 do while 了，我不确定如何添加带有嵌套 for 循环的 for 循环。这是我的代码，如果它很乱，很抱歉，我知道我的老师讨厌我的花括号：

```
package Keno;

import cs1.Keyboard;

public class Keno {
    public static void main(String[]args){
        int userArr[]=user();
        int compArr[]=computer();
        int howMany=matchNums(compArr,userArr);
        int moneyGained=betting(howMany);

        System.out.println("You matched "+howMany+" numbers");
        System.out.println("You have gained "+moneyGained+" dollars!");

    }

    public static int[] computer(){
        int []compChoice=new int[20];
        for(int x=0;x<compChoice.length;x++){
            compChoice[x]=(int)(Math.random()*81);
        }
        return compChoice;
    }
    public static int[] user(){
        int choice[]=new int[7];
        System.out.println("Welcome to Keno!");
        System.out.println("Choose 7 unique numbers ranging from 1-80");
        System.out.println("*************************************************");
        //assigns numbers to choice array
        for(int x=0;x<choice.length;x++){
            do{
                int temp=x+1;
                System.out.println("number "+temp+": ");
                choice[x]=Keyboard.readInt();
            }while(choice[x]<0||choice[x]>80);

        }
        System.out.println("Thanks!");
        System.out.println("*************************************************");
        return choice;

    }
    public static int matchNums(int arr1[], int arr2[]){
        int count=0;
        //checks each array slot individually to see if they match
        for(int x=0;x<arr1.length;x++){
            for(int y=0;y<arr2.length;y++){
                if(arr1[x]==arr2[y]){
                    count++;
                }
            }
        }
        return count;
    }
    public static int betting(int matches){
        int moneyGained=0;
        if(matches==7){
            moneyGained=12000;
        }else if(matches==6){
            moneyGained=200;
        }else if(matches==5){
            moneyGained=20;
        }else if(moneyGained==4){
            moneyGained=1;
        }
        return moneyGained;
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T13:40:59.900

添加投注/金钱概念的最简单方法是添加一个整数，表示玩家有多少钱（从 100 开始）。您将不得不询问玩家他们想要下注多少，然后相应地调整他们的资金。

```
public static void main(String[] args) {
  int playerMoney = 100;
  int wagered = getWager(); // dont forget it has to be 0 < wagered <= 100
  // adjust players money according to the wager, and how much they won 
```

为了确保唯一性，您的任何一个想法都行得通。我喜欢只检查数组中已经存在的数字，但大小为 80 的布尔数组也可以。不过，对于只有 7 个数字来说，这似乎很多。

# php - 以（Json 格式）解析来自 Google Place api 响应的数据

> ID：16120905
> 
> 赞同：1
> 
> 时间：2013-04-20T13:27:39.693
> 
> 标签：php, json, curl, google-places-api

我想如何将 google place api 提供的响应中的酒店名称和位置存储在 PHP 数组中。如果我的搜索字符串是***restaurant in New York***。

api 的响应是**json**格式。

我发送搜索请求的脚本是：

```
<?php
    if(isset($_GET['text']))
    {
        if(!empty($_GET['text']))
        {
            $search_text=strip_tags($_GET['text']);

            $hostname = "https://maps.googleapis.com/maps/api/place/textsearch/json?query=$search_text&sensor=true&key=AIzaSyDVdJtIAvhmHE7e2zoxA_Y9qWRpp6eE2o8"; 

            // read the post from PayPal system and add 'cmd'

            $ch = curl_init();
            curl_setopt($ch, CURLOPT_URL, "$hostname");
            curl_setopt($ch, CURLOPT_RETURNTRANSFER,1);

            $res = curl_exec($ch);
            curl_close($ch);

            if(!$res)
            {
                // error log
                echo'Unable to find results.';
            } else {    
                **// ALL output printing code goes down here**
                //$res=json_decode($res);
                //var_dump(json_decode($res));
                $obj=var_dump(json_decode($res, true));
                print_r($obj['"results']);

                }
        } else {
            echo'<h4><font color="red">Please enter the text to search.</font></h4>';
            }
    }
?> 
```

嗯，上面代码的输出是json格式的东西。但我需要从 json 输出中检索餐厅的名称及其位置。

所以，请建议我一种提取确切输出的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T13:58:49.350

正如我所看到的，结果键包含包含您需要的数据的数组。只需执行以下操作：

```
$jsonContent = json_decode($res, true);

foreach ($jsonContent['results'] as $result) {

    // now you have the $result array that contains the location of the place
    // and the name ($result['formatted_address'], $result['name']) and other data.

} 
```

我希望你从这一点知道该怎么做。

# c# - 如何通过datagrid Source在c#中动态排序列表

> ID：16120912
> 
> 赞同：0
> 
> 时间：2013-04-20T13:28:59.907
> 
> 标签：c#, sorting, dynamic

在这里，我有一个`DatagridView`对象列表的绑定 - 这很好。我所做的是一次列出 10 个左右的结果，可以使用下一个和上一个按钮导航结果，这些按钮只需从源中获取结果并显示它们。

问题是我希望源按照在 Datagrid 视图中单击的任何列进行排序 - 不仅仅是当时正在查看的结果，而是所有结果。

我终于开始接近了。我可以比较我的源，甚至可以通过用于调用数据值的列的名称来设置顺序。我需要知道的是我可以让它自动设置数据类型：

```
AppSettings.Instance.SearchResults.Sort(
    new Comparison<SearchResult>(
        (x, y) =>
        ((Int32) x.GetType().GetProperty("Links").GetValue(x, null)).CompareTo(
            ((Int32) y.GetType().GetProperty("Links").GetValue(y, null))))); 
```

在这里，我将属性设置为 Links，它是一个 Int。`CompareTo`即使它知道它的值，我也无法在不转换值的情况下使用它`Int32`。我比较的一些值将属于该类型`DateTime`，因此我需要知道是否可以动态比较和获取数据类型，因为我现在已经很接近了。

摘要 - 我想自动识别动态调用的属性值的数据类型。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T14:03:48.487

我不确定这是否是最好的“前进之路”，做你想做的事。

**如果适用，我宁愿使用`IComparable<T>`**，例如

```
int BetterComparison<T>(T x, T y) where T : IComparable<T>
{
    return x.CompareTo(y);
} 
```

并称它为：

```
BetterComparison(10, 20);
BetterComparison(DateTime.Now, DateTime.Now.AddDays(1)); 
```

**如果您出于某种原因仍然想求助于反射**（或者本质上更通用的东西 - 或者没有由任何类似的接口定义）......

您应该使用特定类型`reflect`的`CompareTo`方法 - 然后只需使用您拥有的值进行调用。例如这样的事情（在你的方法内）：

```
// x.GetType() and y.GetType() should be interchangable by the nature of it
var compareMethod = x.GetType().GetMethod("CompareTo", new[] { y.GetType() });
return (int)compareMethod.Invoke(x, new object[]{y}); 
```

这使您可以这样称呼它：

```
var ret1 = Comparison(10, 20);
var ret2 = Comparison(DateTime.Now, DateTime.Now.AddDays(1)); 
```

# java - 在哪里放置以及如何以独立于平台的方式为 Java 获取系统范围的配置数据（例如 system_home）的正确位置？

> ID：16120913
> 
> 赞同：3
> 
> 时间：2013-04-20T13:29:19.497
> 
> 标签：java, properties, cross-platform

在创建至少应在 Windows、Linux、Mac OS 和 Android 上部署的 Java 解决方案时，我们正在寻找一种方法来保留系统范围的配置数据。

在[Java 中存储应用程序配置数据的正确方法是什么？](https://stackoverflow.com/questions/194349/what-is-the-proper-way-to-store-apps-conf-data-in-java) 解决方案围绕特定用户的主目录进行讨论。在 Oracle 的文档页面之一上：

[http://docs.oracle.com/javase/7/docs/technotes/guides/deployment/deployment-guide/properties.html](http://docs.oracle.com/javase/7/docs/technotes/guides/deployment/deployment-guide/properties.html)

采取了类似的方法。

我们想走一条更广泛的系统路线。例如，在 linux 系统上，/etc 或 /var/lib 的子目录可能是一个合适的位置。在 Windows 上 /$WIN/System32 可能是开始，在 Mac OS 上 /System/Library 可能是位置。

JAVA_HOME - 可能是一个选项，但有它自己的问题： [Windows 忽略 JAVA_HOME：如何将 JDK 设置为默认值？](https://stackoverflow.com/questions/5492937/windows-ignores-java-home-how-to-set-jdk-as-default)

java.util.Preference 类已经存在了一段时间，但 id 没有提供适当的 BackingStore 位置选择： [http ://www.allaboutbalance.com/articles/disableprefs/](http://www.allaboutbalance.com/articles/disableprefs/)

什么是允许

*   找出正确的系统范围目录
*   添加应用程序特定的子文件夹
*   并且可以处理属性（这可以使用常规属性文件或 java.util.Preferences 来完成）

问题的第一部分是关于平台独立方法中的正确位置。应该使用哪些目录，例如在 Android 上？以及必须处理哪些后续问题（例如访问权限）？假设是，如果存在图书馆，则问题的第一部分将通过图书馆处理这部分问题的方式来回答。因此，如果您认为没有这样的库，请您回答这部分问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T06:07:04.090

方法： [http](http://www.java-tutorial.ch/core-java-tutorial/java-osname-system-property) ://www.java-tutorial.ch/core-java-tutorial/java-osname-system-property 是迄今为止我能找到的最接近的方法：

```
String osName = System.getProperty("osName", null);
OperatingSystem  operatingSystem = OperatingSystem.resolve(osName);
OperatingSystemFamily family = operatingSystem.getFamily();
switch (family) {
  case UNIX:
    setBinFolder(DEFAULT_UNIX_BIN);
    setConfFolder(DEFAULT_UNIX_CONF);
    setDataFolder(DEFAULT_UNIX_DATA);
  break;
  case WINDOWS:
    setBinFolder(DEFAULT_WINDOWS_BIN);
    setConfFolder(DEFAULT_WINDOWS_CONF);
    setDataFolder(DEFAULT_WINDOWS_DATA);
  break;
  case MACOS:
    setBinFolder(DEFAULT_MACOS_BIN);
    setConfFolder(DEFAULT_MACOS_CONF);
    setDataFolder(DEFAULT_MACOS_DATA);
   break;
  default:
    setBinFolder(USER_HOME+"/bin");
    setConfFolder(USER_HOME+"/conf");
    setDataFolder(USER_HOME+"/data");                   
  break;
} 
```

但它只解决了识别操作系统并做出相应反应的部分问题。随意在此基础上回答问题。

# jquery - 将 JSF 中的无限滚动与来自 XML 响应的数据集成

> ID：16120914
> 
> 赞同：0
> 
> 时间：2013-04-20T13:29:24.060
> 
> 标签：jquery, jsf, infinite-scroll

我有以下结构：

```
<div id='Content' align='center'>
    <h:form class="form_wrapper">                
        <div id="innerContent">
            <div jsfc="ui:repeat" value="#{HotelList.hotel_summary}" var="hotel" styleClass="dataTable" class="hotelWrapper">
                <ui:repeat  value="" var="">
                          ....................................
                </ui:repeat>            
            </div>                
        </div>
    </h:form>
</div> 
```

内部`innerContent`填充了来自 XML 响应的信息。这就是我得到响应的方式`#{HotelList.hotel_summary}`：

```
HotelListRequest hotel_list = new HotelListRequest();
HotelListResponse response = service.getList(hotel_list);
com.ean.wsapi.hotel.v3.HotelList hl = response.getHotelList();  
hotel_summary = hl.getHotelSummary();
cacheKey = response.getCacheKey();
cacheLocation = response.getCacheLocation(); 
```

我已经实现了分页，所以这里是代码：

```
public String nextPage(){
    HotelListRequest hotel_list = new HotelListRequest();
    hotel_list.setCacheKey(cacheKey);
    hotel_list.setCacheLocation(cacheLocation);

    HotelListResponse response = service.getList(hotel_list);
    com.ean.wsapi.hotel.v3.HotelList hl = response.getHotelList();  
    hotel_summary = hl.getHotelSummary(); 

    cacheKey = response.getCacheKey();
    cacheLocation = response.getCacheLocation();

    return "hotelResults?faces-redirect=true";
} 
```

这两个几乎相同，唯一的区别是最后一个设置了cacheKey和cacheLocation，以便获取下一组数据。

hotelResults.xhtml 是显示数据的页面的名称。

我尝试使用来自 Paul Irish 和 Luke Shumard 的 Infinite Scroll，但它只适用`<a href>`于`<a href>`我无法使用`action="#{HotelList.nextPage()}"`

[我也从http://kahimyang.info](http://kahimyang.info)尝试了无限滚动，但没有运气。

我正在寻找一些关于我需要改变什么才能实现这一点的见解。我假设我制作的分页会派上用场。

我还想补充一点，我对 JSF 很陌生，所以如果这是一个愚蠢的问题，我很抱歉，我只是卡住了。

# javascript - Safari 6：当 Javascript 更改表单操作时，重定向不起作用

> ID：16120917
> 
> 赞同：1
> 
> 时间：2013-04-20T13:29:52.257
> 
> 标签：javascript, redirect, safari

## 语境

我在每张图片上都有一个表单，该表单具有“action”属性以重定向到当前 url。我希望在提交表单后，将用户重定向到当前 url，然后是他评论的图片的哈希值。

## 我想要的是

*   **形式的“旧”**动作属性 = **?q=page/35**
*   **表单的“新”**动作属性 = **?q=page/35#4**

## 我做了什么

**Javascript：**

```
var oldFormAction = $('span').find('.replies-form').attr('action');
if (!oldfFormAction.match(/#/)){
    $('span').find('.replies-form').prop('action', oldFormAction + location.hash)
} 
```

**HTML：**

```
<span class="image-caption current" style="opacity: 1;">
    <form accept-charset="UTF-8" id="reply-add-form" class="replies-form" method="post" action="?q=page/35">
        <div>
            <input type="text">
        </div>
        <button type="submit" value="Submit">Submit</button>
    </form>
</span> 
```

## 什么不工作

*   在**Chrome 和 Firefox**中，它按预期工作！
*   但是，在**Safari 6**中（未在 IE 上测试），**在表单提交期间不会保留**哈希，即使**表单操作本身发生了变化**（上述代码的第 3 行）。

# oracle - MVC4 Entity Framework 多对多自定义连接表名和模式名

> ID：16120920
> 
> 赞同：1
> 
> 时间：2013-04-20T13:30:41.933
> 
> 标签：oracle, entity-framework, asp.net-mvc-4

我在 Oracle 数据库中使用数据库优先的方法。在数据库中，我有 3 个表：USERS、ROLES 和它们之间的连接表：USERS_ROLES_ASSOCIATION。我的模型包含两个类：

```
[Table("USERS", Schema = "SIGNUM")]
public class User
{
    public User()
    {
        Roles = new HashSet<Role>();
    }

    [Key]
    [DatabaseGeneratedAttribute(DatabaseGeneratedOption.Identity)]
    [Column("USR_ID")]
    public decimal UserId { get; set; }

    [Column("USR_LOGIN")]
    public string Login { get; set; }

    [Column("USR_PASS")]
    public string Password { get; set; }

    public virtual ICollection<Role> Roles { get; set; }
}

[Table("ROLES", Schema = "SIGNUM")]
public class Role
{
    public Role()
    {
        Users = new HashSet<User>();
    }

    [Key]
    [DatabaseGeneratedAttribute(DatabaseGeneratedOption.Identity)]
    [Column("ROL_ID")]
    public decimal RoleId { get; set; }

    [Column("ROL_NAME")]
    public string RoleName { get; set; }

    public virtual ICollection<User> Users { get; set; }
} 
```

当我尝试解析用户的角色时：

```
using (var dbContext = new AppDbContext())
{
    User user = dbContext.Users.FirstOrDefault(u => string.Equals(u.Login, "someusername"));
    var roles = user.Roles.Select(r => r.RoleName); // exception
} 
```

...我收到以下错误：“ORA-00942：表或视图不存在”。

问题是 EF 正在寻找表“dbo”。“RoleUsers”而不是“SIGNUM”。“USERS_ROLES_ASSOCIATION”。如何在数据库优先方法中为多对多关系和模式名称指定连接表名称？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-20T14:46:46.823

> 如何在数据库优先方法中为多对多关系和模式名称指定连接表名称？

您必须从流利的配置代码中手动指定它...

```
modelBuilder.Entity<User>()
    .HasMany(x => x.Roles)
    .WithMany(x => x.Users)
    .Map(x => x.ToTable("UserRole", "SIGNUM")); 
```

# php - 在 PHP 中显示一个日期范围内的 div

> ID：16120925
> 
> 赞同：1
> 
> 时间：2013-04-20T13:31:16.353
> 
> 标签：php, date, time, range

如何显示`div`不包括年份的日期范围

例子：

```
//check today
$today = date('d-m');

$start_date = '01-04';
$end_date = '30-04';

if ( $start_date > $today && $end_date < $today ) {

    echo 'OK';

} else {

    echo 'NONE';

} 
```

在 PHP 中做到这一点的最佳解决方案是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T13:42:03.487

尝试以“mm-dd”格式表示您的日期。所以

```
$today = date('m-d');
$start = '04-01';
$end = '04-30';

if ($start <= $today && $end >= $today) {
    // Today's date lies between the start and end dates
} 
```

# java - 通过网络套接字由同一程序发送和接收相同的数据

> ID：16120926
> 
> 赞同：0
> 
> 时间：2013-04-20T13:31:34.067
> 
> 标签：java, sockets, localhost, synchronous, socketexception

我正在尝试通过 Java 程序通过套接字发送数据包并接收相同的数据包。关键是测量通过网络并返回我的程序本身所需的时间。我不能使用本地主机“127.0.0.1”。我不能使用我自己的 IP 地址，因为它会导致一个`java.net.BindException`（它说地址已经在使用中，就是这样）。

有没有其他方法可以做到这一点？我想可能会使用 部分关闭套接字`socket.shutDownOutput()`，但问题是我希望发送大量数据包，因此套接字需要同步监听它。

有什么办法可以做到这一点？通过网络发送数据包并返回到相同的程序/相同的 IP 地址。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T13:55:09.070

为什么不只是有一个将数据回显到服务器的客户端呢？然后，您可以将其绑定到任何 IP 地址。

# html - CakePHP 渲染 HTML 电子邮件 每个新行的标签

> ID：16120927
> 
> 赞同：0
> 
> 时间：2013-04-20T13:31:34.537
> 
> 标签：html, cakephp, cakephp-1.3, html-email

这是蛋糕代码.....注意`$email_body`

```
<?php
$this->Email->reset();
$this->Email->delivery = 'smtp';
$this->Email->smtpOptions = array(
    'port'=>'465', 
    'timeout'=>'30',
    'host' => 'ssl://smtp.gmail.com',
    'username'=>'noreply@example.com',
    'password'=>'a_password_you_cant_see',
);
$this->Email->sendAs = 'html';
$this->Email->template = 'default';
$this->Email->from = '"NO-REPLY" <noreply@example.com>';
$this->Email->to = "rakib@example.com";
$this->Email->subject = "test PHP html email";
$email_body = "Hello message body
                <hr />
                This is rakib
                <br />
                <table width=\"100%\" bgcolor=\"#ff0\">
                    <tr>
                        <td>
                            In a table
                        </td>
                    </tr>
                </table>";
$this->Email->send($email_body);
?> 
```

* * *

`Show Original`发送这封电子邮件后，当我通过GMail 下拉菜单中的按钮 [在电子邮件的右上角]查看原始邮件内容时，HTML 如下所示：

```
<!-- Starting to render - email/html/default -->
<p> Hello message body</p>
<p>                         <hr /></p>
<p>                         This is rakib</p>
<p>                         <br /></p>
<p>                         <table width="100%" bgcolor="#ff0"></p>
<p>                             <tr></p>
<p>                                 <td></p>
<p>                                     In a table</p>
<p>                                 </td></p>
<p>                             </tr></p>
<p>                         </table></p>
<p> </p>
<!-- Finished - email/html/default --> 
```

* * *

`<p>`并且`</p>`每个新行都包含标签.....这是为什么？使用 CakePHP 1.3

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T19:05:23.457

在处理电子邮件时，请尝试坚持 MVC 原则。通过在可能是控制器的地方编写电子邮件的 HTML（视图）可能会使事情变得有点混乱并容易使您的代码膨胀（例如，在控制器中编写标记）。

使用模板创作您的电子邮件结构，然后使用视图变量 ( `$this->set(...)`) 对其应用特定值（参见[文档](http://book.cakephp.org/1.3/en/The-Manual/Core-Components/Email.html#controller-code-for-using-email-component)）。

恐怕我不知道为什么要插入标签，但我怀疑它与每次按回车键时隐式插入`<p>`的换行符有关。`\n`

总之，将您的标记移至模板，一切都会变得更好。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-20T21:54:26.980

如果您直接设置电子邮件的正文，CakePHP 期望传递的文本是*纯文本*。

通过将电子邮件类型设置为 HTML ( )，CakePHP 将通过将换行符转换为标签`Email->sendAs = 'html'`来创建纯文本正文的 HTML 版本`<p>`

在您的情况下，您将 HTML 作为消息正文传递，但 CakePHP 假定它是纯文本，因此也将新行转换为`<p>`标签

在此处阅读文档：[发送基本消息](http://book.cakephp.org/1.3/en/The-Manual/Core-Components/Email.html#sending-a-basic-message)

## 笔记

虽然这应该可以解释您的*问题*，但请查看 Sam 提供的答案，因为这将为您提供有关如何发送 HTML 电子邮件的*答案*！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-20T23:33:50.260

`default.ctp`我找到了解决方案...我需要在我的应用程序文件夹中创建自己的文件`app/views/elements/email/html/default.ctp`并将以下内容放入文件中

```
<?php
echo $content; 
```

这解决了我的问题。请看下面对这个问题的分析。

*`app/views/elements/email/text/default.ctp`[PS 我为正确打印基于文本的邮件做了同样的事情]*

* * *

***问题是***，由于我没有`default.ctp`在自己的 app 文件夹中声明任何元素，因此 cake 回退到其自己的核心 lib 文件夹中的视图元素`cake/libs/view/elements/email/html/default.ctp`。在那里，这就是它的作用。

```
<?php
$content = explode("\n", $content);
foreach ($content as $line):
    echo '<p> ' . $line . "</p>\n";
endforeach;
?> 
```

这就是`<p>`每个新行的标签来自哪里。感谢[@thaJeztah 的回答](https://stackoverflow.com/a/16125590/636762)。为了避免这种情况发生，我需要`default.ctp`在我的 app 文件夹中创建自己的元素，该元素最终会覆盖`default.ctp`核心 lib 文件夹中的元素。

这是一种糟糕的情况。

# javascript - 纹理映射后如何去除线条？

> ID：16120932
> 
> 赞同：1
> 
> 时间：2013-04-20T13:32:08.597
> 
> 标签：javascript, html, three.js, webgl

使用纹理贴图后，如何删除该球体（即太阳）上的线条？

我不知道发生了什么，为什么会出现这些线条？我知道，当我们在教授的课堂上对一个对象使用 Texture 时，它​​并没有向我们展示这些线条。

这是太阳的代码：

```
var sun, sunGeo, sunMat;
sunGeo = new THREE.SphereGeometry(2300,32,32);

var suntexture = new THREE.ImageUtils.loadTexture('images/sun1.jpg');

suntexture.anisotropy = 8;
sunMat = new THREE.MeshPhongMaterial({
ambient: 0x333333,
    side: THREE.BackSide,
map: suntexture, 
emissive: 0xffffff
});

sun = new THREE.Mesh(sunGeo, sunMat);
scene.add(sun); 
```

![太阳](https://i.stack.imgur.com/lGled.png)

有了这些线条，它看起来很糟糕。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T18:06:28.827

看来您已打开线框。

在材质声明中添加“wireframe: false”，或者在绘制之前在其他地方显式设置为 false（“sunMat.wireframe = false;”）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-21T13:42:46.417

你在使用 CanvasRenderer 吗？它有时会这样渲染，我相信这只是因为 CanvasRenderer 有各种限制/缺点，您可能会或可能无法解决这些问题。考虑使用 WebGLRenderer。

# c++ - 从二进制文件（C++）读取结构的恼人错误

> ID：16120937
> 
> 赞同：1
> 
> 时间：2013-04-20T13:32:51.120
> 
> 标签：c++, struct, binary, fopen

我有一个用于读取 .ASE 文件的类，并且需要将变量存储在二进制文件中，以便在下次应用程序运行时更快地访问。我将我的信息存储在一个结构中，以使编写过程更容易。这是我使用的结构，在标题中定义：

```
struct myMesh{
    std::vector<Vector3> vertices;
    std::vector<Vector2> uvs;
    std::vector<Vector3> normals;
    int verticesSize;
    int uvsSize;
    int normalsSize;
}; 
```

我还在标题中创建了这个结构的一个实例来定义变量：

```
myMesh myInfo; 
```

将数据存储在结构变量中后，我使用 C 函数编写了一个二进制文件：

```
std::string path = filename + ".bin";
const char * c = path.c_str();

FILE *pBinaryFile;
pBinaryFile = fopen(c, "wb");
if (pBinaryFile==NULL){
    std::cout << "error";
}
fwrite(&myInfo.vertices, sizeof(myInfo), 1, pBinaryFile);
fclose(pBinaryFile); 
```

为了测试二进制文件是否正确创建，我读取了文件并创建了另一个结构实例来可视化数据：

```
myMesh _myInfo;
FILE *theFile;
theFile = fopen(c, "rb");
if (theFile==NULL){
    std::cout << "error";
}
fread(&_myInfo, sizeof(_myInfo), 1, theFile);
fclose(theFile); 
```

这很好用。当我只尝试读取文件时出现问题，而不是使用写入过程：

```
/*FILE *pBinaryFile;
pBinaryFile = fopen(c, "wb");

if (pBinaryFile==NULL){
    std::cout << "error";
}

fwrite(&myInfo.vertices, sizeof(myInfo), 1, pBinaryFile);
fclose(pBinaryFile);*/

myMesh _myInfo;
FILE *theFile;
theFile = fopen(c, "rb");
if (theFile==NULL){
    std::cout << "error";
}
fread(&_myInfo, sizeof(_myInfo), 1, theFile);
fclose(theFile); 
```

现在它不起作用。正确获取了struct的int变量，但是vector变量出现的形式是？？？内存错误。我对 C++ 很陌生，这可能是一个愚蠢的问题，但我不明白这一点。我还尝试了 ofstream 和 ifstream 的 C++ 函数，我也遇到了同样的问题。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T13:36:52.497

问题是这并没有让写作过程变得更容易，它只会让它出错。

您不能使用对 fwrite 的单个调用（或使用 C++ 等效项）输出复杂的对象，例如向量。你必须以艰难的方式去做。

我无法给出任何具体建议，因为我不知道 和 的`Vector2`定义`Vector3`。但基本上你必须输出向量的大小，然后是它的每个元素。如果这些元素本身就是复杂的对象，那么您还必须特别处理这些对象。你在输入上做相反的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T13:39:35.307

您无法通过询问其大小来保存结构，因为您保存的数据不是基本的本机类型。您必须编写一个自定义序列化函数来写入/读取结构的每个元素。

通过获取向量的长度和单位元素（例如 Vector3/Vector2）的大小来保存 std::vector，然后保存它。

另外，我注意到您正在使用 C 函数来创建和读取文件。这太不酷了。使用 C++ 见[http://www.cplusplus.com/doc/tutorial/files/](http://www.cplusplus.com/doc/tutorial/files/)

希望这可以帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-20T13:46:44.210

std::vector 将在堆上分配空间，并且只保留向量对象本身的指针。

就像你说的那样：

```
Type* array = new Type[10];  // array's value is a memory address, NOT the array itself 
```

如果将矢量打印到文件中，实际上是在打印地址。这就是为什么在同一次运行中执行保存和加载不会失败的原因——地址没有改变，所以它只是从你离开的地方开始。但是如果你不填充向量并将其保存在前面，那么你已经保存的地址将指向任何内容，从而导致非法内存访问。

要合法地保存向量，请先保存向量的大小，然后对其进行迭代并保存每个元素，或者使用[Boost Serialization](http://www.boost.org/doc/libs/release/libs/serialization/doc/index.html)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-20T13:39:16.850

向量不会在向量对象本身中保存它们的数据——它们持有指向不同堆分配内存的指针。您正在保存和恢复指针，但对向量内的指向数据不做任何事情。我建议您阅读 boost 序列化库教程……它应该让您开始朝着富有成效的方向发展。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-20T14:54:57.530

如果您遇到问题，请参考以下示例代码（注意：顶点是交错的，而不是像您的那样分开）：

矢量二维：

```
#ifndef VECTOR2D_H_
#define VECTOR2D_H_

struct Vector2D
{
    union
    {
        struct { float x,y; };
        struct { float s,t; };
        struct { float u,v; };
        float e[2];
    };
    Vector2D(): x(0.0f),y(0.0f) {}
    Vector2D(const float _x,const float _y): x(_x),y(_y) {}
};

#endif 
```

矢量3D：

```
#ifndef VECTOR3D_H_
#define VECTOR3D_H_

struct Vector3D
{
    union
    {
        struct { float x,y,z; };
        struct { float s,t,r; };
        float e[3];
    };

    Vector3D() :x(0.0f),y(0.0f),z(0.0f) {}
    Vector3D(const float _x,const float _y,const float _z): x(_x),y(_y),z(_z) {}
};

#endif 
```

顶点：

```
#ifndef VERTEX_H_
#define VERTEX_H_
#include "Vector2D.h"
#include "Vector3D.h"

struct Vertex
{
    Vector3D    pos;
    Vector3D    nrm;
    Vector2D    tex;

    Vertex() {}
    Vertex(const Vector3D& _pos,const Vector3D& _nrm,const Vector2D& _tex)
        :pos(_pos),nrm(_nrm),tex(_tex) {}
};

#endif 
```

网：

```
#ifndef MESH_H_
#define MESH_H_
#include <vector>
#include "Vertex.h"
#include <sstream>

struct MyMesh
{
    std::vector<Vertex> verts;
    unsigned numVerts;

    void    WriteOut(std::ostringstream& oss)
    {
        numVerts = verts.size();
        oss.write((const char*)&numVerts,sizeof(numVerts));
        unsigned totalSize = numVerts * sizeof(Vertex);
        oss.write((const char*)verts.data(),totalSize);
    }
    void    ReadIn(std::istringstream& iss)
    {
        iss.read((char*)&numVerts,sizeof(numVerts));
        verts.resize(numVerts);
        iss.read((char*)verts.data(),numVerts*sizeof(Vertex));
    }
};

#endif 
```

和一个测试 main.cpp：

```
#include "Mesh.h"
#include <sstream>
#include <fstream>
#include <iostream>

void PopulateMesh(MyMesh& mesh)
{
    // Fill the mesh with some vertices
    for(int i=0; i<3; ++i)
    {
        Vector3D tempVec(0.0f,i,0.0f);
        Vector2D tempTex(0.0f,i);
        Vertex temp(tempVec,tempVec,tempTex);
        mesh.verts.push_back(temp);
    }
}
void PrintMesh(const MyMesh& mesh)
{
    for(auto i=0u; i<mesh.verts.size(); ++i)
    {
        std::cout << "Position: " << mesh.verts[i].pos.x << ' ' << mesh.verts[i].pos.y << ' ' << mesh.verts[i].pos.z << '\n';
        std::cout << "Normal: " << mesh.verts[i].nrm.x << ' ' << mesh.verts[i].nrm.y << ' ' << mesh.verts[i].nrm.z << '\n';
        std::cout << "Tex Coords: " << mesh.verts[i].tex.u << ' ' << mesh.verts[i].tex.v << "\n\n";
    }
}
void WriteStreamToFile(std::ostringstream& oss)
{
    std::ofstream fout;
    fout.open("test.bin",std::ios_base::binary | std::ios_base::out);
    if(fout.is_open())
    {
        fout.write(oss.str().c_str(),oss.str().size());
        fout.close();
    }
}
void ReadStreamFromFile(std::istringstream& iss)
{
    std::string file;
    std::ifstream fin;
    fin.open("test.bin",std::ios_base::binary | std::ios_base::in | std::ios_base::_Nocreate);
    if(fin.is_open())
    {
        std::getline(fin,file,'\x1A');

        fin.close();
    }
    iss.str(file);
}

int main()
{
    MyMesh outMesh;
    unsigned numMeshes = 1;

    PopulateMesh(outMesh);
    PrintMesh(outMesh);

    // Write to the stream
    std::ostringstream oss(std::ios_base::binary | std::ios_base::out);
    oss.write((const char*)&numMeshes,sizeof(numMeshes));
    outMesh.WriteOut(oss);

    WriteStreamToFile(oss);

    std::istringstream iss(std::ios_base::binary | std::ios_base::in);
    ReadStreamFromFile(iss);

    // Read from the stream
    iss.read((char*)&numMeshes,sizeof(numMeshes));

    MyMesh inMesh;
    inMesh.ReadIn(iss);
    PrintMesh(inMesh);

    return 0;
} 
```

# html - 顶部导航栏和文本框和图像定位周围的 HTML/CSS 问题

> ID：16120938
> 
> 赞同：1
> 
> 时间：2013-04-20T13:33:07.813
> 
> 标签：html, css, z-index

我在这里遇到了一个文本框问题，该文本框位于我正在构建的网站的顶部导航栏上。

下面将有助于描绘它的样子：

[http://i34.tinypic.com/24w4uja.png](http://i34.tinypic.com/24w4uja.png)

我还有一个图像文件，它位于这两个导航高度之间的一半左右。

在右侧，我有一个文本框，它与左侧显示的图像文件有些对齐。我遇到的问题是无法在我的图片中红线开始的位置或上方单击文本框字段。

我已经尝试在文本框上设置一个 z-index 以使其位于所有内容之上，但我完全没有运气试图解决这个问题。

我想让图像保持在原来的位置，但我只是希望能够单击文本框中的任意位置以输入文本。

我显然不是 HTML/CSS 方面的专家——但我非常感谢能帮助我解决这个问题。

最好的问候和提前感谢您的时间！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T14:06:30.380

您的元素可能位于不同的堆叠上下文中。如果一个具有位置或不透明度属性而另一个没有，则 z 索引将脱离上下文并且不会响应它们的相对值。

# django - 是否可以在不覆盖该字段的情况下从 FormField 中消失所有验证器？

> ID：16120939
> 
> 赞同：0
> 
> 时间：2013-04-20T13:33:14.727
> 
> 标签：django, django-forms

我在 Django 1.5.1 中有以下环境：

# 表格.py

```
class UserForm(forms.ModelForm):
    class Meta:
        model = User
        widgets = {
            'username': forms.TextInput(attrs={'class': 'input-xlarge', 'placeholder': 'Email Address'}),
            'first_name': forms.TextInput(attrs={'class': 'input-xlarge', 'placeholder': 'First Name'}),
            'last_name': forms.TextInput(attrs={'class': 'input-xlarge', 'placeholder': 'Last Name'}),
            'mobile_phone': forms.TextInput(attrs={'class': 'input-xlarge', 'placeholder': 'Mobile Phone'}),
            'office_phone': forms.TextInput(attrs={'class': 'input-xlarge', 'placeholder': 'Office Phone'}),
        }

    GROUP_CHOICES = [(-1, '[Select]')]
    GROUP_CHOICES += [(group.id, group.name.capitalize()) for group in Group.objects.all()]

    username = forms.EmailField(
        label='Email Address',
        required=True,
        validators=[validate_email],
        widget=forms.TextInput(attrs={'class': 'input-xlarge', 'placeholder': 'Email Address'})
    )
    password1 = forms.CharField(
        label='Password',
        widget=forms.PasswordInput(attrs={'class': 'input-xlarge', 'placeholder': 'Password'})
    )
    password2 = forms.CharField(
        label='Password confirmation',
        widget=forms.PasswordInput(attrs={'class': 'input-xlarge', 'placeholder': 'Password confirmation'})
    )
    group = forms.ChoiceField(
        label='Group',
        choices=GROUP_CHOICES
    )

    def clean_password2(self):
        password1 = self.cleaned_data.get('password1')
        password2 = self.cleaned_data.get('password2')
        if password1 and password2 and password1 != password2:
            raise forms.ValidationError('Passwords don\'t match')
        return password2

    def clean_group(self):
        if self.cleaned_data['group'] == '-1':
            raise forms.ValidationError('This field is required.')
        return self.cleaned_data['group']

    def clean_first_name(self):
        if self.cleaned_data['first_name'] == '':
            raise forms.ValidationError('This field is required.')
        return self.cleaned_data['first_name']

    def clean_last_name(self):
        if self.cleaned_data['last_name'] == '':
            raise forms.ValidationError('This field is required.')
        return self.cleaned_data['last_name']

    def save(self, commit=True):
        user = super(UserForm, self).save(commit=False)
        user.set_password(self.cleaned_data['password1'])
        user.username = self.cleaned_data['username']
        if commit:
            user.save()
            user.groups.clear()
            user.groups.add(self.cleaned_data['group'])
            user.save()
        return user 
```

# 模型.py

```
class User(auth.models.User):
    mobile_phone = models.CharField(
        verbose_name='Mobile Phone',
        max_length=50
    )
    office_phone = models.CharField(
        verbose_name='Office Phone',
        max_length=50
    ) 
```

我*更改**auth_user* 以允许我插入长度超过 30 个字符的用户名，这样我就可以使用*电子邮件*作为*用户名*（我已经尝试过使用*OneToOneField*和自定义模型，这些方法导致我的工作比预期的要多，所以我不会采取那种方式）

# 我的问题：

1.  我必须添加 first_name 和 last_name 清理器，因为 auth.models.User 没有它们，并且小部件对象不允许我设置必需的*属性**，*这是最好的方法吗？
2.  我只有一个问题，*用户名字段的**MaxValueValidator*设置最多仍为30。我怎么能在不覆盖它的情况下消失它。由于我使用的是基于类的视图，当我尝试通过*UpdateView类更新表单时，覆盖字段不会使用模型数据启动**用户*名字段，将其留空。其余字段没有任何问题

 *如果我的英语看起来很难看，谢谢和抱歉！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T10:47:05.063

好的，我找到了如何避免这种行为，因为 MaxValueValidator 在模型端运行，我`clean_username`在 forms.py 中覆盖并添加`self._meta.exclude += ('username',)`以避免在模型中被验证。`exclude`当然，如果您的 Meta 类中没有任何属性，那么只需使用`self._meta.exclude = ('username',)`*

# c# - C# 从通用对象/类调用的不同类方法？

> ID：16120941
> 
> 赞同：0
> 
> 时间：2013-04-20T13:33:39.017
> 
> 标签：c#, .net

我有一个问题，我不知道如何攻击。希望有人能把我踢向正确的方向。=)

我创建了一些类，即 Word、Excel、Microstation。在这些类中，我具有相同名称的相同功能，它们执行相同的操作（但当然使用不同的代码）。

程序（Excel 插件）的输入是一个文件，可以是 Word、Excel 或 Microstation。根据文件类型，我创建了正确类（Word、Excel 或 Microstation）的实例。

创建实例后，我想调用一个函数，该函数将调用实例化的类函数。

我想做这个：

```
public function RunTheFunctions(??? o)
{
   o.OpenFile();
   o.DoStuff();
   o.SaveFile();
} 
```

代替：

```
oWord.OpenFile();
oWord.DoStuff();
oWord.SaveFile();
oExcel.OpenFile();
oExcel.DoStuff();
oExcel.SaveFile();
oMicrostation.OpenFile();
oMicrostation.DoStuff();
oMicrostation.SaveFile(); 
```

我努力了：

```
object o;
Word oWord = new Word();
o = oWord;
o.OpenFile(); 
```

但它不起作用。

我希望我的问题比较清楚。=)

问候，小号

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-20T13:36:11.300

使用所需的方法创建一个接口并在您的具体类中实现它：

```
public interface IDocument
{
    void OpenFile();
    void DoStuff();
    void SaveFile();
}

public class Word : IDocument { .... }

public function RunTheFunctions(IDocument o)
{
    o.OpenFile();
    o.DoStuff();
    o.SaveFile();
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-20T13:44:28.537

`dynamic`除了接口解决方案，这是正确的方法，如果 .NET Framework >= 4.0 ，您也可以用作参数类型。如果 Word、Excel 和 Microstation 是第三方类并且不共享公共接口或基类，则此解决方案是有意义的。（其实这种情况下可以使用[Adapter Pattern](http://en.wikipedia.org/wiki/Adapter_pattern)，返回接口解决方案）

```
public void RunTheFunctions(dynamic o)
{
    o.OpenFile();
    o.DoStuff();
    o.SaveFile();
} 
```

如果提供的对象没有相应的方法，这将在运行时引发异常。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-20T13:36:30.667

您可以创建接口，该接口将由您的 Word、Excel、Microstation 类实现：

```
// interface for your document classes
interface IDocument
{
    void OpenFile();
    void DoStuff();
    void SaveFile();
}

// Word implements IDocument
class Word : IDocument
{
    public void OpenFile() { /* ... */ }
    public void DoStuff() { /* ... */ }
    public void SaveFile() { /* ... */ }
}

// later
public function RunTheFunctions(IDocument o)
{
    o.OpenFile();
    o.DoStuff();
    o.SaveFile();
}

// usage
IDocument doc = new Word();
RunTheFunctions(doc); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-20T15:09:20.507

假设`OpenFile()`和`SaveFile()`是所有类的相同操作，您需要的是[模板方法模式](http://en.wikipedia.org/wiki/Template_method_pattern)

```
 public abstract class Document
{
    /*Assuming OpenFile and SaveFile are the same for Word, Excel and Microstation */

    public void DoStuff()
    {
        OpenFile();
        DoSpecificStuff();
        SaveFile();
    }

    private void OpenFile()
    {
        //Open the file here.
    }

    protected abstract void DoSpecificStuff()
    {
        //Word, Excel and Microstation override this method.
    }

    private void SaveFile()
    {
        //Save file
    }
}

public class Excel : Document
{

    protected override void DoSpecificStuff()
    {
        //Excel does what it needs to do.
    }
}

public class Word : Document
{

    protected override void DoSpecificStuff()
    {
        //Word does what it needs to do.
    }
} 
```

然后是用法：

```
 public void SomeFunction()
    {
        Document document = SelectDocument("xlsx");
        document.DoStuff(); //Open file, excel operation then save file.

        document = SelectDocument("docx");
        document.DoStuff(); //Open file, word operation then save file.
    }

    public Document SelectDocument(string fileExtension)
    {
        switch (fileExtension)
        {
            case "docx": return new Word();
            case "xlsx": return new Excel();
            default: return null;
        }
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-20T13:36:40.993

做一个界面：

```
public interface ICommonMethods
{
void OpenFile();
void DoStuff();
void SaveFile();
} 
```

让你的类实现它，然后执行：

```
ICommonMethods o = new Word();

o.OpenFile(); 
```

# ubuntu - 这条线在 oh-my-zsh 中意味着什么？

> ID：16120945
> 
> 赞同：2
> 
> 时间：2013-04-20T13:34:31.297
> 
> 标签：ubuntu, sh, zsh

在 oh-my-zsh 的[升级工具](https://github.com/robbyrussell/oh-my-zsh/blob/master/tools/upgrade.sh)中，我找到了这一行（第 2 行）：

```
current_path=${current_path/ /\\ } 
```

它做了什么？

此外，这条线适用于mac，但在我的ubuntu服务器上它输出一个错误说：

```
.oh-my-zsh/tools/upgrade.sh: 2: .oh-my-zsh/tools/upgrade.sh: Bad substitution 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-05-18T23:23:38.757

在 Ubuntu 上更新它

```
cd ~/.oh-my-zsh
bash ~/.oh-my-zsh/tools/upgrade.sh 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-20T15:27:48.207

请参阅手册中的[参数扩展](http://zsh.sourceforge.net/Doc/Release/Expansion.html#Parameter-Expansion)。

> ```
> ${name/pattern/repl}
> ${name//pattern/repl} 
> 
> Replace the longest possible match of pattern in the expansion of parameter name by string repl. The first form replaces just the first occurrence, the second form all occurrences. 
> ```

本质上，上面所做的就是在`${current_path}`.

请注意，POSIX 未指定此语法（有关更多信息，请参见此处），但所有当前和[版本](http://pubs.opengroup.org/onlinepubs/009695399/utilities/xcu_chap02.html#tag_02_06_02)`bash`都支持它。该错误表明您没有在您认为自己执行的外壳下运行该工具（不支持它的外壳）。`ksh``zsh``Bad substitution``upgrade.sh`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-20T15:27:36.170

该行将反斜杠转义`$current_path`变量中的第一个空格。并非所有 shell 都支持这种类型的替换，这就是它在 Ubuntu 上失败的原因。

据我所知，这条线没有充分的理由存在。如果在必要时转义空白，即使有效，该方法也是不够的。更糟糕的是，因为该变量的唯一后续使用将它放在双引号中，并且空格的反斜杠转义实际上会破坏它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-06-10T07:43:12.720

我设法使用命令进行更新：

```
cd ~/.oh-my-zsh
ggpull

#or

git pull origin master 
```

# c# - C# WPF Listview 更新

> ID：16120948
> 
> 赞同：3
> 
> 时间：2013-04-20T13:34:47.077
> 
> 标签：c#, wpf, listview

我有一个如下图所示的列表视图。如您所见，我有一列名为**Time**。我想知道如何自动更新时间。

例如航班代码 ABC123 的时间应该在 1 分钟后从 3 分钟变为 4 分钟。

![航班列表视图](https://i.stack.imgur.com/B9AgR.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T16:45:22.060

[大型智能视图模型、哑视图和任何模型，最好的 MVVM 方法？](https://stackoverflow.com/questions/857820/big-smart-viewmodels-dumb-views-and-any-model-the-best-mvvm-approach)包含 WPF 应用程序的代码，其中 ViewModel（和绑定到它的视图）由计时器更新。它每 1 秒（1000 毫秒）出现一次

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T17:11:11.977

**Edit** *对每分钟都使绑定无效的想法不满意（这可能完全没有根据，并且每分钟都无效，我不知道），所以想出了一个直接设置内容的“更纯粹”的实现，保留原件以供参考：*

您可以通过 来完成`AttachedBehaviour`，下面应该可以帮助您入门：

```
public static class TimeAgoBehaviour {

    static Lazy<DispatcherTimer> LazyTimer = new Lazy<DispatcherTimer>(() => {
        DispatcherTimer timer = new DispatcherTimer { Interval = TimeSpan.FromMinutes(1) };
        timer.Start();
        return timer;
    });
    static ConcurrentDictionary<int, EventHandler> Events = new ConcurrentDictionary<int, EventHandler>();

    public static DateTime GetTimeAgo(ContentControl obj) {
        return (DateTime)obj.GetValue(TimeAgoProperty);
    }

    public static void SetTimeAgo(ContentControl obj, DependencyProperty value) {
        obj.SetValue(TimeAgoProperty, value);
    }

    public static readonly DependencyProperty TimeAgoProperty = DependencyProperty.RegisterAttached("TimeAgo",
        typeof(DateTime), typeof(TimeAgoBehaviour),
        new UIPropertyMetadata(DateTime.UtcNow, OnTimeAgoChanged));

    private static void OnTimeAgoChanged(object sender, DependencyPropertyChangedEventArgs e) {
        var newDate = (DateTime)e.NewValue;

        EventHandler oldEvent;
        if (Events.TryRemove(sender.GetHashCode(), out oldEvent)) {
            LazyTimer.Value.Tick -= oldEvent;
        }

        if (DateTime.MinValue == newDate) {
            return;
        }

        var doUpdate = new EventHandler((s, args) => {
            ContentControl control = sender as ContentControl;
            control.Content = TimeAgoConverter.GetTimeAgo(newDate);
        });

        doUpdate(sender, new EventArgs());

        Events.TryAdd(sender.GetHashCode(), doUpdate);
        LazyTimer.Value.Tick += doUpdate;
    }
} 
```

xml:

```
<Label local:TimeAgoBehaviour.TimeAgo="{Binding InitialisedDate}" /> 
```

*以下是原回复：*

* * *

您可以通过 来执行此操作`AttachedBehaviour`，它每分钟都会使绑定无效，导致重新评估它，下面的工作，作为您需要的起点扩展：

代码：

```
public static class PropertyToInvalidateBehaviour {

    static Lazy<DispatcherTimer> LazyTimer = new Lazy<DispatcherTimer>(() => {
        DispatcherTimer timer = new DispatcherTimer { Interval = TimeSpan.FromMinutes(1) };
        timer.Start();
        return timer;
    });
    static ConcurrentDictionary<int, EventHandler> Events = new ConcurrentDictionary<int, EventHandler>();

    public static DependencyProperty GetPropertyToInvalidate(DependencyObject obj) {
        return (DependencyProperty)obj.GetValue(PropertyToInvalidateProperty);
    }

    public static void SetPropertyToInvalidate(DependencyObject obj, DependencyProperty value) {
        obj.SetValue(PropertyToInvalidateProperty, value);
    }

    public static readonly DependencyProperty PropertyToInvalidateProperty = DependencyProperty.RegisterAttached("PropertyToInvalidate",
      typeof(DependencyProperty), typeof(PropertyToInvalidateBehaviour),
      new UIPropertyMetadata(null, OnPropertyToInvalidateChanged));

    private static void OnPropertyToInvalidateChanged(object sender, DependencyPropertyChangedEventArgs e) {
        var propertyToInvalidate = e.NewValue as DependencyProperty;

        EventHandler oldEvent;
        if (Events.TryRemove(e.Property.GetHashCode(), out oldEvent)) {
            LazyTimer.Value.Tick -= oldEvent;
        }

        if (null == propertyToInvalidate) {
            return;
        }

        var doUpdate = new EventHandler((s, args) => {
            BindingExpression binding = BindingOperations.GetBindingExpression(sender as DependencyObject, propertyToInvalidate);
            binding.UpdateTarget();
        });

        Events.TryAdd(e.Property.GetHashCode(), doUpdate);
        LazyTimer.Value.Tick += doUpdate;
    }
} 
```

xml:

```
<Label Content="{Binding Path=InitialisedDate, Converter={StaticResource cnvTimeAgo}}" local:PropertyToInvalidateBehaviour.PropertyToInvalidate="Label.Content" />` 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-20T13:46:43.277

查看[调度计时器](http://msdn.microsoft.com/en-us/library/system.windows.threading.dispatchertimer.aspx)并每分钟执行一次记录更新

这就是我会做的

# svg - 使用 svg 和 d3 在圆和线之间转换

> ID：16120949
> 
> 赞同：1
> 
> 时间：2013-04-20T13:34:59.153
> 
> 标签：svg, d3.js

[JS小提琴](http://jsfiddle.net/chrisfrisina/DDKCb/)

我试图弄清楚如何通过在顶部“剪断”它来“展开”/“解开”一个圆圈，然后它会动画成一条线。

我用 16 个点做了一个圆（用第 17 个点来关闭它，因为如果我使用封闭插值，过渡看起来会很奇怪）

如何（将通过动画？，只需调整 x 和 y 点？，另一种插值？）您可以一次在圆和线之间转换一个点吗？

圆点：

```
//The data for our line
var circleData = [ { "x": 150 , "y": 20   },
                 { "x": 165.30, "y": 23.04},
                 { "x": 178.28, "y": 31.71},
                 { "x": 186.95, "y": 44.69},
                 { "x": 190   , "y": 60   },
                 { "x": 186.95, "y": 75.30},
                 { "x": 178.28, "y": 88.28},
                 { "x": 165.30, "y": 96.95},
                 { "x": 150   , "y": 100   },
                 { "x": 134.69, "y": 96.95},
                 { "x": 121.71, "y": 88.28},
                 { "x": 113.04, "y": 75.30},
                 { "x": 110   , "y": 60.00},
                 { "x": 113.04, "y": 44.69},
                 { "x": 121.71, "y": 31.71},
                 { "x": 134.69, "y": 23.04},
                 { "x": 150   , "y": 20   }   ]; 
```

线点：

```
var lineData = [ { "x": 10    , "y": 200   },
                 { "x": 20    , "y": 200   },
                 { "x": 30    , "y": 200   },
                 { "x": 40    , "y": 200   },
                 { "x": 50    , "y": 200   },
                 { "x": 60    , "y": 200   },
                 { "x": 70    , "y": 200   },
                 { "x": 80    , "y": 200   },
                 { "x": 90    , "y": 200   },
                 { "x": 100   , "y": 200   },
                 { "x": 110   , "y": 200   },
                 { "x": 120   , "y": 200   },
                 { "x": 130   , "y": 200   },
                 { "x": 140   , "y": 200   },
                 { "x": 150   , "y": 200   },
                 { "x": 160   , "y": 200   },
                 { "x": 170   , "y": 200   }   ]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-21T00:08:59.873

在尝试 Duopixel 的演示时，我注意到的第一件事是圆圈似乎缩小以适合在线。因此，我决定让这条线与圆的长度相同。此外，为了获得均匀分布，我编写了两个函数来创建线和圆数据数组：

```
var numberOfPoints = 30;
var radius = 60
var margin = {top: 20,left: 20}
var lineLength = 2 * radius * Math.PI

var circleData = $.map(Array(numberOfPoints), function (d, i) {
    var imag = margin.left + lineLength / 2 + radius * Math.sin(2 * i * Math.PI / (numberOfPoints - 1))
    var real = margin.top + radius - radius * Math.cos(2 * i * Math.PI / (numberOfPoints - 1))
    return {x: imag, y: real}
})

var lineData = $.map(Array(numberOfPoints), function (d, i) {
    var y = margin.top + 2 * radius;
    var x = margin.left + i * lineLength / (numberOfPoints - 1)
    return { x: x, y: y}
}).reverse() 
```

那么，现在，我们可以应用什么效果呢？我将使用最简单的一种：将圆的每个点映射到线上的点的过渡。

```
var circle = svgContainer.append("g")
    .append("path")
    .data([circleData])
    .attr("d", lineFunction)
    .attr("class", "circle")
    .on("click", transitionToLine)

function transitionToLine() {
    circle.data([lineData])
        .transition()
        .duration(1000)
        .ease("linear")
        .attr('d', lineFunction)
    circle.on("click", transitionToCircle)
}
function transitionToCircle() {
    circle.data([circleData])
        .transition()
        .duration(1000)
        .ease("linear")
        .attr('d', lineFunction)
    circle.on("click", transitionToLine)
} 
```

[这是 jsFiddle](http://jsfiddle.net/chrisJamesC/3MShS/)，您只需单击节点即可查看动画。

需要注意的一件重要事情是，每个点的转换花费相同的时间，而实际上您希望最后的点在靠近中间的点之后到达。您可以使用的技巧是使动画的持续时间与从源点到目标点的距离成正比，但是当您传递整个数组时，我看不到如何将其与线条一起使用，因此您无法更改持续时间对于一个特定的点。

# c# - 在 C# 中有没有一种方法可以只为需要它的方法授予管理权限？

> ID：16120950
> 
> 赞同：0
> 
> 时间：2013-04-20T13:35:00.237
> 
> 标签：c#, .net

是否可以在执行程序的特定部分/片段时授予管理权限？
我知道我们可以使用清单文件为我们的整个应用程序提供管理员权限，但我不喜欢这样，因为假设我的 70% ~ 80% 的应用程序服务不需要管理员权限，或者我的最终用户并不喜欢每次运行应用程序时都要面对 UAC 提示。
有没有办法实现这样的目标？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-20T13:42:46.123

执行代码的权限由进程令牌控制，进程令牌是进程范围的对象。因此，如果您的进程具有提升的权限，则在该进程中执行的所有代码都具有提升的权限。

结论是，为了让您的应用程序的不同部分拥有不同的权限，您需要拥有多个进程。

应用程序执行此操作是非常常见和标准的。应用程序可以从单独的权限开始。当用户希望执行需要提升权限的操作时，程序会调用单独的可执行文件来执行该任务。这对用户来说确实更好，因为他们只需要面对 UAC 对话框来执行实际需要提升的操作。

# c++ - 将二维数组传递给函数

> ID：16120951
> 
> 赞同：-2
> 
> 时间：2013-04-20T13:35:02.907
> 
> 标签：c++, arrays, pointers

我在将创建的表传递给 fillMatrix 函数时遇到问题。另一件事是如何在我的函数中引用此表。我真的很感激每一种帮助。我没有遇到任何控制台问题。程序冻结。

```
int **createTable(int n) 
{
    int **table = new int*[n]; 
    for(int i = 0; i<n; i++)
    {
        table[i] = new int[n];
    }
    return table;
}

void fillMatrix(int n, int **tab) 
{
    for(int x = 0; x<=n; x++)
    {
        for(int y= 0; y<=n; y++)
        {
            tab[x][y] = 0;
        }
    }
}  

int main()
{
    int n;
    cout <<"Add size of table";
    cin >> n;
    int **table = createTable(n);

    srand(time(NULL));

    fillMatrix(n, table);

    return 0;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-20T13:38:42.560

我在您的代码中只看到一个问题：

```
for(int x = 1; x <= n; x++)
{
    for(int y = 1; y <= n; y++)
    {
        tab[x][y] = 0;
    }
} 
```

C++ 中的数组是从零开始的，但您尝试分配`tab[n][n]`导致*未定义行为*的数组。

此外，`delete`一旦不再需要您的阵列，您就应该使用它。

* * *

作为另一种解决方案，我建议您使用`std::vector`而不是动态分配的数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T14:12:20.970

这是他们告诉你的。你的 for 语句应该是这样的

```
for( int i = 0 ; i < n ; i++ ) 
```

代替

```
for( int i = 0 ; i <= n ; i++ ) 
```

如果您不小心超出了数组的大小，编译器会警告您，这就是您没有任何警告或错误的原因。

考虑使用向量而不是上面建议的数组。

# php - 在分类术语列表中排除当前职位的术语

> ID：16120953
> 
> 赞同：0
> 
> 时间：2013-04-20T13:35:30.963
> 
> 标签：php, wordpress, taxonomy, custom-post-type, term

在 single-CPT.php 下，我有一个`select`显示我的分类术语的标签。我首先返回当前帖子的术语，然后返回其他术语。问题是我有一个多余的当前职位，即使我`if`在显示其他条款之前进行了测试，if 测试排除了当前职位的条款。我下面的代码有什么问题？你的帮助很有价值。

```
<select class="select"> 
                                         <?php 

                                            $my_current_term =  wp_get_object_terms(get_the_ID(), 'product_category');
                                            foreach($my_current_term as $c_term)
                                            {
                                            ?>

                                            <option value="<?php echo $c_term->name;?>">
                                            <?php echo $c_term->name; ?>
                                            </option>
                                            <?php

                                             }

                                            $all_my_terms =  get_terms('product_category');//add asc and order by  name in asc

                                            foreach ($all_my_terms as $term1 ) {
                                                if ( $my_current_term->name != $term1->name ) {

                                                $option = '<option value="'.$term1->name.'">';
                                                $option .= $term1->name;
                                                $option .= '</option>';
                                                echo $option;
                                                }
                                            }

                                             ?>

                                        </select> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T13:47:12.040

您可以在获取术语时排除它们：

`$all_my_terms = get_terms( 'product_category', array( 'exclude' => $c_term->term_id ) );`

此外，在使用 时`wp_get_object_terms`，请确保通过将`fields`参数设置为 来获取术语 ID 数组`ids`：

`wp_get_object_terms( get_the_ID(), 'product_category', array( 'fields' => 'ids' ) );`

# html - 我可以将表格单元格用作独立样式吗？

> ID：16120957
> 
> 赞同：5
> 
> 时间：2013-04-20T13:35:44.207
> 
> 标签：html, css, cross-browser

在元素上使用 CSS`display:table-cell`时，它的父元素是否以某种方式首选/要求具有`display:table-row`, 和`display:table`？

这可以单独存在于文档中吗？

```
<div style="display:table-cell;">content</div> 
```

或者以表格标签的方式，我应该嵌套一些具有适当样式的附加父标签吗？

```
<style>
.table {display:table;}
.tr {display:table-row;}
.td {display:table-cell}
}
</style>
<div class="table">
  <div class="tr">
    <div class="td">content</td>
  </div>
</div> 
```

使用 display:table-cell 是在同一行上布置元素的一个好技巧（特别是因为它们之间没有呈现空白）但我想知道它是否只是这样：一个技巧。我可以期望这种行为在未来的某个时候会改变吗？

这在风格上不正确吗？它似乎在所有（现代）浏览器中一致显示（IE7 及更低版本不支持`display:table-cell`）

```
<style>
.cell {
  display:table-cell;
  padding:0px 5px;
  background-color:#aaaaaa;
}
</style>
<div>
  <span class="cell">option one</span>
  <span class="cell">option two</span>
  <span class="cell">option three</span>
</div> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-20T14:23:46.293

无论哪种方式，您都可以自由选择。如果未提供 table 和 table-row 元素，则会为您插入匿名元素（只要浏览器遵循 W3C 规范）。

[http://www.w3.org/TR/CSS21/tables.html#anonymous-boxes](http://www.w3.org/TR/CSS21/tables.html#anonymous-boxes)

> 任何表格元素都会在其自身周围自动生成必要的匿名表格对象，由至少三个嵌套对象组成，分别对应一个 'table'/'inline-table' 元素、一个 'table-row' 元素和一个 'table-cell' 元素.

请记住，匿名元素无法设置样式。这只是一个问题，如果您的表格单元格元素中没有足够的内容让它们占据其父级宽度的 100%。在这种情况下，只需要一个表格元素，您可以删除表格行。

# google-glass - 将照片分享到我的服务的最佳实践

> ID：16120959
> 
> 赞同：2
> 
> 时间：2013-04-20T13:36:00.437
> 
> 标签：google-glass, google-mirror-api

想象一个名为“添加猫或狗”的服务（[https://developers.google.com/glass/stories](https://developers.google.com/glass/stories)）

这样做的最佳做法是什么：

*   向用户添加两个联系人“向其添加猫”或“向其添加狗”

*   添加一个 concat，当用户与此联系人共享照片时，在时间线中插入一个新项目并要求在此照片中添加狗或猫之间进行选择

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T04:11:18.817

我们推荐这个：

> 向用户添加两个联系人“向其添加猫”或“向其添加狗”

这有几个原因：

*   您的用户可以独立管理这些联系人。这意味着如果他们只想插入狗，他们可以选择仅启用该联系人。
*   该流程需要更少的网络往返来完成，而且我们都喜欢活泼的软件，对吧？
*   如果用户错过了您在第二个选项中提到的卡，则流程将停止一半完成。您永远不应该依赖您的用户看到您插入的每张时间线卡。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T13:47:24.787

我个人会添加两个联系人。从用户体验的角度来看，它似乎更直观。

# mysql - 在存储过程中打印出多行

> ID：16120960
> 
> 赞同：2
> 
> 时间：2013-04-20T13:36:06.833
> 
> 标签：mysql, stored-procedures, phpmyadmin

我想传入一个 int 值并返回一个小于这个 int 的短密码列表。我在修改 MySQL 游标示例时遇到了麻烦：http: [//dev.mysql.com/doc/refman/5.0/en/cursors.html](http://dev.mysql.com/doc/refman/5.0/en/cursors.html)。我想用短密码打印出行，但任何时候结果有不止一行 PhpMyAdmin 只会无限期地显示“处理请求”。我究竟做错了什么？它破坏了我周六的生产力！

```
DELIMITER $$
CREATE DEFINER=`root`@`localhost` PROCEDURE `ShortPasswd`(IN `passwordLength` TINYINT)
BEGIN
  DECLARE done INT DEFAULT FALSE;
  DECLARE a INT;
  DECLARE b VARCHAR(255);
  DECLARE cur1 CURSOR FOR SELECT UID, Password
      FROM authentication WHERE CHARACTER_length(Password) < passwordLength;
  DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = TRUE;

  OPEN cur1;

  read_loop: LOOP
    FETCH cur1 INTO a, b;
    IF done THEN
      LEAVE read_loop;
    END IF;
    SELECT b;
  END LOOP;

  CLOSE cur1;
END
$$
DELIMITER ; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T14:31:56.470

```
DELIMITER $$
CREATE DEFINER=`root`@`localhost` PROCEDURE `ShortPasswd`(IN `passwordLength` TINYINT)
BEGIN

   SELECT UID, Password
      FROM authentication WHERE CHARACTER_length(Password) > passwordLength;

END
$$
DELIMITER ; 
```

您将直接获得行 UID、密码。当你从查询中得到

```
call ShortPasswd; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T14:25:07.423

我建议修改这些行：

```
...
DECLARE FINISHED BOOLEAN DEFAULT 0;

DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = 1;

...
IF done THEN
  CLOSE cur1;
  LEAVE read_loop;
END IF;

...
END LOOP read_loop; 
```

我使用 0/1 而不是 FALSE/TRUE，并在离开 LOOP 之前关闭光标。

# php - 如何使用带有进度条的 AJAX 上传文档

> ID：16120972
> 
> 赞同：0
> 
> 时间：2013-04-20T13:37:49.203
> 
> 标签：php, javascript, ajax

我想为我的网站制作一个上传页面，以便异步上传文档，我尝试使用 AJAX，但 AJAX 对用户文件系统的访问权限有限，当信息发送到服务器时，仅显示文件名而没有目录，我想建议如何在不使用 JQuery 的情况下轻松地做到这一点，并且我想知道是否有一种方法可以监控文件上传的进度，以便我可以在我的网站上添加一个进度条。

```
function createXMLHttpRequestObject(){
var xmlHttp     =   3;

if(window.ActiveXObject){
    try{
        //test for new version of internet Explorer
        xmlHttp     =   new ActiveXObject("Msxml.XMLHTTP");
    }
    catch(e){
        try{
            xmlHttp     =   new ActiveXObject("Microsoft.XMLHTTP");
        }
        catch(e){
            xmlHttp =   2;
        }
    }
}

else{
    try{
        xmlHttp =   new XMLHttpRequest();
    }
    catch(e){
        xmlHttp =   1;
    }

}

if(!xmlHttp){
    alert("Error creating Objece");
}
else{
    var xHttpArr = new Array();
    xHttpArr.push(xmlHttp);
    var i = xHttpArr.length - 1;
    return xHttpArr[i];
}
}

function process(xmlHttp, i){
if(xmlHttp.readyState   == 4 || xmlHttp.readyState  == 0){
    //value =   encodeURIComponent( objRef.value );

    xmlHttp.open("GET", "php/AjaxBody.php?value="+i, true);
    xmlHttp.onreadystatechange  =   handleServerResponse;
    xmlHttp.send(null);
}
else{
    alert("Hold on");
}
}

function handleServerResponse(){

if(test.readyState == 1 || test.readyState == 2 || test.readyState == 3){

}

if (test.readyState == 4){
    if(test.status == 200){
        txtResponse =   test.responseText;
        bodyDiv =   document.getElementById("body");
        bodyDiv.innerHTML   =   txtResponse;

    }
    else{
        alert("Error with the xmlHttp status");
    }
}
/*
else{
    alert("Error with the xmlHttp readystate: " + x.status);
} */
} 
```

以上是创建对象的代码

```
 button.onclick = function() {
    send = createXMLHttpRequestObject();
    frmUpload = document.getElementById("frmUpload");
    file = document.getElementById("fileUpload");
    processSending(send, frmUpload);
} 
```

上面当调用 process 方法发送文件时，在服务器上我尝试回显文件路径，只出现名称，像这样

```
<?php
echo $_GET['value'];
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T16:31:32.610

首先，您的文件上传错误。文件上传要求您使用表单执行正确的 POST 请求，因为它需要`enctype`表单属性为`multipart/form-data`. 为什么？浏览器通过 POST 请求发送二进制文件数据，并通过 POST 请求对数据进行正确编码以在服务器上读取。任何其他方式，您只会在服务器上获取文件名（您可以使用 Fiddler 之类的工具进行验证）。

好的，那么如何使用 AJAX 进行文件上传？AFAIK不可能直接读取用户的文件系统（我认为`FileReader`只允许通过浏览器读取沙盒文件系统，但我可能在这里错了），所以IMO有两种方法可以去这里：

*   使用隐藏的 iframe 方法进行文件上传。谷歌它你会发现很多信息。
*   使用基于 Flash 的上传器。更多关于这在最后。

至于使用 Javascript 在用户文件系统上获取文件的*位置*，忘记它。这被认为是一个安全问题，许多浏览器在使用 HTML 输入文件标签时仅在读取元素值时返回文件名。（除非您正在考虑使用 Flash 组件。在最后一点会详细介绍。）

现在来到进度条问题。当您的 PHP 脚本实际运行时，整个文件已经上传到服务器。那么如何显示进度条呢？一些（hackish）方法：

*   一个老式的方法是在服务器上创建一个 CGI 脚本来处理上传。优势？CGI 脚本可以在上传*期间*运行，允许您检索上传的实际字节级进度。但这也需要您在服务器上的某个位置更新进度，您可以轮询（使用单独的 AJAX 请求）并在浏览器中向用户显示。

*   另一种最常用的方法是使用基于 Flash 的上传器（请不要杀死我 StackOverflow 社区）。是的，它仍然被大牌使用（我在看你的 Facebook）。您将拥有的优势是您不需要服务器上的任何特殊脚本。基于 Flash 的客户端完全了解上传的字节数。您*还可以*访问实际的文件路径字符串（注意使用*may*和*string*），这对于普通的 JS 和 HTML 来说是不可能的。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-20T15:09:29.280

您可以使用 a`FileReader`并将文件读入 a`ArrayBuffer`或 a`BinaryString`然后使用多个请求发送例如 1 mb 大小的包。然后，接收 php 脚本必须通过将每个接收到的部分附加到文件来“重建”文件。这也将解决在服务器上回显文件路径的问题，因为您可以（并且必须）在写入之前决定将其保存在哪里。

# javascript - 向地图地图添加新值的紧凑方式？

> ID：16120973
> 
> 赞同：1
> 
> 时间：2013-04-20T13:37:56.170
> 
> 标签：javascript, map, coffeescript

我编写了一个工具来计算文本中单词对的频率，这样每当单词 B 跟随单词 A 时，单词 [A][B] 的计数就会增加。

在 perl 中，哈希值和哈希值会在您第一次尝试访问它时自动实例化，这使得代码变得简单。在 Javascript 中，似乎您必须首先创建内部结构，这使得代码更长。

在 Coffeescript 中，这个函数：

```
class Adder
  ...
  addPair: (word1, word2) -> 
    @count[word1] = {} if not @count[word1]? 
    @count[word1][word2] = 0 if not @count[word1][word2]? 
    ++@count[word1][word2] 
```

但这是两行额外的“防御”代码。有没有办法更紧凑地做到这一点，所以我可以维护更少的代码？

（把它放在一个三元语句中并没有真正使它更紧凑，只是对于相同数量的逻辑来说更少的字符。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T16:20:23.927

`or=`您可以使用运算符（或`?=`，但在这些情况下没有必要）来减少这些行的详细程度：

```
addPair: (word1, word2) -> 
  @count[word1] or= {} 
  @count[word1][word2] or= 0 
  @count[word1][word2] += 1 
```

您还可以将这两条初始化行合二为一（尽管我认为这会导致代码可读性降低）：

```
addPair: (word1, word2) -> 
  (@count[word1] or= {})[word2] or= 0 
  @count[word1][word2] += 1 
```

顺便说一句，支持这种自动对象创建被称为[autovivification](http://en.wikipedia.org/wiki/Autovivification)，并且[已经](https://github.com/jashkenas/coffee-script/issues/1870)在 CoffeeScript 问题上进行了讨论。此外，Coco，一种源自 CS 的语言，[拥有它](https://github.com/satyr/coco/wiki/additions#semiautovivification--):)

# ember.js - 如何使用 Jasmine 测试这个 Ember-Data 模型？

> ID：16120976
> 
> 赞同：1
> 
> 时间：2013-04-20T13:38:05.043
> 
> 标签：ember.js, jasmine, ember-data

这些是我一般测试的第一步，所以我不知道如何处理它。在生产中，我使用 REST 适配器 - 开发时的固定装置。

例如有这个用户模型：

```
Sks.User = DS.Model.extend
  name: DS.attr("string")
  email: DS.attr("string")

  gravatar: Ember.computed(->
    email = @get("email") || ""
    "http://www.gravatar.com/avatar/" + MD5(email)
  ).property("email")

  firstName: Ember.computed(->
    fName = @get('name').split(' ')[0]
  ).property("name")

  lastName: Ember.computed(->
    lName = @get('name').split(' ')[1]
  ).property("name") 
```

如何使用带有 Jasmine 的 TDD/BDD 对其进行测试？我想我应该测试一下逻辑：名字、姓氏和 gravatar，但我怎样才能将它翻译成 Jasmine？我最近读了很多关于测试的文章，但是你知道的理论与实践不同，我只是碰壁了。:(

我应该模拟服务器来获取 JSON 还是应该使用固定装置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-21T08:21:47.720

我认为对于**模型**的单元测试，你根本不应该处理服务器（甚至模拟服务器）——这取决于适配器。模型的单元测试将用于计算属性（`gravatar, firstname, lastname`在本例中）和其他逻辑（生命周期回调、操作等）。您可以相当简单地测试它们——它们大多与服务器隔离。像这样的东西：

```
describe "gravatar property", ->
  it "should append the md5 of the email to the gravatar path", ->
    user = Sks.User.createRecord name: "my name", email: "abc@def.com"
    expect(user.get('gravatar')).toBe "http://www.gravatar.com/avatar/#{MD5(user.get('email')}" 
```

如果您正在使用 Ember-Data 的 RESTAdapter，您可以假设它已经过良好测试（尽管您可能希望编写更高级别的集成测试以显示您的模型正确加载了适配器数据）。如果您正在编写自己的适配器，则应该为此进行单独的单元测试。

**要加载应用程序的哪些部分**

对于单元测试，您实际上只需要加载主命名空间（例如`Sks = Ember.Application.create(...)`）和模型定义（例如`Sks.User = DS.Model.extend(...)`）及其依赖项。在创建模型时，可以通过传入模拟/存根来存根其他所有内容（请参阅：[什么是依赖注入？](https://stackoverflow.com/questions/130794/what-is-dependency-injection)）

我之前在测试环境中使用 Ember 的路由器自动加载时遇到过一些问题；您可能想要禁用路由器（尽管这只是在您为测试加载所有内容时才会出现问题——我使用的是 jasminerice，因此所有 javascript 资产都由 Rails 服务器编译，并且测试在浏览器中运行） - - 我认为在新路由器中您可以使用`deferReadiness`：[http](http://emberjs.com/api/classes/Ember.Application.html#method_deferReadiness) ://emberjs.com/api/classes/Ember.Application.html#method_deferReadiness 。以前我在设置`autoinit: false`.

# html - 将文本框输入发送到电子邮件 HTML

> ID：16120979
> 
> 赞同：0
> 
> 时间：2013-04-20T13:38:37.783
> 
> 标签：html, forms, email, textbox

我正在处理一个有 2 个文本框的页面。我想将这两个邮箱的用户输入发送到我的电子邮件，但我的代码似乎不起作用。有什么我错过的吗？

```
<form method="post" action="mailto:youremail@youremail.com" >
First:<input type="text" name="First" size="12" maxlength="12" />
Last:<input type="text" name="Last" size="24" maxlength="24" /> 
<input type="submit" value="Send Email" /> 
</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T13:59:14.450

你的代码是正确的，它对我有用。它可能对您不起作用，因为您没有电子邮件客户端，或者您的浏览器出于安全考虑而关闭了此功能（或类似的东西）。我建议您使用服务来执行此操作，例如[http://www.braveapps.com/emailfwd/](http://www.braveapps.com/emailfwd/)或[http://allforms.mailjol.net/](http://allforms.mailjol.net/)。

# javascript - 如何使用 jQuery UI Accordion 访问单击标题 (h3) 的 ID？

> ID：16120981
> 
> 赞同：2
> 
> 时间：2013-04-20T13:38:49.483
> 
> 标签：javascript, jquery, jquery-ui, javascript-events

[jQuery UI 手风琴的文档提供](http://jqueryui.com/accordion/)了 h3 和 div 组合的多种变体示例，它们成为手风琴按钮之一的标题和内容。

在我的页面中，我有每个 h3 的 ID，当有人单击其中一个手风琴按钮时，我想以编程方式访问它们。我看到的最明显的方法是在 h3 上注册一个单击侦听器并访问事件目标以提取 HTML ID，可能在手风琴调用之后。但我有点不清楚该解决方案是否正确。

让事件处理程序告诉用于构建用户单击的手风琴按钮的 h3 的 HTML ID 的首选方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T13:56:20.663

创建手风琴时，您可以简单地为激活事件传递事件处理程序。此事件在面板被激活后触发（动画完成后）。见[http://api.jqueryui.com/accordion/](http://api.jqueryui.com/accordion/)

你可以做这样的事情

```
$( ".selector" ).accordion({
activate: function( event, ui ) {
 if(!ui.newHeader.isEmptyObject()){
  alert(ui.newHeader.attr('id'))
 }
}
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T13:55:28.430

这会将`id`被点击`h3`元素的 分配给一个变量。这也应该考虑动态内容，因为它使用`on`而不是仅仅`click`.

```
$("h3").on("click", function(){
     var id = $(this).attr("id");
}); 
```

但是，如果这对于动态内容不起作用，您可能想尝试这样的事情：

```
$("body").on("click", "h3", function(){
     var id = $(this).attr("id");
}); 
```

# eclipse - 如何让GGTS/STS超快？

> ID：16120990
> 
> 赞同：6
> 
> 时间：2013-04-20T13:39:31.627
> 
> 标签：eclipse, grails, grails-2.0, eclipse-juno

我将 GGTS 3.2 JUNO 4.2.2 与 Grails 2.2.1 一起使用。在我看来，一段时间后环境非常缓慢。我该怎么做才能让它更快？

有没有办法充分利用底层系统的潜力？

我所做的是（GGTS.ini）：

```
-Xms768m
-Xmx768m
-XX:PermSize=1024m
-XX:MaxPermSize=1024m
-XX:+UseParallelGC 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-05-19T21:52:11.247

使用 Grails 和 GGTS 需要为 GGTS 提供大量内存。您的 IDE 变得越来越慢的原因是它必须执行许多“stop-the-world”垃圾收集才能获得所需的内存。

尤其是您可以看到，在您的 IDE 上第一次打开 GSP 文件时......然后 GGTS 会变暗一段时间。您可以在 IDE 右下角的堆状态上看到它（根据您的喜好启用它）。每次使用的内存接近您提供的 1GB 时，您的 GGTS 就会停止工作两秒或更长时间。之后又有一些空闲内存。

GGTS 的 1GB 内存太低了 - 2GB 应该是 Grails 和 Eclipse 的最低要求。但这还不是全部。GGTS 在 Grails 测试和自动构建中存在内存泄漏。您可以尝试从项目构建路径中删除单元和集成测试。这是我避免减速的诀窍。但如果我必须编写单元测试，我必须每隔一段时间重新启动 GGTS。（我的 ggts.ini 中写了 8192m。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T13:53:00.937

Eclipse 基金会为此发布了解决方案

[http://wiki.eclipse.org/Platform_UI/Juno_Performance_Investigation](http://wiki.eclipse.org/Platform_UI/Juno_Performance_Investigation)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-03-10T19:19:33.427

把这个： -vm C:\devsw\java\jdk7_67\jre\bin\server\jvm.dll 在我的 GGTS.ini 中（并重新启动 GGTS）已经停止了蓝色圆圈的旋转。

# ios - UITableView，编辑模式，长按行为

> ID：16120992
> 
> 赞同：0
> 
> 时间：2013-04-20T13:39:38.460
> 
> 标签：ios, objective-c, uitableview

我正在使用`UITableView`with 编辑模式来插入/删除新单元格。不幸的是，我必须长时间单击红色圆圈进行删除或绿色圆圈插入很长时间才能执行任何操作。在设备和模拟器上（Xcode 4.62 和最新的 SDK 和 iOS）。

它看起来像一个长按手势，但我没有`UIGestureRecognizer`为那些或类似的东西插入一个。

`UITableView`是分组样式；对于编辑单元格和非编辑单元格，启用垂直滚动。

问题是：我可以做些什么来删除/插入一个短按控件的单元格？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T14:12:14.203

```
 gestureRecognizer.cancelsTouchesInView = NO; 
```

好的 - 我找到了诀窍。我添加了一个手势识别器来隐藏键盘（里面有一个 TextField `UITableViewCell`）。我必须将其设置`cancelsTouchesInView`为 NO。

# scala - ETL：并行查找并插入scala

> ID：16120996
> 
> 赞同：1
> 
> 时间：2013-04-20T13:40:26.980
> 
> 标签：scala, collections, parallel-processing, etl

对于我们的 ETL，事实数据没有 item_key，但有 item_number。在加载过程中，如果我们能找到item_number的item_key，那么就使用它，如果找不到，则自动创建一个item_key。目前该过程不是并行的，我正在考虑使用 scala 并行运行它，因为 scala 具有内置的并发收集。

使用一个简单的例子：

```
val keys=1 to 1000
val items=keys map {num=>"Item"+num}
var itemMap=(items zip keys).toMap 
```

现在我们有数百万行要加载，其项目编号是：

```
def g(v:String)=List.fill(5000)(v)
var fact="Item2000" :: List(items.flatMap(x=>g(x))) 
```

由于事实数据中有一个 item2000 在 itemMap 的项目主数据中找不到，我们需要自动创建 (item2000,2000) 的映射并将其添加到 itemMap 以便将来我们再次找到 item2000 时可以使用相同的项目键。

如何实现使用并发收集？对于实际数据的每行循环，如果找不到item key则自动创建，所以我们需要一种锁定itemMap的方法，否则可能会有多个thead试图将autocreate数据插入itemMap

# javascript - 使用 youtube api v3 使用 javascript 从视频中获取标题

> ID：16120997
> 
> 赞同：0
> 
> 时间：2013-04-20T13:40:26.940
> 
> 标签：javascript, youtube, youtube-api, youtube-javascript-api

我试图了解来自 google 的新数据 api 是如何工作的，更具体地说是 youtube (v3) ，但未能成功遵循任何 google 文档。如果有人可以给我一个快速示例，说明如何使用视频 ID 或视频 url 从您的视频中获取标题或任何其他元数据，我将非常感激。

我已经尝试过[https://developers.google.com/apis-explorer/#p/youtube/v3/youtube.videos.list](https://developers.google.com/apis-explorer/#p/youtube/v3/youtube.videos.list)但似乎没有一个请求对我有用。

还尝试遵循此[https://developers.google.com/api-client-library/javascript/dev/dev_jscript](https://developers.google.com/api-client-library/javascript/dev/dev_jscript)

但是一旦我尝试 gapi.client.setApiKey(YOUR API KEY); 它开始让我无法将 setApiKey 应用于未定义等

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T23:51:06.533

[首先注册您的应用程序](https://developers.google.com/youtube/registering_an_application)并获取开发人员密钥，以便您将密钥保存在那里。